# [インデックス 1050] ファイルの概要

このコミットは、Go言語の初期開発段階において存在していたと思われる、任意精度整数（bignum）の実験的な実装に関連するファイルを削除するものです。具体的には、`usr/gri/bignum` ディレクトリ配下にあった `Makefile`、`integer.go`、`make.bash`、`test_integer.go` の4つのファイルが完全に削除されています。これは、Go言語の標準ライブラリに正式な`math/big`パッケージが導入される以前の、初期の試行錯誤の痕跡をクリーンアップする目的で行われたと考えられます。

## コミット

```
commit 17596948e355e3b875472b7e754d72adddd8e606
Author: Robert Griesemer <gri@golang.org>
Date:   Tue Nov 4 14:08:47 2008 -0800

    get rid of bignum leftovers
    
    R=r
    OCL=18475
    CL=18475
```

## GitHub上でのコミットページへのリンク

[https://github.com/golang/go/commit/17596948e355e3b875472b7e754d72adddd8e606](https://github.com/golang/go/commit/17596948e355e3b875472b7e754d72adddd8e606)

## 元コミット内容

```
get rid of bignum leftovers

R=r
OCL=18475
CL=18475
```

## 変更の背景

このコミットの背景には、Go言語の初期開発における任意精度算術ライブラリの進化があります。コミットメッセージ「get rid of bignum leftovers」（bignumの残骸を排除する）が示す通り、この変更は、もはや不要となった、あるいはより洗練された代替実装によって置き換えられた任意精度整数ライブラリのコードを削除することを目的としています。

Go言語は、その設計段階から効率性と実用性を重視しており、数値計算においても標準ライブラリで高度な機能を提供することを目指していました。任意精度算術は、通常のプリミティブ型（`int`, `int64`など）では表現できない非常に大きな数や、小数点以下の精度が厳密に要求される計算を行う際に不可欠です。

Go言語の公式リポジトリの履歴を辿ると、`math/big`パッケージがGo 1.0のリリース以前から開発されていたことがわかります。このコミットが行われた2008年11月は、Go言語がまだ一般に公開される前の非常に初期の段階であり、様々な機能が実験的に実装され、試行錯誤が繰り返されていました。`usr/gri/bignum`というパスは、Go言語の主要な設計者の一人であるRobert Griesemer氏のユーザーディレクトリ配下にあったことから、彼が個人的に、あるいは初期のプロトタイプとして任意精度算術の実装を試みていた可能性が高いです。

この「残骸」の削除は、おそらく`math/big`パッケージの安定化や、より統合された数値計算ライブラリの方向性が定まった結果として行われたものと推測されます。不要なコードを削除することで、コードベースのクリーンアップ、保守性の向上、そして将来的な開発の効率化が図られました。

## 前提知識の解説

### 任意精度算術 (Arbitrary-Precision Arithmetic / Bignum)

任意精度算術とは、コンピュータの固定長のデータ型（例: 32ビット整数、64ビット整数）の限界を超えて、理論上はメモリが許す限りいくらでも大きな数や、いくらでも高い精度を持つ小数を扱うことができる数値計算手法のことです。このような数を「任意精度数」または「多倍長数（bignum）」と呼びます。

**なぜ必要か？**
通常の整数型や浮動小数点型には表現できる数値の範囲に限界があります。例えば、64ビット整数では約9×10^18までの整数しか扱えません。しかし、暗号学、数論、科学技術計算、金融アプリケーションなど、非常に大きな数を扱う必要がある分野では、この限界では不十分です。任意精度算術は、これらの分野で正確な計算を保証するために不可欠です。

**基本的な実装原理:**
任意精度数は、通常、数値の各「桁」（基数に応じたブロック）を配列やリストなどのデータ構造に格納することで表現されます。例えば、10進数で12345を扱う場合、これを10000、2000、300、40、5といった形で分解し、それぞれの桁を配列の要素として保持するようなイメージです。
算術演算（加算、減算、乗算、除算など）は、小学校で習う筆算のように、各桁を順番に処理し、繰り上がりや繰り下がりを適切に処理することで実現されます。これにより、固定長のレジスタに収まらない大きな数でも計算が可能になります。

### Go言語の初期開発とコード管理

Go言語は、Googleによって開発され、2009年11月にオープンソースとして公開されました。このコミットが行われた2008年11月は、Go言語がまだ内部で開発されていた時期にあたります。

初期のソフトウェア開発では、様々なアイデアやプロトタイプが試され、その中には最終的に製品版には含まれないものや、より良い代替案に置き換えられるものも多く存在します。`usr/gri/bignum`のようなパスは、特定の開発者（この場合はRobert Griesemer氏）が担当していた実験的なコードや、一時的な作業領域として使われていたことを示唆しています。

Go言語のコードベースは、当初から`hg` (Mercurial) を使用して管理されており、後にGitに移行しました。コミットメッセージにある`OCL`や`CL`は、Google内部のコードレビューシステム（Changelist）の番号を指している可能性が高いです。これは、変更がGoogle内部でレビューされ、承認されたことを示しています。

## 技術的詳細

このコミットは、`usr/gri/bignum`ディレクトリ配下の以下の4つのファイルを完全に削除しています。これは、Go言語の初期段階で試みられた任意精度整数ライブラリの実装が、もはやプロジェクトの主要なコードベースには必要ないと判断されたことを明確に示しています。

1.  **`usr/gri/bignum/Makefile`**:
    *   このファイルは、`bignum`パッケージのビルドプロセスを定義するMakefileです。Go言語の初期には、`6g`（Goコンパイラ）や`6l`（Goリンカ）といったツールチェーンが使われていました。
    *   `bignum_test`というターゲットがあり、テストの実行もこのMakefileを通じて行われていたことがわかります。
    *   このMakefileの削除は、関連するGoコードがもはやビルドされる必要がないことを意味します。

2.  **`usr/gri/bignum/integer.go`**:
    *   このファイルは、任意精度整数（bignum）の実際のデータ構造と算術演算ロジックを実装していたGoのソースコードです。
    *   ファイルの内容を見ると、`package Integer`として定義されており、`ValueLen`、`Word`、`Value`、`IntegerImpl`、`Integer`といった型が定義されています。
    *   `Word`型は`uint32`であり、32ビットのワードを基本単位として任意精度数を表現していたことがわかります。
    *   `uadd`（符号なし加算）、`usub`（符号なし減算）、`umul`（符号なし乗算）、`umod`（符号なし剰余）といった基本的な算術演算関数が実装されていました。
    *   また、`make`（整数からの生成）、`make_from_string`（文字列からの生成）、`tostring`（文字列への変換）といった変換関数も含まれていました。
    *   `add`、`sub`、`mul`といった符号付きの演算も、符号なし演算を基盤として実装されていました。
    *   `fact`（階乗）のような高レベルな関数も存在し、このパッケージが単なる基盤だけでなく、ある程度の応用機能も提供していたことが伺えます。
    *   このファイルの削除は、この特定の実装がGo言語の標準ライブラリの任意精度算術の最終的な形には採用されなかったことを示しています。

3.  **`usr/gri/bignum/make.bash`**:
    *   これは、`bignum`パッケージをビルドし、テストを実行するためのシェルスクリプトです。
    *   `6g`と`6l`コマンドを使用して`integer.go`と`test_integer.go`をコンパイル・リンクし、`test_integer`という実行ファイルを生成して実行していました。
    *   Makefileと同様に、このスクリプトの削除も、このbignum実装がもはやビルド・テストの対象ではないことを示します。

4.  **`usr/gri/bignum/test_integer.go`**:
    *   このファイルは、`integer.go`で実装された任意精度整数機能のテストコードです。
    *   `Integer`パッケージをインポートし、`FromInt`や`FromString`で整数を生成し、`add`、`sub`、`eql`（等価性チェック）などのメソッドをテストしていました。
    *   特に、`TestFact`関数では、990から1010までの階乗を計算し、その結果を文字列に変換して再度整数に変換し、元の値と比較するという、比較的厳密なテストが行われていたことがわかります。これは、任意精度算術の正確性を検証する上で重要なテストです。
    *   このテストファイルの削除は、テスト対象となるコードがなくなったため、当然の結果です。

これらのファイルの削除は、Go言語の`math/big`パッケージが成熟し、これらの実験的な実装が不要になったことを強く示唆しています。Go言語の標準ライブラリは、安定性とパフォーマンスを重視しており、このような初期のプロトタイプは、より堅牢で最適化された実装に置き換えられるのが一般的です。

## コアとなるコードの変更箇所

このコミットは、既存のコードの変更ではなく、以下の4つのファイルを完全に削除しています。

*   `usr/gri/bignum/Makefile`
*   `usr/gri/bignum/integer.go`
*   `usr/gri/bignum/make.bash`
*   `usr/gri/bignum/test_integer.go`

変更の種類としては、808行の削除（808 deletions）のみであり、追加や変更はありません。

## コアとなるコードの解説

削除されたファイル群は、Go言語の初期にRobert Griesemer氏によって開発された、実験的な任意精度整数（bignum）ライブラリの完全なセットを構成していました。

*   **`integer.go`**: このファイルは、任意精度整数の核となる実装を含んでいました。`Word`型（`uint32`）を基本単位として、大きな数を配列で表現し、その上で加算、減算、乗算といった基本的な算術演算を多倍長数向けに実装していました。また、文字列との相互変換機能や、階乗計算のような応用的な機能も含まれていました。これは、Go言語で任意精度算術を実現するための初期の試みであり、後の`math/big`パッケージの設計に影響を与えた可能性もあります。

*   **`Makefile` および `make.bash`**: これらは、`integer.go`で実装されたbignumライブラリをコンパイルし、テストを実行するためのビルドスクリプトでした。Go言語の初期のビルドツール（`6g`, `6l`など）を使用しており、開発者がこのライブラリをどのようにビルド・テストしていたかを示しています。これらのスクリプトの存在は、このbignum実装が単なる概念実証ではなく、実際にビルド・テスト可能なコードとして扱われていたことを意味します。

*   **`test_integer.go`**: このファイルは、`integer.go`で実装された機能の単体テストを含んでいました。特に、大きな数の変換、加算、減算、そして階乗計算の正確性を検証するテストが含まれていました。テストコードの存在は、開発者がこのライブラリの正確性と信頼性を確保しようと努めていたことを示しており、Go言語開発におけるテスト駆動開発の初期の兆候とも言えます。

これらのファイルが削除されたということは、この特定のbignum実装がGo言語の標準ライブラリの最終的な形には採用されず、より洗練された、あるいは異なる設計思想に基づく`math/big`パッケージに置き換えられたことを意味します。これは、ソフトウェア開発における一般的なプロセスであり、初期の実験的なコードが、より堅牢で保守性の高いソリューションに道を譲る例です。

## 関連リンク

*   Go言語の`math/big`パッケージのドキュメント:
    *   [https://pkg.go.dev/math/big](https://pkg.go.dev/math/big)
*   Go言語の初期のコミット履歴（GitHubミラー）:
    *   [https://github.com/golang/go/commits/master](https://github.com/golang/go/commits/master)

## 参考にした情報源リンク

*   Go言語の公式ドキュメント
*   GitHubのGo言語リポジトリのコミット履歴
*   任意精度算術に関する一般的な情報源 (例: Wikipedia)
