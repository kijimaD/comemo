# [インデックス 10454] ファイルの概要

このコミットは、Go言語プロジェクトのバージョン管理システムにおいて、特定のリリースバージョンを示すタグ情報を記録する`.hgtags`ファイルに対する変更です。具体的には、`weekly.2011-11-18`という週次リリースを示すタグと、それに紐づくコミットハッシュが追加されています。

## コミット

このコミットは、Go言語の週次リリースである `weekly.2011-11-18` のタグ付けを行っています。これは、Goプロジェクトがかつて使用していたバージョン管理システムであるMercurialにおけるタグ付けの慣習に従ったもので、`.hgtags`ファイルに新しいタグエントリを追加することで、特定のコミットをリリースバージョンとしてマークしています。

## GitHub上でのコミットページへのリンク

[https://github.com/golang/go/commit/95474b6283d1f2568757ce71f7dace2c1ef7b12e](https://github.com/golang/go/commit/95474b6283d1f2568757ce71f7dace2c1ef7b12e)

## 元コミット内容

```
commit 95474b6283d1f2568757ce71f7dace2c1ef7b12e
Author: Andrew Gerrand <adg@golang.org>
Date:   Sat Nov 19 07:21:05 2011 +1100

    tag weekly.2011-11-18
    
    R=r
    CC=golang-dev
    https://golang.org/cl/5413052
---
 .hgtags | 2 ++
 1 file changed, 2 insertions(+)

diff --git a/.hgtags b/.hgtags
index d167ff79c7..374c39e48c 100644
--- a/.hgtags
+++ b/.hgtags
@@ -94,3 +94,5 @@ e69e528f2afc25a8334cfb9359fa4fcdf2a934b6 weekly.2011-11-01
 780c85032b174c9d4b42adf75d82bc85af7d78d1 weekly.2011-11-02
 f4397ad6e87c7ce5feac9b01686f1ebd6cbaac4e weekly.2011-11-08
 2f4482b89a6b5956828872137b6b96636cd904d3 weekly.2011-11-09
+b4a91b6933748db1a7150c06a1b55ad506e52906 weekly.2011-11-18
+b4a91b6933748db1a7150c06a1b55ad506e52906 weekly
```

## 変更の背景

このコミットは、Go言語プロジェクトのリリース管理プロセスの一環として行われました。Go言語は現在、6ヶ月ごとの主要リリースサイクルを採用していますが、初期の段階ではより頻繁な週次リリースが行われていました。このコミットは、2011年11月18日の週次リリースを正式にマークするために作成されました。

当時のGoプロジェクトは、現在主流のGitではなく、Mercurial（Hg）という分散型バージョン管理システムを使用していました。Mercurialでは、タグはリポジトリの特定の改訂版（リビジョン）に名前を付けるために使用され、その情報は`.hgtags`という特殊なファイルに記録されていました。このファイルはリポジトリ内の通常のファイルとして扱われ、タグを作成すると新しいコミットとして記録される仕組みでした。

したがって、このコミットの背景には、Goプロジェクトの当時のリリース戦略（週次リリース）と、使用されていたバージョン管理システム（Mercurial）の特性が深く関わっています。

## 前提知識の解説

### Mercurial (Hg)

Mercurialは、Gitと同様の分散型バージョン管理システム（DVCS）です。DVCSでは、各開発者がコードベースの完全な履歴を持つローカルリポジトリを保持し、中央サーバーに依存せずに作業を進めることができます。Mercurialは、そのシンプルさと使いやすさで知られ、Go言語プロジェクトの初期段階で採用されていました。

### タグ (Tags)

バージョン管理システムにおけるタグは、リポジトリの特定の時点に永続的な名前を付けるためのメカニズムです。これにより、特定のリリースバージョン（例: v1.0.0）や重要なマイルストーンを簡単に参照できるようになります。Gitでは軽量タグとアノテートタグがありますが、Mercurialではタグはリポジトリ内の`.hgtags`ファイルに記録されることで管理されます。

### `.hgtags` ファイル

`.hgtags`ファイルは、Mercurialリポジトリにおいてグローバルタグを保存するために使用される特殊なファイルです。このファイルには、変更セットのハッシュ値（コミットハッシュに相当）と、それに対応するタグ名が記述されます。Mercurialでは、タグを作成する操作がこのファイルへの変更として扱われ、その変更自体が新しいコミットとしてリポジトリに記録されます。これにより、タグの履歴もバージョン管理システムによって追跡されることになります。

## 技術的詳細

このコミットは、Mercurialのタグ付けメカニズムを直接反映しています。Mercurialでは、`hg tag <tagname>`コマンドを実行すると、現在のリビジョン（または指定されたリビジョン）に対してタグが作成されます。この操作の内部では、Mercurialはリポジトリのルートにある`.hgtags`ファイルを更新します。具体的には、新しいタグ名とそのタグが指すコミットのハッシュ値のペアがファイルに追加されます。

この`.hgtags`ファイルへの変更は、通常のファイル変更と同様に扱われ、コミットとしてリポジトリに記録されます。したがって、このコミットは、`weekly.2011-11-18`というタグが、`b4a91b6933748db1a7150c06a1b55ad506e52906`というコミットハッシュに割り当てられたことを示しています。

このアプローチは、タグ情報自体がリポジトリの履歴の一部としてバージョン管理されるという利点があります。これにより、タグの作成、変更、削除の履歴も追跡可能になります。Goプロジェクトは後にGitに移行しましたが、このコミットはMercurial時代のGoプロジェクトのリリース管理の仕組みを理解する上で重要な手がかりとなります。

## コアとなるコードの変更箇所

```diff
--- a/.hgtags
+++ b/.hgtags
@@ -94,3 +94,5 @@ e69e528f2afc25a8334cfb9359fa4fcdf2a934b6 weekly.2011-11-01
 780c85032b174c9d4b42adf75d82bc85af7d78d1 weekly.2011-11-02
 f4397ad6e87c7ce5feac9b01686f1ebd6cbaac4e weekly.2011-11-08
 2f4482b89a6b5956828872137b6b96636cd904d3 weekly.2011-11-09
+b4a91b6933748db1a7150c06a1b55ad506e52906 weekly.2011-11-18
+b4a91b6933748db1a7150c06a1b55ad506e52906 weekly
```

## コアとなるコードの解説

上記の差分は、`.hgtags`ファイルに2行が追加されたことを示しています。

1.  `b4a91b6933748db1a7150c06a1b55ad506e52906 weekly.2011-11-18`
    *   これは、コミットハッシュ `b4a91b6933748db1a7150c06a1b55ad506e52906` に `weekly.2011-11-18` というタグが割り当てられたことを意味します。`weekly.2011-11-18` は、2011年11月18日の週次リリースを示すタグ名です。

2.  `b4a91b6933748db1a7150c06a1b55ad506e52906 weekly`
    *   これは、同じコミットハッシュ `b4a91b6933748db1a7150c06a1b55ad506e52906` に `weekly` というタグが割り当てられたことを意味します。これはおそらく、最新の週次リリースを指す汎用的なタグとして使用されていたと考えられます。

これらの行の追加により、Mercurialリポジトリのタグ情報が更新され、特定のコミットが正式に週次リリースとしてマークされました。

## 関連リンク

*   GitHubコミットページ: [https://github.com/golang/go/commit/95474b6283d1f2568757ce71f7dace2c1ef7b12e](https://github.com/golang/go/commit/95474b6283d1f2568757ce71f7dace2c1ef7b12e)
*   Go Code Review (CL): [https://golang.org/cl/5413052](https://golang.org/cl/5413052)

## 参考にした情報源リンク

*   Go言語のリリースサイクル: [https://go.dev/doc/devel/release](https://go.dev/doc/devel/release)
*   Mercurialのタグ付け: [https://www.mercurial-scm.org/wiki/Tag](https://www.mercurial-scm.org/wiki/Tag)
*   Mercurialの`.hgtags`ファイルに関する情報: [https://www.mercurial-scm.org/wiki/hgtags](https://www.mercurial-scm.org/wiki/hgtags)
*   Goプロジェクトのバージョン管理システムの歴史（MercurialからGitへの移行）に関する情報: [https://swtch.com/~rsc/go-git.html](https://swtch.com/~rsc/go-git.html)
