golang/goのコミットを生成AIに解説させた。正確性は検証してない。

## TODO

- [x] git submoduleを設定してリポジトリを持ってくる
- [x] より正確になるようなフロー設計する
- [x] 定期実行する
- [x] Claude Codeだとリミットが来ても止まらない
- [x] CLIライブラリを入れて、それぞれ別ファイルに分ける
  - 複雑な部分に関してはpackageも分けていく
- [ ] リンク化する
- [ ] ページタイトルをコミット名にする
- [x] テスト可能にする
- [x] ジョブキューイング部分、ワーカーで明確に分割してわかりやすくする
- [x] 実行中の表示をわかりやすくしたい
  - それぞれのワーカーでの表示
  - 本文などの余計な表示はしない
- [ ] ワーカー部分もテストしやすくする
- [x] 各CLIでのlimit checkを関数に切り出す
- [ ] 品質チェックを関数に切り出す
- [x] 品質チェックを通らなかった場合は生成mdを削除して再キューイングする
- [ ] 各ワーカーでのリクエスト実行回数をカウントする
- [x] 実行スクリプト作成部分を関数に切り出す + テストを作る
- [ ] モックなどでlimit時の挙動をテスト可能にする
- [ ] リセット時間コントロール用にwakeupする定期実行ワーカーを追加する
  - 特定時間にecho helloなどの簡単なリクエストを送って実行できるか確認する
- [x] 標準出力が多すぎる。ログレベルを設定し、デフォルトのレベルではキュー情報のみを表示する
- [x] exceedの場合はリトライカウントを増やさずに1時間停止する
- [x] exceedの場合はリトライしない
- [x] ファイル書き込みは言語側でやる
- [ ] CLI名をenum化する。そのほかにもできそうなところがあれば
- [ ] ナンバーサインの前の文字列は消す
- [ ] configにquota errorsがあるが、これは使っているのか?

キューが受け入れる余裕があるときだけキューイングする。
キューには各CLIごとに1つだけ入る(数は設定ですぐ変更できる)
キューイングされたものを、ワーカーが実行し結果を返す
実行が成功するとキューから取り除かれる
quota errorの場合は、そのCLI種別のワーカーの実行を1時間スリープする。キューにのこったままになる。

キューがquota errorで失敗した場合、retryキューに入れる。retryキューは1時間待って再実行する。10回リトライする。
品質テストに合格しなかった場合は3回retryする。失敗にする

キューはCLIごとにある。タスクにはステータスが設定されている。

イベントのステータス

- 実行中
- リトライ待ち(タスクによって異なる長さ。quota errorの場合は1時間待つ、品質テストエラーの場合は10秒)
- 失敗
- 成功

遷移

- 実行中
  -> リトライ待ち
- リトライ待ち
  -> リトライ待ち
  -> 失敗

- 実行タスクを、記録する
  - writerで注入可能にしておき、タスクの実行結果をログファイルに保存する
  - 1つのタスクが失敗 → 再実行されると、2つのログが残る
  - 失敗時はエラー内容が入る

- スクリプトの標準出力からコンテンツの品質判定しているが、truncateされてるっぽい。実際のファイルから判定させたい
- 責務分離のため、キュー、ワーカー、スケジューラをpackage分割してください
  - execute
    - queue
    - worker
    - scheduler
    - execute

## run

```shell
docker compose up -d
```

## submodule

```shell
git submodule update --init
git submodule update --remote
```
