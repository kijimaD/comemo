commit dd7cbf3a846c2cb125ac65173abaf6a8b9f903ff
Author: Keith Randall <khr@google.com>
Date:   Mon Dec 4 14:47:32 2017 -0800

    cmd/compile: fix map assignment with panicking right-hand side
    
    Make sure that when we're assigning to a map, we evaluate the
    right-hand side before we attempt to insert into the map.
    
    We used to evaluate the left-hand side to a pointer-to-slot-in-bucket
    (which as a side effect does len(m)++), then evaluate the right-hand side,
    then do the assignment. That clearly isn't correct when the right-hand side
    might panic.
    
    Fixes #22881
    
    Change-Id: I42a62870ff4bf480568c9bdbf0bb18958962bdf0
    Reviewed-on: https://go-review.googlesource.com/81817
    Reviewed-by: Matthew Dempsky <mdempsky@google.com>

 src/cmd/compile/internal/gc/order.go |  9 ++++-
 test/fixedbugs/issue22881.go         | 72 ++++++++++++++++++++++++++++++++++++
 2 files changed, 79 insertions(+), 2 deletions(-)
