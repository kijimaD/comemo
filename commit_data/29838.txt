commit 9d88292c83c17f065485d0c8fa0439f2d9e5cca2
Author: Adam Langley <agl@golang.org>
Date:   Tue Oct 11 10:08:57 2016 -0700

    crypto/tls: switch to OpenSSL 1.1.0 for test data.
    
    We will need OpenSSL 1.1.0 in order to test some of the features
    expected for Go 1.8. However, 1.1.0 also disables (by default) some
    things that we still want to test, such as RC4, 3DES and SSLv3. Thus
    developers wanting to update the crypto/tls test data will need to build
    OpenSSL from source.
    
    This change updates the test data with transcripts generated by 1.1.0
    (in order to reduce future diffs) and also causes a banner to be printed
    if 1.1.0 is not used when updating.
    
    (The test for an ALPN mismatch is removed because OpenSSL now terminates
    the connection with a fatal alert if no known ALPN protocols are
    offered. There's no point testing against this because it's an OpenSSL
    behaviour.)
    
    Change-Id: I957516975e0b8c7def84184f65c81d0b68f1c551
    Reviewed-on: https://go-review.googlesource.com/30821
    Run-TryBot: Adam Langley <agl@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
---
 src/crypto/tls/alert.go                            |   2 +
 src/crypto/tls/handshake_client_test.go            |  29 +-
 src/crypto/tls/handshake_server_test.go            |  16 +-
 src/crypto/tls/handshake_test.go                   |  49 +-
 .../testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA  |  89 +--
 .../testdata/Client-TLSv10-ClientCert-ECDSA-RSA    | 161 ++---
 .../testdata/Client-TLSv10-ClientCert-RSA-ECDSA    |  89 +--
 .../tls/testdata/Client-TLSv10-ClientCert-RSA-RSA  | 161 ++---
 .../tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES     |  70 +--
 .../tls/testdata/Client-TLSv10-ECDHE-RSA-AES       |  66 +-
 src/crypto/tls/testdata/Client-TLSv10-RSA-RC4      |  30 +-
 .../tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES     |  68 +--
 .../tls/testdata/Client-TLSv11-ECDHE-RSA-AES       |  66 +-
 src/crypto/tls/testdata/Client-TLSv11-RSA-RC4      |  30 +-
 .../tls/testdata/Client-TLSv12-AES128-GCM-SHA256   |  34 +-
 .../tls/testdata/Client-TLSv12-AES128-SHA256       |  48 +-
 .../tls/testdata/Client-TLSv12-AES256-GCM-SHA384   |  34 +-
 src/crypto/tls/testdata/Client-TLSv12-ALPN         |  60 +-
 .../testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA  |  93 +--
 .../testdata/Client-TLSv12-ClientCert-ECDSA-RSA    | 164 ++---
 .../Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384 |  84 +--
 .../testdata/Client-TLSv12-ClientCert-RSA-ECDSA    |  91 +--
 .../tls/testdata/Client-TLSv12-ClientCert-RSA-RSA  | 162 ++---
 .../tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES     |  70 +--
 .../tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM |  64 +-
 .../Client-TLSv12-ECDHE-ECDSA-AES128-SHA256        |  76 +--
 .../Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384    |  64 +-
 .../tls/testdata/Client-TLSv12-ECDHE-RSA-AES       |  66 +-
 .../testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256 |  74 +--
 src/crypto/tls/testdata/Client-TLSv12-RSA-RC4      |  30 +-
 .../tls/testdata/Client-TLSv12-RenegotiateOnce     | 366 +++++------
 .../tls/testdata/Client-TLSv12-RenegotiateTwice    | 670 +++++++++++----------
 .../Client-TLSv12-RenegotiateTwiceRejected         | 374 ++++++------
 .../testdata/Client-TLSv12-RenegotiationRejected   |  70 +--
 src/crypto/tls/testdata/Client-TLSv12-SCT          |  60 +-
 src/crypto/tls/testdata/Server-SSLv3-RSA-3DES      |  58 +-
 src/crypto/tls/testdata/Server-SSLv3-RSA-AES       |  60 +-
 src/crypto/tls/testdata/Server-SSLv3-RSA-RC4       |  50 +-
 .../tls/testdata/Server-TLSv10-ECDHE-ECDSA-AES     |  79 ++-
 src/crypto/tls/testdata/Server-TLSv10-RSA-3DES     |  52 +-
 src/crypto/tls/testdata/Server-TLSv10-RSA-AES      |  58 +-
 src/crypto/tls/testdata/Server-TLSv10-RSA-RC4      |  46 +-
 src/crypto/tls/testdata/Server-TLSv11-FallbackSCSV |  20 +-
 src/crypto/tls/testdata/Server-TLSv11-RSA-RC4      |  46 +-
 src/crypto/tls/testdata/Server-TLSv12-ALPN         |  96 ++-
 src/crypto/tls/testdata/Server-TLSv12-ALPN-NoMatch |  96 ++-
 .../Server-TLSv12-CipherSuiteCertPreferenceECDSA   |  94 ++-
 .../Server-TLSv12-CipherSuiteCertPreferenceRSA     |  88 ++-
 .../Server-TLSv12-ClientAuthRequestedAndECDSAGiven |  77 +--
 .../Server-TLSv12-ClientAuthRequestedAndGiven      |  77 +--
 .../Server-TLSv12-ClientAuthRequestedNotGiven      |  59 +-
 .../tls/testdata/Server-TLSv12-ECDHE-ECDSA-AES     |  75 ++-
 src/crypto/tls/testdata/Server-TLSv12-IssueTicket  |  71 ++-
 .../testdata/Server-TLSv12-IssueTicketPreDisable   |  71 ++-
 src/crypto/tls/testdata/Server-TLSv12-RSA-3DES     |  55 +-
 src/crypto/tls/testdata/Server-TLSv12-RSA-AES      |  59 +-
 src/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM  |  65 +-
 .../testdata/Server-TLSv12-RSA-AES256-GCM-SHA384   |  65 +-
 src/crypto/tls/testdata/Server-TLSv12-RSA-RC4      |  49 +-
 src/crypto/tls/testdata/Server-TLSv12-Resume       |  63 +-
 .../tls/testdata/Server-TLSv12-ResumeDisabled      |  76 +--
 src/crypto/tls/testdata/Server-TLSv12-SNI          |  60 +-
 .../tls/testdata/Server-TLSv12-SNI-GetCertificate  |  60 +-
 .../Server-TLSv12-SNI-GetCertificateNotFound       |  60 +-
 64 files changed, 2840 insertions(+), 2725 deletions(-)

diff --git a/src/crypto/tls/alert.go b/src/crypto/tls/alert.go
index 9cf99224f5..4929868257 100644
--- a/src/crypto/tls/alert.go
+++ b/src/crypto/tls/alert.go
@@ -38,6 +38,7 @@ const (
 	alertInappropriateFallback  alert = 86
 	alertUserCanceled           alert = 90
 	alertNoRenegotiation        alert = 100
+	alertNoApplicationProtocol  alert = 120
 )
 
 var alertText = map[alert]string{
@@ -64,6 +65,7 @@ var alertText = map[alert]string{
 	alertInappropriateFallback:  "inappropriate fallback",
 	alertUserCanceled:           "user canceled",
 	alertNoRenegotiation:        "no renegotiation",
+	alertNoApplicationProtocol:  "no application protocol",
 }
 
 func (e alert) String() string {
diff --git a/src/crypto/tls/handshake_client_test.go b/src/crypto/tls/handshake_client_test.go
index 822d922026..23bf236ddf 100644
--- a/src/crypto/tls/handshake_client_test.go
+++ b/src/crypto/tls/handshake_client_test.go
@@ -77,7 +77,7 @@ func newOpensslOutputSink() *opensslOutputSink {
 
 // opensslEndOfHandshake is a message that the “openssl s_server” tool will
 // print when a handshake completes if run with “-state”.
-const opensslEndOfHandshake = "SSL_accept:SSLv3 write finished A"
+const opensslEndOfHandshake = "SSL_accept:SSLv3/TLS write finished"
 
 func (o *opensslOutputSink) Write(data []byte) (n int, err error) {
 	o.line = append(o.line, data...)
@@ -276,6 +276,8 @@ func (test *clientTest) loadData() (flows [][]byte, err error) {
 }
 
 func (test *clientTest) run(t *testing.T, write bool) {
+	checkOpenSSLVersion(t)
+
 	var clientConn, serverConn net.Conn
 	var recordingConn *recordingConn
 	var childProcess *exec.Cmd
@@ -542,7 +544,7 @@ func TestHandshakeClientCertRSA(t *testing.T) {
 
 	test := &clientTest{
 		name:    "ClientCert-RSA-RSA",
-		command: []string{"openssl", "s_server", "-cipher", "RC4-SHA", "-verify", "1"},
+		command: []string{"openssl", "s_server", "-cipher", "AES128", "-verify", "1"},
 		config:  config,
 	}
 
@@ -578,7 +580,7 @@ func TestHandshakeClientCertECDSA(t *testing.T) {
 
 	test := &clientTest{
 		name:    "ClientCert-ECDSA-RSA",
-		command: []string{"openssl", "s_server", "-cipher", "RC4-SHA", "-verify", "1"},
+		command: []string{"openssl", "s_server", "-cipher", "AES128", "-verify", "1"},
 		config:  config,
 	}
 
@@ -800,27 +802,6 @@ func TestHandshakeClientALPNMatch(t *testing.T) {
 	runClientTestTLS12(t, test)
 }
 
-func TestHandshakeClientALPNNoMatch(t *testing.T) {
-	config := testConfig.Clone()
-	config.NextProtos = []string{"proto3"}
-
-	test := &clientTest{
-		name: "ALPN-NoMatch",
-		// Note that this needs OpenSSL 1.0.2 because that is the first
-		// version that supports the -alpn flag.
-		command: []string{"openssl", "s_server", "-alpn", "proto1,proto2"},
-		config:  config,
-		validate: func(state ConnectionState) error {
-			// There's no overlap so OpenSSL will not select a protocol.
-			if state.NegotiatedProtocol != "" {
-				return fmt.Errorf("Got protocol %q, wanted ''", state.NegotiatedProtocol)
-			}
-			return nil
-		},
-	}
-	runClientTestTLS12(t, test)
-}
-
 // sctsBase64 contains data from `openssl s_client -serverinfo 18 -connect ritter.vg:443`
 const sctsBase64 = "ABIBaQFnAHUApLkJkLQYWBSHuxOizGdwCjw1mAT5G9+443fNDsgN3BAAAAFHl5nuFgAABAMARjBEAiAcS4JdlW5nW9sElUv2zvQyPoZ6ejKrGGB03gjaBZFMLwIgc1Qbbn+hsH0RvObzhS+XZhr3iuQQJY8S9G85D9KeGPAAdgBo9pj4H2SCvjqM7rkoHUz8cVFdZ5PURNEKZ6y7T0/7xAAAAUeX4bVwAAAEAwBHMEUCIDIhFDgG2HIuADBkGuLobU5a4dlCHoJLliWJ1SYT05z6AiEAjxIoZFFPRNWMGGIjskOTMwXzQ1Wh2e7NxXE1kd1J0QsAdgDuS723dc5guuFCaR+r4Z5mow9+X7By2IMAxHuJeqj9ywAAAUhcZIqHAAAEAwBHMEUCICmJ1rBT09LpkbzxtUC+Hi7nXLR0J+2PmwLp+sJMuqK+AiEAr0NkUnEVKVhAkccIFpYDqHOlZaBsuEhWWrYpg2RtKp0="
 
diff --git a/src/crypto/tls/handshake_server_test.go b/src/crypto/tls/handshake_server_test.go
index f64d977108..9c39d21c2c 100644
--- a/src/crypto/tls/handshake_server_test.go
+++ b/src/crypto/tls/handshake_server_test.go
@@ -558,6 +558,8 @@ func (test *serverTest) loadData() (flows [][]byte, err error) {
 }
 
 func (test *serverTest) run(t *testing.T, write bool) {
+	checkOpenSSLVersion(t)
+
 	var clientConn, serverConn net.Conn
 	var recordingConn *recordingConn
 	var childProcess *exec.Cmd
@@ -925,13 +927,13 @@ func TestResumption(t *testing.T) {
 
 	test := &serverTest{
 		name:    "IssueTicket",
-		command: []string{"openssl", "s_client", "-cipher", "RC4-SHA", "-sess_out", sessionFilePath},
+		command: []string{"openssl", "s_client", "-cipher", "AES128-SHA", "-sess_out", sessionFilePath},
 	}
 	runServerTestTLS12(t, test)
 
 	test = &serverTest{
 		name:    "Resume",
-		command: []string{"openssl", "s_client", "-cipher", "RC4-SHA", "-sess_in", sessionFilePath},
+		command: []string{"openssl", "s_client", "-cipher", "AES128-SHA", "-sess_in", sessionFilePath},
 	}
 	runServerTestTLS12(t, test)
 }
@@ -944,7 +946,7 @@ func TestResumptionDisabled(t *testing.T) {
 
 	test := &serverTest{
 		name:    "IssueTicketPreDisable",
-		command: []string{"openssl", "s_client", "-cipher", "RC4-SHA", "-sess_out", sessionFilePath},
+		command: []string{"openssl", "s_client", "-cipher", "AES128-SHA", "-sess_out", sessionFilePath},
 		config:  config,
 	}
 	runServerTestTLS12(t, test)
@@ -953,7 +955,7 @@ func TestResumptionDisabled(t *testing.T) {
 
 	test = &serverTest{
 		name:    "ResumeDisabled",
-		command: []string{"openssl", "s_client", "-cipher", "RC4-SHA", "-sess_in", sessionFilePath},
+		command: []string{"openssl", "s_client", "-cipher", "AES128-SHA", "-sess_in", sessionFilePath},
 		config:  config,
 	}
 	runServerTestTLS12(t, test)
@@ -1058,14 +1060,14 @@ func TestClientAuth(t *testing.T) {
 
 	test := &serverTest{
 		name:    "ClientAuthRequestedNotGiven",
-		command: []string{"openssl", "s_client", "-no_ticket", "-cipher", "RC4-SHA"},
+		command: []string{"openssl", "s_client", "-no_ticket", "-cipher", "AES128-SHA"},
 		config:  config,
 	}
 	runServerTestTLS12(t, test)
 
 	test = &serverTest{
 		name:              "ClientAuthRequestedAndGiven",
-		command:           []string{"openssl", "s_client", "-no_ticket", "-cipher", "RC4-SHA", "-cert", certPath, "-key", keyPath},
+		command:           []string{"openssl", "s_client", "-no_ticket", "-cipher", "AES128-SHA", "-cert", certPath, "-key", keyPath},
 		config:            config,
 		expectedPeerCerts: []string{clientCertificatePEM},
 	}
@@ -1073,7 +1075,7 @@ func TestClientAuth(t *testing.T) {
 
 	test = &serverTest{
 		name:              "ClientAuthRequestedAndECDSAGiven",
-		command:           []string{"openssl", "s_client", "-no_ticket", "-cipher", "RC4-SHA", "-cert", ecdsaCertPath, "-key", ecdsaKeyPath},
+		command:           []string{"openssl", "s_client", "-no_ticket", "-cipher", "AES128-SHA", "-cert", ecdsaCertPath, "-key", ecdsaKeyPath},
 		config:            config,
 		expectedPeerCerts: []string{clientECDSACertificatePEM},
 	}
diff --git a/src/crypto/tls/handshake_test.go b/src/crypto/tls/handshake_test.go
index ed218588d3..8e5410a17d 100644
--- a/src/crypto/tls/handshake_test.go
+++ b/src/crypto/tls/handshake_test.go
@@ -13,9 +13,11 @@ import (
 	"io"
 	"io/ioutil"
 	"net"
+	"os/exec"
 	"strconv"
 	"strings"
 	"sync"
+	"testing"
 )
 
 // TLS reference tests run a connection against a reference implementation
@@ -35,7 +37,52 @@ import (
 // generate fresh random numbers, large parts of the reference connection will
 // always change.
 
-var update = flag.Bool("update", false, "update golden files on disk")
+var (
+	update = flag.Bool("update", false, "update golden files on disk")
+
+	opensslVersionTestOnce sync.Once
+	opensslVersionTestErr  error
+)
+
+func checkOpenSSLVersion(t *testing.T) {
+	opensslVersionTestOnce.Do(testOpenSSLVersion)
+	if opensslVersionTestErr != nil {
+		t.Fatal(opensslVersionTestErr)
+	}
+}
+
+func testOpenSSLVersion() {
+	// This test ensures that the version of OpenSSL looks reasonable
+	// before updating the test data.
+
+	if !*update {
+		return
+	}
+
+	openssl := exec.Command("openssl", "version")
+	output, err := openssl.CombinedOutput()
+	if err != nil {
+		opensslVersionTestErr = err
+		return
+	}
+
+	version := string(output)
+	if strings.HasPrefix(version, "OpenSSL 1.1.0") {
+		return
+	}
+
+	println("***********************************************")
+	println("")
+	println("You need to build OpenSSL 1.1.0 from source in order")
+	println("to update the test data.")
+	println("")
+	println("Configure it with:")
+	println("./Configure enable-weak-ssl-ciphers enable-ssl3 enable-ssl3-method -static linux-x86_64")
+	println("and then add the apps/ directory at the front of your PATH.")
+	println("***********************************************")
+
+	opensslVersionTestErr = errors.New("version of OpenSSL does not appear to be suitable for updating test data")
+}
 
 // recordingConn is a net.Conn that records the traffic that passes through it.
 // WriteTo can be used to produce output that can be later be loaded with
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA
index 3709744edf..8d16d8b8bd 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA
@@ -9,11 +9,11 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 59 02 00 00  55 03 01 e1 f3 09 aa 74  |....Y...U......t|
-00000010  61 78 98 9e 67 71 72 06  52 62 67 4d a3 ee 63 b3  |ax..gqr.RbgM..c.|
-00000020  5f a2 3b 5a 16 34 46 08  d6 5d 37 20 f2 1c 60 07  |_.;Z.4F..]7 ..`.|
-00000030  19 16 cf d8 c6 d2 f3 b1  67 79 2a 3b 3b 9c e3 c6  |........gy*;;...|
-00000040  d7 9d 15 32 14 9d 46 81  0a 73 86 44 c0 09 00 00  |...2..F..s.D....|
+00000000  16 03 01 00 59 02 00 00  55 03 01 20 f3 26 a5 ad  |....Y...U.. .&..|
+00000010  ee a8 a9 b7 26 5f 94 f5  56 bc 50 07 70 b8 71 9f  |....&_..V.P.p.q.|
+00000020  98 0a d2 fb a6 74 84 8c  bb ac 66 20 bc f2 63 e9  |.....t....f ..c.|
+00000030  e4 84 44 8a 53 3b e4 67  24 99 af e0 79 03 f5 ac  |..D.S;.g$...y...|
+00000040  6d 18 19 b0 e5 54 ab 0f  6d b7 00 09 c0 09 00 00  |m....T..m.......|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  01 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,21 +48,22 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 01 00 d6 0c 00  00 d2 03 00 17 41 04 52  |*............A.R|
-00000280  4c a0 cf a0 77 26 e4 f5  f5 15 04 8b d9 cc 11 dc  |L...w&..........|
-00000290  80 75 fb f3 bc 2b b4 8b  14 fc ca ea 54 88 ef 5b  |.u...+......T..[|
-000002a0  5c 33 9b 3c 20 41 ef c4  e0 34 4b 8b ab be d7 92  |\3.< A...4K.....|
-000002b0  fc 1b 86 fc e1 36 9a 6f  81 fc 1c b8 1f a7 99 00  |.....6.o........|
-000002c0  8b 30 81 88 02 42 00 b5  bf 87 11 17 2f bd 9a c0  |.0...B....../...|
-000002d0  16 67 27 8e e8 f4 c5 55  cf 37 c3 0f 91 3c c9 f5  |.g'....U.7...<..|
-000002e0  92 d0 89 e3 9c 05 cb 58  b2 a9 9b 7c cf 29 6e 68  |.......X...|.)nh|
-000002f0  38 70 f9 4b ba ac 96 0e  1e 41 f8 84 98 3e b8 df  |8p.K.....A...>..|
-00000300  f4 fe c7 15 cd 7d 96 2d  02 42 01 71 92 66 de 2a  |.....}.-.B.q.f.*|
-00000310  03 f7 a0 e5 d6 b8 3e a9  26 a0 77 7c ab 4c 9b 5d  |......>.&.w|.L.]|
-00000320  b1 88 0d c0 ce 33 02 95  9f 74 b9 a2 bb db 5e 59  |.....3...t....^Y|
-00000330  f4 61 f4 79 78 ef ca ba  08 68 6e 63 fc 06 0a 10  |.a.yx....hnc....|
-00000340  84 b3 a1 ea 98 86 c4 a5  d2 7d 9d b7 16 03 01 00  |.........}......|
-00000350  0e 0d 00 00 06 03 01 02  40 00 00 0e 00 00 00     |........@......|
+00000270  2a 16 03 01 00 d6 0c 00  00 d2 03 00 17 41 04 a3  |*............A..|
+00000280  80 39 df 4d a8 89 ae 9e  42 8c 51 ec c3 e3 9f d0  |.9.M....B.Q.....|
+00000290  46 25 b0 77 0e 95 35 c5  3e 54 e8 cc 68 56 b8 7e  |F%.w..5.>T..hV.~|
+000002a0  30 70 2e 10 b8 1e 9b 17  b2 a0 10 91 94 aa 6b d8  |0p............k.|
+000002b0  2d db 7f 1d 88 01 fa c0  73 ba 6a 49 eb 29 2b 00  |-.......s.jI.)+.|
+000002c0  8b 30 81 88 02 42 01 70  4e 19 a6 64 ea 41 c6 6b  |.0...B.pN..d.A.k|
+000002d0  35 3b d7 83 70 34 5f 73  5c 2f 45 e8 de ca 26 3c  |5;..p4_s\/E...&<|
+000002e0  b0 54 98 85 a8 95 19 ad  70 eb 95 48 b1 f2 67 58  |.T......p..H..gX|
+000002f0  23 ba 27 80 30 f3 df 61  30 51 3f 15 c3 df fb d5  |#.'.0..a0Q?.....|
+00000300  70 46 53 69 99 aa 5a 60  02 42 00 e7 5c 71 05 32  |pFSi..Z`.B..\q.2|
+00000310  19 1a c2 23 2d 6a 03 1f  d2 1f 75 9f 74 67 34 90  |...#-j....u.tg4.|
+00000320  52 90 12 ca a6 f2 1f 3f  21 6c 24 e1 40 50 4f 49  |R......?!l$.@POI|
+00000330  dc a5 68 83 1c 83 94 59  38 c3 5e ca 51 83 41 c0  |..h....Y8.^.Q.A.|
+00000340  b6 7c 35 c4 60 48 3a dc  1a 9d 91 dd 16 03 01 00  |.|5.`H:.........|
+00000350  0a 0d 00 00 06 03 01 02  40 00 00 16 03 01 00 04  |........@.......|
+00000360  0e 00 00 00                                       |....|
 >>> Flow 3 (client to server)
 00000000  16 03 01 02 0a 0b 00 02  06 00 02 03 00 02 00 30  |...............0|
 00000010  82 01 fc 30 82 01 5e 02  09 00 9a 30 84 6c 26 35  |...0..^....0.l&5|
@@ -102,29 +103,29 @@
 00000230  24 20 3e b2 56 1c ce 97  28 5e f8 2b 2d 4f 9e f1  |$ >.V...(^.+-O..|
 00000240  07 9f 6c 4b 5b 83 56 e2  32 42 e9 58 b6 d7 49 a6  |..lK[.V.2B.X..I.|
 00000250  b5 68 1a 41 03 56 6b dc  5a 89 16 03 01 00 91 0f  |.h.A.Vk.Z.......|
-00000260  00 00 8d 00 8b 30 81 88  02 42 01 d7 78 09 ea ca  |.....0...B..x...|
-00000270  28 67 36 42 ba f4 eb c7  c7 b3 08 29 76 e4 b0 1a  |(g6B.......)v...|
-00000280  ad 25 12 8d 4a 8d 8f e5  ad b1 6b d3 7f 1a ff 48  |.%..J.....k....H|
-00000290  d3 1c 5e f4 ce ff 75 c2  46 df f0 30 b3 f8 b9 77  |..^...u.F..0...w|
-000002a0  6e eb f8 81 56 27 06 f3  30 15 c2 ca 02 42 00 8d  |n...V'..0....B..|
-000002b0  d3 0d a2 49 0b 47 6d 7a  64 8d 83 95 7b 60 23 d1  |...I.Gmzd...{`#.|
-000002c0  46 4d 23 6f a7 e0 35 2d  d4 95 49 7d e5 1e ed eb  |FM#o..5-..I}....|
-000002d0  b8 64 f4 9e 78 33 ae f5  e7 cb 72 88 7d e1 f3 47  |.d..x3....r.}..G|
-000002e0  5e f2 ed 33 23 5e b1 a2  c1 34 d2 59 c7 83 3e 20  |^..3#^...4.Y..> |
-000002f0  14 03 01 00 01 01 16 03  01 00 30 ae 61 41 6c b4  |..........0.aAl.|
-00000300  a6 b1 bb b8 d9 9c 3c 82  47 ab c4 bc 1a da 4f 0a  |......<.G.....O.|
-00000310  cc bd 7b 4d e1 16 0b 08  03 8c 54 d9 71 9d 58 cb  |..{M......T.q.X.|
-00000320  4d 90 74 e4 f3 6d 80 19  6b d6 a7                 |M.t..m..k..|
+00000260  00 00 8d 00 8b 30 81 88  02 42 01 37 15 41 67 9a  |.....0...B.7.Ag.|
+00000270  9b cb 2e d9 0a c0 b9 a8  47 00 81 da f8 9b bc d7  |........G.......|
+00000280  e9 89 5a fe c9 9e 7e d1  15 4b 6a 97 a0 90 c7 e8  |..Z...~..Kj.....|
+00000290  41 cb 65 39 f0 6c e7 51  7b ff 76 70 f7 94 39 23  |A.e9.l.Q{.vp..9#|
+000002a0  5c 4e 02 8d 4c b5 88 ad  77 d1 2d 33 02 42 01 41  |\N..L...w.-3.B.A|
+000002b0  06 ed 39 1b a4 ab 7a 8d  62 ce e4 aa 3a 7e b8 82  |..9...z.b...:~..|
+000002c0  04 c9 af 95 28 0d 28 69  a5 db bc fe d7 8b 73 17  |....(.(i......s.|
+000002d0  cf 1e 76 52 2d fa 05 96  be 30 a3 c6 78 10 02 4b  |..vR-....0..x..K|
+000002e0  4e d3 41 bb e0 0a a5 79  0a 60 80 bd cd 59 05 df  |N.A....y.`...Y..|
+000002f0  14 03 01 00 01 01 16 03  01 00 30 c4 d3 dc 0b 45  |..........0....E|
+00000300  cd 3a 35 45 60 d9 02 f5  ec a3 da 25 58 d8 9e e4  |.:5E`......%X...|
+00000310  af 44 d5 38 5a 90 6d 0e  58 d7 bd 77 3f 36 8c eb  |.D.8Z.m.X..w?6..|
+00000320  4e ea f3 07 eb ce e1 1f  7a c9 b0                 |N.......z..|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 97 b9 5b fd 48  |..........0..[.H|
-00000010  b5 b8 12 a3 8b 6b 25 57  5b e4 03 6e c6 3e fd 32  |.....k%W[..n.>.2|
-00000020  18 50 a3 15 3f 56 f6 70  38 b6 4c 1f a5 d7 82 eb  |.P..?V.p8.L.....|
-00000030  b9 3e f6 44 66 12 5d 6a  38 1c f1                 |.>.Df.]j8..|
+00000000  14 03 01 00 01 01 16 03  01 00 30 d2 18 a6 c2 9d  |..........0.....|
+00000010  1e 31 18 80 da 63 9b 65  b8 b0 ed 9d d6 86 94 81  |.1...c.e........|
+00000020  5e 67 69 a1 2c bd 9b 8a  cf 5f 49 75 4e d4 17 fc  |^gi.,...._IuN...|
+00000030  2c 62 70 2e fb 02 65 7e  c8 ba bd                 |,bp...e~...|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 94 a2 0d  d2 54 24 8b 81 eb d3 e2  |.... ....T$.....|
-00000010  3c d5 a1 f6 97 c3 45 8e  6c 26 b8 e1 ae 22 e8 94  |<.....E.l&..."..|
-00000020  30 41 2c 1d 3f 17 03 01  00 20 95 76 96 d1 f2 6d  |0A,.?.... .v...m|
-00000030  64 39 c7 0e a6 7c 56 56  13 0d bb f9 24 ef 64 32  |d9...|VV....$.d2|
-00000040  1e 49 d7 97 c1 2e 23 5f  02 51 15 03 01 00 20 a0  |.I....#_.Q.... .|
-00000050  17 61 eb 8e e1 63 cf 80  4d a3 ee 6a 99 6c 3a 39  |.a...c..M..j.l:9|
-00000060  b0 a4 48 26 37 58 ab 3a  21 67 1a 48 2b 88 35     |..H&7X.:!g.H+.5|
+00000000  17 03 01 00 20 f9 4a aa  90 28 c4 ca 6e 44 c8 8b  |.... .J..(..nD..|
+00000010  a7 97 bb 3b 58 46 bf dc  21 28 73 52 71 d2 12 90  |...;XF..!(sRq...|
+00000020  1b 74 ec e6 e0 17 03 01  00 20 fb 4d 93 22 1e 63  |.t....... .M.".c|
+00000030  31 b8 21 0e a1 46 26 48  cb 67 b8 cd 44 54 b2 a3  |1.!..F&H.g..DT..|
+00000040  b6 4d 47 67 7a e1 d8 c2  18 96 15 03 01 00 20 08  |.MGgz......... .|
+00000050  62 5e ed 25 ba 46 67 f5  61 29 e6 25 7e 41 5c b4  |b^.%.Fg.a).%~A\.|
+00000060  7f 12 05 13 9d c6 eb f2  8e 7c 37 81 51 09 c6     |.........|7.Q..|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA
index 8c726e7eb9..68ff000bea 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA
@@ -9,51 +9,65 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 51 02 00 00  4d 03 01 7b 56 22 f2 0d  |....Q...M..{V"..|
-00000010  53 16 b1 66 83 aa 0c 7c  4b ef 8f e3 58 82 4e ba  |S..f...|K...X.N.|
-00000020  5a 46 53 7f ca 1f 1d a8  b9 77 18 20 48 92 50 46  |ZFS......w. H.PF|
-00000030  51 e4 56 02 8c a4 92 c9  51 f2 85 75 91 99 86 fb  |Q.V.....Q..u....|
-00000040  c2 ab 5b 7c d0 bf 49 be  13 f3 91 3c 00 05 00 00  |..[|..I....<....|
-00000050  05 ff 01 00 01 00 16 03  01 02 59 0b 00 02 55 00  |..........Y...U.|
-00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
-00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
-00000080  09 2a 86 48 86 f7 0d 01  01 0b 05 00 30 1f 31 0b  |.*.H........0.1.|
-00000090  30 09 06 03 55 04 0a 13  02 47 6f 31 10 30 0e 06  |0...U....Go1.0..|
-000000a0  03 55 04 03 13 07 47 6f  20 52 6f 6f 74 30 1e 17  |.U....Go Root0..|
-000000b0  0d 31 36 30 31 30 31 30  30 30 30 30 30 5a 17 0d  |.160101000000Z..|
-000000c0  32 35 30 31 30 31 30 30  30 30 30 30 5a 30 1a 31  |250101000000Z0.1|
-000000d0  0b 30 09 06 03 55 04 0a  13 02 47 6f 31 0b 30 09  |.0...U....Go1.0.|
-000000e0  06 03 55 04 03 13 02 47  6f 30 81 9f 30 0d 06 09  |..U....Go0..0...|
-000000f0  2a 86 48 86 f7 0d 01 01  01 05 00 03 81 8d 00 30  |*.H............0|
-00000100  81 89 02 81 81 00 db 46  7d 93 2e 12 27 06 48 bc  |.......F}...'.H.|
-00000110  06 28 21 ab 7e c4 b6 a2  5d fe 1e 52 45 88 7a 36  |.(!.~...]..RE.z6|
-00000120  47 a5 08 0d 92 42 5b c2  81 c0 be 97 79 98 40 fb  |G....B[.....y.@.|
-00000130  4f 6d 14 fd 2b 13 8b c2  a5 2e 67 d8 d4 09 9e d6  |Om..+.....g.....|
-00000140  22 38 b7 4a 0b 74 73 2b  c2 34 f1 d1 93 e5 96 d9  |"8.J.ts+.4......|
-00000150  74 7b f3 58 9f 6c 61 3c  c0 b0 41 d4 d9 2b 2b 24  |t{.X.la<..A..++$|
-00000160  23 77 5b 1c 3b bd 75 5d  ce 20 54 cf a1 63 87 1d  |#w[.;.u]. T..c..|
-00000170  1e 24 c4 f3 1d 1a 50 8b  aa b6 14 43 ed 97 a7 75  |.$....P....C...u|
-00000180  62 f4 14 c8 52 d7 02 03  01 00 01 a3 81 93 30 81  |b...R.........0.|
-00000190  90 30 0e 06 03 55 1d 0f  01 01 ff 04 04 03 02 05  |.0...U..........|
-000001a0  a0 30 1d 06 03 55 1d 25  04 16 30 14 06 08 2b 06  |.0...U.%..0...+.|
-000001b0  01 05 05 07 03 01 06 08  2b 06 01 05 05 07 03 02  |........+.......|
-000001c0  30 0c 06 03 55 1d 13 01  01 ff 04 02 30 00 30 19  |0...U.......0.0.|
-000001d0  06 03 55 1d 0e 04 12 04  10 9f 91 16 1f 43 43 3e  |..U..........CC>|
-000001e0  49 a6 de 6d b6 80 d7 9f  60 30 1b 06 03 55 1d 23  |I..m....`0...U.#|
-000001f0  04 14 30 12 80 10 48 13  49 4d 13 7e 16 31 bb a3  |..0...H.IM.~.1..|
-00000200  01 d5 ac ab 6e 7b 30 19  06 03 55 1d 11 04 12 30  |....n{0...U....0|
-00000210  10 82 0e 65 78 61 6d 70  6c 65 2e 67 6f 6c 61 6e  |...example.golan|
-00000220  67 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |g0...*.H........|
-00000230  03 81 81 00 9d 30 cc 40  2b 5b 50 a0 61 cb ba e5  |.....0.@+[P.a...|
-00000240  53 58 e1 ed 83 28 a9 58  1a a9 38 a4 95 a1 ac 31  |SX...(.X..8....1|
-00000250  5a 1a 84 66 3d 43 d3 2d  d9 0b f2 97 df d3 20 64  |Z..f=C.-...... d|
-00000260  38 92 24 3a 00 bc cf 9c  7d b7 40 20 01 5f aa d3  |8.$:....}.@ ._..|
-00000270  16 61 09 a2 76 fd 13 c3  cc e1 0c 5c ee b1 87 82  |.a..v......\....|
-00000280  f1 6c 04 ed 73 bb b3 43  77 8d 0c 1c f1 0f a1 d8  |.l..s..Cw.......|
-00000290  40 83 61 c9 4c 72 2b 9d  ae db 46 06 06 4d f4 c1  |@.a.Lr+...F..M..|
-000002a0  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
-000002b0  3b e9 fa e7 16 03 01 00  0e 0d 00 00 06 03 01 02  |;...............|
-000002c0  40 00 00 0e 00 00 00                              |@......|
+00000000  16 03 01 00 59 02 00 00  55 03 01 eb c3 41 78 13  |....Y...U....Ax.|
+00000010  97 9b 30 68 60 69 74 7c  8d 2e 90 f6 e7 c8 28 21  |..0h`it|......(!|
+00000020  c4 67 b4 5b a0 f7 e1 1f  7f de b7 20 01 74 23 01  |.g.[....... .t#.|
+00000030  10 ed 5a b9 37 a0 f2 44  6b fd f6 6c 25 07 ef 25  |..Z.7..Dk..l%..%|
+00000040  4b 62 59 c6 ae 4b 82 e0  34 70 6d 40 c0 13 00 00  |KbY..K..4pm@....|
+00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
+00000060  01 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
+00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
+00000080  3f e2 5b ea a6 30 0d 06  09 2a 86 48 86 f7 0d 01  |?.[..0...*.H....|
+00000090  01 0b 05 00 30 1f 31 0b  30 09 06 03 55 04 0a 13  |....0.1.0...U...|
+000000a0  02 47 6f 31 10 30 0e 06  03 55 04 03 13 07 47 6f  |.Go1.0...U....Go|
+000000b0  20 52 6f 6f 74 30 1e 17  0d 31 36 30 31 30 31 30  | Root0...1601010|
+000000c0  30 30 30 30 30 5a 17 0d  32 35 30 31 30 31 30 30  |00000Z..25010100|
+000000d0  30 30 30 30 5a 30 1a 31  0b 30 09 06 03 55 04 0a  |0000Z0.1.0...U..|
+000000e0  13 02 47 6f 31 0b 30 09  06 03 55 04 03 13 02 47  |..Go1.0...U....G|
+000000f0  6f 30 81 9f 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |o0..0...*.H.....|
+00000100  01 05 00 03 81 8d 00 30  81 89 02 81 81 00 db 46  |.......0.......F|
+00000110  7d 93 2e 12 27 06 48 bc  06 28 21 ab 7e c4 b6 a2  |}...'.H..(!.~...|
+00000120  5d fe 1e 52 45 88 7a 36  47 a5 08 0d 92 42 5b c2  |]..RE.z6G....B[.|
+00000130  81 c0 be 97 79 98 40 fb  4f 6d 14 fd 2b 13 8b c2  |....y.@.Om..+...|
+00000140  a5 2e 67 d8 d4 09 9e d6  22 38 b7 4a 0b 74 73 2b  |..g....."8.J.ts+|
+00000150  c2 34 f1 d1 93 e5 96 d9  74 7b f3 58 9f 6c 61 3c  |.4......t{.X.la<|
+00000160  c0 b0 41 d4 d9 2b 2b 24  23 77 5b 1c 3b bd 75 5d  |..A..++$#w[.;.u]|
+00000170  ce 20 54 cf a1 63 87 1d  1e 24 c4 f3 1d 1a 50 8b  |. T..c...$....P.|
+00000180  aa b6 14 43 ed 97 a7 75  62 f4 14 c8 52 d7 02 03  |...C...ub...R...|
+00000190  01 00 01 a3 81 93 30 81  90 30 0e 06 03 55 1d 0f  |......0..0...U..|
+000001a0  01 01 ff 04 04 03 02 05  a0 30 1d 06 03 55 1d 25  |.........0...U.%|
+000001b0  04 16 30 14 06 08 2b 06  01 05 05 07 03 01 06 08  |..0...+.........|
+000001c0  2b 06 01 05 05 07 03 02  30 0c 06 03 55 1d 13 01  |+.......0...U...|
+000001d0  01 ff 04 02 30 00 30 19  06 03 55 1d 0e 04 12 04  |....0.0...U.....|
+000001e0  10 9f 91 16 1f 43 43 3e  49 a6 de 6d b6 80 d7 9f  |.....CC>I..m....|
+000001f0  60 30 1b 06 03 55 1d 23  04 14 30 12 80 10 48 13  |`0...U.#..0...H.|
+00000200  49 4d 13 7e 16 31 bb a3  01 d5 ac ab 6e 7b 30 19  |IM.~.1......n{0.|
+00000210  06 03 55 1d 11 04 12 30  10 82 0e 65 78 61 6d 70  |..U....0...examp|
+00000220  6c 65 2e 67 6f 6c 61 6e  67 30 0d 06 09 2a 86 48  |le.golang0...*.H|
+00000230  86 f7 0d 01 01 0b 05 00  03 81 81 00 9d 30 cc 40  |.............0.@|
+00000240  2b 5b 50 a0 61 cb ba e5  53 58 e1 ed 83 28 a9 58  |+[P.a...SX...(.X|
+00000250  1a a9 38 a4 95 a1 ac 31  5a 1a 84 66 3d 43 d3 2d  |..8....1Z..f=C.-|
+00000260  d9 0b f2 97 df d3 20 64  38 92 24 3a 00 bc cf 9c  |...... d8.$:....|
+00000270  7d b7 40 20 01 5f aa d3  16 61 09 a2 76 fd 13 c3  |}.@ ._...a..v...|
+00000280  cc e1 0c 5c ee b1 87 82  f1 6c 04 ed 73 bb b3 43  |...\.....l..s..C|
+00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
+000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
+000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 01 00  |.=.`.\!.;.......|
+000002c0  cb 0c 00 00 c7 03 00 17  41 04 c4 ae 64 f9 3a f5  |........A...d.:.|
+000002d0  95 29 e0 9c c1 d0 e3 e1  fa e1 f8 97 d0 69 4d b0  |.)...........iM.|
+000002e0  c0 4f cb 47 41 9c 85 32  b7 c8 71 4f c5 a1 5a ec  |.O.GA..2..qO..Z.|
+000002f0  4d 09 bc fc 07 7c 81 87  71 c7 6e f9 8b 59 f6 53  |M....|..q.n..Y.S|
+00000300  a4 eb 76 d1 2a 6d 55 5d  85 b8 00 80 3b 4f ab 1c  |..v.*mU]....;O..|
+00000310  aa ef 00 e7 7d 91 e2 73  c3 a4 d1 95 5a 6e 26 a9  |....}..s....Zn&.|
+00000320  85 15 25 ef 05 83 34 73  80 00 a6 0c df cd c7 6d  |..%...4s.......m|
+00000330  65 c6 f2 a7 23 68 0e 88  7e 7e 8e 03 4d 4b db 27  |e...#h..~~..MK.'|
+00000340  70 6a 32 2c e7 66 95 06  76 0f d7 4f ec 84 6a ee  |pj2,.f..v..O..j.|
+00000350  28 ed 90 17 f0 04 7f c5  39 a9 8b 53 bd 9a e3 51  |(.......9..S...Q|
+00000360  84 79 ee 32 ad 66 e8 77  da d9 31 4b 6b 5b f0 73  |.y.2.f.w..1Kk[.s|
+00000370  de 9f c5 b8 c7 09 06 f1  15 9d d3 3e 40 86 17 65  |...........>@..e|
+00000380  cd 47 74 4b c0 88 3f be  54 c1 ac fc 16 03 01 00  |.GtK..?.T.......|
+00000390  0a 0d 00 00 06 03 01 02  40 00 00 16 03 01 00 04  |........@.......|
+000003a0  0e 00 00 00                                       |....|
 >>> Flow 3 (client to server)
 00000000  16 03 01 02 0a 0b 00 02  06 00 02 03 00 02 00 30  |...............0|
 00000010  82 01 fc 30 82 01 5e 02  09 00 9a 30 84 6c 26 35  |...0..^....0.l&5|
@@ -88,33 +102,34 @@
 000001e0  be e8 91 b3 da 1a f5 5d  a3 23 f5 26 8b 45 70 8d  |.......].#.&.Ep.|
 000001f0  65 62 9b 7e 01 99 3d 18  f6 10 9a 38 61 9b 2e 57  |eb.~..=....8a..W|
 00000200  e4 fa cc b1 8a ce e2 23  a0 87 f0 e1 67 51 eb 16  |.......#....gQ..|
-00000210  03 01 00 86 10 00 00 82  00 80 b9 65 8d bf a7 c8  |...........e....|
-00000220  4b 79 ce 6f cb 8b 13 1c  ac b9 7d 66 5e e9 ba 1d  |Ky.o......}f^...|
-00000230  71 4e a9 e9 34 ae f6 64  65 90 3b d8 16 52 a2 6f  |qN..4..de.;..R.o|
-00000240  f4 cb 8a 13 74 a2 ee b7  27 69 b4 41 c0 90 68 bc  |....t...'i.A..h.|
-00000250  02 69 e1 c6 48 4f 39 36  30 25 ca 4c 17 ce 83 9e  |.i..HO960%.L....|
-00000260  08 56 e3 05 49 93 9e 2e  c4 fb e6 c8 01 f1 0f c5  |.V..I...........|
-00000270  70 0f 08 83 48 e9 48 ef  6e 50 8b 05 7e e5 84 25  |p...H.H.nP..~..%|
-00000280  fa 55 c7 ae 31 02 27 00  ef 3f 98 86 20 12 89 91  |.U..1.'..?.. ...|
-00000290  59 28 b4 f7 d7 af d2 69  61 35 16 03 01 00 91 0f  |Y(.....ia5......|
-000002a0  00 00 8d 00 8b 30 81 88  02 42 00 97 2e 05 89 ff  |.....0...B......|
-000002b0  06 c2 8f d1 a9 e1 73 8e  b5 a7 81 58 b8 a1 b0 18  |......s....X....|
-000002c0  df 42 e2 2f 6a a1 d9 dc  b4 f4 63 d1 23 25 90 61  |.B./j.....c.#%.a|
-000002d0  98 58 3d 69 3c 06 ef f2  0c 13 b2 31 56 bd 0e 8f  |.X=i<......1V...|
-000002e0  d4 4b 64 ea 30 aa 19 c8  86 f3 fd 46 02 42 00 94  |.Kd.0......F.B..|
-000002f0  eb 60 57 6b 26 0d 53 18  c6 73 6e 60 73 98 ff 2f  |.`Wk&.S..sn`s../|
-00000300  f2 80 eb 73 02 26 e9 4f  a5 42 3a 60 70 3c 52 7e  |...s.&.O.B:`p<R~|
-00000310  3a 31 f1 a8 42 7b 44 36  31 94 1b bf 78 0f a8 6d  |:1..B{D61...x..m|
-00000320  a6 fb f0 49 13 c6 71 6d  8f 44 a2 e0 41 cb ab fb  |...I..qm.D..A...|
-00000330  14 03 01 00 01 01 16 03  01 00 24 09 60 3f a5 1d  |..........$.`?..|
-00000340  8e b7 56 86 9b 6f 35 40  e7 e8 d6 1a ab fc f5 0d  |..V..o5@........|
-00000350  c5 a6 d7 2c 44 4b 6b 6d  22 79 1e e8 a2 31 a3     |...,DKkm"y...1.|
+00000210  03 01 00 46 10 00 00 42  41 04 1e 18 37 ef 0d 19  |...F...BA...7...|
+00000220  51 88 35 75 71 b5 e5 54  5b 12 2e 8f 09 67 fd a7  |Q.5uq..T[....g..|
+00000230  24 20 3e b2 56 1c ce 97  28 5e f8 2b 2d 4f 9e f1  |$ >.V...(^.+-O..|
+00000240  07 9f 6c 4b 5b 83 56 e2  32 42 e9 58 b6 d7 49 a6  |..lK[.V.2B.X..I.|
+00000250  b5 68 1a 41 03 56 6b dc  5a 89 16 03 01 00 91 0f  |.h.A.Vk.Z.......|
+00000260  00 00 8d 00 8b 30 81 88  02 42 01 03 05 ed 02 bd  |.....0...B......|
+00000270  ec d2 94 fd d9 d6 85 56  a0 b7 16 57 4a b7 91 15  |.......V...WJ...|
+00000280  50 9a 3d 08 fd 06 57 cc  65 e5 a8 26 15 dc 74 fe  |P.=...W.e..&..t.|
+00000290  7c 6b 81 10 7a 1c 3a 32  60 1a 2f e8 cc 4d dd da  ||k..z.:2`./..M..|
+000002a0  20 8a ac 1f eb dd a0 db  58 ef 79 c8 02 42 00 f7  | .......X.y..B..|
+000002b0  0f ca 90 34 ce 83 f0 dc  ec a5 5d 89 68 51 51 13  |...4......].hQQ.|
+000002c0  c6 a9 58 7d 11 cc 22 00  01 e3 04 16 3b 10 ed 93  |..X}..".....;...|
+000002d0  ab 1b b9 e4 89 95 44 5c  06 d4 2c a4 d1 e5 09 12  |......D\..,.....|
+000002e0  82 83 dc 72 f6 41 a9 d6  35 7f da 8a c8 f8 2b e6  |...r.A..5.....+.|
+000002f0  14 03 01 00 01 01 16 03  01 00 30 10 f3 9e aa 4e  |..........0....N|
+00000300  b7 50 bd 7c b4 54 e9 69  aa 49 7a 35 30 da 40 03  |.P.|.T.i.Iz50.@.|
+00000310  a8 48 c4 08 63 7a a1 84  f1 7f 83 6d 15 b1 b1 7d  |.H..cz.....m...}|
+00000320  30 94 27 9a bc a3 a0 bb  84 37 41                 |0.'......7A|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 24 3c c9 8b e2 93  |..........$<....|
-00000010  84 9e 3c ad e3 b6 9b 5f  4a e6 15 2b af d4 6f fa  |..<...._J..+..o.|
-00000020  84 0d f6 77 25 03 62 08  60 f2 78 be 91 d3 d0     |...w%.b.`.x....|
+00000000  14 03 01 00 01 01 16 03  01 00 30 53 ec 32 b9 5c  |..........0S.2.\|
+00000010  a8 9c 03 1e 95 92 5e 19  99 9a e7 3d fa af c5 60  |......^....=...`|
+00000020  d1 94 e0 93 fe 5d 68 e5  e3 51 67 13 c8 30 33 5f  |.....]h..Qg..03_|
+00000030  85 23 e2 cf c8 64 88 24  23 fe 93                 |.#...d.$#..|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 1a 18 d9 62  5f b8 cb 21 4b 75 d4 28  |.......b_..!Ku.(|
-00000010  48 37 46 98 aa ec 5f f3  6b 22 b3 92 1c 13 e3 15  |H7F..._.k"......|
-00000020  03 01 00 16 13 94 43 e8  cf f3 7c 4f 2a c3 ee a0  |......C...|O*...|
-00000030  80 fd 55 43 70 da 9d 88  21 f6                    |..UCp...!.|
+00000000  17 03 01 00 20 26 a5 85  22 18 01 84 5c 50 3b c4  |.... &.."...\P;.|
+00000010  17 58 fe 0e b3 a1 26 ec  94 8e b4 76 bd 84 7a ca  |.X....&....v..z.|
+00000020  fc 22 2c 31 d3 17 03 01  00 20 3c 0a 9a 91 f0 00  |.",1..... <.....|
+00000030  c6 69 b4 04 7d f7 8c 29  3c 7f 81 c1 79 f2 2c 34  |.i..}..)<...y.,4|
+00000040  c0 fd 21 6a b7 a3 28 9b  85 1b 15 03 01 00 20 7d  |..!j..(....... }|
+00000050  1e c7 62 ec b2 84 5f 65  30 6e 4c 7c ab bd 03 49  |..b..._e0nL|...I|
+00000060  ce 7f 0d 0c 2b 62 e1 32  01 0c 35 05 b9 f6 35     |....+b.2..5...5|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA
index ea6de37c51..84268f0956 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA
@@ -9,11 +9,11 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 59 02 00 00  55 03 01 96 29 16 36 60  |....Y...U...).6`|
-00000010  65 c0 59 5e 39 1b ad 11  d4 c2 d4 ee 60 ed 7c 0a  |e.Y^9.......`.|.|
-00000020  72 20 d8 ed da 53 e0 a3  64 43 5b 20 68 13 96 67  |r ...S..dC[ h..g|
-00000030  eb a5 c4 1f 31 48 d0 11  9d bc 63 64 1e b2 36 7c  |....1H....cd..6||
-00000040  48 f0 05 7e 81 2f 82 de  91 22 0d 74 c0 09 00 00  |H..~./...".t....|
+00000000  16 03 01 00 59 02 00 00  55 03 01 cd ab 47 9a 95  |....Y...U....G..|
+00000010  15 43 b4 22 d8 b7 ce 1a  70 6d 95 f4 45 36 17 78  |.C."....pm..E6.x|
+00000020  45 86 98 be 9c 89 e2 b1  29 ab 7c 20 74 18 07 6a  |E.......).| t..j|
+00000030  7c 6a 26 94 18 3a f7 01  f5 06 c0 99 58 fd e1 79  ||j&..:......X..y|
+00000040  e8 f0 3d 2e 7d 24 07 ac  ab 29 84 d1 c0 09 00 00  |..=.}$...)......|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  01 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,21 +48,22 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 01 00 d6 0c 00  00 d2 03 00 17 41 04 17  |*............A..|
-00000280  e7 29 66 88 e3 76 32 fb  5f 3d 44 5c 2e f3 9a f4  |.)f..v2._=D\....|
-00000290  8b 68 24 b7 5a fa e6 41  9d f9 57 32 72 89 94 e9  |.h$.Z..A..W2r...|
-000002a0  d4 0b ad ad c0 3c 08 ea  c0 61 8b bc fd f8 cd 36  |.....<...a.....6|
-000002b0  54 17 57 6f cb e7 8d 4c  35 49 35 27 3d b4 97 00  |T.Wo...L5I5'=...|
-000002c0  8b 30 81 88 02 42 00 9c  eb c1 18 55 df 1c ee e2  |.0...B.....U....|
-000002d0  13 00 cb aa 54 d2 bc ae  8a 1f 15 24 ca f2 99 e7  |....T......$....|
-000002e0  4d ec e0 74 a5 45 60 9f  ec af 4c a7 72 4a 14 0a  |M..t.E`...L.rJ..|
-000002f0  c2 33 5b b0 c7 82 6e 55  85 1d e2 57 ad 58 cc 06  |.3[...nU...W.X..|
-00000300  46 c5 5a f8 0a 6f ac bb  02 42 01 c6 5c 36 38 af  |F.Z..o...B..\68.|
-00000310  ed d2 2d c9 66 bf c3 ff  86 63 03 a4 57 d3 7b 91  |..-.f....c..W.{.|
-00000320  9b 02 3f 94 79 d9 38 5d  b5 46 80 ff 56 09 dc 91  |..?.y.8].F..V...|
-00000330  4a 72 4c 2a 8b 35 d8 a0  f1 82 bc 79 1f 4d 57 1d  |JrL*.5.....y.MW.|
-00000340  eb a0 a3 f8 5e dd 74 5d  c2 fc bc b4 16 03 01 00  |....^.t]........|
-00000350  0e 0d 00 00 06 03 01 02  40 00 00 0e 00 00 00     |........@......|
+00000270  2a 16 03 01 00 d5 0c 00  00 d1 03 00 17 41 04 18  |*............A..|
+00000280  50 7c d8 00 90 86 7e 8b  a3 e8 fa 9e 06 2b 40 df  |P|....~......+@.|
+00000290  47 16 9a d4 ea 53 76 a5  58 fe a3 81 49 f9 39 cf  |G....Sv.X...I.9.|
+000002a0  bc b4 cd 0d 94 cc 98 66  8b 69 4f b8 6d c6 5f 85  |.......f.iO.m._.|
+000002b0  72 f3 db 5b 9a fd 31 d1  9a d0 77 e0 50 90 5a 00  |r..[..1...w.P.Z.|
+000002c0  8a 30 81 87 02 41 6c 2d  b0 9b b6 9c 79 16 07 dd  |.0...Al-....y...|
+000002d0  95 0b fa 33 32 fb a7 cf  ca f8 46 38 fb 55 b0 4f  |...32.....F8.U.O|
+000002e0  7c ef 63 12 aa b0 75 57  b9 4a 00 d7 e9 01 7a 43  ||.c...uW.J....zC|
+000002f0  42 e9 6f 93 81 39 56 77  a1 74 ef 09 a3 94 9f f5  |B.o..9Vw.t......|
+00000300  79 7b 2b b5 26 bc 46 02  42 01 7a 34 1c e8 e0 88  |y{+.&.F.B.z4....|
+00000310  b4 90 24 01 ea db 06 d1  c4 59 3f d0 62 6a 64 47  |..$......Y?.bjdG|
+00000320  d9 bc 5e d2 a9 92 85 a2  4b 11 46 98 4a e5 7c 06  |..^.....K.F.J.|.|
+00000330  75 87 f6 e8 bd 2a d1 8f  18 4d 6b 3f 96 52 8e 0a  |u....*...Mk?.R..|
+00000340  6c ad 37 c1 67 39 bb 3e  d4 82 2f 16 03 01 00 0a  |l.7.g9.>../.....|
+00000350  0d 00 00 06 03 01 02 40  00 00 16 03 01 00 04 0e  |.......@........|
+00000360  00 00 00                                          |...|
 >>> Flow 3 (client to server)
 00000000  16 03 01 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
 00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
@@ -101,29 +102,29 @@
 00000220  67 fd a7 24 20 3e b2 56  1c ce 97 28 5e f8 2b 2d  |g..$ >.V...(^.+-|
 00000230  4f 9e f1 07 9f 6c 4b 5b  83 56 e2 32 42 e9 58 b6  |O....lK[.V.2B.X.|
 00000240  d7 49 a6 b5 68 1a 41 03  56 6b dc 5a 89 16 03 01  |.I..h.A.Vk.Z....|
-00000250  00 86 0f 00 00 82 00 80  43 ee ac 48 f3 bb 26 40  |........C..H..&@|
-00000260  19 85 d5 05 63 44 5c 2c  c9 ab b1 6d ad c2 03 f5  |....cD\,...m....|
-00000270  f5 1d 16 08 fe 3a a9 90  97 8f d6 47 fa 20 80 bb  |.....:.....G. ..|
-00000280  07 6e 32 21 b5 95 de 89  43 ea a9 44 71 35 c7 84  |.n2!....C..Dq5..|
-00000290  d1 c7 d7 74 e0 29 bd 19  51 86 bc 77 24 27 fb a3  |...t.)..Q..w$'..|
-000002a0  f6 3f 85 dd ac d3 6d 84  3e bb 0c e2 8c 2e 1a db  |.?....m.>.......|
-000002b0  18 a2 4f c7 d2 5c 3a db  0c fa f3 3e 6e 1d 65 da  |..O..\:....>n.e.|
-000002c0  3b 1a df 35 00 d0 ee 1b  2e 59 fe 18 50 3d b1 56  |;..5.....Y..P=.V|
-000002d0  82 7c c9 5a 4b 8a e8 9a  14 03 01 00 01 01 16 03  |.|.ZK...........|
-000002e0  01 00 30 1b 1f 0e e0 90  f4 1f b1 cc 3e e5 cb 58  |..0.........>..X|
-000002f0  6a b2 f9 97 04 d2 17 33  2e b0 c9 34 4a 2e 27 0d  |j......3...4J.'.|
-00000300  e1 30 86 b4 bc e3 1f 35  2a 6f bc d7 72 5c b5 32  |.0.....5*o..r\.2|
-00000310  cf 19 19                                          |...|
+00000250  00 86 0f 00 00 82 00 80  a0 3b d6 90 15 22 78 45  |.........;..."xE|
+00000260  5a 09 ac 46 db 99 cb 71  e9 40 62 10 77 47 e8 5e  |Z..F...q.@b.wG.^|
+00000270  63 90 00 28 4c 46 82 72  2e 16 84 32 67 bd 7e 83  |c..(LF.r...2g.~.|
+00000280  80 a9 b3 43 b1 bf c6 48  ad ac ed 90 7b 83 39 36  |...C...H....{.96|
+00000290  ec 90 7e 13 aa d8 39 69  cc 53 88 5c 26 38 c4 95  |..~...9i.S.\&8..|
+000002a0  43 3c 1b 5e d2 63 61 c9  05 9c 7f 7d ef df e8 3a  |C<.^.ca....}...:|
+000002b0  bb 2c 7f 2a f1 d2 9f 25  f4 61 07 99 c4 a1 17 12  |.,.*...%.a......|
+000002c0  98 52 f6 e1 d1 6f 7a 5a  2a de ce 6b 28 18 a5 b4  |.R...ozZ*..k(...|
+000002d0  13 90 ed 82 b9 34 0f 97  14 03 01 00 01 01 16 03  |.....4..........|
+000002e0  01 00 30 dd dd 54 67 e6  c1 e4 0b 89 c6 84 55 57  |..0..Tg.......UW|
+000002f0  7c 7e a8 9a 16 83 5b 01  67 d5 b7 ae dc ee bf 4e  ||~....[.g......N|
+00000300  3a 8c 3f 91 37 4e f4 2c  25 f7 2b 4a 80 3d 07 64  |:.?.7N.,%.+J.=.d|
+00000310  e8 62 3d                                          |.b=|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 fb 0a 0c da b5  |..........0.....|
-00000010  4e fa e0 6b 34 d6 39 b6  33 17 c5 24 38 87 c9 2c  |N..k4.9.3..$8..,|
-00000020  59 b0 f6 46 92 41 7b 35  2f 51 b5 fc 0b ed c1 23  |Y..F.A{5/Q.....#|
-00000030  42 4d 0f 68 eb 7b ae 27  ee 70 4c                 |BM.h.{.'.pL|
+00000000  14 03 01 00 01 01 16 03  01 00 30 15 7b 16 7e 05  |..........0.{.~.|
+00000010  7a d9 f3 d4 ff 87 66 b0  27 e5 e7 f5 08 08 68 bc  |z.....f.'.....h.|
+00000020  b4 23 01 f3 71 b3 c7 9c  c8 31 2d 1c eb 50 9c c0  |.#..q....1-..P..|
+00000030  71 39 a9 d9 e4 cd 30 10  18 26 d6                 |q9....0..&.|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 f0 73 c9  22 ac 02 f3 d7 26 fe ba  |.... .s."....&..|
-00000010  fa de 6f a5 51 50 2f 4a  13 e8 36 c2 29 ff 68 4d  |..o.QP/J..6.).hM|
-00000020  6e 87 a0 e8 aa 17 03 01  00 20 60 bb 97 5f cb 4f  |n........ `.._.O|
-00000030  46 23 a9 03 49 8a 82 cb  22 b2 05 9d c4 4f 83 c1  |F#..I..."....O..|
-00000040  47 e3 b0 58 e2 cc 46 b7  49 18 15 03 01 00 20 54  |G..X..F.I..... T|
-00000050  ae d6 e1 bf 61 5c 9f b3  f8 dc dc e7 33 84 d3 aa  |....a\......3...|
-00000060  23 fa 02 ef dc d1 93 96  1d e3 a1 02 c5 30 9c     |#............0.|
+00000000  17 03 01 00 20 01 7d ab  a8 32 3d 62 56 ef c1 b6  |.... .}..2=bV...|
+00000010  fe 51 8d 8c 90 fa 41 08  52 d3 bd 57 48 8a d2 c5  |.Q....A.R..WH...|
+00000020  1e 41 e8 6b 71 17 03 01  00 20 15 ec 02 8a 2b 11  |.A.kq.... ....+.|
+00000030  8f 4b 8c 1e e9 5c b3 a2  53 6e 93 6a 0e 1a 72 6a  |.K...\..Sn.j..rj|
+00000040  e6 49 ec f5 17 af 95 51  a7 10 15 03 01 00 20 f5  |.I.....Q...... .|
+00000050  ad 65 db d2 71 a5 c1 1b  dc 07 8f 79 cd a3 9a 41  |.e..q......y...A|
+00000060  11 c2 e8 09 09 b4 2f fa  fc 6d 6a 31 22 e3 bd     |....../..mj1"..|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA
index c03c7ec084..4182f8a504 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA
@@ -9,51 +9,65 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 51 02 00 00  4d 03 01 aa fa 5b 3a 13  |....Q...M....[:.|
-00000010  a4 a6 b3 5a 2c 89 39 24  91 a6 a5 c2 e9 13 ff e3  |...Z,.9$........|
-00000020  fa 71 2d e4 f4 1f 22 e8  e8 27 f1 20 94 31 56 d6  |.q-..."..'. .1V.|
-00000030  c7 32 3e 78 a4 f7 16 ee  66 e6 6c 24 d0 80 d2 bb  |.2>x....f.l$....|
-00000040  3f 98 f7 2e d1 1a 12 5f  57 a6 76 f9 00 05 00 00  |?......_W.v.....|
-00000050  05 ff 01 00 01 00 16 03  01 02 59 0b 00 02 55 00  |..........Y...U.|
-00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
-00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
-00000080  09 2a 86 48 86 f7 0d 01  01 0b 05 00 30 1f 31 0b  |.*.H........0.1.|
-00000090  30 09 06 03 55 04 0a 13  02 47 6f 31 10 30 0e 06  |0...U....Go1.0..|
-000000a0  03 55 04 03 13 07 47 6f  20 52 6f 6f 74 30 1e 17  |.U....Go Root0..|
-000000b0  0d 31 36 30 31 30 31 30  30 30 30 30 30 5a 17 0d  |.160101000000Z..|
-000000c0  32 35 30 31 30 31 30 30  30 30 30 30 5a 30 1a 31  |250101000000Z0.1|
-000000d0  0b 30 09 06 03 55 04 0a  13 02 47 6f 31 0b 30 09  |.0...U....Go1.0.|
-000000e0  06 03 55 04 03 13 02 47  6f 30 81 9f 30 0d 06 09  |..U....Go0..0...|
-000000f0  2a 86 48 86 f7 0d 01 01  01 05 00 03 81 8d 00 30  |*.H............0|
-00000100  81 89 02 81 81 00 db 46  7d 93 2e 12 27 06 48 bc  |.......F}...'.H.|
-00000110  06 28 21 ab 7e c4 b6 a2  5d fe 1e 52 45 88 7a 36  |.(!.~...]..RE.z6|
-00000120  47 a5 08 0d 92 42 5b c2  81 c0 be 97 79 98 40 fb  |G....B[.....y.@.|
-00000130  4f 6d 14 fd 2b 13 8b c2  a5 2e 67 d8 d4 09 9e d6  |Om..+.....g.....|
-00000140  22 38 b7 4a 0b 74 73 2b  c2 34 f1 d1 93 e5 96 d9  |"8.J.ts+.4......|
-00000150  74 7b f3 58 9f 6c 61 3c  c0 b0 41 d4 d9 2b 2b 24  |t{.X.la<..A..++$|
-00000160  23 77 5b 1c 3b bd 75 5d  ce 20 54 cf a1 63 87 1d  |#w[.;.u]. T..c..|
-00000170  1e 24 c4 f3 1d 1a 50 8b  aa b6 14 43 ed 97 a7 75  |.$....P....C...u|
-00000180  62 f4 14 c8 52 d7 02 03  01 00 01 a3 81 93 30 81  |b...R.........0.|
-00000190  90 30 0e 06 03 55 1d 0f  01 01 ff 04 04 03 02 05  |.0...U..........|
-000001a0  a0 30 1d 06 03 55 1d 25  04 16 30 14 06 08 2b 06  |.0...U.%..0...+.|
-000001b0  01 05 05 07 03 01 06 08  2b 06 01 05 05 07 03 02  |........+.......|
-000001c0  30 0c 06 03 55 1d 13 01  01 ff 04 02 30 00 30 19  |0...U.......0.0.|
-000001d0  06 03 55 1d 0e 04 12 04  10 9f 91 16 1f 43 43 3e  |..U..........CC>|
-000001e0  49 a6 de 6d b6 80 d7 9f  60 30 1b 06 03 55 1d 23  |I..m....`0...U.#|
-000001f0  04 14 30 12 80 10 48 13  49 4d 13 7e 16 31 bb a3  |..0...H.IM.~.1..|
-00000200  01 d5 ac ab 6e 7b 30 19  06 03 55 1d 11 04 12 30  |....n{0...U....0|
-00000210  10 82 0e 65 78 61 6d 70  6c 65 2e 67 6f 6c 61 6e  |...example.golan|
-00000220  67 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |g0...*.H........|
-00000230  03 81 81 00 9d 30 cc 40  2b 5b 50 a0 61 cb ba e5  |.....0.@+[P.a...|
-00000240  53 58 e1 ed 83 28 a9 58  1a a9 38 a4 95 a1 ac 31  |SX...(.X..8....1|
-00000250  5a 1a 84 66 3d 43 d3 2d  d9 0b f2 97 df d3 20 64  |Z..f=C.-...... d|
-00000260  38 92 24 3a 00 bc cf 9c  7d b7 40 20 01 5f aa d3  |8.$:....}.@ ._..|
-00000270  16 61 09 a2 76 fd 13 c3  cc e1 0c 5c ee b1 87 82  |.a..v......\....|
-00000280  f1 6c 04 ed 73 bb b3 43  77 8d 0c 1c f1 0f a1 d8  |.l..s..Cw.......|
-00000290  40 83 61 c9 4c 72 2b 9d  ae db 46 06 06 4d f4 c1  |@.a.Lr+...F..M..|
-000002a0  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
-000002b0  3b e9 fa e7 16 03 01 00  0e 0d 00 00 06 03 01 02  |;...............|
-000002c0  40 00 00 0e 00 00 00                              |@......|
+00000000  16 03 01 00 59 02 00 00  55 03 01 0a 79 c8 7c 83  |....Y...U...y.|.|
+00000010  17 78 ba 03 ce fa 53 bb  f9 18 50 34 c3 7b ff 99  |.x....S...P4.{..|
+00000020  f3 2e e5 fc 9d 0b d4 1e  c0 55 13 20 2d 5d af da  |.........U. -]..|
+00000030  02 22 75 79 66 51 6f 1a  1a e3 c1 91 78 1d 43 04  |."uyfQo.....x.C.|
+00000040  91 a5 2a 92 49 b4 c9 5a  15 39 52 b6 c0 13 00 00  |..*.I..Z.9R.....|
+00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
+00000060  01 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
+00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
+00000080  3f e2 5b ea a6 30 0d 06  09 2a 86 48 86 f7 0d 01  |?.[..0...*.H....|
+00000090  01 0b 05 00 30 1f 31 0b  30 09 06 03 55 04 0a 13  |....0.1.0...U...|
+000000a0  02 47 6f 31 10 30 0e 06  03 55 04 03 13 07 47 6f  |.Go1.0...U....Go|
+000000b0  20 52 6f 6f 74 30 1e 17  0d 31 36 30 31 30 31 30  | Root0...1601010|
+000000c0  30 30 30 30 30 5a 17 0d  32 35 30 31 30 31 30 30  |00000Z..25010100|
+000000d0  30 30 30 30 5a 30 1a 31  0b 30 09 06 03 55 04 0a  |0000Z0.1.0...U..|
+000000e0  13 02 47 6f 31 0b 30 09  06 03 55 04 03 13 02 47  |..Go1.0...U....G|
+000000f0  6f 30 81 9f 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |o0..0...*.H.....|
+00000100  01 05 00 03 81 8d 00 30  81 89 02 81 81 00 db 46  |.......0.......F|
+00000110  7d 93 2e 12 27 06 48 bc  06 28 21 ab 7e c4 b6 a2  |}...'.H..(!.~...|
+00000120  5d fe 1e 52 45 88 7a 36  47 a5 08 0d 92 42 5b c2  |]..RE.z6G....B[.|
+00000130  81 c0 be 97 79 98 40 fb  4f 6d 14 fd 2b 13 8b c2  |....y.@.Om..+...|
+00000140  a5 2e 67 d8 d4 09 9e d6  22 38 b7 4a 0b 74 73 2b  |..g....."8.J.ts+|
+00000150  c2 34 f1 d1 93 e5 96 d9  74 7b f3 58 9f 6c 61 3c  |.4......t{.X.la<|
+00000160  c0 b0 41 d4 d9 2b 2b 24  23 77 5b 1c 3b bd 75 5d  |..A..++$#w[.;.u]|
+00000170  ce 20 54 cf a1 63 87 1d  1e 24 c4 f3 1d 1a 50 8b  |. T..c...$....P.|
+00000180  aa b6 14 43 ed 97 a7 75  62 f4 14 c8 52 d7 02 03  |...C...ub...R...|
+00000190  01 00 01 a3 81 93 30 81  90 30 0e 06 03 55 1d 0f  |......0..0...U..|
+000001a0  01 01 ff 04 04 03 02 05  a0 30 1d 06 03 55 1d 25  |.........0...U.%|
+000001b0  04 16 30 14 06 08 2b 06  01 05 05 07 03 01 06 08  |..0...+.........|
+000001c0  2b 06 01 05 05 07 03 02  30 0c 06 03 55 1d 13 01  |+.......0...U...|
+000001d0  01 ff 04 02 30 00 30 19  06 03 55 1d 0e 04 12 04  |....0.0...U.....|
+000001e0  10 9f 91 16 1f 43 43 3e  49 a6 de 6d b6 80 d7 9f  |.....CC>I..m....|
+000001f0  60 30 1b 06 03 55 1d 23  04 14 30 12 80 10 48 13  |`0...U.#..0...H.|
+00000200  49 4d 13 7e 16 31 bb a3  01 d5 ac ab 6e 7b 30 19  |IM.~.1......n{0.|
+00000210  06 03 55 1d 11 04 12 30  10 82 0e 65 78 61 6d 70  |..U....0...examp|
+00000220  6c 65 2e 67 6f 6c 61 6e  67 30 0d 06 09 2a 86 48  |le.golang0...*.H|
+00000230  86 f7 0d 01 01 0b 05 00  03 81 81 00 9d 30 cc 40  |.............0.@|
+00000240  2b 5b 50 a0 61 cb ba e5  53 58 e1 ed 83 28 a9 58  |+[P.a...SX...(.X|
+00000250  1a a9 38 a4 95 a1 ac 31  5a 1a 84 66 3d 43 d3 2d  |..8....1Z..f=C.-|
+00000260  d9 0b f2 97 df d3 20 64  38 92 24 3a 00 bc cf 9c  |...... d8.$:....|
+00000270  7d b7 40 20 01 5f aa d3  16 61 09 a2 76 fd 13 c3  |}.@ ._...a..v...|
+00000280  cc e1 0c 5c ee b1 87 82  f1 6c 04 ed 73 bb b3 43  |...\.....l..s..C|
+00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
+000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
+000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 01 00  |.=.`.\!.;.......|
+000002c0  cb 0c 00 00 c7 03 00 17  41 04 56 62 25 ca 89 d3  |........A.Vb%...|
+000002d0  3c eb f1 38 50 ff 7b 38  ae 1a 83 1e 07 b7 b4 ef  |<..8P.{8........|
+000002e0  2d 64 78 6e 60 f0 a8 fa  f9 f7 b9 d4 a9 43 3b a9  |-dxn`........C;.|
+000002f0  09 c8 39 77 a2 0a fe d1  00 88 1c 1c 06 6e 27 35  |..9w.........n'5|
+00000300  af 1f d4 c5 35 cd 62 8e  12 98 00 80 7d c2 93 eb  |....5.b.....}...|
+00000310  04 ee 59 d3 c2 2a ac 4c  60 ad 3a bc d2 e3 70 02  |..Y..*.L`.:...p.|
+00000320  c2 67 46 c5 a2 88 80 a3  55 4a be 55 5f 04 14 bc  |.gF.....UJ.U_...|
+00000330  23 76 87 81 ab 78 48 74  c7 ac 0a 44 40 8c d5 5e  |#v...xHt...D@..^|
+00000340  b8 b0 dd c5 02 79 d2 b6  89 e8 ea 5c 3f ad e4 7c  |.....y.....\?..||
+00000350  2f 74 db 2a 21 5d 0f ef  92 d1 d2 c6 ae 45 dd 20  |/t.*!].......E. |
+00000360  a5 58 3e 69 dc d5 71 ff  71 03 a9 92 15 e7 69 fa  |.X>i..q.q.....i.|
+00000370  31 35 23 c9 fb e4 3c 3a  e5 80 fb 86 57 06 cf 6e  |15#...<:....W..n|
+00000380  b5 e8 a3 bb 44 aa 44 c6  45 50 9f bf 16 03 01 00  |....D.D.EP......|
+00000390  0a 0d 00 00 06 03 01 02  40 00 00 16 03 01 00 04  |........@.......|
+000003a0  0e 00 00 00                                       |....|
 >>> Flow 3 (client to server)
 00000000  16 03 01 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
 00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
@@ -87,33 +101,34 @@
 000001d0  ac 11 b1 28 56 be 1d cd  61 62 84 09 bf d6 80 c6  |...(V...ab......|
 000001e0  45 8d 82 2c b4 d8 83 9b  db c9 22 b7 2a 12 11 7b  |E..,......".*..{|
 000001f0  fa 02 3b c1 c9 ff ea c9  9d a8 49 d3 95 d7 d5 0e  |..;.......I.....|
-00000200  e5 35 16 03 01 00 86 10  00 00 82 00 80 b9 65 8d  |.5............e.|
-00000210  bf a7 c8 4b 79 ce 6f cb  8b 13 1c ac b9 7d 66 5e  |...Ky.o......}f^|
-00000220  e9 ba 1d 71 4e a9 e9 34  ae f6 64 65 90 3b d8 16  |...qN..4..de.;..|
-00000230  52 a2 6f f4 cb 8a 13 74  a2 ee b7 27 69 b4 41 c0  |R.o....t...'i.A.|
-00000240  90 68 bc 02 69 e1 c6 48  4f 39 36 30 25 ca 4c 17  |.h..i..HO960%.L.|
-00000250  ce 83 9e 08 56 e3 05 49  93 9e 2e c4 fb e6 c8 01  |....V..I........|
-00000260  f1 0f c5 70 0f 08 83 48  e9 48 ef 6e 50 8b 05 7e  |...p...H.H.nP..~|
-00000270  e5 84 25 fa 55 c7 ae 31  02 27 00 ef 3f 98 86 20  |..%.U..1.'..?.. |
-00000280  12 89 91 59 28 b4 f7 d7  af d2 69 61 35 16 03 01  |...Y(.....ia5...|
-00000290  00 86 0f 00 00 82 00 80  a0 09 75 c8 8c 15 61 df  |..........u...a.|
-000002a0  3e 23 b7 3e 1e 12 ec 2d  d9 9f f0 05 d1 f5 c1 ed  |>#.>...-........|
-000002b0  ac 05 a7 6a d4 67 b3 ed  6d ff 01 ab e2 5a 53 e6  |...j.g..m....ZS.|
-000002c0  e3 85 e6 c3 e2 2f 0b db  c6 fa 52 8b 2b 22 12 33  |...../....R.+".3|
-000002d0  b0 6d 51 05 02 59 3c 50  5e a8 17 fe 95 d3 12 17  |.mQ..Y<P^.......|
-000002e0  4e 27 5b b4 6f f5 10 e3  16 89 8c 54 73 2e cc 23  |N'[.o......Ts..#|
-000002f0  e0 3b 11 68 b4 a7 cf 64  b2 cf b8 62 b0 c0 ba 89  |.;.h...d...b....|
-00000300  88 b0 fe 13 f6 cb bc 09  a9 30 c4 bb b2 a7 7b d8  |.........0....{.|
-00000310  64 96 bc 9b a7 fb db 82  14 03 01 00 01 01 16 03  |d...............|
-00000320  01 00 24 c1 77 ee 22 d3  71 d7 9e dd 02 53 0c 4a  |..$.w.".q....S.J|
-00000330  38 eb 43 de da 99 e3 45  ff 06 a3 3e 00 0b 19 8c  |8.C....E...>....|
-00000340  13 ed a6 46 bb 01 d8                              |...F...|
+00000200  e5 35 16 03 01 00 46 10  00 00 42 41 04 1e 18 37  |.5....F...BA...7|
+00000210  ef 0d 19 51 88 35 75 71  b5 e5 54 5b 12 2e 8f 09  |...Q.5uq..T[....|
+00000220  67 fd a7 24 20 3e b2 56  1c ce 97 28 5e f8 2b 2d  |g..$ >.V...(^.+-|
+00000230  4f 9e f1 07 9f 6c 4b 5b  83 56 e2 32 42 e9 58 b6  |O....lK[.V.2B.X.|
+00000240  d7 49 a6 b5 68 1a 41 03  56 6b dc 5a 89 16 03 01  |.I..h.A.Vk.Z....|
+00000250  00 86 0f 00 00 82 00 80  9c e4 48 ef 27 f9 b3 60  |..........H.'..`|
+00000260  30 b0 dc 64 05 6e e2 b1  16 50 4a 10 7c d6 04 23  |0..d.n...PJ.|..#|
+00000270  71 a3 0c e3 ce 73 7b 2d  d7 c3 54 35 a1 8a 17 37  |q....s{-..T5...7|
+00000280  21 d1 58 d5 42 24 49 78  6e 0b 89 6f 94 ca 7f 54  |!.X.B$Ixn..o...T|
+00000290  ae 6d 1f 21 8a 7f a5 d1  fb 9c 2a 04 03 b5 62 ce  |.m.!......*...b.|
+000002a0  7d a1 a0 57 6f 2b b8 a8  91 41 e9 12 52 c5 ec 73  |}..Wo+...A..R..s|
+000002b0  86 68 a0 56 b6 7f 78 9a  89 b9 d4 e1 2e 6c 24 f4  |.h.V..x......l$.|
+000002c0  3b 24 a8 92 05 bc cf 29  e2 dc 25 a9 bf 43 db 81  |;$.....)..%..C..|
+000002d0  e0 bd 7d 98 1a 3a 5b 4e  14 03 01 00 01 01 16 03  |..}..:[N........|
+000002e0  01 00 30 0c 10 7b c1 61  98 1c b6 57 ab e9 2d e8  |..0..{.a...W..-.|
+000002f0  65 fb 50 6f a8 39 6a dd  ca 70 37 84 64 20 65 19  |e.Po.9j..p7.d e.|
+00000300  58 39 fd e3 30 b1 2f 48  c7 22 8f c4 f1 61 a3 f2  |X9..0./H."...a..|
+00000310  70 0b b6                                          |p..|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 24 fb c0 07 ac 02  |..........$.....|
-00000010  29 d1 db f3 48 1a b7 41  0a db f2 14 04 a0 70 94  |)...H..A......p.|
-00000020  2a 25 2e 47 41 f5 e0 99  fa ad e5 85 4a 53 12     |*%.GA.......JS.|
+00000000  14 03 01 00 01 01 16 03  01 00 30 36 ee 87 93 dd  |..........06....|
+00000010  ec 92 92 ea 76 7f c2 98  34 30 d1 03 b4 60 70 52  |....v...40...`pR|
+00000020  84 e8 e5 88 2c 93 7a 9b  29 6a 2a 62 a3 60 f0 f6  |....,.z.)j*b.`..|
+00000030  9b 81 5d 17 0a 9f 6f cc  45 7e 55                 |..]...o.E~U|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 1a 93 7d e5  18 d9 43 8e b8 2f b0 d6  |......}...C../..|
-00000010  8b f8 d4 a5 c5 0d 71 41  da 91 a7 04 9c 6b 2f 15  |......qA.....k/.|
-00000020  03 01 00 16 58 c6 62 cd  1c 65 bc 0e c6 4d 29 ff  |....X.b..e...M).|
-00000030  d9 c5 dc 68 65 72 35 f9  de 02                    |...her5...|
+00000000  17 03 01 00 20 51 b6 eb  e8 21 80 4a 60 d0 ab 86  |.... Q...!.J`...|
+00000010  25 cf 14 9c 21 8d b6 c2  7c e9 96 90 3a f2 bb de  |%...!...|...:...|
+00000020  f4 67 da 4d 9c 17 03 01  00 20 8f 04 37 73 79 25  |.g.M..... ..7sy%|
+00000030  12 95 f1 45 ca ef 71 2f  4c f2 52 67 bb 97 8e 73  |...E..q/L.Rg...s|
+00000040  df ce 2c b1 7f 40 b2 91  4b 8d 15 03 01 00 20 bb  |..,..@..K..... .|
+00000050  34 d8 f2 08 79 fc d3 b9  01 66 7b ad 58 3f f3 64  |4...y....f{.X?.d|
+00000060  4c e2 43 3d cf 32 27 2c  d8 08 c0 e4 3c 23 7b     |L.C=.2',....<#{|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES
index c549a1b96b..e927c3a9e4 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES
@@ -9,11 +9,11 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 59 02 00 00  55 03 01 00 f4 3b 47 61  |....Y...U....;Ga|
-00000010  8b 4b 96 48 68 12 19 a6  00 d5 24 fa c3 26 24 27  |.K.Hh.....$..&$'|
-00000020  a8 13 09 81 d8 6b 80 92  f9 b6 b7 20 01 0a 26 a3  |.....k..... ..&.|
-00000030  d7 37 55 4a 96 23 90 9b  e1 23 95 d7 6e 01 cd 35  |.7UJ.#...#..n..5|
-00000040  41 d3 9f 0c ed 88 2c 6d  97 8f 35 0c c0 09 00 00  |A.....,m..5.....|
+00000000  16 03 01 00 59 02 00 00  55 03 01 ad 73 ab 19 40  |....Y...U...s..@|
+00000010  f9 55 c6 66 42 22 d2 dd  1b ab da 28 bb 0d cc f6  |.U.fB".....(....|
+00000020  88 75 f0 52 d1 90 39 42  16 25 7a 20 21 96 87 ab  |.u.R..9B.%z !...|
+00000030  12 5c 25 5e d3 84 fb 53  b5 b3 d9 3d bb 42 72 c8  |.\%^...S...=.Br.|
+00000040  55 3e 4e 43 cb 36 38 47  cd dc fa ad c0 09 00 00  |U>NC.68G........|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  01 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,41 +48,41 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 01 00 d5 0c 00  00 d1 03 00 17 41 04 47  |*............A.G|
-00000280  34 3e c3 7a 68 b2 bf 4c  11 e0 3a 28 c0 6f bb b8  |4>.zh..L..:(.o..|
-00000290  4d f1 27 6a 90 6a 81 22  93 26 8d 5c ec ad 7d e2  |M.'j.j.".&.\..}.|
-000002a0  71 41 c1 f8 48 5c c7 b0  95 80 b5 76 6d a8 4f 84  |qA..H\.....vm.O.|
-000002b0  29 94 0c c8 e2 d5 e4 c3  d3 a3 d7 fa 45 d4 8f 00  |)...........E...|
-000002c0  8a 30 81 87 02 41 2c 01  66 48 61 d8 8c e5 d9 74  |.0...A,.fHa....t|
-000002d0  5e 82 ad 79 67 af 19 aa  f4 a5 89 41 f8 78 a6 77  |^..yg......A.x.w|
-000002e0  9e 74 74 d3 eb b8 93 aa  6c 28 c9 44 58 2b c0 16  |.tt.....l(.DX+..|
-000002f0  9a b3 26 2d 13 5f 98 94  36 d5 ff 0e a9 2c d8 33  |..&-._..6....,.3|
-00000300  d6 0c dc 48 fe be de 02  42 00 97 e0 40 3d 53 6e  |...H....B...@=Sn|
-00000310  2b 96 f6 63 c7 a0 cb 28  64 45 c4 b7 85 34 8f a7  |+..c...(dE...4..|
-00000320  e4 fd 97 76 18 e2 88 4c  31 39 3f 31 6b 7f 69 1f  |...v...L19?1k.i.|
-00000330  7a 72 2f 8e 6c d2 1f fa  59 01 0c 41 ef 21 51 44  |zr/.l...Y..A.!QD|
-00000340  c3 e9 de d7 9c 2b 35 9c  34 52 c5 16 03 01 00 04  |.....+5.4R......|
-00000350  0e 00 00 00                                       |....|
+00000270  2a 16 03 01 00 d4 0c 00  00 d0 03 00 17 41 04 0d  |*............A..|
+00000280  e8 5a 74 30 43 bb 24 3b  77 5e 60 c8 05 57 ca 5e  |.Zt0C.$;w^`..W.^|
+00000290  79 e1 35 a1 48 3a b2 af  c5 9d c8 fa 38 f7 4b ec  |y.5.H:......8.K.|
+000002a0  09 fb 29 e0 ac f1 43 70  ca ec b7 8c f5 22 42 a6  |..)...Cp....."B.|
+000002b0  56 7b 4a db 84 dc 2b 31  f8 46 35 3f 9c 72 fb 00  |V{J...+1.F5?.r..|
+000002c0  89 30 81 86 02 41 27 a5  3b 2c f0 d9 a6 74 6f b6  |.0...A'.;,...to.|
+000002d0  2c 3a 9f 9b bf 1c 50 9c  07 7f 50 b1 82 41 17 4e  |,:....P...P..A.N|
+000002e0  c2 77 13 84 27 5c 28 a9  14 c7 e2 d1 4b 84 eb 22  |.w..'\(.....K.."|
+000002f0  b0 d1 f9 6b 6e 08 52 11  aa 21 34 82 43 d1 ed 73  |...kn.R..!4.C..s|
+00000300  3a 04 e3 a1 3f e5 4e 02  41 6e 4c a9 ab d6 e0 b1  |:...?.N.AnL.....|
+00000310  45 88 00 44 47 af 64 d0  51 20 ca b4 52 79 3e de  |E..DG.d.Q ..Ry>.|
+00000320  e7 ba 9a 06 03 b6 c5 7f  7f e1 8f 54 eb 4b 0b 6e  |...........T.K.n|
+00000330  e3 b7 a2 86 b6 b6 49 d1  2e 0d 50 33 75 c5 49 8b  |......I...P3u.I.|
+00000340  0a 7d fa 6d 57 e8 35 50  0a c3 16 03 01 00 04 0e  |.}.mW.5P........|
+00000350  00 00 00                                          |...|
 >>> Flow 3 (client to server)
 00000000  16 03 01 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
 00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
 00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 01 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 01 00 30 43 0d  57 48 41 ac 59 86 b3 53  |.....0C.WHA.Y..S|
-00000060  58 d4 f7 b0 32 fa 0a 3f  5f 3e 22 ba 2f 04 86 06  |X...2..?_>"./...|
-00000070  ce 22 33 3f a2 89 ed 76  80 52 d1 6b fe bb 62 40  |."3?...v.R.k..b@|
-00000080  a9 68 d5 b3 ea fc                                 |.h....|
+00000050  01 16 03 01 00 30 57 49  e2 22 09 08 84 39 73 46  |.....0WI."...9sF|
+00000060  f3 cf 03 7a d4 fd ca 18  05 6b eb da c7 b0 9d 05  |...z.....k......|
+00000070  c8 aa 61 f5 fd 1d c3 a4  5d 15 51 dd 03 67 aa 9d  |..a.....].Q..g..|
+00000080  85 9d 78 bc 82 00                                 |..x...|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 34 9b d5 0a 0d  |..........04....|
-00000010  1f 02 01 f7 92 e8 3e 83  03 23 28 b3 ab cc e9 f2  |......>..#(.....|
-00000020  98 08 1f 36 61 0f af 8d  d3 d3 fc 72 58 94 77 01  |...6a......rX.w.|
-00000030  82 d9 8c 70 b3 d3 d3 19  4d cf 08                 |...p....M..|
+00000000  14 03 01 00 01 01 16 03  01 00 30 d0 dc fe f9 3a  |..........0....:|
+00000010  df b1 1d ea b6 49 27 b3  7f 96 5d a9 ec e4 b4 01  |.....I'...].....|
+00000020  6f 46 db 4d ed 43 a7 fb  6a 8b b4 4c 51 8a 1a 7f  |oF.M.C..j..LQ...|
+00000030  f2 92 54 3b 20 1c 58 de  27 93 a3                 |..T; .X.'..|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 b8 a9 f8  57 92 06 f0 7d 03 e0 ba  |.... ...W...}...|
-00000010  c6 52 e0 9e 52 eb cf 7e  a2 98 5b 74 f2 ff dc 85  |.R..R..~..[t....|
-00000020  93 25 02 56 e1 17 03 01  00 20 a2 8c c8 c1 c5 eb  |.%.V..... ......|
-00000030  ce 3b d3 86 0d c0 bc bc  13 41 d5 5c d1 24 b9 be  |.;.......A.\.$..|
-00000040  f9 4c dd 03 25 88 30 64  01 1c 15 03 01 00 20 3e  |.L..%.0d...... >|
-00000050  45 2f 53 60 74 3f 48 66  0d 02 59 1c 1c fc f1 f7  |E/S`t?Hf..Y.....|
-00000060  34 dd 86 0a 33 be 42 e9  d0 bd f5 d9 84 bf 30     |4...3.B.......0|
+00000000  17 03 01 00 20 03 4c a7  c8 19 e2 e1 e7 ba 7d 96  |.... .L.......}.|
+00000010  77 83 e8 db ee 41 3d 6e  66 c8 1d 54 85 d8 14 92  |w....A=nf..T....|
+00000020  33 b8 e8 f5 de 17 03 01  00 20 3c c4 6e d3 1f 0a  |3........ <.n...|
+00000030  43 b0 0f 7b c7 f8 48 e9  90 5d 50 6b 74 79 b3 47  |C..{..H..]Pkty.G|
+00000040  71 12 7e 31 e1 d6 ab 6e  58 48 15 03 01 00 20 fc  |q.~1...nXH.... .|
+00000050  bb 86 b3 d0 44 b1 ef 80  87 e4 d9 76 b7 68 f4 a9  |....D......v.h..|
+00000060  3b 86 56 c3 2c 54 0e cb  69 ec 60 c1 c4 a1 e9     |;.V.,T..i.`....|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES
index 956d9ec84d..214a0c87d9 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES
@@ -9,11 +9,11 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 59 02 00 00  55 03 01 72 0c 3b 9c 77  |....Y...U..r.;.w|
-00000010  8a 2b 1c 13 28 ad 08 30  aa ca 23 dc 54 7b 48 c7  |.+..(..0..#.T{H.|
-00000020  2e c2 81 23 6c 35 c9 a9  3f 42 ef 20 dd 0c 72 42  |...#l5..?B. ..rB|
-00000030  8f 8e d0 1a ed 47 ed 6f  94 68 a5 bc 47 42 2a ee  |.....G.o.h..GB*.|
-00000040  3b 3d 61 6a bd 88 3e 6e  e5 54 a3 cd c0 13 00 00  |;=aj..>n.T......|
+00000000  16 03 01 00 59 02 00 00  55 03 01 7e 9f ae 06 96  |....Y...U..~....|
+00000010  f9 31 05 96 e9 ee 59 8d  84 dd 40 25 4c 1e e9 b2  |.1....Y...@%L...|
+00000020  b9 d0 7b e1 a9 4d d9 ea  f9 f7 d1 20 21 35 e2 5a  |..{..M..... !5.Z|
+00000030  8f 72 0c b4 4e 5e 55 00  98 db a7 18 d3 60 01 be  |.r..N^U......`..|
+00000040  0f 0a 06 56 29 0b 67 fc  fa aa 09 f4 c0 13 00 00  |...V).g.........|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  01 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,19 +53,19 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 01 00  |.=.`.\!.;.......|
-000002c0  cb 0c 00 00 c7 03 00 17  41 04 82 a5 dc 05 3f fb  |........A.....?.|
-000002d0  cb 6b d0 7f 6d 01 f9 be  df 3a a6 2e 52 fc 82 5d  |.k..m....:..R..]|
-000002e0  8a ab 45 bd 94 f8 04 da  2e 4b e1 33 06 11 8c c1  |..E......K.3....|
-000002f0  2f 35 94 7b ef 4e 05 cb  5f 7c 27 16 72 2c bb 96  |/5.{.N.._|'.r,..|
-00000300  3e 81 d3 01 f0 5e 8e 95  4a db 00 80 41 13 7a 1b  |>....^..J...A.z.|
-00000310  4d 4c ed ff ea 59 80 39  6f f9 72 33 23 32 17 42  |ML...Y.9o.r3#2.B|
-00000320  3d 78 80 c2 f6 02 f6 71  0c dc 1b 86 c7 11 9f 4e  |=x.....q.......N|
-00000330  f3 f9 e3 ab fa 6f a9 78  35 79 25 41 9f e3 57 42  |.....o.x5y%A..WB|
-00000340  83 c0 60 f8 d0 83 05 8d  b2 34 33 d5 7d 3a e3 a4  |..`......43.}:..|
-00000350  09 8b 49 dc 17 74 dd 5e  67 c9 10 ee c0 ba 89 b2  |..I..t.^g.......|
-00000360  91 2f a2 de 1b 39 9c 2c  c9 10 13 43 f1 e8 69 98  |./...9.,...C..i.|
-00000370  19 75 02 ee dc fb 85 28  cb bf 00 1e 50 bb 42 f9  |.u.....(....P.B.|
-00000380  f0 81 28 4a 9e c8 a1 aa  29 55 d8 34 16 03 01 00  |..(J....)U.4....|
+000002c0  cb 0c 00 00 c7 03 00 17  41 04 82 46 ed 76 ab f8  |........A..F.v..|
+000002d0  33 eb fe 17 f8 83 d6 68  bb b6 fc 2b 86 f6 18 a6  |3......h...+....|
+000002e0  bd dc 3e 35 6b 03 48 03  5f f0 3f a9 70 41 bd a4  |..>5k.H._.?.pA..|
+000002f0  83 67 83 42 86 fc f5 ba  9e f5 4c b8 5a b7 ab 8b  |.g.B......L.Z...|
+00000300  77 33 79 ea 99 21 88 06  bc f0 00 80 9b f9 31 3a  |w3y..!........1:|
+00000310  7c 33 31 01 e2 a3 e9 97  a3 03 93 bb b7 fd 60 42  ||31...........`B|
+00000320  89 3a b1 ff 59 11 ca 71  5f 05 06 a7 6d ec c5 7d  |.:..Y..q_...m..}|
+00000330  9e 93 2c 26 5c 29 9f 80  b1 dc 5a 1c 80 5d b9 a0  |..,&\)....Z..]..|
+00000340  5e f7 05 d8 ad 9d c7 f2  69 11 d5 69 a8 51 16 06  |^.......i..i.Q..|
+00000350  76 5d 49 a4 ac 7b 5c 73  1f 31 da 2f b7 83 6a 6e  |v]I..{\s.1./..jn|
+00000360  4a d6 56 53 91 66 0a e3  3d 70 c6 ee 42 84 15 12  |J.VS.f..=p..B...|
+00000370  68 d3 9d f8 95 26 bd b4  2f 06 25 f0 34 9c f8 8e  |h....&../.%.4...|
+00000380  f5 ed 1d a3 0e 99 47 52  46 88 08 2d 16 03 01 00  |......GRF..-....|
 00000390  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
 00000000  16 03 01 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
@@ -73,20 +73,20 @@
 00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 01 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 01 00 30 05 a0  da 78 00 e3 2f f7 76 45  |.....0...x../.vE|
-00000060  7d 37 48 65 01 63 27 76  4a 7f fe cd 2b 4b d6 49  |}7He.c'vJ...+K.I|
-00000070  93 79 e6 b1 23 a5 c6 ea  db 1f af be 6a 16 55 9f  |.y..#.......j.U.|
-00000080  3d 06 1f 4d 88 7a                                 |=..M.z|
+00000050  01 16 03 01 00 30 dd cd  57 a9 ae 84 df 19 da ed  |.....0..W.......|
+00000060  18 3e 8b f9 79 42 33 4f  15 8a a1 28 a1 44 92 5d  |.>..yB3O...(.D.]|
+00000070  ad 8e 47 54 e9 1a 51 f2  a8 9e 99 88 79 fd 0d de  |..GT..Q.....y...|
+00000080  21 33 24 80 3e 84                                 |!3$.>.|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 90 65 20 ff da  |..........0.e ..|
-00000010  ee fa 89 8b 75 09 e7 d8  90 a5 0f 12 16 0f 12 40  |....u..........@|
-00000020  34 78 ee 50 c4 f8 31 c6  55 5e ac 21 42 b8 aa a8  |4x.P..1.U^.!B...|
-00000030  d8 36 a9 f0 ab 7d e8 22  99 e1 3c                 |.6...}."..<|
+00000000  14 03 01 00 01 01 16 03  01 00 30 e2 27 e3 07 92  |..........0.'...|
+00000010  b6 3b 3b 0e b4 31 39 12  0b ae 5a b3 16 10 59 3f  |.;;..19...Z...Y?|
+00000020  c3 b1 ea 5c 04 21 4f 7b  25 3c ac 2b 70 e7 fe 76  |...\.!O{%<.+p..v|
+00000030  05 36 bd a4 e1 9e 13 d6  cd 29 53                 |.6.......)S|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 67 4c 09  40 a9 00 c3 b0 2c dd e6  |.... gL.@....,..|
-00000010  7e 95 5d dc 22 ac 53 79  81 51 07 e4 20 41 79 16  |~.].".Sy.Q.. Ay.|
-00000020  e0 98 94 70 2b 17 03 01  00 20 68 7a 08 85 27 fa  |...p+.... hz..'.|
-00000030  7e ad 02 c3 83 26 42 52  36 59 1d f9 af 79 7f 24  |~....&BR6Y...y.$|
-00000040  c8 72 af dd f2 ec f6 16  0d 79 15 03 01 00 20 c6  |.r.......y.... .|
-00000050  ea 99 71 91 df 33 2f dc  17 1e 33 af 76 a5 c5 95  |..q..3/...3.v...|
-00000060  20 55 64 c4 13 71 ab 35  84 f9 44 9b f2 a5 d4     | Ud..q.5..D....|
+00000000  17 03 01 00 20 77 65 af  9b 27 6e eb fb 36 4c 76  |.... we..'n..6Lv|
+00000010  4e 5b 37 4d f3 43 dd 44  9f b4 97 60 4c 02 5a b8  |N[7M.C.D...`L.Z.|
+00000020  90 7f 95 3e 31 17 03 01  00 20 41 4a b3 b3 e1 8c  |...>1.... AJ....|
+00000030  5f c2 82 c5 ed 29 81 64  cf 45 9b 04 82 de ae 9e  |_....).d.E......|
+00000040  b7 8b 66 64 2b 7e f7 86  e9 29 15 03 01 00 20 1a  |..fd+~...).... .|
+00000050  f7 c8 58 66 1c eb 52 66  a1 e0 5d f6 67 74 84 9a  |..Xf..Rf..].gt..|
+00000060  76 dc 0d 8b 2c 02 04 ff  5a d1 71 4b 12 73 c7     |v...,...Z.qK.s.|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4 b/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4
index 43f1de13d5..d21b849858 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4
+++ b/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4
@@ -9,11 +9,11 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 51 02 00 00  4d 03 01 7b ef ef 75 33  |....Q...M..{..u3|
-00000010  8e 02 f9 39 e6 74 76 60  f9 ac 45 c0 c0 73 56 7a  |...9.tv`..E..sVz|
-00000020  8d ce f2 4d 51 f4 d3 e2  cf 1b bc 20 40 8d 00 76  |...MQ...... @..v|
-00000030  f8 1e 78 78 05 d0 4b 99  6e 14 09 84 da 7e b6 75  |..xx..K.n....~.u|
-00000040  e5 08 29 78 84 08 09 d4  4a 85 bf ca 00 05 00 00  |..)x....J.......|
+00000000  16 03 01 00 51 02 00 00  4d 03 01 a8 a1 28 82 1d  |....Q...M....(..|
+00000010  4c 2e bb c6 1d f1 cd 6f  a2 89 b7 d9 51 e4 40 b9  |L......o....Q.@.|
+00000020  f7 5f 36 cc d3 e1 61 bc  39 d7 4c 20 4a 5f 29 a5  |._6...a.9.L J_).|
+00000030  83 41 83 e8 20 ce 40 e0  04 15 28 d9 f8 51 ec 70  |.A.. .@...(..Q.p|
+00000040  9b 2b a4 07 5c 4b d8 d0  64 50 16 76 00 05 00 00  |.+..\K..dP.v....|
 00000050  05 ff 01 00 01 00 16 03  01 02 59 0b 00 02 55 00  |..........Y...U.|
 00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -63,15 +63,15 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 01 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 01 00 24 df ee  0a de 85 59 55 17 04 de  |.....$.....YU...|
-000000a0  8f 04 37 b0 67 b9 a6 d0  fc 34 50 47 5b f5 ab 46  |..7.g....4PG[..F|
-000000b0  6b 36 f1 76 b5 ca b2 59  58 c3                    |k6.v...YX.|
+00000090  01 16 03 01 00 24 1c 9e  2b bf 0b c8 64 ce 4c bd  |.....$..+...d.L.|
+000000a0  e1 88 27 6b 3f 62 c1 6e  28 3a 4e 5b 32 b3 37 4f  |..'k?b.n(:N[2.7O|
+000000b0  0f 7d 00 3d d4 bc e9 18  aa b4                    |.}.=......|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 24 2f ff ff fa b9  |..........$/....|
-00000010  67 45 3c 83 b2 52 02 35  2f 4f 08 14 56 22 d6 a0  |gE<..R.5/O..V"..|
-00000020  d0 6d f7 e5 f1 1a e7 f6  77 d0 e4 cc f4 b4 15     |.m......w......|
+00000000  14 03 01 00 01 01 16 03  01 00 24 38 e2 4f f3 c0  |..........$8.O..|
+00000010  95 8e 42 2b c3 2c a8 52  ea 47 5f 1b 5c c6 44 e0  |..B+.,.R.G_.\.D.|
+00000020  c6 1d 4f ab 4e 14 3b 83  66 cc 08 a3 0e bd 2b     |..O.N.;.f.....+|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 1a 4b 71 a8  39 42 3c 45 84 29 b7 76  |.....Kq.9B<E.).v|
-00000010  fb c6 c9 54 46 b1 db 4c  17 c2 b9 e5 4e c0 41 15  |...TF..L....N.A.|
-00000020  03 01 00 16 9f 17 19 d4  e3 7c 1d 1b 72 a2 b7 9c  |.........|..r...|
-00000030  21 29 4e 89 da fe 07 a6  1a 81                    |!)N.......|
+00000000  17 03 01 00 1a da d8 1b  9a 14 00 7d cc f3 c9 4f  |...........}...O|
+00000010  f3 b9 db 10 91 42 5b 2c  51 d7 05 17 92 7a d5 15  |.....B[,Q....z..|
+00000020  03 01 00 16 3f 5d 3d 95  2a a3 b5 39 1d 48 13 b5  |....?]=.*..9.H..|
+00000030  50 87 6c e4 07 12 e3 97  5d d0                    |P.l.....].|
diff --git a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES
index e660bc3ca4..a1d6e5b439 100644
--- a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES
@@ -9,11 +9,11 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 02 00 59 02 00 00  55 03 02 83 27 b2 f5 ac  |....Y...U...'...|
-00000010  67 fa 7c e5 80 6c 05 04  3c 26 e6 9d 17 48 ae 48  |g.|..l..<&...H.H|
-00000020  e7 b0 fc 80 0f 11 c8 63  91 48 72 20 c2 e3 dd 5e  |.......c.Hr ...^|
-00000030  da b7 8b 08 5f 9b a1 b6  dc 60 92 5e a8 fe 61 44  |...._....`.^..aD|
-00000040  0e 9b f1 cb 74 5f 08 a8  dd f9 2e 66 c0 09 00 00  |....t_.....f....|
+00000000  16 03 02 00 59 02 00 00  55 03 02 e2 b2 bb 18 7a  |....Y...U......z|
+00000010  68 b6 d5 cf b0 11 28 3f  e5 4d aa ad 08 de 60 e3  |h.....(?.M....`.|
+00000020  d3 48 76 bc bf a7 7f 11  40 f8 b6 20 e1 f2 01 fb  |.Hv.....@.. ....|
+00000030  f7 e4 32 e3 d9 63 e1 90  fa c7 a1 05 42 ae c2 50  |..2..c......B..P|
+00000040  da 5b d4 30 16 90 f5 1a  1a 2e 82 49 c0 09 00 00  |.[.0.......I....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  02 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,20 +48,20 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 02 00 d6 0c 00  00 d2 03 00 17 41 04 c4  |*............A..|
-00000280  2c 25 ee fd 2d 23 c8 4a  3b c5 06 e1 17 ea ab f2  |,%..-#.J;.......|
-00000290  fd fe 2a ca 99 c8 7f b3  f5 c2 f6 3a 2f de 15 46  |..*........:/..F|
-000002a0  c6 b4 fc d7 70 62 b7 2b  21 b5 1b 94 d1 89 42 93  |....pb.+!.....B.|
-000002b0  6a fa fc 58 bc 46 f8 29  2e 51 aa 12 d6 24 e6 00  |j..X.F.).Q...$..|
-000002c0  8b 30 81 88 02 42 01 7d  dc 16 b1 9c 9f 97 93 c5  |.0...B.}........|
-000002d0  a4 d6 c8 ba c6 a8 6c 05  f8 00 3b f0 4d 75 14 8b  |......l...;.Mu..|
-000002e0  f6 7e b0 a0 85 ef a6 f1  4f ba c4 9a eb 3f e1 0b  |.~......O....?..|
-000002f0  05 43 6f 63 5c 46 05 84  48 e5 62 4d b4 32 50 ec  |.Coc\F..H.bM.2P.|
-00000300  e1 15 bd 71 1a 64 b5 ad  02 42 01 dc 7d 9a 2d 98  |...q.d...B..}.-.|
-00000310  dc 9b 02 35 cf 49 69 79  e8 1d ea 87 59 28 0e 3d  |...5.Iiy....Y(.=|
-00000320  cf 1a e3 db e7 70 41 f8  24 6b c6 52 13 54 16 0d  |.....pA.$k.R.T..|
-00000330  85 88 6f 50 d5 4b 6f db  c8 5b 64 40 8b 68 0f 9e  |..oP.Ko..[d@.h..|
-00000340  3e df 9f cb 46 e4 26 7e  5c df 35 38 16 03 02 00  |>...F.&~\.58....|
+00000270  2a 16 03 02 00 d6 0c 00  00 d2 03 00 17 41 04 ce  |*............A..|
+00000280  1f 5b a2 66 41 7d 08 48  a2 82 da da bc 0d 8c 09  |.[.fA}.H........|
+00000290  39 84 9c 9c 48 20 ac 0a  d1 a4 6e db 94 48 ae a6  |9...H ....n..H..|
+000002a0  56 6e 3d c4 a2 82 f5 c7  e1 19 cc d0 25 5a 97 9b  |Vn=.........%Z..|
+000002b0  34 93 98 81 c1 4f 3b 6e  38 49 28 a4 a3 39 25 00  |4....O;n8I(..9%.|
+000002c0  8b 30 81 88 02 42 00 b6  51 8c 31 a6 9a 3b 2f 29  |.0...B..Q.1..;/)|
+000002d0  1f c1 03 80 ea 4a 94 a6  7d 7e ef c8 c6 cc 21 4d  |.....J..}~....!M|
+000002e0  2e 95 c7 57 94 d6 a0 bf  c5 c8 99 8a 93 1d 2a 9f  |...W..........*.|
+000002f0  c7 bd 71 1a c7 8c 97 0c  72 5d 60 53 e7 80 fe 3c  |..q.....r]`S...<|
+00000300  18 7a 00 60 ba 14 70 71  02 42 01 98 78 54 f0 f8  |.z.`..pq.B..xT..|
+00000310  9b f8 0f 8f e4 e0 9d 4a  08 d9 61 a9 8b 36 b4 bc  |.......J..a..6..|
+00000320  15 c1 33 93 d3 62 0c a2  b1 af 77 1e 44 39 f4 b2  |..3..b....w.D9..|
+00000330  10 b4 d0 ee 89 6a 85 af  ab 00 eb 11 b0 ba 3a 15  |.....j........:.|
+00000340  e3 b4 39 23 a8 d5 95 fe  27 8a b6 38 16 03 02 00  |..9#....'..8....|
 00000350  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
 00000000  16 03 02 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
@@ -70,21 +70,21 @@
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 02 00 01  |..h.A.Vk.Z......|
 00000050  01 16 03 02 00 40 00 00  00 00 00 00 00 00 00 00  |.....@..........|
-00000060  00 00 00 00 00 00 19 3d  59 72 cf 1a 01 ee 28 a9  |.......=Yr....(.|
-00000070  67 a1 10 33 bb f6 3e 7e  28 f1 d0 2f 9e c4 b2 65  |g..3..>~(../...e|
-00000080  2b ee 70 e8 91 57 8f 10  7b 92 6f 29 b4 ab 62 14  |+.p..W..{.o)..b.|
-00000090  1e 16 05 ad 31 95                                 |....1.|
+00000060  00 00 00 00 00 00 d5 c5  43 cf 56 45 ce 5f f6 ea  |........C.VE._..|
+00000070  ad 4a 93 47 a4 f0 66 41  cf 06 5d 50 dc 74 4b 35  |.J.G..fA..]P.tK5|
+00000080  69 0b 89 85 44 70 81 96  91 24 33 0c 7b 32 1f 98  |i...Dp...$3.{2..|
+00000090  9c b5 80 34 eb a0                                 |...4..|
 >>> Flow 4 (server to client)
-00000000  14 03 02 00 01 01 16 03  02 00 40 80 87 d5 a2 72  |..........@....r|
-00000010  bb 1a 80 24 4f 0f d2 d5  9c 3a 19 3f 1b 1f 82 93  |...$O....:.?....|
-00000020  18 f2 ab eb a0 12 bd 67  4b 28 5c cc 7f a2 72 00  |.......gK(\...r.|
-00000030  b3 89 6d 01 ae 36 74 f0  87 b0 1e ee e1 4e 08 10  |..m..6t......N..|
-00000040  67 81 17 37 02 35 e6 a0  44 1b f6                 |g..7.5..D..|
+00000000  14 03 02 00 01 01 16 03  02 00 40 bb 38 4b e5 5d  |..........@.8K.]|
+00000010  8a a1 39 b8 77 c5 b4 4e  ac f7 f9 8d ef 2b 66 0c  |..9.w..N.....+f.|
+00000020  d8 5a 93 64 fc a3 13 7a  10 f0 86 1e ff 0b 6c 02  |.Z.d...z......l.|
+00000030  b6 d6 d8 3e 5c dd 6c 0b  b5 2b c5 22 b1 4d b5 b5  |...>\.l..+.".M..|
+00000040  c8 47 30 d7 b1 2e 38 0c  22 35 0c                 |.G0...8."5.|
 >>> Flow 5 (client to server)
 00000000  17 03 02 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 51 69 5a  42 68 e5 b0 b2 49 b1 77  |.....QiZBh...I.w|
-00000020  07 77 2f 9b 99 6e e8 42  55 e5 00 2b 8d 09 aa 00  |.w/..n.BU..+....|
-00000030  63 ab aa e1 4b 15 03 02  00 30 00 00 00 00 00 00  |c...K....0......|
-00000040  00 00 00 00 00 00 00 00  00 00 e1 1c 0e 27 7b 96  |.............'{.|
-00000050  79 a4 c6 8b 3c f8 92 b0  45 bb 5d 7f 86 10 a7 05  |y...<...E.].....|
-00000060  f7 99 7d 53 82 00 2c 04  ae ed                    |..}S..,...|
+00000010  00 00 00 00 00 af a4 14  82 b5 d4 d1 c4 ec f5 64  |...............d|
+00000020  c4 75 5b f5 8b 23 7e c9  06 06 4c a8 4e b2 5b eb  |.u[..#~...L.N.[.|
+00000030  c8 a9 f8 57 b3 15 03 02  00 30 00 00 00 00 00 00  |...W.....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 13 bc 2d 1e 5c 26  |............-.\&|
+00000050  b7 3e 9d 0f 65 b8 83 01  d6 67 9e 15 e8 59 4f 18  |.>..e....g...YO.|
+00000060  2b 69 a5 d6 44 11 0f f7  b7 b7                    |+i..D.....|
diff --git a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES
index b3af7fbb9d..c808ccb1b4 100644
--- a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES
@@ -9,11 +9,11 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 02 00 59 02 00 00  55 03 02 ce 3f 49 9b 78  |....Y...U...?I.x|
-00000010  4e dc fa 9e 4b 97 41 7d  19 0e 1b 4a 70 17 b9 17  |N...K.A}...Jp...|
-00000020  5f f2 52 bb 77 80 2d 15  d6 3c 58 20 b0 41 3d 79  |_.R.w.-..<X .A=y|
-00000030  8b 39 41 d5 e8 85 9a 9d  66 b8 8f 1c 04 3c 3b f1  |.9A.....f....<;.|
-00000040  68 41 b1 3c 3f 26 79 b8  e0 3d b8 ef c0 13 00 00  |hA.<?&y..=......|
+00000000  16 03 02 00 59 02 00 00  55 03 02 8e 97 02 97 9c  |....Y...U.......|
+00000010  0c 25 1f fa 9f 0f 70 80  83 46 4f 18 d4 e3 11 a0  |.%....p..FO.....|
+00000020  78 06 b5 ad fd 89 5e bc  06 e0 18 20 3d 4c be ba  |x.....^.... =L..|
+00000030  2f 16 d8 dc 82 2c 21 39  71 5e aa 4f f5 ff e3 38  |/....,!9q^.O...8|
+00000040  66 b6 ca 93 bd 17 14 ee  2c cb 3d ce c0 13 00 00  |f.......,.=.....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  02 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,19 +53,19 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 02 00  |.=.`.\!.;.......|
-000002c0  cb 0c 00 00 c7 03 00 17  41 04 d4 a5 b1 4a 40 06  |........A....J@.|
-000002d0  d3 db cd c0 fc 51 64 61  83 49 79 ea ac 5f 9f 54  |.....Qda.Iy.._.T|
-000002e0  ac 09 89 03 b2 04 f3 5c  9d de 63 fa 0b a8 b2 0f  |.......\..c.....|
-000002f0  06 20 86 65 53 02 4b a5  72 79 8b 26 29 c8 57 78  |. .eS.K.ry.&).Wx|
-00000300  4e 4a 97 20 3b d2 ea e9  c5 55 00 80 56 68 33 90  |NJ. ;....U..Vh3.|
-00000310  88 f4 d3 ca e5 c0 69 62  ed 16 56 bf fa 13 12 ad  |......ib..V.....|
-00000320  ed 9e 34 88 02 6d 1b af  4b 0e 51 2f 80 42 01 c6  |..4..m..K.Q/.B..|
-00000330  9d 23 07 2a 0d 32 37 c0  60 83 10 d1 48 b9 bc 32  |.#.*.27.`...H..2|
-00000340  5a 6f f4 7b 96 db dc 16  47 3e f0 bd 9f 5d d3 6d  |Zo.{....G>...].m|
-00000350  a8 38 9b 46 e9 40 60 38  cd cc b6 ba 9b 1b a3 84  |.8.F.@`8........|
-00000360  c1 a4 51 7e 58 35 e6 6d  35 61 cc c7 65 23 cd fa  |..Q~X5.m5a..e#..|
-00000370  cc 3e 78 aa 7e a9 40 55  01 94 b5 69 6e ef ec bf  |.>x.~.@U...in...|
-00000380  3f f8 f8 78 81 20 c9 40  0d 4e 90 ef 16 03 02 00  |?..x. .@.N......|
+000002c0  cb 0c 00 00 c7 03 00 17  41 04 85 18 55 b4 c4 60  |........A...U..`|
+000002d0  58 34 50 d5 5f 50 3b fa  38 25 98 96 56 4b 9c 20  |X4P._P;.8%..VK. |
+000002e0  0b 17 45 a4 1f 19 71 a6  d6 71 97 3b a3 01 6c e3  |..E...q..q.;..l.|
+000002f0  4d 6f ec 76 31 c7 e4 9f  60 24 d2 2a e1 03 03 40  |Mo.v1...`$.*...@|
+00000300  9e b1 de 70 3e 44 ab ab  1d 8a 00 80 40 75 96 e1  |...p>D......@u..|
+00000310  d2 01 e4 9b bf 21 6d 9f  f9 44 b2 5f 8e f4 02 ff  |.....!m..D._....|
+00000320  b2 ec 98 b6 37 29 1b bd  0f a0 5d 91 7a d9 35 70  |....7)....].z.5p|
+00000330  67 15 72 96 00 19 b9 40  83 a4 c8 7c 06 e4 c8 b8  |g.r....@...|....|
+00000340  d5 5c ac e5 db c1 01 cc  26 0e 6f 93 d9 d4 07 b3  |.\......&.o.....|
+00000350  8d 05 21 0e 20 5c f7 5c  84 24 71 74 99 af 50 27  |..!. \.\.$qt..P'|
+00000360  64 49 ce 3b cd 3e 84 f7  ef 76 de 3a 22 88 fa 15  |dI.;.>...v.:"...|
+00000370  c1 6c 27 60 ec 2a 3f 6b  10 a0 52 d6 6e 75 b0 6f  |.l'`.*?k..R.nu.o|
+00000380  ff 85 fe 1f d2 46 85 ab  89 41 56 e4 16 03 02 00  |.....F...AV.....|
 00000390  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
 00000000  16 03 02 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
@@ -74,21 +74,21 @@
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 02 00 01  |..h.A.Vk.Z......|
 00000050  01 16 03 02 00 40 00 00  00 00 00 00 00 00 00 00  |.....@..........|
-00000060  00 00 00 00 00 00 e0 5c  f2 89 75 19 aa 82 30 03  |.......\..u...0.|
-00000070  ef f3 4b 52 d8 a7 43 19  0d 8b 44 c4 32 e1 c1 4e  |..KR..C...D.2..N|
-00000080  39 1c c4 03 3d b6 37 96  8d 91 6d 36 23 7c 07 13  |9...=.7...m6#|..|
-00000090  f5 00 68 69 6f e5                                 |..hio.|
+00000060  00 00 00 00 00 00 fb 9c  16 6d 8d 12 6a ea 0a b6  |.........m..j...|
+00000070  61 50 73 10 7c 91 e7 e8  93 db 85 81 2b a2 d0 f6  |aPs.|.......+...|
+00000080  d0 9a 69 50 cd c9 c2 d5  d3 2c 35 65 4f 6a 04 c0  |..iP.....,5eOj..|
+00000090  d3 10 8d 8f 00 0d                                 |......|
 >>> Flow 4 (server to client)
-00000000  14 03 02 00 01 01 16 03  02 00 40 8e b6 a7 b6 3a  |..........@....:|
-00000010  d2 49 ac fe e7 70 3e 95  94 8d 03 f6 be a8 9d fe  |.I...p>.........|
-00000020  1b a9 0c 2a 79 ed dd 8d  6b f0 79 8c 2a 78 f3 14  |...*y...k.y.*x..|
-00000030  4b 1a 86 ec 64 e5 6d 33  93 fb 9d 6a 3b 99 95 28  |K...d.m3...j;..(|
-00000040  7d 39 cc cb ce 21 fc 55  c0 65 05                 |}9...!.U.e.|
+00000000  14 03 02 00 01 01 16 03  02 00 40 c9 0d 8e ea 5e  |..........@....^|
+00000010  49 d1 09 34 4a 4e 58 43  bd ce ed fe 38 77 5a 6b  |I..4JNXC....8wZk|
+00000020  55 ad ec 48 7a 91 4a 86  6f e8 eb 76 c8 5b ac 98  |U..Hz.J.o..v.[..|
+00000030  9d ce 04 ae 8c 1f 97 e8  c3 75 74 75 57 e8 f1 31  |.........utuW..1|
+00000040  bd d6 39 7d 63 dc e1 a1  68 38 a3                 |..9}c...h8.|
 >>> Flow 5 (client to server)
 00000000  17 03 02 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 3a 66 f0  79 00 4d 4c 1e 66 e5 44  |.....:f.y.ML.f.D|
-00000020  16 08 fb 51 1e e7 e5 34  c6 f0 24 af ac 73 fb 4a  |...Q...4..$..s.J|
-00000030  76 ea 5c 3d 05 15 03 02  00 30 00 00 00 00 00 00  |v.\=.....0......|
-00000040  00 00 00 00 00 00 00 00  00 00 64 15 58 c9 d4 88  |..........d.X...|
-00000050  e3 9f c2 d7 68 55 cf 50  e7 41 19 b2 0a d7 8c 0e  |....hU.P.A......|
-00000060  80 8d f8 68 45 c3 77 c6  05 c4                    |...hE.w...|
+00000010  00 00 00 00 00 78 a4 2e  0b 07 f4 e4 0c de 6b fc  |.....x........k.|
+00000020  7e c5 0d f2 a6 7c 2a 0e  cf 71 b4 79 40 7b 38 f1  |~....|*..q.y@{8.|
+00000030  89 e4 00 f1 f4 15 03 02  00 30 00 00 00 00 00 00  |.........0......|
+00000040  00 00 00 00 00 00 00 00  00 00 b8 56 bf 9a a3 93  |...........V....|
+00000050  07 84 de b3 cb 7c 17 d8  92 52 45 d7 07 fb c6 09  |.....|...RE.....|
+00000060  d9 4a 96 c0 73 62 d8 12  94 69                    |.J..sb...i|
diff --git a/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4 b/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4
index 30824c6206..17079531ee 100644
--- a/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4
+++ b/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4
@@ -9,11 +9,11 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 02 00 51 02 00 00  4d 03 02 79 51 85 f7 61  |....Q...M..yQ..a|
-00000010  76 b1 6e a0 f4 f5 07 01  86 38 bd 08 f6 97 fe 36  |v.n......8.....6|
-00000020  80 f0 b0 a8 e5 d6 1b a9  30 56 82 20 1e 9f 1b 39  |........0V. ...9|
-00000030  8c b6 64 a9 94 6a 78 15  02 0d ce 83 57 7e 27 e1  |..d..jx.....W~'.|
-00000040  35 c6 3b 77 c6 21 88 e2  90 0b bc 07 00 05 00 00  |5.;w.!..........|
+00000000  16 03 02 00 51 02 00 00  4d 03 02 07 14 79 f7 7c  |....Q...M....y.||
+00000010  2b b0 4e 8c 64 60 3b 6f  f9 ae fe fd 72 4d 18 84  |+.N.d`;o....rM..|
+00000020  33 9d 89 6b 9c 82 02 8a  49 5a 13 20 26 8b 4d d2  |3..k....IZ. &.M.|
+00000030  af 0e 10 62 4d 20 8f 53  81 b9 da 40 9f fc 35 f8  |...bM .S...@..5.|
+00000040  d2 35 8b e0 05 1e 40 d4  43 7c ac 23 00 05 00 00  |.5....@.C|.#....|
 00000050  05 ff 01 00 01 00 16 03  02 02 59 0b 00 02 55 00  |..........Y...U.|
 00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -63,15 +63,15 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 02 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 02 00 24 72 27  a5 3c 05 94 3e 33 89 f3  |.....$r'.<..>3..|
-000000a0  8f 76 29 e6 18 b3 51 a9  72 e5 88 0c 6c 6f 81 08  |.v)...Q.r...lo..|
-000000b0  7b 80 4b 35 00 1d e2 57  2a cb                    |{.K5...W*.|
+00000090  01 16 03 02 00 24 b7 ab  3d c9 24 dc 26 aa 3c 1d  |.....$..=.$.&.<.|
+000000a0  86 71 38 8a 58 3e fe 3c  48 4f f4 d5 27 43 ae 88  |.q8.X>.<HO..'C..|
+000000b0  fb 07 df 17 9b 87 d9 0b  20 a6                    |........ .|
 >>> Flow 4 (server to client)
-00000000  14 03 02 00 01 01 16 03  02 00 24 eb 2c 34 2f 7e  |..........$.,4/~|
-00000010  f1 6c 7a 74 a8 78 f3 f6  31 e6 e8 47 c4 a8 22 b7  |.lzt.x..1..G..".|
-00000020  45 54 12 35 fa 1c 49 c3  e4 98 68 57 3b f7 9e     |ET.5..I...hW;..|
+00000000  14 03 02 00 01 01 16 03  02 00 24 04 ee d2 d4 23  |..........$....#|
+00000010  c0 5e aa 9a 39 cc fc 9f  85 c7 4e 23 ed 89 0f f5  |.^..9.....N#....|
+00000020  0d 79 36 f5 04 92 a7 3d  08 1b e6 44 94 ca 03     |.y6....=...D...|
 >>> Flow 5 (client to server)
-00000000  17 03 02 00 1a 0a 0c 4d  74 f8 72 f8 b5 c4 08 94  |.......Mt.r.....|
-00000010  5b 59 b3 c0 49 9d a6 2d  b0 d0 eb a2 b3 d9 ec 15  |[Y..I..-........|
-00000020  03 02 00 16 f5 1e d1 1f  cf 58 33 a6 78 48 5b c1  |.........X3.xH[.|
-00000030  15 4d e5 fb 20 d0 c5 75  fc c0                    |.M.. ..u..|
+00000000  17 03 02 00 1a f4 bd cb  9f 9c 3c 42 de 9a 41 6b  |..........<B..Ak|
+00000010  62 a1 ca 8f e6 3d d2 39  98 5c 89 b9 c6 32 ee 15  |b....=.9.\...2..|
+00000020  03 02 00 16 c2 99 ce 1b  f8 7a f4 83 59 02 96 ef  |.........z..Y...|
+00000030  33 5e e6 8f 5f 5c e7 e4  0e 5a                    |3^.._\...Z|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256
index 4968b51416..315b7a66ad 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256
@@ -9,11 +9,11 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 51 02 00 00  4d 03 03 a3 21 43 88 85  |....Q...M...!C..|
-00000010  1c 79 0b 73 68 bb 9d 21  9b 9e 1b 35 ba f0 b9 23  |.y.sh..!...5...#|
-00000020  98 cc 58 c9 91 d5 d4 0b  a3 34 f4 20 1f 0b 14 7f  |..X......4. ....|
-00000030  3e b0 95 a8 3e 55 80 d3  72 81 39 72 79 11 59 8e  |>...>U..r.9ry.Y.|
-00000040  9e 5d 57 14 00 fd 48 6a  a1 76 f5 83 00 9c 00 00  |.]W...Hj.v......|
+00000000  16 03 03 00 51 02 00 00  4d 03 03 c5 42 c0 de 64  |....Q...M...B..d|
+00000010  f2 2a cc a1 5e ab 9e 11  b0 d7 63 23 02 4e b3 8a  |.*..^.....c#.N..|
+00000020  08 07 0a f0 ac 7f b4 77  26 8a b7 20 37 1f 7c 28  |.......w&.. 7.|(|
+00000030  3d 7a 6a 58 ee c3 b9 36  cd f0 38 a6 1e 90 a3 6e  |=zjX...6..8....n|
+00000040  c1 ee e3 55 30 50 9a 55  bc 2c be dc 00 9c 00 00  |...U0P.U.,......|
 00000050  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
 00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -63,17 +63,17 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 71 ea  |.....(........q.|
-000000a0  6e 5a 0e 2b bf 1e b6 c8  ca 92 04 e4 b3 cc f7 00  |nZ.+............|
-000000b0  79 a1 5f 96 a5 a5 a7 26  e6 0c a1 b0 7c 1f        |y._....&....|.|
+00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 de a7  |.....(..........|
+000000a0  bc ad 94 20 fb 58 5e 46  9e 3f 31 63 14 ea e9 a4  |... .X^F.?1c....|
+000000b0  30 9e 12 3f a0 cd 9d b9  94 c2 31 58 38 2f        |0..?......1X8/|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 55 d1 d6 5c df  |..........(U..\.|
-00000010  83 67 63 7f 50 f9 d7 1b  f1 93 ee fa 98 60 ab 06  |.gc.P........`..|
-00000020  b4 7e e7 d3 44 8e 7d 90  2f b9 fb 2b 35 3b 20 76  |.~..D.}./..+5; v|
-00000030  38 4e ea                                          |8N.|
+00000000  14 03 03 00 01 01 16 03  03 00 28 17 43 47 b8 bb  |..........(.CG..|
+00000010  2d 6a 77 a9 de 2d a5 15  95 cd 41 89 1a b2 c1 9f  |-jw..-....A.....|
+00000020  af fd 13 20 8a 42 1d 7e  47 45 91 c3 5a 11 75 a8  |... .B.~GE..Z.u.|
+00000030  fd 8d 1b                                          |...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 26 42 83  |.............&B.|
-00000010  2e a6 ab c2 34 5e 8c 8e  11 bf 3c e6 86 ec 90 46  |....4^....<....F|
-00000020  b1 66 a1 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.f..............|
-00000030  8e f6 8a 98 ae 2d 7d 36  e4 cc 11 aa ea 41 21 7c  |.....-}6.....A!||
-00000040  fc fe                                             |..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 73 97 7e  |.............s.~|
+00000010  de 2c d2 b9 cb fd cc 6d  f1 2c df fd 17 84 1f 21  |.,.....m.,.....!|
+00000020  d3 63 da 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.c..............|
+00000030  2a 78 32 6b b3 fb 8e f2  35 44 00 f2 32 8e b7 41  |*x2k....5D..2..A|
+00000040  34 24                                             |4$|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-AES128-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-AES128-SHA256
index c157b2a996..01a40f3ae0 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-AES128-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv12-AES128-SHA256
@@ -9,11 +9,11 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 51 02 00 00  4d 03 03 98 81 93 d5 ae  |....Q...M.......|
-00000010  17 07 94 d2 88 9d 9b 34  17 3e f6 69 aa 0a f0 a7  |.......4.>.i....|
-00000020  44 56 e4 a0 9a 2a 5c 9c  1e b4 1d 20 d7 a5 96 26  |DV...*\.... ...&|
-00000030  31 60 01 01 61 50 d2 40  70 be 79 9c 78 11 9b 80  |1`..aP.@p.y.x...|
-00000040  c5 20 b5 7a 77 51 eb 6b  ca c6 d3 fa 00 3c 00 00  |. .zwQ.k.....<..|
+00000000  16 03 03 00 51 02 00 00  4d 03 03 18 36 ba 7c 68  |....Q...M...6.|h|
+00000010  f1 d6 d4 2e c8 08 97 dd  29 50 9c cf ca d1 59 7e  |........)P....Y~|
+00000020  ec 70 1e 26 e6 9e 9e f8  32 25 1c 20 a0 45 0c ab  |.p.&....2%. .E..|
+00000030  82 2f 2a de fa 34 72 cd  55 2f f3 ac 8b 02 e9 38  |./*..4r.U/.....8|
+00000040  eb 9c a1 c5 fa e4 f6 44  88 1e 5f 42 00 3c 00 00  |.......D.._B.<..|
 00000050  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
 00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -64,25 +64,25 @@
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
 00000090  01 16 03 03 00 50 00 00  00 00 00 00 00 00 00 00  |.....P..........|
-000000a0  00 00 00 00 00 00 8c d5  df ad b6 03 cd aa 22 28  |.............."(|
-000000b0  c7 aa 35 6a ce 63 e0 6e  84 ed a0 7c 33 ea 0a 0e  |..5j.c.n...|3...|
-000000c0  65 9f 33 11 a9 9a 26 e8  e9 61 d5 3d 6c 75 b8 ad  |e.3...&..a.=lu..|
-000000d0  00 6e 4f 39 ef 63 7f e9  5d 4d 02 80 c9 f1 f3 5b  |.nO9.c..]M.....[|
-000000e0  37 82 57 27 5c 5a                                 |7.W'\Z|
+000000a0  00 00 00 00 00 00 c6 3f  74 c9 ec e1 37 a5 d1 ed  |.......?t...7...|
+000000b0  e2 08 b5 97 01 cb 15 db  9a fb 31 f7 fa 6b fd e6  |..........1..k..|
+000000c0  f1 4f 9c 90 f2 cb 78 e6  2d 9c 30 ba d4 d0 8e b4  |.O....x.-.0.....|
+000000d0  6d f1 ca 3d ec 03 6d aa  8b e2 ed 2f 46 79 30 8f  |m..=..m..../Fy0.|
+000000e0  6f bb cf 6f 11 93                                 |o..o..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 50 be 8e 07 a1 cd  |..........P.....|
-00000010  0d 32 45 c2 6c b8 2f 13  85 8a a6 dd 91 96 9d c6  |.2E.l./.........|
-00000020  6b 99 0d 6a 09 90 a1 09  b1 5e 93 40 02 66 b5 4e  |k..j.....^.@.f.N|
-00000030  2e 6a e4 61 21 30 ca 6e  dc 82 69 de a9 dc 91 c1  |.j.a!0.n..i.....|
-00000040  99 f7 be 83 54 78 b8 7c  ae c8 bc d5 5b 3c 8c 57  |....Tx.|....[<.W|
-00000050  22 9a f8 12 8f 20 25 7d  27 41 16                 |".... %}'A.|
+00000000  14 03 03 00 01 01 16 03  03 00 50 d3 02 06 a8 ab  |..........P.....|
+00000010  30 1e 01 16 cb ef 01 de  36 9c 7e 8f 3e c4 74 e9  |0.......6.~.>.t.|
+00000020  8f 33 c3 ab c3 bf 6e 46  c3 1d 43 16 be bb 63 cf  |.3....nF..C...c.|
+00000030  79 c5 d3 f8 97 b7 ea 73  9d bb e9 3a 02 c6 4d 6f  |y......s...:..Mo|
+00000040  75 cb 8d bd 16 22 1f 0e  56 d6 ef 6f 31 b9 a5 2e  |u...."..V..o1...|
+00000050  ca 02 21 0b 10 d8 44 6a  09 ae 14                 |..!...Dj...|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000010  00 00 00 00 00 0d d7 40  0b f7 6b 93 ea f1 e8 62  |.......@..k....b|
-00000020  ff d3 4d 1a d8 06 43 32  7b 43 c2 27 61 13 a7 79  |..M...C2{C.'a..y|
-00000030  5d 69 ad 62 62 33 cb db  80 a7 1b 1b 46 a0 c4 f2  |]i.bb3......F...|
-00000040  ee dd 44 b9 5b 15 03 03  00 40 00 00 00 00 00 00  |..D.[....@......|
-00000050  00 00 00 00 00 00 00 00  00 00 b1 cd 45 e1 d5 a5  |............E...|
-00000060  83 68 34 51 2b e6 19 b1  0f 57 95 4a 0d c7 cd d1  |.h4Q+....W.J....|
-00000070  8b aa 32 f1 f7 a4 1f 46  4a 4b cb 5f 5f ce 46 49  |..2....FJK.__.FI|
-00000080  81 07 9d e0 c0 6c fa ae  68 5c                    |.....l..h\|
+00000010  00 00 00 00 00 38 7f df  9d 49 fc e7 b7 f8 ba 53  |.....8...I.....S|
+00000020  d6 0f c1 b8 2e 54 76 3e  d8 c9 93 16 2c 63 09 dc  |.....Tv>....,c..|
+00000030  ac 4b 73 59 7c 71 c2 46  4d 37 a7 c6 9b ab 7f 4c  |.KsY|q.FM7.....L|
+00000040  6a cb fe 1e a3 15 03 03  00 40 00 00 00 00 00 00  |j........@......|
+00000050  00 00 00 00 00 00 00 00  00 00 65 f8 5f f9 73 a7  |..........e._.s.|
+00000060  6c a0 b1 58 b7 3c 63 77  df d0 64 54 fb 76 d8 ca  |l..X.<cw..dT.v..|
+00000070  01 11 0b cb ad 41 f7 ad  cb 56 d2 be 89 1b 70 dd  |.....A...V....p.|
+00000080  23 5e 96 82 bd c1 8e a4  0d 30                    |#^.......0|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384 b/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384
index 864e30bbeb..e088893cbd 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384
+++ b/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384
@@ -9,11 +9,11 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 51 02 00 00  4d 03 03 0f 84 66 da 4b  |....Q...M....f.K|
-00000010  db c1 8a a4 de 44 9f 7a  00 73 20 c7 30 fe 42 4f  |.....D.z.s .0.BO|
-00000020  5e 05 98 ec 32 0d 4c 35  59 de dd 20 63 e2 0b b0  |^...2.L5Y.. c...|
-00000030  e1 0a f3 4f 0c 92 68 56  46 ad ef 09 46 db ec 8f  |...O..hVF...F...|
-00000040  e3 b2 e9 6d 3b a7 7b 40  cf 8d 42 0e 00 9d 00 00  |...m;.{@..B.....|
+00000000  16 03 03 00 51 02 00 00  4d 03 03 1e 58 69 db 16  |....Q...M...Xi..|
+00000010  a1 d9 2c 3c b5 68 b6 b1  dc 1e 1d ba 9e dc bf b0  |..,<.h..........|
+00000020  15 7e ea b1 40 66 3b fc  95 75 0d 20 4c 96 db 56  |.~..@f;..u. L..V|
+00000030  fc 7d 2b 0a 06 89 1e 62  9e ee 36 51 f4 e4 2b f8  |.}+....b..6Q..+.|
+00000040  5a 7a ef a4 d1 1f 7e ff  06 13 a1 38 00 9d 00 00  |Zz....~....8....|
 00000050  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
 00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -63,17 +63,17 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 3f eb  |.....(........?.|
-000000a0  b8 b8 eb 79 63 ce f1 b5  f6 d8 87 28 93 17 cb 35  |...yc......(...5|
-000000b0  88 6d 4e 09 9d 91 e9 f1  20 f6 50 34 89 8b        |.mN..... .P4..|
+00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 6b a3  |.....(........k.|
+000000a0  3b 4a 47 f7 43 00 7d 7b  9e 35 91 8d e4 b1 00 86  |;JG.C.}{.5......|
+000000b0  e2 04 db e8 c5 c4 66 34  b8 4b fc 7e a6 68        |......f4.K.~.h|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 e6 95 78 b9 fb  |..........(..x..|
-00000010  7a 79 ad 3b 3d cd 42 80  c0 d3 81 ce 83 72 d1 b6  |zy.;=.B......r..|
-00000020  72 64 23 a8 ee 7f 35 88  53 5d 03 f2 a1 1d 4a e1  |rd#...5.S]....J.|
-00000030  f7 63 c4                                          |.c.|
+00000000  14 03 03 00 01 01 16 03  03 00 28 9c 20 45 1f 6b  |..........(. E.k|
+00000010  0f 08 fb 61 03 12 ca ac  78 04 30 1c 98 50 d8 44  |...a....x.0..P.D|
+00000020  4e 6f d6 57 70 cd 86 49  92 a0 7d 3e 12 a0 3d ab  |No.Wp..I..}>..=.|
+00000030  a6 59 ca                                          |.Y.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 94 30 a0  |..............0.|
-00000010  df 8a fd 3f 61 98 97 fa  b3 82 3c 65 1a 3c e4 b2  |...?a.....<e.<..|
-00000020  b7 df 3e 15 03 03 00 1a  00 00 00 00 00 00 00 02  |..>.............|
-00000030  99 e6 16 fd f2 11 bf 28  fc f9 fb 20 31 5b cb 41  |.......(... 1[.A|
-00000040  30 3a                                             |0:|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 06 e7 a0  |................|
+00000010  e1 37 e0 e9 2c e9 cb 2f  3d d8 52 e0 b6 37 22 d2  |.7..,../=.R..7".|
+00000020  cb 3f d9 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.?..............|
+00000030  9d 73 09 7a bd 3c c8 db  b6 5f 2d 3b c6 ce 5f eb  |.s.z.<..._-;.._.|
+00000040  2e 40                                             |.@|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ALPN b/src/crypto/tls/testdata/Client-TLSv12-ALPN
index 506447dcef..0d11e9768f 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ALPN
+++ b/src/crypto/tls/testdata/Client-TLSv12-ALPN
@@ -11,11 +11,11 @@
 00000090  00 10 00 10 00 0e 06 70  72 6f 74 6f 32 06 70 72  |.......proto2.pr|
 000000a0  6f 74 6f 31 00 12 00 00                           |oto1....|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 66 02 00 00  62 03 03 0c a7 7a d3 5c  |....f...b....z.\|
-00000010  e0 a4 0b 86 4f ac b8 40  37 f3 5c 30 f2 a5 9d 7a  |....O..@7.\0...z|
-00000020  fe 9d 51 3e 03 62 7a 02  46 d2 f8 20 e9 4c a0 1a  |..Q>.bz.F.. .L..|
-00000030  fa 02 84 51 9f dc 01 88  73 4b 61 66 11 6f e4 58  |...Q....sKaf.o.X|
-00000040  31 ff 97 2d 26 38 56 db  cf 2c e0 72 c0 2f 00 00  |1..-&8V..,.r./..|
+00000000  16 03 03 00 66 02 00 00  62 03 03 d6 86 dc 38 ce  |....f...b.....8.|
+00000010  7a e4 81 d8 c8 2a 65 a4  90 70 da 03 5c 29 48 69  |z....*e..p..\)Hi|
+00000020  90 f5 cb 00 5d 3e 98 a5  5c 80 4f 20 42 df b6 1f  |....]>..\.O B...|
+00000030  c7 db 87 d5 8a 0c 5d 56  cb 4e 95 7e 7a 82 f1 5f  |......]V.N.~z.._|
+00000040  d5 2d 33 a6 a8 82 09 e6  a9 5f d2 7b c0 2f 00 00  |.-3......_.{./..|
 00000050  1a ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 10  |................|
 00000060  00 09 00 07 06 70 72 6f  74 6f 31 16 03 03 02 59  |.....proto1....Y|
 00000070  0b 00 02 55 00 02 52 00  02 4f 30 82 02 4b 30 82  |...U..R..O0..K0.|
@@ -56,19 +56,19 @@
 000002a0  1c f1 0f a1 d8 40 83 61  c9 4c 72 2b 9d ae db 46  |.....@.a.Lr+...F|
 000002b0  06 06 4d f4 c1 b3 3e c0  d1 bd 42 d4 db fe 3d 13  |..M...>...B...=.|
 000002c0  60 84 5c 21 d3 3b e9 fa  e7 16 03 03 00 cd 0c 00  |`.\!.;..........|
-000002d0  00 c9 03 00 17 41 04 21  8b 87 3e 55 73 ed 1f d6  |.....A.!..>Us...|
-000002e0  78 74 61 6c b5 02 90 2f  c3 0b 0c 69 11 3a 23 4e  |xtal.../...i.:#N|
-000002f0  5b 82 bd d4 a8 da 66 34  7f 73 99 d3 7f 92 16 44  |[.....f4.s.....D|
-00000300  1c 90 0e 2a 39 d0 e3 25  4b 00 7b 1a 04 5f 98 0f  |...*9..%K.{.._..|
-00000310  d4 ef c5 12 df 46 ef 04  01 00 80 ae 98 07 54 3d  |.....F........T=|
-00000320  c3 62 ef 34 96 02 54 cf  af 5e 5f b8 5e d3 6e 2c  |.b.4..T..^_.^.n,|
-00000330  35 59 90 f8 f8 02 c9 04  1a 8b cf 9d 59 12 4d be  |5Y..........Y.M.|
-00000340  3b 38 fe 09 83 3e 59 8c  61 a5 77 46 e8 68 c2 0d  |;8...>Y.a.wF.h..|
-00000350  f7 22 70 35 f8 1c 35 70  d5 f8 6a 1f 4d 0a 0c 25  |."p5..5p..j.M..%|
-00000360  26 7e 76 ce 4a 5d 6d 8c  36 68 89 8d 23 f3 90 09  |&~v.J]m.6h..#...|
-00000370  5a e1 bc b4 6e 96 22 65  1f 0b 9a 5b c5 67 9e 48  |Z...n."e...[.g.H|
-00000380  c4 d0 ab 1d 5f 9b 61 20  06 cd 6d 5b 5e 60 a8 c9  |...._.a ..m[^`..|
-00000390  dd 8f c2 33 69 ac 8f ef  ef 67 a2 16 03 03 00 04  |...3i....g......|
+000002d0  00 c9 03 00 17 41 04 89  49 b3 e4 a9 b8 e5 08 ff  |.....A..I.......|
+000002e0  5f f5 8c 97 d5 a0 66 9c  9d 36 22 1e 39 32 be c2  |_.....f..6".92..|
+000002f0  05 6c d5 15 28 31 f8 e7  98 f1 6e 94 d6 72 41 b4  |.l..(1....n..rA.|
+00000300  87 39 0e 63 74 43 de 0a  d5 93 51 48 c4 2d f4 20  |.9.ctC....QH.-. |
+00000310  c6 f7 ac 95 a1 b2 40 04  01 00 80 29 ac 3f 1e 0f  |......@....).?..|
+00000320  68 56 c5 02 f6 05 63 58  58 56 11 22 d7 e4 8e 22  |hV....cXXV."..."|
+00000330  c9 9f 7e c0 09 08 d6 ba  b7 e2 e4 ef 93 4e de b6  |..~..........N..|
+00000340  67 e4 89 10 ef cf b1 c1  bd bc 52 2c 96 4d 4d a5  |g.........R,.MM.|
+00000350  fc 74 97 f8 d5 a2 aa a9  7f 98 0c 08 30 2d b3 de  |.t..........0-..|
+00000360  a7 1b 73 ed e1 a1 6f 03  84 71 2e 12 da 86 53 57  |..s...o..q....SW|
+00000370  d1 93 b0 6b 18 53 ec b4  e1 ed ed 82 07 75 dc ff  |...k.S.......u..|
+00000380  4f 6d 86 96 67 b8 f1 cb  53 89 74 0f d8 26 38 52  |Om..g...S.t..&8R|
+00000390  1d 36 b6 a7 04 e4 04 bf  a6 aa dd 16 03 03 00 04  |.6..............|
 000003a0  0e 00 00 00                                       |....|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
@@ -76,17 +76,17 @@
 00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 6b e3  |.....(........k.|
-00000060  b1 c3 b7 3f ab 57 eb eb  27 1f c0 77 05 13 37 9c  |...?.W..'..w..7.|
-00000070  2e d6 ea aa c0 de 93 22  3e e7 55 b3 45 07        |.......">.U.E.|
+00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 cc 8c  |.....(..........|
+00000060  69 a0 e9 29 fb 63 97 e7  c8 6c 78 55 54 52 0c 5a  |i..).c...lxUTR.Z|
+00000070  e7 4e bd f7 6d c6 f0 58  f1 85 25 a4 f2 ba        |.N..m..X..%...|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 cb 18 03 ae c5  |..........(.....|
-00000010  b3 96 3b df 2e de 69 b0  21 ff 73 ee 52 98 04 17  |..;...i.!.s.R...|
-00000020  b6 d6 73 e8 f1 bd da b7  cc 59 75 76 9e 91 f8 8b  |..s......Yuv....|
-00000030  b7 8a f6                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 28 f7 4a 03 ad c5  |..........(.J...|
+00000010  25 e7 e1 b9 1b 24 42 d5  09 e0 d1 3a 0d 9f 1c f7  |%....$B....:....|
+00000020  ff 50 58 a0 94 df ec db  51 b7 78 0d 37 0c 27 e2  |.PX.....Q.x.7.'.|
+00000030  eb f5 de                                          |...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 9b 27 1f  |..............'.|
-00000010  a1 ad 76 5f 08 ba eb cb  48 30 b8 f2 76 ef a7 ba  |..v_....H0..v...|
-00000020  9a e9 96 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
-00000030  07 87 4d 76 93 bb f1 ed  5b e0 aa b7 9b 08 9f d0  |..Mv....[.......|
-00000040  6e 8d                                             |n.|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 68 c1 51  |.............h.Q|
+00000010  af fa bd 62 55 11 ef 68  f1 1f 7d b2 16 a1 98 20  |...bU..h..}.... |
+00000020  1b d8 2d 15 03 03 00 1a  00 00 00 00 00 00 00 02  |..-.............|
+00000030  f6 3b 3e 30 66 9b 16 22  34 77 4e 7c b5 45 0a b7  |.;>0f.."4wN|.E..|
+00000040  bd 03                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA
index cfe9758b97..09e53fa8ab 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA
@@ -9,11 +9,11 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 a5 35 db 1b a2  |....Y...U...5...|
-00000010  5a 62 21 c3 01 04 be 89  b6 ed e9 aa 6d 6b 9e 66  |Zb!.........mk.f|
-00000020  cb 7d 11 cc 73 66 e4 34  a5 3c 04 20 f0 4d 98 26  |.}..sf.4.<. .M.&|
-00000030  bb 7d 45 18 eb ad 5f 44  f9 82 5c 23 19 a1 6b 94  |.}E..._D..\#..k.|
-00000040  fb 02 fe 7b d2 a9 90 d1  a0 5e 79 a1 c0 09 00 00  |...{.....^y.....|
+00000000  16 03 03 00 59 02 00 00  55 03 03 64 64 5f 03 5d  |....Y...U..dd_.]|
+00000010  dd b2 e8 09 d6 a7 26 0b  52 06 1e 3b 10 36 fd a3  |......&.R..;.6..|
+00000020  32 ef 0b d9 90 a6 94 d0  f4 84 af 20 c3 56 fb 0e  |2.......... .V..|
+00000030  1c be 28 5e 5c 11 8d ca  db 7b c2 55 ff b3 b0 c6  |..(^\....{.U....|
+00000040  73 04 5c c4 d1 3b ef f2  f0 73 5b f4 c0 09 00 00  |s.\..;...s[.....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,23 +48,24 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 d7 0c 00  00 d3 03 00 17 41 04 5d  |*............A.]|
-00000280  75 5f 4d 4b c7 73 93 8a  be 43 dd 1e 70 a2 c7 c4  |u_MK.s...C..p...|
-00000290  7e f9 15 fe 8e d0 e0 f9  f7 37 fc 8a d7 3f 0d c4  |~........7...?..|
-000002a0  91 f0 f9 2e ca 09 0c d1  ff 0a 56 98 b1 3c 9a e9  |..........V..<..|
-000002b0  54 c4 34 5a 96 bd 4f 60  3d 67 85 13 4b c9 6d 04  |T.4Z..O`=g..K.m.|
-000002c0  03 00 8a 30 81 87 02 42  01 ae f0 63 00 b9 cc 88  |...0...B...c....|
-000002d0  d0 8d 9f 8f b1 1d bc f4  e5 3a 95 31 df 0a 83 d1  |.........:.1....|
-000002e0  e8 97 93 7a e8 e6 aa 47  a3 bd f3 cc 6c 8e 1d 09  |...z...G....l...|
-000002f0  92 99 f1 8f 0e 2b c8 96  fc 6c b3 d1 ea 1e 4c f0  |.....+...l....L.|
-00000300  af 8c 22 37 44 55 fd 43  90 6a 02 41 5c fa 17 52  |.."7DU.C.j.A\..R|
-00000310  c0 d3 1d 4d e0 59 c1 62  45 ed 07 05 84 d5 54 91  |...M.Y.bE.....T.|
-00000320  a6 e6 28 54 31 fa 66 03  de 70 35 42 b0 25 b1 43  |..(T1.f..p5B.%.C|
-00000330  bf 78 21 1f 29 ef a6 a1  7c 47 d8 00 07 ae 94 69  |.x!.)...|G.....i|
-00000340  71 e4 d2 c1 ee a8 e1 42  62 c0 00 ab 2b 16 03 03  |q......Bb...+...|
-00000350  00 2e 0d 00 00 26 03 01  02 40 00 1e 06 01 06 02  |.....&...@......|
+00000270  2a 16 03 03 00 d7 0c 00  00 d3 03 00 17 41 04 c7  |*............A..|
+00000280  a9 99 b7 b8 af 34 55 af  9f 34 23 d6 ca 9b 12 3c  |.....4U..4#....<|
+00000290  c6 53 40 29 60 98 b9 eb  d6 8e b5 4b 63 7f 93 fd  |.S@)`......Kc...|
+000002a0  9d b9 6b bb 56 32 4f 7d  20 9e d8 c5 85 7b 03 75  |..k.V2O} ....{.u|
+000002b0  06 c9 dd 41 38 46 95 0b  68 b0 59 bf cf 6a c4 04  |...A8F..h.Y..j..|
+000002c0  03 00 8a 30 81 87 02 42  01 7c 38 39 37 3a 27 bc  |...0...B.|897:'.|
+000002d0  e9 31 2d df 09 0c 7f eb  63 52 92 ca 72 53 ee 0b  |.1-.....cR..rS..|
+000002e0  1f 8b d0 54 4a e5 4e 3a  55 50 d4 8d 44 bf 69 f1  |...TJ.N:UP..D.i.|
+000002f0  4b c1 8c d5 02 61 d1 e7  28 6d 02 5d e8 23 e9 7a  |K....a..(m.].#.z|
+00000300  78 de a7 12 2b 6c 58 d1  1b 53 02 41 0d 45 b6 ac  |x...+lX..S.A.E..|
+00000310  91 97 f9 95 08 4c 81 fc  15 7d 29 92 fa 1d ac 8a  |.....L...}).....|
+00000320  63 36 b6 4e 70 5b 7a 23  9d 1b 7d c7 59 64 0c 79  |c6.Np[z#..}.Yd.y|
+00000330  29 e1 b6 24 92 4a b4 8e  5a de ba 3e 72 e6 64 b5  |)..$.J..Z..>r.d.|
+00000340  1a 22 15 0b 29 a6 68 a9  04 79 11 e6 90 16 03 03  |."..).h..y......|
+00000350  00 2a 0d 00 00 26 03 01  02 40 00 1e 06 01 06 02  |.*...&...@......|
 00000360  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
-00000370  03 02 03 03 02 01 02 02  02 03 00 00 0e 00 00 00  |................|
+00000370  03 02 03 03 02 01 02 02  02 03 00 00 16 03 03 00  |................|
+00000380  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
 00000000  16 03 03 02 0a 0b 00 02  06 00 02 03 00 02 00 30  |...............0|
 00000010  82 01 fc 30 82 01 5e 02  09 00 9a 30 84 6c 26 35  |...0..^....0.l&5|
@@ -104,31 +105,31 @@
 00000230  24 20 3e b2 56 1c ce 97  28 5e f8 2b 2d 4f 9e f1  |$ >.V...(^.+-O..|
 00000240  07 9f 6c 4b 5b 83 56 e2  32 42 e9 58 b6 d7 49 a6  |..lK[.V.2B.X..I.|
 00000250  b5 68 1a 41 03 56 6b dc  5a 89 16 03 03 00 92 0f  |.h.A.Vk.Z.......|
-00000260  00 00 8e 05 03 00 8a 30  81 87 02 41 2c 37 42 21  |.......0...A,7B!|
-00000270  8e c8 ca f5 f4 87 03 10  d1 0f f1 f4 67 23 f0 6f  |............g#.o|
-00000280  84 88 fa f1 11 51 fe a3  6f 5b 01 93 e2 cc 75 6b  |.....Q..o[....uk|
-00000290  2d 15 a5 45 6c ec f2 67  36 d4 d9 f9 87 bd 80 2c  |-..El..g6......,|
-000002a0  3f d7 79 fa 23 b0 24 05  ab e7 ac a3 f5 02 42 01  |?.y.#.$.......B.|
-000002b0  f8 ae 55 d5 11 d7 6d 89  64 aa dd 78 e7 c1 37 79  |..U...m.d..x..7y|
-000002c0  3e 6f 21 b8 65 b1 5f 8b  2a ad a2 85 ff 33 47 cb  |>o!.e._.*....3G.|
-000002d0  74 50 97 fe 3f 9e fe 86  0c 4c b5 55 38 79 f2 cb  |tP..?....L.U8y..|
-000002e0  79 bc 8d 74 26 f6 c8 11  3b 09 2a ac df 85 6e a5  |y..t&...;.*...n.|
-000002f0  68 14 03 03 00 01 01 16  03 03 00 40 00 00 00 00  |h..........@....|
-00000300  00 00 00 00 00 00 00 00  00 00 00 00 26 59 df 86  |............&Y..|
-00000310  ac 11 55 5e 42 84 d1 18  f0 f0 90 56 dd 52 e9 05  |..U^B......V.R..|
-00000320  8d bc c2 54 bc c2 bb 5f  7f 5c 87 bf 61 e2 cb 84  |...T..._.\..a...|
-00000330  03 5b 3b f4 fd af 10 c8  9a e6 f6 07              |.[;.........|
+00000260  00 00 8e 05 03 00 8a 30  81 87 02 41 1b 43 f7 73  |.......0...A.C.s|
+00000270  e1 be a7 4a 35 78 2c a2  e1 44 e0 61 3f ea 46 0b  |...J5x,..D.a?.F.|
+00000280  b7 d2 63 4e a6 3b 09 77  93 f3 25 45 27 b0 dc 19  |..cN.;.w..%E'...|
+00000290  21 68 4a 74 bc 5b 9c c0  b0 d6 3f cb 99 91 0f 39  |!hJt.[....?....9|
+000002a0  58 0a f6 cd 41 7f 51 70  9e 4c 49 9f 6f 02 42 00  |X...A.Qp.LI.o.B.|
+000002b0  82 7e e2 38 b5 92 c8 3a  48 97 49 9f 75 ae c6 d5  |.~.8...:H.I.u...|
+000002c0  dc 8f 2c 81 7a 92 8c a0  01 93 98 30 ca b3 af da  |..,.z......0....|
+000002d0  4e 0d 7b a8 fb a9 a4 62  c7 29 4b 0b 93 57 e8 b7  |N.{....b.)K..W..|
+000002e0  cb bf 3a c7 31 6b 35 02  a1 c9 01 60 bb 51 fa 52  |..:.1k5....`.Q.R|
+000002f0  f9 14 03 03 00 01 01 16  03 03 00 40 00 00 00 00  |...........@....|
+00000300  00 00 00 00 00 00 00 00  00 00 00 00 4b 54 84 bf  |............KT..|
+00000310  47 6f 0d 7b 08 4b e4 4c  b9 6f 3b 9b 3a 1c 80 25  |Go.{.K.L.o;.:..%|
+00000320  d5 68 7c 9c d9 db 22 69  17 8a 54 17 8a d7 40 b9  |.h|..."i..T...@.|
+00000330  32 d0 d3 a8 a5 1c e9 3d  da e6 24 44              |2......=..$D|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 b6 0b 80 19 e9  |..........@.....|
-00000010  95 a5 fe c1 f8 77 58 73  56 05 ce 3c d5 b9 69 9f  |.....wXsV..<..i.|
-00000020  10 de 6c de 0c 69 36 1d  d8 4e 77 a3 e8 4b d7 70  |..l..i6..Nw..K.p|
-00000030  8f a7 aa 98 7d 33 90 59  1f ef f4 f4 b0 3e 36 16  |....}3.Y.....>6.|
-00000040  b4 93 69 7c f5 96 c1 0c  cd 68 77                 |..i|.....hw|
+00000000  14 03 03 00 01 01 16 03  03 00 40 dd cb 8d c7 40  |..........@....@|
+00000010  d6 f0 0c 37 3b ed d3 ff  b7 6e f7 ba fb 66 bd 0c  |...7;....n...f..|
+00000020  d2 c5 d9 50 0e 3a ed 75  98 fc 97 4e 29 d5 57 8d  |...P.:.u...N).W.|
+00000030  cb 76 7c 24 d2 0a b4 de  4f ab 36 85 96 e9 e0 f1  |.v|$....O.6.....|
+00000040  f2 c5 3d 0e b2 fe 79 13  7e 07 a1                 |..=...y.~..|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 ec 69 a8  8d a5 6a 42 d0 fb d0 74  |......i...jB...t|
-00000020  0d 47 d5 ca 6a 31 50 bd  b4 59 94 9e b0 ef d5 65  |.G..j1P..Y.....e|
-00000030  84 b2 fc 5c fe 15 03 03  00 30 00 00 00 00 00 00  |...\.....0......|
-00000040  00 00 00 00 00 00 00 00  00 00 37 de 04 77 46 60  |..........7..wF`|
-00000050  0a 04 6e d9 50 a9 d3 35  36 e5 77 9a fd 58 25 96  |..n.P..56.w..X%.|
-00000060  04 cc 99 88 7f ff c7 df  34 5d                    |........4]|
+00000010  00 00 00 00 00 6b 68 4c  8a e3 df 9b 61 66 a4 01  |.....khL....af..|
+00000020  63 0c b1 0f 2b e4 2c 81  48 74 82 db e6 35 e2 25  |c...+.,.Ht...5.%|
+00000030  2c 72 a5 75 5d 15 03 03  00 30 00 00 00 00 00 00  |,r.u]....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 83 87 5a 1d fe 25  |............Z..%|
+00000050  d0 42 46 0e 43 11 bf 9e  83 eb 94 bb 92 68 ea 51  |.BF.C........h.Q|
+00000060  51 2d 7e 48 f8 a6 46 15  65 cd                    |Q-~H..F.e.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA
index 3e39677018..07601f038c 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA
@@ -9,53 +9,67 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 51 02 00 00  4d 03 03 cd c3 57 e1 fc  |....Q...M....W..|
-00000010  74 7d c1 3e 26 f7 84 d1  47 10 b0 02 45 7a 79 bd  |t}.>&...G...Ezy.|
-00000020  7d 82 e4 70 39 94 1d 06  45 7a 22 20 9a 44 3c 7b  |}..p9...Ez" .D<{|
-00000030  fe 35 02 fb eb a2 14 2b  2e 26 14 04 e2 ea 8a d9  |.5.....+.&......|
-00000040  93 d3 50 be 29 45 13 05  39 54 ee ed 00 05 00 00  |..P.)E..9T......|
-00000050  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
-00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
-00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
-00000080  09 2a 86 48 86 f7 0d 01  01 0b 05 00 30 1f 31 0b  |.*.H........0.1.|
-00000090  30 09 06 03 55 04 0a 13  02 47 6f 31 10 30 0e 06  |0...U....Go1.0..|
-000000a0  03 55 04 03 13 07 47 6f  20 52 6f 6f 74 30 1e 17  |.U....Go Root0..|
-000000b0  0d 31 36 30 31 30 31 30  30 30 30 30 30 5a 17 0d  |.160101000000Z..|
-000000c0  32 35 30 31 30 31 30 30  30 30 30 30 5a 30 1a 31  |250101000000Z0.1|
-000000d0  0b 30 09 06 03 55 04 0a  13 02 47 6f 31 0b 30 09  |.0...U....Go1.0.|
-000000e0  06 03 55 04 03 13 02 47  6f 30 81 9f 30 0d 06 09  |..U....Go0..0...|
-000000f0  2a 86 48 86 f7 0d 01 01  01 05 00 03 81 8d 00 30  |*.H............0|
-00000100  81 89 02 81 81 00 db 46  7d 93 2e 12 27 06 48 bc  |.......F}...'.H.|
-00000110  06 28 21 ab 7e c4 b6 a2  5d fe 1e 52 45 88 7a 36  |.(!.~...]..RE.z6|
-00000120  47 a5 08 0d 92 42 5b c2  81 c0 be 97 79 98 40 fb  |G....B[.....y.@.|
-00000130  4f 6d 14 fd 2b 13 8b c2  a5 2e 67 d8 d4 09 9e d6  |Om..+.....g.....|
-00000140  22 38 b7 4a 0b 74 73 2b  c2 34 f1 d1 93 e5 96 d9  |"8.J.ts+.4......|
-00000150  74 7b f3 58 9f 6c 61 3c  c0 b0 41 d4 d9 2b 2b 24  |t{.X.la<..A..++$|
-00000160  23 77 5b 1c 3b bd 75 5d  ce 20 54 cf a1 63 87 1d  |#w[.;.u]. T..c..|
-00000170  1e 24 c4 f3 1d 1a 50 8b  aa b6 14 43 ed 97 a7 75  |.$....P....C...u|
-00000180  62 f4 14 c8 52 d7 02 03  01 00 01 a3 81 93 30 81  |b...R.........0.|
-00000190  90 30 0e 06 03 55 1d 0f  01 01 ff 04 04 03 02 05  |.0...U..........|
-000001a0  a0 30 1d 06 03 55 1d 25  04 16 30 14 06 08 2b 06  |.0...U.%..0...+.|
-000001b0  01 05 05 07 03 01 06 08  2b 06 01 05 05 07 03 02  |........+.......|
-000001c0  30 0c 06 03 55 1d 13 01  01 ff 04 02 30 00 30 19  |0...U.......0.0.|
-000001d0  06 03 55 1d 0e 04 12 04  10 9f 91 16 1f 43 43 3e  |..U..........CC>|
-000001e0  49 a6 de 6d b6 80 d7 9f  60 30 1b 06 03 55 1d 23  |I..m....`0...U.#|
-000001f0  04 14 30 12 80 10 48 13  49 4d 13 7e 16 31 bb a3  |..0...H.IM.~.1..|
-00000200  01 d5 ac ab 6e 7b 30 19  06 03 55 1d 11 04 12 30  |....n{0...U....0|
-00000210  10 82 0e 65 78 61 6d 70  6c 65 2e 67 6f 6c 61 6e  |...example.golan|
-00000220  67 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |g0...*.H........|
-00000230  03 81 81 00 9d 30 cc 40  2b 5b 50 a0 61 cb ba e5  |.....0.@+[P.a...|
-00000240  53 58 e1 ed 83 28 a9 58  1a a9 38 a4 95 a1 ac 31  |SX...(.X..8....1|
-00000250  5a 1a 84 66 3d 43 d3 2d  d9 0b f2 97 df d3 20 64  |Z..f=C.-...... d|
-00000260  38 92 24 3a 00 bc cf 9c  7d b7 40 20 01 5f aa d3  |8.$:....}.@ ._..|
-00000270  16 61 09 a2 76 fd 13 c3  cc e1 0c 5c ee b1 87 82  |.a..v......\....|
-00000280  f1 6c 04 ed 73 bb b3 43  77 8d 0c 1c f1 0f a1 d8  |.l..s..Cw.......|
-00000290  40 83 61 c9 4c 72 2b 9d  ae db 46 06 06 4d f4 c1  |@.a.Lr+...F..M..|
-000002a0  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
-000002b0  3b e9 fa e7 16 03 03 00  2e 0d 00 00 26 03 01 02  |;...........&...|
-000002c0  40 00 1e 06 01 06 02 06  03 05 01 05 02 05 03 04  |@...............|
-000002d0  01 04 02 04 03 03 01 03  02 03 03 02 01 02 02 02  |................|
-000002e0  03 00 00 0e 00 00 00                              |.......|
+00000000  16 03 03 00 59 02 00 00  55 03 03 47 51 31 ee d9  |....Y...U..GQ1..|
+00000010  77 ae 4c 37 cc 0c 65 22  09 63 a0 65 bd 13 46 cf  |w.L7..e".c.e..F.|
+00000020  a2 87 3e 04 75 be 32 80  8e 3f 15 20 4d 0a 0d ae  |..>.u.2..?. M...|
+00000030  e5 67 84 b5 5d 3b 08 51  4a 89 c8 e9 ae 9e 16 7b  |.g..];.QJ......{|
+00000040  3e 0a 7c 3c f5 a2 a7 29  45 cb 8b 02 c0 2f 00 00  |>.|<...)E..../..|
+00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
+00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
+00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
+00000080  3f e2 5b ea a6 30 0d 06  09 2a 86 48 86 f7 0d 01  |?.[..0...*.H....|
+00000090  01 0b 05 00 30 1f 31 0b  30 09 06 03 55 04 0a 13  |....0.1.0...U...|
+000000a0  02 47 6f 31 10 30 0e 06  03 55 04 03 13 07 47 6f  |.Go1.0...U....Go|
+000000b0  20 52 6f 6f 74 30 1e 17  0d 31 36 30 31 30 31 30  | Root0...1601010|
+000000c0  30 30 30 30 30 5a 17 0d  32 35 30 31 30 31 30 30  |00000Z..25010100|
+000000d0  30 30 30 30 5a 30 1a 31  0b 30 09 06 03 55 04 0a  |0000Z0.1.0...U..|
+000000e0  13 02 47 6f 31 0b 30 09  06 03 55 04 03 13 02 47  |..Go1.0...U....G|
+000000f0  6f 30 81 9f 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |o0..0...*.H.....|
+00000100  01 05 00 03 81 8d 00 30  81 89 02 81 81 00 db 46  |.......0.......F|
+00000110  7d 93 2e 12 27 06 48 bc  06 28 21 ab 7e c4 b6 a2  |}...'.H..(!.~...|
+00000120  5d fe 1e 52 45 88 7a 36  47 a5 08 0d 92 42 5b c2  |]..RE.z6G....B[.|
+00000130  81 c0 be 97 79 98 40 fb  4f 6d 14 fd 2b 13 8b c2  |....y.@.Om..+...|
+00000140  a5 2e 67 d8 d4 09 9e d6  22 38 b7 4a 0b 74 73 2b  |..g....."8.J.ts+|
+00000150  c2 34 f1 d1 93 e5 96 d9  74 7b f3 58 9f 6c 61 3c  |.4......t{.X.la<|
+00000160  c0 b0 41 d4 d9 2b 2b 24  23 77 5b 1c 3b bd 75 5d  |..A..++$#w[.;.u]|
+00000170  ce 20 54 cf a1 63 87 1d  1e 24 c4 f3 1d 1a 50 8b  |. T..c...$....P.|
+00000180  aa b6 14 43 ed 97 a7 75  62 f4 14 c8 52 d7 02 03  |...C...ub...R...|
+00000190  01 00 01 a3 81 93 30 81  90 30 0e 06 03 55 1d 0f  |......0..0...U..|
+000001a0  01 01 ff 04 04 03 02 05  a0 30 1d 06 03 55 1d 25  |.........0...U.%|
+000001b0  04 16 30 14 06 08 2b 06  01 05 05 07 03 01 06 08  |..0...+.........|
+000001c0  2b 06 01 05 05 07 03 02  30 0c 06 03 55 1d 13 01  |+.......0...U...|
+000001d0  01 ff 04 02 30 00 30 19  06 03 55 1d 0e 04 12 04  |....0.0...U.....|
+000001e0  10 9f 91 16 1f 43 43 3e  49 a6 de 6d b6 80 d7 9f  |.....CC>I..m....|
+000001f0  60 30 1b 06 03 55 1d 23  04 14 30 12 80 10 48 13  |`0...U.#..0...H.|
+00000200  49 4d 13 7e 16 31 bb a3  01 d5 ac ab 6e 7b 30 19  |IM.~.1......n{0.|
+00000210  06 03 55 1d 11 04 12 30  10 82 0e 65 78 61 6d 70  |..U....0...examp|
+00000220  6c 65 2e 67 6f 6c 61 6e  67 30 0d 06 09 2a 86 48  |le.golang0...*.H|
+00000230  86 f7 0d 01 01 0b 05 00  03 81 81 00 9d 30 cc 40  |.............0.@|
+00000240  2b 5b 50 a0 61 cb ba e5  53 58 e1 ed 83 28 a9 58  |+[P.a...SX...(.X|
+00000250  1a a9 38 a4 95 a1 ac 31  5a 1a 84 66 3d 43 d3 2d  |..8....1Z..f=C.-|
+00000260  d9 0b f2 97 df d3 20 64  38 92 24 3a 00 bc cf 9c  |...... d8.$:....|
+00000270  7d b7 40 20 01 5f aa d3  16 61 09 a2 76 fd 13 c3  |}.@ ._...a..v...|
+00000280  cc e1 0c 5c ee b1 87 82  f1 6c 04 ed 73 bb b3 43  |...\.....l..s..C|
+00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
+000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
+000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
+000002c0  cd 0c 00 00 c9 03 00 17  41 04 b4 86 33 cb c3 2f  |........A...3../|
+000002d0  37 f0 7c d9 2e f9 7e af  3d db e7 ef 56 03 7e 7c  |7.|...~.=...V.~||
+000002e0  ac 8a 40 8b 7f bc 6f 6f  0a 47 4c 8c 8c 91 ce 9b  |..@...oo.GL.....|
+000002f0  8f a3 2d bb db 46 3b b1  ab 1e 49 4e 11 d4 23 3d  |..-..F;...IN..#=|
+00000300  4b a9 16 0e aa 32 4e 91  f4 8e 04 01 00 80 0a 3a  |K....2N........:|
+00000310  da 17 ac 91 8b 43 8e 51  39 a0 c0 42 32 e7 77 85  |.....C.Q9..B2.w.|
+00000320  73 82 db d5 8b cc e5 b8  94 89 e8 7c 47 5d 88 ea  |s..........|G]..|
+00000330  04 76 a1 88 e5 5f e1 a7  45 d2 46 b9 26 be 9f 52  |.v..._..E.F.&..R|
+00000340  7f c3 11 a5 c7 65 8c 92  29 d0 e9 31 97 a5 a6 2a  |.....e..)..1...*|
+00000350  e0 a9 97 ed f3 88 88 59  66 dc 85 e6 5b fe 33 33  |.......Yf...[.33|
+00000360  f1 80 b4 11 01 da 07 15  7b 9f e3 e0 cb ab d9 53  |........{......S|
+00000370  ed 59 7f 88 f0 5d d8 06  b6 c4 87 75 ee df b1 39  |.Y...].....u...9|
+00000380  32 7d 62 b5 4c c5 35 e7  c1 ae db 30 e3 ce 16 03  |2}b.L.5....0....|
+00000390  03 00 2a 0d 00 00 26 03  01 02 40 00 1e 06 01 06  |..*...&...@.....|
+000003a0  02 06 03 05 01 05 02 05  03 04 01 04 02 04 03 03  |................|
+000003b0  01 03 02 03 03 02 01 02  02 02 03 00 00 16 03 03  |................|
+000003c0  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 02 0a 0b 00 02  06 00 02 03 00 02 00 30  |...............0|
 00000010  82 01 fc 30 82 01 5e 02  09 00 9a 30 84 6c 26 35  |...0..^....0.l&5|
@@ -90,34 +104,32 @@
 000001e0  be e8 91 b3 da 1a f5 5d  a3 23 f5 26 8b 45 70 8d  |.......].#.&.Ep.|
 000001f0  65 62 9b 7e 01 99 3d 18  f6 10 9a 38 61 9b 2e 57  |eb.~..=....8a..W|
 00000200  e4 fa cc b1 8a ce e2 23  a0 87 f0 e1 67 51 eb 16  |.......#....gQ..|
-00000210  03 03 00 86 10 00 00 82  00 80 b9 65 8d bf a7 c8  |...........e....|
-00000220  4b 79 ce 6f cb 8b 13 1c  ac b9 7d 66 5e e9 ba 1d  |Ky.o......}f^...|
-00000230  71 4e a9 e9 34 ae f6 64  65 90 3b d8 16 52 a2 6f  |qN..4..de.;..R.o|
-00000240  f4 cb 8a 13 74 a2 ee b7  27 69 b4 41 c0 90 68 bc  |....t...'i.A..h.|
-00000250  02 69 e1 c6 48 4f 39 36  30 25 ca 4c 17 ce 83 9e  |.i..HO960%.L....|
-00000260  08 56 e3 05 49 93 9e 2e  c4 fb e6 c8 01 f1 0f c5  |.V..I...........|
-00000270  70 0f 08 83 48 e9 48 ef  6e 50 8b 05 7e e5 84 25  |p...H.H.nP..~..%|
-00000280  fa 55 c7 ae 31 02 27 00  ef 3f 98 86 20 12 89 91  |.U..1.'..?.. ...|
-00000290  59 28 b4 f7 d7 af d2 69  61 35 16 03 03 00 93 0f  |Y(.....ia5......|
-000002a0  00 00 8f 05 03 00 8b 30  81 88 02 42 01 82 0d cf  |.......0...B....|
-000002b0  87 7a 81 ab 4c 36 a9 3d  b0 5f 03 30 4f c8 7b 1c  |.z..L6.=._.0O.{.|
-000002c0  10 d3 8d 2b b0 62 f6 f8  4d b3 82 86 76 b9 51 3c  |...+.b..M...v.Q<|
-000002d0  d2 d4 de 5b 22 17 31 7a  52 b6 8a aa 44 47 cf 63  |...[".1zR...DG.c|
-000002e0  9c d0 38 57 81 9b 44 5c  97 5e bb 85 a6 4c 02 42  |..8W..D\.^...L.B|
-000002f0  01 ff 26 48 a8 37 85 a5  b7 97 8c c2 10 1e 09 cc  |..&H.7..........|
-00000300  0f 9b 93 8d ef dc b0 0d  87 fa 77 8d 72 9e 1e 24  |..........w.r..$|
-00000310  69 ea 85 4e 83 f1 3e 8f  c4 57 8d 10 b2 26 63 97  |i..N..>..W...&c.|
-00000320  63 10 ea ef fc e8 ef 38  27 a7 b2 a9 ac c0 bb 37  |c......8'......7|
-00000330  bc bd 14 03 03 00 01 01  16 03 03 00 24 78 d8 56  |............$x.V|
-00000340  f6 78 ea 0a 29 8c 48 7c  9b 3a 79 05 2f c1 70 0d  |.x..).H|.:y./.p.|
-00000350  c4 16 2f 70 7c 1a 08 f4  37 03 44 4f e4 6d 90 d6  |../p|...7.DO.m..|
-00000360  6c                                                |l|
+00000210  03 03 00 46 10 00 00 42  41 04 1e 18 37 ef 0d 19  |...F...BA...7...|
+00000220  51 88 35 75 71 b5 e5 54  5b 12 2e 8f 09 67 fd a7  |Q.5uq..T[....g..|
+00000230  24 20 3e b2 56 1c ce 97  28 5e f8 2b 2d 4f 9e f1  |$ >.V...(^.+-O..|
+00000240  07 9f 6c 4b 5b 83 56 e2  32 42 e9 58 b6 d7 49 a6  |..lK[.V.2B.X..I.|
+00000250  b5 68 1a 41 03 56 6b dc  5a 89 16 03 03 00 92 0f  |.h.A.Vk.Z.......|
+00000260  00 00 8e 05 03 00 8a 30  81 87 02 41 78 65 c2 1f  |.......0...Axe..|
+00000270  7f 35 30 79 47 e4 78 f5  92 ed fc ae 83 3e 8a 98  |.50yG.x......>..|
+00000280  7c d2 63 f2 e4 40 e2 80  d3 2b b3 9a f4 39 1e ec  ||.c..@...+...9..|
+00000290  94 9f 7f 62 99 76 62 d5  63 66 66 44 56 d5 32 d5  |...b.vb.cffDV.2.|
+000002a0  fa ee e7 b3 2e 1a af 7d  3d dc 4f 5d cf 02 42 00  |.......}=.O]..B.|
+000002b0  f8 89 d3 86 c8 6d 90 e5  2c 75 34 5c de 21 d5 b7  |.....m..,u4\.!..|
+000002c0  86 eb 42 3f 23 71 f5 c3  c4 d9 5a db cc fa 1e e3  |..B?#q....Z.....|
+000002d0  4a e8 2c 36 e8 43 58 2f  85 d5 bb 12 c2 12 d0 aa  |J.,6.CX/........|
+000002e0  dd 2e 30 ca 7d 32 d4 c9  08 68 de 15 79 17 2e 6f  |..0.}2...h..y..o|
+000002f0  73 14 03 03 00 01 01 16  03 03 00 28 00 00 00 00  |s..........(....|
+00000300  00 00 00 00 ea 79 14 38  d6 93 fd 01 1b 71 f9 2e  |.....y.8.....q..|
+00000310  67 23 0c 52 26 5b 7c 63  6e 6d a2 7e 40 62 88 31  |g#.R&[|cnm.~@b.1|
+00000320  5c cd 05 4a                                       |\..J|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 24 ef 41 03 0c ee  |..........$.A...|
-00000010  86 32 06 48 fa 45 ad 13  65 01 2c c2 91 7a d9 9b  |.2.H.E..e.,..z..|
-00000020  4b 00 8d f0 dd 28 e4 9b  38 47 89 c0 56 7f 07     |K....(..8G..V..|
+00000000  14 03 03 00 01 01 16 03  03 00 28 a4 a0 92 38 ea  |..........(...8.|
+00000010  01 64 36 a4 83 8b a4 77  d2 b0 fd 84 89 41 33 6f  |.d6....w.....A3o|
+00000020  4e c9 cd c0 30 1f 9d 43  3d a1 d5 f6 48 5e 07 e5  |N...0..C=...H^..|
+00000030  90 64 59                                          |.dY|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1a 0e bf 71  d4 f1 32 2f b6 55 f8 2a  |.......q..2/.U.*|
-00000010  ab 41 57 7e 08 0e 13 f7  2b 13 87 61 61 59 3d 15  |.AW~....+..aaY=.|
-00000020  03 03 00 16 57 04 50 52  d9 41 4a 6b c6 e7 ec 4a  |....W.PR.AJk...J|
-00000030  57 13 07 e7 24 42 67 7a  d1 15                    |W...$Bgz..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 c4 4b 2d  |..............K-|
+00000010  31 e5 1a ed 8c 6d 44 74  d5 22 60 8a c3 91 7d 20  |1....mDt."`...} |
+00000020  c0 47 22 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.G".............|
+00000030  df d5 1d 8c b4 8b 2a 42  b5 bd 0a 0d 46 79 90 a7  |......*B....Fy..|
+00000040  39 79                                             |9y|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384 b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384
index b0b4ce7343..f18e7f7b8c 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384
@@ -9,11 +9,11 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 ba 20 14 8a 34  |....Y...U... ..4|
-00000010  98 f2 4d 9a 06 b2 35 92  b7 e9 d5 fb d1 8a 1d 8d  |..M...5.........|
-00000020  b7 91 ad 20 0f ca 9a 45  43 9a 38 20 2c fa 25 ba  |... ...EC.8 ,.%.|
-00000030  5c 8a fb 04 d2 cd 17 8b  ec 28 dc 03 fb aa 3b 68  |\........(....;h|
-00000040  47 7e 58 00 42 8f f7 cb  8a 59 b1 cd c0 30 00 00  |G~X.B....Y...0..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 e5 6a 08 9d 28  |....Y...U...j..(|
+00000010  49 64 df 4d bd 0e b8 d3  0d af d9 20 78 4a a0 b8  |Id.M....... xJ..|
+00000020  0d 12 83 5a 9a 9f 73 fe  53 d6 75 20 d5 6f df 86  |...Z..s.S.u .o..|
+00000030  33 7a 02 8c cd f9 a4 8c  ff 21 89 29 a4 ee 54 81  |3z.......!.)..T.|
+00000040  fc 52 99 f5 0f 1e d3 a5  f9 fe 64 d1 c0 30 00 00  |.R........d..0..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,23 +53,23 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  cd 0c 00 00 c9 03 00 17  41 04 f7 51 f2 ad 65 4f  |........A..Q..eO|
-000002d0  d9 df 8a 05 85 e9 6c d9  f9 14 51 e1 9a e0 11 80  |......l...Q.....|
-000002e0  73 8a 3f 43 01 6b a1 c9  92 5c 12 12 32 a1 e9 75  |s.?C.k...\..2..u|
-000002f0  d3 4f 0b b6 f9 b8 5b 4e  cc 71 8e cd 9c cc 7a 6e  |.O....[N.q....zn|
-00000300  0e 46 32 2d 84 6f 58 47  2f 24 04 01 00 80 08 0e  |.F2-.oXG/$......|
-00000310  2e 23 03 fe 7e 0f e1 3c  9b 37 d8 6b 86 6a 02 42  |.#..~..<.7.k.j.B|
-00000320  e7 c2 85 90 4f f9 22 b5  5b 98 9a 05 8c 7f 8f 83  |....O.".[.......|
-00000330  db a7 a2 98 18 d0 17 6b  14 17 39 fd 49 16 a9 f4  |.......k..9.I...|
-00000340  e0 5a f2 a1 1f 5a 6c ae  2b 0d 01 40 03 e8 75 c1  |.Z...Zl.+..@..u.|
-00000350  c6 f6 1b b2 c6 d3 ea 2d  f7 bb 94 ec a0 8c d1 26  |.......-.......&|
-00000360  52 22 d2 06 72 08 51 67  17 a2 ef 6d 75 a5 35 68  |R"..r.Qg...mu.5h|
-00000370  ab 2d 27 b2 f1 77 e7 87  9f 40 64 26 e0 bd 8c d6  |.-'..w...@d&....|
-00000380  f3 2d 9f 07 cd d0 6f 42  9f d8 85 55 2c 45 16 03  |.-....oB...U,E..|
-00000390  03 00 2e 0d 00 00 26 03  01 02 40 00 1e 06 01 06  |......&...@.....|
+000002c0  cd 0c 00 00 c9 03 00 17  41 04 af 8b 15 ee fc b2  |........A.......|
+000002d0  95 b3 38 67 05 c0 3f fd  a4 1e 25 e1 58 a2 35 27  |..8g..?...%.X.5'|
+000002e0  55 e1 05 01 8d 77 8b 77  b6 d8 23 1f 79 e8 66 cc  |U....w.w..#.y.f.|
+000002f0  e0 cd 01 1f 37 ab ad c6  dd ae 41 f9 2b 2d 77 b9  |....7.....A.+-w.|
+00000300  28 34 5d 27 5d 7a fe 32  86 e4 04 01 00 80 d0 ba  |(4]']z.2........|
+00000310  8b c2 67 5e 8f 83 8a 32  34 56 4d b7 83 4c 6a 85  |..g^...24VM..Lj.|
+00000320  44 24 e5 21 a6 f2 a2 f3  4e 59 bc 86 d9 ed d0 a6  |D$.!....NY......|
+00000330  ed 48 ac 3c c4 4b 0c c8  10 34 b0 1a 10 db 7c a6  |.H.<.K...4....|.|
+00000340  76 26 15 06 ee 01 22 2f  81 95 3b cd c6 3f fa 24  |v&...."/..;..?.$|
+00000350  59 f6 da 4b e1 7d 5e f0  f7 96 cc 67 73 74 c0 76  |Y..K.}^....gst.v|
+00000360  50 50 74 87 33 f2 92 66  8f 87 de 5b e2 a4 f8 c4  |PPt.3..f...[....|
+00000370  60 c5 ac a9 86 93 fc 81  73 d6 77 da c8 7a db 71  |`.......s.w..z.q|
+00000380  61 2c cf ea 23 85 89 70  f4 f4 5a c9 c9 bc 16 03  |a,..#..p..Z.....|
+00000390  03 00 2a 0d 00 00 26 03  01 02 40 00 1e 06 01 06  |..*...&...@.....|
 000003a0  02 06 03 05 01 05 02 05  03 04 01 04 02 04 03 03  |................|
-000003b0  01 03 02 03 03 02 01 02  02 02 03 00 00 0e 00 00  |................|
-000003c0  00                                                |.|
+000003b0  01 03 02 03 03 02 01 02  02 02 03 00 00 16 03 03  |................|
+000003c0  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
 00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
@@ -108,26 +108,26 @@
 00000220  67 fd a7 24 20 3e b2 56  1c ce 97 28 5e f8 2b 2d  |g..$ >.V...(^.+-|
 00000230  4f 9e f1 07 9f 6c 4b 5b  83 56 e2 32 42 e9 58 b6  |O....lK[.V.2B.X.|
 00000240  d7 49 a6 b5 68 1a 41 03  56 6b dc 5a 89 16 03 03  |.I..h.A.Vk.Z....|
-00000250  00 88 0f 00 00 84 05 01  00 80 b5 63 8c 65 5c ff  |...........c.e\.|
-00000260  3a 36 74 2a d4 d4 4c 02  1a 11 9e e7 84 78 46 96  |:6t*..L......xF.|
-00000270  e9 b3 f8 ab 8a 27 ca 0c  de d4 83 a7 21 8f ab c2  |.....'......!...|
-00000280  ac bc c4 73 33 e6 b2 97  3f 35 02 93 ad a0 6d a1  |...s3...?5....m.|
-00000290  67 b3 ac aa a3 9d 24 29  01 af a9 e1 00 f6 66 c4  |g.....$)......f.|
-000002a0  8f 48 fc 68 d3 cd 18 63  9e f6 e1 e0 02 56 cc c5  |.H.h...c.....V..|
-000002b0  01 98 65 5d 41 f2 74 f7  00 42 af 26 45 2a 28 9f  |..e]A.t..B.&E*(.|
-000002c0  1c a6 49 66 d5 ea cb 2d  5b f7 e2 91 b6 f7 65 98  |..If...-[.....e.|
-000002d0  e2 2f 69 51 6b df 3d 45  b9 f1 14 03 03 00 01 01  |./iQk.=E........|
-000002e0  16 03 03 00 28 00 00 00  00 00 00 00 00 65 8f e7  |....(........e..|
-000002f0  e0 92 d7 90 38 81 fc 93  2d 8a 56 23 c9 90 cc f1  |....8...-.V#....|
-00000300  10 e7 e9 8e cc 59 64 a2  93 69 65 38 b1           |.....Yd..ie8.|
+00000250  00 88 0f 00 00 84 05 01  00 80 2d 1c c8 23 f4 9e  |..........-..#..|
+00000260  ff fe 30 db 7d 25 41 74  5b 3b e1 f7 c3 92 eb 12  |..0.}%At[;......|
+00000270  46 0d f3 3b 4f ff 9c ed  d6 f5 4e 3f 58 ad ba 02  |F..;O.....N?X...|
+00000280  0b 44 66 94 78 83 a0 ee  0f 05 ec fd f7 4d 97 52  |.Df.x........M.R|
+00000290  6c ca 54 28 3c e2 77 92  d5 a3 0d 67 93 cf a9 4c  |l.T(<.w....g...L|
+000002a0  c6 03 4a c9 cd 22 bb d5  5b 8c 85 60 72 ef f3 2a  |..J.."..[..`r..*|
+000002b0  ef 6e 74 77 98 6e 19 c0  f0 d4 fa bf ab 36 90 30  |.ntw.n.......6.0|
+000002c0  16 63 6b af 74 e4 94 46  6d eb b0 5e fa ff e8 73  |.ck.t..Fm..^...s|
+000002d0  05 3f f8 bb f3 be 74 d0  d4 4a 14 03 03 00 01 01  |.?....t..J......|
+000002e0  16 03 03 00 28 00 00 00  00 00 00 00 00 02 e2 55  |....(..........U|
+000002f0  ab d8 a2 bf 4f 5f 9a 66  ee 0a 94 79 7c 63 04 c0  |....O_.f...y|c..|
+00000300  d6 57 c2 c1 d3 0f 0a d5  1e 7d 23 fa 25           |.W.......}#.%|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 f7 b7 8e 00 9e  |..........(.....|
-00000010  d6 c6 06 23 ad 91 c6 48  84 e6 ee ce 1e ec 2f e0  |...#...H....../.|
-00000020  b9 0b 8b 3c 4a 65 1a 9d  86 73 1c 2a ee a6 6e 09  |...<Je...s.*..n.|
-00000030  98 7f 1a                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 28 17 86 07 f3 42  |..........(....B|
+00000010  10 db 93 d3 46 35 51 1d  7d 20 ec fa 37 c7 25 15  |....F5Q.} ..7.%.|
+00000020  e1 99 46 a0 2f a1 b8 4a  36 af 1d aa d3 ba 70 a2  |..F./..J6.....p.|
+00000030  4e bc 8b                                          |N..|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 ca f7 d5  |................|
-00000010  b0 c0 2d 8d 95 c6 9e 1c  ca 74 17 d5 47 16 53 16  |..-......t..G.S.|
-00000020  7d 19 85 15 03 03 00 1a  00 00 00 00 00 00 00 02  |}...............|
-00000030  cf f6 67 3a 65 15 d6 b0  e2 5a b9 71 cc 19 cd fa  |..g:e....Z.q....|
-00000040  3c af                                             |<.|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 ba 98 6c  |...............l|
+00000010  77 50 2f f1 8c 09 ed 9f  74 cb bc 4a e4 57 5e b5  |wP/.....t..J.W^.|
+00000020  93 16 42 15 03 03 00 1a  00 00 00 00 00 00 00 02  |..B.............|
+00000030  ee 1b 6a 8a 33 31 f2 4b  64 f8 1d 0e a5 7d c4 43  |..j.31.Kd....}.C|
+00000040  be 3e                                             |.>|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA
index dc325fc927..2a39bc5221 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA
@@ -9,11 +9,11 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 1f be bf a9 e9  |....Y...U.......|
-00000010  1f 9e 3c 62 61 f4 0b b4  7e 08 85 e7 20 0a 1f c2  |..<ba...~... ...|
-00000020  50 e0 7d 3e 87 83 2e f6  b5 3b 01 20 a3 ae 72 07  |P.}>.....;. ..r.|
-00000030  49 15 58 81 fe d4 5c b9  df 88 68 d0 54 3c ae bd  |I.X...\...h.T<..|
-00000040  19 5b ae 30 d2 53 56 67  ef 05 71 69 c0 09 00 00  |.[.0.SVg..qi....|
+00000000  16 03 03 00 59 02 00 00  55 03 03 e7 ed 8d 74 39  |....Y...U.....t9|
+00000010  b5 4e 79 35 85 b5 46 22  fc 7f 2d 2a 28 f3 98 db  |.Ny5..F"..-*(...|
+00000020  69 76 44 b2 0b ac df 25  1c 59 da 20 0c dd a5 75  |ivD....%.Y. ...u|
+00000030  50 94 02 87 20 42 1e c8  42 55 32 d7 e3 6b 00 e9  |P... B..BU2..k..|
+00000040  b4 57 ff ad 5b 9d e5 4e  f8 8b 37 d4 c0 09 00 00  |.W..[..N..7.....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,23 +48,24 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 d7 0c 00  00 d3 03 00 17 41 04 85  |*............A..|
-00000280  5d 2e 2a 16 9e b3 a4 69  17 f5 13 ce 32 8f 67 37  |].*....i....2.g7|
-00000290  74 ab cf e2 69 80 fb 71  15 08 df f4 18 f3 76 36  |t...i..q......v6|
-000002a0  1a 06 aa 6e 3d de c0 71  05 65 6f 4b 05 86 93 fe  |...n=..q.eoK....|
-000002b0  34 82 59 77 2f 5b c6 4c  63 8b 6f 7f 60 d6 ba 04  |4.Yw/[.Lc.o.`...|
-000002c0  03 00 8a 30 81 87 02 42  01 37 25 e6 ad 0a 35 db  |...0...B.7%...5.|
-000002d0  e6 76 90 15 ed 10 66 7f  19 9d e5 59 31 89 d7 be  |.v....f....Y1...|
-000002e0  b2 e2 18 f2 42 30 98 86  2f ef 23 a4 70 79 51 97  |....B0../.#.pyQ.|
-000002f0  98 ac 6e 31 4e e8 e4 b3  d8 22 cc 32 46 1d e1 d2  |..n1N....".2F...|
-00000300  77 cb dd b5 c6 03 b6 52  ac 66 02 41 37 c2 d8 75  |w......R.f.A7..u|
-00000310  75 18 22 97 03 67 86 04  18 e4 29 96 ba 29 92 85  |u."..g....)..)..|
-00000320  a0 55 72 12 f4 bb 70 b5  3a 62 2d 0c f6 cf 92 15  |.Ur...p.:b-.....|
-00000330  4f 31 11 75 f9 81 b6 a3  ff dc 9c e3 be 26 8c 2f  |O1.u.........&./|
-00000340  fc 5d ef e2 b9 e5 0e 93  eb 95 f6 5f 22 16 03 03  |.]........._"...|
-00000350  00 2e 0d 00 00 26 03 01  02 40 00 1e 06 01 06 02  |.....&...@......|
+00000270  2a 16 03 03 00 d7 0c 00  00 d3 03 00 17 41 04 31  |*............A.1|
+00000280  a3 27 68 39 f0 49 74 4b  bf a9 65 19 0b 33 41 96  |.'h9.ItK..e..3A.|
+00000290  b3 41 d9 61 d5 b1 8a b6  2d d3 46 32 63 a6 13 19  |.A.a....-.F2c...|
+000002a0  25 04 78 85 62 73 2a 94  32 9d 75 bd f2 f8 44 d7  |%.x.bs*.2.u...D.|
+000002b0  f1 f2 dd ce ca 97 b6 6e  10 79 a6 cd 4a f0 73 04  |.......n.y..J.s.|
+000002c0  03 00 8a 30 81 87 02 42  00 e4 2b 1c c4 56 74 bd  |...0...B..+..Vt.|
+000002d0  fb 41 8a c7 f0 6a 17 c1  8a 1c 0e 48 6f 65 1f d9  |.A...j.....Hoe..|
+000002e0  cd a6 9c ed f2 25 45 d3  eb 75 74 c0 0f 38 3d e7  |.....%E..ut..8=.|
+000002f0  63 fe 46 95 27 78 c8 d1  b0 82 5e 9f ac 3e f1 9b  |c.F.'x....^..>..|
+00000300  37 b6 5c dc e1 3b 63 6c  54 b7 02 41 5c e8 d5 4c  |7.\..;clT..A\..L|
+00000310  bc 65 e5 57 c1 f8 f4 d0  2f 8d 63 76 3c 87 e6 a5  |.e.W..../.cv<...|
+00000320  3e 10 ca 4a 9f 87 19 e0  48 9f 0c a2 e7 b1 16 b6  |>..J....H.......|
+00000330  a9 f8 4c c1 fc a8 29 75  11 d2 de 7a d9 70 8e 3a  |..L...)u...z.p.:|
+00000340  6e 29 5c f6 9c 86 1e 73  d0 2e 4b 1f f2 16 03 03  |n)\....s..K.....|
+00000350  00 2a 0d 00 00 26 03 01  02 40 00 1e 06 01 06 02  |.*...&...@......|
 00000360  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
-00000370  03 02 03 03 02 01 02 02  02 03 00 00 0e 00 00 00  |................|
+00000370  03 02 03 03 02 01 02 02  02 03 00 00 16 03 03 00  |................|
+00000380  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
 00000000  16 03 03 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
 00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
@@ -103,31 +104,31 @@
 00000220  67 fd a7 24 20 3e b2 56  1c ce 97 28 5e f8 2b 2d  |g..$ >.V...(^.+-|
 00000230  4f 9e f1 07 9f 6c 4b 5b  83 56 e2 32 42 e9 58 b6  |O....lK[.V.2B.X.|
 00000240  d7 49 a6 b5 68 1a 41 03  56 6b dc 5a 89 16 03 03  |.I..h.A.Vk.Z....|
-00000250  00 88 0f 00 00 84 05 01  00 80 5e 85 82 65 fe 5d  |..........^..e.]|
-00000260  e7 61 47 f0 64 2e 7a 35  0d 7b 8b bd ce 39 56 ee  |.aG.d.z5.{...9V.|
-00000270  f0 1d 1c 0c 40 6c ed 06  69 b1 29 71 20 36 ca 79  |....@l..i.)q 6.y|
-00000280  ca b2 74 92 f3 fc c6 b7  f9 5f d0 22 dc 17 d1 25  |..t......_."...%|
-00000290  4a c2 9f 9d 62 92 1b e3  34 8c 1e f8 85 8a 3b 58  |J...b...4.....;X|
-000002a0  f0 0a a0 31 05 a0 a7 a1  44 a6 8b 9b d9 72 38 16  |...1....D....r8.|
-000002b0  33 c1 66 f2 6a 0c 9c 65  8b 1a 09 91 9b 72 ad 4d  |3.f.j..e.....r.M|
-000002c0  98 37 a7 54 54 f2 0c 7b  95 92 5d 11 94 59 6c 29  |.7.TT..{..]..Yl)|
-000002d0  e7 4e 5e 46 69 35 43 b8  16 02 14 03 03 00 01 01  |.N^Fi5C.........|
+00000250  00 88 0f 00 00 84 05 01  00 80 4d 6a 6e 18 c9 95  |..........Mjn...|
+00000260  1a d0 42 4a 56 3f 82 40  d9 66 63 cb 78 9a d0 dd  |..BJV?.@.fc.x...|
+00000270  55 71 b5 be 40 bc 83 d5  73 0c 91 aa ad 3b c4 0f  |Uq..@...s....;..|
+00000280  d8 db ba 8c 06 8c 71 e0  a5 32 67 be 32 c6 b1 91  |......q..2g.2...|
+00000290  3d e8 d8 fe 42 64 c4 83  83 52 fd 95 d4 87 e6 a0  |=...Bd...R......|
+000002a0  e8 a3 1f 5b 4a 79 95 65  bf 53 92 87 d5 26 6b 09  |...[Jy.e.S...&k.|
+000002b0  7c 2f 74 e7 af dc 01 3b  ad 8e 52 84 ac a0 47 c7  ||/t....;..R...G.|
+000002c0  ad 37 7c 62 5a ae 8e de  f9 14 86 fc 5c 4c b3 7e  |.7|bZ.......\L.~|
+000002d0  35 d8 f4 e4 ab 33 b6 ca  6a 0f 14 03 03 00 01 01  |5....3..j.......|
 000002e0  16 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-000002f0  00 00 00 00 00 a9 87 01  27 8d 4b 5b b9 13 17 50  |........'.K[...P|
-00000300  62 f3 16 e3 84 3e 38 3e  dc fe 7d 1d de a7 29 73  |b....>8>..}...)s|
-00000310  3e dc e8 03 65 c9 08 96  50 05 df 15 5f 1f bb f0  |>...e...P..._...|
-00000320  77 cf a2 9e e8                                    |w....|
+000002f0  00 00 00 00 00 10 2d 03  5b 66 40 d5 41 e2 05 e4  |......-.[f@.A...|
+00000300  ad a7 8c 69 21 90 9e 48  07 ad df 55 9e 85 6e 33  |...i!..H...U..n3|
+00000310  d6 e5 2e 95 12 6c 68 ce  c8 27 1e ca fc 91 64 ef  |.....lh..'....d.|
+00000320  67 40 87 8c 2f                                    |g@../|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 04 00 1e 59 5c  |..........@...Y\|
-00000010  df 15 6d 6a 44 99 3d b5  28 f2 86 7c 93 a3 20 ec  |..mjD.=.(..|.. .|
-00000020  fc 1c 7c 16 9c 33 fb a5  20 f7 2f 76 81 6d 75 e6  |..|..3.. ./v.mu.|
-00000030  4b 60 5b 9c 8b 6e a7 33  a6 7f ff c5 8b 2e c3 30  |K`[..n.3.......0|
-00000040  a6 60 91 f7 41 b2 5f de  14 b7 01                 |.`..A._....|
+00000000  14 03 03 00 01 01 16 03  03 00 40 f1 77 7c 5e e9  |..........@.w|^.|
+00000010  68 2b 4c 80 0a 14 97 b2  30 69 e5 be e2 e8 46 bb  |h+L.....0i....F.|
+00000020  05 02 47 d9 df b9 a7 e4  0d d6 48 e3 6d cd da 30  |..G.......H.m..0|
+00000030  c7 be f0 1d ad c7 33 50  88 f5 83 90 f5 8d d3 91  |......3P........|
+00000040  a4 55 57 f8 f9 30 e4 df  98 a4 47                 |.UW..0....G|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 99 b2 5a  3e aa 44 e9 44 47 46 34  |.......Z>.D.DGF4|
-00000020  a4 b1 d3 48 9a 76 5f e8  d1 fc a4 08 37 d7 9e ab  |...H.v_.....7...|
-00000030  2b c9 a7 b5 db 15 03 03  00 30 00 00 00 00 00 00  |+........0......|
-00000040  00 00 00 00 00 00 00 00  00 00 db a8 98 c2 93 75  |...............u|
-00000050  1e 0c b0 2c b0 10 31 9b  cd 5a 4a f6 ad 65 64 a9  |...,..1..ZJ..ed.|
-00000060  fd 1d 7f ad 2e 57 d8 6d  4e 56                    |.....W.mNV|
+00000010  00 00 00 00 00 02 aa 83  b3 3b fd b1 d5 4a e3 78  |.........;...J.x|
+00000020  cb b5 d4 4f b9 69 12 da  c7 fa bc 7d 8e 8c d2 c7  |...O.i.....}....|
+00000030  c4 d1 5f 7b 8d 15 03 03  00 30 00 00 00 00 00 00  |.._{.....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 c3 1e c6 f6 f6 f6  |................|
+00000050  f9 c6 a5 34 5f c6 ee 92  a5 3c 7a 1e 51 ef ca 72  |...4_....<z.Q..r|
+00000060  04 e5 1b cb f4 a7 f7 10  64 f0                    |........d.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA
index d49bd8d36e..67cc2e2ba7 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA
@@ -9,53 +9,67 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 51 02 00 00  4d 03 03 02 3f fc 95 c8  |....Q...M...?...|
-00000010  be 73 36 64 bd 28 09 c0  d2 f5 7f 1c a1 77 0d 88  |.s6d.(.......w..|
-00000020  04 2a 53 4c 1e ac 4b cc  f7 ad d1 20 e7 9e a6 08  |.*SL..K.... ....|
-00000030  de d5 9f 4c 02 73 f7 a2  2b b9 b7 64 6d 8a 9f 9d  |...L.s..+..dm...|
-00000040  e0 92 b8 9a dc b8 96 f8  aa 0d 63 23 00 05 00 00  |..........c#....|
-00000050  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
-00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
-00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
-00000080  09 2a 86 48 86 f7 0d 01  01 0b 05 00 30 1f 31 0b  |.*.H........0.1.|
-00000090  30 09 06 03 55 04 0a 13  02 47 6f 31 10 30 0e 06  |0...U....Go1.0..|
-000000a0  03 55 04 03 13 07 47 6f  20 52 6f 6f 74 30 1e 17  |.U....Go Root0..|
-000000b0  0d 31 36 30 31 30 31 30  30 30 30 30 30 5a 17 0d  |.160101000000Z..|
-000000c0  32 35 30 31 30 31 30 30  30 30 30 30 5a 30 1a 31  |250101000000Z0.1|
-000000d0  0b 30 09 06 03 55 04 0a  13 02 47 6f 31 0b 30 09  |.0...U....Go1.0.|
-000000e0  06 03 55 04 03 13 02 47  6f 30 81 9f 30 0d 06 09  |..U....Go0..0...|
-000000f0  2a 86 48 86 f7 0d 01 01  01 05 00 03 81 8d 00 30  |*.H............0|
-00000100  81 89 02 81 81 00 db 46  7d 93 2e 12 27 06 48 bc  |.......F}...'.H.|
-00000110  06 28 21 ab 7e c4 b6 a2  5d fe 1e 52 45 88 7a 36  |.(!.~...]..RE.z6|
-00000120  47 a5 08 0d 92 42 5b c2  81 c0 be 97 79 98 40 fb  |G....B[.....y.@.|
-00000130  4f 6d 14 fd 2b 13 8b c2  a5 2e 67 d8 d4 09 9e d6  |Om..+.....g.....|
-00000140  22 38 b7 4a 0b 74 73 2b  c2 34 f1 d1 93 e5 96 d9  |"8.J.ts+.4......|
-00000150  74 7b f3 58 9f 6c 61 3c  c0 b0 41 d4 d9 2b 2b 24  |t{.X.la<..A..++$|
-00000160  23 77 5b 1c 3b bd 75 5d  ce 20 54 cf a1 63 87 1d  |#w[.;.u]. T..c..|
-00000170  1e 24 c4 f3 1d 1a 50 8b  aa b6 14 43 ed 97 a7 75  |.$....P....C...u|
-00000180  62 f4 14 c8 52 d7 02 03  01 00 01 a3 81 93 30 81  |b...R.........0.|
-00000190  90 30 0e 06 03 55 1d 0f  01 01 ff 04 04 03 02 05  |.0...U..........|
-000001a0  a0 30 1d 06 03 55 1d 25  04 16 30 14 06 08 2b 06  |.0...U.%..0...+.|
-000001b0  01 05 05 07 03 01 06 08  2b 06 01 05 05 07 03 02  |........+.......|
-000001c0  30 0c 06 03 55 1d 13 01  01 ff 04 02 30 00 30 19  |0...U.......0.0.|
-000001d0  06 03 55 1d 0e 04 12 04  10 9f 91 16 1f 43 43 3e  |..U..........CC>|
-000001e0  49 a6 de 6d b6 80 d7 9f  60 30 1b 06 03 55 1d 23  |I..m....`0...U.#|
-000001f0  04 14 30 12 80 10 48 13  49 4d 13 7e 16 31 bb a3  |..0...H.IM.~.1..|
-00000200  01 d5 ac ab 6e 7b 30 19  06 03 55 1d 11 04 12 30  |....n{0...U....0|
-00000210  10 82 0e 65 78 61 6d 70  6c 65 2e 67 6f 6c 61 6e  |...example.golan|
-00000220  67 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |g0...*.H........|
-00000230  03 81 81 00 9d 30 cc 40  2b 5b 50 a0 61 cb ba e5  |.....0.@+[P.a...|
-00000240  53 58 e1 ed 83 28 a9 58  1a a9 38 a4 95 a1 ac 31  |SX...(.X..8....1|
-00000250  5a 1a 84 66 3d 43 d3 2d  d9 0b f2 97 df d3 20 64  |Z..f=C.-...... d|
-00000260  38 92 24 3a 00 bc cf 9c  7d b7 40 20 01 5f aa d3  |8.$:....}.@ ._..|
-00000270  16 61 09 a2 76 fd 13 c3  cc e1 0c 5c ee b1 87 82  |.a..v......\....|
-00000280  f1 6c 04 ed 73 bb b3 43  77 8d 0c 1c f1 0f a1 d8  |.l..s..Cw.......|
-00000290  40 83 61 c9 4c 72 2b 9d  ae db 46 06 06 4d f4 c1  |@.a.Lr+...F..M..|
-000002a0  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
-000002b0  3b e9 fa e7 16 03 03 00  2e 0d 00 00 26 03 01 02  |;...........&...|
-000002c0  40 00 1e 06 01 06 02 06  03 05 01 05 02 05 03 04  |@...............|
-000002d0  01 04 02 04 03 03 01 03  02 03 03 02 01 02 02 02  |................|
-000002e0  03 00 00 0e 00 00 00                              |.......|
+00000000  16 03 03 00 59 02 00 00  55 03 03 cc 6d d6 f4 ad  |....Y...U...m...|
+00000010  da e3 e3 4d 06 1c 2d 3b  cc 52 82 4b a2 2f 18 c3  |...M..-;.R.K./..|
+00000020  a8 c9 ba b0 ca 93 87 ad  bc 4e 55 20 cb 8d 51 98  |.........NU ..Q.|
+00000030  35 01 2e 3c 2c 1e 36 20  82 18 f4 e1 08 1e 08 af  |5..<,.6 ........|
+00000040  22 f3 df 45 d2 c9 0d 81  57 c8 12 2f c0 2f 00 00  |"..E....W.././..|
+00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
+00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
+00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
+00000080  3f e2 5b ea a6 30 0d 06  09 2a 86 48 86 f7 0d 01  |?.[..0...*.H....|
+00000090  01 0b 05 00 30 1f 31 0b  30 09 06 03 55 04 0a 13  |....0.1.0...U...|
+000000a0  02 47 6f 31 10 30 0e 06  03 55 04 03 13 07 47 6f  |.Go1.0...U....Go|
+000000b0  20 52 6f 6f 74 30 1e 17  0d 31 36 30 31 30 31 30  | Root0...1601010|
+000000c0  30 30 30 30 30 5a 17 0d  32 35 30 31 30 31 30 30  |00000Z..25010100|
+000000d0  30 30 30 30 5a 30 1a 31  0b 30 09 06 03 55 04 0a  |0000Z0.1.0...U..|
+000000e0  13 02 47 6f 31 0b 30 09  06 03 55 04 03 13 02 47  |..Go1.0...U....G|
+000000f0  6f 30 81 9f 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |o0..0...*.H.....|
+00000100  01 05 00 03 81 8d 00 30  81 89 02 81 81 00 db 46  |.......0.......F|
+00000110  7d 93 2e 12 27 06 48 bc  06 28 21 ab 7e c4 b6 a2  |}...'.H..(!.~...|
+00000120  5d fe 1e 52 45 88 7a 36  47 a5 08 0d 92 42 5b c2  |]..RE.z6G....B[.|
+00000130  81 c0 be 97 79 98 40 fb  4f 6d 14 fd 2b 13 8b c2  |....y.@.Om..+...|
+00000140  a5 2e 67 d8 d4 09 9e d6  22 38 b7 4a 0b 74 73 2b  |..g....."8.J.ts+|
+00000150  c2 34 f1 d1 93 e5 96 d9  74 7b f3 58 9f 6c 61 3c  |.4......t{.X.la<|
+00000160  c0 b0 41 d4 d9 2b 2b 24  23 77 5b 1c 3b bd 75 5d  |..A..++$#w[.;.u]|
+00000170  ce 20 54 cf a1 63 87 1d  1e 24 c4 f3 1d 1a 50 8b  |. T..c...$....P.|
+00000180  aa b6 14 43 ed 97 a7 75  62 f4 14 c8 52 d7 02 03  |...C...ub...R...|
+00000190  01 00 01 a3 81 93 30 81  90 30 0e 06 03 55 1d 0f  |......0..0...U..|
+000001a0  01 01 ff 04 04 03 02 05  a0 30 1d 06 03 55 1d 25  |.........0...U.%|
+000001b0  04 16 30 14 06 08 2b 06  01 05 05 07 03 01 06 08  |..0...+.........|
+000001c0  2b 06 01 05 05 07 03 02  30 0c 06 03 55 1d 13 01  |+.......0...U...|
+000001d0  01 ff 04 02 30 00 30 19  06 03 55 1d 0e 04 12 04  |....0.0...U.....|
+000001e0  10 9f 91 16 1f 43 43 3e  49 a6 de 6d b6 80 d7 9f  |.....CC>I..m....|
+000001f0  60 30 1b 06 03 55 1d 23  04 14 30 12 80 10 48 13  |`0...U.#..0...H.|
+00000200  49 4d 13 7e 16 31 bb a3  01 d5 ac ab 6e 7b 30 19  |IM.~.1......n{0.|
+00000210  06 03 55 1d 11 04 12 30  10 82 0e 65 78 61 6d 70  |..U....0...examp|
+00000220  6c 65 2e 67 6f 6c 61 6e  67 30 0d 06 09 2a 86 48  |le.golang0...*.H|
+00000230  86 f7 0d 01 01 0b 05 00  03 81 81 00 9d 30 cc 40  |.............0.@|
+00000240  2b 5b 50 a0 61 cb ba e5  53 58 e1 ed 83 28 a9 58  |+[P.a...SX...(.X|
+00000250  1a a9 38 a4 95 a1 ac 31  5a 1a 84 66 3d 43 d3 2d  |..8....1Z..f=C.-|
+00000260  d9 0b f2 97 df d3 20 64  38 92 24 3a 00 bc cf 9c  |...... d8.$:....|
+00000270  7d b7 40 20 01 5f aa d3  16 61 09 a2 76 fd 13 c3  |}.@ ._...a..v...|
+00000280  cc e1 0c 5c ee b1 87 82  f1 6c 04 ed 73 bb b3 43  |...\.....l..s..C|
+00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
+000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
+000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
+000002c0  cd 0c 00 00 c9 03 00 17  41 04 2a 05 cf 47 ee 3d  |........A.*..G.=|
+000002d0  d5 25 3e 5f f1 ea 99 b1  82 cd 4f af 1f 19 07 bb  |.%>_......O.....|
+000002e0  56 84 c2 9e 68 5b 49 b3  f6 a0 33 fe 4b c4 fa 00  |V...h[I...3.K...|
+000002f0  32 6e 04 d9 16 4a 83 6a  82 86 94 06 e0 53 c0 a9  |2n...J.j.....S..|
+00000300  3c 99 72 7f b7 11 5c b4  97 8f 04 01 00 80 ce b7  |<.r...\.........|
+00000310  71 2e f2 82 4a d0 f8 1c  4d 14 68 da e3 90 30 dd  |q...J...M.h...0.|
+00000320  9b 87 ae be ad e4 7a 57  cd ea 0f 11 a2 e3 1a dd  |......zW........|
+00000330  71 da ec 0f 4b 0f a3 90  05 c5 0f 25 92 a8 ef 25  |q...K......%...%|
+00000340  03 98 57 97 ed 5e 82 b1  ce d5 26 65 b1 cd dd 87  |..W..^....&e....|
+00000350  8a 19 b3 aa 22 17 de e7  55 4f 0e cb 99 8f ca 8a  |...."...UO......|
+00000360  d9 9f f6 eb 6a f5 76 e0  f8 15 54 21 f1 58 6b b1  |....j.v...T!.Xk.|
+00000370  7c f1 15 cc 4b 12 84 be  8a 38 d2 62 ee fe 83 6c  ||...K....8.b...l|
+00000380  f0 14 d5 76 8d 4a b1 cf  65 8a dc af d5 c4 16 03  |...v.J..e.......|
+00000390  03 00 2a 0d 00 00 26 03  01 02 40 00 1e 06 01 06  |..*...&...@.....|
+000003a0  02 06 03 05 01 05 02 05  03 04 01 04 02 04 03 03  |................|
+000003b0  01 03 02 03 03 02 01 02  02 02 03 00 00 16 03 03  |................|
+000003c0  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
 00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
@@ -89,33 +103,31 @@
 000001d0  ac 11 b1 28 56 be 1d cd  61 62 84 09 bf d6 80 c6  |...(V...ab......|
 000001e0  45 8d 82 2c b4 d8 83 9b  db c9 22 b7 2a 12 11 7b  |E..,......".*..{|
 000001f0  fa 02 3b c1 c9 ff ea c9  9d a8 49 d3 95 d7 d5 0e  |..;.......I.....|
-00000200  e5 35 16 03 03 00 86 10  00 00 82 00 80 b9 65 8d  |.5............e.|
-00000210  bf a7 c8 4b 79 ce 6f cb  8b 13 1c ac b9 7d 66 5e  |...Ky.o......}f^|
-00000220  e9 ba 1d 71 4e a9 e9 34  ae f6 64 65 90 3b d8 16  |...qN..4..de.;..|
-00000230  52 a2 6f f4 cb 8a 13 74  a2 ee b7 27 69 b4 41 c0  |R.o....t...'i.A.|
-00000240  90 68 bc 02 69 e1 c6 48  4f 39 36 30 25 ca 4c 17  |.h..i..HO960%.L.|
-00000250  ce 83 9e 08 56 e3 05 49  93 9e 2e c4 fb e6 c8 01  |....V..I........|
-00000260  f1 0f c5 70 0f 08 83 48  e9 48 ef 6e 50 8b 05 7e  |...p...H.H.nP..~|
-00000270  e5 84 25 fa 55 c7 ae 31  02 27 00 ef 3f 98 86 20  |..%.U..1.'..?.. |
-00000280  12 89 91 59 28 b4 f7 d7  af d2 69 61 35 16 03 03  |...Y(.....ia5...|
-00000290  00 88 0f 00 00 84 05 01  00 80 86 56 71 68 09 a7  |...........Vqh..|
-000002a0  bc a6 f1 bd fa d5 e8 7d  f5 8f 4b 8a dd 19 9a 88  |.......}..K.....|
-000002b0  6f 4e 5d c1 a5 3c 03 b7  4d f4 30 74 ec b7 82 d9  |oN]..<..M.0t....|
-000002c0  b9 8a aa 2e b9 39 ab db  dc c9 c2 76 d7 fc 67 d8  |.....9.....v..g.|
-000002d0  3c 87 1c 53 f8 d0 28 b1  37 c4 49 c3 6d 73 b9 cc  |<..S..(.7.I.ms..|
-000002e0  81 2e 1b 22 05 5e 71 35  23 b9 94 c7 6a 80 a2 b6  |...".^q5#...j...|
-000002f0  8a eb f4 0e 51 e6 ff ac  ea eb 0c d8 e8 be 45 ab  |....Q.........E.|
-00000300  4f 0f 47 f1 d2 f4 70 ae  a3 16 79 26 82 32 af 7c  |O.G...p...y&.2.||
-00000310  8b 62 5e 15 b6 ab 07 74  6b 3d 14 03 03 00 01 01  |.b^....tk=......|
-00000320  16 03 03 00 24 6b 24 59  3c f0 3d 41 31 45 04 55  |....$k$Y<.=A1E.U|
-00000330  5f 26 14 dd a9 7a 29 02  c1 4a dd 65 84 4e a9 05  |_&...z)..J.e.N..|
-00000340  37 79 b1 ca 50 8e c6 df  6d                       |7y..P...m|
+00000200  e5 35 16 03 03 00 46 10  00 00 42 41 04 1e 18 37  |.5....F...BA...7|
+00000210  ef 0d 19 51 88 35 75 71  b5 e5 54 5b 12 2e 8f 09  |...Q.5uq..T[....|
+00000220  67 fd a7 24 20 3e b2 56  1c ce 97 28 5e f8 2b 2d  |g..$ >.V...(^.+-|
+00000230  4f 9e f1 07 9f 6c 4b 5b  83 56 e2 32 42 e9 58 b6  |O....lK[.V.2B.X.|
+00000240  d7 49 a6 b5 68 1a 41 03  56 6b dc 5a 89 16 03 03  |.I..h.A.Vk.Z....|
+00000250  00 88 0f 00 00 84 05 01  00 80 28 75 56 c7 d3 be  |..........(uV...|
+00000260  c0 45 b3 9e 08 1a 61 fa  f7 e9 2d 33 7b 3f 7a db  |.E....a...-3{?z.|
+00000270  7d 8e 34 8e 34 69 1b 41  80 4f bd b8 18 9e 35 91  |}.4.4i.A.O....5.|
+00000280  4c 48 26 8c 0b f0 9a b3  85 cd 32 04 90 45 eb 27  |LH&.......2..E.'|
+00000290  ed c9 c7 78 8b 27 12 25  6a 1c 1b 70 37 ce 27 fd  |...x.'.%j..p7.'.|
+000002a0  fd da 54 db 98 f9 05 65  de a8 41 e7 12 07 84 7d  |..T....e..A....}|
+000002b0  96 4b 59 71 5e e1 58 1f  88 87 4e d8 43 c2 9d bf  |.KYq^.X...N.C...|
+000002c0  a0 e2 eb d3 67 79 c5 c0  d8 a2 bb 50 13 3d 6b bf  |....gy.....P.=k.|
+000002d0  99 8a f6 a8 91 1f 8d 74  49 35 14 03 03 00 01 01  |.......tI5......|
+000002e0  16 03 03 00 28 00 00 00  00 00 00 00 00 bb 51 07  |....(.........Q.|
+000002f0  ab b3 89 a0 04 91 ee c0  43 96 00 50 2d 5f b8 4d  |........C..P-_.M|
+00000300  f3 d8 e1 44 ec b3 37 0e  a9 b9 2f cd 2e           |...D..7.../..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 24 ff c7 8f 75 44  |..........$...uD|
-00000010  f7 4c 9b 80 c1 c0 59 83  8c c8 fe 7b 21 86 83 d1  |.L....Y....{!...|
-00000020  09 08 48 b0 e9 f0 fe 2f  58 86 25 64 d3 3a a2     |..H..../X.%d.:.|
+00000000  14 03 03 00 01 01 16 03  03 00 28 df 01 78 2e ef  |..........(..x..|
+00000010  b5 6d ea c6 2d fa 23 b9  3f db e9 c1 27 0f 90 1f  |.m..-.#.?...'...|
+00000020  1e a0 b0 6e ab aa 1c ab  4e de 7f 18 82 b1 45 b9  |...n....N.....E.|
+00000030  c9 a6 e1                                          |...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1a 31 4f 85  6d 9e 52 7d 90 67 4f 2c  |.....1O.m.R}.gO,|
-00000010  f1 dc 5e 6b 5d b9 f1 90  2b c1 61 38 5a 45 ed 15  |..^k]...+.a8ZE..|
-00000020  03 03 00 16 3b 54 3d ac  60 28 4b ca 09 f4 44 70  |....;T=.`(K...Dp|
-00000030  a9 0a 73 e4 c1 39 b6 77  57 17                    |..s..9.wW.|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 02 12 eb  |................|
+00000010  61 0e 5e 44 5b d0 3c 78  42 ae 47 31 5a 98 9a a3  |a.^D[.<xB.G1Z...|
+00000020  0a 96 1b 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
+00000030  a4 b2 43 e3 bc 24 ca 03  b8 7e ce 42 b9 6a 1f 91  |..C..$...~.B.j..|
+00000040  5e f2                                             |^.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES
index f07c99196e..b9f2be6d6a 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES
@@ -9,11 +9,11 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 41 1d e9 05 25  |....Y...U..A...%|
-00000010  04 59 e0 1d 29 92 e9 8c  b2 c1 ef 7c 07 54 ec e1  |.Y..)......|.T..|
-00000020  a0 03 e6 65 1d ca 7d 67  db 6a 92 20 06 fe fa 87  |...e..}g.j. ....|
-00000030  61 18 62 83 12 c5 f6 b8  7b a9 df 1d a9 e8 2c 74  |a.b.....{.....,t|
-00000040  36 6c f1 4b b6 b7 89 4c  43 e5 96 d6 c0 09 00 00  |6l.K...LC.......|
+00000000  16 03 03 00 59 02 00 00  55 03 03 d1 a1 83 db e7  |....Y...U.......|
+00000010  27 f7 0f 1b 97 54 17 5a  c4 54 db 13 7e c3 ab c5  |'....T.Z.T..~...|
+00000020  cc 0d 79 79 2d a8 01 db  e1 cc d9 20 3a b3 dc 1a  |..yy-...... :...|
+00000030  4f 6a 33 53 1e 40 78 28  4a c6 86 8c 76 df d9 2f  |Oj3S.@x(J...v../|
+00000040  f4 06 63 db 9e 7a c9 db  fd 00 d4 60 c0 09 00 00  |..c..z.....`....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,21 +48,21 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 d8 0c 00  00 d4 03 00 17 41 04 9f  |*............A..|
-00000280  24 ca 28 33 09 dc 7a b0  f8 92 b4 aa a2 e6 1c 13  |$.(3..z.........|
-00000290  26 8f ee 24 a9 8f b1 52  b2 23 0f b8 a9 da d4 0c  |&..$...R.#......|
-000002a0  db c2 56 ce 5d 55 a2 79  fb a2 5a 4b db 55 ec 7b  |..V.]U.y..ZK.U.{|
-000002b0  ae 30 1d 60 29 c8 83 23  14 e0 20 26 58 3d 50 04  |.0.`)..#.. &X=P.|
-000002c0  03 00 8b 30 81 88 02 42  01 4e 56 50 b8 ce 9f c7  |...0...B.NVP....|
-000002d0  55 da ae 3e b9 80 57 41  e9 94 e2 69 92 cb 33 ba  |U..>..WA...i..3.|
-000002e0  53 95 92 6a 6b 30 94 f7  9c 4c 43 3e a6 35 c4 a0  |S..jk0...LC>.5..|
-000002f0  3d 7b 6b 0e f3 ce b5 d7  f9 b6 fe fe e7 d8 69 aa  |={k...........i.|
-00000300  b8 50 f7 76 ba 75 53 a2  d7 4c 02 42 01 06 0a bf  |.P.v.uS..L.B....|
-00000310  0c 02 ab 60 25 62 d5 27  95 69 16 b6 b5 6f b6 9b  |...`%b.'.i...o..|
-00000320  0f 88 81 e6 42 30 d3 0c  e9 68 05 ac 56 7c 36 0a  |....B0...h..V|6.|
-00000330  91 c6 a5 61 14 6e ad 64  28 90 08 a3 8e 52 21 b3  |...a.n.d(....R!.|
-00000340  90 e4 30 44 ca 91 f2 73  98 4c 41 5c 7b bf 16 03  |..0D...s.LA\{...|
-00000350  03 00 04 0e 00 00 00                              |.......|
+00000270  2a 16 03 03 00 d7 0c 00  00 d3 03 00 17 41 04 2a  |*............A.*|
+00000280  ed 71 f5 82 ca f4 a1 2c  2a 18 c4 30 94 8a 2a 54  |.q.....,*..0..*T|
+00000290  cb aa 18 b7 5e d1 77 21  c4 75 41 d7 a5 1e 77 bc  |....^.w!.uA...w.|
+000002a0  cc f2 1a 9b a5 c1 66 88  63 17 04 64 61 e0 9e d2  |......f.c..da...|
+000002b0  f2 ab 7a 03 4d 3a fe 29  ed f1 70 eb 2a 56 fa 04  |..z.M:.)..p.*V..|
+000002c0  03 00 8a 30 81 87 02 41  61 9b d1 a4 96 1a 40 99  |...0...Aa.....@.|
+000002d0  4b 72 a9 fb 1e bb 55 a8  a9 33 ee 70 f9 c9 9d 58  |Kr....U..3.p...X|
+000002e0  99 19 0b cc af 31 48 51  79 cc 80 e2 68 18 57 a7  |.....1HQy...h.W.|
+000002f0  ff c5 d3 32 24 8d cb 70  48 87 0b 5a d3 65 aa d5  |...2$..pH..Z.e..|
+00000300  45 ad 7d 82 51 09 02 8a  16 02 42 01 d3 39 3d 24  |E.}.Q.....B..9=$|
+00000310  d6 d2 d4 b5 6e e3 c4 f1  57 14 10 a5 74 1b 21 e8  |....n...W...t.!.|
+00000320  82 f7 d4 da 22 de 11 80  87 cc 7b 2a c3 c1 c8 98  |....".....{*....|
+00000330  8a c6 18 f2 66 db cd 62  f0 38 5a bf 0a 31 0d b4  |....f..b.8Z..1..|
+00000340  9a 99 67 a4 44 75 66 36  b1 93 10 40 93 16 03 03  |..g.Duf6...@....|
+00000350  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
 00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
@@ -70,21 +70,21 @@
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
 00000050  01 16 03 03 00 40 00 00  00 00 00 00 00 00 00 00  |.....@..........|
-00000060  00 00 00 00 00 00 6c 78  6a 44 a0 10 37 89 5a a3  |......lxjD..7.Z.|
-00000070  12 e8 1f 26 75 da 3d 4f  d5 24 d7 4e 63 4e f3 c9  |...&u.=O.$.NcN..|
-00000080  76 d8 80 5f 95 3f 5f cc  29 11 6f f1 ce 32 71 21  |v.._.?_.).o..2q!|
-00000090  00 f0 54 cc da 58                                 |..T..X|
+00000060  00 00 00 00 00 00 ca d5  41 a7 18 c7 67 46 2a e2  |........A...gF*.|
+00000070  18 ee 61 10 82 2b 8e 03  b7 cd 74 07 10 1c d5 f1  |..a..+....t.....|
+00000080  dc c8 42 48 09 1c 67 d8  bf c2 19 e6 14 c2 7d 6f  |..BH..g.......}o|
+00000090  4d 97 95 c4 bc e2                                 |M.....|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 80 be 96 3b cb  |..........@...;.|
-00000010  b0 20 6b b8 b3 31 da 13  76 22 a0 ba f2 33 8e 8a  |. k..1..v"...3..|
-00000020  25 52 9f 83 3b 49 8f e5  2b 4e bf c0 8a 62 50 c2  |%R..;I..+N...bP.|
-00000030  af e0 db 67 4e 26 2b bd  a3 4f ed ff ea 7b 16 ce  |...gN&+..O...{..|
-00000040  35 63 81 30 ac a5 9c e0  ec 01 6f                 |5c.0......o|
+00000000  14 03 03 00 01 01 16 03  03 00 40 e3 89 06 9b 4b  |..........@....K|
+00000010  a5 68 3c f6 3b e0 c7 b7  07 e8 e1 4c 61 24 5d ba  |.h<.;......La$].|
+00000020  cd e5 2e 3b c3 1b 7b 89  df 2b 5f 06 54 a1 40 b9  |...;..{..+_.T.@.|
+00000030  37 2a aa ae 12 15 91 8e  ac 82 e2 9c f0 28 25 08  |7*...........(%.|
+00000040  43 3d 57 95 95 ae f6 74  e8 77 89                 |C=W....t.w.|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 92 85 85  8b f1 c7 07 32 b2 4c 5f  |............2.L_|
-00000020  c1 6b 7a fc 39 8a d3 65  cc f8 1a 42 4f b3 87 b9  |.kz.9..e...BO...|
-00000030  0a da 28 fc cc 15 03 03  00 30 00 00 00 00 00 00  |..(......0......|
-00000040  00 00 00 00 00 00 00 00  00 00 ca 4e b0 4d 6b 66  |...........N.Mkf|
-00000050  8d bf 9b 98 69 03 7b ec  c5 e2 74 71 90 34 51 2c  |....i.{...tq.4Q,|
-00000060  16 bf 67 0d 13 6b 2b be  ee 09                    |..g..k+...|
+00000010  00 00 00 00 00 af e7 22  23 14 ff f9 41 e1 7a 3b  |......."#...A.z;|
+00000020  be 86 a6 e7 31 20 50 11  98 62 be 23 7b 1a 55 e2  |....1 P..b.#{.U.|
+00000030  99 1c 36 63 84 15 03 03  00 30 00 00 00 00 00 00  |..6c.....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 40 7b c1 49 9b 4c  |..........@{.I.L|
+00000050  a8 d6 30 86 7e 3b bc ae  aa 03 a7 1e e7 a1 fb f0  |..0.~;..........|
+00000060  fc f0 54 5a ba 3a 8e ec  15 11                    |..TZ.:....|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM
index cd60846f93..8280eb44cb 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM
@@ -9,11 +9,11 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 59 35 ef 8a 48  |....Y...U..Y5..H|
-00000010  01 4f 2a f1 c8 1d fc 9b  fa 1e 00 05 ef 89 1c 72  |.O*............r|
-00000020  26 b0 1b 99 41 66 7c cf  cc 25 d3 20 3d ec a7 3e  |&...Af|..%. =..>|
-00000030  40 a3 3d b4 a4 87 ef ff  6e 3a b4 c9 7e 35 38 2c  |@.=.....n:..~58,|
-00000040  e2 b8 4d e3 f7 68 98 7a  f9 bd 02 69 c0 2b 00 00  |..M..h.z...i.+..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 25 5f ff 82 ec  |....Y...U..%_...|
+00000010  e6 e0 34 9a e8 88 b2 e1  ee 44 6c 11 62 b2 14 ba  |..4......Dl.b...|
+00000020  8e 71 cb 48 70 4b 47 7f  86 3e f1 20 ad b0 3f 8e  |.q.HpKG..>. ..?.|
+00000030  4e bc 26 fb 01 18 12 8e  b2 30 b8 25 ae 0e 2d 88  |N.&......0.%..-.|
+00000040  c4 8a 60 1c 45 aa 3c 42  63 cb 4d ca c0 2b 00 00  |..`.E.<Bc.M..+..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,38 +48,38 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 d7 0c 00  00 d3 03 00 17 41 04 20  |*............A. |
-00000280  47 59 b8 c8 24 46 f5 8f  e7 d3 97 cd 8a 38 e9 6c  |GY..$F.......8.l|
-00000290  b1 4e e9 61 af 8f ca bd  21 de e5 06 44 9d 92 6f  |.N.a....!...D..o|
-000002a0  62 54 c2 c4 68 53 44 66  3f af 68 62 3a 10 a8 69  |bT..hSDf?.hb:..i|
-000002b0  f2 17 c7 17 ad c9 28 a5  01 eb cc 75 51 57 93 04  |......(....uQW..|
-000002c0  03 00 8a 30 81 87 02 42  00 8f c8 a1 0d 7e 53 2a  |...0...B.....~S*|
-000002d0  15 1f 5e 3f 5d 45 9a 1a  ef b7 8f f8 b4 6c 77 07  |..^?]E.......lw.|
-000002e0  78 23 d3 06 e8 8b 8b 40  a9 c7 3d 5a 57 68 87 0a  |x#.....@..=ZWh..|
-000002f0  69 86 19 3f b1 ce 51 9b  b1 a9 be 30 52 77 0c 19  |i..?..Q....0Rw..|
-00000300  31 5f 62 01 f8 59 35 07  46 f3 02 41 75 d7 2c 76  |1_b..Y5.F..Au.,v|
-00000310  e4 d4 fa cb 1b eb ef 53  0f d0 60 19 a5 6e c0 f8  |.......S..`..n..|
-00000320  67 82 e9 03 c6 bf 7e 0e  0c b0 74 22 32 3b 68 45  |g.....~...t"2;hE|
-00000330  9e 91 a8 18 db b8 23 33  f3 44 3d 66 56 0f 73 91  |......#3.D=fV.s.|
-00000340  81 9d 73 b8 b7 02 23 ab  4c 28 39 00 e2 16 03 03  |..s...#.L(9.....|
-00000350  00 04 0e 00 00 00                                 |......|
+00000270  2a 16 03 03 00 d8 0c 00  00 d4 03 00 17 41 04 06  |*............A..|
+00000280  53 ba c4 c9 36 1d a0 ea  75 2c 14 b7 f9 fc dd e6  |S...6...u,......|
+00000290  4b 16 11 13 15 6f 3f 30  6c dc 65 07 28 5c 78 b4  |K....o?0l.e.(\x.|
+000002a0  14 f8 20 1e 37 6b ab 5f  c7 f8 e3 9b ba 74 7d 87  |.. .7k._.....t}.|
+000002b0  ec 5c d9 5a 84 39 46 85  6f 18 35 5e 60 5a 2e 04  |.\.Z.9F.o.5^`Z..|
+000002c0  03 00 8b 30 81 88 02 42  01 8d 25 04 bd 14 00 19  |...0...B..%.....|
+000002d0  dd c5 ff 7e 31 4f 46 55  f8 50 ae f9 81 43 07 ac  |...~1OFU.P...C..|
+000002e0  cb 11 3f d4 32 f9 b8 38  1f 19 57 69 ec af cc 45  |..?.2..8..Wi...E|
+000002f0  f7 35 a9 be 4f 53 f4 35  eb fb 42 bb ab 45 0d 06  |.5..OS.5..B..E..|
+00000300  01 6e b6 12 2b 3c 91 e3  40 20 02 42 01 9e 00 e3  |.n..+<..@ .B....|
+00000310  ea 37 9d a7 fa f0 58 f4  29 ce d0 24 15 e1 10 e4  |.7....X.)..$....|
+00000320  74 f5 33 a2 15 26 0d 45  65 09 36 c4 43 9e 42 b4  |t.3..&.Ee.6.C.B.|
+00000330  0f 29 32 22 52 ff 75 28  a3 cb 73 ca 06 ef 71 8c  |.)2"R.u(..s...q.|
+00000340  02 98 5e 5f 7b 02 7b 6f  a7 bd 66 a5 6f f8 16 03  |..^_{.{o..f.o...|
+00000350  03 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
 00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
 00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 26 b4  |.....(........&.|
-00000060  7f ed 06 9c 4a 40 7f 35  56 d6 f3 b4 a8 cc 26 a8  |....J@.5V.....&.|
-00000070  bd 27 b4 6e c9 8d 5e 8a  64 a9 03 f4 b0 19        |.'.n..^.d.....|
+00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 67 56  |.....(........gV|
+00000060  17 d8 0c 91 de 6c 80 59  0c cc f2 92 8a d4 c5 ef  |.....l.Y........|
+00000070  4b e3 c0 43 ae db 66 71  a0 a8 a6 86 ca 97        |K..C..fq......|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 4f 51 fc b5 13  |..........(OQ...|
-00000010  3e 76 c2 a1 63 43 ef d4  69 f1 6d a3 f3 76 96 8f  |>v..cC..i.m..v..|
-00000020  7c 41 a6 8c 33 67 f2 2b  4d 3a b6 08 d8 0e af 1d  ||A..3g.+M:......|
-00000030  30 d4 66                                          |0.f|
+00000000  14 03 03 00 01 01 16 03  03 00 28 74 15 df d3 2d  |..........(t...-|
+00000010  c0 33 af 01 f9 50 22 97  19 b3 9a f5 68 69 35 a9  |.3...P".....hi5.|
+00000020  ac 4c 1b f6 6d b3 4e b4  5f ce 56 0b 46 4d 0f 40  |.L..m.N._.V.FM.@|
+00000030  d7 01 69                                          |..i|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 fe 94 6f  |...............o|
-00000010  0f be 72 0e 69 15 59 ef  1e 46 ec a1 ac e5 fd 6c  |..r.i.Y..F.....l|
-00000020  2f 63 33 15 03 03 00 1a  00 00 00 00 00 00 00 02  |/c3.............|
-00000030  3a 61 9f 5f f9 9c 85 38  0b ce 57 5e 67 e4 78 3a  |:a._...8..W^g.x:|
-00000040  bc c5                                             |..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 d2 0d e5  |................|
+00000010  9a c2 77 8a 81 0b d1 62  58 fa 7a 34 14 b1 14 1f  |..w....bX.z4....|
+00000020  ef e8 6d 15 03 03 00 1a  00 00 00 00 00 00 00 02  |..m.............|
+00000030  0f e6 f9 67 74 d7 95 5a  2c 17 f4 24 62 4f a8 a7  |...gt..Z,..$bO..|
+00000040  b5 fd                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES128-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES128-SHA256
index a1863add3b..96f2f4a956 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES128-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES128-SHA256
@@ -9,11 +9,11 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 dc 70 e2 2c 2a  |....Y...U...p.,*|
-00000010  b3 14 e6 05 f7 a7 45 61  81 2b b5 8a b4 b9 a2 c6  |......Ea.+......|
-00000020  0d b8 3a 5c 6b 3b ff de  db 48 d5 20 81 90 48 44  |..:\k;...H. ..HD|
-00000030  d1 94 4b 18 ef 56 65 6e  34 b6 79 06 c2 14 29 75  |..K..Ven4.y...)u|
-00000040  ae 4b d5 34 58 18 1e 9c  a5 7a a1 13 c0 23 00 00  |.K.4X....z...#..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 1f 9e 85 7e e3  |....Y...U.....~.|
+00000010  30 5b 4c b0 e3 34 4d 13  93 97 ed 3a 38 3c a6 d5  |0[L..4M....:8<..|
+00000020  b2 9d 0c 9b 3d e8 13 85  ef e7 56 20 eb c2 eb 19  |....=.....V ....|
+00000030  fd 5e 61 08 6b 8b 6f a5  22 8d 0c 67 e0 1c 96 e1  |.^a.k.o."..g....|
+00000040  59 7b 36 82 0f c4 15 f5  b1 70 cb 1c c0 23 00 00  |Y{6......p...#..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,20 +48,20 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 d8 0c 00  00 d4 03 00 17 41 04 81  |*............A..|
-00000280  3d d2 f3 36 ac 7a 42 7f  36 d9 d9 97 11 ca 54 bf  |=..6.zB.6.....T.|
-00000290  21 95 a5 32 e1 90 ab ee  d5 65 c9 d0 b1 92 cc 21  |!..2.....e.....!|
-000002a0  ab 15 81 bb 30 51 0f a2  5d 99 29 d2 46 cd f4 94  |....0Q..].).F...|
-000002b0  11 28 0e d2 eb 3d ca 05  9e a6 27 5d b0 80 c7 04  |.(...=....']....|
-000002c0  03 00 8b 30 81 88 02 42  00 ec e7 77 57 95 36 ad  |...0...B...wW.6.|
-000002d0  52 ae ed 4c fc 44 84 08  a9 28 66 f7 a6 1f c3 96  |R..L.D...(f.....|
-000002e0  5f 35 dc b1 ea 5e 7b 3d  be 8c 08 ef b1 06 74 b3  |_5...^{=......t.|
-000002f0  9f 36 17 30 3a 34 f3 7e  b9 39 cc fa c7 aa 33 7d  |.6.0:4.~.9....3}|
-00000300  5a d2 b6 44 f3 67 09 1b  6f 08 02 42 00 df cf 92  |Z..D.g..o..B....|
-00000310  b0 f1 e2 34 24 ec 78 12  12 07 66 3e d9 1c 7c fa  |...4$.x...f>..|.|
-00000320  13 f7 39 cd 01 11 ea f0  62 e9 1f 75 5f e4 17 cf  |..9.....b..u_...|
-00000330  e8 fd 03 4c 63 15 3e 4a  d1 2a 25 07 a1 bb f9 5d  |...Lc.>J.*%....]|
-00000340  32 62 41 23 09 a3 9d 92  78 51 09 82 25 d7 16 03  |2bA#....xQ..%...|
+00000270  2a 16 03 03 00 d8 0c 00  00 d4 03 00 17 41 04 84  |*............A..|
+00000280  28 39 9d 53 e8 8b 3f 0e  6b ed 13 79 79 ad e0 e9  |(9.S..?.k..yy...|
+00000290  a6 87 87 14 4f 32 7b 3e  c5 80 eb f3 3f af 21 1d  |....O2{>....?.!.|
+000002a0  86 3b 97 53 9d 30 1f ca  0f 57 07 c3 6e 9e e9 03  |.;.S.0...W..n...|
+000002b0  bd 0a f8 5d 79 3e 6a 98  13 0e 38 16 33 84 87 04  |...]y>j...8.3...|
+000002c0  03 00 8b 30 81 88 02 42  01 3d 4d fd 3f b3 7a 31  |...0...B.=M.?.z1|
+000002d0  50 4d 0c 56 ad 93 6f 51  36 6b ed eb c2 5f 40 e6  |PM.V..oQ6k..._@.|
+000002e0  bd d4 68 de 05 90 cb 90  e1 dd f4 dd 13 2d e3 bc  |..h..........-..|
+000002f0  77 3a 4c 75 ff d7 7a 45  1a 62 9d 1c af cb d9 a7  |w:Lu..zE.b......|
+00000300  b9 0b 52 d0 94 e9 a1 11  7e 63 02 42 01 e5 25 47  |..R.....~c.B..%G|
+00000310  4f fd 02 4d 8d 81 8e ef  90 15 a5 29 8d 11 40 0f  |O..M.......)..@.|
+00000320  e0 2f 59 da e6 63 da 23  9f fe 61 53 13 7a 2d 1a  |./Y..c.#..aS.z-.|
+00000330  f2 26 23 91 06 bf 36 dd  d5 6b 0e 4b 7b 32 b0 41  |.&#...6..k.K{2.A|
+00000340  0e 00 17 c6 95 04 5a 88  41 61 b6 ec 82 38 16 03  |......Z.Aa...8..|
 00000350  03 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
@@ -70,25 +70,25 @@
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
 00000050  01 16 03 03 00 50 00 00  00 00 00 00 00 00 00 00  |.....P..........|
-00000060  00 00 00 00 00 00 2a 78  1d 82 10 56 52 ee ec 22  |......*x...VR.."|
-00000070  d7 b5 63 91 b2 98 a2 01  59 d7 63 f6 ca 30 22 ac  |..c.....Y.c..0".|
-00000080  10 5e b3 60 d9 f6 37 a9  3d 15 7d 78 9c 99 be b7  |.^.`..7.=.}x....|
-00000090  3a f1 1a 99 22 8c 2b e5  ea 5a 57 0c 74 1a ea d6  |:...".+..ZW.t...|
-000000a0  52 b9 a0 fa f8 7b                                 |R....{|
+00000060  00 00 00 00 00 00 b6 be  a3 13 26 66 59 78 6b f0  |..........&fYxk.|
+00000070  a4 b4 db 3e 48 98 dd 0e  fb b7 1e 72 4d 5c 60 d9  |...>H......rM\`.|
+00000080  33 30 4e 75 e3 5b 03 73  dd d3 b9 a2 ad a4 c7 4c  |30Nu.[.s.......L|
+00000090  d2 1d e3 98 6f 93 dd 66  4d 33 61 66 bb d1 e9 a0  |....o..fM3af....|
+000000a0  d7 95 47 01 85 3a                                 |..G..:|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 50 60 9d 1e 05 df  |..........P`....|
-00000010  a0 d5 1f 08 f1 cc 99 60  86 e3 1e e1 bc 59 08 2f  |.......`.....Y./|
-00000020  27 60 c1 a3 fc cf 0f 1b  6f 9e 5e 4c d4 3a 9a 19  |'`......o.^L.:..|
-00000030  2a 72 a7 82 12 26 ec 7e  74 0f b4 9a 2c b2 8e da  |*r...&.~t...,...|
-00000040  ac cb 26 29 a6 65 d5 7f  15 a1 52 07 35 44 68 77  |..&).e....R.5Dhw|
-00000050  61 6b ef 6b e9 93 db 9b  4f 72 65                 |ak.k....Ore|
+00000000  14 03 03 00 01 01 16 03  03 00 50 b8 1f f2 b7 07  |..........P.....|
+00000010  83 90 22 d9 91 47 d8 d3  40 ab db 22 30 7e f4 d0  |.."..G..@.."0~..|
+00000020  f3 79 16 d3 6b 8c 58 ad  47 f9 4d 96 46 e4 b1 73  |.y..k.X.G.M.F..s|
+00000030  ba 9c 43 73 d2 31 e3 de  30 5a 81 3e 7e e5 30 3d  |..Cs.1..0Z.>~.0=|
+00000040  ba 93 06 40 93 ed 07 1e  a6 82 e6 0b 20 b7 6c a8  |...@........ .l.|
+00000050  bc 9a cd 34 3f 38 b0 7a  34 f8 3d                 |...4?8.z4.=|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000010  00 00 00 00 00 9a 50 34  bc 9d 00 0e 46 81 dc 03  |......P4....F...|
-00000020  f2 8f ea 57 93 a2 99 26  7e ae 70 70 d1 b7 ed b2  |...W...&~.pp....|
-00000030  d3 76 28 9d 19 14 13 e3  5c f7 58 aa 25 98 c4 82  |.v(.....\.X.%...|
-00000040  ee c3 e7 4a 51 15 03 03  00 40 00 00 00 00 00 00  |...JQ....@......|
-00000050  00 00 00 00 00 00 00 00  00 00 5d 80 c2 d5 ae 05  |..........].....|
-00000060  9a 31 e4 39 3f 4c f0 97  ed cb fd e3 3a de 19 b6  |.1.9?L......:...|
-00000070  0d 49 95 43 13 a1 c8 29  a0 dc b5 30 4b 66 a6 25  |.I.C...)...0Kf.%|
-00000080  e0 fd a8 02 c9 81 1d fa  f9 2e                    |..........|
+00000010  00 00 00 00 00 e3 3d e1  1d 9e ff cb ab df 74 53  |......=.......tS|
+00000020  81 09 16 1c 85 ac d9 43  50 9c 50 9d f5 30 20 87  |.......CP.P..0 .|
+00000030  cb d5 af 13 42 d3 c7 8f  df ef ef ae 28 3b d8 75  |....B.......(;.u|
+00000040  28 b5 c4 87 66 15 03 03  00 40 00 00 00 00 00 00  |(...f....@......|
+00000050  00 00 00 00 00 00 00 00  00 00 62 9a 7b 83 27 b4  |..........b.{.'.|
+00000060  b8 80 54 c6 6f d8 b7 44  f3 60 b7 fe 04 bd c3 98  |..T.o..D.`......|
+00000070  b1 7b df 26 2c a7 97 36  65 a1 50 bd 20 d9 fe cf  |.{.&,..6e.P. ...|
+00000080  d8 f9 6a 2d 00 c7 ca 54  f2 7b                    |..j-...T.{|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384 b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384
index af7d19358f..7f8fc4d055 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384
@@ -9,11 +9,11 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 99 32 aa 20 58  |....Y...U...2. X|
-00000010  d0 30 4c 2f ad 16 ef b9  e9 7b ff 1d 08 6f 0e ef  |.0L/.....{...o..|
-00000020  5b 1f 75 6f 44 0c 88 33  8b 29 13 20 66 72 ac 2f  |[.uoD..3.). fr./|
-00000030  cc c8 02 f0 6f d3 b9 20  80 85 97 81 14 c5 10 18  |....o.. ........|
-00000040  f2 fe 96 e4 60 0b a0 92  b1 79 8b 58 c0 2c 00 00  |....`....y.X.,..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 1d 78 37 0a 00  |....Y...U...x7..|
+00000010  70 94 45 3c 49 1b 82 94  3f d4 4c b7 00 70 a6 65  |p.E<I...?.L..p.e|
+00000020  af 8d 9b be 78 b5 98 22  75 5e a8 20 86 0e 17 77  |....x.."u^. ...w|
+00000030  6b 15 41 0b 51 d3 74 dc  5a a6 fc 7c 29 7d 30 3b  |k.A.Q.t.Z..|)}0;|
+00000040  7e 69 5c a1 4a 45 c9 8a  52 80 c3 3d c0 2c 00 00  |~i\.JE..R..=.,..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,38 +48,38 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 d8 0c 00  00 d4 03 00 17 41 04 8e  |*............A..|
-00000280  02 91 ed c4 ee 09 4e e3  98 d1 7f 4d 24 02 27 60  |......N....M$.'`|
-00000290  1c 77 c0 fd 79 e0 03 fb  9c 74 e8 85 a1 5f f5 ef  |.w..y....t..._..|
-000002a0  8d 01 8b cf 91 bc b2 f2  5b 41 cc 98 f2 54 7d a1  |........[A...T}.|
-000002b0  95 86 67 02 a3 97 9b 1c  54 37 07 ab 14 4c 5a 04  |..g.....T7...LZ.|
-000002c0  03 00 8b 30 81 88 02 42  01 85 fb c0 e3 70 31 8a  |...0...B.....p1.|
-000002d0  7d 14 e6 f4 5b 9c cc f8  05 f0 ca 9d 6c df 2a 5a  |}...[.......l.*Z|
-000002e0  e6 3b 40 00 ba a8 f6 38  90 a1 a7 00 74 cd ab 17  |.;@....8....t...|
-000002f0  d0 65 69 46 43 ec e2 11  d8 7e 90 a3 72 74 0f a9  |.eiFC....~..rt..|
-00000300  43 f2 0a d9 22 4d c7 5d  23 91 02 42 01 9f 42 1c  |C..."M.]#..B..B.|
-00000310  5a 23 83 c2 69 e4 42 5f  53 f8 6b ef 23 7c 22 27  |Z#..i.B_S.k.#|"'|
-00000320  a6 99 9c e1 df 48 6b e9  9d 1f 14 64 25 4d 78 63  |.....Hk....d%Mxc|
-00000330  c7 42 e2 26 af e4 70 34  29 d9 e8 fc e8 3b 43 8d  |.B.&..p4)....;C.|
-00000340  f6 1c 22 3e b1 8a 7b 16  d0 44 3f 3b 92 79 16 03  |..">..{..D?;.y..|
-00000350  03 00 04 0e 00 00 00                              |.......|
+00000270  2a 16 03 03 00 d7 0c 00  00 d3 03 00 17 41 04 bd  |*............A..|
+00000280  d5 51 1a c3 69 ca 47 cd  74 e5 9b 48 be a6 8f 86  |.Q..i.G.t..H....|
+00000290  70 cc d6 c5 d2 d7 85 8f  e0 fa be 49 5c fc de 21  |p..........I\..!|
+000002a0  98 b9 7c 88 12 a6 76 d9  47 c8 3f 0f 49 1d 7d 1b  |..|...v.G.?.I.}.|
+000002b0  15 77 7a 8b 0c f4 3a b6  de eb 70 69 50 88 3f 04  |.wz...:...piP.?.|
+000002c0  03 00 8a 30 81 87 02 41  65 34 f2 1d db 9b 31 35  |...0...Ae4....15|
+000002d0  a0 bc 4a b8 aa 78 93 54  c7 43 3b 4b 9d eb 3d ba  |..J..x.T.C;K..=.|
+000002e0  38 ba ad 5a 26 fc 67 46  ca d6 c4 21 42 6c 31 51  |8..Z&.gF...!Bl1Q|
+000002f0  16 8e a3 59 d3 2c 55 9b  00 19 0e 40 ad 3c 3d ec  |...Y.,U....@.<=.|
+00000300  a2 da 87 5b b0 31 0e 4b  8e 02 42 01 f9 7e 5b a4  |...[.1.K..B..~[.|
+00000310  d5 d1 7f 38 c5 59 31 29  4c c0 42 ad 2e e0 20 cc  |...8.Y1)L.B... .|
+00000320  24 53 70 d6 f2 ff c3 79  8d 56 14 62 12 5e fe 97  |$Sp....y.V.b.^..|
+00000330  a0 c1 d6 25 d7 ae b1 c7  51 93 dd 06 8c 88 c8 af  |...%....Q.......|
+00000340  b4 38 d1 fd 2a 4f 35 1c  bb 46 e6 06 c6 16 03 03  |.8..*O5..F......|
+00000350  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
 00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
 00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 d4 6e  |.....(.........n|
-00000060  eb 01 cd ca 65 97 0f 2b  3f dc 27 bb ff eb 49 43  |....e..+?.'...IC|
-00000070  94 ff 5e 80 75 ac c9 c5  f4 57 10 0e 06 08        |..^.u....W....|
+00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 1b f7  |.....(..........|
+00000060  98 9e a2 1c a6 d9 0e 55  2f d4 6b be db ba 2f 4a  |.......U/.k.../J|
+00000070  4f 46 8b 8b b2 65 27 d8  18 d5 83 61 12 68        |OF...e'....a.h|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 51 bb 38 d0 28  |..........(Q.8.(|
-00000010  d6 9e ea 9c 0d 90 bf 46  60 96 9b a4 81 d3 d8 db  |.......F`.......|
-00000020  f3 ba 91 e2 16 8e 63 02  24 4b ce 1a ec b4 ae ab  |......c.$K......|
-00000030  69 de 0f                                          |i..|
+00000000  14 03 03 00 01 01 16 03  03 00 28 09 2c dd e4 d7  |..........(.,...|
+00000010  60 74 68 8f b0 48 1d 53  54 b8 f8 fc 27 d4 9b ca  |`th..H.ST...'...|
+00000020  4a e3 29 ad 49 53 46 9b  ed 2f 9c c8 2c 17 b3 50  |J.).ISF../..,..P|
+00000030  a3 87 81                                          |...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 cd 00 a5  |................|
-00000010  c9 d1 05 c7 68 30 e4 d1  62 e1 b1 e0 1b bb 08 cf  |....h0..b.......|
-00000020  a2 2f 81 15 03 03 00 1a  00 00 00 00 00 00 00 02  |./..............|
-00000030  4a a2 5d 68 b7 82 ef ef  99 d2 77 d6 bf 59 96 bd  |J.]h......w..Y..|
-00000040  c9 04                                             |..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 93 96 d9  |................|
+00000010  50 d6 f9 00 c5 06 60 0b  94 2c cf b6 08 99 57 a3  |P.....`..,....W.|
+00000020  f5 2c de 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.,..............|
+00000030  95 6f b0 94 f7 79 c6 5e  50 e6 42 e9 76 d0 7b 26  |.o...y.^P.B.v.{&|
+00000040  c6 0d                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES
index d793f38f7f..1c8ed6ee7d 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES
@@ -9,11 +9,11 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 0f 45 26 1e c1  |....Y...U...E&..|
-00000010  a8 81 43 80 a6 3b b8 78  8f 19 83 ca 10 62 90 55  |..C..;.x.....b.U|
-00000020  13 5b c3 78 55 23 32 ca  46 ab 1b 20 12 b9 b5 8b  |.[.xU#2.F.. ....|
-00000030  6a 21 25 9b e6 fc 12 78  0c 62 9f fe 2a dc cd 31  |j!%....x.b..*..1|
-00000040  53 a1 6e 3c 79 df 71 12  fd 83 4b 67 c0 13 00 00  |S.n<y.q...Kg....|
+00000000  16 03 03 00 59 02 00 00  55 03 03 e9 05 b4 d9 e5  |....Y...U.......|
+00000010  32 15 3b fb c4 88 26 da  a2 fc 28 87 81 6f 7c 64  |2.;...&...(..o|d|
+00000020  fb 23 c7 aa 04 5c d0 db  6d 17 53 20 8c ad 1e ab  |.#...\..m.S ....|
+00000030  af a2 f7 95 23 46 34 eb  67 4a ee 08 c4 be c9 bc  |....#F4.gJ......|
+00000040  2c 7b 5a bd ac ce b6 33  2f f0 ce 6d c0 13 00 00  |,{Z....3/..m....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,19 +53,19 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  cd 0c 00 00 c9 03 00 17  41 04 7b be a6 f9 bd 67  |........A.{....g|
-000002d0  6f 05 21 b5 8e 20 e5 35  a7 51 f0 ce c0 76 21 78  |o.!.. .5.Q...v!x|
-000002e0  36 d2 39 ca 46 44 0a e0  e5 2a df 59 1e c4 8f c1  |6.9.FD...*.Y....|
-000002f0  fc 4a 65 ff e6 18 dc 60  47 6c 31 b0 68 65 02 92  |.Je....`Gl1.he..|
-00000300  75 ab 7c db 83 d6 d4 44  06 36 04 01 00 80 40 dd  |u.|....D.6....@.|
-00000310  9b dd 37 cb 16 bb c7 29  52 3a 02 64 6c a3 c4 06  |..7....)R:.dl...|
-00000320  fd 24 e1 d3 b3 83 6c 45  2c 76 17 ae f6 b4 af e7  |.$....lE,v......|
-00000330  b7 93 a6 69 e6 8c c8 6b  a0 9a 72 9c 80 4e 04 e6  |...i...k..r..N..|
-00000340  dd 7e 49 d4 d2 29 9e 2f  64 89 be 00 36 e9 8e 53  |.~I..)./d...6..S|
-00000350  0a 23 b2 b6 a1 6e 94 df  e1 b2 c1 35 17 85 7c 7a  |.#...n.....5..|z|
-00000360  5e d1 0f 03 b2 55 2f 52  48 af 66 17 ae 25 3d 0a  |^....U/RH.f..%=.|
-00000370  dc c7 c2 8e 40 b9 a2 5d  65 25 85 1c 88 d4 6c aa  |....@..]e%....l.|
-00000380  0b 5b c8 77 4c bd 88 60  eb f2 fc 9f 71 39 16 03  |.[.wL..`....q9..|
+000002c0  cd 0c 00 00 c9 03 00 17  41 04 08 89 35 71 9c 6f  |........A...5q.o|
+000002d0  6d 23 7d e8 c5 97 18 ae  55 5d cc 58 72 3a 4e 57  |m#}.....U].Xr:NW|
+000002e0  0f 09 4d a3 81 b4 be 8d  7e 9b 97 7a 23 99 16 3d  |..M.....~..z#..=|
+000002f0  3b d6 84 85 e8 84 ac 40  5d 09 56 68 10 1d c8 56  |;......@].Vh...V|
+00000300  bd ce 9d f0 06 08 28 43  b1 68 04 01 00 80 8f 8f  |......(C.h......|
+00000310  3a e7 1a ad 4e 90 22 30  5c ac e6 f3 82 65 a4 79  |:...N."0\....e.y|
+00000320  45 17 da 02 fd 35 19 77  0b 9a 4b f9 f4 ae 4a 73  |E....5.w..K...Js|
+00000330  75 95 6b ba c5 2d 98 4a  81 f5 ef c2 49 d5 ed 6c  |u.k..-.J....I..l|
+00000340  14 2f 17 a1 ad f1 23 21  98 db d8 e0 83 4e b8 58  |./....#!.....N.X|
+00000350  3b bf 00 a2 62 ad f9 2b  8a 85 3f 29 be d3 5f 70  |;...b..+..?).._p|
+00000360  83 3e 0f a7 c9 27 86 e4  4e 9f 1f d9 18 01 be 97  |.>...'..N.......|
+00000370  5c 3a c0 1f e6 a5 fb 44  42 be 20 a0 77 4c 2a 37  |\:.....DB. .wL*7|
+00000380  e3 e9 fb 18 4c 12 1e a3  6a 0b a4 bf 7e f7 16 03  |....L...j...~...|
 00000390  03 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
@@ -74,21 +74,21 @@
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
 00000050  01 16 03 03 00 40 00 00  00 00 00 00 00 00 00 00  |.....@..........|
-00000060  00 00 00 00 00 00 d1 bb  84 d1 bb 91 17 18 dc 9f  |................|
-00000070  0a 6f df 19 6f cb 04 c4  0d 4a d1 d1 6c 0d 94 da  |.o..o....J..l...|
-00000080  54 7a 4d 21 52 99 00 8e  70 6b 15 1f 51 29 8f b6  |TzM!R...pk..Q)..|
-00000090  14 ed 8e 53 ea f3                                 |...S..|
+00000060  00 00 00 00 00 00 94 cc  f2 40 05 2f 97 32 ef 64  |.........@./.2.d|
+00000070  12 ff d2 3b df 70 1e d1  0d 9b f8 96 a8 bd 4d 24  |...;.p........M$|
+00000080  a8 e1 a8 ee 01 9d f4 72  a7 aa e7 46 87 52 34 10  |.......r...F.R4.|
+00000090  33 c7 81 29 83 e3                                 |3..)..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 9c 15 03 96 11  |..........@.....|
-00000010  67 f8 cd 1e 60 b5 a4 12  d1 8e f1 85 63 bf 1d 9d  |g...`.......c...|
-00000020  3f 93 81 e3 bb 77 75 f3  18 01 d0 c6 c6 35 2b e0  |?....wu......5+.|
-00000030  82 03 0f a1 eb 98 09 52  5e b6 53 b5 54 d9 08 67  |.......R^.S.T..g|
-00000040  a7 cf bf f3 54 cf f1 26  4f 6e 5b                 |....T..&On[|
+00000000  14 03 03 00 01 01 16 03  03 00 40 88 a5 62 83 1c  |..........@..b..|
+00000010  b4 3c 98 eb 2b ed c1 88  f5 4c 44 d8 9c ef b0 4c  |.<..+....LD....L|
+00000020  38 c0 ff e9 7b 20 ad 32  ff 23 3f a7 cb b7 53 47  |8...{ .2.#?...SG|
+00000030  58 c3 a3 49 8b 18 fd d4  72 6d 9a 05 3a 40 c9 93  |X..I....rm..:@..|
+00000040  3d b5 35 20 96 f4 bd 4e  d5 e8 ed                 |=.5 ...N...|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 65 00 0c  8a 77 a2 48 d1 40 82 9f  |.....e...w.H.@..|
-00000020  f6 34 89 bf bb 42 d1 ea  6b 7f 61 8e 7b 9b f9 b5  |.4...B..k.a.{...|
-00000030  0b a5 d9 8c 0d 15 03 03  00 30 00 00 00 00 00 00  |.........0......|
-00000040  00 00 00 00 00 00 00 00  00 00 e5 5f 74 3d bd c6  |..........._t=..|
-00000050  5d 68 04 b2 4f 44 0d 43  6b a8 7a 38 81 23 27 10  |]h..OD.Ck.z8.#'.|
-00000060  3b 39 63 4c c7 8f 11 21  2e 86                    |;9cL...!..|
+00000010  00 00 00 00 00 d6 43 ac  cb ab 11 db ae bb ca 95  |......C.........|
+00000020  35 e8 1b 29 60 ef 52 40  15 74 e4 b7 29 ea 45 36  |5..)`.R@.t..).E6|
+00000030  4a cf 6e ed bc 15 03 03  00 30 00 00 00 00 00 00  |J.n......0......|
+00000040  00 00 00 00 00 00 00 00  00 00 20 76 c9 f9 21 23  |.......... v..!#|
+00000050  c9 a0 bd 00 69 34 19 dc  81 18 a0 e4 90 f1 fb c5  |....i4..........|
+00000060  70 a6 51 2e 77 24 71 57  69 15                    |p.Q.w$qWi.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256
index f47d206021..da96c5e698 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256
@@ -9,11 +9,11 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 03 c2 c6 e3 f7  |....Y...U.......|
-00000010  81 dc 23 5e 5f df a9 e4  7f 4b 78 03 8f 6c e9 ab  |..#^_....Kx..l..|
-00000020  bf b8 e0 26 43 33 a6 f3  d0 e1 44 20 82 76 b7 11  |...&C3....D .v..|
-00000030  aa 07 30 6e 6d 47 c6 52  7f a0 ac 91 84 e6 91 d3  |..0nmG.R........|
-00000040  f5 f3 54 f3 37 96 9d 0b  c1 33 2e 01 c0 27 00 00  |..T.7....3...'..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 52 ec 3d ca 8e  |....Y...U..R.=..|
+00000010  66 39 93 aa 74 f0 ae 26  75 a6 2d 79 9f 14 26 8d  |f9..t..&u.-y..&.|
+00000020  97 ee 01 b3 8c 11 6a ba  07 23 e8 20 08 b2 b2 24  |......j..#. ...$|
+00000030  08 4f 6e 70 fa b6 a3 c5  39 0a c7 ee 66 dd 6c 91  |.Onp....9...f.l.|
+00000040  35 0f 2e 27 8b b9 11 5b  d1 a2 fb d9 c0 27 00 00  |5..'...[.....'..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,19 +53,19 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  cd 0c 00 00 c9 03 00 17  41 04 d2 0d 72 49 89 39  |........A...rI.9|
-000002d0  9e e3 8b c5 0f 47 53 60  a8 c9 c5 da c8 29 32 63  |.....GS`.....)2c|
-000002e0  1b 76 08 55 46 9b a2 75  b4 6c 2e 91 cb b5 ec df  |.v.UF..u.l......|
-000002f0  8c bc 99 28 ba 41 21 cf  f3 29 7f e9 bb a5 94 06  |...(.A!..)......|
-00000300  00 de e7 f0 82 62 dd 1e  eb 65 04 01 00 80 0d 84  |.....b...e......|
-00000310  ea bc c9 3f 81 d3 86 a7  a3 d1 7e 0b 13 b1 b8 c8  |...?......~.....|
-00000320  1c a1 10 ed 9c 9e 93 3f  85 8d 9a 66 62 62 dd 0e  |.......?...fbb..|
-00000330  65 0e bb f9 7e 29 58 1d  a8 27 03 66 58 49 bc d0  |e...~)X..'.fXI..|
-00000340  02 bb 89 ec 59 f8 0a 14  3c ea f0 00 68 1a 94 2b  |....Y...<...h..+|
-00000350  40 65 28 f3 e8 7d 80 0b  52 d8 4d b0 eb 5b 85 dd  |@e(..}..R.M..[..|
-00000360  19 62 a8 8e 22 d5 6a 4c  95 b4 dc 26 c9 dd 62 57  |.b..".jL...&..bW|
-00000370  d5 e4 f0 c7 92 b4 ee 9d  aa 82 50 a0 de 3d 23 37  |..........P..=#7|
-00000380  5c da 0a 4d ee 3b 5a 4c  39 f1 80 85 e6 50 16 03  |\..M.;ZL9....P..|
+000002c0  cd 0c 00 00 c9 03 00 17  41 04 ed d1 a9 86 54 01  |........A.....T.|
+000002d0  2e 20 c1 f1 41 03 c7 88  f0 e4 45 49 54 08 12 f0  |. ..A.....EIT...|
+000002e0  1c 3c 2b ae bc c6 72 00  5c 3b 52 1d 96 7e a4 95  |.<+...r.\;R..~..|
+000002f0  88 6b 43 a9 a2 e9 62 35  d8 36 11 df 5c aa 53 ab  |.kC...b5.6..\.S.|
+00000300  d6 3c a3 0a 54 b7 48 10  f4 7f 04 01 00 80 1e d5  |.<..T.H.........|
+00000310  e4 e9 34 e2 3d e6 a1 ee  00 b8 1c b1 48 d1 ed c1  |..4.=.......H...|
+00000320  3b 55 55 a8 ed 42 ae fb  5e 51 35 ec be 18 27 69  |;UU..B..^Q5...'i|
+00000330  38 1f c0 af 1d 1c da 51  b1 14 59 32 fb c8 c2 02  |8......Q..Y2....|
+00000340  12 03 64 7c 01 c4 e8 32  03 b8 7e a7 ff 4c 13 54  |..d|...2..~..L.T|
+00000350  a8 91 9b 41 07 72 24 9b  0d 7d a5 f8 a0 a9 a3 90  |...A.r$..}......|
+00000360  8a d8 cd c1 4d 4e d1 da  26 7a 19 8a 2b b7 93 b4  |....MN..&z..+...|
+00000370  46 e8 9b c2 93 f5 80 52  9a ec b6 f5 68 02 b4 a0  |F......R....h...|
+00000380  51 43 61 fa a3 63 40 16  92 4f e2 7f f8 7c 16 03  |QCa..c@..O...|..|
 00000390  03 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
@@ -74,25 +74,25 @@
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
 00000050  01 16 03 03 00 50 00 00  00 00 00 00 00 00 00 00  |.....P..........|
-00000060  00 00 00 00 00 00 e2 26  a9 25 5d 21 a4 b3 b9 d0  |.......&.%]!....|
-00000070  10 0a f8 6a 49 13 ad 1d  b1 c1 f9 96 ac c5 1f ef  |...jI...........|
-00000080  56 21 94 fe 5b 02 52 5c  7c 3f cc 2e f1 07 f6 73  |V!..[.R\|?.....s|
-00000090  bc 8d 44 27 e4 d6 01 a0  91 a5 41 81 73 52 2a 1e  |..D'......A.sR*.|
-000000a0  34 20 56 fa 62 b9                                 |4 V.b.|
+00000060  00 00 00 00 00 00 cd 3d  7e db 65 76 06 d5 cf 73  |.......=~.ev...s|
+00000070  9b 6e 94 99 6e 55 e9 3c  74 08 6b 29 7a 73 fe dc  |.n..nU.<t.k)zs..|
+00000080  97 1b 55 23 f0 d7 7a d4  c5 1b 55 9f 82 88 c3 9b  |..U#..z...U.....|
+00000090  51 89 f5 df f5 36 91 4f  cd 3f 11 5c 3d 08 29 35  |Q....6.O.?.\=.)5|
+000000a0  17 a8 a9 5a 95 cc                                 |...Z..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 50 8c 3f 01 38 bf  |..........P.?.8.|
-00000010  82 14 f9 93 22 bd 88 90  63 4d e2 76 6d c6 13 19  |...."...cM.vm...|
-00000020  ec 99 42 ba 09 7c f6 41  da 33 6d c4 c5 59 da f8  |..B..|.A.3m..Y..|
-00000030  91 ad f0 11 e0 5e cd 16  47 c0 7d d1 00 3a 35 ab  |.....^..G.}..:5.|
-00000040  a0 fb 2e 5a ca 24 2c e0  44 0f 13 4a 46 32 04 9b  |...Z.$,.D..JF2..|
-00000050  7c 5c 1e ee fd 10 f6 2e  61 25 54                 ||\......a%T|
+00000000  14 03 03 00 01 01 16 03  03 00 50 ab 66 1f 17 93  |..........P.f...|
+00000010  3b a3 98 c0 05 76 7e c6  21 90 01 73 7c 63 ab 4a  |;....v~.!..s|c.J|
+00000020  3c bf 16 ed dd a5 24 f1  7b 46 21 bc 15 ef 92 3e  |<.....$.{F!....>|
+00000030  e4 ff 9e 60 cd cd 38 4b  5d 0c 56 b2 5b 65 77 a2  |...`..8K].V.[ew.|
+00000040  b3 8f fe 91 81 2b 10 cb  6b 13 7d e5 53 da 90 02  |.....+..k.}.S...|
+00000050  d9 c7 bb 7b 32 a3 2c 91  92 1d aa                 |...{2.,....|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000010  00 00 00 00 00 df 99 71  37 d7 54 28 64 8a 25 e4  |.......q7.T(d.%.|
-00000020  ca e3 96 1a 16 71 f3 f6  8d 66 e9 78 5d a9 29 b3  |.....q...f.x].).|
-00000030  6c 2f 78 89 63 bb 35 c6  7b e8 c8 13 19 bc af 55  |l/x.c.5.{......U|
-00000040  be 48 6c 61 95 15 03 03  00 40 00 00 00 00 00 00  |.Hla.....@......|
-00000050  00 00 00 00 00 00 00 00  00 00 2f f6 c9 d2 e7 7d  |........../....}|
-00000060  66 d8 ea 21 57 60 2a a5  df 23 3e 15 5c 3d e0 be  |f..!W`*..#>.\=..|
-00000070  01 3d 19 14 70 3b dd bc  3f bd 09 4d 03 45 07 7f  |.=..p;..?..M.E..|
-00000080  4e e9 6d 43 af 11 47 93  c2 e5                    |N.mC..G...|
+00000010  00 00 00 00 00 b5 31 ff  15 87 a2 df 7a 4e 00 0e  |......1.....zN..|
+00000020  f2 45 59 71 01 d7 8b d0  f8 25 16 96 e1 76 42 ec  |.EYq.....%...vB.|
+00000030  f2 c7 08 aa 70 72 9c a4  51 85 8f 7e f5 74 93 72  |....pr..Q..~.t.r|
+00000040  1a c5 c3 29 7c 15 03 03  00 40 00 00 00 00 00 00  |...)|....@......|
+00000050  00 00 00 00 00 00 00 00  00 00 ba 82 2e f5 da 08  |................|
+00000060  e8 53 81 54 b9 00 1b 58  91 1d c2 f6 f5 03 f8 55  |.S.T...X.......U|
+00000070  c0 9e ee b9 83 ef 3c ff  2c d0 38 0c 41 c3 24 f9  |......<.,.8.A.$.|
+00000080  c2 98 64 b0 73 8f eb 67  f9 b8                    |..d.s..g..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4 b/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4
index 200b5de1db..15ddf693e8 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4
+++ b/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4
@@ -9,11 +9,11 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 51 02 00 00  4d 03 03 0f 39 64 1d 46  |....Q...M...9d.F|
-00000010  66 7a ef d0 1a e3 1d 32  4c 01 77 39 53 ff 18 97  |fz.....2L.w9S...|
-00000020  4d 4f 40 cd 92 08 96 b6  82 08 24 20 57 7c 6a a7  |MO@.......$ W|j.|
-00000030  31 ea 2d 63 23 f1 4b c7  47 31 2f 1c 38 24 a9 e1  |1.-c#.K.G1/.8$..|
-00000040  f1 95 c1 2c 07 8b b3 42  64 db 24 8a 00 05 00 00  |...,...Bd.$.....|
+00000000  16 03 03 00 51 02 00 00  4d 03 03 4f 7d f5 58 ff  |....Q...M..O}.X.|
+00000010  e5 bb bc 25 94 2b be d7  85 62 7b 07 53 7d d2 28  |...%.+...b{.S}.(|
+00000020  fb 4a 26 e5 e2 f9 c8 22  28 7f 59 20 3d bf 46 07  |.J&...."(.Y =.F.|
+00000030  2c 89 95 ae f3 7d ae bc  d5 35 4a ef 3b 46 58 cc  |,....}...5J.;FX.|
+00000040  5e ed b7 61 a5 e1 e2 e7  24 5c ad f0 00 05 00 00  |^..a....$\......|
 00000050  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
 00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -63,15 +63,15 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 03 00 24 4c 3d  05 41 bc d3 29 7b d3 ac  |.....$L=.A..){..|
-000000a0  1a 92 0e 72 d3 eb ca 50  e4 15 e7 72 5f bc 6c f1  |...r...P...r_.l.|
-000000b0  d7 b4 64 33 2e b1 f3 59  53 93                    |..d3...YS.|
+00000090  01 16 03 03 00 24 27 99  56 77 84 61 43 cc 59 29  |.....$'.Vw.aC.Y)|
+000000a0  b2 ae a6 31 1a eb 1f 27  11 16 68 9b 79 c4 71 cc  |...1...'..h.y.q.|
+000000b0  97 56 2b 1e 1b 2b a6 a5  88 89                    |.V+..+....|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 24 ef 0e 94 f8 06  |..........$.....|
-00000010  f8 ad 02 ac d9 11 e4 80  b0 28 17 78 39 a9 76 e1  |.........(.x9.v.|
-00000020  62 7d 3b b3 0a c5 cd 79  21 e7 f5 7b 79 d4 e7     |b};....y!..{y..|
+00000000  14 03 03 00 01 01 16 03  03 00 24 de 0a aa e2 89  |..........$.....|
+00000010  c1 c2 ef 7e 8b 89 54 46  33 fc 62 50 5a 9a 93 28  |...~..TF3.bPZ..(|
+00000020  27 ed b0 5a 94 07 67 66  49 a4 54 ca a2 05 16     |'..Z..gfI.T....|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1a 5e a2 78  92 83 51 61 22 99 5f 67  |.....^.x..Qa"._g|
-00000010  b4 d7 8c 5d a5 32 bb 97  f9 62 f4 a9 18 53 df 15  |...].2...b...S..|
-00000020  03 03 00 16 a4 f2 17 9e  54 f2 b3 28 6a f9 c6 29  |........T..(j..)|
-00000030  47 4c 53 90 e8 7f 33 6e  b2 87                    |GLS...3n..|
+00000000  17 03 03 00 1a b4 8a e4  10 87 52 70 fd 05 ed 37  |..........Rp...7|
+00000010  6f 12 35 91 41 58 80 63  37 cc 59 52 a2 cd 3d 15  |o.5.AX.c7.YR..=.|
+00000020  03 03 00 16 b0 38 38 37  b1 f7 af f0 3a 0d d9 ea  |.....887....:...|
+00000030  eb 32 57 ce ff 36 fc 44  94 ac                    |.2W..6.D..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce
index 1b08053918..71f3006530 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce
@@ -9,11 +9,11 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 24 2e 0a 13 97  |....Y...U..$....|
-00000010  5a ca f1 1f 61 58 9e ab  ab ab e2 02 c6 12 36 44  |Z...aX........6D|
-00000020  e5 0b a4 9d 87 95 71 9f  8d af e1 20 fa 6b 55 37  |......q.... .kU7|
-00000030  1f 17 a4 3b 24 9c 4f d8  f9 e1 0d 15 a0 2a d2 db  |...;$.O......*..|
-00000040  41 eb 9e 43 9d 59 61 24  27 28 df fc c0 2f 00 00  |A..C.Ya$'(.../..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 d0 8f ad 7c 5c  |....Y...U.....|\|
+00000010  c1 51 df d4 b5 9f df 51  97 c9 5e 32 63 a1 c1 51  |.Q.....Q..^2c..Q|
+00000020  04 1f 16 56 c7 0a 7e ee  4d b7 35 20 e8 5f ae 69  |...V..~.M.5 ._.i|
+00000030  a3 ad f2 2d ba d3 c5 8c  07 b1 b9 38 39 b5 ef 1e  |...-.......89...|
+00000040  7a 5e 2d f0 63 7a 60 4f  43 10 07 e1 c0 2f 00 00  |z^-.cz`OC..../..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,19 +53,19 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  cd 0c 00 00 c9 03 00 17  41 04 9d 0b 44 e7 57 91  |........A...D.W.|
-000002d0  5f 24 93 7d cb f4 5a 8c  66 1f 55 ba fb 7e 95 47  |_$.}..Z.f.U..~.G|
-000002e0  58 65 b6 df d5 67 11 fe  98 39 c1 5d 39 fd ab 48  |Xe...g...9.]9..H|
-000002f0  17 19 78 15 22 ee a9 41  b2 e7 3f 0c 08 23 8d b5  |..x."..A..?..#..|
-00000300  77 b8 b4 aa 94 e3 1e cb  6e 31 04 01 00 80 c2 6d  |w.......n1.....m|
-00000310  39 91 f4 54 ef c0 73 8c  d2 cd 37 c8 b6 74 8c 12  |9..T..s...7..t..|
-00000320  87 bb 68 fb ac f1 ae a2  01 ed 1f 55 90 1f fb 92  |..h........U....|
-00000330  d3 a8 c3 ac 19 7e bf b6  e9 2e 2f 1d bd 4a fa 17  |.....~..../..J..|
-00000340  1e dc dd 41 c6 8d d4 3f  2d c3 13 0d d0 86 6f 8e  |...A...?-.....o.|
-00000350  74 5a 51 47 6e f2 18 f8  e2 ba de 75 1a 81 1c 3b  |tZQGn......u...;|
-00000360  f0 dc ab d8 5d 7a da 6e  91 d3 e5 f0 82 c3 be c9  |....]z.n........|
-00000370  c8 f0 c9 60 84 6f c3 59  7f 6b 7a b2 58 72 6b 79  |...`.o.Y.kz.Xrky|
-00000380  44 cc 04 82 86 ad 93 de  d1 11 c1 a4 be cd 16 03  |D...............|
+000002c0  cd 0c 00 00 c9 03 00 17  41 04 83 e4 35 de e3 59  |........A...5..Y|
+000002d0  fd 3c 52 7d 20 97 25 7d  1d c2 8b ad 46 af 18 9e  |.<R} .%}....F...|
+000002e0  70 d0 97 44 f0 92 c7 eb  74 2e 49 bd 32 63 2b 78  |p..D....t.I.2c+x|
+000002f0  c1 0c a9 70 31 1f a7 41  98 fb e8 71 a8 31 a7 6b  |...p1..A...q.1.k|
+00000300  53 27 34 72 e9 fd 7b f2  61 a6 04 01 00 80 26 22  |S'4r..{.a.....&"|
+00000310  53 23 07 76 1c df 3e 9a  57 15 a0 ff 9b 92 e4 6d  |S#.v..>.W......m|
+00000320  8a 8a 5a 5d a7 69 c2 09  bb 7d 1d 30 58 4e 7d 38  |..Z].i...}.0XN}8|
+00000330  de ec 97 52 eb 80 00 d6  20 cc 51 b7 3f 6c 8b 4a  |...R.... .Q.?l.J|
+00000340  f6 05 8e e5 15 63 98 24  da 10 17 dd aa 73 ab ff  |.....c.$.....s..|
+00000350  d0 55 1c cd b7 e8 fd cf  93 f1 13 62 14 e4 4a a0  |.U.........b..J.|
+00000360  bf 15 09 68 47 d7 6c 24  06 b3 62 ac c5 70 b5 6d  |...hG.l$..b..p.m|
+00000370  ae 54 95 d2 4b 49 51 3f  c6 cf 57 c5 dd 5d a5 b3  |.T..KIQ?..W..]..|
+00000380  9a bb df a6 98 43 a5 b3  65 dc 3e 15 31 e0 16 03  |.....C..e.>.1...|
 00000390  03 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
@@ -73,175 +73,177 @@
 00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 37 ca  |.....(........7.|
-00000060  4e 62 c8 3d 33 b1 2c 57  fd 47 b0 78 5f e3 ac ee  |Nb.=3.,W.G.x_...|
-00000070  ae 3d ad 74 a8 2c ee b1  e8 b7 ff 6f 35 c7        |.=.t.,.....o5.|
+00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 29 1e  |.....(........).|
+00000060  f5 7d 69 cf 87 63 a7 68  94 5b 63 79 ea 69 cb 18  |.}i..c.h.[cy.i..|
+00000070  93 ce c5 8a 6d 08 12 5a  25 29 b6 e3 8e d9        |....m..Z%)....|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 6b be a8 12 9c  |..........(k....|
-00000010  7f 20 af 07 a8 dd e0 c7  bc 45 b1 ba 32 c1 df 3e  |. .......E..2..>|
-00000020  d5 a1 a8 56 1b 1a 69 d1  ac c7 bc 75 79 f7 6a ce  |...V..i....uy.j.|
-00000030  83 22 78                                          |."x|
+00000000  14 03 03 00 01 01 16 03  03 00 28 dc 61 07 b0 47  |..........(.a..G|
+00000010  de b3 54 36 57 08 d0 3b  03 8d a0 bc d5 d9 33 44  |..T6W..;......3D|
+00000020  2c e6 0e 83 d2 2b 76 68  79 40 3d bd dc 94 b3 78  |,....+vhy@=....x|
+00000030  f3 a9 90                                          |...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 40 90 1f  |.............@..|
-00000010  c0 46 3a 8b af a2 54 69  9d 90 90 49 da ad ff 53  |.F:...Ti...I...S|
-00000020  91 e7 65                                          |..e|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 f9 c2 34  |...............4|
+00000010  5f 2a 2d ed 0a b4 ad 06  df b0 a9 b8 d4 c0 c8 40  |_*-............@|
+00000020  86 c8 12                                          |...|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 1c 6b be a8  12 9c 7f 20 b0 28 6b 34  |.....k..... .(k4|
-00000010  63 e8 5e 88 ef f0 79 bb  af 67 f6 f7 08 fe 7f d5  |c.^...y..g......|
-00000020  5c                                                |\|
+00000000  16 03 03 00 1c dc 61 07  b0 47 de b3 55 e6 b0 75  |......a..G..U..u|
+00000010  46 b3 e7 a0 f2 83 e9 18  cf 06 1d 3c 31 a2 ba a7  |F..........<1...|
+00000020  80                                                |.|
 >>> Flow 7 (client to server)
-00000000  16 03 03 00 af 00 00 00  00 00 00 00 02 01 a6 70  |...............p|
-00000010  01 49 e5 57 72 ad db 39  c6 d6 63 27 9a 8b d3 13  |.I.Wr..9..c'....|
-00000020  06 15 ef ea 59 6c eb e4  a4 e3 7d 98 84 b9 60 6f  |....Yl....}...`o|
-00000030  f9 ad 01 a1 20 e0 43 a4  58 c8 c6 da f4 1c 06 2c  |.... .C.X......,|
-00000040  51 1a 70 b7 d2 8b ed c3  f7 ce f4 17 e5 82 d2 3e  |Q.p............>|
-00000050  1e f0 23 62 60 2e 21 b3  5b 99 ac b8 f6 11 40 fb  |..#b`.!.[.....@.|
-00000060  b9 51 17 ac ab ac b4 ff  f9 b0 27 d3 a8 2e 41 4f  |.Q........'...AO|
-00000070  fe e3 64 3c bd 34 6a e1  18 64 bd 5f 24 b4 3b 57  |..d<.4j..d._$.;W|
-00000080  4e 4e 8e a0 b0 3d 50 e3  b0 d2 bc 45 d7 84 4f 11  |NN...=P....E..O.|
-00000090  fd 6a 52 0d a9 36 9f 0e  57 4f 43 24 50 12 b8 ba  |.jR..6..WOC$P...|
-000000a0  b4 30 4f 21 3d de 56 af  3d 6d 07 32 b9 4c 32 95  |.0O!=.V.=m.2.L2.|
-000000b0  c6 eb 6c a6                                       |..l.|
+00000000  16 03 03 00 af 00 00 00  00 00 00 00 02 cc 27 82  |..............'.|
+00000010  46 a9 cf ee e3 94 6b 8b  a9 e2 08 e1 b9 f1 60 c8  |F.....k.......`.|
+00000020  57 46 61 c0 7a a8 d1 31  1e 6f 0c d0 5b 29 ca 85  |WFa.z..1.o..[)..|
+00000030  86 42 ba 0b df 5e d2 87  6e 86 43 3f 99 42 5d b2  |.B...^..n.C?.B].|
+00000040  65 1d f7 a8 fb 6e 93 58  c7 52 ec a6 b8 ef d7 69  |e....n.X.R.....i|
+00000050  7b 3a f4 a5 db 3b bd 2c  1a d6 8d 3b db 18 be 33  |{:...;.,...;...3|
+00000060  b1 c7 57 d3 6a 70 41 ff  86 08 ce b8 69 e8 20 29  |..W.jpA.....i. )|
+00000070  c5 42 e5 bd d0 e5 0a 90  dd fb ae cf dc f1 f5 87  |.B..............|
+00000080  24 88 bb 5d 98 8f dd 4b  c4 df 1c 8c 4c 30 19 ee  |$..]...K....L0..|
+00000090  22 7b 34 f7 e1 b7 94 38  62 35 a4 b5 24 dd bb 10  |"{4....8b5..$...|
+000000a0  47 09 18 71 7f ba fc 49  79 40 ca 98 d7 a7 53 b6  |G..q...Iy@....S.|
+000000b0  8d 07 5e 75                                       |..^u|
 >>> Flow 8 (server to client)
-00000000  16 03 03 00 89 6b be a8  12 9c 7f 20 b1 ac ca 6b  |.....k..... ...k|
-00000010  51 a3 1e 19 95 56 8f 88  ee 40 fa 47 7d f6 30 29  |Q....V...@.G}.0)|
-00000020  2f 26 4c 22 04 41 07 76  f1 3a 1b b0 98 46 93 36  |/&L".A.v.:...F.6|
-00000030  d8 02 bd b9 82 f4 34 4f  7e 45 10 4e 14 53 31 c7  |......4O~E.N.S1.|
-00000040  3e 1e 74 f3 29 5e cf 77  39 76 9e 00 fd 1f 2a 3c  |>.t.)^.w9v....*<|
-00000050  63 b1 fa c7 a6 31 a4 76  ea e8 95 af 5a 56 fc 23  |c....1.v....ZV.#|
-00000060  03 15 0a 79 14 fd 6c 83  0b 82 db 6a 1d a4 c1 19  |...y..l....j....|
-00000070  9d 3c 3d ea e2 f1 04 82  6c b3 27 00 3b 51 8d 74  |.<=.....l.'.;Q.t|
-00000080  86 b6 d0 d7 81 f3 da 0d  bf bf bd 57 c3 a9 16 03  |...........W....|
-00000090  03 02 71 6b be a8 12 9c  7f 20 b2 3d 86 e6 bb 0e  |..qk..... .=....|
-000000a0  35 57 79 c3 ea 0a 90 cf  0f ef 36 9f 3f 1f f8 de  |5Wy.......6.?...|
-000000b0  56 2e f5 b8 8c a7 ac 59  cb 59 dc ec c1 ae d4 22  |V......Y.Y....."|
-000000c0  25 2f 53 c9 d1 e0 fc 94  9f b6 ef a5 21 6e 90 11  |%/S.........!n..|
-000000d0  04 48 6a a6 ca 00 78 7d  ff 87 cd 04 0b 01 9a da  |.Hj...x}........|
-000000e0  c6 90 cd 24 fe cb 83 5a  9a 4d 3a 1d 90 a2 49 ca  |...$...Z.M:...I.|
-000000f0  3a 50 98 c1 68 36 d8 b9  4e 3e 2b c9 9e a9 1a a3  |:P..h6..N>+.....|
-00000100  95 b3 d7 cd b7 83 58 5f  a2 a1 1d ee e4 89 be ab  |......X_........|
-00000110  1f f0 36 13 1d 69 22 60  e1 1b d7 0b b7 3d 32 4a  |..6..i"`.....=2J|
-00000120  43 3e 77 16 42 ff 42 2c  55 7c 62 14 37 21 23 88  |C>w.B.B,U|b.7!#.|
-00000130  e1 e3 34 4a 6f 1e d9 b4  ca ca 95 10 4b 0b fc 4a  |..4Jo.......K..J|
-00000140  57 be e8 cf e1 2c c7 09  68 0b b3 a1 cf 6f f4 d6  |W....,..h....o..|
-00000150  ea bf d9 a4 95 40 e4 4b  54 59 02 8f 00 48 28 42  |.....@.KTY...H(B|
-00000160  3c 51 8e 6b 61 b8 2e 9a  8a ad c1 2e 0c 32 6a b1  |<Q.ka........2j.|
-00000170  bb de 29 3e 41 5f d9 c7  e3 ad 59 60 cb ae 63 95  |..)>A_....Y`..c.|
-00000180  82 c6 de 53 bd 90 a8 0b  f3 68 36 68 82 40 86 53  |...S.....h6h.@.S|
-00000190  a9 4c 7b f3 f4 ae 98 a4  4b fb fd a7 5b 81 f0 dc  |.L{.....K...[...|
-000001a0  ad dc a6 e2 90 8a 4e 8c  61 8d 6f cc 29 c4 5d 05  |......N.a.o.).].|
-000001b0  9b 99 0a df a1 e2 dd a0  f6 4e e1 54 4f 7f a7 73  |.........N.TO..s|
-000001c0  6c ec cc 31 f8 fe aa f3  e7 ce a0 7c 67 74 25 f5  |l..1.......|gt%.|
-000001d0  ba a4 33 92 2a c1 51 b2  0c 31 ea 6f 80 18 13 3c  |..3.*.Q..1.o...<|
-000001e0  0a b1 b2 8b bc 1b fd 6e  4c 84 2d 42 95 15 5c 73  |.......nL.-B..\s|
-000001f0  9b 06 c5 4a dd f5 59 f4  28 c0 d5 40 26 03 a1 d1  |...J..Y.(..@&...|
-00000200  13 03 67 23 78 c0 c5 02  8e 42 0d 98 60 3c c9 9e  |..g#x....B..`<..|
-00000210  49 86 1a a1 6e d1 3a 66  3a 13 15 37 d3 e8 ca d0  |I...n.:f:..7....|
-00000220  ee 2e 17 1b 37 6a dd 00  c3 b2 e8 9c 0d 91 d2 3e  |....7j.........>|
-00000230  3f cd 6d e3 f1 5c 45 30  94 be cf 65 54 c5 66 26  |?.m..\E0...eT.f&|
-00000240  e0 d3 46 9f f2 ba 67 30  90 c0 1b 58 05 1c 98 b1  |..F...g0...X....|
-00000250  8a a6 02 5c 5a f1 ec a0  d2 74 71 4c a3 15 f8 a7  |...\Z....tqL....|
-00000260  34 d6 9c dd 31 b1 5e 4e  97 7f 1d c5 31 7f c1 cb  |4...1.^N....1...|
-00000270  8b 3c 88 6a 96 71 a0 a3  8e d8 7a 0a ed 67 f5 04  |.<.j.q....z..g..|
-00000280  1d 47 ab db bf 3e f6 f6  c8 6e 55 6f e9 9a bf b4  |.G...>...nUo....|
-00000290  8f 8b ac 9c 56 3d e0 37  8d 85 02 06 1e 5b 52 d3  |....V=.7.....[R.|
-000002a0  ba 75 70 33 da c0 d9 77  a1 59 30 75 a1 6f 4e dc  |.up3...w.Y0u.oN.|
-000002b0  ba da 4d 7b bc b5 8d b5  74 6a bc 64 82 d5 cf 41  |..M{....tj.d...A|
-000002c0  88 dc 0a 6c 9b 36 46 5b  e9 2e 62 b7 1a 44 57 6f  |...l.6F[..b..DWo|
-000002d0  e7 28 bc 47 91 25 2e 56  d6 08 df c0 b5 9e ee fe  |.(.G.%.V........|
-000002e0  bd c5 cf f4 94 ab 03 30  8d a9 a7 d0 eb b8 a4 96  |.......0........|
-000002f0  dd 58 35 4f 4e fb 49 11  39 e3 a3 46 06 0b 2a f2  |.X5ON.I.9..F..*.|
-00000300  d9 29 08 1c 16 03 03 00  e5 6b be a8 12 9c 7f 20  |.).......k..... |
-00000310  b3 5a a8 60 49 b5 0f 3d  50 bf 81 17 ca 25 2d 91  |.Z.`I..=P....%-.|
-00000320  07 bd 01 ef bc 13 df 67  50 c4 7d aa 87 af b4 30  |.......gP.}....0|
-00000330  95 08 a9 1a 86 f2 60 d9  85 28 11 1c 3c 31 81 5d  |......`..(..<1.]|
-00000340  3c 83 b0 3c 0d 59 11 8b  3b d6 76 f4 64 98 d2 4c  |<..<.Y..;.v.d..L|
-00000350  09 f5 fc 4a 43 d6 e8 5c  c5 f7 ed c2 7f 35 df 96  |...JC..\.....5..|
-00000360  3d ca a8 59 58 e4 22 c7  58 99 40 ee c7 71 fb 8d  |=..YX.".X.@..q..|
-00000370  14 14 42 db 12 fa a8 0e  9f 45 d3 29 73 7f bf a0  |..B......E.)s...|
-00000380  20 30 8f 2f 93 f1 45 44  3a 30 28 4a fd 5b 49 49  | 0./..ED:0(J.[II|
-00000390  46 6d 71 ef b7 77 7d 83  0a 62 a0 82 d3 4d c1 69  |Fmq..w}..b...M.i|
-000003a0  7b 79 a6 92 79 4d 6b 6d  f3 e7 e3 75 c0 30 b3 83  |{y..yMkm...u.0..|
-000003b0  b9 d4 1d 0b 23 18 e6 79  87 c7 af 3e 18 23 2f 6e  |....#..y...>.#/n|
-000003c0  95 12 54 8a fb 9f 9f c0  df f9 9e 06 67 a0 d7 85  |..T.........g...|
-000003d0  71 56 8a 52 1c aa 3a 3f  9e 5e bb 25 16 7d ef 8e  |qV.R..:?.^.%.}..|
-000003e0  58 fd 83 7b be 8e e4 d5  26 53 3e 03 f7 67 16 03  |X..{....&S>..g..|
-000003f0  03 00 46 6b be a8 12 9c  7f 20 b4 6e d6 b0 9c 25  |..Fk..... .n...%|
-00000400  b0 f6 49 1e 44 5f 96 3d  72 8c c8 71 9b 0a 15 61  |..I.D_.=r..q...a|
-00000410  f2 0c df 14 1b 59 9b 88  5d f2 04 83 3e 42 56 15  |.....Y..]...>BV.|
-00000420  55 8b 47 13 be f5 7f 61  81 22 c1 32 b7 59 8c 59  |U.G....a.".2.Y.Y|
-00000430  68 a2 be ad e1 05 36 be  22                       |h.....6."|
+00000000  16 03 03 00 89 dc 61 07  b0 47 de b3 56 aa 83 11  |......a..G..V...|
+00000010  cb 18 ad c3 f8 44 c0 d3  34 2f f1 dc 97 86 59 ec  |.....D..4/....Y.|
+00000020  f9 f6 ff dd 09 84 9a f0  7b 77 93 24 06 1d 58 6f  |........{w.$..Xo|
+00000030  80 93 9b 10 fc ad 65 22  62 4a ad 31 2d 2e 8b 17  |......e"bJ.1-...|
+00000040  f8 09 dc aa f4 67 86 db  28 14 d1 36 3c e7 60 1a  |.....g..(..6<.`.|
+00000050  4b 1e 2c f0 d6 ce 34 d6  ee 6a 5e 92 bd e5 3e d8  |K.,...4..j^...>.|
+00000060  de 7a e9 03 69 5d 28 4e  d6 7c ef 1b 4b da ed 80  |.z..i](N.|..K...|
+00000070  3c 39 17 ea 36 6a 71 2c  12 7b 63 19 4c 5d 65 b2  |<9..6jq,.{c.L]e.|
+00000080  3f 55 9b 65 86 0f 73 2a  a7 b8 a4 2e ab 83 16 03  |?U.e..s*........|
+00000090  03 02 71 dc 61 07 b0 47  de b3 57 38 03 44 38 6f  |..q.a..G..W8.D8o|
+000000a0  8b e4 93 68 fe 4b 58 09  de 5f c1 9e 6c ab bf 65  |...h.KX.._..l..e|
+000000b0  70 37 b1 12 46 e7 eb e2  86 26 67 0a 30 e9 91 09  |p7..F....&g.0...|
+000000c0  7a 4c d4 bb 01 52 5b 77  a8 61 69 5e 8b 1b 03 a6  |zL...R[w.ai^....|
+000000d0  97 7f b0 6e 71 9d d4 32  3f df 71 35 5c 83 6e bc  |...nq..2?.q5\.n.|
+000000e0  ed ac cb 54 90 d1 f6 1b  6e 15 cf 4a a5 b1 0a 85  |...T....n..J....|
+000000f0  01 0c b5 cf ae 9e 41 7e  bc 59 81 53 64 af f7 5c  |......A~.Y.Sd..\|
+00000100  f9 07 be d7 35 01 b6 1d  1e 0f 74 4e 38 5b f6 6c  |....5.....tN8[.l|
+00000110  02 74 a5 04 10 e9 6c 55  89 f6 e7 3d f7 2a a1 62  |.t....lU...=.*.b|
+00000120  3e 2d 0e c6 6d 12 0a db  95 6d 38 a0 a0 13 c8 88  |>-..m....m8.....|
+00000130  c8 7d f1 a9 9e bd 0c cb  0a af 5a 07 3d ee 5e 2e  |.}........Z.=.^.|
+00000140  74 18 ca 5b c6 f0 d3 57  9d ea fb 74 8e 6f a2 70  |t..[...W...t.o.p|
+00000150  09 69 e2 e5 92 c0 83 2e  2c df 16 9d 71 a4 29 51  |.i......,...q.)Q|
+00000160  c8 e9 13 c6 fc 2b 4b 4d  ad cf d9 0a 47 8e ae d3  |.....+KM....G...|
+00000170  0a 88 aa f8 28 be 88 dc  b1 d3 03 a0 23 7d f6 f7  |....(.......#}..|
+00000180  cd d1 81 fe b6 6a a4 7c  21 d4 c7 3d 5e 17 83 b6  |.....j.|!..=^...|
+00000190  ce cd 45 6e ed 3c d1 f3  e2 a8 68 6e 91 b1 e7 4e  |..En.<....hn...N|
+000001a0  35 60 df c7 e6 cb e2 c8  c6 2d 68 d7 4d 8c ac c3  |5`.......-h.M...|
+000001b0  71 6b 46 a0 c3 7d a0 59  22 01 ed 26 6d e2 d2 4c  |qkF..}.Y"..&m..L|
+000001c0  8c b9 94 17 18 98 96 a2  52 ec 24 b7 f3 09 5e e4  |........R.$...^.|
+000001d0  89 f8 23 f3 73 5f 3c 3d  15 67 05 c9 39 f7 71 88  |..#.s_<=.g..9.q.|
+000001e0  9e 86 18 2e ae 47 4f 3e  d7 2c fa 29 f1 c0 58 94  |.....GO>.,.)..X.|
+000001f0  5f 37 26 1c f1 87 5c b5  fb c4 4d 9e ae 17 40 7c  |_7&...\...M...@||
+00000200  fa e7 b6 e8 9c 3a 43 13  8d 3c 00 5c 72 fc 40 c1  |.....:C..<.\r.@.|
+00000210  03 0f fd 4c c0 5b d8 42  30 6b 3a 05 85 05 9d db  |...L.[.B0k:.....|
+00000220  ab 34 00 d1 cd 6f 74 eb  d3 ed 49 f8 d3 ca 35 59  |.4...ot...I...5Y|
+00000230  90 d4 93 4e 04 8d 73 13  dc 21 de 40 94 2f d6 3a  |...N..s..!.@./.:|
+00000240  aa a1 47 94 18 3b 56 18  91 18 22 e7 56 e8 6c b4  |..G..;V...".V.l.|
+00000250  9f 47 09 b1 c4 8c ba 3d  45 8f b8 82 fa 03 61 df  |.G.....=E.....a.|
+00000260  55 9a 31 a8 03 13 ab b1  b0 38 68 7d e9 3e c0 bc  |U.1......8h}.>..|
+00000270  6c d8 75 8f 4c 10 09 07  3b 7e a5 dc ec 77 02 c4  |l.u.L...;~...w..|
+00000280  8d a0 ad 30 55 4d f8 8e  06 d4 47 ea 8a 29 ee 1d  |...0UM....G..)..|
+00000290  93 fb 51 17 3d 93 ab 57  34 1f 4d 85 90 fe e4 88  |..Q.=..W4.M.....|
+000002a0  ab 4a 0f 43 c4 b7 73 70  fc fe 46 db 59 79 f3 34  |.J.C..sp..F.Yy.4|
+000002b0  d1 48 61 a7 6b 45 bc e3  b7 9e 02 ce a0 c8 a8 4f  |.Ha.kE.........O|
+000002c0  01 7e bd 96 7f c3 5e 33  d8 1b 87 7f 7f 98 dc 60  |.~....^3.......`|
+000002d0  ff f8 41 3a 7d ea 40 71  ab 6f f3 fd eb b1 49 54  |..A:}.@q.o....IT|
+000002e0  91 35 f2 49 e0 59 86 f5  7d e0 47 b1 fd 03 f0 a4  |.5.I.Y..}.G.....|
+000002f0  69 a1 27 87 ef c7 a4 e3  b9 cf 5e 81 6a c0 86 19  |i.'.......^.j...|
+00000300  e1 e9 60 d2 16 03 03 00  e5 dc 61 07 b0 47 de b3  |..`.......a..G..|
+00000310  58 c5 55 fc 9d ec dd 21  9b 1c 21 1a 02 b2 a1 34  |X.U....!..!....4|
+00000320  e3 ea 8b f6 ff 85 e1 65  3f 3d f2 df 89 56 7f 76  |.......e?=...V.v|
+00000330  56 f1 de 1e 22 90 03 f7  32 74 67 64 54 ce cd 05  |V..."...2tgdT...|
+00000340  39 b0 48 c9 d6 fd 07 bd  a3 e5 5d ea 54 68 95 23  |9.H.......].Th.#|
+00000350  72 0b ec 1b 22 b4 9e 09  98 be c7 c3 03 ce 97 95  |r..."...........|
+00000360  c0 31 d8 c1 48 b3 bc b8  76 69 19 1a 8a eb 41 08  |.1..H...vi....A.|
+00000370  c2 a2 b1 f6 fb d9 01 1e  12 22 a4 90 12 97 61 f0  |........."....a.|
+00000380  79 5b cc 82 5c 3c d0 38  28 1c 70 d2 24 f5 02 4c  |y[..\<.8(.p.$..L|
+00000390  b9 dc f3 6f 10 e7 63 7d  2a e5 7c b1 55 37 b1 37  |...o..c}*.|.U7.7|
+000003a0  b3 7d 67 d7 06 b7 83 a0  f9 e9 e5 40 f2 6a 52 ee  |.}g........@.jR.|
+000003b0  70 06 c2 92 bc 0c c3 55  ff 73 98 58 f6 c7 4d 50  |p......U.s.X..MP|
+000003c0  8b fe 69 ac ae 7e bf 7e  22 33 11 0c e3 e4 04 65  |..i..~.~"3.....e|
+000003d0  aa 71 4c 52 0b 3c a8 c3  d1 a2 77 2b 03 e7 b6 72  |.qLR.<....w+...r|
+000003e0  53 d5 c9 f2 3a 88 51 01  26 f0 15 92 ca ed 16 03  |S...:.Q.&.......|
+000003f0  03 00 42 dc 61 07 b0 47  de b3 59 a9 38 ea 5e a2  |..B.a..G..Y.8.^.|
+00000400  dc 8e 61 8a 36 8b df 7d  94 cc 9e 4d b5 e7 ed 98  |..a.6..}...M....|
+00000410  70 1f b6 05 a4 92 98 e3  81 56 ae fe cf 60 90 71  |p........V...`.q|
+00000420  7d e1 b3 52 71 2a 41 b2  88 47 3e bb f9 83 40 1a  |}..Rq*A..G>...@.|
+00000430  1b dd 4d cd e0 16 03 03  00 1c dc 61 07 b0 47 de  |..M........a..G.|
+00000440  b3 5a 6c e8 c1 8f e5 32  03 e9 2d 9f 5e b9 a1 03  |.Zl....2..-.^...|
+00000450  30 08 89 eb 60 2d                                 |0...`-|
 >>> Flow 9 (client to server)
-00000000  16 03 03 02 71 00 00 00  00 00 00 00 03 d8 60 1e  |....q.........`.|
-00000010  b5 63 15 89 4b 48 76 a0  68 68 ff 3e eb 36 e8 05  |.c..KHv.hh.>.6..|
-00000020  e4 fb 3d 35 94 88 93 9f  aa f5 30 3f cf 6a 3f fc  |..=5......0?.j?.|
-00000030  1e c4 bd 71 d8 e9 de 64  92 d0 0f 49 70 f5 1b 3e  |...q...d...Ip..>|
-00000040  ac 8f 00 53 3b d7 65 b8  ef 95 80 29 9f 59 f4 3e  |...S;.e....).Y.>|
-00000050  a5 cc 35 00 b1 04 ef 0b  79 d2 22 39 0c 1e 07 96  |..5.....y."9....|
-00000060  a6 d1 01 18 2f 38 a7 96  c5 e6 5b 3d f4 04 f9 92  |..../8....[=....|
-00000070  b1 1d 4d 4c a6 50 5c dd  28 f9 41 25 9d 05 90 7d  |..ML.P\.(.A%...}|
-00000080  3f da 37 c8 92 45 ff 18  e6 79 da ee 32 e1 0c ff  |?.7..E...y..2...|
-00000090  36 d8 ee ea e8 04 0b ad  7e 9f e7 53 9d b9 10 91  |6.......~..S....|
-000000a0  02 69 71 b0 2d 9a 67 0c  75 27 48 16 db 0c 41 68  |.iq.-.g.u'H...Ah|
-000000b0  4d 50 5b 24 c4 2d 94 54  23 9b ff 8c fc 40 28 45  |MP[$.-.T#....@(E|
-000000c0  22 a6 75 1b d8 82 07 61  33 d7 69 4b 7b 97 c2 70  |".u....a3.iK{..p|
-000000d0  a2 30 93 7a 4f 66 13 03  d3 9a 5d ee f9 74 7e 26  |.0.zOf....]..t~&|
-000000e0  46 31 0f c6 27 42 ba f9  ea 4d 30 37 4e 22 3f 20  |F1..'B...M07N"? |
-000000f0  79 4d 0b a1 55 dd 72 45  2f af 17 d0 d7 19 22 93  |yM..U.rE/.....".|
-00000100  4e 15 50 01 df 69 79 82  c6 35 a4 30 4e ca 1f d8  |N.P..iy..5.0N...|
-00000110  06 c9 f2 03 3c a1 95 3e  18 e9 6c 46 2e fc 61 b4  |....<..>..lF..a.|
-00000120  90 6f 07 70 dc 9f eb a8  f1 a5 5e ed 07 26 24 e9  |.o.p......^..&$.|
-00000130  6f ee 34 39 03 e0 2d da  b2 bf e2 b7 8a 89 d4 49  |o.49..-........I|
-00000140  b6 40 56 81 59 b6 81 6a  a9 92 71 f7 f3 16 c8 cc  |.@V.Y..j..q.....|
-00000150  da bb 7f 54 fd 5f 6d 36  52 f6 da f5 2b fa 3d 1b  |...T._m6R...+.=.|
-00000160  05 4c a7 04 0d 0b 04 6c  73 8a 22 c2 3b 4b e6 12  |.L.....ls.".;K..|
-00000170  7e 0d 7c 4e c1 20 4d d8  fd e9 3b 8a 38 33 7d e2  |~.|N. M...;.83}.|
-00000180  10 9b 38 40 4c 50 c9 82  53 4d c3 da cf 6c 13 45  |..8@LP..SM...l.E|
-00000190  0e cc 89 bf 1f ae 83 06  2b 09 c0 69 7e 72 23 e3  |........+..i~r#.|
-000001a0  c9 8f 45 d4 fa 19 98 f3  c8 a1 d7 15 a4 e6 08 9b  |..E.............|
-000001b0  83 3f fd b5 7d 8f b1 b4  e4 5f 87 01 a0 e3 27 6a  |.?..}...._....'j|
-000001c0  e1 59 7c 46 0d eb 7c a3  ba e6 95 ad de f2 5b 72  |.Y|F..|.......[r|
-000001d0  61 c6 a6 14 31 f9 3b 03  d8 62 88 0e 44 78 b3 0f  |a...1.;..b..Dx..|
-000001e0  78 5e b7 63 58 3c c5 ae  2c 0c 3d 8e 38 84 dc 29  |x^.cX<..,.=.8..)|
-000001f0  c1 d0 1c 8d e7 97 8c 29  7a c3 82 02 6b 1f c0 0d  |.......)z...k...|
-00000200  c4 a0 fa 58 3a 2c e0 d4  7a 50 16 d6 ac d7 ef db  |...X:,..zP......|
-00000210  a6 56 7b eb 5b 82 c7 98  73 8d d6 64 ed 5b ae e7  |.V{.[...s..d.[..|
-00000220  c6 20 38 80 ca d1 39 36  d8 e9 4f 88 e1 ec f9 5c  |. 8...96..O....\|
-00000230  37 44 85 22 f2 ea fb 2e  e5 1c e3 e7 c7 7b 89 3f  |7D.".........{.?|
-00000240  b1 ce 79 cb f6 a6 9e e1  93 a2 00 d8 92 74 e9 b5  |..y..........t..|
-00000250  f8 42 a4 db e4 c8 20 66  aa 7c 07 c4 51 47 a1 93  |.B.... f.|..QG..|
-00000260  30 44 2d 76 31 96 57 c6  d8 56 0b 86 ec 60 04 12  |0D-v1.W..V...`..|
-00000270  df e1 bd 08 a3 12 16 03  03 00 5e 00 00 00 00 00  |..........^.....|
-00000280  00 00 04 07 11 86 09 09  10 67 9a 92 bc a2 c2 e0  |.........g......|
-00000290  61 ae 42 88 0f 6f b5 ac  ce 12 2f 50 c2 df 68 28  |a.B..o..../P..h(|
-000002a0  b6 cf 3b 96 8a 5e 24 e4  89 24 61 0e ed e7 7e 62  |..;..^$..$a...~b|
-000002b0  4c 0d 16 75 53 d1 aa 18  78 5b bd c6 86 3b cd 75  |L..uS...x[...;.u|
-000002c0  bb 79 d0 03 58 b6 88 db  5b 65 1c be 07 c3 e0 87  |.y..X...[e......|
-000002d0  82 3f 63 0f 69 7c 51 db  14 16 03 03 00 a0 00 00  |.?c.i|Q.........|
-000002e0  00 00 00 00 00 05 ce ef  43 c5 92 c0 7a 3a 52 58  |........C...z:RX|
-000002f0  b1 2d c5 1a 81 64 28 de  85 30 d2 ce c0 cc cd f5  |.-...d(..0......|
-00000300  63 ae 2c 0d 83 4b 4f 18  b3 bb 56 1a 2f fb 2a 9b  |c.,..KO...V./.*.|
-00000310  cd 95 2b 3d 97 76 61 41  00 30 90 8c 3c f0 ed 2d  |..+=.vaA.0..<..-|
-00000320  be 10 6e e9 4f df 0a ba  63 63 8d 57 8f 67 b5 d0  |..n.O...cc.W.g..|
-00000330  f7 18 34 5d c1 a1 c2 b2  6a aa c3 86 1e d0 e9 9b  |..4]....j.......|
-00000340  a6 52 81 09 3d 57 df f2  e7 ff a0 68 69 bc a0 2c  |.R..=W.....hi..,|
-00000350  64 c3 fe 19 5b 34 86 94  60 d2 ef 7e 7e 9b 80 2b  |d...[4..`..~~..+|
-00000360  09 65 58 02 7c a8 34 31  de 40 0c 56 12 34 5f 95  |.eX.|.41.@.V.4_.|
-00000370  42 77 06 fb fb 94 e5 15  7a 0c 09 17 47 d2 14 03  |Bw......z...G...|
-00000380  03 00 19 00 00 00 00 00  00 00 06 91 c8 31 cf f8  |.............1..|
-00000390  95 ed 07 68 c4 1c 39 2c  33 16 1f e8 16 03 03 00  |...h..9,3.......|
-000003a0  28 00 00 00 00 00 00 00  00 24 86 17 13 83 e0 8d  |(........$......|
-000003b0  cf d0 3a e7 66 18 f0 4c  53 16 a1 77 6d ab 65 b9  |..:.f..LS..wm.e.|
-000003c0  8d 12 cc 5b 4b f6 29 df  17                       |...[K.)..|
+00000000  16 03 03 02 71 00 00 00  00 00 00 00 03 c8 62 78  |....q.........bx|
+00000010  36 de 67 bf c2 e0 5e 6d  d3 d5 9b 78 9d d8 a3 ee  |6.g...^m...x....|
+00000020  dc 87 9d dc f9 c4 07 a1  fa 5a 6c 5c 4a 3a 77 4d  |.........Zl\J:wM|
+00000030  5e ac 07 7a 10 f1 d4 00  3d 91 97 17 28 aa 08 61  |^..z....=...(..a|
+00000040  ad 1c 55 61 ab 2f d7 21  c5 49 48 a5 f0 5e c9 30  |..Ua./.!.IH..^.0|
+00000050  38 a3 ea ec 6b 51 8b 30  c9 e4 af b9 49 83 d3 69  |8...kQ.0....I..i|
+00000060  2a d5 97 75 c7 ec 6d 38  05 f6 a9 00 37 dd 73 bc  |*..u..m8....7.s.|
+00000070  45 a9 c2 d8 5b 55 54 93  11 4c 52 7d 0c 3b f2 50  |E...[UT..LR}.;.P|
+00000080  d7 70 c4 59 e6 42 f3 8a  45 79 15 f7 18 ce 7e d7  |.p.Y.B..Ey....~.|
+00000090  72 07 ec c7 77 2c 71 f1  38 de d4 f8 ce 80 e7 a9  |r...w,q.8.......|
+000000a0  ef 3b b4 e8 73 f4 10 ca  5b 03 f5 30 86 f1 c3 74  |.;..s...[..0...t|
+000000b0  83 ed 26 93 f3 71 35 59  58 e5 a1 be 40 14 2c 57  |..&..q5YX...@.,W|
+000000c0  8a b7 18 23 c5 e4 53 41  17 d0 a7 a7 d9 18 29 64  |...#..SA......)d|
+000000d0  48 5e 2a 70 da 1f 70 ac  3b b6 0c b2 2a da bd 38  |H^*p..p.;...*..8|
+000000e0  99 d5 cc 71 b1 2e 27 11  22 65 0d bd ca 73 dc ac  |...q..'."e...s..|
+000000f0  98 f0 48 54 c1 36 40 9e  11 87 05 77 18 31 80 09  |..HT.6@....w.1..|
+00000100  c1 1b df f8 20 cc 7b b3  80 93 fb f2 7c b7 30 32  |.... .{.....|.02|
+00000110  22 fa db af 2d 45 6e 3e  75 0d e8 85 9b ce 96 0f  |"...-En>u.......|
+00000120  99 f7 9c 4d 13 f6 08 20  ab 8a e2 f2 b7 08 3c fe  |...M... ......<.|
+00000130  2f 39 bb 9d 59 d7 14 f4  2e 94 c0 21 52 50 cf 59  |/9..Y......!RP.Y|
+00000140  0f b0 7e fa 9f 46 46 19  18 68 3a 0c ac 3b c6 79  |..~..FF..h:..;.y|
+00000150  b7 77 83 29 2d 1f 97 1d  7e 16 c6 7b 89 d0 75 45  |.w.)-...~..{..uE|
+00000160  be 7c a6 31 af e5 33 91  f1 e8 4f 5a 2c 58 e7 d4  |.|.1..3...OZ,X..|
+00000170  30 f1 19 8b 9c f5 11 3c  b1 49 78 af f1 f5 31 29  |0......<.Ix...1)|
+00000180  f0 9e 21 2d 45 a1 fb 4a  40 44 64 68 e4 2e 73 40  |..!-E..J@Ddh..s@|
+00000190  91 8d b4 a1 61 5f b7 ee  d1 87 f1 be 99 b5 b3 eb  |....a_..........|
+000001a0  1a b4 52 35 96 af 61 bd  d0 bc cd 41 8c 8b 96 3b  |..R5..a....A...;|
+000001b0  70 79 fb b0 e5 9b f6 cb  13 47 00 99 9d 87 cc 71  |py.......G.....q|
+000001c0  f2 a5 74 17 11 ba 3d 43  b0 d9 90 66 e7 0f d1 04  |..t...=C...f....|
+000001d0  8c 9d ff 4b 2d c9 1c d4  7d 6b 5f 5c d0 bb 61 a5  |...K-...}k_\..a.|
+000001e0  eb fb b1 6f 2a 25 41 aa  ef b7 92 f1 fe d7 b8 72  |...o*%A........r|
+000001f0  4e 7c f4 8a 1d fb 0e 6e  fd 39 04 93 c2 19 7e 95  |N|.....n.9....~.|
+00000200  55 62 7d c9 95 64 d2 3f  ba bd 3a 0a 3d a7 fd 2f  |Ub}..d.?..:.=../|
+00000210  70 86 a4 b6 4b c3 81 d5  fa 4a 17 6f 1f c5 e8 6d  |p...K....J.o...m|
+00000220  bc 2d 49 af f0 c8 d9 ea  62 0b 81 43 53 3c a5 79  |.-I.....b..CS<.y|
+00000230  44 ff 9e 62 78 63 de 7e  15 2a ec 91 d6 ae a3 2d  |D..bxc.~.*.....-|
+00000240  57 00 89 b2 43 06 5b bd  8c 3f ec 74 d6 b0 7d 6a  |W...C.[..?.t..}j|
+00000250  b5 c8 d0 13 e1 40 ce 3f  95 36 64 75 6d 61 e1 12  |.....@.?.6duma..|
+00000260  a5 53 90 7c 95 ef 15 40  3b ae 00 52 0c bd b5 80  |.S.|...@;..R....|
+00000270  96 e7 e2 d3 a3 d9 16 03  03 00 5e 00 00 00 00 00  |..........^.....|
+00000280  00 00 04 ed 6b 0e fe 2e  8d db a1 1b f4 2c 2a e6  |....k........,*.|
+00000290  b9 be 51 d5 8d d9 8c 09  36 ab 43 46 84 44 f0 43  |..Q.....6.CF.D.C|
+000002a0  da 85 cb c4 ab 31 a9 46  19 4a 6b c3 32 5b 32 14  |.....1.F.Jk.2[2.|
+000002b0  d5 ca 17 c7 30 aa c4 5c  17 38 f2 22 e6 8c cc 0e  |....0..\.8."....|
+000002c0  cd e6 4c b4 90 df 1a f1  04 6b ee 91 f3 29 04 ce  |..L......k...)..|
+000002d0  b7 9f 47 c6 15 9f f7 00  34 16 03 03 00 a0 00 00  |..G.....4.......|
+000002e0  00 00 00 00 00 05 15 10  0d 8b 37 50 ea 57 b2 80  |..........7P.W..|
+000002f0  99 7c 19 0a 5c 5f 2b 9d  aa 3d 07 55 b5 ad d2 e4  |.|..\_+..=.U....|
+00000300  f6 81 ac 2a 14 d7 ba f0  d9 f2 ca c5 68 b5 6b fa  |...*........h.k.|
+00000310  14 82 ee 15 a0 b4 64 53  61 83 de 32 d4 3a 94 3f  |......dSa..2.:.?|
+00000320  f5 aa 3f d6 db 95 02 55  20 1b cb 64 86 82 60 e2  |..?....U ..d..`.|
+00000330  b4 73 d2 34 b7 e5 25 aa  2d eb 4e 54 8e b6 62 d6  |.s.4..%.-.NT..b.|
+00000340  59 e4 e2 a3 55 bc c6 a7  7d bf ea 15 86 6d ff ab  |Y...U...}....m..|
+00000350  3c 66 9e 70 35 b8 e6 da  eb b8 1d 4c 42 f7 37 2c  |<f.p5......LB.7,|
+00000360  cc da 15 1c da 40 1e 8b  71 f6 1a c5 cc b1 58 d9  |.....@..q.....X.|
+00000370  3b 1e 9a 30 13 c4 5e dc  e8 66 9a 38 3d 1c 14 03  |;..0..^..f.8=...|
+00000380  03 00 19 00 00 00 00 00  00 00 06 0d be a5 be 34  |...............4|
+00000390  0d c7 d2 db 75 0a 66 e7  32 a4 60 d4 16 03 03 00  |....u.f.2.`.....|
+000003a0  28 00 00 00 00 00 00 00  00 15 8e c6 9c 8e 3e fe  |(.............>.|
+000003b0  f1 71 ff 38 df 7e 47 86  47 0e 07 93 6f 1c fc 3e  |.q.8.~G.G...o..>|
+000003c0  43 a9 55 73 14 f9 1a 03  cf                       |C.Us.....|
 >>> Flow 10 (server to client)
-00000000  14 03 03 00 19 6b be a8  12 9c 7f 20 b5 ab b8 9e  |.....k..... ....|
-00000010  f3 24 cd 36 cf ac 42 6e  4b 5e 48 3a c7 68 16 03  |.$.6..BnK^H:.h..|
-00000020  03 00 28 48 74 d1 24 fc  16 53 84 41 00 a0 53 54  |..(Ht.$..S.A..ST|
-00000030  57 fe dd 26 0b 06 d9 21  1a 54 f8 6a c7 0b 7c c5  |W..&...!.T.j..|.|
-00000040  44 3d 7a c1 9a ec 01 3f  7d 85 d7 17 03 03 00 21  |D=z....?}......!|
-00000050  48 74 d1 24 fc 16 53 85  cb 06 31 e3 d4 a1 2f c7  |Ht.$..S...1.../.|
-00000060  98 cf 56 62 9f c0 a1 eb  06 76 ab 3b e9 e5 f1 55  |..Vb.....v.;...U|
-00000070  06                                                |.|
+00000000  14 03 03 00 19 dc 61 07  b0 47 de b3 5b 79 38 7d  |......a..G..[y8}|
+00000010  3f e2 f7 da 0e 9b 06 de  96 d1 81 8c c6 75 16 03  |?............u..|
+00000020  03 00 28 51 d6 d7 c6 a9  7b ba 7d 50 af 15 35 ea  |..(Q....{.}P..5.|
+00000030  02 ee 38 f0 32 9b 6a 9c  8a a6 7a 11 58 9b ba 1d  |..8.2.j...z.X...|
+00000040  c2 c4 81 5c bd 84 be c3  af a9 c9 17 03 03 00 21  |...\...........!|
+00000050  51 d6 d7 c6 a9 7b ba 7e  eb 69 5a de 10 a7 46 bf  |Q....{.~.iZ...F.|
+00000060  a4 d9 05 fb 23 79 3e 3c  96 ea 02 56 4e b1 1c e3  |....#y><...VN...|
+00000070  b0                                                |.|
 >>> Flow 11 (client to server)
-00000000  15 03 03 00 1a 00 00 00  00 00 00 00 01 ab d8 53  |...............S|
-00000010  c0 34 01 ff f7 d8 20 95  c3 57 0e 03 6c 6e 9b     |.4.... ..W..ln.|
+00000000  15 03 03 00 1a 00 00 00  00 00 00 00 01 b5 05 b2  |................|
+00000010  56 10 fb 8d fd 54 39 85  f3 a8 0f f4 10 bf 5d     |V....T9.......]|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice
index c30a91c311..4f7ab0696c 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice
@@ -9,11 +9,11 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 ff 8b b6 9f 03  |....Y...U.......|
-00000010  af 3f 1d 4a 2e f2 54 03  82 b5 df af dd 2e 45 ed  |.?.J..T.......E.|
-00000020  d4 85 da fd f4 49 e0 ea  6b f1 4d 20 45 35 4f a7  |.....I..k.M E5O.|
-00000030  35 e8 78 9b fc 90 d9 ad  ec 08 bb 62 ff 19 e8 11  |5.x........b....|
-00000040  90 10 6d ee 80 3f dd dc  f4 57 e8 49 c0 2f 00 00  |..m..?...W.I./..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 ef 61 1c 86 c9  |....Y...U...a...|
+00000010  ee 30 91 d1 11 c7 da 05  50 0a a4 59 84 3a 7b 5d  |.0......P..Y.:{]|
+00000020  a0 12 7d 8e a7 7c 0b ad  b1 b4 24 20 04 66 50 88  |..}..|....$ .fP.|
+00000030  fd 57 a6 83 51 f9 1a b7  36 ce 96 f1 1b 08 24 95  |.W..Q...6.....$.|
+00000040  77 48 8d 53 b4 4a 17 a0  ce 21 42 41 c0 2f 00 00  |wH.S.J...!BA./..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,19 +53,19 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  cd 0c 00 00 c9 03 00 17  41 04 01 2e 60 6b 09 ff  |........A...`k..|
-000002d0  e2 7d 81 6a 2c 8f 1f 3c  54 17 e7 2b 6d 20 c7 b8  |.}.j,..<T..+m ..|
-000002e0  71 23 b5 4c b6 68 57 fb  1b 3b 9e 37 52 f9 dc cc  |q#.L.hW..;.7R...|
-000002f0  f1 93 f2 c6 01 d2 62 ae  2c 42 79 0a 54 bb 4d c3  |......b.,By.T.M.|
-00000300  ab d0 71 c5 70 45 b3 d2  f6 d5 04 01 00 80 01 ac  |..q.pE..........|
-00000310  27 c8 14 11 7b 53 4d d0  b5 94 d4 cf 12 fd 89 e0  |'...{SM.........|
-00000320  b9 15 ff 26 95 98 47 68  c0 fd 1e ac d5 18 29 be  |...&..Gh......).|
-00000330  79 a2 f7 f2 74 bc fc 54  77 8f 37 2d bf 2d 8d de  |y...t..Tw.7-.-..|
-00000340  c5 64 e1 e5 e8 f2 a0 3e  c0 ba 5e 6d 0a c9 2c dc  |.d.....>..^m..,.|
-00000350  b9 dd 88 7a 0f 53 93 40  57 2d 63 32 18 04 64 a3  |...z.S.@W-c2..d.|
-00000360  30 28 37 55 f9 8f a6 7b  49 7f 89 1b 74 05 34 b4  |0(7U...{I...t.4.|
-00000370  44 2e 9f bc 54 79 9c 60  aa 46 8c 5e b3 f4 e1 c5  |D...Ty.`.F.^....|
-00000380  11 02 94 3b ad c1 17 0e  f5 91 2a d9 2f a4 16 03  |...;......*./...|
+000002c0  cd 0c 00 00 c9 03 00 17  41 04 c7 1f 36 21 38 eb  |........A...6!8.|
+000002d0  e1 da bf e3 a5 92 ef 4d  45 4c 96 70 f1 3c 50 ee  |.......MEL.p.<P.|
+000002e0  4c d7 db f7 e0 31 e3 be  60 a3 f1 f7 e3 0a ce 51  |L....1..`......Q|
+000002f0  e7 bb 87 08 62 5d 70 26  14 2c 9f de 92 7f 42 7e  |....b]p&.,....B~|
+00000300  50 04 56 b1 0c c9 e1 4a  30 a8 04 01 00 80 25 6a  |P.V....J0.....%j|
+00000310  70 ee 08 92 9d 5e 8a 80  a8 bc 8d 2d 95 30 cb b2  |p....^.....-.0..|
+00000320  a4 5b eb 60 2e 96 28 54  6b 46 89 29 5d 6c de e6  |.[.`..(TkF.)]l..|
+00000330  6f 40 9e 04 d5 7a 1a e7  7a e1 79 b0 a3 c6 37 d3  |o@...z..z.y...7.|
+00000340  83 0f 10 8d f5 2f ba 6a  ee 71 4e 2a bd 8f 30 cc  |...../.j.qN*..0.|
+00000350  8f 2f a2 87 d6 7f 53 a0  d5 a2 73 76 08 d5 79 08  |./....S...sv..y.|
+00000360  ac 88 39 8b 07 ae 4a 01  b2 64 74 82 de ab d2 5d  |..9...J..dt....]|
+00000370  33 bf 5c fe 9d 02 22 46  2f fa 9a 2f fa 57 80 52  |3.\..."F/../.W.R|
+00000380  d1 bc 6a e5 cb 59 fa cc  e2 c8 d1 80 2d 64 16 03  |..j..Y......-d..|
 00000390  03 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
@@ -73,330 +73,334 @@
 00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 99 26  |.....(.........&|
-00000060  7a 42 8d 28 6d e8 96 9d  b3 d7 69 9b eb c6 4c 38  |zB.(m.....i...L8|
-00000070  6a 3c e4 e0 df de 6f f0  22 8a 78 4f e3 06        |j<....o.".xO..|
+00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 8e 77  |.....(.........w|
+00000060  d5 cd 3a 36 aa 0f b8 d4  92 20 be ca 3b f5 74 74  |..:6..... ..;.tt|
+00000070  7c 89 e6 8b a2 92 56 ca  ca 91 92 f0 20 44        ||.....V..... D|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 ad 26 44 4c 45  |..........(.&DLE|
-00000010  02 3d 8b 08 cb be 7c 41  78 c9 aa dc 0b a3 9a 17  |.=....|Ax.......|
-00000020  40 47 f2 16 8e ef 10 e1  f5 df 84 41 e6 0d 8c 3b  |@G.........A...;|
-00000030  72 67 cb                                          |rg.|
+00000000  14 03 03 00 01 01 16 03  03 00 28 f4 ab 49 aa 08  |..........(..I..|
+00000010  16 71 3b 0e fa 97 30 03  73 60 7e 73 e0 63 b4 38  |.q;...0.s`~s.c.8|
+00000020  b3 19 15 17 25 c4 f4 c1  0c b4 c9 3e e6 94 56 25  |....%......>..V%|
+00000030  3c a4 25                                          |<.%|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 97 db 95  |................|
-00000010  91 d6 6e 6c e8 a4 16 52  d5 05 ba de 4c 4c 0b 2d  |..nl...R....LL.-|
-00000020  2c 50 18                                          |,P.|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 df 72 ee  |..............r.|
+00000010  e7 65 97 48 d3 47 7a 3c  df 39 c7 29 00 14 09 41  |.e.H.Gz<.9.)...A|
+00000020  31 02 01                                          |1..|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 1c ad 26 44  4c 45 02 3d 8c 2d f2 b6  |......&DLE.=.-..|
-00000010  fd 7a ff 59 68 d0 da 7b  23 c3 db 0b 41 7c 6c ea  |.z.Yh..{#...A|l.|
-00000020  78                                                |x|
+00000000  16 03 03 00 1c f4 ab 49  aa 08 16 71 3c fc f2 15  |.......I...q<...|
+00000010  e0 e1 c8 dd 74 f8 33 af  25 f7 64 d1 d1 11 92 2a  |....t.3.%.d....*|
+00000020  b1                                                |.|
 >>> Flow 7 (client to server)
-00000000  16 03 03 00 af 00 00 00  00 00 00 00 02 9a cb f4  |................|
-00000010  b1 66 8d 51 81 9f 17 2e  f3 65 8d 12 e6 13 22 26  |.f.Q.....e...."&|
-00000020  16 90 4c e0 9c 5b fe 3b  90 53 be 58 b1 e8 ac dc  |..L..[.;.S.X....|
-00000030  5e b7 4c a6 c7 80 07 9a  bb 0d 88 aa 3f 14 88 fa  |^.L.........?...|
-00000040  07 04 89 2b 0a 8a d4 3d  62 90 1c d5 64 29 ef 3e  |...+...=b...d).>|
-00000050  e3 99 f0 10 1f f8 a4 15  91 3a c5 b0 5b 82 97 24  |.........:..[..$|
-00000060  96 58 43 a9 12 ef 33 cc  04 03 71 26 0a c9 2b 0b  |.XC...3...q&..+.|
-00000070  ca 97 6c 3a 6d 1d 07 43  6c b2 1d 26 ce 15 6c da  |..l:m..Cl..&..l.|
-00000080  c8 01 25 8c eb e5 c1 af  0f 08 14 6b f7 14 a6 7b  |..%........k...{|
-00000090  a6 64 e3 8c 15 28 07 27  ba 85 3f fa 23 72 1e e4  |.d...(.'..?.#r..|
-000000a0  9f e9 ec 92 1d ac 7b 65  27 7c bd 81 2d 83 24 f6  |......{e'|..-.$.|
-000000b0  ae 8b 9f 88                                       |....|
+00000000  16 03 03 00 af 00 00 00  00 00 00 00 02 97 1d 91  |................|
+00000010  65 55 ce 20 d9 30 4b 94  a2 37 f3 aa 4c aa 17 69  |eU. .0K..7..L..i|
+00000020  d3 af fd 28 52 ae 91 5d  c0 bc 8c 3b 54 68 98 16  |...(R..]...;Th..|
+00000030  72 f0 65 9f ad cd 78 d0  87 af 77 49 0b d4 73 22  |r.e...x...wI..s"|
+00000040  f9 ae e7 94 f6 63 6c 00  2d 32 2c 7b a9 e5 b5 12  |.....cl.-2,{....|
+00000050  43 ea 6e 04 44 f5 4f e7  c3 a9 bf 2c 13 fe 4e a6  |C.n.D.O....,..N.|
+00000060  97 f9 12 1d 54 75 6d e7  91 db f4 01 0d 5c 2d 7c  |....Tum......\-||
+00000070  c7 1f f7 98 68 ff 67 3f  c0 81 c4 8c 84 49 a8 54  |....h.g?.....I.T|
+00000080  fa 10 d5 0c e4 09 58 ed  4e 77 9f 12 73 2c 49 76  |......X.Nw..s,Iv|
+00000090  52 7d ed 36 dc b5 36 bf  16 7c 28 53 7b e0 b8 20  |R}.6..6..|(S{.. |
+000000a0  1e 23 63 af 98 a3 95 b1  33 32 a6 26 10 33 c7 80  |.#c.....32.&.3..|
+000000b0  32 19 8f 6f                                       |2..o|
 >>> Flow 8 (server to client)
-00000000  16 03 03 00 89 ad 26 44  4c 45 02 3d 8d 73 36 ed  |......&DLE.=.s6.|
-00000010  e8 81 6f 8c ac 02 1e 03  b0 cd aa b1 d6 98 7e 23  |..o...........~#|
-00000020  6b da 43 57 2a f2 91 ad  06 12 3b ad 4a 67 7d 82  |k.CW*.....;.Jg}.|
-00000030  d8 47 bc ee 05 f6 bb b9  31 40 45 84 e9 df 2d 2d  |.G......1@E...--|
-00000040  d7 9e b1 cf c6 0e 4f b6  f3 ce 03 74 88 ef df 68  |......O....t...h|
-00000050  b8 02 59 0c 08 f6 4a de  32 d6 fe ba a5 63 97 c6  |..Y...J.2....c..|
-00000060  e9 4e d8 17 72 b5 00 c2  6b 8e a1 ba 08 59 f3 4f  |.N..r...k....Y.O|
-00000070  fc f2 a3 3f 9a 8d 1a de  1f d8 c0 e7 92 63 67 dd  |...?.........cg.|
-00000080  e1 34 b3 48 2d 06 aa 61  7e f3 7c 0f 94 b7 16 03  |.4.H-..a~.|.....|
-00000090  03 02 71 ad 26 44 4c 45  02 3d 8e ba 4a f2 9d c0  |..q.&DLE.=..J...|
-000000a0  12 78 d1 e5 d0 33 96 0c  a9 ff 90 ea c7 5f 9e c9  |.x...3......._..|
-000000b0  a5 9b 10 a9 af 3b 35 66  bd 8b 5d 7c 3e 26 7b c6  |.....;5f..]|>&{.|
-000000c0  90 c5 60 3e c6 c5 37 4a  4f 71 de 10 79 a2 25 e5  |..`>..7JOq..y.%.|
-000000d0  c3 b1 30 2f b2 83 ef 28  75 f9 3e 52 86 97 4e 63  |..0/...(u.>R..Nc|
-000000e0  da 60 70 7c fe 5f ab f0  9a 37 41 4c c3 83 77 5e  |.`p|._...7AL..w^|
-000000f0  f7 49 4e be 74 5a 1b a3  41 22 31 59 ec 28 90 f3  |.IN.tZ..A"1Y.(..|
-00000100  be a7 bf 50 0e 58 44 b9  3d 99 25 95 82 45 8a 88  |...P.XD.=.%..E..|
-00000110  80 c8 06 c7 94 56 1a 63  0c 3b 30 9f 7e 5f a1 e2  |.....V.c.;0.~_..|
-00000120  15 40 fa 8a 35 b7 87 85  42 5a dd f4 56 a7 b3 ca  |.@..5...BZ..V...|
-00000130  e6 5c 82 bd ea 7f 02 82  15 b1 4f 63 0c e5 cd d4  |.\........Oc....|
-00000140  19 ec d6 8c d1 b8 fa 54  8b 04 42 11 a8 95 55 9d  |.......T..B...U.|
-00000150  fc 3e a4 ad f0 51 ee ac  4b 8f 30 27 9e bb 74 15  |.>...Q..K.0'..t.|
-00000160  c8 9f 52 0c 83 fd 75 a2  64 f5 ce 3c 01 76 7c dc  |..R...u.d..<.v|.|
-00000170  ec 15 99 70 af a9 93 bb  eb f0 4a b1 58 19 de 2e  |...p......J.X...|
-00000180  9e 01 67 ab 08 73 b5 6c  7d f0 cd 67 f6 4a 64 76  |..g..s.l}..g.Jdv|
-00000190  3f 5d 2b 98 ea ef f6 43  1b 1a ed 6d e1 e4 5b 24  |?]+....C...m..[$|
-000001a0  dd 5d eb 69 7a 6d 81 94  d7 2f 5c c4 f2 01 34 33  |.].izm.../\...43|
-000001b0  e2 cf 78 00 87 16 98 4b  28 cd 1a 4b 3f f0 42 31  |..x....K(..K?.B1|
-000001c0  07 8a ec 77 65 66 08 5f  72 a3 39 82 56 5d 90 14  |...wef._r.9.V]..|
-000001d0  29 cf e0 4f e6 41 c9 b2  85 81 28 cb f8 8e b8 39  |)..O.A....(....9|
-000001e0  16 16 4b 85 91 96 0b 0f  7b 59 ac ec 39 cc 02 ea  |..K.....{Y..9...|
-000001f0  79 72 60 04 5c 57 29 df  b2 26 6f 1c 93 21 93 95  |yr`.\W)..&o..!..|
-00000200  cb b2 8e 02 91 9f 14 d9  dd 3b 58 0d 73 1e 39 7d  |.........;X.s.9}|
-00000210  b0 65 d9 fa 07 2d 12 02  c9 b3 fd 6b 81 0d 2e 8d  |.e...-.....k....|
-00000220  2d 31 82 9d 4d df fa 93  c3 dd 98 ea 49 e8 2e 3d  |-1..M.......I..=|
-00000230  6b 7a 4e 55 e6 8e 1d 18  07 2a 71 9b 64 bb d9 fa  |kzNU.....*q.d...|
-00000240  3c fe fb 29 e7 93 68 3b  5b f5 7a c3 c5 e8 76 66  |<..)..h;[.z...vf|
-00000250  54 1d 89 f0 fc d8 d7 f0  e0 c0 bf 86 de 8f 37 72  |T.............7r|
-00000260  53 f0 91 2e 7b 5c bc 61  cc 91 be 4d 29 4e 88 4e  |S...{\.a...M)N.N|
-00000270  ad 1a fe da 16 3b 89 e7  aa 28 77 a7 d2 4f 7e 68  |.....;...(w..O~h|
-00000280  8a 70 1e db ae 74 b6 78  57 13 47 4b 2d 28 f2 3c  |.p...t.xW.GK-(.<|
-00000290  d4 cc 0a 47 fe 9b 43 49  80 56 7d 46 12 3e 62 49  |...G..CI.V}F.>bI|
-000002a0  6c ae cc 4d 58 3c 37 5b  10 93 e0 6c 1f 51 1e 30  |l..MX<7[...l.Q.0|
-000002b0  06 85 07 1f 0d 20 b1 57  6f 5d 17 5c d1 66 f0 fe  |..... .Wo].\.f..|
-000002c0  d2 5f 7e 0e 66 f3 23 23  d1 c6 03 1c 7e 93 ab e5  |._~.f.##....~...|
-000002d0  d1 7e c7 06 09 18 96 fa  19 b8 e6 f7 35 d6 80 f4  |.~..........5...|
-000002e0  41 2a 59 80 5b 3a 3c 82  33 84 55 5d 3f 7b e8 1b  |A*Y.[:<.3.U]?{..|
-000002f0  ce 82 18 7d 66 a9 2a 12  03 97 49 66 d5 88 50 25  |...}f.*...If..P%|
-00000300  30 14 02 c6 16 03 03 00  e5 ad 26 44 4c 45 02 3d  |0.........&DLE.=|
-00000310  8f a6 47 86 99 f5 6c 24  20 3d 37 2b 76 ce f3 df  |..G...l$ =7+v...|
-00000320  c3 e0 98 90 10 04 64 af  08 01 94 84 0a 1c 40 22  |......d.......@"|
-00000330  7e de 5c 9c 39 8e 0b d0  d2 cb 87 ed 26 a5 71 bf  |~.\.9.......&.q.|
-00000340  1e 0a 32 7a 84 d1 b0 3d  7c 7e b0 00 f0 d1 1b e6  |..2z...=|~......|
-00000350  d2 dc 8a 5e e2 b6 16 2c  98 53 fc 95 ce 24 74 26  |...^...,.S...$t&|
-00000360  bb d3 7d b1 a7 68 73 98  81 a9 38 80 f1 ad c4 00  |..}..hs...8.....|
-00000370  57 79 65 0e b7 25 73 aa  f6 8f f1 70 51 d9 d4 73  |Wye..%s....pQ..s|
-00000380  8e bd 57 4a ee f9 eb 41  ed 52 bb 23 8d 10 ce 74  |..WJ...A.R.#...t|
-00000390  fa 0c 01 d6 e7 b6 71 bb  e0 e0 8a e7 3b 88 dc 3a  |......q.....;..:|
-000003a0  7c 18 ca 70 6d 39 5c 3f  b2 99 af 29 71 27 a1 2f  ||..pm9\?...)q'./|
-000003b0  a0 6e 11 47 dc a2 6f e0  ab ad 2f 26 8f b2 d6 7d  |.n.G..o.../&...}|
-000003c0  bb 5f 8c 22 1e b9 b2 82  45 e7 24 52 f6 5d e0 5a  |._."....E.$R.].Z|
-000003d0  6f cb a0 ef 14 ad 8a 18  8d 21 c9 04 01 f6 67 d6  |o........!....g.|
-000003e0  08 2d e6 73 73 5c 64 23  d5 30 04 a7 5f 57 16 03  |.-.ss\d#.0.._W..|
-000003f0  03 00 46 ad 26 44 4c 45  02 3d 90 9e 93 c2 4e 92  |..F.&DLE.=....N.|
-00000400  67 14 0c ec d6 5a 44 7f  bf 1d a7 0a 0d f3 bf 2a  |g....ZD........*|
-00000410  07 ed a4 89 89 58 1a 9e  f6 ac 2f 04 b9 bc 2f 40  |.....X..../.../@|
-00000420  50 39 18 3e dc 6b 10 6e  82 66 32 27 f6 29 46 96  |P9.>.k.n.f2'.)F.|
-00000430  b6 cc 04 d9 aa 73 4c 68  74                       |.....sLht|
+00000000  16 03 03 00 89 f4 ab 49  aa 08 16 71 3d f2 ea bb  |.......I...q=...|
+00000010  28 9b 7a b2 e3 10 07 f2  8a 9e f6 02 fe 47 fe 26  |(.z..........G.&|
+00000020  23 9c 5e 18 67 ad ec 45  94 4b 40 d4 a8 4a 11 ef  |#.^.g..E.K@..J..|
+00000030  67 07 b0 5e e3 58 bb f8  2a 46 fc 5a 0f 6c d1 d9  |g..^.X..*F.Z.l..|
+00000040  98 72 55 bd 45 15 2f 3a  87 4e 49 68 40 a8 c8 0a  |.rU.E./:.NIh@...|
+00000050  5c fb 23 32 ce 72 3a 13  6e a4 15 fa d6 53 73 77  |\.#2.r:.n....Ssw|
+00000060  36 44 86 67 b3 c8 e7 65  f0 ef 53 cc 87 91 b0 4a  |6D.g...e..S....J|
+00000070  70 01 22 62 d9 31 23 bc  b8 26 17 03 6e 02 d8 fd  |p."b.1#..&..n...|
+00000080  8a 4a 75 fc 08 58 a9 0b  50 1e 7d bf 38 3c 16 03  |.Ju..X..P.}.8<..|
+00000090  03 02 71 f4 ab 49 aa 08  16 71 3e 15 6d d8 c8 ad  |..q..I...q>.m...|
+000000a0  44 2d 49 b9 e3 e1 1b da  22 e0 65 16 a1 cd 77 17  |D-I.....".e...w.|
+000000b0  40 de 68 18 a6 af 7c 0a  e4 66 d0 30 ed 4d ca 8d  |@.h...|..f.0.M..|
+000000c0  9d a6 27 59 3e 6b 25 56  6f 47 e5 50 98 dd 53 e9  |..'Y>k%VoG.P..S.|
+000000d0  53 35 5a 76 82 f0 cb 9a  a2 98 10 fb c5 9d 43 a6  |S5Zv..........C.|
+000000e0  e7 e3 01 bf 86 2f 41 fc  fd 7e c8 d8 0e b8 a8 79  |...../A..~.....y|
+000000f0  62 53 75 1b 67 4b 8b d3  6c ba 94 28 af 31 d2 3c  |bSu.gK..l..(.1.<|
+00000100  c4 2c 2c 86 1d 1f 11 fa  f4 df 8e c4 46 22 db 26  |.,,.........F".&|
+00000110  68 4f b5 a0 87 f2 82 bb  9d 31 c0 d8 41 57 53 c7  |hO.......1..AWS.|
+00000120  4b 7f 01 43 43 28 ea bb  27 83 8d 3d 60 b9 62 b2  |K..CC(..'..=`.b.|
+00000130  66 e6 cc b5 be a3 e2 2f  a1 c8 ae 49 3c 4d b1 dc  |f....../...I<M..|
+00000140  b2 7d 30 9b dc 64 04 dc  67 61 ba 85 36 29 c7 7b  |.}0..d..ga..6).{|
+00000150  f6 bf 59 62 8d 3d 19 5d  9a ba cf 30 b6 18 0a 60  |..Yb.=.]...0...`|
+00000160  7a aa 2c a6 48 44 9c 07  18 e2 40 93 a6 4b 39 eb  |z.,.HD....@..K9.|
+00000170  b1 69 9d 0d 5c e0 9d 52  3e 47 70 fb 3b 19 34 f2  |.i..\..R>Gp.;.4.|
+00000180  01 15 e0 0c 04 9e 2e d7  b0 c7 18 b7 95 67 8c 84  |.............g..|
+00000190  61 2c f6 08 39 53 b1 29  94 ca c5 8e 70 48 18 8a  |a,..9S.)....pH..|
+000001a0  c3 36 22 c3 84 e8 55 89  ab c7 50 1e 7d ec 81 6c  |.6"...U...P.}..l|
+000001b0  3d 33 50 84 b6 e4 ef d7  e6 43 45 c0 9f e4 87 1a  |=3P......CE.....|
+000001c0  0a 67 4f f6 57 3d 0e b4  7a 0a f6 ba 69 47 85 ea  |.gO.W=..z...iG..|
+000001d0  5d 1a 55 28 3d 90 3a 6d  c5 ed ac 3c 49 ec c1 f3  |].U(=.:m...<I...|
+000001e0  a0 e4 47 99 15 72 cf a9  5e fa 78 24 5c 7e 43 f5  |..G..r..^.x$\~C.|
+000001f0  36 60 4d 0e 2e a0 83 3c  4b a1 cb 55 1b 97 4c 9f  |6`M....<K..U..L.|
+00000200  08 3c 5d c7 bd 61 b5 ad  2c db 8a 61 ea 49 fa 72  |.<]..a..,..a.I.r|
+00000210  2e 41 57 ee fc c0 35 58  c6 6f da c7 ea 58 ff db  |.AW...5X.o...X..|
+00000220  99 47 5f f2 2e 4b 19 cf  0e 72 e1 6f 14 ed 18 b7  |.G_..K...r.o....|
+00000230  7d 78 cf 69 d1 63 e5 12  84 a9 95 5d bf 8d 77 b8  |}x.i.c.....]..w.|
+00000240  e4 dc 8b fd 13 30 f4 38  6b d1 bd f8 6b 9e 14 32  |.....0.8k...k..2|
+00000250  52 b8 eb 7a 92 a6 ac f9  cb d4 ea 50 3d 53 66 25  |R..z.......P=Sf%|
+00000260  7c 26 f8 bc 87 46 f2 8b  fa 78 ec 93 74 28 03 e9  ||&...F...x..t(..|
+00000270  47 05 ec 8b 1d 70 9e f2  07 24 43 8c 2c 4b e2 0f  |G....p...$C.,K..|
+00000280  49 19 c5 68 61 a6 74 83  db c4 fe a6 e7 b2 7c 8a  |I..ha.t.......|.|
+00000290  e7 b0 f7 67 8b bc 54 7e  a1 62 37 83 23 cf c9 31  |...g..T~.b7.#..1|
+000002a0  25 9c 07 6b 74 37 08 38  82 65 59 a4 7e f5 35 ad  |%..kt7.8.eY.~.5.|
+000002b0  f3 c9 f5 32 37 e2 ee 4d  78 de 1e 59 b0 3e 81 30  |...27..Mx..Y.>.0|
+000002c0  c1 da 6b 11 ac b4 a5 b7  e6 b3 b8 df a7 42 4d b8  |..k..........BM.|
+000002d0  3b c2 a7 fe e6 66 b4 c2  dd 91 03 35 46 b5 86 6a  |;....f.....5F..j|
+000002e0  39 3f 1b 25 77 35 8c 31  7e 0b 3b 63 ed 6c 6c cf  |9?.%w5.1~.;c.ll.|
+000002f0  6f eb 8e 9f f1 dd 0d f1  36 51 92 5e a2 f5 ad 3e  |o.......6Q.^...>|
+00000300  eb d7 96 ae 16 03 03 00  e5 f4 ab 49 aa 08 16 71  |...........I...q|
+00000310  3f c6 e0 e2 9c 98 c0 71  c0 41 d3 d4 c4 03 4e a6  |?......q.A....N.|
+00000320  69 da bb 23 81 84 5f bd  39 1c 16 00 34 ad 3d dd  |i..#.._.9...4.=.|
+00000330  ee f8 03 0b 07 f4 90 68  2f 49 57 21 c3 b2 4c 00  |.......h/IW!..L.|
+00000340  fd 06 4b 7a 72 fc 50 06  26 a4 6c 44 92 61 c3 aa  |..Kzr.P.&.lD.a..|
+00000350  76 98 f8 6c c7 9f 38 b2  6c a2 26 38 b7 f3 f4 aa  |v..l..8.l.&8....|
+00000360  56 ff a3 ac 4a ce a2 a2  5e 77 dc e2 29 df e1 24  |V...J...^w..)..$|
+00000370  2c e4 b0 5b fc 7e 39 51  ee 5b 96 18 d5 d8 04 ba  |,..[.~9Q.[......|
+00000380  a1 fb a6 11 d7 27 fc 17  58 b9 e8 43 a2 ce dc 6d  |.....'..X..C...m|
+00000390  2b d6 44 6f 08 c9 37 f6  43 7a 3d dc 5c d3 55 5c  |+.Do..7.Cz=.\.U\|
+000003a0  13 09 84 4e b5 3b 6f 4f  bf e4 74 e0 cd d6 a2 c6  |...N.;oO..t.....|
+000003b0  1a d3 65 44 8f 21 a0 04  f7 97 fc a9 f7 cd 3a 01  |..eD.!........:.|
+000003c0  3c ea 95 e8 ba 1f cc 88  48 66 5e b9 a4 2b 26 dd  |<.......Hf^..+&.|
+000003d0  b5 73 54 47 4c 5c d9 fb  c6 fa db 98 6e ba 77 6f  |.sTGL\......n.wo|
+000003e0  6f d8 c6 e9 c3 e1 6b 59  b7 e0 08 16 30 4d 16 03  |o.....kY....0M..|
+000003f0  03 00 42 f4 ab 49 aa 08  16 71 40 fa e0 25 7c 6f  |..B..I...q@..%|o|
+00000400  f7 1e 5b 19 8a 31 4e 48  ce da c2 97 3a 62 85 ae  |..[..1NH....:b..|
+00000410  07 d1 27 52 1b c1 f2 48  c5 1b ee bf 72 ac 29 5e  |..'R...H....r.)^|
+00000420  8f 5f 71 f4 85 07 54 61  d0 54 31 99 d6 9b 9c 73  |._q...Ta.T1....s|
+00000430  16 93 8a 31 e2 16 03 03  00 1c f4 ab 49 aa 08 16  |...1........I...|
+00000440  71 41 70 18 29 89 1a 9e  4f 6b 8d 02 fa 91 e0 f0  |qAp.)...Ok......|
+00000450  5d 9c 9e a9 01 8d                                 |].....|
 >>> Flow 9 (client to server)
-00000000  16 03 03 02 71 00 00 00  00 00 00 00 03 5d 93 f4  |....q........]..|
-00000010  7a 32 5a b5 5b 4b 07 73  ae a6 e0 f1 39 7d 89 e4  |z2Z.[K.s....9}..|
-00000020  54 ce a3 7a 36 c1 95 6a  72 0a f4 7a a5 84 68 dd  |T..z6..jr..z..h.|
-00000030  d6 5f 43 52 a0 7a 28 d9  95 a2 35 35 89 09 00 fc  |._CR.z(...55....|
-00000040  a6 ab f2 3e 70 a8 3d 63  37 18 1d 11 2d 20 27 eb  |...>p.=c7...- '.|
-00000050  a6 ca 20 aa b5 fb 6d e6  ab f2 96 22 6c a9 14 8a  |.. ...m...."l...|
-00000060  55 c3 5c 44 0e 19 30 e1  57 ef 67 ea 4d 44 77 d9  |U.\D..0.W.g.MDw.|
-00000070  f9 8f d7 6c c3 77 55 af  b2 f0 22 c8 ba da 66 89  |...l.wU..."...f.|
-00000080  59 00 42 a6 b7 f6 3e 54  13 86 15 80 82 00 00 06  |Y.B...>T........|
-00000090  cc e5 c0 6d 3a 16 16 03  ea 91 db bc 38 e8 9d 35  |...m:.......8..5|
-000000a0  21 59 3e 26 b8 ac 08 19  aa 34 8e fc 48 6a 5b 0b  |!Y>&.....4..Hj[.|
-000000b0  4d eb 1c 48 4d cf 4c 44  af dc 74 2c c5 27 13 98  |M..HM.LD..t,.'..|
-000000c0  73 ca 71 8b 1f 76 e8 6e  42 2f a6 66 d4 84 2b 0f  |s.q..v.nB/.f..+.|
-000000d0  ec 5d 57 ec 61 e9 66 3a  b3 5a 14 e2 32 f9 97 0a  |.]W.a.f:.Z..2...|
-000000e0  55 e3 7f e6 5e cd 56 21  9f 6f 9d 59 cf 78 84 b2  |U...^.V!.o.Y.x..|
-000000f0  66 56 a2 50 f2 2a 13 ff  8d 93 35 9d 8e fc d4 4b  |fV.P.*....5....K|
-00000100  3c 7d 14 f4 d7 27 a3 00  fe ef 30 54 e5 fd c7 47  |<}...'....0T...G|
-00000110  7a a6 66 61 8a 92 24 fe  58 2a a6 96 f4 0e 15 ad  |z.fa..$.X*......|
-00000120  5b dc c5 a1 f7 81 16 30  ec ca 29 a8 3a b3 21 94  |[......0..).:.!.|
-00000130  5c 6c 24 b5 2a b7 48 2d  d3 27 04 8e 1e 93 b8 fc  |\l$.*.H-.'......|
-00000140  d7 e3 36 44 9e c7 5d c4  6f 04 c3 da 3d a3 3c a7  |..6D..].o...=.<.|
-00000150  54 82 aa 50 a2 17 3b af  f8 10 17 99 de 45 7f 79  |T..P..;......E.y|
-00000160  99 98 3e b6 2f b6 fc d8  96 3b 06 42 f8 4c 54 87  |..>./....;.B.LT.|
-00000170  41 44 3e 7c e2 f2 58 ab  f8 d9 f1 03 54 e4 3c 93  |AD>|..X.....T.<.|
-00000180  f6 a9 03 e5 f0 85 ac a3  5a 5d 99 2b cb 3c 4e 1a  |........Z].+.<N.|
-00000190  d2 b8 08 a1 81 a0 17 ba  92 c5 91 bb b3 df 34 b7  |..............4.|
-000001a0  0b 62 60 bb 68 68 d5 bb  85 ff d0 5f e0 7f 7a 5f  |.b`.hh....._..z_|
-000001b0  56 f2 e5 87 0e dd c0 a3  bd ad 99 16 23 77 34 77  |V...........#w4w|
-000001c0  40 f4 67 8c 87 b0 b3 f3  3b 68 28 e3 dc d6 e6 b3  |@.g.....;h(.....|
-000001d0  ac 00 0d 45 1e e0 7f e4  30 82 1b b9 89 a5 39 6c  |...E....0.....9l|
-000001e0  e3 57 3c 09 6a ee 2f ef  96 b9 b4 b0 6b bf ef 43  |.W<.j./.....k..C|
-000001f0  86 6a 24 01 43 a1 22 ec  9e 15 84 f5 e4 ac 1d e6  |.j$.C.".........|
-00000200  38 06 53 fe 4b f6 23 15  22 ee 02 e4 38 9c 3a 0a  |8.S.K.#."...8.:.|
-00000210  58 c5 01 6a 6e bb e7 d4  ef 15 e9 42 76 96 7b d1  |X..jn......Bv.{.|
-00000220  54 77 8c 39 9e 51 71 9d  d1 b8 06 a2 84 3c 12 ab  |Tw.9.Qq......<..|
-00000230  55 6f a0 8f 02 95 a9 7c  c5 99 fc 71 e0 83 e4 57  |Uo.....|...q...W|
-00000240  bf e3 a3 66 8a 41 9c 9d  00 6d f0 25 16 fd 91 4f  |...f.A...m.%...O|
-00000250  86 29 ce e7 77 89 fe 54  6d cf 96 cf 15 53 43 8d  |.)..w..Tm....SC.|
-00000260  b3 54 4e 4e 2c ad 60 e0  c2 ad dc a0 c8 70 c3 e8  |.TNN,.`......p..|
-00000270  dc 61 95 0f 15 4e 16 03  03 00 5e 00 00 00 00 00  |.a...N....^.....|
-00000280  00 00 04 12 0f 1c 13 73  45 13 64 2a e1 c4 ad a6  |.......sE.d*....|
-00000290  2f 8b 6e ad 30 7b 35 72  29 87 d6 cc 7a e5 7d 7a  |/.n.0{5r)...z.}z|
-000002a0  c6 71 b8 bb c2 58 4b d8  4e f1 e4 56 5d 96 e3 c7  |.q...XK.N..V]...|
-000002b0  ee 4a 20 64 83 ea 41 c8  03 10 7d 81 94 5e b0 c8  |.J d..A...}..^..|
-000002c0  c1 ed c0 67 24 0e 56 20  28 75 25 99 bb eb 56 8e  |...g$.V (u%...V.|
-000002d0  c2 bb de 77 67 80 b3 43  f7 16 03 03 00 a0 00 00  |...wg..C........|
-000002e0  00 00 00 00 00 05 f4 5f  a4 df 41 67 23 b0 b2 50  |......._..Ag#..P|
-000002f0  e5 d2 f1 55 ce f5 ef ad  64 c3 98 78 5d 03 25 ae  |...U....d..x].%.|
-00000300  6e 76 5e bb 9b 04 5e 2b  9e cd 16 7a 7c f7 fd 36  |nv^...^+...z|..6|
-00000310  9d e0 25 66 93 8b 85 73  2a 63 6a 68 c5 c4 31 0e  |..%f...s*cjh..1.|
-00000320  86 96 7c 33 c9 98 51 b2  c4 2f 2c 22 18 37 01 7d  |..|3..Q../,".7.}|
-00000330  81 46 74 a1 d0 a6 70 80  d0 91 94 f1 d8 03 b1 a4  |.Ft...p.........|
-00000340  1e 17 b9 0c 38 5d 12 55  66 79 93 c2 f9 cf 03 e0  |....8].Ufy......|
-00000350  8d 4c d4 93 1c 12 49 81  3b 33 31 62 b2 dd 29 a5  |.L....I.;31b..).|
-00000360  ac 7a 37 5a f0 85 c6 88  af c7 42 40 4b 29 fb 5b  |.z7Z......B@K).[|
-00000370  1b 56 9f 83 bf a6 b9 72  1e 7e 26 73 3a 8e 14 03  |.V.....r.~&s:...|
-00000380  03 00 19 00 00 00 00 00  00 00 06 e5 5f 53 1b 11  |............_S..|
-00000390  45 af 56 2f 80 1b 24 82  77 2c d5 78 16 03 03 00  |E.V/..$.w,.x....|
-000003a0  28 00 00 00 00 00 00 00  00 17 31 bc e9 6e 74 1c  |(.........1..nt.|
-000003b0  24 73 47 9d e0 e4 9e 42  9b 3f 3a ec 40 1e ca 37  |$sG....B.?:.@..7|
-000003c0  da ff 8d a2 7f a2 1f ea  95                       |.........|
+00000000  16 03 03 02 71 00 00 00  00 00 00 00 03 23 0f d3  |....q........#..|
+00000010  6c b4 ee 06 48 2f 9f 75  99 cc 94 4a 9e ff c0 4b  |l...H/.u...J...K|
+00000020  30 fa 2b bf 54 a7 f2 05  ff 63 7b 43 a3 ac 04 a3  |0.+.T....c{C....|
+00000030  71 39 57 00 2a d1 80 48  9c bf 19 12 60 35 d6 89  |q9W.*..H....`5..|
+00000040  49 c7 57 6e 7c a6 27 ab  97 f3 f6 ab 6d b9 f0 ab  |I.Wn|.'.....m...|
+00000050  7f 9a cc 06 92 22 08 44  3b 94 2b 0e 31 6a 93 96  |.....".D;.+.1j..|
+00000060  89 7f 4a 6c 06 df dc a6  1f e7 c4 7b 72 0e ed 04  |..Jl.......{r...|
+00000070  d6 c7 ff 48 b6 0c 53 fd  a8 4f 42 89 c5 97 2a 9c  |...H..S..OB...*.|
+00000080  22 1f df cc c0 cc 86 0d  ea 45 36 88 93 01 27 78  |"........E6...'x|
+00000090  ab 9c d0 59 fc 63 dd 53  04 a3 a7 21 e3 26 22 95  |...Y.c.S...!.&".|
+000000a0  f0 63 21 13 04 f7 d1 5a  6e c0 03 ef b6 9d 87 e9  |.c!....Zn.......|
+000000b0  b0 fc c2 40 4e f7 9b 25  c4 ae d4 cc 05 3a 41 5a  |...@N..%.....:AZ|
+000000c0  a3 c2 42 1e 5b 7d 6d 03  f0 e3 6a 2c 92 98 ca 46  |..B.[}m...j,...F|
+000000d0  7d 8a 11 45 1b 12 ca c9  b2 e7 e2 a2 b8 ad f7 ad  |}..E............|
+000000e0  bb 2b 70 ab 0a 87 ac 7c  f7 55 2c 5c 0e 6e 90 de  |.+p....|.U,\.n..|
+000000f0  89 1e e0 d3 a1 a5 80 b7  25 bb d4 df 35 ad ad ed  |........%...5...|
+00000100  8e e9 21 da 30 62 51 d8  8d 45 fb ee 40 dc e8 f4  |..!.0bQ..E..@...|
+00000110  f6 bd b0 ad 2f 23 6b fc  62 4d 51 8f 30 c2 b8 c2  |..../#k.bMQ.0...|
+00000120  2b 16 dc 86 cf 19 b4 aa  48 9b b6 c5 3b 15 29 c4  |+.......H...;.).|
+00000130  a0 7f 40 74 89 95 ba 62  b5 13 ed 69 99 a5 8c 9d  |..@t...b...i....|
+00000140  d2 2d bc 2c c1 db 4d 4d  c8 f5 94 8b 5b ad 0d a9  |.-.,..MM....[...|
+00000150  51 52 a9 c5 85 7a b6 48  4d 44 92 1e 51 53 af 64  |QR...z.HMD..QS.d|
+00000160  39 4b c1 ad d8 e4 43 19  c7 e6 ec 44 33 31 01 89  |9K....C....D31..|
+00000170  40 e3 93 22 3c 97 42 0f  8e 49 3a ca a4 08 ca 02  |@.."<.B..I:.....|
+00000180  96 2b 83 3b 5d 1e 98 9c  f9 ec 31 6e 03 8d 52 56  |.+.;].....1n..RV|
+00000190  9f 8a d6 2b a6 bc 99 89  f1 c2 76 f4 fa 56 f1 9f  |...+......v..V..|
+000001a0  1c d8 4f bd e2 9b af 02  bb f7 71 ba 27 85 e0 9a  |..O.......q.'...|
+000001b0  c9 30 09 d0 ce 4f 06 80  a7 29 34 a8 eb 52 49 a8  |.0...O...)4..RI.|
+000001c0  b9 7d de b2 51 5f f9 d9  84 52 73 03 60 db ee 97  |.}..Q_...Rs.`...|
+000001d0  b9 ca da e5 f1 4b 38 c6  36 eb 25 8e 62 59 7a 8a  |.....K8.6.%.bYz.|
+000001e0  e9 59 0f 41 30 8d 33 64  1a 1a ee 0d 79 1c da 53  |.Y.A0.3d....y..S|
+000001f0  f4 e1 04 2e 5b 6a cb 4f  0a b6 3a b1 76 49 41 cb  |....[j.O..:.vIA.|
+00000200  1d 59 0d 1d a6 89 22 ee  33 60 2b 7f a8 43 3a c7  |.Y....".3`+..C:.|
+00000210  26 65 1b 56 54 83 09 6d  ec 08 ef db bd 61 71 ee  |&e.VT..m.....aq.|
+00000220  2e 49 00 0b cf 89 e9 d5  48 a3 c1 6a b7 6c e1 6a  |.I......H..j.l.j|
+00000230  1a d1 f1 f7 03 25 4a 98  48 9b 59 eb 8e b4 b1 4b  |.....%J.H.Y....K|
+00000240  0f 0b 35 6d c1 e2 8e b9  96 35 dc da 2f 53 21 45  |..5m.....5../S!E|
+00000250  7a d0 3d 8e 20 99 f3 22  e0 e4 33 83 95 04 6a 4c  |z.=. .."..3...jL|
+00000260  91 fc 0c 90 57 dd b9 9c  19 37 5e d4 2e cd ff 34  |....W....7^....4|
+00000270  22 44 d3 d1 69 13 16 03  03 00 5e 00 00 00 00 00  |"D..i.....^.....|
+00000280  00 00 04 53 f5 4d 21 83  84 9c 36 8e ce 3b 27 8c  |...S.M!...6..;'.|
+00000290  9f fd 85 28 56 09 c6 99  a2 af cc 7d 2d af 85 79  |...(V......}-..y|
+000002a0  78 3d f4 88 cd 60 89 40  a2 e4 bb f2 ae 45 53 48  |x=...`.@.....ESH|
+000002b0  6d e9 ca a2 36 7d 25 01  38 e9 77 01 1d 05 b0 58  |m...6}%.8.w....X|
+000002c0  5b da 87 c5 5c df 7e b0  f6 6d a7 38 8a 63 a3 43  |[...\.~..m.8.c.C|
+000002d0  60 18 40 7b 5b c1 05 92  b5 16 03 03 00 a0 00 00  |`.@{[...........|
+000002e0  00 00 00 00 00 05 8b df  bf 56 8b 21 81 b1 7d 55  |.........V.!..}U|
+000002f0  89 e7 b6 c7 2e 68 6d 05  e3 d3 af 31 ef be a2 db  |.....hm....1....|
+00000300  1d d2 ec f0 8e db a4 76  cb 42 df 29 1d 4d 86 c1  |.......v.B.).M..|
+00000310  e4 32 f2 a1 f6 4a c3 82  70 f8 cf a5 41 af 44 b5  |.2...J..p...A.D.|
+00000320  47 c9 6e ee 75 38 44 08  a7 81 f6 da d6 68 c9 53  |G.n.u8D......h.S|
+00000330  e5 2f f0 a9 0f db 5d 4b  d0 4c 01 e4 e3 a1 2f a7  |./....]K.L..../.|
+00000340  99 75 1c 3e 7a 47 f0 78  ef 61 f2 d6 da 0f c0 08  |.u.>zG.x.a......|
+00000350  03 6f 13 3c a5 d2 24 18  c2 6a db 58 e1 d4 8a 27  |.o.<..$..j.X...'|
+00000360  78 a6 e0 ec 9b e9 5f 94  b8 48 f2 bc e6 29 d4 60  |x....._..H...).`|
+00000370  89 ed 79 52 ce 95 5c b3  c4 81 cf 9d cb 5b 14 03  |..yR..\......[..|
+00000380  03 00 19 00 00 00 00 00  00 00 06 46 6b 4e 92 89  |...........FkN..|
+00000390  d3 45 bf 20 0b 7a 6a 0d  71 8f eb 06 16 03 03 00  |.E. .zj.q.......|
+000003a0  28 00 00 00 00 00 00 00  00 68 c4 4c 4f 17 4a 4d  |(........h.LO.JM|
+000003b0  73 fe 0a b8 a2 2f e4 8a  d6 62 d7 40 ca 04 83 22  |s..../...b.@..."|
+000003c0  41 c9 1f 8f f2 44 bb 88  32                       |A....D..2|
 >>> Flow 10 (server to client)
-00000000  14 03 03 00 19 ad 26 44  4c 45 02 3d 91 63 98 5d  |......&DLE.=.c.]|
-00000010  6c 6a 57 58 26 41 35 6b  8e 06 6d e7 f7 89 16 03  |ljWX&A5k..m.....|
-00000020  03 00 28 4c d5 cd 3a c7  d7 e7 ee cb 56 3b 9c 33  |..(L..:.....V;.3|
-00000030  b0 dd de 8a d6 f8 e7 7a  cc 8b 4a 8a a8 da a0 2f  |.......z..J..../|
-00000040  c7 bb f1 9d 9e 5c fe f0  88 0a 2a 17 03 03 00 21  |.....\....*....!|
-00000050  4c d5 cd 3a c7 d7 e7 ef  78 30 73 80 7b 51 01 06  |L..:....x0s.{Q..|
-00000060  21 84 42 7c 8f f6 16 90  2b d6 f1 58 d3 5b 39 5c  |!.B|....+..X.[9\|
-00000070  5a 16 03 03 00 1c 4c d5  cd 3a c7 d7 e7 f0 e6 51  |Z.....L..:.....Q|
-00000080  88 bd ae 02 e2 ec 33 8d  91 18 03 3d de 8f 75 f5  |......3....=..u.|
-00000090  fe 59                                             |.Y|
+00000000  14 03 03 00 19 f4 ab 49  aa 08 16 71 42 9d 75 f7  |.......I...qB.u.|
+00000010  35 40 8d b7 01 de 6a 81  bf ed fa d1 85 fa 16 03  |5@....j.........|
+00000020  03 00 28 7a 20 c2 1d 3e  3c 2d 69 ac 93 5b b6 dc  |..(z ..><-i..[..|
+00000030  d9 08 e8 80 9c 10 7d d0  d7 64 55 d8 7e af f6 a0  |......}..dU.~...|
+00000040  98 7c 16 99 24 ba 9d d3  96 43 a4 17 03 03 00 21  |.|..$....C.....!|
+00000050  7a 20 c2 1d 3e 3c 2d 6a  63 af 4e e0 22 3a 61 68  |z ..><-jc.N.":ah|
+00000060  2c c3 d7 7b c9 80 46 51  cf 8b b0 af 02 3c 5d a9  |,..{..FQ.....<].|
+00000070  3a 16 03 03 00 1c 7a 20  c2 1d 3e 3c 2d 6b 24 26  |:.....z ..><-k$&|
+00000080  da ff 4d 39 fb 70 85 9d  25 e2 23 ef af bb 27 93  |..M9.p..%.#...'.|
+00000090  c0 f5                                             |..|
 >>> Flow 11 (client to server)
-00000000  16 03 03 00 af 00 00 00  00 00 00 00 01 24 33 e4  |.............$3.|
-00000010  20 a4 e9 30 31 db f3 2b  27 38 6a 38 1d 99 b3 92  | ..01..+'8j8....|
-00000020  33 2b 73 17 94 b1 a9 63  f5 4d f5 5c d8 e7 9b a0  |3+s....c.M.\....|
-00000030  14 37 6b 13 09 bf b8 c6  fb 5f d0 2d 9a 89 c6 a2  |.7k......_.-....|
-00000040  18 d4 31 56 92 2c 84 b3  43 7d 36 42 70 43 17 e4  |..1V.,..C}6BpC..|
-00000050  be f0 ea 72 6d a9 2d 0a  2a 05 08 2a 16 54 d7 2d  |...rm.-.*..*.T.-|
-00000060  c2 86 f9 0c 4d ce 35 05  bd f3 1c a5 63 73 de 39  |....M.5.....cs.9|
-00000070  34 8f 24 da 99 93 c2 19  1f 09 db 05 b0 b4 71 32  |4.$...........q2|
-00000080  b3 9e f5 da aa d1 b2 ed  2d 73 b7 b6 13 eb 08 d4  |........-s......|
-00000090  2f e8 7a 6a 0b 55 e9 ae  6f 9b b9 8e be 7a 23 60  |/.zj.U..o....z#`|
-000000a0  58 c2 2d 23 c9 19 22 38  cf 89 33 f3 e2 72 0c 91  |X.-#.."8..3..r..|
-000000b0  00 33 56 56                                       |.3VV|
+00000000  16 03 03 00 af 00 00 00  00 00 00 00 01 ac bb 56  |...............V|
+00000010  33 88 ab 77 b9 93 64 7b  8d 42 bf 2e 65 36 60 07  |3..w..d{.B..e6`.|
+00000020  f2 d4 22 2a 75 ac 04 9e  11 48 85 ef 96 09 ae a3  |.."*u....H......|
+00000030  af 37 7f 4c 01 5e 3a e2  0f 72 b2 77 40 56 a6 c2  |.7.L.^:..r.w@V..|
+00000040  26 19 f2 67 8e a6 92 91  6f f6 59 5e ec 2e 35 3a  |&..g....o.Y^..5:|
+00000050  1e 03 e3 50 99 8f a3 ba  82 30 3c 24 83 55 9f be  |...P.....0<$.U..|
+00000060  4b 0b a7 86 64 42 25 0d  80 1c 88 e2 a3 c8 3e 6d  |K...dB%.......>m|
+00000070  de 43 46 4e 37 61 32 63  b4 af 77 d1 ba 77 c9 69  |.CFN7a2c..w..w.i|
+00000080  11 4a a8 fd 9d be 8d d8  dc 8e ea f5 12 52 c9 c2  |.J...........R..|
+00000090  c3 34 a0 72 55 34 87 21  aa 93 79 34 64 17 0e 02  |.4.rU4.!..y4d...|
+000000a0  37 a0 9d ea 1b c2 71 4b  46 c7 5e 0a 84 b2 57 d6  |7.....qKF.^...W.|
+000000b0  5e 31 8f c1                                       |^1..|
 >>> Flow 12 (server to client)
-00000000  16 03 03 00 89 4c d5 cd  3a c7 d7 e7 f1 13 d8 b7  |.....L..:.......|
-00000010  c7 5b 06 d1 d9 51 dc ba  71 b2 07 d5 61 78 21 e6  |.[...Q..q...ax!.|
-00000020  21 68 3e 46 06 a6 ad a5  a9 5f 08 d7 1c 52 ec 6b  |!h>F....._...R.k|
-00000030  dc ba fd 9d dd c2 6a fb  4a 10 5a f4 5b 02 9d 65  |......j.J.Z.[..e|
-00000040  4b e0 a0 cc 0c 4e cc 5c  e6 f7 06 0b 0b a6 65 d0  |K....N.\......e.|
-00000050  50 84 6c c6 f5 a4 c2 7c  bc 61 27 f2 7c b8 50 89  |P.l....|.a'.|.P.|
-00000060  93 e2 6a 5e 8b 12 d8 28  d1 7f 48 31 8a a8 7b 62  |..j^...(..H1..{b|
-00000070  0e cc 5f 81 2c 8b 4c 14  e2 3f c5 90 7a 65 76 11  |.._.,.L..?..zev.|
-00000080  a8 ea f1 08 64 d5 71 68  b5 03 d7 52 22 5e 16 03  |....d.qh...R"^..|
-00000090  03 02 71 4c d5 cd 3a c7  d7 e7 f2 81 98 e6 33 99  |..qL..:.......3.|
-000000a0  85 cc ee 27 2b 5d be 7a  e0 91 a8 6b 35 df 9c 60  |...'+].z...k5..`|
-000000b0  db 38 61 d8 63 f0 7e b5  f1 76 6b a9 34 28 17 b9  |.8a.c.~..vk.4(..|
-000000c0  c8 4c 64 c9 95 54 8e 4e  6f 39 06 e7 d8 31 bc d5  |.Ld..T.No9...1..|
-000000d0  6c 7a bb c6 95 32 14 e7  f1 3d 8f 3d de 7c 00 79  |lz...2...=.=.|.y|
-000000e0  b2 c9 82 2b a6 4b 5e d0  43 76 1a ae 58 1e 1a 4c  |...+.K^.Cv..X..L|
-000000f0  de 09 ea 9b e1 ce fd 30  98 60 08 6e a3 2e f7 25  |.......0.`.n...%|
-00000100  c5 6a 89 fb fe 2a 02 6c  51 08 0d 9c 23 66 af c5  |.j...*.lQ...#f..|
-00000110  e6 f3 ed 6c 29 fb 34 f5  84 58 7b d2 e1 0a 21 46  |...l).4..X{...!F|
-00000120  cb 7a 1d ba 44 ba 84 3b  75 ae 9b 1b 3d 71 fe 5c  |.z..D..;u...=q.\|
-00000130  d5 55 04 3d d3 27 5f 5c  3a 16 4e 38 91 98 1e b5  |.U.=.'_\:.N8....|
-00000140  73 a5 0c 8c 76 8b 8f 31  09 ee 34 1f a8 1f 3e 84  |s...v..1..4...>.|
-00000150  28 bb c6 18 0f ce 10 9f  69 63 72 78 f1 14 51 2f  |(.......icrx..Q/|
-00000160  67 f2 2d f0 9b e6 3e 0a  f1 7e 3e ca a6 92 c0 f5  |g.-...>..~>.....|
-00000170  91 0f 35 00 ff de cf ac  33 d9 29 23 95 cd b2 6e  |..5.....3.)#...n|
-00000180  25 f8 34 ff 5b 36 6a 97  a7 5a ed 33 28 fe 45 2e  |%.4.[6j..Z.3(.E.|
-00000190  43 41 41 b7 a6 84 50 b6  cb 14 8c 8c c3 f0 53 17  |CAA...P.......S.|
-000001a0  54 e0 40 75 52 de c4 ef  58 ef 36 b4 d2 f6 f8 10  |T.@uR...X.6.....|
-000001b0  ba 77 b2 4a d1 b3 53 22  12 0d ef 5b 8d 87 70 7d  |.w.J..S"...[..p}|
-000001c0  56 64 5d d0 da d7 39 87  4c 0e 0a 9c 92 b5 1f 8b  |Vd]...9.L.......|
-000001d0  03 05 02 dc 12 d4 f9 94  9a 4b 2b 25 ec 3b 11 84  |.........K+%.;..|
-000001e0  a6 09 f9 5c 55 e7 8b 48  cc b4 bf af 3f a4 3e f1  |...\U..H....?.>.|
-000001f0  c7 77 1c e9 ce 35 28 98  7e ac 41 6f d1 c1 44 42  |.w...5(.~.Ao..DB|
-00000200  02 e8 90 bf 3a 94 28 e7  a5 28 61 6c 02 3b fe 78  |....:.(..(al.;.x|
-00000210  95 70 81 d3 b2 78 6e 8a  a9 db cf 5a 00 6f 00 0c  |.p...xn....Z.o..|
-00000220  bd 78 e0 c0 eb d7 e4 75  5a 1f 6a 36 7f 73 db be  |.x.....uZ.j6.s..|
-00000230  9c 03 cc e2 ef 8e fd ca  fe 07 d9 66 78 f3 e9 bc  |...........fx...|
-00000240  c4 3c 57 c5 24 93 0a 88  f4 1b 4a 14 5a 5f 34 4c  |.<W.$.....J.Z_4L|
-00000250  d4 44 6e 97 79 df bb f3  10 07 8d 49 6f 76 b6 28  |.Dn.y......Iov.(|
-00000260  96 a8 53 b0 8b fd 41 be  e7 7d 4d 31 7a f0 f0 bf  |..S...A..}M1z...|
-00000270  90 41 93 6f ca e7 15 8f  c0 42 ac cb c8 5d 5f fc  |.A.o.....B...]_.|
-00000280  d6 4a 13 9b 60 58 e2 45  9b 71 e4 8a 2f 63 17 8c  |.J..`X.E.q../c..|
-00000290  c8 4b 8e fc 94 3c 38 f8  fe b9 dd a2 21 c1 b1 3f  |.K...<8.....!..?|
-000002a0  d8 1c 99 5b 55 0b 25 61  3c b0 ec 95 d9 fb ab 1c  |...[U.%a<.......|
-000002b0  30 3c bd ba 5e 5b 17 82  e3 8a 8f 27 bd d5 1d 4d  |0<..^[.....'...M|
-000002c0  c9 0d c4 32 1d a1 59 86  aa 91 14 6c 06 34 8c d3  |...2..Y....l.4..|
-000002d0  d2 c5 23 7b 7d 3a ef 28  2a 07 e1 95 bd be eb ce  |..#{}:.(*.......|
-000002e0  60 a2 1c e1 5b 16 44 65  fb e0 8b f7 d7 c5 8d 6e  |`...[.De.......n|
-000002f0  5b 41 82 32 17 f7 1e df  46 8d af 46 4f 0c 3c f5  |[A.2....F..FO.<.|
-00000300  b7 29 3e c3 16 03 03 00  e5 4c d5 cd 3a c7 d7 e7  |.)>......L..:...|
-00000310  f3 a8 7b 0e e4 ba 06 bf  23 e4 f3 53 a1 81 17 c3  |..{.....#..S....|
-00000320  9a bd 23 37 14 d7 ab 18  d7 38 c5 b7 c0 7d 4b 04  |..#7.....8...}K.|
-00000330  70 ac 26 e2 eb 4a a7 a1  ee c2 d6 b4 8e 6f 43 4e  |p.&..J.......oCN|
-00000340  ba 27 3b d7 d0 63 21 0f  24 9b 28 cd b1 00 4e 5c  |.';..c!.$.(...N\|
-00000350  50 88 11 54 13 1c 16 13  1c 19 32 cc 8e bf 02 d7  |P..T......2.....|
-00000360  df e1 b0 0c 9d ce 73 a2  71 bc ef 2c 37 f4 43 99  |......s.q..,7.C.|
-00000370  5b 24 af e8 69 57 76 03  3c 80 17 4e db 57 41 7d  |[$..iWv.<..N.WA}|
-00000380  77 4e a5 88 aa 54 f7 bc  96 8c 6b 91 2e 96 6f 95  |wN...T....k...o.|
-00000390  f4 e9 c7 4c 67 67 78 4c  a1 b1 92 0b 99 a7 4f 4d  |...LggxL......OM|
-000003a0  99 c7 1e 10 8a 2a df 05  c1 32 2b b1 e3 96 6f 15  |.....*...2+...o.|
-000003b0  c7 5f 4d 6d 01 39 d5 5d  fc 32 e4 b6 74 fd 20 2f  |._Mm.9.].2..t. /|
-000003c0  8b c5 a8 10 56 d4 f9 92  d1 2f 94 a2 fe 02 20 62  |....V..../.... b|
-000003d0  0c af cc 43 47 0e a7 b4  61 de 6c 23 21 11 e1 37  |...CG...a.l#!..7|
-000003e0  34 20 1c c5 48 51 4a 5a  1a 6a fc bc 00 89 16 03  |4 ..HQJZ.j......|
-000003f0  03 00 46 4c d5 cd 3a c7  d7 e7 f4 97 0a 55 48 bd  |..FL..:......UH.|
-00000400  46 d5 9d 06 39 37 71 f5  73 2f 97 c4 7a 26 0b dc  |F...97q.s/..z&..|
-00000410  8d 46 79 8c 01 54 30 0f  a7 5b 0c d5 1d fd 44 5b  |.Fy..T0..[....D[|
-00000420  ec 03 ac d4 cc de 3a 75  c8 14 e3 d9 c5 92 0d a1  |......:u........|
-00000430  79 3a 86 58 ea a2 02 ee  31                       |y:.X....1|
+00000000  16 03 03 00 89 7a 20 c2  1d 3e 3c 2d 6c c8 b4 49  |.....z ..><-l..I|
+00000010  38 99 74 59 97 53 30 1c  b3 a0 cd d0 01 33 53 cc  |8.tY.S0......3S.|
+00000020  84 f3 db 3b c2 92 6b c0  6e 46 62 04 66 0d 32 cb  |...;..k.nFb.f.2.|
+00000030  72 22 db 95 66 ce ff a6  1f 43 03 05 2d da 47 b1  |r"..f....C..-.G.|
+00000040  34 67 aa 3f eb a5 fa da  c5 2f c1 43 04 62 9e 70  |4g.?...../.C.b.p|
+00000050  9f 07 d1 0d 8c 5b c0 b0  32 2f 2e d3 26 cf 1d 18  |.....[..2/..&...|
+00000060  c6 dc 42 f2 a5 4f d8 64  03 24 17 7c 83 b9 64 1c  |..B..O.d.$.|..d.|
+00000070  33 9b d1 87 59 f8 f4 f5  87 ce 47 f1 59 fe db 78  |3...Y.....G.Y..x|
+00000080  a2 1c ee 71 bb 00 41 cc  0d a0 89 0a b1 aa 16 03  |...q..A.........|
+00000090  03 02 71 7a 20 c2 1d 3e  3c 2d 6d f1 4d 60 35 28  |..qz ..><-m.M`5(|
+000000a0  a5 5f 97 2b 51 5b b2 02  7b b7 eb 23 15 20 02 a0  |._.+Q[..{..#. ..|
+000000b0  a3 fd 7b 90 29 f8 98 2e  d7 6f 05 70 bd 5b 64 d3  |..{.)....o.p.[d.|
+000000c0  aa 67 54 e0 04 b1 7a 5c  5a 4d bb e7 e6 29 34 66  |.gT...z\ZM...)4f|
+000000d0  81 6e 71 94 28 22 90 db  24 c3 c9 bb 9d fb 3b 4c  |.nq.("..$.....;L|
+000000e0  7f fe ba ad 69 ca 87 26  e6 bd 29 5b e2 a7 75 8a  |....i..&..)[..u.|
+000000f0  e5 00 bc 6a 51 42 ff 1f  5b ff a0 b7 e2 0f 9d e6  |...jQB..[.......|
+00000100  b6 62 ff 7d f4 58 a9 98  3e 4d 53 c0 d0 e3 c4 ac  |.b.}.X..>MS.....|
+00000110  46 6f e1 b7 68 5f 5f 90  c2 0b a6 85 9d bf ec 84  |Fo..h__.........|
+00000120  b4 7e 35 91 e0 19 b2 06  f0 55 b6 e4 23 78 a7 c8  |.~5......U..#x..|
+00000130  76 a0 a5 e6 b1 59 fd da  04 bd 49 51 8f 3b 67 37  |v....Y....IQ.;g7|
+00000140  75 73 84 75 b5 88 1c 11  5b 48 be e3 3d db 7e 3c  |us.u....[H..=.~<|
+00000150  9d 1e 95 41 56 67 d2 98  06 36 7f 83 3c 25 a2 4c  |...AVg...6..<%.L|
+00000160  5d 93 b2 75 a3 89 7c a0  e5 bf 2e 21 58 d4 25 ff  |]..u..|....!X.%.|
+00000170  00 e2 01 60 50 33 5c 70  ca a2 20 d6 67 d4 b2 cb  |...`P3\p.. .g...|
+00000180  90 2f 9b 86 4f 1f c5 a4  6d ec 82 60 5b 56 70 7f  |./..O...m..`[Vp.|
+00000190  94 be 72 1a 44 6b 6b 08  e7 5e d4 cb c0 4b b2 cb  |..r.Dkk..^...K..|
+000001a0  ac e8 a9 3e 28 ce b8 9b  93 6b c2 67 4c b7 ad 87  |...>(....k.gL...|
+000001b0  19 d2 c0 b4 5b 29 82 22  10 f0 d0 04 b0 2e 46 fc  |....[)."......F.|
+000001c0  90 c3 d5 0e d1 b6 61 74  ae 4d f2 90 14 51 d3 6f  |......at.M...Q.o|
+000001d0  df cc bb ed bc f9 9b 2b  63 62 bf 08 09 7d 10 31  |.......+cb...}.1|
+000001e0  b8 05 ad f6 ee d5 e5 5c  6e b9 1f 73 c8 bc 9d 33  |.......\n..s...3|
+000001f0  8d b1 1e d3 5b 8f bd ea  b9 8c 02 05 f8 84 ff b7  |....[...........|
+00000200  bd d5 2b ce f4 f9 c7 92  7c 4b 62 17 18 3d 72 40  |..+.....|Kb..=r@|
+00000210  66 cf 8a 02 d0 fa 90 30  62 1d 6d ba 9f b6 53 6c  |f......0b.m...Sl|
+00000220  40 3d e7 eb 2e 88 06 67  8d 53 d9 84 66 a0 c5 9d  |@=.....g.S..f...|
+00000230  60 31 21 40 13 17 10 c2  89 1b 39 8f cd 0f 27 7f  |`1!@......9...'.|
+00000240  d0 84 3e 78 ce 9b 91 5d  8c 67 30 a3 30 e1 77 f5  |..>x...].g0.0.w.|
+00000250  7b 86 6b f4 01 26 c2 46  73 49 1b 69 e0 24 9d 8d  |{.k..&.FsI.i.$..|
+00000260  b2 0b 8b 80 28 05 3e d4  09 e2 f6 90 1f 7f 50 d0  |....(.>.......P.|
+00000270  86 d4 f1 ce a9 4f 2f 3a  4d 9d 72 2c 2d e9 d0 d8  |.....O/:M.r,-...|
+00000280  a3 cb 28 16 f3 1d 11 41  1c c7 92 2d e0 c2 ba 0b  |..(....A...-....|
+00000290  57 86 84 93 d7 a9 51 43  2f d1 df c8 f0 ef e6 b4  |W.....QC/.......|
+000002a0  31 43 c2 1f dc 7c 30 3e  5c b6 6f d7 37 0c de 0f  |1C...|0>\.o.7...|
+000002b0  43 76 6d cd da fb 2a 57  17 9c 0f 53 d1 e5 ce 61  |Cvm...*W...S...a|
+000002c0  00 dc 4b 0f 90 70 3b b6  1c a3 38 1d 5e 0d b1 3d  |..K..p;...8.^..=|
+000002d0  40 15 ec eb 6f ed c9 c6  c5 26 ae da 46 b5 00 6a  |@...o....&..F..j|
+000002e0  68 1e 9d b7 4e 42 a5 a3  4d 8d bc 5e 52 cc a3 44  |h...NB..M..^R..D|
+000002f0  e3 72 86 be 70 d2 cf 11  3a 5f 25 dc 3a b3 e3 ee  |.r..p...:_%.:...|
+00000300  31 45 4b cc 16 03 03 00  e5 7a 20 c2 1d 3e 3c 2d  |1EK......z ..><-|
+00000310  6e 40 dd 3e 1f d0 91 3e  bd 15 68 cb 36 24 40 16  |n@.>...>..h.6$@.|
+00000320  25 71 38 95 f3 ba c6 63  ae aa 29 7a e2 f8 1d 1b  |%q8....c..)z....|
+00000330  79 5f 5a 19 9f 4b eb 30  cf ad f0 72 e8 b4 2a a4  |y_Z..K.0...r..*.|
+00000340  e0 d6 c1 44 b6 05 e2 ba  e7 6e fc 9d 82 59 d1 a6  |...D.....n...Y..|
+00000350  f9 2a bb 15 a8 bd e5 61  e4 7f 8c 17 38 d9 34 0d  |.*.....a....8.4.|
+00000360  21 b5 80 78 7e a6 03 af  af 9d 83 c9 41 d9 89 04  |!..x~.......A...|
+00000370  b7 06 65 33 d4 2b 97 75  a4 8b d5 63 0e c9 06 d6  |..e3.+.u...c....|
+00000380  06 c1 fe ce 96 dc c8 3b  0d 18 02 d4 e7 7e e6 c8  |.......;.....~..|
+00000390  f4 da b0 0f 1b 1c 49 73  b3 85 70 2e 43 d3 89 42  |......Is..p.C..B|
+000003a0  ac 7f 56 69 fd 85 d8 a7  60 90 37 02 b0 c3 fc 87  |..Vi....`.7.....|
+000003b0  10 04 f5 e6 29 a6 24 61  d2 ec ba 6b e9 02 94 b0  |....).$a...k....|
+000003c0  c7 3c b5 9b 74 7e d7 e1  78 ce b2 4d 0c ef 7c cc  |.<..t~..x..M..|.|
+000003d0  c2 a5 32 d3 3b 9a b4 df  07 7a c4 c6 55 bd 95 e1  |..2.;....z..U...|
+000003e0  40 24 5f 92 63 7f 38 ff  6f fb fa 61 1b f3 16 03  |@$_.c.8.o..a....|
+000003f0  03 00 42 7a 20 c2 1d 3e  3c 2d 6f 34 89 7c 3a 9a  |..Bz ..><-o4.|:.|
+00000400  75 0b 68 6b 7e eb 87 c1  30 27 0f 9e 4f 9d 58 f4  |u.hk~...0'..O.X.|
+00000410  27 38 c0 d7 cf 4f 8d 74  7b 18 1f b3 b7 51 16 aa  |'8...O.t{....Q..|
+00000420  53 e8 bc 43 3e 40 1a a4  da 6f b0 57 92 a7 37 4f  |S..C>@...o.W..7O|
+00000430  70 fd f1 bc 77 16 03 03  00 1c 7a 20 c2 1d 3e 3c  |p...w.....z ..><|
+00000440  2d 70 ee 59 90 0a c3 b1  25 e7 67 51 10 b6 9b 06  |-p.Y....%.gQ....|
+00000450  6b 71 66 d2 aa e8                                 |kqf...|
 >>> Flow 13 (client to server)
-00000000  16 03 03 02 71 00 00 00  00 00 00 00 02 f5 32 7e  |....q.........2~|
-00000010  04 f3 fc 4d d0 b8 9e 56  42 3b 9a 13 42 ec 14 11  |...M...VB;..B...|
-00000020  3e ee 93 84 ba 0c ed 8a  b1 96 0f 0d 47 1e 79 6c  |>...........G.yl|
-00000030  b6 56 b6 4a 19 b8 5a 3d  59 a6 9e 74 2d 13 4b b5  |.V.J..Z=Y..t-.K.|
-00000040  0b 2d 0d fb 85 5a d1 c8  7c 43 a8 e2 38 01 02 da  |.-...Z..|C..8...|
-00000050  ee 8c e7 75 01 1d 66 a2  57 04 c7 9c cf c7 4c e5  |...u..f.W.....L.|
-00000060  bd 43 c8 23 24 a3 f9 ce  cf 0b eb 63 48 3d 25 52  |.C.#$......cH=%R|
-00000070  0d 7c 16 07 05 19 3b 10  ca f6 0b d4 68 05 09 dd  |.|....;.....h...|
-00000080  ef 59 b3 69 9d 64 5a de  76 f7 8b ed ed 93 36 7f  |.Y.i.dZ.v.....6.|
-00000090  fa f8 1c a8 df 2d d9 35  0f d8 a3 08 a7 8a c2 37  |.....-.5.......7|
-000000a0  37 db 92 ec 18 aa ae 51  85 d3 a6 15 b4 ba d5 66  |7......Q.......f|
-000000b0  39 08 63 eb 47 c7 91 90  47 fa a4 4a 3b 84 c5 27  |9.c.G...G..J;..'|
-000000c0  7d eb 06 81 56 a2 db 2e  dd 72 18 6c 6f 1a 83 a0  |}...V....r.lo...|
-000000d0  6c 5a e4 44 c1 56 18 d8  b1 bf 26 ce 4f 66 7b 4e  |lZ.D.V....&.Of{N|
-000000e0  b6 9a 02 97 d6 fd 7b fe  c9 8a 20 53 14 1f 78 45  |......{... S..xE|
-000000f0  b4 17 d6 8e 9e a1 92 be  b5 4d 2a 08 0d c2 b8 99  |.........M*.....|
-00000100  96 91 47 87 96 f2 7a d7  1c 86 96 c9 02 1c 09 92  |..G...z.........|
-00000110  6e 07 a4 47 ed 85 c9 c6  16 c5 12 b1 1f 20 2c d1  |n..G......... ,.|
-00000120  ee 47 07 a0 35 f0 b3 c1  19 9e 45 6e 7d 6c 17 b1  |.G..5.....En}l..|
-00000130  4e 29 5f 83 fe 6c 3b ce  94 a9 42 c5 ea 4b 4b 60  |N)_..l;...B..KK`|
-00000140  b1 b2 fd f8 65 ba d7 48  f3 a1 12 84 ae 38 60 4f  |....e..H.....8`O|
-00000150  9e 60 91 4f 75 34 e8 af  df ce 30 0f 15 37 f8 95  |.`.Ou4....0..7..|
-00000160  32 53 31 c8 10 f9 7b 0a  df c7 f3 bc 1b 47 d4 9c  |2S1...{......G..|
-00000170  e7 01 3d c7 c2 e8 01 50  f5 18 87 13 2c c9 d9 bb  |..=....P....,...|
-00000180  4e f4 78 ec ec 67 cd 41  84 9f 62 50 30 d9 34 ea  |N.x..g.A..bP0.4.|
-00000190  86 02 9b 79 b8 f3 f2 e7  47 b8 dd 2d a6 7d 83 e8  |...y....G..-.}..|
-000001a0  9c 5a ca be e7 eb 18 c7  3d cb ea 6f 63 de a8 95  |.Z......=..oc...|
-000001b0  5c cc d4 74 e8 9c 61 4c  e3 5b 83 90 b6 33 d0 9e  |\..t..aL.[...3..|
-000001c0  4e a3 ec cc 33 a0 2c cf  ec f3 6a fb 33 7a 31 fd  |N...3.,...j.3z1.|
-000001d0  a9 66 19 a7 aa 6d ad 7e  16 cc dd e5 21 e2 9f 43  |.f...m.~....!..C|
-000001e0  5f 79 82 7a 2f d8 b5 29  1c 39 ca bc c3 7d 27 2d  |_y.z/..).9...}'-|
-000001f0  1a 24 87 33 67 dc a1 94  da 6f 39 9d 70 14 2b f6  |.$.3g....o9.p.+.|
-00000200  17 2b 8b 9f 46 e0 66 e3  60 13 3b dc d0 f3 fc 12  |.+..F.f.`.;.....|
-00000210  8a c9 cf 5d 47 c3 df 5d  2b a8 ee ff f7 f4 91 44  |...]G..]+......D|
-00000220  10 3c 55 f4 39 43 65 04  af 06 4a 29 72 a4 a2 c2  |.<U.9Ce...J)r...|
-00000230  f9 16 10 2e 75 88 9d 16  ab ae 83 bc 8a b3 16 b0  |....u...........|
-00000240  c5 c0 8f a2 ef b1 f4 dc  16 54 a5 4b f0 ff 87 6b  |.........T.K...k|
-00000250  1e b6 7b fd 58 24 04 dc  e4 e3 49 da c1 b2 9e a9  |..{.X$....I.....|
-00000260  ec 28 ec 13 f3 70 88 7e  f7 ba cd 3f a8 62 87 ea  |.(...p.~...?.b..|
-00000270  0e 90 73 65 0a d0 16 03  03 00 5e 00 00 00 00 00  |..se......^.....|
-00000280  00 00 03 13 86 bf a1 c3  7d e1 3e 6d 38 e6 f7 7a  |........}.>m8..z|
-00000290  17 18 60 06 43 74 ac 36  6a 18 b4 eb 13 71 36 2b  |..`.Ct.6j....q6+|
-000002a0  38 e5 7b 73 16 10 94 82  25 a4 1e c7 da 37 63 73  |8.{s....%....7cs|
-000002b0  91 cc a3 72 61 27 40 e6  66 09 5e 55 e4 28 66 18  |...ra'@.f.^U.(f.|
-000002c0  10 cb 91 1f 2e 64 fd 33  6d 80 a6 7e ed 87 51 0a  |.....d.3m..~..Q.|
-000002d0  27 4c 79 9f 5d ae 1e 3f  1d 16 03 03 00 a0 00 00  |'Ly.]..?........|
-000002e0  00 00 00 00 00 04 13 a1  76 b4 2b af 98 95 67 da  |........v.+...g.|
-000002f0  d7 95 51 6b fb 07 36 56  43 a2 46 70 84 d4 bc cb  |..Qk..6VC.Fp....|
-00000300  c7 07 99 9b ef 98 0e 97  9c 98 86 2d 73 df a7 62  |...........-s..b|
-00000310  17 d4 c4 f4 22 36 aa 1a  54 6d 24 6c fe 4d 60 94  |...."6..Tm$l.M`.|
-00000320  55 cd 6b b8 0b 90 74 07  b1 25 de 91 54 94 6d b0  |U.k...t..%..T.m.|
-00000330  16 f6 46 db f6 81 a8 ea  0b fd 14 f9 69 41 11 e6  |..F.........iA..|
-00000340  6e 27 aa 13 ba 4a fd 02  f9 c7 25 98 5b 52 38 6a  |n'...J....%.[R8j|
-00000350  e5 37 52 16 b1 49 ed 64  2c 2f b5 9d 09 4f f9 52  |.7R..I.d,/...O.R|
-00000360  5b 59 14 5f 29 00 64 a6  9a 60 14 84 a4 fc e0 19  |[Y._).d..`......|
-00000370  98 62 60 c3 d1 ed b8 e4  7f 1a 8a 88 36 4f 14 03  |.b`.........6O..|
-00000380  03 00 19 00 00 00 00 00  00 00 05 5c 46 50 33 d0  |...........\FP3.|
-00000390  f9 d4 34 38 94 5b cf ec  fd b5 78 27 16 03 03 00  |..48.[....x'....|
-000003a0  28 00 00 00 00 00 00 00  00 64 b0 8f 5f 0b ee b9  |(........d.._...|
-000003b0  cf a3 8b 7f c8 f5 c0 15  b4 0b 2c d9 35 d3 10 4c  |..........,.5..L|
-000003c0  d7 a2 85 49 27 da ac 3e  83                       |...I'..>.|
+00000000  16 03 03 02 71 00 00 00  00 00 00 00 02 6f 24 b6  |....q........o$.|
+00000010  bf d6 f9 08 28 0e 73 38  ac 9f 2f cd 67 94 f1 cc  |....(.s8../.g...|
+00000020  90 29 42 a9 39 d6 c4 eb  ca ad a6 e0 70 4b 57 30  |.)B.9.......pKW0|
+00000030  67 fc 7f 96 17 0c 9e cb  8b 4e ad 29 68 6d d9 f7  |g........N.)hm..|
+00000040  ec 39 31 a3 1e ec 26 57  f0 18 42 be 5a df 9e 3d  |.91...&W..B.Z..=|
+00000050  89 34 9c 4d c4 aa fe ae  14 ea 67 15 ca d1 f5 c1  |.4.M......g.....|
+00000060  6d c7 25 d2 b5 6e f3 c6  a9 69 19 c9 d2 8a fc c5  |m.%..n...i......|
+00000070  c5 10 14 cd 30 e2 a6 20  9d 53 32 68 8d f1 d4 d6  |....0.. .S2h....|
+00000080  ea eb 5f 3e 08 24 57 02  65 73 f5 8c 6b d2 67 1d  |.._>.$W.es..k.g.|
+00000090  8b ec ed c5 a2 52 f3 05  c2 96 a6 4c a4 cf e6 c3  |.....R.....L....|
+000000a0  83 8c 24 34 75 d9 07 df  13 e6 14 98 74 6b 1c 30  |..$4u.......tk.0|
+000000b0  3f 2a f8 90 f0 3b 56 5e  d8 2f ce e9 bc a9 42 b1  |?*...;V^./....B.|
+000000c0  ca 35 09 1d 5c 54 a9 53  76 a5 3c 77 16 0e f9 a8  |.5..\T.Sv.<w....|
+000000d0  a1 e0 74 39 6a f3 2b 6c  92 de 33 1b 71 e9 59 2f  |..t9j.+l..3.q.Y/|
+000000e0  7f 5b e5 b4 c3 b7 03 0b  9c 20 94 1e 65 b0 3e 77  |.[....... ..e.>w|
+000000f0  c5 13 f1 e5 83 40 2d 90  f2 e1 52 e7 8d 98 00 15  |.....@-...R.....|
+00000100  9f 0f 99 1a 0d 6e 65 cc  79 7e a7 2e 49 0f 86 e8  |.....ne.y~..I...|
+00000110  a7 e5 06 b4 55 50 30 5c  1f ac 43 a7 9b 8a 80 ff  |....UP0\..C.....|
+00000120  6c 83 3a 42 45 b4 92 69  b4 4a c4 d7 d4 e0 e0 d4  |l.:BE..i.J......|
+00000130  3b cc 1d c6 27 c1 f2 07  a4 f8 cc 6f 2b 9a 3f de  |;...'......o+.?.|
+00000140  f4 1b 8d 51 73 45 ad b4  03 5e 86 02 3a 7c 03 ce  |...QsE...^..:|..|
+00000150  92 a1 8f 71 b1 8a 57 05  1b 54 21 e4 c9 af 32 96  |...q..W..T!...2.|
+00000160  a6 2f df ee e0 54 9f 3f  ba ee fe d0 75 7d 51 92  |./...T.?....u}Q.|
+00000170  81 59 9a 8c 56 35 7f 2d  ee 65 d8 9c 13 2b 3b b2  |.Y..V5.-.e...+;.|
+00000180  1d cd 66 0c 7d 3c 74 b4  7f 97 59 17 46 8f 75 50  |..f.}<t...Y.F.uP|
+00000190  f5 c6 d0 77 ad e7 06 b1  c8 5b 30 fd 9c a0 ac 5f  |...w.....[0...._|
+000001a0  c5 d4 e8 20 21 00 a7 f5  b3 f4 8a 7f eb a2 00 61  |... !..........a|
+000001b0  45 b9 2b 40 f6 9a a6 7f  52 da 94 14 4c 7c d6 e9  |E.+@....R...L|..|
+000001c0  49 68 ed da 90 01 69 cb  f4 dc 55 41 cd 66 16 ed  |Ih....i...UA.f..|
+000001d0  18 e9 e7 1f 02 bf d2 ec  66 12 ff e4 7d dc e2 d8  |........f...}...|
+000001e0  90 ba b7 73 e7 9d 96 77  aa 9c c6 af 62 0c 5c b1  |...s...w....b.\.|
+000001f0  57 0a 03 e4 44 58 7f b3  79 b0 4f f2 78 90 64 d3  |W...DX..y.O.x.d.|
+00000200  41 f4 56 56 30 0c 57 04  8f 11 bd c4 cc b3 9d cb  |A.VV0.W.........|
+00000210  13 a7 81 78 bf cf ed 2d  cc 5c 09 54 ba 36 e7 e0  |...x...-.\.T.6..|
+00000220  a6 42 e8 c1 f7 bd 14 d0  e8 a7 50 71 1f a4 e0 b0  |.B........Pq....|
+00000230  6d d6 98 76 19 0e 2f e3  ad c4 82 04 9e 8a 4a f6  |m..v../.......J.|
+00000240  31 57 01 9b c5 f6 b6 56  7a cb 39 fa 3c 97 52 1c  |1W.....Vz.9.<.R.|
+00000250  88 8d 3c e4 98 d1 72 9a  51 9e d5 36 fd 44 7b 6f  |..<...r.Q..6.D{o|
+00000260  37 c4 76 4b 1f 3a 1f d2  e8 b0 d6 78 29 e8 4a 42  |7.vK.:.....x).JB|
+00000270  6b 83 08 e8 6f 09 16 03  03 00 5e 00 00 00 00 00  |k...o.....^.....|
+00000280  00 00 03 0e 1c a5 6c c1  72 32 d4 eb 06 53 0d 41  |......l.r2...S.A|
+00000290  93 e1 f8 db 43 b3 45 d2  f5 6d 67 32 55 9d 33 1d  |....C.E..mg2U.3.|
+000002a0  fb 12 fe 48 0f e5 a4 83  f0 73 c1 35 03 ea a0 4d  |...H.....s.5...M|
+000002b0  f6 3d d9 31 0b 70 55 52  ba 9d bb f5 8a d3 f3 cd  |.=.1.pUR........|
+000002c0  17 28 24 72 3d 2b fa 57  0a 3a 50 b3 27 91 d5 d2  |.($r=+.W.:P.'...|
+000002d0  a7 5d 99 88 71 98 e9 79  1f 16 03 03 00 a0 00 00  |.]..q..y........|
+000002e0  00 00 00 00 00 04 9f be  d5 6d ea ba e7 46 f1 c5  |.........m...F..|
+000002f0  10 27 c2 47 4c 2a 45 3e  fe 4c 90 e2 3b 8f c5 cf  |.'.GL*E>.L..;...|
+00000300  df d6 93 40 10 65 77 0d  d0 97 1d af 22 8a 48 9f  |...@.ew.....".H.|
+00000310  ba 43 19 19 4a 50 d3 b4  4a f8 70 39 fe b8 39 af  |.C..JP..J.p9..9.|
+00000320  6e d8 e9 3e 33 5d a4 b5  37 a9 88 87 06 4e b8 9f  |n..>3]..7....N..|
+00000330  67 9b 0a fc ec e4 cf 7b  cc 41 6a a3 20 f8 ae 9d  |g......{.Aj. ...|
+00000340  6f f9 85 a9 77 c9 5c 7b  31 75 85 b9 43 a8 cc 5f  |o...w.\{1u..C.._|
+00000350  c1 47 bd 31 15 61 3b ac  8d 2b 92 56 33 12 a8 fa  |.G.1.a;..+.V3...|
+00000360  be 42 03 5f 57 6e 40 63  3f f8 87 d1 4a 5c 11 99  |.B._Wn@c?...J\..|
+00000370  7d 31 cd 13 95 44 e1 a4  22 9b 58 64 6a 25 14 03  |}1...D..".Xdj%..|
+00000380  03 00 19 00 00 00 00 00  00 00 05 c1 fa 7d 26 1e  |.............}&.|
+00000390  2c 71 d5 c8 76 2a 6e 69  58 55 b9 7c 16 03 03 00  |,q..v*niXU.|....|
+000003a0  28 00 00 00 00 00 00 00  00 81 7a 4e 36 a5 96 c0  |(.........zN6...|
+000003b0  9f 46 6e 29 1a cb 06 cd  62 4d a3 14 6c 59 e6 e0  |.Fn)....bM..lY..|
+000003c0  4a ca 84 cb 07 28 5d 1f  a1                       |J....(]..|
 >>> Flow 14 (server to client)
-00000000  14 03 03 00 19 4c d5 cd  3a c7 d7 e7 f5 e7 2e 86  |.....L..:.......|
-00000010  51 c3 3b 33 40 35 de d9  3e f5 90 57 bd 27 16 03  |Q.;3@5..>..W.'..|
-00000020  03 00 28 29 25 c7 32 98  1a fb a1 59 6c 51 99 a6  |..()%.2....YlQ..|
-00000030  06 eb 61 34 58 3b 93 3a  60 32 e3 cd bd 01 53 e7  |..a4X;.:`2....S.|
-00000040  67 2e da 4e 7c 03 18 61  64 12 4f 17 03 03 00 21  |g..N|..ad.O....!|
-00000050  29 25 c7 32 98 1a fb a2  ec 62 50 50 3f b7 95 da  |)%.2.....bPP?...|
-00000060  79 23 b2 31 b4 e7 9b 85  38 24 c8 23 f4 85 88 45  |y#.1....8$.#...E|
-00000070  c2                                                |.|
+00000000  14 03 03 00 19 7a 20 c2  1d 3e 3c 2d 71 89 d6 e0  |.....z ..><-q...|
+00000010  81 c6 82 a7 40 2f 3e 1e  8c e3 e1 8f dc a2 16 03  |....@/>.........|
+00000020  03 00 28 a2 41 d8 86 76  bd 14 82 e7 6a f4 24 2b  |..(.A..v....j.$+|
+00000030  f3 c0 96 9c f0 70 75 11  c8 bc 9c c9 69 95 31 6f  |.....pu.....i.1o|
+00000040  09 7d 55 09 c7 81 0d d5  36 58 bf 17 03 03 00 21  |.}U.....6X.....!|
+00000050  a2 41 d8 86 76 bd 14 83  ff 94 3c e4 8f 4a 25 7a  |.A..v.....<..J%z|
+00000060  45 65 88 77 e6 87 dc 63  29 8f 44 67 70 0d 25 0f  |Ee.w...c).Dgp.%.|
+00000070  de                                                |.|
 >>> Flow 15 (client to server)
-00000000  15 03 03 00 1a 00 00 00  00 00 00 00 01 cd 69 8c  |..............i.|
-00000010  fc f8 75 55 b8 56 94 0b  ce 9f 7b f5 79 d2 8a     |..uU.V....{.y..|
+00000000  15 03 03 00 1a 00 00 00  00 00 00 00 01 26 a8 f1  |.............&..|
+00000010  b6 ae af 74 3b 31 70 08  49 cd 85 ab f4 82 3d     |...t;1p.I.....=|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected
index 769e178e90..387637e2bf 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected
@@ -9,11 +9,11 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 ba 6e a4 42 66  |....Y...U...n.Bf|
-00000010  66 03 9a fd 7d 88 99 9d  83 50 d1 0f a2 3c d0 f2  |f...}....P...<..|
-00000020  50 bc b2 28 55 de 77 9e  89 d9 db 20 54 0e f3 e7  |P..(U.w.... T...|
-00000030  ec e4 8f 8c ef cf ad 4a  c5 22 7c b9 09 cd ca 4a  |.......J."|....J|
-00000040  9a 3c 48 d5 23 2d d1 de  3d a8 66 40 c0 2f 00 00  |.<H.#-..=.f@./..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 8e 2b 17 9a cb  |....Y...U...+...|
+00000010  44 bb cc 82 0f 8f 7e 90  52 0b ee 44 99 25 2d c8  |D.....~.R..D.%-.|
+00000020  47 ae b6 15 36 69 0d f5  b8 6e 38 20 f6 94 68 6b  |G...6i...n8 ..hk|
+00000030  1a 51 d8 1a bb 24 68 7e  05 bf e6 bd 20 82 f0 19  |.Q...$h~.... ...|
+00000040  f3 e7 7a 06 23 8d a1 5d  7a e3 d8 02 c0 2f 00 00  |..z.#..]z..../..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,19 +53,19 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  cd 0c 00 00 c9 03 00 17  41 04 ae d5 bb e6 16 6e  |........A......n|
-000002d0  a7 1f 64 fe b4 af 97 f7  4d 19 46 27 43 ac 23 d2  |..d.....M.F'C.#.|
-000002e0  f8 6f 9b 46 cb 29 d7 68  4c 92 a1 56 12 81 98 54  |.o.F.).hL..V...T|
-000002f0  af fd 12 59 29 a4 dd fa  55 16 c9 54 64 97 a5 f2  |...Y)...U..Td...|
-00000300  ff 44 45 fe 58 3b 01 2b  8a db 04 01 00 80 71 87  |.DE.X;.+......q.|
-00000310  f6 4c f5 10 02 e6 f6 11  eb 02 11 1a 2e 73 85 90  |.L...........s..|
-00000320  ea 60 d1 63 cc eb 4c 65  b5 dc 47 55 51 52 42 d5  |.`.c..Le..GUQRB.|
-00000330  06 e6 0c 91 e1 92 e1 1e  46 53 0c 46 55 b8 50 c6  |........FS.FU.P.|
-00000340  79 cd 31 76 77 89 1c 4f  16 af c0 d5 93 ac c4 03  |y.1vw..O........|
-00000350  6b 13 ec 89 93 1a 65 e2  3a cb c5 58 22 41 99 29  |k.....e.:..X"A.)|
-00000360  25 0c af 53 fc 76 3e 34  1e fd 7c 64 ce 0b f9 04  |%..S.v>4..|d....|
-00000370  df 67 eb 25 b8 32 96 6b  95 fa 60 fe 1c 47 41 99  |.g.%.2.k..`..GA.|
-00000380  e6 eb 6d 73 5d 9c 2d e0  7f e0 0e bd 09 ce 16 03  |..ms].-.........|
+000002c0  cd 0c 00 00 c9 03 00 17  41 04 76 45 d0 d8 e2 07  |........A.vE....|
+000002d0  b2 f0 fd af 1c 34 15 0e  3f 3a d2 f4 6d 40 7f 26  |.....4..?:..m@.&|
+000002e0  3a ea 12 0e f0 f0 c5 66  7d 14 56 5d 55 07 08 dd  |:......f}.V]U...|
+000002f0  a2 5f ea 93 1c ad 1f 1d  1c 28 8e 8d 7c 5f 4b 6d  |._.......(..|_Km|
+00000300  66 d1 58 ae f1 da 43 ce  0e a7 04 01 00 80 a9 bf  |f.X...C.........|
+00000310  00 3b cd b4 58 11 0f a5  b0 b5 2d ac 3c 85 a5 3a  |.;..X.....-.<..:|
+00000320  73 d6 9a 94 e5 fd 67 47  db b6 75 7e 04 5d 47 75  |s.....gG..u~.]Gu|
+00000330  d7 43 03 bd 51 3f ee 1e  54 b5 0e fd 3b 60 81 ef  |.C..Q?..T...;`..|
+00000340  81 26 28 2b 0d b4 74 24  3f 55 fb 32 03 b5 60 57  |.&(+..t$?U.2..`W|
+00000350  9c 69 5a 4a ec 7c 81 f1  e8 2a 81 f6 0b 22 82 6b  |.iZJ.|...*...".k|
+00000360  dc e7 fb 52 6d 33 cb 97  00 c6 f8 df ed f2 6f 58  |...Rm3........oX|
+00000370  63 1e a9 cd 6a 5e 9b fe  69 c5 4e aa 03 ec 7e ba  |c...j^..i.N...~.|
+00000380  38 30 63 77 98 b0 25 66  0e 87 dd 2d 7f 74 16 03  |80cw..%f...-.t..|
 00000390  03 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
@@ -73,179 +73,181 @@
 00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 4d 08  |.....(........M.|
-00000060  a0 d2 73 1b 90 01 0b a7  b2 27 57 18 d5 3e 62 fd  |..s......'W..>b.|
-00000070  e5 3c 66 1d 67 30 48 aa  ca 8a 37 9b ae 40        |.<f.g0H...7..@|
+00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 2f 6c  |.....(......../l|
+00000060  3b 07 9f 28 8a a1 6b 6d  07 43 87 e3 08 25 cb f1  |;..(..km.C...%..|
+00000070  82 54 49 19 67 c9 33 15  34 7a 9f 3e 38 ea        |.TI.g.3.4z.>8.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 87 4f 0d 27 74  |..........(.O.'t|
-00000010  8d 74 48 06 3e da b1 83  fb c6 ea 8b 9b dc 62 6a  |.tH.>.........bj|
-00000020  4d 1d e3 bb 3a 60 96 31  78 5b 07 08 9b 0a a2 f0  |M...:`.1x[......|
-00000030  c1 08 1a                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 28 29 f3 ac 3d c8  |..........()..=.|
+00000010  6d 0c bc be 29 f6 ca 1c  ae fa 41 2a dd b5 fb a2  |m...).....A*....|
+00000020  ec 8a dd a3 cc 6e bc b2  b2 4c f7 22 06 4c 7b 1f  |.....n...L.".L{.|
+00000030  77 77 40                                          |ww@|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 ed 2e c7  |................|
-00000010  81 e8 34 ad f4 1a 42 3b  ae 29 3c 8d 89 6d 73 b7  |..4...B;.)<..ms.|
-00000020  4c 54 33                                          |LT3|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 fe c0 da  |................|
+00000010  da fd 7f 10 6a 29 cd 7a  3b 79 fe e0 0f 37 19 ec  |....j).z;y...7..|
+00000020  d2 15 c7                                          |...|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 1c 87 4f 0d  27 74 8d 74 49 44 5e 78  |......O.'t.tID^x|
-00000010  ed a3 08 d8 53 1b 88 01  e2 a3 39 36 77 80 18 d8  |....S.....96w...|
-00000020  93                                                |.|
+00000000  16 03 03 00 1c 29 f3 ac  3d c8 6d 0c bd d8 1c 55  |.....)..=.m....U|
+00000010  34 2f 9f a7 8c 92 9e 0b  57 46 08 6a 11 54 82 94  |4/......WF.j.T..|
+00000020  e3                                                |.|
 >>> Flow 7 (client to server)
-00000000  16 03 03 00 af 00 00 00  00 00 00 00 02 0e a0 bf  |................|
-00000010  81 6e 32 ab 30 25 62 0a  1d 70 8d 55 58 e2 df e0  |.n2.0%b..p.UX...|
-00000020  8a ff 21 1d 1c 23 be 25  19 d8 bc 8c 72 ec 72 46  |..!..#.%....r.rF|
-00000030  ca 08 97 c6 96 65 80 cc  1b f3 ef a3 77 99 07 ca  |.....e......w...|
-00000040  dd 3b 3b 22 4b f0 04 db  50 8b 9d 5a 05 1d 4c 38  |.;;"K...P..Z..L8|
-00000050  2d bd 29 d5 d7 35 5f 5d  af 00 98 da 3f f2 b8 58  |-.)..5_]....?..X|
-00000060  73 a3 fa 51 0f 32 33 1f  ed 60 1b 6b 23 de 77 17  |s..Q.23..`.k#.w.|
-00000070  5b 9a 8b 05 a9 5e 75 cb  41 c0 6d 42 f4 9a eb 8a  |[....^u.A.mB....|
-00000080  79 cb e6 42 3f 2a da 34  87 07 14 db 60 ee af 8e  |y..B?*.4....`...|
-00000090  db f0 92 eb 91 72 63 db  41 02 7d 52 58 c5 10 98  |.....rc.A.}RX...|
-000000a0  b7 d4 e4 d9 39 f7 46 50  74 e7 d5 8b fe 0b b9 47  |....9.FPt......G|
-000000b0  05 01 a2 51                                       |...Q|
+00000000  16 03 03 00 af 00 00 00  00 00 00 00 02 36 0a ba  |.............6..|
+00000010  2d db 68 c5 94 97 9d 3f  41 71 8d 92 37 4b 12 ca  |-.h....?Aq..7K..|
+00000020  b9 c0 ab 5e 0e 98 f5 fc  28 47 32 c3 98 ca 04 30  |...^....(G2....0|
+00000030  24 14 1f b1 69 86 b0 de  b6 f2 15 f9 e0 eb 5a 37  |$...i.........Z7|
+00000040  69 94 26 8b 8e 19 cb 1a  ba 7f fb a8 b9 61 25 f2  |i.&..........a%.|
+00000050  68 8b 97 af fd 3b 59 04  50 3f 27 97 7b df 61 bd  |h....;Y.P?'.{.a.|
+00000060  cb e7 6d 6a d8 c0 1d 8d  8b fc 68 49 a7 13 bf 5c  |..mj......hI...\|
+00000070  fe 80 70 13 09 0b 35 4a  9b 3c 32 95 0f a2 31 c3  |..p...5J.<2...1.|
+00000080  b5 4f 19 82 30 a1 65 fc  5b 48 16 49 10 2b 2f c5  |.O..0.e.[H.I.+/.|
+00000090  f4 eb 02 87 a8 f7 e4 94  34 72 c9 a6 e6 c4 de 7e  |........4r.....~|
+000000a0  48 50 57 33 9e 30 eb fa  92 e7 9b fe 33 52 2b e5  |HPW3.0......3R+.|
+000000b0  b3 e4 47 b3                                       |..G.|
 >>> Flow 8 (server to client)
-00000000  16 03 03 00 89 87 4f 0d  27 74 8d 74 4a 8e 52 43  |......O.'t.tJ.RC|
-00000010  60 2e 40 7d 58 6c 91 c1  20 8e c5 28 54 26 b8 2c  |`.@}Xl.. ..(T&.,|
-00000020  21 ab 5c 31 9b fc a8 62  c9 62 34 d4 1a 9a 55 d4  |!.\1...b.b4...U.|
-00000030  a9 93 6e 09 44 e1 8d c3  cd e1 3c 1f b6 e5 88 d0  |..n.D.....<.....|
-00000040  e8 74 94 36 7d e6 8b 43  48 46 e5 e2 5d b6 36 f6  |.t.6}..CHF..].6.|
-00000050  cd 65 1c c6 b8 2e 98 f2  93 0d b4 b1 d6 58 92 33  |.e...........X.3|
-00000060  a9 ad 03 db bc 33 10 e6  2e 3c 1d c8 13 ec cd a1  |.....3...<......|
-00000070  3d 53 18 3d 01 7c d6 5f  c2 a0 c3 85 c6 2b 3c 86  |=S.=.|._.....+<.|
-00000080  53 09 72 65 3c d7 33 27  2c 94 4d 22 f5 12 16 03  |S.re<.3',.M"....|
-00000090  03 02 71 87 4f 0d 27 74  8d 74 4b ce 64 cb 8f 07  |..q.O.'t.tK.d...|
-000000a0  66 6b 4d 0c 60 66 5c 92  af 5a 23 08 a5 ad 23 35  |fkM.`f\..Z#...#5|
-000000b0  0e cb 1d ea d1 7e e4 2d  9e dd 50 79 53 9a 46 19  |.....~.-..PyS.F.|
-000000c0  3a 2b f1 c6 c3 cc 81 a3  60 88 00 74 62 c6 ac fd  |:+......`..tb...|
-000000d0  e0 f0 d5 3f da 5b c4 8e  ff dd 81 18 37 b6 19 ef  |...?.[......7...|
-000000e0  a4 95 51 b2 b0 78 3b c5  63 db 37 3e d7 f0 81 2b  |..Q..x;.c.7>...+|
-000000f0  82 32 72 21 c8 2c 0b 8a  c4 d9 d8 74 ae 31 e4 97  |.2r!.,.....t.1..|
-00000100  00 c0 f5 ea b9 07 1e 94  db 6e 71 54 98 22 4f 84  |.........nqT."O.|
-00000110  7a 00 47 df 91 28 39 d4  8e 7f 3b 45 16 49 84 5f  |z.G..(9...;E.I._|
-00000120  57 4f 04 a3 84 7c 4d 67  35 78 1e 17 81 35 60 6f  |WO...|Mg5x...5`o|
-00000130  fe 23 4a 7d fb c6 39 40  c8 43 46 21 c8 95 10 db  |.#J}..9@.CF!....|
-00000140  23 90 e0 b4 bb 5b 6e ef  61 ab 0b cb 18 9f 2c d0  |#....[n.a.....,.|
-00000150  b3 b8 15 11 d3 a2 88 9c  8d 85 5d 99 bd 65 ad 60  |..........]..e.`|
-00000160  a8 58 bd b4 88 d2 d4 c8  08 62 e5 7f 79 53 36 46  |.X.......b..yS6F|
-00000170  5f a1 8b 8c 0f 44 e8 2d  6f 37 e4 ff 00 65 46 09  |_....D.-o7...eF.|
-00000180  42 ce 05 e8 e7 96 5e 9c  06 db a6 eb 78 0f fb 30  |B.....^.....x..0|
-00000190  75 6b 08 65 72 f6 b4 d7  09 d8 3d 64 a3 23 de 27  |uk.er.....=d.#.'|
-000001a0  a6 e7 84 60 28 52 8e 5f  48 f2 cc dd 6e 1b 33 e1  |...`(R._H...n.3.|
-000001b0  e1 9e 71 af 2c e0 1c 44  8c df ca 5b 63 98 5e 70  |..q.,..D...[c.^p|
-000001c0  d0 48 c7 eb 87 4a d3 7a  78 e7 02 2f 75 76 cc 70  |.H...J.zx../uv.p|
-000001d0  19 9c 93 de e5 c0 af fc  ad 9e 43 6c cb 09 c0 95  |..........Cl....|
-000001e0  a5 8e dd e0 b8 61 8a c6  d5 89 95 cf 58 d7 93 9e  |.....a......X...|
-000001f0  4a 66 33 56 f2 d4 0a c6  23 d4 b7 e7 85 23 9b 57  |Jf3V....#....#.W|
-00000200  68 20 22 5c d8 96 d2 dd  90 57 d5 e3 51 22 5d 44  |h "\.....W..Q"]D|
-00000210  4f f3 9c 06 25 f9 b1 98  f5 d1 4d d1 79 c4 51 7f  |O...%.....M.y.Q.|
-00000220  8d 68 c0 44 28 12 86 68  d4 d6 16 11 5c 16 9f ea  |.h.D(..h....\...|
-00000230  82 e9 12 82 dc d5 c1 f7  bd 17 57 f7 bc ef 4a 38  |..........W...J8|
-00000240  f5 4b 36 3a b2 a3 e7 fa  ef b0 d2 02 1b 0d 27 bf  |.K6:..........'.|
-00000250  51 25 99 0d bc 7f 6c 53  71 81 30 e4 c5 1f 24 c8  |Q%....lSq.0...$.|
-00000260  b7 19 c5 d9 e0 c0 a5 52  cc 27 83 da 43 38 a6 98  |.......R.'..C8..|
-00000270  dc 1b ce ec 94 f1 a8 47  41 c6 8e 42 4b 6b 71 35  |.......GA..BKkq5|
-00000280  b4 32 88 87 0f 31 1a 39  73 93 7e 61 c7 46 75 62  |.2...1.9s.~a.Fub|
-00000290  ad db dc 9a b8 a1 33 c3  68 d3 0e 3e 26 f6 e5 51  |......3.h..>&..Q|
-000002a0  d0 d1 35 c7 62 b5 22 dc  e5 23 6a 08 64 12 56 ea  |..5.b."..#j.d.V.|
-000002b0  ae 21 aa 04 ac a0 70 a5  29 27 ff 67 96 63 71 82  |.!....p.)'.g.cq.|
-000002c0  92 7e 87 cc b9 c6 6c f5  20 c2 d2 50 0a 53 78 0f  |.~....l. ..P.Sx.|
-000002d0  6c 84 c2 39 ca 73 75 f0  d6 13 70 2f d7 47 f5 b1  |l..9.su...p/.G..|
-000002e0  6f a8 ac a8 75 34 a5 a2  69 1e b7 ae 59 90 f1 ed  |o...u4..i...Y...|
-000002f0  ce fa 13 66 99 9e d3 3c  7c ad ef 9f 16 b2 a1 9f  |...f...<|.......|
-00000300  42 32 d8 eb 16 03 03 00  e5 87 4f 0d 27 74 8d 74  |B2........O.'t.t|
-00000310  4c 2c ae eb 0c 3d ac 73  0a 49 35 4d 87 66 91 f8  |L,...=.s.I5M.f..|
-00000320  22 3c 47 b8 27 ee b9 7e  2d ac a7 de 12 aa 0e c7  |"<G.'..~-.......|
-00000330  45 a8 da c4 c9 0e 9d 0e  15 75 94 ab 3f f7 52 46  |E........u..?.RF|
-00000340  f8 e5 7f 97 c1 cf 69 eb  90 d3 31 f0 e2 c2 ea ff  |......i...1.....|
-00000350  f8 ed bb 43 61 d3 3c b8  bd 0a f4 81 98 5c 15 ef  |...Ca.<......\..|
-00000360  eb d9 08 86 9f 1a f2 16  e6 bc 05 51 7d 46 d2 79  |...........Q}F.y|
-00000370  18 fe 1f 1a 9f 3a 6f 4d  d7 2e b4 df cb f3 19 bf  |.....:oM........|
-00000380  69 70 d0 d5 51 8a a2 b2  ca 9c 44 a7 ef b1 ea 50  |ip..Q.....D....P|
-00000390  45 43 65 b1 68 9c c4 89  cc 66 4a 76 f5 f5 9b 3b  |ECe.h....fJv...;|
-000003a0  82 54 fe a9 5e aa 53 9d  e0 53 d8 e2 51 4b 55 67  |.T..^.S..S..QKUg|
-000003b0  a4 15 36 f4 0d 99 fe 95  98 bf 8c 9e ad b3 84 f7  |..6.............|
-000003c0  ff 06 92 22 7a a6 c0 8d  a0 61 af 92 d2 32 b6 54  |..."z....a...2.T|
-000003d0  d7 cc 29 59 76 7d 5b 5e  d5 49 ac 91 bd d4 c7 da  |..)Yv}[^.I......|
-000003e0  89 86 82 ac 7a 71 a2 47  6c a0 39 e2 d9 0f 16 03  |....zq.Gl.9.....|
-000003f0  03 00 46 87 4f 0d 27 74  8d 74 4d ab 8d b6 ef 87  |..F.O.'t.tM.....|
-00000400  d3 f4 08 61 5d 78 e1 8b  8e 89 b8 d3 15 d3 a7 88  |...a]x..........|
-00000410  63 9f 34 45 43 1f 26 cb  d3 bd 8f 20 3f 69 53 8d  |c.4EC.&.... ?iS.|
-00000420  a3 69 12 9c 19 54 88 1e  34 68 a9 16 18 92 36 22  |.i...T..4h....6"|
-00000430  c8 b7 48 d3 52 4e 82 21  ce                       |..H.RN.!.|
+00000000  16 03 03 00 89 29 f3 ac  3d c8 6d 0c be 61 86 67  |.....)..=.m..a.g|
+00000010  ed 4a a6 8b 53 5c 8c e0  3e b8 e4 91 8b 45 df 9d  |.J..S\..>....E..|
+00000020  1a 08 eb 71 3b 7c d8 43  9a e3 83 36 d6 5d 9e 4b  |...q;|.C...6.].K|
+00000030  e7 4b b3 a2 f1 98 43 f4  e2 f3 39 cf 2c cb 48 49  |.K....C...9.,.HI|
+00000040  97 33 83 7b 27 b8 16 07  87 8e 6d 5f c8 d8 75 64  |.3.{'.....m_..ud|
+00000050  91 51 3c bf 28 09 c0 87  12 2e e4 7a cc 53 a4 bf  |.Q<.(......z.S..|
+00000060  dc 0c d5 72 26 51 13 d2  9f a5 1b 1d a3 da 91 2b  |...r&Q.........+|
+00000070  e7 dd 5b a4 a7 18 70 2a  4b 87 25 05 e6 e1 14 ec  |..[...p*K.%.....|
+00000080  63 25 d6 f4 31 8e d1 d1  0d 53 1c 80 ea 11 16 03  |c%..1....S......|
+00000090  03 02 71 29 f3 ac 3d c8  6d 0c bf 37 88 e8 06 f8  |..q)..=.m..7....|
+000000a0  ed ce 83 7c 1c 40 a9 7a  6d 0b 99 76 03 89 f6 61  |...|.@.zm..v...a|
+000000b0  a6 18 53 2f ac 03 ba 49  44 bf 76 0d 7e e4 d5 04  |..S/...ID.v.~...|
+000000c0  83 a2 d6 20 23 f3 78 43  b4 d6 85 c0 12 59 89 4d  |... #.xC.....Y.M|
+000000d0  c4 bf b4 e8 99 21 6c 73  82 67 59 1d 86 a8 d5 df  |.....!ls.gY.....|
+000000e0  5f 74 73 3a ef 20 ed 55  c7 0f 20 62 ee 5c 6f 63  |_ts:. .U.. b.\oc|
+000000f0  c6 bc a2 60 3a 5e 27 e9  4c 04 c7 ce 6d 36 3b 7e  |...`:^'.L...m6;~|
+00000100  81 ee bc e3 53 bd ab 52  78 aa 8c 37 f0 6b 9c 1c  |....S..Rx..7.k..|
+00000110  52 63 68 3d 14 0c e2 89  6c 6b 95 4b 97 b8 76 06  |Rch=....lk.K..v.|
+00000120  4b 05 08 92 dc d8 26 56  ae 47 9b 9e 1b e4 16 66  |K.....&V.G.....f|
+00000130  53 63 0e 68 0d 33 f1 68  4d fc fb c5 1e d9 20 2c  |Sc.h.3.hM..... ,|
+00000140  e5 61 27 be aa c9 a0 22  23 c8 ec bd 44 51 20 40  |.a'...."#...DQ @|
+00000150  65 0a 2f 91 47 30 ac 40  91 a9 6e 3a 7c 53 80 2a  |e./.G0.@..n:|S.*|
+00000160  70 f9 fa 93 ad d3 c4 ce  59 89 e7 85 fa cd ee 93  |p.......Y.......|
+00000170  8b f6 c2 96 3b 37 d5 ed  ae 2c 65 ea e5 53 72 3f  |....;7...,e..Sr?|
+00000180  87 5e 8e 08 7b 82 38 fd  95 2e 11 8a 78 b8 f4 07  |.^..{.8.....x...|
+00000190  2c 3a c7 d3 4f 9c 8f 43  7c fa 81 eb f0 c6 16 82  |,:..O..C|.......|
+000001a0  a2 73 d3 76 05 6b 6e 52  49 fc d9 e1 c1 2f 06 d7  |.s.v.knRI..../..|
+000001b0  b6 3c cd d8 35 9c 0b 2b  3c ec 38 21 47 22 1d 3d  |.<..5..+<.8!G".=|
+000001c0  b8 dc 62 86 b5 c4 ab d4  de 15 fe 80 1e 6b d6 56  |..b..........k.V|
+000001d0  cd 62 dc f2 31 f8 a0 b1  b5 93 35 98 e2 5d 97 9b  |.b..1.....5..]..|
+000001e0  f2 ce af bf 3c 38 56 28  17 c9 ae 17 e5 aa e3 8b  |....<8V(........|
+000001f0  7b 3b 5d 67 95 89 94 7e  57 81 8f 2e 33 5c 42 24  |{;]g...~W...3\B$|
+00000200  e4 ea 55 8c eb 23 1a b9  19 72 65 9a e5 30 e5 f9  |..U..#...re..0..|
+00000210  78 31 6e b9 43 45 a3 fd  c6 d8 ad dc 96 70 06 1c  |x1n.CE.......p..|
+00000220  e5 7e 5f c1 f5 00 f7 e7  f2 6a b7 8c 9b bd 77 6a  |.~_......j....wj|
+00000230  1f da 78 4a a9 e1 f1 2e  78 ed 07 57 7d a1 84 67  |..xJ....x..W}..g|
+00000240  27 13 d1 c4 1e 24 0d 0a  85 ea 86 10 fd 21 08 40  |'....$.......!.@|
+00000250  e6 38 66 44 8c 77 07 d7  60 70 9a e6 6d 94 c8 6e  |.8fD.w..`p..m..n|
+00000260  fb 2f ff 30 27 21 b8 f7  16 24 bd 80 b9 56 ce 24  |./.0'!...$...V.$|
+00000270  67 74 b6 c7 cd de 96 3b  d9 10 21 12 c3 83 9e f8  |gt.....;..!.....|
+00000280  d7 fc 6f a8 91 4b f4 ea  47 ff 72 31 56 2f ee 25  |..o..K..G.r1V/.%|
+00000290  34 69 21 17 b2 7f 6e 5e  10 8c 47 0b ca 55 31 3e  |4i!...n^..G..U1>|
+000002a0  ba 22 53 ed 23 85 17 cf  35 6f a9 37 3e 69 7b b7  |."S.#...5o.7>i{.|
+000002b0  f5 a7 61 93 ee c0 f8 ac  62 37 ba 8d ab cf 66 f6  |..a.....b7....f.|
+000002c0  5a fb c6 dd 20 09 89 bb  a8 58 1a 69 4e 91 d3 36  |Z... ....X.iN..6|
+000002d0  23 0d ed f2 32 59 8d 9e  77 76 36 ad 6d bf d9 68  |#...2Y..wv6.m..h|
+000002e0  fe 4b ad 67 9f 8d 13 d9  2e b8 be 1b b2 4f e9 13  |.K.g.........O..|
+000002f0  be 38 63 e1 d8 14 35 b9  ce d0 65 d6 9c f1 c1 d8  |.8c...5...e.....|
+00000300  a4 d7 23 84 16 03 03 00  e5 29 f3 ac 3d c8 6d 0c  |..#......)..=.m.|
+00000310  c0 05 31 37 9f 4e 42 90  51 56 63 6f 86 e9 6d 67  |..17.NB.QVco..mg|
+00000320  0e 7e 8a d6 a9 7a 62 02  94 9b 6b 48 fc a9 bc 94  |.~...zb...kH....|
+00000330  a8 d5 9b 94 5e 3d 50 a0  df f8 23 c0 a3 1f a0 de  |....^=P...#.....|
+00000340  6b c9 75 fa 7f 8e 4a 85  04 d8 2f 97 37 b9 e3 84  |k.u...J.../.7...|
+00000350  25 47 2f 66 d2 68 00 46  12 95 83 d4 9b 4d 1d d2  |%G/f.h.F.....M..|
+00000360  53 50 b8 97 f0 46 64 86  58 be a0 ef 00 c7 50 a3  |SP...Fd.X.....P.|
+00000370  84 9f 3f 41 fe 94 cc 9f  c8 e1 c3 23 a5 02 2b 0e  |..?A.......#..+.|
+00000380  80 d6 f5 30 ed 60 ba 46  fe 3a 08 0d 0e 76 db a5  |...0.`.F.:...v..|
+00000390  ed 18 85 8e a3 81 1c 38  8b a1 3f 1c 72 ea 61 03  |.......8..?.r.a.|
+000003a0  65 68 db 25 8e 8d 93 6a  a5 ce c2 94 eb b1 49 6e  |eh.%...j......In|
+000003b0  f5 e7 99 fa 5f 08 ee 0c  f8 a4 1d e2 3c e2 be 82  |...._.......<...|
+000003c0  50 9e 60 22 fc 0b 58 1e  5a b8 b2 1f 1f be 05 83  |P.`"..X.Z.......|
+000003d0  1f 94 e1 01 29 c1 e8 2a  4b 17 e4 8f 0f 01 e3 3d  |....)..*K......=|
+000003e0  b8 72 54 b8 a5 3e 2f d5  7b 85 7e 5e 30 b8 16 03  |.rT..>/.{.~^0...|
+000003f0  03 00 42 29 f3 ac 3d c8  6d 0c c1 f6 2b 68 fb 23  |..B)..=.m...+h.#|
+00000400  d7 ad 81 aa 70 50 d8 6c  30 bc 09 3d bb ce df 6a  |....pP.l0..=...j|
+00000410  77 7d 83 11 c0 cb 07 c9  5d 0b 85 29 9d 53 7b 70  |w}......]..).S{p|
+00000420  4a 62 ae 0e 98 21 17 8a  b5 a3 c1 03 ce c9 0e 54  |Jb...!.........T|
+00000430  19 c8 af 9f 2a 16 03 03  00 1c 29 f3 ac 3d c8 6d  |....*.....)..=.m|
+00000440  0c c2 ef 6b fd 83 40 47  bf 43 52 68 dd b5 76 2b  |...k..@G.CRh..v+|
+00000450  20 b6 cc 6d eb 52                                 | ..m.R|
 >>> Flow 9 (client to server)
-00000000  16 03 03 02 71 00 00 00  00 00 00 00 03 00 b6 c3  |....q...........|
-00000010  7c 99 6e 21 9b e4 2b 53  e5 ce 3a f3 f5 89 66 c6  ||.n!..+S..:...f.|
-00000020  9a 86 44 cc 73 40 5b 10  79 a4 ec a8 69 78 61 4b  |..D.s@[.y...ixaK|
-00000030  e4 83 ac 19 06 11 9c d3  14 12 6d ad 81 6f 0d 86  |..........m..o..|
-00000040  54 7e 6d 1d 9b 9f 62 98  84 8d 3a 97 46 15 bc c3  |T~m...b...:.F...|
-00000050  d6 fe d6 0d cb ea 41 d9  f5 ac 5b f0 6e 42 bf 2c  |......A...[.nB.,|
-00000060  b3 2e 63 3f 36 e4 d4 13  b9 bf 50 3a f2 6e 41 c8  |..c?6.....P:.nA.|
-00000070  75 8d a1 34 42 1f a7 b2  51 e5 da 41 e0 54 52 24  |u..4B...Q..A.TR$|
-00000080  f6 db 2f 3b e2 39 03 c8  f7 91 07 aa ad 65 cc a7  |../;.9.......e..|
-00000090  bc c3 4e 2f c3 58 0c e4  e0 88 69 ef cb d3 e7 88  |..N/.X....i.....|
-000000a0  a2 fe 9f 4a 49 d1 ad df  6d 14 10 f5 7d c3 bb 2d  |...JI...m...}..-|
-000000b0  fe fe b6 f0 0f a7 cc 57  34 f0 db ff e0 d8 33 b4  |.......W4.....3.|
-000000c0  a5 26 49 b0 65 d5 5b fb  54 9d 86 51 73 bd ef 4c  |.&I.e.[.T..Qs..L|
-000000d0  41 b6 3d f3 3d 3f 2e 45  d5 9c 70 2b 76 ca 22 35  |A.=.=?.E..p+v."5|
-000000e0  2a a7 33 33 7f 6c f3 3a  3e 77 c1 b5 b5 5a d8 4b  |*.33.l.:>w...Z.K|
-000000f0  76 7e 00 d4 eb a5 b8 5e  79 26 0b d7 2b 47 26 7d  |v~.....^y&..+G&}|
-00000100  f6 0d 7d fb d5 e9 1a 9f  d0 08 61 c5 bc b8 6b 94  |..}.......a...k.|
-00000110  4b bb 1b 06 3c f2 ce 2c  f1 e9 d5 94 4e 24 7f ff  |K...<..,....N$..|
-00000120  85 d6 5d 20 d8 d4 09 06  4c 3c 44 26 43 b6 31 7c  |..] ....L<D&C.1||
-00000130  a3 1b bb d6 b6 47 58 61  52 85 f1 f1 10 ce ea ba  |.....GXaR.......|
-00000140  97 f3 85 ea 0e f6 65 40  fa 18 58 7c b4 70 c5 e6  |......e@..X|.p..|
-00000150  16 05 b7 b1 3a 35 7c 72  67 f2 12 68 25 1f 5c 47  |....:5|rg..h%.\G|
-00000160  57 15 ee bd 95 7f 6c 00  c9 36 7e 84 2a 3e 1b 7c  |W.....l..6~.*>.||
-00000170  bc e0 ee 59 06 f7 bb 44  dd d5 26 42 46 49 22 4c  |...Y...D..&BFI"L|
-00000180  2e 1f 82 fb eb 3d 3e 6a  9a fb b1 3e 6c d1 e1 71  |.....=>j...>l..q|
-00000190  99 32 4e 49 34 56 e4 b9  ac dd ad fe 9b db 38 ff  |.2NI4V........8.|
-000001a0  96 e8 9c f2 b5 79 16 29  6b 1e 59 59 d7 e6 6d 5d  |.....y.)k.YY..m]|
-000001b0  bb 29 a5 1e cf 9a 9b a0  40 09 37 9f 4b 19 77 16  |.)......@.7.K.w.|
-000001c0  2a 8f b6 c6 85 88 8a 3e  8a 0a 3d bd 08 92 9b d4  |*......>..=.....|
-000001d0  80 b7 ac 9f da e2 82 67  df cf b8 8b 09 24 f6 01  |.......g.....$..|
-000001e0  2d 6e 8b a3 b3 4b 1b c2  42 d6 ac 41 dc 1a da 1b  |-n...K..B..A....|
-000001f0  e7 8f 30 3f 26 e3 3c 16  34 56 ab f5 cc 57 68 54  |..0?&.<.4V...WhT|
-00000200  83 72 fc f4 61 d2 dd 81  34 f1 ff a6 3e fd 14 9f  |.r..a...4...>...|
-00000210  52 71 07 96 73 27 fe c9  5b 62 f6 80 1b 59 f9 be  |Rq..s'..[b...Y..|
-00000220  5a 8a 63 39 2a 00 e4 e9  9b 92 65 74 08 c5 c8 71  |Z.c9*.....et...q|
-00000230  74 0e bf 2a d7 4b 35 7d  ca 33 25 cb 20 6f f4 91  |t..*.K5}.3%. o..|
-00000240  d3 87 1b 40 47 1c 64 a3  0a 1e 0a c4 51 dc e5 0b  |...@G.d.....Q...|
-00000250  59 1b f6 7e 00 34 0c fb  01 5f b9 b2 df d0 7b 45  |Y..~.4..._....{E|
-00000260  c7 59 2b 6c a9 1a d9 85  7d 2f 50 d4 91 e8 f3 ca  |.Y+l....}/P.....|
-00000270  51 4b c9 d9 d9 dc 16 03  03 00 5e 00 00 00 00 00  |QK........^.....|
-00000280  00 00 04 6d cd 24 ed bc  9b 60 0f 3f 60 b8 5e bf  |...m.$...`.?`.^.|
-00000290  bd 5e 05 05 72 12 00 2e  4b d4 64 ae 07 44 7b 4d  |.^..r...K.d..D{M|
-000002a0  be c0 bc 54 7f 4a 04 1f  dc 0e 68 5d 40 d3 03 4b  |...T.J....h]@..K|
-000002b0  c4 47 d9 06 a5 64 8a b2  27 0b 2e 00 87 4c 22 10  |.G...d..'....L".|
-000002c0  c8 4f 4e 39 cc d5 59 25  c4 13 a0 4e 52 07 e4 0f  |.ON9..Y%...NR...|
-000002d0  63 d4 7a 94 1c 14 27 15  a3 16 03 03 00 a0 00 00  |c.z...'.........|
-000002e0  00 00 00 00 00 05 1a f2  d4 c3 e6 b8 08 78 58 15  |.............xX.|
-000002f0  50 7d 7b 8d 76 47 4e 25  3f 33 69 f0 64 af 1c 4e  |P}{.vGN%?3i.d..N|
-00000300  df a4 55 34 d7 a6 a7 93  0d d2 da e8 39 97 69 ce  |..U4........9.i.|
-00000310  91 9a b4 a9 4e 05 a3 e3  d3 1d 0b d6 1a 64 94 1f  |....N........d..|
-00000320  36 b6 b1 4d b7 a0 b1 85  cd 0b 94 86 c3 bc 60 c9  |6..M..........`.|
-00000330  e5 ec bd 63 8b a4 df 4d  9a bc e3 0c be a7 2b d1  |...c...M......+.|
-00000340  fb 7f 62 7f 6e 27 bf a4  cf 02 95 97 3a 39 90 6c  |..b.n'......:9.l|
-00000350  10 03 59 d7 66 d5 51 fa  6c 11 0d 8a f1 22 aa da  |..Y.f.Q.l...."..|
-00000360  0e d3 91 cc 5b 24 73 97  7e a2 1c 36 c4 3d 36 63  |....[$s.~..6.=6c|
-00000370  84 77 f9 32 73 40 a1 e5  33 c6 d1 cb e9 3d 14 03  |.w.2s@..3....=..|
-00000380  03 00 19 00 00 00 00 00  00 00 06 8b ac 4c 97 5c  |.............L.\|
-00000390  a4 6e 37 24 b4 86 55 61  dd a7 d3 30 16 03 03 00  |.n7$..Ua...0....|
-000003a0  28 00 00 00 00 00 00 00  00 94 a0 5d 37 dc 51 d3  |(..........]7.Q.|
-000003b0  1d 47 1c 65 f7 15 f9 2d  fd ff f8 8f 94 7b 31 7e  |.G.e...-.....{1~|
-000003c0  4e 4d 52 7d 2a 44 86 aa  08                       |NMR}*D...|
+00000000  16 03 03 02 71 00 00 00  00 00 00 00 03 44 f0 d0  |....q........D..|
+00000010  5b e0 72 8f 3d 87 1e 11  b6 07 38 c2 87 c9 43 3b  |[.r.=.....8...C;|
+00000020  17 5d 1e e6 b6 5f 60 3d  aa 22 25 0f a6 a1 e3 c0  |.]..._`=."%.....|
+00000030  13 3e a2 ef f1 90 24 47  06 e7 77 af 6b be 9c 20  |.>....$G..w.k.. |
+00000040  95 25 45 5d 50 50 28 0a  d6 8a 96 11 cd 0a b1 20  |.%E]PP(........ |
+00000050  03 4e e9 0f e4 8d d8 e6  0f e7 c2 0f ea a3 b0 a6  |.N..............|
+00000060  63 09 ac 93 1a cf cf 71  91 cc ef d4 f7 38 28 b3  |c......q.....8(.|
+00000070  21 2d 7e 01 93 6c 6b da  d1 72 d2 b4 83 62 c7 1a  |!-~..lk..r...b..|
+00000080  06 eb 9a 4c 0c b3 26 93  7d 7b fd 87 76 ac 9a 72  |...L..&.}{..v..r|
+00000090  99 5d 5a e2 d7 3b d8 de  0d bb 9e 78 bd 38 d7 9f  |.]Z..;.....x.8..|
+000000a0  21 ea 61 f1 2b 36 2e 27  88 c7 26 7d d5 ca 5f 9e  |!.a.+6.'..&}.._.|
+000000b0  be 9d aa 43 0a 18 5f ef  a8 0c 27 07 01 bb 31 f3  |...C.._...'...1.|
+000000c0  c0 9d c1 66 a8 0e 08 c3  0d 3b 83 c8 2f 13 4f af  |...f.....;../.O.|
+000000d0  89 bc ca 3d 01 00 50 ec  4a ac 4b 90 79 35 c0 5e  |...=..P.J.K.y5.^|
+000000e0  ea 18 48 31 73 bb 62 24  c4 45 7e a1 78 a2 59 cd  |..H1s.b$.E~.x.Y.|
+000000f0  2e 78 80 f4 55 62 37 64  a9 7d b1 ad bf a4 71 54  |.x..Ub7d.}....qT|
+00000100  63 ae aa eb 07 b1 63 e3  70 5d 8e d9 b6 f2 44 d3  |c.....c.p]....D.|
+00000110  e5 f2 b8 af 78 8c ed 9d  69 70 19 19 74 3b 4c c8  |....x...ip..t;L.|
+00000120  6e ee 58 72 e0 82 bb 5b  f7 7c c7 13 7b 57 50 7b  |n.Xr...[.|..{WP{|
+00000130  6f 81 2e 6e 97 08 07 e0  64 ad 9b 50 e0 ed d8 11  |o..n....d..P....|
+00000140  17 27 1b 32 87 ed fd 04  66 7b e3 e8 13 63 e1 98  |.'.2....f{...c..|
+00000150  75 4e 58 ac 0f 32 b0 6a  dd 8c 23 e4 63 e7 20 54  |uNX..2.j..#.c. T|
+00000160  b4 1f 57 95 17 73 aa 67  09 f3 4c 1a 63 94 65 fd  |..W..s.g..L.c.e.|
+00000170  d0 b1 b0 0e e9 f9 62 12  87 d0 1a 4e ca 26 50 4e  |......b....N.&PN|
+00000180  23 c6 3b 52 fe 0e 26 40  2f 0a 03 89 1a 58 5d 89  |#.;R..&@/....X].|
+00000190  91 2b 84 82 ec b2 29 8c  40 d3 a0 ec 57 c8 10 4d  |.+....).@...W..M|
+000001a0  67 2b fb 11 1b 68 58 93  ae bb 6c e7 8b 55 d9 35  |g+...hX...l..U.5|
+000001b0  79 e8 7e bf 58 1f c2 bf  86 d2 7f 60 f7 2b 16 72  |y.~.X......`.+.r|
+000001c0  2d 15 ef fc 71 93 e7 74  0a 28 89 53 f2 62 8c f0  |-...q..t.(.S.b..|
+000001d0  ec 8b 2a bf cf 1b 87 87  18 15 d5 f2 01 59 14 74  |..*..........Y.t|
+000001e0  16 f8 d0 8b 86 f4 5d 6a  d9 59 fe 08 d7 ba 04 e1  |......]j.Y......|
+000001f0  1a 27 78 e0 9d 61 52 8f  98 75 d7 c4 2b fb 62 72  |.'x..aR..u..+.br|
+00000200  d2 42 48 03 22 31 b2 c5  0c e3 f4 b4 c5 01 ae 29  |.BH."1.........)|
+00000210  fd a2 13 eb ed fe 40 5a  50 9f 2e d1 9c 01 d4 81  |......@ZP.......|
+00000220  4c bd 1f d0 19 42 c6 0f  1e 04 f4 91 53 49 63 88  |L....B......SIc.|
+00000230  a8 52 72 fc cc c5 3e 7c  84 90 34 5d b5 ce 2a b0  |.Rr...>|..4]..*.|
+00000240  4b ad 0c 7f e7 9a 56 c4  d3 5c 25 ba d9 67 b9 b1  |K.....V..\%..g..|
+00000250  46 09 86 09 6e be 45 fa  8c bb 8c 0b 57 f2 43 e2  |F...n.E.....W.C.|
+00000260  f2 f3 eb ac 6b 3a 06 ac  76 da 69 d7 94 68 2b 91  |....k:..v.i..h+.|
+00000270  f4 d8 4f a0 2c ce 16 03  03 00 5e 00 00 00 00 00  |..O.,.....^.....|
+00000280  00 00 04 5a cf 0b b8 b8  64 ac f5 5e 9e b0 01 db  |...Z....d..^....|
+00000290  4b 44 cb 17 7b f1 1f 25  79 2f 8b 01 41 83 1b 3c  |KD..{..%y/..A..<|
+000002a0  8e c3 0f 3b 8a 62 97 ed  da 81 cc 46 26 f8 ec 51  |...;.b.....F&..Q|
+000002b0  3e 05 99 d8 33 c7 6f 44  1e f0 11 7d 58 a5 f3 2e  |>...3.oD...}X...|
+000002c0  23 84 61 98 2e c8 d4 95  ae f8 ca 8e 9e 5e 8b 4b  |#.a..........^.K|
+000002d0  b4 ac 49 f1 f1 de da 56  76 16 03 03 00 a0 00 00  |..I....Vv.......|
+000002e0  00 00 00 00 00 05 02 51  00 38 af 32 10 48 88 a2  |.......Q.8.2.H..|
+000002f0  3b b3 35 46 b4 c7 9c 3e  ad ab ff 64 aa 8d 51 78  |;.5F...>...d..Qx|
+00000300  f5 74 d0 b7 56 30 d7 35  d6 f6 bf 7e 92 c8 3a 99  |.t..V0.5...~..:.|
+00000310  85 24 09 53 f8 fc 04 d7  de 43 96 c0 27 76 05 a7  |.$.S.....C..'v..|
+00000320  b7 07 e2 6f 22 c7 d7 b0  85 b1 bf e0 4d 27 df 45  |...o".......M'.E|
+00000330  ac 09 2a 04 1f f7 ed b0  37 f6 73 39 80 a6 b9 27  |..*.....7.s9...'|
+00000340  dc 5d a1 19 19 cd df ce  c2 90 93 26 76 10 fd 8a  |.].........&v...|
+00000350  cf cf bb f3 fb 2d f2 10  df 6e 93 74 2c be 7a 23  |.....-...n.t,.z#|
+00000360  12 97 ae 99 d8 91 d3 12  40 dd c9 2f 58 19 79 d1  |........@../X.y.|
+00000370  a9 84 a5 ea 5c af f2 72  88 36 e1 00 07 52 14 03  |....\..r.6...R..|
+00000380  03 00 19 00 00 00 00 00  00 00 06 71 ef 3b 74 cb  |...........q.;t.|
+00000390  56 03 aa 33 92 b3 2b 14  1b 58 a4 b6 16 03 03 00  |V..3..+..X......|
+000003a0  28 00 00 00 00 00 00 00  00 bd 60 39 44 46 e2 0d  |(.........`9DF..|
+000003b0  9d 6a cf b8 ba 6e ef e8  a7 3f a9 25 ce 8b 51 7a  |.j...n...?.%..Qz|
+000003c0  81 fc 50 67 dc 55 d0 11  18                       |..Pg.U...|
 >>> Flow 10 (server to client)
-00000000  14 03 03 00 19 87 4f 0d  27 74 8d 74 4e 43 bf 50  |......O.'t.tNC.P|
-00000010  ce e3 80 e6 0d d9 86 45  52 b3 62 ff ce 3c 16 03  |.......ER.b..<..|
-00000020  03 00 28 98 56 2f b8 02  4d 74 4f d4 5e fc 4e b5  |..(.V/..MtO.^.N.|
-00000030  48 f8 c5 53 9c 7a dc 4e  ac 75 dc aa 19 c3 d9 ca  |H..S.z.N.u......|
-00000040  23 ae 9f 15 08 1f 2a a1  bb 0a 6f 17 03 03 00 21  |#.....*...o....!|
-00000050  98 56 2f b8 02 4d 74 50  63 4b 9f ac bd f5 73 57  |.V/..MtPcK....sW|
-00000060  6a 17 26 6b 24 3f 74 fc  58 a7 a1 b8 b2 87 86 8e  |j.&k$?t.X.......|
-00000070  b7 16 03 03 00 1c 98 56  2f b8 02 4d 74 51 41 48  |.......V/..MtQAH|
-00000080  a4 ab fb 77 41 24 8b 87  fd 41 f9 39 52 60 66 75  |...wA$...A.9R`fu|
-00000090  d9 ed                                             |..|
+00000000  14 03 03 00 19 29 f3 ac  3d c8 6d 0c c3 1c 92 f7  |.....)..=.m.....|
+00000010  3f c4 1e c9 d0 16 44 4e  c0 95 18 a7 31 93 16 03  |?.....DN....1...|
+00000020  03 00 28 3c f8 a4 be d9  b2 97 71 b0 02 2b a6 74  |..(<......q..+.t|
+00000030  26 e0 d1 dc fb 5e 80 13  4a 4c ef ee 85 4a d0 53  |&....^..JL...J.S|
+00000040  a9 0f a1 44 15 90 f3 6b  d4 2e 2e 17 03 03 00 21  |...D...k.......!|
+00000050  3c f8 a4 be d9 b2 97 72  d0 2b 1b db 4b 45 93 eb  |<......r.+..KE..|
+00000060  6a 9f 79 84 32 ec de 4e  6f 4d 40 d2 51 af e9 46  |j.y.2..NoM@.Q..F|
+00000070  89 16 03 03 00 1c 3c f8  a4 be d9 b2 97 73 f2 99  |......<......s..|
+00000080  89 f3 d9 74 af f5 b8 5f  bc 04 fe f3 67 20 3f 3a  |...t..._....g ?:|
+00000090  3d 25                                             |=%|
 >>> Flow 11 (client to server)
-00000000  15 03 03 00 1a 00 00 00  00 00 00 00 01 68 2c 59  |.............h,Y|
-00000010  c3 45 29 6b 7e 0d 45 5e  4f 80 33 07 5d 8b 7e 15  |.E)k~.E^O.3.].~.|
-00000020  03 03 00 1a 00 00 00 00  00 00 00 02 78 77 81 c1  |............xw..|
-00000030  da 3d 67 44 50 ac b5 2b  1e d6 c0 59 1f 36        |.=gDP..+...Y.6|
+00000000  15 03 03 00 1a 00 00 00  00 00 00 00 01 3e 03 9b  |.............>..|
+00000010  14 92 cf 34 45 d0 e6 94  fd c4 9c 14 58 8b e5 15  |...4E.......X...|
+00000020  03 03 00 1a 00 00 00 00  00 00 00 02 7b 6d 0c ee  |............{m..|
+00000030  ae 77 a8 12 1f ea 4b 4a  f3 9e 58 2d 8e 28        |.w....KJ..X-.(|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected b/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected
index b751f38329..678bfdb609 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected
@@ -9,11 +9,11 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 f6 20 3c 21 84  |....Y...U... <!.|
-00000010  6b 59 08 ad 80 03 17 90  65 e1 6a 69 63 46 4c 89  |kY......e.jicFL.|
-00000020  ad fb 22 5a f2 88 3e c8  a9 93 87 20 e0 48 ea ef  |.."Z..>.... .H..|
-00000030  e5 ad e4 59 00 31 39 25  e7 fd 3e 2f a2 2a 32 11  |...Y.19%..>/.*2.|
-00000040  2a ad 83 35 ea f8 e5 05  87 54 33 d2 c0 2f 00 00  |*..5.....T3../..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 0d aa 10 87 54  |....Y...U......T|
+00000010  c4 b8 34 96 39 d5 bb 7f  82 8f 01 74 3e ef fc 88  |..4.9......t>...|
+00000020  b9 b0 02 d5 a0 98 b6 4c  fe d1 bb 20 37 30 b4 1e  |.......L... 70..|
+00000030  6b a2 33 9f 7a eb 4e 9c  59 de 57 5d 2b a7 80 a5  |k.3.z.N.Y.W]+...|
+00000040  f5 e7 64 3d fa 2d 91 02  74 8c e2 f2 c0 2f 00 00  |..d=.-..t..../..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,19 +53,19 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  cd 0c 00 00 c9 03 00 17  41 04 f3 61 70 23 72 6b  |........A..ap#rk|
-000002d0  0c 87 56 6d f0 0c e8 e8  8e 3c cb ad 1e 41 41 3b  |..Vm.....<...AA;|
-000002e0  ac 17 af 69 01 59 50 64  4b e1 55 11 89 0c 45 4d  |...i.YPdK.U...EM|
-000002f0  cb 2a 1f 8a 01 ef f4 cf  82 1c af ab a3 d9 ef 65  |.*.............e|
-00000300  30 08 d2 cd bc ad 1f 66  00 8e 04 01 00 80 0c 44  |0......f.......D|
-00000310  fa 5e 0a 5d f3 e6 9f d2  08 4e dd f5 02 22 37 1e  |.^.].....N..."7.|
-00000320  10 d5 fb 80 15 25 0a f1  c5 1f 97 66 fc 3e fb cd  |.....%.....f.>..|
-00000330  bb 0e 4d 63 e7 70 ad 1a  95 b6 9b e0 c5 15 c8 64  |..Mc.p.........d|
-00000340  6c c5 e1 ce f2 8a bf 01  33 41 31 1b e4 8e 4a d4  |l.......3A1...J.|
-00000350  82 73 4c c3 3a 16 15 27  55 1c 24 3f e6 b2 43 87  |.sL.:..'U.$?..C.|
-00000360  d4 3e bb 4d ac 8a bf bb  ee d5 0f 06 ac 3f c3 bc  |.>.M.........?..|
-00000370  2a 14 b9 80 f8 0d ff 7a  ae 91 08 69 17 e6 ee 2c  |*......z...i...,|
-00000380  f5 d8 80 b5 8a 70 da e4  b5 0d 3d 51 55 1a 16 03  |.....p....=QU...|
+000002c0  cd 0c 00 00 c9 03 00 17  41 04 c9 6b 86 80 19 10  |........A..k....|
+000002d0  ce 09 18 3b 64 f8 b1 a2  ab 7c 93 90 e5 be a4 34  |...;d....|.....4|
+000002e0  7f df b4 54 89 93 8b 60  fb 5d b3 05 74 65 dc b3  |...T...`.]..te..|
+000002f0  c8 86 71 7d bf 16 bc 96  95 47 43 d8 f0 a3 88 b7  |..q}.....GC.....|
+00000300  dc a2 0d c4 86 65 f3 d4  5e 69 04 01 00 80 69 45  |.....e..^i....iE|
+00000310  c7 29 bf 55 23 d2 56 03  68 dd d1 d5 d4 fd 0f a7  |.).U#.V.h.......|
+00000320  27 93 fc 63 57 a1 64 fc  0b 5e 83 72 19 73 2e 48  |'..cW.d..^.r.s.H|
+00000330  89 10 33 db ec bb d9 ad  f6 55 0d 28 df b6 3e 3c  |..3......U.(..><|
+00000340  d4 c7 29 d3 49 58 be e3  b6 9a 1f e9 6b 13 df 7b  |..).IX......k..{|
+00000350  ab 05 d1 b3 c4 2f 50 9e  6b d6 91 91 07 17 0c 3d  |...../P.k......=|
+00000360  2e 10 c6 02 43 b3 aa 52  70 0a 02 bd a6 e5 7c 92  |....C..Rp.....|.|
+00000370  b0 3a f4 c2 e6 cd f5 b4  b3 31 5f 79 92 65 5d cc  |.:.......1_y.e].|
+00000380  8b fa bd f5 1e 0a bc a8  b4 53 fe a6 94 76 16 03  |.........S...v..|
 00000390  03 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
@@ -73,24 +73,24 @@
 00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 82 21  |.....(.........!|
-00000060  0f 0a 3c 57 97 77 80 ad  c5 a0 d9 c8 55 83 75 1b  |..<W.w......U.u.|
-00000070  7b 66 54 8f 74 77 dc 12  22 32 ba 94 f3 66        |{fT.tw.."2...f|
+00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 3e 37  |.....(........>7|
+00000060  59 15 7b c7 5f aa 2f 10  6b d1 00 f1 a0 64 2b c9  |Y.{._./.k....d+.|
+00000070  3b 38 c1 92 63 b8 9b bf  ec 01 b7 a5 91 52        |;8..c........R|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 9b b2 6a 5a 2e  |..........(..jZ.|
-00000010  76 9a f9 42 0b cb 16 30  8e 45 d6 61 e9 05 57 18  |v..B...0.E.a..W.|
-00000020  65 4d a8 ca 20 8a 1d 37  00 b1 e3 eb eb 66 20 dc  |eM.. ..7.....f .|
-00000030  3e ad 37                                          |>.7|
+00000000  14 03 03 00 01 01 16 03  03 00 28 96 3b 97 5d 87  |..........(.;.].|
+00000010  1a de f5 b7 11 86 32 12  eb 41 59 8a 29 b5 20 bd  |......2..AY.). .|
+00000020  35 7b 47 c7 94 6e c4 d4  4e 58 08 d2 9c 05 05 8f  |5{G..n..NX......|
+00000030  4e 94 ac                                          |N..|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 7a f6 16  |.............z..|
-00000010  3f 4d 4d f0 ce 77 91 77  ae 05 3c 6e 6d e3 7b 0c  |?MM..w.w..<nm.{.|
-00000020  5b 1e 82                                          |[..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 cb cd d9  |................|
+00000010  59 33 0a f1 59 9f 21 86  15 ed cd 3d 5f 21 4c dd  |Y3..Y.!....=_!L.|
+00000020  21 0b 54                                          |!.T|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 1c 9b b2 6a  5a 2e 76 9a fa ec 9f e5  |.......jZ.v.....|
-00000010  8a 90 6b 44 14 61 98 1f  31 ee 5c f3 ee c3 1c 74  |..kD.a..1.\....t|
-00000020  d4                                                |.|
+00000000  16 03 03 00 1c 96 3b 97  5d 87 1a de f6 0c 74 11  |......;.].....t.|
+00000010  ff 59 13 7f f2 0d 64 df  38 d9 2b 37 2c 9e 0d eb  |.Y....d.8.+7,...|
+00000020  2a                                                |*|
 >>> Flow 7 (client to server)
-00000000  15 03 03 00 1a 00 00 00  00 00 00 00 02 ca e0 98  |................|
-00000010  02 b2 04 3d e9 e2 b1 e8  c5 a0 c6 92 e7 7a f0 15  |...=.........z..|
-00000020  03 03 00 1a 00 00 00 00  00 00 00 03 7a 34 47 57  |............z4GW|
-00000030  3f 3f d6 41 7a 98 ef 84  a8 18 9a f4 e7 9d        |??.Az.........|
+00000000  15 03 03 00 1a 00 00 00  00 00 00 00 02 59 28 2e  |.............Y(.|
+00000010  9f a2 16 fd 1b 4a e8 97  72 a6 a3 ed 7d 63 4d 15  |.....J..r...}cM.|
+00000020  03 03 00 1a 00 00 00 00  00 00 00 03 ca db 71 6b  |..............qk|
+00000030  e8 54 f2 da 95 0a 25 e0  c6 70 f0 d9 62 bd        |.T....%..p..b.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-SCT b/src/crypto/tls/testdata/Client-TLSv12-SCT
index 035101f213..d5060b1210 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-SCT
+++ b/src/crypto/tls/testdata/Client-TLSv12-SCT
@@ -9,11 +9,11 @@
 00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
 00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 01 c6 02 00 01  c2 03 03 95 bb 5e 4f e9  |.............^O.|
-00000010  b9 00 35 c4 8a 1b bf 94  f3 54 bc 42 fb 31 e1 fc  |..5......T.B.1..|
-00000020  bd 11 ca 2c 66 dd 95 51  63 5f 9b 20 ad b4 19 67  |...,f..Qc_. ...g|
-00000030  df 54 29 9c cb c2 a8 33  79 10 46 8b 21 99 ca c1  |.T)....3y.F.!...|
-00000040  c1 33 f0 f6 79 28 d8 a1  99 3e f5 3a c0 2f 00 01  |.3..y(...>.:./..|
+00000000  16 03 03 01 c6 02 00 01  c2 03 03 5b 23 16 eb 30  |...........[#..0|
+00000010  c0 5d 25 18 5b 72 0a f4  ab 14 53 84 02 fd d0 7a  |.]%.[r....S....z|
+00000020  f3 e6 55 9c 07 ea e0 f2  0d 26 66 20 31 33 71 51  |..U......&f 13qQ|
+00000030  94 0f 63 20 f2 b4 ea 55  94 91 bf c4 df 84 21 a6  |..c ...U......!.|
+00000040  e8 8a 7b ca 43 6f 43 69  7a 31 01 be c0 2f 00 01  |..{.CoCiz1.../..|
 00000050  7a ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 12  |z...............|
 00000060  01 69 01 67 00 75 00 a4  b9 09 90 b4 18 58 14 87  |.i.g.u.......X..|
 00000070  bb 13 a2 cc 67 70 0a 3c  35 98 04 f9 1b df b8 e3  |....gp.<5.......|
@@ -76,19 +76,19 @@
 00000400  1c f1 0f a1 d8 40 83 61  c9 4c 72 2b 9d ae db 46  |.....@.a.Lr+...F|
 00000410  06 06 4d f4 c1 b3 3e c0  d1 bd 42 d4 db fe 3d 13  |..M...>...B...=.|
 00000420  60 84 5c 21 d3 3b e9 fa  e7 16 03 03 00 cd 0c 00  |`.\!.;..........|
-00000430  00 c9 03 00 17 41 04 3c  22 11 f9 c1 e9 01 52 96  |.....A.<".....R.|
-00000440  0f fb 73 09 2a 25 df 1d  fd fa b6 59 76 3e de 3c  |..s.*%.....Yv>.<|
-00000450  99 0d 45 77 a2 2b 97 7d  9e 81 99 cd 7a ad 2c 0f  |..Ew.+.}....z.,.|
-00000460  94 4c 70 e2 c0 99 ce b4  b1 ca e7 2d 8d 8d e4 c3  |.Lp........-....|
-00000470  31 71 5b d8 56 f9 2c 04  01 00 80 db 38 72 4c 73  |1q[.V.,.....8rLs|
-00000480  fd 64 53 0c 4c 50 cb 8e  dd f4 c4 fa 3c 68 65 41  |.dS.LP......<heA|
-00000490  4f 12 7e 7c e4 2a 49 95  9a 8c 14 cd c6 4d a6 3a  |O.~|.*I......M.:|
-000004a0  20 1b 34 48 f6 ae 0c dd  12 89 9a ee 4a 67 d4 6c  | .4H........Jg.l|
-000004b0  b3 47 bb 29 a4 c9 61 83  4e 41 b6 a6 25 82 8d 54  |.G.)..a.NA..%..T|
-000004c0  2b a0 8b 74 2e 48 6c de  cd 48 a2 67 f5 48 55 1d  |+..t.Hl..H.g.HU.|
-000004d0  d7 fa 36 b5 f5 81 da 2a  1b f8 d0 ae ea b7 15 77  |..6....*.......w|
-000004e0  4a 91 a9 fc d3 9e 59 11  cc 67 80 8d bf 64 20 9b  |J.....Y..g...d .|
-000004f0  a2 f2 6c ba af 8f e9 2c  7f df 17 16 03 03 00 04  |..l....,........|
+00000430  00 c9 03 00 17 41 04 bc  10 c9 49 47 0a 48 cb 16  |.....A....IG.H..|
+00000440  5c bb e6 f6 74 59 df 9c  e9 f3 00 c1 52 69 78 ab  |\...tY......Rix.|
+00000450  65 0b 5e 9f 66 88 31 68  b9 70 03 f7 ae 37 ea c8  |e.^.f.1h.p...7..|
+00000460  4b 7e 09 46 0a af 46 6c  18 4d 34 87 fb d3 bf 3f  |K~.F..Fl.M4....?|
+00000470  44 c5 9e e9 8e 73 b7 04  01 00 80 32 61 11 ce 00  |D....s.....2a...|
+00000480  cb a4 af 1a e8 f8 b2 a4  62 b1 b9 0f 76 8a 46 d0  |........b...v.F.|
+00000490  08 1b 50 76 a1 a6 a4 69  29 77 96 ed 1f c5 f3 cd  |..Pv...i)w......|
+000004a0  92 21 10 2b f3 55 c9 e8  b4 e7 58 1b c9 83 30 01  |.!.+.U....X...0.|
+000004b0  c6 e5 a4 22 ca 9e 12 a5  2d 7f f2 e2 87 df 8b 46  |..."....-......F|
+000004c0  d3 37 28 4f 33 1f d8 27  a4 f1 8a 32 28 fc f7 1f  |.7(O3..'...2(...|
+000004d0  2a 68 10 cd 32 c8 99 ef  b4 e0 52 cd 47 9d 16 35  |*h..2.....R.G..5|
+000004e0  bc 6f c0 8a e5 b9 5c 57  1c 26 5c 45 61 e3 5e d3  |.o....\W.&\Ea.^.|
+000004f0  a4 dc 7d c7 d6 2c 80 77  81 0b 10 16 03 03 00 04  |..}..,.w........|
 00000500  0e 00 00 00                                       |....|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
@@ -96,17 +96,17 @@
 00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 a3 7c  |.....(.........||
-00000060  c1 d7 84 84 5c 0d 7a 55  00 7a 66 a0 1f 29 62 4a  |....\.zU.zf..)bJ|
-00000070  81 c0 8e 3a 59 03 8d d4  6a 8f f0 3a 08 b1        |...:Y...j..:..|
+00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 c5 d9  |.....(..........|
+00000060  a8 f3 c8 f7 ee 39 b5 14  40 34 97 92 b4 cf ac ff  |.....9..@4......|
+00000070  a2 d4 71 ed 0f d1 c2 c3  e5 7d 94 77 89 7e        |..q......}.w.~|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 b6 eb 51 e3 50  |..........(..Q.P|
-00000010  50 a1 50 df 74 59 60 fd  d4 64 59 20 52 3b d5 cd  |P.P.tY`..dY R;..|
-00000020  c4 3e 0e ff bb 37 03 28  99 1e 85 09 ab 9d 95 b3  |.>...7.(........|
-00000030  13 88 84                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 28 19 80 f3 14 0b  |..........(.....|
+00000010  50 0f de c7 1f 73 1e b9  b3 f0 d3 5a f0 33 c4 b7  |P....s.....Z.3..|
+00000020  f2 c5 38 99 f2 01 b6 1c  d5 a6 d5 37 4a 52 d1 92  |..8........7JR..|
+00000030  5d 7f cf                                          |]..|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 64 c7 c3  |.............d..|
-00000010  c5 4a 5f 71 52 87 e8 98  40 4f be 89 17 4f 98 b0  |.J_qR...@O...O..|
-00000020  25 6f 77 15 03 03 00 1a  00 00 00 00 00 00 00 02  |%ow.............|
-00000030  3b 11 51 f1 69 19 7b 14  3c 67 f5 11 3a c9 38 0c  |;.Q.i.{.<g..:.8.|
-00000040  17 3b                                             |.;|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 36 55 d4  |.............6U.|
+00000010  a4 ef 6d 67 c2 45 61 b5  2d 1f d9 97 3c d2 04 41  |..mg.Ea.-...<..A|
+00000020  f4 43 49 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.CI.............|
+00000030  32 9f df ab 07 f9 e6 5d  0a ad 51 63 fe 3b f6 fd  |2......]..Qc.;..|
+00000040  0a 33                                             |.3|
diff --git a/src/crypto/tls/testdata/Server-SSLv3-RSA-3DES b/src/crypto/tls/testdata/Server-SSLv3-RSA-3DES
index 2d47118b90..f6cb8e46e3 100644
--- a/src/crypto/tls/testdata/Server-SSLv3-RSA-3DES
+++ b/src/crypto/tls/testdata/Server-SSLv3-RSA-3DES
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 00 00 2f 01 00 00  2b 03 00 e9 88 fe 66 06  |..../...+.....f.|
-00000010  e0 39 50 68 f2 c4 d5 20  a8 9d a0 6b 05 8c f9 46  |.9Ph... ...k...F|
-00000020  d9 7c 3a 11 dd 6b 89 c1  9d 72 02 00 00 04 00 0a  |.|:..k...r......|
+00000000  16 03 00 00 2f 01 00 00  2b 03 00 24 a1 89 3a e8  |..../...+..$..:.|
+00000010  17 0f 35 02 cf 11 e8 31  71 5d ba f4 82 f1 f4 a1  |..5....1q]......|
+00000020  63 61 2a 99 28 5f 9a 8b  21 ea 00 00 00 04 00 0a  |ca*.(_..!.......|
 00000030  00 ff 01 00                                       |....|
 >>> Flow 2 (server to client)
 00000000  16 03 00 00 31 02 00 00  2d 03 00 00 00 00 00 00  |....1...-.......|
@@ -47,30 +47,30 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 00 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 00 00 84 10 00 00  80 c0 d2 41 18 8c 2d e2  |...........A..-.|
-00000010  f0 17 c1 1d 87 3f c1 be  4e 12 a7 89 f8 97 c8 f6  |.....?..N.......|
-00000020  ec d6 6c 05 f1 ca b0 c7  2c c0 c9 dd c4 bc c8 8e  |..l.....,.......|
-00000030  2d 12 8a 39 86 35 27 43  f7 45 86 5f 63 cc 27 63  |-..9.5'C.E._c.'c|
-00000040  33 ec 8e 55 ce b8 e3 57  a3 39 b0 29 25 cd 96 01  |3..U...W.9.)%...|
-00000050  c1 cc 74 76 56 2b f7 a6  b7 14 6f 8a 01 ec 5a e3  |..tvV+....o...Z.|
-00000060  39 c9 fd 27 16 c3 9e 23  fb 71 82 44 7a 9d 2e 86  |9..'...#.q.Dz...|
-00000070  a3 2d 18 a8 80 8a f4 e0  16 ec 5c c1 cc 1d 8b 96  |.-........\.....|
-00000080  21 88 03 5f c2 1b 57 58  47 14 03 00 00 01 01 16  |!.._..WXG.......|
-00000090  03 00 00 40 7e c9 c9 00  9e 23 fe 77 1a 67 71 31  |...@~....#.w.gq1|
-000000a0  5b 6d 8e f7 fa 05 90 4c  e6 96 87 f9 7a 13 b7 fb  |[m.....L....z...|
-000000b0  55 9e f4 78 c2 bd 10 d5  24 6a 8b 25 52 e6 3a 50  |U..x....$j.%R.:P|
-000000c0  87 2a 57 d2 b9 56 a0 7c  d8 48 06 72 d7 77 63 d9  |.*W..V.|.H.r.wc.|
-000000d0  a4 a1 cc b9                                       |....|
+00000000  16 03 00 00 84 10 00 00  80 c5 e0 de 32 09 54 8b  |............2.T.|
+00000010  8f a1 7c 5c fa 4f 04 d7  66 52 52 14 a0 03 28 21  |..|\.O..fRR...(!|
+00000020  9a 40 e8 d1 21 66 de 85  1a 9f 73 ea e3 6f 8c ef  |.@..!f....s..o..|
+00000030  7f 80 0d 00 2a 68 27 0a  7a 0b 4b 7d a4 a6 e7 0b  |....*h'.z.K}....|
+00000040  61 35 0c 1d 9b c9 7c a8  d8 e8 3b 8a 10 7e c0 5e  |a5....|...;..~.^|
+00000050  e9 d3 ac e1 2a 28 c3 68  d3 ab 96 6d cf 3a 70 f7  |....*(.h...m.:p.|
+00000060  12 a0 85 52 20 38 ef 20  04 df f4 f5 57 0a 99 97  |...R 8. ....W...|
+00000070  da 24 0b c3 81 9e 69 c3  9a cc 5f 69 80 40 93 24  |.$....i..._i.@.$|
+00000080  5a 78 61 be 7d 14 91 50  ad 14 03 00 00 01 01 16  |Zxa.}..P........|
+00000090  03 00 00 40 e9 b5 fa 8a  0c e6 58 1a a6 05 ef 49  |...@......X....I|
+000000a0  75 bd a4 05 af 6b cd 08  65 88 ee 04 b7 49 d1 bc  |u....k..e....I..|
+000000b0  a6 0e 83 37 6b 5d 7e 5d  4b 84 4a ab 7e 3c fe 87  |...7k]~]K.J.~<..|
+000000c0  d8 da bd 88 c9 3a a9 2a  61 49 bf ff ac 10 81 b6  |.....:.*aI......|
+000000d0  f8 f8 10 a8                                       |....|
 >>> Flow 4 (server to client)
-00000000  14 03 00 00 01 01 16 03  00 00 40 1f d7 0b aa 51  |..........@....Q|
-00000010  56 f9 63 e4 29 21 58 29  d4 dd 40 2a 1f 51 b4 ff  |V.c.)!X)..@*.Q..|
-00000020  1c 36 9b 2a 28 c1 1f 19  ea c4 6f 81 74 66 26 0e  |.6.*(.....o.tf&.|
-00000030  3a ad 56 b2 e7 20 43 9d  27 41 cf 59 27 3a 9f d1  |:.V.. C.'A.Y':..|
-00000040  94 f9 b9 3f aa f9 6a 62  6d 00 0e 17 03 00 00 18  |...?..jbm.......|
-00000050  ae b8 4b 53 82 e1 fb c9  a6 da f0 94 da e6 b8 b1  |..KS............|
-00000060  d3 18 25 0a 93 5f 20 54  17 03 00 00 28 74 91 0e  |..%.._ T....(t..|
-00000070  d4 19 0a d3 b5 a2 be a3  c8 d4 99 61 d4 e0 fe 55  |...........a...U|
-00000080  89 23 19 18 6b 4e ad 75  08 ec 4c e1 0c 8b 72 7f  |.#..kN.u..L...r.|
-00000090  6e be 79 fa b1 15 03 00  00 18 09 e2 cd 26 1d f9  |n.y..........&..|
-000000a0  28 44 f7 89 9d c9 0a b9  76 0f 52 76 ad fb 88 01  |(D......v.Rv....|
-000000b0  5f ac                                             |_.|
+00000000  14 03 00 00 01 01 16 03  00 00 40 ec 2d 5a ad c6  |..........@.-Z..|
+00000010  3f a4 cb 6c af e5 fd 24  d1 d5 79 cc 91 f3 fb d6  |?..l...$..y.....|
+00000020  01 3a 0a 2c cf 89 ae 90  49 48 83 cc f8 85 b4 1f  |.:.,....IH......|
+00000030  ff 93 60 25 5f 05 b9 fd  5d ef 8d fa 87 5a a6 77  |..`%_...]....Z.w|
+00000040  c9 ee 8f bb a1 28 52 5c  6e a8 42 17 03 00 00 18  |.....(R\n.B.....|
+00000050  14 a5 b1 7c df 66 c2 f3  1c f6 ef c9 c6 c2 1c 11  |...|.f..........|
+00000060  91 b0 d4 6a a9 a7 80 c3  17 03 00 00 28 cc 2e d8  |...j........(...|
+00000070  63 5b a4 dd 44 51 22 7f  1f 1a a3 ae 42 ae e9 21  |c[..DQ".....B..!|
+00000080  fc 6c ec 07 25 28 1a 3e  e8 e6 e6 15 8f 80 76 e3  |.l..%(.>......v.|
+00000090  56 89 c6 20 0b 15 03 00  00 18 5d 5f d7 ff 88 34  |V.. ......]_...4|
+000000a0  8d 7d 1b 81 ed 29 3e 1b  05 7b 48 47 69 fb 02 32  |.}...)>..{HGi..2|
+000000b0  1c 87                                             |..|
diff --git a/src/crypto/tls/testdata/Server-SSLv3-RSA-AES b/src/crypto/tls/testdata/Server-SSLv3-RSA-AES
index 95d53ea3a1..647eddb642 100644
--- a/src/crypto/tls/testdata/Server-SSLv3-RSA-AES
+++ b/src/crypto/tls/testdata/Server-SSLv3-RSA-AES
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 00 00 2f 01 00 00  2b 03 00 98 96 c0 50 58  |..../...+.....PX|
-00000010  07 cd 39 88 a0 96 36 f0  58 69 63 08 e6 af f9 6a  |..9...6.Xic....j|
-00000020  37 be a2 ce 1e 39 6a ba  88 a6 1f 00 00 04 00 2f  |7....9j......../|
+00000000  16 03 00 00 2f 01 00 00  2b 03 00 f6 aa e8 ab 4b  |..../...+......K|
+00000010  a0 ca 86 5d bf ca 26 5b  b6 75 3b 97 dc 3d 25 51  |...]..&[.u;..=%Q|
+00000020  d3 f9 c7 af 7a 76 4f 55  54 6d 4f 00 00 04 00 2f  |....zvOUTmO..../|
 00000030  00 ff 01 00                                       |....|
 >>> Flow 2 (server to client)
 00000000  16 03 00 00 31 02 00 00  2d 03 00 00 00 00 00 00  |....1...-.......|
@@ -47,31 +47,31 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 00 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 00 00 84 10 00 00  80 da 22 cc 51 b1 96 19  |..........".Q...|
-00000010  c2 7c d5 98 b6 ad f7 0b  af a5 85 db ef c3 3d 89  |.|............=.|
-00000020  94 e6 fb 3d be b6 b3 33  df 7a ab 2e 18 c5 d8 0f  |...=...3.z......|
-00000030  77 67 86 60 68 60 d6 40  f0 e3 de 81 05 a0 46 f1  |wg.`h`.@......F.|
-00000040  00 ed 2c 60 7e 82 71 ab  cc ba a5 0d d3 55 2f 10  |..,`~.q......U/.|
-00000050  aa 62 9e 40 c0 c2 74 bd  0a 8f e3 55 05 ca 97 2a  |.b.@..t....U...*|
-00000060  72 3e fe 26 e0 9c 81 a3  67 57 13 44 9d 28 d9 4f  |r>.&....gW.D.(.O|
-00000070  bd b9 ed cd 9b ae e7 f1  be b3 f2 00 00 f5 1a 95  |................|
-00000080  19 e5 bc da e8 b9 1a cd  bf 14 03 00 00 01 01 16  |................|
-00000090  03 00 00 40 3e 39 5f aa  d0 91 3d a2 95 9e cd a7  |...@>9_...=.....|
-000000a0  ef a7 19 85 2e 4d 56 a7  d6 a9 34 29 00 03 d3 61  |.....MV...4)...a|
-000000b0  44 2a ef 83 58 72 64 03  9a 0e 17 e1 b2 58 12 bf  |D*..Xrd......X..|
-000000c0  7c 34 2b 4e 69 bc 25 21  bd bb 67 eb 05 9c 4c 48  ||4+Ni.%!..g...LH|
-000000d0  af e7 ae cf                                       |....|
+00000000  16 03 00 00 84 10 00 00  80 3d 72 68 31 73 65 81  |.........=rh1se.|
+00000010  2f 15 5b 7b d2 c0 34 2a  f9 95 1a fa c1 07 c0 1f  |/.[{..4*........|
+00000020  e8 35 3c 32 58 a0 e3 c1  8a ff 23 78 18 5e 32 29  |.5<2X.....#x.^2)|
+00000030  66 ef 08 b0 29 d5 92 f8  23 5b a9 55 14 ca 00 9f  |f...)...#[.U....|
+00000040  12 86 50 49 1f 5b 55 13  d1 f0 fc da 95 54 75 8e  |..PI.[U......Tu.|
+00000050  55 5c 00 6d e6 8e 54 9e  d1 8a 05 fe a9 a5 c7 85  |U\.m..T.........|
+00000060  45 8b f6 f9 5b 96 04 f9  f2 7b 01 01 4b 5f e3 5c  |E...[....{..K_.\|
+00000070  c0 5a 9c 54 a5 1f e8 d0  92 5d ca af 5d db 4e f3  |.Z.T.....]..].N.|
+00000080  fb 24 98 b5 01 5e 21 58  b1 14 03 00 00 01 01 16  |.$...^!X........|
+00000090  03 00 00 40 4c 0e 28 67  35 3a fb 62 a8 f1 1c 2d  |...@L.(g5:.b...-|
+000000a0  da 41 56 a2 47 5b 6b 7d  e6 ee ca 94 05 57 af cf  |.AV.G[k}.....W..|
+000000b0  a5 2b d9 a0 58 a4 ff 01  e8 29 33 a7 90 fa 35 cc  |.+..X....)3...5.|
+000000c0  33 92 84 62 3b 99 bd 83  c2 c1 68 56 c2 18 bc 22  |3..b;.....hV..."|
+000000d0  d6 2f 7d 37                                       |./}7|
 >>> Flow 4 (server to client)
-00000000  14 03 00 00 01 01 16 03  00 00 40 2c 41 74 b3 4b  |..........@,At.K|
-00000010  f6 64 e5 8d cc d4 c9 d2  3b 15 36 51 28 89 8b 9d  |.d......;.6Q(...|
-00000020  78 0b 59 8e f6 6b a0 f6  a9 0e 2d 61 bc 09 bb 90  |x.Y..k....-a....|
-00000030  a2 7f 01 9b 66 e6 89 a6  f7 d1 03 7e 07 87 aa b8  |....f......~....|
-00000040  0a aa 26 1c 50 3b dc 6e  d2 68 37 17 03 00 00 20  |..&.P;.n.h7.... |
-00000050  5d 77 60 d7 03 01 4f c1  2e 8d f9 5b 6e 36 3d 2c  |]w`...O....[n6=,|
-00000060  e2 10 07 54 aa 78 f4 95  a8 6d 87 e0 8f a4 b4 a3  |...T.x...m......|
-00000070  17 03 00 00 30 b1 90 35  d8 b6 93 a1 39 7e ff 3c  |....0..5....9~.<|
-00000080  99 2b 12 52 48 2b 95 74  02 ae 31 15 69 00 c0 99  |.+.RH+.t..1.i...|
-00000090  5c de 2f f2 a6 a8 64 03  67 e2 1a ca 2e 9d 83 f3  |\./...d.g.......|
-000000a0  a7 2f ae 5e b2 15 03 00  00 20 9e 04 0a 49 d2 cb  |./.^..... ...I..|
-000000b0  b5 55 cc e6 ef d2 64 1e  a3 f2 2f f3 0e e5 cd 05  |.U....d.../.....|
-000000c0  6c 43 7e c1 83 a1 a9 08  88 f2                    |lC~.......|
+00000000  14 03 00 00 01 01 16 03  00 00 40 3a 79 26 3a 75  |..........@:y&:u|
+00000010  84 84 1e bc 09 02 1e 2f  96 8b d3 e9 ed f6 3f b5  |......./......?.|
+00000020  5c ea 6e f8 c0 9c ff c8  d4 8c 1f 0c 45 51 32 30  |\.n.........EQ20|
+00000030  60 a1 54 8e a8 d0 2c 16  97 6b 2e 56 2c f3 b9 69  |`.T...,..k.V,..i|
+00000040  f2 80 3b c9 a6 d3 53 de  e4 61 e8 17 03 00 00 20  |..;...S..a..... |
+00000050  51 ab 4e 58 99 62 26 98  63 34 3a ee aa dc 74 17  |Q.NX.b&.c4:...t.|
+00000060  a4 43 a7 97 53 18 3f 1c  43 f4 04 2d ba 8d f5 29  |.C..S.?.C..-...)|
+00000070  17 03 00 00 30 3c 31 84  e4 57 fa e5 ed f1 e6 8b  |....0<1..W......|
+00000080  8a d7 2e af 97 88 91 4d  b3 f1 63 99 1c c9 30 74  |.......M..c...0t|
+00000090  50 f6 a1 9d a3 4a 6b 5b  30 61 5b a7 7e b6 5f 24  |P....Jk[0a[.~._$|
+000000a0  09 af af 52 a9 15 03 00  00 20 5f a3 4e f7 60 bd  |...R..... _.N.`.|
+000000b0  a4 19 44 24 09 3b fe 0f  ea 75 e8 f9 79 80 0a 37  |..D$.;...u..y..7|
+000000c0  18 98 3f 56 4b 3e 21 eb  70 82                    |..?VK>!.p.|
diff --git a/src/crypto/tls/testdata/Server-SSLv3-RSA-RC4 b/src/crypto/tls/testdata/Server-SSLv3-RSA-RC4
index e923858182..2868d6ba8d 100644
--- a/src/crypto/tls/testdata/Server-SSLv3-RSA-RC4
+++ b/src/crypto/tls/testdata/Server-SSLv3-RSA-RC4
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 00 00 2f 01 00 00  2b 03 00 50 cf d4 a6 65  |..../...+..P...e|
-00000010  54 70 be f8 62 a5 4c 4c  fe 8d 95 2b b0 8d 6e 24  |Tp..b.LL...+..n$|
-00000020  55 f6 ab 38 92 3a 8f 2e  ea c9 be 00 00 04 00 05  |U..8.:..........|
+00000000  16 03 00 00 2f 01 00 00  2b 03 00 6e 74 3e 5d f4  |..../...+..nt>].|
+00000010  b5 4a 4a 5b d6 fc 29 d8  be 87 68 cf ce a5 ee 14  |.JJ[..)...h.....|
+00000020  8a 7a 44 1d 03 27 8c fd  00 1b 83 00 00 04 00 05  |.zD..'..........|
 00000030  00 ff 01 00                                       |....|
 >>> Flow 2 (server to client)
 00000000  16 03 00 00 31 02 00 00  2d 03 00 00 00 00 00 00  |....1...-.......|
@@ -47,26 +47,26 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 00 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 00 00 84 10 00 00  80 83 ae 5a 77 34 4e 28  |...........Zw4N(|
-00000010  46 f3 85 fd 5d 78 2d a4  c2 0c 08 e0 ff 2a a9 c9  |F...]x-......*..|
-00000020  11 5e b3 e3 43 ae 27 b3  3a 02 58 37 47 60 26 ad  |.^..C.'.:.X7G`&.|
-00000030  cc 73 7e 61 0c 85 26 48  67 41 c1 af 3e 9e 12 12  |.s~a..&HgA..>...|
-00000040  1a 4b 6c e2 d3 50 11 dd  e0 0f cf 66 3e 02 a1 40  |.Kl..P.....f>..@|
-00000050  f9 99 84 4a 70 59 6b f8  a6 1d 0b cc ce 1c 9a eb  |...JpYk.........|
-00000060  9f 06 ee 5e 83 56 7d c6  e7 e4 f9 53 eb 4a be 83  |...^.V}....S.J..|
-00000070  ac 40 58 29 7a 9f c8 2c  fd 9d e7 8b c2 0f a5 31  |.@X)z..,.......1|
-00000080  69 c4 7e 83 f9 e3 98 11  39 14 03 00 00 01 01 16  |i.~.....9.......|
-00000090  03 00 00 3c de ad 44 cc  e1 9e 4d 03 28 51 6b f6  |...<..D...M.(Qk.|
-000000a0  43 79 1c 80 a9 73 a0 d0  b7 24 b6 20 d3 8a c2 36  |Cy...s...$. ...6|
-000000b0  12 a9 7f 77 93 8d 84 ff  74 7d d9 3b bf 8c e5 21  |...w....t}.;...!|
-000000c0  46 8f 4d e1 6d 33 4c b8  16 5b 84 ca 6c 96 3a 65  |F.M.m3L..[..l.:e|
+00000000  16 03 00 00 84 10 00 00  80 0d 70 3b bc b1 b4 f8  |..........p;....|
+00000010  4e f7 9c 7e c6 33 c9 d2  af 4d ae 0f 65 55 68 1c  |N..~.3...M..eUh.|
+00000020  a0 af ad cc cd 25 a8 05  31 d8 50 11 45 cc 44 e6  |.....%..1.P.E.D.|
+00000030  89 1e a6 76 12 0e 8a ac  a6 d3 6c 53 69 d5 e4 6d  |...v......lSi..m|
+00000040  37 90 b8 af b7 ab 3e 84  d2 7e 42 27 81 0d c4 f8  |7.....>..~B'....|
+00000050  6c 54 62 58 83 33 53 ab  3c 1e dd ba 8f 3b ef f6  |lTbX.3S.<....;..|
+00000060  d3 f3 e4 6e 6c 5e ff 94  69 9a d3 be 69 26 db 40  |...nl^..i...i&.@|
+00000070  2e a2 79 c2 b3 71 bb 8c  e7 7c 15 5e 16 fe cf 4c  |..y..q...|.^...L|
+00000080  b1 25 df ac b1 42 86 0e  cb 14 03 00 00 01 01 16  |.%...B..........|
+00000090  03 00 00 3c 94 08 28 54  f4 2c d0 3b dd 1e 0f 7b  |...<..(T.,.;...{|
+000000a0  d7 cf 61 36 1b 50 e7 46  e3 5f cc cd 4d dc f6 7a  |..a6.P.F._..M..z|
+000000b0  37 15 20 62 af e2 38 c7  48 42 1b 3f 70 65 84 97  |7. b..8.HB.?pe..|
+000000c0  42 a5 52 e7 fe 33 c6 27  97 10 db 17 42 10 5b f1  |B.R..3.'....B.[.|
 >>> Flow 4 (server to client)
-00000000  14 03 00 00 01 01 16 03  00 00 3c a7 2b a6 b8 65  |..........<.+..e|
-00000010  9e 01 c0 75 44 f6 23 f5  e3 ef c2 e3 07 0a e9 9e  |...uD.#.........|
-00000020  4d 37 29 0f d0 af fe cc  dc b6 48 e9 4c 9f 05 23  |M7).......H.L..#|
-00000030  86 72 92 1c 19 9b c6 90  ca 34 8e b0 66 9b 3a 48  |.r.......4..f.:H|
-00000040  e9 e8 e4 61 b4 a9 38 17  03 00 00 21 3e c6 4d f5  |...a..8....!>.M.|
-00000050  c4 1e e9 ce 3d 83 1a fa  02 0c 29 4f ac 75 9f 40  |....=.....)O.u.@|
-00000060  53 3a c0 37 0e 6c 04 1c  cc cb 91 4e d8 15 03 00  |S:.7.l.....N....|
-00000070  00 16 25 5a d7 53 a3 cd  7c 97 a1 df 22 c9 ee 3c  |..%Z.S..|..."..<|
-00000080  c9 d5 d7 76 ec cb a0 72                           |...v...r|
+00000000  14 03 00 00 01 01 16 03  00 00 3c 62 42 ff 8f e7  |..........<bB...|
+00000010  72 88 7a f0 80 c1 8e 67  bf f1 0a 20 e4 89 ba f9  |r.z....g... ....|
+00000020  c5 79 1b 68 82 36 0f 88  64 1f e8 31 bf 8c 40 fd  |.y.h.6..d..1..@.|
+00000030  9f 77 1c 99 18 16 d0 ac  00 68 44 ee 5f d2 00 d2  |.w.......hD._...|
+00000040  5c e6 7e f3 03 88 52 17  03 00 00 21 2b d8 95 ab  |\.~...R....!+...|
+00000050  5f 0e 36 84 cb 0c 20 87  72 72 88 a8 95 62 84 81  |_.6... .rr...b..|
+00000060  0a 78 b9 b9 76 dd 52 89  b4 09 19 83 ee 15 03 00  |.x..v.R.........|
+00000070  00 16 de e9 58 8d d1 00  51 da 2b 9f 07 bd 05 db  |....X...Q.+.....|
+00000080  65 80 d0 11 6f 1c 56 b4                           |e...o.V.|
diff --git a/src/crypto/tls/testdata/Server-TLSv10-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Server-TLSv10-ECDHE-ECDSA-AES
index c1aaf1c8a4..0973c0a52e 100644
--- a/src/crypto/tls/testdata/Server-TLSv10-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Server-TLSv10-ECDHE-ECDSA-AES
@@ -1,11 +1,10 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 5e 01 00 00  5a 03 01 1c 20 d0 13 04  |....^...Z... ...|
-00000010  97 f2 67 6f ca 9b c0 14  b9 b3 9e 83 a9 53 09 10  |..go.........S..|
-00000020  60 45 a5 ca 3a 09 25 f1  c6 39 c2 00 00 04 c0 0a  |`E..:.%..9......|
-00000030  00 ff 01 00 00 2d 00 0b  00 04 03 00 01 02 00 0a  |.....-..........|
-00000040  00 1c 00 1a 00 17 00 19  00 1c 00 1b 00 18 00 1a  |................|
-00000050  00 16 00 0e 00 0d 00 0b  00 0c 00 09 00 0a 00 0f  |................|
-00000060  00 01 01                                          |...|
+00000000  16 03 01 00 4f 01 00 00  4b 03 01 2b 50 d8 3b 1f  |....O...K..+P.;.|
+00000010  df 1c ad 85 72 c0 cc 9c  4b 34 83 2c e5 1f a8 da  |....r...K4.,....|
+00000020  f2 74 50 de b9 7f 76 03  6a 0e 99 00 00 04 c0 0a  |.tP...v.j.......|
+00000030  00 ff 01 00 00 1e 00 0b  00 04 03 00 01 02 00 0a  |................|
+00000040  00 0a 00 08 00 1d 00 17  00 19 00 18 00 16 00 00  |................|
+00000050  00 17 00 00                                       |....|
 >>> Flow 2 (server to client)
 00000000  16 03 01 00 31 02 00 00  2d 03 01 00 00 00 00 00  |....1...-.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -43,41 +42,41 @@
 00000210  0e bd 3f a3 8c 25 c1 33  13 83 0d 94 06 bb d4 37  |..?..%.3.......7|
 00000220  7a f6 ec 7a c9 86 2e dd  d7 11 69 7f 85 7c 56 de  |z..z......i..|V.|
 00000230  fb 31 78 2b e4 c7 78 0d  ae cb be 9e 4e 36 24 31  |.1x+..x.....N6$1|
-00000240  7b 6a 0f 39 95 12 07 8f  2a 16 03 01 00 d6 0c 00  |{j.9....*.......|
-00000250  00 d2 03 00 17 41 04 1e  18 37 ef 0d 19 51 88 35  |.....A...7...Q.5|
+00000240  7b 6a 0f 39 95 12 07 8f  2a 16 03 01 00 d5 0c 00  |{j.9....*.......|
+00000250  00 d1 03 00 17 41 04 1e  18 37 ef 0d 19 51 88 35  |.....A...7...Q.5|
 00000260  75 71 b5 e5 54 5b 12 2e  8f 09 67 fd a7 24 20 3e  |uq..T[....g..$ >|
 00000270  b2 56 1c ce 97 28 5e f8  2b 2d 4f 9e f1 07 9f 6c  |.V...(^.+-O....l|
 00000280  4b 5b 83 56 e2 32 42 e9  58 b6 d7 49 a6 b5 68 1a  |K[.V.2B.X..I..h.|
-00000290  41 03 56 6b dc 5a 89 00  8b 30 81 88 02 42 00 c2  |A.Vk.Z...0...B..|
-000002a0  47 1b 12 66 fd 8f a4 95  1d db 94 47 a5 52 97 2d  |G..f.......G.R.-|
-000002b0  1e b6 98 f9 d7 95 c0 84  07 95 40 8a ca 0c 76 07  |..........@...v.|
-000002c0  ec a7 9c 2e bf 5e cf 59  d0 dd 38 0f 70 9b 38 25  |.....^.Y..8.p.8%|
-000002d0  7a 2f 24 92 c7 aa fe ec  5c 1c b6 61 30 8b 86 e6  |z/$.....\..a0...|
-000002e0  02 42 00 c5 8b f0 3a ad  a3 0d 95 21 69 b2 e4 e8  |.B....:....!i...|
-000002f0  d6 ac f7 b8 f3 a8 02 85  d6 32 6e db 00 85 ae 84  |.........2n.....|
-00000300  59 34 2a 9e 6e d3 c4 fc  4c c6 9f 0f d0 a0 3b 87  |Y4*.n...L.....;.|
-00000310  ad d7 aa 51 54 4e ad 76  dc 33 66 7a 5c 87 d0 da  |...QTN.v.3fz\...|
-00000320  52 08 04 73 16 03 01 00  04 0e 00 00 00           |R..s.........|
+00000290  41 03 56 6b dc 5a 89 00  8a 30 81 87 02 42 01 87  |A.Vk.Z...0...B..|
+000002a0  16 fb 72 db d2 a4 23 7f  d9 7d 42 2c e5 f1 4c 7e  |..r...#..}B,..L~|
+000002b0  76 30 90 3b cb a3 60 43  8a 9b 22 b3 fe e2 97 a0  |v0.;..`C..".....|
+000002c0  6f 6e 74 cb c1 c9 f3 59  63 18 e3 cb 7a a6 82 86  |ont....Yc...z...|
+000002d0  f0 f8 40 e0 38 3c 6e 8d  aa 18 79 89 fc 5f 93 8d  |..@.8<n...y.._..|
+000002e0  02 41 6d 23 f9 c2 4c 6d  da a8 be 8a e9 b5 d5 cc  |.Am#..Lm........|
+000002f0  28 f0 48 0c 7d a8 80 60  02 9f fc f9 38 a1 e3 5b  |(.H.}..`....8..[|
+00000300  b5 f4 11 d5 f3 94 52 f2  c2 73 5f b7 05 2b 96 7c  |......R..s_..+.||
+00000310  27 4d 94 94 f2 00 0a 50  53 e6 72 1f 2d fb 91 1b  |'M.....PS.r.-...|
+00000320  d1 67 cf 16 03 01 00 04  0e 00 00 00              |.g..........|
 >>> Flow 3 (client to server)
-00000000  16 03 01 00 46 10 00 00  42 41 04 4d 54 b0 3d 83  |....F...BA.MT.=.|
-00000010  28 38 7a 5b 69 46 a3 40  50 4a 25 13 e6 9a fd 4c  |(8z[iF.@PJ%....L|
-00000020  fe 93 66 89 f3 11 b0 98  08 7d 0d 87 84 ca 98 4a  |..f......}.....J|
-00000030  4d 3a 8a 50 13 27 ec 89  bd 03 f6 6c 02 2a 8c c6  |M:.P.'.....l.*..|
-00000040  dd d6 c4 43 fc fa 59 59  4e 96 9a 14 03 01 00 01  |...C..YYN.......|
-00000050  01 16 03 01 00 30 22 1f  07 a7 54 f9 c7 1c 98 c1  |.....0"...T.....|
-00000060  2b 89 61 7a 3c 7e 59 1a  2a 73 bd 9d ee 88 76 16  |+.az<~Y.*s....v.|
-00000070  07 22 08 7a c9 1a 4b ae  30 0e d8 c5 ed 33 dd 6d  |.".z..K.0....3.m|
-00000080  49 01 af 07 d1 0f                                 |I.....|
+00000000  16 03 01 00 46 10 00 00  42 41 04 cb cc 3f 30 f8  |....F...BA...?0.|
+00000010  bb c5 88 d5 12 fa 24 96  57 74 76 86 f2 2f e4 16  |......$.Wtv../..|
+00000020  dd 03 db 0a ca 22 53 85  97 cd d8 cc 30 a6 c9 29  |....."S.....0..)|
+00000030  2a 1b 22 cd d1 e8 30 43  c8 2f ca 1b 49 d0 4a 63  |*."...0C./..I.Jc|
+00000040  dd 28 68 42 64 c4 53 46  40 42 dd 14 03 01 00 01  |.(hBd.SF@B......|
+00000050  01 16 03 01 00 30 17 1c  8d fa fc 33 93 2d 7e 94  |.....0.....3.-~.|
+00000060  fc 97 65 5f 9d cf 37 f4  1a e6 80 28 e6 f7 f5 97  |..e_..7....(....|
+00000070  57 8e b2 0b 88 45 2f d6  2f e5 11 e5 45 85 06 a0  |W....E/./...E...|
+00000080  52 eb 5c cb 14 db                                 |R.\...|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 3b f6 c9 51 87  |..........0;..Q.|
-00000010  ee 8a e4 d4 99 6c d1 3e  88 2b ee 82 b3 4a 39 55  |.....l.>.+...J9U|
-00000020  13 e8 6b 64 44 cf 1d c8  33 66 b0 e5 17 aa 37 fa  |..kdD...3f....7.|
-00000030  7a e1 b8 55 aa f4 25 c1  19 d7 fb 17 03 01 00 20  |z..U..%........ |
-00000040  c2 37 83 cf 44 01 b6 00  be 47 90 7d c3 64 1f 52  |.7..D....G.}.d.R|
-00000050  bb 78 47 8f 7a 6c 36 2e  28 15 4b 0a 65 c2 c1 1f  |.xG.zl6.(.K.e...|
-00000060  17 03 01 00 30 5a fd 09  05 37 3d 3f 66 c9 2d bc  |....0Z...7=?f.-.|
-00000070  b3 0c 32 57 20 4b a7 73  76 09 0f b7 29 6e 43 fc  |..2W K.sv...)nC.|
-00000080  79 db ae aa db ff e5 81  5f 9a fa 21 6f 74 46 2e  |y......._..!otF.|
-00000090  b9 28 c8 d6 80 15 03 01  00 20 7d c9 2e 64 72 41  |.(....... }..drA|
-000000a0  a0 d8 dc 32 02 06 e5 6f  64 b0 0c 82 78 b5 3f 5f  |...2...od...x.?_|
-000000b0  e7 99 05 3c 52 1d 5a b3  f1 b0                    |...<R.Z...|
+00000000  14 03 01 00 01 01 16 03  01 00 30 d8 bc 10 62 c8  |..........0...b.|
+00000010  73 d4 eb 2f c1 41 e8 e4  71 08 ea 60 f2 59 0f f9  |s../.A..q..`.Y..|
+00000020  51 fe f3 32 86 d7 bc 66  02 c1 0d 61 f2 7b 90 81  |Q..2...f...a.{..|
+00000030  49 5d 66 cc 8a 38 30 85  4c 98 1c 17 03 01 00 20  |I]f..80.L...... |
+00000040  88 37 8d 00 97 b0 a5 93  ff fb 47 9a db 4c ad 58  |.7........G..L.X|
+00000050  3d 49 d1 4e 3e 24 74 47  df 78 1a f2 c4 ef 3f 8c  |=I.N>$tG.x....?.|
+00000060  17 03 01 00 30 15 49 5a  f7 5c 09 76 69 b6 20 0d  |....0.IZ.\.vi. .|
+00000070  02 f9 c4 95 d4 08 fe c0  1d 49 0f 61 a7 ca 5e d5  |.........I.a..^.|
+00000080  93 c4 8f d1 4d 53 04 76  c7 90 a2 b6 ee d2 fe 13  |....MS.v........|
+00000090  bc bb b3 83 2b 15 03 01  00 20 e4 f3 84 e5 09 c8  |....+.... ......|
+000000a0  dc 40 26 7c 42 59 08 4d  8e 1a 70 41 03 9e a6 a2  |.@&|BY.M..pA....|
+000000b0  ac cd 62 1e b9 e2 fb c2  33 0a                    |..b.....3.|
diff --git a/src/crypto/tls/testdata/Server-TLSv10-RSA-3DES b/src/crypto/tls/testdata/Server-TLSv10-RSA-3DES
index 2cfb2c97d7..4f5bc6dc0b 100644
--- a/src/crypto/tls/testdata/Server-TLSv10-RSA-3DES
+++ b/src/crypto/tls/testdata/Server-TLSv10-RSA-3DES
@@ -1,8 +1,8 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 36 01 00 00  32 03 01 13 b6 30 58 af  |....6...2....0X.|
-00000010  35 b9 ea 58 af 29 cf a3  50 f3 70 ec 3d 60 d7 0c  |5..X.)..P.p.=`..|
-00000020  94 35 7b 0d 91 f9 0d 6f  3c 09 d9 00 00 04 00 0a  |.5{....o<.......|
-00000030  00 ff 01 00 00 05 00 0f  00 01 01                 |...........|
+00000000  16 03 01 00 39 01 00 00  35 03 01 63 6b 8e 7a ec  |....9...5..ck.z.|
+00000010  88 b1 0d 62 36 11 11 df  7f da 1f ff 51 fe 8c 4d  |...b6.......Q..M|
+00000020  2a c0 15 01 3e df d5 d8  db 0c 5e 00 00 04 00 0a  |*...>.....^.....|
+00000030  00 ff 01 00 00 08 00 16  00 00 00 17 00 00        |..............|
 >>> Flow 2 (server to client)
 00000000  16 03 01 00 31 02 00 00  2d 03 01 00 00 00 00 00  |....1...-.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -47,26 +47,26 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 01 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 01 00 86 10 00 00  82 00 80 9e 7f a0 22 94  |..............".|
-00000010  c6 1b e5 13 fc d4 0c 95  19 b6 12 c7 71 1c 40 06  |............q.@.|
-00000020  2f 6d 04 3e 02 72 db 02  1e ee db 59 26 63 d4 5d  |/m.>.r.....Y&c.]|
-00000030  b0 bf 7e a6 bb f6 39 8c  06 98 47 e6 56 5c a2 f0  |..~...9...G.V\..|
-00000040  92 d3 31 a9 9d 84 af bf  6e 85 6d 48 d8 63 62 fc  |..1.....n.mH.cb.|
-00000050  b5 2d 65 8b 45 e5 ab 0f  3c 38 42 64 f9 58 80 b9  |.-e.E...<8Bd.X..|
-00000060  a0 27 7b 0a d3 fb 42 fe  46 8d c9 d8 71 5b bd f6  |.'{...B.F...q[..|
-00000070  b3 a8 bf 5c 1f 9b 63 fd  fa b3 c8 68 4b a4 e4 2d  |...\..c....hK..-|
-00000080  6e 99 51 95 b8 d8 ff a8  e6 ad b1 14 03 01 00 01  |n.Q.............|
-00000090  01 16 03 01 00 28 9c 43  54 aa bd c0 df fc f2 35  |.....(.CT......5|
-000000a0  a6 bb f3 1d 11 74 d9 c9  6e f7 ed e5 79 56 b9 6b  |.....t..n...yV.k|
-000000b0  c6 c4 20 9b e6 1d 7a 89  7e 2e ca c4 62 d7        |.. ...z.~...b.|
+00000000  16 03 01 00 86 10 00 00  82 00 80 6a e2 d7 29 60  |...........j..)`|
+00000010  85 e0 f0 41 59 05 d2 c4  ed c8 cb b2 66 ef 87 b5  |...AY.......f...|
+00000020  2d db 83 f0 b2 60 75 27  e4 ab c8 a0 26 fd bd ef  |-....`u'....&...|
+00000030  d0 54 4c 61 b2 56 0d fa  f5 12 4d 6f 75 2a 61 82  |.TLa.V....Mou*a.|
+00000040  fa 8f ed 70 77 d2 7f f3  70 38 a3 fa 0a eb 5a 32  |...pw...p8....Z2|
+00000050  f6 70 8b c5 ac 85 04 d2  fc fa cf 46 8e be 41 f0  |.p.........F..A.|
+00000060  3b 6a 0e 74 86 0b a3 2b  73 e7 b6 09 d4 6c 9c 4d  |;j.t...+s....l.M|
+00000070  5c 9a c3 b2 81 0b b2 36  21 15 98 18 61 8f 9b 83  |\......6!...a...|
+00000080  e7 3e b0 d1 5f 75 f1 69  41 7c fd 14 03 01 00 01  |.>.._u.iA|......|
+00000090  01 16 03 01 00 28 ef 8a  53 0e 3b 9c d4 2b 48 85  |.....(..S.;..+H.|
+000000a0  db ae 99 cf 74 06 b9 7d  44 69 99 d8 42 d7 c8 1f  |....t..}Di..B...|
+000000b0  b0 01 6b 8c 4b 02 7d 6b  2d 2e 39 8f fa a8        |..k.K.}k-.9...|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 28 a6 eb 4a b8 4c  |..........(..J.L|
-00000010  da 2b 0e 19 96 67 c8 f0  3d 89 bc 69 78 33 e1 e6  |.+...g..=..ix3..|
-00000020  53 ab 62 3c 4f 42 81 2e  9e 85 2f ef 77 87 f4 81  |S.b<OB..../.w...|
-00000030  85 59 ba 17 03 01 00 18  03 1f 07 a2 0d ed fc 71  |.Y.............q|
-00000040  20 fd c6 e5 84 0a 92 c4  62 30 fd 0e ee 59 22 dc  | .......b0...Y".|
-00000050  17 03 01 00 28 7b 8d 0e  32 26 8f 6c 23 28 44 6e  |....({..2&.l#(Dn|
-00000060  7a 0d e1 76 a4 dc 45 57  e0 db 0b 96 19 7c cd 76  |z..v..EW.....|.v|
-00000070  13 59 8d 4b 12 c5 c5 c3  b9 f9 3d 88 41 15 03 01  |.Y.K......=.A...|
-00000080  00 18 cd 4a 37 0d bc b5  e6 a7 b2 3d 6a be 10 39  |...J7......=j..9|
-00000090  36 19 5e 71 30 6e 67 b1  ea 2b                    |6.^q0ng..+|
+00000000  14 03 01 00 01 01 16 03  01 00 28 05 03 3e 8c b0  |..........(..>..|
+00000010  bf 14 c9 a3 38 2f ea 0c  e9 a0 bc 0b ef a5 04 21  |....8/.........!|
+00000020  60 d7 20 db d7 ef 61 45  b8 45 2b 51 cc c4 7f f8  |`. ...aE.E+Q....|
+00000030  e0 4c dd 17 03 01 00 18  f8 ac 9e c4 cd b7 4f c0  |.L............O.|
+00000040  eb 6d a8 ff a2 36 f5 4b  87 c5 d5 27 d9 79 c2 2b  |.m...6.K...'.y.+|
+00000050  17 03 01 00 28 50 e5 f9  5b 27 2c 10 10 d8 f6 1f  |....(P..[',.....|
+00000060  58 e9 80 76 cf f7 03 c4  45 f7 e8 27 f9 60 12 f0  |X..v....E..'.`..|
+00000070  b7 d0 c1 1c 34 31 f5 46  2c 2c 43 d4 b0 15 03 01  |....41.F,,C.....|
+00000080  00 18 71 16 fe 91 c1 3d  17 40 2c 34 a8 69 45 71  |..q....=.@,4.iEq|
+00000090  1d b9 83 99 7f 6e 86 08  12 0e                    |.....n....|
diff --git a/src/crypto/tls/testdata/Server-TLSv10-RSA-AES b/src/crypto/tls/testdata/Server-TLSv10-RSA-AES
index c2eda07936..c988215a89 100644
--- a/src/crypto/tls/testdata/Server-TLSv10-RSA-AES
+++ b/src/crypto/tls/testdata/Server-TLSv10-RSA-AES
@@ -1,8 +1,8 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 36 01 00 00  32 03 01 a9 45 16 6e df  |....6...2...E.n.|
-00000010  8d 11 13 4d 3a b7 9d 96  18 dd ae 9c 1d 23 72 29  |...M:........#r)|
-00000020  f0 64 f5 63 ec 15 53 18  28 75 27 00 00 04 00 2f  |.d.c..S.(u'..../|
-00000030  00 ff 01 00 00 05 00 0f  00 01 01                 |...........|
+00000000  16 03 01 00 39 01 00 00  35 03 01 aa c3 56 39 53  |....9...5....V9S|
+00000010  94 16 6b 51 7f e2 eb a8  7c 25 59 55 9b 28 38 b1  |..kQ....|%YU.(8.|
+00000020  c0 94 af 2e f5 94 ba 0e  f0 a1 b1 00 00 04 00 2f  |.............../|
+00000030  00 ff 01 00 00 08 00 16  00 00 00 17 00 00        |..............|
 >>> Flow 2 (server to client)
 00000000  16 03 01 00 31 02 00 00  2d 03 01 00 00 00 00 00  |....1...-.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -47,29 +47,29 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 01 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 01 00 86 10 00 00  82 00 80 1e 5d a4 6d ad  |............].m.|
-00000010  41 36 d1 f4 3d c0 6a 3d  e9 8a 4f ac 76 bb 78 57  |A6..=.j=..O.v.xW|
-00000020  d0 14 b4 4d 9b ff 13 97  a3 98 f9 50 6b cc ec c7  |...M.......Pk...|
-00000030  dc 56 45 c2 fe c3 19 f0  01 52 b2 db 43 de 2e 40  |.VE......R..C..@|
-00000040  40 8e a8 03 33 d6 11 0f  8a a1 c0 42 50 06 46 13  |@...3......BP.F.|
-00000050  69 fa cb 5f 8b 61 44 60  5b 0e 89 7d c4 90 6c ff  |i.._.aD`[..}..l.|
-00000060  93 5e 7f 45 48 2d ae c5  83 ac f8 d4 6d c3 fb 41  |.^.EH-......m..A|
-00000070  f8 29 10 35 0e d3 54 0b  5d 3b 62 1e c9 60 68 ab  |.).5..T.];b..`h.|
-00000080  c9 53 72 1b 98 b7 b1 93  b4 3d 9e 14 03 01 00 01  |.Sr......=......|
-00000090  01 16 03 01 00 30 9f fc  5c 44 04 a0 0a ae 03 3c  |.....0..\D.....<|
-000000a0  7c 8d 5d c7 06 25 ab 74  53 ee cf 95 8f 7d 5a be  ||.]..%.tS....}Z.|
-000000b0  be 8e e7 48 10 6f e7 15  f0 95 e9 c8 30 1f cb a9  |...H.o......0...|
-000000c0  70 fb 21 1e 74 ae                                 |p.!.t.|
+00000000  16 03 01 00 86 10 00 00  82 00 80 73 3f 17 54 6f  |...........s?.To|
+00000010  c6 c8 08 e2 d5 e6 49 cc  51 89 d1 c8 dc cd 4f ec  |......I.Q.....O.|
+00000020  0b b4 71 0b d5 44 b4 fa  9e 97 a4 52 69 0a c8 f7  |..q..D.....Ri...|
+00000030  79 cb 79 52 46 94 95 32  a1 d1 17 c0 ba fd 65 9b  |y.yRF..2......e.|
+00000040  52 c3 99 dc 06 07 54 0d  90 8e 4d ff 31 72 8c 80  |R.....T...M.1r..|
+00000050  86 cf 3b be 09 f4 df dc  93 40 c4 7d 88 55 72 e8  |..;......@.}.Ur.|
+00000060  f4 26 f3 8b 0d 3c 8d 07  97 90 87 a6 91 96 60 0e  |.&...<........`.|
+00000070  4c ec ac a4 be 36 36 32  81 8b 7e 5f 6a 7e 0d d5  |L....662..~_j~..|
+00000080  9c 2b 1e 3f e2 14 fa 22  d2 8d 34 14 03 01 00 01  |.+.?..."..4.....|
+00000090  01 16 03 01 00 30 43 50  a9 47 03 3b 38 0a 62 cf  |.....0CP.G.;8.b.|
+000000a0  74 56 a7 9c 56 a3 a2 05  dc d5 60 7a 4f 10 37 c6  |tV..V.....`zO.7.|
+000000b0  13 d5 5b c8 cc b7 96 22  e4 58 a4 8a 2a 9d 48 14  |..[....".X..*.H.|
+000000c0  97 03 2f 6d a0 35                                 |../m.5|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 2e 2b 26 99 5e  |..........0.+&.^|
-00000010  b8 50 62 10 f7 e5 fb 72  61 a1 5a d9 33 5b 4a 7d  |.Pb....ra.Z.3[J}|
-00000020  9f f1 01 69 54 5b b8 59  67 ad 9d 74 30 3f b1 54  |...iT[.Yg..t0?.T|
-00000030  98 79 61 fe 23 18 a6 63  a1 6c c3 17 03 01 00 20  |.ya.#..c.l..... |
-00000040  2b 4b 0b b4 75 89 ab 24  65 52 58 20 b6 80 d8 9d  |+K..u..$eRX ....|
-00000050  47 db 0d 9e b3 64 37 87  37 4a 64 88 61 d3 fa 93  |G....d7.7Jd.a...|
-00000060  17 03 01 00 30 99 27 bc  9b 01 3c d7 a8 36 82 2e  |....0.'...<..6..|
-00000070  07 cb 0e 93 19 7f 77 a9  6a a8 31 d2 f0 a5 85 94  |......w.j.1.....|
-00000080  42 86 65 9c cf 95 8e ec  ec a2 77 2b c3 84 9a 20  |B.e.......w+... |
-00000090  40 f5 9f 44 f5 15 03 01  00 20 52 8e cd bb 61 7d  |@..D..... R...a}|
-000000a0  ab c0 f3 76 d0 a6 41 96  5c 62 32 94 e9 fb 30 e6  |...v..A.\b2...0.|
-000000b0  e2 62 7f 63 11 3c 32 75  3a 9f                    |.b.c.<2u:.|
+00000000  14 03 01 00 01 01 16 03  01 00 30 e1 7c 3f cc a9  |..........0.|?..|
+00000010  00 c1 05 00 95 e4 39 b8  82 92 14 83 c3 a4 d2 d9  |......9.........|
+00000020  8a 47 c6 b5 e8 70 ff 9d  6b 90 d1 13 e5 6b ff 77  |.G...p..k....k.w|
+00000030  55 eb 76 37 e3 df fa 9b  82 5a c3 17 03 01 00 20  |U.v7.....Z..... |
+00000040  f3 81 d3 e6 ac fb f9 49  06 8c 27 aa f4 ad 76 6f  |.......I..'...vo|
+00000050  45 4e 7b 27 c0 bb db fe  d9 da 7c 19 cc 7d 40 0e  |EN{'......|..}@.|
+00000060  17 03 01 00 30 c2 33 a6  cb 1f 5f 2e 30 94 54 1c  |....0.3..._.0.T.|
+00000070  02 3b 1f 9c f4 5c 41 2a  67 9d b8 af 6b 48 cc 25  |.;...\A*g...kH.%|
+00000080  8c a5 1e be 88 91 20 06  dd 75 d5 68 15 ae be b1  |...... ..u.h....|
+00000090  e3 7a 5b 73 9b 15 03 01  00 20 3a ab ff b4 54 57  |.z[s..... :...TW|
+000000a0  68 e1 d7 0e 20 fc 9d 8f  20 f5 1e 8d f8 40 bb 55  |h... ... ....@.U|
+000000b0  1f 81 76 d9 e5 ef f8 00  05 91                    |..v.......|
diff --git a/src/crypto/tls/testdata/Server-TLSv10-RSA-RC4 b/src/crypto/tls/testdata/Server-TLSv10-RSA-RC4
index e50a5d4eba..af18e99bec 100644
--- a/src/crypto/tls/testdata/Server-TLSv10-RSA-RC4
+++ b/src/crypto/tls/testdata/Server-TLSv10-RSA-RC4
@@ -1,8 +1,8 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 36 01 00 00  32 03 01 24 1f 03 ea a7  |....6...2..$....|
-00000010  76 96 1c ec 25 e9 09 c1  da d0 e3 14 81 ba 10 65  |v...%..........e|
-00000020  50 5d ad 8a 38 6c e0 20  d4 6c 1c 00 00 04 00 05  |P]..8l. .l......|
-00000030  00 ff 01 00 00 05 00 0f  00 01 01                 |...........|
+00000000  16 03 01 00 39 01 00 00  35 03 01 9e 6c 99 0f 16  |....9...5...l...|
+00000010  2d d6 48 26 4e 2a d1 e4  80 53 0e 74 ee 6d bc 7c  |-.H&N*...S.t.m.||
+00000020  9b 65 9b 33 8d 6b 15 61  f6 53 b5 00 00 04 00 05  |.e.3.k.a.S......|
+00000030  00 ff 01 00 00 08 00 16  00 00 00 17 00 00        |..............|
 >>> Flow 2 (server to client)
 00000000  16 03 01 00 31 02 00 00  2d 03 01 00 00 00 00 00  |....1...-.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -47,23 +47,23 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 01 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 01 00 86 10 00 00  82 00 80 63 2b e0 3b 5e  |...........c+.;^|
-00000010  75 81 e9 a5 9d 09 d2 9c  a8 f1 9d ef f7 ee 4e 52  |u.............NR|
-00000020  76 3a 59 2e d6 a3 66 b6  5c 69 e8 d9 cd 67 cd 28  |v:Y...f.\i...g.(|
-00000030  1e b8 c4 ad f6 40 40 e9  b6 ea a0 06 8e 4e cf 8f  |.....@@......N..|
-00000040  4c f9 b6 8d df 4e 36 ca  21 06 94 25 da df ad f2  |L....N6.!..%....|
-00000050  df 85 bc f8 4e f2 fb 02  2d 74 2e 86 24 ee f3 97  |....N...-t..$...|
-00000060  aa 46 06 7d 70 3c 18 af  9f 69 33 11 b4 19 84 27  |.F.}p<...i3....'|
-00000070  df fc f2 8b 96 de f7 f8  37 fa 48 ed 2d 37 85 87  |........7.H.-7..|
-00000080  45 62 56 d9 bb 96 81 fb  b8 73 da 14 03 01 00 01  |EbV......s......|
-00000090  01 16 03 01 00 24 36 f6  e8 12 a7 90 72 0e 6a 2c  |.....$6.....r.j,|
-000000a0  63 fd 64 c9 48 51 75 b2  28 8a 39 55 9b 58 b7 fa  |c.d.HQu.(.9U.X..|
-000000b0  9a 7e 32 55 a6 42 7f 7c  d0 d1                    |.~2U.B.|..|
+00000000  16 03 01 00 86 10 00 00  82 00 80 d8 7a 11 ec dd  |............z...|
+00000010  8c 50 97 3a 9b 21 28 7d  52 8c fc a0 62 17 e8 3a  |.P.:.!(}R...b..:|
+00000020  0f 97 42 44 cd 9c ec d3  74 c3 2c 70 33 37 0f 57  |..BD....t.,p37.W|
+00000030  9b a9 b9 24 2a be 87 8f  ec ca 3f 40 da 1b 06 82  |...$*.....?@....|
+00000040  4e e8 8a 3e 45 30 97 b5  b5 f1 e6 42 4e 7e 2e 0d  |N..>E0.....BN~..|
+00000050  aa b2 fc 21 8f fb 0f dd  ca 7c 2b d2 c6 cb f8 60  |...!.....|+....`|
+00000060  0b 18 68 8e 51 54 dd 1f  4c ba 8e db e5 31 52 ed  |..h.QT..L....1R.|
+00000070  d5 a6 fe 13 f3 9b d1 47  42 b0 33 6b f3 c1 d9 c4  |.......GB.3k....|
+00000080  5b 16 54 6d 58 1c ea c8  a6 b2 ba 14 03 01 00 01  |[.TmX...........|
+00000090  01 16 03 01 00 24 c0 bc  e5 37 fe 6e 63 a9 ca ca  |.....$...7.nc...|
+000000a0  f3 2a ff 07 5c e7 79 7b  e9 3f cc f5 13 dd dd 76  |.*..\.y{.?.....v|
+000000b0  ae 9e 91 fe e6 b7 6a d8  85 b1                    |......j...|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 24 62 6a f0 f7 ca  |..........$bj...|
-00000010  b5 17 6c 0f 74 bb 55 70  1b 8b d4 4d 42 ce 16 30  |..l.t.Up...MB..0|
-00000020  3e b7 22 0d 34 c8 c9 a2  79 48 5b 19 86 c6 d5 17  |>.".4...yH[.....|
-00000030  03 01 00 21 a0 c1 bf 80  31 c8 b0 82 7a f9 da b7  |...!....1...z...|
-00000040  3f 2c e1 91 33 a3 30 57  fd 1a fb d9 32 ff 6c 2e  |?,..3.0W....2.l.|
-00000050  9f 5b 1c bc 67 15 03 01  00 16 eb a1 2b 6f 47 93  |.[..g.......+oG.|
-00000060  05 d9 00 60 b2 35 51 8d  81 4b 11 56 c9 3a f5 f3  |...`.5Q..K.V.:..|
+00000000  14 03 01 00 01 01 16 03  01 00 24 de 85 1d 5d 44  |..........$...]D|
+00000010  17 e3 fc 09 0d 25 bf 8c  0c 23 c8 42 89 b8 4c 08  |.....%...#.B..L.|
+00000020  bc 4d cf ad df 6f 32 94  99 0e a9 dd 8b 9e 06 17  |.M...o2.........|
+00000030  03 01 00 21 8a 73 0e 9b  2e 61 3a 84 57 05 c1 fd  |...!.s...a:.W...|
+00000040  f8 34 27 c5 71 73 58 3c  21 ba d5 d3 a0 26 1a 78  |.4'.qsX<!....&.x|
+00000050  28 3c 7e ec 0c 15 03 01  00 16 c3 d1 38 8f fa 36  |(<~.........8..6|
+00000060  76 fe cd 42 bd ac af 69  16 e5 61 6f 68 da 88 99  |v..B...i..aoh...|
diff --git a/src/crypto/tls/testdata/Server-TLSv11-FallbackSCSV b/src/crypto/tls/testdata/Server-TLSv11-FallbackSCSV
index 65d382a6a4..27f7d18813 100644
--- a/src/crypto/tls/testdata/Server-TLSv11-FallbackSCSV
+++ b/src/crypto/tls/testdata/Server-TLSv11-FallbackSCSV
@@ -1,16 +1,10 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 c4 01 00 00  c0 03 02 55 d6 5d c6 70  |...........U.].p|
-00000010  be c8 b5 f1 98 c5 64 9f  5a 0f 99 77 96 39 5e fb  |......d.Z..w.9^.|
-00000020  95 6f 56 db ee 8f bd 00  bd ec 50 00 00 66 c0 14  |.oV.......P..f..|
-00000030  c0 0a 00 39 00 38 00 37  00 36 00 88 00 87 00 86  |...9.8.7.6......|
-00000040  00 85 c0 0f c0 05 00 35  00 84 c0 13 c0 09 00 33  |.......5.......3|
-00000050  00 32 00 31 00 30 00 9a  00 99 00 98 00 97 00 45  |.2.1.0.........E|
-00000060  00 44 00 43 00 42 c0 0e  c0 04 00 2f 00 96 00 41  |.D.C.B...../...A|
-00000070  00 07 c0 11 c0 07 c0 0c  c0 02 00 05 00 04 c0 12  |................|
-00000080  c0 08 00 16 00 13 00 10  00 0d c0 0d c0 03 00 0a  |................|
-00000090  00 ff 56 00 01 00 00 31  00 0b 00 04 03 00 01 02  |..V....1........|
-000000a0  00 0a 00 1c 00 1a 00 17  00 19 00 1c 00 1b 00 18  |................|
-000000b0  00 1a 00 16 00 0e 00 0d  00 0b 00 0c 00 09 00 0a  |................|
-000000c0  00 23 00 00 00 0f 00 01  01                       |.#.......|
+00000000  16 03 01 00 63 01 00 00  5f 03 02 b0 a9 a8 af 69  |....c..._......i|
+00000010  fe b4 56 38 e7 7f 2f 55  2e 08 ef 69 e0 83 76 62  |..V8../U...i..vb|
+00000020  82 a6 37 7d 49 b4 61 a9  c7 09 14 00 00 14 c0 0a  |..7}I.a.........|
+00000030  c0 14 00 39 c0 09 c0 13  00 33 00 35 00 2f 00 ff  |...9.....3.5./..|
+00000040  56 00 01 00 00 22 00 0b  00 04 03 00 01 02 00 0a  |V...."..........|
+00000050  00 0a 00 08 00 1d 00 17  00 19 00 18 00 23 00 00  |.............#..|
+00000060  00 16 00 00 00 17 00 00                           |........|
 >>> Flow 2 (server to client)
 00000000  15 03 02 00 02 02 56                              |......V|
diff --git a/src/crypto/tls/testdata/Server-TLSv11-RSA-RC4 b/src/crypto/tls/testdata/Server-TLSv11-RSA-RC4
index a2a50ba052..e40d082d7d 100644
--- a/src/crypto/tls/testdata/Server-TLSv11-RSA-RC4
+++ b/src/crypto/tls/testdata/Server-TLSv11-RSA-RC4
@@ -1,8 +1,8 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 36 01 00 00  32 03 02 03 fb d7 27 bf  |....6...2.....'.|
-00000010  37 09 96 b2 c6 df 7e f2  15 10 d7 98 19 19 39 ec  |7.....~.......9.|
-00000020  24 86 c2 f8 14 d6 63 6c  e4 fe f8 00 00 04 00 05  |$.....cl........|
-00000030  00 ff 01 00 00 05 00 0f  00 01 01                 |...........|
+00000000  16 03 01 00 39 01 00 00  35 03 02 63 e6 95 c1 f3  |....9...5..c....|
+00000010  75 c2 d4 68 74 5c d6 7d  00 60 8b 8e 72 ff f4 3d  |u..ht\.}.`..r..=|
+00000020  15 24 8b 15 8e 15 6e 1e  bf 47 ae 00 00 04 00 05  |.$....n..G......|
+00000030  00 ff 01 00 00 08 00 16  00 00 00 17 00 00        |..............|
 >>> Flow 2 (server to client)
 00000000  16 03 02 00 31 02 00 00  2d 03 02 00 00 00 00 00  |....1...-.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -47,23 +47,23 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 02 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 02 00 86 10 00 00  82 00 80 02 d2 db 58 81  |..............X.|
-00000010  7d 30 22 b4 7c 1e 99 cc  df d4 7f 59 a3 53 10 c4  |}0".|......Y.S..|
-00000020  aa 7e 64 44 02 9d 06 02  9c 6a 0c 34 6f d8 01 a4  |.~dD.....j.4o...|
-00000030  00 b0 cc 4e 43 a2 31 2d  9b 08 ca db fa bc 99 98  |...NC.1-........|
-00000040  7c 39 87 75 19 65 fa 4a  bf 44 4c 9d 0e 7b 87 fd  ||9.u.e.J.DL..{..|
-00000050  10 75 95 aa 51 d7 ab 94  ee 0f f1 5a e7 0a bd 90  |.u..Q......Z....|
-00000060  30 fa d8 30 6b c7 96 1d  bf 2a 04 e2 eb b1 d3 89  |0..0k....*......|
-00000070  e9 f1 7d 3c 33 3e 3a df  dc 52 a2 d7 43 a4 6e 59  |..}<3>:..R..C.nY|
-00000080  cd 7a 63 07 1b d4 9b 14  19 90 a4 14 03 02 00 01  |.zc.............|
-00000090  01 16 03 02 00 24 10 12  31 e8 64 f4 f7 ad 25 89  |.....$..1.d...%.|
-000000a0  c8 62 0a 3b ec 73 01 b3  35 66 10 4f 9f bf 94 5e  |.b.;.s..5f.O...^|
-000000b0  42 b9 3b 41 82 01 6c 19  57 d4                    |B.;A..l.W.|
+00000000  16 03 02 00 86 10 00 00  82 00 80 d7 54 f9 63 0f  |............T.c.|
+00000010  8e 38 e7 f7 2c 35 69 18  ae b0 54 ac 55 a9 8e c1  |.8..,5i...T.U...|
+00000020  e1 f7 09 b8 6d aa 2d 3e  f5 be 2d 2e 1c f2 e4 95  |....m.->..-.....|
+00000030  3e c3 6a 15 af 49 e8 38  3b e2 90 3f df ab 89 44  |>.j..I.8;..?...D|
+00000040  34 63 f9 c5 47 a5 30 3c  45 5d 16 23 0d d6 d5 e6  |4c..G.0<E].#....|
+00000050  9d e7 90 ee 9a b8 bc c9  49 7d 85 00 da 53 5b cb  |........I}...S[.|
+00000060  2f 19 56 31 64 4f 9a ce  15 02 4d ee 67 7c be 9a  |/.V1dO....M.g|..|
+00000070  c5 5f 21 c7 a7 1f 29 56  ee ab ce 07 ff a2 6e 94  |._!...)V......n.|
+00000080  57 da 74 9d d7 63 82 43  b0 e6 48 14 03 02 00 01  |W.t..c.C..H.....|
+00000090  01 16 03 02 00 24 88 75  fb e9 20 0b 3b c7 fb 4a  |.....$.u.. .;..J|
+000000a0  2f 1c 54 76 3d 8c 14 6e  c0 1e 56 6e ce ce 4f a9  |/.Tv=..n..Vn..O.|
+000000b0  f5 bd f9 9b 25 18 bd de  18 86                    |....%.....|
 >>> Flow 4 (server to client)
-00000000  14 03 02 00 01 01 16 03  02 00 24 1c 71 ed 0a 19  |..........$.q...|
-00000010  53 12 df da 62 a6 40 c1  3a fa 77 7b 15 16 76 0c  |S...b.@.:.w{..v.|
-00000020  6e 99 c7 6d 42 06 ef 9f  bd e2 88 e2 88 69 b1 17  |n..mB........i..|
-00000030  03 02 00 21 e7 26 bf bb  8c 58 e8 e6 5b 92 f1 91  |...!.&...X..[...|
-00000040  e2 f7 59 22 d8 96 25 52  8c 2b ee f0 b9 03 51 69  |..Y"..%R.+....Qi|
-00000050  6a e4 f8 fd f2 15 03 02  00 16 be 76 53 a3 f1 49  |j..........vS..I|
-00000060  69 e2 9f 33 3d 8e 1b 21  ce 75 27 d4 51 30 34 51  |i..3=..!.u'.Q04Q|
+00000000  14 03 02 00 01 01 16 03  02 00 24 9b 7a 77 60 f7  |..........$.zw`.|
+00000010  d3 a2 6f 51 c8 52 41 57  30 88 e0 5e e8 ec dd 36  |..oQ.RAW0..^...6|
+00000020  61 cd 78 bf 03 e5 1d 95  09 75 0e b8 30 9d 5d 17  |a.x......u..0.].|
+00000030  03 02 00 21 9e 7b fe b8  35 4e 86 6f c9 bd 92 4b  |...!.{..5N.o...K|
+00000040  28 59 a4 54 d9 ab 70 fe  95 1e 81 b2 ab 08 27 e6  |(Y.T..p.......'.|
+00000050  c3 b2 c0 b9 8c 15 03 02  00 16 54 95 b1 e5 6e 0c  |..........T...n.|
+00000060  ff 80 15 30 b5 a7 5f ea  8e ab 49 d8 20 4a 80 f0  |...0.._...I. J..|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ALPN b/src/crypto/tls/testdata/Server-TLSv12-ALPN
index 78bec5be49..9e397185b3 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ALPN
+++ b/src/crypto/tls/testdata/Server-TLSv12-ALPN
@@ -1,25 +1,17 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 42 01 00 01  3e 03 03 0f 39 5a 36 56  |....B...>...9Z6V|
-00000010  92 36 5a 45 b5 44 5e 61  b8 2f 52 67 13 56 a4 fb  |.6ZE.D^a./Rg.V..|
-00000020  31 3e 02 db d8 85 7c ae  25 b2 20 00 00 ac c0 30  |1>....|.%. ....0|
-00000030  c0 2c c0 28 c0 24 c0 14  c0 0a 00 a5 00 a3 00 a1  |.,.(.$..........|
-00000040  00 9f 00 6b 00 6a 00 69  00 68 00 39 00 38 00 37  |...k.j.i.h.9.8.7|
-00000050  00 36 00 88 00 87 00 86  00 85 c0 32 c0 2e c0 2a  |.6.........2...*|
-00000060  c0 26 c0 0f c0 05 00 9d  00 3d 00 35 00 84 c0 2f  |.&.......=.5.../|
-00000070  c0 2b c0 27 c0 23 c0 13  c0 09 00 a4 00 a2 00 a0  |.+.'.#..........|
-00000080  00 9e 00 67 00 40 00 3f  00 3e 00 33 00 32 00 31  |...g.@.?.>.3.2.1|
-00000090  00 30 00 9a 00 99 00 98  00 97 00 45 00 44 00 43  |.0.........E.D.C|
-000000a0  00 42 c0 31 c0 2d c0 29  c0 25 c0 0e c0 04 00 9c  |.B.1.-.).%......|
-000000b0  00 3c 00 2f 00 96 00 41  00 07 c0 11 c0 07 c0 0c  |.<./...A........|
-000000c0  c0 02 00 05 00 04 c0 12  c0 08 00 16 00 13 00 10  |................|
-000000d0  00 0d c0 0d c0 03 00 0a  00 ff 01 00 00 69 00 0b  |.............i..|
-000000e0  00 04 03 00 01 02 00 0a  00 1c 00 1a 00 17 00 19  |................|
-000000f0  00 1c 00 1b 00 18 00 1a  00 16 00 0e 00 0d 00 0b  |................|
-00000100  00 0c 00 09 00 0a 00 23  00 00 00 0d 00 20 00 1e  |.......#..... ..|
-00000110  06 01 06 02 06 03 05 01  05 02 05 03 04 01 04 02  |................|
-00000120  04 03 03 01 03 02 03 03  02 01 02 02 02 03 00 0f  |................|
-00000130  00 01 01 00 10 00 10 00  0e 06 70 72 6f 74 6f 32  |..........proto2|
-00000140  06 70 72 6f 74 6f 31                              |.proto1|
+00000000  16 03 01 00 bf 01 00 00  bb 03 03 88 3e 03 e9 31  |............>..1|
+00000010  b2 d6 0d 3f f0 26 65 6f  db 03 86 f1 47 d0 0c b3  |...?.&eo....G...|
+00000020  54 92 56 0d 24 e8 01 11  ce 83 44 00 00 38 c0 2c  |T.V.$.....D..8.,|
+00000030  c0 30 00 9f cc a9 cc a8  cc aa c0 2b c0 2f 00 9e  |.0.........+./..|
+00000040  c0 24 c0 28 00 6b c0 23  c0 27 00 67 c0 0a c0 14  |.$.(.k.#.'.g....|
+00000050  00 39 c0 09 c0 13 00 33  00 9d 00 9c 00 3d 00 3c  |.9.....3.....=.<|
+00000060  00 35 00 2f 00 ff 01 00  00 5a 00 0b 00 04 03 00  |.5./.....Z......|
+00000070  01 02 00 0a 00 0a 00 08  00 1d 00 17 00 19 00 18  |................|
+00000080  00 23 00 00 00 0d 00 20  00 1e 06 01 06 02 06 03  |.#..... ........|
+00000090  05 01 05 02 05 03 04 01  04 02 04 03 03 01 03 02  |................|
+000000a0  03 03 02 01 02 02 02 03  00 10 00 10 00 0e 06 70  |...............p|
+000000b0  72 6f 74 6f 32 06 70 72  6f 74 6f 31 00 16 00 00  |roto2.proto1....|
+000000c0  00 17 00 00                                       |....|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 42 02 00 00  3e 03 03 00 00 00 00 00  |....B...>.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -68,39 +60,39 @@
 000002c0  54 5b 12 2e 8f 09 67 fd  a7 24 20 3e b2 56 1c ce  |T[....g..$ >.V..|
 000002d0  97 28 5e f8 2b 2d 4f 9e  f1 07 9f 6c 4b 5b 83 56  |.(^.+-O....lK[.V|
 000002e0  e2 32 42 e9 58 b6 d7 49  a6 b5 68 1a 41 03 56 6b  |.2B.X..I..h.A.Vk|
-000002f0  dc 5a 89 05 01 00 80 52  91 fb b6 15 9f 36 6d a3  |.Z.....R.....6m.|
-00000300  4e 8f 69 a4 17 1c cb ce  e5 2e 46 09 3b 3c f2 0a  |N.i.......F.;<..|
-00000310  88 ae 18 fc 2d 6f fa 87  a8 8e e5 54 87 b7 27 52  |....-o.....T..'R|
-00000320  b7 47 48 a8 23 18 6b f3  96 85 e1 46 86 d2 11 f2  |.GH.#.k....F....|
-00000330  13 87 eb 8e 8e 53 2b 7d  4d db 00 f3 4e f0 a7 5c  |.....S+}M...N..\|
-00000340  dd ab 80 9c b5 8f ae e8  87 a6 0c e5 6d 64 b6 74  |............md.t|
-00000350  8e c0 aa 2f d8 77 49 77  3d 1d 29 64 58 ca f4 ce  |.../.wIw=.)dX...|
-00000360  b9 7c 93 39 19 f7 ba 03  c7 f3 1f 2f e4 30 ad 8e  |.|.9......./.0..|
-00000370  ca bc e1 bf 50 6a 51 16  03 03 00 04 0e 00 00 00  |....PjQ.........|
+000002f0  dc 5a 89 05 01 00 80 5b  dc 03 ef f0 ad 7c 4d 90  |.Z.....[.....|M.|
+00000300  5c 90 1d 46 65 cd 9a 96  21 a7 9f 91 ae 71 45 72  |\..Fe...!....qEr|
+00000310  38 8d c7 79 5d 29 90 47  50 e5 4c 7c 40 e5 1b 64  |8..y]).GP.L|@..d|
+00000320  da b1 b6 7b f1 d5 59 12  2d 5f f2 17 86 8d 25 cd  |...{..Y.-_....%.|
+00000330  85 37 07 32 e5 5e 19 a8  81 0c c7 02 1c 33 93 72  |.7.2.^.......3.r|
+00000340  dc 9b b1 60 85 12 4c 6c  aa 6a 43 66 08 23 d1 35  |...`..Ll.jCf.#.5|
+00000350  f1 5d a4 db fa 5d f4 dd  23 c8 c8 43 76 48 47 aa  |.]...]..#..CvHG.|
+00000360  e1 19 f6 f1 28 86 5d 6b  f4 06 9f 1b 09 6d 00 8f  |....(.]k.....m..|
+00000370  61 c7 85 d9 06 8c a1 16  03 03 00 04 0e 00 00 00  |a...............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 9e 93 8d 9a c4  |....F...BA......|
-00000010  97 38 e2 fa 6d a8 63 57  7b e0 45 46 38 cf 20 83  |.8..m.cW{.EF8. .|
-00000020  1e d5 60 1f be ff 51 d6  78 2a b4 b4 3f 3c 3f 6b  |..`...Q.x*..?<?k|
-00000030  c5 43 ac f2 a8 92 ab 66  d0 a1 ab de 25 8b 9c 88  |.C.....f....%...|
-00000040  91 68 8e 77 5f 37 b7 80  e2 19 f5 14 03 03 00 01  |.h.w_7..........|
-00000050  01 16 03 03 00 28 53 b7  59 df 2c 37 23 4d 8e 5a  |.....(S.Y.,7#M.Z|
-00000060  38 85 94 31 72 12 ff 27  b8 88 e5 86 0c e0 d2 fa  |8..1r..'........|
-00000070  90 ab 47 02 2a 96 ec a9  e0 2b 4b 9b 33 c8        |..G.*....+K.3.|
+00000000  16 03 03 00 46 10 00 00  42 41 04 f3 2d 56 31 b2  |....F...BA..-V1.|
+00000010  42 82 38 35 3b f0 53 2b  12 4b bb 08 88 32 36 8f  |B.85;.S+.K...26.|
+00000020  2f 94 a0 72 5e 0b b8 0d  95 49 b2 e7 38 89 bb b4  |/..r^....I..8...|
+00000030  04 2b a0 0d 1f eb 7d eb  90 04 fd 1e c0 8b 70 18  |.+....}.......p.|
+00000040  be c9 a0 82 08 6b 81 04  39 b4 1b 14 03 03 00 01  |.....k..9.......|
+00000050  01 16 03 03 00 28 3d 97  3c d5 1c b8 3f 63 3e ac  |.....(=.<...?c>.|
+00000060  74 08 ce ce b5 0d 68 a6  45 73 c8 0d 84 c5 76 35  |t.....h.Es....v5|
+00000070  c6 f0 47 24 3d c5 2a c7  e8 85 26 6f 5f 14        |..G$=.*...&o_.|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 82 04 00 00  7e 00 00 00 00 00 78 50  |........~.....xP|
 00000010  46 ad c1 db a8 38 86 7b  2b bb fd d0 c3 42 3e 00  |F....8.{+....B>.|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000030  6f ec 80 83 61 15 ca e0  fb 9f 2f 23 27 b2 12 70  |o...a...../#'..p|
-00000040  bb 3e 06 2d b1 a5 33 ba  da 2c da 37 d6 59 b8 07  |.>.-..3..,.7.Y..|
-00000050  91 4d 08 5e fc 01 1c 16  8d d6 bb 46 0c c7 f8 c1  |.M.^.......F....|
-00000060  c3 d5 63 8d 0f 33 94 73  2e f8 81 8b 85 bc c9 90  |..c..3.s........|
-00000070  95 58 25 b7 e6 eb a2 a9  19 af 72 cf 5e 9b 68 a9  |.X%.......r.^.h.|
-00000080  91 01 dc 0a 0d 6a f0 14  03 03 00 01 01 16 03 03  |.....j..........|
-00000090  00 28 00 00 00 00 00 00  00 00 61 75 eb c5 67 c7  |.(........au..g.|
-000000a0  a7 2e cf 4c 2d 7f 13 aa  4c d8 4e 0c dd 0f 19 34  |...L-...L.N....4|
-000000b0  ae 39 9f 3a 2e 51 ed 4d  8b b1 17 03 03 00 25 00  |.9.:.Q.M......%.|
-000000c0  00 00 00 00 00 00 01 95  8f 7a 9f e1 de 8f da 05  |.........z......|
-000000d0  62 64 09 34 44 96 f6 96  b5 26 48 56 96 b8 c6 c6  |bd.4D....&HV....|
-000000e0  d4 17 26 80 15 03 03 00  1a 00 00 00 00 00 00 00  |..&.............|
-000000f0  02 32 1c 74 65 a9 51 e2  6c 66 94 47 ff 4b 6f 77  |.2.te.Q.lf.G.Kow|
-00000100  ba c1 cf                                          |...|
+00000030  6f ec 80 83 61 74 ca b7  d0 0f 86 1e bd d2 13 2a  |o...at.........*|
+00000040  fb 4c c8 c3 ba 1d ee ca  47 89 1e 20 22 60 bf 71  |.L......G.. "`.q|
+00000050  e2 65 0f f1 05 3d 96 8f  29 51 bd b4 d0 d8 d4 50  |.e...=..)Q.....P|
+00000060  42 3b c1 dd 60 33 94 7c  a7 da 69 63 58 0e 76 ee  |B;..`3.|..icX.v.|
+00000070  a8 0d 04 39 05 d2 ab f7  64 f1 51 29 47 2b a0 fb  |...9....d.Q)G+..|
+00000080  ca e7 8b 4a 2b ae ee 14  03 03 00 01 01 16 03 03  |...J+...........|
+00000090  00 28 00 00 00 00 00 00  00 00 d9 44 b3 c5 8c 0d  |.(.........D....|
+000000a0  04 4b 07 ea e7 f6 5a 1d  43 cf 24 91 6e 49 36 f8  |.K....Z.C.$.nI6.|
+000000b0  f1 8b c2 40 85 46 2d e2  ab 64 17 03 03 00 25 00  |...@.F-..d....%.|
+000000c0  00 00 00 00 00 00 01 56  17 f0 39 6a 82 00 08 f2  |.......V..9j....|
+000000d0  d7 16 3a 24 04 63 59 c0  4e 5c 81 31 2a d4 c5 06  |..:$.cY.N\.1*...|
+000000e0  c9 0a 7f 68 15 03 03 00  1a 00 00 00 00 00 00 00  |...h............|
+000000f0  02 b6 1b ca a1 7d 0e b8  1a 7e e8 6d a2 f1 9a 2e  |.....}...~.m....|
+00000100  de f4 df                                          |...|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ALPN-NoMatch b/src/crypto/tls/testdata/Server-TLSv12-ALPN-NoMatch
index 24779565fa..992ee661c4 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ALPN-NoMatch
+++ b/src/crypto/tls/testdata/Server-TLSv12-ALPN-NoMatch
@@ -1,25 +1,17 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 42 01 00 01  3e 03 03 5c 2b 4a 78 7e  |....B...>..\+Jx~|
-00000010  fc 29 91 f5 c8 fa 6d b8  2e 73 6c fa 15 ce b3 f5  |.)....m..sl.....|
-00000020  70 f5 bc d8 a0 4e f4 1b  a9 6f 95 00 00 ac c0 30  |p....N...o.....0|
-00000030  c0 2c c0 28 c0 24 c0 14  c0 0a 00 a5 00 a3 00 a1  |.,.(.$..........|
-00000040  00 9f 00 6b 00 6a 00 69  00 68 00 39 00 38 00 37  |...k.j.i.h.9.8.7|
-00000050  00 36 00 88 00 87 00 86  00 85 c0 32 c0 2e c0 2a  |.6.........2...*|
-00000060  c0 26 c0 0f c0 05 00 9d  00 3d 00 35 00 84 c0 2f  |.&.......=.5.../|
-00000070  c0 2b c0 27 c0 23 c0 13  c0 09 00 a4 00 a2 00 a0  |.+.'.#..........|
-00000080  00 9e 00 67 00 40 00 3f  00 3e 00 33 00 32 00 31  |...g.@.?.>.3.2.1|
-00000090  00 30 00 9a 00 99 00 98  00 97 00 45 00 44 00 43  |.0.........E.D.C|
-000000a0  00 42 c0 31 c0 2d c0 29  c0 25 c0 0e c0 04 00 9c  |.B.1.-.).%......|
-000000b0  00 3c 00 2f 00 96 00 41  00 07 c0 11 c0 07 c0 0c  |.<./...A........|
-000000c0  c0 02 00 05 00 04 c0 12  c0 08 00 16 00 13 00 10  |................|
-000000d0  00 0d c0 0d c0 03 00 0a  00 ff 01 00 00 69 00 0b  |.............i..|
-000000e0  00 04 03 00 01 02 00 0a  00 1c 00 1a 00 17 00 19  |................|
-000000f0  00 1c 00 1b 00 18 00 1a  00 16 00 0e 00 0d 00 0b  |................|
-00000100  00 0c 00 09 00 0a 00 23  00 00 00 0d 00 20 00 1e  |.......#..... ..|
-00000110  06 01 06 02 06 03 05 01  05 02 05 03 04 01 04 02  |................|
-00000120  04 03 03 01 03 02 03 03  02 01 02 02 02 03 00 0f  |................|
-00000130  00 01 01 00 10 00 10 00  0e 06 70 72 6f 74 6f 32  |..........proto2|
-00000140  06 70 72 6f 74 6f 31                              |.proto1|
+00000000  16 03 01 00 bf 01 00 00  bb 03 03 60 8c 9e 48 42  |...........`..HB|
+00000010  d1 55 7b 73 05 12 ae ec  61 7d 25 30 ed 1c b8 39  |.U{s....a}%0...9|
+00000020  72 d9 11 5e f6 a7 a4 cf  df 24 76 00 00 38 c0 2c  |r..^.....$v..8.,|
+00000030  c0 30 00 9f cc a9 cc a8  cc aa c0 2b c0 2f 00 9e  |.0.........+./..|
+00000040  c0 24 c0 28 00 6b c0 23  c0 27 00 67 c0 0a c0 14  |.$.(.k.#.'.g....|
+00000050  00 39 c0 09 c0 13 00 33  00 9d 00 9c 00 3d 00 3c  |.9.....3.....=.<|
+00000060  00 35 00 2f 00 ff 01 00  00 5a 00 0b 00 04 03 00  |.5./.....Z......|
+00000070  01 02 00 0a 00 0a 00 08  00 1d 00 17 00 19 00 18  |................|
+00000080  00 23 00 00 00 0d 00 20  00 1e 06 01 06 02 06 03  |.#..... ........|
+00000090  05 01 05 02 05 03 04 01  04 02 04 03 03 01 03 02  |................|
+000000a0  03 03 02 01 02 02 02 03  00 10 00 10 00 0e 06 70  |...............p|
+000000b0  72 6f 74 6f 32 06 70 72  6f 74 6f 31 00 16 00 00  |roto2.proto1....|
+000000c0  00 17 00 00                                       |....|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 35 02 00 00  31 03 03 00 00 00 00 00  |....5...1.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -67,40 +59,40 @@
 000002b0  71 b5 e5 54 5b 12 2e 8f  09 67 fd a7 24 20 3e b2  |q..T[....g..$ >.|
 000002c0  56 1c ce 97 28 5e f8 2b  2d 4f 9e f1 07 9f 6c 4b  |V...(^.+-O....lK|
 000002d0  5b 83 56 e2 32 42 e9 58  b6 d7 49 a6 b5 68 1a 41  |[.V.2B.X..I..h.A|
-000002e0  03 56 6b dc 5a 89 05 01  00 80 71 2b 96 d0 8b 29  |.Vk.Z.....q+...)|
-000002f0  0e 22 b4 b0 2b fa 82 7b  ae d2 1e b4 73 b2 37 93  |."..+..{....s.7.|
-00000300  c1 c7 f0 9f 4c fa 1d 66  4a fe 44 c9 f5 f3 5e b5  |....L..fJ.D...^.|
-00000310  5d be 97 61 52 77 85 53  2d 14 b2 3b 43 d7 4d 9a  |]..aRw.S-..;C.M.|
-00000320  6c 70 9b 39 86 45 73 7e  fd a8 b9 97 d7 47 ad d1  |lp.9.Es~.....G..|
-00000330  b2 b1 74 ac e3 6a ce 15  47 4b 65 13 f9 ec 81 21  |..t..j..GKe....!|
-00000340  a2 7a 02 1f 65 d0 c4 ad  f6 52 52 ce 0d 4b ca 60  |.z..e....RR..K.`|
-00000350  a1 69 0e 96 3f b4 69 1e  fe ea dc 6d 74 4e 2a 12  |.i..?.i....mtN*.|
-00000360  a9 0e 5a b9 d8 e7 88 db  1e 9a 16 03 03 00 04 0e  |..Z.............|
+000002e0  03 56 6b dc 5a 89 05 01  00 80 a5 52 65 aa 70 b9  |.Vk.Z......Re.p.|
+000002f0  58 76 c8 07 4f 93 d4 8c  2b 37 ef 90 0b 6f 28 41  |Xv..O...+7...o(A|
+00000300  2a cc 74 34 38 ad 67 eb  ff 00 ba 89 03 dc 28 64  |*.t48.g.......(d|
+00000310  c7 61 44 95 e6 f7 9c 13  58 a6 62 57 e0 fc 64 7c  |.aD.....X.bW..d||
+00000320  49 74 e2 d5 fe ff 94 7a  22 59 11 5d 04 7c db f5  |It.....z"Y.].|..|
+00000330  55 7f 98 a0 70 15 9d 9b  e9 41 d9 aa cc 5f 68 71  |U...p....A..._hq|
+00000340  f6 cd ee 1a 8d 4a 66 b2  3a ce 4a 76 1d 3d 5b 53  |.....Jf.:.Jv.=[S|
+00000350  f8 27 c9 31 4e d5 fd 40  4f 5d ef 12 83 5e 5d 69  |.'.1N..@O]...^]i|
+00000360  38 6a 88 8d 92 41 6d 2d  3e 69 16 03 03 00 04 0e  |8j...Am->i......|
 00000370  00 00 00                                          |...|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 b2 47 69 17 0e  |....F...BA..Gi..|
-00000010  df df 5e ea e8 16 c3 f1  66 23 24 77 8c 15 b1 16  |..^.....f#$w....|
-00000020  08 83 42 0c 75 bb 59 39  59 6f 99 0c 3e 0d e6 94  |..B.u.Y9Yo..>...|
-00000030  ef 52 17 7c d6 6a b1 aa  be d5 dc 3b 7d 1b 22 a8  |.R.|.j.....;}.".|
-00000040  93 fb e1 80 d6 d2 43 7b  b3 ef d8 14 03 03 00 01  |......C{........|
-00000050  01 16 03 03 00 28 a5 16  b7 b3 0c f4 88 95 6e 43  |.....(........nC|
-00000060  dd f1 bd 2c 36 2d 4a 9a  f7 c6 fb 5f 32 6a 12 42  |...,6-J...._2j.B|
-00000070  7f 65 29 9d 3d e9 a8 4f  b3 be 79 7e 7f 8d        |.e).=..O..y~..|
+00000000  16 03 03 00 46 10 00 00  42 41 04 e3 0b 0e 3c d4  |....F...BA....<.|
+00000010  63 8c 7c 65 4c 64 cb d1  76 25 78 16 e7 68 b5 3c  |c.|eLd..v%x..h.<|
+00000020  2b 86 94 f8 07 39 e1 a3  f6 f7 d3 57 d0 c5 5f f5  |+....9.....W.._.|
+00000030  eb c6 67 d0 c0 d4 1a 78  39 61 03 7b 9a 53 db 8a  |..g....x9a.{.S..|
+00000040  2f 43 b4 ef 31 b8 ac d0  49 fe 45 14 03 03 00 01  |/C..1...I.E.....|
+00000050  01 16 03 03 00 28 b3 d6  bc 4f 3c c8 a5 d4 47 1b  |.....(...O<...G.|
+00000060  17 db be 1b 20 73 5f 3f  b9 d2 9a 41 15 92 bc 28  |.... s_?...A...(|
+00000070  73 30 5d c5 c2 82 8c 01  c5 dd 12 f1 76 f1        |s0].........v.|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 82 04 00 00  7e 00 00 00 00 00 78 50  |........~.....xP|
 00000010  46 ad c1 db a8 38 86 7b  2b bb fd d0 c3 42 3e 00  |F....8.{+....B>.|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000030  6f ec 80 83 61 85 0f fd  a5 13 4d 72 83 b0 ba b3  |o...a.....Mr....|
-00000040  b4 45 5a 1b ae a9 c5 9a  a9 8b 1b 8e ae 99 5d e6  |.EZ...........].|
-00000050  0d 51 a5 85 a2 c7 c9 04  34 98 04 44 75 30 d2 07  |.Q......4..Du0..|
-00000060  21 75 67 36 56 33 94 e0  c9 bb 8c 07 ed 33 9c d6  |!ug6V3.......3..|
-00000070  41 ad f6 e7 d8 bf 32 db  47 b7 b7 5d ac 1f a6 3d  |A.....2.G..]...=|
-00000080  1e e0 b1 69 c3 98 8b 14  03 03 00 01 01 16 03 03  |...i............|
-00000090  00 28 00 00 00 00 00 00  00 00 24 e3 60 cf db f6  |.(........$.`...|
-000000a0  49 bc 97 c3 f2 d0 d6 df  96 00 5b 9e a4 23 1e bf  |I.........[..#..|
-000000b0  f0 e8 40 34 dc 66 3a db  56 7f 17 03 03 00 25 00  |..@4.f:.V.....%.|
-000000c0  00 00 00 00 00 00 01 7b  cf c8 6a 40 80 e2 89 fb  |.......{..j@....|
-000000d0  3e 8e ef 3a 81 e5 67 06  9d ba 94 53 e2 1b 6f d1  |>..:..g....S..o.|
-000000e0  18 57 39 e7 15 03 03 00  1a 00 00 00 00 00 00 00  |.W9.............|
-000000f0  02 11 5e 53 2f ec 27 79  c6 2b 73 c8 7a 85 b8 da  |..^S/.'y.+s.z...|
-00000100  1a 6d a3                                          |.m.|
+00000030  6f ec 80 83 61 dd a0 38  1e bf 55 20 48 cf 04 4c  |o...a..8..U H..L|
+00000040  7f 7d f9 e8 62 2b 25 72  6d fc 89 4e e6 20 51 5e  |.}..b+%rm..N. Q^|
+00000050  b6 a8 4b 26 95 bb 03 93  43 2f a8 a3 86 2f 88 45  |..K&....C/.../.E|
+00000060  95 17 03 e9 85 33 94 8e  88 8e 25 7a c7 e6 8f 21  |.....3....%z...!|
+00000070  a7 a7 ca 81 07 e4 0b a6  44 60 df 19 66 9c d9 3d  |........D`..f..=|
+00000080  47 1b a2 29 3e a7 09 14  03 03 00 01 01 16 03 03  |G..)>...........|
+00000090  00 28 00 00 00 00 00 00  00 00 94 37 d6 25 aa 5c  |.(.........7.%.\|
+000000a0  28 f9 7b ab 15 d4 77 9c  ee 67 ed 04 58 b0 f8 90  |(.{...w..g..X...|
+000000b0  bf 57 2c 83 19 2d 2c 1d  63 cd 17 03 03 00 25 00  |.W,..-,.c.....%.|
+000000c0  00 00 00 00 00 00 01 41  3a 44 90 fa a5 73 a8 cb  |.......A:D...s..|
+000000d0  a7 1b 08 38 b9 15 a4 87  76 55 4a 04 d8 13 54 8e  |...8....vUJ...T.|
+000000e0  56 a0 d6 1e 15 03 03 00  1a 00 00 00 00 00 00 00  |V...............|
+000000f0  02 18 41 23 67 cf a2 be  f2 72 4d 49 55 9d 51 56  |..A#g....rMIU.QV|
+00000100  ef c1 f8                                          |...|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceECDSA b/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceECDSA
index ca1d311b1f..8d43c703bd 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceECDSA
+++ b/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceECDSA
@@ -1,23 +1,15 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 2a 01 00 01  26 03 03 17 89 4a cd 22  |....*...&....J."|
-00000010  38 ae 50 54 ac b0 02 ae  f3 7e 5f ab 87 53 67 4c  |8.PT.....~_..SgL|
-00000020  09 cf 88 27 90 7a 26 26  34 52 de 00 00 ac c0 30  |...'.z&&4R.....0|
-00000030  c0 2c c0 28 c0 24 c0 14  c0 0a 00 a5 00 a3 00 a1  |.,.(.$..........|
-00000040  00 9f 00 6b 00 6a 00 69  00 68 00 39 00 38 00 37  |...k.j.i.h.9.8.7|
-00000050  00 36 00 88 00 87 00 86  00 85 c0 32 c0 2e c0 2a  |.6.........2...*|
-00000060  c0 26 c0 0f c0 05 00 9d  00 3d 00 35 00 84 c0 2f  |.&.......=.5.../|
-00000070  c0 2b c0 27 c0 23 c0 13  c0 09 00 a4 00 a2 00 a0  |.+.'.#..........|
-00000080  00 9e 00 67 00 40 00 3f  00 3e 00 33 00 32 00 31  |...g.@.?.>.3.2.1|
-00000090  00 30 00 9a 00 99 00 98  00 97 00 45 00 44 00 43  |.0.........E.D.C|
-000000a0  00 42 c0 31 c0 2d c0 29  c0 25 c0 0e c0 04 00 9c  |.B.1.-.).%......|
-000000b0  00 3c 00 2f 00 96 00 41  00 07 c0 11 c0 07 c0 0c  |.<./...A........|
-000000c0  c0 02 00 05 00 04 c0 12  c0 08 00 16 00 13 00 10  |................|
-000000d0  00 0d c0 0d c0 03 00 0a  00 ff 01 00 00 51 00 0b  |.............Q..|
-000000e0  00 04 03 00 01 02 00 0a  00 1c 00 1a 00 17 00 19  |................|
-000000f0  00 1c 00 1b 00 18 00 1a  00 16 00 0e 00 0d 00 0b  |................|
-00000100  00 0c 00 09 00 0a 00 0d  00 20 00 1e 06 01 06 02  |......... ......|
-00000110  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
-00000120  03 02 03 03 02 01 02 02  02 03 00 0f 00 01 01     |...............|
+00000000  16 03 01 00 a7 01 00 00  a3 03 03 83 d8 14 88 ec  |................|
+00000010  13 67 4d 0f 73 63 85 9c  87 14 3e ee 9c 0e 00 72  |.gM.sc....>....r|
+00000020  79 8c 2a c9 61 1e c3 fa  21 5a 94 00 00 38 c0 2c  |y.*.a...!Z...8.,|
+00000030  c0 30 00 9f cc a9 cc a8  cc aa c0 2b c0 2f 00 9e  |.0.........+./..|
+00000040  c0 24 c0 28 00 6b c0 23  c0 27 00 67 c0 0a c0 14  |.$.(.k.#.'.g....|
+00000050  00 39 c0 09 c0 13 00 33  00 9d 00 9c 00 3d 00 3c  |.9.....3.....=.<|
+00000060  00 35 00 2f 00 ff 01 00  00 42 00 0b 00 04 03 00  |.5./.....B......|
+00000070  01 02 00 0a 00 0a 00 08  00 1d 00 17 00 19 00 18  |................|
+00000080  00 0d 00 20 00 1e 06 01  06 02 06 03 05 01 05 02  |... ............|
+00000090  05 03 04 01 04 02 04 03  03 01 03 02 03 03 02 01  |................|
+000000a0  02 02 02 03 00 16 00 00  00 17 00 00              |............|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 31 02 00 00  2d 03 03 00 00 00 00 00  |....1...-.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -55,43 +47,43 @@
 00000210  0e bd 3f a3 8c 25 c1 33  13 83 0d 94 06 bb d4 37  |..?..%.3.......7|
 00000220  7a f6 ec 7a c9 86 2e dd  d7 11 69 7f 85 7c 56 de  |z..z......i..|V.|
 00000230  fb 31 78 2b e4 c7 78 0d  ae cb be 9e 4e 36 24 31  |.1x+..x.....N6$1|
-00000240  7b 6a 0f 39 95 12 07 8f  2a 16 03 03 00 d7 0c 00  |{j.9....*.......|
-00000250  00 d3 03 00 17 41 04 1e  18 37 ef 0d 19 51 88 35  |.....A...7...Q.5|
+00000240  7b 6a 0f 39 95 12 07 8f  2a 16 03 03 00 d8 0c 00  |{j.9....*.......|
+00000250  00 d4 03 00 17 41 04 1e  18 37 ef 0d 19 51 88 35  |.....A...7...Q.5|
 00000260  75 71 b5 e5 54 5b 12 2e  8f 09 67 fd a7 24 20 3e  |uq..T[....g..$ >|
 00000270  b2 56 1c ce 97 28 5e f8  2b 2d 4f 9e f1 07 9f 6c  |.V...(^.+-O....l|
 00000280  4b 5b 83 56 e2 32 42 e9  58 b6 d7 49 a6 b5 68 1a  |K[.V.2B.X..I..h.|
-00000290  41 03 56 6b dc 5a 89 05  03 00 8a 30 81 87 02 42  |A.Vk.Z.....0...B|
-000002a0  01 b5 7c 63 39 d9 99 99  3f ee 0b 7d aa 01 5d ec  |..|c9...?..}..].|
-000002b0  f5 e7 3b 4c a1 7e 35 8e  68 f8 39 f9 36 0e 75 3d  |..;L.~5.h.9.6.u=|
-000002c0  f4 1a 35 87 fa 33 d2 a1  6e fe 82 b6 47 f9 96 a5  |..5..3..n...G...|
-000002d0  d6 cd 0c df 3b 8d 89 62  b5 05 40 d2 6c d9 05 cb  |....;..b..@.l...|
-000002e0  cc 22 02 41 15 2f af b6  4e d0 d5 cc 81 42 d0 9d  |.".A./..N....B..|
-000002f0  91 e3 ed ed 5a 37 be c0  66 20 d6 f1 d7 a7 d2 db  |....Z7..f ......|
-00000300  14 88 d6 76 8b 8d f7 42  ff 39 56 59 a2 5a 5c 3b  |...v...B.9VY.Z\;|
-00000310  ee 0e 81 5e 3d c5 92 ea  00 48 43 31 f8 60 0d ab  |...^=....HC1.`..|
-00000320  ae a9 ca 5c bb 16 03 03  00 04 0e 00 00 00        |...\..........|
+00000290  41 03 56 6b dc 5a 89 05  03 00 8b 30 81 88 02 42  |A.Vk.Z.....0...B|
+000002a0  00 b8 f1 eb 86 28 6b 15  e3 40 4a ff 9c de 64 4b  |.....(k..@J...dK|
+000002b0  0c d5 94 f5 80 bd 5e 1e  7c 44 df 9b 93 e3 5c 14  |......^.|D....\.|
+000002c0  db 5c 37 f5 dc 66 52 d3  11 63 39 ca 3a 54 80 e1  |.\7..fR..c9.:T..|
+000002d0  f7 80 1f 71 54 cd bd 96  42 4a 69 1a 0f 84 10 68  |...qT...BJi....h|
+000002e0  e2 22 02 42 01 59 e6 60  75 6d e9 f2 c9 13 0c b7  |.".B.Y.`um......|
+000002f0  be 37 7f 7f e0 ba c9 94  ad 50 b9 a3 28 3f 32 a9  |.7.......P..(?2.|
+00000300  20 d9 e6 5c 15 e5 54 2b  25 32 80 c6 b8 c4 27 36  | ..\..T+%2....'6|
+00000310  8b 52 c2 bb 3a 6e d0 67  8c 4b 69 b7 3b 23 11 cc  |.R..:n.g.Ki.;#..|
+00000320  d5 0d 72 07 85 d8 16 03  03 00 04 0e 00 00 00     |..r............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 c1 c5 18 74 5b  |....F...BA....t[|
-00000010  18 cf b1 64 54 8d f5 f4  36 3f 6d 53 87 09 1f 5a  |...dT...6?mS...Z|
-00000020  9c 39 17 09 47 a3 f8 82  82 ae e1 b6 d9 b8 ed fd  |.9..G...........|
-00000030  ab 03 78 d4 46 15 06 8c  2d aa 20 12 b8 5b 46 8f  |..x.F...-. ..[F.|
-00000040  f3 7a 14 5d bb 28 68 9c  3e e2 74 14 03 03 00 01  |.z.].(h.>.t.....|
-00000050  01 16 03 03 00 40 98 37  a5 37 d4 1b f4 d5 5d 4b  |.....@.7.7....]K|
-00000060  0b ee 19 c5 b3 6f 83 bb  99 be c8 50 dd 30 97 70  |.....o.....P.0.p|
-00000070  c8 0e fc d9 c2 eb 86 8c  06 4a 8b b8 af 65 4e 2f  |.........J...eN/|
-00000080  f7 bf d4 53 0e 69 34 9b  73 a8 bb 23 ea dc ab 23  |...S.i4.s..#...#|
-00000090  84 a9 38 d9 21 d1                                 |..8.!.|
+00000000  16 03 03 00 46 10 00 00  42 41 04 9f 54 db bd 3a  |....F...BA..T..:|
+00000010  d2 71 42 ed 24 99 95 5a  4c 97 12 3c d3 bd 5f 4d  |.qB.$..ZL..<.._M|
+00000020  f3 8b 70 5f e8 cb c1 f4  bc 25 0c 2f 2a 80 4f 46  |..p_.....%./*.OF|
+00000030  61 b5 66 99 42 71 de 41  fb 29 44 a5 bb c3 de 49  |a.f.Bq.A.)D....I|
+00000040  f6 83 c7 50 14 49 36 be  3c 8c 2c 14 03 03 00 01  |...P.I6.<.,.....|
+00000050  01 16 03 03 00 40 9b f8  d7 5b ba 0a 97 2b ef f2  |.....@...[...+..|
+00000060  94 a2 03 83 f1 aa 62 31  d5 42 a2 98 11 25 fa ba  |......b1.B...%..|
+00000070  5e d1 59 40 07 20 93 21  80 4f 63 ca 6e 64 77 28  |^.Y@. .!.Oc.ndw(|
+00000080  da 69 12 a7 68 a7 f8 ed  ff 26 7b cb 22 d5 76 1b  |.i..h....&{.".v.|
+00000090  f1 3b 67 66 07 a4                                 |.;gf..|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 46 97 00 86 d0  |...........F....|
-00000020  b4 da 28 f4 50 18 17 21  32 11 88 79 ae 9d 2b 37  |..(.P..!2..y..+7|
-00000030  0b 20 0e c9 06 35 c9 ed  48 b1 c2 b5 c6 15 7a 3e  |. ...5..H.....z>|
-00000040  c9 9d bb e9 c6 77 28 11  9c 6e 0f 17 03 03 00 40  |.....w(..n.....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 83 55 25 ad d6  |............U%..|
+00000020  5c d1 75 26 44 f9 d8 fc  41 58 22 00 db a2 da 4b  |\.u&D...AX"....K|
+00000030  90 a1 69 32 b2 48 72 6b  7c 5c 4b 8f 97 f4 0b e7  |..i2.Hrk|\K.....|
+00000040  f5 83 c4 4e fd f2 8d 88  1a e9 75 17 03 03 00 40  |...N......u....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  a0 24 28 77 b6 e3 8e 9b  76 69 44 7a 5a e9 a8 4e  |.$(w....viDzZ..N|
-00000070  33 b0 d0 f9 ea 3e 22 5e  4b dc 1c 80 4b 72 ec 54  |3....>"^K...Kr.T|
-00000080  95 7e 3c 78 c4 29 58 d2  9b b5 8e 31 09 f6 5a 7a  |.~<x.)X....1..Zz|
+00000060  e1 e2 ae 44 cf 87 a0 b9  1f 34 bb dd 07 a8 cb 3d  |...D.....4.....=|
+00000070  3b 1f 0e 9f be 40 56 04  93 44 e8 ef fb a4 b4 97  |;....@V..D......|
+00000080  60 ce 62 6b 95 6a 0e fd  5b 7b 03 c3 68 d7 51 df  |`.bk.j..[{..h.Q.|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 36 db 47  48 44 a6 b6 4a 3b d1 79  |.....6.GHD..J;.y|
-000000b0  22 e2 49 e1 c4 89 59 6b  fa fd c9 28 a8 55 7b 74  |".I...Yk...(.U{t|
-000000c0  a3 e5 c5 20 12                                    |... .|
+000000a0  00 00 00 00 00 bb 62 4c  32 c1 27 d9 f5 d6 c3 af  |......bL2.'.....|
+000000b0  4b 15 d2 ae 2a 3b d5 57  d3 64 68 ca b4 1b 55 d0  |K...*;.W.dh...U.|
+000000c0  ee fb e0 69 28                                    |...i(|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceRSA b/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceRSA
index 377c606c4e..80857b52f3 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceRSA
+++ b/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceRSA
@@ -1,23 +1,15 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 2a 01 00 01  26 03 03 ed f0 6d f4 95  |....*...&....m..|
-00000010  fa e8 60 9d 08 16 a3 81  47 08 1b 93 2e fe c3 01  |..`.....G.......|
-00000020  52 28 76 5f b3 e0 d7 0e  46 fd 82 00 00 ac c0 30  |R(v_....F......0|
-00000030  c0 2c c0 28 c0 24 c0 14  c0 0a 00 a5 00 a3 00 a1  |.,.(.$..........|
-00000040  00 9f 00 6b 00 6a 00 69  00 68 00 39 00 38 00 37  |...k.j.i.h.9.8.7|
-00000050  00 36 00 88 00 87 00 86  00 85 c0 32 c0 2e c0 2a  |.6.........2...*|
-00000060  c0 26 c0 0f c0 05 00 9d  00 3d 00 35 00 84 c0 2f  |.&.......=.5.../|
-00000070  c0 2b c0 27 c0 23 c0 13  c0 09 00 a4 00 a2 00 a0  |.+.'.#..........|
-00000080  00 9e 00 67 00 40 00 3f  00 3e 00 33 00 32 00 31  |...g.@.?.>.3.2.1|
-00000090  00 30 00 9a 00 99 00 98  00 97 00 45 00 44 00 43  |.0.........E.D.C|
-000000a0  00 42 c0 31 c0 2d c0 29  c0 25 c0 0e c0 04 00 9c  |.B.1.-.).%......|
-000000b0  00 3c 00 2f 00 96 00 41  00 07 c0 11 c0 07 c0 0c  |.<./...A........|
-000000c0  c0 02 00 05 00 04 c0 12  c0 08 00 16 00 13 00 10  |................|
-000000d0  00 0d c0 0d c0 03 00 0a  00 ff 01 00 00 51 00 0b  |.............Q..|
-000000e0  00 04 03 00 01 02 00 0a  00 1c 00 1a 00 17 00 19  |................|
-000000f0  00 1c 00 1b 00 18 00 1a  00 16 00 0e 00 0d 00 0b  |................|
-00000100  00 0c 00 09 00 0a 00 0d  00 20 00 1e 06 01 06 02  |......... ......|
-00000110  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
-00000120  03 02 03 03 02 01 02 02  02 03 00 0f 00 01 01     |...............|
+00000000  16 03 01 00 a7 01 00 00  a3 03 03 c6 e0 ed 21 7c  |..............!||
+00000010  09 45 6b 15 e9 26 d1 1c  39 d8 e7 b9 45 4f 35 0d  |.Ek..&..9...EO5.|
+00000020  b5 7f 57 0b e0 2d 9b 32  a0 85 f8 00 00 38 c0 2c  |..W..-.2.....8.,|
+00000030  c0 30 00 9f cc a9 cc a8  cc aa c0 2b c0 2f 00 9e  |.0.........+./..|
+00000040  c0 24 c0 28 00 6b c0 23  c0 27 00 67 c0 0a c0 14  |.$.(.k.#.'.g....|
+00000050  00 39 c0 09 c0 13 00 33  00 9d 00 9c 00 3d 00 3c  |.9.....3.....=.<|
+00000060  00 35 00 2f 00 ff 01 00  00 42 00 0b 00 04 03 00  |.5./.....B......|
+00000070  01 02 00 0a 00 0a 00 08  00 1d 00 17 00 19 00 18  |................|
+00000080  00 0d 00 20 00 1e 06 01  06 02 06 03 05 01 05 02  |... ............|
+00000090  05 03 04 01 04 02 04 03  03 01 03 02 03 03 02 01  |................|
+000000a0  02 02 02 03 00 16 00 00  00 17 00 00              |............|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 31 02 00 00  2d 03 03 00 00 00 00 00  |....1...-.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -65,37 +57,37 @@
 000002b0  5b 12 2e 8f 09 67 fd a7  24 20 3e b2 56 1c ce 97  |[....g..$ >.V...|
 000002c0  28 5e f8 2b 2d 4f 9e f1  07 9f 6c 4b 5b 83 56 e2  |(^.+-O....lK[.V.|
 000002d0  32 42 e9 58 b6 d7 49 a6  b5 68 1a 41 03 56 6b dc  |2B.X..I..h.A.Vk.|
-000002e0  5a 89 05 01 00 80 cb ff  0a db 63 b1 3f 09 58 df  |Z.........c.?.X.|
-000002f0  d2 0e 55 e8 50 a0 07 31  fa 3e 79 c6 9f c0 0a 3c  |..U.P..1.>y....<|
-00000300  fe ee 18 24 2f cb 20 2b  8f 22 64 28 a4 9b 6e 49  |...$/. +."d(..nI|
-00000310  5a d6 b4 85 d5 35 db fc  b8 06 ec 34 4a a3 b3 2f  |Z....5.....4J../|
-00000320  11 50 5d cb 9f 65 eb d7  90 03 11 10 e6 ac 3e ad  |.P]..e........>.|
-00000330  a3 46 82 ba d6 90 a2 8c  2b 26 ff f0 bb bf 52 fc  |.F......+&....R.|
-00000340  d9 30 90 c6 e4 d5 be ce  a0 fb 55 0d 31 9c f6 3e  |.0........U.1..>|
-00000350  df 55 05 3c c6 17 82 3c  ee 65 0f a3 98 96 e2 0a  |.U.<...<.e......|
-00000360  47 3a fe b7 8f 4f 16 03  03 00 04 0e 00 00 00     |G:...O.........|
+000002e0  5a 89 05 01 00 80 92 d2  50 33 89 38 da 9b ca f6  |Z.......P3.8....|
+000002f0  5c e4 71 81 e3 c2 20 4e  76 7f 5a fd db 23 30 a4  |\.q... Nv.Z..#0.|
+00000300  13 23 b5 21 5d 07 48 bf  4d d9 cd cc 9e 61 3c ef  |.#.!].H.M....a<.|
+00000310  2e 08 39 0e 67 a4 04 61  ce ed de 8d b6 fd c1 6c  |..9.g..a.......l|
+00000320  40 bf a5 0a 81 58 8d 19  f6 00 ea e8 f3 da 86 d1  |@....X..........|
+00000330  6f 30 bc af 7f a0 ff 55  26 8a c4 aa 67 7e dd 51  |o0.....U&...g~.Q|
+00000340  99 2d d7 6c b0 1f ad 5b  7e 2b c4 2c c1 61 87 3b  |.-.l...[~+.,.a.;|
+00000350  99 46 8d a4 60 a6 e1 6a  76 84 a7 d9 d0 7a f7 cf  |.F..`..jv....z..|
+00000360  25 d5 e7 f7 ec 98 16 03  03 00 04 0e 00 00 00     |%..............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 35 e0 c8 d2 37  |....F...BA.5...7|
-00000010  a8 cf 54 0b dd 6d f4 2d  cf aa 80 ea 87 97 f3 b8  |..T..m.-........|
-00000020  e7 e6 dc 0e 68 8c 64 19  55 e9 2e d7 5c d7 bb b8  |....h.d.U...\...|
-00000030  4e 6d cc 4f f1 6c 8f 48  22 b7 a9 70 a3 a8 8f 21  |Nm.O.l.H"..p...!|
-00000040  ca 9c 7c 51 51 9a 73 16  5a b5 69 14 03 03 00 01  |..|QQ.s.Z.i.....|
-00000050  01 16 03 03 00 40 a3 cb  c6 aa 9f c8 8f 2c 0d ec  |.....@.......,..|
-00000060  93 0d 7e ae c0 69 35 a3  d0 55 78 92 a5 e6 43 10  |..~..i5..Ux...C.|
-00000070  f3 ae 2d 22 60 59 ea 80  79 c6 84 8b fa ea 19 91  |..-"`Y..y.......|
-00000080  0f 64 25 89 a3 54 52 31  95 03 65 d1 1b e4 7d b6  |.d%..TR1..e...}.|
-00000090  a4 2a 9d 9f 12 44                                 |.*...D|
+00000000  16 03 03 00 46 10 00 00  42 41 04 81 f6 51 07 43  |....F...BA...Q.C|
+00000010  27 64 fd ac a7 30 b0 06  97 ba 85 50 f9 41 da 33  |'d...0.....P.A.3|
+00000020  8c 1a 4b 17 b4 63 04 2c  14 f7 35 a8 8b 79 40 08  |..K..c.,..5..y@.|
+00000030  a8 b2 7e 24 cf 51 f0 1e  2b a9 f9 42 0d 7e 0a 17  |..~$.Q..+..B.~..|
+00000040  bb 94 f0 7e 66 e1 bf 87  e6 f3 65 14 03 03 00 01  |...~f.....e.....|
+00000050  01 16 03 03 00 40 7b 65  a7 15 d5 d9 03 c8 79 ab  |.....@{e......y.|
+00000060  16 eb 0d 78 d7 31 9f bb  88 be aa 19 fd 15 dc e7  |...x.1..........|
+00000070  9e 89 df cf 28 e6 e9 be  7b ec 9b 79 05 9e d8 4d  |....(...{..y...M|
+00000080  0a 43 90 97 2e b0 f7 f4  a7 98 36 9b b5 45 a0 5c  |.C........6..E.\|
+00000090  e6 cf 8f 52 66 6f                                 |...Rfo|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 e7 85 23 79 ac  |.............#y.|
-00000020  40 04 a0 c5 84 71 8f 2e  b2 f3 b6 13 82 7d 4b 39  |@....q.......}K9|
-00000030  86 76 62 fc af ec 3b e2  ba 41 97 d3 1b 67 29 c8  |.vb...;..A...g).|
-00000040  34 c4 42 f6 f3 32 dd 46  0a 02 1d 17 03 03 00 40  |4.B..2.F.......@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 65 e7 6e b1 7b  |...........e.n.{|
+00000020  eb cc 56 f0 b6 d5 f3 62  0f 04 e9 f3 19 40 ff 10  |..V....b.....@..|
+00000030  62 1b 5d f8 d9 58 4d 0f  c1 21 2d ce 27 22 3e 1b  |b.]..XM..!-.'">.|
+00000040  83 b2 08 bd a6 1d f8 d8  51 39 72 17 03 03 00 40  |........Q9r....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  62 26 80 66 d7 9f 00 4b  cf 39 f7 13 ae 3b 1b 09  |b&.f...K.9...;..|
-00000070  6a bc 08 eb ef ba 55 69  d7 87 40 48 79 71 5a fa  |j.....Ui..@HyqZ.|
-00000080  94 1d 0e 2d 7e 0c 2a 8e  df 8b 46 44 9e 0f 6c 46  |...-~.*...FD..lF|
+00000060  4c 58 dd ee ab 29 35 6e  c1 b7 17 14 80 71 99 3e  |LX...)5n.....q.>|
+00000070  f2 1d 70 14 95 87 c1 b9  75 a3 26 78 b0 93 22 33  |..p.....u.&x.."3|
+00000080  42 77 6f 0a 13 45 a4 5b  76 69 b8 a1 4b 6e c3 37  |Bwo..E.[vi..Kn.7|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 03 a4 fd  6c a7 32 cd 5c 7b fd de  |........l.2.\{..|
-000000b0  cf 87 c6 62 3a 13 d6 d9  28 78 07 b7 89 16 bb dd  |...b:...(x......|
-000000c0  f1 f1 4a 95 04                                    |..J..|
+000000a0  00 00 00 00 00 60 8b 42  ec 29 a7 60 fc 3a 0a d3  |.....`.B.).`.:..|
+000000b0  72 c0 42 e0 13 16 46 5a  2b 17 ee 62 56 bc f2 c1  |r.B...FZ+..bV...|
+000000c0  ed db 99 cf aa                                    |.....|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndECDSAGiven b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndECDSAGiven
index 98c51fdb36..a7ff62fab1 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndECDSAGiven
+++ b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndECDSAGiven
@@ -1,14 +1,15 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 5a 01 00 00  56 03 03 2f f8 08 e4 71  |....Z...V../...q|
-00000010  48 02 2d 7b 77 c5 85 55  79 09 4e 7f 81 c6 d6 d3  |H.-{w..Uy.N.....|
-00000020  ff ad 04 cb 72 d9 29 d4  7b 5c be 00 00 04 00 05  |....r.).{\......|
-00000030  00 ff 01 00 00 29 00 0d  00 20 00 1e 06 01 06 02  |.....)... ......|
+00000000  16 03 01 00 5d 01 00 00  59 03 03 d7 12 82 dd 63  |....]...Y......c|
+00000010  23 f8 ad 94 0d f4 8a c7  8c b3 55 99 6a 6d d7 f6  |#.........U.jm..|
+00000020  d5 f5 5b 7c b0 20 ee ed  3b 04 c0 00 00 04 00 2f  |..[|. ..;....../|
+00000030  00 ff 01 00 00 2c 00 0d  00 20 00 1e 06 01 06 02  |.....,... ......|
 00000040  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
-00000050  03 02 03 03 02 01 02 02  02 03 00 0f 00 01 01     |...............|
+00000050  03 02 03 03 02 01 02 02  02 03 00 16 00 00 00 17  |................|
+00000060  00 00                                             |..|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 31 02 00 00  2d 03 03 00 00 00 00 00  |....1...-.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 05 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2f 00 00  |............./..|
 00000030  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
 00000040  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000050  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -84,32 +85,40 @@
 000001e0  be e8 91 b3 da 1a f5 5d  a3 23 f5 26 8b 45 70 8d  |.......].#.&.Ep.|
 000001f0  65 62 9b 7e 01 99 3d 18  f6 10 9a 38 61 9b 2e 57  |eb.~..=....8a..W|
 00000200  e4 fa cc b1 8a ce e2 23  a0 87 f0 e1 67 51 eb 16  |.......#....gQ..|
-00000210  03 03 00 86 10 00 00 82  00 80 84 82 71 85 57 ee  |............q.W.|
-00000220  97 b1 f2 6e 0a 42 72 28  1d cd 2d c7 e8 99 4c e4  |...n.Br(..-...L.|
-00000230  e3 23 61 b9 5c da 39 c7  b7 5d 38 cf 2a cd e1 ba  |.#a.\.9..]8.*...|
-00000240  ce bb 01 ee 3e 3f 9a 3b  49 95 ba 29 71 1c 95 92  |....>?.;I..)q...|
-00000250  02 9f f6 4c 3b 72 59 8e  75 47 82 f4 73 c3 e3 7e  |...L;rY.uG..s..~|
-00000260  4f af e3 08 f4 cf 4d d3  ce d4 e6 73 5e b1 77 55  |O.....M....s^.wU|
-00000270  77 9a a2 1a d5 55 d8 8e  8b d8 f8 fd c2 dc 5d 49  |w....U........]I|
-00000280  dc 00 86 3a 51 63 12 e3  bb f6 9c 28 85 f2 62 80  |...:Qc.....(..b.|
-00000290  d2 73 2c 2e dc 13 98 68  d7 c9 16 03 03 00 92 0f  |.s,....h........|
-000002a0  00 00 8e 04 03 00 8a 30  81 87 02 42 00 f7 1d e8  |.......0...B....|
-000002b0  55 b7 87 1b 5a 68 90 a0  ad 61 16 08 c8 9c 57 e0  |U...Zh...a....W.|
-000002c0  e4 a7 e0 3c c5 04 af 67  82 c5 8c b5 c5 ea 0c bc  |...<...g........|
-000002d0  fa d5 ca 4b 5f 0c 0b 6b  52 b4 77 87 e8 6e 00 ba  |...K_..kR.w..n..|
-000002e0  b1 b9 1c 6c df b6 f0 cf  71 7d f9 a2 d6 f9 02 41  |...l....q}.....A|
-000002f0  45 5b d8 53 ee 3d e4 55  cf 44 95 e6 94 e2 50 77  |E[.S.=.U.D....Pw|
-00000300  60 e2 95 15 bc 5f 05 f1  2a ca b9 a0 06 68 ed ba  |`...._..*....h..|
-00000310  7e 03 fe 81 f0 38 98 83  27 c3 80 bd 51 e4 50 d6  |~....8..'...Q.P.|
-00000320  64 c0 84 d3 8c cc 49 4f  55 87 e4 19 b2 2b ea af  |d.....IOU....+..|
-00000330  7a 14 03 03 00 01 01 16  03 03 00 24 8f 3a 0b ad  |z..........$.:..|
-00000340  e4 4d cf e9 64 56 29 92  09 b3 ef 87 c7 3c 82 ae  |.M..dV)......<..|
-00000350  cf e4 f0 f5 c0 85 16 00  2c bd 6e 59 e0 c1 99 61  |........,.nY...a|
+00000210  03 03 00 86 10 00 00 82  00 80 b1 97 e3 ae b9 19  |................|
+00000220  17 f8 a8 98 30 6c 4b 53  a0 44 c9 8a ad b4 6a 2c  |....0lKS.D....j,|
+00000230  19 c8 96 88 dd 9d 00 7b  7f f3 d7 c8 5d 87 86 49  |.......{....]..I|
+00000240  52 fb 3c d5 68 b5 75 dd  de 9e 19 2f e2 ed 0c a6  |R.<.h.u..../....|
+00000250  05 12 29 b6 e8 16 af ef  6e f9 b4 c3 86 6e 0c 65  |..).....n....n.e|
+00000260  9a 9d 1e 52 98 4f e3 b1  a1 c3 d5 9d ea 90 ab 69  |...R.O.........i|
+00000270  e7 1c 37 5e c8 a2 d9 50  dd b3 00 fe b2 a1 6a 05  |..7^...P......j.|
+00000280  62 61 2e 89 fa ad b6 9f  a4 74 27 f8 bd ba ee 41  |ba.......t'....A|
+00000290  2a 44 82 31 86 9a 58 43  b1 bc 16 03 03 00 93 0f  |*D.1..XC........|
+000002a0  00 00 8f 04 03 00 8b 30  81 88 02 42 01 f3 07 47  |.......0...B...G|
+000002b0  ea f9 5c 44 67 6e 37 d5  63 c0 df 91 3a cb a5 1b  |..\Dgn7.c...:...|
+000002c0  0f e4 f2 36 56 19 49 84  88 8e 4d bf e4 ba 2f 47  |...6V.I...M.../G|
+000002d0  f8 d8 96 2e 8c 41 3a 4f  42 a8 4c f1 06 1d 8f 9b  |.....A:OB.L.....|
+000002e0  62 be 3d c3 e9 7e 68 f9  39 b6 88 cf 1a 56 02 42  |b.=..~h.9....V.B|
+000002f0  00 8f de d5 78 72 56 f0  ef 92 fb 96 2b 4a f7 14  |....xrV.....+J..|
+00000300  36 89 a5 36 73 78 c0 e9  e0 e6 3b 8b 45 9a 13 e5  |6..6sx....;.E...|
+00000310  a8 21 d3 63 e0 03 37 92  6f c7 71 b9 64 55 05 04  |.!.c..7.o.q.dU..|
+00000320  89 d4 e1 af 3e 8f ee 1c  52 67 b8 c5 78 ca 54 0f  |....>...Rg..x.T.|
+00000330  4d 5f 14 03 03 00 01 01  16 03 03 00 40 d6 87 b0  |M_..........@...|
+00000340  39 ff 10 da 8b 36 e9 11  84 84 ae c3 f2 83 1d fd  |9....6..........|
+00000350  86 ff 03 b9 0f c0 6d 10  8b 40 1b 30 96 ce 7f a8  |......m..@.0....|
+00000360  5a b2 a8 0a 46 81 cc 9b  14 bf 62 8b b2 f1 5c 22  |Z...F.....b...\"|
+00000370  47 75 cb 44 d6 a1 a2 6a  94 2b 25 54 9d           |Gu.D...j.+%T.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 24 b9 c3 e0 15 53  |..........$....S|
-00000010  24 94 d0 1f 58 82 08 2e  35 18 f0 f8 ae 3c 5f c0  |$...X...5....<_.|
-00000020  6f f9 5d af 52 00 3a 1b  5f e4 08 24 69 66 f8 17  |o.].R.:._..$if..|
-00000030  03 03 00 21 f0 8b 7f 9d  44 38 76 42 a7 6b 29 aa  |...!....D8vB.k).|
-00000040  f0 58 45 6c aa 0e a6 c8  7e 77 da f0 da 64 c8 15  |.XEl....~w...d..|
-00000050  94 d7 d5 db f7 15 03 03  00 16 65 06 ab a2 06 54  |..........e....T|
-00000060  1c 93 76 b6 52 2e 49 50  f1 ce 91 58 a7 3d d0 5b  |..v.R.IP...X.=.[|
+00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
+00000010  00 00 00 00 00 00 00 00  00 00 00 85 e3 d1 d9 d5  |................|
+00000020  65 15 4f 6b 60 52 11 4f  a8 dd 8a f6 86 77 34 9a  |e.Ok`R.O.....w4.|
+00000030  20 1c b6 08 21 8a 58 6a  ad 7f 78 1b 61 18 a5 9e  | ...!.Xj..x.a...|
+00000040  58 56 14 12 5c e7 3e bc  53 66 c5 17 03 03 00 40  |XV..\.>.Sf.....@|
+00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000060  88 a3 55 9e 29 cc 97 6a  b9 67 94 2b 22 c4 2b 24  |..U.)..j.g.+".+$|
+00000070  22 3c af 8d b4 20 03 73  3d 9d d6 d7 42 f8 22 0d  |"<... .s=...B.".|
+00000080  bf 9a d0 70 42 7b 7b 6f  3f 2e d8 9b 59 8b eb 5f  |...pB{{o?...Y.._|
+00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
+000000a0  00 00 00 00 00 64 b3 8c  5a 16 0d bf 69 66 05 58  |.....d..Z...if.X|
+000000b0  d0 5d 67 a7 29 0c ec e1  f4 99 6f c6 96 de 4e a2  |.]g.).....o...N.|
+000000c0  55 6d 33 b5 58                                    |Um3.X|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndGiven b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndGiven
index 161fc39bd6..56752fbc23 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndGiven
+++ b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndGiven
@@ -1,14 +1,15 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 5a 01 00 00  56 03 03 81 bd d3 28 19  |....Z...V.....(.|
-00000010  53 bd 3d a0 4a f7 ee 94  1f a1 a1 e8 51 88 08 76  |S.=.J.......Q..v|
-00000020  22 a8 0d 5e 56 42 a5 6b  4c 8d 2e 00 00 04 00 05  |"..^VB.kL.......|
-00000030  00 ff 01 00 00 29 00 0d  00 20 00 1e 06 01 06 02  |.....)... ......|
+00000000  16 03 01 00 5d 01 00 00  59 03 03 15 ae f7 7e 39  |....]...Y.....~9|
+00000010  6a 96 da d0 a0 58 44 b7  38 92 d7 4c 41 72 49 d3  |j....XD.8..LArI.|
+00000020  e8 65 74 4c 1c a0 1a de  e5 03 53 00 00 04 00 2f  |.etL......S..../|
+00000030  00 ff 01 00 00 2c 00 0d  00 20 00 1e 06 01 06 02  |.....,... ......|
 00000040  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
-00000050  03 02 03 03 02 01 02 02  02 03 00 0f 00 01 01     |...............|
+00000050  03 02 03 03 02 01 02 02  02 03 00 16 00 00 00 17  |................|
+00000060  00 00                                             |..|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 31 02 00 00  2d 03 03 00 00 00 00 00  |....1...-.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 05 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2f 00 00  |............./..|
 00000030  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
 00000040  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000050  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -83,32 +84,40 @@
 000001d0  ac 11 b1 28 56 be 1d cd  61 62 84 09 bf d6 80 c6  |...(V...ab......|
 000001e0  45 8d 82 2c b4 d8 83 9b  db c9 22 b7 2a 12 11 7b  |E..,......".*..{|
 000001f0  fa 02 3b c1 c9 ff ea c9  9d a8 49 d3 95 d7 d5 0e  |..;.......I.....|
-00000200  e5 35 16 03 03 00 86 10  00 00 82 00 80 71 f6 d6  |.5...........q..|
-00000210  21 d7 96 89 cb a4 93 cb  dd 47 77 74 5e c3 1c 57  |!........Gwt^..W|
-00000220  97 3a 02 d3 67 f1 19 ae  4c fc 83 e0 05 23 f2 af  |.:..g...L....#..|
-00000230  0a 0e 74 37 18 b5 df 0b  ef 56 b5 1e eb 6c a6 65  |..t7.....V...l.e|
-00000240  d5 98 d7 46 3b 14 23 1f  d0 81 cc 32 bf 69 e5 63  |...F;.#....2.i.c|
-00000250  65 6c 20 92 cc 32 31 2f  98 f1 4f 1a a1 6a 58 3f  |el ..21/..O..jX?|
-00000260  51 e9 a6 bb 3b 01 1a 6c  00 ab 6d a5 1c aa d0 db  |Q...;..l..m.....|
-00000270  4f e0 23 10 7f 8b 08 b4  2b f0 aa f3 68 2c f5 d1  |O.#.....+...h,..|
-00000280  cf 90 bd ee fb 5f 61 00  1c 97 45 62 2d 16 03 03  |....._a...Eb-...|
-00000290  00 88 0f 00 00 84 04 01  00 80 9b 2f bf 57 dc 72  |.........../.W.r|
-000002a0  7c 17 0c c9 6f be c8 0b  85 13 94 5f 01 02 1b b3  ||...o......_....|
-000002b0  86 44 cd c5 7e 06 83 cd  3c 49 2a 21 8b 1f cd 6d  |.D..~...<I*!...m|
-000002c0  ae 9a b9 9f 92 1f 1a 46  ee cc 2d a7 9e c7 c9 f2  |.......F..-.....|
-000002d0  3e f0 4c 32 46 5e 29 3e  e9 ce a2 ee a8 9c bf 73  |>.L2F^)>.......s|
-000002e0  49 ad 3b 8c a1 d2 6e c7  74 15 48 0d 61 c3 2e 80  |I.;...n.t.H.a...|
-000002f0  f7 99 fe 5c 9f 59 0e 07  b4 1a 54 d1 96 17 c5 0d  |...\.Y....T.....|
-00000300  6b 73 28 71 eb 40 57 2e  9a 2d 66 0a 83 75 72 a6  |ks(q.@W..-f..ur.|
-00000310  5a 38 3c e9 7e 53 cc 00  85 59 14 03 03 00 01 01  |Z8<.~S...Y......|
-00000320  16 03 03 00 24 8f ee 65  2b d1 64 02 5b 9e 30 58  |....$..e+.d.[.0X|
-00000330  db 53 bf 5a b7 66 44 16  65 22 58 32 2e bb 1e e8  |.S.Z.fD.e"X2....|
-00000340  d7 ad b3 52 eb 18 bc ea  a2                       |...R.....|
+00000200  e5 35 16 03 03 00 86 10  00 00 82 00 80 20 d8 e1  |.5........... ..|
+00000210  b1 0a 0d a5 85 07 d9 45  a0 36 29 4e 37 b7 17 13  |.......E.6)N7...|
+00000220  b7 c4 52 a6 a0 55 3b ad  ee 67 20 3f 96 76 d4 6d  |..R..U;..g ?.v.m|
+00000230  bd 4c 76 23 e4 a3 df a8  1e 73 22 ce ca 99 02 39  |.Lv#.....s"....9|
+00000240  2f 75 3a 7d 60 7e c8 dd  9e 51 d6 f5 7b 14 b1 e4  |/u:}`~...Q..{...|
+00000250  1e ed 71 e0 26 99 41 68  0d d2 61 3e 5f 90 f1 58  |..q.&.Ah..a>_..X|
+00000260  20 af ab 5f a6 e2 61 47  b8 d2 14 e0 d8 51 54 16  | .._..aG.....QT.|
+00000270  9c f8 75 13 ec e6 df 7e  eb 06 c9 0a 12 b2 b3 09  |..u....~........|
+00000280  2f 59 97 e7 c5 33 e1 24  59 bf 66 a9 51 16 03 03  |/Y...3.$Y.f.Q...|
+00000290  00 88 0f 00 00 84 04 01  00 80 b0 6e dd cd d8 26  |...........n...&|
+000002a0  26 e3 4c e9 1c 30 4e 15  99 fb 79 b0 3d 78 38 76  |&.L..0N...y.=x8v|
+000002b0  fe 42 f5 50 af 38 69 17  83 3b 08 93 13 65 36 59  |.B.P.8i..;...e6Y|
+000002c0  69 55 85 cf 42 dc 04 38  14 a5 f2 6f 64 35 8a 58  |iU..B..8...od5.X|
+000002d0  1a de ea 53 f8 69 f4 d0  08 d7 7a b2 c0 b3 66 b6  |...S.i....z...f.|
+000002e0  ef a1 f0 59 19 72 78 b9  c1 61 77 06 00 b2 43 51  |...Y.rx..aw...CQ|
+000002f0  ae 97 2c be 29 b8 61 fc  4d 15 fd db 44 4d 16 4c  |..,.).a.M...DM.L|
+00000300  0b bb 2c 2e 1b 66 c1 4c  68 7e 20 21 75 1d c9 56  |..,..f.Lh~ !u..V|
+00000310  d8 88 01 79 bd 64 d8 2e  6f 24 14 03 03 00 01 01  |...y.d..o$......|
+00000320  16 03 03 00 40 74 6a 8d  2f bc 4c 1f cf cc c0 db  |....@tj./.L.....|
+00000330  a8 e6 bf d4 6b 42 00 b2  f3 97 fb db 5a 62 01 47  |....kB......Zb.G|
+00000340  49 83 04 7f ac 1c 2f 97  36 86 04 d0 14 55 9f ba  |I...../.6....U..|
+00000350  8d b5 af df 31 8b 05 ae  b5 42 93 fc 4f 0f 47 78  |....1....B..O.Gx|
+00000360  69 1e 7b b1 85                                    |i.{..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 24 28 a1 20 b1 95  |..........$(. ..|
-00000010  6d 71 e0 83 ed 83 f8 ad  fc 27 d5 bd bb 1a 60 22  |mq.......'....`"|
-00000020  a2 98 bc b1 17 e2 10 81  fc 91 15 b5 e3 bd 66 17  |..............f.|
-00000030  03 03 00 21 d2 db 76 e1  a2 2c d0 c1 09 53 0b 35  |...!..v..,...S.5|
-00000040  38 37 bf 45 66 42 54 6b  51 93 27 64 21 ba b9 8b  |87.EfBTkQ.'d!...|
-00000050  b8 1c 23 f3 23 15 03 03  00 16 ad ee df 40 a4 df  |..#.#........@..|
-00000060  5d cb b0 bf f8 c4 65 41  b4 03 79 e9 1d 82 2c 3a  |].....eA..y...,:|
+00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
+00000010  00 00 00 00 00 00 00 00  00 00 00 1d 68 a8 dc aa  |............h...|
+00000020  c4 e4 11 4a 2b 96 20 bf  e8 53 ec 78 1d e6 b8 62  |...J+. ..S.x...b|
+00000030  c0 3e 87 3b 1a 1c 21 55  76 99 33 83 8b d1 d1 dd  |.>.;..!Uv.3.....|
+00000040  3b 4e 11 5b 32 18 4c 08  1d 0a 75 17 03 03 00 40  |;N.[2.L...u....@|
+00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000060  13 bc 72 77 fa 97 52 ce  b3 0a 0d fb 2d 2e a0 81  |..rw..R.....-...|
+00000070  12 3b 9d 9d c3 ad bd 6e  ab d9 17 ec d5 e8 f4 76  |.;.....n.......v|
+00000080  94 5c 96 a3 1a 78 0c 0a  de cd fb 35 f6 95 90 4a  |.\...x.....5...J|
+00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
+000000a0  00 00 00 00 00 61 34 c5  62 46 75 7d a3 af ba f0  |.....a4.bFu}....|
+000000b0  e8 f5 9c 79 a7 4c f4 b6  d0 63 56 29 92 c5 26 1f  |...y.L...cV)..&.|
+000000c0  54 85 e4 74 80                                    |T..t.|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedNotGiven b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedNotGiven
index ad4927217a..1308ad69c1 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedNotGiven
+++ b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedNotGiven
@@ -1,14 +1,15 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 5a 01 00 00  56 03 03 08 72 de 7e b8  |....Z...V...r.~.|
-00000010  2c a6 e1 66 03 ab 08 66  25 b6 59 37 33 ba 4d 8d  |,..f...f%.Y73.M.|
-00000020  06 97 a5 8e cb ab 44 a7  e8 6e e3 00 00 04 00 05  |......D..n......|
-00000030  00 ff 01 00 00 29 00 0d  00 20 00 1e 06 01 06 02  |.....)... ......|
+00000000  16 03 01 00 5d 01 00 00  59 03 03 36 f8 aa 81 3e  |....]...Y..6...>|
+00000010  79 7c 8a 8a 5c 87 73 70  c6 2b dd fc bc 8d ab e8  |y|..\.sp.+......|
+00000020  ec 85 c1 69 d0 9a a5 4e  29 96 a0 00 00 04 00 2f  |...i...N)....../|
+00000030  00 ff 01 00 00 2c 00 0d  00 20 00 1e 06 01 06 02  |.....,... ......|
 00000040  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
-00000050  03 02 03 03 02 01 02 02  02 03 00 0f 00 01 01     |...............|
+00000050  03 02 03 03 02 01 02 02  02 03 00 16 00 00 00 17  |................|
+00000060  00 00                                             |..|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 31 02 00 00  2d 03 03 00 00 00 00 00  |....1...-.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 05 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2f 00 00  |............./..|
 00000030  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
 00000040  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000050  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -52,23 +53,31 @@
 000002b0  16 03 03 00 04 0e 00 00  00                       |.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 07 0b 00 00  03 00 00 00 16 03 03 00  |................|
-00000010  86 10 00 00 82 00 80 d8  c4 02 4e 91 20 88 01 28  |..........N. ..(|
-00000020  9c 5c 60 60 9b b2 2a d4  2c 35 97 71 db 5a 9e de  |.\``..*.,5.q.Z..|
-00000030  84 b8 ad 4c d5 94 99 91  79 5a cd ee fc a0 68 61  |...L....yZ....ha|
-00000040  bc 92 d5 93 c5 13 d8 f2  9c c4 0e 3d 46 f0 b2 07  |...........=F...|
-00000050  6d da b3 5c 23 5f 1e a4  1d 12 2d dc 29 41 76 e0  |m..\#_....-.)Av.|
-00000060  3e c4 03 a3 d7 84 25 90  44 45 2f 9e a7 d0 71 39  |>.....%.DE/...q9|
-00000070  ed 67 0c 4f 06 ea a8 6d  74 c7 37 57 e7 c4 7c 86  |.g.O...mt.7W..|.|
-00000080  be f5 1e 53 66 91 83 48  8d de ef b9 d5 fb a3 1c  |...Sf..H........|
-00000090  9b d7 43 57 06 01 be 14  03 03 00 01 01 16 03 03  |..CW............|
-000000a0  00 24 e6 fe 44 ad 96 8d  54 9b a4 2f 3d e2 d7 6b  |.$..D...T../=..k|
-000000b0  af 19 12 75 54 65 d0 bc  e6 d7 cc 78 fb 3a 37 85  |...uTe.....x.:7.|
-000000c0  aa b2 f5 b1 e2 97                                 |......|
+00000010  86 10 00 00 82 00 80 3e  56 5e ef 42 78 3b 12 a5  |.......>V^.Bx;..|
+00000020  4a 53 1c 72 c8 d4 91 3a  45 42 e9 f2 50 55 ec 9b  |JS.r...:EB..PU..|
+00000030  6c 2e 87 57 95 e5 fd 1d  9f 19 99 a4 16 30 ea fe  |l..W.........0..|
+00000040  97 b4 ac 58 14 b0 2c fa  f0 5c b4 58 c6 c3 5e 37  |...X..,..\.X..^7|
+00000050  da 13 e9 8b 1b 3e 4c 4e  c3 a6 60 f9 17 4e 7f 67  |.....>LN..`..N.g|
+00000060  4c db 4d 50 36 aa dc 86  48 ab be 10 06 03 4f ef  |L.MP6...H.....O.|
+00000070  a0 58 3a 37 67 ba 50 a8  35 19 69 27 1f c1 a7 ac  |.X:7g.P.5.i'....|
+00000080  d7 8c fa 0e 6c 21 c8 be  5e 03 34 2e 3e 91 6d dd  |....l!..^.4.>.m.|
+00000090  ba ca e9 7a c0 1a 18 14  03 03 00 01 01 16 03 03  |...z............|
+000000a0  00 40 27 ed e0 28 80 fe  a9 75 21 33 09 40 20 80  |.@'..(...u!3.@ .|
+000000b0  93 f3 41 5c 3b ac 82 73  61 fd 32 30 c3 3f 0b 81  |..A\;..sa.20.?..|
+000000c0  24 49 32 95 c2 54 5d eb  3a a5 c1 ea f2 0f 83 a7  |$I2..T].:.......|
+000000d0  54 48 6e bd 1f 84 e8 a9  34 e1 c5 55 db 5b 1c e2  |THn.....4..U.[..|
+000000e0  85 02                                             |..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 24 28 f1 62 f2 25  |..........$(.b.%|
-00000010  67 a0 96 bc f6 f8 64 9e  59 a1 7a 62 6b e6 41 f7  |g.....d.Y.zbk.A.|
-00000020  7d 54 65 61 7f 39 08 df  b5 65 2d e3 1f a1 8f 17  |}Tea.9...e-.....|
-00000030  03 03 00 21 70 04 8f 3f  ba fb fb ae 67 61 92 ba  |...!p..?....ga..|
-00000040  eb 81 60 1a c6 4b c3 14  15 11 dd 42 57 8d c3 46  |..`..K.....BW..F|
-00000050  b3 92 08 7c 84 15 03 03  00 16 58 f7 27 ac a5 8d  |...|......X.'...|
-00000060  2c 0f a9 1b 09 ad ad 29  65 5d 83 f4 b7 0b 7b f6  |,......)e]....{.|
+00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
+00000010  00 00 00 00 00 00 00 00  00 00 00 2a c4 ad 60 17  |...........*..`.|
+00000020  f4 8a 21 78 04 83 ea 17  df 32 7d 92 46 1a 99 b2  |..!x.....2}.F...|
+00000030  4e 21 6b da 9c e2 24 71  a4 fc 9f a4 c1 b0 45 43  |N!k...$q......EC|
+00000040  71 05 14 49 8e 8c 45 15  24 ed b0 17 03 03 00 40  |q..I..E.$......@|
+00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000060  43 89 2a ac ba 92 98 96  c1 bf 06 bd 04 27 36 1b  |C.*..........'6.|
+00000070  28 8b de eb c2 4c 5f 17  f4 88 7c 56 9f b0 a8 c9  |(....L_...|V....|
+00000080  22 f4 91 f8 cf 78 e6 c4  ba 2b 08 73 ee bb c4 96  |"....x...+.s....|
+00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
+000000a0  00 00 00 00 00 07 aa 18  1d 67 a4 0b b3 d0 2b 38  |.........g....+8|
+000000b0  a8 57 da 98 f7 66 59 a8  6a fa c8 c9 03 91 c3 f5  |.W...fY.j.......|
+000000c0  57 e2 8f e1 45                                    |W...E|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Server-TLSv12-ECDHE-ECDSA-AES
index 043ed833c5..7d06a5e5e3 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Server-TLSv12-ECDHE-ECDSA-AES
@@ -1,13 +1,12 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 82 01 00 00  7e 03 03 b6 f5 2e 0d 04  |........~.......|
-00000010  bb a7 a7 6d 25 40 29 e0  81 fb ba 9f 7a 58 a9 8c  |...m%@).....zX..|
-00000020  15 3e b6 b4 9e 6e c0 76  ec dd 48 00 00 04 c0 0a  |.>...n.v..H.....|
-00000030  00 ff 01 00 00 51 00 0b  00 04 03 00 01 02 00 0a  |.....Q..........|
-00000040  00 1c 00 1a 00 17 00 19  00 1c 00 1b 00 18 00 1a  |................|
-00000050  00 16 00 0e 00 0d 00 0b  00 0c 00 09 00 0a 00 0d  |................|
-00000060  00 20 00 1e 06 01 06 02  06 03 05 01 05 02 05 03  |. ..............|
-00000070  04 01 04 02 04 03 03 01  03 02 03 03 02 01 02 02  |................|
-00000080  02 03 00 0f 00 01 01                              |.......|
+00000000  16 03 01 00 73 01 00 00  6f 03 03 3a 87 41 97 6b  |....s...o..:.A.k|
+00000010  86 2e 9d 9c 1d d1 b7 19  a6 98 2f 1a e0 e1 7a 2f  |........../...z/|
+00000020  92 42 4a 5f fd 5c 59 d6  58 6b 6a 00 00 04 c0 0a  |.BJ_.\Y.Xkj.....|
+00000030  00 ff 01 00 00 42 00 0b  00 04 03 00 01 02 00 0a  |.....B..........|
+00000040  00 0a 00 08 00 1d 00 17  00 19 00 18 00 0d 00 20  |............... |
+00000050  00 1e 06 01 06 02 06 03  05 01 05 02 05 03 04 01  |................|
+00000060  04 02 04 03 03 01 03 02  03 03 02 01 02 02 02 03  |................|
+00000070  00 16 00 00 00 17 00 00                           |........|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 31 02 00 00  2d 03 03 00 00 00 00 00  |....1...-.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -51,37 +50,37 @@
 00000270  b2 56 1c ce 97 28 5e f8  2b 2d 4f 9e f1 07 9f 6c  |.V...(^.+-O....l|
 00000280  4b 5b 83 56 e2 32 42 e9  58 b6 d7 49 a6 b5 68 1a  |K[.V.2B.X..I..h.|
 00000290  41 03 56 6b dc 5a 89 05  03 00 8b 30 81 88 02 42  |A.Vk.Z.....0...B|
-000002a0  01 db a3 9f 95 55 ad 38  2b 4f 83 cf 06 47 ff 3b  |.....U.8+O...G.;|
-000002b0  6a 82 a6 06 ea 33 b4 11  87 45 1f 05 18 92 f2 4b  |j....3...E.....K|
-000002c0  63 0b 0a 3f 28 d1 c6 cb  72 49 fa 05 70 3e 4a a2  |c..?(...rI..p>J.|
-000002d0  08 ac 82 11 03 93 c8 e4  3b 6a d0 b7 9d 54 32 65  |........;j...T2e|
-000002e0  68 50 02 42 01 29 21 f0  09 de e7 68 f5 41 bd f7  |hP.B.)!....h.A..|
-000002f0  8c 84 fa 5c 36 78 9a 32  82 ab b4 2a ea d1 bd 22  |...\6x.2...*..."|
-00000300  5a df bf 7c 9c 80 ab ff  a1 0d 74 00 f1 72 ec f7  |Z..|......t..r..|
-00000310  29 c1 97 74 f2 d3 12 3f  1c a8 92 b5 db 7e 8e 32  |)..t...?.....~.2|
-00000320  46 0b 04 9f db a9 16 03  03 00 04 0e 00 00 00     |F..............|
+000002a0  00 ba df e4 f7 1e 3c 94  da d9 68 d8 aa 42 36 13  |......<...h..B6.|
+000002b0  c4 ff 16 a5 6a 95 ff f8  cf 78 e5 5d 82 9c 2a 5b  |....j....x.]..*[|
+000002c0  21 1c 20 0b 08 8f e2 bb  fa a4 a3 3a 99 3f ff 5d  |!. ........:.?.]|
+000002d0  4f 28 b4 a7 0a 2b eb 18  e7 f7 01 83 40 75 d4 2c  |O(...+......@u.,|
+000002e0  aa 5e 02 42 01 12 a3 ea  97 d9 2e f9 69 42 d2 5a  |.^.B........iB.Z|
+000002f0  83 aa fb 89 a0 a8 d3 3e  34 0b 65 1d 16 b3 dc fb  |.......>4.e.....|
+00000300  fa 1e 09 0d 8c 92 02 c1  07 55 49 0f 11 4b bc 97  |.........UI..K..|
+00000310  f9 c6 ff f3 7f 7c ec 51  f9 9a 25 e1 e7 f3 93 56  |.....|.Q..%....V|
+00000320  b6 c9 59 f5 a8 02 16 03  03 00 04 0e 00 00 00     |..Y............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 f9 72 2f 6f 2c  |....F...BA..r/o,|
-00000010  68 6e 03 f2 09 6c ad cc  94 72 f2 7f 40 86 e1 4d  |hn...l...r..@..M|
-00000020  6a 55 3d 22 fd 05 82 4a  15 83 47 08 73 bc 17 87  |jU="...J..G.s...|
-00000030  bf 85 b2 e1 eb a6 1b 0f  62 15 50 ef ab a1 3d 54  |........b.P...=T|
-00000040  10 36 ab ad 7a f7 df 05  d5 0d 5e 14 03 03 00 01  |.6..z.....^.....|
-00000050  01 16 03 03 00 40 8b 74  ea f4 d0 82 5e 0a be 38  |.....@.t....^..8|
-00000060  fa a0 e9 13 62 5e b4 b3  a0 f7 73 3b 92 8c 26 06  |....b^....s;..&.|
-00000070  0f 4b b5 88 24 01 70 78  9a 1c b0 03 db d6 29 c0  |.K..$.px......).|
-00000080  5a 06 f8 14 9c 7f 6e ba  74 31 8d b3 e0 cc a5 45  |Z.....n.t1.....E|
-00000090  6c 57 57 b5 67 3b                                 |lWW.g;|
+00000000  16 03 03 00 46 10 00 00  42 41 04 9d 5a 16 50 2d  |....F...BA..Z.P-|
+00000010  3e 2f 94 f9 c5 cb 3b ee  56 44 0b 06 ae ea b2 ff  |>/....;.VD......|
+00000020  ec cf 1d 9b 03 b3 d8 82  f5 9f 62 6f 13 2e 44 f0  |..........bo..D.|
+00000030  13 b4 e3 33 50 f0 07 40  04 66 68 47 eb be af 77  |...3P..@.fhG...w|
+00000040  8e 34 c9 29 f2 96 76 61  2c 08 e4 14 03 03 00 01  |.4.)..va,.......|
+00000050  01 16 03 03 00 40 2f c7  d4 8e a4 0d 38 ed 11 1f  |.....@/.....8...|
+00000060  5d 98 6b 84 a4 7e c5 c3  e4 5c 79 63 15 b1 c4 ff  |].k..~...\yc....|
+00000070  08 a7 c7 04 db d3 3f 89  ea bb 6c 9c 0f e7 9b dd  |......?...l.....|
+00000080  f5 15 e3 37 3c 8c 4d ec  62 7d 73 2c 2b 89 a3 68  |...7<.M.b}s,+..h|
+00000090  23 7a 6a 11 a9 87                                 |#zj...|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 d7 06 38 06 15  |.............8..|
-00000020  a7 2d 74 31 68 38 7b 8c  ad 40 2b 42 3f 22 9f 11  |.-t1h8{..@+B?"..|
-00000030  bf 10 8b b4 93 9b b7 04  f7 ab 55 78 91 2a f2 bf  |..........Ux.*..|
-00000040  1c 29 4d 83 0b 6b 07 40  30 00 33 17 03 03 00 40  |.)M..k.@0.3....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 71 1f 17 b1 37  |...........q...7|
+00000020  bc 77 6a 77 04 9f 5f f1  50 72 a3 c6 72 b4 85 05  |.wjw.._.Pr..r...|
+00000030  4e 15 8e 80 5c 14 ad 64  b8 bd 4f ee e8 bd 26 ff  |N...\..d..O...&.|
+00000040  d8 13 49 c7 e6 4c 52 da  4f 84 e1 17 03 03 00 40  |..I..LR.O......@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  f8 e2 39 82 00 ec 00 33  e5 77 00 82 c7 70 2d 4a  |..9....3.w...p-J|
-00000070  1a 43 b1 35 60 ef 80 ca  6a 38 ba 4f dc e8 b7 62  |.C.5`...j8.O...b|
-00000080  e6 a1 4a da de 65 31 0d  83 64 ba 2a 13 4d 04 46  |..J..e1..d.*.M.F|
+00000060  6a d3 f5 95 70 8f b0 c1  08 ad dc da 7f ed c5 d3  |j...p...........|
+00000070  f0 fb 48 fd 9f 3c 30 c8  67 38 3a 7e bc ea 3b 13  |..H..<0.g8:~..;.|
+00000080  d9 bc a8 96 1c 2c 55 76  d6 df 04 bf e0 e8 0b dc  |.....,Uv........|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 db 98 5d  f6 2d 69 d7 f3 ed 2b b1  |.......].-i...+.|
-000000b0  eb 04 66 ff cd 08 5d 29  bc 01 8d 66 9d b3 20 4a  |..f...])...f.. J|
-000000c0  11 2b f5 cc f5                                    |.+...|
+000000a0  00 00 00 00 00 90 29 fa  1c 7e f7 5a 1b 21 bf df  |......)..~.Z.!..|
+000000b0  dd d3 0e 12 b1 19 bb 17  35 f7 6a 0f 7a 08 91 4a  |........5.j.z..J|
+000000c0  2a 1e 46 68 da                                    |*.Fh.|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-IssueTicket b/src/crypto/tls/testdata/Server-TLSv12-IssueTicket
index 609c1c62cf..7000807563 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-IssueTicket
+++ b/src/crypto/tls/testdata/Server-TLSv12-IssueTicket
@@ -1,15 +1,15 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 5e 01 00 00  5a 03 03 68 17 74 7e d7  |....^...Z..h.t~.|
-00000010  a0 41 aa c8 3f 90 c7 3e  b2 e4 91 23 9f b2 86 bb  |.A..?..>...#....|
-00000020  95 6c b6 db c9 f4 f4 4a  6b ef 67 00 00 04 00 05  |.l.....Jk.g.....|
-00000030  00 ff 01 00 00 2d 00 23  00 00 00 0d 00 20 00 1e  |.....-.#..... ..|
+00000000  16 03 01 00 61 01 00 00  5d 03 03 7f 9d 96 78 84  |....a...].....x.|
+00000010  4f a7 cd c1 26 60 84 3f  d6 e6 06 ca 01 12 69 07  |O...&`.?......i.|
+00000020  cc cf 91 61 9a 7e 4c c7  e5 73 29 00 00 04 00 2f  |...a.~L..s)..../|
+00000030  00 ff 01 00 00 30 00 23  00 00 00 0d 00 20 00 1e  |.....0.#..... ..|
 00000040  06 01 06 02 06 03 05 01  05 02 05 03 04 01 04 02  |................|
-00000050  04 03 03 01 03 02 03 03  02 01 02 02 02 03 00 0f  |................|
-00000060  00 01 01                                          |...|
+00000050  04 03 03 01 03 02 03 03  02 01 02 02 02 03 00 16  |................|
+00000060  00 00 00 17 00 00                                 |......|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 35 02 00 00  31 03 03 00 00 00 00 00  |....5...1.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 05 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2f 00 00  |............./..|
 00000030  09 00 23 00 00 ff 01 00  01 00 16 03 03 02 59 0b  |..#...........Y.|
 00000040  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
 00000050  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
@@ -51,32 +51,39 @@
 00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 04 0e 00 00  |.\!.;...........|
 000002a0  00                                                |.|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 6d a2 f8 29 04  |...........m..).|
-00000010  65 50 e9 db 02 c9 c7 27  f9 4f fb 74 97 1a 1b cd  |eP.....'.O.t....|
-00000020  c7 fa 70 47 d4 d2 2d 24  28 c3 5c 00 69 48 5c ac  |..pG..-$(.\.iH\.|
-00000030  46 09 74 34 e1 88 d3 b0  11 2a 8c 6b 7a ba 13 21  |F.t4.....*.kz..!|
-00000040  c1 22 8d 02 3d a8 12 57  cb 10 10 98 1c 7e 87 42  |."..=..W.....~.B|
-00000050  69 b9 61 e6 ad 5f 45 c8  19 83 e2 36 a6 73 b0 71  |i.a.._E....6.s.q|
-00000060  f3 b2 68 90 0b 26 b9 12  40 70 f7 bf 9a fb 03 27  |..h..&..@p.....'|
-00000070  d2 84 a0 1b 4c 38 5f 3e  cc 86 10 a0 d1 74 75 77  |....L8_>.....tuw|
-00000080  6a c6 f9 98 f7 fa 31 d1  0a 80 39 14 03 03 00 01  |j.....1...9.....|
-00000090  01 16 03 03 00 24 18 94  26 51 b2 b1 ad a3 7c a1  |.....$..&Q....|.|
-000000a0  d2 8d 7e c8 40 4a 3e 77  ac a6 86 fc 30 f0 b6 9a  |..~.@J>w....0...|
-000000b0  c9 3a 7b 48 95 57 9d c0  f9 d8                    |.:{H.W....|
+00000000  16 03 03 00 86 10 00 00  82 00 80 48 95 70 68 ee  |...........H.ph.|
+00000010  93 9a 44 8c c7 53 48 06  13 2f fc f7 5f a2 84 53  |..D..SH../.._..S|
+00000020  0e 60 15 c2 2a d1 75 99  77 89 74 70 9b e9 96 95  |.`..*.u.w.tp....|
+00000030  82 0e 02 49 e6 f5 2e 79  b6 a9 42 63 89 de d6 f9  |...I...y..Bc....|
+00000040  77 d2 ed d2 8b ac 45 d3  10 14 92 4b 20 06 b8 7e  |w.....E....K ..~|
+00000050  91 9c 3b 71 25 75 d6 44  75 7b 2e 07 a0 d2 06 56  |..;q%u.Du{.....V|
+00000060  6f 39 c0 1e d6 3c b2 4b  ce 5d 51 ee 9a 1a 72 bd  |o9...<.K.]Q...r.|
+00000070  cf ba f3 db 09 92 7a cd  35 ec e9 5c 80 ab d3 b8  |......z.5..\....|
+00000080  13 51 75 a7 3a 5e 95 10  31 4c 4a 14 03 03 00 01  |.Qu.:^..1LJ.....|
+00000090  01 16 03 03 00 40 6a 2b  e6 c9 1a 30 dc 68 66 55  |.....@j+...0.hfU|
+000000a0  61 5e 78 15 5c 3f 1c c2  57 ae 98 62 2f fc 27 64  |a^x.\?..W..b/.'d|
+000000b0  fa a9 10 f7 6d 66 44 4b  50 89 b5 5f a6 7f 96 9b  |....mfDKP.._....|
+000000c0  07 8f ed f9 cf ea 27 c8  7f 1d 08 c9 68 17 0e 05  |......'.....h...|
+000000d0  73 90 0b 86 6d 9a                                 |s...m.|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 82 04 00 00  7e 00 00 00 00 00 78 50  |........~.....xP|
 00000010  46 ad c1 db a8 38 86 7b  2b bb fd d0 c3 42 3e 00  |F....8.{+....B>.|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000030  6f 2c b5 83 61 78 0b 52  39 31 36 f7 0c 5e 27 d3  |o,..ax.R916..^'.|
-00000040  76 9b c2 af 4e df 30 cb  1d c9 04 ee d2 02 31 f6  |v...N.0.......1.|
-00000050  33 bc 59 0d 24 61 3c 23  7a 92 ad 16 20 88 1c 5f  |3.Y.$a<#z... .._|
-00000060  20 32 38 fc 30 33 94 39  48 29 9e 70 41 ea 58 cd  | 28.03.9H).pA.X.|
-00000070  66 02 d9 b7 7c 71 1a ad  67 7f 87 a6 4e 3a b7 be  |f...|q..g...N:..|
-00000080  ff 59 39 58 bf 96 4d 14  03 03 00 01 01 16 03 03  |.Y9X..M.........|
-00000090  00 24 4f 0f f5 bb 09 37  7a 99 29 80 bf ed b5 f7  |.$O....7z.).....|
-000000a0  7e 27 00 11 05 df 79 67  24 4f 31 0c 69 dd fb 4c  |~'....yg$O1.i..L|
-000000b0  b4 a1 5d 13 2e 39 17 03  03 00 21 82 3d a3 7d d0  |..]..9....!.=.}.|
-000000c0  37 cb f8 84 0c 0a a1 1e  9e 80 d5 bd ab a2 b9 bd  |7...............|
-000000d0  8c 66 df 29 64 f4 ae 7c  52 a1 8c 9f 15 03 03 00  |.f.)d..|R.......|
-000000e0  16 e8 75 5e 4e 5b 72 15  01 42 38 a4 fb 61 86 cc  |..u^N[r..B8..a..|
-000000f0  85 65 96 fb 86 11 a7                              |.e.....|
+00000030  6f 2c 9f 83 61 ba 85 c2  4f 82 f7 76 6c 2f 9d 4c  |o,..a...O..vl/.L|
+00000040  16 0e 46 88 f4 1b 1b 35  62 9c c7 e6 0e 44 a4 62  |..F....5b....D.b|
+00000050  8c 1e 2d 53 f3 8b cd a6  ca dc 12 52 b4 43 a9 d0  |..-S.......R.C..|
+00000060  16 4c 9a f7 a6 33 94 f7  58 26 2b 75 74 62 e3 11  |.L...3..X&+utb..|
+00000070  dc f6 40 b0 ab 32 8b 79  63 d1 7e d8 9f db cf cf  |..@..2.yc.~.....|
+00000080  25 29 ea e9 89 43 39 14  03 03 00 01 01 16 03 03  |%)...C9.........|
+00000090  00 40 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |.@..............|
+000000a0  00 00 a7 14 ba 74 9a 16  b9 cf 08 ec c6 6e d2 fd  |.....t.......n..|
+000000b0  39 92 5d b0 2e 38 35 80  7b 94 fb e4 63 e0 01 0b  |9.]..85.{...c...|
+000000c0  40 a9 61 56 cc 31 44 7f  aa c7 91 03 46 55 6a c8  |@.aV.1D.....FUj.|
+000000d0  c0 d0 17 03 03 00 40 00  00 00 00 00 00 00 00 00  |......@.........|
+000000e0  00 00 00 00 00 00 00 e3  eb 91 1a 2d 03 f7 bf 29  |...........-...)|
+000000f0  64 93 36 4e a1 d0 12 86  63 bc 08 ca b1 98 b0 b9  |d.6N....c.......|
+00000100  d1 4d 65 42 92 68 34 db  bd 1b 2b f4 73 8f 84 0c  |.MeB.h4...+.s...|
+00000110  89 aa af b6 48 b5 5d 15  03 03 00 30 00 00 00 00  |....H.]....0....|
+00000120  00 00 00 00 00 00 00 00  00 00 00 00 92 00 e5 db  |................|
+00000130  4d d0 77 51 0d 26 de 48  9b 4f cd 33 9b 33 ca fd  |M.wQ.&.H.O.3.3..|
+00000140  e2 d3 ff 0d 7f db 9e 0f  3e a8 50 94              |........>.P.|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable b/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable
index 499d5ca8c0..e0bf62551c 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable
+++ b/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable
@@ -1,15 +1,15 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 5e 01 00 00  5a 03 03 a5 0c f2 61 e9  |....^...Z.....a.|
-00000010  c0 64 8d 4c db 92 af ed  77 26 93 bb fc 02 1a ae  |.d.L....w&......|
-00000020  fd 8c 45 ca 78 65 9c ab  57 1d 59 00 00 04 00 05  |..E.xe..W.Y.....|
-00000030  00 ff 01 00 00 2d 00 23  00 00 00 0d 00 20 00 1e  |.....-.#..... ..|
+00000000  16 03 01 00 61 01 00 00  5d 03 03 10 94 97 3f c0  |....a...].....?.|
+00000010  47 0f c3 66 65 4e 8b 1b  cc be b4 39 0f 8f d7 52  |G..feN.....9...R|
+00000020  88 e6 60 2c 2f 22 95 5b  08 e2 4a 00 00 04 00 2f  |..`,/".[..J..../|
+00000030  00 ff 01 00 00 30 00 23  00 00 00 0d 00 20 00 1e  |.....0.#..... ..|
 00000040  06 01 06 02 06 03 05 01  05 02 05 03 04 01 04 02  |................|
-00000050  04 03 03 01 03 02 03 03  02 01 02 02 02 03 00 0f  |................|
-00000060  00 01 01                                          |...|
+00000050  04 03 03 01 03 02 03 03  02 01 02 02 02 03 00 16  |................|
+00000060  00 00 00 17 00 00                                 |......|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 35 02 00 00  31 03 03 00 00 00 00 00  |....5...1.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 05 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2f 00 00  |............./..|
 00000030  09 00 23 00 00 ff 01 00  01 00 16 03 03 02 59 0b  |..#...........Y.|
 00000040  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
 00000050  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
@@ -51,32 +51,39 @@
 00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 04 0e 00 00  |.\!.;...........|
 000002a0  00                                                |.|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 a1 93 c8 d1 c3  |................|
-00000010  f4 30 f0 d2 dd f3 2c 2a  d6 13 34 64 85 21 86 f9  |.0....,*..4d.!..|
-00000020  5a 56 92 9b c1 05 f4 50  f6 59 2d 56 58 70 1c 44  |ZV.....P.Y-VXp.D|
-00000030  ba 00 43 25 3c f4 35 1a  e3 38 6a 60 98 a9 82 1b  |..C%<.5..8j`....|
-00000040  21 86 03 c4 83 04 33 f6  bb 6c 30 6b a7 43 47 94  |!.....3..l0k.CG.|
-00000050  c6 c6 7c 61 c0 2e 0b 21  8e b2 22 43 18 ea 89 20  |..|a...!.."C... |
-00000060  85 41 b6 c1 26 3e 98 cc  e4 7a 1e 1a de 55 c2 e8  |.A..&>...z...U..|
-00000070  b1 a9 5c f0 40 ed 52 b3  ec 78 e3 23 4e f9 9f 04  |..\.@.R..x.#N...|
-00000080  d5 b6 bd 57 8f 67 ca 4c  ce 68 9c 14 03 03 00 01  |...W.g.L.h......|
-00000090  01 16 03 03 00 24 6a 84  b2 9a 4d bd 5e 7b 2b 4d  |.....$j...M.^{+M|
-000000a0  60 99 bd f7 9d da 70 5c  27 a0 d4 a6 98 bd ee 16  |`.....p\'.......|
-000000b0  b7 a5 47 3f fd ab 6d 8f  53 5e                    |..G?..m.S^|
+00000000  16 03 03 00 86 10 00 00  82 00 80 b5 e3 31 fc c3  |.............1..|
+00000010  22 4a 86 6d 04 2c 69 31  36 0f 74 72 58 3e a2 4e  |"J.m.,i16.trX>.N|
+00000020  f4 d0 6f 78 ea d7 92 04  4a 93 e1 50 dd 30 f7 b6  |..ox....J..P.0..|
+00000030  6f 15 de 51 83 07 3b 93  60 ee 43 f2 41 0f 24 e5  |o..Q..;.`.C.A.$.|
+00000040  50 79 62 f8 85 09 86 13  a3 25 3e e4 6c 6b fa 0f  |Pyb......%>.lk..|
+00000050  7d d9 f4 99 49 1d 67 12  77 06 9a 0c e7 bb 7c 82  |}...I.g.w.....|.|
+00000060  2f 74 fb f9 c7 93 89 0b  3e 5a a2 12 0a 91 23 6d  |/t......>Z....#m|
+00000070  7e 51 ee b8 14 c8 b2 d9  19 7b fc 70 5a ba 2e 6e  |~Q.......{.pZ..n|
+00000080  a2 98 64 31 7a af c0 17  52 fd e3 14 03 03 00 01  |..d1z...R.......|
+00000090  01 16 03 03 00 40 ef d5  01 2f c7 2c db 45 cf 6f  |.....@.../.,.E.o|
+000000a0  9e af 3b ec ea 49 7f bf  bf 30 29 6a 0c 36 3e da  |..;..I...0)j.6>.|
+000000b0  9f 94 ef d2 85 41 9d b1  9f 69 9b 1a 24 be e6 d1  |.....A...i..$...|
+000000c0  c6 56 0e c9 89 6c 51 5d  9a 5c c7 ec e9 eb 84 c5  |.V...lQ].\......|
+000000d0  fd ab 12 5e 47 f5                                 |...^G.|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 82 04 00 00  7e 00 00 00 00 00 78 50  |........~.....xP|
 00000010  46 ad c1 db a8 38 86 7b  2b bb fd d0 c3 42 3e 00  |F....8.{+....B>.|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000030  6f 2c b5 83 61 a0 6c 9b  3d 82 88 87 9d 31 0d 89  |o,..a.l.=....1..|
-00000040  7c cc 1c bf e6 02 1c 08  6d 29 4a 85 17 dd 2f 46  ||.......m)J.../F|
-00000050  c9 87 a7 d9 23 5f e4 3d  72 22 85 63 b7 03 7e a8  |....#_.=r".c..~.|
-00000060  2b f4 a6 62 65 33 94 df  7b 0e fa 5a 0d d3 b3 be  |+..be3..{..Z....|
-00000070  2a b0 fb c1 46 7e dd 4b  59 39 fc 1a 4f 4c c4 f3  |*...F~.KY9..OL..|
-00000080  ec f0 73 b3 11 8e 1b 14  03 03 00 01 01 16 03 03  |..s.............|
-00000090  00 24 9e ba e0 21 81 b9  68 20 70 44 51 22 e2 12  |.$...!..h pDQ"..|
-000000a0  49 79 fa c0 47 b0 2f f5  db 2f 12 fb b2 f8 f5 e5  |Iy..G./../......|
-000000b0  22 66 15 77 36 f0 17 03  03 00 21 5a 02 14 69 5d  |"f.w6.....!Z..i]|
-000000c0  3b 52 e9 a6 70 80 8f 7c  bf 52 70 cc 04 59 6c ef  |;R..p..|.Rp..Yl.|
-000000d0  0f ea a5 ed 1b 7b 76 99  b0 e5 13 aa 15 03 03 00  |.....{v.........|
-000000e0  16 d1 d4 85 b4 80 a1 d5  08 a5 bf 4d ae cf 88 a8  |...........M....|
-000000f0  63 7f 03 65 f7 f4 cf                              |c..e...|
+00000030  6f 2c 9f 83 61 67 87 d5  79 1d 56 b8 ca 6d e2 b0  |o,..ag..y.V..m..|
+00000040  2e a7 2e c9 d7 b3 5a de  91 3b 6f 30 a7 14 af d1  |......Z..;o0....|
+00000050  b4 af 5b 9e a0 65 e6 fe  cd d3 77 f3 88 c6 cf 52  |..[..e....w....R|
+00000060  74 28 4b a2 14 33 94 9a  e0 60 f2 0b df c5 58 4b  |t(K..3...`....XK|
+00000070  56 46 52 6a 3a 83 15 89  c6 a9 31 83 83 ef 29 2a  |VFRj:.....1...)*|
+00000080  9f c6 5f ba 8d 91 de 14  03 03 00 01 01 16 03 03  |.._.............|
+00000090  00 40 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |.@..............|
+000000a0  00 00 86 9a 2e f8 cb 67  ef 2b 40 e7 4c 80 b7 ae  |.......g.+@.L...|
+000000b0  da 1c 94 94 48 ec 21 80  b5 04 de fe a5 ee e0 a5  |....H.!.........|
+000000c0  54 71 54 60 9a c8 01 56  16 43 27 49 a0 01 7a e0  |TqT`...V.C'I..z.|
+000000d0  d5 af 17 03 03 00 40 00  00 00 00 00 00 00 00 00  |......@.........|
+000000e0  00 00 00 00 00 00 00 71  88 56 13 c2 a6 d6 5b 95  |.......q.V....[.|
+000000f0  31 c6 39 30 47 f8 cf 03  07 51 4d 25 4f 7c f2 e2  |1.90G....QM%O|..|
+00000100  d5 94 02 8b 23 05 93 8c  23 ab 11 ca d8 30 27 37  |....#...#....0'7|
+00000110  0e 66 57 9c aa 01 d9 15  03 03 00 30 00 00 00 00  |.fW........0....|
+00000120  00 00 00 00 00 00 00 00  00 00 00 00 8d a5 38 52  |..............8R|
+00000130  5b 93 4a 59 72 8d ee d4  dd 9c e7 a1 5d 88 aa a0  |[.JYr.......]...|
+00000140  d0 35 ff 31 50 c7 4b ee  96 51 26 35              |.5.1P.K..Q&5|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-3DES b/src/crypto/tls/testdata/Server-TLSv12-RSA-3DES
index 1ef2aa6a95..254628b304 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-3DES
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-3DES
@@ -1,10 +1,11 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 5a 01 00 00  56 03 03 c0 03 fd f4 b3  |....Z...V.......|
-00000010  a9 b9 1d fe 9f df 49 bd  45 f2 c1 a4 66 fd 9f f3  |......I.E...f...|
-00000020  21 cb 3a 17 42 4f 3b 6f  e2 9b 3a 00 00 04 00 0a  |!.:.BO;o..:.....|
-00000030  00 ff 01 00 00 29 00 0d  00 20 00 1e 06 01 06 02  |.....)... ......|
+00000000  16 03 01 00 5d 01 00 00  59 03 03 18 ce 7a 5d c3  |....]...Y....z].|
+00000010  89 32 dc b4 3e 0c f7 7c  32 8f 30 05 a4 2d c2 97  |.2..>..|2.0..-..|
+00000020  ca d2 97 3b af 9b 1f 66  5e 13 67 00 00 04 00 0a  |...;...f^.g.....|
+00000030  00 ff 01 00 00 2c 00 0d  00 20 00 1e 06 01 06 02  |.....,... ......|
 00000040  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
-00000050  03 02 03 03 02 01 02 02  02 03 00 0f 00 01 01     |...............|
+00000050  03 02 03 03 02 01 02 02  02 03 00 16 00 00 00 17  |................|
+00000060  00 00                                             |..|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 31 02 00 00  2d 03 03 00 00 00 00 00  |....1...-.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -49,27 +50,27 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 1e 99 6c a1 43  |.............l.C|
-00000010  4c 3e ab 8b 71 72 71 10  a3 e5 4e 58 77 fa 2e 1a  |L>..qrq...NXw...|
-00000020  33 62 1b 0e eb 71 00 58  b0 90 76 b0 5f 29 39 35  |3b...q.X..v._)95|
-00000030  2b f6 27 f4 fb 0e 58 6d  1d 78 c8 d4 bc 2c 7b e7  |+.'...Xm.x...,{.|
-00000040  a9 8f 00 97 f1 bc a9 9f  03 0c 4a 48 a5 c5 f8 02  |..........JH....|
-00000050  db 60 80 f0 b7 5a 72 e6  8f 73 9a 13 2b 9a 37 85  |.`...Zr..s..+.7.|
-00000060  71 8b 50 4c 91 f6 ba 59  be f5 4a c9 ea a0 9c 74  |q.PL...Y..J....t|
-00000070  0d 54 7a 24 a2 4c 15 68  ef f8 31 86 63 99 46 69  |.Tz$.L.h..1.c.Fi|
-00000080  fb 7f fd 2b 2a 54 8d d1  ea d9 bf 14 03 03 00 01  |...+*T..........|
-00000090  01 16 03 03 00 30 3e 6f  87 3e c5 d5 af 1c 93 b9  |.....0>o.>......|
-000000a0  8b 5e 2c e7 fa 10 59 d2  26 61 84 ce a2 2b ee bd  |.^,...Y.&a...+..|
-000000b0  fb 64 7a 79 54 24 3b 3f  dc ff 6a 60 d2 be 7e 50  |.dzyT$;?..j`..~P|
-000000c0  df 64 5a bd a2 e9                                 |.dZ...|
+00000000  16 03 03 00 86 10 00 00  82 00 80 1b e1 54 3c 9d  |.............T<.|
+00000010  39 01 71 91 ff fc 49 57  2f a9 56 88 69 59 da 18  |9.q...IW/.V.iY..|
+00000020  1a d7 7e 2c 61 cd b3 b6  69 db 15 2b be 67 1d d4  |..~,a...i..+.g..|
+00000030  a4 07 78 f4 83 76 5b 70  f8 f1 ca bb 90 bf a1 b5  |..x..v[p........|
+00000040  f7 03 28 d3 27 e2 70 e6  8d 31 f4 81 90 04 da 3b  |..(.'.p..1.....;|
+00000050  1a 61 be 1d fb 58 40 66  ed 74 ab 3e d8 67 37 e9  |.a...X@f.t.>.g7.|
+00000060  e5 88 ba 8f 8a 48 a4 28  78 80 32 5a 1e d0 6e ad  |.....H.(x.2Z..n.|
+00000070  09 cb d0 6e cd c4 0f d1  6e 02 0f 1e 25 44 dc d7  |...n....n...%D..|
+00000080  d9 5f 9b 60 05 f4 7d e1  23 f6 5c 14 03 03 00 01  |._.`..}.#.\.....|
+00000090  01 16 03 03 00 30 97 db  a5 d7 55 8b e0 37 e1 46  |.....0....U..7.F|
+000000a0  b5 18 c6 c8 5b 9b 43 43  65 8e fe 9d eb b1 a4 61  |....[.CCe......a|
+000000b0  96 e1 7e 0a 60 96 34 6f  5a b4 7f dd fe 14 7b a6  |..~.`.4oZ.....{.|
+000000c0  3c b8 c2 09 fb 9c                                 |<.....|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 30 00 00 00 00 00  |..........0.....|
-00000010  00 00 00 29 da ba 81 d7  c5 8c d3 25 ff 81 cb a8  |...).......%....|
-00000020  16 ca 52 f6 3b 7c dd 85  d3 81 d8 29 7e 77 2e 78  |..R.;|.....)~w.x|
-00000030  c1 f0 e6 75 dc 4a 4e df  61 f5 bd 17 03 03 00 30  |...u.JN.a......0|
-00000040  00 00 00 00 00 00 00 00  97 6f 3d 71 1c b4 55 93  |.........o=q..U.|
-00000050  34 02 79 a5 a5 07 5b 7b  af b7 c5 f8 18 91 c0 3d  |4.y...[{.......=|
-00000060  4d d9 f8 aa 6a 15 19 19  90 82 2c 9e 78 76 a7 c2  |M...j.....,.xv..|
-00000070  15 03 03 00 20 00 00 00  00 00 00 00 00 42 e4 3d  |.... ........B.=|
-00000080  84 ca fd 0f 38 61 02 9a  c8 aa 2f 07 d6 98 c7 74  |....8a..../....t|
-00000090  dd b9 2b 08 1e                                    |..+..|
+00000010  00 00 00 c3 99 75 8d 3c  51 97 9a e6 f0 dd d8 93  |.....u.<Q.......|
+00000020  ba e2 10 1f 16 2d 55 65  e2 e5 21 2c e0 54 c0 d2  |.....-Ue..!,.T..|
+00000030  95 75 8b d0 c8 32 30 6c  4b ab 57 17 03 03 00 30  |.u...20lK.W....0|
+00000040  00 00 00 00 00 00 00 00  b6 4a aa 2c 1f 71 39 35  |.........J.,.q95|
+00000050  d2 9e 3d 72 74 68 17 d0  cd 0f 8e f7 13 32 76 ea  |..=rth.......2v.|
+00000060  3c 01 3c 7b 6e 0a e0 1f  b2 f3 83 7c 13 11 cb cf  |<.<{n......|....|
+00000070  15 03 03 00 20 00 00 00  00 00 00 00 00 23 22 40  |.... ........#"@|
+00000080  d5 a1 87 5a 57 da e3 d0  6d d0 e1 d5 48 00 75 10  |...ZW...m...H.u.|
+00000090  a0 c1 cf 98 82                                    |.....|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES
index 0276aeff89..5b4788cf7b 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES
@@ -1,10 +1,11 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 5a 01 00 00  56 03 03 9c 67 a7 12 b5  |....Z...V...g...|
-00000010  cf 32 f8 50 7c af cd 3f  b1 e1 cc cb 94 65 91 d2  |.2.P|..?.....e..|
-00000020  f3 6a 22 f9 00 4c 58 ad  40 59 6b 00 00 04 00 2f  |.j"..LX.@Yk..../|
-00000030  00 ff 01 00 00 29 00 0d  00 20 00 1e 06 01 06 02  |.....)... ......|
+00000000  16 03 01 00 5d 01 00 00  59 03 03 eb b8 69 bb 4f  |....]...Y....i.O|
+00000010  6e 80 93 7e eb ad d2 54  28 45 af c2 46 3d b5 2c  |n..~...T(E..F=.,|
+00000020  3f 31 14 d5 23 da d8 a9  e8 c4 6f 00 00 04 00 2f  |?1..#.....o..../|
+00000030  00 ff 01 00 00 2c 00 0d  00 20 00 1e 06 01 06 02  |.....,... ......|
 00000040  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
-00000050  03 02 03 03 02 01 02 02  02 03 00 0f 00 01 01     |...............|
+00000050  03 02 03 03 02 01 02 02  02 03 00 16 00 00 00 17  |................|
+00000060  00 00                                             |..|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 31 02 00 00  2d 03 03 00 00 00 00 00  |....1...-.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -49,31 +50,31 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 57 92 53 a8 b1  |...........W.S..|
-00000010  ef eb 17 f1 ec 05 e0 fa  30 2f 1f b5 e1 a2 dd d1  |........0/......|
-00000020  3d 61 84 d5 bf 2d 74 03  f0 86 f1 31 5f a3 1e 90  |=a...-t....1_...|
-00000030  98 ec 5b c1 01 c0 51 0b  31 90 8f 96 75 00 ba c6  |..[...Q.1...u...|
-00000040  e7 5a fd 79 5c eb 39 3d  2f 9b d8 24 2a 38 2f 53  |.Z.y\.9=/..$*8/S|
-00000050  fd bc 10 60 bf 21 2a 9e  de 90 07 95 ca c2 e2 1d  |...`.!*.........|
-00000060  08 f1 7a db 22 05 47 9e  12 ae 25 49 9e c1 79 a0  |..z.".G...%I..y.|
-00000070  99 15 89 5d 66 e0 dc df  3d e7 9e 16 26 0a 7f 33  |...]f...=...&..3|
-00000080  3d 26 09 f6 26 c1 ce f2  22 cc 24 14 03 03 00 01  |=&..&...".$.....|
-00000090  01 16 03 03 00 40 d6 e1  cf 32 2a 55 ca 4b 8f 0c  |.....@...2*U.K..|
-000000a0  b1 bd a4 b6 72 d0 66 fc  1d ef af c4 44 29 db f5  |....r.f.....D)..|
-000000b0  04 1d bc 9d 89 ba 87 b9  60 3e 75 cf 24 d6 65 9a  |........`>u.$.e.|
-000000c0  92 99 e2 7c 48 89 ea 3b  a7 c1 77 e1 b4 2e 32 70  |...|H..;..w...2p|
-000000d0  ef 48 09 b5 21 fb                                 |.H..!.|
+00000000  16 03 03 00 86 10 00 00  82 00 80 8f 7d 6e f4 65  |............}n.e|
+00000010  ae d4 3c 5b 21 c5 d4 f2  b8 31 94 2e bb 50 b5 33  |..<[!....1...P.3|
+00000020  0c c4 51 89 8a c2 34 0d  11 e4 78 6c f0 00 76 4b  |..Q...4...xl..vK|
+00000030  77 db 01 a7 2e 35 65 c7  83 78 85 92 57 c7 eb c9  |w....5e..x..W...|
+00000040  cb ec 86 72 59 db cd 29  3b a5 8e d4 d1 67 15 f3  |...rY..);....g..|
+00000050  e8 90 68 65 81 66 6e 65  7b d2 29 a5 76 26 d9 81  |..he.fne{.).v&..|
+00000060  08 3b 62 13 86 25 a8 a1  67 7f a3 e3 f2 e9 2c b7  |.;b..%..g.....,.|
+00000070  cd 93 20 25 fc aa cc 9c  09 43 7f be f1 70 b6 54  |.. %.....C...p.T|
+00000080  69 cb 56 d8 dc 03 b7 57  a0 24 4d 14 03 03 00 01  |i.V....W.$M.....|
+00000090  01 16 03 03 00 40 72 e6  0e 90 53 91 e4 ce fa 93  |.....@r...S.....|
+000000a0  78 30 20 8f 6c 20 4d d0  08 4d da 62 87 f3 9f f3  |x0 .l M..M.b....|
+000000b0  e1 77 7a e5 7c e9 47 a0  85 c3 3a 35 59 b5 9b 2f  |.wz.|.G...:5Y../|
+000000c0  6b f1 75 38 89 5f aa ac  e1 c5 b0 e6 52 b5 f4 12  |k.u8._......R...|
+000000d0  ca 9d 39 82 c2 dc                                 |..9...|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 9c 22 a2 de 7d  |............"..}|
-00000020  53 e3 38 a8 b9 f5 75 9e  11 6e 0c 23 a0 c6 d1 98  |S.8...u..n.#....|
-00000030  ea 28 4e 9f ae b4 d0 66  74 b7 53 07 95 a0 31 5b  |.(N....ft.S...1[|
-00000040  be d4 c8 c5 7c 59 5e 4d  f8 e0 fc 17 03 03 00 40  |....|Y^M.......@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 e9 de 46 69 c7  |.............Fi.|
+00000020  6f cc f7 15 4a bd cc a9  c6 50 ae c8 7d 92 d1 ae  |o...J....P..}...|
+00000030  f6 05 0b c6 93 25 d5 e8  b7 a4 8e e9 78 08 5d ba  |.....%......x.].|
+00000040  4e 6f b9 64 56 85 0c 0c  8e 25 67 17 03 03 00 40  |No.dV....%g....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  eb cf 0b ba dd 31 3a db  db d6 13 26 a6 41 c4 48  |.....1:....&.A.H|
-00000070  d0 ea 2a 85 f2 07 07 91  b5 d0 80 73 2b 6d 8d 12  |..*........s+m..|
-00000080  a0 7d 03 66 1c 12 27 76  d0 bb 5f dd 5b 3b b2 0d  |.}.f..'v.._.[;..|
+00000060  3f a8 60 c9 b8 cc 5a 16  8b b0 a8 05 09 ae dc d8  |?.`...Z.........|
+00000070  f3 8e 84 39 58 46 64 72  8d 17 48 45 91 08 95 d6  |...9XFdr..HE....|
+00000080  e2 e3 24 27 bb 93 e1 02  f1 04 bd 38 c5 b8 04 47  |..$'.......8...G|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 77 ab 76  a5 b4 12 89 cd d6 a5 6b  |.....w.v.......k|
-000000b0  be 41 9e 98 d2 d7 61 c8  c1 ff a7 a0 92 18 bb 77  |.A....a........w|
-000000c0  dd e6 ba fc 09                                    |.....|
+000000a0  00 00 00 00 00 4b 1d 43  0c 1c e8 f1 e9 bc 23 be  |.....K.C......#.|
+000000b0  10 c7 53 d5 ae d1 b0 db  bb 2c a5 0b be 77 cf 49  |..S......,...w.I|
+000000c0  1c 3f fd 9b 6c                                    |.?..l|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM
index d9bd2cb932..9c36eea880 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM
@@ -1,13 +1,12 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 82 01 00 00  7e 03 03 d2 bd 41 26 ce  |........~....A&.|
-00000010  2b de 55 26 0a 97 7b ed  d6 30 7a d8 5e 0c 7f ec  |+.U&..{..0z.^...|
-00000020  8c 2d 3d e7 7c 1c dc c6  7f df 36 00 00 04 c0 2f  |.-=.|.....6..../|
-00000030  00 ff 01 00 00 51 00 0b  00 04 03 00 01 02 00 0a  |.....Q..........|
-00000040  00 1c 00 1a 00 17 00 19  00 1c 00 1b 00 18 00 1a  |................|
-00000050  00 16 00 0e 00 0d 00 0b  00 0c 00 09 00 0a 00 0d  |................|
-00000060  00 20 00 1e 06 01 06 02  06 03 05 01 05 02 05 03  |. ..............|
-00000070  04 01 04 02 04 03 03 01  03 02 03 03 02 01 02 02  |................|
-00000080  02 03 00 0f 00 01 01                              |.......|
+00000000  16 03 01 00 73 01 00 00  6f 03 03 0e 36 4c 20 d7  |....s...o...6L .|
+00000010  e1 fb 69 a3 91 ed 02 d5  91 44 de fa ab 04 51 21  |..i......D....Q!|
+00000020  92 10 05 30 38 c6 7a f2  e9 2d 9a 00 00 04 c0 2f  |...08.z..-...../|
+00000030  00 ff 01 00 00 42 00 0b  00 04 03 00 01 02 00 0a  |.....B..........|
+00000040  00 0a 00 08 00 1d 00 17  00 19 00 18 00 0d 00 20  |............... |
+00000050  00 1e 06 01 06 02 06 03  05 01 05 02 05 03 04 01  |................|
+00000060  04 02 04 03 03 01 03 02  03 03 02 01 02 02 02 03  |................|
+00000070  00 16 00 00 00 17 00 00                           |........|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 31 02 00 00  2d 03 03 00 00 00 00 00  |....1...-.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -55,30 +54,30 @@
 000002b0  5b 12 2e 8f 09 67 fd a7  24 20 3e b2 56 1c ce 97  |[....g..$ >.V...|
 000002c0  28 5e f8 2b 2d 4f 9e f1  07 9f 6c 4b 5b 83 56 e2  |(^.+-O....lK[.V.|
 000002d0  32 42 e9 58 b6 d7 49 a6  b5 68 1a 41 03 56 6b dc  |2B.X..I..h.A.Vk.|
-000002e0  5a 89 05 01 00 80 6b bd  38 b4 63 7e c8 df a4 31  |Z.....k.8.c~...1|
-000002f0  2d 1f ab cf b6 c2 f7 f4  bd eb 1c b4 b4 21 58 d8  |-............!X.|
-00000300  cd 94 f7 78 a2 40 8f 77  d2 e3 55 94 c6 c0 8a 4c  |...x.@.w..U....L|
-00000310  3a 96 92 6d 78 96 73 73  d8 b4 5c 55 2a 21 53 a5  |:..mx.ss..\U*!S.|
-00000320  f6 1e 94 5d 43 64 b6 12  6a 8a 1b 62 6b fe 59 c8  |...]Cd..j..bk.Y.|
-00000330  63 45 38 4b 6c 56 91 b1  b6 77 a4 fc c4 be ce ba  |cE8KlV...w......|
-00000340  b1 20 6d ea 01 32 5a 8e  20 fd b0 77 f7 e0 bf e5  |. m..2Z. ..w....|
-00000350  54 3c dc 77 39 a3 05 e7  9a ee 5a 7a 1a 9a 91 83  |T<.w9.....Zz....|
-00000360  07 88 26 ee d9 66 16 03  03 00 04 0e 00 00 00     |..&..f.........|
+000002e0  5a 89 05 01 00 80 62 7c  f0 82 f2 5c 25 2d 56 de  |Z.....b|...\%-V.|
+000002f0  80 98 83 3e df e0 d0 2a  f6 cf 4a 63 ad 3a e2 bb  |...>...*..Jc.:..|
+00000300  e0 31 e3 91 1f a7 14 07  fc c7 4a c4 7d 64 96 49  |.1........J.}d.I|
+00000310  a3 a5 9e 96 16 78 db 5b  16 d8 f2 30 e3 2b 75 07  |.....x.[...0.+u.|
+00000320  f5 18 58 90 08 46 5f 3d  5c 56 50 3c e0 4d 96 c6  |..X..F_=\VP<.M..|
+00000330  2b 71 bd 4f 52 28 b0 56  fe b2 a8 35 1e d0 9c 33  |+q.OR(.V...5...3|
+00000340  73 d7 92 e8 88 ea fb 97  64 a0 15 0f d0 c5 8b 18  |s.......d.......|
+00000350  af 3f cf 41 83 e1 fe 7f  d4 83 aa be 6c b6 c7 e9  |.?.A........l...|
+00000360  d4 aa 11 8c 64 96 16 03  03 00 04 0e 00 00 00     |....d..........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 af a3 47 39 cf  |....F...BA...G9.|
-00000010  d8 97 a1 49 f5 93 cf ad  7c f3 01 9a 5b 82 bf b5  |...I....|...[...|
-00000020  ea 9c 31 ba 0a 57 03 45  39 c2 8b 09 79 91 ec 79  |..1..W.E9...y..y|
-00000030  07 73 07 bb 9a dc e2 be  1b 2f 39 17 3b d4 eb d2  |.s......./9.;...|
-00000040  39 75 b4 75 6b eb 60 41  06 ee 24 14 03 03 00 01  |9u.uk.`A..$.....|
-00000050  01 16 03 03 00 28 cb 10  d1 50 a3 cc 0b f9 01 32  |.....(...P.....2|
-00000060  5e 93 05 58 51 77 29 f2  23 7b c7 cd 0e af 82 a3  |^..XQw).#{......|
-00000070  68 57 9d 36 cf 6f 90 21  9e 6c 33 1d a2 08        |hW.6.o.!.l3...|
+00000000  16 03 03 00 46 10 00 00  42 41 04 00 47 70 8d f0  |....F...BA..Gp..|
+00000010  14 23 bf e2 e7 68 56 b1  d1 d6 70 ba a1 bd 32 c2  |.#...hV...p...2.|
+00000020  b9 ee ac 66 f8 0a c3 20  62 56 ad 14 a4 b4 ac 4b  |...f... bV.....K|
+00000030  31 9e 94 28 91 34 2c c5  d4 7a f7 a6 d4 e5 bc 29  |1..(.4,..z.....)|
+00000040  b4 d0 c6 e2 ec 91 9d e5  b7 56 60 14 03 03 00 01  |.........V`.....|
+00000050  01 16 03 03 00 28 61 b4  6a ce 74 23 40 fa b6 15  |.....(a.j.t#@...|
+00000060  43 ba db f0 54 44 c6 d1  ae c7 56 a2 12 54 43 85  |C...TD....V..TC.|
+00000070  f9 8d a2 fc 8c 30 54 6b  c4 73 3b 60 bf da        |.....0Tk.s;`..|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 28 00 00 00 00 00  |..........(.....|
-00000010  00 00 00 d7 6c 94 30 2c  b6 6c b2 2d 53 75 63 e2  |....l.0,.l.-Suc.|
-00000020  c8 a3 dc 95 08 6a 0c d3  ce 8d dd c0 c1 ce a8 b8  |.....j..........|
-00000030  88 78 05 17 03 03 00 25  00 00 00 00 00 00 00 01  |.x.....%........|
-00000040  81 98 a0 e9 75 84 ba f2  22 46 f4 7d 0e b4 0f de  |....u..."F.}....|
-00000050  3e bd 15 68 ae 6e fb 99  04 eb 25 ae db 15 03 03  |>..h.n....%.....|
-00000060  00 1a 00 00 00 00 00 00  00 02 da 7a 97 4b 10 ff  |...........z.K..|
-00000070  20 aa 91 58 5e e1 0e 6a  dd 27 3d 32              | ..X^..j.'=2|
+00000010  00 00 00 6f 28 3d 5b 9b  82 06 4b 3b d9 3a cc 5f  |...o(=[...K;.:._|
+00000020  8f cb a4 4d 83 e5 29 1d  fe f6 e2 21 4d 55 5d 8c  |...M..)....!MU].|
+00000030  a5 7b d1 17 03 03 00 25  00 00 00 00 00 00 00 01  |.{.....%........|
+00000040  e1 56 f0 28 e2 8f 74 61  91 a5 f0 62 06 b0 a7 d3  |.V.(..ta...b....|
+00000050  4e 86 1a 13 f0 cb 21 35  52 8e 86 08 99 15 03 03  |N.....!5R.......|
+00000060  00 1a 00 00 00 00 00 00  00 02 6b 2b aa ff 88 97  |..........k+....|
+00000070  56 29 3a fd 60 09 61 90  71 c8 0b ab              |V):.`.a.q...|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES256-GCM-SHA384 b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES256-GCM-SHA384
index 750895c6f3..1b5e5dc273 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES256-GCM-SHA384
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES256-GCM-SHA384
@@ -1,13 +1,12 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 82 01 00 00  7e 03 03 86 63 9f f8 e0  |........~...c...|
-00000010  c7 16 a1 d9 39 a7 fd 3d  b1 23 ff 2b 67 b7 ab b0  |....9..=.#.+g...|
-00000020  18 cd c3 c6 c8 c5 46 10  50 df 15 00 00 04 c0 30  |......F.P......0|
-00000030  00 ff 01 00 00 51 00 0b  00 04 03 00 01 02 00 0a  |.....Q..........|
-00000040  00 1c 00 1a 00 17 00 19  00 1c 00 1b 00 18 00 1a  |................|
-00000050  00 16 00 0e 00 0d 00 0b  00 0c 00 09 00 0a 00 0d  |................|
-00000060  00 20 00 1e 06 01 06 02  06 03 05 01 05 02 05 03  |. ..............|
-00000070  04 01 04 02 04 03 03 01  03 02 03 03 02 01 02 02  |................|
-00000080  02 03 00 0f 00 01 01                              |.......|
+00000000  16 03 01 00 73 01 00 00  6f 03 03 71 08 6a 82 51  |....s...o..q.j.Q|
+00000010  f9 01 7b f6 24 f8 33 62  3f 4e 35 51 9d 5c 7a 8d  |..{.$.3b?N5Q.\z.|
+00000020  10 81 c3 cd 6a b5 1c cd  a2 4b 2a 00 00 04 c0 30  |....j....K*....0|
+00000030  00 ff 01 00 00 42 00 0b  00 04 03 00 01 02 00 0a  |.....B..........|
+00000040  00 0a 00 08 00 1d 00 17  00 19 00 18 00 0d 00 20  |............... |
+00000050  00 1e 06 01 06 02 06 03  05 01 05 02 05 03 04 01  |................|
+00000060  04 02 04 03 03 01 03 02  03 03 02 01 02 02 02 03  |................|
+00000070  00 16 00 00 00 17 00 00                           |........|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 31 02 00 00  2d 03 03 00 00 00 00 00  |....1...-.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -55,30 +54,30 @@
 000002b0  5b 12 2e 8f 09 67 fd a7  24 20 3e b2 56 1c ce 97  |[....g..$ >.V...|
 000002c0  28 5e f8 2b 2d 4f 9e f1  07 9f 6c 4b 5b 83 56 e2  |(^.+-O....lK[.V.|
 000002d0  32 42 e9 58 b6 d7 49 a6  b5 68 1a 41 03 56 6b dc  |2B.X..I..h.A.Vk.|
-000002e0  5a 89 05 01 00 80 93 26  98 d7 3e 0d ab 56 8d 13  |Z......&..>..V..|
-000002f0  9e 92 13 e4 a5 f3 f2 48  27 c2 16 11 d4 59 22 45  |.......H'....Y"E|
-00000300  33 42 2c 85 20 b6 1c d2  81 32 ca 87 6c 2e 04 4a  |3B,. ....2..l..J|
-00000310  e9 4c 3c d9 d9 ae 3f 89  c3 da 9d 6a 62 bf e1 66  |.L<...?....jb..f|
-00000320  4a d7 b5 33 f7 d1 72 21  2c 4f 23 3d 77 12 0e 02  |J..3..r!,O#=w...|
-00000330  5f 84 8c cf 00 97 10 0c  16 f3 3e 53 a6 3a 29 3e  |_.........>S.:)>|
-00000340  56 ef 0d 3c 21 23 13 98  54 57 9b 1c e4 b6 44 dd  |V..<!#..TW....D.|
-00000350  db e1 aa e1 23 ee 51 e1  71 d7 6d fc df d3 23 fd  |....#.Q.q.m...#.|
-00000360  a8 9c 74 bf c7 20 16 03  03 00 04 0e 00 00 00     |..t.. .........|
+000002e0  5a 89 05 01 00 80 24 35  9f 10 13 d9 ae 05 b2 37  |Z.....$5.......7|
+000002f0  ff 96 89 d1 fd 47 19 d5  42 1c 72 0a f8 06 a9 37  |.....G..B.r....7|
+00000300  a9 ef b8 58 64 71 23 86  1c 23 94 16 10 f6 4f f9  |...Xdq#..#....O.|
+00000310  ce 43 86 fb c6 25 1e 5e  e4 53 50 f0 e4 af b2 1c  |.C...%.^.SP.....|
+00000320  a8 b3 9e 89 4a 36 da 95  3b a0 30 ce 60 44 82 c8  |....J6..;.0.`D..|
+00000330  79 e1 dd 6f 19 6b 91 c8  37 8b 9e 86 c3 6f cc ad  |y..o.k..7....o..|
+00000340  e0 75 a2 72 0b 8a 82 15  2f 2b f4 57 2d cf 63 d4  |.u.r..../+.W-.c.|
+00000350  68 cb 31 bd 00 dd c4 f8  5a 63 ca 7f 19 9e f4 c6  |h.1.....Zc......|
+00000360  15 66 8d 0a 06 af 16 03  03 00 04 0e 00 00 00     |.f.............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 4e da 3b b0 2f  |....F...BA.N.;./|
-00000010  6b 0f 65 fe 9e 35 d1 72  7d 94 d0 16 0f 38 e9 22  |k.e..5.r}....8."|
-00000020  e1 e5 01 93 73 1e ea 66  9f dd e0 e3 00 59 9e d4  |....s..f.....Y..|
-00000030  d0 06 38 ca e4 4f 38 f3  49 6c bd 26 45 fd 6c e2  |..8..O8.Il.&E.l.|
-00000040  6f 0e 10 44 8b 93 bd 49  1a 22 4f 14 03 03 00 01  |o..D...I."O.....|
-00000050  01 16 03 03 00 28 6b 12  cd 3a eb ab 7e 44 cd 92  |.....(k..:..~D..|
-00000060  ec 77 06 72 02 62 57 c5  91 bc 8c 79 cb 69 78 9e  |.w.r.bW....y.ix.|
-00000070  c7 7f 6f f7 0e ce 10 21  b3 e4 9b 6e 21 d9        |..o....!...n!.|
+00000000  16 03 03 00 46 10 00 00  42 41 04 09 59 de cb 3c  |....F...BA..Y..<|
+00000010  da 19 78 97 95 3b 38 03  01 f8 0b 54 e8 02 65 e5  |..x..;8....T..e.|
+00000020  36 78 c4 03 8f 54 09 15  4a 2f ab 21 c8 66 76 64  |6x...T..J/.!.fvd|
+00000030  61 bf b4 c0 cb ce 30 1a  45 36 d1 cc 31 dc 49 42  |a.....0.E6..1.IB|
+00000040  d6 60 86 cf 63 da 6c eb  18 5a a1 14 03 03 00 01  |.`..c.l..Z......|
+00000050  01 16 03 03 00 28 09 75  e9 46 b4 92 ae 93 ef c4  |.....(.u.F......|
+00000060  84 98 c7 b1 8c c6 f2 02  06 91 b3 65 5d f3 19 81  |...........e]...|
+00000070  f1 6c 60 3d f5 78 da 70  6a 0c 8e 3f 9f 0c        |.l`=.x.pj..?..|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 28 00 00 00 00 00  |..........(.....|
-00000010  00 00 00 92 5f 03 8a 5a  be f8 8f cd c0 72 bf 35  |...._..Z.....r.5|
-00000020  b4 23 3c 95 33 f6 f3 0e  07 de 97 fe cd 59 2f 26  |.#<.3........Y/&|
-00000030  24 cd 82 17 03 03 00 25  00 00 00 00 00 00 00 01  |$......%........|
-00000040  2e 47 c3 a6 4f 0e 9b aa  27 2e d8 7e 72 5c 41 6e  |.G..O...'..~r\An|
-00000050  ca 87 c1 09 d7 86 75 df  d9 15 f1 ad 14 15 03 03  |......u.........|
-00000060  00 1a 00 00 00 00 00 00  00 02 87 f8 c1 b0 39 76  |..............9v|
-00000070  4d c2 b2 31 0b 69 ef 17  68 fb e1 a7              |M..1.i..h...|
+00000010  00 00 00 48 dd ca d6 1f  f4 09 7b ab 99 c0 e6 45  |...H......{....E|
+00000020  78 54 a5 f9 b0 fd 84 88  a8 74 27 8b 20 57 99 07  |xT.......t'. W..|
+00000030  ad 4d 07 17 03 03 00 25  00 00 00 00 00 00 00 01  |.M.....%........|
+00000040  49 61 3f ce 95 60 ee d8  b4 38 4f 38 8e 13 a4 dc  |Ia?..`...8O8....|
+00000050  32 dd 22 c9 20 b3 81 fa  98 96 c8 34 02 15 03 03  |2.". ......4....|
+00000060  00 1a 00 00 00 00 00 00  00 02 47 7e 19 de ee 36  |..........G~...6|
+00000070  90 5d 7a 4f 10 bc ec aa  14 49 54 bc              |.]zO.....IT.|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-RC4 b/src/crypto/tls/testdata/Server-TLSv12-RSA-RC4
index d99cf29b4a..2fbf3d92f7 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-RC4
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-RC4
@@ -1,10 +1,11 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 5a 01 00 00  56 03 03 46 72 9f 1b d0  |....Z...V..Fr...|
-00000010  ca 0a 6c 7f 7c bc fe e8  38 66 d1 27 18 f2 79 f0  |..l.|...8f.'..y.|
-00000020  c0 74 12 ac c3 5b c5 5d  c5 52 fe 00 00 04 00 05  |.t...[.].R......|
-00000030  00 ff 01 00 00 29 00 0d  00 20 00 1e 06 01 06 02  |.....)... ......|
+00000000  16 03 01 00 5d 01 00 00  59 03 03 a3 60 98 78 96  |....]...Y...`.x.|
+00000010  54 77 9a 56 e1 a4 1f 0c  18 53 03 e4 f7 b2 6d 73  |Tw.V.....S....ms|
+00000020  43 00 fe 40 34 c9 1e 15  76 84 a6 00 00 04 00 05  |C..@4...v.......|
+00000030  00 ff 01 00 00 2c 00 0d  00 20 00 1e 06 01 06 02  |.....,... ......|
 00000040  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
-00000050  03 02 03 03 02 01 02 02  02 03 00 0f 00 01 01     |...............|
+00000050  03 02 03 03 02 01 02 02  02 03 00 16 00 00 00 17  |................|
+00000060  00 00                                             |..|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 31 02 00 00  2d 03 03 00 00 00 00 00  |....1...-.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -49,23 +50,23 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 d0 14 c7 c2 70  |...............p|
-00000010  7c f3 a1 5e c2 e9 0b 47  51 73 f9 8c c8 40 e9 ee  ||..^...GQs...@..|
-00000020  4c d9 09 fe b0 e7 f7 d1  20 40 a3 87 cc fb 71 90  |L....... @....q.|
-00000030  cb 45 09 0c bf 93 05 c2  97 30 32 63 39 6e 5f 2e  |.E.......02c9n_.|
-00000040  6d 29 ca 76 11 c9 3c e2  0d 2b 5d e8 6f 9c 10 b8  |m).v..<..+].o...|
-00000050  ac 4a 60 b6 1a 93 09 ae  23 93 29 92 d5 f1 ec 80  |.J`.....#.).....|
-00000060  f4 5b 56 6a 87 11 50 1a  73 ba 5a 79 25 a9 a2 09  |.[Vj..P.s.Zy%...|
-00000070  97 5f d8 b6 b5 06 f9 49  d9 db c6 ac f6 1e a7 7b  |._.....I.......{|
-00000080  68 33 0b 33 df 84 79 04  93 c3 f0 14 03 03 00 01  |h3.3..y.........|
-00000090  01 16 03 03 00 24 89 f1  ae af cf 78 d1 31 1a ec  |.....$.....x.1..|
-000000a0  b6 7e 86 93 eb cd fa 0c  3d 55 06 9a 77 60 9e 34  |.~......=U..w`.4|
-000000b0  fd ef f9 be 8e d3 21 98  64 13                    |......!.d.|
+00000000  16 03 03 00 86 10 00 00  82 00 80 55 2f e8 6c 17  |...........U/.l.|
+00000010  e8 b3 29 bb cb b3 b6 77  3d cf 15 57 03 2a 3b 1c  |..)....w=..W.*;.|
+00000020  f4 d1 da 6a f1 42 17 13  bf 22 fb 54 78 9c d8 83  |...j.B...".Tx...|
+00000030  bf 8d 23 02 9c 96 a1 19  19 b3 40 5a 11 86 2a 1f  |..#.......@Z..*.|
+00000040  55 4b 42 fb 98 1f 8f 65  dc 2b 7e a5 aa 6a f9 27  |UKB....e.+~..j.'|
+00000050  27 bd ce dc 6a 16 85 36  a7 39 d8 e0 c3 e9 b4 f4  |'...j..6.9......|
+00000060  c4 36 f2 4a b8 64 e0 67  ab 9e d2 f6 11 c3 55 42  |.6.J.d.g......UB|
+00000070  72 a8 60 35 99 13 45 ff  df 95 67 47 86 e4 a2 33  |r.`5..E...gG...3|
+00000080  f1 e2 9d 34 5f ea 8c 71  29 aa 69 14 03 03 00 01  |...4_..q).i.....|
+00000090  01 16 03 03 00 24 a8 bb  de a4 19 50 51 a5 7b 50  |.....$.....PQ.{P|
+000000a0  c6 a8 37 ec f0 da 12 0a  45 d5 16 b0 27 7a 00 0a  |..7.....E...'z..|
+000000b0  0b 72 6a fb 67 2c e6 b4  6d fe                    |.rj.g,..m.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 24 8d da d7 21 f4  |..........$...!.|
-00000010  10 51 ec 89 f7 42 3a 7a  5c 32 9c db 32 68 27 fb  |.Q...B:z\2..2h'.|
-00000020  85 af 93 54 b6 69 af 25  21 18 5f da ad 36 a6 17  |...T.i.%!._..6..|
-00000030  03 03 00 21 57 d7 ac b9  79 0b fd 0f 14 21 a8 a4  |...!W...y....!..|
-00000040  31 88 5c f2 d1 08 56 b1  72 38 fb be 86 00 4f 0e  |1.\...V.r8....O.|
-00000050  b0 0d 78 b7 5b 15 03 03  00 16 e1 9b b5 df 0f d0  |..x.[...........|
-00000060  0d 7b 49 cd 0b fb 5f 39  c0 47 81 e0 00 ed 55 73  |.{I..._9.G....Us|
+00000000  14 03 03 00 01 01 16 03  03 00 24 64 b0 e3 b3 bb  |..........$d....|
+00000010  70 9a 1c af 9c 93 91 67  87 ea d2 7b 84 5c 2b 1f  |p......g...{.\+.|
+00000020  89 c0 7d 6d 28 31 ad 8b  d8 ab 8a 7c ad c3 d8 17  |..}m(1.....|....|
+00000030  03 03 00 21 5c 30 69 29  a7 22 b9 fa d6 65 38 77  |...!\0i)."...e8w|
+00000040  6b 2b c7 4e 4b 6d 6f 91  c1 cf 8c 2c 08 e8 c7 b2  |k+.NKmo....,....|
+00000050  21 8c dd 3e 36 15 03 03  00 16 7b 1a bd 2e 9b 56  |!..>6.....{....V|
+00000060  4c b8 0d 1c 34 3f 3a 7e  e1 65 aa bf ad f1 1f 5e  |L...4?:~.e.....^|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-Resume b/src/crypto/tls/testdata/Server-TLSv12-Resume
index 65858282ba..599da5b67d 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-Resume
+++ b/src/crypto/tls/testdata/Server-TLSv12-Resume
@@ -1,37 +1,44 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 f6 01 00 00  f2 03 03 8b 12 b3 05 ae  |................|
-00000010  94 e0 8d ee 48 92 1a bc  cd c1 8b e6 e7 e7 6f 95  |....H.........o.|
-00000020  70 81 84 38 e4 29 4e 15  43 5c 42 20 28 4e 1c 13  |p..8.)N.C\B (N..|
-00000030  40 cb 3e ce b0 49 3a d4  95 9c 21 0d 05 29 9e b3  |@.>..I:...!..)..|
-00000040  ef 8b 78 70 aa 3f 6f af  77 ed a6 84 00 04 00 05  |..xp.?o.w.......|
-00000050  00 ff 01 00 00 a5 00 23  00 78 50 46 ad c1 db a8  |.......#.xPF....|
+00000000  16 03 01 00 f9 01 00 00  f5 03 03 87 90 a5 92 ea  |................|
+00000010  48 25 c2 91 01 8a e4 bb  16 2d d3 8c b7 e9 a3 9a  |H%.......-......|
+00000020  6d e1 6f b4 11 f3 9b 61  c9 03 cf 20 d9 a8 04 8f  |m.o....a... ....|
+00000030  3b f8 1c 73 d8 4b 55 40  43 95 26 1f ed 67 cc 18  |;..s.KU@C.&..g..|
+00000040  0d 8f e8 d4 ab 1a 2e 53  d0 e6 89 d8 00 04 00 2f  |.......S......./|
+00000050  00 ff 01 00 00 a8 00 23  00 78 50 46 ad c1 db a8  |.......#.xPF....|
 00000060  38 86 7b 2b bb fd d0 c3  42 3e 00 00 00 00 00 00  |8.{+....B>......|
-00000070  00 00 00 00 00 00 00 00  00 00 94 6f 2c b5 83 61  |...........o,..a|
-00000080  78 0b 52 39 31 36 f7 0c  5e 27 d3 76 9b c2 af 4e  |x.R916..^'.v...N|
-00000090  df 30 cb 1d c9 04 ee d2  02 31 f6 33 bc 59 0d 24  |.0.......1.3.Y.$|
-000000a0  61 3c 23 7a 92 ad 16 20  88 1c 5f 20 32 38 fc 30  |a<#z... .._ 28.0|
-000000b0  33 94 39 48 29 9e 70 41  ea 58 cd 66 02 d9 b7 7c  |3.9H).pA.X.f...||
-000000c0  71 1a ad 67 7f 87 a6 4e  3a b7 be ff 59 39 58 bf  |q..g...N:...Y9X.|
-000000d0  96 4d 00 0d 00 20 00 1e  06 01 06 02 06 03 05 01  |.M... ..........|
+00000070  00 00 00 00 00 00 00 00  00 00 94 6f 2c 9f 83 61  |...........o,..a|
+00000080  ba 85 c2 4f 82 f7 76 6c  2f 9d 4c 16 0e 46 88 f4  |...O..vl/.L..F..|
+00000090  1b 1b 35 62 9c c7 e6 0e  44 a4 62 8c 1e 2d 53 f3  |..5b....D.b..-S.|
+000000a0  8b cd a6 ca dc 12 52 b4  43 a9 d0 16 4c 9a f7 a6  |......R.C...L...|
+000000b0  33 94 f7 58 26 2b 75 74  62 e3 11 dc f6 40 b0 ab  |3..X&+utb....@..|
+000000c0  32 8b 79 63 d1 7e d8 9f  db cf cf 25 29 ea e9 89  |2.yc.~.....%)...|
+000000d0  43 39 00 0d 00 20 00 1e  06 01 06 02 06 03 05 01  |C9... ..........|
 000000e0  05 02 05 03 04 01 04 02  04 03 03 01 03 02 03 03  |................|
-000000f0  02 01 02 02 02 03 00 0f  00 01 01                 |...........|
+000000f0  02 01 02 02 02 03 00 16  00 00 00 17 00 00        |..............|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 51 02 00 00  4d 03 03 00 00 00 00 00  |....Q...M.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 28 4e 1c 13  |........... (N..|
-00000030  40 cb 3e ce b0 49 3a d4  95 9c 21 0d 05 29 9e b3  |@.>..I:...!..)..|
-00000040  ef 8b 78 70 aa 3f 6f af  77 ed a6 84 00 05 00 00  |..xp.?o.w.......|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 d9 a8 04 8f  |........... ....|
+00000030  3b f8 1c 73 d8 4b 55 40  43 95 26 1f ed 67 cc 18  |;..s.KU@C.&..g..|
+00000040  0d 8f e8 d4 ab 1a 2e 53  d0 e6 89 d8 00 2f 00 00  |.......S...../..|
 00000050  05 ff 01 00 01 00 14 03  03 00 01 01 16 03 03 00  |................|
-00000060  24 92 98 ff dd 93 ef 62  b5 55 9c 02 ce 61 5a 0e  |$......b.U...aZ.|
-00000070  43 66 0f 3f 57 32 f0 f3  96 a2 75 93 5d 8a c0 ab  |Cf.?W2....u.]...|
-00000080  ac 14 97 a1 45                                    |....E|
+00000060  40 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |@...............|
+00000070  00 31 1c ed f9 93 71 b9  b1 52 b7 8c d2 cc 1c ea  |.1....q..R......|
+00000080  2b bb c3 56 88 d4 40 ff  71 d4 33 4b 1a 17 6e ab  |+..V..@.q.3K..n.|
+00000090  70 78 3f 87 bf cd 8c 67  91 a0 17 d7 ee 16 37 68  |px?....g......7h|
+000000a0  5b                                                |[|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 16 03  03 00 24 ff bb 0d 2c c7  |..........$...,.|
-00000010  ef d5 b0 c8 18 54 b0 7b  d7 2e d4 b0 41 65 67 80  |.....T.{....Aeg.|
-00000020  10 c4 11 ed 2c 28 b1 d6  4b 7f a6 66 70 f4 05     |....,(..K..fp..|
+00000000  14 03 03 00 01 01 16 03  03 00 40 a5 40 0c 73 e9  |..........@.@.s.|
+00000010  c5 b5 65 d6 1c a7 17 c4  9b 3f 1a 6d e1 02 c4 b0  |..e......?.m....|
+00000020  27 9b ab 24 d5 68 d3 98  3e 06 13 c3 d9 a7 b9 07  |'..$.h..>.......|
+00000030  fb fa fa 1b ba 41 b4 26  94 ba e7 5c a3 bf ae b7  |.....A.&...\....|
+00000040  69 f9 55 71 bd 04 97 04  0c fc 96                 |i.Uq.......|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 21 97 5a 21  d6 cd 7e 16 77 2a ab ef  |....!.Z!..~.w*..|
-00000010  24 d1 32 5f d6 81 5e 6b  94 01 df e2 bb 64 b1 a8  |$.2_..^k.....d..|
-00000020  3d aa fd a6 cd ef 15 03  03 00 16 d5 8e 4e 3c 62  |=............N<b|
-00000030  2c 8f 2d a2 c4 e3 4e b0  b4 64 9f 02 f9 4b ca 10  |,.-...N..d...K..|
-00000040  9d                                                |.|
+00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
+00000010  00 00 00 00 00 fc f8 67  97 50 34 a5 05 b2 f0 ea  |.......g.P4.....|
+00000020  77 5c bb 63 78 79 a4 a0  58 37 3b ae 96 9a c5 16  |w\.cxy..X7;.....|
+00000030  82 9c b0 4b 02 27 01 0d  c9 ac e0 f5 3d d6 32 f7  |...K.'......=.2.|
+00000040  df 41 68 b0 38 15 03 03  00 30 00 00 00 00 00 00  |.Ah.8....0......|
+00000050  00 00 00 00 00 00 00 00  00 00 ea 57 3b c1 9f f4  |...........W;...|
+00000060  79 d7 76 f0 d6 1c 9d cd  0e 5a 2a 98 29 36 96 47  |y.v......Z*.)6.G|
+00000070  4e 9c 76 ef 4c 69 c1 e3  4b b3                    |N.v.Li..K.|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ResumeDisabled b/src/crypto/tls/testdata/Server-TLSv12-ResumeDisabled
index e776d5529f..96bd098fda 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ResumeDisabled
+++ b/src/crypto/tls/testdata/Server-TLSv12-ResumeDisabled
@@ -1,24 +1,24 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 f6 01 00 00  f2 03 03 b4 3f dd f9 4f  |............?..O|
-00000010  bd 6b eb bb 7c 51 02 9e  ce 05 e7 51 c8 93 66 87  |.k..|Q.....Q..f.|
-00000020  72 5f 88 ae d7 1c da 76  80 a7 9f 20 ca 0f 7b 52  |r_.....v... ..{R|
-00000030  b5 bf 67 b9 14 78 b4 0e  f9 64 af d2 36 d8 33 d8  |..g..x...d..6.3.|
-00000040  20 51 6f 1d ef 82 1c 8f  43 70 c9 83 00 04 00 05  | Qo.....Cp......|
-00000050  00 ff 01 00 00 a5 00 23  00 78 50 46 ad c1 db a8  |.......#.xPF....|
+00000000  16 03 01 00 f9 01 00 00  f5 03 03 c0 f1 8f 13 ed  |................|
+00000010  61 9a 75 ae 73 8d 36 f2  23 33 0c e0 7f 78 a5 d2  |a.u.s.6.#3...x..|
+00000020  57 62 6c 5c 2b b7 1d aa  fe db 57 20 78 df e5 41  |Wbl\+.....W x..A|
+00000030  23 3f dc 1b 76 d9 dd cf  a5 bf 00 8d 54 ca 0b c1  |#?..v.......T...|
+00000040  69 f4 d5 2a 50 ce 27 fd  58 22 50 14 00 04 00 2f  |i..*P.'.X"P..../|
+00000050  00 ff 01 00 00 a8 00 23  00 78 50 46 ad c1 db a8  |.......#.xPF....|
 00000060  38 86 7b 2b bb fd d0 c3  42 3e 00 00 00 00 00 00  |8.{+....B>......|
-00000070  00 00 00 00 00 00 00 00  00 00 94 6f 2c b5 83 61  |...........o,..a|
-00000080  a0 6c 9b 3d 82 88 87 9d  31 0d 89 7c cc 1c bf e6  |.l.=....1..|....|
-00000090  02 1c 08 6d 29 4a 85 17  dd 2f 46 c9 87 a7 d9 23  |...m)J.../F....#|
-000000a0  5f e4 3d 72 22 85 63 b7  03 7e a8 2b f4 a6 62 65  |_.=r".c..~.+..be|
-000000b0  33 94 df 7b 0e fa 5a 0d  d3 b3 be 2a b0 fb c1 46  |3..{..Z....*...F|
-000000c0  7e dd 4b 59 39 fc 1a 4f  4c c4 f3 ec f0 73 b3 11  |~.KY9..OL....s..|
-000000d0  8e 1b 00 0d 00 20 00 1e  06 01 06 02 06 03 05 01  |..... ..........|
+00000070  00 00 00 00 00 00 00 00  00 00 94 6f 2c 9f 83 61  |...........o,..a|
+00000080  67 87 d5 79 1d 56 b8 ca  6d e2 b0 2e a7 2e c9 d7  |g..y.V..m.......|
+00000090  b3 5a de 91 3b 6f 30 a7  14 af d1 b4 af 5b 9e a0  |.Z..;o0......[..|
+000000a0  65 e6 fe cd d3 77 f3 88  c6 cf 52 74 28 4b a2 14  |e....w....Rt(K..|
+000000b0  33 94 9a e0 60 f2 0b df  c5 58 4b 56 46 52 6a 3a  |3...`....XKVFRj:|
+000000c0  83 15 89 c6 a9 31 83 83  ef 29 2a 9f c6 5f ba 8d  |.....1...)*.._..|
+000000d0  91 de 00 0d 00 20 00 1e  06 01 06 02 06 03 05 01  |..... ..........|
 000000e0  05 02 05 03 04 01 04 02  04 03 03 01 03 02 03 03  |................|
-000000f0  02 01 02 02 02 03 00 0f  00 01 01                 |...........|
+000000f0  02 01 02 02 02 03 00 16  00 00 00 17 00 00        |..............|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 31 02 00 00  2d 03 03 00 00 00 00 00  |....1...-.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 05 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2f 00 00  |............./..|
 00000030  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
 00000040  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000050  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -59,23 +59,31 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 20 d5 d7 e9 8b  |........... ....|
-00000010  f4 ca 5a d9 f1 cb 8f 54  28 fa f9 77 eb c8 24 53  |..Z....T(..w..$S|
-00000020  b7 41 3e 3b ba ec 2d 2b  ee fb fb ad 7d 6f d4 8a  |.A>;..-+....}o..|
-00000030  17 7d 8d 10 76 e6 a0 d2  43 4b e4 71 29 c5 67 fc  |.}..v...CK.q).g.|
-00000040  ca 27 e7 fa e9 77 ef bc  3d 43 21 d7 73 29 ed bd  |.'...w..=C!.s)..|
-00000050  28 72 da c5 56 ca 11 de  82 42 19 e9 8c 99 ea 94  |(r..V....B......|
-00000060  59 38 d8 21 d7 8f 21 6b  bb 4a a1 1a 7a 2c 50 29  |Y8.!..!k.J..z,P)|
-00000070  bb 23 65 8a 57 73 00 37  d1 4c a1 dd 80 b3 15 cb  |.#e.Ws.7.L......|
-00000080  58 89 cd 55 68 ea 0a d1  04 77 ad 14 03 03 00 01  |X..Uh....w......|
-00000090  01 16 03 03 00 24 05 34  10 ef 1a 58 49 8e 93 e6  |.....$.4...XI...|
-000000a0  a8 e5 78 1a 98 72 63 e8  6f 5d d6 7c e0 77 19 df  |..x..rc.o].|.w..|
-000000b0  c1 c6 2a c5 8a 05 40 86  22 14                    |..*...@.".|
+00000000  16 03 03 00 86 10 00 00  82 00 80 62 1e 90 15 39  |...........b...9|
+00000010  f4 61 dd 1a ae ce 4b 84  1c dc 0b c8 b6 16 6d bb  |.a....K.......m.|
+00000020  77 02 c3 69 02 b6 b1 9c  de 1f 09 01 50 e6 3e 51  |w..i........P.>Q|
+00000030  96 36 5a 6c 87 63 5f fe  8a da bd ee 01 6d a3 3e  |.6Zl.c_......m.>|
+00000040  ff b2 72 47 60 6d ca c3  a4 03 57 4e 1f ea 7d cc  |..rG`m....WN..}.|
+00000050  f7 0c 2a 06 8f a6 c6 fe  1a bb 75 81 92 5e 44 3d  |..*.......u..^D=|
+00000060  78 49 1e 88 79 19 8a df  79 09 2e 61 10 48 7a 60  |xI..y...y..a.Hz`|
+00000070  e0 58 51 ec 33 4c b1 d0  6d ad 01 03 9f 38 21 bb  |.XQ.3L..m....8!.|
+00000080  8f 9d 23 c1 06 38 f3 90  dc 7f af 14 03 03 00 01  |..#..8..........|
+00000090  01 16 03 03 00 40 3d 60  a9 d5 ae 59 72 dc ef 8e  |.....@=`...Yr...|
+000000a0  9a 77 ab 3c 8d 98 bb 5a  67 d1 2b 00 2d 97 8d af  |.w.<...Zg.+.-...|
+000000b0  ef 1b bb 8c 0b ce ab 2a  e7 a8 0e 2a 28 83 34 5a  |.......*...*(.4Z|
+000000c0  00 d0 5d dc 6e 9c e3 a6  eb e7 fa 4c 7f 14 76 1f  |..].n......L..v.|
+000000d0  76 56 c0 61 78 d1                                 |vV.ax.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 24 da ea fa de 62  |..........$....b|
-00000010  d0 73 60 27 a0 e5 06 35  fa 97 4f b4 6f 57 4b 37  |.s`'...5..O.oWK7|
-00000020  b9 e1 f5 85 07 a2 1a 06  d0 f8 f0 c9 70 13 94 17  |............p...|
-00000030  03 03 00 21 2e 15 9c 6e  71 66 03 8e 47 b6 21 ad  |...!...nqf..G.!.|
-00000040  3c e6 92 a5 3d 70 93 63  80 5b b3 e5 69 f4 46 00  |<...=p.c.[..i.F.|
-00000050  2e ea 50 65 27 15 03 03  00 16 d3 36 1b dc 61 05  |..Pe'......6..a.|
-00000060  9d af 6a cd 1c 78 5f d4  07 7b d2 db 45 f3 42 41  |..j..x_..{..E.BA|
+00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
+00000010  00 00 00 00 00 00 00 00  00 00 00 89 71 57 1b 74  |............qW.t|
+00000020  93 38 ff 69 12 59 5a 24  3c 47 67 96 f6 4f 2d 0f  |.8.i.YZ$<Gg..O-.|
+00000030  dc 00 d0 1e 43 78 19 7e  b0 79 73 19 c6 67 43 94  |....Cx.~.ys..gC.|
+00000040  cb 66 2c 75 d8 54 90 62  33 5a 21 17 03 03 00 40  |.f,u.T.b3Z!....@|
+00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000060  8d 20 2f 9e b8 84 fc 5c  4b 3d 95 eb 4b 02 db 7f  |. /....\K=..K...|
+00000070  2b 66 1a 46 d0 2e 3e e8  18 58 c0 1f 37 ad db da  |+f.F..>..X..7...|
+00000080  78 5d ec eb 8a 39 2c 9d  e9 2e 37 ba 34 53 92 d3  |x]...9,...7.4S..|
+00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
+000000a0  00 00 00 00 00 0b fb 0f  fc f1 36 24 05 99 aa bb  |..........6$....|
+000000b0  e6 b2 be cd e9 f1 8a 4b  bb 94 67 6d 87 4e 98 0e  |.......K..gm.N..|
+000000c0  a2 9e 46 2e 8b                                    |..F..|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-SNI b/src/crypto/tls/testdata/Server-TLSv12-SNI
index 7d6a155213..a6b5334354 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-SNI
+++ b/src/crypto/tls/testdata/Server-TLSv12-SNI
@@ -1,12 +1,12 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 6e 01 00 00  6a 03 03 8d a3 6b 9b 7b  |....n...j....k.{|
-00000010  cc 8b b4 74 25 41 25 c5  74 1d 1e 3a eb fb 70 df  |...t%A%.t..:..p.|
-00000020  9b de c2 d4 b4 dd 53 00  83 c6 57 00 00 04 00 2f  |......S...W..../|
-00000030  00 ff 01 00 00 3d 00 00  00 10 00 0e 00 00 0b 73  |.....=.........s|
+00000000  16 03 01 00 71 01 00 00  6d 03 03 bd c9 cf c6 3f  |....q...m......?|
+00000010  0b a6 a0 f8 a6 c5 91 f1  45 fa 20 cb 42 67 2f d7  |........E. .Bg/.|
+00000020  cb be 35 d4 6a a5 07 47  11 bb fe 00 00 04 00 2f  |..5.j..G......./|
+00000030  00 ff 01 00 00 40 00 00  00 10 00 0e 00 00 0b 73  |.....@.........s|
 00000040  6e 69 74 65 73 74 2e 63  6f 6d 00 0d 00 20 00 1e  |nitest.com... ..|
 00000050  06 01 06 02 06 03 05 01  05 02 05 03 04 01 04 02  |................|
-00000060  04 03 03 01 03 02 03 03  02 01 02 02 02 03 00 0f  |................|
-00000070  00 01 01                                          |...|
+00000060  04 03 03 01 03 02 03 03  02 01 02 02 02 03 00 16  |................|
+00000070  00 00 00 17 00 00                                 |......|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 31 02 00 00  2d 03 03 00 00 00 00 00  |....1...-.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -51,31 +51,31 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 6f f3 47 eb 30  |...........o.G.0|
-00000010  e0 17 d3 7a 06 a9 f7 ce  56 5c d1 0b ab c4 db b3  |...z....V\......|
-00000020  93 43 d2 29 3a 53 98 70  e6 1b 4c 58 a9 97 4f c1  |.C.):S.p..LX..O.|
-00000030  99 2b 1f b9 84 b5 d1 98  18 ce a8 d4 33 9f bf 5b  |.+..........3..[|
-00000040  dc ef 0a 37 b4 1f d4 11  08 57 d1 8c 2d 71 a7 95  |...7.....W..-q..|
-00000050  5b 43 4e 9b 53 b0 00 5b  65 45 24 c5 6d fb 25 e3  |[CN.S..[eE$.m.%.|
-00000060  e5 ee 5d 88 d0 8f 9d c4  dd c8 53 22 45 b1 3f 9e  |..].......S"E.?.|
-00000070  ee 99 36 45 66 e7 18 88  7c 7d 14 f4 3e 2d 94 bf  |..6Ef...|}..>-..|
-00000080  1a 51 0f a8 18 e9 9f ac  cb 2c 5e 14 03 03 00 01  |.Q.......,^.....|
-00000090  01 16 03 03 00 40 b0 2f  48 95 b9 25 85 6c 64 63  |.....@./H..%.ldc|
-000000a0  0b a3 79 54 d9 eb 58 d1  3a 93 aa 63 ff e4 d2 23  |..yT..X.:..c...#|
-000000b0  4f 83 f9 41 93 d6 5a 03  bc b5 ad 3b bb 78 5f 57  |O..A..Z....;.x_W|
-000000c0  2b 9d 84 07 9f 7e e6 9c  58 b8 e5 70 f1 29 0d 29  |+....~..X..p.).)|
-000000d0  52 9b 69 d5 25 03                                 |R.i.%.|
+00000000  16 03 03 00 86 10 00 00  82 00 80 a4 72 d8 04 ea  |............r...|
+00000010  75 da c4 14 85 8d d7 7d  08 43 3a 38 fc 02 50 8e  |u......}.C:8..P.|
+00000020  54 8a 49 a7 fc 4b 3f 13  a0 63 c6 69 72 93 2d cd  |T.I..K?..c.ir.-.|
+00000030  f5 08 fe 24 bb d8 54 76  25 eb f8 9c 5d b9 a9 df  |...$..Tv%...]...|
+00000040  56 f9 42 81 c1 29 0e 4e  05 f3 f7 44 bb ee a4 de  |V.B..).N...D....|
+00000050  a6 cc 22 68 40 1b 81 4e  fe e2 02 8e e7 7c 25 71  |.."h@..N.....|%q|
+00000060  cc 9e 86 01 e6 80 68 b2  4e 80 3d fc bc 4f 8f 30  |......h.N.=..O.0|
+00000070  fa 17 be 2c 7f c5 5f 17  b0 b3 3c 4b 90 a2 5e cc  |...,.._...<K..^.|
+00000080  35 94 9c e4 9c 35 12 a2  ba a3 c3 14 03 03 00 01  |5....5..........|
+00000090  01 16 03 03 00 40 20 48  00 ff 46 9b e5 61 a3 1f  |.....@ H..F..a..|
+000000a0  c3 cc 86 b3 b5 4d dc f8  b3 6f 61 1f b8 03 83 93  |.....M...oa.....|
+000000b0  58 be bf 77 5d db 9c 3d  26 ed e2 cd a6 1d 4b e3  |X..w]..=&.....K.|
+000000c0  37 c2 0d 4d b6 80 e1 f1  17 19 1e 9e 77 90 ec 16  |7..M........w...|
+000000d0  55 92 a4 f9 36 a7                                 |U...6.|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 0f 0d bb 06 58  |...............X|
-00000020  0f c9 e5 69 4a bb e6 e5  8c 53 d7 a6 70 fa 1c c6  |...iJ....S..p...|
-00000030  0d a5 b8 5b 72 74 6a 38  08 47 b4 55 53 e5 79 9b  |...[rtj8.G.US.y.|
-00000040  94 24 e6 d7 bf 16 37 2e  3b 90 63 17 03 03 00 40  |.$....7.;.c....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 85 9f 5f d6 b1  |............._..|
+00000020  f2 c9 ad b8 01 16 9f 20  b1 41 06 f4 6d 44 b5 6d  |....... .A..mD.m|
+00000030  0a 68 d0 e3 6a 24 66 de  39 f1 7a d9 81 5e f7 d4  |.h..j$f.9.z..^..|
+00000040  36 e6 11 12 f6 0f 01 ef  6e af 0d 17 03 03 00 40  |6.......n......@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  8c ec 5a 5a 6c c5 04 d1  9d 1e 0b e2 e5 f5 10 cd  |..ZZl...........|
-00000070  3a f9 66 1b 4d e5 2c a5  16 67 40 02 95 95 19 d9  |:.f.M.,..g@.....|
-00000080  93 0b e5 f3 83 9d 47 c7  73 ba 2c c5 e4 a9 2f fb  |......G.s.,.../.|
+00000060  b4 b8 fe 91 27 cb 85 b3  4c 2c 42 8e ce c0 17 40  |....'...L,B....@|
+00000070  82 34 21 c6 fe b6 c8 90  07 d2 a7 5e f2 01 34 ed  |.4!........^..4.|
+00000080  0a 51 33 af 4b 72 80 49  4b d1 a1 02 99 f5 26 3d  |.Q3.Kr.IK.....&=|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 d6 1f 95  49 7e 5e 87 0f 37 82 cd  |........I~^..7..|
-000000b0  89 53 e1 a9 28 69 96 e3  53 6a 2e c4 77 dc 84 ff  |.S..(i..Sj..w...|
-000000c0  9b ab fe 35 4e                                    |...5N|
+000000a0  00 00 00 00 00 63 81 63  33 d1 2b db 09 8b b6 57  |.....c.c3.+....W|
+000000b0  54 c9 34 e8 56 e4 e3 b4  86 90 d5 86 df 71 a9 85  |T.4.V........q..|
+000000c0  56 be d5 9c b8                                    |V....|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificate b/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificate
index 4a9067c1f4..e1f46c3268 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificate
+++ b/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificate
@@ -1,12 +1,12 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 6e 01 00 00  6a 03 03 c1 08 07 62 98  |....n...j.....b.|
-00000010  dd 93 0e 37 de 1d 45 58  24 32 29 9d 37 d8 b0 53  |...7..EX$2).7..S|
-00000020  c4 15 18 cf a6 d0 c0 98  40 83 ad 00 00 04 00 2f  |........@....../|
-00000030  00 ff 01 00 00 3d 00 00  00 10 00 0e 00 00 0b 73  |.....=.........s|
+00000000  16 03 01 00 71 01 00 00  6d 03 03 ad e2 aa a7 cf  |....q...m.......|
+00000010  1c a3 74 6b a5 fb 38 80  57 ef 86 1e 67 50 df 44  |..tk..8.W...gP.D|
+00000020  f2 02 60 01 b5 6f 60 c7  25 1f 6e 00 00 04 00 2f  |..`..o`.%.n..../|
+00000030  00 ff 01 00 00 40 00 00  00 10 00 0e 00 00 0b 73  |.....@.........s|
 00000040  6e 69 74 65 73 74 2e 63  6f 6d 00 0d 00 20 00 1e  |nitest.com... ..|
 00000050  06 01 06 02 06 03 05 01  05 02 05 03 04 01 04 02  |................|
-00000060  04 03 03 01 03 02 03 03  02 01 02 02 02 03 00 0f  |................|
-00000070  00 01 01                                          |...|
+00000060  04 03 03 01 03 02 03 03  02 01 02 02 02 03 00 16  |................|
+00000070  00 00 00 17 00 00                                 |......|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 31 02 00 00  2d 03 03 00 00 00 00 00  |....1...-.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -51,31 +51,31 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 50 d7 a0 67 c3  |...........P..g.|
-00000010  69 9f 9a 80 af 1a 8e 20  26 9f 0a 6c 9a 35 4d 8b  |i...... &..l.5M.|
-00000020  e2 52 f7 84 9b bb 83 fe  4f 63 25 ec 60 f5 b3 64  |.R......Oc%.`..d|
-00000030  d2 3e d6 1f 2d bf e1 8c  a6 83 bd 3a 19 cd 21 88  |.>..-......:..!.|
-00000040  a5 d5 3a ec be aa 26 42  39 da 09 ed b3 9a c0 43  |..:...&B9......C|
-00000050  35 7e 3d 2f ad 48 b3 dd  a4 f9 f1 18 ce 86 a6 68  |5~=/.H.........h|
-00000060  25 04 66 8b a4 31 0a 42  16 d9 0c ff c8 13 83 4b  |%.f..1.B.......K|
-00000070  18 06 0c e0 2d a7 59 79  47 cf 15 80 5b 18 06 17  |....-.YyG...[...|
-00000080  e7 cb d1 93 15 f8 15 96  ee 38 10 14 03 03 00 01  |.........8......|
-00000090  01 16 03 03 00 40 fb 7f  f7 63 3b 02 d0 49 c6 61  |.....@...c;..I.a|
-000000a0  57 10 bc 34 40 2c 44 04  41 1a 60 a3 e7 0c c8 c7  |W..4@,D.A.`.....|
-000000b0  ec ee fa 36 5a 97 6d 05  26 ca 63 2e 84 fb 7b 1b  |...6Z.m.&.c...{.|
-000000c0  00 00 a1 a1 83 10 47 8f  da 13 72 0b ea 4b 33 8c  |......G...r..K3.|
-000000d0  b0 1c fb 45 7b 74                                 |...E{t|
+00000000  16 03 03 00 86 10 00 00  82 00 80 81 d4 77 fd 52  |.............w.R|
+00000010  f9 35 bd de 30 cd c9 6a  ec 57 97 e3 51 14 3f d4  |.5..0..j.W..Q.?.|
+00000020  b2 34 8f 2e f3 d1 f5 31  84 7c 9f cd 59 14 93 18  |.4.....1.|..Y...|
+00000030  9d e4 19 09 f2 55 cb ed  29 90 54 69 43 24 aa d7  |.....U..).TiC$..|
+00000040  9c a8 04 cd 25 e2 b1 d7  f1 15 32 3a 59 82 2c 1a  |....%.....2:Y.,.|
+00000050  bc 3b ab bf 68 aa 93 6f  b3 46 b9 fd d9 5e 33 0d  |.;..h..o.F...^3.|
+00000060  7f 02 24 5e 04 5e 49 40  36 ab a9 8a c0 dd d2 07  |..$^.^I@6.......|
+00000070  0e d8 a2 22 1a f5 e0 59  a6 16 64 76 de b3 00 d9  |..."...Y..dv....|
+00000080  a0 56 74 b4 10 6f 7f e4  b6 d1 60 14 03 03 00 01  |.Vt..o....`.....|
+00000090  01 16 03 03 00 40 63 b4  75 30 a8 65 b3 a5 00 59  |.....@c.u0.e...Y|
+000000a0  08 be 07 6f 6a 3d 0b 30  da 78 7d 93 69 56 0b b9  |...oj=.0.x}.iV..|
+000000b0  37 27 48 fc 50 b4 90 7c  4a d3 4b 0c a5 1e b5 1a  |7'H.P..|J.K.....|
+000000c0  2b 55 7f 32 04 0d 38 ac  16 3b 49 df ca 2e 9b 4d  |+U.2..8..;I....M|
+000000d0  c4 0e f7 77 c4 9d                                 |...w..|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 bb 72 4f bf 4a  |............rO.J|
-00000020  7d e4 3e 82 42 81 cb b8  c1 e9 88 67 31 05 29 13  |}.>.B......g1.).|
-00000030  8f ff ac 7b 36 f2 cc 60  00 6a e2 70 85 c4 a0 bb  |...{6..`.j.p....|
-00000040  01 22 70 7e 43 9d d2 13  23 a8 eb 17 03 03 00 40  |."p~C...#......@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 a1 f3 cb 74 1a  |..............t.|
+00000020  21 65 72 3e f0 50 54 fb  28 b1 dd 0f 0f ce 68 fd  |!er>.PT.(.....h.|
+00000030  a6 2b e6 0f 5e e9 99 85  c6 b8 8e 08 d6 ad 49 bc  |.+..^.........I.|
+00000040  5b 99 66 3d 31 55 f5 c8  24 8f 50 17 03 03 00 40  |[.f=1U..$.P....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  8b 59 02 df 1c 62 3e 56  47 da d1 7f 6e 24 36 9d  |.Y...b>VG...n$6.|
-00000070  85 66 ef 32 0d db b2 fc  87 ee c5 de 36 7b d0 27  |.f.2........6{.'|
-00000080  75 f4 8c e5 9f fa f8 55  5b 0e 82 c8 21 8d d7 ed  |u......U[...!...|
+00000060  40 7a c9 4b fb ec d9 86  ec 6a 6e c1 1d e3 a6 2a  |@z.K.....jn....*|
+00000070  da f8 c6 d4 32 27 bf b3  f6 ad 82 a0 e7 7d 4b f2  |....2'.......}K.|
+00000080  73 92 c6 ef 80 9a b8 84  ba 65 e5 53 01 2c 83 5f  |s........e.S.,._|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 b3 89 aa  24 6b 3e 3d d9 32 07 83  |........$k>=.2..|
-000000b0  16 06 b1 33 f6 93 0a 63  7d c2 fb 3f b3 b9 9c 64  |...3...c}..?...d|
-000000c0  aa 1b 49 16 a4                                    |..I..|
+000000a0  00 00 00 00 00 89 9d a2  ee 1c cd ee cb 79 55 e5  |.............yU.|
+000000b0  22 94 11 6c b2 b1 db 5e  0a 37 3d 92 01 01 ee 09  |"..l...^.7=.....|
+000000c0  e6 80 48 e2 c9                                    |..H..|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificateNotFound b/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificateNotFound
index f6c2dd3ef3..181a9abfc8 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificateNotFound
+++ b/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificateNotFound
@@ -1,12 +1,12 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 6e 01 00 00  6a 03 03 7d 50 c7 a7 25  |....n...j..}P..%|
-00000010  c7 a5 0a 7c 9d 79 27 13  b3 d0 c9 5c 7f 4e a2 05  |...|.y'....\.N..|
-00000020  22 5e 96 f3 9c 41 99 6e  e7 fc 6f 00 00 04 00 2f  |"^...A.n..o..../|
-00000030  00 ff 01 00 00 3d 00 00  00 10 00 0e 00 00 0b 73  |.....=.........s|
+00000000  16 03 01 00 71 01 00 00  6d 03 03 3f de 5d 94 64  |....q...m..?.].d|
+00000010  21 fd 53 6e f0 fe 81 99  4d ac 16 42 e6 92 db dd  |!.Sn....M..B....|
+00000020  36 6a d8 4e 94 c3 0a a7  3c 6a 2a 00 00 04 00 2f  |6j.N....<j*..../|
+00000030  00 ff 01 00 00 40 00 00  00 10 00 0e 00 00 0b 73  |.....@.........s|
 00000040  6e 69 74 65 73 74 2e 63  6f 6d 00 0d 00 20 00 1e  |nitest.com... ..|
 00000050  06 01 06 02 06 03 05 01  05 02 05 03 04 01 04 02  |................|
-00000060  04 03 03 01 03 02 03 03  02 01 02 02 02 03 00 0f  |................|
-00000070  00 01 01                                          |...|
+00000060  04 03 03 01 03 02 03 03  02 01 02 02 02 03 00 16  |................|
+00000070  00 00 00 17 00 00                                 |......|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 31 02 00 00  2d 03 03 00 00 00 00 00  |....1...-.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -51,31 +51,31 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 d9 17 4a 90 c5  |.............J..|
-00000010  24 1d d0 2a 55 3d 6c 1c  96 87 be 69 23 99 c5 27  |$..*U=l....i#..'|
-00000020  e9 eb fd 55 51 62 0c a0  fc da b4 29 ee 1f d0 80  |...UQb.....)....|
-00000030  09 b5 4e 10 9b 70 5e d4  9c 32 17 af 53 f3 25 ee  |..N..p^..2..S.%.|
-00000040  45 ac 40 6c c7 13 fc a4  a5 4b 59 85 8e 3b 94 14  |E.@l.....KY..;..|
-00000050  3b 65 22 b8 ce 79 f4 d7  90 73 e7 d5 f5 54 6a d3  |;e"..y...s...Tj.|
-00000060  fa ed 14 19 80 dc 02 6f  13 c2 8c e2 53 92 c7 14  |.......o....S...|
-00000070  6b 0a 5b 3c ef 3c 75 95  0c b1 07 69 8b 4f c8 65  |k.[<.<u....i.O.e|
-00000080  85 9a 2d b1 80 ca e9 65  90 69 51 14 03 03 00 01  |..-....e.iQ.....|
-00000090  01 16 03 03 00 40 09 92  4c 70 5c 39 5a 35 6b 7a  |.....@..Lp\9Z5kz|
-000000a0  ac e4 6d 5e 3a 2c c6 cd  0d a2 7b 15 4f 3f 49 28  |..m^:,....{.O?I(|
-000000b0  8e 5d 45 0d 64 18 11 b3  86 4a ac 0c fb a5 63 a3  |.]E.d....J....c.|
-000000c0  4f 08 50 01 d6 11 a4 36  3c fe 2a f5 4c a4 f4 d7  |O.P....6<.*.L...|
-000000d0  3e 8e 9e 9f 27 2d                                 |>...'-|
+00000000  16 03 03 00 86 10 00 00  82 00 80 8f 1f 52 21 82  |.............R!.|
+00000010  f8 5f 48 ca f4 17 36 2f  4b 92 d9 ee cf 73 41 97  |._H...6/K....sA.|
+00000020  25 8c e5 a5 d0 33 55 f0  e9 f1 d1 7f fd ed fc 46  |%....3U........F|
+00000030  0d a1 f8 fe 39 7b 78 39  4e 47 26 b1 c6 ce ea 34  |....9{x9NG&....4|
+00000040  f2 59 2f ea b6 21 ac 14  5f 2c 3b 36 4a 9a 89 d2  |.Y/..!.._,;6J...|
+00000050  00 df e8 e8 ba d4 dd 90  d1 98 ff 9d a0 d2 b9 c1  |................|
+00000060  a8 41 3b ed 89 40 9a 15  e8 07 e6 5a 77 d3 d4 8c  |.A;..@.....Zw...|
+00000070  a9 00 a6 5d b4 db 15 cd  59 9d ee f3 85 c0 66 12  |...]....Y.....f.|
+00000080  ba 67 fe b9 40 5b 17 80  78 35 49 14 03 03 00 01  |.g..@[..x5I.....|
+00000090  01 16 03 03 00 40 73 e4  be 74 13 2b 52 eb c6 25  |.....@s..t.+R..%|
+000000a0  b8 8d 07 e7 ad cb 13 ff  1b ab 61 e7 60 b0 d7 ec  |..........a.`...|
+000000b0  b6 35 d9 a9 82 84 79 3c  09 57 a6 d6 26 c6 54 4b  |.5....y<.W..&.TK|
+000000c0  16 c4 e1 84 df 9d 13 4f  b2 6c 95 b6 a5 2c 3d 63  |.......O.l...,=c|
+000000d0  a0 ab db c4 c6 2c                                 |.....,|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 7f ab 58 28 09  |.............X(.|
-00000020  5d 2e 89 33 e6 c6 9d 70  64 0e 7e 9f 92 02 eb f4  |]..3...pd.~.....|
-00000030  bf 87 68 b3 e8 80 21 9b  59 2b 13 a8 0c d8 6e 14  |..h...!.Y+....n.|
-00000040  3c f7 68 d1 a0 f3 a4 c7  a9 ba 37 17 03 03 00 40  |<.h.......7....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 54 ef 5e a4 7c  |...........T.^.||
+00000020  61 ca e9 6c 23 b3 7e ac  e5 dc ee a0 67 e7 b1 4a  |a..l#.~.....g..J|
+00000030  4e bd d1 6e 1b 7d 37 10  02 ba 9c 67 54 0a cb fa  |N..n.}7....gT...|
+00000040  ed c5 db 07 a3 21 9a 16  71 3d 6e 17 03 03 00 40  |.....!..q=n....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  d1 14 8b f2 9e 66 d6 6e  af 25 24 a2 40 38 70 9a  |.....f.n.%$.@8p.|
-00000070  ff c5 1f d7 19 cc 17 8d  61 c2 06 2d 09 b9 6c 79  |........a..-..ly|
-00000080  52 cd d2 ca b9 ce 9d e1  90 3a bc e2 3a 68 6e 04  |R........:..:hn.|
+00000060  a5 bd 15 cb 51 43 97 ec  6b c0 1d 29 8d 48 cb df  |....QC..k..).H..|
+00000070  d0 8b dc 1a 0b 01 d9 74  4d 22 bd 91 4c 1f b2 56  |.......tM"..L..V|
+00000080  37 23 dc 4a 33 1e a5 ff  79 80 f2 f9 c3 82 ca 67  |7#.J3...y......g|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 1e a4 03  13 f7 88 45 4b e0 55 5a  |...........EK.UZ|
-000000b0  8d 92 5f 1e 7f 4a c3 33  c4 b4 3f 41 1a ac d3 e2  |.._..J.3..?A....|
-000000c0  32 6b a9 e3 a8                                    |2k...|
+000000a0  00 00 00 00 00 72 fe 8c  2d fb dd 85 d6 c2 af 72  |.....r..-......r|
+000000b0  00 62 3c ae e1 75 6d 9f  ed e9 fa 6a b9 22 1b ba  |.b<..um....j."..|
+000000c0  df 0c d7 25 f1                                    |...%.|
