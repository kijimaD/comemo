commit df2b2eb63db3f771c41be4d97ac6fb6b0c5f8c48
Author: Joe Sylve <joe.sylve@gmail.com>
Date:   Tue Mar 22 22:11:42 2016 -0500

    runtime: improve last ditch signal forwarding for Unix libraries
    
    The current runtime attempts to forward signals generated by non-Go
    code to the original signal handler.  If it can't call the original
    handler directly, it currently attempts to re-raise the signal after
    resetting the handler.  In this case, the original context is lost.
    
    This fix prevents that problem by simply returning from the go signal
    handler after resetting the original handler.  It only does this when
    the original handler is the system default handler, which in all cases
    is known to not recover.  The signal is not reset, so it is retriggered
    and the original handler takes over with the proper context.
    
    Fixes #14899
    
    Change-Id: Ib1c19dfa4b50d9732d7a453de3784c8141e1cbb3
    Reviewed-on: https://go-review.googlesource.com/21006
    Reviewed-by: Ian Lance Taylor <iant@golang.org>

 misc/cgo/testcarchive/carchive_test.go | 123 +++++++++++++++++++++++++++++++++
 misc/cgo/testcarchive/main5.c          |  63 +++++++++++++++++
 src/runtime/os1_nacl.go                |  16 +++++
 src/runtime/signal1_unix.go            |  35 +++++++++-
 src/runtime/signal_darwin.go           |   2 +-
 src/runtime/signal_freebsd.go          |   2 +-
 src/runtime/signal_openbsd.go          |   2 +-
 src/runtime/signal_sigtramp.go         |   2 +-
 src/runtime/signal_solaris_amd64.go    |   4 ++
 src/runtime/sigqueue.go                |  18 +----
 src/runtime/sys_solaris_amd64.s        |   5 ++
 11 files changed, 249 insertions(+), 23 deletions(-)
