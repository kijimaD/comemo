commit 7b0dfb177f3ae81641af898bb5479256fb21fd5d
Author: Cherry Zhang <cherryyz@google.com>
Date:   Thu Feb 4 12:40:04 2021 -0500

    [dev.regabi] runtime: use g register in some assembly functions on AMD64
    
    Now that we have a g register, just use it.
    
    Note: functions that can be called from ABI0 context (e.g.
    morestack) is unchanged. Functions that switch g is also
    unchanged, because we need to set the new g in both the register
    and TLS.
    
    TODO: other OSes.
    
    Change-Id: I692a82a7caa8417ff620a59676a6275f56747b94
    Reviewed-on: https://go-review.googlesource.com/c/go/+/289718
    Trust: Cherry Zhang <cherryyz@google.com>
    Run-TryBot: Cherry Zhang <cherryyz@google.com>
    TryBot-Result: Go Bot <gobot@golang.org>
    Reviewed-by: Michael Knyszek <mknyszek@google.com>

 src/runtime/asm_amd64.s       | 22 ++++++++++++++--------
 src/runtime/race_amd64.s      | 12 ++++++++++++
 src/runtime/sys_linux_amd64.s | 16 ++++++++++++++++
 3 files changed, 42 insertions(+), 8 deletions(-)
