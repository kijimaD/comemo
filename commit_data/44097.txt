commit 6d7c2459ad1dfb694f92ec76ab239e99866e65c4
Merge: 85298173f6 4f65fb3b30
Author: Cherry Zhang <cherryyz@google.com>
Date:   Fri May 8 15:23:49 2020 -0400

    [dev.link] all: merge branch 'master' into dev.link
    
    Clean merge.
    
    Change-Id: I6a39d0c00c7455ad0ce3dfe582a5f16d85857f51

 CONTRIBUTORS                                       |    2 +-
 src/cmd/compile/internal/gc/builtin.go             |  626 +++++-----
 src/cmd/compile/internal/gc/builtin/runtime.go     |    2 +
 src/cmd/compile/internal/gc/fmt.go                 |  176 +--
 src/cmd/compile/internal/gc/iimport.go             |    3 +-
 src/cmd/compile/internal/gc/op_string.go           |  161 +--
 src/cmd/compile/internal/gc/order.go               |   76 +-
 src/cmd/compile/internal/gc/sinit.go               |    3 +
 src/cmd/compile/internal/gc/syntax.go              |   60 +-
 src/cmd/compile/internal/gc/typecheck.go           |   43 +
 src/cmd/compile/internal/gc/walk.go                |   60 +
 src/cmd/compile/internal/ssa/gen/AMD64.rules       |   39 +-
 src/cmd/compile/internal/ssa/gen/ARM64.rules       |  429 +++----
 src/cmd/compile/internal/ssa/gen/ARM64Ops.go       |    2 +-
 src/cmd/compile/internal/ssa/gen/PPC64.rules       |    2 +-
 src/cmd/compile/internal/ssa/rewriteAMD64.go       |  186 +--
 src/cmd/compile/internal/ssa/rewriteARM64.go       | 1296 +++++++++++---------
 src/cmd/compile/internal/ssa/rewritePPC64.go       |    4 +
 src/cmd/go.mod                                     |   13 +-
 src/cmd/go.sum                                     |   28 +-
 src/cmd/go/internal/load/pkg.go                    |   83 +-
 src/cmd/go/internal/load/test.go                   |    2 +-
 src/cmd/go/internal/modload/load.go                |   17 +-
 src/cmd/go/internal/modload/query.go               |   12 +-
 src/cmd/go/internal/work/security.go               |    2 +
 src/cmd/go/internal/work/security_test.go          |    2 +
 .../mod/example.com_incompatiblewithsub_v1.0.0.txt |    8 +
 ...com_incompatiblewithsub_v2.0.0+incompatible.txt |    8 +
 src/cmd/go/testdata/script/list_case_collision.txt |   10 +-
 .../script/mod_get_prefer_incompatible.txt         |   29 +
 src/cmd/internal/obj/arm64/asm7.go                 |   31 +-
 src/cmd/internal/obj/arm64/doc.go                  |    2 +-
 src/cmd/internal/obj/mips/asm0.go                  |   25 +-
 src/cmd/internal/obj/plist.go                      |   66 +-
 src/cmd/internal/obj/riscv/obj.go                  |    2 +-
 src/cmd/internal/obj/s390x/asmz.go                 |    2 +-
 src/cmd/internal/obj/x86/asm6.go                   |    2 +-
 src/cmd/internal/objabi/funcdata.go                |   11 +
 src/cmd/link/internal/ld/data.go                   |    2 +-
 src/cmd/link/internal/ld/deadcode_test.go          |    1 +
 src/cmd/link/internal/ppc64/asm.go                 |    5 -
 .../github.com/ianlancetaylor/demangle/demangle.go |    1 +
 src/cmd/vendor/golang.org/x/mod/modfile/print.go   |   25 +-
 src/cmd/vendor/golang.org/x/mod/modfile/read.go    |  319 ++---
 src/cmd/vendor/golang.org/x/mod/modfile/rule.go    |  154 ++-
 src/cmd/vendor/golang.org/x/mod/zip/zip.go         |   20 +-
 .../x/sys/internal/unsafeheader/unsafeheader.go    |   30 +
 src/cmd/vendor/golang.org/x/sys/unix/README.md     |    4 +-
 src/cmd/vendor/golang.org/x/sys/unix/mkerrors.sh   |    8 +-
 .../golang.org/x/sys/unix/syscall_darwin.1_13.go   |   21 +-
 .../vendor/golang.org/x/sys/unix/syscall_linux.go  |   13 +-
 .../golang.org/x/sys/unix/syscall_linux_386.go     |    2 +-
 .../golang.org/x/sys/unix/syscall_linux_amd64.go   |    2 +-
 .../golang.org/x/sys/unix/syscall_linux_arm.go     |    2 +-
 .../golang.org/x/sys/unix/syscall_linux_arm64.go   |   28 +-
 .../golang.org/x/sys/unix/syscall_linux_mips64x.go |    2 +-
 .../golang.org/x/sys/unix/syscall_linux_mipsx.go   |    2 +-
 .../golang.org/x/sys/unix/syscall_linux_ppc64x.go  |    2 +-
 .../golang.org/x/sys/unix/syscall_linux_riscv64.go |    8 +-
 .../golang.org/x/sys/unix/syscall_linux_s390x.go   |    2 +-
 .../golang.org/x/sys/unix/syscall_linux_sparc64.go |    2 +-
 .../vendor/golang.org/x/sys/unix/syscall_unix.go   |   17 +-
 .../vendor/golang.org/x/sys/unix/zerrors_linux.go  |   27 +-
 .../golang.org/x/sys/unix/zerrors_linux_386.go     |    4 +
 .../golang.org/x/sys/unix/zerrors_linux_amd64.go   |    4 +
 .../golang.org/x/sys/unix/zerrors_linux_arm.go     |    4 +
 .../golang.org/x/sys/unix/zerrors_linux_arm64.go   |    4 +
 .../golang.org/x/sys/unix/zerrors_linux_mips.go    |    4 +
 .../golang.org/x/sys/unix/zerrors_linux_mips64.go  |    4 +
 .../x/sys/unix/zerrors_linux_mips64le.go           |    4 +
 .../golang.org/x/sys/unix/zerrors_linux_mipsle.go  |    4 +
 .../golang.org/x/sys/unix/zerrors_linux_ppc64.go   |    4 +
 .../golang.org/x/sys/unix/zerrors_linux_ppc64le.go |    4 +
 .../golang.org/x/sys/unix/zerrors_linux_riscv64.go |    4 +
 .../golang.org/x/sys/unix/zerrors_linux_s390x.go   |    4 +
 .../golang.org/x/sys/unix/zerrors_linux_sparc64.go |    4 +
 .../vendor/golang.org/x/sys/unix/zsyscall_linux.go |   31 +
 .../golang.org/x/sys/unix/zsyscall_linux_386.go    |    2 +-
 .../golang.org/x/sys/unix/zsyscall_linux_amd64.go  |    2 +-
 .../golang.org/x/sys/unix/zsyscall_linux_arm.go    |    2 +-
 .../golang.org/x/sys/unix/zsyscall_linux_arm64.go  |    4 +-
 .../golang.org/x/sys/unix/zsyscall_linux_mips.go   |    2 +-
 .../golang.org/x/sys/unix/zsyscall_linux_mips64.go |    2 +-
 .../x/sys/unix/zsyscall_linux_mips64le.go          |    2 +-
 .../golang.org/x/sys/unix/zsyscall_linux_mipsle.go |    2 +-
 .../golang.org/x/sys/unix/zsyscall_linux_ppc64.go  |    2 +-
 .../x/sys/unix/zsyscall_linux_ppc64le.go           |    2 +-
 .../golang.org/x/sys/unix/zsyscall_linux_s390x.go  |    2 +-
 .../x/sys/unix/zsyscall_linux_sparc64.go           |    2 +-
 .../golang.org/x/sys/unix/zsysnum_linux_386.go     |    2 +
 .../golang.org/x/sys/unix/zsysnum_linux_amd64.go   |    2 +
 .../golang.org/x/sys/unix/zsysnum_linux_arm.go     |    2 +
 .../golang.org/x/sys/unix/zsysnum_linux_arm64.go   |    2 +
 .../golang.org/x/sys/unix/zsysnum_linux_mips.go    |    2 +
 .../golang.org/x/sys/unix/zsysnum_linux_mips64.go  |    2 +
 .../x/sys/unix/zsysnum_linux_mips64le.go           |    2 +
 .../golang.org/x/sys/unix/zsysnum_linux_mipsle.go  |    2 +
 .../golang.org/x/sys/unix/zsysnum_linux_ppc64.go   |    2 +
 .../golang.org/x/sys/unix/zsysnum_linux_ppc64le.go |    2 +
 .../golang.org/x/sys/unix/zsysnum_linux_riscv64.go |    2 +
 .../golang.org/x/sys/unix/zsysnum_linux_s390x.go   |    2 +
 .../golang.org/x/sys/unix/zsysnum_linux_sparc64.go |    2 +
 .../vendor/golang.org/x/sys/unix/ztypes_linux.go   |   56 +-
 .../golang.org/x/sys/unix/ztypes_linux_386.go      |    1 +
 .../golang.org/x/sys/unix/ztypes_linux_amd64.go    |    1 +
 .../golang.org/x/sys/unix/ztypes_linux_arm.go      |    1 +
 .../golang.org/x/sys/unix/ztypes_linux_arm64.go    |    1 +
 .../golang.org/x/sys/unix/ztypes_linux_mips.go     |    1 +
 .../golang.org/x/sys/unix/ztypes_linux_mips64.go   |    1 +
 .../golang.org/x/sys/unix/ztypes_linux_mips64le.go |    1 +
 .../golang.org/x/sys/unix/ztypes_linux_mipsle.go   |    1 +
 .../golang.org/x/sys/unix/ztypes_linux_ppc64.go    |    1 +
 .../golang.org/x/sys/unix/ztypes_linux_ppc64le.go  |    1 +
 .../golang.org/x/sys/unix/ztypes_linux_riscv64.go  |    1 +
 .../golang.org/x/sys/unix/ztypes_linux_s390x.go    |    1 +
 .../golang.org/x/sys/unix/ztypes_linux_sparc64.go  |    1 +
 .../golang.org/x/tools/go/analysis/analysis.go     |   16 +
 .../go/analysis/internal/analysisflags/flags.go    |    2 +-
 .../x/tools/go/analysis/passes/printf/printf.go    |   62 +-
 .../go/analysis/passes/unreachable/unreachable.go  |   13 +-
 .../x/tools/go/ast/inspector/inspector.go          |    6 +-
 .../x/tools/internal/analysisinternal/analysis.go  |  118 ++
 src/cmd/vendor/modules.txt                         |   15 +-
 src/crypto/ecdsa/ecdsa.go                          |   14 +
 src/crypto/ecdsa/equal_test.go                     |   17 +-
 src/crypto/ed25519/ed25519.go                      |   12 +
 src/crypto/ed25519/ed25519_test.go                 |   12 +-
 src/crypto/elliptic/elliptic.go                    |   74 +-
 src/crypto/elliptic/elliptic_test.go               |   72 ++
 src/crypto/hmac/hmac.go                            |   80 +-
 src/crypto/hmac/hmac_test.go                       |   13 +-
 src/crypto/rsa/equal_test.go                       |   17 +-
 src/crypto/rsa/pkcs1v15.go                         |   20 +-
 src/crypto/rsa/pss.go                              |   17 +-
 src/crypto/rsa/rsa.go                              |   56 +-
 src/crypto/tls/common.go                           |  220 ++--
 src/crypto/tls/conn.go                             |   48 +-
 src/crypto/tls/handshake_client.go                 |   85 +-
 src/crypto/tls/handshake_client_test.go            |  209 +++-
 src/crypto/tls/handshake_client_tls13.go           |   84 +-
 src/crypto/tls/handshake_messages_test.go          |    9 +-
 src/crypto/tls/handshake_server.go                 |   64 +-
 src/crypto/tls/handshake_server_test.go            |   14 +-
 src/crypto/tls/handshake_server_tls13.go           |   10 +-
 src/crypto/tls/key_schedule.go                     |    7 +-
 .../testdata/Server-TLSv10-ExportKeyingMaterial    |   83 +-
 src/crypto/tls/testdata/Server-TLSv12-ALPN         |   83 +-
 src/crypto/tls/testdata/Server-TLSv12-ALPN-NoMatch |   83 +-
 .../testdata/Server-TLSv12-ExportKeyingMaterial    |   81 +-
 src/crypto/tls/testdata/Server-TLSv12-IssueTicket  |  167 ++-
 .../testdata/Server-TLSv12-IssueTicketPreDisable   |  167 ++-
 src/crypto/tls/testdata/Server-TLSv12-Resume       |   82 +-
 src/crypto/tls/ticket.go                           |  120 +-
 src/crypto/tls/tls_test.go                         |   13 +-
 src/crypto/x509/internal/macOS/corefoundation.go   |  141 +++
 src/crypto/x509/internal/macOS/corefoundation.s    |   26 +
 src/crypto/x509/internal/macOS/security.go         |  116 ++
 src/crypto/x509/internal/macOS/security.s          |   16 +
 ...root_cgo_darwin.go => root_cgo_darwin_amd64.go} |   12 +-
 src/crypto/x509/root_darwin.go                     |  288 -----
 src/crypto/x509/root_darwin_amd64.go               |  222 ++++
 src/crypto/x509/root_darwin_arm64.go               |   13 +-
 ..._darwin_arm_gen.go => root_darwin_arm64_gen.go} |   16 +-
 src/crypto/x509/root_darwin_test.go                |   98 +-
 src/crypto/x509/root_nocgo_darwin.go               |   11 -
 src/crypto/x509/root_omit.go                       |    7 +
 src/crypto/x509/root_unix.go                       |   29 +-
 src/crypto/x509/root_unix_test.go                  |   27 +
 src/crypto/x509/sec1.go                            |    7 +-
 src/crypto/x509/verify.go                          |  112 +-
 src/crypto/x509/verify_test.go                     |   43 +-
 src/crypto/x509/x509_test.go                       |  121 +-
 src/database/sql/sql.go                            |    5 +-
 src/encoding/asn1/asn1.go                          |    6 +
 src/encoding/asn1/asn1_test.go                     |   12 +
 src/encoding/asn1/marshal.go                       |   56 +
 src/encoding/asn1/marshal_test.go                  |   57 +
 src/encoding/csv/writer.go                         |   16 +-
 src/encoding/csv/writer_test.go                    |   17 +
 src/encoding/json/decode.go                        |   45 +-
 src/encoding/json/decode_test.go                   |   48 +-
 src/encoding/json/encode.go                        |   11 +-
 src/encoding/json/encode_test.go                   |   87 +-
 src/encoding/json/stream_test.go                   |    8 +-
 src/go.mod                                         |    7 +-
 src/go.sum                                         |   12 +-
 src/go/build/deps_test.go                          |    7 +-
 src/math/big/int.go                                |   15 +
 src/math/big/int_test.go                           |   54 +
 src/math/big/nat.go                                |   15 +-
 src/math/dim_riscv64.s                             |   70 ++
 src/math/stubs_riscv64.s                           |    6 -
 src/net/http/cgi/host.go                           |   10 +-
 src/net/http/cookie.go                             |   11 +-
 src/net/http/fs.go                                 |    4 +-
 src/net/http/httptest/recorder.go                  |    3 +-
 src/net/http/httputil/reverseproxy.go              |    3 +-
 src/net/http/httputil/reverseproxy_test.go         |   13 +-
 src/net/http/response_test.go                      |    1 +
 src/net/http/serve_test.go                         |   31 -
 src/net/http/transfer.go                           |  117 +-
 src/net/http/transfer_test.go                      |   22 +-
 src/net/http/transport.go                          |    2 +-
 src/reflect/all_test.go                            |   37 +-
 src/reflect/value.go                               |    5 +-
 src/runtime/asm_riscv64.s                          |    2 +-
 src/runtime/conv_wasm_test.go                      |  128 ++
 src/runtime/export_test.go                         |   19 +-
 src/runtime/extern.go                              |    7 +-
 src/runtime/lock_futex.go                          |    2 +-
 src/runtime/lock_js.go                             |    2 +-
 src/runtime/lock_sema.go                           |    2 +-
 src/runtime/lockrank.go                            |   25 +-
 src/runtime/lockrank_off.go                        |   12 +-
 src/runtime/lockrank_on.go                         |  104 +-
 src/runtime/malloc.go                              |    9 +-
 src/runtime/mgcscavenge.go                         |  343 ++++--
 src/runtime/mgcscavenge_test.go                    |    6 +-
 src/runtime/mgcsweep.go                            |    6 +-
 src/runtime/mheap.go                               |   32 +-
 src/runtime/mpagealloc.go                          |  173 +--
 src/runtime/mpagealloc_64bit.go                    |   12 +-
 src/runtime/mpagecache.go                          |   12 +-
 src/runtime/mranges.go                             |  186 ++-
 src/runtime/os_windows.go                          |   33 +-
 src/runtime/preempt.go                             |   53 +-
 src/runtime/proc.go                                |   20 +-
 src/runtime/runtime2.go                            |   12 +-
 src/runtime/signal_386.go                          |    9 +-
 src/runtime/signal_amd64.go                        |    9 +-
 src/runtime/signal_arm.go                          |    6 +-
 src/runtime/signal_arm64.go                        |    6 +-
 src/runtime/signal_linux_s390x.go                  |    6 +-
 src/runtime/signal_mips64x.go                      |    6 +-
 src/runtime/signal_mipsx.go                        |    6 +-
 src/runtime/signal_ppc64x.go                       |    6 +-
 src/runtime/signal_riscv64.go                      |    6 +-
 src/runtime/signal_unix.go                         |    8 +-
 src/runtime/sizeof_test.go                         |    1 +
 src/runtime/slice.go                               |   49 +
 src/runtime/slice_test.go                          |   78 ++
 src/runtime/stack.go                               |   22 +-
 src/runtime/symtab.go                              |   53 +-
 src/runtime/sys_darwin.go                          |   17 +-
 src/runtime/sys_darwin_amd64.s                     |   26 +
 src/runtime/sys_wasm.s                             |    6 +-
 src/strconv/atoc.go                                |  105 ++
 src/strconv/atoc_test.go                           |  195 +++
 src/strconv/atof.go                                |    4 +-
 src/strconv/atoi.go                                |    2 +-
 src/strconv/ctoa.go                                |   27 +
 src/testing/helper_test.go                         |    2 +
 src/testing/helperfuncs_test.go                    |   11 +
 src/testing/testing.go                             |   35 +-
 .../golang.org/x/crypto/chacha20/chacha_generic.go |  119 +-
 src/vendor/golang.org/x/crypto/chacha20/xor.go     |   17 +-
 .../chacha20poly1305/chacha20poly1305_generic.go   |   56 +-
 src/vendor/golang.org/x/crypto/cryptobyte/asn1.go  |    2 +-
 .../golang.org/x/crypto/poly1305/mac_noasm.go      |    4 +-
 .../golang.org/x/crypto/poly1305/poly1305.go       |   26 +-
 .../golang.org/x/crypto/poly1305/sum_amd64.go      |   11 -
 .../golang.org/x/crypto/poly1305/sum_generic.go    |   21 +-
 .../golang.org/x/crypto/poly1305/sum_noasm.go      |   13 -
 .../golang.org/x/crypto/poly1305/sum_ppc64le.go    |   11 -
 .../golang.org/x/crypto/poly1305/sum_s390x.go      |   72 +-
 .../golang.org/x/crypto/poly1305/sum_s390x.s       |  667 ++++++----
 .../golang.org/x/crypto/poly1305/sum_vmsl_s390x.s  |  909 --------------
 src/vendor/golang.org/x/text/unicode/bidi/core.go  |    8 +-
 src/vendor/modules.txt                             |    7 +-
 test/codegen/slices.go                             |  183 +++
 test/fixedbugs/issue38690.go                       |   65 +
 test/fixedbugs/issue38746.go                       |   17 +
 test/makeslice.go                                  |  149 +++
 273 files changed, 8106 insertions(+), 4963 deletions(-)

