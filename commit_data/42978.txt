commit 18053b7131fff206b11c73bd1db3b024f4d0589e
Author: Josh Bleecher Snyder <josharian@gmail.com>
Date:   Tue Dec 31 23:12:33 2019 -0800

    cmd/compile: optimize unsigned comparisons to 0/1 on amd64
    
    Plus a bonus optimization I noticed while working on this.
    
    There are no functions (besides the rewrite rules) whose text size
    increases as a result of this change.
    
    Updates #21439
    
    The following per-package text size stats were generated by parsing the
    output of compiling with -S and summing the function size reported on the
    STEXT line. This gives a far more accurate picture of the impact
    on generated code than merely looking at the object file size changes
    or the resulting binary size changes. The latter are below, for reference.
    
    file                                          before  after   Δ       %
    runtime.s                                     477257  476417  -840    -0.176%
    math.s                                        35985   35976   -9      -0.025%
    vendor/golang.org/x/net/dns/dnsmessage.s      87314   87232   -82     -0.094%
    debug/dwarf.s                                 108444  108432  -12     -0.011%
    regexp.s                                      64535   64467   -68     -0.105%
    internal/xcoff.s                              23175   22945   -230    -0.992%
    cmd/vendor/golang.org/x/arch/arm/armasm.s     45263   45260   -3      -0.007%
    cmd/vendor/golang.org/x/arch/arm64/arm64asm.s 118140  118135  -5      -0.004%
    cmd/internal/obj/arm64.s                      151502  151498  -4      -0.003%
    cmd/compile/internal/ssa.s                    6061483 6063120 +1637   +0.027%
    total                                         9321728 9322112 +384    +0.004%
    
    file      before    after     Δ       %
    go        15188916  15184820  -4096   -0.027%
    addr2line 4315984   4311888   -4096   -0.095%
    cgo       4836088   4831992   -4096   -0.085%
    compile   24506008  24493720  -12288  -0.050%
    doc       4680952   4676856   -4096   -0.088%
    link      6605336   6601240   -4096   -0.062%
    pprof     14776756  14772660  -4096   -0.028%
    total     135250956 135214092 -36864  -0.027%
    
    Change-Id: I1243a098a08db452f7d1eb0998e241c9b199e2b4
    Reviewed-on: https://go-review.googlesource.com/c/go/+/213058
    Run-TryBot: Josh Bleecher Snyder <josharian@gmail.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Keith Randall <khr@golang.org>

 src/cmd/compile/internal/ssa/gen/AMD64.rules |   8 +
 src/cmd/compile/internal/ssa/rewriteAMD64.go | 224 +++++++++++++++++++++++++++
 2 files changed, 232 insertions(+)
