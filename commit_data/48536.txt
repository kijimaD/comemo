commit 2fed6926a152d67b5d001d68899edc5e97d599f1
Author: Katie Hockman <katie@golang.org>
Date:   Tue May 25 11:10:25 2021 -0400

    [dev.fuzz] cmd/go/internal: instrument imports of the test
    
    Previously, the packages that were imported by the
    test were not instrumented for coverage. This meant
    that a fuzz target in a stand-alone test file would
    not be able to perform coverage-guided fuzzing.
    
    The fix uses all of the imports, including those
    from the test files, when determining which packages
    to instrument. However, certain package should
    be ignored when walking the import graph. Otherwise,
    packages like internal/fuzz, and its imports, may be
    instrumented, which could lead to false positives for
    "interesting" corpus values.
    
    There was an additional bug which needed to be fixed
    in order for this to work. The bug was in the fact that
    the GcFlags which held `-d=libfuzzer` were being
    overwritten in some cases. The fix updates the way these
    flags are set in order to prevent this behavior.
    
    Change-Id: I21d336c29a33db1181bbae0fd23678d127fe52a0
    Reviewed-on: https://go-review.googlesource.com/c/go/+/321960
    Trust: Katie Hockman <katie@golang.org>
    Run-TryBot: Katie Hockman <katie@golang.org>
    TryBot-Result: Go Bot <gobot@golang.org>
    Reviewed-by: Jay Conrod <jayconrod@google.com>

 src/cmd/go/internal/load/flag.go |  5 +++--
 src/cmd/go/internal/load/pkg.go  | 25 +++++++++++++------------
 src/cmd/go/internal/test/test.go | 16 +++++++++++++---
 3 files changed, 29 insertions(+), 17 deletions(-)
