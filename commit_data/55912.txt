commit 34d28ba932cc26af9ae6c0233f4967a9b7cd94c2
Author: qmuntal <quimmuntal@gmail.com>
Date:   Fri Mar 8 11:19:14 2024 +0100

    internal/syscall/windows: implement SupportUnixSocket by enumerating protocols
    
    windows.SupportUnixSocket is currently implemented using a Windows
    version check. This approach is not reliable, see #27943 and #28061.
    Also, it uses the undocumented RtlGetNtVersionNumbers API, which
    we should try to avoid.
    
    This PR implements SupportUnixSocket by enumerating the available
    protocols and checking for AF_UNIX support.
    
    Cq-Include-Trybots: luci.golang.try:gotip-windows-arm64
    Change-Id: I76cd635067309f09571ad0eac4a5699450a2709a
    Reviewed-on: https://go-review.googlesource.com/c/go/+/570075
    Reviewed-by: Cherry Mui <cherryyz@google.com>
    Reviewed-by: Alex Brainman <alex.brainman@gmail.com>
    Reviewed-by: Bryan Mills <bcmills@google.com>
    LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>

 src/internal/syscall/windows/syscall_windows.go    |  4 ++-
 src/internal/syscall/windows/version_windows.go    | 22 ++++++++++++---
 .../syscall/windows/version_windows_test.go        | 31 ++++++++++++++++++++++
 src/net/unixsock_windows_test.go                   | 20 ++++----------
 4 files changed, 58 insertions(+), 19 deletions(-)
