commit ab7a65f2837b693f015f47572b6bf2c8f1062288
Author: Michael Munday <mike.munday@ibm.com>
Date:   Mon Feb 17 03:43:33 2020 -0800

    cmd/compile: clean up codegen for branch-on-carry on s390x
    
    This CL optimizes code that uses a carry from a function such as
    bits.Add64 as the condition in an if statement. For example:
    
        x, c := bits.Add64(a, b, 0)
        if c != 0 {
            panic("overflow")
        }
    
    Rather than converting the carry into a 0 or a 1 value and using
    that as an input to a comparison instruction the carry flag is now
    used as the input to a conditional branch directly. This typically
    removes an ADD LOGICAL WITH CARRY instruction when user code is
    doing overflow detection and is closer to the code that a user
    would expect to generate.
    
    Change-Id: I950431270955ab72f1b5c6db873b6abe769be0da
    Reviewed-on: https://go-review.googlesource.com/c/go/+/219757
    Run-TryBot: Michael Munday <mike.munday@ibm.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Keith Randall <khr@golang.org>

 src/cmd/compile/internal/ssa/gen/S390X.rules |  14 +
 src/cmd/compile/internal/ssa/rewriteS390X.go | 460 +++++++++++++++++++++++++++
 src/cmd/internal/obj/s390x/condition_code.go |   6 +
 src/math/bits/bits_test.go                   | 124 ++++++++
 test/codegen/mathbits.go                     | 126 ++++++++
 5 files changed, 730 insertions(+)
