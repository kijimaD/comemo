commit b986f3e3b54499e63903405c90aa6a0abe93ad7a
Merge: bceb18e498 a91c2e0d2d
Author: Russ Cox <rsc@golang.org>
Date:   Mon Feb 23 16:50:05 2015 -0500

    all: merge dev.cc (a91c2e0) into master
    
    This change deletes the C implementations of
    the Go compiler and assembler from the master branch.
    
    The Go implementations are a bit slower right now,
    due mainly to garbage generated by taking addresses
    of stack variables all over the place (it was C code,
    after all). That will be cleaned up (mechanically) over the
    next week or so, and things will get faster.
    
    Change-Id: I66b2b3477aec8835f9960d0798f5752dcd98d08f

 .gitignore                                  |     5 +-
 doc/go1.5.txt                               |    19 +
 include/libc.h                              |     2 +
 include/link.h                              |     3 +
 include/plan9/libc.h                        |     4 +
 misc/cgo/test/issue9400/asm_arm.s           |     2 +-
 misc/nacl/testzip.proto                     |    14 +
 src/cmd/5a/Makefile                         |    10 -
 src/cmd/5a/a.h                              |   173 -
 src/cmd/5a/a.y                              |   385 +-
 src/cmd/5a/doc.go                           |    20 -
 src/cmd/5a/lex.c                            |   538 --
 src/cmd/5a/lex.go                           |   371 +
 src/cmd/5a/y.go                             |  1362 ++++
 src/cmd/5a/y.tab.c                          |  2855 -------
 src/cmd/5a/y.tab.h                          |   166 -
 src/cmd/5g/Makefile                         |     5 -
 src/cmd/5g/cgen.c                           |  1840 -----
 src/cmd/5g/cgen.go                          |  2006 +++++
 src/cmd/5g/cgen64.c                         |   760 --
 src/cmd/5g/cgen64.go                        |   859 +++
 src/cmd/5g/doc.go                           |    15 -
 src/cmd/5g/galign.c                         |    87 -
 src/cmd/5g/galign.go                        |    85 +
 src/cmd/5g/gg.go                            |    32 +
 src/cmd/5g/gg.h                             |   177 -
 src/cmd/5g/ggen.c                           |   751 --
 src/cmd/5g/ggen.go                          |   779 ++
 src/cmd/5g/gsubr.c                          |  1527 ----
 src/cmd/5g/gsubr.go                         |  1385 ++++
 src/cmd/5g/peep.c                           |  1619 ----
 src/cmd/5g/peep.go                          |  1830 +++++
 src/cmd/5g/prog.c                           |   160 -
 src/cmd/5g/prog.go                          |   163 +
 src/cmd/5g/{reg.c => reg.go}                |    92 +-
 src/cmd/5g/util.go                          |    12 +
 src/cmd/6a/Makefile                         |    10 -
 src/cmd/6a/a.h                              |   188 -
 src/cmd/6a/a.y                              |   383 +-
 src/cmd/6a/doc.go                           |    20 -
 src/cmd/6a/lex.c                            |  1137 ---
 src/cmd/6a/lex.go                           |   978 +++
 src/cmd/6a/y.go                             |  1330 ++++
 src/cmd/6a/y.tab.c                          |  2800 -------
 src/cmd/6a/y.tab.h                          |   139 -
 src/cmd/6g/Makefile                         |     5 -
 src/cmd/6g/cgen.c                           |  1745 -----
 src/cmd/6g/cgen.go                          |  1893 +++++
 src/cmd/6g/doc.go                           |    15 -
 src/cmd/6g/galign.c                         |   110 -
 src/cmd/6g/galign.go                        |   110 +
 src/cmd/6g/gg.go                            |    24 +
 src/cmd/6g/gg.h                             |   176 -
 src/cmd/6g/ggen.c                           |  1046 ---
 src/cmd/6g/ggen.go                          |  1123 +++
 src/cmd/6g/gsubr.c                          |  1737 -----
 src/cmd/6g/gsubr.go                         |  1481 ++++
 src/cmd/6g/peep.c                           |   988 ---
 src/cmd/6g/peep.go                          |  1051 +++
 src/cmd/6g/prog.c                           |   318 -
 src/cmd/6g/prog.go                          |   272 +
 src/cmd/6g/{reg.c => reg.go}                |   125 +-
 src/cmd/6g/util.go                          |    12 +
 src/cmd/8a/Makefile                         |    10 -
 src/cmd/8a/a.h                              |   186 -
 src/cmd/8a/a.y                              |   381 +-
 src/cmd/8a/doc.go                           |    21 -
 src/cmd/8a/lex.c                            |   914 ---
 src/cmd/8a/lex.go                           |   771 ++
 src/cmd/8a/y.go                             |  1308 ++++
 src/cmd/8a/y.tab.c                          |  2778 -------
 src/cmd/8a/y.tab.h                          |   135 -
 src/cmd/8g/Makefile                         |     5 -
 src/cmd/8g/cgen.c                           |  1590 ----
 src/cmd/8g/cgen.go                          |  1732 +++++
 src/cmd/8g/cgen64.c                         |   549 --
 src/cmd/8g/cgen64.go                        |   601 ++
 src/cmd/8g/doc.go                           |    15 -
 src/cmd/8g/galign.c                         |    87 -
 src/cmd/8g/galign.go                        |    85 +
 src/cmd/8g/gg.go                            |    34 +
 src/cmd/8g/gg.h                             |   189 -
 src/cmd/8g/ggen.c                           |  1165 ---
 src/cmd/8g/ggen.go                          |  1235 +++
 src/cmd/8g/gsubr.c                          |  1874 -----
 src/cmd/8g/gsubr.go                         |  1918 +++++
 src/cmd/8g/peep.c                           |   773 --
 src/cmd/8g/peep.go                          |   825 ++
 src/cmd/8g/prog.c                           |   349 -
 src/cmd/8g/prog.go                          |   291 +
 src/cmd/8g/{reg.c => reg.go}                |   128 +-
 src/cmd/8g/util.go                          |    12 +
 src/cmd/9a/Makefile                         |    10 -
 src/cmd/9a/a.h                              |   171 -
 src/cmd/9a/a.y                              |   548 +-
 src/cmd/9a/doc.go                           |    21 -
 src/cmd/9a/lex.c                            |   726 --
 src/cmd/9a/lex.go                           |   555 ++
 src/cmd/9a/y.go                             |  1953 +++++
 src/cmd/9a/y.tab.c                          |  3469 ---------
 src/cmd/9a/y.tab.h                          |   190 -
 src/cmd/9g/cgen.c                           |  1758 -----
 src/cmd/9g/cgen.go                          |  1894 +++++
 src/cmd/9g/doc.go                           |    16 -
 src/cmd/9g/galign.c                         |    94 -
 src/cmd/9g/galign.go                        |    93 +
 src/cmd/9g/gg.go                            |    28 +
 src/cmd/9g/gg.h                             |   169 -
 src/cmd/9g/ggen.c                           |   965 ---
 src/cmd/9g/ggen.go                          |   890 +++
 src/cmd/9g/gsubr.c                          |  1158 ---
 src/cmd/9g/gsubr.go                         |  1145 +++
 src/cmd/9g/opt.go                           |    42 +
 src/cmd/9g/opt.h                            |    13 -
 src/cmd/9g/peep.c                           |   959 ---
 src/cmd/9g/peep.go                          |  1057 +++
 src/cmd/9g/prog.c                           |   308 -
 src/cmd/9g/prog.go                          |   314 +
 src/cmd/9g/{reg.c => reg.go}                |    88 +-
 src/cmd/9g/util.go                          |    12 +
 src/cmd/asm/internal/arch/arch.go           |   418 ++
 src/cmd/asm/internal/arch/arm.go            |   203 +
 src/cmd/asm/internal/arch/ppc64.go          |    87 +
 src/cmd/asm/internal/asm/asm.go             |   669 ++
 src/cmd/asm/internal/asm/endtoend_test.go   |    83 +
 src/cmd/asm/internal/asm/expr_test.go       |    73 +
 src/cmd/asm/internal/asm/operand_test.go    |   404 +
 src/cmd/asm/internal/asm/parse.go           |   951 +++
 src/cmd/asm/internal/asm/testdata/amd64.out |    56 +
 src/cmd/asm/internal/asm/testdata/amd64.s   |    93 +
 src/cmd/asm/internal/asm/testdata/arm.out   |    53 +
 src/cmd/asm/internal/asm/testdata/arm.s     |   281 +
 src/cmd/asm/internal/asm/testdata/ppc64.out |   110 +
 src/cmd/asm/internal/asm/testdata/ppc64.s   |   709 ++
 src/cmd/asm/internal/flags/flags.go         |    67 +
 src/cmd/asm/internal/lex/input.go           |   465 ++
 src/cmd/asm/internal/lex/lex.go             |   157 +
 src/cmd/asm/internal/lex/lex_test.go        |   154 +
 src/cmd/asm/internal/lex/slice.go           |    59 +
 src/cmd/asm/internal/lex/stack.go           |    53 +
 src/cmd/asm/internal/lex/tokenizer.go       |   154 +
 src/cmd/asm/main.go                         |    61 +
 src/cmd/cc/lexbody                          |     4 +-
 src/cmd/dist/build.go                       |    80 +-
 src/cmd/dist/buildruntime.go                |    30 +
 src/cmd/dist/buildtool.go                   |   138 +
 src/cmd/dist/util.go                        |    42 +-
 src/cmd/gc/Makefile                         |    17 -
 src/cmd/gc/align.c                          |   689 --
 src/cmd/gc/array.c                          |   107 -
 src/cmd/gc/bisonerrors                      |   156 -
 src/cmd/gc/builtin.c                        |   165 -
 src/cmd/gc/bv.c                             |   213 -
 src/cmd/gc/closure.c                        |   659 --
 src/cmd/gc/const.c                          |  1678 -----
 src/cmd/gc/cplx.c                           |   494 --
 src/cmd/gc/dcl.c                            |  1479 ----
 src/cmd/gc/doc.go                           |    95 -
 src/cmd/gc/esc.c                            |  1342 ----
 src/cmd/gc/export.c                         |   563 --
 src/cmd/gc/fmt.c                            |  1697 -----
 src/cmd/gc/gen.c                            |   987 ---
 src/cmd/gc/go.errors                        |    79 -
 src/cmd/gc/go.h                             |  1757 -----
 src/cmd/gc/gsubr.c                          |   654 --
 src/cmd/gc/init.c                           |   194 -
 src/cmd/gc/inl.c                            |   986 ---
 src/cmd/gc/lex.c                            |  2590 -------
 src/cmd/gc/md5.c                            |   302 -
 src/cmd/gc/md5.h                            |    16 -
 src/cmd/gc/mkbuiltin                        |    36 -
 src/cmd/gc/mkbuiltin1.c                     |   102 -
 src/cmd/gc/mkopnames                        |    24 -
 src/cmd/gc/mparith1.c                       |   655 --
 src/cmd/gc/mparith2.c                       |   689 --
 src/cmd/gc/mparith3.c                       |   346 -
 src/cmd/gc/obj.c                            |   498 --
 src/cmd/gc/order.c                          |  1164 ---
 src/cmd/gc/pgen.c                           |   547 --
 src/cmd/gc/plive.c                          |  2005 -----
 src/cmd/gc/popt.c                           |  1022 ---
 src/cmd/gc/popt.h                           |   149 -
 src/cmd/gc/racewalk.c                       |   653 --
 src/cmd/gc/range.c                          |   378 -
 src/cmd/gc/reflect.c                        |  1609 ----
 src/cmd/gc/reg.c                            |  1233 ---
 src/cmd/gc/runtime.go                       |   191 -
 src/cmd/gc/select.c                         |   375 -
 src/cmd/gc/sinit.c                          |  1502 ----
 src/cmd/gc/subr.c                           |  3856 ----------
 src/cmd/gc/swt.c                            |   944 ---
 src/cmd/gc/typecheck.c                      |  3649 ---------
 src/cmd/gc/unsafe.c                         |   150 -
 src/cmd/gc/unsafe.go                        |    18 -
 src/cmd/gc/walk.c                           |  4189 -----------
 src/cmd/gc/y.tab.c                          |  5134 -------------
 src/cmd/gc/y.tab.h                          |   167 -
 src/cmd/gc/yerr.h                           |    79 -
 src/cmd/go/build.go                         |    64 +-
 src/cmd/go/help.go                          |     3 +
 src/cmd/go/main.go                          |    58 +-
 src/cmd/go/pkg.go                           |    10 +
 src/cmd/go/test.bash                        |    15 +-
 src/cmd/internal/asm/asm.go                 |   311 +
 src/cmd/internal/asm/lexbody.go             |   738 ++
 src/cmd/internal/asm/macbody.go             |   885 +++
 src/cmd/internal/gc/align.go                |   712 ++
 src/cmd/internal/gc/array.go                |     9 +
 src/cmd/{gc/bits.c => internal/gc/bits.go}  |   138 +-
 src/cmd/internal/gc/builtin.go              |     6 +
 src/cmd/internal/gc/bv.go                   |   195 +
 src/cmd/internal/gc/closure.go              |   697 ++
 src/cmd/internal/gc/const.go                |  1708 +++++
 src/cmd/internal/gc/cplx.go                 |   489 ++
 src/cmd/internal/gc/dcl.go                  |  1485 ++++
 src/cmd/internal/gc/esc.go                  |  1397 ++++
 src/cmd/internal/gc/export.go               |   563 ++
 src/cmd/internal/gc/fmt.go                  |  2011 +++++
 src/cmd/internal/gc/gen.go                  |   960 +++
 src/cmd/internal/gc/go.go                   |  1183 +++
 src/cmd/{ => internal}/gc/go.y              |  1117 +--
 src/cmd/internal/gc/gsubr.go                |   597 ++
 src/cmd/internal/gc/init.go                 |   218 +
 src/cmd/internal/gc/inl.go                  |   983 +++
 src/cmd/internal/gc/lex.go                  |  3159 ++++++++
 src/cmd/internal/gc/md5.go                  |   298 +
 src/cmd/internal/gc/mparith1.go             |   674 ++
 src/cmd/internal/gc/mparith2.go             |   677 ++
 src/cmd/internal/gc/mparith3.go             |   356 +
 src/cmd/internal/gc/obj.go                  |   445 ++
 src/cmd/internal/gc/opnames.go              |   162 +
 src/cmd/internal/gc/order.go                |  1133 +++
 src/cmd/internal/gc/pgen.go                 |   571 ++
 src/cmd/internal/gc/plive.go                |  1901 +++++
 src/cmd/internal/gc/popt.go                 |  1227 +++
 src/cmd/internal/gc/racewalk.go             |   654 ++
 src/cmd/internal/gc/range.go                |   402 +
 src/cmd/internal/gc/reflect.go              |  1623 ++++
 src/cmd/internal/gc/reg.go                  |  1360 ++++
 src/cmd/internal/gc/select.go               |   373 +
 src/cmd/internal/gc/sinit.go                |  1546 ++++
 src/cmd/internal/gc/subr.go                 |  3738 +++++++++
 src/cmd/internal/gc/swt.go                  |   976 +++
 src/cmd/internal/gc/typecheck.go            |  3977 ++++++++++
 src/cmd/internal/gc/unsafe.go               |   172 +
 src/cmd/internal/gc/util.go                 |   114 +
 src/cmd/internal/gc/walk.go                 |  4308 +++++++++++
 src/cmd/internal/gc/y.go                    |  3529 +++++++++
 src/cmd/internal/gc/y.output                | 10411 ++++++++++++++++++++++++++
 src/cmd/internal/obj/ar.go                  |    45 +
 src/cmd/internal/obj/arm/5.out.go           |   283 +
 src/cmd/internal/obj/arm/anames5.go         |   187 +
 src/cmd/internal/obj/arm/asm5.go            |  2928 ++++++++
 src/cmd/internal/obj/arm/list5.go           |   326 +
 src/cmd/internal/obj/arm/obj5.go            |  1078 +++
 src/cmd/internal/obj/arm/util.go            |    12 +
 src/cmd/internal/obj/data.go                |   274 +
 src/cmd/internal/obj/flag.go                |   120 +
 src/cmd/internal/obj/fmt.go                 |    34 +
 src/cmd/internal/obj/funcdata.go            |    79 +
 src/cmd/internal/obj/go.go                  |   143 +
 src/cmd/internal/obj/i386/8.out.go          |   594 ++
 src/cmd/internal/obj/i386/anames8.go        |   524 ++
 src/cmd/internal/obj/i386/asm8.go           |  4053 ++++++++++
 src/cmd/internal/obj/i386/list8.go          |   269 +
 src/cmd/internal/obj/i386/obj8.go           |   926 +++
 src/cmd/internal/obj/i386/util.go           |    12 +
 src/cmd/internal/obj/ld.go                  |    92 +
 src/cmd/internal/obj/libc.go                |    20 +
 src/cmd/internal/obj/link.go                |   598 ++
 src/cmd/internal/obj/mgc0.go                |    37 +
 src/cmd/internal/obj/obj.go                 |   297 +
 src/cmd/internal/obj/objfile.go             |   426 ++
 src/cmd/internal/obj/pass.go                |   213 +
 src/cmd/internal/obj/pcln.go                |   338 +
 src/cmd/internal/obj/ppc64/9.out.go         |   515 ++
 src/cmd/internal/obj/ppc64/anames9.go       |   356 +
 src/cmd/internal/obj/ppc64/asm9.go          |  3323 ++++++++
 src/cmd/internal/obj/ppc64/list9.go         |   319 +
 src/cmd/internal/obj/ppc64/obj9.go          |   999 +++
 src/cmd/internal/obj/ppc64/util.go          |    12 +
 src/cmd/internal/obj/stack.go               |    53 +
 src/cmd/internal/obj/sym.go                 |   284 +
 src/cmd/internal/obj/textflag.go            |    33 +
 src/cmd/internal/obj/typekind.go            |    45 +
 src/cmd/internal/obj/util.go                |   271 +
 src/cmd/internal/obj/x86/6.out.go           |   804 ++
 src/cmd/internal/obj/x86/anames6.go         |   700 ++
 src/cmd/internal/obj/x86/asm6.go            |  4575 +++++++++++
 src/cmd/internal/obj/x86/list6.go           |   326 +
 src/cmd/internal/obj/x86/obj6.go            |  1145 +++
 src/cmd/internal/obj/x86/util.go            |    12 +
 src/cmd/ld/dwarf.c                          |     2 +-
 src/cmd/yacc/doc.go                         |    27 +-
 src/cmd/yacc/yacc.go                        |    77 +-
 src/crypto/md5/md5block_arm.s               |   348 +-
 src/crypto/rc4/rc4_arm.s                    |    78 +-
 src/crypto/sha1/sha1block_arm.s             |   274 +-
 src/lib9/goos.c                             |    14 +-
 src/lib9/run_windows.c                      |    12 +-
 src/liblink/asm6.c                          |    10 +-
 src/liblink/asm8.c                          |     8 +-
 src/liblink/list5.c                         |     8 +
 src/liblink/list6.c                         |    12 +-
 src/liblink/list8.c                         |    19 +-
 src/liblink/objfile.c                       |    43 +-
 src/liblink/objfilego.c                     |   340 +
 src/make.bash                               |     6 +-
 src/make.bat                                |     6 +-
 src/make.rc                                 |     6 +-
 src/race.bash                               |     2 -
 src/race.bat                                |     3 -
 src/run.bash                                |     4 +-
 src/run.bat                                 |     4 +-
 src/run.rc                                  |     4 +-
 src/runtime/asm_amd64.s                     |     4 +-
 src/runtime/asm_arm.s                       |    52 +-
 src/runtime/atomic_ppc64x.s                 |     6 +-
 src/runtime/cgo/asm_arm.s                   |     6 +-
 src/runtime/memclr_arm.s                    |    40 +-
 src/runtime/memmove_arm.s                   |   252 +-
 src/runtime/print1_write_android.go         |     3 +
 src/runtime/rt0_linux_arm.s                 |     2 +-
 src/runtime/stack.h                         |     4 +
 src/runtime/sys_darwin_amd64.s              |    10 +-
 src/runtime/sys_darwin_arm.s                |   117 +-
 src/runtime/sys_freebsd_arm.s               |   102 +-
 src/runtime/sys_linux_arm.s                 |   145 +-
 src/runtime/sys_netbsd_arm.s                |   112 +-
 src/runtime/sys_windows_386.s               |     2 +-
 src/runtime/sys_windows_amd64.s             |     2 +-
 src/runtime/vlop_arm.s                      |   203 +-
 src/sync/atomic/asm_linux_arm.s             |    18 +-
 src/syscall/asm_darwin_arm.s                |   130 +-
 src/syscall/asm_freebsd_arm.s               |   112 +-
 src/syscall/asm_netbsd_arm.s                |   106 +-
 test/fixedbugs/bug121.go                    |     3 +
 test/fixedbugs/bug349.go                    |     3 +
 test/fixedbugs/bug388.go                    |     3 +
 test/fixedbugs/bug435.go                    |     3 +
 test/fixedbugs/issue4468.go                 |     3 +
 test/rotate0.go                             |     2 +
 test/rotate1.go                             |     2 +
 test/rotate2.go                             |     2 +
 test/rotate3.go                             |     2 +
 test/run.go                                 |     3 +-
 346 files changed, 129643 insertions(+), 93009 deletions(-)
