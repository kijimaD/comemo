commit 6d2a557a4d09b6f60e2522fb740b5d7d1d8dc8e2
Author: Dan Scales <danscales@google.com>
Date:   Tue Mar 30 16:03:26 2021 -0700

    cmd/compile: deal with call.Use correctly for noder2, allow inlining of stenciled functions
    
    The setting of n.Use for a call node in transformCall() (and previously
    in Call()), was not corrrect, since it was trying to use the number of
    results of the call, rather than whether the call result was actually
    used. We are already setting n.Use to ir.CallUseStmt if the call node is
    directly a statement, so we just need to initialize n.Use to
    ir.CallExprStmt in Call(), which will get changed to ir.CallUseStmt at
    the statement level if it's used as a statement.
    
    Enable inlining of stenciled functions (just disabled for testing,
    easier debugging). The above n.Use fix was required for the inlining
    to work for two cases.
    
    Change-Id: Ie4ef6cd53fd4b20a4f3be31e629280909a545b7d
    Reviewed-on: https://go-review.googlesource.com/c/go/+/305913
    Trust: Dan Scales <danscales@google.com>
    Run-TryBot: Dan Scales <danscales@google.com>
    TryBot-Result: Go Bot <gobot@golang.org>
    Reviewed-by: Robert Griesemer <gri@golang.org>

 src/cmd/compile/internal/noder/helpers.go   | 3 +++
 src/cmd/compile/internal/noder/stencil.go   | 2 --
 src/cmd/compile/internal/noder/transform.go | 5 -----
 3 files changed, 3 insertions(+), 7 deletions(-)
