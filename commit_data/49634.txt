commit feada5366134772c4c6462e4a12150410741a00f
Author: Bryan C. Mills <bcmills@google.com>
Date:   Tue Jul 12 13:43:02 2022 -0400

    misc/cgo/testcshared: don't rely on an erroneous install target in tests
    
    Non-main packages in module mode should not be installed to
    GOPATH/pkg, but due to #37015 they were installed there anyway.
    
    This change switches the 'go install' command in createHeaders to
    instead use 'go build' (with an extension determined by the install
    target for 'runtime/cgo', which is well-defined at least for the
    moment), and switches TestCachedInstall (which appears to be
    explicitly testing 'go install') to explicitly request GOPATH mode
    (which provides a well-defined install target for the library).
    
    This change follows a similar structure to CL 416954.
    
    For #37015.
    
    Change-Id: I22ae4af0f0d4c50adc9e0f0dc279859d1f258cc8
    Reviewed-on: https://go-review.googlesource.com/c/go/+/417096
    Run-TryBot: Bryan Mills <bcmills@google.com>
    TryBot-Result: Gopher Robot <gobot@golang.org>
    Auto-Submit: Bryan Mills <bcmills@google.com>
    Reviewed-by: Ian Lance Taylor <iant@google.com>

 misc/cgo/testcshared/cshared_test.go | 35 +++++++++++++++++++++++++----------
 1 file changed, 25 insertions(+), 10 deletions(-)
