commit 2ef88f7fcf5cebccdf9a20a5af6a374864ccf149
Author: Austin Clements <austin@google.com>
Date:   Sat Dec 17 22:07:27 2016 -0500

    runtime: lock-free fast path for mark bits allocation
    
    Currently we acquire a global lock for every newMarkBits call. This is
    unfortunate since every span sweep operation calls newMarkBits.
    
    However, most allocations are simply linear allocations from the
    current arena. Take advantage of this to add a lock-free fast path for
    allocating from the current arena. With this change, the global lock
    only protects the lists of arenas, not the free offset in the current
    arena.
    
    Change-Id: I6cf6182af8492c8bfc21276114c77275fe3d7826
    Reviewed-on: https://go-review.googlesource.com/34595
    Run-TryBot: Austin Clements <austin@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Rick Hudson <rlh@golang.org>

 src/runtime/mheap.go | 40 +++++++++++++++++++++++++++++-----------
 1 file changed, 29 insertions(+), 11 deletions(-)
