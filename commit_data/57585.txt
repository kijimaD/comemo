commit c8adb3004ff05654d98041c76c68b64e1d479782
Author: Matthew Dempsky <mdempsky@google.com>
Date:   Wed Aug 16 22:57:12 2023 -0700

    cmd/compile: enable zero-copy string->[]byte conversions
    
    This CL enables the latent support for string->[]byte conversions
    added go.dev/cl/520259.
    
    One catch is that we need to make sure []byte("") evaluates to a
    non-nil slice, even if "" is (nil, 0). This CL addresses that by
    adding a "ptr != nil" check for OSTR2BYTESTMP, unless the NonNil flag
    is set.
    
    The existing uses of OSTR2BYTESTMP (which aren't concerned about
    []byte("") evaluating to nil) are updated to set this flag.
    
    Fixes #2205.
    
    Change-Id: I35a9cb16c164cd86156b7560915aba5108d8b523
    Reviewed-on: https://go-review.googlesource.com/c/go/+/520395
    Run-TryBot: Matthew Dempsky <mdempsky@google.com>
    TryBot-Result: Gopher Robot <gobot@golang.org>
    Auto-Submit: Matthew Dempsky <mdempsky@google.com>
    Reviewed-by: Cuong Manh Le <cuong.manhle.vn@gmail.com>
    Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>

 src/cmd/compile/internal/escape/escape.go | 13 ++++---------
 src/cmd/compile/internal/ssagen/ssa.go    |  8 ++++++++
 src/cmd/compile/internal/walk/order.go    | 10 ++++++++--
 src/cmd/compile/internal/walk/switch.go   |  1 +
 test/escape2.go                           |  2 +-
 test/escape2n.go                          |  2 +-
 6 files changed, 23 insertions(+), 13 deletions(-)
