commit a4ba411b19fa0111a3c8fe059fcf5489d3bd6bbf
Author: Cherry Zhang <cherryyz@google.com>
Date:   Tue Jun 30 16:51:27 2020 -0400

    cmd/link: skip fallocate test if not supported, and adjust allocation size on darwin
    
    On Linux, the linker uses fallocate to preallocate the output
    file storage. The underlying file system may not support
    fallocate, causing the test to fail. Skip the test in this case.
    
    On darwin, apparently F_PREALLOCATE allocates from the end of the
    allocation instead of the logical end of the file. Adjust the
    size calculation.
    
    Fixes #39905.
    
    Change-Id: I01e676737fd2619ebbdba05c7cf7f424ec27de35
    Reviewed-on: https://go-review.googlesource.com/c/go/+/240618
    Reviewed-by: Than McIntosh <thanm@google.com>
    Run-TryBot: Cherry Zhang <cherryyz@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

 src/cmd/link/internal/ld/fallocate_test.go | 15 +++++++++++++++
 src/cmd/link/internal/ld/outbuf_darwin.go  |  7 +++++--
 2 files changed, 20 insertions(+), 2 deletions(-)
