commit 1ebc983000ed411a1c06f6b8a61770be1392e707
Author: Michael Anthony Knyszek <mknyszek@google.com>
Date:   Thu Jul 7 20:01:21 2022 +0000

    runtime: overestimate the amount of allocated memory in heapLive
    
    CL 377516 made it so that memory metrics are truly monotonic, but also
    updated how heapLive tracked allocated memory to also be monotonic.
    
    The result is that cached spans with allocated memory aren't fully
    accounted for by the GC, causing it to make a worse assumption (the
    exact mechanism is at this time unknown), resulting in a memory
    regression, especially for smaller heaps.
    
    This change is a partial revert of CL 377516 that makes heapLive a
    non-monotonic overestimate again, which appears to resolve the
    regression.
    
    For #53738.
    
    Change-Id: I5c51067abc0b8e0a6b89dd8dbd4a0be2e8c0c1b2
    Reviewed-on: https://go-review.googlesource.com/c/go/+/416417
    Reviewed-by: Michael Pratt <mpratt@google.com>
    Run-TryBot: Michael Knyszek <mknyszek@google.com>
    TryBot-Result: Gopher Robot <gobot@golang.org>

 src/runtime/mcache.go | 36 ++++++++++++++++++++++++++++++------
 1 file changed, 30 insertions(+), 6 deletions(-)
