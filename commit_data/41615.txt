commit f6a0d723859752a2e7c10a470eadd395ba6892a6
Author: Robert Griesemer <gri@golang.org>
Date:   Thu Mar 5 14:14:54 2020 -0800

    cmd/compile/internal/syntax: various cleanups following CL 221603
    
    1) Introduced setLit method to uniformly set the scanner state for
       literals instead of directly manipulating the scanner fields.
    
    2) Use a local variable 'ok' to track validity of literals instead
       of relying on the side-effect of error reporters setting s.bad.
       More code but clearer because it is local and explicit.
    
    3) s/litname/baseName/ and use this function uniformly, also for
       escapes. Consequently we now report always "hexadecimal" and
       not "hex" (in the case of invalid escapes).
    
    4) Added TestDirectives verifying that we get the correct directive
       string (even if that string contains '%').
    
    Verified that lines/s parsing performance is unchanged by comparing
    
    go test -run StdLib -fast -skip "syntax/(scanner|scanner_test)\.go"
    
    before and after (no relevant difference).
    
    Change-Id: I143e4648fdaa31d1c365fb794a1cae4bc1c3f5ba
    Reviewed-on: https://go-review.googlesource.com/c/go/+/222258
    Run-TryBot: Robert Griesemer <gri@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Matthew Dempsky <mdempsky@google.com>

 src/cmd/compile/internal/syntax/scanner.go      | 141 +++++++++++++-----------
 src/cmd/compile/internal/syntax/scanner_test.go |  54 ++++++++-
 2 files changed, 127 insertions(+), 68 deletions(-)
