commit d26fc68aa10dc8eda5ccdcc80d790e7df2fd9823
Author: Austin Clements <austin@google.com>
Date:   Wed Apr 14 13:25:31 2021 -0400

    cmd/internal/objabi,test: use correct GOEXPERIMENT build tags in test/run.go
    
    Currently, run.go sets GOEXPERIMENT build tags based on the
    *difference* from the baseline experiment configuration, rather than
    the absolute experiment configuration. This differs from cmd/go. As a
    result, if we set a baseline configuration and don't override it with
    a GOEXPERIMENT setting, run.go won't set any GOEXPERIMENT build tags,
    instead of setting the tags corresponding to the baseline
    configuration.
    
    Fix this by making compile -V=goexperiment produce the full
    GOEXPERIMENT configuration, which run.go can then use to set exactly
    the right set of build tags.
    
    For #40724.
    
    Change-Id: Ieda6ea62f1a1fabbe8d749d6d09c198fd5ca8377
    Reviewed-on: https://go-review.googlesource.com/c/go/+/310171
    Trust: Austin Clements <austin@google.com>
    Run-TryBot: Austin Clements <austin@google.com>
    TryBot-Result: Go Bot <gobot@golang.org>
    Reviewed-by: Cherry Zhang <cherryyz@google.com>

 src/cmd/internal/objabi/exp.go  | 11 ++++++-----
 src/cmd/internal/objabi/flag.go | 14 ++++++++++----
 test/run.go                     | 35 +++++++++++++++++++----------------
 3 files changed, 35 insertions(+), 25 deletions(-)
