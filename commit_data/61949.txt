commit b9955f0ad952a22388eead15e3d15610a29e03a0
Author: Cherry Mui <cherryyz@google.com>
Date:   Fri Dec 20 22:33:15 2024 -0500

    cmd/link, runtime: apply a delta to RODATA->DATA relocations
    
    On AIX, an R_ADDR relocation from an RODATA symbol to a DATA
    symbol does not work, as the dynamic loader can change the address
    of the data section, and it is not possible to apply a dynamic
    relocation to RODATA. In order to get the correct address, we
    apply the delta between unrelocated and relocated data section
    addresses at run time. The linker saves both the unrelocated and
    the relocated addresses, so we can compute the delta.
    
    This is possible because RODATA symbols are generated by the
    compiler and so we have full control of. On AIX, the only case
    is the on-demand GC pointer masks from the type descriptors, for
    very large types.
    
    Perhaps there is a better way.
    
    Fixes #70483.
    
    Change-Id: I2664c0a813b38f7b146794cb1e73ccf5e238ca65
    Reviewed-on: https://go-review.googlesource.com/c/go/+/638016
    Reviewed-by: Keith Randall <khr@golang.org>
    Reviewed-by: Keith Randall <khr@google.com>
    LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>

 src/cmd/link/internal/ld/data.go   |  3 +++
 src/cmd/link/internal/ld/symtab.go | 11 +++++++++++
 src/runtime/symtab.go              | 12 ++++++++++++
 src/runtime/type.go                |  4 ++++
 4 files changed, 30 insertions(+)
