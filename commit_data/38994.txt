commit 770130659b6fb2acf271476579a3644e093dda7f
Author: Filippo Valsorda <filippo@golang.org>
Date:   Tue Dec 4 22:23:22 2018 -0500

    crypto/x509: limit number of signature checks for each verification
    
    That number grows quadratically with the number of intermediate
    certificates in certain pathological cases (for example if they all have
    the same Subject) leading to a CPU DoS. Set a fixed budget that should
    fit all real world chains, given we only look at intermediates provided
    by the peer.
    
    The algorithm can be improved, but that's left for follow-up CLs:
    
        * the cache logic should be reviewed for correctness, as it seems to
          override the entire chain with the cached one
        * the equality check should compare Subject and public key, not the
          whole certificate
        * certificates with the right SKID but the wrong Subject should not
          be considered, and in particular should not take priority over
          certificates with the right Subject
    
    Fixes #29233
    
    Change-Id: Ib257c12cd5563df7723f9c81231d82b882854213
    Reviewed-on: https://team-review.git.corp.google.com/c/370475
    Reviewed-by: Andrew Bonventre <andybons@google.com>
    Reviewed-on: https://go-review.googlesource.com/c/154105
    Reviewed-by: Filippo Valsorda <filippo@golang.org>
    Run-TryBot: Filippo Valsorda <filippo@golang.org>

 src/crypto/x509/cert_pool.go   |  28 +++-------
 src/crypto/x509/verify.go      |  86 +++++++++++++++++------------
 src/crypto/x509/verify_test.go | 119 +++++++++++++++++++++++++++++++++++++++++
 3 files changed, 176 insertions(+), 57 deletions(-)
