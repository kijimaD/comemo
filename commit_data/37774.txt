commit 429bae715876c69853bb63db1733f580e293c916
Author: Michael Anthony Knyszek <mknyszek@google.com>
Date:   Thu Dec 20 20:21:45 2018 +0000

    runtime: skip TestLockOSThreadAvoidsStatePropagation if one can't unshare
    
    This change splits a testprog out of TestLockOSThreadExit and makes it
    its own test. Then, this change makes the testprog exit prematurely with
    a special message if unshare fails with EPERM because not all of the
    builders allow the user to call the unshare syscall.
    
    Also, do some minor cleanup on the TestLockOSThread* tests.
    
    Fixes #29366.
    
    Change-Id: Id8a9f6c4b16e26af92ed2916b90b0249ba226dbe
    Reviewed-on: https://go-review.googlesource.com/c/155437
    Run-TryBot: Michael Knyszek <mknyszek@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

 src/runtime/proc_test.go                        | 21 +++++----
 src/runtime/testdata/testprog/lockosthread.go   |  4 ++
 src/runtime/testdata/testprog/syscalls.go       | 47 +-------------------
 src/runtime/testdata/testprog/syscalls_linux.go | 59 +++++++++++++++++++++++++
 4 files changed, 78 insertions(+), 53 deletions(-)
