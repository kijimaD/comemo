commit cdcd02842da7c004efd023881e3719105209c908
Author: Roland Shoemaker <roland@golang.org>
Date:   Thu May 27 10:40:06 2021 -0700

    net: verify results from Lookup* are valid domain names
    
    For the methods LookupCNAME, LookupSRV, LookupMX, LookupNS, and
    LookupAddr check that the returned domain names are in fact valid DNS
    names using the existing isDomainName function.
    
    Thanks to Philipp Jeitner and Haya Shulman from Fraunhofer SIT for
    reporting this issue.
    
    Fixes #46241
    Fixes CVE-2021-33195
    
    Change-Id: I47a4f58c031cb752f732e88bbdae7f819f0af4f3
    Reviewed-on: https://go-review.googlesource.com/c/go/+/323131
    Trust: Roland Shoemaker <roland@golang.org>
    Run-TryBot: Roland Shoemaker <roland@golang.org>
    TryBot-Result: Go Bot <gobot@golang.org>
    Reviewed-by: Filippo Valsorda <filippo@golang.org>
    Reviewed-by: Katie Hockman <katie@golang.org>

 src/net/dnsclient_unix_test.go | 157 +++++++++++++++++++++++++++++++++++++++++
 src/net/lookup.go              | 111 +++++++++++++++++++++++++----
 2 files changed, 255 insertions(+), 13 deletions(-)
