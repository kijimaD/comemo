commit 2d097e363a6fce725802ecbde6d0d1b90f45290d
Author: Robert Griesemer <gri@golang.org>
Date:   Thu Mar 6 15:44:01 2025 -0800

    go/types, types2: better error messages for copy built-in
    
    Rather than relying on coreString, use the new commonUnder function
    to determine the argument slice element types.
    
    Factor out this functionality, which is shared for append and copy,
    into a new helper function sliceElem (similar to chanElem).
    Use sliceElem for both the append and copy implementation.
    As a result, the error messages for invalid copy calls are
    now more detailed.
    
    While at it, handle the special cases for append and copy first
    because they don't need the slice element computation.
    
    Finally, share the same type recording code for the special and
    general cases.
    
    As an aside, in commonUnder, be clearer in the code that the
    result is either a nil type and an error, or a non-nil type
    and a nil error. This matches in style what we do in sliceElem.
    
    Change-Id: I318bafc0d2d31df04f33b1b464ad50d581918671
    Reviewed-on: https://go-review.googlesource.com/c/go/+/655675
    LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
    Auto-Submit: Robert Griesemer <gri@google.com>
    Reviewed-by: Robert Findley <rfindley@google.com>
    Reviewed-by: Robert Griesemer <gri@google.com>

 src/cmd/compile/internal/types2/builtins.go        | 175 ++++++++++++---------
 src/cmd/compile/internal/types2/under.go           |   7 +-
 src/go/types/builtins.go                           | 175 ++++++++++++---------
 src/go/types/under.go                              |   7 +-
 src/internal/types/testdata/check/builtins0.go     |  12 +-
 src/internal/types/testdata/check/builtins1.go     |  11 +-
 .../types/testdata/fixedbugs/issue49735.go         |   6 +-
 test/copy1.go                                      |   6 +-
 test/fixedbugs/issue7310.go                        |   4 +-
 9 files changed, 238 insertions(+), 165 deletions(-)
