commit 6196979365ec6b527b3731c9ec13d7ddfe429f86
Author: Jay Conrod <jayconrod@google.com>
Date:   Tue Aug 24 11:51:07 2021 -0700

    cmd/go/internal/modload: prevent tidy downgrading disambiguating modules
    
    If an indirectly required module does not provide any packages needed
    to build packages in the main module but is needed to disambiguate
    imports, 'go mod tidy' may keep an indirect requirement on that module
    to prevent it from being downgraded. This can prevent the introduction
    of new ambiguities. This also ensures tidy keeps sums needed to load
    all packages.
    
    Fixes #47738
    
    Change-Id: Ib8e33422b95394707894cda7cfbb71a4b111e0ed
    Reviewed-on: https://go-review.googlesource.com/c/go/+/344572
    Trust: Jay Conrod <jayconrod@google.com>
    Run-TryBot: Jay Conrod <jayconrod@google.com>
    TryBot-Result: Go Bot <gobot@golang.org>
    Reviewed-by: Bryan C. Mills <bcmills@google.com>

 src/cmd/go/internal/modload/buildlist.go           | 68 +++++++++++++++++++---
 src/cmd/go/internal/modload/import.go              | 46 ++++++++-------
 src/cmd/go/internal/modload/load.go                | 12 ++--
 .../script/mod_tidy_downgrade_ambiguous.txt        | 58 ++++++++++++++++++
 4 files changed, 150 insertions(+), 34 deletions(-)
