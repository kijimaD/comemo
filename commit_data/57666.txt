commit fbcf43c60ba5170309a238b0e42fd5879d419776
Author: Austin Clements <austin@google.com>
Date:   Fri Jun 30 16:33:49 2023 -0400

    cmd/compile,cmd/dist,cmd/go: compute -+ flag from package path
    
    As we did for the asm -compiling-runtime flag, this CL modifies the
    compiler to compute the -+ (compiling runtime) flag from the package
    path. Unlike for asm, some tests use -+ explicitly to opt in to
    runtime restrictions, so we leave the flag, but it's no longer passed
    by any build tools.
    
    This lets us eliminate cmd/go's list of "runtime packages" in favor of
    the unified objabi.LookupPkgSpecial. It also fixes an inconsistency
    with dist, which only passed -+ when compiling "runtime" itself.
    
    One consequence of this is that the compiler now ignores the -N flag
    when compiling runtime packages. Previously, cmd/go would strip -N
    when passing -+ and the compiler would fatal if it got both -N and -+,
    so the overall effect was that the compiler never saw -N when
    compiling a runtime package. Now we simply move that logic to disable
    -N down into the compiler.
    
    Change-Id: I4876047a1563210ed122a31b72d62798762cbcf5
    Reviewed-on: https://go-review.googlesource.com/c/go/+/521699
    Run-TryBot: Austin Clements <austin@google.com>
    TryBot-Result: Gopher Robot <gobot@golang.org>
    Reviewed-by: Matthew Dempsky <mdempsky@google.com>

 src/cmd/compile/internal/base/flag.go | 13 ++++++++++---
 src/cmd/dist/build.go                 |  3 ---
 src/cmd/go/internal/work/gc.go        | 34 ----------------------------------
 src/cmd/internal/objabi/pkgspecial.go | 34 ++++++++++++++++++++++++++++++++++
 4 files changed, 44 insertions(+), 40 deletions(-)
