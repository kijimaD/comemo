commit 7ba0c6235f9968eb453e759105366bcaa0903326
Author: Michael Munday <mike.munday@ibm.com>
Date:   Thu May 24 13:20:21 2018 +0100

    crypto, internal/cpu: fix s390x AES feature detection and update SHA implementations
    
    Hardware AES support in Go on s390x currently requires ECB, CBC
    and CTR modes be available. It also requires that either the
    GHASH or GCM facilities are available. The existing checks missed
    some of these constraints.
    
    While we're here simplify the cpu package on s390x, moving masking
    code out of assembly and into Go code. Also, update SHA-{1,256,512}
    implementations to use the cpu package since that is now trivial.
    
    Finally I also added a test for internal/cpu on s390x which loads
    /proc/cpuinfo and checks it against the flags set by internal/cpu.
    
    Updates #25822 for changes to vet whitelist.
    
    Change-Id: Iac4183f571643209e027f730989c60a811c928eb
    Reviewed-on: https://go-review.googlesource.com/114397
    Run-TryBot: Michael Munday <mike.munday@ibm.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

 src/cmd/vet/all/whitelist/s390x.txt    |   7 ++
 src/crypto/aes/cipher_s390x.go         |  11 ++-
 src/crypto/aes/gcm_s390x.go            |   2 +-
 src/crypto/sha1/sha1block_s390x.go     |   7 +-
 src/crypto/sha1/sha1block_s390x.s      |  34 +++----
 src/crypto/sha256/sha256block_s390x.go |   7 +-
 src/crypto/sha256/sha256block_s390x.s  |  34 +++----
 src/crypto/sha512/sha512block_s390x.go |   7 +-
 src/crypto/sha512/sha512block_s390x.s  |  34 +++----
 src/crypto/tls/common.go               |   3 +-
 src/internal/cpu/cpu.go                |  26 ++++--
 src/internal/cpu/cpu_no_init.go        |   1 +
 src/internal/cpu/cpu_s390x.go          | 157 ++++++++++++++++++++++++++++++---
 src/internal/cpu/cpu_s390x.s           | 122 ++++++++-----------------
 src/internal/cpu/cpu_s390x_test.go     |  63 +++++++++++++
 15 files changed, 315 insertions(+), 200 deletions(-)
