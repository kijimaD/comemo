commit c5f142fa9fb6e00b0877ba4b6e9ab77d22ac50cd
Author: LE Manh Cuong <cuong.manhle.vn@gmail.com>
Date:   Wed May 8 17:02:23 2019 +0700

    cmd/compile: optimize bitset tests
    
    The assembly output for x & c == c, where c is power of 2:
    
            MOVQ    "".set+8(SP), AX
            ANDQ    $8, AX
            CMPQ    AX, $8
            SETEQ   "".~r2+24(SP)
    
    With optimization using bitset:
    
            MOVQ    "".set+8(SP), AX
            BTL     $3, AX
            SETCS   "".~r2+24(SP)
    
    output less than 1 instruction.
    
    However, there is no speed improvement:
    
    name         old time/op  new time/op  delta
    AllBitSet-8  0.35ns ± 0%  0.35ns ± 0%   ~     (all equal)
    
    Fixes #31904
    
    Change-Id: I5dca4e410bf45716ed2145e3473979ec997e35d4
    Reviewed-on: https://go-review.googlesource.com/c/go/+/175957
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Keith Randall <khr@golang.org>

 src/cmd/compile/internal/ssa/gen/generic.rules |    6 +
 src/cmd/compile/internal/ssa/rewritegeneric.go | 1455 +++++++++++++++++++++++-
 test/codegen/bits.go                           |   12 +
 3 files changed, 1468 insertions(+), 5 deletions(-)
