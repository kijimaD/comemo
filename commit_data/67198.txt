commit 59211acb5dbde14647e025eb7379675debcf3930
Author: Filippo Valsorda <filippo@golang.org>
Date:   Sat Mar 15 15:12:39 2025 +0100

    crypto/tls: disable SHA-1 signature algorithms in TLS 1.2
    
    This implements RFC 9155 by removing support for SHA-1 algorithms:
    
      - we don't advertise them in ClientHello and CertificateRequest
        (where supportedSignatureAlgorithms is used directly)
    
      - we don't select them in our ServerKeyExchange and CertificateVerify
        (where supportedSignatureAlgorithms filters signatureSchemesForCertificate)
    
      - we reject them in the peer's ServerKeyExchange and CertificateVerify
        (where we check against the algorithms we advertised in ClientHello
        and CertificateRequest)
    
    Fixes #72883
    
    Change-Id: I6a6a4656e2aafd2c38cdd32090d3d8a9a8047818
    Reviewed-on: https://go-review.googlesource.com/c/go/+/658216
    LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
    Auto-Submit: Filippo Valsorda <filippo@golang.org>
    Reviewed-by: David Chase <drchase@google.com>
    Reviewed-by: Roland Shoemaker <roland@golang.org>
    Reviewed-by: Daniel McCarney <daniel@binaryparadox.net>
---
 doc/godebug.md                                     |   3 +
 doc/next/6-stdlib/99-minor/crypto/tls/72883.md     |   3 +
 src/crypto/tls/auth.go                             |   7 +-
 src/crypto/tls/auth_test.go                        |  42 +-
 src/crypto/tls/bogo_config.json                    |   2 +
 src/crypto/tls/defaults.go                         |  20 +-
 src/crypto/tls/handshake_client.go                 |   4 +
 src/crypto/tls/handshake_server.go                 |   4 +
 src/crypto/tls/key_agreement.go                    |   8 +
 .../testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA  | 107 ++--
 .../testdata/Client-TLSv10-ClientCert-ECDSA-RSA    | 101 ++--
 .../testdata/Client-TLSv10-ClientCert-RSA-ECDSA    | 105 ++--
 .../tls/testdata/Client-TLSv10-ClientCert-RSA-RSA  |  99 ++--
 .../tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES     |  85 ++-
 .../tls/testdata/Client-TLSv10-ECDHE-RSA-AES       |  81 ++-
 .../testdata/Client-TLSv10-ExportKeyingMaterial    |  81 ++-
 src/crypto/tls/testdata/Client-TLSv10-RSA-RC4      |  49 +-
 .../tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES     |  85 ++-
 .../tls/testdata/Client-TLSv11-ECDHE-RSA-AES       |  81 ++-
 src/crypto/tls/testdata/Client-TLSv11-RSA-RC4      |  49 +-
 .../tls/testdata/Client-TLSv12-AES128-GCM-SHA256   |  53 +-
 .../tls/testdata/Client-TLSv12-AES128-SHA256       |  67 ++-
 .../tls/testdata/Client-TLSv12-AES256-GCM-SHA384   |  53 +-
 src/crypto/tls/testdata/Client-TLSv12-ALPN         |  74 +--
 .../testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA  | 115 ++---
 .../testdata/Client-TLSv12-ClientCert-ECDSA-RSA    |  99 ++--
 .../tls/testdata/Client-TLSv12-ClientCert-Ed25519  |  83 ++-
 .../Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384 |  95 ++--
 .../testdata/Client-TLSv12-ClientCert-RSA-ECDSA    | 111 ++--
 .../tls/testdata/Client-TLSv12-ClientCert-RSA-RSA  |  95 ++--
 .../Client-TLSv12-ClientCert-RSA-RSAPKCS1v15       |  95 ++--
 .../testdata/Client-TLSv12-ClientCert-RSA-RSAPSS   |  93 ++--
 .../tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES     |  85 ++-
 .../tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM |  75 ++-
 .../Client-TLSv12-ECDHE-ECDSA-AES128-SHA256        |  93 ++--
 .../Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384    |  79 ++-
 .../Client-TLSv12-ECDHE-ECDSA-CHACHA20-POLY1305    |  76 +--
 .../tls/testdata/Client-TLSv12-ECDHE-RSA-AES       |  83 ++-
 .../testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256 |  91 ++--
 .../Client-TLSv12-ECDHE-RSA-CHACHA20-POLY1305      |  74 +--
 src/crypto/tls/testdata/Client-TLSv12-Ed25519      |  63 ++-
 .../testdata/Client-TLSv12-ExportKeyingMaterial    |  73 ++-
 src/crypto/tls/testdata/Client-TLSv12-P256-ECDHE   |  84 +--
 src/crypto/tls/testdata/Client-TLSv12-RSA-RC4      |  49 +-
 .../tls/testdata/Client-TLSv12-RenegotiateOnce     | 375 +++++++-------
 .../tls/testdata/Client-TLSv12-RenegotiateTwice    | 571 ++++++++++-----------
 .../Client-TLSv12-RenegotiateTwiceRejected         | 381 +++++++-------
 .../testdata/Client-TLSv12-RenegotiationRejected   |  79 ++-
 src/crypto/tls/testdata/Client-TLSv12-SCT          |  71 ++-
 src/crypto/tls/testdata/Client-TLSv12-X25519-ECDHE |  76 +--
 .../tls/testdata/Client-TLSv13-AES128-SHA256       | 157 +++---
 .../tls/testdata/Client-TLSv13-AES256-SHA384       | 161 +++---
 src/crypto/tls/testdata/Client-TLSv13-ALPN         | 162 +++---
 .../tls/testdata/Client-TLSv13-CHACHA20-SHA256     | 157 +++---
 .../testdata/Client-TLSv13-ClientCert-ECDSA-RSA    | 255 +++++----
 .../tls/testdata/Client-TLSv13-ClientCert-Ed25519  | 221 ++++----
 .../testdata/Client-TLSv13-ClientCert-RSA-ECDSA    | 245 +++++----
 .../testdata/Client-TLSv13-ClientCert-RSA-RSAPSS   | 263 +++++-----
 src/crypto/tls/testdata/Client-TLSv13-ECDSA        | 149 +++---
 src/crypto/tls/testdata/Client-TLSv13-Ed25519      | 113 ++--
 .../testdata/Client-TLSv13-ExportKeyingMaterial    | 157 +++---
 .../tls/testdata/Client-TLSv13-HelloRetryRequest   | 179 ++++---
 src/crypto/tls/testdata/Client-TLSv13-KeyUpdate    | 173 ++++---
 src/crypto/tls/testdata/Client-TLSv13-P256-ECDHE   | 162 +++---
 src/crypto/tls/testdata/Client-TLSv13-X25519-ECDHE | 156 +++---
 .../Server-TLSv12-ClientAuthRequestedAndECDSAGiven |  80 +--
 ...erver-TLSv12-ClientAuthRequestedAndEd25519Given |  72 +--
 .../Server-TLSv12-ClientAuthRequestedAndGiven      |  80 +--
 ...rver-TLSv12-ClientAuthRequestedAndPKCS1v15Given |  80 +--
 .../Server-TLSv12-ClientAuthRequestedNotGiven      |  62 +--
 src/internal/godebugs/godebugs_test.go             |   3 +-
 src/internal/godebugs/table.go                     |   1 +
 src/runtime/metrics/doc.go                         |   4 +
 73 files changed, 3818 insertions(+), 3801 deletions(-)

diff --git a/doc/godebug.md b/doc/godebug.md
index b0c820da46..3b8c62a46c 100644
--- a/doc/godebug.md
+++ b/doc/godebug.md
@@ -180,6 +180,9 @@ runtime will periodically update GOMAXPROCS for new CPU affinity or cgroup
 limits. The default value `updatemaxprocs=1` will enable periodic updates.
 `updatemaxprocs=0` will disable periodic updates.
 
+Go 1.25 disabled SHA-1 signature algorithms in TLS 1.2 according to RFC 9155.
+The default can be reverted using the `tlssha1=1` setting.
+
 Go 1.25 corrected the semantics of contention reports for runtime-internal locks,
 and so removed the [`runtimecontentionstacks` setting](/pkg/runtime#hdr-Environment_Variable).
 
diff --git a/doc/next/6-stdlib/99-minor/crypto/tls/72883.md b/doc/next/6-stdlib/99-minor/crypto/tls/72883.md
new file mode 100644
index 0000000000..70e06192a3
--- /dev/null
+++ b/doc/next/6-stdlib/99-minor/crypto/tls/72883.md
@@ -0,0 +1,3 @@
+SHA-1 signature algorithms are now disallowed in TLS 1.2 handshakes, per
+[RFC 9155](https://www.rfc-editor.org/rfc/rfc9155.html).
+They can be re-enabled with the `tlssha1=1` GODEBUG option.
diff --git a/src/crypto/tls/auth.go b/src/crypto/tls/auth.go
index 7f072204a7..2d0596689f 100644
--- a/src/crypto/tls/auth.go
+++ b/src/crypto/tls/auth.go
@@ -219,7 +219,7 @@ func signatureSchemesForCertificate(version uint16, cert *Certificate) []Signatu
 	}
 
 	// Filter out any unsupported signature algorithms, for example due to
-	// FIPS 140-3 policy, or any downstream changes to defaults.go.
+	// FIPS 140-3 policy, tlssha1=0, or any downstream changes to defaults.go.
 	supportedAlgs := supportedSignatureAlgorithms(version)
 	sigAlgs = slices.DeleteFunc(sigAlgs, func(sigAlg SignatureScheme) bool {
 		return !isSupportedSignatureAlgorithm(sigAlg, supportedAlgs)
@@ -239,6 +239,11 @@ func selectSignatureScheme(vers uint16, c *Certificate, peerAlgs []SignatureSche
 	if len(peerAlgs) == 0 && vers == VersionTLS12 {
 		// For TLS 1.2, if the client didn't send signature_algorithms then we
 		// can assume that it supports SHA1. See RFC 5246, Section 7.4.1.4.1.
+		// RFC 9155 made signature_algorithms mandatory in TLS 1.2, and we gated
+		// it behind the tlssha1 GODEBUG setting.
+		if tlssha1.Value() != "1" {
+			return 0, errors.New("tls: missing signature_algorithms from TLS 1.2 peer")
+		}
 		peerAlgs = []SignatureScheme{PKCS1WithSHA1, ECDSAWithSHA1}
 	}
 	// Pick signature scheme in the peer's preference order, as our
diff --git a/src/crypto/tls/auth_test.go b/src/crypto/tls/auth_test.go
index 616d9bab78..727bdc4df7 100644
--- a/src/crypto/tls/auth_test.go
+++ b/src/crypto/tls/auth_test.go
@@ -7,6 +7,7 @@ package tls
 import (
 	"crypto"
 	"crypto/tls/internal/fips140tls"
+	"os"
 	"testing"
 )
 
@@ -33,35 +34,41 @@ func TestSignatureSelection(t *testing.T) {
 		cert        *Certificate
 		peerSigAlgs []SignatureScheme
 		tlsVersion  uint16
+		godebug     string
 
 		expectedSigAlg  SignatureScheme
 		expectedSigType uint8
 		expectedHash    crypto.Hash
 	}{
-		{rsaCert, []SignatureScheme{PKCS1WithSHA1, PKCS1WithSHA256}, VersionTLS12, PKCS1WithSHA1, signaturePKCS1v15, crypto.SHA1},
-		{rsaCert, []SignatureScheme{PKCS1WithSHA512, PKCS1WithSHA1}, VersionTLS12, PKCS1WithSHA512, signaturePKCS1v15, crypto.SHA512},
-		{rsaCert, []SignatureScheme{PSSWithSHA256, PKCS1WithSHA256}, VersionTLS12, PSSWithSHA256, signatureRSAPSS, crypto.SHA256},
-		{pkcs1Cert, []SignatureScheme{PSSWithSHA256, PKCS1WithSHA256}, VersionTLS12, PKCS1WithSHA256, signaturePKCS1v15, crypto.SHA256},
-		{rsaCert, []SignatureScheme{PSSWithSHA384, PKCS1WithSHA1}, VersionTLS13, PSSWithSHA384, signatureRSAPSS, crypto.SHA384},
-		{ecdsaCert, []SignatureScheme{ECDSAWithSHA1}, VersionTLS12, ECDSAWithSHA1, signatureECDSA, crypto.SHA1},
-		{ecdsaCert, []SignatureScheme{ECDSAWithP256AndSHA256}, VersionTLS12, ECDSAWithP256AndSHA256, signatureECDSA, crypto.SHA256},
-		{ecdsaCert, []SignatureScheme{ECDSAWithP256AndSHA256}, VersionTLS13, ECDSAWithP256AndSHA256, signatureECDSA, crypto.SHA256},
-		{ed25519Cert, []SignatureScheme{Ed25519}, VersionTLS12, Ed25519, signatureEd25519, directSigning},
-		{ed25519Cert, []SignatureScheme{Ed25519}, VersionTLS13, Ed25519, signatureEd25519, directSigning},
+		{rsaCert, []SignatureScheme{PKCS1WithSHA1, PKCS1WithSHA256}, VersionTLS12, "", PKCS1WithSHA256, signaturePKCS1v15, crypto.SHA256},
+		{rsaCert, []SignatureScheme{PKCS1WithSHA1, PKCS1WithSHA256}, VersionTLS12, "tlssha1=1", PKCS1WithSHA1, signaturePKCS1v15, crypto.SHA1},
+		{rsaCert, []SignatureScheme{PKCS1WithSHA512, PKCS1WithSHA1}, VersionTLS12, "", PKCS1WithSHA512, signaturePKCS1v15, crypto.SHA512},
+		{rsaCert, []SignatureScheme{PSSWithSHA256, PKCS1WithSHA256}, VersionTLS12, "", PSSWithSHA256, signatureRSAPSS, crypto.SHA256},
+		{pkcs1Cert, []SignatureScheme{PSSWithSHA256, PKCS1WithSHA256}, VersionTLS12, "", PKCS1WithSHA256, signaturePKCS1v15, crypto.SHA256},
+		{rsaCert, []SignatureScheme{PSSWithSHA384, PKCS1WithSHA1}, VersionTLS13, "", PSSWithSHA384, signatureRSAPSS, crypto.SHA384},
+		{rsaCert, []SignatureScheme{PKCS1WithSHA1, PSSWithSHA384}, VersionTLS13, "", PSSWithSHA384, signatureRSAPSS, crypto.SHA384},
+		{ecdsaCert, []SignatureScheme{ECDSAWithSHA1, ECDSAWithP256AndSHA256}, VersionTLS12, "", ECDSAWithP256AndSHA256, signatureECDSA, crypto.SHA256},
+		{ecdsaCert, []SignatureScheme{ECDSAWithSHA1}, VersionTLS12, "tlssha1=1", ECDSAWithSHA1, signatureECDSA, crypto.SHA1},
+		{ecdsaCert, []SignatureScheme{ECDSAWithP256AndSHA256}, VersionTLS12, "", ECDSAWithP256AndSHA256, signatureECDSA, crypto.SHA256},
+		{ecdsaCert, []SignatureScheme{ECDSAWithP256AndSHA256}, VersionTLS13, "", ECDSAWithP256AndSHA256, signatureECDSA, crypto.SHA256},
+		{ed25519Cert, []SignatureScheme{Ed25519}, VersionTLS12, "", Ed25519, signatureEd25519, directSigning},
+		{ed25519Cert, []SignatureScheme{Ed25519}, VersionTLS13, "", Ed25519, signatureEd25519, directSigning},
 
 		// TLS 1.2 without signature_algorithms extension
-		{rsaCert, nil, VersionTLS12, PKCS1WithSHA1, signaturePKCS1v15, crypto.SHA1},
-		{ecdsaCert, nil, VersionTLS12, ECDSAWithSHA1, signatureECDSA, crypto.SHA1},
+		{rsaCert, nil, VersionTLS12, "tlssha1=1", PKCS1WithSHA1, signaturePKCS1v15, crypto.SHA1},
+		{ecdsaCert, nil, VersionTLS12, "tlssha1=1", ECDSAWithSHA1, signatureECDSA, crypto.SHA1},
 
 		// TLS 1.2 does not restrict the ECDSA curve (our ecdsaCert is P-256)
-		{ecdsaCert, []SignatureScheme{ECDSAWithP384AndSHA384}, VersionTLS12, ECDSAWithP384AndSHA384, signatureECDSA, crypto.SHA384},
+		{ecdsaCert, []SignatureScheme{ECDSAWithP384AndSHA384}, VersionTLS12, "", ECDSAWithP384AndSHA384, signatureECDSA, crypto.SHA384},
 	}
 
 	for testNo, test := range tests {
-		if fips140tls.Required() && (test.expectedHash == crypto.SHA1 || test.expectedSigAlg == Ed25519) {
+		if fips140tls.Required() && test.expectedHash == crypto.SHA1 {
 			t.Logf("skipping test[%d] - not compatible with TLS FIPS mode", testNo)
 			continue
 		}
+		savedGODEBUG := os.Getenv("GODEBUG")
+		os.Setenv("GODEBUG", savedGODEBUG+","+test.godebug)
 
 		sigAlg, err := selectSignatureScheme(test.tlsVersion, test.cert, test.peerSigAlgs)
 		if err != nil {
@@ -80,6 +87,8 @@ func TestSignatureSelection(t *testing.T) {
 		if test.expectedHash != hashFunc {
 			t.Errorf("test[%d]: expected hash function %#x, got %#x", testNo, test.expectedHash, hashFunc)
 		}
+
+		os.Setenv("GODEBUG", savedGODEBUG)
 	}
 
 	brokenCert := &Certificate{
@@ -116,6 +125,11 @@ func TestSignatureSelection(t *testing.T) {
 		{ecdsaCert, []SignatureScheme{ECDSAWithSHA1}, VersionTLS13},
 		// The key can be too small for the hash.
 		{rsaCert, []SignatureScheme{PSSWithSHA512}, VersionTLS12},
+		// SHA-1 requires tlssha1=1
+		{rsaCert, []SignatureScheme{PKCS1WithSHA1}, VersionTLS12},
+		{ecdsaCert, []SignatureScheme{ECDSAWithSHA1}, VersionTLS12},
+		{rsaCert, nil, VersionTLS12},
+		{ecdsaCert, nil, VersionTLS12},
 	}
 
 	for testNo, test := range badTests {
diff --git a/src/crypto/tls/bogo_config.json b/src/crypto/tls/bogo_config.json
index 6d764daa61..b88201a457 100644
--- a/src/crypto/tls/bogo_config.json
+++ b/src/crypto/tls/bogo_config.json
@@ -20,6 +20,8 @@
         "TLS-ECH-Client-Reject-NoChannelID-TLS13": "We don't support sending channel ID",
         "TLS-ECH-Client-Reject-NoChannelID-TLS12": "We don't support sending channel ID",
 
+        "ServerAuth-SHA1-Fallback*": "We don't ever support SHA-1 in TLS 1.2, so we fail if there are no signature_algorithms",
+
         "TLS-ECH-Client-GREASE-IgnoreHRRExtension": "We don't support ECH GREASE because we don't fallback to plaintext",
         "TLS-ECH-Client-NoSupportedConfigs-GREASE": "We don't support ECH GREASE because we don't fallback to plaintext",
         "TLS-ECH-Client-GREASEExtensions": "We don't support ECH GREASE because we don't fallback to plaintext",
diff --git a/src/crypto/tls/defaults.go b/src/crypto/tls/defaults.go
index 07986294ec..3aa1bc2e4c 100644
--- a/src/crypto/tls/defaults.go
+++ b/src/crypto/tls/defaults.go
@@ -24,11 +24,29 @@ func defaultCurvePreferences() []CurveID {
 	return []CurveID{X25519MLKEM768, X25519, CurveP256, CurveP384, CurveP521}
 }
 
+var tlssha1 = godebug.New("tlssha1")
+
 // defaultSupportedSignatureAlgorithms returns the signature and hash algorithms that
 // the code advertises and supports in a TLS 1.2+ ClientHello and in a TLS 1.2+
 // CertificateRequest. The two fields are merged to match with TLS 1.3.
 // Note that in TLS 1.2, the ECDSA algorithms are not constrained to P-256, etc.
 func defaultSupportedSignatureAlgorithms() []SignatureScheme {
+	if tlssha1.Value() == "1" {
+		return []SignatureScheme{
+			PSSWithSHA256,
+			ECDSAWithP256AndSHA256,
+			Ed25519,
+			PSSWithSHA384,
+			PSSWithSHA512,
+			PKCS1WithSHA256,
+			PKCS1WithSHA384,
+			PKCS1WithSHA512,
+			ECDSAWithP384AndSHA384,
+			ECDSAWithP521AndSHA512,
+			PKCS1WithSHA1,
+			ECDSAWithSHA1,
+		}
+	}
 	return []SignatureScheme{
 		PSSWithSHA256,
 		ECDSAWithP256AndSHA256,
@@ -40,8 +58,6 @@ func defaultSupportedSignatureAlgorithms() []SignatureScheme {
 		PKCS1WithSHA512,
 		ECDSAWithP384AndSHA384,
 		ECDSAWithP521AndSHA512,
-		PKCS1WithSHA1,
-		ECDSAWithSHA1,
 	}
 }
 
diff --git a/src/crypto/tls/handshake_client.go b/src/crypto/tls/handshake_client.go
index 619b47afbf..2d3a2ef25b 100644
--- a/src/crypto/tls/handshake_client.go
+++ b/src/crypto/tls/handshake_client.go
@@ -828,6 +828,10 @@ func (hs *clientHandshakeState) doFullHandshake() error {
 			}
 			certVerify.hasSignatureAlgorithm = true
 			certVerify.signatureAlgorithm = signatureAlgorithm
+			if sigHash == crypto.SHA1 {
+				tlssha1.Value() // ensure godebug is initialized
+				tlssha1.IncNonDefault()
+			}
 		} else {
 			sigType, sigHash, err = legacyTypeAndHashFromPublicKey(key.Public())
 			if err != nil {
diff --git a/src/crypto/tls/handshake_server.go b/src/crypto/tls/handshake_server.go
index 522d3b62c2..6848407e74 100644
--- a/src/crypto/tls/handshake_server.go
+++ b/src/crypto/tls/handshake_server.go
@@ -772,6 +772,10 @@ func (hs *serverHandshakeState) doFullHandshake() error {
 			if err != nil {
 				return c.sendAlert(alertInternalError)
 			}
+			if sigHash == crypto.SHA1 {
+				tlssha1.Value() // ensure godebug is initialized
+				tlssha1.IncNonDefault()
+			}
 		} else {
 			sigType, sigHash, err = legacyTypeAndHashFromPublicKey(pub)
 			if err != nil {
diff --git a/src/crypto/tls/key_agreement.go b/src/crypto/tls/key_agreement.go
index d41bf43591..3daa1aa40b 100644
--- a/src/crypto/tls/key_agreement.go
+++ b/src/crypto/tls/key_agreement.go
@@ -215,6 +215,10 @@ func (ka *ecdheKeyAgreement) generateServerKeyExchange(config *Config, cert *Cer
 		if err != nil {
 			return nil, err
 		}
+		if sigHash == crypto.SHA1 {
+			tlssha1.Value() // ensure godebug is initialized
+			tlssha1.IncNonDefault()
+		}
 	} else {
 		sigType, sigHash, err = legacyTypeAndHashFromPublicKey(priv.Public())
 		if err != nil {
@@ -339,6 +343,10 @@ func (ka *ecdheKeyAgreement) processServerKeyExchange(config *Config, clientHell
 		if err != nil {
 			return err
 		}
+		if sigHash == crypto.SHA1 {
+			tlssha1.Value() // ensure godebug is initialized
+			tlssha1.IncNonDefault()
+		}
 	} else {
 		sigType, sigHash, err = legacyTypeAndHashFromPublicKey(cert.PublicKey)
 		if err != nil {
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA
index 1a97323780..3bd86fd90e 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 5d 02 00 00  59 03 01 5f db 69 f3 84  |....]...Y.._.i..|
-00000010  2a 34 27 ec 75 af b4 38  e7 d4 ec 19 70 1a 17 0e  |*4'.u..8....p...|
-00000020  4d 94 8f 93 b7 88 ba cf  60 be e3 20 10 53 38 8a  |M.......`.. .S8.|
-00000030  85 c2 1b 7d e3 21 e2 a8  6b 9f 34 dc c1 a0 38 3e  |...}.!..k.4...8>|
-00000040  66 81 bb c4 1c b8 c5 70  ce 28 81 bf c0 09 00 00  |f......p.(......|
+00000000  16 03 01 00 5d 02 00 00  59 03 01 1a 76 c4 d5 b5  |....]...Y...v...|
+00000010  7e 30 1c 1e c3 62 8b 92  a8 19 9b 62 4e 36 a1 d3  |~0...b.....bN6..|
+00000020  c8 e3 55 f6 64 5f 06 aa  19 9a 48 20 24 a4 2d a9  |..U.d_....H $.-.|
+00000030  8a bd cf 4e 9b cf 7d c7  8e 8f e8 ed f5 09 37 ad  |...N..}.......7.|
+00000040  06 c9 6b a4 d5 de 7f 07  07 a6 9d c7 c0 09 00 00  |..k.............|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 01 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
 00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
@@ -58,20 +57,20 @@
 00000240  8c 25 c1 33 13 83 0d 94  06 bb d4 37 7a f6 ec 7a  |.%.3.......7z..z|
 00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
 00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
-00000270  95 12 07 8f 2a 16 03 01  00 b4 0c 00 00 b0 03 00  |....*...........|
-00000280  1d 20 07 a5 80 41 74 22  47 af 5d 75 5e ae bd eb  |. ...At"G.]u^...|
-00000290  20 93 4c d3 d1 c6 d0 4b  f8 68 f4 58 fc 88 ca 2a  | .L....K.h.X...*|
-000002a0  8b 08 00 8a 30 81 87 02  41 68 37 4f 22 15 13 23  |....0...Ah7O"..#|
-000002b0  1b 03 6b f2 e1 8b bf 2a  88 4b 14 b3 85 58 ae 5a  |..k....*.K...X.Z|
-000002c0  11 14 9a a3 24 77 c6 a3  a2 8c 12 ae 5c 78 ec 26  |....$w......\x.&|
-000002d0  24 49 b0 57 30 4e 46 71  5b a8 c4 3f 26 09 85 14  |$I.W0NFq[..?&...|
-000002e0  48 3a 8c 4b bf c9 c0 24  1b c1 02 42 01 e1 92 35  |H:.K...$...B...5|
-000002f0  a7 1f 8e ae 3d 3d 0d 89  cc 94 a9 e5 1a 27 6b c1  |....==.......'k.|
-00000300  89 f8 8a 4c ad 8e 84 6f  65 e9 19 ce 99 73 10 4e  |...L...oe....s.N|
-00000310  61 2a 31 19 60 bd ac 37  20 9f 54 90 a5 e2 3a 79  |a*1.`..7 .T...:y|
-00000320  98 a4 1a b4 30 2b 9f 08  86 41 ac f1 4e d7 16 03  |....0+...A..N...|
-00000330  01 00 0a 0d 00 00 06 03  01 02 40 00 00 16 03 01  |..........@.....|
-00000340  00 04 0e 00 00 00                                 |......|
+00000270  95 12 07 8f 2a 16 03 01  00 b5 0c 00 00 b1 03 00  |....*...........|
+00000280  1d 20 3e 61 33 da 82 02  f5 6d 70 2d e5 07 df 43  |. >a3....mp-...C|
+00000290  d7 e6 1a b2 81 3e 58 03  dc 27 37 34 3b 2e 5a d5  |.....>X..'74;.Z.|
+000002a0  d4 1a 00 8b 30 81 88 02  42 00 8b 0c f4 0f fe 8c  |....0...B.......|
+000002b0  01 70 3a c5 e5 29 53 1c  ad 6c f4 35 53 e3 e6 ce  |.p:..)S..l.5S...|
+000002c0  19 21 03 de f5 e3 df 8e  e5 6b 43 00 08 b7 24 2c  |.!.......kC...$,|
+000002d0  27 9e 2b bc 2f 96 07 a0  f9 a9 6b d4 b7 75 a8 5d  |'.+./.....k..u.]|
+000002e0  99 13 ab 5a dd 35 56 08  6d 9c a1 02 42 01 29 62  |...Z.5V.m...B.)b|
+000002f0  b9 64 8b 6d 91 b7 f5 59  73 9d 2d bc 9d 9a 5b 43  |.d.m...Ys.-...[C|
+00000300  d8 d5 76 be 2a 8f c5 f0  2e 5d a8 be 7b d0 36 fe  |..v.*....]..{.6.|
+00000310  62 97 7f 17 96 f6 c3 b4  06 2a e2 cb 77 80 ff 28  |b........*..w..(|
+00000320  02 64 cb bb c7 a9 77 4b  96 7d 07 11 7e e8 28 16  |.d....wK.}..~.(.|
+00000330  03 01 00 0a 0d 00 00 06  03 01 02 40 00 00 16 03  |...........@....|
+00000340  01 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 01 02 0a 0b 00 02  06 00 02 03 00 02 00 30  |...............0|
 00000010  82 01 fc 30 82 01 5e 02  09 00 9a 30 84 6c 26 35  |...0..^....0.l&5|
@@ -108,30 +107,30 @@
 00000200  e4 fa cc b1 8a ce e2 23  a0 87 f0 e1 67 51 eb 16  |.......#....gQ..|
 00000210  03 01 00 25 10 00 00 21  20 2f e5 7d a3 47 cd 62  |...%...! /.}.G.b|
 00000220  43 15 28 da ac 5f bb 29  07 30 ff f6 84 af c4 cf  |C.(.._.).0......|
-00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 01 00 8f 0f 00  |...._X.;t.......|
-00000240  00 8b 00 89 30 81 86 02  41 7c e1 65 0a 33 fc 66  |....0...A|.e.3.f|
-00000250  85 e8 a7 9d a8 e0 12 1e  8c fa 53 00 2a 1b 70 dc  |..........S.*.p.|
-00000260  00 ba 15 e9 b2 fa 95 b1  c2 36 b6 a4 dd 4c 6c c2  |.........6...Ll.|
-00000270  d9 11 cb 12 90 c2 1e ea  7f 4c e4 94 3a a4 c6 ba  |.........L..:...|
-00000280  66 3d b9 fa 3a af 0b 74  e5 1e 02 41 30 b2 11 4f  |f=..:..t...A0..O|
-00000290  f5 06 97 76 2d c9 7c 95  df 44 ba fe 81 2d f4 3f  |...v-.|..D...-.?|
-000002a0  e0 25 81 16 90 80 60 7b  bd 88 14 b3 a4 ef 63 21  |.%....`{......c!|
-000002b0  46 0c 15 a3 bd 1a 4d 3d  fd a2 d7 3a ff bd 15 94  |F.....M=...:....|
-000002c0  40 60 d8 42 14 41 18 7e  55 ab 71 a7 9c 14 03 01  |@`.B.A.~U.q.....|
-000002d0  00 01 01 16 03 01 00 30  3d 4f 1e dd 66 64 5a c2  |.......0=O..fdZ.|
-000002e0  bc 12 e9 63 d8 95 34 7c  6c 93 66 c6 12 54 5c d0  |...c..4|l.f..T\.|
-000002f0  2b 2a 7e 20 4f fc 62 19  5d be 55 1f 82 8a 6c 9b  |+*~ O.b.].U...l.|
-00000300  85 7c b8 db 29 65 d7 7b                           |.|..)e.{|
+00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 01 00 90 0f 00  |...._X.;t.......|
+00000240  00 8c 00 8a 30 81 87 02  41 46 5f cc 88 bc 2b e5  |....0...AF_...+.|
+00000250  20 33 a9 ff 52 bb 25 dc  cf a1 08 45 b5 82 9a 1b  | 3..R.%....E....|
+00000260  53 04 18 b4 23 20 c4 d2  d8 92 9b 21 a7 ec 36 d6  |S...# .....!..6.|
+00000270  63 35 68 4c 21 c4 0e 20  07 0c 8f 38 2f 9b b7 9e  |c5hL!.. ...8/...|
+00000280  e7 9d 6d ea da 1c a6 f1  c5 d3 02 42 01 ed 54 c8  |..m........B..T.|
+00000290  9e b2 45 f1 1f 77 ee e3  a7 3a 40 9b fe 9b 1d 38  |..E..w...:@....8|
+000002a0  ff 9b b4 c6 e7 94 07 b8  5f 93 bd 38 8d 31 dd 80  |........_..8.1..|
+000002b0  2f 82 6e b5 85 8f 15 8b  cd b2 04 81 e2 0b 2a fa  |/.n...........*.|
+000002c0  d9 4b 47 0b 86 26 8b 4e  83 a6 15 9e 93 15 14 03  |.KG..&.N........|
+000002d0  01 00 01 01 16 03 01 00  30 f3 06 0e 6f 16 1b 0b  |........0...o...|
+000002e0  46 54 37 fd c6 80 0f ec  4b dd d7 d4 17 b2 d7 8d  |FT7.....K.......|
+000002f0  4e 6a 7f 2a af d2 ea 19  11 8f 23 57 b7 e7 2f b3  |Nj.*......#W../.|
+00000300  97 f6 93 3f ac 0d 5c f8  f5                       |...?..\..|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 1c 42 dd c3 b4  |..........0.B...|
-00000010  9e e8 53 fa 2f 12 1c 80  89 97 ec 99 aa 75 04 e4  |..S./........u..|
-00000020  19 b9 7f 7f e5 61 53 8e  3f a5 1d 1a cb 02 8a 7a  |.....aS.?......z|
-00000030  f3 26 77 2d a0 23 c5 41  e1 fe 5c                 |.&w-.#.A..\|
+00000000  14 03 01 00 01 01 16 03  01 00 30 03 aa a1 4c bf  |..........0...L.|
+00000010  ab 53 f3 96 e7 db b1 a4  d7 19 f7 2f c0 b7 32 ea  |.S........./..2.|
+00000020  bd f3 4a 7c 0d 4c df a4  5f a0 3d f3 1b 57 65 a1  |..J|.L.._.=..We.|
+00000030  d1 31 ae 52 6e ed 15 d2  d9 23 68                 |.1.Rn....#h|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 6f 19 91  24 21 15 50 56 db 29 4f  |.... o..$!.PV.)O|
-00000010  0c e5 d7 85 02 7b dc 76  4f ac ac a1 7d d3 02 07  |.....{.vO...}...|
-00000020  ca c2 1d e0 f5 17 03 01  00 20 f2 f4 da dc e9 c7  |......... ......|
-00000030  c3 60 af d9 7e a4 5f be  80 1d fe a1 ef 98 22 dd  |.`..~._.......".|
-00000040  8f 93 06 22 c3 a2 b1 ed  48 5e 15 03 01 00 20 6b  |..."....H^.... k|
-00000050  2b 7e 37 08 37 21 4e 80  6f 10 e8 d9 30 56 22 aa  |+~7.7!N.o...0V".|
-00000060  f6 c7 fe 33 69 b6 12 f1  11 83 14 12 b5 73 35     |...3i........s5|
+00000000  17 03 01 00 20 aa 0c f4  30 17 b7 59 47 33 91 07  |.... ...0..YG3..|
+00000010  cc 52 7b 52 f8 a0 82 44  25 03 0e b4 45 6e 0c 5a  |.R{R...D%...En.Z|
+00000020  37 6d d6 6d 80 17 03 01  00 20 bc c7 70 3b 94 cc  |7m.m..... ..p;..|
+00000030  09 db 15 84 d8 b9 c5 cf  d6 01 91 93 5b 20 5a b1  |............[ Z.|
+00000040  6a 43 23 30 7e 02 ea 8b  e0 28 15 03 01 00 20 c2  |jC#0~....(.... .|
+00000050  7f c9 90 b3 ef c6 52 68  44 df 05 30 17 39 d9 42  |......RhD..0.9.B|
+00000060  76 7a 1d a1 17 2b fa b4  92 ca 40 a9 58 d4 87     |vz...+....@.X..|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA
index a63734b648..de3de89cd1 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 5d 02 00 00  59 03 01 f6 fc 17 31 02  |....]...Y.....1.|
-00000010  7c 2a e4 6d 3a e7 ae a0  d9 a5 4e 59 88 a6 9c 09  ||*.m:.....NY....|
-00000020  ed 6b a1 6d fb 80 03 72  14 63 93 20 47 4b 39 ed  |.k.m...r.c. GK9.|
-00000030  48 93 f6 9e 80 e0 2a d7  75 30 81 47 b6 94 7a 75  |H.....*.u0.G..zu|
-00000040  1d 29 1f 4a fc 69 5f 92  7f d4 5f dc c0 13 00 00  |.).J.i_..._.....|
+00000000  16 03 01 00 5d 02 00 00  59 03 01 fc 68 73 9f 1a  |....]...Y...hs..|
+00000010  9d 3b 9b f9 10 cf b5 84  b9 31 f4 a8 e9 47 ab 33  |.;.......1...G.3|
+00000020  55 42 0b c0 f2 8e fa e7  a0 39 55 20 56 cd 87 f6  |UB.......9U V...|
+00000030  05 e0 b1 e9 aa b8 b2 ca  33 9d 46 02 fd d8 f0 11  |........3.F.....|
+00000040  0e fc 96 7e b4 fa fc c2  f3 da c4 2b c0 13 00 00  |...~.......+....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 01 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -63,17 +62,17 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 01 00 aa 0c 00 00  a6 03 00 1d 20 2b b0 b2  |............ +..|
-000002d0  f5 17 4b 53 12 c2 b0 12  dc 16 c3 ff 62 b4 18 d9  |..KS........b...|
-000002e0  7f 1a ef e5 a8 b2 98 ea  aa a7 4f 61 01 00 80 2a  |..........Oa...*|
-000002f0  20 54 cc 3b a3 8e f5 db  04 fa 09 7b b1 bf 8a 79  | T.;.......{...y|
-00000300  25 e9 7b 5f 13 0a 3a 23  32 c9 60 90 7c 02 0e 7d  |%.{_..:#2.`.|..}|
-00000310  7f 88 8f 79 73 f7 c8 7c  fe c6 88 d1 d2 c8 88 53  |...ys..|.......S|
-00000320  0f c4 f9 e3 61 28 9d 56  f3 84 eb 88 99 b6 8e a9  |....a(.V........|
-00000330  e4 72 ec 01 a3 81 61 97  45 ab 90 cd 2a 50 a4 68  |.r....a.E...*P.h|
-00000340  35 09 9f d8 99 54 bd 9f  af 6e 63 77 2b 00 a1 e3  |5....T...ncw+...|
-00000350  d6 f8 ab 08 39 3f df 42  55 4c f7 58 69 e8 db 76  |....9?.BUL.Xi..v|
-00000360  43 24 37 5b 65 2c 17 80  c9 c1 50 ba 76 06 71 16  |C$7[e,....P.v.q.|
+000002c0  16 03 01 00 aa 0c 00 00  a6 03 00 1d 20 74 0e 72  |............ t.r|
+000002d0  d9 71 10 de 9b f7 59 f0  c0 a2 b9 35 68 6a 3d f3  |.q....Y....5hj=.|
+000002e0  27 fb 13 3d a1 c0 4c f6  17 9b f1 25 50 00 80 c2  |'..=..L....%P...|
+000002f0  20 fd 4f 8b c9 6a fc 97  61 9d b3 b0 1d 2d 9a 2f  | .O..j..a....-./|
+00000300  90 15 44 a7 04 01 0b 6f  a9 47 5d a1 46 aa 30 f1  |..D....o.G].F.0.|
+00000310  5f 9b db 4d 8d 7a a4 99  3f 5c cb 4a ff 0a 49 b1  |_..M.z..?\.J..I.|
+00000320  fc df 0a f7 31 90 a9 98  cd da 8c 49 a5 1f 0f c7  |....1......I....|
+00000330  48 63 ee ff a8 fb 07 0a  fe e1 d7 1b ed b3 3f ce  |Hc............?.|
+00000340  39 ef bb 50 e9 a0 f4 c1  6f a6 7e 5b c8 36 1a 76  |9..P....o.~[.6.v|
+00000350  c8 00 3b e2 04 98 88 f1  fa 56 34 8f 02 86 0a 8e  |..;......V4.....|
+00000360  29 4f eb 70 fb 2f 21 ed  8d fa a9 91 66 c9 c0 16  |)O.p./!.....f...|
 00000370  03 01 00 0a 0d 00 00 06  03 01 02 40 00 00 16 03  |...........@....|
 00000380  01 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
@@ -112,30 +111,30 @@
 00000200  e4 fa cc b1 8a ce e2 23  a0 87 f0 e1 67 51 eb 16  |.......#....gQ..|
 00000210  03 01 00 25 10 00 00 21  20 2f e5 7d a3 47 cd 62  |...%...! /.}.G.b|
 00000220  43 15 28 da ac 5f bb 29  07 30 ff f6 84 af c4 cf  |C.(.._.).0......|
-00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 01 00 90 0f 00  |...._X.;t.......|
-00000240  00 8c 00 8a 30 81 87 02  41 0d b5 15 00 c4 b1 af  |....0...A.......|
-00000250  33 ea 88 c2 cc 9a 1c 16  3d a0 15 bf 20 ef b2 28  |3.......=... ..(|
-00000260  de 8b 36 b4 3a 2f df 8b  b4 7e 3b a4 ad c1 04 32  |..6.:/...~;....2|
-00000270  56 6c 8f 07 ab 3c dc d7  6f 66 41 96 bc 74 e9 4a  |Vl...<..ofA..t.J|
-00000280  55 00 c4 32 df 22 26 6b  98 0d 02 42 01 67 6e 97  |U..2."&k...B.gn.|
-00000290  8b 55 e8 57 74 d8 2e c5  a4 25 1a b6 08 a5 b1 f0  |.U.Wt....%......|
-000002a0  99 26 9c 24 b3 02 82 55  0d d9 3a 13 55 f1 cb cc  |.&.$...U..:.U...|
-000002b0  84 fd b7 5d 82 dd 26 d4  c6 4c 4a 27 ae 08 e7 57  |...]..&..LJ'...W|
-000002c0  74 a3 91 b9 6c f6 50 bb  d9 34 e5 4b c2 66 14 03  |t...l.P..4.K.f..|
-000002d0  01 00 01 01 16 03 01 00  30 be 86 48 b8 3d f0 1e  |........0..H.=..|
-000002e0  b7 58 d4 b6 54 88 b4 57  1d 7d 5c 3f 17 ff 41 6f  |.X..T..W.}\?..Ao|
-000002f0  a4 60 57 21 86 bb 77 d9  dd af 96 fb eb c8 b0 86  |.`W!..w.........|
-00000300  18 e2 00 4a 1b 92 67 75  5a                       |...J..guZ|
+00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 01 00 91 0f 00  |...._X.;t.......|
+00000240  00 8d 00 8b 30 81 88 02  42 00 88 3e 14 10 fa b5  |....0...B..>....|
+00000250  65 d8 03 71 7e b7 44 a5  db 04 85 d2 f4 5d c5 de  |e..q~.D......]..|
+00000260  71 e4 f9 ad 5e 47 6c 83  eb 6a 2b fc 8d 60 6b 1b  |q...^Gl..j+..`k.|
+00000270  55 89 7b 03 60 fb 9c b2  b1 42 ef 02 63 29 59 03  |U.{.`....B..c)Y.|
+00000280  02 a8 48 4d 9a 3d f3 e9  6b ac 76 02 42 01 90 36  |..HM.=..k.v.B..6|
+00000290  5d d0 ec dd 76 75 0c 97  66 7f 10 ec 1d 39 5e bb  |]...vu..f....9^.|
+000002a0  2c 81 9e 15 fa 59 3f e8  77 3f 33 03 b6 2d 02 5a  |,....Y?.w?3..-.Z|
+000002b0  28 82 53 7a 18 69 29 5b  d9 7d ce 4f 94 d9 69 29  |(.Sz.i)[.}.O..i)|
+000002c0  b2 84 87 4a 15 47 c6 da  6f c3 df ca 8a 58 0b 14  |...J.G..o....X..|
+000002d0  03 01 00 01 01 16 03 01  00 30 89 15 96 15 9d 93  |.........0......|
+000002e0  e3 ae 94 14 f9 ea 39 d7  3b d6 98 e1 ed c8 0a 3f  |......9.;......?|
+000002f0  6f 2c a2 9b cd c5 ea 1a  1f 27 89 1a 7d ff 60 07  |o,.......'..}.`.|
+00000300  22 1f bc b8 56 3a ee 24  5a ff                    |"...V:.$Z.|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 81 55 c5 00 ab  |..........0.U...|
-00000010  7e 16 3e 35 25 2a 86 0d  bf 69 17 1f e7 13 fd 6c  |~.>5%*...i.....l|
-00000020  a7 3e 63 e6 23 57 1e 63  ca 1f 1a ea 76 df c1 9e  |.>c.#W.c....v...|
-00000030  c9 ee fc 23 8a ec e0 e9  78 38 cb                 |...#....x8.|
+00000000  14 03 01 00 01 01 16 03  01 00 30 bf 0c 82 bd 43  |..........0....C|
+00000010  ba 60 ec df 88 4d 48 be  d5 c4 0c b5 7d c4 94 c4  |.`...MH.....}...|
+00000020  15 6e 50 45 77 56 ce d5  e0 4c 15 fc da 96 0b 41  |.nPEwV...L.....A|
+00000030  fd 70 39 e9 33 3f 57 77  f5 a3 67                 |.p9.3?Ww..g|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 6f 5c 74  f2 48 38 66 86 fe 54 d9  |.... o\t.H8f..T.|
-00000010  69 ec a9 91 d4 4d 07 98  7d df 19 1f fd ec c2 d5  |i....M..}.......|
-00000020  b5 49 a7 0a 05 17 03 01  00 20 62 0d 0e 63 82 cf  |.I....... b..c..|
-00000030  74 e1 eb dd 2f 4f 05 92  7a 08 34 ff 84 6e 13 7f  |t.../O..z.4..n..|
-00000040  21 cb f6 92 c4 d1 4d 49  31 9f 15 03 01 00 20 f1  |!.....MI1..... .|
-00000050  53 aa 8e 29 2c 58 3a 9b  c3 a1 dc 85 ce d1 70 c3  |S..),X:.......p.|
-00000060  06 53 1d 66 4d 51 a5 33  4c 53 41 e8 ac 1b 10     |.S.fMQ.3LSA....|
+00000000  17 03 01 00 20 50 1e 02  79 6b 4b 67 77 bb c0 a7  |.... P..ykKgw...|
+00000010  ef 5a c1 cc bc 28 14 86  2c 83 4f 3f 34 97 c4 73  |.Z...(..,.O?4..s|
+00000020  24 44 ad 59 8c 17 03 01  00 20 e3 52 89 d7 d1 9a  |$D.Y..... .R....|
+00000030  33 21 78 e4 41 36 b1 11  74 c0 73 fb ea c9 42 88  |3!x.A6..t.s...B.|
+00000040  7f 71 ea 40 a0 3a 62 54  dc b7 15 03 01 00 20 4a  |.q.@.:bT...... J|
+00000050  ff f4 c6 c0 5f fd e2 b3  bd 4a a9 aa 19 64 2d 98  |...._....J...d-.|
+00000060  f1 ea 56 4e 3a c9 1c be  8d fb c3 6c 2f 98 ff     |..VN:......l/..|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA
index 8f1ff3f1d3..8ce1bad190 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 5d 02 00 00  59 03 01 79 7e 8c 72 46  |....]...Y..y~.rF|
-00000010  e6 1a d5 db 83 07 37 34  cf f5 84 39 87 af 5f 23  |......74...9.._#|
-00000020  47 f9 e2 9d c0 76 e8 6a  7e 88 9c 20 a3 c7 5b 94  |G....v.j~.. ..[.|
-00000030  8f 63 f2 ac 89 b5 ed ee  e0 8f 87 be 2a 3e f1 6c  |.c..........*>.l|
-00000040  2f ca cc d0 ee 22 4c a9  ed 03 5e 18 c0 09 00 00  |/...."L...^.....|
+00000000  16 03 01 00 5d 02 00 00  59 03 01 ef c9 5c 4d 29  |....]...Y....\M)|
+00000010  07 24 2a 41 08 94 39 cc  d3 fb 92 88 1c ff 64 6b  |.$*A..9.......dk|
+00000020  0a 14 41 89 c6 5d 9b 25  7e a7 04 20 a0 aa ad 46  |..A..].%~.. ...F|
+00000030  14 01 d2 dd 37 44 05 4b  1d 9f ea e5 98 29 1e 36  |....7D.K.....).6|
+00000040  09 e2 ab 90 93 ee c1 99  7d 17 77 9b c0 09 00 00  |........}.w.....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 01 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
 00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
@@ -58,20 +57,20 @@
 00000240  8c 25 c1 33 13 83 0d 94  06 bb d4 37 7a f6 ec 7a  |.%.3.......7z..z|
 00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
 00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
-00000270  95 12 07 8f 2a 16 03 01  00 b3 0c 00 00 af 03 00  |....*...........|
-00000280  1d 20 37 50 ab 46 a8 24  be 20 fd 71 c2 8d 91 a0  |. 7P.F.$. .q....|
-00000290  88 88 0b 18 f5 ec 43 99  cb 63 45 9c ad b4 27 20  |......C..cE...' |
-000002a0  0d 11 00 89 30 81 86 02  41 35 1d fa 6c 1b a1 b4  |....0...A5..l...|
-000002b0  bc 5f 4d a6 77 64 8d e1  92 94 97 53 c5 01 c2 bb  |._M.wd.....S....|
-000002c0  5c 83 f0 c2 6d 6d d1 1f  ff 7a 00 06 4a a0 de c0  |\...mm...z..J...|
-000002d0  aa a1 9f 6d f6 62 20 d0  08 1e 5b bc 1d af 03 45  |...m.b ...[....E|
-000002e0  d5 70 8b ee d8 a8 ff 3e  2b 7d 02 41 28 ff 3e 45  |.p.....>+}.A(.>E|
-000002f0  7f ec c1 87 df dd 14 8b  64 08 84 02 2b de ff 14  |........d...+...|
-00000300  b9 6f 54 72 b1 a2 99 47  55 2d 76 91 77 ba 4f db  |.oTr...GU-v.w.O.|
-00000310  a3 4c ab 21 62 48 3a 8d  f7 32 57 12 dc 6c a9 51  |.L.!bH:..2W..l.Q|
-00000320  77 cc b3 30 1f e9 41 bf  0b b3 4b a5 e4 16 03 01  |w..0..A...K.....|
-00000330  00 0a 0d 00 00 06 03 01  02 40 00 00 16 03 01 00  |.........@......|
-00000340  04 0e 00 00 00                                    |.....|
+00000270  95 12 07 8f 2a 16 03 01  00 b4 0c 00 00 b0 03 00  |....*...........|
+00000280  1d 20 a4 4e 43 df 00 5c  c7 1c e8 d4 8e 9b cf b0  |. .NC..\........|
+00000290  36 85 64 7c d7 69 95 c0  b4 6f d8 0b 45 b8 a4 34  |6.d|.i...o..E..4|
+000002a0  1a 18 00 8a 30 81 87 02  42 01 d0 4a 3f 65 9d 46  |....0...B..J?e.F|
+000002b0  20 80 34 28 12 93 56 6e  dc e4 0e 91 0b 45 4b 83  | .4(..Vn.....EK.|
+000002c0  c5 e9 83 2c 41 d6 dc 49  15 15 e6 65 9f 18 ba a6  |...,A..I...e....|
+000002d0  20 a6 de c7 20 7e 09 71  e6 59 86 9e aa 32 be 43  | ... ~.q.Y...2.C|
+000002e0  b7 c3 27 98 ba 5b 49 9b  1d b9 67 02 41 4e 36 0e  |..'..[I...g.AN6.|
+000002f0  6d 29 c8 7d 0b d9 6f 06  92 ca 0b b9 33 7e 11 58  |m).}..o.....3~.X|
+00000300  2f cc 06 ae ad 57 80 f4  38 a1 8a e3 6a ef 37 86  |/....W..8...j.7.|
+00000310  58 1a 59 f9 4a 9a 64 89  5b 7c 8a 7a c5 78 dd b5  |X.Y.J.d.[|.z.x..|
+00000320  6c 96 b8 23 ff fc 88 20  59 0b e9 74 99 b9 16 03  |l..#... Y..t....|
+00000330  01 00 0a 0d 00 00 06 03  01 02 40 00 00 16 03 01  |..........@.....|
+00000340  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
 00000000  16 03 01 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
 00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
@@ -108,29 +107,29 @@
 00000200  e5 35 16 03 01 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
 00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 01 00  |......._X.;t....|
-00000230  86 0f 00 00 82 00 80 22  5d 5b 59 98 4a a8 53 6b  |......."][Y.J.Sk|
-00000240  78 1d 8f 51 a1 23 6a 87  fb 9d 79 5c 63 9d dc 61  |x..Q.#j...y\c..a|
-00000250  13 9f a1 36 f9 fa ec a0  6f 47 11 d6 7c 8f a4 81  |...6....oG..|...|
-00000260  fb f1 31 59 11 6c 8e 83  1c 56 3b 03 b4 a9 e0 09  |..1Y.l...V;.....|
-00000270  aa 04 c4 d1 7a c5 28 03  ae ce fe a0 95 1b 8c 5c  |....z.(........\|
-00000280  65 32 ca f0 d5 43 fc 9b  e0 8e ca 80 f3 e0 5f 8d  |e2...C........_.|
-00000290  6d 91 ff f2 4b 7b a7 38  64 dd e8 a8 d8 1f 95 31  |m...K{.8d......1|
-000002a0  04 a9 6c 72 45 9c 0d a3  80 60 8e 20 8a af f7 ae  |..lrE....`. ....|
-000002b0  87 10 26 51 0e a5 e8 14  03 01 00 01 01 16 03 01  |..&Q............|
-000002c0  00 30 46 9b a2 75 16 a9  c2 ac d7 47 ca 41 48 bd  |.0F..u.....G.AH.|
-000002d0  2c 3d 56 e3 a4 21 a6 c0  d8 71 6d fb 4a c6 9a a1  |,=V..!...qm.J...|
-000002e0  88 db a5 70 58 e0 e3 5a  c7 62 d1 d4 0f 4b c6 55  |...pX..Z.b...K.U|
-000002f0  0c aa                                             |..|
+00000230  86 0f 00 00 82 00 80 a4  68 2d 1f 8a 97 43 76 aa  |........h-...Cv.|
+00000240  f9 24 95 20 62 13 c0 a3  45 c6 18 1c a3 34 70 02  |.$. b...E....4p.|
+00000250  ff f5 01 4e ba e2 20 1c  f9 06 a6 67 92 d9 e6 9d  |...N.. ....g....|
+00000260  a3 49 e0 75 3e 11 00 74  52 b1 36 58 4b 1e 54 83  |.I.u>..tR.6XK.T.|
+00000270  e0 9a 48 4d df 2c ab fd  cd 5e 7a cf c9 b8 32 08  |..HM.,...^z...2.|
+00000280  74 e6 ae 75 20 f4 41 3a  7c a9 a3 19 38 a0 8d 05  |t..u .A:|...8...|
+00000290  0a e9 3e 50 6c f6 f8 a3  89 a9 55 ea dc 3f be b1  |..>Pl.....U..?..|
+000002a0  0a 92 83 cc f0 9b c9 e1  49 13 db 64 be 55 46 b5  |........I..d.UF.|
+000002b0  12 b1 0b 88 32 e3 f1 14  03 01 00 01 01 16 03 01  |....2...........|
+000002c0  00 30 81 77 0f 6c 7a bc  a8 d2 41 f9 8b a7 da 96  |.0.w.lz...A.....|
+000002d0  29 f1 2f b1 31 f3 57 03  09 21 5c fa dc f7 5c f6  |)./.1.W..!\...\.|
+000002e0  7f a8 24 08 30 70 bb 34  16 22 f8 c6 b2 4d a7 16  |..$.0p.4."...M..|
+000002f0  68 61                                             |ha|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 6b ab 63 56 79  |..........0k.cVy|
-00000010  32 ef f9 df c5 36 29 50  f5 1d 55 c2 4b 84 f5 68  |2....6)P..U.K..h|
-00000020  b0 d8 7d 7d 80 24 e2 5d  b9 0f 66 25 4e 50 21 08  |..}}.$.]..f%NP!.|
-00000030  a3 15 de 0e 04 ef 86 d6  04 2e 9b                 |...........|
+00000000  14 03 01 00 01 01 16 03  01 00 30 71 d2 ee cd f8  |..........0q....|
+00000010  c5 fe b4 96 d5 02 ee cb  f7 f8 93 34 f2 8a ed 71  |...........4...q|
+00000020  9a b7 1f 01 9d fb 6c 3f  ee 22 bb 5c b0 8c 08 f5  |......l?.".\....|
+00000030  bf 1e d3 1c 12 ec 7b 86  05 bd e5                 |......{....|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 86 3b 02  a4 5c 33 eb 57 cc 42 71  |.... .;..\3.W.Bq|
-00000010  32 81 56 00 4a b0 3b 7e  ed cd ab d9 76 2b 12 97  |2.V.J.;~....v+..|
-00000020  d6 be 22 cc 02 17 03 01  00 20 e7 53 2a b7 18 a7  |.."...... .S*...|
-00000030  6f 65 ef 20 9d 38 be 3c  f0 6c 4e 5d e9 cc ac 8c  |oe. .8.<.lN]....|
-00000040  57 7d 61 c6 23 d8 bb d4  97 15 15 03 01 00 20 c9  |W}a.#......... .|
-00000050  c1 b2 03 2b b0 a4 cb 4b  65 31 46 c4 6c e4 12 70  |...+...Ke1F.l..p|
-00000060  0e eb e8 a0 d2 1c ca 2d  4f 87 f0 16 e9 23 b0     |.......-O....#.|
+00000000  17 03 01 00 20 8a 57 b3  89 76 41 f0 b3 51 da f4  |.... .W..vA..Q..|
+00000010  e7 6a f8 46 75 77 4d 8b  67 41 f9 f9 eb a0 cd 12  |.j.FuwM.gA......|
+00000020  78 08 12 d1 7b 17 03 01  00 20 9d 44 6a dd 48 ad  |x...{.... .Dj.H.|
+00000030  0a d9 3f 80 da b1 3d b3  50 be 40 c1 85 b5 bb 59  |..?...=.P.@....Y|
+00000040  e8 b9 2a 9f f5 2e 98 d3  2b c1 15 03 01 00 20 bd  |..*.....+..... .|
+00000050  69 41 45 bb 53 de f8 b7  bf a5 87 12 02 32 1a 05  |iAE.S........2..|
+00000060  09 94 40 a5 64 b3 31 7d  0d dc 01 ff 25 ca 31     |..@.d.1}....%.1|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA
index 2ad78c7043..37d05fc481 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 5d 02 00 00  59 03 01 26 fc 57 68 fc  |....]...Y..&.Wh.|
-00000010  0d a6 0d 31 5f 98 77 d2  5d 19 e1 35 55 0e 2b d1  |...1_.w.]..5U.+.|
-00000020  08 a0 f2 23 b8 8a 4a 71  58 f5 26 20 23 a6 28 5f  |...#..JqX.& #.(_|
-00000030  5b 57 e9 7d c9 14 a1 ec  75 33 8d 42 ce 0e 3e fc  |[W.}....u3.B..>.|
-00000040  0a d6 12 ef 3e f7 7b 15  8e aa 04 4a c0 13 00 00  |....>.{....J....|
+00000000  16 03 01 00 5d 02 00 00  59 03 01 71 32 68 84 f2  |....]...Y..q2h..|
+00000010  93 91 32 5b 71 e6 d1 fd  26 83 00 87 0f 56 f3 8a  |..2[q...&....V..|
+00000020  70 17 5e c9 c3 b3 ce 61  9a 1d 4d 20 85 cc 39 26  |p.^....a..M ..9&|
+00000030  32 1a 78 34 d5 d3 6c e2  df 89 f5 a0 51 2c f5 2d  |2.x4..l.....Q,.-|
+00000040  e0 17 51 e7 51 f4 61 8d  35 72 75 92 c0 13 00 00  |..Q.Q.a.5ru.....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 01 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -63,17 +62,17 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 01 00 aa 0c 00 00  a6 03 00 1d 20 eb d9 23  |............ ..#|
-000002d0  5f 21 7f ab f2 ae b4 9a  c8 06 2c 2a b4 01 50 5b  |_!........,*..P[|
-000002e0  7e 57 e6 7f 03 ac 36 9f  b7 f7 2f fa 5a 00 80 7e  |~W....6.../.Z..~|
-000002f0  74 f4 01 6e cd eb f6 d9  13 72 57 57 f5 2f 8d a7  |t..n.....rWW./..|
-00000300  5a 39 7b 93 ff b1 56 98  b9 72 02 44 e9 de 4f c1  |Z9{...V..r.D..O.|
-00000310  6a 7d 6f 43 73 a8 53 91  0a 82 de 66 21 22 65 f0  |j}oCs.S....f!"e.|
-00000320  31 ff e4 e8 bc 80 7a 79  23 d1 3d b8 a5 be ff 3b  |1.....zy#.=....;|
-00000330  fc 6c f1 45 4e 59 50 29  cd 35 d3 d4 93 eb 1f 65  |.l.ENYP).5.....e|
-00000340  56 b1 e8 5f 35 a8 a6 8a  2b 02 4a 84 33 5b ff 01  |V.._5...+.J.3[..|
-00000350  d0 d1 d5 17 6c 30 e9 ce  03 cc 7c 28 25 50 0c cd  |....l0....|(%P..|
-00000360  74 55 3e cf 3f dc 9c 80  19 35 f5 36 e5 ca 9a 16  |tU>.?....5.6....|
+000002c0  16 03 01 00 aa 0c 00 00  a6 03 00 1d 20 3a 64 e7  |............ :d.|
+000002d0  9a 59 c3 4e fc 40 5e 2f  5c 89 cd e1 94 85 4e 1f  |.Y.N.@^/\.....N.|
+000002e0  29 37 0b 53 fe 3a 13 76  56 25 2a 97 65 00 80 08  |)7.S.:.vV%*.e...|
+000002f0  1c de 63 0d 31 9b 72 7b  85 0c 03 b0 08 ea 80 a1  |..c.1.r{........|
+00000300  ee 00 03 f9 29 a3 ba 8e  c8 71 3e b4 4d b3 28 54  |....)....q>.M.(T|
+00000310  2c e7 11 3a 15 e0 43 06  f0 36 15 50 54 5e 88 48  |,..:..C..6.PT^.H|
+00000320  ac c4 68 db 83 dc 0c 22  e4 99 4a 08 2a 00 7d 19  |..h...."..J.*.}.|
+00000330  0d 74 ba 7a 27 9c 39 dc  29 41 52 cf a2 ac 29 94  |.t.z'.9.)AR...).|
+00000340  e6 b0 87 60 e5 d3 58 af  3e 8e 41 bd be 48 ba 90  |...`..X.>.A..H..|
+00000350  49 b2 b1 d3 8e b0 49 98  4a 12 70 60 c7 57 d9 a7  |I.....I.J.p`.W..|
+00000360  db dc 41 b0 dc 81 37 1b  6d ac 9c 69 12 f4 fa 16  |..A...7.m..i....|
 00000370  03 01 00 0a 0d 00 00 06  03 01 02 40 00 00 16 03  |...........@....|
 00000380  01 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
@@ -112,29 +111,29 @@
 00000200  e5 35 16 03 01 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
 00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 01 00  |......._X.;t....|
-00000230  86 0f 00 00 82 00 80 8b  21 19 8e 69 f9 f2 da 9b  |........!..i....|
-00000240  58 ce 21 ce 77 f1 c4 50  be 04 63 bc 30 ac 9e 32  |X.!.w..P..c.0..2|
-00000250  f0 43 31 36 8a 87 f9 8a  3a f8 00 48 04 07 ad e0  |.C16....:..H....|
-00000260  0d 57 d6 74 86 70 6e 30  74 97 a0 26 e1 6f dd c1  |.W.t.pn0t..&.o..|
-00000270  5b b6 c5 b0 05 35 43 aa  b3 14 fb ca 59 80 fa 4a  |[....5C.....Y..J|
-00000280  d4 be 61 b2 a7 5d f0 b4  dc 9b ee 83 b6 93 09 ca  |..a..]..........|
-00000290  82 76 a8 99 1d 85 b6 77  f4 eb 7d 4b bb 7c 5b d5  |.v.....w..}K.|[.|
-000002a0  7b 40 a9 b0 77 ad a0 8b  08 81 5c 8e 20 e2 2a 62  |{@..w.....\. .*b|
-000002b0  9f 53 28 e4 e1 a3 1d 14  03 01 00 01 01 16 03 01  |.S(.............|
-000002c0  00 30 84 88 01 5f 1e 79  9b f8 60 b3 7b 50 e0 97  |.0..._.y..`.{P..|
-000002d0  e7 94 1c 75 58 89 1e ab  20 c9 2a 35 43 af 5b e1  |...uX... .*5C.[.|
-000002e0  05 25 60 49 ec 7b fc 9f  d2 ea 77 9a fe a7 86 b8  |.%`I.{....w.....|
-000002f0  89 7d                                             |.}|
+00000230  86 0f 00 00 82 00 80 21  34 0c d8 10 ac 90 53 f9  |.......!4.....S.|
+00000240  18 52 42 05 ca e8 c7 4f  33 c4 43 4b 8e 7c e4 23  |.RB....O3.CK.|.#|
+00000250  21 6d e4 07 ef 3f 06 d1  ea 1c 9d 3b e0 d2 66 36  |!m...?.....;..f6|
+00000260  b5 c9 a1 da fe 54 fd e0  fe 0c b6 12 90 93 41 1f  |.....T........A.|
+00000270  43 00 00 e4 a4 04 14 af  00 3e 1b db 16 d6 07 4b  |C........>.....K|
+00000280  55 2f ed 55 e1 e1 a8 8b  d8 e1 fe cb 41 1d fe bc  |U/.U........A...|
+00000290  6d d9 ba 8f 2b 1c 26 19  9d 93 a9 78 fb 8a 54 59  |m...+.&....x..TY|
+000002a0  76 3b 0a df e6 71 2c c0  63 dd 22 8d c6 70 ef 0e  |v;...q,.c."..p..|
+000002b0  4f 1b 4c da 65 11 f6 14  03 01 00 01 01 16 03 01  |O.L.e...........|
+000002c0  00 30 b5 c2 b0 f3 b6 6c  4a 99 de f2 98 2f 37 2b  |.0.....lJ..../7+|
+000002d0  8a d8 ab 96 91 c2 9b cc  56 5c fb e1 4f 5b 89 09  |........V\..O[..|
+000002e0  5f 94 05 60 0e 83 b5 49  9a 15 9b 0f 5d 1a 2b a2  |_..`...I....].+.|
+000002f0  11 23                                             |.#|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 ae 8c 9b 1b 85  |..........0.....|
-00000010  41 7b 53 64 51 07 12 6b  37 c0 75 81 b0 6d 4b bd  |A{SdQ..k7.u..mK.|
-00000020  30 a3 a1 5b a3 9e 3d c3  ed 4f ac e3 67 88 ec a8  |0..[..=..O..g...|
-00000030  fb 6f 09 d5 11 8c 7b ae  39 60 0c                 |.o....{.9`.|
+00000000  14 03 01 00 01 01 16 03  01 00 30 63 a2 f0 9b 1c  |..........0c....|
+00000010  48 6d 23 54 62 b1 2a 19  e7 89 51 fd 0d 83 97 87  |Hm#Tb.*...Q.....|
+00000020  9b 73 31 11 5e 42 56 62  62 37 4d e5 e6 72 8a 6d  |.s1.^BVbb7M..r.m|
+00000030  a3 02 2b 2c 9e a5 1a 5c  34 f2 0d                 |..+,...\4..|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 ca 25 b7  cb b1 74 e5 00 c2 65 b4  |.... .%...t...e.|
-00000010  49 9d 2c c5 a4 0b be 1d  2b 49 30 96 19 f2 10 0c  |I.,.....+I0.....|
-00000020  7a c2 23 57 5b 17 03 01  00 20 39 20 09 37 f3 b0  |z.#W[.... 9 .7..|
-00000030  8f 3a 93 2f 14 6d cd d6  ec 2c 1f 2b 3f ee 13 d3  |.:./.m...,.+?...|
-00000040  72 f4 c4 36 49 a9 80 28  f1 08 15 03 01 00 20 82  |r..6I..(...... .|
-00000050  c8 e7 e5 a1 c0 78 da 98  8a ad 93 da cb cc 9e a8  |.....x..........|
-00000060  c6 60 ec 50 fa d2 25 38  6b e3 5d 0d 1c c7 15     |.`.P..%8k.]....|
+00000000  17 03 01 00 20 63 1a 2c  25 27 68 ed de ba 94 52  |.... c.,%'h....R|
+00000010  73 f2 7a 28 ed 8c e9 3f  a2 48 9a 07 62 22 27 6d  |s.z(...?.H..b"'m|
+00000020  4e be ba e4 67 17 03 01  00 20 1d ee ac 7c fc a7  |N...g.... ...|..|
+00000030  df 74 93 16 c6 ec 58 5e  04 5d 2e 98 0a ba 52 4f  |.t....X^.]....RO|
+00000040  a0 02 c5 79 c3 d6 f0 ab  8d 33 15 03 01 00 20 bb  |...y.....3.... .|
+00000050  54 a6 65 a7 c9 03 e7 83  ae a1 f3 26 9f 73 76 6b  |T.e........&.svk|
+00000060  e6 1e f7 e0 76 e5 ca 9f  c8 87 14 ac 27 f1 e3     |....v.......'..|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES
index b8f32392b5..a8593e249b 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 5d 02 00 00  59 03 01 65 75 f4 83 d3  |....]...Y..eu...|
-00000010  95 a2 e3 96 5d 70 09 f1  ab 22 18 3d f6 9c 27 b2  |....]p...".=..'.|
-00000020  f0 4f 17 eb f4 6a 32 4d  1f 02 59 20 75 b7 a4 c8  |.O...j2M..Y u...|
-00000030  66 a9 4b 54 d3 0b 8b 82  38 24 31 8a 01 71 95 06  |f.KT....8$1..q..|
-00000040  a9 4f dd b2 d4 42 25 77  8c 91 87 48 c0 09 00 00  |.O...B%w...H....|
+00000000  16 03 01 00 5d 02 00 00  59 03 01 3e 61 ab b7 94  |....]...Y..>a...|
+00000010  d9 7c 76 db 26 b6 fc 86  00 8f c4 af bd c6 1a 22  |.|v.&.........."|
+00000020  dd 72 ce 5d 2a 4c d8 61  a1 20 6b 20 c9 82 ca c9  |.r.]*L.a. k ....|
+00000030  99 59 80 37 6c 01 d2 b3  b5 0d 68 9f 65 b0 15 7d  |.Y.7l.....h.e..}|
+00000040  a6 b0 15 b0 49 5a ae 38  d2 77 5e 06 c0 09 00 00  |....IZ.8.w^.....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 01 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
 00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
@@ -58,37 +57,37 @@
 00000240  8c 25 c1 33 13 83 0d 94  06 bb d4 37 7a f6 ec 7a  |.%.3.......7z..z|
 00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
 00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
-00000270  95 12 07 8f 2a 16 03 01  00 b3 0c 00 00 af 03 00  |....*...........|
-00000280  1d 20 37 88 b4 b9 cb 5f  71 5e 4c 36 59 f1 37 97  |. 7...._q^L6Y.7.|
-00000290  ec 3e 16 c8 ac 23 61 8d  fe 75 14 ff 33 eb db 04  |.>...#a..u..3...|
-000002a0  7a 17 00 89 30 81 86 02  41 50 a1 8b 98 a0 b9 21  |z...0...AP.....!|
-000002b0  22 23 a1 ce 76 85 6e 7a  40 ce 2c 65 bc 3c 89 e6  |"#..v.nz@.,e.<..|
-000002c0  1c 74 1e a9 1d 6c c7 60  99 b5 68 62 74 84 0d 7c  |.t...l.`..hbt..||
-000002d0  a3 06 61 b1 d2 9a 5c 3e  92 39 d7 ac be 1d ac ff  |..a...\>.9......|
-000002e0  18 e7 76 29 f1 d2 8f 97  6e 44 02 41 07 e1 ee a8  |..v)....nD.A....|
-000002f0  cc 89 7d a5 6e e5 32 52  51 72 ff dc 9e 77 e2 c8  |..}.n.2RQr...w..|
-00000300  18 07 1e 6e fa 4a b2 05  f8 a5 e6 21 76 90 ba e4  |...n.J.....!v...|
-00000310  9f b4 2a 03 c5 86 07 58  aa 4a c2 d8 24 c9 a5 e0  |..*....X.J..$...|
-00000320  d7 04 0e 41 33 3c b7 e2  82 f1 05 0d 6a 16 03 01  |...A3<......j...|
-00000330  00 04 0e 00 00 00                                 |......|
+00000270  95 12 07 8f 2a 16 03 01  00 b5 0c 00 00 b1 03 00  |....*...........|
+00000280  1d 20 73 36 95 70 b0 c6  fd c6 cf 68 f3 77 1e 46  |. s6.p.....h.w.F|
+00000290  c2 22 3e f8 e6 f4 37 82  73 8e 8d ec 40 64 0d a9  |.">...7.s...@d..|
+000002a0  f7 6f 00 8b 30 81 88 02  42 01 2f 8b 24 b7 24 65  |.o..0...B./.$.$e|
+000002b0  6e f8 a3 55 53 3f da 67  a2 b6 35 b3 ef 8b 87 39  |n..US?.g..5....9|
+000002c0  2f 44 e8 a6 9d 2c 16 c1  82 a9 a9 f6 20 0f 1b 36  |/D...,...... ..6|
+000002d0  32 b8 7a 96 2d 5a b0 4d  43 53 ec c9 06 82 83 0e  |2.z.-Z.MCS......|
+000002e0  fb 0b 8c f8 0b 47 b6 dd  19 4c 96 02 42 01 c6 7e  |.....G...L..B..~|
+000002f0  20 9e d9 2f 33 1f 5f 25  bc 79 a3 df 96 9d e0 05  | ../3._%.y......|
+00000300  d7 72 75 29 7d b3 f2 0a  5e 81 39 71 b7 f9 68 e8  |.ru)}...^.9q..h.|
+00000310  82 07 93 80 88 31 77 2c  db 8b 58 49 28 c5 7b c1  |.....1w,..XI(.{.|
+00000320  e3 84 3c b9 08 2e a0 ab  66 12 b9 3c b9 a2 e8 16  |..<.....f..<....|
+00000330  03 01 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
 00000000  16 03 01 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 01 00 01 01  |....._X.;t......|
-00000030  16 03 01 00 30 8b de e9  e0 3d 21 29 46 07 eb da  |....0....=!)F...|
-00000040  60 6a 55 37 05 9c 94 e1  46 1f 12 a0 76 b6 0f 45  |`jU7....F...v..E|
-00000050  9d ad ee 69 ae 01 74 9f  de d4 d1 67 a5 0b 57 48  |...i..t....g..WH|
-00000060  69 c3 e6 2d ad                                    |i..-.|
+00000030  16 03 01 00 30 9a 24 ee  81 ee 6e b3 fe ab 63 04  |....0.$...n...c.|
+00000040  ae b1 1b 11 91 b0 cc 45  b8 67 74 9e 92 15 fd b1  |.......E.gt.....|
+00000050  b4 49 49 b4 f4 a5 61 01  1b ec 91 23 ec c0 98 8d  |.II...a....#....|
+00000060  ee 21 fd 29 95                                    |.!.).|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 f7 8f 4a 28 80  |..........0..J(.|
-00000010  4c 9b cb 02 39 81 a4 19  84 d9 b3 64 48 4d a6 2b  |L...9......dHM.+|
-00000020  20 6a 1e 9d 6f d2 39 53  1a f4 27 0e dc 92 ec 71  | j..o.9S..'....q|
-00000030  7d 48 66 67 6a 51 68 e4  7c 68 63                 |}HfgjQh.|hc|
+00000000  14 03 01 00 01 01 16 03  01 00 30 74 d2 f1 68 1e  |..........0t..h.|
+00000010  1e 11 8a eb 51 ae a6 19  af 60 09 c4 85 65 3e 71  |....Q....`...e>q|
+00000020  af d0 94 14 c3 80 18 91  72 23 97 26 f8 91 2f d6  |........r#.&../.|
+00000030  65 3c 02 06 10 d0 bb e7  92 57 b0                 |e<.......W.|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 ca ea fd  d5 01 d1 47 40 a5 57 4f  |.... ......G@.WO|
-00000010  b0 80 29 e5 a0 4a f2 09  34 02 46 10 45 3a 05 42  |..)..J..4.F.E:.B|
-00000020  0f 19 eb a2 33 17 03 01  00 20 34 92 d3 ed e4 50  |....3.... 4....P|
-00000030  13 e9 5c 65 01 fc c1 a3  28 77 c8 d6 2c 11 7f 68  |..\e....(w..,..h|
-00000040  b9 08 51 53 c9 f3 d3 4e  9a 24 15 03 01 00 20 07  |..QS...N.$.... .|
-00000050  4d 53 0a 85 d4 49 c4 7b  a2 4c 38 8d cc 8e 2a dd  |MS...I.{.L8...*.|
-00000060  24 da 28 07 f8 4b c5 2c  d2 15 e2 b5 b9 56 b1     |$.(..K.,.....V.|
+00000000  17 03 01 00 20 bf f3 92  9c 91 50 02 1e d2 29 17  |.... .....P...).|
+00000010  2c 5d 5f 43 c9 de 49 db  7b 0b bf eb 77 c5 9a 37  |,]_C..I.{...w..7|
+00000020  c7 e1 c3 83 a3 17 03 01  00 20 df 80 0b 7e 80 39  |......... ...~.9|
+00000030  b3 46 d8 7c 09 7a a8 c1  3a 04 77 2f 94 30 eb 8e  |.F.|.z..:.w/.0..|
+00000040  5d 56 08 95 bb 50 80 76  4b e7 15 03 01 00 20 0e  |]V...P.vK..... .|
+00000050  91 ba 25 bb d6 f6 ee 42  e0 8e 08 a1 7f d5 8f e3  |..%....B........|
+00000060  18 05 85 24 b6 0c 81 80  98 89 ae 2c 04 0e 8a     |...$.......,...|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES
index 9790da472e..b73fd761c4 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 5d 02 00 00  59 03 01 2d 3f 4f 1e 90  |....]...Y..-?O..|
-00000010  6e 65 37 1c 8e a3 17 98  72 de 49 69 4d b9 61 c9  |ne7.....r.IiM.a.|
-00000020  20 c2 92 6f 4f d1 a8 dc  61 71 4d 20 67 dc 24 8f  | ..oO...aqM g.$.|
-00000030  59 12 a0 19 ab ca e1 3a  44 e7 b3 32 bd 7d 04 96  |Y......:D..2.}..|
-00000040  41 1a 44 f6 fb 60 14 8f  6f f8 0e 69 c0 13 00 00  |A.D..`..o..i....|
+00000000  16 03 01 00 5d 02 00 00  59 03 01 79 f2 d6 96 d6  |....]...Y..y....|
+00000010  6d c9 a1 7a 04 ba 6d 7d  29 8d 91 3f 8e 2e 17 0f  |m..z..m})..?....|
+00000020  c8 c4 3a e1 3c 64 00 28  f8 21 9d 20 16 7b 80 30  |..:.<d.(.!. .{.0|
+00000030  33 a7 f9 1e 06 c5 10 54  85 a0 54 dc 2d 77 09 49  |3......T..T.-w.I|
+00000040  ed d2 1c 0e 52 1f ff 7a  23 19 aa 1c c0 13 00 00  |....R..z#.......|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 01 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -63,36 +62,36 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 01 00 aa 0c 00 00  a6 03 00 1d 20 91 5b 49  |............ .[I|
-000002d0  6b 53 81 6a 82 c4 1b db  31 cd d9 3a aa e4 a3 a8  |kS.j....1..:....|
-000002e0  76 8d 29 ba a4 27 eb fe  19 98 de 4c 20 00 80 71  |v.)..'.....L ..q|
-000002f0  a2 66 8e 70 55 ec 04 3c  dd 5a 5e 79 fb 25 2b af  |.f.pU..<.Z^y.%+.|
-00000300  dc aa 47 03 9b c3 99 d2  20 83 81 cb 82 68 8e 62  |..G..... ....h.b|
-00000310  26 90 78 d0 8c 9c 49 87  34 22 c1 0c 73 a8 de 79  |&.x...I.4"..s..y|
-00000320  3c 73 e9 49 15 f0 63 17  19 bb cb 5f 97 c6 20 80  |<s.I..c...._.. .|
-00000330  22 82 1e d0 be 40 da 53  84 53 43 cb ff 24 56 28  |"....@.S.SC..$V(|
-00000340  58 ec 85 47 3e ce eb f3  cb d6 26 9a 83 3b 4b 88  |X..G>.....&..;K.|
-00000350  15 96 f8 84 30 6d b9 e3  44 c4 45 57 aa d1 53 9e  |....0m..D.EW..S.|
-00000360  cc c9 09 c2 1b 17 0d 8f  f7 d7 0e 9d 86 33 60 16  |.............3`.|
+000002c0  16 03 01 00 aa 0c 00 00  a6 03 00 1d 20 69 9e db  |............ i..|
+000002d0  5f 4b 5e 7d 1e 00 1e 91  a6 49 81 e3 d9 ee ea 5e  |_K^}.....I.....^|
+000002e0  5c 40 f0 68 fd dd eb 6e  e4 85 58 91 70 00 80 8e  |\@.h...n..X.p...|
+000002f0  d6 64 01 3a 56 c2 58 5c  60 28 bc f6 bd 1e bf 73  |.d.:V.X\`(.....s|
+00000300  21 b8 1a ea fb c2 df d5  f1 b9 4d d7 6f 1c 8b 24  |!.........M.o..$|
+00000310  99 35 a5 ef 20 75 00 3e  83 34 da 40 4e ec e3 43  |.5.. u.>.4.@N..C|
+00000320  04 a4 f2 1e bb 97 23 3e  21 32 88 43 80 99 ec 43  |......#>!2.C...C|
+00000330  66 c3 09 87 1e e2 ad bb  c3 1c db f7 9a 59 3a a8  |f............Y:.|
+00000340  46 43 b6 3d 9a 6e c3 42  5b 1a 7d 85 dc db 96 cc  |FC.=.n.B[.}.....|
+00000350  8d 06 cc 08 d2 f0 09 c3  c6 ed 5f 3b f6 b0 a3 69  |.........._;...i|
+00000360  6c a8 9a a5 ef ad 59 c1  07 96 e8 34 1d f0 d9 16  |l.....Y....4....|
 00000370  03 01 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
 00000000  16 03 01 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 01 00 01 01  |....._X.;t......|
-00000030  16 03 01 00 30 16 75 14  eb 02 a0 e1 02 79 5f fe  |....0.u......y_.|
-00000040  fe e6 89 69 f1 5b 57 01  58 0f 4c 7d 4e 27 ed ae  |...i.[W.X.L}N'..|
-00000050  b8 b2 b9 53 24 f1 f1 d0  0b f2 d2 a0 21 ca 68 37  |...S$.......!.h7|
-00000060  26 56 78 68 5c                                    |&Vxh\|
+00000030  16 03 01 00 30 d1 17 2f  22 e5 fa 78 a0 b3 d3 22  |....0../"..x..."|
+00000040  ab cb d2 54 52 e6 b2 74  11 bd 3c 69 9a 71 e8 69  |...TR..t..<i.q.i|
+00000050  1a cd 13 09 72 53 7c 6c  49 24 69 71 73 38 6a b6  |....rS|lI$iqs8j.|
+00000060  a6 c5 e7 53 53                                    |...SS|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 0b c7 b6 d7 69  |..........0....i|
-00000010  7a f5 d7 06 f7 e3 78 7b  35 44 c0 88 4d c2 c7 6f  |z.....x{5D..M..o|
-00000020  93 0c 61 32 10 47 08 0d  e3 44 4f 1a 71 80 e3 96  |..a2.G...DO.q...|
-00000030  15 b4 f0 29 b5 d3 7a 78  94 9e a2                 |...)..zx...|
+00000000  14 03 01 00 01 01 16 03  01 00 30 d1 2e 43 5c f7  |..........0..C\.|
+00000010  fc 5f 96 b7 e6 84 60 08  aa b3 22 d1 d9 e2 f3 4d  |._....`..."....M|
+00000020  c8 44 62 9b fa 0e 18 7c  84 fe 1e 75 09 4a f4 94  |.Db....|...u.J..|
+00000030  67 03 91 79 90 26 70 2d  0e 97 6a                 |g..y.&p-..j|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 aa 76 ee  c2 22 9f 8a 31 45 7e 10  |.... .v.."..1E~.|
-00000010  97 00 68 2f 54 fa d9 a9  ad 6a 22 0b 85 c9 f7 f6  |..h/T....j".....|
-00000020  18 02 59 10 51 17 03 01  00 20 23 9e 9f 87 02 fd  |..Y.Q.... #.....|
-00000030  6f d9 22 8d d3 db 4a 42  ac 9b 9a 69 7e 54 20 ab  |o."...JB...i~T .|
-00000040  72 29 4f 06 c6 d2 54 a9  9f 46 15 03 01 00 20 06  |r)O...T..F.... .|
-00000050  51 cd cd 83 a9 ce c5 18  4f 5c 0f a6 68 5b c2 07  |Q.......O\..h[..|
-00000060  31 59 c1 2a bd 4e 21 be  63 5f 29 49 a7 30 4e     |1Y.*.N!.c_)I.0N|
+00000000  17 03 01 00 20 c9 ce 68  cc e9 a7 f7 1f 3c 19 76  |.... ..h.....<.v|
+00000010  4e a6 2d 64 86 4d 35 9b  5e 5b 8b c7 a1 15 d9 d4  |N.-d.M5.^[......|
+00000020  5e 59 67 df 4d 17 03 01  00 20 26 09 76 e2 16 41  |^Yg.M.... &.v..A|
+00000030  a3 7f 3e 8e cc 75 ab a0  cf e1 42 8d 3c 51 d4 bb  |..>..u....B.<Q..|
+00000040  58 c9 a3 06 9d c5 c2 0a  16 76 15 03 01 00 20 47  |X........v.... G|
+00000050  88 af fd bd f1 91 80 6b  38 41 9e 79 f0 ff d9 6e  |.......k8A.y...n|
+00000060  a1 76 93 a3 aa 9f a5 00  c3 01 1f 2b 34 21 b2     |.v.........+4!.|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ExportKeyingMaterial b/src/crypto/tls/testdata/Client-TLSv10-ExportKeyingMaterial
index 6c83cc335e..0a563ce1c1 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ExportKeyingMaterial
+++ b/src/crypto/tls/testdata/Client-TLSv10-ExportKeyingMaterial
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 5d 02 00 00  59 03 01 6f 7c ae 3c cc  |....]...Y..o|.<.|
-00000010  76 04 54 ef 3c b8 48 b2  c3 fb 68 9d a3 91 e1 43  |v.T.<.H...h....C|
-00000020  a1 d5 a0 fa 87 1c ed 6b  9c 14 da 20 c6 25 eb 72  |.......k... .%.r|
-00000030  1c 0f c4 96 6a 75 ed 73  f9 20 75 8a 58 ca 5d 72  |....ju.s. u.X.]r|
-00000040  3d 97 a2 3e e5 36 c5 04  f2 01 c7 1f c0 13 00 00  |=..>.6..........|
+00000000  16 03 01 00 5d 02 00 00  59 03 01 97 c9 b8 e6 c1  |....]...Y.......|
+00000010  0e b3 68 29 30 ed ff df  a6 f3 cd b7 e0 80 a9 76  |..h)0..........v|
+00000020  84 1b 45 bb 42 29 e0 c8  7f 52 4b 20 95 97 03 66  |..E.B)...RK ...f|
+00000030  6b 45 44 7c 5d 4b 9e 47  fc 72 53 5d 3c 8a 28 6e  |kED|]K.G.rS]<.(n|
+00000040  bc 40 6d c3 96 67 f9 f2  72 ec 6d 0d c0 13 00 00  |.@m..g..r.m.....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 01 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -63,36 +62,36 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 01 00 aa 0c 00 00  a6 03 00 1d 20 71 f2 c9  |............ q..|
-000002d0  aa 88 45 b7 8a 34 c8 0b  f4 09 5d fb c2 a2 27 ad  |..E..4....]...'.|
-000002e0  48 86 ba 5f c7 a6 55 10  a4 ef 9c 45 4e 00 80 b8  |H.._..U....EN...|
-000002f0  82 3a a3 50 23 f2 a5 b2  69 fd 5b 36 b0 7a 16 6d  |.:.P#...i.[6.z.m|
-00000300  b7 7a df 77 bd 11 48 27  6c f5 7c 41 9c 66 50 13  |.z.w..H'l.|A.fP.|
-00000310  1e 57 c5 28 79 2f 55 41  63 18 12 b6 d1 d9 6a 7b  |.W.(y/UAc.....j{|
-00000320  77 fe 95 44 16 f3 e5 6f  f3 6c 39 15 da f5 bd 13  |w..D...o.l9.....|
-00000330  35 fc dc ce 4e 7c 89 ae  46 d0 d5 5a b2 d2 d8 28  |5...N|..F..Z...(|
-00000340  b2 e0 d8 6b 09 ed 4a 17  78 27 8d c4 14 26 86 6d  |...k..J.x'...&.m|
-00000350  2d 15 9e ec a9 09 11 71  1f b8 5b a8 24 33 55 09  |-......q..[.$3U.|
-00000360  b1 b6 4d 55 b4 06 63 c5  89 a6 9d e1 19 41 b2 16  |..MU..c......A..|
+000002c0  16 03 01 00 aa 0c 00 00  a6 03 00 1d 20 15 0b 17  |............ ...|
+000002d0  fd fb 69 3e 44 71 3c 68  b2 6a 99 9e 8c 57 ba e8  |..i>Dq<h.j...W..|
+000002e0  6c 28 ea 32 77 7a de f0  f6 09 3b 96 49 00 80 03  |l(.2wz....;.I...|
+000002f0  f0 bb 3e e2 24 9b 60 ec  91 09 f9 39 de fc b6 5a  |..>.$.`....9...Z|
+00000300  12 2c c9 3e a7 db 25 ab  32 32 e4 79 9e 0a 9f 98  |.,.>..%.22.y....|
+00000310  99 cd be b3 28 34 40 e1  78 3e 3d 20 35 74 79 7f  |....(4@.x>= 5ty.|
+00000320  f6 c5 5d 4c 54 30 1d 64  31 49 78 bd a2 cb 62 5a  |..]LT0.d1Ix...bZ|
+00000330  89 1a bf 65 bf 7f 1c ff  7d 61 6c 7d d2 76 8c 9e  |...e....}al}.v..|
+00000340  e4 80 56 7d 96 79 48 36  ca c0 99 db 9b ea 3a e7  |..V}.yH6......:.|
+00000350  a7 fe cb ed d8 3b 34 8c  be d5 ee be 59 d5 e2 5f  |.....;4.....Y.._|
+00000360  59 17 f3 57 29 eb c8 0e  ed 1a 06 79 c0 3c 16 16  |Y..W)......y.<..|
 00000370  03 01 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
 00000000  16 03 01 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 01 00 01 01  |....._X.;t......|
-00000030  16 03 01 00 30 9e df 6e  5c c6 25 f6 20 e1 0d 34  |....0..n\.%. ..4|
-00000040  c8 a7 38 07 20 b7 fc e2  4d da 40 7f 29 38 7b 42  |..8. ...M.@.)8{B|
-00000050  af 9b 6f 14 a7 68 15 2e  a0 53 67 73 19 ef 08 c3  |..o..h...Sgs....|
-00000060  d0 c5 af cf b6                                    |.....|
+00000030  16 03 01 00 30 c6 d7 ad  2c 52 90 50 3c 50 ec 66  |....0...,R.P<P.f|
+00000040  0d 54 6a 04 3c 8c 13 07  0c cd fa be 16 01 21 13  |.Tj.<.........!.|
+00000050  45 82 ab 25 44 68 d4 b4  fc 7c 86 a9 5b 2d 2b ca  |E..%Dh...|..[-+.|
+00000060  66 c6 0d 6e 5d                                    |f..n]|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 5c e5 b5 c2 ef  |..........0\....|
-00000010  6e 64 45 f9 c8 0f 9f 6a  41 b8 47 ad f5 25 af e5  |ndE....jA.G..%..|
-00000020  4c 78 86 dc b9 25 c3 0c  69 f7 41 ec 94 a8 06 4c  |Lx...%..i.A....L|
-00000030  b5 37 f8 17 b8 34 37 c2  7c ff d3                 |.7...47.|..|
+00000000  14 03 01 00 01 01 16 03  01 00 30 8c a1 03 f1 fb  |..........0.....|
+00000010  fe f8 1b 43 7b fb 10 59  c3 ed b3 34 b9 74 e1 89  |...C{..Y...4.t..|
+00000020  7f 5c 9b 81 b1 4f 13 bf  67 c5 87 92 31 96 7f e7  |.\...O..g...1...|
+00000030  35 7b b0 da 2c 79 2e be  43 f4 cf                 |5{..,y..C..|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 98 c1 0e  51 02 22 68 39 62 1d 2f  |.... ...Q."h9b./|
-00000010  79 46 0d 97 2c c1 1f 9b  aa cd 21 d8 7f c9 d6 bf  |yF..,.....!.....|
-00000020  f3 ef 94 ad 18 17 03 01  00 20 59 0c 3e 4e c7 ac  |......... Y.>N..|
-00000030  d2 2e 01 b9 39 69 09 ac  76 ce d8 6e e9 ea 6f 09  |....9i..v..n..o.|
-00000040  23 f4 75 4f 20 c0 a9 a8  8f 21 15 03 01 00 20 e5  |#.uO ....!.... .|
-00000050  e1 6c 39 c4 51 0a 13 b1  ec ef 75 ce e0 b8 d5 08  |.l9.Q.....u.....|
-00000060  22 22 b1 d0 61 78 c8 7d  3c 9c f2 bf 08 12 89     |""..ax.}<......|
+00000000  17 03 01 00 20 61 e8 5a  b2 15 88 f2 f9 e2 09 61  |.... a.Z.......a|
+00000010  53 a5 7f 79 4b e8 c7 8d  a9 5d 29 bf b9 0a 1d f7  |S..yK....]).....|
+00000020  90 9f 3b 89 39 17 03 01  00 20 86 93 3b 08 7f 77  |..;.9.... ..;..w|
+00000030  55 e5 51 06 ca 0e 80 96  9d 40 73 55 45 18 28 c7  |U.Q......@sUE.(.|
+00000040  54 6a d8 15 d7 67 1e 4b  52 1e 15 03 01 00 20 56  |Tj...g.KR..... V|
+00000050  d8 23 be 5a 8a a8 a4 8f  13 2f f0 34 24 90 96 87  |.#.Z...../.4$...|
+00000060  59 48 3f 76 77 47 d5 eb  4d cb 80 00 bc 11 cf     |YH?vwG..M......|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4 b/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4
index cf9ec918eb..c217b1112a 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4
+++ b/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 55 02 00 00  51 03 01 2a bd da 4f 4d  |....U...Q..*..OM|
-00000010  29 da 36 8a ab 13 02 82  da 2e 53 56 77 18 69 8a  |).6.......SVw.i.|
-00000020  52 ab b2 36 83 38 80 ca  5b 10 38 20 66 2c a6 cf  |R..6.8..[.8 f,..|
-00000030  90 d0 b5 23 0a 4f ac d8  04 09 b3 3a 87 56 f5 8e  |...#.O.....:.V..|
-00000040  68 11 9c 41 2c 3e 14 ea  b8 ad e3 c4 00 05 00 00  |h..A,>..........|
+00000000  16 03 01 00 55 02 00 00  51 03 01 6a dd d7 0d bb  |....U...Q..j....|
+00000010  bd b4 9c de 87 94 32 27  fa 4b 66 e0 8b 95 f2 11  |......2'.Kf.....|
+00000020  a0 a5 30 15 34 6f 76 6b  f7 23 ec 20 ef 7d 52 7d  |..0.4ovk.#. .}R}|
+00000030  2c 3b 30 1b f2 16 e7 8f  b6 62 64 79 51 5b 31 36  |,;0......bdyQ[16|
+00000040  b7 59 b1 f9 d5 26 d6 21  94 ff 7f bd 00 05 00 00  |.Y...&.!........|
 00000050  09 ff 01 00 01 00 00 17  00 00 16 03 01 02 59 0b  |..............Y.|
 00000060  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
 00000070  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
@@ -74,15 +73,15 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 01 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 01 00 24 e7 0e  d1 a9 78 47 47 d3 9e c7  |.....$....xGG...|
-000000a0  76 6d f7 e7 5e b6 df ff  e0 e8 2f a6 9d b4 70 eb  |vm..^...../...p.|
-000000b0  06 00 c9 0e 42 f6 3f 2f  23 83                    |....B.?/#.|
+00000090  01 16 03 01 00 24 0e 49  42 d7 a8 ca 08 09 a6 63  |.....$.IB......c|
+000000a0  0f b1 4b 06 30 37 5e cb  3a c8 d6 ce f9 9c bf 2f  |..K.07^.:....../|
+000000b0  4a c1 c7 fb 2e 02 a6 b0  de ed                    |J.........|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 24 3f 6d ab 1f 62  |..........$?m..b|
-00000010  0c 70 c8 df ea 23 f2 36  cf a3 01 89 f2 c4 d6 56  |.p...#.6.......V|
-00000020  59 ac 59 13 24 40 31 19  2b 66 ad d3 5d b7 a4     |Y.Y.$@1.+f..]..|
+00000000  14 03 01 00 01 01 16 03  01 00 24 ea 96 7b ce ae  |..........$..{..|
+00000010  69 a8 0d 6d 0c af a7 4f  5f 27 8d 2a 99 38 18 5a  |i..m...O_'.*.8.Z|
+00000020  f4 4f 67 56 0a 6a f5 fc  f5 ee a0 44 01 b0 d0     |.OgV.j.....D...|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 1a a0 8c 45  7f 0d 75 48 6f 15 7b af  |.......E..uHo.{.|
-00000010  6c e5 d2 10 c6 f2 ba 1e  09 50 83 40 f2 96 7c 15  |l........P.@..|.|
-00000020  03 01 00 16 53 b3 bd 98  38 ed 20 35 0a 5a 03 f3  |....S...8. 5.Z..|
-00000030  49 5c 69 85 4d ae 7e f9  fc 9d                    |I\i.M.~...|
+00000000  17 03 01 00 1a d3 71 0b  8e 0d d4 e0 06 04 e2 30  |......q........0|
+00000010  59 2c fe 84 81 45 1c e4  59 90 b1 b1 11 85 cb 15  |Y,...E..Y.......|
+00000020  03 01 00 16 ad 5d 98 96  4e 9d 83 af b0 50 64 77  |.....]..N....Pdw|
+00000030  62 a1 2b 1a 63 59 16 9e  60 da                    |b.+.cY..`.|
diff --git a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES
index 3a5fa10a13..dbaefe8eb3 100644
--- a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 02 00 5d 02 00 00  59 03 02 2b 28 48 86 02  |....]...Y..+(H..|
-00000010  ae 35 61 75 02 0b ea 8c  a1 3b ea c3 6c 26 e6 8d  |.5au.....;..l&..|
-00000020  a0 49 0c 96 f2 a4 75 b6  5d f5 29 20 ff 34 87 5d  |.I....u.].) .4.]|
-00000030  f9 ca 98 f2 49 10 3b 98  ff 30 5f a4 28 0d 9b d1  |....I.;..0_.(...|
-00000040  60 02 7b fe a0 b8 7e 40  4e fb 45 54 c0 09 00 00  |`.{...~@N.ET....|
+00000000  16 03 02 00 5d 02 00 00  59 03 02 14 c4 6e 18 e9  |....]...Y....n..|
+00000010  5b 74 0d 7f 05 01 75 e3  a3 af 90 f0 ea e3 a8 f0  |[t....u.........|
+00000020  6e b5 7d 29 97 4d f3 7e  e9 06 20 20 ba 37 13 9f  |n.}).M.~..  .7..|
+00000030  4e dd 10 6d 52 96 14 d0  93 3b 99 5b c2 cd f3 9c  |N..mR....;.[....|
+00000040  48 c1 12 78 c2 e5 e7 9d  a1 d6 b4 da c0 09 00 00  |H..x............|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 02 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
 00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
@@ -58,39 +57,39 @@
 00000240  8c 25 c1 33 13 83 0d 94  06 bb d4 37 7a f6 ec 7a  |.%.3.......7z..z|
 00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
 00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
-00000270  95 12 07 8f 2a 16 03 02  00 b4 0c 00 00 b0 03 00  |....*...........|
-00000280  1d 20 33 24 10 dd 39 bf  dd 42 80 f9 51 75 5d d5  |. 3$..9..B..Qu].|
-00000290  e3 97 b0 70 c8 9a e5 3c  90 5a f6 84 e7 17 2e d4  |...p...<.Z......|
-000002a0  71 6e 00 8a 30 81 87 02  42 01 f3 ed 17 7f 96 9d  |qn..0...B.......|
-000002b0  52 49 6b fd fb 94 28 67  8d 2f 75 7c 59 31 d1 b7  |RIk...(g./u|Y1..|
-000002c0  61 ed 94 c6 1a df 49 e6  9f 19 f1 54 0f 28 2f 3b  |a.....I....T.(/;|
-000002d0  18 fc 73 61 6d 7c 7e dd  61 80 d7 98 2e 20 6a 54  |..sam|~.a.... jT|
-000002e0  37 23 2b d7 11 e0 fa a4  98 49 78 02 41 39 49 af  |7#+......Ix.A9I.|
-000002f0  f9 28 5c 2b 50 0d 6e be  13 17 df 9a fb d0 71 9c  |.(\+P.n.......q.|
-00000300  6c 43 eb 09 90 ce 09 bd  f3 54 9f 73 da c7 ef f3  |lC.......T.s....|
-00000310  df 36 0e 75 d5 cc 4d 42  a5 d8 4c f9 e9 32 b9 90  |.6.u..MB..L..2..|
-00000320  9f fd 6c 70 bc d6 cf 73  b6 0b f0 db 55 d6 16 03  |..lp...s....U...|
-00000330  02 00 04 0e 00 00 00                              |.......|
+00000270  95 12 07 8f 2a 16 03 02  00 b5 0c 00 00 b1 03 00  |....*...........|
+00000280  1d 20 d1 90 13 d3 6d b1  e1 ec a3 e1 8b a1 d6 a6  |. ....m.........|
+00000290  40 ac 8e cf 6e 42 06 7d  a8 80 9a 9e a8 06 00 84  |@...nB.}........|
+000002a0  69 1f 00 8b 30 81 88 02  42 01 b6 ba 66 1c de c4  |i...0...B...f...|
+000002b0  8b a1 4a a7 0e f5 cb aa  5c 76 65 59 ba bb e2 7f  |..J.....\veY....|
+000002c0  a5 ee 91 26 77 40 e9 5d  25 73 5a d6 f9 b4 aa ac  |...&w@.]%sZ.....|
+000002d0  c8 bd 2b a4 95 b3 ef e0  c7 bb f1 d0 5e da 76 34  |..+.........^.v4|
+000002e0  a4 34 5b 6c d6 c8 3b 13  b1 d0 12 02 42 01 e1 18  |.4[l..;.....B...|
+000002f0  d5 90 79 c5 06 00 6b 7a  86 19 e0 2f 67 49 db 9e  |..y...kz.../gI..|
+00000300  4a 74 07 30 51 15 7b a1  01 89 9c 94 d8 17 18 a6  |Jt.0Q.{.........|
+00000310  31 aa fb 4b 57 24 52 00  41 1d cc 36 89 6e b4 ed  |1..KW$R.A..6.n..|
+00000320  fc 23 33 63 dd 94 3b 40  6f f1 af d7 78 27 0c 16  |.#3c..;@o...x'..|
+00000330  03 02 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
 00000000  16 03 02 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 02 00 01 01  |....._X.;t......|
 00000030  16 03 02 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000040  00 00 00 00 00 2b 2a 78  3f 77 6c 2d e6 26 0f ac  |.....+*x?wl-.&..|
-00000050  c3 d8 c9 0f c0 3d c7 7c  e4 08 da 9c af 0f 88 4c  |.....=.|.......L|
-00000060  2f 8e c0 96 78 a4 1f 2c  73 8c 7d 93 28 d1 ce e2  |/...x..,s.}.(...|
-00000070  06 74 35 9d ba                                    |.t5..|
+00000040  00 00 00 00 00 bd f5 0b  25 31 b7 e6 3f 74 dc 39  |........%1..?t.9|
+00000050  c8 a4 f5 3f 78 f5 6f 66  1b 59 53 51 40 d2 e1 14  |...?x.of.YSQ@...|
+00000060  56 96 ea 1f 08 30 3f 66  ca e4 e4 a0 b5 9f 60 9b  |V....0?f......`.|
+00000070  f8 b0 c7 b8 79                                    |....y|
 >>> Flow 4 (server to client)
-00000000  14 03 02 00 01 01 16 03  02 00 40 a7 8b 1b c5 b8  |..........@.....|
-00000010  b6 44 7d 9b 34 e7 c7 f1  d2 c6 19 e8 13 d4 0a b1  |.D}.4...........|
-00000020  07 ae 88 d1 7b 34 ca 0e  84 ab b3 e5 d6 13 22 22  |....{4........""|
-00000030  2b 1c e6 c9 2e b6 15 46  55 7d 2c 34 69 2b 06 62  |+......FU},4i+.b|
-00000040  d9 ef ce da d7 c8 98 3a  e5 23 87                 |.......:.#.|
+00000000  14 03 02 00 01 01 16 03  02 00 40 68 2d 60 78 1b  |..........@h-`x.|
+00000010  a7 b8 28 3a 2b f5 cd b8  ef 4e 8e ab 3c d5 67 7b  |..(:+....N..<.g{|
+00000020  1f 29 9e 59 de ca 43 3a  4c 0c f5 70 43 cb 0b 40  |.).Y..C:L..pC..@|
+00000030  69 a3 7c f7 1a 3b 48 2f  b8 a2 7c b4 4a 03 36 2a  |i.|..;H/..|.J.6*|
+00000040  24 c9 78 9a 06 6e 18 2e  4a c0 54                 |$.x..n..J.T|
 >>> Flow 5 (client to server)
 00000000  17 03 02 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 8f de 5e  92 28 7d 7d 8a 7e 48 40  |.......^.(}}.~H@|
-00000020  9b a6 8c 13 d3 fe 71 c9  d7 f9 a8 3a 06 64 da f2  |......q....:.d..|
-00000030  dc cf 69 f2 4b 15 03 02  00 30 00 00 00 00 00 00  |..i.K....0......|
-00000040  00 00 00 00 00 00 00 00  00 00 78 0f 3e c5 3c e9  |..........x.>.<.|
-00000050  39 5d 5c 7a 2c 16 f0 7f  b7 ca 3b 85 f3 ab f4 3d  |9]\z,.....;....=|
-00000060  ce df fd 6d 4d ad f4 89  38 ba                    |...mM...8.|
+00000010  00 00 00 00 00 f6 ff 38  da 12 09 78 fe de fb 0f  |.......8...x....|
+00000020  ea d3 5a d8 57 65 73 78  41 2d 0b 1b a4 8d f6 e7  |..Z.WesxA-......|
+00000030  ed 58 97 c9 ea 15 03 02  00 30 00 00 00 00 00 00  |.X.......0......|
+00000040  00 00 00 00 00 00 00 00  00 00 7d 4a 10 43 93 8a  |..........}J.C..|
+00000050  6d d2 50 34 92 22 24 f6  7a 9a c4 1f 57 e8 6d f8  |m.P4."$.z...W.m.|
+00000060  74 c4 cb 8b e0 4d 99 dd  ce 0a                    |t....M....|
diff --git a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES
index f15445e584..d0093da76c 100644
--- a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 02 00 5d 02 00 00  59 03 02 87 2b b1 e5 7b  |....]...Y...+..{|
-00000010  0e 0d 78 af b9 41 3c 0b  5a 38 2f 40 6d 13 69 da  |..x..A<.Z8/@m.i.|
-00000020  3a d6 e5 62 ef 72 70 66  9d f0 f4 20 a4 e2 a1 a7  |:..b.rpf... ....|
-00000030  51 f7 7e 23 38 df 2e dd  0b 2f 87 a5 86 93 aa 9d  |Q.~#8..../......|
-00000040  0e aa 02 2b 42 31 cb 36  f3 6b 8e db c0 13 00 00  |...+B1.6.k......|
+00000000  16 03 02 00 5d 02 00 00  59 03 02 3d 12 00 a1 c0  |....]...Y..=....|
+00000010  6f b2 13 96 d8 c3 b6 4e  81 60 03 60 fa 9a 4b 54  |o......N.`.`..KT|
+00000020  a9 1d e3 e9 10 e6 8d 84  e3 af 76 20 7c 6d 5c 41  |..........v |m\A|
+00000030  f6 19 49 92 b0 d2 1d 74  22 5d 6a 3f c6 5e 77 c0  |..I....t"]j?.^w.|
+00000040  c4 bb 31 2d 62 8d 7b 5c  66 6d c4 94 c0 13 00 00  |..1-b.{\fm......|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 02 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -63,38 +62,38 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 02 00 aa 0c 00 00  a6 03 00 1d 20 94 fa 9b  |............ ...|
-000002d0  b7 34 fd 4c f3 a7 12 a3  0f 6a a2 d2 c3 35 71 3a  |.4.L.....j...5q:|
-000002e0  fa 5c 7e aa ab 17 c9 bf  ae 29 a0 89 4e 00 80 26  |.\~......)..N..&|
-000002f0  6a cd b9 50 a0 61 19 60  c6 fd 58 69 11 7a 11 ac  |j..P.a.`..Xi.z..|
-00000300  16 1d 20 4a 28 4d 7a 9c  7a cb b7 a0 ac 90 3d 25  |.. J(Mz.z.....=%|
-00000310  dc a7 3d d0 5c d7 34 c4  a6 4c 47 73 8e 5a 1b 06  |..=.\.4..LGs.Z..|
-00000320  a5 2d e1 5e 04 d4 c6 31  2e 24 79 6c 0b df 67 3a  |.-.^...1.$yl..g:|
-00000330  f1 7c 5f c0 37 4a ec 1e  d2 32 7c 4f fa 9a d4 51  |.|_.7J...2|O...Q|
-00000340  be 2a 76 f2 74 78 b6 cf  22 d6 3d 16 1b ca 6b 9b  |.*v.tx..".=...k.|
-00000350  d9 9a 3f 65 e4 83 63 91  15 f1 c4 69 45 a3 d9 ab  |..?e..c....iE...|
-00000360  f5 d3 a9 0e 15 00 20 bb  43 20 a7 90 db c6 1d 16  |...... .C ......|
+000002c0  16 03 02 00 aa 0c 00 00  a6 03 00 1d 20 73 f2 57  |............ s.W|
+000002d0  12 5a 50 bb 9d 2d 14 f0  ca ee c1 41 bf da 9e 8e  |.ZP..-.....A....|
+000002e0  d5 a9 25 c3 84 07 e7 5c  35 87 8b 70 3d 00 80 d3  |..%....\5..p=...|
+000002f0  86 1b 82 48 5c 14 9b cf  e4 a0 2b 24 bc 8c ad e9  |...H\.....+$....|
+00000300  7c 1e 4f da c2 22 10 91  76 47 bc 9f 64 ca 1c 69  ||.O.."..vG..d..i|
+00000310  77 c0 c7 2c 50 ea 1a 07  d0 8c ec da aa ed 82 9d  |w..,P...........|
+00000320  a5 6c d6 27 05 f8 24 19  f9 d4 b1 c6 e3 0f 49 6f  |.l.'..$.......Io|
+00000330  e4 47 25 9a 36 f1 d3 ed  b1 b5 a0 cc 66 50 75 64  |.G%.6.......fPud|
+00000340  97 ee 3c 65 84 1b 62 f8  1a 8f 02 5a d4 2c 49 b3  |..<e..b....Z.,I.|
+00000350  3b c4 67 d4 20 58 f3 cc  1d f7 d1 f7 7b 2f bd 5f  |;.g. X......{/._|
+00000360  74 67 23 6c 37 9c 19 c5  a4 69 10 65 e4 4d 15 16  |tg#l7....i.e.M..|
 00000370  03 02 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
 00000000  16 03 02 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 02 00 01 01  |....._X.;t......|
 00000030  16 03 02 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000040  00 00 00 00 00 5e 93 f4  06 23 2b f4 7e d1 4f 6c  |.....^...#+.~.Ol|
-00000050  3e ad 67 fe 6c 33 42 e7  c0 ce 2b b9 38 0e ec 6e  |>.g.l3B...+.8..n|
-00000060  dc 78 d0 51 d9 57 ef 67  69 4e cd 51 52 9b 09 df  |.x.Q.W.giN.QR...|
-00000070  7e 8d ee cc f1                                    |~....|
+00000040  00 00 00 00 00 93 60 ad  fa 30 93 3e 31 6d 2c 0c  |......`..0.>1m,.|
+00000050  21 3d 6a 53 b1 51 f9 a9  1f 74 ee 42 7a 90 8a 08  |!=jS.Q...t.Bz...|
+00000060  9e a0 7f 42 19 c4 28 06  77 bb 32 c1 a0 0d ec 71  |...B..(.w.2....q|
+00000070  4f 20 89 c1 7d                                    |O ..}|
 >>> Flow 4 (server to client)
-00000000  14 03 02 00 01 01 16 03  02 00 40 22 ca 73 9e 54  |..........@".s.T|
-00000010  72 60 64 fd f2 29 fa a1  47 04 ca e7 27 db 82 a8  |r`d..)..G...'...|
-00000020  66 ed 3c 2b 8f 67 8e 09  1a 2d 24 3b 9e dc 8e 1e  |f.<+.g...-$;....|
-00000030  64 ba db a7 64 11 5a 6f  e6 29 cc ed 73 6c 13 b8  |d...d.Zo.)..sl..|
-00000040  40 44 5f d8 72 df 59 b8  a4 4f 7e                 |@D_.r.Y..O~|
+00000000  14 03 02 00 01 01 16 03  02 00 40 fb 97 d9 4a c6  |..........@...J.|
+00000010  10 21 6f 7b 77 ba e0 41  b2 50 d3 8c df 54 b1 9f  |.!o{w..A.P...T..|
+00000020  98 55 e7 0e fb bd 25 67  fb fb 5a 5c 86 b8 f0 17  |.U....%g..Z\....|
+00000030  2b 56 b3 81 21 45 58 98  38 63 24 0a ec aa 17 55  |+V..!EX.8c$....U|
+00000040  8c 46 67 a6 44 57 00 8d  49 83 28                 |.Fg.DW..I.(|
 >>> Flow 5 (client to server)
 00000000  17 03 02 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 51 2f d5  ee 59 bc cc c2 73 15 e1  |.....Q/..Y...s..|
-00000020  15 cb 89 24 d8 7a 2c 2e  d9 9c 9f fc 2b 90 f6 28  |...$.z,.....+..(|
-00000030  fd e5 db 9b 0f 15 03 02  00 30 00 00 00 00 00 00  |.........0......|
-00000040  00 00 00 00 00 00 00 00  00 00 a1 7a 29 17 c3 33  |...........z)..3|
-00000050  87 e8 3a 81 97 ae df 40  97 fc 0b f4 6a 00 84 37  |..:....@....j..7|
-00000060  8c 68 d1 8e db a8 d3 04  93 60                    |.h.......`|
+00000010  00 00 00 00 00 e7 87 56  3d 84 0b 17 94 41 94 67  |.......V=....A.g|
+00000020  48 ff 0f e4 2d a9 1c 7a  68 fc 42 36 17 27 b0 66  |H...-..zh.B6.'.f|
+00000030  af 97 25 90 a2 15 03 02  00 30 00 00 00 00 00 00  |..%......0......|
+00000040  00 00 00 00 00 00 00 00  00 00 55 a4 8a bc 52 98  |..........U...R.|
+00000050  07 3a dd 7a dc 4f 2c 8d  f2 1b f0 76 09 ca 88 36  |.:.z.O,....v...6|
+00000060  d4 fa f9 f4 b7 2e ce 6e  26 82                    |.......n&.|
diff --git a/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4 b/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4
index bb770e61b1..64b06a8f17 100644
--- a/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4
+++ b/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 02 00 55 02 00 00  51 03 02 fa ec 74 4b af  |....U...Q....tK.|
-00000010  f7 bb 7c 03 0a 35 f9 91  1e 62 c8 d7 9d b0 cc 29  |..|..5...b.....)|
-00000020  0c 67 f1 a9 c6 be ff aa  ee 45 2c 20 7e 02 45 29  |.g.......E, ~.E)|
-00000030  e8 01 2c 76 c9 49 9c bf  ca b7 0c b0 86 69 2a d0  |..,v.I.......i*.|
-00000040  34 59 2c 16 b1 bd 67 1a  e8 f9 97 3d 00 05 00 00  |4Y,...g....=....|
+00000000  16 03 02 00 55 02 00 00  51 03 02 3d a4 ea 71 81  |....U...Q..=..q.|
+00000010  c9 47 24 2b 53 22 83 07  df 5a 9e 76 ef ca d8 1b  |.G$+S"...Z.v....|
+00000020  1f 16 15 cd 7e e4 62 93  1e 5d a7 20 9d ac ea 5a  |....~.b..]. ...Z|
+00000030  9e e3 7c 14 94 9d 1b 9e  2a 7b 2d 80 55 85 2f 9e  |..|.....*{-.U./.|
+00000040  ed 17 20 79 66 a2 6c 88  81 cb b0 79 00 05 00 00  |.. yf.l....y....|
 00000050  09 ff 01 00 01 00 00 17  00 00 16 03 02 02 59 0b  |..............Y.|
 00000060  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
 00000070  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
@@ -74,15 +73,15 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 02 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 02 00 24 8b f8  3f ae 9d 41 27 8e 52 ca  |.....$..?..A'.R.|
-000000a0  75 8c 1b 76 fa 20 4f 7f  97 62 ac a6 85 33 71 32  |u..v. O..b...3q2|
-000000b0  34 8d 4b e3 d4 a1 a0 bc  9c 29                    |4.K......)|
+00000090  01 16 03 02 00 24 30 52  7f 8a 5c 3a 31 65 87 8c  |.....$0R..\:1e..|
+000000a0  9e 31 8f b1 22 15 ed af  99 6c 19 47 46 fd e1 3b  |.1.."....l.GF..;|
+000000b0  b3 f4 3a 5b d8 e5 a6 1a  7c 5e                    |..:[....|^|
 >>> Flow 4 (server to client)
-00000000  14 03 02 00 01 01 16 03  02 00 24 1d d6 e8 70 53  |..........$...pS|
-00000010  f2 9e 4f ce 5f 35 4e 8d  41 1f 78 9a 72 79 2b cc  |..O._5N.A.x.ry+.|
-00000020  17 cd 48 16 b0 69 8b 41  b7 5a c6 df ec f6 5d     |..H..i.A.Z....]|
+00000000  14 03 02 00 01 01 16 03  02 00 24 c1 5d da 6d 6e  |..........$.].mn|
+00000010  55 3e 70 a4 52 15 d9 ba  88 a1 b7 f0 40 71 09 fa  |U>p.R.......@q..|
+00000020  3f 00 6f 39 72 88 89 a1  3d cf 7a 7a 97 15 b7     |?.o9r...=.zz...|
 >>> Flow 5 (client to server)
-00000000  17 03 02 00 1a 69 a6 2b  fe 20 e2 2e e6 b2 ed 03  |.....i.+. ......|
-00000010  92 ae e0 ff 84 56 12 f3  60 01 92 c0 f3 0e 8f 15  |.....V..`.......|
-00000020  03 02 00 16 d1 05 c5 6f  f3 3c 18 63 2b 9c 68 39  |.......o.<.c+.h9|
-00000030  c4 45 90 f1 ef 3f e1 00  2f 78                    |.E...?../x|
+00000000  17 03 02 00 1a 56 ea a4  ed 0f 9d 98 3b 48 bc 76  |.....V......;H.v|
+00000010  35 3f fb 78 92 d9 ce ef  53 b2 ef a6 13 9a 4c 15  |5?.x....S.....L.|
+00000020  03 02 00 16 b5 41 d0 98  50 73 73 90 c0 fe ec 11  |.....A..Pss.....|
+00000030  ec 98 d5 fb 02 c0 11 11  29 1c                    |........).|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256
index 1db74434cc..33e01c140b 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 55 02 00 00  51 03 03 00 13 58 0b 7f  |....U...Q....X..|
-00000010  3c 39 9d df c9 4e 95 64  d5 9f 86 b0 8b 19 35 a2  |<9...N.d......5.|
-00000020  71 da 39 5b 14 a5 a4 fd  79 8b 02 20 bf a6 01 51  |q.9[....y.. ...Q|
-00000030  3e 8d 7a 68 ef 24 9a a1  92 d8 72 6a 71 0e c9 fa  |>.zh.$....rjq...|
-00000040  f9 03 36 ca 4b 8a fd 17  95 f5 53 e7 00 9c 00 00  |..6.K.....S.....|
+00000000  16 03 03 00 55 02 00 00  51 03 03 c5 da f3 88 41  |....U...Q......A|
+00000010  ed 43 a7 4e 49 ad db 74  04 c6 fb c2 13 49 86 14  |.C.NI..t.....I..|
+00000020  fd d0 e1 7a ab d3 df 65  62 c6 1f 20 29 1a 03 bf  |...z...eb.. )...|
+00000030  10 35 3c 58 36 fd 4d 7a  7d dc f1 fd be d0 c6 b5  |.5<X6.Mz}.......|
+00000040  e1 b8 bf a8 f3 b5 31 43  32 37 02 73 00 9c 00 00  |......1C27.s....|
 00000050  09 ff 01 00 01 00 00 17  00 00 16 03 03 02 59 0b  |..............Y.|
 00000060  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
 00000070  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
@@ -74,17 +73,17 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 07 7c  |.....(.........||
-000000a0  26 b4 f3 ba 9c 22 69 af  a3 77 5f a3 59 9c b7 58  |&...."i..w_.Y..X|
-000000b0  90 e2 de e3 4f ab b6 2a  08 f4 63 14 9e 5f        |....O..*..c.._|
+00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 2c 46  |.....(........,F|
+000000a0  31 d0 81 b9 6e 55 b0 5b  7b 15 a0 27 da e2 d7 71  |1...nU.[{..'...q|
+000000b0  f4 d0 83 6c 98 d9 75 e2  f4 4c 61 0b fe 3c        |...l..u..La..<|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 d1 2c 6c a6 ff  |..........(.,l..|
-00000010  35 08 ad e8 3d cd f4 71  1c f7 62 97 44 c5 41 26  |5...=..q..b.D.A&|
-00000020  a4 ff a6 eb 63 e7 45 b1  31 3e ea 0e 33 b4 1d 4a  |....c.E.1>..3..J|
-00000030  9b 1f 87                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 28 e5 b5 71 5d e0  |..........(..q].|
+00000010  c8 9a 75 4c 6e 72 4e a2  5f f9 b4 9f f4 40 a0 de  |..uLnrN._....@..|
+00000020  73 48 9c 01 f3 0b 78 91  5f 85 29 9c 51 dc 77 bc  |sH....x._.).Q.w.|
+00000030  c0 32 42                                          |.2B|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 6f ba 97  |.............o..|
-00000010  a1 bb 88 f8 58 ce b3 81  94 20 97 f0 cd 79 5f 9e  |....X.... ...y_.|
-00000020  3d 3f b5 15 03 03 00 1a  00 00 00 00 00 00 00 02  |=?..............|
-00000030  8e 92 d4 4f a2 0e e5 69  e5 9a 7f 7d da 93 54 5c  |...O...i...}..T\|
-00000040  6e 4d                                             |nM|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 9e 81 42  |...............B|
+00000010  90 9e ab a2 29 b3 f7 a6  31 45 5f a4 2e d5 52 f7  |....)...1E_...R.|
+00000020  72 8b 3b 15 03 03 00 1a  00 00 00 00 00 00 00 02  |r.;.............|
+00000030  96 5a f4 de 37 1b 2c f1  8d 90 91 17 6f 81 90 7f  |.Z..7.,.....o...|
+00000040  e7 9d                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-AES128-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-AES128-SHA256
index 57fbc75c80..b373f27aae 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-AES128-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv12-AES128-SHA256
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 55 02 00 00  51 03 03 84 b7 a9 d5 83  |....U...Q.......|
-00000010  f6 80 cf 15 58 39 5a 3b  4b f1 6d 2a 86 8b 92 ed  |....X9Z;K.m*....|
-00000020  f8 fb e0 16 c1 2c 94 3a  eb 69 c4 20 e1 b7 43 24  |.....,.:.i. ..C$|
-00000030  e7 9c 69 47 60 48 b0 8b  2b 0b 52 2a 8b 8b 5b 1f  |..iG`H..+.R*..[.|
-00000040  67 12 f6 94 46 c5 b1 53  73 29 f9 d6 00 3c 00 00  |g...F..Ss)...<..|
+00000000  16 03 03 00 55 02 00 00  51 03 03 eb c3 6e 78 2e  |....U...Q....nx.|
+00000010  9f 47 ec 9d 0e bc 8d 49  d2 46 11 75 5e 50 a5 07  |.G.....I.F.u^P..|
+00000020  0a 99 90 34 34 2d 81 75  1b f4 ca 20 fb 28 c1 8c  |...44-.u... .(..|
+00000030  55 27 36 be 4e d1 c7 ee  e8 b3 2a eb 7a be f1 2a  |U'6.N.....*.z..*|
+00000040  fc 81 df d8 5b c2 1f 1e  7b 47 0f 06 00 3c 00 00  |....[...{G...<..|
 00000050  09 ff 01 00 01 00 00 17  00 00 16 03 03 02 59 0b  |..............Y.|
 00000060  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
 00000070  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
@@ -75,25 +74,25 @@
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
 00000090  01 16 03 03 00 50 00 00  00 00 00 00 00 00 00 00  |.....P..........|
-000000a0  00 00 00 00 00 00 46 00  2f ca 25 2b 92 37 79 de  |......F./.%+.7y.|
-000000b0  88 56 36 da ea 43 78 d7  51 72 53 c1 8b ae 33 3a  |.V6..Cx.QrS...3:|
-000000c0  d2 93 57 08 a1 14 22 5b  5b 33 fe 7c 13 33 17 d6  |..W..."[[3.|.3..|
-000000d0  ef 3b be e6 1c ee 09 c0  5e 86 89 9d 50 e2 e9 b3  |.;......^...P...|
-000000e0  3b 09 4c 70 f8 eb                                 |;.Lp..|
+000000a0  00 00 00 00 00 00 ee 37  21 73 05 93 63 ca 4f 0e  |.......7!s..c.O.|
+000000b0  e2 29 7f 90 6f 3a aa 52  a0 e0 71 97 5f f9 66 cf  |.)..o:.R..q._.f.|
+000000c0  06 19 09 51 03 5f 2e 0c  57 26 42 15 ef 8f 4e a9  |...Q._..W&B...N.|
+000000d0  c4 97 95 0a d1 ce 30 2c  bf 7a 85 4b a9 d0 a9 e0  |......0,.z.K....|
+000000e0  64 11 1a dc 48 1d                                 |d...H.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 50 3a 02 c0 c9 cd  |..........P:....|
-00000010  98 d0 dc ec 0a 58 cf a2  c2 f2 0b b2 5a 2c 9b 6e  |.....X......Z,.n|
-00000020  30 d2 98 0e 8f 9b b5 9f  1e e2 5f 0c bd 2b ce f8  |0........._..+..|
-00000030  08 c9 c1 fe 98 a5 5b ca  be 07 81 85 56 bc f4 a3  |......[.....V...|
-00000040  05 40 48 5b 76 ac 75 14  46 1a 8a 7f e4 ff 4e 76  |.@H[v.u.F.....Nv|
-00000050  8f db 76 19 a5 e3 75 e6  ca 1c 14                 |..v...u....|
+00000000  14 03 03 00 01 01 16 03  03 00 50 58 d1 09 93 e9  |..........PX....|
+00000010  97 c1 cc c3 db 1d 65 d8  97 35 c1 b4 3f 9f a0 00  |......e..5..?...|
+00000020  9f 81 2a 81 61 b5 51 9f  ec 15 94 d0 86 0f a1 70  |..*.a.Q........p|
+00000030  e9 90 59 dd 16 d3 e7 33  21 b7 d8 6e 4b a8 fd fb  |..Y....3!..nK...|
+00000040  dd 98 78 95 16 44 f8 da  bd e3 e2 3f f0 e1 d9 39  |..x..D.....?...9|
+00000050  c0 2e 0d c4 fe a5 ac 41  66 2d f3                 |.......Af-.|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000010  00 00 00 00 00 02 7a 3c  00 71 20 c9 5a 3a 94 ff  |......z<.q .Z:..|
-00000020  ed a9 a1 c9 cd 7a ec 10  96 5d b9 78 2b ff 9a d4  |.....z...].x+...|
-00000030  2d 5c a2 b5 b1 4d f8 22  b8 70 2b 7e 8d 07 13 62  |-\...M.".p+~...b|
-00000040  b2 23 e8 ff a6 15 03 03  00 40 00 00 00 00 00 00  |.#.......@......|
-00000050  00 00 00 00 00 00 00 00  00 00 f6 61 2f e6 18 fb  |...........a/...|
-00000060  dc ed 53 14 e3 a1 6e 22  2d e4 22 c9 a5 d2 cb e8  |..S...n"-.".....|
-00000070  89 35 4b e5 89 b8 20 44  1b 79 cc 83 41 42 a5 4f  |.5K... D.y..AB.O|
-00000080  38 be f4 20 c5 e6 2b 11  ad 3a                    |8.. ..+..:|
+00000010  00 00 00 00 00 2f d9 4b  fc 22 0f 20 dd 2c 20 83  |...../.K.". ., .|
+00000020  bd f0 49 5b bc 57 55 bc  fb 41 13 79 a7 19 4d e3  |..I[.WU..A.y..M.|
+00000030  71 66 ce b5 77 35 9c 54  86 0e fc 21 d6 9e c4 66  |qf..w5.T...!...f|
+00000040  ee 95 3f 0a d5 15 03 03  00 40 00 00 00 00 00 00  |..?......@......|
+00000050  00 00 00 00 00 00 00 00  00 00 54 25 cd 1a 0a d4  |..........T%....|
+00000060  7b a4 ce f1 62 c8 8f 62  af 93 8e 0e e8 fd ef 55  |{...b..b.......U|
+00000070  1d 47 a4 ac 1c 80 25 6f  c4 a2 51 11 84 e9 63 cb  |.G....%o..Q...c.|
+00000080  db d8 e6 bf 2c 89 4e 1a  d4 11                    |....,.N...|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384 b/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384
index bedeedbb19..9920621be3 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384
+++ b/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 55 02 00 00  51 03 03 ac 7e 0f a7 bc  |....U...Q...~...|
-00000010  e5 97 51 ac d1 a3 f4 e1  a4 a9 b3 52 08 ab cf cd  |..Q........R....|
-00000020  0a 2a 22 89 6e 7d c4 d4  4f 44 99 20 0f 86 62 46  |.*".n}..OD. ..bF|
-00000030  47 98 ce fc 9f ba ba 92  bf 17 dc 94 6f b4 05 ac  |G...........o...|
-00000040  81 87 89 14 c5 e1 c5 30  49 45 cf 7b 00 9d 00 00  |.......0IE.{....|
+00000000  16 03 03 00 55 02 00 00  51 03 03 9f 42 e3 1b 5f  |....U...Q...B.._|
+00000010  00 d9 00 0a a5 fa 6d 63  95 11 d2 5a ff 51 b0 f8  |......mc...Z.Q..|
+00000020  bc a9 7f 18 3c 8d d7 38  d5 e8 2d 20 be 5b 08 a0  |....<..8..- .[..|
+00000030  2f 7b 50 d9 06 0c bf 7c  2d cc f0 39 3a 90 e4 e7  |/{P....|-..9:...|
+00000040  9c 27 9b 88 ea ff c0 51  f8 79 cd b9 00 9d 00 00  |.'.....Q.y......|
 00000050  09 ff 01 00 01 00 00 17  00 00 16 03 03 02 59 0b  |..............Y.|
 00000060  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
 00000070  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
@@ -74,17 +73,17 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 2a f2  |.....(........*.|
-000000a0  d8 f8 66 9b 53 99 66 59  83 4b 37 25 44 61 d8 c3  |..f.S.fY.K7%Da..|
-000000b0  ef 7f 3e be 62 9c a0 3a  61 43 0c 87 04 4c        |..>.b..:aC...L|
+00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 0e dd  |.....(..........|
+000000a0  10 e6 7a dd b2 02 5c 0d  0c 73 b4 f1 a1 89 85 95  |..z...\..s......|
+000000b0  91 a9 e4 7a 47 49 9a 52  96 77 93 0b cc 74        |...zGI.R.w...t|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 7a 45 6a 5b 2a  |..........(zEj[*|
-00000010  06 e8 c8 f5 57 07 ee 91  dd f7 33 60 be f1 65 fb  |....W.....3`..e.|
-00000020  8f 3d 48 3c b2 a0 7c 30  30 b1 98 01 de 35 d2 5f  |.=H<..|00....5._|
-00000030  cb 0c de                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 28 72 c3 d3 ad 10  |..........(r....|
+00000010  71 48 c4 32 9b 24 ac c0  a4 88 db 35 e9 be fe 34  |qH.2.$.....5...4|
+00000020  ee 9a bb 5a a5 90 b6 ec  31 9a bc 4c 56 e2 e6 d5  |...Z....1..LV...|
+00000030  f9 2b 93                                          |.+.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 13 f4 b8  |................|
-00000010  b3 95 de d6 9b b3 8e 27  6f 36 dc a4 0d ab 7d 63  |.......'o6....}c|
-00000020  35 73 a4 15 03 03 00 1a  00 00 00 00 00 00 00 02  |5s..............|
-00000030  9d 64 e3 e6 8f a7 22 ab  82 2f 60 0a 2a 5f fc 39  |.d...."../`.*_.9|
-00000040  90 93                                             |..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 ed af c7  |................|
+00000010  74 44 64 5d e3 1b 0c d4  bd a1 7e 7e 87 10 8d bc  |tDd]......~~....|
+00000020  26 db e8 15 03 03 00 1a  00 00 00 00 00 00 00 02  |&...............|
+00000030  42 6b 3e 59 c5 e4 e5 5b  53 0f fe d9 3f 0c 5c f0  |Bk>Y...[S...?.\.|
+00000040  67 d5                                             |g.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ALPN b/src/crypto/tls/testdata/Client-TLSv12-ALPN
index 0cba50bd7a..6686f6e9c0 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ALPN
+++ b/src/crypto/tls/testdata/Client-TLSv12-ALPN
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 30 01 00 01  2c 03 03 00 00 00 00 00  |....0...,.......|
+00000000  16 03 01 01 2c 01 00 01  28 03 03 00 00 00 00 00  |....,...(.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,24 +7,24 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 b1 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 ad 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 10 00 10 00 0e  |................|
-000000f0  06 70 72 6f 74 6f 32 06  70 72 6f 74 6f 31 00 2b  |.proto2.proto1.+|
-00000100  00 09 08 03 04 03 03 03  02 03 01 00 33 00 26 00  |............3.&.|
-00000110  24 00 1d 00 20 2f e5 7d  a3 47 cd 62 43 15 28 da  |$... /.}.G.bC.(.|
-00000120  ac 5f bb 29 07 30 ff f6  84 af c4 cf c2 ed 90 99  |._.).0..........|
-00000130  5f 58 cb 3b 74                                    |_X.;t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 10  00 10 00 0e 06 70 72 6f  |.............pro|
+000000f0  74 6f 32 06 70 72 6f 74  6f 31 00 2b 00 09 08 03  |to2.proto1.+....|
+00000100  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000110  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000120  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000130  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 6a 02 00 00  66 03 03 d7 20 92 e0 ec  |....j...f... ...|
-00000010  a0 c3 77 d9 a8 c8 fe 8f  df 7d ab 20 c4 e9 50 bd  |..w......}. ..P.|
-00000020  9c dc 33 4f ca 0b b1 b1  f4 93 cc 20 d7 5d 8b 7e  |..3O....... .].~|
-00000030  7e 45 21 86 05 21 77 d0  ed 6a 1c 5a f3 60 06 38  |~E!..!w..j.Z.`.8|
-00000040  43 de 49 df 9a 43 60 52  47 57 98 29 cc a8 00 00  |C.I..C`RGW.)....|
+00000000  16 03 03 00 6a 02 00 00  66 03 03 37 57 f9 cb 6a  |....j...f..7W..j|
+00000010  dc 6c e2 4b 1d 74 93 8e  e1 1a 05 e7 fd 8d 29 57  |.l.K.t........)W|
+00000020  5e b4 fc 9a ba 7d df de  56 cc e7 20 57 f3 1a b0  |^....}..V.. W...|
+00000030  20 cd ac a1 e3 93 b9 79  f5 1c ce d2 d1 24 da fc  | ......y.....$..|
+00000040  88 97 25 fb 36 72 75 bb  cc a3 2a 79 cc a8 00 00  |..%.6ru...*y....|
 00000050  1e ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 10  |................|
 00000060  00 09 00 07 06 70 72 6f  74 6f 31 00 17 00 00 16  |.....proto1.....|
 00000070  03 03 02 59 0b 00 02 55  00 02 52 00 02 4f 30 82  |...Y...U..R..O0.|
@@ -65,31 +65,31 @@
 000002a0  43 77 8d 0c 1c f1 0f a1  d8 40 83 61 c9 4c 72 2b  |Cw.......@.a.Lr+|
 000002b0  9d ae db 46 06 06 4d f4  c1 b3 3e c0 d1 bd 42 d4  |...F..M...>...B.|
 000002c0  db fe 3d 13 60 84 5c 21  d3 3b e9 fa e7 16 03 03  |..=.`.\!.;......|
-000002d0  00 ac 0c 00 00 a8 03 00  1d 20 6c a6 83 3b fe d9  |......... l..;..|
-000002e0  f9 da 88 13 dc 34 f4 01  d4 49 a7 43 80 d7 e2 cf  |.....4...I.C....|
-000002f0  1d c9 eb 94 5a 6d 85 b5  1d 7c 08 04 00 80 d2 21  |....Zm...|.....!|
-00000300  1b 9a f4 26 ac 76 28 68  63 68 fe b5 9b e2 16 bb  |...&.v(hch......|
-00000310  fd a5 b7 85 3c f8 f9 da  49 d7 4f 62 c0 af 75 08  |....<...I.Ob..u.|
-00000320  47 3b 3a 48 26 c3 8e 13  25 08 1d 77 ce eb 30 e9  |G;:H&...%..w..0.|
-00000330  b4 2e cc 94 ca 8d b4 60  c6 92 ce 57 ba 1e 46 59  |.......`...W..FY|
-00000340  f6 76 61 da f2 59 79 da  87 08 22 1d 5a e9 1a b8  |.va..Yy...".Z...|
-00000350  9d 31 0f d9 db ab 49 80  d9 5c 20 ab ef 9e e1 4d  |.1....I..\ ....M|
-00000360  0c 69 9b 41 f2 dd 4d e9  ee ff d3 40 47 88 64 76  |.i.A..M....@G.dv|
-00000370  69 8e 3a a1 e0 68 00 6d  2f 95 b6 f9 64 12 16 03  |i.:..h.m/...d...|
+000002d0  00 ac 0c 00 00 a8 03 00  1d 20 27 fd a6 7d 32 28  |......... '..}2(|
+000002e0  d2 44 43 d5 2a 95 3b e2  7e 77 5a d2 66 87 4a 92  |.DC.*.;.~wZ.f.J.|
+000002f0  12 56 ba 40 3e 09 43 b4  90 02 08 04 00 80 8b e9  |.V.@>.C.........|
+00000300  93 0c 5e 72 b8 a8 49 1c  c3 b7 fc 39 af 58 9c 3a  |..^r..I....9.X.:|
+00000310  27 b6 20 23 9a 5d 35 0e  dd 21 da 1b be 34 32 23  |'. #.]5..!...42#|
+00000320  76 2e c8 9e 3d c8 e5 9e  cd 04 11 a9 be 97 52 53  |v...=.........RS|
+00000330  81 b6 01 fc 60 5d 0d dd  0d ba 05 a6 15 3b 29 4e  |....`].......;)N|
+00000340  88 a0 69 b9 c2 46 d9 c2  6d 17 b2 d0 c0 ee de f9  |..i..F..m.......|
+00000350  94 fe 25 31 66 df 72 7d  02 77 a6 2c a6 ad da eb  |..%1f.r}.w.,....|
+00000360  dc 4b ea d4 5b 0a d4 e6  c8 89 15 cf 3f 81 58 20  |.K..[.......?.X |
+00000370  0f 83 2f e1 db a1 cc a7  e1 61 79 7d 14 4b 16 03  |../......ay}.K..|
 00000380  03 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 d5 b6 10  b8 32 7d da 84 25 2b 18  |.... ....2}..%+.|
-00000040  78 a4 e3 6b 34 de b2 83  b6 94 12 f9 d2 9a 27 e5  |x..k4.........'.|
-00000050  ff ef a2 00 50                                    |....P|
+00000030  16 03 03 00 20 50 e7 36  59 68 f6 0f cd b0 cc ae  |.... P.6Yh......|
+00000040  bc 18 23 d3 c0 fb c9 41  49 91 ec 8f cd f0 69 84  |..#....AI.....i.|
+00000050  49 3c 68 6e 05                                    |I<hn.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 91 63 26 79 f6  |.......... .c&y.|
-00000010  6f fc 51 93 c5 9b e9 10  2e 80 f0 5f 6f 49 b8 a5  |o.Q........_oI..|
-00000020  53 d9 a6 2a 4a ec 4c 50  9f 1b 98                 |S..*J.LP...|
+00000000  14 03 03 00 01 01 16 03  03 00 20 84 30 04 4f 3e  |.......... .0.O>|
+00000010  72 f6 d8 6a dc ae fb 55  82 69 8e a3 77 c2 1f 27  |r..j...U.i..w..'|
+00000020  88 14 5b 8d 10 79 4c 6a  41 3e e5                 |..[..yLjA>.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 96 3e 1b  61 d9 00 1a e4 dc 49 cc  |......>.a.....I.|
-00000010  09 f8 b3 3e 21 c6 df 74  e2 6b a0 15 03 03 00 12  |...>!..t.k......|
-00000020  35 41 fc 32 06 30 3b ad  17 a4 19 3c 06 f9 59 e0  |5A.2.0;....<..Y.|
-00000030  d2 02                                             |..|
+00000000  17 03 03 00 16 03 a8 d7  eb 5d 79 60 d4 65 1d c1  |.........]y`.e..|
+00000010  2b 32 b5 c3 fb b2 2f 10  83 4e 39 15 03 03 00 12  |+2..../..N9.....|
+00000020  90 eb 89 fc e7 4c a2 94  02 33 b3 0e 72 6e bc 4e  |.....L...3..rn.N|
+00000030  d4 e7                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA
index b3496cedd6..784e95f87e 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 c9 60 0f c9 c7  |....]...Y...`...|
-00000010  84 d4 8c 7b e8 33 a1 e2  cc 15 9b 13 21 e6 ff 3a  |...{.3......!..:|
-00000020  72 2a d2 6b 18 bd 7b aa  4c 95 7f 20 f2 dd 03 c8  |r*.k..{.L.. ....|
-00000030  a9 e6 f0 20 b4 72 81 71  ea 10 ca b1 9f 4b 86 96  |... .r.q.....K..|
-00000040  27 b5 d4 6a 6a 35 2f d5  5a f6 75 96 c0 09 00 00  |'..jj5/.Z.u.....|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 4a 0b 4d 4a 05  |....]...Y..J.MJ.|
+00000010  a0 5b ca 5d 65 4f f7 7e  82 3c 54 1d a3 42 64 7c  |.[.]eO.~.<T..Bd||
+00000020  60 9a 09 8d 73 5e 86 5d  69 c5 c2 20 f9 43 f4 ed  |`...s^.]i.. .C..|
+00000030  73 ef bf 23 10 c0 25 09  3d e2 d0 89 32 cd 2a 20  |s..#..%.=...2.* |
+00000040  46 56 31 31 59 56 53 81  61 70 a7 ae c0 09 00 00  |FV11YVS.ap......|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
 00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
@@ -58,23 +57,23 @@
 00000240  8c 25 c1 33 13 83 0d 94  06 bb d4 37 7a f6 ec 7a  |.%.3.......7z..z|
 00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
 00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
-00000270  95 12 07 8f 2a 16 03 03  00 b6 0c 00 00 b2 03 00  |....*...........|
-00000280  1d 20 fc dd 1d af 2f 7d  77 03 42 8b e4 01 fd 0c  |. ..../}w.B.....|
-00000290  82 3b f8 16 d7 15 cc ce  97 b4 6b ab 78 b6 c4 d5  |.;........k.x...|
-000002a0  78 0a 04 03 00 8a 30 81  87 02 42 01 b1 31 15 d3  |x.....0...B..1..|
-000002b0  f9 0d 44 57 cc d7 d3 a8  08 91 19 ac fd 6d cf f3  |..DW.........m..|
-000002c0  59 87 59 d5 a3 9b 9f 41  0c a6 9d 2f 30 df 97 2c  |Y.Y....A.../0..,|
-000002d0  e5 04 58 a4 06 b6 67 ba  19 84 5e c5 28 cd a6 29  |..X...g...^.(..)|
-000002e0  c7 56 78 ba b5 4f d6 95  34 4c 5f e9 b7 02 41 30  |.Vx..O..4L_...A0|
-000002f0  cb d1 6b 75 7a 78 62 06  13 76 49 a7 cb 05 d1 1d  |..kuzxb..vI.....|
-00000300  14 79 39 e8 80 57 0c ba  52 41 ba 4d c1 82 3b 94  |.y9..W..RA.M..;.|
-00000310  d2 0f 0c 90 9b fa 32 03  7a 53 b5 c9 6b bc 3d 0e  |......2.zS..k.=.|
-00000320  01 2d b2 ca d3 0e b4 45  1a b3 ec 07 b8 ad 28 03  |.-.....E......(.|
-00000330  16 03 03 00 3a 0d 00 00  36 03 01 02 40 00 2e 04  |....:...6...@...|
-00000340  03 05 03 06 03 08 07 08  08 08 09 08 0a 08 0b 08  |................|
-00000350  04 08 05 08 06 04 01 05  01 06 01 03 03 02 03 03  |................|
-00000360  01 02 01 03 02 02 02 04  02 05 02 06 02 00 00 16  |................|
-00000370  03 03 00 04 0e 00 00 00                           |........|
+00000270  95 12 07 8f 2a 16 03 03  00 b7 0c 00 00 b3 03 00  |....*...........|
+00000280  1d 20 b8 ef 9c cd 47 a4  e9 1e e6 02 d5 40 12 95  |. ....G......@..|
+00000290  0e da 1d 8f 2a 4f a6 9f  95 f9 1a 2a 1c ce 3c 32  |....*O.....*..<2|
+000002a0  2b 4e 04 03 00 8b 30 81  88 02 42 00 c2 7d 24 9c  |+N....0...B..}$.|
+000002b0  b8 9c b1 69 fc 53 e9 ae  2c 07 39 23 d3 56 c8 96  |...i.S..,.9#.V..|
+000002c0  e1 5e a9 a6 6b 18 33 f0  f9 50 29 65 2e dd 2b df  |.^..k.3..P)e..+.|
+000002d0  4e 58 67 ee 85 b3 da 8d  28 a1 7a 9f 59 df ae 10  |NXg.....(.z.Y...|
+000002e0  31 d2 1b 6b 59 6d b9 24  16 79 66 49 7c 02 42 00  |1..kYm.$.yfI|.B.|
+000002f0  bd a3 f5 56 db 00 b1 27  63 79 cb 1b 40 b2 e9 90  |...V...'cy..@...|
+00000300  26 9f 44 53 ff fb 68 59  10 42 56 f2 36 fc 96 6a  |&.DS..hY.BV.6..j|
+00000310  a0 37 0e a3 77 5e 4c 0d  7b b6 e3 b5 b5 5b 2e d8  |.7..w^L.{....[..|
+00000320  6f 99 6b af 84 57 9c 14  35 aa 09 23 11 08 83 3a  |o.k..W..5..#...:|
+00000330  63 16 03 03 00 3a 0d 00  00 36 03 01 02 40 00 2e  |c....:...6...@..|
+00000340  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
+00000350  08 04 08 05 08 06 04 01  05 01 06 01 03 03 02 03  |................|
+00000360  03 01 02 01 03 02 02 02  04 02 05 02 06 02 00 00  |................|
+00000370  16 03 03 00 04 0e 00 00  00                       |.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 02 0a 0b 00 02  06 00 02 03 00 02 00 30  |...............0|
 00000010  82 01 fc 30 82 01 5e 02  09 00 9a 30 84 6c 26 35  |...0..^....0.l&5|
@@ -111,32 +110,32 @@
 00000200  e4 fa cc b1 8a ce e2 23  a0 87 f0 e1 67 51 eb 16  |.......#....gQ..|
 00000210  03 03 00 25 10 00 00 21  20 2f e5 7d a3 47 cd 62  |...%...! /.}.G.b|
 00000220  43 15 28 da ac 5f bb 29  07 30 ff f6 84 af c4 cf  |C.(.._.).0......|
-00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 03 00 92 0f 00  |...._X.;t.......|
-00000240  00 8e 04 03 00 8a 30 81  87 02 41 5f 38 d1 e6 8e  |......0...A_8...|
-00000250  cd f7 6b 2e 50 d9 e5 40  3a ba e7 67 5d a9 5a 83  |..k.P..@:..g].Z.|
-00000260  c1 9e 45 e7 c2 bc f6 a2  c0 d8 3e ca f6 48 44 72  |..E.......>..HDr|
-00000270  8b c6 e6 24 e4 aa 90 ff  81 10 c5 86 08 64 d4 30  |...$.........d.0|
-00000280  e7 27 e2 9b 66 b9 c8 30  3b 3d 61 51 02 42 01 3b  |.'..f..0;=aQ.B.;|
-00000290  a1 0b 55 d0 2b 23 90 0c  5a 14 9b f4 2b 04 f4 b3  |..U.+#..Z...+...|
-000002a0  b1 9d 6f 86 17 67 3d c1  9d 64 e6 d7 c6 54 eb 99  |..o..g=..d...T..|
-000002b0  51 83 df c9 df 41 48 b8  bc 8f 6c c9 bc 0a 36 0f  |Q....AH...l...6.|
-000002c0  c9 34 70 3a d5 82 5e 42  4f 22 64 23 33 fc e2 d3  |.4p:..^BO"d#3...|
-000002d0  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-000002e0  00 00 00 00 00 00 00 00  00 00 00 13 d5 c1 91 72  |...............r|
-000002f0  5e 32 35 1d c1 a2 d2 62  80 16 71 ea f9 67 d5 8d  |^25....b..q..g..|
-00000300  1d 98 a5 87 15 1b 7e 2a  80 a7 08 a2 c1 82 79 d2  |......~*......y.|
-00000310  60 e3 d5 8f 0b 9b 43 4f  88 09 7d                 |`.....CO..}|
+00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 03 00 93 0f 00  |...._X.;t.......|
+00000240  00 8f 04 03 00 8b 30 81  88 02 42 01 dd bf fd e0  |......0...B.....|
+00000250  db 99 16 0b f0 bc a9 4b  93 10 d9 59 06 d2 eb 30  |.......K...Y...0|
+00000260  dc b1 44 69 1d 54 2d 9b  b4 a4 c9 3a f8 d8 9d 2e  |..Di.T-....:....|
+00000270  36 71 3e ff aa 05 98 8a  27 00 dd 65 6a 15 b7 c9  |6q>.....'..ej...|
+00000280  fe 1d 4d 45 02 58 09 4f  38 ea cd 88 3c 02 42 00  |..ME.X.O8...<.B.|
+00000290  a6 27 a5 d7 e7 9e 66 7e  f8 38 37 03 7b 6d df c4  |.'....f~.87.{m..|
+000002a0  81 6a 59 af 5b c7 06 2e  57 e9 8f 8d 1f 9c 9d 94  |.jY.[...W.......|
+000002b0  70 4c 74 ed 03 24 3d df  35 51 a1 76 a7 8f 9b 40  |pLt..$=.5Q.v...@|
+000002c0  16 c6 4f 0e 49 95 34 20  22 dc 5c ce 1d c0 ed bf  |..O.I.4 ".\.....|
+000002d0  f4 14 03 03 00 01 01 16  03 03 00 40 00 00 00 00  |...........@....|
+000002e0  00 00 00 00 00 00 00 00  00 00 00 00 b7 d5 df bf  |................|
+000002f0  2b 32 a9 9e e4 78 40 84  ca c9 7d 54 4e 38 89 3b  |+2...x@...}TN8.;|
+00000300  0f 83 23 42 75 95 6e 4d  70 d4 b6 5a 1a 26 dd bb  |..#Bu.nMp..Z.&..|
+00000310  37 4a 85 88 ab 60 ba 3c  19 bd 02 79              |7J...`.<...y|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 8a f4 68 76 16  |..........@..hv.|
-00000010  0d 13 09 2a e5 3f 25 87  0f ce 03 96 2a 86 58 41  |...*.?%.....*.XA|
-00000020  7a 40 ec 65 ff c5 64 c1  62 6e ae 1d bf b6 4e dd  |z@.e..d.bn....N.|
-00000030  f6 be 55 56 ba 43 b3 c5  3a 6f 35 e6 73 59 63 87  |..UV.C..:o5.sYc.|
-00000040  fd 10 64 b1 94 e3 a9 b7  2d e0 94                 |..d.....-..|
+00000000  14 03 03 00 01 01 16 03  03 00 40 07 8e 16 c5 c2  |..........@.....|
+00000010  e1 e5 32 41 2d 8b 3c fb  2e 3e b2 84 89 56 4d b5  |..2A-.<..>...VM.|
+00000020  1c bd 1e a5 11 a1 b0 18  29 ce eb 46 f8 11 ff dc  |........)..F....|
+00000030  c0 cc ed 5a 38 33 5a 8f  48 df bf e9 8e 09 be b0  |...Z83Z.H.......|
+00000040  9d 70 85 f7 71 f5 1e 5c  aa 6f 88                 |.p..q..\.o.|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 15 82 4f  fa 8d ce 67 fd 63 bb 74  |.......O...g.c.t|
-00000020  98 2f 77 fc 5b 43 70 4d  15 cf 5b 2b 45 ae e7 b3  |./w.[CpM..[+E...|
-00000030  d0 dd ae 4b 27 15 03 03  00 30 00 00 00 00 00 00  |...K'....0......|
-00000040  00 00 00 00 00 00 00 00  00 00 d2 ce b2 c5 1a 62  |...............b|
-00000050  06 9c c1 1e 6f 1e b7 6e  18 5e 74 45 be 10 b7 69  |....o..n.^tE...i|
-00000060  6d da 09 65 3c 38 a5 3d  f1 0a                    |m..e<8.=..|
+00000010  00 00 00 00 00 37 b7 99  22 eb 67 a0 32 57 76 b5  |.....7..".g.2Wv.|
+00000020  53 86 fc 5b 79 c5 4a 4f  3a 6b a9 0f d8 c8 30 de  |S..[y.JO:k....0.|
+00000030  0a 5b 9b af e2 15 03 03  00 30 00 00 00 00 00 00  |.[.......0......|
+00000040  00 00 00 00 00 00 00 00  00 00 57 9c 4b ca 83 a3  |..........W.K...|
+00000050  c0 3a 52 71 24 f5 b1 37  1e 4d c1 5a 2d 29 1c 90  |.:Rq$..7.M.Z-)..|
+00000060  9b 96 cf 1e 07 39 f1 1b  03 2b                    |.....9...+|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA
index 7356bfebfc..c20bd95d7f 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 26 62 0d 9d 45  |....]...Y..&b..E|
-00000010  3d 25 b7 ed ec ce b8 d6  8f fd a6 68 0b 07 05 28  |=%.........h...(|
-00000020  d4 2a 9c d9 cf bf e9 a0  92 71 6f 20 18 af a0 13  |.*.......qo ....|
-00000030  72 10 57 69 cf 63 db 73  c4 44 b8 a9 27 cd 9a a0  |r.Wi.c.s.D..'...|
-00000040  3b be f1 57 ef 10 19 80  0b c0 51 94 c0 2f 00 00  |;..W......Q../..|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 48 41 85 3e fc  |....]...Y..HA.>.|
+00000010  9f e7 b6 84 da fe 2f a7  1d e9 ba 12 4e a1 cf cb  |....../.....N...|
+00000020  9e f8 df 76 7c e7 29 c1  3b 9e 23 20 07 c9 55 c7  |...v|.).;.# ..U.|
+00000030  0e 45 5c 26 17 94 b4 14  6b 58 39 27 43 4e dc 9b  |.E\&....kX9'CN..|
+00000040  65 30 0e f2 bd 59 d9 a2  a1 f3 0a 01 c0 2f 00 00  |e0...Y......./..|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -63,18 +62,18 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 22 fe 67  |............ ".g|
-000002d0  48 d3 90 04 ee 7d c2 2a  6d 9f 3a 36 3c b2 f8 14  |H....}.*m.:6<...|
-000002e0  24 76 54 5a ae ed 2f 62  fc 76 e0 00 07 08 04 00  |$vTZ../b.v......|
-000002f0  80 6d 8b e6 52 be ed 40  b8 b1 51 53 94 08 93 76  |.m..R..@..QS...v|
-00000300  9b 84 06 66 60 b9 be a8  f1 bb 5d fa 81 42 28 8e  |...f`.....]..B(.|
-00000310  aa ce 72 9f df a3 53 2d  c9 6d 34 10 78 36 da 33  |..r...S-.m4.x6.3|
-00000320  09 0c a0 5e ea 56 2e 6f  62 fc 3c 5e 5b 6d 97 c9  |...^.V.ob.<^[m..|
-00000330  39 1b 3c eb 6d 1f 0a b5  02 06 6d 9e 99 24 14 ee  |9.<.m.....m..$..|
-00000340  f9 55 cc 4d 7f 77 0c 58  2c 59 0f a4 66 4b 81 b4  |.U.M.w.X,Y..fK..|
-00000350  d9 e4 f6 24 4f ba 05 83  6c c3 6c 2f 5e 74 42 09  |...$O...l.l/^tB.|
-00000360  b3 be d1 c9 6a c8 a6 34  5c bc 36 65 58 cd 02 ae  |....j..4\.6eX...|
-00000370  16 16 03 03 00 3a 0d 00  00 36 03 01 02 40 00 2e  |.....:...6...@..|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 73 d3 a9  |............ s..|
+000002d0  7e 93 32 e3 dd ad 1c b3  c1 ff 03 c2 b9 08 da 09  |~.2.............|
+000002e0  d3 1b 67 95 9c 8c d1 05  12 2e 8b dc 7a 08 04 00  |..g.........z...|
+000002f0  80 85 af 3b 06 67 b0 ab  07 70 21 02 b1 3a 89 40  |...;.g...p!..:.@|
+00000300  d6 90 ef a5 5b 89 49 81  18 20 74 9f 7b dd 58 65  |....[.I.. t.{.Xe|
+00000310  28 6f 2a f1 aa 3f 35 91  b9 88 79 27 a0 f3 e7 41  |(o*..?5...y'...A|
+00000320  9a a5 77 be 55 5e 70 89  37 b6 4a 7b 3b 8c df ad  |..w.U^p.7.J{;...|
+00000330  47 cc ac 45 47 43 05 05  ad c9 7b d8 1d d6 a8 fa  |G..EGC....{.....|
+00000340  38 45 c3 54 35 0c 28 a1  29 be 1f 73 98 a6 02 01  |8E.T5.(.)..s....|
+00000350  fb 9d 12 64 1a 9c f3 82  e5 3f f6 0c 20 67 59 72  |...d.....?.. gYr|
+00000360  3f a7 59 4e ef b4 58 ba  49 4e c9 b6 ea 95 b2 b3  |?.YN..X.IN......|
+00000370  78 16 03 03 00 3a 0d 00  00 36 03 01 02 40 00 2e  |x....:...6...@..|
 00000380  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000390  08 04 08 05 08 06 04 01  05 01 06 01 03 03 02 03  |................|
 000003a0  03 01 02 01 03 02 02 02  04 02 05 02 06 02 00 00  |................|
@@ -115,28 +114,28 @@
 00000200  e4 fa cc b1 8a ce e2 23  a0 87 f0 e1 67 51 eb 16  |.......#....gQ..|
 00000210  03 03 00 25 10 00 00 21  20 2f e5 7d a3 47 cd 62  |...%...! /.}.G.b|
 00000220  43 15 28 da ac 5f bb 29  07 30 ff f6 84 af c4 cf  |C.(.._.).0......|
-00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 03 00 92 0f 00  |...._X.;t.......|
-00000240  00 8e 04 03 00 8a 30 81  87 02 42 00 8e 41 5f 48  |......0...B..A_H|
-00000250  64 4e 6e 7e 7d ed 5b da  88 7a 38 1f bd 04 ee 93  |dNn~}.[..z8.....|
-00000260  88 f8 3d e5 b7 51 4a 43  6b c5 c1 02 06 c5 2c c1  |..=..QJCk.....,.|
-00000270  48 18 2e 11 63 8a 9d 94  35 98 bc d1 d7 19 1f c0  |H...c...5.......|
-00000280  f6 dc 10 15 89 bf 99 0c  87 7d 3e bf e2 02 41 4f  |.........}>...AO|
-00000290  e3 d4 a0 b2 4d 80 ec 21  2f b3 fc df 6c b7 bd 6d  |....M..!/...l..m|
-000002a0  c7 6d 0a 7a 24 56 a4 c8  36 ec 7d 2d 65 ff 8c 4b  |.m.z$V..6.}-e..K|
-000002b0  c7 cd 52 99 f1 2d e5 19  57 89 fe 52 44 ca e0 c3  |..R..-..W..RD...|
-000002c0  34 fc c5 4a da 59 f5 62  eb c4 c5 cb 1d d7 4b 63  |4..J.Y.b......Kc|
-000002d0  14 03 03 00 01 01 16 03  03 00 28 00 00 00 00 00  |..........(.....|
-000002e0  00 00 00 5d 34 16 3d d0  04 3f b7 3d a2 be 20 8b  |...]4.=..?.=.. .|
-000002f0  19 20 09 7b f0 7e 52 95  e6 b8 f1 06 08 93 6b 91  |. .{.~R.......k.|
-00000300  ee fa c8                                          |...|
+00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 03 00 91 0f 00  |...._X.;t.......|
+00000240  00 8d 04 03 00 89 30 81  86 02 41 66 64 90 bc df  |......0...Afd...|
+00000250  a5 d0 19 89 2b ed fc a5  8f 7e 14 d0 9f a2 07 6b  |....+....~.....k|
+00000260  d3 09 07 46 f8 29 4d b5  6c 01 e5 2e 0d d8 a4 b9  |...F.)M.l.......|
+00000270  1a 86 2f b1 10 4c 29 5b  de e7 29 e6 b9 32 53 ca  |../..L)[..)..2S.|
+00000280  d0 fc 7b a1 82 6e 34 2f  11 7a 2b 98 02 41 74 a4  |..{..n4/.z+..At.|
+00000290  51 21 0c 57 ac 99 d1 a3  8c 86 f6 f2 b8 66 b8 1f  |Q!.W.........f..|
+000002a0  2d db 49 1a c1 34 e6 02  fd ce 50 14 7c 9b a4 52  |-.I..4....P.|..R|
+000002b0  17 bc 96 ab 11 5f 97 9a  7f be ab 26 f7 1f 2b cf  |....._.....&..+.|
+000002c0  30 f1 da 80 b5 82 a0 da  44 be c1 00 51 1d b4 14  |0.......D...Q...|
+000002d0  03 03 00 01 01 16 03 03  00 28 00 00 00 00 00 00  |.........(......|
+000002e0  00 00 39 c2 3d 4e 74 16  e2 8c 4b f9 11 38 94 12  |..9.=Nt...K..8..|
+000002f0  8f d3 16 18 9b ad 41 ef  c9 ed 56 7f e3 ed d7 e5  |......A...V.....|
+00000300  0e 52                                             |.R|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 c1 1c 19 bc 14  |..........(.....|
-00000010  d3 44 ec 5d 6e 84 c4 06  ba c2 83 00 80 ea dd 7d  |.D.]n..........}|
-00000020  9b 2e 75 c7 9d 75 40 e8  89 d1 9b 69 16 20 0b 23  |..u..u@....i. .#|
-00000030  94 48 42                                          |.HB|
+00000000  14 03 03 00 01 01 16 03  03 00 28 c0 9a 2a 35 ef  |..........(..*5.|
+00000010  fa 87 1f 74 0a e9 b7 ea  3c 1c ab 1c ce 6e bb 95  |...t....<....n..|
+00000020  ef 92 f3 cb 07 c0 e6 af  b1 2a 60 fb 09 2a d7 68  |.........*`..*.h|
+00000030  27 b0 f1                                          |'..|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 20 ce 1a  |............. ..|
-00000010  b6 65 88 6d 17 9e 9c 9d  ec 36 af d3 7e fa e5 63  |.e.m.....6..~..c|
-00000020  bc 90 f0 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
-00000030  e5 a6 0e 68 bc 75 29 7e  c1 ee 6b 3b d3 03 c8 0a  |...h.u)~..k;....|
-00000040  4d 75                                             |Mu|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 b1 98 56  |...............V|
+00000010  38 68 a7 d0 da c6 83 4b  00 31 40 d7 1e 81 35 1a  |8h.....K.1@...5.|
+00000020  2f e3 42 15 03 03 00 1a  00 00 00 00 00 00 00 02  |/.B.............|
+00000030  1d 8f a1 cf 12 2f 53 37  4d 60 46 90 e2 db 97 ce  |...../S7M`F.....|
+00000040  3e 99                                             |>.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-Ed25519 b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-Ed25519
index e4e47030dd..9eb522b86b 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-Ed25519
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-Ed25519
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 73 ca 08 75 98  |....]...Y..s..u.|
-00000010  14 2e b6 c4 c0 74 e2 cf  05 24 dd 70 f4 aa 22 08  |.....t...$.p..".|
-00000020  39 6d 3a 61 11 90 c6 61  50 41 96 20 d1 c7 24 aa  |9m:a...aPA. ..$.|
-00000030  3a 5e 0c 2c 37 72 8c 80  76 ab c9 2f fb a5 39 7d  |:^.,7r..v../..9}|
-00000040  f5 f3 ce 97 d8 ea e5 4c  db 1b f8 f6 cc a8 00 00  |.......L........|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 7f e3 92 d1 05  |....]...Y.......|
+00000010  fd a2 f7 b4 24 f8 e6 e2  2f 15 51 f2 4b 72 12 59  |....$.../.Q.Kr.Y|
+00000020  e6 af fe c9 0b 86 8b 53  a3 ce ff 20 68 97 1d e3  |.......S... h...|
+00000030  6d 6c fb 67 78 05 ba fc  10 5b 83 87 8c 04 e9 57  |ml.gx....[.....W|
+00000040  19 32 3f ee 88 a0 30 61  de 1c d2 2d cc a8 00 00  |.2?...0a...-....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -63,18 +62,18 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 35 1f 14  |............ 5..|
-000002d0  77 42 a0 9c 04 14 f7 8b  df e5 b5 e7 71 40 34 4f  |wB..........q@4O|
-000002e0  f5 0d ab c2 2f 38 97 46  3e c2 57 26 7d 08 04 00  |..../8.F>.W&}...|
-000002f0  80 9d d7 8c 28 d8 a8 6c  a8 14 5d 92 f8 59 ab e5  |....(..l..]..Y..|
-00000300  bd e3 32 1e 49 f6 e6 11  11 ce eb 0c e1 27 3c 34  |..2.I........'<4|
-00000310  8c 94 a9 e9 8f 41 51 64  c2 6c 1c d0 e7 d4 ee cf  |.....AQd.l......|
-00000320  4f 9c f4 92 0f e5 48 c5  2b b5 82 79 c3 91 ee f9  |O.....H.+..y....|
-00000330  1c a6 b2 ee ec 9d 73 7c  df 2d 2b 49 c8 27 c7 cf  |......s|.-+I.'..|
-00000340  79 b4 6a 39 f6 ac fe 6f  fd f4 6c 7d 2c f2 7f 58  |y.j9...o..l},..X|
-00000350  2f a3 d4 f5 92 83 5b 83  19 55 39 e5 f8 d2 2c fd  |/.....[..U9...,.|
-00000360  ad 89 32 90 ba 89 cd 0d  ed 16 02 96 92 bd 77 d2  |..2...........w.|
-00000370  f3 16 03 03 00 3a 0d 00  00 36 03 01 02 40 00 2e  |.....:...6...@..|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 55 93 3e  |............ U.>|
+000002d0  dd fc 30 52 61 80 f3 e8  7e e2 fb f8 03 ab e4 86  |..0Ra...~.......|
+000002e0  bc 8b 69 5b f5 8c fd 4b  fc 12 2e 99 1a 08 04 00  |..i[...K........|
+000002f0  80 43 60 48 4c 88 e9 fc  78 36 5f a9 6a 61 54 7e  |.C`HL...x6_.jaT~|
+00000300  a8 a3 67 91 df ff 78 66  d6 b6 ce 95 26 af 8e ac  |..g...xf....&...|
+00000310  42 fa 95 e1 a3 c6 9b 73  bb 7b dc e6 aa ca 6f a0  |B......s.{....o.|
+00000320  17 6b ee 50 ff d9 20 ed  11 c4 e5 81 23 1d 6b 02  |.k.P.. .....#.k.|
+00000330  a8 e6 f6 ef fc 1f 69 9e  c1 28 d9 bd 36 98 ad f6  |......i..(..6...|
+00000340  f3 40 5a e8 a4 e9 3c 62  b2 8d 53 a1 88 06 e6 81  |.@Z...<b..S.....|
+00000350  23 05 4d 23 c5 9d 3f c9  ac 6a 1a 11 ab ce 4f 91  |#.M#..?..j....O.|
+00000360  15 b1 d6 63 4b 60 11 a8  6d 8d 57 31 6d 7c 4b 01  |...cK`..m.W1m|K.|
+00000370  37 16 03 03 00 3a 0d 00  00 36 03 01 02 40 00 2e  |7....:...6...@..|
 00000380  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000390  08 04 08 05 08 06 04 01  05 01 06 01 03 03 02 03  |................|
 000003a0  03 01 02 01 03 02 02 02  04 02 05 02 06 02 00 00  |................|
@@ -103,20 +102,20 @@
 00000140  08 16 03 03 00 25 10 00  00 21 20 2f e5 7d a3 47  |.....%...! /.}.G|
 00000150  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
 00000160  c4 cf c2 ed 90 99 5f 58  cb 3b 74 16 03 03 00 48  |......_X.;t....H|
-00000170  0f 00 00 44 08 07 00 40  a1 8a 00 6d 57 47 ab a4  |...D...@...mWG..|
-00000180  ae 93 3e dd 04 fb 04 3b  dd b7 de 93 bc 2e 40 ff  |..>....;......@.|
-00000190  29 fa d0 f7 63 4e b9 5f  1f d9 5d 8c 87 eb bb 43  |)...cN._..]....C|
-000001a0  25 e5 a7 04 8d 16 88 f8  8b 0d 17 d1 ef 75 7c f1  |%............u|.|
-000001b0  1a b4 8f 2f cd f1 18 00  14 03 03 00 01 01 16 03  |.../............|
-000001c0  03 00 20 b2 95 81 2d 8c  06 f0 54 da ef 31 9a 33  |.. ...-...T..1.3|
-000001d0  89 c3 b5 e8 6a 77 3c fe  e8 e3 d0 24 94 2d 7e f9  |....jw<....$.-~.|
-000001e0  08 d4 ce                                          |...|
+00000170  0f 00 00 44 08 07 00 40  ff da 51 80 4b 76 25 5d  |...D...@..Q.Kv%]|
+00000180  89 dc ce 9a fe 11 c3 95  c5 9a c2 fa ee 8a ba 87  |................|
+00000190  42 be 46 93 da 10 c7 2a  ab 7c 4c 24 a8 a7 b1 de  |B.F....*.|L$....|
+000001a0  17 6a b4 85 13 ff db 8d  69 9a be 0a b1 7d 1d d6  |.j......i....}..|
+000001b0  b1 83 26 d1 2f 26 59 06  14 03 03 00 01 01 16 03  |..&./&Y.........|
+000001c0  03 00 20 7b 59 a9 9c 67  42 6e ce 78 78 cb d0 94  |.. {Y..gBn.xx...|
+000001d0  d1 b1 38 06 65 a7 97 56  3c cf 14 2f 80 1c f4 04  |..8.e..V<../....|
+000001e0  59 de 4d                                          |Y.M|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 b3 9b 27 5a 1e  |.......... ..'Z.|
-00000010  ce 80 3c 04 f7 aa 69 b6  6b 37 9a 86 e9 95 ce 73  |..<...i.k7.....s|
-00000020  8a ef 38 62 6f cb a0 0e  45 78 ad                 |..8bo...Ex.|
+00000000  14 03 03 00 01 01 16 03  03 00 20 91 2c 24 55 e8  |.......... .,$U.|
+00000010  70 9e 88 07 53 e1 60 9e  86 af 53 d4 21 d9 99 ad  |p...S.`...S.!...|
+00000020  3a 2b 83 b0 bc f7 93 5e  63 04 50                 |:+.....^c.P|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 bf 78 66  da 5b a7 fd cf 95 32 20  |......xf.[....2 |
-00000010  b6 ce 1e 5d 4f 21 05 6a  f7 3a 27 15 03 03 00 12  |...]O!.j.:'.....|
-00000020  42 e1 e3 e3 d3 5a 98 8c  d1 e3 ce a5 02 f9 58 ba  |B....Z........X.|
-00000030  ce 33                                             |.3|
+00000000  17 03 03 00 16 e0 69 be  8e c5 4d 63 0e 77 88 42  |......i...Mc.w.B|
+00000010  4e a8 e9 8f f4 c5 05 56  99 92 70 15 03 03 00 12  |N......V..p.....|
+00000020  64 5c 05 8f 23 af e8 aa  f6 76 1b b6 90 36 d9 d5  |d\..#....v...6..|
+00000030  59 e6                                             |Y.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384 b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384
index 0fb7a12f70..e9f6604b2f 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 e8 4b b6 f9 1c  |....]...Y...K...|
-00000010  d9 59 e0 86 7b 9b cf 37  9f 0c f2 14 51 de 10 66  |.Y..{..7....Q..f|
-00000020  39 05 15 ab 17 25 df 89  d7 5b 41 20 e5 28 ba da  |9....%...[A .(..|
-00000030  29 8c 72 40 14 7e 06 2d  f8 04 6d 4d 37 09 62 9a  |).r@.~.-..mM7.b.|
-00000040  87 f7 52 fc 77 61 05 04  2f 65 c0 df c0 30 00 00  |..R.wa../e...0..|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 bc b7 27 59 a9  |....]...Y....'Y.|
+00000010  a7 ac ce 8b f5 5b 13 56  60 19 70 2a a7 f0 a2 ea  |.....[.V`.p*....|
+00000020  1a ce 27 2a 67 53 e0 5c  7e 5e 80 20 d5 c6 de 6d  |..'*gS.\~^. ...m|
+00000030  d1 3c 6d cb c9 49 77 00  cc 31 87 0a 86 45 06 70  |.<m..Iw..1...E.p|
+00000040  8e fe b8 56 c9 11 21 1a  5f b9 78 25 c0 30 00 00  |...V..!._.x%.0..|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -63,18 +62,18 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 57 e9 2a  |............ W.*|
-000002d0  eb ac 52 cf 39 70 0a c3  21 38 2d 46 66 c1 df 26  |..R.9p..!8-Ff..&|
-000002e0  38 ad b2 19 d5 a9 f5 37  15 f7 f6 dc 54 08 04 00  |8......7....T...|
-000002f0  80 35 c5 7a 73 5f 36 ed  72 f9 2d 21 a9 9f 94 3f  |.5.zs_6.r.-!...?|
-00000300  98 de 22 b1 35 c1 9d e2  d2 42 bb 32 7a f3 11 0e  |..".5....B.2z...|
-00000310  f7 3c a0 ca 44 87 95 e6  f3 1a 19 45 51 a8 f5 f2  |.<..D......EQ...|
-00000320  fe ac 00 d0 fc 79 a8 a9  83 fe 81 48 e9 f7 48 ce  |.....y.....H..H.|
-00000330  08 8c 45 3c 24 b5 d4 e0  07 17 d1 f0 fa 3d 13 3c  |..E<$........=.<|
-00000340  ef f5 7b f2 5a c2 9a 60  af de 8e 74 50 c7 df b0  |..{.Z..`...tP...|
-00000350  27 ef 0e dd db 6a 8f a4  94 69 f0 08 7e 3c 3c 93  |'....j...i..~<<.|
-00000360  03 f9 67 ad 30 0b e6 d7  f0 c0 77 bd c4 1a 6e b4  |..g.0.....w...n.|
-00000370  52 16 03 03 00 3a 0d 00  00 36 03 01 02 40 00 2e  |R....:...6...@..|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 8b ea d3  |............ ...|
+000002d0  e4 1f c2 21 cb 32 99 00  d2 a9 a4 f3 e4 9a d7 6e  |...!.2.........n|
+000002e0  f0 6e 7c 45 ca 41 51 60  a3 31 61 f0 34 08 04 00  |.n|E.AQ`.1a.4...|
+000002f0  80 96 62 58 0c b4 72 a7  49 1c b8 73 72 5a c7 ba  |..bX..r.I..srZ..|
+00000300  e2 fe dc a6 a4 54 3d 21  83 70 ab ef de d8 d8 db  |.....T=!.p......|
+00000310  82 56 22 4f 9d f6 04 c2  b6 f7 9d a0 41 88 53 c9  |.V"O........A.S.|
+00000320  2b 57 80 71 a2 bd d7 84  b6 4b cd 65 3d c3 10 cb  |+W.q.....K.e=...|
+00000330  5d 89 03 af 46 d5 b0 39  b8 c8 2d 74 1b 46 8d 0d  |]...F..9..-t.F..|
+00000340  ca 13 30 34 54 10 ea ec  77 ca 84 a6 2c 88 68 d6  |..04T...w...,.h.|
+00000350  69 e6 f3 95 aa 65 af 05  7d e0 c2 84 48 f5 fa ae  |i....e..}...H...|
+00000360  d5 90 2a 79 0c 45 c6 7d  d3 b7 de 85 e8 b5 2b 68  |..*y.E.}......+h|
+00000370  bf 16 03 03 00 3a 0d 00  00 36 03 01 02 40 00 2e  |.....:...6...@..|
 00000380  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000390  08 04 08 05 08 06 04 01  05 01 06 01 03 03 02 03  |................|
 000003a0  03 01 02 01 03 02 02 02  04 02 05 02 06 02 00 00  |................|
@@ -115,26 +114,26 @@
 00000200  e5 35 16 03 03 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
 00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 03 00  |......._X.;t....|
-00000230  88 0f 00 00 84 08 04 00  80 ac ba b5 9f a6 2e 81  |................|
-00000240  fa c5 95 f7 27 e6 1c 54  80 51 1f 98 c6 bd 54 79  |....'..T.Q....Ty|
-00000250  ca 24 1a 0d df a0 e4 c8  5a e2 2d 83 35 ed 88 8f  |.$......Z.-.5...|
-00000260  08 23 db c9 fa 56 c9 5d  14 91 43 53 57 40 a1 a6  |.#...V.]..CSW@..|
-00000270  c9 61 b4 99 d5 4b bc 32  b5 2a a0 13 68 d3 06 1b  |.a...K.2.*..h...|
-00000280  07 7f 3a a3 05 32 19 c2  d7 ed 9a 68 f7 da e9 80  |..:..2.....h....|
-00000290  54 1f 1d c3 6b fc 1f 85  b0 8d 91 76 39 a1 56 e2  |T...k......v9.V.|
-000002a0  1b 73 1e c3 1f 57 59 25  17 b2 53 6c fd 47 5f de  |.s...WY%..Sl.G_.|
-000002b0  57 2c c0 e7 76 1b 71 05  6c 14 03 03 00 01 01 16  |W,..v.q.l.......|
-000002c0  03 03 00 28 00 00 00 00  00 00 00 00 42 57 90 45  |...(........BW.E|
-000002d0  6a b9 64 64 92 ac c5 63  14 66 d1 f0 f9 65 f3 25  |j.dd...c.f...e.%|
-000002e0  de 81 74 da 68 1c cb 90  a5 46 6d 69              |..t.h....Fmi|
+00000230  88 0f 00 00 84 08 04 00  80 48 ae 01 b6 4e e2 f0  |.........H...N..|
+00000240  6b d9 58 e9 95 fb 93 56  10 8f 15 dc e8 3e c7 49  |k.X....V.....>.I|
+00000250  b3 26 c2 06 91 4a 02 27  36 6b 21 cd aa 4a 62 6a  |.&...J.'6k!..Jbj|
+00000260  9d 44 6a b7 6c 16 d4 52  23 12 20 9d e5 5c 83 04  |.Dj.l..R#. ..\..|
+00000270  d8 38 45 61 8b 30 5b 7b  6b 77 be 47 5a f8 fe 4d  |.8Ea.0[{kw.GZ..M|
+00000280  c8 e7 83 97 44 b4 fb 71  89 30 f2 cf d2 49 82 e8  |....D..q.0...I..|
+00000290  d4 a8 73 86 44 29 30 17  7b b6 0e 4f 5f 6b 0c 33  |..s.D)0.{..O_k.3|
+000002a0  43 7f 9b 84 a4 9b c6 30  18 ff 1b 85 a7 a9 17 23  |C......0.......#|
+000002b0  2e 08 d3 57 10 af 49 95  2a 14 03 03 00 01 01 16  |...W..I.*.......|
+000002c0  03 03 00 28 00 00 00 00  00 00 00 00 43 b8 4c 8a  |...(........C.L.|
+000002d0  84 1e 6c 41 02 fb b6 74  1e 4d 69 0d c0 f8 fc 8b  |..lA...t.Mi.....|
+000002e0  ce 64 53 95 40 c8 e8 52  31 5f a3 65              |.dS.@..R1_.e|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 6b 52 88 32 f1  |..........(kR.2.|
-00000010  6e 1f dd ce 38 ba d4 7d  c7 4a 55 89 4c 91 57 34  |n...8..}.JU.L.W4|
-00000020  1e 54 12 8e 37 e2 dc a9  7d 37 b6 31 57 2f 11 27  |.T..7...}7.1W/.'|
-00000030  42 96 c2                                          |B..|
+00000000  14 03 03 00 01 01 16 03  03 00 28 04 f3 da a1 b9  |..........(.....|
+00000010  b9 1a cf f3 a8 19 aa 23  12 65 8d 68 dc 37 09 9a  |.......#.e.h.7..|
+00000020  e4 0c cd e5 d4 3d cb 42  89 e4 ad 9e 49 34 de 05  |.....=.B....I4..|
+00000030  74 f0 33                                          |t.3|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 be ea d3  |................|
-00000010  87 8c 16 62 86 4a 53 49  9d d7 f8 01 11 8b 9b 58  |...b.JSI.......X|
-00000020  39 89 cf 15 03 03 00 1a  00 00 00 00 00 00 00 02  |9...............|
-00000030  93 9d 61 38 db c4 be 69  5e fb 63 1e ae f3 57 e4  |..a8...i^.c...W.|
-00000040  fe 85                                             |..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 00 33 c0  |..............3.|
+00000010  3f 9c 56 3e 9b ed bb 5e  81 0c 4a 01 65 91 f5 da  |?.V>...^..J.e...|
+00000020  f6 4b 62 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.Kb.............|
+00000030  55 6f 8d 18 50 1f aa 00  94 9b 79 26 f0 3e 0a c6  |Uo..P.....y&.>..|
+00000040  45 b0                                             |E.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA
index 689be1097b..25120914e8 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 dc 6d a4 87 a5  |....]...Y...m...|
-00000010  a1 8e 67 3d c3 ed c0 e4  ed 38 7a 00 df b1 50 f4  |..g=.....8z...P.|
-00000020  4a cc 0f ab e2 e8 d9 77  b8 1a 18 20 cb e9 02 2a  |J......w... ...*|
-00000030  4f 17 c0 9d 3d 55 60 3e  d8 46 ee 52 dd bf 3e e6  |O...=U`>.F.R..>.|
-00000040  c9 4a b5 24 f5 19 73 56  ab 78 ce ec c0 09 00 00  |.J.$..sV.x......|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 80 e4 9b 9d a9  |....]...Y.......|
+00000010  59 27 7f 44 b9 4b 90 31  c7 66 03 90 d6 9b ef 17  |Y'.D.K.1.f......|
+00000020  f8 fb e5 63 04 68 f6 ce  a1 a6 f4 20 cb 84 55 fa  |...c.h..... ..U.|
+00000030  41 77 48 0f 0a 5a 24 92  e3 59 b2 d9 91 0c 18 4a  |AwH..Z$..Y.....J|
+00000040  bf af ad db 64 db cb 57  d8 0b de 46 c0 09 00 00  |....d..W...F....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
 00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
@@ -58,23 +57,23 @@
 00000240  8c 25 c1 33 13 83 0d 94  06 bb d4 37 7a f6 ec 7a  |.%.3.......7z..z|
 00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
 00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
-00000270  95 12 07 8f 2a 16 03 03  00 b7 0c 00 00 b3 03 00  |....*...........|
-00000280  1d 20 d8 81 5d 07 0c 63  f2 9a bf 82 37 08 f6 6d  |. ..]..c....7..m|
-00000290  e2 20 4b 98 85 cc 62 ad  a2 ac b1 8b 15 de 1d 5e  |. K...b........^|
-000002a0  3b 74 04 03 00 8b 30 81  88 02 42 01 81 b9 d9 e7  |;t....0...B.....|
-000002b0  3b 89 ed 5f cb 0a 10 16  85 69 c3 5e 7f 82 95 f6  |;.._.....i.^....|
-000002c0  49 48 3a 6d 84 c2 f5 04  9a 00 ef 86 f9 10 fc 03  |IH:m............|
-000002d0  a8 ba eb e7 0c 0c 0c 27  7b ba aa 73 a4 23 03 cb  |.......'{..s.#..|
-000002e0  d8 be c8 39 34 1f c4 33  e4 cf 12 98 35 02 42 01  |...94..3....5.B.|
-000002f0  dc 0b c7 df 9c b2 c4 f5  dc 4a a6 b0 ef 40 3c 8c  |.........J...@<.|
-00000300  98 f3 93 ac 14 9b 4d fe  6e 7a 09 fd 23 c3 14 4f  |......M.nz..#..O|
-00000310  cf 1a e6 61 72 58 8c 75  10 6c 75 42 cc 7b 9c 4a  |...arX.u.luB.{.J|
-00000320  11 62 25 12 63 44 9d fe  3d 67 44 7e 74 bd b0 3d  |.b%.cD..=gD~t..=|
-00000330  04 16 03 03 00 3a 0d 00  00 36 03 01 02 40 00 2e  |.....:...6...@..|
-00000340  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
-00000350  08 04 08 05 08 06 04 01  05 01 06 01 03 03 02 03  |................|
-00000360  03 01 02 01 03 02 02 02  04 02 05 02 06 02 00 00  |................|
-00000370  16 03 03 00 04 0e 00 00  00                       |.........|
+00000270  95 12 07 8f 2a 16 03 03  00 b6 0c 00 00 b2 03 00  |....*...........|
+00000280  1d 20 2f 6b 4c 95 75 59  25 2f f7 fd b1 1f d2 9e  |. /kL.uY%/......|
+00000290  2f 38 5e 57 1a 7c 36 99  1e 11 4a 3f f7 13 5b 0b  |/8^W.|6...J?..[.|
+000002a0  90 33 04 03 00 8a 30 81  87 02 42 01 b4 34 3f d0  |.3....0...B..4?.|
+000002b0  41 09 00 12 f4 79 20 f4  b7 80 5c d1 35 9d 8b d2  |A....y ...\.5...|
+000002c0  fa c9 4a a9 44 6b 05 95  c5 a7 50 08 0d 73 66 3e  |..J.Dk....P..sf>|
+000002d0  dd 49 e4 a4 c6 c0 12 ca  0b 4a df bc c1 3e ec 88  |.I.......J...>..|
+000002e0  ec 9a 0e 71 15 4d 45 98  04 3a 51 7a 67 02 41 15  |...q.ME..:Qzg.A.|
+000002f0  17 de b0 5c 03 a5 74 0e  0f 2b 53 6e 55 17 73 b8  |...\..t..+SnU.s.|
+00000300  ac 16 70 1a 95 f9 25 b1  fc 4b 9d c7 b1 f4 71 f6  |..p...%..K....q.|
+00000310  86 2d 5b 74 9e d3 4e 1b  40 67 f4 a6 62 2e c8 4d  |.-[t..N.@g..b..M|
+00000320  66 f7 32 e9 05 df d5 b0  e8 1a b7 b1 48 c4 1c 91  |f.2.........H...|
+00000330  16 03 03 00 3a 0d 00 00  36 03 01 02 40 00 2e 04  |....:...6...@...|
+00000340  03 05 03 06 03 08 07 08  08 08 09 08 0a 08 0b 08  |................|
+00000350  04 08 05 08 06 04 01 05  01 06 01 03 03 02 03 03  |................|
+00000360  01 02 01 03 02 02 02 04  02 05 02 06 02 00 00 16  |................|
+00000370  03 03 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
 00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
@@ -111,31 +110,31 @@
 00000200  e5 35 16 03 03 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
 00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 03 00  |......._X.;t....|
-00000230  88 0f 00 00 84 08 04 00  80 3c 66 74 5d c3 4b d6  |.........<ft].K.|
-00000240  98 89 fe 1d 47 36 26 62  e8 19 0a 2c a9 8d 9a cf  |....G6&b...,....|
-00000250  f2 a1 15 3a bb c5 90 be  8d 09 d5 e8 3e 1f f3 87  |...:........>...|
-00000260  19 a7 d9 5d 7c f6 65 32  bd 47 e9 2f 90 a8 90 1b  |...]|.e2.G./....|
-00000270  41 05 08 35 32 f6 c2 22  70 61 37 a3 48 96 72 e0  |A..52.."pa7.H.r.|
-00000280  41 26 07 a9 6c c2 34 72  35 d5 43 ce 23 fd 34 9b  |A&..l.4r5.C.#.4.|
-00000290  56 b7 4e c0 be b9 b3 bd  81 df 32 58 3f b2 af 34  |V.N.......2X?..4|
-000002a0  c0 08 69 27 19 43 0f 34  1b 56 ed 08 cd 1b 2b f3  |..i'.C.4.V....+.|
-000002b0  41 75 8c 0a b2 43 4c f6  fe 14 03 03 00 01 01 16  |Au...CL.........|
+00000230  88 0f 00 00 84 08 04 00  80 70 66 f2 ac fb f7 29  |.........pf....)|
+00000240  15 31 a2 12 de 37 3f cc  97 74 5c 5b 7e 6d e4 f8  |.1...7?..t\[~m..|
+00000250  b0 b3 3d 9c ee 32 bf d7  64 90 d7 af ad 8f 61 77  |..=..2..d.....aw|
+00000260  f2 c0 7e 6f 91 1d 4e 95  92 3e ab 23 f0 ac d8 de  |..~o..N..>.#....|
+00000270  32 69 cd bc 04 4c d1 a3  77 7a af ac f0 64 41 aa  |2i...L..wz...dA.|
+00000280  a0 53 f0 89 89 a4 6f 1f  67 21 16 55 4e dc cb a8  |.S....o.g!.UN...|
+00000290  12 7d cb a0 5c a9 48 48  d9 af 03 f0 75 ed 32 72  |.}..\.HH....u.2r|
+000002a0  d5 da 34 a3 ea 82 08 8f  00 fc 7d 1d b8 11 ff f7  |..4.......}.....|
+000002b0  09 52 a8 cc a8 66 b0 06  1e 14 03 03 00 01 01 16  |.R...f..........|
 000002c0  03 03 00 40 00 00 00 00  00 00 00 00 00 00 00 00  |...@............|
-000002d0  00 00 00 00 ce ef 0a 09  6d 11 17 89 31 b3 ac 31  |........m...1..1|
-000002e0  76 fe 02 d1 2b f8 dc df  fc 59 e3 2f aa 14 4e 9d  |v...+....Y./..N.|
-000002f0  c1 d9 5d f6 4f 57 6f 15  db 93 f1 27 12 02 7c 08  |..].OWo....'..|.|
-00000300  75 f6 48 26                                       |u.H&|
+000002d0  00 00 00 00 9c 7d d4 9e  59 53 e7 66 64 63 9c cb  |.....}..YS.fdc..|
+000002e0  58 03 03 26 fe d9 15 eb  03 1c 8f a7 9c 5a 86 4a  |X..&.........Z.J|
+000002f0  6c 4e 06 4a 80 91 94 00  6f 7d 38 6a ea a3 68 df  |lN.J....o}8j..h.|
+00000300  17 08 14 ed                                       |....|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 c0 0b de 9c 60  |..........@....`|
-00000010  35 52 38 09 01 7f e5 52  b3 cf b4 e6 27 02 36 52  |5R8....R....'.6R|
-00000020  ce 84 dd f5 ee f8 65 7c  89 ad 5e 1c 86 09 36 d0  |......e|..^...6.|
-00000030  23 c7 52 63 6b 67 97 4e  bf c0 28 83 3a c8 3e a2  |#.Rckg.N..(.:.>.|
-00000040  2f f3 d7 08 8c c0 86 64  8e 9c 3e                 |/......d..>|
+00000000  14 03 03 00 01 01 16 03  03 00 40 7e 6d 15 90 c5  |..........@~m...|
+00000010  99 96 ca bb 16 b5 5a 55  3e b0 ef 3f ab e5 b6 8c  |......ZU>..?....|
+00000020  51 1d 18 c7 c2 25 86 e0  db c1 d0 38 85 51 4e 8d  |Q....%.....8.QN.|
+00000030  37 51 92 cc d0 64 37 b7  67 7b 2c fc e7 1e 16 f6  |7Q...d7.g{,.....|
+00000040  76 3a 94 48 68 eb dc cc  cf 2a 4d                 |v:.Hh....*M|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 98 7e 6b  30 28 7d e1 6f 09 17 40  |......~k0(}.o..@|
-00000020  cf 5f 98 90 46 91 b5 9b  f8 29 22 a0 85 75 f7 f6  |._..F....)"..u..|
-00000030  f4 33 c8 60 75 15 03 03  00 30 00 00 00 00 00 00  |.3.`u....0......|
-00000040  00 00 00 00 00 00 00 00  00 00 02 c0 9e 3b 21 50  |.............;!P|
-00000050  a1 7a 16 67 32 3d 66 6d  c4 7f 9c 9b 44 30 31 f4  |.z.g2=fm....D01.|
-00000060  ea 03 7a e3 54 5d 35 7f  d3 eb                    |..z.T]5...|
+00000010  00 00 00 00 00 db 14 ae  78 62 50 37 42 b8 fc c6  |........xbP7B...|
+00000020  f1 84 40 75 7c e4 3f 8a  57 b8 1c 12 4a 6f 11 f2  |..@u|.?.W...Jo..|
+00000030  ba 1a a6 9b 20 15 03 03  00 30 00 00 00 00 00 00  |.... ....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 09 93 aa 80 fd b2  |................|
+00000050  66 e2 83 0e f8 83 45 3d  e1 39 06 5d a3 12 9e 12  |f.....E=.9.]....|
+00000060  fd f5 cb 32 c4 3b ce 20  e4 10                    |...2.;. ..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA
index 2dd00ba602..3bfb4aaabd 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 df 59 a1 48 61  |....]...Y...Y.Ha|
-00000010  ef db cd 29 5f 9b 90 e4  d9 6d db 10 98 ae 69 b8  |...)_....m....i.|
-00000020  97 ed 8f 57 24 42 16 32  0a b0 b1 20 79 b3 fc 90  |...W$B.2... y...|
-00000030  63 58 4b ab 45 d8 e9 39  7c 11 20 09 33 db b5 4c  |cXK.E..9|. .3..L|
-00000040  2c e2 d6 39 63 fe 74 d5  59 18 5c 7d c0 2f 00 00  |,..9c.t.Y.\}./..|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 c0 dd 18 ad 41  |....]...Y......A|
+00000010  2b ee fd 45 1f c0 c1 10  75 a7 1d 80 74 3e 8e 66  |+..E....u...t>.f|
+00000020  18 c8 64 c2 b4 89 4f 19  ff e0 0c 20 be c6 2a 8e  |..d...O.... ..*.|
+00000030  73 0a 1e 7a 2a d2 81 71  11 ba e9 de 02 0a aa 52  |s..z*..q.......R|
+00000040  76 b7 43 a3 49 a0 81 24  9c 57 4c 26 c0 2f 00 00  |v.C.I..$.WL&./..|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -63,18 +62,18 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 12 4b 94  |............ .K.|
-000002d0  2b 4a d0 b5 0f ca 87 05  7f 56 c3 11 b0 83 01 27  |+J.......V.....'|
-000002e0  68 a2 dd 63 b6 9b ff e5  48 7e af dd 0f 08 04 00  |h..c....H~......|
-000002f0  80 38 6f 01 25 4e 51 f1  8d 6c 89 4b 85 85 1d cd  |.8o.%NQ..l.K....|
-00000300  63 21 5e 89 d5 04 ac 81  cf 42 3c 6f df f1 53 ac  |c!^......B<o..S.|
-00000310  e3 54 28 a3 9f 06 76 96  9c 64 c7 22 55 14 2e 48  |.T(...v..d."U..H|
-00000320  7e d3 97 9a 35 b8 cf 1c  b8 a0 f2 b1 da 2f 0f a4  |~...5......../..|
-00000330  07 44 43 a8 01 67 a8 94  8d 8e 7a 60 91 48 d0 c7  |.DC..g....z`.H..|
-00000340  b5 c9 c8 ad df b0 33 cd  4a 37 75 ef 65 56 4b fd  |......3.J7u.eVK.|
-00000350  23 e7 b7 d3 3b fc 14 4e  b0 32 9b d3 cb e1 cd 4e  |#...;..N.2.....N|
-00000360  93 0e 01 cf 54 95 af e5  29 1f 8d 07 42 0f 29 67  |....T...)...B.)g|
-00000370  6d 16 03 03 00 3a 0d 00  00 36 03 01 02 40 00 2e  |m....:...6...@..|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 5a f3 c3  |............ Z..|
+000002d0  1b 34 9a 1a 01 68 65 fd  25 e5 e4 62 f4 17 d6 00  |.4...he.%..b....|
+000002e0  88 ae 5e fa 6b ef 60 96  e9 96 1e 33 0f 08 04 00  |..^.k.`....3....|
+000002f0  80 74 91 43 7a 3e 02 93  c6 6c 6d 36 86 2f 74 51  |.t.Cz>...lm6./tQ|
+00000300  50 84 a2 0b 1c b4 90 71  72 2b f9 7d 35 2a a6 fc  |P......qr+.}5*..|
+00000310  56 b1 fa 36 e0 cb ea 5a  4e 89 71 3f 28 d3 fc 90  |V..6...ZN.q?(...|
+00000320  de 21 0c 03 84 d9 23 78  b6 58 f2 03 02 27 48 f9  |.!....#x.X...'H.|
+00000330  6d 6c 2b eb 62 36 47 66  55 fc d9 77 42 1e 9b 93  |ml+.b6GfU..wB...|
+00000340  00 0f 5a 71 76 af 2c d9  b7 c3 6e e8 7a 64 34 0f  |..Zqv.,...n.zd4.|
+00000350  78 36 d7 cf a1 bb 3d 0a  23 64 c4 70 f0 78 8e 42  |x6....=.#d.p.x.B|
+00000360  80 42 1f 0f 1d 7f c9 b6  7b 9c 2a 30 6c 7a ef 0c  |.B......{.*0lz..|
+00000370  2f 16 03 03 00 3a 0d 00  00 36 03 01 02 40 00 2e  |/....:...6...@..|
 00000380  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000390  08 04 08 05 08 06 04 01  05 01 06 01 03 03 02 03  |................|
 000003a0  03 01 02 01 03 02 02 02  04 02 05 02 06 02 00 00  |................|
@@ -115,26 +114,26 @@
 00000200  e5 35 16 03 03 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
 00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 03 00  |......._X.;t....|
-00000230  88 0f 00 00 84 08 04 00  80 a5 81 a8 8a ed 68 25  |..............h%|
-00000240  5d 82 da 0f dc 93 20 56  34 c1 a0 62 0a a7 fb a5  |]..... V4..b....|
-00000250  58 07 79 b0 45 17 2d 13  99 9f 6c dc 53 9e 1c e2  |X.y.E.-...l.S...|
-00000260  1d 9b a3 bb 69 af 58 33  e1 31 d7 72 f4 86 1d 66  |....i.X3.1.r...f|
-00000270  55 a8 c9 77 5b 57 c5 86  74 a0 c9 25 a9 cc 2e da  |U..w[W..t..%....|
-00000280  26 17 6e bb 34 5b 49 94  0e 05 db b4 05 a4 65 22  |&.n.4[I.......e"|
-00000290  98 8c 91 ae d6 1c 89 f4  df 63 8b 45 17 05 0c 50  |.........c.E...P|
-000002a0  c0 1d 5e 75 67 c5 be 32  9d f0 4c a5 85 91 f6 f0  |..^ug..2..L.....|
-000002b0  8d 58 11 61 85 7b 5c e4  7e 14 03 03 00 01 01 16  |.X.a.{\.~.......|
-000002c0  03 03 00 28 00 00 00 00  00 00 00 00 30 27 fd 36  |...(........0'.6|
-000002d0  e0 91 2d 1d d7 4a 38 d2  73 5c 5d 4c b2 27 42 cf  |..-..J8.s\]L.'B.|
-000002e0  df 0d 33 ee 49 18 36 f3  bd c6 ee a8              |..3.I.6.....|
+00000230  88 0f 00 00 84 08 04 00  80 56 a2 bb f3 05 94 90  |.........V......|
+00000240  46 bc ef 79 ea 74 f9 a4  5c 27 59 dd 93 53 c3 9f  |F..y.t..\'Y..S..|
+00000250  07 b0 bf c1 e2 dc 39 b9  0d 63 62 d1 d0 88 65 e4  |......9..cb...e.|
+00000260  2b 28 d3 ad b1 78 60 4c  0d a6 1f 2e a1 bc 36 81  |+(...x`L......6.|
+00000270  31 f0 aa 0b 52 e6 04 69  ba 8a 9d c1 fd 25 d3 50  |1...R..i.....%.P|
+00000280  43 5b ed fc 78 21 2b cc  13 f8 db f1 8b e7 57 d8  |C[..x!+.......W.|
+00000290  59 f3 cf 54 ab d0 ea d6  8c 61 32 79 b8 be a6 c7  |Y..T.....a2y....|
+000002a0  87 0a 35 88 70 f7 3f 2d  bd 1b 7c 57 35 32 1b 81  |..5.p.?-..|W52..|
+000002b0  87 08 e3 b0 1f a1 2b 13  fb 14 03 03 00 01 01 16  |......+.........|
+000002c0  03 03 00 28 00 00 00 00  00 00 00 00 49 94 ed a1  |...(........I...|
+000002d0  a3 13 e0 f4 20 2a 63 4d  ef 24 d3 6c 8d 6c de b3  |.... *cM.$.l.l..|
+000002e0  92 16 21 0d b0 6c 64 df  1b 32 ca dc              |..!..ld..2..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 30 5f 74 39 bb  |..........(0_t9.|
-00000010  c8 00 8c d7 bd 74 ce 43  62 ea 08 0f ba b4 88 74  |.....t.Cb......t|
-00000020  d3 31 c9 3c a6 3a 92 14  75 44 95 ee c0 a9 ef 75  |.1.<.:..uD.....u|
-00000030  40 25 5f                                          |@%_|
+00000000  14 03 03 00 01 01 16 03  03 00 28 b9 2c 96 43 03  |..........(.,.C.|
+00000010  f9 8c 28 34 4e 8b 58 ba  d7 1a c4 87 d8 67 5c 0f  |..(4N.X......g\.|
+00000020  36 36 67 54 4e f4 6c 9c  0c 0e 1f df ca a3 8d ab  |66gTN.l.........|
+00000030  31 f2 84                                          |1..|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 f9 d9 d3  |................|
-00000010  ee ec ec 6e 8d 0d dd 62  f3 e1 19 0f f4 24 06 46  |...n...b.....$.F|
-00000020  76 7d 78 15 03 03 00 1a  00 00 00 00 00 00 00 02  |v}x.............|
-00000030  ce 6a 05 27 af 9a 3d 09  27 70 dc c2 4c 8a a5 ab  |.j.'..=.'p..L...|
-00000040  47 d4                                             |G.|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 de 90 16  |................|
+00000010  8e ec 2c 60 b8 a7 4f b6  26 8a c9 78 ff e0 73 19  |..,`..O.&..x..s.|
+00000020  b3 01 c1 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
+00000030  8a 4b 2c 4b 99 51 81 27  34 28 63 00 15 24 e1 47  |.K,K.Q.'4(c..$.G|
+00000040  4a 2f                                             |J/|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPKCS1v15 b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPKCS1v15
index 5fab0f8c82..b933f592be 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPKCS1v15
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPKCS1v15
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 7b 1f 2c 33 ab  |....]...Y..{.,3.|
-00000010  6e f8 23 ca 20 a9 66 61  ac 29 00 3e ef a6 cd ee  |n.#. .fa.).>....|
-00000020  fe e7 18 b7 66 57 0d af  24 37 7a 20 e7 c8 bd 22  |....fW..$7z ..."|
-00000030  f7 ff 01 c5 ef c0 fb bd  b2 93 d9 81 df 30 96 91  |.............0..|
-00000040  0b af b5 a2 61 87 76 27  d4 bf ce 88 c0 2f 00 00  |....a.v'...../..|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 0e 33 06 1f 9d  |....]...Y...3...|
+00000010  3d 0e 59 21 38 7d 4c ea  a2 2a 2a c7 99 7b e9 bf  |=.Y!8}L..**..{..|
+00000020  61 e2 44 a1 10 5e 5d a1  e4 fd 90 20 c1 f0 1c 8e  |a.D..^].... ....|
+00000030  00 2f d9 a0 45 23 76 35  e0 01 2e 49 b8 4d b4 76  |./..E#v5...I.M.v|
+00000040  08 65 3f cd 8b dc 80 ea  fd 31 9f 47 c0 2f 00 00  |.e?......1.G./..|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -63,18 +62,18 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 2d 21 55  |............ -!U|
-000002d0  c7 73 14 c1 c8 84 91 4d  16 70 ca 47 46 4a 59 fe  |.s.....M.p.GFJY.|
-000002e0  20 d8 34 0a 78 8e a3 29  f5 40 38 d9 59 04 01 00  | .4.x..).@8.Y...|
-000002f0  80 03 9f da 00 e0 50 28  6b 29 84 9b 96 05 f1 86  |......P(k)......|
-00000300  ef f5 6d 9f 17 5f 07 f7  2d 32 af 5e 0d 72 f4 86  |..m.._..-2.^.r..|
-00000310  af 7c b9 e8 2d 80 b3 10  80 dd 61 5b e5 a7 53 5a  |.|..-.....a[..SZ|
-00000320  5e 19 47 5f f1 96 a4 ab  d8 e7 65 eb be eb bc 51  |^.G_......e....Q|
-00000330  95 6f 29 48 ac cb a7 08  3a b9 45 77 37 30 a3 83  |.o)H....:.Ew70..|
-00000340  e4 ef 58 06 0e ec a1 cf  2c 06 62 a8 1c 97 64 ac  |..X.....,.b...d.|
-00000350  c7 86 13 4c 9b 80 69 d4  89 9c 96 2c f9 20 c6 2c  |...L..i....,. .,|
-00000360  d2 11 64 ab 8d df c0 ea  1c 73 da ed 10 28 dc 90  |..d......s...(..|
-00000370  8a 16 03 03 00 0c 0d 00  00 08 01 01 00 02 04 01  |................|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 09 ce 63  |............ ..c|
+000002d0  9c 52 37 83 ef 21 78 60  eb 8b dd 22 91 fb 34 4f  |.R7..!x`..."..4O|
+000002e0  ee 04 ef 48 75 2f 49 7e  3f 0b 00 62 15 04 01 00  |...Hu/I~?..b....|
+000002f0  80 a0 11 99 d2 bc a9 fd  59 ad 38 20 bb 44 85 8e  |........Y.8 .D..|
+00000300  89 35 2e 42 ff a2 87 81  86 f5 e3 6c 9d 84 2a cf  |.5.B.......l..*.|
+00000310  0d cc 6a c0 ce 31 01 91  48 78 75 23 24 3e 3d 93  |..j..1..Hxu#$>=.|
+00000320  bf ad c9 49 9d 63 66 cd  4b cc 92 0f 6d 64 2c 80  |...I.cf.K...md,.|
+00000330  71 22 bf 6d 62 8e 8a f7  19 6f 50 2a 86 46 e4 46  |q".mb....oP*.F.F|
+00000340  71 73 df 8c 25 84 6f 28  a7 8c bd 78 01 22 a2 91  |qs..%.o(...x."..|
+00000350  f4 17 ef 88 55 9d d5 ac  42 5a 8a c8 7a 1b bf d1  |....U...BZ..z...|
+00000360  d9 6d 15 42 b9 37 16 7b  2b 3c c7 58 99 da ab 98  |.m.B.7.{+<.X....|
+00000370  f3 16 03 03 00 0c 0d 00  00 08 01 01 00 02 04 01  |................|
 00000380  00 00 16 03 03 00 04 0e  00 00 00                 |...........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
@@ -112,26 +111,26 @@
 00000200  e5 35 16 03 03 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
 00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 03 00  |......._X.;t....|
-00000230  88 0f 00 00 84 04 01 00  80 5e cb 28 a9 f4 b7 f1  |.........^.(....|
-00000240  a7 31 a5 51 4c 2d b0 c9  fb 84 0a 77 30 bc 00 72  |.1.QL-.....w0..r|
-00000250  66 65 aa 20 78 34 f1 3f  31 93 42 f7 7c 28 23 70  |fe. x4.?1.B.|(#p|
-00000260  b6 ad 2a 8f ed 70 2f a8  db ce 69 20 3e 9f 2a 6d  |..*..p/...i >.*m|
-00000270  1f 32 f8 32 7c 74 c9 2a  cd b5 c0 0d 0e 1a 32 d5  |.2.2|t.*......2.|
-00000280  ed a3 09 fb 8b ce 1d 30  52 5e ba c2 17 85 f0 c2  |.......0R^......|
-00000290  59 e6 db 0c 17 b3 2c 81  cd 1b f1 4c 92 e7 1b 6a  |Y.....,....L...j|
-000002a0  49 86 50 25 00 59 40 df  b2 fd c8 3b 9d c7 2f 57  |I.P%.Y@....;../W|
-000002b0  e1 e5 31 91 57 60 f2 b8  e5 14 03 03 00 01 01 16  |..1.W`..........|
-000002c0  03 03 00 28 00 00 00 00  00 00 00 00 07 cd 54 b1  |...(..........T.|
-000002d0  e3 78 20 90 ca 71 5e 06  f4 32 e9 02 41 60 c1 9d  |.x ..q^..2..A`..|
-000002e0  d3 c6 42 45 d8 2e fc 3d  07 9a 9d 04              |..BE...=....|
+00000230  88 0f 00 00 84 04 01 00  80 01 83 0b 8b bf a3 50  |...............P|
+00000240  03 89 e8 24 9b 9e 2e f5  7b 72 58 b1 b1 ba b2 64  |...$....{rX....d|
+00000250  9f a9 e2 b4 00 78 79 50  ec 55 18 43 e5 c4 a4 76  |.....xyP.U.C...v|
+00000260  c8 21 bc 7e e0 c4 2d 78  85 d7 33 ca d7 4d e0 f1  |.!.~..-x..3..M..|
+00000270  cd 6d bd 17 2f a0 b9 39  93 29 ba d7 09 4f bb 08  |.m../..9.)...O..|
+00000280  b0 b0 05 f1 83 de d0 db  39 f9 b4 34 a3 ca d3 76  |........9..4...v|
+00000290  97 35 f6 ea cd 53 fe bb  94 99 30 e3 a2 0a 29 1a  |.5...S....0...).|
+000002a0  5f f4 28 0e 8c 80 fc 75  84 a4 e2 3a 29 a9 50 be  |_.(....u...:).P.|
+000002b0  11 99 bb a5 12 64 5c af  5f 14 03 03 00 01 01 16  |.....d\._.......|
+000002c0  03 03 00 28 00 00 00 00  00 00 00 00 8e 51 58 0e  |...(.........QX.|
+000002d0  1a fd 8e 01 f1 6b 59 94  54 ab 00 be 45 8b 4c ae  |.....kY.T...E.L.|
+000002e0  70 c3 db 53 de 82 12 6c  cb df 32 72              |p..S...l..2r|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 75 60 b0 0a 19  |..........(u`...|
-00000010  12 ee 0f 5c c2 6a 31 f8  27 e3 53 b1 76 2b 6a 93  |...\.j1.'.S.v+j.|
-00000020  a2 37 72 74 e8 e9 c8 e7  94 56 6b d5 a3 49 09 79  |.7rt.....Vk..I.y|
-00000030  59 66 34                                          |Yf4|
+00000000  14 03 03 00 01 01 16 03  03 00 28 7b 7f 81 c9 d7  |..........({....|
+00000010  1d 3a 32 48 da 92 d6 9f  78 6e 2f d3 e9 7e 9f 12  |.:2H....xn/..~..|
+00000020  9b 0b e1 00 e8 2f 4b 63  2c 3d 94 e4 f8 1e 06 7d  |...../Kc,=.....}|
+00000030  a7 7e 6a                                          |.~j|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 70 7a 77  |.............pzw|
-00000010  14 b3 3d 3e 51 19 5e ae  97 56 bc e8 3c 1c 46 dd  |..=>Q.^..V..<.F.|
-00000020  67 e6 f5 15 03 03 00 1a  00 00 00 00 00 00 00 02  |g...............|
-00000030  50 4b b6 03 84 33 58 6a  a1 95 dc 8e ad d1 1f 8b  |PK...3Xj........|
-00000040  93 ca                                             |..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 ee 21 1b  |..............!.|
+00000010  45 15 6a 0c 79 12 4d 79  d2 26 db fc e4 da 0f e4  |E.j.y.My.&......|
+00000020  20 7e c7 15 03 03 00 1a  00 00 00 00 00 00 00 02  | ~..............|
+00000030  2a 46 62 6b 5e c3 14 56  e1 fb d0 61 f5 e8 7b 2f  |*Fbk^..V...a..{/|
+00000040  cc fd                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPSS b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPSS
index 867ec87afa..646026793f 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPSS
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPSS
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 97 c2 4c 45 c0  |....]...Y....LE.|
-00000010  22 6a 7d 71 93 1a 71 a7  e1 40 a5 44 5e 39 8a 3e  |"j}q..q..@.D^9.>|
-00000020  99 04 1f e1 74 ad 3a 64  89 ad 93 20 61 76 9a e1  |....t.:d... av..|
-00000030  39 26 af 37 ad ea f2 9c  4c 2e 1b a2 18 0c 73 8e  |9&.7....L.....s.|
-00000040  5b 8b f0 0f 44 04 80 31  5a 49 39 f0 c0 2f 00 00  |[...D..1ZI9../..|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 cd 47 5d a7 66  |....]...Y...G].f|
+00000010  aa b1 e1 bd ed 83 bd 3d  4a b7 b2 08 b8 79 08 c5  |.......=J....y..|
+00000020  22 7b 8d be fe 55 4c 2d  b5 4c b9 20 13 26 2a e6  |"{...UL-.L. .&*.|
+00000030  ab 60 4c 53 8c b7 27 c4  d5 12 ff 38 64 b1 a2 1d  |.`LS..'....8d...|
+00000040  4f a4 c7 28 53 95 01 8f  7e 4a 7b 02 c0 2f 00 00  |O..(S...~J{../..|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 66 0b  00 02 62 00 02 5f 00 02  |......f...b.._..|
 00000070  5c 30 82 02 58 30 82 01  8d a0 03 02 01 02 02 11  |\0..X0..........|
@@ -64,17 +63,17 @@
 000002a0  fa b1 3f 14 11 89 66 79  d1 8e 88 0e 0b a0 9e 30  |..?...fy.......0|
 000002b0  2a c0 67 ef ca 46 02 88  e9 53 81 22 69 22 97 ad  |*.g..F...S."i"..|
 000002c0  80 93 d4 f7 dd 70 14 24  d7 70 0a 46 a1 16 03 03  |.....p.$.p.F....|
-000002d0  00 ac 0c 00 00 a8 03 00  1d 20 ae c6 bf 84 a5 c3  |......... ......|
-000002e0  05 6b fa 30 b0 ec b7 c2  ff ec 7d e4 b8 e0 f2 0f  |.k.0......}.....|
-000002f0  3d 0e ef de 32 ad f2 6e  52 55 08 04 00 80 07 86  |=...2..nRU......|
-00000300  e1 b2 04 6e b2 43 09 df  c9 20 35 11 3b 0f 10 61  |...n.C... 5.;..a|
-00000310  7e 67 cc 65 c6 60 80 c3  43 7d b8 1c 52 e3 09 af  |~g.e.`..C}..R...|
-00000320  df 38 79 e1 ea 6d b4 6b  bc 50 fe a8 6f 46 6f 9c  |.8y..m.k.P..oFo.|
-00000330  40 1c 6f f2 e5 c6 d9 a4  db 72 24 4a 9c 57 e7 d6  |@.o......r$J.W..|
-00000340  91 91 5b 1b f1 40 f2 d9  58 a2 81 4c d7 be 20 d4  |..[..@..X..L.. .|
-00000350  12 4f 64 05 e5 ec ba 35  22 a7 fe df c9 ea b3 43  |.Od....5"......C|
-00000360  dc 47 29 98 eb c9 92 11  42 a0 80 a4 2a 2e 4d 47  |.G).....B...*.MG|
-00000370  73 9e 0f 13 37 79 92 ca  db c4 84 db 05 4a 16 03  |s...7y.......J..|
+000002d0  00 ac 0c 00 00 a8 03 00  1d 20 a8 94 95 94 cc 16  |......... ......|
+000002e0  f1 dc 11 b6 c5 52 b3 fe  95 4d 28 34 1f 2d 87 ec  |.....R...M(4.-..|
+000002f0  8d 56 51 0e 5b 92 03 f9  60 0d 08 04 00 80 09 3a  |.VQ.[...`......:|
+00000300  99 39 d8 3f 63 b4 86 12  ba ce e6 6d d6 22 aa d8  |.9.?c......m."..|
+00000310  31 60 86 eb 48 cc c0 87  97 a5 0d c7 42 86 cc f8  |1`..H.......B...|
+00000320  f7 f9 d5 1a 34 86 ec 41  02 08 99 c2 93 9b d1 b5  |....4..A........|
+00000330  57 a4 84 3c a8 93 0a c9  f7 1e a1 33 07 ca 60 c4  |W..<.......3..`.|
+00000340  4b 40 32 20 a6 22 3f 6d  4e 28 22 3b 52 70 9a 4d  |K@2 ."?mN(";Rp.M|
+00000350  fa 84 67 88 ba b5 0d 92  eb 23 94 90 00 e2 68 74  |..g......#....ht|
+00000360  5f 13 a3 d4 2d fb 24 f2  32 09 b1 e3 63 15 39 b1  |_...-.$.2...c.9.|
+00000370  9e 1e a6 61 fd 8d c6 cf  1f f7 f7 43 0c 64 16 03  |...a.......C.d..|
 00000380  03 00 0c 0d 00 00 08 01  01 00 02 08 04 00 00 16  |................|
 00000390  03 03 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
@@ -120,26 +119,26 @@
 00000270  10 00 00 21 20 2f e5 7d  a3 47 cd 62 43 15 28 da  |...! /.}.G.bC.(.|
 00000280  ac 5f bb 29 07 30 ff f6  84 af c4 cf c2 ed 90 99  |._.).0..........|
 00000290  5f 58 cb 3b 74 16 03 03  00 88 0f 00 00 84 08 04  |_X.;t...........|
-000002a0  00 80 cb ab 63 1d e6 7e  16 22 27 8b e7 91 f4 5c  |....c..~."'....\|
-000002b0  66 fc 70 eb f7 e6 9c 86  7c 62 30 1c 78 35 bf 09  |f.p.....|b0.x5..|
-000002c0  af d1 5b e3 55 45 98 8d  4c 16 8e 69 cb 8f 45 97  |..[.UE..L..i..E.|
-000002d0  6d c4 6a 25 2a 47 43 64  ac 52 12 bd f5 b9 c0 b0  |m.j%*GCd.R......|
-000002e0  51 38 e7 d4 c8 a2 9c 35  4b 5b ab 21 76 73 68 fe  |Q8.....5K[.!vsh.|
-000002f0  d0 7a f2 95 3c 44 3b 55  b0 89 76 3e 42 e1 23 51  |.z..<D;U..v>B.#Q|
-00000300  29 92 3d 6a df 29 61 ee  52 f5 78 71 97 13 d6 09  |).=j.)a.R.xq....|
-00000310  ff 08 7a 5f 9d 20 49 83  2e 84 82 ba 08 69 db ae  |..z_. I......i..|
-00000320  e2 1b 14 03 03 00 01 01  16 03 03 00 28 00 00 00  |............(...|
-00000330  00 00 00 00 00 6a ff 4b  3d c1 06 20 69 ed f0 a8  |.....j.K=.. i...|
-00000340  7c ec a7 f8 cc 8e a6 de  2d 5e 50 f7 b2 28 9e 97  ||.......-^P..(..|
-00000350  27 35 c3 67 72                                    |'5.gr|
+000002a0  00 80 86 14 3f 28 40 db  2b 02 d6 56 d3 58 d0 77  |....?(@.+..V.X.w|
+000002b0  58 f8 a3 25 1f 18 d1 9c  0a d2 56 09 32 59 34 db  |X..%......V.2Y4.|
+000002c0  d9 2e 0a bf b4 c2 0a 86  ee 6e 29 56 53 aa 82 11  |.........n)VS...|
+000002d0  96 6d 86 29 7c 85 a4 71  56 04 71 5f e6 68 3f 3f  |.m.)|..qV.q_.h??|
+000002e0  71 54 13 a2 22 b4 3e 38  fa c2 96 a4 c4 ab 83 c6  |qT..".>8........|
+000002f0  f5 ca 7a ea 2c 8d 62 4d  76 d6 db 9c f0 0e 8c 2a  |..z.,.bMv......*|
+00000300  38 2f 9d 24 34 f4 33 73  54 a2 44 9a e3 4c 1f a7  |8/.$4.3sT.D..L..|
+00000310  ca 49 16 e8 35 29 29 d1  48 95 0a 38 19 64 4c e7  |.I..5)).H..8.dL.|
+00000320  0d a5 14 03 03 00 01 01  16 03 03 00 28 00 00 00  |............(...|
+00000330  00 00 00 00 00 09 7f fa  f5 c5 e5 b1 46 7e 3d e2  |............F~=.|
+00000340  d4 51 a7 b8 ae 0a 56 a3  8c 45 40 97 d4 c5 81 4e  |.Q....V..E@....N|
+00000350  6f 12 50 b3 f6                                    |o.P..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 e3 2f c4 66 7e  |..........(./.f~|
-00000010  8f bf 41 2e 56 f3 d1 76  63 f8 c0 b1 86 50 98 a0  |..A.V..vc....P..|
-00000020  63 c0 c9 23 68 c5 7c f7  08 17 0a 62 78 a8 3d 86  |c..#h.|....bx.=.|
-00000030  5c 1a c6                                          |\..|
+00000000  14 03 03 00 01 01 16 03  03 00 28 0b 0d 27 bb 5f  |..........(..'._|
+00000010  c5 fa 62 08 8f 7a 24 65  90 bc de be 28 ae a4 e2  |..b..z$e....(...|
+00000020  1f ac 18 7a 83 3e 90 bb  76 2f 73 ec 35 ca d3 e7  |...z.>..v/s.5...|
+00000030  d8 25 7f                                          |.%.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 e9 51 91  |..............Q.|
-00000010  f5 cb 2d b9 5e cb b3 52  14 7c e8 18 8f fe b6 ee  |..-.^..R.|......|
-00000020  7a 41 90 15 03 03 00 1a  00 00 00 00 00 00 00 02  |zA..............|
-00000030  d3 5f c1 e2 f5 12 40 c0  4c 1d ab ef 16 3a af 19  |._....@.L....:..|
-00000040  30 59                                             |0Y|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 a7 07 a5  |................|
+00000010  b5 4c 26 d0 d1 6b 52 10  8f 7c 3a 4c 31 ce 74 fa  |.L&..kR..|:L1.t.|
+00000020  4a c7 9b 15 03 03 00 1a  00 00 00 00 00 00 00 02  |J...............|
+00000030  22 22 5a b9 ef 4f 05 9f  2e 1e 9c 11 e1 6c 0b 1e  |""Z..O.......l..|
+00000040  bd 10                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES
index a17b1860e3..6268dbcc7a 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 be 37 6c 0c 68  |....]...Y...7l.h|
-00000010  bd 81 e4 4e 28 fa 5d 2c  03 8d 17 7a 47 b8 de 89  |...N(.],...zG...|
-00000020  3d 06 71 dd 40 c0 70 c1  a8 3d 00 20 22 7e 4c f8  |=.q.@.p..=. "~L.|
-00000030  1c 6b 13 c4 12 46 d3 de  c4 88 2e 41 c3 d7 df 10  |.k...F.....A....|
-00000040  23 aa 30 b1 34 a5 7b c9  03 fb d8 3e c0 09 00 00  |#.0.4.{....>....|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 61 e9 cc eb 72  |....]...Y..a...r|
+00000010  7c 11 18 0e 9d 6b 72 e9  be 84 f3 92 8d 5f e6 4c  ||....kr......_.L|
+00000020  ec 9e f0 00 ca 00 6f af  90 5b de 20 29 97 82 6d  |......o..[. )..m|
+00000030  57 ac 60 59 41 1d bb 29  b1 12 a4 ac 60 18 3b 51  |W.`YA..)....`.;Q|
+00000040  af 5c e7 80 1a dc 9d 72  ed 3a 74 96 c0 09 00 00  |.\.....r.:t.....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
 00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
@@ -58,39 +57,39 @@
 00000240  8c 25 c1 33 13 83 0d 94  06 bb d4 37 7a f6 ec 7a  |.%.3.......7z..z|
 00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
 00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
-00000270  95 12 07 8f 2a 16 03 03  00 b6 0c 00 00 b2 03 00  |....*...........|
-00000280  1d 20 47 dc 78 14 d8 57  a7 37 29 1a 49 f6 07 09  |. G.x..W.7).I...|
-00000290  37 49 df 36 32 a1 e2 c9  67 e3 9c 40 ed f5 ac ea  |7I.62...g..@....|
-000002a0  c2 34 04 03 00 8a 30 81  87 02 41 14 f9 1f 8e 3d  |.4....0...A....=|
-000002b0  b6 d9 91 86 b0 b2 94 dd  14 89 47 b7 a5 2b d3 3a  |..........G..+.:|
-000002c0  b9 f8 ef 4c ae 5c 26 74  e8 c1 c5 18 f1 e5 cd 3f  |...L.\&t.......?|
-000002d0  4e 70 45 64 3b 53 14 b7  f7 86 bf d1 ee 3b cd ab  |NpEd;S.......;..|
-000002e0  cf 3a bd 12 c7 1e 89 fb  60 bf 34 be 02 42 01 7c  |.:......`.4..B.||
-000002f0  7b 7b 03 94 f9 1b 70 4c  25 3c c5 11 2c 1b e0 39  |{{....pL%<..,..9|
-00000300  6c ee d1 11 0e 73 82 97  06 c9 eb 92 44 cb 78 66  |l....s......D.xf|
-00000310  7c 9e 93 70 79 08 3e 20  90 ef 4b 9b 73 75 80 d4  ||..py.> ..K.su..|
-00000320  68 68 f0 06 b1 e8 d8 92  22 e0 07 a7 78 e7 e2 19  |hh......"...x...|
-00000330  16 03 03 00 04 0e 00 00  00                       |.........|
+00000270  95 12 07 8f 2a 16 03 03  00 b7 0c 00 00 b3 03 00  |....*...........|
+00000280  1d 20 88 7d 69 d3 1b 2d  b5 dd 4e 0a f4 98 f3 8c  |. .}i..-..N.....|
+00000290  42 d7 ee e2 7c 28 dc f2  75 ec b0 9e ca ad cb 21  |B...|(..u......!|
+000002a0  59 34 04 03 00 8b 30 81  88 02 42 01 32 2c 84 f3  |Y4....0...B.2,..|
+000002b0  d8 7c 05 58 ac d0 25 46  42 11 b4 7c 0a cb ee 83  |.|.X..%FB..|....|
+000002c0  7f 68 36 b6 be f8 d2 0a  8d d7 bc 8a 95 d8 2d b3  |.h6...........-.|
+000002d0  fa 87 56 ae 4c 01 3f bf  29 d1 81 c1 5d e9 f0 93  |..V.L.?.)...]...|
+000002e0  f6 32 91 e7 da 18 84 dd  8d a4 94 3f 81 02 42 01  |.2.........?..B.|
+000002f0  70 96 e1 3c c9 aa b8 72  8d 8e 13 68 00 50 65 9c  |p..<...r...h.Pe.|
+00000300  cf c6 1e 5f 5a d0 80 e8  8b ff 24 df a9 55 42 d9  |..._Z.....$..UB.|
+00000310  75 83 67 d7 20 69 f1 29  2d 15 f4 83 f9 ff 3d c8  |u.g. i.)-.....=.|
+00000320  0e 79 a9 3e 86 38 4a c5  a2 93 f1 47 a2 43 41 a5  |.y.>.8J....G.CA.|
+00000330  bb 16 03 03 00 04 0e 00  00 00                    |..........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
 00000030  16 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000040  00 00 00 00 00 27 23 d3  72 40 80 76 5c b6 7a fd  |.....'#.r@.v\.z.|
-00000050  bf 45 9e 33 76 d1 3d 1b  77 23 90 ed 75 7b aa 91  |.E.3v.=.w#..u{..|
-00000060  f2 8e e7 b1 bb 69 86 84  b2 b5 40 2c 4a 1d f9 cf  |.....i....@,J...|
-00000070  3e de fe 39 36                                    |>..96|
+00000040  00 00 00 00 00 84 08 13  72 05 4e a7 cb ac c1 40  |........r.N....@|
+00000050  9e 31 9c a4 8f 7f f1 41  c6 63 19 39 3d d4 27 74  |.1.....A.c.9=.'t|
+00000060  f9 5c 59 88 15 c3 e2 a7  6a 6f 6d fb 52 6f 94 36  |.\Y.....jom.Ro.6|
+00000070  1e 8d 47 50 db                                    |..GP.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 54 e0 6f 57 aa  |..........@T.oW.|
-00000010  e7 14 b0 06 69 45 42 ee  6c ce a7 0b a7 27 94 83  |....iEB.l....'..|
-00000020  cd 63 81 19 ac 06 1b 9f  78 86 5b 04 82 40 e7 41  |.c......x.[..@.A|
-00000030  f1 df 17 26 8a b4 1c f1  59 ca 43 6b 13 f8 d7 8b  |...&....Y.Ck....|
-00000040  4e ce 28 cd d2 9b ca c6  42 04 e6                 |N.(.....B..|
+00000000  14 03 03 00 01 01 16 03  03 00 40 9f 65 82 54 e1  |..........@.e.T.|
+00000010  50 68 92 33 d1 f2 a1 1d  95 81 e1 df c3 b2 4c 9b  |Ph.3..........L.|
+00000020  f4 8d ee b2 4b 43 2f e9  e3 af 60 ae d4 4c 7a 4b  |....KC/...`..LzK|
+00000030  f5 03 22 f0 11 58 de 4d  ac 46 5a bf 98 da 01 1d  |.."..X.M.FZ.....|
+00000040  fa 19 ad a6 48 66 fa c1  25 4b a0                 |....Hf..%K.|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 d7 38 5f  c6 c8 c8 c0 2e fc 08 d7  |......8_........|
-00000020  40 aa 3d 6a 90 75 2f 90  c4 33 d9 a8 50 db 57 f6  |@.=j.u/..3..P.W.|
-00000030  3e 4d 03 c8 b0 15 03 03  00 30 00 00 00 00 00 00  |>M.......0......|
-00000040  00 00 00 00 00 00 00 00  00 00 bf 0d 85 fb 60 57  |..............`W|
-00000050  02 4a 5f 95 9e 6b 00 6e  6e e6 a9 3e 6d fd 62 b9  |.J_..k.nn..>m.b.|
-00000060  79 d3 5e e2 63 cd 3b f1  a8 0d                    |y.^.c.;...|
+00000010  00 00 00 00 00 b3 26 24  39 5d 7c fc 25 23 ee fc  |......&$9]|.%#..|
+00000020  3a 6a 38 08 f5 bf 5e cc  dc 34 83 1f 5e af b0 b4  |:j8...^..4..^...|
+00000030  ee 34 fc f5 e1 15 03 03  00 30 00 00 00 00 00 00  |.4.......0......|
+00000040  00 00 00 00 00 00 00 00  00 00 84 b2 cc 06 95 78  |...............x|
+00000050  de 1d a0 cc d3 15 32 b7  89 74 8d 99 70 13 37 c3  |......2..t..p.7.|
+00000060  e2 99 6e fe 8c 2d 69 77  cc 93                    |..n..-iw..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM
index 93bdcc53b2..e235f27b75 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 a7 4e f4 80 a2  |....]...Y...N...|
-00000010  78 28 eb 69 72 3a 45 21  e6 dd 67 7c a4 64 70 97  |x(.ir:E!..g|.dp.|
-00000020  51 60 f1 e3 27 16 b2 08  54 2d 78 20 07 7c ed b5  |Q`..'...T-x .|..|
-00000030  dd aa 68 7a a6 8b 85 3d  49 be e4 78 ac 47 b1 02  |..hz...=I..x.G..|
-00000040  15 35 ea f2 db 4b 03 f3  29 f3 d1 87 c0 2b 00 00  |.5...K..)....+..|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 ac 28 cc 34 03  |....]...Y...(.4.|
+00000010  c8 91 48 22 79 a2 98 74  e4 55 df 72 6b 41 cb 40  |..H"y..t.U.rkA.@|
+00000020  58 ba 04 93 e7 f3 1c 8e  0a 19 d1 20 98 93 cb 7c  |X.......... ...||
+00000030  a3 57 a1 c7 ca 19 13 5c  e1 ac c4 44 17 30 cb a3  |.W.....\...D.0..|
+00000040  b2 83 81 90 82 1d 37 c3  71 ae b8 45 c0 2b 00 00  |......7.q..E.+..|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
 00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
@@ -59,33 +58,33 @@
 00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
 00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
 00000270  95 12 07 8f 2a 16 03 03  00 b6 0c 00 00 b2 03 00  |....*...........|
-00000280  1d 20 26 c9 de 9d 39 5a  31 f1 7c 95 e8 c4 13 8f  |. &...9Z1.|.....|
-00000290  a7 ac 82 75 12 ac 50 ad  15 41 c9 e8 92 24 1a d1  |...u..P..A...$..|
-000002a0  c8 2b 04 03 00 8a 30 81  87 02 41 15 01 bf f7 9b  |.+....0...A.....|
-000002b0  94 32 92 67 13 9a c6 f5  31 f8 42 67 a3 74 79 24  |.2.g....1.Bg.ty$|
-000002c0  55 e5 d3 f4 14 e1 3e 5e  ac 65 8c 28 48 d5 ee 05  |U.....>^.e.(H...|
-000002d0  d0 12 96 5b 8f 14 30 fa  ce e7 19 ee f0 38 86 c2  |...[..0......8..|
-000002e0  f4 32 0a 0c d9 7d 9e 40  9b 11 a4 0e 02 42 00 fb  |.2...}.@.....B..|
-000002f0  c7 0f 07 f9 87 f7 ea af  30 3a 04 e7 6a 89 3f bd  |........0:..j.?.|
-00000300  39 3f 20 0e b5 b0 aa 5f  29 ea c4 69 22 fb 38 9f  |9? ...._)..i".8.|
-00000310  35 e1 35 a6 80 86 2d eb  bc bf 01 e9 56 78 ca 21  |5.5...-.....Vx.!|
-00000320  68 a3 01 07 3c 9e 7f c2  9a 11 3d ef b7 ce 6e 02  |h...<.....=...n.|
+00000280  1d 20 40 9c d1 ec 0a 11  08 c3 fa a0 33 80 00 62  |. @.........3..b|
+00000290  5b 65 59 c6 4f 4e 32 8a  79 fc df 63 2f ee f6 59  |[eY.ON2.y..c/..Y|
+000002a0  40 4a 04 03 00 8a 30 81  87 02 41 39 af 63 7a fa  |@J....0...A9.cz.|
+000002b0  dc e3 40 85 19 9d 1b 8f  ca 55 26 e4 00 a1 f5 01  |..@......U&.....|
+000002c0  73 e6 b5 6f ab bb c3 f3  b4 e0 c2 a1 33 37 ae ec  |s..o........37..|
+000002d0  e7 90 f6 dd b4 a4 c8 f1  3c 51 67 94 c1 ee d7 f3  |........<Qg.....|
+000002e0  7c 6c 10 9d 58 bf 4b 4a  fd 66 b5 d2 02 42 00 83  ||l..X.KJ.f...B..|
+000002f0  37 10 03 0d 5a 39 63 04  cb bb 37 ab 3f 31 02 8a  |7...Z9c...7.?1..|
+00000300  1c 19 ce 62 f7 f4 15 b0  bf 43 0c ea 7c 16 43 f9  |...b.....C..|.C.|
+00000310  ca a3 b3 95 b1 8b 00 ed  9c 99 ac 74 39 8a 2e a0  |...........t9...|
+00000320  7e 07 e3 46 35 a2 26 3b  67 4f 3b 86 55 69 f1 c9  |~..F5.&;gO;.Ui..|
 00000330  16 03 03 00 04 0e 00 00  00                       |.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 32 28 d6  |....(........2(.|
-00000040  94 ba 29 2f 2b 40 56 07  0b fd a7 ce a7 79 94 b6  |..)/+@V......y..|
-00000050  f6 e4 dd eb a6 23 f3 97  8c 1f c6 a5 52           |.....#......R|
+00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 50 16 81  |....(........P..|
+00000040  fe 51 5b ac de d7 31 1b  9a 09 4f 1e d4 de a4 af  |.Q[...1...O.....|
+00000050  c9 62 5d 38 85 23 84 8c  ae 4f 55 5d 0d           |.b]8.#...OU].|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 73 67 36 43 96  |..........(sg6C.|
-00000010  59 15 59 7a dd 3c 3f d5  88 bf 55 e1 cb d0 41 10  |Y.Yz.<?...U...A.|
-00000020  df f1 85 72 9e 87 7f fd  e8 b0 62 61 41 10 42 1e  |...r......baA.B.|
-00000030  2d 34 e1                                          |-4.|
+00000000  14 03 03 00 01 01 16 03  03 00 28 d3 0d f6 53 0f  |..........(...S.|
+00000010  c8 3e f0 e6 c0 2c ed ec  bc 8f cc 19 5e 33 30 69  |.>...,......^30i|
+00000020  3c d9 55 8b e4 14 e2 0e  3a f9 89 39 fc a7 89 70  |<.U.....:..9...p|
+00000030  58 16 44                                          |X.D|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 31 23 80  |.............1#.|
-00000010  a4 01 5a f9 7c 3b fc 2f  4d 70 4e 4f 8f 69 fc 99  |..Z.|;./MpNO.i..|
-00000020  d4 7a a7 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.z..............|
-00000030  37 75 3a 5a 6c d8 5a fd  0d cf 1f 88 67 2c 48 89  |7u:Zl.Z.....g,H.|
-00000040  6c 9e                                             |l.|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 0b 26 61  |..............&a|
+00000010  e6 d8 6a 6d db c6 2d 8a  c3 8e f4 17 1a f7 8e f3  |..jm..-.........|
+00000020  ce 04 ce 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
+00000030  fa f7 0a 81 bb 8d 83 f3  82 05 ee 26 69 22 90 b2  |...........&i"..|
+00000040  bb b1                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES128-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES128-SHA256
index eed1e965d1..f81845ab3d 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES128-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES128-SHA256
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 83 27 64 12 65  |....]...Y...'d.e|
-00000010  ed df dd 5e 6c 79 e4 7b  fe fd 05 26 e0 c8 5a ca  |...^ly.{...&..Z.|
-00000020  fa 08 c2 2a 78 e1 65 33  b3 b9 82 20 01 95 06 02  |...*x.e3... ....|
-00000030  41 f4 d7 e9 64 9a a8 91  df dc 15 d0 87 02 28 7c  |A...d.........(||
-00000040  e2 75 8c 94 a3 0f 20 19  e6 e8 c4 b7 c0 23 00 00  |.u.... ......#..|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 be 62 2f ca 91  |....]...Y...b/..|
+00000010  8b 79 1d ce e3 3f 2e 37  bc 74 da c8 7d de a5 85  |.y...?.7.t..}...|
+00000020  58 c8 04 55 4e c6 51 f2  18 60 33 20 2f 33 8b c1  |X..UN.Q..`3 /3..|
+00000030  b6 be 54 3e 3f 78 12 1b  d9 d0 db 71 fa 0c ee f9  |..T>?x.....q....|
+00000040  60 fb 49 08 a1 83 a4 f6  22 e8 dc 2c c0 23 00 00  |`.I....."..,.#..|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
 00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
@@ -58,43 +57,43 @@
 00000240  8c 25 c1 33 13 83 0d 94  06 bb d4 37 7a f6 ec 7a  |.%.3.......7z..z|
 00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
 00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
-00000270  95 12 07 8f 2a 16 03 03  00 b5 0c 00 00 b1 03 00  |....*...........|
-00000280  1d 20 69 77 9a 39 8f bb  af a5 cd 5e 60 af f9 6a  |. iw.9.....^`..j|
-00000290  dc e7 2a 36 a9 bc 47 e1  fa 2d 3f a6 91 1e 6f ae  |..*6..G..-?...o.|
-000002a0  43 01 04 03 00 89 30 81  86 02 41 01 b7 fa da 05  |C.....0...A.....|
-000002b0  7c 23 3c b6 32 ea 79 ea  7c 48 62 62 c1 af 4c ff  ||#<.2.y.|Hbb..L.|
-000002c0  3f 1f e6 11 a5 8e 78 76  f6 40 d3 27 a1 24 87 90  |?.....xv.@.'.$..|
-000002d0  14 5b 66 75 31 00 0a 97  f8 98 25 af 3c 59 39 a9  |.[fu1.....%.<Y9.|
-000002e0  3a df 7b 01 ac 0b 2d 69  96 f9 89 43 02 41 6f fd  |:.{...-i...C.Ao.|
-000002f0  1f 23 6d 10 61 1e 13 27  cf 44 9e 98 46 4b d3 6c  |.#m.a..'.D..FK.l|
-00000300  d4 54 57 18 85 3d 3b 19  5e 32 9c 5f 33 96 58 0e  |.TW..=;.^2._3.X.|
-00000310  b0 b6 40 89 2b 73 bb 4c  34 74 57 01 f3 8a cb 7e  |..@.+s.L4tW....~|
-00000320  6f b2 df b4 d1 d7 1b 64  df 46 0f 96 02 fd f9 16  |o......d.F......|
-00000330  03 03 00 04 0e 00 00 00                           |........|
+00000270  95 12 07 8f 2a 16 03 03  00 b6 0c 00 00 b2 03 00  |....*...........|
+00000280  1d 20 72 d6 7b c0 ab ad  36 11 45 d6 b8 4a ea be  |. r.{...6.E..J..|
+00000290  bd ad 7a f6 29 f8 9d 0e  ac d8 fc 67 f7 9c d7 63  |..z.)......g...c|
+000002a0  32 22 04 03 00 8a 30 81  87 02 42 01 09 a3 3e 2b  |2"....0...B...>+|
+000002b0  e8 b6 0b c9 76 80 60 6f  9a c5 4c 6e 7c d8 53 00  |....v.`o..Ln|.S.|
+000002c0  56 c7 f9 37 36 32 2d dc  82 d8 0c 67 7a 96 5c 34  |V..762-....gz.\4|
+000002d0  db 10 71 4e f4 29 e0 20  84 01 09 9a dc 74 76 39  |..qN.). .....tv9|
+000002e0  63 e3 b2 c5 b4 7b cc 20  92 77 f1 3b a0 02 41 5d  |c....{. .w.;..A]|
+000002f0  36 ae 86 8c 27 7f 9e 0d  17 8e 16 48 20 2a 43 ac  |6...'......H *C.|
+00000300  d4 ce c6 9b 6a 95 47 5a  47 5c 13 b6 eb db 0b a6  |....j.GZG\......|
+00000310  fa 23 fe 0c 76 e0 a9 b2  97 76 02 ff 68 3d 68 c5  |.#..v....v..h=h.|
+00000320  17 08 54 25 1a 22 c0 a3  06 bd a3 f6 7c 68 07 9e  |..T%."......|h..|
+00000330  16 03 03 00 04 0e 00 00  00                       |.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
 00000030  16 03 03 00 50 00 00 00  00 00 00 00 00 00 00 00  |....P...........|
-00000040  00 00 00 00 00 1b 00 be  75 a8 f7 e4 b6 76 b2 7c  |........u....v.||
-00000050  30 bb 35 a2 e0 d1 ea 35  83 6d 05 6b 29 0f 4e 80  |0.5....5.m.k).N.|
-00000060  26 16 53 96 67 8e 71 ed  4a 32 1a 9f f3 8d de 34  |&.S.g.q.J2.....4|
-00000070  cb d4 b4 11 c8 7d 05 36  21 87 2b ae 33 92 d3 16  |.....}.6!.+.3...|
-00000080  1c b6 3b a3 6d                                    |..;.m|
+00000040  00 00 00 00 00 27 1a a1  cf 9d f5 8f 91 e4 7f dc  |.....'..........|
+00000050  2f 81 3f 1e 3a c3 40 21  c2 6d dd dd 8f f6 9c 4b  |/.?.:.@!.m.....K|
+00000060  0b da 8d 10 f6 83 da 35  bb b9 a4 bf 2f 29 27 a5  |.......5..../)'.|
+00000070  12 52 6a 74 6e 15 8d 82  cf 86 df f0 52 26 32 ca  |.Rjtn.......R&2.|
+00000080  02 91 8c 03 f7                                    |.....|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 50 c0 c8 04 54 26  |..........P...T&|
-00000010  72 7d 0d a5 86 d5 92 7b  09 73 02 62 37 7a 86 6f  |r}.....{.s.b7z.o|
-00000020  5b 31 1f 28 42 3c 98 2b  08 20 03 55 c0 d6 bd 62  |[1.(B<.+. .U...b|
-00000030  8b c4 18 57 f1 d8 51 ef  f1 93 6b 70 af 72 95 06  |...W..Q...kp.r..|
-00000040  77 91 b5 37 b3 31 73 a4  a3 fb bb 63 9d 41 45 30  |w..7.1s....c.AE0|
-00000050  b4 07 43 8a 74 44 83 16  50 22 a0                 |..C.tD..P".|
+00000000  14 03 03 00 01 01 16 03  03 00 50 1f 1c 35 9b 6c  |..........P..5.l|
+00000010  a8 9f 58 0d bf 0f db b5  91 c6 74 de b1 b7 68 b6  |..X.......t...h.|
+00000020  05 0d 39 68 87 7d b3 b0  8b 86 15 67 ba 7e 54 0c  |..9h.}.....g.~T.|
+00000030  0d 4f 6e f3 ad d8 27 e8  1d fa 43 31 be 30 67 d2  |.On...'...C1.0g.|
+00000040  bc 0a 30 37 78 3e 30 62  bf 81 2e 53 da b3 88 73  |..07x>0b...S...s|
+00000050  17 42 79 ee ef 0e d3 3c  87 c8 85                 |.By....<...|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000010  00 00 00 00 00 ba c5 0e  9d f6 a1 64 f9 13 fa aa  |...........d....|
-00000020  07 1f cb d1 b6 f3 42 11  ac 2e aa 08 a4 f6 67 9e  |......B.......g.|
-00000030  1d d9 35 6a 70 85 24 25  aa b0 f3 13 87 fd 9e d5  |..5jp.$%........|
-00000040  69 60 88 bc 5c 15 03 03  00 40 00 00 00 00 00 00  |i`..\....@......|
-00000050  00 00 00 00 00 00 00 00  00 00 41 86 ed 8a 40 26  |..........A...@&|
-00000060  39 b4 bf 47 01 bf a9 9c  df 12 07 f0 dc 64 2f 5b  |9..G.........d/[|
-00000070  1e 44 94 78 85 b7 d8 92  f1 d4 d6 a7 d2 39 b5 3f  |.D.x.........9.?|
-00000080  f9 e0 78 d6 40 61 c9 4e  b0 32                    |..x.@a.N.2|
+00000010  00 00 00 00 00 2c 39 43  06 0a c3 81 10 24 e8 bb  |.....,9C.....$..|
+00000020  de b8 74 00 a9 a3 ab 9a  2a a7 8a 0e 62 b8 2a 23  |..t.....*...b.*#|
+00000030  10 46 1b 76 dc a7 81 2d  37 2e e8 5f b5 75 5e 65  |.F.v...-7.._.u^e|
+00000040  73 11 ef 71 16 15 03 03  00 40 00 00 00 00 00 00  |s..q.....@......|
+00000050  00 00 00 00 00 00 00 00  00 00 a5 24 00 67 c6 ae  |...........$.g..|
+00000060  7f 05 91 ab 17 c9 ea eb  5a f8 8f 07 f3 e5 9b 9c  |........Z.......|
+00000070  20 41 63 21 69 3e f1 bb  66 7e 0b 3d c0 0a 14 b1  | Ac!i>..f~.=....|
+00000080  a3 de 2e d9 10 23 37 84  4d 88                    |.....#7.M.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384 b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384
index 2a1b29189c..bf3f019260 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 77 69 ed c9 15  |....]...Y..wi...|
-00000010  48 74 3a b5 29 8b 17 d7  88 88 33 ac 7d 5e b2 c1  |Ht:.).....3.}^..|
-00000020  73 a8 e2 4c 5e 66 a6 07  54 57 0e 20 9f b9 f0 03  |s..L^f..TW. ....|
-00000030  74 51 4a bc 23 0b 4c 6d  e3 09 8a d9 1f 09 68 33  |tQJ.#.Lm......h3|
-00000040  d7 13 a7 7a 8e 34 73 73  97 32 a6 02 c0 2c 00 00  |...z.4ss.2...,..|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 45 43 2c 7b 07  |....]...Y..EC,{.|
+00000010  6e 76 10 6b f3 9c 7c 2e  b8 c9 6b 8d a0 b6 7b be  |nv.k..|...k...{.|
+00000020  79 7a 52 ab 8d f8 c6 cb  00 f6 48 20 a3 a7 3c ca  |yzR.......H ..<.|
+00000030  d7 57 be c7 6e 45 d6 75  c1 70 e0 86 1e 58 14 a3  |.W..nE.u.p...X..|
+00000040  b4 7d 78 2c ca 82 2f 38  b8 96 ef c4 c0 2c 00 00  |.}x,../8.....,..|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
 00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
@@ -58,34 +57,34 @@
 00000240  8c 25 c1 33 13 83 0d 94  06 bb d4 37 7a f6 ec 7a  |.%.3.......7z..z|
 00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
 00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
-00000270  95 12 07 8f 2a 16 03 03  00 b6 0c 00 00 b2 03 00  |....*...........|
-00000280  1d 20 a4 6e f2 07 14 a1  e4 02 87 6c 49 4e bf 77  |. .n.......lIN.w|
-00000290  c0 d9 85 13 9a 65 b7 a7  27 d7 1c 34 c4 91 bc fb  |.....e..'..4....|
-000002a0  ef 31 04 03 00 8a 30 81  87 02 42 00 8f a1 f7 fa  |.1....0...B.....|
-000002b0  18 35 a7 14 ed 02 80 4d  12 bd 07 91 5c b1 e0 8f  |.5.....M....\...|
-000002c0  c8 74 e9 37 04 56 96 8a  f3 57 42 a0 53 18 45 ad  |.t.7.V...WB.S.E.|
-000002d0  1d 90 27 fb 75 f8 d2 df  e2 e7 ad b5 98 f1 b2 88  |..'.u...........|
-000002e0  d9 e0 9d 46 fb 53 6d 5a  95 31 75 a4 1e 02 41 3f  |...F.SmZ.1u...A?|
-000002f0  63 12 d6 e0 8a 92 81 7d  93 fe f6 98 5a a7 75 13  |c......}....Z.u.|
-00000300  be 4e 31 8c b0 ee a7 41  82 fe b4 05 01 69 7f 61  |.N1....A.....i.a|
-00000310  65 41 d3 9e 59 37 03 e9  e0 4b 18 88 a5 67 d2 c1  |eA..Y7...K...g..|
-00000320  83 22 3a 09 88 c0 6e b7  e5 a4 c3 e8 ce d9 3c cc  |.":...n.......<.|
-00000330  16 03 03 00 04 0e 00 00  00                       |.........|
+00000270  95 12 07 8f 2a 16 03 03  00 b5 0c 00 00 b1 03 00  |....*...........|
+00000280  1d 20 2c 21 c0 1d 0f 62  0d 25 60 02 a2 5f 10 5b  |. ,!...b.%`.._.[|
+00000290  68 fb b8 74 a5 2f 33 d6  1e 3f 05 43 19 6d 1c 74  |h..t./3..?.C.m.t|
+000002a0  ce 5b 04 03 00 89 30 81  86 02 41 4c 6b 04 c2 3f  |.[....0...ALk..?|
+000002b0  98 87 0d 54 5a d5 1f 4c  77 1b b6 e5 f8 1f 35 29  |...TZ..Lw.....5)|
+000002c0  e9 72 13 34 ba f8 f9 b3  0f 49 ed b5 69 bd 03 3e  |.r.4.....I..i..>|
+000002d0  10 7d a5 0f 7a aa a6 c5  e0 48 24 2a 61 85 17 5d  |.}..z....H$*a..]|
+000002e0  ac 93 35 47 41 60 f6 3b  d6 41 32 20 02 41 02 4b  |..5GA`.;.A2 .A.K|
+000002f0  b7 28 37 9d 5d f3 fe 87  7b 13 9a 71 b0 59 7b f0  |.(7.]...{..q.Y{.|
+00000300  50 e2 87 aa 9a ef 0e e8  47 bd 85 60 d5 41 32 00  |P.......G..`.A2.|
+00000310  aa 26 e4 f3 c9 4c 9d df  6c dc 6a de 2b fc 76 b2  |.&...L..l.j.+.v.|
+00000320  99 28 41 1c d3 04 a2 e0  71 92 41 97 0a b3 4b 16  |.(A.....q.A...K.|
+00000330  03 03 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 dd 37 75  |....(.........7u|
-00000040  d9 75 19 9e aa 4b dd 1e  c7 af 7f 26 e2 72 30 92  |.u...K.....&.r0.|
-00000050  70 68 97 ce 03 e3 a2 99  9a 85 1a c8 09           |ph...........|
+00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 5a b1 f1  |....(........Z..|
+00000040  5a c2 32 50 dd 2b 6c 8a  0b de b7 04 cd 69 de 3a  |Z.2P.+l......i.:|
+00000050  45 3c 72 94 80 e2 f6 6c  66 98 c3 2d 4d           |E<r....lf..-M|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 f2 ba 40 ec e3  |..........(..@..|
-00000010  77 30 c8 b1 b3 3f 97 f1  28 3b 59 26 2c a0 d3 19  |w0...?..(;Y&,...|
-00000020  4a bd d3 f1 5d e3 6c 62  56 ee 75 75 05 05 3c 1c  |J...].lbV.uu..<.|
-00000030  17 98 0a                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 28 be d2 0b b0 a2  |..........(.....|
+00000010  ac 18 1e dc 59 4f b4 85  be 3a 81 bd 73 51 47 35  |....YO...:..sQG5|
+00000020  b3 2b b2 84 45 3a 08 11  a3 40 13 0e 5d ef 4b 26  |.+..E:...@..].K&|
+00000030  9d e6 83                                          |...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 0b bc a8  |................|
-00000010  12 42 1b c7 8e a4 e9 26  65 4d 89 d6 e1 f0 33 67  |.B.....&eM....3g|
-00000020  5a 29 8c 15 03 03 00 1a  00 00 00 00 00 00 00 02  |Z)..............|
-00000030  42 d5 85 47 7f 6e b0 ad  23 13 74 44 84 75 4b 85  |B..G.n..#.tD.uK.|
-00000040  22 3a                                             |":|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 0f 8d 3a  |...............:|
+00000010  5b dd b2 49 18 84 73 e7  a5 c0 46 c0 ad fa cc 44  |[..I..s...F....D|
+00000020  60 0d 8c 15 03 03 00 1a  00 00 00 00 00 00 00 02  |`...............|
+00000030  f6 4c c6 95 ff e5 01 3a  3b a9 46 23 f3 bc 24 29  |.L.....:;.F#..$)|
+00000040  6d 52                                             |mR|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-CHACHA20-POLY1305 b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-CHACHA20-POLY1305
index 3cea374342..db53e96a01 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-CHACHA20-POLY1305
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-CHACHA20-POLY1305
@@ -1,26 +1,26 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 f2 01 00 00  ee 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 ee 01 00 00  ea 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 00 08 cc a9  |................|
-00000050  13 03 13 01 13 02 01 00  00 9d 00 0b 00 02 01 00  |................|
+00000050  13 03 13 01 13 02 01 00  00 99 00 0b 00 02 01 00  |................|
 00000060  ff 01 00 01 00 00 17 00  00 00 12 00 00 00 05 00  |................|
 00000070  05 01 00 00 00 00 00 0a  00 0a 00 08 00 1d 00 17  |................|
-00000080  00 18 00 19 00 0d 00 1a  00 18 08 04 04 03 08 07  |................|
-00000090  08 05 08 06 04 01 05 01  06 01 05 03 06 03 02 01  |................|
-000000a0  02 03 00 32 00 1a 00 18  08 04 04 03 08 07 08 05  |...2............|
-000000b0  08 06 04 01 05 01 06 01  05 03 06 03 02 01 02 03  |................|
-000000c0  00 2b 00 09 08 03 04 03  03 03 02 03 01 00 33 00  |.+............3.|
-000000d0  26 00 24 00 1d 00 20 2f  e5 7d a3 47 cd 62 43 15  |&.$... /.}.G.bC.|
-000000e0  28 da ac 5f bb 29 07 30  ff f6 84 af c4 cf c2 ed  |(.._.).0........|
-000000f0  90 99 5f 58 cb 3b 74                              |.._X.;t|
+00000080  00 18 00 19 00 0d 00 16  00 14 08 04 04 03 08 07  |................|
+00000090  08 05 08 06 04 01 05 01  06 01 05 03 06 03 00 32  |...............2|
+000000a0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000b0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
+000000c0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000d0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000e0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+000000f0  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 32 3b b0 38 26  |....]...Y..2;.8&|
-00000010  a2 4b 38 02 83 42 af 10  77 e7 6b a9 d6 e7 ac c8  |.K8..B..w.k.....|
-00000020  69 ba 70 cb f8 de 6d 28  a9 b5 40 20 9f f0 a4 35  |i.p...m(..@ ...5|
-00000030  3e eb cf 99 5a 69 6c 0c  9d 45 21 ca fe e7 03 52  |>...Zil..E!....R|
-00000040  39 66 c5 90 1f 75 57 9d  03 51 3b 21 cc a9 00 00  |9f...uW..Q;!....|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 74 9e c0 76 74  |....]...Y..t..vt|
+00000010  c1 54 da a1 cf ad 75 4c  fe 91 3b e2 06 e9 fb 1a  |.T....uL..;.....|
+00000020  9c 69 ee bf 30 1f 5c 0c  92 ca 58 20 a9 bb 64 3d  |.i..0.\...X ..d=|
+00000030  1e 8a 19 db 31 25 15 f2  65 5a 78 ad 7e d2 98 90  |....1%..eZx.~...|
+00000040  8a 8b 0f 0e 77 53 db a2  93 b4 76 6d cc a9 00 00  |....wS....vm....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
 00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
@@ -55,32 +55,32 @@
 00000240  8c 25 c1 33 13 83 0d 94  06 bb d4 37 7a f6 ec 7a  |.%.3.......7z..z|
 00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
 00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
-00000270  95 12 07 8f 2a 16 03 03  00 b7 0c 00 00 b3 03 00  |....*...........|
-00000280  1d 20 b4 e4 ee 96 88 73  de d8 bc 4f 90 ca fa df  |. .....s...O....|
-00000290  26 b4 88 19 04 0e d1 be  0f 3c bb 23 68 0e a6 20  |&........<.#h.. |
-000002a0  39 17 04 03 00 8b 30 81  88 02 42 00 c7 4a 60 ba  |9.....0...B..J`.|
-000002b0  7d 8f 8a 69 93 dc 5b 9d  ce a1 33 82 ed 95 00 fb  |}..i..[...3.....|
-000002c0  96 6b 31 d9 3a 10 80 fd  03 5f d2 63 40 e1 26 75  |.k1.:...._.c@.&u|
-000002d0  d3 bd d7 4e 79 c7 1a 82  c2 3b ef e0 72 c2 a6 d3  |...Ny....;..r...|
-000002e0  28 bb d4 49 46 39 8d bd  03 9d a8 98 8b 02 42 01  |(..IF9........B.|
-000002f0  d2 51 90 9c 41 a2 51 24  8f 2e 4a 24 31 69 91 d0  |.Q..A.Q$..J$1i..|
-00000300  c3 39 0b f6 55 3e e7 b0  43 36 99 50 dd c6 45 9a  |.9..U>..C6.P..E.|
-00000310  a7 e3 c0 65 c9 b5 02 85  f6 f1 55 b2 f6 f9 8e 30  |...e......U....0|
-00000320  3b 2a 3d 8a 5c 51 31 5d  9a 3f 9d e5 63 a9 4e ba  |;*=.\Q1].?..c.N.|
-00000330  fe 16 03 03 00 04 0e 00  00 00                    |..........|
+00000270  95 12 07 8f 2a 16 03 03  00 b6 0c 00 00 b2 03 00  |....*...........|
+00000280  1d 20 6b 7f 5e 5e cd 37  8e 2a cf 07 bf 99 89 93  |. k.^^.7.*......|
+00000290  05 be e6 3c 1d a8 67 07  b4 0d 28 22 be 3f 57 88  |...<..g...(".?W.|
+000002a0  e4 41 04 03 00 8a 30 81  87 02 42 00 ce 0f 5f f7  |.A....0...B..._.|
+000002b0  52 8c 44 e3 58 4c ed 4a  4f bf 2d 14 77 0f 3c a7  |R.D.XL.JO.-.w.<.|
+000002c0  8a 7b fc 2d 0f 94 6e 51  01 51 e0 8c 58 b0 72 e4  |.{.-..nQ.Q..X.r.|
+000002d0  57 cd ab ad fd a9 8c c2  e7 92 f3 0e e0 a0 22 64  |W............."d|
+000002e0  a0 36 f9 e1 a3 f5 19 c8  8a b8 25 f6 0b 02 41 5d  |.6........%...A]|
+000002f0  d3 7c a0 42 5b f9 5d b8  f9 c2 a3 d4 8f 0e 4c c7  |.|.B[.].......L.|
+00000300  d4 61 11 73 f0 35 7e b1  73 29 0f 97 52 75 8a 1f  |.a.s.5~.s)..Ru..|
+00000310  00 e9 6e 59 25 bb ca 72  bd 1e 4f 34 fc 55 ef 66  |..nY%..r..O4.U.f|
+00000320  33 3d 5f fc e2 8d ac 09  7f 20 85 ca b3 a4 b3 ca  |3=_...... ......|
+00000330  16 03 03 00 04 0e 00 00  00                       |.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 ae 4e 75  d9 a7 be a2 6c 68 b0 19  |.... .Nu....lh..|
-00000040  b6 ef dd 90 f6 6b 27 ce  52 23 66 56 54 4a e0 b7  |.....k'.R#fVTJ..|
-00000050  d8 77 fc be 32                                    |.w..2|
+00000030  16 03 03 00 20 1a fc 19  6c ef eb a5 d1 28 d9 aa  |.... ...l....(..|
+00000040  56 3f b7 12 a0 18 eb 76  16 be 6d 1e d9 3b 6f 14  |V?.....v..m..;o.|
+00000050  51 68 9c 63 b3                                    |Qh.c.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 b5 41 67 54 66  |.......... .AgTf|
-00000010  94 8b 39 45 fb aa 66 f7  01 4b 4d d3 55 03 56 b3  |..9E..f..KM.U.V.|
-00000020  2b 08 ca bb 29 f5 0c 6b  12 8d 76                 |+...)..k..v|
+00000000  14 03 03 00 01 01 16 03  03 00 20 38 c9 5f c3 6f  |.......... 8._.o|
+00000010  1b 84 54 77 40 98 70 cb  f1 d1 5f 9e 11 16 24 c6  |..Tw@.p..._...$.|
+00000020  c4 7e f0 44 32 2c ce 29  dd 8e 20                 |.~.D2,.).. |
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 7b 7f a6  ce de 59 a8 56 2f 1b a0  |.....{....Y.V/..|
-00000010  30 39 9d 87 41 3e bf 7c  af 5d f8 15 03 03 00 12  |09..A>.|.]......|
-00000020  47 4e 8a e8 c7 b7 5e d2  0d 57 f5 7d 85 91 08 f6  |GN....^..W.}....|
-00000030  57 b9                                             |W.|
+00000000  17 03 03 00 16 86 12 a2  e2 ae df 03 ed e4 a4 74  |...............t|
+00000010  d0 8b 8c 17 92 20 4d bd  c2 29 ac 15 03 03 00 12  |..... M..)......|
+00000020  e1 66 4e 21 16 24 34 9f  0f 95 63 80 d6 22 52 c4  |.fN!.$4...c.."R.|
+00000030  67 ac                                             |g.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES
index 2e8cf680f7..70b43803f1 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 aa fb 37 3d 67  |....]...Y....7=g|
-00000010  95 94 f7 8e 74 8b 21 20  8b 63 e3 61 7f 00 53 e7  |....t.! .c.a..S.|
-00000020  cc 9e b4 72 3e ae e5 36  93 b8 17 20 be 6d 69 ec  |...r>..6... .mi.|
-00000030  ba 51 86 16 80 1e e5 dc  59 d2 6f d5 c0 28 0c bd  |.Q......Y.o..(..|
-00000040  98 3b 5f 7b 70 36 ce 40  cd 37 23 98 c0 13 00 00  |.;_{p6.@.7#.....|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 c7 61 5d 9b a7  |....]...Y...a]..|
+00000010  9f 27 4f de 56 2b 83 b8  dc 21 7d 27 e5 23 c0 b4  |.'O.V+...!}'.#..|
+00000020  a7 b1 61 3c 7c b7 af 1a  b0 c6 ed 20 82 8c 08 27  |..a<|...... ...'|
+00000030  79 99 c6 a7 dd 7e 33 bb  6c d0 4b 4a 02 e7 2e 87  |y....~3.l.KJ....|
+00000040  69 24 05 ac 32 6f 40 4f  dc 2e 11 3f c0 13 00 00  |i$..2o@O...?....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -63,38 +62,38 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 67 97 c9  |............ g..|
-000002d0  92 1a a5 f1 e1 9b 81 36  74 0a 00 b1 f9 78 a3 0e  |.......6t....x..|
-000002e0  a1 44 98 69 92 ac cd 03  3e 94 a1 ee 1c 08 04 00  |.D.i....>.......|
-000002f0  80 93 2b a2 28 51 d1 7d  2e 07 e2 07 07 5b 3f 56  |..+.(Q.}.....[?V|
-00000300  1a 17 4a 70 6b 74 ac a2  12 02 f9 3d ec 85 b1 df  |..Jpkt.....=....|
-00000310  5a 17 a2 79 9b bb 40 4a  2f 27 a5 c1 71 7f 70 25  |Z..y..@J/'..q.p%|
-00000320  a1 72 c5 20 86 3a a2 1e  0c 53 a0 2e 76 7f 5f 5a  |.r. .:...S..v._Z|
-00000330  00 55 6b 9d 0b 5e 3a c7  8e 25 97 fb d5 a4 ea 68  |.Uk..^:..%.....h|
-00000340  79 9c 29 34 e5 6f 44 07  8b a7 7a 9c 31 c5 34 08  |y.)4.oD...z.1.4.|
-00000350  31 8d 5e 9f 0f cb 42 ae  e7 66 59 41 62 37 25 f6  |1.^...B..fYAb7%.|
-00000360  09 42 10 11 9e 19 08 6b  56 43 ae 05 ac 1c a4 24  |.B.....kVC.....$|
-00000370  f5 16 03 03 00 04 0e 00  00 00                    |..........|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 5c ce 07  |............ \..|
+000002d0  a8 0b 8f ff 08 19 e7 d7  38 62 98 bf c1 f7 92 27  |........8b.....'|
+000002e0  cb 7b 5e 50 36 51 83 61  8d b4 d6 29 1c 08 04 00  |.{^P6Q.a...)....|
+000002f0  80 98 88 66 48 81 8b 9d  9b e0 6e 6e c4 c4 99 fb  |...fH.....nn....|
+00000300  63 46 fd 8c 7e e1 d0 dd  01 e6 bb 23 97 b8 21 2e  |cF..~......#..!.|
+00000310  53 06 e0 5d 58 c8 79 c3  01 a5 01 e2 81 7b c7 a9  |S..]X.y......{..|
+00000320  04 15 98 9b 53 98 42 0b  3d 4e 97 93 b9 88 80 2c  |....S.B.=N.....,|
+00000330  78 fd 9b 99 12 7f a8 de  a0 c0 c4 1d 15 59 d4 d8  |x............Y..|
+00000340  ef 0d bd 0b 46 c3 6e e6  4b 04 69 91 c0 db 74 ca  |....F.n.K.i...t.|
+00000350  99 2e 6f 47 8b 9b 22 3f  b3 4a e3 10 47 2d dd 47  |..oG.."?.J..G-.G|
+00000360  d5 e1 9b 66 8f d9 b2 fb  b7 52 ae 6a 14 74 32 2d  |...f.....R.j.t2-|
+00000370  6e 16 03 03 00 04 0e 00  00 00                    |n.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
 00000030  16 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000040  00 00 00 00 00 fc 6b 1b  7e 07 14 39 83 00 01 20  |......k.~..9... |
-00000050  ca 14 c9 c8 03 6e cb 3c  05 b8 63 c3 37 a1 63 c9  |.....n.<..c.7.c.|
-00000060  9b a1 94 01 de 61 0c 7f  ae 92 95 4d 31 6b e8 5e  |.....a.....M1k.^|
-00000070  bb 73 3f 3b a5                                    |.s?;.|
+00000040  00 00 00 00 00 99 c9 2d  35 8b 96 18 36 f4 db a4  |.......-5...6...|
+00000050  9a 56 67 6a 6b 9d ee b1  cb 95 54 43 93 7c 0e ff  |.Vgjk.....TC.|..|
+00000060  c0 54 84 83 14 bf d5 95  85 a1 b5 c5 2c fe c3 29  |.T..........,..)|
+00000070  81 7b 1e 16 2e                                    |.{...|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 e4 fe 65 a6 8e  |..........@..e..|
-00000010  05 32 44 9d 56 27 03 e2  da 79 c9 fd 52 76 2e bb  |.2D.V'...y..Rv..|
-00000020  37 9f 40 59 ba de ba 56  82 a1 b4 39 29 b0 29 af  |7.@Y...V...9).).|
-00000030  96 42 9e f8 c4 e7 cf 72  1c 2c c8 c7 cb ba cd 82  |.B.....r.,......|
-00000040  bf 21 17 07 6b 39 2c 0a  17 0b 74                 |.!..k9,...t|
+00000000  14 03 03 00 01 01 16 03  03 00 40 8b 6e b0 cb bf  |..........@.n...|
+00000010  35 8d c3 7e 48 27 92 77  20 8a 38 c6 81 94 17 d4  |5..~H'.w .8.....|
+00000020  b8 18 4e 23 e7 8b 0a 89  7b d1 72 58 aa b9 9b bb  |..N#....{.rX....|
+00000030  c9 40 c7 c4 8e 74 77 f3  3e 90 9c b0 19 04 6c ea  |.@...tw.>.....l.|
+00000040  87 85 f1 fd d9 fd 2d 57  57 f1 c9                 |......-WW..|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 e4 be e7  a6 e6 3c 1e ca 47 07 07  |..........<..G..|
-00000020  98 a3 4d 13 6d ac 75 57  45 de 8e fc ca 02 c8 b6  |..M.m.uWE.......|
-00000030  00 fc 7f e0 50 15 03 03  00 30 00 00 00 00 00 00  |....P....0......|
-00000040  00 00 00 00 00 00 00 00  00 00 84 c2 3c b7 11 8c  |............<...|
-00000050  d2 65 43 4d aa 28 0c 7f  5f 73 9c cf 43 fe 72 d1  |.eCM.(.._s..C.r.|
-00000060  87 86 9b c8 1b 04 13 a7  44 5c                    |........D\|
+00000010  00 00 00 00 00 b9 8c 86  6d 84 db d0 60 f7 11 22  |........m...`.."|
+00000020  97 52 b3 fe bb 1c 0c bd  26 9c a1 84 51 3d a2 2b  |.R......&...Q=.+|
+00000030  c0 79 e5 a5 96 15 03 03  00 30 00 00 00 00 00 00  |.y.......0......|
+00000040  00 00 00 00 00 00 00 00  00 00 7a 42 27 d5 ae 30  |..........zB'..0|
+00000050  81 b5 94 05 55 c9 93 e0  11 98 6d f8 aa 18 92 f4  |....U.....m.....|
+00000060  32 8f d1 aa a6 86 cd df  11 c2                    |2.........|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256
index ccfa718fc6..9081031e73 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 81 ab 9b 85 bf  |....]...Y.......|
-00000010  f2 7f b2 d1 38 37 f5 dd  42 34 b6 69 e9 25 48 1c  |....87..B4.i.%H.|
-00000020  65 59 3b 6a 04 17 05 49  87 42 87 20 6a da fc 8d  |eY;j...I.B. j...|
-00000030  38 a9 cd 09 65 ac f1 9c  d6 ee ab 74 ad 96 df a0  |8...e......t....|
-00000040  87 98 23 29 79 78 0b c3  8f af ea 3c c0 27 00 00  |..#)yx.....<.'..|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 7b 18 cc 97 f2  |....]...Y..{....|
+00000010  59 62 62 18 bc ee e1 09  0c 7b 8c 3e f0 36 3d 8b  |Ybb......{.>.6=.|
+00000020  96 54 26 93 c8 ac bb 7c  19 63 6a 20 96 8e 51 d2  |.T&....|.cj ..Q.|
+00000030  18 6d 8a 72 6b 5d d2 5e  2b 53 4e a5 43 cf 75 4f  |.m.rk].^+SN.C.uO|
+00000040  e6 9c 3a 30 f5 23 3f bf  66 bc fe a2 c0 27 00 00  |..:0.#?.f....'..|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -63,42 +62,42 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 88 0b 7c  |............ ..||
-000002d0  04 c5 e3 0b 1c aa 4b 4c  0a 3a 5c 67 a5 ac 01 be  |......KL.:\g....|
-000002e0  32 77 9e 69 dc ae 64 0e  c7 4c 34 7d 74 08 04 00  |2w.i..d..L4}t...|
-000002f0  80 b7 0e 09 2f 58 46 d2  7e 19 ca d3 34 31 ac 86  |..../XF.~...41..|
-00000300  94 b3 18 56 e0 b0 75 88  ed d2 5c d2 d6 80 18 30  |...V..u...\....0|
-00000310  28 75 16 eb fb ee b6 ce  13 ed f2 75 7c b5 0d a8  |(u.........u|...|
-00000320  04 33 95 aa 2b c0 21 db  8a a8 cc 9b fe eb 55 32  |.3..+.!.......U2|
-00000330  04 22 e6 02 83 ca b1 c0  1d 14 7f 8c 44 de ce c7  |."..........D...|
-00000340  6a 60 73 1f 96 c3 62 7d  9d 36 cc f9 c1 a8 12 cb  |j`s...b}.6......|
-00000350  ea 93 36 db 8c 15 29 a1  03 3a 4f 82 13 52 f8 de  |..6...)..:O..R..|
-00000360  6f 80 b6 9d ad e8 ea 04  03 0d a5 63 74 e9 bf 2f  |o..........ct../|
-00000370  5f 16 03 03 00 04 0e 00  00 00                    |_.........|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 e4 05 36  |............ ..6|
+000002d0  05 47 cf b0 62 f8 f6 d6  e0 ce a5 f9 45 f6 28 f9  |.G..b.......E.(.|
+000002e0  d2 58 47 6c 0a 58 9d 85  74 52 d3 0d 17 08 04 00  |.XGl.X..tR......|
+000002f0  80 d0 8b 12 95 dd 2a 7f  b2 55 33 e0 13 28 41 47  |......*..U3..(AG|
+00000300  06 38 fe fb 11 b3 3f 66  c4 62 db 1c f9 29 9e ea  |.8....?f.b...)..|
+00000310  2f e4 62 22 4f 99 36 05  fb 89 8f d5 29 bf a6 e0  |/.b"O.6.....)...|
+00000320  fc 12 88 d8 60 9a 4d 82  eb 64 ba 99 1c 1c 82 ff  |....`.M..d......|
+00000330  df 57 a9 b9 14 d5 a7 ad  57 45 1d e0 91 db 61 90  |.W......WE....a.|
+00000340  ca 15 9b 0c 49 f8 a9 40  5f 34 6b d2 fe 00 48 e5  |....I..@_4k...H.|
+00000350  ea 1e 3b ae 1f 81 a9 d7  91 ff 46 e9 af 48 04 b3  |..;.......F..H..|
+00000360  83 0c 95 91 ea 5f 1f 5b  48 98 2a 9c f6 80 2a db  |....._.[H.*...*.|
+00000370  d2 16 03 03 00 04 0e 00  00 00                    |..........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
 00000030  16 03 03 00 50 00 00 00  00 00 00 00 00 00 00 00  |....P...........|
-00000040  00 00 00 00 00 f3 03 08  16 9c 4f c9 0e 8c 2a 74  |..........O...*t|
-00000050  4f d4 8a 84 50 fa 16 da  5e 76 d5 80 26 40 6a 55  |O...P...^v..&@jU|
-00000060  75 16 4c 28 58 09 c9 88  fd af 93 f2 94 46 3d 1b  |u.L(X........F=.|
-00000070  6c 04 af af b4 c1 14 c7  76 5e 10 64 4e 61 19 a9  |l.......v^.dNa..|
-00000080  c8 94 aa 7b fc                                    |...{.|
+00000040  00 00 00 00 00 c0 4e 63  30 1d 23 c8 dc ef 03 e9  |......Nc0.#.....|
+00000050  29 7c 61 b8 7a a4 52 c3  09 f4 aa 97 30 3c 5a 7c  |)|a.z.R.....0<Z||
+00000060  28 d4 83 77 0d 5d 74 92  82 92 a1 e3 df 37 1d d0  |(..w.]t......7..|
+00000070  01 c1 c0 6e 83 04 4b c9  18 9b f0 92 93 2c 69 ee  |...n..K......,i.|
+00000080  60 54 ec 0b ae                                    |`T...|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 50 9f 93 29 9e ce  |..........P..)..|
-00000010  ec cb 1f 2e 0a 4b a9 cf  2a 18 2c 6a 4e b6 4f e5  |.....K..*.,jN.O.|
-00000020  e1 15 c5 fc 8b 07 31 c1  88 ea 34 dd 14 c8 e0 e3  |......1...4.....|
-00000030  da 9e cf 42 5e 6b d9 3f  a7 00 e7 37 b0 2f cb fb  |...B^k.?...7./..|
-00000040  bb 80 4b c8 e0 00 47 af  04 26 7d e4 c0 71 0a c9  |..K...G..&}..q..|
-00000050  73 d4 35 99 e9 d8 06 c3  6f 09 69                 |s.5.....o.i|
+00000000  14 03 03 00 01 01 16 03  03 00 50 bd 21 3f c1 94  |..........P.!?..|
+00000010  2f 3e 00 3c 43 00 17 39  90 74 b2 4f 40 5d 0c 2b  |/>.<C..9.t.O@].+|
+00000020  00 09 8b fc df 5b eb 15  8b 4a 5a 5c b3 a4 e8 9f  |.....[...JZ\....|
+00000030  ce b1 e9 17 c3 8c 09 77  e2 5a 36 44 5d 38 ce f8  |.......w.Z6D]8..|
+00000040  4a c8 65 07 da 01 96 92  40 04 71 51 69 de d9 47  |J.e.....@.qQi..G|
+00000050  ae c8 99 15 41 14 18 43  9e a9 9f                 |....A..C...|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000010  00 00 00 00 00 65 8e 6b  75 f5 ea 6f 63 c0 12 d8  |.....e.ku..oc...|
-00000020  c5 42 81 1a ef 04 64 0b  38 99 35 9b 4e 84 9c 40  |.B....d.8.5.N..@|
-00000030  bc d6 f9 6f 52 16 4b c3  cb 26 42 30 af a1 d0 f9  |...oR.K..&B0....|
-00000040  07 56 27 c2 12 15 03 03  00 40 00 00 00 00 00 00  |.V'......@......|
-00000050  00 00 00 00 00 00 00 00  00 00 b1 d0 14 32 93 af  |.............2..|
-00000060  02 66 bd 5d 39 26 20 3f  c5 f1 24 54 52 a6 38 18  |.f.]9& ?..$TR.8.|
-00000070  91 6e b8 07 d9 37 58 6d  cc a9 b0 86 11 c6 b1 10  |.n...7Xm........|
-00000080  06 0c dc a5 5b ad c7 a6  fe b1                    |....[.....|
+00000010  00 00 00 00 00 ad 41 d8  27 7d f4 06 b7 6c 89 f4  |......A.'}...l..|
+00000020  e3 c5 de 6d 06 80 0c 2e  f8 42 5a 2c da f1 e2 b6  |...m.....BZ,....|
+00000030  e6 e8 6f 5c ee e0 aa 4b  d6 8a 7a 04 6a 5e 8c 99  |..o\...K..z.j^..|
+00000040  1b 36 be f9 d0 15 03 03  00 40 00 00 00 00 00 00  |.6.......@......|
+00000050  00 00 00 00 00 00 00 00  00 00 f1 cf 76 91 15 bd  |............v...|
+00000060  33 f3 96 25 c7 d9 77 30  a6 84 1a 06 c1 96 96 27  |3..%..w0.......'|
+00000070  70 ff d2 ce 82 1e 39 8f  19 75 c7 f2 0f cb de bc  |p.....9..u......|
+00000080  9a ef 4c 93 e3 3c 0c 2f  97 ad                    |..L..<./..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-CHACHA20-POLY1305 b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-CHACHA20-POLY1305
index c1670a6726..30ea8ec568 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-CHACHA20-POLY1305
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-CHACHA20-POLY1305
@@ -1,26 +1,26 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 f2 01 00 00  ee 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 ee 01 00 00  ea 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 00 08 cc a8  |................|
-00000050  13 03 13 01 13 02 01 00  00 9d 00 0b 00 02 01 00  |................|
+00000050  13 03 13 01 13 02 01 00  00 99 00 0b 00 02 01 00  |................|
 00000060  ff 01 00 01 00 00 17 00  00 00 12 00 00 00 05 00  |................|
 00000070  05 01 00 00 00 00 00 0a  00 0a 00 08 00 1d 00 17  |................|
-00000080  00 18 00 19 00 0d 00 1a  00 18 08 04 04 03 08 07  |................|
-00000090  08 05 08 06 04 01 05 01  06 01 05 03 06 03 02 01  |................|
-000000a0  02 03 00 32 00 1a 00 18  08 04 04 03 08 07 08 05  |...2............|
-000000b0  08 06 04 01 05 01 06 01  05 03 06 03 02 01 02 03  |................|
-000000c0  00 2b 00 09 08 03 04 03  03 03 02 03 01 00 33 00  |.+............3.|
-000000d0  26 00 24 00 1d 00 20 2f  e5 7d a3 47 cd 62 43 15  |&.$... /.}.G.bC.|
-000000e0  28 da ac 5f bb 29 07 30  ff f6 84 af c4 cf c2 ed  |(.._.).0........|
-000000f0  90 99 5f 58 cb 3b 74                              |.._X.;t|
+00000080  00 18 00 19 00 0d 00 16  00 14 08 04 04 03 08 07  |................|
+00000090  08 05 08 06 04 01 05 01  06 01 05 03 06 03 00 32  |...............2|
+000000a0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000b0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
+000000c0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000d0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000e0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+000000f0  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 34 c1 8b 5f 3a  |....]...Y..4.._:|
-00000010  34 19 b4 a5 7a b6 d4 d8  83 54 60 22 6c 56 52 d0  |4...z....T`"lVR.|
-00000020  c6 ae 08 d2 17 49 97 ec  fe f2 8a 20 d5 fc 67 75  |.....I..... ..gu|
-00000030  b1 26 04 0e ce 3a 0e c3  4a e3 9a 20 0b 36 12 43  |.&...:..J.. .6.C|
-00000040  13 0e db 9e 50 ca d6 54  89 01 33 56 cc a8 00 00  |....P..T..3V....|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 1b 61 37 54 ad  |....]...Y...a7T.|
+00000010  7e 92 6a 93 df 5e f8 16  be e7 06 12 3f e7 23 84  |~.j..^......?.#.|
+00000020  be 2a 30 78 98 cf 60 8a  8a 2d 26 20 44 fb 40 31  |.*0x..`..-& D.@1|
+00000030  88 38 6e fc ce 1d af 07  e3 c0 49 05 ff bc 92 ae  |.8n.......I.....|
+00000040  58 79 51 ec a7 24 82 75  9a 16 45 fa cc a8 00 00  |XyQ..$.u..E.....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -60,31 +60,31 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 63 b1 95  |............ c..|
-000002d0  d7 d2 63 99 59 8e 56 00  0a 08 29 c9 a5 30 bd 1b  |..c.Y.V...)..0..|
-000002e0  f1 e4 ad 7d 99 c0 ea 9d  44 1c c6 22 56 08 04 00  |...}....D.."V...|
-000002f0  80 d8 02 bd 3f 32 2e 05  8b 2f 2b 98 ef fe 6b 96  |....?2.../+...k.|
-00000300  80 ab d3 e1 d0 56 45 f6  66 2a 44 52 f3 47 85 f6  |.....VE.f*DR.G..|
-00000310  3a 0a 08 11 31 be 39 68  e8 8a cd ac 83 c2 32 10  |:...1.9h......2.|
-00000320  d5 9a d6 d4 9c 93 3a 49  1e d2 43 d6 f3 b8 96 6a  |......:I..C....j|
-00000330  0b 50 53 58 77 2f 7a d5  a3 d8 f7 33 6a 29 16 05  |.PSXw/z....3j)..|
-00000340  4a 71 d3 23 dc f1 91 ec  4d be 10 53 f5 57 0d 01  |Jq.#....M..S.W..|
-00000350  36 ea 6f b7 42 68 76 6c  15 57 24 bb 92 c6 48 91  |6.o.Bhvl.W$...H.|
-00000360  b2 02 83 75 9a 52 63 2d  3c 6a b5 91 8a cf ad 52  |...u.Rc-<j.....R|
-00000370  a2 16 03 03 00 04 0e 00  00 00                    |..........|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 8b cc 79  |............ ..y|
+000002d0  1e 8e 20 61 5d 00 97 27  cb 24 5c 7c 5f 3f df db  |.. a]..'.$\|_?..|
+000002e0  2d ba 3b f4 a1 1d 3e 3c  08 da 98 22 68 08 04 00  |-.;...><..."h...|
+000002f0  80 10 fc 5b 90 af a6 8e  d4 1b 5e 63 13 55 88 55  |...[......^c.U.U|
+00000300  f3 bb ad 7a 5b 14 95 55  6b 2f 01 eb 22 88 fb 21  |...z[..Uk/.."..!|
+00000310  40 88 d1 7f 52 b2 a2 ff  51 f9 05 8c c8 28 70 77  |@...R...Q....(pw|
+00000320  3c 7a b0 48 28 f0 34 19  cc 8e c8 c9 43 93 aa fa  |<z.H(.4.....C...|
+00000330  f0 38 34 13 5c 2b 34 36  7b d8 61 a3 51 4a 72 44  |.84.\+46{.a.QJrD|
+00000340  ae 3a d0 82 27 be 13 9c  b1 10 95 d0 c9 0d 46 bd  |.:..'.........F.|
+00000350  d0 8d 3e cb 9b 61 f6 02  c3 34 cf 0f 72 7d 11 eb  |..>..a...4..r}..|
+00000360  98 f2 bb c0 ae 5f b8 8e  00 6a 47 9c 8d cf 91 eb  |....._...jG.....|
+00000370  e7 16 03 03 00 04 0e 00  00 00                    |..........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 ab c0 00  15 90 de 61 3e 0b 60 16  |.... ......a>.`.|
-00000040  88 fe 6e a8 31 b8 cf bf  18 f5 21 c0 51 4f 96 fe  |..n.1.....!.QO..|
-00000050  47 eb c3 75 9b                                    |G..u.|
+00000030  16 03 03 00 20 af 23 75  51 f1 3c 68 f8 87 2e 2b  |.... .#uQ.<h...+|
+00000040  f2 32 9e f9 92 8c c0 f8  19 e6 f5 18 6a 6b 8f 47  |.2..........jk.G|
+00000050  86 38 b1 f9 10                                    |.8...|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 38 2e e1 49 d7  |.......... 8..I.|
-00000010  20 aa 42 6c 73 05 b7 37  e3 0c 14 b0 fb bd 0f 04  | .Bls..7........|
-00000020  79 a8 6c 01 63 4a 92 c8  13 a0 d9                 |y.l.cJ.....|
+00000000  14 03 03 00 01 01 16 03  03 00 20 c0 52 cb d5 de  |.......... .R...|
+00000010  b1 43 8a 0b 75 a6 a4 d4  8f af 85 63 71 1d 3b 4f  |.C..u......cq.;O|
+00000020  7a ad 9b 77 85 1a 1d 7e  4b 42 13                 |z..w...~KB.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 d4 37 f1  77 d5 49 df 50 58 c9 41  |......7.w.I.PX.A|
-00000010  ad 99 2b bc 85 a7 33 d4  ff 96 c0 15 03 03 00 12  |..+...3.........|
-00000020  a9 7f 06 84 dd 17 63 18  26 14 5e 3e 04 87 af 37  |......c.&.^>...7|
-00000030  7f 0c                                             |..|
+00000000  17 03 03 00 16 30 b8 0e  dd 42 64 a4 17 ee f5 70  |.....0...Bd....p|
+00000010  1e 00 e8 da a7 f6 8e 73  c7 70 32 15 03 03 00 12  |.......s.p2.....|
+00000020  57 be 7b cf bb 7b fe cb  7e b2 bb 38 9f 31 65 07  |W.{..{..~..8.1e.|
+00000030  ba 61                                             |.a|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-Ed25519 b/src/crypto/tls/testdata/Client-TLSv12-Ed25519
index a3d23b6208..40b2f35137 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-Ed25519
+++ b/src/crypto/tls/testdata/Client-TLSv12-Ed25519
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 19 33 a6 0c 80  |....]...Y...3...|
-00000010  5d 56 d6 7b 85 ae 50 82  3a 61 7b b0 dd 01 f8 98  |]V.{..P.:a{.....|
-00000020  b9 51 22 e7 12 4c 98 f2  4c 50 49 20 37 6f ad 03  |.Q"..L..LPI 7o..|
-00000030  52 51 44 3e 26 19 df e3  59 cd 6a 41 37 3c 46 95  |RQD>&...Y.jA7<F.|
-00000040  1f e1 07 20 f2 6b b4 15  a2 41 0e b2 cc a9 00 00  |... .k...A......|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 cc 3c fc d0 c6  |....]...Y...<...|
+00000010  b8 3e 6b cb 59 8d 68 04  0b 94 10 28 ad 71 06 14  |.>k.Y.h....(.q..|
+00000020  08 6c 10 12 aa 8d e4 f9  aa 7d 9b 20 a0 b8 96 40  |.l.......}. ...@|
+00000030  1a ce 65 ae a6 a2 4d 4d  92 41 8e 2c 8d 94 d1 02  |..e...MM.A.,....|
+00000040  c1 cb bd 6d 8b ee 36 ae  c5 ec 6a 40 cc a9 00 00  |...m..6...j@....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 01 3c 0b  00 01 38 00 01 35 00 01  |......<...8..5..|
 00000070  32 30 82 01 2e 30 81 e1  a0 03 02 01 02 02 10 0f  |20...0..........|
@@ -46,26 +45,26 @@
 00000180  fc ab 7d 4d d4 e0 93 13  d0 a9 42 e0 b6 6b fe 5d  |..}M......B..k.]|
 00000190  67 48 d7 9f 50 bc 6c cd  4b 03 83 7c f2 08 58 cd  |gH..P.l.K..|..X.|
 000001a0  ac cf 0c 16 03 03 00 6c  0c 00 00 68 03 00 1d 20  |.......l...h... |
-000001b0  54 12 8c 8b b0 53 e4 e0  43 90 3d 15 fb 26 ee a9  |T....S..C.=..&..|
-000001c0  12 24 60 7f d5 57 e5 1c  bc ca 4f 31 dd a2 a8 3e  |.$`..W....O1...>|
-000001d0  08 07 00 40 ad 8c 20 13  7d f5 5e 5e b2 41 9f 60  |...@.. .}.^^.A.`|
-000001e0  f7 d2 cc 2f fe 47 6d 8c  24 ca 0d 72 63 eb 0d f8  |.../.Gm.$..rc...|
-000001f0  93 0b 13 de 8f bc 92 0e  f8 77 8a de 2f 9c 32 30  |.........w../.20|
-00000200  96 cb 5b bc b8 94 68 fb  06 62 ce 01 ed b8 f8 f2  |..[...h..b......|
-00000210  c1 c4 16 01 16 03 03 00  04 0e 00 00 00           |.............|
+000001b0  fd f1 12 74 21 62 15 da  36 af d5 6c f3 0a cd 1e  |...t!b..6..l....|
+000001c0  09 37 aa 55 32 1a 27 a7  5b 37 34 32 35 36 f5 14  |.7.U2.'.[74256..|
+000001d0  08 07 00 40 3d 7c 51 33  98 02 91 19 da 47 1a 1a  |...@=|Q3.....G..|
+000001e0  fe 03 4e 1b e8 5c 5e a7  12 9c e6 8a c2 74 18 dd  |..N..\^......t..|
+000001f0  18 9a 9d d6 60 f3 c8 63  00 33 d8 81 3e 2e 40 0f  |....`..c.3..>.@.|
+00000200  c5 98 fc a8 1c 6b 0c 19  70 f5 16 a5 25 ce 7b b8  |.....k..p...%.{.|
+00000210  f2 f5 87 04 16 03 03 00  04 0e 00 00 00           |.............|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 25 48 e8  48 d4 0e e2 2e 91 65 98  |.... %H.H.....e.|
-00000040  60 1e ae 8f e6 7e 5b 0a  bb 7b 90 8a 2b a7 b2 81  |`....~[..{..+...|
-00000050  f6 4b 17 c5 cc                                    |.K...|
+00000030  16 03 03 00 20 91 a7 c4  90 65 85 ce 63 66 fa 8b  |.... ....e..cf..|
+00000040  5c 22 e1 1d fb 14 c2 6c  86 7c 52 7c d1 96 3b 41  |\".....l.|R|..;A|
+00000050  20 0d bf 09 e8                                    | ....|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 f5 ed d5 32 97  |.......... ...2.|
-00000010  a7 91 bc 42 03 3b f1 76  21 68 19 41 8f 70 a1 74  |...B.;.v!h.A.p.t|
-00000020  28 fb f4 7a 61 1e cf 79  b6 f7 a8                 |(..za..y...|
+00000000  14 03 03 00 01 01 16 03  03 00 20 d0 3e 15 0e 08  |.......... .>...|
+00000010  5b fd a8 b7 5f 01 7f ca  6d af 78 6e 33 7a 93 42  |[..._...m.xn3z.B|
+00000020  aa 6e e4 f4 a1 bb 9a 2d  bb 17 6f                 |.n.....-..o|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 9b bf f5  4d cb b0 e2 bb 5c df e4  |........M....\..|
-00000010  c8 85 31 11 d1 59 9d 72  03 2a 74 15 03 03 00 12  |..1..Y.r.*t.....|
-00000020  13 fd 92 1a 96 bf 23 2e  06 8b e4 42 f6 05 7d 7e  |......#....B..}~|
-00000030  6c cd                                             |l.|
+00000000  17 03 03 00 16 7b f9 2f  ce ac bc 43 3c 6b 10 3b  |.....{./...C<k.;|
+00000010  9e 06 46 5f 4d d0 56 ca  85 14 96 15 03 03 00 12  |..F_M.V.........|
+00000020  68 81 80 6b 60 6c e6 2d  bb 0a b0 3a 21 04 2e a9  |h..k`l.-...:!...|
+00000030  b7 41                                             |.A|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ExportKeyingMaterial b/src/crypto/tls/testdata/Client-TLSv12-ExportKeyingMaterial
index 55644403d3..b3877a7b67 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ExportKeyingMaterial
+++ b/src/crypto/tls/testdata/Client-TLSv12-ExportKeyingMaterial
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 37 1f dc 30 b6  |....]...Y..7..0.|
-00000010  6b 54 22 cd 46 38 00 7b  c2 d4 97 80 f5 b6 cb fc  |kT".F8.{........|
-00000020  01 b7 91 6a ce 1d 20 9f  fb 4a b3 20 d2 72 bb 97  |...j.. ..J. .r..|
-00000030  2a 46 3c da d1 8a 8e 1b  cd ed e7 5a 5a c7 0c ca  |*F<........ZZ...|
-00000040  1f 6e 40 b3 6a d6 7a ae  55 bd 82 42 cc a8 00 00  |.n@.j.z.U..B....|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 ad 2d c6 4e 13  |....]...Y...-.N.|
+00000010  72 ea 19 e0 65 33 ec cb  aa 5c 70 bd f5 70 e0 b4  |r...e3...\p..p..|
+00000020  ca 7e 64 da 5e 5f cb a6  69 d4 8c 20 79 45 e2 0a  |.~d.^_..i.. yE..|
+00000030  c7 b2 be 37 28 b5 c6 35  f9 0c c9 34 39 4d 38 3b  |...7(..5...49M8;|
+00000040  c0 47 31 44 e2 47 f7 6f  70 0f 8b 2d cc a8 00 00  |.G1D.G.op..-....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -63,31 +62,31 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 da a1 33  |............ ..3|
-000002d0  ec 12 5f c7 25 b5 de 66  38 64 74 a9 e2 69 09 e3  |.._.%..f8dt..i..|
-000002e0  12 49 fe 0a 0a 74 c5 c8  04 b0 4c 01 6d 08 04 00  |.I...t....L.m...|
-000002f0  80 5d c4 70 28 74 65 b3  74 bb 2d 71 87 84 48 25  |.].p(te.t.-q..H%|
-00000300  41 14 38 17 cd e3 8c a8  24 a5 6b bd 81 62 ef bc  |A.8.....$.k..b..|
-00000310  9d 15 31 a7 6f a7 55 90  c8 fb 71 8a 45 a6 4a fb  |..1.o.U...q.E.J.|
-00000320  14 5d 92 5b fc 41 79 ca  d4 ac 5b 43 ea 18 f2 e4  |.].[.Ay...[C....|
-00000330  69 91 45 27 8e 32 ef ae  59 70 3e 43 b0 43 3f f0  |i.E'.2..Yp>C.C?.|
-00000340  1b e6 e4 aa 8f 0f 4d 7f  b7 d8 bf fb 40 59 92 2e  |......M.....@Y..|
-00000350  08 51 2a a4 ce c8 da f9  ec b3 d6 f6 63 32 e9 ef  |.Q*.........c2..|
-00000360  b8 42 25 2a 5e ec 4b 39  e5 52 d1 e7 f1 5d 18 9f  |.B%*^.K9.R...]..|
-00000370  97 16 03 03 00 04 0e 00  00 00                    |..........|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 f4 07 0a  |............ ...|
+000002d0  38 0a 4e 5d 59 90 98 e7  19 02 7b 51 76 59 2e 3d  |8.N]Y.....{QvY.=|
+000002e0  d2 f5 2f 1c 87 29 61 94  a0 ad 95 8b 4b 08 04 00  |../..)a.....K...|
+000002f0  80 22 b1 ac 42 df 30 4f  ea 41 75 a5 28 2e a7 50  |."..B.0O.Au.(..P|
+00000300  2a 4f c8 f4 1f c3 35 82  88 47 78 de fe 00 43 ed  |*O....5..Gx...C.|
+00000310  84 48 52 8b bf 77 22 00  fd 92 c4 e0 67 66 28 5c  |.HR..w".....gf(\|
+00000320  8a 7f 32 21 c2 5a bd b2  8f d5 72 48 3a 83 3b d7  |..2!.Z....rH:.;.|
+00000330  c8 c0 fb 54 52 28 41 49  3f 6d b4 4c ef 87 3a e5  |...TR(AI?m.L..:.|
+00000340  30 db e2 c8 5c ed f1 46  a8 f4 04 0b 02 2b 93 03  |0...\..F.....+..|
+00000350  de dc 41 88 50 f6 22 c5  2a 30 ac 47 f2 db 00 5c  |..A.P.".*0.G...\|
+00000360  7e 14 25 fd 72 de 81 ed  30 c8 62 1c 6d 44 4e 90  |~.%.r...0.b.mDN.|
+00000370  3f 16 03 03 00 04 0e 00  00 00                    |?.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 a6 dc 32  3e 35 76 e8 25 41 ad f7  |.... ..2>5v.%A..|
-00000040  64 02 b0 a3 19 0b ea 1c  7f d7 47 4c 73 2d 7e 6f  |d.........GLs-~o|
-00000050  7a 0c 09 41 1f                                    |z..A.|
+00000030  16 03 03 00 20 e1 88 c9  ef 40 26 52 ca d2 d9 31  |.... ....@&R...1|
+00000040  9c 51 a6 fa b3 40 6b 62  7e ad 00 ea da 8f 54 bf  |.Q...@kb~.....T.|
+00000050  f5 89 4b c9 a9                                    |..K..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 77 e0 48 07 28  |.......... w.H.(|
-00000010  72 79 07 2e 8a b8 1c a0  70 78 f1 a8 e9 24 6d 46  |ry......px...$mF|
-00000020  78 27 71 a0 a4 7b da 5b  77 3d 78                 |x'q..{.[w=x|
+00000000  14 03 03 00 01 01 16 03  03 00 20 6f e3 54 91 aa  |.......... o.T..|
+00000010  00 b4 8e f3 b2 51 1e 76  48 91 49 b9 ba dc 5f e4  |.....Q.vH.I..._.|
+00000020  9f 0e 49 b5 54 f5 e3 9d  25 75 38                 |..I.T...%u8|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 d9 2e 8d  11 ee 6a df 43 dc 3b f4  |..........j.C.;.|
-00000010  dd 9e c3 be 2e 78 8a 39  3b 7a a1 15 03 03 00 12  |.....x.9;z......|
-00000020  d5 ef f8 2e 49 c9 f8 27  3e 29 e5 39 fc 25 3d b2  |....I..'>).9.%=.|
-00000030  ff a8                                             |..|
+00000000  17 03 03 00 16 7b 2a af  79 d3 1c 0d cf 0f 83 04  |.....{*.y.......|
+00000010  9e 96 63 69 0c ec f7 98  02 33 12 15 03 03 00 12  |..ci.....3......|
+00000020  58 d3 1a 60 74 2c 92 91  61 2c 13 23 6d e9 5f de  |X..`t,..a,.#m._.|
+00000030  65 42                                             |eB|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-P256-ECDHE b/src/crypto/tls/testdata/Client-TLSv12-P256-ECDHE
index d991b001d5..0cac7e7545 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-P256-ECDHE
+++ b/src/crypto/tls/testdata/Client-TLSv12-P256-ECDHE
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 37 01 00 01  33 03 03 00 00 00 00 00  |....7...3.......|
+00000000  16 03 01 01 33 01 00 01  2f 03 03 00 00 00 00 00  |....3.../.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,24 +7,24 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 b8 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 b4 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
-000000a0  00 0a 00 04 00 02 00 17  00 0d 00 1a 00 18 08 04  |................|
+000000a0  00 0a 00 04 00 02 00 17  00 0d 00 16 00 14 08 04  |................|
 000000b0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
-000000c0  06 03 02 01 02 03 00 32  00 1a 00 18 08 04 04 03  |.......2........|
-000000d0  08 07 08 05 08 06 04 01  05 01 06 01 05 03 06 03  |................|
-000000e0  02 01 02 03 00 2b 00 09  08 03 04 03 03 03 02 03  |.....+..........|
-000000f0  01 00 33 00 47 00 45 00  17 00 41 04 1e 18 37 ef  |..3.G.E...A...7.|
-00000100  0d 19 51 88 35 75 71 b5  e5 54 5b 12 2e 8f 09 67  |..Q.5uq..T[....g|
-00000110  fd a7 24 20 3e b2 56 1c  ce 97 28 5e f8 2b 2d 4f  |..$ >.V...(^.+-O|
-00000120  9e f1 07 9f 6c 4b 5b 83  56 e2 32 42 e9 58 b6 d7  |....lK[.V.2B.X..|
-00000130  49 a6 b5 68 1a 41 03 56  6b dc 5a 89              |I..h.A.Vk.Z.|
+000000c0  06 03 00 32 00 1a 00 18  08 04 04 03 08 07 08 05  |...2............|
+000000d0  08 06 04 01 05 01 06 01  05 03 06 03 02 01 02 03  |................|
+000000e0  00 2b 00 09 08 03 04 03  03 03 02 03 01 00 33 00  |.+............3.|
+000000f0  47 00 45 00 17 00 41 04  1e 18 37 ef 0d 19 51 88  |G.E...A...7...Q.|
+00000100  35 75 71 b5 e5 54 5b 12  2e 8f 09 67 fd a7 24 20  |5uq..T[....g..$ |
+00000110  3e b2 56 1c ce 97 28 5e  f8 2b 2d 4f 9e f1 07 9f  |>.V...(^.+-O....|
+00000120  6c 4b 5b 83 56 e2 32 42  e9 58 b6 d7 49 a6 b5 68  |lK[.V.2B.X..I..h|
+00000130  1a 41 03 56 6b dc 5a 89                           |.A.Vk.Z.|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 f2 96 d3 16 ce  |....]...Y.......|
-00000010  7c b8 43 6a 66 b2 9f 58  d2 66 74 f6 92 61 3a 48  ||.Cjf..X.ft..a:H|
-00000020  b1 84 87 be bf 7e 5a 9c  75 e3 e1 20 a6 b6 cc cf  |.....~Z.u.. ....|
-00000030  3a 1e b5 62 01 bd ee 58  eb ea 84 58 08 dc e6 d2  |:..b...X...X....|
-00000040  86 a0 5e f2 63 f2 1f 81  29 0d f7 5c c0 2f 00 00  |..^.c...)..\./..|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 d9 70 61 62 c5  |....]...Y...pab.|
+00000010  f4 b4 22 c6 ea f6 e9 8c  fc 29 e8 8c 24 2d 4b c4  |.."......)..$-K.|
+00000020  04 57 01 ae e5 41 7e 7f  6f ec c3 20 86 6b 38 a9  |.W...A~.o.. .k8.|
+00000030  ea cd 51 3b 0f 05 5c a3  98 0c 4d ba 46 d6 99 f3  |..Q;..\...M.F...|
+00000040  67 da f2 62 56 29 f7 e6  8c 14 8a 7a c0 2f 00 00  |g..bV).....z./..|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -64,37 +64,37 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 cd 0c 00 00  c9 03 00 17 41 04 9f ab  |............A...|
-000002d0  e5 e2 8c b7 47 ce a4 e6  c8 ca 51 d7 28 b3 8b be  |....G.....Q.(...|
-000002e0  83 f4 d5 34 27 f5 89 2b  d0 bb 7e 2f 87 8c 64 3d  |...4'..+..~/..d=|
-000002f0  fc ee 5e c1 35 f6 ff be  49 75 58 65 22 92 5b 6f  |..^.5...IuXe".[o|
-00000300  07 08 61 d0 16 9c 6b 2f  b0 47 a0 ed 45 d8 08 04  |..a...k/.G..E...|
-00000310  00 80 58 85 e9 5f 3b b6  03 25 a8 49 da 56 87 2e  |..X.._;..%.I.V..|
-00000320  d5 89 ce 53 de f2 8e b7  4b 7a 24 be 0b c1 86 4b  |...S....Kz$....K|
-00000330  3a a3 58 ea e2 68 bd 33  91 93 8b f5 cc 6e ea 7d  |:.X..h.3.....n.}|
-00000340  e4 14 fc 6c d2 d3 25 97  73 bf 0d d4 26 65 71 c0  |...l..%.s...&eq.|
-00000350  6f 85 52 e6 e5 34 e7 05  7b 8b d0 96 db f4 cc 49  |o.R..4..{......I|
-00000360  f7 7f da c6 56 54 b0 e0  5e 60 b1 ea 8a 9b 45 06  |....VT..^`....E.|
-00000370  54 ed b4 34 ab a0 0b 72  4f 0e 0a 9c 57 f8 c2 1c  |T..4...rO...W...|
-00000380  87 8b 9c 48 97 ae 08 2b  51 07 cd 5d 5c 0a 1e 47  |...H...+Q..]\..G|
-00000390  b7 bd 16 03 03 00 04 0e  00 00 00                 |...........|
+000002c0  16 03 03 00 cd 0c 00 00  c9 03 00 17 41 04 a0 b7  |............A...|
+000002d0  0f 94 44 46 c4 72 5a 3c  b8 5c cd f1 9e b0 49 17  |..DF.rZ<.\....I.|
+000002e0  ea a0 ca 1d 17 d8 85 5f  0a e3 4a 85 5d f4 bb 52  |......._..J.]..R|
+000002f0  23 79 24 a9 50 81 9f 8a  5e e4 2f 5d cc 7d e2 10  |#y$.P...^./].}..|
+00000300  db 42 f0 26 98 61 b7 f5  39 16 46 d6 04 f7 08 04  |.B.&.a..9.F.....|
+00000310  00 80 05 70 60 b3 39 e0  61 6e 72 b3 13 2c 8c 2d  |...p`.9.anr..,.-|
+00000320  e1 d9 37 8e cd 13 64 2f  4b 65 4f 7c a0 2a 7e 91  |..7...d/KeO|.*~.|
+00000330  e1 fd 7d 3b e3 35 dd 5a  c8 ab 56 13 c3 c6 07 90  |..};.5.Z..V.....|
+00000340  fb d3 cf 22 dd 78 4c 33  c7 d3 6e 64 7e 65 ba 02  |...".xL3..nd~e..|
+00000350  ca 04 50 77 08 65 d5 80  c9 4f c3 b3 5b 97 b2 80  |..Pw.e...O..[...|
+00000360  3d 48 37 20 ab 28 15 0c  f2 86 dd b6 19 66 46 e3  |=H7 .(.......fF.|
+00000370  23 69 e2 5d fb 70 65 fb  c6 ae fc a4 02 42 9f fe  |#i.].pe......B..|
+00000380  b4 5c f0 4b 23 92 2a 4f  a4 1a f4 86 3b 5c 25 9d  |.\.K#.*O....;\%.|
+00000390  86 e2 16 03 03 00 04 0e  00 00 00                 |...........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
 00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
 00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 c5 59  |.....(.........Y|
-00000060  bb bb c9 dc 4d 95 d9 70  d0 bc 76 ca e7 0f 50 f8  |....M..p..v...P.|
-00000070  d5 55 e0 3c fb 12 63 ff  8d b4 a9 85 96 0e        |.U.<..c.......|
+00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 3f 54  |.....(........?T|
+00000060  35 c8 33 70 66 0f 9d 3d  57 d7 a8 7f 57 45 63 a4  |5.3pf..=W...WEc.|
+00000070  67 a2 83 c4 17 5b 22 8f  1c 89 78 1c 43 8d        |g....["...x.C.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 98 cb 91 21 85  |..........(...!.|
-00000010  4a fd 3f e5 f7 31 8d 35  c9 11 31 fc 1f 0e e3 0d  |J.?..1.5..1.....|
-00000020  86 c7 93 10 1d 52 21 2c  6f 7a c7 0e 6a d8 67 9c  |.....R!,oz..j.g.|
-00000030  c8 e7 cd                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 28 25 5d 63 2d f3  |..........(%]c-.|
+00000010  a5 91 45 d0 7d 68 39 f6  0e 04 6f 4b c9 dd 4a 54  |..E.}h9...oK..JT|
+00000020  f5 a2 04 54 d2 57 4b 40  75 4d 2f b3 5d 00 5b 11  |...T.WK@uM/.].[.|
+00000030  89 0e 92                                          |...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 b7 f9 69  |...............i|
-00000010  f9 81 f1 da b7 b7 4b fe  3a a4 d7 d2 af b5 2a e9  |......K.:.....*.|
-00000020  8f 97 c1 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
-00000030  b2 0d 99 04 5c 56 a2 6e  50 e1 52 80 c5 3c 4b 69  |....\V.nP.R..<Ki|
-00000040  21 df                                             |!.|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 0c 9c ab  |................|
+00000010  24 e8 b2 cf a2 6f f9 8e  54 ed 35 43 07 4d 8f 89  |$....o..T.5C.M..|
+00000020  5c 08 15 15 03 03 00 1a  00 00 00 00 00 00 00 02  |\...............|
+00000030  f8 65 48 1e a4 03 c0 3b  2f 23 c7 9e 92 59 f6 be  |.eH....;/#...Y..|
+00000040  b4 a2                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4 b/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4
index 1bc33d7451..faa48c7843 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4
+++ b/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 55 02 00 00  51 03 03 e6 2c 7a 70 96  |....U...Q...,zp.|
-00000010  c0 bf e7 e6 2e 51 35 c7  3e 0a 4c 1e 2a 0b 54 08  |.....Q5.>.L.*.T.|
-00000020  57 e1 66 22 94 26 fe df  ce 7e bf 20 26 07 f0 81  |W.f".&...~. &...|
-00000030  7d 73 2c 70 6f d1 1b 85  f5 af 97 7e 5b 3f 5e a0  |}s,po......~[?^.|
-00000040  fc 9b 7d 5a c3 e2 05 30  b5 f5 47 05 00 05 00 00  |..}Z...0..G.....|
+00000000  16 03 03 00 55 02 00 00  51 03 03 c4 5b d6 0f d4  |....U...Q...[...|
+00000010  64 3a 37 34 a3 84 9d 3d  1b 33 c3 d4 4f 42 f7 3a  |d:74...=.3..OB.:|
+00000020  e8 da 8c 8b 97 1a e5 f4  56 a4 bd 20 03 30 25 fd  |........V.. .0%.|
+00000030  d9 01 7a 7c b8 9d 63 f0  a3 7a 1c 00 6b 75 16 d8  |..z|..c..z..ku..|
+00000040  68 5c 7a 8d 4a ae ed 52  fc 92 e5 03 00 05 00 00  |h\z.J..R........|
 00000050  09 ff 01 00 01 00 00 17  00 00 16 03 03 02 59 0b  |..............Y.|
 00000060  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
 00000070  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
@@ -74,15 +73,15 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 03 00 24 ad c5  35 7b 7c 74 c7 24 58 ef  |.....$..5{|t.$X.|
-000000a0  55 3f 8d c1 52 97 f8 91  93 46 02 ff cf 06 00 ba  |U?..R....F......|
-000000b0  26 91 ec c4 91 23 60 b2  c8 77                    |&....#`..w|
+00000090  01 16 03 03 00 24 83 66  73 cf 08 6f c7 29 1b ea  |.....$.fs..o.)..|
+000000a0  86 aa 02 66 2d d9 d4 7b  19 0d cc e5 9e dc e9 20  |...f-..{....... |
+000000b0  d9 62 82 59 bd e9 91 6b  90 62                    |.b.Y...k.b|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 24 e6 06 60 54 3e  |..........$..`T>|
-00000010  39 d8 22 df 83 a7 7a 4d  b4 63 03 77 3d 5d e8 06  |9."...zM.c.w=]..|
-00000020  6f fe 0a 70 4b b3 82 cc  a8 aa 48 2e f2 72 7b     |o..pK.....H..r{|
+00000000  14 03 03 00 01 01 16 03  03 00 24 ef bb 0c 3b fb  |..........$...;.|
+00000010  4e 36 53 b9 fa d4 c3 d0  37 5e 2b 22 a2 12 b6 9e  |N6S.....7^+"....|
+00000020  1c a3 f7 93 74 60 38 18  f1 cc 72 e4 ba 1a 3d     |....t`8...r...=|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1a e5 e3 38  a3 34 e4 02 f1 c4 96 14  |.......8.4......|
-00000010  13 fb 50 7d 6a 26 cf 49  f8 d6 e5 f0 d8 7c b5 15  |..P}j&.I.....|..|
-00000020  03 03 00 16 a4 cd 6c b6  b2 45 d7 35 df 56 ba ae  |......l..E.5.V..|
-00000030  a9 41 09 85 67 bb 16 c0  3e d0                    |.A..g...>.|
+00000000  17 03 03 00 1a 62 a3 b3  3a 89 25 05 89 bc 5a 21  |.....b..:.%...Z!|
+00000010  30 61 84 b0 97 52 26 a2  18 87 25 43 17 1a 52 15  |0a...R&...%C..R.|
+00000020  03 03 00 16 97 d6 18 0c  30 b3 9b 8f 2b f1 f9 3f  |........0...+..?|
+00000030  c7 8d a2 e1 ff 36 0c d6  c2 f1                    |.....6....|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce
index 8456e3abf7..868b527396 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 eb da 48 1d 79  |....]...Y....H.y|
-00000010  90 f6 67 5b 69 7b 40 07  20 12 0b 12 bd 94 75 e0  |..g[i{@. .....u.|
-00000020  84 3f 0d a5 77 c6 36 18  25 79 3c 20 07 6c 6d c7  |.?..w.6.%y< .lm.|
-00000030  b4 7e 2a 2b a5 7e 55 36  83 4d d9 94 9f 73 60 d8  |.~*+.~U6.M...s`.|
-00000040  e9 55 05 b9 bf b0 64 84  09 fe c0 2a cc a8 00 00  |.U....d....*....|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 9e b0 dd 2b 97  |....]...Y.....+.|
+00000010  86 13 76 2e 65 fc 27 bc  fd 01 c0 05 86 b9 e3 bd  |..v.e.'.........|
+00000020  b9 46 3b 09 37 2a fe 3a  eb ee e0 20 65 ad 7c 0b  |.F;.7*.:... e.|.|
+00000030  1a 0b 9b da b0 8d 56 86  b6 e1 04 1b dd 5d 93 8e  |......V......]..|
+00000040  a9 ea b6 b7 17 c9 75 26  58 5a c5 37 cc a8 00 00  |......u&XZ.7....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -63,188 +62,188 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 be 2a c0  |............ .*.|
-000002d0  ce 61 d8 36 d0 41 4c 32  83 bb be 81 66 c8 cf cb  |.a.6.AL2....f...|
-000002e0  a2 d9 ff 9d 05 51 d9 52  bc 06 be 09 10 08 04 00  |.....Q.R........|
-000002f0  80 00 d1 fc 8c 60 a1 8f  36 3d a5 53 62 06 dd 93  |.....`..6=.Sb...|
-00000300  58 30 71 f6 a1 b8 bd c4  4e 44 2d 37 b8 38 d1 6f  |X0q.....ND-7.8.o|
-00000310  16 8d f6 6d 4a 7c af e2  a2 4a 55 b5 17 d2 61 a0  |...mJ|...JU...a.|
-00000320  93 80 d4 a9 11 49 55 cf  e3 d0 87 95 c9 c2 f6 d0  |.....IU.........|
-00000330  44 6f 33 2b ae 4a 1d e4  1e 04 f5 32 ca d6 19 61  |Do3+.J.....2...a|
-00000340  9c 8e 0d d1 1a f3 38 4b  b3 c3 eb dd fb 04 40 b7  |......8K......@.|
-00000350  f7 ef 1f f1 0a 23 08 21  2a b3 d9 f8 cf 2b 65 4c  |.....#.!*....+eL|
-00000360  47 92 52 18 61 5e f3 ad  58 36 26 09 bf 12 b6 ab  |G.R.a^..X6&.....|
-00000370  21 16 03 03 00 04 0e 00  00 00                    |!.........|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 41 0e e9  |............ A..|
+000002d0  28 d0 77 ab a1 9e 93 62  b1 ec d9 e4 17 7d cb 29  |(.w....b.....}.)|
+000002e0  25 28 6f 7d de fa 2e 89  8c 02 f7 22 25 08 04 00  |%(o}......."%...|
+000002f0  80 c9 63 f4 f2 99 a9 c3  dd 81 1b 3a c2 85 0a e7  |..c........:....|
+00000300  0f a6 5d 71 54 42 9e b9  68 35 5f ff b5 f3 51 9f  |..]qTB..h5_...Q.|
+00000310  16 46 c3 55 44 15 34 22  6d 68 15 6f 86 60 36 27  |.F.UD.4"mh.o.`6'|
+00000320  29 b1 f5 f3 21 5a c5 bc  95 b9 18 f3 57 7b f7 90  |)...!Z......W{..|
+00000330  20 c1 41 f2 53 d2 a0 a6  4a c8 3b 2b 75 7d 27 84  | .A.S...J.;+u}'.|
+00000340  fb 90 1c 9c 29 26 91 71  e8 25 0b 2a f1 76 b5 5c  |....)&.q.%.*.v.\|
+00000350  7f df 02 86 1c a9 ba 5a  4a 6c 25 95 1d 3c 51 21  |.......ZJl%..<Q!|
+00000360  e9 35 53 59 f4 c5 60 af  45 d0 f3 a0 36 8a dc ad  |.5SY..`.E...6...|
+00000370  19 16 03 03 00 04 0e 00  00 00                    |..........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 68 e5 aa  89 6f 05 45 05 68 e9 53  |.... h...o.E.h.S|
-00000040  35 a0 9b 96 d9 6b ab 2c  7f e1 4c de 3e 06 c6 04  |5....k.,..L.>...|
-00000050  bd 7c 28 fb db                                    |.|(..|
+00000030  16 03 03 00 20 5b d2 2a  ad 40 50 6f a8 b8 70 d0  |.... [.*.@Po..p.|
+00000040  b9 aa ab d5 d7 2a f1 2b  f7 d7 9b cd 10 a5 80 e9  |.....*.+........|
+00000050  d3 15 3f 4f 00                                    |..?O.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 fd 74 c3 42 59  |.......... .t.BY|
-00000010  0d 86 2a 1c c7 51 d9 98  2c 1e 5b bd 44 3e 97 3e  |..*..Q..,.[.D>.>|
-00000020  55 90 5e 74 45 b7 47 0f  f7 3e d7                 |U.^tE.G..>.|
+00000000  14 03 03 00 01 01 16 03  03 00 20 dd 90 d8 8a 0a  |.......... .....|
+00000010  11 a6 30 9b b0 29 50 c8  b1 70 36 bc fb 84 6e 6d  |..0..)P..p6...nm|
+00000020  a9 5e 67 3c e2 2e 0b 09  b2 44 38                 |.^g<.....D8|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 b5 ca 44  da 63 57 7f 6c e9 95 a5  |.......D.cW.l...|
-00000010  56 88 f1 98 dc 73 85 3f  36 66 6f                 |V....s.?6fo|
+00000000  17 03 03 00 16 9f e0 6a  fc e9 a2 bf cf b4 df 07  |.......j........|
+00000010  ba b4 8b 8b 08 ca bd a7  d5 02 2a                 |..........*|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 14 76 6b 6b  8c c1 38 cf 00 bf 20 c2  |.....vkk..8... .|
-00000010  62 ae df 09 0e 61 61 bf  24                       |b....aa.$|
+00000000  16 03 03 00 14 ed 9b 22  44 dd b2 e2 c3 7e ab 0c  |......."D....~..|
+00000010  69 98 d0 7b 40 9e da e2  67                       |i..{@...g|
 >>> Flow 7 (client to server)
-00000000  16 03 03 01 38 0f c1 53  8f f5 61 aa 61 0a f4 de  |....8..S..a.a...|
-00000010  80 a6 92 99 a0 33 e6 90  5f b0 13 b7 be 93 0f 60  |.....3.._......`|
-00000020  40 97 0a 3c dd 9f 22 fa  c1 8f 1d 3d 11 c1 16 97  |@..<.."....=....|
-00000030  c5 54 e4 08 fb 77 ff fb  51 fb 1a d1 a6 41 b8 4f  |.T...w..Q....A.O|
-00000040  a2 22 d7 11 8c 31 49 d7  d5 b2 16 02 2b 4d b6 ba  |."...1I.....+M..|
-00000050  7d 53 6c 5a 59 59 ec 54  00 c4 6b c3 bd 22 d1 b3  |}SlZYY.T..k.."..|
-00000060  78 f8 e7 25 6e 67 b5 32  51 a6 60 5b 55 9a a0 f4  |x..%ng.2Q.`[U...|
-00000070  ed e8 8c 8d 77 4b c3 04  9d b0 2a ed a0 bf 9f 03  |....wK....*.....|
-00000080  fa e5 2e 17 9e 04 d6 6c  38 70 33 bc 90 eb 6f db  |.......l8p3...o.|
-00000090  33 9e 69 5f 44 8c 63 af  9f 6e 74 e0 a8 d2 1b 7d  |3.i_D.c..nt....}|
-000000a0  d1 11 ea f4 c5 49 2c 7a  98 ae f6 28 58 76 ac da  |.....I,z...(Xv..|
-000000b0  31 0d 7a c7 2d e6 8a 34  9d 37 26 c8 3e 44 ac df  |1.z.-..4.7&.>D..|
-000000c0  0b 4b 2c 4e 7c 63 ec 23  82 13 a3 87 ac f7 9a 08  |.K,N|c.#........|
-000000d0  03 1c e9 ca 89 4a a8 93  37 a3 d6 1f fa dd c8 48  |.....J..7......H|
-000000e0  4a 4a ba 4d 54 80 20 18  a6 e4 98 3d dd 81 58 ec  |JJ.MT. ....=..X.|
-000000f0  9f c0 5f 06 d6 29 04 76  38 1f d0 f4 3f fe 82 ab  |.._..).v8...?...|
-00000100  de cb 12 44 a2 96 eb ac  d2 8d a1 76 37 85 71 80  |...D.......v7.q.|
-00000110  de 8b 66 50 8e 41 17 cf  9b 2b 3a 7e 1d a3 e2 26  |..fP.A...+:~...&|
-00000120  9f 60 1c 1e 89 06 d8 41  21 8d 3d ab 91 15 be 61  |.`.....A!.=....a|
-00000130  6c 07 2a e7 55 8f 6c a5  13 51 9d cc 6f           |l.*.U.l..Q..o|
+00000000  16 03 03 01 34 0d de 90  41 3c 76 1d 54 9d c2 7e  |....4...A<v.T..~|
+00000010  f5 d6 ea 55 32 23 f0 96  f0 45 c8 48 1a 81 ff b6  |...U2#...E.H....|
+00000020  99 70 e4 2d 57 e3 d1 be  8e 28 4d 6f 3c 8a ed 34  |.p.-W....(Mo<..4|
+00000030  36 1f 53 0d 8b 82 ab d5  d2 ca fc 9b 20 38 5e 83  |6.S......... 8^.|
+00000040  25 23 f9 54 30 45 e6 3c  8a a5 8e 48 fa 85 5b 7f  |%#.T0E.<...H..[.|
+00000050  5c 63 1a 7f 80 dc 84 54  02 f4 11 da 19 62 9f 76  |\c.....T.....b.v|
+00000060  ca a0 26 95 3e 3f 4a bc  0b 7d e7 ca b6 fb d3 08  |..&.>?J..}......|
+00000070  4c 1c fb 2c 88 4c 13 8d  c8 d0 e3 7f f6 cb 2e ca  |L..,.L..........|
+00000080  cb 92 ae 30 fe ea 3c 3e  ae 57 51 6a d6 98 5c d6  |...0..<>.WQj..\.|
+00000090  19 85 72 bd 62 56 fa c2  ea 08 eb b4 d9 75 ac de  |..r.bV.......u..|
+000000a0  a5 40 8d 8b 1f c4 8f f6  6d b2 5f d1 6d fb 14 fa  |.@......m._.m...|
+000000b0  e2 92 9e 04 37 d3 60 83  28 4a f9 92 8c b3 4a d2  |....7.`.(J....J.|
+000000c0  ce 6d 95 e4 40 79 7c 3d  98 11 e7 da 5c 56 0a 95  |.m..@y|=....\V..|
+000000d0  e0 6f 36 80 07 da 29 ef  88 44 db cd 2b 5a a5 27  |.o6...)..D..+Z.'|
+000000e0  56 5a 94 49 aa 51 ae 48  f9 12 8d df e0 2a a7 67  |VZ.I.Q.H.....*.g|
+000000f0  7f 55 3e 7a b6 bb 28 e3  a8 d9 44 67 e9 03 8f e5  |.U>z..(...Dg....|
+00000100  2b 40 a3 37 fb e4 51 0a  18 8f bb 14 2e 5b 62 93  |+@.7..Q......[b.|
+00000110  ab a4 40 d7 5f 15 12 cf  93 74 37 d0 ec 14 d3 a3  |..@._....t7.....|
+00000120  eb 6f 61 35 4a c4 b5 d7  d1 bb ae fe 11 6d 04 ac  |.oa5J........m..|
+00000130  58 72 a6 72 b6 06 9d 93  a5                       |Xr.r.....|
 >>> Flow 8 (server to client)
-00000000  16 03 03 00 85 2f 7c ac  ad 05 49 3c 82 9c 82 20  |...../|...I<... |
-00000010  0d 77 42 bd 9d 90 c3 2f  ab c3 c2 60 a4 18 77 23  |.wB..../...`..w#|
-00000020  02 5b e8 e0 3a f3 b7 ee  b8 eb d8 7e c5 f6 52 9e  |.[..:......~..R.|
-00000030  d7 29 b8 1b 51 62 c0 b9  02 79 df 8a 3a 15 ec 74  |.)..Qb...y..:..t|
-00000040  9e 2d cf c9 b1 1f 0b d3  7a b5 95 4d 74 80 5a 31  |.-......z..Mt.Z1|
-00000050  57 f9 dc 03 be e5 d3 0b  2d 6e 55 1a 58 b4 43 a8  |W.......-nU.X.C.|
-00000060  c6 e2 d1 c1 26 30 f5 3e  25 13 b6 4d df de 16 fd  |....&0.>%..M....|
-00000070  fd 29 85 e8 7f bf 54 74  4d 40 9a 58 c9 d2 e6 af  |.)....TtM@.X....|
-00000080  e4 fe 8d fc 0f 2e bc 1a  70 25 16 03 03 02 69 23  |........p%....i#|
-00000090  0f f9 ff b3 8a ba 05 c3  be fb 3b 29 c5 4c 3f 2e  |..........;).L?.|
-000000a0  87 c5 2e ec 88 48 24 b7  25 a8 d2 b9 00 7b aa 4c  |.....H$.%....{.L|
-000000b0  bc 04 96 79 ed a3 e9 3d  cf 64 2b 7f 9c 6b b8 3a  |...y...=.d+..k.:|
-000000c0  53 c3 70 96 39 64 5d 65  c4 aa e3 88 18 7e f6 8c  |S.p.9d]e.....~..|
-000000d0  36 2b 9b 19 4e 91 40 a3  6c 49 f5 37 96 cb ec f1  |6+..N.@.lI.7....|
-000000e0  77 ea 92 dc 17 26 cd 7a  3a 94 30 6a 25 ec 98 6d  |w....&.z:.0j%..m|
-000000f0  87 ed 9b 30 1e c3 5a 40  84 93 34 a4 d3 5a d3 1b  |...0..Z@..4..Z..|
-00000100  10 94 9a 92 73 d3 6f 4d  81 72 08 5a dd 6f f0 cd  |....s.oM.r.Z.o..|
-00000110  ee 45 cf 16 40 a1 60 e8  f9 35 9a 8a 03 79 2f 7c  |.E..@.`..5...y/||
-00000120  4a 08 8d 3b a9 0f 9c f8  1e 86 b7 f5 e8 da 09 06  |J..;............|
-00000130  9b 1e f7 2d 58 22 2b d0  7d 3d 25 63 52 c4 20 e6  |...-X"+.}=%cR. .|
-00000140  a1 c5 37 52 af a2 32 a5  78 fb fb f6 d4 6c 58 cd  |..7R..2.x....lX.|
-00000150  3b 4d 0e b3 6c 7c 00 0a  dc 0e b6 7b f9 b7 42 7e  |;M..l|.....{..B~|
-00000160  0e a3 84 78 69 d5 9e 05  c1 17 4c d5 b0 5b 0a 5b  |...xi.....L..[.[|
-00000170  d1 27 dc 7c b6 44 a1 16  0c 97 80 18 2e 7b 5a fe  |.'.|.D.......{Z.|
-00000180  ca a4 05 36 76 6a a1 89  3e ad 1c 4a 60 7a 35 64  |...6vj..>..J`z5d|
-00000190  fb fc db 28 a9 96 68 86  8d 77 e9 c0 60 1d ed 18  |...(..h..w..`...|
-000001a0  9d 6f c4 4c e9 70 60 66  03 ef 28 99 f3 4b 93 03  |.o.L.p`f..(..K..|
-000001b0  06 ef be de 5a 85 de c0  9a 2f 45 f2 77 bd 2a e3  |....Z..../E.w.*.|
-000001c0  3d f3 6d 3b e8 20 f0 fd  a6 9a cf 43 cf 83 7e 77  |=.m;. .....C..~w|
-000001d0  4b 71 dc 8a d8 4d 85 a5  2d 84 3a ff 75 40 d8 7c  |Kq...M..-.:.u@.||
-000001e0  f4 2f ff 12 86 1a a6 9c  dc 28 28 0f 33 40 63 f8  |./.......((.3@c.|
-000001f0  de 3f 9d 7c ae 9f b9 3a  21 be e9 e7 ae 52 9b 85  |.?.|...:!....R..|
-00000200  2b a6 44 78 e1 23 7d 03  eb a4 c0 59 2d 0c d6 e4  |+.Dx.#}....Y-...|
-00000210  8f 6c 37 bc d5 0c 7f e5  28 e1 5a 0c 65 0b 57 c7  |.l7.....(.Z.e.W.|
-00000220  d2 61 13 b0 dc 19 4b a0  22 cc d9 1f 42 e9 3a 92  |.a....K."...B.:.|
-00000230  ce 4e 37 c9 1b 82 7c 0c  af b5 3f 5a a8 f4 c4 fb  |.N7...|...?Z....|
-00000240  fe dc 4a 19 32 da af aa  7c bf f7 2a b0 dc af ce  |..J.2...|..*....|
-00000250  c9 96 a1 30 b5 f8 4f 07  ca e6 db cd 71 c7 09 75  |...0..O.....q..u|
-00000260  0b 7d 30 d9 5d 02 b0 b7  ff fc 92 11 e0 1e 37 40  |.}0.].........7@|
-00000270  2f eb 50 8d 65 53 db 52  1c e8 42 2f 89 0d 61 cf  |/.P.eS.R..B/..a.|
-00000280  a0 a6 10 0f c7 05 c3 6a  32 eb b1 ca 26 f5 1d fc  |.......j2...&...|
-00000290  96 ec 55 f9 8a e6 05 13  d3 0a fb 74 6a 9a 3f 4f  |..U........tj.?O|
-000002a0  ca ce 4e 29 2f 46 4c ef  47 13 72 72 aa 46 c4 12  |..N)/FL.G.rr.F..|
-000002b0  9a a7 f1 90 b2 ea b2 09  d4 db 77 c7 31 7d 6c d6  |..........w.1}l.|
-000002c0  51 9f 97 91 f6 ba 0a fb  a7 63 3e 68 e3 f2 50 5d  |Q........c>h..P]|
-000002d0  b1 33 b8 8b f1 91 68 df  3f b3 9f 5d a7 b5 c1 93  |.3....h.?..]....|
-000002e0  bf 5d 8d 3e 90 05 88 bc  d9 43 d0 9d 25 17 c1 4a  |.].>.....C..%..J|
-000002f0  4a 7f e5 73 d5 0b d6 a5  16 03 03 00 bc 1d 81 1d  |J..s............|
-00000300  dd 11 fe e7 08 d4 0a 50  1a 15 75 a4 0b 49 03 96  |.......P..u..I..|
-00000310  8a 1f ba 30 e9 e3 55 c2  a7 27 cf 3a f6 4c 0a 3d  |...0..U..'.:.L.=|
-00000320  01 5a 08 9a 88 4d ac 0b  7c 84 5c 15 81 84 2d a7  |.Z...M..|.\...-.|
-00000330  8e 4b 92 0b 7c de e9 91  20 07 ca 16 cd 43 8f ec  |.K..|... ....C..|
-00000340  db 7a 16 c9 2c 19 25 23  07 01 4f 68 cc 09 af e0  |.z..,.%#..Oh....|
-00000350  cf d7 7c 2f e0 e7 65 3c  1a 24 c4 d8 b2 ae b9 25  |..|/..e<.$.....%|
-00000360  20 7b 26 e5 50 a6 e1 b0  a6 18 e1 67 79 f3 a9 f0  | {&.P......gy...|
-00000370  bf b1 16 34 47 75 f2 6c  2d 9c ce c4 c8 7b 7d c5  |...4Gu.l-....{}.|
-00000380  6f 19 3a 2f 3a 5b 3c ce  9f 8d a2 1d 77 ba 9d 15  |o.:/:[<.....w...|
-00000390  7a ee b4 88 62 f1 9e 04  4c be 48 ea 0f 2f e5 cf  |z...b...L.H../..|
-000003a0  c0 0b 11 0b 67 9e c7 1c  3d 6b da 86 31 b0 fb 9c  |....g...=k..1...|
-000003b0  55 94 18 26 7a 0e 9b e7  99 16 03 03 00 4a c4 b6  |U..&z........J..|
-000003c0  b8 bf cc 7e 5e 8f c4 a0  84 53 bd 28 e4 1d 47 48  |...~^....S.(..GH|
-000003d0  88 52 dc 46 46 e3 43 60  d2 90 62 c0 0f f5 37 5a  |.R.FF.C`..b...7Z|
-000003e0  31 4a b1 c8 45 80 b8 91  71 45 f7 64 08 ae c7 c7  |1J..E...qE.d....|
-000003f0  9c ab 03 57 fb d6 04 ff  11 3f be 41 a8 1e a6 d1  |...W.....?.A....|
-00000400  18 d7 ce 5d df 0a 12 d2  16 03 03 00 14 ea 34 3b  |...]..........4;|
-00000410  30 86 2c da 14 f5 a8 c4  0b 08 b9 1a c5 5c 7d ba  |0.,..........\}.|
-00000420  82                                                |.|
+00000000  16 03 03 00 85 8b 8d 61  42 37 50 ee 69 d8 fb e9  |.......aB7P.i...|
+00000010  89 a4 04 63 5d 87 a4 31  cc 22 26 c0 2c 22 1a 73  |...c]..1."&.,".s|
+00000020  cc f0 9f be 65 c4 e0 ad  6d b0 b5 d3 86 2c 0b 59  |....e...m....,.Y|
+00000030  e6 ae 58 38 b5 5f 4f 6e  7c ec e9 27 23 5f 4a 92  |..X8._On|..'#_J.|
+00000040  78 5f cc 9f 7f 2b bb 2c  dd 04 17 ea d4 87 b9 6d  |x_...+.,.......m|
+00000050  d0 1e 35 01 b4 4d 5d 73  6a 9f de 1d 71 47 78 d6  |..5..M]sj...qGx.|
+00000060  89 dc c2 d6 5c 69 0c dc  bb 7b 59 60 56 47 e9 5c  |....\i...{Y`VG.\|
+00000070  04 3e 3c 93 18 9b 40 4b  95 1f 20 e3 17 c6 ab 35  |.><...@K.. ....5|
+00000080  db 3f 88 d7 4b 89 5a 53  b7 a9 16 03 03 02 69 85  |.?..K.ZS......i.|
+00000090  49 cc 00 5a 45 40 9d be  80 06 97 16 a0 c0 dc bb  |I..ZE@..........|
+000000a0  32 62 18 88 31 3b 14 ec  9d f2 3f ed c0 36 ad bb  |2b..1;....?..6..|
+000000b0  69 fa 32 f5 13 54 2b 77  f3 db 6e 20 0a 2b 5c a5  |i.2..T+w..n .+\.|
+000000c0  d8 aa 5a 63 8d c1 51 50  41 f6 6c f7 ef 2f 15 81  |..Zc..QPA.l../..|
+000000d0  85 af 6e e5 01 95 9a 5e  70 26 cb c1 c8 89 3f b8  |..n....^p&....?.|
+000000e0  3d 5a 1b 68 a6 25 08 48  ad dd 29 db bf ce 75 44  |=Z.h.%.H..)...uD|
+000000f0  ca cd 92 79 47 d8 25 f1  23 9a 63 62 15 05 d8 2c  |...yG.%.#.cb...,|
+00000100  c0 30 a4 65 a7 f9 89 a4  fe 87 32 21 07 24 d9 16  |.0.e......2!.$..|
+00000110  64 26 48 75 ab a7 00 e1  9b 48 5c 77 3d 66 18 69  |d&Hu.....H\w=f.i|
+00000120  35 a9 4c 03 f5 9f 42 ff  50 98 73 b1 82 16 fd ff  |5.L...B.P.s.....|
+00000130  94 fd aa 3c 46 1f b5 99  fd de ab 2e 6a 24 00 5a  |...<F.......j$.Z|
+00000140  33 82 e1 65 4c 1b e8 6f  70 8d 79 c7 50 76 06 30  |3..eL..op.y.Pv.0|
+00000150  d5 13 c5 77 00 54 57 16  55 1b cb 10 4b 62 37 ae  |...w.TW.U...Kb7.|
+00000160  76 7e da 97 6c ad bd 67  b2 34 bc 82 f1 09 e2 d4  |v~..l..g.4......|
+00000170  87 6c 5e e7 cd 70 99 57  c7 2f b3 72 ec 7e d1 b6  |.l^..p.W./.r.~..|
+00000180  00 04 32 1d 86 5f ef 55  98 41 68 e8 9d 6c f4 2d  |..2.._.U.Ah..l.-|
+00000190  fb 36 5d 89 02 b2 b9 2b  40 89 88 44 7c 72 6f 1f  |.6]....+@..D|ro.|
+000001a0  9e 42 95 8d 5c 7b 59 b3  47 1d 84 7c 68 21 6a 32  |.B..\{Y.G..|h!j2|
+000001b0  16 06 e0 53 88 35 35 88  25 e6 46 2d 8c b7 d1 52  |...S.55.%.F-...R|
+000001c0  6e dd e7 a2 7b 60 41 54  03 9f c7 60 99 10 4d 89  |n...{`AT...`..M.|
+000001d0  52 4d e3 f1 12 f1 35 a0  f6 02 7d 6e 30 28 d8 75  |RM....5...}n0(.u|
+000001e0  18 34 9d 0d 10 e2 05 58  b1 98 e8 ae ab db a1 e6  |.4.....X........|
+000001f0  88 dc ac 71 ac 63 ad 60  29 f5 8c 60 b7 db b6 b6  |...q.c.`)..`....|
+00000200  60 44 a3 c5 bb 70 1b ac  d7 4b 06 a0 e4 db 62 30  |`D...p...K....b0|
+00000210  20 58 3c a8 70 78 84 ef  d9 21 77 bd 3f 70 29 67  | X<.px...!w.?p)g|
+00000220  35 4d cc 20 a0 b0 86 c8  11 dd dc 71 b4 73 0a ba  |5M. .......q.s..|
+00000230  b3 64 6e 1d e7 ed 48 ac  b4 8a 7c 23 2a 00 a1 45  |.dn...H...|#*..E|
+00000240  1b 1b 91 df 24 a5 2b d7  3c 8a 35 3f fb 75 cc b6  |....$.+.<.5?.u..|
+00000250  7c 86 9f c5 25 1d 54 d1  28 c4 53 fb e6 37 01 85  ||...%.T.(.S..7..|
+00000260  80 cc e5 04 70 9f 6c a3  26 60 cc ce 48 7a 8f fa  |....p.l.&`..Hz..|
+00000270  dc 84 0f bd ad 72 33 a6  a0 f7 67 50 31 77 bd e4  |.....r3...gP1w..|
+00000280  cb d5 7f cf b7 d3 70 ae  7a 70 fa 0b 3d 19 ae 67  |......p.zp..=..g|
+00000290  7e 08 0f 8d c9 77 f7 88  38 1a 1a 1c 36 6e db 36  |~....w..8...6n.6|
+000002a0  5f 70 19 5a a6 15 fc 24  05 a5 30 6d fe a4 25 0b  |_p.Z...$..0m..%.|
+000002b0  8a 14 d4 b0 c9 8f 6e fd  02 e4 7b af f8 11 0d d3  |......n...{.....|
+000002c0  45 fe 4f 41 4f e3 26 aa  4a 58 36 02 d8 d0 d3 4e  |E.OAO.&.JX6....N|
+000002d0  ca e1 0a b2 d4 37 d6 dd  19 d2 7c bd 97 16 8d 47  |.....7....|....G|
+000002e0  87 e7 09 13 e2 ec 89 f5  3a 17 47 36 68 00 58 b4  |........:.G6h.X.|
+000002f0  3d fc db 65 23 e9 2a 3e  16 03 03 00 bc e3 05 22  |=..e#.*>......."|
+00000300  3d 8d 48 5d 28 cd ae 94  db 95 2e a6 44 77 da d5  |=.H](.......Dw..|
+00000310  a1 09 7c a3 4c 3f a6 18  80 92 cf 5c 77 9d 18 5d  |..|.L?.....\w..]|
+00000320  43 78 05 bb cb 8e 27 7c  cc 2e 9c 54 95 ff 1c 74  |Cx....'|...T...t|
+00000330  48 fb df 47 e8 e1 24 94  94 5d cc 2c b2 df 48 6c  |H..G..$..].,..Hl|
+00000340  22 1e 61 f1 e3 c6 56 fb  79 70 b0 ab c5 70 ca 7f  |".a...V.yp...p..|
+00000350  c0 32 8d 6d a5 55 6d 94  8c 7b 9d da 0b 35 d1 da  |.2.m.Um..{...5..|
+00000360  77 85 01 66 15 be 10 c3  3c 9b 80 61 b3 c0 1a 29  |w..f....<..a...)|
+00000370  22 d1 d1 ba 4a ea 01 58  72 94 79 f0 6e 5f 36 23  |"...J..Xr.y.n_6#|
+00000380  8a cf 16 fa 2c 5f 6d dd  54 61 df bc 6f 91 d4 df  |....,_m.Ta..o...|
+00000390  e7 6f 50 8f 9c 27 04 04  19 80 10 a2 8d a5 61 81  |.oP..'........a.|
+000003a0  06 1f b0 79 87 c0 95 87  f7 d8 87 22 75 a5 87 30  |...y......."u..0|
+000003b0  f4 33 6d cb 59 f7 18 75  0f 16 03 03 00 4a d3 e9  |.3m.Y..u.....J..|
+000003c0  2e 47 65 f2 29 70 4c 74  3f e9 13 88 e7 66 c6 73  |.Ge.)pLt?....f.s|
+000003d0  0f e4 7a 8f 0e 49 49 39  90 e7 ff d4 1f 8a d6 c6  |..z..II9........|
+000003e0  91 16 f6 a6 fe 60 d8 ba  26 a6 5e 44 f5 76 88 63  |.....`..&.^D.v.c|
+000003f0  10 d0 89 2f 6b ae 55 64  13 0c 63 76 69 df 6a 4a  |.../k.Ud..cvi.jJ|
+00000400  74 15 51 0b 4d 74 db 49  16 03 03 00 14 f2 0f e7  |t.Q.Mt.I........|
+00000410  38 90 33 ff 5e 20 60 42  32 40 72 2c c8 70 d7 ba  |8.3.^ `B2@r,.p..|
+00000420  a1                                                |.|
 >>> Flow 9 (client to server)
-00000000  16 03 03 02 69 ee f1 51  ac 2b 75 2a 6b 31 f9 25  |....i..Q.+u*k1.%|
-00000010  5a 00 97 42 02 d8 b8 e0  2a a6 0f c2 eb 89 75 42  |Z..B....*.....uB|
-00000020  4c 94 81 59 d0 26 4b e4  51 0a 77 ac bd bc 84 8e  |L..Y.&K.Q.w.....|
-00000030  fa 68 9c 1c 38 90 08 35  96 d2 7e e9 ef 8d 00 78  |.h..8..5..~....x|
-00000040  1e 30 cd 92 df 44 d8 89  fc e5 ce 65 43 65 be db  |.0...D.....eCe..|
-00000050  92 5e 56 0c 8e 86 cf 8f  62 4c 9a a2 ab 8b 0c f6  |.^V.....bL......|
-00000060  13 b4 57 76 fb c4 de b1  68 1c ca c1 23 3d 0d 6a  |..Wv....h...#=.j|
-00000070  be ab 0f 03 19 3a 8c 36  0a ed 1c 2b 59 7a b5 f2  |.....:.6...+Yz..|
-00000080  9c 29 0b e1 ab 74 ad b4  fc f9 ab 18 bf b0 3d 5e  |.)...t........=^|
-00000090  57 70 be 2f 57 7c cc cd  4b 0d e3 c7 d6 74 d8 ae  |Wp./W|..K....t..|
-000000a0  79 b1 f8 aa 28 b7 a4 c7  27 77 a0 20 69 81 f6 a2  |y...(...'w. i...|
-000000b0  76 bc 96 fd 2d 03 9c 97  21 5d ea 50 82 5a 6d 00  |v...-...!].P.Zm.|
-000000c0  7a 80 19 09 4b 4a 8c cc  f4 b4 74 62 60 b6 71 44  |z...KJ....tb`.qD|
-000000d0  d5 06 e0 79 45 cc 78 4a  ee 4c d6 bb 96 70 ac cb  |...yE.xJ.L...p..|
-000000e0  3e 94 d6 46 a3 96 15 4f  70 f0 1a 61 13 ec 6d 0d  |>..F...Op..a..m.|
-000000f0  be ce cd c7 ee 5e c8 ae  cf 1f f1 43 dd 29 21 8b  |.....^.....C.)!.|
-00000100  f1 f0 32 5a 4d 02 09 7f  c0 15 be 33 aa eb 55 97  |..2ZM......3..U.|
-00000110  ea 74 02 dd 74 22 40 b5  33 7d cf ca be 07 0d cb  |.t..t"@.3}......|
-00000120  82 a4 62 56 b1 68 f8 25  d7 1d 57 31 83 cc 7b e9  |..bV.h.%..W1..{.|
-00000130  8a 9f d5 b5 d1 99 da 4b  55 87 c2 d3 99 ea 34 3c  |.......KU.....4<|
-00000140  01 61 5e d4 f2 4a 40 b4  ff 4b eb 68 c7 5e a7 7b  |.a^..J@..K.h.^.{|
-00000150  cf d6 2d 99 ea 6d df a8  b3 74 d1 ad 22 22 81 ae  |..-..m...t..""..|
-00000160  58 a6 1b 87 cb 75 d7 2c  5b a6 4e 04 28 fb f7 6e  |X....u.,[.N.(..n|
-00000170  2a 52 c9 19 21 d8 3c ee  0c 8d 0c 55 d9 7a 1f 75  |*R..!.<....U.z.u|
-00000180  1e 14 4f c2 7c e3 a1 b7  bd 23 32 40 68 d7 9f d7  |..O.|....#2@h...|
-00000190  bc e4 57 62 d2 ba 95 3f  1a c0 2f cf 31 6b 41 e6  |..Wb...?../.1kA.|
-000001a0  92 91 91 6f 49 4b 42 fb  ae e2 82 c2 ac 5b 5d 0f  |...oIKB......[].|
-000001b0  f1 9f e7 18 9d 1d 35 f6  6f 51 d2 05 ed a2 ab 55  |......5.oQ.....U|
-000001c0  38 19 ec 37 ac f2 25 1d  6c 9e f7 30 87 98 03 96  |8..7..%.l..0....|
-000001d0  d6 ae dd 39 74 8f 39 c9  b8 5c aa b2 88 60 5d 96  |...9t.9..\...`].|
-000001e0  7e 3f fe 21 91 41 e1 e9  88 8c 63 20 dc 8d 60 7f  |~?.!.A....c ..`.|
-000001f0  29 36 bd 81 7f 90 48 47  e4 d1 c1 f6 07 06 4f 5d  |)6....HG......O]|
-00000200  2e fa ba e7 8c 57 0d f7  82 80 31 68 a3 78 f9 73  |.....W....1h.x.s|
-00000210  2d 31 0a 76 b1 08 5e 28  af 97 e9 4f 00 b3 eb 99  |-1.v..^(...O....|
-00000220  81 0a 2f 64 53 24 63 eb  16 10 67 97 77 e4 52 98  |../dS$c...g.w.R.|
-00000230  13 d2 bb a5 26 6a 4a c9  6d 9a f7 4c 99 af 05 3b  |....&jJ.m..L...;|
-00000240  da 91 d0 1e bf bc e7 49  90 1e 9f 56 03 38 77 28  |.......I...V.8w(|
-00000250  a2 78 ca 38 51 ec a4 96  70 f2 23 24 ef d2 5e 70  |.x.8Q...p.#$..^p|
-00000260  d0 12 d8 f7 75 64 66 be  f9 30 40 13 30 ca 16 03  |....udf..0@.0...|
-00000270  03 00 35 2e 74 d1 77 b1  56 b9 b6 33 07 39 6d 6b  |..5.t.w.V..3.9mk|
-00000280  c9 c0 9e b1 35 5b 1c 5e  8b c7 15 b8 12 90 3f 62  |....5[.^......?b|
-00000290  01 4a bd 93 2e 5d 0b 6f  9a 33 f3 0f f3 ce 8b 6e  |.J...].o.3.....n|
-000002a0  a2 fb 81 8b 69 9a 3b db  16 03 03 00 98 70 68 40  |....i.;......ph@|
-000002b0  c3 43 46 fc 9b 8a 1d 3f  e2 00 0e e3 a5 a1 d3 b3  |.CF....?........|
-000002c0  4e 99 01 15 d1 91 6c be  4d 05 17 f9 67 14 f5 03  |N.....l.M...g...|
-000002d0  86 f0 f3 c1 b4 74 8d dc  d5 74 d7 b1 f3 f7 5c b1  |.....t...t....\.|
-000002e0  12 20 5e 64 aa e5 fa b4  d5 dd 34 29 42 a4 4e 46  |. ^d......4)B.NF|
-000002f0  9a e0 98 a7 9a 6c c1 b0  bc d7 4d b9 a8 1c 8d 51  |.....l....M....Q|
-00000300  5b 11 bd a3 a9 1c d7 c7  d2 c7 e1 04 a0 6c be a0  |[............l..|
-00000310  74 81 e1 9f f3 a6 ac dc  e6 ac 76 46 03 28 d3 b1  |t.........vF.(..|
-00000320  ab a9 77 b0 84 f2 61 ff  39 a0 e5 09 a0 ad fa 41  |..w...a.9......A|
-00000330  a9 09 4d fb 3f 46 11 73  71 cd 80 1b 1f 5a 43 c9  |..M.?F.sq....ZC.|
-00000340  b0 b0 df 4a 03 14 03 03  00 11 d1 98 c3 73 d0 be  |...J.........s..|
-00000350  45 ea 73 e7 71 1c 78 97  4a b9 05 16 03 03 00 20  |E.s.q.x.J...... |
-00000360  5e e3 1f 19 aa 89 11 71  09 fb 4c f4 36 d4 3a 4b  |^......q..L.6.:K|
-00000370  3e 89 3c 78 99 1a 63 7b  45 22 55 39 74 7f d6 5f  |>.<x..c{E"U9t.._|
+00000000  16 03 03 02 69 78 39 27  1a 64 94 f7 9c 64 ac 37  |....ix9'.d...d.7|
+00000010  28 be d0 a4 74 98 34 51  8e 3b c7 14 02 83 ee a5  |(...t.4Q.;......|
+00000020  05 55 59 f8 04 43 59 cd  33 e6 c4 44 57 30 68 db  |.UY..CY.3..DW0h.|
+00000030  b2 cb 50 db c1 e6 c4 04  a3 79 22 40 15 f9 89 57  |..P......y"@...W|
+00000040  7b 7a 68 d6 d1 15 c9 7f  6b d8 3a 6c dc 32 4f 72  |{zh.....k.:l.2Or|
+00000050  97 57 32 25 f9 78 e6 07  91 f4 45 67 b1 41 dd f9  |.W2%.x....Eg.A..|
+00000060  5b fd 76 53 d5 7d 0f 74  6e 2e ea d9 9c 2d 00 39  |[.vS.}.tn....-.9|
+00000070  2f 7f 49 97 24 bf e4 f2  c7 7e 21 f9 dd 30 3a 78  |/.I.$....~!..0:x|
+00000080  3c 53 41 58 5c 97 3a ff  6f 60 f4 b6 d6 23 a9 ad  |<SAX\.:.o`...#..|
+00000090  6f 5d e8 cb eb d6 87 e1  44 98 4a a0 31 9c af f0  |o]......D.J.1...|
+000000a0  55 cb 04 b8 74 7b f4 bc  0b d1 e7 15 43 ef f7 e6  |U...t{......C...|
+000000b0  dc bd 28 f8 3a af c6 02  a1 95 88 f1 36 f2 35 48  |..(.:.......6.5H|
+000000c0  99 04 06 fd 42 9e 8d 28  8f 98 a2 a8 b5 69 90 05  |....B..(.....i..|
+000000d0  76 62 69 a2 4c 11 59 06  20 3e 9a 63 f4 8a fd da  |vbi.L.Y. >.c....|
+000000e0  6c b5 0d 0c d3 c6 6d 47  2e a8 3a d8 ec fd d3 42  |l.....mG..:....B|
+000000f0  ef 8b e8 75 a6 04 06 3b  5e 57 ae a3 10 2e 6d 01  |...u...;^W....m.|
+00000100  0e ea 94 e6 78 1b 91 f0  a0 1e 55 d3 25 13 15 ac  |....x.....U.%...|
+00000110  eb a4 7c c3 66 83 62 00  a3 d2 f5 7c 64 c6 39 fb  |..|.f.b....|d.9.|
+00000120  6d ee 01 50 d4 13 5d 10  5f 31 30 09 90 91 64 ad  |m..P..]._10...d.|
+00000130  f1 c5 4b ed 9d ef 2a 71  e5 7a b2 5d a8 57 bc b8  |..K...*q.z.].W..|
+00000140  1f 32 c6 f0 61 f0 08 9e  07 9b d3 99 5b 5e a5 32  |.2..a.......[^.2|
+00000150  1f 8a f7 30 1f e9 e6 39  b1 5a c6 a5 22 c8 98 49  |...0...9.Z.."..I|
+00000160  04 f2 58 4d e2 15 e6 cd  d1 2b 05 54 81 cc b8 33  |..XM.....+.T...3|
+00000170  5d 26 52 65 95 32 84 01  f6 05 fa 19 58 c6 57 53  |]&Re.2......X.WS|
+00000180  c8 d7 3d ef 56 4e 6e e4  17 45 1c bc 40 ee 06 32  |..=.VNn..E..@..2|
+00000190  60 74 9e 62 02 47 52 a8  92 57 26 1f ba 2d 93 67  |`t.b.GR..W&..-.g|
+000001a0  94 46 0f c4 0d f5 df 75  b0 d9 27 02 56 f3 82 e1  |.F.....u..'.V...|
+000001b0  da 1c 3b 3e 97 93 c8 2d  12 bd b4 5b 36 7a 5c bf  |..;>...-...[6z\.|
+000001c0  27 9a 75 11 f9 4d 9b c0  ae 6b be 71 5f 37 33 b5  |'.u..M...k.q_73.|
+000001d0  4e d4 5a fb 98 71 c5 77  8c fc e2 f3 91 73 35 f4  |N.Z..q.w.....s5.|
+000001e0  e7 13 b1 ea bd c2 a9 46  b9 ea 88 06 58 a2 49 a2  |.......F....X.I.|
+000001f0  97 2b cf 1b 25 a3 71 a0  22 95 4c 54 81 eb 41 7f  |.+..%.q.".LT..A.|
+00000200  80 15 82 ec 19 0c f8 a3  21 fe 37 2e e1 ca 34 02  |........!.7...4.|
+00000210  5d ec 78 d9 eb 99 93 5d  96 26 cd 4c 56 3a 35 6a  |].x....].&.LV:5j|
+00000220  7f d0 0c c7 b7 c3 80 c6  fe d0 04 54 00 8c 4c 8b  |...........T..L.|
+00000230  43 f4 36 b8 ea 51 35 3c  5e b5 b9 45 dc d2 19 bd  |C.6..Q5<^..E....|
+00000240  d2 2a 95 bc 7f 22 43 4f  84 be bd 7b ab a8 5c 4d  |.*..."CO...{..\M|
+00000250  28 99 e6 e5 05 33 05 38  be 17 55 80 2d e1 de cf  |(....3.8..U.-...|
+00000260  39 4e 5b 7d 89 b4 a6 d3  0a e3 fd 47 e1 2c 16 03  |9N[}.......G.,..|
+00000270  03 00 35 f3 2d 2c 7b fa  06 39 06 40 27 5b ea 9e  |..5.-,{..9.@'[..|
+00000280  2f 4a 6c 32 df 62 c3 bc  af ed 21 6a 1a 34 82 cf  |/Jl2.b....!j.4..|
+00000290  73 e5 b9 1d 8d 42 3d 8e  b7 e6 1c 0a e0 81 3e cd  |s....B=.......>.|
+000002a0  88 23 f3 56 55 09 e2 6e  16 03 03 00 98 73 0f 59  |.#.VU..n.....s.Y|
+000002b0  0e 1b 1b d1 db db 6d 47  d9 05 f8 e1 29 32 e5 16  |......mG....)2..|
+000002c0  f9 f6 24 2b 0f 2d bb 74  da fd 75 9b ec 6a 3f 02  |..$+.-.t..u..j?.|
+000002d0  c8 3a ab 23 ec cb 77 c6  d7 7b ba ce 29 85 66 54  |.:.#..w..{..).fT|
+000002e0  ab df c9 74 2a 50 b5 cd  45 03 e2 ce 6f d3 d0 f1  |...t*P..E...o...|
+000002f0  1a 3e e4 c0 34 72 e1 53  1e 69 9a d7 41 4f d4 3a  |.>..4r.S.i..AO.:|
+00000300  31 af 1a 0b 83 82 e7 6c  4f f6 9a d5 84 bb 9a 14  |1......lO.......|
+00000310  e3 ec 04 12 c8 83 9c c8  d9 81 c1 c9 16 db 35 6e  |..............5n|
+00000320  0f af a0 b3 e6 a9 2b ad  a5 1f cd a0 fb 45 01 84  |......+......E..|
+00000330  ae b5 42 49 21 d8 29 06  0a 0e e8 26 8e f4 f1 56  |..BI!.)....&...V|
+00000340  c2 7c 8f d6 4a 14 03 03  00 11 c6 06 37 68 e0 2b  |.|..J.......7h.+|
+00000350  dd 32 2a b5 c7 b6 ad e2  c8 7c d8 16 03 03 00 20  |.2*......|..... |
+00000360  1d 80 95 df 2d d3 38 50  a2 2d bc 09 50 e4 e8 47  |....-.8P.-..P..G|
+00000370  5f 3e 26 03 5e d3 9b 5a  ee ed d4 bb cb da 05 5b  |_>&.^..Z.......[|
 >>> Flow 10 (server to client)
-00000000  14 03 03 00 11 f4 04 c6  5c 08 6d 53 9b 6e 59 7f  |........\.mS.nY.|
-00000010  75 c7 d9 a9 95 24 16 03  03 00 20 f3 82 ea ea a8  |u....$.... .....|
-00000020  ee 3f 83 7f f4 1e 31 d8  66 32 b7 d9 46 13 ac b5  |.?....1.f2..F...|
-00000030  cc b0 e6 ac 06 4f 65 3b  2e 57 f6 17 03 03 00 19  |.....Oe;.W......|
-00000040  c7 c9 1c 1c 64 a0 c0 90  03 96 5e 94 60 79 f0 85  |....d.....^.`y..|
-00000050  e7 41 db ca 6e 21 5a dd  2a                       |.A..n!Z.*|
+00000000  14 03 03 00 11 13 75 b3  44 ec 4c 6b 24 d3 52 90  |......u.D.Lk$.R.|
+00000010  28 c1 47 92 5c 0d 16 03  03 00 20 c2 61 ed 34 d2  |(.G.\..... .a.4.|
+00000020  c5 cf fd b3 31 3d 1d 5f  30 87 18 65 01 47 da 0f  |....1=._0..e.G..|
+00000030  d9 eb 4f 0f 50 2e 02 86  fe eb 13 17 03 03 00 19  |..O.P...........|
+00000040  3f ac 26 1c 16 0e 16 bf  b1 d3 80 86 dd c6 e2 b6  |?.&.............|
+00000050  3f 5a 0b 0c 3e 7d 3b a8  d5                       |?Z..>};..|
 >>> Flow 11 (client to server)
-00000000  15 03 03 00 12 7a a9 2e  4b 21 84 78 cb 46 52 f3  |.....z..K!.x.FR.|
-00000010  f9 8e 75 3b 7e 77 a1                              |..u;~w.|
+00000000  15 03 03 00 12 ea 81 9d  df ec c1 0c 3d 21 8b fe  |............=!..|
+00000010  b5 24 d8 92 43 1d 3d                              |.$..C.=|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice
index 1c7fadb2cd..e83ad4b285 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 c5 11 e0 7f 6f  |....]...Y......o|
-00000010  86 2d f5 8f c2 ba 8b a7  1e 15 94 51 e1 d0 ab 40  |.-.........Q...@|
-00000020  37 5b 68 a7 ee 6f de ae  d2 4b b2 20 a8 02 85 68  |7[h..o...K. ...h|
-00000030  2c 18 6b 1a 6c ba 64 81  8a 0f 72 a6 a3 3a 1a ee  |,.k.l.d...r..:..|
-00000040  6a 9a d6 9a ce 03 78 11  11 b6 fa 7a cc a8 00 00  |j.....x....z....|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 36 29 60 e0 b5  |....]...Y..6)`..|
+00000010  ee 59 a6 3b 1a de 96 8a  51 0c c1 15 30 ce 6a 70  |.Y.;....Q...0.jp|
+00000020  ca 5b fa a5 86 f4 59 79  44 cd 73 20 ad b7 a9 d5  |.[....YyD.s ....|
+00000030  c1 aa a6 49 6d a8 36 a9  bf 40 1e 3a d4 2c 21 4a  |...Im.6..@.:.,!J|
+00000040  5d aa fa 75 80 d4 cb fc  be 2b 41 36 cc a8 00 00  |]..u.....+A6....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -63,290 +62,290 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 42 e7 5a  |............ B.Z|
-000002d0  6b 3f 36 51 1f 06 45 c8  de 17 f8 19 9c a2 cb bb  |k?6Q..E.........|
-000002e0  89 52 59 e0 1a d5 c4 1e  42 0c 9b 93 14 08 04 00  |.RY.....B.......|
-000002f0  80 cb 39 db 19 17 fd 12  ec 25 87 ce d2 76 8c c7  |..9......%...v..|
-00000300  aa 30 e3 50 0c 22 a6 73  d0 e5 b0 b6 b6 3c 5a ab  |.0.P.".s.....<Z.|
-00000310  11 97 35 e6 ff de d4 19  46 20 5f 78 33 1c c4 24  |..5.....F _x3..$|
-00000320  48 2d 6a c0 f4 07 d4 5c  8b b6 a3 8c eb 99 e9 70  |H-j....\.......p|
-00000330  d8 46 43 00 3b 1c 4e 37  52 c8 92 57 21 ee c7 af  |.FC.;.N7R..W!...|
-00000340  f0 19 8b 2b f8 c0 e3 1a  79 13 17 fb 14 ed 5c 82  |...+....y.....\.|
-00000350  a9 77 05 b3 3d 25 92 07  3f f5 38 6d dc 86 ce 44  |.w..=%..?.8m...D|
-00000360  3c b7 72 da aa 0c 78 b8  22 bf ef af cf d4 81 bc  |<.r...x.".......|
-00000370  11 16 03 03 00 04 0e 00  00 00                    |..........|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 f1 5a 89  |............ .Z.|
+000002d0  7f 84 c0 86 59 fb ca 59  19 b9 7b e8 96 ba 5a fc  |....Y..Y..{...Z.|
+000002e0  3f 2d b5 0f 2f 0e a3 5c  4a 04 1f 55 1a 08 04 00  |?-../..\J..U....|
+000002f0  80 c9 fe 35 a0 c1 cc a5  ea f9 5a 8d 92 b8 e6 cd  |...5......Z.....|
+00000300  5e 56 70 9c e1 de fe 69  73 b8 3c 97 86 6f e1 2a  |^Vp....is.<..o.*|
+00000310  e7 f4 12 fb b8 32 fd 5b  09 80 f8 0f ba 59 ed c4  |.....2.[.....Y..|
+00000320  86 07 33 e9 57 01 49 f8  cb 2d b4 16 07 e7 78 12  |..3.W.I..-....x.|
+00000330  3f e6 b4 d1 21 99 bc d5  cf 93 76 2c 24 18 d1 4d  |?...!.....v,$..M|
+00000340  c4 6c 3f 1c c6 1a fe 04  5a 3e 7b 57 cd 8b 84 2a  |.l?.....Z>{W...*|
+00000350  85 0d b0 5f bf a5 8e 74  55 72 dc 2c 5c 60 52 93  |..._...tUr.,\`R.|
+00000360  1e 28 9d 36 9f fd da a5  3b 51 96 4e 12 d6 d4 ca  |.(.6....;Q.N....|
+00000370  d3 16 03 03 00 04 0e 00  00 00                    |..........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 c0 2e 41  33 99 c3 00 90 54 c8 ea  |.... ..A3....T..|
-00000040  64 b2 f5 74 5d 3c b8 eb  0c 6e 12 bb 96 01 13 46  |d..t]<...n.....F|
-00000050  1f 7d e9 3a 15                                    |.}.:.|
+00000030  16 03 03 00 20 e4 80 79  12 42 80 88 c3 66 6b 9b  |.... ..y.B...fk.|
+00000040  a2 03 59 f9 a3 54 2f 7f  03 de 90 97 1d cb 48 08  |..Y..T/.......H.|
+00000050  19 a4 bb 13 64                                    |....d|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 50 98 09 8a ad  |.......... P....|
-00000010  b9 ba cb d8 d2 5c a8 69  86 da 30 da 39 ed 3b db  |.....\.i..0.9.;.|
-00000020  5c eb 34 08 4c ca 51 b2  63 0e 08                 |\.4.L.Q.c..|
+00000000  14 03 03 00 01 01 16 03  03 00 20 9e 59 22 68 f2  |.......... .Y"h.|
+00000010  3c 38 7d cf 43 eb 77 73  94 6c 35 e5 3f 3e 7e 03  |<8}.C.ws.l5.?>~.|
+00000020  29 96 e8 c6 f7 5c b4 39  c3 77 61                 |)....\.9.wa|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 62 a6 a2  7c 1a 5e 4b 4e 58 86 12  |.....b..|.^KNX..|
-00000010  35 8b 6e d9 00 b0 f2 31  46 e6 2a                 |5.n....1F.*|
+00000000  17 03 03 00 16 ec 02 9b  89 68 8b 8a c6 e1 36 f1  |.........h....6.|
+00000010  4a b7 c4 d5 63 0a e8 d9  2c 1f ce                 |J...c...,..|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 14 b0 3a a3  b6 16 b7 9f 65 f8 7f 64  |......:.....e..d|
-00000010  8d 4c 73 1f 41 1b b0 5c  65                       |.Ls.A..\e|
+00000000  16 03 03 00 14 a8 ab 9e  3c 00 e4 6f b3 26 dd 3a  |........<..o.&.:|
+00000010  67 ab ee 28 a0 a1 65 83  91                       |g..(..e..|
 >>> Flow 7 (client to server)
-00000000  16 03 03 01 38 a3 ce 00  8f a3 63 85 d9 cd 78 93  |....8.....c...x.|
-00000010  55 94 fc 68 84 5c fc c5  a3 c3 d1 cc 09 83 e0 a0  |U..h.\..........|
-00000020  b2 b7 d4 10 6f aa 32 99  a5 53 e0 c0 ae 8c 6a e2  |....o.2..S....j.|
-00000030  90 8f 46 ac 71 ce 4e 4f  0a 29 cd 70 ed 8a cc 1e  |..F.q.NO.).p....|
-00000040  53 de d1 75 72 a2 06 36  28 6e fd d0 60 00 ff c6  |S..ur..6(n..`...|
-00000050  a8 18 1e f8 1c 1a 7d e9  d8 16 36 a4 42 d5 59 ad  |......}...6.B.Y.|
-00000060  d9 01 45 e4 03 8b c8 f3  b7 2f 0f 77 62 69 ad 35  |..E....../.wbi.5|
-00000070  16 ef 99 94 7f af 7c f5  44 19 99 65 97 d3 15 af  |......|.D..e....|
-00000080  82 06 1d 80 ab 55 51 70  c7 23 15 5b 00 fb 93 e6  |.....UQp.#.[....|
-00000090  5e 06 c9 db 87 98 af 0b  38 68 5f 0a 06 35 2b bd  |^.......8h_..5+.|
-000000a0  15 04 57 e6 1c 70 35 b3  2a 16 c7 f6 7e 3b bf d7  |..W..p5.*...~;..|
-000000b0  3f f6 35 bd a9 cc 6d aa  75 b4 16 6d 81 0e 34 ab  |?.5...m.u..m..4.|
-000000c0  2e de e7 4a 2e 13 69 c5  c2 e2 2d 38 e6 3f 8a f4  |...J..i...-8.?..|
-000000d0  d5 6a a2 9d 28 a7 98 30  e3 9a 8a 86 15 e6 00 45  |.j..(..0.......E|
-000000e0  63 43 1d 28 b0 24 39 06  5e cb cb eb a1 cc 75 f3  |cC.(.$9.^.....u.|
-000000f0  18 e4 d0 e6 49 0b 00 5d  67 18 35 52 b4 fa ec 9a  |....I..]g.5R....|
-00000100  6a 26 1b f8 38 ef f4 be  30 ef af bb bb 3f 28 a2  |j&..8...0....?(.|
-00000110  0e 17 48 a6 3c d1 73 a7  45 12 4e 7e b2 87 e2 4a  |..H.<.s.E.N~...J|
-00000120  92 6e 26 3a f5 17 08 87  7b 34 bc 11 36 51 5f 0b  |.n&:....{4..6Q_.|
-00000130  e4 05 a9 b7 a5 bd 51 fa  77 e3 72 31 84           |......Q.w.r1.|
+00000000  16 03 03 01 34 d8 7e 6c  f6 7b d5 eb 3f 49 63 78  |....4.~l.{..?Icx|
+00000010  28 92 1c 8b 67 f2 70 a7  ff e2 91 42 43 d8 90 4e  |(...g.p....BC..N|
+00000020  01 47 0a 12 bb 9d a2 9a  e1 a2 d6 ee 5e 91 8c 4d  |.G..........^..M|
+00000030  86 8e 29 d4 e0 b3 67 0f  c4 5e a9 02 c9 e3 8f f0  |..)...g..^......|
+00000040  e6 ea 24 50 da 57 70 35  58 98 81 3e ff b8 8d ea  |..$P.Wp5X..>....|
+00000050  b3 e0 f0 a1 91 39 69 33  40 bc 0f 67 21 10 67 f4  |.....9i3@..g!.g.|
+00000060  93 66 0c f2 66 aa fd a5  2c 8d 2b 38 31 30 b3 50  |.f..f...,.+810.P|
+00000070  71 09 de ce 22 59 c3 96  5a 07 84 c0 1f 96 5c e3  |q..."Y..Z.....\.|
+00000080  7e 6b c8 7e 3f a5 32 77  20 3c 7b 92 df bc 11 57  |~k.~?.2w <{....W|
+00000090  86 e5 a1 03 78 9c 08 ea  49 bc a7 1b 6b fb 47 6d  |....x...I...k.Gm|
+000000a0  9a 86 14 fa cc 98 e6 9a  f8 39 18 57 36 fb 1b ff  |.........9.W6...|
+000000b0  ae ce 1e 96 20 9d 16 be  c6 00 45 51 2a 5a 7b 46  |.... .....EQ*Z{F|
+000000c0  9c c9 c1 eb fb fc 37 52  8d b2 22 e3 58 6a d1 fe  |......7R..".Xj..|
+000000d0  71 55 18 4b ff 92 e1 16  62 29 cb fb d0 0d 94 22  |qU.K....b)....."|
+000000e0  13 ee 8e bb 75 2e 1c ae  11 61 3d 37 69 0d 51 b0  |....u....a=7i.Q.|
+000000f0  61 e3 7f 94 08 54 3a 49  68 94 b5 64 da ac a9 a4  |a....T:Ih..d....|
+00000100  e2 3f 65 ad d7 42 8e 0b  70 5f 4f 6d 6e 0c 27 51  |.?e..B..p_Omn.'Q|
+00000110  5a 48 57 71 6e 9b 58 e0  6e 05 40 48 a8 20 36 98  |ZHWqn.X.n.@H. 6.|
+00000120  f8 71 a3 ef 2d db 8c ae  fa a5 14 d8 1f ff ad 7b  |.q..-..........{|
+00000130  2a 15 0d fb 3d e8 1b fe  48                       |*...=...H|
 >>> Flow 8 (server to client)
-00000000  16 03 03 00 85 5d 34 8c  78 d1 0e 67 b7 5c ee 45  |.....]4.x..g.\.E|
-00000010  ec f6 47 3c 67 11 2e 53  a5 a4 54 d2 25 80 88 bf  |..G<g..S..T.%...|
-00000020  41 89 8f 8f 2d a2 42 48  d7 3c 27 0f f8 45 6b 17  |A...-.BH.<'..Ek.|
-00000030  1a f7 dd 9d 1a aa 92 46  79 1c 24 01 ff 8e c3 17  |.......Fy.$.....|
-00000040  84 07 49 8c 62 8d ca 26  57 40 55 b4 1d 88 98 99  |..I.b..&W@U.....|
-00000050  57 dd e5 23 ab 8e 51 37  4b 57 4e 6e 99 0b a3 18  |W..#..Q7KWNn....|
-00000060  74 ed c5 2d 06 e6 4c e8  65 c0 96 44 44 ce ec 3c  |t..-..L.e..DD..<|
-00000070  7c ef ad c2 08 6b 9f 0f  13 03 1e 66 db 99 07 74  ||....k.....f...t|
-00000080  8b ae cd 6d 78 bd 93 25  76 8a 16 03 03 02 69 8d  |...mx..%v.....i.|
-00000090  e5 8b e8 c8 93 2e f7 70  46 e2 1f cc d5 02 65 7c  |.......pF.....e||
-000000a0  e5 b3 09 7c ea ef 81 b5  a9 f6 52 ab e5 6c f1 ee  |...|......R..l..|
-000000b0  e4 b6 f9 d0 be 7e 47 fe  f7 65 d0 e8 39 4e 99 d9  |.....~G..e..9N..|
-000000c0  4a 00 80 4d ca cb 8b 32  58 d4 63 64 e5 fe f4 1b  |J..M...2X.cd....|
-000000d0  24 c0 00 ea 10 d3 19 04  a7 7a a3 37 79 04 17 6d  |$........z.7y..m|
-000000e0  d3 35 df 6a 0e dc 26 4e  59 48 7e 56 b8 ca e4 57  |.5.j..&NYH~V...W|
-000000f0  ae 66 c9 37 54 e4 a8 0e  2a b5 e5 be 7f ed 35 80  |.f.7T...*.....5.|
-00000100  12 eb 2d 3c d1 04 0c c1  9e ef 0d 60 2e 1c 94 94  |..-<.......`....|
-00000110  b2 39 46 dd 83 22 5a 09  b5 ef 66 6d 8f 2b 32 ca  |.9F.."Z...fm.+2.|
-00000120  b9 28 08 d4 a6 36 6b 62  5c 64 c6 e5 2b 61 13 81  |.(...6kb\d..+a..|
-00000130  50 e5 56 9d d2 ab 3f 7d  ea 1b 4c d3 ff b0 ed 95  |P.V...?}..L.....|
-00000140  20 62 58 ba af 27 51 b4  91 24 37 d7 ac a8 c7 21  | bX..'Q..$7....!|
-00000150  20 54 71 d2 00 d3 39 8a  c1 c4 c7 17 87 21 9d 45  | Tq...9......!.E|
-00000160  36 22 da 4b 89 9e 8b ae  bd 8f c5 94 ee 80 4f 55  |6".K..........OU|
-00000170  6b 43 06 c7 ad 89 50 a9  64 2e de 68 df bc 21 d9  |kC....P.d..h..!.|
-00000180  28 d6 cf 3d e5 94 77 9f  8b 96 f0 fc b6 31 1f 7c  |(..=..w......1.||
-00000190  f8 85 9f 8a 2f 92 7a 52  5b 1c 42 77 87 2e 1b 0a  |..../.zR[.Bw....|
-000001a0  1d 6b a6 09 15 96 77 b0  c1 47 ee b4 54 60 df 2a  |.k....w..G..T`.*|
-000001b0  c7 86 85 c5 3a ee c9 e2  cd b8 99 fc 9d 30 9f a6  |....:........0..|
-000001c0  eb 6c ef 25 18 4c 58 11  45 1f 14 be 4f 2c a7 ed  |.l.%.LX.E...O,..|
-000001d0  71 e8 c2 70 3d e8 b6 55  3f a6 52 44 fd d1 6c 13  |q..p=..U?.RD..l.|
-000001e0  32 df e9 c2 ea 42 1b 69  ce 9d 79 77 b1 a3 f8 a2  |2....B.i..yw....|
-000001f0  ee 28 c2 bc 0e 99 86 fd  d2 e7 f7 2a 14 1c ea a7  |.(.........*....|
-00000200  3a 26 dd 23 4b 48 44 55  ac ea 5e 0e 12 18 49 7a  |:&.#KHDU..^...Iz|
-00000210  56 bc c0 2e 8a 5c 96 83  8d e7 ad c3 25 b2 dd d1  |V....\......%...|
-00000220  2c d3 f7 16 61 78 26 50  f5 69 34 e4 07 3a 0f c6  |,...ax&P.i4..:..|
-00000230  26 fb be e2 a9 b0 76 a2  67 ed 65 75 89 c8 c6 a9  |&.....v.g.eu....|
-00000240  80 8e c6 96 b6 18 61 9e  e9 2e 51 cb 8b 3d 7c db  |......a...Q..=|.|
-00000250  2a a0 5b d6 21 e8 ef a8  83 dc 1a 79 98 18 6d b5  |*.[.!......y..m.|
-00000260  8a b1 7c 6b 4e 8a ad 13  11 94 74 e8 b5 be 1d 74  |..|kN.....t....t|
-00000270  ce 13 b6 1a c4 83 cc fa  ed ec 1e a2 e8 78 2f ac  |.............x/.|
-00000280  b9 51 c7 8e d7 f4 16 e7  31 63 95 cd 79 fc a3 42  |.Q......1c..y..B|
-00000290  99 c4 a7 26 14 6a 0d c3  26 e0 08 bd 21 c8 b8 56  |...&.j..&...!..V|
-000002a0  3e 0e 98 42 76 3d e6 82  51 6c 6a a1 78 c0 c5 9a  |>..Bv=..Qlj.x...|
-000002b0  70 1b 9e 70 63 e3 e6 c4  9a ed c9 1e 9f 95 dd e2  |p..pc...........|
-000002c0  8e b9 12 7d 7a d1 3b 49  df 4c cc ba b4 2d 91 34  |...}z.;I.L...-.4|
-000002d0  f8 05 1e d1 66 39 49 99  49 18 45 da 24 65 bb f8  |....f9I.I.E.$e..|
-000002e0  d0 40 87 6d 5b 5a 2a 41  40 f0 98 07 3c 1a 9e 81  |.@.m[Z*A@...<...|
-000002f0  8f 5d 44 80 10 0b bb f4  16 03 03 00 bc 8a 5e 4c  |.]D...........^L|
-00000300  7b 86 c6 d6 f1 fa ba 03  2d 16 75 46 6a 72 b9 98  |{.......-.uFjr..|
-00000310  11 75 b5 34 96 6a f9 61  7a b4 47 2d 67 b8 ab 1f  |.u.4.j.az.G-g...|
-00000320  69 60 1f 28 ff 3d 03 61  62 22 7a 35 73 e7 0e 15  |i`.(.=.ab"z5s...|
-00000330  f5 e9 64 a6 8b dc e3 f4  fe 7b 53 82 48 6f df fb  |..d......{S.Ho..|
-00000340  69 b8 c3 4c a9 dc 87 8b  46 99 1f ef ae 6a 40 56  |i..L....F....j@V|
-00000350  81 fd e9 1d 8c 8d 12 c0  07 77 fa e3 e2 cd 48 33  |.........w....H3|
-00000360  de b9 db 09 0d d4 eb cc  a5 9e 43 75 b6 45 09 c2  |..........Cu.E..|
-00000370  08 ff cc fa c6 3b 97 da  85 9a c4 9f 56 03 ed b8  |.....;......V...|
-00000380  a5 98 ec b3 b8 d4 39 b5  07 32 b4 f6 70 1f 9f 1d  |......9..2..p...|
-00000390  6e 0e fc 22 6d 1d 29 b7  d7 83 f3 2e 1a 8e d0 77  |n.."m.)........w|
-000003a0  e9 82 4f 21 94 0d e6 39  f4 4f 57 74 0e a6 0d a3  |..O!...9.OWt....|
-000003b0  bf ee 24 ac 3e be f6 46  bb 16 03 03 00 4a 0a eb  |..$.>..F.....J..|
-000003c0  93 1a d4 ab 57 53 2c 5c  40 f1 f8 2f 6c 93 f3 2a  |....WS,\@../l..*|
-000003d0  6d a0 19 d4 d3 92 1a b0  ae 2d 15 9c 63 21 0f 06  |m........-..c!..|
-000003e0  8b ef 7c a4 a6 dc d8 6c  63 ec 24 ce ce ce 55 fa  |..|....lc.$...U.|
-000003f0  de 31 53 2b df 27 4c 20  60 97 f2 62 86 33 97 b2  |.1S+.'L `..b.3..|
-00000400  69 d0 aa 44 3f 1f 02 d5  16 03 03 00 14 0b e0 0c  |i..D?...........|
-00000410  7b 88 84 70 49 7a e4 80  7a 85 90 76 cc aa 0b 42  |{..pIz..z..v...B|
-00000420  6b                                                |k|
+00000000  16 03 03 00 85 1b 2d 33  65 c9 76 7a 52 fc bf 49  |......-3e.vzR..I|
+00000010  7f 21 89 e6 3d 0e 79 55  83 8d 2e de b9 c4 57 08  |.!..=.yU......W.|
+00000020  fc 79 f5 32 95 9f 97 fe  a9 40 3a e6 c6 ec 2a e2  |.y.2.....@:...*.|
+00000030  92 4c cc 48 0b ac bc 66  58 c6 0f 5c b6 62 3d a6  |.L.H...fX..\.b=.|
+00000040  86 9f 4c f5 0d 2e 4b 69  cb 7a 62 25 08 04 de 51  |..L...Ki.zb%...Q|
+00000050  6c 78 99 ff b2 96 5f 3d  85 60 34 28 2e b4 64 ec  |lx...._=.`4(..d.|
+00000060  33 d8 c1 09 49 cf 10 ee  19 6c 89 67 28 b1 4d 00  |3...I....l.g(.M.|
+00000070  08 43 33 8e 8e b9 bf 25  73 a9 88 5d 0d 97 09 26  |.C3....%s..]...&|
+00000080  d3 3d 7f 7e fa da e4 89  16 a5 16 03 03 02 69 3c  |.=.~..........i<|
+00000090  8b c1 7c 1e a4 46 7d 21  40 ed 6f 45 c2 c0 19 d3  |..|..F}!@.oE....|
+000000a0  18 e3 b7 e1 a4 d0 c0 ad  4f cf a7 0f d3 39 ad 0f  |........O....9..|
+000000b0  6a 70 28 d2 ab 8e 26 93  e1 f4 4d 25 65 1a 7e 44  |jp(...&...M%e.~D|
+000000c0  63 30 3c 54 8a 2f 1e 31  f6 d2 e2 26 66 43 91 df  |c0<T./.1...&fC..|
+000000d0  ac 1c a2 2e da e3 be 6f  66 bb a4 f8 42 40 c5 71  |.......of...B@.q|
+000000e0  32 ea ae e1 29 97 44 6a  66 95 b8 b1 fb 21 36 35  |2...).Djf....!65|
+000000f0  ca a3 5a 4f 71 79 29 42  da 44 a2 b0 90 46 7e 15  |..ZOqy)B.D...F~.|
+00000100  e7 58 94 50 bc 09 ac 28  23 4e 18 0e f2 b9 af 66  |.X.P...(#N.....f|
+00000110  6b 13 6e a0 cc a3 8f d3  f3 b1 a3 27 e0 bf bf 84  |k.n........'....|
+00000120  6a d6 fd 19 1c 97 f1 70  79 c2 f0 e3 96 25 87 ae  |j......py....%..|
+00000130  b0 03 30 5e 32 2a a4 02  1b 33 28 0f 5a f8 14 2f  |..0^2*...3(.Z../|
+00000140  27 08 05 ca d9 02 a4 18  b2 0a 75 ad 04 3b e0 98  |'.........u..;..|
+00000150  59 1d de 8c 60 4a bf 17  a4 cf 0a ed f4 6e 94 66  |Y...`J.......n.f|
+00000160  e0 41 da 86 ac 8b 39 d9  7c ee bb 98 eb 27 9d 36  |.A....9.|....'.6|
+00000170  d5 e3 ea 5f 32 62 0f 3b  f3 46 c9 32 ce a9 2a da  |..._2b.;.F.2..*.|
+00000180  32 f8 69 06 1c f4 64 6c  55 19 5d 93 05 1c 93 a0  |2.i...dlU.].....|
+00000190  58 b3 a5 4b 33 35 02 9b  dc 5f 98 24 15 f8 77 20  |X..K35..._.$..w |
+000001a0  d8 8b 19 27 24 8a 12 a4  cc e0 ae 22 58 31 16 7a  |...'$......"X1.z|
+000001b0  3c 9d 1e 36 d3 60 d5 37  40 73 5c 02 1a dc 30 71  |<..6.`.7@s\...0q|
+000001c0  8c c4 31 2a 29 28 bc 88  e9 94 8f ca d2 df ad c8  |..1*)(..........|
+000001d0  88 c7 10 ec 3e bb 1b c3  64 bc c0 ae 56 2a b2 68  |....>...d...V*.h|
+000001e0  45 68 13 da c6 eb 5d f2  7b 51 bd b4 8e 25 0d b7  |Eh....].{Q...%..|
+000001f0  f0 03 dd 2b cd 93 7f 00  96 ca 75 c1 1b c7 d0 95  |...+......u.....|
+00000200  0f 08 52 e0 d6 c9 2c b2  42 b3 0b 0c ed e1 01 e3  |..R...,.B.......|
+00000210  7d ef b1 fb 80 76 c8 08  ec 9f c2 13 a5 04 05 fe  |}....v..........|
+00000220  33 c2 b7 2e 1a 2b 4a 74  f5 f5 92 ad e8 cf f7 76  |3....+Jt.......v|
+00000230  3e 7c 69 4b 2d be 9b 08  3b 80 97 66 63 e5 df db  |>|iK-...;..fc...|
+00000240  1a a4 aa 8a bd 43 2a 65  44 6d f1 e6 60 92 cd 98  |.....C*eDm..`...|
+00000250  a9 ac 81 de fb 22 06 f4  ca 90 4a 67 64 3f 25 ab  |....."....Jgd?%.|
+00000260  3c db 77 cb bc 32 55 bc  2d 48 4e 32 c7 48 d1 2f  |<.w..2U.-HN2.H./|
+00000270  bf 80 03 7e 27 92 8b 6a  90 35 ab 8e 93 dd 27 c7  |...~'..j.5....'.|
+00000280  7d d6 a7 ea d8 1f 6a 43  57 34 d2 a9 7c c3 23 55  |}.....jCW4..|.#U|
+00000290  62 5b 98 80 a1 ec 61 53  63 b9 a7 89 85 7e a8 0e  |b[....aSc....~..|
+000002a0  31 e9 9f 82 e9 1a b3 25  b8 d3 bf 4b f7 da 40 ce  |1......%...K..@.|
+000002b0  30 95 8f 41 75 9e 99 f5  3f fd 90 57 77 ee ad b7  |0..Au...?..Ww...|
+000002c0  56 1e fd a6 d6 98 ae d3  a0 36 8a e0 19 a5 64 63  |V........6....dc|
+000002d0  8f 08 d3 e6 2b c3 8a 29  90 8d e0 d7 1d 8b 84 6d  |....+..).......m|
+000002e0  a8 7a 0d 8b 6d 0e d5 fa  bd c1 31 13 c7 39 61 f6  |.z..m.....1..9a.|
+000002f0  e8 b3 fd 4d fe 49 a0 2c  16 03 03 00 bc 6d 99 1c  |...M.I.,.....m..|
+00000300  76 24 e6 f4 79 ac da e5  71 78 32 8d df a7 74 a4  |v$..y...qx2...t.|
+00000310  e1 22 43 86 62 7a 99 34  9e c1 c7 82 82 f2 ad c0  |."C.bz.4........|
+00000320  cb e5 54 c7 2d 3f bd 00  ba 4f 9f 6b 90 c2 2c bf  |..T.-?...O.k..,.|
+00000330  d5 d1 20 48 28 f0 bc 21  d4 1f 8d a9 89 82 ce 3d  |.. H(..!.......=|
+00000340  b2 52 bd 91 57 65 da 07  74 d9 56 b3 54 a7 2c 20  |.R..We..t.V.T., |
+00000350  93 5e 79 59 d0 d3 33 95  a9 de f6 a4 48 37 11 10  |.^yY..3.....H7..|
+00000360  a7 34 2a 2b 30 a5 24 03  5b d5 63 78 1f ad ca 70  |.4*+0.$.[.cx...p|
+00000370  ff f9 22 ca bc 23 ac 4d  eb 5a d7 de af 31 72 25  |.."..#.M.Z...1r%|
+00000380  84 24 72 b7 b8 c0 a5 7a  b6 7e a9 95 42 bb 5e 52  |.$r....z.~..B.^R|
+00000390  6c 13 87 c2 b5 17 04 a8  0a 43 d0 b4 96 12 12 4b  |l........C.....K|
+000003a0  1e d1 0b ab a1 5d 1a bc  48 15 ec 88 e6 7b 57 aa  |.....]..H....{W.|
+000003b0  da 3b 7f 0b cc 11 93 8f  ee 16 03 03 00 4a 35 4e  |.;...........J5N|
+000003c0  5f 82 88 e9 d5 24 cc 81  3c 0a cc 49 63 13 ea 0c  |_....$..<..Ic...|
+000003d0  e6 d7 a9 f2 7b 4f 7f d4  c1 d8 71 4e 1d e6 68 e6  |....{O....qN..h.|
+000003e0  7e ba 73 f8 23 a5 af 1a  05 35 4c bf 88 8d 8a 90  |~.s.#....5L.....|
+000003f0  09 26 34 1d b6 88 92 2d  60 92 52 2c cb 45 02 a4  |.&4....-`.R,.E..|
+00000400  78 54 3d a3 44 d3 f9 46  16 03 03 00 14 58 29 f7  |xT=.D..F.....X).|
+00000410  44 f4 a0 9f 65 d8 47 1a  01 7e 1b 95 3b 5f 1f 4a  |D...e.G..~..;_.J|
+00000420  12                                                |.|
 >>> Flow 9 (client to server)
-00000000  16 03 03 02 69 97 93 8b  02 bb 85 f7 ec fd ae 99  |....i...........|
-00000010  d2 31 6c 04 64 02 ee dd  86 ea c2 9c 40 22 5a fc  |.1l.d.......@"Z.|
-00000020  6e 6e 66 30 1d bb 71 40  90 b1 c2 1c 38 53 37 21  |nnf0..q@....8S7!|
-00000030  87 a2 df c3 68 b9 c1 90  46 df 73 f8 ba 20 7e 83  |....h...F.s.. ~.|
-00000040  49 2d d8 3c a4 4a 4b 41  70 5d ee 65 68 31 3d f4  |I-.<.JKAp].eh1=.|
-00000050  44 ce 10 be d8 d1 bc 21  25 f0 66 36 f0 b9 8b b9  |D......!%.f6....|
-00000060  89 cc 0c b8 b2 67 ef 86  24 ed 54 2e e8 b7 b3 87  |.....g..$.T.....|
-00000070  c9 58 fa db 3d 0a 78 bb  68 fa 86 26 bd 8b aa 4c  |.X..=.x.h..&...L|
-00000080  f5 8a f8 6a 82 b1 12 79  39 20 71 c4 3f 6a fc 9c  |...j...y9 q.?j..|
-00000090  4a 44 e0 ea 7e 06 35 23  77 dd 07 0e c1 89 85 19  |JD..~.5#w.......|
-000000a0  98 7b e0 31 2d d0 a2 de  be a9 fe 1a 8d ef 45 52  |.{.1-.........ER|
-000000b0  5c ee 4e 7f 0d 69 41 9b  84 a6 84 6c 41 42 31 8c  |\.N..iA....lAB1.|
-000000c0  b8 24 0d cc 54 a6 81 dd  8b 3a 8a 6c ef 75 8c 6b  |.$..T....:.l.u.k|
-000000d0  01 ce 6a ea ae 67 c3 96  8b b6 42 20 c9 e6 7b 2c  |..j..g....B ..{,|
-000000e0  79 fe 1c 25 42 55 95 65  a4 af 16 ec aa 49 e4 fa  |y..%BU.e.....I..|
-000000f0  e5 38 5b c2 82 02 ca 34  8a 20 27 c3 46 55 79 ad  |.8[....4. '.FUy.|
-00000100  31 18 27 ed 14 dc dc ab  75 ba 1f 4c f7 1c 74 f3  |1.'.....u..L..t.|
-00000110  d4 a3 52 f8 39 fe 21 d9  fc 08 7f c6 2c 86 54 90  |..R.9.!.....,.T.|
-00000120  c1 2e b0 de 84 25 eb 36  16 4e 96 c5 fc 6f 83 2b  |.....%.6.N...o.+|
-00000130  3e ad 30 6b ae 33 b2 03  87 2f b7 33 14 50 37 a0  |>.0k.3.../.3.P7.|
-00000140  19 cf 41 1c 68 c9 b8 5c  29 f6 34 db 13 40 10 16  |..A.h..\).4..@..|
-00000150  7c 22 42 38 d5 43 4f 46  4d ae bd e2 7d 78 5f b6  ||"B8.COFM...}x_.|
-00000160  12 ba 19 5a 18 ae b7 76  d6 ae 71 c3 5b c4 b5 3a  |...Z...v..q.[..:|
-00000170  b5 b6 52 9b 0b 92 30 41  4d a0 f4 62 2c c7 4f 27  |..R...0AM..b,.O'|
-00000180  04 f5 7e 77 04 89 11 2a  e0 0c 5e 21 3b 75 13 bf  |..~w...*..^!;u..|
-00000190  1f 48 ed 4d 05 b3 67 f3  d8 71 99 fb 23 c5 0f fd  |.H.M..g..q..#...|
-000001a0  47 7c 36 f8 e0 25 53 f4  15 bd 77 db f5 71 a1 6e  |G|6..%S...w..q.n|
-000001b0  6a 1a 06 a1 8a 5d 2b 28  89 82 7b 29 aa b1 68 a6  |j....]+(..{)..h.|
-000001c0  fb 29 a8 cb ee e0 71 de  52 b8 8a 57 63 ff 74 a5  |.)....q.R..Wc.t.|
-000001d0  ca 8c b5 44 23 74 ab 86  74 cf 82 0b fc 23 90 95  |...D#t..t....#..|
-000001e0  3d 83 87 5a aa af 5d d1  c6 4b dc b0 f3 0f 44 57  |=..Z..]..K....DW|
-000001f0  ca 47 a1 28 64 64 4d 81  15 11 92 5a 8c b9 8d ef  |.G.(ddM....Z....|
-00000200  a9 18 58 67 c7 c3 3b a7  9d 41 be 74 67 cb a8 3e  |..Xg..;..A.tg..>|
-00000210  3d a4 b0 4e 92 15 c1 4a  38 6d 48 ba 57 4b 42 a9  |=..N...J8mH.WKB.|
-00000220  2c de de 6a 5b 60 3e 9d  09 5e 8e d4 97 4a 31 52  |,..j[`>..^...J1R|
-00000230  47 5c ce bc f8 14 49 78  6b 5a 36 aa 3b c7 bc e7  |G\....IxkZ6.;...|
-00000240  59 17 a1 18 d3 b1 54 e8  54 8a 1c 07 a5 3b 9f bd  |Y.....T.T....;..|
-00000250  d1 60 7d e8 78 8c be b2  ea 20 26 59 65 ef 70 71  |.`}.x.... &Ye.pq|
-00000260  98 73 0c 43 cb 3a bc 61  8a f8 19 a4 89 0b 16 03  |.s.C.:.a........|
-00000270  03 00 35 28 53 40 d2 93  99 84 8e d8 fc f1 4a 3e  |..5(S@........J>|
-00000280  22 26 d3 2b c0 e9 32 d4  49 7b 7d 19 61 29 ab 28  |"&.+..2.I{}.a).(|
-00000290  e7 e4 a2 13 2e 5a a8 7f  ef e7 19 7b 9c de fc 21  |.....Z.....{...!|
-000002a0  2a 3d f0 3a d3 dc 17 d2  16 03 03 00 98 30 c7 f4  |*=.:.........0..|
-000002b0  b6 60 3b 87 88 e1 0e 26  d2 34 49 de 8c b8 99 35  |.`;....&.4I....5|
-000002c0  fe 6f 11 4b 8b ab d9 ce  11 b1 f5 05 8d 6b c1 91  |.o.K.........k..|
-000002d0  c8 69 cb 2b 04 99 12 ed  8b 7a 63 e2 9c 5d 80 63  |.i.+.....zc..].c|
-000002e0  57 74 8f 1f 9c f4 6b cb  51 57 6b 33 3e 1b 81 54  |Wt....k.QWk3>..T|
-000002f0  73 54 5c 28 f1 fe 2f 88  41 ea 2b 52 30 93 0e 98  |sT\(../.A.+R0...|
-00000300  fe b1 59 0e 01 26 06 f0  fd 77 cb 59 ec b7 4c 4f  |..Y..&...w.Y..LO|
-00000310  cd 40 c0 36 11 d2 dd c8  1a 40 e2 ba 9c d9 39 99  |.@.6.....@....9.|
-00000320  9a d3 9b 37 ee 76 8b 22  fb 42 a8 90 c6 8d 92 4b  |...7.v.".B.....K|
-00000330  57 83 33 04 75 6a 79 69  8f f9 4d fd d6 bd 01 76  |W.3.ujyi..M....v|
-00000340  98 36 7d b2 b5 14 03 03  00 11 85 15 d7 33 6d 47  |.6}..........3mG|
-00000350  80 84 38 df a3 c2 91 0b  1c e0 82 16 03 03 00 20  |..8............ |
-00000360  0d cc f8 79 c6 13 4e 81  b7 a7 2d 03 18 7e 9d 24  |...y..N...-..~.$|
-00000370  2e 89 d7 7d bf ab a7 1d  2f 15 c1 80 3d f2 89 68  |...}..../...=..h|
+00000000  16 03 03 02 69 ef e7 da  35 77 b6 d6 09 a1 71 43  |....i...5w....qC|
+00000010  1c 2b 72 d6 65 ea b4 38  e4 13 c1 85 c3 36 bb f4  |.+r.e..8.....6..|
+00000020  ef 1a b8 94 de 11 22 6e  b8 28 14 05 88 2a 5d 7a  |......"n.(...*]z|
+00000030  7c 0a 00 ac 74 ce 4f f8  b3 94 5d 5c a1 aa 3e 20  ||...t.O...]\..> |
+00000040  ee 0b e3 50 3d e7 4f 4d  ad 5c 9e 6e 8e 75 26 b4  |...P=.OM.\.n.u&.|
+00000050  80 e1 85 3f ae 76 6f 95  6e f0 79 98 3d 86 17 9c  |...?.vo.n.y.=...|
+00000060  e9 d6 35 1d f5 15 ea c5  29 67 15 9d 03 4b 41 9d  |..5.....)g...KA.|
+00000070  25 b3 ab 3a b0 12 d1 ff  fc 9e 25 af ff 8a c8 1c  |%..:......%.....|
+00000080  4b 4e f0 10 9d d3 98 6e  66 0a 13 82 b9 04 d7 39  |KN.....nf......9|
+00000090  b2 2c c5 f9 cf be 4b 8b  8a 28 e9 24 db c8 fe d6  |.,....K..(.$....|
+000000a0  a1 b1 3c 9e 19 92 0b 5d  2e c8 5f 56 35 dc 16 46  |..<....].._V5..F|
+000000b0  7b a1 d2 43 d9 ee 3f a7  74 c1 4c ed 2a 84 4a ad  |{..C..?.t.L.*.J.|
+000000c0  76 a2 bc 90 8d 19 06 11  1a 6d b8 e0 3a 8e 0d 33  |v........m..:..3|
+000000d0  f2 ad 06 d7 e5 a3 16 8c  14 07 4c 84 8a 47 13 c1  |..........L..G..|
+000000e0  b1 cb 81 8b d7 5b fb 04  2b da 3c 7f d1 0f 2b 8b  |.....[..+.<...+.|
+000000f0  23 ad f5 f1 09 82 24 80  5c bc f7 68 69 c0 90 5f  |#.....$.\..hi.._|
+00000100  fa 96 b4 9d 51 0e 96 1e  06 2a d1 98 5d 96 95 68  |....Q....*..]..h|
+00000110  de df 40 f9 f6 b1 f2 ef  a7 c4 0c 05 ee b3 63 8d  |..@...........c.|
+00000120  3a 1e a2 d8 34 2a b2 99  c3 17 03 60 18 4f 43 21  |:...4*.....`.OC!|
+00000130  99 4f 81 c1 11 8e a4 45  79 d8 fa fc b2 9a f8 d0  |.O.....Ey.......|
+00000140  95 10 79 38 45 1b 82 42  f0 bb 75 27 6b a2 53 d3  |..y8E..B..u'k.S.|
+00000150  e6 dd 2d 43 f5 80 fd 9a  59 ec 07 42 ee b0 9d bd  |..-C....Y..B....|
+00000160  33 dd 58 c8 57 e8 16 de  a4 21 c9 92 51 d2 e5 8b  |3.X.W....!..Q...|
+00000170  48 f5 cb a8 3a d8 f6 a3  b2 00 90 9e f0 e0 ca c7  |H...:...........|
+00000180  fe 79 70 f7 8e 5c 4b 3c  86 c8 cc ca b1 b6 05 e2  |.yp..\K<........|
+00000190  90 66 db 85 fc 7c 87 6f  e0 44 ed 2a c9 66 b7 de  |.f...|.o.D.*.f..|
+000001a0  c5 f0 d2 80 dd f2 c2 26  5b 84 cf b0 c4 78 7e 65  |.......&[....x~e|
+000001b0  66 d9 d8 c5 fe 97 b9 27  6e 55 11 c0 0b 3e e2 c9  |f......'nU...>..|
+000001c0  ce 4d dd 27 28 6f 62 45  70 b3 e4 0c 18 31 f1 b2  |.M.'(obEp....1..|
+000001d0  33 8f 7d 34 7c f6 f3 50  d9 a9 6b ec a7 cf c2 7b  |3.}4|..P..k....{|
+000001e0  36 21 d7 76 68 c1 0e 90  8d af 2e c5 d5 26 c7 c1  |6!.vh........&..|
+000001f0  0b 1c 43 85 a6 43 3e 96  67 46 2d 1e 0a c8 90 99  |..C..C>.gF-.....|
+00000200  0f 71 cc 60 49 68 2c df  17 68 e4 fa 79 05 50 ac  |.q.`Ih,..h..y.P.|
+00000210  16 d0 26 1f 7e 58 a2 dc  73 e9 05 8d 92 f6 8c 56  |..&.~X..s......V|
+00000220  db 08 0a b7 99 64 f7 5b  d0 5f f3 88 f5 02 f5 d0  |.....d.[._......|
+00000230  66 55 e3 db f4 d1 c9 d3  c1 f4 ab 8c 5c 39 fd 64  |fU..........\9.d|
+00000240  ec cd ab 63 da 7b 3e 64  1a b4 c3 d9 79 bd 92 e3  |...c.{>d....y...|
+00000250  97 68 a4 83 b5 f1 fa f5  05 04 84 39 e9 82 a6 84  |.h.........9....|
+00000260  e5 a0 6f a2 6d ea 6b ab  4c f8 a5 87 9c 9c 16 03  |..o.m.k.L.......|
+00000270  03 00 35 08 0b 50 f9 90  d3 e9 58 e5 5b df a1 99  |..5..P....X.[...|
+00000280  89 ea 0b 1a f1 4d e3 fd  a6 79 2c 61 ac 6f da 7c  |.....M...y,a.o.||
+00000290  2a 78 e1 38 05 35 2e 8b  db eb 25 fd eb 2f d7 a3  |*x.8.5....%../..|
+000002a0  27 9d 27 f2 b3 ff 20 8a  16 03 03 00 98 95 42 7e  |'.'... .......B~|
+000002b0  d5 86 40 42 dc 93 fe 80  ef 70 cc fb 2f b1 51 bd  |..@B.....p../.Q.|
+000002c0  ca 5f 1e 0d a0 3f c6 e0  c9 69 0e d4 dc 18 25 52  |._...?...i....%R|
+000002d0  5c c2 8c 37 f6 a8 e6 4d  48 27 81 4d 7a f3 49 5c  |\..7...MH'.Mz.I\|
+000002e0  92 92 68 a9 e0 dc d6 c5  b5 ea 99 5c 51 df 93 a1  |..h........\Q...|
+000002f0  36 2d 65 a8 cb ca 72 76  53 92 7d c7 81 5f 19 2c  |6-e...rvS.}.._.,|
+00000300  3e 83 29 16 41 65 4f 81  d7 3f 5c 15 f0 36 d9 75  |>.).AeO..?\..6.u|
+00000310  a7 c8 52 6f 5b b6 98 46  5e 39 31 83 1c 99 3f f9  |..Ro[..F^91...?.|
+00000320  9e 28 d7 94 ae a7 b4 f7  c9 ce 5b 74 2f 88 9e fd  |.(........[t/...|
+00000330  3c 1c 1e eb f4 b3 39 65  39 07 14 8e 3e 95 87 b2  |<.....9e9...>...|
+00000340  b8 4c e8 7d 3b 14 03 03  00 11 cc eb 21 2a 7c 9a  |.L.};.......!*|.|
+00000350  5c 35 9f 35 e3 09 dd f8  7a 4f 43 16 03 03 00 20  |\5.5....zOC.... |
+00000360  0b ff 00 c0 96 43 18 d9  9d ad 51 55 44 40 11 2f  |.....C....QUD@./|
+00000370  cd 1c bd ae ea 0a c9 eb  de 57 95 c2 81 63 79 4c  |.........W...cyL|
 >>> Flow 10 (server to client)
-00000000  14 03 03 00 11 81 c4 6d  51 fc a3 05 28 42 9a 59  |.......mQ...(B.Y|
-00000010  3f 84 d4 ac 19 a4 16 03  03 00 20 44 a9 25 3f 24  |?......... D.%?$|
-00000020  0a ab 91 47 24 f9 81 fc  1e ab d2 6b ee 81 04 b1  |...G$......k....|
-00000030  3e 16 1f 70 16 e2 74 f5  71 b8 74 17 03 03 00 19  |>..p..t.q.t.....|
-00000040  77 fa 0d b1 b4 fc b6 5b  d0 73 1a 94 d0 6c 05 7d  |w......[.s...l.}|
-00000050  1a fa 6e d4 00 4e 2e 91  e0 16 03 03 00 14 f0 79  |..n..N.........y|
-00000060  e5 37 1f 13 e6 a0 d3 4a  66 a9 e8 03 71 5f 67 37  |.7.....Jf...q_g7|
-00000070  aa b6                                             |..|
+00000000  14 03 03 00 11 d8 35 87  10 ce 65 af f6 19 4d 34  |......5...e...M4|
+00000010  6c 01 68 91 74 2d 16 03  03 00 20 70 df d4 bd c1  |l.h.t-.... p....|
+00000020  29 ac f3 f8 70 a4 5b ca  cb 7e 20 d4 1b 7e 2f 4b  |)...p.[..~ ..~/K|
+00000030  79 0b ea a3 ff 41 4a 5c  ff 5b 16 17 03 03 00 19  |y....AJ\.[......|
+00000040  4b 34 71 05 b5 b8 40 44  d4 2a ec f1 dc e1 ee 6a  |K4q...@D.*.....j|
+00000050  4f e6 c2 bf 44 98 0c 25  9b 16 03 03 00 14 98 20  |O...D..%....... |
+00000060  3c 7a 9f ba ba fd 6e 1f  a1 b9 4b d5 b9 d0 4c 75  |<z....n...K...Lu|
+00000070  1d b7                                             |..|
 >>> Flow 11 (client to server)
-00000000  16 03 03 01 38 e1 e6 8b  40 d6 ae f9 34 1a 27 20  |....8...@...4.' |
-00000010  67 ad c3 86 18 ee c0 e2  82 10 c1 33 df f6 4d 13  |g..........3..M.|
-00000020  46 a1 0b 23 25 12 2e 71  e9 50 2d 08 1c 53 47 a9  |F..#%..q.P-..SG.|
-00000030  69 bd e2 d3 f9 cf 44 91  ec 9a c7 2c ee 2a f8 4e  |i.....D....,.*.N|
-00000040  bf 07 22 9b 6d 00 48 63  78 63 ab 39 b2 be d3 64  |..".m.Hcxc.9...d|
-00000050  7b 46 7a 34 91 e0 1e fc  f4 89 49 e3 75 dc 6b 83  |{Fz4......I.u.k.|
-00000060  95 77 f0 cc 09 b0 3a 19  18 93 6e 9b 5d da b4 93  |.w....:...n.]...|
-00000070  d2 f6 ef de b0 e8 11 04  02 d2 a4 3d cd 95 fd cd  |...........=....|
-00000080  58 93 91 ed 45 1e b9 35  0b 46 5e fc f7 7a e4 18  |X...E..5.F^..z..|
-00000090  96 97 95 f9 8c 84 aa 7c  a9 67 f3 ac b6 e9 9f 12  |.......|.g......|
-000000a0  9f 0f fc 3a 3f 35 ae 13  49 42 04 21 0c b8 06 d3  |...:?5..IB.!....|
-000000b0  e2 13 7a 1e 57 cb 15 91  09 d2 9a 42 84 81 4f b7  |..z.W......B..O.|
-000000c0  6e 6f 8f c0 71 af 7b ca  37 9c 01 2a bc 37 04 8c  |no..q.{.7..*.7..|
-000000d0  ce 3e 82 7f 8b 4e 13 00  15 3c b6 8a 06 63 b6 68  |.>...N...<...c.h|
-000000e0  55 01 97 e6 d1 e1 b8 ae  2a c6 e7 4c fd e5 40 76  |U.......*..L..@v|
-000000f0  11 fa 18 12 db 98 d5 d9  61 8f 33 66 38 95 ba ae  |........a.3f8...|
-00000100  b6 1d 8e 03 27 6c 78 7a  89 82 0f ca 56 d4 19 ae  |....'lxz....V...|
-00000110  e2 79 6b 6d 80 b8 ce fc  3e 42 5a c7 e7 05 3b eb  |.ykm....>BZ...;.|
-00000120  a1 33 a0 56 92 e3 10 e6  ff 17 9b 2d 8e 40 56 fc  |.3.V.......-.@V.|
-00000130  76 9c a6 32 9f 7a a2 d8  e9 77 2f 9f e9           |v..2.z...w/..|
+00000000  16 03 03 01 34 82 8c 60  3d d0 8e d7 cd d6 37 37  |....4..`=.....77|
+00000010  d8 18 6f b1 8c b5 81 f3  0a bf 4f ca 6d 04 9e 6a  |..o.......O.m..j|
+00000020  4f ee bb a0 6c 40 40 96  96 94 b7 44 3d 56 1b 86  |O...l@@....D=V..|
+00000030  eb 52 55 5d 4d da eb 99  85 fb 28 b6 20 33 1c ec  |.RU]M.....(. 3..|
+00000040  95 d9 23 1d 69 fa 40 8f  3f 2b ae 5f 08 c9 eb 71  |..#.i.@.?+._...q|
+00000050  24 b8 4f b0 20 9f db 3d  cb d1 9e d7 7f f0 2e e9  |$.O. ..=........|
+00000060  c0 b5 81 ea 67 3f 70 cc  51 db 8c 00 6b 30 87 61  |....g?p.Q...k0.a|
+00000070  aa 75 dc 1e bc 19 33 82  c2 d4 6e 47 9c c8 ce 60  |.u....3...nG...`|
+00000080  01 73 f2 a9 73 c4 49 da  2e 69 4e 38 66 d8 ab 05  |.s..s.I..iN8f...|
+00000090  39 6b 42 13 43 22 26 ad  bd d7 78 f4 c6 81 b4 8a  |9kB.C"&...x.....|
+000000a0  73 52 6c b8 02 4c 08 fd  7c 79 3b 04 73 61 66 5b  |sRl..L..|y;.saf[|
+000000b0  59 98 50 7d d0 25 89 39  70 b0 e2 b4 3f c6 f1 ce  |Y.P}.%.9p...?...|
+000000c0  83 4b 4a a4 88 7b c5 59  c7 9e 3a e0 a9 d5 95 57  |.KJ..{.Y..:....W|
+000000d0  6f f0 ce 33 c6 58 69 30  04 8b 98 7d 80 74 35 2a  |o..3.Xi0...}.t5*|
+000000e0  a5 40 fe 3b e8 9b c7 2e  30 8c 61 9d e9 f5 56 b2  |.@.;....0.a...V.|
+000000f0  b7 a5 cd 9b a7 91 87 05  ee da e1 5e c7 00 c3 ae  |...........^....|
+00000100  1d c0 71 5d 02 03 15 e6  1b bc a5 da 04 78 89 c6  |..q].........x..|
+00000110  aa 3e 97 31 00 ff e9 12  23 9e 86 74 45 7b 8a db  |.>.1....#..tE{..|
+00000120  d8 c8 c0 8b 00 72 ee d8  a9 64 b8 1b 48 77 98 b9  |.....r...d..Hw..|
+00000130  20 61 b8 23 17 b5 65 7c  fb                       | a.#..e|.|
 >>> Flow 12 (server to client)
-00000000  16 03 03 00 85 12 4a cc  dd af 7e 9f 8f c0 5e dc  |......J...~...^.|
-00000010  db 49 95 90 d0 d4 78 49  8b 34 5c 22 7f f8 9b 42  |.I....xI.4\"...B|
-00000020  99 79 d3 d8 f2 ad 9e e1  67 80 84 8d b5 48 8c 9a  |.y......g....H..|
-00000030  ab 68 65 81 28 16 75 77  e6 57 8a 52 ba ab 2e 3d  |.he.(.uw.W.R...=|
-00000040  27 1c 90 fb 75 99 8f 2b  6b 4e 2c 78 3a f8 5b 25  |'...u..+kN,x:.[%|
-00000050  55 df c6 83 c6 0f 01 f0  00 b0 8e 02 51 62 aa 91  |U...........Qb..|
-00000060  1b 21 b7 2e b3 11 b6 5d  c4 38 04 3c af ad 3e a3  |.!.....].8.<..>.|
-00000070  f5 ec 8f 7f 6f 9d 7a eb  22 51 2c 9e 08 af 9d ab  |....o.z."Q,.....|
-00000080  a7 84 cb f8 68 78 9b 58  50 fa 16 03 03 02 69 07  |....hx.XP.....i.|
-00000090  17 f9 21 47 17 ee f7 d3  06 98 d4 32 e5 a1 c8 f0  |..!G.......2....|
-000000a0  ec eb 61 80 7f 2c 85 66  27 19 cd 8e 6f ca da 0f  |..a..,.f'...o...|
-000000b0  c5 34 76 9f b0 96 5d 6d  67 bd 17 7d 96 62 4e ce  |.4v...]mg..}.bN.|
-000000c0  a1 0e 40 79 6d 25 8c 81  41 a3 2d 0a ba cb d9 35  |..@ym%..A.-....5|
-000000d0  4e a7 fc 74 14 a2 c6 bd  57 46 6a d0 11 37 72 24  |N..t....WFj..7r$|
-000000e0  19 78 e5 86 51 04 f4 10  47 2f a5 d9 e6 44 47 e0  |.x..Q...G/...DG.|
-000000f0  1f 1b ce ea 6f c7 df 17  6a 68 69 01 30 73 e2 48  |....o...jhi.0s.H|
-00000100  61 50 3d 7d 85 aa 5f 74  4c 18 33 d0 e1 95 1b 9a  |aP=}.._tL.3.....|
-00000110  13 30 a2 f4 8e 8b 58 07  15 9b c8 74 ce 58 5b c1  |.0....X....t.X[.|
-00000120  03 75 97 39 5b 00 ee 5a  d6 ba 21 62 6a 19 41 0d  |.u.9[..Z..!bj.A.|
-00000130  4f 77 46 a0 2e 2d c3 77  50 2c dc 3f 04 32 6c be  |OwF..-.wP,.?.2l.|
-00000140  7f 73 c2 58 50 ac 78 eb  b9 b0 a0 2e b7 44 27 0f  |.s.XP.x......D'.|
-00000150  e8 0d 76 d5 a7 4e 9f df  36 bb 63 48 ce f6 2f 9c  |..v..N..6.cH../.|
-00000160  41 a6 76 38 63 72 a0 33  0f 88 94 0d a2 6e 46 d6  |A.v8cr.3.....nF.|
-00000170  57 25 33 e1 36 a0 bf 56  b8 d5 d0 04 2d 23 e8 ac  |W%3.6..V....-#..|
-00000180  93 2c 46 ac 1f e5 2a 48  88 0e 0d 11 67 fe de 21  |.,F...*H....g..!|
-00000190  31 e8 68 9b 7c 4c 49 b8  27 5a c4 89 a4 4c 09 f0  |1.h.|LI.'Z...L..|
-000001a0  de 5f 9c 60 bd 54 e5 96  2c bf a1 86 3a cb 5b 3f  |._.`.T..,...:.[?|
-000001b0  15 3f 4a b2 43 c9 88 0b  49 05 2d d7 61 43 dd 1c  |.?J.C...I.-.aC..|
-000001c0  a9 4d 52 17 98 4d 5b a7  cd 27 52 60 21 57 ed 09  |.MR..M[..'R`!W..|
-000001d0  29 0d c9 a1 b3 6f 11 3a  da 17 00 73 22 4e 7f 40  |)....o.:...s"N.@|
-000001e0  6f 0f 7a a7 7e 73 b8 be  08 b6 10 b3 bb 70 f5 4a  |o.z.~s.......p.J|
-000001f0  96 aa 07 9f e2 68 04 7c  01 e3 92 f9 15 cd 97 b5  |.....h.|........|
-00000200  4e 87 eb 5d 74 db 8b 5a  72 c1 7c b2 b8 73 83 2d  |N..]t..Zr.|..s.-|
-00000210  5f d9 d2 62 b2 db 20 9a  f2 54 ad d4 66 6c 52 9c  |_..b.. ..T..flR.|
-00000220  85 ef a4 90 ca e0 c4 4f  1f 82 0e 80 f5 02 56 e2  |.......O......V.|
-00000230  d0 78 fd 7e c6 73 89 12  5a 11 2e c9 6d a0 6f 8f  |.x.~.s..Z...m.o.|
-00000240  ea a1 4c 88 28 ee 66 79  9c 99 ff 6b e6 e7 f7 bf  |..L.(.fy...k....|
-00000250  1f ef 1f b9 65 46 1e 41  d8 33 13 a1 29 d1 1b 5f  |....eF.A.3..).._|
-00000260  b6 56 3c bf 28 02 d1 5b  b7 77 58 9e cd 4c 5f ac  |.V<.(..[.wX..L_.|
-00000270  2e 60 9e 0c 20 6a 0a 31  60 0b fb a4 75 20 5d c4  |.`.. j.1`...u ].|
-00000280  68 a6 94 bd 99 9c bb 00  57 9c 2e 55 e1 ca d1 0c  |h.......W..U....|
-00000290  40 1f 69 4f 88 79 da 4f  d1 b2 6f 1a 92 77 90 71  |@.iO.y.O..o..w.q|
-000002a0  34 d1 90 f7 c9 fc c9 ac  23 76 d3 2d 6c 54 fa 28  |4.......#v.-lT.(|
-000002b0  a5 2b df 1d f5 39 21 c1  4c 9c 53 08 f5 fc 19 e6  |.+...9!.L.S.....|
-000002c0  29 d4 c2 8b b1 f9 db ae  1f 29 ee 34 8f b0 fe 02  |)........).4....|
-000002d0  06 6a 3e a9 e0 2e e1 71  f8 63 15 f0 ac e5 6b f3  |.j>....q.c....k.|
-000002e0  db 3d b1 de c5 26 a5 18  22 d8 3a 74 1f 57 43 b5  |.=...&..".:t.WC.|
-000002f0  9e f6 40 cc fd ba 68 82  16 03 03 00 bc 0a 05 54  |..@...h........T|
-00000300  61 ad be a6 2a 6e ee f3  b7 fb 50 9f c5 f8 7d b3  |a...*n....P...}.|
-00000310  9a 85 ed 6f 36 5d f3 e5  05 1a c5 b9 6f 9f 2a 99  |...o6]......o.*.|
-00000320  75 d0 49 37 eb 82 fb e0  da bf 8f 6d 0e ab 11 c9  |u.I7.......m....|
-00000330  0d e1 d0 1a cd b1 e7 c9  c2 6e f4 90 ae 56 ba d2  |.........n...V..|
-00000340  65 af f4 7f c2 3c e8 d7  f6 49 57 61 c8 02 0e 72  |e....<...IWa...r|
-00000350  e5 d8 2f 3e f2 d9 4c 64  32 1a 95 f9 f4 f8 47 9f  |../>..Ld2.....G.|
-00000360  c5 63 6b f2 44 48 7f 69  ae 12 f7 ca ff 60 f0 51  |.ck.DH.i.....`.Q|
-00000370  9f 70 7b d9 86 03 fd 9d  d5 29 35 c1 bd 4d fe 45  |.p{......)5..M.E|
-00000380  e1 e0 15 dd 2d f4 20 54  50 61 ba d9 8c bf e6 f1  |....-. TPa......|
-00000390  4a 08 e1 c8 f7 24 f0 5f  41 4c 8e f3 fd 60 31 89  |J....$._AL...`1.|
-000003a0  d6 72 a9 e5 14 65 83 c1  ae be e7 b3 89 99 25 87  |.r...e........%.|
-000003b0  20 13 1b 0a a8 3d d3 dc  5c 16 03 03 00 14 71 4c  | ....=..\.....qL|
-000003c0  20 9c de 36 cc ed 88 6f  c8 84 5a 03 ee 1d cd 3c  | ..6...o..Z....<|
-000003d0  c7 88                                             |..|
+00000000  16 03 03 00 85 93 93 97  db ec 52 74 ce 78 ca e6  |..........Rt.x..|
+00000010  95 19 ac 68 2c 81 ad 6b  c3 6d d5 f7 84 a1 00 d0  |...h,..k.m......|
+00000020  15 4c ae 2d 10 6a 07 d3  82 af af f8 d9 5d 9d 65  |.L.-.j.......].e|
+00000030  8d c9 1e 8c 61 3e b3 67  71 89 41 7e 94 1e 4a 27  |....a>.gq.A~..J'|
+00000040  73 53 83 d4 70 44 9a 4f  8d e7 62 af 9b 71 9e 83  |sS..pD.O..b..q..|
+00000050  72 9a a1 e2 03 47 5f c3  11 4f 56 b9 6f 02 b5 b8  |r....G_..OV.o...|
+00000060  8b 4a cb 99 ed 62 58 45  2d 0f f1 25 ce e9 de 7d  |.J...bXE-..%...}|
+00000070  3f 17 a8 35 d5 73 06 6e  d6 bc 77 2a 82 27 d7 92  |?..5.s.n..w*.'..|
+00000080  91 67 68 07 52 4b ed a0  3c 95 16 03 03 02 69 11  |.gh.RK..<.....i.|
+00000090  73 93 d5 ad 00 17 11 3b  83 81 68 6d 3a 8a 02 1b  |s......;..hm:...|
+000000a0  90 df 84 f6 2b 4a b8 98  cf 50 0d dd 29 22 9d 58  |....+J...P..)".X|
+000000b0  ea 7b 2c 30 2d e7 e2 d1  ae ad 00 9e 01 f6 ef 96  |.{,0-...........|
+000000c0  ae a4 48 58 29 63 1d 2c  19 f3 c2 49 6f cf c9 7b  |..HX)c.,...Io..{|
+000000d0  e3 ca 5c e7 30 a0 b5 72  a9 3d 61 a2 0f 96 e4 d6  |..\.0..r.=a.....|
+000000e0  8f 93 66 f1 de 24 88 14  9f 8b 14 9a b5 94 f7 70  |..f..$.........p|
+000000f0  79 e4 94 68 b7 e0 f1 8e  d0 1b 56 da d0 ce 90 b2  |y..h......V.....|
+00000100  13 b3 4b b5 20 99 77 4a  a4 83 47 4e 1b 1f db 35  |..K. .wJ..GN...5|
+00000110  96 16 f0 d8 2b 7e 18 bf  0c b7 a3 da 44 fe 4c 96  |....+~......D.L.|
+00000120  86 06 52 81 f9 a1 f4 ab  43 6d a3 fd 50 f6 83 08  |..R.....Cm..P...|
+00000130  ba b5 d5 15 55 16 aa 84  95 77 1d 9e cd d6 53 d0  |....U....w....S.|
+00000140  d3 c7 1c 9a 12 4d 8d 7a  b5 0b 02 34 3f cf b5 0f  |.....M.z...4?...|
+00000150  98 56 cc 6e 15 ef 60 88  e0 71 2e 47 46 ce 19 11  |.V.n..`..q.GF...|
+00000160  81 21 fe c6 80 86 d7 be  d9 a7 6f a1 8c 8d ff ba  |.!........o.....|
+00000170  fb 8b 8b 8f 35 95 03 cb  10 e6 f5 71 18 d5 3c e0  |....5......q..<.|
+00000180  60 e7 a2 47 36 41 a0 a3  c4 a3 c1 23 6c da 55 6a  |`..G6A.....#l.Uj|
+00000190  5f ef cd 58 e7 5d d3 cf  50 7b 3d b5 c6 7c 73 d9  |_..X.]..P{=..|s.|
+000001a0  ce c3 ae 6a 46 4a 9a e6  10 57 53 b3 6c e5 ec 9d  |...jFJ...WS.l...|
+000001b0  f0 25 3c a4 a6 f0 42 1a  1e 8c 2b 40 79 e5 51 84  |.%<...B...+@y.Q.|
+000001c0  79 6b c5 8a 3d 25 11 38  97 ca 15 11 e7 51 74 29  |yk..=%.8.....Qt)|
+000001d0  66 9e 4d 4d 50 6a ec 1d  94 6b 4d c9 e9 a7 f8 4e  |f.MMPj...kM....N|
+000001e0  5b c3 06 74 ba 1d a1 79  3c 24 94 c9 3b b0 b1 16  |[..t...y<$..;...|
+000001f0  fe 42 31 fe d0 4b e4 51  e6 06 63 89 2d 3b 56 6a  |.B1..K.Q..c.-;Vj|
+00000200  cf 89 4c 45 49 fd 10 58  9b 6b 4b 35 eb d8 c9 9d  |..LEI..X.kK5....|
+00000210  c0 31 b6 3e 33 da 7e 87  39 e3 c0 6a f8 7f bd 9a  |.1.>3.~.9..j....|
+00000220  26 4f 42 51 86 40 fb f7  fb cc 50 80 b6 0a 63 f4  |&OBQ.@....P...c.|
+00000230  41 62 68 c0 b8 99 7d 8e  ab e1 8a 15 92 f2 35 a4  |Abh...}.......5.|
+00000240  cc 0e e7 9e 74 2d c1 b4  44 be 25 10 92 02 4f e3  |....t-..D.%...O.|
+00000250  e7 ea c4 77 83 18 62 36  ba 9c 77 a6 d4 c1 6f 66  |...w..b6..w...of|
+00000260  fc 07 4b 1a 00 98 a4 10  5e bc d5 93 07 e7 0c e3  |..K.....^.......|
+00000270  34 05 32 23 c7 60 22 a8  52 fa 6e de 3f f9 c6 cc  |4.2#.`".R.n.?...|
+00000280  c2 54 08 d4 2a 98 39 20  09 f4 1d 8e d5 18 77 5a  |.T..*.9 ......wZ|
+00000290  f0 f4 08 a4 66 a7 8e fe  f5 25 50 16 ca 4a 8d f0  |....f....%P..J..|
+000002a0  b4 9f f1 37 e6 9b db 24  25 d0 a0 57 06 74 e2 14  |...7...$%..W.t..|
+000002b0  46 51 e9 9c 03 f0 e0 16  17 d0 c9 54 54 29 e6 04  |FQ.........TT)..|
+000002c0  9a c3 47 93 69 78 1a de  ca f1 d4 b1 52 ff c0 5c  |..G.ix......R..\|
+000002d0  9f 5f 16 a9 35 01 f9 18  47 7b ee 06 f4 f3 3a 1d  |._..5...G{....:.|
+000002e0  94 b9 d5 2c 29 a0 80 85  b0 31 55 37 63 bc a6 e6  |...,)....1U7c...|
+000002f0  67 66 21 5f eb 1c 17 15  16 03 03 00 bc 93 4b d6  |gf!_..........K.|
+00000300  07 b0 12 ca 98 9f 52 b8  14 c3 6e d4 3b f2 74 e4  |......R...n.;.t.|
+00000310  f5 6f 51 40 04 cd 1a 5f  69 fb 3d 68 2b 4e 09 df  |.oQ@..._i.=h+N..|
+00000320  c8 c9 6f c2 87 ae b6 f9  14 6a 41 fa 59 08 0b b0  |..o......jA.Y...|
+00000330  d9 0b d0 61 fd 64 c6 52  3e 40 f2 96 75 b0 82 7a  |...a.d.R>@..u..z|
+00000340  8e 68 11 d2 bc 22 a0 bc  30 d8 a6 1a 88 26 00 d5  |.h..."..0....&..|
+00000350  b5 26 49 c2 5d f3 19 c5  c0 9d 75 c3 f4 3e 95 85  |.&I.].....u..>..|
+00000360  d0 8b de 31 79 b5 5c 27  6e 99 ab 50 fe ef 3a 07  |...1y.\'n..P..:.|
+00000370  a0 a9 ce b7 4b 29 6b 93  42 6d db 34 6b 14 03 a9  |....K)k.Bm.4k...|
+00000380  a8 1f c2 57 65 64 c3 95  ff 2a f8 39 de c3 36 f4  |...Wed...*.9..6.|
+00000390  dd 77 b0 cf 86 be c4 9c  1d d5 ea 88 3c 8c ed 81  |.w..........<...|
+000003a0  51 fc a9 80 78 bc 59 7d  d1 e4 48 d5 d6 07 88 e1  |Q...x.Y}..H.....|
+000003b0  d7 85 80 81 3a 35 9c 57  21 16 03 03 00 14 d9 b1  |....:5.W!.......|
+000003c0  fb 95 82 67 c4 35 92 cd  47 cb 7b 0f 63 1a e0 32  |...g.5..G.{.c..2|
+000003d0  43 75                                             |Cu|
 >>> Flow 13 (client to server)
-00000000  16 03 03 00 35 12 be 58  29 49 7c 4d 6c 24 a0 76  |....5..X)I|Ml$.v|
-00000010  72 a5 f8 e2 2b 61 fc a6  e3 97 00 cc 3f 52 26 9b  |r...+a......?R&.|
-00000020  0e 1c 0b 05 2a f3 86 79  13 2b 33 5f 99 f0 91 5f  |....*..y.+3_..._|
-00000030  95 88 fe d1 0d 84 a7 5b  f0 7b 14 03 03 00 11 82  |.......[.{......|
-00000040  33 3a 3a d4 72 53 72 1a  90 d1 d1 14 18 c6 2d 03  |3::.rSr.......-.|
-00000050  16 03 03 00 20 47 44 78  28 c6 68 5e 4e 7f ae 14  |.... GDx(.h^N...|
-00000060  3c 37 64 45 6c 91 29 ff  19 b6 dd 09 6e 2e f8 b8  |<7dEl.).....n...|
-00000070  91 ed 60 9f ec                                    |..`..|
+00000000  16 03 03 00 35 36 32 d0  64 c8 ba 33 1d 4f 31 73  |....562.d..3.O1s|
+00000010  68 35 f2 76 0c b1 52 12  f5 4b 8a ea 74 0a 7f c2  |h5.v..R..K..t...|
+00000020  a4 90 75 1f 24 0a 76 77  1f 01 15 9d 59 fa 16 56  |..u.$.vw....Y..V|
+00000030  cc fd f9 08 74 76 31 cc  f4 4c 14 03 03 00 11 c0  |....tv1..L......|
+00000040  12 9b 35 78 94 a3 4e c3  b2 30 aa c7 fa 44 20 e6  |..5x..N..0...D .|
+00000050  16 03 03 00 20 c6 a5 79  48 7b c3 2b 2d 6a 73 0a  |.... ..yH{.+-js.|
+00000060  83 a9 2b a7 ba 90 ea 6f  b5 c2 c1 13 d7 7a 86 37  |..+....o.....z.7|
+00000070  5a 24 8e f9 b3                                    |Z$...|
 >>> Flow 14 (server to client)
-00000000  14 03 03 00 11 9b 5d c3  de 7d 32 e1 a2 2c d3 d7  |......]..}2..,..|
-00000010  1b c9 cb bd d3 5b 16 03  03 00 20 21 50 5c ba c2  |.....[.... !P\..|
-00000020  c3 d5 53 42 9c cf 93 86  e3 29 18 f0 4b 6c d9 a7  |..SB.....)..Kl..|
-00000030  17 d6 dc b9 7c 82 9e 61  c1 dd ea 17 03 03 00 19  |....|..a........|
-00000040  59 bd 70 5b d8 4e fd 09  1c 17 c1 82 6a 85 8b fc  |Y.p[.N......j...|
-00000050  2e 59 87 80 13 dc 3e 7a  01                       |.Y....>z.|
+00000000  14 03 03 00 11 c4 0e 59  d8 5e f6 5b 1d e6 20 7b  |.......Y.^.[.. {|
+00000010  45 4f 89 cd 2b a9 16 03  03 00 20 58 ff 80 6c f2  |EO..+..... X..l.|
+00000020  fd 94 e7 66 b3 6d e3 37  57 8a 8c 35 98 4e bb c3  |...f.m.7W..5.N..|
+00000030  42 87 32 b7 3b 6f ee 0f  f1 7d 08 17 03 03 00 19  |B.2.;o...}......|
+00000040  8a f6 02 17 4e 8a 1e 2b  db 44 24 d4 aa c6 d4 af  |....N..+.D$.....|
+00000050  ef 5a a3 17 ba 77 f4 54  6e                       |.Z...w.Tn|
 >>> Flow 15 (client to server)
-00000000  15 03 03 00 12 d9 80 6a  95 a6 37 81 5b d0 78 d3  |.......j..7.[.x.|
-00000010  4a 02 cc a6 ba b8 96                              |J......|
+00000000  15 03 03 00 12 84 3f 11  0b 00 bd 12 5e be 74 4d  |......?.....^.tM|
+00000010  04 e4 44 b2 01 73 66                              |..D..sf|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected
index 3d57311bb2..62b6831a47 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 0c 17 84 76 1d  |....]...Y.....v.|
-00000010  f7 2f 64 9b 6a be 05 1b  7c 96 bf f1 d3 33 37 d2  |./d.j...|....37.|
-00000020  4b 33 2d f9 16 12 0a 87  18 60 71 20 36 34 57 1e  |K3-......`q 64W.|
-00000030  53 7d 7c 52 c6 be a5 35  41 f6 72 65 3c 78 42 a5  |S}|R...5A.re<xB.|
-00000040  2b da 18 77 25 2f 0f d6  1b 3a 10 df cc a8 00 00  |+..w%/...:......|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 a1 1a ae 12 c9  |....]...Y.......|
+00000010  55 34 c9 23 81 cb 4f b0  d8 35 97 8e d5 b7 ac 67  |U4.#..O..5.....g|
+00000020  e1 9c fd ec 35 61 48 7b  d5 c8 8b 20 e1 e9 61 af  |....5aH{... ..a.|
+00000030  0b 5c 69 7b cb f9 7a ee  73 31 20 07 c3 b9 27 47  |.\i{..z.s1 ...'G|
+00000040  07 e1 c0 34 7c c5 8f 31  ac 9d cd 8c cc a8 00 00  |...4|..1........|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -63,191 +62,191 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 02 b5 bb  |............ ...|
-000002d0  3d 94 26 c2 04 4c 2d e6  e3 d0 e5 78 c1 00 eb de  |=.&..L-....x....|
-000002e0  df 23 8a f3 d7 67 0c d1  0b 5e 43 84 4f 08 04 00  |.#...g...^C.O...|
-000002f0  80 3d b9 6b 00 6e e7 cf  4a 27 67 de a2 d4 a4 ad  |.=.k.n..J'g.....|
-00000300  37 19 a3 66 ab 1e 92 7f  99 74 6b 4a 5e 3d e6 3b  |7..f.....tkJ^=.;|
-00000310  1a 0a d1 fe 2a 3a c9 08  d9 0a 1a 7f c1 83 fa 9e  |....*:..........|
-00000320  9d 8a 5e 2b 52 3a ef 09  91 63 db 4e 19 9c 59 ef  |..^+R:...c.N..Y.|
-00000330  a9 1c 23 12 8b d5 67 74  05 b7 c4 12 bd 1d 63 9a  |..#...gt......c.|
-00000340  97 a7 9c fe 94 ed 81 96  a6 e6 30 02 11 c2 97 eb  |..........0.....|
-00000350  0a f6 14 e7 d4 d3 11 5d  8f ff 77 f1 19 03 a3 16  |.......]..w.....|
-00000360  1e 0d 0e e1 9b f6 bd de  7e 40 d5 36 56 dd 85 44  |........~@.6V..D|
-00000370  5a 16 03 03 00 04 0e 00  00 00                    |Z.........|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 95 6f d7  |............ .o.|
+000002d0  37 b9 49 ff 98 39 6f 25  c5 c0 e0 89 61 23 2d 22  |7.I..9o%....a#-"|
+000002e0  5b 86 d6 7f a1 19 07 f7  12 4d 01 e6 1b 08 04 00  |[........M......|
+000002f0  80 ca fd 6e 23 09 33 a7  0c 9b 4b 2b 38 37 a0 32  |...n#.3...K+87.2|
+00000300  21 a4 e4 fe 56 b6 4e c6  d1 e6 86 fa d9 13 b4 f3  |!...V.N.........|
+00000310  72 bf 31 ef c3 33 e9 99  a1 bf a4 e5 10 46 44 7d  |r.1..3.......FD}|
+00000320  cb ea 38 99 d0 bc 1f 16  81 fb ad 09 7e 9e 54 99  |..8.........~.T.|
+00000330  40 c2 44 65 94 53 88 c3  28 db 7f 1b fa 52 f1 63  |@.De.S..(....R.c|
+00000340  9a e9 f2 43 7f 19 2b 3e  02 3d 53 ed a1 f9 9a ff  |...C..+>.=S.....|
+00000350  aa af 8d 4c ab bf d2 7a  b4 ea 1e f9 22 fe ee 7e  |...L...z...."..~|
+00000360  a1 3e dc d4 f1 76 d1 4e  7b 1b 84 f6 b3 a7 f7 a9  |.>...v.N{.......|
+00000370  37 16 03 03 00 04 0e 00  00 00                    |7.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 c3 8e 95  b8 d7 c3 39 43 fd 47 5f  |.... ......9C.G_|
-00000040  b5 3f 9e a3 7a a2 82 d5  82 cf d7 b7 9e 95 9f ed  |.?..z...........|
-00000050  fc f5 76 25 96                                    |..v%.|
+00000030  16 03 03 00 20 d0 64 37  7c 81 1c cd 86 e7 ab 97  |.... .d7|.......|
+00000040  25 1d c5 ee bd 5a 49 44  69 c8 3e db 37 6a dc 9a  |%....ZIDi.>.7j..|
+00000050  fd e2 5e 82 16                                    |..^..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 1e d5 ca 57 c6  |.......... ...W.|
-00000010  43 4f d3 11 44 d1 f8 69  d3 9e 22 17 d6 c1 7f aa  |CO..D..i..".....|
-00000020  ad d6 1f 08 67 9c cd 4f  9f 53 c0                 |....g..O.S.|
+00000000  14 03 03 00 01 01 16 03  03 00 20 18 71 b3 67 a3  |.......... .q.g.|
+00000010  98 36 20 8f e4 17 30 e4  73 de 91 88 ef f7 f3 8a  |.6 ...0.s.......|
+00000020  c6 0e 5e b2 1f e2 e6 5a  52 f6 72                 |..^....ZR.r|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 8d fa 48  d3 57 aa d7 8e 75 8b ff  |.......H.W...u..|
-00000010  bd 03 ea df 3e da d3 15  ec 12 67                 |....>.....g|
+00000000  17 03 03 00 16 20 c3 2a  be 39 d2 7c 1c 83 30 cc  |..... .*.9.|..0.|
+00000010  7b cd 44 ae 2b e8 d4 19  50 69 81                 |{.D.+...Pi.|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 14 e9 4d ee  89 18 5f bd d8 15 dd 1f  |......M..._.....|
-00000010  a4 94 98 3b 96 75 3c 2b  bc                       |...;.u<+.|
+00000000  16 03 03 00 14 96 2f 3a  b5 b5 56 c9 d5 38 c0 1a  |....../:..V..8..|
+00000010  eb 35 c5 b9 dd 1c 5b e6  50                       |.5....[.P|
 >>> Flow 7 (client to server)
-00000000  16 03 03 01 38 1c b1 26  7d 48 7e 75 46 3c 85 68  |....8..&}H~uF<.h|
-00000010  1c ef 2b 61 c1 f1 c5 dc  38 61 a1 2f a1 f1 3d b8  |..+a....8a./..=.|
-00000020  ab 39 ee c6 c1 2b ec fe  ea a8 0d d3 81 de 73 87  |.9...+........s.|
-00000030  d1 0b e7 cf d0 88 38 11  26 20 aa f4 39 4d 64 ea  |......8.& ..9Md.|
-00000040  97 b8 7c aa 4b b0 81 3d  2b 32 db 8c be 98 73 e2  |..|.K..=+2....s.|
-00000050  e6 81 8b 23 f9 c2 a9 d7  dd 31 17 0f c2 37 b5 95  |...#.....1...7..|
-00000060  31 3f 6b 62 0f 57 73 56  bd 94 d9 87 40 e4 43 46  |1?kb.WsV....@.CF|
-00000070  fc ae cb b6 f9 7c 0a 8b  04 a6 d7 0f ca 66 42 93  |.....|.......fB.|
-00000080  f6 0e 89 b1 b3 1c 6e 4a  a2 d3 b3 1b 33 6c cd 83  |......nJ....3l..|
-00000090  15 99 4f 3c 2c 27 b0 82  18 1a 0f ba e3 b1 55 aa  |..O<,'........U.|
-000000a0  5d 2b 92 24 c4 be 22 3e  07 c6 18 d6 5a 19 f7 5a  |]+.$..">....Z..Z|
-000000b0  f0 6e fe 2a 2c 61 6b cb  9b d3 ad ea 78 c1 9e a2  |.n.*,ak.....x...|
-000000c0  fb 5a 9c e0 d7 0e fb 33  ca 9a ed 2b f9 b2 e8 bf  |.Z.....3...+....|
-000000d0  82 2c 28 09 fd 44 cd 30  b0 e4 a8 5c 8f 28 d1 f5  |.,(..D.0...\.(..|
-000000e0  93 46 33 bd ba 18 ff e5  45 19 da 52 34 48 15 7f  |.F3.....E..R4H..|
-000000f0  39 bd 78 66 9d e4 fd af  58 59 44 8a 46 cc 2c 37  |9.xf....XYD.F.,7|
-00000100  95 26 20 dd 14 65 73 d2  3c 25 e2 54 21 be c5 f6  |.& ..es.<%.T!...|
-00000110  a1 9a 94 e8 41 aa 4b 75  b7 f8 03 78 a4 8a b8 28  |....A.Ku...x...(|
-00000120  7f 72 17 60 37 07 a5 2a  dd 65 34 97 9c ee 72 27  |.r.`7..*.e4...r'|
-00000130  29 14 d8 b9 ed fc 4d fa  df 8b a9 7f 7f           |).....M......|
+00000000  16 03 03 01 34 ae 4f 4c  78 20 df 3b 9e f3 c1 82  |....4.OLx .;....|
+00000010  37 6b ca fc 48 2a 2c 9a  71 7e c3 20 a0 e8 f7 d5  |7k..H*,.q~. ....|
+00000020  76 af 11 81 dd 69 e9 93  58 df 58 8c fb f1 82 ad  |v....i..X.X.....|
+00000030  35 0e fb 6c a9 58 7a 5d  79 38 cb d7 77 1f 93 34  |5..l.Xz]y8..w..4|
+00000040  7e bb 88 61 9e 19 1a 98  bb 6f ad 78 2c a6 73 ab  |~..a.....o.x,.s.|
+00000050  a4 7e 4b d7 75 69 7b 92  47 68 3d 7b 40 03 60 59  |.~K.ui{.Gh={@.`Y|
+00000060  2e 04 bc cd fc ca 45 2c  2c f7 e5 0a 66 49 0b 86  |......E,,...fI..|
+00000070  c5 ec 86 e6 ae c9 39 4b  05 1f 21 db 78 8d 51 e6  |......9K..!.x.Q.|
+00000080  5d fe be 6a 1d 85 e1 15  23 56 86 4c ba 09 bf 7b  |]..j....#V.L...{|
+00000090  9e 36 e9 7a 8f 06 af 10  7b 4a 4b af 58 db f9 4e  |.6.z....{JK.X..N|
+000000a0  13 36 61 f4 e3 a9 c6 37  11 d4 ed 9e 6a c7 bf 16  |.6a....7....j...|
+000000b0  ea a4 ae 01 99 4a b5 3e  9c ca 6c ce e8 a2 3d b8  |.....J.>..l...=.|
+000000c0  81 ef 60 7b 51 79 81 22  87 49 ad ab fb c6 f6 48  |..`{Qy.".I.....H|
+000000d0  c0 ba e0 2b d7 90 42 f7  a8 0d f0 cf 2c 7a 55 7d  |...+..B.....,zU}|
+000000e0  be 65 a6 67 bd 96 7f 01  6f ce db f6 50 2f 45 b6  |.e.g....o...P/E.|
+000000f0  6f cc 74 ba 6f 57 3b e3  a4 08 34 92 e6 ac e4 99  |o.t.oW;...4.....|
+00000100  2e b6 9b 29 4d 26 dd 7f  5c f5 1b 7e 5e 5c fd f7  |...)M&..\..~^\..|
+00000110  d4 da 81 47 51 8c 3f 94  e1 95 5b de b9 6e 4a 76  |...GQ.?...[..nJv|
+00000120  bc 59 6a bb 1f 1c 79 02  93 2e 21 b3 6d be ae b4  |.Yj...y...!.m...|
+00000130  95 6b 8a 48 cb 84 fb ab  b3                       |.k.H.....|
 >>> Flow 8 (server to client)
-00000000  16 03 03 00 85 f4 88 c2  bb 0e c4 2f bc 16 6e 10  |.........../..n.|
-00000010  80 16 34 b2 20 c8 8f 01  64 1a 78 f9 0b d4 b9 4d  |..4. ...d.x....M|
-00000020  97 52 5e 79 86 37 c1 db  ae 6f 7a 41 d4 6f 44 0a  |.R^y.7...ozA.oD.|
-00000030  79 e6 56 02 03 e4 ff 65  cc 7f 95 08 c8 e7 bc 77  |y.V....e.......w|
-00000040  7c 7a 3f 85 04 37 50 55  6c 5f 43 b2 28 9e b5 55  ||z?..7PUl_C.(..U|
-00000050  f6 a7 3c 9a e3 ef 40 76  14 6e 22 1d 09 3f d1 7c  |..<...@v.n"..?.||
-00000060  ba 89 7c 5f e7 91 c3 e8  22 c3 a4 77 e4 da e7 63  |..|_...."..w...c|
-00000070  de ea 1b 1f a8 f2 27 a9  ec 95 03 ef b7 96 64 cf  |......'.......d.|
-00000080  56 56 58 a4 8f c0 f7 58  60 55 16 03 03 02 69 64  |VVX....X`U....id|
-00000090  1f e8 68 47 de 6d 1f 7b  ed 24 0d 7b b4 7e 45 fd  |..hG.m.{.$.{.~E.|
-000000a0  0e 76 9e b8 58 0e fb 00  b1 29 74 93 ce 54 29 e4  |.v..X....)t..T).|
-000000b0  bb 72 1d ea b7 a0 5e d2  b6 31 de 0d c5 72 8c 75  |.r....^..1...r.u|
-000000c0  13 17 41 b6 96 2b e7 f4  4f c4 3f 18 d9 3b 74 65  |..A..+..O.?..;te|
-000000d0  dd 7a df 4f b6 5b 95 ff  24 13 a4 84 15 89 d7 cc  |.z.O.[..$.......|
-000000e0  fc 26 2f e9 8c e6 89 9d  9f d8 65 46 63 5e a0 1d  |.&/.......eFc^..|
-000000f0  2e 50 65 f6 6d df 65 3c  a6 87 c5 65 e5 76 5d 31  |.Pe.m.e<...e.v]1|
-00000100  0d f5 54 4a 05 ec 19 0a  25 54 54 7b ab 34 fb df  |..TJ....%TT{.4..|
-00000110  d2 91 f5 06 36 77 39 1a  67 ab d7 c9 41 a2 eb f4  |....6w9.g...A...|
-00000120  ce c5 3e 0a 02 d8 c7 e0  48 99 2a 2b 2d 97 74 03  |..>.....H.*+-.t.|
-00000130  64 9b 8c d3 fc 65 17 ce  5a 20 2d 66 e9 9a a6 bc  |d....e..Z -f....|
-00000140  48 3c 08 65 d3 6f 47 c7  76 b1 59 6a b0 1c 45 b4  |H<.e.oG.v.Yj..E.|
-00000150  24 9d 71 83 fb 49 96 cb  c4 b9 8a 52 9a 28 92 66  |$.q..I.....R.(.f|
-00000160  6e ef 7c a9 a8 88 d5 16  de 96 8e 67 89 cf 62 12  |n.|........g..b.|
-00000170  93 63 7f e1 b0 76 0b 49  1a 61 af 02 e7 a0 51 9f  |.c...v.I.a....Q.|
-00000180  70 41 45 6f b1 d3 f8 cd  ce d5 d0 a7 e1 f3 1e 7c  |pAEo...........||
-00000190  50 20 ab 03 13 de 4c 1e  b4 f3 6b 21 3f 41 99 4d  |P ....L...k!?A.M|
-000001a0  d0 ca cd de 88 a1 bc 56  72 63 e8 55 c1 31 72 b2  |.......Vrc.U.1r.|
-000001b0  b2 a3 ea cf 39 8b 7f 82  55 1a 05 fb 6b c3 b7 6d  |....9...U...k..m|
-000001c0  08 0f 2a 34 ad 74 10 e0  4a 53 80 f7 98 a4 d6 f1  |..*4.t..JS......|
-000001d0  9c e5 9a 61 a0 f0 ca 30  54 f3 d9 a7 c4 54 08 3c  |...a...0T....T.<|
-000001e0  23 30 f5 3e c6 96 2c 97  84 7c 3d 13 0c 4a e6 0f  |#0.>..,..|=..J..|
-000001f0  ea 99 9c ba e5 34 a2 e6  74 e5 c0 86 d1 4e d4 ed  |.....4..t....N..|
-00000200  a1 e2 81 0a cc ec f8 d2  0a 0d 53 87 d7 d7 cc 75  |..........S....u|
-00000210  6d a8 c0 25 de 31 f3 cb  08 71 f0 e3 5e 7f d0 5c  |m..%.1...q..^..\|
-00000220  fb 48 1a a4 f9 70 08 14  a3 3b 90 87 94 0c 70 df  |.H...p...;....p.|
-00000230  9d b6 db 94 55 99 ac 18  df d1 d5 8c 16 8c c9 25  |....U..........%|
-00000240  2d 78 60 69 66 fb 0d 09  39 18 aa 77 b2 fb ed d1  |-x`if...9..w....|
-00000250  58 d5 53 6a 32 05 6f cc  35 16 6f 19 98 31 f4 36  |X.Sj2.o.5.o..1.6|
-00000260  af 1b 88 39 ad 3b a9 46  b5 49 b3 8e 26 76 ab 02  |...9.;.F.I..&v..|
-00000270  a4 ba f3 29 e5 08 f9 47  a6 b4 f0 ad 4d 70 c6 80  |...)...G....Mp..|
-00000280  ab 33 c7 5a 57 a7 40 37  6b 53 96 e9 35 88 78 bf  |.3.ZW.@7kS..5.x.|
-00000290  dd 81 f8 2f 9c 4d c1 d1  ce 45 16 a4 fb 57 bd ff  |.../.M...E...W..|
-000002a0  67 1c 3f 3f d2 49 89 a2  f3 b3 b9 4b 74 04 c4 e5  |g.??.I.....Kt...|
-000002b0  83 7c ff 9f a0 6b d2 c3  6a 07 ab 91 65 40 ba 20  |.|...k..j...e@. |
-000002c0  7a 59 f1 66 ba f8 47 b1  ab 03 96 c3 e2 57 8d f5  |zY.f..G......W..|
-000002d0  a6 43 a3 6b 6b 9d 42 18  9b 6a 41 09 75 db 8b b7  |.C.kk.B..jA.u...|
-000002e0  7a a6 0e 7e d4 ee da a8  eb 8b 0d 39 8a 1d 6e b5  |z..~.......9..n.|
-000002f0  9b 6a b1 57 f9 9d ec 01  16 03 03 00 bc 5a c0 bc  |.j.W.........Z..|
-00000300  54 9d 60 e3 68 3c 67 38  46 de cb 1f f0 fb 11 90  |T.`.h<g8F.......|
-00000310  10 b6 1b 7a dc f5 91 9c  74 c2 42 91 06 a2 98 17  |...z....t.B.....|
-00000320  27 d0 16 06 3f 02 f6 8e  fb 4c 64 d0 5d 42 06 cd  |'...?....Ld.]B..|
-00000330  aa 11 ec 78 e0 6b d9 97  c0 0f fc 27 9d 8d 8d 8d  |...x.k.....'....|
-00000340  89 cd c3 43 57 86 83 48  d5 00 3b 2b e2 7f 57 48  |...CW..H..;+..WH|
-00000350  4d 11 5e 7a 08 1b f9 01  9a 8e dc 0f c0 a9 9d b7  |M.^z............|
-00000360  86 09 5d 40 3c 12 60 b0  9f 08 26 f2 86 9b 4f 99  |..]@<.`...&...O.|
-00000370  50 f7 9c d6 ff f0 a8 ce  ca 17 57 7a 55 12 fb 5a  |P.........WzU..Z|
-00000380  82 9a fb 3d 05 16 7d 72  9f e5 a1 38 e3 ac fd 72  |...=..}r...8...r|
-00000390  af b0 60 5a ce 67 d9 8e  dc 16 19 17 c7 d6 19 a2  |..`Z.g..........|
-000003a0  a4 97 fe b3 a2 4f 1d 8a  99 72 8f c0 b7 a1 e1 9d  |.....O...r......|
-000003b0  9f 71 fb 90 f5 33 5f c6  e3 16 03 03 00 4a 21 2b  |.q...3_......J!+|
-000003c0  fd 5e f3 e5 f3 86 94 aa  e9 b1 29 a8 dd 96 02 28  |.^........)....(|
-000003d0  e9 8a 82 64 cb 22 06 72  5f 33 f7 70 1b 2a c4 8a  |...d.".r_3.p.*..|
-000003e0  06 fc ee 04 e8 34 d9 88  87 7c 15 7c ce 0d 04 88  |.....4...|.|....|
-000003f0  3c 56 aa 22 57 2f b8 52  eb d8 4c af 34 94 c1 9a  |<V."W/.R..L.4...|
-00000400  a0 ad f2 8d cd 3a a2 5d  16 03 03 00 14 34 4d ae  |.....:.].....4M.|
-00000410  1e 00 57 a0 80 d9 7a e6  04 1e 03 43 1f d5 49 87  |..W...z....C..I.|
-00000420  b7                                                |.|
+00000000  16 03 03 00 85 60 c6 c2  9b 61 f1 1f 81 6f f1 0b  |.....`...a...o..|
+00000010  87 2d f2 93 a6 4e 7e 74  c2 61 cf 1d a1 00 32 8f  |.-...N~t.a....2.|
+00000020  f7 3d 93 da 91 cc 5b d5  21 c6 ba 4c 1b eb 81 a9  |.=....[.!..L....|
+00000030  a1 2a fe 88 6d 3e 1d 1f  57 22 9c ff fe 6c 85 ca  |.*..m>..W"...l..|
+00000040  0b 13 f3 9f 63 55 b9 49  61 2b dd 5e 2b e1 fd ec  |....cU.Ia+.^+...|
+00000050  1d 0d 94 06 42 dc 2c 6f  88 22 cb 30 4f 66 6f 16  |....B.,o.".0Ofo.|
+00000060  3a a0 c0 23 12 82 46 38  70 68 e5 12 b9 16 12 e7  |:..#..F8ph......|
+00000070  38 6b 50 64 55 f0 47 a9  e0 cd 19 01 8e d5 12 96  |8kPdU.G.........|
+00000080  09 db 5c 52 4b db 9b 26  43 37 16 03 03 02 69 41  |..\RK..&C7....iA|
+00000090  52 a8 ca e5 8f e0 33 4b  52 93 74 ef bb 42 20 d1  |R.....3KR.t..B .|
+000000a0  cc 24 79 ce df 51 90 e0  19 b1 11 fb e9 ef b5 e4  |.$y..Q..........|
+000000b0  ae da 72 e1 35 a8 41 88  a8 4b 68 d2 50 58 ba ef  |..r.5.A..Kh.PX..|
+000000c0  b0 1e 20 26 a3 c2 86 a7  68 60 84 2d 23 14 38 21  |.. &....h`.-#.8!|
+000000d0  12 60 05 2f 79 9e c0 08  4c 87 a7 41 b3 d3 84 9a  |.`./y...L..A....|
+000000e0  f1 45 bd 2d ff 7c b5 bd  c4 3a b1 48 10 9a d8 cf  |.E.-.|...:.H....|
+000000f0  ce 58 47 75 e1 6d 01 b6  18 bd 78 6b 86 a1 f2 1b  |.XGu.m....xk....|
+00000100  c8 03 4d 0a ce ce d4 68  8f 9a 54 1e 83 83 89 2c  |..M....h..T....,|
+00000110  36 a2 3a b5 95 09 de c5  8e 8c d0 a4 95 59 7e d6  |6.:..........Y~.|
+00000120  f8 5f 96 e9 c5 cb 9b 6c  c0 b7 55 15 b3 b4 d0 ea  |._.....l..U.....|
+00000130  bf 11 1c 89 1a 5c f2 09  74 9a 43 73 4f 6f 00 33  |.....\..t.CsOo.3|
+00000140  b9 e0 6a 99 b9 e0 02 86  dd cd 07 68 72 63 0d 8b  |..j........hrc..|
+00000150  e0 e8 12 68 4d f6 3b dc  0a 93 82 48 ce f7 96 ba  |...hM.;....H....|
+00000160  7f c5 90 07 45 66 3d 47  b8 8d 5f 0d 41 8d 88 76  |....Ef=G.._.A..v|
+00000170  bf ce 9c 2a 2e 25 7c 47  f6 96 73 0b 43 42 73 2c  |...*.%|G..s.CBs,|
+00000180  d5 b3 bc 82 c5 19 2f 5d  c4 69 21 7d c8 7b 1b b8  |....../].i!}.{..|
+00000190  b6 d1 37 89 92 a6 b7 44  cd e6 23 1f a1 03 08 05  |..7....D..#.....|
+000001a0  1e cf 54 78 e9 af 04 bc  e3 94 aa 12 ce 67 62 ce  |..Tx.........gb.|
+000001b0  f4 2f ef f7 2b 8d 65 06  08 07 2f c6 fa b2 d2 c8  |./..+.e.../.....|
+000001c0  f1 d7 c4 1f cc 8b 0e b8  f2 b2 1d fb 09 19 5a b0  |..............Z.|
+000001d0  a3 23 6e 05 20 9a 28 39  16 05 0e c4 7d d0 59 f5  |.#n. .(9....}.Y.|
+000001e0  9a de 88 da a2 c0 fb 7b  84 19 05 7d 80 6f 9a 03  |.......{...}.o..|
+000001f0  0a f8 5f 97 a2 b4 c0 d9  6d 79 f5 c0 51 d3 63 d2  |.._.....my..Q.c.|
+00000200  b8 ee a6 b0 76 59 7f 92  6d ad 3c bb 96 34 ac 0c  |....vY..m.<..4..|
+00000210  81 61 c5 07 7e 65 f1 c3  dd 3e 69 ad ee 7f 56 8d  |.a..~e...>i...V.|
+00000220  d7 92 48 5c 23 be 94 44  2e 8a 13 76 ce a3 cb d2  |..H\#..D...v....|
+00000230  86 d5 eb 2c 48 55 fd 31  c1 94 08 55 69 8c 20 cd  |...,HU.1...Ui. .|
+00000240  65 fa 47 5e 8e 7f 04 a4  a0 54 c3 cf 4e b5 a0 61  |e.G^.....T..N..a|
+00000250  3a 66 fd 21 5d 42 ab b3  46 d8 2a 64 69 1a d3 da  |:f.!]B..F.*di...|
+00000260  41 65 2c 36 50 f1 79 c3  83 01 d2 87 41 d9 10 1d  |Ae,6P.y.....A...|
+00000270  75 a2 74 de 48 e3 9c 9e  c8 96 58 45 43 82 dd d6  |u.t.H.....XEC...|
+00000280  e1 46 66 2f 13 e4 1d fe  81 8f ea 3d 6d 83 d7 97  |.Ff/.......=m...|
+00000290  4d ed c6 67 0e 4b e5 a1  ca 2b 24 c5 b1 24 af df  |M..g.K...+$..$..|
+000002a0  7a 0e 44 b9 c1 5f 07 43  c1 6f 94 d3 22 fb 14 df  |z.D.._.C.o.."...|
+000002b0  a3 23 38 c9 91 ff 12 41  fa 47 f7 83 fb b6 ca ea  |.#8....A.G......|
+000002c0  19 01 22 8a ba d7 86 c5  d2 82 2f ac f5 4c a4 e9  |.."......./..L..|
+000002d0  90 f5 52 c7 88 96 ae f3  0a 91 53 1c db bf 4b a9  |..R.......S...K.|
+000002e0  42 43 0d 2d cc f2 6a 79  1e 9a 3a bd 55 da 5d 6c  |BC.-..jy..:.U.]l|
+000002f0  a3 84 79 76 7d 96 62 5e  16 03 03 00 bc 51 62 b9  |..yv}.b^.....Qb.|
+00000300  26 c9 f7 dd 55 83 aa cd  90 5d e9 9a 29 92 8c 6f  |&...U....]..)..o|
+00000310  b1 df 4c b7 be 75 89 2b  dc b1 ad ae 01 38 27 0f  |..L..u.+.....8'.|
+00000320  36 43 0b 04 69 6b a4 3a  52 b5 4f df 50 1d 04 ee  |6C..ik.:R.O.P...|
+00000330  4a f1 a0 6c 06 6f 24 2a  f3 dc 7c a4 96 12 e2 83  |J..l.o$*..|.....|
+00000340  9c d8 2d 63 2e 3b 1c 73  e6 32 ce 15 76 01 9a a9  |..-c.;.s.2..v...|
+00000350  3b a7 dc aa 40 82 4d 5a  68 24 78 4e fe 64 db a4  |;...@.MZh$xN.d..|
+00000360  ff 87 6d 90 bc d9 ec 0d  ed 8b 54 12 bd 74 16 1d  |..m.......T..t..|
+00000370  2c 30 57 8f 67 56 7c 09  e6 b1 12 f8 4a 9f e3 79  |,0W.gV|.....J..y|
+00000380  c1 8b fa 91 f7 1a 29 bd  a3 1f 59 59 16 26 04 10  |......)...YY.&..|
+00000390  e4 19 c9 91 a6 b3 c5 b5  df a3 b0 11 a5 87 29 4e  |..............)N|
+000003a0  5b 9f 96 cf 88 19 9e ae  b4 e6 63 19 6d c5 ee 7a  |[.........c.m..z|
+000003b0  c9 38 2d 0a fd f6 3b f8  f5 16 03 03 00 4a f5 3f  |.8-...;......J.?|
+000003c0  ef a3 f8 86 1b f5 ce 8e  48 f2 d0 cb 75 d6 80 b2  |........H...u...|
+000003d0  78 ef bc 77 a6 aa 91 cd  88 39 62 f8 42 78 7c f3  |x..w.....9b.Bx|.|
+000003e0  8b c7 86 71 9c a5 9f 1c  5f 40 25 e9 c6 69 82 a1  |...q...._@%..i..|
+000003f0  45 ee d1 9d f7 9c a0 b9  34 b8 82 72 f9 f8 1d fb  |E.......4..r....|
+00000400  a5 74 b5 a5 68 04 82 c4  16 03 03 00 14 07 9c 37  |.t..h..........7|
+00000410  77 ad 83 27 66 2c 3a ba  26 22 2f 72 b4 d1 c8 c1  |w..'f,:.&"/r....|
+00000420  06                                                |.|
 >>> Flow 9 (client to server)
-00000000  16 03 03 02 69 3d ff d3  96 89 9f 41 3d 64 0c 71  |....i=.....A=d.q|
-00000010  e5 80 34 1f 5d 8a cb b4  47 08 c8 c0 7d 17 3b db  |..4.]...G...}.;.|
-00000020  d4 d1 9d 98 16 b9 84 73  c9 8a ff 76 bf 1e f0 bd  |.......s...v....|
-00000030  da 35 a8 2a d5 6a 28 cf  66 bf e0 dc 45 a9 8f 61  |.5.*.j(.f...E..a|
-00000040  65 75 99 29 fe 5a c8 46  2e 14 10 79 a2 b9 c9 04  |eu.).Z.F...y....|
-00000050  37 f8 01 8e 72 2b b7 c9  23 75 51 59 b9 8d 4a 87  |7...r+..#uQY..J.|
-00000060  9d 54 5d 70 25 66 5b 70  a7 04 e4 c0 6a e9 25 8f  |.T]p%f[p....j.%.|
-00000070  1b e0 39 59 b4 f3 0a 3b  42 bd 25 f3 e3 38 45 d6  |..9Y...;B.%..8E.|
-00000080  d9 22 b6 1f 40 72 19 2d  c6 1d 22 66 c5 cb 10 2c  |."..@r.-.."f...,|
-00000090  1c 6a f8 fc ca f3 b4 f1  d2 e5 cf 7b ef 89 e6 9b  |.j.........{....|
-000000a0  c5 5e 4e 83 6b 55 2f 01  da ad d4 3c 91 d4 17 f2  |.^N.kU/....<....|
-000000b0  8c ee ae e1 6c b4 c9 9d  33 b1 7c d3 e4 61 72 8f  |....l...3.|..ar.|
-000000c0  81 26 8f b9 c5 3f ca 42  00 16 57 1c 9a d2 37 80  |.&...?.B..W...7.|
-000000d0  76 47 b7 59 3c 39 b6 d2  0b 83 45 d1 3e 4d c4 8d  |vG.Y<9....E.>M..|
-000000e0  24 8f 95 f6 44 2f 45 70  69 6f 82 13 f7 42 a2 de  |$...D/Epio...B..|
-000000f0  bb 86 af c3 b1 eb aa 34  ae 5d fb c2 e1 5c 87 d1  |.......4.]...\..|
-00000100  2b f4 36 1f da cf 94 b7  fd 78 de 96 0a cd f5 80  |+.6......x......|
-00000110  6d a5 7c fa a0 1a dd aa  ef 0f 4c 7a cc 10 33 e0  |m.|.......Lz..3.|
-00000120  be c1 1c 9e 3f e0 4c a8  93 95 da 5d 01 bd a8 84  |....?.L....]....|
-00000130  8b e8 53 c2 69 04 92 fa  54 16 38 d7 82 17 07 da  |..S.i...T.8.....|
-00000140  71 af 5d 82 72 3d 6b 10  fd 46 b5 a2 8d 6e fe f8  |q.].r=k..F...n..|
-00000150  65 4a 48 6f 2e e3 8d b9  97 23 7f 51 ec 32 07 3b  |eJHo.....#.Q.2.;|
-00000160  1c df 26 be 29 e7 95 77  ed 1e d0 b2 d9 68 e4 65  |..&.)..w.....h.e|
-00000170  5b e7 97 58 ec 50 0c d1  e1 6e 76 73 d5 7b 37 41  |[..X.P...nvs.{7A|
-00000180  03 03 dd 07 53 48 d6 8c  d5 69 83 05 06 1e 59 54  |....SH...i....YT|
-00000190  9a cb 50 c5 55 12 23 47  57 83 50 83 58 ec 97 95  |..P.U.#GW.P.X...|
-000001a0  09 de e9 01 d7 62 43 eb  1d 80 82 08 c0 1e 7d d4  |.....bC.......}.|
-000001b0  6b d5 dd b7 0c 8d 7f 7c  2d ed f9 b1 16 38 ec b7  |k......|-....8..|
-000001c0  a0 1b 5a da a6 6f b2 59  ce ff d9 fc 9b 0c fc 16  |..Z..o.Y........|
-000001d0  27 5e 79 68 f8 3d 0b dc  bb 6d 9f 0d 4d 3b 19 d4  |'^yh.=...m..M;..|
-000001e0  0f 36 59 5f 41 c4 f6 9c  c1 47 f5 65 e0 d8 b1 06  |.6Y_A....G.e....|
-000001f0  3b 05 6c 90 fd f2 e8 b1  33 a9 1c a7 84 f4 e6 02  |;.l.....3.......|
-00000200  f3 80 2e 9f 81 13 01 ea  9f 09 f0 55 22 34 93 bf  |...........U"4..|
-00000210  b2 13 07 62 f0 fc 3e 08  b2 8d cb 62 64 33 a4 e6  |...b..>....bd3..|
-00000220  1c 26 ff 4e fe 28 3e 82  58 ce 82 a1 ef a4 14 f3  |.&.N.(>.X.......|
-00000230  81 59 e2 29 da 30 ef 1d  20 75 1a 7f 27 b5 90 be  |.Y.).0.. u..'...|
-00000240  40 fc 52 08 0a 62 c4 53  4f 6d e9 fb 96 81 8c 1e  |@.R..b.SOm......|
-00000250  3d 3f bc 87 fb fb 6c 8b  17 7a 14 38 53 df 0c ef  |=?....l..z.8S...|
-00000260  f4 12 24 fa 77 ce 0b 2a  ea 1d 1e 0c 8e 50 16 03  |..$.w..*.....P..|
-00000270  03 00 35 28 fe 49 cd b2  80 e8 65 78 83 02 1f 03  |..5(.I....ex....|
-00000280  75 ab 8c f6 cb c0 fa 86  8f 5e b2 63 f8 a4 37 b9  |u........^.c..7.|
-00000290  2b 82 9e 27 cb 82 97 c6  7c 90 cc de 19 d2 cc 7e  |+..'....|......~|
-000002a0  19 c1 5e da 99 87 05 31  16 03 03 00 98 09 f8 56  |..^....1.......V|
-000002b0  7f 7d 66 c3 a3 e0 e2 68  48 b6 38 cb 6c ca b9 28  |.}f....hH.8.l..(|
-000002c0  ff 5b 52 f9 7b 69 ba 92  a9 ba 25 7a 0a fe 97 3b  |.[R.{i....%z...;|
-000002d0  73 f2 b6 8b a7 cb d6 cf  9e da f1 ce d7 41 98 d3  |s............A..|
-000002e0  3d 59 ef 9c 14 78 e2 d7  46 0b 63 b2 aa 4e 02 1e  |=Y...x..F.c..N..|
-000002f0  40 78 a2 e6 55 c2 20 88  ab 0e bd a8 78 76 4d fe  |@x..U. .....xvM.|
-00000300  68 c4 ad c0 7e 9d 2b 0c  08 e9 0f 65 1c 9e 38 df  |h...~.+....e..8.|
-00000310  f9 07 1f 8a 6b 2c af 94  89 35 75 61 e9 5f 2b 90  |....k,...5ua._+.|
-00000320  b4 38 15 26 a1 ea 15 dc  76 09 0a 2b ff 2d 42 ab  |.8.&....v..+.-B.|
-00000330  b5 f7 37 ce ec 34 8e 9a  55 b5 01 56 98 46 b7 1e  |..7..4..U..V.F..|
-00000340  07 30 0d 25 8a 14 03 03  00 11 c7 b7 3a b1 86 25  |.0.%........:..%|
-00000350  cf 3e a6 ce 37 36 65 11  b2 85 13 16 03 03 00 20  |.>..76e........ |
-00000360  c8 69 c3 d3 63 3d 94 1c  78 e2 b7 dd 84 b5 f9 2d  |.i..c=..x......-|
-00000370  d6 ed 39 fe 23 48 ee 7a  75 17 21 70 eb b8 96 56  |..9.#H.zu.!p...V|
+00000000  16 03 03 02 69 70 78 66  7a 28 3b 50 a6 21 b2 cc  |....ipxfz(;P.!..|
+00000010  52 a6 74 f7 29 8a dc fd  c0 1c 79 d0 20 23 d0 74  |R.t.).....y. #.t|
+00000020  d3 16 a6 4c 6d df 6e 32  2e 69 46 dd 8d 22 9e 8e  |...Lm.n2.iF.."..|
+00000030  cb 75 44 75 7e 24 69 ed  ce cf 5c 4b a9 a2 b5 d0  |.uDu~$i...\K....|
+00000040  48 bf 08 d8 1d 16 d9 9f  6d b4 24 ee f1 f3 58 79  |H.......m.$...Xy|
+00000050  4c 19 4c 99 7f 01 a8 80  b1 3c 4e 55 d1 64 75 89  |L.L......<NU.du.|
+00000060  5a 4a a1 fa cb c2 8c e8  0f de 58 05 bb 1b 1d ab  |ZJ........X.....|
+00000070  3a d8 ed 26 af ea 31 b4  7a e2 09 f6 8a 71 ce ab  |:..&..1.z....q..|
+00000080  7c b1 f1 3f 0f 7b 85 64  92 4c 8f e1 6a 2d c8 d0  ||..?.{.d.L..j-..|
+00000090  7b 01 dd 4d 2d 22 ba 7c  85 1e 35 1d d5 59 67 63  |{..M-".|..5..Ygc|
+000000a0  5f 17 88 e4 32 b2 f7 8f  4a b3 46 aa 82 25 8c 93  |_...2...J.F..%..|
+000000b0  61 3c e6 2e b1 48 73 9a  27 d9 d6 b5 5c 0d 75 07  |a<...Hs.'...\.u.|
+000000c0  aa 67 df f4 e4 c4 f3 ef  1f 31 55 a1 82 c6 66 32  |.g.......1U...f2|
+000000d0  e0 8f 29 eb ae e0 73 bf  0a c4 ac a9 f0 bb 18 46  |..)...s........F|
+000000e0  5f 6b 4d 76 55 10 b2 1e  20 22 44 8b 3f 12 03 84  |_kMvU... "D.?...|
+000000f0  d8 71 45 c7 f4 76 9f 99  15 5e 9a 44 08 41 ee d6  |.qE..v...^.D.A..|
+00000100  dd 5f 73 d5 2c 87 6a 0f  97 06 b5 a8 23 71 56 33  |._s.,.j.....#qV3|
+00000110  26 f2 63 fd 3e 3f d9 50  6a 61 64 2a 51 9f e6 19  |&.c.>?.Pjad*Q...|
+00000120  01 2e 5a 1c 8b 12 58 c5  32 e1 3f ea 0b ac 4c 3b  |..Z...X.2.?...L;|
+00000130  1d 97 11 e9 92 6d 52 f0  1e f7 5a f8 71 5f f5 a6  |.....mR...Z.q_..|
+00000140  6b aa 30 4f 85 41 c6 49  83 37 3a 72 86 1a be 7a  |k.0O.A.I.7:r...z|
+00000150  1d bc d6 ad 67 6c 95 42  5d 74 10 8e ac 4b 8d b3  |....gl.B]t...K..|
+00000160  6e 3d 9c 8f 08 71 be ce  ce aa 64 26 62 2a 58 8c  |n=...q....d&b*X.|
+00000170  e4 7b 75 e9 61 90 38 b2  c2 a0 8d c7 a9 11 cf 5b  |.{u.a.8........[|
+00000180  30 a7 33 3b 2b c2 fd 2a  6b db 3d cf 35 6c 23 28  |0.3;+..*k.=.5l#(|
+00000190  14 e4 7b 10 50 e8 00 9f  af 60 69 cf a9 d9 93 f3  |..{.P....`i.....|
+000001a0  8f 7d 39 49 97 5b 92 4a  35 2a 6c 68 3b 48 25 77  |.}9I.[.J5*lh;H%w|
+000001b0  6e d0 57 76 c4 94 83 10  e3 3d 00 e8 b9 fe da d9  |n.Wv.....=......|
+000001c0  a5 56 22 61 e0 f4 33 dd  c8 dd 4d 2f 39 51 35 12  |.V"a..3...M/9Q5.|
+000001d0  9a cb dd e1 03 d3 27 9f  41 71 83 5c c7 6c a3 38  |......'.Aq.\.l.8|
+000001e0  9f db 39 1c 2a f6 4b e0  48 44 61 1b 34 3c bc ed  |..9.*.K.HDa.4<..|
+000001f0  7a 31 c9 9f 8e 82 2d fb  b6 bd 6e 4c 57 76 23 f5  |z1....-...nLWv#.|
+00000200  7d 68 ff 02 75 42 10 e7  2d 24 83 4a 04 7a 78 d7  |}h..uB..-$.J.zx.|
+00000210  60 b2 70 07 3f e4 bc 54  42 65 22 c3 2e aa 35 85  |`.p.?..TBe"...5.|
+00000220  df fa e5 c9 c9 f5 ee 6a  50 82 7a bf 92 96 78 5e  |.......jP.z...x^|
+00000230  a8 ac 2a d1 5e e2 f0 20  6b 51 97 3d 74 71 eb d8  |..*.^.. kQ.=tq..|
+00000240  40 5f 06 72 b6 8c 1c 2a  71 dd 53 38 fb de b6 31  |@_.r...*q.S8...1|
+00000250  53 8d 8f 4e 0f c1 a5 ea  bf 27 fa ed ff 0c 56 34  |S..N.....'....V4|
+00000260  55 88 e1 d2 65 a7 e5 10  02 4d ba 8e ad fa 16 03  |U...e....M......|
+00000270  03 00 35 94 36 93 c6 5e  c8 ec 8e 63 86 7b 13 d6  |..5.6..^...c.{..|
+00000280  78 b2 5d 2f 54 55 5a 41  1c 65 5e b2 69 ab c2 bd  |x.]/TUZA.e^.i...|
+00000290  d9 a3 55 42 d1 96 29 51  c4 38 c4 ec 1f d4 19 6c  |..UB..)Q.8.....l|
+000002a0  2b 82 75 81 37 07 79 35  16 03 03 00 98 d9 a2 ba  |+.u.7.y5........|
+000002b0  86 ca f4 24 e1 e0 72 0e  21 81 f6 c5 d7 0a 1c 17  |...$..r.!.......|
+000002c0  05 1f ce b8 4d d3 d8 e6  13 c8 a6 4d f3 da 0f 4d  |....M......M...M|
+000002d0  e3 21 29 84 78 90 fa 11  a5 06 19 3a cd ca f2 1f  |.!).x......:....|
+000002e0  a2 39 4d b3 03 8d 22 27  eb bc f4 8b b8 61 c0 f3  |.9M..."'.....a..|
+000002f0  70 34 56 80 28 a2 85 1e  21 7c 11 b8 c6 0c 0d bd  |p4V.(...!|......|
+00000300  02 56 8a b5 d5 7b 22 97  3e 70 20 31 00 a0 16 2d  |.V...{".>p 1...-|
+00000310  87 b5 c7 b0 5e 40 2d 08  82 97 38 64 c4 14 e3 16  |....^@-...8d....|
+00000320  0d 6f d1 b1 6b 5f 7c 14  18 66 67 aa 8a b6 6b 66  |.o..k_|..fg...kf|
+00000330  7d e3 68 ca 97 13 ad ca  0a 46 06 6b 4a a9 c0 ee  |}.h......F.kJ...|
+00000340  8b 61 6d 2d cc 14 03 03  00 11 93 6d 0b 63 c5 e2  |.am-.......m.c..|
+00000350  3f 0f da dd f4 7c ae 95  2a e8 65 16 03 03 00 20  |?....|..*.e.... |
+00000360  62 97 ee b8 34 aa be 0a  2c 24 30 6c 89 f2 80 08  |b...4...,$0l....|
+00000370  05 69 bb ad a8 5c 90 21  04 77 96 44 ae 5f d4 d5  |.i...\.!.w.D._..|
 >>> Flow 10 (server to client)
-00000000  14 03 03 00 11 ce 30 2f  ce ec 08 18 13 0f 64 04  |......0/......d.|
-00000010  6d a0 fb 38 04 17 16 03  03 00 20 03 cd 4e 30 0f  |m..8...... ..N0.|
-00000020  e3 c2 1c 52 7d 30 5f 57  e1 2f 50 7b 00 0b 8a 05  |...R}0_W./P{....|
-00000030  2e 4b 15 23 fd e6 82 35  ac 96 5f 17 03 03 00 19  |.K.#...5.._.....|
-00000040  d9 71 23 60 2a 72 ac 2e  43 66 a9 7a a9 71 5f f3  |.q#`*r..Cf.z.q_.|
-00000050  c3 43 72 41 55 49 81 95  43 16 03 03 00 14 c0 af  |.CrAUI..C.......|
-00000060  63 ad 86 4c 8b 44 8d f1  e1 2c 4e b7 a5 54 b4 1d  |c..L.D...,N..T..|
-00000070  68 de                                             |h.|
+00000000  14 03 03 00 11 03 06 35  7b 36 e4 b2 df 80 68 80  |.......5{6....h.|
+00000010  df e3 d6 3c bb b7 16 03  03 00 20 08 9b ed a0 ae  |...<...... .....|
+00000020  e7 f9 42 9a f5 10 21 7a  38 dc a2 6d 27 a8 bc 00  |..B...!z8..m'...|
+00000030  58 85 6a 85 04 b9 3b 3f  ca 26 68 17 03 03 00 19  |X.j...;?.&h.....|
+00000040  d5 24 ff 37 e7 a2 5d eb  f2 45 ca 73 60 3b c3 8c  |.$.7..]..E.s`;..|
+00000050  87 10 d8 31 c3 a2 e5 3d  0f 16 03 03 00 14 31 8a  |...1...=......1.|
+00000060  c9 a6 3a 3e 36 e0 4f d6  f1 f5 67 70 34 8a ab dc  |..:>6.O...gp4...|
+00000070  82 e2                                             |..|
 >>> Flow 11 (client to server)
-00000000  15 03 03 00 12 6d 7f 8e  31 17 7d 45 96 a9 b0 6e  |.....m..1.}E...n|
-00000010  e1 73 b3 f3 f6 51 9a 15  03 03 00 12 ad 22 dc 06  |.s...Q......."..|
-00000020  98 ee b2 2f 09 4b 40 25  84 65 60 88 2e db        |.../.K@%.e`...|
+00000000  15 03 03 00 12 be b2 bb  cf 44 91 f3 b9 71 00 af  |.........D...q..|
+00000010  9e b6 f5 07 64 36 7b 15  03 03 00 12 ae b2 33 16  |....d6{.......3.|
+00000020  de f1 45 31 a5 fd 07 97  6e 57 f8 22 cc b2        |..E1....nW."..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected b/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected
index f70978475e..c907c7cb2e 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 50 07 ee 50 d2  |....]...Y..P..P.|
-00000010  77 fa a1 bb 19 fa ea 54  12 26 62 e7 0c 84 b9 2e  |w......T.&b.....|
-00000020  b2 b8 c8 19 59 34 b4 3c  60 21 d9 20 4f 36 b8 c7  |....Y4.<`!. O6..|
-00000030  5c ae b8 11 14 0d 67 88  65 37 f1 a5 16 3a af 92  |\.....g.e7...:..|
-00000040  4d 39 ed 9c 20 1c e7 c1  40 e6 ba b8 cc a8 00 00  |M9.. ...@.......|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 ea a3 8e 85 79  |....]...Y......y|
+00000010  9f 41 1f 7e 05 76 70 3d  bd f4 bb f4 dd 49 a6 fd  |.A.~.vp=.....I..|
+00000020  11 83 a9 70 89 86 87 36  2f 09 b9 20 1a 00 de fc  |...p...6/.. ....|
+00000030  6b e5 93 4e da 98 0b e1  a8 93 8d fc 4b c3 48 6b  |k..N........K.Hk|
+00000040  15 6d de fd e3 0f 36 67  61 1c 91 8e cc a8 00 00  |.m....6ga.......|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -63,36 +62,36 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 5d 84 3d  |............ ].=|
-000002d0  57 67 a5 0a 3d 25 81 c0  82 e0 b9 03 29 4e e1 87  |Wg..=%......)N..|
-000002e0  37 88 c8 9a 6d 7c 4b c9  22 5a ab 5e 68 08 04 00  |7...m|K."Z.^h...|
-000002f0  80 5d 80 99 26 5c 59 a0  7f f1 96 68 9e 02 11 1c  |.]..&\Y....h....|
-00000300  80 89 f1 50 d1 5c 7c 61  29 77 5e c1 4f 42 4b 03  |...P.\|a)w^.OBK.|
-00000310  0d 92 0d 20 c4 f9 e3 60  a7 de 90 b7 5a b8 3b 06  |... ...`....Z.;.|
-00000320  0a 21 4b 9b 5b e9 2f 85  dc 23 af 5a d0 76 0a 74  |.!K.[./..#.Z.v.t|
-00000330  02 64 32 b6 9a 93 d3 b8  65 04 94 f5 c5 be c2 7f  |.d2.....e.......|
-00000340  9b 76 af cf 1f 77 e0 31  3f 63 0e 0e 78 cd f7 9c  |.v...w.1?c..x...|
-00000350  e3 d4 52 e2 80 53 7f 53  35 10 21 b9 9e 48 92 e3  |..R..S.S5.!..H..|
-00000360  ba 7e 3c 13 0c 36 bc 56  3a 00 d3 13 c1 16 f8 33  |.~<..6.V:......3|
-00000370  68 16 03 03 00 04 0e 00  00 00                    |h.........|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 6a e1 91  |............ j..|
+000002d0  5d 5d fe 77 50 be a5 52  f1 12 43 30 34 aa 46 87  |]].wP..R..C04.F.|
+000002e0  f9 6a 80 37 eb 46 fb 92  d6 ce 18 c4 0b 08 04 00  |.j.7.F..........|
+000002f0  80 46 10 ab ff 45 fe c5  88 5a da d0 07 b5 a1 30  |.F...E...Z.....0|
+00000300  03 d8 b0 5f 88 37 45 75  ef b7 96 5c c9 1f 47 14  |..._.7Eu...\..G.|
+00000310  24 28 de cf 1f c9 c6 a4  0c 41 1b 51 70 7a e6 e8  |$(.......A.Qpz..|
+00000320  88 1b 35 ce 63 e7 4f 2b  02 c9 35 0a 56 b2 2a 59  |..5.c.O+..5.V.*Y|
+00000330  e9 02 53 11 82 f2 f6 18  06 3a 3e 2e 8e 21 78 9d  |..S......:>..!x.|
+00000340  41 43 e2 ed 49 ce 87 cd  93 b7 13 6c 35 6e 4e 95  |AC..I......l5nN.|
+00000350  68 1b 4b 75 de fa ed 48  53 56 54 40 5f 3f 36 cb  |h.Ku...HSVT@_?6.|
+00000360  6b 57 de 3c fc 51 f4 fb  9d 8d 55 2e e9 ce fc 79  |kW.<.Q....U....y|
+00000370  08 16 03 03 00 04 0e 00  00 00                    |..........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 72 e5 4c  81 fd 78 39 f0 bb 37 cd  |.... r.L..x9..7.|
-00000040  b4 47 cb 1b 52 25 08 9a  ab ab 9b 28 d2 b4 72 eb  |.G..R%.....(..r.|
-00000050  b0 db 8f fe 29                                    |....)|
+00000030  16 03 03 00 20 be b4 f9  49 91 3c c8 f8 7c da ef  |.... ...I.<..|..|
+00000040  06 bd d5 9e d3 b4 74 f6  22 2e b8 5c b6 e2 2d 01  |......t."..\..-.|
+00000050  cb d5 3f 94 7f                                    |..?..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 68 26 ca 41 0e  |.......... h&.A.|
-00000010  ab 2f 28 5d 9e 94 17 4f  9f 25 cb 82 aa 3a e5 40  |./(]...O.%...:.@|
-00000020  8a 35 6d a8 72 bf 25 2a  8a 6d 04                 |.5m.r.%*.m.|
+00000000  14 03 03 00 01 01 16 03  03 00 20 21 a2 e6 72 21  |.......... !..r!|
+00000010  6d 45 36 87 6d 3f c9 70  89 1f b3 0a cc c2 5b 18  |mE6.m?.p......[.|
+00000020  27 37 d8 1f 4e 55 f9 9d  07 96 2f                 |'7..NU..../|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 73 e1 3b  86 fb 05 16 9e a9 af 73  |.....s.;.......s|
-00000010  64 72 8b 02 a0 82 7d 70  16 5c d9                 |dr....}p.\.|
+00000000  17 03 03 00 16 81 33 71  a4 ec a6 67 b2 17 ba 80  |......3q...g....|
+00000010  27 80 a1 62 fb 1e ab 3f  cd b9 fe                 |'..b...?...|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 14 9b 44 8d  b3 1c 77 2c 12 e7 fe 76  |......D...w,...v|
-00000010  31 c9 ab e7 f0 be 32 0a  e3                       |1.....2..|
+00000000  16 03 03 00 14 b3 2b 93  6f bc d1 11 45 fa 9a d3  |......+.o...E...|
+00000010  f3 82 75 6c ce 40 38 21  5e                       |..ul.@8!^|
 >>> Flow 7 (client to server)
-00000000  15 03 03 00 12 00 54 e7  c6 54 b7 ec 24 d4 07 ad  |......T..T..$...|
-00000010  ff a7 39 d2 7b 62 ba 15  03 03 00 12 de ad f4 f7  |..9.{b..........|
-00000020  0b 8b a3 a3 e5 19 b6 45  63 6f dc 7d f3 c4        |.......Eco.}..|
+00000000  15 03 03 00 12 48 45 72  03 40 44 98 c6 db 40 d4  |.....HEr.@D...@.|
+00000010  a6 9b 67 5d 8b c1 a9 15  03 03 00 12 21 d2 4b 7d  |..g]........!.K}|
+00000020  51 c7 3c 53 0b d9 67 90  aa e6 42 e2 8c 83        |Q.<S..g...B...|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-SCT b/src/crypto/tls/testdata/Client-TLSv12-SCT
index 399c5e9ec3..b598bf2cd3 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-SCT
+++ b/src/crypto/tls/testdata/Client-TLSv12-SCT
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,23 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 01 ca 02 00 01  c6 03 03 9a 84 91 7d 3b  |..............};|
-00000010  31 f1 28 b9 57 a3 5c ea  ac 1c 43 91 1a e3 1a 88  |1.(.W.\...C.....|
-00000020  29 b8 46 87 18 0a 9d 9e  f6 6a 94 20 45 98 c2 a1  |).F......j. E...|
-00000030  3f 98 33 0f b7 d0 e8 53  70 a5 01 4e 0b a1 3b 3a  |?.3....Sp..N..;:|
-00000040  e1 cd 07 a3 b0 96 eb 05  54 26 de d8 cc a8 00 01  |........T&......|
+00000000  16 03 03 01 ca 02 00 01  c6 03 03 28 44 55 f3 f5  |...........(DU..|
+00000010  c1 63 ac 0b fd 1c 29 d3  90 a5 5c 96 2a d9 13 20  |.c....)...\.*.. |
+00000020  fe 96 11 3f 30 0a e1 a9  8e d9 e6 20 ca 40 de 01  |...?0...... .@..|
+00000030  4f 00 88 88 41 0f df af  85 0e 0e 22 9d a7 46 e8  |O...A......"..F.|
+00000040  df 9c 8e 8c 47 5b 94 91  94 06 f4 14 cc a8 00 01  |....G[..........|
 00000050  7e 00 12 01 69 01 67 00  75 00 a4 b9 09 90 b4 18  |~...i.g.u.......|
 00000060  58 14 87 bb 13 a2 cc 67  70 0a 3c 35 98 04 f9 1b  |X......gp.<5....|
 00000070  df b8 e3 77 cd 0e c8 0d  dc 10 00 00 01 47 97 99  |...w.........G..|
@@ -86,31 +85,31 @@
 00000400  43 77 8d 0c 1c f1 0f a1  d8 40 83 61 c9 4c 72 2b  |Cw.......@.a.Lr+|
 00000410  9d ae db 46 06 06 4d f4  c1 b3 3e c0 d1 bd 42 d4  |...F..M...>...B.|
 00000420  db fe 3d 13 60 84 5c 21  d3 3b e9 fa e7 16 03 03  |..=.`.\!.;......|
-00000430  00 ac 0c 00 00 a8 03 00  1d 20 4e e0 4b c5 9b e7  |......... N.K...|
-00000440  1c 85 3a 3f 64 df cb 87  18 94 c2 e2 cd e9 db 5e  |..:?d..........^|
-00000450  44 11 ee e0 89 4d 11 62  57 1a 08 04 00 80 7d 99  |D....M.bW.....}.|
-00000460  22 49 98 12 7b 7c e7 73  99 dc c1 43 7d 6c ed 8d  |"I..{|.s...C}l..|
-00000470  7e f3 d5 66 76 0b cd 5e  5f cc 60 68 8e 8c 30 6f  |~..fv..^_.`h..0o|
-00000480  54 0d 46 ca da a0 82 44  30 fc f1 bc a4 54 a1 49  |T.F....D0....T.I|
-00000490  d1 17 e6 c5 dc fd 08 41  19 5a e1 5b 9a 93 3c 3b  |.......A.Z.[..<;|
-000004a0  3b 0f be 35 51 55 0e 54  1e dc 03 28 0b fa 49 9f  |;..5QU.T...(..I.|
-000004b0  cf c8 d6 18 79 f7 84 92  0a 37 9f b3 88 3a 46 d9  |....y....7...:F.|
-000004c0  dd 7b e5 2b 52 6c a8 06  ac b5 ba 29 32 82 fb eb  |.{.+Rl.....)2...|
-000004d0  62 78 c9 97 c7 5c 03 e9  26 2e 8d 23 db 35 16 03  |bx...\..&..#.5..|
+00000430  00 ac 0c 00 00 a8 03 00  1d 20 26 24 4e d8 a6 cc  |......... &$N...|
+00000440  2f c9 0e 68 d8 20 e3 97  5b c1 08 72 1e 79 46 d9  |/..h. ..[..r.yF.|
+00000450  a6 00 9c e9 f8 21 9b cd  29 17 08 04 00 80 aa 6d  |.....!..)......m|
+00000460  36 bb 06 e6 11 66 82 44  87 5d 81 53 e2 9a 95 11  |6....f.D.].S....|
+00000470  54 a3 cc a7 c9 9c 19 f6  da 98 4f 91 a6 dd 9e 10  |T.........O.....|
+00000480  14 83 04 55 2d 6c 9a af  26 7c 5d f0 aa ca 69 83  |...U-l..&|]...i.|
+00000490  af fe a5 cb a4 1a d4 bd  86 91 52 11 03 4d 9a ca  |..........R..M..|
+000004a0  37 fd 01 48 e8 5d a8 ea  ad a2 a5 08 cb ce 5f 52  |7..H.]........_R|
+000004b0  92 30 83 de 77 2a 06 c2  f2 53 4d 47 40 b9 2f 61  |.0..w*...SMG@./a|
+000004c0  9c 41 c4 05 45 42 5e 42  d5 5e 30 95 30 4e a1 77  |.A..EB^B.^0.0N.w|
+000004d0  79 b5 50 5c df d6 e7 74  42 d8 2b 66 02 fa 16 03  |y.P\...tB.+f....|
 000004e0  03 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 e4 20 73  0f 70 18 f9 ef a2 7a e3  |.... . s.p....z.|
-00000040  73 d2 8d 38 45 61 89 b5  b0 77 1c 39 ba f8 56 ec  |s..8Ea...w.9..V.|
-00000050  04 0b c6 fb 02                                    |.....|
+00000030  16 03 03 00 20 93 c8 47  ed fd 9b 41 69 97 58 97  |.... ..G...Ai.X.|
+00000040  cc 31 9c 93 a6 77 41 36  7a 90 f0 73 13 4a 7d 85  |.1...wA6z..s.J}.|
+00000050  12 20 7d 91 fa                                    |. }..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 a8 e6 38 02 7a  |.......... ..8.z|
-00000010  d2 1c ca b1 79 ae ba 10  b6 ab e2 5e 79 28 06 7f  |....y......^y(..|
-00000020  0c d4 17 fc e3 72 e2 bf  44 4b 5f                 |.....r..DK_|
+00000000  14 03 03 00 01 01 16 03  03 00 20 16 00 35 d2 e0  |.......... ..5..|
+00000010  ad f5 4c 10 98 fb 4f c7  81 1f 05 4b d6 7d 9c ac  |..L...O....K.}..|
+00000020  50 94 84 c8 35 80 ec 54  fc f3 ee                 |P...5..T...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 00 04 dd  86 fc e7 8c c5 67 e6 0f  |.............g..|
-00000010  32 0a 60 1b f8 b6 1c e7  e1 96 8c 15 03 03 00 12  |2.`.............|
-00000020  35 71 48 37 fb f7 d1 3a  94 aa 3f ec c1 99 8a 7c  |5qH7...:..?....||
-00000030  20 4a                                             | J|
+00000000  17 03 03 00 16 83 e6 0f  3a ad c2 28 6c 82 ee 4a  |........:..(l..J|
+00000010  38 47 cc 86 75 70 e2 94  77 e6 6e 15 03 03 00 12  |8G..up..w.n.....|
+00000020  13 c0 a0 4f 02 5e 6f 33  f6 ae d3 52 7d 72 72 a0  |...O.^o3...R}rr.|
+00000030  1e 8d                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-X25519-ECDHE b/src/crypto/tls/testdata/Client-TLSv12-X25519-ECDHE
index a0d9a5eb1b..6f59dc6636 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-X25519-ECDHE
+++ b/src/crypto/tls/testdata/Client-TLSv12-X25519-ECDHE
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 16 01 00 01  12 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 12 01 00 01  0e 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,22 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 97 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 93 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
-000000a0  00 0a 00 04 00 02 00 1d  00 0d 00 1a 00 18 08 04  |................|
+000000a0  00 0a 00 04 00 02 00 1d  00 0d 00 16 00 14 08 04  |................|
 000000b0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
-000000c0  06 03 02 01 02 03 00 32  00 1a 00 18 08 04 04 03  |.......2........|
-000000d0  08 07 08 05 08 06 04 01  05 01 06 01 05 03 06 03  |................|
-000000e0  02 01 02 03 00 2b 00 09  08 03 04 03 03 03 02 03  |.....+..........|
-000000f0  01 00 33 00 26 00 24 00  1d 00 20 2f e5 7d a3 47  |..3.&.$... /.}.G|
-00000100  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
-00000110  c4 cf c2 ed 90 99 5f 58  cb 3b 74                 |......_X.;t|
+000000c0  06 03 00 32 00 1a 00 18  08 04 04 03 08 07 08 05  |...2............|
+000000d0  08 06 04 01 05 01 06 01  05 03 06 03 02 01 02 03  |................|
+000000e0  00 2b 00 09 08 03 04 03  03 03 02 03 01 00 33 00  |.+............3.|
+000000f0  26 00 24 00 1d 00 20 2f  e5 7d a3 47 cd 62 43 15  |&.$... /.}.G.bC.|
+00000100  28 da ac 5f bb 29 07 30  ff f6 84 af c4 cf c2 ed  |(.._.).0........|
+00000110  90 99 5f 58 cb 3b 74                              |.._X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 c1 cb c6 9e f2  |....]...Y.......|
-00000010  92 cb ca eb 42 5a 30 c2  1a 3f d6 ca fc 69 b9 55  |....BZ0..?...i.U|
-00000020  86 21 dd 3f 1d 33 5c 97  a1 1f b9 20 46 58 d4 b8  |.!.?.3\.... FX..|
-00000030  c4 71 e6 30 97 a1 f3 fe  1c 7f ca cd bf c2 95 96  |.q.0............|
-00000040  ef 5c df 54 60 51 f6 e2  47 7c c5 bd c0 2f 00 00  |.\.T`Q..G|.../..|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 64 5a cc e0 63  |....]...Y..dZ..c|
+00000010  02 82 64 75 5e 2c b3 5f  23 c6 98 c8 95 07 40 00  |..du^,._#.....@.|
+00000020  3e ef fd f6 00 af 81 0c  3a 47 a0 20 a1 fc 21 83  |>.......:G. ..!.|
+00000030  cf 2b 34 5e b7 7b bd ec  bb 8f 26 6a f2 26 7f 8f  |.+4^.{....&j.&..|
+00000040  51 13 6f ba 0d 1a f5 b7  1c 9d 6d 91 c0 2f 00 00  |Q.o.......m../..|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -62,33 +62,33 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 d5 3e d5  |............ .>.|
-000002d0  c0 de 8f f1 12 8d 50 f2  97 d1 d6 1d b9 9f 7f 86  |......P.........|
-000002e0  00 38 c7 77 7b 65 44 7d  97 e4 61 a3 77 08 04 00  |.8.w{eD}..a.w...|
-000002f0  80 07 71 57 61 39 64 7c  d0 1e 5d 57 23 5c 18 0c  |..qWa9d|..]W#\..|
-00000300  46 c8 62 e0 41 5a f9 4f  1b 17 d9 25 64 53 9c 41  |F.b.AZ.O...%dS.A|
-00000310  ea 6a fc 01 69 92 4c d1  4e 98 4d c8 d2 7d 5a 8b  |.j..i.L.N.M..}Z.|
-00000320  19 46 9a 54 57 27 12 ba  f2 91 cb 0b 24 08 06 91  |.F.TW'......$...|
-00000330  c0 4d 5a 9e 45 e0 34 87  93 87 59 08 ae cb 5c 08  |.MZ.E.4...Y...\.|
-00000340  05 bf 71 f7 0c 04 57 b9  d4 9c 00 ec bb 55 ee c3  |..q...W......U..|
-00000350  56 ab f9 08 ab 14 f1 f9  27 85 f3 ea 85 26 db bc  |V.......'....&..|
-00000360  25 54 e8 ad 91 0e 07 f1  bc 48 ca c3 54 c2 da 3c  |%T.......H..T..<|
-00000370  26 16 03 03 00 04 0e 00  00 00                    |&.........|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 15 d1 98  |............ ...|
+000002d0  53 f4 98 b6 58 a5 cd 89  bb 32 21 83 4a e5 ad ba  |S...X....2!.J...|
+000002e0  1f ba db d0 4c c5 a3 89  0e 96 9f 59 60 08 04 00  |....L......Y`...|
+000002f0  80 4e 14 a0 a7 33 e8 47  d5 7d 01 26 19 ff 1d 3c  |.N...3.G.}.&...<|
+00000300  2a f9 77 58 84 c0 07 b7  dc cc 82 85 a6 18 e9 33  |*.wX...........3|
+00000310  70 15 04 75 bb 59 59 9c  fa c0 cd b4 b7 f8 a3 0e  |p..u.YY.........|
+00000320  21 cd ac 7d 18 d2 34 e5  a9 c7 a1 5d 86 f3 74 2b  |!..}..4....]..t+|
+00000330  9b b0 21 5f cb 91 7f a0  d8 78 f0 7c 56 e3 69 ec  |..!_.....x.|V.i.|
+00000340  43 55 80 3f 02 d7 e0 10  52 15 4d 1b bc 2c 7f b7  |CU.?....R.M..,..|
+00000350  86 cd 07 5d b9 f1 21 7e  18 da fc f8 45 45 cf 39  |...]..!~....EE.9|
+00000360  62 3e c8 f1 6c 75 f4 fb  fe f8 23 89 6a 0d b5 2e  |b>..lu....#.j...|
+00000370  4d 16 03 03 00 04 0e 00  00 00                    |M.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 1c bd 15  |....(...........|
-00000040  e4 c0 92 d5 1d 85 17 46  b8 46 6b 71 ef b4 36 9f  |.......F.Fkq..6.|
-00000050  f4 0c ca a6 81 f8 da 28  63 29 29 d6 2c           |.......(c)).,|
+00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 e3 a2 01  |....(...........|
+00000040  72 d5 55 57 f7 1a da 10  9a 04 7d 33 f4 18 b1 9a  |r.UW......}3....|
+00000050  09 38 45 dd 74 13 21 70  52 9c cc c2 3f           |.8E.t.!pR...?|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 b7 b5 af 79 b7  |..........(...y.|
-00000010  68 6f d7 fa d6 0f 73 8a  51 ea 97 a4 2f b1 29 58  |ho....s.Q.../.)X|
-00000020  73 fd f2 15 17 c6 cd 1b  2d 1a 39 32 17 78 37 fe  |s.......-.92.x7.|
-00000030  87 71 da                                          |.q.|
+00000000  14 03 03 00 01 01 16 03  03 00 28 86 a1 0b 2b ef  |..........(...+.|
+00000010  13 8d 20 82 ad 17 92 64  0b 44 21 0f f0 dd 20 43  |.. ....d.D!... C|
+00000020  4c db 92 3c 25 3a 12 ca  27 56 86 16 ca 9f ba 46  |L..<%:..'V.....F|
+00000030  dc 96 86                                          |...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 a5 8f 5d  |...............]|
-00000010  59 44 d3 65 6c bd b1 68  3c d2 ee 1c 5d 8c 92 4c  |YD.el..h<...]..L|
-00000020  c2 89 f3 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
-00000030  33 c1 b3 d7 37 52 f7 57  3d 00 af 02 e0 e8 9b 6f  |3...7R.W=......o|
-00000040  ad 0f                                             |..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 20 7c 62  |............. |b|
+00000010  05 52 7a 91 a7 13 96 96  29 11 1b 1a fe fa ad 7f  |.Rz.....).......|
+00000020  d2 3a 26 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.:&.............|
+00000030  c7 2b 60 1b 9c 6b cb 22  08 f1 e3 c0 44 ab 70 21  |.+`..k."....D.p!|
+00000040  68 48                                             |hH|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-AES128-SHA256 b/src/crypto/tls/testdata/Client-TLSv13-AES128-SHA256
index c6e3f37d2d..3673b8da39 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-AES128-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv13-AES128-SHA256
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,87 +7,86 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 75 19 d0 fb e3  |....z...v..u....|
-00000010  11 c7 2a 09 40 fb 18 4b  17 f8 94 3f 54 2b 33 c9  |..*.@..K...?T+3.|
-00000020  96 c6 46 72 a5 92 31 7d  d3 40 d3 20 00 00 00 00  |..Fr..1}.@. ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 07 aa 6b aa b6  |....z...v....k..|
+00000010  ef a5 5c 62 d7 05 bb f8  9d ea 03 34 13 bf 00 1f  |..\b.......4....|
+00000020  e6 95 7b ef a5 2b ad e8  20 2f 21 20 00 00 00 00  |..{..+.. /! ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 01 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 df  |..+.....3.$... .|
-00000060  bb 62 90 62 b0 0d ee a9  4f 2a 45 58 9b d4 1d 0b  |.b.b....O*EX....|
-00000070  b8 49 ee 69 3a e4 48 65  a8 5a 94 60 99 00 2e 14  |.I.i:.He.Z.`....|
-00000080  03 03 00 01 01 17 03 03  00 17 5a fa 5d b7 3e 06  |..........Z.].>.|
-00000090  4f 87 9d 8e f7 c6 9d 6c  9a f9 c8 c1 48 69 a0 1f  |O......l....Hi..|
-000000a0  67 17 03 03 02 6d 0f 4d  e4 f2 24 16 18 d7 0f 1f  |g....m.M..$.....|
-000000b0  eb e4 ff f9 71 99 63 21  41 ff e2 65 96 90 07 88  |....q.c!A..e....|
-000000c0  b4 3b 23 8e 28 01 df c7  f3 71 71 36 25 6c d5 fe  |.;#.(....qq6%l..|
-000000d0  e7 7b 94 f3 2f ba e0 b5  02 1a 24 15 66 2f 4b 2c  |.{../.....$.f/K,|
-000000e0  8e ae da 30 67 9b 33 fa  95 bc ea 80 2d 85 b4 93  |...0g.3.....-...|
-000000f0  28 42 f3 af ab 06 b6 a2  20 4e 9a 9a 07 c4 ad 5a  |(B...... N.....Z|
-00000100  ab 91 b6 f4 b3 ae ba 08  19 4d 0b 5a c7 f8 c6 1c  |.........M.Z....|
-00000110  db b8 61 d1 55 5f 02 34  44 cf c4 f1 7b 25 b2 12  |..a.U_.4D...{%..|
-00000120  a0 37 80 3a 3d 47 b0 cc  92 31 8c 41 d9 85 fa ac  |.7.:=G...1.A....|
-00000130  ea 81 49 4e 60 b9 1a dc  2a 61 fa 89 e3 b5 93 b5  |..IN`...*a......|
-00000140  cf 22 65 46 54 56 bc 3c  f9 62 75 bd 04 8f 39 fb  |."eFTV.<.bu...9.|
-00000150  a3 94 92 20 44 5b 74 51  b1 38 fe 48 a4 26 74 82  |... D[tQ.8.H.&t.|
-00000160  ac 11 04 25 a4 76 06 ce  51 47 2f 56 e8 1d 4f 74  |...%.v..QG/V..Ot|
-00000170  d5 5c 00 b7 22 a5 47 3c  17 d5 f3 13 37 8e b0 82  |.\..".G<....7...|
-00000180  da 5f d9 85 05 e7 12 79  0a 22 97 b5 9b 03 2d 61  |._.....y."....-a|
-00000190  ab 19 4c 40 8a 9d d2 08  77 1d cc f0 b7 c7 48 ba  |..L@....w.....H.|
-000001a0  70 c4 e9 7f 1a ba 5b 0a  d2 1e 0c 95 58 e9 f0 56  |p.....[.....X..V|
-000001b0  c2 a6 a3 58 b6 b2 ea 85  55 77 c8 09 be 1a 7e 2c  |...X....Uw....~,|
-000001c0  ac d3 a0 ce 4c 6d 5a 02  c8 d9 7e b8 3b 46 e9 48  |....LmZ...~.;F.H|
-000001d0  73 9b 97 1c 32 fe e1 99  c4 2e ee 81 38 27 12 d0  |s...2.......8'..|
-000001e0  99 4f dd 18 a3 df 93 24  f3 0d 53 11 fe bb ff b7  |.O.....$..S.....|
-000001f0  cf 5e 18 41 01 d4 d3 06  6a f4 5b e3 26 1f 7c fa  |.^.A....j.[.&.|.|
-00000200  ad 9f 61 a3 b3 05 5e b4  bf 94 9c 94 4b c9 3c 63  |..a...^.....K.<c|
-00000210  88 1d b9 df a9 0d 4f 57  78 73 6a 64 cf 29 49 e4  |......OWxsjd.)I.|
-00000220  a3 f8 cb a3 f0 0d 93 c2  56 65 f8 f9 be ad b2 e6  |........Ve......|
-00000230  c6 c7 f5 73 3c 7a 85 e5  e1 73 d4 76 f6 6b 87 da  |...s<z...s.v.k..|
-00000240  99 79 e4 94 d7 77 88 a2  44 cd 60 58 3f 22 67 88  |.y...w..D.`X?"g.|
-00000250  f1 aa 99 3e 1c 04 be 98  b8 87 f7 c8 e3 0f c7 55  |...>...........U|
-00000260  75 01 95 fa 21 f2 5f df  d2 38 88 87 99 b0 10 4d  |u...!._..8.....M|
-00000270  e3 c9 74 28 59 14 90 89  6c 54 83 0b 71 c2 7e 4b  |..t(Y...lT..q.~K|
-00000280  39 21 92 0f ec 0e 98 53  39 75 54 0b 8d 12 6d 57  |9!.....S9uT...mW|
-00000290  4f bd 2a 02 9a 44 ac 45  47 c3 05 71 cc 7e 60 0e  |O.*..D.EG..q.~`.|
-000002a0  93 1b 70 5b 42 4b d6 7f  01 2d 2a 73 ed 52 b2 8d  |..p[BK...-*s.R..|
-000002b0  2f fb 6e 85 5e c6 70 2d  3b e8 3d f1 57 6e c5 f8  |/.n.^.p-;.=.Wn..|
-000002c0  7b f5 85 af 3e c8 64 28  00 24 1e 8a c9 6c f8 e3  |{...>.d(.$...l..|
-000002d0  24 83 50 39 d0 4d b4 23  62 80 7d 6b f8 ee 5a f0  |$.P9.M.#b.}k..Z.|
-000002e0  c8 63 df 43 6e ce 58 b9  39 18 91 82 3c 84 d9 12  |.c.Cn.X.9...<...|
-000002f0  4a 4b 76 67 2c 07 91 97  ac c9 16 9c b5 7a 84 54  |JKvg,........z.T|
-00000300  fb 99 2a 16 0a 00 a3 d6  04 ac 28 f5 d0 34 a6 3c  |..*.......(..4.<|
-00000310  ac 54 50 17 03 03 00 99  5f ec 9a 27 57 7e 33 28  |.TP....._..'W~3(|
-00000320  b3 06 a4 36 6d 4e 59 3e  9a 75 95 3a d2 72 c0 7c  |...6mNY>.u.:.r.||
-00000330  61 54 a5 46 01 91 2d 11  ac 6e 25 15 62 c4 8f 8f  |aT.F..-..n%.b...|
-00000340  f9 a8 a0 2a d1 51 71 12  9b df 4f 6a 1b e9 b1 c2  |...*.Qq...Oj....|
-00000350  eb 83 00 fd 32 53 b3 5d  3b 6c 34 59 e9 42 21 ff  |....2S.];l4Y.B!.|
-00000360  7a 10 c0 81 81 13 01 db  bb ef 8f 29 a3 ca 07 67  |z..........)...g|
-00000370  b8 8f 5d 27 07 9c ed 67  51 f9 35 a7 11 bf 10 f7  |..]'...gQ.5.....|
-00000380  f4 36 d8 dc fd 14 a8 56  18 c8 4e fb be 27 91 5f  |.6.....V..N..'._|
-00000390  6a a4 da 13 32 3d 6c d9  fa 18 5b 13 26 68 e2 a9  |j...2=l...[.&h..|
-000003a0  d2 b6 72 2e dd 7d 69 30  32 fd 24 35 35 a1 1d bd  |..r..}i02.$55...|
-000003b0  03 17 03 03 00 35 05 56  0b a7 86 2f 45 c1 18 c2  |.....5.V.../E...|
-000003c0  ad c5 2f 54 f6 5b b3 eb  45 fc 76 ff c9 60 89 e1  |../T.[..E.v..`..|
-000003d0  f1 e2 3a 28 60 8d e9 54  62 4d 7a 30 4f 8c 73 b7  |..:(`..TbMz0O.s.|
-000003e0  45 10 27 0f e8 56 91 1f  7c 07 3a                 |E.'..V..|.:|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 53  |..+.....3.$... S|
+00000060  3c 5e 7d 61 39 39 6c f7  ea 14 d3 f0 40 23 30 8b  |<^}a99l.....@#0.|
+00000070  7e 1f 41 86 f8 2e 12 0a  f5 67 13 28 46 6f 14 14  |~.A......g.(Fo..|
+00000080  03 03 00 01 01 17 03 03  00 17 a8 64 4a 9d f1 a0  |...........dJ...|
+00000090  3c 1b e3 20 a2 66 80 7f  13 b5 a9 f0 8f ee 5b 4b  |<.. .f........[K|
+000000a0  af 17 03 03 02 6d 26 d2  8f df b4 d5 d3 9a c8 92  |.....m&.........|
+000000b0  4c 32 63 80 6b 5f 99 11  0f 4b be 14 77 55 86 d1  |L2c.k_...K..wU..|
+000000c0  27 94 18 50 27 1c 84 9c  38 03 fb 11 d3 5a ea 64  |'..P'...8....Z.d|
+000000d0  d1 15 47 1d fc cc 6e bf  5e 4d 45 74 f2 ca 44 77  |..G...n.^MEt..Dw|
+000000e0  32 6d 02 3a 9f 44 aa 5c  5d 62 64 ee 44 0d 45 05  |2m.:.D.\]bd.D.E.|
+000000f0  de 40 d0 83 c9 b3 21 39  a0 8f 5b 5a e1 96 2f 0b  |.@....!9..[Z../.|
+00000100  4b 12 da a7 dc 7b 2a 73  14 7f cc 93 fd a8 47 1c  |K....{*s......G.|
+00000110  f7 88 76 5d 30 29 af 65  ac 52 25 04 13 be 96 92  |..v]0).e.R%.....|
+00000120  bb e4 86 a0 b7 c8 67 63  ef cb 1f 78 7e bf 3c 5f  |......gc...x~.<_|
+00000130  7a a6 89 4a 94 f3 2e 01  8b b9 81 21 57 00 5e 26  |z..J.......!W.^&|
+00000140  22 9b eb e0 73 87 cd 77  46 d4 c8 1d 0a 4f d8 83  |"...s..wF....O..|
+00000150  0b 0a 43 3f 37 53 e2 0a  4b bb ef e8 8d 2a dc 51  |..C?7S..K....*.Q|
+00000160  b0 b9 90 7e 1a c5 31 e0  1b 0f 0c 7e 96 7b aa 49  |...~..1....~.{.I|
+00000170  ad 84 b0 0a 75 d6 37 58  bd 7f f6 ac 50 c5 d7 93  |....u.7X....P...|
+00000180  70 ce b1 cd 00 7c 79 1a  e5 ec 04 7b 12 8f fb 80  |p....|y....{....|
+00000190  54 d0 2b a0 9e 83 0d 05  a7 f5 4b e8 b4 36 1c d0  |T.+.......K..6..|
+000001a0  88 34 a6 71 51 d6 cf 59  c9 ad 03 d8 38 f2 15 f0  |.4.qQ..Y....8...|
+000001b0  63 9d 34 a3 f4 bc de 8f  ae 26 97 c0 98 8e 59 4e  |c.4......&....YN|
+000001c0  1f 74 a1 d4 2c 1a 18 20  ef e8 06 58 74 dd ed 40  |.t..,.. ...Xt..@|
+000001d0  50 dd 8b a4 77 15 1b 9e  63 7e c7 11 63 1a a9 d5  |P...w...c~..c...|
+000001e0  16 c2 8f f5 6c ce cd 03  e6 2d cc da 75 1a ce cb  |....l....-..u...|
+000001f0  ea 41 de dd 59 e5 68 90  98 69 76 a3 d0 d4 ed d1  |.A..Y.h..iv.....|
+00000200  e9 9a cd b8 29 73 eb 9c  e6 6f ee 8d 91 84 9e 2e  |....)s...o......|
+00000210  b9 23 2b 04 a0 f6 5f 0b  16 07 49 ae 6f 33 b0 ee  |.#+..._...I.o3..|
+00000220  be ff 75 52 da 7b 06 05  6c 8f 87 1f 48 2f fb 59  |..uR.{..l...H/.Y|
+00000230  79 a6 99 cb a6 0b 73 fb  4c d0 cc eb ba 51 1a 6d  |y.....s.L....Q.m|
+00000240  9a 33 27 e3 f4 cf 16 bc  c0 82 da 21 04 4a 7b e0  |.3'........!.J{.|
+00000250  12 a5 5e de 22 d2 df b4  c4 c9 fa 11 97 7b 07 ea  |..^."........{..|
+00000260  11 c8 2c 55 b8 6d c2 64  6d fa e0 6f b8 5c 50 ae  |..,U.m.dm..o.\P.|
+00000270  a6 2e aa bf 2f 2a 74 2d  1c 11 c2 44 d7 28 b8 5e  |..../*t-...D.(.^|
+00000280  6a 2d bc 0d 2e a7 a2 b6  b6 ae 12 2c a2 c4 ba 5c  |j-.........,...\|
+00000290  0b 3f 17 2e 98 30 ce 6c  8e 88 3c f9 a8 e1 68 8d  |.?...0.l..<...h.|
+000002a0  52 c8 a1 b3 3f 12 e1 35  f0 eb ee 9f 0d bb 3c 90  |R...?..5......<.|
+000002b0  2c e2 2c 95 2e f3 e2 f6  f2 f1 be b8 03 02 84 69  |,.,............i|
+000002c0  56 8f 3b 1d 68 77 f1 52  eb 48 4f e8 c8 5b 0a df  |V.;.hw.R.HO..[..|
+000002d0  a1 74 1e e1 47 a2 9a 9a  83 6d c2 ea f3 1b fc 8f  |.t..G....m......|
+000002e0  b6 aa 18 7e 85 46 ff 33  0b 6e 1f 5b f1 70 c0 45  |...~.F.3.n.[.p.E|
+000002f0  f6 bb a0 da 74 e0 9a 3c  a7 e2 07 ef 0b e5 9a 5b  |....t..<.......[|
+00000300  6e 9b aa 6c a4 97 84 5d  77 f5 33 b8 e3 45 c0 00  |n..l...]w.3..E..|
+00000310  21 c7 91 17 03 03 00 99  ee bf d2 9c 82 9f 68 b4  |!.............h.|
+00000320  5e 15 09 1a 7a c1 f9 72  ff ca 0e d9 f1 9f 7f 8c  |^...z..r........|
+00000330  dc 4a 8d d3 37 7b 81 42  ef 9b 2b 5f 9a 4b 40 8e  |.J..7{.B..+_.K@.|
+00000340  6b 24 53 79 32 b0 d1 24  2a 6f c9 fb a8 82 c1 01  |k$Sy2..$*o......|
+00000350  1e 0b 11 7f 85 c7 ee d4  29 12 08 99 8f 00 ef af  |........).......|
+00000360  2c 5d c5 b1 25 a3 a9 f0  f1 a3 2b f8 7f e6 31 1b  |,]..%.....+...1.|
+00000370  51 20 af 3f a7 4e 5c 3d  73 21 04 0f 2c 5c cd f3  |Q .?.N\=s!..,\..|
+00000380  eb d1 01 ef b0 e3 64 f7  33 d3 05 82 9f a6 71 3b  |......d.3.....q;|
+00000390  b2 ab 08 61 57 ad 74 d1  e2 8f 2c c9 73 c3 e0 ac  |...aW.t...,.s...|
+000003a0  ed 18 4b 70 0d 9a bf ae  b4 db 07 7d 25 3e 7f 3d  |..Kp.......}%>.=|
+000003b0  14 17 03 03 00 35 db be  d2 61 e1 3f a3 0b fe 39  |.....5...a.?...9|
+000003c0  b2 86 42 72 a6 ee 02 90  c2 d1 d1 5c 3d 61 c8 28  |..Br.......\=a.(|
+000003d0  28 7c 01 40 26 f1 e1 f1  81 50 03 4c 6c 32 6d 8b  |(|.@&....P.Ll2m.|
+000003e0  dd 60 cf fc a9 3c fe e1  4d d0 d2                 |.`...<..M..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 f9 89 62 39 dc  |..........5..b9.|
-00000010  cb f6 be b1 6f db 4c 8e  44 3c 1e 13 ba 25 db dc  |....o.L.D<...%..|
-00000020  f1 64 00 ea f3 56 ba 69  00 5b bd 64 05 8d c7 27  |.d...V.i.[.d...'|
-00000030  39 b6 9c 2f ce e4 74 f1  ab 32 59 f1 6d 27 88 58  |9../..t..2Y.m'.X|
-00000040  17 03 03 00 17 90 42 5e  b1 ae d2 d7 71 4e 8f 51  |......B^....qN.Q|
-00000050  91 3b e4 b0 97 ef 35 27  4f 56 79 81 17 03 03 00  |.;....5'OVy.....|
-00000060  13 7b 6b c7 ab bf f2 de  55 52 b0 ee 67 40 ad bd  |.{k.....UR..g@..|
-00000070  6e 4d 22 f8                                       |nM".|
+00000000  14 03 03 00 01 01 17 03  03 00 35 bd 1e ca 07 84  |..........5.....|
+00000010  c8 ba 87 6d d3 ed 53 20  79 76 34 af 30 e6 bf c5  |...m..S yv4.0...|
+00000020  74 a0 d0 b3 13 17 a9 3c  c7 b3 47 5b e7 b4 6d 18  |t......<..G[..m.|
+00000030  e5 3f 12 5c ca c9 26 87  c4 96 c4 9b 45 23 7f f7  |.?.\..&.....E#..|
+00000040  17 03 03 00 17 28 0b 72  a0 6e ac 55 ec c0 b7 21  |.....(.r.n.U...!|
+00000050  3f 7a 16 98 40 76 7d 3c  95 24 98 3b 17 03 03 00  |?z..@v}<.$.;....|
+00000060  13 8e 23 e0 33 31 dc 39  fb 54 a6 a2 63 36 e4 2a  |..#.31.9.T..c6.*|
+00000070  5a 1c bc 09                                       |Z...|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-AES256-SHA384 b/src/crypto/tls/testdata/Client-TLSv13-AES256-SHA384
index 02eb5092fc..5fcaba0d4f 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-AES256-SHA384
+++ b/src/crypto/tls/testdata/Client-TLSv13-AES256-SHA384
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,89 +7,88 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 3e 8f 50 19 e5  |....z...v..>.P..|
-00000010  1b d8 bf 48 bf c6 b3 38  d0 a4 9d 33 39 1f 36 72  |...H...8...39.6r|
-00000020  9a a4 7d 9a e5 61 f1 9b  da 0c a3 20 00 00 00 00  |..}..a..... ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 76 2d 81 0b a9  |....z...v..v-...|
+00000010  70 b7 fe 52 ef d3 80 c4  1d bf f7 19 99 3c 4c aa  |p..R.........<L.|
+00000020  60 1e c7 10 b0 24 a8 4e  b4 b8 02 20 00 00 00 00  |`....$.N... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 02 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 80  |..+.....3.$... .|
-00000060  d3 4e d4 ec ef 3e 0b c0  9b 8e 6a 91 2b af f2 cf  |.N...>....j.+...|
-00000070  78 13 e0 9b e1 41 60 7d  bd 83 69 d5 dc 1b 6d 14  |x....A`}..i...m.|
-00000080  03 03 00 01 01 17 03 03  00 17 cd 1f b4 38 20 00  |.............8 .|
-00000090  f5 52 89 92 be 23 95 90  92 b4 2a 06 f9 af f7 6c  |.R...#....*....l|
-000000a0  82 17 03 03 02 6d 4d 51  05 22 11 94 f0 2e 66 9b  |.....mMQ."....f.|
-000000b0  d0 bd b8 01 3c 23 03 3a  28 a7 74 80 81 e6 5c 5e  |....<#.:(.t...\^|
-000000c0  48 fb 4d 29 ab b3 17 c6  25 d8 15 ed 63 ef 07 61  |H.M)....%...c..a|
-000000d0  0e 14 44 da 9f 6c c1 57  37 18 34 16 e0 3a 8d ab  |..D..l.W7.4..:..|
-000000e0  98 45 84 79 e0 19 56 26  61 e1 70 c9 7d 7b 55 b0  |.E.y..V&a.p.}{U.|
-000000f0  5c d5 90 60 87 3c 55 f7  5e 4f df fc 05 6e 90 bc  |\..`.<U.^O...n..|
-00000100  7d a0 2a db 56 17 5a e6  b4 85 99 68 2a fa 83 0d  |}.*.V.Z....h*...|
-00000110  40 84 a6 20 1d 5b 30 25  b3 b2 c6 ba 73 88 f4 c1  |@.. .[0%....s...|
-00000120  30 d0 f5 48 a6 52 c9 3e  bd 8d dc 31 1c 84 25 4d  |0..H.R.>...1..%M|
-00000130  ae c0 0f de 5b 44 97 d1  bf f6 7a 84 88 fb 82 7b  |....[D....z....{|
-00000140  79 5d f0 d8 39 a3 21 5a  67 16 b9 68 55 06 bd 50  |y]..9.!Zg..hU..P|
-00000150  f2 83 77 8e e6 60 f3 46  57 d3 96 e1 f7 02 9e 1d  |..w..`.FW.......|
-00000160  d3 f2 29 0b 8e 34 0d 40  0b 1a 06 c5 33 52 bd 78  |..)..4.@....3R.x|
-00000170  4e ff a2 ec 31 a1 c3 57  0d 82 59 ab a7 46 81 94  |N...1..W..Y..F..|
-00000180  4f 31 63 25 75 3f b1 c9  99 ae 8a 60 6f 4a 96 d2  |O1c%u?.....`oJ..|
-00000190  ce 37 4c 7b f4 f9 83 56  7e 4c 0a 6d a1 0c 80 00  |.7L{...V~L.m....|
-000001a0  46 5a a9 fa d6 7c 9a 18  c2 36 b6 19 fa 76 37 65  |FZ...|...6...v7e|
-000001b0  d4 c0 33 37 c3 90 26 df  4e c7 89 65 26 f3 cb 9d  |..37..&.N..e&...|
-000001c0  a2 a0 ae 50 72 89 45 db  fb a1 44 3a 12 9e e7 4e  |...Pr.E...D:...N|
-000001d0  7a b8 aa f8 87 d2 8d 6b  43 ff 66 b7 ad 06 d5 09  |z......kC.f.....|
-000001e0  ac 4e 75 db b2 d1 4c 43  81 26 43 bf a3 af 0f 97  |.Nu...LC.&C.....|
-000001f0  83 a4 37 e1 aa 50 da e7  6b 3f a1 6c 80 ea b2 06  |..7..P..k?.l....|
-00000200  6b 51 b9 b9 b0 83 71 b1  56 fe c7 f6 9e e7 69 1c  |kQ....q.V.....i.|
-00000210  e7 6b ba 0e 46 b9 9d cb  dd 7f 9f bf a3 06 1d ba  |.k..F...........|
-00000220  5f eb 5e 1f dd 76 5f 8c  d7 4e d9 a0 c1 75 28 61  |_.^..v_..N...u(a|
-00000230  ea ef 4a 79 fc a6 8f 87  98 b2 26 ce 4e ae b7 9c  |..Jy......&.N...|
-00000240  ed 73 f3 98 a4 83 56 55  af d7 6d c3 90 fc ec 8d  |.s....VU..m.....|
-00000250  09 b4 a0 80 ac ff bc 1b  0b f9 70 4d 70 2b 19 ab  |..........pMp+..|
-00000260  d0 14 de 7c d2 ca b7 56  7f 19 d6 1a 11 04 50 3d  |...|...V......P=|
-00000270  12 dc 35 c1 ce b9 b0 e4  70 b3 27 4b 26 98 e3 af  |..5.....p.'K&...|
-00000280  7f 42 62 4b 75 33 61 54  2c 0f 03 bd b6 51 e9 5a  |.BbKu3aT,....Q.Z|
-00000290  bd 90 f9 af 8e 5f c2 ed  aa 63 a4 3b c7 e1 cb cc  |....._...c.;....|
-000002a0  8b 0f 48 39 9b 6c 49 08  9b f4 27 d8 d8 92 56 a3  |..H9.lI...'...V.|
-000002b0  ae a9 60 a9 ab 25 3d 3d  ba 36 60 00 39 bd 60 ab  |..`..%==.6`.9.`.|
-000002c0  58 bd 4d c2 ab 13 2d 70  2d ef 0c a3 65 17 45 ad  |X.M...-p-...e.E.|
-000002d0  b2 fc 92 ce cb 74 e9 b1  59 cb b2 f1 c7 06 6b 9d  |.....t..Y.....k.|
-000002e0  12 7a c1 51 3d c8 81 91  88 02 fa be 18 f2 9d 4d  |.z.Q=..........M|
-000002f0  04 53 3f 39 e9 49 1f fb  99 1b 71 94 44 dd 09 c5  |.S?9.I....q.D...|
-00000300  4a c4 71 45 2a d7 8f b9  a3 7d 2f df 23 d0 2c 83  |J.qE*....}/.#.,.|
-00000310  1a 90 0e 17 03 03 00 99  60 fb bc b6 8b 4a 50 fb  |........`....JP.|
-00000320  88 0e 23 81 34 07 98 f8  07 35 5f 12 98 4d a3 63  |..#.4....5_..M.c|
-00000330  c3 05 e7 99 eb 22 fe a9  da 60 25 70 e6 53 40 18  |....."...`%p.S@.|
-00000340  f9 66 c4 3c 0f 3c 9b 7b  3e 86 5f e9 0f 91 4e ea  |.f.<.<.{>._...N.|
-00000350  4f 38 dd ef 1c a8 80 16  ae 59 50 70 23 92 40 22  |O8.......YPp#.@"|
-00000360  01 d6 72 d4 e5 ee e7 b2  aa 07 d0 ac ee 63 8f dc  |..r..........c..|
-00000370  55 29 5e e5 6f be 28 1e  b5 ad ca 9a 30 94 57 16  |U)^.o.(.....0.W.|
-00000380  de 2b ba 7b 4a 50 a8 7a  fa 9d 45 89 d1 3c 97 d3  |.+.{JP.z..E..<..|
-00000390  9d c5 1d de cd d6 80 9b  bd 68 1c e2 8b e3 bb dc  |.........h......|
-000003a0  c5 2a 4d 38 ae d6 b3 1d  2e 35 52 d0 c0 b4 ae fd  |.*M8.....5R.....|
-000003b0  68 17 03 03 00 45 ac f9  bb 95 b5 c3 fb dc e9 21  |h....E.........!|
-000003c0  65 ef a9 2d 9c 6a 6b 51  35 9b 2b a9 6b f4 2f 66  |e..-.jkQ5.+.k./f|
-000003d0  14 9d e0 30 fc eb 43 bb  4f 1b 50 13 65 72 35 74  |...0..C.O.P.er5t|
-000003e0  dd 20 dc 88 54 e4 05 18  d7 02 ca 5b 27 dd 32 e9  |. ..T......['.2.|
-000003f0  a2 68 68 cc 55 ff 25 21  87 13 9b                 |.hh.U.%!...|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 f7  |..+.....3.$... .|
+00000060  88 ec 33 9c 98 e7 6d 31  3f de eb 97 df 15 ad 66  |..3...m1?......f|
+00000070  4c e1 d0 00 45 75 f7 a2  3c 75 11 db 11 12 0e 14  |L...Eu..<u......|
+00000080  03 03 00 01 01 17 03 03  00 17 6f 20 a1 e0 89 ad  |..........o ....|
+00000090  dd 37 b4 76 3a cf ac 65  4e a6 4b fb f6 d8 07 22  |.7.v:..eN.K...."|
+000000a0  8c 17 03 03 02 6d cc b4  a9 5a 14 96 56 64 55 9a  |.....m...Z..VdU.|
+000000b0  69 a2 5c 3c 07 43 f3 2e  16 ee ce 90 81 12 61 88  |i.\<.C........a.|
+000000c0  b9 d8 05 f5 b2 8e 4b 4c  ca 70 c8 8d 62 30 05 8e  |......KL.p..b0..|
+000000d0  0c b1 52 fa b0 67 a1 a7  24 18 e9 bd 09 25 ec 0a  |..R..g..$....%..|
+000000e0  08 dc 70 47 2b 7f aa 57  41 fe 5f 36 15 28 1c 1f  |..pG+..WA._6.(..|
+000000f0  a8 3c b5 4b ec 37 02 ef  5c 24 46 17 10 f2 9a ad  |.<.K.7..\$F.....|
+00000100  78 a1 04 0c 75 a2 a2 73  e1 12 61 2f 81 c3 f2 18  |x...u..s..a/....|
+00000110  fc e5 cf cd 43 44 47 e8  27 c6 d4 d7 e0 c2 63 db  |....CDG.'.....c.|
+00000120  bd 3e c1 10 9d 89 7c 0a  49 2b 4e 55 92 74 0a 1b  |.>....|.I+NU.t..|
+00000130  23 32 9d aa b1 17 15 3d  37 85 42 0e 5f 7c fa 5b  |#2.....=7.B._|.[|
+00000140  b8 ae f3 b9 4d b2 40 b5  e2 de e2 b3 f0 27 a6 f2  |....M.@......'..|
+00000150  0c 28 4b 77 ee 38 dc ec  17 28 18 03 13 85 60 2c  |.(Kw.8...(....`,|
+00000160  ab 16 e1 1c c6 e1 91 e0  5f f3 b6 f7 1c 3b 5f 03  |........_....;_.|
+00000170  6a d5 b0 a0 5b ab 6d 9c  b2 ee 8e 50 49 94 7d db  |j...[.m....PI.}.|
+00000180  3b fe 68 e2 79 3e 2d 33  06 a6 b2 9c 8b 7d 93 04  |;.h.y>-3.....}..|
+00000190  b4 9e 07 6d 15 80 63 38  8e 4b c5 e6 88 a0 6a f2  |...m..c8.K....j.|
+000001a0  11 60 11 7a f7 6e 7e 47  9f fd 77 12 c9 d5 8e 58  |.`.z.n~G..w....X|
+000001b0  84 51 2c f6 fd 2b d1 dc  a6 51 d8 20 3f 06 76 ad  |.Q,..+...Q. ?.v.|
+000001c0  dd 37 b6 e9 86 4e cb 31  76 79 60 26 c7 b4 d5 67  |.7...N.1vy`&...g|
+000001d0  2c 70 22 f4 4d b5 60 61  41 48 65 a8 d0 b5 d8 47  |,p".M.`aAHe....G|
+000001e0  08 bf 5b 67 e8 99 c4 a5  91 1e 36 6b 37 53 7b 65  |..[g......6k7S{e|
+000001f0  ac af 2d df 8e 77 e2 46  1a 65 45 0a 00 f2 8f 9d  |..-..w.F.eE.....|
+00000200  47 1c 93 64 52 c3 d9 91  47 41 88 7f 81 ea 8f 2b  |G..dR...GA.....+|
+00000210  a9 fa 4b d5 9d 6f 30 36  dc af e0 96 b3 f0 e4 6a  |..K..o06.......j|
+00000220  a3 10 cf 0e 53 64 e3 18  52 08 a9 16 e3 6d e9 0a  |....Sd..R....m..|
+00000230  ec 4d a4 f7 f1 ee 38 28  88 31 aa 38 a7 14 09 f4  |.M....8(.1.8....|
+00000240  1a 31 ac 40 46 dd f2 4f  7f ff f4 fc 71 42 61 73  |.1.@F..O....qBas|
+00000250  03 47 9f ec 69 7f 77 e3  91 29 cd 89 7f 45 6b 9d  |.G..i.w..)...Ek.|
+00000260  f5 33 66 8b 74 bc 53 ff  54 c3 af 48 8e d8 25 0a  |.3f.t.S.T..H..%.|
+00000270  99 49 08 29 f3 b2 a5 d0  5b ca 89 e2 d7 f5 5f 40  |.I.)....[....._@|
+00000280  72 6f b4 d6 20 39 79 4a  0e 7c 00 60 68 eb 1e ab  |ro.. 9yJ.|.`h...|
+00000290  ee 38 35 f2 db 83 9c 0b  52 80 15 14 ae 6b dc f5  |.85.....R....k..|
+000002a0  d5 f3 83 cb e7 5f 5c 98  e2 f2 d0 52 68 92 ff f6  |....._\....Rh...|
+000002b0  7a ce ff ae 96 6e ad 11  d2 5e bc 60 16 55 cd 81  |z....n...^.`.U..|
+000002c0  25 67 5b db 76 59 36 a8  48 d6 91 86 4f cb 87 5f  |%g[.vY6.H...O.._|
+000002d0  ea 96 e4 71 df ac 54 5a  a0 e1 0a bd 88 68 ff 0a  |...q..TZ.....h..|
+000002e0  97 be 9b da cf aa e1 b1  74 c9 8d 5f 19 f5 df 53  |........t.._...S|
+000002f0  a0 57 93 7d c3 fe 37 78  2a ba 6b c2 a1 51 41 f4  |.W.}..7x*.k..QA.|
+00000300  ee 57 ed d2 7d 48 14 31  4a f7 14 d4 0e 42 9e fb  |.W..}H.1J....B..|
+00000310  fb f4 cd 17 03 03 00 99  6b 70 ae fc d3 07 5e 7f  |........kp....^.|
+00000320  39 2a 27 34 54 8a b6 4d  39 36 d4 38 0c ed 8c 24  |9*'4T..M96.8...$|
+00000330  fc 29 1d 59 74 99 f1 e1  a1 23 4b 6d 27 31 f4 2d  |.).Yt....#Km'1.-|
+00000340  8b b3 23 aa 92 5f 01 3d  a1 f6 b5 24 8e 56 ea eb  |..#.._.=...$.V..|
+00000350  4e 0a dc 23 ae 32 1b 0d  cb bc 60 87 b7 35 32 5f  |N..#.2....`..52_|
+00000360  10 32 fb 89 32 3f 99 0e  30 0d 65 28 69 c4 3b f8  |.2..2?..0.e(i.;.|
+00000370  6c 04 a5 bf ec e9 aa c4  bc b4 55 e2 d0 09 a1 4b  |l.........U....K|
+00000380  82 f8 a5 37 ab ca 69 f4  bc 24 69 c4 ce 07 6c ee  |...7..i..$i...l.|
+00000390  d6 08 92 14 41 ca 8f c8  c9 37 ae b5 f3 29 ff 69  |....A....7...).i|
+000003a0  7a 18 4e 93 dd eb 52 58  d2 6b 22 6d b6 29 70 b3  |z.N...RX.k"m.)p.|
+000003b0  ea 17 03 03 00 45 10 35  86 2e d4 e3 92 35 a3 0e  |.....E.5.....5..|
+000003c0  a1 cd 79 11 05 cd 77 c4  93 f4 6a ba f8 fc 4b bd  |..y...w...j...K.|
+000003d0  63 5d c0 2d a0 c9 c2 2a  10 79 e9 0c bc 0b 18 c1  |c].-...*.y......|
+000003e0  15 18 c0 8a d7 05 39 f1  de 6e 8e cb dd 73 5f ee  |......9..n...s_.|
+000003f0  28 93 f9 92 35 56 1f c1  e4 8d 89                 |(...5V.....|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 45 87 09 9a a9 a0  |..........E.....|
-00000010  6a 25 7e 7f ef f2 95 97  45 9f 25 b3 fc 70 1d a5  |j%~.....E.%..p..|
-00000020  c5 e3 bc 95 95 c2 2e 9b  46 d9 cd 5e 04 29 33 9f  |........F..^.)3.|
-00000030  8c 35 d5 b0 4c 35 e7 f4  02 1a 1a 9f 07 e5 e4 9d  |.5..L5..........|
-00000040  6f 63 35 d5 c9 21 9f 90  95 a5 14 14 fc 8a bb 41  |oc5..!.........A|
-00000050  17 03 03 00 17 3d e1 e9  33 73 b4 29 68 d2 50 d2  |.....=..3s.)h.P.|
-00000060  58 9b 85 21 07 3a a8 87  92 37 53 90 17 03 03 00  |X..!.:...7S.....|
-00000070  13 24 0a cf 8a 3e 88 9d  9f 57 81 26 10 06 fc 70  |.$...>...W.&...p|
-00000080  1d fa da 81                                       |....|
+00000000  14 03 03 00 01 01 17 03  03 00 45 2f 08 54 f6 2b  |..........E/.T.+|
+00000010  fd 13 5d 87 d3 b6 73 5e  20 88 af 53 db 7e 3c 37  |..]...s^ ..S.~<7|
+00000020  1d 52 a4 ae 91 3f 24 a7  30 26 02 da 13 f3 c5 60  |.R...?$.0&.....`|
+00000030  28 e6 eb 8f e1 1b 58 2d  bb d0 06 c4 67 33 1c a1  |(.....X-....g3..|
+00000040  03 cb 16 56 1b 91 06 08  b6 34 c5 de 97 04 ee f0  |...V.....4......|
+00000050  17 03 03 00 17 6c 7e 3d  5d 98 4e 42 81 42 c5 2c  |.....l~=].NB.B.,|
+00000060  b2 c2 d3 c9 58 bc 13 bc  61 cd 63 f2 17 03 03 00  |....X...a.c.....|
+00000070  13 83 c7 4a b6 10 69 b4  16 be 25 a1 db cb c9 94  |...J..i...%.....|
+00000080  8f a2 27 22                                       |..'"|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ALPN b/src/crypto/tls/testdata/Client-TLSv13-ALPN
index d83b270019..ff0989c567 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ALPN
+++ b/src/crypto/tls/testdata/Client-TLSv13-ALPN
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 30 01 00 01  2c 03 03 00 00 00 00 00  |....0...,.......|
+00000000  16 03 01 01 2c 01 00 01  28 03 03 00 00 00 00 00  |....,...(.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,89 +7,89 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 b1 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 ad 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 10 00 10 00 0e  |................|
-000000f0  06 70 72 6f 74 6f 32 06  70 72 6f 74 6f 31 00 2b  |.proto2.proto1.+|
-00000100  00 09 08 03 04 03 03 03  02 03 01 00 33 00 26 00  |............3.&.|
-00000110  24 00 1d 00 20 2f e5 7d  a3 47 cd 62 43 15 28 da  |$... /.}.G.bC.(.|
-00000120  ac 5f bb 29 07 30 ff f6  84 af c4 cf c2 ed 90 99  |._.).0..........|
-00000130  5f 58 cb 3b 74                                    |_X.;t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 10  00 10 00 0e 06 70 72 6f  |.............pro|
+000000f0  74 6f 32 06 70 72 6f 74  6f 31 00 2b 00 09 08 03  |to2.proto1.+....|
+00000100  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000110  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000120  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000130  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 cb f0 b7 02 94  |....z...v.......|
-00000010  1a 0a b2 1d 4b 7c 43 99  cb 50 bd aa 72 80 91 98  |....K|C..P..r...|
-00000020  bc 29 68 eb bd 81 b5 32  7c fe 9b 20 00 00 00 00  |.)h....2|.. ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 bb 72 d9 b8 e5  |....z...v...r...|
+00000010  0b 80 14 4c 16 9b 86 ec  26 62 f2 f9 00 85 a6 ae  |...L....&b......|
+00000020  44 f4 27 c4 13 67 4a 2e  96 e6 33 20 00 00 00 00  |D.'..gJ...3 ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 78  |..+.....3.$... x|
-00000060  05 c7 69 04 93 8d 93 d7  d3 eb 0b 00 70 98 99 c1  |..i.........p...|
-00000070  2a a9 84 7f e5 6c 4c d0  b1 f3 10 71 11 c6 78 14  |*....lL....q..x.|
-00000080  03 03 00 01 01 17 03 03  00 24 6d 09 77 65 0f 29  |.........$m.we.)|
-00000090  b9 e5 1d df a9 e7 98 f6  f3 37 70 4b 8f cf 49 db  |.........7pK..I.|
-000000a0  fb 8f 73 fc 7f 9e ea e0  a0 35 ee 93 a0 34 17 03  |..s......5...4..|
-000000b0  03 02 6d 90 a9 c1 79 ef  b1 e3 7a 7d 3d f6 8e bd  |..m...y...z}=...|
-000000c0  18 04 6a 1c d4 72 52 ad  36 fc 21 c6 0b 94 8b 98  |..j..rR.6.!.....|
-000000d0  0e 98 54 c5 ff 3c 6d d2  15 c4 63 51 a6 00 4b 28  |..T..<m...cQ..K(|
-000000e0  c7 63 61 5c 09 0d 15 fc  53 0d fa b6 59 ff c9 82  |.ca\....S...Y...|
-000000f0  e1 93 6d 3d b0 24 b2 5d  23 d1 da 61 7f c9 79 32  |..m=.$.]#..a..y2|
-00000100  65 5f 41 6e 49 28 8e 1f  cd 7e 12 98 48 c9 79 ea  |e_AnI(...~..H.y.|
-00000110  db 5a 7f d5 4b dc 41 3c  64 5d 50 83 a2 2b 8c d2  |.Z..K.A<d]P..+..|
-00000120  d7 9e 96 99 25 05 b6 5c  48 62 1c 65 f7 2a a2 77  |....%..\Hb.e.*.w|
-00000130  df 46 30 8f 8a 39 9f 79  49 2d 47 97 75 b7 26 a3  |.F0..9.yI-G.u.&.|
-00000140  5b ee 67 f0 67 ae 1a 9d  f2 77 2f b6 3a 70 52 f8  |[.g.g....w/.:pR.|
-00000150  5d 26 58 21 9e 73 6a 00  99 75 bb 8e 8d b0 2c b9  |]&X!.sj..u....,.|
-00000160  05 cf 69 fe ec 45 06 d5  1d ca f9 c3 08 97 c0 e9  |..i..E..........|
-00000170  38 d8 76 27 d4 4b 40 42  f8 73 bf 7b 4b 42 5e 13  |8.v'.K@B.s.{KB^.|
-00000180  11 7e 75 af 92 7f 47 92  9e d8 15 b4 07 10 bf 74  |.~u...G........t|
-00000190  4f 55 4e 0d 4c 53 b6 5c  f8 07 87 40 0f 79 4e 76  |OUN.LS.\...@.yNv|
-000001a0  0a 19 48 48 37 a6 3c a1  69 56 5f 85 19 61 84 28  |..HH7.<.iV_..a.(|
-000001b0  8c 01 cf 0b 79 94 0f 31  e9 ca ad 5e fb a4 4e 21  |....y..1...^..N!|
-000001c0  13 de b7 d3 fd 38 6f c6  37 42 23 89 e1 23 e0 92  |.....8o.7B#..#..|
-000001d0  f4 ca 3b 92 b4 6d 87 32  11 c6 b5 80 27 d9 de b3  |..;..m.2....'...|
-000001e0  80 fa c4 0d a7 de 0a b3  39 79 3a bc 38 e0 fa 5c  |........9y:.8..\|
-000001f0  ec 3f ab cb a7 d9 02 c4  56 6b f8 90 73 50 98 be  |.?......Vk..sP..|
-00000200  0f ad 95 22 3e 20 97 7c  50 f9 8d 8a 43 4a 20 d1  |..."> .|P...CJ .|
-00000210  68 1c 2f bf 4e 72 a0 51  9f 22 d1 51 bf b4 b0 b1  |h./.Nr.Q.".Q....|
-00000220  fe 78 2b 0e a9 6d f1 27  82 46 a9 2d 43 73 29 0c  |.x+..m.'.F.-Cs).|
-00000230  c2 6d f8 0c c9 78 d3 ba  5d 5f 96 13 fd 2f 1f e9  |.m...x..]_.../..|
-00000240  8f 93 e6 61 7e 0e 07 49  cb 5c af 51 72 85 67 b8  |...a~..I.\.Qr.g.|
-00000250  63 e8 f9 4f 7c d7 e4 d1  25 c0 ed 26 de 1f 65 d4  |c..O|...%..&..e.|
-00000260  2a 3b 23 30 38 12 56 97  01 f1 bd 3f 96 23 72 89  |*;#08.V....?.#r.|
-00000270  2e 88 d6 6a 9f 52 a7 3e  42 72 dc c4 e0 05 81 42  |...j.R.>Br.....B|
-00000280  45 e1 c5 6f 32 82 bf 4e  38 a0 06 eb 99 2c 8b 79  |E..o2..N8....,.y|
-00000290  f9 2e a7 26 3a 78 fd 90  66 7c 0f 53 4c 4a 00 c2  |...&:x..f|.SLJ..|
-000002a0  9d 48 2c a5 37 02 e0 cd  5d 16 1c d4 ee 03 79 71  |.H,.7...].....yq|
-000002b0  c6 c2 e4 15 98 6b 40 bb  e9 b6 21 a1 e7 fc 68 b2  |.....k@...!...h.|
-000002c0  70 cb d5 e1 5b 2d f7 b7  6b d5 2c 50 19 8a 6a 50  |p...[-..k.,P..jP|
-000002d0  54 97 bc 90 2b b2 20 6a  9c 96 5d cf d0 5f 9a 6d  |T...+. j..].._.m|
-000002e0  b4 70 33 ba 83 2d f7 86  41 8b 88 20 51 ae a8 02  |.p3..-..A.. Q...|
-000002f0  af 63 ea 1c 0c b0 99 19  73 56 02 68 a9 50 b2 43  |.c......sV.h.P.C|
-00000300  6b 9c 5d c2 f3 48 dd fe  a3 7c 2b 28 a5 e5 25 ed  |k.]..H...|+(..%.|
-00000310  05 14 a3 d6 63 25 2e 44  4e f9 fd 6d 9e 16 ae e6  |....c%.DN..m....|
-00000320  17 03 03 00 99 b8 3d db  c6 ee 13 dd 97 29 32 71  |......=......)2q|
-00000330  67 28 89 90 cf c5 23 4a  9e 94 31 7c 5d 6c b3 7c  |g(....#J..1|]l.||
-00000340  46 a6 b2 98 c2 e2 b9 a6  c1 7d fd 22 5c 7b 88 67  |F........}."\{.g|
-00000350  cc c6 4a 82 83 f9 8a 09  8b 2c d5 9f 0f c3 1d 23  |..J......,.....#|
-00000360  b5 27 89 ba 5e 0f 74 96  58 da 5e 3f 63 b2 f3 44  |.'..^.t.X.^?c..D|
-00000370  31 86 d0 da 18 54 eb 34  89 fc 11 ee 8e af c1 42  |1....T.4.......B|
-00000380  bd 6b 31 c3 f1 54 96 fd  86 37 0d 20 b9 70 3b 88  |.k1..T...7. .p;.|
-00000390  20 87 c3 9f 1a 6b 90 7d  84 1d 69 42 01 bc 3d 81  | ....k.}..iB..=.|
-000003a0  c9 ea 82 a3 d1 18 bf 4c  3a dc d4 db 92 cc 5d b2  |.......L:.....].|
-000003b0  f2 dd b4 17 39 13 ef 45  cc 66 4d d1 f2 a4 17 03  |....9..E.fM.....|
-000003c0  03 00 35 3f 02 3e 15 06  ad 50 e9 14 30 be 33 d9  |..5?.>...P..0.3.|
-000003d0  18 1c 44 df 42 fa 3f aa  84 31 a7 b3 d8 3c 8e 04  |..D.B.?..1...<..|
-000003e0  b3 fc 41 66 4a f0 71 03  0d 0b b5 46 f1 34 f5 37  |..AfJ.q....F.4.7|
-000003f0  4c 1c 1a 05 75 98 58 f3                           |L...u.X.|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 69  |..+.....3.$... i|
+00000060  d7 31 51 9b e6 1d 98 09  9f 5f 6c 05 10 ba 64 b5  |.1Q......_l...d.|
+00000070  b9 8f b8 c0 2a c1 7f 89  13 ed 04 38 e9 78 43 14  |....*......8.xC.|
+00000080  03 03 00 01 01 17 03 03  00 24 99 f3 d5 db e2 35  |.........$.....5|
+00000090  4b fb b2 05 e6 03 c2 f2  c4 ea 64 d2 e4 d3 17 e7  |K.........d.....|
+000000a0  72 34 e8 b2 d6 61 91 3b  b3 03 ea 1c 33 57 17 03  |r4...a.;....3W..|
+000000b0  03 02 6d 22 da 71 90 42  da 0a 03 52 98 42 e3 71  |..m".q.B...R.B.q|
+000000c0  db 57 e0 9d 70 89 4b 4c  a9 a5 4d 39 02 19 f1 09  |.W..p.KL..M9....|
+000000d0  5a 9c 33 c9 f2 8d 7e 78  c3 b3 ae 1b 2c 7b 73 ef  |Z.3...~x....,{s.|
+000000e0  3a ad d8 51 82 90 bc 6b  0d 6f a6 f0 46 8d 72 29  |:..Q...k.o..F.r)|
+000000f0  ca 84 d8 b1 27 e3 8d 8f  f5 ce f0 f0 d9 2f 9c 71  |....'......../.q|
+00000100  b9 bc 89 af 92 18 d2 c9  07 b2 eb 94 40 42 d2 7a  |............@B.z|
+00000110  c8 be 49 35 b6 b7 f3 b9  64 c1 56 fe fc d8 11 04  |..I5....d.V.....|
+00000120  6c d7 e9 18 98 29 eb d5  6f 59 0d fa 25 85 f7 3c  |l....)..oY..%..<|
+00000130  df 76 d9 52 10 72 59 d6  36 5b b0 54 01 1d ac 9e  |.v.R.rY.6[.T....|
+00000140  9b 86 5f 5b ee 18 74 ec  8e 8b da 0f df 71 50 e2  |.._[..t......qP.|
+00000150  cd 58 98 23 a0 21 94 ac  eb db 3a fe f6 8d aa cc  |.X.#.!....:.....|
+00000160  21 23 e6 35 f7 0e 42 0e  50 48 14 22 f3 83 91 3d  |!#.5..B.PH."...=|
+00000170  73 22 5b 74 e7 e8 d1 b5  ee cd 7e c3 ee 0d 13 a9  |s"[t......~.....|
+00000180  aa ae 0b 12 b0 3a 9d 6f  01 68 27 e4 62 e0 0e 67  |.....:.o.h'.b..g|
+00000190  e4 de 69 74 8d f1 7a 3b  16 bb 1d a0 ad bf c5 4b  |..it..z;.......K|
+000001a0  50 9e b0 dc 08 73 14 99  c9 ad de 04 df 75 09 de  |P....s.......u..|
+000001b0  e4 27 ec 2b 75 79 db 82  8c aa 42 af 40 df 32 0e  |.'.+uy....B.@.2.|
+000001c0  e6 1d 93 d1 00 f7 18 59  43 9c 03 6c f7 bf ac a2  |.......YC..l....|
+000001d0  8b 10 be b1 a8 b6 4e 84  2b c0 ff 87 4d 26 c2 8f  |......N.+...M&..|
+000001e0  63 64 7a 66 a6 12 0b e4  06 9e ff af fe 03 55 c7  |cdzf..........U.|
+000001f0  13 92 22 ec ed 89 76 2d  36 8a 4a 92 f1 a5 b6 ac  |.."...v-6.J.....|
+00000200  d4 19 46 9d f3 e0 52 6d  01 ee bf ab d5 17 c0 33  |..F...Rm.......3|
+00000210  b5 81 e1 81 a2 e9 44 b7  20 0e f4 f0 35 bb d4 8d  |......D. ...5...|
+00000220  bc 83 fc 59 fb 1d 5e e0  c4 4c 9e cc c3 72 b7 3d  |...Y..^..L...r.=|
+00000230  01 a4 f2 df e2 a7 44 d1  f1 20 90 31 53 09 50 eb  |......D.. .1S.P.|
+00000240  80 85 23 52 68 7d b2 51  60 0c 00 87 c3 42 88 07  |..#Rh}.Q`....B..|
+00000250  de 59 fd 3d 68 a3 22 50  cb 67 43 94 02 77 24 6a  |.Y.=h."P.gC..w$j|
+00000260  8d a4 4f 85 7f 19 a0 b5  10 76 2a 85 4c 84 12 e3  |..O......v*.L...|
+00000270  f7 ce b8 30 9f d0 9f 8a  26 42 28 f4 cb f7 c4 c2  |...0....&B(.....|
+00000280  aa 34 c2 72 64 dc 6d 9d  d4 26 2f 14 4d 97 2c 00  |.4.rd.m..&/.M.,.|
+00000290  2d 46 0f 07 9c 3d 76 d4  55 a7 15 13 b2 41 e3 f4  |-F...=v.U....A..|
+000002a0  33 ae 1b 26 68 43 62 de  c1 c2 61 26 08 1b 20 13  |3..&hCb...a&.. .|
+000002b0  bc 58 72 c2 16 fe 4d 2e  68 8b 31 61 ac c9 55 c5  |.Xr...M.h.1a..U.|
+000002c0  3c 5a 77 c2 61 47 4a d6  0d c4 8a bc bb 63 ca ea  |<Zw.aGJ......c..|
+000002d0  32 77 61 86 75 b6 9a 17  d9 68 cb 23 ab cb 06 51  |2wa.u....h.#...Q|
+000002e0  44 0a 87 07 b5 60 ef d4  e6 4f 95 7b 27 80 f2 99  |D....`...O.{'...|
+000002f0  10 cf b8 d1 2f 45 76 58  7e 34 bf 7c 93 eb ed 69  |..../EvX~4.|...i|
+00000300  26 7e 2d 8c 88 02 2a 2c  9e 8c 5f e6 f8 d7 7e 92  |&~-...*,.._...~.|
+00000310  9b 9b 49 ba e7 af 38 c7  46 50 c9 c4 b1 c7 ab 42  |..I...8.FP.....B|
+00000320  17 03 03 00 99 ee 16 d6  9d fb d1 a0 d5 26 b9 91  |.............&..|
+00000330  9d ef e8 18 98 2a 6a ba  9c b7 f7 94 79 89 70 1d  |.....*j.....y.p.|
+00000340  4c f5 82 07 fe 2a 52 00  95 e4 5b bc 43 f5 0b b8  |L....*R...[.C...|
+00000350  bb a2 d0 d2 12 1b 15 a2  e9 e2 ab a0 81 3d 84 5c  |.............=.\|
+00000360  1e 66 57 d2 0a bc d3 38  f7 ed fe 52 3d 43 02 f2  |.fW....8...R=C..|
+00000370  42 aa 04 5e 12 4f ad 0b  d6 43 a7 13 15 8c f7 a0  |B..^.O...C......|
+00000380  69 1c 12 d3 c7 6f 7c aa  19 c5 8a ad 5a 42 a0 69  |i....o|.....ZB.i|
+00000390  d5 ee be ee 76 fc 38 71  59 fe e9 46 df e1 e1 50  |....v.8qY..F...P|
+000003a0  57 8a 36 ea 50 ad 23 10  ae 26 45 49 a2 65 e7 ee  |W.6.P.#..&EI.e..|
+000003b0  2f a5 bc 9f 14 8e 70 89  5c 29 0e 75 fd 88 17 03  |/.....p.\).u....|
+000003c0  03 00 35 d2 0a 4e 43 dc  51 35 78 5d 04 7a 86 6c  |..5..NC.Q5x].z.l|
+000003d0  62 3e 30 bb b3 e1 02 38  62 41 ce 4c 39 34 d9 e8  |b>0....8bA.L94..|
+000003e0  ee 48 70 3c 23 65 90 cb  f9 4f 76 72 dd f3 64 83  |.Hp<#e...Ovr..d.|
+000003f0  23 38 79 13 d2 93 57 fb                           |#8y...W.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 61 48 9d d3 32  |..........5aH..2|
-00000010  7b ac 9d 5a c5 29 b2 4f  74 ef b8 8e f0 1e b9 33  |{..Z.).Ot......3|
-00000020  4f cb db 0b 3e 49 47 44  64 ce 16 6b e4 a2 7c 8a  |O...>IGDd..k..|.|
-00000030  cc e4 01 9e bd 3d a7 30  cd a1 ff 23 d2 fc 7f fc  |.....=.0...#....|
-00000040  17 03 03 00 17 6b a9 a0  55 b2 53 19 0f 58 7c 79  |.....k..U.S..X|y|
-00000050  5a 19 9a 4a 9b 1b 77 8d  78 9c 9c b6 17 03 03 00  |Z..J..w.x.......|
-00000060  13 f0 e9 91 46 e4 0a a1  0f e9 43 8e 10 d7 61 80  |....F.....C...a.|
-00000070  95 4b db 96                                       |.K..|
+00000000  14 03 03 00 01 01 17 03  03 00 35 f1 1a 54 a4 02  |..........5..T..|
+00000010  59 df 81 64 1d 06 93 27  55 41 83 40 9c a0 fa 44  |Y..d...'UA.@...D|
+00000020  dd 80 16 6b ed fb 36 ec  0d 49 ee 93 99 84 55 30  |...k..6..I....U0|
+00000030  94 4c 46 7a b9 ba db f0  6a e5 90 ce 58 b1 95 2e  |.LFz....j...X...|
+00000040  17 03 03 00 17 ed 07 24  e5 f8 f3 91 4c f1 05 dc  |.......$....L...|
+00000050  d0 ea a5 c2 cd fb bf 14  45 99 69 53 17 03 03 00  |........E.iS....|
+00000060  13 d7 bf a6 c1 66 5d 7b  00 fb 5a 6e b8 81 99 3a  |.....f]{..Zn...:|
+00000070  30 08 a2 3c                                       |0..<|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-CHACHA20-SHA256 b/src/crypto/tls/testdata/Client-TLSv13-CHACHA20-SHA256
index 6becede60f..f2c1cb499a 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-CHACHA20-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv13-CHACHA20-SHA256
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,87 +7,86 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 37 bf a4 0d 23  |....z...v..7...#|
-00000010  be 83 2a 9d 84 f6 de 1c  53 be 13 92 f3 de 35 a9  |..*.....S.....5.|
-00000020  cc 95 6d e1 c6 05 2f 53  a6 ce 9f 20 00 00 00 00  |..m.../S... ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 f9 23 d9 5d 6c  |....z...v...#.]l|
+00000010  ae 6b 63 2a d8 2c a0 27  8e 7b 39 29 35 04 0e a9  |.kc*.,.'.{9)5...|
+00000020  31 f7 a0 c5 77 a7 f3 c5  25 ca 2f 20 00 00 00 00  |1...w...%./ ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 3d  |..+.....3.$... =|
-00000060  1c 09 5d 44 bc 3f 39 2d  9a dd c1 15 0f dc 5d 7c  |..]D.?9-......]||
-00000070  93 06 89 42 27 f0 cd 63  55 3e 74 3f 87 10 7a 14  |...B'..cU>t?..z.|
-00000080  03 03 00 01 01 17 03 03  00 17 bd 92 4d 21 8d dc  |............M!..|
-00000090  7b 19 1b f9 44 64 38 5c  61 c3 19 70 75 29 05 e8  |{...Dd8\a..pu)..|
-000000a0  ef 17 03 03 02 6d a4 a0  79 ad 41 c1 d2 6b 78 fd  |.....m..y.A..kx.|
-000000b0  4b 1f 6f 72 c4 92 94 17  dd 40 80 b6 f2 a0 85 4d  |K.or.....@.....M|
-000000c0  ba 4c 3a 34 80 67 21 2f  6d 2e fc 4e a8 2b ab 86  |.L:4.g!/m..N.+..|
-000000d0  18 6c 03 2d e6 ac 2c 3c  ce 4c 2d ff 7d fd 44 fc  |.l.-..,<.L-.}.D.|
-000000e0  4e 1d 62 c5 b1 22 60 6c  56 1e 6d bf d8 90 02 cb  |N.b.."`lV.m.....|
-000000f0  d2 6c 52 7c f3 51 11 49  62 7a f0 f3 8f 51 bf 0e  |.lR|.Q.Ibz...Q..|
-00000100  bc 07 9b 1f d9 32 26 d8  c5 01 4d 84 31 3f 4b 33  |.....2&...M.1?K3|
-00000110  d0 c7 0c 86 89 bc 88 7d  70 6d 70 38 89 5b 8c d0  |.......}pmp8.[..|
-00000120  4d c0 9d 35 20 50 52 c7  5d 9c b3 51 30 46 6a 12  |M..5 PR.]..Q0Fj.|
-00000130  54 36 34 55 9a 25 43 39  28 40 13 9a 56 fa a7 f9  |T64U.%C9(@..V...|
-00000140  1f 3c 0f da fb ce c2 ed  da 9f 6c 99 53 76 74 a8  |.<........l.Svt.|
-00000150  4b 62 8a 55 cf a1 bc 5f  10 bb 8e 77 c8 4f bd 1b  |Kb.U..._...w.O..|
-00000160  d4 72 07 00 4c 8b b6 d7  3a 1a 43 93 34 b4 0a 2d  |.r..L...:.C.4..-|
-00000170  62 62 a1 e6 96 1a 71 38  a9 06 ae 6f ca 08 6f 52  |bb....q8...o..oR|
-00000180  09 c7 c8 37 13 4c 3b be  7b 60 29 7b d4 28 3e 71  |...7.L;.{`){.(>q|
-00000190  55 29 bd ab 62 3c 90 1f  8c ed 55 5d 81 85 0b 63  |U)..b<....U]...c|
-000001a0  57 8e f9 50 eb b8 3e c6  e0 b0 fa cc 68 42 41 0c  |W..P..>.....hBA.|
-000001b0  b0 34 f7 5d 39 f4 cd fe  9c ac 42 78 60 b2 27 55  |.4.]9.....Bx`.'U|
-000001c0  c2 2e e0 aa 84 00 8f 80  11 d2 52 92 78 2d b7 f6  |..........R.x-..|
-000001d0  70 37 e8 87 0b 13 04 29  5b a2 50 fb 4d ad 5e 98  |p7.....)[.P.M.^.|
-000001e0  59 a1 f7 7a 80 30 42 c2  59 96 97 f8 47 88 25 f3  |Y..z.0B.Y...G.%.|
-000001f0  25 02 ec 9c f3 93 97 63  b1 b2 90 0a 96 66 17 68  |%......c.....f.h|
-00000200  3d f0 32 5b d2 4a 3b 97  95 30 f1 22 be f9 04 87  |=.2[.J;..0."....|
-00000210  8d 58 d6 81 62 00 85 6c  76 07 c4 7d 05 42 0e 25  |.X..b..lv..}.B.%|
-00000220  7b 0d 92 42 bb 8a 36 47  11 2f f1 59 aa 01 44 28  |{..B..6G./.Y..D(|
-00000230  96 f0 f6 22 c4 74 c7 1b  3f 9d 67 30 f5 72 f8 24  |...".t..?.g0.r.$|
-00000240  b7 5c 9f d5 cb 51 a8 e5  6c b3 f6 0b 00 86 fc bb  |.\...Q..l.......|
-00000250  ab 1f d8 89 07 e9 a6 0b  48 93 e6 6e ca a3 b4 9a  |........H..n....|
-00000260  bc 5c 9c 4e ae 64 17 9d  4d 1f b7 c9 fa 8e a3 94  |.\.N.d..M.......|
-00000270  a0 da 4e 17 1a b8 f8 1a  a7 df dd cb 29 3b bb cf  |..N.........);..|
-00000280  1a 26 a2 74 d6 b2 80 63  f4 fb 28 10 ea 27 fa 48  |.&.t...c..(..'.H|
-00000290  d8 e6 68 34 0f 5f ca 20  e9 3e 01 77 f2 e8 23 70  |..h4._. .>.w..#p|
-000002a0  29 67 60 96 81 63 2e 7f  7d d3 30 fa 4c e1 fc bd  |)g`..c..}.0.L...|
-000002b0  a2 94 e5 1a 0c f3 bc 68  19 aa 20 09 7c 37 68 ac  |.......h.. .|7h.|
-000002c0  d2 3e 08 1c e5 fb e6 ef  b4 1b 8b 58 9c 32 ef 66  |.>.........X.2.f|
-000002d0  a0 a3 32 4f ce 37 5b 2f  99 d0 65 1a 26 2c 69 ca  |..2O.7[/..e.&,i.|
-000002e0  53 2a a2 cb 95 b6 a4 aa  bf 51 53 ab 56 73 22 ad  |S*.......QS.Vs".|
-000002f0  b0 26 18 dd 9c 34 f4 01  bc 10 7c fb b0 b4 97 55  |.&...4....|....U|
-00000300  93 fb 94 b1 16 2f 31 50  a5 fa d4 1d 7c b1 a3 3a  |...../1P....|..:|
-00000310  28 c1 ab 17 03 03 00 99  37 2c 7e fb bc 61 42 37  |(.......7,~..aB7|
-00000320  b4 d1 ab 9c e2 45 25 1f  dd 2a d3 f2 90 a1 25 01  |.....E%..*....%.|
-00000330  26 44 18 6b f3 ba c5 a1  e2 d2 71 c8 00 81 97 2d  |&D.k......q....-|
-00000340  08 a7 f3 4e 9e 8c b4 d2  a4 22 77 89 65 23 82 56  |...N....."w.e#.V|
-00000350  f6 21 f3 5f 06 0c 50 9b  5b 09 b5 b9 a4 d8 d5 dd  |.!._..P.[.......|
-00000360  e6 2b 98 8b 7d c7 0e 5c  00 1d 2b ab 52 d0 1a 57  |.+..}..\..+.R..W|
-00000370  9f d2 ee 5c c8 5c 9e da  df 36 f5 29 2c 31 ec 93  |...\.\...6.),1..|
-00000380  36 61 2c a6 a2 09 04 f5  58 ed ac e8 cc b9 20 11  |6a,.....X..... .|
-00000390  94 73 f7 98 0b 88 46 7d  37 f2 2d 67 57 e5 66 cb  |.s....F}7.-gW.f.|
-000003a0  69 03 3b 1d ec 98 e8 98  d0 48 d1 15 34 22 f1 d5  |i.;......H..4"..|
-000003b0  2e 17 03 03 00 35 50 7a  9f 59 68 a8 06 55 35 93  |.....5Pz.Yh..U5.|
-000003c0  ae 92 9d e6 1a 9b 33 c6  bb ee 1a 4a 87 29 89 e6  |......3....J.)..|
-000003d0  69 0c b7 c9 b5 1d 73 9d  70 4c 4e 35 e2 a6 b3 9e  |i.....s.pLN5....|
-000003e0  0e 51 06 42 dd bf b0 6b  32 b3 8b                 |.Q.B...k2..|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 ba  |..+.....3.$... .|
+00000060  2b 6b 27 27 14 c0 42 b6  1f bc ad 77 f1 1f 4a b3  |+k''..B....w..J.|
+00000070  42 94 a6 3a 2c 7f e6 aa  72 8e d0 70 e8 0e 53 14  |B..:,...r..p..S.|
+00000080  03 03 00 01 01 17 03 03  00 17 33 bb 8a 47 b0 a9  |..........3..G..|
+00000090  29 d7 bf e4 94 7d 42 8a  19 95 4e d9 7c b7 9a 87  |)....}B...N.|...|
+000000a0  83 17 03 03 02 6d 86 a7  6c 3c 4e 45 95 f6 f6 66  |.....m..l<NE...f|
+000000b0  84 2e 8c 5d 7d 46 39 a3  0f 99 25 fa 6d df ad 43  |...]}F9...%.m..C|
+000000c0  b6 bb 7a 4c a3 08 d3 91  79 e0 f2 a6 78 03 21 56  |..zL....y...x.!V|
+000000d0  21 64 22 dd 60 76 d1 f1  6f ae 68 d1 74 66 e2 0b  |!d".`v..o.h.tf..|
+000000e0  d4 b2 d8 04 32 91 46 6c  79 09 12 67 b7 33 3b b9  |....2.Fly..g.3;.|
+000000f0  18 73 29 68 3b 26 41 1d  bf d8 b2 4d f4 00 2e 23  |.s)h;&A....M...#|
+00000100  bd e6 53 ff d7 d9 45 1a  6c 3a 6e 43 a0 f2 cc 03  |..S...E.l:nC....|
+00000110  c8 de e5 ac eb d9 5c 8f  25 69 b8 49 8b c5 4c 97  |......\.%i.I..L.|
+00000120  b5 ff 15 49 dd e6 7c 19  ca 75 8f 7c ec 44 a0 2f  |...I..|..u.|.D./|
+00000130  f9 6a ff 99 ab 9f 0b 65  1d c4 74 3c 6e 49 24 47  |.j.....e..t<nI$G|
+00000140  f6 f7 bc 29 72 72 72 2c  21 54 0e 21 c4 18 6f 55  |...)rrr,!T.!..oU|
+00000150  8a bc 28 f0 f0 d4 a7 77  00 8d af a7 3c 1f 46 ab  |..(....w....<.F.|
+00000160  5c 4a 30 ef 27 3c 4c 03  1d 58 43 e9 eb 26 54 6e  |\J0.'<L..XC..&Tn|
+00000170  13 5b 78 85 9f 5e 68 da  92 fa b7 ef 40 c5 18 a5  |.[x..^h.....@...|
+00000180  cb 06 96 dd d2 f7 5d 41  77 51 89 23 41 29 d8 5c  |......]AwQ.#A).\|
+00000190  47 48 12 1c cf 61 ce 42  c8 3c 60 4a 29 f7 c6 95  |GH...a.B.<`J)...|
+000001a0  a1 05 8e 82 bc 73 d7 43  b6 be 09 f9 bb 47 53 08  |.....s.C.....GS.|
+000001b0  a2 6a 10 cc 49 e5 8e 87  d3 89 54 f0 e7 a1 d5 01  |.j..I.....T.....|
+000001c0  35 62 d3 18 3e a7 60 9e  60 7e f0 10 db 80 13 72  |5b..>.`.`~.....r|
+000001d0  a4 bc 66 a7 bd 46 83 88  6e 9f b3 db de e7 b3 04  |..f..F..n.......|
+000001e0  62 4c 61 d6 d0 89 84 e4  30 d7 4d a0 61 4f 56 ad  |bLa.....0.M.aOV.|
+000001f0  51 c6 1f 10 01 9e 8d 75  55 fb 89 b8 d0 57 e3 ce  |Q......uU....W..|
+00000200  40 72 41 27 96 e0 5b f4  cc ba d0 ec 8c d4 91 ca  |@rA'..[.........|
+00000210  8f f0 db 11 86 d5 8e 02  6a 1f 29 00 f6 ff 42 a2  |........j.)...B.|
+00000220  7c c9 e7 18 38 39 c9 e4  2b 0e e9 36 40 d3 dd bc  ||...89..+..6@...|
+00000230  f7 e3 7c 2d e9 f0 52 31  16 85 b4 e2 a8 54 cd d0  |..|-..R1.....T..|
+00000240  d6 e2 ed f4 fc 91 9f 50  68 a0 74 af 37 c7 4c bd  |.......Ph.t.7.L.|
+00000250  de 9e c7 78 06 41 6b 62  07 8c 8b f4 f5 ea ab 16  |...x.Akb........|
+00000260  b0 16 b9 ea 06 2c ee 66  d5 da b3 2c 0f 03 d2 f6  |.....,.f...,....|
+00000270  ae f7 11 85 d8 b6 b8 bf  7e a5 c8 ff 0d 41 29 86  |........~....A).|
+00000280  94 e4 32 58 6c 0e 05 47  b8 c5 77 de d1 81 8d 72  |..2Xl..G..w....r|
+00000290  d4 e0 64 66 f7 17 8a 96  88 bf 1c 04 22 40 e0 cf  |..df........"@..|
+000002a0  28 6d f5 4f 89 e2 4a 23  4b 71 e1 15 3b da 45 0b  |(m.O..J#Kq..;.E.|
+000002b0  13 ee 1f 7f 4e 45 3d 8e  d2 f3 bd 23 e7 4c f3 d2  |....NE=....#.L..|
+000002c0  0f 4b 6e 6a 3d 6a f1 26  b7 ae f6 1d 39 73 cd fd  |.Knj=j.&....9s..|
+000002d0  1c c8 c7 45 fa e0 67 d5  2c eb e9 2b 32 8e 65 7b  |...E..g.,..+2.e{|
+000002e0  c5 32 cc e6 01 91 fc fd  92 6e ab 9a 13 f6 63 81  |.2.......n....c.|
+000002f0  e5 b9 25 6d ce 73 39 9e  82 ae 18 89 a5 32 cb d3  |..%m.s9......2..|
+00000300  a3 85 55 f5 cd 26 96 18  91 1c 41 36 69 49 93 f2  |..U..&....A6iI..|
+00000310  aa 05 ab 17 03 03 00 99  9c 1d 79 c5 7b 73 b9 f9  |..........y.{s..|
+00000320  00 2d ea ff c2 8d f6 57  65 7c 92 fa ba 22 18 03  |.-.....We|..."..|
+00000330  69 69 e9 05 e0 74 1a e5  9d f9 30 9f 1c 39 86 30  |ii...t....0..9.0|
+00000340  aa 1b 86 fa 20 26 20 13  ea 8d eb 8b 4e 8b c1 50  |.... & .....N..P|
+00000350  86 ef a3 c5 8e 48 b2 a1  5a ac 05 e7 8f 23 8a 34  |.....H..Z....#.4|
+00000360  ab 1f 8e 90 b1 e5 9a d3  d7 28 90 b6 12 35 dc cb  |.........(...5..|
+00000370  c5 3c 8d 3d fc e2 99 2a  8b f0 6a f4 8b a9 62 3f  |.<.=...*..j...b?|
+00000380  b6 19 29 fd 79 b9 35 72  b0 89 59 ab 78 c6 c9 f0  |..).y.5r..Y.x...|
+00000390  68 bc 0d f5 9a 45 dd 4f  d2 40 75 19 47 af e9 6f  |h....E.O.@u.G..o|
+000003a0  56 ec 73 ce cd 19 31 c0  39 08 b1 63 e0 ac d4 49  |V.s...1.9..c...I|
+000003b0  e5 17 03 03 00 35 0d 34  de e9 22 e4 56 18 4a 33  |.....5.4..".V.J3|
+000003c0  d1 05 c4 d4 f2 64 24 62  d7 da 6a 8e 34 3b 51 13  |.....d$b..j.4;Q.|
+000003d0  27 69 88 37 4b ba 29 9d  c5 78 af 62 2b 62 6e 5a  |'i.7K.)..x.b+bnZ|
+000003e0  28 7a 93 c5 9a f3 84 1d  50 9a 94                 |(z......P..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 6a 64 a5 70 df  |..........5jd.p.|
-00000010  c8 89 29 86 27 8e 2f 03  f0 a3 26 0b f4 d2 99 73  |..).'./...&....s|
-00000020  0d 52 8b 49 ac 3a 61 0c  30 0f 89 8b 29 91 8c 30  |.R.I.:a.0...)..0|
-00000030  1d 82 4d c2 92 9f 47 33  9a 59 b9 a0 da 8b a9 0e  |..M...G3.Y......|
-00000040  17 03 03 00 17 e2 b8 0e  b0 8d eb a1 b2 1f 07 70  |...............p|
-00000050  fc 0e 0f 06 c7 fa b3 cc  9e 95 d8 bc 17 03 03 00  |................|
-00000060  13 04 92 08 57 71 45 d0  65 d9 c9 27 05 49 e1 7e  |....WqE.e..'.I.~|
-00000070  12 c9 77 07                                       |..w.|
+00000000  14 03 03 00 01 01 17 03  03 00 35 4f 9c 2d 01 8b  |..........5O.-..|
+00000010  4a 31 16 77 b4 f2 2b 40  cb 8e d5 7d 93 bd 66 59  |J1.w..+@...}..fY|
+00000020  f8 f1 f4 45 69 fd f7 9b  88 5a e5 0a 40 67 e2 17  |...Ei....Z..@g..|
+00000030  72 de b0 1d 02 ba b5 a7  58 35 4a 3e b6 2a 0c e8  |r.......X5J>.*..|
+00000040  17 03 03 00 17 4a 50 b7  f1 94 a4 64 9e a2 95 0a  |.....JP....d....|
+00000050  6c f6 93 7f d6 6d 12 10  7a 69 8a d2 17 03 03 00  |l....m..zi......|
+00000060  13 10 60 24 3f 6e c9 ee  c6 27 50 72 5e 19 22 e0  |..`$?n...'Pr^.".|
+00000070  76 12 45 e5                                       |v.E.|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-ECDSA-RSA b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-ECDSA-RSA
index 9aa65c6754..6611cdfed2 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-ECDSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-ECDSA-RSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,136 +7,135 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 71 fd 9f ba 42  |....z...v..q...B|
-00000010  4c 98 22 8e 16 d3 63 6c  a6 34 c2 41 37 f9 98 ad  |L."...cl.4.A7...|
-00000020  7a a6 c5 61 12 df 37 32  a2 95 a3 20 00 00 00 00  |z..a..72... ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 ea 4e 78 a5 f4  |....z...v...Nx..|
+00000010  71 78 37 5b 2c e4 69 b2  00 4d 49 8c 8b 86 4c 80  |qx7[,.i..MI...L.|
+00000020  f9 db 03 3f cc 1e 42 f9  87 ff 7b 20 00 00 00 00  |...?..B...{ ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 50  |..+.....3.$... P|
-00000060  f1 4d 28 5f 81 28 a7 d7  cb 82 20 48 91 0b 86 94  |.M(_.(.... H....|
-00000070  ae d8 b0 1c d0 84 55 5a  93 4c ee 65 9d 19 68 14  |......UZ.L.e..h.|
-00000080  03 03 00 01 01 17 03 03  00 17 7d af 66 34 6e f8  |..........}.f4n.|
-00000090  38 18 0a 6a 24 91 d8 6c  4d 7f e6 4c fc 40 8a a7  |8..j$..lM..L.@..|
-000000a0  bc 17 03 03 00 42 77 e7  1c fd d3 a9 f5 86 8e 92  |.....Bw.........|
-000000b0  f0 28 92 e5 e7 aa 8c 13  00 cb 07 0c b4 3d 13 7c  |.(...........=.||
-000000c0  2d 58 a0 94 0c 8f 4b 45  8d aa 97 7a 30 0e 78 d7  |-X....KE...z0.x.|
-000000d0  22 89 e0 8b 53 31 1b 9b  2d 7f f7 ff e0 b3 13 d5  |"...S1..-.......|
-000000e0  49 12 9e 50 31 38 eb d5  17 03 03 02 6d 65 2e 6f  |I..P18......me.o|
-000000f0  91 62 81 e9 8c fc 11 34  c1 59 58 44 3d 4f 74 6d  |.b.....4.YXD=Otm|
-00000100  ae 5a 47 29 56 6d 43 08  43 aa 69 d8 20 6c 02 99  |.ZG)VmC.C.i. l..|
-00000110  68 eb fa 47 c6 b0 7d 5b  70 2a a1 f9 f6 4f 70 02  |h..G..}[p*...Op.|
-00000120  88 f5 d1 b6 74 6e e2 54  7f fe 04 ce b2 03 9e e4  |....tn.T........|
-00000130  6e 3e 5d cf 27 49 de 90  7f 0a 2e 51 87 97 38 0e  |n>].'I.....Q..8.|
-00000140  cc f9 31 56 c5 bd b2 17  4c a4 a3 95 d7 c4 47 43  |..1V....L.....GC|
-00000150  58 cb 60 4f 73 65 71 e3  83 3d 60 04 d4 4d 6b a4  |X.`Oseq..=`..Mk.|
-00000160  96 c1 51 ec c5 48 29 13  ae 6d 7c 4c 0c 47 40 26  |..Q..H)..m|L.G@&|
-00000170  50 13 71 a9 55 3e bc 7b  ce a6 a5 8a 23 3e 41 d5  |P.q.U>.{....#>A.|
-00000180  2c 22 3e 3e 65 3e 53 0b  13 fb b9 36 25 77 bd 89  |,">>e>S....6%w..|
-00000190  f1 4e c2 99 5c 0a 14 c4  f8 9b da 01 a9 61 f5 a9  |.N..\........a..|
-000001a0  f5 a7 04 17 cc e5 a9 8b  b7 e8 ce 13 6c 87 75 99  |............l.u.|
-000001b0  cb 05 a5 2d c6 8d 03 73  b0 1c ba e3 64 66 d7 a9  |...-...s....df..|
-000001c0  b9 3c 16 41 ce ca 7a 9d  67 84 81 78 57 22 24 6e  |.<.A..z.g..xW"$n|
-000001d0  80 55 10 87 e4 6a b7 3e  62 23 84 ea a6 9b ee 1d  |.U...j.>b#......|
-000001e0  d0 32 96 74 7a b0 ed 05  a9 ca 53 8c 8c 66 bf ee  |.2.tz.....S..f..|
-000001f0  2d b4 5f 78 4a 7e 88 6a  bf e4 44 fc fb 71 df 9c  |-._xJ~.j..D..q..|
-00000200  34 a6 f0 4c 5b b9 0f a2  72 b4 28 0a 67 a2 99 be  |4..L[...r.(.g...|
-00000210  97 da 1d 64 24 c3 99 e6  cb 43 9a eb 28 6e 54 e9  |...d$....C..(nT.|
-00000220  34 5a 3c a1 1c 2f 07 27  a1 bf 1b fb a5 2f 61 8d  |4Z<../.'...../a.|
-00000230  26 ab f4 9f 7e ec 22 dc  4f 34 3d c9 6f 5d 6a 18  |&...~.".O4=.o]j.|
-00000240  30 09 bc f0 06 6d 3e bc  f7 96 9f 90 4b d8 e3 ac  |0....m>.....K...|
-00000250  96 3c f4 e2 3e 26 4a 43  07 1f 7e 79 08 f8 12 14  |.<..>&JC..~y....|
-00000260  82 1d 27 a5 16 d6 88 c2  31 26 8d 60 40 04 30 7b  |..'.....1&.`@.0{|
-00000270  49 7b 6d 11 d4 80 c5 09  9f 6a 85 f4 d3 41 ce c4  |I{m......j...A..|
-00000280  f6 bc 49 38 05 19 86 55  fa 9a 73 d7 5d 61 97 42  |..I8...U..s.]a.B|
-00000290  39 f2 6e 26 c7 11 ca b8  bf 85 2d 25 c2 83 30 6d  |9.n&......-%..0m|
-000002a0  17 07 af da 39 e9 c5 e4  88 f6 5f 58 e7 00 72 38  |....9....._X..r8|
-000002b0  e1 ac f4 75 eb 7f e2 00  d7 d9 e8 aa 77 8b 63 5e  |...u........w.c^|
-000002c0  85 4c c5 2a dd 8d 89 f4  ea ff 14 9d bb d7 b1 9a  |.L.*............|
-000002d0  7b d0 38 e9 9d 26 a9 79  f4 de 10 63 1f 09 67 bc  |{.8..&.y...c..g.|
-000002e0  51 ca 12 51 05 93 29 fe  5f 17 79 7f 84 e2 87 39  |Q..Q..)._.y....9|
-000002f0  d4 80 ac 76 fe c4 ab bb  63 06 64 b0 ba 5f 2f 8b  |...v....c.d.._/.|
-00000300  d9 b5 39 b5 80 69 0d 97  c6 f4 ce e1 2c cf 29 1c  |..9..i......,.).|
-00000310  e7 f4 b7 02 f5 da b4 63  26 d9 a9 4a 4e 34 66 56  |.......c&..JN4fV|
-00000320  c2 89 6a 12 95 16 9c 8b  b3 95 fb 8d 1f 4b 67 53  |..j..........KgS|
-00000330  5e 1f 68 70 ed 9b aa 89  78 16 88 d2 39 31 d9 59  |^.hp....x...91.Y|
-00000340  b5 bd 01 64 59 61 11 22  ab 73 f8 00 c3 7a 8c 45  |...dYa.".s...z.E|
-00000350  54 32 4f 5c 24 6a 0b 87  6c dc 17 03 03 00 99 4b  |T2O\$j..l......K|
-00000360  2d c9 21 11 87 71 41 cf  67 23 4e cd c8 7f e4 73  |-.!..qA.g#N....s|
-00000370  97 46 dd ff 0e 13 b4 4a  0e 81 4d fe 6c 0a 1d a0  |.F.....J..M.l...|
-00000380  b4 57 e5 4d e0 8d 82 e5  33 71 26 4a ef 72 8d 1f  |.W.M....3q&J.r..|
-00000390  a2 7b 43 e7 6c 99 19 24  18 7f 53 4a 16 c1 51 0c  |.{C.l..$..SJ..Q.|
-000003a0  3c 7d 3d c6 64 14 74 65  51 0b 04 09 dc c5 c0 ef  |<}=.d.teQ.......|
-000003b0  a1 a9 b3 d3 1d 16 2d 9a  5d 40 ec 13 9a 16 7c 9b  |......-.]@....|.|
-000003c0  6c 18 ba ec e3 e6 25 99  c3 1a 16 44 05 a3 85 ac  |l.....%....D....|
-000003d0  6a 49 e0 30 af 1c d1 5d  f5 6e e6 4b dc f3 71 49  |jI.0...].n.K..qI|
-000003e0  b0 5e 1d 7a e2 8b ba 13  7d a2 4a 12 cb 69 5a fe  |.^.z....}.J..iZ.|
-000003f0  7d cf e5 cf 0a d0 6e 26  17 03 03 00 35 cd 5a 61  |}.....n&....5.Za|
-00000400  28 1f 69 d8 c0 48 8a 10  4e 46 3a 51 06 87 28 8d  |(.i..H..NF:Q..(.|
-00000410  9d 68 60 bc e1 6e a4 a2  21 81 2a 17 57 b9 6a 7a  |.h`..n..!.*.W.jz|
-00000420  47 ae fb e0 a8 fc 7a 72  0f 9f 52 46 18 a8 b1 01  |G.....zr..RF....|
-00000430  0d 9b                                             |..|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 f1  |..+.....3.$... .|
+00000060  bf 65 1e fd e0 5d 1b ca  02 b5 9e 3f a8 82 e0 5a  |.e...].....?...Z|
+00000070  97 eb af b5 f1 f7 77 3f  46 a8 66 93 de a8 39 14  |......w?F.f...9.|
+00000080  03 03 00 01 01 17 03 03  00 17 16 a7 f6 48 b9 11  |.............H..|
+00000090  59 75 3d d8 cf eb ba 72  6c f7 0d 26 50 ab 2d 2a  |Yu=....rl..&P.-*|
+000000a0  61 17 03 03 00 42 00 0f  78 f4 5a 62 c5 56 bd f5  |a....B..x.Zb.V..|
+000000b0  4a df d3 78 76 bd 90 71  49 69 8a b3 60 5b 24 8b  |J..xv..qIi..`[$.|
+000000c0  45 fb c7 e0 ff 04 d8 7b  c6 1f 93 c9 f9 b8 0d 38  |E......{.......8|
+000000d0  53 d1 2e 95 99 32 52 2e  45 b2 11 08 45 c7 bc 64  |S....2R.E...E..d|
+000000e0  6a c2 32 db 70 96 77 6f  17 03 03 02 6d ba 3e 97  |j.2.p.wo....m.>.|
+000000f0  ea d7 dd c1 c5 39 9a c4  b1 eb 8b df 35 57 43 35  |.....9......5WC5|
+00000100  31 7a 4c 71 ab 57 79 80  f9 48 96 67 5f 3b fe 98  |1zLq.Wy..H.g_;..|
+00000110  0b 5d d0 ce 8c 0c 5a 03  28 8f 64 b4 3e 74 75 51  |.]....Z.(.d.>tuQ|
+00000120  81 b3 09 a7 8e 33 45 92  49 72 91 b7 2c 45 68 5c  |.....3E.Ir..,Eh\|
+00000130  ee 27 e8 5b fd b0 80 e3  43 35 2f a2 bd e5 cf d6  |.'.[....C5/.....|
+00000140  c3 fc 43 03 1e aa c9 c4  67 db ef 0c c3 aa 46 18  |..C.....g.....F.|
+00000150  39 69 31 26 7f 0a 7a b2  e7 c4 cb 09 3a f1 8e a0  |9i1&..z.....:...|
+00000160  05 70 87 a9 12 c6 f2 a1  25 87 72 0a 2d fb d5 51  |.p......%.r.-..Q|
+00000170  ce 93 8e f8 08 0e 86 90  04 00 9b 76 fd 57 23 cb  |...........v.W#.|
+00000180  bc 78 23 07 8a 35 92 6e  d6 cd f5 b5 2e e1 8f 33  |.x#..5.n.......3|
+00000190  7a bb 61 54 65 4f 4d 12  4b ca db 19 4b 30 6e 2c  |z.aTeOM.K...K0n,|
+000001a0  56 62 b5 32 7a 98 b6 a4  10 98 5a 16 6b 26 8e 7c  |Vb.2z.....Z.k&.||
+000001b0  e0 88 77 a6 20 60 c9 fb  c5 e2 66 c3 6d 0d df dd  |..w. `....f.m...|
+000001c0  21 22 10 da 88 24 21 92  74 3b d8 92 c0 ec 2f 57  |!"...$!.t;..../W|
+000001d0  79 d7 42 bd d7 b0 e0 23  d2 a0 45 7f 2a 2a ff df  |y.B....#..E.**..|
+000001e0  a4 61 53 ec 44 e2 3a 7a  06 15 8a ce 02 84 e7 78  |.aS.D.:z.......x|
+000001f0  9b ef 15 0e 84 16 fe 0f  dd 36 de 0f 69 14 e4 35  |.........6..i..5|
+00000200  90 e4 a0 15 a6 97 e5 c9  a1 3c ed 79 c6 03 ae 39  |.........<.y...9|
+00000210  f2 36 1e ca 20 4f 20 59  e6 6f c7 15 ba 90 ac 4a  |.6.. O Y.o.....J|
+00000220  11 ad 3e f5 48 df 94 fe  f8 48 2f 12 25 01 6c 9a  |..>.H....H/.%.l.|
+00000230  e6 ee 41 7b 13 4c 2f cc  3a 2d 8d b8 e7 d5 62 88  |..A{.L/.:-....b.|
+00000240  88 5d d4 6e c4 64 c5 32  0a e7 86 08 64 2c 0a 11  |.].n.d.2....d,..|
+00000250  8e 51 63 f9 81 30 00 b1  29 fa b8 1c ab 87 88 22  |.Qc..0..)......"|
+00000260  f0 ef 79 04 8c 85 78 df  72 6c 99 d6 c7 3a 9f 2a  |..y...x.rl...:.*|
+00000270  6d c6 24 05 e7 e5 d7 d0  c7 e5 7c 87 50 f9 b7 69  |m.$.......|.P..i|
+00000280  6d 1f 39 77 5d 4c f2 98  35 f7 07 b6 30 0d d6 25  |m.9w]L..5...0..%|
+00000290  40 cb a4 2d b2 f1 22 ca  26 5d 92 22 97 0a 65 a9  |@..-..".&]."..e.|
+000002a0  a0 46 58 be 0d af a1 1c  da c8 bf 98 28 72 ea ee  |.FX.........(r..|
+000002b0  46 f9 c0 0d b3 f1 11 12  5f b7 69 75 ea dd 60 d0  |F......._.iu..`.|
+000002c0  53 51 01 ec 7c ff ef 41  68 04 ec a4 6b 51 bb 89  |SQ..|..Ah...kQ..|
+000002d0  8b 8d a2 89 05 6f 78 81  16 f8 7a c2 f6 c3 0d ef  |.....ox...z.....|
+000002e0  b3 12 e2 57 54 95 a6 cd  5d 04 32 88 70 f9 db db  |...WT...].2.p...|
+000002f0  b3 45 75 32 6f ac 9a fa  ad 54 e5 a5 82 ae 3e 73  |.Eu2o....T....>s|
+00000300  2d 07 f4 48 83 e2 10 7d  cb 2f 4c 18 94 75 37 24  |-..H...}./L..u7$|
+00000310  cd 13 dc 3a 56 93 e8 80  a3 ba de b1 0d 14 79 48  |...:V.........yH|
+00000320  08 69 a6 f3 2e 9f 7a 78  6e 9c de 16 ba 73 0b a6  |.i....zxn....s..|
+00000330  f2 6c 04 e6 e6 89 3d 46  7d db a4 8f 9a e7 5d 0e  |.l....=F}.....].|
+00000340  b9 6b 05 59 4d 4d e9 48  1a 18 e9 59 7b 56 70 d6  |.k.YMM.H...Y{Vp.|
+00000350  0f fc c2 93 31 03 fa ad  b4 c9 17 03 03 00 99 62  |....1..........b|
+00000360  c5 b8 11 10 72 af 5b 36  7b 4b 86 83 05 1f 5a c5  |....r.[6{K....Z.|
+00000370  66 7b b6 ac 30 8d c0 03  64 ec 29 5d 60 e9 e9 9d  |f{..0...d.)]`...|
+00000380  6d 58 3e 55 7e 19 a3 59  f5 8b ca 1a f0 c8 ca 1b  |mX>U~..Y........|
+00000390  c6 ed 7f d7 70 fb 4b a5  6a 96 66 ce 4c 96 d1 b4  |....p.K.j.f.L...|
+000003a0  de 99 e2 31 4a 88 64 51  7b 73 60 bb 5c 46 9b b7  |...1J.dQ{s`.\F..|
+000003b0  9f d8 97 de 03 06 f3 3e  34 8b 75 43 ce cd 9a 12  |.......>4.uC....|
+000003c0  1e 27 b5 28 5e 8f b6 04  d2 02 19 02 02 72 85 46  |.'.(^........r.F|
+000003d0  1c cb 5e 63 09 e6 ba 81  69 29 97 5f 31 1e 8f f5  |..^c....i)._1...|
+000003e0  1a ed 3b 1e 97 83 bf ee  1f 09 f4 f7 be 32 c7 bc  |..;..........2..|
+000003f0  b6 7e 70 b9 32 4b 07 99  17 03 03 00 35 67 1c 72  |.~p.2K......5g.r|
+00000400  de 27 25 26 1b 12 b2 9a  a3 38 5c a7 f7 13 a4 1e  |.'%&.....8\.....|
+00000410  bf f9 7f 1d 57 af ff 2f  89 4b 75 fc 23 c5 47 00  |....W../.Ku.#.G.|
+00000420  cd b7 b6 89 af 4e f0 17  e9 e6 31 cd fb b0 31 19  |.....N....1...1.|
+00000430  73 61                                             |sa|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 02 1e ab 60 cd 30 a1  |............`.0.|
-00000010  d1 e0 a1 d4 77 15 50 bf  aa c7 bf 1a c0 e1 cd dd  |....w.P.........|
-00000020  6a 64 0b 5e f0 83 24 77  1d 7a ff 97 5b ab 5b 15  |jd.^..$w.z..[.[.|
-00000030  eb 9e af 09 c9 38 e1 8a  7d c1 c9 04 40 b9 ca 6e  |.....8..}...@..n|
-00000040  01 8d cb 1e 66 52 a4 c2  20 44 68 bf d0 0d ec c0  |....fR.. Dh.....|
-00000050  0b d2 9e ae 60 e4 5e 19  cf 92 96 22 88 b1 35 e3  |....`.^...."..5.|
-00000060  c9 89 c8 67 6d 14 83 e1  ad 76 ca e6 9a d0 34 e0  |...gm....v....4.|
-00000070  de 9d 46 44 85 97 b0 cc  4e ef 72 d9 85 47 13 fb  |..FD....N.r..G..|
-00000080  86 9f 3c 26 20 fa fd 15  f7 83 1f c2 1f 51 3f 4a  |..<& ........Q?J|
-00000090  b4 3c 3b 09 2b 16 22 d1  30 f2 16 ae b9 28 f7 8e  |.<;.+.".0....(..|
-000000a0  a2 84 15 c8 42 58 a5 6d  8a 86 a9 7f 23 18 ed ee  |....BX.m....#...|
-000000b0  18 d7 2d 47 4f b8 f2 44  60 cb 2f 1d 1a ad 7b e7  |..-GO..D`./...{.|
-000000c0  15 d3 d8 55 9e fb 0b 0e  b8 e3 1f 4e a4 8c 14 ec  |...U.......N....|
-000000d0  4b 3a c4 d1 66 16 9d 7a  72 20 8a fb 41 33 bc 04  |K:..f..zr ..A3..|
-000000e0  4e b7 e4 65 2e 21 d2 3b  5f 07 00 cd 38 b3 9d 78  |N..e.!.;_...8..x|
-000000f0  eb 36 00 db d1 e0 8a 3f  50 84 3f d9 4b 2d 85 41  |.6.....?P.?.K-.A|
-00000100  bc cc ec 9b 15 2c f9 95  02 18 41 08 13 f3 d5 ec  |.....,....A.....|
-00000110  e7 32 8c ca 7e 0a e6 81  ed db 8a 49 46 ac a9 42  |.2..~......IF..B|
-00000120  27 13 85 f1 16 9b 15 bd  ec eb 1c 25 24 9a 7f 0e  |'..........%$...|
-00000130  a4 67 e1 32 3f cf 8b 61  49 9b 43 a4 57 79 48 14  |.g.2?..aI.C.WyH.|
-00000140  90 00 b1 2d 6f 82 9f ef  f3 a0 c6 e8 9f fd d4 08  |...-o...........|
-00000150  1f 16 5e 7f be 73 7e a6  5b d2 02 12 c9 76 c3 f3  |..^..s~.[....v..|
-00000160  13 4c 44 7f e9 8e 5b ce  d8 56 d6 2f 76 ff 5a 8e  |.LD...[..V./v.Z.|
-00000170  6d cb 5b 8e c6 62 29 4e  c6 34 a9 74 44 84 b7 28  |m.[..b)N.4.tD..(|
-00000180  96 cd fa 6d 2e ac 75 3e  86 73 c3 a9 50 ef e9 e4  |...m..u>.s..P...|
-00000190  70 a5 ba bc 1f 9c c3 05  17 30 2c 1b ba c0 15 bf  |p........0,.....|
-000001a0  f4 47 45 b1 42 d9 6c 6d  57 b0 7a 94 61 ee 78 0e  |.GE.B.lmW.z.a.x.|
-000001b0  32 4f 01 da df d8 29 51  91 1c 3f f6 40 a7 15 76  |2O....)Q..?.@..v|
-000001c0  99 d7 e0 45 af 04 5a 69  f0 65 bf 40 e9 5c 4b e5  |...E..Zi.e.@.\K.|
-000001d0  eb e6 2e 79 f7 c8 4a e4  0b 71 e3 d5 dd 7e 25 d4  |...y..J..q...~%.|
-000001e0  d9 7f 1b 9b 8b 3f b6 9c  35 59 2e 40 34 e3 c8 2a  |.....?..5Y.@4..*|
-000001f0  3c 74 0b d6 35 d3 12 e8  93 7e 44 61 b4 3d da 19  |<t..5....~Da.=..|
-00000200  60 34 e0 19 97 9f 75 a9  be ff 0e ca 14 32 7e 20  |`4....u......2~ |
-00000210  48 fa e3 43 1b 94 86 6c  e4 c2 7d 91 1c 21 42 88  |H..C...l..}..!B.|
-00000220  16 0b 26 f6 16 dc 09 d4  8e 17 03 03 00 a4 b9 22  |..&............"|
-00000230  dc d6 d7 9f a8 83 b2 a6  bd 8a 5a da 0a 75 d6 10  |..........Z..u..|
-00000240  e5 0e ff a5 ec f2 31 8a  4e ff e6 21 3a a0 65 32  |......1.N..!:.e2|
-00000250  73 e5 e2 c3 f8 24 a4 b2  34 b9 d4 e2 04 ea ff e5  |s....$..4.......|
-00000260  2e dc 75 03 9f e6 55 6b  95 06 1b f9 fb 32 ea b2  |..u...Uk.....2..|
-00000270  d6 f9 05 9c df 1f 18 cb  27 ca 40 d8 03 e5 70 fc  |........'.@...p.|
-00000280  78 9b 84 a5 28 6a 14 2e  f3 1a f1 92 8d d8 93 54  |x...(j.........T|
-00000290  68 c7 12 37 84 e5 b5 73  23 90 6f 4c d3 35 bb ba  |h..7...s#.oL.5..|
-000002a0  bd 7d 11 8e 93 25 85 f8  46 56 39 d0 23 b9 06 68  |.}...%..FV9.#..h|
-000002b0  25 86 09 28 3c 24 25 2b  fd 27 17 83 eb 5c 53 42  |%..(<$%+.'...\SB|
-000002c0  a2 0d f8 a5 5e c9 4f 53  83 e3 90 d8 0c 49 03 cf  |....^.OS.....I..|
-000002d0  b1 03 17 03 03 00 35 dc  ac dc ee c6 92 3d 1b 5d  |......5......=.]|
-000002e0  e9 c2 5c e0 0d 1b 28 9b  cb 79 7f 58 8a 02 cd 85  |..\...(..y.X....|
-000002f0  34 c0 a3 72 71 b5 26 c5  56 c5 38 09 ee 0e 9a e4  |4..rq.&.V.8.....|
-00000300  f4 29 ad 76 e2 61 27 61  ea e0 a7 1d 17 03 03 00  |.).v.a'a........|
-00000310  17 7b 6b 82 47 b6 bb 41  d0 5b b4 23 38 bf 15 58  |.{k.G..A.[.#8..X|
-00000320  27 1e fa 7a 58 09 02 e8  17 03 03 00 13 cf d5 c3  |'..zX...........|
-00000330  22 18 f9 28 3e c9 64 d0  51 8d dc 4b a2 f1 bf 9f  |"..(>.d.Q..K....|
+00000000  14 03 03 00 01 01 17 03  03 02 1e e9 c3 0a e9 35  |...............5|
+00000010  c0 d7 d8 1e 01 13 31 2c  39 0c 31 57 df f2 8d 7f  |......1,9.1W....|
+00000020  ca 2e 8c a0 63 60 e2 61  c6 37 8f cf 66 62 e7 d6  |....c`.a.7..fb..|
+00000030  3d 89 6b 3b bd 1c 45 ec  62 a5 1c b3 86 16 bc 03  |=.k;..E.b.......|
+00000040  57 9e 2b cd 31 d4 4d ad  57 96 12 12 19 ce 61 14  |W.+.1.M.W.....a.|
+00000050  d6 1f 7a d1 c8 9b d4 9e  18 cf 1c f7 d0 ca 84 bb  |..z.............|
+00000060  8e 93 85 97 4b 53 68 3d  f6 45 76 e0 a7 42 df 6a  |....KSh=.Ev..B.j|
+00000070  96 04 b9 9e 03 97 bb 57  bf 7f 9c 27 68 ba 04 49  |.......W...'h..I|
+00000080  a7 c9 a3 f3 77 83 1f 15  0e 02 05 b5 8c e4 a6 ed  |....w...........|
+00000090  f8 65 5b bb a4 65 08 a1  a3 34 2a 71 66 6c 2e c8  |.e[..e...4*qfl..|
+000000a0  e2 5b 08 ca 59 91 da 07  14 61 17 b7 19 28 00 33  |.[..Y....a...(.3|
+000000b0  d9 0c 45 df d8 74 83 2e  9b 99 c7 35 cd f4 de 53  |..E..t.....5...S|
+000000c0  b0 df 5c 8b 15 b0 e0 81  77 a5 5d d5 33 40 51 60  |..\.....w.].3@Q`|
+000000d0  09 36 4f b6 6f ce 95 2b  d1 38 88 33 e0 13 a0 c1  |.6O.o..+.8.3....|
+000000e0  5f 2c 15 77 56 d1 16 09  9a 78 5c 6f 8c 93 c3 44  |_,.wV....x\o...D|
+000000f0  54 04 b4 d3 23 31 ff 61  74 e5 09 3a d3 9b f1 2f  |T...#1.at..:.../|
+00000100  de f4 a9 0b b8 9d ca 17  2c 3f d5 2b dd c0 9e 07  |........,?.+....|
+00000110  48 50 6a 51 72 be 92 10  1a 91 b5 2d 39 76 10 a4  |HPjQr......-9v..|
+00000120  42 63 31 df ce 31 9a 5c  0d ee 6e 55 c0 ba 44 9f  |Bc1..1.\..nU..D.|
+00000130  e4 75 77 0f 88 6d 1d 24  9f 1c a0 12 14 4c ce 68  |.uw..m.$.....L.h|
+00000140  24 a5 aa f2 f2 c5 f4 4f  a9 c7 e0 dd 5c 6b 4c 53  |$......O....\kLS|
+00000150  b5 26 8b e2 a4 af e3 13  77 0a fc dd 2b 56 fa a2  |.&......w...+V..|
+00000160  46 7f 9a 11 c6 a0 4c b6  36 29 93 9f 83 99 13 ad  |F.....L.6)......|
+00000170  a0 62 9a ef 42 d0 dd 49  fe ba e4 fd fd 09 4b d4  |.b..B..I......K.|
+00000180  31 6e d9 a5 0e 4d ac 8c  90 7c 26 2b 6b 1a cb 55  |1n...M...|&+k..U|
+00000190  47 53 47 e2 d4 a1 d8 2e  5d 9b 36 75 f0 a4 8a 39  |GSG.....].6u...9|
+000001a0  88 07 c8 ed 75 40 fd 72  0e 57 02 a6 bf 8a 64 0a  |....u@.r.W....d.|
+000001b0  98 8a 1c f4 d3 3d c4 af  7d 97 6e b7 e0 f6 d8 10  |.....=..}.n.....|
+000001c0  17 0b d1 5c f9 41 c9 5e  5c 8a 38 dd 66 b3 e9 74  |...\.A.^\.8.f..t|
+000001d0  41 2a bd 2d f8 6a 27 57  da ef d6 ca 70 49 c6 e2  |A*.-.j'W....pI..|
+000001e0  94 ef 1e c6 57 a0 c8 fc  d1 05 4f 65 c1 71 e4 ab  |....W.....Oe.q..|
+000001f0  44 49 f3 e3 6d b1 f4 5a  69 e7 70 30 b5 81 19 3a  |DI..m..Zi.p0...:|
+00000200  06 33 ef a5 bd 81 8c 3c  7b 2f 9f 41 a5 7d a8 5f  |.3.....<{/.A.}._|
+00000210  3b 3d 95 6e 04 a8 5f 2a  c1 de 6e e4 14 17 91 36  |;=.n.._*..n....6|
+00000220  9d 57 9c 34 1a 7d c8 c3  42 17 03 03 00 a3 a0 20  |.W.4.}..B...... |
+00000230  06 7e 90 c8 0a b2 db 90  28 38 8f 42 12 89 1d 21  |.~......(8.B...!|
+00000240  04 b3 a6 7b 8c 63 60 49  33 4a 70 4b 1a 97 90 51  |...{.c`I3JpK...Q|
+00000250  d2 13 6e 56 9a 1d 41 9c  65 19 31 43 56 96 e2 50  |..nV..A.e.1CV..P|
+00000260  77 17 67 6e df 3b e1 43  22 fe 0c 49 74 ff b0 e9  |w.gn.;.C"..It...|
+00000270  5c f2 66 4e a3 e5 ac 02  1c 69 11 ce de a1 d4 6b  |\.fN.....i.....k|
+00000280  1c 46 97 02 7e 81 d8 29  78 42 82 5e b7 e2 31 02  |.F..~..)xB.^..1.|
+00000290  fb 74 e2 a6 5e 29 f1 28  cf 8a 9c bd f8 a0 09 45  |.t..^).(.......E|
+000002a0  67 7e d7 7d 91 8d fe 43  03 92 16 b1 67 cc 7a 32  |g~.}...C....g.z2|
+000002b0  7e 3a 88 fc 77 36 b5 69  07 09 a0 1c 5c 76 a7 68  |~:..w6.i....\v.h|
+000002c0  93 1a 35 20 f6 c1 20 c7  8f de c9 da 81 25 7a 08  |..5 .. ......%z.|
+000002d0  e0 17 03 03 00 35 fa 5b  68 55 45 ee dd d6 a2 cb  |.....5.[hUE.....|
+000002e0  09 a7 21 23 43 9c c4 ff  1c d6 66 4c ce e1 bd a9  |..!#C.....fL....|
+000002f0  77 22 0b b0 d4 ad f9 23  a7 1c 0e 63 27 36 16 c6  |w".....#...c'6..|
+00000300  a2 f8 00 ef 36 22 89 a7  d6 76 da 17 03 03 00 17  |....6"...v......|
+00000310  ca d3 97 3a 7d cc a0 95  02 4a a8 d8 dd 6d 26 64  |...:}....J...m&d|
+00000320  92 be 64 86 00 d9 bf 17  03 03 00 13 18 1e 4f 7b  |..d...........O{|
+00000330  f9 1a 63 8a 50 6a ee 81  07 76 53 a9 95 ea df     |..c.Pj...vS....|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-Ed25519 b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-Ed25519
index c174bd9f6d..38382edbea 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-Ed25519
+++ b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-Ed25519
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,119 +7,118 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 94 b3 83 34 fd  |....z...v.....4.|
-00000010  0f d0 16 30 14 0e 57 a1  d3 29 cd 81 c7 a2 59 c9  |...0..W..)....Y.|
-00000020  fb 8f 54 d4 9b 69 a8 47  7d c3 63 20 00 00 00 00  |..T..i.G}.c ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 72 63 6c 83 50  |....z...v..rcl.P|
+00000010  e9 4c 88 85 70 4f e3 cb  c7 0e 0c c5 e5 44 b9 7e  |.L..pO.......D.~|
+00000020  4a 88 d3 32 d2 37 5c 16  d4 a1 e5 20 00 00 00 00  |J..2.7\.... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 38  |..+.....3.$... 8|
-00000060  5e 40 05 c2 91 46 5b e0  c6 c4 8f b6 eb 91 98 b1  |^@...F[.........|
-00000070  b0 41 8e 34 14 8f 2a b1  5e e6 80 78 f6 0c 3e 14  |.A.4..*.^..x..>.|
-00000080  03 03 00 01 01 17 03 03  00 17 30 61 18 ba 71 15  |..........0a..q.|
-00000090  e0 75 5d 55 f2 1a d1 7e  69 fa 58 41 97 cd c1 9a  |.u]U...~i.XA....|
-000000a0  92 17 03 03 00 42 af 88  92 3e 98 ef 74 a5 06 90  |.....B...>..t...|
-000000b0  fd c0 21 20 01 ec 1d 68  93 8d dc 36 dc 2c 43 77  |..! ...h...6.,Cw|
-000000c0  02 18 47 cf 66 b3 61 88  85 be f1 04 1b da c1 03  |..G.f.a.........|
-000000d0  31 68 2c 1c fc dc ed 6b  f3 a5 e8 52 fd a7 dc c8  |1h,....k...R....|
-000000e0  e1 6a 91 67 83 ce 5c 08  17 03 03 02 6d 55 55 72  |.j.g..\.....mUUr|
-000000f0  6e cc c5 4c f0 10 d7 0d  57 5d 4d f4 61 8d 5d 78  |n..L....W]M.a.]x|
-00000100  c3 cd df 49 4a 1a 4b c6  fe 70 0a 4a 1c 1d 12 25  |...IJ.K..p.J...%|
-00000110  36 1a 68 70 7d 02 e9 cc  4b 92 f9 b8 86 d0 e8 68  |6.hp}...K......h|
-00000120  56 be 25 b3 67 3d c0 92  5a 9f 57 8e 22 63 97 78  |V.%.g=..Z.W."c.x|
-00000130  1a 7e 70 76 87 f7 3a ef  45 1f 38 d3 95 12 72 98  |.~pv..:.E.8...r.|
-00000140  d0 89 e5 bd a7 eb fe b6  89 59 27 07 51 fd 2c 71  |.........Y'.Q.,q|
-00000150  8a 99 ca b2 75 bc ae b9  39 c6 15 bf 4e a7 3d 73  |....u...9...N.=s|
-00000160  f4 2c 7d 4c 88 3b b1 b6  3a 3d 49 c7 d0 91 57 6a  |.,}L.;..:=I...Wj|
-00000170  cc 25 c7 07 dc 08 0c ac  f4 9a 1d 58 17 3b 44 84  |.%.........X.;D.|
-00000180  e4 72 eb d5 11 16 09 f5  1b fb 60 23 63 46 51 10  |.r........`#cFQ.|
-00000190  4e 94 7b 5a 31 81 db 9e  bb 82 28 4a 08 32 88 fa  |N.{Z1.....(J.2..|
-000001a0  d2 e3 c4 6e 28 7d 47 66  a1 66 05 39 9e 20 52 fe  |...n(}Gf.f.9. R.|
-000001b0  3d 4d 2e b4 b8 a6 97 dd  12 8d db 9b 74 71 96 be  |=M..........tq..|
-000001c0  38 07 62 fc 81 97 3f 85  a2 b8 eb 29 0f e6 95 ca  |8.b...?....)....|
-000001d0  7b a1 f3 94 7e a4 3c 14  71 55 eb c6 c2 15 09 35  |{...~.<.qU.....5|
-000001e0  18 22 5b 9a 2c 19 f1 d3  60 f0 ff c2 09 9f 81 93  |."[.,...`.......|
-000001f0  e0 37 6e d0 73 40 c2 66  60 b7 54 85 b4 15 83 fe  |.7n.s@.f`.T.....|
-00000200  d4 de f4 a2 1f 7d 88 7d  6d 7d 30 ab 4a 25 3a a1  |.....}.}m}0.J%:.|
-00000210  2c fa 27 f4 94 35 0d 01  b0 9d fb 58 5b 03 86 9f  |,.'..5.....X[...|
-00000220  24 d8 57 dc e2 2e bf 1a  28 78 62 f5 29 e0 20 06  |$.W.....(xb.). .|
-00000230  38 47 98 b7 44 ce d3 66  92 32 4b 68 3d 45 b9 22  |8G..D..f.2Kh=E."|
-00000240  b9 94 32 1b 93 3f c1 88  a5 91 0f 06 8a 1e e6 a1  |..2..?..........|
-00000250  62 7e 1e 50 7a 2a be 18  cc 62 93 51 e0 c1 87 21  |b~.Pz*...b.Q...!|
-00000260  b3 c3 6b 1a ce f9 95 9e  6f 98 2a 25 43 10 6e 10  |..k.....o.*%C.n.|
-00000270  97 5c 09 33 e9 06 b6 6a  a8 8b fe 11 d7 b3 38 d6  |.\.3...j......8.|
-00000280  67 3f f9 50 37 f5 d2 f0  0d d8 6f 0a 8d 58 ee bc  |g?.P7.....o..X..|
-00000290  18 c2 68 17 c7 d9 05 c4  d1 e6 a9 f3 c4 63 f5 d4  |..h..........c..|
-000002a0  f2 fb 16 05 f3 fb 45 56  c7 ec 2b af fe 26 4c c0  |......EV..+..&L.|
-000002b0  85 86 de c3 f5 81 32 b2  bd a9 6c fd 33 25 8e ad  |......2...l.3%..|
-000002c0  6a 44 3e f0 67 be c8 dc  e1 40 9e 40 88 4d e7 c8  |jD>.g....@.@.M..|
-000002d0  0b 55 18 e6 2b 10 50 84  ff 93 63 f6 93 4a d2 39  |.U..+.P...c..J.9|
-000002e0  62 45 ed 31 1d b5 5a 14  53 6f 0f d1 45 e6 6f 66  |bE.1..Z.So..E.of|
-000002f0  a3 cd ff 28 b4 34 4c 54  67 8c 1b b6 a0 b4 01 6c  |...(.4LTg......l|
-00000300  41 24 ab 5c a0 22 82 8c  fa cd 1e 4d e1 8b 7a 04  |A$.\.".....M..z.|
-00000310  00 62 e3 44 19 59 c8 e2  04 45 ac e6 46 e2 6a df  |.b.D.Y...E..F.j.|
-00000320  ce e1 d2 3b 3f 22 b9 17  f2 eb 75 ea 96 cc af f6  |...;?"....u.....|
-00000330  6b 77 29 e5 5c 96 13 19  b5 e6 0a 5d 31 9d 6e 28  |kw).\......]1.n(|
-00000340  3e ec 58 cc 76 b2 93 1e  d0 e4 c3 b7 44 fd 0e 19  |>.X.v.......D...|
-00000350  91 e5 21 91 06 56 19 80  cf 25 17 03 03 00 99 22  |..!..V...%....."|
-00000360  b0 98 6e 68 69 5c 4d 7e  81 2c dc 0f 68 3e 6c 8a  |..nhi\M~.,..h>l.|
-00000370  02 4a 56 1b f2 b4 a2 04  31 64 b4 07 2c 37 47 a3  |.JV.....1d..,7G.|
-00000380  4c b6 5a 64 94 a8 c2 b6  d8 d2 6f 2e b6 4e ce 46  |L.Zd......o..N.F|
-00000390  72 ce 87 73 c4 ce 32 8e  0e e3 6a d2 62 19 56 33  |r..s..2...j.b.V3|
-000003a0  95 94 e2 8f 1b 20 db 2a  cc c7 61 f8 bc 47 18 11  |..... .*..a..G..|
-000003b0  4e d5 d1 66 7a 33 27 e7  38 2b 4b de 01 4c df f7  |N..fz3'.8+K..L..|
-000003c0  a9 c3 e9 50 0e e2 8b 94  16 30 fa 82 51 98 b4 2b  |...P.....0..Q..+|
-000003d0  b6 e6 83 a3 49 13 a5 95  1d 37 38 86 51 08 68 0a  |....I....78.Q.h.|
-000003e0  73 5e 91 e8 24 57 41 f2  15 5f 28 ca a7 f8 9a db  |s^..$WA.._(.....|
-000003f0  e9 fc ba 22 dc e7 25 5f  17 03 03 00 35 b3 81 2b  |..."..%_....5..+|
-00000400  ca e3 9c 5c db 80 ae 0b  41 f7 8c 26 af 9f 68 0a  |...\....A..&..h.|
-00000410  33 24 6a ea 22 b6 fc 57  37 0d 4e ab 48 29 03 d6  |3$j."..W7.N.H)..|
-00000420  d4 25 5f 14 b8 74 2b 80  84 9c 99 3c 18 6c 95 0d  |.%_..t+....<.l..|
-00000430  7d e0                                             |}.|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 d7  |..+.....3.$... .|
+00000060  fa 97 47 72 9a 7e 63 47  d6 62 2d dc 5d 4f 7f 9b  |..Gr.~cG.b-.]O..|
+00000070  aa 86 c9 ba 65 4c ae 91  82 40 38 ad 4b 46 73 14  |....eL...@8.KFs.|
+00000080  03 03 00 01 01 17 03 03  00 17 27 2e 49 01 db 5e  |..........'.I..^|
+00000090  e1 45 48 97 54 02 31 9f  ad 62 74 58 70 77 21 5b  |.EH.T.1..btXpw![|
+000000a0  81 17 03 03 00 42 2c 0a  8a a0 e0 40 32 b1 2f 9f  |.....B,....@2./.|
+000000b0  e6 13 9f fd 62 88 a7 34  bd 9a bc 64 5d 9d 17 b9  |....b..4...d]...|
+000000c0  b0 f6 fc 84 ca 3f 80 0b  97 4f 7a d9 67 42 c5 0a  |.....?...Oz.gB..|
+000000d0  e5 18 21 e8 08 42 b4 e6  f5 7e c3 70 2c 0e d3 d8  |..!..B...~.p,...|
+000000e0  15 36 37 57 1a d5 58 64  17 03 03 02 6d 07 11 32  |.67W..Xd....m..2|
+000000f0  d3 1e 03 02 fb 04 35 f2  64 a8 78 c2 b2 f7 7d 5c  |......5.d.x...}\|
+00000100  7c 94 0c 7b 16 9a 87 7d  2f 96 de 01 74 d6 6c 6f  ||..{...}/...t.lo|
+00000110  ce 95 eb f0 df 6d 52 89  3a 19 ff 5b b5 f2 d8 6d  |.....mR.:..[...m|
+00000120  e6 10 94 f7 d9 c4 58 e8  80 db f5 30 22 b1 82 b1  |......X....0"...|
+00000130  66 05 b5 d0 71 40 0f 68  83 ec 43 b5 51 c3 f8 ce  |f...q@.h..C.Q...|
+00000140  e9 71 4a c7 cf 57 b5 53  3f 60 99 ae 84 df 98 cc  |.qJ..W.S?`......|
+00000150  9f 90 d0 fc 1d 03 e9 80  72 7c 60 51 a1 89 93 6d  |........r|`Q...m|
+00000160  0a 57 18 c6 dc 22 82 71  be 66 87 93 dd 16 41 c8  |.W...".q.f....A.|
+00000170  84 38 33 63 fc 82 db 38  63 f8 84 f7 12 08 3b 82  |.83c...8c.....;.|
+00000180  18 cb c0 50 0d dd 19 25  16 88 23 97 35 56 6d 46  |...P...%..#.5VmF|
+00000190  3d 75 e1 83 c3 62 e4 19  70 6c 03 f0 33 5d 94 ad  |=u...b..pl..3]..|
+000001a0  6d be d2 db c4 b8 ad d8  78 78 53 76 62 91 f7 cf  |m.......xxSvb...|
+000001b0  83 5b 1e 44 11 2f 27 6a  29 d4 ea 96 fb 40 1c 94  |.[.D./'j)....@..|
+000001c0  69 c2 cc c7 90 2c 60 14  c7 d4 f2 9c f9 0e 66 1c  |i....,`.......f.|
+000001d0  08 76 6e 9f 3b 3a 47 8a  40 0a de 00 e4 6f 45 ca  |.vn.;:G.@....oE.|
+000001e0  1d 41 cc 34 5a 2c 67 78  58 34 eb 19 0c a5 0e a2  |.A.4Z,gxX4......|
+000001f0  fb c1 0a 25 74 f5 ec 55  f8 c3 97 00 d0 a5 90 c5  |...%t..U........|
+00000200  a1 9c aa 19 2b e6 ee c1  9d 73 a1 3c 1f fa 6a 91  |....+....s.<..j.|
+00000210  2b 2d 27 be 06 f3 85 54  63 a5 d9 ac 55 73 0a e4  |+-'....Tc...Us..|
+00000220  4f dc 25 a0 9f 39 c0 0e  1a 9d a7 4c bd c9 3c 64  |O.%..9.....L..<d|
+00000230  aa 28 a4 d2 aa fa 75 95  c2 48 9b 77 52 6e 5e f9  |.(....u..H.wRn^.|
+00000240  da 4d 61 29 51 6b 2a fd  16 4b fa 5d 65 40 9a 39  |.Ma)Qk*..K.]e@.9|
+00000250  f5 7d da d0 b3 17 4a ba  f0 79 ac 8d 41 73 c7 9e  |.}....J..y..As..|
+00000260  bc 0e f4 72 17 96 e5 4e  c2 a3 39 7d e4 95 04 8a  |...r...N..9}....|
+00000270  49 27 25 f4 41 24 7b a3  1c cc 36 a2 fd 16 14 5f  |I'%.A${...6...._|
+00000280  21 00 49 a5 5f 57 7e e3  f7 04 da 07 07 f6 2a 10  |!.I._W~.......*.|
+00000290  80 a5 78 ae 8b 25 5b 67  b3 a8 bc dd e6 5d 92 9e  |..x..%[g.....]..|
+000002a0  9c b6 10 01 4a 77 de 82  7b 24 0c 92 32 b3 1e 56  |....Jw..{$..2..V|
+000002b0  e6 e7 4a 5f 65 82 5d 42  e3 94 52 f3 0b 42 4d 91  |..J_e.]B..R..BM.|
+000002c0  e9 5b da 7c d9 8c f6 37  04 da 61 29 39 91 98 75  |.[.|...7..a)9..u|
+000002d0  67 cb 8d 56 41 28 7a 32  56 b8 92 67 fd 15 d4 7b  |g..VA(z2V..g...{|
+000002e0  22 92 20 5b 92 e5 95 b1  22 a4 07 6f d3 5c 2d bb  |". [...."..o.\-.|
+000002f0  e3 f2 66 ab e3 d8 a5 67  3c 67 db 1b 8e 65 8b 25  |..f....g<g...e.%|
+00000300  d7 38 ea f5 ce 8a 96 f6  c6 9d 40 1b ba c1 5c fd  |.8........@...\.|
+00000310  1f 1b a2 c2 4a 5c 78 1d  a3 11 3d a7 76 b5 4c 58  |....J\x...=.v.LX|
+00000320  7f 80 4c 5c 7c 7b 88 be  f3 35 9d f8 5a 3f fd 07  |..L\|{...5..Z?..|
+00000330  4a 8d 9e a4 ff 85 32 7e  30 6c b0 e2 f5 d9 e2 29  |J.....2~0l.....)|
+00000340  26 03 98 ac 33 10 29 b5  8c a7 43 0a 0a f3 d0 5c  |&...3.)...C....\|
+00000350  93 2c 4b f4 c8 ee ab c6  56 c7 17 03 03 00 99 5c  |.,K.....V......\|
+00000360  53 de 75 39 35 a6 90 d5  d5 f2 3f c2 a5 b7 5e 55  |S.u95.....?...^U|
+00000370  2f fa 91 7a be be d4 ae  8b 55 f8 ef bc de 03 69  |/..z.....U.....i|
+00000380  c7 eb fa 6d 51 0d 23 bf  87 45 55 2f 3f 17 8e 59  |...mQ.#..EU/?..Y|
+00000390  79 73 d5 8b c8 c0 7f cb  ae 60 13 62 85 75 24 e8  |ys.......`.b.u$.|
+000003a0  34 4a 54 36 61 13 5a 2d  9d ea c1 b4 8e a8 4a db  |4JT6a.Z-......J.|
+000003b0  4b 55 9a c0 5d 73 d4 bf  a1 88 f7 c4 af a8 56 71  |KU..]s........Vq|
+000003c0  28 a1 b6 76 f5 da 55 a8  e3 b8 1c d6 55 ea b6 00  |(..v..U.....U...|
+000003d0  7c 0e 4f b9 81 0a ff d9  1a d4 c8 99 c8 51 48 8a  ||.O..........QH.|
+000003e0  1e 99 4c f7 50 07 0a a1  21 5a 4f c7 c9 1c 69 df  |..L.P...!ZO...i.|
+000003f0  1b 2d 89 0e 63 63 1a c0  17 03 03 00 35 81 75 e8  |.-..cc......5.u.|
+00000400  f3 70 95 be 5d 58 0b e3  6a f6 a6 fb f3 b2 73 6d  |.p..]X..j.....sm|
+00000410  4e ab c9 87 44 95 c4 42  07 74 c7 c7 87 51 77 90  |N...D..B.t...Qw.|
+00000420  91 e6 12 0f 87 dd dd d8  02 33 f7 8c d0 39 b2 6f  |.........3...9.o|
+00000430  45 5a                                             |EZ|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 01 50 85 7f 0a 8b bc  |..........P.....|
-00000010  d1 2a 9f 69 55 c4 37 16  81 a5 46 23 cd af 5a 89  |.*.iU.7...F#..Z.|
-00000020  ad a6 c0 c3 5b 7a dc e5  29 c7 47 13 01 e9 64 4b  |....[z..).G...dK|
-00000030  86 83 50 72 0a bc 45 72  d1 66 47 04 ad 69 01 a7  |..Pr..Er.fG..i..|
-00000040  8c 49 4e 38 00 d7 d1 68  48 bd ff 2f a3 72 de 29  |.IN8...hH../.r.)|
-00000050  86 56 52 7b f1 2f c4 d3  93 3a c9 bc b8 e7 c2 c0  |.VR{./...:......|
-00000060  07 d8 46 81 a2 bd 36 54  79 28 91 1a 85 ab a3 64  |..F...6Ty(.....d|
-00000070  6b 33 e4 15 4c 07 c9 f0  45 49 e5 4c 9e b9 48 12  |k3..L...EI.L..H.|
-00000080  3b 31 12 51 72 89 7b 0f  79 07 6b 35 11 42 af a8  |;1.Qr.{.y.k5.B..|
-00000090  21 40 bd 9b e9 0f 98 80  70 6e e0 b1 99 58 9e 42  |!@......pn...X.B|
-000000a0  ca 0c 6f 87 2f 9b 91 10  7d fc c4 4e 57 1d 2f 79  |..o./...}..NW./y|
-000000b0  18 ba 6f 6f 61 f2 e4 c0  5e 4f fd 6c 58 06 83 6e  |..ooa...^O.lX..n|
-000000c0  52 b1 88 69 74 e1 12 3a  81 d6 32 b3 ac 06 4e 79  |R..it..:..2...Ny|
-000000d0  7a 50 1c 70 1e 63 6f 46  fa 17 b8 e2 1b b9 31 e2  |zP.p.coF......1.|
-000000e0  b0 f6 2f f3 ca 39 95 57  e2 51 82 d1 bf f0 f0 a2  |../..9.W.Q......|
-000000f0  3c 1b 28 cc e2 88 83 1d  db f7 56 b3 dd 39 d5 cb  |<.(.......V..9..|
-00000100  80 28 dc d4 2e e7 c6 a1  3a be 1f 8d 9f 53 5e 31  |.(......:....S^1|
-00000110  24 f1 25 36 2f f9 b1 f1  56 91 74 c8 44 6e bc c1  |$.%6/...V.t.Dn..|
-00000120  a3 cf 35 03 aa cf 87 66  9f 30 e7 eb f6 ff fd b9  |..5....f.0......|
-00000130  de 41 d4 b9 ef ce 99 d6  f3 e2 a6 ae 05 39 83 56  |.A...........9.V|
-00000140  5b 18 b6 52 8d a0 24 5e  34 4a 12 a6 8a 66 e3 c5  |[..R..$^4J...f..|
-00000150  70 92 3c f9 95 0c 59 58  65 b0 dc 17 03 03 00 59  |p.<...YXe......Y|
-00000160  56 82 fd bc ab b7 55 ee  45 23 0a cc 55 f7 fb d3  |V.....U.E#..U...|
-00000170  9f 75 0c 1f a1 f9 bc 3b  4f d5 4a 6b 47 14 6f 34  |.u.....;O.JkG.o4|
-00000180  61 85 c4 e5 3f fb 6d 0e  49 c8 f5 66 81 6b 3a b5  |a...?.m.I..f.k:.|
-00000190  14 f2 74 52 bf 8e d7 40  63 a0 45 ce 0b 69 e5 d6  |..tR...@c.E..i..|
-000001a0  43 6e 01 8b fd 54 6f ab  ce 03 57 c5 3f 6a 00 c1  |Cn...To...W.?j..|
-000001b0  bb 79 01 ee 90 7d 50 e7  de 17 03 03 00 35 cc 30  |.y...}P......5.0|
-000001c0  81 af c1 0c 4a e7 c9 d4  d2 fc 8f 0f a4 54 1c 41  |....J........T.A|
-000001d0  86 c9 a9 81 64 ce 4c 56  1a 94 fc 4b f7 e8 9d 50  |....d.LV...K...P|
-000001e0  33 4b b2 92 99 ee 79 43  ce 1f ea e2 14 5e 24 f1  |3K....yC.....^$.|
-000001f0  72 be c8 17 03 03 00 17  45 29 9b e2 ea a1 d3 16  |r.......E)......|
-00000200  8e 0c ce 85 30 a6 cd 37  b7 5a 42 0f dd 55 4d 17  |....0..7.ZB..UM.|
-00000210  03 03 00 13 ef e7 22 eb  4a e8 2a b4 88 da 2e 08  |......".J.*.....|
-00000220  01 95 77 ad 88 2e 53                              |..w...S|
+00000000  14 03 03 00 01 01 17 03  03 01 50 90 77 22 64 76  |..........P.w"dv|
+00000010  a1 cd 65 49 53 cb f0 2e  21 6c 12 7c 63 e5 ff 49  |..eIS...!l.|c..I|
+00000020  6c be e6 ba 70 2d 22 49  6e 5c 5b 65 46 4b 64 01  |l...p-"In\[eFKd.|
+00000030  f7 1d 57 a3 5f d5 a3 39  b6 b9 79 62 b3 e2 52 35  |..W._..9..yb..R5|
+00000040  95 26 d9 2b 72 39 60 23  c4 5f 7e 88 66 d4 c8 2b  |.&.+r9`#._~.f..+|
+00000050  2d 89 38 c8 b8 bd 73 0a  02 27 92 ab 89 8a ee 9b  |-.8...s..'......|
+00000060  a2 bc 9e 55 fd a0 d4 f3  02 d7 d6 4c 6c 49 ef 7e  |...U.......LlI.~|
+00000070  35 56 90 41 90 53 24 f5  c1 19 f0 ff a0 c8 7c 82  |5V.A.S$.......|.|
+00000080  52 01 98 8c ef 87 69 09  d2 17 35 af 9c 4b 3b b3  |R.....i...5..K;.|
+00000090  6c 36 70 63 48 a2 88 df  cb 87 f3 40 03 a8 b0 64  |l6pcH......@...d|
+000000a0  cc 66 fb cf ba b9 be 8c  67 2d 3c 99 ac 7f 93 c1  |.f......g-<.....|
+000000b0  15 2e 05 ae 95 51 3d 71  d9 43 09 d7 44 cb df 67  |.....Q=q.C..D..g|
+000000c0  b8 b3 33 62 c5 60 cf 22  20 e5 45 17 7c d6 74 12  |..3b.`." .E.|.t.|
+000000d0  0f 6d af d0 db dd 91 ad  20 ea 4d 26 fc c4 2b bd  |.m...... .M&..+.|
+000000e0  ec 3d 75 c8 87 36 b2 d0  1e cc 1d 92 fd 58 5e d5  |.=u..6.......X^.|
+000000f0  f7 ad c2 ed 0c b6 c6 bc  25 ff 39 75 ee cf fc 76  |........%.9u...v|
+00000100  77 e0 15 2e 22 82 3b 6f  93 e4 e9 a1 5a bb 9d 78  |w...".;o....Z..x|
+00000110  e2 3d 18 c8 e5 ea e3 82  52 de bf ca 32 c9 56 21  |.=......R...2.V!|
+00000120  ba c9 2b 12 7d 7b f5 18  73 e5 5e 9c 1e e1 23 92  |..+.}{..s.^...#.|
+00000130  ec 58 56 e5 a4 aa dc 2b  59 75 71 19 06 77 83 d7  |.XV....+Yuq..w..|
+00000140  0b 28 03 e9 fa 2c 89 1a  8c 64 f0 84 b6 13 f0 02  |.(...,...d......|
+00000150  22 02 33 cf c4 22 dd fb  b0 76 8a 17 03 03 00 59  |".3.."...v.....Y|
+00000160  9b 4c 67 95 f4 37 c9 2c  b7 33 c7 78 1c e0 1b 49  |.Lg..7.,.3.x...I|
+00000170  41 6f 88 2d 99 a7 e3 d3  d1 d1 f6 36 b1 2a 8e df  |Ao.-.......6.*..|
+00000180  11 b6 8d 04 63 c7 11 49  e2 8c 79 03 6b b8 a4 8b  |....c..I..y.k...|
+00000190  2a 2c 04 ab b3 e2 50 03  51 77 65 eb 3a 45 f1 ce  |*,....P.Qwe.:E..|
+000001a0  65 9f 9c be d6 be 7f 28  14 6a 61 37 55 94 8f a7  |e......(.ja7U...|
+000001b0  23 2f bc fc bb aa 89 47  76 17 03 03 00 35 f5 be  |#/.....Gv....5..|
+000001c0  e6 33 9b 48 97 74 b0 ad  a4 fc 78 fe 20 ab cd fa  |.3.H.t....x. ...|
+000001d0  48 ad 8c 55 c3 46 b8 2e  d6 ea f0 79 e3 a5 cf 29  |H..U.F.....y...)|
+000001e0  56 19 ab 95 c4 7f fd 89  41 f7 a3 6f e4 19 2f 83  |V.......A..o../.|
+000001f0  8c 3e 5d 17 03 03 00 17  74 24 c5 8d 30 40 0a 12  |.>].....t$..0@..|
+00000200  57 37 d0 27 30 3e 24 ea  81 ca c7 0a f5 12 cf 17  |W7.'0>$.........|
+00000210  03 03 00 13 ff 20 1a 76  60 da a1 15 22 16 10 8a  |..... .v`..."...|
+00000220  9f e1 ee 5d 62 a2 cc                              |...]b..|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-ECDSA
index e159d3e537..10c83c4828 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-ECDSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,131 +7,130 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 12 8c 45 11 2d  |....z...v....E.-|
-00000010  22 19 db e3 07 f4 31 70  a6 9d f5 b2 6a df 8f b5  |".....1p....j...|
-00000020  57 6e a1 80 75 6b 6b 77  53 cd b4 20 00 00 00 00  |Wn..ukkwS.. ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 af 7e fd 3d 23  |....z...v...~.=#|
+00000010  96 b6 46 26 9c 09 13 f6  80 4f c9 d2 52 d9 df 52  |..F&.....O..R..R|
+00000020  0b 7c da 61 52 ba 99 1b  32 5a 0c 20 00 00 00 00  |.|.aR...2Z. ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 d9  |..+.....3.$... .|
-00000060  7a 4f 73 11 d0 32 a9 32  96 d4 d6 5d 93 25 4a 83  |zOs..2.2...].%J.|
-00000070  26 6d 4d 30 02 8e ed 8e  65 0a 13 27 f3 53 5b 14  |&mM0....e..'.S[.|
-00000080  03 03 00 01 01 17 03 03  00 17 85 46 a7 e1 6f a9  |...........F..o.|
-00000090  d5 ea 00 e8 d2 7c 10 b9  e2 b1 98 9c eb a3 54 02  |.....|........T.|
-000000a0  61 17 03 03 00 42 ca 37  9a 89 50 e8 5d b2 6d 21  |a....B.7..P.].m!|
-000000b0  56 68 10 a1 47 76 16 87  f3 50 f0 5f d1 50 3a 03  |Vh..Gv...P._.P:.|
-000000c0  1e c7 27 84 d6 82 94 35  92 34 d7 54 f4 9b 30 8d  |..'....5.4.T..0.|
-000000d0  e9 9b 5a 04 88 4c 27 b3  3a 32 37 9e c2 a5 8a 19  |..Z..L'.:27.....|
-000000e0  d3 71 30 7b ba 9f d3 7f  17 03 03 02 22 4e e7 88  |.q0{........"N..|
-000000f0  d6 55 13 2b c9 db 93 db  9f 6b ca 4e a7 91 a1 30  |.U.+.....k.N...0|
-00000100  04 c7 e7 fc 5d f8 28 0d  b0 cd 73 b2 4b 59 e5 89  |....].(...s.KY..|
-00000110  68 f8 bb 47 1f 73 a2 d7  fe 75 73 8d a4 02 e7 22  |h..G.s...us...."|
-00000120  80 c0 aa d1 4c de f8 89  1a d2 12 86 35 7f cf 40  |....L.......5..@|
-00000130  e1 4f 47 f2 69 51 7c a7  7c 23 32 ed a6 53 8a 4a  |.OG.iQ|.|#2..S.J|
-00000140  47 86 e7 0c c5 5f 34 9f  91 eb d2 c1 bd 65 1e 7c  |G...._4......e.||
-00000150  6e ec 18 70 21 d9 95 dc  fe 44 cf d7 3f 58 fa e1  |n..p!....D..?X..|
-00000160  43 df 2e 44 7f a0 5f 48  e3 02 2c fd 18 f2 23 25  |C..D.._H..,...#%|
-00000170  a5 fc d1 23 2c 81 16 c3  8e 58 47 51 bf 0e c3 57  |...#,....XGQ...W|
-00000180  54 bf d1 8e f6 82 91 ce  5f 24 2d fd e5 80 52 c6  |T......._$-...R.|
-00000190  db b9 a1 3a 0d 80 25 98  17 ed cc 81 36 9f 85 31  |...:..%.....6..1|
-000001a0  11 25 65 36 50 ed 8e c7  6f b5 28 22 4c f3 93 94  |.%e6P...o.("L...|
-000001b0  61 0d c1 10 19 37 b2 3b  ec 41 3c 95 bc ae b5 8d  |a....7.;.A<.....|
-000001c0  95 87 39 bd 41 a7 cf 3e  b2 83 7c 12 fd 37 e4 6b  |..9.A..>..|..7.k|
-000001d0  0d c7 f9 7f f5 02 74 e0  37 c2 45 68 ab 84 f5 65  |......t.7.Eh...e|
-000001e0  78 4f 64 c5 d2 de 15 2b  1b d9 06 7a d5 f8 34 13  |xOd....+...z..4.|
-000001f0  19 54 2e 7a 85 04 d0 90  51 78 2a e2 4b ca 11 b9  |.T.z....Qx*.K...|
-00000200  7d 38 bd 5f be 5d d5 da  36 41 49 95 39 8e 1e df  |}8._.]..6AI.9...|
-00000210  a9 3b cc 18 8f 26 bd 37  97 f1 49 42 d4 e9 48 91  |.;...&.7..IB..H.|
-00000220  21 dc 70 9b 21 7a 24 13  8d 8e 7a d6 5f 11 2a ab  |!.p.!z$...z._.*.|
-00000230  73 9a cf cb af bf 3e 19  46 81 48 0a 17 b1 f1 24  |s.....>.F.H....$|
-00000240  a5 aa 60 91 fa d0 9b e4  95 28 7a a2 bf 2b ac 18  |..`......(z..+..|
-00000250  5f 1d 98 b8 e8 1a b4 58  fe 66 25 d2 0a 8d ad 7f  |_......X.f%.....|
-00000260  d2 46 95 8d d8 42 de 94  12 88 a6 30 80 14 ce 7c  |.F...B.....0...||
-00000270  ef 20 31 cd a3 e7 6b 29  b7 74 aa 62 c4 4c d5 52  |. 1...k).t.b.L.R|
-00000280  15 8e 7b da 51 60 24 ca  8d 65 9b 9b d8 2a df 1c  |..{.Q`$..e...*..|
-00000290  28 63 28 e7 20 07 f2 b4  99 d8 d6 2a d2 d3 ae 28  |(c(. ......*...(|
-000002a0  5e c5 12 25 fa b5 1c 31  1c 6d eb 1f d9 92 2b cf  |^..%...1.m....+.|
-000002b0  de fa d9 7c 39 69 0b a3  a3 05 aa 11 7d 41 3f d7  |...|9i......}A?.|
-000002c0  17 48 41 a7 3c 4b 42 93  46 26 da de 47 fe f8 76  |.HA.<KB.F&..G..v|
-000002d0  4a fb cc 08 78 19 98 d4  ad a7 4e c4 c6 47 2d 8f  |J...x.....N..G-.|
-000002e0  3f 59 57 09 89 8e 95 eb  a3 37 94 e2 6a a9 62 ee  |?YW......7..j.b.|
-000002f0  cd 8a b8 88 36 e1 ca 2a  ad 78 b8 2c 74 bc e0 11  |....6..*.x.,t...|
-00000300  6c 87 a3 06 51 b2 84 94  a2 d2 7b 57 94 79 5c 17  |l...Q.....{W.y\.|
-00000310  03 03 00 a4 07 a2 96 5b  70 21 8a a7 2e 2c 80 7a  |.......[p!...,.z|
-00000320  7a 70 09 bf 12 2e 80 1d  60 be 20 65 ff 02 74 ee  |zp......`. e..t.|
-00000330  33 27 10 b1 bf b8 aa 2b  f8 8e 2e b1 41 17 4d d5  |3'.....+....A.M.|
-00000340  bd 53 37 3c d0 85 2f 04  3c 92 e4 c0 0c 99 bd 34  |.S7<../.<......4|
-00000350  38 65 36 68 ae 12 1b 25  e7 a4 0e 2a 46 fc 29 1d  |8e6h...%...*F.).|
-00000360  5e 2d 32 42 00 59 33 da  43 53 d0 d0 61 03 7d 6b  |^-2B.Y3.CS..a.}k|
-00000370  ee 3a a5 bc 42 15 4d 04  5c 56 d4 b0 2d 2c 0e 5e  |.:..B.M.\V..-,.^|
-00000380  cd 2e 7b 83 22 a8 c4 bb  6d 6e 8b 5b 6d 7f cd 5d  |..{."...mn.[m..]|
-00000390  78 19 52 ff 72 a5 bf 5c  80 ba 0a 94 db c1 f8 24  |x.R.r..\.......$|
-000003a0  27 fe d7 0d 20 07 3a 8e  34 f9 32 ed 9a ae e3 de  |'... .:.4.2.....|
-000003b0  dc a7 2b c2 9e 8e 36 89  17 03 03 00 35 d8 4d df  |..+...6.....5.M.|
-000003c0  c5 6f 77 cc d2 2c 30 9b  db bb 4c 12 25 8e 2a 3a  |.ow..,0...L.%.*:|
-000003d0  ab e1 51 14 e5 16 22 8a  83 78 b1 98 7b 71 c9 a7  |..Q..."..x..{q..|
-000003e0  08 fd 5d 20 95 0b bf cb  64 08 df dd ca df f5 d7  |..] ....d.......|
-000003f0  f9 c2                                             |..|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 83  |..+.....3.$... .|
+00000060  95 cf ff 0f f6 eb 66 dc  4f 61 f3 94 43 18 7b f5  |......f.Oa..C.{.|
+00000070  91 6a e5 36 75 7b 6b 2c  d4 38 f7 4f 36 f0 3c 14  |.j.6u{k,.8.O6.<.|
+00000080  03 03 00 01 01 17 03 03  00 17 b7 83 3c 5c 9e ee  |............<\..|
+00000090  fc c3 14 33 45 62 69 8b  63 25 03 77 fe 7c 8b c0  |...3Ebi.c%.w.|..|
+000000a0  0a 17 03 03 00 42 6c cd  df 26 24 42 0d 2e 38 64  |.....Bl..&$B..8d|
+000000b0  c5 92 7c 6b 18 47 cc 90  09 57 95 0a f9 cc 81 f1  |..|k.G...W......|
+000000c0  db 90 29 ba b0 3f db 99  55 78 93 ab 05 34 91 46  |..)..?..Ux...4.F|
+000000d0  ce cb c5 2c b8 fb 43 98  31 cc 18 8f 2e 2a 39 78  |...,..C.1....*9x|
+000000e0  68 6d 01 29 05 ff 7e 4f  17 03 03 02 22 c1 3d c5  |hm.)..~O....".=.|
+000000f0  cb 42 fe 5d a8 ea 65 fd  1a a8 cd a9 28 ed 8d 69  |.B.]..e.....(..i|
+00000100  5b eb 28 11 c5 bb 9f 58  8d f2 2d 44 b4 8f 87 d6  |[.(....X..-D....|
+00000110  3f af df 3f 13 c0 7e bf  6f b3 e0 fa 45 5c ee a2  |?..?..~.o...E\..|
+00000120  13 70 08 94 2d 87 a7 1c  23 a9 aa a1 64 d2 49 ed  |.p..-...#...d.I.|
+00000130  33 2c ae 02 9e a7 03 24  3f 4c 43 d4 2e 54 b9 fc  |3,.....$?LC..T..|
+00000140  39 6c 32 8c b1 0c bb f6  31 60 d9 48 82 5b ed 2b  |9l2.....1`.H.[.+|
+00000150  ea dd e3 2d 1a 35 a3 22  be e1 f1 13 04 9c aa 1a  |...-.5."........|
+00000160  24 39 4a 0d 63 fb ce 31  71 af e6 1c f3 a3 dd c1  |$9J.c..1q.......|
+00000170  51 40 28 5a 11 a0 9e 19  0a a5 74 e2 40 56 9c 55  |Q@(Z......t.@V.U|
+00000180  40 45 e6 20 5d 23 aa 85  ec 42 5f 2c 24 10 fb ff  |@E. ]#...B_,$...|
+00000190  8a 52 e6 33 8f e1 1e e1  51 8a 9f 5d 6f 63 b8 04  |.R.3....Q..]oc..|
+000001a0  13 ab fa 5d 85 ba d3 eb  cf b9 0b 89 08 b7 7b a9  |...]..........{.|
+000001b0  ea 07 b9 41 07 7a 08 7b  57 01 35 11 a1 65 99 4a  |...A.z.{W.5..e.J|
+000001c0  4c 4a 1f c2 94 5a 00 09  9a 13 37 23 16 60 45 62  |LJ...Z....7#.`Eb|
+000001d0  96 fa 6b 7a 0f d6 68 14  f5 cd 40 d7 0a eb ea 75  |..kz..h...@....u|
+000001e0  f0 29 cb ea 7f e7 55 36  d9 02 b2 a0 bc 54 ac 04  |.)....U6.....T..|
+000001f0  1b 00 10 c0 db 45 81 e6  97 2a 4a 57 1d e7 de e3  |.....E...*JW....|
+00000200  d1 0a 09 c7 73 6a 9e a0  3c 79 7f a8 26 6a 98 05  |....sj..<y..&j..|
+00000210  5d 68 4c 60 05 86 cd 41  53 7b 08 c1 83 45 2e 5a  |]hL`...AS{...E.Z|
+00000220  6c 1a 65 2a e1 e6 55 b5  94 49 46 6f 71 97 ac 20  |l.e*..U..IFoq.. |
+00000230  65 1e 6b 08 2c bd 47 33  e8 78 e4 45 91 1a 7e 9c  |e.k.,.G3.x.E..~.|
+00000240  09 fa 88 c2 1b 0d 4e 01  0c 3b 9f a1 d8 12 88 4c  |......N..;.....L|
+00000250  d0 27 bd f3 98 67 d2 41  ac 3a ed 6a 56 51 f9 09  |.'...g.A.:.jVQ..|
+00000260  63 4e fe 4c 12 ef 97 04  9f 44 98 e4 68 c0 fc fc  |cN.L.....D..h...|
+00000270  1a 57 2d 87 77 31 fa 94  e7 ea 18 db 92 70 3c 2c  |.W-.w1.......p<,|
+00000280  7f a1 21 1b 68 4e 5c a0  f2 26 0c c8 4f 2e 06 3c  |..!.hN\..&..O..<|
+00000290  b4 98 5f 35 00 25 28 3c  08 d5 a2 bf ae ae 8f e6  |.._5.%(<........|
+000002a0  9d 8b 57 5d 8b 58 72 f7  cf e8 c0 8d 87 ca 75 1b  |..W].Xr.......u.|
+000002b0  79 60 35 d5 bd b2 28 01  47 17 09 b3 58 ff f4 b0  |y`5...(.G...X...|
+000002c0  05 8d fb f4 55 a7 4e cc  7d b6 d8 48 c2 3b 2d df  |....U.N.}..H.;-.|
+000002d0  e6 e2 83 3d 07 17 c5 d2  b2 dd 85 a4 67 74 1e 0f  |...=........gt..|
+000002e0  62 8d 75 9a 26 e2 77 20  5b 9b 5d 11 e5 86 4a cb  |b.u.&.w [.]...J.|
+000002f0  4d 5f c1 53 7f 4f b0 43  29 23 07 5b e7 8f 59 25  |M_.S.O.C)#.[..Y%|
+00000300  e2 74 c1 91 0e 43 cd 25  93 00 39 59 83 5f 89 17  |.t...C.%..9Y._..|
+00000310  03 03 00 a4 44 45 6b 25  93 08 da f7 f0 8b 10 48  |....DEk%.......H|
+00000320  53 09 0e 18 19 1e 26 f9  27 30 ba 80 99 b7 53 3d  |S.....&.'0....S=|
+00000330  6a d2 6b 89 10 ce d3 7b  e9 6f 67 fd 1b 0d 17 5e  |j.k....{.og....^|
+00000340  5b 05 c8 42 f0 4c a1 15  56 09 e2 ac 8d 78 31 b0  |[..B.L..V....x1.|
+00000350  01 82 8e 00 59 1d 3b 70  13 3a 52 1b fb 45 bf 26  |....Y.;p.:R..E.&|
+00000360  9b 8f 85 30 1e ab 54 a5  6b 8f db 47 ed 22 6b 50  |...0..T.k..G."kP|
+00000370  a9 c5 d8 22 98 29 d2 89  61 ab 24 47 79 de 62 88  |...".)..a.$Gy.b.|
+00000380  7a 4a 43 0f 9d a9 ac 16  b9 3a d3 63 88 29 1c 96  |zJC......:.c.)..|
+00000390  45 73 5b f2 eb b3 d0 c5  db 67 d1 78 50 83 f7 a6  |Es[......g.xP...|
+000003a0  f4 5e cd c9 fa da 14 ab  f1 d0 48 2b 4d c0 5a 5b  |.^........H+M.Z[|
+000003b0  e9 18 2d 70 f1 bc 4a d4  17 03 03 00 35 e6 af 63  |..-p..J.....5..c|
+000003c0  24 da e9 dc 90 ad 68 9e  84 d3 b2 74 07 d4 bb cd  |$.....h....t....|
+000003d0  5a d5 00 4c d9 93 b1 8a  57 8f dc 44 fc 9a 9a 17  |Z..L....W..D....|
+000003e0  71 2f 08 30 6a 3b 97 04  2c 3e 42 20 5d 5e b7 e0  |q/.0j;..,>B ]^..|
+000003f0  a3 91                                             |..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 02 11 67 1a 6d 9c e6  |...........g.m..|
-00000010  fd 73 aa 96 0b 7a 9b 1a  28 fd e8 5c 7b a2 65 91  |.s...z..(..\{.e.|
-00000020  e8 6a 96 48 6e 56 da 2d  8f 79 d3 d9 bb db f1 26  |.j.HnV.-.y.....&|
-00000030  27 99 e5 d2 2e b2 20 ee  af e5 b5 8b 6d a3 ea a3  |'..... .....m...|
-00000040  2a 6a a5 5e 28 61 04 10  d3 01 62 bd 16 f3 2b 84  |*j.^(a....b...+.|
-00000050  1b ca 26 67 62 4b b6 24  df 20 9a 06 57 ed 21 37  |..&gbK.$. ..W.!7|
-00000060  a1 0c e4 e1 cd c8 39 e6  5c bc 78 46 8c fb ad f1  |......9.\.xF....|
-00000070  55 15 bc d5 f5 21 2b b1  b6 03 5c 14 0f cf 8d 79  |U....!+...\....y|
-00000080  ad 64 b6 fd de 92 a9 51  f5 29 f3 d3 14 22 9a d5  |.d.....Q.)..."..|
-00000090  70 37 87 19 dd c3 d3 7b  79 ce 80 c3 f8 02 ea dc  |p7.....{y.......|
-000000a0  86 f8 af d2 fe 0d 49 a5  ba 6d ec 42 cf 28 21 ed  |......I..m.B.(!.|
-000000b0  5f 23 90 3b 83 d8 c4 73  fd 18 57 7f b1 81 9f 88  |_#.;...s..W.....|
-000000c0  19 3c bc 4b 24 4c 22 2f  07 f3 07 29 e8 6c 30 8e  |.<.K$L"/...).l0.|
-000000d0  12 b5 bc 2f 2f c0 80 fb  a1 f0 73 0c 22 ea 4f 24  |...//.....s.".O$|
-000000e0  3b 37 a5 68 65 12 42 0b  6b 7f eb ff 59 eb 92 de  |;7.he.B.k...Y...|
-000000f0  96 d9 f7 23 95 b1 b5 93  61 8b a5 bd c2 bf b0 86  |...#....a.......|
-00000100  af 54 91 21 38 b1 7e 4c  05 82 71 70 30 a0 19 ac  |.T.!8.~L..qp0...|
-00000110  10 63 fa 6a 05 95 14 18  27 cc f3 2e 2d 78 93 35  |.c.j....'...-x.5|
-00000120  65 c9 4e ec 3a 10 9e 75  60 21 18 71 f9 b5 95 37  |e.N.:..u`!.q...7|
-00000130  af 29 a1 51 a9 e5 a9 b5  5b a5 81 72 65 6c eb f2  |.).Q....[..rel..|
-00000140  2e 78 85 04 b8 c0 3c e6  3a 49 0e 28 fa 0a f8 73  |.x....<.:I.(...s|
-00000150  16 da ba 60 db ed ad de  7d 5b 10 15 03 5b 79 d0  |...`....}[...[y.|
-00000160  d7 da 91 ff 12 76 37 94  43 ad f4 f8 b9 39 23 e6  |.....v7.C....9#.|
-00000170  7c ed 92 d9 92 c4 2b bd  8c 7a fd ab 0d 17 0b b5  ||.....+..z......|
-00000180  5b 8a 5f a6 9b 19 04 88  37 75 54 a9 35 15 ff df  |[._.....7uT.5...|
-00000190  42 8b aa fb 9f 30 28 ef  bb 74 95 a5 af 44 c2 70  |B....0(..t...D.p|
-000001a0  55 c7 cc f5 37 b9 34 c6  dd fb 9b c5 70 fa 0f ed  |U...7.4.....p...|
-000001b0  45 54 38 02 34 0a 09 df  4c bd 07 78 ce 66 c7 0d  |ET8.4...L..x.f..|
-000001c0  57 94 06 97 6d b3 ec 90  70 81 37 23 77 b7 2f cb  |W...m...p.7#w./.|
-000001d0  c5 af 12 bd a7 c5 81 87  92 9e 9b ed 78 6d bf 63  |............xm.c|
-000001e0  01 aa d7 f3 50 f2 f7 c6  af a9 7f 73 d8 fb 17 27  |....P......s...'|
-000001f0  c3 33 8d 2b 2c ad 10 4d  36 5c 49 e8 19 06 34 45  |.3.+,..M6\I...4E|
-00000200  00 eb 1f c1 09 c8 19 06  55 91 52 df cd db f2 d5  |........U.R.....|
-00000210  22 2a af 92 cb 18 9f 96  2a 12 d5 ea 17 03 03 00  |"*......*.......|
-00000220  99 01 94 eb cc e4 e7 4f  90 c1 9b 85 c8 1f 73 f0  |.......O......s.|
-00000230  50 52 7d 62 50 f9 90 49  59 e8 31 a0 ea 3b 42 2c  |PR}bP..IY.1..;B,|
-00000240  2c dd e8 9c 42 d5 5f 50  84 b9 78 0a 5e 73 55 d9  |,...B._P..x.^sU.|
-00000250  21 39 e5 bc c7 88 04 1d  b8 d3 46 b3 a0 b6 07 60  |!9........F....`|
-00000260  4a 39 1a 39 cc e3 22 2f  de 30 16 71 54 1d c0 69  |J9.9.."/.0.qT..i|
-00000270  ea 73 81 bf 17 7d 82 dc  33 cd 1f c2 e8 eb 67 61  |.s...}..3.....ga|
-00000280  60 1e dd 2c 56 45 d4 49  fb 7f 21 dd a8 23 8c 13  |`..,VE.I..!..#..|
-00000290  d3 1b c5 c1 3b 08 e4 21  ac 35 eb d6 44 a6 48 c9  |....;..!.5..D.H.|
-000002a0  e2 ae 04 a8 36 fb e8 f6  2e 91 90 da 5a ae 18 3b  |....6.......Z..;|
-000002b0  a7 14 94 ed b7 f4 8a cc  74 be 17 03 03 00 35 a2  |........t.....5.|
-000002c0  9f 3f bd d0 7c 1e ac 4e  c9 7e 9d ee 9a 89 61 55  |.?..|..N.~....aU|
-000002d0  38 41 8c d9 e1 56 35 bd  0b 6e ad 77 0e 0d 08 df  |8A...V5..n.w....|
-000002e0  73 67 36 28 e0 9b 96 ba  c0 38 de 95 31 53 49 9c  |sg6(.....8..1SI.|
-000002f0  db 16 c2 90 17 03 03 00  17 6f cc cb 4e ac ef a0  |.........o..N...|
-00000300  48 75 94 28 c5 8d 06 33  28 94 11 84 25 9f 26 a6  |Hu.(...3(...%.&.|
-00000310  17 03 03 00 13 d2 ce 1b  90 04 b1 32 38 db 0d b5  |...........28...|
-00000320  3c e8 e3 34 bc c3 d1 33                           |<..4...3|
+00000000  14 03 03 00 01 01 17 03  03 02 11 e0 62 97 8a 4d  |............b..M|
+00000010  01 cf 8f e2 d2 a8 0d d4  9a fc f5 b2 d7 82 2b 7a  |..............+z|
+00000020  8c e7 ce 2a 99 3b 41 a2  a3 ca c4 9d 15 79 7f 2f  |...*.;A......y./|
+00000030  04 7a 18 e4 5b b6 01 d6  b5 03 d2 08 15 41 c7 18  |.z..[........A..|
+00000040  8a 66 78 05 ed 33 19 8e  93 9e c3 ff 4a 92 bb 7b  |.fx..3......J..{|
+00000050  72 e5 81 a6 2a 7f b3 e1  72 67 01 7a 95 f4 3f bc  |r...*...rg.z..?.|
+00000060  cd e4 bc 45 74 9b 4c 1c  69 68 d0 75 89 9f d5 d0  |...Et.L.ih.u....|
+00000070  de 59 d4 1c 47 cc 5e 2e  dd bd f9 1f e4 16 c9 c8  |.Y..G.^.........|
+00000080  9b 4e 07 6b 7a 12 e7 13  71 ae c1 26 48 32 d6 4e  |.N.kz...q..&H2.N|
+00000090  8a 15 c2 a0 91 59 9d 21  0d 28 d2 94 3f e9 fc 74  |.....Y.!.(..?..t|
+000000a0  98 5b e5 be 50 ad 10 7d  d9 a1 da 41 59 15 b3 85  |.[..P..}...AY...|
+000000b0  2d 7b 81 b3 ae fb db 4c  00 24 31 57 f2 54 b7 f7  |-{.....L.$1W.T..|
+000000c0  64 cc 73 23 bc 6a 93 e0  91 a7 5e 1b 63 f1 59 89  |d.s#.j....^.c.Y.|
+000000d0  a9 d9 7b 88 35 17 7a 4d  b9 66 d0 a5 f2 d6 79 ed  |..{.5.zM.f....y.|
+000000e0  c1 3a e7 98 88 96 e7 2f  31 66 bf 16 34 e2 fd 5f  |.:...../1f..4.._|
+000000f0  fb 0f fb 9a aa ba 78 d8  6a c9 72 d6 39 32 3a 99  |......x.j.r.92:.|
+00000100  a2 11 8a 32 79 cf 18 d9  22 da 40 31 3e d3 c8 17  |...2y...".@1>...|
+00000110  c4 1f e2 4f c8 7f b9 2f  83 d7 5e 59 48 d3 9b b9  |...O.../..^YH...|
+00000120  68 9c c2 e4 45 c2 a3 26  91 cd 3a 26 47 c4 b8 7f  |h...E..&..:&G...|
+00000130  8f 91 c0 06 b5 6e 5e b4  65 05 42 ea 48 9e 40 bc  |.....n^.e.B.H.@.|
+00000140  0c 04 22 86 6a 54 6c 27  c3 77 b4 b9 22 99 6a f0  |..".jTl'.w..".j.|
+00000150  91 bc 41 ca 24 41 52 fd  e2 18 0f 64 13 7e a3 6b  |..A.$AR....d.~.k|
+00000160  ab 27 1e 15 87 0d 7f 71  1e 29 16 f9 af 81 ec bc  |.'.....q.)......|
+00000170  28 0b 45 bd 76 fd ff 0e  fb 8d c5 0c aa ef a5 17  |(.E.v...........|
+00000180  55 49 a6 3d 74 5c 8d 77  60 99 a1 8f aa a9 eb 0f  |UI.=t\.w`.......|
+00000190  75 1a 55 21 3a 96 da 08  a2 cd ad 11 78 15 6a ce  |u.U!:.......x.j.|
+000001a0  ef f6 fb 8b a3 dd fd ad  2d a5 2d 59 25 37 fe 53  |........-.-Y%7.S|
+000001b0  48 90 fa 9a d3 3c 09 69  47 d3 d1 e4 48 30 fd df  |H....<.iG...H0..|
+000001c0  15 d7 64 ff ca 91 46 c2  36 82 30 ae 4e 75 12 be  |..d...F.6.0.Nu..|
+000001d0  58 5d da 63 da bd dc be  81 be ad 37 87 ea 0a 26  |X].c.......7...&|
+000001e0  31 cf 1b 1e 7d de a8 04  e3 b8 e5 65 5a 21 db b6  |1...}......eZ!..|
+000001f0  2b 7c e7 23 7c 2b e1 89  3f 28 27 97 dd 1c c6 00  |+|.#|+..?('.....|
+00000200  0e e4 05 68 0f 9a 8a 1d  e6 bd bd aa 1f 46 6e a2  |...h.........Fn.|
+00000210  d9 69 91 9b e7 e3 6c 39  33 77 b8 76 17 03 03 00  |.i....l93w.v....|
+00000220  99 c9 3e 7e 78 3b 91 65  35 cb 19 44 92 f7 77 f5  |..>~x;.e5..D..w.|
+00000230  60 3c 19 2a 97 c5 a0 92  b2 28 e2 44 94 ec 1b 3d  |`<.*.....(.D...=|
+00000240  f8 1a c1 65 eb 41 3f 61  f1 db 42 1a 0d b8 32 12  |...e.A?a..B...2.|
+00000250  f6 1b 83 be 37 d8 fe 78  bd 5b 66 d1 f2 6c 3e e3  |....7..x.[f..l>.|
+00000260  8a 0f 3a 28 57 71 1a 78  ab 2a b5 5f ad a3 6e 2c  |..:(Wq.x.*._..n,|
+00000270  a3 d9 3a 0b d0 99 95 d6  dc 8e 7a f0 b6 e4 cb 46  |..:.......z....F|
+00000280  ab cb eb cf ec 86 b3 fe  e6 e6 73 2c a2 64 d2 d5  |..........s,.d..|
+00000290  9c 8c 25 39 62 07 51 93  12 92 2b e3 4b 2e 3d f5  |..%9b.Q...+.K.=.|
+000002a0  f1 d4 22 69 c3 90 cf 91  35 2f e4 60 35 44 6f bf  |.."i....5/.`5Do.|
+000002b0  7a 75 3d fb 70 bd 20 05  a8 f8 17 03 03 00 35 6e  |zu=.p. .......5n|
+000002c0  09 00 fa 13 8f d4 17 40  ee 9e 5f 8a 56 ba 7c 69  |.......@.._.V.|i|
+000002d0  05 ee 65 8e fd 9c 62 7f  f9 af 04 c7 46 20 07 da  |..e...b.....F ..|
+000002e0  bc 79 f8 cc 53 c6 fc 47  b5 54 9c fb 4d a3 cf 56  |.y..S..G.T..M..V|
+000002f0  a4 57 c5 aa 17 03 03 00  17 d6 ea 39 50 a5 8e 67  |.W.........9P..g|
+00000300  b9 79 76 17 77 86 a8 58  fb 86 03 74 1a e4 12 37  |.yv.w..X...t...7|
+00000310  17 03 03 00 13 e7 07 59  c3 d0 27 b3 d8 e8 a3 7b  |.......Y..'....{|
+00000320  df e8 17 08 78 4e 9a 6b                           |....xN.k|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-RSAPSS b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-RSAPSS
index a306d4bb53..4892e2b555 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-RSAPSS
+++ b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-RSAPSS
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,140 +7,139 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 59 1d 08 4c 9a  |....z...v..Y..L.|
-00000010  08 52 d3 3b 7b 4c 3e d3  23 53 e3 17 09 07 52 8b  |.R.;{L>.#S....R.|
-00000020  e5 c9 55 c3 c1 0d db 83  aa ba 4e 20 00 00 00 00  |..U.......N ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 56 a4 21 f9 b3  |....z...v..V.!..|
+00000010  ff ed 23 dc a7 eb cd 4b  f3 0a a9 12 a4 52 84 04  |..#....K.....R..|
+00000020  77 59 23 09 26 6c 49 42  9f 68 b2 20 00 00 00 00  |wY#.&lIB.h. ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 d8  |..+.....3.$... .|
-00000060  b2 05 15 9a 39 db 4f d6  d1 d1 e5 6c f0 8d 6f b1  |....9.O....l..o.|
-00000070  54 d6 ff f2 48 2b a7 14  2a f6 4e cd 28 41 61 14  |T...H+..*.N.(Aa.|
-00000080  03 03 00 01 01 17 03 03  00 17 c9 09 91 34 14 6c  |.............4.l|
-00000090  de cb 9f d5 0d 03 5e 58  69 4e 61 75 8a 4b a9 35  |......^XiNau.K.5|
-000000a0  51 17 03 03 00 20 4f 41  5c 1d f6 73 a0 ca a7 a9  |Q.... OA\..s....|
-000000b0  4c b9 34 ee 7c c0 68 eb  e6 28 9f 1f 7f bf 6e 17  |L.4.|.h..(....n.|
-000000c0  17 cf 6c cb ad 72 17 03  03 02 7a 1f d1 c8 b3 7a  |..l..r....z....z|
-000000d0  7b 7b c9 fa c0 5a cb e9  18 64 b9 ef 49 8f 2d da  |{{...Z...d..I.-.|
-000000e0  cd 97 44 ec dc 2e 32 d8  39 e3 40 78 97 ef 01 69  |..D...2.9.@x...i|
-000000f0  0a b6 fc 31 d4 53 85 0c  c1 51 3a a7 02 e3 af ae  |...1.S...Q:.....|
-00000100  20 4b 44 13 c2 d1 4d de  b3 5d 24 3e 64 36 78 fd  | KD...M..]$>d6x.|
-00000110  6f 36 79 3e c2 ef 48 27  e0 e2 a3 86 61 22 14 61  |o6y>..H'....a".a|
-00000120  88 df 08 86 ed af 2a d6  2f b6 9d 30 f7 6e 28 7a  |......*./..0.n(z|
-00000130  44 2c b1 32 cc 4b 9b 6f  67 69 83 cc 7b 59 64 16  |D,.2.K.ogi..{Yd.|
-00000140  76 43 b5 0c 6f 5e 5c f0  17 e6 b4 32 0d 2d 01 91  |vC..o^\....2.-..|
-00000150  7c 00 af bf 99 fb 0b 97  8e fa 1f cc 10 4c cb 73  ||............L.s|
-00000160  81 f8 b3 7c 2e 8d ba c5  95 f1 7b 19 f2 19 48 c5  |...|......{...H.|
-00000170  ba a0 ba fd b3 29 42 1d  3a e2 f1 8f 13 c5 38 66  |.....)B.:.....8f|
-00000180  be 60 e9 a3 e4 b7 c3 e1  3d cf c3 62 85 4f f3 29  |.`......=..b.O.)|
-00000190  11 e4 72 cd c5 90 9c 45  36 11 67 8a 09 a2 f8 b1  |..r....E6.g.....|
-000001a0  48 e3 26 c5 d8 5d 8e b4  c0 af a6 e8 93 2f e8 99  |H.&..]......./..|
-000001b0  75 07 56 82 ed 58 21 2a  d8 4f dc 60 41 2f a9 49  |u.V..X!*.O.`A/.I|
-000001c0  aa 73 68 22 b7 73 5c 14  a4 46 b2 de 68 a8 f1 4a  |.sh".s\..F..h..J|
-000001d0  97 db 0d cd 29 26 d7 28  d2 d0 0c 81 43 c7 ae 0a  |....)&.(....C...|
-000001e0  c5 35 fe 55 da 7a ea 0f  78 95 f8 ed 02 84 de 5b  |.5.U.z..x......[|
-000001f0  3e ed e2 d2 25 75 a8 ec  7a 5a a9 35 eb d5 b9 08  |>...%u..zZ.5....|
-00000200  36 f9 fd 1a 18 27 d0 bf  07 46 bb 8b a8 52 bf 8b  |6....'...F...R..|
-00000210  d6 c5 3f 16 11 f9 ea 85  e9 f9 5a 68 17 20 2b 92  |..?.......Zh. +.|
-00000220  0c 58 55 b8 9a 66 6b 80  bb be 24 41 b4 2f 76 9a  |.XU..fk...$A./v.|
-00000230  c5 29 c5 86 e0 d3 1f 63  96 95 3f f2 67 7b 66 d5  |.).....c..?.g{f.|
-00000240  79 cc 47 80 8e 13 1a 29  ee 9a 97 3f 79 e0 be 20  |y.G....)...?y.. |
-00000250  c8 a1 6e 4a 85 91 7d 93  86 f4 0d 4d 5e e4 52 a9  |..nJ..}....M^.R.|
-00000260  a9 17 8b ab fd aa dc fd  a2 4b d3 d9 db 41 95 f9  |.........K...A..|
-00000270  e3 31 a4 2d 53 43 a2 b9  6a 1e f8 5b f4 0d 55 70  |.1.-SC..j..[..Up|
-00000280  f0 18 70 82 8e f3 53 3c  81 ac 13 2a b9 d0 33 dc  |..p...S<...*..3.|
-00000290  b9 8d b9 41 6a 4d 87 c6  70 f2 04 2c 60 01 5b 5d  |...AjM..p..,`.[]|
-000002a0  76 91 19 af 2d 48 82 69  59 15 c4 42 40 6a 38 3a  |v...-H.iY..B@j8:|
-000002b0  a2 db 21 b6 6d b3 e7 50  91 7c 8f f0 97 8f 7c 56  |..!.m..P.|....|V|
-000002c0  8b 4d f5 d3 7a 81 b5 4d  c5 33 ba 14 36 6f be ea  |.M..z..M.3..6o..|
-000002d0  95 1d d2 3d 29 a8 72 34  35 38 56 4c 65 47 b5 8b  |...=).r458VLeG..|
-000002e0  cb 43 9e 8d bd 1b 6b c3  2e 5b 9f f5 5a 60 e6 c9  |.C....k..[..Z`..|
-000002f0  6b c4 85 5c ac 55 fa 67  47 15 45 b4 e9 49 dd 0a  |k..\.U.gG.E..I..|
-00000300  aa be 5f d3 ec c9 88 71  52 eb 91 e9 38 e4 14 15  |.._....qR...8...|
-00000310  f3 ef 37 27 9c b1 c1 66  bb 40 c7 01 b5 8e f2 45  |..7'...f.@.....E|
-00000320  fb be c1 6a 73 a4 48 cf  e6 59 00 0b 37 56 a2 07  |...js.H..Y..7V..|
-00000330  41 29 56 2e 11 28 88 6a  37 df 46 33 a8 3d 14 3a  |A)V..(.j7.F3.=.:|
-00000340  c7 5a be 5e dc 17 03 03  00 99 15 b7 d6 a9 5d ae  |.Z.^..........].|
-00000350  e0 61 a0 09 69 01 c3 61  63 eb 94 9c e3 e3 78 e4  |.a..i..ac.....x.|
-00000360  b9 00 c3 db df cd 72 1b  86 2f 34 4f d0 da 63 c6  |......r../4O..c.|
-00000370  a9 b3 55 57 81 76 f1 fe  2b c0 85 6e 9b 6a c7 14  |..UW.v..+..n.j..|
-00000380  4c b0 48 fb a9 6d 14 f3  44 d1 30 9d ec c4 fc ac  |L.H..m..D.0.....|
-00000390  0a 79 c3 89 55 c8 92 9f  b6 bd 0b aa 85 bd 81 9b  |.y..U...........|
-000003a0  8e 94 b4 27 32 6f 26 da  40 27 6e 1f d9 7e 5e 16  |...'2o&.@'n..~^.|
-000003b0  b1 10 be 7a 9e 3a 80 ed  89 2e b9 9b b4 a9 70 11  |...z.:........p.|
-000003c0  61 46 c3 e9 b3 5e c0 b4  17 71 4a 28 44 1a 27 a4  |aF...^...qJ(D.'.|
-000003d0  20 19 47 70 2c 06 66 6a  19 a4 cb 67 2a 28 3d 4b  | .Gp,.fj...g*(=K|
-000003e0  50 02 c5 17 03 03 00 35  5b 49 ab 32 a4 7e 3c 35  |P......5[I.2.~<5|
-000003f0  a3 47 b6 57 da 5e 4a c8  5b cc 5e 71 35 32 63 7f  |.G.W.^J.[.^q52c.|
-00000400  13 ff c2 d2 db 31 d5 22  3f 6d 26 c3 d3 70 40 4d  |.....1."?m&..p@M|
-00000410  e5 2a cc 0b 51 a6 61 9e  a9 69 22 bf fb           |.*..Q.a..i"..|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 e0  |..+.....3.$... .|
+00000060  70 9a 3d 69 69 1f 8f de  d4 c8 7c dc 65 53 9a c6  |p.=ii.....|.eS..|
+00000070  77 c2 c4 21 1b 06 2d c4  4f 24 61 52 5b 00 69 14  |w..!..-.O$aR[.i.|
+00000080  03 03 00 01 01 17 03 03  00 17 96 99 40 9f d8 9d  |............@...|
+00000090  70 f0 cf f0 86 3e 7f 4a  3a 8a a4 63 6e e1 7f 24  |p....>.J:..cn..$|
+000000a0  f4 17 03 03 00 20 72 bb  5a aa 0e 2e d9 cc 38 0c  |..... r.Z.....8.|
+000000b0  c8 b9 88 08 6f 19 d8 38  14 14 d7 97 42 6c 45 43  |....o..8....BlEC|
+000000c0  51 dc 2b f6 02 e2 17 03  03 02 7a 8d 04 2f 64 c0  |Q.+.......z../d.|
+000000d0  e2 7b b5 20 9d 04 69 5e  88 82 aa f3 c6 b2 8d 6c  |.{. ..i^.......l|
+000000e0  41 08 c3 b1 0c 7d d1 5f  d6 e6 b7 1d c0 ad 2b 0d  |A....}._......+.|
+000000f0  02 c5 f7 6d a0 87 91 07  20 d3 d4 2e 5a 7d 5e 29  |...m.... ...Z}^)|
+00000100  37 2b ac 5f d6 cb eb e9  99 a7 05 f7 e7 ea 9c 99  |7+._............|
+00000110  cd 33 25 f8 45 95 43 f4  7a 59 2a 91 8c e2 ac 84  |.3%.E.C.zY*.....|
+00000120  ba 99 ef d0 d7 ea 9b db  31 b0 27 0c 81 3b b2 83  |........1.'..;..|
+00000130  20 c4 8b 7e 05 ac c6 82  e9 56 5a a2 b6 7c c7 33  | ..~.....VZ..|.3|
+00000140  a8 31 2f ad 60 be ec c3  2d c0 a8 b4 40 50 98 ea  |.1/.`...-...@P..|
+00000150  83 d1 cc a8 34 20 11 7c  2e f7 7c ca d8 27 03 a2  |....4 .|..|..'..|
+00000160  58 86 e8 e6 41 46 07 18  c7 a7 61 f9 cc 2f 7d 1e  |X...AF....a../}.|
+00000170  bb 34 7c 6e cb b3 9c 03  2f b0 dd e9 a1 32 13 10  |.4|n..../....2..|
+00000180  85 1d fa a6 bf c7 4d ec  94 8f 26 07 94 34 b3 5f  |......M...&..4._|
+00000190  b8 e4 da 6f 3d 5b 0a 61  8f 44 58 10 1a 4c f3 bc  |...o=[.a.DX..L..|
+000001a0  ff c7 8f 09 0a e4 1b 35  e8 a9 dc 9c 14 86 e5 67  |.......5.......g|
+000001b0  7e 96 e9 79 8d b2 d7 34  a0 7f 43 07 11 f1 03 68  |~..y...4..C....h|
+000001c0  95 5e f5 fa e7 8f c8 d6  5b 23 c4 84 e4 c5 40 58  |.^......[#....@X|
+000001d0  80 4a ac b7 a7 07 21 93  c1 a9 ad 9a 89 f7 f3 9e  |.J....!.........|
+000001e0  bb 7d 2a 00 d0 e0 66 9d  f7 86 4a ba b1 c9 1e 3b  |.}*...f...J....;|
+000001f0  f1 c6 6e c1 9c 09 85 38  9d fa 5a b9 ca bb a4 f5  |..n....8..Z.....|
+00000200  9e 3f ba d4 31 7d aa d7  f9 bf 83 05 5c 1f 61 18  |.?..1}......\.a.|
+00000210  d4 5e 16 98 c6 92 7b bd  12 96 18 c7 33 75 ad 08  |.^....{.....3u..|
+00000220  d1 0b 47 4c c8 73 3e 68  fb 53 ff e0 1a 10 6c 5a  |..GL.s>h.S....lZ|
+00000230  7f 9d 92 32 2f c2 2d 95  7d c6 ef 18 9b 44 a1 bc  |...2/.-.}....D..|
+00000240  6a f5 88 79 e1 00 a3 14  8f 66 07 03 16 2a 53 80  |j..y.....f...*S.|
+00000250  9b 26 80 0d 0b 5e 0c c6  c9 fa a1 3b c9 a6 91 1f  |.&...^.....;....|
+00000260  bd fb 79 24 ab 93 e4 25  d1 a6 41 8b 9e a9 06 0f  |..y$...%..A.....|
+00000270  80 2e 4e 8c 20 2c 1e a8  7e 63 7a 4f b8 90 c3 56  |..N. ,..~czO...V|
+00000280  a3 9e 63 2a 8b 85 9e ef  66 f5 16 be 79 c3 9b 47  |..c*....f...y..G|
+00000290  dc 1c 75 0b 30 3c db 32  e8 ec 33 f9 9f 26 3d 56  |..u.0<.2..3..&=V|
+000002a0  36 e9 ea 83 57 c4 59 ac  73 db 04 5a 1d 38 9b e4  |6...W.Y.s..Z.8..|
+000002b0  47 50 f8 92 92 7f c9 09  4f f4 9c ab 3e 03 df 80  |GP......O...>...|
+000002c0  cc 5b 50 0b 06 ef 8c 59  d2 f6 f3 a4 16 e7 0f 90  |.[P....Y........|
+000002d0  c8 79 95 0a 39 0f 33 69  31 29 1c 30 77 72 58 b5  |.y..9.3i1).0wrX.|
+000002e0  cf 0e 4c 30 fc 0a 01 93  b1 20 21 34 2a ce 28 8d  |..L0..... !4*.(.|
+000002f0  57 71 3e c9 b1 51 c9 4f  e5 e4 09 0b 1e 32 52 4e  |Wq>..Q.O.....2RN|
+00000300  d0 be f2 a2 90 75 f4 a8  61 66 43 84 74 4e bb 28  |.....u..afC.tN.(|
+00000310  7b ea 68 96 92 6d 4b 8c  af 50 13 84 92 b9 6b 48  |{.h..mK..P....kH|
+00000320  60 1c 60 62 28 a2 37 d1  1c 86 d4 60 27 a6 5b 6d  |`.`b(.7....`'.[m|
+00000330  88 d7 56 21 b7 86 f5 b6  34 f9 55 cf 47 f8 4f 90  |..V!....4.U.G.O.|
+00000340  78 5c 56 52 97 17 03 03  00 99 35 71 51 6f 73 ba  |x\VR......5qQos.|
+00000350  76 60 e1 4a 5f ec ce 52  b6 91 58 3d 0c ea e6 58  |v`.J_..R..X=...X|
+00000360  7e ee da 1e aa df bb 8e  c9 89 ce 43 bd e7 34 9b  |~..........C..4.|
+00000370  b8 4b dd 50 73 0c f7 e5  15 e0 a1 c3 bd 07 08 62  |.K.Ps..........b|
+00000380  a2 d5 2e 9f 46 f7 4d 9c  ae ad be 22 89 0f b0 3e  |....F.M...."...>|
+00000390  82 1c 80 60 38 39 4f 06  f9 fc 4c f8 02 bf b3 5a  |...`89O...L....Z|
+000003a0  25 22 f4 62 61 ba eb 78  b2 40 68 ea 99 ef 95 90  |%".ba..x.@h.....|
+000003b0  b1 b5 25 17 81 43 5c 15  bd a9 1f e8 0f b9 91 be  |..%..C\.........|
+000003c0  f1 47 91 99 ec 50 3b fa  c2 06 fc 89 09 a3 d7 b3  |.G...P;.........|
+000003d0  ed e3 3d 41 57 07 4b b0  3d 02 51 7e 13 bb d3 68  |..=AW.K.=.Q~...h|
+000003e0  49 4c 6a 17 03 03 00 35  63 f7 b5 68 31 22 c7 f5  |ILj....5c..h1"..|
+000003f0  50 ae c0 81 0f 50 fb ba  50 72 8a d7 e0 c0 73 07  |P....P..Pr....s.|
+00000400  d0 88 ed 6d 7b e7 66 b3  8d e3 10 ca 2f 68 c3 39  |...m{.f...../h.9|
+00000410  d9 b9 09 44 78 4a 11 91  fb 51 ea 9f 9a           |...DxJ...Q...|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 02 7a 5c ca 9a 42 8c  |..........z\..B.|
-00000010  89 80 5e f5 67 03 ec e8  79 ac 9e 95 3b 12 bf 9c  |..^.g...y...;...|
-00000020  e8 c6 85 54 36 f3 7e ad  5e b8 0e 78 f7 f2 9f 73  |...T6.~.^..x...s|
-00000030  da 8a 1e f3 0f 0c be 7d  ef 3d ec d8 51 91 55 3d  |.......}.=..Q.U=|
-00000040  21 ba 3d 10 32 94 7b 1c  6b 5e 5a 18 0e 79 9c f9  |!.=.2.{.k^Z..y..|
-00000050  7c 48 73 21 ae ed 2d b7  fe 34 9c 70 10 fb 67 9f  ||Hs!..-..4.p..g.|
-00000060  c6 28 56 2e cb 42 e3 be  c5 b8 7d cf 4d 54 22 a0  |.(V..B....}.MT".|
-00000070  8f 7c ce 49 96 d2 ad 88  80 6b 06 be 36 0d c8 24  |.|.I.....k..6..$|
-00000080  c1 bd 09 e8 36 a4 a9 e7  cc 4c de ed bb d6 cf 5b  |....6....L.....[|
-00000090  da 21 75 f1 f5 6d ed 75  d2 a5 13 11 4d 4e 62 e9  |.!u..m.u....MNb.|
-000000a0  92 23 49 37 57 f4 56 a4  54 1b 59 c0 ed cf 43 d1  |.#I7W.V.T.Y...C.|
-000000b0  c3 d1 18 4d 47 5f e1 f8  13 ed f2 7d 1e 97 9d ba  |...MG_.....}....|
-000000c0  c5 49 e9 2c 76 ca 02 60  89 01 7a 47 b7 1d 07 54  |.I.,v..`..zG...T|
-000000d0  01 17 52 39 10 59 c1 58  66 3e 24 24 7d a7 94 5f  |..R9.Y.Xf>$$}.._|
-000000e0  3b df 0c 47 fc 96 bc 4a  fc 82 55 cf d3 33 b1 da  |;..G...J..U..3..|
-000000f0  37 7b b4 f3 b2 03 31 cc  2b 60 a2 e4 76 28 d5 fd  |7{....1.+`..v(..|
-00000100  4a 5f 47 e3 97 21 11 6a  5d 51 a5 43 9e bb b0 50  |J_G..!.j]Q.C...P|
-00000110  21 09 7c c8 e5 ca f9 7a  69 2c 0b 83 37 7a 8b 35  |!.|....zi,..7z.5|
-00000120  ff 63 cf df aa 18 0c 75  39 14 e7 90 0b 67 5f b6  |.c.....u9....g_.|
-00000130  94 cd 1a 49 ce 4f 46 dd  2b 61 7d 07 72 11 6e 69  |...I.OF.+a}.r.ni|
-00000140  3b 6f 0c 1c 6c 8c 10 ef  ef a1 bc 05 2f c9 20 8b  |;o..l......./. .|
-00000150  e2 fa 94 89 48 49 5d 1c  73 85 d7 e3 25 27 de a9  |....HI].s...%'..|
-00000160  1a fb 2e e0 74 c8 aa 52  4c e7 48 ec ca 99 48 ba  |....t..RL.H...H.|
-00000170  03 9b f7 75 de 01 0b 2e  9e 14 2f 1b 82 13 01 7c  |...u....../....||
-00000180  55 7e 24 06 55 59 62 f4  b6 33 69 7e c9 c1 07 07  |U~$.UYb..3i~....|
-00000190  6d 61 e0 18 d3 2b 46 4f  ff 14 01 31 06 d6 b2 d2  |ma...+FO...1....|
-000001a0  56 40 1e 69 70 21 a1 33  98 ef 23 79 6c b1 ed f6  |V@.ip!.3..#yl...|
-000001b0  15 b9 8f fc 69 7a f4 4d  3b f8 bd 50 ee 6a 15 15  |....iz.M;..P.j..|
-000001c0  0a 81 b6 4b 40 6c 15 e6  55 92 cf 8f a1 00 bf d5  |...K@l..U.......|
-000001d0  f7 74 13 30 ba ab eb 9d  82 bb 76 14 17 7e ab 30  |.t.0......v..~.0|
-000001e0  36 62 61 0a d3 2c 92 ca  95 b0 8b 41 54 b3 fa 0a  |6ba..,.....AT...|
-000001f0  82 8c aa bd 89 e2 fa 1a  87 9d 9a 1e 21 78 a4 27  |............!x.'|
-00000200  5d 16 4d e6 a7 43 a5 11  0d db 35 08 9c 23 96 8b  |].M..C....5..#..|
-00000210  80 46 5d 9f 1d 4e a2 04  17 8e 4d 57 c6 55 35 b4  |.F]..N....MW.U5.|
-00000220  ac 0b c2 44 60 f6 08 1c  cc c7 ba 7c e1 14 fb c2  |...D`......|....|
-00000230  1d 67 67 ed 20 99 14 34  5a 97 85 0b ca 36 34 8e  |.gg. ..4Z....64.|
-00000240  18 de ab 4d c6 32 6c 4f  44 eb b6 05 7b a6 37 db  |...M.2lOD...{.7.|
-00000250  57 65 8a 62 5e c4 8c 14  13 6c 41 b4 7a 0d a8 75  |We.b^....lA.z..u|
-00000260  42 a7 1b 92 34 16 2a 77  e3 63 bf 23 cc 42 9b 9d  |B...4.*w.c.#.B..|
-00000270  bd c9 ba b3 20 77 6a 56  c2 2c dc 72 9f ec b2 a8  |.... wjV.,.r....|
-00000280  57 cc 00 17 a1 17 03 03  00 99 0a d6 46 7f 5a 00  |W...........F.Z.|
-00000290  7e c4 1b 10 c4 d6 ae 8a  37 cb 47 3d bd f0 17 f3  |~.......7.G=....|
-000002a0  9b 25 fa 31 cb 75 10 1c  95 4b 80 9e ff 78 ae b4  |.%.1.u...K...x..|
-000002b0  65 b7 2f 00 3f 94 79 1d  66 52 f7 48 03 df 35 6b  |e./.?.y.fR.H..5k|
-000002c0  06 42 55 1a bd 0d f0 e0  6f 8e 8e b7 60 dc e2 ec  |.BU.....o...`...|
-000002d0  8b 9b 2e de 1a 08 65 b1  ad 9d 41 a5 32 6f bd f2  |......e...A.2o..|
-000002e0  02 47 79 4a 02 03 45 e0  2e 0e 9c e4 05 ae 8a 47  |.GyJ..E........G|
-000002f0  20 61 5a a3 da ab 84 33  11 76 81 a3 93 6b b0 9a  | aZ....3.v...k..|
-00000300  9d 64 6e f3 ba a0 ab 17  c5 3e 95 8a 1e 95 62 99  |.dn......>....b.|
-00000310  5a 12 68 96 49 05 33 b6  6e 95 46 11 9b af de 62  |Z.h.I.3.n.F....b|
-00000320  0c 5e e1 17 03 03 00 35  78 f6 24 17 fb 8f 65 3f  |.^.....5x.$...e?|
-00000330  5b 1d dd 3d 3d 73 c5 fb  1f 37 fb 54 a5 d3 58 49  |[..==s...7.T..XI|
-00000340  ed 63 22 f9 b6 fb a2 68  59 9b 04 55 03 f1 38 af  |.c"....hY..U..8.|
-00000350  2e ee 85 0c c8 95 2f f9  a9 e7 de d9 14 17 03 03  |....../.........|
-00000360  00 17 8b 72 27 df c9 0d  69 d1 95 e2 5a ea 3e dd  |...r'...i...Z.>.|
-00000370  be df 0b 72 de 0c e5 4a  19 17 03 03 00 13 0d b2  |...r...J........|
-00000380  7c 8d b1 44 32 9d 63 b1  8b 90 e1 2d 92 9c c4 b9  ||..D2.c....-....|
-00000390  cd                                                |.|
+00000000  14 03 03 00 01 01 17 03  03 02 7a 63 6c 83 c6 db  |..........zcl...|
+00000010  85 98 08 0a da be 96 d7  7a 2e 61 7b 7e d1 4f d4  |........z.a{~.O.|
+00000020  45 03 25 05 50 fc 20 ee  8f ae 56 39 15 0b c3 44  |E.%.P. ...V9...D|
+00000030  80 5c 81 45 55 df 1d cd  30 92 7c 5e 43 16 e1 29  |.\.EU...0.|^C..)|
+00000040  46 77 d3 03 6d 36 11 d0  91 76 a8 34 f0 98 67 f6  |Fw..m6...v.4..g.|
+00000050  88 f8 f7 d0 a3 ee e0 d1  30 9f 6f e9 75 ad d6 e9  |........0.o.u...|
+00000060  e8 e9 6f 11 55 7e 66 87  9a 7e 9d a5 31 b2 67 fd  |..o.U~f..~..1.g.|
+00000070  a2 a7 c8 c8 4d d8 2b f1  5b a9 b5 df 03 42 55 96  |....M.+.[....BU.|
+00000080  9e 73 9c 9a 6a b9 9f 2e  a5 ec ba 0b a3 5b 99 b4  |.s..j........[..|
+00000090  7c 57 96 fb f5 96 20 ac  71 90 bb 4b 76 dd 2e 01  ||W.... .q..Kv...|
+000000a0  17 d0 63 76 c9 4a e5 ae  58 bd 59 b5 e1 85 6d 46  |..cv.J..X.Y...mF|
+000000b0  9f d5 3e 9d a7 f0 92 96  ec 4e 90 c3 5a 52 ba e5  |..>......N..ZR..|
+000000c0  bd fa f0 a7 88 d5 9e 76  9b 2b 23 fb 37 c0 f1 0a  |.......v.+#.7...|
+000000d0  d2 df d4 2c 5d 8c 64 f0  98 3c 85 3f bb ed 30 44  |...,].d..<.?..0D|
+000000e0  eb cb fc 47 e5 8a 57 ff  37 23 6d e2 75 a7 15 e4  |...G..W.7#m.u...|
+000000f0  dc f9 02 8f c4 af d8 e8  bb 07 43 90 5b c2 86 f3  |..........C.[...|
+00000100  40 22 a7 bb b6 f1 f6 4c  2e d6 fd d8 02 f0 3d 27  |@".....L......='|
+00000110  89 38 97 7d 6e d3 6c b1  4c 87 ca 30 e9 ec fe b3  |.8.}n.l.L..0....|
+00000120  db 62 ea 2f 3a 83 95 18  4e 44 4f 97 c4 ff f6 bb  |.b./:...NDO.....|
+00000130  0b b0 98 c7 c6 c7 94 0a  8b c9 c0 d9 51 d3 6a e1  |............Q.j.|
+00000140  36 55 79 c4 37 75 6f e7  14 53 60 9e 22 00 fe d7  |6Uy.7uo..S`."...|
+00000150  ef e4 ca 60 38 12 25 8c  c6 c9 7e 5f 1a 7c f1 c1  |...`8.%...~_.|..|
+00000160  a7 15 b2 f4 32 31 de c8  a2 d4 59 46 1e 68 a6 94  |....21....YF.h..|
+00000170  b8 18 52 df 44 01 0b a0  a0 02 60 83 84 fc ad 99  |..R.D.....`.....|
+00000180  fc 60 0b 23 0a 7a f9 73  bf d8 a5 af 9b ea dd a3  |.`.#.z.s........|
+00000190  fb 5b 41 17 95 0a 57 4a  94 7e 24 9f 31 74 06 65  |.[A...WJ.~$.1t.e|
+000001a0  95 90 40 20 17 0b 95 22  b8 49 4e a6 a4 be e1 74  |..@ ...".IN....t|
+000001b0  01 a2 7e cd 60 50 46 5c  fd 2a 88 90 ef 7f 6c b8  |..~.`PF\.*....l.|
+000001c0  3e a1 40 8e 91 cd 8d db  ad 81 d0 08 b0 d0 d7 ae  |>.@.............|
+000001d0  18 4f 47 9b 1a 66 8b a5  d2 fb 01 d3 67 79 46 71  |.OG..f......gyFq|
+000001e0  5a 49 dd df 06 c6 57 c7  e0 b1 60 39 d4 a9 37 88  |ZI....W...`9..7.|
+000001f0  31 0d c0 92 4e c7 2a 25  c4 df b0 d8 df bb 31 1b  |1...N.*%......1.|
+00000200  ff 0a 34 46 46 88 0b 11  7d 20 32 cd 01 d0 3f 11  |..4FF...} 2...?.|
+00000210  e1 6e 63 42 d7 4a 83 ab  ad f7 51 bd c3 37 2b 76  |.ncB.J....Q..7+v|
+00000220  9e bb 45 3b 81 d8 47 71  02 b9 fe 7c 56 46 78 3e  |..E;..Gq...|VFx>|
+00000230  9e 94 00 1b 98 17 72 37  c0 e5 36 a9 f0 02 b7 cf  |......r7..6.....|
+00000240  f0 b4 66 10 1b 91 07 5f  bb 22 e8 12 d9 e3 33 dd  |..f...._."....3.|
+00000250  87 66 e4 f6 00 f6 3a dc  19 59 af ce 8e ae c4 d3  |.f....:..Y......|
+00000260  03 d8 25 02 40 7e 95 70  31 85 53 bc 9e 96 11 69  |..%.@~.p1.S....i|
+00000270  5b 2f b9 17 48 f4 ae c5  a1 c5 d1 7f 4a 10 06 b6  |[/..H.......J...|
+00000280  2e 34 6c 09 12 17 03 03  00 99 16 4c 04 64 97 e0  |.4l........L.d..|
+00000290  26 e1 66 e9 34 05 d7 d3  75 e3 b9 de 56 15 51 67  |&.f.4...u...V.Qg|
+000002a0  fb fe 9a c6 9a 3c 38 08  2c c8 8c dd fe 49 c5 ed  |.....<8.,....I..|
+000002b0  a8 54 86 90 2c f6 7c d1  12 02 99 94 5e 2e 4b 4e  |.T..,.|.....^.KN|
+000002c0  84 e9 b4 96 5c dc 56 28  3d ea a9 4f 8f ad 51 ff  |....\.V(=..O..Q.|
+000002d0  02 b1 b9 7a 29 e5 32 7c  2a 8b 60 5d e2 fc b4 8f  |...z).2|*.`]....|
+000002e0  06 32 4a ea 37 ed 03 f0  68 72 b7 83 1f 04 10 2b  |.2J.7...hr.....+|
+000002f0  24 db 5b 10 6c 41 55 40  54 69 07 39 d4 db ac 10  |$.[.lAU@Ti.9....|
+00000300  77 9f 04 f4 b9 3f 35 7e  04 af ab 7a a0 47 b9 d9  |w....?5~...z.G..|
+00000310  4c 6e 25 00 ce ef 93 3f  28 2c 2d f6 42 e4 5f 3e  |Ln%....?(,-.B._>|
+00000320  26 92 13 17 03 03 00 35  fb 14 eb 5f 18 61 75 ba  |&......5..._.au.|
+00000330  e4 dc d2 95 fe 93 bb 54  29 e3 38 e3 59 54 81 9f  |.......T).8.YT..|
+00000340  4e 29 be c6 e6 cd ad 8c  9d 6a ad 28 ec d3 a6 e4  |N).......j.(....|
+00000350  bc 5e 8c df a8 7e 14 d8  69 3c 30 7c 0a 17 03 03  |.^...~..i<0|....|
+00000360  00 17 10 73 c0 75 88 af  51 90 ff 3f b2 83 47 27  |...s.u..Q..?..G'|
+00000370  19 c0 e6 cd 14 a4 c7 8d  a0 17 03 03 00 13 fb 1f  |................|
+00000380  ed 8e 47 c8 79 f9 53 df  6d 97 a7 1d 53 8d 80 85  |..G.y.S.m...S...|
+00000390  dd                                                |.|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ECDSA b/src/crypto/tls/testdata/Client-TLSv13-ECDSA
index 53624650c7..eeab871172 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv13-ECDSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,83 +7,82 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 cd 84 c1 22 3c  |....z...v....."<|
-00000010  2e 71 03 57 5f c1 27 88  ae 0e 7f 1a e7 aa 82 6d  |.q.W_.'........m|
-00000020  8d f1 18 78 8d b2 4c d6  11 c3 b0 20 00 00 00 00  |...x..L.... ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 a5 7b 07 50 bc  |....z...v...{.P.|
+00000010  01 11 74 76 99 fb 85 e5  40 6b 02 14 d9 64 b1 8a  |..tv....@k...d..|
+00000020  8b 78 a3 ee 2e 4d b0 96  14 3a fb 20 00 00 00 00  |.x...M...:. ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 1a  |..+.....3.$... .|
-00000060  28 ce a9 6b 7d 26 24 78  52 fe e1 65 34 6b 12 50  |(..k}&$xR..e4k.P|
-00000070  5c 4b b0 10 2e 94 3f b3  a0 b7 45 fc 3b 4d 31 14  |\K....?...E.;M1.|
-00000080  03 03 00 01 01 17 03 03  00 17 21 d8 25 9d 8a 8a  |..........!.%...|
-00000090  84 70 10 37 95 29 4e 00  da eb c1 e7 20 a3 09 a3  |.p.7.)N..... ...|
-000000a0  63 17 03 03 02 22 51 4c  48 48 ce 06 1d 4d 42 fa  |c...."QLHH...MB.|
-000000b0  54 16 a0 fe 66 f2 62 56  55 8e 71 0a 8a 75 8f ff  |T...f.bVU.q..u..|
-000000c0  71 72 29 09 54 f2 74 a8  0a 8c f3 62 84 2d 4c 11  |qr).T.t....b.-L.|
-000000d0  02 f1 c5 6f 2c f0 39 91  3e 58 98 e2 3d 87 0d 8b  |...o,.9.>X..=...|
-000000e0  5a 77 8f 2d 38 fb 3a b8  63 4f 79 24 bb 40 6f 09  |Zw.-8.:.cOy$.@o.|
-000000f0  28 01 bd 03 53 f0 63 fc  49 92 ba 9b 3b fd a1 75  |(...S.c.I...;..u|
-00000100  cf be 2c 5a da 3d 53 b2  11 5c f8 66 26 d0 78 6c  |..,Z.=S..\.f&.xl|
-00000110  3e a0 34 16 2b 28 6b 73  95 08 d7 e6 2f f4 f3 74  |>.4.+(ks..../..t|
-00000120  3f 1d e1 a5 e4 0e 82 af  52 58 09 b0 90 f8 ee ea  |?.......RX......|
-00000130  5a 34 b7 29 7a a6 bb 0a  2f 64 f7 51 80 71 90 82  |Z4.)z.../d.Q.q..|
-00000140  d2 1a fa c9 43 de 31 eb  a1 f6 b0 31 99 5e 8b 84  |....C.1....1.^..|
-00000150  6b f1 66 6e 49 6d 2e 52  e1 c4 21 76 7b 1e bf d4  |k.fnIm.R..!v{...|
-00000160  c1 8f 7c 1b a9 6f 4d 1b  03 86 63 8b d4 64 24 79  |..|..oM...c..d$y|
-00000170  73 00 1e cc 2b 5c a6 65  db 35 74 95 9b 04 5d ce  |s...+\.e.5t...].|
-00000180  ef 54 eb be 6a 6a 04 5d  e2 ba cb 4f c7 3f 33 8f  |.T..jj.]...O.?3.|
-00000190  20 51 6c 03 0a 1a 90 e3  74 e4 e3 2f 78 00 1b 4a  | Ql.....t../x..J|
-000001a0  17 9a 6f 35 0b b8 0e 30  cc 51 87 fa 17 d9 95 39  |..o5...0.Q.....9|
-000001b0  b5 51 c6 3f 6f 9b 39 74  c6 3e a3 8e 10 2f fc eb  |.Q.?o.9t.>.../..|
-000001c0  85 b3 a3 6e 21 5d 9f dc  fb 6a 5f 4b 42 5c a1 f5  |...n!]...j_KB\..|
-000001d0  c3 b7 5c ef 86 22 e9 bb  ae 97 96 ff 06 b1 d8 19  |..\.."..........|
-000001e0  38 6b 23 03 30 ea 1c 6f  c3 4a 94 74 35 16 61 2e  |8k#.0..o.J.t5.a.|
-000001f0  c6 9d a7 db b0 50 63 f7  e2 7c 00 2b 12 05 89 f2  |.....Pc..|.+....|
-00000200  e9 06 98 12 3c 77 6e d3  09 7f 6f 93 28 1e ce 1f  |....<wn...o.(...|
-00000210  e5 1f 18 b3 65 14 71 22  58 3b e1 a9 6a 03 16 37  |....e.q"X;..j..7|
-00000220  5c 93 3c ad 66 29 59 45  05 8f ae 0d b3 ca 79 ad  |\.<.f)YE......y.|
-00000230  40 9f ad 12 94 26 80 69  12 32 3d bf 90 90 e6 a1  |@....&.i.2=.....|
-00000240  f6 d4 ab 94 27 0c ab 1b  e9 36 7a 6f 88 58 4a 54  |....'....6zo.XJT|
-00000250  5d 86 bf 2b 1c 0d 3c 02  2e f1 93 63 7f 16 75 8b  |]..+..<....c..u.|
-00000260  a4 ef ee ea b3 dd 2a cf  c8 4a 78 79 54 ca 78 82  |......*..JxyT.x.|
-00000270  1f b2 20 af 90 39 9b 90  01 ce eb 5f 42 c1 9a 1e  |.. ..9....._B...|
-00000280  33 b9 a5 9b ff 48 40 7e  ed 26 ba 51 93 50 31 20  |3....H@~.&.Q.P1 |
-00000290  dd 38 f1 51 53 92 ee c5  63 a8 5a 62 db 1b d6 79  |.8.QS...c.Zb...y|
-000002a0  77 7c c8 45 8d f4 b3 c9  c9 60 e2 5d f3 8a 4c bc  |w|.E.....`.]..L.|
-000002b0  f8 f0 ee 10 61 50 4b 2d  df 5a e7 2b 48 fe 96 06  |....aPK-.Z.+H...|
-000002c0  c8 92 73 4c fc 5a 03 17  17 03 03 00 a3 24 2b 19  |..sL.Z.......$+.|
-000002d0  f9 ef c8 14 4e 1a 90 bc  2b a3 ff 95 52 99 b8 73  |....N...+...R..s|
-000002e0  49 10 fa 44 8e 39 a8 48  17 6c e6 7f bf 0d 93 95  |I..D.9.H.l......|
-000002f0  09 93 92 27 57 49 f2 79  16 36 2b 90 a9 1c 17 32  |...'WI.y.6+....2|
-00000300  a7 fa 2e 8d ca 68 40 09  dd c7 68 40 6a 2a 87 11  |.....h@...h@j*..|
-00000310  fc fc 2f fe e2 3a df 86  23 8b 4d 15 29 d9 a1 87  |../..:..#.M.)...|
-00000320  2b ac 58 72 eb c3 ac 3a  a2 30 6f 07 54 d1 72 ea  |+.Xr...:.0o.T.r.|
-00000330  7e 7b 7b 71 6c b6 57 64  d7 3f a6 59 f7 b0 8c 3f  |~{{ql.Wd.?.Y...?|
-00000340  8e d1 cb e6 75 f6 7d bf  43 cc be 35 a4 19 f9 48  |....u.}.C..5...H|
-00000350  c4 b7 bf 91 44 df 9a d5  97 7a f3 4c 98 08 b3 6e  |....D....z.L...n|
-00000360  a8 1c c6 d9 36 89 06 37  84 98 d3 e7 7c 11 f3 06  |....6..7....|...|
-00000370  17 03 03 00 35 9c d8 82  e3 d2 7b b5 48 1e 82 ee  |....5.....{.H...|
-00000380  05 ff a5 9f 3b bb 69 41  72 99 2e 78 57 d6 81 9c  |....;.iAr..xW...|
-00000390  57 36 f9 bf 52 cd 8d 30  f6 67 5e e3 30 12 2f f5  |W6..R..0.g^.0./.|
-000003a0  19 a1 27 97 af a8 1f c3  73 78                    |..'.....sx|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 67  |..+.....3.$... g|
+00000060  b0 dc 13 4f 2b 92 43 27  38 b5 2c 7a 3a 87 83 6f  |...O+.C'8.,z:..o|
+00000070  a1 cc 43 fa 90 9e 2e 4d  88 f6 60 d4 20 32 6a 14  |..C....M..`. 2j.|
+00000080  03 03 00 01 01 17 03 03  00 17 9b 51 d0 81 30 4b  |...........Q..0K|
+00000090  52 65 8b b5 fe 1a cc 44  c9 7a 10 83 41 0b 1a 00  |Re.....D.z..A...|
+000000a0  76 17 03 03 02 22 4e 55  d0 64 9c 41 c8 22 2c 9c  |v...."NU.d.A.",.|
+000000b0  0e 0a 0c 2b 2b 2e 6e 08  d5 54 75 61 99 bf ea f5  |...++.n..Tua....|
+000000c0  ca 12 3e 44 7f 81 a8 40  d1 7c 4d a0 a3 d2 f3 07  |..>D...@.|M.....|
+000000d0  40 af 68 81 69 dd 7c 77  24 26 87 73 73 5e d2 0c  |@.h.i.|w$&.ss^..|
+000000e0  2a 32 c5 34 50 ef a8 0f  63 12 3a 47 34 8f f2 c6  |*2.4P...c.:G4...|
+000000f0  9f bd 81 bf ea 69 47 04  8b 87 64 4e 67 81 10 a5  |.....iG...dNg...|
+00000100  f1 76 92 5e d6 11 a5 48  5b cc ef a8 43 dd cf f5  |.v.^...H[...C...|
+00000110  20 9d b8 2f f4 0d 92 10  55 af d1 fa ab 64 5f 99  | ../....U....d_.|
+00000120  3e 6b e9 70 70 f1 22 d9  05 04 89 3a fa 65 ae 91  |>k.pp."....:.e..|
+00000130  9d 07 ea 54 93 2d 02 0c  c0 70 d9 e9 f0 9a 5a 81  |...T.-...p....Z.|
+00000140  c6 c6 79 e0 e1 90 ad 34  78 bf d3 c8 9c 68 2e ac  |..y....4x....h..|
+00000150  e6 2d c0 e5 c8 3c 77 80  d7 dd e5 a4 ac b8 36 4f  |.-...<w.......6O|
+00000160  9f 47 3e 40 bf 95 49 3c  1a e7 46 57 c8 59 65 e7  |.G>@..I<..FW.Ye.|
+00000170  4e db 21 ea ab 72 47 79  e6 c1 4f ea 17 e3 b4 73  |N.!..rGy..O....s|
+00000180  9d e2 e5 72 be 88 0a 60  1e 35 02 67 33 a0 7a 05  |...r...`.5.g3.z.|
+00000190  b8 ae 05 b2 53 6c cd c5  e3 a5 16 56 2b b0 0e 8e  |....Sl.....V+...|
+000001a0  a0 ca 54 c0 34 6b 00 22  69 de e1 57 81 48 c6 1a  |..T.4k."i..W.H..|
+000001b0  cc 88 f6 15 1c 7e b6 1f  b0 48 82 75 6b ff 42 78  |.....~...H.uk.Bx|
+000001c0  f9 85 10 86 5b af 31 62  f6 7b d4 8a a6 86 3f 99  |....[.1b.{....?.|
+000001d0  9b ce 91 c0 4d 44 5b 3f  16 81 d0 a9 4a e0 2d 85  |....MD[?....J.-.|
+000001e0  a4 80 91 64 13 20 33 dc  84 48 da 79 2e 73 cb 78  |...d. 3..H.y.s.x|
+000001f0  9c 05 8a 6c 42 ce b0 b0  45 3c 05 47 47 f7 92 3b  |...lB...E<.GG..;|
+00000200  d2 fb 65 f0 40 a3 52 b7  aa 04 ae 71 84 35 12 7a  |..e.@.R....q.5.z|
+00000210  33 f8 8b 0d 21 a3 29 ad  78 de df 7f 53 71 fb 5f  |3...!.).x...Sq._|
+00000220  a5 ab 07 89 3a 1f e9 ca  6d 8d bb 04 39 8d b3 50  |....:...m...9..P|
+00000230  7e 2e bd 0f b8 ff 4f 3f  d1 a5 23 b9 80 33 da b0  |~.....O?..#..3..|
+00000240  2c dc 0f c2 26 b2 cf 59  d9 10 ef 66 52 40 e4 54  |,...&..Y...fR@.T|
+00000250  28 5e 7f c1 94 62 8f 4f  9b 94 fc c9 32 af f5 17  |(^...b.O....2...|
+00000260  5d 04 32 08 83 f4 90 68  68 01 d3 00 ed 82 f3 da  |].2....hh.......|
+00000270  81 2e d5 df 1e 13 c3 c3  76 83 c4 67 23 c4 32 c0  |........v..g#.2.|
+00000280  59 5d dd 56 78 d9 74 ef  7b d5 c9 13 4d 62 29 85  |Y].Vx.t.{...Mb).|
+00000290  ca 24 53 1a b1 2b 09 a1  a6 26 db 13 cf 2a 2b 92  |.$S..+...&...*+.|
+000002a0  85 a3 51 2b 24 e1 90 2a  fe 0c 74 ee 86 cc 3b 6a  |..Q+$..*..t...;j|
+000002b0  07 21 a6 b6 97 a4 e0 9f  3d 75 9a 2b 9e 91 ef d8  |.!......=u.+....|
+000002c0  c9 94 28 ba 40 e4 cc 6a  17 03 03 00 a4 ab c3 c1  |..(.@..j........|
+000002d0  32 1d 44 0d f7 85 e3 85  df 9e bb 0c 82 18 a2 9f  |2.D.............|
+000002e0  27 de 78 4f 06 9b 43 59  27 b5 8e 34 4d 96 b3 96  |'.xO..CY'..4M...|
+000002f0  af 8b 98 d0 36 91 52 df  9c aa c2 fe e7 0f ed ca  |....6.R.........|
+00000300  ef 57 73 97 cc c8 dc 7c  c8 15 73 ad a6 3e 54 93  |.Ws....|..s..>T.|
+00000310  1a ab 72 f6 e0 e3 cb bb  fe a5 d1 45 47 f3 1a 89  |..r........EG...|
+00000320  40 f7 9d f5 e4 61 16 fa  12 0a 62 24 a7 34 ab 6f  |@....a....b$.4.o|
+00000330  08 85 b2 fe b2 5c 49 59  7b cb 05 b2 e3 1a 37 79  |.....\IY{.....7y|
+00000340  b1 27 28 a5 ab ee ae 72  11 19 61 c0 3b ed 32 ec  |.'(....r..a.;.2.|
+00000350  57 26 76 8e 42 3c 98 4a  ec 10 4e e0 eb e2 19 3d  |W&v.B<.J..N....=|
+00000360  67 47 99 9c e5 97 a4 07  ff 7a b5 15 65 0e b9 e4  |gG.......z..e...|
+00000370  e3 17 03 03 00 35 61 d9  d8 36 a0 1e 83 b0 f8 1f  |.....5a..6......|
+00000380  74 61 a0 4b 93 7f 98 8b  63 1c 63 82 f4 cd 57 8d  |ta.K....c.c...W.|
+00000390  1f 75 7a 6d a9 1d e2 35  0b 2b 9a 5f 5f 71 cd 46  |.uzm...5.+.__q.F|
+000003a0  48 7f 27 af a5 da 8b 35  b1 18 39                 |H.'....5..9|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 c8 b8 4f 16 71  |..........5..O.q|
-00000010  03 a4 39 02 a9 6e 62 a5  62 8e 64 7d 13 8c 11 66  |..9..nb.b.d}...f|
-00000020  f2 6c 24 36 5b 9c 95 6b  5b ea fc 66 a2 ef 7c 97  |.l$6[..k[..f..|.|
-00000030  0c 75 7a 05 99 21 ff af  fc 91 b3 64 74 64 89 76  |.uz..!.....dtd.v|
-00000040  17 03 03 00 17 3f b3 8e  94 d5 bd e2 79 9c e5 d3  |.....?......y...|
-00000050  f7 3d bd aa 6a 35 5a 1a  0b 96 69 3d 17 03 03 00  |.=..j5Z...i=....|
-00000060  13 d7 34 66 9d 25 f2 de  49 40 34 20 a5 0c 88 b5  |..4f.%..I@4 ....|
-00000070  00 e8 ac ee                                       |....|
+00000000  14 03 03 00 01 01 17 03  03 00 35 3d 13 d4 8c 88  |..........5=....|
+00000010  73 62 97 8b 18 04 f7 05  8d c8 56 d2 f4 0a 86 93  |sb........V.....|
+00000020  d4 6f 08 1c d8 7f 57 be  50 03 a7 4a c8 37 80 04  |.o....W.P..J.7..|
+00000030  43 1b 2a 86 21 25 ae 84  53 80 0c f6 4f 2e 73 67  |C.*.!%..S...O.sg|
+00000040  17 03 03 00 17 43 99 86  f2 2f a2 22 05 36 d8 47  |.....C.../.".6.G|
+00000050  c5 57 92 93 c7 79 d9 fd  13 70 8f 75 17 03 03 00  |.W...y...p.u....|
+00000060  13 15 90 47 ea af 57 89  d4 19 70 e7 e1 ce 68 8a  |...G..W...p...h.|
+00000070  7b 83 8c a5                                       |{...|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-Ed25519 b/src/crypto/tls/testdata/Client-TLSv13-Ed25519
index 04c26cb654..274620a257 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-Ed25519
+++ b/src/crypto/tls/testdata/Client-TLSv13-Ed25519
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,65 +7,64 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 41 2a 70 9e fa  |....z...v..A*p..|
-00000010  49 ab 26 ea 07 12 90 9f  e9 be 67 21 3a 0f e8 c9  |I.&.......g!:...|
-00000020  54 97 77 ce d4 54 04 0d  2d b6 1a 20 00 00 00 00  |T.w..T..-.. ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 5a e2 b6 f0 cf  |....z...v..Z....|
+00000010  f2 85 49 e0 28 8c d7 89  41 39 5f a4 e8 41 9b f6  |..I.(...A9_..A..|
+00000020  1d 2b 3a 8a 3e a3 40 29  76 17 22 20 00 00 00 00  |.+:.>.@)v." ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 28  |..+.....3.$... (|
-00000060  42 18 1f f9 3f 73 01 41  63 08 8d a1 1a a5 8b 5f  |B...?s.Ac......_|
-00000070  d0 63 44 21 d2 fc d8 7e  46 9f 66 62 0d c0 19 14  |.cD!...~F.fb....|
-00000080  03 03 00 01 01 17 03 03  00 17 66 d5 4f 1f 0b 85  |..........f.O...|
-00000090  65 0a 81 21 55 2f 17 bc  ad e1 83 69 29 51 6b 7f  |e..!U/.....i)Qk.|
-000000a0  15 17 03 03 01 50 b2 f9  51 18 c9 23 24 91 b8 b0  |.....P..Q..#$...|
-000000b0  32 8d 3c 81 8a ca c3 25  8a 1f cc 17 d1 67 07 42  |2.<....%.....g.B|
-000000c0  7b 82 ae 1f b8 65 55 e2  ce 2e ad d3 90 bf 3f 2d  |{....eU.......?-|
-000000d0  85 dc 68 3a 4c 1a 79 9e  cc 86 d3 20 7b 7e ba b4  |..h:L.y.... {~..|
-000000e0  cf 8b 4b f8 9b 58 0f 7f  24 cc aa 80 4b be 8f 3e  |..K..X..$...K..>|
-000000f0  88 1e b1 10 0b 8c 74 6b  2e ad 8d c9 40 e1 3f 4a  |......tk....@.?J|
-00000100  90 5c 97 79 f4 aa 62 e1  e1 2e e4 f4 22 ce ab 85  |.\.y..b....."...|
-00000110  d6 ac e1 d8 21 f8 ed 70  3e 92 0d 2c b2 39 f9 a5  |....!..p>..,.9..|
-00000120  da ce 3e ff 76 09 54 10  35 86 80 f8 fa 86 44 a1  |..>.v.T.5.....D.|
-00000130  78 7c 9c a8 15 c9 55 92  e8 14 0d 99 c8 40 7c f7  |x|....U......@|.|
-00000140  d9 d6 cd ae bf 05 f9 da  0f 33 b1 ee ae 39 bb 30  |.........3...9.0|
-00000150  3c f2 3d e4 0a b7 e1 e7  6a 5f 48 65 a6 28 37 26  |<.=.....j_He.(7&|
-00000160  c1 18 0b 31 f2 79 00 fd  25 d6 76 8f 7b bc 7e 2e  |...1.y..%.v.{.~.|
-00000170  3d f2 bb b2 1a 5f 1b 7d  df b5 f5 bb b2 e7 1b 51  |=...._.}.......Q|
-00000180  de cc 4d 2b 32 c6 cd 33  97 32 d3 c8 02 89 a2 0a  |..M+2..3.2......|
-00000190  a2 6a 2c d4 6f b8 97 3b  7d bf 42 18 97 a3 2d 51  |.j,.o..;}.B...-Q|
-000001a0  70 a7 f0 9f 04 2a a0 6f  2f 30 7c fe b6 fc dd c5  |p....*.o/0|.....|
-000001b0  6a 65 e3 a2 7a c0 d8 31  37 3f c0 36 79 d2 a0 20  |je..z..17?.6y.. |
-000001c0  7d 4e ea 8c 44 77 53 e9  db 90 ef 24 26 05 ce b0  |}N..DwS....$&...|
-000001d0  9e 18 a9 8f 21 55 b6 40  63 b5 4c f6 74 2d 4a c5  |....!U.@c.L.t-J.|
-000001e0  7f 67 ee 95 35 21 e0 22  61 c5 68 5f e7 b3 ac 4d  |.g..5!."a.h_...M|
-000001f0  4e e5 31 bb 10 22 17 03  03 00 59 ab 04 24 cb f7  |N.1.."....Y..$..|
-00000200  33 03 08 97 0b d5 9e a7  23 18 ec b6 f6 e8 ee 1f  |3.......#.......|
-00000210  2d 5f 6b 73 92 ce ac 3b  59 50 27 77 ac 73 ac fe  |-_ks...;YP'w.s..|
-00000220  b1 5a 8e 9e 81 50 54 4d  3b f7 7b 1e f9 f9 c1 d5  |.Z...PTM;.{.....|
-00000230  c6 08 b5 88 55 96 13 c6  d4 f6 cd b5 5d 5a 27 ae  |....U.......]Z'.|
-00000240  27 95 e0 55 0e c5 fe 6b  9a ae 3d f8 3a b9 05 f6  |'..U...k..=.:...|
-00000250  ef 90 99 30 17 03 03 00  35 54 af 85 8b 06 b2 ee  |...0....5T......|
-00000260  a8 6f 18 76 9b 9a ea 2e  57 b9 2c 9e a7 56 6c 49  |.o.v....W.,..VlI|
-00000270  ab 6e 10 4e fc c8 9c 37  b3 dc 95 8b 74 07 e9 90  |.n.N...7....t...|
-00000280  a3 35 72 b4 60 9a ea 87  a7 76 72 42 7d b7        |.5r.`....vrB}.|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 d1  |..+.....3.$... .|
+00000060  41 fa 43 c4 c8 0a 98 e0  da 88 c8 58 36 ab 12 61  |A.C........X6..a|
+00000070  d5 2d 9a 5b 10 fd 1f 10  bf d4 df 23 d0 de 2c 14  |.-.[.......#..,.|
+00000080  03 03 00 01 01 17 03 03  00 17 bf 64 74 65 06 48  |...........dte.H|
+00000090  41 72 b9 9f 41 24 a9 d0  05 00 4e 8c 93 a8 bd 91  |Ar..A$....N.....|
+000000a0  ce 17 03 03 01 50 20 58  c1 4f 42 ed e9 e6 50 86  |.....P X.OB...P.|
+000000b0  5f 49 88 ac 8b b8 3d 25  1d 87 b5 7f 9f 1a a2 cd  |_I....=%........|
+000000c0  f2 90 d0 6d 13 ed a6 6c  f9 1e af c8 73 dd 68 d4  |...m...l....s.h.|
+000000d0  46 1f ce d4 74 87 57 0f  c1 b7 dd bd 5a 44 7c 08  |F...t.W.....ZD|.|
+000000e0  2d 60 ca 34 1f 94 ee 4a  cd e7 4a 69 1c 8d 4c 64  |-`.4...J..Ji..Ld|
+000000f0  e8 a1 90 89 75 e2 3b 5b  0e 58 f8 7a 0a fe 2d 6d  |....u.;[.X.z..-m|
+00000100  ee 82 ab 07 e3 09 ae 37  d5 d6 31 9f 47 a5 eb ca  |.......7..1.G...|
+00000110  fd d9 5e b3 f1 ab 8a 64  8f 66 7d e7 a5 66 b4 46  |..^....d.f}..f.F|
+00000120  3c 3c 2c 2f f7 5a 46 b3  e7 8b a4 3e 5f 21 ab 66  |<<,/.ZF....>_!.f|
+00000130  60 4d ca 20 4b 7b 75 5a  88 a5 65 97 1b 70 5b 69  |`M. K{uZ..e..p[i|
+00000140  7b 22 87 48 e4 a2 a8 32  06 65 00 91 e6 ac 6c 9b  |{".H...2.e....l.|
+00000150  42 04 53 f5 e5 46 72 d6  3a 7d d8 c1 e4 f1 79 dc  |B.S..Fr.:}....y.|
+00000160  de 7b 21 83 d0 98 90 99  2d 9d 78 67 89 31 2a 7d  |.{!.....-.xg.1*}|
+00000170  6a 97 c7 80 a9 2a 91 4e  e2 30 29 96 25 97 e9 94  |j....*.N.0).%...|
+00000180  2d 0a e0 30 8c e3 54 00  2a 29 e9 60 ef 4c 60 1c  |-..0..T.*).`.L`.|
+00000190  76 51 db 5d d7 7c 0c ae  f3 a8 9e 3b 49 c6 a7 ce  |vQ.].|.....;I...|
+000001a0  a3 e8 e6 8c 13 ea fa bd  7f 59 36 06 1e 0c 54 2d  |.........Y6...T-|
+000001b0  d2 75 8a 75 94 f3 5c 77  0a 8e a0 23 9f 21 d8 ed  |.u.u..\w...#.!..|
+000001c0  65 87 fa f0 65 e1 81 2b  45 50 91 9e 48 8f 4c 80  |e...e..+EP..H.L.|
+000001d0  7a c7 32 07 9a d9 d4 59  7a 7c 11 01 c2 75 fd 25  |z.2....Yz|...u.%|
+000001e0  15 7b de b1 72 54 42 9e  02 41 a8 1a 04 6a 64 ba  |.{..rTB..A...jd.|
+000001f0  97 48 48 48 24 3d 17 03  03 00 59 d7 53 12 64 01  |.HHH$=....Y.S.d.|
+00000200  d4 b7 e4 bf e1 33 f6 49  24 cf e8 6f 48 56 d6 1b  |.....3.I$..oHV..|
+00000210  e3 11 e9 a5 fb 7d f7 f5  b7 06 6c ce 4d e7 3c ca  |.....}....l.M.<.|
+00000220  bc 30 27 2e 02 4a 50 ec  7e 8c d4 cd 7a 78 43 3f  |.0'..JP.~...zxC?|
+00000230  5d 17 d7 bd 3e 78 68 21  ad 98 93 ad 90 de f7 c9  |]...>xh!........|
+00000240  ab 7d 36 59 7e 7b e8 10  92 de ee 44 a2 e3 df 41  |.}6Y~{.....D...A|
+00000250  6c a8 6c 9b 17 03 03 00  35 3a 9b 88 fc 4d 78 aa  |l.l.....5:...Mx.|
+00000260  a3 96 c7 f9 80 87 75 88  41 e6 58 9c f7 f6 88 0c  |......u.A.X.....|
+00000270  8f 57 8f 41 b7 49 a9 c2  db d6 44 51 a6 cb eb c3  |.W.A.I....DQ....|
+00000280  8d e5 32 19 4b e5 dd 4e  19 6b f4 38 cd 3d        |..2.K..N.k.8.=|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 70 04 7a 93 3e  |..........5p.z.>|
-00000010  de c0 df 1d 2b 25 ea c4  7d 57 eb 94 59 80 2c d6  |....+%..}W..Y.,.|
-00000020  80 0e 5e 9f 22 00 82 1c  e0 2e 15 1e 5d b6 16 84  |..^.".......]...|
-00000030  83 83 79 29 54 49 dc bb  b8 f0 f8 71 13 09 7d e9  |..y)TI.....q..}.|
-00000040  17 03 03 00 17 93 e8 8f  30 24 3b e7 5e a4 15 b3  |........0$;.^...|
-00000050  f6 53 15 d6 f8 4c ab 0c  32 d6 28 ef 17 03 03 00  |.S...L..2.(.....|
-00000060  13 2b ea 8e 10 9d 46 08  d9 43 04 da d8 5a 78 f8  |.+....F..C...Zx.|
-00000070  33 c0 62 33                                       |3.b3|
+00000000  14 03 03 00 01 01 17 03  03 00 35 64 73 84 51 69  |..........5ds.Qi|
+00000010  81 4c a7 ce 8b 39 08 0e  0f 25 d2 24 49 3c 9d 98  |.L...9...%.$I<..|
+00000020  c7 46 f5 7e ba bd d1 9d  79 d3 f6 cb 29 00 95 90  |.F.~....y...)...|
+00000030  c2 fa c6 65 01 f2 9d 12  a7 db 14 49 e6 0b 40 c9  |...e.......I..@.|
+00000040  17 03 03 00 17 df ad 2a  5f f7 bd 94 90 dd 11 24  |.......*_......$|
+00000050  b8 97 6e fc d3 93 91 47  36 26 2d e1 17 03 03 00  |..n....G6&-.....|
+00000060  13 40 ad 3c c3 49 76 47  c0 02 f0 bc 80 66 3c e4  |.@.<.IvG.....f<.|
+00000070  35 28 eb b5                                       |5(..|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ExportKeyingMaterial b/src/crypto/tls/testdata/Client-TLSv13-ExportKeyingMaterial
index ef0029ff07..13fb604874 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ExportKeyingMaterial
+++ b/src/crypto/tls/testdata/Client-TLSv13-ExportKeyingMaterial
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,87 +7,86 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 3e 1e de 6b d3  |....z...v..>..k.|
-00000010  83 f0 87 bd 4c 26 fe 68  40 01 f3 c6 c8 39 b4 b3  |....L&.h@....9..|
-00000020  46 c7 ae 97 1a b2 67 a0  6a 7f 93 20 00 00 00 00  |F.....g.j.. ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 67 c5 21 e2 8b  |....z...v..g.!..|
+00000010  b6 6a cc 42 40 24 b2 4f  55 61 d9 20 78 e2 e3 40  |.j.B@$.OUa. x..@|
+00000020  83 62 3d 08 e3 0a 31 0b  55 f5 b6 20 00 00 00 00  |.b=...1.U.. ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 6a  |..+.....3.$... j|
-00000060  bc 9c e7 36 da f4 e7 90  ca e8 12 65 27 0c f0 b4  |...6.......e'...|
-00000070  e9 e4 e8 b9 6e 4c 2c 56  29 7d 97 e5 89 d6 71 14  |....nL,V)}....q.|
-00000080  03 03 00 01 01 17 03 03  00 17 14 a3 91 83 8e 8b  |................|
-00000090  cb 7b 17 d0 1d 4b 37 bb  94 3f c1 18 44 7f ac 57  |.{...K7..?..D..W|
-000000a0  0d 17 03 03 02 6d 60 0a  40 97 d6 cb 85 46 8c 9b  |.....m`.@....F..|
-000000b0  fd c6 3b 03 02 e4 57 84  00 f8 b4 8e 25 0c 85 21  |..;...W.....%..!|
-000000c0  70 bc 17 c2 32 57 46 63  a9 42 32 c6 fb 6c b1 7c  |p...2WFc.B2..l.||
-000000d0  be 7d 4d 37 9c 72 42 ca  02 39 43 9e 70 4c 73 f6  |.}M7.rB..9C.pLs.|
-000000e0  72 45 91 f4 72 8b dc cd  c4 25 68 77 d6 91 62 8f  |rE..r....%hw..b.|
-000000f0  f1 88 ee 92 f8 ce 4c dd  86 d0 eb c7 c7 75 48 fe  |......L......uH.|
-00000100  3c 27 48 f7 6c 3e 2e 18  64 02 82 0f 08 6f 93 1c  |<'H.l>..d....o..|
-00000110  15 bb d0 06 36 1c a9 ab  5e 76 b5 7b f1 fa 0b 27  |....6...^v.{...'|
-00000120  09 01 23 58 1d 5e 8e 7c  a9 ba 87 de c2 05 31 a5  |..#X.^.|......1.|
-00000130  7a 20 cc 4c 4a 72 65 3b  8a a5 66 b6 d3 49 10 49  |z .LJre;..f..I.I|
-00000140  7c 3d 27 13 88 01 48 65  41 5d 25 b7 6a 96 78 86  ||='...HeA]%.j.x.|
-00000150  03 d7 53 7b 9c fb db db  c8 d7 5e 71 f4 6c 03 49  |..S{......^q.l.I|
-00000160  6b e3 0d a4 07 ac 7c 45  b7 98 d1 0d 24 72 93 1d  |k.....|E....$r..|
-00000170  f3 f6 51 3b 5f 08 43 fe  5b db 1a ad 84 10 bd d1  |..Q;_.C.[.......|
-00000180  88 fe 24 83 e3 46 d1 40  a0 c0 e9 dc 19 75 b2 8f  |..$..F.@.....u..|
-00000190  5e ea 67 2e 0e a3 79 bd  9f 92 f4 0a d0 fd f0 26  |^.g...y........&|
-000001a0  f9 40 d1 3c 76 03 61 ab  11 d1 c6 22 e2 62 ea 35  |.@.<v.a....".b.5|
-000001b0  bf e5 22 17 1b 6a be bf  0b 8f 3b ae 3e 87 1f 40  |.."..j....;.>..@|
-000001c0  79 1f 3b 1f 56 6f b7 98  e1 6e bb 4c 0a 11 cf 1c  |y.;.Vo...n.L....|
-000001d0  68 a2 87 a6 83 72 ab d1  a8 4f 39 48 fc d0 54 bf  |h....r...O9H..T.|
-000001e0  47 7f 7c 8f 91 7d 40 96  01 b0 ec 62 b0 16 b8 d3  |G.|..}@....b....|
-000001f0  02 15 68 e0 7e d7 40 0a  9f 5e cf 21 75 40 d6 4c  |..h.~.@..^.!u@.L|
-00000200  50 c0 05 8f 8e db b5 44  d3 50 24 be c3 7b 5d 39  |P......D.P$..{]9|
-00000210  a5 cb 92 d5 dd 4b 16 c2  6a ec e5 f6 79 6d 04 6f  |.....K..j...ym.o|
-00000220  26 fd 55 ba 8a 38 db ab  dd 78 13 a7 de 23 e7 c0  |&.U..8...x...#..|
-00000230  c6 97 34 18 26 2e d0 ef  b0 d7 1a 3c af cc 2f 79  |..4.&......<../y|
-00000240  ea cd d3 b2 02 99 5a ca  c8 49 39 f7 df 64 5d 1a  |......Z..I9..d].|
-00000250  89 59 92 33 e8 ae 19 ca  42 53 c0 1a 18 6b 9e 8f  |.Y.3....BS...k..|
-00000260  65 64 b3 b3 6f 4c c8 7c  46 fb 2f 0a ad ed ef 15  |ed..oL.|F./.....|
-00000270  14 dd dd ae b0 09 d4 5a  ba 2e 78 a2 3e 8e d4 35  |.......Z..x.>..5|
-00000280  a2 96 a1 a2 08 f8 0c c6  a3 13 be 09 b8 5f 00 04  |............._..|
-00000290  22 78 98 cf 41 24 40 e9  93 4e b0 86 15 e1 5e c2  |"x..A$@..N....^.|
-000002a0  cf c3 49 51 1a d8 a1 e6  c0 a9 ea 35 b2 56 ee 2d  |..IQ.......5.V.-|
-000002b0  08 4e 3b 3d 03 cb f1 54  94 a0 d5 6a 9c bc d8 7c  |.N;=...T...j...||
-000002c0  f1 22 10 0a 5c d9 66 87  fa e2 8e e8 41 cc ce cd  |."..\.f.....A...|
-000002d0  a9 c2 c7 11 4c e2 e4 20  70 ae aa d1 1e 47 b7 ee  |....L.. p....G..|
-000002e0  b3 45 18 3a a9 31 44 bb  b0 7f 73 6a df 2a 67 00  |.E.:.1D...sj.*g.|
-000002f0  81 c6 da 9d 8b 65 98 f8  b8 e5 fb da 85 cc 68 c2  |.....e........h.|
-00000300  77 ed d5 14 a8 32 74 b1  d1 9c 89 1c 3e b8 d9 d4  |w....2t.....>...|
-00000310  89 8d d5 17 03 03 00 99  1c 42 3c cc 38 4d ed 1e  |.........B<.8M..|
-00000320  14 2e cb e7 a4 43 64 95  a5 8f c6 ff 81 a1 4f d8  |.....Cd.......O.|
-00000330  2a 1e 82 cf 4c 6a a2 32  ee 3b 8e f9 d5 63 99 2b  |*...Lj.2.;...c.+|
-00000340  7a 7e 4c 9b 1a c8 48 78  4f 8e ad af ea 3a 60 65  |z~L...HxO....:`e|
-00000350  b6 05 62 78 36 5f c1 40  e3 16 f2 be 48 41 ca a6  |..bx6_.@....HA..|
-00000360  e1 10 e4 fe 14 0b 59 6d  da fc 35 1e f5 eb fc 71  |......Ym..5....q|
-00000370  08 49 a4 04 55 df 5e 09  cc 48 79 ba 3b e6 12 20  |.I..U.^..Hy.;.. |
-00000380  4e 57 b3 22 a0 4f 62 b9  30 e3 1c 3e ed 95 6c c7  |NW.".Ob.0..>..l.|
-00000390  49 a3 b4 c5 2d 25 11 18  94 7b 10 43 d3 fe de 98  |I...-%...{.C....|
-000003a0  74 65 c1 cd d2 d1 67 a1  86 03 a4 7e 12 88 0e 6e  |te....g....~...n|
-000003b0  49 17 03 03 00 35 d3 c7  fa 89 82 0d 80 29 53 f8  |I....5.......)S.|
-000003c0  49 ba 86 1f aa dd ec d4  4c 8d cc a4 88 95 27 a8  |I.......L.....'.|
-000003d0  23 dc b2 09 e6 d3 47 34  fa e1 0c 5c 01 ae 95 a0  |#.....G4...\....|
-000003e0  4d 1c 42 fe e7 d6 ed cb  a7 83 fd                 |M.B........|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 ba  |..+.....3.$... .|
+00000060  d1 5b 5d b4 ca a0 c2 a8  20 f2 d4 12 03 c1 95 ba  |.[]..... .......|
+00000070  f0 ca 33 f0 22 56 f6 15  2c 15 b9 7b c6 78 6a 14  |..3."V..,..{.xj.|
+00000080  03 03 00 01 01 17 03 03  00 17 da b1 6a 79 21 51  |............jy!Q|
+00000090  6b 2a 57 47 22 f1 be 5d  24 36 ec 0f 82 fd bf b8  |k*WG"..]$6......|
+000000a0  5e 17 03 03 02 6d e7 ed  1e c2 be f9 15 80 5e 01  |^....m........^.|
+000000b0  73 b7 57 07 40 68 ae 88  d6 43 eb 6b fb 0c a3 4e  |s.W.@h...C.k...N|
+000000c0  b3 86 9d 5b 92 8a 1c da  a2 9b a5 11 a3 e4 4e 2c  |...[..........N,|
+000000d0  8d 3f 96 20 ec 13 e8 ea  10 47 4a 4a cd 64 ad f9  |.?. .....GJJ.d..|
+000000e0  48 af 11 58 ff 2f cd 29  6e 8e 0f fc 31 96 29 b4  |H..X./.)n...1.).|
+000000f0  df 57 e4 e9 65 62 b5 35  8e 7f a0 36 1d b1 fd 19  |.W..eb.5...6....|
+00000100  c1 b8 7e d9 59 44 a8 3c  97 15 57 fa 64 95 c8 ff  |..~.YD.<..W.d...|
+00000110  db a5 12 85 86 2c aa bc  87 f1 7e f3 2c 08 64 05  |.....,....~.,.d.|
+00000120  4a b1 8e a3 6a 26 e3 e8  fd 80 47 3c 9c a3 4a bb  |J...j&....G<..J.|
+00000130  73 9b 5d 6e 18 06 ac e5  63 de a8 53 e4 a1 b0 41  |s.]n....c..S...A|
+00000140  6a 88 ab 91 94 df 77 55  11 eb 29 97 69 59 67 19  |j.....wU..).iYg.|
+00000150  b3 23 df bf 2c ac 15 03  77 88 ad bf df 8d 4e 96  |.#..,...w.....N.|
+00000160  59 86 9b 77 e9 74 fc 29  c6 cd 65 c9 aa 7a 36 9b  |Y..w.t.)..e..z6.|
+00000170  11 f8 47 fd 8b 59 8b 26  8c f4 f1 f1 38 12 0e 02  |..G..Y.&....8...|
+00000180  e8 27 f2 ce bc 4a be c3  22 ff ae ce ef 31 d0 4c  |.'...J.."....1.L|
+00000190  d2 13 b3 1b 40 fd a0 c0  e9 f3 00 54 cf b8 9c 9d  |....@......T....|
+000001a0  2c 4b de 9a f8 82 11 e7  ea eb cf 45 99 a2 f8 ff  |,K.........E....|
+000001b0  53 71 e5 e0 bd f1 bb 4e  eb 39 7f 85 c4 e9 0d c0  |Sq.....N.9......|
+000001c0  46 de b4 1b 0e 1f 18 8c  5b cf 12 03 8a 91 06 23  |F.......[......#|
+000001d0  3f f3 54 3e e9 e6 e1 2c  84 d3 4e cc 16 f6 aa 92  |?.T>...,..N.....|
+000001e0  6b 24 30 5d f8 a0 52 ca  02 9a 50 58 43 b6 22 04  |k$0]..R...PXC.".|
+000001f0  47 c6 ba 1c e1 aa c2 2c  ca 50 13 de 2b 2b 34 ec  |G......,.P..++4.|
+00000200  80 8c 34 77 20 ab f3 f3  42 d2 9a 2b 9d 38 32 f9  |..4w ...B..+.82.|
+00000210  de 9c 7b ee 22 4f 41 9e  ea 35 88 8c e7 74 f6 ac  |..{."OA..5...t..|
+00000220  a5 fe af d9 c4 b1 a4 87  aa 9f d9 02 3b 4b 92 2b  |............;K.+|
+00000230  f4 ea 6f 81 b8 54 ca 77  3d a2 37 f0 60 d8 26 e4  |..o..T.w=.7.`.&.|
+00000240  27 04 c8 5b bf bc 5e 9c  8b a9 f6 c1 58 31 de 48  |'..[..^.....X1.H|
+00000250  67 5b c5 d7 ae 35 cc d8  8d 01 9b e0 d0 c7 33 f8  |g[...5........3.|
+00000260  36 c1 e8 50 32 27 87 6c  64 71 27 3f 66 82 fa 92  |6..P2'.ldq'?f...|
+00000270  d3 fe b9 9e d3 e2 63 43  64 13 73 4b e9 34 d9 ae  |......cCd.sK.4..|
+00000280  49 dd 9c 17 f3 a6 34 27  3e 07 68 ed 6b 98 0a 69  |I.....4'>.h.k..i|
+00000290  9c f5 4f 1e fc ac 72 08  7e bb bd 97 fe f9 c1 09  |..O...r.~.......|
+000002a0  a2 69 75 c4 e7 a1 83 df  03 0f 74 21 e8 4c 4c d7  |.iu.......t!.LL.|
+000002b0  a2 90 5a 4d d9 a2 fa f1  e4 dc ff 75 e8 fe a1 91  |..ZM.......u....|
+000002c0  46 a4 c2 0b c3 9e 83 45  40 b4 ba fe ed 9e 3a 81  |F......E@.....:.|
+000002d0  a9 27 b9 fa 6f 9e 38 10  2f e6 05 9a 00 43 e9 fb  |.'..o.8./....C..|
+000002e0  60 b8 26 2e 18 4a 0c 14  6a 9f aa 26 1d 53 9e 4f  |`.&..J..j..&.S.O|
+000002f0  fc 7e e1 90 60 28 b1 89  db b6 68 58 5d 2a fa 43  |.~..`(....hX]*.C|
+00000300  91 99 c1 94 74 77 a9 30  cf 1e 9d 49 fc cd be 6c  |....tw.0...I...l|
+00000310  5a 72 90 17 03 03 00 99  1b 1f 16 9b 8e 85 5a 8a  |Zr............Z.|
+00000320  3c c7 d8 e5 86 20 eb 71  83 12 e7 3b 02 ca a1 18  |<.... .q...;....|
+00000330  aa b7 ef 67 9d bf 57 46  14 3b ed b2 9b 2e f1 96  |...g..WF.;......|
+00000340  67 b0 cc 20 ab 67 63 5c  a9 96 d8 22 8e fa f0 94  |g.. .gc\..."....|
+00000350  1e 83 6c 53 8a 75 a5 37  1d f1 de 1f a7 22 13 08  |..lS.u.7....."..|
+00000360  b7 13 dd 25 26 eb 7a 85  72 33 ed a8 27 be cc ff  |...%&.z.r3..'...|
+00000370  8d 42 fa 6a f8 0a 59 44  6f 48 4d 58 27 d5 28 fb  |.B.j..YDoHMX'.(.|
+00000380  37 b0 85 25 49 d0 32 7c  dd b8 46 1a aa dc 16 b7  |7..%I.2|..F.....|
+00000390  f2 fd 99 17 67 41 c0 2d  75 0d 66 ef 65 e2 5f af  |....gA.-u.f.e._.|
+000003a0  d8 b4 aa 15 1c 24 40 0d  0d 4f a8 bc c9 92 1c ab  |.....$@..O......|
+000003b0  91 17 03 03 00 35 f9 69  7e 2a d6 fa 6e 42 25 6c  |.....5.i~*..nB%l|
+000003c0  da 96 f7 79 5f 02 44 1f  d8 1c a2 41 fc eb a5 12  |...y_.D....A....|
+000003d0  bf 37 ab b0 40 92 55 50  64 8e 7b e9 e5 f3 04 b5  |.7..@.UPd.{.....|
+000003e0  0f 04 93 98 fa ca 24 69  a1 73 26                 |......$i.s&|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 b4 e6 ba 4c 98  |..........5...L.|
-00000010  46 1c 04 eb 9a 06 4a ef  8c 2a 6e 9a 69 35 78 4c  |F.....J..*n.i5xL|
-00000020  9a 5e 43 93 11 d8 8d a5  c9 d0 1a db b6 ef 65 ec  |.^C...........e.|
-00000030  a9 21 e4 0f a6 3e 0a c1  a0 a1 49 35 c3 e7 d9 20  |.!...>....I5... |
-00000040  17 03 03 00 17 d7 8d d4  53 d5 40 dc ae d6 73 24  |........S.@...s$|
-00000050  f8 f5 65 4e 0f 8d a6 f0  9d 4a e1 5b 17 03 03 00  |..eN.....J.[....|
-00000060  13 fd e0 76 85 ee 46 e9  d4 3c 0d 05 56 9b b3 5b  |...v..F..<..V..[|
-00000070  9c 42 de d4                                       |.B..|
+00000000  14 03 03 00 01 01 17 03  03 00 35 80 f8 9b f1 1d  |..........5.....|
+00000010  89 31 a8 ea b8 cc 44 a7  6c c3 f7 ea 0f fd f4 a3  |.1....D.l.......|
+00000020  4c c2 15 06 bd 79 16 90  a1 bf 44 df e5 21 03 ff  |L....y....D..!..|
+00000030  e5 83 08 67 70 09 11 21  8e 96 47 e6 f4 e3 36 6e  |...gp..!..G...6n|
+00000040  17 03 03 00 17 7b 87 be  4e f8 ce 6f 30 b8 5b 95  |.....{..N..o0.[.|
+00000050  20 79 23 f7 50 6b 17 b8  13 a2 38 6a 17 03 03 00  | y#.Pk....8j....|
+00000060  13 2a d5 e0 a4 17 7d 4f  3b 5a 6c bc 9d 5a 79 5b  |.*....}O;Zl..Zy[|
+00000070  a8 f6 b2 4a                                       |...J|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-HelloRetryRequest b/src/crypto/tls/testdata/Client-TLSv13-HelloRetryRequest
index 2ef8e40657..4d58f8d440 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-HelloRetryRequest
+++ b/src/crypto/tls/testdata/Client-TLSv13-HelloRetryRequest
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 14 01 00 01  10 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,16 +7,16 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 95 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
-000000a0  00 0a 00 06 00 04 00 1d  00 17 00 0d 00 1a 00 18  |................|
+000000a0  00 0a 00 06 00 04 00 1d  00 17 00 0d 00 16 00 14  |................|
 000000b0  08 04 04 03 08 07 08 05  08 06 04 01 05 01 06 01  |................|
-000000c0  05 03 06 03 02 01 02 03  00 32 00 1a 00 18 08 04  |.........2......|
-000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
-000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
-000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
-00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
-00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
+000000c0  05 03 06 03 00 32 00 1a  00 18 08 04 04 03 08 07  |.....2..........|
+000000d0  08 05 08 06 04 01 05 01  06 01 05 03 06 03 02 01  |................|
+000000e0  02 03 00 2b 00 09 08 03  04 03 03 03 02 03 01 00  |...+............|
+000000f0  33 00 26 00 24 00 1d 00  20 2f e5 7d a3 47 cd 62  |3.&.$... /.}.G.b|
+00000100  43 15 28 da ac 5f bb 29  07 30 ff f6 84 af c4 cf  |C.(.._.).0......|
+00000110  c2 ed 90 99 5f 58 cb 3b  74                       |...._X.;t|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 58 02 00 00  54 03 03 cf 21 ad 74 e5  |....X...T...!.t.|
 00000010  9a 61 11 be 1d 8c 02 1e  65 b8 91 c2 a2 11 16 7a  |.a......e......z|
@@ -26,7 +26,7 @@
 00000050  0c 00 2b 00 02 03 04 00  33 00 02 00 17 14 03 03  |..+.....3.......|
 00000060  00 01 01                                          |...|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 16 03  03 01 39 01 00 01 35 03  |..........9...5.|
+00000000  14 03 03 00 01 01 16 03  03 01 35 01 00 01 31 03  |..........5...1.|
 00000010  03 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000030  00 20 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |. ..............|
@@ -34,90 +34,89 @@
 00000050  00 00 00 32 cc a9 cc a8  c0 2b c0 2f c0 2c c0 30  |...2.....+./.,.0|
 00000060  c0 09 c0 13 c0 0a c0 14  00 9c 00 9d 00 2f 00 35  |............./.5|
 00000070  c0 12 00 0a c0 23 c0 27  00 3c c0 07 c0 11 00 05  |.....#.'.<......|
-00000080  13 03 13 01 13 02 01 00  00 ba 00 0b 00 02 01 00  |................|
+00000080  13 03 13 01 13 02 01 00  00 b6 00 0b 00 02 01 00  |................|
 00000090  ff 01 00 01 00 00 17 00  00 00 12 00 00 00 05 00  |................|
 000000a0  05 01 00 00 00 00 00 0a  00 06 00 04 00 1d 00 17  |................|
-000000b0  00 0d 00 1a 00 18 08 04  04 03 08 07 08 05 08 06  |................|
-000000c0  04 01 05 01 06 01 05 03  06 03 02 01 02 03 00 32  |...............2|
-000000d0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000e0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000f0  08 03 04 03 03 03 02 03  01 00 33 00 47 00 45 00  |..........3.G.E.|
-00000100  17 00 41 04 1e 18 37 ef  0d 19 51 88 35 75 71 b5  |..A...7...Q.5uq.|
-00000110  e5 54 5b 12 2e 8f 09 67  fd a7 24 20 3e b2 56 1c  |.T[....g..$ >.V.|
-00000120  ce 97 28 5e f8 2b 2d 4f  9e f1 07 9f 6c 4b 5b 83  |..(^.+-O....lK[.|
-00000130  56 e2 32 42 e9 58 b6 d7  49 a6 b5 68 1a 41 03 56  |V.2B.X..I..h.A.V|
-00000140  6b dc 5a 89                                       |k.Z.|
+000000b0  00 0d 00 16 00 14 08 04  04 03 08 07 08 05 08 06  |................|
+000000c0  04 01 05 01 06 01 05 03  06 03 00 32 00 1a 00 18  |...........2....|
+000000d0  08 04 04 03 08 07 08 05  08 06 04 01 05 01 06 01  |................|
+000000e0  05 03 06 03 02 01 02 03  00 2b 00 09 08 03 04 03  |.........+......|
+000000f0  03 03 02 03 01 00 33 00  47 00 45 00 17 00 41 04  |......3.G.E...A.|
+00000100  1e 18 37 ef 0d 19 51 88  35 75 71 b5 e5 54 5b 12  |..7...Q.5uq..T[.|
+00000110  2e 8f 09 67 fd a7 24 20  3e b2 56 1c ce 97 28 5e  |...g..$ >.V...(^|
+00000120  f8 2b 2d 4f 9e f1 07 9f  6c 4b 5b 83 56 e2 32 42  |.+-O....lK[.V.2B|
+00000130  e9 58 b6 d7 49 a6 b5 68  1a 41 03 56 6b dc 5a 89  |.X..I..h.A.Vk.Z.|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 9b 02 00 00  97 03 03 fe 4a 7b 8f ac  |............J{..|
-00000010  ff 16 9d af dc a9 3a c4  e6 91 99 1f 20 62 3d 0b  |......:..... b=.|
-00000020  1f 75 28 88 56 eb 36 d1  84 e5 58 20 00 00 00 00  |.u(.V.6...X ....|
+00000000  16 03 03 00 9b 02 00 00  97 03 03 3e b5 60 d1 cd  |...........>.`..|
+00000010  f5 a6 76 2c bd 49 f6 0f  c2 ff ff 6b c9 f6 45 19  |..v,.I.....k..E.|
+00000020  f6 e3 e7 fc 31 8b 49 4e  88 29 55 20 00 00 00 00  |....1.IN.)U ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
 00000050  4f 00 2b 00 02 03 04 00  33 00 45 00 17 00 41 04  |O.+.....3.E...A.|
-00000060  22 29 04 60 1f aa 8e 3f  bd 63 99 c0 66 e1 e1 d7  |").`...?.c..f...|
-00000070  c1 59 57 1d db 9d ba 28  a7 d4 fc fd bd 15 64 14  |.YW....(......d.|
-00000080  ec 78 e3 dc e1 c7 3e 07  c3 c5 c4 4e 43 51 10 e2  |.x....>....NCQ..|
-00000090  f0 ac 57 6b 56 4b b1 6a  46 e9 70 81 28 68 62 dc  |..WkVK.jF.p.(hb.|
-000000a0  17 03 03 00 17 2d a3 1d  ea 4e f0 8b 4b 19 3f 2d  |.....-...N..K.?-|
-000000b0  18 ef 9d b1 65 b4 e8 93  b2 80 fe 28 17 03 03 02  |....e......(....|
-000000c0  6d 3b 1b 01 88 15 65 6a  66 4a 91 e2 0a c2 c4 64  |m;....ejfJ.....d|
-000000d0  c1 f5 d0 c2 fd 1d 18 4a  e2 32 e2 d2 6f 25 04 78  |.......J.2..o%.x|
-000000e0  96 66 48 53 0b bc 24 0a  6c 46 54 28 bb 63 ed 4e  |.fHS..$.lFT(.c.N|
-000000f0  ab c3 15 bb ae 1e ea c9  63 2a f1 4b fc 55 60 b2  |........c*.K.U`.|
-00000100  8b 46 e3 09 f8 b4 72 87  3c ec 98 e2 21 53 c8 4d  |.F....r.<...!S.M|
-00000110  9b 07 4a 88 fc 0f c6 42  40 e5 74 5e 3e cf 88 3a  |..J....B@.t^>..:|
-00000120  f1 d9 ef 88 e8 eb 0a 4b  f4 64 12 d1 3f 36 25 f8  |.......K.d..?6%.|
-00000130  6d 91 49 a6 c1 ac 9e b7  e7 36 7f a0 0c af 11 48  |m.I......6.....H|
-00000140  83 e6 5c ee 23 d9 18 9a  0b 73 76 8f 0e f0 2c 4d  |..\.#....sv...,M|
-00000150  a8 07 15 da 33 b8 57 de  c4 a2 c2 97 ae d2 0b a0  |....3.W.........|
-00000160  96 da 1c c5 d6 6d 7f 66  c9 a6 ee ab 91 53 fc d4  |.....m.f.....S..|
-00000170  c1 e9 1b 7e e8 be 3e 44  65 8d 91 de 49 86 1c de  |...~..>De...I...|
-00000180  55 a1 42 5c 4c b5 24 30  67 23 d8 fe ad 54 6f e5  |U.B\L.$0g#...To.|
-00000190  e9 ae 78 46 4a f7 cc ed  d0 8d d3 65 95 76 ac fb  |..xFJ......e.v..|
-000001a0  f1 91 d2 90 35 17 5e c4  72 6c 16 2a 52 08 7b 16  |....5.^.rl.*R.{.|
-000001b0  10 e4 c4 08 28 86 f7 dd  17 50 6c d0 ea 06 f3 8a  |....(....Pl.....|
-000001c0  b9 c7 0e fd 67 9d 14 75  13 5b 85 a2 8e 1f 7a be  |....g..u.[....z.|
-000001d0  17 17 ad 72 a1 40 9d 02  5e 80 16 df e7 30 8a eb  |...r.@..^....0..|
-000001e0  2d 62 f5 63 e6 c2 96 f3  1c 19 c4 bf 14 50 73 b6  |-b.c.........Ps.|
-000001f0  6d 02 0e 7f 70 8f 6f f8  3d 6c 36 60 b5 41 3f 09  |m...p.o.=l6`.A?.|
-00000200  f9 72 26 59 fc d3 b2 70  84 2c 9b 7d 7b ab 14 a1  |.r&Y...p.,.}{...|
-00000210  43 65 89 51 75 9e 3b 4c  8c 01 8d a9 38 0a e3 fe  |Ce.Qu.;L....8...|
-00000220  0f f1 58 c5 9e b2 42 28  1e 7c 4a e0 6f fe 53 69  |..X...B(.|J.o.Si|
-00000230  e0 bc 8c c2 d5 00 c4 00  c6 f6 47 fe 70 cc a5 c0  |..........G.p...|
-00000240  cb 21 d8 89 37 8a ef bc  c6 9b 9d 5d 74 a7 22 6b  |.!..7......]t."k|
-00000250  5c e0 24 89 8d 88 a1 19  8a bf e6 bb d3 43 e3 71  |\.$..........C.q|
-00000260  38 99 60 20 2c d5 6e 93  83 20 be 0f ce 35 3d 02  |8.` ,.n.. ...5=.|
-00000270  2f 39 5e bb 06 68 b2 c7  fc 42 be a7 81 f5 40 dd  |/9^..h...B....@.|
-00000280  49 6f 4b 1b 3f a9 6c 5b  dd b9 38 29 01 be f7 76  |IoK.?.l[..8)...v|
-00000290  cc 7b 8e 34 25 72 64 2a  4b bc 38 f7 07 4e cd 16  |.{.4%rd*K.8..N..|
-000002a0  0b 9a 1f c5 5f 3e 5d 6e  fe 2c d6 fd 7c cc af 97  |...._>]n.,..|...|
-000002b0  89 04 75 20 83 c8 a9 4a  d8 65 08 a0 4f 6a f7 71  |..u ...J.e..Oj.q|
-000002c0  4a f0 34 b9 49 29 f1 44  d7 95 86 c1 cf fd 3a 46  |J.4.I).D......:F|
-000002d0  fb 0a 7a 13 ee ca 0d ce  bd 1e 62 63 cd 63 7a 75  |..z.......bc.czu|
-000002e0  26 a6 0c 6e d6 77 06 df  f7 1b e1 6c 96 e8 55 20  |&..n.w.....l..U |
-000002f0  62 f0 98 2d 22 28 3b 95  9b ec dc d7 cb 6c 1d b5  |b..-"(;......l..|
-00000300  3a de fd 2d a7 23 59 4b  69 85 20 13 8c e0 a4 b5  |:..-.#YKi. .....|
-00000310  c1 e0 72 08 e7 c2 c9 c6  c2 5c 23 e7 d3 15 dd de  |..r......\#.....|
-00000320  6a 9b d2 0c 47 4d d1 e7  d8 a9 4d 5f 60 03 17 03  |j...GM....M_`...|
-00000330  03 00 99 e8 da 65 12 48  68 fa d8 9c ee bf c8 3d  |.....e.Hh......=|
-00000340  a4 5d e1 bc 8a e3 18 46  a8 89 c9 7b 3e a2 b0 fb  |.].....F...{>...|
-00000350  1c 7e 64 69 4a 06 aa 0a  ce 79 b6 e0 8b 57 a7 7b  |.~diJ....y...W.{|
-00000360  7f b7 80 3f cf 1b f2 00  2f 22 63 00 97 60 e8 bf  |...?..../"c..`..|
-00000370  16 c1 37 fd e0 40 96 24  e1 48 c8 c5 7d a4 50 ed  |..7..@.$.H..}.P.|
-00000380  04 c4 17 88 84 e6 d3 8c  b9 8b bf 81 f8 3b 19 32  |.............;.2|
-00000390  27 d2 f6 41 2f d1 fb f3  49 79 c9 99 6d db c8 25  |'..A/...Iy..m..%|
-000003a0  36 fa 72 d1 c3 2c 1f 01  90 e0 a4 45 2b 3f 24 59  |6.r..,.....E+?$Y|
-000003b0  4c 87 04 af 4c 8b 48 04  b3 f6 e5 19 ab cd 57 f1  |L...L.H.......W.|
-000003c0  1c 4f a8 ec 48 23 20 65  df 7b cc 01 17 03 03 00  |.O..H# e.{......|
-000003d0  35 64 87 14 09 0b dd 3e  b1 58 d7 b5 46 e7 e3 c4  |5d.....>.X..F...|
-000003e0  76 fa 86 c4 6d 53 97 fd  4f c8 29 77 a7 f8 4f 70  |v...mS..O.)w..Op|
-000003f0  0d 91 e9 ba 06 a7 83 df  fb 6f 8e c9 fb fb 8f 88  |.........o......|
-00000400  1d 2b f9 ce cc 5c                                 |.+...\|
+00000060  f8 a5 4d 81 0a 05 43 42  0b d6 ca 3b 3e 02 44 20  |..M...CB...;>.D |
+00000070  56 89 80 d3 03 50 1a b4  70 50 78 aa 81 2b 5b 03  |V....P..pPx..+[.|
+00000080  6c 38 22 c1 17 4f e5 b9  57 ab 58 33 76 8e ae c9  |l8"..O..W.X3v...|
+00000090  a0 74 47 a0 10 c0 5c a7  8c 77 24 c8 90 bb f4 2a  |.tG...\..w$....*|
+000000a0  17 03 03 00 17 0c 2a 67  cb 9f a8 e8 5b 97 4a 75  |......*g....[.Ju|
+000000b0  24 80 65 28 15 a7 d4 71  eb 24 74 7e 17 03 03 02  |$.e(...q.$t~....|
+000000c0  6d 89 a3 fa 0f a6 dd dc  b5 5a f9 03 93 5a 2a a6  |m........Z...Z*.|
+000000d0  2f 65 81 9e 0d 2c 21 25  0b 7c 04 41 40 3e 95 a4  |/e...,!%.|.A@>..|
+000000e0  31 21 2a 08 db 35 bc 5a  93 aa b4 8f 30 28 0c e5  |1!*..5.Z....0(..|
+000000f0  11 f6 31 d6 7a b0 df 9c  f3 76 30 72 e2 27 1c d3  |..1.z....v0r.'..|
+00000100  75 68 3d 63 71 27 da 72  7a 18 19 da 25 94 ee e3  |uh=cq'.rz...%...|
+00000110  62 6f 45 c5 38 67 ba 4a  1f 6f f3 ea 46 c6 09 ad  |boE.8g.J.o..F...|
+00000120  db 3c 42 3c d7 8d 9c 49  8d 2c 22 15 74 98 60 5b  |.<B<...I.,".t.`[|
+00000130  f7 7f f2 87 6c 11 ed 82  72 e7 de aa e1 5b a6 85  |....l...r....[..|
+00000140  6c f0 d6 9f 94 3d 8b 9e  65 ee c2 f5 4c e7 16 eb  |l....=..e...L...|
+00000150  1e 0d 73 f0 ef a3 28 e1  df 51 81 56 16 f1 68 71  |..s...(..Q.V..hq|
+00000160  7a 17 09 95 6f dc b9 43  de 82 7a 5a a3 76 80 3a  |z...o..C..zZ.v.:|
+00000170  4b c7 f8 50 6a e9 a3 96  cb e5 60 14 cf 72 aa f5  |K..Pj.....`..r..|
+00000180  b0 fe 69 f1 f8 de fc 68  42 95 ef 81 16 3e e2 97  |..i....hB....>..|
+00000190  c6 b2 c3 eb ec 03 7d d2  85 2b c3 7f e7 07 c1 50  |......}..+.....P|
+000001a0  c9 b6 6f ab 7a 86 7b b3  fd 8b 9a 6a 3c ea 18 06  |..o.z.{....j<...|
+000001b0  13 e4 a4 9b d0 2c ef 8c  3f ea 8e d8 c4 d4 54 33  |.....,..?.....T3|
+000001c0  2e e5 b6 40 85 a8 4b 5d  9b 3c f2 9e 70 5a 23 d7  |...@..K].<..pZ#.|
+000001d0  c1 e1 b4 7a 42 69 fb b1  49 99 cf 60 5c 8a c0 7f  |...zBi..I..`\...|
+000001e0  c2 8c 8c 26 4f 0f 6c 10  bd e4 51 ab 19 4d 2a 63  |...&O.l...Q..M*c|
+000001f0  b3 39 1e d6 55 00 c9 89  3a c0 5a 2b 5b 0a e9 10  |.9..U...:.Z+[...|
+00000200  56 4c 8a 88 2d 37 27 50  07 2a 77 19 92 6a a0 67  |VL..-7'P.*w..j.g|
+00000210  c9 34 e7 b2 e4 f8 f8 fc  e0 24 c1 8e 6a 04 b0 6a  |.4.......$..j..j|
+00000220  35 1b 5a 74 78 34 81 09  d5 ed bc 61 55 bd bf 6f  |5.Ztx4.....aU..o|
+00000230  e4 a1 13 e9 b1 9a de de  54 3b 99 19 f7 90 74 be  |........T;....t.|
+00000240  48 b0 80 92 e7 19 91 17  12 12 9a 08 77 bf 2c 21  |H...........w.,!|
+00000250  33 51 9a 02 fc 8c c5 7b  90 52 89 61 df 64 1f af  |3Q.....{.R.a.d..|
+00000260  1e 49 2a 7b 33 1b 47 df  34 7f aa ca e3 16 2d 28  |.I*{3.G.4.....-(|
+00000270  94 cc 07 d1 0d 1a 07 80  a4 c6 cc 10 a7 72 58 bc  |.............rX.|
+00000280  65 92 de a1 c7 8b e5 63  9a 83 85 eb ee e8 8d e9  |e......c........|
+00000290  63 06 f0 6d 14 81 5a d5  a6 1b 84 d3 a2 5d f1 94  |c..m..Z......]..|
+000002a0  a4 af f7 eb 85 d3 00 41  12 b3 bc bf 4a 1a c1 c0  |.......A....J...|
+000002b0  b0 46 38 63 f4 05 de e0  c2 b7 ee 5b f8 c8 6c e7  |.F8c.......[..l.|
+000002c0  fe a4 3d a2 52 e8 25 4c  d0 b4 dd 1a aa e4 9c 5b  |..=.R.%L.......[|
+000002d0  3c 5c 9b 0f e2 ca 18 a8  59 1d 22 d8 2d cb ca 0d  |<\......Y.".-...|
+000002e0  61 f0 8e be 55 5e 0b b4  72 2f 32 f1 47 fe b8 94  |a...U^..r/2.G...|
+000002f0  ec 14 af c4 59 dd f9 b1  1b 18 84 44 54 c0 16 f0  |....Y......DT...|
+00000300  f4 e6 19 82 fb 00 84 6e  c0 87 05 82 33 7b 62 d8  |.......n....3{b.|
+00000310  e3 83 86 55 d6 06 bd e5  a3 1c c0 f1 ef b3 ae 2c  |...U...........,|
+00000320  f7 6e fa 9a 3d 6c cf de  5d 77 54 08 03 0c 17 03  |.n..=l..]wT.....|
+00000330  03 00 99 03 00 b3 cc ca  76 27 18 16 0a 8e d0 81  |........v'......|
+00000340  32 5d 9e 32 75 5e bb b4  c5 5c 6b 61 62 38 3d 2e  |2].2u^...\kab8=.|
+00000350  21 1a 93 c9 fc b7 90 74  17 78 ae 18 78 86 fc 6d  |!......t.x..x..m|
+00000360  0b 0c 50 d3 a6 5a 98 a8  76 6f ff 3b 98 f5 2f 11  |..P..Z..vo.;../.|
+00000370  3d af 84 92 04 42 93 33  33 5c 9a f2 fc 5f 05 dd  |=....B.33\..._..|
+00000380  89 a8 c3 c1 e7 92 0f 76  3a ed da 7c 25 e0 96 89  |.......v:..|%...|
+00000390  27 97 c1 3e 27 70 3f a4  15 f3 24 6a 47 43 7f d7  |'..>'p?...$jGC..|
+000003a0  70 b9 7b 2d 3d 53 c0 f6  53 85 fb f7 62 4a 01 8e  |p.{-=S..S...bJ..|
+000003b0  3e 30 3b b4 79 17 af 2e  73 56 e5 de ba 48 0e 0c  |>0;.y...sV...H..|
+000003c0  e0 d3 0a 80 07 b9 53 f1  1d a6 cf 29 17 03 03 00  |......S....)....|
+000003d0  35 f8 8f 94 ec 0a b9 d9  b1 2c d3 02 c9 0b ef 19  |5........,......|
+000003e0  89 ee a9 c0 b1 f3 9c 87  09 0e fb 9a e2 ad 4a 1e  |..............J.|
+000003f0  16 6d 84 af b3 fa b9 af  98 79 54 7d 45 29 99 85  |.m.......yT}E)..|
+00000400  8c a9 69 b6 ee 4e                                 |..i..N|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 35 44 f5 f8  bb f8 ef a5 7e c7 6f 34  |....5D......~.o4|
-00000010  88 d9 96 2e 59 11 6e 08  0d 17 20 fb 45 c6 86 7c  |....Y.n... .E..||
-00000020  d3 ac 29 0f 50 89 d3 e9  b8 eb 42 63 bc 18 49 99  |..).P.....Bc..I.|
-00000030  75 d5 08 2a 72 57 ea a2  a2 21 17 03 03 00 17 38  |u..*rW...!.....8|
-00000040  12 6b 56 f1 33 2a 3d 42  94 42 85 e5 3b 49 10 52  |.kV.3*=B.B..;I.R|
-00000050  13 82 59 6d 28 fa 17 03  03 00 13 ab 4c ec 58 94  |..Ym(.......L.X.|
-00000060  13 b6 f6 91 ce b5 91 f7  34 7f c5 98 38 f2        |........4...8.|
+00000000  17 03 03 00 35 4c c3 af  0b 49 46 e0 51 3a 73 a8  |....5L...IF.Q:s.|
+00000010  28 46 95 22 ef d7 05 8a  fc 4f 12 98 2f 09 ca a9  |(F.".....O../...|
+00000020  4d b8 17 e4 15 15 b5 13  3f 1a cb 8e 3d 19 00 d6  |M.......?...=...|
+00000030  19 af 90 66 0e 93 d4 22  4d 54 17 03 03 00 17 56  |...f..."MT.....V|
+00000040  31 7c 05 02 1d 84 64 d0  32 21 8d c1 61 7e 7f ce  |1|....d.2!..a~..|
+00000050  d3 45 b2 df ba df 17 03  03 00 13 3a 57 b6 2e 79  |.E.........:W..y|
+00000060  96 09 e9 66 f2 85 7a 21  88 45 cc b4 ff 12        |...f..z!.E....|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-KeyUpdate b/src/crypto/tls/testdata/Client-TLSv13-KeyUpdate
index 18d547b9ae..7d04d95a27 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-KeyUpdate
+++ b/src/crypto/tls/testdata/Client-TLSv13-KeyUpdate
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,99 +7,98 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
-000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
-000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
-000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
-00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-00000120  74                                                |t|
+000000b0  00 16 00 14 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000c0  05 01 06 01 05 03 06 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 84 8c be 3d 27  |....z...v.....='|
-00000010  0b ef 9d b0 8b bd 21 91  9d 12 b8 4c f2 0f bb 29  |......!....L...)|
-00000020  6a f4 1c 56 09 bb 85 c6  9b b7 7b 20 00 00 00 00  |j..V......{ ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 b2 4e f2 da 8b  |....z...v...N...|
+00000010  79 31 33 74 d5 37 8e 44  9d ad 6f 91 c4 bb 5d d4  |y13t.7.D..o...].|
+00000020  fd f1 e2 42 50 43 f5 3c  7f cf 92 20 00 00 00 00  |...BPC.<... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 32  |..+.....3.$... 2|
-00000060  ef 3c 13 61 12 2a 28 1c  73 77 7e 6f 7a 43 38 d3  |.<.a.*(.sw~ozC8.|
-00000070  6f f1 a6 87 34 92 b5 ad  55 7a a0 db 1c 5b 1e 14  |o...4...Uz...[..|
-00000080  03 03 00 01 01 17 03 03  00 17 18 cf a9 9c 7d 12  |..............}.|
-00000090  7e f7 a7 44 09 34 a6 40  22 8b 73 f8 87 69 35 ba  |~..D.4.@".s..i5.|
-000000a0  5a 17 03 03 02 6d 49 c5  1d 7e 9c f9 d7 5d 9f 3f  |Z....mI..~...].?|
-000000b0  41 5d a7 14 68 12 0b 3f  00 38 25 30 d9 9f 84 09  |A]..h..?.8%0....|
-000000c0  dd c9 9c 76 8a 73 40 5f  63 83 a9 4a b6 f1 4c 36  |...v.s@_c..J..L6|
-000000d0  74 13 bc 4b a6 47 9d 5b  50 3a 56 c7 6e 65 46 5d  |t..K.G.[P:V.neF]|
-000000e0  6a 1a 33 1d 9a 67 76 a2  7d 98 05 f3 3b 8b 62 3e  |j.3..gv.}...;.b>|
-000000f0  b0 72 f8 16 18 eb 47 ca  fe bc 83 ca 0a b6 df 6f  |.r....G........o|
-00000100  1c dd 95 6e 27 60 a3 88  40 0f a0 3f 6e f8 a8 9c  |...n'`..@..?n...|
-00000110  20 ee 43 60 66 e7 97 8c  c2 03 a8 e6 3d 87 6f cd  | .C`f.......=.o.|
-00000120  e9 3a 69 de 10 1f 49 ea  9d 9b 4d c9 e9 58 55 b2  |.:i...I...M..XU.|
-00000130  44 b7 09 f2 29 65 d1 fa  c1 00 b8 c0 0c 4d a1 89  |D...)e.......M..|
-00000140  1c 03 c5 0a 20 d9 88 b2  8e c6 b6 19 e1 a4 10 92  |.... ...........|
-00000150  2b 86 20 f8 0e 7c ed a5  37 03 9e 36 7a bd 0b de  |+. ..|..7..6z...|
-00000160  13 ef 6e e8 6d 1c 94 4d  6a 3f 17 db c8 44 84 47  |..n.m..Mj?...D.G|
-00000170  8b 23 d1 64 c8 90 7a da  ac 11 a0 51 c0 f2 76 10  |.#.d..z....Q..v.|
-00000180  57 1e bd a5 37 25 a9 a0  1d 3f cf 71 b1 d4 80 ed  |W...7%...?.q....|
-00000190  b9 eb 28 ec df 36 c4 f0  d1 2b fa 5b 13 fd b4 1a  |..(..6...+.[....|
-000001a0  82 3a e2 53 53 90 9a 42  0f 4b 3f 62 0e d5 e3 ab  |.:.SS..B.K?b....|
-000001b0  c2 93 b6 ab e2 db f5 43  fd f3 70 6d 44 68 c4 56  |.......C..pmDh.V|
-000001c0  4c 37 5a 9e 50 06 94 b6  d8 e1 f7 0c 97 f9 0f d1  |L7Z.P...........|
-000001d0  4f 5a 47 b4 1c 0a 1b 0a  ff bc 5d 08 7d ef b7 e6  |OZG.......].}...|
-000001e0  72 35 40 12 02 cc ed 48  19 ff e6 c8 e2 90 30 42  |r5@....H......0B|
-000001f0  04 bc 3a d0 a1 27 c6 c2  c8 b1 ab 48 a8 ff b2 c4  |..:..'.....H....|
-00000200  2e 1b 3b 9d 14 01 01 2e  53 1d 0c f7 6a 8d 49 64  |..;.....S...j.Id|
-00000210  5a bf 6e de 66 91 a8 97  2a 9f 2f 36 01 2e 33 2d  |Z.n.f...*./6..3-|
-00000220  de 5e a8 ba a1 66 fa 8a  18 c3 6e 33 a2 ab 3e 02  |.^...f....n3..>.|
-00000230  8b 25 21 dd 8b 9f de 4e  91 c9 14 dd 92 f0 4d b2  |.%!....N......M.|
-00000240  15 bf 44 89 8d 00 67 5e  01 c8 6d e7 44 3f 2b c6  |..D...g^..m.D?+.|
-00000250  cf 7a c1 4d fc b3 c1 81  f3 07 eb 6c 64 14 19 f1  |.z.M.......ld...|
-00000260  94 86 c0 c6 ea 95 35 c2  52 0e 67 37 74 df 27 c7  |......5.R.g7t.'.|
-00000270  76 1c 8e 2c 36 7d ef 71  c3 61 dd cb 8e 82 7b a1  |v..,6}.q.a....{.|
-00000280  78 c8 88 3c 90 31 17 7c  d6 f5 7c ed 67 64 ed 16  |x..<.1.|..|.gd..|
-00000290  bf 59 78 ee ee 6c 3e 3c  bd ba 29 21 23 15 50 68  |.Yx..l><..)!#.Ph|
-000002a0  40 23 ea b7 0f 03 9d 84  52 23 57 c1 dd 03 26 55  |@#......R#W...&U|
-000002b0  01 3d 46 ff 15 d0 08 fb  e1 a5 90 ac c2 e8 c8 18  |.=F.............|
-000002c0  96 e4 79 9a 0f 09 25 71  9a a0 fa 43 08 9a ca a4  |..y...%q...C....|
-000002d0  f8 8d cd f9 4f d4 d3 50  4e d2 5e 41 3a e0 e7 2e  |....O..PN.^A:...|
-000002e0  60 c6 70 8e 10 20 68 a3  8f ac 68 22 14 a2 54 5c  |`.p.. h...h"..T\|
-000002f0  ee 37 94 68 ff 93 cb 21  6b 2d 61 a3 ba 95 08 15  |.7.h...!k-a.....|
-00000300  cc 2d f1 be 22 3d 7b 02  63 01 c2 9a 88 37 aa 76  |.-.."={.c....7.v|
-00000310  2c 98 d1 17 03 03 00 99  21 4e 58 2e 4f 2b 3c c6  |,.......!NX.O+<.|
-00000320  2e ad 3b 8b d2 bf 54 81  ca 81 c6 7d 8c 40 62 cd  |..;...T....}.@b.|
-00000330  6a 42 6b 4a 81 b9 81 ce  dc c2 e8 3e 63 79 c8 2c  |jBkJ.......>cy.,|
-00000340  2c 8c 06 eb 70 2c 04 e1  62 6a 56 6e 72 c4 c8 69  |,...p,..bjVnr..i|
-00000350  39 39 c3 c2 94 3c bd 6f  cf 47 50 bb 8f d7 8e ac  |99...<.o.GP.....|
-00000360  68 4b 0b 06 e9 6a 44 68  fa 0e 0e 42 82 37 2a 1f  |hK...jDh...B.7*.|
-00000370  7d 0a 29 0a 18 f4 4f 5b  39 7f 40 9d 63 fe 20 b8  |}.)...O[9.@.c. .|
-00000380  6e 4a 64 9d 5f 18 68 16  6e 26 e1 5c 42 c8 0b 74  |nJd._.h.n&.\B..t|
-00000390  43 66 5a 9f 1e 32 2d bd  f3 2f 45 86 c4 e3 d2 c3  |CfZ..2-../E.....|
-000003a0  85 2e 7e ad 29 26 f8 f5  de f6 5c b2 c2 3f d1 61  |..~.)&....\..?.a|
-000003b0  6a 17 03 03 00 35 59 e1  a3 78 46 e2 7f db 1e a6  |j....5Y..xF.....|
-000003c0  28 ea 50 8a f5 33 1d eb  49 ef b3 34 ea 6a f8 76  |(.P..3..I..4.j.v|
-000003d0  69 70 ac d1 49 77 79 19  2c 2d 7c 95 9c e0 b7 c0  |ip..Iwy.,-|.....|
-000003e0  d2 6c d6 dd 3d ee 5a 89  0c 7b 66                 |.l..=.Z..{f|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 74  |..+.....3.$... t|
+00000060  4e d7 36 eb 1f e1 51 c6  8e 48 2d c4 67 e8 c1 d5  |N.6...Q..H-.g...|
+00000070  32 2b 4b 64 77 43 ee 04  eb 9c 07 03 45 4f 25 14  |2+KdwC......EO%.|
+00000080  03 03 00 01 01 17 03 03  00 17 c5 a9 04 f5 f0 9c  |................|
+00000090  db 59 34 64 cb 01 0d 41  fe c9 75 76 f5 0c 43 f0  |.Y4d...A..uv..C.|
+000000a0  af 17 03 03 02 6d 85 7c  c1 3f 80 ae 73 7a 81 6a  |.....m.|.?..sz.j|
+000000b0  cc ec 35 79 a9 6c b4 81  4b 11 2e a1 4b 59 23 9b  |..5y.l..K...KY#.|
+000000c0  fc ad 8a e6 ec 39 f8 db  cc f9 36 c7 93 25 47 38  |.....9....6..%G8|
+000000d0  9e 1c f9 9e 88 25 96 e4  bc cf 9c 8e c7 d3 e3 e4  |.....%..........|
+000000e0  4b 9a 75 f1 fa d0 2b 46  a6 56 ff c2 59 16 77 8a  |K.u...+F.V..Y.w.|
+000000f0  f3 1f 31 14 0f cf b9 88  4b 21 7b d3 39 e5 96 82  |..1.....K!{.9...|
+00000100  bd 16 fb 6a af 12 29 b2  7a 0a 11 ae 90 9b 3c 34  |...j..).z.....<4|
+00000110  52 89 2d 4a b5 81 68 18  18 e4 c4 56 b7 76 c9 23  |R.-J..h....V.v.#|
+00000120  5d 0e 8e f4 a5 a4 63 a2  76 06 66 67 a8 96 cd d8  |].....c.v.fg....|
+00000130  3f cf bc 0d e5 c6 5c 27  7f 43 bf a8 b7 02 f9 24  |?.....\'.C.....$|
+00000140  ee b5 a1 09 63 d6 7c 5a  9b e0 f4 3b 99 f9 03 42  |....c.|Z...;...B|
+00000150  0a eb 55 f5 77 ee 38 70  6b de 27 63 47 2f ed 78  |..U.w.8pk.'cG/.x|
+00000160  f7 a1 39 d8 c4 4a 9c a8  2b 38 8c 3c c4 3c 8a 24  |..9..J..+8.<.<.$|
+00000170  63 7e df bc 9f 21 8e 04  9e 53 ce 0a 46 99 87 3d  |c~...!...S..F..=|
+00000180  80 70 cc 27 05 82 2a dc  7b bb 03 e9 84 6f 18 ca  |.p.'..*.{....o..|
+00000190  4d be b1 73 06 72 27 1e  80 c0 84 73 69 39 07 b3  |M..s.r'....si9..|
+000001a0  72 81 09 9b 03 8d 97 36  a7 04 a7 08 01 94 d0 17  |r......6........|
+000001b0  6c 13 cd 9d 47 a9 81 b1  59 fd 90 1b 47 04 b5 30  |l...G...Y...G..0|
+000001c0  64 6a b6 f5 52 0f f8 41  83 0e e7 ee fc ac 7e f5  |dj..R..A......~.|
+000001d0  02 65 eb 12 1d 9a 0e cc  f1 4c 12 f9 17 98 4e 32  |.e.......L....N2|
+000001e0  27 24 41 15 bf 17 c2 ae  73 1c 45 19 7b 68 e5 74  |'$A.....s.E.{h.t|
+000001f0  07 6b 59 92 f3 a7 cc c0  c7 bb a4 60 d9 2d 17 e9  |.kY........`.-..|
+00000200  4f e0 90 0c 70 00 0e 75  55 78 37 0c 4b 16 06 78  |O...p..uUx7.K..x|
+00000210  bf cb 77 1c 8c 4b b3 f5  68 99 06 2d b7 50 a8 03  |..w..K..h..-.P..|
+00000220  54 36 85 33 41 1c 1a 16  16 bc f3 76 9f d9 65 c8  |T6.3A......v..e.|
+00000230  31 a5 f4 1f e1 ab 36 ac  33 54 bb fb f2 57 ec 46  |1.....6.3T...W.F|
+00000240  85 79 15 35 30 84 cc 8b  a6 bb d8 cf 6c 88 8b ab  |.y.50.......l...|
+00000250  d1 36 bd 2d 9a 11 6e 4d  09 5c 10 06 7e 26 23 b6  |.6.-..nM.\..~&#.|
+00000260  57 4a 18 dd 5b 0c 45 1c  4c 60 27 6d cf 77 1c 70  |WJ..[.E.L`'m.w.p|
+00000270  ef b9 81 af 02 fc 7b ca  80 0e 1f 48 ad 22 ce 33  |......{....H.".3|
+00000280  44 2f 28 47 a8 cd a3 98  e6 28 8e dc ac df b5 1c  |D/(G.....(......|
+00000290  34 47 8a 7a 98 c5 79 c9  38 ba 34 7e 76 63 51 3d  |4G.z..y.8.4~vcQ=|
+000002a0  ae 9b eb 2c bb 89 6d 01  cd 81 ab a4 b8 4f 27 82  |...,..m......O'.|
+000002b0  23 09 fb 9f b2 56 0f 7a  a3 f6 13 70 c3 6d 13 61  |#....V.z...p.m.a|
+000002c0  eb dd 39 da 99 8e a3 00  9e 7a 48 fe d8 78 c2 ff  |..9......zH..x..|
+000002d0  c9 ce 14 3f 37 8d 4d fb  80 6b 39 e6 cc f1 23 a0  |...?7.M..k9...#.|
+000002e0  e2 e5 cd 3d ed 07 80 85  ea 60 9d 6b e0 93 7f 53  |...=.....`.k...S|
+000002f0  89 94 32 b8 a1 4e f0 d7  33 f6 9c 07 48 f6 43 89  |..2..N..3...H.C.|
+00000300  3b 52 89 0f 31 98 a8 86  5b 2b c5 6c 0d 0c 26 04  |;R..1...[+.l..&.|
+00000310  9f 90 29 17 03 03 00 99  62 df 1f c6 0c 83 e0 8e  |..).....b.......|
+00000320  9e 30 43 4b 9b 63 c7 b7  96 bf 79 35 14 89 43 f6  |.0CK.c....y5..C.|
+00000330  5e e6 fb ec 28 6a 62 cc  64 4a e8 86 07 da 38 f3  |^...(jb.dJ....8.|
+00000340  30 c7 5a 98 78 fc e8 ee  ab 53 81 72 15 92 e1 1b  |0.Z.x....S.r....|
+00000350  d1 78 1d d3 7a 5b 7a c6  78 82 6e 8e ec a6 bd d7  |.x..z[z.x.n.....|
+00000360  8a da 12 68 64 65 2b ec  46 c4 b4 01 a8 e9 b6 00  |...hde+.F.......|
+00000370  67 b1 bf ac 26 7e 11 64  3d de 40 ae 57 8d 7d 07  |g...&~.d=.@.W.}.|
+00000380  3f 06 65 6c 92 10 42 b9  be 30 ef bd 26 a2 87 96  |?.el..B..0..&...|
+00000390  12 61 4a 56 3b 26 c1 d2  81 d3 71 d0 4c 6d 01 c3  |.aJV;&....q.Lm..|
+000003a0  a0 ec 55 96 0c 10 2a f6  9e 6c 99 78 5a 49 a8 50  |..U...*..l.xZI.P|
+000003b0  af 17 03 03 00 35 5e 78  9a 3e c9 92 b6 2d 32 1d  |.....5^x.>...-2.|
+000003c0  cd 16 ab da cd e7 93 0d  c2 90 a2 62 7b 3c 54 bb  |...........b{<T.|
+000003d0  73 dd 5a 8f f0 3d 3a e8  08 c5 a0 77 59 5c d5 db  |s.Z..=:....wY\..|
+000003e0  28 db 9a ef 03 72 e2 96  c4 77 eb                 |(....r...w.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 38 8f 9d c3 39  |..........58...9|
-00000010  03 62 38 be b8 03 22 be  53 0a 0e ff 33 82 29 2a  |.b8...".S...3.)*|
-00000020  3e a5 4b d0 0e fe 6b c8  bc d8 07 71 77 ca 0f aa  |>.K...k....qw...|
-00000030  a9 8f 3e 6e 69 5d fc 37  0c 5a f6 1d 8b fc 46 8d  |..>ni].7.Z....F.|
-00000040  17 03 03 00 17 ac 0d 5d  2a 0b dd 2e 62 ab ac cc  |.......]*...b...|
-00000050  d6 43 d4 76 ea 52 62 7f  5b 10 93 63              |.C.v.Rb.[..c|
+00000000  14 03 03 00 01 01 17 03  03 00 35 a8 d6 93 8f 7e  |..........5....~|
+00000010  65 3a ee 6f c8 37 2a 27  14 dc b7 19 0e aa 14 b6  |e:.o.7*'........|
+00000020  22 21 2d ea f4 00 d1 60  55 c0 f1 56 db 43 7a f0  |"!-....`U..V.Cz.|
+00000030  1a 47 ce 93 d9 07 7e 61  43 92 3a 95 a9 54 7b c6  |.G....~aC.:..T{.|
+00000040  17 03 03 00 17 e6 e4 52  74 15 e2 18 d7 14 59 29  |.......Rt.....Y)|
+00000050  59 d8 ce 49 68 3a a8 79  9e f4 ee f1              |Y..Ih:.y....|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 16 e0 09 97  59 52 91 65 5a cd 3b d5  |........YR.eZ.;.|
-00000010  95 c6 be 7a c7 a8 48 a6  39 73 44                 |...z..H.9sD|
+00000000  17 03 03 00 16 e6 cd 54  e3 31 d9 70 20 25 f4 aa  |.......T.1.p %..|
+00000010  cd 8f fe e7 88 6b 7f 62  9b 7b de                 |.....k.b.{.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 12 d4 4b  bd d2 98 10 6a 72 29 bc  |.......K....jr).|
-00000010  6d c1 23 38 88 c3 7b d8  32 b6 7f                 |m.#8..{.2..|
+00000000  17 03 03 00 16 bd e9 c4  24 4a 6d 76 aa 83 bb da  |........$Jmv....|
+00000010  ec 9e d0 c9 38 cc 6b 3c  65 38 91                 |....8.k<e8.|
 >>> Flow 6 (server to client)
-00000000  17 03 03 00 1a 0c 7b fb  83 bb 87 60 52 4d fb b8  |......{....`RM..|
-00000010  c8 cf 95 98 80 60 87 f4  04 ee d1 0a 5d 57 51     |.....`......]WQ|
+00000000  17 03 03 00 1a 6a e1 ea  df 76 a9 fc 4a 80 7b 49  |.....j...v..J.{I|
+00000010  dd fa c3 87 e9 e7 c9 b3  ab bf bc a7 d8 cd 36     |..............6|
 >>> Flow 7 (client to server)
-00000000  17 03 03 00 1d b1 21 2b  13 dc 27 c2 50 07 61 8d  |......!+..'.P.a.|
-00000010  63 fa c3 1f 1b ab 19 77  a0 8b 97 5f 03 26 80 54  |c......w..._.&.T|
-00000020  04 00 17 03 03 00 13 91  28 90 11 9b f8 75 52 b8  |........(....uR.|
-00000030  de 14 32 09 9d 2b 77 bb  3c 5a                    |..2..+w.<Z|
+00000000  17 03 03 00 1d 1e c5 6f  93 48 41 07 03 e5 8c 6f  |.......o.HA....o|
+00000010  09 8e 2f 8e da cb 6e 01  e9 b8 6e f6 3f 59 5c 17  |../...n...n.?Y\.|
+00000020  91 46 17 03 03 00 13 35  33 12 5e d3 97 0a 1c 54  |.F.....53.^....T|
+00000030  cf 54 bb 7d 78 2e 57 a2  5b 39                    |.T.}x.W.[9|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-P256-ECDHE b/src/crypto/tls/testdata/Client-TLSv13-P256-ECDHE
index 5add59dadb..410f0dd189 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-P256-ECDHE
+++ b/src/crypto/tls/testdata/Client-TLSv13-P256-ECDHE
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 37 01 00 01  33 03 03 00 00 00 00 00  |....7...3.......|
+00000000  16 03 01 01 33 01 00 01  2f 03 03 00 00 00 00 00  |....3.../.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,90 +7,90 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 b8 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 b4 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
-000000a0  00 0a 00 04 00 02 00 17  00 0d 00 1a 00 18 08 04  |................|
+000000a0  00 0a 00 04 00 02 00 17  00 0d 00 16 00 14 08 04  |................|
 000000b0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
-000000c0  06 03 02 01 02 03 00 32  00 1a 00 18 08 04 04 03  |.......2........|
-000000d0  08 07 08 05 08 06 04 01  05 01 06 01 05 03 06 03  |................|
-000000e0  02 01 02 03 00 2b 00 09  08 03 04 03 03 03 02 03  |.....+..........|
-000000f0  01 00 33 00 47 00 45 00  17 00 41 04 1e 18 37 ef  |..3.G.E...A...7.|
-00000100  0d 19 51 88 35 75 71 b5  e5 54 5b 12 2e 8f 09 67  |..Q.5uq..T[....g|
-00000110  fd a7 24 20 3e b2 56 1c  ce 97 28 5e f8 2b 2d 4f  |..$ >.V...(^.+-O|
-00000120  9e f1 07 9f 6c 4b 5b 83  56 e2 32 42 e9 58 b6 d7  |....lK[.V.2B.X..|
-00000130  49 a6 b5 68 1a 41 03 56  6b dc 5a 89              |I..h.A.Vk.Z.|
+000000c0  06 03 00 32 00 1a 00 18  08 04 04 03 08 07 08 05  |...2............|
+000000d0  08 06 04 01 05 01 06 01  05 03 06 03 02 01 02 03  |................|
+000000e0  00 2b 00 09 08 03 04 03  03 03 02 03 01 00 33 00  |.+............3.|
+000000f0  47 00 45 00 17 00 41 04  1e 18 37 ef 0d 19 51 88  |G.E...A...7...Q.|
+00000100  35 75 71 b5 e5 54 5b 12  2e 8f 09 67 fd a7 24 20  |5uq..T[....g..$ |
+00000110  3e b2 56 1c ce 97 28 5e  f8 2b 2d 4f 9e f1 07 9f  |>.V...(^.+-O....|
+00000120  6c 4b 5b 83 56 e2 32 42  e9 58 b6 d7 49 a6 b5 68  |lK[.V.2B.X..I..h|
+00000130  1a 41 03 56 6b dc 5a 89                           |.A.Vk.Z.|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 9b 02 00 00  97 03 03 b4 cc 04 30 25  |..............0%|
-00000010  f5 36 2e 22 d7 f5 f2 46  5b 01 09 94 ec 5e 48 df  |.6."...F[....^H.|
-00000020  60 d5 70 b6 db 62 00 36  dc 66 cb 20 00 00 00 00  |`.p..b.6.f. ....|
+00000000  16 03 03 00 9b 02 00 00  97 03 03 1f 9f 7f 3f 27  |..............?'|
+00000010  c5 5c f2 f1 bb cc a2 89  0d 7f 66 6a ff 85 7e 55  |.\........fj..~U|
+00000020  ec 47 a6 5e 9c 09 00 ec  96 e2 a7 20 00 00 00 00  |.G.^....... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
 00000050  4f 00 2b 00 02 03 04 00  33 00 45 00 17 00 41 04  |O.+.....3.E...A.|
-00000060  a4 00 4f 38 9f 17 cc 91  60 06 78 48 40 f3 be ac  |..O8....`.xH@...|
-00000070  f4 09 3f b1 41 0d 60 66  50 d5 a8 2c bf a6 c6 c8  |..?.A.`fP..,....|
-00000080  ca fe ed 4b 3f 5f 51 eb  fb da 45 b2 ad d3 70 d4  |...K?_Q...E...p.|
-00000090  59 e5 ad 07 5a 02 2e f4  6b 01 7e 57 c5 b7 71 02  |Y...Z...k.~W..q.|
-000000a0  14 03 03 00 01 01 17 03  03 00 17 3c 06 c9 4d 5a  |...........<..MZ|
-000000b0  51 b5 51 d9 dc ae 31 6d  75 9b f8 6e c1 9f e1 48  |Q.Q...1mu..n...H|
-000000c0  d6 c4 17 03 03 02 6d 9c  e1 d2 b9 0e da 85 ab 4e  |......m........N|
-000000d0  48 10 60 40 e4 1e 47 22  6f 26 2c fc f8 39 70 0f  |H.`@..G"o&,..9p.|
-000000e0  34 c8 40 80 dd c4 2b 39  50 d2 9c 9c 13 88 61 9e  |4.@...+9P.....a.|
-000000f0  62 14 01 ac be 34 95 dd  46 b6 e9 13 36 8f 54 00  |b....4..F...6.T.|
-00000100  43 5f 34 61 88 df 09 85  c7 0f 36 f3 0d 22 ef 25  |C_4a......6..".%|
-00000110  71 01 a7 ba fa 8d 24 7d  03 34 cf 92 d4 37 be b3  |q.....$}.4...7..|
-00000120  8b 79 e4 12 6d 19 32 28  47 51 d4 ec 85 b9 e2 88  |.y..m.2(GQ......|
-00000130  60 54 9d b5 75 56 27 fe  db bb 2d c9 38 49 f9 dc  |`T..uV'...-.8I..|
-00000140  cf 3e 71 af 65 b7 c4 72  7a f9 69 d5 a3 d6 be aa  |.>q.e..rz.i.....|
-00000150  e9 79 fa ec e0 55 33 78  21 2f 2d 54 62 83 6c 77  |.y...U3x!/-Tb.lw|
-00000160  2d 1e c9 5a 97 b4 11 46  ca 0e ba 75 58 d4 c4 a0  |-..Z...F...uX...|
-00000170  49 d8 76 f1 f0 37 0c 30  c2 a8 86 78 a7 c5 24 00  |I.v..7.0...x..$.|
-00000180  6e bd 89 fb 6a e6 73 1e  11 b9 21 29 92 c2 fd 44  |n...j.s...!)...D|
-00000190  cd 84 25 e0 19 09 56 a8  65 73 01 f9 1d 26 ed 02  |..%...V.es...&..|
-000001a0  67 3c 8a 1d 53 d7 c2 ea  a4 0d dd 03 26 85 eb b8  |g<..S.......&...|
-000001b0  20 c9 06 64 76 24 9a 4a  96 44 48 78 2e 86 01 9c  | ..dv$.J.DHx....|
-000001c0  be a3 60 7e 6e 5b 56 30  c7 b4 2d ff 71 db 58 15  |..`~n[V0..-.q.X.|
-000001d0  86 22 84 fb 00 d3 96 1d  f5 5f e5 39 3a 51 cc 04  |."......._.9:Q..|
-000001e0  95 fd 49 f0 c2 cc 34 e1  0b 1d ba bb 62 f8 14 4d  |..I...4.....b..M|
-000001f0  aa 94 f0 09 b5 04 d3 b7  52 10 d2 ee 01 0c a0 68  |........R......h|
-00000200  62 83 4f 11 33 b9 1c b1  4e 23 09 e7 d1 c2 c9 a4  |b.O.3...N#......|
-00000210  de 63 c3 48 3f c7 51 9a  78 4c 2e e7 fa 2c bd 06  |.c.H?.Q.xL...,..|
-00000220  82 e8 2f 61 35 83 aa 92  8b de 76 fb 0b 5a a7 44  |../a5.....v..Z.D|
-00000230  07 6b 8f d9 de d6 dd 35  ec 08 44 31 97 15 9c 70  |.k.....5..D1...p|
-00000240  38 89 2d 06 5d 01 39 23  45 ce c1 98 ca 90 f6 4a  |8.-.].9#E......J|
-00000250  47 a2 d4 6a ea 9f bc 7e  ab 42 f5 b9 bd 54 44 0c  |G..j...~.B...TD.|
-00000260  b8 1c 34 10 53 80 ae fb  97 b5 64 75 2e c0 72 30  |..4.S.....du..r0|
-00000270  dc 4a 3d aa 73 25 42 be  18 da 7c ae 0b 31 b0 f9  |.J=.s%B...|..1..|
-00000280  55 d6 15 42 da bb e0 91  c9 ee bb b8 e3 6a ea f7  |U..B.........j..|
-00000290  bf ae 2d 29 c0 58 4f 61  0c 55 e5 07 78 aa d1 45  |..-).XOa.U..x..E|
-000002a0  76 8e e4 a9 d0 dd 49 29  7d f1 ab b8 82 39 31 23  |v.....I)}....91#|
-000002b0  4c d4 5f f4 18 e7 b0 70  5f 78 e3 22 65 3b 84 e7  |L._....p_x."e;..|
-000002c0  40 d7 cb b5 e3 8c 5d fa  77 cb 45 fa 57 c0 4c fd  |@.....].w.E.W.L.|
-000002d0  11 7c f1 80 fa 4c 51 d9  78 5d b6 cc 08 90 91 9a  |.|...LQ.x]......|
-000002e0  71 20 e3 50 ec 21 7e 0d  2d e5 97 12 4a 18 17 ab  |q .P.!~.-...J...|
-000002f0  a0 1f 74 75 71 6b 8b 81  ac 85 18 99 ad 75 88 4c  |..tuqk.......u.L|
-00000300  15 87 04 57 1e 78 10 13  4b 51 f2 e9 8a 76 17 77  |...W.x..KQ...v.w|
-00000310  32 92 6c 12 6c db 2e ef  c1 2d 18 64 e8 b1 62 79  |2.l.l....-.d..by|
-00000320  4c 8a d0 23 9a ac 14 ab  c3 9f d7 37 0c cb 57 29  |L..#.......7..W)|
-00000330  bd 89 d8 32 17 03 03 00  99 40 69 b7 6b 35 af 37  |...2.....@i.k5.7|
-00000340  fd 28 d7 52 34 fa 65 84  83 41 a8 cd d9 5d e7 68  |.(.R4.e..A...].h|
-00000350  41 9b 39 7c f8 ef cf d8  8d 50 b9 2a 11 13 df f2  |A.9|.....P.*....|
-00000360  3c b3 4c 4b 7d c5 a5 d6  cf f2 72 c8 ea 26 0b 90  |<.LK}.....r..&..|
-00000370  42 5e b3 44 da a6 7d 81  13 0f f6 eb 4d c4 98 65  |B^.D..}.....M..e|
-00000380  84 aa 47 bf ba b3 f5 57  3c 18 cd 8c b2 9d 3f eb  |..G....W<.....?.|
-00000390  0e 13 aa b2 ed 42 97 cd  3f f9 d0 b7 8c 1a 94 5c  |.....B..?......\|
-000003a0  63 c3 f8 45 be 91 61 c6  d9 01 bd 88 d7 fa 15 6d  |c..E..a........m|
-000003b0  8c 48 87 6a 10 eb 43 39  66 a2 a4 cd ef 15 db 4f  |.H.j..C9f......O|
-000003c0  0d da 85 48 81 af d1 60  4b bc b9 03 a9 c5 c0 7b  |...H...`K......{|
-000003d0  9a 60 17 03 03 00 35 9a  10 8d b7 6a 5c 8e 16 96  |.`....5....j\...|
-000003e0  0a d3 2d 81 4f 3c 47 f5  bc f8 cd 92 c0 17 07 89  |..-.O<G.........|
-000003f0  28 82 42 9f f2 b0 c5 99  4f a3 33 46 f8 ea 7a b7  |(.B.....O.3F..z.|
-00000400  9e e9 a0 d6 f2 45 7e 8b  f3 4d 80 d2              |.....E~..M..|
+00000060  f0 c5 09 c6 22 3f 23 06  65 c7 e2 1c f8 e7 c2 59  |...."?#.e......Y|
+00000070  a9 9f 00 3d 1a 48 fb b5  7f e4 ad 3d 4f 2d 91 d8  |...=.H.....=O-..|
+00000080  f4 2f d5 31 5c dc 2b 53  63 2b 25 1b 60 47 31 3a  |./.1\.+Sc+%.`G1:|
+00000090  30 72 d8 5d a4 60 9d 68  51 48 45 69 32 73 58 a5  |0r.].`.hQHEi2sX.|
+000000a0  14 03 03 00 01 01 17 03  03 00 17 e9 38 fa fe 25  |............8..%|
+000000b0  89 ba 85 3b 0e 66 1e 3f  b9 52 55 20 e0 3c 07 6f  |...;.f.?.RU .<.o|
+000000c0  2c 2f 17 03 03 02 6d cf  73 3f de 91 5b 86 ff 90  |,/....m.s?..[...|
+000000d0  ca a3 c9 ba e2 9e 56 53  fc 72 28 e5 98 1f 08 ca  |......VS.r(.....|
+000000e0  6d 0e 80 96 d2 45 74 33  3b 45 ee 2b ab 12 94 57  |m....Et3;E.+...W|
+000000f0  be 00 7e f6 14 93 64 62  7b 0d 81 0e 79 8b 63 49  |..~...db{...y.cI|
+00000100  36 8a 67 5c bb 33 72 fa  73 0d e1 ab 66 58 fa a3  |6.g\.3r.s...fX..|
+00000110  dd 66 c2 bb 0e 64 82 39  59 e1 a0 e1 5c 84 b1 b6  |.f...d.9Y...\...|
+00000120  0d 60 94 f2 ff 94 39 72  62 45 cd f6 d8 f3 33 b5  |.`....9rbE....3.|
+00000130  20 99 29 c8 d5 ba 8c 49  cb 29 54 e9 cf 7e 26 1f  | .)....I.)T..~&.|
+00000140  25 96 41 93 82 4c 38 15  0d 0c 6d 7f 89 51 7f 43  |%.A..L8...m..Q.C|
+00000150  9d 04 3a 1a 58 86 97 4e  0c 29 c0 2e f0 e7 78 42  |..:.X..N.)....xB|
+00000160  f0 b4 11 cb 50 ec 45 62  c5 0a 42 11 cc aa c4 d4  |....P.Eb..B.....|
+00000170  33 15 ee 43 e1 80 6f 46  16 ea 30 27 09 d1 34 e6  |3..C..oF..0'..4.|
+00000180  59 f7 b0 e0 6f ea 51 bd  02 79 17 06 3f 84 75 08  |Y...o.Q..y..?.u.|
+00000190  63 91 b3 58 d3 1c 61 47  bf d9 2a 9e 11 75 b2 5e  |c..X..aG..*..u.^|
+000001a0  7e 09 62 f2 3c ba 63 4b  2b 09 c4 90 b5 78 9a c4  |~.b.<.cK+....x..|
+000001b0  be 35 9b 7f e3 11 5a 82  d8 50 b3 67 20 7a 53 ec  |.5....Z..P.g zS.|
+000001c0  cb f9 1a b3 b3 b6 b6 39  1b f1 fe 7a 28 27 9c ed  |.......9...z('..|
+000001d0  25 35 f4 f1 21 11 eb 33  61 64 1d 54 eb ef c3 d0  |%5..!..3ad.T....|
+000001e0  2c 0d 76 0d 7e 90 3f 8d  a4 d0 b5 d9 27 49 c7 fc  |,.v.~.?.....'I..|
+000001f0  cc 59 8c c5 af 59 fc 09  98 63 9c fb 63 d8 09 6f  |.Y...Y...c..c..o|
+00000200  55 2d 1f d2 c7 83 5f 3d  ae 00 ef ca 27 03 9d b9  |U-...._=....'...|
+00000210  00 03 c5 c7 e5 2d 91 47  b0 6c 67 2a 09 3e bc 57  |.....-.G.lg*.>.W|
+00000220  a3 02 3f cf b2 88 d8 3d  25 c5 e1 0e 2b a2 b7 5f  |..?....=%...+.._|
+00000230  57 18 5c eb 8e ae 5f d6  5f 11 1b 5c 48 3b f5 84  |W.\..._._..\H;..|
+00000240  b0 6e 29 3e 58 71 36 6e  66 6e e0 d0 98 b0 1b 84  |.n)>Xq6nfn......|
+00000250  ca 8c 53 83 86 ca 26 7a  15 6b 6a 7c 61 91 55 45  |..S...&z.kj|a.UE|
+00000260  58 cb bd b2 df df 78 22  83 36 8e 4f b6 40 70 ea  |X.....x".6.O.@p.|
+00000270  d1 72 33 7d 85 00 01 48  f1 75 73 db b3 aa 1d da  |.r3}...H.us.....|
+00000280  78 c9 e3 37 7c 1c 52 74  62 6c f6 eb af af 0b 2d  |x..7|.Rtbl.....-|
+00000290  ef d4 85 3d 9f 48 de 5c  4a 6e 24 69 b9 7b 87 e7  |...=.H.\Jn$i.{..|
+000002a0  62 3c 26 67 8a 52 b2 73  66 90 56 07 6f ec 14 62  |b<&g.R.sf.V.o..b|
+000002b0  88 15 20 e6 27 59 d4 cf  0e f0 59 cd cb 8e bd e5  |.. .'Y....Y.....|
+000002c0  ca 10 39 40 54 a5 57 4e  99 70 93 b4 86 60 5f f1  |..9@T.WN.p...`_.|
+000002d0  70 f5 d7 21 ef f2 11 b2  da 7a 7f 27 a8 6b fe 7f  |p..!.....z.'.k..|
+000002e0  e4 eb 35 9c d5 24 ef 70  4b 3c ed bd 9b b9 b9 f3  |..5..$.pK<......|
+000002f0  50 a4 61 7f 24 d0 8c 7f  4f 48 09 4f 1e 26 fb 46  |P.a.$...OH.O.&.F|
+00000300  ec c2 84 12 a5 6a 5f 19  f0 03 cc 50 cc 07 26 23  |.....j_....P..&#|
+00000310  58 6e 68 d8 20 ae eb db  2f be a6 7b a8 ed 86 20  |Xnh. .../..{... |
+00000320  61 07 03 47 e5 19 9b a7  0d 27 e0 56 9f 2a d5 19  |a..G.....'.V.*..|
+00000330  e7 b3 39 07 17 03 03 00  99 3a 9b b2 61 6a 40 3a  |..9......:..aj@:|
+00000340  46 a8 0b 50 e3 95 d2 80  5f 5a 08 c3 54 2e 47 ac  |F..P...._Z..T.G.|
+00000350  f1 83 07 13 21 7f 5e 4e  1b 67 66 cc 38 a7 f3 91  |....!.^N.gf.8...|
+00000360  f0 5f ac 9a 39 55 de bf  02 30 2a 87 35 85 f8 1d  |._..9U...0*.5...|
+00000370  32 3a 8c f8 90 6a 22 21  b2 e8 87 5e 54 6a 45 de  |2:...j"!...^TjE.|
+00000380  74 ff 6d 37 00 92 07 6c  09 13 c1 5e 68 bc 28 80  |t.m7...l...^h.(.|
+00000390  d6 24 e5 32 fc 13 ee 68  68 91 9a e6 15 74 21 7d  |.$.2...hh....t!}|
+000003a0  2d b2 c8 f5 1d 05 69 5c  80 ee 8b 7c 3e 23 be 35  |-.....i\...|>#.5|
+000003b0  d4 54 3c 52 66 2a f1 12  98 5d 3a 3f 44 26 84 d8  |.T<Rf*...]:?D&..|
+000003c0  9a 06 04 c5 35 ec 95 fd  a5 9d b1 b3 ed 3b ff 4b  |....5........;.K|
+000003d0  12 65 17 03 03 00 35 cc  f6 8e 3c 7e 29 4c ad 30  |.e....5...<~)L.0|
+000003e0  1a b7 a2 b1 f0 82 bd 42  0e 7f d6 a2 3a c3 6e a0  |.......B....:.n.|
+000003f0  1b 7f cf fa e2 21 81 1a  7a 31 fa 90 37 3c 8a e5  |.....!..z1..7<..|
+00000400  02 a5 d9 88 f8 50 05 88  81 4f a5 65              |.....P...O.e|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 5e d8 a7 91 d2  |..........5^....|
-00000010  39 b1 74 e8 a4 a2 02 97  c9 23 be a2 40 f8 94 39  |9.t......#..@..9|
-00000020  4b e8 ed 35 6c 8e 23 ce  da 32 90 93 50 f6 80 75  |K..5l.#..2..P..u|
-00000030  43 91 9c 90 09 b5 bb 7d  ab 56 53 0c a8 95 a5 c3  |C......}.VS.....|
-00000040  17 03 03 00 17 7e 95 f6  cc 40 0f 64 9f 6b d6 63  |.....~...@.d.k.c|
-00000050  29 28 6d 21 12 c4 70 6f  dd 69 ad d1 17 03 03 00  |)(m!..po.i......|
-00000060  13 8a b3 a5 7b 42 fe 41  be 86 57 03 16 d4 f1 25  |....{B.A..W....%|
-00000070  95 8d 2b f7                                       |..+.|
+00000000  14 03 03 00 01 01 17 03  03 00 35 70 3d 2c 7e 6a  |..........5p=,~j|
+00000010  d9 c5 58 7b 1d b5 d8 af  9e ca b8 30 2a 9b c3 c8  |..X{.......0*...|
+00000020  fa 1c 76 f0 64 f8 4c 01  24 19 18 b2 2e 70 b9 e1  |..v.d.L.$....p..|
+00000030  d3 45 96 e7 08 7e 7b c8  7d 1a c8 b7 87 13 9d 1d  |.E...~{.}.......|
+00000040  17 03 03 00 17 3f 62 68  a3 27 6c c3 12 33 ed e6  |.....?bh.'l..3..|
+00000050  0e 87 e6 c4 3e 63 55 2a  15 11 aa 35 17 03 03 00  |....>cU*...5....|
+00000060  13 f8 81 0f 72 73 8b d0  14 af fe f2 9d b7 c7 fd  |....rs..........|
+00000070  16 17 b9 60                                       |...`|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-X25519-ECDHE b/src/crypto/tls/testdata/Client-TLSv13-X25519-ECDHE
index c10e6c9182..9e53626d5d 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-X25519-ECDHE
+++ b/src/crypto/tls/testdata/Client-TLSv13-X25519-ECDHE
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 16 01 00 01  12 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 12 01 00 01  0e 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,86 +7,86 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 97 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 93 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
-000000a0  00 0a 00 04 00 02 00 1d  00 0d 00 1a 00 18 08 04  |................|
+000000a0  00 0a 00 04 00 02 00 1d  00 0d 00 16 00 14 08 04  |................|
 000000b0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
-000000c0  06 03 02 01 02 03 00 32  00 1a 00 18 08 04 04 03  |.......2........|
-000000d0  08 07 08 05 08 06 04 01  05 01 06 01 05 03 06 03  |................|
-000000e0  02 01 02 03 00 2b 00 09  08 03 04 03 03 03 02 03  |.....+..........|
-000000f0  01 00 33 00 26 00 24 00  1d 00 20 2f e5 7d a3 47  |..3.&.$... /.}.G|
-00000100  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
-00000110  c4 cf c2 ed 90 99 5f 58  cb 3b 74                 |......_X.;t|
+000000c0  06 03 00 32 00 1a 00 18  08 04 04 03 08 07 08 05  |...2............|
+000000d0  08 06 04 01 05 01 06 01  05 03 06 03 02 01 02 03  |................|
+000000e0  00 2b 00 09 08 03 04 03  03 03 02 03 01 00 33 00  |.+............3.|
+000000f0  26 00 24 00 1d 00 20 2f  e5 7d a3 47 cd 62 43 15  |&.$... /.}.G.bC.|
+00000100  28 da ac 5f bb 29 07 30  ff f6 84 af c4 cf c2 ed  |(.._.).0........|
+00000110  90 99 5f 58 cb 3b 74                              |.._X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 97 02 8a b6 20  |....z...v...... |
-00000010  f7 b6 e4 eb 5b eb f8 c0  ea 29 ad 6a cb 1a 0a d7  |....[....).j....|
-00000020  40 a5 e7 dd 1d 75 88 61  b4 92 2b 20 00 00 00 00  |@....u.a..+ ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 5a 42 7b 30 69  |....z...v..ZB{0i|
+00000010  87 6c 87 6a 9c c4 4f 41  b5 18 58 d5 7a 1d 7d da  |.l.j..OA..X.z.}.|
+00000020  92 29 4c dd 57 6b 4d 0c  f9 7c 74 20 00 00 00 00  |.)L.WkM..|t ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 b3  |..+.....3.$... .|
-00000060  73 c5 08 81 cd 33 2e 44  42 46 70 03 40 b1 cf 44  |s....3.DBFp.@..D|
-00000070  39 17 fa 84 e2 44 0e 37  f5 d1 3a a7 3c ca 5d 14  |9....D.7..:.<.].|
-00000080  03 03 00 01 01 17 03 03  00 17 29 94 4c 54 36 71  |..........).LT6q|
-00000090  24 9c 5c 24 f2 e7 85 50  b7 fd cb 8c db 28 14 f7  |$.\$...P.....(..|
-000000a0  f9 17 03 03 02 6d c7 4c  08 32 d5 0f 28 ec e9 4f  |.....m.L.2..(..O|
-000000b0  08 45 1d cb 93 c8 61 47  1d 6b c9 ef 33 25 e0 07  |.E....aG.k..3%..|
-000000c0  14 18 d9 ec 1b 6f 5a e1  d1 8c 9d ad 2d 46 0f b8  |.....oZ.....-F..|
-000000d0  c7 f7 0d f8 e7 86 3d 70  8d e1 ce 78 a0 3a cc 36  |......=p...x.:.6|
-000000e0  26 f0 e2 49 99 24 dd 61  c7 ae cd 10 4c 59 09 8a  |&..I.$.a....LY..|
-000000f0  43 26 35 2a b7 64 45 53  60 13 17 e6 7d 59 b7 4b  |C&5*.dES`...}Y.K|
-00000100  90 57 88 d9 21 8b d8 7d  bc 00 9e f7 bf 89 a9 d0  |.W..!..}........|
-00000110  5e 2d 17 2c cd ff cb cd  93 e8 a1 55 b7 11 fe b5  |^-.,.......U....|
-00000120  29 62 3f 6a 4c 41 ba 31  a9 ba 7a 54 7b 16 be 73  |)b?jLA.1..zT{..s|
-00000130  d4 17 35 e3 35 f2 41 a0  af d5 c7 b8 0b ea 79 bc  |..5.5.A.......y.|
-00000140  ff 2c 48 d4 2a 8b 86 e8  42 f5 75 50 31 09 4c f4  |.,H.*...B.uP1.L.|
-00000150  b8 c4 6c f4 24 9b 53 06  5c 2e c1 f0 37 22 51 9f  |..l.$.S.\...7"Q.|
-00000160  12 a1 4d 06 c8 0d 11 e4  5b 5d 72 ed f1 c2 8d 64  |..M.....[]r....d|
-00000170  74 63 0f 4e d3 9a 92 f6  68 47 36 53 5a 19 90 bc  |tc.N....hG6SZ...|
-00000180  7e de e9 05 73 5b 13 80  92 bb f4 ff 6d 4e e5 1c  |~...s[......mN..|
-00000190  40 b6 29 f3 34 0f 3c 7b  06 af 54 14 67 cb 43 43  |@.).4.<{..T.g.CC|
-000001a0  ad 30 68 a9 d1 09 29 43  02 01 ba 6e 87 e5 7a 75  |.0h...)C...n..zu|
-000001b0  67 53 54 cf bf 33 d9 f1  ca fa 63 cf 04 87 00 c6  |gST..3....c.....|
-000001c0  82 ab 0e a7 4e 8f 00 ad  0b 64 2e 87 3c 07 d7 a1  |....N....d..<...|
-000001d0  1d 4c 68 b5 78 e0 83 1f  5e d3 21 35 ed bb ca 8a  |.Lh.x...^.!5....|
-000001e0  91 cf 39 ec 74 c5 e4 51  2b 00 cf 3b 71 e1 ba af  |..9.t..Q+..;q...|
-000001f0  e6 c6 29 cc cf 8f a3 23  89 ae 3c 0f d0 47 e7 29  |..)....#..<..G.)|
-00000200  d4 11 7e 62 57 3a ee 7a  42 98 0d 53 1b 14 a7 45  |..~bW:.zB..S...E|
-00000210  12 15 8c 0b 9d 32 1d 9e  f3 a1 31 b5 34 c5 d8 03  |.....2....1.4...|
-00000220  69 df 1f ab a4 4e 01 d7  35 f7 3e 83 3d 7b 7e cc  |i....N..5.>.={~.|
-00000230  30 cd 8a 3b 9e 80 1b 5c  cc 48 2d 92 37 b8 5d 23  |0..;...\.H-.7.]#|
-00000240  8b 43 9e 1e 6d 60 04 7f  91 b1 7f 7d 4a ff 3f 5f  |.C..m`.....}J.?_|
-00000250  e8 e4 49 9e 48 04 69 20  5d e9 13 3a 61 23 fa 4e  |..I.H.i ]..:a#.N|
-00000260  31 f9 d6 3e cd fc 20 e2  14 d7 2d 47 63 7b e5 fd  |1..>.. ...-Gc{..|
-00000270  20 01 9c f4 b3 82 1f 56  60 f5 7c e2 2a 70 64 91  | ......V`.|.*pd.|
-00000280  75 75 68 fb 61 08 72 83  fc 4f a0 75 3a 2d ff f8  |uuh.a.r..O.u:-..|
-00000290  c9 1b 02 bf cf 84 fd 5e  ab dd 01 28 de d9 d8 1c  |.......^...(....|
-000002a0  78 7e a0 66 35 43 d5 54  08 66 41 74 df 43 b1 23  |x~.f5C.T.fAt.C.#|
-000002b0  f4 f1 3d 78 d0 d2 99 0d  99 c5 c1 f2 cf 86 74 29  |..=x..........t)|
-000002c0  10 31 10 4e 56 aa 90 0b  39 1f 7c 7d 6f f7 39 6b  |.1.NV...9.|}o.9k|
-000002d0  9b 4e 3c 3e 52 2f 7e 6f  6e 55 b5 64 58 08 7d dd  |.N<>R/~onU.dX.}.|
-000002e0  3b 79 08 b3 30 49 17 28  a0 6e 76 b3 38 54 56 19  |;y..0I.(.nv.8TV.|
-000002f0  f7 67 11 5f d5 54 c3 22  07 e8 83 c8 22 19 37 ab  |.g._.T."....".7.|
-00000300  8e 3a ed 07 47 02 b8 4f  03 6c ca e1 16 20 a0 b6  |.:..G..O.l... ..|
-00000310  43 d9 39 17 03 03 00 99  26 fb 79 ee 89 6d e8 ce  |C.9.....&.y..m..|
-00000320  89 95 ec 7d a2 19 ab 24  b7 b5 49 00 de ae a3 29  |...}...$..I....)|
-00000330  00 ce bf 8d 71 42 c2 dc  ae 65 ed 84 a3 af 1b d9  |....qB...e......|
-00000340  64 0a fa 49 b6 5e a9 64  bb 91 43 25 65 df 06 ee  |d..I.^.d..C%e...|
-00000350  90 a9 c9 48 99 c2 b6 0d  91 91 77 70 3b ca 58 a4  |...H......wp;.X.|
-00000360  c7 e8 fd 01 67 7c b3 ea  8e b9 9d c5 4c cf 55 67  |....g|......L.Ug|
-00000370  09 23 99 e7 2d ff 54 4b  e4 56 d5 24 72 a9 1b 03  |.#..-.TK.V.$r...|
-00000380  bc 4c d9 c8 37 f2 0b 62  88 4e 89 05 db 11 0f 3a  |.L..7..b.N.....:|
-00000390  9f 8b a7 4f a4 0a 89 d5  c8 df 11 06 af 73 71 38  |...O.........sq8|
-000003a0  bd 2f 97 15 24 b6 54 ca  bb 1c 3c e1 16 ad eb c6  |./..$.T...<.....|
-000003b0  64 17 03 03 00 35 b8 1c  a1 16 59 5c 46 6e 4c 3f  |d....5....Y\FnL?|
-000003c0  3c 79 d0 1f 4f 8a c8 49  49 6e 7e 53 de fb 43 99  |<y..O..IIn~S..C.|
-000003d0  c8 a8 3d ab 1e a4 05 de  34 0a 85 9e 9c 3e 33 2d  |..=.....4....>3-|
-000003e0  3b 78 12 70 cc 3e cf f6  36 47 23                 |;x.p.>..6G#|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 f5  |..+.....3.$... .|
+00000060  7b aa 52 58 70 5a dd 9b  db b3 b8 17 02 fc db e4  |{.RXpZ..........|
+00000070  b2 9d a2 e7 77 aa c1 d9  f9 a8 87 65 b8 c2 38 14  |....w......e..8.|
+00000080  03 03 00 01 01 17 03 03  00 17 cf 0f a3 89 ff 85  |................|
+00000090  ce 6f aa 9e 41 c6 cc e0  bb 9c dd f2 6c 2b f6 4f  |.o..A.......l+.O|
+000000a0  e5 17 03 03 02 6d eb 5d  f8 b5 8a 60 c3 af a8 03  |.....m.]...`....|
+000000b0  a7 55 8c 85 ee 94 9c 31  d5 2e de 80 71 70 c0 9d  |.U.....1....qp..|
+000000c0  9a b2 c6 fd 82 1f 72 09  3c eb 2d 38 3f 3a cd fd  |......r.<.-8?:..|
+000000d0  c2 6d b5 0a 30 20 4b 6c  64 26 e9 e2 f2 1f 27 da  |.m..0 Kld&....'.|
+000000e0  ed 81 98 fe 58 3e 27 f9  af 91 cf 90 b8 c2 a8 f0  |....X>'.........|
+000000f0  14 3c a1 5b 2e 60 55 34  73 f2 1d c2 24 df 09 55  |.<.[.`U4s...$..U|
+00000100  e5 5b b6 43 de d7 48 6b  cd 15 da 06 f1 b6 56 0b  |.[.C..Hk......V.|
+00000110  fb 7e 97 f4 40 2f 6b c9  5b 4d 0c 70 8d d5 1c 21  |.~..@/k.[M.p...!|
+00000120  d6 a2 4f ab e9 c7 cb 69  0e d0 86 d0 b8 1e c5 6b  |..O....i.......k|
+00000130  3d 2f 78 f7 ab fd db 06  5c 59 69 fe 74 69 2f c9  |=/x.....\Yi.ti/.|
+00000140  a0 36 e2 08 2e 42 23 05  da 89 33 e7 b5 c3 b2 5a  |.6...B#...3....Z|
+00000150  d4 7e 4c 99 1c 24 a8 62  9b 92 7d bb c0 e1 4a 90  |.~L..$.b..}...J.|
+00000160  72 83 4d b2 74 13 45 3f  ef 91 7c b0 c4 6b 4e f5  |r.M.t.E?..|..kN.|
+00000170  5c 3d 56 6f fe 96 63 c2  fe 2c 88 23 ab 92 08 bf  |\=Vo..c..,.#....|
+00000180  c5 08 25 81 a5 49 a6 5c  95 da 09 b2 c9 4b e0 f2  |..%..I.\.....K..|
+00000190  59 4e 5a 67 6b 71 c7 ba  69 ff a8 f5 6d 21 52 68  |YNZgkq..i...m!Rh|
+000001a0  05 d6 61 0e d6 67 d9 64  3d 26 a3 65 3c 55 11 42  |..a..g.d=&.e<U.B|
+000001b0  37 59 44 b8 a3 fa f0 58  95 a4 07 e2 d6 ee 7f 8a  |7YD....X........|
+000001c0  c8 b9 f5 ca 4c b1 58 67  a5 ce 1b e0 a2 ea 40 dd  |....L.Xg......@.|
+000001d0  e8 ca 26 59 24 61 2c c9  57 98 12 0c 57 c9 ed 17  |..&Y$a,.W...W...|
+000001e0  65 bb 08 59 8c 6f f6 52  4b 9b 83 e7 d2 b9 0f 71  |e..Y.o.RK......q|
+000001f0  a0 bd f9 5d a1 3c 35 87  18 de eb 0c a5 78 1c 64  |...].<5......x.d|
+00000200  98 0f 6c ad a4 2f b2 36  72 99 24 f2 dd 50 1b 5c  |..l../.6r.$..P.\|
+00000210  c5 54 f3 7b aa 89 2e 8b  1f 79 b6 70 ca cb 23 19  |.T.{.....y.p..#.|
+00000220  0c e8 6f 1b 05 3b 2b 48  26 51 15 5a 8b 66 86 5c  |..o..;+H&Q.Z.f.\|
+00000230  27 1a 11 0c 98 87 b0 ba  e3 24 4a b4 5b 01 17 e8  |'........$J.[...|
+00000240  43 ca 64 87 83 b1 28 33  09 e0 f7 66 7e f7 a1 d6  |C.d...(3...f~...|
+00000250  16 ee ab f4 3e cd 7d 14  b4 45 30 4c 2d 72 43 9f  |....>.}..E0L-rC.|
+00000260  4f a3 08 d2 7f 70 e9 31  7b c8 cd 77 fc 3e 82 70  |O....p.1{..w.>.p|
+00000270  48 ed 83 55 79 16 c1 8c  69 50 60 53 48 08 5b 66  |H..Uy...iP`SH.[f|
+00000280  fe 78 02 06 16 ba 02 90  85 11 7b 49 36 71 58 35  |.x........{I6qX5|
+00000290  46 7f fd 0f de dc 11 ae  3a bd df 79 93 f9 e3 8d  |F.......:..y....|
+000002a0  4c d8 c5 55 74 34 7f 01  dd 4d d5 ef ef 4e 3d d3  |L..Ut4...M...N=.|
+000002b0  31 94 3f 1c 9b 6c 44 d0  3b 73 d1 5f b4 b6 48 5d  |1.?..lD.;s._..H]|
+000002c0  16 ba 17 0b d0 f5 b4 16  18 1f 85 be dc f1 75 71  |..............uq|
+000002d0  17 f8 b0 8a f3 d2 80 24  d5 3b cd 58 f4 9b 03 e5  |.......$.;.X....|
+000002e0  64 c5 ae 5e 9a 25 d2 bb  a2 28 91 4b 2e 81 4d e4  |d..^.%...(.K..M.|
+000002f0  4e 25 57 12 fc 7a 87 36  66 0b 76 21 66 17 a0 e5  |N%W..z.6f.v!f...|
+00000300  0a f7 00 31 48 62 a9 70  f1 75 1b e0 78 c9 fa de  |...1Hb.p.u..x...|
+00000310  11 6f 3d 17 03 03 00 99  72 f9 ad 67 80 2a 9f 04  |.o=.....r..g.*..|
+00000320  a9 0a fb 6f 03 90 88 35  7f cb 97 5f 4e a2 1e a8  |...o...5..._N...|
+00000330  34 80 96 d1 60 b4 b4 12  ec c3 2b 15 c9 a0 f9 28  |4...`.....+....(|
+00000340  50 1c 53 1d fc 32 a2 c7  c0 03 58 1b 83 a6 ee 94  |P.S..2....X.....|
+00000350  2d 98 99 83 62 6a 52 a0  c5 42 94 4f 3a 26 2e 44  |-...bjR..B.O:&.D|
+00000360  7b 03 f5 2a 0e 9e 48 e4  2a 18 2e 9b 42 7f 34 d2  |{..*..H.*...B.4.|
+00000370  3c b2 92 52 cc 51 0e f0  fd c7 4d e6 d7 1b b2 44  |<..R.Q....M....D|
+00000380  99 48 e7 da 1e 43 37 d1  ac 80 c5 34 21 1b d8 0c  |.H...C7....4!...|
+00000390  9c 92 0d b4 27 b0 78 43  06 a2 90 42 c4 99 5e 5f  |....'.xC...B..^_|
+000003a0  a4 36 69 a5 a1 92 12 5e  51 47 7f ff 50 07 ac 8a  |.6i....^QG..P...|
+000003b0  35 17 03 03 00 35 86 65  34 2f d0 12 2a 0b 7c 50  |5....5.e4/..*.|P|
+000003c0  b4 c5 67 30 cc 4d cf 4f  f7 be a5 0d 2c b2 96 ae  |..g0.M.O....,...|
+000003d0  da 70 a3 74 c2 e7 9a 18  61 17 95 da 00 ac cc 89  |.p.t....a.......|
+000003e0  66 a1 e8 aa ca 8f 02 3c  b5 16 3d                 |f......<..=|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 59 5c b8 42 f1  |..........5Y\.B.|
-00000010  bb fc 65 3e 0a 8b 1c 70  be 4b 39 8c ae 0d 91 e1  |..e>...p.K9.....|
-00000020  82 b8 ad 51 1f f3 d4 06  13 33 96 71 27 96 1f f2  |...Q.....3.q'...|
-00000030  dd 6f ef 94 9b bb 56 bf  8a 59 2b 92 c9 01 b7 72  |.o....V..Y+....r|
-00000040  17 03 03 00 17 3a b4 c3  77 5b e6 98 a2 b4 3d f6  |.....:..w[....=.|
-00000050  83 fb f4 f5 6e f5 5f 5a  1e 5b 96 4c 17 03 03 00  |....n._Z.[.L....|
-00000060  13 3b 5f a0 57 f0 27 8d  dd 6a 36 fc 4c 33 86 f6  |.;_.W.'..j6.L3..|
-00000070  fe 8b 6f 5a                                       |..oZ|
+00000000  14 03 03 00 01 01 17 03  03 00 35 a0 a0 1c ae a9  |..........5.....|
+00000010  1a 1f 74 01 92 fe bf 91  c4 aa 8b f2 84 7e 39 c1  |..t..........~9.|
+00000020  cb f4 ae a8 76 0c de 9e  54 7f ca 4a a2 d3 07 ef  |....v...T..J....|
+00000030  8e ed 8a be 54 ad 76 fe  b6 62 24 4d a7 88 d5 7a  |....T.v..b$M...z|
+00000040  17 03 03 00 17 a2 d4 e7  78 ef 4a 2e 66 52 6f 2a  |........x.J.fRo*|
+00000050  e3 07 e0 9c fc 19 f6 f8  96 88 bb be 17 03 03 00  |................|
+00000060  13 43 01 14 16 42 27 8a  b9 a9 98 5f c7 06 4d 20  |.C...B'...._..M |
+00000070  8b c3 cb 33                                       |...3|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndECDSAGiven b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndECDSAGiven
index 41ed6c4e1b..73d54e6579 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndECDSAGiven
+++ b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndECDSAGiven
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 6d 01 00 00  69 03 03 5e 92 9d 30 27  |....m...i..^..0'|
-00000010  23 da fa a0 07 30 03 c8  bd 60 f2 db e9 5e b3 fc  |#....0...`...^..|
-00000020  65 d3 c5 e1 49 35 63 86  53 ec 87 00 00 04 00 2f  |e...I5c.S....../|
+00000000  16 03 01 00 6d 01 00 00  69 03 03 5e 1c 8d af f1  |....m...i..^....|
+00000010  4a ab 9d e1 c7 9c 85 c3  ab b8 84 84 ee 39 66 0b  |J............9f.|
+00000020  6d d7 b2 3b 7b bf 4e d1  90 a4 92 00 00 04 00 2f  |m..;{.N......../|
 00000030  00 ff 01 00 00 3c 00 16  00 00 00 17 00 00 00 0d  |.....<..........|
 00000040  00 30 00 2e 04 03 05 03  06 03 08 07 08 08 08 09  |.0..............|
 00000050  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
@@ -49,10 +49,10 @@
 00000260  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
 00000270  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
 00000280  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
-00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 23 0d 00 00  |.\!.;.......#...|
-000002a0  1f 02 01 40 00 18 08 04  04 03 08 07 08 05 08 06  |...@............|
-000002b0  04 01 05 01 06 01 05 03  06 03 02 01 02 03 00 00  |................|
-000002c0  16 03 03 00 04 0e 00 00  00                       |.........|
+00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 1f 0d 00 00  |.\!.;...........|
+000002a0  1b 02 01 40 00 14 08 04  04 03 08 07 08 05 08 06  |...@............|
+000002b0  04 01 05 01 06 01 05 03  06 03 00 00 16 03 03 00  |................|
+000002c0  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
 00000000  16 03 03 02 0a 0b 00 02  06 00 02 03 00 02 00 30  |...............0|
 00000010  82 01 fc 30 82 01 5e 02  09 00 9a 30 84 6c 26 35  |...0..^....0.l&5|
@@ -87,40 +87,40 @@
 000001e0  be e8 91 b3 da 1a f5 5d  a3 23 f5 26 8b 45 70 8d  |.......].#.&.Ep.|
 000001f0  65 62 9b 7e 01 99 3d 18  f6 10 9a 38 61 9b 2e 57  |eb.~..=....8a..W|
 00000200  e4 fa cc b1 8a ce e2 23  a0 87 f0 e1 67 51 eb 16  |.......#....gQ..|
-00000210  03 03 00 86 10 00 00 82  00 80 02 50 e4 cc a3 ad  |...........P....|
-00000220  fb 33 24 a1 b3 0a 7c 0f  00 e6 1a 06 2b 9f 1e 1f  |.3$...|.....+...|
-00000230  cc b8 b2 80 90 e7 86 20  32 40 06 ac 1b b0 41 b7  |....... 2@....A.|
-00000240  0d 9c 4c 41 90 01 0b 7a  7e b2 b2 46 39 dc 51 25  |..LA...z~..F9.Q%|
-00000250  98 e0 b9 ec 36 fc 08 64  f0 51 2a 41 e1 e5 61 3d  |....6..d.Q*A..a=|
-00000260  fc 07 c1 9b 1f 6f 48 d4  1f 46 bf 14 e6 92 61 1a  |.....oH..F....a.|
-00000270  bd 5f 25 1f 5e b1 3c ac  c7 58 63 02 0d 3a e0 d6  |._%.^.<..Xc..:..|
-00000280  e9 39 fc ec 59 66 2e 91  b2 65 37 eb a8 b5 60 d9  |.9..Yf...e7...`.|
-00000290  49 05 9f 6f cc 71 79 bb  f7 68 16 03 03 00 93 0f  |I..o.qy..h......|
-000002a0  00 00 8f 04 03 00 8b 30  81 88 02 42 00 bd 6a 29  |.......0...B..j)|
-000002b0  21 06 1a e2 67 a1 7f 10  ab ca 3f 74 5a bc 2f 5d  |!...g.....?tZ./]|
-000002c0  53 d0 59 90 f2 d0 b4 2d  75 47 67 0b 67 55 b6 4f  |S.Y....-uGg.gU.O|
-000002d0  75 7d 32 d8 a7 25 c8 4c  90 0b 56 65 be 60 5d ee  |u}2..%.L..Ve.`].|
-000002e0  f7 b3 80 79 26 e5 25 1d  17 cc d8 36 fc 39 02 42  |...y&.%....6.9.B|
-000002f0  01 c3 32 d6 f2 59 9e 10  c8 bf 7f 74 27 a1 00 df  |..2..Y.....t'...|
-00000300  55 05 f0 b3 81 a1 6e 10  a6 fb 0b e4 1c 3f 62 02  |U.....n......?b.|
-00000310  c9 cc c2 4b 97 ad 0c 88  98 07 6c 98 6d db 9d 9f  |...K......l.m...|
-00000320  68 a0 56 ab 5f f9 a2 21  33 86 64 53 de 37 ff 68  |h.V._..!3.dS.7.h|
-00000330  04 9d 14 03 03 00 01 01  16 03 03 00 40 85 14 34  |............@..4|
-00000340  d6 74 a9 d0 0b e9 1f 34  a9 e9 6c cf 5a ac 88 22  |.t.....4..l.Z.."|
-00000350  51 4d ae 16 05 dd 9e c1  36 5e e3 cf b1 5a b5 48  |QM......6^...Z.H|
-00000360  6c 24 b1 d6 fb 7f 03 6a  98 41 90 de 6d c7 b2 49  |l$.....j.A..m..I|
-00000370  d9 a3 c7 45 ff 18 7c f7  a4 cf 05 59 87           |...E..|....Y.|
+00000210  03 03 00 86 10 00 00 82  00 80 b1 e6 1d 71 51 c1  |.............qQ.|
+00000220  3a bd 0a 32 95 14 0c 83  7a 2b ec 89 24 f2 29 d8  |:..2....z+..$.).|
+00000230  72 84 ae 13 33 90 58 93  b6 46 6c 54 11 54 5b d3  |r...3.X..FlT.T[.|
+00000240  59 da 02 4a de 2a 56 67  04 32 3b 44 6b ac 6d 6c  |Y..J.*Vg.2;Dk.ml|
+00000250  c5 de 9d b2 9e 7b ec 27  05 9d 47 6d a1 0b 50 71  |.....{.'..Gm..Pq|
+00000260  ea 19 cc 60 5e db 6c 2f  06 b7 6e ce 51 bf 93 a9  |...`^.l/..n.Q...|
+00000270  0e c7 85 c1 83 d2 ac fe  6a d2 a9 bd b3 54 4f 45  |........j....TOE|
+00000280  4b e4 40 68 fb 30 21 ec  1c fc 76 a6 db 8b e1 46  |K.@h.0!...v....F|
+00000290  8c 0c 56 1f c0 e5 9b 2c  54 eb 16 03 03 00 93 0f  |..V....,T.......|
+000002a0  00 00 8f 04 03 00 8b 30  81 88 02 42 01 11 9a de  |.......0...B....|
+000002b0  07 19 df 8b d0 56 e7 b5  b0 d2 d4 c1 32 58 93 88  |.....V......2X..|
+000002c0  ea a6 73 86 f9 e6 be b5  c5 1f d6 0d da 28 59 89  |..s..........(Y.|
+000002d0  21 73 fe e8 30 b9 f0 d1  01 d3 e0 54 79 a6 67 0d  |!s..0......Ty.g.|
+000002e0  84 88 94 2c b9 b6 0e 19  06 34 cc f1 5f 01 02 42  |...,.....4.._..B|
+000002f0  00 fe 02 83 e8 46 a8 5f  ef 5a f0 e1 6f 3f 73 b9  |.....F._.Z..o?s.|
+00000300  0f a1 64 db a7 c4 fb 1e  9f ac da 33 ac a2 7f ff  |..d........3....|
+00000310  64 c1 26 37 17 41 c0 5e  f4 37 5c 76 23 7d 92 3a  |d.&7.A.^.7\v#}.:|
+00000320  ea 35 7f 83 03 7b a4 65  44 5d fb 84 08 39 c7 90  |.5...{.eD]...9..|
+00000330  cc 4a 14 03 03 00 01 01  16 03 03 00 40 7b 06 98  |.J..........@{..|
+00000340  ff f7 d5 a1 68 60 23 25  bc df 12 27 7f 64 1e c8  |....h`#%...'.d..|
+00000350  bc 6d 26 28 29 d0 9f 56  6a f1 5b cd 4e 17 6c 32  |.m&()..Vj.[.N.l2|
+00000360  15 b9 7a 55 02 9b 66 1c  e3 97 40 26 69 7b e7 02  |..zU..f...@&i{..|
+00000370  b0 37 d1 ec ed 96 2e 92  5a 5f 90 c1 be           |.7......Z_...|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 63 1a 77 66 2a  |...........c.wf*|
-00000020  49 3a b2 17 83 74 e1 d9  70 96 de 01 84 09 f4 88  |I:...t..p.......|
-00000030  c3 e7 3b 65 11 6f 13 32  b8 b4 f4 41 ca 6a d6 d7  |..;e.o.2...A.j..|
-00000040  51 a3 a1 f0 2d 5b b4 55  29 f9 d3 17 03 03 00 40  |Q...-[.U)......@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 0f e2 df ef c7  |................|
+00000020  0e 11 83 70 ba a8 fa 90  e3 d5 df 76 dd 7a f1 63  |...p.......v.z.c|
+00000030  ca a3 12 c7 42 45 ae 1a  a3 0f 3b 4c 46 52 91 8e  |....BE....;LFR..|
+00000040  bf df 21 be cb ed 93 12  8a ba 88 17 03 03 00 40  |..!............@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  d7 30 0f 03 89 22 4c 19  5f 06 a7 4b 95 59 91 52  |.0..."L._..K.Y.R|
-00000070  2a 65 ab 99 cb 71 99 8b  13 82 44 92 6b ff 59 07  |*e...q....D.k.Y.|
-00000080  28 ca 01 68 ab ad ba ee  6c 6a 19 0b e5 6d 82 24  |(..h....lj...m.$|
+00000060  12 fd 68 02 2d 6e aa 2f  df e4 0b a1 2c 13 e1 23  |..h.-n./....,..#|
+00000070  f9 78 4b 18 a3 1f 28 78  4d f6 25 83 4c 0c 8c df  |.xK...(xM.%.L...|
+00000080  8b ed a9 b2 87 8c 95 e3  87 8e 71 ad d9 23 05 91  |..........q..#..|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 fc 07 f4  d4 bb 24 a3 f1 cf dc 3c  |..........$....<|
-000000b0  ac 14 63 50 32 34 fd 73  c0 eb f2 78 7b 3b ea 58  |..cP24.s...x{;.X|
-000000c0  cc 3e ff 7f e5                                    |.>...|
+000000a0  00 00 00 00 00 80 9a 8c  0e 27 b9 7a f9 61 a4 a6  |.........'.z.a..|
+000000b0  4e c9 24 02 ce 1c 93 5c  5a 7a c9 1e 5f b2 a1 9b  |N.$....\Zz.._...|
+000000c0  e3 0d 47 85 ab                                    |..G..|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndEd25519Given b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndEd25519Given
index f8cc96058d..4ca8a034ed 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndEd25519Given
+++ b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndEd25519Given
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 6d 01 00 00  69 03 03 8a fe ad ad 75  |....m...i......u|
-00000010  e4 8c bf bf b7 b6 66 14  92 eb 84 85 9c c8 a7 66  |......f........f|
-00000020  04 2a d0 63 5e a6 bf 85  e9 4f 49 00 00 04 00 2f  |.*.c^....OI..../|
+00000000  16 03 01 00 6d 01 00 00  69 03 03 73 b2 f2 a9 ed  |....m...i..s....|
+00000010  88 e0 79 65 b4 3b 58 0d  b2 d8 ab cf d7 12 12 c6  |..ye.;X.........|
+00000020  99 f9 36 75 d3 f8 3e 94  cf 39 25 00 00 04 00 2f  |..6u..>..9%..../|
 00000030  00 ff 01 00 00 3c 00 16  00 00 00 17 00 00 00 0d  |.....<..........|
 00000040  00 30 00 2e 04 03 05 03  06 03 08 07 08 08 08 09  |.0..............|
 00000050  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
@@ -49,10 +49,10 @@
 00000260  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
 00000270  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
 00000280  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
-00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 23 0d 00 00  |.\!.;.......#...|
-000002a0  1f 02 01 40 00 18 08 04  04 03 08 07 08 05 08 06  |...@............|
-000002b0  04 01 05 01 06 01 05 03  06 03 02 01 02 03 00 00  |................|
-000002c0  16 03 03 00 04 0e 00 00  00                       |.........|
+00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 1f 0d 00 00  |.\!.;...........|
+000002a0  1b 02 01 40 00 14 08 04  04 03 08 07 08 05 08 06  |...@............|
+000002b0  04 01 05 01 06 01 05 03  06 03 00 00 16 03 03 00  |................|
+000002c0  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
 00000000  16 03 03 01 3c 0b 00 01  38 00 01 35 00 01 32 30  |....<...8..5..20|
 00000010  82 01 2e 30 81 e1 a0 03  02 01 02 02 10 17 d1 81  |...0............|
@@ -74,36 +74,36 @@
 00000110  8a 4e 34 40 39 d6 b3 10  dc 19 fe a0 22 71 b3 f5  |.N4@9......."q..|
 00000120  8f a1 58 0d cd f4 f1 85  24 bf e6 3d 14 df df ed  |..X.....$..=....|
 00000130  0e e1 17 d8 11 a2 60 d0  8a 37 23 2a c2 46 aa 3a  |......`..7#*.F.:|
-00000140  08 16 03 03 00 86 10 00  00 82 00 80 77 8b 9f 34  |............w..4|
-00000150  b4 db a7 0d 5b ed 1b 2f  4a 41 64 f5 ce 4a 00 7c  |....[../JAd..J.||
-00000160  91 32 b3 cf 61 18 41 04  ae fa 3b 14 de 19 0e 64  |.2..a.A...;....d|
-00000170  f9 ec 75 a6 48 7e 28 57  26 f5 1c 75 1d 42 73 fc  |..u.H~(W&..u.Bs.|
-00000180  11 51 2b ef e5 08 83 ac  17 ec 78 b8 5b 14 84 c9  |.Q+.......x.[...|
-00000190  bc 7f 22 fd 54 69 7a 82  36 c7 21 bc d6 04 c4 e7  |..".Tiz.6.!.....|
-000001a0  bc 48 c8 72 56 5d 1e 65  41 21 0a 26 85 a0 d8 c3  |.H.rV].eA!.&....|
-000001b0  50 f0 b6 07 25 ee 79 b8  f5 e6 17 85 d4 09 e7 d7  |P...%.y.........|
-000001c0  ab 8f 17 cb c2 13 a0 5a  50 cb e4 a7 16 03 03 00  |.......ZP.......|
-000001d0  48 0f 00 00 44 08 07 00  40 b7 24 50 46 db d4 8c  |H...D...@.$PF...|
-000001e0  68 17 f5 5e 79 a9 80 8c  40 23 92 33 4e 1e cc ee  |h..^y...@#.3N...|
-000001f0  d5 35 4d b8 2a 52 f0 7f  50 8e c6 d5 5f bc 08 35  |.5M.*R..P..._..5|
-00000200  a2 6d db cb 96 52 ec 92  c7 62 c7 59 ab d8 6f 9d  |.m...R...b.Y..o.|
-00000210  d7 46 35 71 28 41 89 59  02 14 03 03 00 01 01 16  |.F5q(A.Y........|
-00000220  03 03 00 40 3e 12 44 bc  c6 3d 88 71 ba d3 0c 26  |...@>.D..=.q...&|
-00000230  20 72 b0 7f 25 83 9f fd  77 c1 f5 1e 47 28 2e 60  | r..%...w...G(.`|
-00000240  53 e0 ac 52 e8 94 e4 87  90 3f af f3 a4 c0 d3 ba  |S..R.....?......|
-00000250  fe b7 06 54 f7 13 33 36  47 8f 5e 45 22 84 18 3a  |...T..36G.^E"..:|
-00000260  1f 14 21 85                                       |..!.|
+00000140  08 16 03 03 00 86 10 00  00 82 00 80 1c aa 0a c6  |................|
+00000150  76 22 2b bc 67 c7 db 5a  59 0c 2b 1d 1a 66 9b c5  |v"+.g..ZY.+..f..|
+00000160  55 ac 80 bf 23 11 68 96  82 df 44 cf bc 44 4f 54  |U...#.h...D..DOT|
+00000170  ce 0c 32 01 59 5e 3e a8  28 e1 33 7d 7d fb 2a 87  |..2.Y^>.(.3}}.*.|
+00000180  53 d1 32 25 b8 29 5a 5e  45 24 4d a8 47 58 bc 9c  |S.2%.)Z^E$M.GX..|
+00000190  6f f3 61 a9 ca e0 ad 32  88 04 1a da 83 ff fd 31  |o.a....2.......1|
+000001a0  84 65 9e 33 bb 79 d4 71  55 52 bc 57 fd 2e d5 98  |.e.3.y.qUR.W....|
+000001b0  46 b9 dc 74 58 7c c9 25  44 3c 07 97 5d bc 65 b5  |F..tX|.%D<..].e.|
+000001c0  b5 46 50 fa 52 f9 45 d7  0f f5 d2 4e 16 03 03 00  |.FP.R.E....N....|
+000001d0  48 0f 00 00 44 08 07 00  40 e2 1c ab 11 6c 52 e6  |H...D...@....lR.|
+000001e0  e8 7f 67 f0 6e 6a e4 a8  4f 25 89 31 d7 f8 dd 6f  |..g.nj..O%.1...o|
+000001f0  fd c7 84 e9 59 6b 77 b6  3b fb bc b3 d6 a7 96 4c  |....Ykw.;......L|
+00000200  2f 54 d2 cf 6b 06 5f a5  69 b6 85 0e a9 a2 90 aa  |/T..k._.i.......|
+00000210  c4 b2 89 17 b3 c7 b9 73  00 14 03 03 00 01 01 16  |.......s........|
+00000220  03 03 00 40 45 8d 48 5b  23 74 21 05 ae 22 ce c0  |...@E.H[#t!.."..|
+00000230  8a 05 9a 15 7e fb 61 73  dd 45 fd d0 97 a4 ca f5  |....~.as.E......|
+00000240  84 f0 01 c4 e4 44 78 c2  14 4f b6 27 0f e8 5a 9d  |.....Dx..O.'..Z.|
+00000250  69 7c 9b c4 c5 a3 4d 42  bf 2b 89 c6 a3 c2 ca 7a  |i|....MB.+.....z|
+00000260  d3 6c 5e 51                                       |.l^Q|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 d4 e6 b8 6f 53  |..............oS|
-00000020  6a d9 37 2b a4 95 9f 04  e5 99 2f f9 9a 16 fd a7  |j.7+....../.....|
-00000030  2d 39 d9 aa 7c 26 9e 44  4b 7f 8f d5 c6 24 4d ac  |-9..|&.DK....$M.|
-00000040  13 ca 8a 45 1e 66 dc 9a  bf 76 22 17 03 03 00 40  |...E.f...v"....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 d0 d7 ea c0 57  |...............W|
+00000020  b8 c4 0e ad 2b ba 7e f7  40 0e 92 42 0b c1 55 38  |....+.~.@..B..U8|
+00000030  89 ac d8 9f 46 96 89 c8  a0 06 e7 84 ac 42 6f a8  |....F........Bo.|
+00000040  e2 67 49 fe 5b 2f 66 3e  47 c3 14 17 03 03 00 40  |.gI.[/f>G......@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  3f 5c 60 f8 22 7b aa 82  38 c4 4a 2e 07 50 cb 6c  |?\`."{..8.J..P.l|
-00000070  3f 6f a9 39 bf 21 ce 7a  30 72 03 90 ec bc 9c 18  |?o.9.!.z0r......|
-00000080  1f a9 7f 82 3a d9 46 d9  d8 b8 77 65 e8 b3 e7 f5  |....:.F...we....|
+00000060  95 78 c4 75 cf 05 a9 ce  aa 85 0b 8e 4e fc 4b dc  |.x.u........N.K.|
+00000070  59 70 3e 68 85 68 97 9a  eb 22 22 3a 8c 61 91 a4  |Yp>h.h..."":.a..|
+00000080  89 06 bd 9e fc 8d 1d 4b  ed fe 4b d6 e7 0a 6e 2b  |.......K..K...n+|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 6d 29 d4  87 0a b4 1d b4 9d f4 12  |.....m).........|
-000000b0  bc 3d a3 1b 79 21 85 0d  e7 10 64 92 40 39 05 99  |.=..y!....d.@9..|
-000000c0  c8 a7 dd ef 0e                                    |.....|
+000000a0  00 00 00 00 00 92 d4 46  1f 6b d5 63 a7 95 0d c2  |.......F.k.c....|
+000000b0  2f a9 a2 5f 0d 70 8f a5  31 e3 5c 1d fa ac f6 2e  |/.._.p..1.\.....|
+000000c0  02 6d e8 9f 95                                    |.m...|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndGiven b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndGiven
index cc6450a4ce..585e6af657 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndGiven
+++ b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndGiven
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 6d 01 00 00  69 03 03 e9 31 0f d0 25  |....m...i...1..%|
-00000010  ef 25 a7 1a 9b 8c 4b a3  ca 2b a6 54 89 1c e1 68  |.%....K..+.T...h|
-00000020  6f b2 b2 60 6f 8a dc 87  24 8c 7b 00 00 04 00 2f  |o..`o...$.{..../|
+00000000  16 03 01 00 6d 01 00 00  69 03 03 0e c0 95 b1 0b  |....m...i.......|
+00000010  7b b5 57 cc 04 e7 03 d0  66 8d ee 9d da 65 dc 74  |{.W.....f....e.t|
+00000020  0d de 11 47 38 cd 19 12  f4 06 17 00 00 04 00 2f  |...G8........../|
 00000030  00 ff 01 00 00 3c 00 16  00 00 00 17 00 00 00 0d  |.....<..........|
 00000040  00 30 00 2e 04 03 05 03  06 03 08 07 08 08 08 09  |.0..............|
 00000050  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
@@ -49,10 +49,10 @@
 00000260  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
 00000270  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
 00000280  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
-00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 23 0d 00 00  |.\!.;.......#...|
-000002a0  1f 02 01 40 00 18 08 04  04 03 08 07 08 05 08 06  |...@............|
-000002b0  04 01 05 01 06 01 05 03  06 03 02 01 02 03 00 00  |................|
-000002c0  16 03 03 00 04 0e 00 00  00                       |.........|
+00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 1f 0d 00 00  |.\!.;...........|
+000002a0  1b 02 01 40 00 14 08 04  04 03 08 07 08 05 08 06  |...@............|
+000002b0  04 01 05 01 06 01 05 03  06 03 00 00 16 03 03 00  |................|
+000002c0  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
 00000000  16 03 03 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
 00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
@@ -86,40 +86,40 @@
 000001d0  ac 11 b1 28 56 be 1d cd  61 62 84 09 bf d6 80 c6  |...(V...ab......|
 000001e0  45 8d 82 2c b4 d8 83 9b  db c9 22 b7 2a 12 11 7b  |E..,......".*..{|
 000001f0  fa 02 3b c1 c9 ff ea c9  9d a8 49 d3 95 d7 d5 0e  |..;.......I.....|
-00000200  e5 35 16 03 03 00 86 10  00 00 82 00 80 29 51 da  |.5...........)Q.|
-00000210  8e 5c 3e fb 44 8a 0f 97  42 23 8b e2 73 cc e2 90  |.\>.D...B#..s...|
-00000220  11 c4 98 01 e9 60 96 9e  a9 96 30 c5 95 f8 56 0e  |.....`....0...V.|
-00000230  4a 2e 77 e7 7e 23 b7 49  31 c4 87 c5 69 c6 ca 6f  |J.w.~#.I1...i..o|
-00000240  ea 53 41 b4 2e 1e f6 0b  33 f5 e1 40 69 c0 91 6f  |.SA.....3..@i..o|
-00000250  88 c1 68 c8 18 99 6e fe  b3 5f 9b ee f1 4a 76 41  |..h...n.._...JvA|
-00000260  1f d1 05 f5 39 76 61 e6  a6 ea 75 0e 50 32 a1 19  |....9va...u.P2..|
-00000270  20 6a 4c 5d 62 6e 2a 6e  af f9 9c 38 b6 3a bc 86  | jL]bn*n...8.:..|
-00000280  eb ac 6d d3 b5 48 30 11  4d 98 2e 61 34 16 03 03  |..m..H0.M..a4...|
-00000290  00 88 0f 00 00 84 08 04  00 80 82 ed 3f da b5 50  |............?..P|
-000002a0  d2 50 51 14 cf ee f7 b9  7b a9 0c 77 2f 88 42 0a  |.PQ.....{..w/.B.|
-000002b0  34 a9 5d e7 32 26 3a 28  87 49 fb c4 83 31 68 c6  |4.].2&:(.I...1h.|
-000002c0  0d 32 d4 31 0a d1 d6 1e  6f 7f 89 93 bf b7 7c c7  |.2.1....o.....|.|
-000002d0  95 f8 c3 69 d8 58 4e e4  76 07 36 84 b7 c3 e7 22  |...i.XN.v.6...."|
-000002e0  01 4c 59 ae 89 95 bb e0  07 e0 31 6a e2 95 4c d4  |.LY.......1j..L.|
-000002f0  01 54 9d 27 82 60 31 13  39 07 47 c2 0c 08 5c d4  |.T.'.`1.9.G...\.|
-00000300  03 5a 6f d7 89 a0 67 5e  2d a0 11 03 bf 0e 35 d8  |.Zo...g^-.....5.|
-00000310  d0 78 2f 1e d8 15 47 ce  c9 d3 14 03 03 00 01 01  |.x/...G.........|
-00000320  16 03 03 00 40 d0 0a 0e  93 dd 9a 51 4f a9 7f 5f  |....@......QO.._|
-00000330  93 a6 60 a6 f2 10 f1 bd  bd ae 13 5d 11 b7 0d 1a  |..`........]....|
-00000340  3d 1e f3 0c b7 53 7c 10  ed fa 8c d7 3f 20 ec f2  |=....S|.....? ..|
-00000350  7d e9 15 87 3d d3 05 21  3a bc a5 54 fa 40 3b 53  |}...=..!:..T.@;S|
-00000360  41 7c ea c6 28                                    |A|..(|
+00000200  e5 35 16 03 03 00 86 10  00 00 82 00 80 cc d2 66  |.5.............f|
+00000210  37 df f1 5d cb 6f 1d 6b  64 ea 62 45 97 dd 47 f8  |7..].o.kd.bE..G.|
+00000220  e5 a0 f6 84 46 9b 6c 5b  c9 79 60 07 b0 d1 5a e6  |....F.l[.y`...Z.|
+00000230  5c 1a 43 b1 04 9f f2 3d  7a 09 da e0 45 ea 30 8a  |\.C....=z...E.0.|
+00000240  5c 08 07 67 17 2e 55 f5  0a 13 96 5c 92 e5 61 66  |\..g..U....\..af|
+00000250  92 fe c6 44 9c 4f 62 54  10 12 df f7 e4 11 74 f6  |...D.ObT......t.|
+00000260  35 81 bb 55 4f ce 43 dc  7f 4d bc 4f 8b 0c ef 13  |5..UO.C..M.O....|
+00000270  43 8a e5 80 dc 38 3e 8a  f5 7b 5c 5d 1c 76 10 06  |C....8>..{\].v..|
+00000280  3d c5 05 5b cb 9a 17 20  13 29 a5 36 5d 16 03 03  |=..[... .).6]...|
+00000290  00 88 0f 00 00 84 08 04  00 80 a7 7f 2c 3b d1 82  |............,;..|
+000002a0  8a 17 50 2a f6 c4 ac ce  47 1b 25 23 4b 0c d0 17  |..P*....G.%#K...|
+000002b0  89 18 98 a6 e4 b8 51 70  6a 59 72 1a aa 68 e8 25  |......QpjYr..h.%|
+000002c0  f5 4d 72 66 be bb 25 61  9b 36 e0 24 a5 34 e4 36  |.Mrf..%a.6.$.4.6|
+000002d0  23 0a 36 a8 81 f4 19 62  98 2b af 1b f5 c4 55 d2  |#.6....b.+....U.|
+000002e0  d5 65 58 b8 31 21 f4 fe  ce 44 cc ea 77 8e 1d f7  |.eX.1!...D..w...|
+000002f0  bc a4 4c e5 cc 90 10 f3  a0 8d 10 72 08 d4 50 1c  |..L........r..P.|
+00000300  88 82 a7 61 da cb 35 ba  26 3c 18 11 6c 14 d6 1a  |...a..5.&<..l...|
+00000310  7f 65 3d 2c 74 f0 92 a3  aa fd 14 03 03 00 01 01  |.e=,t...........|
+00000320  16 03 03 00 40 f3 3a f0  23 48 35 41 7f d0 ed 22  |....@.:.#H5A..."|
+00000330  5b 1a 47 71 60 08 b0 6b  cd 32 56 c0 d0 05 90 b3  |[.Gq`..k.2V.....|
+00000340  0b 35 3c 03 49 ec 06 5d  b4 ce 1d 10 4e bc 75 bf  |.5<.I..]....N.u.|
+00000350  23 3b f1 d6 8f f6 f0 70  b6 94 8f 51 fd 4f 47 0b  |#;.....p...Q.OG.|
+00000360  e1 c9 ad c8 14                                    |.....|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 a8 8e 30 08 f0  |.............0..|
-00000020  87 7b 13 31 99 6d 7e 9a  9b 03 d3 6f 84 d8 d9 31  |.{.1.m~....o...1|
-00000030  2b d2 aa d4 0e ae 6e 72  03 ac e7 7e 5c 22 cc ac  |+.....nr...~\"..|
-00000040  33 b5 df 04 b2 4a 2b 6f  bb a1 6f 17 03 03 00 40  |3....J+o..o....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 6e d3 79 f1 02  |...........n.y..|
+00000020  4d 8e ad 3b 33 5a 92 10  55 79 94 b7 43 ed 08 c1  |M..;3Z..Uy..C...|
+00000030  e1 5f 04 c6 01 82 ce 96  70 c7 97 8d cc 0a ca d3  |._......p.......|
+00000040  46 d4 2f 9f b8 78 57 27  ee 14 aa 17 03 03 00 40  |F./..xW'.......@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  50 9c 81 04 9b 1d 61 8a  30 9c 18 68 c7 e1 c9 f3  |P.....a.0..h....|
-00000070  70 f0 1b b6 4a dd fc c7  e3 e3 20 e2 4d 6f 9f bf  |p...J..... .Mo..|
-00000080  17 b0 5e 5b 45 73 29 1e  d4 30 b4 03 ca 8e 69 63  |..^[Es)..0....ic|
+00000060  ed 9f 38 f6 99 84 f5 cf  5e ee 27 64 f7 29 3c 18  |..8.....^.'d.)<.|
+00000070  a0 55 23 b7 db 4a 6d 2d  80 c9 75 a5 a3 1f 38 24  |.U#..Jm-..u...8$|
+00000080  0a 99 18 0d 0b 5d 7d 03  f7 8d d2 55 fd 98 7f 69  |.....]}....U...i|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 28 ca 6a  4c 1b 3c 11 61 ce b2 58  |.....(.jL.<.a..X|
-000000b0  94 e7 e4 7d c5 ce 51 03  c4 ae b5 4c 33 0b 3c 95  |...}..Q....L3.<.|
-000000c0  ec b1 65 ea da                                    |..e..|
+000000a0  00 00 00 00 00 aa 43 ca  95 7d 1a 47 d5 0b 0e c7  |......C..}.G....|
+000000b0  cc 61 3d 43 5b 69 05 a1  39 eb 03 52 41 05 54 e9  |.a=C[i..9..RA.T.|
+000000c0  5d b6 ca 56 2c                                    |]..V,|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndPKCS1v15Given b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndPKCS1v15Given
index 875fe1becb..10949e5e3b 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndPKCS1v15Given
+++ b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndPKCS1v15Given
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 6d 01 00 00  69 03 03 dc f3 c6 52 a4  |....m...i.....R.|
-00000010  9a 9c 53 e0 5a 3c cc 4c  4f 09 32 7f f1 7c 86 6b  |..S.Z<.LO.2..|.k|
-00000020  75 59 68 a5 81 72 45 46  fb 94 a8 00 00 04 00 2f  |uYh..rEF......./|
+00000000  16 03 01 00 6d 01 00 00  69 03 03 c2 c7 15 c0 0f  |....m...i.......|
+00000010  0d fc 44 60 25 22 6c 4a  ec f1 b0 66 5d c4 f3 bc  |..D`%"lJ...f]...|
+00000020  fe da b2 9a af 24 04 b7  bb 74 79 00 00 04 00 2f  |.....$...ty..../|
 00000030  00 ff 01 00 00 3c 00 16  00 00 00 17 00 00 00 0d  |.....<..........|
 00000040  00 30 00 2e 04 03 05 03  06 03 08 07 08 08 08 09  |.0..............|
 00000050  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
@@ -49,10 +49,10 @@
 00000260  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
 00000270  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
 00000280  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
-00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 23 0d 00 00  |.\!.;.......#...|
-000002a0  1f 02 01 40 00 18 08 04  04 03 08 07 08 05 08 06  |...@............|
-000002b0  04 01 05 01 06 01 05 03  06 03 02 01 02 03 00 00  |................|
-000002c0  16 03 03 00 04 0e 00 00  00                       |.........|
+00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 1f 0d 00 00  |.\!.;...........|
+000002a0  1b 02 01 40 00 14 08 04  04 03 08 07 08 05 08 06  |...@............|
+000002b0  04 01 05 01 06 01 05 03  06 03 00 00 16 03 03 00  |................|
+000002c0  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
 00000000  16 03 03 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
 00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
@@ -86,40 +86,40 @@
 000001d0  ac 11 b1 28 56 be 1d cd  61 62 84 09 bf d6 80 c6  |...(V...ab......|
 000001e0  45 8d 82 2c b4 d8 83 9b  db c9 22 b7 2a 12 11 7b  |E..,......".*..{|
 000001f0  fa 02 3b c1 c9 ff ea c9  9d a8 49 d3 95 d7 d5 0e  |..;.......I.....|
-00000200  e5 35 16 03 03 00 86 10  00 00 82 00 80 b5 77 6b  |.5............wk|
-00000210  fa 10 fb df 48 8f e7 51  b4 cb 14 c5 48 bd 63 d6  |....H..Q....H.c.|
-00000220  0e 19 d0 81 a8 5a d7 b5  43 84 35 85 37 b7 8d 2e  |.....Z..C.5.7...|
-00000230  c7 c8 70 4c f4 45 bf be  17 86 e7 40 1d 6f 88 2a  |..pL.E.....@.o.*|
-00000240  91 b5 aa aa 34 f7 9a f3  96 e4 dd 51 15 88 be f1  |....4......Q....|
-00000250  80 a9 6f 94 ed c7 5d 28  66 b4 37 e8 22 4f 42 c3  |..o...](f.7."OB.|
-00000260  b5 f0 2f dd 57 dc 8d e5  5a c0 9d fa ce 3c 7a 2d  |../.W...Z....<z-|
-00000270  1d 45 9b fc 7b ba e7 11  eb 16 ae 68 bd b4 94 14  |.E..{......h....|
-00000280  3a a2 4d 0d e0 cd 53 a9  f1 07 d6 4a 41 16 03 03  |:.M...S....JA...|
-00000290  00 88 0f 00 00 84 04 01  00 80 78 60 7e 91 f5 47  |..........x`~..G|
-000002a0  15 61 85 70 cf b3 16 6e  45 4c 8b 42 2a 66 7e b6  |.a.p...nEL.B*f~.|
-000002b0  76 4f 26 6b b5 d7 e1 68  c2 2e bf b9 71 f2 30 7f  |vO&k...h....q.0.|
-000002c0  e4 50 56 1e 0e 64 cf 05  5c 57 be 84 ce ac 8e 04  |.PV..d..\W......|
-000002d0  44 f8 c5 2a 55 ab c5 50  84 c4 b0 73 c7 73 46 80  |D..*U..P...s.sF.|
-000002e0  bd 33 0f bc 90 2f af 50  5a 21 a7 ec 01 6b f2 ae  |.3.../.PZ!...k..|
-000002f0  84 bf 08 cb 7b 3a ca cb  76 bb e3 d7 e1 8e ee e2  |....{:..v.......|
-00000300  88 25 b0 9b 68 74 ff 48  5f 48 e0 8e bd 04 d0 85  |.%..ht.H_H......|
-00000310  ea 58 93 0c c4 27 01 38  5b c5 14 03 03 00 01 01  |.X...'.8[.......|
-00000320  16 03 03 00 40 9a 93 f3  2f 40 10 df 03 f1 90 8f  |....@.../@......|
-00000330  41 4a 76 77 44 7c 00 13  c0 2b a2 86 b3 4e 09 93  |AJvwD|...+...N..|
-00000340  01 e4 3a d4 53 ae a1 4c  07 56 18 3c ec 7f 98 a6  |..:.S..L.V.<....|
-00000350  04 7b 15 23 e4 e1 75 15  ec 33 1d 09 04 e8 04 1a  |.{.#..u..3......|
-00000360  e1 51 0c 78 99                                    |.Q.x.|
+00000200  e5 35 16 03 03 00 86 10  00 00 82 00 80 40 fe b5  |.5...........@..|
+00000210  07 31 4a 29 12 9e 52 56  8b a7 7c 33 5e 8f 67 d4  |.1J)..RV..|3^.g.|
+00000220  c7 c3 82 e3 cf 62 11 12  dc 2a 03 4f 07 04 21 7e  |.....b...*.O..!~|
+00000230  70 72 fc 3a d3 4f 6e ed  92 f7 6d 92 a0 28 10 55  |pr.:.On...m..(.U|
+00000240  14 cb fa cb 19 06 9c e4  b1 6d 30 44 2a 74 6b 3a  |.........m0D*tk:|
+00000250  db d4 d6 be 20 25 b1 d4  73 9f 58 3d e7 18 6f 06  |.... %..s.X=..o.|
+00000260  54 b8 ce 9a 7d 92 76 c6  23 bc 19 ca 84 5e f2 18  |T...}.v.#....^..|
+00000270  0a cc b8 43 e1 ff 9e bc  61 64 e0 62 f0 6d 03 11  |...C....ad.b.m..|
+00000280  5f 65 fa 84 35 fe 81 ec  cb c9 1d 0a 48 16 03 03  |_e..5.......H...|
+00000290  00 88 0f 00 00 84 04 01  00 80 95 e5 ba e5 ef 6f  |...............o|
+000002a0  6d 68 2c c5 ee 96 7e 0d  4f 98 4a cb 31 8b 82 f7  |mh,...~.O.J.1...|
+000002b0  b3 2d 18 6e d8 f3 6f 19  5a 3f 3f 18 a3 53 6e e9  |.-.n..o.Z??..Sn.|
+000002c0  a0 3d 8a 78 02 a2 4a f3  a2 e6 f3 c2 83 63 e1 fd  |.=.x..J......c..|
+000002d0  4b 05 ce cf 0e a6 7e db  bb d1 95 5f 4e c9 91 83  |K.....~...._N...|
+000002e0  9c 3c da 85 6e 23 71 78  e1 dc b9 f9 5f 8d 6f e4  |.<..n#qx...._.o.|
+000002f0  76 cc bc a5 18 03 41 e7  44 dc f6 c0 7b ea 05 40  |v.....A.D...{..@|
+00000300  95 7b 54 62 75 ba a5 59  37 8c cf ea ad c6 7c d1  |.{Tbu..Y7.....|.|
+00000310  8a 8a 85 03 fc 46 f4 58  9e a9 14 03 03 00 01 01  |.....F.X........|
+00000320  16 03 03 00 40 e1 c1 7d  5b 18 51 c1 8f 98 70 14  |....@..}[.Q...p.|
+00000330  f1 c1 61 0b 13 1e f1 5f  d6 df 85 b9 a6 e0 f1 c8  |..a...._........|
+00000340  6e 47 eb 15 98 38 ba 2d  27 30 7e 29 8e db c6 4e  |nG...8.-'0~)...N|
+00000350  09 15 d8 5f 4a ef 14 95  5f 78 e3 02 c4 92 de 44  |..._J..._x.....D|
+00000360  bb cc 09 27 6f                                    |...'o|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 a2 b0 ad 7e 71  |..............~q|
-00000020  0c 2c db df 4c b1 4f 19  e6 00 4f 11 ff 5e 4a c5  |.,..L.O...O..^J.|
-00000030  c2 9d 8c 6c 03 50 12 3d  81 ec 44 5a 75 ba 2d 48  |...l.P.=..DZu.-H|
-00000040  7a 74 c3 a3 68 5a 26 ee  7e f5 a2 17 03 03 00 40  |zt..hZ&.~......@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 0c 22 6e 84 b2  |............"n..|
+00000020  a1 f9 18 62 3a 86 16 7e  e6 17 3b 8e e5 88 b8 8e  |...b:..~..;.....|
+00000030  3c c5 08 11 8e 0a df df  d4 69 bc 01 7d c8 63 33  |<........i..}.c3|
+00000040  b5 15 bf 03 5e df 50 29  c5 c4 c2 17 03 03 00 40  |....^.P).......@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  ad 1b 16 8e 39 99 64 7c  c5 49 24 83 c4 4e f6 86  |....9.d|.I$..N..|
-00000070  6b 5d 68 ae f4 0b 58 23  83 eb ab 01 52 4d 07 a1  |k]h...X#....RM..|
-00000080  59 00 e8 dc a5 a1 6f 76  e2 e9 f2 e1 21 58 6b a0  |Y.....ov....!Xk.|
+00000060  45 76 91 63 fa 48 9b c9  47 6a f6 7b fa 72 ab 78  |Ev.c.H..Gj.{.r.x|
+00000070  4f cb c4 bb 68 78 7c 71  13 f9 47 32 33 59 d4 16  |O...hx|q..G23Y..|
+00000080  83 fa 8e db 37 b6 cb d5  a1 1a e5 21 1b 50 a6 d3  |....7......!.P..|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 3c 6e a7  81 36 d0 8c 99 d8 f3 55  |.....<n..6.....U|
-000000b0  02 2e 1a 48 2d 5c 46 6e  ff f2 17 f2 d4 60 b5 9e  |...H-\Fn.....`..|
-000000c0  33 54 50 0d 6d                                    |3TP.m|
+000000a0  00 00 00 00 00 47 3b be  7e be 4e 24 16 45 85 27  |.....G;.~.N$.E.'|
+000000b0  0f 31 2a 5a ab 8b 83 61  bb e9 27 8d 12 dc 6f 6d  |.1*Z...a..'...om|
+000000c0  55 17 39 51 4c                                    |U.9QL|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedNotGiven b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedNotGiven
index 7c2c59d3f9..6053687306 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedNotGiven
+++ b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedNotGiven
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 6d 01 00 00  69 03 03 ac ea d9 49 98  |....m...i.....I.|
-00000010  9a 0c 7c 86 64 7c 73 72  6d 79 3f 7b e9 11 8b 1d  |..|.d|srmy?{....|
-00000020  79 95 f5 f5 23 9f b2 f1  9c f4 b5 00 00 04 00 2f  |y...#........../|
+00000000  16 03 01 00 6d 01 00 00  69 03 03 f2 1b 6e dc ce  |....m...i....n..|
+00000010  fe af a8 4b 44 88 5f ba  eb c5 d7 92 7e 69 d7 19  |...KD._.....~i..|
+00000020  b3 32 d3 99 e6 be 1f 4f  94 04 e6 00 00 04 00 2f  |.2.....O......./|
 00000030  00 ff 01 00 00 3c 00 16  00 00 00 17 00 00 00 0d  |.....<..........|
 00000040  00 30 00 2e 04 03 05 03  06 03 08 07 08 08 08 09  |.0..............|
 00000050  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
@@ -49,37 +49,37 @@
 00000260  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
 00000270  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
 00000280  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
-00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 23 0d 00 00  |.\!.;.......#...|
-000002a0  1f 02 01 40 00 18 08 04  04 03 08 07 08 05 08 06  |...@............|
-000002b0  04 01 05 01 06 01 05 03  06 03 02 01 02 03 00 00  |................|
-000002c0  16 03 03 00 04 0e 00 00  00                       |.........|
+00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 1f 0d 00 00  |.\!.;...........|
+000002a0  1b 02 01 40 00 14 08 04  04 03 08 07 08 05 08 06  |...@............|
+000002b0  04 01 05 01 06 01 05 03  06 03 00 00 16 03 03 00  |................|
+000002c0  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 07 0b 00 00  03 00 00 00 16 03 03 00  |................|
-00000010  86 10 00 00 82 00 80 2e  37 44 fb d7 1d 2f 3d a5  |........7D.../=.|
-00000020  1b 43 cf f4 1c cf 9d 95  fa be 9f 9d 96 8a 27 5d  |.C............']|
-00000030  7b be 19 10 bd 5e 9a 3e  49 49 d2 af 85 07 70 f8  |{....^.>II....p.|
-00000040  c8 4f 69 02 ff 4e 9d ee  f4 0d 4d 54 a1 aa 61 a3  |.Oi..N....MT..a.|
-00000050  e0 cc db a7 2c 46 80 6e  eb 10 fb cd 2e 3b c5 50  |....,F.n.....;.P|
-00000060  2b a5 d9 a0 bf 01 d2 f8  d8 51 2b ad 40 6f c6 6f  |+........Q+.@o.o|
-00000070  0e 30 53 27 73 89 b7 1b  c1 28 ff ff 18 4c fa 6f  |.0S's....(...L.o|
-00000080  fa 5f 16 b3 38 36 9f f4  07 74 ca bb bb c2 3f aa  |._..86...t....?.|
-00000090  0d e7 42 24 fb f8 4c 14  03 03 00 01 01 16 03 03  |..B$..L.........|
-000000a0  00 40 19 02 9e 3a ce b9  38 40 ce d6 3b 87 b2 f6  |.@...:..8@..;...|
-000000b0  1b 7d ee 76 62 f8 6e 04  80 8f cb 1b f7 1e 1d a6  |.}.vb.n.........|
-000000c0  50 8a 59 b1 ad 7d c5 9d  2f 2d 14 56 2e e5 3b b3  |P.Y..}../-.V..;.|
-000000d0  db da 7e 37 10 97 71 91  d3 7b 93 f6 64 a4 d7 8b  |..~7..q..{..d...|
-000000e0  d2 f0                                             |..|
+00000010  86 10 00 00 82 00 80 36  1c ba 9d 08 27 52 8b f7  |.......6....'R..|
+00000020  24 d9 e6 18 d7 21 75 1d  76 e0 13 a0 35 d5 08 7d  |$....!u.v...5..}|
+00000030  c1 8e 3f b2 aa 10 b4 f9  d4 77 e6 cd b3 92 94 0e  |..?......w......|
+00000040  7a c9 0b 5f e2 34 88 ad  fc 02 1b 84 10 ff e8 2a  |z.._.4.........*|
+00000050  dd 2d 82 5c bb ca 15 f8  73 74 ad dd 9f 9d e7 38  |.-.\....st.....8|
+00000060  7c cd 74 8e 37 0f 87 62  cf 30 68 8a e2 15 9d d2  ||.t.7..b.0h.....|
+00000070  43 4b e3 29 69 e4 db 94  9b 5a 7c c6 9b e8 7d 26  |CK.)i....Z|...}&|
+00000080  4b a8 4a 28 c1 47 cf 15  7b 22 a2 1d 6b ac 16 e4  |K.J(.G..{"..k...|
+00000090  e1 62 6e be 9a 05 67 14  03 03 00 01 01 16 03 03  |.bn...g.........|
+000000a0  00 40 98 4e 3d 6c 72 d8  7f 81 b6 b8 ed 32 2e 98  |.@.N=lr......2..|
+000000b0  8d fc c1 1d 56 97 82 ef  3f 7c 86 79 e3 27 06 ed  |....V...?|.y.'..|
+000000c0  87 c4 28 2d 6b f1 b1 88  d0 67 34 64 ba e1 d9 34  |..(-k....g4d...4|
+000000d0  a4 2c ff e0 b2 38 21 5d  04 64 99 a4 34 62 aa 81  |.,...8!].d..4b..|
+000000e0  cf 21                                             |.!|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 46 c8 31 06 11  |...........F.1..|
-00000020  01 8e df b0 e7 cc 16 d3  97 2e a2 68 e7 a4 d1 0f  |...........h....|
-00000030  91 71 dd ba db 97 20 45  60 c2 47 c7 ee 56 c4 68  |.q.... E`.G..V.h|
-00000040  a4 b1 05 09 e2 68 4d 54  fa ff 01 17 03 03 00 40  |.....hMT.......@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 66 31 30 4e 0f  |...........f10N.|
+00000020  de bd de 72 65 0c 74 ab  64 d8 59 47 fc 6b ad d8  |...re.t.d.YG.k..|
+00000030  73 24 da 77 62 ba 0a 8c  69 d3 c4 6f 89 ef 5b 92  |s$.wb...i..o..[.|
+00000040  d3 ca 3b e8 67 2b 7c bf  39 7c 8b 17 03 03 00 40  |..;.g+|.9|.....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  79 bf ad 63 e3 11 2b d0  41 0e 24 85 92 c4 9b b5  |y..c..+.A.$.....|
-00000070  b2 d3 2e fc aa 46 84 85  a7 37 90 fc f0 2b 5a 7e  |.....F...7...+Z~|
-00000080  28 9f 2e 57 1d 8f c3 ca  eb 40 32 79 af 4b b8 28  |(..W.....@2y.K.(|
+00000060  5c a8 b1 1c 7e e1 76 b8  d0 0c 4d 3d 3f 36 a8 26  |\...~.v...M=?6.&|
+00000070  66 00 dd 47 3c ae 1c 8b  6f b0 6b 80 75 c4 0b 7e  |f..G<...o.k.u..~|
+00000080  ee fb 8c fe 2f 2f 65 1b  9b e1 72 a9 ac 8f cf da  |....//e...r.....|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 8b 6c 27  b8 ff f9 ea ca 68 75 54  |......l'.....huT|
-000000b0  bf bf a7 f4 b1 58 a5 b3  31 01 4d c7 85 58 31 d4  |.....X..1.M..X1.|
-000000c0  e7 da 7e 77 68                                    |..~wh|
+000000a0  00 00 00 00 00 9d 96 95  12 3b 42 41 a8 30 b2 8c  |.........;BA.0..|
+000000b0  3d 18 f6 27 b7 77 30 d9  29 0c 68 ec 2b 09 26 91  |=..'.w0.).h.+.&.|
+000000c0  23 0c e2 10 07                                    |#....|
diff --git a/src/internal/godebugs/godebugs_test.go b/src/internal/godebugs/godebugs_test.go
index 046193b5c6..168acc134a 100644
--- a/src/internal/godebugs/godebugs_test.go
+++ b/src/internal/godebugs/godebugs_test.go
@@ -46,7 +46,8 @@ func TestAll(t *testing.T) {
 		if info.Old != "" && info.Changed == 0 {
 			t.Errorf("Name=%s has Old, missing Changed", info.Name)
 		}
-		if !strings.Contains(doc, "`"+info.Name+"`") {
+		if !strings.Contains(doc, "`"+info.Name+"`") &&
+			!strings.Contains(doc, "`"+info.Name+"=") {
 			t.Errorf("Name=%s not documented in doc/godebug.md", info.Name)
 		}
 		if !info.Opaque && !incs[info.Name] {
diff --git a/src/internal/godebugs/table.go b/src/internal/godebugs/table.go
index d7d3f430cd..29539b2f38 100644
--- a/src/internal/godebugs/table.go
+++ b/src/internal/godebugs/table.go
@@ -62,6 +62,7 @@ var All = []Info{
 	{Name: "tlsmaxrsasize", Package: "crypto/tls"},
 	{Name: "tlsmlkem", Package: "crypto/tls", Changed: 24, Old: "0", Opaque: true},
 	{Name: "tlsrsakex", Package: "crypto/tls", Changed: 22, Old: "1"},
+	{Name: "tlssha1", Package: "crypto/tls", Changed: 25, Old: "1"},
 	{Name: "tlsunsafeekm", Package: "crypto/tls", Changed: 22, Old: "1"},
 	{Name: "updatemaxprocs", Package: "runtime", Changed: 25, Old: "0"},
 	{Name: "winreadlinkvolume", Package: "os", Changed: 23, Old: "0"},
diff --git a/src/runtime/metrics/doc.go b/src/runtime/metrics/doc.go
index 8204e87fd1..7ef09be2fc 100644
--- a/src/runtime/metrics/doc.go
+++ b/src/runtime/metrics/doc.go
@@ -350,6 +350,10 @@ Below is the full list of supported metrics, ordered lexicographically.
 		The number of non-default behaviors executed by the crypto/tls
 		package due to a non-default GODEBUG=tlsrsakex=... setting.
 
+	/godebug/non-default-behavior/tlssha1:events
+		The number of non-default behaviors executed by the crypto/tls
+		package due to a non-default GODEBUG=tlssha1=... setting.
+
 	/godebug/non-default-behavior/tlsunsafeekm:events
 		The number of non-default behaviors executed by the crypto/tls
 		package due to a non-default GODEBUG=tlsunsafeekm=... setting.
