commit 7d61ad25f8b10c0a656ef709fb30c08f5974594b
Author: Adam Langley <agl@golang.org>
Date:   Wed May 16 14:35:23 2018 -0700

    crypto/x509: check EKUs like 1.9.
    
    This change brings back the EKU checking from 1.9. In 1.10, we checked
    EKU nesting independent of the requested EKUs so that, after verifying a
    certifciate, one could inspect the EKUs in the leaf and trust them.
    
    That, however, was too optimistic. I had misunderstood that the PKI was
    /currently/ clean enough to require that, rather than it being
    desirable. Go generally does not push the envelope on these sorts of
    things and lets the browsers clear the path first.
    
    Fixes #24590
    
    Change-Id: I18c070478e3bbb6468800ae461c207af9e954949
    Reviewed-on: https://go-review.googlesource.com/113475
    Reviewed-by: Filippo Valsorda <filippo@golang.org>

 src/crypto/x509/name_constraints_test.go |  46 ++++--
 src/crypto/x509/verify.go                | 237 ++++++++++++-------------------
 2 files changed, 121 insertions(+), 162 deletions(-)
