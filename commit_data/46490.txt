commit e09783cbc0a7142719c6210b4eda7b21daad91d5
Author: Matthew Dempsky <mdempsky@google.com>
Date:   Tue Jan 5 03:27:46 2021 -0800

    [dev.regabi] cmd/compile: make ir.StaticValue safer
    
    ir.StaticValue currently relies on CaptureVars setting Addrtaken for
    variables that are assigned within nested function literals. We want
    to move that logic to escape analysis, but ir.StaticValue is used in
    inlining and devirtualization, which happen before escape
    analysis.
    
    The long-term solution here is to generalize escape analysis's precise
    reassignment tracking for use by other optimization passes, but for
    now we just generalize ir.StaticValue to not depend on Addrtaken
    anymore. Instead, it now also pays attention to OADDR nodes as well as
    recurses into OCLOSURE bodies.
    
    Passes toolstash -cmp.
    
    Change-Id: I6114e3277fb70b235f4423d2983d0433c881f79f
    Reviewed-on: https://go-review.googlesource.com/c/go/+/281540
    Trust: Matthew Dempsky <mdempsky@google.com>
    Run-TryBot: Matthew Dempsky <mdempsky@google.com>
    TryBot-Result: Go Bot <gobot@golang.org>
    Reviewed-by: Cuong Manh Le <cuong.manhle.vn@gmail.com>

 src/cmd/compile/internal/ir/expr.go | 38 ++++++++++++++++++++++++++++++++-----
 1 file changed, 33 insertions(+), 5 deletions(-)
