commit 70c107c68dca7d57a24b35dd81420fb889aa1031
Author: Austin Clements <austin@google.com>
Date:   Wed Oct 19 15:49:31 2016 -0400

    runtime: add deletion barriers on gobuf.ctxt
    
    gobuf.ctxt is set to nil from many places in assembly code and these
    assignments require write barriers with the hybrid barrier.
    
    Conveniently, in most of these places ctxt should already be nil, in
    which case we don't need the barrier. This commit changes these places
    to assert that ctxt is already nil.
    
    gogo is more complicated, since ctxt may not already be nil. For gogo,
    we manually perform the write barrier if ctxt is not nil.
    
    Updates #17503.
    
    Change-Id: I9d75e27c75a1b7f8b715ad112fc5d45ffa856d30
    Reviewed-on: https://go-review.googlesource.com/31764
    Reviewed-by: Cherry Zhang <cherryyz@google.com>

 src/runtime/asm_386.s      | 26 +++++++++++++++++++++++---
 src/runtime/asm_amd64.s    | 26 +++++++++++++++++++++++---
 src/runtime/asm_amd64p32.s | 20 ++++++++++++++++++--
 src/runtime/asm_arm.s      | 28 +++++++++++++++++++++++++---
 src/runtime/asm_arm64.s    | 26 +++++++++++++++++++++++---
 src/runtime/asm_mips64x.s  | 25 +++++++++++++++++++++----
 src/runtime/asm_ppc64x.s   | 26 +++++++++++++++++++++++---
 src/runtime/asm_s390x.s    | 25 +++++++++++++++++++++----
 src/runtime/runtime2.go    |  9 +++++++++
 9 files changed, 186 insertions(+), 25 deletions(-)
