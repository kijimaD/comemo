commit bf26e43d0f9a6c9d43c206877917e66f0fc24a19
Author: Robert Findley <rfindley@google.com>
Date:   Fri Sep 10 15:12:57 2021 -0400

    go/types: eliminate Named.instPos
    
    We no longer need to use the nilness of Named.instPos to signal whether
    instance expansion has occurred, so remove it from the Named struct by
    instead closing over the instantiation position in the resolver.
    
    This means we cannot print instance markers for unexpanded instances:
    instances may escape the type checking pass without being fully
    expanded, and we can not check whether they have been expanded in a
    concurrency-safe way without introducing a more heavy-weight
    syncronization mechanism.
    
    With this change, instantiation should be concurrency safe, modulo bugs
    of course as we have little test coverage of concurrency (see #47729).
    
    Fixes #47910
    
    Change-Id: Ifeef6df296f00105579554b333a44d08aae113c9
    Reviewed-on: https://go-review.googlesource.com/c/go/+/349411
    Trust: Robert Findley <rfindley@google.com>
    Run-TryBot: Robert Findley <rfindley@google.com>
    TryBot-Result: Go Bot <gobot@golang.org>
    Reviewed-by: Robert Griesemer <gri@golang.org>

 src/go/internal/gcimporter/gcimporter_test.go |  3 ---
 src/go/types/environment.go                   |  7 -------
 src/go/types/errors.go                        |  2 +-
 src/go/types/errors_test.go                   |  1 -
 src/go/types/instantiate.go                   |  5 +++--
 src/go/types/named.go                         |  8 +++-----
 src/go/types/sizeof_test.go                   |  2 +-
 src/go/types/subst.go                         |  3 ---
 src/go/types/typestring.go                    | 10 ----------
 9 files changed, 8 insertions(+), 33 deletions(-)
