commit 245e95dfabd77f337373bf2d6bb47cd353ad8d74
Author: Robert Findley <rfindley@google.com>
Date:   Wed Jan 11 14:41:03 2023 -0500

    go/types, types2: don't look up fields or methods when expecting a type
    
    As we have seen many times, the type checker must be careful to avoid
    accessing named type information before the type is fully set up. We
    need a more systematic solution to this problem, but for now avoid one
    case that causes a crash: checking a selector expression on an
    incomplete type when a type expression is expected.
    
    For golang/go#57522
    
    Change-Id: I7ed31b859cca263276e3a0647d1f1b49670023a9
    Reviewed-on: https://go-review.googlesource.com/c/go/+/461577
    Run-TryBot: Robert Findley <rfindley@google.com>
    Auto-Submit: Robert Findley <rfindley@google.com>
    TryBot-Result: Gopher Robot <gobot@golang.org>
    Reviewed-by: Robert Griesemer <gri@google.com>

 src/cmd/compile/internal/types2/call.go            | 21 ++++++++++++++++++-
 src/cmd/compile/internal/types2/expr.go            |  2 +-
 src/cmd/compile/internal/types2/typexpr.go         |  2 +-
 src/go/types/call.go                               | 21 ++++++++++++++++++-
 src/go/types/expr.go                               |  2 +-
 src/go/types/typexpr.go                            |  2 +-
 src/internal/types/testdata/check/cycles0.go       |  2 +-
 src/internal/types/testdata/check/decls0.go        | 10 ++++-----
 src/internal/types/testdata/check/issues0.go       |  2 +-
 .../types/testdata/fixedbugs/issue39634.go         |  2 +-
 .../types/testdata/fixedbugs/issue57522.go         | 24 ++++++++++++++++++++++
 test/fixedbugs/issue18392.go                       |  2 +-
 12 files changed, 77 insertions(+), 15 deletions(-)
