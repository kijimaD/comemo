commit 70ee525261f7d8adbcf58c2cf54efb7e7efb1c82
Author: Brad Fitzpatrick <bradfitz@golang.org>
Date:   Wed Jan 13 16:30:00 2016 +0000

    net/http: fix Transport crash when abandoning dial which upgrades protos
    
    When the Transport was creating an bound HTTP connection (protocol
    unknown initially) and then ends up deciding it doesn't need it, a
    goroutine sits around to clean up whatever the result was. That
    goroutine made the false assumption that the result was always an
    HTTP/1 connection or an error. It may also be an alternate protocol
    in which case the *persistConn.conn net.Conn field is nil, and the
    alt field is non-nil.
    
    Fixes #13839
    
    Change-Id: Ia4972e5eb1ad53fa00410b3466d4129c753e0871
    Reviewed-on: https://go-review.googlesource.com/18573
    Reviewed-by: Russ Cox <rsc@golang.org>
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

 src/net/http/export_test.go    |  1 +
 src/net/http/transport.go      | 30 +++++++++++---
 src/net/http/transport_test.go | 93 ++++++++++++++++++++++++++++++++++++++++++
 3 files changed, 118 insertions(+), 6 deletions(-)
