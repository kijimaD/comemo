commit d36353499f673c89a267a489beb80133a14a75f9
Author: Filippo Valsorda <filippo@golang.org>
Date:   Thu Dec 14 22:13:29 2023 +0100

    crypto/tls: align FIPS-only mode with BoringSSL policy
    
    This enables TLS 1.3, disables P-521, and disables non-ECDHE suites.
    
    Reapplies CL 549975.
    
    Updates #64717
    Updates #62372
    
    Change-Id: I6c608704638d59a063a657fbd4eb1126027112dd
    Reviewed-on: https://go-review.googlesource.com/c/go/+/603376
    Reviewed-by: Roland Shoemaker <roland@golang.org>
    LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
    Reviewed-by: David Chase <drchase@google.com>

 src/crypto/internal/boring/aes.go        | 29 +++++++++----
 src/crypto/internal/boring/notboring.go  |  1 +
 src/crypto/tls/boring_test.go            | 70 ++++++++++++++++++++++----------
 src/crypto/tls/cipher_suites.go          |  8 +++-
 src/crypto/tls/defaults.go               |  8 ++--
 src/crypto/tls/handshake_client.go       |  9 +++-
 src/crypto/tls/handshake_client_tls13.go |  4 --
 src/crypto/tls/handshake_server_test.go  |  1 +
 src/crypto/tls/handshake_server_tls13.go |  7 ++--
 9 files changed, 93 insertions(+), 44 deletions(-)
