commit d585f04fd39f86edaa2aafd776e9ad037d075396
Author: Ian Lance Taylor <iant@golang.org>
Date:   Sat Jan 26 11:55:00 2019 -0800

    cmd/compile: base PPC64 trunc rules on final type, not op type
    
    Whether a truncation should become a MOVWreg or a MOVWZreg doesn't
    depend on the type of the operand, it depends on the type of the final
    result.  If the final result is unsigned, we can use MOVWZreg.  If the
    final result is signed, we can use MOVWreg.  Checking the type of the
    operand does the wrong thing if truncating an unsigned value to a
    signed value, or vice-versa.
    
    Fixes #29943
    
    Change-Id: Ia6fc7d006486fa02cffd0bec4d910bdd5b6365f8
    Reviewed-on: https://go-review.googlesource.com/c/159760
    Run-TryBot: Ian Lance Taylor <iant@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Keith Randall <khr@golang.org>

 src/cmd/compile/internal/ssa/gen/PPC64.rules |  6 ++--
 src/cmd/compile/internal/ssa/rewritePPC64.go | 42 ++++++++++++++++------------
 test/fixedbugs/issue29943.go                 | 28 +++++++++++++++++++
 3 files changed, 55 insertions(+), 21 deletions(-)
