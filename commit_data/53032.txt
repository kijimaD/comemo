commit d6481d5b9662b29453004204746945a93a6b4eb2
Author: Michael Pratt <mpratt@google.com>
Date:   Tue Jun 28 15:17:12 2022 -0400

    runtime: add race annotations to metricsSema
    
    metricsSema protects the metrics map. The map implementation is race
    instrumented regardless of which package is it called from.
    
    semacquire/semrelease are not automatically race instrumented, so we can
    trigger race false positives without manually annotating our lock
    acquire and release.
    
    See similar instrumentation on trace.shutdownSema and reflectOffs.lock.
    
    Fixes #53542.
    
    Change-Id: Ia3fd239ac860e037d09c7cb9c4ad267391e70705
    Reviewed-on: https://go-review.googlesource.com/c/go/+/414517
    Run-TryBot: Michael Pratt <mpratt@google.com>
    TryBot-Result: Gopher Robot <gobot@golang.org>
    Reviewed-by: Cherry Mui <cherryyz@google.com>

 src/runtime/export_test.go |  4 ++--
 src/runtime/metrics.go     | 33 +++++++++++++++++++++++++--------
 2 files changed, 27 insertions(+), 10 deletions(-)
