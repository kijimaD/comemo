commit d3836aba316a6a5ee9410b9abd2f42120af4ffe6
Author: Austin Clements <austin@google.com>
Date:   Fri Oct 14 13:39:07 2016 -0400

    runtime: ensure finalizers are zero-initialized before reuse
    
    We reuse finalizers in finblocks, which are allocated off-heap. This
    means they have to be zero-initialized before becoming visible to the
    garbage collector. We actually already do this by clearing the
    finalizer before returning it to the pool, but we're not careful to
    enforce correct memory ordering. Fix this by manipulating the
    finalizer count atomically so these writes synchronize properly with
    the garbage collector.
    
    Updates #17503.
    
    Change-Id: I7797d31df3c656c9fe654bc6da287f66a9e2037d
    Reviewed-on: https://go-review.googlesource.com/31454
    Reviewed-by: Rick Hudson <rlh@golang.org>

 src/runtime/mfinal.go  | 15 +++++++++------
 src/runtime/mgcmark.go |  3 ++-
 2 files changed, 11 insertions(+), 7 deletions(-)
