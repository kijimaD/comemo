commit e73c6c8808da281186a4d8f7107e34e9f7a4a9ee
Author: Michael Matloob <matloob@golang.org>
Date:   Thu Nov 18 14:48:26 2021 -0500

    cmd/go: fix go work sync when there are zero workspace modules
    
    go work sync panics when there are no workspace modules. This is
    because the code that set the pruning mode only did so with modules
    present. This change changes pruningForGoVersion to properly return
    workspace pruning in workspace mode to prevent that. Another weird
    scenario can happen when there are no workspace modules, but the
    command-line-arguments module is created by default. Check for that
    when iterating over the workspace modules to avoid trying to find the
    nonexistant go.mod file for that modules.
    
    Fixes #49591
    
    Change-Id: Iee8bc92a8aaf9c440f88fe4f9ca908a8d461cd36
    Reviewed-on: https://go-review.googlesource.com/c/go/+/365234
    Trust: Michael Matloob <matloob@golang.org>
    Trust: Bryan C. Mills <bcmills@google.com>
    Run-TryBot: Michael Matloob <matloob@golang.org>
    TryBot-Result: Go Bot <gobot@golang.org>
    Reviewed-by: Bryan C. Mills <bcmills@google.com>

 src/cmd/go/internal/modload/modfile.go                  |  3 +++
 src/cmd/go/internal/workcmd/sync.go                     |  7 +++++++
 src/cmd/go/testdata/script/work_sync_missing_module.txt | 12 ++++++++++++
 3 files changed, 22 insertions(+)
