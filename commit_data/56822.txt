commit 9624e67fd25d2962f4470df3d54ff6ed5bad3c24
Author: Filippo Valsorda <filippo@golang.org>
Date:   Sat May 20 17:49:21 2023 +0200

    crypto/tls: add SessionState and use it on the server side
    
    This change by itself is useless, because the application has no way to
    access or provide SessionStates to crypto/tls, but they will be provided
    in following CLs.
    
    For #60105
    
    Change-Id: I8d5de79b1eda0a778420134cf6f346246a1bb296
    Reviewed-on: https://go-review.googlesource.com/c/go/+/496818
    Reviewed-by: Marten Seemann <martenseemann@gmail.com>
    TryBot-Result: Gopher Robot <gobot@golang.org>
    Reviewed-by: Damien Neil <dneil@google.com>
    Reviewed-by: Matthew Dempsky <mdempsky@google.com>
    Run-TryBot: Filippo Valsorda <filippo@golang.org>
---
 api/next/60105.txt                                 |   3 +
 src/crypto/tls/handshake_messages_test.go          |  53 ++--
 src/crypto/tls/handshake_server.go                 |  38 +--
 src/crypto/tls/handshake_server_tls13.go           |  26 +-
 .../testdata/Server-TLSv10-ExportKeyingMaterial    |  74 ++---
 src/crypto/tls/testdata/Server-TLSv12-ALPN         |  62 ++--
 .../tls/testdata/Server-TLSv12-ALPN-Fallback       |  62 ++--
 .../tls/testdata/Server-TLSv12-ALPN-NotConfigured  |  62 ++--
 .../testdata/Server-TLSv12-ExportKeyingMaterial    |  72 ++---
 src/crypto/tls/testdata/Server-TLSv12-IssueTicket  |  66 ++--
 .../testdata/Server-TLSv12-IssueTicketPreDisable   |  66 ++--
 src/crypto/tls/testdata/Server-TLSv12-Resume       |  76 ++---
 .../tls/testdata/Server-TLSv13-AES128-SHA256       | 166 +++++------
 .../tls/testdata/Server-TLSv13-AES256-SHA384       | 172 +++++------
 src/crypto/tls/testdata/Server-TLSv13-ALPN         | 166 +++++------
 .../tls/testdata/Server-TLSv13-ALPN-Fallback       | 164 +++++-----
 .../tls/testdata/Server-TLSv13-ALPN-NotConfigured  | 166 +++++------
 .../tls/testdata/Server-TLSv13-CHACHA20-SHA256     | 166 +++++------
 .../Server-TLSv13-ClientAuthRequestedAndECDSAGiven | 332 ++++++++++-----------
 ...erver-TLSv13-ClientAuthRequestedAndEd25519Given | 269 +++++++++--------
 .../Server-TLSv13-ClientAuthRequestedAndGiven      | 326 ++++++++++----------
 .../Server-TLSv13-ClientAuthRequestedNotGiven      | 178 +++++------
 .../tls/testdata/Server-TLSv13-ECDHE-ECDSA-AES     | 158 +++++-----
 src/crypto/tls/testdata/Server-TLSv13-Ed25519      | 122 ++++----
 .../testdata/Server-TLSv13-ExportKeyingMaterial    | 166 +++++------
 .../tls/testdata/Server-TLSv13-HelloRetryRequest   | 188 ++++++------
 src/crypto/tls/testdata/Server-TLSv13-IssueTicket  | 166 +++++------
 .../testdata/Server-TLSv13-IssueTicketPreDisable   | 166 +++++------
 src/crypto/tls/testdata/Server-TLSv13-P256         | 170 +++++------
 src/crypto/tls/testdata/Server-TLSv13-RSA-RSAPSS   | 166 +++++------
 src/crypto/tls/testdata/Server-TLSv13-Resume       |  84 +++---
 .../Server-TLSv13-Resume-HelloRetryRequest         | 128 ++++----
 src/crypto/tls/testdata/Server-TLSv13-X25519       | 166 +++++------
 src/crypto/tls/ticket.go                           | 112 ++-----
 34 files changed, 2254 insertions(+), 2303 deletions(-)

diff --git a/api/next/60105.txt b/api/next/60105.txt
new file mode 100644
index 0000000000..75adbcc8aa
--- /dev/null
+++ b/api/next/60105.txt
@@ -0,0 +1,3 @@
+pkg crypto/tls, func ParseSessionState([]uint8) (*SessionState, error) #60105
+pkg crypto/tls, method (*SessionState) Bytes() ([]uint8, error) #60105
+pkg crypto/tls, type SessionState struct #60105
diff --git a/src/crypto/tls/handshake_messages_test.go b/src/crypto/tls/handshake_messages_test.go
index 1ef6c432ff..b280f09674 100644
--- a/src/crypto/tls/handshake_messages_test.go
+++ b/src/crypto/tls/handshake_messages_test.go
@@ -15,7 +15,7 @@ import (
 	"time"
 )
 
-var tests = []any{
+var tests = []handshakeMessage{
 	&clientHelloMsg{},
 	&serverHelloMsg{},
 	&finishedMsg{},
@@ -28,14 +28,13 @@ var tests = []any{
 	&certificateStatusMsg{},
 	&clientKeyExchangeMsg{},
 	&newSessionTicketMsg{},
-	&sessionState{},
-	&sessionStateTLS13{},
 	&encryptedExtensionsMsg{},
 	&endOfEarlyDataMsg{},
 	&keyUpdateMsg{},
 	&newSessionTicketMsgTLS13{},
 	&certificateRequestMsgTLS13{},
 	&certificateMsgTLS13{},
+	&SessionState{},
 }
 
 func mustMarshal(t *testing.T, msg handshakeMessage) []byte {
@@ -50,8 +49,8 @@ func mustMarshal(t *testing.T, msg handshakeMessage) []byte {
 func TestMarshalUnmarshal(t *testing.T) {
 	rand := rand.New(rand.NewSource(time.Now().UnixNano()))
 
-	for i, iface := range tests {
-		ty := reflect.ValueOf(iface).Type()
+	for i, m := range tests {
+		ty := reflect.ValueOf(m).Type()
 
 		n := 100
 		if testing.Short() {
@@ -66,15 +65,14 @@ func TestMarshalUnmarshal(t *testing.T) {
 
 			m1 := v.Interface().(handshakeMessage)
 			marshaled := mustMarshal(t, m1)
-			m2 := iface.(handshakeMessage)
-			if !m2.unmarshal(marshaled) {
+			if !m.unmarshal(marshaled) {
 				t.Errorf("#%d failed to unmarshal %#v %x", i, m1, marshaled)
 				break
 			}
-			m2.marshal() // to fill any marshal cache in the message
+			m.marshal() // to fill any marshal cache in the message
 
-			if !reflect.DeepEqual(m1, m2) {
-				t.Errorf("#%d got:%#v want:%#v %x", i, m2, m1, marshaled)
+			if !reflect.DeepEqual(m1, m) {
+				t.Errorf("#%d got:%#v want:%#v %x", i, m, m1, marshaled)
 				break
 			}
 
@@ -85,7 +83,7 @@ func TestMarshalUnmarshal(t *testing.T) {
 				// data is optional and the length of the
 				// Finished varies across versions.
 				for j := 0; j < len(marshaled); j++ {
-					if m2.unmarshal(marshaled[0:j]) {
+					if m.unmarshal(marshaled[0:j]) {
 						t.Errorf("#%d unmarshaled a prefix of length %d of %#v", i, j, m1)
 						break
 					}
@@ -97,9 +95,7 @@ func TestMarshalUnmarshal(t *testing.T) {
 
 func TestFuzz(t *testing.T) {
 	rand := rand.New(rand.NewSource(0))
-	for _, iface := range tests {
-		m := iface.(handshakeMessage)
-
+	for _, m := range tests {
 		for j := 0; j < 1000; j++ {
 			len := rand.Intn(100)
 			bytes := randomBytes(len, rand)
@@ -317,22 +313,11 @@ func (*newSessionTicketMsg) Generate(rand *rand.Rand, size int) reflect.Value {
 	return reflect.ValueOf(m)
 }
 
-func (*sessionState) Generate(rand *rand.Rand, size int) reflect.Value {
-	s := &sessionState{}
-	s.vers = uint16(rand.Intn(10000))
+func (*SessionState) Generate(rand *rand.Rand, size int) reflect.Value {
+	s := &SessionState{}
+	s.version = uint16(rand.Intn(10000))
 	s.cipherSuite = uint16(rand.Intn(10000))
-	s.masterSecret = randomBytes(rand.Intn(100)+1, rand)
-	s.createdAt = uint64(rand.Int63())
-	for i := 0; i < rand.Intn(20); i++ {
-		s.certificates = append(s.certificates, randomBytes(rand.Intn(500)+1, rand))
-	}
-	return reflect.ValueOf(s)
-}
-
-func (*sessionStateTLS13) Generate(rand *rand.Rand, size int) reflect.Value {
-	s := &sessionStateTLS13{}
-	s.cipherSuite = uint16(rand.Intn(10000))
-	s.resumptionSecret = randomBytes(rand.Intn(100)+1, rand)
+	s.secret = randomBytes(rand.Intn(100)+1, rand)
 	s.createdAt = uint64(rand.Int63())
 	for i := 0; i < rand.Intn(2)+1; i++ {
 		s.certificate.Certificate = append(
@@ -350,6 +335,16 @@ func (*sessionStateTLS13) Generate(rand *rand.Rand, size int) reflect.Value {
 	return reflect.ValueOf(s)
 }
 
+func (s *SessionState) marshal() ([]byte, error) { return s.Bytes() }
+func (s *SessionState) unmarshal(b []byte) bool {
+	ss, err := ParseSessionState(b)
+	if err != nil {
+		return false
+	}
+	*s = *ss
+	return true
+}
+
 func (*endOfEarlyDataMsg) Generate(rand *rand.Rand, size int) reflect.Value {
 	m := &endOfEarlyDataMsg{}
 	return reflect.ValueOf(m)
diff --git a/src/crypto/tls/handshake_server.go b/src/crypto/tls/handshake_server.go
index 49d2d372a5..5e5badca95 100644
--- a/src/crypto/tls/handshake_server.go
+++ b/src/crypto/tls/handshake_server.go
@@ -31,7 +31,7 @@ type serverHandshakeState struct {
 	ecSignOk     bool
 	rsaDecryptOk bool
 	rsaSignOk    bool
-	sessionState *sessionState
+	sessionState *SessionState
 	finishedHash finishedHash
 	masterSecret []byte
 	cert         *Certificate
@@ -410,11 +410,11 @@ func (hs *serverHandshakeState) checkForResumption() bool {
 	if plaintext == nil {
 		return false
 	}
-	hs.sessionState = &sessionState{}
-	ok := hs.sessionState.unmarshal(plaintext)
-	if !ok {
+	ss, err := ParseSessionState(plaintext)
+	if err != nil {
 		return false
 	}
+	hs.sessionState = ss
 
 	// TLS 1.2 tickets don't natively have a lifetime, but we want to avoid
 	// re-wrapping the same master secret in different tickets over and over for
@@ -425,7 +425,7 @@ func (hs *serverHandshakeState) checkForResumption() bool {
 	}
 
 	// Never resume a session for a different TLS version.
-	if c.vers != hs.sessionState.vers {
+	if c.vers != hs.sessionState.version {
 		return false
 	}
 
@@ -448,7 +448,7 @@ func (hs *serverHandshakeState) checkForResumption() bool {
 		return false
 	}
 
-	sessionHasClientCerts := len(hs.sessionState.certificates) != 0
+	sessionHasClientCerts := len(hs.sessionState.certificate.Certificate) != 0
 	needClientCerts := requiresClientCert(c.config.ClientAuth)
 	if needClientCerts && !sessionHasClientCerts {
 		return false
@@ -481,9 +481,7 @@ func (hs *serverHandshakeState) doResumeHandshake() error {
 		return err
 	}
 
-	if err := c.processCertsFromClient(Certificate{
-		Certificate: hs.sessionState.certificates,
-	}); err != nil {
+	if err := c.processCertsFromClient(hs.sessionState.certificate); err != nil {
 		return err
 	}
 
@@ -494,7 +492,7 @@ func (hs *serverHandshakeState) doResumeHandshake() error {
 		}
 	}
 
-	hs.masterSecret = hs.sessionState.masterSecret
+	hs.masterSecret = hs.sessionState.secret
 
 	return nil
 }
@@ -772,14 +770,18 @@ func (hs *serverHandshakeState) sendSessionTicket() error {
 	for _, cert := range c.peerCertificates {
 		certsFromClient = append(certsFromClient, cert.Raw)
 	}
-	state := sessionState{
-		vers:         c.vers,
-		cipherSuite:  hs.suite.id,
-		createdAt:    createdAt,
-		masterSecret: hs.masterSecret,
-		certificates: certsFromClient,
-	}
-	stateBytes, err := state.marshal()
+	state := SessionState{
+		version:     c.vers,
+		cipherSuite: hs.suite.id,
+		createdAt:   createdAt,
+		secret:      hs.masterSecret,
+		certificate: Certificate{
+			Certificate:                 certsFromClient,
+			OCSPStaple:                  c.ocspResponse,
+			SignedCertificateTimestamps: c.scts,
+		},
+	}
+	stateBytes, err := state.Bytes()
 	if err != nil {
 		return err
 	}
diff --git a/src/crypto/tls/handshake_server_tls13.go b/src/crypto/tls/handshake_server_tls13.go
index 791b34f24a..f770a21663 100644
--- a/src/crypto/tls/handshake_server_tls13.go
+++ b/src/crypto/tls/handshake_server_tls13.go
@@ -279,8 +279,8 @@ func (hs *serverHandshakeStateTLS13) checkForResumption() error {
 		if plaintext == nil {
 			continue
 		}
-		sessionState := new(sessionStateTLS13)
-		if ok := sessionState.unmarshal(plaintext); !ok {
+		sessionState, err := ParseSessionState(plaintext)
+		if err != nil || sessionState.version != VersionTLS13 {
 			continue
 		}
 
@@ -310,9 +310,7 @@ func (hs *serverHandshakeStateTLS13) checkForResumption() error {
 			continue
 		}
 
-		psk := hs.suite.expandLabel(sessionState.resumptionSecret, "resumption",
-			nil, hs.suite.hash.Size())
-		hs.earlySecret = hs.suite.extract(psk, nil)
+		hs.earlySecret = hs.suite.extract(sessionState.secret, nil)
 		binderKey := hs.suite.deriveSecret(hs.earlySecret, resumptionBinderLabel, nil)
 		// Clone the transcript in case a HelloRetryRequest was recorded.
 		transcript := cloneHash(hs.transcript, hs.suite.hash)
@@ -771,6 +769,10 @@ func (hs *serverHandshakeStateTLS13) sendSessionTickets() error {
 
 	resumptionSecret := hs.suite.deriveSecret(hs.masterSecret,
 		resumptionLabel, hs.transcript)
+	// ticket_nonce, which must be unique per connection, is always left at
+	// zero because we only ever send one ticket per connection.
+	psk := hs.suite.expandLabel(resumptionSecret, "resumption",
+		nil, hs.suite.hash.Size())
 
 	m := new(newSessionTicketMsgTLS13)
 
@@ -778,17 +780,18 @@ func (hs *serverHandshakeStateTLS13) sendSessionTickets() error {
 	for _, cert := range c.peerCertificates {
 		certsFromClient = append(certsFromClient, cert.Raw)
 	}
-	state := sessionStateTLS13{
-		cipherSuite:      hs.suite.id,
-		createdAt:        uint64(c.config.time().Unix()),
-		resumptionSecret: resumptionSecret,
+	state := &SessionState{
+		version:     c.vers,
+		cipherSuite: hs.suite.id,
+		createdAt:   uint64(c.config.time().Unix()),
+		secret:      psk,
 		certificate: Certificate{
 			Certificate:                 certsFromClient,
 			OCSPStaple:                  c.ocspResponse,
 			SignedCertificateTimestamps: c.scts,
 		},
 	}
-	stateBytes, err := state.marshal()
+	stateBytes, err := state.Bytes()
 	if err != nil {
 		c.sendAlert(alertInternalError)
 		return err
@@ -809,9 +812,6 @@ func (hs *serverHandshakeStateTLS13) sendSessionTickets() error {
 	}
 	m.ageAdd = binary.LittleEndian.Uint32(ageAdd)
 
-	// ticket_nonce, which must be unique per connection, is always left at
-	// zero because we only ever send one ticket per connection.
-
 	if _, err := c.writeHandshakeRecord(m, nil); err != nil {
 		return err
 	}
diff --git a/src/crypto/tls/testdata/Server-TLSv10-ExportKeyingMaterial b/src/crypto/tls/testdata/Server-TLSv10-ExportKeyingMaterial
index 006b12410a..4b42b70b00 100644
--- a/src/crypto/tls/testdata/Server-TLSv10-ExportKeyingMaterial
+++ b/src/crypto/tls/testdata/Server-TLSv10-ExportKeyingMaterial
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 55 01 00 00  51 03 01 f5 f3 42 9e 4a  |....U...Q....B.J|
-00000010  f4 5f cc c5 18 d0 77 f2  9f 1a 37 d7 44 6b f5 09  |._....w...7.Dk..|
-00000020  69 ab 8b ee d7 1c 63 8d  95 59 bc 00 00 04 c0 14  |i.....c..Y......|
+00000000  16 03 01 00 55 01 00 00  51 03 01 58 36 60 2e c2  |....U...Q..X6`..|
+00000010  61 c3 fb 34 e3 b1 09 ca  00 58 fb 2b 72 d6 de 35  |a..4.....X.+r..5|
+00000020  a1 ed 5b ec 40 64 e2 cc  ff 3c c6 00 00 04 c0 14  |..[.@d...<......|
 00000030  00 ff 01 00 00 24 00 0b  00 04 03 00 01 02 00 0a  |.....$..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000050  00 00 00 16 00 00 00 17  00 00                    |..........|
@@ -50,42 +50,42 @@
 00000290  d4 db fe 3d 13 60 84 5c  21 d3 3b e9 fa e7 16 03  |...=.`.\!.;.....|
 000002a0  01 00 aa 0c 00 00 a6 03  00 1d 20 2f e5 7d a3 47  |.......... /.}.G|
 000002b0  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
-000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 00 80 3f 8b 3e  |......_X.;t..?.>|
-000002d0  b0 29 ea c2 25 87 26 bb  69 0d b8 52 18 d4 82 19  |.)..%.&.i..R....|
-000002e0  90 3b e9 dc 77 94 61 fe  69 95 9f 50 85 34 c5 dd  |.;..w.a.i..P.4..|
-000002f0  c0 a1 d5 d6 83 e4 e3 ba  8c f7 6e 39 e0 14 94 30  |..........n9...0|
-00000300  34 16 f0 5b c0 32 92 a3  21 8e 21 c8 57 05 16 a3  |4..[.2..!.!.W...|
-00000310  ea 66 0a 29 20 14 32 e2  f6 b2 7f 17 04 dc 8f 1b  |.f.) .2.........|
-00000320  2c 56 50 75 bf 84 c7 11  84 18 a3 05 08 1a 3a e4  |,VPu..........:.|
-00000330  16 ec f2 b5 1f 29 9b 56  8f 5c 9c f2 91 3e 09 5e  |.....).V.\...>.^|
-00000340  c7 59 45 12 37 39 06 c5  11 3c fc ee 49 16 03 01  |.YE.79...<..I...|
+000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 00 80 cc 63 02  |......_X.;t...c.|
+000002d0  c4 91 d5 33 71 50 31 1f  7c d0 9c 3d f4 86 33 e6  |...3qP1.|..=..3.|
+000002e0  28 32 81 af d9 33 c2 c9  38 89 38 3f 1b 01 07 c2  |(2...3..8.8?....|
+000002f0  99 46 68 ea db 0e a3 b0  a7 e6 de b3 8f 9a 3d f1  |.Fh...........=.|
+00000300  76 72 a8 e4 4a 63 97 fd  d2 77 23 79 13 cb ac d5  |vr..Jc...w#y....|
+00000310  db fa 89 ae 45 98 6f 1d  38 2c 20 d2 ba 94 eb 01  |....E.o.8, .....|
+00000320  91 5e 57 b6 a0 95 dc 70  ad 06 f7 c4 02 b9 06 c3  |.^W....p........|
+00000330  84 04 de b8 2c 71 31 4f  94 47 78 73 b1 72 e4 00  |....,q1O.Gxs.r..|
+00000340  4a 58 bb 88 fd 6f 55 6a  49 17 ef b9 6b 16 03 01  |JX...oUjI...k...|
 00000350  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
-00000000  16 03 01 00 25 10 00 00  21 20 a1 f8 df c3 de d5  |....%...! ......|
-00000010  70 2f 18 10 4e 4e 86 18  ae 89 a5 4a 34 81 40 f8  |p/..NN.....J4.@.|
-00000020  9d a6 f4 cf b0 5b b5 43  54 08 14 03 01 00 01 01  |.....[.CT.......|
-00000030  16 03 01 00 30 86 24 e7  70 5c ea 25 e3 65 63 b5  |....0.$.p\.%.ec.|
-00000040  91 de 82 c3 23 ce b1 68  0c b4 a0 f3 ae 5d 46 cd  |....#..h.....]F.|
-00000050  90 ce 4f 4c b0 c7 14 13  60 17 32 b4 fc 2a 0b 49  |..OL....`.2..*.I|
-00000060  8d 0e 3d e8 2a                                    |..=.*|
+00000000  16 03 01 00 25 10 00 00  21 20 06 ca bc 6d bc 25  |....%...! ...m.%|
+00000010  25 0c 1a 06 b5 36 e6 de  20 57 fe bc 24 e9 87 e4  |%....6.. W..$...|
+00000020  cd 57 a0 91 7e 7e f2 79  5b 0b 14 03 01 00 01 01  |.W..~~.y[.......|
+00000030  16 03 01 00 30 85 12 fa  73 ea 8f 6f a5 d4 15 3b  |....0...s..o...;|
+00000040  70 ac 6b 95 bc 3e 75 b3  ee c7 f1 1a 9e b2 b4 f0  |p.k..>u.........|
+00000050  0d f3 30 da 63 dc f7 c4  cd d6 ab ed db e5 c6 f9  |..0.c...........|
+00000060  6b 4f 52 3d 04                                    |kOR=.|
 >>> Flow 4 (server to client)
 00000000  16 03 01 00 7b 04 00 00  77 00 00 00 00 00 71 00  |....{...w.....q.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6d ec a4 83 51 ed 14 ef  68 ca 42 c5 4c fe ae 28  |m...Q...h.B.L..(|
-00000030  76 e9 99 d7 d3 45 dd ff  bd 64 54 a3 a8 bf 69 17  |v....E...dT...i.|
-00000040  28 b5 cb bb 13 1c e8 a8  9c f8 a7 43 81 9d 1d bc  |(..........C....|
-00000050  00 96 83 1d cc da 66 d7  20 e1 52 44 b4 49 38 16  |......f. .RD.I8.|
-00000060  56 c5 9e be 43 6c 3c 82  7a 50 fd d6 e6 00 99 27  |V...Cl<.zP.....'|
-00000070  49 a1 65 7b cb 82 3f 9a  74 17 08 2b fd 7b de db  |I.e{..?.t..+.{..|
-00000080  14 03 01 00 01 01 16 03  01 00 30 eb 9f f3 b2 32  |..........0....2|
-00000090  44 c2 58 ab 22 7f 41 a0  30 84 71 18 7a df 48 6b  |D.X.".A.0.q.z.Hk|
-000000a0  c7 2d 8b 8e 8f 8c 7f 5d  58 7c 2c 61 5d 0d bc ce  |.-.....]X|,a]...|
-000000b0  60 f0 47 b3 e2 86 5a 82  30 26 95 17 03 01 00 20  |`.G...Z.0&..... |
-000000c0  12 3e 23 0a f5 97 2a 6b  bf be f4 82 7b 31 92 9e  |.>#...*k....{1..|
-000000d0  32 c9 1f 4f 8e cc 74 5e  41 da ff 45 68 3c 82 07  |2..O..t^A..Eh<..|
-000000e0  17 03 01 00 30 31 73 bb  fd 8e ba 4d c3 74 14 9b  |....01s....M.t..|
-000000f0  81 c0 69 38 e6 32 86 35  b2 fb 2a af 2c 69 c1 ca  |..i8.2.5..*.,i..|
-00000100  0c 94 35 9a fa 7b ab b4  04 1e 56 6f 59 f9 40 38  |..5..{....VoY.@8|
-00000110  e6 a9 20 96 15 15 03 01  00 20 09 20 d5 0e cd 68  |.. ...... . ...h|
-00000120  79 de ea 6b 0e 84 98 e5  75 64 c4 e8 b1 9f c4 cc  |y..k....ud......|
-00000130  d6 4c b6 be cf 42 78 c6  6a 2e                    |.L...Bx.j.|
+00000020  6d 2d 70 97 51 ed 14 ef  68 ca 42 c5 4c 12 19 5b  |m-p.Q...h.B.L..[|
+00000030  90 88 76 b1 48 c1 f4 61  1a 16 81 2e f7 5f 87 79  |..v.H..a....._.y|
+00000040  5c b7 dd b1 be 7f f4 b8  6a fb af 51 a3 35 5e 20  |\.......j..Q.5^ |
+00000050  b4 a2 b9 69 8b 93 45 4f  1b af 8c 69 c9 49 38 16  |...i..EO...i.I8.|
+00000060  79 6d a8 7f 7e 49 b0 b9  5a 88 19 1d 82 c2 68 f7  |ym..~I..Z.....h.|
+00000070  8a b4 45 8c f9 86 a7 fe  f7 74 27 70 6f 52 6d 11  |..E......t'poRm.|
+00000080  14 03 01 00 01 01 16 03  01 00 30 3b 4f 4d 0a 0d  |..........0;OM..|
+00000090  d8 28 9f 41 e6 be a5 9f  f9 f1 a5 a9 f7 9f 24 90  |.(.A..........$.|
+000000a0  11 52 8a 0f 59 9c 55 79  68 7c 55 71 43 69 15 d9  |.R..Y.Uyh|UqCi..|
+000000b0  b1 5e cc 80 6d ba 38 e5  a7 72 8c 17 03 01 00 20  |.^..m.8..r..... |
+000000c0  cb bc e9 a2 a7 d1 3e 2c  6c 1e 37 2e c1 a9 56 25  |......>,l.7...V%|
+000000d0  d9 47 8e 3c 82 dc 6c 13  8b 0c 59 dc c2 06 28 ee  |.G.<..l...Y...(.|
+000000e0  17 03 01 00 30 8d 88 6f  ba 26 3f a0 e6 7d 9e cf  |....0..o.&?..}..|
+000000f0  6f f1 60 af ba 2e db b1  56 7c 95 00 51 fd 36 a0  |o.`.....V|..Q.6.|
+00000100  94 64 e9 40 ea 25 8c 99  a2 6b 11 43 34 08 29 79  |.d.@.%...k.C4.)y|
+00000110  e9 7e 50 d8 c0 15 03 01  00 20 7d aa 05 d0 ce d6  |.~P...... }.....|
+00000120  77 52 d8 f7 65 d9 3b fe  c3 51 f3 b6 67 90 f1 39  |wR..e.;..Q..g..9|
+00000130  62 a5 97 48 01 b0 4e 8b  16 48                    |b..H..N..H|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ALPN b/src/crypto/tls/testdata/Server-TLSv12-ALPN
index 21b60afd54..51b499ee93 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ALPN
+++ b/src/crypto/tls/testdata/Server-TLSv12-ALPN
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 9d 01 00 00  99 03 03 38 64 71 8a 57  |...........8dq.W|
-00000010  cb 23 9d ce 7c 41 93 09  c0 a9 47 ca 56 db 97 12  |.#..|A....G.V...|
-00000020  14 c8 8e 3a 5a 56 34 f7  ad a2 90 00 00 04 cc a8  |...:ZV4.........|
+00000000  16 03 01 00 9d 01 00 00  99 03 03 44 32 55 fd 3f  |...........D2U.?|
+00000010  75 01 65 4d 16 25 a6 97  f4 54 9c d6 65 c1 f4 16  |u.eM.%...T..e...|
+00000020  d8 cd 96 a8 9c d4 4e 7e  e6 4b 88 00 00 04 cc a8  |......N~.K......|
 00000030  00 ff 01 00 00 6c 00 0b  00 04 03 00 01 02 00 0a  |.....l..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000050  00 00 00 10 00 10 00 0e  06 70 72 6f 74 6f 32 06  |.........proto2.|
@@ -56,36 +56,36 @@
 000002a0  3d 13 60 84 5c 21 d3 3b  e9 fa e7 16 03 03 00 ac  |=.`.\!.;........|
 000002b0  0c 00 00 a8 03 00 1d 20  2f e5 7d a3 47 cd 62 43  |....... /.}.G.bC|
 000002c0  15 28 da ac 5f bb 29 07  30 ff f6 84 af c4 cf c2  |.(.._.).0.......|
-000002d0  ed 90 99 5f 58 cb 3b 74  08 04 00 80 36 d7 55 53  |..._X.;t....6.US|
-000002e0  60 3e 9a ca 01 8e f9 f4  16 d0 66 30 12 29 ae 0d  |`>........f0.)..|
-000002f0  23 f4 73 c6 d2 74 03 79  b5 b9 27 f6 33 e3 35 2e  |#.s..t.y..'.3.5.|
-00000300  8e d8 d0 30 b6 9e cb 96  99 91 d7 3c 3e ec 1f b4  |...0.......<>...|
-00000310  b0 82 04 03 b3 f4 d6 60  38 9e d5 1a 38 fe ac ef  |.......`8...8...|
-00000320  10 e9 02 94 c5 8a b7 cd  69 cd 1d de 4f 61 5e eb  |........i...Oa^.|
-00000330  57 31 e7 de 6d 9a e4 d9  9a 09 c9 3d 3a a6 f1 65  |W1..m......=:..e|
-00000340  95 1a 54 c3 bf 7c a9 22  47 90 d4 09 65 14 54 cc  |..T..|."G...e.T.|
-00000350  05 1f 73 1a e0 b9 9e f9  9a 81 be 91 16 03 03 00  |..s.............|
+000002d0  ed 90 99 5f 58 cb 3b 74  08 04 00 80 60 ad 5e 8b  |..._X.;t....`.^.|
+000002e0  00 59 44 04 5e 91 92 42  a8 80 12 2a 32 42 50 53  |.YD.^..B...*2BPS|
+000002f0  3b cb e9 9f cf 40 f0 c3  93 13 c3 d7 02 ac 13 ae  |;....@..........|
+00000300  f8 25 a3 4b a2 0f b2 10  78 36 e8 ce 82 bb 1b b3  |.%.K....x6......|
+00000310  34 f4 b9 33 4f f2 9c 46  6f 38 34 15 6d 84 3e fd  |4..3O..Fo84.m.>.|
+00000320  08 bf 90 0c 9c e8 08 86  d5 df 9d 19 99 b8 5f 4c  |.............._L|
+00000330  16 f5 51 3b eb e5 e8 69  54 71 f9 08 16 1f 5d 5a  |..Q;...iTq....]Z|
+00000340  d0 29 86 cf ea 28 1a a6  5b 6a 8f 2a 51 dc a2 8e  |.)...(..[j.*Q...|
+00000350  ba 97 ac dd b3 2f 49 60  e0 42 90 30 16 03 03 00  |...../I`.B.0....|
 00000360  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 79 2b 97 00 d7 66  |....%...! y+...f|
-00000010  f9 ca 21 3c 1a 2b 60 7a  e1 32 73 2b 7f f7 65 19  |..!<.+`z.2s+..e.|
-00000020  08 ad 52 39 aa a9 8a 0b  9f 44 14 03 03 00 01 01  |..R9.....D......|
-00000030  16 03 03 00 20 6e f1 de  c4 b0 35 42 12 37 f2 e1  |.... n....5B.7..|
-00000040  36 d7 4c 4e 11 98 72 ec  12 6c 2d 5e 11 3b c4 a4  |6.LN..r..l-^.;..|
-00000050  9a 35 d5 5d 1c                                    |.5.].|
+00000000  16 03 03 00 25 10 00 00  21 20 91 5c 17 2b 1f 55  |....%...! .\.+.U|
+00000010  9c e7 ff 7c f2 2d 1f fc  f1 3c 48 fc d9 35 21 86  |...|.-...<H..5!.|
+00000020  ec 61 c5 36 f1 85 f3 f5  b7 71 14 03 03 00 01 01  |.a.6.....q......|
+00000030  16 03 03 00 20 f0 e8 14  bd b1 3c a7 94 03 4d 88  |.... .....<...M.|
+00000040  22 61 0e cc 2b 55 f1 97  bd e7 14 01 aa a0 ee 31  |"a..+U.........1|
+00000050  be 15 d6 34 45                                    |...4E|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 7b 04 00 00  77 00 00 00 00 00 71 00  |....{...w.....q.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6f e0 18 83 51 ed 14 ef  68 ca 42 c5 4c 8f d6 48  |o...Q...h.B.L..H|
-00000030  3e 65 16 36 87 11 c3 53  8c 8f 44 1a f5 6e 92 65  |>e.6...S..D..n.e|
-00000040  22 87 99 5f 58 18 48 86  79 d9 36 1e 23 4a 87 42  |".._X.H.y.6.#J.B|
-00000050  18 45 f6 03 2b e5 a5 55  b4 59 62 b4 db 49 38 16  |.E..+..U.Yb..I8.|
-00000060  2d d9 6b d5 66 55 c7 b9  d8 f1 03 6a 78 ea b9 93  |-.k.fU.....jx...|
-00000070  f4 1a 8c d3 79 91 b4 37  42 e9 84 0f ea d1 04 ce  |....y..7B.......|
-00000080  14 03 03 00 01 01 16 03  03 00 20 f4 ff 37 5f 7c  |.......... ..7_||
-00000090  c6 6a b3 31 5f 06 51 62  f2 76 a2 cf da a3 a5 60  |.j.1_.Qb.v.....`|
-000000a0  de 5b 6b bf 0d 03 2e ce  de 9e 90 17 03 03 00 1d  |.[k.............|
-000000b0  7e 9f a9 87 fc e1 e8 84  7a 81 77 70 4a d1 52 cf  |~.......z.wpJ.R.|
-000000c0  ba c2 0b f6 99 2f 99 cb  fb 73 25 c7 1d 15 03 03  |...../...s%.....|
-000000d0  00 12 ac 41 7f af d0 87  25 e3 82 f4 c9 e5 fa ef  |...A....%.......|
-000000e0  d2 89 53 e6                                       |..S.|
+00000020  6f 2d 7c 2b 51 ed 14 ef  68 ca 42 c5 4c 54 b3 3b  |o-|+Q...h.B.LT.;|
+00000030  73 c0 ef a3 14 3b a0 04  7d f2 26 59 6f ed 01 d3  |s....;..}.&Yo...|
+00000040  9c 7e e2 b0 f3 92 47 d5  69 bc 87 7e 7b ee 9f b6  |.~....G.i..~{...|
+00000050  cd 7f 03 75 a2 5a 4a 7d  59 8d 3b ad 8a 49 38 16  |...u.ZJ}Y.;..I8.|
+00000060  00 0d 2b d0 0f 77 b2 47  dd 84 e0 2e 18 f4 ff 6c  |..+..w.G.......l|
+00000070  37 de fc 35 e4 0e 10 e4  30 45 94 ad 96 53 ee a5  |7..5....0E...S..|
+00000080  14 03 03 00 01 01 16 03  03 00 20 ce 8e 1d a5 49  |.......... ....I|
+00000090  b0 90 65 b0 de 4c 67 a6  e0 78 62 54 6e 64 02 07  |..e..Lg..xbTnd..|
+000000a0  c5 d0 44 ae a8 2a 11 96  fd c9 e6 17 03 03 00 1d  |..D..*..........|
+000000b0  d5 be b9 8b 0d fc bf 5d  73 40 e7 b5 a1 13 9b 02  |.......]s@......|
+000000c0  23 68 af 1d 1f 3e d3 74  23 67 3c 54 ec 15 03 03  |#h...>.t#g<T....|
+000000d0  00 12 57 06 e3 b6 8b de  45 8d f5 4d 6d fc 53 a4  |..W.....E..Mm.S.|
+000000e0  44 27 c9 79                                       |D'.y|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ALPN-Fallback b/src/crypto/tls/testdata/Server-TLSv12-ALPN-Fallback
index dd06ed876f..e6ac682dc3 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ALPN-Fallback
+++ b/src/crypto/tls/testdata/Server-TLSv12-ALPN-Fallback
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 a6 01 00 00  a2 03 03 90 5c 4c fb cb  |............\L..|
-00000010  af 3c 20 5e a0 4f 38 dd  9e 1b 0f 59 d1 30 78 aa  |.< ^.O8....Y.0x.|
-00000020  27 0b 8f c4 e3 c4 54 1f  a8 05 ed 00 00 04 cc a8  |'.....T.........|
+00000000  16 03 01 00 a6 01 00 00  a2 03 03 12 8a 27 d5 f3  |.............'..|
+00000010  16 59 38 0e cd a8 df 1a  d9 bd 80 d4 e3 0b 40 d3  |.Y8...........@.|
+00000020  ce 9f ac 99 81 b4 e8 af  fa 69 3a 00 00 04 cc a8  |.........i:.....|
 00000030  00 ff 01 00 00 75 00 0b  00 04 03 00 01 02 00 0a  |.....u..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000050  00 00 00 10 00 19 00 17  06 70 72 6f 74 6f 33 08  |.........proto3.|
@@ -55,36 +55,36 @@
 00000290  d4 db fe 3d 13 60 84 5c  21 d3 3b e9 fa e7 16 03  |...=.`.\!.;.....|
 000002a0  03 00 ac 0c 00 00 a8 03  00 1d 20 2f e5 7d a3 47  |.......... /.}.G|
 000002b0  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
-000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 08 04 00 80 88  |......_X.;t.....|
-000002d0  a6 17 7f f7 b9 ee 12 26  b8 0c b6 c5 fe 7b 0b cb  |.......&.....{..|
-000002e0  c3 79 dd 67 12 49 f1 0c  b7 2f a4 c9 f6 65 83 63  |.y.g.I.../...e.c|
-000002f0  3e 6b e9 b3 60 e8 db a5  62 5a 41 9d 9a 63 07 df  |>k..`...bZA..c..|
-00000300  19 66 55 80 30 56 27 a4  04 f0 92 73 c9 1a 81 26  |.fU.0V'....s...&|
-00000310  c1 aa b1 56 4e bf 1c 04  a7 6b aa 63 72 5c c3 d9  |...VN....k.cr\..|
-00000320  8e d9 c6 bb b9 b0 bc 31  90 e4 c3 6d 36 04 cc 34  |.......1...m6..4|
-00000330  32 83 99 4a d5 75 ce c3  6c ef e1 55 89 1c 1d 80  |2..J.u..l..U....|
-00000340  86 b1 07 2f 5b 03 63 97  9a 8c 9e 33 13 18 fb 16  |.../[.c....3....|
+000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 08 04 00 80 be  |......_X.;t.....|
+000002d0  18 7c e1 87 fa 02 da 69  73 5f a5 30 43 8a 17 66  |.|.....is_.0C..f|
+000002e0  21 d6 14 6a f8 1d e9 8b  ee 9c b4 55 79 ae aa 2f  |!..j.......Uy../|
+000002f0  f6 4a 93 44 12 89 86 13  88 9b d4 82 92 35 34 99  |.J.D.........54.|
+00000300  57 5d d8 9f ee b9 ed a1  b5 e4 c7 70 7c 6b bf 8c  |W].........p|k..|
+00000310  e7 14 08 c5 63 d5 9e 91  bd d6 13 95 e6 1d 8d a8  |....c...........|
+00000320  cf 9d 45 28 27 bf a7 32  d8 85 dc d7 84 0d d7 64  |..E('..2.......d|
+00000330  14 71 1b eb b1 4b 44 8d  78 93 30 65 23 e8 e8 5a  |.q...KD.x.0e#..Z|
+00000340  68 46 1a bb c8 86 d6 d3  30 c0 78 eb ec 14 3c 16  |hF......0.x...<.|
 00000350  03 03 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 5e a8 04 6a 75 cb  |....%...! ^..ju.|
-00000010  4e a8 af 5a 33 be 07 d2  0e e0 72 44 48 10 46 df  |N..Z3.....rDH.F.|
-00000020  08 97 9c 53 7b e8 c1 37  16 73 14 03 03 00 01 01  |...S{..7.s......|
-00000030  16 03 03 00 20 f1 80 5f  6e a6 99 39 64 a8 1d e6  |.... .._n..9d...|
-00000040  5d c9 03 7d b5 00 78 fb  09 46 ce 65 75 3d 34 d5  |]..}..x..F.eu=4.|
-00000050  48 cb 50 a5 b4                                    |H.P..|
+00000000  16 03 03 00 25 10 00 00  21 20 15 f6 a1 74 86 af  |....%...! ...t..|
+00000010  b8 fe 04 13 74 ae 41 8b  ed d6 42 de 46 67 c9 9a  |....t.A...B.Fg..|
+00000020  f5 50 98 38 5b fa 04 3e  ce 1f 14 03 03 00 01 01  |.P.8[..>........|
+00000030  16 03 03 00 20 0f d0 e1  15 af 13 8e 51 e5 48 4c  |.... .......Q.HL|
+00000040  5f 4c 08 77 e1 8f b4 8e  2d e0 ba 05 c3 de 7a 48  |_L.w....-.....zH|
+00000050  43 3d ec 49 8e                                    |C=.I.|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 7b 04 00 00  77 00 00 00 00 00 71 00  |....{...w.....q.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6f e0 18 83 51 ed 14 ef  68 ca 42 c5 4c 81 6e af  |o...Q...h.B.L.n.|
-00000030  71 0a 8a c0 25 ed 47 8c  e2 48 bd 70 b6 db d4 3a  |q...%.G..H.p...:|
-00000040  a4 bf 9e f2 73 57 23 12  0c 3f ab 29 0b 98 c6 14  |....sW#..?.)....|
-00000050  b7 5d 8b 90 4f a0 62 88  0f 04 19 33 cb 49 38 16  |.]..O.b....3.I8.|
-00000060  dc 52 be a8 9d af 25 3c  7b 13 27 79 4e 66 ff fa  |.R....%<{.'yNf..|
-00000070  a7 68 27 c5 bc fe 2a 7e  49 54 4b db a1 9e 62 bf  |.h'...*~ITK...b.|
-00000080  14 03 03 00 01 01 16 03  03 00 20 32 61 a0 7c 8a  |.......... 2a.|.|
-00000090  f5 8b 55 ca 44 54 b8 0c  24 62 4f 06 81 26 27 24  |..U.DT..$bO..&'$|
-000000a0  38 f2 92 e3 43 fb 5a 13  c4 b3 57 17 03 03 00 1d  |8...C.Z...W.....|
-000000b0  60 c5 bf 3c 84 0e ec 68  e9 d3 87 fd 0d 2e 3d ba  |`..<...h......=.|
-000000c0  6e 44 6d 96 f3 60 59 65  d8 25 3f 3a cb 15 03 03  |nDm..`Ye.%?:....|
-000000d0  00 12 fa 43 46 3f d4 38  05 2b ea 7b 96 a0 fc d8  |...CF?.8.+.{....|
-000000e0  b7 fe e1 54                                       |...T|
+00000020  6f 2d 7c 2b 51 ed 14 ef  68 ca 42 c5 4c 0d 8a 29  |o-|+Q...h.B.L..)|
+00000030  3e d5 5f cb 9f 12 fc a5  2f 79 89 18 8e 55 39 5b  |>._...../y...U9[|
+00000040  c4 54 4d 06 f0 27 6e eb  c2 0e 69 6d b4 ae 02 3a  |.TM..'n...im...:|
+00000050  b0 ea f5 ac 19 bb dd fa  fc 55 cf 69 fe 49 38 16  |.........U.i.I8.|
+00000060  fd a9 b3 02 9b e9 08 0c  d6 df 90 34 7a eb c7 ea  |...........4z...|
+00000070  03 a2 db de c4 2c df a3  46 5c 1d f7 30 a1 b4 74  |.....,..F\..0..t|
+00000080  14 03 03 00 01 01 16 03  03 00 20 62 bc b6 31 66  |.......... b..1f|
+00000090  7f 8d f2 75 ec aa 39 09  97 fa 00 7a f2 9b fb 22  |...u..9....z..."|
+000000a0  1e e6 91 6a 1b 4e f4 fb  8e e4 d8 17 03 03 00 1d  |...j.N..........|
+000000b0  f6 e3 25 fc 5a 3f f2 54  54 a9 26 0f 4d 19 cf 3b  |..%.Z?.TT.&.M..;|
+000000c0  14 04 bd 98 9d 8f ab 4f  59 74 0b 92 13 15 03 03  |.......OYt......|
+000000d0  00 12 40 47 2b c0 4b ed  b4 91 9f 1e 0a 04 98 4f  |..@G+.K........O|
+000000e0  03 1c d9 d5                                       |....|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ALPN-NotConfigured b/src/crypto/tls/testdata/Server-TLSv12-ALPN-NotConfigured
index d16fd12d61..e2fbcc14d1 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ALPN-NotConfigured
+++ b/src/crypto/tls/testdata/Server-TLSv12-ALPN-NotConfigured
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 9d 01 00 00  99 03 03 43 e0 d2 e0 0d  |...........C....|
-00000010  e9 e0 ba c5 77 93 87 c9  40 43 48 60 d4 ad b0 2d  |....w...@CH`...-|
-00000020  31 00 cd 33 5a ac ee e7  16 62 44 00 00 04 cc a8  |1..3Z....bD.....|
+00000000  16 03 01 00 9d 01 00 00  99 03 03 d8 c6 c5 66 3a  |..............f:|
+00000010  27 38 45 0c 21 ef 8e 2c  c6 d2 bf ce 77 16 33 20  |'8E.!..,....w.3 |
+00000020  a6 9f 88 c5 54 9e 63 08  98 ab cc 00 00 04 cc a8  |....T.c.........|
 00000030  00 ff 01 00 00 6c 00 0b  00 04 03 00 01 02 00 0a  |.....l..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000050  00 00 00 10 00 10 00 0e  06 70 72 6f 74 6f 32 06  |.........proto2.|
@@ -55,36 +55,36 @@
 00000290  d4 db fe 3d 13 60 84 5c  21 d3 3b e9 fa e7 16 03  |...=.`.\!.;.....|
 000002a0  03 00 ac 0c 00 00 a8 03  00 1d 20 2f e5 7d a3 47  |.......... /.}.G|
 000002b0  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
-000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 08 04 00 80 b4  |......_X.;t.....|
-000002d0  4f 34 83 09 ba 14 7e 7e  9c 91 cc a8 8e 67 1a a8  |O4....~~.....g..|
-000002e0  93 25 a9 61 6a e9 70 1e  e5 5f 4c cf 89 04 bf ce  |.%.aj.p.._L.....|
-000002f0  56 12 a5 f8 7f 11 20 26  73 e5 02 d1 41 fb c0 7b  |V..... &s...A..{|
-00000300  f1 0a bc 58 d6 09 4f 0c  2c 3e 2b cb e4 3d 0f 48  |...X..O.,>+..=.H|
-00000310  a6 c8 9d 56 d9 23 71 4f  c4 41 6d 92 e9 4f 67 d3  |...V.#qO.Am..Og.|
-00000320  09 06 55 8b 22 57 66 04  96 21 12 3b 34 f6 4b 80  |..U."Wf..!.;4.K.|
-00000330  1d 99 11 ca cb 08 31 53  47 94 e8 f5 f9 7b 2e a4  |......1SG....{..|
-00000340  ff 02 59 43 d1 d7 8b 97  ee 24 be 18 b9 12 a0 16  |..YC.....$......|
+000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 08 04 00 80 5a  |......_X.;t....Z|
+000002d0  01 45 ef 25 55 fe 24 9e  e3 f4 0a 67 f1 c2 0c ee  |.E.%U.$....g....|
+000002e0  e0 b4 4d de 1b 22 69 e1  92 93 a1 7f 0b ae 2a 9d  |..M.."i.......*.|
+000002f0  b0 37 fc 73 fd e2 95 77  10 58 b2 d6 26 33 29 63  |.7.s...w.X..&3)c|
+00000300  63 3e 57 87 b9 ac 9b 6f  cb c2 28 ac 15 0a cd b7  |c>W....o..(.....|
+00000310  46 0e 20 54 21 db 37 56  a8 1c e8 81 2f 5a 84 6c  |F. T!.7V..../Z.l|
+00000320  18 7b 89 f9 78 16 84 bb  7d 72 9c ae c3 66 38 a2  |.{..x...}r...f8.|
+00000330  3d 23 a2 fa fd 86 99 0b  7d 89 d1 ce 9b a2 88 2e  |=#......}.......|
+00000340  c5 b5 d2 3d 1a eb 6d ee  97 7e 8b 3d df 9f f2 16  |...=..m..~.=....|
 00000350  03 03 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 13 06 6b 6d 87 fd  |....%...! ..km..|
-00000010  c6 3b 78 26 8c bf 17 72  a8 7e 79 88 95 a9 59 9d  |.;x&...r.~y...Y.|
-00000020  90 98 c1 9b ca 33 4a 57  1d 1e 14 03 03 00 01 01  |.....3JW........|
-00000030  16 03 03 00 20 86 a9 44  52 42 f0 54 92 61 84 d9  |.... ..DRB.T.a..|
-00000040  ef 1a 69 35 98 6d bb 06  97 ab 72 03 62 fb b0 63  |..i5.m....r.b..c|
-00000050  3c c9 60 9c 09                                    |<.`..|
+00000000  16 03 03 00 25 10 00 00  21 20 90 0d c2 48 5e 26  |....%...! ...H^&|
+00000010  87 ed b7 7b 7e 5a e4 42  c0 81 91 a5 93 e2 d0 3b  |...{~Z.B.......;|
+00000020  8a 03 e5 92 d5 47 ae 99  d2 5b 14 03 03 00 01 01  |.....G...[......|
+00000030  16 03 03 00 20 3d f5 17  8a 62 68 16 d2 f6 0e 43  |.... =...bh....C|
+00000040  cf 4e 5f 05 f6 83 b5 ad  4b dc 65 a8 7f 71 b5 c5  |.N_.....K.e..q..|
+00000050  31 7c df fa d5                                    |1|...|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 7b 04 00 00  77 00 00 00 00 00 71 00  |....{...w.....q.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6f e0 18 83 51 ed 14 ef  68 ca 42 c5 4c b8 4c 2a  |o...Q...h.B.L.L*|
-00000030  22 91 a6 5d 99 6b cb fb  75 14 84 05 ca 60 8a 33  |"..].k..u....`.3|
-00000040  6c 27 46 da 51 cc c7 2b  9b d3 ff 46 7d fd ef 5f  |l'F.Q..+...F}.._|
-00000050  39 df db cb 27 17 15 49  56 60 77 54 73 49 38 16  |9...'..IV`wTsI8.|
-00000060  e1 60 0b d7 81 ab a2 c4  1f 34 9c 5c 1e 89 38 ce  |.`.......4.\..8.|
-00000070  57 10 ba e0 65 06 83 0b  56 d2 b1 9e dc 79 d6 32  |W...e...V....y.2|
-00000080  14 03 03 00 01 01 16 03  03 00 20 7c e8 6b b4 cb  |.......... |.k..|
-00000090  fa a4 2c b1 ea 16 10 36  1d 27 50 e1 cd c7 01 9c  |..,....6.'P.....|
-000000a0  a2 4c 40 10 5a 71 ab ea  44 57 71 17 03 03 00 1d  |.L@.Zq..DWq.....|
-000000b0  13 4a 91 5d 73 11 7b 4c  49 59 b6 bd 7e 80 b9 44  |.J.]s.{LIY..~..D|
-000000c0  11 fc d8 72 26 5d 5a 24  42 bc b2 db 0c 15 03 03  |...r&]Z$B.......|
-000000d0  00 12 db c7 6c 45 3e 59  43 88 50 80 7e 36 5d 2c  |....lE>YC.P.~6],|
-000000e0  03 69 ee db                                       |.i..|
+00000020  6f 2d 7c 2b 51 ed 14 ef  68 ca 42 c5 4c 5e 6d be  |o-|+Q...h.B.L^m.|
+00000030  76 38 3c 7f ed 85 37 95  aa a0 8b ef 2c b8 0d f2  |v8<...7.....,...|
+00000040  b8 f1 54 bc b3 3b e3 cd  23 16 dd 73 85 ee 65 39  |..T..;..#..s..e9|
+00000050  f8 0c f2 e9 72 7b 10 2e  e7 c3 0d e7 8c 49 38 16  |....r{.......I8.|
+00000060  21 8c 5d ed e1 ff 8d 20  0f 91 83 6a 64 da 63 02  |!.].... ...jd.c.|
+00000070  1d c4 92 8b 2a f7 9a 65  89 00 9c f9 98 9c a2 03  |....*..e........|
+00000080  14 03 03 00 01 01 16 03  03 00 20 27 8a 03 b6 5d  |.......... '...]|
+00000090  4b 4d 5d 9c e1 12 15 1d  0c fb af b2 1e 2b 3c a3  |KM]..........+<.|
+000000a0  e1 e2 ad 63 c1 d8 d3 ac  0c 73 2a 17 03 03 00 1d  |...c.....s*.....|
+000000b0  e2 dd 19 88 78 79 01 ae  7d 4c 5b ca 20 af 94 23  |....xy..}L[. ..#|
+000000c0  42 26 ec f2 77 6f 60 6c  74 4b 82 23 0f 15 03 03  |B&..wo`ltK.#....|
+000000d0  00 12 80 e0 72 6c e2 38  94 f9 26 61 99 e8 6c 29  |....rl.8..&a..l)|
+000000e0  7c b5 bc d4                                       ||...|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ExportKeyingMaterial b/src/crypto/tls/testdata/Server-TLSv12-ExportKeyingMaterial
index dc76fdf268..da59d3eb9a 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ExportKeyingMaterial
+++ b/src/crypto/tls/testdata/Server-TLSv12-ExportKeyingMaterial
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 89 01 00 00  85 03 03 b1 95 51 0b ed  |.............Q..|
-00000010  0e d5 41 f6 66 a6 ce ac  a3 4b c1 ae fb 32 31 c4  |..A.f....K...21.|
-00000020  da 47 95 a0 7b 91 3d ea  62 41 4c 00 00 04 c0 14  |.G..{.=.bAL.....|
+00000000  16 03 01 00 89 01 00 00  85 03 03 5f 18 90 3e 9e  |..........._..>.|
+00000010  3a a3 12 7e 99 60 60 b6  9f 86 ef d3 1d db ef b0  |:..~.``.........|
+00000020  0b bf c7 7b d0 ce 14 a3  82 cd be 00 00 04 c0 14  |...{............|
 00000030  00 ff 01 00 00 58 00 0b  00 04 03 00 01 02 00 0a  |.....X..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000050  00 00 00 16 00 00 00 17  00 00 00 0d 00 30 00 2e  |.............0..|
@@ -53,44 +53,44 @@
 00000290  d4 db fe 3d 13 60 84 5c  21 d3 3b e9 fa e7 16 03  |...=.`.\!.;.....|
 000002a0  03 00 ac 0c 00 00 a8 03  00 1d 20 2f e5 7d a3 47  |.......... /.}.G|
 000002b0  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
-000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 08 04 00 80 30  |......_X.;t....0|
-000002d0  9f 3d 98 1a aa b9 55 2b  b2 fe 80 4d df 94 d0 66  |.=....U+...M...f|
-000002e0  b8 c4 83 66 e1 18 5a 1b  01 66 9f f1 94 27 27 fd  |...f..Z..f...''.|
-000002f0  ba 5c 3f 2b 06 28 f4 f2  af e5 91 bb bb 50 27 cb  |.\?+.(.......P'.|
-00000300  8c 35 da a8 0d a9 3b d8  59 5b 49 3e 7c 7d 4d 97  |.5....;.Y[I>|}M.|
-00000310  bc b5 e0 c4 35 1c 33 b4  6b f9 bd a8 dc 5b 28 60  |....5.3.k....[(`|
-00000320  65 9c da 12 99 92 2c 3f  7b 4b dd 92 c3 07 ec a4  |e.....,?{K......|
-00000330  fe 80 2a 5a eb 57 bf e5  94 cd 83 36 05 e3 34 18  |..*Z.W.....6..4.|
-00000340  99 41 94 93 ed d5 e8 da  c4 90 c4 d6 f0 2f f4 16  |.A.........../..|
+000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 08 04 00 80 9f  |......_X.;t.....|
+000002d0  79 b0 2a a4 48 8b 89 0a  af c5 38 d7 c3 fa 76 85  |y.*.H.....8...v.|
+000002e0  1b aa ca 94 a7 93 b9 e2  9f 75 35 a8 b9 c4 1d d2  |.........u5.....|
+000002f0  ce 98 5c c8 08 2e 76 38  53 a4 fc a4 94 11 f6 97  |..\...v8S.......|
+00000300  8e 9a 28 12 2e d6 cb 34  e5 c1 8f d6 fc b2 82 cb  |..(....4........|
+00000310  2b ca c5 9f d1 e5 01 21  b2 b7 70 85 cf 22 b2 c9  |+......!..p.."..|
+00000320  ae 2e 09 4b d3 2c b7 d9  47 a7 55 81 f6 5b e8 e3  |...K.,..G.U..[..|
+00000330  d4 5e 10 c5 63 eb 0b 69  0f d0 3f 4d 20 c7 21 a3  |.^..c..i..?M .!.|
+00000340  1b ff 19 7e 3e e9 2e 69  46 17 04 0b 75 dd b8 16  |...~>..iF...u...|
 00000350  03 03 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 d5 ac 3d ad 5d dc  |....%...! ..=.].|
-00000010  6b 89 3c 16 9f a6 e2 da  27 9b ca 4b 49 98 66 40  |k.<.....'..KI.f@|
-00000020  7e 8a 36 41 c3 6c 00 f4  6b 30 14 03 03 00 01 01  |~.6A.l..k0......|
-00000030  16 03 03 00 40 f7 eb d8  ea 0a 45 4c 20 01 22 dd  |....@.....EL .".|
-00000040  fe 3b 13 7b df 94 85 00  ca 5f a1 00 cb 61 73 f9  |.;.{....._...as.|
-00000050  a4 ee ea e4 cd d7 99 a4  54 64 1e ce da 1a e0 49  |........Td.....I|
-00000060  dc 6d 75 fc 45 c3 c2 f7  db de 40 07 40 19 ad f1  |.mu.E.....@.@...|
-00000070  2f 94 20 79 16                                    |/. y.|
+00000000  16 03 03 00 25 10 00 00  21 20 e1 1d 40 32 13 e8  |....%...! ..@2..|
+00000010  61 be 99 fa 45 4f 62 a9  e9 bf fc 99 04 55 48 8f  |a...EOb......UH.|
+00000020  05 2b 6c 73 0f cc a0 b2  e0 49 14 03 03 00 01 01  |.+ls.....I......|
+00000030  16 03 03 00 40 77 e3 7c  88 60 87 a7 43 36 35 1a  |....@w.|.`..C65.|
+00000040  e9 fd 08 62 fe 2c 9e 2b  ba ab d0 8a bb 45 d9 35  |...b.,.+.....E.5|
+00000050  99 23 1f bc f7 de ac fb  67 54 3a 06 c9 ee 0b 44  |.#......gT:....D|
+00000060  ed 3d 0f f4 88 e5 a7 4d  7d 4c 7b 22 bc a1 9a 04  |.=.....M}L{"....|
+00000070  8a 1b 57 cc ec                                    |..W..|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 7b 04 00 00  77 00 00 00 00 00 71 00  |....{...w.....q.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6f ec a4 83 51 ed 14 ef  68 ca 42 c5 4c e9 ee ec  |o...Q...h.B.L...|
-00000030  17 f1 04 6d 95 de cb 78  93 bf db 98 a6 1d 0d fb  |...m...x........|
-00000040  e8 b5 1d cd 71 ad bb 09  8d 81 36 5e ab 65 1e 6c  |....q.....6^.e.l|
-00000050  96 a8 9c 90 fa 29 f8 9d  2c 72 21 da e7 49 38 16  |.....)..,r!..I8.|
-00000060  f7 98 70 05 a5 ef 83 76  6e 11 e5 b7 ba 5e 94 12  |..p....vn....^..|
-00000070  c0 5d 1c a8 87 f5 16 1f  f7 12 f5 86 1f 09 9d 8a  |.]..............|
+00000020  6f 2d 70 97 51 ed 14 ef  68 ca 42 c5 4c 75 27 b6  |o-p.Q...h.B.Lu'.|
+00000030  55 10 e0 6a 90 e1 4f e1  99 e9 99 b0 df e8 ed 9f  |U..j..O.........|
+00000040  92 35 9a 0c 46 ef f3 c0  da c8 03 7a f1 60 23 ba  |.5..F......z.`#.|
+00000050  4c b9 79 eb 51 17 b9 20  e8 09 fd 97 e8 49 38 16  |L.y.Q.. .....I8.|
+00000060  b5 d3 48 0e f9 af ab 8f  9d cf 94 58 f7 81 cf b7  |..H........X....|
+00000070  71 57 08 2c c4 68 81 a4  c6 ac f9 cf ee c5 af 11  |qW.,.h..........|
 00000080  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000090  00 00 00 00 00 00 00 00  00 00 00 3b 30 a4 a7 fb  |...........;0...|
-000000a0  56 31 b7 d1 98 0b 75 25  ca 34 87 d5 24 c9 82 02  |V1....u%.4..$...|
-000000b0  5a 20 da b7 66 b1 5e a0  d3 33 d8 a6 67 e3 51 7c  |Z ..f.^..3..g.Q||
-000000c0  c1 28 3c 5e 2a 09 ae 34  dc f8 4c 17 03 03 00 40  |.(<^*..4..L....@|
+00000090  00 00 00 00 00 00 00 00  00 00 00 97 4f 7e ad 5f  |............O~._|
+000000a0  29 84 1e d7 89 6b 2d 26  0f 82 68 08 5f 25 56 bb  |)....k-&..h._%V.|
+000000b0  d2 98 09 8b 06 5a 60 56  44 14 c0 db 00 69 17 42  |.....Z`VD....i.B|
+000000c0  d8 23 49 c1 ab 39 b8 01  7f df 1d 17 03 03 00 40  |.#I..9.........@|
 000000d0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-000000e0  d0 c0 7d 37 a9 e0 e5 bf  47 d9 79 78 0a d5 86 d6  |..}7....G.yx....|
-000000f0  ed 50 28 a7 c7 cb a6 97  97 d4 9b b5 41 2c 2d 97  |.P(.........A,-.|
-00000100  a6 f5 fc 9b 5b b1 e7 64  62 d2 8f de 8f 65 77 c2  |....[..db....ew.|
+000000e0  b3 16 29 a3 9c c1 7a c7  4c ed c0 9d 6e a0 9b d7  |..)...z.L...n...|
+000000f0  43 00 15 88 e8 53 f2 75  83 df ab 2d 42 27 38 1f  |C....S.u...-B'8.|
+00000100  bc 6e 70 56 59 25 de 94  6a 21 95 60 db 08 04 f8  |.npVY%..j!.`....|
 00000110  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000120  00 00 00 00 00 87 44 5b  dd 76 b0 62 d1 15 7d fb  |......D[.v.b..}.|
-00000130  f4 64 a1 d4 4b 42 93 15  a7 2f d8 87 2e 65 49 32  |.d..KB.../...eI2|
-00000140  ba 78 95 83 68                                    |.x..h|
+00000120  00 00 00 00 00 c4 11 fe  ea a3 17 03 6c d5 f8 98  |............l...|
+00000130  8d 2e 35 39 79 4c 6e 9e  7e 11 6a e4 7e 1d f4 91  |..59yLn.~.j.~...|
+00000140  07 fe ba 69 e0                                    |...i.|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-IssueTicket b/src/crypto/tls/testdata/Server-TLSv12-IssueTicket
index 22a0f20ed9..07a86023bb 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-IssueTicket
+++ b/src/crypto/tls/testdata/Server-TLSv12-IssueTicket
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 71 01 00 00  6d 03 03 1a 33 54 ce 5c  |....q...m...3T.\|
-00000010  39 88 32 9d b9 24 c0 db  d7 6b c2 dc 78 25 30 7b  |9.2..$...k..x%0{|
-00000020  70 5b b9 9f 14 7d 73 3f  75 d2 94 00 00 04 00 2f  |p[...}s?u....../|
+00000000  16 03 01 00 71 01 00 00  6d 03 03 ed a4 93 fb 04  |....q...m.......|
+00000010  6b e1 61 78 35 f0 ac 53  e3 bc 40 fd cd 34 af 3c  |k.ax5..S..@..4.<|
+00000020  11 31 a7 fe 9a c8 02 45  c3 61 1e 00 00 04 00 2f  |.1.....E.a...../|
 00000030  00 ff 01 00 00 40 00 23  00 00 00 16 00 00 00 17  |.....@.#........|
 00000040  00 00 00 0d 00 30 00 2e  04 03 05 03 06 03 08 07  |.....0..........|
 00000050  08 08 08 09 08 0a 08 0b  08 04 08 05 08 06 04 01  |................|
@@ -52,39 +52,39 @@
 00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 04 0e 00 00  |.\!.;...........|
 000002a0  00                                                |.|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 cd 0c 0e 56 8a  |..............V.|
-00000010  e3 7d cc 5b 26 5f 16 86  3c a2 c0 96 06 55 94 e4  |.}.[&_..<....U..|
-00000020  64 69 6d 10 d6 64 48 6d  2e 8f 27 85 5c a8 bb 4b  |dim..dHm..'.\..K|
-00000030  52 f3 c4 5b be 16 3e 6a  a8 ab 9d 32 a5 58 6a 2c  |R..[..>j...2.Xj,|
-00000040  87 bf ca b8 df 38 73 2f  51 1b ac 0b 29 e1 2a 3e  |.....8s/Q...).*>|
-00000050  3a 83 04 b9 9d af aa 20  7c 97 8a 7b a2 20 4d 2f  |:...... |..{. M/|
-00000060  eb 45 2c 2a 9e 13 73 2c  6a de e9 73 f0 fe 1b 53  |.E,*..s,j..s...S|
-00000070  37 68 32 9a 18 9f 57 52  2e 9d 31 9c 03 d3 44 8b  |7h2...WR..1...D.|
-00000080  bd be 95 25 d9 84 24 1e  b5 88 f9 14 03 03 00 01  |...%..$.........|
-00000090  01 16 03 03 00 40 ca 99  75 30 ff 9f ba b1 97 43  |.....@..u0.....C|
-000000a0  03 49 ee ea 73 ae bb 4d  b2 1b 98 13 11 22 8f 7c  |.I..s..M.....".||
-000000b0  8f 1f 5b 32 36 ec 3e ad  d3 8a bd f5 10 2e 35 40  |..[26.>.......5@|
-000000c0  02 73 df f1 de 0d d6 c9  8d 4a 08 38 3a 31 5d b7  |.s.......J.8:1].|
-000000d0  b3 31 7b 17 fe 84                                 |.1{...|
+00000000  16 03 03 00 86 10 00 00  82 00 80 b5 0c 4f b1 0a  |.............O..|
+00000010  5c c1 94 15 b2 e9 19 07  7c 7e 4b a2 e7 96 59 4d  |\.......|~K...YM|
+00000020  c9 01 2b d6 9f 21 9a 9c  fe 97 b9 e7 fa f7 54 b1  |..+..!........T.|
+00000030  a2 86 41 19 99 ca bd df  d0 8c a4 18 a6 a0 02 b1  |..A.............|
+00000040  b8 fb 97 25 7b bb 7b ee  98 53 90 c5 27 94 96 ed  |...%{.{..S..'...|
+00000050  56 8a ac d6 13 a1 06 c3  03 5b 6a fa 16 c9 af 76  |V........[j....v|
+00000060  c8 16 f2 01 60 fb 0e 9e  61 b4 cc 0a de 08 80 85  |....`...a.......|
+00000070  61 69 84 0e ff b9 e1 88  96 26 da c5 78 68 da 91  |ai.......&..xh..|
+00000080  34 3d 48 bd 2e f9 09 35  99 4a 4d 14 03 03 00 01  |4=H....5.JM.....|
+00000090  01 16 03 03 00 40 ee 0f  e5 0b 2c 8f 26 a6 e1 d2  |.....@....,.&...|
+000000a0  a2 05 88 37 ca 23 15 66  d9 89 0e 99 87 a5 fd ef  |...7.#.f........|
+000000b0  78 18 9f 88 e2 40 aa 77  cf df dc df d6 08 16 f6  |x....@.w........|
+000000c0  b8 1a 9c 5c 29 0e 8e 39  cc 7a 2e 07 58 d1 bf 28  |...\)..9.z..X..(|
+000000d0  ec bd a1 b3 35 6d                                 |....5m|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 7b 04 00 00  77 00 00 00 00 00 71 00  |....{...w.....q.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6f 2c 9f 83 51 ed 14 ef  68 ca 42 c5 4c 97 70 11  |o,..Q...h.B.L.p.|
-00000030  14 b7 27 54 f2 0b 35 d5  93 d8 86 9e 86 0d 11 33  |..'T..5........3|
-00000040  11 84 b9 59 93 6a 5e 6e  08 47 99 d9 5f 9f 69 0e  |...Y.j^n.G.._.i.|
-00000050  93 08 3b 97 12 68 d8 55  e9 f8 d0 69 88 49 38 16  |..;..h.U...i.I8.|
-00000060  d9 3f 52 8c 19 e1 48 5e  98 ea cb 31 f9 bd 50 3e  |.?R...H^...1..P>|
-00000070  89 32 ed 0e 48 fa 8f 86  87 da 06 f5 c7 8a b7 00  |.2..H...........|
+00000020  6f 2d b0 ac 51 ed 14 ef  68 ca 42 c5 4c 26 b9 05  |o-..Q...h.B.L&..|
+00000030  4e 0c 2c 40 fd 80 10 8c  7c 82 30 47 cd 83 91 fb  |N.,@....|.0G....|
+00000040  36 78 d2 00 a9 6a fd 7f  84 97 93 94 95 98 30 da  |6x...j........0.|
+00000050  67 72 e7 ed fb 19 a0 0d  98 15 55 12 68 49 38 16  |gr........U.hI8.|
+00000060  5f 5b ea f1 09 ba 8b 38  e9 aa f1 da 4f 4f 77 bb  |_[.....8....OOw.|
+00000070  bc 77 51 bd ee b8 61 80  1c 21 0f 90 16 d6 ce 74  |.wQ...a..!.....t|
 00000080  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000090  00 00 00 00 00 00 00 00  00 00 00 6c b1 c8 55 d7  |...........l..U.|
-000000a0  3b 07 12 f9 c8 d6 b2 50  09 b8 26 d0 94 9d 86 6a  |;......P..&....j|
-000000b0  97 3b a7 20 fe 66 c8 c9  56 80 81 f9 56 13 44 2b  |.;. .f..V...V.D+|
-000000c0  de 56 fa c5 38 3c 4d d7  db fe 6a 17 03 03 00 40  |.V..8<M...j....@|
+00000090  00 00 00 00 00 00 00 00  00 00 00 0a 8c bc 61 5f  |..............a_|
+000000a0  57 1a 36 b3 45 dd 40 67  dc 3e 6a 9b 6c 4b 4b 7b  |W.6.E.@g.>j.lKK{|
+000000b0  1e 45 2c fe 2d d6 b9 75  bb 7b dc 81 94 5f 60 24  |.E,.-..u.{..._`$|
+000000c0  2d 7e 60 8b 69 56 9d 2c  47 4a 20 17 03 03 00 40  |-~`.iV.,GJ ....@|
 000000d0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-000000e0  93 24 62 38 5d e3 3e 19  a1 17 91 40 09 f8 fe 93  |.$b8].>....@....|
-000000f0  93 33 3e 3c 46 4d 03 68  de b6 84 d7 da 44 42 87  |.3><FM.h.....DB.|
-00000100  4c b9 a7 04 da ad 97 a3  cd cb 6f 9b 25 21 ca b0  |L.........o.%!..|
+000000e0  10 a2 02 60 65 c3 e7 ed  e1 81 3b e3 a0 43 f0 5e  |...`e.....;..C.^|
+000000f0  a6 05 8a de 7c 05 7d cb  4b 21 ba f5 fd e5 bd 73  |....|.}.K!.....s|
+00000100  1f 89 3a f1 20 3c 72 22  34 28 89 6f a7 fb 5f 1c  |..:. <r"4(.o.._.|
 00000110  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000120  00 00 00 00 00 de 01 46  c3 77 b6 72 f4 44 b9 e5  |.......F.w.r.D..|
-00000130  ad f5 6e 52 1b 34 3e b6  63 49 d9 0c b2 6d 92 85  |..nR.4>.cI...m..|
-00000140  71 b3 64 07 d7                                    |q.d..|
+00000120  00 00 00 00 00 60 8d 2d  47 70 38 83 b6 b4 75 51  |.....`.-Gp8...uQ|
+00000130  4b 6b cd 3c 3b 32 33 ee  90 e7 39 c7 37 cf 44 aa  |Kk.<;23...9.7.D.|
+00000140  02 47 22 ac a1                                    |.G"..|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable b/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable
index 240ef7c9b7..7074b6d58e 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable
+++ b/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 71 01 00 00  6d 03 03 7f 8b 61 43 6c  |....q...m....aCl|
-00000010  46 52 28 90 8a 76 05 1b  a8 fe ba 62 c7 7b 38 a9  |FR(..v.....b.{8.|
-00000020  74 d7 7a df b3 86 0f 43  80 16 f5 00 00 04 00 2f  |t.z....C......./|
+00000000  16 03 01 00 71 01 00 00  6d 03 03 67 10 b0 32 3b  |....q...m..g..2;|
+00000010  61 78 3c 76 21 10 7a 5e  64 81 7e 99 2a 17 8f a3  |ax<v!.z^d.~.*...|
+00000020  86 4d 22 2c f1 56 91 65  db 17 f9 00 00 04 00 2f  |.M",.V.e......./|
 00000030  00 ff 01 00 00 40 00 23  00 00 00 16 00 00 00 17  |.....@.#........|
 00000040  00 00 00 0d 00 30 00 2e  04 03 05 03 06 03 08 07  |.....0..........|
 00000050  08 08 08 09 08 0a 08 0b  08 04 08 05 08 06 04 01  |................|
@@ -52,39 +52,39 @@
 00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 04 0e 00 00  |.\!.;...........|
 000002a0  00                                                |.|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 d0 11 d0 b9 f4  |................|
-00000010  77 46 92 30 0d d5 72 de  05 77 3e de 8b 75 a0 74  |wF.0..r..w>..u.t|
-00000020  cf 81 c9 99 b2 17 fd 4d  20 af db e7 2c 41 db 4a  |.......M ...,A.J|
-00000030  ff 53 80 69 b2 ef 46 6a  d8 bb ca 00 ec 3c e4 91  |.S.i..Fj.....<..|
-00000040  b4 e9 7f 55 e6 61 11 af  63 de 6b 68 b1 b0 b0 e1  |...U.a..c.kh....|
-00000050  ba 02 43 46 04 d3 28 94  45 68 73 01 32 3d 98 45  |..CF..(.Ehs.2=.E|
-00000060  79 ce 9d 46 a0 e3 ee 34  2d 1a a7 9e ef 91 8a 58  |y..F...4-......X|
-00000070  e3 85 8a b5 63 5d 96 db  58 a3 0d af c6 55 b0 8d  |....c]..X....U..|
-00000080  80 dc bc 41 f7 58 07 43  84 0b 7d 14 03 03 00 01  |...A.X.C..}.....|
-00000090  01 16 03 03 00 40 7a 63  c6 9d bb d6 20 3f ce 94  |.....@zc.... ?..|
-000000a0  11 e0 ff 8e f5 70 a5 40  1a a9 cd f1 e1 1b ae a1  |.....p.@........|
-000000b0  20 db 73 1b ab 33 d4 44  0b 5b e1 df 0a 90 a8 31  | .s..3.D.[.....1|
-000000c0  2c a8 85 f3 db 57 25 c4  b3 92 7a 95 38 a2 fe 73  |,....W%...z.8..s|
-000000d0  70 63 c8 9e 74 a4                                 |pc..t.|
+00000000  16 03 03 00 86 10 00 00  82 00 80 05 c9 82 6a 6f  |..............jo|
+00000010  9f 3c f7 ab bc 8d 6c ab  a4 d4 bd 89 0a f7 33 5c  |.<....l.......3\|
+00000020  b2 b8 de b8 ea 58 cb 4e  c6 6f da 81 6f 93 0b 94  |.....X.N.o..o...|
+00000030  bd 5a b9 32 dc 88 0e e1  1b af 28 9d fe fb e1 d7  |.Z.2......(.....|
+00000040  ff c1 5b cc f7 b4 8e 7f  99 6a f3 9f 61 8b 8b 84  |..[......j..a...|
+00000050  e0 8a b5 8c 01 e9 35 3b  99 02 09 62 6d 89 6d 64  |......5;...bm.md|
+00000060  a0 38 81 7e 7d 3f 17 db  25 d5 65 eb d2 d1 8b 4d  |.8.~}?..%.e....M|
+00000070  ca 8c f2 1f 9a 01 39 9c  27 cc 02 95 12 09 93 40  |......9.'......@|
+00000080  09 ca f4 a3 06 96 96 08  1f 3f 11 14 03 03 00 01  |.........?......|
+00000090  01 16 03 03 00 40 17 11  51 ff e0 3d d1 1f 66 83  |.....@..Q..=..f.|
+000000a0  10 20 ac 1e 23 38 31 78  68 95 61 14 77 5f 30 48  |. ..#81xh.a.w_0H|
+000000b0  7a 91 4d 75 33 9b ba df  15 31 3d 6b a1 1b 21 f5  |z.Mu3....1=k..!.|
+000000c0  de 20 47 54 53 fd 33 62  c4 96 8a bb 70 1c c0 1c  |. GTS.3b....p...|
+000000d0  48 80 3d 8e f4 5c                                 |H.=..\|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 7b 04 00 00  77 00 00 00 00 00 71 00  |....{...w.....q.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6f 2c 9f 83 51 ed 14 ef  68 ca 42 c5 4c 09 d9 1a  |o,..Q...h.B.L...|
-00000030  35 06 6b 87 4b 07 92 7a  3d b6 f7 6f b1 22 05 e2  |5.k.K..z=..o."..|
-00000040  f1 65 17 8b 98 1a f3 ab  25 77 21 06 50 4d a7 f3  |.e......%w!.PM..|
-00000050  61 8c 2d 33 54 e9 39 bf  95 11 f3 fd e3 49 38 16  |a.-3T.9......I8.|
-00000060  4d 3c 28 3b 16 c6 30 68  d0 96 97 3e d3 96 c8 b0  |M<(;..0h...>....|
-00000070  f2 93 90 99 07 4a 82 fc  fe 97 4c 2d 09 a8 4f bb  |.....J....L-..O.|
+00000020  6f 2d b0 ac 51 ed 14 ef  68 ca 42 c5 4c 11 1e 90  |o-..Q...h.B.L...|
+00000030  d4 2d b4 6a 6d 75 77 66  50 ef 93 3a 1a 6d c6 50  |.-.jmuwfP..:.m.P|
+00000040  8b 2e a1 45 98 96 f8 39  92 c5 a3 fe 67 32 ea 7d  |...E...9....g2.}|
+00000050  15 2a 83 cd 27 26 fe 32  66 c6 11 eb e6 49 38 16  |.*..'&.2f....I8.|
+00000060  bb 13 c3 13 2c 79 46 2f  b9 99 3e 3c a5 22 fb 89  |....,yF/..><."..|
+00000070  d2 98 43 ad 44 09 2f 93  37 e3 82 d2 ce 98 6d 8b  |..C.D./.7.....m.|
 00000080  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000090  00 00 00 00 00 00 00 00  00 00 00 47 50 7b 4f 31  |...........GP{O1|
-000000a0  c9 bf 4c 45 02 2b 44 22  11 37 d5 a0 d9 13 09 1e  |..LE.+D".7......|
-000000b0  c8 c9 a3 6b 87 aa 6d c7  2d 9f 54 5f 81 2f a5 8e  |...k..m.-.T_./..|
-000000c0  ee d4 72 1b ab 68 4f df  4d 8c be 17 03 03 00 40  |..r..hO.M......@|
+00000090  00 00 00 00 00 00 00 00  00 00 00 c4 bc bf e0 a2  |................|
+000000a0  43 ce d2 38 75 13 71 7d  85 c8 b6 8c 9b 1f e6 c1  |C..8u.q}........|
+000000b0  7c 1c 5d 9d 9e 54 f0 f0  3d cf eb d4 0c eb db 57  ||.]..T..=......W|
+000000c0  ec 38 aa 93 9d 67 e7 fc  50 8e 41 17 03 03 00 40  |.8...g..P.A....@|
 000000d0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-000000e0  21 ed 3a 4a 11 ba 97 d4  f7 59 74 80 88 85 66 1a  |!.:J.....Yt...f.|
-000000f0  c0 bb 7e 7b 1c 08 0d 54  9a 1c db 98 16 96 a5 aa  |..~{...T........|
-00000100  5b ae 90 1c ed 45 07 58  3f 35 02 77 eb 11 f8 c0  |[....E.X?5.w....|
+000000e0  bf 27 f3 fe eb 98 89 7f  f4 d0 83 30 3a be 28 06  |.'.........0:.(.|
+000000f0  b0 f5 4a 7a 92 ef 10 9d  71 58 46 b9 02 91 cd a7  |..Jz....qXF.....|
+00000100  f7 e5 37 fc dd 71 80 af  bc e7 4b fd db 38 96 30  |..7..q....K..8.0|
 00000110  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000120  00 00 00 00 00 83 11 49  44 fb 94 bf d6 7c 15 8e  |.......ID....|..|
-00000130  ec 71 f9 be f2 37 16 4a  9d 6b 0e f0 9b b3 3f f6  |.q...7.J.k....?.|
-00000140  ee 42 9f b4 2c                                    |.B..,|
+00000120  00 00 00 00 00 10 62 10  84 20 88 99 fd 4d 4a db  |......b.. ...MJ.|
+00000130  42 1f 1d a2 6d b1 16 d7  31 2f f7 a2 5f 10 c9 2a  |B...m...1/.._..*|
+00000140  f1 fc eb 95 40                                    |....@|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-Resume b/src/crypto/tls/testdata/Server-TLSv12-Resume
index d159de8ef7..462996c20d 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-Resume
+++ b/src/crypto/tls/testdata/Server-TLSv12-Resume
@@ -1,17 +1,17 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 02 01 00 00  fe 03 03 e3 e1 0d a8 3d  |...............=|
-00000010  e9 cb 74 24 6a 25 53 ec  29 6d 19 89 78 e4 24 71  |..t$j%S.)m..x.$q|
-00000020  bb b8 e1 02 75 1d 1b 62  b2 d1 8b 20 6b d1 d9 2c  |....u..b... k..,|
-00000030  43 20 d8 cb bd fe b9 0e  f0 84 36 03 d8 07 d0 04  |C ........6.....|
-00000040  8d 16 e3 fa 68 04 83 b7  87 1b 2b ea 00 04 00 2f  |....h.....+..../|
+00000000  16 03 01 01 02 01 00 00  fe 03 03 ae f0 6e 69 e6  |.............ni.|
+00000010  d5 6a fe ef 07 38 80 ee  9d 56 8c 05 d1 9c 65 bc  |.j...8...V....e.|
+00000020  0e 57 5d 60 8d 66 b8 3a  6a 74 e9 20 3e 1c 88 9c  |.W]`.f.:jt. >...|
+00000030  37 47 27 ec 6d 66 94 52  0e bd 7e f6 e1 d0 48 fc  |7G'.mf.R..~...H.|
+00000040  14 b2 f5 3c 92 ef a4 05  ac 4d 57 80 00 04 00 2f  |...<.....MW..../|
 00000050  00 ff 01 00 00 b1 00 23  00 71 00 00 00 00 00 00  |.......#.q......|
-00000060  00 00 00 00 00 00 00 00  00 00 94 6f 2c 9f 83 51  |...........o,..Q|
-00000070  ed 14 ef 68 ca 42 c5 4c  97 70 11 14 b7 27 54 f2  |...h.B.L.p...'T.|
-00000080  0b 35 d5 93 d8 86 9e 86  0d 11 33 11 84 b9 59 93  |.5........3...Y.|
-00000090  6a 5e 6e 08 47 99 d9 5f  9f 69 0e 93 08 3b 97 12  |j^n.G.._.i...;..|
-000000a0  68 d8 55 e9 f8 d0 69 88  49 38 16 d9 3f 52 8c 19  |h.U...i.I8..?R..|
-000000b0  e1 48 5e 98 ea cb 31 f9  bd 50 3e 89 32 ed 0e 48  |.H^...1..P>.2..H|
-000000c0  fa 8f 86 87 da 06 f5 c7  8a b7 00 00 16 00 00 00  |................|
+00000060  00 00 00 00 00 00 00 00  00 00 94 6f 2d b0 ac 51  |...........o-..Q|
+00000070  ed 14 ef 68 ca 42 c5 4c  26 b9 05 4e 0c 2c 40 fd  |...h.B.L&..N.,@.|
+00000080  80 10 8c 7c 82 30 47 cd  83 91 fb 36 78 d2 00 a9  |...|.0G....6x...|
+00000090  6a fd 7f 84 97 93 94 95  98 30 da 67 72 e7 ed fb  |j........0.gr...|
+000000a0  19 a0 0d 98 15 55 12 68  49 38 16 5f 5b ea f1 09  |.....U.hI8._[...|
+000000b0  ba 8b 38 e9 aa f1 da 4f  4f 77 bb bc 77 51 bd ee  |..8....OOw..wQ..|
+000000c0  b8 61 80 1c 21 0f 90 16  d6 ce 74 00 16 00 00 00  |.a..!.....t.....|
 000000d0  17 00 00 00 0d 00 30 00  2e 04 03 05 03 06 03 08  |......0.........|
 000000e0  07 08 08 08 09 08 0a 08  0b 08 04 08 05 08 06 04  |................|
 000000f0  01 05 01 06 01 03 03 02  03 03 01 02 01 03 02 02  |................|
@@ -19,35 +19,35 @@
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 55 02 00 00  51 03 03 00 00 00 00 00  |....U...Q.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 44 4f 57 4e 47  52 44 01 20 6b d1 d9 2c  |...DOWNGRD. k..,|
-00000030  43 20 d8 cb bd fe b9 0e  f0 84 36 03 d8 07 d0 04  |C ........6.....|
-00000040  8d 16 e3 fa 68 04 83 b7  87 1b 2b ea 00 2f 00 00  |....h.....+../..|
+00000020  00 00 00 44 4f 57 4e 47  52 44 01 20 3e 1c 88 9c  |...DOWNGRD. >...|
+00000030  37 47 27 ec 6d 66 94 52  0e bd 7e f6 e1 d0 48 fc  |7G'.mf.R..~...H.|
+00000040  14 b2 f5 3c 92 ef a4 05  ac 4d 57 80 00 2f 00 00  |...<.....MW../..|
 00000050  09 00 23 00 00 ff 01 00  01 00 16 03 03 00 7b 04  |..#...........{.|
 00000060  00 00 77 00 00 00 00 00  71 00 00 00 00 00 00 00  |..w.....q.......|
-00000070  00 00 00 00 00 00 00 00  00 94 6f 2c 9f 83 51 ed  |..........o,..Q.|
-00000080  14 ef 68 ca 42 c5 4c 97  70 11 14 b7 27 54 f2 0b  |..h.B.L.p...'T..|
-00000090  35 d5 93 d8 86 9e 86 0d  11 33 11 84 b9 59 93 6a  |5........3...Y.j|
-000000a0  5e 6e 08 47 99 d9 5f 9f  69 0e 93 08 3b 97 12 68  |^n.G.._.i...;..h|
-000000b0  d8 55 e9 f8 d0 69 88 49  38 16 d9 3f 52 8c 19 e1  |.U...i.I8..?R...|
-000000c0  48 5e 98 ea cb 31 f9 bd  50 3e 89 32 ed 0e 48 fa  |H^...1..P>.2..H.|
-000000d0  8f 86 87 da 06 f5 c7 8a  b7 00 14 03 03 00 01 01  |................|
+00000070  00 00 00 00 00 00 00 00  00 94 6f 2d b0 ac 51 ed  |..........o-..Q.|
+00000080  14 ef 68 ca 42 c5 4c 26  b9 05 4e 0c 2c 40 fd 80  |..h.B.L&..N.,@..|
+00000090  10 8c 7c 82 30 47 cd 83  91 fb 36 78 d2 00 a9 6a  |..|.0G....6x...j|
+000000a0  fd 7f 84 97 93 94 95 98  30 da 67 72 e7 ed fb 19  |........0.gr....|
+000000b0  a0 0d 98 15 55 12 68 49  38 16 5f 5b ea f1 09 ba  |....U.hI8._[....|
+000000c0  8b 38 e9 aa f1 da 4f 4f  77 bb bc 77 51 bd ee b8  |.8....OOw..wQ...|
+000000d0  61 80 1c 21 0f 90 16 d6  ce 74 14 03 03 00 01 01  |a..!.....t......|
 000000e0  16 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-000000f0  00 00 00 00 00 d4 c4 c1  96 eb 80 4c e9 74 73 a2  |...........L.ts.|
-00000100  d8 35 09 8c b6 f6 4f 7c  3c 21 36 c7 94 36 37 48  |.5....O|<!6..67H|
-00000110  a0 eb fa 71 dd f9 1f 99  e9 44 ae 80 15 b0 90 d9  |...q.....D......|
-00000120  a2 82 b5 4e 86                                    |...N.|
+000000f0  00 00 00 00 00 c6 e4 28  b8 05 02 a1 34 fe 60 15  |.......(....4.`.|
+00000100  a3 1f ea a2 30 35 5e 51  62 81 03 ff 2b db 09 72  |....05^Qb...+..r|
+00000110  34 2f ca f1 95 c4 55 dc  7b ec c0 4d 2c 5d 95 81  |4/....U.{..M,]..|
+00000120  36 18 6b 0a 3e                                    |6.k.>|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 16 03  03 00 40 86 f3 8d ad ab  |..........@.....|
-00000010  d5 20 16 bd c0 97 60 77  08 99 c7 7b 47 20 9b 37  |. ....`w...{G .7|
-00000020  da 0b 21 99 0a 22 6a 43  92 5c 89 11 10 c6 e2 99  |..!.."jC.\......|
-00000030  01 5b f4 ce 18 0d 16 3f  57 0d fb b3 b4 f2 a5 8d  |.[.....?W.......|
-00000040  97 4f 60 b3 41 22 49 43  55 4f f5                 |.O`.A"ICUO.|
+00000000  14 03 03 00 01 01 16 03  03 00 40 4b 82 f8 16 44  |..........@K...D|
+00000010  28 fc 53 19 c5 f3 2d 02  06 4b 84 e2 8f 3b 4c 6f  |(.S...-..K...;Lo|
+00000020  2c 9f 63 ca a6 78 2a 73  14 f9 f6 f5 ba fd a3 df  |,.c..x*s........|
+00000030  de 02 02 23 a9 1f 56 b7  ea 96 cd 62 34 a6 ed 4e  |...#..V....b4..N|
+00000040  2b 4e b1 04 66 7f 09 66  ef 7c 52                 |+N..f..f.|R|
 >>> Flow 4 (server to client)
 00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000010  00 00 00 00 00 c5 9b b2  da 9a 9a d8 eb cc 3c 96  |..............<.|
-00000020  4a d1 28 e8 dd b1 b3 b8  1c bd 9f fb ee f8 05 95  |J.(.............|
-00000030  47 a5 c5 77 de e1 66 c8  04 3f 4e 49 d0 95 3d 11  |G..w..f..?NI..=.|
-00000040  5e 7e 10 3d 15 15 03 03  00 30 00 00 00 00 00 00  |^~.=.....0......|
-00000050  00 00 00 00 00 00 00 00  00 00 cf c4 0c 9e 82 c2  |................|
-00000060  89 30 4c 29 98 6e 0e d1  37 3d f7 54 d3 1c 2e a6  |.0L).n..7=.T....|
-00000070  cd 3a b7 7b 58 ed fb 88  c6 f2                    |.:.{X.....|
+00000010  00 00 00 00 00 e9 20 7d  95 29 be 74 b0 9b 23 57  |...... }.).t..#W|
+00000020  45 01 55 f8 86 50 09 b8  f6 43 c5 3a 5f cf ff 30  |E.U..P...C.:_..0|
+00000030  47 40 3b e8 7b cc 73 40  78 0b b7 6d dd 6d c7 fd  |G@;.{.s@x..m.m..|
+00000040  a9 2e 0d 70 7e 15 03 03  00 30 00 00 00 00 00 00  |...p~....0......|
+00000050  00 00 00 00 00 00 00 00  00 00 27 60 b4 ec 27 05  |..........'`..'.|
+00000060  f1 e1 4b 71 ae 51 f1 e5  c1 59 7e 31 5b 1d 4b dc  |..Kq.Q...Y~1[.K.|
+00000070  e9 3b ae 26 93 85 c7 36  cf fc                    |.;.&...6..|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-AES128-SHA256 b/src/crypto/tls/testdata/Server-TLSv13-AES128-SHA256
index 5c4eaa6ae3..015f0a4a58 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-AES128-SHA256
+++ b/src/crypto/tls/testdata/Server-TLSv13-AES128-SHA256
@@ -1,97 +1,97 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 20 8e 6e 42 f8  |........... .nB.|
-00000010  66 a3 a0 2f 80 18 4c d8  cd 7c f1 34 96 fd dc fe  |f../..L..|.4....|
-00000020  cd bc f6 46 12 b8 2b 2c  e5 99 66 20 6b 7f cf e7  |...F..+,..f k...|
-00000030  da 4b d9 f4 5e b5 57 42  af db ec 7a 0a ff 03 da  |.K..^.WB...z....|
-00000040  a3 4b cd 15 fc a0 29 5a  2d 0c 24 99 00 04 13 01  |.K....)Z-.$.....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 bd fd 94 fe e6  |................|
+00000010  aa fd d1 36 26 f7 12 6e  4b 15 ad 20 90 8f b2 6b  |...6&..nK.. ...k|
+00000020  d2 81 db c1 ee 71 a0 c4  a1 c4 cb 20 7e 5e b3 99  |.....q..... ~^..|
+00000030  3e c9 11 36 31 ce 52 60  7d 10 10 04 a0 9d e6 0d  |>..61.R`}.......|
+00000040  41 1f 53 e6 25 e0 2a 14  46 6a 4f 9d 00 04 13 01  |A.S.%.*.FjO.....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 4d  |-.....3.&.$... M|
-000000b0  20 d9 e8 7f 1d 51 f9 f7  2c 7e 3e f1 59 76 4c 75  | ....Q..,~>.YvLu|
-000000c0  26 3f 3b ec dd fc f8 78  15 3e 5f 61 f5 ed 37     |&?;....x.>_a..7|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 30  |-.....3.&.$... 0|
+000000b0  24 ff 8c 54 81 6f 8e 85  9f a3 de 52 af da 1c 01  |$..T.o.....R....|
+000000c0  7a 9e 90 cd 48 1e 06 64  a0 a1 ea 0f 10 57 59     |z...H..d.....WY|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 6b 7f cf e7  |........... k...|
-00000030  da 4b d9 f4 5e b5 57 42  af db ec 7a 0a ff 03 da  |.K..^.WB...z....|
-00000040  a3 4b cd 15 fc a0 29 5a  2d 0c 24 99 13 01 00 00  |.K....)Z-.$.....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 7e 5e b3 99  |........... ~^..|
+00000030  3e c9 11 36 31 ce 52 60  7d 10 10 04 a0 9d e6 0d  |>..61.R`}.......|
+00000040  41 1f 53 e6 25 e0 2a 14  46 6a 4f 9d 13 01 00 00  |A.S.%.*.FjO.....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 6e 64 88 75 8a 9e  |..........nd.u..|
-00000090  99 4b a7 f5 55 5e 7a 04  01 30 90 1d 94 60 b3 95  |.K..U^z..0...`..|
-000000a0  d7 17 03 03 02 6d d9 61  f0 95 5c 13 9a fc 6a 73  |.....m.a..\...js|
-000000b0  a0 a8 e9 ea 64 81 94 12  68 05 c3 fd f9 8b 26 4d  |....d...h.....&M|
-000000c0  c8 cf 51 37 d7 19 32 b1  32 1b 8e 3c f4 c2 02 a8  |..Q7..2.2..<....|
-000000d0  a2 13 cd a2 3d f3 d1 62  82 b0 d4 aa ab e9 53 c0  |....=..b......S.|
-000000e0  19 4b 4b 80 6c 54 b7 79  06 73 73 cf 75 d8 4b 53  |.KK.lT.y.ss.u.KS|
-000000f0  3e d3 9c 1e 54 fa e5 24  9a be 84 89 a2 fb bb 21  |>...T..$.......!|
-00000100  3a d1 f5 df 17 5f d7 b5  5a 82 a4 77 70 2f 36 17  |:...._..Z..wp/6.|
-00000110  d9 ef 03 40 88 b5 68 f6  df fc 94 df ce 8a af d7  |...@..h.........|
-00000120  ed 12 3d 4b d8 cf 5b 6a  0b c5 a4 5a c6 b6 2d 19  |..=K..[j...Z..-.|
-00000130  02 03 d1 3c ef ea a6 ee  50 bb b6 ba 0e 67 b3 25  |...<....P....g.%|
-00000140  6f d7 e1 50 89 7d 40 3a  79 11 1c a0 c8 1e 33 bb  |o..P.}@:y.....3.|
-00000150  81 ad 32 00 47 f9 7f f8  0e 0b b9 d0 61 5a 2d 60  |..2.G.......aZ-`|
-00000160  03 6f d0 fc 22 11 84 6e  a8 76 7d 77 87 af 1b 1d  |.o.."..n.v}w....|
-00000170  04 f0 fa 45 29 f0 e7 38  b6 1a 4e 30 28 a7 81 7d  |...E)..8..N0(..}|
-00000180  9f 9c 23 cb f1 98 77 db  56 47 34 d9 4d 6e 3e cb  |..#...w.VG4.Mn>.|
-00000190  64 52 6d fe cb 26 0e c0  f9 36 36 67 24 50 b8 31  |dRm..&...66g$P.1|
-000001a0  04 dc 99 58 68 72 96 ef  d9 fb 51 b2 87 14 80 c4  |...Xhr....Q.....|
-000001b0  5b 3a f1 cf fb a0 0f d0  c8 26 aa 71 99 82 9d be  |[:.......&.q....|
-000001c0  d1 83 86 91 85 21 38 ec  81 bd c2 59 51 9d 67 a4  |.....!8....YQ.g.|
-000001d0  eb 10 52 c0 ca 2b c9 cc  6e 32 59 50 71 3a f4 f0  |..R..+..n2YPq:..|
-000001e0  b0 48 93 d1 b8 48 08 3b  dd d3 1e f5 20 ca df 36  |.H...H.;.... ..6|
-000001f0  05 70 67 2e e0 aa 88 50  2a a4 a2 de b1 70 bf 67  |.pg....P*....p.g|
-00000200  57 ed cf b4 b2 44 61 77  94 9f d9 a1 51 95 1d 24  |W....Daw....Q..$|
-00000210  b1 23 65 74 28 a9 fc 3e  83 8e aa 04 f9 42 f3 02  |.#et(..>.....B..|
-00000220  37 93 34 4f 07 2f 00 dd  40 a7 6f 77 c2 8d a5 77  |7.4O./..@.ow...w|
-00000230  95 d1 af ff 8c 70 28 15  0a bc 66 f4 4e 8b be 70  |.....p(...f.N..p|
-00000240  51 96 13 5f 12 9d 41 0a  ac e7 b6 24 50 12 ac 57  |Q.._..A....$P..W|
-00000250  cf 84 a8 75 13 cc a3 07  9e 4b 04 d8 6c 43 4a 20  |...u.....K..lCJ |
-00000260  97 0a 74 e5 79 ad dd 45  cc 3a e7 cc 8c 07 40 cb  |..t.y..E.:....@.|
-00000270  39 29 d5 73 82 41 3c 86  f4 16 75 c5 8e 46 2d dc  |9).s.A<...u..F-.|
-00000280  25 ae fa 3a 81 3a b2 79  a7 c4 02 c5 25 61 69 e3  |%..:.:.y....%ai.|
-00000290  a1 6f 59 5b 2a d8 65 4b  3c 5f fd 77 20 d0 ec f6  |.oY[*.eK<_.w ...|
-000002a0  1e e3 b6 a2 03 ba 1f e0  34 b4 2f eb 6e 85 ca 77  |........4./.n..w|
-000002b0  da ff 42 e8 91 99 f8 f8  d0 91 00 9c 26 c6 9c 54  |..B.........&..T|
-000002c0  1f 78 67 26 eb f2 20 59  ec 63 21 60 ce 51 10 4e  |.xg&.. Y.c!`.Q.N|
-000002d0  c2 32 dd 72 26 04 31 43  ed 68 34 54 8a 88 04 28  |.2.r&.1C.h4T...(|
-000002e0  66 e5 90 cc fa 20 e8 1f  c7 31 c5 8c 4d 32 4c 0d  |f.... ...1..M2L.|
-000002f0  45 0e fd 74 85 24 7e 7f  8b 56 18 9a 54 15 52 4e  |E..t.$~..V..T.RN|
-00000300  92 49 c4 ab 99 16 d8 01  61 d9 0b f0 5f 26 c3 7c  |.I......a..._&.||
-00000310  52 b5 bf 17 03 03 00 99  1e f8 19 a2 6e ac 2c 1e  |R...........n.,.|
-00000320  b3 7b ec f3 68 cf 13 c1  bb 03 a0 ea 5a 77 d5 61  |.{..h.......Zw.a|
-00000330  0a 0e 62 de 8d 56 d6 ff  3f 7a 91 f2 72 24 1d dc  |..b..V..?z..r$..|
-00000340  6e c7 bf e8 b8 98 5c eb  3c af 0d f7 89 22 db 53  |n.....\.<....".S|
-00000350  db 67 f9 20 c0 c4 cc 43  72 38 01 ab d3 b4 47 e5  |.g. ...Cr8....G.|
-00000360  7b 9a f4 0d 04 61 30 89  81 18 7d 90 86 c3 1b c9  |{....a0...}.....|
-00000370  e8 58 0a 62 42 cd 7f 05  77 a9 4e 75 fa 3a fd 13  |.X.bB...w.Nu.:..|
-00000380  98 90 92 f3 ee a8 cb 87  3e 62 d5 1e 81 4b 1b 79  |........>b...K.y|
-00000390  21 af b1 96 3f be eb de  52 c5 d5 d1 c2 da 47 2c  |!...?...R.....G,|
-000003a0  fd c5 26 41 f5 f9 00 82  9a 16 84 40 30 a9 89 96  |..&A.......@0...|
-000003b0  68 17 03 03 00 35 0c 40  10 4f 17 d9 1b cc 15 f0  |h....5.@.O......|
-000003c0  f2 f7 04 ea 07 66 c5 58  ce 47 56 b5 59 9b 8c 15  |.....f.X.GV.Y...|
-000003d0  d0 74 77 2f 96 f5 c2 9c  90 b6 16 70 aa bb 22 b8  |.tw/.......p..".|
-000003e0  2b f0 19 e8 a4 52 dc 80  4e ff 3a 17 03 03 00 83  |+....R..N.:.....|
-000003f0  24 8a ab e9 d3 a9 1b b3  d2 49 27 64 29 1b 9e 76  |$........I'd)..v|
-00000400  46 2d f0 db 01 7d 54 8e  53 9f b0 9e 03 90 92 c5  |F-...}T.S.......|
-00000410  d8 e1 1e ce 54 7f c3 30  3c a7 32 98 97 b6 3f 84  |....T..0<.2...?.|
-00000420  14 02 83 fe 70 1b ae 74  e4 5c 3d 67 d8 f7 58 14  |....p..t.\=g..X.|
-00000430  fb 09 71 27 ae 97 75 77  98 03 98 06 3f cf 80 c2  |..q'..uw....?...|
-00000440  43 ee ad bf 46 f6 f1 9f  86 d9 1a 85 07 b6 a3 b5  |C...F...........|
-00000450  e1 5e 01 a6 05 27 ed 78  4d 83 66 4f fe 4c 6f 9a  |.^...'.xM.fO.Lo.|
-00000460  59 25 65 52 4a 8d 5e 7a  2b 99 cc 7e 92 de 8d 19  |Y%eRJ.^z+..~....|
-00000470  0c d2 3d                                          |..=|
+00000080  03 03 00 01 01 17 03 03  00 17 bc 0c c7 e1 c6 61  |...............a|
+00000090  16 4f 94 bf 39 20 6f e7  e9 ea 16 e8 13 37 a7 fa  |.O..9 o......7..|
+000000a0  0f 17 03 03 02 6d 5b 46  3f 90 1d 2c 8e 72 8f a4  |.....m[F?..,.r..|
+000000b0  e1 79 c7 73 30 d4 ce c4  85 2e 3c a1 a2 2a 25 80  |.y.s0.....<..*%.|
+000000c0  63 3a 0b 31 33 8b d8 03  1c 15 4c c4 e2 b9 80 85  |c:.13.....L.....|
+000000d0  7f 41 d5 8d dc a0 37 a4  6b ed 8c 85 89 24 0f 34  |.A....7.k....$.4|
+000000e0  0f 5d 5b 6e 9a 7e 38 bf  df 40 92 74 a1 0d c2 49  |.][n.~8..@.t...I|
+000000f0  38 e2 e0 1e 85 3f 0c 9e  2a 25 e8 db 7c 13 08 4c  |8....?..*%..|..L|
+00000100  3a e2 2f 39 90 2d 4f 2e  b4 f7 eb c2 bd c3 89 a6  |:./9.-O.........|
+00000110  d1 79 73 ac af fb af 9d  f0 c8 2d d3 1a ec 28 20  |.ys.......-...( |
+00000120  ae 34 d1 85 02 8c cc 52  25 53 72 c1 99 71 f4 37  |.4.....R%Sr..q.7|
+00000130  6e aa 18 66 32 07 b1 d5  94 87 00 ca e6 47 93 0f  |n..f2........G..|
+00000140  6d 0a e3 8a d2 54 4c ec  a3 da b0 dc 5f 45 0d 27  |m....TL....._E.'|
+00000150  62 c3 c7 f8 20 65 b8 71  13 bb 99 a0 e1 d9 84 30  |b... e.q.......0|
+00000160  33 1d 06 ef e0 90 b8 1e  8a 1a 97 bc f6 19 da 06  |3...............|
+00000170  15 81 d0 94 d8 fc a8 12  cb 78 4b 5f 68 b4 f7 9d  |.........xK_h...|
+00000180  16 0d 25 d2 f8 ed 21 9c  82 57 8d 6a 1e 0c 20 16  |..%...!..W.j.. .|
+00000190  59 79 df cd 46 a0 65 8c  f2 b9 f3 55 d7 c2 0a d7  |Yy..F.e....U....|
+000001a0  aa 51 1f 56 4e 7f 5a b2  a3 81 54 2b f8 78 23 c4  |.Q.VN.Z...T+.x#.|
+000001b0  37 3d 96 c5 1a 3c b3 32  ff 59 df 38 0e a2 84 4e  |7=...<.2.Y.8...N|
+000001c0  cc 30 c2 52 eb 7a 97 e6  e2 a5 d8 cb d2 37 dc 74  |.0.R.z.......7.t|
+000001d0  b8 53 3f 23 d2 07 86 d8  0a 2e 01 60 43 d5 66 2e  |.S?#.......`C.f.|
+000001e0  a6 2d 2e 0a 0f 67 bf d9  23 5c 32 83 db ed 5f 75  |.-...g..#\2..._u|
+000001f0  70 22 73 28 f4 64 88 c2  97 3f a2 38 60 8d be 5b  |p"s(.d...?.8`..[|
+00000200  0b 3c 5f 20 58 78 8d c3  5c 83 39 73 4c 24 46 14  |.<_ Xx..\.9sL$F.|
+00000210  ce 81 98 43 9c 26 5d 2b  cd 96 09 d6 34 92 ac 0f  |...C.&]+....4...|
+00000220  d4 1d 33 09 77 f4 b9 b7  a4 6e de b8 de 11 72 39  |..3.w....n....r9|
+00000230  d7 c2 cb ab 66 d1 38 22  72 ab 7d 34 1b f5 cf 67  |....f.8"r.}4...g|
+00000240  18 f6 07 f1 5b 5d 99 54  cc da 66 65 bd 60 3d b4  |....[].T..fe.`=.|
+00000250  76 f6 cf 7b c8 39 d5 ff  e5 97 a4 8e a1 7b c0 b4  |v..{.9.......{..|
+00000260  a2 d4 95 5a 6b c5 20 19  f6 9d 96 c9 de 62 78 23  |...Zk. ......bx#|
+00000270  f1 87 68 a3 7a 9e 49 42  20 91 28 25 f9 86 b5 1c  |..h.z.IB .(%....|
+00000280  14 f8 82 78 9a 7b 96 e3  e8 c9 64 7a f5 89 bc 77  |...x.{....dz...w|
+00000290  0a 67 55 e8 7d e1 f0 d1  fa 50 a2 4e c9 7a 84 12  |.gU.}....P.N.z..|
+000002a0  54 75 c1 90 b7 75 27 ea  47 ca 1a 1f a5 37 ef 6e  |Tu...u'.G....7.n|
+000002b0  96 a2 46 a8 cd ac 0b 7a  f6 f5 cf 59 72 05 87 a3  |..F....z...Yr...|
+000002c0  e0 3b 4c 39 c6 e5 20 61  f3 9e 5f bf a6 ee 43 d7  |.;L9.. a.._...C.|
+000002d0  16 3c 68 b9 d4 33 72 cd  be 38 1c ba d6 ed e8 21  |.<h..3r..8.....!|
+000002e0  5f b6 71 c8 c6 a0 5a d3  4c df d7 2c 72 3f aa e7  |_.q...Z.L..,r?..|
+000002f0  c5 01 4f df 01 e0 4d 1c  eb 28 dc 58 95 fe 4e 3d  |..O...M..(.X..N=|
+00000300  25 92 54 2d 0a 18 4a a9  43 9f 34 8b 5a a2 4f ac  |%.T-..J.C.4.Z.O.|
+00000310  c2 f1 43 17 03 03 00 99  4a 9d 6b c0 da 9e e0 e1  |..C.....J.k.....|
+00000320  8a d8 95 39 05 e2 82 35  9d 88 7d c3 3b 8a 0f e4  |...9...5..}.;...|
+00000330  4e 58 8f 3e 8e b8 20 56  b3 36 60 41 17 52 01 84  |NX.>.. V.6`A.R..|
+00000340  ef b2 b2 3a e0 e6 54 03  a1 8a 70 b7 80 6a b2 e6  |...:..T...p..j..|
+00000350  58 93 bd 06 bf 7c 26 68  9c 79 9e cb 20 d8 6d 45  |X....|&h.y.. .mE|
+00000360  cc bb d1 09 fd 0e cc 13  4e f8 e7 9e 17 c2 b6 b0  |........N.......|
+00000370  ce 2c 6e 77 6f b8 00 fd  30 83 89 ab 24 e1 56 bf  |.,nwo...0...$.V.|
+00000380  4e 96 40 e2 aa ab 90 08  7f 5f 27 d9 18 04 bc b8  |N.@......_'.....|
+00000390  f5 55 fa 15 b0 4e 30 f4  9d c7 a3 7c da 26 3e 47  |.U...N0....|.&>G|
+000003a0  0c 80 d9 c5 65 0d 39 40  dd 22 25 86 a2 9d 2b 16  |....e.9@."%...+.|
+000003b0  00 17 03 03 00 35 01 ee  d6 89 98 31 59 e4 bd d6  |.....5.....1Y...|
+000003c0  78 f2 25 f9 22 e3 33 71  da dd 8d 28 52 45 bb a5  |x.%.".3q...(RE..|
+000003d0  fb d7 9f 1a b2 c2 59 e9  e4 ca ed 08 7c db 55 a7  |......Y.....|.U.|
+000003e0  21 fc 91 1b 2a bc c0 bf  3b f4 c8 17 03 03 00 83  |!...*...;.......|
+000003f0  62 5a 55 4e 3f 35 e7 ef  28 c0 c4 57 ad 21 67 45  |bZUN?5..(..W.!gE|
+00000400  14 00 98 99 ed 40 c2 f0  43 a5 31 2e 4e d4 50 5f  |.....@..C.1.N.P_|
+00000410  e4 ce 4d de ea b0 a7 19  9e 92 83 c0 aa a4 8d e9  |..M.............|
+00000420  f1 5e ea 86 ea 90 77 ab  82 2f ee 07 1a b9 39 a5  |.^....w../....9.|
+00000430  43 96 b3 37 dc ca 10 64  4e 67 8d fd c9 14 2e b0  |C..7...dNg......|
+00000440  43 ed c1 5b 2d d6 1f 91  54 a8 8b b1 16 74 b7 84  |C..[-...T....t..|
+00000450  21 2f af 42 ae c0 12 b8  c3 d8 36 a6 c1 39 27 84  |!/.B......6..9'.|
+00000460  23 27 a5 30 58 91 d9 1c  8e f0 79 ad 00 7f ac ff  |#'.0X.....y.....|
+00000470  3a e7 d9                                          |:..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 aa bf 81 58 da  |..........5...X.|
-00000010  aa dd 26 28 f8 e1 bb 50  50 33 58 cf 3c 65 58 ea  |..&(...PP3X.<eX.|
-00000020  c5 aa d6 98 0e c0 dc 60  c8 0a f9 ac cd 89 39 6b  |.......`......9k|
-00000030  49 1e bf 16 6a 17 4a 05  dc c6 8a 74 23 19 f2 a4  |I...j.J....t#...|
+00000000  14 03 03 00 01 01 17 03  03 00 35 88 13 07 ce 23  |..........5....#|
+00000010  dd e3 81 28 71 33 d8 5c  86 d7 e9 03 ca 97 d6 3c  |...(q3.\.......<|
+00000020  c0 98 51 53 79 21 31 5f  88 75 9b 2c 0d f2 ff 3c  |..QSy!1_.u.,...<|
+00000030  3a 11 52 98 41 f5 bc 96  6f 1d e7 c1 a5 41 b2 cf  |:.R.A...o....A..|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 69 ff 01  c3 f3 c3 80 2a 0e 95 39  |.....i......*..9|
-00000010  cb 50 bf 53 4a c3 f1 09  24 6d 4d f1 6a f6 89 6f  |.P.SJ...$mM.j..o|
-00000020  b4 88 db 17 03 03 00 13  17 60 23 ef 4c 1a c9 6d  |.........`#.L..m|
-00000030  50 9f 12 04 54 87 83 71  56 25 28                 |P...T..qV%(|
+00000000  17 03 03 00 1e c8 73 85  2e b1 9c 38 7e 83 be 93  |......s....8~...|
+00000010  51 66 da 22 1c 71 5f f9  c9 2c a2 f1 5a 6a 1e 61  |Qf.".q_..,..Zj.a|
+00000020  bc a6 c7 17 03 03 00 13  66 de ee ae 73 9d cd 07  |........f...s...|
+00000030  78 88 a9 20 55 f6 4e 8f  ce b0 29                 |x.. U.N...)|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-AES256-SHA384 b/src/crypto/tls/testdata/Server-TLSv13-AES256-SHA384
index 04ffc30e24..3d030fbea4 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-AES256-SHA384
+++ b/src/crypto/tls/testdata/Server-TLSv13-AES256-SHA384
@@ -1,100 +1,100 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 80 f9 84 75 26  |..............u&|
-00000010  26 2f 35 8e 6e fb df 99  88 7f 74 c8 01 d4 58 26  |&/5.n.....t...X&|
-00000020  26 9b f3 ba 0b fe 5f 09  31 96 73 20 b8 21 95 68  |&....._.1.s .!.h|
-00000030  4d 05 b2 c3 da dc a7 da  a5 67 12 8c a0 05 e5 66  |M........g.....f|
-00000040  28 c2 fa 88 5a a9 08 62  71 b6 7a 6a 00 04 13 02  |(...Z..bq.zj....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 a1 4f 94 bb 8b  |............O...|
+00000010  b0 3d b3 30 fc d0 1b 09  e6 40 3a 19 60 1b 32 2e  |.=.0.....@:.`.2.|
+00000020  d5 ff 57 a7 1b be de 9a  69 85 3f 20 75 30 ba da  |..W.....i.? u0..|
+00000030  e6 be 92 62 4a e5 f0 58  27 37 6f d7 2d 30 c9 a2  |...bJ..X'7o.-0..|
+00000040  c0 96 9f 9f d0 07 9e 0d  3c 1d 52 3c 00 04 13 02  |........<.R<....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 8d  |-.....3.&.$... .|
-000000b0  b6 28 b1 e3 a4 3e 2f bd  5c 73 88 40 30 8e 85 da  |.(...>/.\s.@0...|
-000000c0  a9 dc eb 5d d1 91 f8 b6  36 71 90 1b 3a 26 0a     |...]....6q..:&.|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 7e  |-.....3.&.$... ~|
+000000b0  fe c0 6e 4b 28 5f 5a 29  6e 54 33 c8 65 60 00 91  |..nK(_Z)nT3.e`..|
+000000c0  b9 24 fc 7d 21 2e 3c d4  00 3f 27 97 f9 46 5f     |.$.}!.<..?'..F_|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 b8 21 95 68  |........... .!.h|
-00000030  4d 05 b2 c3 da dc a7 da  a5 67 12 8c a0 05 e5 66  |M........g.....f|
-00000040  28 c2 fa 88 5a a9 08 62  71 b6 7a 6a 13 02 00 00  |(...Z..bq.zj....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 75 30 ba da  |........... u0..|
+00000030  e6 be 92 62 4a e5 f0 58  27 37 6f d7 2d 30 c9 a2  |...bJ..X'7o.-0..|
+00000040  c0 96 9f 9f d0 07 9e 0d  3c 1d 52 3c 13 02 00 00  |........<.R<....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 0f 50 a8 53 56 c5  |...........P.SV.|
-00000090  ea 1c d6 72 c2 7b 55 c5  13 6d 4f a8 69 8b 48 bf  |...r.{U..mO.i.H.|
-000000a0  a8 17 03 03 02 6d 95 5e  15 34 7f b4 ec 49 0e da  |.....m.^.4...I..|
-000000b0  b5 90 4d 1d cc f1 96 6f  7f ed d6 d6 58 9a 76 4e  |..M....o....X.vN|
-000000c0  51 41 d5 93 d2 a3 1b b6  c8 55 78 1e 58 09 57 0e  |QA.......Ux.X.W.|
-000000d0  55 47 c7 6b 6a d2 bb 5a  67 19 90 32 d3 63 c6 e8  |UG.kj..Zg..2.c..|
-000000e0  32 51 10 f0 32 05 82 7f  7e a3 0d f9 d1 d3 30 8d  |2Q..2...~.....0.|
-000000f0  0c f6 9a 82 19 fe 3d b9  38 4c 70 e9 26 e9 f8 e3  |......=.8Lp.&...|
-00000100  d8 5f 95 5e 2f d4 f9 85  94 c8 34 0e 02 9e 45 ec  |._.^/.....4...E.|
-00000110  8f 16 f8 e2 91 e5 00 0b  04 13 4c da 3f bf 44 cf  |..........L.?.D.|
-00000120  41 45 d0 da ae fb 26 b7  15 aa e9 f6 dd cd da 0e  |AE....&.........|
-00000130  14 2b b5 48 55 00 b1 a5  20 30 aa 2d 07 af 49 c0  |.+.HU... 0.-..I.|
-00000140  86 e6 41 b6 93 72 4b 76  27 1d 3d 92 ab b5 b3 e5  |..A..rKv'.=.....|
-00000150  02 2c e0 05 1a d4 c1 b4  95 56 0c 9c 0c e7 dd 70  |.,.......V.....p|
-00000160  9a 94 c0 e3 58 07 96 37  dc 47 c0 a9 b3 fb 00 be  |....X..7.G......|
-00000170  55 97 94 12 58 ad 1d b7  1c 20 57 11 02 ab d9 6c  |U...X.... W....l|
-00000180  37 c7 9d d0 65 f5 e4 58  85 8d 6f ee a6 e6 c5 24  |7...e..X..o....$|
-00000190  22 1b 42 59 e0 84 0a db  66 6a b5 8b f9 29 67 85  |".BY....fj...)g.|
-000001a0  31 cd 3d bb db 56 bb 34  96 9a 2e 49 ce f0 3d 8d  |1.=..V.4...I..=.|
-000001b0  ad 16 7f 88 f3 6f f5 e7  28 73 8e dc d9 b0 e9 55  |.....o..(s.....U|
-000001c0  7a 96 fa 60 aa 67 69 20  ea f8 23 a0 3d dd 26 7c  |z..`.gi ..#.=.&||
-000001d0  ca 83 a7 7a d1 c9 bb 72  bc 50 cd 5a 77 57 a9 f7  |...z...r.P.ZwW..|
-000001e0  f5 02 b8 ed 97 5a e9 53  d0 4f 42 9a fe a6 c5 61  |.....Z.S.OB....a|
-000001f0  49 4f 93 19 a0 fd d3 63  7e d1 6f 4b 52 9d b5 78  |IO.....c~.oKR..x|
-00000200  9d 12 e9 3f d8 0d b4 fc  67 c7 be b7 c1 3f dc 9e  |...?....g....?..|
-00000210  c4 12 b3 a3 15 9e f0 83  e4 19 d6 b5 1d c1 f7 86  |................|
-00000220  12 0d c1 7d 4d 83 7e 86  a2 0a a9 21 5a 9f 05 f5  |...}M.~....!Z...|
-00000230  a9 9e 8d 1e 55 17 38 9c  3c 88 09 30 60 d6 39 ba  |....U.8.<..0`.9.|
-00000240  4d d3 f1 a5 fa a6 0a f3  65 0d da 94 a0 42 10 f2  |M.......e....B..|
-00000250  0c 1b 3e e8 eb ea 64 6e  f2 51 f1 bc 2b b3 36 a0  |..>...dn.Q..+.6.|
-00000260  29 e8 9f e1 62 72 0e 93  33 3b 34 d1 f8 b2 8f 72  |)...br..3;4....r|
-00000270  80 9c 67 e9 39 98 91 90  23 70 57 4d 22 36 d3 b0  |..g.9...#pWM"6..|
-00000280  82 ed 06 62 1c 8f 83 1d  89 20 79 0a b2 c3 84 38  |...b..... y....8|
-00000290  35 bb f9 5f f9 4d 2e a7  91 52 58 f5 bd 28 80 5a  |5.._.M...RX..(.Z|
-000002a0  59 23 33 b4 00 eb f2 fc  b8 d6 54 dd 2c c8 13 84  |Y#3.......T.,...|
-000002b0  30 4f e1 50 f7 ed 0c f4  7a 33 89 9f fc a1 a4 74  |0O.P....z3.....t|
-000002c0  f0 a8 b8 76 b2 82 e0 a4  eb f0 c2 01 07 aa 00 b6  |...v............|
-000002d0  c0 f4 a7 b4 59 81 35 fa  8e 9a 98 e1 3d 21 9d 56  |....Y.5.....=!.V|
-000002e0  9c 1c d1 3a bc 6e 06 ba  83 d8 f1 06 c5 0f 33 9d  |...:.n........3.|
-000002f0  ad e0 42 0f dd 8a 0a 84  ba 8a 22 26 f9 4f 60 2d  |..B......."&.O`-|
-00000300  15 1c 98 9e d4 76 56 5e  de 67 f3 d7 43 5c a8 d4  |.....vV^.g..C\..|
-00000310  78 b7 fa 17 03 03 00 99  90 86 ce 5d 5e cb e4 67  |x..........]^..g|
-00000320  b3 a8 b8 9a 1c 67 dd c6  0f 09 92 8b f4 4f df c5  |.....g.......O..|
-00000330  6f 93 6f 68 28 96 37 d3  9c 2a d1 e6 78 b5 34 b7  |o.oh(.7..*..x.4.|
-00000340  9b 21 35 49 ba 48 9d 3b  30 4a 73 e3 1d a5 d4 42  |.!5I.H.;0Js....B|
-00000350  a5 21 7c b7 e7 57 af a6  20 d4 18 f6 d6 9e 9e d8  |.!|..W.. .......|
-00000360  9d 05 96 67 73 2a 43 48  84 c0 83 5c 55 61 2b 4c  |...gs*CH...\Ua+L|
-00000370  85 6a ac 01 75 63 65 05  81 b3 8c 21 3d 24 ee 29  |.j..uce....!=$.)|
-00000380  65 46 37 8a 9c b1 1a 7e  ed d6 48 68 28 9c a8 88  |eF7....~..Hh(...|
-00000390  26 ce f8 af 1f f8 a6 9a  c5 2a 8a 26 63 67 7b 96  |&........*.&cg{.|
-000003a0  4e c4 b4 3d c0 81 80 fc  51 a4 ef 17 8e 43 07 77  |N..=....Q....C.w|
-000003b0  b6 17 03 03 00 45 83 ee  5d f7 13 ea 4a 98 8a bf  |.....E..]...J...|
-000003c0  92 15 ca 5c 9c e1 55 85  d6 4e c9 34 ef 17 4b 4f  |...\..U..N.4..KO|
-000003d0  4e fa ec 58 12 b1 2f 66  67 44 08 3d 77 8c 64 7b  |N..X../fgD.=w.d{|
-000003e0  30 bf 38 08 5e ac 28 9f  c3 a5 68 04 74 de 5e a3  |0.8.^.(...h.t.^.|
-000003f0  8b c4 8c 33 45 56 0a a1  84 cb 5e 17 03 03 00 93  |...3EV....^.....|
-00000400  c1 f1 58 63 c1 10 ba de  f5 17 95 fa fb 7a 36 9a  |..Xc.........z6.|
-00000410  fc 5e 04 08 a0 75 22 02  aa c0 e2 26 3c b2 42 b1  |.^...u"....&<.B.|
-00000420  28 6d 57 fc 5b b4 73 3c  cc 94 3c 75 a3 10 fc 2d  |(mW.[.s<..<u...-|
-00000430  e8 64 a1 cb 74 b8 2a c7  ef 5b 1f 3f 39 51 d5 10  |.d..t.*..[.?9Q..|
-00000440  3e f8 e4 38 da 16 97 2f  72 7b 8f 3f c2 06 8f df  |>..8.../r{.?....|
-00000450  14 29 e4 4d 11 4b 78 9f  00 fe cc c5 b0 5f 5a 9d  |.).M.Kx......_Z.|
-00000460  dd 1d dc 6f ab 7a 4f b5  ab 93 3a 6e 62 0e 67 84  |...o.zO...:nb.g.|
-00000470  3a f8 5f 7f 7b 2b 33 ad  6e 67 bf e9 2b 49 ed a0  |:._.{+3.ng..+I..|
-00000480  1a d3 d6 45 0b 05 fd 78  bc e2 00 b4 f5 d5 df 7f  |...E...x........|
-00000490  86 9d 25                                          |..%|
+00000080  03 03 00 01 01 17 03 03  00 17 a4 1e c8 0f 16 60  |...............`|
+00000090  65 45 d8 4d 8b 5c 32 a4  1a bf 75 2e 7c f4 98 41  |eE.M.\2...u.|..A|
+000000a0  8a 17 03 03 02 6d f6 2e  85 65 a5 7b ab eb e4 80  |.....m...e.{....|
+000000b0  ad 35 9b fd 63 00 7e cd  dd 92 5f 33 77 5d 04 3c  |.5..c.~..._3w].<|
+000000c0  e1 c6 9e c1 0a 50 87 9f  e2 b8 02 60 04 47 ae 3c  |.....P.....`.G.<|
+000000d0  2b 59 fc ee 1d 54 f6 42  db 1e a6 18 8e 78 6c 83  |+Y...T.B.....xl.|
+000000e0  5d 24 9d 2e 8b c9 05 ae  46 9d 7e 1c 94 58 63 d4  |]$......F.~..Xc.|
+000000f0  17 9f 87 75 ab 5e da 32  8f 98 22 7d f8 d0 ef 9d  |...u.^.2.."}....|
+00000100  79 e4 52 64 b1 67 71 a8  3d b3 fc 3c d3 73 c8 73  |y.Rd.gq.=..<.s.s|
+00000110  54 b1 cc f5 c8 15 a2 df  d5 4f 0b 1e 84 37 68 f7  |T........O...7h.|
+00000120  7f 92 85 d7 7e b1 4a 56  95 c4 3b c2 5f 78 04 74  |....~.JV..;._x.t|
+00000130  08 7d 26 24 af c6 c6 05  c8 e8 23 12 97 67 3a 18  |.}&$......#..g:.|
+00000140  21 e1 d9 18 47 48 f7 6a  dd 8e a7 ce 3b fa 93 26  |!...GH.j....;..&|
+00000150  2c 61 e0 d9 2a ba 7c d6  32 d0 a1 83 a0 ef 21 7d  |,a..*.|.2.....!}|
+00000160  78 08 94 38 d7 f1 01 5a  a3 e0 2d de 51 6c c9 ad  |x..8...Z..-.Ql..|
+00000170  6e f4 d2 6b b3 4a 3d 1a  67 2a 16 cd 7f 19 eb 6c  |n..k.J=.g*.....l|
+00000180  e4 b5 c4 32 c9 94 d2 e5  75 33 a1 2d d7 a4 68 0e  |...2....u3.-..h.|
+00000190  d0 c4 09 76 61 8a 41 43  0d 49 4d 9b 36 e8 6c 91  |...va.AC.IM.6.l.|
+000001a0  02 9e 67 f6 a8 04 a0 47  72 c8 97 54 ff 13 a4 d2  |..g....Gr..T....|
+000001b0  c7 5a d1 85 89 8c c8 00  87 be 32 07 51 7a 13 22  |.Z........2.Qz."|
+000001c0  e8 5b ea ed e3 47 a3 20  a8 fd 7b 1b 0e e7 8b a8  |.[...G. ..{.....|
+000001d0  35 c2 00 63 3f 30 18 40  b3 bd a2 6d 54 f4 a9 31  |5..c?0.@...mT..1|
+000001e0  c7 60 5d f3 31 f9 14 5a  33 70 a6 65 c1 2b 27 9c  |.`].1..Z3p.e.+'.|
+000001f0  3d 16 4b 71 8e 60 0a 1c  55 35 da 19 e6 30 db 6b  |=.Kq.`..U5...0.k|
+00000200  68 05 e2 f7 f5 c6 e6 0e  88 b9 09 58 7e 24 07 98  |h..........X~$..|
+00000210  29 22 f0 5f 19 42 08 66  a7 6b 8c 33 78 ac 1d db  |)"._.B.f.k.3x...|
+00000220  8d 9d b8 7b 52 3e 89 15  c8 23 53 4e b3 7f fe 34  |...{R>...#SN...4|
+00000230  c7 61 49 61 9a 03 b3 36  5d 9a 3d 82 a0 a1 eb eb  |.aIa...6].=.....|
+00000240  b2 ab 84 00 b8 df cd 89  7c b6 28 17 2e 7d 3c c1  |........|.(..}<.|
+00000250  5b 37 fc 74 5a f7 54 31  d7 a2 07 57 ad 63 94 0d  |[7.tZ.T1...W.c..|
+00000260  05 21 81 30 0a 60 c4 b5  d9 98 1a 7c 3f 78 41 51  |.!.0.`.....|?xAQ|
+00000270  2a 66 bd a6 36 64 b3 8b  4f d0 5a 61 62 7f 30 70  |*f..6d..O.Zab.0p|
+00000280  73 61 0e c6 c2 8b 90 91  04 ea 98 25 24 c5 35 93  |sa.........%$.5.|
+00000290  e2 6f b1 7b e1 d1 d3 29  eb 97 e5 11 a7 63 93 2c  |.o.{...).....c.,|
+000002a0  2e 55 0b 64 bd 2c d9 2a  46 b6 30 ca 3c 52 a2 46  |.U.d.,.*F.0.<R.F|
+000002b0  26 24 bc e8 77 ec 0c a3  7c aa 8f 25 1f 54 36 fc  |&$..w...|..%.T6.|
+000002c0  c0 b1 c0 a7 89 6b 7a 49  bf ef 43 35 b8 0c 0e fe  |.....kzI..C5....|
+000002d0  69 fb 24 d0 7b 8e 08 17  f8 fa eb b9 2c 6e 93 67  |i.$.{.......,n.g|
+000002e0  f2 e1 2f 17 27 15 bb ce  a7 2d e1 3d 17 28 9b 30  |../.'....-.=.(.0|
+000002f0  c6 88 aa 12 e9 56 41 1f  90 d6 25 b9 41 32 ad b6  |.....VA...%.A2..|
+00000300  1b a8 75 0d 35 0a 3f af  60 7f 93 63 43 88 b7 d6  |..u.5.?.`..cC...|
+00000310  90 69 23 17 03 03 00 99  9b 93 f0 b1 61 52 8f a7  |.i#.........aR..|
+00000320  1f d8 be 37 28 87 38 b7  89 4d 98 a6 f2 be 83 9b  |...7(.8..M......|
+00000330  1e cd de ea 95 a2 cd 18  66 1a 48 a4 de a9 55 fe  |........f.H...U.|
+00000340  69 80 1f 46 f8 c5 89 c6  f5 f6 f4 02 62 4a 4d 08  |i..F........bJM.|
+00000350  c9 db ab b0 de b3 e2 70  81 f7 5a 9b 0f 0e f1 ab  |.......p..Z.....|
+00000360  4e 31 58 01 57 63 f5 ae  89 28 20 78 fe 1c f1 89  |N1X.Wc...( x....|
+00000370  23 ca 95 1a 40 e8 2b 12  3e 99 4e 85 ec be 75 ef  |#...@.+.>.N...u.|
+00000380  63 43 45 e9 e0 51 93 5d  3a 64 39 53 2a 20 e5 e8  |cCE..Q.]:d9S* ..|
+00000390  c6 7f 23 0b 20 3d a8 6e  99 8b da fc d1 e8 19 91  |..#. =.n........|
+000003a0  b3 00 f5 e8 bf 73 df 6f  20 27 7d 92 98 e8 e3 ae  |.....s.o '}.....|
+000003b0  88 17 03 03 00 45 6b ae  32 0c f3 3b f5 fd d8 d6  |.....Ek.2..;....|
+000003c0  5f 59 c2 46 1d d5 cb c7  fb ec b0 87 f2 7e 30 23  |_Y.F.........~0#|
+000003d0  23 ed c0 51 22 b8 53 6e  92 6a 32 a6 8a 77 32 c1  |#..Q".Sn.j2..w2.|
+000003e0  9c 26 e5 bd be 71 9a 8c  62 9c 84 9e 82 e1 bb 09  |.&...q..b.......|
+000003f0  d7 ac 77 76 73 a9 95 fa  db 4c 27 17 03 03 00 93  |..wvs....L'.....|
+00000400  44 c4 3b 46 5f b4 06 2e  aa 88 19 e4 9c bf 5e 2e  |D.;F_.........^.|
+00000410  8b 16 77 21 87 5d 60 e0  ff ca 5d 0d e5 17 4c eb  |..w!.]`...]...L.|
+00000420  b6 86 76 9b 72 bc f7 de  fe 63 d3 35 0a 54 31 45  |..v.r....c.5.T1E|
+00000430  0b fe 1f ce e1 2a c7 96  2d 80 75 65 2c cb 71 c4  |.....*..-.ue,.q.|
+00000440  16 6a 15 76 be 91 7e c1  c7 0e a2 32 41 bb a4 4e  |.j.v..~....2A..N|
+00000450  9e 2c 5a 31 fe 86 a1 cc  8a 4a f7 42 a7 fc e9 0c  |.,Z1.....J.B....|
+00000460  89 10 ae ae 25 b8 d8 cc  ca d3 8a c5 d1 ce da c2  |....%...........|
+00000470  39 80 9a 43 66 d0 88 e9  2c 8b 1e db 30 c4 bc 86  |9..Cf...,...0...|
+00000480  82 ce f3 f8 b4 70 6c a6  2a 3d 08 18 86 b4 a2 8e  |.....pl.*=......|
+00000490  b9 ff 6e                                          |..n|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 45 b3 73 83 75 b0  |..........E.s.u.|
-00000010  95 36 0a 26 c5 06 0c 61  04 89 72 9d 04 f8 3d 87  |.6.&...a..r...=.|
-00000020  70 be 43 98 9c fe 20 f4  4c bd fe 93 81 79 85 27  |p.C... .L....y.'|
-00000030  56 7d 73 84 6c 96 c0 8b  bf 97 67 ff 76 05 9e eb  |V}s.l.....g.v...|
-00000040  e5 7a 76 cd 12 b4 49 02  7e f6 87 87 d0 37 7f 30  |.zv...I.~....7.0|
+00000000  14 03 03 00 01 01 17 03  03 00 45 c2 0d 7c 7a 2c  |..........E..|z,|
+00000010  e5 e6 ac 1b c6 9b b3 8f  ba 7b 82 bb 68 c9 87 2c  |.........{..h..,|
+00000020  1e 51 27 47 b9 f5 c8 87  fa d8 51 bd 73 64 11 d3  |.Q'G......Q.sd..|
+00000030  ca d3 95 21 b0 d4 23 bd  13 af ce 30 5a 92 59 6b  |...!..#....0Z.Yk|
+00000040  7c 0c 11 ee fb 67 99 6f  e9 e3 30 97 2a d2 7b 79  ||....g.o..0.*.{y|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 62 6b 04  56 bc 90 bf 8e ce d1 8a  |.....bk.V.......|
-00000010  78 29 fc c2 b2 73 ea 2a  2e f7 1a c9 8c 1d 5f 44  |x)...s.*......_D|
-00000020  5d 7a b4 17 03 03 00 13  a9 57 17 0c 1a c5 80 3d  |]z.......W.....=|
-00000030  ed 81 0c 12 1e a1 f5 06  ce 7b 27                 |.........{'|
+00000000  17 03 03 00 1e 86 63 0b  0a 19 4b 04 36 02 3d d1  |......c...K.6.=.|
+00000010  3d 73 99 a6 64 2c 8a f2  30 b0 4d 4e bd d8 0e 56  |=s..d,..0.MN...V|
+00000020  53 79 7f 17 03 03 00 13  1c ab d4 d5 94 fd 53 f4  |Sy............S.|
+00000030  f8 93 1d 32 a2 e7 f9 97  be 58 f8                 |...2.....X.|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ALPN b/src/crypto/tls/testdata/Server-TLSv13-ALPN
index 9a4c125503..8220252b93 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ALPN
+++ b/src/crypto/tls/testdata/Server-TLSv13-ALPN
@@ -1,9 +1,9 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 e2 01 00 00  de 03 03 bb a9 c3 a8 a5  |................|
-00000010  1b 31 e3 bd f6 de a4 3b  0e b7 20 60 7c 36 19 fa  |.1.....;.. `|6..|
-00000020  ee 91 44 fa 11 e0 d1 4f  cf 4c 02 20 bc 07 bf 23  |..D....O.L. ...#|
-00000030  8b 01 3b ae 06 98 07 a4  96 3b bc aa d1 71 0c dd  |..;......;...q..|
-00000040  b1 02 54 8b 15 b7 f0 d4  23 74 ed bb 00 04 13 03  |..T.....#t......|
+00000000  16 03 01 00 e2 01 00 00  de 03 03 3d 17 60 e9 0b  |...........=.`..|
+00000010  48 e7 d9 fa 92 96 73 e7  a7 76 ef f5 16 27 45 f7  |H.....s..v...'E.|
+00000020  a6 0d 1f ca aa 8f 09 67  dc e8 a4 20 61 e0 03 01  |.......g... a...|
+00000030  a8 9c bf 64 33 51 0e 2e  9c 49 9b bd 0d e8 9e 63  |...d3Q...I.....c|
+00000040  23 49 a4 f2 b4 49 6b 02  a9 65 2c 91 00 04 13 03  |#I...Ik..e,.....|
 00000050  00 ff 01 00 00 91 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 10 00 10 00 0e  06 70 72 6f 74 6f 32 06  |.........proto2.|
@@ -11,89 +11,89 @@
 00000090  00 1e 00 1c 04 03 05 03  06 03 08 07 08 08 08 09  |................|
 000000a0  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
 000000b0  00 2b 00 03 02 03 04 00  2d 00 02 01 01 00 33 00  |.+......-.....3.|
-000000c0  26 00 24 00 1d 00 20 37  01 55 d8 5a 52 5c 9a 63  |&.$... 7.U.ZR\.c|
-000000d0  83 7e 66 f8 76 8c 89 e1  8b 12 0c 0c eb 10 cd d6  |.~f.v...........|
-000000e0  f4 ac 45 74 5f 10 00                              |..Et_..|
+000000c0  26 00 24 00 1d 00 20 8c  bd 59 e4 1e 31 78 10 23  |&.$... ..Y..1x.#|
+000000d0  ab 48 ac 6d 1d 36 52 01  93 8c 39 08 f9 4f 02 c3  |.H.m.6R...9..O..|
+000000e0  f6 80 75 7e 95 4b 7a                              |..u~.Kz|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 bc 07 bf 23  |........... ...#|
-00000030  8b 01 3b ae 06 98 07 a4  96 3b bc aa d1 71 0c dd  |..;......;...q..|
-00000040  b1 02 54 8b 15 b7 f0 d4  23 74 ed bb 13 03 00 00  |..T.....#t......|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 61 e0 03 01  |........... a...|
+00000030  a8 9c bf 64 33 51 0e 2e  9c 49 9b bd 0d e8 9e 63  |...d3Q...I.....c|
+00000040  23 49 a4 f2 b4 49 6b 02  a9 65 2c 91 13 03 00 00  |#I...Ik..e,.....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 24 71 b0 7e 2a f8 25  |.........$q.~*.%|
-00000090  f0 3e 80 b6 7d 0c de 6a  81 41 f5 f1 04 73 cc f1  |.>..}..j.A...s..|
-000000a0  76 9a b5 80 da b6 f3 10  70 bd 8e ec 45 5d 17 03  |v.......p...E]..|
-000000b0  03 02 6d e6 db ce 88 22  69 78 86 38 36 c4 64 60  |..m...."ix.86.d`|
-000000c0  65 fd fe 86 5e 4e 15 84  d4 aa 69 d4 64 ae be 47  |e...^N....i.d..G|
-000000d0  4e e4 eb 63 cf 5e 47 c8  0b 1a 15 cc 7a cf 03 d9  |N..c.^G.....z...|
-000000e0  93 58 63 6e 3c b9 d1 7c  0a cd c1 45 c3 7c c5 50  |.Xcn<..|...E.|.P|
-000000f0  f0 31 17 7f d0 47 34 25  58 f1 39 83 8b d1 a0 7c  |.1...G4%X.9....||
-00000100  8a 1b 10 12 b7 3d 7b a0  57 de 5b f8 af 88 16 84  |.....={.W.[.....|
-00000110  74 00 10 9b b1 a3 64 94  21 3e 6a 30 e0 9d a5 ee  |t.....d.!>j0....|
-00000120  8b 1c 05 3e 4e f9 fe 34  e2 f0 38 c3 3e a5 27 32  |...>N..4..8.>.'2|
-00000130  14 a2 d6 98 e9 42 1f 40  84 de 67 3a b9 55 87 d1  |.....B.@..g:.U..|
-00000140  e8 f0 1c 07 01 ea 99 b8  fb 42 b6 cb 66 2c b6 6a  |.........B..f,.j|
-00000150  72 d1 43 f2 7b df 08 06  75 fc af 0c be 52 44 eb  |r.C.{...u....RD.|
-00000160  a7 06 7a 90 56 0d 4a f9  75 59 9f 86 c8 d2 52 98  |..z.V.J.uY....R.|
-00000170  72 17 4e 42 d8 dc c8 23  bc 65 e4 10 bf d0 44 9e  |r.NB...#.e....D.|
-00000180  30 e1 be 23 e7 7c 7f 07  fa c8 15 95 83 c6 00 ce  |0..#.|..........|
-00000190  cf 7b ad d6 bb b3 38 75  42 42 63 b0 c0 2c 04 a1  |.{....8uBBc..,..|
-000001a0  05 db ca 84 cf e5 71 62  0a 7e 8c d0 2b 56 7a 58  |......qb.~..+VzX|
-000001b0  51 b5 00 19 63 37 8d a4  db 77 b0 97 e7 e9 3e a7  |Q...c7...w....>.|
-000001c0  0f 50 09 5c 21 d4 12 29  09 f2 f8 8b 30 da 64 c5  |.P.\!..)....0.d.|
-000001d0  a2 ec 79 45 97 7a c8 2e  56 7a fc 90 6d 06 3d fb  |..yE.z..Vz..m.=.|
-000001e0  62 87 69 a0 01 6c a2 77  94 c4 b8 c1 7a 22 4f 14  |b.i..l.w....z"O.|
-000001f0  d8 0b b7 e0 93 ae e8 d5  2c b0 f7 23 ab 91 5a d7  |........,..#..Z.|
-00000200  21 42 6b cb 33 8e 35 09  39 19 4f 7f 48 44 2d 07  |!Bk.3.5.9.O.HD-.|
-00000210  e6 33 74 45 cc 29 dc 21  da 8d 3b c3 08 4c c2 a2  |.3tE.).!..;..L..|
-00000220  dd 85 59 d1 f6 34 9a d0  f3 d0 1e 00 9e 87 6f 3d  |..Y..4........o=|
-00000230  34 0c 54 0c fe 55 7d 72  ac 43 12 a4 3e 5e 35 db  |4.T..U}r.C..>^5.|
-00000240  4b 1b 4e b0 8a 30 43 8e  84 06 fe ef 87 dd fa 83  |K.N..0C.........|
-00000250  0c 44 15 da 21 30 2c 1d  24 e0 25 74 ee fd 4a 03  |.D..!0,.$.%t..J.|
-00000260  df 8b 38 5e 57 4a 12 83  f8 cc d1 94 59 72 49 44  |..8^WJ......YrID|
-00000270  94 27 77 b2 26 d1 7a 3a  74 93 d8 a9 df d2 ad 23  |.'w.&.z:t......#|
-00000280  08 8c 1d 51 6f a5 15 fd  c9 53 ad 6c d7 e4 53 45  |...Qo....S.l..SE|
-00000290  f5 d1 5a 4d e0 e1 14 ac  f4 60 45 39 08 d9 89 4c  |..ZM.....`E9...L|
-000002a0  6f fc 08 b8 ad 63 00 0d  f8 25 67 00 ae 4d 06 04  |o....c...%g..M..|
-000002b0  63 80 f3 44 eb d8 b9 5d  30 3a 98 cd a3 b1 62 57  |c..D...]0:....bW|
-000002c0  71 ea 4c f9 b7 39 0c 4f  9f 42 fc 28 31 a4 6a e3  |q.L..9.O.B.(1.j.|
-000002d0  8e e8 86 32 fb b5 cc 0d  11 63 25 3c 64 6f 5e 3f  |...2.....c%<do^?|
-000002e0  fc db 98 1d 8a 98 c6 0b  f9 f4 97 30 07 2b e1 e1  |...........0.+..|
-000002f0  8c 59 56 d8 e6 2a 06 9b  85 f8 c0 ca 44 5b 14 af  |.YV..*......D[..|
-00000300  0f 40 72 0e 32 c1 da 66  7c b8 03 dc 7e d6 0c c7  |.@r.2..f|...~...|
-00000310  cb 63 dc 8b 14 dc 50 eb  22 b3 67 bf 81 e0 9b d3  |.c....P.".g.....|
-00000320  17 03 03 00 99 03 52 77  93 1b e0 a5 b9 15 6d d8  |......Rw......m.|
-00000330  18 6b 9f 49 0a 05 1d f2  24 26 f8 68 e6 a6 38 79  |.k.I....$&.h..8y|
-00000340  5b a0 89 66 87 b3 b4 60  35 81 28 0e 56 4a 30 80  |[..f...`5.(.VJ0.|
-00000350  70 c6 41 52 98 73 77 e4  17 d6 e3 d5 4f 71 30 af  |p.AR.sw.....Oq0.|
-00000360  d3 c0 8f 17 44 42 97 bb  e2 c8 4d cf 6b 6e e5 f1  |....DB....M.kn..|
-00000370  20 2d 9c ea d4 9e f4 29  cd 9a 60 cf b9 c3 af 83  | -.....)..`.....|
-00000380  fa 76 49 e7 e2 3d de 63  7c d1 7d c2 2b c0 f3 ee  |.vI..=.c|.}.+...|
-00000390  1a 69 55 1e 5d 20 52 41  a1 97 6d c8 e3 84 33 14  |.iU.] RA..m...3.|
-000003a0  88 5b 34 c3 52 58 6f ea  59 05 c8 da 25 4c ee 21  |.[4.RXo.Y...%L.!|
-000003b0  19 aa 95 34 9f 4a b8 ac  9a 51 23 ea a5 c1 17 03  |...4.J...Q#.....|
-000003c0  03 00 35 8c 05 73 4b 83  21 3b e2 30 c1 25 e0 d1  |..5..sK.!;.0.%..|
-000003d0  17 66 68 eb dc d6 ee 35  13 98 cd 1b d5 c9 d7 76  |.fh....5.......v|
-000003e0  b8 df 2a 03 42 73 d9 80  a6 d7 fb 69 1d e1 38 31  |..*.Bs.....i..81|
-000003f0  81 b0 3a d0 8d 8d 54 d0  17 03 03 00 83 33 43 7a  |..:...T......3Cz|
-00000400  da d7 a8 06 83 0a 2f 5a  5f 6f f5 8c b3 af 8d db  |....../Z_o......|
-00000410  8a 28 5e f7 77 4a 3e f0  ba 2b 51 ee e5 18 96 dc  |.(^.wJ>..+Q.....|
-00000420  8e dd f0 4e 10 2d 84 1b  ea f2 33 2a 92 78 ea f9  |...N.-....3*.x..|
-00000430  33 7f 7c 0b fe 39 82 b3  6f 17 fb bb 89 48 a8 df  |3.|..9..o....H..|
-00000440  97 bd ae 53 83 5c 06 c2  25 df ea e5 4a b1 0a 96  |...S.\..%...J...|
-00000450  27 44 dc d9 35 ca b5 cd  bb f7 25 ab 39 3a bb 6b  |'D..5.....%.9:.k|
-00000460  f0 e8 3f 0a 76 00 70 3b  3b 7c 8b 7b 5c 64 d0 05  |..?.v.p;;|.{\d..|
-00000470  8e 2d 72 44 6a fb a6 94  f1 84 cb 92 09 36 3c b9  |.-rDj........6<.|
+00000080  03 03 00 01 01 17 03 03  00 24 96 a8 32 97 d6 95  |.........$..2...|
+00000090  53 a0 9b ec d5 c5 64 dd  54 cf 75 2e aa 0b db fe  |S.....d.T.u.....|
+000000a0  5b 82 d7 b5 db 2e e5 11  ff 47 2b 46 1e 9f 17 03  |[........G+F....|
+000000b0  03 02 6d b8 78 41 17 7b  87 6a c4 5d 03 d8 27 f8  |..m.xA.{.j.]..'.|
+000000c0  d7 d8 57 5c 18 dc b1 a8  90 05 d4 29 af 6e 20 4b  |..W\.......).n K|
+000000d0  9e fd 8c 93 78 b9 3e d0  28 e5 78 46 ef 0d fc 17  |....x.>.(.xF....|
+000000e0  bd b3 82 e3 1c 76 ea 21  60 88 e7 6f 6a 34 54 02  |.....v.!`..oj4T.|
+000000f0  6e c0 85 06 e3 6d cb 85  59 4b 95 55 14 dc 2c e4  |n....m..YK.U..,.|
+00000100  90 55 7b 98 81 ea 62 a1  22 a2 3f 3e 0d c4 f4 7c  |.U{...b.".?>...||
+00000110  3e 04 38 c1 6b 46 a1 26  12 2f 51 e6 85 4d 46 eb  |>.8.kF.&./Q..MF.|
+00000120  10 34 22 d2 64 b3 f3 b6  26 3a be fa 79 22 9c 9c  |.4".d...&:..y"..|
+00000130  69 04 c8 8a 04 d5 ef ff  6a 83 a1 71 4c 7a ad 33  |i.......j..qLz.3|
+00000140  8a 92 0a cb f0 80 5d 5f  95 5a 2c 9f 6a 63 86 5d  |......]_.Z,.jc.]|
+00000150  9a 9b 30 e2 61 9b c5 c8  35 60 10 c6 b4 fe 9e 34  |..0.a...5`.....4|
+00000160  03 49 e2 bd 95 f7 a5 6f  15 38 4a f4 f0 e6 d1 23  |.I.....o.8J....#|
+00000170  47 44 64 ca 4d f6 b6 ba  9c 75 ab 08 9d f0 3b 70  |GDd.M....u....;p|
+00000180  f9 f3 70 ba 68 f1 7c 8a  fa f8 6c 4b 7f b5 13 07  |..p.h.|...lK....|
+00000190  04 ed 51 63 da a9 38 b1  32 58 6b fa 15 ee c4 3c  |..Qc..8.2Xk....<|
+000001a0  15 a5 7c f3 fd 04 7d 1f  dc 46 70 a0 f7 b0 01 4c  |..|...}..Fp....L|
+000001b0  59 2d d9 31 c3 02 16 bd  a0 fd e0 c9 83 65 14 d9  |Y-.1.........e..|
+000001c0  7d 2a e7 5d 14 b8 1c 8f  44 18 66 6f dd 84 91 cf  |}*.]....D.fo....|
+000001d0  65 f7 59 b2 49 8e 78 6c  d8 da fa 23 53 ea 7b 03  |e.Y.I.xl...#S.{.|
+000001e0  0e b5 94 bc d9 99 f5 d5  3d 06 21 d7 2b ad bf 4b  |........=.!.+..K|
+000001f0  d2 2d 78 c6 31 0d 41 52  e4 38 71 ec 38 13 84 c7  |.-x.1.AR.8q.8...|
+00000200  ab d6 7e 78 af ac d7 93  6b 98 9e 16 a3 de c6 6e  |..~x....k......n|
+00000210  5a 2c eb 13 69 bd 3d d1  0a bc a8 21 38 ab 84 cc  |Z,..i.=....!8...|
+00000220  cb 8e 12 d2 39 a1 73 a3  da 26 60 43 06 e0 1c 1f  |....9.s..&`C....|
+00000230  8f dd ef b9 9c 8c f2 f5  96 28 cf 70 fb dd 0c 82  |.........(.p....|
+00000240  4b 23 9a a9 c8 22 54 6d  6a 59 18 50 01 81 28 0c  |K#..."TmjY.P..(.|
+00000250  a1 c3 32 73 48 dd d4 45  d0 47 fd 01 aa 56 d4 75  |..2sH..E.G...V.u|
+00000260  ea 64 c6 23 21 bf 49 f1  fa 09 0a d2 91 2e 13 bc  |.d.#!.I.........|
+00000270  7a 0f 73 29 42 51 e3 c2  d1 dd 62 13 3e 56 3b bd  |z.s)BQ....b.>V;.|
+00000280  89 53 55 89 a5 3a 77 b9  49 f1 c1 d6 da 5e a1 1d  |.SU..:w.I....^..|
+00000290  de a8 13 7c a2 33 ea ff  ec 62 a6 ee 55 04 a5 47  |...|.3...b..U..G|
+000002a0  a4 1c 7d 90 91 62 f5 92  d3 fd e3 35 b3 51 44 a6  |..}..b.....5.QD.|
+000002b0  98 27 3d a8 b7 a8 ba 23  7d bb b7 b5 53 92 99 75  |.'=....#}...S..u|
+000002c0  df 0d 94 d7 8f ec 55 ff  74 d2 8b 41 24 7f 6b 12  |......U.t..A$.k.|
+000002d0  f7 02 be e9 e8 0f 41 48  d7 53 c9 ba 4b ef 86 3c  |......AH.S..K..<|
+000002e0  24 49 6b 41 dd f5 2e 7c  b2 5c ea 95 ff 7b 58 ee  |$IkA...|.\...{X.|
+000002f0  22 dd d7 27 76 a6 f2 ec  6c 50 fd 4c 23 17 ec cf  |"..'v...lP.L#...|
+00000300  ec 46 0d 56 d5 98 31 89  20 18 c6 b5 47 e9 09 94  |.F.V..1. ...G...|
+00000310  51 56 6e c0 90 e7 c5 76  fc 12 1d 00 49 10 57 54  |QVn....v....I.WT|
+00000320  17 03 03 00 99 b0 75 9f  fd de d0 3c 94 0c c8 63  |......u....<...c|
+00000330  88 59 e0 42 bd ee dd 2d  83 a4 10 2d 10 22 47 b3  |.Y.B...-...-."G.|
+00000340  19 a9 86 05 e1 c1 d1 2e  73 52 d3 d6 6d b2 e7 2a  |........sR..m..*|
+00000350  6d 36 0b 28 50 71 e4 8d  b9 e0 f5 c0 56 51 b1 ac  |m6.(Pq......VQ..|
+00000360  51 81 cf 50 f5 e7 47 83  74 52 74 b6 b0 2d e0 3e  |Q..P..G.tRt..-.>|
+00000370  0c 64 eb 85 62 a0 58 5c  d1 6f 7e d3 17 79 78 48  |.d..b.X\.o~..yxH|
+00000380  9f 32 7d a6 b2 5f aa 6a  79 6c e4 27 7b 91 63 e4  |.2}.._.jyl.'{.c.|
+00000390  5e 53 41 9b 79 89 5e d2  ce bc 9c af 2d dc e5 e6  |^SA.y.^.....-...|
+000003a0  14 ad c5 0e 71 30 20 8d  e4 c4 7e 9e cb 85 76 0f  |....q0 ...~...v.|
+000003b0  3c 70 d0 38 f5 8e ac e1  fb 88 6c c5 92 15 17 03  |<p.8......l.....|
+000003c0  03 00 35 9a 77 ce 93 b7  d5 39 d7 01 fb 97 43 b7  |..5.w....9....C.|
+000003d0  48 e5 27 08 27 a9 ee 11  87 a8 3a d4 7c cf 28 ec  |H.'.'.....:.|.(.|
+000003e0  22 b9 e1 ee a1 59 1f fd  ee 6c 57 7d fc f4 08 e4  |"....Y...lW}....|
+000003f0  de 25 a4 20 6d 7b 3b e6  17 03 03 00 83 35 68 c3  |.%. m{;......5h.|
+00000400  c1 0d 3f 6a 39 a7 e5 61  fa 7c a7 8f 9c bb 9a 5b  |..?j9..a.|.....[|
+00000410  19 fc b9 15 d9 9a 29 4b  11 c9 5d d6 7d 04 31 45  |......)K..].}.1E|
+00000420  a2 80 45 e3 f9 ba 2f cf  c4 a2 9b 7c ea fa 15 29  |..E.../....|...)|
+00000430  9d 09 c3 5a 44 d3 7b 66  0e 16 48 b3 4f 77 53 8c  |...ZD.{f..H.OwS.|
+00000440  ff 42 bf 58 7a 8f f0 31  60 23 80 fc f0 68 77 df  |.B.Xz..1`#...hw.|
+00000450  26 2c 84 12 76 20 95 e4  51 9e e8 35 91 6f d7 5a  |&,..v ..Q..5.o.Z|
+00000460  ed 6c 33 2e e0 48 24 07  9c 1a 67 61 f4 8f 88 c8  |.l3..H$...ga....|
+00000470  f7 7a 20 85 94 97 1f e2  3e 4c f1 b8 97 51 38 e9  |.z .....>L...Q8.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 4f c3 42 a6 ed  |..........5O.B..|
-00000010  a5 94 cc bf 21 cb b8 98  70 91 6c 17 e2 b6 24 8c  |....!...p.l...$.|
-00000020  2c ee 72 11 bf f2 a5 1d  15 ff 52 b0 fc ef cc 8c  |,.r.......R.....|
-00000030  a8 78 56 5b c6 99 65 4a  60 73 ee 67 6c d0 42 cb  |.xV[..eJ`s.gl.B.|
+00000000  14 03 03 00 01 01 17 03  03 00 35 26 90 43 77 65  |..........5&.Cwe|
+00000010  9e 91 9d 61 55 43 f1 de  b9 de 77 11 f4 ad de 9c  |...aUC....w.....|
+00000020  b3 7c ab 68 cc c7 20 48  de 88 7e 3a d8 a6 a5 d6  |.|.h.. H..~:....|
+00000030  6c 16 b1 0a f4 2e c6 47  d9 3b 2a 08 60 36 f1 cd  |l......G.;*.`6..|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 13 95 21  0a 6a 43 fa 41 8b 03 84  |.......!.jC.A...|
-00000010  1c 6f b9 98 75 9a 56 da  10 d8 b5 83 d5 fa 3a 37  |.o..u.V.......:7|
-00000020  9e 16 f3 17 03 03 00 13  74 13 dc 93 05 bd e9 59  |........t......Y|
-00000030  59 58 ef 3d 7a 42 d5 ce  bf d8 70                 |YX.=zB....p|
+00000000  17 03 03 00 1e b5 6f 5c  d0 50 cc 28 59 aa 47 a4  |......o\.P.(Y.G.|
+00000010  f9 ab a6 32 7f 88 1e 37  38 b1 61 25 32 dd 44 d2  |...2...78.a%2.D.|
+00000020  66 84 62 17 03 03 00 13  86 8c c0 f1 83 97 33 af  |f.b...........3.|
+00000030  3a cc 35 d5 36 81 74 42  d8 3c 07                 |:.5.6.tB.<.|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ALPN-Fallback b/src/crypto/tls/testdata/Server-TLSv13-ALPN-Fallback
index b1f6700f05..59342b5ddf 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ALPN-Fallback
+++ b/src/crypto/tls/testdata/Server-TLSv13-ALPN-Fallback
@@ -1,9 +1,9 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 eb 01 00 00  e7 03 03 52 08 3d 66 50  |...........R.=fP|
-00000010  fa 43 da db 68 27 5c c5  1f 44 b7 87 b7 11 c9 08  |.C..h'\..D......|
-00000020  c0 50 dc 3c 91 98 2a c5  40 82 ce 20 d4 33 48 07  |.P.<..*.@.. .3H.|
-00000030  97 53 8d 92 22 f7 a6 b7  84 f2 7d 14 7b 1e ed 5a  |.S..".....}.{..Z|
-00000040  99 ef bd da 97 ea 22 f7  90 36 e9 52 00 04 13 03  |......"..6.R....|
+00000000  16 03 01 00 eb 01 00 00  e7 03 03 33 73 de 26 09  |...........3s.&.|
+00000010  eb c7 22 84 79 f8 cb af  7d 87 d8 e7 a2 51 6a 49  |..".y...}....QjI|
+00000020  ed 3d 76 44 43 f1 be 2b  10 3c 92 20 4e b1 b8 bf  |.=vDC..+.<. N...|
+00000030  24 c1 34 3d 2b de ec ed  16 ae 79 85 72 e5 e6 68  |$.4=+.....y.r..h|
+00000040  58 c3 2a d2 6a fe 63 85  37 c8 16 30 00 04 13 03  |X.*.j.c.7..0....|
 00000050  00 ff 01 00 00 9a 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 10 00 19 00 17  06 70 72 6f 74 6f 33 08  |.........proto3.|
@@ -12,88 +12,88 @@
 000000a0  03 06 03 08 07 08 08 08  09 08 0a 08 0b 08 04 08  |................|
 000000b0  05 08 06 04 01 05 01 06  01 00 2b 00 03 02 03 04  |..........+.....|
 000000c0  00 2d 00 02 01 01 00 33  00 26 00 24 00 1d 00 20  |.-.....3.&.$... |
-000000d0  71 f3 09 28 42 16 ab 8a  b3 05 71 74 de d7 cf f4  |q..(B.....qt....|
-000000e0  f1 c0 59 9e e3 cd 8b 5f  9c 31 04 fd 42 24 af 3f  |..Y...._.1..B$.?|
+000000d0  fd 27 7c 13 55 0a 42 36  49 65 96 40 24 5f f7 b4  |.'|.U.B6Ie.@$_..|
+000000e0  38 df 39 9c c7 41 29 8f  7f 3c a7 f8 cb 0e e4 6c  |8.9..A)..<.....l|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 d4 33 48 07  |........... .3H.|
-00000030  97 53 8d 92 22 f7 a6 b7  84 f2 7d 14 7b 1e ed 5a  |.S..".....}.{..Z|
-00000040  99 ef bd da 97 ea 22 f7  90 36 e9 52 13 03 00 00  |......"..6.R....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 4e b1 b8 bf  |........... N...|
+00000030  24 c1 34 3d 2b de ec ed  16 ae 79 85 72 e5 e6 68  |$.4=+.....y.r..h|
+00000040  58 c3 2a d2 6a fe 63 85  37 c8 16 30 13 03 00 00  |X.*.j.c.7..0....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 56 5c 7e c2 5b 89  |..........V\~.[.|
-00000090  51 54 8a 66 a4 47 19 5d  9e 67 0f a9 38 1b f4 8e  |QT.f.G.].g..8...|
-000000a0  ad 17 03 03 02 6d 87 f7  c5 67 68 94 33 94 ed 38  |.....m...gh.3..8|
-000000b0  1e 1b fc cf 7d fb 4b 62  ac 89 8d 49 67 79 6c 22  |....}.Kb...Igyl"|
-000000c0  7e 65 27 1f e7 9f 08 e2  37 9e 6e e5 7f 51 5c 19  |~e'.....7.n..Q\.|
-000000d0  76 14 ea 40 8f f7 eb cf  03 25 e0 84 7d 43 ea 24  |v..@.....%..}C.$|
-000000e0  b2 44 89 a9 ba 6d 29 8c  68 5f a5 33 f5 bf 95 39  |.D...m).h_.3...9|
-000000f0  d2 d2 01 48 75 5b 11 25  8d dd f9 89 21 10 5a d7  |...Hu[.%....!.Z.|
-00000100  e4 c9 1e c5 ed d7 0f b4  50 b2 6b 86 72 e9 d7 7e  |........P.k.r..~|
-00000110  8e 77 59 a2 cb 89 ce 93  95 ec e3 e6 aa ea bd a7  |.wY.............|
-00000120  81 14 46 ed 6f 5a f7 20  c3 63 8e 7b 42 28 32 f7  |..F.oZ. .c.{B(2.|
-00000130  51 b1 43 e2 02 a7 3a 13  77 a7 66 d8 e8 dc 29 2d  |Q.C...:.w.f...)-|
-00000140  8f ac ba 39 ea 0a 00 2e  6e ff a2 ed 2b ff fe 93  |...9....n...+...|
-00000150  c5 3a 27 10 cf 95 1f 0b  0f 46 e5 e9 21 16 b9 85  |.:'......F..!...|
-00000160  ad cf 08 0a f1 65 ce 5b  78 45 28 03 fc b7 d5 c4  |.....e.[xE(.....|
-00000170  e4 f0 b6 9b f6 30 cf 8c  48 17 c3 42 bf bf 76 c6  |.....0..H..B..v.|
-00000180  e9 dc 5e 49 93 d1 81 05  13 0d 04 22 87 5e 7b 03  |..^I.......".^{.|
-00000190  82 96 b0 2c 59 f6 67 18  ef a5 0f 9b 8c d1 8a 34  |...,Y.g........4|
-000001a0  a7 ec 8a 4b 1d 19 a4 79  c3 ac e9 5f 45 3c f5 50  |...K...y..._E<.P|
-000001b0  a0 9a f4 82 82 02 d2 98  33 3f a6 93 8a e9 2f d7  |........3?..../.|
-000001c0  ab c8 9b 69 77 a1 87 e8  5a 01 49 e1 4f bd 40 24  |...iw...Z.I.O.@$|
-000001d0  f8 f7 a1 b3 11 97 82 ee  59 76 48 fd a7 28 61 8f  |........YvH..(a.|
-000001e0  3e cc b1 40 a2 cb 8c 85  70 74 e0 be 17 60 1a f9  |>..@....pt...`..|
-000001f0  e2 3c 0c f8 94 05 81 ab  07 6a c4 72 60 0c 48 3f  |.<.......j.r`.H?|
-00000200  3f ea aa 62 e8 47 c0 19  d3 ed 91 b8 de 6d 29 58  |?..b.G.......m)X|
-00000210  f3 e9 6a 9b a5 b0 20 30  f3 63 b4 38 ea 29 5f 06  |..j... 0.c.8.)_.|
-00000220  5b f2 ac d8 df d0 49 da  73 60 22 5e 8e 1c bd e6  |[.....I.s`"^....|
-00000230  93 cd c8 a6 5a 66 3a 67  3a 11 ad bb 4d 95 91 b3  |....Zf:g:...M...|
-00000240  fe a0 c5 a2 70 ee 8f 85  36 bd a3 54 e2 a5 93 ac  |....p...6..T....|
-00000250  a7 83 7f 8b d3 53 72 78  da cb b0 57 5a 0f bd fb  |.....Srx...WZ...|
-00000260  c3 35 82 7c 4a a8 33 99  95 c3 6b 8c fc 01 42 da  |.5.|J.3...k...B.|
-00000270  ec 04 32 3b 25 45 8a 8a  48 0d 0a 9e 91 86 19 26  |..2;%E..H......&|
-00000280  ea 13 89 28 6c 06 67 71  e1 47 43 62 cd 48 94 0c  |...(l.gq.GCb.H..|
-00000290  12 ef 2d 78 b0 3c e6 cc  d3 18 d4 c5 64 6a a4 06  |..-x.<......dj..|
-000002a0  a2 63 60 d0 08 94 8c 2e  f9 f4 5a ef f8 2a b2 82  |.c`.......Z..*..|
-000002b0  5a 45 20 42 94 bc 62 b0  fa a1 b6 58 84 52 c4 36  |ZE B..b....X.R.6|
-000002c0  a5 4b b1 30 d8 c2 d9 1f  65 a0 fb 7d 8b 0a 7b c4  |.K.0....e..}..{.|
-000002d0  4f d7 74 2d 7e 32 48 6f  76 02 7d 6d fc f7 7e 83  |O.t-~2Hov.}m..~.|
-000002e0  83 da e9 26 30 24 1a c4  bd a8 7e 28 c6 55 98 c1  |...&0$....~(.U..|
-000002f0  5b da 9c 44 d4 5b 47 4f  d9 31 a4 0b 42 b0 d9 aa  |[..D.[GO.1..B...|
-00000300  cb 27 3d 8e 9a f2 94 af  ac 1c 3d 4d 1e 67 7b e3  |.'=.......=M.g{.|
-00000310  bd 05 d9 17 03 03 00 99  a3 72 0d 1b 6c 47 36 62  |.........r..lG6b|
-00000320  31 73 57 dc fc 11 7d 64  1d fc f0 6f 6f 46 93 03  |1sW...}d...ooF..|
-00000330  fd 12 e5 c6 c3 60 92 5b  90 ae 27 53 9a 56 98 20  |.....`.[..'S.V. |
-00000340  ae 55 46 5f be 29 9a 94  c3 ca 43 11 60 60 97 89  |.UF_.)....C.``..|
-00000350  22 17 39 a2 2e f6 e3 f9  0a 03 66 36 90 4d 6b d5  |".9.......f6.Mk.|
-00000360  4b b7 69 32 65 17 4b 64  79 54 3a f4 bb 66 f7 44  |K.i2e.KdyT:..f.D|
-00000370  8c 8b 7f 4f 51 bb f4 b1  67 22 ee 45 49 79 26 96  |...OQ...g".EIy&.|
-00000380  72 99 bf 56 67 d4 f5 60  b5 01 5a f2 4d 6e b2 b6  |r..Vg..`..Z.Mn..|
-00000390  c3 22 ef a7 2f 94 f1 70  5f 62 da ca c9 50 eb 61  |."../..p_b...P.a|
-000003a0  04 97 bf 3f 02 fd 3c 26  98 e7 ad cf a1 e6 40 ff  |...?..<&......@.|
-000003b0  f8 17 03 03 00 35 21 ba  75 71 13 01 d7 65 6f 2a  |.....5!.uq...eo*|
-000003c0  bb 11 15 d0 8b fe 47 4c  a4 c5 b7 93 8d a7 81 9e  |......GL........|
-000003d0  69 df c5 a7 cc 28 6d c6  2b 69 9c 73 86 9e ab 18  |i....(m.+i.s....|
-000003e0  14 2d 62 f4 03 c2 24 df  50 b6 62 17 03 03 00 83  |.-b...$.P.b.....|
-000003f0  3f 50 11 08 fa 9d 03 db  9f ce f7 82 72 9e ec b1  |?P..........r...|
-00000400  02 d7 b9 6c a4 fe 64 9d  28 e0 30 8c 5d 18 48 c7  |...l..d.(.0.].H.|
-00000410  fc 67 18 80 73 06 05 f5  2c 0a 2c b3 28 48 2d 39  |.g..s...,.,.(H-9|
-00000420  48 9d 4e 0a 34 95 ee 15  b9 51 cf 64 00 cc b9 98  |H.N.4....Q.d....|
-00000430  18 83 37 39 f5 e9 eb 0e  1a 68 7c b8 4d f3 07 1b  |..79.....h|.M...|
-00000440  02 bf cc 73 a9 d5 17 72  f4 6e 65 15 0b c7 65 fa  |...s...r.ne...e.|
-00000450  50 5a 5e 40 56 a3 8e 28  bd 0f 95 e4 5c 8b 8a 53  |PZ^@V..(....\..S|
-00000460  25 a2 c4 71 96 c0 f6 19  f6 2e 3b 29 f5 76 d7 1c  |%..q......;).v..|
-00000470  54 c3 79                                          |T.y|
+00000080  03 03 00 01 01 17 03 03  00 17 fc 70 ae e9 5a 7c  |...........p..Z||
+00000090  7a 22 50 f0 e6 a2 41 0b  17 ea 4f 6b 3a 2d e0 8b  |z"P...A...Ok:-..|
+000000a0  e6 17 03 03 02 6d 1a 11  40 1f 66 5a ef 31 11 c7  |.....m..@.fZ.1..|
+000000b0  ef 64 b8 e2 d5 a0 f7 4e  f6 3d 50 8c 02 c3 e0 2c  |.d.....N.=P....,|
+000000c0  c4 c0 b0 7c b9 74 b3 53  fc fc 64 89 63 46 7f fd  |...|.t.S..d.cF..|
+000000d0  d3 61 b8 16 4b f1 5a b6  35 d8 1c 01 a0 0c 61 04  |.a..K.Z.5.....a.|
+000000e0  ac 47 d9 93 d7 4f 84 23  51 1e 69 7d 6c ad 70 67  |.G...O.#Q.i}l.pg|
+000000f0  6e a0 67 9e 31 7f 4a 4e  c8 ba 27 75 f0 e8 0b 5d  |n.g.1.JN..'u...]|
+00000100  bd 3b 94 9c e0 08 11 b4  de c4 ad c8 fa 63 c1 95  |.;...........c..|
+00000110  f4 85 dd e0 bf 85 f7 5e  99 ce 67 bb 0f f5 24 95  |.......^..g...$.|
+00000120  22 ea ac e8 c8 d8 52 e3  aa d1 a3 c0 80 eb df b5  |".....R.........|
+00000130  32 7d 68 39 0c 62 ac 37  0c 2d b5 3c e6 fd d4 33  |2}h9.b.7.-.<...3|
+00000140  a3 58 d6 61 a7 9a bb cf  fc 31 6a 93 7d 8b 6b 97  |.X.a.....1j.}.k.|
+00000150  95 e3 9b 3c 9b c9 f5 4c  85 f9 af e0 54 c2 78 cc  |...<...L....T.x.|
+00000160  c3 45 19 d8 dc 89 f9 c4  cb cf cc 88 8a ac 7a 1f  |.E............z.|
+00000170  09 1d e4 bb 47 28 e3 0b  d0 fd 78 7b 16 a7 92 38  |....G(....x{...8|
+00000180  d0 b6 f9 72 4b a4 82 b0  c7 95 2f 8f be ec 52 d1  |...rK...../...R.|
+00000190  9f be f6 54 6c d2 18 81  56 16 87 82 57 29 2b 50  |...Tl...V...W)+P|
+000001a0  48 49 a3 da 7a 26 8a 2b  2d dd 53 ad 49 85 e0 87  |HI..z&.+-.S.I...|
+000001b0  80 00 a9 74 db 3f e9 70  20 72 3f 6b 7c 59 6b f0  |...t.?.p r?k|Yk.|
+000001c0  f1 49 75 b4 9b d1 09 0a  9a d8 b9 2a cb 72 b9 34  |.Iu........*.r.4|
+000001d0  0e 60 ab 70 85 39 ae a4  fd fd 4c 24 95 5c 34 bf  |.`.p.9....L$.\4.|
+000001e0  40 44 a9 5b 71 51 2a 8a  18 a4 17 cc 36 6f 41 38  |@D.[qQ*.....6oA8|
+000001f0  71 af 47 0e 7b 07 b0 b6  74 73 b2 f4 f4 a2 52 68  |q.G.{...ts....Rh|
+00000200  f0 d3 e6 f1 98 f3 7b 07  94 ce 19 00 da e8 45 45  |......{.......EE|
+00000210  9e aa 95 cf b4 96 29 fa  15 08 2a 8d 84 46 85 11  |......)...*..F..|
+00000220  67 9d a7 0c 7b cf 8d 63  fb d7 a0 1c ec ef a8 49  |g...{..c.......I|
+00000230  9e 39 db f4 6c 7b dc 7d  da 5f 0f 75 60 4c 4e a2  |.9..l{.}._.u`LN.|
+00000240  8c 87 75 a7 d8 67 e3 29  fd 52 c7 c6 56 61 51 ca  |..u..g.).R..VaQ.|
+00000250  30 23 2b c2 30 58 14 2f  c8 2d dd 50 06 1b aa b3  |0#+.0X./.-.P....|
+00000260  de 3e d1 a8 08 00 26 07  5c c4 73 61 c3 01 99 1c  |.>....&.\.sa....|
+00000270  33 ba 7a dc c6 8c ad 23  c8 af 04 88 0c 51 f1 ea  |3.z....#.....Q..|
+00000280  8c 23 ad ae 5e 43 92 21  fb 80 85 c2 54 19 de 21  |.#..^C.!....T..!|
+00000290  d4 28 fa 7b 9a c3 14 05  ae 72 1b 77 27 d4 59 b4  |.(.{.....r.w'.Y.|
+000002a0  6f 66 ef 25 6c c2 b2 3a  f1 0c 91 b4 46 b3 02 df  |of.%l..:....F...|
+000002b0  3a a4 5a da 69 7d fe 67  c6 d2 d1 1c d6 3b 63 6b  |:.Z.i}.g.....;ck|
+000002c0  8d 0f 2d 37 60 6b 39 97  2c 5a 34 3c 0b 97 ca 5b  |..-7`k9.,Z4<...[|
+000002d0  15 75 37 5f 85 04 a3 75  b5 c6 e9 c2 d1 4f de 82  |.u7_...u.....O..|
+000002e0  b7 5c f9 0f 00 72 cb 5c  14 2b 4a e2 44 f7 fc 85  |.\...r.\.+J.D...|
+000002f0  a9 3e 7d a0 34 9c 3e c9  16 9f 30 7b b8 d1 82 25  |.>}.4.>...0{...%|
+00000300  41 26 02 fd ec 82 2e 2c  bd 81 32 c0 b9 6f 07 78  |A&.....,..2..o.x|
+00000310  89 1c 10 17 03 03 00 99  cc 5b 0e 6f c6 7e 16 9d  |.........[.o.~..|
+00000320  e2 f7 48 88 95 84 4b 8a  fa fc a3 a7 1d 85 56 88  |..H...K.......V.|
+00000330  ec 6e 90 36 3c 2c f0 82  72 37 f9 f6 7d fc 78 9d  |.n.6<,..r7..}.x.|
+00000340  0e cf 1c ed 60 24 b5 85  b4 5c da b1 5d f8 06 ed  |....`$...\..]...|
+00000350  46 d5 4e c7 1f 1c 95 7e  5f 96 6d 04 26 be fa 6e  |F.N....~_.m.&..n|
+00000360  24 d3 46 35 35 67 c0 09  ca 27 54 9a 2a 29 d4 4f  |$.F55g...'T.*).O|
+00000370  12 62 38 9d 81 b3 ca 09  df b3 8c d3 cd 9d 84 2a  |.b8............*|
+00000380  a7 82 2c e5 92 91 38 ef  b5 42 53 30 7e 3e b0 7d  |..,...8..BS0~>.}|
+00000390  d2 72 b1 96 e8 57 1b b7  5f 9a a3 65 ab a4 6e fa  |.r...W.._..e..n.|
+000003a0  2d 0f 8e 22 b1 d6 d9 f0  80 96 c2 b3 8c db d3 56  |-.."...........V|
+000003b0  ec 17 03 03 00 35 58 c4  29 2a 60 b4 ba ee 78 41  |.....5X.)*`...xA|
+000003c0  1b 20 3c f7 e2 ef 40 12  4a 86 26 dd 2a f4 ee 51  |. <...@.J.&.*..Q|
+000003d0  37 0a c1 b1 5f 38 6e 55  f9 47 b3 dd d1 f1 cb b9  |7..._8nU.G......|
+000003e0  19 65 c2 16 00 26 9b 0b  2a 10 c7 17 03 03 00 83  |.e...&..*.......|
+000003f0  74 d7 73 a7 44 5b bf 7e  ea e3 63 6f 60 ac 8a 25  |t.s.D[.~..co`..%|
+00000400  81 a9 54 87 b7 39 f7 fa  6f 6c 30 87 79 c7 05 bf  |..T..9..ol0.y...|
+00000410  bd ee 90 20 be fd 0a 9e  d4 6c fe 5f f9 2d e2 42  |... .....l._.-.B|
+00000420  d0 d2 f6 ba 38 21 6d d8  f3 65 11 74 02 1d ac aa  |....8!m..e.t....|
+00000430  d0 fc 4b cf 37 5c 49 11  f5 c8 de 36 e1 ec 5a ec  |..K.7\I....6..Z.|
+00000440  d5 36 fd 7f 6d 21 90 1b  14 c0 0d 6f 76 04 f7 14  |.6..m!.....ov...|
+00000450  d3 52 e3 3a 23 12 00 f7  06 5f e5 5a a5 60 23 ad  |.R.:#...._.Z.`#.|
+00000460  e6 f6 81 75 23 31 25 1e  43 59 68 4b 51 27 90 8f  |...u#1%.CYhKQ'..|
+00000470  a1 8c 30                                          |..0|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 fd 12 fe d9 79  |..........5....y|
-00000010  61 9e 20 82 d8 dc 16 66  c6 e1 3c 7f 6c 9b d7 14  |a. ....f..<.l...|
-00000020  40 95 89 7e 92 3c 1d 86  5b fd c7 7c d7 9e 08 a6  |@..~.<..[..|....|
-00000030  8f 93 9a 64 86 b7 1d ce  9e 91 18 2e 50 8f 49 2e  |...d........P.I.|
+00000000  14 03 03 00 01 01 17 03  03 00 35 87 93 b9 fe cd  |..........5.....|
+00000010  40 36 30 f7 fb 61 cf ca  d4 a1 78 11 4e 09 0f 4f  |@60..a....x.N..O|
+00000020  57 19 7d 2f af 1c a0 fa  f8 98 ab 6c 51 cc 9a 30  |W.}/.......lQ..0|
+00000030  58 a4 1e f5 86 4d 5d 5b  68 d4 92 41 cd 57 4d 9f  |X....M][h..A.WM.|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e e4 7e 4c  d9 38 28 df bc 49 d0 1e  |......~L.8(..I..|
-00000010  4f 11 c3 48 95 cf 95 38  e1 97 05 5c 0a 41 f5 e3  |O..H...8...\.A..|
-00000020  4a ea 82 17 03 03 00 13  3d 8e 98 39 2b 31 61 6f  |J.......=..9+1ao|
-00000030  40 ef 2e b0 1c 99 17 d5  a3 81 98                 |@..........|
+00000000  17 03 03 00 1e 33 46 db  50 d2 22 b5 a4 70 87 02  |.....3F.P."..p..|
+00000010  4a 1d f8 f1 2d 5e df e8  bc 4c 75 1d a7 10 00 1c  |J...-^...Lu.....|
+00000020  db d1 29 17 03 03 00 13  c2 de 87 fc b6 bf 43 50  |..)...........CP|
+00000030  c8 06 9c 17 10 8b c1 a1  70 6d af                 |........pm.|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ALPN-NotConfigured b/src/crypto/tls/testdata/Server-TLSv13-ALPN-NotConfigured
index a22c81461b..f26ebead18 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ALPN-NotConfigured
+++ b/src/crypto/tls/testdata/Server-TLSv13-ALPN-NotConfigured
@@ -1,9 +1,9 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 e2 01 00 00  de 03 03 20 13 cc 97 59  |........... ...Y|
-00000010  07 73 4a a6 57 2d 3d c6  72 2c 30 1a 4f 7c b0 68  |.sJ.W-=.r,0.O|.h|
-00000020  40 4c ec 03 c3 bd 58 e4  e1 30 cd 20 e3 28 32 13  |@L....X..0. .(2.|
-00000030  80 e5 af 3f b0 e4 65 4e  40 84 87 3d 14 9f 20 b7  |...?..eN@..=.. .|
-00000040  61 9c 16 ce 73 20 9b e9  24 7d c0 e7 00 04 13 03  |a...s ..$}......|
+00000000  16 03 01 00 e2 01 00 00  de 03 03 be 50 73 98 78  |............Ps.x|
+00000010  07 c6 b6 9b b2 86 a1 34  f8 c3 87 04 01 68 16 be  |.......4.....h..|
+00000020  c5 82 ca 44 fc 0e 0a 71  42 c8 72 20 f9 5e 16 8c  |...D...qB.r .^..|
+00000030  b4 dd 40 76 bf 36 fe 90  76 f2 dd 1e 10 6c 59 36  |..@v.6..v....lY6|
+00000040  46 cc bc 11 97 58 da 98  2e 2d 5b a8 00 04 13 03  |F....X...-[.....|
 00000050  00 ff 01 00 00 91 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 10 00 10 00 0e  06 70 72 6f 74 6f 32 06  |.........proto2.|
@@ -11,89 +11,89 @@
 00000090  00 1e 00 1c 04 03 05 03  06 03 08 07 08 08 08 09  |................|
 000000a0  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
 000000b0  00 2b 00 03 02 03 04 00  2d 00 02 01 01 00 33 00  |.+......-.....3.|
-000000c0  26 00 24 00 1d 00 20 e2  aa 00 7b 5e df 4a 25 94  |&.$... ...{^.J%.|
-000000d0  c3 0b 48 f8 23 d8 5c e8  8b 55 e8 38 bc 58 69 6c  |..H.#.\..U.8.Xil|
-000000e0  a2 a8 22 98 56 46 72                              |..".VFr|
+000000c0  26 00 24 00 1d 00 20 ab  59 46 e0 bb e3 96 e8 2a  |&.$... .YF.....*|
+000000d0  af e1 02 8f 43 27 94 d2  56 52 f7 53 2a d4 37 57  |....C'..VR.S*.7W|
+000000e0  ce 0b b4 29 b6 72 54                              |...).rT|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 e3 28 32 13  |........... .(2.|
-00000030  80 e5 af 3f b0 e4 65 4e  40 84 87 3d 14 9f 20 b7  |...?..eN@..=.. .|
-00000040  61 9c 16 ce 73 20 9b e9  24 7d c0 e7 13 03 00 00  |a...s ..$}......|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 f9 5e 16 8c  |........... .^..|
+00000030  b4 dd 40 76 bf 36 fe 90  76 f2 dd 1e 10 6c 59 36  |..@v.6..v....lY6|
+00000040  46 cc bc 11 97 58 da 98  2e 2d 5b a8 13 03 00 00  |F....X...-[.....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 b3 a3 d2 fd 59 6b  |..............Yk|
-00000090  66 85 a1 5e 31 53 90 46  f2 67 5b 8a 4d 71 e5 58  |f..^1S.F.g[.Mq.X|
-000000a0  3f 17 03 03 02 6d eb 43  2b 01 70 f2 22 23 5b 97  |?....m.C+.p."#[.|
-000000b0  41 00 2c ce 6c 24 f4 3d  21 da e6 08 48 34 15 bd  |A.,.l$.=!...H4..|
-000000c0  af e3 c8 aa 96 90 25 8c  a3 75 f6 90 04 9c 0b 55  |......%..u.....U|
-000000d0  96 dd df 13 18 05 d3 33  fe cc 0a d9 e9 97 13 1c  |.......3........|
-000000e0  f4 48 de b3 62 18 f6 e9  e1 e0 4a 96 6b 60 a8 a5  |.H..b.....J.k`..|
-000000f0  34 97 a3 52 fb 04 90 4a  91 64 e7 b8 ba b1 1e 4c  |4..R...J.d.....L|
-00000100  4f 29 fc 9e 06 24 45 be  f9 ba 6e 19 24 ca b4 79  |O)...$E...n.$..y|
-00000110  15 91 a3 63 7c 04 0e 0c  69 82 34 df 71 ef 16 be  |...c|...i.4.q...|
-00000120  8f 5d 9f fd 41 fe 14 4e  94 73 24 4e 5e bb 7a 3c  |.]..A..N.s$N^.z<|
-00000130  be 91 d4 83 f5 c5 d8 f6  d3 e0 75 d1 33 cc fa c0  |..........u.3...|
-00000140  39 47 2f 0a 1d 02 f7 7b  34 b1 d5 ff bc 3d 33 02  |9G/....{4....=3.|
-00000150  00 4b 4f f4 6e 76 b0 c9  f6 24 aa bd 12 3b 11 90  |.KO.nv...$...;..|
-00000160  3c 87 75 23 02 e1 92 67  55 e6 fc df 56 43 63 33  |<.u#...gU...VCc3|
-00000170  e8 bf be 85 9a d8 88 ff  b2 ae f4 cb 95 62 b0 9d  |.............b..|
-00000180  a0 cb 71 da a9 bf b6 62  49 49 87 38 33 0b 09 38  |..q....bII.83..8|
-00000190  f9 5c ad ce d6 60 6b e1  e2 cb 3e 4f d9 56 e1 6b  |.\...`k...>O.V.k|
-000001a0  b3 0e 91 d3 3c 65 c4 27  66 e8 b6 20 25 1a b7 5f  |....<e.'f.. %.._|
-000001b0  1d 93 bc 3d 8c f5 ba bc  7b 36 8f 4a ff 16 a3 30  |...=....{6.J...0|
-000001c0  d7 d4 87 0f b7 7d bc 35  a3 58 51 b6 f4 f4 10 c6  |.....}.5.XQ.....|
-000001d0  58 ff 4e 02 34 d8 c0 5f  3b dd d7 32 9f 62 cd 8e  |X.N.4.._;..2.b..|
-000001e0  59 fa e6 88 50 38 24 0b  1b 55 fa 58 db e4 09 25  |Y...P8$..U.X...%|
-000001f0  67 08 70 36 f2 bb f4 cd  03 c8 ff 8b 06 59 c8 df  |g.p6.........Y..|
-00000200  34 c8 5d 37 d8 5b 9b 03  2a c5 8d ec a8 9f a7 86  |4.]7.[..*.......|
-00000210  f2 f7 8e 53 42 d6 03 df  bb b4 ec 6f fd a5 42 9b  |...SB......o..B.|
-00000220  d1 06 55 c8 f1 ce 68 eb  b9 1e a9 4c ea 58 e3 4c  |..U...h....L.X.L|
-00000230  f0 a2 55 c5 7d 8f 0f 52  08 51 0b 33 5e 56 e6 ac  |..U.}..R.Q.3^V..|
-00000240  32 30 61 e5 ea ca 5f b8  ae cc 07 ba 68 16 59 a8  |20a..._.....h.Y.|
-00000250  e7 b6 01 f7 2b 19 cf 77  3e 69 b6 5d 26 6b e8 1e  |....+..w>i.]&k..|
-00000260  a0 b9 73 74 d9 55 1c 94  a4 5a 5d 23 31 5a d7 0e  |..st.U...Z]#1Z..|
-00000270  85 6d d2 ba 12 1f 6a 71  6c 80 ed d1 c4 6a 47 5c  |.m....jql....jG\|
-00000280  04 d8 b1 0b d4 98 37 0b  4c 06 34 5f e9 67 02 53  |......7.L.4_.g.S|
-00000290  04 3d 9d 19 77 b6 d6 79  5f de 2a 85 7b b6 9d ae  |.=..w..y_.*.{...|
-000002a0  fc a1 45 7f ff ea c7 16  ac cf da c3 76 39 fc d8  |..E.........v9..|
-000002b0  e6 9b 7d e3 c4 e6 cd d2  73 de 5a aa ed 6c 58 89  |..}.....s.Z..lX.|
-000002c0  3b f9 92 88 63 4a fe 42  b1 e9 41 7a 2f 6f 5f 8d  |;...cJ.B..Az/o_.|
-000002d0  46 97 f6 71 92 c0 13 b9  b5 4b 8f 12 fb f6 12 97  |F..q.....K......|
-000002e0  03 7a 88 27 8b 5f 3b 65  81 fb 10 39 fd a8 32 86  |.z.'._;e...9..2.|
-000002f0  3b 61 80 01 b6 36 b7 a1  51 f7 80 c2 a9 45 1d a4  |;a...6..Q....E..|
-00000300  ae 9e bf 53 6c 23 46 85  09 d9 4f cc 58 c7 35 65  |...Sl#F...O.X.5e|
-00000310  c4 de 5b 17 03 03 00 99  7f 63 00 98 7f 90 57 8a  |..[......c....W.|
-00000320  6a c4 71 b4 d8 1f be 7f  07 1c 23 17 1b 62 4e 0a  |j.q.......#..bN.|
-00000330  3c 7c af a0 60 84 1b 78  9e 93 05 9b d1 7d 8b aa  |<|..`..x.....}..|
-00000340  cf 84 ae dc 84 1b 06 54  57 2d 82 1d c7 08 ca 6c  |.......TW-.....l|
-00000350  5c d5 b1 9e df 06 50 b5  6a b7 f3 5f 7a ba 55 7f  |\.....P.j.._z.U.|
-00000360  ed a7 fa 71 b1 8b 76 d2  7c 66 69 4b 88 1e 1b 10  |...q..v.|fiK....|
-00000370  6d 0e 48 ee fc 61 8a ee  5f 83 5a b8 67 d8 b3 e3  |m.H..a.._.Z.g...|
-00000380  0d 26 8b b2 9b 44 26 8c  33 51 e2 b4 19 be 49 b6  |.&...D&.3Q....I.|
-00000390  8b 27 60 44 87 0c 6f 7e  10 b8 21 3f 2d 24 42 c2  |.'`D..o~..!?-$B.|
-000003a0  9b 7b 86 a6 a5 2d 8d 3b  83 ef bb dc c2 75 18 b8  |.{...-.;.....u..|
-000003b0  81 17 03 03 00 35 b2 6d  b6 54 2f 32 2f c3 24 61  |.....5.m.T/2/.$a|
-000003c0  76 d7 04 8e f3 d2 b4 0f  94 fe d4 74 ea b4 18 c0  |v..........t....|
-000003d0  06 c9 a4 d8 03 c3 df 60  fa b0 06 3b 26 bb 34 bf  |.......`...;&.4.|
-000003e0  f3 71 f0 75 81 60 20 52  eb b3 2d 17 03 03 00 83  |.q.u.` R..-.....|
-000003f0  7f db 17 a7 c6 c0 0d ff  f1 af 6e 96 16 a8 1a 0f  |..........n.....|
-00000400  82 c5 4c e1 74 e3 85 95  9d 2b 9e df 50 9d 96 d3  |..L.t....+..P...|
-00000410  c5 f0 1c e7 73 1b 11 2c  ad 16 d8 aa d0 f5 61 1c  |....s..,......a.|
-00000420  ce a8 34 e3 ee 1d c1 fc  fd f9 57 e2 0e fc 38 77  |..4.......W...8w|
-00000430  74 11 2a 48 66 aa 19 03  76 28 47 dd 30 d1 9d a5  |t.*Hf...v(G.0...|
-00000440  3f 1c de 24 1d 52 dc 57  11 c3 23 70 44 18 5f c3  |?..$.R.W..#pD._.|
-00000450  84 84 0a 5d fc 9a b9 14  41 c4 47 fc f6 ba 92 ca  |...]....A.G.....|
-00000460  91 51 50 99 d1 f4 ee 3d  be cc 5f 60 be 46 9a 0a  |.QP....=.._`.F..|
-00000470  d0 fd 7f                                          |...|
+00000080  03 03 00 01 01 17 03 03  00 17 de 5b 53 87 c3 77  |...........[S..w|
+00000090  b9 a2 1a 82 d3 e2 96 49  47 2c 7f 69 43 83 15 0e  |.......IG,.iC...|
+000000a0  e7 17 03 03 02 6d 06 56  c4 e0 10 c4 0c ee da 48  |.....m.V.......H|
+000000b0  e1 f0 b5 69 f1 a1 e1 f5  57 e6 93 b1 ef e7 e7 54  |...i....W......T|
+000000c0  64 0e 96 96 c4 30 91 53  3f 8d de b6 a6 49 08 70  |d....0.S?....I.p|
+000000d0  7f 9e b4 81 fa 9f 6a 5c  9d f1 85 59 32 25 e8 c0  |......j\...Y2%..|
+000000e0  e4 dd 6b 7a 60 3d d1 51  a6 4a 2d ec 74 fb 8a ca  |..kz`=.Q.J-.t...|
+000000f0  8e b8 03 90 94 25 3c 43  34 42 9e 5f 07 98 8d f9  |.....%<C4B._....|
+00000100  43 0c c9 c0 6a 4e 32 1b  07 36 06 11 08 93 a3 b7  |C...jN2..6......|
+00000110  50 cd 9e e6 b8 0d b0 5d  5b 12 b4 48 ff fd f5 47  |P......][..H...G|
+00000120  1c 5f 51 57 b5 8a b3 db  24 d2 49 59 c6 26 f5 d7  |._QW....$.IY.&..|
+00000130  e4 5f 3f da e1 35 73 cf  df 9f 5f be 02 63 ac 50  |._?..5s..._..c.P|
+00000140  d7 65 1e 1f f2 48 f4 c8  7d 25 a4 9d f1 35 9d bc  |.e...H..}%...5..|
+00000150  98 e5 ac 6a 06 06 f2 db  fa f8 44 b8 3c 33 05 2c  |...j......D.<3.,|
+00000160  41 ad 29 39 29 df 87 c6  47 cd ad 80 5b 4a ba 23  |A.)9)...G...[J.#|
+00000170  4b 6d 59 66 78 4d be 9a  cf 34 99 66 9a 60 0a 4b  |KmYfxM...4.f.`.K|
+00000180  cc 8e 60 15 b7 31 62 ea  30 b2 92 e8 0b 58 8d d4  |..`..1b.0....X..|
+00000190  83 16 82 95 d7 26 78 6c  d8 da 9f 5b b6 58 34 7a  |.....&xl...[.X4z|
+000001a0  36 9c dd 43 57 1e f6 24  07 8d 1e 80 40 1d 23 92  |6..CW..$....@.#.|
+000001b0  6d ad 59 1f 8a a1 cf 25  4e 9f 5e a0 0c af a7 24  |m.Y....%N.^....$|
+000001c0  45 06 87 a7 de 5e a4 97  c2 bc 36 a4 f7 3d 23 bc  |E....^....6..=#.|
+000001d0  87 a0 80 e3 f4 de d8 cb  38 3b 23 96 cf 99 52 84  |........8;#...R.|
+000001e0  20 cd 5e e1 f9 5c 28 f7  25 db fe 93 bd 9d f2 46  | .^..\(.%......F|
+000001f0  6d b9 67 66 74 c1 11 a8  96 d4 b4 58 a1 a3 4d 67  |m.gft......X..Mg|
+00000200  b9 c9 4d 8a db 73 13 b8  3a 5c 7b f6 7e 65 b8 1a  |..M..s..:\{.~e..|
+00000210  c5 05 df 4b 82 f9 8f fd  4d 90 9b 92 f6 cf cb 93  |...K....M.......|
+00000220  10 0a b2 ca 0e 55 4b b8  1c 43 83 15 22 21 cd 12  |.....UK..C.."!..|
+00000230  de 83 df ae 52 f1 eb 83  5c bb b4 ab 12 cd 16 56  |....R...\......V|
+00000240  e6 66 54 9c 48 2b 4b 63  ab 53 ff 42 f9 b2 27 36  |.fT.H+Kc.S.B..'6|
+00000250  b6 e0 1d 50 26 58 ef 2f  19 2e f3 ed 2c 4d 13 fe  |...P&X./....,M..|
+00000260  e3 80 69 e8 8f 53 39 64  9b c5 97 b6 4b a4 01 08  |..i..S9d....K...|
+00000270  c4 37 a2 bb 70 14 90 d0  45 de 37 e5 91 2b fa b8  |.7..p...E.7..+..|
+00000280  de 28 0d 78 86 07 39 3f  a3 67 18 75 b3 ea f4 59  |.(.x..9?.g.u...Y|
+00000290  bb 96 e6 80 57 a3 8c 60  05 bb 40 83 25 a0 2a 20  |....W..`..@.%.* |
+000002a0  e2 7e 05 21 5f 8a 10 91  7b 52 76 32 90 4c ff b8  |.~.!_...{Rv2.L..|
+000002b0  ab 71 4d af 8e c3 28 58  d7 9c ce 76 6b 98 79 b9  |.qM...(X...vk.y.|
+000002c0  1b 77 de ab f7 6b eb e7  33 fc e7 58 73 70 83 5b  |.w...k..3..Xsp.[|
+000002d0  38 01 fe e3 6a 03 f5 fd  12 21 4f 93 b1 4e 41 e6  |8...j....!O..NA.|
+000002e0  61 33 3a f7 11 76 aa a4  58 15 c9 e9 a6 ab a3 23  |a3:..v..X......#|
+000002f0  27 76 9e 6d 36 b8 dc 79  e5 55 d4 84 0e 4a fa 81  |'v.m6..y.U...J..|
+00000300  7b 6c 14 42 2d 17 f4 d0  bd 43 b5 fc b4 e5 f7 1f  |{l.B-....C......|
+00000310  ef e0 82 17 03 03 00 99  1a d3 a7 f6 9b 07 69 d4  |..............i.|
+00000320  07 bc 12 d1 f3 b1 7a 00  4e 14 10 2c ec 1a ab af  |......z.N..,....|
+00000330  f6 88 cb dd b2 fb d1 6c  01 64 18 44 6b 46 21 75  |.......l.d.DkF!u|
+00000340  a6 2b af 39 85 c6 fb 3c  35 4e 2a 94 f5 f7 ce 88  |.+.9...<5N*.....|
+00000350  13 75 18 c8 ea 90 29 95  46 c0 f9 18 28 3d f4 67  |.u....).F...(=.g|
+00000360  c8 6e fd 63 c0 1f 5a 90  ec 3e 62 6f ae 6c 7f 91  |.n.c..Z..>bo.l..|
+00000370  d7 0c d7 30 ba e1 ec 60  50 7f 93 5b 4c 3e 77 cf  |...0...`P..[L>w.|
+00000380  08 a5 f0 42 d7 af 13 3f  b5 2c 02 be ad 40 bf 5f  |...B...?.,...@._|
+00000390  f1 5f 94 18 b9 34 e7 8f  37 5e 5b fe 7e ba 2b 70  |._...4..7^[.~.+p|
+000003a0  e5 df 47 cb 8a 9d a9 b2  9c e1 fd 47 b6 8c ca 5b  |..G........G...[|
+000003b0  35 17 03 03 00 35 6e c3  a8 ab 9f 7e 74 f4 68 48  |5....5n....~t.hH|
+000003c0  35 f1 97 07 e9 5e 8e fd  de b6 06 9d 94 05 f2 20  |5....^......... |
+000003d0  58 57 30 18 5e 0f 64 54  ee 5e ff 02 1c a4 9f 8f  |XW0.^.dT.^......|
+000003e0  0a 6d 3c 80 5b 21 5b b7  6b 0e 9c 17 03 03 00 83  |.m<.[![.k.......|
+000003f0  cd 7f d1 4d 33 0d 84 cd  5c 68 03 fa 23 04 1a c2  |...M3...\h..#...|
+00000400  e1 70 9a 14 d1 1a f4 87  75 7f 50 7f d1 33 71 e7  |.p......u.P..3q.|
+00000410  4d 02 62 ab 3b dd 5b 4d  7b 2f 5c 16 c1 57 4b 80  |M.b.;.[M{/\..WK.|
+00000420  8a 6a 74 17 65 64 cb 11  5f 8a 51 0c 9d 06 b1 6c  |.jt.ed.._.Q....l|
+00000430  6b 8b fb 9d 32 f1 18 55  b9 88 40 ed 2a 89 da 92  |k...2..U..@.*...|
+00000440  e0 35 65 05 99 5e f2 75  d6 41 a8 39 3a a5 af c7  |.5e..^.u.A.9:...|
+00000450  94 1c 51 5d 45 a0 2a f8  3c 5f 67 9e fc 0c 8a 16  |..Q]E.*.<_g.....|
+00000460  6b fc 19 c4 70 4d f9 49  bf 4f 5c c3 45 d8 b3 0e  |k...pM.I.O\.E...|
+00000470  60 20 72                                          |` r|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 43 b3 ff 55 3e  |..........5C..U>|
-00000010  fe 5b f8 9a 2d ce b8 af  3c ce e7 c3 f8 5e 1f 21  |.[..-...<....^.!|
-00000020  02 42 4c ba 59 a6 56 1f  36 51 74 f6 e4 94 9a da  |.BL.Y.V.6Qt.....|
-00000030  3c 9b d2 57 d0 78 54 8f  25 d3 7b 28 fe f1 a7 ee  |<..W.xT.%.{(....|
+00000000  14 03 03 00 01 01 17 03  03 00 35 86 5a 21 de 39  |..........5.Z!.9|
+00000010  88 77 b7 e5 2e 95 68 58  05 44 75 3b 71 da 9f b0  |.w....hX.Du;q...|
+00000020  43 cc 69 cc 70 d0 10 f7  73 da bc b5 e0 2c 2f ee  |C.i.p...s....,/.|
+00000030  97 9f 0f 91 21 55 b3 b3  cb 32 bb db c9 f8 5d 28  |....!U...2....](|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 89 13 c3  ca 84 60 a1 17 50 6f 35  |..........`..Po5|
-00000010  fb 9f d6 4a 1a 04 a0 e6  81 a5 2e e6 89 e3 bd 14  |...J............|
-00000020  c9 f9 0c 17 03 03 00 13  9b 1a fa 82 f4 19 92 0c  |................|
-00000030  b1 cc 7b c9 ef d0 a7 9b  ab dd fd                 |..{........|
+00000000  17 03 03 00 1e 29 87 c5  7e b9 cc 63 fc a2 76 38  |.....)..~..c..v8|
+00000010  61 04 e4 fc 80 9e e8 1b  b7 4d c3 4f ce 5f ed 95  |a........M.O._..|
+00000020  39 d4 b3 17 03 03 00 13  a6 7a c3 63 77 38 88 8d  |9........z.cw8..|
+00000030  f6 11 23 74 37 d0 3d cd  66 b6 15                 |..#t7.=.f..|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-CHACHA20-SHA256 b/src/crypto/tls/testdata/Server-TLSv13-CHACHA20-SHA256
index 4895a0a0ad..66689eee92 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-CHACHA20-SHA256
+++ b/src/crypto/tls/testdata/Server-TLSv13-CHACHA20-SHA256
@@ -1,97 +1,97 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 42 21 89 90 14  |...........B!...|
-00000010  ea c9 cd 2f 38 04 0f f8  c3 22 c1 26 1f cb 5b 15  |.../8....".&..[.|
-00000020  14 5c 75 b5 c3 b9 3d ef  f2 42 e7 20 14 0d ad f9  |.\u...=..B. ....|
-00000030  f3 2a 03 68 0f 76 06 1b  2d 92 a7 53 6d 29 1f 29  |.*.h.v..-..Sm).)|
-00000040  bc 9d ec 83 82 a3 f0 8e  1f cd c9 c3 00 04 13 03  |................|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 45 60 0f 82 ab  |...........E`...|
+00000010  6c f7 51 b6 b7 f1 63 13  a4 b1 7d fd 93 d0 c9 3d  |l.Q...c...}....=|
+00000020  ec 1e 45 08 79 dd 6e 15  03 8a 02 20 18 1c 96 62  |..E.y.n.... ...b|
+00000030  0b 2a 24 59 f5 7b 27 5d  9f dd 07 28 a9 49 33 6b  |.*$Y.{']...(.I3k|
+00000040  1d b7 f0 13 63 76 47 fb  1e a7 df f5 00 04 13 03  |....cvG.........|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 35  |-.....3.&.$... 5|
-000000b0  dd 05 d6 e1 56 8f 76 31  3e ac 52 7a 74 b5 73 3e  |....V.v1>.Rzt.s>|
-000000c0  a3 42 ac 0c cb 8d 57 b9  e0 3d 98 d9 a4 41 3b     |.B....W..=...A;|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 31  |-.....3.&.$... 1|
+000000b0  d1 b5 61 de c1 69 9b 66  eb 63 d9 7a 47 01 fa 87  |..a..i.f.c.zG...|
+000000c0  aa 20 90 70 10 1e d0 a3  3b 6c de b6 28 5d 46     |. .p....;l..(]F|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 14 0d ad f9  |........... ....|
-00000030  f3 2a 03 68 0f 76 06 1b  2d 92 a7 53 6d 29 1f 29  |.*.h.v..-..Sm).)|
-00000040  bc 9d ec 83 82 a3 f0 8e  1f cd c9 c3 13 03 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 18 1c 96 62  |........... ...b|
+00000030  0b 2a 24 59 f5 7b 27 5d  9f dd 07 28 a9 49 33 6b  |.*$Y.{']...(.I3k|
+00000040  1d b7 f0 13 63 76 47 fb  1e a7 df f5 13 03 00 00  |....cvG.........|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 87 93 07 b6 34 ee  |..............4.|
-00000090  2c 95 e9 f9 62 f0 bb a2  93 8a cd 94 fa c9 ed 17  |,...b...........|
-000000a0  22 17 03 03 02 6d 59 5b  1f 40 dc ab f2 3e f9 75  |"....mY[.@...>.u|
-000000b0  58 91 40 41 6c a5 b9 b9  b4 0c c0 e3 1b ac 68 c7  |X.@Al.........h.|
-000000c0  dd 65 3f 33 b3 2b c3 25  03 76 f7 d0 bb c8 22 0f  |.e?3.+.%.v....".|
-000000d0  62 54 ef 36 60 f1 5b b2  8a 23 25 73 ad 05 49 ea  |bT.6`.[..#%s..I.|
-000000e0  dc 41 65 1b 90 4e 8f e0  9f ca 99 1c 21 d7 4b ca  |.Ae..N......!.K.|
-000000f0  6e e2 cf 34 2a 35 0d 2a  94 0d a2 df 8d 88 d5 bf  |n..4*5.*........|
-00000100  b1 7c 01 16 75 33 d0 48  14 7d 79 1e a2 19 0b b5  |.|..u3.H.}y.....|
-00000110  7e 81 71 41 e0 75 31 ca  e8 b7 ce 11 97 80 fa 4e  |~.qA.u1........N|
-00000120  00 a8 40 29 72 59 76 17  e7 a7 f2 45 9e 0e ea 27  |..@)rYv....E...'|
-00000130  5d 91 41 69 0b 90 f5 c7  69 71 51 1f 1c 52 f6 25  |].Ai....iqQ..R.%|
-00000140  da c5 81 22 77 e4 12 a8  a3 3c fc fc bf 46 dc d9  |..."w....<...F..|
-00000150  a6 e6 4c 58 c4 e8 ec 5b  91 bf c9 a6 9d e2 36 dc  |..LX...[......6.|
-00000160  99 ba d9 03 67 6d e1 23  b2 b9 ba 67 ba 4e 04 19  |....gm.#...g.N..|
-00000170  7b 6a 18 72 34 02 62 ef  e8 7f 5f b0 a3 3e 89 2d  |{j.r4.b..._..>.-|
-00000180  57 be 73 81 6f 1a 25 ae  2c e1 9b ab c9 e3 ba 3f  |W.s.o.%.,......?|
-00000190  ea 0e 21 ce 33 03 8c c2  bf dc 7b 8e a2 3a 69 19  |..!.3.....{..:i.|
-000001a0  cc c3 0b e4 85 23 21 3f  82 9d b1 c8 b3 66 2c b6  |.....#!?.....f,.|
-000001b0  2e a8 10 6c 53 00 eb ee  ae cc 58 68 e9 36 a6 9a  |...lS.....Xh.6..|
-000001c0  2f fa 2e bf dd f0 84 a0  d5 3d a2 30 63 e5 0c 40  |/........=.0c..@|
-000001d0  22 d6 0b 88 cf 3b 5c e0  02 f9 24 1a 5a 37 f2 8d  |"....;\...$.Z7..|
-000001e0  83 05 d5 22 30 f8 c5 75  89 e2 a9 51 e1 1e 9a 2b  |..."0..u...Q...+|
-000001f0  a3 c9 77 ac 38 6a a9 a4  bf 3e b3 c0 71 25 59 f9  |..w.8j...>..q%Y.|
-00000200  5a 18 bd 74 c1 b0 fd ec  b5 ba 5e b1 29 c9 57 7e  |Z..t......^.).W~|
-00000210  d0 6f 4b ed 38 5c f3 57  88 2e 06 1c 51 2b 67 5d  |.oK.8\.W....Q+g]|
-00000220  8b c2 72 90 47 84 37 58  fa 1c 95 19 2c 26 ce f8  |..r.G.7X....,&..|
-00000230  fb 30 4f 99 f4 e0 5a 32  dd 2a 38 ed c2 b2 68 25  |.0O...Z2.*8...h%|
-00000240  50 15 56 a6 09 cb 3f 5c  a1 46 35 56 27 54 3b a2  |P.V...?\.F5V'T;.|
-00000250  2e 45 87 6c 71 3a b5 c9  0a c6 b8 3e 10 72 c8 03  |.E.lq:.....>.r..|
-00000260  99 6a f3 be cf 09 88 67  5b 47 57 3d a4 1c 08 d5  |.j.....g[GW=....|
-00000270  96 d7 ab e7 fd 05 b8 36  ad b3 c8 2a 7a aa 35 3c  |.......6...*z.5<|
-00000280  95 eb 96 6d 0e 78 41 89  29 c7 32 92 d1 be c0 bf  |...m.xA.).2.....|
-00000290  ac ca ee 17 3b 2e 1f fa  b7 67 d1 9f 31 fd db 45  |....;....g..1..E|
-000002a0  59 57 62 3f a7 2d 38 19  ca 46 96 b8 4e fa fd f3  |YWb?.-8..F..N...|
-000002b0  32 66 74 78 c9 a8 bf 90  bc 1d 77 4a 12 c9 64 04  |2ftx......wJ..d.|
-000002c0  f5 c8 c9 d0 6c 3a c5 a8  22 7c a7 3e cd d4 5b 6a  |....l:.."|.>..[j|
-000002d0  bd 5e d0 7c 07 67 61 3a  e7 56 0c 54 ca 94 db ae  |.^.|.ga:.V.T....|
-000002e0  40 28 ca 85 8b 88 29 1d  69 79 84 3b 19 36 7c 66  |@(....).iy.;.6|f|
-000002f0  13 9b a9 9a 02 af 30 72  18 84 64 0f 73 d4 43 9f  |......0r..d.s.C.|
-00000300  84 69 ce 21 52 a7 64 38  9f 70 ff 7a 23 99 9c 6c  |.i.!R.d8.p.z#..l|
-00000310  08 0d 61 17 03 03 00 99  4d 61 63 02 f0 a1 e8 b6  |..a.....Mac.....|
-00000320  d4 79 53 6f 4a e1 fe cb  f1 1b 3d b8 ba d4 6e a9  |.ySoJ.....=...n.|
-00000330  b0 cd 3b bd 21 41 b5 fd  df 53 cb b3 f3 15 f6 87  |..;.!A...S......|
-00000340  b6 09 67 fc 30 b4 ba d1  40 bf 4e ac 96 a5 52 0c  |..g.0...@.N...R.|
-00000350  c5 00 44 41 2a 3b f5 ae  0a ad 2f 4d 11 75 1f 86  |..DA*;..../M.u..|
-00000360  0e c5 ac 43 f5 67 c5 6a  e3 d9 ef c4 c6 54 27 ad  |...C.g.j.....T'.|
-00000370  0d a6 30 31 13 30 ce b2  92 2e e4 ec ee 51 ec 35  |..01.0.......Q.5|
-00000380  4b 93 16 d6 b2 f4 dc 54  92 a0 e6 75 dd 1c 44 1d  |K......T...u..D.|
-00000390  9a 32 fa f7 07 ab 9f bb  ab 09 dc a0 a8 5c 71 7c  |.2...........\q||
-000003a0  ee 21 07 8f 89 6d 50 0a  17 43 52 9a ac 07 b6 cb  |.!...mP..CR.....|
-000003b0  ff 17 03 03 00 35 0c e3  af 61 9d 5a 08 cf 88 27  |.....5...a.Z...'|
-000003c0  c7 9d d4 8b 3b d9 54 17  cb 56 0a 5f 8e e5 57 c4  |....;.T..V._..W.|
-000003d0  88 33 6f d3 55 63 14 bc  f1 a6 51 99 ac 34 08 6d  |.3o.Uc....Q..4.m|
-000003e0  a5 e2 9f c9 40 70 a9 6d  b9 3a 49 17 03 03 00 83  |....@p.m.:I.....|
-000003f0  62 c7 da 9b d3 dd 9a 46  de 6a b0 be a5 af a8 67  |b......F.j.....g|
-00000400  94 ce 07 bc 11 24 49 8b  b1 ed 63 ba b5 71 39 f2  |.....$I...c..q9.|
-00000410  f5 39 f3 1f 42 2c d1 e7  a1 e3 85 7b 9f d1 b8 d4  |.9..B,.....{....|
-00000420  b7 24 48 9e 27 4c c8 83  6b 47 4c 36 70 03 13 c1  |.$H.'L..kGL6p...|
-00000430  99 93 fe 4d 79 48 e0 bb  13 b3 9a 08 e8 f0 aa 4a  |...MyH.........J|
-00000440  7a de 96 16 12 a2 b3 16  05 d1 6c b0 7d dd 37 fc  |z.........l.}.7.|
-00000450  7a 8b 8e 8f ab 8e d8 34  48 e9 22 a8 ea d4 85 1e  |z......4H.".....|
-00000460  4d 99 9e ec c6 7c 7e 68  62 2b 05 b3 4e be cd 68  |M....|~hb+..N..h|
-00000470  ef 4e 84                                          |.N.|
+00000080  03 03 00 01 01 17 03 03  00 17 1d ca d2 2a 98 61  |.............*.a|
+00000090  d5 af a9 29 79 5f d3 44  dc 51 06 36 c9 b4 2c bc  |...)y_.D.Q.6..,.|
+000000a0  2c 17 03 03 02 6d ca 76  66 f0 62 1d a2 7e 7d 99  |,....m.vf.b..~}.|
+000000b0  a9 4a a7 3c 1f a1 f5 7b  a8 fa e2 ca f6 d7 88 36  |.J.<...{.......6|
+000000c0  0e 46 8b 00 7b 7f 35 3e  49 51 74 d8 91 e9 a5 2b  |.F..{.5>IQt....+|
+000000d0  72 b0 13 82 70 68 57 b4  e2 80 e0 51 f0 7e df 2a  |r...phW....Q.~.*|
+000000e0  24 af 4e df 9c cd ca 68  4e 77 e1 ef a1 9b 6d 66  |$.N....hNw....mf|
+000000f0  10 0c ce cb d0 fc 5e 0f  32 05 fd 97 bc cc c9 eb  |......^.2.......|
+00000100  24 12 f1 77 63 7a cd a2  2c db c7 a8 5f b9 44 e8  |$..wcz..,..._.D.|
+00000110  08 29 f6 d3 56 2f a3 2e  b2 50 45 f9 d2 6c 4c df  |.)..V/...PE..lL.|
+00000120  31 48 a8 59 2c 18 7a 6c  a7 e6 6d db f5 d5 2b 18  |1H.Y,.zl..m...+.|
+00000130  0a 5f 2d 68 fb 70 ad a8  64 e8 0b 5d c9 4f c5 8a  |._-h.p..d..].O..|
+00000140  5c 10 34 10 02 21 a3 58  95 7d 48 04 37 4b b1 43  |\.4..!.X.}H.7K.C|
+00000150  35 00 1b 30 e1 3c 6a 9b  7a 16 77 4c 86 d9 3c 1d  |5..0.<j.z.wL..<.|
+00000160  95 af a6 c2 23 14 07 4c  fe a2 73 11 24 54 82 f7  |....#..L..s.$T..|
+00000170  79 1a eb 8b de 43 11 51  24 44 33 f6 c1 81 ea 62  |y....C.Q$D3....b|
+00000180  a8 1d 94 a3 ee 9b 5d 7a  8d 7b 8f 2a be 51 ea c3  |......]z.{.*.Q..|
+00000190  17 08 14 ff 96 96 68 bf  8c 16 db 29 db 9b fe a1  |......h....)....|
+000001a0  84 1b d0 21 36 fa 66 37  c0 58 e2 7d f8 6d 24 3c  |...!6.f7.X.}.m$<|
+000001b0  89 bc 19 52 43 85 7d e5  f2 d8 ee dd 03 0c c3 02  |...RC.}.........|
+000001c0  54 4e fc ff 1a 8e 14 ba  47 e9 ed 93 37 a8 fb aa  |TN......G...7...|
+000001d0  e0 73 36 5b ad 49 3c cb  82 71 fa fd b1 65 a8 2a  |.s6[.I<..q...e.*|
+000001e0  7e 5c 77 73 7d fc 0b 6c  14 0b 86 fd 76 8d 94 ef  |~\ws}..l....v...|
+000001f0  52 b1 e0 8a a0 59 db fc  2d 09 b5 ec 2f fc aa 62  |R....Y..-.../..b|
+00000200  32 82 d5 a2 02 73 31 b4  bb 0e ac 44 f4 5b 8c 03  |2....s1....D.[..|
+00000210  1b cb 7f d8 0e fe b6 96  3f 37 58 c1 f0 67 b2 f9  |........?7X..g..|
+00000220  d4 9c b9 a0 7e 51 62 cc  a9 62 6a 3c 0a 0e cf 42  |....~Qb..bj<...B|
+00000230  7e 39 b8 d6 06 46 9f ad  8b e4 7d 23 bb cc b8 a6  |~9...F....}#....|
+00000240  cf ca 94 84 fe f6 62 0d  8d 14 69 5c fa 83 c9 92  |......b...i\....|
+00000250  a4 1e 7d 35 e4 38 13 24  4d 25 a7 40 34 20 ba 70  |..}5.8.$M%.@4 .p|
+00000260  2b 0f 05 a9 d6 5f b5 3d  17 2c 29 f5 43 e7 a7 48  |+...._.=.,).C..H|
+00000270  45 7a 93 29 16 c3 19 64  76 1b 29 e5 c8 11 c0 4e  |Ez.)...dv.)....N|
+00000280  d9 2f 7c 4e 14 36 f3 56  0f 05 c9 f7 aa 2c d1 b0  |./|N.6.V.....,..|
+00000290  ba 88 b6 cb cc 93 fe a8  8e 49 83 71 3d fc 52 eb  |.........I.q=.R.|
+000002a0  5c 49 2c a2 b9 11 63 a7  89 96 67 93 6b c7 4d fe  |\I,...c...g.k.M.|
+000002b0  39 a4 f2 1a 55 64 54 99  a6 b7 ad 7b 03 34 09 0d  |9...UdT....{.4..|
+000002c0  f6 0b 14 b1 63 ec 14 33  1a 95 20 e6 d1 ba 08 cb  |....c..3.. .....|
+000002d0  35 af dc 4e 3f 28 a7 50  06 5d b3 fc 87 82 6b ec  |5..N?(.P.]....k.|
+000002e0  ef 12 7d f1 37 81 6d 13  5b a4 9d 48 9f 4f f8 d8  |..}.7.m.[..H.O..|
+000002f0  05 ae 83 53 e0 51 10 ed  32 cb 45 f9 5b a0 13 0d  |...S.Q..2.E.[...|
+00000300  a0 4d 5b 42 16 f4 6c 92  90 f9 aa 39 f3 21 01 07  |.M[B..l....9.!..|
+00000310  0a d6 cc 17 03 03 00 99  5b cc 01 ff 67 db 9e eb  |........[...g...|
+00000320  d8 09 67 24 3e 29 9a 44  59 90 52 f8 92 2b 33 49  |..g$>).DY.R..+3I|
+00000330  d1 ab f2 54 e8 02 50 9d  d5 5b 17 23 c1 11 8a 00  |...T..P..[.#....|
+00000340  f6 57 15 a7 37 a8 ed 90  12 30 71 03 b4 41 72 d2  |.W..7....0q..Ar.|
+00000350  90 f1 be d0 79 0a 32 88  78 a7 7a ac c4 75 9c d2  |....y.2.x.z..u..|
+00000360  51 cd 7a f9 00 b6 2f 79  d2 98 5f 11 8c 13 8d 9e  |Q.z.../y.._.....|
+00000370  cb af 65 2f dc 8a 27 2b  fe 17 9c b1 07 42 2b 9e  |..e/..'+.....B+.|
+00000380  c6 22 55 d1 a9 61 34 82  4d b7 ec 12 b1 24 b1 21  |."U..a4.M....$.!|
+00000390  d0 87 43 b4 f5 d7 19 cc  d2 2d e2 b7 13 c0 4c 2e  |..C......-....L.|
+000003a0  4f 79 24 a9 11 33 85 b3  bb eb d4 50 cb ab 56 5c  |Oy$..3.....P..V\|
+000003b0  6f 17 03 03 00 35 ee 8b  49 46 92 d2 87 24 01 08  |o....5..IF...$..|
+000003c0  e9 49 81 8b 81 0b 12 6d  45 c4 81 f2 36 bb 5b d9  |.I.....mE...6.[.|
+000003d0  d4 3f 2d 2b e8 67 e7 10  e7 89 1b ce df 49 d7 1c  |.?-+.g.......I..|
+000003e0  1b c0 8b 2d 06 f6 a3 5c  23 69 68 17 03 03 00 83  |...-...\#ih.....|
+000003f0  cf 6d 28 50 45 d4 72 b7  49 ac 84 9a a7 4e d2 46  |.m(PE.r.I....N.F|
+00000400  68 27 14 3f e5 ad 7f c9  ee d5 2a 2b 3b 2c 5d c2  |h'.?......*+;,].|
+00000410  ed ea 53 aa 86 92 df fc  ce 01 fe 7f cc 3a 80 f5  |..S..........:..|
+00000420  07 36 ed 98 88 a0 ac ef  91 3d 8f ac 41 c7 8d 2f  |.6.......=..A../|
+00000430  d1 5c 9c 31 52 a1 8c 68  cf b9 4d b9 5f 9c 33 40  |.\.1R..h..M._.3@|
+00000440  43 fe a1 a0 7d b2 5c 09  23 98 aa 45 7c 83 8b 07  |C...}.\.#..E|...|
+00000450  28 dc 83 10 49 8f 07 68  d6 8d 43 f4 9f 4e 65 fb  |(...I..h..C..Ne.|
+00000460  82 7b 97 82 be a3 59 3c  b7 1d a1 88 fb 0b 66 32  |.{....Y<......f2|
+00000470  f0 38 ab                                          |.8.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 df 4c 5c f4 f4  |..........5.L\..|
-00000010  f2 54 58 09 21 7c fe 64  7e f7 ad b0 fc 57 47 49  |.TX.!|.d~....WGI|
-00000020  fa 37 5c 40 f0 50 67 41  5d 62 15 16 e8 28 c6 96  |.7\@.PgA]b...(..|
-00000030  f0 99 de b1 0b b6 97 b1  d4 c6 4b ce 05 a6 64 32  |..........K...d2|
+00000000  14 03 03 00 01 01 17 03  03 00 35 94 fe fd f9 fa  |..........5.....|
+00000010  65 f4 44 a2 6d c9 16 b2  78 29 88 d0 b1 72 cc 3a  |e.D.m...x)...r.:|
+00000020  e8 3d 27 68 db 3a 50 ed  3f b1 cf dc 15 2c 9d d4  |.='h.:P.?....,..|
+00000030  79 ef b6 a2 57 35 6a 2a  4a b7 7e 5e 57 b1 15 2c  |y...W5j*J.~^W..,|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 9f 8d 81  11 4e 88 d8 78 bd a6 31  |.........N..x..1|
-00000010  4e 54 f8 86 a2 46 12 57  a9 da de 54 aa 71 b9 86  |NT...F.W...T.q..|
-00000020  a6 fe 5f 17 03 03 00 13  86 be 49 6c dc 76 8a 8e  |.._.......Il.v..|
-00000030  ba c3 95 3b 5d 64 d9 65  54 0a eb                 |...;]d.eT..|
+00000000  17 03 03 00 1e 39 11 ee  ea 58 59 a9 28 ee ec 8f  |.....9...XY.(...|
+00000010  94 da 57 0a 0d 0d 7c 8b  31 ff e5 87 93 26 7b 00  |..W...|.1....&{.|
+00000020  33 3e 1c 17 03 03 00 13  2d 8f f3 28 a2 fb 75 2d  |3>......-..(..u-|
+00000030  87 8f 24 1b d3 03 dc b7  d1 b3 25                 |..$.......%|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndECDSAGiven b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndECDSAGiven
index 6bca1da867..5c0f9e47fc 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndECDSAGiven
+++ b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndECDSAGiven
@@ -1,180 +1,180 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 e8 9e 92 8b b4  |................|
-00000010  38 4e 93 cf b6 67 7a 60  05 ca 5c d1 2f 74 8b 09  |8N...gz`..\./t..|
-00000020  31 4f 89 f8 84 95 b1 fd  33 ba 47 20 b3 06 47 e7  |1O......3.G ..G.|
-00000030  98 7a 4c 52 77 29 9d d8  2d cf 76 da ff ab bd 74  |.zLRw)..-.v....t|
-00000040  67 53 76 7e 4d c1 c4 75  3a 00 cd 4b 00 04 13 01  |gSv~M..u:..K....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 bb 7a 76 91 10  |............zv..|
+00000010  47 cc 1f 36 fd f7 4d dc  40 6c 07 bf c2 1d ff 2f  |G..6..M.@l...../|
+00000020  eb 56 40 52 23 e7 12 71  4b 27 46 20 38 bc 99 b2  |.V@R#..qK'F 8...|
+00000030  03 f5 e1 5c eb b3 b2 29  f4 6a a3 a9 76 b2 1e ab  |...\...).j..v...|
+00000040  9d 8b f2 09 b8 56 7e f5  e8 59 58 06 00 04 13 01  |.....V~..YX.....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 a7  |-.....3.&.$... .|
-000000b0  d1 d7 63 d7 3f 48 dd ba  c7 d3 7e ce 41 79 b8 25  |..c.?H....~.Ay.%|
-000000c0  df b7 34 6f b4 49 c0 5f  54 15 d3 31 a1 19 70     |..4o.I._T..1..p|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 b8  |-.....3.&.$... .|
+000000b0  a7 28 ca 45 4e 30 6d 3d  ee 72 fb 95 13 3d 89 48  |.(.EN0m=.r...=.H|
+000000c0  74 44 de 07 58 16 0d 58  84 48 07 b4 69 46 7f     |tD..X..X.H..iF.|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 b3 06 47 e7  |........... ..G.|
-00000030  98 7a 4c 52 77 29 9d d8  2d cf 76 da ff ab bd 74  |.zLRw)..-.v....t|
-00000040  67 53 76 7e 4d c1 c4 75  3a 00 cd 4b 13 01 00 00  |gSv~M..u:..K....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 38 bc 99 b2  |........... 8...|
+00000030  03 f5 e1 5c eb b3 b2 29  f4 6a a3 a9 76 b2 1e ab  |...\...).j..v...|
+00000040  9d 8b f2 09 b8 56 7e f5  e8 59 58 06 13 01 00 00  |.....V~..YX.....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 a8 4b 20 a0 50 5f  |...........K .P_|
-00000090  50 bf b3 2a 52 27 a7 cc  23 9d 7d cd ee de 94 8a  |P..*R'..#.}.....|
-000000a0  58 17 03 03 00 3e 4e d3  73 ee c0 fe 30 d9 ad 28  |X....>N.s...0..(|
-000000b0  f1 a3 50 94 89 6a 20 9e  c9 39 07 73 32 94 88 d7  |..P..j ..9.s2...|
-000000c0  92 c9 03 45 63 42 48 6d  3a 6b 64 d1 99 ab 07 f0  |...EcBHm:kd.....|
-000000d0  6c ad 6a 5f 40 61 d1 0c  c0 50 1b 5d 43 f3 9d c6  |l.j_@a...P.]C...|
-000000e0  4c a2 5c e1 17 03 03 02  6d 1b b6 30 2c 62 0b 40  |L.\.....m..0,b.@|
-000000f0  99 63 57 ab 7f b2 7d d4  74 df ce 98 b7 dc 62 8b  |.cW...}.t.....b.|
-00000100  5e c9 c1 08 12 00 53 cc  99 9b 9f 7a 07 ab 6e 8e  |^.....S....z..n.|
-00000110  f7 21 89 0b eb bc 69 ff  e9 fc a6 d0 d2 34 9f 9a  |.!....i......4..|
-00000120  ba 77 be 95 55 be 50 54  bc b3 72 54 51 e3 02 86  |.w..U.PT..rTQ...|
-00000130  bb f2 bd 61 b8 f1 9d ee  d3 9f 92 89 f4 38 9d a3  |...a.........8..|
-00000140  44 99 a5 d5 45 32 01 f6  cc aa 86 40 9e c1 72 f9  |D...E2.....@..r.|
-00000150  18 58 2a 22 8f e0 b9 ce  0c 65 90 08 81 ef 66 b5  |.X*".....e....f.|
-00000160  ab dd b4 1c 4f a7 7e 77  36 45 fd cc ee 9e 92 d6  |....O.~w6E......|
-00000170  a2 c9 cf 39 fc c9 1e 7b  be f2 b3 66 c9 16 4d 3e  |...9...{...f..M>|
-00000180  bf 8d ab 11 c1 4d 69 29  cf 33 b3 3f 65 5b 1d 2b  |.....Mi).3.?e[.+|
-00000190  7a f8 e9 9a 6d 86 eb 3c  0f 8d fa 12 c7 02 7a d7  |z...m..<......z.|
-000001a0  ac a2 68 6b 14 80 c7 28  c4 96 c2 e6 10 00 08 d8  |..hk...(........|
-000001b0  a8 0a d6 69 a6 61 b4 46  fd 55 ea 95 cf f0 56 23  |...i.a.F.U....V#|
-000001c0  c9 07 2c 2b 0a 85 9b aa  d3 3c 74 6d 2f 43 ca e1  |..,+.....<tm/C..|
-000001d0  92 b9 4a b0 6d fd 98 f4  b4 a7 51 da 21 5c c6 c4  |..J.m.....Q.!\..|
-000001e0  8e 18 19 71 4e 1e 5f 4a  56 bf a0 87 a3 02 f5 0f  |...qN._JV.......|
-000001f0  1c 62 e5 69 df 87 44 05  18 59 45 87 76 12 ad fd  |.b.i..D..YE.v...|
-00000200  ca 0f 98 f2 53 6d 9c 66  49 a3 82 12 0f a1 f6 d8  |....Sm.fI.......|
-00000210  e3 d5 52 17 57 ae 9f f2  bb fc 67 b4 60 07 ca ec  |..R.W.....g.`...|
-00000220  39 e2 12 06 9a cc 28 fa  03 b3 1b 21 65 8f ea 7f  |9.....(....!e...|
-00000230  d1 bd 1d 66 de ad 44 1f  e2 ae a0 1c fd 38 d9 d7  |...f..D......8..|
-00000240  93 16 0f 33 0d 85 7a 20  9e e8 e0 ee 8d 9e 09 98  |...3..z ........|
-00000250  b6 e3 2c 86 f1 6e fa 9b  c9 97 35 04 c1 eb a9 7f  |..,..n....5.....|
-00000260  8e 02 c7 d2 b0 74 f6 87  8d 28 47 ba 19 1c b6 df  |.....t...(G.....|
-00000270  1e d4 6c 6d f5 5a c1 0b  d6 8b 3e be 00 08 7d 4a  |..lm.Z....>...}J|
-00000280  21 61 67 82 39 3f f0 62  d1 82 fe ae ab 8e a6 02  |!ag.9?.b........|
-00000290  8c 1f 26 de ce 3e a1 a5  43 1f 7b a2 58 a9 1f b6  |..&..>..C.{.X...|
-000002a0  5f 37 16 af 82 36 18 e0  be b4 42 40 af ac b4 c5  |_7...6....B@....|
-000002b0  87 eb fd 17 70 7b 45 cb  fe f6 a1 23 4a 5f 76 73  |....p{E....#J_vs|
-000002c0  9c 13 0f 5a 24 d7 6e 43  34 5a ba 06 d4 68 cf ce  |...Z$.nC4Z...h..|
-000002d0  32 4e 7d d0 29 c4 33 c6  ae 0e 38 d1 07 5c 22 b7  |2N}.).3...8..\".|
-000002e0  a8 84 48 ed 88 99 f2 f0  87 35 28 5a aa 27 d8 00  |..H......5(Z.'..|
-000002f0  3a 1a bc ae 63 b7 59 8a  30 ef bb 16 13 47 d2 a0  |:...c.Y.0....G..|
-00000300  c3 09 c8 6d fc aa 1e f0  d4 e2 dc 65 8d ca f0 5e  |...m.......e...^|
-00000310  e5 32 02 c3 58 89 94 80  b3 be b6 0c 23 73 5a 29  |.2..X.......#sZ)|
-00000320  63 9c 89 93 0c e9 e9 b0  f1 f8 61 1c 25 d5 12 60  |c.........a.%..`|
-00000330  aa b4 79 df 94 8a 83 3d  1c 58 6a 2b 86 5d d3 b0  |..y....=.Xj+.]..|
-00000340  01 11 11 85 0e 86 ae 9f  e1 26 60 d7 cb 91 57 76  |.........&`...Wv|
-00000350  53 36 38 ed 06 4f 17 03  03 00 99 bf e9 10 6e a2  |S68..O........n.|
-00000360  82 8d d4 b9 65 16 d5 c0  d5 dc e7 71 3e b6 9e e7  |....e......q>...|
-00000370  ab eb 8a c8 8f 3d 95 d8  af ab 85 6d a9 8a 17 32  |.....=.....m...2|
-00000380  f9 14 5a d3 df 83 4a 14  50 fd b3 47 b6 e3 5f 8f  |..Z...J.P..G.._.|
-00000390  33 ee b8 17 a9 18 94 81  c7 85 da bb b6 3e 13 8b  |3............>..|
-000003a0  8e 95 b9 19 f7 8f df c9  c6 88 5d db ff be 58 7d  |..........]...X}|
-000003b0  5b 15 b3 16 42 b1 73 c4  d8 4f b4 d2 af f1 e3 a4  |[...B.s..O......|
-000003c0  bf 8f 4c 3f 15 97 15 2a  2b 15 3a b3 26 72 73 63  |..L?...*+.:.&rsc|
-000003d0  d8 10 0c 79 27 98 da c5  04 c5 54 15 dc 73 38 63  |...y'.....T..s8c|
-000003e0  72 68 0f 20 30 e2 7d 6c  54 f9 9c 74 76 c5 ae c7  |rh. 0.}lT..tv...|
-000003f0  13 d8 4d c0 17 03 03 00  35 a6 af 56 74 b6 80 80  |..M.....5..Vt...|
-00000400  b1 65 68 43 43 23 5a 07  ff ea 91 14 b9 c4 9c 5f  |.ehCC#Z........_|
-00000410  a3 e0 4a b2 1f 60 d7 87  57 fb 5f 77 6f 3c 40 65  |..J..`..W._wo<@e|
-00000420  ba 4b e6 e3 64 8b a2 30  b5 0b c1 ba 77 f2        |.K..d..0....w.|
+00000080  03 03 00 01 01 17 03 03  00 17 08 91 98 0b a9 34  |...............4|
+00000090  10 ca 54 9a 05 00 7b 9f  7b fd 9d d7 ba 20 89 2f  |..T...{.{.... ./|
+000000a0  1d 17 03 03 00 3e e0 2f  74 7d d9 69 6f 5f 55 f8  |.....>./t}.io_U.|
+000000b0  bc b0 e1 5d c7 a7 36 c3  9f ed fc 86 c5 23 7d 70  |...]..6......#}p|
+000000c0  b5 49 dd 08 54 75 9f bd  ba a2 d1 e5 0f 82 89 80  |.I..Tu..........|
+000000d0  3a 7c 1c 01 7a 55 13 3c  2f 2e 9b 65 c4 a1 0f 10  |:|..zU.</..e....|
+000000e0  70 fe 9f 78 17 03 03 02  6d 14 4c d8 7f 2a 5e 7b  |p..x....m.L..*^{|
+000000f0  0e 80 fc cd 77 20 2c ea  1f 10 7d ee 43 30 30 71  |....w ,...}.C00q|
+00000100  14 e7 35 58 15 29 12 4a  30 90 2f 87 70 5f 31 c7  |..5X.).J0./.p_1.|
+00000110  d8 1e 71 5d 24 4e 1b 40  0a dc c7 45 48 da d0 c9  |..q]$N.@...EH...|
+00000120  7d b1 d6 ef 5d 01 4f 58  10 05 53 7e 4d 9a 2d fb  |}...].OX..S~M.-.|
+00000130  29 9e 86 6e 5b 63 66 3a  4f 0f a7 87 87 4c 75 1d  |)..n[cf:O....Lu.|
+00000140  96 d6 1f b5 ef 33 d7 5d  42 f5 8d da e0 5f 5c d6  |.....3.]B...._\.|
+00000150  cb 6e 01 0f e0 24 40 84  14 9d ce e1 3b 6f 65 c8  |.n...$@.....;oe.|
+00000160  0d a5 88 18 25 89 0d 45  cb ee cd 6d d4 87 fd b7  |....%..E...m....|
+00000170  50 37 9a 67 0a 14 02 51  90 86 ca 63 1e 23 7c 58  |P7.g...Q...c.#|X|
+00000180  8c aa 5e 29 11 4e f0 50  f9 7d 83 63 f9 1d 6d a0  |..^).N.P.}.c..m.|
+00000190  9e 32 35 93 74 38 41 f8  c5 b8 77 e7 60 43 b7 38  |.25.t8A...w.`C.8|
+000001a0  d1 8c 26 9e c7 2e 9f ac  8a b7 d6 9f 9d 8c 29 37  |..&...........)7|
+000001b0  29 93 24 35 10 ac ee 32  07 e1 4c 0f a1 a2 94 f2  |).$5...2..L.....|
+000001c0  d1 5d 23 40 ad ca a6 93  8f 04 0e 8f 58 21 6a d2  |.]#@........X!j.|
+000001d0  d4 bd 86 b1 40 27 46 eb  bb 5a be 80 8c ee 68 aa  |....@'F..Z....h.|
+000001e0  19 e8 57 e8 d5 00 06 c5  52 6e a1 4b 60 2c 99 24  |..W.....Rn.K`,.$|
+000001f0  79 28 a6 53 13 63 e8 64  22 74 d0 e3 2d a3 b8 19  |y(.S.c.d"t..-...|
+00000200  c9 ab 94 87 84 96 a5 26  03 f2 43 63 4d 33 3f fe  |.......&..CcM3?.|
+00000210  f9 9a fa 42 03 66 20 5a  35 0e 3a 5a 83 42 be 99  |...B.f Z5.:Z.B..|
+00000220  1a 20 b9 2f 39 51 9b 8c  e1 b3 b6 e4 41 ba ba a5  |. ./9Q......A...|
+00000230  76 f9 14 52 38 09 32 78  74 7c 4c 6c fc 86 b0 6b  |v..R8.2xt|Ll...k|
+00000240  ed 25 b2 e1 1e 52 cf 5c  b5 87 81 88 f1 76 6b d4  |.%...R.\.....vk.|
+00000250  ed 45 2e 23 66 3d 94 c3  a9 0f d0 16 1d 62 87 56  |.E.#f=.......b.V|
+00000260  f9 82 10 c9 21 95 99 2f  87 e6 d0 fa 72 49 ae f4  |....!../....rI..|
+00000270  5a 54 82 06 c6 0d 93 2c  95 94 ab e0 af 8a a6 51  |ZT.....,.......Q|
+00000280  1a 39 d4 1a 02 98 74 b6  3e af d8 d6 90 e5 12 8e  |.9....t.>.......|
+00000290  1e 1d e5 a0 4a bb 0f 4f  38 43 be 83 3c 5b 89 f2  |....J..O8C..<[..|
+000002a0  02 5c a4 99 08 62 33 8f  8c ed 31 6b 9a 02 f0 49  |.\...b3...1k...I|
+000002b0  ee af 78 1e 78 fd d9 37  60 d1 82 5d 86 9c 34 a2  |..x.x..7`..]..4.|
+000002c0  10 97 55 4a 37 a1 aa 4c  0e 44 e2 36 55 2b 7f 72  |..UJ7..L.D.6U+.r|
+000002d0  b6 69 b1 74 19 d1 bd 89  c3 5f 82 7c c6 58 10 30  |.i.t....._.|.X.0|
+000002e0  5b c9 65 8e 7e 4c e4 64  a4 de 33 88 66 b2 ef 44  |[.e.~L.d..3.f..D|
+000002f0  e0 e4 ab 91 da 48 64 88  6f a6 31 ff 02 ea ee 1b  |.....Hd.o.1.....|
+00000300  ee ec 49 8a 3b 4d 33 c1  59 5e 48 5c 50 12 d8 17  |..I.;M3.Y^H\P...|
+00000310  f3 54 5a 20 09 2b 5c 25  da 53 56 c1 d8 77 a3 9b  |.TZ .+\%.SV..w..|
+00000320  2c 06 83 e3 a5 71 32 04  57 85 95 19 02 65 55 34  |,....q2.W....eU4|
+00000330  4c 9d 2e fd fa 53 a5 17  90 63 fd 35 17 69 67 d6  |L....S...c.5.ig.|
+00000340  b7 55 4a 79 fe ff 7a ee  46 88 30 b1 3e eb 62 66  |.UJy..z.F.0.>.bf|
+00000350  bc 9e 55 9d 58 d2 17 03  03 00 99 db f4 b0 48 ca  |..U.X.........H.|
+00000360  bb b7 e9 1f 62 ac 24 ba  80 a9 39 8c cf d8 83 f5  |....b.$...9.....|
+00000370  61 a5 09 fb 59 e1 c2 f7  52 71 4e 70 bf 87 26 3f  |a...Y...RqNp..&?|
+00000380  0f 1b f6 6d c1 7f 1f 36  d5 d2 8c 62 4e 2e 54 6f  |...m...6...bN.To|
+00000390  dc 6e cf 6d 27 c2 b2 e5  30 1b 2e b3 1e 19 0e df  |.n.m'...0.......|
+000003a0  49 0e 00 b6 c3 73 77 31  de 4e 82 04 f9 40 ea 30  |I....sw1.N...@.0|
+000003b0  c2 23 8d 7e 91 57 02 a5  44 ee 58 c9 37 6f 7b ad  |.#.~.W..D.X.7o{.|
+000003c0  ce e6 5e fd 8c 24 13 7d  9f 62 2b cb 82 4f f8 fc  |..^..$.}.b+..O..|
+000003d0  10 69 44 a4 6a 89 d0 cb  bc 70 30 85 cb b6 35 ec  |.iD.j....p0...5.|
+000003e0  6e 0d e8 d6 9b 7d 96 b7  d8 29 17 b5 72 ab 8f 87  |n....}...)..r...|
+000003f0  39 f2 64 07 17 03 03 00  35 66 2a 3b c9 ec 19 80  |9.d.....5f*;....|
+00000400  bb 7b 16 6e 14 c0 6a 74  aa 4d 0a 43 25 19 8d 37  |.{.n..jt.M.C%..7|
+00000410  79 0c d7 a0 ab 74 e2 ba  ae c9 76 68 1c b8 66 7a  |y....t....vh..fz|
+00000420  52 6b 65 c9 6c 02 ca 3b  76 c4 9f fe ef d0        |Rke.l..;v.....|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 02 1e 2e 4a 62 c3 9e  |............Jb..|
-00000010  66 7b 32 01 41 d8 c1 76  a4 2b 1d 89 77 e7 f4 b7  |f{2.A..v.+..w...|
-00000020  e9 f4 34 91 f2 a0 ee 1d  97 17 13 9e 28 1c 98 e3  |..4.........(...|
-00000030  6d a4 5d 94 44 4f 68 36  02 26 d0 87 05 84 72 6b  |m.].DOh6.&....rk|
-00000040  af 84 6f e3 27 bf eb e0  d1 5e 9f c2 c9 87 05 10  |..o.'....^......|
-00000050  1a 3b 23 ec 2c c0 90 2e  56 59 70 2e 8a 28 05 61  |.;#.,...VYp..(.a|
-00000060  26 09 ec 78 b7 6a 6b 13  4d 4b ac 0b 25 77 98 e4  |&..x.jk.MK..%w..|
-00000070  72 7d 58 64 4f bb 0e be  6b 98 97 af 93 4c dc 2d  |r}XdO...k....L.-|
-00000080  10 c8 88 f4 ec 28 01 e0  79 8b ac bf 6a f7 6a ca  |.....(..y...j.j.|
-00000090  85 41 a5 07 2f 82 f5 33  58 e3 55 e9 6b 5a bb 54  |.A../..3X.U.kZ.T|
-000000a0  e4 f5 ed 6f 2d 0e 86 55  d5 85 c3 18 ea cf 9a f6  |...o-..U........|
-000000b0  b1 76 83 c5 1f 03 15 9a  ac 66 85 6c 83 0f 93 cc  |.v.......f.l....|
-000000c0  0e 5e d6 a4 92 2b 99 18  54 ff 3d 69 41 af 73 70  |.^...+..T.=iA.sp|
-000000d0  21 ab b0 3d 43 e5 a9 18  e3 1a e6 95 48 c0 27 d8  |!..=C.......H.'.|
-000000e0  87 1c 40 59 f2 b9 e6 17  af 98 31 1f 85 f5 ef 26  |..@Y......1....&|
-000000f0  ef 8f c9 c6 fd a2 cb 15  3a 83 0f 8f 0f 36 f2 a3  |........:....6..|
-00000100  1b 60 eb cf cd 8f 3b 13  2c 67 13 66 99 5c 3a 70  |.`....;.,g.f.\:p|
-00000110  7e 2c c3 c8 66 57 13 10  dd 58 3d 1e ae 71 a4 93  |~,..fW...X=..q..|
-00000120  74 f0 e1 02 f7 0b b4 0c  f5 2a 8a cb 81 98 d1 8e  |t........*......|
-00000130  fc fb a5 80 1c 1b 69 05  2f fa a3 81 58 9f d0 ed  |......i./...X...|
-00000140  3d 6a bc 1d 1f b6 6a 93  26 30 c2 41 d2 c9 75 e9  |=j....j.&0.A..u.|
-00000150  83 b0 75 a1 56 50 8e f1  ba d0 7b c9 69 a1 2c 03  |..u.VP....{.i.,.|
-00000160  3d 95 05 c6 6c 42 7d c3  17 e5 82 fb b3 03 8a 51  |=...lB}........Q|
-00000170  c9 31 58 02 42 b8 44 63  08 b8 b4 35 21 03 f9 00  |.1X.B.Dc...5!...|
-00000180  80 ea 19 32 d9 13 18 5f  a6 ef b6 21 1c 97 15 76  |...2..._...!...v|
-00000190  83 5b f1 c0 5d c6 9a 7c  21 a2 8a eb f1 0b b7 01  |.[..]..|!.......|
-000001a0  48 6e 53 fd 54 d2 da 38  dc f0 b0 ca d9 cd d0 16  |HnS.T..8........|
-000001b0  ae c0 ef ba a6 11 35 15  fb 1f 96 1c db 01 9b e4  |......5.........|
-000001c0  42 c5 41 6d e1 a4 31 79  f7 77 57 e6 5c 15 42 c6  |B.Am..1y.wW.\.B.|
-000001d0  f5 0a e3 1b e6 fa ed eb  d1 f1 f0 05 3c 93 cf c2  |............<...|
-000001e0  bf f0 c2 8f ec 0a 30 a5  a9 b8 a8 b7 7d 6c c3 bb  |......0.....}l..|
-000001f0  d9 49 5a 81 3c a3 64 a2  d1 a4 ad 29 b4 5f a6 53  |.IZ.<.d....)._.S|
-00000200  ab 7d fe c0 00 dc 56 60  08 bc b5 d8 55 d1 17 fc  |.}....V`....U...|
-00000210  bb 97 77 a4 89 7b 3e 6a  28 18 7c 65 06 bc f4 56  |..w..{>j(.|e...V|
-00000220  49 3b 25 48 a9 9b 85 83  53 17 03 03 00 a3 2c 66  |I;%H....S.....,f|
-00000230  0d 3f 94 da e1 6d 5e 56  d6 8f 9a bd 7d a3 ac 9d  |.?...m^V....}...|
-00000240  ae e7 ab 29 12 b0 2f cb  77 a9 48 75 57 67 93 17  |...)../.w.HuWg..|
-00000250  2f 87 21 7b e2 c2 e5 b6  82 ca c9 fb e6 6a 2e 78  |/.!{.........j.x|
-00000260  ca 80 a1 6f f2 a6 1b 2e  5e 7d 4b 90 7e df f8 db  |...o....^}K.~...|
-00000270  83 4c 4b c6 e1 fe eb e7  7f e4 80 73 cc 0d 71 53  |.LK........s..qS|
-00000280  46 dc b0 ac b4 61 41 88  25 3e 35 7e d0 db 92 2a  |F....aA.%>5~...*|
-00000290  ff 44 e4 69 25 79 d7 a3  a7 90 01 a0 da f3 5f 26  |.D.i%y........_&|
-000002a0  92 8b 8b c4 96 40 fa 31  20 cb 4c df ee d4 4e ed  |.....@.1 .L...N.|
-000002b0  b4 8e eb 96 ba e3 62 6e  67 70 7e 46 07 3c b2 86  |......bngp~F.<..|
-000002c0  90 35 e0 f0 10 3c c8 20  36 f2 ef 3c e5 03 e9 cc  |.5...<. 6..<....|
-000002d0  d3 17 03 03 00 35 a1 c7  67 86 1f 6f d9 10 dd c1  |.....5..g..o....|
-000002e0  5c 76 ad 77 93 3b 64 fc  0c 75 8a 5a 17 ab 60 17  |\v.w.;d..u.Z..`.|
-000002f0  93 af 6a 64 21 d1 46 30  10 8c af 6f eb af 72 7d  |..jd!.F0...o..r}|
-00000300  f0 68 6d c6 b6 7d a3 84  ae 2c b9 17 03 03 00 13  |.hm..}...,......|
-00000310  f1 c6 e8 b6 e5 3b a2 40  5c 6f 0c 25 e2 4a a0 a7  |.....;.@\o.%.J..|
-00000320  35 e8 b6                                          |5..|
+00000000  14 03 03 00 01 01 17 03  03 02 1e 7f a4 02 41 a2  |..............A.|
+00000010  6c 1b 61 db 3e 26 6f fc  8f 80 9a 18 de 09 6f e7  |l.a.>&o.......o.|
+00000020  99 4d f9 90 7c 60 a4 88  f5 32 e7 de 0b 93 81 c0  |.M..|`...2......|
+00000030  85 90 4d c3 27 1d d5 ae  39 01 ad 80 b7 d9 3b e8  |..M.'...9.....;.|
+00000040  e4 29 95 7e 3b 92 02 c9  89 9c ae a5 76 08 95 20  |.).~;.......v.. |
+00000050  c5 6f 16 48 4c 2c ae 89  91 ea df 5b 83 0a 03 60  |.o.HL,.....[...`|
+00000060  70 3a 39 44 fd f4 45 99  47 53 3f 73 a0 4d 9b 2f  |p:9D..E.GS?s.M./|
+00000070  3b 14 99 50 65 2f 5f 1a  8c dd f5 7e 51 10 f7 f1  |;..Pe/_....~Q...|
+00000080  67 5f ec b7 48 4a 14 71  5b 64 74 91 bb f9 90 dc  |g_..HJ.q[dt.....|
+00000090  f4 7a 8a ea f8 99 45 28  4b 97 b9 50 38 2f eb 28  |.z....E(K..P8/.(|
+000000a0  5f 4d 8c ed 55 94 e2 19  48 3f eb 7e eb 32 b0 8b  |_M..U...H?.~.2..|
+000000b0  c7 e2 6f 0a 88 df 89 9f  63 68 9e 66 f6 ba 2b d0  |..o.....ch.f..+.|
+000000c0  01 b7 2a 59 1a 14 e5 a8  63 d3 60 7f e0 0c 43 94  |..*Y....c.`...C.|
+000000d0  67 2f c2 b2 96 8a 19 0a  40 95 ea 66 52 31 f3 9e  |g/......@..fR1..|
+000000e0  17 f4 c2 5c 18 0d bc fa  43 ca 9b 99 18 2a 54 0d  |...\....C....*T.|
+000000f0  8b 80 1c 8f f1 1d fc f4  44 13 7d 73 39 10 1b 21  |........D.}s9..!|
+00000100  35 1d d6 59 6a 83 ed 5b  ad 61 a4 4e 71 8c 69 b0  |5..Yj..[.a.Nq.i.|
+00000110  43 72 da fb 6f ad c5 bb  3a 23 36 dc 65 03 41 ec  |Cr..o...:#6.e.A.|
+00000120  dd 26 5a 33 ec 22 15 ab  72 af 74 4f 1e a3 a1 05  |.&Z3."..r.tO....|
+00000130  2c 63 dc 63 c2 a7 f6 86  c2 b6 bd 4f d4 ed c7 19  |,c.c.......O....|
+00000140  33 69 49 34 f4 2b 02 78  72 f2 6c 14 e1 03 8c 72  |3iI4.+.xr.l....r|
+00000150  4d 7e 17 07 23 38 f9 7c  56 f6 03 7a 0e a8 63 76  |M~..#8.|V..z..cv|
+00000160  bf 82 7b f4 7b 6b ed f5  57 42 6a 95 df d8 6c df  |..{.{k..WBj...l.|
+00000170  a0 9e f8 91 48 f5 92 5e  31 c0 dd 57 ad 7e a0 22  |....H..^1..W.~."|
+00000180  33 ba b0 dd cd ad 53 50  0d f4 fa 02 c7 2c b8 ec  |3.....SP.....,..|
+00000190  fc 1d e3 15 f9 51 2b 4d  f8 46 16 be d2 35 05 73  |.....Q+M.F...5.s|
+000001a0  b6 7a c3 b1 d4 89 96 21  5f 03 7a cc 9e d1 cc ad  |.z.....!_.z.....|
+000001b0  80 b7 fa ca 75 2b ed 46  93 04 0c a2 6b 26 6e a1  |....u+.F....k&n.|
+000001c0  26 2f 35 dc d5 db de 6c  3a 60 94 b4 ad c7 95 a2  |&/5....l:`......|
+000001d0  86 f4 9b ff 91 2d 63 76  8d f8 16 a0 74 ba 75 20  |.....-cv....t.u |
+000001e0  cf d8 98 cf bd 96 83 f2  e9 44 39 47 8d 45 97 2d  |.........D9G.E.-|
+000001f0  6c 7d 2c 85 5b 31 a0 02  93 5b c7 07 d2 8e b1 7c  |l},.[1...[.....||
+00000200  1f 9a 56 42 c4 77 1c a6  38 8d e0 01 88 47 a3 70  |..VB.w..8....G.p|
+00000210  30 79 25 07 2c 82 1e 92  89 01 3d 30 49 b8 2a ef  |0y%.,.....=0I.*.|
+00000220  85 18 58 00 c5 3e f0 82  03 17 03 03 00 a3 a1 93  |..X..>..........|
+00000230  cb 03 4e 47 8e 45 ff e6  af 68 e3 dc c7 8e e3 de  |..NG.E...h......|
+00000240  b5 ff 68 3f 72 0e e4 9f  4f 65 96 69 84 f4 73 bf  |..h?r...Oe.i..s.|
+00000250  7b c0 07 a4 8a 29 b9 95  c5 45 50 c0 75 d6 4c 2a  |{....)...EP.u.L*|
+00000260  06 cc ac 1a 9c 0b 90 a3  da 4e 5a 43 48 fc 0a da  |.........NZCH...|
+00000270  2c 49 7b 97 cf ae a5 c2  76 5c 6d 52 e0 8d 25 67  |,I{.....v\mR..%g|
+00000280  30 08 d8 cf 54 90 72 13  9f 8c 6d 9b c8 40 a2 ba  |0...T.r...m..@..|
+00000290  71 30 4d 37 66 9b df e6  67 d0 a7 6c ef c0 b1 da  |q0M7f...g..l....|
+000002a0  3a ac 7e b7 85 ae 5b d2  e4 63 79 ed 0e 77 b7 bf  |:.~...[..cy..w..|
+000002b0  70 af 06 f4 e5 1e 32 2a  6c 80 4f c6 54 a9 43 0c  |p.....2*l.O.T.C.|
+000002c0  9c 72 27 e1 ae f5 f3 9f  f0 e5 e5 9d 92 22 cc c6  |.r'.........."..|
+000002d0  17 17 03 03 00 35 b3 4e  54 8a bb f9 97 70 4b 94  |.....5.NT....pK.|
+000002e0  e7 ec 4f e1 de 8c 41 0c  6f 13 e9 19 55 18 28 b4  |..O...A.o...U.(.|
+000002f0  5d 97 d6 7a fa ea 59 c5  51 38 52 27 2d a3 5b e7  |]..z..Y.Q8R'-.[.|
+00000300  af d2 65 f0 0a 94 de 20  94 d6 89 17 03 03 00 13  |..e.... ........|
+00000310  6a 25 c8 d9 5a 8d c9 0b  58 5b 43 0a a4 1f 18 33  |j%..Z...X[C....3|
+00000320  c4 b2 64                                          |..d|
 >>> Flow 4 (server to client)
-00000000  17 03 03 02 88 aa 3b 61  4a 18 65 f0 33 21 42 57  |......;aJ.e.3!BW|
-00000010  b9 c4 33 75 40 89 73 60  f8 aa e8 ae cf 88 a4 ce  |..3u@.s`........|
-00000020  32 80 d7 22 c9 a6 f7 5a  76 c2 79 96 bc df b8 cb  |2.."...Zv.y.....|
-00000030  f6 34 c3 c7 ca fb 7f ed  4d 9b af fe 00 b1 ae 7f  |.4......M.......|
-00000040  0a 85 28 27 f1 a3 bc 8f  99 7a 15 d1 f6 f3 48 ac  |..('.....z....H.|
-00000050  1f 2d cc 4e 51 15 06 d7  f1 13 22 f0 d0 21 cd e7  |.-.NQ....."..!..|
-00000060  c9 ec 66 3d 99 b2 db e0  96 bf f8 35 01 b9 d0 ff  |..f=.......5....|
-00000070  22 1d 68 cc 30 5d b3 8e  93 02 5f 3f a7 8c 21 95  |".h.0]...._?..!.|
-00000080  23 16 8f d2 16 53 72 db  8c df fd e6 a4 5d b6 f6  |#....Sr......]..|
-00000090  c4 a6 50 a6 a8 76 3c f2  65 61 3e c9 dc 28 e4 65  |..P..v<.ea>..(.e|
-000000a0  9e 49 7f fa 90 85 0a 4a  e4 89 fd 7c f0 9e 76 5f  |.I.....J...|..v_|
-000000b0  57 00 d0 16 82 b3 9e a4  ac 65 88 3d 21 2e 69 1b  |W........e.=!.i.|
-000000c0  28 f6 c1 c3 59 40 2d 1e  e4 d8 5f 23 66 8b 9b db  |(...Y@-..._#f...|
-000000d0  b9 e6 d8 e5 2a 55 23 89  c9 b7 ef 08 5d 84 04 38  |....*U#.....]..8|
-000000e0  87 90 15 1c 32 b6 36 f8  b8 15 49 f0 36 4c 46 8a  |....2.6...I.6LF.|
-000000f0  d6 9d 0d 4c 4a da cb 1c  cd 99 24 e5 51 da 38 96  |...LJ.....$.Q.8.|
-00000100  f5 ac 2f 0a 94 b2 47 91  aa da c3 71 7c 6b 09 98  |../...G....q|k..|
-00000110  e9 ae f6 22 3a a0 2f 14  e0 70 4b da 8e 6e 07 fb  |...":./..pK..n..|
-00000120  49 ce 05 b0 95 16 b2 15  a9 65 94 28 14 89 c0 ae  |I........e.(....|
-00000130  95 57 1b ec f3 f8 26 dd  1e d8 d6 b8 2d 03 08 77  |.W....&.....-..w|
-00000140  fb 62 cd 83 6a 4f 21 d8  12 4c 06 47 3f 73 52 ed  |.b..jO!..L.G?sR.|
-00000150  a5 83 24 39 f9 15 ad ab  35 a4 9c 0b 4e 57 bc 27  |..$9....5...NW.'|
-00000160  86 74 5d f3 bb 9a 6b a7  f3 21 a2 05 af 15 1b db  |.t]...k..!......|
-00000170  f4 40 28 00 64 4c 18 6f  6f 79 06 f7 c2 1e 9d cf  |.@(.dL.ooy......|
-00000180  9f 3b 80 f3 65 e1 7e b7  90 af 92 94 7c b3 94 65  |.;..e.~.....|..e|
-00000190  0b 7f b9 26 47 4a 9b 65  08 0b 54 1d 81 aa 31 f0  |...&GJ.e..T...1.|
-000001a0  26 a4 2c 47 c1 03 69 40  26 03 d6 39 0a fb 83 e0  |&.,G..i@&..9....|
-000001b0  0e 89 3b f4 39 fd b5 28  b6 6a 27 22 94 34 5f f0  |..;.9..(.j'".4_.|
-000001c0  84 44 dc 08 b2 7a 49 a0  e8 41 93 d3 48 5b 15 48  |.D...zI..A..H[.H|
-000001d0  c9 15 8a 2c e3 3c 02 5d  97 ee a3 fe 26 e9 40 b7  |...,.<.]....&.@.|
-000001e0  6c f7 cc 5b 26 6b b9 52  b7 d1 65 68 c3 76 cd 9a  |l..[&k.R..eh.v..|
-000001f0  7c 86 ce c7 06 e0 e3 57  33 44 8a 75 6f 49 57 19  ||......W3D.uoIW.|
-00000200  ac 9d 24 af 5e 94 8f 53  20 45 e4 3c b2 62 3c 5f  |..$.^..S E.<.b<_|
-00000210  fb d2 17 1b a5 9c 37 a5  66 e3 12 b7 99 ee ce 05  |......7.f.......|
-00000220  37 5c 79 28 d1 4d 2f 1f  4a 79 91 e3 e7 88 2a 31  |7\y(.M/.Jy....*1|
-00000230  40 72 d2 58 e3 e1 84 16  75 d3 ab 8a bd 74 73 41  |@r.X....u....tsA|
-00000240  9b 57 69 d6 62 5e ca f9  b8 b2 05 06 08 b9 be 76  |.Wi.b^.........v|
-00000250  40 6d da 61 1d 5f d4 50  bd 36 07 5a 5a 1f 78 3f  |@m.a._.P.6.ZZ.x?|
-00000260  af 20 4c cf d8 da 6a 33  3b 03 9c b3 5f 07 f3 ce  |. L...j3;..._...|
-00000270  81 9b 9e b1 ce 2e f7 ec  6c b9 ee 99 54 9f df 6d  |........l...T..m|
-00000280  0b 20 1a 82 bb d3 76 57  b3 db 00 89 d1 17 03 03  |. ....vW........|
-00000290  00 1e b8 9d 93 7d eb 43  07 b6 8b c2 57 26 45 e4  |.....}.C....W&E.|
-000002a0  60 1c 13 0b ab cc 6a 6a  6b c0 b1 4e 66 36 92 02  |`.....jjk..Nf6..|
-000002b0  17 03 03 00 13 87 a1 99  a6 ea 80 e4 3e 55 66 fb  |............>Uf.|
-000002c0  a2 4f 79 e0 f7 a3 c1 6e                           |.Oy....n|
+00000000  17 03 03 02 88 37 35 05  87 39 94 0e d1 e9 fd df  |.....75..9......|
+00000010  51 41 05 c7 09 9d eb ce  4d 3e cc 43 8c cd 13 e5  |QA......M>.C....|
+00000020  50 3c 01 ff 20 c4 af c7  12 7d 8c 2b 17 99 45 44  |P<.. ....}.+..ED|
+00000030  dc 44 9c b8 bd 8c eb 3b  ef bb da cf e9 a4 ad 7e  |.D.....;.......~|
+00000040  29 ca 33 90 f9 60 15 5e  b4 60 fe 70 77 38 1b 62  |).3..`.^.`.pw8.b|
+00000050  2e 78 43 fc 2d 8e 8f ad  94 26 05 e5 8b 61 bb 5d  |.xC.-....&...a.]|
+00000060  e1 b5 64 e1 8c 99 c2 f4  2d 35 4d 76 1c ba 20 34  |..d.....-5Mv.. 4|
+00000070  22 69 cb f4 9c 76 24 03  f0 c6 40 40 e8 c3 cb 76  |"i...v$...@@...v|
+00000080  80 1d 5e 0c d8 6f 74 d7  20 e3 d7 97 56 1b 49 11  |..^..ot. ...V.I.|
+00000090  79 1f b9 b5 56 45 11 b5  8b 79 e4 a8 98 0b 97 1d  |y...VE...y......|
+000000a0  4b 3a 4a 71 82 b1 7a 14  20 c0 6a ff 07 87 65 01  |K:Jq..z. .j...e.|
+000000b0  e4 21 c1 e4 80 e3 9e 76  79 59 63 ad 45 ca 3c 1a  |.!.....vyYc.E.<.|
+000000c0  ef 35 38 0d c6 c4 f3 c1  84 c5 d3 fd 5f 67 30 78  |.58........._g0x|
+000000d0  7a a1 60 da 17 fe 60 97  66 2d a0 0c 9e 8d 28 00  |z.`...`.f-....(.|
+000000e0  a4 d9 14 e3 74 c7 1c 1f  ca ec 8a 56 87 03 9a a4  |....t......V....|
+000000f0  f1 47 16 65 ba 2f dc c9  d7 c4 1a 38 cb 1e 78 bf  |.G.e./.....8..x.|
+00000100  02 9a 0c 60 1c 52 a5 d2  8b 24 75 2d ea 6a 9f f2  |...`.R...$u-.j..|
+00000110  4d 94 82 0d 89 f3 ec 3c  4b 53 c4 21 2e 09 f4 14  |M......<KS.!....|
+00000120  e4 ea 10 7a 88 92 08 15  64 ab 1c 18 a4 9f c2 40  |...z....d......@|
+00000130  68 2a d2 9e 20 49 ae 04  58 58 4d 64 d7 2d d3 33  |h*.. I..XXMd.-.3|
+00000140  8d 0a 36 80 8f 88 e0 aa  0b 2a 47 b6 45 65 6a a0  |..6......*G.Eej.|
+00000150  04 d6 dd ce 1b 0f 12 e5  12 0e fe a0 28 55 38 92  |............(U8.|
+00000160  e3 e0 7a 02 e9 35 49 77  19 7f 3c 01 c3 23 68 31  |..z..5Iw..<..#h1|
+00000170  4a 10 91 e9 15 77 d0 e0  98 b0 8b d1 12 59 f9 1e  |J....w.......Y..|
+00000180  8a 2e 35 c9 47 61 a0 99  07 46 c7 e7 ef 6a f8 04  |..5.Ga...F...j..|
+00000190  8a 8b b0 d1 15 4e cb 1c  fa 18 98 d0 bc d9 26 c4  |.....N........&.|
+000001a0  f1 2f 7d c6 ce 4c 93 ef  d3 72 bf 77 61 41 f5 55  |./}..L...r.waA.U|
+000001b0  90 82 66 7f d8 fa 49 53  1b 51 8d 32 c5 ad b0 dc  |..f...IS.Q.2....|
+000001c0  d5 fd e1 c5 3d ef 54 1a  a6 5a 5b bc ed 3f b1 2f  |....=.T..Z[..?./|
+000001d0  fc bd c3 69 4b 29 a9 ff  2d 6a 6e a2 10 8c 33 88  |...iK)..-jn...3.|
+000001e0  83 d7 3d 9e 05 62 c2 21  d2 dd 7c cd ab 00 2a c9  |..=..b.!..|...*.|
+000001f0  01 c4 c2 78 a3 47 de 74  97 12 be 53 dd 9f c1 9b  |...x.G.t...S....|
+00000200  4e 12 51 62 a4 9f db e9  c7 15 02 b3 c9 e4 a3 90  |N.Qb............|
+00000210  64 2d 03 2f 02 06 9a 96  e0 02 c8 90 3d 48 06 08  |d-./........=H..|
+00000220  a7 4a dd df 71 3e 0b 7b  a6 c2 c3 7c b8 00 61 00  |.J..q>.{...|..a.|
+00000230  f8 7f d5 3f 8a 8a b2 0a  43 3a f3 9a d2 59 8d d1  |...?....C:...Y..|
+00000240  f4 c4 8f 80 99 0e 3b 20  6c cf e0 0f 28 2c e0 e8  |......; l...(,..|
+00000250  a8 5d 65 d4 86 f9 8b 9a  d1 84 69 67 c7 f7 6b 9c  |.]e.......ig..k.|
+00000260  5f 3e 6e 4c 1a 8f b9 5a  ee 85 d0 69 3b f9 04 99  |_>nL...Z...i;...|
+00000270  bf fa e2 78 4e 17 3a 09  5c 14 b6 44 36 d3 00 c1  |...xN.:.\..D6...|
+00000280  8d 92 4d 65 e7 95 dd 1f  fb 17 db 81 3a 17 03 03  |..Me........:...|
+00000290  00 1e 62 74 85 c4 e9 2c  03 e1 15 aa 5d 88 6f 6d  |..bt...,....].om|
+000002a0  37 14 03 95 8a 1c 92 cf  af 4d 74 63 45 04 17 7e  |7........MtcE..~|
+000002b0  17 03 03 00 13 fa d4 9b  84 ee 23 28 9d c1 dc 9a  |..........#(....|
+000002c0  65 57 aa 60 7d b5 b1 e4                           |eW.`}...|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndEd25519Given b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndEd25519Given
index 731e892605..be56144bc0 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndEd25519Given
+++ b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndEd25519Given
@@ -1,149 +1,148 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 8e 65 2c 25 90  |............e,%.|
-00000010  2c f6 3b 40 a0 58 aa 9f  ec 27 f7 28 a7 46 a4 e2  |,.;@.X...'.(.F..|
-00000020  c5 b8 2e ae d7 d6 bf 25  b5 40 f4 20 a6 cf 1d 38  |.......%.@. ...8|
-00000030  04 15 40 3b c7 b9 e2 59  0a 48 ef 35 14 39 a2 37  |..@;...Y.H.5.9.7|
-00000040  ff 10 2d 8a 14 82 4d c7  bb 55 b1 1d 00 04 13 01  |..-...M..U......|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 62 ae 5f 44 f6  |...........b._D.|
+00000010  c3 54 4a 63 db 30 69 83  f2 96 c7 b7 bc 19 f4 49  |.TJc.0i........I|
+00000020  88 d5 c3 a3 3d 67 07 f3  ac 3b 84 20 04 ef b9 10  |....=g...;. ....|
+00000030  d6 69 4e 8f a1 a0 29 bf  b0 15 dc a5 2e 7d 1d 62  |.iN...)......}.b|
+00000040  95 3f d0 96 86 71 73 04  58 00 80 2b 00 04 13 01  |.?...qs.X..+....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 3f  |-.....3.&.$... ?|
-000000b0  e9 0f b3 c9 2c 2e 90 69  cb 26 6e ef 30 4e 8c 0c  |....,..i.&n.0N..|
-000000c0  de 4d aa 26 04 67 6e bb  ef b0 c8 8e 4f 0b 15     |.M.&.gn.....O..|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 42  |-.....3.&.$... B|
+000000b0  c8 9c c5 22 39 3d 6d 08  da e2 33 f7 42 2b 78 71  |..."9=m...3.B+xq|
+000000c0  61 7d 82 e4 01 52 a0 a2  89 bf 59 67 23 50 34     |a}...R....Yg#P4|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 a6 cf 1d 38  |........... ...8|
-00000030  04 15 40 3b c7 b9 e2 59  0a 48 ef 35 14 39 a2 37  |..@;...Y.H.5.9.7|
-00000040  ff 10 2d 8a 14 82 4d c7  bb 55 b1 1d 13 01 00 00  |..-...M..U......|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 04 ef b9 10  |........... ....|
+00000030  d6 69 4e 8f a1 a0 29 bf  b0 15 dc a5 2e 7d 1d 62  |.iN...)......}.b|
+00000040  95 3f d0 96 86 71 73 04  58 00 80 2b 13 01 00 00  |.?...qs.X..+....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 b4 57 fb a1 f4 24  |...........W...$|
-00000090  99 a4 eb ab 7b 09 31 b6  b1 89 4b 17 da 64 4b b6  |....{.1...K..dK.|
-000000a0  7d 17 03 03 00 3e 5e 69  bb 28 4e b0 ba d6 31 ab  |}....>^i.(N...1.|
-000000b0  05 ad e9 f3 34 dc bb 28  41 45 42 26 cc 02 f2 2b  |....4..(AEB&...+|
-000000c0  96 66 3d cf b2 dd 89 7a  40 f8 44 cb 1e b8 52 01  |.f=....z@.D...R.|
-000000d0  82 ed 90 97 26 54 76 95  2b 69 a0 c6 95 bd e2 5a  |....&Tv.+i.....Z|
-000000e0  2b 90 a1 da 17 03 03 02  6d 29 de 48 a1 af 3a 16  |+.......m).H..:.|
-000000f0  e9 51 34 34 0c 56 11 cd  4a 80 88 27 40 01 6e 9a  |.Q44.V..J..'@.n.|
-00000100  d3 cc dc 76 00 1f cc 3f  b4 d0 8b e8 5e d5 8e 28  |...v...?....^..(|
-00000110  f1 b5 46 ba f6 c0 26 3e  bf f1 98 0c 07 6b 34 a7  |..F...&>.....k4.|
-00000120  a4 35 92 47 a7 58 07 b3  7b 0e 17 fb 4f 4d 39 c1  |.5.G.X..{...OM9.|
-00000130  8c 69 56 2f 7c eb 39 17  66 1e ab bc 0f f8 3f bd  |.iV/|.9.f.....?.|
-00000140  33 40 ac ed 6f 2c cd 45  5a fa 2b c6 b5 2c b5 46  |3@..o,.EZ.+..,.F|
-00000150  2b 53 7b 5b 61 be c1 78  19 81 58 27 f5 2f a7 04  |+S{[a..x..X'./..|
-00000160  8d ef 67 11 7c d0 42 14  c6 c2 84 f8 d4 ee 4e 68  |..g.|.B.......Nh|
-00000170  d6 de a9 32 a3 5d b0 e1  44 4d 1d 29 e5 39 82 27  |...2.]..DM.).9.'|
-00000180  43 ba 5c 55 eb 70 64 70  ef a1 57 90 a6 82 62 c5  |C.\U.pdp..W...b.|
-00000190  a4 f5 be 35 6d 00 4a b6  2e ac 93 65 ad 85 f4 94  |...5m.J....e....|
-000001a0  40 10 8f 6a 59 ab 54 18  c4 fb e3 97 29 9e ed 3e  |@..jY.T.....)..>|
-000001b0  4b 35 dc c4 38 e3 d1 0f  6e cb b9 65 b3 b2 e3 f4  |K5..8...n..e....|
-000001c0  d7 05 df b4 33 7d 26 6f  9b 6b 58 33 b3 86 a4 1c  |....3}&o.kX3....|
-000001d0  7b 5e a6 2e 2b 2e ca 99  ad 28 28 87 0b c1 05 75  |{^..+....((....u|
-000001e0  dd e4 e2 d2 66 13 a5 a6  b2 d9 21 4d 7d d6 59 80  |....f.....!M}.Y.|
-000001f0  7a fd fe 66 9e c1 0a fc  9a a3 60 66 28 73 34 db  |z..f......`f(s4.|
-00000200  17 0f 3d fd 22 53 e7 c7  74 69 34 ab 5d bd b5 e5  |..=."S..ti4.]...|
-00000210  59 c8 d6 44 85 07 df 98  25 41 27 65 2a c2 54 5b  |Y..D....%A'e*.T[|
-00000220  94 8a 07 96 fe 7b 03 eb  37 10 f2 37 30 6b 3e 69  |.....{..7..70k>i|
-00000230  2a c8 3d 48 15 7e 6b 04  58 ed 1f 59 ad e6 8b b2  |*.=H.~k.X..Y....|
-00000240  7e 43 61 a8 a2 3e b7 c9  b5 86 cb be 8a f0 c4 15  |~Ca..>..........|
-00000250  c9 ef 7f e8 d9 3a ca c5  57 dc 6a 85 bb 6b 7b ca  |.....:..W.j..k{.|
-00000260  e9 20 5a 0c 5e b9 7c f7  07 fb 9a 62 c0 13 08 c4  |. Z.^.|....b....|
-00000270  87 69 61 c1 54 22 e0 43  9e 1e 8f 0f 2e 01 6e 36  |.ia.T".C......n6|
-00000280  85 13 23 41 22 4d 27 f0  1c 7c 12 78 9f 9a 88 ee  |..#A"M'..|.x....|
-00000290  0f 2c 8b bd 3d fb 24 67  72 ef 06 50 1e 25 f9 b5  |.,..=.$gr..P.%..|
-000002a0  ec d6 dc 13 8e 44 7e 15  25 f3 9f e9 c4 d8 2d 15  |.....D~.%.....-.|
-000002b0  f4 06 24 02 2c 24 f2 6e  6e b7 01 b7 92 6d 0b d5  |..$.,$.nn....m..|
-000002c0  df 4b 45 41 b9 86 f9 94  b1 38 d8 3d cd 2e 50 de  |.KEA.....8.=..P.|
-000002d0  32 ed 90 c5 f4 f7 ce 00  fa c5 07 6d de 24 54 78  |2..........m.$Tx|
-000002e0  bc 30 e5 a5 70 21 e8 4f  3b 1d ab d9 25 71 72 2f  |.0..p!.O;...%qr/|
-000002f0  06 6b 7a fc 4c c9 68 18  7a e8 08 31 5e 1d 53 d6  |.kz.L.h.z..1^.S.|
-00000300  e4 cb b2 f7 cb cc 65 93  63 64 a2 e9 56 40 51 ba  |......e.cd..V@Q.|
-00000310  29 e2 4b 27 8e dc 93 ac  12 63 18 6e 64 18 c0 03  |).K'.....c.nd...|
-00000320  51 5c bc b3 a7 29 f9 75  db c7 aa c1 d2 1a 40 31  |Q\...).u......@1|
-00000330  84 42 9b 9f c0 1c 4f 38  0d 4b 4d e9 1c 04 e7 da  |.B....O8.KM.....|
-00000340  6d 16 fd dc bb e8 8f 3b  d1 1d 6c 2f b2 53 39 86  |m......;..l/.S9.|
-00000350  b3 35 15 e9 a2 73 17 03  03 00 99 fd a2 ed e7 c5  |.5...s..........|
-00000360  1a ab b7 a2 dd 3b fc f6  35 ce 53 26 84 2f e0 da  |.....;..5.S&./..|
-00000370  a6 8b 5b e8 67 77 46 7f  0d 92 64 17 48 8e cc 78  |..[.gwF...d.H..x|
-00000380  fc d4 8e 1d b4 2c 26 07  72 2d 37 da 63 74 63 a0  |.....,&.r-7.ctc.|
-00000390  7f e6 59 fc cb a3 8a 8c  17 9e 09 71 fa 1a 61 cd  |..Y........q..a.|
-000003a0  86 bf e3 4c f4 cc 75 c1  dc 46 d9 fc a2 f6 c0 a2  |...L..u..F......|
-000003b0  db f0 db ce 29 5a c4 d0  ad a2 48 ce e7 ce 22 be  |....)Z....H...".|
-000003c0  9c 14 13 26 4a ff 00 0e  95 3b f3 04 db ca dd 95  |...&J....;......|
-000003d0  df c8 3e cf ee b9 80 8b  94 b8 3e eb 26 97 98 0e  |..>.......>.&...|
-000003e0  45 31 78 33 81 f5 8c 00  7d 7f e2 9d 3d 21 35 6f  |E1x3....}...=!5o|
-000003f0  1e 96 79 15 17 03 03 00  35 4c 9d a6 ed 2a bf 17  |..y.....5L...*..|
-00000400  cf 84 47 3b 89 86 55 75  bf 5b 81 6e 9f cd 5d c2  |..G;..Uu.[.n..].|
-00000410  e8 7e 46 ad 96 4f 84 f3  6a 8a 47 61 54 29 09 d7  |.~F..O..j.GaT)..|
-00000420  36 ef d7 40 e5 10 ee 2c  b6 49 e0 85 80 fa        |6..@...,.I....|
+00000080  03 03 00 01 01 17 03 03  00 17 ed 94 e7 9c 3e 09  |..............>.|
+00000090  08 37 6f c3 1e 1b e9 03  8e a1 52 0b b2 be f7 8a  |.7o.......R.....|
+000000a0  e7 17 03 03 00 3e c3 5a  5e ae 8b 65 5a ac a8 da  |.....>.Z^..eZ...|
+000000b0  05 88 d3 6b b8 60 a9 ac  0a 70 81 17 8c 30 da ec  |...k.`...p...0..|
+000000c0  95 44 4d 4c 7b 18 4a 6c  3f 2d 12 10 00 cb 6b 38  |.DML{.Jl?-....k8|
+000000d0  b1 90 b7 0a 44 aa 96 ee  b9 90 bc e1 db 67 f4 7c  |....D........g.||
+000000e0  df 76 90 de 17 03 03 02  6d ba 79 8b 11 20 c9 b0  |.v......m.y.. ..|
+000000f0  90 bd 4e 75 8f 1b 8f c9  7c 26 b4 2a 88 76 66 e2  |..Nu....|&.*.vf.|
+00000100  af 95 c2 f0 d6 54 ce 12  34 5e ea 5a a7 51 fe fc  |.....T..4^.Z.Q..|
+00000110  c3 7d 27 85 34 d4 6d cd  eb 6d 00 72 a9 df 79 7b  |.}'.4.m..m.r..y{|
+00000120  ac ba 9f 72 d9 c2 8a e7  36 ce f2 19 a8 b3 58 ae  |...r....6.....X.|
+00000130  8c 0f 9c be d8 92 a4 9f  d7 06 d4 fc 4b 73 99 e0  |............Ks..|
+00000140  81 10 83 ed ce 76 07 f5  30 94 9a 19 68 d9 76 a9  |.....v..0...h.v.|
+00000150  c1 c4 3f 0f 76 ab 8f 71  7c bf dc 9d 52 0f f0 b5  |..?.v..q|...R...|
+00000160  81 cf 94 50 20 dc 83 76  fd ea ef 59 17 f0 cd 6f  |...P ..v...Y...o|
+00000170  1b e6 4c 94 4b fb d9 f0  2f 69 d6 69 8a 82 65 fc  |..L.K.../i.i..e.|
+00000180  35 63 c0 5b 7a d2 e3 d9  f6 02 98 59 61 82 29 30  |5c.[z......Ya.)0|
+00000190  cf 74 84 19 e7 93 29 43  99 44 5a b4 d4 5a 1a a0  |.t....)C.DZ..Z..|
+000001a0  12 f8 88 ea 21 f5 9f f2  78 c9 a0 19 ca e7 24 5e  |....!...x.....$^|
+000001b0  ce 64 c2 b6 02 ee d2 7b  32 cd 00 bb 80 35 04 da  |.d.....{2....5..|
+000001c0  48 3a a5 0f 7d b4 7d b5  6c a0 ce ad 54 af 15 83  |H:..}.}.l...T...|
+000001d0  79 51 93 bd fc 33 6c 42  c3 eb 95 b7 0e de 3d 61  |yQ...3lB......=a|
+000001e0  51 8f de 38 22 ea f2 77  35 42 cd dc 36 51 6b 91  |Q..8"..w5B..6Qk.|
+000001f0  48 af a3 45 65 a2 d0 59  cd 2e 0d 11 30 dc 22 fd  |H..Ee..Y....0.".|
+00000200  a9 b1 a0 bd 2b 83 c9 cf  7e 2e 1f 0f 78 72 0b a1  |....+...~...xr..|
+00000210  d5 1f d0 9f 92 a2 a4 cd  c1 55 de 2f 07 14 a3 82  |.........U./....|
+00000220  a2 04 30 bd b2 47 d3 5c  67 12 40 3c 15 c1 bc f5  |..0..G.\g.@<....|
+00000230  24 ff c5 19 b4 ba f7 f7  08 4e 0b cc fd 05 a3 ba  |$........N......|
+00000240  b6 f4 55 59 d5 90 7f 07  a6 8f 60 6e 54 1c cb ae  |..UY......`nT...|
+00000250  a9 7f 80 9a e4 ce 9b df  9e be f8 0b 30 81 e2 2f  |............0../|
+00000260  8a 9c 10 f7 5c 46 41 97  28 f0 91 55 df b9 4e b3  |....\FA.(..U..N.|
+00000270  13 91 65 ef bd 3b 82 61  1f 6f 72 6c 40 fc ea 97  |..e..;.a.orl@...|
+00000280  2f e5 45 32 82 5a 44 fb  9e 2f 94 cc 3f ff ab 6f  |/.E2.ZD../..?..o|
+00000290  b4 79 52 f1 b8 a2 b3 0d  2e d0 06 b0 09 e7 ea 23  |.yR............#|
+000002a0  83 a9 c7 f7 ff ad fa 91  33 1d 86 e9 21 63 ab 4b  |........3...!c.K|
+000002b0  8d 58 20 14 ca 73 1e 75  cb ae b2 7b 71 f0 ae 5f  |.X ..s.u...{q.._|
+000002c0  eb a4 12 74 ac 71 48 c5  b3 1d 7f a6 0c f8 5c 41  |...t.qH.......\A|
+000002d0  25 e4 2a fc 1b b6 54 90  ce 33 12 a8 45 ab 69 d9  |%.*...T..3..E.i.|
+000002e0  71 44 8e c6 e9 ef 63 ea  f8 86 db 45 a3 de 2d 8f  |qD....c....E..-.|
+000002f0  b8 d0 49 d1 30 77 0c 7a  87 61 94 51 6b f2 8f 11  |..I.0w.z.a.Qk...|
+00000300  1d 69 b3 f9 fb c3 cf be  94 19 3f 44 ab c0 62 d3  |.i........?D..b.|
+00000310  8a c1 c2 c9 a6 b1 84 39  2b 88 16 d0 ed 8a 12 bb  |.......9+.......|
+00000320  10 e5 1e ac bd 00 c7 90  4d 6c 85 76 4e 52 51 0b  |........Ml.vNRQ.|
+00000330  ff cb e3 cc 41 03 8f f0  a6 67 dd 73 bd 4f d9 93  |....A....g.s.O..|
+00000340  17 43 7d f7 a1 78 3d 57  83 8f 2b 7d aa 39 f1 1c  |.C}..x=W..+}.9..|
+00000350  e0 4f 2a cc 2b 6b 17 03  03 00 99 1e b6 4c 92 ac  |.O*.+k.......L..|
+00000360  c8 4b 75 d5 bc 89 4f 5e  e0 30 8f cb 16 51 d0 9c  |.Ku...O^.0...Q..|
+00000370  1a c4 22 d6 1d a2 be 12  92 df 55 6d ad 79 63 88  |..".......Um.yc.|
+00000380  32 52 a2 cd 4b 24 34 79  df 87 c5 f7 76 33 7a 31  |2R..K$4y....v3z1|
+00000390  67 33 f8 3d 89 dc 64 09  2e d1 98 e3 91 43 28 90  |g3.=..d......C(.|
+000003a0  09 4b 62 6a 77 28 08 45  51 07 24 75 78 09 fb 5b  |.Kbjw(.EQ.$ux..[|
+000003b0  6a f9 79 34 7f a9 f3 8f  a6 7f 31 40 cc d4 d9 33  |j.y4......1@...3|
+000003c0  d2 2d 76 13 03 d0 ef ef  fb 63 0e 1a dd a6 cf 09  |.-v......c......|
+000003d0  3f 94 32 86 d3 da b2 6a  a5 e9 0c fb 08 f1 e9 1f  |?.2....j........|
+000003e0  70 e6 95 af f0 7a d2 ac  ed ee d1 07 d9 70 97 f4  |p....z.......p..|
+000003f0  be 47 58 e5 17 03 03 00  35 c9 c7 f8 b2 c3 64 99  |.GX.....5.....d.|
+00000400  21 57 39 ee 98 4a ed 82  5c 51 60 49 7e a4 58 43  |!W9..J..\Q`I~.XC|
+00000410  04 39 d5 76 26 8d 5b 9c  7a 05 de df f1 c0 42 e3  |.9.v&.[.z.....B.|
+00000420  a5 64 64 16 be d4 b1 0e  77 ae 08 cc 47 78        |.dd.....w...Gx|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 01 50 65 76 76 e6 2f  |..........Pevv./|
-00000010  27 74 6e 8d 11 6b 90 df  19 90 5e a2 7e 57 73 76  |'tn..k....^.~Wsv|
-00000020  4c f2 53 a2 ec 04 6f ae  3b ad a5 4b a2 14 93 00  |L.S...o.;..K....|
-00000030  86 56 09 5b 83 03 f6 ec  36 3f 45 8d 44 bd a9 3b  |.V.[....6?E.D..;|
-00000040  16 76 97 da 30 5b 91 4c  90 d6 6e 14 55 63 3b 0d  |.v..0[.L..n.Uc;.|
-00000050  b5 3e e1 53 8e 5a 01 17  b8 02 7f ea 63 2b 1e 14  |.>.S.Z......c+..|
-00000060  be c6 46 6a b9 5a 13 b5  ee a6 6c ce 02 cf aa c5  |..Fj.Z....l.....|
-00000070  48 0b 32 76 db 8f a7 c7  c8 ad 5c 51 bc c2 ea c5  |H.2v......\Q....|
-00000080  6e d5 b7 f9 2a 9c 45 20  9b 67 52 7f 7f e7 c6 41  |n...*.E .gR....A|
-00000090  00 e9 3a c2 1d 28 3d 24  56 66 bf 96 09 ae 15 2d  |..:..(=$Vf.....-|
-000000a0  eb ea ae ad 94 5e 20 34  05 df b6 1e 0f 03 7f 15  |.....^ 4........|
-000000b0  4c 41 84 07 51 ba 91 b7  68 21 e1 0b b8 30 e6 10  |LA..Q...h!...0..|
-000000c0  8d 30 cd 07 79 09 8e 5f  a7 65 a5 8d a3 28 27 09  |.0..y.._.e...('.|
-000000d0  98 da d5 64 b9 69 e7 30  d4 bc f6 11 5d 64 4b 03  |...d.i.0....]dK.|
-000000e0  0b 5d f5 d5 09 d1 04 d2  d5 37 c2 01 1a a8 b2 c1  |.].......7......|
-000000f0  95 9b 3f 05 eb 3e 19 7c  72 9e 86 b0 a8 9e 18 8d  |..?..>.|r.......|
-00000100  58 c4 d2 14 c8 c1 c1 81  1c 2d 74 48 2e 60 61 24  |X........-tH.`a$|
-00000110  81 99 da dd 81 b3 85 3a  61 0f a0 94 b4 31 93 90  |.......:a....1..|
-00000120  1d 25 62 ff 0d 75 bd 5b  e5 d6 c8 9a cb 9c 2b 45  |.%b..u.[......+E|
-00000130  0e 9a 28 2d 4c dc 84 9c  18 7f 17 a2 f2 73 1c f9  |..(-L........s..|
-00000140  b7 06 09 e9 ec 88 14 98  24 e6 9b 97 15 f3 6f 2b  |........$.....o+|
-00000150  46 ea 0d 25 33 df 98 c4  b4 cb 9f 17 03 03 00 59  |F..%3..........Y|
-00000160  61 d9 d3 a8 1a 90 27 11  31 be 80 dd 5a 2a fa 58  |a.....'.1...Z*.X|
-00000170  f6 1e cc 2e 5e 1d 17 4b  83 cf d7 fb c7 59 83 19  |....^..K.....Y..|
-00000180  65 91 7c ef 91 3d 0d b5  a7 10 a7 52 3d 5c 4a d7  |e.|..=.....R=\J.|
-00000190  b9 39 a2 f4 8b 5d ad f9  56 38 22 1f 87 04 af 62  |.9...]..V8"....b|
-000001a0  9f 89 b8 b5 1f a4 62 0c  11 55 3b 9e 45 b3 50 0b  |......b..U;.E.P.|
-000001b0  fc 00 92 64 84 57 72 81  d9 17 03 03 00 35 a1 d4  |...d.Wr......5..|
-000001c0  05 18 56 a4 68 81 33 f0  05 16 7a cf 14 2f 1e 74  |..V.h.3...z../.t|
-000001d0  06 fa 36 49 2c a5 d5 db  7a cc 06 8c c1 05 60 4c  |..6I,...z.....`L|
-000001e0  c7 97 81 7c ff fd 9e 82  ba 84 58 64 31 27 82 72  |...|......Xd1'.r|
-000001f0  8c d0 d7 17 03 03 00 13  0c 0b 27 77 f3 bb 57 99  |..........'w..W.|
-00000200  d3 2c 28 bd 95 2f fb 77  26 a6 52                 |.,(../.w&.R|
+00000000  14 03 03 00 01 01 17 03  03 01 50 53 2b 93 12 3b  |..........PS+..;|
+00000010  75 08 e2 55 50 25 dd 18  3a f6 52 90 17 e9 c2 5a  |u..UP%..:.R....Z|
+00000020  f1 c8 3f 10 3e a7 bc 45  e7 75 fa 19 40 20 f6 f1  |..?.>..E.u..@ ..|
+00000030  95 59 3b 24 b9 ba 85 e6  4d d7 95 b8 31 b9 b7 b9  |.Y;$....M...1...|
+00000040  a3 d2 cf 23 0d 48 21 94  3b 83 95 53 a7 23 ea ad  |...#.H!.;..S.#..|
+00000050  c5 1a 8a 8f 3c f5 3f 10  1f f3 cb 5b f2 66 80 a7  |....<.?....[.f..|
+00000060  23 49 5b 1a 56 cb f6 ed  0a f3 ba 17 01 82 11 40  |#I[.V..........@|
+00000070  d1 b0 e3 c0 ab 5d e1 23  4d f6 b8 bd 04 3c 8f d0  |.....].#M....<..|
+00000080  4b 96 ee f5 f0 81 a3 c3  d0 66 1d 9c f6 ee 01 dc  |K........f......|
+00000090  8b e7 d8 75 20 95 6f 6c  6f 4b 79 3b dd 40 b9 c4  |...u .oloKy;.@..|
+000000a0  e6 f9 5c 54 59 51 6d de  55 6d 28 15 8c 34 b1 cb  |..\TYQm.Um(..4..|
+000000b0  2a 22 7a 83 68 65 1e 43  78 65 4d 20 b5 59 29 95  |*"z.he.CxeM .Y).|
+000000c0  97 16 7a b5 8d 1d 55 f2  37 11 08 56 df 52 d3 71  |..z...U.7..V.R.q|
+000000d0  80 5b fd 84 4b ef 6d 14  c0 82 32 8e 16 63 3d 26  |.[..K.m...2..c=&|
+000000e0  38 16 93 f4 50 35 ca db  1e f3 ba 42 ba 4f b7 03  |8...P5.....B.O..|
+000000f0  fb 60 68 44 6a 87 bd 07  d0 4a 73 76 06 a1 97 d5  |.`hDj....Jsv....|
+00000100  9d ca d2 f1 5d 94 50 e0  05 15 8e e2 56 f9 7e db  |....].P.....V.~.|
+00000110  5c 39 d7 30 87 fb 35 c2  2f f4 f5 a0 0b 7d 52 86  |\9.0..5./....}R.|
+00000120  b2 f0 ce b7 79 19 8c 84  4f 5b 7a 59 c9 c1 c2 f1  |....y...O[zY....|
+00000130  a0 e9 57 48 15 06 40 44  e1 db 79 03 4d fb 24 76  |..WH..@D..y.M.$v|
+00000140  12 ac dd b1 e7 08 c8 23  f5 72 51 79 18 10 a7 32  |.......#.rQy...2|
+00000150  81 7d 6d c2 a8 a1 25 e7  29 62 1c 17 03 03 00 59  |.}m...%.)b.....Y|
+00000160  86 a6 b4 1c 89 81 e9 8d  59 0f 04 13 39 3f 41 fc  |........Y...9?A.|
+00000170  90 b3 bb e2 b7 89 85 54  f5 99 67 d3 67 1f 3c 2d  |.......T..g.g.<-|
+00000180  1d bb d2 5f 50 0d 4e a3  34 44 cf 4d d6 ed 4c 6c  |..._P.N.4D.M..Ll|
+00000190  f0 c2 1a 56 8f e4 03 cd  2b 29 a1 8e 21 8b 09 96  |...V....+)..!...|
+000001a0  c9 57 c7 82 dd 24 bb dd  9c c6 4e eb e0 8f 33 b1  |.W...$....N...3.|
+000001b0  51 b2 70 92 51 87 4f c5  68 17 03 03 00 35 e9 59  |Q.p.Q.O.h....5.Y|
+000001c0  1e 8b b4 91 a9 ae 45 ca  d3 63 8d bf 13 af 88 9b  |......E..c......|
+000001d0  8d dc 56 df 6b 64 a6 d1  4d dd 3a 97 90 7d e3 02  |..V.kd..M.:..}..|
+000001e0  30 49 5d 2d b5 22 92 bd  d4 03 35 d5 cf 49 c0 f7  |0I]-."....5..I..|
+000001f0  11 92 08                                          |...|
 >>> Flow 4 (server to client)
-00000000  17 03 03 01 ba 6d d5 ba  b6 7a 4e c9 c4 1a ff e9  |.....m...zN.....|
-00000010  cf 84 4c 47 b3 bd 21 a4  c7 f9 f1 a2 98 93 23 53  |..LG..!.......#S|
-00000020  35 38 97 25 d2 d2 0e 67  79 a4 48 ad d3 97 6a 7b  |58.%...gy.H...j{|
-00000030  09 10 1b 96 12 5d b3 bb  5f a2 47 90 ba 5f 4f b8  |.....].._.G.._O.|
-00000040  67 40 df 14 c5 83 48 54  da 36 d2 6a bc de 62 53  |g@....HT.6.j..bS|
-00000050  22 75 77 08 5e f0 bf 7a  5c 2a eb 1f 63 ce 26 0c  |"uw.^..z\*..c.&.|
-00000060  5f c9 6d c9 8f 94 02 de  31 ce 7f 8a 34 8b c2 7c  |_.m.....1...4..||
-00000070  6c f4 3e 0a c6 80 d8 3e  9e 87 2c 2a f8 72 64 6a  |l.>....>..,*.rdj|
-00000080  09 73 62 c4 ed 86 23 e6  14 a5 14 24 44 4c 2a 37  |.sb...#....$DL*7|
-00000090  d6 38 1d 12 6b 7a 0a 57  8e 88 6d f2 79 7a 75 3f  |.8..kz.W..m.yzu?|
-000000a0  0d e8 dc 57 10 80 bc f4  11 c7 b6 3c db 76 d2 9c  |...W.......<.v..|
-000000b0  08 b4 79 3e 11 a6 15 0a  4b a9 79 24 91 9a 50 ce  |..y>....K.y$..P.|
-000000c0  20 83 ac 97 f1 27 eb 2a  54 9e e3 82 35 07 91 aa  | ....'.*T...5...|
-000000d0  61 3b 64 2c ee e0 6d d4  93 82 63 a7 ed b0 d8 cd  |a;d,..m...c.....|
-000000e0  10 f6 3f 15 b4 a3 08 96  41 03 6d ba 0a b1 f9 e1  |..?.....A.m.....|
-000000f0  8a b0 26 99 33 40 4a d0  b1 d0 38 3d 05 4d be 62  |..&.3@J...8=.M.b|
-00000100  eb c6 46 ce 6f d2 3c d5  54 5c 84 49 b9 d8 de 06  |..F.o.<.T\.I....|
-00000110  1f 5c 4b e5 ea d7 fb 7e  b4 16 81 e4 5b e8 73 99  |.\K....~....[.s.|
-00000120  93 23 48 51 67 53 e0 c9  2c 4f 10 bc 89 aa 34 97  |.#HQgS..,O....4.|
-00000130  9b 2b 37 2c 01 ea bb 06  d1 a5 ff 41 c4 f9 33 ad  |.+7,.......A..3.|
-00000140  e1 df 63 51 4c 17 6a 9c  c3 95 61 83 81 22 e3 02  |..cQL.j...a.."..|
-00000150  90 d1 d2 9c d4 03 a8 4a  f0 fc 30 a8 06 8c 24 2b  |.......J..0...$+|
-00000160  70 8d d6 ca 70 5b 83 81  6b 6d 0d 4a d4 c2 b7 f1  |p...p[..km.J....|
-00000170  1e 85 65 4e 52 e7 d0 ba  60 87 6b 21 5d d6 ee 5b  |..eNR...`.k!]..[|
-00000180  2c 1e 00 83 9d a8 14 bd  df c9 fc 6f 6e dd 41 9f  |,..........on.A.|
-00000190  3a ab d8 70 4a 6c 68 3f  c3 ba 02 34 e1 a8 a7 80  |:..pJlh?...4....|
-000001a0  08 91 e3 2e 2e bd 04 d9  1f d2 30 17 2e e2 71 5a  |..........0...qZ|
-000001b0  d9 21 8b 22 8c 16 9d e7  77 40 28 9a ad f6 0c 17  |.!."....w@(.....|
-000001c0  03 03 00 1e 53 61 12 3f  61 24 db 4f 65 9f 7d b3  |....Sa.?a$.Oe.}.|
-000001d0  65 2b 43 89 a1 bc f0 df  a1 59 e4 e5 c0 ed 95 d4  |e+C......Y......|
-000001e0  f9 a3 17 03 03 00 13 5c  7c 76 1f 85 7c f3 67 cc  |.......\|v..|.g.|
-000001f0  9d 82 fc bb 6d 48 58 5a  b5 a9                    |....mHXZ..|
+00000000  17 03 03 01 ba 94 c4 43  f5 51 a5 71 68 4e 92 4a  |.......C.Q.qhN.J|
+00000010  e8 d7 ed 38 67 73 ec 59  30 17 d2 f8 c4 c3 b1 44  |...8gs.Y0......D|
+00000020  2d e4 7d 8a cf 15 3a c8  29 6d ba dc e3 cd 02 29  |-.}...:.)m.....)|
+00000030  a1 15 99 4d 10 a0 5e be  24 ae 39 ca f5 9d a6 0f  |...M..^.$.9.....|
+00000040  a1 87 1e 49 71 86 41 70  a2 93 6b a6 9c 4a 8a b6  |...Iq.Ap..k..J..|
+00000050  48 f7 1d 73 ad ac 68 36  de 36 0d 99 45 bc f5 6a  |H..s..h6.6..E..j|
+00000060  4a 17 16 21 17 1c f7 75  a6 4f d8 ff 6d f4 93 29  |J..!...u.O..m..)|
+00000070  ad 5c 68 b7 0d bb b1 47  74 84 a1 90 7a 70 c4 0c  |.\h....Gt...zp..|
+00000080  4b 77 36 8f 55 4b f0 58  d9 46 58 35 b5 23 f9 53  |Kw6.UK.X.FX5.#.S|
+00000090  ce 15 34 95 1a 5b 65 b0  31 b2 57 1a 41 a6 a2 a9  |..4..[e.1.W.A...|
+000000a0  16 8e 7a 2a aa e2 19 64  47 dc 1b 81 7c 60 a2 4b  |..z*...dG...|`.K|
+000000b0  36 d6 cc 95 e9 8e 9b 25  22 28 0c 43 c2 26 3c 25  |6......%"(.C.&<%|
+000000c0  12 23 61 9d 52 7c 9c 69  2f ac 21 bb 76 54 b9 fb  |.#a.R|.i/.!.vT..|
+000000d0  4b fe 77 15 8c cb 76 a1  74 46 44 00 b8 03 6c 6d  |K.w...v.tFD...lm|
+000000e0  11 69 a6 c2 93 72 85 a4  a9 12 2f 6c 4a 8d 13 7a  |.i...r..../lJ..z|
+000000f0  07 90 35 b2 e0 05 af 60  b7 b0 e6 25 3b e3 67 8f  |..5....`...%;.g.|
+00000100  d1 06 43 9c 58 ab c9 91  ad a8 df a0 c2 6e a9 70  |..C.X........n.p|
+00000110  6f 2b 5c 06 03 be db 24  c4 1a 7c 88 ef dc 63 bf  |o+\....$..|...c.|
+00000120  a2 83 2c cc 68 a1 68 6c  ed 01 3c e1 67 5e 8e 7f  |..,.h.hl..<.g^..|
+00000130  bc f3 91 ca 57 c4 9e 76  4b 12 9a 87 40 e1 69 bb  |....W..vK...@.i.|
+00000140  ac 08 72 20 a7 ce f9 17  2e d1 dc ba 62 aa 08 9a  |..r ........b...|
+00000150  dd f0 91 c5 9f ec 98 fb  86 0b 6c ef 83 ad d9 56  |..........l....V|
+00000160  1d 1b 85 56 71 3a a5 c8  65 d7 22 52 25 69 3f de  |...Vq:..e."R%i?.|
+00000170  96 c9 01 74 e6 3d 91 b1  3f bc ab e6 59 44 ad 0f  |...t.=..?...YD..|
+00000180  d8 dc 92 18 ee 42 1a cf  a4 2c b8 ea 0a 26 c1 e2  |.....B...,...&..|
+00000190  9c a6 56 01 e8 ba ef d9  78 ab 52 d4 b4 79 8d dd  |..V.....x.R..y..|
+000001a0  54 65 93 46 bf 75 29 ca  5f 46 85 1c 76 49 dc ef  |Te.F.u)._F..vI..|
+000001b0  22 00 8f df 03 9d a5 9f  ea d4 a4 03 e3 75 27 17  |"............u'.|
+000001c0  03 03 00 1e dd 7e c0 ad  cf 96 83 59 55 ea 4e 8e  |.....~.....YU.N.|
+000001d0  c8 b2 48 a2 8c 27 33 70  9b d1 b7 84 5d e5 64 97  |..H..'3p....].d.|
+000001e0  62 6b 17 03 03 00 13 a1  c3 c4 0f 60 1d 5c c0 84  |bk.........`.\..|
+000001f0  68 95 a1 fb d9 eb f4 fb  c4 ba                    |h.........|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndGiven b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndGiven
index f11b34463d..ee385951fd 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndGiven
+++ b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndGiven
@@ -1,177 +1,177 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 09 8f c7 93 17  |................|
-00000010  40 3d b9 0a 8a 9c a5 21  99 27 7e 56 bf 25 30 48  |@=.....!.'~V.%0H|
-00000020  e1 c7 87 a0 f3 eb cd b6  1c 4f ad 20 6a 1c 8b 03  |.........O. j...|
-00000030  89 27 a0 2d 85 e3 7b 3d  c6 5f c0 f1 f3 ea be 84  |.'.-..{=._......|
-00000040  79 6b 83 63 e9 c3 52 02  a5 49 4a d4 00 04 13 01  |yk.c..R..IJ.....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 98 d1 fe 87 0e  |................|
+00000010  58 e6 29 6c 2e 97 27 da  ff ea 68 9f 64 da 6b 92  |X.)l..'...h.d.k.|
+00000020  4d 75 d0 61 86 1d d3 f8  8e 8b cc 20 55 29 6e 66  |Mu.a....... U)nf|
+00000030  d6 44 a0 51 07 50 d3 27  53 a4 bf ac a8 98 6f 7a  |.D.Q.P.'S.....oz|
+00000040  9f 6c bb f8 4b 33 d4 87  23 f5 4b d7 00 04 13 01  |.l..K3..#.K.....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 29  |-.....3.&.$... )|
-000000b0  e0 9a b2 3d f4 3e 07 a3  62 0a 30 c5 d7 6b d9 5e  |...=.>..b.0..k.^|
-000000c0  d0 1b b4 3c bf 6e ee 0f  70 fc d6 51 54 db 1f     |...<.n..p..QT..|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 ca  |-.....3.&.$... .|
+000000b0  5c 44 48 97 0c 36 09 9e  c4 68 a6 af 17 4a 2a d7  |\DH..6...h...J*.|
+000000c0  0c d0 13 67 ad 54 fe 55  07 b1 f8 04 9b 5d 41     |...g.T.U.....]A|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 6a 1c 8b 03  |........... j...|
-00000030  89 27 a0 2d 85 e3 7b 3d  c6 5f c0 f1 f3 ea be 84  |.'.-..{=._......|
-00000040  79 6b 83 63 e9 c3 52 02  a5 49 4a d4 13 01 00 00  |yk.c..R..IJ.....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 55 29 6e 66  |........... U)nf|
+00000030  d6 44 a0 51 07 50 d3 27  53 a4 bf ac a8 98 6f 7a  |.D.Q.P.'S.....oz|
+00000040  9f 6c bb f8 4b 33 d4 87  23 f5 4b d7 13 01 00 00  |.l..K3..#.K.....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 a6 29 77 32 51 25  |...........)w2Q%|
-00000090  13 ae e8 7d c0 5a f3 83  7f 50 15 73 af 17 a2 56  |...}.Z...P.s...V|
-000000a0  f8 17 03 03 00 3e 63 73  83 d1 42 19 08 d5 ec 98  |.....>cs..B.....|
-000000b0  64 95 f1 eb 5f 60 51 5d  07 21 48 25 d8 d3 76 51  |d..._`Q].!H%..vQ|
-000000c0  9d d5 9b 5f 87 6c c0 b2  b0 b2 b8 7f 9b ed 4a 41  |..._.l........JA|
-000000d0  f1 3e dc 21 8c 7c 2a da  fd 7a 82 38 8c c2 e9 c1  |.>.!.|*..z.8....|
-000000e0  5f f3 fe f8 17 03 03 02  6d 58 3c 00 1d ad b9 90  |_.......mX<.....|
-000000f0  64 ef cb be 77 5a 5e f7  46 1e 50 18 67 53 05 d5  |d...wZ^.F.P.gS..|
-00000100  b8 63 91 89 78 dc 49 0e  fa d6 1f 1e 21 20 9f 4a  |.c..x.I.....! .J|
-00000110  a0 b4 4a 70 9c 7e 7b 33  bf f6 9d c1 b9 b1 e7 57  |..Jp.~{3.......W|
-00000120  46 4e 59 a0 39 28 38 8b  1f 53 5e cf fe 90 82 fd  |FNY.9(8..S^.....|
-00000130  8c a3 aa 00 8a fa 75 d3  9b 9b 64 af 8a d5 18 e9  |......u...d.....|
-00000140  23 d2 80 3c b7 ed fe c0  d7 59 e8 e1 62 a0 c3 bb  |#..<.....Y..b...|
-00000150  b4 19 1a 1a 83 02 1b 61  aa c7 d9 81 84 b4 bb 30  |.......a.......0|
-00000160  3e f2 a8 55 b4 fb 1b 2c  25 72 f6 8a f5 5d 53 48  |>..U...,%r...]SH|
-00000170  fb 27 d8 e3 8b 19 6c e0  94 78 e5 b6 73 05 bc cb  |.'....l..x..s...|
-00000180  db 36 37 d2 24 8e 0d ac  fb 8a d5 20 ce f7 e8 45  |.67.$...... ...E|
-00000190  d0 d6 dc 5e 15 e4 b4 f0  63 74 c7 76 14 ec e5 41  |...^....ct.v...A|
-000001a0  32 e8 4b b6 eb 44 c8 95  56 6a 2e 8c 3a 8d b7 ff  |2.K..D..Vj..:...|
-000001b0  68 87 9c aa fa b0 0c 32  e7 6e ac df 04 47 3f fd  |h......2.n...G?.|
-000001c0  04 63 78 ac 48 85 81 7e  c7 8c d7 55 8b 57 73 8b  |.cx.H..~...U.Ws.|
-000001d0  78 23 c3 8b e2 ff 10 9c  e3 cb 69 ce 13 7a cf 31  |x#........i..z.1|
-000001e0  2d 05 8b 6e 36 69 a9 c2  5e 77 19 7c b5 1c 04 08  |-..n6i..^w.|....|
-000001f0  e9 71 00 c5 49 27 47 bb  52 e4 54 7b da 6c cf 2d  |.q..I'G.R.T{.l.-|
-00000200  c7 4b 80 bf 64 96 73 3e  54 5b 72 c5 2b 66 e2 8c  |.K..d.s>T[r.+f..|
-00000210  94 5c 6e 36 07 a0 a5 17  46 71 84 73 57 06 3e 9d  |.\n6....Fq.sW.>.|
-00000220  b6 6c 9b 84 44 a5 4c f5  d1 74 1a 65 81 5b 37 b2  |.l..D.L..t.e.[7.|
-00000230  46 9c 83 10 e2 db 21 3b  ca e8 16 25 1e 93 69 03  |F.....!;...%..i.|
-00000240  06 08 a8 06 1e 89 b6 5f  45 28 29 df 44 48 c9 37  |......._E().DH.7|
-00000250  06 b4 59 5f 41 bd b8 89  dd 74 a4 b2 d6 7a 87 fa  |..Y_A....t...z..|
-00000260  ea 8b 3d ca a7 a1 f0 44  59 af a2 c4 51 e0 17 0c  |..=....DY...Q...|
-00000270  a5 e7 bf f8 09 4b 97 ed  34 59 d5 97 df ba fd 05  |.....K..4Y......|
-00000280  d0 47 22 8b 25 16 88 7d  e7 0d 66 49 22 c3 08 01  |.G".%..}..fI"...|
-00000290  ba 99 82 3e c7 5c c5 b9  b9 50 c3 4f af 5c 1d 68  |...>.\...P.O.\.h|
-000002a0  6b c4 e0 06 23 75 ba f0  e3 3b 4e b7 6c 8e 78 ab  |k...#u...;N.l.x.|
-000002b0  bb 52 a1 f3 40 a7 be 0b  58 89 e5 20 69 ab 2d 50  |.R..@...X.. i.-P|
-000002c0  74 b9 cd 92 07 bb e1 b2  45 7d ad a2 13 90 71 4d  |t.......E}....qM|
-000002d0  2f 45 ea e9 ac 3e 2b aa  57 b9 0f 8f 61 99 56 bc  |/E...>+.W...a.V.|
-000002e0  62 39 4e 23 b2 5a 89 91  b7 2e 2c 8e 1f 1d 5b 69  |b9N#.Z....,...[i|
-000002f0  6d 47 13 50 1f 3f 77 f8  c0 de c0 32 7e 57 ef 35  |mG.P.?w....2~W.5|
-00000300  8e c0 13 88 34 79 af ca  8d 8f 7d 43 7c 54 70 a6  |....4y....}C|Tp.|
-00000310  77 8d 72 87 e5 50 5c d4  4e f3 80 cd 9b af 99 71  |w.r..P\.N......q|
-00000320  16 27 0b 0c 5c 03 a0 38  60 38 c4 20 5c 14 a6 a5  |.'..\..8`8. \...|
-00000330  57 f6 5b bc 26 4c 5d a8  73 10 5c 2c aa ad 8f 98  |W.[.&L].s.\,....|
-00000340  70 1b a8 04 8f 5b 56 7b  ee e3 e4 66 95 fa 2c 29  |p....[V{...f..,)|
-00000350  07 ae cb 92 a7 cc 17 03  03 00 99 cd e6 b8 49 6c  |..............Il|
-00000360  97 64 24 17 30 f7 4a 79  41 13 23 4b 2b e6 87 e0  |.d$.0.JyA.#K+...|
-00000370  89 19 cc 21 70 2b d6 a0  db 6c 17 8c 03 a4 0c 45  |...!p+...l.....E|
-00000380  25 90 0b 73 de 8d f3 8a  41 5d 21 78 39 f5 7c d8  |%..s....A]!x9.|.|
-00000390  9b 26 54 b9 4c 9c 19 95  1d 9b ef 02 f8 76 52 7e  |.&T.L........vR~|
-000003a0  d8 17 65 6d 61 47 d5 78  df 70 f9 07 95 c1 ec 8e  |..emaG.x.p......|
-000003b0  dd 91 11 1f be 85 24 96  5e 32 7a 46 ae 8e 99 6e  |......$.^2zF...n|
-000003c0  0a be a0 4a 4d 25 34 4f  18 9a cc 3a 8d 91 72 4e  |...JM%4O...:..rN|
-000003d0  d4 a2 17 8d 77 6a f3 b8  52 ec 06 d8 3d 7a b4 fa  |....wj..R...=z..|
-000003e0  d4 e8 36 0a ea 39 e3 da  61 32 26 95 18 1b b6 c3  |..6..9..a2&.....|
-000003f0  da e0 02 ed 17 03 03 00  35 32 c6 2e 2c e6 46 e5  |........52..,.F.|
-00000400  fa b0 ed c5 3d 32 28 9d  85 8d 05 07 94 64 2b b1  |....=2(......d+.|
-00000410  01 94 03 80 cb 94 de aa  2e 3e 63 21 5d b9 32 86  |.........>c!].2.|
-00000420  3d bf 33 72 6a a6 0c 7a  da 94 a3 33 67 9d        |=.3rj..z...3g.|
+00000080  03 03 00 01 01 17 03 03  00 17 76 7c bf b2 ff e2  |..........v|....|
+00000090  f8 7d 99 0d cd 96 45 69  17 9a 0f 65 7a b5 d5 05  |.}....Ei...ez...|
+000000a0  6d 17 03 03 00 3e ae 4f  8b 08 1d 83 d0 d4 52 b9  |m....>.O......R.|
+000000b0  b1 56 a0 7c 63 db 43 98  f6 4a fe ad f5 86 a9 df  |.V.|c.C..J......|
+000000c0  70 68 0d f0 b2 a6 d3 de  07 b2 79 8a 41 74 e4 b1  |ph........y.At..|
+000000d0  dc 6c e9 6a 72 f2 a2 1a  45 f7 bf b0 ef 67 1d 86  |.l.jr...E....g..|
+000000e0  c9 e1 35 68 17 03 03 02  6d 92 34 88 e6 e1 81 fe  |..5h....m.4.....|
+000000f0  2d cc 9a 1d e6 3f d3 88  5f 05 c5 03 07 ac cf 50  |-....?.._......P|
+00000100  68 a0 f0 8f 07 7f 76 4e  d4 4a 7b 7d 04 3f b7 1c  |h.....vN.J{}.?..|
+00000110  44 8e 46 33 a8 2e 9e 54  d7 c1 6c 4d a8 3f 0d bb  |D.F3...T..lM.?..|
+00000120  de 84 7f 2d fa a7 aa 5e  4d 45 c7 26 3b 1d c0 1c  |...-...^ME.&;...|
+00000130  8a cf 6c da 04 74 cf 30  0c d9 3f 85 94 7f 8d a5  |..l..t.0..?.....|
+00000140  d1 1e 19 2a e0 00 77 fc  53 5a 3b 16 00 b7 04 89  |...*..w.SZ;.....|
+00000150  59 95 05 63 1a 5a cc 6e  8f ab e0 89 8f 36 09 4a  |Y..c.Z.n.....6.J|
+00000160  ed a4 01 a5 03 af 14 cc  be 6c 53 ac 43 13 cd 93  |.........lS.C...|
+00000170  ad 42 1c 12 e5 8b 8e 30  f9 c1 3c 76 1a 51 e3 80  |.B.....0..<v.Q..|
+00000180  c8 93 0e aa 28 e5 ee de  35 d1 ee 9d 76 05 df 4a  |....(...5...v..J|
+00000190  03 d7 94 6e b3 81 3c 8a  db f6 3d 07 e7 36 25 e4  |...n..<...=..6%.|
+000001a0  70 42 1d c2 c7 ca 59 0e  d4 48 86 6c 48 2d 5a 2d  |pB....Y..H.lH-Z-|
+000001b0  ea ce 5a 0a 42 32 16 ed  25 f5 51 b5 33 a2 c5 43  |..Z.B2..%.Q.3..C|
+000001c0  8b b3 ed cd 54 19 74 f8  4c fe 56 ae fd 3c 1a 74  |....T.t.L.V..<.t|
+000001d0  04 e3 82 8b 62 58 84 df  e0 78 8d 18 e4 7b 21 42  |....bX...x...{!B|
+000001e0  0a a8 49 74 cd f3 c2 f7  b4 be ff d9 35 26 db 40  |..It........5&.@|
+000001f0  fb 7b 15 11 20 69 de c5  c6 1a ad fe c3 7d 06 4d  |.{.. i.......}.M|
+00000200  02 f0 ff 96 0d 2c ac d8  94 58 7a 2c 18 3f ae 82  |.....,...Xz,.?..|
+00000210  ab 77 37 f4 b7 37 33 23  16 b9 a7 d2 48 74 8d 8a  |.w7..73#....Ht..|
+00000220  55 85 ab 1c d3 fa 9f fb  21 bf e8 56 aa e6 0b 8e  |U.......!..V....|
+00000230  21 e7 55 52 ab 8e da 69  c5 f1 bb 8b 02 03 60 bc  |!.UR...i......`.|
+00000240  bf bd 81 55 ee 51 4e 0b  4f d2 39 6c a5 26 d1 da  |...U.QN.O.9l.&..|
+00000250  0a d4 d6 cc e9 7f af 4a  dd 20 ac c8 99 c3 56 4e  |.......J. ....VN|
+00000260  d2 88 4a 74 cb 86 0e 70  e7 d0 37 2a cc 0a 0f ac  |..Jt...p..7*....|
+00000270  7b 10 e0 08 aa 8b cb 60  a2 a3 cb 07 29 6e 16 d6  |{......`....)n..|
+00000280  e7 0f 2c 45 5f ee 59 5d  75 79 55 06 99 f7 ba 23  |..,E_.Y]uyU....#|
+00000290  e4 61 b1 bb eb 37 d0 1a  48 a2 8c b6 4e 43 cb 9d  |.a...7..H...NC..|
+000002a0  af f4 d3 ce 80 83 3a 6c  b6 69 d3 44 dd 63 f9 56  |......:l.i.D.c.V|
+000002b0  0f 48 e1 29 1f c3 fc f1  e7 46 ac 86 dd a8 a8 17  |.H.).....F......|
+000002c0  65 a9 5c 6b 9b 7d 2d 4d  f3 02 2b 41 47 49 a1 43  |e.\k.}-M..+AGI.C|
+000002d0  d6 93 03 d6 fd b9 2c 24  de f5 1d 90 0b 6f 5f 98  |......,$.....o_.|
+000002e0  b2 3d d8 77 29 c4 14 69  1c 10 d7 2d d7 0a 10 0f  |.=.w)..i...-....|
+000002f0  aa 77 5f bd 91 54 76 5e  30 0c b2 59 b6 9f 69 da  |.w_..Tv^0..Y..i.|
+00000300  99 00 b5 a9 b6 bf 04 95  35 a8 40 ca cb fe d4 5e  |........5.@....^|
+00000310  97 1f 03 b4 79 ce 08 6b  61 33 fb 7c 42 8e 4e 1f  |....y..ka3.|B.N.|
+00000320  78 35 9c 9b 66 ef 51 54  9f 02 13 42 df 14 93 95  |x5..f.QT...B....|
+00000330  58 b2 35 6c e8 05 4e 3b  21 2e 82 7b df cb 01 6a  |X.5l..N;!..{...j|
+00000340  df 3d fa 54 90 d9 c7 a2  46 87 16 55 72 9b d6 63  |.=.T....F..Ur..c|
+00000350  ae 2e 78 06 aa 38 17 03  03 00 99 75 c6 50 d1 1d  |..x..8.....u.P..|
+00000360  1b 22 9c 2a 2f 64 95 23  6e 02 d5 0b c8 89 69 ca  |.".*/d.#n.....i.|
+00000370  19 70 18 72 17 28 62 26  f0 7f 53 74 b6 21 8a 2c  |.p.r.(b&..St.!.,|
+00000380  30 36 52 c1 4f d2 80 b0  ee d6 e4 d7 4d b2 62 76  |06R.O.......M.bv|
+00000390  24 dd d9 9e 88 b1 d2 30  b3 f0 70 55 7e a8 cb aa  |$......0..pU~...|
+000003a0  a2 9b 0f bd fa fc dd 04  a3 ef e9 81 b8 ca 1e 09  |................|
+000003b0  c2 39 d3 3a d4 1a bb e9  8a 91 42 6a 77 46 cc a7  |.9.:......BjwF..|
+000003c0  51 4f 02 fa 71 22 4f cf  de a1 ff ca 14 d5 6f ae  |QO..q"O.......o.|
+000003d0  c6 f4 65 90 ff 18 e0 f5  81 cf 70 aa ae d8 b9 5f  |..e.......p...._|
+000003e0  f8 38 c6 ea 2b 66 f7 01  b9 c3 d5 99 db cb d5 a4  |.8..+f..........|
+000003f0  c4 ec 82 79 17 03 03 00  35 69 c4 c6 1e 15 54 4b  |...y....5i....TK|
+00000400  94 c4 71 3b 51 c1 09 f1  34 4f 6e 83 1f 87 67 92  |..q;Q...4On...g.|
+00000410  62 2f ea 25 cb 7a 8d 2c  68 69 ff 6a d2 c9 cf fe  |b/.%.z.,hi.j....|
+00000420  8a dd a1 33 bd 94 e5 63  f8 8f 11 30 fd 7a        |...3...c...0.z|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 02 11 c9 db 52 ed e6  |.............R..|
-00000010  7e ea 09 35 cc 04 13 79  db 65 e0 1a b5 3c dd 4d  |~..5...y.e...<.M|
-00000020  19 65 18 97 a3 33 d2 02  d1 84 3b 72 e1 dd 6e a1  |.e...3....;r..n.|
-00000030  37 ac 78 b5 dd 07 7f 41  6a 4c 8f f5 8e cb ca b1  |7.x....AjL......|
-00000040  ff 8b 2b 68 7e b7 1f da  b7 f7 7a aa 6b 92 fe d8  |..+h~.....z.k...|
-00000050  a1 03 84 cf 1f dd 21 48  b9 3d 5b b7 b7 dc d5 f7  |......!H.=[.....|
-00000060  4e 5c 70 50 5d d5 96 b9  c2 e2 23 5d c6 ba 0d cb  |N\pP].....#]....|
-00000070  74 b2 3f 0b a1 a7 4b e2  3a 83 e5 07 cd cb 46 a8  |t.?...K.:.....F.|
-00000080  05 be e6 e7 3b 65 e9 d3  ac c3 31 0b 4a 5d 8b 4e  |....;e....1.J].N|
-00000090  59 a0 2d 3d 10 d8 97 73  05 f6 1a 21 4a 7c fe 01  |Y.-=...s...!J|..|
-000000a0  e5 4d 68 2b 5a cf ed 8f  37 cf 00 a3 17 bf 16 56  |.Mh+Z...7......V|
-000000b0  e9 3b 1b 5a 87 c1 03 f1  8a a4 8b 99 f3 3d 13 99  |.;.Z.........=..|
-000000c0  90 72 5c 46 ba 26 ab 1f  f2 b7 41 c5 0f 44 de 8c  |.r\F.&....A..D..|
-000000d0  5e 5f da 61 27 04 c7 6a  83 12 08 9c c1 73 88 09  |^_.a'..j.....s..|
-000000e0  64 3d 01 25 79 ed f4 7d  18 73 ec 1c 89 88 e5 ce  |d=.%y..}.s......|
-000000f0  80 3b 38 83 0b 61 a6 16  6b 96 2b 28 19 31 fa 0b  |.;8..a..k.+(.1..|
-00000100  79 1e 1f 3b fe 3f 65 26  60 0e dd 7c 4d bb 32 77  |y..;.?e&`..|M.2w|
-00000110  2a 5a 6e e6 e4 8c 38 65  d5 ae d7 1d 01 bc 19 8e  |*Zn...8e........|
-00000120  60 92 d3 f0 00 19 e7 13  35 f2 4d bb 60 41 6b c9  |`.......5.M.`Ak.|
-00000130  68 56 7d 2d b5 d7 56 63  10 7f 53 1a 5e d1 ba 42  |hV}-..Vc..S.^..B|
-00000140  e8 51 86 b6 b5 4a a1 52  e4 2c 97 94 17 d0 69 aa  |.Q...J.R.,....i.|
-00000150  bc d1 e6 c1 cf 23 c4 4e  f0 9f 96 b7 82 b4 d9 d2  |.....#.N........|
-00000160  90 1f 06 17 ac 43 fe d2  cf 31 a8 ac 31 2d 00 7e  |.....C...1..1-.~|
-00000170  86 99 31 27 af cb b1 b7  de 15 04 0f 4d 60 c5 63  |..1'........M`.c|
-00000180  9c ff 75 4e 68 9b 80 4a  b6 60 04 04 6d 50 ae 4c  |..uNh..J.`..mP.L|
-00000190  f0 34 72 e4 c7 37 06 32  fc 55 f0 b8 3c dd 06 1b  |.4r..7.2.U..<...|
-000001a0  2c bd f3 a1 77 a3 13 90  df 29 b1 6c 57 17 9d af  |,...w....).lW...|
-000001b0  94 82 17 74 27 30 ae b7  39 1a 77 02 bd 77 1c 1c  |...t'0..9.w..w..|
-000001c0  f0 62 3b 0f dd c4 b0 87  9b 41 72 02 fb 6c c0 7e  |.b;......Ar..l.~|
-000001d0  01 46 55 de c0 d2 de 26  18 d5 a1 17 40 b7 a7 a3  |.FU....&....@...|
-000001e0  a2 48 5d 6f 65 fe 3e 44  20 18 b4 82 c8 80 11 bb  |.H]oe.>D .......|
-000001f0  20 88 e5 5b 98 ab c1 fc  08 8d 62 1c 36 7a d1 55  | ..[......b.6z.U|
-00000200  73 00 e8 e4 a0 20 19 1b  59 62 eb 6a c3 ef d0 9d  |s.... ..Yb.j....|
-00000210  89 f3 7d 26 f8 9a 71 a9  85 2a 00 85 17 03 03 00  |..}&..q..*......|
-00000220  99 00 e1 e9 4d 25 62 e7  d6 a5 ec dd 17 15 0a ce  |....M%b.........|
-00000230  60 a0 00 17 53 9d f2 a7  28 c6 9c cf ec 39 0c 88  |`...S...(....9..|
-00000240  30 b2 52 85 cb 07 c9 87  49 da 76 88 04 df 5f 8a  |0.R.....I.v..._.|
-00000250  53 a4 e0 1d ff 1e 9a 47  e8 af f5 14 36 e5 24 bf  |S......G....6.$.|
-00000260  2d cf 98 2d 97 f8 46 c1  9c 5c 68 95 31 a1 35 fa  |-..-..F..\h.1.5.|
-00000270  b9 78 d2 82 ef 58 4c 6e  5a 92 34 c6 31 49 bb d4  |.x...XLnZ.4.1I..|
-00000280  dd 5b 64 35 65 c8 a4 99  4c fa 04 da e4 d9 10 11  |.[d5e...L.......|
-00000290  ef 04 33 98 c7 80 01 c8  32 f8 2c d9 22 75 55 5f  |..3.....2.,."uU_|
-000002a0  14 cc d3 1e 9a 91 81 ab  a7 f0 b9 04 8a 2f 43 aa  |............./C.|
-000002b0  94 ff 92 88 b1 e1 2a ca  87 67 17 03 03 00 35 ee  |......*..g....5.|
-000002c0  85 79 99 da 96 18 f0 c9  ca 6a 0e 48 93 b3 3b 0b  |.y.......j.H..;.|
-000002d0  02 05 5a 69 1e 5d 4c 10  44 02 db 6f 49 04 65 01  |..Zi.]L.D..oI.e.|
-000002e0  45 be ee c6 67 0b 07 bc  c3 3a e3 8a cf ac ca 08  |E...g....:......|
-000002f0  70 d2 20 40 17 03 03 00  13 ab 1c 1f 66 38 10 bb  |p. @........f8..|
-00000300  fa 7a f4 52 8f ba 8d 03  61 b1 5c 73              |.z.R....a.\s|
+00000000  14 03 03 00 01 01 17 03  03 02 11 ce 4f 2f 13 a4  |............O/..|
+00000010  ba 10 60 84 29 2a a6 3b  97 e6 b2 3d ca 93 6e c8  |..`.)*.;...=..n.|
+00000020  88 d0 f2 4c 86 10 4e 6d  75 e3 5e 92 9a f3 0a a0  |...L..Nmu.^.....|
+00000030  1f a8 ee e6 76 4d 5b c3  bf 42 35 fc 9e 2a 55 b2  |....vM[..B5..*U.|
+00000040  57 0c ab 20 f7 1a 4d 7c  b5 32 9a 7e a1 81 e6 45  |W.. ..M|.2.~...E|
+00000050  93 74 0e ae 15 17 21 87  45 f1 92 5d f1 17 ce 55  |.t....!.E..]...U|
+00000060  25 50 5f 43 76 5f fe 21  44 fc cc fa af 4b f6 db  |%P_Cv_.!D....K..|
+00000070  26 f3 49 d2 e7 97 0e bd  10 7b 8a 98 0c 14 1d 10  |&.I......{......|
+00000080  ba 56 bb 48 73 cd db 41  7e ca 43 5f 59 18 26 f7  |.V.Hs..A~.C_Y.&.|
+00000090  e6 26 76 ae 9e 51 03 b6  0a 34 21 7d 99 9e 5f 07  |.&v..Q...4!}.._.|
+000000a0  e7 69 38 97 8f 86 ca d6  d6 f6 a4 c1 4e df f6 d8  |.i8.........N...|
+000000b0  56 16 d9 85 90 3e c1 1a  77 dc 45 44 4a d6 4b ac  |V....>..w.EDJ.K.|
+000000c0  40 8a 49 db d5 a4 8e d9  92 4e 85 45 1d 7f 95 db  |@.I......N.E....|
+000000d0  05 e5 83 88 36 2e c8 22  3c df c3 6f f9 7e 06 f3  |....6.."<..o.~..|
+000000e0  16 1f 7e b1 4d ce 2e de  75 e1 9c d8 af 5e ca ee  |..~.M...u....^..|
+000000f0  44 d1 df 6a 10 c9 de a5  e8 b4 c7 f8 4f f8 5d 6e  |D..j........O.]n|
+00000100  75 76 6d ca 2f 47 72 74  dc a3 7f d4 9b 1f ef 7a  |uvm./Grt.......z|
+00000110  98 60 c2 46 04 85 57 67  79 09 74 e0 0a f8 0a 61  |.`.F..Wgy.t....a|
+00000120  01 c6 0a a3 26 6b 27 be  a3 93 c3 95 d6 b5 1c aa  |....&k'.........|
+00000130  39 d2 b4 eb d2 04 4c da  d4 c7 27 11 39 5f 7f d0  |9.....L...'.9_..|
+00000140  43 e5 0e 07 87 3d db 54  5f 1f 7a 6f a6 54 83 23  |C....=.T_.zo.T.#|
+00000150  f4 0c 67 a7 f1 92 9e 0c  1c 67 b6 a3 a7 ff 83 f8  |..g......g......|
+00000160  da c8 24 cb 0f 6f 97 57  8f 85 b8 fc 3f ca dd 82  |..$..o.W....?...|
+00000170  b5 77 b6 62 c2 74 e4 12  da dd bc f9 fa ff dd c5  |.w.b.t..........|
+00000180  e3 df 24 3a c3 e1 a3 25  27 57 00 ca be ba ad a7  |..$:...%'W......|
+00000190  c0 9f 44 1b f7 0a ee 9d  ec f2 a8 18 fc ff c1 27  |..D............'|
+000001a0  f5 0e d8 3c bd 9a 2f 39  52 a0 54 c4 d4 30 e2 de  |...<../9R.T..0..|
+000001b0  bc e2 37 5a 4f dc 05 d9  25 48 3c 11 2a c5 ca d0  |..7ZO...%H<.*...|
+000001c0  47 d3 06 a7 05 83 82 ab  21 64 7d 28 92 2d a7 a2  |G.......!d}(.-..|
+000001d0  93 21 b2 9d 5c 3c 2c 19  b5 ac 57 5e a7 51 19 58  |.!..\<,...W^.Q.X|
+000001e0  f7 e7 ac d7 b2 c9 be 30  71 7b 91 2d ca f5 d1 2b  |.......0q{.-...+|
+000001f0  90 27 1a d1 7c 04 2e ee  07 ed 33 4c 25 a8 ef aa  |.'..|.....3L%...|
+00000200  83 78 66 d5 46 60 79 f2  dd 3f 2d 85 19 77 d0 23  |.xf.F`y..?-..w.#|
+00000210  7f ef f1 a8 43 65 d5 f0  51 e1 93 04 17 03 03 00  |....Ce..Q.......|
+00000220  99 eb db b6 ff 87 6a 27  61 01 47 ea f2 c4 3f 58  |......j'a.G...?X|
+00000230  b8 e0 bc 5a 30 98 1f 58  bb 0e 6c c7 b7 f7 38 e7  |...Z0..X..l...8.|
+00000240  2a 8f 73 0e 3f 63 c7 cf  ff e7 d7 52 8e 61 70 41  |*.s.?c.....R.apA|
+00000250  ae b4 83 cc 4d e7 59 14  76 ea 54 7f 39 18 38 c1  |....M.Y.v.T.9.8.|
+00000260  ad 44 8b 20 89 47 b7 ce  b5 73 19 15 73 02 d4 3e  |.D. .G...s..s..>|
+00000270  54 d3 52 b6 c3 97 cb 15  06 84 48 d6 94 55 60 15  |T.R.......H..U`.|
+00000280  d9 b6 3e 72 1c e3 2e 61  fc 8d 77 1f ba 02 47 e8  |..>r...a..w...G.|
+00000290  7c 4c 09 c6 2c 9a 41 90  8f 30 b4 c6 93 2d 3b 87  ||L..,.A..0...-;.|
+000002a0  d4 c1 a0 69 04 01 7b 0b  8a eb fe 51 22 0d e3 1d  |...i..{....Q"...|
+000002b0  f3 c3 18 94 ce f6 f9 d8  2d 74 17 03 03 00 35 c0  |........-t....5.|
+000002c0  7e 62 dd af e2 98 62 c1  0c c3 77 27 b7 08 6d 45  |~b....b...w'..mE|
+000002d0  97 70 2c cd 8a 3c 43 d0  99 f2 a2 c9 1c 3b 00 df  |.p,..<C......;..|
+000002e0  7a 12 63 b8 85 20 79 d4  29 c3 42 f1 cb f9 9d 77  |z.c.. y.).B....w|
+000002f0  c1 00 38 3f 17 03 03 00  13 35 62 5d 3d 53 80 2c  |..8?.....5b]=S.,|
+00000300  fb 95 ef cc 3a 6d a1 d5  6d b5 85 a3              |....:m..m...|
 >>> Flow 4 (server to client)
-00000000  17 03 03 02 7b 5b 42 c8  3b a8 38 ea aa 7b 43 8b  |....{[B.;.8..{C.|
-00000010  03 a5 a4 e1 fb a4 f7 5f  e2 47 51 b5 41 22 15 62  |......._.GQ.A".b|
-00000020  80 bf 5f f1 6c 6e 9e 92  bc a3 96 5e 11 03 80 64  |.._.ln.....^...d|
-00000030  ec 42 46 1e 55 12 85 91  d8 63 7a 68 0a a5 72 bd  |.BF.U....czh..r.|
-00000040  fe 57 12 fe 7d 36 c6 a7  9d 5f 85 f6 59 85 f2 ef  |.W..}6..._..Y...|
-00000050  af f1 ea 6d ca 34 e8 41  c7 7d e3 b6 0b be 11 1b  |...m.4.A.}......|
-00000060  29 45 e9 a6 dc 08 67 0b  6e c9 fe ec 1a 82 f7 9c  |)E....g.n.......|
-00000070  42 ae 9a 88 e8 1c cd de  71 a8 8a 87 31 84 d5 fc  |B.......q...1...|
-00000080  d6 10 21 3e 14 d2 5f 54  00 15 11 49 ae c8 7f d5  |..!>.._T...I....|
-00000090  b6 9e 33 34 22 bc f4 4d  5c 72 ad e0 4b 57 9a 11  |..34"..M\r..KW..|
-000000a0  89 46 36 88 98 a6 ff 7f  d8 72 02 a5 1e 78 1c 8d  |.F6......r...x..|
-000000b0  c6 ad b4 df 57 4a dc 8a  bd 47 fa 9f dc 5a d6 1c  |....WJ...G...Z..|
-000000c0  1a 4c 8d 7f e8 f4 b6 e6  be 80 25 ba d5 d2 d5 10  |.L........%.....|
-000000d0  19 dd 3e 28 e3 af f5 67  45 60 d3 7f 11 a8 f7 e3  |..>(...gE`......|
-000000e0  55 08 75 98 45 30 2a 83  a5 cb 6b 64 fe 89 ab eb  |U.u.E0*...kd....|
-000000f0  c8 c3 52 45 08 82 e8 e7  78 4c 31 ab b6 ae 16 de  |..RE....xL1.....|
-00000100  b8 70 53 ee ec 4e 23 4f  a4 84 55 0f 53 b0 17 a9  |.pS..N#O..U.S...|
-00000110  d7 d0 e7 4e 62 02 15 a9  e7 54 1a 47 08 7d 00 b3  |...Nb....T.G.}..|
-00000120  38 58 de c7 20 ab 36 f6  be 20 38 a1 b0 80 e8 a3  |8X.. .6.. 8.....|
-00000130  a5 e7 3d 17 f5 70 6d 77  6d ae 65 9a 35 f9 25 40  |..=..pmwm.e.5.%@|
-00000140  7b 65 0d 08 27 8d fd bb  9e 2a 3d dc 29 79 80 74  |{e..'....*=.)y.t|
-00000150  53 cc e8 cd c9 b2 af 95  1d 10 98 2c f6 21 4a 30  |S..........,.!J0|
-00000160  f8 5b ea 07 0b b5 45 2c  62 fa 91 d9 a0 72 94 9c  |.[....E,b....r..|
-00000170  19 ec 01 b2 a9 f3 61 71  39 f5 55 65 16 94 67 c9  |......aq9.Ue..g.|
-00000180  87 f6 be fb d6 f9 f4 c7  c1 d1 ff 2c 78 07 63 19  |...........,x.c.|
-00000190  23 15 a2 6d 18 0d d0 05  be 5c 81 ac d8 f2 04 a9  |#..m.....\......|
-000001a0  ec 01 db cf 5f 75 e6 bc  4a 92 67 95 c5 d8 a0 94  |...._u..J.g.....|
-000001b0  5e d7 9a 97 1d a8 8b e5  07 8f 6a 51 a2 cb a4 40  |^.........jQ...@|
-000001c0  54 77 76 87 c2 aa b2 f5  35 f2 1f 31 1e 6f f1 58  |Twv.....5..1.o.X|
-000001d0  5f 4c ef 70 09 c2 d5 63  50 ff fd 9d 9a 84 94 34  |_L.p...cP......4|
-000001e0  26 26 b3 7f b2 c3 de 94  01 b2 0b 77 23 4c 95 82  |&&.........w#L..|
-000001f0  5c db 47 17 93 ab f3 b6  f4 a4 83 16 a8 2f 27 88  |\.G........../'.|
-00000200  bf b5 a1 7c 0d c0 66 2f  a7 97 a2 56 6a 3f 4b 69  |...|..f/...Vj?Ki|
-00000210  3e 68 52 62 67 15 77 f4  f5 84 14 b5 e2 a1 89 c1  |>hRbg.w.........|
-00000220  9a 89 53 6b e5 f8 77 d6  18 7c 23 c7 19 7a d8 4a  |..Sk..w..|#..z.J|
-00000230  f9 d2 03 b2 d0 30 bd b2  e9 31 c5 c0 27 67 65 18  |.....0...1..'ge.|
-00000240  2b 35 36 87 b7 70 6b 3b  05 ef c7 69 2a fc c4 e2  |+56..pk;...i*...|
-00000250  e8 27 65 a3 e3 0b 18 de  da f4 22 1e c8 f4 b0 d9  |.'e.......".....|
-00000260  34 a0 33 6f b5 e9 61 ac  13 db 14 1a a6 eb 33 44  |4.3o..a.......3D|
-00000270  39 0d 21 62 a9 7f 77 54  53 25 15 2c 5e cf 18 c5  |9.!b..wTS%.,^...|
-00000280  17 03 03 00 1e 1f b3 65  70 fb 27 cd c2 17 af 37  |.......ep.'....7|
-00000290  56 90 9b 4c b8 16 2b 7a  73 55 db ff cd f7 e7 57  |V..L..+zsU.....W|
-000002a0  af 6a d6 17 03 03 00 13  27 b4 96 07 8e 23 a3 ef  |.j......'....#..|
-000002b0  93 b6 3e b7 bd a4 e4 33  bd 29 06                 |..>....3.).|
+00000000  17 03 03 02 7b 2c e8 96  dc 73 40 b9 0d c2 65 18  |....{,...s@...e.|
+00000010  02 fd a8 02 ee a1 8e b0  04 2b 7d dc 07 69 48 d0  |.........+}..iH.|
+00000020  a5 0c 3d 72 c2 11 61 53  42 6e f1 b0 cf 88 cc 1f  |..=r..aSBn......|
+00000030  b8 07 72 d1 02 a1 f3 28  57 68 10 b6 e3 20 ab bb  |..r....(Wh... ..|
+00000040  de 95 4c 15 ee 5b db 39  2e 15 53 49 08 28 82 9e  |..L..[.9..SI.(..|
+00000050  c5 18 46 ca 80 06 23 d1  38 98 13 6e 68 ad af 33  |..F...#.8..nh..3|
+00000060  bc c0 e9 0f 66 04 76 54  70 15 63 1c 95 07 24 87  |....f.vTp.c...$.|
+00000070  70 d9 86 76 b8 4d af 10  4a 22 0b a5 9b 8c d0 11  |p..v.M..J"......|
+00000080  26 42 68 e9 f9 5f a4 8e  e1 82 d0 ee aa af 84 f1  |&Bh.._..........|
+00000090  f1 40 d6 09 57 a5 e5 f7  13 5b 8b 7d 61 c6 2f 82  |.@..W....[.}a./.|
+000000a0  60 17 ea e7 c2 54 76 27  fe 63 1e a5 d5 86 64 f3  |`....Tv'.c....d.|
+000000b0  2a 9c c3 79 ff bd 1a 10  97 39 65 e7 2b 35 71 0a  |*..y.....9e.+5q.|
+000000c0  67 77 70 97 6f 1f ef a0  55 fb 21 96 1e b1 48 7a  |gwp.o...U.!...Hz|
+000000d0  b7 ec 5f c3 b8 62 59 1f  ab 54 f4 7d 41 ff 42 15  |.._..bY..T.}A.B.|
+000000e0  06 a5 ec 26 bb ca 7a 42  4f 2d f6 4b c7 2e 2b 66  |...&..zBO-.K..+f|
+000000f0  24 75 51 be 5c 58 34 af  17 89 34 1a 4a 58 08 80  |$uQ.\X4...4.JX..|
+00000100  31 93 6c b3 a2 71 a0 51  68 f5 66 36 e9 88 37 b4  |1.l..q.Qh.f6..7.|
+00000110  df 72 be ba 33 67 36 75  0f ab 41 27 8b 7c 4e 3e  |.r..3g6u..A'.|N>|
+00000120  7c 06 49 11 cf 0c e6 15  4c 31 bf 0a ae 25 bf cd  ||.I.....L1...%..|
+00000130  05 f0 42 87 ad 18 eb 4a  fb 2a d3 4c cb b2 bb ff  |..B....J.*.L....|
+00000140  08 ab 2a 4d d3 ba 32 8d  a0 7f 34 2c 03 a5 87 43  |..*M..2...4,...C|
+00000150  ca 23 2d 6e 8d 6e c3 70  b3 ae 9b 3d f2 18 93 76  |.#-n.n.p...=...v|
+00000160  f8 a7 1c c6 c9 24 9a a9  bf 75 6a ce ce 3f d1 a2  |.....$...uj..?..|
+00000170  e8 1d 3b 39 19 60 e9 d5  82 ba ef ee 27 bb c9 5f  |..;9.`......'.._|
+00000180  53 b8 cd ec 63 ec fb 26  7d 8b a1 c5 e4 fe 23 78  |S...c..&}.....#x|
+00000190  e8 88 99 44 2c a2 74 9f  b9 16 ed 72 e5 76 01 57  |...D,.t....r.v.W|
+000001a0  36 11 71 28 43 08 8d 37  27 77 4f fc f7 a6 7f 9c  |6.q(C..7'wO.....|
+000001b0  68 8c 38 f8 64 d4 b8 7e  c9 e0 1d 9c 2a 87 f0 6d  |h.8.d..~....*..m|
+000001c0  bc af a2 c2 b6 d1 b8 b5  03 e9 14 be 1d fb cb 16  |................|
+000001d0  6c 19 4f 83 04 f2 e9 5f  cb ce 2b 63 43 aa 8b 2d  |l.O...._..+cC..-|
+000001e0  ac e5 6d 3e 5a d6 f8 b7  7d 6f f8 6a b1 2f 32 5a  |..m>Z...}o.j./2Z|
+000001f0  65 1d e1 94 ba ef ce 4f  cb f2 1f e4 7d 1a 81 cb  |e......O....}...|
+00000200  ae d8 a2 33 fb e9 92 7b  34 62 a2 5d 25 82 90 7f  |...3...{4b.]%...|
+00000210  66 d8 ae 5d 9f 5b e9 a5  b3 43 ab 7d 45 33 85 3d  |f..].[...C.}E3.=|
+00000220  e2 59 1a 6b b7 81 85 d6  35 50 e3 05 20 65 1b 2e  |.Y.k....5P.. e..|
+00000230  6c 22 ad ca 62 d1 6a 92  32 6d f5 9f f5 a0 dd 82  |l"..b.j.2m......|
+00000240  56 42 e5 01 d3 39 c4 0d  28 dc b9 9f ef e3 eb 6c  |VB...9..(......l|
+00000250  08 8f c8 bb 07 4a de 9d  6c f9 e1 15 14 15 67 9e  |.....J..l.....g.|
+00000260  79 fd 6e 12 e9 79 ca 0b  67 2b 51 cd 76 7c e0 26  |y.n..y..g+Q.v|.&|
+00000270  64 7c ff f3 64 92 2e b4  bf 5f 2f 19 ec 2f 0a 2d  |d|..d...._/../.-|
+00000280  17 03 03 00 1e 4d 37 13  c4 d4 95 e5 20 9c bf 4e  |.....M7..... ..N|
+00000290  83 86 3e 30 fe 4a 6b 63  29 6d bb 94 26 c2 fc 39  |..>0.Jkc)m..&..9|
+000002a0  0e 3f de 17 03 03 00 13  b0 b8 9a 50 8f e1 3d 89  |.?.........P..=.|
+000002b0  14 5f 01 22 b7 5b 7c 82  70 5e e1                 |._.".[|.p^.|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedNotGiven b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedNotGiven
index c16d0dec72..53db365ceb 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedNotGiven
+++ b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedNotGiven
@@ -1,103 +1,103 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 a1 eb cd fe ad  |................|
-00000010  69 19 0c 1f 2d ad 7a 14  4c dc 56 73 ba 60 ea b7  |i...-.z.L.Vs.`..|
-00000020  9f 8e 54 73 3b 18 ac 7e  15 26 7d 20 d0 3a a9 23  |..Ts;..~.&} .:.#|
-00000030  48 ec 62 65 0b 01 ed 9a  d3 27 9f 94 c3 05 91 b1  |H.be.....'......|
-00000040  88 a0 a1 1a cb 6e ed 89  f3 76 39 94 00 04 13 01  |.....n...v9.....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 c4 19 dd 97 88  |................|
+00000010  4d 85 99 b6 c5 97 94 0c  73 95 b4 7b e1 18 eb 21  |M.......s..{...!|
+00000020  29 5d 81 91 ad 3e e6 7b  75 c4 bc 20 8b 2e c7 e9  |)]...>.{u.. ....|
+00000030  ea cd f7 09 27 53 6c 27  54 5b 18 53 72 eb 65 1f  |....'Sl'T[.Sr.e.|
+00000040  f3 8d 1a 69 6f b7 29 9c  26 33 4c c3 00 04 13 01  |...io.).&3L.....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 53  |-.....3.&.$... S|
-000000b0  56 2d f7 8c 59 8a 3b f9  bd eb ef 08 c3 15 e9 f2  |V-..Y.;.........|
-000000c0  8c cf fd a8 42 54 d3 8b  5d 07 06 06 d8 3c 10     |....BT..]....<.|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 db  |-.....3.&.$... .|
+000000b0  84 90 a2 a1 fd 2e 53 bb  fb 2a 97 03 56 15 6a b6  |......S..*..V.j.|
+000000c0  e7 4d a3 66 f7 48 85 96  66 d9 5c bf 42 c2 3d     |.M.f.H..f.\.B.=|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 d0 3a a9 23  |........... .:.#|
-00000030  48 ec 62 65 0b 01 ed 9a  d3 27 9f 94 c3 05 91 b1  |H.be.....'......|
-00000040  88 a0 a1 1a cb 6e ed 89  f3 76 39 94 13 01 00 00  |.....n...v9.....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 8b 2e c7 e9  |........... ....|
+00000030  ea cd f7 09 27 53 6c 27  54 5b 18 53 72 eb 65 1f  |....'Sl'T[.Sr.e.|
+00000040  f3 8d 1a 69 6f b7 29 9c  26 33 4c c3 13 01 00 00  |...io.).&3L.....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 21 21 07 25 09 0b  |..........!!.%..|
-00000090  b0 e2 51 37 39 a6 b8 ab  7b 9e 53 07 3f 8c 63 18  |..Q79...{.S.?.c.|
-000000a0  8e 17 03 03 00 3e d5 39  d7 6d a6 4b 9f f9 53 8c  |.....>.9.m.K..S.|
-000000b0  78 f5 21 5f 3e f8 37 da  37 bb 6c 17 7a ab 0f 6e  |x.!_>.7.7.l.z..n|
-000000c0  7e 76 93 0b c7 84 41 c9  29 21 9e 3c 65 ee 6d c7  |~v....A.)!.<e.m.|
-000000d0  31 10 63 a4 56 fb 8b a5  1d 91 b2 19 57 62 94 6a  |1.c.V.......Wb.j|
-000000e0  23 1e ef ef 17 03 03 02  6d de c9 54 70 cf 6c 70  |#.......m..Tp.lp|
-000000f0  f7 03 0a 1e 97 c8 c7 bc  fa cb 44 bc 97 45 09 40  |..........D..E.@|
-00000100  63 ef 02 7a ee 6b 29 cc  17 6e a6 aa 8e 0c 46 41  |c..z.k)..n....FA|
-00000110  ca 36 18 77 ec 78 8b 1c  d0 c2 11 94 6e ff 19 47  |.6.w.x......n..G|
-00000120  09 c7 67 cf 4d 9c da 64  9e 80 2f b5 e5 9e e2 f3  |..g.M..d../.....|
-00000130  9d 2a ae 45 9c 1a 48 6e  5c 3f 3f f8 65 ea e9 8f  |.*.E..Hn\??.e...|
-00000140  f9 2d 1c 88 b7 ef 0e 0e  ce 2f 21 5e ef ec d1 6c  |.-......./!^...l|
-00000150  ca ad 4c 22 6a 48 4d 55  63 e2 08 78 b7 88 00 77  |..L"jHMUc..x...w|
-00000160  71 bd 4d d4 c7 b3 1a 8e  a1 67 64 d9 b6 8b 2f 92  |q.M......gd.../.|
-00000170  08 68 28 2c eb 9f 5e cb  1d c3 97 6c e7 f8 36 3c  |.h(,..^....l..6<|
-00000180  1b 0c 2d ff 9b ff be e9  28 a5 69 25 23 fb fe 28  |..-.....(.i%#..(|
-00000190  f9 b2 5a 2b 8d 55 42 f8  cc 50 1d 43 6c 09 f1 75  |..Z+.UB..P.Cl..u|
-000001a0  86 9b fc b9 34 e6 52 a8  0f 6b c9 8f 1f 35 77 c8  |....4.R..k...5w.|
-000001b0  9d ec 96 c0 0a fb 5b 64  ae 1f 79 f9 fc b5 af 20  |......[d..y.... |
-000001c0  e1 a6 dc e0 fa 29 b6 9d  15 b4 cc e5 20 54 df 0a  |.....)...... T..|
-000001d0  74 b6 46 94 11 f3 48 25  85 4d 92 f3 a5 fb 37 46  |t.F...H%.M....7F|
-000001e0  83 64 ee 61 82 85 f6 4d  8d 83 ca a5 51 7a dc f7  |.d.a...M....Qz..|
-000001f0  ed cb 5c 40 3f 31 86 67  87 d8 23 c9 8b f3 5c f6  |..\@?1.g..#...\.|
-00000200  f7 4b f7 45 51 c5 87 9e  2e d1 00 c3 71 7b 72 c6  |.K.EQ.......q{r.|
-00000210  91 f1 4e d4 a0 10 2c 73  39 0b 22 7e f6 28 08 e3  |..N...,s9."~.(..|
-00000220  28 09 09 09 f6 6e 92 73  8d 44 56 c1 f4 4a 19 4c  |(....n.s.DV..J.L|
-00000230  77 7e bc eb ce 40 04 eb  68 fa cf 32 bc c2 c7 66  |w~...@..h..2...f|
-00000240  95 45 74 2d 1b 01 85 f7  f2 76 a0 63 f9 5f b4 cf  |.Et-.....v.c._..|
-00000250  ad af 8d a5 80 1d f8 2c  ed 1a a4 4d a8 9c 80 56  |.......,...M...V|
-00000260  dd 0e 8b 93 58 cf 5e 51  b4 6e d3 a4 ec 7c 1e 92  |....X.^Q.n...|..|
-00000270  79 76 fb d2 74 c7 63 4c  51 67 d2 d5 66 06 e4 bf  |yv..t.cLQg..f...|
-00000280  bf 67 32 28 0e 4a 6c 78  58 a4 53 36 aa 3f 73 ae  |.g2(.JlxX.S6.?s.|
-00000290  c2 57 5a 04 6d 68 4f 54  54 eb 57 35 1c 46 c5 fc  |.WZ.mhOTT.W5.F..|
-000002a0  de bd 2e d1 c2 71 6a a6  01 4c 07 ae a9 29 fb 46  |.....qj..L...).F|
-000002b0  0e 6b 99 51 bf 34 fa b2  b2 4b 3b 61 65 b2 32 83  |.k.Q.4...K;ae.2.|
-000002c0  92 f7 4b 9c 55 68 5f 04  5a 6d 94 07 c4 c6 6b 10  |..K.Uh_.Zm....k.|
-000002d0  bf 8f d3 1a 65 14 7e d7  c7 07 4b 78 05 ca 6b b0  |....e.~...Kx..k.|
-000002e0  ca 79 c8 f1 23 cc 6b f9  a7 ed f9 12 e7 de 07 55  |.y..#.k........U|
-000002f0  67 52 08 92 cf 27 69 e2  f5 91 68 0d 75 ac 32 6f  |gR...'i...h.u.2o|
-00000300  7b bd dc 94 f5 0c aa aa  83 3b 52 c4 b3 a2 76 f9  |{........;R...v.|
-00000310  78 60 6c 25 1b c7 fb c6  b2 d2 8c cc e9 ea 4d 64  |x`l%..........Md|
-00000320  87 b1 8f 69 a4 f5 f3 19  34 44 fe 75 18 67 43 3c  |...i....4D.u.gC<|
-00000330  14 70 b1 fe d1 cb ac 96  cd 52 52 41 4a 8a 07 9a  |.p.......RRAJ...|
-00000340  88 37 0d 41 f2 76 45 96  e9 92 b3 68 37 e4 c9 1a  |.7.A.vE....h7...|
-00000350  cf 30 a3 82 9e bf 17 03  03 00 99 aa a6 fb 04 2a  |.0.............*|
-00000360  45 b2 46 a6 1e 10 fb 54  c1 a9 a2 78 af 18 d9 00  |E.F....T...x....|
-00000370  63 a1 4c 35 1a 4e 10 52  d5 2a 79 ec 45 aa ac 91  |c.L5.N.R.*y.E...|
-00000380  f9 10 d2 45 a7 96 5a 91  08 06 c0 0c 57 3b 51 50  |...E..Z.....W;QP|
-00000390  ad bf 6b 26 19 c4 ce a2  e1 b4 34 bf a1 1a f7 ba  |..k&......4.....|
-000003a0  ec 9f 3e a1 8b 43 09 6f  a0 d4 44 87 2a d6 a0 b7  |..>..C.o..D.*...|
-000003b0  2d 20 69 fd cb a2 a3 e1  5b 39 96 5e a7 c6 49 9a  |- i.....[9.^..I.|
-000003c0  08 ad a8 16 f7 9e 9a 70  6b bb a6 15 65 66 70 bd  |.......pk...efp.|
-000003d0  9c 8d 35 b8 04 6f 70 65  e7 13 d2 0b 01 f1 59 cc  |..5..ope......Y.|
-000003e0  34 30 c7 27 f9 7d 29 3a  06 f6 65 ee b9 e1 49 03  |40.'.}):..e...I.|
-000003f0  2e 70 2a 4e 17 03 03 00  35 0a 5c ff 25 fc 85 96  |.p*N....5.\.%...|
-00000400  d3 b8 75 be 51 0b 38 79  fa 15 3d 43 f7 b2 2c d0  |..u.Q.8y..=C..,.|
-00000410  25 ae 1d 07 87 1e 62 7e  4f 6b f6 3b 3d 8c c8 0c  |%.....b~Ok.;=...|
-00000420  65 32 75 fc 02 06 ff f8  0f 5f bb 6a cf 25        |e2u......_.j.%|
+00000080  03 03 00 01 01 17 03 03  00 17 7c c9 7c a6 00 36  |..........|.|..6|
+00000090  2d 68 e4 e2 89 d7 77 2b  0d a4 23 b6 37 6a 0d 37  |-h....w+..#.7j.7|
+000000a0  b4 17 03 03 00 3e ec d2  d9 90 24 85 fc 75 e7 ea  |.....>....$..u..|
+000000b0  58 ec 2b 95 b0 df 55 c2  c9 7f 8e 7f d6 17 cc d0  |X.+...U.........|
+000000c0  57 9c dc 9a e9 55 37 b6  d1 29 e5 85 53 46 49 94  |W....U7..)..SFI.|
+000000d0  11 cb 4b 7b 33 0a d8 40  d4 39 96 fc 21 95 28 c6  |..K{3..@.9..!.(.|
+000000e0  6b 60 b7 f9 17 03 03 02  6d d9 98 0a 7b bf b2 2c  |k`......m...{..,|
+000000f0  40 e3 fb 52 58 dd c0 40  90 66 78 de 3b ed e5 6f  |@..RX..@.fx.;..o|
+00000100  95 bb c2 c6 7c 69 24 13  79 24 13 48 48 6a cf a4  |....|i$.y$.HHj..|
+00000110  07 28 9d b0 2a b6 f1 46  a1 c4 3c 4d de ae 1f f4  |.(..*..F..<M....|
+00000120  43 49 fe 1c 1b 3d 7e 6a  b2 09 d4 4f f6 6e 43 24  |CI...=~j...O.nC$|
+00000130  54 42 06 82 40 47 bf ca  47 6d f8 5a 34 67 2f 59  |TB..@G..Gm.Z4g/Y|
+00000140  87 f6 ed 3c 71 46 2a 50  a4 d7 53 2e f8 08 7e 38  |...<qF*P..S...~8|
+00000150  e1 b7 5a 63 06 2f 6f 8f  79 e2 f4 88 f2 8b 08 40  |..Zc./o.y......@|
+00000160  03 77 5b 70 4f 72 18 a9  0b c1 66 37 89 93 e9 52  |.w[pOr....f7...R|
+00000170  f0 92 aa 19 7b 01 f3 03  f0 99 df 95 78 86 26 70  |....{.......x.&p|
+00000180  a6 a6 ac a2 4b 75 5d 79  ba 96 9a e1 87 58 ac 8b  |....Ku]y.....X..|
+00000190  8b 2f ed da d0 1a 05 e2  c6 23 da 87 df f0 07 44  |./.......#.....D|
+000001a0  62 9f 57 ca 7b 35 dc ec  46 8d 32 ad 52 63 54 04  |b.W.{5..F.2.RcT.|
+000001b0  21 6d 9e d8 df 36 44 ca  20 e4 c8 54 46 c5 53 cc  |!m...6D. ..TF.S.|
+000001c0  aa 53 e2 d4 6b 58 64 82  a4 64 b4 72 3c 17 30 d7  |.S..kXd..d.r<.0.|
+000001d0  77 08 a0 6a c5 d7 2b d4  7f ad d5 07 5a 58 a1 aa  |w..j..+.....ZX..|
+000001e0  20 44 03 41 e0 63 01 ca  24 d1 dc 6a 15 74 ad 04  | D.A.c..$..j.t..|
+000001f0  7c f9 17 28 28 08 fd b3  6f 84 60 d3 e3 7f d0 79  ||..((...o.`....y|
+00000200  12 40 7f 47 ac 4e 42 8d  c7 0e b4 ff 8d 2c 90 92  |.@.G.NB......,..|
+00000210  df 0f 6e 03 23 d1 17 53  63 e4 62 23 d9 af ab 7a  |..n.#..Sc.b#...z|
+00000220  cc 61 a8 30 dc 42 b6 8e  a6 a1 2e bc 4c 51 ef ee  |.a.0.B......LQ..|
+00000230  30 de 5a 13 5f 40 eb 58  1e ef f4 44 df f8 c5 04  |0.Z._@.X...D....|
+00000240  ca a3 93 ea 82 a9 76 10  0f a5 9d ac 32 46 a3 80  |......v.....2F..|
+00000250  a9 02 81 0a 7d a1 07 62  2c 6c 0f 90 e2 ee 94 63  |....}..b,l.....c|
+00000260  90 60 80 c6 39 ad 78 84  2e 44 86 d2 2c 0a 39 8f  |.`..9.x..D..,.9.|
+00000270  cd ae 68 ff 0a b5 4a 62  c2 dd 9a f9 90 cd e0 e3  |..h...Jb........|
+00000280  99 a0 f2 32 27 7e 04 a9  18 5f 67 13 44 ee 5d 76  |...2'~..._g.D.]v|
+00000290  5d 1b 14 e5 fb 9a 47 86  b5 c4 f4 d3 15 e7 2a 0b  |].....G.......*.|
+000002a0  62 aa 4d 5d 35 1a dd 23  a1 84 1b 76 22 d4 66 92  |b.M]5..#...v".f.|
+000002b0  04 1b 2c 99 81 44 0f cb  93 1b a0 ad 58 47 9e a5  |..,..D......XG..|
+000002c0  80 11 ff 23 0d a6 26 dc  fe 77 ee 28 a6 3b 69 c3  |...#..&..w.(.;i.|
+000002d0  e6 64 25 9a 7e 01 b1 27  7c b5 5d 00 b0 53 a1 f7  |.d%.~..'|.]..S..|
+000002e0  28 4f 7c aa dc f2 d0 da  72 a2 3c ea f4 3f c8 f5  |(O|.....r.<..?..|
+000002f0  38 8a 77 84 bf 22 b8 ea  09 48 97 25 4f 79 06 32  |8.w.."...H.%Oy.2|
+00000300  25 5b 25 07 86 2d b5 d8  43 1e 5f 2b 94 f4 37 11  |%[%..-..C._+..7.|
+00000310  2f f8 fa e8 61 08 c1 a9  e3 d2 f7 c2 54 6f 9e 76  |/...a.......To.v|
+00000320  0b 75 63 f2 d3 7c 11 dc  76 2c d0 90 c5 d6 5b ca  |.uc..|..v,....[.|
+00000330  ad a5 05 95 d8 d4 82 5e  bb 9d c1 6a 44 e0 ef 2d  |.......^...jD..-|
+00000340  0f 9d e5 56 da 50 7f 23  4b e0 e0 18 15 06 ca 75  |...V.P.#K......u|
+00000350  57 94 e6 a5 7a d0 17 03  03 00 99 91 94 6a 06 78  |W...z........j.x|
+00000360  3b e8 62 16 af 21 e9 5c  b3 05 0f 25 04 0a df fc  |;.b..!.\...%....|
+00000370  22 64 42 e8 bf bf bd 39  9f 6d b1 e1 d2 ef 8b b0  |"dB....9.m......|
+00000380  4d ce a4 71 de e4 fc 83  1f c9 9c 3e e1 72 6a 49  |M..q.......>.rjI|
+00000390  29 43 57 5c c4 a0 40 2b  92 34 95 76 0c 73 f0 d0  |)CW\..@+.4.v.s..|
+000003a0  04 65 96 e1 1a a9 7e d7  33 a2 44 c3 71 ab 56 96  |.e....~.3.D.q.V.|
+000003b0  da 6e 8e 60 2c 7d 6b 53  8b 1d 1d 7d 4e ef c8 1c  |.n.`,}kS...}N...|
+000003c0  cf 8b 63 3b 7c 3a 4a b4  af 69 48 bd f1 79 c4 b8  |..c;|:J..iH..y..|
+000003d0  64 4c 8a d7 89 88 ca 56  57 55 5d aa 0f 0c 31 12  |dL.....VWU]...1.|
+000003e0  df bc 23 f6 25 b6 f8 47  87 e3 48 de ab 2a 9c 9e  |..#.%..G..H..*..|
+000003f0  3b 26 6c c0 17 03 03 00  35 f8 d2 d2 c6 d3 d5 48  |;&l.....5......H|
+00000400  c0 b5 06 6d b4 b7 16 09  7d 88 f7 dc 66 aa ef ef  |...m....}...f...|
+00000410  fb bb ee 86 88 7f 4c fc  06 f6 c2 b5 7e 0e 9a c8  |......L.....~...|
+00000420  86 70 98 de 7c c1 60 1f  f6 57 11 05 c4 77        |.p..|.`..W...w|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 19 29 de a5 0a f8  |...........)....|
-00000010  13 ac df 51 6b f2 e7 95  a0 4e 86 65 f9 ea 22 c8  |...Qk....N.e..".|
-00000020  16 e8 da af 17 03 03 00  35 e3 74 44 e3 b2 b1 68  |........5.tD...h|
-00000030  3b 45 79 b8 ec 67 6b 0c  1f 8d 48 77 d4 50 2c cb  |;Ey..gk...Hw.P,.|
-00000040  d1 31 f1 fa c3 7f aa 31  83 18 73 8f 8c e8 e2 de  |.1.....1..s.....|
-00000050  6a 74 1d 4d da ec 14 fc  a5 66 d9 e8 a8 de        |jt.M.....f....|
+00000000  14 03 03 00 01 01 17 03  03 00 19 fe ff 8a 7c e1  |..............|.|
+00000010  09 c4 c5 8d 6b e6 3e 7e  df c8 ca f8 82 be 5d 24  |....k.>~......]$|
+00000020  99 86 04 9a 17 03 03 00  35 83 ec fb fc 9d 19 9b  |........5.......|
+00000030  b0 55 2d 99 1f be a9 3a  35 de 1b b5 d5 cd 4a f4  |.U-....:5.....J.|
+00000040  3a e3 73 fa a9 49 0b 8f  32 22 6d b7 06 a5 72 46  |:.s..I..2"m...rF|
+00000050  11 8b 17 ef 8a 0c b7 7c  45 d7 3f 81 ad a3        |.......|E.?...|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 83 a0 be b0  41 ae 6f 75 0c dc e8 a9  |........A.ou....|
-00000010  e8 cb 7a 36 0e 70 fd 88  8b 5d a0 5c 6d 08 7d c9  |..z6.p...].\m.}.|
-00000020  0b 34 73 76 d9 b0 b9 08  d7 fd dd 19 c5 27 70 7e  |.4sv.........'p~|
-00000030  80 1b 0b b0 28 c1 4b af  27 3e 4e 94 c1 2e 8e 9e  |....(.K.'>N.....|
-00000040  7c d2 22 ad 03 7f 61 c4  3e 43 db 53 82 21 e5 06  ||."...a.>C.S.!..|
-00000050  d9 fb 18 44 6b 65 3a 98  ee 46 5c 5c 5d 4c 2c 2d  |...Dke:..F\\]L,-|
-00000060  44 0d 7c a4 bc 9f 51 a0  e3 91 02 67 87 ef e2 9a  |D.|...Q....g....|
-00000070  df 83 93 f0 81 4c bd 0e  fa 19 7c b9 9d e6 c7 7f  |.....L....|.....|
-00000080  e7 6a 4b f6 70 6a f1 06  17 03 03 00 1e 8c c6 02  |.jK.pj..........|
-00000090  f9 ca a1 5d 67 a0 08 12  6a e3 0f da 01 65 12 8d  |...]g...j....e..|
-000000a0  eb 4c aa b5 e1 d7 3a ed  cb 83 82 17 03 03 00 13  |.L....:.........|
-000000b0  2c 1f b8 b8 e0 8a 45 15  d7 8a 24 1d 84 39 e3 fb  |,.....E...$..9..|
-000000c0  29 e2 39                                          |).9|
+00000000  17 03 03 00 83 30 99 9b  b3 15 aa 30 48 b2 8a 81  |.....0.....0H...|
+00000010  94 b6 65 3c 44 dd ee 1e  5c 60 a7 81 a7 02 bc 93  |..e<D...\`......|
+00000020  e3 d0 02 10 e0 b2 93 98  b0 06 7a d6 28 e3 29 80  |..........z.(.).|
+00000030  51 98 55 80 c8 4b d1 ff  c0 42 e9 33 11 05 d9 e5  |Q.U..K...B.3....|
+00000040  55 a9 70 24 43 a9 8a 42  14 9a e1 90 c0 b2 6b 4f  |U.p$C..B......kO|
+00000050  35 30 e2 24 6c 64 50 ab  34 85 7e 16 b9 d2 7b ea  |50.$ldP.4.~...{.|
+00000060  f4 d2 29 14 e0 c8 f7 ed  5f 31 a4 50 48 41 5c 80  |..)....._1.PHA\.|
+00000070  84 a8 c9 a5 be b1 f9 5b  79 13 91 4d 30 54 19 02  |.......[y..M0T..|
+00000080  91 1e 8d d4 0a fb 44 51  17 03 03 00 1e e3 77 8c  |......DQ......w.|
+00000090  99 25 ff 72 46 46 89 4d  d9 fc 03 04 58 30 ee 7a  |.%.rFF.M....X0.z|
+000000a0  11 b0 8d 1e f4 12 99 a5  b7 d8 95 17 03 03 00 13  |................|
+000000b0  72 ea 98 46 18 36 2d 24  e7 41 4f 32 a0 4f d0 9b  |r..F.6-$.AO2.O..|
+000000c0  53 88 ee                                          |S..|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Server-TLSv13-ECDHE-ECDSA-AES
index eaee1afd4a..420f586504 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Server-TLSv13-ECDHE-ECDSA-AES
@@ -1,93 +1,93 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 25 a1 ee b1 c5  |...........%....|
-00000010  4d ae 10 8c f3 a9 ad 40  cd 8f ff 4c 60 d1 ce 72  |M......@...L`..r|
-00000020  84 6f 9a e3 2d 1c 56 ee  62 23 d4 20 36 79 23 56  |.o..-.V.b#. 6y#V|
-00000030  3e d1 a2 d7 e6 67 2b 74  2b 77 b1 cc 30 fe fe 27  |>....g+t+w..0..'|
-00000040  27 42 61 1d c1 07 45 eb  b0 a2 db 08 00 04 13 01  |'Ba...E.........|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 08 e5 50 71 b5  |.............Pq.|
+00000010  fe e6 53 58 49 db b9 67  11 89 cf 26 af 70 5e 2a  |..SXI..g...&.p^*|
+00000020  78 3e f4 74 5e cc 2f 55  f4 29 ce 20 97 13 7f 8f  |x>.t^./U.). ....|
+00000030  68 9b f7 59 cb cd ba 26  6d 6f e8 ee 84 22 aa a7  |h..Y...&mo..."..|
+00000040  96 28 a5 af b3 a0 ad 35  b9 72 07 c8 00 04 13 01  |.(.....5.r......|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 9e  |-.....3.&.$... .|
-000000b0  7d d0 cb f8 6b d6 c4 8f  71 b0 28 fc 34 20 de 72  |}...k...q.(.4 .r|
-000000c0  88 d6 1b 3f 57 2b b8 ff  54 6d b2 a7 ff bf 35     |...?W+..Tm....5|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 ee  |-.....3.&.$... .|
+000000b0  61 69 aa f7 cc 93 87 9a  2e 57 fc 2d 63 16 79 61  |ai.......W.-c.ya|
+000000c0  1a 55 30 49 fc a6 90 fd  06 81 61 8d f3 4e 07     |.U0I......a..N.|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 36 79 23 56  |........... 6y#V|
-00000030  3e d1 a2 d7 e6 67 2b 74  2b 77 b1 cc 30 fe fe 27  |>....g+t+w..0..'|
-00000040  27 42 61 1d c1 07 45 eb  b0 a2 db 08 13 01 00 00  |'Ba...E.........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 97 13 7f 8f  |........... ....|
+00000030  68 9b f7 59 cb cd ba 26  6d 6f e8 ee 84 22 aa a7  |h..Y...&mo..."..|
+00000040  96 28 a5 af b3 a0 ad 35  b9 72 07 c8 13 01 00 00  |.(.....5.r......|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 45 c7 c6 ee 18 88  |..........E.....|
-00000090  55 a3 3c 65 63 0e f5 ce  5a e8 67 ce 69 69 5e a7  |U.<ec...Z.g.ii^.|
-000000a0  b7 17 03 03 02 22 9e 58  81 63 e1 c0 2c be 8f 15  |.....".X.c..,...|
-000000b0  28 92 62 9e 09 cd 98 31  75 f5 53 3e 8a 4b 63 c0  |(.b....1u.S>.Kc.|
-000000c0  7d d5 40 5d 23 d4 c2 21  a5 8d d4 3a e8 7c 08 49  |}.@]#..!...:.|.I|
-000000d0  a3 d6 27 0c 35 a1 f2 e4  ad 21 17 69 e0 c0 7e c0  |..'.5....!.i..~.|
-000000e0  0e 53 e2 52 37 d8 1f af  32 8b 63 ec f2 05 79 9f  |.S.R7...2.c...y.|
-000000f0  97 f1 35 27 c8 89 2f 57  96 db 0c bc b9 ec 1e e5  |..5'../W........|
-00000100  f6 56 17 99 8f 9a 4d e0  a5 6d 13 14 85 d2 2c 3f  |.V....M..m....,?|
-00000110  19 96 14 5a 4e 8f 3a 23  3b ea e0 c2 42 a5 6f 64  |...ZN.:#;...B.od|
-00000120  97 77 e4 80 16 42 2d bb  15 67 3c 85 d0 90 90 ad  |.w...B-..g<.....|
-00000130  01 c0 be a5 b8 cc 91 75  18 b2 0d 54 74 73 a2 04  |.......u...Tts..|
-00000140  a3 a3 3c e2 f3 19 48 88  32 82 cb be f1 9e b0 5c  |..<...H.2......\|
-00000150  6f 1d 7e 12 76 7b 20 fe  e5 c6 8a 20 03 4d a4 51  |o.~.v{ .... .M.Q|
-00000160  0e c0 18 df 5f 26 d4 6c  1a e2 0f ec d2 f6 d0 3e  |...._&.l.......>|
-00000170  08 a1 c7 9a 6e 3b 7c 9e  f8 37 6c b8 3b ed 97 e6  |....n;|..7l.;...|
-00000180  93 0e b0 0a 41 9c a5 04  f2 1a 15 3e 3e 88 c8 ac  |....A......>>...|
-00000190  b4 14 5b 19 d8 74 ed 1c  7c 3d 67 6b 52 72 2d 7e  |..[..t..|=gkRr-~|
-000001a0  a6 27 18 38 83 31 8d c9  2f ff 19 21 c5 85 79 ff  |.'.8.1../..!..y.|
-000001b0  60 52 0f cf 9c 26 cf 71  cb e3 fd 9b fc 62 82 2a  |`R...&.q.....b.*|
-000001c0  e9 36 aa 9c 60 77 f4 f3  58 ec ef 79 14 87 2b 22  |.6..`w..X..y..+"|
-000001d0  b0 c1 be 30 39 c9 32 c7  aa 07 16 ab 7d 51 ee e4  |...09.2.....}Q..|
-000001e0  91 98 29 3b 4e 34 69 5d  da 2b 9a 4e db e4 12 87  |..);N4i].+.N....|
-000001f0  f7 13 cc 0a 6d 3e b6 16  af 41 bc b0 bf 00 54 1c  |....m>...A....T.|
-00000200  1a 02 27 d2 e6 c0 38 dc  b1 db ed 95 5a e5 61 26  |..'...8.....Z.a&|
-00000210  89 5c 16 66 8a 71 81 10  eb 19 4c e0 9b 09 94 36  |.\.f.q....L....6|
-00000220  81 f1 f7 02 04 75 13 f8  b0 05 55 09 36 ec 0c bc  |.....u....U.6...|
-00000230  1a ed 61 da 21 35 2f 73  bb 99 74 8a 82 78 9d 47  |..a.!5/s..t..x.G|
-00000240  4f f7 56 ef b5 a2 39 68  ec ba 0b 44 0f fa fb 92  |O.V...9h...D....|
-00000250  a5 b9 6c f8 25 fa 7b 44  44 2d 66 ea 09 c1 42 1d  |..l.%.{DD-f...B.|
-00000260  f5 a4 d5 c3 56 b8 b6 95  e3 60 d2 ae 96 a0 6a 80  |....V....`....j.|
-00000270  39 88 67 8a 67 d5 11 68  c8 c8 05 9c d6 b1 b2 71  |9.g.g..h.......q|
-00000280  60 63 f4 89 24 7f 52 f9  90 48 aa 83 69 1e ce 15  |`c..$.R..H..i...|
-00000290  58 f8 a5 de 5d dc c3 b1  fe 06 03 4d 4a b0 6a c7  |X...]......MJ.j.|
-000002a0  06 3b 5b e4 78 45 fe f1  ff 64 f8 c8 4a f5 71 27  |.;[.xE...d..J.q'|
-000002b0  07 96 a2 93 17 19 a5 06  89 7c b1 ff bf 46 36 5c  |.........|...F6\|
-000002c0  a4 6d 37 92 9c de 58 d1  17 03 03 00 a4 d2 c3 c6  |.m7...X.........|
-000002d0  49 c2 0e a6 e2 84 da 85  60 86 df e6 ef 41 9b 01  |I.......`....A..|
-000002e0  81 4d e3 8a 31 7f 33 ba  6a 03 68 b1 87 f6 ea 7e  |.M..1.3.j.h....~|
-000002f0  3b e5 df 71 c1 49 4f 28  85 33 47 30 00 be 2e 8f  |;..q.IO(.3G0....|
-00000300  fc c6 69 1e 99 cb 1b d6  b5 55 14 19 d5 f1 81 23  |..i......U.....#|
-00000310  97 0c 87 25 8f 34 3f d2  81 67 8d a0 3b f1 d0 70  |...%.4?..g..;..p|
-00000320  ed f6 f9 51 3f 40 68 ed  c5 3c 04 05 f0 55 00 e6  |...Q?@h..<...U..|
-00000330  7e 4f f1 2b 93 a0 0a d8  14 5e ef b9 80 25 be bc  |~O.+.....^...%..|
-00000340  42 af 20 2b 50 7f 62 a7  49 4d b9 23 d8 8f 78 08  |B. +P.b.IM.#..x.|
-00000350  fa 6a a5 10 52 36 38 d4  54 29 8c 98 99 89 fd 45  |.j..R68.T).....E|
-00000360  06 2f 42 65 f7 2f 80 2b  76 60 eb d2 0d cb a5 6f  |./Be./.+v`.....o|
-00000370  12 17 03 03 00 35 bc 0b  13 05 9b c4 d1 48 60 fb  |.....5.......H`.|
-00000380  19 bf 36 2f 91 87 0d 2e  3c 8c 73 2f 21 69 b8 26  |..6/....<.s/!i.&|
-00000390  ae 0b 02 cc 5f 28 2d b8  0c 0c 46 5b 49 a8 4d cc  |...._(-...F[I.M.|
-000003a0  42 bd dc 96 f3 92 31 2b  d3 0e e9 17 03 03 00 83  |B.....1+........|
-000003b0  08 6f fb 8e 96 73 98 ca  4a 09 27 53 b4 5c 0e 7b  |.o...s..J.'S.\.{|
-000003c0  52 f1 96 13 9f 49 85 24  6f 93 0b 06 c9 99 00 92  |R....I.$o.......|
-000003d0  b2 ea 5d 6c 57 04 56 30  98 30 c6 61 19 e0 55 b4  |..]lW.V0.0.a..U.|
-000003e0  4d a6 0a 24 c2 1f 9a cf  c0 b1 52 dc 4a 02 b4 22  |M..$......R.J.."|
-000003f0  66 5d 31 2c 20 84 66 da  9d dd 30 c7 e0 aa cf 93  |f]1, .f...0.....|
-00000400  a0 6f fb 5c 1e c0 9b 6b  b1 39 0c 18 b0 da 9b 3c  |.o.\...k.9.....<|
-00000410  8a 90 eb db ac 73 1e 32  cf b6 65 a8 c5 0c 31 49  |.....s.2..e...1I|
-00000420  13 82 04 ae 6f 49 59 a0  5a 9f d6 ad ef 65 06 b4  |....oIY.Z....e..|
-00000430  b1 dd 70                                          |..p|
+00000080  03 03 00 01 01 17 03 03  00 17 80 0e e1 48 08 70  |.............H.p|
+00000090  d3 ab 10 9b 60 76 d7 c4  3b 5a 64 ec 30 12 c3 e8  |....`v..;Zd.0...|
+000000a0  81 17 03 03 02 22 81 de  fe d1 9b 80 4f 94 16 00  |....."......O...|
+000000b0  2b ce 52 36 6d 14 50 ad  71 37 ed 6d d2 4b 1f ae  |+.R6m.P.q7.m.K..|
+000000c0  f3 b3 f7 e8 e1 27 67 1e  90 83 39 90 97 19 a2 d1  |.....'g...9.....|
+000000d0  ab f6 db 8c ae 5f e1 19  50 3f f1 a3 bf 15 c1 db  |....._..P?......|
+000000e0  75 2b dd 89 65 2a 16 a2  42 c3 88 53 32 5e 84 63  |u+..e*..B..S2^.c|
+000000f0  64 18 58 a0 da f0 72 ee  49 91 62 44 10 50 50 5e  |d.X...r.I.bD.PP^|
+00000100  19 59 55 3c f3 e4 8e 65  af 45 68 ee d1 be 7b 8d  |.YU<...e.Eh...{.|
+00000110  78 33 d8 26 e5 5d fd 50  46 63 93 7d 8d 1f da 9e  |x3.&.].PFc.}....|
+00000120  3b 54 9b cb 33 41 5e d9  24 4f 3b 9a db 9d c8 0f  |;T..3A^.$O;.....|
+00000130  33 5c cf 1c 47 4a 4e c5  f6 d4 48 6c 2e 43 da f1  |3\..GJN...Hl.C..|
+00000140  a1 55 4d 2a ea 4e fa 4f  a3 98 e7 8c 44 61 e3 11  |.UM*.N.O....Da..|
+00000150  52 f6 aa 7f 75 48 61 10  cb 10 29 b6 f9 b0 ce 83  |R...uHa...).....|
+00000160  ce 28 fe 86 fe 9f e9 2d  38 0b b6 28 1a 76 86 9c  |.(.....-8..(.v..|
+00000170  15 89 19 0e 60 e0 c3 97  60 78 80 72 5d 0e cf 0e  |....`...`x.r]...|
+00000180  ba f7 c8 6a 0d 70 3c 24  c1 76 29 d6 36 cc b4 64  |...j.p<$.v).6..d|
+00000190  a1 80 97 e8 81 cb eb 73  c0 7b a9 1e 83 25 32 0d  |.......s.{...%2.|
+000001a0  ab 7c b0 8e 58 3f d5 76  33 48 13 a3 d9 79 1c 61  |.|..X?.v3H...y.a|
+000001b0  00 ce d2 38 6b 2c 49 14  7c 33 de 32 a0 32 b7 03  |...8k,I.|3.2.2..|
+000001c0  a2 c7 35 61 c6 12 a6 1e  95 96 42 dd f4 f3 87 f4  |..5a......B.....|
+000001d0  17 8c b1 1a 6e df d3 96  96 40 6a a7 69 e1 da 6f  |....n....@j.i..o|
+000001e0  51 8c 43 3c d8 b2 f9 02  96 b9 fb 42 92 8b 4e 3b  |Q.C<.......B..N;|
+000001f0  6a a7 f8 f8 b0 58 b3 7e  4b a0 f9 7f 58 28 ec a3  |j....X.~K...X(..|
+00000200  aa 4a 59 dc 7e ef ef c0  7a 2a 2a c6 5d 52 70 96  |.JY.~...z**.]Rp.|
+00000210  eb 09 46 74 05 30 b4 54  f0 ba 43 c8 75 fd b2 79  |..Ft.0.T..C.u..y|
+00000220  51 4e 52 a8 af 0a 5b af  8e 0f d9 07 0e ea a6 cc  |QNR...[.........|
+00000230  d7 7e 29 67 5f c6 80 97  6a 90 fd 2a ce dd 48 7f  |.~)g_...j..*..H.|
+00000240  9f a1 fc 8d d1 1b 7b 6f  9d 93 34 b5 f4 d1 c5 a7  |......{o..4.....|
+00000250  71 35 d2 36 4d 71 db bc  8f ea ac 99 3e 6f 06 bf  |q5.6Mq......>o..|
+00000260  16 49 37 64 22 6f 7f 64  a0 3b 03 8d 49 15 a4 3f  |.I7d"o.d.;..I..?|
+00000270  33 6f 31 09 cb 11 6a da  9f c6 98 d5 1d ea e4 d4  |3o1...j.........|
+00000280  e7 36 41 f8 b9 7a 9e 4a  bd 53 95 5d c1 b2 43 23  |.6A..z.J.S.]..C#|
+00000290  b6 5a 01 e6 18 f1 51 3f  d2 15 13 33 ba a3 c1 d7  |.Z....Q?...3....|
+000002a0  56 b0 46 c8 17 58 ae b2  e2 e1 3b df 8c 8f e7 c1  |V.F..X....;.....|
+000002b0  55 4f c6 96 71 98 e3 a4  ea 47 5b b1 fb 5e 9a 60  |UO..q....G[..^.`|
+000002c0  5e 86 46 90 95 72 1d 85  17 03 03 00 a3 f3 72 29  |^.F..r........r)|
+000002d0  ee 0e 57 86 d7 7b 44 b5  78 49 f5 bf 66 b3 e9 b1  |..W..{D.xI..f...|
+000002e0  ae b8 d2 fe ea 17 6d 02  65 a7 64 ce 0b 8c 94 1d  |......m.e.d.....|
+000002f0  cf aa 7e f3 7e 55 a9 34  be 36 83 e6 7e 93 0a 06  |..~.~U.4.6..~...|
+00000300  27 ec f8 ca 89 64 50 d9  f8 84 58 1d b5 f5 d7 94  |'....dP...X.....|
+00000310  1a 0b 32 cd 44 fb 39 77  71 15 e5 03 3c a1 42 38  |..2.D.9wq...<.B8|
+00000320  a5 d8 d3 1c b9 8b 12 60  48 58 79 42 da 0a 00 ce  |.......`HXyB....|
+00000330  e7 ac 08 5d 32 16 18 8b  80 af 18 b9 82 b7 41 39  |...]2.........A9|
+00000340  57 e6 e7 ae ef d7 ee 2c  1b a2 c2 e3 71 9d 71 4a  |W......,....q.qJ|
+00000350  64 c6 c7 41 ed f6 fe 67  0f 9d fe a8 c3 2b 21 eb  |d..A...g.....+!.|
+00000360  62 7a 51 f0 f7 6b 7d c0  75 0c 11 62 1b 88 08 e8  |bzQ..k}.u..b....|
+00000370  17 03 03 00 35 00 ed 4c  d6 81 11 ab fc ac 91 07  |....5..L........|
+00000380  05 33 fe 47 7a 5e 55 26  04 6f a9 12 65 fd 8a 7d  |.3.Gz^U&.o..e..}|
+00000390  fb c8 12 f6 06 ad f6 95  99 66 d5 77 2d 25 c0 86  |.........f.w-%..|
+000003a0  bf 50 94 e3 9d 4f fc eb  a2 93 17 03 03 00 83 e4  |.P...O..........|
+000003b0  54 d3 ed 57 e7 14 b3 b5  db b6 c3 b5 57 c4 7e 01  |T..W........W.~.|
+000003c0  48 d1 e0 c5 52 8e b8 52  7b af 5b 60 c3 92 cf 28  |H...R..R{.[`...(|
+000003d0  af a8 f4 76 1d a3 54 2a  0b 18 80 c0 1d e3 a4 69  |...v..T*.......i|
+000003e0  9e 63 ca d6 25 62 4a c4  33 10 f8 4b 6c 8f 1f 32  |.c..%bJ.3..Kl..2|
+000003f0  ea 42 ec 1e d6 d2 72 e4  6b a4 36 2d d5 43 44 00  |.B....r.k.6-.CD.|
+00000400  d6 19 0b 1a 14 59 4d 1f  0b 22 8a 7c af ff 64 b5  |.....YM..".|..d.|
+00000410  35 53 d2 b0 97 9a 68 5a  55 34 90 ff 4a 0d d0 4b  |5S....hZU4..J..K|
+00000420  2a 87 b3 6b ef 8d 3d 94  e4 80 27 d6 f6 2e 77 86  |*..k..=...'...w.|
+00000430  97 ea                                             |..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 f2 c5 54 a5 bc  |..........5..T..|
-00000010  50 73 b8 3f 08 ff aa d4  76 fc 53 ef 00 f0 a9 ce  |Ps.?....v.S.....|
-00000020  cb 1b 35 fa 81 78 10 f4  80 46 36 14 95 b2 84 0a  |..5..x...F6.....|
-00000030  be 28 5e 17 9f 35 ea 26  66 cd 60 ee 78 6b 66 07  |.(^..5.&f.`.xkf.|
+00000000  14 03 03 00 01 01 17 03  03 00 35 6b 55 7f 41 d1  |..........5kU.A.|
+00000010  f2 6b e9 a7 24 63 8a 25  95 27 26 a3 d3 83 bf 61  |.k..$c.%.'&....a|
+00000020  5d 69 93 83 90 d5 db b0  0a 8f 86 5f bd 6c b4 3b  |]i........._.l.;|
+00000030  18 01 79 9c bd 75 1a cc  97 aa 84 20 44 10 64 3a  |..y..u..... D.d:|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 51 ee 16  18 ad 74 b8 bb 1e 7c 29  |.....Q....t...|)|
-00000010  03 0d 14 9c cb d3 40 7b  5d c1 ac a4 36 d9 ad 0e  |......@{]...6...|
-00000020  bf 88 74 17 03 03 00 13  e3 8d 5a 22 53 26 58 2c  |..t.......Z"S&X,|
-00000030  3b b8 7e 93 d2 ee f9 96  41 51 61                 |;.~.....AQa|
+00000000  17 03 03 00 1e c3 c6 fe  d6 d7 1c 1a 8f 2d 14 86  |.............-..|
+00000010  0a 20 6b 22 45 e3 94 f9  0b 1f 2f 42 d4 2a 0d b3  |. k"E...../B.*..|
+00000020  19 1a 9d 17 03 03 00 13  41 b9 bb 53 ad 84 aa be  |........A..S....|
+00000030  ab 68 e8 b9 e0 c7 0f fb  79 54 a7                 |.h......yT.|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-Ed25519 b/src/crypto/tls/testdata/Server-TLSv13-Ed25519
index e19a844c6a..8b3d2178ca 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-Ed25519
+++ b/src/crypto/tls/testdata/Server-TLSv13-Ed25519
@@ -1,75 +1,75 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 ee 40 7e bc 51  |............@~.Q|
-00000010  b9 44 d6 ed 10 e0 d7 89  59 51 90 e8 fa b8 c5 ee  |.D......YQ......|
-00000020  5e 35 33 26 fc 69 1d f2  b3 d3 62 20 7d 94 3a 7e  |^53&.i....b }.:~|
-00000030  84 93 91 bc 1a 79 9a b9  be 6d 57 97 e0 8f 86 2b  |.....y...mW....+|
-00000040  f2 b1 7c 74 38 22 cb d5  91 e5 de 8a 00 04 13 03  |..|t8"..........|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 41 35 3f bf d3  |...........A5?..|
+00000010  02 fe ca 4f 8b 8e 13 41  9a 05 ed af d6 dc bd 83  |...O...A........|
+00000020  c1 8d 03 8e 05 6a 33 e9  14 77 c3 20 f6 75 14 57  |.....j3..w. .u.W|
+00000030  6a 1f 9c 82 b5 e5 ff c4  8c d4 d3 8b df 8f e7 2b  |j..............+|
+00000040  c7 08 2d b1 96 c7 db cb  12 67 f3 5c 00 04 13 03  |..-......g.\....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 c7  |-.....3.&.$... .|
-000000b0  a5 a0 44 23 d6 3c 7c 95  ed f8 65 03 db 86 9a 30  |..D#.<|...e....0|
-000000c0  14 c4 7c af 79 45 3d d5  1b 5f ab 6d 18 6a 57     |..|.yE=.._.m.jW|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 e6  |-.....3.&.$... .|
+000000b0  e7 55 dd da b4 b5 37 9a  68 3c 20 04 3a 29 e8 8d  |.U....7.h< .:)..|
+000000c0  94 d9 13 95 6e 4b 3e 9b  48 39 e0 31 f0 2d 38     |....nK>.H9.1.-8|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 7d 94 3a 7e  |........... }.:~|
-00000030  84 93 91 bc 1a 79 9a b9  be 6d 57 97 e0 8f 86 2b  |.....y...mW....+|
-00000040  f2 b1 7c 74 38 22 cb d5  91 e5 de 8a 13 03 00 00  |..|t8"..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 f6 75 14 57  |........... .u.W|
+00000030  6a 1f 9c 82 b5 e5 ff c4  8c d4 d3 8b df 8f e7 2b  |j..............+|
+00000040  c7 08 2d b1 96 c7 db cb  12 67 f3 5c 13 03 00 00  |..-......g.\....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 34 b2 17 39 86 54  |..........4..9.T|
-00000090  2c 17 16 6f e4 38 6f 18  a3 49 12 bb b7 a2 ba 9a  |,..o.8o..I......|
-000000a0  2d 17 03 03 01 50 be e0  77 88 30 61 5c e1 bb 64  |-....P..w.0a\..d|
-000000b0  d9 07 c7 0c ec fb 79 68  c9 f2 b8 6c d7 97 4a 72  |......yh...l..Jr|
-000000c0  d6 09 70 44 d5 83 41 c2  d3 a1 d6 0d a3 f7 8a f7  |..pD..A.........|
-000000d0  c8 9c 8c 95 51 a7 e6 7c  ad 0d 70 94 43 f8 4c aa  |....Q..|..p.C.L.|
-000000e0  5a 82 26 3b 53 bd 97 57  90 05 51 56 ae 3f 6a 7f  |Z.&;S..W..QV.?j.|
-000000f0  e8 57 2f 8e bc da 19 aa  5b 1e d6 b1 dd 98 71 33  |.W/.....[.....q3|
-00000100  17 d4 b6 b7 48 07 64 fa  1c 01 a3 96 b8 5d f4 e9  |....H.d......]..|
-00000110  77 77 58 2f 49 83 0a 7d  73 9a 87 2a f8 b3 21 96  |wwX/I..}s..*..!.|
-00000120  6c 36 05 5c 7a 30 ad 26  89 ca f1 fc f4 2c c8 6d  |l6.\z0.&.....,.m|
-00000130  6b 55 97 2c 3a 7d 8e 76  37 70 16 a4 37 45 cd f3  |kU.,:}.v7p..7E..|
-00000140  cf 7b c0 9e 70 93 c1 8e  ac a9 37 a9 66 1e f5 5b  |.{..p.....7.f..[|
-00000150  34 8e ba bc 36 4f 9b d6  f3 82 90 36 8e aa e5 4a  |4...6O.....6...J|
-00000160  34 12 52 76 c0 b8 46 76  d1 43 e8 0b 3a 93 58 95  |4.Rv..Fv.C..:.X.|
-00000170  32 7d a0 7a dc 93 f8 23  ce 53 b8 39 77 56 1e e2  |2}.z...#.S.9wV..|
-00000180  60 08 d7 76 f5 d5 b1 8b  45 9c 0e b0 6a 96 21 8f  |`..v....E...j.!.|
-00000190  c0 4c 5f a7 e0 dd aa 63  28 a9 4c 5b b2 a3 57 88  |.L_....c(.L[..W.|
-000001a0  66 7c 7e 60 14 5f 21 ee  2e ff 8e 3e 66 f2 60 ed  |f|~`._!....>f.`.|
-000001b0  b3 0f f7 7e f2 6c e2 3c  9c 5e 20 d9 5b 98 64 22  |...~.l.<.^ .[.d"|
-000001c0  bb 0c 1d bf 7a 92 7b 19  ed 95 6d c9 14 13 6d 19  |....z.{...m...m.|
-000001d0  ef 17 6a 65 cf 66 16 99  ce 21 a0 a5 ed 1f 4c de  |..je.f...!....L.|
-000001e0  fd 78 13 f2 7e e5 ae 2c  c2 05 1d 54 97 8a f9 3e  |.x..~..,...T...>|
-000001f0  c7 42 05 bf dd 9c 17 03  03 00 59 c4 d3 c1 57 11  |.B........Y...W.|
-00000200  07 55 6b 59 4d b3 82 78  cb d2 84 4c bf 60 99 6c  |.UkYM..x...L.`.l|
-00000210  f6 91 33 2e 17 d5 e0 cc  3f 64 ac 9f 21 b0 a7 e4  |..3.....?d..!...|
-00000220  80 77 44 67 8d fc 47 fe  18 38 36 11 ec f8 2d 50  |.wDg..G..86...-P|
-00000230  65 bd 75 c1 30 a2 74 5b  dd 88 be 3a 4b 00 ec 33  |e.u.0.t[...:K..3|
-00000240  08 e5 66 ed 72 2d f2 af  63 52 14 c6 01 ad e4 95  |..f.r-..cR......|
-00000250  a0 00 f8 a3 17 03 03 00  35 75 fd a6 02 da 42 c0  |........5u....B.|
-00000260  4f b4 88 d7 4b fb 5c 91  db 10 6a 4e ea c6 8e f1  |O...K.\...jN....|
-00000270  a7 e1 01 1b 10 fa 1e a7  63 f2 5c e8 c0 fa 45 1d  |........c.\...E.|
-00000280  39 6c 2a 10 38 2b bc 56  e3 a1 c4 25 44 ad 17 03  |9l*.8+.V...%D...|
-00000290  03 00 83 21 cb b0 16 f1  86 1a 5b 31 8d f8 17 ec  |...!......[1....|
-000002a0  08 ce 00 ed b4 ec 95 27  79 c0 2a 0a 52 d6 7e 74  |.......'y.*.R.~t|
-000002b0  68 74 87 f9 7e b5 c5 10  96 62 b3 0d 7c 0b 83 b7  |ht..~....b..|...|
-000002c0  ac d8 bc 28 68 64 e5 01  e7 89 92 15 25 dc 0d 4a  |...(hd......%..J|
-000002d0  ee 0c 80 ba 17 dd cd e6  63 c6 b4 e7 6f 86 91 71  |........c...o..q|
-000002e0  82 85 ba d0 86 ca 86 6f  ad 62 26 b9 29 b0 0c 98  |.......o.b&.)...|
-000002f0  a5 3a 51 2a 8c 2a 9d c0  25 6f d9 12 36 2d a3 ba  |.:Q*.*..%o..6-..|
-00000300  e4 42 5f 82 66 3a 21 a0  4b 4b d4 31 2a 12 c7 af  |.B_.f:!.KK.1*...|
-00000310  c6 e2 35 0e 1b 73                                 |..5..s|
+00000080  03 03 00 01 01 17 03 03  00 17 87 bc 5e cb 90 2a  |............^..*|
+00000090  25 81 b5 1d 04 28 25 7c  c1 6d 7b 94 08 88 35 b2  |%....(%|.m{...5.|
+000000a0  49 17 03 03 01 50 3d 15  6c 0d 37 eb 84 bf c4 1a  |I....P=.l.7.....|
+000000b0  26 7a c1 21 33 5f 1c b8  fd d9 68 61 8b 83 68 d3  |&z.!3_....ha..h.|
+000000c0  5e 02 30 ca dd d5 6e 11  73 e2 81 3e bd 20 5a b8  |^.0...n.s..>. Z.|
+000000d0  93 aa 1b 53 8b c3 c2 8d  7b a6 c6 10 5a eb ec ef  |...S....{...Z...|
+000000e0  a4 55 e5 69 ce 5c 4e 68  9b 43 30 a7 5f f7 81 90  |.U.i.\Nh.C0._...|
+000000f0  5b ef e4 8b c1 e0 91 92  50 df 4a 1b cc 26 89 b1  |[.......P.J..&..|
+00000100  f5 8b 9b a2 9d 7c fb fd  84 1c 86 ac 42 4c 18 d9  |.....|......BL..|
+00000110  04 17 df 05 c4 94 d1 48  19 da 15 27 93 de de 82  |.......H...'....|
+00000120  f1 77 bd ba 10 16 bb 29  a7 9e 10 bb e1 53 db 12  |.w.....).....S..|
+00000130  89 aa 1a 4d 5f d9 d8 51  b7 8b c0 79 4e 2e 6a 6e  |...M_..Q...yN.jn|
+00000140  cc 5b 8c 0f 83 e9 38 b8  93 08 b4 3a 05 31 ad 3f  |.[....8....:.1.?|
+00000150  bf bd 04 e1 f3 08 01 b3  fc 96 81 21 af 8f 01 7a  |...........!...z|
+00000160  33 44 00 27 e8 49 ca 0a  ae 6b ed a1 36 d5 8e c0  |3D.'.I...k..6...|
+00000170  5d 26 21 d3 89 82 32 de  65 53 37 c9 d1 ae 90 7e  |]&!...2.eS7....~|
+00000180  e6 4e 90 01 81 9e 4c da  58 46 d4 f6 9d b9 99 2d  |.N....L.XF.....-|
+00000190  7a 60 ab 9b 26 97 17 0d  5e ba 38 b7 5e b5 bd 11  |z`..&...^.8.^...|
+000001a0  86 80 47 b4 ac 23 3a 4b  57 76 c4 48 a5 b9 5f 23  |..G..#:KWv.H.._#|
+000001b0  15 15 73 77 63 64 d0 fe  45 b8 29 c7 9f ff 1a 69  |..swcd..E.)....i|
+000001c0  b0 83 b5 10 ae 87 47 a5  92 ef 7d 00 86 43 1e d8  |......G...}..C..|
+000001d0  c3 98 73 25 1b 4d f4 72  c5 be 1c 66 10 1b 84 e7  |..s%.M.r...f....|
+000001e0  54 ed 30 ac c3 51 d9 c5  07 99 b4 80 44 1d e9 1b  |T.0..Q......D...|
+000001f0  2e d5 f3 09 94 e9 17 03  03 00 59 49 9f 66 ab 22  |..........YI.f."|
+00000200  6a fe cc 38 42 00 cf c8  04 f4 b6 8d 96 f9 c9 de  |j..8B...........|
+00000210  47 44 cd 75 ec a1 1e 58  0d 76 a1 c1 16 75 36 9a  |GD.u...X.v...u6.|
+00000220  fd 69 f5 66 48 e6 2d 8e  e9 bd 36 c7 d9 46 33 e6  |.i.fH.-...6..F3.|
+00000230  96 38 b8 b7 78 64 ae 1f  b6 3c bc 9c ab a1 28 b0  |.8..xd...<....(.|
+00000240  5c 57 26 d8 2e a3 7d 29  e5 dd 18 dc 4d 2c 81 6a  |\W&...})....M,.j|
+00000250  68 c4 77 56 17 03 03 00  35 42 cc d7 3d 61 72 09  |h.wV....5B..=ar.|
+00000260  ff 7b 62 ab c6 b5 e7 be  0c 0d 0d 81 62 6c 8f 48  |.{b.........bl.H|
+00000270  3b 43 c7 20 ab de a8 0a  2e 97 a7 25 82 5f 81 6f  |;C. .......%._.o|
+00000280  8d c0 a3 a1 5e 26 90 fa  b3 76 d9 7f 48 b4 17 03  |....^&...v..H...|
+00000290  03 00 83 3d a7 3f 0d 0f  18 c8 94 f0 ee 5a 11 bd  |...=.?.......Z..|
+000002a0  00 ed 90 19 42 61 36 74  1d fb b6 fd 39 1d d1 8a  |....Ba6t....9...|
+000002b0  41 b1 22 e5 b9 10 14 fa  46 82 12 86 ac 24 d3 26  |A.".....F....$.&|
+000002c0  9e bb 5c 25 3a 9e 6f e8  3f bc 15 e7 e7 35 d8 95  |..\%:.o.?....5..|
+000002d0  be a6 e1 45 0b ad 4d 9c  9f 55 07 2e d9 a0 5c 43  |...E..M..U....\C|
+000002e0  4a a3 4f 1f f0 ab d7 0b  3b 7e e3 bb e5 1a e4 f4  |J.O.....;~......|
+000002f0  ae e3 53 96 a5 46 55 90  2d 72 e1 ce 22 9c b1 c7  |..S..FU.-r.."...|
+00000300  5e ed 27 13 c8 c4 4a 12  15 41 de 22 1c c7 19 92  |^.'...J..A."....|
+00000310  9f e3 4f 74 b8 9a                                 |..Ot..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 09 e3 19 28 82  |..........5...(.|
-00000010  50 d3 a7 97 48 e5 41 8b  67 cc 60 d4 e9 eb ab d3  |P...H.A.g.`.....|
-00000020  d0 3d 51 f3 c8 4f 7b 40  98 f3 93 ab 3b ca 77 4e  |.=Q..O{@....;.wN|
-00000030  2f 51 a6 dd 5e 96 43 59  a4 18 43 b9 ee 80 3c 77  |/Q..^.CY..C...<w|
+00000000  14 03 03 00 01 01 17 03  03 00 35 c8 8e 40 a7 b1  |..........5..@..|
+00000010  8a e2 7d f3 39 eb 7c f0  d6 89 43 aa cd ab a4 6c  |..}.9.|...C....l|
+00000020  cf ea cf 79 80 98 b3 fd  cc d0 20 82 31 07 fa 09  |...y...... .1...|
+00000030  4a af 02 e4 db 57 52 da  f6 d5 46 85 85 07 07 f0  |J....WR...F.....|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 26 91 a6  f0 53 5b a6 8e 25 81 db  |.....&...S[..%..|
-00000010  dd 93 3f 9f 61 b1 b7 d2  be 48 7c 7e 99 23 78 c8  |..?.a....H|~.#x.|
-00000020  f2 0c 3c 17 03 03 00 13  3b 0b 8e c6 1d 85 28 f0  |..<.....;.....(.|
-00000030  23 bb 7b 0b 0a 11 ad 42  4e 9f 0a                 |#.{....BN..|
+00000000  17 03 03 00 1e 47 41 27  bc 81 d8 c1 13 22 fd 32  |.....GA'.....".2|
+00000010  e2 2b 4e 87 e5 db 62 76  14 26 a2 15 f3 0a 88 11  |.+N...bv.&......|
+00000020  5e a4 4c 17 03 03 00 13  aa 4c a0 ba 65 78 7f d1  |^.L......L..ex..|
+00000030  28 c8 4a 04 3d cd 3a f6  d1 e3 90                 |(.J.=.:....|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ExportKeyingMaterial b/src/crypto/tls/testdata/Server-TLSv13-ExportKeyingMaterial
index c85f62db21..3ee40ae155 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ExportKeyingMaterial
+++ b/src/crypto/tls/testdata/Server-TLSv13-ExportKeyingMaterial
@@ -1,98 +1,98 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ce 01 00 00  ca 03 03 a7 10 27 b6 49  |.............'.I|
-00000010  04 9a 96 8a b3 02 f5 f3  b9 e2 04 f1 32 07 57 06  |............2.W.|
-00000020  3b 5e c0 f1 81 ef d6 1b  34 38 41 20 7c 3c 3a 55  |;^......48A |<:U|
-00000030  f6 03 a5 5a 46 6f 65 99  29 77 f6 d3 5c 36 7b 51  |...ZFoe.)w..\6{Q|
-00000040  37 d2 42 a5 e2 f5 0f 13  36 84 52 12 00 04 13 03  |7.B.....6.R.....|
+00000000  16 03 01 00 ce 01 00 00  ca 03 03 ea 43 7d a5 59  |............C}.Y|
+00000010  8b 97 1c f7 31 20 c7 1c  44 86 69 44 f2 97 49 3c  |....1 ..D.iD..I<|
+00000020  ae 1f 64 b6 76 e0 54 99  9b dd 61 20 c0 85 8a c8  |..d.v.T...a ....|
+00000030  63 bf 7d fb 04 84 ee a1  72 f4 95 b8 e8 db e8 19  |c.}.....r.......|
+00000040  ea 1f 19 92 89 38 41 1e  7e 8f 78 e9 00 04 13 03  |.....8A.~.x.....|
 00000050  00 ff 01 00 00 7d 00 0b  00 04 03 00 01 02 00 0a  |.....}..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 16 00 00 00 17  00 00 00 0d 00 1e 00 1c  |................|
 00000080  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000090  08 04 08 05 08 06 04 01  05 01 06 01 00 2b 00 03  |.............+..|
 000000a0  02 03 04 00 2d 00 02 01  01 00 33 00 26 00 24 00  |....-.....3.&.$.|
-000000b0  1d 00 20 92 2d 8e e2 e4  8a 0c 1a 27 d5 40 04 2a  |.. .-......'.@.*|
-000000c0  64 7b 77 3c a5 f6 2d 27  e5 28 05 a6 b8 4d bf 99  |d{w<..-'.(...M..|
-000000d0  a0 17 6a                                          |..j|
+000000b0  1d 00 20 cf 78 b6 04 04  55 30 bc 47 c4 7e b9 b8  |.. .x...U0.G.~..|
+000000c0  72 78 7e a6 fd 52 b5 c6  56 21 0d 5a 40 54 9c 48  |rx~..R..V!.Z@T.H|
+000000d0  ef 90 07                                          |...|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 7c 3c 3a 55  |........... |<:U|
-00000030  f6 03 a5 5a 46 6f 65 99  29 77 f6 d3 5c 36 7b 51  |...ZFoe.)w..\6{Q|
-00000040  37 d2 42 a5 e2 f5 0f 13  36 84 52 12 13 03 00 00  |7.B.....6.R.....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 c0 85 8a c8  |........... ....|
+00000030  63 bf 7d fb 04 84 ee a1  72 f4 95 b8 e8 db e8 19  |c.}.....r.......|
+00000040  ea 1f 19 92 89 38 41 1e  7e 8f 78 e9 13 03 00 00  |.....8A.~.x.....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 fd 2a 88 8c e8 f7  |...........*....|
-00000090  59 74 7b 10 ea 48 c8 42  c0 50 ed 5f 78 fe bf 31  |Yt{..H.B.P._x..1|
-000000a0  28 17 03 03 02 6d 59 00  c3 1a f8 e1 b6 22 ae a2  |(....mY......"..|
-000000b0  7f 83 ba b1 da b7 80 08  cf 71 91 a9 42 10 bb e8  |.........q..B...|
-000000c0  5c 15 59 61 6b 68 47 06  85 3a 1a 32 a4 34 e9 55  |\.YakhG..:.2.4.U|
-000000d0  a7 4e 5e 24 44 b4 5b 08  ef 3d a3 e5 5e 78 ca bd  |.N^$D.[..=..^x..|
-000000e0  e0 6c ac 94 b1 3e ee 4f  31 53 23 83 a4 c4 3f 37  |.l...>.O1S#...?7|
-000000f0  b7 2f 9c 6b f5 4a 15 e1  ca 28 c6 30 46 e5 ff d1  |./.k.J...(.0F...|
-00000100  2e 92 7b 5c 4f 3c 5b 85  0d be 38 a7 52 e4 6f e0  |..{\O<[...8.R.o.|
-00000110  80 09 e7 10 13 5d 78 11  e3 d2 c0 d0 37 32 8c 25  |.....]x.....72.%|
-00000120  6d 11 c3 57 ad 84 14 26  7d 10 a1 54 f3 f9 52 60  |m..W...&}..T..R`|
-00000130  21 f2 0c 83 6a 78 e9 ac  e1 0e 32 13 0b 73 fa 8f  |!...jx....2..s..|
-00000140  19 52 9c e6 0b bb aa 53  5c 5e ee ae 99 fc a9 8c  |.R.....S\^......|
-00000150  41 cf a4 bf 7a 98 34 8c  75 42 77 11 28 fa 5b 55  |A...z.4.uBw.(.[U|
-00000160  74 b6 f8 ec d9 a7 63 d3  fa 15 de ba 62 ad 35 8b  |t.....c.....b.5.|
-00000170  d8 d5 93 a2 77 18 f0 0a  a8 e3 00 f3 b6 0b 53 75  |....w.........Su|
-00000180  2a 6e 5d 61 93 b8 13 ed  23 6e f4 d9 5d dd d1 32  |*n]a....#n..]..2|
-00000190  87 de c3 6f 60 6f e8 50  66 0f 21 d5 88 4f d7 d1  |...o`o.Pf.!..O..|
-000001a0  30 20 48 e2 c2 29 e5 83  17 e5 c9 6c c9 0c 69 d6  |0 H..).....l..i.|
-000001b0  bb 0f bb a2 01 f6 ee 7d  b6 ba 8b 68 38 15 73 08  |.......}...h8.s.|
-000001c0  32 39 7d 5a 6a 3d 80 54  ce 64 81 46 36 a5 ed d7  |29}Zj=.T.d.F6...|
-000001d0  f9 e5 a4 88 c2 03 f5 2b  be 35 e5 06 8a 12 50 7d  |.......+.5....P}|
-000001e0  f3 cb d8 e1 48 bb c5 78  56 21 b5 33 2b cf 8e 4a  |....H..xV!.3+..J|
-000001f0  fe c1 af 6d d3 9d 75 2f  a3 c5 62 fb 36 d5 67 09  |...m..u/..b.6.g.|
-00000200  29 61 0c 5c 97 98 f4 77  9f ef 50 ed a8 80 12 15  |)a.\...w..P.....|
-00000210  5b ac a1 c7 2c 2f 6c 76  c0 18 d3 4b 04 61 fc 4b  |[...,/lv...K.a.K|
-00000220  ff 0d a7 c0 3a 0b f0 9f  d3 8e 53 fb 60 e0 27 55  |....:.....S.`.'U|
-00000230  9d 1f 28 40 81 cd c1 38  67 a4 11 a4 13 72 83 a1  |..(@...8g....r..|
-00000240  ed c8 b9 77 77 bd d8 84  b3 43 9f 9d 85 0c c2 8c  |...ww....C......|
-00000250  89 fc e4 1a 05 aa 27 0d  c6 ce a2 0c b4 d9 23 ba  |......'.......#.|
-00000260  24 21 19 fa c2 c5 d4 a9  4d 26 ea 21 2b 4d 4b 8d  |$!......M&.!+MK.|
-00000270  f4 43 83 91 5e 1c 7b 27  c3 e0 c6 1e 01 43 8f cd  |.C..^.{'.....C..|
-00000280  a8 f7 65 fb 1a c8 7b 27  d3 bf cf 17 76 a9 3b 7d  |..e...{'....v.;}|
-00000290  37 fc e0 4b 8d 90 f7 ac  dc f0 2c 5c 5b 03 b3 9b  |7..K......,\[...|
-000002a0  ec 27 00 c1 9a 73 85 60  5f 6b 85 16 13 b6 5c 0e  |.'...s.`_k....\.|
-000002b0  ca f5 5b 77 96 55 7a e4  a2 72 0a 38 d2 8b 20 a2  |..[w.Uz..r.8.. .|
-000002c0  33 cb 0d 7a ab ef 5b 4b  f7 b8 31 12 07 63 a5 fe  |3..z..[K..1..c..|
-000002d0  32 8b 7a 6e 41 08 a3 76  37 95 21 c4 36 75 f3 60  |2.znA..v7.!.6u.`|
-000002e0  7e b9 54 5c 1b fb b7 14  5c ba 44 a0 c7 b4 db 0b  |~.T\....\.D.....|
-000002f0  38 8e 44 29 c1 fe f3 4c  1c 62 e5 ba 78 93 9c a1  |8.D)...L.b..x...|
-00000300  9f fa 69 2d 62 53 f7 49  76 2e 2b c8 bf 83 b6 ec  |..i-bS.Iv.+.....|
-00000310  42 7e 95 17 03 03 00 99  48 21 3d 9a 74 61 1f 21  |B~......H!=.ta.!|
-00000320  ef cd 27 5a df 70 2e 64  95 42 9e 5c bc ae ab c5  |..'Z.p.d.B.\....|
-00000330  6b 76 cd b9 ac cb c1 b2  f1 17 fc 66 09 65 02 7b  |kv.........f.e.{|
-00000340  52 6e 4c 0d a7 26 ab b5  d6 62 eb 3f db 63 3f 90  |RnL..&...b.?.c?.|
-00000350  29 be 91 91 47 56 86 71  f8 b4 45 00 f0 f2 2b 7e  |)...GV.q..E...+~|
-00000360  0b 65 37 91 ee d1 ab e2  d7 3f 6a 42 08 e7 c0 79  |.e7......?jB...y|
-00000370  8f 55 3e 4f dc b9 e6 ff  46 ad 8a 5b 89 91 91 fb  |.U>O....F..[....|
-00000380  44 ac 3c 22 ac 18 d9 03  68 26 ab 71 4c 46 88 0c  |D.<"....h&.qLF..|
-00000390  e0 50 0b c1 d0 1a 38 73  3b e5 12 95 a4 5a 47 3c  |.P....8s;....ZG<|
-000003a0  f2 8c 98 b5 38 39 b1 e9  37 ed da 37 d1 ba 1d e9  |....89..7..7....|
-000003b0  d9 17 03 03 00 35 2a b3  e7 51 57 c7 37 15 79 09  |.....5*..QW.7.y.|
-000003c0  bd 95 2a 87 be ee 55 0d  fa db c6 92 f3 98 af 8f  |..*...U.........|
-000003d0  3c 84 00 fb ae 7d 2f ad  e3 e9 41 c0 ba 2e 7a 0b  |<....}/...A...z.|
-000003e0  73 a4 87 d4 c9 07 83 eb  15 57 cc 17 03 03 00 83  |s........W......|
-000003f0  97 ec bd 03 76 91 79 b6  9f fb fa 7f 48 9c f3 10  |....v.y.....H...|
-00000400  e6 28 8a cf f5 2e 52 b8  1b 6c f6 ab 32 62 a2 92  |.(....R..l..2b..|
-00000410  c5 22 69 ee 4e 8a 41 fb  1e 3f bf 7b 0a 11 1f 72  |."i.N.A..?.{...r|
-00000420  0f 2d d7 a9 43 71 b8 4b  4f 3a 83 e8 32 b1 ce 5e  |.-..Cq.KO:..2..^|
-00000430  ca a3 fe df 36 83 57 55  13 69 eb 8a 93 73 11 45  |....6.WU.i...s.E|
-00000440  e8 03 1c 1a c7 39 cf 42  ac d6 37 44 cb b4 c0 5c  |.....9.B..7D...\|
-00000450  bd da 23 37 92 95 54 25  c8 8f 5e 4f cf 6f f3 e5  |..#7..T%..^O.o..|
-00000460  0e e8 b7 8e d9 14 47 0d  29 1b 85 94 82 89 81 6c  |......G.)......l|
-00000470  f8 41 1f                                          |.A.|
+00000080  03 03 00 01 01 17 03 03  00 17 a1 e9 86 ad 4d 78  |..............Mx|
+00000090  60 17 e7 7e 6e 4c 66 4b  ab 2a 71 67 68 c3 8f 0f  |`..~nLfK.*qgh...|
+000000a0  c8 17 03 03 02 6d 4b e2  d9 4b 70 53 05 c7 1e 89  |.....mK..KpS....|
+000000b0  f0 63 1c e1 64 a5 06 7d  4e 54 6f 3d 70 79 1a 26  |.c..d..}NTo=py.&|
+000000c0  d7 7b a1 95 cc 88 12 5f  e9 99 b0 ac 21 3f 77 13  |.{....._....!?w.|
+000000d0  34 88 2a 5e fc e5 d0 be  47 b7 32 4c 1f 7c 8e a1  |4.*^....G.2L.|..|
+000000e0  4d 7f 10 82 9f e7 d2 27  56 10 e1 8b b7 01 5b 8b  |M......'V.....[.|
+000000f0  2e e3 e2 98 fb 54 d2 4b  57 74 d7 5a 35 f4 61 9c  |.....T.KWt.Z5.a.|
+00000100  d2 41 b9 1e 35 6b 39 ae  47 39 2a 5f 0e 68 6d 38  |.A..5k9.G9*_.hm8|
+00000110  b2 13 7a 50 0c 08 2e f1  e0 73 be 93 51 fd d2 da  |..zP.....s..Q...|
+00000120  e4 fe f9 83 09 f2 a9 33  34 f4 34 7c 64 34 ab 71  |.......34.4|d4.q|
+00000130  eb 96 f8 e3 8f 46 52 22  c5 78 56 0d 84 12 e2 ee  |.....FR".xV.....|
+00000140  73 ad 91 68 01 5d dd f7  4a 3b fa 66 df e6 18 fb  |s..h.]..J;.f....|
+00000150  03 4d 00 38 84 13 aa 08  13 8a 41 c3 bd f7 93 79  |.M.8......A....y|
+00000160  18 3e 03 40 20 93 c1 fc  a4 1f b9 ee ef 18 5f 3f  |.>.@ ........._?|
+00000170  b6 b8 8c f1 98 f7 6d 55  df 9a 68 42 d4 a7 75 20  |......mU..hB..u |
+00000180  4e 57 bc 5a df 4a b7 97  60 c2 8e e0 8b 49 c2 04  |NW.Z.J..`....I..|
+00000190  2b a2 9b 26 24 51 1a db  ba 3b 89 5b cd 65 fb d2  |+..&$Q...;.[.e..|
+000001a0  ae 2a c9 19 71 08 9d e8  d5 25 d7 1d 47 79 cf 1f  |.*..q....%..Gy..|
+000001b0  08 c3 03 b5 d9 78 6d be  56 73 12 45 b3 9c ad 1d  |.....xm.Vs.E....|
+000001c0  7e 85 8e 01 b8 c3 b9 e5  45 c9 e5 f6 1f c2 cf 86  |~.......E.......|
+000001d0  11 63 62 b2 d9 5c 44 3f  b9 f8 dd 22 17 7e 5b d3  |.cb..\D?...".~[.|
+000001e0  dc 75 19 27 81 0f 75 8e  0c f7 66 91 11 fc 63 51  |.u.'..u...f...cQ|
+000001f0  d6 7c 7f 9e d1 50 be 11  49 1f b7 c7 14 a9 76 8a  |.|...P..I.....v.|
+00000200  76 22 0c 54 e9 33 ff ba  8a fc f5 ba 42 68 f3 8a  |v".T.3......Bh..|
+00000210  1e c8 39 56 c2 de 57 33  1d a8 79 5a 9d 66 c0 59  |..9V..W3..yZ.f.Y|
+00000220  fb ba bf f5 8d 88 4a b6  48 85 80 ac 8b f3 c0 5d  |......J.H......]|
+00000230  5e b8 6c ab eb c2 a1 95  fa 4a 78 8b 14 4a 5e fa  |^.l......Jx..J^.|
+00000240  9a 5e d2 cc 38 26 1c 17  80 3a 81 48 9f c9 6c 9d  |.^..8&...:.H..l.|
+00000250  42 15 fd 63 93 27 53 05  6e 1a 79 47 b8 b5 34 f0  |B..c.'S.n.yG..4.|
+00000260  19 13 e5 0b ac c1 a1 78  10 93 3a 35 92 a3 a5 df  |.......x..:5....|
+00000270  75 23 a6 c3 05 5d 6b 75  86 24 76 91 1d ff f6 89  |u#...]ku.$v.....|
+00000280  5f 65 a3 08 1a d4 56 c1  8e 93 97 ad 25 cb fc fe  |_e....V.....%...|
+00000290  7f 2d 78 55 58 f3 a7 f6  f5 b3 a3 d0 af 9e 05 c5  |.-xUX...........|
+000002a0  f0 a8 4d 23 1d d7 0c 9a  10 dd 22 3d cd d3 7d 00  |..M#......"=..}.|
+000002b0  6d 54 6e 13 a6 1d 9b 87  c6 69 5b 2d 80 2e 02 5d  |mTn......i[-...]|
+000002c0  f5 58 ea 30 f9 22 8b d3  8d 21 a8 1c 3b 34 40 fa  |.X.0."...!..;4@.|
+000002d0  ad b4 f6 28 1b 7d 32 c9  89 3a 76 49 6a 7e 7b bb  |...(.}2..:vIj~{.|
+000002e0  b2 d6 c8 75 33 10 4e 3f  03 e8 bb aa 6f d1 73 88  |...u3.N?....o.s.|
+000002f0  76 4e 53 0c bf 91 d0 f1  c7 58 16 2e ed c5 f3 75  |vNS......X.....u|
+00000300  78 f0 07 fa 0a a6 33 71  87 6b 9c cd 3d 99 90 b5  |x.....3q.k..=...|
+00000310  0b 79 61 17 03 03 00 99  86 20 b4 3b fc f3 68 10  |.ya...... .;..h.|
+00000320  52 a6 ed 5a 27 08 e8 74  cd d9 60 fe 30 24 89 55  |R..Z'..t..`.0$.U|
+00000330  15 cd 55 c1 cd 08 e9 0b  e9 10 21 ed 18 00 d0 19  |..U.......!.....|
+00000340  43 e3 e3 27 01 61 db b2  9b da 72 03 42 c9 c4 0b  |C..'.a....r.B...|
+00000350  96 b4 12 41 35 04 62 52  61 50 74 19 47 d1 db f6  |...A5.bRaPt.G...|
+00000360  5c a8 b5 b5 3c af 29 ca  8a 30 b6 21 e3 6c 2c 6f  |\...<.)..0.!.l,o|
+00000370  71 37 28 c8 9f 3e 4e a2  2d 4a 29 5a 1c b4 11 fb  |q7(..>N.-J)Z....|
+00000380  c9 a2 c8 3e ff d8 19 7a  6d b8 f9 c1 5b ef 56 4b  |...>...zm...[.VK|
+00000390  72 65 dc fd 92 5b 46 01  25 81 03 9e e3 84 d8 3f  |re...[F.%......?|
+000003a0  68 59 46 9c f9 16 ec 5d  0c 6d f2 a5 54 90 84 29  |hYF....].m..T..)|
+000003b0  e4 17 03 03 00 35 3d 7f  a8 09 c0 12 ba c8 c3 82  |.....5=.........|
+000003c0  ac c4 2d 45 92 07 c3 6a  4d 92 ec d7 19 57 7e 1c  |..-E...jM....W~.|
+000003d0  ff 2c 3f b6 e3 8d 54 4a  e8 d1 eb fd 8a 92 6c dd  |.,?...TJ......l.|
+000003e0  5e 80 69 1c 83 b3 2a d1  9a 28 e9 17 03 03 00 83  |^.i...*..(......|
+000003f0  8a 0b 2b f7 1b 3b 11 ba  a7 73 38 77 a8 12 e5 66  |..+..;...s8w...f|
+00000400  8a a6 7a 36 90 8e b6 ee  07 e1 e8 30 a6 36 51 d7  |..z6.......0.6Q.|
+00000410  00 5c b7 00 b0 fb f4 dd  5d a7 0f 8e a0 6b 77 91  |.\......]....kw.|
+00000420  31 cb 48 93 1b dc 9a 36  6e 80 51 03 ca ef 8d 48  |1.H....6n.Q....H|
+00000430  32 bd 7a 4c ab a1 46 94  3a 16 4e be 6b 98 e1 2f  |2.zL..F.:.N.k../|
+00000440  5c 39 cc 6a cc b6 e2 75  be 59 7f 36 fc 36 74 b6  |\9.j...u.Y.6.6t.|
+00000450  f1 ae 37 be 8f 59 74 ea  76 68 c5 12 ad f3 f3 78  |..7..Yt.vh.....x|
+00000460  ce de f7 f5 60 7c 6c dc  95 c2 d6 a3 81 e2 15 d1  |....`|l.........|
+00000470  1d 08 15                                          |...|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 f9 6a 29 1b a1  |..........5.j)..|
-00000010  91 68 7a 29 e5 2b 80 32  df 22 27 47 25 32 cc 66  |.hz).+.2."'G%2.f|
-00000020  19 14 92 24 99 be b0 00  bf dc 0c 0a a2 e1 04 ac  |...$............|
-00000030  b8 c2 b9 37 3e 22 07 7d  d3 f5 a7 fc 16 3f 80 db  |...7>".}.....?..|
+00000000  14 03 03 00 01 01 17 03  03 00 35 1e c3 32 af 43  |..........5..2.C|
+00000010  c2 7b 2c 42 7b d3 f5 cf  44 ed 0f 20 39 e2 28 94  |.{,B{...D.. 9.(.|
+00000020  f1 28 7c e0 34 90 4d 11  3a 13 e3 60 fe 9e ec d5  |.(|.4.M.:..`....|
+00000030  32 03 a9 60 58 29 ee d5  2f 0d ed fc 3f 7a 53 d1  |2..`X)../...?zS.|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e cd 59 4f  27 60 f7 93 c7 d2 7c 5b  |......YO'`....|[|
-00000010  f3 70 0a 6d 1d 0f 4c 41  1f b9 76 f4 07 93 b0 d8  |.p.m..LA..v.....|
-00000020  a2 59 bf 17 03 03 00 13  c6 cd a8 7b de 92 68 eb  |.Y.........{..h.|
-00000030  66 c6 14 87 2b b6 ee 84  eb ec 28                 |f...+.....(|
+00000000  17 03 03 00 1e 3a a2 23  ae f3 28 63 3b 71 c2 85  |.....:.#..(c;q..|
+00000010  18 e0 16 23 b8 18 54 ff  05 f8 81 d4 71 8f 92 2e  |...#..T.....q...|
+00000020  8d 33 64 17 03 03 00 13  32 cc 09 c2 a6 5c 13 f7  |.3d.....2....\..|
+00000030  79 d2 1c 5c 33 b9 d7 3a  cc 3e d1                 |y..\3..:.>.|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-HelloRetryRequest b/src/crypto/tls/testdata/Server-TLSv13-HelloRetryRequest
index bb60cdeef9..748d1acf12 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-HelloRetryRequest
+++ b/src/crypto/tls/testdata/Server-TLSv13-HelloRetryRequest
@@ -1,122 +1,122 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 c4 01 00 00  c0 03 03 aa 3e c9 0b 99  |............>...|
-00000010  f0 27 92 d6 73 d5 6a a9  19 b2 71 4f f5 3a 02 19  |.'..s.j...qO.:..|
-00000020  e5 a2 3e f9 7b f0 bd c8  d9 0f 0a 20 c9 1e b8 0e  |..>.{...... ....|
-00000030  53 68 a6 ac 7d 3a 74 c9  1b 4f 65 52 a0 23 da d5  |Sh..}:t..OeR.#..|
-00000040  ca 87 09 43 39 79 ba c0  47 a9 44 b5 00 04 13 03  |...C9y..G.D.....|
+00000000  16 03 01 00 c4 01 00 00  c0 03 03 5b 05 89 9b cf  |...........[....|
+00000010  54 f8 75 8d 11 c5 d6 04  16 62 34 91 ec cf c2 ce  |T.u......b4.....|
+00000020  d5 76 8b 08 92 5e 98 d9  84 7f d4 20 b6 c5 eb ac  |.v...^..... ....|
+00000030  d5 0d 0a dc e8 5a 00 83  22 6e cc e4 fd 87 bd ea  |.....Z.."n......|
+00000040  c3 cb 19 0d 33 f0 99 b0  0a 58 91 bb 00 04 13 03  |....3....X......|
 00000050  00 ff 01 00 00 73 00 0b  00 04 03 00 01 02 00 0a  |.....s..........|
 00000060  00 06 00 04 00 1d 00 17  00 16 00 00 00 17 00 00  |................|
 00000070  00 0d 00 1e 00 1c 04 03  05 03 06 03 08 07 08 08  |................|
 00000080  08 09 08 0a 08 0b 08 04  08 05 08 06 04 01 05 01  |................|
 00000090  06 01 00 2b 00 03 02 03  04 00 2d 00 02 01 01 00  |...+......-.....|
-000000a0  33 00 26 00 24 00 1d 00  20 40 48 36 e0 4d ce ac  |3.&.$... @H6.M..|
-000000b0  2c cc af f0 2e f1 e4 b8  a1 33 be fb bf ad 5d a7  |,........3....].|
-000000c0  4b 00 4a 4f c1 16 1e 9a  25                       |K.JO....%|
+000000a0  33 00 26 00 24 00 1d 00  20 4a 14 6c 1a e9 34 5a  |3.&.$... J.l..4Z|
+000000b0  7b e5 86 f5 0b 49 ad 15  6d f0 7c 6f 85 4d af fd  |{....I..m.|o.M..|
+000000c0  98 aa 14 6b f2 fd 93 f3  3e                       |...k....>|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 58 02 00 00  54 03 03 cf 21 ad 74 e5  |....X...T...!.t.|
 00000010  9a 61 11 be 1d 8c 02 1e  65 b8 91 c2 a2 11 16 7a  |.a......e......z|
-00000020  bb 8c 5e 07 9e 09 e2 c8  a8 33 9c 20 c9 1e b8 0e  |..^......3. ....|
-00000030  53 68 a6 ac 7d 3a 74 c9  1b 4f 65 52 a0 23 da d5  |Sh..}:t..OeR.#..|
-00000040  ca 87 09 43 39 79 ba c0  47 a9 44 b5 13 03 00 00  |...C9y..G.D.....|
+00000020  bb 8c 5e 07 9e 09 e2 c8  a8 33 9c 20 b6 c5 eb ac  |..^......3. ....|
+00000030  d5 0d 0a dc e8 5a 00 83  22 6e cc e4 fd 87 bd ea  |.....Z.."n......|
+00000040  c3 cb 19 0d 33 f0 99 b0  0a 58 91 bb 13 03 00 00  |....3....X......|
 00000050  0c 00 2b 00 02 03 04 00  33 00 02 00 17 14 03 03  |..+.....3.......|
 00000060  00 01 01                                          |...|
 >>> Flow 3 (client to server)
 00000000  14 03 03 00 01 01 16 03  03 00 e5 01 00 00 e1 03  |................|
-00000010  03 aa 3e c9 0b 99 f0 27  92 d6 73 d5 6a a9 19 b2  |..>....'..s.j...|
-00000020  71 4f f5 3a 02 19 e5 a2  3e f9 7b f0 bd c8 d9 0f  |qO.:....>.{.....|
-00000030  0a 20 c9 1e b8 0e 53 68  a6 ac 7d 3a 74 c9 1b 4f  |. ....Sh..}:t..O|
-00000040  65 52 a0 23 da d5 ca 87  09 43 39 79 ba c0 47 a9  |eR.#.....C9y..G.|
-00000050  44 b5 00 04 13 03 00 ff  01 00 00 94 00 0b 00 04  |D...............|
+00000010  03 5b 05 89 9b cf 54 f8  75 8d 11 c5 d6 04 16 62  |.[....T.u......b|
+00000020  34 91 ec cf c2 ce d5 76  8b 08 92 5e 98 d9 84 7f  |4......v...^....|
+00000030  d4 20 b6 c5 eb ac d5 0d  0a dc e8 5a 00 83 22 6e  |. .........Z.."n|
+00000040  cc e4 fd 87 bd ea c3 cb  19 0d 33 f0 99 b0 0a 58  |..........3....X|
+00000050  91 bb 00 04 13 03 00 ff  01 00 00 94 00 0b 00 04  |................|
 00000060  03 00 01 02 00 0a 00 06  00 04 00 1d 00 17 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
 000000a0  2d 00 02 01 01 00 33 00  47 00 45 00 17 00 41 04  |-.....3.G.E...A.|
-000000b0  4a 10 f7 42 ba 2e eb b4  70 30 ce 68 08 14 20 2b  |J..B....p0.h.. +|
-000000c0  2f d9 f9 26 27 d3 2d fe  f1 5e d9 cc c7 de 9a b6  |/..&'.-..^......|
-000000d0  53 dd a4 e6 a3 48 61 99  7e 8c 1e 2d 46 84 2b b1  |S....Ha.~..-F.+.|
-000000e0  57 d7 e7 4e 82 3f 3a 13  b2 39 04 f8 77 7f f6 36  |W..N.?:..9..w..6|
+000000b0  4d c4 a6 00 dd a7 3a 26  86 56 a0 9e 2a f4 78 98  |M.....:&.V..*.x.|
+000000c0  58 7b f6 5e 94 d9 56 9c  26 47 c5 55 09 12 93 aa  |X{.^..V.&G.U....|
+000000d0  af 64 dc ae 83 1c 12 f4  5b dc 60 fd a7 d0 bd b6  |.d......[.`.....|
+000000e0  0c 54 ac 4e e5 79 91 d0  55 1e 2a 75 34 e0 74 67  |.T.N.y..U.*u4.tg|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 9b 02 00 00  97 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 c9 1e b8 0e  |........... ....|
-00000030  53 68 a6 ac 7d 3a 74 c9  1b 4f 65 52 a0 23 da d5  |Sh..}:t..OeR.#..|
-00000040  ca 87 09 43 39 79 ba c0  47 a9 44 b5 13 03 00 00  |...C9y..G.D.....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 b6 c5 eb ac  |........... ....|
+00000030  d5 0d 0a dc e8 5a 00 83  22 6e cc e4 fd 87 bd ea  |.....Z.."n......|
+00000040  c3 cb 19 0d 33 f0 99 b0  0a 58 91 bb 13 03 00 00  |....3....X......|
 00000050  4f 00 2b 00 02 03 04 00  33 00 45 00 17 00 41 04  |O.+.....3.E...A.|
 00000060  1e 18 37 ef 0d 19 51 88  35 75 71 b5 e5 54 5b 12  |..7...Q.5uq..T[.|
 00000070  2e 8f 09 67 fd a7 24 20  3e b2 56 1c ce 97 28 5e  |...g..$ >.V...(^|
 00000080  f8 2b 2d 4f 9e f1 07 9f  6c 4b 5b 83 56 e2 32 42  |.+-O....lK[.V.2B|
 00000090  e9 58 b6 d7 49 a6 b5 68  1a 41 03 56 6b dc 5a 89  |.X..I..h.A.Vk.Z.|
-000000a0  17 03 03 00 17 cd 7b ee  ba 3a ca 14 3c c9 eb a2  |......{..:..<...|
-000000b0  f0 11 0a d9 4e f4 f4 da  64 8e 03 cc 17 03 03 02  |....N...d.......|
-000000c0  6d 74 3e b3 f2 1f 5a f6  a0 0b 4c 33 af 83 71 7c  |mt>...Z...L3..q||
-000000d0  b6 52 b8 a2 78 03 39 01  38 e1 a4 cc 82 06 29 de  |.R..x.9.8.....).|
-000000e0  c9 cb 3c a8 65 d2 42 29  2a cc 5b 04 70 49 b3 80  |..<.e.B)*.[.pI..|
-000000f0  73 bb c7 9f 5f aa 48 18  04 97 f8 ac d5 14 24 a5  |s..._.H.......$.|
-00000100  48 36 9f 4b cf 18 11 9b  1f 46 74 a0 04 2c 4f 78  |H6.K.....Ft..,Ox|
-00000110  17 ce 49 7d 3a d3 69 11  fc ed 51 c4 c1 57 99 ab  |..I}:.i...Q..W..|
-00000120  fc d7 af 87 96 34 0d 26  a3 83 00 4f 47 bd 80 d7  |.....4.&...OG...|
-00000130  67 bf 62 22 83 db 1f 81  c8 cc ca 6d 6b 4a 4e c6  |g.b".......mkJN.|
-00000140  f6 5a 06 20 b3 f0 23 4c  85 cc e6 bc 32 d6 39 a1  |.Z. ..#L....2.9.|
-00000150  58 32 f7 69 0e 42 ce cb  5c 30 80 6d 0f 71 a5 3d  |X2.i.B..\0.m.q.=|
-00000160  d0 53 b2 0b e7 84 03 84  9f e4 b8 37 c4 fc 57 c4  |.S.........7..W.|
-00000170  b2 a9 4e 16 7c dd 94 d8  4c 6d b3 2e 02 85 7b 50  |..N.|...Lm....{P|
-00000180  ab 51 f4 43 bc 9e d7 f4  39 0e b8 4f e7 d2 57 17  |.Q.C....9..O..W.|
-00000190  85 c3 07 5e 67 57 4a 59  ab 27 15 9d 6c 49 35 d4  |...^gWJY.'..lI5.|
-000001a0  5b ea 78 31 ab ad 72 3a  3a a3 9a a8 79 53 3a 4e  |[.x1..r::...yS:N|
-000001b0  d4 08 2d 80 df a8 20 71  96 a0 ea 15 34 c7 8f 70  |..-... q....4..p|
-000001c0  09 6a 4e 0c 43 3d be 59  85 b6 ae 61 ea 1b 06 f3  |.jN.C=.Y...a....|
-000001d0  52 d4 06 60 b1 60 38 dd  ab 20 04 cf 0e 8a a1 fa  |R..`.`8.. ......|
-000001e0  71 90 a4 d3 53 de 05 28  74 3f fb 1b eb 9b ad 64  |q...S..(t?.....d|
-000001f0  f4 50 9a f6 3d 32 5e 28  e0 88 a2 76 94 c6 d0 80  |.P..=2^(...v....|
-00000200  60 0a c4 1a ff 67 fb f7  f8 6d 64 d9 1b c9 77 80  |`....g...md...w.|
-00000210  12 f2 80 88 c1 20 2e b5  c4 50 a9 c6 0b 01 61 5f  |..... ...P....a_|
-00000220  bf be fa 1a c8 79 e8 8d  52 a2 b8 68 74 c8 b5 e3  |.....y..R..ht...|
-00000230  00 f5 33 49 c8 2c c6 0b  ef b0 e2 5e b2 b4 d6 f1  |..3I.,.....^....|
-00000240  70 25 cc ed a4 93 31 f8  f9 71 a5 10 87 36 bf 55  |p%....1..q...6.U|
-00000250  7c 4a 96 5f 99 51 0a f4  83 9e 38 7b e9 6f 1c bc  ||J._.Q....8{.o..|
-00000260  c2 14 71 64 d5 c8 9c 9c  38 14 67 ad d2 5e 52 3a  |..qd....8.g..^R:|
-00000270  c6 a2 de 37 46 ac cf e4  1e 84 18 9d e6 87 69 5c  |...7F.........i\|
-00000280  0e 4f 9a 45 55 a6 fd b5  88 02 cc 8a 0d 83 df a9  |.O.EU...........|
-00000290  8b ae 36 21 b0 11 e5 f5  b3 d8 ac 1a 34 65 96 4f  |..6!........4e.O|
-000002a0  2f 22 8f 5f fe 6c 90 61  b4 66 95 25 33 ea 8d a8  |/"._.l.a.f.%3...|
-000002b0  41 e9 b8 b6 5e 97 56 ac  97 a9 4f f6 93 0d a1 7d  |A...^.V...O....}|
-000002c0  40 5a 32 e0 89 f2 eb 1d  8f f5 02 25 16 4a 20 a9  |@Z2........%.J .|
-000002d0  38 00 69 86 3b 36 93 66  b5 d0 73 90 7b 94 69 c9  |8.i.;6.f..s.{.i.|
-000002e0  de aa 89 ab 3c 39 f9 54  35 9b 8c e7 ee ce 56 39  |....<9.T5.....V9|
-000002f0  4a 0d 7e 83 26 25 13 25  07 43 a1 62 0e c0 df 7e  |J.~.&%.%.C.b...~|
-00000300  00 36 57 12 a9 16 e6 61  5a fc 2a fc e8 8f 17 d6  |.6W....aZ.*.....|
-00000310  4e d9 77 95 0f aa 85 c8  c4 20 ef 70 d1 99 85 43  |N.w...... .p...C|
-00000320  f1 2f 1a 29 aa 83 e5 30  00 cc d6 40 b0 d7 17 03  |./.)...0...@....|
-00000330  03 00 99 8f 7b d3 1c 15  1d 87 a8 83 e6 e2 89 b4  |....{...........|
-00000340  ee 63 f2 d1 28 39 f1 c3  a6 e9 70 ee d8 82 6e 7c  |.c..(9....p...n||
-00000350  06 a0 5d 51 69 13 37 79  e9 5f 18 1f 65 a6 1e 98  |..]Qi.7y._..e...|
-00000360  dc 7a 03 69 a6 c7 d3 c3  0d c2 5c b7 e1 3f 78 3e  |.z.i......\..?x>|
-00000370  0a 27 1b 6c 12 d3 db 3a  7a 04 56 d6 57 5b c5 40  |.'.l...:z.V.W[.@|
-00000380  de 6a 74 0a 1d d6 64 34  53 b4 3d 57 cb 27 44 80  |.jt...d4S.=W.'D.|
-00000390  cf 7b a2 fa 62 c0 a8 42  f1 cc 22 38 96 46 66 fd  |.{..b..B.."8.Ff.|
-000003a0  46 22 33 23 1b e1 21 72  95 23 9b d9 9d df 94 e1  |F"3#..!r.#......|
-000003b0  e8 03 d7 8e 92 e5 b9 34  6e 34 fd 4d 41 28 78 a3  |.......4n4.MA(x.|
-000003c0  60 69 2f b2 c5 22 59 48  86 14 bf e6 17 03 03 00  |`i/.."YH........|
-000003d0  35 02 83 5e 5e 58 76 18  37 67 8a 69 a0 d6 00 87  |5..^^Xv.7g.i....|
-000003e0  ad 27 7a ab c8 ac 51 69  40 c4 91 cf e0 46 b5 af  |.'z...Qi@....F..|
-000003f0  4b 7e 0e e9 3d 41 c3 d2  48 3a 93 10 44 18 8c df  |K~..=A..H:..D...|
-00000400  77 7b 27 94 92 94 17 03  03 00 83 35 22 9e fd 06  |w{'........5"...|
-00000410  db 2a 54 ae a2 d4 fa 7e  6f 1c 9f f5 41 2d 4c 57  |.*T....~o...A-LW|
-00000420  e8 c3 a6 da 5d 10 cb b4  56 a8 61 9f 41 30 92 56  |....]...V.a.A0.V|
-00000430  3f 13 d0 f3 c6 a7 00 e7  12 96 62 e8 c6 b1 29 fe  |?.........b...).|
-00000440  86 f2 c4 15 84 d3 ce b0  18 34 5d ad 10 22 12 50  |.........4]..".P|
-00000450  f4 26 68 04 5b e5 a4 7b  16 02 ed ed cb 23 9c 6f  |.&h.[..{.....#.o|
-00000460  76 f4 97 d4 f8 9c 8a d5  92 67 f9 67 0c 4b d0 bc  |v........g.g.K..|
-00000470  03 8b 51 3b 66 2b 2f 0c  28 57 b9 d8 4e 48 1b f6  |..Q;f+/.(W..NH..|
-00000480  56 1a be be ef 9d 65 f9  cd 01 23 68 32 63        |V.....e...#h2c|
+000000a0  17 03 03 00 17 9b 52 89  a4 2c 9a 04 4e be e9 f0  |......R..,..N...|
+000000b0  98 f7 fd 90 0c ab 67 21  bf 53 53 28 17 03 03 02  |......g!.SS(....|
+000000c0  6d af d7 93 14 68 31 a0  97 e5 28 56 02 91 70 fe  |m....h1...(V..p.|
+000000d0  34 4a bf 70 6b 3c 3d 90  bb a5 25 6a 7c dc 04 83  |4J.pk<=...%j|...|
+000000e0  07 a3 07 21 3c 07 d3 7a  b2 e8 f0 42 a3 3e e9 60  |...!<..z...B.>.`|
+000000f0  e8 a1 8a 56 8a 5d eb 49  13 41 fa a2 f4 f9 5e f7  |...V.].I.A....^.|
+00000100  76 cb bc 53 d9 9e dd 80  84 14 af b8 3b 38 40 3b  |v..S........;8@;|
+00000110  0d b7 22 be e8 17 5b 1b  0d 83 da 77 73 40 3b ec  |.."...[....ws@;.|
+00000120  5e 4b ff 3b a9 8e b2 a7  a5 2d 0b 36 a6 7b 7b fa  |^K.;.....-.6.{{.|
+00000130  19 b3 0d 8d 95 f2 d9 b3  a9 e1 7c a7 c5 f3 1e 07  |..........|.....|
+00000140  8b 69 f8 6f 25 7e 58 fd  87 3f f4 c9 41 56 6a 57  |.i.o%~X..?..AVjW|
+00000150  65 c5 b7 6a b0 8a b4 d3  5a 35 0b 45 1f b5 2d 00  |e..j....Z5.E..-.|
+00000160  0c f6 12 24 81 bf e0 a9  a6 70 2c 8a 9f 36 c0 8f  |...$.....p,..6..|
+00000170  d1 ad f9 3e 22 fb a8 0d  27 9d 9d d5 1b 59 7b 02  |...>"...'....Y{.|
+00000180  f0 dd 47 cc cb cc 89 23  ef 84 dd 23 86 81 99 64  |..G....#...#...d|
+00000190  0c 61 87 f1 39 d4 ce 0f  1d 3e d7 57 23 50 0d f1  |.a..9....>.W#P..|
+000001a0  99 e7 b1 ac d2 73 e4 f0  3b 70 15 ac 13 39 79 40  |.....s..;p...9y@|
+000001b0  ac 8a 10 25 95 bc b9 bc  db 45 22 d1 98 32 d4 dc  |...%.....E"..2..|
+000001c0  b2 6a fe 7c 62 88 92 69  5d 2f f4 7c f2 06 7c 2e  |.j.|b..i]/.|..|.|
+000001d0  6c ac f6 13 04 b4 a2 73  31 b2 d8 5f 01 b5 a1 96  |l......s1.._....|
+000001e0  67 d1 d3 44 6a e1 e4 d8  cb 60 70 9a 8e ef d9 4c  |g..Dj....`p....L|
+000001f0  8d d0 17 20 e1 ea 1f 67  71 38 35 07 a7 fb 0c 67  |... ...gq85....g|
+00000200  60 69 ac 7e 44 73 09 c2  50 70 81 4e c6 07 44 e1  |`i.~Ds..Pp.N..D.|
+00000210  12 75 57 59 13 e0 dd c8  6b b8 cd 3a 1e aa d0 4c  |.uWY....k..:...L|
+00000220  92 7b 14 64 71 ae 16 27  87 ab 3a a4 6d ae 6c b5  |.{.dq..'..:.m.l.|
+00000230  de c4 5f 00 33 9e e1 31  36 bf b8 37 bb 50 a3 89  |.._.3..16..7.P..|
+00000240  4a 34 e5 59 e5 98 3d 68  1b 3a 5d 44 8d e6 32 11  |J4.Y..=h.:]D..2.|
+00000250  16 d1 21 a1 24 6e 48 d5  b7 52 96 a7 4b a4 11 73  |..!.$nH..R..K..s|
+00000260  71 6d 2e b9 63 4b f5 7a  37 c5 ac 06 81 96 eb bf  |qm..cK.z7.......|
+00000270  8f f7 5a 94 13 95 4f f3  a4 2d 1f f8 3d 48 88 1d  |..Z...O..-..=H..|
+00000280  ff 2c 74 d8 42 e2 fe 17  9a 38 46 62 e4 9d e9 3a  |.,t.B....8Fb...:|
+00000290  7e f2 06 e9 d1 8f 08 0c  49 49 96 34 95 36 f6 07  |~.......II.4.6..|
+000002a0  65 ae 87 62 fe 63 6c f7  af 43 74 2a 5b 14 ba 6e  |e..b.cl..Ct*[..n|
+000002b0  8b 4e 20 00 6b ff 5e ef  bc ef a7 4d e3 d6 9c 3d  |.N .k.^....M...=|
+000002c0  d6 e0 68 dc 60 3c ab 6a  88 9f d5 bb 8e 07 09 a1  |..h.`<.j........|
+000002d0  93 22 0a bb 8e 9f 8e 76  41 7e 4f 74 f4 56 6f 74  |.".....vA~Ot.Vot|
+000002e0  03 55 93 af b1 28 d5 0d  12 6a 91 ba 2d 1c a7 4d  |.U...(...j..-..M|
+000002f0  48 86 8c b8 33 31 0d 4a  5c 9c c9 ba 7b 56 fb 06  |H...31.J\...{V..|
+00000300  4e d5 a7 78 02 b9 d7 8d  c2 6e cc f8 76 89 72 2a  |N..x.....n..v.r*|
+00000310  d6 de 5a 83 e4 48 ec 10  da a5 19 40 78 31 55 17  |..Z..H.....@x1U.|
+00000320  71 3f aa dd 9e b3 4e 7b  67 7a 99 d5 90 55 17 03  |q?....N{gz...U..|
+00000330  03 00 99 2a 16 e8 61 11  0c 2d c4 2c 38 19 6e 4e  |...*..a..-.,8.nN|
+00000340  30 39 60 39 6c 93 a9 53  1b 0e 36 29 5b af 0e cc  |09`9l..S..6)[...|
+00000350  71 94 e6 b3 9c 5d 5a 49  29 ef f0 2d 61 a2 8c 60  |q....]ZI)..-a..`|
+00000360  e9 45 a1 3b 98 85 db 03  82 cc 90 ec 13 39 82 1b  |.E.;.........9..|
+00000370  69 d2 24 13 62 73 c6 ce  96 db 45 ce bb d3 0a 97  |i.$.bs....E.....|
+00000380  3e ce 79 ae 7d 1c 42 7d  5a ec c8 fa fb 05 ed be  |>.y.}.B}Z.......|
+00000390  7d 4d bf bf ea 1d 2f fd  7f 8f c3 c1 56 6b 97 88  |}M..../.....Vk..|
+000003a0  96 5e ac 8f 6d 42 4e 34  9d 93 75 be 98 a2 8d 03  |.^..mBN4..u.....|
+000003b0  bc ae f5 f5 6c 9b 2f 95  c0 32 ea 0d ea 48 94 56  |....l./..2...H.V|
+000003c0  43 12 d8 dd 22 e6 33 76  bf 64 4d ff 17 03 03 00  |C...".3v.dM.....|
+000003d0  35 f6 5d be e5 bc 2d ea  ce 4c 66 ab 48 c1 b1 cc  |5.]...-..Lf.H...|
+000003e0  58 da 44 14 05 7b 15 39  2e 7a 32 71 52 83 ba 10  |X.D..{.9.z2qR...|
+000003f0  31 0f 79 d9 ee 7b 41 74  0a 54 e0 53 45 dc bc 6c  |1.y..{At.T.SE..l|
+00000400  0e e4 a1 cc e1 b0 17 03  03 00 83 f6 e9 97 44 19  |..............D.|
+00000410  e9 2a 56 50 58 ea 44 02  c7 be c7 ca 73 2c 3b e2  |.*VPX.D.....s,;.|
+00000420  73 ec 77 31 a0 a5 7b 1b  ce 3e 6e 6b f0 d4 90 a8  |s.w1..{..>nk....|
+00000430  3a bf bd 87 07 20 e7 70  8e f9 4e 32 42 e5 24 13  |:.... .p..N2B.$.|
+00000440  55 b4 be ce 44 03 22 75  30 f1 cf 09 57 4c 38 83  |U...D."u0...WL8.|
+00000450  71 d0 6b 1c df 0c f6 3b  33 e5 2f 15 62 d9 eb 8e  |q.k....;3./.b...|
+00000460  8b 56 b8 10 78 fd e1 d5  0d 8e 3a 41 ab 6d 2d 78  |.V..x.....:A.m-x|
+00000470  cc 3e e3 0a 60 be 26 11  84 d7 0a bc 90 bc b6 6c  |.>..`.&........l|
+00000480  2c 97 b0 fb 62 7b ef 45  a4 c2 e0 44 f6 18        |,...b{.E...D..|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 35 69 a1 50  bd 27 9f c8 95 6d d9 e6  |....5i.P.'...m..|
-00000010  c7 19 35 4b 2f 58 e4 de  10 b9 48 ab f0 39 76 df  |..5K/X....H..9v.|
-00000020  e3 45 78 74 98 4a fb 51  d4 a8 0b ec e7 eb 78 fd  |.Ext.J.Q......x.|
-00000030  ed 98 b5 6f b2 c5 8e 64  14 43                    |...o...d.C|
+00000000  17 03 03 00 35 82 de 35  44 9b 60 8f 80 28 61 28  |....5..5D.`..(a(|
+00000010  25 5d 2a 3b 41 34 f5 cc  74 67 6b b6 37 a1 0b ef  |%]*;A4..tgk.7...|
+00000020  8e 55 bd aa 04 40 8b 87  a1 df fb 44 89 fe 48 6d  |.U...@.....D..Hm|
+00000030  06 b1 b6 4e ab 86 fe d0  ec 01                    |...N......|
 >>> Flow 6 (server to client)
-00000000  17 03 03 00 1e 40 c8 fa  b5 cc 64 32 ab b4 3a 96  |.....@....d2..:.|
-00000010  36 49 85 f8 c1 14 32 3e  86 cf a3 37 f6 ce ff ca  |6I....2>...7....|
-00000020  d1 e8 40 17 03 03 00 13  0b cd ef f7 f3 39 8d ac  |..@..........9..|
-00000030  4e 5e 6f 38 ef fa 40 ed  64 0b 4f                 |N^o8..@.d.O|
+00000000  17 03 03 00 1e 0f b0 23  a1 67 31 70 27 b9 f3 77  |.......#.g1p'..w|
+00000010  05 e5 3d d8 a2 c9 c8 0a  b6 66 a3 28 1e 40 c0 13  |..=......f.(.@..|
+00000020  87 54 18 17 03 03 00 13  bd 9a 3a ee a3 b8 53 87  |.T........:...S.|
+00000030  3f d9 6f 69 49 e8 48 f5  78 3f ee                 |?.oiI.H.x?.|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-IssueTicket b/src/crypto/tls/testdata/Server-TLSv13-IssueTicket
index 6b62aa25a3..0baa214c84 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-IssueTicket
+++ b/src/crypto/tls/testdata/Server-TLSv13-IssueTicket
@@ -1,98 +1,98 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ce 01 00 00  ca 03 03 e0 71 48 1b 86  |............qH..|
-00000010  4b eb 3e 47 7c db 98 a9  b7 ba 7b 64 a7 da 8f 51  |K.>G|.....{d...Q|
-00000020  21 18 c4 d2 db 40 16 a9  b2 4d 0b 20 3f e6 7d 6a  |!....@...M. ?.}j|
-00000030  5e 87 45 7c 4e 90 11 52  6b fe a7 bf 59 2c 63 f0  |^.E|N..Rk...Y,c.|
-00000040  41 d2 5e df 29 32 0d e4  2f 0c 2c 16 00 04 13 01  |A.^.)2../.,.....|
+00000000  16 03 01 00 ce 01 00 00  ca 03 03 59 44 3c 92 75  |...........YD<.u|
+00000010  cb b4 a3 b9 8b 19 e0 ab  df 83 0b aa 3e 01 1b a9  |............>...|
+00000020  b0 e0 8b 3e cc cd a5 a7  89 b6 54 20 b1 85 82 1f  |...>......T ....|
+00000030  ca 37 f9 e3 70 3d 1a 42  d9 70 2a d9 1a e0 29 fe  |.7..p=.B.p*...).|
+00000040  b7 81 f9 01 96 38 a2 c8  40 5b 37 4b 00 04 13 01  |.....8..@[7K....|
 00000050  00 ff 01 00 00 7d 00 0b  00 04 03 00 01 02 00 0a  |.....}..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 16 00 00 00 17  00 00 00 0d 00 1e 00 1c  |................|
 00000080  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000090  08 04 08 05 08 06 04 01  05 01 06 01 00 2b 00 03  |.............+..|
 000000a0  02 03 04 00 2d 00 02 01  01 00 33 00 26 00 24 00  |....-.....3.&.$.|
-000000b0  1d 00 20 ae b9 17 9c b7  a9 1e 2a d3 5a c8 83 92  |.. .......*.Z...|
-000000c0  dd 47 aa 91 f3 36 68 e6  f8 a6 66 fd 2c 9d 7d 58  |.G...6h...f.,.}X|
-000000d0  3b 81 29                                          |;.)|
+000000b0  1d 00 20 a5 07 27 c1 01  2f c9 4b 1d 4e 1c 86 bb  |.. ..'../.K.N...|
+000000c0  6a 2d 56 72 e0 b8 95 44  0f b2 af ef 73 b2 0d f0  |j-Vr...D....s...|
+000000d0  66 a0 45                                          |f.E|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 3f e6 7d 6a  |........... ?.}j|
-00000030  5e 87 45 7c 4e 90 11 52  6b fe a7 bf 59 2c 63 f0  |^.E|N..Rk...Y,c.|
-00000040  41 d2 5e df 29 32 0d e4  2f 0c 2c 16 13 01 00 00  |A.^.)2../.,.....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 b1 85 82 1f  |........... ....|
+00000030  ca 37 f9 e3 70 3d 1a 42  d9 70 2a d9 1a e0 29 fe  |.7..p=.B.p*...).|
+00000040  b7 81 f9 01 96 38 a2 c8  40 5b 37 4b 13 01 00 00  |.....8..@[7K....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 3c 57 c2 34 7e 2f  |..........<W.4~/|
-00000090  62 45 7f 94 6e 8d 72 d2  3f 4f 1a 9b 29 c4 d2 a9  |bE..n.r.?O..)...|
-000000a0  d1 17 03 03 02 6d 12 da  d0 63 1f 48 11 d5 5a c2  |.....m...c.H..Z.|
-000000b0  64 c3 a7 57 50 2a 39 ea  6a 24 f2 08 04 29 51 d8  |d..WP*9.j$...)Q.|
-000000c0  27 fc 8b b0 20 3e 04 aa  ea 90 aa e9 c5 d9 58 67  |'... >........Xg|
-000000d0  c2 6a 53 ec 52 cd 26 1d  8f c3 1f 34 ae b0 8e ba  |.jS.R.&....4....|
-000000e0  d1 d0 e5 00 79 6f b3 83  18 3b fb d7 60 1a 55 ff  |....yo...;..`.U.|
-000000f0  12 65 0a b8 0e e0 c9 e6  b8 cf 48 ee dd 33 a7 55  |.e........H..3.U|
-00000100  2d 7d 7e e4 07 16 6d f2  4e 3f 3f be 64 f4 5c 68  |-}~...m.N??.d.\h|
-00000110  82 f0 2a 72 0c ba 16 13  38 be 66 8b bf 01 7e 4d  |..*r....8.f...~M|
-00000120  1a 63 cf f5 03 60 b4 72  28 e8 b9 d1 0b b8 f6 b2  |.c...`.r(.......|
-00000130  61 de 7c d0 f3 81 ec 75  ce 64 a4 5f b1 2e 02 d0  |a.|....u.d._....|
-00000140  8f b7 da 2a 6e c3 44 b6  81 eb d0 d2 c8 93 6e d1  |...*n.D.......n.|
-00000150  66 d4 ea 34 a7 f3 39 ef  eb 7a 02 0d b2 28 63 af  |f..4..9..z...(c.|
-00000160  c3 29 52 e6 97 c0 98 53  8e b0 ff 5f 35 8c 27 55  |.)R....S..._5.'U|
-00000170  0c d8 32 70 16 ad 35 ee  49 2f 2d b6 42 4a a5 60  |..2p..5.I/-.BJ.`|
-00000180  2c e4 c3 36 19 d8 ae 22  71 7f c9 3d 82 01 46 fe  |,..6..."q..=..F.|
-00000190  1a 29 dd 72 27 8e 0e 20  ee fe c7 d5 68 5a 56 5a  |.).r'.. ....hZVZ|
-000001a0  9c 13 fc f4 ea 53 70 b7  bf 4e 8b 2e 5c 9e d8 ce  |.....Sp..N..\...|
-000001b0  c1 ec ae ca aa e5 f7 4a  d4 7a fc 8b 0d 1b 09 e9  |.......J.z......|
-000001c0  8a 6d ff bd 32 1a 55 ce  3b 9d af 39 05 74 a1 f6  |.m..2.U.;..9.t..|
-000001d0  6a c8 33 79 d0 f4 2a 62  1f 07 56 0b bc dd 21 b1  |j.3y..*b..V...!.|
-000001e0  51 9a 32 8a d6 07 84 de  26 20 48 2a 9c d4 41 fe  |Q.2.....& H*..A.|
-000001f0  ee 47 04 53 e2 ef 1e f5  12 a2 e1 18 26 5e 6a e1  |.G.S........&^j.|
-00000200  d0 aa 07 15 9d eb 80 bd  93 f1 e3 7b f4 63 e8 69  |...........{.c.i|
-00000210  73 6e 54 c4 c2 12 3a 00  44 a0 44 79 13 50 a1 1c  |snT...:.D.Dy.P..|
-00000220  83 a5 fe 32 fa 37 51 4f  9c 9a 49 d5 f4 35 18 05  |...2.7QO..I..5..|
-00000230  c6 31 b1 75 52 fc c4 14  4f 23 5f d6 f4 06 7f 34  |.1.uR...O#_....4|
-00000240  d3 24 7e 59 4c 9c 5c 64  e4 d1 31 8a 5d 93 3c 19  |.$~YL.\d..1.].<.|
-00000250  63 8e 72 bf 6c 48 af b5  37 1b 35 ad d0 cd e3 a2  |c.r.lH..7.5.....|
-00000260  9e 86 68 da 82 d7 47 ad  11 60 46 45 ef 3e fa 72  |..h...G..`FE.>.r|
-00000270  9f 4d 14 b5 9c b4 21 91  bc f7 d0 42 88 2e af 60  |.M....!....B...`|
-00000280  ac 78 51 52 82 bd 68 de  61 3d af cb e3 6b c0 0d  |.xQR..h.a=...k..|
-00000290  d3 ea 4c fe a0 c6 7e 92  e7 78 6e e8 8c 10 bb 18  |..L...~..xn.....|
-000002a0  6f cb e8 a1 3e 46 24 a6  89 16 f0 e3 74 02 f0 09  |o...>F$.....t...|
-000002b0  be 1e 6c fa 69 8d 3b 66  7e 21 65 0e b7 9a c2 d2  |..l.i.;f~!e.....|
-000002c0  93 13 0a 6a c7 be 0f 3d  6d 20 33 af 13 65 30 54  |...j...=m 3..e0T|
-000002d0  e8 b7 ae 1d 80 1d c8 3c  28 6e da 6e 9a d3 e6 38  |.......<(n.n...8|
-000002e0  a5 d9 e5 08 70 2e c8 67  e8 f8 c0 a1 b3 93 5a 4c  |....p..g......ZL|
-000002f0  a2 5e 38 38 87 05 f7 3a  00 3f 1c 11 3d d2 6a 4f  |.^88...:.?..=.jO|
-00000300  28 ad b2 5f cb d4 aa bd  25 db c4 5a 99 dc c4 1c  |(.._....%..Z....|
-00000310  2c e9 e2 17 03 03 00 99  03 b1 93 f2 6d a4 fd 0c  |,...........m...|
-00000320  74 1f 3f b6 a7 bb e7 31  ba e2 34 f1 30 dc 31 85  |t.?....1..4.0.1.|
-00000330  8b ab f8 aa 08 ee 7c 5a  af 8c c2 7c ed bb 5d 57  |......|Z...|..]W|
-00000340  b0 80 00 d0 3d 3d eb d9  f5 cb b9 31 a0 ba 39 8f  |....==.....1..9.|
-00000350  cd 71 be 6b 33 e7 88 68  b5 4e 74 73 c6 ae d2 b1  |.q.k3..h.Nts....|
-00000360  68 ba d3 72 c1 3a 24 2b  cc bd ba 24 44 ec 14 ce  |h..r.:$+...$D...|
-00000370  7b 46 96 44 a3 91 48 2f  12 00 b6 47 eb 7a 03 c7  |{F.D..H/...G.z..|
-00000380  9a 59 2c 78 79 4b c6 d3  22 45 07 8f d9 ba 9d c7  |.Y,xyK.."E......|
-00000390  55 23 3f d2 9d ca 33 b2  8e 53 ce 4c 72 49 6a 58  |U#?...3..S.LrIjX|
-000003a0  ad 12 a4 e8 1e 36 7b 2d  f7 88 75 19 2f 3b 0a 6b  |.....6{-..u./;.k|
-000003b0  81 17 03 03 00 35 4a 0f  d8 a6 83 4a 37 2e 29 66  |.....5J....J7.)f|
-000003c0  63 88 0f 7f cd e8 fd b9  40 9c 94 d0 dd 37 c3 2e  |c.......@....7..|
-000003d0  1f c6 e0 88 ac df 6e af  57 7b 46 68 4a 51 cc 36  |......n.W{FhJQ.6|
-000003e0  2f e7 ae 66 0e c2 8e 05  4e ec 2b 17 03 03 00 83  |/..f....N.+.....|
-000003f0  c9 1b a8 14 4f c6 47 d2  4a 96 94 cd bc 88 94 ec  |....O.G.J.......|
-00000400  80 74 78 36 33 bd f1 f4  76 61 9c 8f 59 88 2a 65  |.tx63...va..Y.*e|
-00000410  af 85 24 e2 d3 6e 74 18  ac 38 52 46 bb 72 56 57  |..$..nt..8RF.rVW|
-00000420  c2 1d 3f 1b 7c 78 c1 e9  21 d0 f1 52 b9 e9 8e 0b  |..?.|x..!..R....|
-00000430  3f 85 fd 69 91 fe 8f e8  2d 2c 33 bc 5b bc 18 64  |?..i....-,3.[..d|
-00000440  5c b5 5b 2d 3e 1f b0 6f  89 8c b9 a0 14 9b 45 15  |\.[->..o......E.|
-00000450  0e a8 e2 ce 17 c9 ce d2  45 58 62 39 b9 fb 4d 15  |........EXb9..M.|
-00000460  b1 6d db a4 2e c1 e3 c5  8a 1b 3f 08 96 6d 20 5e  |.m........?..m ^|
-00000470  cf 26 8d                                          |.&.|
+00000080  03 03 00 01 01 17 03 03  00 17 70 52 a2 a2 06 f6  |..........pR....|
+00000090  69 83 e2 63 6d e7 3d 01  83 0b 1a 89 35 6d de c8  |i..cm.=.....5m..|
+000000a0  3b 17 03 03 02 6d c2 72  e4 d8 f5 eb 22 22 76 85  |;....m.r....""v.|
+000000b0  a5 fc 13 30 54 84 fc d3  a1 2b bd 86 16 08 85 0e  |...0T....+......|
+000000c0  4c b0 4a 24 b8 21 3d 61  e6 7a d8 0d 01 1e 74 92  |L.J$.!=a.z....t.|
+000000d0  ef f7 b7 88 44 4a c7 19  9a b8 52 73 52 28 84 dd  |....DJ....RsR(..|
+000000e0  67 7a 32 93 82 10 f8 8f  ce 0f 4d 1a 00 f2 47 f9  |gz2.......M...G.|
+000000f0  e8 76 e6 9a 71 35 76 8e  ef 40 a1 00 bb 7d a3 34  |.v..q5v..@...}.4|
+00000100  56 14 d5 22 a2 3e e7 6b  28 1d d4 55 f6 69 ca e3  |V..".>.k(..U.i..|
+00000110  74 79 b5 b8 d5 a7 dd 77  28 75 f7 9d 23 a7 9b 0e  |ty.....w(u..#...|
+00000120  b7 b3 93 d4 0a 34 49 b1  9c 51 dc b3 f6 45 50 e0  |.....4I..Q...EP.|
+00000130  c2 aa 49 82 ba 59 ce f9  1a 56 78 a8 b2 e3 42 e1  |..I..Y...Vx...B.|
+00000140  99 bb 25 99 c1 ed 6f bb  38 26 01 50 1c 5e 19 c1  |..%...o.8&.P.^..|
+00000150  a4 2a a1 18 9e c2 71 72  ed 11 65 82 4f be c7 67  |.*....qr..e.O..g|
+00000160  ce 7e a4 45 e7 ef 9e 75  7d 14 42 d2 1f de ef 7f  |.~.E...u}.B.....|
+00000170  33 67 5e bc 3c a5 cf 7c  94 a6 b0 cd a6 94 02 6a  |3g^.<..|.......j|
+00000180  42 12 e4 8a d3 72 10 f4  8a 21 a6 b3 c3 58 c3 74  |B....r...!...X.t|
+00000190  81 94 37 1d e7 a1 94 db  28 4c 28 e5 2a 2a 52 bc  |..7.....(L(.**R.|
+000001a0  5c 46 a4 e3 bf 3e 53 95  c4 95 fe 68 af 83 fb c9  |\F...>S....h....|
+000001b0  13 99 83 80 f2 ab a6 d3  af cd d9 a0 92 f0 99 41  |...............A|
+000001c0  05 a2 ee 50 f0 d2 27 5a  90 cd 38 a6 51 b8 da ff  |...P..'Z..8.Q...|
+000001d0  26 18 1b 89 9d 43 25 12  15 95 8d ec 71 cd 7d 25  |&....C%.....q.}%|
+000001e0  a8 fe 74 08 ee e6 62 21  54 65 ce d1 a5 fb 6d d3  |..t...b!Te....m.|
+000001f0  e9 bf 5b 50 be ce 9b 08  c0 f4 13 8d f9 c9 08 4c  |..[P...........L|
+00000200  76 5d e9 d9 a0 72 03 0c  5f e3 3f 2a cb 19 bc 29  |v]...r.._.?*...)|
+00000210  46 ed 8e 0f ec 28 cb 7e  2a 19 d2 a2 b5 78 6c 9e  |F....(.~*....xl.|
+00000220  70 2e a1 cd cf 30 b6 8d  d2 5b de 12 1d 30 37 7e  |p....0...[...07~|
+00000230  62 f2 79 c9 3a 52 61 64  a3 96 9b 7a 69 ae c7 3c  |b.y.:Rad...zi..<|
+00000240  76 4b 2d 78 c3 2e d9 82  12 cf 54 64 1d f6 c7 a4  |vK-x......Td....|
+00000250  78 ce 7d df 08 6a 59 c6  8c dc 4c 2b 54 68 23 04  |x.}..jY...L+Th#.|
+00000260  aa 71 5f 37 e3 02 05 02  72 c8 2d dd 86 a4 86 e0  |.q_7....r.-.....|
+00000270  ba eb 63 65 18 0a 68 29  4f 83 f9 bc 6c 9a 10 a5  |..ce..h)O...l...|
+00000280  14 42 35 b4 85 ad 48 6e  e7 34 0c 12 2b 4c 93 c8  |.B5...Hn.4..+L..|
+00000290  96 78 fd 69 43 ed ee 48  03 84 77 b8 4b d4 bb ce  |.x.iC..H..w.K...|
+000002a0  ee f3 c4 3f a4 c9 93 80  0f 0d cd 4b 40 03 c8 ea  |...?.......K@...|
+000002b0  91 7d f8 4f 9d b7 61 f1  a2 1c 92 e7 12 00 8a 71  |.}.O..a........q|
+000002c0  37 83 c9 07 ba 51 d2 bc  45 ff 76 e5 ea 61 e4 0a  |7....Q..E.v..a..|
+000002d0  f3 b9 1f 0e 0f 13 b5 ac  4a 17 b7 72 73 3a 1f 4c  |........J..rs:.L|
+000002e0  c4 eb 77 1a 76 7e 6f 69  87 01 22 09 7a 20 0c af  |..w.v~oi..".z ..|
+000002f0  8e 41 5a 60 60 e8 fd 47  a1 e2 b8 b2 44 97 37 f2  |.AZ``..G....D.7.|
+00000300  03 58 c0 b6 69 4c 7a 44  d9 f3 6b 27 54 c7 9b 15  |.X..iLzD..k'T...|
+00000310  80 aa 44 17 03 03 00 99  4e f8 a4 ae 13 37 8d 4d  |..D.....N....7.M|
+00000320  23 87 61 a2 28 0f 23 09  08 6c 26 0c a5 41 b8 86  |#.a.(.#..l&..A..|
+00000330  04 69 1b 04 cb 10 81 ea  89 39 e2 6b f4 ee ff ca  |.i.......9.k....|
+00000340  d4 6f 91 0a ff 5a 99 8f  8d 07 0b 56 1c ba 02 74  |.o...Z.....V...t|
+00000350  ba 56 81 be b1 05 bd 95  28 38 ad 15 fa 9e 82 90  |.V......(8......|
+00000360  8c a0 0a ac aa 3f 15 d5  12 70 e8 ec 5b bc d0 24  |.....?...p..[..$|
+00000370  fd 70 3c 67 2e 90 9a f2  e6 a1 22 04 36 90 59 c7  |.p<g......".6.Y.|
+00000380  8a 27 8c 24 2b 49 a9 75  5a f4 96 a5 c5 d9 c7 b1  |.'.$+I.uZ.......|
+00000390  ae 49 0e ae c1 62 46 c9  4d d4 10 ea e0 90 ea 0e  |.I...bF.M.......|
+000003a0  7c 8c 79 69 87 6d 81 34  b5 13 bf bc 83 d3 6a 2b  ||.yi.m.4......j+|
+000003b0  85 17 03 03 00 35 8e bc  0b 59 6e 07 f9 f4 f7 9c  |.....5...Yn.....|
+000003c0  3c 40 97 70 03 3c 98 f9  8d 95 d0 09 42 1a 51 15  |<@.p.<......B.Q.|
+000003d0  bb 27 c7 4b 96 f9 ee e1  ad 7c 7f 8c 1c 04 6c 66  |.'.K.....|....lf|
+000003e0  3d c8 a6 1d 55 90 53 1d  7c 12 b2 17 03 03 00 83  |=...U.S.|.......|
+000003f0  43 1a f2 1f b0 75 3a 20  b3 52 27 8e 2c 32 83 64  |C....u: .R'.,2.d|
+00000400  76 91 72 0a ce 82 fd 26  29 6f af 59 73 66 87 8c  |v.r....&)o.Ysf..|
+00000410  cc ff 8a f3 c9 8c 40 b9  2a 80 bd 88 c3 63 e7 e6  |......@.*....c..|
+00000420  4d d0 08 bd d9 a4 af 2a  f2 51 40 66 68 26 51 ea  |M......*.Q@fh&Q.|
+00000430  07 fa aa 0b 2f f8 8e 82  e4 c1 35 cf a8 85 b5 ba  |..../.....5.....|
+00000440  a0 9f 5c 02 c9 95 dc 5a  0d 95 d6 63 2b b8 6c 43  |..\....Z...c+.lC|
+00000450  df 2c 57 bf 0f c0 e7 a5  6f 01 b3 1f 41 7e 11 7a  |.,W.....o...A~.z|
+00000460  0b c0 ad 58 42 18 0b 43  07 76 18 63 2e 76 98 55  |...XB..C.v.c.v.U|
+00000470  7e 87 29                                          |~.)|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 45 a8 d5 cc 41  |..........5E...A|
-00000010  5e 79 4c 85 84 da 97 fd  76 e6 68 5f 9a d2 20 8b  |^yL.....v.h_.. .|
-00000020  9b 2c 63 b0 d3 de 08 5d  28 0b d7 b3 37 93 56 7c  |.,c....](...7.V||
-00000030  cd 95 c6 54 51 e3 72 4e  08 eb 50 7d cc 4e 63 63  |...TQ.rN..P}.Ncc|
+00000000  14 03 03 00 01 01 17 03  03 00 35 fe 9d 4f d6 67  |..........5..O.g|
+00000010  c0 b8 04 a3 f1 5f 19 69  8a a4 85 74 9c f9 cf c2  |....._.i...t....|
+00000020  a2 8e 0b d5 6a 34 01 c8  8f d5 ee 91 ee 41 83 f7  |....j4.......A..|
+00000030  34 6e 51 9a ca df 46 d9  92 d1 3b a8 8c 82 bb 7b  |4nQ...F...;....{|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 75 6c 1f  04 3a 4e 62 cd 44 4c 2d  |.....ul..:Nb.DL-|
-00000010  dc 14 7a 1b 7f de ca 76  be 44 c7 52 d0 99 fd 4c  |..z....v.D.R...L|
-00000020  0f c1 7d 17 03 03 00 13  cd cd 51 e5 c5 d3 9a d8  |..}.......Q.....|
-00000030  f6 8b f5 00 f5 76 9b 9f  f1 02 9d                 |.....v.....|
+00000000  17 03 03 00 1e 6a d2 f7  f6 97 a1 62 47 ea a0 10  |.....j.....bG...|
+00000010  ca 83 cb d4 83 6c b6 42  2c c4 77 7c 18 97 f4 a3  |.....l.B,.w|....|
+00000020  24 09 fc 17 03 03 00 13  42 e9 a8 8c f3 70 72 e2  |$.......B....pr.|
+00000030  2a c2 17 e5 85 19 08 e3  47 2e 6e                 |*.......G.n|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-IssueTicketPreDisable b/src/crypto/tls/testdata/Server-TLSv13-IssueTicketPreDisable
index b39f4cdb7f..f3a6d85e26 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-IssueTicketPreDisable
+++ b/src/crypto/tls/testdata/Server-TLSv13-IssueTicketPreDisable
@@ -1,98 +1,98 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ce 01 00 00  ca 03 03 78 86 2c 50 96  |...........x.,P.|
-00000010  db 53 0e 9c 59 2f 08 bf  b1 dc 4d a0 ab 7f 70 83  |.S..Y/....M...p.|
-00000020  9f c0 06 14 51 e8 96 9f  b9 23 ca 20 67 6c 7b 8c  |....Q....#. gl{.|
-00000030  2d de 80 d4 53 b5 1c ce  bf a7 85 ec 96 d3 84 84  |-...S...........|
-00000040  ad 3b 54 ff 7c c7 18 f6  0e 4d c3 ed 00 04 13 01  |.;T.|....M......|
+00000000  16 03 01 00 ce 01 00 00  ca 03 03 a6 59 f5 41 c1  |............Y.A.|
+00000010  48 0a 0c b3 77 0d c1 97  a4 2b 19 09 94 2c e6 bd  |H...w....+...,..|
+00000020  00 74 81 4f fc fa 23 27  24 b5 7d 20 9a d8 41 47  |.t.O..#'$.} ..AG|
+00000030  d9 24 ef 3f 25 38 8f 35  69 57 51 8d 2d b1 5f af  |.$.?%8.5iWQ.-._.|
+00000040  e5 3c 53 f8 b3 84 67 e5  f9 d9 75 a0 00 04 13 01  |.<S...g...u.....|
 00000050  00 ff 01 00 00 7d 00 0b  00 04 03 00 01 02 00 0a  |.....}..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 16 00 00 00 17  00 00 00 0d 00 1e 00 1c  |................|
 00000080  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000090  08 04 08 05 08 06 04 01  05 01 06 01 00 2b 00 03  |.............+..|
 000000a0  02 03 04 00 2d 00 02 01  01 00 33 00 26 00 24 00  |....-.....3.&.$.|
-000000b0  1d 00 20 4c e5 05 bc 23  11 3c 0e 96 aa d5 9c 17  |.. L...#.<......|
-000000c0  fc 51 1b c8 c9 eb 9e 68  80 5a 14 ca 76 09 68 ee  |.Q.....h.Z..v.h.|
-000000d0  ec b3 39                                          |..9|
+000000b0  1d 00 20 71 d4 d1 e7 c4  4d 0b 7c fd ad 88 0e fb  |.. q....M.|.....|
+000000c0  17 a2 dd ab b4 22 5b dd  a2 d7 07 90 b7 79 32 2c  |....."[......y2,|
+000000d0  63 89 60                                          |c.`|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 67 6c 7b 8c  |........... gl{.|
-00000030  2d de 80 d4 53 b5 1c ce  bf a7 85 ec 96 d3 84 84  |-...S...........|
-00000040  ad 3b 54 ff 7c c7 18 f6  0e 4d c3 ed 13 01 00 00  |.;T.|....M......|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 9a d8 41 47  |........... ..AG|
+00000030  d9 24 ef 3f 25 38 8f 35  69 57 51 8d 2d b1 5f af  |.$.?%8.5iWQ.-._.|
+00000040  e5 3c 53 f8 b3 84 67 e5  f9 d9 75 a0 13 01 00 00  |.<S...g...u.....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 8d cf 99 5f 3c c1  |............._<.|
-00000090  21 8a af ce 37 12 0e 1e  1d 65 86 35 59 9d ab a9  |!...7....e.5Y...|
-000000a0  b5 17 03 03 02 6d de 3b  1b 3a ad a0 e8 2f 17 de  |.....m.;.:.../..|
-000000b0  bd 3b 72 47 9c 6d d2 f6  62 92 8e e9 27 bb cb e2  |.;rG.m..b...'...|
-000000c0  1a 2d c1 37 10 74 9b e5  bb 97 e4 a3 07 36 df f9  |.-.7.t.......6..|
-000000d0  34 44 69 cb b7 95 6f 55  55 48 cb fb 2c a0 48 a4  |4Di...oUUH..,.H.|
-000000e0  ea 24 32 14 c8 1e 3f 2c  f0 c9 a8 03 d9 29 55 d3  |.$2...?,.....)U.|
-000000f0  b7 2c 54 c6 ad 0a 07 94  f1 f3 2e 2f a0 e2 ce 6a  |.,T......../...j|
-00000100  67 a9 25 3f ec eb 89 82  01 62 ec 34 ae fd 3d 8a  |g.%?.....b.4..=.|
-00000110  24 de 35 fd bc 48 cd 80  99 7c ff 08 3e 76 e8 4c  |$.5..H...|..>v.L|
-00000120  26 3b 36 4d b1 06 57 3d  b0 e3 45 79 bd 50 9d 12  |&;6M..W=..Ey.P..|
-00000130  3e 69 43 12 07 b7 72 ad  d1 96 bc 7c cf a3 98 73  |>iC...r....|...s|
-00000140  b0 1a 9e 70 2c 05 2b 5e  5e 63 4b 93 e5 c9 16 f3  |...p,.+^^cK.....|
-00000150  a0 f5 10 63 96 10 5b 78  74 35 d9 8d f0 b2 8a ae  |...c..[xt5......|
-00000160  4c 43 2e a6 ec b6 94 a1  6f 92 6d 91 cb 16 68 d9  |LC......o.m...h.|
-00000170  83 44 75 d3 24 46 31 0c  78 a5 79 6e cd 62 15 35  |.Du.$F1.x.yn.b.5|
-00000180  48 b4 f0 de 9c cf a1 79  a1 e0 c3 88 3b ea 5f 00  |H......y....;._.|
-00000190  8f 59 16 a1 70 43 74 e6  19 fd 9c 43 c4 e5 f2 c1  |.Y..pCt....C....|
-000001a0  1b 97 98 8e d5 43 c1 d1  4e 31 b0 a6 ae 45 25 66  |.....C..N1...E%f|
-000001b0  4c 3a a6 3a 5a 9d 7d 65  dc 69 68 bb 83 21 01 7f  |L:.:Z.}e.ih..!..|
-000001c0  77 2d 9c e3 9f bd 00 2f  f5 e2 01 f1 b4 4d b5 16  |w-...../.....M..|
-000001d0  22 14 91 7a 82 21 c9 8c  cb 0e e7 2d 34 69 ee 31  |"..z.!.....-4i.1|
-000001e0  8a fd cb 03 96 00 95 14  41 cf 97 41 86 15 83 02  |........A..A....|
-000001f0  6f c3 39 ff 6d 14 9e 67  a2 1c 8b 11 36 5a 30 99  |o.9.m..g....6Z0.|
-00000200  10 88 da 51 e8 29 e4 0c  f5 44 7d e2 cb 31 2d 74  |...Q.)...D}..1-t|
-00000210  17 0d 3b e6 09 0d e3 7e  71 48 84 5d 13 ae 74 5d  |..;....~qH.]..t]|
-00000220  fa 3f 7b 66 73 dd 27 24  8a 9b 4f 3d 50 be 15 1c  |.?{fs.'$..O=P...|
-00000230  e7 71 9c 80 9d f3 8d 1f  d2 d3 66 3d 3a 2e 86 7a  |.q........f=:..z|
-00000240  16 ff eb 39 52 df 16 fa  d0 c1 d8 8a 4d 2a 03 da  |...9R.......M*..|
-00000250  98 9f c6 71 5b 07 5b 9f  b8 ea f6 a3 5d b0 06 94  |...q[.[.....]...|
-00000260  35 94 e6 9c 29 23 9d 9c  1c a6 15 0e 11 f4 0b 0d  |5...)#..........|
-00000270  b6 c9 a5 c5 94 df 18 6d  62 7a 47 54 87 7e a6 7e  |.......mbzGT.~.~|
-00000280  18 82 39 53 b3 c5 95 23  7a ce a9 62 dd 71 51 17  |..9S...#z..b.qQ.|
-00000290  4e e5 3c 45 05 64 23 c4  26 35 d8 37 cb 2f 08 7d  |N.<E.d#.&5.7./.}|
-000002a0  5a 0b a9 cb 75 3d 7a 40  97 d9 d4 6a 54 ae 03 92  |Z...u=z@...jT...|
-000002b0  21 53 df 06 ed 1f c2 49  04 a6 63 6f c8 53 aa f0  |!S.....I..co.S..|
-000002c0  76 c1 d0 da 17 44 54 5e  05 9f e9 68 25 32 47 fb  |v....DT^...h%2G.|
-000002d0  5b d6 f3 31 e2 88 25 d4  b8 b0 f7 86 69 98 87 f1  |[..1..%.....i...|
-000002e0  37 26 41 e5 52 1c 74 92  b3 05 db 0b 81 95 b5 19  |7&A.R.t.........|
-000002f0  2e b2 2c 36 73 bc c7 5c  5d 48 37 22 33 cb 1f 46  |..,6s..\]H7"3..F|
-00000300  6d cd 61 09 8f e6 c5 2a  18 d1 5e 3e 15 54 29 21  |m.a....*..^>.T)!|
-00000310  ce 49 f4 17 03 03 00 99  ef a9 b8 74 91 ea be 90  |.I.........t....|
-00000320  0d 55 6f d3 e5 6b 7b 19  bb 1c cc c2 6d 0a 49 85  |.Uo..k{.....m.I.|
-00000330  f0 30 12 6e 05 88 7c d0  80 a4 39 82 f7 24 8a 0b  |.0.n..|...9..$..|
-00000340  89 84 a1 89 3a ab bb 79  01 6a a1 48 ef 22 15 a7  |....:..y.j.H."..|
-00000350  43 e7 96 76 85 23 59 d2  27 ea 89 45 e1 76 06 52  |C..v.#Y.'..E.v.R|
-00000360  6d eb b6 89 76 be 3f 2d  4c 8f 75 a1 69 fa 52 47  |m...v.?-L.u.i.RG|
-00000370  ee 9a a7 c1 40 bd fb 76  69 da 73 55 d6 5a 4c 36  |....@..vi.sU.ZL6|
-00000380  61 ee bc b3 d5 b3 23 17  1c da 79 83 00 d6 1e 57  |a.....#...y....W|
-00000390  09 24 85 97 85 58 d6 5d  61 60 ae 3b 85 0e 28 dc  |.$...X.]a`.;..(.|
-000003a0  08 1a ea 49 11 47 b9 8a  d1 7e 47 20 48 64 ad cc  |...I.G...~G Hd..|
-000003b0  2e 17 03 03 00 35 c6 76  14 a6 a0 7d 5d 0c 03 4b  |.....5.v...}]..K|
-000003c0  2f 65 c0 55 ab aa ab 61  10 2f 0f 25 44 2b 76 9c  |/e.U...a./.%D+v.|
-000003d0  73 6b 8b 19 d8 2a 3e 1c  4d 96 1b 5f bd 80 af b2  |sk...*>.M.._....|
-000003e0  4a aa 3c 3c 65 ab 5a ca  2d 1d 65 17 03 03 00 83  |J.<<e.Z.-.e.....|
-000003f0  0a f6 d8 a3 67 b3 27 62  f5 64 c3 43 bd 08 f8 af  |....g.'b.d.C....|
-00000400  d1 56 ce 25 8b 3f d9 6b  54 9c 4e 5e 8c 06 24 95  |.V.%.?.kT.N^..$.|
-00000410  a0 49 e2 25 d2 b8 7f a0  59 06 04 26 19 16 ad 3b  |.I.%....Y..&...;|
-00000420  30 82 0f c3 84 bf 70 78  58 4c 76 f7 91 0e f2 1a  |0.....pxXLv.....|
-00000430  88 10 4e b3 c9 26 b5 7b  ab 1a 72 c6 1a 2a b0 65  |..N..&.{..r..*.e|
-00000440  92 86 c4 84 5b e7 ab 3c  7e b4 0d 67 0c 53 d9 1d  |....[..<~..g.S..|
-00000450  81 47 e3 f9 11 09 26 4a  67 ff 1a 55 5b f8 93 e0  |.G....&Jg..U[...|
-00000460  e1 52 2f e5 c3 3c 73 98  6e 98 25 d8 d7 f4 2a 6e  |.R/..<s.n.%...*n|
-00000470  f7 e8 6e                                          |..n|
+00000080  03 03 00 01 01 17 03 03  00 17 77 64 5d 4c 13 8a  |..........wd]L..|
+00000090  c6 73 b4 43 30 73 91 01  73 7c f1 02 c8 54 4a 51  |.s.C0s..s|...TJQ|
+000000a0  91 17 03 03 02 6d a9 39  69 5b 70 16 c0 dd 00 c2  |.....m.9i[p.....|
+000000b0  74 a8 f9 8d 0a 53 f3 e5  99 fc 92 66 c3 7d 9c 3b  |t....S.....f.}.;|
+000000c0  39 4d b0 a2 9f 02 ab 07  36 27 d6 bc 14 6d f4 48  |9M......6'...m.H|
+000000d0  5b 78 16 3e 83 19 e6 03  9f e4 4a 4f 3d 0c cb c8  |[x.>......JO=...|
+000000e0  d0 bb 36 7c 73 81 bf e7  71 b3 52 0a 0a df 0b 97  |..6|s...q.R.....|
+000000f0  69 4a ac 2c 56 05 b9 0c  37 46 e1 36 85 c8 1f da  |iJ.,V...7F.6....|
+00000100  73 55 d3 82 d4 90 0e c0  c0 75 f3 05 f2 ab fb ef  |sU.......u......|
+00000110  13 00 5e d6 c5 23 25 31  a8 e0 59 a3 52 86 b7 f5  |..^..#%1..Y.R...|
+00000120  5d 0b d6 b9 b1 7d b8 00  1b 66 94 ff bf d5 dc ff  |]....}...f......|
+00000130  45 e1 38 1b 33 fa 12 b8  73 eb 54 ed 4b b3 ce 87  |E.8.3...s.T.K...|
+00000140  d1 aa ec 11 ad 92 2a 0b  96 9f 8e 30 ab 23 12 60  |......*....0.#.`|
+00000150  73 fc 7d e1 e2 17 4d 3a  2f 37 c6 ec c5 8f 96 79  |s.}...M:/7.....y|
+00000160  fa 5f 0e c8 fe 37 b3 6c  73 a3 2d 53 79 95 9d 19  |._...7.ls.-Sy...|
+00000170  84 98 6b ba cb ed bd 6e  2d ea b9 eb bc a0 6e 04  |..k....n-.....n.|
+00000180  59 5e 8a cd 42 31 50 f7  2d 7a 9f dd e7 f7 c2 e8  |Y^..B1P.-z......|
+00000190  ee 52 c0 ca 99 77 38 b1  bd be 96 bf af 4c 5c a5  |.R...w8......L\.|
+000001a0  95 a3 8d 96 c6 c9 ff 62  b9 72 7d 5a 93 d7 8e 49  |.......b.r}Z...I|
+000001b0  66 5c 5a 6b 24 c9 4d e3  eb 7c 7f 69 25 3d 28 d9  |f\Zk$.M..|.i%=(.|
+000001c0  0f 05 49 89 aa c2 1b 8c  cf 52 7b 5b 6c 10 55 43  |..I......R{[l.UC|
+000001d0  fd d7 6a ef 42 6f f8 a6  90 a3 d6 b8 35 65 12 e9  |..j.Bo......5e..|
+000001e0  f6 5c 56 35 6d 27 cc aa  99 5c 74 5c 67 e3 a8 3d  |.\V5m'...\t\g..=|
+000001f0  3b fe 4b 39 90 5e f2 0d  20 93 85 04 72 b5 18 42  |;.K9.^.. ...r..B|
+00000200  c1 c6 5d 54 70 64 ec f1  61 bd 0c de 66 e7 52 d0  |..]Tpd..a...f.R.|
+00000210  69 c3 f2 1e f6 b2 d4 59  97 d6 c8 64 0d 03 52 72  |i......Y...d..Rr|
+00000220  c4 84 14 ba ce 93 d6 8c  97 58 dc 26 6c 05 9b 41  |.........X.&l..A|
+00000230  af 72 bb 90 98 21 5d cc  8d b6 d9 74 9b f1 50 6d  |.r...!]....t..Pm|
+00000240  27 16 6c b5 0b d6 2a 34  ad e8 a8 13 20 b8 dc 57  |'.l...*4.... ..W|
+00000250  46 1b 01 f8 e0 3a 54 9f  19 92 ca 73 6d ff 2a bf  |F....:T....sm.*.|
+00000260  44 e4 3b 65 a8 1b 35 20  52 8b 84 f3 e2 69 8d 0d  |D.;e..5 R....i..|
+00000270  a4 d1 4e 52 2c 14 54 ad  8c 30 39 23 68 c5 ad 3f  |..NR,.T..09#h..?|
+00000280  a1 12 ab 34 62 9f 5f bc  33 05 22 1f 45 a0 01 00  |...4b._.3.".E...|
+00000290  47 08 ea da 3a 27 28 34  06 64 6a ef 33 e0 3d af  |G...:'(4.dj.3.=.|
+000002a0  b5 94 99 9e 44 24 cd b1  b4 ac 9c 94 dd d2 90 3d  |....D$.........=|
+000002b0  dc 6c 5b 92 0b d5 a2 e6  b0 be 23 9c ec fa 19 3c  |.l[.......#....<|
+000002c0  e7 52 22 a5 d8 5c d0 c5  cd bf 7e 22 b5 7a 31 cb  |.R"..\....~".z1.|
+000002d0  de 12 ff d3 78 c9 1f 61  17 1f fe 4c fd 64 8d 01  |....x..a...L.d..|
+000002e0  5c e6 39 e8 a8 28 9b 7c  5f 07 0c 37 50 1a 26 18  |\.9..(.|_..7P.&.|
+000002f0  1c 85 70 d6 b4 29 f4 aa  07 7f c7 22 dd 41 5b a5  |..p..).....".A[.|
+00000300  2c 5d 35 b1 97 64 ff 8e  6c 52 e7 ce c7 da 36 01  |,]5..d..lR....6.|
+00000310  bb 91 77 17 03 03 00 99  60 ae 04 72 68 35 4c 13  |..w.....`..rh5L.|
+00000320  92 0d 4a 3f 48 c0 ac f6  68 61 f3 41 9d 2c 08 11  |..J?H...ha.A.,..|
+00000330  e2 bc cb 37 e4 1e b3 72  90 e0 c8 fa a2 d5 8d 23  |...7...r.......#|
+00000340  5b a8 4d 35 16 f2 6e f6  16 7d 7c ca 42 06 20 ad  |[.M5..n..}|.B. .|
+00000350  90 01 c7 34 4c b3 08 13  2b 42 98 2e c5 80 5f 28  |...4L...+B...._(|
+00000360  70 24 16 eb f4 7e a8 ea  c9 34 b6 7d 62 0f 90 2d  |p$...~...4.}b..-|
+00000370  ed 03 7a 63 ef 3d 1b bc  18 1f f5 dd 12 ac c4 19  |..zc.=..........|
+00000380  f1 83 53 b0 6d 75 a9 e3  ed 74 d1 e5 8e 60 5b 26  |..S.mu...t...`[&|
+00000390  93 9c 1f a8 d6 69 11 c5  1c 1c 30 00 78 c0 4e 60  |.....i....0.x.N`|
+000003a0  52 d2 93 ab 59 80 b7 30  e8 bb 8e d3 7a 4f d3 18  |R...Y..0....zO..|
+000003b0  a8 17 03 03 00 35 33 38  d3 40 f0 f6 23 85 da 39  |.....538.@..#..9|
+000003c0  f1 f0 02 7d dc 4a 2a 8c  4d 07 08 06 52 8c 20 44  |...}.J*.M...R. D|
+000003d0  98 ac 94 22 3e 2b 8a e6  cb c1 1d e0 0e 32 f8 75  |...">+.......2.u|
+000003e0  7b 1c 11 b6 43 da 7d 07  8e a9 71 17 03 03 00 83  |{...C.}...q.....|
+000003f0  36 33 e3 5e f3 b9 b2 46  66 04 cc 45 30 51 45 3f  |63.^...Ff..E0QE?|
+00000400  21 98 7c 7e 63 f8 67 0b  73 2f c1 42 5f e3 83 17  |!.|~c.g.s/.B_...|
+00000410  8c 87 f9 4f 11 1e aa 61  cc 9a 32 5d 53 08 f6 f7  |...O...a..2]S...|
+00000420  df 44 ff 52 a6 53 4c 7e  09 0d 6c c9 0e d8 a3 de  |.D.R.SL~..l.....|
+00000430  c1 bb 45 8c b9 96 6d fa  6c e1 e8 8a 92 69 3f 31  |..E...m.l....i?1|
+00000440  b1 de 80 da fe b4 1d b4  28 3d 78 5d 64 50 eb a6  |........(=x]dP..|
+00000450  f1 fc e1 a6 9f c7 d8 4a  78 20 66 41 e0 31 fd ae  |.......Jx fA.1..|
+00000460  1c 56 7d a0 a8 18 5c 3c  b4 a5 12 be f7 02 5e fa  |.V}...\<......^.|
+00000470  52 ad 38                                          |R.8|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 9b 1d 48 76 dc  |..........5..Hv.|
-00000010  64 a6 c8 3e f9 f4 2c fa  cb e4 a6 f5 37 c5 77 d0  |d..>..,.....7.w.|
-00000020  02 ad e9 89 94 64 d2 6a  b8 d4 f0 f7 ac 83 bb f1  |.....d.j........|
-00000030  15 06 b2 db 33 db 2b 80  58 c0 90 c1 59 25 0d 08  |....3.+.X...Y%..|
+00000000  14 03 03 00 01 01 17 03  03 00 35 fc 1f b3 74 09  |..........5...t.|
+00000010  bc 38 5e 2f 83 ee 9b e0  5e 4c 92 5d a0 0f 95 42  |.8^/....^L.]...B|
+00000020  c8 3d d8 90 6c 96 cc 3b  38 81 cd 87 8d 1a e2 d6  |.=..l..;8.......|
+00000030  98 65 80 5a 99 df 16 05  15 fa 1e 81 d0 07 6f 9b  |.e.Z..........o.|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e bc 18 62  dd 27 ff a7 68 a0 a5 43  |.......b.'..h..C|
-00000010  09 6d 07 35 df 92 1d 79  0b fb 23 c6 30 0e e4 03  |.m.5...y..#.0...|
-00000020  86 22 af 17 03 03 00 13  c8 90 55 e0 65 61 c9 22  |."........U.ea."|
-00000030  60 62 5a 1a f9 bd ed 85  ab 5c e0                 |`bZ......\.|
+00000000  17 03 03 00 1e 79 c7 b9  14 9d 9f 90 8b 59 b9 00  |.....y.......Y..|
+00000010  63 e8 1e 41 06 0d 50 fc  ae 62 f9 b4 d9 21 54 f7  |c..A..P..b...!T.|
+00000020  5c f6 cb 17 03 03 00 13  6f 90 fb eb b2 95 af 2e  |\.......o.......|
+00000030  c3 d9 04 57 fa 73 1e 0f  ab a3 8f                 |...W.s.....|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-P256 b/src/crypto/tls/testdata/Server-TLSv13-P256
index 472f5a6178..e95b02af21 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-P256
+++ b/src/crypto/tls/testdata/Server-TLSv13-P256
@@ -1,101 +1,101 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 e3 01 00 00  df 03 03 0e 04 06 43 06  |..............C.|
-00000010  a4 b9 e5 86 c2 bb 7a d6  75 c4 bf 7c 8f 8a ba 87  |......z.u..|....|
-00000020  72 b9 b8 6d 55 80 ce 9c  37 24 8b 20 7e 96 80 79  |r..mU...7$. ~..y|
-00000030  4f d2 98 63 06 1a 19 2f  95 f9 12 0b 08 35 9a 8f  |O..c.../.....5..|
-00000040  f1 33 6b 25 d4 76 c8 c7  66 6a eb 79 00 04 13 03  |.3k%.v..fj.y....|
+00000000  16 03 01 00 e3 01 00 00  df 03 03 fa 4b 2f bb 43  |............K/.C|
+00000010  f9 ec c3 23 2a 43 dd 24  21 58 11 eb c6 e5 24 9d  |...#*C.$!X....$.|
+00000020  29 16 fc 2e b2 5e b0 e9  2b 90 55 20 9a 11 da bd  |)....^..+.U ....|
+00000030  8e e1 06 a0 44 86 1b dc  c4 42 91 48 58 95 1c 45  |....D....B.HX..E|
+00000040  9d 9d a9 34 ac 42 e7 b1  18 0a d9 63 00 04 13 03  |...4.B.....c....|
 00000050  00 ff 01 00 00 92 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 04 00 02 00 17 00 16  00 00 00 17 00 00 00 0d  |................|
 00000070  00 1e 00 1c 04 03 05 03  06 03 08 07 08 08 08 09  |................|
 00000080  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
 00000090  00 2b 00 03 02 03 04 00  2d 00 02 01 01 00 33 00  |.+......-.....3.|
-000000a0  47 00 45 00 17 00 41 04  36 15 75 5c 22 c8 0f 64  |G.E...A.6.u\"..d|
-000000b0  b6 cb 72 ae 3f 9b 2f bf  c5 ac 0b f3 b4 b4 ce 37  |..r.?./........7|
-000000c0  de cf d4 b3 21 8f ac bd  12 5b ea e3 0d fd 21 30  |....!....[....!0|
-000000d0  85 ea 81 c7 57 9c 9a 64  67 3f c3 89 a2 0b 90 3a  |....W..dg?.....:|
-000000e0  68 72 80 a0 09 6c f3 a9                           |hr...l..|
+000000a0  47 00 45 00 17 00 41 04  84 80 71 ef bf b7 61 e2  |G.E...A...q...a.|
+000000b0  07 b6 c6 ad fb 6c 6c e3  e4 3e c5 83 b1 58 ba 28  |.....ll..>...X.(|
+000000c0  29 a2 89 37 13 98 d6 a1  b9 12 f0 29 1c c0 cd 03  |)..7.......)....|
+000000d0  2e 50 1a d9 41 9d 61 11  0a 03 27 e3 df c6 1f b2  |.P..A.a...'.....|
+000000e0  16 d6 46 b9 b1 d5 32 cd                           |..F...2.|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 9b 02 00 00  97 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 7e 96 80 79  |........... ~..y|
-00000030  4f d2 98 63 06 1a 19 2f  95 f9 12 0b 08 35 9a 8f  |O..c.../.....5..|
-00000040  f1 33 6b 25 d4 76 c8 c7  66 6a eb 79 13 03 00 00  |.3k%.v..fj.y....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 9a 11 da bd  |........... ....|
+00000030  8e e1 06 a0 44 86 1b dc  c4 42 91 48 58 95 1c 45  |....D....B.HX..E|
+00000040  9d 9d a9 34 ac 42 e7 b1  18 0a d9 63 13 03 00 00  |...4.B.....c....|
 00000050  4f 00 2b 00 02 03 04 00  33 00 45 00 17 00 41 04  |O.+.....3.E...A.|
 00000060  1e 18 37 ef 0d 19 51 88  35 75 71 b5 e5 54 5b 12  |..7...Q.5uq..T[.|
 00000070  2e 8f 09 67 fd a7 24 20  3e b2 56 1c ce 97 28 5e  |...g..$ >.V...(^|
 00000080  f8 2b 2d 4f 9e f1 07 9f  6c 4b 5b 83 56 e2 32 42  |.+-O....lK[.V.2B|
 00000090  e9 58 b6 d7 49 a6 b5 68  1a 41 03 56 6b dc 5a 89  |.X..I..h.A.Vk.Z.|
-000000a0  14 03 03 00 01 01 17 03  03 00 17 57 c8 67 ef 2e  |...........W.g..|
-000000b0  e2 ba 53 0a 1b f6 d5 eb  d1 a7 e2 cb dd 28 ff d5  |..S..........(..|
-000000c0  f5 3f 17 03 03 02 6d b3  7f 44 fa f3 78 bf c7 98  |.?....m..D..x...|
-000000d0  e5 a0 e2 4b d5 60 98 63  7b 77 2f bd b5 8a 84 79  |...K.`.c{w/....y|
-000000e0  13 59 d1 f5 13 ea 25 6e  72 65 34 0f ff 92 a8 94  |.Y....%nre4.....|
-000000f0  cb d3 f7 b6 2a 54 87 19  94 ad f1 ab 70 4c 5d 62  |....*T......pL]b|
-00000100  41 fc f5 90 7a b5 f7 e3  0c e8 0e 1c e7 35 6b 40  |A...z........5k@|
-00000110  ca 34 f5 29 d7 da 8b c2  93 88 3d b8 26 be 09 46  |.4.)......=.&..F|
-00000120  ec 2f 8c c3 9c 83 26 83  b5 56 da c4 65 58 40 0d  |./....&..V..eX@.|
-00000130  29 d4 b4 bf 2e 0c ba d0  95 b4 b0 88 9a 13 e2 e3  |)...............|
-00000140  db d8 03 78 03 00 07 67  46 2c e5 7b b1 6e df d0  |...x...gF,.{.n..|
-00000150  f3 d9 5b db b5 31 80 86  31 83 c8 4a 1b 90 fb 4f  |..[..1..1..J...O|
-00000160  7a 7a c7 ac 20 e6 a6 f7  3c c3 da be fd 3b 37 1f  |zz.. ...<....;7.|
-00000170  17 9f 23 b5 a4 36 11 52  09 fe 8a 65 cc 27 0f 68  |..#..6.R...e.'.h|
-00000180  67 50 27 0f 56 d6 7f 14  48 39 73 c4 85 84 ab b4  |gP'.V...H9s.....|
-00000190  b4 71 b9 b8 ab e5 f8 b9  57 28 70 ca b0 f1 55 77  |.q......W(p...Uw|
-000001a0  0e 86 12 01 2a 19 45 56  46 6f 57 f4 10 90 a2 1a  |....*.EVFoW.....|
-000001b0  3c b1 4e 77 c8 0a e9 e5  27 f7 86 68 e4 1f 9a d0  |<.Nw....'..h....|
-000001c0  68 92 7d d0 b6 0b 04 cd  60 59 7e 88 ca 98 a4 c8  |h.}.....`Y~.....|
-000001d0  a0 e9 c2 d0 e3 2e 91 bb  d1 c6 b0 c4 31 6b c0 b9  |............1k..|
-000001e0  bf fc 1a 85 68 98 2e 18  75 9d c3 52 55 c9 bf d4  |....h...u..RU...|
-000001f0  c6 2d 70 3a ef 53 9e 99  33 07 4e cc a8 34 8a 42  |.-p:.S..3.N..4.B|
-00000200  75 69 fa 99 1b 32 a8 dd  6f b3 17 fb 72 7f a0 f5  |ui...2..o...r...|
-00000210  ae b8 65 06 7f 1f 31 8b  03 99 fd bd fc 5f 24 db  |..e...1......_$.|
-00000220  7c 1e b1 a0 b6 ed 85 9c  b6 07 9a 3b 34 e8 b8 dc  ||..........;4...|
-00000230  62 67 e0 17 59 4f b6 68  12 59 64 1a 63 c5 ca d7  |bg..YO.h.Yd.c...|
-00000240  54 41 e5 c2 f8 0e c7 47  0a 3d 2a 65 fd cd e2 fe  |TA.....G.=*e....|
-00000250  55 a7 e4 80 2c 75 34 95  1e 33 cd 9c 9c a7 26 55  |U...,u4..3....&U|
-00000260  3b 60 d4 4a 05 e6 84 91  86 09 a7 a0 e1 8a 3f dc  |;`.J..........?.|
-00000270  43 ec 99 bd 3b 0b 41 d2  02 61 3b cc a2 69 81 5c  |C...;.A..a;..i.\|
-00000280  6f 96 aa ea f3 80 e0 67  76 2c 5e 82 12 fd a2 80  |o......gv,^.....|
-00000290  91 f9 7e 8c b8 f5 5b b7  cb 59 0f 95 dc 20 51 b7  |..~...[..Y... Q.|
-000002a0  78 62 2e 48 5a 4a 3f 3a  e9 43 42 f9 58 dd b0 eb  |xb.HZJ?:.CB.X...|
-000002b0  99 05 10 39 66 83 96 a7  5d 22 5d 56 01 9f 18 9a  |...9f...]"]V....|
-000002c0  19 e3 b5 28 2f 58 56 dc  64 b9 7e f5 14 cb 2e 56  |...(/XV.d.~....V|
-000002d0  95 4b b0 4b ff 7a 79 f7  75 57 a9 63 b5 db 98 84  |.K.K.zy.uW.c....|
-000002e0  2b d8 b0 3b 61 89 0c 66  5d ad b7 be c6 b3 1d ee  |+..;a..f].......|
-000002f0  cf c1 1d 85 a1 ec d1 34  26 30 c1 49 68 ce 81 06  |.......4&0.Ih...|
-00000300  47 ea 2b 31 c3 35 e5 75  41 50 9d a9 46 b8 30 f9  |G.+1.5.uAP..F.0.|
-00000310  bf a9 82 e9 05 71 4a 2b  1f f3 0f f1 2a 90 92 5e  |.....qJ+....*..^|
-00000320  75 f3 1e 0f 4a 98 39 15  23 c9 c5 35 94 2b b8 ce  |u...J.9.#..5.+..|
-00000330  8f b9 5b 0c 17 03 03 00  99 76 cc ea df cb 6f 53  |..[......v....oS|
-00000340  4f 37 f9 06 6b ac 22 ec  47 b0 83 98 3c 20 f8 85  |O7..k.".G...< ..|
-00000350  85 69 de a8 67 bb 58 26  03 cc 6d f8 20 14 1e cc  |.i..g.X&..m. ...|
-00000360  85 87 8d 5b 32 8d 84 4c  4f 34 4b 5b be f6 88 18  |...[2..LO4K[....|
-00000370  3a fa 60 16 eb 39 3c f3  0d 3f 6d 79 30 75 89 d8  |:.`..9<..?my0u..|
-00000380  1a 38 e5 2a 9d 15 50 4b  8b 43 01 a1 fc 82 94 7e  |.8.*..PK.C.....~|
-00000390  1a 6f 42 9a 23 93 ec 94  0d f7 aa df 3e f9 9b 82  |.oB.#.......>...|
-000003a0  5a 7d 0d fd 6c e7 92 7f  46 55 36 f6 11 fa 03 89  |Z}..l...FU6.....|
-000003b0  8e 6c 1e 8e b7 45 4c 45  18 32 4d 31 f8 00 77 a0  |.l...ELE.2M1..w.|
-000003c0  75 2b c9 a0 e1 6d e4 ad  16 db 6b 8e de 7c f1 bf  |u+...m....k..|..|
-000003d0  21 b7 17 03 03 00 35 f0  fe ed cb 96 51 d4 0b 57  |!.....5.....Q..W|
-000003e0  39 53 dd 0e 9b 15 43 69  ad 5e f5 bb bf 00 a4 f5  |9S....Ci.^......|
-000003f0  23 9c 33 6b 30 ce 13 13  ac 43 69 c7 2b 60 e3 5a  |#.3k0....Ci.+`.Z|
-00000400  52 a8 c2 28 26 aa 48 41  3f c3 7c 46 17 03 03 00  |R..(&.HA?.|F....|
-00000410  83 3f 89 fe 65 3a 81 7e  7e 1f 23 76 8e 63 6a db  |.?..e:.~~.#v.cj.|
-00000420  ae b9 33 c6 32 f0 75 bd  de cf 97 68 b8 f2 a0 5d  |..3.2.u....h...]|
-00000430  9a 29 41 9d 4e 2f 4b 58  8e f9 8a 98 75 1c 95 67  |.)A.N/KX....u..g|
-00000440  46 4e f6 4c 6d e2 56 86  13 e5 eb 87 36 c9 52 90  |FN.Lm.V.....6.R.|
-00000450  11 e5 09 9f bb 57 4e 80  0b ef 21 7f 60 8f bd d6  |.....WN...!.`...|
-00000460  35 9b 1a cc d2 3e 32 0f  6c e5 97 4d 5f be 95 fc  |5....>2.l..M_...|
-00000470  63 a4 55 07 9d d1 ca 3b  72 03 d3 a1 3a 7c f7 39  |c.U....;r...:|.9|
-00000480  a7 87 09 6e c1 92 95 44  2a 5b 27 56 46 47 8f 4f  |...n...D*['VFG.O|
-00000490  8f b6 58 df                                       |..X.|
+000000a0  14 03 03 00 01 01 17 03  03 00 17 dc f7 b6 3b 09  |..............;.|
+000000b0  5d 57 67 80 b2 38 7b 89  e5 29 4e 5b ad 33 49 31  |]Wg..8{..)N[.3I1|
+000000c0  70 ee 17 03 03 02 6d 1b  08 51 0a 94 da 19 f7 3e  |p.....m..Q.....>|
+000000d0  aa 48 ad 4b b2 94 86 e0  9d 68 41 12 89 a0 16 af  |.H.K.....hA.....|
+000000e0  0e 65 1f 77 af 1f 45 2d  6d 69 b6 0b 00 05 f4 dd  |.e.w..E-mi......|
+000000f0  a5 41 97 cb 0e a7 f1 0c  96 04 3f 39 2a 30 de 33  |.A........?9*0.3|
+00000100  ba 01 45 1b 09 ac f2 af  3d a8 5f 75 ae f2 50 f9  |..E.....=._u..P.|
+00000110  41 ff e5 4b 81 45 a7 08  c8 ac 5d 14 22 e0 b5 18  |A..K.E....]."...|
+00000120  d4 80 9a 55 47 69 bf 02  aa 6b c2 5c 11 93 f6 20  |...UGi...k.\... |
+00000130  b0 0d a8 a0 d3 41 a1 d0  92 66 6c 54 83 1a e8 8e  |.....A...flT....|
+00000140  4c 8a 31 89 db 7c db 68  9b 19 4c 69 d9 0f c1 1b  |L.1..|.h..Li....|
+00000150  90 ef 67 83 ea 66 0b 34  20 52 4e 24 c4 3c 79 02  |..g..f.4 RN$.<y.|
+00000160  fc 31 a4 31 94 6b 2b 48  40 93 2b 20 2a 9e 27 37  |.1.1.k+H@.+ *.'7|
+00000170  0b 46 b0 d6 e8 b9 bf 14  42 2d 0f 30 2f 63 0a bc  |.F......B-.0/c..|
+00000180  98 fb 0a 72 74 bc 13 a0  8f 42 aa b5 88 cb db d1  |...rt....B......|
+00000190  07 74 b5 55 33 34 14 6a  3a 00 f6 8a ed e3 c6 5e  |.t.U34.j:......^|
+000001a0  be b1 56 a3 be bb ef fa  a8 a5 e1 99 8b 9e 5d 31  |..V...........]1|
+000001b0  d5 62 2b 68 ac a6 24 c7  d5 00 e4 4c 73 90 9e 23  |.b+h..$....Ls..#|
+000001c0  40 4a 09 79 24 af 12 cb  c2 a3 de 5b 00 f5 1a 97  |@J.y$......[....|
+000001d0  36 34 f3 e3 19 6b aa c9  15 f9 15 ca 71 3e e1 c5  |64...k......q>..|
+000001e0  44 7d f8 f6 5c ba 6e ef  10 f8 83 17 82 52 9e 30  |D}..\.n......R.0|
+000001f0  1f 8e 58 c2 55 75 f0 f6  21 4a 3f ad d4 60 2b 99  |..X.Uu..!J?..`+.|
+00000200  80 46 79 d7 6a d6 20 bf  8b 4d d1 66 f9 f1 2e e3  |.Fy.j. ..M.f....|
+00000210  54 62 c5 05 eb 7d 01 cf  df dd f2 a5 f9 c1 83 05  |Tb...}..........|
+00000220  38 da 08 a3 d7 33 41 15  b6 73 f5 b4 d9 75 35 4c  |8....3A..s...u5L|
+00000230  ba e0 80 aa 97 16 66 68  2b 56 99 86 21 23 5b 80  |......fh+V..!#[.|
+00000240  4e 42 d9 b4 5c 5c 1e c4  f3 c2 52 d3 03 af 90 ce  |NB..\\....R.....|
+00000250  16 27 31 d2 a4 f1 63 ed  1b 57 af ed 7a dd 94 1e  |.'1...c..W..z...|
+00000260  e0 c6 93 0d fb 5b ce 38  32 49 97 27 11 39 da 79  |.....[.82I.'.9.y|
+00000270  9a 00 31 6d ed 25 fb 80  6d a4 86 6b 01 cd ed 72  |..1m.%..m..k...r|
+00000280  96 e3 76 50 46 c9 ec 60  23 84 30 c7 1b 2e 46 d7  |..vPF..`#.0...F.|
+00000290  26 8b 69 de c9 a0 15 31  1e d2 43 fd 9c 6c 7a c2  |&.i....1..C..lz.|
+000002a0  5b d8 cd b7 5a 5a a9 5d  62 50 c0 ac 2d 29 eb 6e  |[...ZZ.]bP..-).n|
+000002b0  d6 75 e7 fc 5d 24 e9 16  4d 77 8f 00 66 d9 30 7d  |.u..]$..Mw..f.0}|
+000002c0  4c f8 f7 72 0b 4f 76 db  f1 1c 03 f2 dd 5d 7b db  |L..r.Ov......]{.|
+000002d0  c0 1a ae 74 e0 8b 6c 4a  b9 19 38 45 44 86 ba f4  |...t..lJ..8ED...|
+000002e0  b4 04 b9 7d 85 43 8d 0a  09 3c 2e 35 d2 a4 8b 9f  |...}.C...<.5....|
+000002f0  c4 bb 2f 9b a9 42 1c 11  09 f3 a5 1e 89 e4 3f 55  |../..B........?U|
+00000300  ca f6 30 1a 40 22 8d fb  a3 d7 b4 bb cb 27 d4 b1  |..0.@".......'..|
+00000310  ab b5 23 9f f1 8e e1 d7  27 42 2a 8a cb 5c 0c 06  |..#.....'B*..\..|
+00000320  33 86 fa a7 1b f6 f8 87  2e 79 9c cf 0a 9e 92 c3  |3........y......|
+00000330  70 07 c4 4e 17 03 03 00  99 50 ad f7 c1 1d 6f 8a  |p..N.....P....o.|
+00000340  f0 1f 97 38 b5 2f 75 65  26 23 2f 63 b6 99 f4 a7  |...8./ue&#/c....|
+00000350  87 33 df 87 5e 8e aa 8d  bd a1 b4 f8 45 3a f4 20  |.3..^.......E:. |
+00000360  06 74 1f 1b 6b e8 51 ff  32 f8 62 d7 18 ab 03 62  |.t..k.Q.2.b....b|
+00000370  5a 16 09 31 c7 9c be 98  b2 51 6f c7 ee ff df 19  |Z..1.....Qo.....|
+00000380  41 9c 08 9a c9 27 82 0c  7e ce a3 47 b0 ae c1 5a  |A....'..~..G...Z|
+00000390  bf c1 c4 d4 ba 63 8e f8  fe 17 0f 29 c5 f8 5c aa  |.....c.....)..\.|
+000003a0  42 69 69 90 86 57 a4 64  63 02 a2 bd 7c f8 f6 99  |Bii..W.dc...|...|
+000003b0  fe 9d 36 8a e2 b3 32 f2  d9 60 45 87 95 ea 0a 28  |..6...2..`E....(|
+000003c0  c9 dc ff 12 da 7e 8b 14  82 af b4 21 4c 55 cf c9  |.....~.....!LU..|
+000003d0  f5 fc 17 03 03 00 35 cf  73 5b ca b9 a0 33 87 18  |......5.s[...3..|
+000003e0  0d 2a 44 c5 b2 6e 6e f0  60 42 35 ba a1 fb 50 5e  |.*D..nn.`B5...P^|
+000003f0  34 78 9a 04 0c d6 3d 56  28 c5 4c c7 f6 cd 30 24  |4x....=V(.L...0$|
+00000400  06 1a c7 8e cd b7 af e8  06 a9 d5 07 17 03 03 00  |................|
+00000410  83 83 3b b0 a6 c4 2d a2  53 e1 64 3b 98 29 24 0d  |..;...-.S.d;.)$.|
+00000420  e5 15 9f da 7a 7b 58 b6  b1 de d9 42 8c eb 1c 80  |....z{X....B....|
+00000430  44 fe c8 8a b4 87 63 bf  dc 0e 6a 38 b5 39 6c 77  |D.....c...j8.9lw|
+00000440  1a 9c 4e b1 40 d6 d0 2b  eb 8d 67 32 2e 1a 9e 97  |..N.@..+..g2....|
+00000450  df 0a 39 54 09 de 1d 37  54 d6 14 12 60 71 52 2f  |..9T...7T...`qR/|
+00000460  6c 81 e8 ba 0e c8 c7 a5  54 3a 7e 86 d6 02 83 9a  |l.......T:~.....|
+00000470  49 cf 7f b1 bb 8e bf bb  78 87 a1 31 24 d6 52 17  |I.......x..1$.R.|
+00000480  a0 3d 1b f0 84 ea ad 80  ff 37 2b b1 e6 97 43 2f  |.=.......7+...C/|
+00000490  9a 9c 5b ac                                       |..[.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 7e b9 91 2d d5  |..........5~..-.|
-00000010  aa 2a 8b c0 47 8f d0 2d  8b 5c cf 8b 8a 47 ab fe  |.*..G..-.\...G..|
-00000020  c3 76 22 5d 14 ef 05 22  4f bf 60 7a 1d 82 72 b3  |.v"]..."O.`z..r.|
-00000030  d7 73 9f b2 f4 da 2b 56  64 08 6d 55 37 ed 6d 2e  |.s....+Vd.mU7.m.|
+00000000  14 03 03 00 01 01 17 03  03 00 35 88 31 cb 88 94  |..........5.1...|
+00000010  3c 3e 29 cb b9 55 cc 4c  8b 1a ab 43 71 77 87 76  |<>)..U.L...Cqw.v|
+00000020  05 55 3a 9d cb ae f4 58  41 65 5b ce 08 a4 71 b7  |.U:....XAe[...q.|
+00000030  4b b8 3d 1a a3 3b 29 56  06 1a 3b f9 af 49 21 37  |K.=..;)V..;..I!7|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 7e 9c 6d  68 2d f5 37 73 08 06 67  |.....~.mh-.7s..g|
-00000010  db 10 7b 41 fc 86 7f b0  75 f4 d9 0c 1b 4a 3d ca  |..{A....u....J=.|
-00000020  d5 e2 30 17 03 03 00 13  f3 a0 0e bd 16 07 10 dc  |..0.............|
-00000030  91 be 0e b4 07 a3 df d3  f4 21 26                 |.........!&|
+00000000  17 03 03 00 1e 1b ba fb  1c c3 4c d1 be 7a a0 bc  |..........L..z..|
+00000010  fc 07 aa 59 3f cc 35 c5  47 b9 d8 20 a8 46 2b 4e  |...Y?.5.G.. .F+N|
+00000020  5b f0 e5 17 03 03 00 13  1e d8 8e d4 e0 62 62 34  |[............bb4|
+00000030  99 c4 e1 86 66 ca 85 65  db cf 07                 |....f..e...|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-RSA-RSAPSS b/src/crypto/tls/testdata/Server-TLSv13-RSA-RSAPSS
index 9bd0482de1..9113b8c1aa 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-RSA-RSAPSS
+++ b/src/crypto/tls/testdata/Server-TLSv13-RSA-RSAPSS
@@ -1,96 +1,96 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 b2 01 00 00  ae 03 03 5e 26 a7 5d 55  |...........^&.]U|
-00000010  3f f7 12 49 ea 19 a6 36  80 a4 5e 48 ce 93 ba 19  |?..I...6..^H....|
-00000020  1d 09 aa 53 1c 3d 2c ca  2b e8 b4 20 a9 49 a3 4f  |...S.=,.+.. .I.O|
-00000030  e8 65 1a e6 44 49 4d ed  5d 60 53 0e 7c 11 01 19  |.e..DIM.]`S.|...|
-00000040  62 ef 47 10 13 b0 1a 02  2e 26 d6 03 00 04 13 03  |b.G......&......|
+00000000  16 03 01 00 b2 01 00 00  ae 03 03 82 31 d0 17 dc  |............1...|
+00000010  4b b5 ac 55 fb 74 1c 50  14 86 28 69 6d 3a 09 93  |K..U.t.P..(im:..|
+00000020  b2 45 d6 37 24 ac 69 3e  81 e9 8f 20 5b 25 c5 02  |.E.7$.i>... [%..|
+00000030  22 0c 9f de 36 bb 29 28  94 69 ac 49 bb 25 c4 fc  |"...6.)(.i.I.%..|
+00000040  f9 9a e0 b6 24 7f 4f cb  6b 5a 29 33 00 04 13 03  |....$.O.kZ)3....|
 00000050  00 ff 01 00 00 61 00 0b  00 04 03 00 01 02 00 0a  |.....a..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 06 00 04 08 06 08 04  |................|
 00000080  00 2b 00 03 02 03 04 00  2d 00 02 01 01 00 33 00  |.+......-.....3.|
-00000090  26 00 24 00 1d 00 20 ff  7f 2b 87 7b 2c df 44 26  |&.$... ..+.{,.D&|
-000000a0  04 b0 2a a4 b2 17 c1 d2  36 50 95 a7 b4 9d 2e c3  |..*.....6P......|
-000000b0  e8 6d f7 40 77 6a 6a                              |.m.@wjj|
+00000090  26 00 24 00 1d 00 20 c5  6e e9 38 ba 08 63 3c 8d  |&.$... .n.8..c<.|
+000000a0  9b 66 e2 d0 8a 5c 6e 37  1f d2 4f eb 27 bb 2c d8  |.f...\n7..O.'.,.|
+000000b0  c8 fe 35 af a4 b3 00                              |..5....|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 a9 49 a3 4f  |........... .I.O|
-00000030  e8 65 1a e6 44 49 4d ed  5d 60 53 0e 7c 11 01 19  |.e..DIM.]`S.|...|
-00000040  62 ef 47 10 13 b0 1a 02  2e 26 d6 03 13 03 00 00  |b.G......&......|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 5b 25 c5 02  |........... [%..|
+00000030  22 0c 9f de 36 bb 29 28  94 69 ac 49 bb 25 c4 fc  |"...6.)(.i.I.%..|
+00000040  f9 9a e0 b6 24 7f 4f cb  6b 5a 29 33 13 03 00 00  |....$.O.kZ)3....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 5c ad 71 71 c7 04  |..........\.qq..|
-00000090  a3 a0 cb 1e 20 0f 17 74  63 9a d3 09 fc bd 3e 4b  |.... ..tc.....>K|
-000000a0  ca 17 03 03 02 6d ef 2f  4d 74 69 dd 6f df 52 16  |.....m./Mti.o.R.|
-000000b0  21 ec ef 74 66 2c 4d 38  08 8d 69 c6 a8 92 12 2a  |!..tf,M8..i....*|
-000000c0  3c ac 75 bc 97 0b d6 34  9c 41 ec 9a 4a 9c 27 e2  |<.u....4.A..J.'.|
-000000d0  78 ff cd 11 f2 62 ec a9  1c 6f d4 c4 38 94 8a 6b  |x....b...o..8..k|
-000000e0  42 c0 d4 16 2d 9b 57 2d  83 5f 13 39 02 b6 27 ed  |B...-.W-._.9..'.|
-000000f0  12 38 04 ca b5 1c 72 8d  cc 88 27 68 d6 ea 84 07  |.8....r...'h....|
-00000100  5d de 4a c3 52 07 ca c5  6a ef b4 70 4e eb b6 8c  |].J.R...j..pN...|
-00000110  d6 46 7f f9 76 11 30 17  20 02 07 16 a2 5b 77 ad  |.F..v.0. ....[w.|
-00000120  a5 d5 73 a2 41 b5 1d c5  fa a8 4e b7 b8 36 b8 cc  |..s.A.....N..6..|
-00000130  48 a6 84 36 64 49 41 fa  07 ee 32 4a 21 d9 ef a2  |H..6dIA...2J!...|
-00000140  c9 34 33 ae 76 2a c8 ac  45 fc 4d 3b e2 4a 2e 8e  |.43.v*..E.M;.J..|
-00000150  16 10 20 05 80 35 c0 30  c7 4c 5f 34 ba f7 9d ef  |.. ..5.0.L_4....|
-00000160  0c 8e bf 57 67 89 44 ba  a8 3e 94 17 09 0f b3 41  |...Wg.D..>.....A|
-00000170  54 c8 17 06 a4 4f 13 50  bb 45 7d db 73 3d 0e 63  |T....O.P.E}.s=.c|
-00000180  5c 5f 3f 9d c9 07 75 c0  10 cf 45 25 5a f7 4c f7  |\_?...u...E%Z.L.|
-00000190  66 5a 62 fc 4c fd b0 54  f3 b9 d5 00 ba e3 d8 2a  |fZb.L..T.......*|
-000001a0  70 00 9c 67 93 64 5b 45  9a b9 bc 6d c5 45 af fe  |p..g.d[E...m.E..|
-000001b0  4f 99 fa 7f 07 0b 79 93  bf 6b 95 a9 c5 b3 ca 6e  |O.....y..k.....n|
-000001c0  f6 88 37 7c 24 c1 0d 40  e3 be 07 7f a2 37 67 51  |..7|$..@.....7gQ|
-000001d0  6e b0 ab 2e 33 9d 24 45  66 9e bb c7 90 70 17 1a  |n...3.$Ef....p..|
-000001e0  f6 e3 8d d7 68 47 83 d7  83 b4 e0 67 25 c1 e3 c8  |....hG.....g%...|
-000001f0  55 ec 21 08 cc 2e 42 7e  02 30 77 5c 2b 82 f9 3e  |U.!...B~.0w\+..>|
-00000200  b6 ce 71 ba f6 d4 67 0f  79 9f 8b e4 b9 21 94 33  |..q...g.y....!.3|
-00000210  b7 68 e4 2a 48 d0 65 cf  f2 e0 3e 99 91 29 d7 87  |.h.*H.e...>..)..|
-00000220  1a 03 e2 69 50 2b cb 10  84 14 11 2a f8 e5 79 eb  |...iP+.....*..y.|
-00000230  97 97 ec af 48 73 bd c9  cf ec d4 b3 8a 93 30 b9  |....Hs........0.|
-00000240  e5 6c e9 72 e9 d7 20 85  9d 1a aa 24 64 e1 79 70  |.l.r.. ....$d.yp|
-00000250  f3 61 5d 04 f0 bc 36 b3  a1 6a 9f 94 60 5c 3f af  |.a]...6..j..`\?.|
-00000260  d6 5e f6 db 93 10 d4 56  bf 2e 3e 73 3a cd af 8d  |.^.....V..>s:...|
-00000270  fc 5e b0 d4 7c fc 21 2d  d5 fe 8d b5 8a f0 82 5d  |.^..|.!-.......]|
-00000280  5c 13 43 9b a2 83 d0 d4  09 3d 8a 06 4a 58 22 c2  |\.C......=..JX".|
-00000290  82 b5 d2 b7 72 86 4c 62  58 fb d4 58 99 2b 98 c8  |....r.LbX..X.+..|
-000002a0  1f 84 4c 16 16 08 3b cd  f3 bb 63 20 f5 31 52 01  |..L...;...c .1R.|
-000002b0  b7 06 27 6f 2c 51 d2 5a  3d be db 40 c1 db 90 35  |..'o,Q.Z=..@...5|
-000002c0  fe 67 f0 48 d1 3d e8 9f  d3 c5 e2 3c 3b f9 d5 9e  |.g.H.=.....<;...|
-000002d0  c2 f5 5e 69 15 48 b2 eb  06 97 43 e3 ea 5e 2c 26  |..^i.H....C..^,&|
-000002e0  18 d9 3c a1 7f fd ba a8  51 88 46 3d 51 0b aa c8  |..<.....Q.F=Q...|
-000002f0  72 ab ce f6 00 81 1e 88  fb 6e 91 0f b8 fe 05 80  |r........n......|
-00000300  4a fe 6f 24 d4 16 35 bf  ed ab 40 77 e9 78 7e 6e  |J.o$..5...@w.x~n|
-00000310  f0 b7 b9 17 03 03 00 99  8a 60 02 4a 1a b7 2e c9  |.........`.J....|
-00000320  dd ed b4 78 a0 8a 86 3d  d4 1d 89 00 fa 7b 08 d3  |...x...=.....{..|
-00000330  ec d1 6b fe 07 15 6e db  a3 81 19 b2 7c 64 29 bb  |..k...n.....|d).|
-00000340  04 46 f6 1b b7 12 05 bb  fa 4a 0e 92 5c b7 4f 70  |.F.......J..\.Op|
-00000350  e2 5d 08 35 20 62 e8 16  b1 f8 be eb 10 8d 1e 57  |.].5 b.........W|
-00000360  b4 60 c8 3d 2b a0 b5 86  09 76 15 eb 76 77 31 40  |.`.=+....v..vw1@|
-00000370  45 18 6b ca 90 8b ff 25  95 86 3d 7b 93 2b a8 ea  |E.k....%..={.+..|
-00000380  8c 3f 6d b9 c4 ab 58 d6  66 7b 08 22 7a 26 6a 41  |.?m...X.f{."z&jA|
-00000390  e1 54 96 e1 db 68 a0 e4  7c 2d ce 10 c3 92 53 bf  |.T...h..|-....S.|
-000003a0  84 b8 3b d6 e2 6b a0 37  b7 bf af 7e a6 82 d2 90  |..;..k.7...~....|
-000003b0  5e 17 03 03 00 35 51 f5  7a 0c ba 36 36 36 b5 8f  |^....5Q.z..666..|
-000003c0  98 20 0a fa cd 0b 5a b6  0f cd 8f 67 c9 82 2a 03  |. ....Z....g..*.|
-000003d0  8c c0 74 29 43 d9 58 a7  b8 13 2d 75 9c 7c 14 bb  |..t)C.X...-u.|..|
-000003e0  f0 6a bc a2 16 1b 82 d9  0e f5 a5 17 03 03 00 83  |.j..............|
-000003f0  91 83 67 26 71 a5 98 49  79 0a bb 1d a2 e6 0e b1  |..g&q..Iy.......|
-00000400  30 2b c4 6e 97 a9 93 74  97 85 51 65 67 43 f0 04  |0+.n...t..QegC..|
-00000410  6f cc b1 9c 02 ff 4b 52  ce 36 07 bb 42 b9 e6 4b  |o.....KR.6..B..K|
-00000420  75 3a 79 bd 3c 50 7d 86  d2 13 ff fe a4 7b e4 6b  |u:y.<P}......{.k|
-00000430  09 6a a7 08 d1 43 0c 2e  96 a9 28 46 43 27 8c f9  |.j...C....(FC'..|
-00000440  1d 4d 96 48 51 0a 86 8f  bd 03 49 46 9f 35 1b a7  |.M.HQ.....IF.5..|
-00000450  01 17 46 5e 66 32 80 c0  7d ec 62 9c 91 6f 74 ef  |..F^f2..}.b..ot.|
-00000460  fa 14 b8 50 15 dc 97 0c  d9 dd be 48 ce 51 bc 5c  |...P.......H.Q.\|
-00000470  3b 62 4b                                          |;bK|
+00000080  03 03 00 01 01 17 03 03  00 17 31 3c 93 e7 ba d2  |..........1<....|
+00000090  e7 22 31 a8 58 b9 e4 3b  71 96 84 05 79 f2 5f 59  |."1.X..;q...y._Y|
+000000a0  af 17 03 03 02 6d e4 0d  6d bb 55 27 75 d6 32 b4  |.....m..m.U'u.2.|
+000000b0  90 28 ce 49 a7 2c da e2  a3 50 0e 3a 32 b1 9c 83  |.(.I.,...P.:2...|
+000000c0  10 3a c2 a7 df 61 e9 96  26 87 66 ea 3f 05 b6 80  |.:...a..&.f.?...|
+000000d0  46 bf 02 84 a7 7c 24 ed  03 4f e3 9a 85 40 b9 0f  |F....|$..O...@..|
+000000e0  5d db 78 9c 73 cf d9 e8  75 12 21 32 1e 0d 25 ca  |].x.s...u.!2..%.|
+000000f0  c0 12 08 17 86 30 c3 8d  6a 8b 3d 39 5a aa 8f ff  |.....0..j.=9Z...|
+00000100  05 90 36 ea a1 1b e5 b8  f7 2b b5 d4 b8 e9 57 2b  |..6......+....W+|
+00000110  b2 ea 4b 3e 42 f9 3c 79  17 5f 4b 16 81 c8 83 4d  |..K>B.<y._K....M|
+00000120  cd 01 c4 8d 6c 96 46 d6  f1 0b 55 78 d1 ab a2 39  |....l.F...Ux...9|
+00000130  ce d9 43 71 07 0d 2e 0e  69 12 dc 93 c6 f6 2a c3  |..Cq....i.....*.|
+00000140  d1 73 f2 c4 3c 09 47 a5  b1 ef df a2 d1 4d cc c3  |.s..<.G......M..|
+00000150  a8 8c 20 05 49 a0 5e 88  56 52 20 43 73 a9 a6 38  |.. .I.^.VR Cs..8|
+00000160  6c 9f 2a 8f 6c 20 24 9d  f6 e4 f5 c7 05 38 ab d0  |l.*.l $......8..|
+00000170  0a eb 6b 1d 4e 52 a7 cd  3a c6 97 e1 a3 42 e1 8a  |..k.NR..:....B..|
+00000180  32 1e 7d e0 58 10 59 86  9c a2 08 d8 e1 41 63 81  |2.}.X.Y......Ac.|
+00000190  40 c4 15 db 28 68 65 03  2e 77 52 b2 c9 69 c6 44  |@...(he..wR..i.D|
+000001a0  c9 03 e7 78 24 ba 34 c4  b8 d5 26 09 e6 be 52 49  |...x$.4...&...RI|
+000001b0  9f 39 30 2e dd 94 19 b5  79 33 05 3f 25 b2 c9 4f  |.90.....y3.?%..O|
+000001c0  16 90 2a 75 40 5c 68 be  73 75 cb f8 42 a4 6c 92  |..*u@\h.su..B.l.|
+000001d0  6d 9f 02 bf 2b 89 7c 96  6f e7 c2 dc 66 7e 5c 92  |m...+.|.o...f~\.|
+000001e0  e3 06 b8 2a 26 75 20 13  2a e8 cd 58 46 ba 22 6a  |...*&u .*..XF."j|
+000001f0  07 c6 71 c0 87 d1 0d ef  5c 46 cc 2f 30 b4 73 f9  |..q.....\F./0.s.|
+00000200  3b 3f 79 5e ec be 60 13  d2 0b 52 d8 c1 7b 27 21  |;?y^..`...R..{'!|
+00000210  4c 28 ef a0 0a 8c 22 fd  bd 3a 3e 16 8c 16 a8 4d  |L(...."..:>....M|
+00000220  92 ac 19 8c 2e 47 fe 83  8e 43 64 73 d2 c8 0f 92  |.....G...Cds....|
+00000230  b7 0f ac 0a 7a 60 43 48  bc d8 06 e7 c9 19 4f e5  |....z`CH......O.|
+00000240  b2 be 2e 68 5d 8d c8 72  25 0c 38 d0 37 23 87 fb  |...h]..r%.8.7#..|
+00000250  f5 cb 7e fd fa a2 17 51  0d 17 7c 46 1a 01 33 05  |..~....Q..|F..3.|
+00000260  28 0e 49 6b 3c ec c6 6f  52 de 3f b8 93 24 d2 2a  |(.Ik<..oR.?..$.*|
+00000270  1d 54 ca 94 b8 8a 14 f7  0d 88 56 1f fb 3d d9 1a  |.T........V..=..|
+00000280  37 bb 40 2f 02 f9 84 27  19 b4 87 60 d6 5b 42 3a  |7.@/...'...`.[B:|
+00000290  e2 33 1b d9 f8 d6 ad bf  4d f6 a7 9e ad 9a 2e 7f  |.3......M.......|
+000002a0  72 67 04 56 bf 0e 69 12  f0 c7 a8 a7 3c e2 0c 99  |rg.V..i.....<...|
+000002b0  fd 55 3c ea 87 cd 06 f3  32 97 86 83 9e 21 23 78  |.U<.....2....!#x|
+000002c0  6e 95 e1 5c f0 15 12 ff  39 c1 8a 74 51 b3 17 2d  |n..\....9..tQ..-|
+000002d0  3a bc 2a 67 fa 41 d6 5a  67 10 51 48 e0 ea 9a 3a  |:.*g.A.Zg.QH...:|
+000002e0  24 38 d4 1d 67 e2 b9 65  25 e3 66 f1 30 79 04 f8  |$8..g..e%.f.0y..|
+000002f0  6e 28 aa 10 07 1b 41 41  72 76 e1 3a 00 d4 34 46  |n(....AArv.:..4F|
+00000300  66 34 24 db 88 9f 07 f0  2e 24 c5 33 0f b3 a4 5c  |f4$......$.3...\|
+00000310  3d 15 99 17 03 03 00 99  38 d8 f3 50 1b c5 be ed  |=.......8..P....|
+00000320  51 61 b7 90 72 64 f4 32  61 75 fa 81 b6 de be f2  |Qa..rd.2au......|
+00000330  e6 15 d6 ae 31 6d 5a 29  76 51 f5 92 8a 7f 2d 8b  |....1mZ)vQ....-.|
+00000340  ee f7 4a e4 94 20 64 b2  17 ee 91 61 48 59 22 82  |..J.. d....aHY".|
+00000350  92 e5 68 cd 1a 1c 44 34  42 79 75 1a 36 cd 30 59  |..h...D4Byu.6.0Y|
+00000360  58 11 f6 6e 6a e1 f7 a3  86 4b 49 16 e6 9d 08 87  |X..nj....KI.....|
+00000370  15 b2 fd ba a3 47 82 f9  17 95 60 43 e9 28 86 1d  |.....G....`C.(..|
+00000380  52 50 ed 6e f5 1c 96 17  d0 63 9d 66 ed 30 ee d1  |RP.n.....c.f.0..|
+00000390  8f af 07 c2 12 da 69 c4  59 79 a9 3c d4 8d 7d 2d  |......i.Yy.<..}-|
+000003a0  2e 3d dc a9 98 16 a3 27  e7 81 08 b9 23 fc a9 11  |.=.....'....#...|
+000003b0  0c 17 03 03 00 35 8e 16  1e b7 f6 62 4f ce 0e 41  |.....5.....bO..A|
+000003c0  fd 42 58 91 c4 c3 e0 24  10 8f 0d 52 f9 39 7e f4  |.BX....$...R.9~.|
+000003d0  a9 5a 7d 13 5e 8a 5b d8  a0 26 c5 61 47 83 73 e2  |.Z}.^.[..&.aG.s.|
+000003e0  89 6f 2b 0a bf 2d 18 66  cd f8 7e 17 03 03 00 83  |.o+..-.f..~.....|
+000003f0  cf 2a eb 5e 6a d7 b0 89  d6 b3 3d 57 08 79 98 a8  |.*.^j.....=W.y..|
+00000400  7c ed 5f 63 9e 58 76 7c  1a 86 40 43 aa f5 b8 d5  ||._c.Xv|..@C....|
+00000410  86 e9 49 4e c2 32 2d 99  57 f7 53 ad 15 2e df 87  |..IN.2-.W.S.....|
+00000420  42 6e 48 69 5b 5d c7 d0  a7 4c 8d 90 eb 25 83 ad  |BnHi[]...L...%..|
+00000430  eb d1 f9 54 56 0a 96 95  0e 53 f1 59 26 59 56 44  |...TV....S.Y&YVD|
+00000440  46 1e a7 89 79 5b 66 87  70 c3 02 e2 83 d4 ca f0  |F...y[f.p.......|
+00000450  d7 88 2e 2a d0 11 b4 c7  ed 14 a5 ae 26 d9 16 b5  |...*........&...|
+00000460  4d 30 6f 9d 6f c9 fd bd  1a 74 2c b0 7b 07 5d d8  |M0o.o....t,.{.].|
+00000470  6f e8 e3                                          |o..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 5c 22 e9 04 21  |..........5\"..!|
-00000010  29 23 9d 73 16 c1 f5 a6  40 bb 1b ee 0e ae 09 5b  |)#.s....@......[|
-00000020  01 f6 3d cb 5b c8 d3 76  2b 0c f7 6c 29 dc 86 e1  |..=.[..v+..l)...|
-00000030  96 f0 75 30 34 1f e3 07  7f 96 70 a7 3c b3 cd 2b  |..u04.....p.<..+|
+00000000  14 03 03 00 01 01 17 03  03 00 35 ee 17 2c 89 80  |..........5..,..|
+00000010  ef bd 5e 38 eb db ee 89  cc e4 84 4f d8 35 48 df  |..^8.......O.5H.|
+00000020  85 84 a0 00 63 a7 91 25  1e e1 96 df 38 ad 6b 94  |....c..%....8.k.|
+00000030  52 99 74 d8 59 be 37 63  09 f5 bc bd 9f ed 43 53  |R.t.Y.7c......CS|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 6c f1 ac  2c 31 8d cb 72 9d 00 88  |.....l..,1..r...|
-00000010  6b 54 23 07 a4 83 07 fa  68 12 fe 70 55 fc 86 a9  |kT#.....h..pU...|
-00000020  8d e1 65 17 03 03 00 13  93 b2 83 3b 16 dc 3a 38  |..e........;..:8|
-00000030  40 bf 6b 8e 17 d6 17 2b  eb 9c f5                 |@.k....+...|
+00000000  17 03 03 00 1e 7b b8 5c  e3 e5 f3 b9 93 3f d1 be  |.....{.\.....?..|
+00000010  15 98 6e 58 f7 1e 95 e1  fd a2 4c 63 20 e1 a0 f4  |..nX......Lc ...|
+00000020  c4 29 55 17 03 03 00 13  e2 08 45 d5 8b 21 44 53  |.)U.......E..!DS|
+00000030  cc b3 ca 4e 9a c8 1a 1e  b3 22 58                 |...N....."X|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-Resume b/src/crypto/tls/testdata/Server-TLSv13-Resume
index f09aecba80..bf8354df9b 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-Resume
+++ b/src/crypto/tls/testdata/Server-TLSv13-Resume
@@ -1,58 +1,58 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 5e 01 00 01  5a 03 03 4a d8 ce b7 81  |....^...Z..J....|
-00000010  81 08 19 ae 15 cd a3 a1  69 cf 91 35 f3 b0 77 91  |........i..5..w.|
-00000020  4c 59 7a 91 52 8b 0e 5a  e8 4c bf 20 58 4d cf b1  |LYz.R..Z.L. XM..|
-00000030  9e 71 1d 9e 95 27 83 18  b1 29 13 3b 33 79 c4 3d  |.q...'...).;3y.=|
-00000040  6c 96 a4 d5 db f3 08 5c  6d f7 fe 28 00 04 13 01  |l......\m..(....|
+00000000  16 03 01 01 5e 01 00 01  5a 03 03 8d 15 59 8a 80  |....^...Z....Y..|
+00000010  71 06 6e b2 2d 17 8b 12  09 20 45 a7 b4 6b d5 9c  |q.n.-.... E..k..|
+00000020  79 b2 3d b2 85 b4 be ea  b4 13 79 20 65 0a d6 64  |y.=.......y e..d|
+00000030  4b 60 e0 a2 8a b3 fc 87  9a 32 02 ba f9 19 e4 63  |K`.......2.....c|
+00000040  39 35 58 a4 6e 1d 3d 27  78 bb 97 94 00 04 13 01  |95X.n.='x.......|
 00000050  00 ff 01 00 01 0d 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 16 00 00 00 17  00 00 00 0d 00 1e 00 1c  |................|
 00000080  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000090  08 04 08 05 08 06 04 01  05 01 06 01 00 2b 00 03  |.............+..|
 000000a0  02 03 04 00 2d 00 02 01  01 00 33 00 26 00 24 00  |....-.....3.&.$.|
-000000b0  1d 00 20 b9 4b 27 a1 8c  14 d5 53 0c 0d e4 d5 3f  |.. .K'....S....?|
-000000c0  96 d6 fd a2 06 69 57 0f  eb c1 f9 fc 7a 36 04 ce  |.....iW.....z6..|
-000000d0  f3 7e 29 00 29 00 8c 00  67 00 61 00 00 00 00 00  |.~).)...g.a.....|
-000000e0  00 00 00 00 00 00 00 00  00 00 00 94 68 2c a3 82  |............h,..|
-000000f0  51 ed 14 ef 68 ca 42 c5  5c 0e f0 13 2b 49 4b af  |Q...h.B.\...+IK.|
-00000100  0a 68 2a 6d 66 17 44 4e  21 1f 93 74 1c 94 2e 64  |.h*mf.DN!..t...d|
-00000110  97 80 eb 5a e9 00 26 db  dd 99 76 3c c3 a2 8a 88  |...Z..&...v<....|
-00000120  24 10 e6 07 1a b5 9e 15  04 26 83 13 ba 92 76 3e  |$........&....v>|
-00000130  ef ea 7b 42 ee 47 e8 7a  f6 0e 61 db 00 00 00 00  |..{B.G.z..a.....|
-00000140  00 21 20 a3 43 af 6e e8  fc 95 e0 85 23 4d d7 b5  |.! .C.n.....#M..|
-00000150  9f 90 ba f8 73 28 a4 bf  9f b4 23 f2 cb 80 d0 c3  |....s(....#.....|
-00000160  2a 92 a0                                          |*..|
+000000b0  1d 00 20 1f 5a 2c 5d 56  57 04 a4 b7 a6 c5 bc b8  |.. .Z,]VW.......|
+000000c0  c1 ab 7e 74 e9 b2 b7 0c  1d db b2 94 e5 5f 24 f4  |..~t........._$.|
+000000d0  cb 30 4a 00 29 00 8c 00  67 00 61 00 00 00 00 00  |.0J.)...g.a.....|
+000000e0  00 00 00 00 00 00 00 00  00 00 00 94 68 2d a3 82  |............h-..|
+000000f0  51 ed 14 ef 68 ca 42 c5  5c c3 a1 dd 20 28 ae a0  |Q...h.B.\... (..|
+00000100  82 eb d0 3f 35 60 a5 97  b5 44 f8 c0 61 48 23 48  |...?5`...D..aH#H|
+00000110  5a b2 bc 89 14 80 12 aa  b5 99 76 3c 4c fd 0d aa  |Z.........v<L...|
+00000120  76 13 14 dd 88 c7 8e 09  4b 4e b9 4f 88 a4 24 19  |v.......KN.O..$.|
+00000130  9c 24 c1 ba a2 9b aa e1  fa b6 19 81 00 00 00 00  |.$..............|
+00000140  00 21 20 8f a4 7e f9 27  0b d7 0e 2d 1b 61 7e 2f  |.! ..~.'...-.a~/|
+00000150  2a 86 0a 98 22 7a 8a b8  81 1c 3f 0c 62 48 12 a5  |*..."z....?.bH..|
+00000160  13 ad 7d                                          |..}|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 80 02 00 00  7c 03 03 00 00 00 00 00  |........|.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 58 4d cf b1  |........... XM..|
-00000030  9e 71 1d 9e 95 27 83 18  b1 29 13 3b 33 79 c4 3d  |.q...'...).;3y.=|
-00000040  6c 96 a4 d5 db f3 08 5c  6d f7 fe 28 13 01 00 00  |l......\m..(....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 65 0a d6 64  |........... e..d|
+00000030  4b 60 e0 a2 8a b3 fc 87  9a 32 02 ba f9 19 e4 63  |K`.......2.....c|
+00000040  39 35 58 a4 6e 1d 3d 27  78 bb 97 94 13 01 00 00  |95X.n.='x.......|
 00000050  34 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |4.+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 00  |.........._X.;t.|
 00000080  29 00 02 00 00 14 03 03  00 01 01 17 03 03 00 17  |)...............|
-00000090  15 eb 8b 3b 3b 11 c3 29  34 e6 de 27 08 a2 7f 1e  |...;;..)4..'....|
-000000a0  10 ce 18 67 06 de f0 17  03 03 00 35 b4 48 82 07  |...g.......5.H..|
-000000b0  73 9e 31 b4 c1 a1 c6 f0  30 71 2f 68 42 ff e8 71  |s.1.....0q/hB..q|
-000000c0  6c b8 49 c5 c7 7f e3 8a  4c 22 46 cc 4d b1 a5 db  |l.I.....L"F.M...|
-000000d0  0f 8a 98 b2 d0 fc 1f e2  a6 5e fc 53 fe 26 aa 45  |.........^.S.&.E|
-000000e0  a8 17 03 03 00 83 c6 ab  4b b5 81 7e f7 45 02 a5  |........K..~.E..|
-000000f0  01 73 df ff f6 5f 7d fd  7e cf a7 f6 c3 6a 3e 04  |.s..._}.~....j>.|
-00000100  f2 08 e3 c1 52 bf c6 10  ff da 21 a9 31 32 c9 07  |....R.....!.12..|
-00000110  2f 63 d0 89 ef 52 61 c1  7d 47 b7 0c 10 1f 90 fe  |/c...Ra.}G......|
-00000120  17 aa 0d f2 2d 34 9b f8  85 a3 ac 78 ee cd ec 7f  |....-4.....x....|
-00000130  1e c8 32 be f4 e9 88 0a  7b c1 c6 89 7e 20 56 86  |..2.....{...~ V.|
-00000140  69 e4 1c a3 69 51 a2 53  6e 30 71 9e d8 4b 16 67  |i...iQ.Sn0q..K.g|
-00000150  c6 5c 36 36 83 3e f7 29  58 4d 52 b2 35 18 07 97  |.\66.>.)XMR.5...|
-00000160  0f 64 e3 75 e1 24 9e 8d  68                       |.d.u.$..h|
+00000090  a9 16 87 2f f6 a3 b2 74  98 d1 d4 c9 65 e0 58 a3  |.../...t....e.X.|
+000000a0  93 66 5a 4a fb 08 c5 17  03 03 00 35 2d e8 33 d1  |.fZJ.......5-.3.|
+000000b0  b2 02 55 ae 19 75 b0 7d  21 3a ac 3b bc 00 6f 5d  |..U..u.}!:.;..o]|
+000000c0  86 0d 4e cd 69 28 b0 44  2b c3 80 42 91 a9 dd fc  |..N.i(.D+..B....|
+000000d0  11 43 88 1a 86 a2 c7 24  be c3 9a 1b 48 5e a4 45  |.C.....$....H^.E|
+000000e0  1b 17 03 03 00 83 ff b7  b3 5a 8c cf f8 78 82 2f  |.........Z...x./|
+000000f0  98 be 22 36 ca 98 a4 c4  7b be d4 45 b2 41 c5 c0  |.."6....{..E.A..|
+00000100  c0 5b d8 89 99 d3 7c 4c  35 fe 64 18 6e 09 b2 6b  |.[....|L5.d.n..k|
+00000110  97 d9 01 86 d7 e4 55 9e  57 c9 b0 72 69 41 1d 51  |......U.W..riA.Q|
+00000120  76 7b 9e ad 15 80 ec d4  ba de 10 f1 40 b4 64 cd  |v{..........@.d.|
+00000130  05 15 81 d7 de a2 68 f6  67 f6 f4 67 a5 10 05 17  |......h.g..g....|
+00000140  bd dc 07 18 d9 7d 9a 20  3c a1 3f f3 41 25 52 22  |.....}. <.?.A%R"|
+00000150  fc 23 3c a1 13 f8 9e 46  70 38 9a 42 95 4f 98 f3  |.#<....Fp8.B.O..|
+00000160  3c fc 0c 01 b4 10 7c 13  bd                       |<.....|..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 40 86 84 c9 1e  |..........5@....|
-00000010  28 47 1d 59 2a da 37 de  96 ea d6 29 8b 87 49 bf  |(G.Y*.7....)..I.|
-00000020  50 01 6e 25 e4 d3 5c e4  d7 a6 cc 66 fe dc aa 20  |P.n%..\....f... |
-00000030  78 b5 57 b9 1c 19 98 f5  30 f8 04 97 31 33 70 cd  |x.W.....0...13p.|
+00000000  14 03 03 00 01 01 17 03  03 00 35 fa c1 52 26 f8  |..........5..R&.|
+00000010  98 8a a4 94 75 6e ff 86  30 ab a9 48 92 3d 6f 84  |....un..0..H.=o.|
+00000020  cb 48 a0 93 75 44 64 4e  73 f2 3d c7 9b c1 ca 2b  |.H..uDdNs.=....+|
+00000030  a7 a7 2c 3c 87 3a 91 3e  ea 4a 4c 44 24 2c 11 a6  |..,<.:.>.JLD$,..|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 30 0c 80  74 7d 49 65 a2 ff 26 3a  |.....0..t}Ie..&:|
-00000010  3c 6c 97 d1 9d 04 66 e1  7b 70 a1 f2 54 03 a8 1d  |<l....f.{p..T...|
-00000020  00 8c c6 17 03 03 00 13  4f 3d b2 42 25 fa ef 85  |........O=.B%...|
-00000030  bb 31 e2 b1 ab e9 d3 38  0e 4f f0                 |.1.....8.O.|
+00000000  17 03 03 00 1e 23 0a be  5e 0d 39 b9 40 d8 b9 18  |.....#..^.9.@...|
+00000010  81 46 49 83 a8 d3 76 21  d1 a6 50 2e 6d 6d 24 f3  |.FI...v!..P.mm$.|
+00000020  e9 63 9f 17 03 03 00 13  cb 6e 2d c3 89 5b b8 6e  |.c.......n-..[.n|
+00000030  7c 5d 8b 25 f6 3b 7b b1  5d 7e 34                 ||].%.;{.]~4|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-Resume-HelloRetryRequest b/src/crypto/tls/testdata/Server-TLSv13-Resume-HelloRetryRequest
index 28e96d3ccd..cad5722e51 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-Resume-HelloRetryRequest
+++ b/src/crypto/tls/testdata/Server-TLSv13-Resume-HelloRetryRequest
@@ -1,93 +1,93 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 58 01 00 01  54 03 03 46 58 dd 3f c2  |....X...T..FX.?.|
-00000010  d1 1c d2 b0 31 bd 51 a0  51 6a 83 fe 36 66 7e ca  |....1.Q.Qj..6f~.|
-00000020  b0 8c c1 99 7a ce 11 e7  e5 31 6b 20 62 92 49 27  |....z....1k b.I'|
-00000030  ef 4e 4a c1 9e c4 39 bf  7d 5b 1b c4 11 81 1c 50  |.NJ...9.}[.....P|
-00000040  62 56 bd dd 87 81 84 5a  97 86 b8 c1 00 04 13 01  |bV.....Z........|
+00000000  16 03 01 01 58 01 00 01  54 03 03 ed eb af 47 ff  |....X...T.....G.|
+00000010  aa 78 84 11 2d bf 94 bb  fa df fd df f2 51 bf 85  |.x..-........Q..|
+00000020  19 1d ec 1b e8 b6 9f aa  1f b9 b2 20 12 86 c6 fe  |........... ....|
+00000030  4e f8 19 4c ea ab 32 1a  b7 e0 33 6a ce b1 05 3a  |N..L..2...3j...:|
+00000040  fc 45 a4 bd 41 eb 1e b8  ce aa 2c 3a 00 04 13 01  |.E..A.....,:....|
 00000050  00 ff 01 00 01 07 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 06 00 04 00 1d 00 17  00 23 00 00 00 16 00 00  |.........#......|
 00000070  00 17 00 00 00 0d 00 1e  00 1c 04 03 05 03 06 03  |................|
 00000080  08 07 08 08 08 09 08 0a  08 0b 08 04 08 05 08 06  |................|
 00000090  04 01 05 01 06 01 00 2b  00 03 02 03 04 00 2d 00  |.......+......-.|
-000000a0  02 01 01 00 33 00 26 00  24 00 1d 00 20 00 cf 4b  |....3.&.$... ..K|
-000000b0  3b 91 5e 37 9e f9 de bd  54 d1 08 cc 3b 7d 7d 4c  |;.^7....T...;}}L|
-000000c0  d6 9a fe 31 77 18 10 69  f4 cf de 02 2a 00 29 00  |...1w..i....*.).|
+000000a0  02 01 01 00 33 00 26 00  24 00 1d 00 20 34 32 3e  |....3.&.$... 42>|
+000000b0  9e 49 48 9d e3 63 b0 65  fc 38 b5 05 45 9a 3d 0d  |.IH..c.e.8..E.=.|
+000000c0  4a 00 a4 2c 53 78 59 18  63 43 01 2f 0f 00 29 00  |J..,SxY.cC./..).|
 000000d0  8c 00 67 00 61 00 00 00  00 00 00 00 00 00 00 00  |..g.a...........|
-000000e0  00 00 00 00 00 94 68 2c  a3 82 51 ed 14 ef 68 ca  |......h,..Q...h.|
-000000f0  42 c5 5c 0e f0 13 2b 49  4b af 0a 68 2a 6d 66 17  |B.\...+IK..h*mf.|
-00000100  44 4e 21 1f 93 74 1c 94  2e 64 97 80 eb 5a e9 00  |DN!..t...d...Z..|
-00000110  26 db dd 99 76 3c c3 a2  8a 88 24 10 e6 07 1a b5  |&...v<....$.....|
-00000120  9e 15 04 26 83 13 ba 92  76 3e ef ea 7b 42 ee 47  |...&....v>..{B.G|
-00000130  e8 7a f6 0e 61 db 00 00  00 00 00 21 20 5a 80 55  |.z..a......! Z.U|
-00000140  fe 28 0d b4 8e 72 dc 57  c4 b5 53 3e 3d 14 6d d9  |.(...r.W..S>=.m.|
-00000150  44 21 68 ad f0 c5 a1 e9  70 82 99 1a b5           |D!h.....p....|
+000000e0  00 00 00 00 00 94 68 2d  a3 82 51 ed 14 ef 68 ca  |......h-..Q...h.|
+000000f0  42 c5 5c c3 a1 dd 20 28  ae a0 82 eb d0 3f 35 60  |B.\... (.....?5`|
+00000100  a5 97 b5 44 f8 c0 61 48  23 48 5a b2 bc 89 14 80  |...D..aH#HZ.....|
+00000110  12 aa b5 99 76 3c 4c fd  0d aa 76 13 14 dd 88 c7  |....v<L...v.....|
+00000120  8e 09 4b 4e b9 4f 88 a4  24 19 9c 24 c1 ba a2 9b  |..KN.O..$..$....|
+00000130  aa e1 fa b6 19 81 00 00  00 00 00 21 20 48 50 ef  |...........! HP.|
+00000140  56 cd c0 79 0d 67 55 4c  83 cc 89 ce 7b b5 47 c2  |V..y.gUL....{.G.|
+00000150  9d 23 12 cd db 34 3c 3b  20 65 78 e9 cf           |.#...4<; ex..|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 58 02 00 00  54 03 03 cf 21 ad 74 e5  |....X...T...!.t.|
 00000010  9a 61 11 be 1d 8c 02 1e  65 b8 91 c2 a2 11 16 7a  |.a......e......z|
-00000020  bb 8c 5e 07 9e 09 e2 c8  a8 33 9c 20 62 92 49 27  |..^......3. b.I'|
-00000030  ef 4e 4a c1 9e c4 39 bf  7d 5b 1b c4 11 81 1c 50  |.NJ...9.}[.....P|
-00000040  62 56 bd dd 87 81 84 5a  97 86 b8 c1 13 01 00 00  |bV.....Z........|
+00000020  bb 8c 5e 07 9e 09 e2 c8  a8 33 9c 20 12 86 c6 fe  |..^......3. ....|
+00000030  4e f8 19 4c ea ab 32 1a  b7 e0 33 6a ce b1 05 3a  |N..L..2...3j...:|
+00000040  fc 45 a4 bd 41 eb 1e b8  ce aa 2c 3a 13 01 00 00  |.E..A.....,:....|
 00000050  0c 00 2b 00 02 03 04 00  33 00 02 00 17 14 03 03  |..+.....3.......|
 00000060  00 01 01                                          |...|
 >>> Flow 3 (client to server)
 00000000  14 03 03 00 01 01 16 03  03 01 79 01 00 01 75 03  |..........y...u.|
-00000010  03 46 58 dd 3f c2 d1 1c  d2 b0 31 bd 51 a0 51 6a  |.FX.?.....1.Q.Qj|
-00000020  83 fe 36 66 7e ca b0 8c  c1 99 7a ce 11 e7 e5 31  |..6f~.....z....1|
-00000030  6b 20 62 92 49 27 ef 4e  4a c1 9e c4 39 bf 7d 5b  |k b.I'.NJ...9.}[|
-00000040  1b c4 11 81 1c 50 62 56  bd dd 87 81 84 5a 97 86  |.....PbV.....Z..|
-00000050  b8 c1 00 04 13 01 00 ff  01 00 01 28 00 0b 00 04  |...........(....|
+00000010  03 ed eb af 47 ff aa 78  84 11 2d bf 94 bb fa df  |....G..x..-.....|
+00000020  fd df f2 51 bf 85 19 1d  ec 1b e8 b6 9f aa 1f b9  |...Q............|
+00000030  b2 20 12 86 c6 fe 4e f8  19 4c ea ab 32 1a b7 e0  |. ....N..L..2...|
+00000040  33 6a ce b1 05 3a fc 45  a4 bd 41 eb 1e b8 ce aa  |3j...:.E..A.....|
+00000050  2c 3a 00 04 13 01 00 ff  01 00 01 28 00 0b 00 04  |,:.........(....|
 00000060  03 00 01 02 00 0a 00 06  00 04 00 1d 00 17 00 23  |...............#|
 00000070  00 00 00 16 00 00 00 17  00 00 00 0d 00 1e 00 1c  |................|
 00000080  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000090  08 04 08 05 08 06 04 01  05 01 06 01 00 2b 00 03  |.............+..|
 000000a0  02 03 04 00 2d 00 02 01  01 00 33 00 47 00 45 00  |....-.....3.G.E.|
-000000b0  17 00 41 04 e1 fd 0d 00  b6 d5 bb 84 6b e5 b1 a8  |..A.........k...|
-000000c0  bb ce 5b 22 3d fc 00 9d  27 87 ab f7 c2 e3 6d b7  |..["=...'.....m.|
-000000d0  42 ac 80 c6 0b b2 b3 20  e4 dc 6c a7 bd fc 68 f5  |B...... ..l...h.|
-000000e0  53 d6 70 82 de 03 19 32  16 7b cb 09 dd c8 e3 b9  |S.p....2.{......|
-000000f0  0f bd a6 28 00 29 00 8c  00 67 00 61 00 00 00 00  |...(.)...g.a....|
-00000100  00 00 00 00 00 00 00 00  00 00 00 00 94 68 2c a3  |.............h,.|
-00000110  82 51 ed 14 ef 68 ca 42  c5 5c 0e f0 13 2b 49 4b  |.Q...h.B.\...+IK|
-00000120  af 0a 68 2a 6d 66 17 44  4e 21 1f 93 74 1c 94 2e  |..h*mf.DN!..t...|
-00000130  64 97 80 eb 5a e9 00 26  db dd 99 76 3c c3 a2 8a  |d...Z..&...v<...|
-00000140  88 24 10 e6 07 1a b5 9e  15 04 26 83 13 ba 92 76  |.$........&....v|
-00000150  3e ef ea 7b 42 ee 47 e8  7a f6 0e 61 db 00 00 00  |>..{B.G.z..a....|
-00000160  00 00 21 20 25 c6 50 69  e5 8a ee cd bb 34 25 96  |..! %.Pi.....4%.|
-00000170  00 1c 51 f3 fb ec 90 eb  4d d5 60 a7 6a 55 cb 38  |..Q.....M.`.jU.8|
-00000180  71 40 81 68                                       |q@.h|
+000000b0  17 00 41 04 a0 ad 32 45  21 a4 07 ea 0d 6b 9b 59  |..A...2E!....k.Y|
+000000c0  c6 1e 7e 66 a7 fc 95 5c  20 de c1 d4 8f 49 72 26  |..~f...\ ....Ir&|
+000000d0  83 c7 ca 55 b0 c0 79 5a  fc ca 41 72 ec e5 d4 de  |...U..yZ..Ar....|
+000000e0  6c 36 96 e1 bf da 80 2d  15 37 50 b9 28 f4 d4 7a  |l6.....-.7P.(..z|
+000000f0  40 f9 ae ce 00 29 00 8c  00 67 00 61 00 00 00 00  |@....)...g.a....|
+00000100  00 00 00 00 00 00 00 00  00 00 00 00 94 68 2d a3  |.............h-.|
+00000110  82 51 ed 14 ef 68 ca 42  c5 5c c3 a1 dd 20 28 ae  |.Q...h.B.\... (.|
+00000120  a0 82 eb d0 3f 35 60 a5  97 b5 44 f8 c0 61 48 23  |....?5`...D..aH#|
+00000130  48 5a b2 bc 89 14 80 12  aa b5 99 76 3c 4c fd 0d  |HZ.........v<L..|
+00000140  aa 76 13 14 dd 88 c7 8e  09 4b 4e b9 4f 88 a4 24  |.v.......KN.O..$|
+00000150  19 9c 24 c1 ba a2 9b aa  e1 fa b6 19 81 00 00 00  |..$.............|
+00000160  00 00 21 20 64 77 a3 be  62 21 9c 49 bd b7 f9 ba  |..! dw..b!.I....|
+00000170  4b 89 44 c3 3f 48 84 48  1c 54 e2 bf 78 7d 89 9b  |K.D.?H.H.T..x}..|
+00000180  37 f0 37 3f                                       |7.7?|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 a1 02 00 00  9d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 62 92 49 27  |........... b.I'|
-00000030  ef 4e 4a c1 9e c4 39 bf  7d 5b 1b c4 11 81 1c 50  |.NJ...9.}[.....P|
-00000040  62 56 bd dd 87 81 84 5a  97 86 b8 c1 13 01 00 00  |bV.....Z........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 12 86 c6 fe  |........... ....|
+00000030  4e f8 19 4c ea ab 32 1a  b7 e0 33 6a ce b1 05 3a  |N..L..2...3j...:|
+00000040  fc 45 a4 bd 41 eb 1e b8  ce aa 2c 3a 13 01 00 00  |.E..A.....,:....|
 00000050  55 00 2b 00 02 03 04 00  33 00 45 00 17 00 41 04  |U.+.....3.E...A.|
 00000060  1e 18 37 ef 0d 19 51 88  35 75 71 b5 e5 54 5b 12  |..7...Q.5uq..T[.|
 00000070  2e 8f 09 67 fd a7 24 20  3e b2 56 1c ce 97 28 5e  |...g..$ >.V...(^|
 00000080  f8 2b 2d 4f 9e f1 07 9f  6c 4b 5b 83 56 e2 32 42  |.+-O....lK[.V.2B|
 00000090  e9 58 b6 d7 49 a6 b5 68  1a 41 03 56 6b dc 5a 89  |.X..I..h.A.Vk.Z.|
-000000a0  00 29 00 02 00 00 17 03  03 00 17 b5 4a 8d aa 38  |.)..........J..8|
-000000b0  5f f3 ca 15 93 0a 63 76  92 0a 22 c3 90 bd d0 2c  |_.....cv.."....,|
-000000c0  9f 69 17 03 03 00 35 99  55 50 9c 1d 81 4b 83 2d  |.i....5.UP...K.-|
-000000d0  6f 03 e6 4a 8f 59 b1 c1  4b 7a 1d f4 b7 73 b4 b9  |o..J.Y..Kz...s..|
-000000e0  57 aa 54 ea f7 d5 44 59  af d3 2c 81 08 5b 0e 24  |W.T...DY..,..[.$|
-000000f0  ec cd b0 99 41 b0 e6 aa  3a 0c c0 8b 17 03 03 00  |....A...:.......|
-00000100  83 ee e9 7f bb 8d f3 9e  a3 7b 06 2a cb 44 ab e1  |.........{.*.D..|
-00000110  d3 3d 5f 12 c8 73 fd 6c  f1 5b 53 cf 99 f2 a2 2a  |.=_..s.l.[S....*|
-00000120  f1 f2 e9 57 9d 31 65 b0  4a c0 3f 29 6a 0d 11 7c  |...W.1e.J.?)j..||
-00000130  d7 7f 37 16 53 54 95 59  0b 61 e6 aa d3 10 e1 10  |..7.ST.Y.a......|
-00000140  44 51 7d fb 73 8c 85 7f  d9 8e 02 58 ba 6b 95 b8  |DQ}.s......X.k..|
-00000150  de 2c f7 73 90 61 50 2d  44 79 99 02 fc 67 e7 88  |.,.s.aP-Dy...g..|
-00000160  b0 0c ad 71 e2 07 78 95  fb 39 10 03 71 28 23 56  |...q..x..9..q(#V|
-00000170  e1 8d 2c cd 31 07 e8 5d  f4 41 3d 83 51 a2 c0 c2  |..,.1..].A=.Q...|
-00000180  88 41 dd b0                                       |.A..|
+000000a0  00 29 00 02 00 00 17 03  03 00 17 45 15 7c 2c 1e  |.).........E.|,.|
+000000b0  b2 ad 7c 54 df b2 b3 47  53 e1 94 85 93 16 d5 bb  |..|T...GS.......|
+000000c0  72 e5 17 03 03 00 35 17  5a 84 66 4b e6 b4 e8 9d  |r.....5.Z.fK....|
+000000d0  97 9f db e4 ab 49 76 69  67 dc 81 03 8a e0 79 1a  |.....Ivig.....y.|
+000000e0  34 fc 32 86 2c 23 ea 60  fd f4 fe d8 06 7b 1e ba  |4.2.,#.`.....{..|
+000000f0  fc 00 7b dd 61 af 51 0a  b6 77 a7 1b 17 03 03 00  |..{.a.Q..w......|
+00000100  83 a9 14 74 c9 d0 20 00  e8 12 60 0c 90 d9 20 6d  |...t.. ...`... m|
+00000110  8c ae e0 ee 30 71 77 84  d1 0a 16 07 dd c7 60 80  |....0qw.......`.|
+00000120  11 74 b2 44 7a 12 0e 18  4d 0e c7 7e 4f 6f 30 6d  |.t.Dz...M..~Oo0m|
+00000130  a9 46 cf 90 5d d5 dc 9f  44 b2 45 b8 e3 bb 75 ed  |.F..]...D.E...u.|
+00000140  e1 8b 88 5e 79 be 75 3f  6b 57 9f 1c a1 c9 18 93  |...^y.u?kW......|
+00000150  ce 75 bf 1c ec 30 7d 49  a3 fc 5c 9f 35 bc 4c c8  |.u...0}I..\.5.L.|
+00000160  32 fa e6 a3 f0 7c cb 3f  c4 5b 32 17 30 52 8c a0  |2....|.?.[2.0R..|
+00000170  ad f4 cb 57 35 71 24 a8  55 81 7c f1 01 68 ee 16  |...W5q$.U.|..h..|
+00000180  07 5f f5 0f                                       |._..|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 35 02 aa 9b  cf 61 04 5a ed 64 98 08  |....5....a.Z.d..|
-00000010  18 39 86 b5 83 c4 73 de  81 58 eb af af 71 fd 62  |.9....s..X...q.b|
-00000020  64 e6 1d ef 70 69 11 9c  34 1d f8 4a 95 f1 5f 45  |d...pi..4..J.._E|
-00000030  b2 d1 e0 4b 07 80 4a af  b6 86                    |...K..J...|
+00000000  17 03 03 00 35 ff 00 7c  66 1a a3 7b 63 4b fa 10  |....5..|f..{cK..|
+00000010  c7 5e 6e ef 59 dc 09 a7  12 23 16 f9 ac 14 dc b4  |.^n.Y....#......|
+00000020  d5 f1 24 be e3 86 ab d8  dc 03 2c 8f 0f 1e 20 90  |..$.......,... .|
+00000030  20 e9 1f 2c 96 04 68 9f  06 23                    | ..,..h..#|
 >>> Flow 6 (server to client)
-00000000  17 03 03 00 1e 46 65 d1  bf 65 cf e6 e1 6a bf ab  |.....Fe..e...j..|
-00000010  3c d3 b6 64 c8 25 52 97  ae 70 af 80 24 14 e5 6c  |<..d.%R..p..$..l|
-00000020  7b c0 90 17 03 03 00 13  f8 ee 26 da 29 34 88 a2  |{.........&.)4..|
-00000030  73 cc 17 b3 36 b3 d8 72  6d 7b 0c                 |s...6..rm{.|
+00000000  17 03 03 00 1e 70 80 ca  7e 4a 32 3c c8 1c 93 56  |.....p..~J2<...V|
+00000010  f4 91 26 82 e5 5e 15 d7  84 ca ae 9e f3 cf b2 dd  |..&..^..........|
+00000020  cf e8 31 17 03 03 00 13  cc 61 35 89 7c 01 ed 52  |..1......a5.|..R|
+00000030  01 4f 6a 3f 5b 22 9f ec  19 3d c2                 |.Oj?["...=.|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-X25519 b/src/crypto/tls/testdata/Server-TLSv13-X25519
index 50934fa373..fa6369fc5e 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-X25519
+++ b/src/crypto/tls/testdata/Server-TLSv13-X25519
@@ -1,97 +1,97 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 c2 01 00 00  be 03 03 46 20 08 91 0e  |...........F ...|
-00000010  7f ed 55 e3 48 ef 93 60  40 a2 bf 63 e7 a0 d6 26  |..U.H..`@..c...&|
-00000020  76 98 f8 f1 fb bc 1e 6f  f9 5b 01 20 ac 49 74 ef  |v......o.[. .It.|
-00000030  05 a4 4b e5 1b be 5b 5c  8c 96 0e 9c 56 47 8c f2  |..K...[\....VG..|
-00000040  a1 09 c7 75 33 24 df f5  07 e4 d2 53 00 04 13 03  |...u3$.....S....|
+00000000  16 03 01 00 c2 01 00 00  be 03 03 5e 3e 25 be 39  |...........^>%.9|
+00000010  69 8b 0e 93 78 bb e1 7f  21 4d bf 12 f0 ad 7f 39  |i...x...!M.....9|
+00000020  02 a6 26 db d0 7b b8 23  b0 78 96 20 93 a1 eb b5  |..&..{.#.x. ....|
+00000030  12 f6 5d 07 c9 b6 c9 49  50 98 a3 01 ed 5c df 14  |..]....IP....\..|
+00000040  21 64 4c 64 f2 97 7b 04  1b 6a 9d e5 00 04 13 03  |!dLd..{..j......|
 00000050  00 ff 01 00 00 71 00 0b  00 04 03 00 01 02 00 0a  |.....q..........|
 00000060  00 04 00 02 00 1d 00 16  00 00 00 17 00 00 00 0d  |................|
 00000070  00 1e 00 1c 04 03 05 03  06 03 08 07 08 08 08 09  |................|
 00000080  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
 00000090  00 2b 00 03 02 03 04 00  2d 00 02 01 01 00 33 00  |.+......-.....3.|
-000000a0  26 00 24 00 1d 00 20 84  49 c3 da a7 a8 ba 76 9a  |&.$... .I.....v.|
-000000b0  df 49 48 01 ec 68 42 af  ee 06 bf b9 52 d5 ab 9a  |.IH..hB.....R...|
-000000c0  4f 27 ec 04 8a b4 21                              |O'....!|
+000000a0  26 00 24 00 1d 00 20 f2  80 32 ed ad 9b 4a 9a 93  |&.$... ..2...J..|
+000000b0  bf e6 3b 79 95 e1 b3 1a  3c aa 7f b7 6d b6 ce 70  |..;y....<...m..p|
+000000c0  d6 28 2c c5 2c 11 40                              |.(,.,.@|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 ac 49 74 ef  |........... .It.|
-00000030  05 a4 4b e5 1b be 5b 5c  8c 96 0e 9c 56 47 8c f2  |..K...[\....VG..|
-00000040  a1 09 c7 75 33 24 df f5  07 e4 d2 53 13 03 00 00  |...u3$.....S....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 93 a1 eb b5  |........... ....|
+00000030  12 f6 5d 07 c9 b6 c9 49  50 98 a3 01 ed 5c df 14  |..]....IP....\..|
+00000040  21 64 4c 64 f2 97 7b 04  1b 6a 9d e5 13 03 00 00  |!dLd..{..j......|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 c7 1b 2e 0d 20 52  |.............. R|
-00000090  0a 72 42 e5 ce d0 94 60  87 34 3c 6d e4 52 56 ec  |.rB....`.4<m.RV.|
-000000a0  c5 17 03 03 02 6d d6 48  77 63 ef e3 27 44 1b b9  |.....m.Hwc..'D..|
-000000b0  f4 84 ea e1 6a ff d1 38  24 39 f2 55 dd cb 08 dd  |....j..8$9.U....|
-000000c0  91 29 ab 86 fc 61 91 d6  a1 bf c5 f7 11 c6 49 ad  |.)...a........I.|
-000000d0  a7 5b df 22 22 61 92 7e  f7 c3 20 3a cb 72 47 52  |.[.""a.~.. :.rGR|
-000000e0  d3 18 be c9 9e 6a 4e b0  c1 45 b8 e3 91 c3 7f 4b  |.....jN..E.....K|
-000000f0  c4 f9 3b bd 3e 18 aa ff  e2 2a 84 90 07 ed 63 7f  |..;.>....*....c.|
-00000100  2b 82 32 0a 84 4b 77 a5  fd fa 09 e0 a8 ca 16 92  |+.2..Kw.........|
-00000110  2b 7a 48 a4 2d 82 b3 1e  63 ea d2 49 c1 88 6e 93  |+zH.-...c..I..n.|
-00000120  ba e0 2d 8e 89 e0 bb bf  2b ce 42 91 8c 5b f1 f4  |..-.....+.B..[..|
-00000130  19 9c 96 11 77 d9 b0 31  5a 65 82 66 2a ec 70 41  |....w..1Ze.f*.pA|
-00000140  b7 d0 25 f3 13 94 d4 6c  c1 0c 10 b7 ed 5d 8c d0  |..%....l.....]..|
-00000150  ef 77 bc 46 90 e7 db 17  04 41 b4 64 b3 83 88 34  |.w.F.....A.d...4|
-00000160  ee c2 76 f6 76 74 fc 48  94 56 95 2a 40 10 84 d8  |..v.vt.H.V.*@...|
-00000170  ca 98 5a 9e bf 72 11 77  1f d8 f1 27 9f 08 6e 95  |..Z..r.w...'..n.|
-00000180  7b cb 3c db 18 80 bd 64  53 6e 4d 19 a0 13 ce 36  |{.<....dSnM....6|
-00000190  6f de af de bd 51 dc 10  e9 90 27 26 86 b3 6b 49  |o....Q....'&..kI|
-000001a0  37 be 9d a3 e4 b9 b6 b6  d6 80 75 58 31 a3 9d 24  |7.........uX1..$|
-000001b0  4a be f2 ee ca 6d b6 f3  5a 0e 41 92 60 5e 9d 39  |J....m..Z.A.`^.9|
-000001c0  96 02 d3 66 cc 8f d2 9d  53 12 5f b7 42 1b ad a4  |...f....S._.B...|
-000001d0  57 54 63 87 f3 12 6e 84  71 a2 58 43 9a 37 01 a6  |WTc...n.q.XC.7..|
-000001e0  97 a0 43 77 1a e8 c9 ca  a9 c9 55 e6 e6 10 95 8b  |..Cw......U.....|
-000001f0  fd 6e c9 2e 89 03 21 56  20 32 c0 c7 7a 52 5b 06  |.n....!V 2..zR[.|
-00000200  8d 46 c4 cc a0 17 11 7d  6a 97 f1 bb 1b 69 52 23  |.F.....}j....iR#|
-00000210  de 6d ac 7e be d9 00 3a  ee 7f 79 2e 56 cd 86 bb  |.m.~...:..y.V...|
-00000220  50 c1 1f c3 85 d8 e8 1c  74 87 62 be f4 da 94 74  |P.......t.b....t|
-00000230  47 d5 94 fa 3a f1 c6 7e  dc 25 1d 03 7d 2a 86 8f  |G...:..~.%..}*..|
-00000240  92 3f 44 91 a3 62 cf 75  88 87 d0 d2 fe 56 95 e7  |.?D..b.u.....V..|
-00000250  57 aa da 1f 81 91 49 de  47 75 29 64 f4 a3 d8 01  |W.....I.Gu)d....|
-00000260  9a 82 66 43 d8 1b c7 69  ac 61 22 3e 75 c4 f7 2d  |..fC...i.a">u..-|
-00000270  9a c1 f7 8a 6f 6f f6 da  fb 72 5e 13 f3 c2 68 4d  |....oo...r^...hM|
-00000280  97 e9 9e 3c 36 52 bb 89  59 23 07 d5 f5 53 eb f5  |...<6R..Y#...S..|
-00000290  c4 4e 73 c7 9d 3f ad e7  13 62 b9 90 bd 40 91 b3  |.Ns..?...b...@..|
-000002a0  c2 88 6b 4c 53 fb a1 4d  b1 6e d1 8e d7 fc 1a 77  |..kLS..M.n.....w|
-000002b0  2a 27 db 15 85 1d 55 1e  04 51 e3 ca 97 6c 65 76  |*'....U..Q...lev|
-000002c0  48 15 26 82 31 b3 d5 c1  48 5b c0 37 31 6b 4f b1  |H.&.1...H[.71kO.|
-000002d0  9d 46 45 5b 6f ee a0 fa  38 9b 87 04 23 3e ae 38  |.FE[o...8...#>.8|
-000002e0  00 e8 34 c8 28 46 27 75  05 bd 21 7c 14 54 f6 98  |..4.(F'u..!|.T..|
-000002f0  c9 f4 72 b1 1f e2 83 49  62 76 26 6a c5 74 8b b6  |..r....Ibv&j.t..|
-00000300  d9 7b 7a b0 41 bf 8d fe  0a de cc 02 55 55 d9 39  |.{z.A.......UU.9|
-00000310  ae 20 51 17 03 03 00 99  da 69 0d 52 7e 06 63 13  |. Q......i.R~.c.|
-00000320  a3 48 21 9c 10 00 04 50  46 7d f2 fe b9 d3 87 03  |.H!....PF}......|
-00000330  f5 51 c9 45 7c 2f f2 4e  fc b3 50 e4 9c 54 8d 47  |.Q.E|/.N..P..T.G|
-00000340  62 c5 0b 1c 24 00 f9 81  f2 46 c5 0b c5 61 3d 74  |b...$....F...a=t|
-00000350  b8 51 cc b3 da 0a 16 cb  a0 69 39 c2 94 00 c1 da  |.Q.......i9.....|
-00000360  42 8d 5a 20 67 90 4c f6  bd 39 10 05 4b 43 44 d0  |B.Z g.L..9..KCD.|
-00000370  9c 93 12 fa ae d6 b5 38  f3 51 f1 05 19 a4 03 d0  |.......8.Q......|
-00000380  6d 36 1c 75 92 5c 4f e4  50 f3 0c 80 ba 46 71 81  |m6.u.\O.P....Fq.|
-00000390  64 3a 63 62 99 51 ae 60  d6 c7 34 fe f3 f8 10 26  |d:cb.Q.`..4....&|
-000003a0  a0 50 29 95 9d 8f 3b 79  56 cf af 66 28 ce f9 59  |.P)...;yV..f(..Y|
-000003b0  35 17 03 03 00 35 b6 0f  b1 75 94 80 f5 7f d4 2c  |5....5...u.....,|
-000003c0  8b 5f 6e 29 06 18 78 68  81 ae 4b d5 2d 49 dc 08  |._n)..xh..K.-I..|
-000003d0  5f 14 ec 1b 63 4e af 20  b2 ea 45 b9 b6 66 c0 7a  |_...cN. ..E..f.z|
-000003e0  ee 37 80 3e a5 61 f0 ee  70 cb 46 17 03 03 00 83  |.7.>.a..p.F.....|
-000003f0  c9 79 5a b5 96 75 a0 c5  99 63 8d 49 7b a3 d4 eb  |.yZ..u...c.I{...|
-00000400  38 74 94 6d 86 5c a9 c2  b8 21 03 27 14 ee 39 c5  |8t.m.\...!.'..9.|
-00000410  7f 89 c0 e4 0b 3c 0f bb  82 6e 29 ff 61 86 2f 8e  |.....<...n).a./.|
-00000420  fa 48 a7 5f 71 1c 04 df  ed 6d 32 15 c3 d5 07 65  |.H._q....m2....e|
-00000430  10 23 68 f8 dd 28 71 5a  fc bf 7c 10 ee 38 61 b4  |.#h..(qZ..|..8a.|
-00000440  af 82 d8 32 d8 ed a2 7e  25 44 f3 d2 20 16 69 7a  |...2...~%D.. .iz|
-00000450  00 3b 5c 90 2e 9b 87 21  e8 44 cd 69 80 ab 93 0c  |.;\....!.D.i....|
-00000460  df be c0 ca bc 8b 32 3c  5e 65 e2 e7 86 ea d9 54  |......2<^e.....T|
-00000470  e0 92 af                                          |...|
+00000080  03 03 00 01 01 17 03 03  00 17 67 66 6f 86 c5 43  |..........gfo..C|
+00000090  db 4e 46 59 1b 3c 67 8a  31 84 db 4d 96 4d 92 46  |.NFY.<g.1..M.M.F|
+000000a0  59 17 03 03 02 6d 41 8e  8e ef 33 c7 bd 8d 86 3b  |Y....mA...3....;|
+000000b0  2f ed e4 d4 68 12 f0 fb  45 4a bb 48 39 c7 3f 82  |/...h...EJ.H9.?.|
+000000c0  86 6f ec 00 72 74 f7 20  a3 db 64 65 fe a4 1a d7  |.o..rt. ..de....|
+000000d0  a6 d8 8b aa 5d aa 85 b0  b1 46 4b 46 8f 12 3f 04  |....]....FKF..?.|
+000000e0  b3 c5 74 fa f9 19 86 4d  40 d1 7b ca a7 22 e0 84  |..t....M@.{.."..|
+000000f0  a5 df 57 24 23 7f 56 ae  37 b1 c0 76 c2 8d bd 36  |..W$#.V.7..v...6|
+00000100  2e 4e 5f cc f9 2d e2 f5  05 23 7c 35 91 c5 7f 0a  |.N_..-...#|5....|
+00000110  dc 49 fa 7f bd 0f 0b 8f  e5 4e ae 83 9f 51 52 b7  |.I.......N...QR.|
+00000120  66 99 19 ce 6c e1 56 92  06 19 54 1c 0d 0b fe d7  |f...l.V...T.....|
+00000130  c1 30 a4 62 bc 01 17 49  36 43 c2 7f 17 6c ae de  |.0.b...I6C...l..|
+00000140  b9 1f 02 00 94 5b ff ce  1d a7 49 95 ca d7 5b 9d  |.....[....I...[.|
+00000150  60 68 94 ea 12 ff 53 24  89 7e 85 88 21 3b 1c 94  |`h....S$.~..!;..|
+00000160  04 76 e0 b3 50 93 65 24  73 60 97 77 58 6f 5a 4e  |.v..P.e$s`.wXoZN|
+00000170  b9 17 e9 32 d1 ee 35 2a  58 1d 72 0f b6 11 06 bd  |...2..5*X.r.....|
+00000180  cb ed 20 2d 14 ae bd 71  6f 2c 2d 80 8d 36 32 39  |.. -...qo,-..629|
+00000190  93 67 cc 02 22 79 67 17  da 8e f1 5a 1f 3e ff 2f  |.g.."yg....Z.>./|
+000001a0  1d 16 ff ec 7f 8a 4c 88  a1 63 68 f6 8d 88 12 91  |......L..ch.....|
+000001b0  13 65 dd 77 f8 59 55 52  23 6d 25 0b 6d 87 28 ea  |.e.w.YUR#m%.m.(.|
+000001c0  f3 ea 96 02 fc 7f 74 4d  39 84 34 22 81 35 21 1c  |......tM9.4".5!.|
+000001d0  d1 cc 01 b5 6c e1 bc f2  6f 21 92 9a 38 67 c2 cb  |....l...o!..8g..|
+000001e0  46 fc df 47 ca 01 3e 61  eb e7 79 32 ab 52 f7 bf  |F..G..>a..y2.R..|
+000001f0  b2 e9 bd 7b c2 31 fd d7  6f db 59 16 5a ed ed 5a  |...{.1..o.Y.Z..Z|
+00000200  d1 0e 76 16 f3 bf f9 7b  ab d4 76 12 82 6a 09 d8  |..v....{..v..j..|
+00000210  f7 62 ac eb f4 14 08 e9  fc 0e cc eb a6 6d 3b 6b  |.b...........m;k|
+00000220  96 ce 38 8b 10 8f ac 68  aa bd 77 70 93 8f 46 3d  |..8....h..wp..F=|
+00000230  bd 45 de f4 c9 47 14 80  c4 58 db 7f be 93 63 e7  |.E...G...X....c.|
+00000240  00 fa 71 fd 6f 1f bc a5  cf c9 bd b4 d1 21 d8 83  |..q.o........!..|
+00000250  7d 3a 07 7f 16 5b 98 20  b9 96 1e 5b 9e 83 03 26  |}:...[. ...[...&|
+00000260  d6 a4 db ea 0f 34 12 c0  1f fc 9e 53 b5 fa cf ae  |.....4.....S....|
+00000270  54 65 2a fa 54 73 a9 35  fd 3c 70 12 22 24 1a ce  |Te*.Ts.5.<p."$..|
+00000280  d0 56 6c ec eb fc 29 55  09 66 08 fa 34 28 ef 7b  |.Vl...)U.f..4(.{|
+00000290  0a aa f9 2b f6 69 02 b6  c9 58 2f 6e 6c 8f 9b 48  |...+.i...X/nl..H|
+000002a0  91 3b 27 56 ff 0e df 23  8b 9a fa 29 94 66 f1 43  |.;'V...#...).f.C|
+000002b0  6f 2b 2a e5 48 a4 ab ab  d1 c1 9e bc 46 99 a9 86  |o+*.H.......F...|
+000002c0  4f 02 a9 f4 89 9c 82 53  4d 61 54 45 7a 96 52 89  |O......SMaTEz.R.|
+000002d0  f4 36 55 f4 0c d5 cd 3f  8a 6b 3a 9f e0 1c f3 de  |.6U....?.k:.....|
+000002e0  1e 08 61 67 b4 f3 10 51  30 3c c8 93 41 3d 23 dc  |..ag...Q0<..A=#.|
+000002f0  15 d1 56 ff 53 8e 8e c5  7e de 86 f9 b8 d4 ba f5  |..V.S...~.......|
+00000300  fa c4 aa a6 29 62 b6 0e  d2 75 fc c9 b1 0c 5d b0  |....)b...u....].|
+00000310  62 80 bd 17 03 03 00 99  cd b6 82 55 a2 40 30 e3  |b..........U.@0.|
+00000320  37 5f 8b 7d ab c5 1a 9d  3d 4f b6 ee cc 1f 03 72  |7_.}....=O.....r|
+00000330  c6 30 07 7c a3 bb d2 b6  48 95 5e a9 7d 4e 89 3c  |.0.|....H.^.}N.<|
+00000340  12 1f 89 bb a0 2f 2b bf  0c d1 9d 24 02 f1 7d e7  |...../+....$..}.|
+00000350  c7 cb 21 54 dd 4d f8 5b  e7 57 72 78 98 71 1f 07  |..!T.M.[.Wrx.q..|
+00000360  1a eb 74 8a ce 15 0f f4  34 6e fa c4 e9 d7 75 7b  |..t.....4n....u{|
+00000370  5b 6e ce f5 32 c8 9f b2  ca ce fa e9 9a 3a 84 ff  |[n..2........:..|
+00000380  89 d3 08 94 fe 72 ee 48  8b 83 18 28 ea e1 15 56  |.....r.H...(...V|
+00000390  63 f8 24 b2 6f a4 42 fd  0d f6 e1 4d 00 80 2a 0e  |c.$.o.B....M..*.|
+000003a0  26 32 f5 0d 9c 76 b7 2b  bb 96 81 00 dc 6c 85 37  |&2...v.+.....l.7|
+000003b0  09 17 03 03 00 35 f9 dd  83 ab 35 07 2c a8 ff 5c  |.....5....5.,..\|
+000003c0  21 2b 7b 07 ae f7 de c0  aa 72 e2 f2 1c 75 0f f7  |!+{......r...u..|
+000003d0  b0 e5 9b 50 37 87 71 94  17 d7 06 47 11 5c f0 c4  |...P7.q....G.\..|
+000003e0  92 de 71 07 e2 cc fa f8  12 48 f0 17 03 03 00 83  |..q......H......|
+000003f0  c8 92 03 80 b8 5c 06 3c  f1 e6 ce 40 1d 8c 26 47  |.....\.<...@..&G|
+00000400  38 4b f4 41 64 d1 a5 89  ad 1b 8e 9e 97 98 5e 7d  |8K.Ad.........^}|
+00000410  ef 9d d4 f7 c2 0f 12 9b  77 68 bc 20 4c d2 c5 15  |........wh. L...|
+00000420  fb 37 7a ad 07 5f 14 c5  95 a4 c3 ee 15 13 67 c5  |.7z.._........g.|
+00000430  8a 1a 0e 0a e9 28 97 ce  a1 a4 7f d0 b1 1f 42 d4  |.....(........B.|
+00000440  bb 46 6d f2 59 e4 39 82  22 23 9a 14 30 25 6a af  |.Fm.Y.9."#..0%j.|
+00000450  89 27 37 d8 83 fc bf 5d  62 e7 73 ab e0 6a f0 e5  |.'7....]b.s..j..|
+00000460  e8 ef 9f 66 99 6b 9d 15  ea ad 5b 96 56 0f 4b d0  |...f.k....[.V.K.|
+00000470  fe 26 78                                          |.&x|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 a5 a0 b8 17 16  |..........5.....|
-00000010  ce dc 0e d7 0f 8c 1e 65  81 f0 0c 37 31 0e 3b 70  |.......e...71.;p|
-00000020  ed cd fc b9 73 21 a3 35  94 4f 76 e2 09 40 4a c9  |....s!.5.Ov..@J.|
-00000030  2a 54 30 23 ee 37 53 de  9f e3 38 c2 dc 04 99 d4  |*T0#.7S...8.....|
+00000000  14 03 03 00 01 01 17 03  03 00 35 06 69 d0 f2 43  |..........5.i..C|
+00000010  5d 61 49 ba 4d d0 4b e9  11 ab a0 7e 98 81 f6 4e  |]aI.M.K....~...N|
+00000020  21 d5 85 74 2d 4a f4 51  1b 61 5d 4a b1 98 f3 56  |!..t-J.Q.a]J...V|
+00000030  17 2f 9a 95 4f 4a 0e 66  58 05 2d 61 af 64 be ea  |./..OJ.fX.-a.d..|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e e0 b1 66  dc f6 28 92 9a c1 da bb  |.......f..(.....|
-00000010  f6 ba aa a4 0a 64 4d 32  69 0f dd 88 8f 04 11 8f  |.....dM2i.......|
-00000020  d7 b6 93 17 03 03 00 13  ac 48 c7 4d 12 23 ba 3d  |.........H.M.#.=|
-00000030  39 5c f9 53 d6 9f 05 b5  9b f0 e8                 |9\.S.......|
+00000000  17 03 03 00 1e 15 3a 0f  a2 05 1c 83 e5 1d bf ce  |......:.........|
+00000010  71 3c 97 f0 b3 b2 d1 b2  ec 40 c2 38 71 bf c0 50  |q<.......@.8q..P|
+00000020  3f 92 84 17 03 03 00 13  0e 3f 72 16 86 b9 62 13  |?........?r...b.|
+00000030  2e 36 d6 4b 0f b0 9c 69  2d df 4d                 |.6.K...i-.M|
diff --git a/src/crypto/tls/ticket.go b/src/crypto/tls/ticket.go
index 494f83b033..dfa0d430c0 100644
--- a/src/crypto/tls/ticket.go
+++ b/src/crypto/tls/ticket.go
@@ -16,99 +16,51 @@ import (
 	"golang.org/x/crypto/cryptobyte"
 )
 
-// sessionState contains the information that is serialized into a session
-// ticket in order to later resume a connection.
-type sessionState struct {
-	vers         uint16
-	cipherSuite  uint16
-	createdAt    uint64
-	masterSecret []byte // opaque master_secret<1..2^16-1>;
-	// struct { opaque certificate<1..2^24-1> } Certificate;
-	certificates [][]byte // Certificate certificate_list<0..2^24-1>;
+// A SessionState is a resumable session.
+type SessionState struct {
+	version uint16 // uint16 version;
+	// uint8 revision = 1;
+	cipherSuite uint16
+	createdAt   uint64
+	secret      []byte      // opaque master_secret<1..2^8-1>;
+	certificate Certificate // CertificateEntry certificate_list<0..2^24-1>;
 }
 
-func (m *sessionState) marshal() ([]byte, error) {
+// Bytes encodes the session, including any private fields, so that it can be
+// parsed by [ParseSessionState]. The encoding contains secret values.
+//
+// The specific encoding should be considered opaque and may change incompatibly
+// between Go versions.
+func (m *SessionState) Bytes() ([]byte, error) {
 	var b cryptobyte.Builder
-	b.AddUint16(m.vers)
-	b.AddUint16(m.cipherSuite)
-	addUint64(&b, m.createdAt)
-	b.AddUint16LengthPrefixed(func(b *cryptobyte.Builder) {
-		b.AddBytes(m.masterSecret)
-	})
-	b.AddUint24LengthPrefixed(func(b *cryptobyte.Builder) {
-		for _, cert := range m.certificates {
-			b.AddUint24LengthPrefixed(func(b *cryptobyte.Builder) {
-				b.AddBytes(cert)
-			})
-		}
-	})
-	return b.Bytes()
-}
-
-func (m *sessionState) unmarshal(data []byte) bool {
-	*m = sessionState{}
-	s := cryptobyte.String(data)
-	if ok := s.ReadUint16(&m.vers) &&
-		s.ReadUint16(&m.cipherSuite) &&
-		readUint64(&s, &m.createdAt) &&
-		readUint16LengthPrefixed(&s, &m.masterSecret) &&
-		len(m.masterSecret) != 0; !ok {
-		return false
-	}
-	var certList cryptobyte.String
-	if !s.ReadUint24LengthPrefixed(&certList) {
-		return false
-	}
-	for !certList.Empty() {
-		var cert []byte
-		if !readUint24LengthPrefixed(&certList, &cert) {
-			return false
-		}
-		m.certificates = append(m.certificates, cert)
-	}
-	return s.Empty()
-}
-
-// sessionStateTLS13 is the content of a TLS 1.3 session ticket. Its first
-// version (revision = 0) doesn't carry any of the information needed for 0-RTT
-// validation and the nonce is always empty.
-type sessionStateTLS13 struct {
-	// uint8 version  = 0x0304;
-	// uint8 revision = 0;
-	cipherSuite      uint16
-	createdAt        uint64
-	resumptionSecret []byte      // opaque resumption_master_secret<1..2^8-1>;
-	certificate      Certificate // CertificateEntry certificate_list<0..2^24-1>;
-}
-
-func (m *sessionStateTLS13) marshal() ([]byte, error) {
-	var b cryptobyte.Builder
-	b.AddUint16(VersionTLS13)
-	b.AddUint8(0) // revision
+	b.AddUint16(m.version)
+	b.AddUint8(1) // revision
 	b.AddUint16(m.cipherSuite)
 	addUint64(&b, m.createdAt)
 	b.AddUint8LengthPrefixed(func(b *cryptobyte.Builder) {
-		b.AddBytes(m.resumptionSecret)
+		b.AddBytes(m.secret)
 	})
 	marshalCertificate(&b, m.certificate)
 	return b.Bytes()
 }
 
-func (m *sessionStateTLS13) unmarshal(data []byte) bool {
-	*m = sessionStateTLS13{}
+// ParseSessionState parses a [SessionState] encoded by [SessionState.Bytes].
+func ParseSessionState(data []byte) (*SessionState, error) {
+	ss := &SessionState{}
 	s := cryptobyte.String(data)
-	var version uint16
 	var revision uint8
-	return s.ReadUint16(&version) &&
-		version == VersionTLS13 &&
-		s.ReadUint8(&revision) &&
-		revision == 0 &&
-		s.ReadUint16(&m.cipherSuite) &&
-		readUint64(&s, &m.createdAt) &&
-		readUint8LengthPrefixed(&s, &m.resumptionSecret) &&
-		len(m.resumptionSecret) != 0 &&
-		unmarshalCertificate(&s, &m.certificate) &&
-		s.Empty()
+	if !s.ReadUint16(&ss.version) ||
+		!s.ReadUint8(&revision) ||
+		revision != 1 ||
+		!s.ReadUint16(&ss.cipherSuite) ||
+		!readUint64(&s, &ss.createdAt) ||
+		!readUint8LengthPrefixed(&s, &ss.secret) ||
+		len(ss.secret) == 0 ||
+		!unmarshalCertificate(&s, &ss.certificate) ||
+		!s.Empty() {
+		return nil, errors.New("tls: invalid session encoding")
+	}
+	return ss, nil
 }
 
 func (c *Conn) encryptTicket(state []byte) ([]byte, error) {
