commit f49279383901af656e40f225eb67ff62f507e13d
Merge: 768804dfdd c9b60632eb
Author: David Chase <drchase@google.com>
Date:   Mon Mar 7 18:27:14 2022 -0500

    [dev.boringcrypto] all: merge master into dev.boringcrypto
    
    Change-Id: I4e09d4f2cc77c4c2dc12f1ff40d8c36053ab7ab6

 CONTRIBUTORS                                       |   97 +-
 api/go1.18.txt                                     |    4 +-
 api/next.txt                                       |    5 +
 doc/go1.18.html                                    | 1235 -----------------
 doc/go1.19.html                                    |   61 +
 doc/go_spec.html                                   |  870 +++++++-----
 misc/cgo/testsanitizers/asan_test.go               |    2 +-
 misc/reboot/overlaydir_test.go                     |   15 +-
 misc/reboot/reboot_test.go                         |    9 +-
 src/builtin/builtin.go                             |    6 +-
 src/bytes/bytes.go                                 |    4 +
 src/cmd/compile/abi-internal.md                    |    2 +-
 src/cmd/compile/internal/base/base.go              |    3 +-
 src/cmd/compile/internal/base/debug.go             |    1 -
 src/cmd/compile/internal/base/flag.go              |    2 -
 src/cmd/compile/internal/escape/call.go            |    9 +
 src/cmd/compile/internal/escape/escape.go          |    4 +
 src/cmd/compile/internal/gc/main.go                |   12 -
 src/cmd/compile/internal/gc/obj.go                 |    8 +
 src/cmd/compile/internal/importer/iimport.go       |   22 +-
 src/cmd/compile/internal/importer/support.go       |   15 +
 .../{noder/reader2.go => importer/ureader.go}      |  274 ++--
 src/cmd/compile/internal/ir/copy.go                |    2 +-
 src/cmd/compile/internal/ir/expr.go                |    5 +-
 src/cmd/compile/internal/ir/fmt.go                 |   52 +-
 src/cmd/compile/internal/ir/func.go                |    9 +-
 src/cmd/compile/internal/ir/name.go                |   20 -
 src/cmd/compile/internal/ir/node.go                |   10 +-
 src/cmd/compile/internal/ir/node_gen.go            |  123 --
 src/cmd/compile/internal/ir/op_string.go           |  313 +++--
 src/cmd/compile/internal/ir/sizeof_test.go         |    2 +-
 src/cmd/compile/internal/ir/type.go                |  116 --
 src/cmd/compile/internal/noder/codes.go            |   65 +-
 src/cmd/compile/internal/noder/decoder.go          |  302 ----
 src/cmd/compile/internal/noder/encoder.go          |  285 ----
 src/cmd/compile/internal/noder/expr.go             |   53 +-
 src/cmd/compile/internal/noder/helpers.go          |   89 --
 src/cmd/compile/internal/noder/import.go           |  175 ---
 src/cmd/compile/internal/noder/irgen.go            |    9 -
 src/cmd/compile/internal/noder/linker.go           |  174 ++-
 src/cmd/compile/internal/noder/noder.go            | 1444 +-------------------
 src/cmd/compile/internal/noder/quirks.go           |  369 -----
 src/cmd/compile/internal/noder/reader.go           |  408 +++---
 src/cmd/compile/internal/noder/stencil.go          |   28 +-
 src/cmd/compile/internal/noder/sync.go             |  187 ---
 .../compile/internal/noder/syncmarker_string.go    |  156 ---
 src/cmd/compile/internal/noder/transform.go        |    6 -
 src/cmd/compile/internal/noder/unified.go          |  110 +-
 src/cmd/compile/internal/noder/unified_test.go     |  160 ---
 src/cmd/compile/internal/noder/writer.go           |  542 ++++----
 src/cmd/compile/internal/ppc64/ggen.go             |    7 +-
 src/cmd/compile/internal/reflectdata/reflect.go    |   10 +-
 src/cmd/compile/internal/ssa/debug_lines_test.go   |    4 +-
 src/cmd/compile/internal/ssa/gen/RISCV64.rules     |    4 +-
 src/cmd/compile/internal/ssa/poset.go              |    2 +-
 src/cmd/compile/internal/ssa/rewriteRISCV64.go     |   10 +-
 src/cmd/compile/internal/ssagen/ssa.go             |   32 +-
 src/cmd/compile/internal/staticinit/sched.go       |    1 -
 src/cmd/compile/internal/test/testdata/ptrsort.go  |    2 +-
 src/cmd/compile/internal/typecheck/dcl.go          |  131 --
 src/cmd/compile/internal/typecheck/expr.go         |   21 -
 src/cmd/compile/internal/typecheck/func.go         |   14 -
 src/cmd/compile/internal/typecheck/iexport.go      |   20 +-
 src/cmd/compile/internal/typecheck/iimport.go      |   11 +-
 src/cmd/compile/internal/typecheck/subr.go         |   96 +-
 src/cmd/compile/internal/typecheck/type.go         |  126 --
 src/cmd/compile/internal/typecheck/typecheck.go    |   52 +-
 src/cmd/compile/internal/types/fmt.go              |   33 +-
 src/cmd/compile/internal/types/universe.go         |    4 -
 src/cmd/compile/internal/types2/api.go             |   10 +-
 src/cmd/compile/internal/types2/api_test.go        |   68 +-
 src/cmd/compile/internal/types2/assignments.go     |   13 +-
 src/cmd/compile/internal/types2/builtins.go        |   28 +-
 src/cmd/compile/internal/types2/call.go            |    8 +-
 src/cmd/compile/internal/types2/check.go           |   58 +-
 src/cmd/compile/internal/types2/compilersupport.go |    8 +-
 src/cmd/compile/internal/types2/conversions.go     |    5 +-
 src/cmd/compile/internal/types2/decl.go            |    2 -
 src/cmd/compile/internal/types2/errors.go          |   11 +
 src/cmd/compile/internal/types2/expr.go            |   14 +-
 src/cmd/compile/internal/types2/index.go           |    6 +-
 src/cmd/compile/internal/types2/infer.go           |  205 ++-
 src/cmd/compile/internal/types2/instantiate.go     |    2 +-
 src/cmd/compile/internal/types2/interface.go       |   28 +-
 src/cmd/compile/internal/types2/lookup.go          |   29 +-
 src/cmd/compile/internal/types2/named.go           |   32 +-
 src/cmd/compile/internal/types2/predicates.go      |   15 +-
 src/cmd/compile/internal/types2/signature.go       |  139 +-
 src/cmd/compile/internal/types2/stmt.go            |   32 +-
 src/cmd/compile/internal/types2/subst.go           |   16 +-
 src/cmd/compile/internal/types2/termlist.go        |    9 -
 src/cmd/compile/internal/types2/termlist_test.go   |   29 -
 .../internal/types2/testdata/check/builtins.go2    |    6 +-
 .../internal/types2/testdata/check/builtins.src    |    8 +-
 .../types2/testdata/check/funcinference.go2        |   14 +-
 .../types2/testdata/check/typeinference.go2        |   12 +-
 .../internal/types2/testdata/check/typeparams.go2  |   12 +-
 .../types2/testdata/examples/inference.go2         |   18 +-
 .../internal/types2/testdata/examples/methods.go2  |    2 +-
 .../internal/types2/testdata/examples/types.go2    |    4 +-
 .../internal/types2/testdata/examples/typesets.go2 |    2 +-
 .../types2/testdata/fixedbugs/issue43527.go2       |    2 +-
 .../types2/testdata/fixedbugs/issue43671.go2       |    4 +-
 .../types2/testdata/fixedbugs/issue45548.go2       |    2 +-
 .../types2/testdata/fixedbugs/issue47115.go2       |    4 +-
 .../types2/testdata/fixedbugs/issue48619.go2       |   11 +-
 .../types2/testdata/fixedbugs/issue48656.go2       |   12 +-
 .../types2/testdata/fixedbugs/issue49482.go2       |   25 +
 .../types2/testdata/fixedbugs/issue49735.go2       |   11 +
 .../types2/testdata/fixedbugs/issue50417.go2       |    2 +-
 .../types2/testdata/fixedbugs/issue50755.go2       |   47 +
 .../types2/testdata/fixedbugs/issue51145.go        |   18 +
 .../types2/testdata/fixedbugs/issue51158.go2       |   18 +
 .../types2/testdata/fixedbugs/issue51229.go2       |  164 +++
 .../types2/testdata/fixedbugs/issue51232.go2       |   29 +
 .../types2/testdata/fixedbugs/issue51233.go2       |   25 +
 .../types2/testdata/fixedbugs/issue51257.go2       |   46 +
 .../types2/testdata/fixedbugs/issue51335.go2       |   16 +
 .../types2/testdata/fixedbugs/issue51339.go2       |   16 +
 .../types2/testdata/fixedbugs/issue51360.go        |   13 +
 .../types2/testdata/fixedbugs/issue51376.go2       |   24 +
 .../types2/testdata/fixedbugs/issue51386.go2       |   17 +
 .../types2/testdata/fixedbugs/issue51437.go        |   17 +
 src/cmd/compile/internal/types2/type.go            |   14 +-
 src/cmd/compile/internal/types2/typeparam.go       |   22 +-
 src/cmd/compile/internal/types2/typeset.go         |    5 +-
 src/cmd/compile/internal/types2/typexpr.go         |   22 +-
 src/cmd/compile/internal/types2/unify.go           |   91 +-
 src/cmd/compile/internal/types2/validtype.go       |    2 +-
 src/cmd/compile/internal/walk/closure.go           |   12 +-
 src/cmd/compile/internal/walk/complit.go           |    2 +-
 src/cmd/compile/internal/walk/order.go             |    9 +
 src/cmd/compile/internal/walk/select.go            |   25 +-
 src/cmd/dist/buildtool.go                          |    1 +
 src/cmd/dist/test.go                               |   23 +-
 src/cmd/go/alldocs.go                              |   45 +-
 src/cmd/go/internal/base/flag.go                   |    7 -
 src/cmd/go/internal/cfg/cfg.go                     |    6 +-
 src/cmd/go/internal/envcmd/env.go                  |    4 +
 src/cmd/go/internal/help/helpdoc.go                |    8 +
 src/cmd/go/internal/list/list.go                   |   99 +-
 src/cmd/go/internal/load/pkg.go                    |   22 +-
 src/cmd/go/internal/modcmd/download.go             |    1 -
 src/cmd/go/internal/modcmd/graph.go                |    1 -
 src/cmd/go/internal/modcmd/verify.go               |    1 -
 src/cmd/go/internal/modcmd/why.go                  |    1 -
 src/cmd/go/internal/modfetch/coderepo.go           |   53 +-
 src/cmd/go/internal/modfetch/coderepo_test.go      |   48 +
 src/cmd/go/internal/modfetch/fetch.go              |   11 +-
 src/cmd/go/internal/modload/import.go              |   18 +-
 src/cmd/go/internal/modload/init.go                |   37 +-
 src/cmd/go/internal/modload/load.go                |   30 +-
 src/cmd/go/internal/modload/modfile.go             |    2 +-
 src/cmd/go/internal/run/run.go                     |    6 +-
 src/cmd/go/internal/test/testflag.go               |    1 -
 src/cmd/go/internal/version/version.go             |    9 +-
 src/cmd/go/internal/vet/vet.go                     |    2 +
 src/cmd/go/internal/work/build.go                  |    9 -
 src/cmd/go/internal/work/exec.go                   |    1 +
 src/cmd/go/internal/workcmd/edit.go                |    9 +-
 src/cmd/go/internal/workcmd/init.go                |   13 +-
 src/cmd/go/internal/workcmd/sync.go                |    6 +-
 src/cmd/go/internal/workcmd/use.go                 |  149 +-
 src/cmd/go/internal/workcmd/work.go                |    8 +-
 src/cmd/go/testdata/script/build_internal.txt      |    2 +
 src/cmd/go/testdata/script/list_json_fields.txt    |   52 +
 .../go/testdata/script/mod_download_partial.txt    |   11 +-
 src/cmd/go/testdata/script/mod_fs_patterns.txt     |    6 +-
 src/cmd/go/testdata/script/mod_list_dir.txt        |    2 +-
 .../go/testdata/script/mod_list_replace_dir.txt    |    2 +-
 src/cmd/go/testdata/script/run_issue51125.txt      |   54 +
 src/cmd/go/testdata/script/run_work_versioned.txt  |   16 +
 src/cmd/go/testdata/script/test_fuzz_return.txt    |   19 +
 .../go/testdata/script/test_relative_cmdline.txt   |    4 +-
 src/cmd/go/testdata/script/work.txt                |   12 +-
 src/cmd/go/testdata/script/work_edit.txt           |   13 +-
 src/cmd/go/testdata/script/work_env.txt            |    4 +
 src/cmd/go/testdata/script/work_gowork.txt         |   24 +
 src/cmd/go/testdata/script/work_init_gowork.txt    |   19 +
 src/cmd/go/testdata/script/work_init_path.txt      |   17 +
 src/cmd/go/testdata/script/work_issue51204.txt     |   57 +
 .../testdata/script/work_module_not_in_go_work.txt |   25 +
 src/cmd/go/testdata/script/work_nowork.txt         |   10 +-
 .../go/testdata/script/work_replace_conflict.txt   |    6 +-
 src/cmd/go/testdata/script/work_use.txt            |   10 +-
 src/cmd/go/testdata/script/work_use_deleted.txt    |   22 +
 src/cmd/go/testdata/script/work_use_dot.txt        |   30 +-
 src/cmd/go/testdata/script/work_use_noargs.txt     |   11 +
 src/cmd/go/testdata/script/work_vet.txt            |   19 +
 src/cmd/go/testdata/script/work_workfile.txt       |   21 -
 src/cmd/gofmt/gofmt.go                             |  128 +-
 src/cmd/internal/obj/link.go                       |    1 +
 src/cmd/internal/obj/objfile.go                    |    1 +
 src/cmd/internal/obj/ppc64/asm9.go                 |    8 +-
 .../obj/riscv/testdata/testbranch/branch_test.go   |    1 +
 .../obj/riscv/testdata/testbranch/branch_test.s    |    1 +
 src/cmd/internal/objabi/funcdata.go                |    1 +
 src/cmd/internal/src/pos.go                        |    5 +-
 src/cmd/internal/src/pos_test.go                   |   14 +-
 src/cmd/link/internal/ld/dwarf.go                  |    5 +
 src/cmd/link/internal/ld/symtab.go                 |    1 +
 src/compress/gzip/gunzip.go                        |    4 +-
 src/compress/gzip/gunzip_test.go                   |   80 +-
 src/crypto/aes/asm_amd64.s                         |   12 +-
 src/crypto/aes/asm_ppc64le.s                       |  225 +++
 src/crypto/aes/cbc_ppc64le.go                      |   71 +
 src/crypto/cipher/cbc.go                           |   22 +
 src/crypto/cipher/export_test.go                   |    2 +
 src/crypto/cipher/fuzz_test.go                     |  103 ++
 src/crypto/ed25519/ed25519.go                      |   25 +-
 .../ed25519/internal/edwards25519/edwards25519.go  |    6 +-
 .../ed25519/internal/edwards25519/field/fe.go      |   40 +-
 .../internal/edwards25519/field/fe_alias_test.go   |   18 +-
 .../internal/edwards25519/field/fe_generic.go      |    2 +
 .../ed25519/internal/edwards25519/field/fe_test.go |   16 +-
 src/crypto/ed25519/internal/edwards25519/scalar.go |   25 +-
 .../ed25519/internal/edwards25519/scalar_test.go   |    6 +-
 src/crypto/rand/eagain.go                          |   27 -
 src/crypto/rand/rand_plan9.go                      |  109 ++
 src/crypto/rand/rand_unix.go                       |  120 +-
 src/crypto/sha256/sha256block_decl.go              |    2 +-
 src/crypto/sha256/sha256block_generic.go           |    2 +-
 ...{sha256block_ppc64le.s => sha256block_ppc64x.s} |   84 +-
 src/crypto/sha512/sha512block_decl.go              |    2 +-
 src/crypto/sha512/sha512block_generic.go           |    2 +-
 ...{sha512block_ppc64le.s => sha512block_ppc64x.s} |   80 +-
 src/crypto/x509/internal/macos/corefoundation.go   |    8 +-
 src/database/sql/fakedb_test.go                    |    3 +
 src/database/sql/sql_test.go                       |   31 +-
 src/debug/buildinfo/buildinfo.go                   |    4 +-
 src/debug/buildinfo/buildinfo_test.go              |   10 +-
 src/encoding/binary/binary.go                      |   73 +-
 src/encoding/binary/binary_test.go                 |  114 +-
 src/encoding/json/encode.go                        |    6 +-
 src/encoding/xml/marshal.go                        |    2 +-
 src/encoding/xml/marshal_test.go                   |   36 +
 src/go/build/deps_test.go                          |    2 +
 src/go/doc/reader.go                               |    1 +
 src/go/doc/testdata/b.0.golden                     |    3 +
 src/go/doc/testdata/b.1.golden                     |    6 +
 src/go/doc/testdata/b.2.golden                     |    3 +
 src/go/doc/testdata/b.go                           |    6 +
 src/go/internal/gcimporter/iimport.go              |   23 +-
 src/go/parser/parser.go                            |  161 ++-
 src/go/parser/short_test.go                        |   14 +-
 src/go/parser/testdata/issue49482.go2              |   35 +
 src/go/parser/testdata/typeparams.src              |    2 +-
 src/go/printer/nodes.go                            |   28 +
 src/go/printer/testdata/generics.golden            |   26 +
 src/go/printer/testdata/generics.input             |   26 +
 src/go/token/token.go                              |    5 +-
 src/go/types/api.go                                |   10 +-
 src/go/types/api_test.go                           |   64 +-
 src/go/types/assignments.go                        |   13 +-
 src/go/types/builtins.go                           |   28 +-
 src/go/types/call.go                               |    9 +-
 src/go/types/check.go                              |   71 +-
 src/go/types/conversions.go                        |    5 +-
 src/go/types/decl.go                               |    2 -
 src/go/types/errorcodes.go                         |    7 +-
 src/go/types/errors.go                             |   11 +
 src/go/types/expr.go                               |   14 +-
 src/go/types/index.go                              |    5 +-
 src/go/types/infer.go                              |  205 ++-
 src/go/types/instantiate.go                        |    2 +-
 src/go/types/interface.go                          |   28 +-
 src/go/types/lookup.go                             |   29 +-
 src/go/types/named.go                              |   32 +-
 src/go/types/predicates.go                         |   15 +-
 src/go/types/signature.go                          |  144 +-
 src/go/types/stmt.go                               |   27 +-
 src/go/types/subst.go                              |   16 +-
 src/go/types/termlist.go                           |    9 -
 src/go/types/termlist_test.go                      |   29 -
 src/go/types/testdata/check/builtins.go2           |    6 +-
 src/go/types/testdata/check/builtins.src           |    8 +-
 src/go/types/testdata/check/funcinference.go2      |   12 +-
 src/go/types/testdata/check/typeinference.go2      |   12 +-
 src/go/types/testdata/check/typeparams.go2         |   12 +-
 src/go/types/testdata/examples/inference.go2       |   18 +-
 src/go/types/testdata/examples/methods.go2         |    2 +-
 src/go/types/testdata/examples/types.go2           |    4 +-
 src/go/types/testdata/examples/typesets.go2        |    2 +-
 src/go/types/testdata/fixedbugs/issue43527.go2     |    2 +-
 src/go/types/testdata/fixedbugs/issue43671.go2     |    4 +-
 src/go/types/testdata/fixedbugs/issue45548.go2     |    2 +-
 src/go/types/testdata/fixedbugs/issue47115.go2     |    4 +-
 src/go/types/testdata/fixedbugs/issue48619.go2     |   11 +-
 src/go/types/testdata/fixedbugs/issue48656.go2     |   12 +-
 src/go/types/testdata/fixedbugs/issue49482.go2     |   28 +
 src/go/types/testdata/fixedbugs/issue49735.go2     |   11 +
 src/go/types/testdata/fixedbugs/issue50417.go2     |    2 +-
 src/go/types/testdata/fixedbugs/issue50755.go2     |   47 +
 src/go/types/testdata/fixedbugs/issue51145.go      |   18 +
 src/go/types/testdata/fixedbugs/issue51158.go2     |   18 +
 src/go/types/testdata/fixedbugs/issue51229.go2     |  164 +++
 src/go/types/testdata/fixedbugs/issue51232.go2     |   29 +
 src/go/types/testdata/fixedbugs/issue51233.go2     |   25 +
 src/go/types/testdata/fixedbugs/issue51257.go2     |   46 +
 src/go/types/testdata/fixedbugs/issue51335.go2     |   16 +
 src/go/types/testdata/fixedbugs/issue51339.go2     |   16 +
 src/go/types/testdata/fixedbugs/issue51360.go      |   13 +
 src/go/types/testdata/fixedbugs/issue51376.go2     |   24 +
 src/go/types/testdata/fixedbugs/issue51386.go2     |   17 +
 src/go/types/testdata/fixedbugs/issue51437.go      |   17 +
 src/go/types/type.go                               |   14 +-
 src/go/types/typeparam.go                          |   22 +-
 src/go/types/typeset.go                            |    5 +-
 src/go/types/typexpr.go                            |   22 +-
 src/go/types/unify.go                              |   91 +-
 src/go/types/validtype.go                          |    2 +-
 src/internal/cfg/cfg.go                            |    1 +
 src/internal/goversion/goversion.go                |    2 +-
 src/internal/pkgbits/codes.go                      |   60 +
 src/internal/pkgbits/decoder.go                    |  336 +++++
 src/internal/pkgbits/encoder.go                    |  287 ++++
 .../noder => internal/pkgbits}/frames_go1.go       |    2 +-
 .../noder => internal/pkgbits}/frames_go17.go      |    2 +-
 .../internal/noder => internal/pkgbits}/reloc.go   |   38 +-
 src/internal/pkgbits/support.go                    |   17 +
 src/internal/pkgbits/sync.go                       |  125 ++
 src/internal/pkgbits/syncmarker_string.go          |   87 ++
 src/math/big/intmarsh.go                           |    5 +-
 src/math/big/intmarsh_test.go                      |   13 +
 src/net/dnsclient_unix.go                          |   19 +-
 src/net/dnsclient_unix_test.go                     |   57 +-
 src/net/http/transport.go                          |    6 +
 src/net/http/transport_internal_test.go            |    9 +-
 src/net/lookup_test.go                             |   69 +-
 src/net/net.go                                     |   12 +
 src/net/net_test.go                                |   64 +-
 src/net/smtp/auth.go                               |    3 +-
 src/os/example_test.go                             |   22 +
 src/os/os_test.go                                  |   40 +-
 src/reflect/all_test.go                            |   29 +-
 src/reflect/asm_arm64.s                            |   14 +-
 src/reflect/value.go                               |   26 +-
 src/regexp/regexp.go                               |    2 +-
 src/regexp/syntax/parse.go                         |   72 +-
 src/regexp/syntax/parse_test.go                    |    7 +
 src/runtime/asm_386.s                              |   33 +-
 src/runtime/crash_cgo_test.go                      |   14 +-
 src/runtime/crash_unix_test.go                     |    2 +-
 src/runtime/debug/mod.go                           |  157 ++-
 src/runtime/debug/mod_test.go                      |   75 +
 src/runtime/defs1_netbsd_386.go                    |    1 -
 src/runtime/defs1_netbsd_amd64.go                  |    1 -
 src/runtime/defs1_netbsd_arm.go                    |    1 -
 src/runtime/defs1_netbsd_arm64.go                  |    1 -
 src/runtime/defs1_solaris_amd64.go                 |    1 -
 src/runtime/defs_dragonfly.go                      |    1 -
 src/runtime/defs_dragonfly_amd64.go                |    1 -
 src/runtime/defs_freebsd.go                        |    1 -
 src/runtime/defs_freebsd_386.go                    |    1 -
 src/runtime/defs_freebsd_amd64.go                  |    1 -
 src/runtime/defs_freebsd_arm.go                    |    1 -
 src/runtime/defs_freebsd_arm64.go                  |    1 -
 src/runtime/defs_linux.go                          |    3 +-
 src/runtime/defs_linux_386.go                      |    3 +-
 src/runtime/defs_linux_amd64.go                    |    3 +-
 src/runtime/defs_linux_arm.go                      |    2 +-
 src/runtime/defs_linux_arm64.go                    |    3 +-
 src/runtime/defs_linux_mips64x.go                  |    3 +-
 src/runtime/defs_linux_mipsx.go                    |    3 +-
 src/runtime/defs_linux_ppc64.go                    |    3 +-
 src/runtime/defs_linux_ppc64le.go                  |    3 +-
 src/runtime/defs_linux_riscv64.go                  |    3 +-
 src/runtime/defs_linux_s390x.go                    |    3 +-
 src/runtime/defs_netbsd.go                         |    1 -
 src/runtime/defs_openbsd.go                        |    1 -
 src/runtime/defs_openbsd_386.go                    |    1 -
 src/runtime/defs_openbsd_amd64.go                  |    1 -
 src/runtime/defs_openbsd_arm.go                    |    1 -
 src/runtime/defs_openbsd_arm64.go                  |    1 -
 src/runtime/defs_openbsd_mips64.go                 |    1 -
 src/runtime/defs_solaris.go                        |    1 -
 src/runtime/export_aix_test.go                     |    1 +
 src/runtime/export_darwin_test.go                  |    2 +
 src/runtime/export_pipe2_test.go                   |    6 +-
 src/runtime/export_test.go                         |   20 +
 src/runtime/export_unix_test.go                    |    1 -
 src/runtime/funcdata.h                             |    1 +
 src/runtime/histogram.go                           |   52 +-
 src/runtime/histogram_test.go                      |   40 +
 src/runtime/internal/atomic/atomic_arm.s           |   42 +-
 src/runtime/internal/syscall/asm_linux_386.s       |   34 +
 src/runtime/internal/syscall/asm_linux_amd64.s     |   33 +
 src/runtime/internal/syscall/asm_linux_arm.s       |   32 +
 src/runtime/internal/syscall/asm_linux_arm64.s     |   29 +
 src/runtime/internal/syscall/asm_linux_mips64x.s   |   29 +
 src/runtime/internal/syscall/asm_linux_mipsx.s     |   34 +
 src/runtime/internal/syscall/asm_linux_ppc64x.s    |   28 +
 src/runtime/internal/syscall/asm_linux_riscv64.s   |   29 +
 src/runtime/internal/syscall/asm_linux_s390x.s     |   28 +
 src/runtime/internal/syscall/syscall_linux.go      |   12 +
 src/runtime/memmove_ppc64x.s                       |   46 +-
 src/runtime/mfinal.go                              |   24 +-
 src/runtime/mfinal_test.go                         |    9 +
 src/runtime/mgcpacer.go                            |   72 +-
 src/runtime/mgcpacer_test.go                       |   45 +
 src/runtime/mgcscavenge.go                         |   58 +-
 src/runtime/mkpreempt.go                           |   41 +-
 src/runtime/nbpipe_pipe2.go                        |   13 +-
 src/runtime/nbpipe_pipe_test.go                    |   38 +
 src/runtime/nbpipe_test.go                         |   25 -
 src/runtime/os3_solaris.go                         |   22 +-
 src/runtime/os_aix.go                              |    9 +
 src/runtime/os_darwin.go                           |    9 +
 src/runtime/os_dragonfly.go                        |   11 +-
 src/runtime/os_freebsd.go                          |   11 +-
 src/runtime/os_linux.go                            |  214 ++-
 src/runtime/os_netbsd.go                           |   11 +-
 src/runtime/os_openbsd.go                          |    9 +
 src/runtime/os_openbsd_syscall2.go                 |    2 -
 src/runtime/pprof/pprof_test.go                    |   67 +-
 src/runtime/preempt_arm64.s                        |  178 +--
 src/runtime/proc.go                                |  304 +----
 src/runtime/proc_runtime_test.go                   |   17 +
 src/runtime/race_arm64.s                           |   18 +-
 src/runtime/runtime-gdb_test.go                    |    8 +
 src/runtime/runtime2.go                            |   19 +-
 src/runtime/signal_unix.go                         |   16 +
 src/runtime/sigqueue.go                            |   48 +-
 src/runtime/sigqueue_plan9.go                      |    7 -
 src/runtime/symtab.go                              |    1 +
 src/runtime/sys_darwin.go                          |   56 +-
 src/runtime/sys_darwin_amd64.s                     |    9 +-
 src/runtime/sys_darwin_arm64.s                     |    9 +-
 src/runtime/sys_dragonfly_amd64.s                  |   30 -
 src/runtime/sys_freebsd_386.s                      |   32 -
 src/runtime/sys_freebsd_amd64.s                    |   30 -
 src/runtime/sys_freebsd_arm.s                      |   32 -
 src/runtime/sys_freebsd_arm64.s                    |   26 -
 src/runtime/sys_linux_386.s                        |   24 -
 src/runtime/sys_linux_amd64.s                      |   24 -
 src/runtime/sys_linux_arm.s                        |   23 -
 src/runtime/sys_linux_arm64.s                      |  168 ++-
 src/runtime/sys_linux_mips64x.s                    |   26 -
 src/runtime/sys_linux_mipsx.s                      |   33 -
 src/runtime/sys_linux_ppc64x.s                     |   20 -
 src/runtime/sys_linux_riscv64.s                    |   24 -
 src/runtime/sys_linux_s390x.s                      |   24 -
 src/runtime/sys_netbsd_386.s                       |   32 -
 src/runtime/sys_netbsd_amd64.s                     |   30 -
 src/runtime/sys_netbsd_arm.s                       |   28 -
 src/runtime/sys_netbsd_arm64.s                     |   24 -
 src/runtime/sys_openbsd2.go                        |   10 -
 src/runtime/sys_openbsd_mips64.s                   |   26 -
 src/runtime/testdata/testprogcgo/aprof.go          |    2 +-
 src/runtime/trace.go                               |   18 +-
 src/runtime/traceback.go                           |    6 +-
 src/sort/gen_sort_variants.go                      |  526 +++++++
 src/sort/genzfunc.go                               |  127 --
 src/sort/sort.go                                   |  337 +----
 src/sort/zfuncversion.go                           |  265 ----
 src/sort/zsortfunc.go                              |  342 +++++
 src/sort/zsortinterface.go                         |  342 +++++
 src/strings/builder.go                             |    7 +-
 src/strings/strings.go                             |    4 +
 src/syscall/asm_linux_ppc64x.s                     |   10 +-
 src/syscall/syscall_linux.go                       |   90 +-
 src/syscall/syscall_linux_386.go                   |   14 -
 src/syscall/syscall_linux_amd64.go                 |    7 -
 src/syscall/syscall_linux_arm.go                   |    7 -
 src/syscall/syscall_linux_arm64.go                 |    7 -
 src/syscall/syscall_linux_mips64x.go               |    7 -
 src/syscall/syscall_linux_mipsx.go                 |    7 -
 src/syscall/syscall_linux_ppc64x.go                |    7 -
 src/syscall/syscall_linux_riscv64.go               |    7 -
 src/syscall/syscall_linux_s390x.go                 |   14 -
 src/syscall/syscall_linux_test.go                  |   71 +
 src/syscall/syscall_unix_test.go                   |   21 +-
 src/syscall/zsyscall_linux_amd64.go                |   11 -
 src/syscall/zsyscall_linux_arm.go                  |   11 -
 src/syscall/zsyscall_linux_arm64.go                |   11 -
 src/syscall/zsyscall_linux_mips.go                 |   11 -
 src/syscall/zsyscall_linux_mips64.go               |   11 -
 src/syscall/zsyscall_linux_mips64le.go             |   11 -
 src/syscall/zsyscall_linux_mipsle.go               |   11 -
 src/syscall/zsyscall_linux_ppc64.go                |   11 -
 src/syscall/zsyscall_linux_ppc64le.go              |   11 -
 src/syscall/zsyscall_linux_riscv64.go              |   11 -
 src/testing/fuzz.go                                |    3 +
 src/testing/testing.go                             |    2 +-
 src/testing/testing_other.go                       |    6 +-
 src/testing/testing_windows.go                     |   22 +-
 src/time/format.go                                 |    1 +
 src/unicode/utf8/utf8.go                           |    5 +
 src/unicode/utf8/utf8_test.go                      |   58 +
 test/codegen/maps.go                               |   30 +
 test/const7.go                                     |   10 +-
 test/fixedbugs/bug255.go                           |   13 +-
 test/fixedbugs/bug515.go                           |   21 +
 test/fixedbugs/issue14652.go                       |    2 +-
 test/fixedbugs/issue44432.go                       |    2 +-
 test/fixedbugs/issue48301.go                       |    2 +-
 test/fixedbugs/issue48471.go                       |    2 +-
 test/fixedbugs/issue49143.go                       |    2 +-
 test/fixedbugs/issue49368.go                       |    2 +-
 test/fixedbugs/issue49619.go                       |    2 +-
 test/fixedbugs/issue49665.go                       |    2 +-
 test/fixedbugs/issue49814.go                       |    2 +-
 test/fixedbugs/issue50372.go                       |    2 +-
 test/fixedbugs/issue51101.go                       |   36 +
 test/fixedbugs/issue51401.go                       |   44 +
 test/fixedbugs/issue51437.go                       |   19 +
 test/run.go                                        |  224 +--
 test/typeparam/absdiff.go                          |    2 +-
 test/typeparam/absdiff2.go                         |    2 +-
 test/typeparam/absdiff3.go                         |    2 +-
 test/typeparam/absdiffimp.go                       |    2 +-
 test/typeparam/absdiffimp2.go                      |    2 +-
 test/typeparam/adder.go                            |    2 +-
 test/typeparam/aliasimp.go                         |    2 +-
 test/typeparam/append.go                           |    2 +-
 test/typeparam/boundmethod.go                      |    2 +-
 test/typeparam/builtins.go                         |    2 +-
 test/typeparam/chans.go                            |    2 +-
 test/typeparam/chansimp.go                         |    2 +-
 test/typeparam/combine.go                          |    2 +-
 test/typeparam/cons.go                             |    2 +-
 test/typeparam/dedup.go                            |    2 +-
 test/typeparam/dictionaryCapture-noinline.go       |    2 +-
 test/typeparam/dictionaryCapture.go                |    2 +-
 test/typeparam/dottype.go                          |    2 +-
 test/typeparam/double.go                           |    2 +-
 test/typeparam/eface.go                            |    2 +-
 test/typeparam/equal.go                            |    2 +-
 test/typeparam/fact.go                             |    2 +-
 test/typeparam/factimp.go                          |    2 +-
 test/typeparam/gencrawler.go                       |    2 +-
 test/typeparam/genembed.go                         |    2 +-
 test/typeparam/genembed2.go                        |    2 +-
 test/typeparam/geninline.go                        |    2 +-
 test/typeparam/graph.go                            |    2 +-
 test/typeparam/ifaceconv.go                        |    2 +-
 test/typeparam/importtest.go                       |    2 +-
 test/typeparam/index.go                            |    2 +-
 test/typeparam/index2.go                           |    2 +-
 test/typeparam/interfacearg.go                     |    2 +-
 test/typeparam/issue23536.go                       |    2 +-
 test/typeparam/issue376214.go                      |    2 +-
 test/typeparam/issue39755.go                       |    2 +-
 test/typeparam/issue44688.go                       |    2 +-
 test/typeparam/issue45547.go                       |    2 +-
 test/typeparam/issue45722.go                       |    2 +-
 test/typeparam/issue45738.go                       |    2 +-
 test/typeparam/issue45817.go                       |    2 +-
 test/typeparam/issue46461.go                       |    2 +-
 test/typeparam/issue46461b.go                      |    2 +-
 test/typeparam/issue46472.go                       |    2 +-
 test/typeparam/issue46591.go                       |    2 +-
 test/typeparam/issue47258.go                       |    2 +-
 test/typeparam/issue47272.go                       |    2 +-
 test/typeparam/issue47514.go                       |    2 +-
 test/typeparam/issue47514b.go                      |    2 +-
 test/typeparam/issue47514c.go                      |    2 +-
 test/typeparam/issue47631.go                       |    2 +-
 test/typeparam/issue47676.go                       |    2 +-
 test/typeparam/issue47684.go                       |    2 +-
 test/typeparam/issue47684b.go                      |    2 +-
 test/typeparam/issue47684c.go                      |    2 +-
 test/typeparam/issue47708.go                       |    2 +-
 test/typeparam/issue47710.go                       |    2 +-
 test/typeparam/issue47713.go                       |    2 +-
 test/typeparam/issue47716.go                       |    2 +-
 test/typeparam/issue47723.go                       |    2 +-
 test/typeparam/issue47740.go                       |    2 +-
 test/typeparam/issue47740b.go                      |    2 +-
 test/typeparam/issue47775.go                       |    2 +-
 test/typeparam/issue47775b.go                      |    2 +-
 test/typeparam/issue47797.go                       |    2 +-
 test/typeparam/issue47877.go                       |    2 +-
 test/typeparam/issue47878.go                       |    2 +-
 test/typeparam/issue47892.go                       |    2 +-
 test/typeparam/issue47892b.go                      |    2 +-
 test/typeparam/issue47896.go                       |    2 +-
 test/typeparam/issue47901.go                       |    2 +-
 test/typeparam/issue47924.go                       |    2 +-
 test/typeparam/issue47925.go                       |    2 +-
 test/typeparam/issue47925b.go                      |    2 +-
 test/typeparam/issue47925c.go                      |    2 +-
 test/typeparam/issue47925d.go                      |    2 +-
 test/typeparam/issue47929.go                       |    2 +-
 test/typeparam/issue47948.go                       |    2 +-
 test/typeparam/issue47966.go                       |    2 +-
 test/typeparam/issue48013.go                       |    2 +-
 test/typeparam/issue48016.go                       |    2 +-
 test/typeparam/issue48030.go                       |    2 +-
 test/typeparam/issue48042.go                       |    2 +-
 test/typeparam/issue48047.go                       |    2 +-
 test/typeparam/issue48049.go                       |    2 +-
 test/typeparam/issue48056.go                       |    2 +-
 test/typeparam/issue48094.go                       |    2 +-
 test/typeparam/issue48094b.go                      |    2 +-
 test/typeparam/issue48137.go                       |    2 +-
 test/typeparam/issue48185b.go                      |    2 +-
 test/typeparam/issue48191.go                       |    2 +-
 test/typeparam/issue48198.go                       |    2 +-
 test/typeparam/issue48225.go                       |    2 +-
 test/typeparam/issue48253.go                       |    2 +-
 test/typeparam/issue48276a.go                      |    2 +-
 test/typeparam/issue48276b.go                      |    2 +-
 test/typeparam/issue48280.go                       |    2 +-
 test/typeparam/issue48306.go                       |    2 +-
 test/typeparam/issue48317.go                       |    2 +-
 test/typeparam/issue48318.go                       |    2 +-
 test/typeparam/issue48337a.go                      |    2 +-
 test/typeparam/issue48337b.go                      |    2 +-
 test/typeparam/issue48344.go                       |    2 +-
 test/typeparam/issue48424.go                       |   12 +-
 test/typeparam/issue48453.go                       |    2 +-
 test/typeparam/issue48454.go                       |    2 +-
 test/typeparam/issue48462.go                       |    2 +-
 test/typeparam/issue48537.go                       |    2 +-
 test/typeparam/issue48538.go                       |    2 +-
 test/typeparam/issue48598.go                       |    2 +-
 test/typeparam/issue48602.go                       |    2 +-
 test/typeparam/issue48604.go                       |    2 +-
 test/typeparam/issue48609.go                       |    2 +-
 test/typeparam/issue48617.go                       |    2 +-
 test/typeparam/issue48645a.go                      |    2 +-
 test/typeparam/issue48645b.go                      |    2 +-
 test/typeparam/issue48711.go                       |    2 +-
 test/typeparam/issue48716.go                       |    2 +-
 test/typeparam/issue48838.go                       |    2 +-
 test/typeparam/issue48962.go                       |    2 +-
 test/typeparam/issue49027.go                       |    2 +-
 test/typeparam/issue49049.go                       |    2 +-
 test/typeparam/issue49241.go                       |    2 +-
 test/typeparam/issue49246.go                       |    2 +-
 test/typeparam/issue49295.go                       |    2 +-
 test/typeparam/issue49309.go                       |    2 +-
 test/typeparam/issue49421.go                       |    2 +-
 test/typeparam/issue49432.go                       |    2 +-
 test/typeparam/issue49497.go                       |    2 +-
 test/typeparam/issue49516.go                       |    2 +-
 test/typeparam/issue49524.go                       |    2 +-
 test/typeparam/issue49538.go                       |    2 +-
 test/typeparam/issue49547.go                       |    2 +-
 test/typeparam/issue49611.go                       |    2 +-
 test/typeparam/issue49659.go                       |    2 +-
 test/typeparam/issue49659b.go                      |    2 +-
 test/typeparam/issue49667.go                       |    2 +-
 test/typeparam/issue49875.go                       |    2 +-
 test/typeparam/issue49893.go                       |    2 +-
 test/typeparam/issue50002.go                       |    2 +-
 test/typeparam/issue50109.go                       |    2 +-
 test/typeparam/issue50109b.go                      |    2 +-
 test/typeparam/issue50121.go                       |    2 +-
 test/typeparam/issue50121b.go                      |    2 +-
 test/typeparam/issue50147.go                       |    2 +-
 test/typeparam/issue50177.go                       |    2 +-
 test/typeparam/issue50193.go                       |    2 +-
 test/typeparam/issue50259.go                       |    2 +-
 test/typeparam/issue50264.go                       |    2 +-
 test/typeparam/issue50317.go                       |    2 +-
 test/typeparam/issue50417.go                       |    6 +-
 test/typeparam/issue50417b.go                      |    2 +-
 test/typeparam/issue50419.go                       |    2 +-
 test/typeparam/issue50437.go                       |    2 +-
 test/typeparam/issue50481b.go                      |    2 +-
 test/typeparam/issue50481c.go                      |    2 +-
 test/typeparam/issue50485.go                       |    2 +-
 test/typeparam/issue50486.go                       |    2 +-
 test/typeparam/issue50552.go                       |    2 +-
 test/typeparam/issue50561.go                       |    2 +-
 test/typeparam/issue50598.go                       |    2 +-
 test/typeparam/issue50642.go                       |    2 +-
 test/typeparam/issue50690a.go                      |    2 +-
 test/typeparam/issue50690b.go                      |    2 +-
 test/typeparam/issue50690c.go                      |    2 +-
 test/typeparam/issue50833.go                       |    2 +-
 test/typeparam/issue50841.go                       |    2 +-
 test/typeparam/issue50993.go                       |    2 +-
 test/typeparam/issue51219.dir/a.go                 |   20 +
 test/typeparam/issue51219.dir/main.go              |   16 +
 test/typeparam/issue51219.go                       |    7 +
 test/typeparam/issue51219.out                      |    1 +
 test/typeparam/issue51219b.dir/a.go                |   37 +
 test/typeparam/issue51219b.dir/b.go                |   14 +
 test/typeparam/issue51219b.dir/p.go                |   14 +
 test/typeparam/issue51219b.go                      |    7 +
 test/typeparam/issue51232.go                       |   31 +
 test/typeparam/issue51233.go                       |   22 +
 test/typeparam/issue51236.go                       |   22 +
 test/typeparam/issue51245.go                       |   16 +
 test/typeparam/issue51250a.dir/a.go                |    9 +
 test/typeparam/issue51250a.dir/b.go                |   24 +
 test/typeparam/issue51250a.dir/main.go             |   24 +
 test/typeparam/issue51250a.go                      |    7 +
 test/typeparam/issue51303.go                       |   65 +
 test/typeparam/issue51303.out                      |    4 +
 test/typeparam/issue51355.go                       |   31 +
 test/typeparam/issue51367.dir/a.go                 |   14 +
 test/typeparam/issue51367.dir/main.go              |   13 +
 test/typeparam/issue51367.go                       |    7 +
 test/typeparam/list.go                             |    2 +-
 test/typeparam/list2.go                            |    2 +-
 test/typeparam/listimp.go                          |    2 +-
 test/typeparam/listimp2.go                         |    2 +-
 test/typeparam/lockable.go                         |    2 +-
 test/typeparam/map.go                              |    2 +-
 test/typeparam/mapimp.go                           |    2 +-
 test/typeparam/maps.go                             |    2 +-
 test/typeparam/mapsimp.go                          |    2 +-
 test/typeparam/mdempsky/1.go                       |    2 +-
 test/typeparam/mdempsky/10.go                      |    2 +-
 test/typeparam/mdempsky/12.go                      |    2 +-
 test/typeparam/mdempsky/13.go                      |    2 +-
 test/typeparam/mdempsky/14.go                      |    2 +-
 test/typeparam/mdempsky/15.go                      |    2 +-
 test/typeparam/mdempsky/2.go                       |    2 +-
 test/typeparam/mdempsky/3.go                       |    2 +-
 test/typeparam/mdempsky/4.go                       |    2 +-
 test/typeparam/mdempsky/5.go                       |    2 +-
 test/typeparam/mdempsky/6.go                       |    2 +-
 test/typeparam/mdempsky/7.go                       |    2 +-
 test/typeparam/mdempsky/8.go                       |    2 +-
 test/typeparam/mdempsky/9.go                       |    2 +-
 test/typeparam/metrics.go                          |    2 +-
 test/typeparam/min.go                              |    2 +-
 test/typeparam/mincheck.go                         |    2 +-
 test/typeparam/minimp.go                           |    2 +-
 test/typeparam/mutualimp.go                        |    2 +-
 test/typeparam/nested.go                           |    2 +-
 test/typeparam/ordered.go                          |    2 +-
 test/typeparam/orderedmap.go                       |    2 +-
 test/typeparam/orderedmapsimp.go                   |    2 +-
 test/typeparam/pair.go                             |    2 +-
 test/typeparam/pairimp.go                          |    2 +-
 test/typeparam/pragma.go                           |    2 +-
 test/typeparam/recoverimp.go                       |    2 +-
 test/typeparam/select.go                           |    2 +-
 test/typeparam/sets.go                             |    2 +-
 test/typeparam/setsimp.go                          |    2 +-
 test/typeparam/settable.go                         |    4 +-
 test/typeparam/shape1.go                           |    2 +-
 test/typeparam/sliceimp.go                         |    2 +-
 test/typeparam/slices.go                           |    2 +-
 test/typeparam/smallest.go                         |    2 +-
 test/typeparam/smoketest.go                        |    2 +-
 test/typeparam/stringable.go                       |    2 +-
 test/typeparam/stringer.go                         |    2 +-
 test/typeparam/stringerimp.go                      |    2 +-
 test/typeparam/struct.go                           |    2 +-
 test/typeparam/structinit.go                       |    2 +-
 test/typeparam/subdict.go                          |    2 +-
 test/typeparam/sum.go                              |    2 +-
 test/typeparam/tparam1.go                          |    2 +-
 test/typeparam/typelist.go                         |   26 +-
 test/typeparam/typeswitch1.go                      |    2 +-
 test/typeparam/typeswitch2.go                      |    2 +-
 test/typeparam/typeswitch3.go                      |    2 +-
 test/typeparam/typeswitch4.go                      |    2 +-
 test/typeparam/typeswitch5.go                      |    2 +-
 test/typeparam/typeswitch6.go                      |    2 +-
 test/typeparam/typeswitch7.go                      |    2 +-
 test/typeparam/valimp.go                           |    2 +-
 test/typeparam/value.go                            |    2 +-
 760 files changed, 11707 insertions(+), 10910 deletions(-)

diff --cc src/crypto/rand/rand_unix.go
index 28f2f5b58b,b800ec8fb7..560f195d86
--- a/src/crypto/rand/rand_unix.go
+++ b/src/crypto/rand/rand_unix.go
@@@ -22,31 -20,17 +20,23 @@@ import 
  	"time"
  )
  
 +import "crypto/internal/boring"
 +
  const urandomDevice = "/dev/urandom"
  
- // Easy implementation: read from /dev/urandom.
- // This is sufficient on Linux, OS X, and FreeBSD.
- 
  func init() {
 +	if boring.Enabled {
 +		Reader = boring.RandReader
 +		return
 +	}
- 	if runtime.GOOS == "plan9" {
- 		Reader = newReader(nil)
- 	} else {
- 		Reader = &devReader{name: urandomDevice}
- 	}
+ 	Reader = &reader{}
  }
  
- // A devReader satisfies reads by reading the file named name.
- type devReader struct {
- 	name string
+ // A reader satisfies reads by reading from urandomDevice
+ type reader struct {
  	f    io.Reader
  	mu   sync.Mutex
- 	used int32 // atomic; whether this devReader has been used
+ 	used int32 // atomic; whether this reader has been used
  }
  
  // altGetRandom if non-nil specifies an OS-specific function to get
@@@ -57,8 -41,7 +47,8 @@@ func warnBlocked() 
  	println("crypto/rand: blocked for 60 seconds waiting to read random data from the kernel")
  }
  
- func (r *devReader) Read(b []byte) (n int, err error) {
+ func (r *reader) Read(b []byte) (n int, err error) {
 +	boring.Unreachable()
  	if atomic.CompareAndSwapInt32(&r.used, 0, 1) {
  		// First use of randomness. Start timer to warn about
  		// being blocked on entropy not being available.
diff --cc src/math/big/intmarsh_test.go
index f82956ceaf,936669b380..8e7d29f9dd
--- a/src/math/big/intmarsh_test.go
+++ b/src/math/big/intmarsh_test.go
@@@ -97,6 -97,20 +97,19 @@@ func TestIntJSONEncoding(t *testing.T) 
  	}
  }
  
 -
+ func TestIntJSONEncodingNil(t *testing.T) {
+ 	var x *Int
+ 	b, err := x.MarshalJSON()
+ 	if err != nil {
+ 		t.Fatalf("marshaling of nil failed: %s", err)
+ 	}
+ 	got := string(b)
+ 	want := "null"
+ 	if got != want {
+ 		t.Fatalf("marshaling of nil failed: got %s want %s", got, want)
+ 	}
+ }
+ 
  func TestIntXMLEncoding(t *testing.T) {
  	for _, test := range encodingTests {
  		for _, sign := range []string{"", "+", "-"} {
