commit 348b23830d82aece5775eb9f7f3b3587cf5300c6
Author: Roland Shoemaker <bracewell@google.com>
Date:   Thu Apr 25 13:09:54 2024 -0700

    cmd/go: disallow -lto_library in LDFLAGS
    
    The darwin linker allows setting the LTO library with the -lto_library
    flag. This wasn't caught by our "safe linker flags" check because it
    was covered by the -lx flag used for linking libraries. This change
    adds a specific check for excluded flags which otherwise satisfy our
    existing checks.
    
    Loading a mallicious LTO library would allow an attacker to cause the
    linker to execute abritrary code when "go build" was called.
    
    Thanks to Juho Fors√©n of Mattermost for reporting this issue.
    
    Fixes #67119
    Fixes CVE-2024-24787
    
    Change-Id: I77ac8585efbdbdfd5f39c39ed623b9408a0f9eaf
    Reviewed-on: https://go-internal-review.googlesource.com/c/go/+/1380
    Reviewed-by: Russ Cox <rsc@google.com>
    Reviewed-by: Damien Neil <dneil@google.com>
    Reviewed-on: https://go-review.googlesource.com/c/go/+/583815
    Reviewed-by: David Chase <drchase@google.com>
    LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>

 src/cmd/go/internal/work/security.go                  | 19 +++++++++++++++----
 .../go/testdata/script/darwin_lto_library_ldflag.txt  | 17 +++++++++++++++++
 2 files changed, 32 insertions(+), 4 deletions(-)
