commit 48a0b979022d604771767cd03634986669c064ab
Author: Cherry Zhang <cherryyz@google.com>
Date:   Fri Nov 1 10:58:27 2019 -0400

    [dev.link] cmd/link: set cgo attributes early when internal cgo linking
    
    In newobj mode, cgo attributes are typically set later, as we
    create sym.Symbols later. But when internal cgo linking, the
    host object loaders still work with sym.Symbols, and the cgo
    attributes need to be set for them to work properly. Therefore,
    set them early. This will cause creating some Symbols eagerly,
    but they are mostly host object symbols and will need to be
    created anyway.
    
    Now all cgo internal linking tests pass on ELF systems.
    
    Change-Id: I023a4df4429acc8ebf5e185f62e6809198497a78
    Reviewed-on: https://go-review.googlesource.com/c/go/+/204857
    Reviewed-by: Than McIntosh <thanm@google.com>

 src/cmd/link/internal/ld/go.go             | 12 ++++++------
 src/cmd/link/internal/ld/lib.go            | 15 ++++++++++++++-
 src/cmd/link/internal/loadelf/ldelf.go     | 19 +------------------
 src/cmd/link/internal/loader/loader.go     | 25 ++++++++++++++++++++++++-
 src/cmd/link/internal/loadmacho/ldmacho.go | 11 +----------
 src/cmd/link/internal/loadxcoff/ldxcoff.go | 11 +----------
 6 files changed, 47 insertions(+), 46 deletions(-)
