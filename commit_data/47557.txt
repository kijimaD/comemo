commit 8f676144ad7b7c91adb0c6e1ec89aaa6283c6807
Author: Himanshu Kishna Srivastava <28himanshu@gmail.com>
Date:   Tue Mar 16 22:37:46 2021 +0530

    crypto/rsa: fix salt length calculation with PSSSaltLengthAuto
    
    When PSSSaltLength is set, the maximum salt length must equal:
    
        (modulus_key_size - 1 + 7)/8 - hash_length - 2
    and for example, with a 4096 bit modulus key, and a SHA-1 hash,
    it should be:
    
         (4096 -1 + 7)/8 - 20 - 2 = 490
    Previously we'd encounter this error:
    
         crypto/rsa: key size too small for PSS signature
    
    Fixes #42741
    
    Change-Id: I18bb82c41c511d564b3f4c443f4b3a38ab010ac5
    Reviewed-on: https://go-review.googlesource.com/c/go/+/302230
    Reviewed-by: Emmanuel Odeke <emmanuel@orijtech.com>
    Reviewed-by: Filippo Valsorda <filippo@golang.org>
    Trust: Emmanuel Odeke <emmanuel@orijtech.com>
    Run-TryBot: Emmanuel Odeke <emmanuel@orijtech.com>
    TryBot-Result: Go Bot <gobot@golang.org>

 src/crypto/rsa/pss.go      |  2 +-
 src/crypto/rsa/pss_test.go | 20 +++++++++++++++++++-
 2 files changed, 20 insertions(+), 2 deletions(-)
