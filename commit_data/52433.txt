commit 422f4483f183622ecd19dc9ae98a16802c4be40e
Author: Than McIntosh <thanm@google.com>
Date:   Tue Mar 28 09:17:27 2023 -0400

    cmd/link: use path from "cc --print-prog-name ar" for c-archive buildmode
    
    When external linking with -buildmode=c-archive, the Go linker
    eventually invokes the "ar" tool to create the final archive library.
    Prior to this patch, if the '-extar' flag was not in use, we would
    just run "ar". This works well in most cases but breaks down if we're
    doing cross-compilation targeting Windows (macos system "ar"
    apparently doesn't create the windows symdef section correctly). To
    fix the problem, capture the output of "cc --print-prog-name ar" and
    invoke "ar" using the path returned by that command.
    
    Fixes #59221.
    
    Change-Id: I9de66e98947c42633b16fde7208c2958d62fe7cc
    Reviewed-on: https://go-review.googlesource.com/c/go/+/479775
    Reviewed-by: Cherry Mui <cherryyz@google.com>
    Run-TryBot: Than McIntosh <thanm@google.com>
    TryBot-Result: Gopher Robot <gobot@golang.org>

 src/cmd/link/internal/ld/lib.go | 39 +++++++++++++++++++++++----------------
 1 file changed, 23 insertions(+), 16 deletions(-)
