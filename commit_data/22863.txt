commit 64c39a3093db3976201697bb817d5705afc66bed
Author: Rob Pike <r@golang.org>
Date:   Mon May 4 13:09:31 2015 -0700

    text/template: shut down lexing goroutine on error
    
    When a parse error occurred, the lexing goroutine would lay idle.
    It's not likely a problem but if the program is for some reason
    accepting badly formed data repeatedly, it's wasteful.
    
    The solution is easy: Just drain the input on error. We know this
    will succeed because the input is always a string and is therefore
    guaranteed finite.
    
    With debugging prints in the package tests I've shown this is effective,
    shutting down 79 goroutines that would otherwise linger, out of 123 total.
    
    Fixes #10574.
    
    Change-Id: I8aa536e327b219189a7e7f604a116fa562ae1c39
    Reviewed-on: https://go-review.googlesource.com/9658
    Reviewed-by: Russ Cox <rsc@golang.org>

 src/text/template/parse/lex.go      | 12 ++++++++++++
 src/text/template/parse/lex_test.go | 28 ++++++++++++++++++++++++++++
 src/text/template/parse/parse.go    |  1 +
 3 files changed, 41 insertions(+)
