commit d0e8d3a7ae2194b1753bc4e419d5f00aa2d5cb86
Author: Joe Tsai <joetsai@digital-static.net>
Date:   Sat Apr 2 16:47:51 2016 -0700

    compress/gzip: fix Reader to properly check FHCRC
    
    RFC 1952, section 3.2.3 says:
    >>>
    If FHCRC is set, a CRC16 for the gzip header is present,
    immediately before the compressed data. The CRC16 consists of the two
    least significant bytes of the CRC32 for all bytes of the
    gzip header up to and not including the CRC16.
    <<<
    
    Thus, instead of computing the CRC only over the first 10 bytes
    of the header, we compute it over the whole header (minus CRC16).
    
    Fixes #15070
    
    Change-Id: I55703fd30b535b12abeb5e3962d4da0a86ed615a
    Reviewed-on: https://go-review.googlesource.com/21466
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

 src/compress/gzip/gunzip.go      | 121 ++++++++++++++++++---------------------
 src/compress/gzip/gunzip_test.go |  47 +++++++++++++++
 src/compress/gzip/gzip.go        |  21 ++-----
 3 files changed, 107 insertions(+), 82 deletions(-)
