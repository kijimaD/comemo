commit bef4cb475c0638ab5193f75f2683b35a7c7f6547
Author: Brad Fitzpatrick <bradfitz@golang.org>
Date:   Fri Jan 11 10:03:43 2013 -0800

    net/http: buffer before chunking
    
    This introduces a buffer between writing from a handler and
    writing chunks.  Further, it delays writing the header until
    the first full chunk is ready.  In the case where the first
    full chunk is also the final chunk (for small responses), that
    means we can also compute a Content-Length, which is a nice
    side effect for certain benchmarks.
    
    Fixes #2357
    
    R=golang-dev, dave, minux.ma, rsc, adg, balasanjay
    CC=golang-dev
    https://golang.org/cl/6964043

 src/pkg/net/http/header.go     |  10 ++
 src/pkg/net/http/serve_test.go |  16 +-
 src/pkg/net/http/server.go     | 394 ++++++++++++++++++++++++-----------------
 3 files changed, 249 insertions(+), 171 deletions(-)
