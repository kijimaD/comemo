commit d93cb46280ae4710c5c6113159c7973a08a72249
Author: Russ Cox <rsc@golang.org>
Date:   Sat Oct 14 22:47:24 2017 -0400

    [release-branch.go1.9] runtime: use simple, more robust fastrandn
    
    CL 36932 (speed up fastrandn) made it faster but introduced
    bad interference with some properties of fastrand itself, making
    fastrandn not very random in certain ways. In particular, certain
    selects are demonstrably unfair.
    
    For Go 1.10 the new faster fastrandn has induced a new fastrand,
    which in turn has caused other follow-on bugs that are still being
    discovered and fixed.
    
    For Go 1.9.2, just go back to the barely slower % implementation
    that we used in Go 1.8 and earlier. This should restore fairness in
    select and any other problems caused by the clever fastrandn.
    
    The test in this CL is copied from CL 62530.
    
    Fixes #22253.
    
    Change-Id: Ibcf948a7bce981452e05c90dbdac122043f6f813
    Reviewed-on: https://go-review.googlesource.com/70991
    Run-TryBot: Russ Cox <rsc@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Ian Lance Taylor <iant@golang.org>
    Reviewed-by: Keith Randall <khr@golang.org>

 src/runtime/chan_test.go | 57 ++++++++++++++++++++++++++++++++++++++++++++++++
 src/runtime/stubs.go     |  8 ++++---
 2 files changed, 62 insertions(+), 3 deletions(-)
