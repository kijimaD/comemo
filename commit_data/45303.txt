commit cfac62a1cc021cae55c9c5e373ebe9c408b75a5d
Author: Than McIntosh <thanm@google.com>
Date:   Thu Apr 22 18:34:57 2021 -0400

    cmd/compile: fix bug in defer wrapping
    
    The defer wrapping feature added to the compiler's "order" phase
    creates temporaries into which it copies defer arguments. If one of
    these temps is large enough that we place it into the defer closure by
    address (as opposed to by value), then the temp in question can't be
    reused later on in the order phase, nor do we want a VARKILL
    annotation for it at the end of the current block scope.
    
    Test written by Cherry.
    
    Updates #40724.
    
    Change-Id: Iec7efd87ec5a3e3d7de41cdcc7f39c093ed1e815
    Reviewed-on: https://go-review.googlesource.com/c/go/+/312869
    Trust: Than McIntosh <thanm@google.com>
    Run-TryBot: Than McIntosh <thanm@google.com>
    TryBot-Result: Go Bot <gobot@golang.org>
    Reviewed-by: Cherry Zhang <cherryyz@google.com>

 src/cmd/compile/internal/walk/order.go | 20 +++++++++++++++---
 test/abi/wrapdefer_largetmp.go         | 37 ++++++++++++++++++++++++++++++++++
 test/abi/wrapdefer_largetmp.out        |  1 +
 3 files changed, 55 insertions(+), 3 deletions(-)
