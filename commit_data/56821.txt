commit 6b020be648960440b1f02d28889a6e050f59c31c
Author: Filippo Valsorda <filippo@golang.org>
Date:   Fri May 19 23:28:43 2023 +0200

    crypto/tls: reduce session ticket linkability
    
    Ever since session ticket key rotation was introduced in CL 9072, we've
    been including a prefix in every ticket to identify what key it's
    encrypted with. It's a small privacy gain, but the cost of trial
    decryptions is also small, especially since the first key is probably
    the most frequently used.
    
    Also reissue tickets on every resumption so that the next connection
    can't be linked to all the previous ones. Again the privacy gain is
    small but the performance cost is small and it comes with a reduction in
    complexity.
    
    For #60105
    
    Change-Id: I852f297162d2b79a3d9bf61f6171e8ce94b2537a
    Reviewed-on: https://go-review.googlesource.com/c/go/+/496817
    Reviewed-by: Damien Neil <dneil@google.com>
    Reviewed-by: Matthew Dempsky <mdempsky@google.com>
    Run-TryBot: Damien Neil <dneil@google.com>
    TryBot-Result: Gopher Robot <gobot@golang.org>
---
 src/crypto/tls/common.go                           |  18 +-
 src/crypto/tls/handshake_client_test.go            |  13 +-
 src/crypto/tls/handshake_server.go                 |  15 +-
 src/crypto/tls/handshake_server_tls13.go           |   2 +-
 .../testdata/Server-TLSv10-ExportKeyingMaterial    |  86 +++---
 src/crypto/tls/testdata/Server-TLSv12-ALPN         |  67 ++---
 .../tls/testdata/Server-TLSv12-ALPN-Fallback       |  67 ++---
 .../tls/testdata/Server-TLSv12-ALPN-NotConfigured  |  67 ++---
 .../testdata/Server-TLSv12-ExportKeyingMaterial    |  77 ++---
 src/crypto/tls/testdata/Server-TLSv12-IssueTicket  |  77 +++--
 .../testdata/Server-TLSv12-IssueTicketPreDisable   |  77 +++--
 src/crypto/tls/testdata/Server-TLSv12-Resume       |  87 +++---
 .../tls/testdata/Server-TLSv13-AES128-SHA256       | 179 ++++++-----
 .../tls/testdata/Server-TLSv13-AES256-SHA384       | 185 ++++++------
 src/crypto/tls/testdata/Server-TLSv13-ALPN         | 167 ++++++-----
 .../tls/testdata/Server-TLSv13-ALPN-Fallback       | 165 +++++-----
 .../tls/testdata/Server-TLSv13-ALPN-NotConfigured  | 167 ++++++-----
 .../tls/testdata/Server-TLSv13-CHACHA20-SHA256     | 179 ++++++-----
 .../Server-TLSv13-ClientAuthRequestedAndECDSAGiven | 331 +++++++++++----------
 ...erver-TLSv13-ClientAuthRequestedAndEd25519Given | 270 ++++++++---------
 .../Server-TLSv13-ClientAuthRequestedAndGiven      | 326 ++++++++++----------
 .../Server-TLSv13-ClientAuthRequestedNotGiven      | 179 ++++++-----
 .../tls/testdata/Server-TLSv13-ECDHE-ECDSA-AES     | 159 +++++-----
 src/crypto/tls/testdata/Server-TLSv13-Ed25519      | 123 ++++----
 .../testdata/Server-TLSv13-ExportKeyingMaterial    | 167 ++++++-----
 .../tls/testdata/Server-TLSv13-HelloRetryRequest   | 189 ++++++------
 src/crypto/tls/testdata/Server-TLSv13-IssueTicket  | 167 ++++++-----
 .../testdata/Server-TLSv13-IssueTicketPreDisable   | 167 ++++++-----
 src/crypto/tls/testdata/Server-TLSv13-P256         | 171 ++++++-----
 src/crypto/tls/testdata/Server-TLSv13-RSA-RSAPSS   | 167 ++++++-----
 src/crypto/tls/testdata/Server-TLSv13-Resume       |  88 +++---
 .../Server-TLSv13-Resume-HelloRetryRequest         | 137 +++++----
 src/crypto/tls/testdata/Server-TLSv13-X25519       | 167 ++++++-----
 src/crypto/tls/ticket.go                           |  69 ++---
 34 files changed, 2269 insertions(+), 2303 deletions(-)

diff --git a/src/crypto/tls/common.go b/src/crypto/tls/common.go
index b8332e90fd..58e97306c0 100644
--- a/src/crypto/tls/common.go
+++ b/src/crypto/tls/common.go
@@ -748,10 +748,6 @@ type Config struct {
 }
 
 const (
-	// ticketKeyNameLen is the number of bytes of identifier that is prepended to
-	// an encrypted session ticket in order to identify the key used to encrypt it.
-	ticketKeyNameLen = 16
-
 	// ticketKeyLifetime is how long a ticket key remains valid and can be used to
 	// resume a client connection.
 	ticketKeyLifetime = 7 * 24 * time.Hour // 7 days
@@ -763,9 +759,6 @@ const (
 
 // ticketKey is the internal representation of a session ticket key.
 type ticketKey struct {
-	// keyName is an opaque byte string that serves to identify the session
-	// ticket key. It's exposed as plaintext in every session ticket.
-	keyName [ticketKeyNameLen]byte
 	aesKey  [16]byte
 	hmacKey [16]byte
 	// created is the time at which this ticket key was created. See Config.ticketKeys.
@@ -777,15 +770,18 @@ type ticketKey struct {
 // bytes and this function expands that into sufficient name and key material.
 func (c *Config) ticketKeyFromBytes(b [32]byte) (key ticketKey) {
 	hashed := sha512.Sum512(b[:])
-	copy(key.keyName[:], hashed[:ticketKeyNameLen])
-	copy(key.aesKey[:], hashed[ticketKeyNameLen:ticketKeyNameLen+16])
-	copy(key.hmacKey[:], hashed[ticketKeyNameLen+16:ticketKeyNameLen+32])
+	// The first 16 bytes of the hash used to be exposed on the wire as a ticket
+	// prefix. They MUST NOT be used as a secret. In the future, it would make
+	// sense to use a proper KDF here, like HKDF with a fixed salt.
+	const legacyTicketKeyNameLen = 16
+	copy(key.aesKey[:], hashed[legacyTicketKeyNameLen:])
+	copy(key.hmacKey[:], hashed[legacyTicketKeyNameLen+len(key.aesKey):])
 	key.created = c.time()
 	return key
 }
 
 // maxSessionTicketLifetime is the maximum allowed lifetime of a TLS 1.3 session
-// ticket, and the lifetime we set for tickets we send.
+// ticket, and the lifetime we set for all tickets we send.
 const maxSessionTicketLifetime = 7 * 24 * time.Hour
 
 // Clone returns a shallow clone of c or nil if c is nil. It is safe to clone a Config that is
diff --git a/src/crypto/tls/handshake_client_test.go b/src/crypto/tls/handshake_client_test.go
index 22be38faff..fef5038810 100644
--- a/src/crypto/tls/handshake_client_test.go
+++ b/src/crypto/tls/handshake_client_test.go
@@ -936,21 +936,20 @@ func testResumption(t *testing.T, version uint16) {
 	testResumeState("Handshake", false)
 	ticket := getTicket()
 	testResumeState("Resume", true)
-	if !bytes.Equal(ticket, getTicket()) && version != VersionTLS13 {
-		t.Fatal("first ticket doesn't match ticket after resumption")
-	}
-	if bytes.Equal(ticket, getTicket()) && version == VersionTLS13 {
+	if bytes.Equal(ticket, getTicket()) {
 		t.Fatal("ticket didn't change after resumption")
 	}
 
-	// An old session ticket can resume, but the server will provide a ticket encrypted with a fresh key.
+	// An old session ticket is replaced with a ticket encrypted with a fresh key.
+	ticket = getTicket()
 	serverConfig.Time = func() time.Time { return time.Now().Add(24*time.Hour + time.Minute) }
 	testResumeState("ResumeWithOldTicket", true)
-	if bytes.Equal(ticket[:ticketKeyNameLen], getTicket()[:ticketKeyNameLen]) {
+	if bytes.Equal(ticket, getTicket()) {
 		t.Fatal("old first ticket matches the fresh one")
 	}
 
-	// Now the session tickey key is expired, so a full handshake should occur.
+	// Once the session master secret is expired, a full handshake should occur.
+	ticket = getTicket()
 	serverConfig.Time = func() time.Time { return time.Now().Add(24*8*time.Hour + time.Minute) }
 	testResumeState("ResumeWithExpiredTicket", false)
 	if bytes.Equal(ticket, getTicket()) {
diff --git a/src/crypto/tls/handshake_server.go b/src/crypto/tls/handshake_server.go
index 450c5f7714..49d2d372a5 100644
--- a/src/crypto/tls/handshake_server.go
+++ b/src/crypto/tls/handshake_server.go
@@ -406,16 +406,19 @@ func (hs *serverHandshakeState) checkForResumption() bool {
 		return false
 	}
 
-	plaintext, usedOldKey := c.decryptTicket(hs.clientHello.sessionTicket)
+	plaintext := c.decryptTicket(hs.clientHello.sessionTicket)
 	if plaintext == nil {
 		return false
 	}
-	hs.sessionState = &sessionState{usedOldKey: usedOldKey}
+	hs.sessionState = &sessionState{}
 	ok := hs.sessionState.unmarshal(plaintext)
 	if !ok {
 		return false
 	}
 
+	// TLS 1.2 tickets don't natively have a lifetime, but we want to avoid
+	// re-wrapping the same master secret in different tickets over and over for
+	// too long, weakening forward secrecy.
 	createdAt := time.Unix(int64(hs.sessionState.createdAt), 0)
 	if c.config.time().Sub(createdAt) > maxSessionTicketLifetime {
 		return false
@@ -465,7 +468,10 @@ func (hs *serverHandshakeState) doResumeHandshake() error {
 	// We echo the client's session ID in the ServerHello to let it know
 	// that we're doing a resumption.
 	hs.hello.sessionId = hs.clientHello.sessionId
-	hs.hello.ticketSupported = hs.sessionState.usedOldKey
+	// We always send a new session ticket, even if it wraps the same master
+	// secret and it's potentially encrypted with the same key, to help the
+	// client avoid cross-connection tracking from a network observer.
+	hs.hello.ticketSupported = true
 	hs.finishedHash = newFinishedHash(c.vers, hs.suite)
 	hs.finishedHash.discardHandshakeBuffer()
 	if err := transcriptMsg(hs.clientHello, &hs.finishedHash); err != nil {
@@ -748,9 +754,6 @@ func (hs *serverHandshakeState) readFinished(out []byte) error {
 }
 
 func (hs *serverHandshakeState) sendSessionTicket() error {
-	// ticketSupported is set in a resumption handshake if the
-	// ticket from the client was encrypted with an old session
-	// ticket key and thus a refreshed ticket should be sent.
 	if !hs.hello.ticketSupported {
 		return nil
 	}
diff --git a/src/crypto/tls/handshake_server_tls13.go b/src/crypto/tls/handshake_server_tls13.go
index 69ebe1c7d5..791b34f24a 100644
--- a/src/crypto/tls/handshake_server_tls13.go
+++ b/src/crypto/tls/handshake_server_tls13.go
@@ -275,7 +275,7 @@ func (hs *serverHandshakeStateTLS13) checkForResumption() error {
 			break
 		}
 
-		plaintext, _ := c.decryptTicket(identity.label)
+		plaintext := c.decryptTicket(identity.label)
 		if plaintext == nil {
 			continue
 		}
diff --git a/src/crypto/tls/testdata/Server-TLSv10-ExportKeyingMaterial b/src/crypto/tls/testdata/Server-TLSv10-ExportKeyingMaterial
index cb3b8da823..006b12410a 100644
--- a/src/crypto/tls/testdata/Server-TLSv10-ExportKeyingMaterial
+++ b/src/crypto/tls/testdata/Server-TLSv10-ExportKeyingMaterial
@@ -1,11 +1,10 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 67 01 00 00  63 03 01 41 69 16 b5 d5  |....g...c..Ai...|
-00000010  c2 9d 36 2b 95 8e e5 41  9b 92 82 27 2a cc 4e 6e  |..6+...A...'*.Nn|
-00000020  5d f1 1b 58 49 3c 95 1d  8b 61 35 00 00 04 c0 14  |]..XI<...a5.....|
-00000030  00 ff 01 00 00 36 00 00  00 0e 00 0c 00 00 09 31  |.....6.........1|
-00000040  32 37 2e 30 2e 30 2e 31  00 0b 00 04 03 00 01 02  |27.0.0.1........|
-00000050  00 0a 00 0c 00 0a 00 1d  00 17 00 1e 00 19 00 18  |................|
-00000060  00 23 00 00 00 16 00 00  00 17 00 00              |.#..........|
+00000000  16 03 01 00 55 01 00 00  51 03 01 f5 f3 42 9e 4a  |....U...Q....B.J|
+00000010  f4 5f cc c5 18 d0 77 f2  9f 1a 37 d7 44 6b f5 09  |._....w...7.Dk..|
+00000020  69 ab 8b ee d7 1c 63 8d  95 59 bc 00 00 04 c0 14  |i.....c..Y......|
+00000030  00 ff 01 00 00 24 00 0b  00 04 03 00 01 02 00 0a  |.....$..........|
+00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
+00000050  00 00 00 16 00 00 00 17  00 00                    |..........|
 >>> Flow 2 (server to client)
 00000000  16 03 01 00 3b 02 00 00  37 03 01 00 00 00 00 00  |....;...7.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -51,43 +50,42 @@
 00000290  d4 db fe 3d 13 60 84 5c  21 d3 3b e9 fa e7 16 03  |...=.`.\!.;.....|
 000002a0  01 00 aa 0c 00 00 a6 03  00 1d 20 2f e5 7d a3 47  |.......... /.}.G|
 000002b0  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
-000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 00 80 c6 ad e2  |......_X.;t.....|
-000002d0  21 0d d7 30 42 da 08 52  d5 46 70 a3 e5 d6 40 ab  |!..0B..R.Fp...@.|
-000002e0  bf 52 f8 da a5 41 86 1d  48 e6 51 91 52 8d 3c 5d  |.R...A..H.Q.R.<]|
-000002f0  ca 36 4c 62 d1 6b c8 48  8c 99 50 89 a9 27 4b 21  |.6Lb.k.H..P..'K!|
-00000300  c9 9d a6 43 34 d2 47 a7  b3 1a 6d 98 b3 7f 37 94  |...C4.G...m...7.|
-00000310  60 ba 88 f1 b7 ed 34 2b  47 f4 80 27 d3 a0 74 6a  |`.....4+G..'..tj|
-00000320  c6 d6 49 e3 8a e5 5d f1  a7 54 8a b4 84 8d a8 6b  |..I...]..T.....k|
-00000330  3b 7a 3f eb 81 77 4b bf  be 1e ac cd aa f9 4b 79  |;z?..wK.......Ky|
-00000340  24 78 6c 67 14 13 ab f8  ad 33 7c 94 38 16 03 01  |$xlg.....3|.8...|
+000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 00 80 3f 8b 3e  |......_X.;t..?.>|
+000002d0  b0 29 ea c2 25 87 26 bb  69 0d b8 52 18 d4 82 19  |.)..%.&.i..R....|
+000002e0  90 3b e9 dc 77 94 61 fe  69 95 9f 50 85 34 c5 dd  |.;..w.a.i..P.4..|
+000002f0  c0 a1 d5 d6 83 e4 e3 ba  8c f7 6e 39 e0 14 94 30  |..........n9...0|
+00000300  34 16 f0 5b c0 32 92 a3  21 8e 21 c8 57 05 16 a3  |4..[.2..!.!.W...|
+00000310  ea 66 0a 29 20 14 32 e2  f6 b2 7f 17 04 dc 8f 1b  |.f.) .2.........|
+00000320  2c 56 50 75 bf 84 c7 11  84 18 a3 05 08 1a 3a e4  |,VPu..........:.|
+00000330  16 ec f2 b5 1f 29 9b 56  8f 5c 9c f2 91 3e 09 5e  |.....).V.\...>.^|
+00000340  c7 59 45 12 37 39 06 c5  11 3c fc ee 49 16 03 01  |.YE.79...<..I...|
 00000350  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
-00000000  16 03 01 00 25 10 00 00  21 20 f5 be 48 cb fb 0d  |....%...! ..H...|
-00000010  69 27 a8 ab 59 c4 9a ac  92 71 46 d1 17 7e 35 67  |i'..Y....qF..~5g|
-00000020  15 b1 ea 9f 53 48 a3 b5  f9 55 14 03 01 00 01 01  |....SH...U......|
-00000030  16 03 01 00 30 e1 79 95  7c ab 01 74 35 39 9b ce  |....0.y.|..t59..|
-00000040  79 5f 15 21 88 fc be fc  46 a9 31 ca 82 07 0c 1f  |y_.!....F.1.....|
-00000050  d8 2f 93 b5 5d 23 bf f9  10 40 bc b5 22 53 df d6  |./..]#...@.."S..|
-00000060  b1 10 b9 16 96                                    |.....|
+00000000  16 03 01 00 25 10 00 00  21 20 a1 f8 df c3 de d5  |....%...! ......|
+00000010  70 2f 18 10 4e 4e 86 18  ae 89 a5 4a 34 81 40 f8  |p/..NN.....J4.@.|
+00000020  9d a6 f4 cf b0 5b b5 43  54 08 14 03 01 00 01 01  |.....[.CT.......|
+00000030  16 03 01 00 30 86 24 e7  70 5c ea 25 e3 65 63 b5  |....0.$.p\.%.ec.|
+00000040  91 de 82 c3 23 ce b1 68  0c b4 a0 f3 ae 5d 46 cd  |....#..h.....]F.|
+00000050  90 ce 4f 4c b0 c7 14 13  60 17 32 b4 fc 2a 0b 49  |..OL....`.2..*.I|
+00000060  8d 0e 3d e8 2a                                    |..=.*|
 >>> Flow 4 (server to client)
-00000000  16 03 01 00 8b 04 00 00  87 00 00 00 00 00 81 50  |...............P|
-00000010  46 ad c1 db a8 38 86 7b  2b bb fd d0 c3 42 3e 00  |F....8.{+....B>.|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000030  6d ec a4 83 51 ed 14 ef  68 ca 42 c5 4c d2 34 08  |m...Q...h.B.L.4.|
-00000040  0b cc b9 32 8f 21 f7 50  c4 e1 28 9b 7d 5e ed de  |...2.!.P..(.}^..|
-00000050  0a df 30 0d 16 34 6b 6d  22 3c d3 c8 b2 99 84 8e  |..0..4km"<......|
-00000060  09 6d 3c 62 d4 0f f6 37  dc 53 ae 72 40 49 38 16  |.m<b...7.S.r@I8.|
-00000070  9c 30 34 bf 6e 34 bb 54  73 33 c0 c9 8c 12 ae bc  |.04.n4.Ts3......|
-00000080  e9 a8 80 23 de d0 e5 d3  46 d8 6a 86 c7 a5 6c 61  |...#....F.j...la|
-00000090  14 03 01 00 01 01 16 03  01 00 30 27 a7 5d e7 93  |..........0'.]..|
-000000a0  54 9a 77 d5 43 aa e3 ec  21 00 fa d4 36 04 c3 82  |T.w.C...!...6...|
-000000b0  b0 b7 f5 b4 19 ce f9 58  0a b4 7f d6 bf 95 43 9d  |.......X......C.|
-000000c0  26 44 46 77 48 cd 77 82  e2 48 51 17 03 01 00 20  |&DFwH.w..HQ.... |
-000000d0  c0 9b b1 d3 9f e6 4f 55  59 17 5a dc e4 2f bc 04  |......OUY.Z../..|
-000000e0  6f eb 4d d9 22 6e 97 20  33 94 d4 91 aa 70 4d ab  |o.M."n. 3....pM.|
-000000f0  17 03 01 00 30 9b 0f 50  a8 95 f5 db 67 96 c2 3e  |....0..P....g..>|
-00000100  46 a7 41 99 d5 e2 ab 60  b1 eb 8d 68 2f 71 30 70  |F.A....`...h/q0p|
-00000110  75 cc b8 50 1a 58 3b 96  d3 5c 99 43 27 4f b1 4a  |u..P.X;..\.C'O.J|
-00000120  c8 8d 5b ab 49 15 03 01  00 20 34 a6 41 25 fd 23  |..[.I.... 4.A%.#|
-00000130  44 6d 60 7f 79 5d 27 23  f7 cb 77 d0 cd 81 c4 67  |Dm`.y]'#..w....g|
-00000140  0e 56 92 60 ac a1 32 a5  0d 94                    |.V.`..2...|
+00000000  16 03 01 00 7b 04 00 00  77 00 00 00 00 00 71 00  |....{...w.....q.|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
+00000020  6d ec a4 83 51 ed 14 ef  68 ca 42 c5 4c fe ae 28  |m...Q...h.B.L..(|
+00000030  76 e9 99 d7 d3 45 dd ff  bd 64 54 a3 a8 bf 69 17  |v....E...dT...i.|
+00000040  28 b5 cb bb 13 1c e8 a8  9c f8 a7 43 81 9d 1d bc  |(..........C....|
+00000050  00 96 83 1d cc da 66 d7  20 e1 52 44 b4 49 38 16  |......f. .RD.I8.|
+00000060  56 c5 9e be 43 6c 3c 82  7a 50 fd d6 e6 00 99 27  |V...Cl<.zP.....'|
+00000070  49 a1 65 7b cb 82 3f 9a  74 17 08 2b fd 7b de db  |I.e{..?.t..+.{..|
+00000080  14 03 01 00 01 01 16 03  01 00 30 eb 9f f3 b2 32  |..........0....2|
+00000090  44 c2 58 ab 22 7f 41 a0  30 84 71 18 7a df 48 6b  |D.X.".A.0.q.z.Hk|
+000000a0  c7 2d 8b 8e 8f 8c 7f 5d  58 7c 2c 61 5d 0d bc ce  |.-.....]X|,a]...|
+000000b0  60 f0 47 b3 e2 86 5a 82  30 26 95 17 03 01 00 20  |`.G...Z.0&..... |
+000000c0  12 3e 23 0a f5 97 2a 6b  bf be f4 82 7b 31 92 9e  |.>#...*k....{1..|
+000000d0  32 c9 1f 4f 8e cc 74 5e  41 da ff 45 68 3c 82 07  |2..O..t^A..Eh<..|
+000000e0  17 03 01 00 30 31 73 bb  fd 8e ba 4d c3 74 14 9b  |....01s....M.t..|
+000000f0  81 c0 69 38 e6 32 86 35  b2 fb 2a af 2c 69 c1 ca  |..i8.2.5..*.,i..|
+00000100  0c 94 35 9a fa 7b ab b4  04 1e 56 6f 59 f9 40 38  |..5..{....VoY.@8|
+00000110  e6 a9 20 96 15 15 03 01  00 20 09 20 d5 0e cd 68  |.. ...... . ...h|
+00000120  79 de ea 6b 0e 84 98 e5  75 64 c4 e8 b1 9f c4 cc  |y..k....ud......|
+00000130  d6 4c b6 be cf 42 78 c6  6a 2e                    |.L...Bx.j.|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ALPN b/src/crypto/tls/testdata/Server-TLSv12-ALPN
index d73866210d..21b60afd54 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ALPN
+++ b/src/crypto/tls/testdata/Server-TLSv12-ALPN
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 9d 01 00 00  99 03 03 53 49 69 68 95  |...........SIih.|
-00000010  b9 7b 2a 84 d2 03 93 d4  33 e7 b7 7e bc b5 97 b0  |.{*.....3..~....|
-00000020  4f 4f 6c d0 96 43 aa c8  6f da 90 00 00 04 cc a8  |OOl..C..o.......|
+00000000  16 03 01 00 9d 01 00 00  99 03 03 38 64 71 8a 57  |...........8dq.W|
+00000010  cb 23 9d ce 7c 41 93 09  c0 a9 47 ca 56 db 97 12  |.#..|A....G.V...|
+00000020  14 c8 8e 3a 5a 56 34 f7  ad a2 90 00 00 04 cc a8  |...:ZV4.........|
 00000030  00 ff 01 00 00 6c 00 0b  00 04 03 00 01 02 00 0a  |.....l..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000050  00 00 00 10 00 10 00 0e  06 70 72 6f 74 6f 32 06  |.........proto2.|
@@ -56,37 +56,36 @@
 000002a0  3d 13 60 84 5c 21 d3 3b  e9 fa e7 16 03 03 00 ac  |=.`.\!.;........|
 000002b0  0c 00 00 a8 03 00 1d 20  2f e5 7d a3 47 cd 62 43  |....... /.}.G.bC|
 000002c0  15 28 da ac 5f bb 29 07  30 ff f6 84 af c4 cf c2  |.(.._.).0.......|
-000002d0  ed 90 99 5f 58 cb 3b 74  08 04 00 80 3b cd 7a 99  |..._X.;t....;.z.|
-000002e0  3f bf 03 5a 26 21 90 db  b4 8d 3b 69 14 82 1c ae  |?..Z&!....;i....|
-000002f0  7d 72 8f 4e eb ff c4 f0  13 fa 6f 69 48 e7 6d 3d  |}r.N......oiH.m=|
-00000300  fc b3 1c 54 60 54 cf 83  48 1d a3 50 55 28 3f 2c  |...T`T..H..PU(?,|
-00000310  db d3 dc c7 d9 58 74 de  eb 5e 21 26 2f 32 c6 b2  |.....Xt..^!&/2..|
-00000320  be 1b 08 fa d6 9f 3b b0  2b e8 c2 36 2f 9d c1 35  |......;.+..6/..5|
-00000330  c1 54 4b 37 5f ff 99 4f  c1 e4 ad 69 a0 c8 52 d3  |.TK7_..O...i..R.|
-00000340  01 23 0d 57 17 08 7c 07  9a 3a 6d c8 87 5d 7e 09  |.#.W..|..:m..]~.|
-00000350  7b 03 f9 5e de 83 4d 13  89 08 72 96 16 03 03 00  |{..^..M...r.....|
+000002d0  ed 90 99 5f 58 cb 3b 74  08 04 00 80 36 d7 55 53  |..._X.;t....6.US|
+000002e0  60 3e 9a ca 01 8e f9 f4  16 d0 66 30 12 29 ae 0d  |`>........f0.)..|
+000002f0  23 f4 73 c6 d2 74 03 79  b5 b9 27 f6 33 e3 35 2e  |#.s..t.y..'.3.5.|
+00000300  8e d8 d0 30 b6 9e cb 96  99 91 d7 3c 3e ec 1f b4  |...0.......<>...|
+00000310  b0 82 04 03 b3 f4 d6 60  38 9e d5 1a 38 fe ac ef  |.......`8...8...|
+00000320  10 e9 02 94 c5 8a b7 cd  69 cd 1d de 4f 61 5e eb  |........i...Oa^.|
+00000330  57 31 e7 de 6d 9a e4 d9  9a 09 c9 3d 3a a6 f1 65  |W1..m......=:..e|
+00000340  95 1a 54 c3 bf 7c a9 22  47 90 d4 09 65 14 54 cc  |..T..|."G...e.T.|
+00000350  05 1f 73 1a e0 b9 9e f9  9a 81 be 91 16 03 03 00  |..s.............|
 00000360  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 fb eb 44 09 0e 62  |....%...! ..D..b|
-00000010  b0 ce d8 1f c5 f9 46 31  1e 1d e8 fb 02 5f 34 3b  |......F1....._4;|
-00000020  c1 6f 9a 38 6a 46 d2 cd  a0 53 14 03 03 00 01 01  |.o.8jF...S......|
-00000030  16 03 03 00 20 88 73 90  39 bc 9b 02 e4 c0 35 f0  |.... .s.9.....5.|
-00000040  ef 40 b0 08 ca b9 bd 25  6b cd 03 7d ec 58 73 65  |.@.....%k..}.Xse|
-00000050  d5 89 f2 f1 70                                    |....p|
+00000000  16 03 03 00 25 10 00 00  21 20 79 2b 97 00 d7 66  |....%...! y+...f|
+00000010  f9 ca 21 3c 1a 2b 60 7a  e1 32 73 2b 7f f7 65 19  |..!<.+`z.2s+..e.|
+00000020  08 ad 52 39 aa a9 8a 0b  9f 44 14 03 03 00 01 01  |..R9.....D......|
+00000030  16 03 03 00 20 6e f1 de  c4 b0 35 42 12 37 f2 e1  |.... n....5B.7..|
+00000040  36 d7 4c 4e 11 98 72 ec  12 6c 2d 5e 11 3b c4 a4  |6.LN..r..l-^.;..|
+00000050  9a 35 d5 5d 1c                                    |.5.].|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 8b 04 00 00  87 00 00 00 00 00 81 50  |...............P|
-00000010  46 ad c1 db a8 38 86 7b  2b bb fd d0 c3 42 3e 00  |F....8.{+....B>.|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000030  6f e0 18 83 51 ed 14 ef  68 ca 42 c5 4c cd 0b 21  |o...Q...h.B.L..!|
-00000040  a5 29 ef 62 07 a5 11 b9  1f 4e 54 c3 66 4c 1e d3  |.).b.....NT.fL..|
-00000050  1a 00 52 34 67 2b af 73  02 5f c9 6c 7c 6e ba f2  |..R4g+.s._.l|n..|
-00000060  e6 38 bd 23 97 3f 80 6a  3b 8e bb 98 29 49 38 16  |.8.#.?.j;...)I8.|
-00000070  77 74 2a a1 c7 36 80 de  c9 91 cd b2 7d bc 6c 64  |wt*..6......}.ld|
-00000080  6c 06 57 22 d1 f2 51 5f  84 ad 30 85 3a c0 4f e7  |l.W"..Q_..0.:.O.|
-00000090  14 03 03 00 01 01 16 03  03 00 20 32 71 5a d3 94  |.......... 2qZ..|
-000000a0  d5 17 e4 8c 3a 78 d1 48  4e 1b f5 83 36 f1 5a 38  |....:x.HN...6.Z8|
-000000b0  e4 b5 6d ab 46 89 e0 24  74 87 80 17 03 03 00 1d  |..m.F..$t.......|
-000000c0  69 4c a6 24 67 79 18 59  92 4f 9a d0 2d 1d 57 e0  |iL.$gy.Y.O..-.W.|
-000000d0  ec 0c 00 25 6f 2f 3a be  8a aa 80 94 ac 15 03 03  |...%o/:.........|
-000000e0  00 12 ef 86 3e 93 42 bb  72 f1 1b 90 df 9a d3 ed  |....>.B.r.......|
-000000f0  d8 74 35 23                                       |.t5#|
+00000000  16 03 03 00 7b 04 00 00  77 00 00 00 00 00 71 00  |....{...w.....q.|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
+00000020  6f e0 18 83 51 ed 14 ef  68 ca 42 c5 4c 8f d6 48  |o...Q...h.B.L..H|
+00000030  3e 65 16 36 87 11 c3 53  8c 8f 44 1a f5 6e 92 65  |>e.6...S..D..n.e|
+00000040  22 87 99 5f 58 18 48 86  79 d9 36 1e 23 4a 87 42  |".._X.H.y.6.#J.B|
+00000050  18 45 f6 03 2b e5 a5 55  b4 59 62 b4 db 49 38 16  |.E..+..U.Yb..I8.|
+00000060  2d d9 6b d5 66 55 c7 b9  d8 f1 03 6a 78 ea b9 93  |-.k.fU.....jx...|
+00000070  f4 1a 8c d3 79 91 b4 37  42 e9 84 0f ea d1 04 ce  |....y..7B.......|
+00000080  14 03 03 00 01 01 16 03  03 00 20 f4 ff 37 5f 7c  |.......... ..7_||
+00000090  c6 6a b3 31 5f 06 51 62  f2 76 a2 cf da a3 a5 60  |.j.1_.Qb.v.....`|
+000000a0  de 5b 6b bf 0d 03 2e ce  de 9e 90 17 03 03 00 1d  |.[k.............|
+000000b0  7e 9f a9 87 fc e1 e8 84  7a 81 77 70 4a d1 52 cf  |~.......z.wpJ.R.|
+000000c0  ba c2 0b f6 99 2f 99 cb  fb 73 25 c7 1d 15 03 03  |...../...s%.....|
+000000d0  00 12 ac 41 7f af d0 87  25 e3 82 f4 c9 e5 fa ef  |...A....%.......|
+000000e0  d2 89 53 e6                                       |..S.|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ALPN-Fallback b/src/crypto/tls/testdata/Server-TLSv12-ALPN-Fallback
index 4fadf39062..dd06ed876f 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ALPN-Fallback
+++ b/src/crypto/tls/testdata/Server-TLSv12-ALPN-Fallback
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 a6 01 00 00  a2 03 03 b5 c9 ab 32 7f  |..............2.|
-00000010  e1 af 3f f2 ac 2a 11 dd  33 f9 b5 21 88 0d e4 29  |..?..*..3..!...)|
-00000020  e2 47 49 dc c7 31 a8 a5  25 81 0c 00 00 04 cc a8  |.GI..1..%.......|
+00000000  16 03 01 00 a6 01 00 00  a2 03 03 90 5c 4c fb cb  |............\L..|
+00000010  af 3c 20 5e a0 4f 38 dd  9e 1b 0f 59 d1 30 78 aa  |.< ^.O8....Y.0x.|
+00000020  27 0b 8f c4 e3 c4 54 1f  a8 05 ed 00 00 04 cc a8  |'.....T.........|
 00000030  00 ff 01 00 00 75 00 0b  00 04 03 00 01 02 00 0a  |.....u..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000050  00 00 00 10 00 19 00 17  06 70 72 6f 74 6f 33 08  |.........proto3.|
@@ -55,37 +55,36 @@
 00000290  d4 db fe 3d 13 60 84 5c  21 d3 3b e9 fa e7 16 03  |...=.`.\!.;.....|
 000002a0  03 00 ac 0c 00 00 a8 03  00 1d 20 2f e5 7d a3 47  |.......... /.}.G|
 000002b0  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
-000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 08 04 00 80 5f  |......_X.;t...._|
-000002d0  37 27 84 58 1e ea 1e 40  1b de a9 8f 04 d4 94 64  |7'.X...@.......d|
-000002e0  4e 27 c7 f1 b3 30 d0 53  f5 3d 57 50 d2 17 97 c8  |N'...0.S.=WP....|
-000002f0  3d 61 af a6 21 ab 1c 34  47 70 f8 b1 3b 9c 06 86  |=a..!..4Gp..;...|
-00000300  87 00 e2 13 50 83 91 ad  bc 84 bd b4 7b f3 4b ed  |....P.......{.K.|
-00000310  ca 81 0c 94 37 a8 ec 67  ca 9c f3 00 f6 af c2 92  |....7..g........|
-00000320  c4 8c 78 07 18 0e 43 24  1b 98 16 50 5c 2b 75 0e  |..x...C$...P\+u.|
-00000330  40 66 dc 40 cd 10 1a 51  25 f3 96 25 1a 3e 70 af  |@f.@...Q%..%.>p.|
-00000340  16 24 d0 1c 0e 33 f9 c1  74 cf b7 e2 28 ac 60 16  |.$...3..t...(.`.|
+000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 08 04 00 80 88  |......_X.;t.....|
+000002d0  a6 17 7f f7 b9 ee 12 26  b8 0c b6 c5 fe 7b 0b cb  |.......&.....{..|
+000002e0  c3 79 dd 67 12 49 f1 0c  b7 2f a4 c9 f6 65 83 63  |.y.g.I.../...e.c|
+000002f0  3e 6b e9 b3 60 e8 db a5  62 5a 41 9d 9a 63 07 df  |>k..`...bZA..c..|
+00000300  19 66 55 80 30 56 27 a4  04 f0 92 73 c9 1a 81 26  |.fU.0V'....s...&|
+00000310  c1 aa b1 56 4e bf 1c 04  a7 6b aa 63 72 5c c3 d9  |...VN....k.cr\..|
+00000320  8e d9 c6 bb b9 b0 bc 31  90 e4 c3 6d 36 04 cc 34  |.......1...m6..4|
+00000330  32 83 99 4a d5 75 ce c3  6c ef e1 55 89 1c 1d 80  |2..J.u..l..U....|
+00000340  86 b1 07 2f 5b 03 63 97  9a 8c 9e 33 13 18 fb 16  |.../[.c....3....|
 00000350  03 03 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 30 f2 bb f7 a7 ac  |....%...! 0.....|
-00000010  23 20 22 ee 73 0d 49 9c  b3 7b c1 9a db 2c 85 f3  |# ".s.I..{...,..|
-00000020  c0 82 31 60 bd 8b 14 4e  73 43 14 03 03 00 01 01  |..1`...NsC......|
-00000030  16 03 03 00 20 09 8d c7  86 ee cc f4 c7 36 a3 49  |.... ........6.I|
-00000040  d3 f7 a1 4a 68 a2 1e b4  fc cc a2 15 cb 01 92 d8  |...Jh...........|
-00000050  72 b0 d1 6f eb                                    |r..o.|
+00000000  16 03 03 00 25 10 00 00  21 20 5e a8 04 6a 75 cb  |....%...! ^..ju.|
+00000010  4e a8 af 5a 33 be 07 d2  0e e0 72 44 48 10 46 df  |N..Z3.....rDH.F.|
+00000020  08 97 9c 53 7b e8 c1 37  16 73 14 03 03 00 01 01  |...S{..7.s......|
+00000030  16 03 03 00 20 f1 80 5f  6e a6 99 39 64 a8 1d e6  |.... .._n..9d...|
+00000040  5d c9 03 7d b5 00 78 fb  09 46 ce 65 75 3d 34 d5  |]..}..x..F.eu=4.|
+00000050  48 cb 50 a5 b4                                    |H.P..|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 8b 04 00 00  87 00 00 00 00 00 81 50  |...............P|
-00000010  46 ad c1 db a8 38 86 7b  2b bb fd d0 c3 42 3e 00  |F....8.{+....B>.|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000030  6f e0 18 83 51 ed 14 ef  68 ca 42 c5 4c a2 ac 05  |o...Q...h.B.L...|
-00000040  9c 69 69 99 08 9f de a4  d4 e7 37 ab 14 38 4c 47  |.ii.......7..8LG|
-00000050  70 f0 97 1d db 2d 0a 14  c2 1e f0 16 9f 6d 37 02  |p....-.......m7.|
-00000060  4b f1 16 be 98 3f df 74  83 7c 19 85 61 49 38 16  |K....?.t.|..aI8.|
-00000070  ee 35 7a e2 3f 74 fe 8d  e3 07 93 a1 5e fa f2 02  |.5z.?t......^...|
-00000080  e5 c8 60 3f 11 83 8b 0e  32 52 f1 aa 52 b7 0a 89  |..`?....2R..R...|
-00000090  14 03 03 00 01 01 16 03  03 00 20 9e 65 15 cf 45  |.......... .e..E|
-000000a0  a5 03 69 c9 b1 d8 9e 92  a3 a2 b0 df 2e 62 b1 3a  |..i..........b.:|
-000000b0  17 78 cd e5 1d f3 51 42  7e 4e 25 17 03 03 00 1d  |.x....QB~N%.....|
-000000c0  d9 ae d0 fa b7 90 a9 2f  28 8d 1d 6f 54 1f c0 1e  |......./(..oT...|
-000000d0  4d ae b6 91 f0 e8 84 cf  86 11 22 25 ea 15 03 03  |M........."%....|
-000000e0  00 12 0e 71 f2 11 9e 9f  58 ad c0 d8 fc fa 34 bc  |...q....X.....4.|
-000000f0  02 5a 60 00                                       |.Z`.|
+00000000  16 03 03 00 7b 04 00 00  77 00 00 00 00 00 71 00  |....{...w.....q.|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
+00000020  6f e0 18 83 51 ed 14 ef  68 ca 42 c5 4c 81 6e af  |o...Q...h.B.L.n.|
+00000030  71 0a 8a c0 25 ed 47 8c  e2 48 bd 70 b6 db d4 3a  |q...%.G..H.p...:|
+00000040  a4 bf 9e f2 73 57 23 12  0c 3f ab 29 0b 98 c6 14  |....sW#..?.)....|
+00000050  b7 5d 8b 90 4f a0 62 88  0f 04 19 33 cb 49 38 16  |.]..O.b....3.I8.|
+00000060  dc 52 be a8 9d af 25 3c  7b 13 27 79 4e 66 ff fa  |.R....%<{.'yNf..|
+00000070  a7 68 27 c5 bc fe 2a 7e  49 54 4b db a1 9e 62 bf  |.h'...*~ITK...b.|
+00000080  14 03 03 00 01 01 16 03  03 00 20 32 61 a0 7c 8a  |.......... 2a.|.|
+00000090  f5 8b 55 ca 44 54 b8 0c  24 62 4f 06 81 26 27 24  |..U.DT..$bO..&'$|
+000000a0  38 f2 92 e3 43 fb 5a 13  c4 b3 57 17 03 03 00 1d  |8...C.Z...W.....|
+000000b0  60 c5 bf 3c 84 0e ec 68  e9 d3 87 fd 0d 2e 3d ba  |`..<...h......=.|
+000000c0  6e 44 6d 96 f3 60 59 65  d8 25 3f 3a cb 15 03 03  |nDm..`Ye.%?:....|
+000000d0  00 12 fa 43 46 3f d4 38  05 2b ea 7b 96 a0 fc d8  |...CF?.8.+.{....|
+000000e0  b7 fe e1 54                                       |...T|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ALPN-NotConfigured b/src/crypto/tls/testdata/Server-TLSv12-ALPN-NotConfigured
index e1c991b227..d16fd12d61 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ALPN-NotConfigured
+++ b/src/crypto/tls/testdata/Server-TLSv12-ALPN-NotConfigured
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 9d 01 00 00  99 03 03 92 d8 d4 4f 2e  |..............O.|
-00000010  82 ad e9 4f a2 c3 f7 23  da 2e dc 23 c0 87 fc 33  |...O...#...#...3|
-00000020  14 63 f1 da 98 a8 af 70  3a 7e f3 00 00 04 cc a8  |.c.....p:~......|
+00000000  16 03 01 00 9d 01 00 00  99 03 03 43 e0 d2 e0 0d  |...........C....|
+00000010  e9 e0 ba c5 77 93 87 c9  40 43 48 60 d4 ad b0 2d  |....w...@CH`...-|
+00000020  31 00 cd 33 5a ac ee e7  16 62 44 00 00 04 cc a8  |1..3Z....bD.....|
 00000030  00 ff 01 00 00 6c 00 0b  00 04 03 00 01 02 00 0a  |.....l..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000050  00 00 00 10 00 10 00 0e  06 70 72 6f 74 6f 32 06  |.........proto2.|
@@ -55,37 +55,36 @@
 00000290  d4 db fe 3d 13 60 84 5c  21 d3 3b e9 fa e7 16 03  |...=.`.\!.;.....|
 000002a0  03 00 ac 0c 00 00 a8 03  00 1d 20 2f e5 7d a3 47  |.......... /.}.G|
 000002b0  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
-000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 08 04 00 80 8c  |......_X.;t.....|
-000002d0  cb 8c f6 6c dd 02 5f c9  13 7e c2 26 26 41 7a 1a  |...l.._..~.&&Az.|
-000002e0  25 c7 3e 22 11 30 32 c0  67 a5 53 32 1e 32 21 cb  |%.>".02.g.S2.2!.|
-000002f0  ff 0a b7 e1 7a 98 26 e9  bf 05 30 f6 13 38 ee 1d  |....z.&...0..8..|
-00000300  90 56 a6 0d e0 65 a8 02  0e 08 3e c0 31 ff dd fa  |.V...e....>.1...|
-00000310  05 3a 22 7c f8 ce 65 43  0c b6 c4 9a e4 ed 22 eb  |.:"|..eC......".|
-00000320  c4 46 b2 3d 1d 9c c1 e7  d4 6a 79 4f cf 8f 1c 45  |.F.=.....jyO...E|
-00000330  52 51 b3 d1 a4 0d 0d df  4e 19 15 e6 af 2e 5a d5  |RQ......N.....Z.|
-00000340  8a 2e 3c 48 8a f7 86 e5  53 0e 35 9a 8a c6 dd 16  |..<H....S.5.....|
+000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 08 04 00 80 b4  |......_X.;t.....|
+000002d0  4f 34 83 09 ba 14 7e 7e  9c 91 cc a8 8e 67 1a a8  |O4....~~.....g..|
+000002e0  93 25 a9 61 6a e9 70 1e  e5 5f 4c cf 89 04 bf ce  |.%.aj.p.._L.....|
+000002f0  56 12 a5 f8 7f 11 20 26  73 e5 02 d1 41 fb c0 7b  |V..... &s...A..{|
+00000300  f1 0a bc 58 d6 09 4f 0c  2c 3e 2b cb e4 3d 0f 48  |...X..O.,>+..=.H|
+00000310  a6 c8 9d 56 d9 23 71 4f  c4 41 6d 92 e9 4f 67 d3  |...V.#qO.Am..Og.|
+00000320  09 06 55 8b 22 57 66 04  96 21 12 3b 34 f6 4b 80  |..U."Wf..!.;4.K.|
+00000330  1d 99 11 ca cb 08 31 53  47 94 e8 f5 f9 7b 2e a4  |......1SG....{..|
+00000340  ff 02 59 43 d1 d7 8b 97  ee 24 be 18 b9 12 a0 16  |..YC.....$......|
 00000350  03 03 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 b7 d6 2f 99 8f c7  |....%...! ../...|
-00000010  bc 48 b8 4f 01 f8 2c ff  75 e5 fe 10 c6 2d 2d d5  |.H.O..,.u....--.|
-00000020  43 2b c3 14 cb d0 b2 7a  e9 71 14 03 03 00 01 01  |C+.....z.q......|
-00000030  16 03 03 00 20 c9 88 f1  a0 1a 9b 8a 14 00 33 f0  |.... .........3.|
-00000040  e8 01 f3 c2 66 06 98 44  4d 35 89 8f 1b 65 d0 cf  |....f..DM5...e..|
-00000050  eb 7d 9f b1 df                                    |.}...|
+00000000  16 03 03 00 25 10 00 00  21 20 13 06 6b 6d 87 fd  |....%...! ..km..|
+00000010  c6 3b 78 26 8c bf 17 72  a8 7e 79 88 95 a9 59 9d  |.;x&...r.~y...Y.|
+00000020  90 98 c1 9b ca 33 4a 57  1d 1e 14 03 03 00 01 01  |.....3JW........|
+00000030  16 03 03 00 20 86 a9 44  52 42 f0 54 92 61 84 d9  |.... ..DRB.T.a..|
+00000040  ef 1a 69 35 98 6d bb 06  97 ab 72 03 62 fb b0 63  |..i5.m....r.b..c|
+00000050  3c c9 60 9c 09                                    |<.`..|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 8b 04 00 00  87 00 00 00 00 00 81 50  |...............P|
-00000010  46 ad c1 db a8 38 86 7b  2b bb fd d0 c3 42 3e 00  |F....8.{+....B>.|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000030  6f e0 18 83 51 ed 14 ef  68 ca 42 c5 4c 76 fb ec  |o...Q...h.B.Lv..|
-00000040  0d 89 48 e7 19 98 64 df  59 8f df 50 ce 28 e8 3c  |..H...d.Y..P.(.<|
-00000050  b6 f8 5a ae bc 6b 2e a2  d6 23 05 f6 7f 36 ea 55  |..Z..k...#...6.U|
-00000060  13 54 9e 9c 31 df d0 56  00 1f a7 6a b2 49 38 16  |.T..1..V...j.I8.|
-00000070  7f d0 78 12 95 86 11 ca  98 63 07 4a 81 a5 d3 bd  |..x......c.J....|
-00000080  dc 9e 54 9c 25 f2 55 d5  fd cf 36 94 99 e0 c5 82  |..T.%.U...6.....|
-00000090  14 03 03 00 01 01 16 03  03 00 20 e6 d9 c2 bb ca  |.......... .....|
-000000a0  02 d3 79 a4 fb b0 00 7d  e2 47 46 d3 e7 b4 fe be  |..y....}.GF.....|
-000000b0  b3 8f c4 98 b7 f7 25 bc  cc 3f a8 17 03 03 00 1d  |......%..?......|
-000000c0  ad f3 27 a0 c4 a4 5b 7b  40 11 a4 35 e6 10 03 63  |..'...[{@..5...c|
-000000d0  13 d3 1c ce 75 8f 09 8b  85 6c 93 b1 9f 15 03 03  |....u....l......|
-000000e0  00 12 79 0c dd 21 72 68  b8 30 45 5d 45 39 a9 c4  |..y..!rh.0E]E9..|
-000000f0  a6 d7 12 99                                       |....|
+00000000  16 03 03 00 7b 04 00 00  77 00 00 00 00 00 71 00  |....{...w.....q.|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
+00000020  6f e0 18 83 51 ed 14 ef  68 ca 42 c5 4c b8 4c 2a  |o...Q...h.B.L.L*|
+00000030  22 91 a6 5d 99 6b cb fb  75 14 84 05 ca 60 8a 33  |"..].k..u....`.3|
+00000040  6c 27 46 da 51 cc c7 2b  9b d3 ff 46 7d fd ef 5f  |l'F.Q..+...F}.._|
+00000050  39 df db cb 27 17 15 49  56 60 77 54 73 49 38 16  |9...'..IV`wTsI8.|
+00000060  e1 60 0b d7 81 ab a2 c4  1f 34 9c 5c 1e 89 38 ce  |.`.......4.\..8.|
+00000070  57 10 ba e0 65 06 83 0b  56 d2 b1 9e dc 79 d6 32  |W...e...V....y.2|
+00000080  14 03 03 00 01 01 16 03  03 00 20 7c e8 6b b4 cb  |.......... |.k..|
+00000090  fa a4 2c b1 ea 16 10 36  1d 27 50 e1 cd c7 01 9c  |..,....6.'P.....|
+000000a0  a2 4c 40 10 5a 71 ab ea  44 57 71 17 03 03 00 1d  |.L@.Zq..DWq.....|
+000000b0  13 4a 91 5d 73 11 7b 4c  49 59 b6 bd 7e 80 b9 44  |.J.]s.{LIY..~..D|
+000000c0  11 fc d8 72 26 5d 5a 24  42 bc b2 db 0c 15 03 03  |...r&]Z$B.......|
+000000d0  00 12 db c7 6c 45 3e 59  43 88 50 80 7e 36 5d 2c  |....lE>YC.P.~6],|
+000000e0  03 69 ee db                                       |.i..|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ExportKeyingMaterial b/src/crypto/tls/testdata/Server-TLSv12-ExportKeyingMaterial
index e01c32c428..dc76fdf268 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ExportKeyingMaterial
+++ b/src/crypto/tls/testdata/Server-TLSv12-ExportKeyingMaterial
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 89 01 00 00  85 03 03 9a d9 fe da 40  |...............@|
-00000010  cf 8b ed 11 09 8e 3f 29  4b 0d 46 ff fc f6 56 2c  |......?)K.F...V,|
-00000020  a8 e7 16 84 8a a4 e9 44  89 97 0b 00 00 04 cc a8  |.......D........|
+00000000  16 03 01 00 89 01 00 00  85 03 03 b1 95 51 0b ed  |.............Q..|
+00000010  0e d5 41 f6 66 a6 ce ac  a3 4b c1 ae fb 32 31 c4  |..A.f....K...21.|
+00000020  da 47 95 a0 7b 91 3d ea  62 41 4c 00 00 04 c0 14  |.G..{.=.bAL.....|
 00000030  00 ff 01 00 00 58 00 0b  00 04 03 00 01 02 00 0a  |.....X..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000050  00 00 00 16 00 00 00 17  00 00 00 0d 00 30 00 2e  |.............0..|
@@ -11,7 +11,7 @@
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 3b 02 00 00  37 03 03 00 00 00 00 00  |....;...7.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 cc a8 00 00  |...DOWNGRD......|
+00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 c0 14 00 00  |...DOWNGRD......|
 00000030  0f 00 23 00 00 ff 01 00  01 00 00 0b 00 02 01 00  |..#.............|
 00000040  16 03 03 02 59 0b 00 02  55 00 02 52 00 02 4f 30  |....Y...U..R..O0|
 00000050  82 02 4b 30 82 01 b4 a0  03 02 01 02 02 09 00 e8  |..K0............|
@@ -53,37 +53,44 @@
 00000290  d4 db fe 3d 13 60 84 5c  21 d3 3b e9 fa e7 16 03  |...=.`.\!.;.....|
 000002a0  03 00 ac 0c 00 00 a8 03  00 1d 20 2f e5 7d a3 47  |.......... /.}.G|
 000002b0  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
-000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 08 04 00 80 89  |......_X.;t.....|
-000002d0  f8 62 c5 1a ba 78 74 da  6f 96 76 00 0f 6b a9 fb  |.b...xt.o.v..k..|
-000002e0  83 d4 52 c0 80 0b 81 02  e3 b0 07 c2 9d ff b4 cc  |..R.............|
-000002f0  ea 2e c7 82 91 35 74 ef  1e 9a ba 78 3e 60 6c 86  |.....5t....x>`l.|
-00000300  1d b0 14 52 84 84 70 ce  66 22 31 66 e2 53 04 bd  |...R..p.f"1f.S..|
-00000310  4d 2b 5e 86 8b 79 dc 17  7a 4f bc 62 5a 21 a1 f6  |M+^..y..zO.bZ!..|
-00000320  46 1a 12 aa 7a 98 25 02  97 a8 9c 71 a4 4a 5b 28  |F...z.%....q.J[(|
-00000330  c8 11 6a 5f f1 b3 13 a7  f2 26 12 59 02 fa 28 e2  |..j_.....&.Y..(.|
-00000340  ba 8c c0 cd 50 c6 60 db  69 9a a1 92 12 26 23 16  |....P.`.i....&#.|
+000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 08 04 00 80 30  |......_X.;t....0|
+000002d0  9f 3d 98 1a aa b9 55 2b  b2 fe 80 4d df 94 d0 66  |.=....U+...M...f|
+000002e0  b8 c4 83 66 e1 18 5a 1b  01 66 9f f1 94 27 27 fd  |...f..Z..f...''.|
+000002f0  ba 5c 3f 2b 06 28 f4 f2  af e5 91 bb bb 50 27 cb  |.\?+.(.......P'.|
+00000300  8c 35 da a8 0d a9 3b d8  59 5b 49 3e 7c 7d 4d 97  |.5....;.Y[I>|}M.|
+00000310  bc b5 e0 c4 35 1c 33 b4  6b f9 bd a8 dc 5b 28 60  |....5.3.k....[(`|
+00000320  65 9c da 12 99 92 2c 3f  7b 4b dd 92 c3 07 ec a4  |e.....,?{K......|
+00000330  fe 80 2a 5a eb 57 bf e5  94 cd 83 36 05 e3 34 18  |..*Z.W.....6..4.|
+00000340  99 41 94 93 ed d5 e8 da  c4 90 c4 d6 f0 2f f4 16  |.A.........../..|
 00000350  03 03 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 ba 1b c8 ae 22 78  |....%...! ...."x|
-00000010  84 ba d8 1c b3 87 52 f0  bf 13 76 2b a5 47 37 13  |......R...v+.G7.|
-00000020  30 89 01 13 1a cb 63 ea  b3 37 14 03 03 00 01 01  |0.....c..7......|
-00000030  16 03 03 00 20 ac d7 79  45 e6 65 1d 20 1a 95 5e  |.... ..yE.e. ..^|
-00000040  68 f7 0f ee 8c 3f 3d 0b  bc 58 31 aa 46 d7 e3 00  |h....?=..X1.F...|
-00000050  7b 10 8c 01 5d                                    |{...]|
+00000000  16 03 03 00 25 10 00 00  21 20 d5 ac 3d ad 5d dc  |....%...! ..=.].|
+00000010  6b 89 3c 16 9f a6 e2 da  27 9b ca 4b 49 98 66 40  |k.<.....'..KI.f@|
+00000020  7e 8a 36 41 c3 6c 00 f4  6b 30 14 03 03 00 01 01  |~.6A.l..k0......|
+00000030  16 03 03 00 40 f7 eb d8  ea 0a 45 4c 20 01 22 dd  |....@.....EL .".|
+00000040  fe 3b 13 7b df 94 85 00  ca 5f a1 00 cb 61 73 f9  |.;.{....._...as.|
+00000050  a4 ee ea e4 cd d7 99 a4  54 64 1e ce da 1a e0 49  |........Td.....I|
+00000060  dc 6d 75 fc 45 c3 c2 f7  db de 40 07 40 19 ad f1  |.mu.E.....@.@...|
+00000070  2f 94 20 79 16                                    |/. y.|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 8b 04 00 00  87 00 00 00 00 00 81 50  |...............P|
-00000010  46 ad c1 db a8 38 86 7b  2b bb fd d0 c3 42 3e 00  |F....8.{+....B>.|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000030  6f e0 18 83 51 ed 14 ef  68 ca 42 c5 4c f8 79 c6  |o...Q...h.B.L.y.|
-00000040  80 85 74 9c 35 6f 4e 9d  60 0b a2 28 b0 45 b6 f6  |..t.5oN.`..(.E..|
-00000050  71 a3 f6 a6 95 71 cd 1e  53 e9 58 9f 94 18 ac d6  |q....q..S.X.....|
-00000060  6b 03 ba ac b4 4f c2 02  cc 1c 5b 88 84 49 38 16  |k....O....[..I8.|
-00000070  d9 5e b8 11 ab c6 f8 a7  9d 5d 58 99 b1 b6 8a be  |.^.......]X.....|
-00000080  4e 9e 40 3d 00 22 11 25  c7 51 8e cb d2 10 d4 7d  |N.@=.".%.Q.....}|
-00000090  14 03 03 00 01 01 16 03  03 00 20 ff 4b 1e 87 3e  |.......... .K..>|
-000000a0  05 5c b4 3e e4 b9 5c 47  f0 a2 0b 67 47 89 c6 48  |.\.>..\G...gG..H|
-000000b0  d5 e3 73 d2 00 44 56 e4  8d b6 fb 17 03 03 00 1d  |..s..DV.........|
-000000c0  58 28 94 02 c2 a9 99 3d  b6 0b de 9c fd 52 61 bf  |X(.....=.....Ra.|
-000000d0  55 c0 12 7f be a8 52 98  d7 99 a5 d0 60 15 03 03  |U.....R.....`...|
-000000e0  00 12 26 44 ad f0 a7 56  e5 23 6f 1b 7a 7e f8 e4  |..&D...V.#o.z~..|
-000000f0  42 49 5d 1d                                       |BI].|
+00000000  16 03 03 00 7b 04 00 00  77 00 00 00 00 00 71 00  |....{...w.....q.|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
+00000020  6f ec a4 83 51 ed 14 ef  68 ca 42 c5 4c e9 ee ec  |o...Q...h.B.L...|
+00000030  17 f1 04 6d 95 de cb 78  93 bf db 98 a6 1d 0d fb  |...m...x........|
+00000040  e8 b5 1d cd 71 ad bb 09  8d 81 36 5e ab 65 1e 6c  |....q.....6^.e.l|
+00000050  96 a8 9c 90 fa 29 f8 9d  2c 72 21 da e7 49 38 16  |.....)..,r!..I8.|
+00000060  f7 98 70 05 a5 ef 83 76  6e 11 e5 b7 ba 5e 94 12  |..p....vn....^..|
+00000070  c0 5d 1c a8 87 f5 16 1f  f7 12 f5 86 1f 09 9d 8a  |.]..............|
+00000080  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
+00000090  00 00 00 00 00 00 00 00  00 00 00 3b 30 a4 a7 fb  |...........;0...|
+000000a0  56 31 b7 d1 98 0b 75 25  ca 34 87 d5 24 c9 82 02  |V1....u%.4..$...|
+000000b0  5a 20 da b7 66 b1 5e a0  d3 33 d8 a6 67 e3 51 7c  |Z ..f.^..3..g.Q||
+000000c0  c1 28 3c 5e 2a 09 ae 34  dc f8 4c 17 03 03 00 40  |.(<^*..4..L....@|
+000000d0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+000000e0  d0 c0 7d 37 a9 e0 e5 bf  47 d9 79 78 0a d5 86 d6  |..}7....G.yx....|
+000000f0  ed 50 28 a7 c7 cb a6 97  97 d4 9b b5 41 2c 2d 97  |.P(.........A,-.|
+00000100  a6 f5 fc 9b 5b b1 e7 64  62 d2 8f de 8f 65 77 c2  |....[..db....ew.|
+00000110  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
+00000120  00 00 00 00 00 87 44 5b  dd 76 b0 62 d1 15 7d fb  |......D[.v.b..}.|
+00000130  f4 64 a1 d4 4b 42 93 15  a7 2f d8 87 2e 65 49 32  |.d..KB.../...eI2|
+00000140  ba 78 95 83 68                                    |.x..h|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-IssueTicket b/src/crypto/tls/testdata/Server-TLSv12-IssueTicket
index f70c75993c..22a0f20ed9 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-IssueTicket
+++ b/src/crypto/tls/testdata/Server-TLSv12-IssueTicket
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 71 01 00 00  6d 03 03 3d 21 91 3a 4e  |....q...m..=!.:N|
-00000010  8e cd 65 eb 0f 1c ae 2a  58 40 4c 38 22 c9 46 2c  |..e....*X@L8".F,|
-00000020  b8 cd dd 38 ad c6 4b a7  60 a9 56 00 00 04 00 2f  |...8..K.`.V..../|
+00000000  16 03 01 00 71 01 00 00  6d 03 03 1a 33 54 ce 5c  |....q...m...3T.\|
+00000010  39 88 32 9d b9 24 c0 db  d7 6b c2 dc 78 25 30 7b  |9.2..$...k..x%0{|
+00000020  70 5b b9 9f 14 7d 73 3f  75 d2 94 00 00 04 00 2f  |p[...}s?u....../|
 00000030  00 ff 01 00 00 40 00 23  00 00 00 16 00 00 00 17  |.....@.#........|
 00000040  00 00 00 0d 00 30 00 2e  04 03 05 03 06 03 08 07  |.....0..........|
 00000050  08 08 08 09 08 0a 08 0b  08 04 08 05 08 06 04 01  |................|
@@ -52,40 +52,39 @@
 00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 04 0e 00 00  |.\!.;...........|
 000002a0  00                                                |.|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 1d 1a 1a b8 f4  |................|
-00000010  05 77 7a 96 2b 5f 50 7f  1e 69 14 be 40 ad 0c c9  |.wz.+_P..i..@...|
-00000020  7e df 2f 1d aa 74 ee b4  a5 05 fa 05 e1 85 a4 87  |~./..t..........|
-00000030  59 6a d1 e4 98 ce df e3  a5 82 98 77 c2 c4 fc 2f  |Yj.........w.../|
-00000040  ec 1d 2e 96 0c 27 12 0d  64 ba 58 90 ff 7d d1 27  |.....'..d.X..}.'|
-00000050  9a b9 b5 fb 1d 76 6f 3e  af f8 70 a3 cc 53 95 98  |.....vo>..p..S..|
-00000060  2c 7e a9 42 25 e5 3a e2  55 3f 19 57 6b 83 43 6a  |,~.B%.:.U?.Wk.Cj|
-00000070  93 34 2c 6e cb 4e 9d 25  8b 4d 7d d7 cc e1 16 59  |.4,n.N.%.M}....Y|
-00000080  2a 95 60 e4 31 0e df 7f  cb 9d b7 14 03 03 00 01  |*.`.1...........|
-00000090  01 16 03 03 00 40 28 33  df 69 4f 4c 48 b1 fb 8d  |.....@(3.iOLH...|
-000000a0  3f 3c d2 81 7c 33 cf 21  6a f7 d6 43 82 22 5b de  |?<..|3.!j..C."[.|
-000000b0  46 7f 7b e2 39 23 bd 39  fa 03 bd 11 9d a8 a2 84  |F.{.9#.9........|
-000000c0  4a 90 1a ab e1 b4 23 9f  72 d0 97 9e 05 5c 47 2b  |J.....#.r....\G+|
-000000d0  7a 53 bb ec a0 07                                 |zS....|
+00000000  16 03 03 00 86 10 00 00  82 00 80 cd 0c 0e 56 8a  |..............V.|
+00000010  e3 7d cc 5b 26 5f 16 86  3c a2 c0 96 06 55 94 e4  |.}.[&_..<....U..|
+00000020  64 69 6d 10 d6 64 48 6d  2e 8f 27 85 5c a8 bb 4b  |dim..dHm..'.\..K|
+00000030  52 f3 c4 5b be 16 3e 6a  a8 ab 9d 32 a5 58 6a 2c  |R..[..>j...2.Xj,|
+00000040  87 bf ca b8 df 38 73 2f  51 1b ac 0b 29 e1 2a 3e  |.....8s/Q...).*>|
+00000050  3a 83 04 b9 9d af aa 20  7c 97 8a 7b a2 20 4d 2f  |:...... |..{. M/|
+00000060  eb 45 2c 2a 9e 13 73 2c  6a de e9 73 f0 fe 1b 53  |.E,*..s,j..s...S|
+00000070  37 68 32 9a 18 9f 57 52  2e 9d 31 9c 03 d3 44 8b  |7h2...WR..1...D.|
+00000080  bd be 95 25 d9 84 24 1e  b5 88 f9 14 03 03 00 01  |...%..$.........|
+00000090  01 16 03 03 00 40 ca 99  75 30 ff 9f ba b1 97 43  |.....@..u0.....C|
+000000a0  03 49 ee ea 73 ae bb 4d  b2 1b 98 13 11 22 8f 7c  |.I..s..M.....".||
+000000b0  8f 1f 5b 32 36 ec 3e ad  d3 8a bd f5 10 2e 35 40  |..[26.>.......5@|
+000000c0  02 73 df f1 de 0d d6 c9  8d 4a 08 38 3a 31 5d b7  |.s.......J.8:1].|
+000000d0  b3 31 7b 17 fe 84                                 |.1{...|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 8b 04 00 00  87 00 00 00 00 00 81 50  |...............P|
-00000010  46 ad c1 db a8 38 86 7b  2b bb fd d0 c3 42 3e 00  |F....8.{+....B>.|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000030  6f 2c 9f 83 51 ed 14 ef  68 ca 42 c5 4c 75 5e a5  |o,..Q...h.B.Lu^.|
-00000040  6f d2 49 61 e4 fb 83 46  7c 4c ab f9 c6 d1 3c 9e  |o.Ia...F|L....<.|
-00000050  5b 8d d8 bc c0 a5 2d 84  db 24 dd a0 16 60 1d 87  |[.....-..$...`..|
-00000060  a0 52 88 25 6c c6 8e 5b  71 0f 74 c3 48 49 38 16  |.R.%l..[q.t.HI8.|
-00000070  92 8c de 77 bd 8a 2b 45  4d 58 86 40 b1 d6 0f 99  |...w..+EMX.@....|
-00000080  de 27 41 b2 41 27 aa fe  26 e9 24 91 2a 00 ff 08  |.'A.A'..&.$.*...|
-00000090  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-000000a0  00 00 00 00 00 00 00 00  00 00 00 fc cd 6b 01 90  |.............k..|
-000000b0  7b 0c 31 54 a0 3a 8b f7  ba 45 e7 e0 df 9a 59 6d  |{.1T.:...E....Ym|
-000000c0  83 b6 b2 c8 93 d8 d9 b6  fe 19 56 51 75 a3 ea 0e  |..........VQu...|
-000000d0  f4 4b 64 27 66 fc 19 7b  7e 13 e7 17 03 03 00 40  |.Kd'f..{~......@|
-000000e0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-000000f0  c2 1b 6f f1 1e 05 1b 8a  19 16 67 00 0f dc a8 a2  |..o.......g.....|
-00000100  00 56 49 0a bb c5 df 7e  96 0c 5c db a0 f4 3e b4  |.VI....~..\...>.|
-00000110  30 3e b6 f0 16 dd d4 ed  c9 de 64 49 00 9b 51 dc  |0>........dI..Q.|
-00000120  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000130  00 00 00 00 00 e1 9d 08  1a 2e 9a 0f 84 6d 4e e5  |.............mN.|
-00000140  2c 50 b9 28 5d 88 ea bb  48 4d af 26 7f 82 0b 56  |,P.(]...HM.&...V|
-00000150  c5 87 71 2a e7                                    |..q*.|
+00000000  16 03 03 00 7b 04 00 00  77 00 00 00 00 00 71 00  |....{...w.....q.|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
+00000020  6f 2c 9f 83 51 ed 14 ef  68 ca 42 c5 4c 97 70 11  |o,..Q...h.B.L.p.|
+00000030  14 b7 27 54 f2 0b 35 d5  93 d8 86 9e 86 0d 11 33  |..'T..5........3|
+00000040  11 84 b9 59 93 6a 5e 6e  08 47 99 d9 5f 9f 69 0e  |...Y.j^n.G.._.i.|
+00000050  93 08 3b 97 12 68 d8 55  e9 f8 d0 69 88 49 38 16  |..;..h.U...i.I8.|
+00000060  d9 3f 52 8c 19 e1 48 5e  98 ea cb 31 f9 bd 50 3e  |.?R...H^...1..P>|
+00000070  89 32 ed 0e 48 fa 8f 86  87 da 06 f5 c7 8a b7 00  |.2..H...........|
+00000080  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
+00000090  00 00 00 00 00 00 00 00  00 00 00 6c b1 c8 55 d7  |...........l..U.|
+000000a0  3b 07 12 f9 c8 d6 b2 50  09 b8 26 d0 94 9d 86 6a  |;......P..&....j|
+000000b0  97 3b a7 20 fe 66 c8 c9  56 80 81 f9 56 13 44 2b  |.;. .f..V...V.D+|
+000000c0  de 56 fa c5 38 3c 4d d7  db fe 6a 17 03 03 00 40  |.V..8<M...j....@|
+000000d0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+000000e0  93 24 62 38 5d e3 3e 19  a1 17 91 40 09 f8 fe 93  |.$b8].>....@....|
+000000f0  93 33 3e 3c 46 4d 03 68  de b6 84 d7 da 44 42 87  |.3><FM.h.....DB.|
+00000100  4c b9 a7 04 da ad 97 a3  cd cb 6f 9b 25 21 ca b0  |L.........o.%!..|
+00000110  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
+00000120  00 00 00 00 00 de 01 46  c3 77 b6 72 f4 44 b9 e5  |.......F.w.r.D..|
+00000130  ad f5 6e 52 1b 34 3e b6  63 49 d9 0c b2 6d 92 85  |..nR.4>.cI...m..|
+00000140  71 b3 64 07 d7                                    |q.d..|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable b/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable
index 8cb57f5e95..240ef7c9b7 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable
+++ b/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 71 01 00 00  6d 03 03 e1 40 35 c8 5c  |....q...m...@5.\|
-00000010  71 63 3f 5a 00 42 e6 3e  64 62 b8 c4 e7 e7 ba 98  |qc?Z.B.>db......|
-00000020  d8 fa 2c b5 65 f7 50 db  43 d9 70 00 00 04 00 2f  |..,.e.P.C.p..../|
+00000000  16 03 01 00 71 01 00 00  6d 03 03 7f 8b 61 43 6c  |....q...m....aCl|
+00000010  46 52 28 90 8a 76 05 1b  a8 fe ba 62 c7 7b 38 a9  |FR(..v.....b.{8.|
+00000020  74 d7 7a df b3 86 0f 43  80 16 f5 00 00 04 00 2f  |t.z....C......./|
 00000030  00 ff 01 00 00 40 00 23  00 00 00 16 00 00 00 17  |.....@.#........|
 00000040  00 00 00 0d 00 30 00 2e  04 03 05 03 06 03 08 07  |.....0..........|
 00000050  08 08 08 09 08 0a 08 0b  08 04 08 05 08 06 04 01  |................|
@@ -52,40 +52,39 @@
 00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 04 0e 00 00  |.\!.;...........|
 000002a0  00                                                |.|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 4f ce 06 88 66  |...........O...f|
-00000010  dd e1 0a 55 ef fb 1b 9e  70 62 8b 3b 0d e4 19 0f  |...U....pb.;....|
-00000020  4f 16 c9 79 92 9c 4d 16  21 ea 43 d7 58 7f 35 65  |O..y..M.!.C.X.5e|
-00000030  a3 15 7a 8d b5 6e 9b f6  73 19 c2 0c 58 be 9d 8a  |..z..n..s...X...|
-00000040  5a a8 be f3 89 48 64 28  6a 7f be b7 4a 58 93 af  |Z....Hd(j...JX..|
-00000050  c0 ff 8a ae 01 34 1f cf  7b b0 7a 5e 69 19 43 fa  |.....4..{.z^i.C.|
-00000060  21 b8 dc ee 0e ab 3b 81  c9 b9 be b9 56 a0 dd 62  |!.....;.....V..b|
-00000070  02 45 14 54 4d 05 5a cc  31 68 1f 17 91 a6 0e d7  |.E.TM.Z.1h......|
-00000080  5a f3 ae bb 5e 90 1d c3  c9 56 2a 14 03 03 00 01  |Z...^....V*.....|
-00000090  01 16 03 03 00 40 a1 34  07 ef 45 42 d2 88 bb 6e  |.....@.4..EB...n|
-000000a0  7f 3a 2a 39 67 3f 90 76  95 b7 cc 86 b6 1a 6c c6  |.:*9g?.v......l.|
-000000b0  da 8f 26 f3 34 6c 1f 6f  05 11 39 40 00 46 00 be  |..&.4l.o..9@.F..|
-000000c0  8f 3a af 86 d6 6d 5d 00  f3 5d 22 1c 31 2c 24 ee  |.:...m]..]".1,$.|
-000000d0  e5 11 ba 94 5f b1                                 |...._.|
+00000000  16 03 03 00 86 10 00 00  82 00 80 d0 11 d0 b9 f4  |................|
+00000010  77 46 92 30 0d d5 72 de  05 77 3e de 8b 75 a0 74  |wF.0..r..w>..u.t|
+00000020  cf 81 c9 99 b2 17 fd 4d  20 af db e7 2c 41 db 4a  |.......M ...,A.J|
+00000030  ff 53 80 69 b2 ef 46 6a  d8 bb ca 00 ec 3c e4 91  |.S.i..Fj.....<..|
+00000040  b4 e9 7f 55 e6 61 11 af  63 de 6b 68 b1 b0 b0 e1  |...U.a..c.kh....|
+00000050  ba 02 43 46 04 d3 28 94  45 68 73 01 32 3d 98 45  |..CF..(.Ehs.2=.E|
+00000060  79 ce 9d 46 a0 e3 ee 34  2d 1a a7 9e ef 91 8a 58  |y..F...4-......X|
+00000070  e3 85 8a b5 63 5d 96 db  58 a3 0d af c6 55 b0 8d  |....c]..X....U..|
+00000080  80 dc bc 41 f7 58 07 43  84 0b 7d 14 03 03 00 01  |...A.X.C..}.....|
+00000090  01 16 03 03 00 40 7a 63  c6 9d bb d6 20 3f ce 94  |.....@zc.... ?..|
+000000a0  11 e0 ff 8e f5 70 a5 40  1a a9 cd f1 e1 1b ae a1  |.....p.@........|
+000000b0  20 db 73 1b ab 33 d4 44  0b 5b e1 df 0a 90 a8 31  | .s..3.D.[.....1|
+000000c0  2c a8 85 f3 db 57 25 c4  b3 92 7a 95 38 a2 fe 73  |,....W%...z.8..s|
+000000d0  70 63 c8 9e 74 a4                                 |pc..t.|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 8b 04 00 00  87 00 00 00 00 00 81 50  |...............P|
-00000010  46 ad c1 db a8 38 86 7b  2b bb fd d0 c3 42 3e 00  |F....8.{+....B>.|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000030  6f 2c 9f 83 51 ed 14 ef  68 ca 42 c5 4c 20 33 6c  |o,..Q...h.B.L 3l|
-00000040  01 97 a5 69 44 bf 8f ea  db 83 05 fb ef cc 51 1f  |...iD.........Q.|
-00000050  0b 4d 44 77 89 11 cf c8  38 16 67 ea a2 3e 8b 2a  |.MDw....8.g..>.*|
-00000060  18 f2 f7 25 ce e0 d8 4c  93 31 b0 59 23 49 38 16  |...%...L.1.Y#I8.|
-00000070  3a f9 63 9e 61 21 1b ab  67 09 6a 23 07 8e d0 4a  |:.c.a!..g.j#...J|
-00000080  19 78 9c 1e 60 40 a7 83  c5 9a 48 41 35 c4 e9 63  |.x..`@....HA5..c|
-00000090  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-000000a0  00 00 00 00 00 00 00 00  00 00 00 b8 46 07 9e 14  |............F...|
-000000b0  85 ba 6d e0 f1 f5 99 43  80 9a 54 6b 33 1e 4f c1  |..m....C..Tk3.O.|
-000000c0  88 b7 3d 60 04 d4 e9 b0  b2 6d c4 1a ca 3b 9f 83  |..=`.....m...;..|
-000000d0  28 5f ea b2 54 e4 11 78  69 de 1a 17 03 03 00 40  |(_..T..xi......@|
-000000e0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-000000f0  55 34 ad ae 9b 37 df cd  88 ae fc 6a ac c5 cf 16  |U4...7.....j....|
-00000100  ec f1 bc 22 1e d2 c1 52  5e a2 e7 d2 6e 37 7a 29  |..."...R^...n7z)|
-00000110  c8 b9 d4 7d 81 63 1a f0  53 d9 10 fd 4f 3d 1c dd  |...}.c..S...O=..|
-00000120  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000130  00 00 00 00 00 8f f2 11  0d 93 99 83 29 d4 10 a4  |............)...|
-00000140  7c bb 26 7b 24 f1 15 3a  9b 81 0e cb 0a 51 4b 39  ||.&{$..:.....QK9|
-00000150  69 1d e5 38 5e                                    |i..8^|
+00000000  16 03 03 00 7b 04 00 00  77 00 00 00 00 00 71 00  |....{...w.....q.|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
+00000020  6f 2c 9f 83 51 ed 14 ef  68 ca 42 c5 4c 09 d9 1a  |o,..Q...h.B.L...|
+00000030  35 06 6b 87 4b 07 92 7a  3d b6 f7 6f b1 22 05 e2  |5.k.K..z=..o."..|
+00000040  f1 65 17 8b 98 1a f3 ab  25 77 21 06 50 4d a7 f3  |.e......%w!.PM..|
+00000050  61 8c 2d 33 54 e9 39 bf  95 11 f3 fd e3 49 38 16  |a.-3T.9......I8.|
+00000060  4d 3c 28 3b 16 c6 30 68  d0 96 97 3e d3 96 c8 b0  |M<(;..0h...>....|
+00000070  f2 93 90 99 07 4a 82 fc  fe 97 4c 2d 09 a8 4f bb  |.....J....L-..O.|
+00000080  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
+00000090  00 00 00 00 00 00 00 00  00 00 00 47 50 7b 4f 31  |...........GP{O1|
+000000a0  c9 bf 4c 45 02 2b 44 22  11 37 d5 a0 d9 13 09 1e  |..LE.+D".7......|
+000000b0  c8 c9 a3 6b 87 aa 6d c7  2d 9f 54 5f 81 2f a5 8e  |...k..m.-.T_./..|
+000000c0  ee d4 72 1b ab 68 4f df  4d 8c be 17 03 03 00 40  |..r..hO.M......@|
+000000d0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+000000e0  21 ed 3a 4a 11 ba 97 d4  f7 59 74 80 88 85 66 1a  |!.:J.....Yt...f.|
+000000f0  c0 bb 7e 7b 1c 08 0d 54  9a 1c db 98 16 96 a5 aa  |..~{...T........|
+00000100  5b ae 90 1c ed 45 07 58  3f 35 02 77 eb 11 f8 c0  |[....E.X?5.w....|
+00000110  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
+00000120  00 00 00 00 00 83 11 49  44 fb 94 bf d6 7c 15 8e  |.......ID....|..|
+00000130  ec 71 f9 be f2 37 16 4a  9d 6b 0e f0 9b b3 3f f6  |.q...7.J.k....?.|
+00000140  ee 42 9f b4 2c                                    |.B..,|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-Resume b/src/crypto/tls/testdata/Server-TLSv12-Resume
index 456fe2a17d..d159de8ef7 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-Resume
+++ b/src/crypto/tls/testdata/Server-TLSv12-Resume
@@ -1,46 +1,53 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 12 01 00 01  0e 03 03 90 27 78 df 71  |............'x.q|
-00000010  d3 0e ce 1d de ec d2 1b  70 e0 89 da 98 a9 45 3e  |........p.....E>|
-00000020  9c ee 93 90 8f 61 d0 a3  b4 a4 5a 20 9d cd d4 81  |.....a....Z ....|
-00000030  e2 c0 59 81 21 bc 9f 2a  84 3e 91 15 3e b9 c0 a1  |..Y.!..*.>..>...|
-00000040  e0 6b 73 9c 45 53 03 ad  b9 e6 c2 77 00 04 00 2f  |.ks.ES.....w.../|
-00000050  00 ff 01 00 00 c1 00 23  00 81 50 46 ad c1 db a8  |.......#..PF....|
-00000060  38 86 7b 2b bb fd d0 c3  42 3e 00 00 00 00 00 00  |8.{+....B>......|
-00000070  00 00 00 00 00 00 00 00  00 00 94 6f 2c 9f 83 51  |...........o,..Q|
-00000080  ed 14 ef 68 ca 42 c5 4c  75 5e a5 6f d2 49 61 e4  |...h.B.Lu^.o.Ia.|
-00000090  fb 83 46 7c 4c ab f9 c6  d1 3c 9e 5b 8d d8 bc c0  |..F|L....<.[....|
-000000a0  a5 2d 84 db 24 dd a0 16  60 1d 87 a0 52 88 25 6c  |.-..$...`...R.%l|
-000000b0  c6 8e 5b 71 0f 74 c3 48  49 38 16 92 8c de 77 bd  |..[q.t.HI8....w.|
-000000c0  8a 2b 45 4d 58 86 40 b1  d6 0f 99 de 27 41 b2 41  |.+EMX.@.....'A.A|
-000000d0  27 aa fe 26 e9 24 91 2a  00 ff 08 00 16 00 00 00  |'..&.$.*........|
-000000e0  17 00 00 00 0d 00 30 00  2e 04 03 05 03 06 03 08  |......0.........|
-000000f0  07 08 08 08 09 08 0a 08  0b 08 04 08 05 08 06 04  |................|
-00000100  01 05 01 06 01 03 03 02  03 03 01 02 01 03 02 02  |................|
-00000110  02 04 02 05 02 06 02                              |.......|
+00000000  16 03 01 01 02 01 00 00  fe 03 03 e3 e1 0d a8 3d  |...............=|
+00000010  e9 cb 74 24 6a 25 53 ec  29 6d 19 89 78 e4 24 71  |..t$j%S.)m..x.$q|
+00000020  bb b8 e1 02 75 1d 1b 62  b2 d1 8b 20 6b d1 d9 2c  |....u..b... k..,|
+00000030  43 20 d8 cb bd fe b9 0e  f0 84 36 03 d8 07 d0 04  |C ........6.....|
+00000040  8d 16 e3 fa 68 04 83 b7  87 1b 2b ea 00 04 00 2f  |....h.....+..../|
+00000050  00 ff 01 00 00 b1 00 23  00 71 00 00 00 00 00 00  |.......#.q......|
+00000060  00 00 00 00 00 00 00 00  00 00 94 6f 2c 9f 83 51  |...........o,..Q|
+00000070  ed 14 ef 68 ca 42 c5 4c  97 70 11 14 b7 27 54 f2  |...h.B.L.p...'T.|
+00000080  0b 35 d5 93 d8 86 9e 86  0d 11 33 11 84 b9 59 93  |.5........3...Y.|
+00000090  6a 5e 6e 08 47 99 d9 5f  9f 69 0e 93 08 3b 97 12  |j^n.G.._.i...;..|
+000000a0  68 d8 55 e9 f8 d0 69 88  49 38 16 d9 3f 52 8c 19  |h.U...i.I8..?R..|
+000000b0  e1 48 5e 98 ea cb 31 f9  bd 50 3e 89 32 ed 0e 48  |.H^...1..P>.2..H|
+000000c0  fa 8f 86 87 da 06 f5 c7  8a b7 00 00 16 00 00 00  |................|
+000000d0  17 00 00 00 0d 00 30 00  2e 04 03 05 03 06 03 08  |......0.........|
+000000e0  07 08 08 08 09 08 0a 08  0b 08 04 08 05 08 06 04  |................|
+000000f0  01 05 01 06 01 03 03 02  03 03 01 02 01 03 02 02  |................|
+00000100  02 04 02 05 02 06 02                              |.......|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 51 02 00 00  4d 03 03 00 00 00 00 00  |....Q...M.......|
+00000000  16 03 03 00 55 02 00 00  51 03 03 00 00 00 00 00  |....U...Q.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 44 4f 57 4e 47  52 44 01 20 9d cd d4 81  |...DOWNGRD. ....|
-00000030  e2 c0 59 81 21 bc 9f 2a  84 3e 91 15 3e b9 c0 a1  |..Y.!..*.>..>...|
-00000040  e0 6b 73 9c 45 53 03 ad  b9 e6 c2 77 00 2f 00 00  |.ks.ES.....w./..|
-00000050  05 ff 01 00 01 00 14 03  03 00 01 01 16 03 03 00  |................|
-00000060  40 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |@...............|
-00000070  00 57 8e 5f 0a f6 3f 3b  43 f1 33 bc ef 5e c6 8d  |.W._..?;C.3..^..|
-00000080  86 92 58 58 71 51 e8 54  57 96 5f bd 36 3a 9f d3  |..XXqQ.TW._.6:..|
-00000090  e9 27 01 bf fb 6a 05 57  de 2d db b2 79 38 72 95  |.'...j.W.-..y8r.|
-000000a0  fd                                                |.|
+00000020  00 00 00 44 4f 57 4e 47  52 44 01 20 6b d1 d9 2c  |...DOWNGRD. k..,|
+00000030  43 20 d8 cb bd fe b9 0e  f0 84 36 03 d8 07 d0 04  |C ........6.....|
+00000040  8d 16 e3 fa 68 04 83 b7  87 1b 2b ea 00 2f 00 00  |....h.....+../..|
+00000050  09 00 23 00 00 ff 01 00  01 00 16 03 03 00 7b 04  |..#...........{.|
+00000060  00 00 77 00 00 00 00 00  71 00 00 00 00 00 00 00  |..w.....q.......|
+00000070  00 00 00 00 00 00 00 00  00 94 6f 2c 9f 83 51 ed  |..........o,..Q.|
+00000080  14 ef 68 ca 42 c5 4c 97  70 11 14 b7 27 54 f2 0b  |..h.B.L.p...'T..|
+00000090  35 d5 93 d8 86 9e 86 0d  11 33 11 84 b9 59 93 6a  |5........3...Y.j|
+000000a0  5e 6e 08 47 99 d9 5f 9f  69 0e 93 08 3b 97 12 68  |^n.G.._.i...;..h|
+000000b0  d8 55 e9 f8 d0 69 88 49  38 16 d9 3f 52 8c 19 e1  |.U...i.I8..?R...|
+000000c0  48 5e 98 ea cb 31 f9 bd  50 3e 89 32 ed 0e 48 fa  |H^...1..P>.2..H.|
+000000d0  8f 86 87 da 06 f5 c7 8a  b7 00 14 03 03 00 01 01  |................|
+000000e0  16 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
+000000f0  00 00 00 00 00 d4 c4 c1  96 eb 80 4c e9 74 73 a2  |...........L.ts.|
+00000100  d8 35 09 8c b6 f6 4f 7c  3c 21 36 c7 94 36 37 48  |.5....O|<!6..67H|
+00000110  a0 eb fa 71 dd f9 1f 99  e9 44 ae 80 15 b0 90 d9  |...q.....D......|
+00000120  a2 82 b5 4e 86                                    |...N.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 16 03  03 00 40 6d 3c 76 31 a4  |..........@m<v1.|
-00000010  c5 41 d4 67 9f 20 7d 3e  f4 35 76 02 ef a2 4b 18  |.A.g. }>.5v...K.|
-00000020  01 f8 a8 83 0c eb 58 f7  d6 93 c6 b6 40 0e c8 24  |......X.....@..$|
-00000030  46 58 0c 79 4a c6 b4 15  65 1e 9c bd ff 51 4d d0  |FX.yJ...e....QM.|
-00000040  44 66 fe c0 98 d5 26 11  98 cf 52                 |Df....&...R|
+00000000  14 03 03 00 01 01 16 03  03 00 40 86 f3 8d ad ab  |..........@.....|
+00000010  d5 20 16 bd c0 97 60 77  08 99 c7 7b 47 20 9b 37  |. ....`w...{G .7|
+00000020  da 0b 21 99 0a 22 6a 43  92 5c 89 11 10 c6 e2 99  |..!.."jC.\......|
+00000030  01 5b f4 ce 18 0d 16 3f  57 0d fb b3 b4 f2 a5 8d  |.[.....?W.......|
+00000040  97 4f 60 b3 41 22 49 43  55 4f f5                 |.O`.A"ICUO.|
 >>> Flow 4 (server to client)
 00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000010  00 00 00 00 00 4e 8e bd  e5 c8 d4 1a 14 00 f1 ed  |.....N..........|
-00000020  c4 88 b3 5c 92 b9 ad 8a  68 d4 f3 85 1b 02 25 aa  |...\....h.....%.|
-00000030  a0 65 49 08 0d 2a b4 0a  64 eb ea ab 06 73 08 ca  |.eI..*..d....s..|
-00000040  62 c9 56 45 a9 15 03 03  00 30 00 00 00 00 00 00  |b.VE.....0......|
-00000050  00 00 00 00 00 00 00 00  00 00 60 51 ae 81 79 6d  |..........`Q..ym|
-00000060  91 95 02 42 30 3f c4 3c  2b fc 74 47 a7 a9 17 22  |...B0?.<+.tG..."|
-00000070  88 26 6d 18 b9 8f ad 43  e3 b0                    |.&m....C..|
+00000010  00 00 00 00 00 c5 9b b2  da 9a 9a d8 eb cc 3c 96  |..............<.|
+00000020  4a d1 28 e8 dd b1 b3 b8  1c bd 9f fb ee f8 05 95  |J.(.............|
+00000030  47 a5 c5 77 de e1 66 c8  04 3f 4e 49 d0 95 3d 11  |G..w..f..?NI..=.|
+00000040  5e 7e 10 3d 15 15 03 03  00 30 00 00 00 00 00 00  |^~.=.....0......|
+00000050  00 00 00 00 00 00 00 00  00 00 cf c4 0c 9e 82 c2  |................|
+00000060  89 30 4c 29 98 6e 0e d1  37 3d f7 54 d3 1c 2e a6  |.0L).n..7=.T....|
+00000070  cd 3a b7 7b 58 ed fb 88  c6 f2                    |.:.{X.....|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-AES128-SHA256 b/src/crypto/tls/testdata/Server-TLSv13-AES128-SHA256
index a071f60cd9..5c4eaa6ae3 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-AES128-SHA256
+++ b/src/crypto/tls/testdata/Server-TLSv13-AES128-SHA256
@@ -1,100 +1,97 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 dc 01 00 00  d8 03 03 5f b5 79 18 5f  |..........._.y._|
-00000010  d2 f8 b0 fc da 39 90 af  e1 ba 04 b5 70 86 c3 6b  |.....9......p..k|
-00000020  ba b4 87 e3 81 9a 86 02  9b 26 44 20 21 e3 5b 03  |.........&D !.[.|
-00000030  0d 0a 6c 1f 71 ea b4 4c  56 aa b6 d1 e8 91 d6 7b  |..l.q..LV......{|
-00000040  59 12 63 af db d2 69 80  cd 5f 62 22 00 04 13 01  |Y.c...i.._b"....|
-00000050  00 ff 01 00 00 8b 00 00  00 0e 00 0c 00 00 09 31  |...............1|
-00000060  32 37 2e 30 2e 30 2e 31  00 0b 00 04 03 00 01 02  |27.0.0.1........|
-00000070  00 0a 00 0c 00 0a 00 1d  00 17 00 1e 00 19 00 18  |................|
-00000080  00 16 00 00 00 17 00 00  00 0d 00 1e 00 1c 04 03  |................|
-00000090  05 03 06 03 08 07 08 08  08 09 08 0a 08 0b 08 04  |................|
-000000a0  08 05 08 06 04 01 05 01  06 01 00 2b 00 03 02 03  |...........+....|
-000000b0  04 00 2d 00 02 01 01 00  33 00 26 00 24 00 1d 00  |..-.....3.&.$...|
-000000c0  20 57 12 bc 06 e0 46 c7  75 43 b8 af f9 c1 f6 b8  | W....F.uC......|
-000000d0  e4 1e 13 6b 02 07 23 d2  e6 89 ec 18 ab c0 9f ae  |...k..#.........|
-000000e0  69                                                |i|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 20 8e 6e 42 f8  |........... .nB.|
+00000010  66 a3 a0 2f 80 18 4c d8  cd 7c f1 34 96 fd dc fe  |f../..L..|.4....|
+00000020  cd bc f6 46 12 b8 2b 2c  e5 99 66 20 6b 7f cf e7  |...F..+,..f k...|
+00000030  da 4b d9 f4 5e b5 57 42  af db ec 7a 0a ff 03 da  |.K..^.WB...z....|
+00000040  a3 4b cd 15 fc a0 29 5a  2d 0c 24 99 00 04 13 01  |.K....)Z-.$.....|
+00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
+00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
+00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
+00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
+00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 4d  |-.....3.&.$... M|
+000000b0  20 d9 e8 7f 1d 51 f9 f7  2c 7e 3e f1 59 76 4c 75  | ....Q..,~>.YvLu|
+000000c0  26 3f 3b ec dd fc f8 78  15 3e 5f 61 f5 ed 37     |&?;....x.>_a..7|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 21 e3 5b 03  |........... !.[.|
-00000030  0d 0a 6c 1f 71 ea b4 4c  56 aa b6 d1 e8 91 d6 7b  |..l.q..LV......{|
-00000040  59 12 63 af db d2 69 80  cd 5f 62 22 13 01 00 00  |Y.c...i.._b"....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 6b 7f cf e7  |........... k...|
+00000030  da 4b d9 f4 5e b5 57 42  af db ec 7a 0a ff 03 da  |.K..^.WB...z....|
+00000040  a3 4b cd 15 fc a0 29 5a  2d 0c 24 99 13 01 00 00  |.K....)Z-.$.....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 be 8f 95 d9 22 d7  |..............".|
-00000090  f7 ff 75 78 b6 9c bc 93  23 2f 76 62 c6 cd c6 92  |..ux....#/vb....|
-000000a0  fe 17 03 03 02 6d 31 54  c9 32 d0 38 53 8f f0 15  |.....m1T.2.8S...|
-000000b0  03 42 16 39 71 61 f9 17  f2 da c5 2e 4c 19 c3 30  |.B.9qa......L..0|
-000000c0  d5 c6 b8 ea 5d 3b 47 1b  d9 20 31 64 ab 5c f3 00  |....];G.. 1d.\..|
-000000d0  43 5b e7 3b 36 69 12 c9  3b 3d e7 4f 91 72 e4 29  |C[.;6i..;=.O.r.)|
-000000e0  93 54 65 50 88 07 b9 e2  ed 5e 18 f7 00 0a 49 e5  |.TeP.....^....I.|
-000000f0  19 cc d8 e5 b2 c5 f6 bd  34 7a 7f e2 f1 7c 9d a0  |........4z...|..|
-00000100  d6 0c 50 4f 80 8a c5 a1  fe b8 2e 54 7c 0c ae 48  |..PO.......T|..H|
-00000110  c5 ff 46 d9 45 e6 c0 df  61 74 fc d5 e8 ec e1 84  |..F.E...at......|
-00000120  0b c8 df 73 77 e4 9f 13  e5 52 e5 0b d8 9f 65 b7  |...sw....R....e.|
-00000130  89 d5 04 74 f8 8d a6 2a  c7 a1 76 ff 27 85 6a bb  |...t...*..v.'.j.|
-00000140  ee 86 c9 38 5a 54 bc ac  bc ad 79 85 7c 26 65 c3  |...8ZT....y.|&e.|
-00000150  36 97 56 76 d2 4c 55 32  71 82 ec d1 81 22 46 9e  |6.Vv.LU2q...."F.|
-00000160  75 d8 55 a8 1e 61 10 c8  dc e8 c7 ad fe 96 0e 54  |u.U..a.........T|
-00000170  1c 79 0c 41 b9 98 b0 44  f8 45 6e c7 b3 41 68 2d  |.y.A...D.En..Ah-|
-00000180  ea 73 be 55 99 fe 88 02  e3 5d 0f f3 d1 70 9a 5e  |.s.U.....]...p.^|
-00000190  be e7 80 96 6c 94 7f 9f  ec 1c b6 24 28 ef 90 95  |....l......$(...|
-000001a0  d5 5b d4 7b 1b b1 a4 9c  66 09 11 23 ad f5 87 ee  |.[.{....f..#....|
-000001b0  0b 1f e5 d2 0e 57 16 e9  14 ae 0f 98 9b a1 bc 9e  |.....W..........|
-000001c0  68 dc d0 fb 76 aa c8 f2  bc e5 d3 ff e2 85 df 01  |h...v...........|
-000001d0  2f ad 72 78 85 0f f7 0a  64 a4 cd 61 2a e6 2b a3  |/.rx....d..a*.+.|
-000001e0  d5 4a c9 08 00 af 5c 6c  9d 35 e4 1e 7c 32 1a d0  |.J....\l.5..|2..|
-000001f0  f3 6d 73 16 9c c8 72 28  4b 67 cf d8 ff 2b 1e 33  |.ms...r(Kg...+.3|
-00000200  18 c4 ed c9 31 5d 6a 0f  c5 05 bf 08 eb 0b 44 05  |....1]j.......D.|
-00000210  83 49 40 d2 1f 7f 5c 08  ef 98 1f 09 f1 09 33 02  |.I@...\.......3.|
-00000220  56 04 66 53 69 93 ef 07  0d 8a e7 84 b5 03 b9 78  |V.fSi..........x|
-00000230  bb 52 84 3f bb 4e d3 f9  c4 8a 2a d1 59 02 59 36  |.R.?.N....*.Y.Y6|
-00000240  88 52 6a 9d 1f 7e c1 5b  a6 8a a4 cc 42 f4 44 59  |.Rj..~.[....B.DY|
-00000250  ca d2 fa 0e 09 5f 25 e5  cc 27 55 8b 16 b5 f1 62  |....._%..'U....b|
-00000260  aa f7 a9 bc 7a 36 fa 16  34 b7 ce 2d b8 bd 67 f0  |....z6..4..-..g.|
-00000270  75 15 17 c4 49 81 55 b1  5a e0 d2 b8 45 79 d0 16  |u...I.U.Z...Ey..|
-00000280  71 21 01 57 ad 10 48 1f  0d bf 43 da b7 c9 a8 93  |q!.W..H...C.....|
-00000290  88 af be 2d 65 a0 81 26  23 de fe e2 a3 9c f6 40  |...-e..&#......@|
-000002a0  96 f9 a1 21 0b fe 31 7f  24 ec 75 ae cf b0 8c a7  |...!..1.$.u.....|
-000002b0  fe f8 2f ee 60 65 72 5c  86 a6 45 22 11 55 62 29  |../.`er\..E".Ub)|
-000002c0  02 8b b5 ff 4b f8 73 71  3d 8c c3 37 68 2d 2c 24  |....K.sq=..7h-,$|
-000002d0  b7 dc be 5a 37 d8 25 3b  b6 16 e6 2a e9 80 48 0b  |...Z7.%;...*..H.|
-000002e0  77 be 05 35 b2 86 97 51  49 31 ac de 85 eb a9 a8  |w..5...QI1......|
-000002f0  74 1d 00 07 4c 1b 8c a5  ec 1b b5 7a 57 84 da 40  |t...L......zW..@|
-00000300  10 6c c9 ed b3 43 06 81  11 e2 84 3c 4c ae 22 6b  |.l...C.....<L."k|
-00000310  e6 96 dc 17 03 03 00 99  2b 4a 51 8f 5e c1 82 70  |........+JQ.^..p|
-00000320  e7 e2 ca 34 cb d1 24 c9  da 69 06 7c 75 d0 0f 16  |...4..$..i.|u...|
-00000330  cc 9c e1 26 60 d0 cc 18  16 18 15 f0 26 f8 d4 d7  |...&`.......&...|
-00000340  f8 81 77 0c 68 cd fe 7a  28 d6 32 60 29 c3 e2 87  |..w.h..z(.2`)...|
-00000350  9b 1c ad 3b 7d 42 31 23  74 61 f5 b7 28 5f 5a 8a  |...;}B1#ta..(_Z.|
-00000360  16 98 f8 74 01 63 7d 0a  2c 51 d7 5e 04 8b 2e 58  |...t.c}.,Q.^...X|
-00000370  c3 6f d7 4a 1e fa 55 84  8d a9 24 ef de 4c e3 2e  |.o.J..U...$..L..|
-00000380  44 2b 1f e8 b4 a2 6f cc  e6 a6 d2 1f fa 60 ab 20  |D+....o......`. |
-00000390  e0 06 8e 00 1a 24 57 50  93 e5 71 d0 cc 63 9b 60  |.....$WP..q..c.`|
-000003a0  f8 e9 c2 de 4b 65 b6 9a  3b dd 60 d6 fb 37 c7 3c  |....Ke..;.`..7.<|
-000003b0  e2 17 03 03 00 35 82 7c  22 13 69 48 00 19 51 5c  |.....5.|".iH..Q\|
-000003c0  9d 19 3b 1a 25 a9 b8 db  9b c3 25 40 c9 ed c7 dd  |..;.%.....%@....|
-000003d0  e6 31 e7 55 ed 48 f0 af  95 1b 0e ca 9a f4 7f 60  |.1.U.H.........`|
-000003e0  03 11 e8 51 57 5e df 4e  c2 ec 7a 17 03 03 00 93  |...QW^.N..z.....|
-000003f0  76 84 60 d6 f5 6f 27 c2  47 88 fa 80 78 a6 22 0a  |v.`..o'.G...x.".|
-00000400  16 a6 26 12 1b 14 6c 6f  40 10 ce 7c 7c 16 f9 64  |..&...lo@..||..d|
-00000410  e6 98 13 51 36 b0 41 d9  6d 9c fb ba 3e 59 9d 33  |...Q6.A.m...>Y.3|
-00000420  76 f0 23 23 27 94 df 2f  21 6a c0 a9 5a 3d af 41  |v.##'../!j..Z=.A|
-00000430  31 4d 9b d5 75 57 f1 a9  c5 57 2a 7a c7 1d b1 a7  |1M..uW...W*z....|
-00000440  15 a5 80 ae 63 f8 85 92  46 13 d2 31 26 62 7d 83  |....c...F..1&b}.|
-00000450  95 f9 97 9d e8 86 7d 09  f3 cc 30 b1 db 54 2a 8d  |......}...0..T*.|
-00000460  0f 04 da d9 cf 59 52 2a  e3 7d 64 20 f3 26 4a 2e  |.....YR*.}d .&J.|
-00000470  74 07 c5 2f 98 a2 f7 e1  53 01 e0 c2 3b c7 42 1b  |t../....S...;.B.|
-00000480  a0 48 12                                          |.H.|
+00000080  03 03 00 01 01 17 03 03  00 17 6e 64 88 75 8a 9e  |..........nd.u..|
+00000090  99 4b a7 f5 55 5e 7a 04  01 30 90 1d 94 60 b3 95  |.K..U^z..0...`..|
+000000a0  d7 17 03 03 02 6d d9 61  f0 95 5c 13 9a fc 6a 73  |.....m.a..\...js|
+000000b0  a0 a8 e9 ea 64 81 94 12  68 05 c3 fd f9 8b 26 4d  |....d...h.....&M|
+000000c0  c8 cf 51 37 d7 19 32 b1  32 1b 8e 3c f4 c2 02 a8  |..Q7..2.2..<....|
+000000d0  a2 13 cd a2 3d f3 d1 62  82 b0 d4 aa ab e9 53 c0  |....=..b......S.|
+000000e0  19 4b 4b 80 6c 54 b7 79  06 73 73 cf 75 d8 4b 53  |.KK.lT.y.ss.u.KS|
+000000f0  3e d3 9c 1e 54 fa e5 24  9a be 84 89 a2 fb bb 21  |>...T..$.......!|
+00000100  3a d1 f5 df 17 5f d7 b5  5a 82 a4 77 70 2f 36 17  |:...._..Z..wp/6.|
+00000110  d9 ef 03 40 88 b5 68 f6  df fc 94 df ce 8a af d7  |...@..h.........|
+00000120  ed 12 3d 4b d8 cf 5b 6a  0b c5 a4 5a c6 b6 2d 19  |..=K..[j...Z..-.|
+00000130  02 03 d1 3c ef ea a6 ee  50 bb b6 ba 0e 67 b3 25  |...<....P....g.%|
+00000140  6f d7 e1 50 89 7d 40 3a  79 11 1c a0 c8 1e 33 bb  |o..P.}@:y.....3.|
+00000150  81 ad 32 00 47 f9 7f f8  0e 0b b9 d0 61 5a 2d 60  |..2.G.......aZ-`|
+00000160  03 6f d0 fc 22 11 84 6e  a8 76 7d 77 87 af 1b 1d  |.o.."..n.v}w....|
+00000170  04 f0 fa 45 29 f0 e7 38  b6 1a 4e 30 28 a7 81 7d  |...E)..8..N0(..}|
+00000180  9f 9c 23 cb f1 98 77 db  56 47 34 d9 4d 6e 3e cb  |..#...w.VG4.Mn>.|
+00000190  64 52 6d fe cb 26 0e c0  f9 36 36 67 24 50 b8 31  |dRm..&...66g$P.1|
+000001a0  04 dc 99 58 68 72 96 ef  d9 fb 51 b2 87 14 80 c4  |...Xhr....Q.....|
+000001b0  5b 3a f1 cf fb a0 0f d0  c8 26 aa 71 99 82 9d be  |[:.......&.q....|
+000001c0  d1 83 86 91 85 21 38 ec  81 bd c2 59 51 9d 67 a4  |.....!8....YQ.g.|
+000001d0  eb 10 52 c0 ca 2b c9 cc  6e 32 59 50 71 3a f4 f0  |..R..+..n2YPq:..|
+000001e0  b0 48 93 d1 b8 48 08 3b  dd d3 1e f5 20 ca df 36  |.H...H.;.... ..6|
+000001f0  05 70 67 2e e0 aa 88 50  2a a4 a2 de b1 70 bf 67  |.pg....P*....p.g|
+00000200  57 ed cf b4 b2 44 61 77  94 9f d9 a1 51 95 1d 24  |W....Daw....Q..$|
+00000210  b1 23 65 74 28 a9 fc 3e  83 8e aa 04 f9 42 f3 02  |.#et(..>.....B..|
+00000220  37 93 34 4f 07 2f 00 dd  40 a7 6f 77 c2 8d a5 77  |7.4O./..@.ow...w|
+00000230  95 d1 af ff 8c 70 28 15  0a bc 66 f4 4e 8b be 70  |.....p(...f.N..p|
+00000240  51 96 13 5f 12 9d 41 0a  ac e7 b6 24 50 12 ac 57  |Q.._..A....$P..W|
+00000250  cf 84 a8 75 13 cc a3 07  9e 4b 04 d8 6c 43 4a 20  |...u.....K..lCJ |
+00000260  97 0a 74 e5 79 ad dd 45  cc 3a e7 cc 8c 07 40 cb  |..t.y..E.:....@.|
+00000270  39 29 d5 73 82 41 3c 86  f4 16 75 c5 8e 46 2d dc  |9).s.A<...u..F-.|
+00000280  25 ae fa 3a 81 3a b2 79  a7 c4 02 c5 25 61 69 e3  |%..:.:.y....%ai.|
+00000290  a1 6f 59 5b 2a d8 65 4b  3c 5f fd 77 20 d0 ec f6  |.oY[*.eK<_.w ...|
+000002a0  1e e3 b6 a2 03 ba 1f e0  34 b4 2f eb 6e 85 ca 77  |........4./.n..w|
+000002b0  da ff 42 e8 91 99 f8 f8  d0 91 00 9c 26 c6 9c 54  |..B.........&..T|
+000002c0  1f 78 67 26 eb f2 20 59  ec 63 21 60 ce 51 10 4e  |.xg&.. Y.c!`.Q.N|
+000002d0  c2 32 dd 72 26 04 31 43  ed 68 34 54 8a 88 04 28  |.2.r&.1C.h4T...(|
+000002e0  66 e5 90 cc fa 20 e8 1f  c7 31 c5 8c 4d 32 4c 0d  |f.... ...1..M2L.|
+000002f0  45 0e fd 74 85 24 7e 7f  8b 56 18 9a 54 15 52 4e  |E..t.$~..V..T.RN|
+00000300  92 49 c4 ab 99 16 d8 01  61 d9 0b f0 5f 26 c3 7c  |.I......a..._&.||
+00000310  52 b5 bf 17 03 03 00 99  1e f8 19 a2 6e ac 2c 1e  |R...........n.,.|
+00000320  b3 7b ec f3 68 cf 13 c1  bb 03 a0 ea 5a 77 d5 61  |.{..h.......Zw.a|
+00000330  0a 0e 62 de 8d 56 d6 ff  3f 7a 91 f2 72 24 1d dc  |..b..V..?z..r$..|
+00000340  6e c7 bf e8 b8 98 5c eb  3c af 0d f7 89 22 db 53  |n.....\.<....".S|
+00000350  db 67 f9 20 c0 c4 cc 43  72 38 01 ab d3 b4 47 e5  |.g. ...Cr8....G.|
+00000360  7b 9a f4 0d 04 61 30 89  81 18 7d 90 86 c3 1b c9  |{....a0...}.....|
+00000370  e8 58 0a 62 42 cd 7f 05  77 a9 4e 75 fa 3a fd 13  |.X.bB...w.Nu.:..|
+00000380  98 90 92 f3 ee a8 cb 87  3e 62 d5 1e 81 4b 1b 79  |........>b...K.y|
+00000390  21 af b1 96 3f be eb de  52 c5 d5 d1 c2 da 47 2c  |!...?...R.....G,|
+000003a0  fd c5 26 41 f5 f9 00 82  9a 16 84 40 30 a9 89 96  |..&A.......@0...|
+000003b0  68 17 03 03 00 35 0c 40  10 4f 17 d9 1b cc 15 f0  |h....5.@.O......|
+000003c0  f2 f7 04 ea 07 66 c5 58  ce 47 56 b5 59 9b 8c 15  |.....f.X.GV.Y...|
+000003d0  d0 74 77 2f 96 f5 c2 9c  90 b6 16 70 aa bb 22 b8  |.tw/.......p..".|
+000003e0  2b f0 19 e8 a4 52 dc 80  4e ff 3a 17 03 03 00 83  |+....R..N.:.....|
+000003f0  24 8a ab e9 d3 a9 1b b3  d2 49 27 64 29 1b 9e 76  |$........I'd)..v|
+00000400  46 2d f0 db 01 7d 54 8e  53 9f b0 9e 03 90 92 c5  |F-...}T.S.......|
+00000410  d8 e1 1e ce 54 7f c3 30  3c a7 32 98 97 b6 3f 84  |....T..0<.2...?.|
+00000420  14 02 83 fe 70 1b ae 74  e4 5c 3d 67 d8 f7 58 14  |....p..t.\=g..X.|
+00000430  fb 09 71 27 ae 97 75 77  98 03 98 06 3f cf 80 c2  |..q'..uw....?...|
+00000440  43 ee ad bf 46 f6 f1 9f  86 d9 1a 85 07 b6 a3 b5  |C...F...........|
+00000450  e1 5e 01 a6 05 27 ed 78  4d 83 66 4f fe 4c 6f 9a  |.^...'.xM.fO.Lo.|
+00000460  59 25 65 52 4a 8d 5e 7a  2b 99 cc 7e 92 de 8d 19  |Y%eRJ.^z+..~....|
+00000470  0c d2 3d                                          |..=|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 57 4a c4 5a c1  |..........5WJ.Z.|
-00000010  3a b9 ae f0 1d e8 8f 31  38 0e 64 9e 61 13 e6 b2  |:......18.d.a...|
-00000020  1b 02 aa b6 46 5a 50 97  07 93 86 13 dc 3d 76 6a  |....FZP......=vj|
-00000030  67 01 1b 18 9b 7e 21 b2  c1 d4 a5 25 22 4d 14 dc  |g....~!....%"M..|
+00000000  14 03 03 00 01 01 17 03  03 00 35 aa bf 81 58 da  |..........5...X.|
+00000010  aa dd 26 28 f8 e1 bb 50  50 33 58 cf 3c 65 58 ea  |..&(...PP3X.<eX.|
+00000020  c5 aa d6 98 0e c0 dc 60  c8 0a f9 ac cd 89 39 6b  |.......`......9k|
+00000030  49 1e bf 16 6a 17 4a 05  dc c6 8a 74 23 19 f2 a4  |I...j.J....t#...|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 61 63 5a  22 d2 e6 8e e8 8e 69 7d  |.....acZ".....i}|
-00000010  24 69 a5 b8 e3 59 98 ac  64 0b 34 6b 16 60 92 db  |$i...Y..d.4k.`..|
-00000020  6b 62 45 17 03 03 00 13  b7 12 c6 59 fe 23 f4 6c  |kbE........Y.#.l|
-00000030  a6 d3 8d 59 1b 40 60 72  d6 97 b4                 |...Y.@`r...|
+00000000  17 03 03 00 1e 69 ff 01  c3 f3 c3 80 2a 0e 95 39  |.....i......*..9|
+00000010  cb 50 bf 53 4a c3 f1 09  24 6d 4d f1 6a f6 89 6f  |.P.SJ...$mM.j..o|
+00000020  b4 88 db 17 03 03 00 13  17 60 23 ef 4c 1a c9 6d  |.........`#.L..m|
+00000030  50 9f 12 04 54 87 83 71  56 25 28                 |P...T..qV%(|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-AES256-SHA384 b/src/crypto/tls/testdata/Server-TLSv13-AES256-SHA384
index 60aa82df89..04ffc30e24 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-AES256-SHA384
+++ b/src/crypto/tls/testdata/Server-TLSv13-AES256-SHA384
@@ -1,103 +1,100 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 dc 01 00 00  d8 03 03 70 b7 07 12 16  |...........p....|
-00000010  50 d7 b9 c9 5f 02 47 2d  ff 93 a7 2f e8 51 dc a0  |P..._.G-.../.Q..|
-00000020  8f 0d c8 80 38 c7 af 7e  da bb ed 20 67 73 58 d7  |....8..~... gsX.|
-00000030  11 8b c6 0d 72 86 e0 08  3e 2d d9 b9 16 9f 85 6e  |....r...>-.....n|
-00000040  3c 87 fd 87 c3 95 f6 4c  76 21 50 af 00 04 13 02  |<......Lv!P.....|
-00000050  00 ff 01 00 00 8b 00 00  00 0e 00 0c 00 00 09 31  |...............1|
-00000060  32 37 2e 30 2e 30 2e 31  00 0b 00 04 03 00 01 02  |27.0.0.1........|
-00000070  00 0a 00 0c 00 0a 00 1d  00 17 00 1e 00 19 00 18  |................|
-00000080  00 16 00 00 00 17 00 00  00 0d 00 1e 00 1c 04 03  |................|
-00000090  05 03 06 03 08 07 08 08  08 09 08 0a 08 0b 08 04  |................|
-000000a0  08 05 08 06 04 01 05 01  06 01 00 2b 00 03 02 03  |...........+....|
-000000b0  04 00 2d 00 02 01 01 00  33 00 26 00 24 00 1d 00  |..-.....3.&.$...|
-000000c0  20 f4 08 51 f6 69 b7 d6  a9 3e 18 a7 ee c0 30 f3  | ..Q.i...>....0.|
-000000d0  13 63 52 40 30 7c 79 6c  24 03 c9 89 25 bd a4 5f  |.cR@0|yl$...%.._|
-000000e0  64                                                |d|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 80 f9 84 75 26  |..............u&|
+00000010  26 2f 35 8e 6e fb df 99  88 7f 74 c8 01 d4 58 26  |&/5.n.....t...X&|
+00000020  26 9b f3 ba 0b fe 5f 09  31 96 73 20 b8 21 95 68  |&....._.1.s .!.h|
+00000030  4d 05 b2 c3 da dc a7 da  a5 67 12 8c a0 05 e5 66  |M........g.....f|
+00000040  28 c2 fa 88 5a a9 08 62  71 b6 7a 6a 00 04 13 02  |(...Z..bq.zj....|
+00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
+00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
+00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
+00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
+00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 8d  |-.....3.&.$... .|
+000000b0  b6 28 b1 e3 a4 3e 2f bd  5c 73 88 40 30 8e 85 da  |.(...>/.\s.@0...|
+000000c0  a9 dc eb 5d d1 91 f8 b6  36 71 90 1b 3a 26 0a     |...]....6q..:&.|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 67 73 58 d7  |........... gsX.|
-00000030  11 8b c6 0d 72 86 e0 08  3e 2d d9 b9 16 9f 85 6e  |....r...>-.....n|
-00000040  3c 87 fd 87 c3 95 f6 4c  76 21 50 af 13 02 00 00  |<......Lv!P.....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 b8 21 95 68  |........... .!.h|
+00000030  4d 05 b2 c3 da dc a7 da  a5 67 12 8c a0 05 e5 66  |M........g.....f|
+00000040  28 c2 fa 88 5a a9 08 62  71 b6 7a 6a 13 02 00 00  |(...Z..bq.zj....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 cc b9 e4 43 5e f6  |.............C^.|
-00000090  9a 5a 62 14 02 39 fb 13  76 e8 10 db 26 1c 07 ec  |.Zb..9..v...&...|
-000000a0  06 17 03 03 02 6d 39 e9  a0 33 ee 39 36 54 62 f1  |.....m9..3.96Tb.|
-000000b0  e9 1d 32 45 0f 5a ca 72  f7 7e 43 d8 89 97 00 3d  |..2E.Z.r.~C....=|
-000000c0  59 70 08 b4 d1 e1 84 24  7a b8 45 3c b8 32 93 b5  |Yp.....$z.E<.2..|
-000000d0  51 a5 58 60 3f 60 52 aa  c1 ff 85 fb fd 50 87 38  |Q.X`?`R......P.8|
-000000e0  47 7a 88 c6 d1 e6 3c b3  16 14 5b cb 23 50 26 7a  |Gz....<...[.#P&z|
-000000f0  1d 28 d1 d2 29 5d b0 40  97 2f 3b 58 7c 8a 76 1f  |.(..)].@./;X|.v.|
-00000100  1c c1 d2 2b 63 9d 53 bc  fb c2 42 cb 40 0d d0 7c  |...+c.S...B.@..||
-00000110  73 6c dc 63 90 89 e3 66  67 2b a2 70 af e0 af fe  |sl.c...fg+.p....|
-00000120  0c c0 db 41 76 d0 16 37  2a 09 7a 79 31 03 c6 4a  |...Av..7*.zy1..J|
-00000130  f4 06 22 ac 96 b4 25 1f  54 11 24 c8 67 22 8f 2a  |.."...%.T.$.g".*|
-00000140  56 0c 24 fa 20 ed a8 37  66 f7 38 44 43 e2 e6 e3  |V.$. ..7f.8DC...|
-00000150  96 b5 d5 dd a5 2c 23 e4  57 57 7d 7a 59 e2 4f 66  |.....,#.WW}zY.Of|
-00000160  c4 29 d6 d1 32 a3 9c 4c  dd 63 b2 a6 dc ff 6f 61  |.)..2..L.c....oa|
-00000170  c2 db 88 80 23 c1 27 d4  be dd 4f b4 c9 b8 56 4c  |....#.'...O...VL|
-00000180  65 b6 f8 32 b2 60 7b af  5f 54 71 61 20 db 25 85  |e..2.`{._Tqa .%.|
-00000190  34 b6 58 9b 71 01 dd 53  cd 13 65 2e 23 69 96 0e  |4.X.q..S..e.#i..|
-000001a0  89 94 75 09 64 60 76 d2  65 85 38 3d f1 0e cb 47  |..u.d`v.e.8=...G|
-000001b0  c1 2c 52 f8 ce 7a a6 9f  dd 7c 39 7e a7 f9 a6 1b  |.,R..z...|9~....|
-000001c0  c1 23 81 a6 7a b1 6c d4  3c 1c f3 71 ce 72 24 01  |.#..z.l.<..q.r$.|
-000001d0  4a 8d e9 24 47 51 73 67  dc 7a 9f 0b 63 7d 29 e1  |J..$GQsg.z..c}).|
-000001e0  3e 5e ac 72 d7 c8 d9 c2  13 de 92 dd 04 cb 09 21  |>^.r...........!|
-000001f0  ad 41 69 27 77 48 eb 87  cb 3b 23 ba 06 a3 68 96  |.Ai'wH...;#...h.|
-00000200  ad 24 35 f6 a6 03 87 a7  4d 9f d4 bf e5 8b 9f 56  |.$5.....M......V|
-00000210  54 dd 0e 08 da 29 ff eb  9b e1 0a a5 25 b1 85 be  |T....)......%...|
-00000220  f8 ae 63 f4 49 64 cc 0a  41 0e 26 8a 8e bc 6f c9  |..c.Id..A.&...o.|
-00000230  f5 41 55 80 0d bd 70 ad  85 b0 d4 8d 33 ac b6 40  |.AU...p.....3..@|
-00000240  3e 76 fc fb 8f d2 7d 06  14 d4 45 24 6e 36 46 1c  |>v....}...E$n6F.|
-00000250  06 d3 f7 f3 4c 3a a5 83  4f 75 72 77 b4 5e 37 49  |....L:..Ourw.^7I|
-00000260  41 f1 9f e6 d1 46 87 56  c8 64 28 fd 38 f0 0f 9c  |A....F.V.d(.8...|
-00000270  d0 39 ff 4b 46 56 73 0d  12 7d bf 63 b4 b8 0d 33  |.9.KFVs..}.c...3|
-00000280  6b 4a 2b f8 39 67 f1 ec  2d a6 0b 5c 91 2d d8 3e  |kJ+.9g..-..\.-.>|
-00000290  91 81 1a 37 29 c7 14 d2  be db 31 61 dc 5d b1 e4  |...7).....1a.]..|
-000002a0  64 af 14 9c 93 85 e7 5b  0e 42 63 c7 5e b5 cc 51  |d......[.Bc.^..Q|
-000002b0  ca 83 ca fa 52 bd 44 a1  1c 76 20 bc 3d 9f 82 79  |....R.D..v .=..y|
-000002c0  20 5c 01 14 e3 07 02 4c  f6 87 f7 46 b8 de 47 23  | \.....L...F..G#|
-000002d0  5d 5c b3 8f cd 96 49 51  32 3f d2 5d 92 32 19 b5  |]\....IQ2?.].2..|
-000002e0  10 33 46 37 f0 b5 82 23  a5 91 1f 60 fb 21 2c 08  |.3F7...#...`.!,.|
-000002f0  c3 6e 17 72 0b 5d c9 7b  cc 77 97 6f 20 d9 a6 fa  |.n.r.].{.w.o ...|
-00000300  cc 4a bb c6 3b 0e b1 66  ae 57 f5 1b 16 46 36 b7  |.J..;..f.W...F6.|
-00000310  a5 94 ae 17 03 03 00 99  d7 86 a0 5f c0 d2 33 3e  |..........._..3>|
-00000320  ce ce ea db cb a1 a5 11  b7 cc a1 48 b6 86 f5 11  |...........H....|
-00000330  d6 32 8c f9 e8 bb e3 3e  ea 6f 1a df 64 cd c8 7d  |.2.....>.o..d..}|
-00000340  e9 cb e4 19 fe cd 75 74  03 4a fe 91 1d 87 28 65  |......ut.J....(e|
-00000350  25 79 3a 19 13 ba 67 16  aa 7e 8e c0 e6 53 4f bb  |%y:...g..~...SO.|
-00000360  98 ed cc 59 db 5e 73 23  d4 a9 a7 2a 6d 01 73 4a  |...Y.^s#...*m.sJ|
-00000370  e6 65 2e c0 34 49 c1 d8  70 2e 70 1b 10 97 74 23  |.e..4I..p.p...t#|
-00000380  fe 6b 5d cd fa 71 c8 43  c3 5b 42 5c 7b e0 9e 3f  |.k]..q.C.[B\{..?|
-00000390  a8 3d a9 d1 97 17 87 80  af 7c 5d 8b 70 ba 87 06  |.=.......|].p...|
-000003a0  67 dd 29 df f3 ca 9a f4  c8 93 e8 f8 ac c0 df 8e  |g.).............|
-000003b0  c5 17 03 03 00 45 40 a4  26 66 29 18 b8 d6 a7 87  |.....E@.&f).....|
-000003c0  91 5f 6d 79 13 f8 7a 47  cf ac 93 7c 11 cb 4a b2  |._my..zG...|..J.|
-000003d0  24 a6 40 fb d4 ed 71 ec  19 53 ba ae e0 bb e6 cf  |$.@...q..S......|
-000003e0  d6 8a a6 3c 6a 4e a3 6f  6c d7 2d e1 8a a4 6c da  |...<jN.ol.-...l.|
-000003f0  a1 ab fd c0 de 59 e9 18  fc 47 f2 17 03 03 00 a3  |.....Y...G......|
-00000400  5b 85 84 a4 0d ff be 3e  ea 00 71 3d ea be c7 e2  |[......>..q=....|
-00000410  dc 2f 4a 62 c2 9f e2 e5  16 51 ff 35 a7 70 df 12  |./Jb.....Q.5.p..|
-00000420  23 d6 f7 6c 96 91 7f 0f  6d d4 45 5f c6 8c c5 93  |#..l....m.E_....|
-00000430  b1 b7 46 ef f0 f4 a3 68  35 ff 09 38 8d 6d c6 84  |..F....h5..8.m..|
-00000440  d3 1c 4d 48 4e fc 4a c0  46 06 b1 a5 1c 74 a0 44  |..MHN.J.F....t.D|
-00000450  69 68 20 33 df 70 60 69  57 c7 85 bd 3e ed 55 d0  |ih 3.p`iW...>.U.|
-00000460  56 84 8f 19 03 5a 54 9a  d5 3e 5d 37 98 40 4c f0  |V....ZT..>]7.@L.|
-00000470  5e f1 26 e5 97 01 fc 0f  2a 09 e9 7a 51 69 c0 8e  |^.&.....*..zQi..|
-00000480  d4 25 80 f4 ca 91 f3 a7  5c 0c 96 ba ec a8 b5 ee  |.%......\.......|
-00000490  ab ec 05 cb 99 30 78 48  1b 78 bf 3d b9 f4 e8 33  |.....0xH.x.=...3|
-000004a0  4d 45 d1                                          |ME.|
+00000080  03 03 00 01 01 17 03 03  00 17 0f 50 a8 53 56 c5  |...........P.SV.|
+00000090  ea 1c d6 72 c2 7b 55 c5  13 6d 4f a8 69 8b 48 bf  |...r.{U..mO.i.H.|
+000000a0  a8 17 03 03 02 6d 95 5e  15 34 7f b4 ec 49 0e da  |.....m.^.4...I..|
+000000b0  b5 90 4d 1d cc f1 96 6f  7f ed d6 d6 58 9a 76 4e  |..M....o....X.vN|
+000000c0  51 41 d5 93 d2 a3 1b b6  c8 55 78 1e 58 09 57 0e  |QA.......Ux.X.W.|
+000000d0  55 47 c7 6b 6a d2 bb 5a  67 19 90 32 d3 63 c6 e8  |UG.kj..Zg..2.c..|
+000000e0  32 51 10 f0 32 05 82 7f  7e a3 0d f9 d1 d3 30 8d  |2Q..2...~.....0.|
+000000f0  0c f6 9a 82 19 fe 3d b9  38 4c 70 e9 26 e9 f8 e3  |......=.8Lp.&...|
+00000100  d8 5f 95 5e 2f d4 f9 85  94 c8 34 0e 02 9e 45 ec  |._.^/.....4...E.|
+00000110  8f 16 f8 e2 91 e5 00 0b  04 13 4c da 3f bf 44 cf  |..........L.?.D.|
+00000120  41 45 d0 da ae fb 26 b7  15 aa e9 f6 dd cd da 0e  |AE....&.........|
+00000130  14 2b b5 48 55 00 b1 a5  20 30 aa 2d 07 af 49 c0  |.+.HU... 0.-..I.|
+00000140  86 e6 41 b6 93 72 4b 76  27 1d 3d 92 ab b5 b3 e5  |..A..rKv'.=.....|
+00000150  02 2c e0 05 1a d4 c1 b4  95 56 0c 9c 0c e7 dd 70  |.,.......V.....p|
+00000160  9a 94 c0 e3 58 07 96 37  dc 47 c0 a9 b3 fb 00 be  |....X..7.G......|
+00000170  55 97 94 12 58 ad 1d b7  1c 20 57 11 02 ab d9 6c  |U...X.... W....l|
+00000180  37 c7 9d d0 65 f5 e4 58  85 8d 6f ee a6 e6 c5 24  |7...e..X..o....$|
+00000190  22 1b 42 59 e0 84 0a db  66 6a b5 8b f9 29 67 85  |".BY....fj...)g.|
+000001a0  31 cd 3d bb db 56 bb 34  96 9a 2e 49 ce f0 3d 8d  |1.=..V.4...I..=.|
+000001b0  ad 16 7f 88 f3 6f f5 e7  28 73 8e dc d9 b0 e9 55  |.....o..(s.....U|
+000001c0  7a 96 fa 60 aa 67 69 20  ea f8 23 a0 3d dd 26 7c  |z..`.gi ..#.=.&||
+000001d0  ca 83 a7 7a d1 c9 bb 72  bc 50 cd 5a 77 57 a9 f7  |...z...r.P.ZwW..|
+000001e0  f5 02 b8 ed 97 5a e9 53  d0 4f 42 9a fe a6 c5 61  |.....Z.S.OB....a|
+000001f0  49 4f 93 19 a0 fd d3 63  7e d1 6f 4b 52 9d b5 78  |IO.....c~.oKR..x|
+00000200  9d 12 e9 3f d8 0d b4 fc  67 c7 be b7 c1 3f dc 9e  |...?....g....?..|
+00000210  c4 12 b3 a3 15 9e f0 83  e4 19 d6 b5 1d c1 f7 86  |................|
+00000220  12 0d c1 7d 4d 83 7e 86  a2 0a a9 21 5a 9f 05 f5  |...}M.~....!Z...|
+00000230  a9 9e 8d 1e 55 17 38 9c  3c 88 09 30 60 d6 39 ba  |....U.8.<..0`.9.|
+00000240  4d d3 f1 a5 fa a6 0a f3  65 0d da 94 a0 42 10 f2  |M.......e....B..|
+00000250  0c 1b 3e e8 eb ea 64 6e  f2 51 f1 bc 2b b3 36 a0  |..>...dn.Q..+.6.|
+00000260  29 e8 9f e1 62 72 0e 93  33 3b 34 d1 f8 b2 8f 72  |)...br..3;4....r|
+00000270  80 9c 67 e9 39 98 91 90  23 70 57 4d 22 36 d3 b0  |..g.9...#pWM"6..|
+00000280  82 ed 06 62 1c 8f 83 1d  89 20 79 0a b2 c3 84 38  |...b..... y....8|
+00000290  35 bb f9 5f f9 4d 2e a7  91 52 58 f5 bd 28 80 5a  |5.._.M...RX..(.Z|
+000002a0  59 23 33 b4 00 eb f2 fc  b8 d6 54 dd 2c c8 13 84  |Y#3.......T.,...|
+000002b0  30 4f e1 50 f7 ed 0c f4  7a 33 89 9f fc a1 a4 74  |0O.P....z3.....t|
+000002c0  f0 a8 b8 76 b2 82 e0 a4  eb f0 c2 01 07 aa 00 b6  |...v............|
+000002d0  c0 f4 a7 b4 59 81 35 fa  8e 9a 98 e1 3d 21 9d 56  |....Y.5.....=!.V|
+000002e0  9c 1c d1 3a bc 6e 06 ba  83 d8 f1 06 c5 0f 33 9d  |...:.n........3.|
+000002f0  ad e0 42 0f dd 8a 0a 84  ba 8a 22 26 f9 4f 60 2d  |..B......."&.O`-|
+00000300  15 1c 98 9e d4 76 56 5e  de 67 f3 d7 43 5c a8 d4  |.....vV^.g..C\..|
+00000310  78 b7 fa 17 03 03 00 99  90 86 ce 5d 5e cb e4 67  |x..........]^..g|
+00000320  b3 a8 b8 9a 1c 67 dd c6  0f 09 92 8b f4 4f df c5  |.....g.......O..|
+00000330  6f 93 6f 68 28 96 37 d3  9c 2a d1 e6 78 b5 34 b7  |o.oh(.7..*..x.4.|
+00000340  9b 21 35 49 ba 48 9d 3b  30 4a 73 e3 1d a5 d4 42  |.!5I.H.;0Js....B|
+00000350  a5 21 7c b7 e7 57 af a6  20 d4 18 f6 d6 9e 9e d8  |.!|..W.. .......|
+00000360  9d 05 96 67 73 2a 43 48  84 c0 83 5c 55 61 2b 4c  |...gs*CH...\Ua+L|
+00000370  85 6a ac 01 75 63 65 05  81 b3 8c 21 3d 24 ee 29  |.j..uce....!=$.)|
+00000380  65 46 37 8a 9c b1 1a 7e  ed d6 48 68 28 9c a8 88  |eF7....~..Hh(...|
+00000390  26 ce f8 af 1f f8 a6 9a  c5 2a 8a 26 63 67 7b 96  |&........*.&cg{.|
+000003a0  4e c4 b4 3d c0 81 80 fc  51 a4 ef 17 8e 43 07 77  |N..=....Q....C.w|
+000003b0  b6 17 03 03 00 45 83 ee  5d f7 13 ea 4a 98 8a bf  |.....E..]...J...|
+000003c0  92 15 ca 5c 9c e1 55 85  d6 4e c9 34 ef 17 4b 4f  |...\..U..N.4..KO|
+000003d0  4e fa ec 58 12 b1 2f 66  67 44 08 3d 77 8c 64 7b  |N..X../fgD.=w.d{|
+000003e0  30 bf 38 08 5e ac 28 9f  c3 a5 68 04 74 de 5e a3  |0.8.^.(...h.t.^.|
+000003f0  8b c4 8c 33 45 56 0a a1  84 cb 5e 17 03 03 00 93  |...3EV....^.....|
+00000400  c1 f1 58 63 c1 10 ba de  f5 17 95 fa fb 7a 36 9a  |..Xc.........z6.|
+00000410  fc 5e 04 08 a0 75 22 02  aa c0 e2 26 3c b2 42 b1  |.^...u"....&<.B.|
+00000420  28 6d 57 fc 5b b4 73 3c  cc 94 3c 75 a3 10 fc 2d  |(mW.[.s<..<u...-|
+00000430  e8 64 a1 cb 74 b8 2a c7  ef 5b 1f 3f 39 51 d5 10  |.d..t.*..[.?9Q..|
+00000440  3e f8 e4 38 da 16 97 2f  72 7b 8f 3f c2 06 8f df  |>..8.../r{.?....|
+00000450  14 29 e4 4d 11 4b 78 9f  00 fe cc c5 b0 5f 5a 9d  |.).M.Kx......_Z.|
+00000460  dd 1d dc 6f ab 7a 4f b5  ab 93 3a 6e 62 0e 67 84  |...o.zO...:nb.g.|
+00000470  3a f8 5f 7f 7b 2b 33 ad  6e 67 bf e9 2b 49 ed a0  |:._.{+3.ng..+I..|
+00000480  1a d3 d6 45 0b 05 fd 78  bc e2 00 b4 f5 d5 df 7f  |...E...x........|
+00000490  86 9d 25                                          |..%|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 45 54 0e c1 aa 95  |..........ET....|
-00000010  fd c5 d2 8b a0 ae 40 a1  9a b8 87 39 17 53 f7 10  |......@....9.S..|
-00000020  62 6f 55 18 42 cf 75 cb  05 de 32 28 c4 a0 f1 17  |boU.B.u...2(....|
-00000030  f1 55 ae 2c 97 9e dd d2  d0 a7 6b c6 51 51 c6 0c  |.U.,......k.QQ..|
-00000040  81 3f 04 db 94 e6 68 f0  a1 80 10 39 06 99 25 e2  |.?....h....9..%.|
+00000000  14 03 03 00 01 01 17 03  03 00 45 b3 73 83 75 b0  |..........E.s.u.|
+00000010  95 36 0a 26 c5 06 0c 61  04 89 72 9d 04 f8 3d 87  |.6.&...a..r...=.|
+00000020  70 be 43 98 9c fe 20 f4  4c bd fe 93 81 79 85 27  |p.C... .L....y.'|
+00000030  56 7d 73 84 6c 96 c0 8b  bf 97 67 ff 76 05 9e eb  |V}s.l.....g.v...|
+00000040  e5 7a 76 cd 12 b4 49 02  7e f6 87 87 d0 37 7f 30  |.zv...I.~....7.0|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e e4 4f d5  b0 e7 a0 e2 13 69 75 7c  |......O......iu||
-00000010  b1 84 93 be 99 ea 27 20  dd 08 89 6c e2 5a c6 bc  |......' ...l.Z..|
-00000020  b8 41 3d 17 03 03 00 13  cf 64 ad ad d9 84 87 36  |.A=......d.....6|
-00000030  b9 ea b8 76 97 93 c1 03  44 c5 de                 |...v....D..|
+00000000  17 03 03 00 1e 62 6b 04  56 bc 90 bf 8e ce d1 8a  |.....bk.V.......|
+00000010  78 29 fc c2 b2 73 ea 2a  2e f7 1a c9 8c 1d 5f 44  |x)...s.*......_D|
+00000020  5d 7a b4 17 03 03 00 13  a9 57 17 0c 1a c5 80 3d  |]z.......W.....=|
+00000030  ed 81 0c 12 1e a1 f5 06  ce 7b 27                 |.........{'|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ALPN b/src/crypto/tls/testdata/Server-TLSv13-ALPN
index df8dd4508a..9a4c125503 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ALPN
+++ b/src/crypto/tls/testdata/Server-TLSv13-ALPN
@@ -1,9 +1,9 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 e2 01 00 00  de 03 03 8e d2 a1 8f ea  |................|
-00000010  e3 7d 5f 7c 70 74 c3 7e  5f 06 bb 21 35 28 38 7a  |.}_|pt.~_..!5(8z|
-00000020  7f 00 11 86 6e ac 19 38  7f d4 88 20 33 3a b2 14  |....n..8... 3:..|
-00000030  c2 4e 6a 39 71 24 81 21  27 21 2d b7 3d bc 5e 97  |.Nj9q$.!'!-.=.^.|
-00000040  f8 ed 55 83 be 9a d3 27  b5 e0 0e bd 00 04 13 03  |..U....'........|
+00000000  16 03 01 00 e2 01 00 00  de 03 03 bb a9 c3 a8 a5  |................|
+00000010  1b 31 e3 bd f6 de a4 3b  0e b7 20 60 7c 36 19 fa  |.1.....;.. `|6..|
+00000020  ee 91 44 fa 11 e0 d1 4f  cf 4c 02 20 bc 07 bf 23  |..D....O.L. ...#|
+00000030  8b 01 3b ae 06 98 07 a4  96 3b bc aa d1 71 0c dd  |..;......;...q..|
+00000040  b1 02 54 8b 15 b7 f0 d4  23 74 ed bb 00 04 13 03  |..T.....#t......|
 00000050  00 ff 01 00 00 91 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 10 00 10 00 0e  06 70 72 6f 74 6f 32 06  |.........proto2.|
@@ -11,90 +11,89 @@
 00000090  00 1e 00 1c 04 03 05 03  06 03 08 07 08 08 08 09  |................|
 000000a0  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
 000000b0  00 2b 00 03 02 03 04 00  2d 00 02 01 01 00 33 00  |.+......-.....3.|
-000000c0  26 00 24 00 1d 00 20 89  4d b8 22 62 39 22 e6 5a  |&.$... .M."b9".Z|
-000000d0  b1 86 ea c9 d9 d1 77 c9  12 c3 62 e1 8e 17 cb ab  |......w...b.....|
-000000e0  91 83 d8 af 9b be 0a                              |.......|
+000000c0  26 00 24 00 1d 00 20 37  01 55 d8 5a 52 5c 9a 63  |&.$... 7.U.ZR\.c|
+000000d0  83 7e 66 f8 76 8c 89 e1  8b 12 0c 0c eb 10 cd d6  |.~f.v...........|
+000000e0  f4 ac 45 74 5f 10 00                              |..Et_..|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 33 3a b2 14  |........... 3:..|
-00000030  c2 4e 6a 39 71 24 81 21  27 21 2d b7 3d bc 5e 97  |.Nj9q$.!'!-.=.^.|
-00000040  f8 ed 55 83 be 9a d3 27  b5 e0 0e bd 13 03 00 00  |..U....'........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 bc 07 bf 23  |........... ...#|
+00000030  8b 01 3b ae 06 98 07 a4  96 3b bc aa d1 71 0c dd  |..;......;...q..|
+00000040  b1 02 54 8b 15 b7 f0 d4  23 74 ed bb 13 03 00 00  |..T.....#t......|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 24 60 9e a3 43 47 75  |.........$`..CGu|
-00000090  d2 38 11 fd 9d da a5 f6  65 de 3c 2a 3d a9 46 7e  |.8......e.<*=.F~|
-000000a0  50 c8 52 a1 7d e6 95 a7  4b 48 b7 35 e7 a7 17 03  |P.R.}...KH.5....|
-000000b0  03 02 6d b8 30 43 88 03  d4 6c cf c6 45 80 b2 6c  |..m.0C...l..E..l|
-000000c0  52 d7 1e 08 de 0b 6e 7a  27 c8 2c 59 d4 03 41 24  |R.....nz'.,Y..A$|
-000000d0  e3 4a e1 d3 85 68 de 23  f6 c4 3a bb 45 ae b1 ac  |.J...h.#..:.E...|
-000000e0  8b b3 22 7d e7 a6 7c e3  07 68 b1 9c 97 6a d3 e4  |.."}..|..h...j..|
-000000f0  5d 0a 73 a3 16 ad e4 7f  b9 d7 0a b7 7c 48 bb f2  |].s.........|H..|
-00000100  ed 49 61 f7 cb 5e ea d2  d9 a3 73 ea a7 4f a3 10  |.Ia..^....s..O..|
-00000110  f7 3e 8f ce b9 56 a0 88  54 52 59 1f f3 55 2b 15  |.>...V..TRY..U+.|
-00000120  df fd fa 85 9e 20 ff 72  f3 26 6a 2c 1f 11 a8 3d  |..... .r.&j,...=|
-00000130  8e 66 75 aa 90 fc 9f 9f  a7 67 8f ac 98 54 19 04  |.fu......g...T..|
-00000140  c9 1f 48 f7 ed 8f 13 0a  f9 6c 9b f8 e9 0a c5 a9  |..H......l......|
-00000150  f2 ef 5b 65 a1 ad 40 e4  e7 ff c1 ff e9 d6 ab 5c  |..[e..@........\|
-00000160  f8 f1 7b 4d 39 33 1d 68  d3 38 20 10 c4 3b 7a 9f  |..{M93.h.8 ..;z.|
-00000170  fe 55 1d 83 5c 8f 67 d0  bb 5f 32 80 b2 91 38 0a  |.U..\.g.._2...8.|
-00000180  71 bb b4 3a 10 1c 98 f9  d4 19 7c 7d d5 f7 4b 0a  |q..:......|}..K.|
-00000190  02 2f bd 0b f9 ff 28 b2  2d ba dd 7f 0d 51 a2 4c  |./....(.-....Q.L|
-000001a0  51 92 1e e9 47 51 ae 1a  d0 66 9c ef 0a 02 dc 69  |Q...GQ...f.....i|
-000001b0  95 79 2b b0 8f 7b a2 3d  57 cf 5c 7e b4 0a 91 34  |.y+..{.=W.\~...4|
-000001c0  e6 d0 0d 93 1b 6c 61 9e  58 12 47 5f 3a ec 67 19  |.....la.X.G_:.g.|
-000001d0  d8 fb 44 43 4d cd 4e ad  1d bc f2 05 66 42 3f 3f  |..DCM.N.....fB??|
-000001e0  85 5d 93 56 8e ca 62 47  38 ee d2 0e 81 8b 71 7d  |.].V..bG8.....q}|
-000001f0  d8 cf 6e 4b 61 80 fe 28  34 f4 f1 58 06 36 2a 40  |..nKa..(4..X.6*@|
-00000200  93 98 3d d0 9c 69 6f 6a  3a 40 b9 8c 2e 71 5d 52  |..=..ioj:@...q]R|
-00000210  66 5d 55 45 e7 38 b7 ce  74 c2 1c ae 2e 4a 03 86  |f]UE.8..t....J..|
-00000220  d4 15 c3 40 d9 58 b7 ba  ed 84 fd 20 35 a4 1c c6  |...@.X..... 5...|
-00000230  8a 50 7a 0c 87 53 d7 2d  4b 5b 7d 23 79 8f 66 f8  |.Pz..S.-K[}#y.f.|
-00000240  72 05 72 7b 7d 7a 64 97  8d da c9 dd 23 6a 44 b6  |r.r{}zd.....#jD.|
-00000250  e1 99 e4 45 76 a5 53 d8  1b 54 a0 b9 9e ec 0e d3  |...Ev.S..T......|
-00000260  91 1b 5e c0 a7 c8 3a 34  22 f9 58 7d da 2b f4 fd  |..^...:4".X}.+..|
-00000270  2b 9a 9e 26 20 6f d3 9d  e9 48 a1 62 70 fe 06 04  |+..& o...H.bp...|
-00000280  c2 63 f7 c4 a2 b9 74 28  a8 b3 f9 f0 a1 2a 46 0c  |.c....t(.....*F.|
-00000290  f5 6b cc 7e b4 c0 47 eb  00 96 6a 3d 32 58 e0 0a  |.k.~..G...j=2X..|
-000002a0  59 01 3c 42 45 a7 76 6d  78 05 1f 2c db a4 08 5b  |Y.<BE.vmx..,...[|
-000002b0  e8 8e b1 10 cb a9 d9 e5  c3 a4 5a f7 63 30 c7 ac  |..........Z.c0..|
-000002c0  8d 62 14 9d 30 ee 9f 9f  1b c4 ca 7f e8 d4 64 2a  |.b..0.........d*|
-000002d0  46 0d 43 e1 bd 4e ed 83  f1 6b 33 78 ed 8e 98 58  |F.C..N...k3x...X|
-000002e0  13 c5 7a 8a b3 20 c4 db  17 1a 83 7d 04 ec ae 02  |..z.. .....}....|
-000002f0  cd ef 9b 27 5a f0 94 0d  71 24 bf 6f 31 c4 05 a3  |...'Z...q$.o1...|
-00000300  ca b5 bf 5d cb 23 e7 76  75 b0 2e 8b d7 65 60 12  |...].#.vu....e`.|
-00000310  97 8b 02 6c 4a ba 44 2d  a3 e8 47 ff 0e cd 7e a1  |...lJ.D-..G...~.|
-00000320  17 03 03 00 99 a9 d7 60  8b 76 f6 fa 62 91 32 fe  |.......`.v..b.2.|
-00000330  70 3f a1 87 36 b3 d0 01  22 61 76 4f 62 52 26 08  |p?..6..."avObR&.|
-00000340  06 db 41 b9 f6 57 ed 7f  7d 69 5b 19 37 f1 8c 99  |..A..W..}i[.7...|
-00000350  c1 8f d8 45 ab 6f 30 5f  11 34 12 9e 18 7a e9 8d  |...E.o0_.4...z..|
-00000360  33 23 c1 61 19 f7 3b 90  60 04 86 53 7d a0 be e9  |3#.a..;.`..S}...|
-00000370  c8 48 19 ef 99 16 54 e1  82 7f e9 7c b4 50 bd d0  |.H....T....|.P..|
-00000380  75 31 69 77 f5 d5 64 41  82 21 5c aa a9 a6 b2 cf  |u1iw..dA.!\.....|
-00000390  d6 73 d3 79 3f b5 ba cb  d4 4a 70 ae b8 9a d8 0f  |.s.y?....Jp.....|
-000003a0  24 47 3a 30 31 6e 4c 79  a4 28 63 6e 2b 90 1c 6d  |$G:01nLy.(cn+..m|
-000003b0  00 6e e3 90 60 fb d2 96  66 f9 a2 c0 af c9 17 03  |.n..`...f.......|
-000003c0  03 00 35 f6 41 b8 95 b6  98 56 4b 39 4f 42 8a 88  |..5.A....VK9OB..|
-000003d0  35 f1 15 7f 7a e0 0e 04  a8 6f 02 f0 64 e8 83 f2  |5...z....o..d...|
-000003e0  2f 03 2e 1f 24 0f 7a 4e  36 2d f7 54 9e ad 22 15  |/...$.zN6-.T..".|
-000003f0  f5 57 8f 19 f0 f0 46 11  17 03 03 00 93 26 4a 78  |.W....F......&Jx|
-00000400  60 d7 d6 5c 18 17 12 f5  a7 c5 42 de 63 6a cb 10  |`..\......B.cj..|
-00000410  c3 a1 66 57 85 0e 78 50  99 77 aa 5e 8f fb 0d 59  |..fW..xP.w.^...Y|
-00000420  f0 09 b1 b1 10 be a5 64  e1 85 48 79 8d b6 07 52  |.......d..Hy...R|
-00000430  05 bb aa 0d 46 42 dd 1d  1b 2e a7 cb 28 cd 97 24  |....FB......(..$|
-00000440  8e d4 7a 2d 1c 4a 25 12  eb 25 0b 14 40 94 0e 5d  |..z-.J%..%..@..]|
-00000450  d0 04 9c 87 88 44 d5 70  c6 3d 0b 3f 10 19 cc 18  |.....D.p.=.?....|
-00000460  c5 89 b8 c3 5d 5f 3e 96  cc 9b 63 e9 f3 b1 66 2f  |....]_>...c...f/|
-00000470  24 2a 06 1b f3 91 a7 7c  dd d9 b5 1f b3 9e 7f ce  |$*.....|........|
-00000480  db 96 cd 2e 36 69 f0 94  0c 5f e8 0b 15 6a 38 40  |....6i..._...j8@|
+00000080  03 03 00 01 01 17 03 03  00 24 71 b0 7e 2a f8 25  |.........$q.~*.%|
+00000090  f0 3e 80 b6 7d 0c de 6a  81 41 f5 f1 04 73 cc f1  |.>..}..j.A...s..|
+000000a0  76 9a b5 80 da b6 f3 10  70 bd 8e ec 45 5d 17 03  |v.......p...E]..|
+000000b0  03 02 6d e6 db ce 88 22  69 78 86 38 36 c4 64 60  |..m...."ix.86.d`|
+000000c0  65 fd fe 86 5e 4e 15 84  d4 aa 69 d4 64 ae be 47  |e...^N....i.d..G|
+000000d0  4e e4 eb 63 cf 5e 47 c8  0b 1a 15 cc 7a cf 03 d9  |N..c.^G.....z...|
+000000e0  93 58 63 6e 3c b9 d1 7c  0a cd c1 45 c3 7c c5 50  |.Xcn<..|...E.|.P|
+000000f0  f0 31 17 7f d0 47 34 25  58 f1 39 83 8b d1 a0 7c  |.1...G4%X.9....||
+00000100  8a 1b 10 12 b7 3d 7b a0  57 de 5b f8 af 88 16 84  |.....={.W.[.....|
+00000110  74 00 10 9b b1 a3 64 94  21 3e 6a 30 e0 9d a5 ee  |t.....d.!>j0....|
+00000120  8b 1c 05 3e 4e f9 fe 34  e2 f0 38 c3 3e a5 27 32  |...>N..4..8.>.'2|
+00000130  14 a2 d6 98 e9 42 1f 40  84 de 67 3a b9 55 87 d1  |.....B.@..g:.U..|
+00000140  e8 f0 1c 07 01 ea 99 b8  fb 42 b6 cb 66 2c b6 6a  |.........B..f,.j|
+00000150  72 d1 43 f2 7b df 08 06  75 fc af 0c be 52 44 eb  |r.C.{...u....RD.|
+00000160  a7 06 7a 90 56 0d 4a f9  75 59 9f 86 c8 d2 52 98  |..z.V.J.uY....R.|
+00000170  72 17 4e 42 d8 dc c8 23  bc 65 e4 10 bf d0 44 9e  |r.NB...#.e....D.|
+00000180  30 e1 be 23 e7 7c 7f 07  fa c8 15 95 83 c6 00 ce  |0..#.|..........|
+00000190  cf 7b ad d6 bb b3 38 75  42 42 63 b0 c0 2c 04 a1  |.{....8uBBc..,..|
+000001a0  05 db ca 84 cf e5 71 62  0a 7e 8c d0 2b 56 7a 58  |......qb.~..+VzX|
+000001b0  51 b5 00 19 63 37 8d a4  db 77 b0 97 e7 e9 3e a7  |Q...c7...w....>.|
+000001c0  0f 50 09 5c 21 d4 12 29  09 f2 f8 8b 30 da 64 c5  |.P.\!..)....0.d.|
+000001d0  a2 ec 79 45 97 7a c8 2e  56 7a fc 90 6d 06 3d fb  |..yE.z..Vz..m.=.|
+000001e0  62 87 69 a0 01 6c a2 77  94 c4 b8 c1 7a 22 4f 14  |b.i..l.w....z"O.|
+000001f0  d8 0b b7 e0 93 ae e8 d5  2c b0 f7 23 ab 91 5a d7  |........,..#..Z.|
+00000200  21 42 6b cb 33 8e 35 09  39 19 4f 7f 48 44 2d 07  |!Bk.3.5.9.O.HD-.|
+00000210  e6 33 74 45 cc 29 dc 21  da 8d 3b c3 08 4c c2 a2  |.3tE.).!..;..L..|
+00000220  dd 85 59 d1 f6 34 9a d0  f3 d0 1e 00 9e 87 6f 3d  |..Y..4........o=|
+00000230  34 0c 54 0c fe 55 7d 72  ac 43 12 a4 3e 5e 35 db  |4.T..U}r.C..>^5.|
+00000240  4b 1b 4e b0 8a 30 43 8e  84 06 fe ef 87 dd fa 83  |K.N..0C.........|
+00000250  0c 44 15 da 21 30 2c 1d  24 e0 25 74 ee fd 4a 03  |.D..!0,.$.%t..J.|
+00000260  df 8b 38 5e 57 4a 12 83  f8 cc d1 94 59 72 49 44  |..8^WJ......YrID|
+00000270  94 27 77 b2 26 d1 7a 3a  74 93 d8 a9 df d2 ad 23  |.'w.&.z:t......#|
+00000280  08 8c 1d 51 6f a5 15 fd  c9 53 ad 6c d7 e4 53 45  |...Qo....S.l..SE|
+00000290  f5 d1 5a 4d e0 e1 14 ac  f4 60 45 39 08 d9 89 4c  |..ZM.....`E9...L|
+000002a0  6f fc 08 b8 ad 63 00 0d  f8 25 67 00 ae 4d 06 04  |o....c...%g..M..|
+000002b0  63 80 f3 44 eb d8 b9 5d  30 3a 98 cd a3 b1 62 57  |c..D...]0:....bW|
+000002c0  71 ea 4c f9 b7 39 0c 4f  9f 42 fc 28 31 a4 6a e3  |q.L..9.O.B.(1.j.|
+000002d0  8e e8 86 32 fb b5 cc 0d  11 63 25 3c 64 6f 5e 3f  |...2.....c%<do^?|
+000002e0  fc db 98 1d 8a 98 c6 0b  f9 f4 97 30 07 2b e1 e1  |...........0.+..|
+000002f0  8c 59 56 d8 e6 2a 06 9b  85 f8 c0 ca 44 5b 14 af  |.YV..*......D[..|
+00000300  0f 40 72 0e 32 c1 da 66  7c b8 03 dc 7e d6 0c c7  |.@r.2..f|...~...|
+00000310  cb 63 dc 8b 14 dc 50 eb  22 b3 67 bf 81 e0 9b d3  |.c....P.".g.....|
+00000320  17 03 03 00 99 03 52 77  93 1b e0 a5 b9 15 6d d8  |......Rw......m.|
+00000330  18 6b 9f 49 0a 05 1d f2  24 26 f8 68 e6 a6 38 79  |.k.I....$&.h..8y|
+00000340  5b a0 89 66 87 b3 b4 60  35 81 28 0e 56 4a 30 80  |[..f...`5.(.VJ0.|
+00000350  70 c6 41 52 98 73 77 e4  17 d6 e3 d5 4f 71 30 af  |p.AR.sw.....Oq0.|
+00000360  d3 c0 8f 17 44 42 97 bb  e2 c8 4d cf 6b 6e e5 f1  |....DB....M.kn..|
+00000370  20 2d 9c ea d4 9e f4 29  cd 9a 60 cf b9 c3 af 83  | -.....)..`.....|
+00000380  fa 76 49 e7 e2 3d de 63  7c d1 7d c2 2b c0 f3 ee  |.vI..=.c|.}.+...|
+00000390  1a 69 55 1e 5d 20 52 41  a1 97 6d c8 e3 84 33 14  |.iU.] RA..m...3.|
+000003a0  88 5b 34 c3 52 58 6f ea  59 05 c8 da 25 4c ee 21  |.[4.RXo.Y...%L.!|
+000003b0  19 aa 95 34 9f 4a b8 ac  9a 51 23 ea a5 c1 17 03  |...4.J...Q#.....|
+000003c0  03 00 35 8c 05 73 4b 83  21 3b e2 30 c1 25 e0 d1  |..5..sK.!;.0.%..|
+000003d0  17 66 68 eb dc d6 ee 35  13 98 cd 1b d5 c9 d7 76  |.fh....5.......v|
+000003e0  b8 df 2a 03 42 73 d9 80  a6 d7 fb 69 1d e1 38 31  |..*.Bs.....i..81|
+000003f0  81 b0 3a d0 8d 8d 54 d0  17 03 03 00 83 33 43 7a  |..:...T......3Cz|
+00000400  da d7 a8 06 83 0a 2f 5a  5f 6f f5 8c b3 af 8d db  |....../Z_o......|
+00000410  8a 28 5e f7 77 4a 3e f0  ba 2b 51 ee e5 18 96 dc  |.(^.wJ>..+Q.....|
+00000420  8e dd f0 4e 10 2d 84 1b  ea f2 33 2a 92 78 ea f9  |...N.-....3*.x..|
+00000430  33 7f 7c 0b fe 39 82 b3  6f 17 fb bb 89 48 a8 df  |3.|..9..o....H..|
+00000440  97 bd ae 53 83 5c 06 c2  25 df ea e5 4a b1 0a 96  |...S.\..%...J...|
+00000450  27 44 dc d9 35 ca b5 cd  bb f7 25 ab 39 3a bb 6b  |'D..5.....%.9:.k|
+00000460  f0 e8 3f 0a 76 00 70 3b  3b 7c 8b 7b 5c 64 d0 05  |..?.v.p;;|.{\d..|
+00000470  8e 2d 72 44 6a fb a6 94  f1 84 cb 92 09 36 3c b9  |.-rDj........6<.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 32 39 09 c6 64  |..........529..d|
-00000010  aa 86 b7 a7 37 6c fa ef  66 01 d4 de e6 35 8d 31  |....7l..f....5.1|
-00000020  68 71 f3 27 56 fd 7f 7b  cf c8 3c d1 44 ff e0 c7  |hq.'V..{..<.D...|
-00000030  78 b7 6c c8 ac 01 0e ee  e1 78 b9 dd 1a e1 a9 b6  |x.l......x......|
+00000000  14 03 03 00 01 01 17 03  03 00 35 4f c3 42 a6 ed  |..........5O.B..|
+00000010  a5 94 cc bf 21 cb b8 98  70 91 6c 17 e2 b6 24 8c  |....!...p.l...$.|
+00000020  2c ee 72 11 bf f2 a5 1d  15 ff 52 b0 fc ef cc 8c  |,.r.......R.....|
+00000030  a8 78 56 5b c6 99 65 4a  60 73 ee 67 6c d0 42 cb  |.xV[..eJ`s.gl.B.|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e da e7 79  04 f5 65 2e f6 c3 c3 b9  |.......y..e.....|
-00000010  34 37 14 8f c2 32 cb 81  58 bc cf d0 3b 08 f0 61  |47...2..X...;..a|
-00000020  b3 ae b4 17 03 03 00 13  e3 32 09 02 e0 29 5e 4a  |.........2...)^J|
-00000030  9b 36 a9 b0 65 e9 2c 1d  fb ad 50                 |.6..e.,...P|
+00000000  17 03 03 00 1e 13 95 21  0a 6a 43 fa 41 8b 03 84  |.......!.jC.A...|
+00000010  1c 6f b9 98 75 9a 56 da  10 d8 b5 83 d5 fa 3a 37  |.o..u.V.......:7|
+00000020  9e 16 f3 17 03 03 00 13  74 13 dc 93 05 bd e9 59  |........t......Y|
+00000030  59 58 ef 3d 7a 42 d5 ce  bf d8 70                 |YX.=zB....p|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ALPN-Fallback b/src/crypto/tls/testdata/Server-TLSv13-ALPN-Fallback
index 6203e6877c..b1f6700f05 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ALPN-Fallback
+++ b/src/crypto/tls/testdata/Server-TLSv13-ALPN-Fallback
@@ -1,9 +1,9 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 eb 01 00 00  e7 03 03 1c d3 8e 3b d9  |..............;.|
-00000010  fe 7d e7 f9 9f fa c6 51  c3 8c 1b dd dc 87 95 f4  |.}.....Q........|
-00000020  39 23 67 e4 d6 bd 94 93  fc 88 4e 20 c3 c0 e2 c1  |9#g.......N ....|
-00000030  3d 12 ec 4c 0a 3f 40 51  13 24 61 11 c0 5d 09 f9  |=..L.?@Q.$a..]..|
-00000040  08 d6 3e cd e7 b3 51 c3  06 8f b4 42 00 04 13 03  |..>...Q....B....|
+00000000  16 03 01 00 eb 01 00 00  e7 03 03 52 08 3d 66 50  |...........R.=fP|
+00000010  fa 43 da db 68 27 5c c5  1f 44 b7 87 b7 11 c9 08  |.C..h'\..D......|
+00000020  c0 50 dc 3c 91 98 2a c5  40 82 ce 20 d4 33 48 07  |.P.<..*.@.. .3H.|
+00000030  97 53 8d 92 22 f7 a6 b7  84 f2 7d 14 7b 1e ed 5a  |.S..".....}.{..Z|
+00000040  99 ef bd da 97 ea 22 f7  90 36 e9 52 00 04 13 03  |......"..6.R....|
 00000050  00 ff 01 00 00 9a 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 10 00 19 00 17  06 70 72 6f 74 6f 33 08  |.........proto3.|
@@ -12,89 +12,88 @@
 000000a0  03 06 03 08 07 08 08 08  09 08 0a 08 0b 08 04 08  |................|
 000000b0  05 08 06 04 01 05 01 06  01 00 2b 00 03 02 03 04  |..........+.....|
 000000c0  00 2d 00 02 01 01 00 33  00 26 00 24 00 1d 00 20  |.-.....3.&.$... |
-000000d0  f4 05 eb 4a 7a 73 20 18  74 aa 14 2a 0c 35 63 29  |...Jzs .t..*.5c)|
-000000e0  cb f2 ad d1 a2 3d bd 9d  02 b4 62 00 bc eb 10 58  |.....=....b....X|
+000000d0  71 f3 09 28 42 16 ab 8a  b3 05 71 74 de d7 cf f4  |q..(B.....qt....|
+000000e0  f1 c0 59 9e e3 cd 8b 5f  9c 31 04 fd 42 24 af 3f  |..Y...._.1..B$.?|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 c3 c0 e2 c1  |........... ....|
-00000030  3d 12 ec 4c 0a 3f 40 51  13 24 61 11 c0 5d 09 f9  |=..L.?@Q.$a..]..|
-00000040  08 d6 3e cd e7 b3 51 c3  06 8f b4 42 13 03 00 00  |..>...Q....B....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 d4 33 48 07  |........... .3H.|
+00000030  97 53 8d 92 22 f7 a6 b7  84 f2 7d 14 7b 1e ed 5a  |.S..".....}.{..Z|
+00000040  99 ef bd da 97 ea 22 f7  90 36 e9 52 13 03 00 00  |......"..6.R....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 fb 75 d8 5c 50 35  |...........u.\P5|
-00000090  55 82 ba 65 1e 63 73 b8  c1 e9 d7 f5 28 68 3c c1  |U..e.cs.....(h<.|
-000000a0  5d 17 03 03 02 6d 56 c9  a9 09 73 6a bc fd 1a 3c  |]....mV...sj...<|
-000000b0  6a f8 3e 32 99 83 e8 f6  01 9e 5e 30 e8 53 7f 72  |j.>2......^0.S.r|
-000000c0  fd 86 72 a8 9e 47 25 67  c1 f1 9a 03 c0 9d 6f 9d  |..r..G%g......o.|
-000000d0  bd ed 29 30 8f 3c 01 ce  49 bb 5f dd 58 9a ae 80  |..)0.<..I._.X...|
-000000e0  5c 2d 81 fc ea 7b 03 03  3d 5d bb 92 23 73 67 89  |\-...{..=]..#sg.|
-000000f0  2e f0 ec 08 20 8a 36 eb  43 a6 a1 68 d0 39 95 37  |.... .6.C..h.9.7|
-00000100  6b 15 a9 0e 46 20 92 51  9c 04 bf 3b 07 97 84 cb  |k...F .Q...;....|
-00000110  1f 30 38 37 2e ff e7 0f  f5 14 93 5a 84 f1 f7 10  |.087.......Z....|
-00000120  c2 a5 0d bb 97 96 ef 4a  e0 13 c0 63 72 2b 60 f3  |.......J...cr+`.|
-00000130  59 b5 57 aa 5f d1 da a9  0e dd 9c dd c2 cb 61 fe  |Y.W._.........a.|
-00000140  e2 69 8e db 5d 70 6c 3a  33 e0 9e db 9a 31 26 6a  |.i..]pl:3....1&j|
-00000150  2b 9e 19 8e bb 5d 06 48  ea c0 a1 c6 11 24 fb c4  |+....].H.....$..|
-00000160  ce ae 48 54 64 81 d1 84  38 a6 e0 7a 7b 74 2b bc  |..HTd...8..z{t+.|
-00000170  ce 07 8b b6 04 1f 5b 4c  36 29 68 0c 8c c7 32 15  |......[L6)h...2.|
-00000180  93 e0 10 52 c2 27 23 96  c5 0c 9c e9 e2 a9 08 7d  |...R.'#........}|
-00000190  25 68 65 f5 4e 44 eb a9  85 78 13 e1 0d 86 5e dc  |%he.ND...x....^.|
-000001a0  fd e5 c6 dd 65 46 8e 2f  32 82 83 0b dd 67 f8 42  |....eF./2....g.B|
-000001b0  65 87 3b 08 fe b1 f5 12  e9 74 21 04 12 6d 75 35  |e.;......t!..mu5|
-000001c0  b2 eb 93 95 72 10 fa 56  96 77 c3 0c 17 8c 9e f6  |....r..V.w......|
-000001d0  77 19 28 37 96 3e 73 98  f4 d2 91 4f 40 db 76 56  |w.(7.>s....O@.vV|
-000001e0  ce b5 a8 7a b8 86 d0 9a  ba b5 8b 40 c2 63 e1 cf  |...z.......@.c..|
-000001f0  49 29 2c 5d 1a 9b 8b 56  cb 93 ca 2c c0 d0 15 b7  |I),]...V...,....|
-00000200  8a f1 6a d5 0a a8 81 57  b1 6e 10 cd a5 ff b1 4d  |..j....W.n.....M|
-00000210  47 c6 9b 35 f1 5f 83 91  22 f6 88 68 65 b3 b9 c9  |G..5._.."..he...|
-00000220  02 dc 4b f7 13 39 06 e6  3a ec 94 ef 51 15 05 72  |..K..9..:...Q..r|
-00000230  1d f4 9d 3b da ca 8d 2c  64 be 9b 45 99 2c 63 cc  |...;...,d..E.,c.|
-00000240  22 b3 8b 93 ad f6 2c f0  d2 d9 11 3f 5b c0 40 fa  |".....,....?[.@.|
-00000250  90 6e a0 76 b2 43 b9 4c  72 c4 24 28 a2 bf 56 d6  |.n.v.C.Lr.$(..V.|
-00000260  d2 a7 2a d1 8c 5e 1d eb  f8 be d0 43 da 7a c7 88  |..*..^.....C.z..|
-00000270  61 67 a2 69 85 23 43 3e  d4 88 f2 33 c3 5b 38 0a  |ag.i.#C>...3.[8.|
-00000280  1e de 28 3b 3b 19 de 95  2f 84 c0 37 88 80 59 2f  |..(;;.../..7..Y/|
-00000290  a6 ee 93 1a 69 08 c3 df  7c cf da c3 9b 96 70 d9  |....i...|.....p.|
-000002a0  60 c5 e9 0f 42 f6 1a f2  58 5e f2 32 61 6a b2 a3  |`...B...X^.2aj..|
-000002b0  1f 97 fa 08 6c 3f 4b 83  1f 04 66 80 8a 26 3a 7f  |....l?K...f..&:.|
-000002c0  24 30 ec 10 ae 7d 19 ff  39 91 ca 97 4e ed 0a d7  |$0...}..9...N...|
-000002d0  64 3b 6b 50 29 33 0d b2  10 bc 83 63 3c fb 9a 82  |d;kP)3.....c<...|
-000002e0  3b 7f bc 04 40 f1 33 64  4a 80 cd 01 f9 f4 c6 89  |;...@.3dJ.......|
-000002f0  65 27 25 f9 cf 4f 7e c8  6e d9 0e ec 47 4a 51 29  |e'%..O~.n...GJQ)|
-00000300  2f be 34 50 bd 9b d2 d8  b7 ea bb 0b a1 e0 20 1b  |/.4P.......... .|
-00000310  02 9c f2 17 03 03 00 99  61 dc 0b 3a 30 de 39 f6  |........a..:0.9.|
-00000320  f3 db f8 6c 3b fa 4e 1e  7e 62 a5 ae 73 ba e1 41  |...l;.N.~b..s..A|
-00000330  58 77 2a c1 7a 0c 50 bb  0c 57 b4 c4 25 bf 2f 9f  |Xw*.z.P..W..%./.|
-00000340  38 91 e2 65 22 9d ca ac  18 58 7e 81 2d fd 74 24  |8..e"....X~.-.t$|
-00000350  28 69 76 11 df 9d 23 b8  be ae 8b e0 93 8e 5d df  |(iv...#.......].|
-00000360  0a 64 d0 b7 02 68 aa 86  01 0d 55 11 3b 76 70 c6  |.d...h....U.;vp.|
-00000370  83 0c 5e 0a e3 37 a5 8b  ad 25 50 b9 e8 5c 6b 04  |..^..7...%P..\k.|
-00000380  b4 51 ec 9c d3 fa c6 b7  9c f0 46 aa 73 da 3c 0d  |.Q........F.s.<.|
-00000390  d3 bd 32 81 d4 d2 f1 1a  b0 92 f3 73 3e 54 2b 05  |..2........s>T+.|
-000003a0  92 24 34 75 df d6 18 a0  6a 82 95 4c 9b fc 7e b6  |.$4u....j..L..~.|
-000003b0  8e 17 03 03 00 35 8f 34  0e 3b 91 d8 e7 74 24 71  |.....5.4.;...t$q|
-000003c0  0e 7b f3 12 bb 76 2f 31  12 17 b8 9e 24 ce f9 2f  |.{...v/1....$../|
-000003d0  3f 5d f2 13 4b 2e 9b 1e  c4 78 03 a6 c8 07 11 a3  |?]..K....x......|
-000003e0  98 79 61 6e 4f 44 6e 18  ee c4 9b 17 03 03 00 93  |.yanODn.........|
-000003f0  64 dd 52 a9 d9 51 63 6a  a0 a3 c2 75 6b 5d 1d 54  |d.R..Qcj...uk].T|
-00000400  ce d4 53 7e 14 8e d9 26  93 28 78 65 16 1b 95 77  |..S~...&.(xe...w|
-00000410  68 0a 46 f1 82 36 bb 8a  fa 0d df 54 8c 3d 83 e0  |h.F..6.....T.=..|
-00000420  d7 de 2d 96 e9 c4 d7 22  d3 97 8e ae 90 f8 fc e6  |..-...."........|
-00000430  a6 4b 78 98 4c c5 28 87  91 46 fa f4 1c 8d 0e ec  |.Kx.L.(..F......|
-00000440  0d 71 40 9a 04 49 b4 e8  5b 62 6f cd 16 c1 d5 fb  |.q@..I..[bo.....|
-00000450  73 2a 96 8f e5 a2 f4 11  1e df 2d 40 45 6b d5 a9  |s*........-@Ek..|
-00000460  e4 e3 f7 93 fc fa d7 20  af d5 f7 b4 0e 09 ad d5  |....... ........|
-00000470  26 87 b8 6c e2 20 95 fb  c0 70 3e 38 be b7 b1 9f  |&..l. ...p>8....|
-00000480  70 da c1                                          |p..|
+00000080  03 03 00 01 01 17 03 03  00 17 56 5c 7e c2 5b 89  |..........V\~.[.|
+00000090  51 54 8a 66 a4 47 19 5d  9e 67 0f a9 38 1b f4 8e  |QT.f.G.].g..8...|
+000000a0  ad 17 03 03 02 6d 87 f7  c5 67 68 94 33 94 ed 38  |.....m...gh.3..8|
+000000b0  1e 1b fc cf 7d fb 4b 62  ac 89 8d 49 67 79 6c 22  |....}.Kb...Igyl"|
+000000c0  7e 65 27 1f e7 9f 08 e2  37 9e 6e e5 7f 51 5c 19  |~e'.....7.n..Q\.|
+000000d0  76 14 ea 40 8f f7 eb cf  03 25 e0 84 7d 43 ea 24  |v..@.....%..}C.$|
+000000e0  b2 44 89 a9 ba 6d 29 8c  68 5f a5 33 f5 bf 95 39  |.D...m).h_.3...9|
+000000f0  d2 d2 01 48 75 5b 11 25  8d dd f9 89 21 10 5a d7  |...Hu[.%....!.Z.|
+00000100  e4 c9 1e c5 ed d7 0f b4  50 b2 6b 86 72 e9 d7 7e  |........P.k.r..~|
+00000110  8e 77 59 a2 cb 89 ce 93  95 ec e3 e6 aa ea bd a7  |.wY.............|
+00000120  81 14 46 ed 6f 5a f7 20  c3 63 8e 7b 42 28 32 f7  |..F.oZ. .c.{B(2.|
+00000130  51 b1 43 e2 02 a7 3a 13  77 a7 66 d8 e8 dc 29 2d  |Q.C...:.w.f...)-|
+00000140  8f ac ba 39 ea 0a 00 2e  6e ff a2 ed 2b ff fe 93  |...9....n...+...|
+00000150  c5 3a 27 10 cf 95 1f 0b  0f 46 e5 e9 21 16 b9 85  |.:'......F..!...|
+00000160  ad cf 08 0a f1 65 ce 5b  78 45 28 03 fc b7 d5 c4  |.....e.[xE(.....|
+00000170  e4 f0 b6 9b f6 30 cf 8c  48 17 c3 42 bf bf 76 c6  |.....0..H..B..v.|
+00000180  e9 dc 5e 49 93 d1 81 05  13 0d 04 22 87 5e 7b 03  |..^I.......".^{.|
+00000190  82 96 b0 2c 59 f6 67 18  ef a5 0f 9b 8c d1 8a 34  |...,Y.g........4|
+000001a0  a7 ec 8a 4b 1d 19 a4 79  c3 ac e9 5f 45 3c f5 50  |...K...y..._E<.P|
+000001b0  a0 9a f4 82 82 02 d2 98  33 3f a6 93 8a e9 2f d7  |........3?..../.|
+000001c0  ab c8 9b 69 77 a1 87 e8  5a 01 49 e1 4f bd 40 24  |...iw...Z.I.O.@$|
+000001d0  f8 f7 a1 b3 11 97 82 ee  59 76 48 fd a7 28 61 8f  |........YvH..(a.|
+000001e0  3e cc b1 40 a2 cb 8c 85  70 74 e0 be 17 60 1a f9  |>..@....pt...`..|
+000001f0  e2 3c 0c f8 94 05 81 ab  07 6a c4 72 60 0c 48 3f  |.<.......j.r`.H?|
+00000200  3f ea aa 62 e8 47 c0 19  d3 ed 91 b8 de 6d 29 58  |?..b.G.......m)X|
+00000210  f3 e9 6a 9b a5 b0 20 30  f3 63 b4 38 ea 29 5f 06  |..j... 0.c.8.)_.|
+00000220  5b f2 ac d8 df d0 49 da  73 60 22 5e 8e 1c bd e6  |[.....I.s`"^....|
+00000230  93 cd c8 a6 5a 66 3a 67  3a 11 ad bb 4d 95 91 b3  |....Zf:g:...M...|
+00000240  fe a0 c5 a2 70 ee 8f 85  36 bd a3 54 e2 a5 93 ac  |....p...6..T....|
+00000250  a7 83 7f 8b d3 53 72 78  da cb b0 57 5a 0f bd fb  |.....Srx...WZ...|
+00000260  c3 35 82 7c 4a a8 33 99  95 c3 6b 8c fc 01 42 da  |.5.|J.3...k...B.|
+00000270  ec 04 32 3b 25 45 8a 8a  48 0d 0a 9e 91 86 19 26  |..2;%E..H......&|
+00000280  ea 13 89 28 6c 06 67 71  e1 47 43 62 cd 48 94 0c  |...(l.gq.GCb.H..|
+00000290  12 ef 2d 78 b0 3c e6 cc  d3 18 d4 c5 64 6a a4 06  |..-x.<......dj..|
+000002a0  a2 63 60 d0 08 94 8c 2e  f9 f4 5a ef f8 2a b2 82  |.c`.......Z..*..|
+000002b0  5a 45 20 42 94 bc 62 b0  fa a1 b6 58 84 52 c4 36  |ZE B..b....X.R.6|
+000002c0  a5 4b b1 30 d8 c2 d9 1f  65 a0 fb 7d 8b 0a 7b c4  |.K.0....e..}..{.|
+000002d0  4f d7 74 2d 7e 32 48 6f  76 02 7d 6d fc f7 7e 83  |O.t-~2Hov.}m..~.|
+000002e0  83 da e9 26 30 24 1a c4  bd a8 7e 28 c6 55 98 c1  |...&0$....~(.U..|
+000002f0  5b da 9c 44 d4 5b 47 4f  d9 31 a4 0b 42 b0 d9 aa  |[..D.[GO.1..B...|
+00000300  cb 27 3d 8e 9a f2 94 af  ac 1c 3d 4d 1e 67 7b e3  |.'=.......=M.g{.|
+00000310  bd 05 d9 17 03 03 00 99  a3 72 0d 1b 6c 47 36 62  |.........r..lG6b|
+00000320  31 73 57 dc fc 11 7d 64  1d fc f0 6f 6f 46 93 03  |1sW...}d...ooF..|
+00000330  fd 12 e5 c6 c3 60 92 5b  90 ae 27 53 9a 56 98 20  |.....`.[..'S.V. |
+00000340  ae 55 46 5f be 29 9a 94  c3 ca 43 11 60 60 97 89  |.UF_.)....C.``..|
+00000350  22 17 39 a2 2e f6 e3 f9  0a 03 66 36 90 4d 6b d5  |".9.......f6.Mk.|
+00000360  4b b7 69 32 65 17 4b 64  79 54 3a f4 bb 66 f7 44  |K.i2e.KdyT:..f.D|
+00000370  8c 8b 7f 4f 51 bb f4 b1  67 22 ee 45 49 79 26 96  |...OQ...g".EIy&.|
+00000380  72 99 bf 56 67 d4 f5 60  b5 01 5a f2 4d 6e b2 b6  |r..Vg..`..Z.Mn..|
+00000390  c3 22 ef a7 2f 94 f1 70  5f 62 da ca c9 50 eb 61  |."../..p_b...P.a|
+000003a0  04 97 bf 3f 02 fd 3c 26  98 e7 ad cf a1 e6 40 ff  |...?..<&......@.|
+000003b0  f8 17 03 03 00 35 21 ba  75 71 13 01 d7 65 6f 2a  |.....5!.uq...eo*|
+000003c0  bb 11 15 d0 8b fe 47 4c  a4 c5 b7 93 8d a7 81 9e  |......GL........|
+000003d0  69 df c5 a7 cc 28 6d c6  2b 69 9c 73 86 9e ab 18  |i....(m.+i.s....|
+000003e0  14 2d 62 f4 03 c2 24 df  50 b6 62 17 03 03 00 83  |.-b...$.P.b.....|
+000003f0  3f 50 11 08 fa 9d 03 db  9f ce f7 82 72 9e ec b1  |?P..........r...|
+00000400  02 d7 b9 6c a4 fe 64 9d  28 e0 30 8c 5d 18 48 c7  |...l..d.(.0.].H.|
+00000410  fc 67 18 80 73 06 05 f5  2c 0a 2c b3 28 48 2d 39  |.g..s...,.,.(H-9|
+00000420  48 9d 4e 0a 34 95 ee 15  b9 51 cf 64 00 cc b9 98  |H.N.4....Q.d....|
+00000430  18 83 37 39 f5 e9 eb 0e  1a 68 7c b8 4d f3 07 1b  |..79.....h|.M...|
+00000440  02 bf cc 73 a9 d5 17 72  f4 6e 65 15 0b c7 65 fa  |...s...r.ne...e.|
+00000450  50 5a 5e 40 56 a3 8e 28  bd 0f 95 e4 5c 8b 8a 53  |PZ^@V..(....\..S|
+00000460  25 a2 c4 71 96 c0 f6 19  f6 2e 3b 29 f5 76 d7 1c  |%..q......;).v..|
+00000470  54 c3 79                                          |T.y|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 29 d2 b9 bb 9b  |..........5)....|
-00000010  de 6c 5d 22 23 c1 fe 99  4c c5 33 bf fd 70 36 6b  |.l]"#...L.3..p6k|
-00000020  f1 a5 92 e8 bf 7c 3d 6e  ef 6a 44 73 bc cb 27 1c  |.....|=n.jDs..'.|
-00000030  09 5d bf 99 4c 19 24 c3  3b 30 91 b5 e3 b6 63 45  |.]..L.$.;0....cE|
+00000000  14 03 03 00 01 01 17 03  03 00 35 fd 12 fe d9 79  |..........5....y|
+00000010  61 9e 20 82 d8 dc 16 66  c6 e1 3c 7f 6c 9b d7 14  |a. ....f..<.l...|
+00000020  40 95 89 7e 92 3c 1d 86  5b fd c7 7c d7 9e 08 a6  |@..~.<..[..|....|
+00000030  8f 93 9a 64 86 b7 1d ce  9e 91 18 2e 50 8f 49 2e  |...d........P.I.|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 52 55 85  7c b8 87 dd c7 b2 d9 5b  |.....RU.|......[|
-00000010  18 1d bb ac bf b6 ab 76  82 be 64 0e b2 7b 2c 0f  |.......v..d..{,.|
-00000020  aa 17 92 17 03 03 00 13  79 0a 60 b1 46 20 33 74  |........y.`.F 3t|
-00000030  ed 12 a0 23 de 68 88 fc  6f dd 8e                 |...#.h..o..|
+00000000  17 03 03 00 1e e4 7e 4c  d9 38 28 df bc 49 d0 1e  |......~L.8(..I..|
+00000010  4f 11 c3 48 95 cf 95 38  e1 97 05 5c 0a 41 f5 e3  |O..H...8...\.A..|
+00000020  4a ea 82 17 03 03 00 13  3d 8e 98 39 2b 31 61 6f  |J.......=..9+1ao|
+00000030  40 ef 2e b0 1c 99 17 d5  a3 81 98                 |@..........|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ALPN-NotConfigured b/src/crypto/tls/testdata/Server-TLSv13-ALPN-NotConfigured
index e0830d30f7..a22c81461b 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ALPN-NotConfigured
+++ b/src/crypto/tls/testdata/Server-TLSv13-ALPN-NotConfigured
@@ -1,9 +1,9 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 e2 01 00 00  de 03 03 9f 49 a7 46 f8  |............I.F.|
-00000010  72 04 47 a1 8e 4f 89 c3  cd 89 92 2f 7a 8a 07 37  |r.G..O...../z..7|
-00000020  8c 25 10 42 26 07 8b a2  71 3e 92 20 4c 83 1b 70  |.%.B&...q>. L..p|
-00000030  45 c3 79 68 c3 83 a7 05  c2 22 06 c6 91 da 8b 96  |E.yh....."......|
-00000040  4c 9d 89 c2 ec b8 49 87  17 3f 6c ae 00 04 13 03  |L.....I..?l.....|
+00000000  16 03 01 00 e2 01 00 00  de 03 03 20 13 cc 97 59  |........... ...Y|
+00000010  07 73 4a a6 57 2d 3d c6  72 2c 30 1a 4f 7c b0 68  |.sJ.W-=.r,0.O|.h|
+00000020  40 4c ec 03 c3 bd 58 e4  e1 30 cd 20 e3 28 32 13  |@L....X..0. .(2.|
+00000030  80 e5 af 3f b0 e4 65 4e  40 84 87 3d 14 9f 20 b7  |...?..eN@..=.. .|
+00000040  61 9c 16 ce 73 20 9b e9  24 7d c0 e7 00 04 13 03  |a...s ..$}......|
 00000050  00 ff 01 00 00 91 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 10 00 10 00 0e  06 70 72 6f 74 6f 32 06  |.........proto2.|
@@ -11,90 +11,89 @@
 00000090  00 1e 00 1c 04 03 05 03  06 03 08 07 08 08 08 09  |................|
 000000a0  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
 000000b0  00 2b 00 03 02 03 04 00  2d 00 02 01 01 00 33 00  |.+......-.....3.|
-000000c0  26 00 24 00 1d 00 20 f4  91 87 6a ac cd 25 5e f1  |&.$... ...j..%^.|
-000000d0  0d 25 fb af a4 d4 fb 16  32 63 af 04 2d 21 d7 2f  |.%......2c..-!./|
-000000e0  61 f2 c2 d4 c4 6c 2b                              |a....l+|
+000000c0  26 00 24 00 1d 00 20 e2  aa 00 7b 5e df 4a 25 94  |&.$... ...{^.J%.|
+000000d0  c3 0b 48 f8 23 d8 5c e8  8b 55 e8 38 bc 58 69 6c  |..H.#.\..U.8.Xil|
+000000e0  a2 a8 22 98 56 46 72                              |..".VFr|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 4c 83 1b 70  |........... L..p|
-00000030  45 c3 79 68 c3 83 a7 05  c2 22 06 c6 91 da 8b 96  |E.yh....."......|
-00000040  4c 9d 89 c2 ec b8 49 87  17 3f 6c ae 13 03 00 00  |L.....I..?l.....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 e3 28 32 13  |........... .(2.|
+00000030  80 e5 af 3f b0 e4 65 4e  40 84 87 3d 14 9f 20 b7  |...?..eN@..=.. .|
+00000040  61 9c 16 ce 73 20 9b e9  24 7d c0 e7 13 03 00 00  |a...s ..$}......|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 60 79 16 61 4f 6c  |..........`y.aOl|
-00000090  9e 2e ce fd cc f5 29 67  38 e7 53 67 92 b1 5f 9d  |......)g8.Sg.._.|
-000000a0  db 17 03 03 02 6d 54 d9  d6 a1 8e c2 1b 70 3f 3d  |.....mT......p?=|
-000000b0  a2 2e 0f a5 37 96 e1 68  66 69 cc f8 e9 06 4d bc  |....7..hfi....M.|
-000000c0  c2 9a 6e 0f ea d4 73 59  6a 59 28 79 7f 44 0c 32  |..n...sYjY(y.D.2|
-000000d0  29 22 51 d1 fb 00 c7 33  44 8b 19 71 98 8a 03 44  |)"Q....3D..q...D|
-000000e0  e0 95 ad 8f 91 66 e6 15  b8 99 b3 f8 2f 02 e9 a0  |.....f....../...|
-000000f0  4a 25 ec 3f 36 56 0c eb  0a a3 e0 d3 79 a1 b3 9e  |J%.?6V......y...|
-00000100  dc 42 08 76 a4 c3 55 91  06 11 e7 0c 94 dd 71 fc  |.B.v..U.......q.|
-00000110  bf 8a 87 d2 97 07 a3 b9  36 7e 58 ff ef b3 a3 f4  |........6~X.....|
-00000120  6e f1 23 d6 50 e3 23 d3  dc e7 20 ce 9d 84 17 cf  |n.#.P.#... .....|
-00000130  2d 5f b1 f9 8d 36 41 7d  ba 3b 93 63 2f bc be f0  |-_...6A}.;.c/...|
-00000140  a1 3a bb 5f b3 99 03 13  fb d2 2c 1a 8c cc 32 02  |.:._......,...2.|
-00000150  ef 93 b4 58 a8 f8 b1 42  52 24 c2 73 01 cb 5a fb  |...X...BR$.s..Z.|
-00000160  9f fc 38 08 d7 f9 0d d7  20 fa dc 8b 1a 8c 73 0f  |..8..... .....s.|
-00000170  f8 79 b2 84 e1 49 2d 8e  6d 46 16 38 0e 02 2a 2c  |.y...I-.mF.8..*,|
-00000180  f4 44 89 da f1 7a 01 55  9e 93 a8 d6 d5 f5 72 28  |.D...z.U......r(|
-00000190  47 2b 4f 17 7e a5 01 fd  ad 85 e0 6d f9 82 e8 cd  |G+O.~......m....|
-000001a0  09 18 84 8c 9d 4f 4e a1  43 ff d6 3d 55 05 fc 56  |.....ON.C..=U..V|
-000001b0  e6 d6 b6 61 4a c7 c7 9c  62 64 26 1d 33 1e 4f d5  |...aJ...bd&.3.O.|
-000001c0  5e ee 1f a9 ad 24 e4 7f  05 cc 02 7a f7 e0 c2 ce  |^....$.....z....|
-000001d0  b8 11 c9 a1 fd c5 d8 0e  ef f8 c9 6a 2d 49 30 63  |...........j-I0c|
-000001e0  e3 9b 43 bf 87 e1 5f 55  39 fa 80 ec 84 55 59 5d  |..C..._U9....UY]|
-000001f0  52 76 4c f4 70 eb 43 6a  b2 07 d5 29 4c 58 39 04  |RvL.p.Cj...)LX9.|
-00000200  46 42 70 8d 28 61 7c d5  7a 3a 2e a0 9f 74 49 2d  |FBp.(a|.z:...tI-|
-00000210  33 8d 39 18 70 8d 3c 50  4f 62 07 77 2d 15 1f 4b  |3.9.p.<POb.w-..K|
-00000220  22 01 c6 cb ac 2f 2d 9a  cf a6 9b 0e 24 99 41 64  |"..../-.....$.Ad|
-00000230  3e f2 9f 5f 17 7b d7 b8  3c b6 6d 24 5b 91 8c 13  |>.._.{..<.m$[...|
-00000240  1a 40 4e 80 7f 44 12 57  c9 03 57 c6 9b 54 0d 39  |.@N..D.W..W..T.9|
-00000250  91 88 72 3e c8 f9 18 eb  34 7c 0a eb 2d c8 56 1c  |..r>....4|..-.V.|
-00000260  84 8a 62 a2 3a 0a 52 b8  5a b6 5d 54 78 ae 05 b2  |..b.:.R.Z.]Tx...|
-00000270  f4 6c 2d 5e 92 94 6b f3  1e 93 13 1a 65 74 60 e3  |.l-^..k.....et`.|
-00000280  dd 15 36 62 2b 71 b1 bb  59 19 08 af 8e 9b d0 47  |..6b+q..Y......G|
-00000290  05 7b a3 89 ac 68 cf a0  32 ba 4a 2b 9e 5f a5 dc  |.{...h..2.J+._..|
-000002a0  b3 00 79 a8 1c f6 11 b8  6d 9c 51 b7 f1 f6 b2 13  |..y.....m.Q.....|
-000002b0  56 57 4e ac 97 ff 5a b8  52 33 0c c1 3d 52 81 6e  |VWN...Z.R3..=R.n|
-000002c0  85 ba b2 04 4b eb 41 aa  03 ff ae 63 93 72 3a 5f  |....K.A....c.r:_|
-000002d0  65 81 f9 6a 2a e4 70 f8  b3 59 31 51 62 ad 25 24  |e..j*.p..Y1Qb.%$|
-000002e0  82 0c b5 ad 7c 87 21 97  07 c0 c1 6d f0 22 97 0d  |....|.!....m."..|
-000002f0  28 cf a7 4d 74 d2 9c ac  d7 15 83 26 f7 2f 76 d4  |(..Mt......&./v.|
-00000300  ad cf e7 ef 1c f4 3e 1f  b4 f4 4f 76 6a 98 15 01  |......>...Ovj...|
-00000310  cd 17 8b 17 03 03 00 99  0b 15 9d 16 c6 2a 52 53  |.............*RS|
-00000320  33 d7 01 db 8a 49 1d d6  83 b7 28 a4 07 f0 73 5e  |3....I....(...s^|
-00000330  60 03 2c 6f 3f e0 88 a1  76 22 d6 23 0a df ca 86  |`.,o?...v".#....|
-00000340  b0 44 b9 1d 9a d7 53 f2  2b 57 a1 65 01 d4 e7 b4  |.D....S.+W.e....|
-00000350  9e 22 00 d2 20 da cd 55  7d 61 86 86 19 81 f9 ed  |.".. ..U}a......|
-00000360  f8 af c4 69 54 1d 35 0a  6f 9e 69 40 13 08 82 dd  |...iT.5.o.i@....|
-00000370  59 11 31 f2 81 a7 4b f1  bd d9 f2 5c 29 22 16 49  |Y.1...K....\)".I|
-00000380  86 62 8c a8 b8 89 58 96  cc d1 e4 e8 5e ef 6c b7  |.b....X.....^.l.|
-00000390  00 71 3d ab 92 b8 78 56  a7 25 5e a0 c4 d8 8c 02  |.q=...xV.%^.....|
-000003a0  c4 c8 eb d3 be 68 21 05  5c 5f 9c b0 ec 20 99 ff  |.....h!.\_... ..|
-000003b0  00 17 03 03 00 35 c9 c1  5e 25 1c b9 64 8e c2 fd  |.....5..^%..d...|
-000003c0  50 87 48 e6 02 36 75 31  67 f6 82 3c 94 79 7d 0b  |P.H..6u1g..<.y}.|
-000003d0  cb 83 b1 f4 e1 00 5f a6  b6 2c 2d 63 40 ab 98 f9  |......_..,-c@...|
-000003e0  e3 8e 4a 7e d4 77 3d 55  90 10 75 17 03 03 00 93  |..J~.w=U..u.....|
-000003f0  47 c4 6e 19 29 c2 5e d5  93 b7 c2 cc 46 a9 49 9d  |G.n.).^.....F.I.|
-00000400  8a 3b 9a 35 bb 45 22 13  b6 eb c9 ec ba 44 3c 24  |.;.5.E"......D<$|
-00000410  f2 ed bd 76 11 cc af 00  b3 89 63 5d 79 32 cc d7  |...v......c]y2..|
-00000420  5c 34 f3 5e 64 36 92 5d  ac ac 33 74 f4 3d c4 b8  |\4.^d6.]..3t.=..|
-00000430  4d ac d0 49 4e 59 1c 16  74 8c 43 94 4b 13 b9 22  |M..INY..t.C.K.."|
-00000440  de d7 ee 30 09 63 f3 32  5f a2 9d a1 20 ea ee 91  |...0.c.2_... ...|
-00000450  ca d8 01 33 df 43 19 69  63 ee 6a 2c 80 99 ad f0  |...3.C.ic.j,....|
-00000460  5e 20 b6 b6 81 28 b6 9d  4a 9a 91 30 30 04 c1 70  |^ ...(..J..00..p|
-00000470  68 54 1e e0 72 00 4c fd  23 a8 41 a2 6a ab a3 01  |hT..r.L.#.A.j...|
-00000480  7a 40 1a                                          |z@.|
+00000080  03 03 00 01 01 17 03 03  00 17 b3 a3 d2 fd 59 6b  |..............Yk|
+00000090  66 85 a1 5e 31 53 90 46  f2 67 5b 8a 4d 71 e5 58  |f..^1S.F.g[.Mq.X|
+000000a0  3f 17 03 03 02 6d eb 43  2b 01 70 f2 22 23 5b 97  |?....m.C+.p."#[.|
+000000b0  41 00 2c ce 6c 24 f4 3d  21 da e6 08 48 34 15 bd  |A.,.l$.=!...H4..|
+000000c0  af e3 c8 aa 96 90 25 8c  a3 75 f6 90 04 9c 0b 55  |......%..u.....U|
+000000d0  96 dd df 13 18 05 d3 33  fe cc 0a d9 e9 97 13 1c  |.......3........|
+000000e0  f4 48 de b3 62 18 f6 e9  e1 e0 4a 96 6b 60 a8 a5  |.H..b.....J.k`..|
+000000f0  34 97 a3 52 fb 04 90 4a  91 64 e7 b8 ba b1 1e 4c  |4..R...J.d.....L|
+00000100  4f 29 fc 9e 06 24 45 be  f9 ba 6e 19 24 ca b4 79  |O)...$E...n.$..y|
+00000110  15 91 a3 63 7c 04 0e 0c  69 82 34 df 71 ef 16 be  |...c|...i.4.q...|
+00000120  8f 5d 9f fd 41 fe 14 4e  94 73 24 4e 5e bb 7a 3c  |.]..A..N.s$N^.z<|
+00000130  be 91 d4 83 f5 c5 d8 f6  d3 e0 75 d1 33 cc fa c0  |..........u.3...|
+00000140  39 47 2f 0a 1d 02 f7 7b  34 b1 d5 ff bc 3d 33 02  |9G/....{4....=3.|
+00000150  00 4b 4f f4 6e 76 b0 c9  f6 24 aa bd 12 3b 11 90  |.KO.nv...$...;..|
+00000160  3c 87 75 23 02 e1 92 67  55 e6 fc df 56 43 63 33  |<.u#...gU...VCc3|
+00000170  e8 bf be 85 9a d8 88 ff  b2 ae f4 cb 95 62 b0 9d  |.............b..|
+00000180  a0 cb 71 da a9 bf b6 62  49 49 87 38 33 0b 09 38  |..q....bII.83..8|
+00000190  f9 5c ad ce d6 60 6b e1  e2 cb 3e 4f d9 56 e1 6b  |.\...`k...>O.V.k|
+000001a0  b3 0e 91 d3 3c 65 c4 27  66 e8 b6 20 25 1a b7 5f  |....<e.'f.. %.._|
+000001b0  1d 93 bc 3d 8c f5 ba bc  7b 36 8f 4a ff 16 a3 30  |...=....{6.J...0|
+000001c0  d7 d4 87 0f b7 7d bc 35  a3 58 51 b6 f4 f4 10 c6  |.....}.5.XQ.....|
+000001d0  58 ff 4e 02 34 d8 c0 5f  3b dd d7 32 9f 62 cd 8e  |X.N.4.._;..2.b..|
+000001e0  59 fa e6 88 50 38 24 0b  1b 55 fa 58 db e4 09 25  |Y...P8$..U.X...%|
+000001f0  67 08 70 36 f2 bb f4 cd  03 c8 ff 8b 06 59 c8 df  |g.p6.........Y..|
+00000200  34 c8 5d 37 d8 5b 9b 03  2a c5 8d ec a8 9f a7 86  |4.]7.[..*.......|
+00000210  f2 f7 8e 53 42 d6 03 df  bb b4 ec 6f fd a5 42 9b  |...SB......o..B.|
+00000220  d1 06 55 c8 f1 ce 68 eb  b9 1e a9 4c ea 58 e3 4c  |..U...h....L.X.L|
+00000230  f0 a2 55 c5 7d 8f 0f 52  08 51 0b 33 5e 56 e6 ac  |..U.}..R.Q.3^V..|
+00000240  32 30 61 e5 ea ca 5f b8  ae cc 07 ba 68 16 59 a8  |20a..._.....h.Y.|
+00000250  e7 b6 01 f7 2b 19 cf 77  3e 69 b6 5d 26 6b e8 1e  |....+..w>i.]&k..|
+00000260  a0 b9 73 74 d9 55 1c 94  a4 5a 5d 23 31 5a d7 0e  |..st.U...Z]#1Z..|
+00000270  85 6d d2 ba 12 1f 6a 71  6c 80 ed d1 c4 6a 47 5c  |.m....jql....jG\|
+00000280  04 d8 b1 0b d4 98 37 0b  4c 06 34 5f e9 67 02 53  |......7.L.4_.g.S|
+00000290  04 3d 9d 19 77 b6 d6 79  5f de 2a 85 7b b6 9d ae  |.=..w..y_.*.{...|
+000002a0  fc a1 45 7f ff ea c7 16  ac cf da c3 76 39 fc d8  |..E.........v9..|
+000002b0  e6 9b 7d e3 c4 e6 cd d2  73 de 5a aa ed 6c 58 89  |..}.....s.Z..lX.|
+000002c0  3b f9 92 88 63 4a fe 42  b1 e9 41 7a 2f 6f 5f 8d  |;...cJ.B..Az/o_.|
+000002d0  46 97 f6 71 92 c0 13 b9  b5 4b 8f 12 fb f6 12 97  |F..q.....K......|
+000002e0  03 7a 88 27 8b 5f 3b 65  81 fb 10 39 fd a8 32 86  |.z.'._;e...9..2.|
+000002f0  3b 61 80 01 b6 36 b7 a1  51 f7 80 c2 a9 45 1d a4  |;a...6..Q....E..|
+00000300  ae 9e bf 53 6c 23 46 85  09 d9 4f cc 58 c7 35 65  |...Sl#F...O.X.5e|
+00000310  c4 de 5b 17 03 03 00 99  7f 63 00 98 7f 90 57 8a  |..[......c....W.|
+00000320  6a c4 71 b4 d8 1f be 7f  07 1c 23 17 1b 62 4e 0a  |j.q.......#..bN.|
+00000330  3c 7c af a0 60 84 1b 78  9e 93 05 9b d1 7d 8b aa  |<|..`..x.....}..|
+00000340  cf 84 ae dc 84 1b 06 54  57 2d 82 1d c7 08 ca 6c  |.......TW-.....l|
+00000350  5c d5 b1 9e df 06 50 b5  6a b7 f3 5f 7a ba 55 7f  |\.....P.j.._z.U.|
+00000360  ed a7 fa 71 b1 8b 76 d2  7c 66 69 4b 88 1e 1b 10  |...q..v.|fiK....|
+00000370  6d 0e 48 ee fc 61 8a ee  5f 83 5a b8 67 d8 b3 e3  |m.H..a.._.Z.g...|
+00000380  0d 26 8b b2 9b 44 26 8c  33 51 e2 b4 19 be 49 b6  |.&...D&.3Q....I.|
+00000390  8b 27 60 44 87 0c 6f 7e  10 b8 21 3f 2d 24 42 c2  |.'`D..o~..!?-$B.|
+000003a0  9b 7b 86 a6 a5 2d 8d 3b  83 ef bb dc c2 75 18 b8  |.{...-.;.....u..|
+000003b0  81 17 03 03 00 35 b2 6d  b6 54 2f 32 2f c3 24 61  |.....5.m.T/2/.$a|
+000003c0  76 d7 04 8e f3 d2 b4 0f  94 fe d4 74 ea b4 18 c0  |v..........t....|
+000003d0  06 c9 a4 d8 03 c3 df 60  fa b0 06 3b 26 bb 34 bf  |.......`...;&.4.|
+000003e0  f3 71 f0 75 81 60 20 52  eb b3 2d 17 03 03 00 83  |.q.u.` R..-.....|
+000003f0  7f db 17 a7 c6 c0 0d ff  f1 af 6e 96 16 a8 1a 0f  |..........n.....|
+00000400  82 c5 4c e1 74 e3 85 95  9d 2b 9e df 50 9d 96 d3  |..L.t....+..P...|
+00000410  c5 f0 1c e7 73 1b 11 2c  ad 16 d8 aa d0 f5 61 1c  |....s..,......a.|
+00000420  ce a8 34 e3 ee 1d c1 fc  fd f9 57 e2 0e fc 38 77  |..4.......W...8w|
+00000430  74 11 2a 48 66 aa 19 03  76 28 47 dd 30 d1 9d a5  |t.*Hf...v(G.0...|
+00000440  3f 1c de 24 1d 52 dc 57  11 c3 23 70 44 18 5f c3  |?..$.R.W..#pD._.|
+00000450  84 84 0a 5d fc 9a b9 14  41 c4 47 fc f6 ba 92 ca  |...]....A.G.....|
+00000460  91 51 50 99 d1 f4 ee 3d  be cc 5f 60 be 46 9a 0a  |.QP....=.._`.F..|
+00000470  d0 fd 7f                                          |...|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 20 1f 0d 20 a8  |..........5 .. .|
-00000010  34 c4 dc fa f9 d6 2b fe  01 eb f1 54 f0 14 c2 2d  |4.....+....T...-|
-00000020  bb 59 db 04 96 f2 18 8b  bd 7e b0 38 b7 15 b5 d8  |.Y.......~.8....|
-00000030  6b f2 80 25 40 f6 97 67  fb 9e 5a 5c ad 33 c6 5f  |k..%@..g..Z\.3._|
+00000000  14 03 03 00 01 01 17 03  03 00 35 43 b3 ff 55 3e  |..........5C..U>|
+00000010  fe 5b f8 9a 2d ce b8 af  3c ce e7 c3 f8 5e 1f 21  |.[..-...<....^.!|
+00000020  02 42 4c ba 59 a6 56 1f  36 51 74 f6 e4 94 9a da  |.BL.Y.V.6Qt.....|
+00000030  3c 9b d2 57 d0 78 54 8f  25 d3 7b 28 fe f1 a7 ee  |<..W.xT.%.{(....|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 3a 8a fc  60 3a 99 ee b6 01 b7 fe  |.....:..`:......|
-00000010  54 a9 2d 34 28 ae af 3b  6a bd e0 32 6b df 87 fe  |T.-4(..;j..2k...|
-00000020  d0 97 8d 17 03 03 00 13  c6 89 d5 ae 4c fa d5 71  |............L..q|
-00000030  66 6e 07 b5 9b 00 e8 50  7e b9 5f                 |fn.....P~._|
+00000000  17 03 03 00 1e 89 13 c3  ca 84 60 a1 17 50 6f 35  |..........`..Po5|
+00000010  fb 9f d6 4a 1a 04 a0 e6  81 a5 2e e6 89 e3 bd 14  |...J............|
+00000020  c9 f9 0c 17 03 03 00 13  9b 1a fa 82 f4 19 92 0c  |................|
+00000030  b1 cc 7b c9 ef d0 a7 9b  ab dd fd                 |..{........|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-CHACHA20-SHA256 b/src/crypto/tls/testdata/Server-TLSv13-CHACHA20-SHA256
index 760c597003..4895a0a0ad 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-CHACHA20-SHA256
+++ b/src/crypto/tls/testdata/Server-TLSv13-CHACHA20-SHA256
@@ -1,100 +1,97 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 dc 01 00 00  d8 03 03 7f d6 02 2f 2d  |............../-|
-00000010  ed b1 3c f2 c2 48 5e d5  f4 57 c9 8c ba 81 36 52  |..<..H^..W....6R|
-00000020  85 3e 79 de 79 cc 36 6a  f9 88 89 20 db e1 89 a5  |.>y.y.6j... ....|
-00000030  26 4c 2a 2d 0f 33 e2 3f  57 05 cc 74 cd 4c 96 be  |&L*-.3.?W..t.L..|
-00000040  91 94 ef 54 1c 1f 01 ef  d4 36 75 2f 00 04 13 03  |...T.....6u/....|
-00000050  00 ff 01 00 00 8b 00 00  00 0e 00 0c 00 00 09 31  |...............1|
-00000060  32 37 2e 30 2e 30 2e 31  00 0b 00 04 03 00 01 02  |27.0.0.1........|
-00000070  00 0a 00 0c 00 0a 00 1d  00 17 00 1e 00 19 00 18  |................|
-00000080  00 16 00 00 00 17 00 00  00 0d 00 1e 00 1c 04 03  |................|
-00000090  05 03 06 03 08 07 08 08  08 09 08 0a 08 0b 08 04  |................|
-000000a0  08 05 08 06 04 01 05 01  06 01 00 2b 00 03 02 03  |...........+....|
-000000b0  04 00 2d 00 02 01 01 00  33 00 26 00 24 00 1d 00  |..-.....3.&.$...|
-000000c0  20 30 20 a8 d0 3d ea df  38 aa 65 6f dd c8 25 13  | 0 ..=..8.eo..%.|
-000000d0  03 c4 a2 24 d4 a8 0d 1a  a6 65 32 75 83 ef 71 70  |...$.....e2u..qp|
-000000e0  30                                                |0|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 42 21 89 90 14  |...........B!...|
+00000010  ea c9 cd 2f 38 04 0f f8  c3 22 c1 26 1f cb 5b 15  |.../8....".&..[.|
+00000020  14 5c 75 b5 c3 b9 3d ef  f2 42 e7 20 14 0d ad f9  |.\u...=..B. ....|
+00000030  f3 2a 03 68 0f 76 06 1b  2d 92 a7 53 6d 29 1f 29  |.*.h.v..-..Sm).)|
+00000040  bc 9d ec 83 82 a3 f0 8e  1f cd c9 c3 00 04 13 03  |................|
+00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
+00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
+00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
+00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
+00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 35  |-.....3.&.$... 5|
+000000b0  dd 05 d6 e1 56 8f 76 31  3e ac 52 7a 74 b5 73 3e  |....V.v1>.Rzt.s>|
+000000c0  a3 42 ac 0c cb 8d 57 b9  e0 3d 98 d9 a4 41 3b     |.B....W..=...A;|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 db e1 89 a5  |........... ....|
-00000030  26 4c 2a 2d 0f 33 e2 3f  57 05 cc 74 cd 4c 96 be  |&L*-.3.?W..t.L..|
-00000040  91 94 ef 54 1c 1f 01 ef  d4 36 75 2f 13 03 00 00  |...T.....6u/....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 14 0d ad f9  |........... ....|
+00000030  f3 2a 03 68 0f 76 06 1b  2d 92 a7 53 6d 29 1f 29  |.*.h.v..-..Sm).)|
+00000040  bc 9d ec 83 82 a3 f0 8e  1f cd c9 c3 13 03 00 00  |................|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 f4 9a 6e ea 99 81  |............n...|
-00000090  59 33 26 a6 6a 40 1d a9  59 67 31 35 09 b0 ed 15  |Y3&.j@..Yg15....|
-000000a0  83 17 03 03 02 6d 56 59  69 c8 6d 45 c6 2f 58 3d  |.....mVYi.mE./X=|
-000000b0  db 87 dd 56 0f 2d d9 21  1b 97 94 77 f2 72 28 0d  |...V.-.!...w.r(.|
-000000c0  48 04 79 83 7e 2e a1 c9  30 56 d7 9c c8 0a 37 65  |H.y.~...0V....7e|
-000000d0  b6 6b 31 ae 9a 5f ff 13  15 94 99 7c 92 e1 32 80  |.k1.._.....|..2.|
-000000e0  28 3c ab b1 cc fe ba 92  3c 03 bb fd b8 55 f5 f2  |(<......<....U..|
-000000f0  ba be 28 90 c5 7e 07 48  d5 45 b6 84 80 02 2d cd  |..(..~.H.E....-.|
-00000100  14 27 81 b6 4e b4 7f 5f  78 a3 26 c2 0c af 12 d6  |.'..N.._x.&.....|
-00000110  e9 14 22 c8 ee 2e 5e fc  c3 ca 8f 01 9b 37 6a b0  |.."...^......7j.|
-00000120  f8 53 b2 8e 31 d7 1f 34  f6 35 ed 81 e0 f7 6f e1  |.S..1..4.5....o.|
-00000130  90 cf 1a 4f 44 50 d5 cd  96 c3 4a 22 7a 54 28 bd  |...ODP....J"zT(.|
-00000140  88 56 5c 77 67 eb a6 78  5c 8b 82 39 03 13 55 c3  |.V\wg..x\..9..U.|
-00000150  20 68 45 26 7a 96 fe 1c  f9 33 14 1e 1d 8a 5f 51  | hE&z....3...._Q|
-00000160  c3 2f 17 91 ba 37 63 49  e1 65 89 bf e8 a1 27 5f  |./...7cI.e....'_|
-00000170  fd 59 46 80 f7 9b 45 89  50 ab cd 9b aa b4 45 04  |.YF...E.P.....E.|
-00000180  b5 1b 85 88 1c 59 ba b2  d6 50 0b fd 5c d9 59 83  |.....Y...P..\.Y.|
-00000190  7a 6c 9b ad 27 33 a0 49  74 eb a6 cd a8 e8 4b d7  |zl..'3.It.....K.|
-000001a0  71 ef 63 64 ff 24 a7 09  2e b7 f6 6f 9d 9f 75 84  |q.cd.$.....o..u.|
-000001b0  97 0a 76 bf 72 ed ff e8  1a 49 ca 0b 0d f5 2c fb  |..v.r....I....,.|
-000001c0  69 c2 5c fe db 58 0a a1  9c d4 47 6a 8f a6 bd ec  |i.\..X....Gj....|
-000001d0  32 fb 40 6a 71 9d 19 37  e6 fd d4 3d fa 5b f3 53  |2.@jq..7...=.[.S|
-000001e0  43 df d5 fa 53 29 40 70  77 a6 9e f7 03 7d 08 8b  |C...S)@pw....}..|
-000001f0  5a 71 73 e5 af 45 58 56  9f 56 ad 73 aa d2 b3 7c  |Zqs..EXV.V.s...||
-00000200  92 99 c8 04 16 bf ca f2  81 2e 29 c3 79 21 f1 11  |..........).y!..|
-00000210  92 f4 1d 34 24 73 e3 82  28 5a 31 70 45 da 8d 94  |...4$s..(Z1pE...|
-00000220  38 75 31 bc f9 e5 2b 11  7e fd bc 19 fe 65 ad 53  |8u1...+.~....e.S|
-00000230  e5 e6 17 b8 69 ea 54 fd  92 a9 41 7a 8c 7f da 4f  |....i.T...Az...O|
-00000240  ba f1 9f a2 e2 5b e7 7a  23 17 9e 29 95 7e 72 79  |.....[.z#..).~ry|
-00000250  22 67 c5 68 0a 4d fb e9  64 61 3a 53 18 e7 dd 7d  |"g.h.M..da:S...}|
-00000260  5b 16 b9 fa 69 95 82 eb  ee 1a 30 97 93 97 fc ee  |[...i.....0.....|
-00000270  9e 2b 22 64 08 7d 25 05  77 5e d7 bd 0e c3 9f a4  |.+"d.}%.w^......|
-00000280  f4 bf 77 3d 56 84 c8 a1  10 1c e0 5b da 39 3d 2d  |..w=V......[.9=-|
-00000290  92 80 9a 07 b2 29 c5 ab  e0 e1 1c ad ba 3e fa 4e  |.....).......>.N|
-000002a0  65 4f 31 63 de 33 6a 5c  af e0 88 70 fc 6e 6a a2  |eO1c.3j\...p.nj.|
-000002b0  ca da 2f 14 1d 4f 8c 7d  8d da 36 9b ea 7f 7e 79  |../..O.}..6...~y|
-000002c0  9c dc 4a 3b 69 d9 50 31  bb f2 f8 8a 7f 6e 73 bc  |..J;i.P1.....ns.|
-000002d0  41 7c 3a 86 10 91 9b 3a  8e 3e c8 bc 6a c4 4d f2  |A|:....:.>..j.M.|
-000002e0  45 87 49 49 d2 2f aa 4d  d0 6f e9 1e a4 d6 06 63  |E.II./.M.o.....c|
-000002f0  ac 90 ce 9a cb f7 97 55  2b e8 8c 8d 55 f6 32 26  |.......U+...U.2&|
-00000300  55 d4 60 0e c0 0b da 0e  ac c9 4c c3 95 03 54 d7  |U.`.......L...T.|
-00000310  99 ec e1 17 03 03 00 99  c4 65 5e 67 e3 a1 98 d6  |.........e^g....|
-00000320  f8 34 15 ed a9 55 80 c7  c0 e7 ca 67 f1 cb 58 e2  |.4...U.....g..X.|
-00000330  6e 4d d4 9e 18 c3 37 c2  ff 72 bc cb 8e 6a 97 e2  |nM....7..r...j..|
-00000340  b5 83 75 34 2a 75 9f 7f  8e 1e 47 e6 cd 53 85 c5  |..u4*u....G..S..|
-00000350  69 b6 c0 46 9f 46 a8 09  6a 21 d5 af 36 d2 d0 ba  |i..F.F..j!..6...|
-00000360  65 0f da a5 af eb 3a 0c  8b 85 00 2a dd 11 71 28  |e.....:....*..q(|
-00000370  5b 71 a9 df 69 20 8a d9  27 1e 4f 02 89 03 6f 27  |[q..i ..'.O...o'|
-00000380  20 e1 37 17 69 c2 62 3e  46 39 43 2d 64 43 f3 cc  | .7.i.b>F9C-dC..|
-00000390  14 5f a0 73 06 bf 42 cb  da 79 21 28 b1 a1 c4 de  |._.s..B..y!(....|
-000003a0  39 98 83 ad 3a d6 05 fd  58 b0 2c 97 bf 48 74 0e  |9...:...X.,..Ht.|
-000003b0  25 17 03 03 00 35 69 10  76 25 e3 9e 63 10 76 73  |%....5i.v%..c.vs|
-000003c0  f5 fc 90 2c 95 e5 dc 29  79 a0 ed 0a 3a 72 58 38  |...,...)y...:rX8|
-000003d0  bf b9 17 af 77 9f 05 92  af d4 a7 c7 d6 56 77 01  |....w........Vw.|
-000003e0  da 94 31 d2 be be 95 e1  b1 95 75 17 03 03 00 93  |..1.......u.....|
-000003f0  f9 fa a9 41 89 d3 e8 3b  cb 11 63 76 56 fe 28 86  |...A...;..cvV.(.|
-00000400  87 b0 0f d0 4d a8 fb 22  e9 89 f6 40 8a db 51 be  |....M.."...@..Q.|
-00000410  2c 9f 9c 39 f4 43 bc 1f  b0 32 9b 9c 8e a6 6e e1  |,..9.C...2....n.|
-00000420  f3 f7 f0 91 ed 56 6f 2d  be 37 6b 3b ed f7 5b a6  |.....Vo-.7k;..[.|
-00000430  d3 14 0a f9 58 b8 7b 37  fc 15 97 57 79 16 8c 0c  |....X.{7...Wy...|
-00000440  d2 93 7a 58 b8 48 51 f7  58 82 7d a0 4b e1 41 f6  |..zX.HQ.X.}.K.A.|
-00000450  e1 44 12 1e ea 80 f3 b6  d0 72 ec 5c 84 01 6a b3  |.D.......r.\..j.|
-00000460  f7 83 b5 47 22 0b e7 03  60 09 a7 23 23 20 5e 6b  |...G"...`..## ^k|
-00000470  f6 25 34 64 11 ad 46 90  db cb 13 f5 10 0a 75 e8  |.%4d..F.......u.|
-00000480  3e c8 03                                          |>..|
+00000080  03 03 00 01 01 17 03 03  00 17 87 93 07 b6 34 ee  |..............4.|
+00000090  2c 95 e9 f9 62 f0 bb a2  93 8a cd 94 fa c9 ed 17  |,...b...........|
+000000a0  22 17 03 03 02 6d 59 5b  1f 40 dc ab f2 3e f9 75  |"....mY[.@...>.u|
+000000b0  58 91 40 41 6c a5 b9 b9  b4 0c c0 e3 1b ac 68 c7  |X.@Al.........h.|
+000000c0  dd 65 3f 33 b3 2b c3 25  03 76 f7 d0 bb c8 22 0f  |.e?3.+.%.v....".|
+000000d0  62 54 ef 36 60 f1 5b b2  8a 23 25 73 ad 05 49 ea  |bT.6`.[..#%s..I.|
+000000e0  dc 41 65 1b 90 4e 8f e0  9f ca 99 1c 21 d7 4b ca  |.Ae..N......!.K.|
+000000f0  6e e2 cf 34 2a 35 0d 2a  94 0d a2 df 8d 88 d5 bf  |n..4*5.*........|
+00000100  b1 7c 01 16 75 33 d0 48  14 7d 79 1e a2 19 0b b5  |.|..u3.H.}y.....|
+00000110  7e 81 71 41 e0 75 31 ca  e8 b7 ce 11 97 80 fa 4e  |~.qA.u1........N|
+00000120  00 a8 40 29 72 59 76 17  e7 a7 f2 45 9e 0e ea 27  |..@)rYv....E...'|
+00000130  5d 91 41 69 0b 90 f5 c7  69 71 51 1f 1c 52 f6 25  |].Ai....iqQ..R.%|
+00000140  da c5 81 22 77 e4 12 a8  a3 3c fc fc bf 46 dc d9  |..."w....<...F..|
+00000150  a6 e6 4c 58 c4 e8 ec 5b  91 bf c9 a6 9d e2 36 dc  |..LX...[......6.|
+00000160  99 ba d9 03 67 6d e1 23  b2 b9 ba 67 ba 4e 04 19  |....gm.#...g.N..|
+00000170  7b 6a 18 72 34 02 62 ef  e8 7f 5f b0 a3 3e 89 2d  |{j.r4.b..._..>.-|
+00000180  57 be 73 81 6f 1a 25 ae  2c e1 9b ab c9 e3 ba 3f  |W.s.o.%.,......?|
+00000190  ea 0e 21 ce 33 03 8c c2  bf dc 7b 8e a2 3a 69 19  |..!.3.....{..:i.|
+000001a0  cc c3 0b e4 85 23 21 3f  82 9d b1 c8 b3 66 2c b6  |.....#!?.....f,.|
+000001b0  2e a8 10 6c 53 00 eb ee  ae cc 58 68 e9 36 a6 9a  |...lS.....Xh.6..|
+000001c0  2f fa 2e bf dd f0 84 a0  d5 3d a2 30 63 e5 0c 40  |/........=.0c..@|
+000001d0  22 d6 0b 88 cf 3b 5c e0  02 f9 24 1a 5a 37 f2 8d  |"....;\...$.Z7..|
+000001e0  83 05 d5 22 30 f8 c5 75  89 e2 a9 51 e1 1e 9a 2b  |..."0..u...Q...+|
+000001f0  a3 c9 77 ac 38 6a a9 a4  bf 3e b3 c0 71 25 59 f9  |..w.8j...>..q%Y.|
+00000200  5a 18 bd 74 c1 b0 fd ec  b5 ba 5e b1 29 c9 57 7e  |Z..t......^.).W~|
+00000210  d0 6f 4b ed 38 5c f3 57  88 2e 06 1c 51 2b 67 5d  |.oK.8\.W....Q+g]|
+00000220  8b c2 72 90 47 84 37 58  fa 1c 95 19 2c 26 ce f8  |..r.G.7X....,&..|
+00000230  fb 30 4f 99 f4 e0 5a 32  dd 2a 38 ed c2 b2 68 25  |.0O...Z2.*8...h%|
+00000240  50 15 56 a6 09 cb 3f 5c  a1 46 35 56 27 54 3b a2  |P.V...?\.F5V'T;.|
+00000250  2e 45 87 6c 71 3a b5 c9  0a c6 b8 3e 10 72 c8 03  |.E.lq:.....>.r..|
+00000260  99 6a f3 be cf 09 88 67  5b 47 57 3d a4 1c 08 d5  |.j.....g[GW=....|
+00000270  96 d7 ab e7 fd 05 b8 36  ad b3 c8 2a 7a aa 35 3c  |.......6...*z.5<|
+00000280  95 eb 96 6d 0e 78 41 89  29 c7 32 92 d1 be c0 bf  |...m.xA.).2.....|
+00000290  ac ca ee 17 3b 2e 1f fa  b7 67 d1 9f 31 fd db 45  |....;....g..1..E|
+000002a0  59 57 62 3f a7 2d 38 19  ca 46 96 b8 4e fa fd f3  |YWb?.-8..F..N...|
+000002b0  32 66 74 78 c9 a8 bf 90  bc 1d 77 4a 12 c9 64 04  |2ftx......wJ..d.|
+000002c0  f5 c8 c9 d0 6c 3a c5 a8  22 7c a7 3e cd d4 5b 6a  |....l:.."|.>..[j|
+000002d0  bd 5e d0 7c 07 67 61 3a  e7 56 0c 54 ca 94 db ae  |.^.|.ga:.V.T....|
+000002e0  40 28 ca 85 8b 88 29 1d  69 79 84 3b 19 36 7c 66  |@(....).iy.;.6|f|
+000002f0  13 9b a9 9a 02 af 30 72  18 84 64 0f 73 d4 43 9f  |......0r..d.s.C.|
+00000300  84 69 ce 21 52 a7 64 38  9f 70 ff 7a 23 99 9c 6c  |.i.!R.d8.p.z#..l|
+00000310  08 0d 61 17 03 03 00 99  4d 61 63 02 f0 a1 e8 b6  |..a.....Mac.....|
+00000320  d4 79 53 6f 4a e1 fe cb  f1 1b 3d b8 ba d4 6e a9  |.ySoJ.....=...n.|
+00000330  b0 cd 3b bd 21 41 b5 fd  df 53 cb b3 f3 15 f6 87  |..;.!A...S......|
+00000340  b6 09 67 fc 30 b4 ba d1  40 bf 4e ac 96 a5 52 0c  |..g.0...@.N...R.|
+00000350  c5 00 44 41 2a 3b f5 ae  0a ad 2f 4d 11 75 1f 86  |..DA*;..../M.u..|
+00000360  0e c5 ac 43 f5 67 c5 6a  e3 d9 ef c4 c6 54 27 ad  |...C.g.j.....T'.|
+00000370  0d a6 30 31 13 30 ce b2  92 2e e4 ec ee 51 ec 35  |..01.0.......Q.5|
+00000380  4b 93 16 d6 b2 f4 dc 54  92 a0 e6 75 dd 1c 44 1d  |K......T...u..D.|
+00000390  9a 32 fa f7 07 ab 9f bb  ab 09 dc a0 a8 5c 71 7c  |.2...........\q||
+000003a0  ee 21 07 8f 89 6d 50 0a  17 43 52 9a ac 07 b6 cb  |.!...mP..CR.....|
+000003b0  ff 17 03 03 00 35 0c e3  af 61 9d 5a 08 cf 88 27  |.....5...a.Z...'|
+000003c0  c7 9d d4 8b 3b d9 54 17  cb 56 0a 5f 8e e5 57 c4  |....;.T..V._..W.|
+000003d0  88 33 6f d3 55 63 14 bc  f1 a6 51 99 ac 34 08 6d  |.3o.Uc....Q..4.m|
+000003e0  a5 e2 9f c9 40 70 a9 6d  b9 3a 49 17 03 03 00 83  |....@p.m.:I.....|
+000003f0  62 c7 da 9b d3 dd 9a 46  de 6a b0 be a5 af a8 67  |b......F.j.....g|
+00000400  94 ce 07 bc 11 24 49 8b  b1 ed 63 ba b5 71 39 f2  |.....$I...c..q9.|
+00000410  f5 39 f3 1f 42 2c d1 e7  a1 e3 85 7b 9f d1 b8 d4  |.9..B,.....{....|
+00000420  b7 24 48 9e 27 4c c8 83  6b 47 4c 36 70 03 13 c1  |.$H.'L..kGL6p...|
+00000430  99 93 fe 4d 79 48 e0 bb  13 b3 9a 08 e8 f0 aa 4a  |...MyH.........J|
+00000440  7a de 96 16 12 a2 b3 16  05 d1 6c b0 7d dd 37 fc  |z.........l.}.7.|
+00000450  7a 8b 8e 8f ab 8e d8 34  48 e9 22 a8 ea d4 85 1e  |z......4H.".....|
+00000460  4d 99 9e ec c6 7c 7e 68  62 2b 05 b3 4e be cd 68  |M....|~hb+..N..h|
+00000470  ef 4e 84                                          |.N.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 27 f0 39 68 fc  |..........5'.9h.|
-00000010  9f 6c a4 fd a7 cf 1f 25  67 54 3c e6 9e 7c 99 5a  |.l.....%gT<..|.Z|
-00000020  e9 b7 3c 0c f2 dc b6 22  36 0d 43 a3 ee 76 4b a9  |..<...."6.C..vK.|
-00000030  6a cb b8 f6 8a c8 58 91  79 19 95 7c 83 a0 87 57  |j.....X.y..|...W|
+00000000  14 03 03 00 01 01 17 03  03 00 35 df 4c 5c f4 f4  |..........5.L\..|
+00000010  f2 54 58 09 21 7c fe 64  7e f7 ad b0 fc 57 47 49  |.TX.!|.d~....WGI|
+00000020  fa 37 5c 40 f0 50 67 41  5d 62 15 16 e8 28 c6 96  |.7\@.PgA]b...(..|
+00000030  f0 99 de b1 0b b6 97 b1  d4 c6 4b ce 05 a6 64 32  |..........K...d2|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e d5 8a ef  04 f9 6c 27 62 0a f1 a4  |..........l'b...|
-00000010  4b 7f e4 e4 ff 53 f3 61  20 b9 56 96 30 f9 06 c9  |K....S.a .V.0...|
-00000020  cc 9c ed 17 03 03 00 13  4a 83 cd 86 98 97 20 45  |........J..... E|
-00000030  ab 2f c5 72 15 f6 ed a8  8c 8c 0e                 |./.r.......|
+00000000  17 03 03 00 1e 9f 8d 81  11 4e 88 d8 78 bd a6 31  |.........N..x..1|
+00000010  4e 54 f8 86 a2 46 12 57  a9 da de 54 aa 71 b9 86  |NT...F.W...T.q..|
+00000020  a6 fe 5f 17 03 03 00 13  86 be 49 6c dc 76 8a 8e  |.._.......Il.v..|
+00000030  ba c3 95 3b 5d 64 d9 65  54 0a eb                 |...;]d.eT..|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndECDSAGiven b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndECDSAGiven
index 0b6eaf4381..6bca1da867 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndECDSAGiven
+++ b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndECDSAGiven
@@ -1,179 +1,180 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 54 78 64 8e b6  |...........Txd..|
-00000010  69 c6 1c 8a 69 eb 09 ef  32 59 f9 9f 63 ac 6e 66  |i...i...2Y..c.nf|
-00000020  97 b4 bb b7 71 27 60 52  af c4 64 20 26 de 8d 3e  |....q'`R..d &..>|
-00000030  90 5b c8 96 b5 10 a3 e4  67 f3 39 fb f5 b7 df 50  |.[......g.9....P|
-00000040  2b 8f 2d cb a5 c4 0a c9  28 1b c3 21 00 04 13 01  |+.-.....(..!....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 e8 9e 92 8b b4  |................|
+00000010  38 4e 93 cf b6 67 7a 60  05 ca 5c d1 2f 74 8b 09  |8N...gz`..\./t..|
+00000020  31 4f 89 f8 84 95 b1 fd  33 ba 47 20 b3 06 47 e7  |1O......3.G ..G.|
+00000030  98 7a 4c 52 77 29 9d d8  2d cf 76 da ff ab bd 74  |.zLRw)..-.v....t|
+00000040  67 53 76 7e 4d c1 c4 75  3a 00 cd 4b 00 04 13 01  |gSv~M..u:..K....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 65  |-.....3.&.$... e|
-000000b0  42 a2 bd 1e e0 0a 52 2d  7a 1e f0 37 86 db 9e c6  |B.....R-z..7....|
-000000c0  d6 cd ff 7b 71 f3 4c a3  23 44 2d 94 60 93 0b     |...{q.L.#D-.`..|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 a7  |-.....3.&.$... .|
+000000b0  d1 d7 63 d7 3f 48 dd ba  c7 d3 7e ce 41 79 b8 25  |..c.?H....~.Ay.%|
+000000c0  df b7 34 6f b4 49 c0 5f  54 15 d3 31 a1 19 70     |..4o.I._T..1..p|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 26 de 8d 3e  |........... &..>|
-00000030  90 5b c8 96 b5 10 a3 e4  67 f3 39 fb f5 b7 df 50  |.[......g.9....P|
-00000040  2b 8f 2d cb a5 c4 0a c9  28 1b c3 21 13 01 00 00  |+.-.....(..!....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 b3 06 47 e7  |........... ..G.|
+00000030  98 7a 4c 52 77 29 9d d8  2d cf 76 da ff ab bd 74  |.zLRw)..-.v....t|
+00000040  67 53 76 7e 4d c1 c4 75  3a 00 cd 4b 13 01 00 00  |gSv~M..u:..K....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 f1 7c 16 5a 86 b4  |...........|.Z..|
-00000090  13 82 93 fa ba 07 35 24  03 f5 24 25 cc 2d c8 e5  |......5$..$%.-..|
-000000a0  6c 17 03 03 00 3e cb 02  08 06 a3 75 03 c6 5d d9  |l....>.....u..].|
-000000b0  9c 66 ad db 29 6d 93 a6  53 c6 38 7f 9c 56 1e b1  |.f..)m..S.8..V..|
-000000c0  f5 a8 77 19 43 c3 93 5e  67 dc 80 db 1b c8 30 b2  |..w.C..^g.....0.|
-000000d0  04 85 6e 5c 8f 3a 4a f2  d2 aa 17 c7 d3 ea 29 f2  |..n\.:J.......).|
-000000e0  09 08 49 90 17 03 03 02  6d dd 26 0f f5 1b 6b 11  |..I.....m.&...k.|
-000000f0  1c c7 e9 87 bf de 58 08  e4 bc a6 49 98 fd bf 87  |......X....I....|
-00000100  31 35 59 c1 88 5a 8c 0d  e7 42 47 b6 cb ec 3c 6f  |15Y..Z...BG...<o|
-00000110  ba 01 4a bb 0c 7d d3 ae  0c 62 97 20 b5 f4 84 a0  |..J..}...b. ....|
-00000120  4c 30 87 8e 3c 11 24 b6  6f cc 8b de d4 ee 47 c0  |L0..<.$.o.....G.|
-00000130  47 92 00 0f 56 91 04 b3  42 93 1f 5c df 6e f6 f1  |G...V...B..\.n..|
-00000140  51 68 95 ad cd 4d 6e 7e  98 b9 57 da fb 01 45 45  |Qh...Mn~..W...EE|
-00000150  a7 d6 62 3d cb 48 f2 7c  18 03 52 50 51 c4 84 3e  |..b=.H.|..RPQ..>|
-00000160  16 e6 ff be 29 a3 60 13  f8 8c 82 6c 84 dd c1 c8  |....).`....l....|
-00000170  8b a2 bf e5 70 03 c3 a4  92 3d 99 a8 fc 92 15 e4  |....p....=......|
-00000180  1d 13 7d b5 1f d3 a6 76  1c 8c 9f 9f e7 87 b4 fb  |..}....v........|
-00000190  25 b8 cf 83 0a 3b bd c7  e8 30 d4 15 6f ae d5 b9  |%....;...0..o...|
-000001a0  da 3b c6 3f 0c 06 7a 78  e6 ac ca 64 cb 34 cc 7b  |.;.?..zx...d.4.{|
-000001b0  46 78 ec e2 22 9e 31 39  63 a7 7b 1d d6 c2 4b 91  |Fx..".19c.{...K.|
-000001c0  45 fa 95 54 ef 9b b3 2e  55 83 77 c8 cf 15 b5 34  |E..T....U.w....4|
-000001d0  11 4c 92 36 22 54 3d 2f  b0 cb 28 7f 2b 1e b1 3f  |.L.6"T=/..(.+..?|
-000001e0  38 4a 4a d6 e8 a1 e6 e0  4f 20 ab 04 6f 6b 00 5e  |8JJ.....O ..ok.^|
-000001f0  d4 16 42 ab a5 04 67 9b  89 45 78 8b ea 0e 7d c8  |..B...g..Ex...}.|
-00000200  24 d5 fb 83 c7 13 25 b7  1b 6f 3f 2a 2e cf bb 71  |$.....%..o?*...q|
-00000210  11 48 5d e6 98 5e ca dd  f7 6d dc 93 b1 51 1e 99  |.H]..^...m...Q..|
-00000220  b9 e0 4c 39 c8 82 d8 9f  8d 70 25 78 5b b1 85 1d  |..L9.....p%x[...|
-00000230  cb 75 31 61 c3 ad d5 c1  d5 1f 26 06 60 5f cd eb  |.u1a......&.`_..|
-00000240  ee 4c 99 43 02 b9 e5 f5  99 98 94 cf 14 1c ad 54  |.L.C...........T|
-00000250  20 a9 d3 73 f2 3f bc a1  25 39 8b ff c4 e0 ee 8b  | ..s.?..%9......|
-00000260  ba ec fc b0 c2 42 4c 5a  30 9c 26 1b f0 f2 da 94  |.....BLZ0.&.....|
-00000270  26 69 55 0e fb 84 a0 58  95 43 08 6c 87 82 93 02  |&iU....X.C.l....|
-00000280  cf 27 99 94 a3 ae 9f 08  d0 6e f2 a8 e8 29 fc a8  |.'.......n...)..|
-00000290  67 d3 20 37 83 5d 8a 12  0a 57 10 bf 30 5a e1 05  |g. 7.]...W..0Z..|
-000002a0  30 e0 b7 7b 47 7e a6 07  cc 9a dd 6d e8 11 89 c7  |0..{G~.....m....|
-000002b0  7d 98 c3 6d 83 9f 1b f4  ff ca 31 c8 39 7b c2 fb  |}..m......1.9{..|
-000002c0  69 dc ee eb ab e2 39 72  35 6b 22 e4 84 2f 1d 58  |i.....9r5k"../.X|
-000002d0  07 b0 9e 3e 69 ca ff 17  44 d6 e4 a8 56 6a 24 35  |...>i...D...Vj$5|
-000002e0  08 39 42 41 da 76 4b 4f  00 ce 41 58 4e 70 d5 b6  |.9BA.vKO..AXNp..|
-000002f0  50 b4 88 91 47 4a 89 04  ef e8 14 2e cf e3 9d 36  |P...GJ.........6|
-00000300  c0 b5 2b 8e 42 2f 4b 95  39 55 6f 5a 23 5b 5e 05  |..+.B/K.9UoZ#[^.|
-00000310  f0 34 70 c0 f7 92 54 e2  5c 52 20 b0 c1 2a 9a cb  |.4p...T.\R ..*..|
-00000320  3a 32 0e 93 77 96 f2 6a  d8 f7 bc 7c d8 40 4e 5e  |:2..w..j...|.@N^|
-00000330  37 1c 8b aa 75 89 94 51  da 19 72 80 86 c8 3d bd  |7...u..Q..r...=.|
-00000340  fd 7d 06 13 bb 54 a1 0b  46 58 07 e5 35 b3 f3 ff  |.}...T..FX..5...|
-00000350  8a 98 9d e6 e8 05 17 03  03 00 99 5a 63 3c ff cc  |...........Zc<..|
-00000360  a0 ec 5f 52 4d 28 96 80  22 f7 8c a7 ad b7 1f 4a  |.._RM(.."......J|
-00000370  8c 46 79 06 31 96 46 f9  f0 57 8c c4 5b f9 71 61  |.Fy.1.F..W..[.qa|
-00000380  34 0d 3e 78 67 05 1c 93  a7 a2 cd ea ce e5 a2 6e  |4.>xg..........n|
-00000390  37 4f 16 a4 e4 4c 60 d5  5a 37 f1 2a bf ce 2f 80  |7O...L`.Z7.*../.|
-000003a0  ea 65 e6 25 03 fc 2b 17  3f a4 71 3f 04 46 2b f7  |.e.%..+.?.q?.F+.|
-000003b0  12 b0 a6 f3 fc 8d cf 5e  95 85 84 88 e4 db 46 a4  |.......^......F.|
-000003c0  f2 3a a5 27 44 3d a2 03  b3 65 af 1f e3 44 aa 02  |.:.'D=...e...D..|
-000003d0  0f 39 eb 3d 0e 2a ae 0c  1b ed 84 df 8d e3 a2 1d  |.9.=.*..........|
-000003e0  6d 55 bf d6 13 f6 00 da  93 a7 fc b1 50 79 2c a9  |mU..........Py,.|
-000003f0  93 cb 7d 70 17 03 03 00  35 9e b7 c2 c6 29 a9 43  |..}p....5....).C|
-00000400  3f df 06 80 31 ac d9 f7  3b cd 14 16 a0 85 ca e6  |?...1...;.......|
-00000410  34 70 e3 fc af 1c 94 9b  87 b3 17 6c a4 83 64 2c  |4p.........l..d,|
-00000420  6e 26 4c e9 ab 79 a9 c8  1d d4 1c 96 2c f2        |n&L..y......,.|
+00000080  03 03 00 01 01 17 03 03  00 17 a8 4b 20 a0 50 5f  |...........K .P_|
+00000090  50 bf b3 2a 52 27 a7 cc  23 9d 7d cd ee de 94 8a  |P..*R'..#.}.....|
+000000a0  58 17 03 03 00 3e 4e d3  73 ee c0 fe 30 d9 ad 28  |X....>N.s...0..(|
+000000b0  f1 a3 50 94 89 6a 20 9e  c9 39 07 73 32 94 88 d7  |..P..j ..9.s2...|
+000000c0  92 c9 03 45 63 42 48 6d  3a 6b 64 d1 99 ab 07 f0  |...EcBHm:kd.....|
+000000d0  6c ad 6a 5f 40 61 d1 0c  c0 50 1b 5d 43 f3 9d c6  |l.j_@a...P.]C...|
+000000e0  4c a2 5c e1 17 03 03 02  6d 1b b6 30 2c 62 0b 40  |L.\.....m..0,b.@|
+000000f0  99 63 57 ab 7f b2 7d d4  74 df ce 98 b7 dc 62 8b  |.cW...}.t.....b.|
+00000100  5e c9 c1 08 12 00 53 cc  99 9b 9f 7a 07 ab 6e 8e  |^.....S....z..n.|
+00000110  f7 21 89 0b eb bc 69 ff  e9 fc a6 d0 d2 34 9f 9a  |.!....i......4..|
+00000120  ba 77 be 95 55 be 50 54  bc b3 72 54 51 e3 02 86  |.w..U.PT..rTQ...|
+00000130  bb f2 bd 61 b8 f1 9d ee  d3 9f 92 89 f4 38 9d a3  |...a.........8..|
+00000140  44 99 a5 d5 45 32 01 f6  cc aa 86 40 9e c1 72 f9  |D...E2.....@..r.|
+00000150  18 58 2a 22 8f e0 b9 ce  0c 65 90 08 81 ef 66 b5  |.X*".....e....f.|
+00000160  ab dd b4 1c 4f a7 7e 77  36 45 fd cc ee 9e 92 d6  |....O.~w6E......|
+00000170  a2 c9 cf 39 fc c9 1e 7b  be f2 b3 66 c9 16 4d 3e  |...9...{...f..M>|
+00000180  bf 8d ab 11 c1 4d 69 29  cf 33 b3 3f 65 5b 1d 2b  |.....Mi).3.?e[.+|
+00000190  7a f8 e9 9a 6d 86 eb 3c  0f 8d fa 12 c7 02 7a d7  |z...m..<......z.|
+000001a0  ac a2 68 6b 14 80 c7 28  c4 96 c2 e6 10 00 08 d8  |..hk...(........|
+000001b0  a8 0a d6 69 a6 61 b4 46  fd 55 ea 95 cf f0 56 23  |...i.a.F.U....V#|
+000001c0  c9 07 2c 2b 0a 85 9b aa  d3 3c 74 6d 2f 43 ca e1  |..,+.....<tm/C..|
+000001d0  92 b9 4a b0 6d fd 98 f4  b4 a7 51 da 21 5c c6 c4  |..J.m.....Q.!\..|
+000001e0  8e 18 19 71 4e 1e 5f 4a  56 bf a0 87 a3 02 f5 0f  |...qN._JV.......|
+000001f0  1c 62 e5 69 df 87 44 05  18 59 45 87 76 12 ad fd  |.b.i..D..YE.v...|
+00000200  ca 0f 98 f2 53 6d 9c 66  49 a3 82 12 0f a1 f6 d8  |....Sm.fI.......|
+00000210  e3 d5 52 17 57 ae 9f f2  bb fc 67 b4 60 07 ca ec  |..R.W.....g.`...|
+00000220  39 e2 12 06 9a cc 28 fa  03 b3 1b 21 65 8f ea 7f  |9.....(....!e...|
+00000230  d1 bd 1d 66 de ad 44 1f  e2 ae a0 1c fd 38 d9 d7  |...f..D......8..|
+00000240  93 16 0f 33 0d 85 7a 20  9e e8 e0 ee 8d 9e 09 98  |...3..z ........|
+00000250  b6 e3 2c 86 f1 6e fa 9b  c9 97 35 04 c1 eb a9 7f  |..,..n....5.....|
+00000260  8e 02 c7 d2 b0 74 f6 87  8d 28 47 ba 19 1c b6 df  |.....t...(G.....|
+00000270  1e d4 6c 6d f5 5a c1 0b  d6 8b 3e be 00 08 7d 4a  |..lm.Z....>...}J|
+00000280  21 61 67 82 39 3f f0 62  d1 82 fe ae ab 8e a6 02  |!ag.9?.b........|
+00000290  8c 1f 26 de ce 3e a1 a5  43 1f 7b a2 58 a9 1f b6  |..&..>..C.{.X...|
+000002a0  5f 37 16 af 82 36 18 e0  be b4 42 40 af ac b4 c5  |_7...6....B@....|
+000002b0  87 eb fd 17 70 7b 45 cb  fe f6 a1 23 4a 5f 76 73  |....p{E....#J_vs|
+000002c0  9c 13 0f 5a 24 d7 6e 43  34 5a ba 06 d4 68 cf ce  |...Z$.nC4Z...h..|
+000002d0  32 4e 7d d0 29 c4 33 c6  ae 0e 38 d1 07 5c 22 b7  |2N}.).3...8..\".|
+000002e0  a8 84 48 ed 88 99 f2 f0  87 35 28 5a aa 27 d8 00  |..H......5(Z.'..|
+000002f0  3a 1a bc ae 63 b7 59 8a  30 ef bb 16 13 47 d2 a0  |:...c.Y.0....G..|
+00000300  c3 09 c8 6d fc aa 1e f0  d4 e2 dc 65 8d ca f0 5e  |...m.......e...^|
+00000310  e5 32 02 c3 58 89 94 80  b3 be b6 0c 23 73 5a 29  |.2..X.......#sZ)|
+00000320  63 9c 89 93 0c e9 e9 b0  f1 f8 61 1c 25 d5 12 60  |c.........a.%..`|
+00000330  aa b4 79 df 94 8a 83 3d  1c 58 6a 2b 86 5d d3 b0  |..y....=.Xj+.]..|
+00000340  01 11 11 85 0e 86 ae 9f  e1 26 60 d7 cb 91 57 76  |.........&`...Wv|
+00000350  53 36 38 ed 06 4f 17 03  03 00 99 bf e9 10 6e a2  |S68..O........n.|
+00000360  82 8d d4 b9 65 16 d5 c0  d5 dc e7 71 3e b6 9e e7  |....e......q>...|
+00000370  ab eb 8a c8 8f 3d 95 d8  af ab 85 6d a9 8a 17 32  |.....=.....m...2|
+00000380  f9 14 5a d3 df 83 4a 14  50 fd b3 47 b6 e3 5f 8f  |..Z...J.P..G.._.|
+00000390  33 ee b8 17 a9 18 94 81  c7 85 da bb b6 3e 13 8b  |3............>..|
+000003a0  8e 95 b9 19 f7 8f df c9  c6 88 5d db ff be 58 7d  |..........]...X}|
+000003b0  5b 15 b3 16 42 b1 73 c4  d8 4f b4 d2 af f1 e3 a4  |[...B.s..O......|
+000003c0  bf 8f 4c 3f 15 97 15 2a  2b 15 3a b3 26 72 73 63  |..L?...*+.:.&rsc|
+000003d0  d8 10 0c 79 27 98 da c5  04 c5 54 15 dc 73 38 63  |...y'.....T..s8c|
+000003e0  72 68 0f 20 30 e2 7d 6c  54 f9 9c 74 76 c5 ae c7  |rh. 0.}lT..tv...|
+000003f0  13 d8 4d c0 17 03 03 00  35 a6 af 56 74 b6 80 80  |..M.....5..Vt...|
+00000400  b1 65 68 43 43 23 5a 07  ff ea 91 14 b9 c4 9c 5f  |.ehCC#Z........_|
+00000410  a3 e0 4a b2 1f 60 d7 87  57 fb 5f 77 6f 3c 40 65  |..J..`..W._wo<@e|
+00000420  ba 4b e6 e3 64 8b a2 30  b5 0b c1 ba 77 f2        |.K..d..0....w.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 02 1e 08 6d ee 1c 88  |............m...|
-00000010  63 86 93 3e 73 8e 87 6f  51 8b d3 d2 91 c5 cb 55  |c..>s..oQ......U|
-00000020  2d 7c 9f 32 d8 0a ab e5  53 95 4b 0c 22 12 23 56  |-|.2....S.K.".#V|
-00000030  07 ce 1b e1 46 f7 46 84  cb 47 83 62 4a 16 39 44  |....F.F..G.bJ.9D|
-00000040  bf 58 25 6e f1 22 d0 ea  06 d8 da 44 91 bb 27 41  |.X%n.".....D..'A|
-00000050  1f 6e 46 89 88 93 a7 0a  60 8f 1a e5 31 19 5c 27  |.nF.....`...1.\'|
-00000060  a3 f6 8c 1b ee 5b 2b 21  c4 64 c7 d9 92 7b e9 ca  |.....[+!.d...{..|
-00000070  e0 16 29 d0 64 32 95 a8  8f a8 24 cc 56 c6 3e 7d  |..).d2....$.V.>}|
-00000080  1b f6 06 a6 fa d6 dc 79  38 60 4f 6f b7 e1 10 ab  |.......y8`Oo....|
-00000090  21 14 8e e1 90 95 6d b6  f3 ca 86 1a dd 32 c5 33  |!.....m......2.3|
-000000a0  e1 fc 8c da 77 02 54 88  73 f3 72 71 c6 58 ad 1a  |....w.T.s.rq.X..|
-000000b0  10 b8 15 c3 69 f1 cc 71  b6 ea 7e b7 81 4b de 7b  |....i..q..~..K.{|
-000000c0  77 87 24 e0 c0 39 5c 5b  17 ad 7c 59 53 43 cf 7e  |w.$..9\[..|YSC.~|
-000000d0  cb 70 4d 51 f1 7e 8c 2b  19 61 13 75 bf 25 df 80  |.pMQ.~.+.a.u.%..|
-000000e0  f2 fa cd 70 8d db eb bc  38 ae 6a 0c ad ef d2 e2  |...p....8.j.....|
-000000f0  f0 f1 02 97 ce 37 8b 8f  9e bd 4f 92 40 e7 8f 9f  |.....7....O.@...|
-00000100  26 b7 cd ef cf 57 28 2f  12 cc 69 e1 be f2 59 c6  |&....W(/..i...Y.|
-00000110  be dc 51 9a 67 be 4a f1  97 f9 7a d9 01 05 1f d0  |..Q.g.J...z.....|
-00000120  2b 96 5b b5 4d 1d c1 2e  99 7e eb e3 20 92 b0 f8  |+.[.M....~.. ...|
-00000130  ac 9f c1 e3 10 cd b1 e9  05 46 15 3c c2 fb ce 27  |.........F.<...'|
-00000140  5e f1 47 e7 d8 ca 89 0e  77 37 86 6c c9 d4 e3 ae  |^.G.....w7.l....|
-00000150  1e 6e 63 4f 5c 2d aa a0  88 7c 35 47 87 e8 40 22  |.ncO\-...|5G..@"|
-00000160  f8 45 2f 57 b4 e8 e1 95  45 58 02 53 3c 19 b5 92  |.E/W....EX.S<...|
-00000170  73 55 fd 49 31 ec db dc  4c 6f 6f a7 9a 90 89 83  |sU.I1...Loo.....|
-00000180  08 97 53 5a c6 6c 23 75  cd 68 37 54 2c 00 d3 56  |..SZ.l#u.h7T,..V|
-00000190  5e 24 87 7b 92 a9 61 73  1e 84 31 0e ff d7 f2 fb  |^$.{..as..1.....|
-000001a0  62 5e f9 27 35 18 bb ca  b2 c2 d7 5c bf 7f 6d 36  |b^.'5......\..m6|
-000001b0  fa e6 02 4a d0 fa bd b8  c0 d0 2f 0c 27 6b 49 92  |...J....../.'kI.|
-000001c0  20 54 01 ea 3c d2 07 f1  2e d6 e3 a3 a3 bd 1d 33  | T..<..........3|
-000001d0  90 ee 26 ad a6 5c ee c7  de 4d e8 fc d2 b5 5a b5  |..&..\...M....Z.|
-000001e0  7c 6f c5 61 23 11 20 eb  0f 7c b7 0a cc 8c 65 b7  ||o.a#. ..|....e.|
-000001f0  e2 87 16 10 b0 fd 40 75  78 d1 3c 70 54 66 b8 cb  |......@ux.<pTf..|
-00000200  a5 84 c6 ee af 57 3c 73  64 2d ba 5d b9 a3 93 84  |.....W<sd-.]....|
-00000210  d1 2e d4 87 15 4f 9b 1c  e5 da 02 b0 c5 2e 9f 31  |.....O.........1|
-00000220  d4 3f 6e e8 b7 02 d3 f3  71 17 03 03 00 a4 14 81  |.?n.....q.......|
-00000230  dd 8d 55 4d 0a 18 cb 08  0a b0 1e e3 7d d6 54 8e  |..UM........}.T.|
-00000240  e3 e6 5d 2a c8 59 6c 5e  19 a7 db 0f 96 b2 55 db  |..]*.Yl^......U.|
-00000250  71 f8 6f bb a4 b8 d3 c7  a2 ee 01 c0 1a 15 00 20  |q.o............ |
-00000260  1a 88 07 b5 69 83 4d 8b  45 65 da 6d e5 df c2 82  |....i.M.Ee.m....|
-00000270  a3 b5 92 75 7b 76 86 f8  f8 13 63 c9 37 2f 06 ce  |...u{v....c.7/..|
-00000280  7c 64 da 08 1f 4e a3 4f  a4 5a 4a 36 a3 b8 99 6f  ||d...N.O.ZJ6...o|
-00000290  fa b2 8a f6 41 91 ea 5e  6c bd c9 40 65 a1 10 08  |....A..^l..@e...|
-000002a0  c2 a5 2e 13 d9 ce 59 d8  fb d1 48 77 94 5a 2d d0  |......Y...Hw.Z-.|
-000002b0  23 ba 02 4a 55 b5 be da  ca c1 61 f5 15 d0 7a ba  |#..JU.....a...z.|
-000002c0  a4 cf e7 1f 1d 99 32 cf  41 19 87 eb 79 97 0e fa  |......2.A...y...|
-000002d0  6e ae 17 03 03 00 35 7c  26 f7 77 3f 3c 10 90 47  |n.....5|&.w?<..G|
-000002e0  54 bd e7 c6 b7 9e 14 a9  ca 3a 12 c8 42 9a e1 38  |T........:..B..8|
-000002f0  e4 60 ed a9 4a d8 d3 6d  15 ab b2 f2 16 81 09 b1  |.`..J..m........|
-00000300  fd b5 56 67 8d e0 b1 e9  4b b9 ad 7a              |..Vg....K..z|
+00000000  14 03 03 00 01 01 17 03  03 02 1e 2e 4a 62 c3 9e  |............Jb..|
+00000010  66 7b 32 01 41 d8 c1 76  a4 2b 1d 89 77 e7 f4 b7  |f{2.A..v.+..w...|
+00000020  e9 f4 34 91 f2 a0 ee 1d  97 17 13 9e 28 1c 98 e3  |..4.........(...|
+00000030  6d a4 5d 94 44 4f 68 36  02 26 d0 87 05 84 72 6b  |m.].DOh6.&....rk|
+00000040  af 84 6f e3 27 bf eb e0  d1 5e 9f c2 c9 87 05 10  |..o.'....^......|
+00000050  1a 3b 23 ec 2c c0 90 2e  56 59 70 2e 8a 28 05 61  |.;#.,...VYp..(.a|
+00000060  26 09 ec 78 b7 6a 6b 13  4d 4b ac 0b 25 77 98 e4  |&..x.jk.MK..%w..|
+00000070  72 7d 58 64 4f bb 0e be  6b 98 97 af 93 4c dc 2d  |r}XdO...k....L.-|
+00000080  10 c8 88 f4 ec 28 01 e0  79 8b ac bf 6a f7 6a ca  |.....(..y...j.j.|
+00000090  85 41 a5 07 2f 82 f5 33  58 e3 55 e9 6b 5a bb 54  |.A../..3X.U.kZ.T|
+000000a0  e4 f5 ed 6f 2d 0e 86 55  d5 85 c3 18 ea cf 9a f6  |...o-..U........|
+000000b0  b1 76 83 c5 1f 03 15 9a  ac 66 85 6c 83 0f 93 cc  |.v.......f.l....|
+000000c0  0e 5e d6 a4 92 2b 99 18  54 ff 3d 69 41 af 73 70  |.^...+..T.=iA.sp|
+000000d0  21 ab b0 3d 43 e5 a9 18  e3 1a e6 95 48 c0 27 d8  |!..=C.......H.'.|
+000000e0  87 1c 40 59 f2 b9 e6 17  af 98 31 1f 85 f5 ef 26  |..@Y......1....&|
+000000f0  ef 8f c9 c6 fd a2 cb 15  3a 83 0f 8f 0f 36 f2 a3  |........:....6..|
+00000100  1b 60 eb cf cd 8f 3b 13  2c 67 13 66 99 5c 3a 70  |.`....;.,g.f.\:p|
+00000110  7e 2c c3 c8 66 57 13 10  dd 58 3d 1e ae 71 a4 93  |~,..fW...X=..q..|
+00000120  74 f0 e1 02 f7 0b b4 0c  f5 2a 8a cb 81 98 d1 8e  |t........*......|
+00000130  fc fb a5 80 1c 1b 69 05  2f fa a3 81 58 9f d0 ed  |......i./...X...|
+00000140  3d 6a bc 1d 1f b6 6a 93  26 30 c2 41 d2 c9 75 e9  |=j....j.&0.A..u.|
+00000150  83 b0 75 a1 56 50 8e f1  ba d0 7b c9 69 a1 2c 03  |..u.VP....{.i.,.|
+00000160  3d 95 05 c6 6c 42 7d c3  17 e5 82 fb b3 03 8a 51  |=...lB}........Q|
+00000170  c9 31 58 02 42 b8 44 63  08 b8 b4 35 21 03 f9 00  |.1X.B.Dc...5!...|
+00000180  80 ea 19 32 d9 13 18 5f  a6 ef b6 21 1c 97 15 76  |...2..._...!...v|
+00000190  83 5b f1 c0 5d c6 9a 7c  21 a2 8a eb f1 0b b7 01  |.[..]..|!.......|
+000001a0  48 6e 53 fd 54 d2 da 38  dc f0 b0 ca d9 cd d0 16  |HnS.T..8........|
+000001b0  ae c0 ef ba a6 11 35 15  fb 1f 96 1c db 01 9b e4  |......5.........|
+000001c0  42 c5 41 6d e1 a4 31 79  f7 77 57 e6 5c 15 42 c6  |B.Am..1y.wW.\.B.|
+000001d0  f5 0a e3 1b e6 fa ed eb  d1 f1 f0 05 3c 93 cf c2  |............<...|
+000001e0  bf f0 c2 8f ec 0a 30 a5  a9 b8 a8 b7 7d 6c c3 bb  |......0.....}l..|
+000001f0  d9 49 5a 81 3c a3 64 a2  d1 a4 ad 29 b4 5f a6 53  |.IZ.<.d....)._.S|
+00000200  ab 7d fe c0 00 dc 56 60  08 bc b5 d8 55 d1 17 fc  |.}....V`....U...|
+00000210  bb 97 77 a4 89 7b 3e 6a  28 18 7c 65 06 bc f4 56  |..w..{>j(.|e...V|
+00000220  49 3b 25 48 a9 9b 85 83  53 17 03 03 00 a3 2c 66  |I;%H....S.....,f|
+00000230  0d 3f 94 da e1 6d 5e 56  d6 8f 9a bd 7d a3 ac 9d  |.?...m^V....}...|
+00000240  ae e7 ab 29 12 b0 2f cb  77 a9 48 75 57 67 93 17  |...)../.w.HuWg..|
+00000250  2f 87 21 7b e2 c2 e5 b6  82 ca c9 fb e6 6a 2e 78  |/.!{.........j.x|
+00000260  ca 80 a1 6f f2 a6 1b 2e  5e 7d 4b 90 7e df f8 db  |...o....^}K.~...|
+00000270  83 4c 4b c6 e1 fe eb e7  7f e4 80 73 cc 0d 71 53  |.LK........s..qS|
+00000280  46 dc b0 ac b4 61 41 88  25 3e 35 7e d0 db 92 2a  |F....aA.%>5~...*|
+00000290  ff 44 e4 69 25 79 d7 a3  a7 90 01 a0 da f3 5f 26  |.D.i%y........_&|
+000002a0  92 8b 8b c4 96 40 fa 31  20 cb 4c df ee d4 4e ed  |.....@.1 .L...N.|
+000002b0  b4 8e eb 96 ba e3 62 6e  67 70 7e 46 07 3c b2 86  |......bngp~F.<..|
+000002c0  90 35 e0 f0 10 3c c8 20  36 f2 ef 3c e5 03 e9 cc  |.5...<. 6..<....|
+000002d0  d3 17 03 03 00 35 a1 c7  67 86 1f 6f d9 10 dd c1  |.....5..g..o....|
+000002e0  5c 76 ad 77 93 3b 64 fc  0c 75 8a 5a 17 ab 60 17  |\v.w.;d..u.Z..`.|
+000002f0  93 af 6a 64 21 d1 46 30  10 8c af 6f eb af 72 7d  |..jd!.F0...o..r}|
+00000300  f0 68 6d c6 b6 7d a3 84  ae 2c b9 17 03 03 00 13  |.hm..}...,......|
+00000310  f1 c6 e8 b6 e5 3b a2 40  5c 6f 0c 25 e2 4a a0 a7  |.....;.@\o.%.J..|
+00000320  35 e8 b6                                          |5..|
 >>> Flow 4 (server to client)
-00000000  17 03 03 02 98 07 3b b6  4e c1 7e 84 44 a0 5d 3c  |......;.N.~.D.]<|
-00000010  b8 45 37 1e bf 0f 43 cf  d6 11 c7 0d d9 a4 25 7b  |.E7...C.......%{|
-00000020  27 fa 6e e1 9c 24 5f e5  f9 12 e8 a1 33 2e cc 24  |'.n..$_.....3..$|
-00000030  43 3b ac e3 bd f2 7b 1d  66 70 eb 31 21 7f 3e 5e  |C;....{.fp.1!.>^|
-00000040  09 7a 29 8f 43 43 cb c4  6d 70 a7 51 1c 0f dc 21  |.z).CC..mp.Q...!|
-00000050  e9 4c f5 16 8f 35 e8 5b  ae 7f e0 47 e7 d4 53 66  |.L...5.[...G..Sf|
-00000060  b2 cc ef 44 b7 3e 34 2b  32 a9 e6 89 b9 c6 f6 56  |...D.>4+2......V|
-00000070  97 b3 78 37 3c 89 2f 35  8e a5 c7 ae c4 92 91 69  |..x7<./5.......i|
-00000080  50 ae ee c9 7b 7a 3a 10  ce 1c 68 fd 09 57 3d 92  |P...{z:...h..W=.|
-00000090  52 42 0e 4e 91 12 b4 fd  e4 59 d4 1e 5a c7 25 b3  |RB.N.....Y..Z.%.|
-000000a0  dd a1 dd 7d 7d 92 08 52  ec 85 15 c7 b6 60 70 fb  |...}}..R.....`p.|
-000000b0  76 6b 42 da 84 8e e5 a9  cb a4 b1 76 89 51 93 55  |vkB........v.Q.U|
-000000c0  f3 92 aa cc 04 3b 78 97  ed 10 88 d8 77 d1 32 35  |.....;x.....w.25|
-000000d0  93 82 a4 1d ca 47 df c8  72 93 10 90 e0 75 2d 3f  |.....G..r....u-?|
-000000e0  b0 6a 3d 9e b6 20 1d 0a  2a 03 66 be 18 18 d3 25  |.j=.. ..*.f....%|
-000000f0  47 a2 ab 67 08 44 24 cb  94 29 8a f7 8b 8e ca a0  |G..g.D$..)......|
-00000100  20 71 d0 af 87 5b e1 d9  5d e0 0c 70 13 3d 82 42  | q...[..]..p.=.B|
-00000110  b3 b8 fb 5e 1d f1 58 88  ea 11 67 28 49 11 d4 27  |...^..X...g(I..'|
-00000120  05 87 e4 b1 21 15 d1 3a  6a df ee 6d 40 7c 3f 8c  |....!..:j..m@|?.|
-00000130  7e cd 7b 0c 0e ef fd 17  29 29 f8 03 98 8e 76 ac  |~.{.....))....v.|
-00000140  23 e2 81 30 8b c7 7b 9b  5a 78 f7 6a 53 32 5c bd  |#..0..{.Zx.jS2\.|
-00000150  d7 42 cb 77 f5 1d ea 03  74 9f ec 1d 1b 68 72 aa  |.B.w....t....hr.|
-00000160  9f e0 7d 58 2f 26 47 6b  2d e4 1f 78 f4 ab d3 ae  |..}X/&Gk-..x....|
-00000170  51 6c 2a 35 0a 6f 9a c8  2b 75 ff 69 3e 4b 61 bc  |Ql*5.o..+u.i>Ka.|
-00000180  03 29 60 04 8b 53 9f ae  e4 00 7f 88 7a d4 70 b8  |.)`..S......z.p.|
-00000190  65 83 87 96 5d ef f1 b2  e8 7e 0e af 0b 2c 07 dd  |e...]....~...,..|
-000001a0  a9 0e f8 c3 9b 59 aa cf  74 02 5e 46 8c cb 3d ee  |.....Y..t.^F..=.|
-000001b0  72 67 7c 46 37 29 78 d8  80 6e 42 16 b7 a8 59 35  |rg|F7)x..nB...Y5|
-000001c0  cb 36 ce 73 50 80 d2 35  7a 69 b9 f3 14 73 04 e7  |.6.sP..5zi...s..|
-000001d0  ec dd 92 80 b0 f6 b7 51  28 15 56 c4 bb 83 00 86  |.......Q(.V.....|
-000001e0  9e 21 e7 bd 91 33 15 d4  aa da 8a 07 eb 2e d9 48  |.!...3.........H|
-000001f0  c3 71 1a da be 6f 00 45  bd 08 a3 70 17 d5 c0 1a  |.q...o.E...p....|
-00000200  74 87 5a 95 60 aa 1d ce  0e e1 46 57 85 8c e0 ae  |t.Z.`.....FW....|
-00000210  98 1a f9 83 7f ec 04 bd  90 dc 51 4f 7e d2 52 28  |..........QO~.R(|
-00000220  ca 33 f6 60 4a 0c e4 7d  b3 93 4f 70 7a ce d3 3e  |.3.`J..}..Opz..>|
-00000230  0a dd 50 b0 17 0a 2e db  2c ad 3d 86 d3 e6 60 07  |..P.....,.=...`.|
-00000240  43 61 9c a0 ff 45 37 9a  60 3d c5 f7 4d 27 fc b4  |Ca...E7.`=..M'..|
-00000250  9a 05 1c 0a ae 08 9d d9  5c 15 09 c9 8e 24 bb e2  |........\....$..|
-00000260  ec a1 a7 27 f0 42 97 a9  af ed 25 fd 5f f1 2a 4d  |...'.B....%._.*M|
-00000270  ac ab 9c a5 7d 28 6b c8  36 ec 0c 12 5b eb fa 64  |....}(k.6...[..d|
-00000280  83 74 13 6e 44 5a 23 38  f0 a6 22 3e f9 88 f1 0d  |.t.nDZ#8..">....|
-00000290  2a 55 b8 bf aa 87 de a4  7f 8b ba 52 23 17 03 03  |*U.........R#...|
-000002a0  00 1e fb 80 15 2b ff db  63 29 a7 77 ef 1e 82 28  |.....+..c).w...(|
-000002b0  8d d5 f0 5b 5d 42 8e 34  f9 64 5c 47 eb c3 10 4c  |...[]B.4.d\G...L|
-000002c0  17 03 03 00 13 a1 8b 9e  d8 57 0e 04 96 7c b4 83  |.........W...|..|
-000002d0  70 a2 20 03 ee 28 23 c7                           |p. ..(#.|
+00000000  17 03 03 02 88 aa 3b 61  4a 18 65 f0 33 21 42 57  |......;aJ.e.3!BW|
+00000010  b9 c4 33 75 40 89 73 60  f8 aa e8 ae cf 88 a4 ce  |..3u@.s`........|
+00000020  32 80 d7 22 c9 a6 f7 5a  76 c2 79 96 bc df b8 cb  |2.."...Zv.y.....|
+00000030  f6 34 c3 c7 ca fb 7f ed  4d 9b af fe 00 b1 ae 7f  |.4......M.......|
+00000040  0a 85 28 27 f1 a3 bc 8f  99 7a 15 d1 f6 f3 48 ac  |..('.....z....H.|
+00000050  1f 2d cc 4e 51 15 06 d7  f1 13 22 f0 d0 21 cd e7  |.-.NQ....."..!..|
+00000060  c9 ec 66 3d 99 b2 db e0  96 bf f8 35 01 b9 d0 ff  |..f=.......5....|
+00000070  22 1d 68 cc 30 5d b3 8e  93 02 5f 3f a7 8c 21 95  |".h.0]...._?..!.|
+00000080  23 16 8f d2 16 53 72 db  8c df fd e6 a4 5d b6 f6  |#....Sr......]..|
+00000090  c4 a6 50 a6 a8 76 3c f2  65 61 3e c9 dc 28 e4 65  |..P..v<.ea>..(.e|
+000000a0  9e 49 7f fa 90 85 0a 4a  e4 89 fd 7c f0 9e 76 5f  |.I.....J...|..v_|
+000000b0  57 00 d0 16 82 b3 9e a4  ac 65 88 3d 21 2e 69 1b  |W........e.=!.i.|
+000000c0  28 f6 c1 c3 59 40 2d 1e  e4 d8 5f 23 66 8b 9b db  |(...Y@-..._#f...|
+000000d0  b9 e6 d8 e5 2a 55 23 89  c9 b7 ef 08 5d 84 04 38  |....*U#.....]..8|
+000000e0  87 90 15 1c 32 b6 36 f8  b8 15 49 f0 36 4c 46 8a  |....2.6...I.6LF.|
+000000f0  d6 9d 0d 4c 4a da cb 1c  cd 99 24 e5 51 da 38 96  |...LJ.....$.Q.8.|
+00000100  f5 ac 2f 0a 94 b2 47 91  aa da c3 71 7c 6b 09 98  |../...G....q|k..|
+00000110  e9 ae f6 22 3a a0 2f 14  e0 70 4b da 8e 6e 07 fb  |...":./..pK..n..|
+00000120  49 ce 05 b0 95 16 b2 15  a9 65 94 28 14 89 c0 ae  |I........e.(....|
+00000130  95 57 1b ec f3 f8 26 dd  1e d8 d6 b8 2d 03 08 77  |.W....&.....-..w|
+00000140  fb 62 cd 83 6a 4f 21 d8  12 4c 06 47 3f 73 52 ed  |.b..jO!..L.G?sR.|
+00000150  a5 83 24 39 f9 15 ad ab  35 a4 9c 0b 4e 57 bc 27  |..$9....5...NW.'|
+00000160  86 74 5d f3 bb 9a 6b a7  f3 21 a2 05 af 15 1b db  |.t]...k..!......|
+00000170  f4 40 28 00 64 4c 18 6f  6f 79 06 f7 c2 1e 9d cf  |.@(.dL.ooy......|
+00000180  9f 3b 80 f3 65 e1 7e b7  90 af 92 94 7c b3 94 65  |.;..e.~.....|..e|
+00000190  0b 7f b9 26 47 4a 9b 65  08 0b 54 1d 81 aa 31 f0  |...&GJ.e..T...1.|
+000001a0  26 a4 2c 47 c1 03 69 40  26 03 d6 39 0a fb 83 e0  |&.,G..i@&..9....|
+000001b0  0e 89 3b f4 39 fd b5 28  b6 6a 27 22 94 34 5f f0  |..;.9..(.j'".4_.|
+000001c0  84 44 dc 08 b2 7a 49 a0  e8 41 93 d3 48 5b 15 48  |.D...zI..A..H[.H|
+000001d0  c9 15 8a 2c e3 3c 02 5d  97 ee a3 fe 26 e9 40 b7  |...,.<.]....&.@.|
+000001e0  6c f7 cc 5b 26 6b b9 52  b7 d1 65 68 c3 76 cd 9a  |l..[&k.R..eh.v..|
+000001f0  7c 86 ce c7 06 e0 e3 57  33 44 8a 75 6f 49 57 19  ||......W3D.uoIW.|
+00000200  ac 9d 24 af 5e 94 8f 53  20 45 e4 3c b2 62 3c 5f  |..$.^..S E.<.b<_|
+00000210  fb d2 17 1b a5 9c 37 a5  66 e3 12 b7 99 ee ce 05  |......7.f.......|
+00000220  37 5c 79 28 d1 4d 2f 1f  4a 79 91 e3 e7 88 2a 31  |7\y(.M/.Jy....*1|
+00000230  40 72 d2 58 e3 e1 84 16  75 d3 ab 8a bd 74 73 41  |@r.X....u....tsA|
+00000240  9b 57 69 d6 62 5e ca f9  b8 b2 05 06 08 b9 be 76  |.Wi.b^.........v|
+00000250  40 6d da 61 1d 5f d4 50  bd 36 07 5a 5a 1f 78 3f  |@m.a._.P.6.ZZ.x?|
+00000260  af 20 4c cf d8 da 6a 33  3b 03 9c b3 5f 07 f3 ce  |. L...j3;..._...|
+00000270  81 9b 9e b1 ce 2e f7 ec  6c b9 ee 99 54 9f df 6d  |........l...T..m|
+00000280  0b 20 1a 82 bb d3 76 57  b3 db 00 89 d1 17 03 03  |. ....vW........|
+00000290  00 1e b8 9d 93 7d eb 43  07 b6 8b c2 57 26 45 e4  |.....}.C....W&E.|
+000002a0  60 1c 13 0b ab cc 6a 6a  6b c0 b1 4e 66 36 92 02  |`.....jjk..Nf6..|
+000002b0  17 03 03 00 13 87 a1 99  a6 ea 80 e4 3e 55 66 fb  |............>Uf.|
+000002c0  a2 4f 79 e0 f7 a3 c1 6e                           |.Oy....n|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndEd25519Given b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndEd25519Given
index d80b76fc6c..731e892605 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndEd25519Given
+++ b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndEd25519Given
@@ -1,149 +1,149 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 3d 6d 5a b0 92  |...........=mZ..|
-00000010  7b 62 6d 14 22 f5 08 70  77 4a 80 fa 69 1a 1c 92  |{bm."..pwJ..i...|
-00000020  4c d3 e5 ca 3a d0 ee 33  40 c8 64 20 e5 a7 f1 57  |L...:..3@.d ...W|
-00000030  39 32 e3 9f 7c 33 58 16  61 58 29 44 aa e4 50 b1  |92..|3X.aX)D..P.|
-00000040  37 c5 59 27 f2 d5 b8 6e  01 24 c2 6b 00 04 13 01  |7.Y'...n.$.k....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 8e 65 2c 25 90  |............e,%.|
+00000010  2c f6 3b 40 a0 58 aa 9f  ec 27 f7 28 a7 46 a4 e2  |,.;@.X...'.(.F..|
+00000020  c5 b8 2e ae d7 d6 bf 25  b5 40 f4 20 a6 cf 1d 38  |.......%.@. ...8|
+00000030  04 15 40 3b c7 b9 e2 59  0a 48 ef 35 14 39 a2 37  |..@;...Y.H.5.9.7|
+00000040  ff 10 2d 8a 14 82 4d c7  bb 55 b1 1d 00 04 13 01  |..-...M..U......|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 cb  |-.....3.&.$... .|
-000000b0  da f4 03 da e7 6f e5 2b  25 c0 cb cf 52 0a fb af  |.....o.+%...R...|
-000000c0  8a 87 4c 2b 88 e4 1a b3  a0 34 30 fb 9d 4e 0e     |..L+.....40..N.|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 3f  |-.....3.&.$... ?|
+000000b0  e9 0f b3 c9 2c 2e 90 69  cb 26 6e ef 30 4e 8c 0c  |....,..i.&n.0N..|
+000000c0  de 4d aa 26 04 67 6e bb  ef b0 c8 8e 4f 0b 15     |.M.&.gn.....O..|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 e5 a7 f1 57  |........... ...W|
-00000030  39 32 e3 9f 7c 33 58 16  61 58 29 44 aa e4 50 b1  |92..|3X.aX)D..P.|
-00000040  37 c5 59 27 f2 d5 b8 6e  01 24 c2 6b 13 01 00 00  |7.Y'...n.$.k....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 a6 cf 1d 38  |........... ...8|
+00000030  04 15 40 3b c7 b9 e2 59  0a 48 ef 35 14 39 a2 37  |..@;...Y.H.5.9.7|
+00000040  ff 10 2d 8a 14 82 4d c7  bb 55 b1 1d 13 01 00 00  |..-...M..U......|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 2d 8b 08 3c eb 5e  |..........-..<.^|
-00000090  e6 d7 8e 9a 11 d0 e1 a3  3f 88 cc 83 49 e3 af 50  |........?...I..P|
-000000a0  66 17 03 03 00 3e 24 ba  0e 2f d7 51 a9 52 5d 51  |f....>$../.Q.R]Q|
-000000b0  a4 7d b6 dc 5c 43 2e d8  58 5e 72 f1 86 98 15 b8  |.}..\C..X^r.....|
-000000c0  db 0a 48 0a 06 c4 ad 36  41 84 f1 89 36 e9 24 da  |..H....6A...6.$.|
-000000d0  05 5a dc 82 02 a1 3d 39  ae 4c 7e d9 7b 43 1f 2c  |.Z....=9.L~.{C.,|
-000000e0  06 71 a0 2f 17 03 03 02  6d 48 44 6b d1 65 fb e1  |.q./....mHDk.e..|
-000000f0  fb 96 00 e5 ad c6 60 e2  b5 f6 bf 7c b7 f4 6f 0e  |......`....|..o.|
-00000100  db a2 4b f7 cd d7 73 29  f8 af 23 5d d4 55 df 37  |..K...s)..#].U.7|
-00000110  b7 62 38 d0 95 5c f1 48  32 5f cb fa 67 18 20 7f  |.b8..\.H2_..g. .|
-00000120  b7 0f ac fc 64 b7 b0 7b  4b 1f 65 1d 2a 94 8d 76  |....d..{K.e.*..v|
-00000130  b4 30 3b ee 44 a5 f6 74  5b 7e bd a7 bb b2 d8 d6  |.0;.D..t[~......|
-00000140  ac c6 1f b4 88 34 85 7e  89 2c 2e 0d bf 6c 16 0c  |.....4.~.,...l..|
-00000150  ce 35 57 13 29 55 60 20  86 21 20 c0 46 bc 9e dd  |.5W.)U` .! .F...|
-00000160  8a a0 41 60 b5 a9 16 cc  66 cb 4a ba 58 e0 70 d1  |..A`....f.J.X.p.|
-00000170  a5 b4 eb ac 54 7e 95 11  00 f0 70 63 af 56 57 99  |....T~....pc.VW.|
-00000180  68 57 b4 5b aa db f1 08  2e c0 fb df 93 b8 4a f8  |hW.[..........J.|
-00000190  2e 04 b3 2c 2b f9 47 09  a1 5f a3 3e 97 eb d4 d5  |...,+.G.._.>....|
-000001a0  df ec d1 9e 05 5e 10 b0  2b 7e 0e b4 c8 e1 e3 50  |.....^..+~.....P|
-000001b0  29 19 8b 3c f7 d0 95 30  ae 4c e4 60 c8 13 09 15  |)..<...0.L.`....|
-000001c0  b7 80 f3 ad a0 06 6b a7  b7 4a c4 6d 65 09 21 d3  |......k..J.me.!.|
-000001d0  3b 56 dc ce f5 d3 fa 93  e9 03 8e 0c c9 47 21 89  |;V...........G!.|
-000001e0  7f 39 23 f8 aa 68 f6 b4  82 50 1f b8 46 5d 26 dc  |.9#..h...P..F]&.|
-000001f0  b1 1f e5 e5 6b ad ad 0d  d8 55 b7 8b 7a f8 5d fc  |....k....U..z.].|
-00000200  bd 74 a4 15 72 33 1b a7  3b 8c 09 55 d9 fd 21 bf  |.t..r3..;..U..!.|
-00000210  cd dd 67 d2 0c d0 bd 9b  de 52 e3 5f 4d 54 c0 6c  |..g......R._MT.l|
-00000220  bd 93 ae 66 55 4b e9 75  6b db cd 6b 80 33 f4 b7  |...fUK.uk..k.3..|
-00000230  61 9e e4 5d 75 b5 44 26  79 b5 da bf af 54 8c 40  |a..]u.D&y....T.@|
-00000240  23 99 32 60 2a 76 b3 0a  46 37 c9 85 1c fe e9 a1  |#.2`*v..F7......|
-00000250  a3 e8 61 67 04 eb 3e e8  2b d3 12 75 87 04 67 40  |..ag..>.+..u..g@|
-00000260  19 63 c5 ef 75 d0 39 63  a0 c3 ae 3c b1 88 34 db  |.c..u.9c...<..4.|
-00000270  c7 29 0c 33 c8 40 c0 b0  e6 76 44 cc 99 4f 2b a6  |.).3.@...vD..O+.|
-00000280  b3 e1 28 69 6c 41 74 55  53 a9 87 06 9a cb 14 5d  |..(ilAtUS......]|
-00000290  ec 74 77 e2 a0 ce 54 02  ba f8 04 2c 84 9a de 2b  |.tw...T....,...+|
-000002a0  dc 02 32 01 ad 96 5c a0  87 3c 55 dd ee 4d cb fd  |..2...\..<U..M..|
-000002b0  ee a1 d4 9e 3f fd 66 10  fc eb cf 2e d3 f1 aa 9d  |....?.f.........|
-000002c0  a2 fe 37 d5 b7 c7 6a b2  59 48 7a 57 9f 45 ff 22  |..7...j.YHzW.E."|
-000002d0  4c e2 dd 50 72 00 e0 9e  af 35 7e 19 32 f2 f8 f0  |L..Pr....5~.2...|
-000002e0  5c af ff 4f e8 37 44 8a  12 f5 14 e6 c2 79 7e 90  |\..O.7D......y~.|
-000002f0  72 65 b7 cf f4 51 fc c9  fb 08 80 ef d5 4c ba 4e  |re...Q.......L.N|
-00000300  a0 e2 0a 72 1a 4c 02 35  14 59 41 02 28 73 12 94  |...r.L.5.YA.(s..|
-00000310  ef 39 c5 b8 0e 43 ae 4e  0e 96 de d3 6e 25 8f ae  |.9...C.N....n%..|
-00000320  ff 52 c2 ca 22 bb 77 b3  48 0c 9b e8 c1 0c 03 94  |.R..".w.H.......|
-00000330  a9 1e a5 6b 00 46 39 f7  52 4f 39 14 07 40 99 5a  |...k.F9.RO9..@.Z|
-00000340  b0 c0 ba d3 0f a6 1e 30  ab 06 b4 5a b6 21 c6 93  |.......0...Z.!..|
-00000350  88 f8 a4 18 4d 37 17 03  03 00 99 87 d1 c8 64 88  |....M7........d.|
-00000360  d3 01 40 b6 89 cd 3d 26  a9 ea 36 bb 13 29 fa a0  |..@...=&..6..)..|
-00000370  f2 ba 28 65 a9 55 05 ff  47 53 37 0d 09 c6 30 b2  |..(e.U..GS7...0.|
-00000380  be 9f 31 e3 97 bc 5f 06  25 c2 d1 8a b6 3b c1 4e  |..1..._.%....;.N|
-00000390  54 1a ea 57 2a 10 33 df  ec 57 27 2e 71 a9 ea 16  |T..W*.3..W'.q...|
-000003a0  09 98 dd 40 f1 4d f3 34  d8 c5 f9 7a d3 db 57 f1  |...@.M.4...z..W.|
-000003b0  cc e8 1a 0f 88 51 ba 52  23 5f e9 91 f5 e3 1c ef  |.....Q.R#_......|
-000003c0  59 b1 e1 e5 da 64 0e 56  00 65 77 82 32 b9 eb bd  |Y....d.V.ew.2...|
-000003d0  d2 07 87 cd 83 94 39 63  64 90 d7 e7 8e 25 b9 66  |......9cd....%.f|
-000003e0  34 d3 a1 80 06 33 4d c9  69 ff ab 28 12 b9 19 a4  |4....3M.i..(....|
-000003f0  a6 05 94 db 17 03 03 00  35 68 36 21 a4 85 d8 96  |........5h6!....|
-00000400  52 51 a3 99 61 41 1e c4  84 97 9f 85 ed da d7 72  |RQ..aA.........r|
-00000410  79 ce 52 3a b9 31 31 19  f3 e5 d7 03 72 0c ab a9  |y.R:.11.....r...|
-00000420  7c 0f 17 38 9c 82 26 a5  95 1f 02 85 5b f6        ||..8..&.....[.|
+00000080  03 03 00 01 01 17 03 03  00 17 b4 57 fb a1 f4 24  |...........W...$|
+00000090  99 a4 eb ab 7b 09 31 b6  b1 89 4b 17 da 64 4b b6  |....{.1...K..dK.|
+000000a0  7d 17 03 03 00 3e 5e 69  bb 28 4e b0 ba d6 31 ab  |}....>^i.(N...1.|
+000000b0  05 ad e9 f3 34 dc bb 28  41 45 42 26 cc 02 f2 2b  |....4..(AEB&...+|
+000000c0  96 66 3d cf b2 dd 89 7a  40 f8 44 cb 1e b8 52 01  |.f=....z@.D...R.|
+000000d0  82 ed 90 97 26 54 76 95  2b 69 a0 c6 95 bd e2 5a  |....&Tv.+i.....Z|
+000000e0  2b 90 a1 da 17 03 03 02  6d 29 de 48 a1 af 3a 16  |+.......m).H..:.|
+000000f0  e9 51 34 34 0c 56 11 cd  4a 80 88 27 40 01 6e 9a  |.Q44.V..J..'@.n.|
+00000100  d3 cc dc 76 00 1f cc 3f  b4 d0 8b e8 5e d5 8e 28  |...v...?....^..(|
+00000110  f1 b5 46 ba f6 c0 26 3e  bf f1 98 0c 07 6b 34 a7  |..F...&>.....k4.|
+00000120  a4 35 92 47 a7 58 07 b3  7b 0e 17 fb 4f 4d 39 c1  |.5.G.X..{...OM9.|
+00000130  8c 69 56 2f 7c eb 39 17  66 1e ab bc 0f f8 3f bd  |.iV/|.9.f.....?.|
+00000140  33 40 ac ed 6f 2c cd 45  5a fa 2b c6 b5 2c b5 46  |3@..o,.EZ.+..,.F|
+00000150  2b 53 7b 5b 61 be c1 78  19 81 58 27 f5 2f a7 04  |+S{[a..x..X'./..|
+00000160  8d ef 67 11 7c d0 42 14  c6 c2 84 f8 d4 ee 4e 68  |..g.|.B.......Nh|
+00000170  d6 de a9 32 a3 5d b0 e1  44 4d 1d 29 e5 39 82 27  |...2.]..DM.).9.'|
+00000180  43 ba 5c 55 eb 70 64 70  ef a1 57 90 a6 82 62 c5  |C.\U.pdp..W...b.|
+00000190  a4 f5 be 35 6d 00 4a b6  2e ac 93 65 ad 85 f4 94  |...5m.J....e....|
+000001a0  40 10 8f 6a 59 ab 54 18  c4 fb e3 97 29 9e ed 3e  |@..jY.T.....)..>|
+000001b0  4b 35 dc c4 38 e3 d1 0f  6e cb b9 65 b3 b2 e3 f4  |K5..8...n..e....|
+000001c0  d7 05 df b4 33 7d 26 6f  9b 6b 58 33 b3 86 a4 1c  |....3}&o.kX3....|
+000001d0  7b 5e a6 2e 2b 2e ca 99  ad 28 28 87 0b c1 05 75  |{^..+....((....u|
+000001e0  dd e4 e2 d2 66 13 a5 a6  b2 d9 21 4d 7d d6 59 80  |....f.....!M}.Y.|
+000001f0  7a fd fe 66 9e c1 0a fc  9a a3 60 66 28 73 34 db  |z..f......`f(s4.|
+00000200  17 0f 3d fd 22 53 e7 c7  74 69 34 ab 5d bd b5 e5  |..=."S..ti4.]...|
+00000210  59 c8 d6 44 85 07 df 98  25 41 27 65 2a c2 54 5b  |Y..D....%A'e*.T[|
+00000220  94 8a 07 96 fe 7b 03 eb  37 10 f2 37 30 6b 3e 69  |.....{..7..70k>i|
+00000230  2a c8 3d 48 15 7e 6b 04  58 ed 1f 59 ad e6 8b b2  |*.=H.~k.X..Y....|
+00000240  7e 43 61 a8 a2 3e b7 c9  b5 86 cb be 8a f0 c4 15  |~Ca..>..........|
+00000250  c9 ef 7f e8 d9 3a ca c5  57 dc 6a 85 bb 6b 7b ca  |.....:..W.j..k{.|
+00000260  e9 20 5a 0c 5e b9 7c f7  07 fb 9a 62 c0 13 08 c4  |. Z.^.|....b....|
+00000270  87 69 61 c1 54 22 e0 43  9e 1e 8f 0f 2e 01 6e 36  |.ia.T".C......n6|
+00000280  85 13 23 41 22 4d 27 f0  1c 7c 12 78 9f 9a 88 ee  |..#A"M'..|.x....|
+00000290  0f 2c 8b bd 3d fb 24 67  72 ef 06 50 1e 25 f9 b5  |.,..=.$gr..P.%..|
+000002a0  ec d6 dc 13 8e 44 7e 15  25 f3 9f e9 c4 d8 2d 15  |.....D~.%.....-.|
+000002b0  f4 06 24 02 2c 24 f2 6e  6e b7 01 b7 92 6d 0b d5  |..$.,$.nn....m..|
+000002c0  df 4b 45 41 b9 86 f9 94  b1 38 d8 3d cd 2e 50 de  |.KEA.....8.=..P.|
+000002d0  32 ed 90 c5 f4 f7 ce 00  fa c5 07 6d de 24 54 78  |2..........m.$Tx|
+000002e0  bc 30 e5 a5 70 21 e8 4f  3b 1d ab d9 25 71 72 2f  |.0..p!.O;...%qr/|
+000002f0  06 6b 7a fc 4c c9 68 18  7a e8 08 31 5e 1d 53 d6  |.kz.L.h.z..1^.S.|
+00000300  e4 cb b2 f7 cb cc 65 93  63 64 a2 e9 56 40 51 ba  |......e.cd..V@Q.|
+00000310  29 e2 4b 27 8e dc 93 ac  12 63 18 6e 64 18 c0 03  |).K'.....c.nd...|
+00000320  51 5c bc b3 a7 29 f9 75  db c7 aa c1 d2 1a 40 31  |Q\...).u......@1|
+00000330  84 42 9b 9f c0 1c 4f 38  0d 4b 4d e9 1c 04 e7 da  |.B....O8.KM.....|
+00000340  6d 16 fd dc bb e8 8f 3b  d1 1d 6c 2f b2 53 39 86  |m......;..l/.S9.|
+00000350  b3 35 15 e9 a2 73 17 03  03 00 99 fd a2 ed e7 c5  |.5...s..........|
+00000360  1a ab b7 a2 dd 3b fc f6  35 ce 53 26 84 2f e0 da  |.....;..5.S&./..|
+00000370  a6 8b 5b e8 67 77 46 7f  0d 92 64 17 48 8e cc 78  |..[.gwF...d.H..x|
+00000380  fc d4 8e 1d b4 2c 26 07  72 2d 37 da 63 74 63 a0  |.....,&.r-7.ctc.|
+00000390  7f e6 59 fc cb a3 8a 8c  17 9e 09 71 fa 1a 61 cd  |..Y........q..a.|
+000003a0  86 bf e3 4c f4 cc 75 c1  dc 46 d9 fc a2 f6 c0 a2  |...L..u..F......|
+000003b0  db f0 db ce 29 5a c4 d0  ad a2 48 ce e7 ce 22 be  |....)Z....H...".|
+000003c0  9c 14 13 26 4a ff 00 0e  95 3b f3 04 db ca dd 95  |...&J....;......|
+000003d0  df c8 3e cf ee b9 80 8b  94 b8 3e eb 26 97 98 0e  |..>.......>.&...|
+000003e0  45 31 78 33 81 f5 8c 00  7d 7f e2 9d 3d 21 35 6f  |E1x3....}...=!5o|
+000003f0  1e 96 79 15 17 03 03 00  35 4c 9d a6 ed 2a bf 17  |..y.....5L...*..|
+00000400  cf 84 47 3b 89 86 55 75  bf 5b 81 6e 9f cd 5d c2  |..G;..Uu.[.n..].|
+00000410  e8 7e 46 ad 96 4f 84 f3  6a 8a 47 61 54 29 09 d7  |.~F..O..j.GaT)..|
+00000420  36 ef d7 40 e5 10 ee 2c  b6 49 e0 85 80 fa        |6..@...,.I....|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 01 50 d8 03 a6 37 13  |..........P...7.|
-00000010  5f fb 65 9f 33 33 79 ae  89 c3 de ea 4b 55 e2 b3  |_.e.33y.....KU..|
-00000020  13 07 0d 95 c6 f7 79 74  ad 8a 42 dd 78 55 a5 01  |......yt..B.xU..|
-00000030  69 f2 11 cf 72 de 85 04  56 78 9c ba 21 77 b8 76  |i...r...Vx..!w.v|
-00000040  e3 58 23 3d 2b 8a ee a4  5c 52 60 4b 50 0d c4 83  |.X#=+...\R`KP...|
-00000050  a1 8d 06 82 68 99 34 65  7a 7b 55 8e 46 04 47 55  |....h.4ez{U.F.GU|
-00000060  4d 42 02 41 b6 e4 dd a4  33 6a 04 97 e6 4a 80 3a  |MB.A....3j...J.:|
-00000070  e1 7e 0a a5 4f 0c f9 de  7a 91 96 4f 6a 6a 8a 4b  |.~..O...z..Ojj.K|
-00000080  fd 24 b9 bf e7 d5 5a 27  17 18 45 77 1d e2 c9 ea  |.$....Z'..Ew....|
-00000090  23 57 c4 e1 30 9e de d2  bd 0c 28 59 dc a1 12 d9  |#W..0.....(Y....|
-000000a0  ee 2e 43 4b 83 fc d7 6c  a4 e7 47 c4 14 c1 1f ee  |..CK...l..G.....|
-000000b0  79 60 26 86 73 5c ec c9  c0 ec f9 c9 38 98 2d ba  |y`&.s\......8.-.|
-000000c0  10 83 1b fe 8f cf 59 77  f0 60 fe c0 d0 7e 0f 2d  |......Yw.`...~.-|
-000000d0  69 04 dd 79 49 c5 b1 d9  9b 48 ad de 55 cf d3 47  |i..yI....H..U..G|
-000000e0  9b eb 64 ae ed cb b0 48  78 a9 27 24 b8 8d 53 36  |..d....Hx.'$..S6|
-000000f0  b7 0f 82 1c ee 11 4b 5a  98 1d 21 73 b4 f4 06 ce  |......KZ..!s....|
-00000100  50 bc 36 27 e1 87 70 04  68 1b 30 3a 86 68 b3 71  |P.6'..p.h.0:.h.q|
-00000110  8c 57 69 60 d6 a8 bd fa  13 46 2b 52 00 dc 45 53  |.Wi`.....F+R..ES|
-00000120  06 79 5b 96 78 69 d0 a8  cd 2d 39 8c 11 12 9f 65  |.y[.xi...-9....e|
-00000130  72 01 5e b4 c5 df bc 9d  a2 7f 00 a7 cc 95 3b 0b  |r.^...........;.|
-00000140  09 05 19 9f a5 b7 dd 48  3f ab f1 aa 36 da 70 96  |.......H?...6.p.|
-00000150  0f f9 f3 bc 80 84 09 a3  76 92 56 17 03 03 00 59  |........v.V....Y|
-00000160  4a ba a9 1c c7 f6 ef 77  8e cc 9a 8c 51 9f 43 1e  |J......w....Q.C.|
-00000170  ec 8f f3 33 93 eb 81 db  06 03 97 fd 3f b2 e0 e5  |...3........?...|
-00000180  e7 73 b2 2c 2c f0 c0 a4  51 18 10 79 4e 30 96 3a  |.s.,,...Q..yN0.:|
-00000190  d8 26 b1 a0 f4 1b e6 12  fe 74 58 68 97 45 1e 85  |.&.......tXh.E..|
-000001a0  3a db 04 a6 12 5d ba 19  e4 f6 b1 17 f3 04 75 f2  |:....]........u.|
-000001b0  ea 04 db 6c d4 d8 d5 cc  fb 17 03 03 00 35 1d c5  |...l.........5..|
-000001c0  cd 92 9c 80 3a ec 3c 06  3e 12 ed 7a 82 23 ab 18  |....:.<.>..z.#..|
-000001d0  67 4a 92 7d 30 e4 57 7b  25 34 a1 54 46 41 b7 60  |gJ.}0.W{%4.TFA.`|
-000001e0  69 cf a2 61 7a 59 6f b3  78 6f 41 0f 7d 9b 4f 00  |i..azYo.xoA.}.O.|
-000001f0  91 c7 93                                          |...|
+00000000  14 03 03 00 01 01 17 03  03 01 50 65 76 76 e6 2f  |..........Pevv./|
+00000010  27 74 6e 8d 11 6b 90 df  19 90 5e a2 7e 57 73 76  |'tn..k....^.~Wsv|
+00000020  4c f2 53 a2 ec 04 6f ae  3b ad a5 4b a2 14 93 00  |L.S...o.;..K....|
+00000030  86 56 09 5b 83 03 f6 ec  36 3f 45 8d 44 bd a9 3b  |.V.[....6?E.D..;|
+00000040  16 76 97 da 30 5b 91 4c  90 d6 6e 14 55 63 3b 0d  |.v..0[.L..n.Uc;.|
+00000050  b5 3e e1 53 8e 5a 01 17  b8 02 7f ea 63 2b 1e 14  |.>.S.Z......c+..|
+00000060  be c6 46 6a b9 5a 13 b5  ee a6 6c ce 02 cf aa c5  |..Fj.Z....l.....|
+00000070  48 0b 32 76 db 8f a7 c7  c8 ad 5c 51 bc c2 ea c5  |H.2v......\Q....|
+00000080  6e d5 b7 f9 2a 9c 45 20  9b 67 52 7f 7f e7 c6 41  |n...*.E .gR....A|
+00000090  00 e9 3a c2 1d 28 3d 24  56 66 bf 96 09 ae 15 2d  |..:..(=$Vf.....-|
+000000a0  eb ea ae ad 94 5e 20 34  05 df b6 1e 0f 03 7f 15  |.....^ 4........|
+000000b0  4c 41 84 07 51 ba 91 b7  68 21 e1 0b b8 30 e6 10  |LA..Q...h!...0..|
+000000c0  8d 30 cd 07 79 09 8e 5f  a7 65 a5 8d a3 28 27 09  |.0..y.._.e...('.|
+000000d0  98 da d5 64 b9 69 e7 30  d4 bc f6 11 5d 64 4b 03  |...d.i.0....]dK.|
+000000e0  0b 5d f5 d5 09 d1 04 d2  d5 37 c2 01 1a a8 b2 c1  |.].......7......|
+000000f0  95 9b 3f 05 eb 3e 19 7c  72 9e 86 b0 a8 9e 18 8d  |..?..>.|r.......|
+00000100  58 c4 d2 14 c8 c1 c1 81  1c 2d 74 48 2e 60 61 24  |X........-tH.`a$|
+00000110  81 99 da dd 81 b3 85 3a  61 0f a0 94 b4 31 93 90  |.......:a....1..|
+00000120  1d 25 62 ff 0d 75 bd 5b  e5 d6 c8 9a cb 9c 2b 45  |.%b..u.[......+E|
+00000130  0e 9a 28 2d 4c dc 84 9c  18 7f 17 a2 f2 73 1c f9  |..(-L........s..|
+00000140  b7 06 09 e9 ec 88 14 98  24 e6 9b 97 15 f3 6f 2b  |........$.....o+|
+00000150  46 ea 0d 25 33 df 98 c4  b4 cb 9f 17 03 03 00 59  |F..%3..........Y|
+00000160  61 d9 d3 a8 1a 90 27 11  31 be 80 dd 5a 2a fa 58  |a.....'.1...Z*.X|
+00000170  f6 1e cc 2e 5e 1d 17 4b  83 cf d7 fb c7 59 83 19  |....^..K.....Y..|
+00000180  65 91 7c ef 91 3d 0d b5  a7 10 a7 52 3d 5c 4a d7  |e.|..=.....R=\J.|
+00000190  b9 39 a2 f4 8b 5d ad f9  56 38 22 1f 87 04 af 62  |.9...]..V8"....b|
+000001a0  9f 89 b8 b5 1f a4 62 0c  11 55 3b 9e 45 b3 50 0b  |......b..U;.E.P.|
+000001b0  fc 00 92 64 84 57 72 81  d9 17 03 03 00 35 a1 d4  |...d.Wr......5..|
+000001c0  05 18 56 a4 68 81 33 f0  05 16 7a cf 14 2f 1e 74  |..V.h.3...z../.t|
+000001d0  06 fa 36 49 2c a5 d5 db  7a cc 06 8c c1 05 60 4c  |..6I,...z.....`L|
+000001e0  c7 97 81 7c ff fd 9e 82  ba 84 58 64 31 27 82 72  |...|......Xd1'.r|
+000001f0  8c d0 d7 17 03 03 00 13  0c 0b 27 77 f3 bb 57 99  |..........'w..W.|
+00000200  d3 2c 28 bd 95 2f fb 77  26 a6 52                 |.,(../.w&.R|
 >>> Flow 4 (server to client)
-00000000  17 03 03 01 ca 52 99 bb  74 e8 8e ab 48 c6 03 1d  |.....R..t...H...|
-00000010  f9 9a a8 be e4 b1 dc b9  8d e5 a8 11 2b d6 54 63  |............+.Tc|
-00000020  6f 0d dc 6e d7 55 c8 af  3c 88 c4 3e ab 30 ab b9  |o..n.U..<..>.0..|
-00000030  69 94 75 60 0f 75 77 e1  b1 29 09 9f db c1 74 43  |i.u`.uw..)....tC|
-00000040  92 2a 55 b9 ae 71 12 79  b9 4d ba 82 84 96 b1 01  |.*U..q.y.M......|
-00000050  14 b5 9c 5d 0c fe eb cc  a6 44 e5 0b 93 1c 8d 45  |...].....D.....E|
-00000060  d8 aa 7c 1b d1 47 5a 36  46 f8 f5 82 c7 fe 2b f3  |..|..GZ6F.....+.|
-00000070  46 17 9f 0c 03 df cd dd  0a 38 77 28 45 45 f2 3c  |F........8w(EE.<|
-00000080  06 1d 88 1b 55 d8 8f 70  9b a8 bb 37 a8 41 81 a6  |....U..p...7.A..|
-00000090  a7 f4 28 c1 f1 d2 8b ba  98 0e 35 92 88 ac cb b6  |..(.......5.....|
-000000a0  25 dd 5e 62 d5 e7 e9 da  4f 0e 55 b4 36 4d 09 20  |%.^b....O.U.6M. |
-000000b0  73 ef b3 6c 4c 6d c6 6a  e9 f3 f8 28 74 0d 50 b0  |s..lLm.j...(t.P.|
-000000c0  ad 75 f7 c5 fb eb bc 06  6b 07 23 80 70 87 8e a8  |.u......k.#.p...|
-000000d0  3e 66 87 07 53 8e 19 bb  3f 94 f1 9e 4b 05 f6 55  |>f..S...?...K..U|
-000000e0  34 3b d0 14 36 32 66 6a  62 8a ec 22 a1 82 0a 95  |4;..62fjb.."....|
-000000f0  95 b6 85 0c 2c c4 b4 3e  00 59 2a 1e c6 03 4b 2a  |....,..>.Y*...K*|
-00000100  e4 06 d5 29 e5 a1 e1 57  b0 a1 45 1b b7 0c 12 3f  |...)...W..E....?|
-00000110  0d 31 1a b2 ef 3d 90 73  3a 39 28 00 8a 0d e0 20  |.1...=.s:9(.... |
-00000120  83 a7 32 b8 02 d0 9f 90  f3 b3 ca df 36 ae d4 f8  |..2.........6...|
-00000130  c4 4b 82 06 13 04 66 e7  01 63 4e e8 80 b8 52 c0  |.K....f..cN...R.|
-00000140  8c a4 5b 3f b9 85 48 ac  01 f0 b6 ee db 73 d0 62  |..[?..H......s.b|
-00000150  e2 05 e7 71 7e 87 4b 7b  cf d0 a1 77 eb 38 64 85  |...q~.K{...w.8d.|
-00000160  5c 3d af fc e3 17 46 e7  c5 71 c9 63 bf 03 ae 35  |\=....F..q.c...5|
-00000170  7b 60 61 5d 5a 7b 57 88  79 82 55 68 45 a1 59 bc  |{`a]Z{W.y.UhE.Y.|
-00000180  e5 3b 5a 31 32 5c 24 13  e3 fc b7 53 41 76 1d 24  |.;Z12\$....SAv.$|
-00000190  7f 08 89 c6 f0 b9 57 3a  4d 91 66 66 e4 57 33 51  |......W:M.ff.W3Q|
-000001a0  1d b9 1e c5 68 9a 6a 74  1e c3 16 de 15 92 e3 d0  |....h.jt........|
-000001b0  0a 64 a4 64 e8 c4 a5 9c  55 30 a9 c3 b0 53 72 54  |.d.d....U0...SrT|
-000001c0  75 d7 a0 7a 54 85 6e 9a  4d ff 9f 13 3c b9 42 17  |u..zT.n.M...<.B.|
-000001d0  03 03 00 1e 6f 06 3f 1c  da f6 55 50 05 de 38 9d  |....o.?...UP..8.|
-000001e0  07 00 bb 28 32 a5 3f 04  22 4c 6e f2 ea 3a e0 cc  |...(2.?."Ln..:..|
-000001f0  5d 5b 17 03 03 00 13 3b  b8 7c df 14 b4 ba fa 6e  |][.....;.|.....n|
-00000200  2e 61 d6 6b bf b5 ad c2  35 73                    |.a.k....5s|
+00000000  17 03 03 01 ba 6d d5 ba  b6 7a 4e c9 c4 1a ff e9  |.....m...zN.....|
+00000010  cf 84 4c 47 b3 bd 21 a4  c7 f9 f1 a2 98 93 23 53  |..LG..!.......#S|
+00000020  35 38 97 25 d2 d2 0e 67  79 a4 48 ad d3 97 6a 7b  |58.%...gy.H...j{|
+00000030  09 10 1b 96 12 5d b3 bb  5f a2 47 90 ba 5f 4f b8  |.....].._.G.._O.|
+00000040  67 40 df 14 c5 83 48 54  da 36 d2 6a bc de 62 53  |g@....HT.6.j..bS|
+00000050  22 75 77 08 5e f0 bf 7a  5c 2a eb 1f 63 ce 26 0c  |"uw.^..z\*..c.&.|
+00000060  5f c9 6d c9 8f 94 02 de  31 ce 7f 8a 34 8b c2 7c  |_.m.....1...4..||
+00000070  6c f4 3e 0a c6 80 d8 3e  9e 87 2c 2a f8 72 64 6a  |l.>....>..,*.rdj|
+00000080  09 73 62 c4 ed 86 23 e6  14 a5 14 24 44 4c 2a 37  |.sb...#....$DL*7|
+00000090  d6 38 1d 12 6b 7a 0a 57  8e 88 6d f2 79 7a 75 3f  |.8..kz.W..m.yzu?|
+000000a0  0d e8 dc 57 10 80 bc f4  11 c7 b6 3c db 76 d2 9c  |...W.......<.v..|
+000000b0  08 b4 79 3e 11 a6 15 0a  4b a9 79 24 91 9a 50 ce  |..y>....K.y$..P.|
+000000c0  20 83 ac 97 f1 27 eb 2a  54 9e e3 82 35 07 91 aa  | ....'.*T...5...|
+000000d0  61 3b 64 2c ee e0 6d d4  93 82 63 a7 ed b0 d8 cd  |a;d,..m...c.....|
+000000e0  10 f6 3f 15 b4 a3 08 96  41 03 6d ba 0a b1 f9 e1  |..?.....A.m.....|
+000000f0  8a b0 26 99 33 40 4a d0  b1 d0 38 3d 05 4d be 62  |..&.3@J...8=.M.b|
+00000100  eb c6 46 ce 6f d2 3c d5  54 5c 84 49 b9 d8 de 06  |..F.o.<.T\.I....|
+00000110  1f 5c 4b e5 ea d7 fb 7e  b4 16 81 e4 5b e8 73 99  |.\K....~....[.s.|
+00000120  93 23 48 51 67 53 e0 c9  2c 4f 10 bc 89 aa 34 97  |.#HQgS..,O....4.|
+00000130  9b 2b 37 2c 01 ea bb 06  d1 a5 ff 41 c4 f9 33 ad  |.+7,.......A..3.|
+00000140  e1 df 63 51 4c 17 6a 9c  c3 95 61 83 81 22 e3 02  |..cQL.j...a.."..|
+00000150  90 d1 d2 9c d4 03 a8 4a  f0 fc 30 a8 06 8c 24 2b  |.......J..0...$+|
+00000160  70 8d d6 ca 70 5b 83 81  6b 6d 0d 4a d4 c2 b7 f1  |p...p[..km.J....|
+00000170  1e 85 65 4e 52 e7 d0 ba  60 87 6b 21 5d d6 ee 5b  |..eNR...`.k!]..[|
+00000180  2c 1e 00 83 9d a8 14 bd  df c9 fc 6f 6e dd 41 9f  |,..........on.A.|
+00000190  3a ab d8 70 4a 6c 68 3f  c3 ba 02 34 e1 a8 a7 80  |:..pJlh?...4....|
+000001a0  08 91 e3 2e 2e bd 04 d9  1f d2 30 17 2e e2 71 5a  |..........0...qZ|
+000001b0  d9 21 8b 22 8c 16 9d e7  77 40 28 9a ad f6 0c 17  |.!."....w@(.....|
+000001c0  03 03 00 1e 53 61 12 3f  61 24 db 4f 65 9f 7d b3  |....Sa.?a$.Oe.}.|
+000001d0  65 2b 43 89 a1 bc f0 df  a1 59 e4 e5 c0 ed 95 d4  |e+C......Y......|
+000001e0  f9 a3 17 03 03 00 13 5c  7c 76 1f 85 7c f3 67 cc  |.......\|v..|.g.|
+000001f0  9d 82 fc bb 6d 48 58 5a  b5 a9                    |....mHXZ..|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndGiven b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndGiven
index 800f99916c..f11b34463d 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndGiven
+++ b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndGiven
@@ -1,177 +1,177 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 c8 2f b4 54 5b  |............/.T[|
-00000010  11 8a 88 a9 a2 9b bf 66  f2 b4 e5 fb 32 af d6 dd  |.......f....2...|
-00000020  6c 6c 99 4f d6 48 cd eb  63 6e 1d 20 bb 0a 48 2e  |ll.O.H..cn. ..H.|
-00000030  45 4e 86 2d ae d6 fb 3e  0c 3e 9f a3 17 4a e3 39  |EN.-...>.>...J.9|
-00000040  58 a7 92 92 cb 30 03 0d  be b5 79 a5 00 04 13 01  |X....0....y.....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 09 8f c7 93 17  |................|
+00000010  40 3d b9 0a 8a 9c a5 21  99 27 7e 56 bf 25 30 48  |@=.....!.'~V.%0H|
+00000020  e1 c7 87 a0 f3 eb cd b6  1c 4f ad 20 6a 1c 8b 03  |.........O. j...|
+00000030  89 27 a0 2d 85 e3 7b 3d  c6 5f c0 f1 f3 ea be 84  |.'.-..{=._......|
+00000040  79 6b 83 63 e9 c3 52 02  a5 49 4a d4 00 04 13 01  |yk.c..R..IJ.....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 f0  |-.....3.&.$... .|
-000000b0  8e 19 a6 04 b7 f1 b0 cd  a1 28 bb 10 60 30 92 dc  |.........(..`0..|
-000000c0  bc 7a 1c fc a7 f4 dc 01  2e 88 f3 0e 80 82 71     |.z............q|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 29  |-.....3.&.$... )|
+000000b0  e0 9a b2 3d f4 3e 07 a3  62 0a 30 c5 d7 6b d9 5e  |...=.>..b.0..k.^|
+000000c0  d0 1b b4 3c bf 6e ee 0f  70 fc d6 51 54 db 1f     |...<.n..p..QT..|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 bb 0a 48 2e  |........... ..H.|
-00000030  45 4e 86 2d ae d6 fb 3e  0c 3e 9f a3 17 4a e3 39  |EN.-...>.>...J.9|
-00000040  58 a7 92 92 cb 30 03 0d  be b5 79 a5 13 01 00 00  |X....0....y.....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 6a 1c 8b 03  |........... j...|
+00000030  89 27 a0 2d 85 e3 7b 3d  c6 5f c0 f1 f3 ea be 84  |.'.-..{=._......|
+00000040  79 6b 83 63 e9 c3 52 02  a5 49 4a d4 13 01 00 00  |yk.c..R..IJ.....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 1a 9d c2 a8 12 c1  |................|
-00000090  c3 97 41 bd 1f 6e 48 98  36 4b 13 cd b9 9f 70 34  |..A..nH.6K....p4|
-000000a0  60 17 03 03 00 3e f8 19  ab 88 f7 15 07 97 72 ec  |`....>........r.|
-000000b0  41 6c 0a 64 b3 26 4a 56  21 20 d7 9c a2 84 06 ab  |Al.d.&JV! ......|
-000000c0  cb e6 99 1b 45 ce ca e7  c6 57 04 c9 3a 76 84 97  |....E....W..:v..|
-000000d0  fe a3 be 60 b2 2c 53 31  ab cd 49 d5 fc 59 80 69  |...`.,S1..I..Y.i|
-000000e0  38 d3 66 32 17 03 03 02  6d 8f 8b 7a 7d 78 d3 4b  |8.f2....m..z}x.K|
-000000f0  98 1e 0b 05 38 60 58 d0  0a 7a f8 a7 70 53 67 ce  |....8`X..z..pSg.|
-00000100  ea ed 86 3e 79 9d 37 66  b2 61 be 34 bf 15 5a d8  |...>y.7f.a.4..Z.|
-00000110  4e fb 52 62 8d e2 ae e9  58 b9 bc f9 e9 75 81 16  |N.Rb....X....u..|
-00000120  af fa 92 c3 aa ac d2 2c  7b c2 21 2f b0 0d e9 53  |.......,{.!/...S|
-00000130  d3 e3 ec d5 e7 95 23 83  d9 b1 ff 25 55 47 6a 1c  |......#....%UGj.|
-00000140  97 37 84 9a ce 67 15 63  0f ff 24 63 af 43 8a 7d  |.7...g.c..$c.C.}|
-00000150  46 63 bb 33 67 7a de 86  b4 6a 70 2d 6a 7f 82 c2  |Fc.3gz...jp-j...|
-00000160  24 3c e1 0f a9 7f 93 76  d2 c9 e2 56 d3 cb b9 17  |$<.....v...V....|
-00000170  97 2f 8a 25 40 dc 35 e4  00 3a 3f 2b 1e 09 1b f2  |./.%@.5..:?+....|
-00000180  12 2a 76 c0 2e cd 17 06  32 a9 f8 08 70 3f 06 fa  |.*v.....2...p?..|
-00000190  c7 1b c4 50 4f b8 1e 0f  6f 6a 3a ba f6 28 1b d0  |...PO...oj:..(..|
-000001a0  a7 34 a5 8c 02 fe 35 4f  b4 97 45 96 48 bc b9 0d  |.4....5O..E.H...|
-000001b0  c9 2f df bd c1 8b 19 44  33 12 90 2c d2 99 09 36  |./.....D3..,...6|
-000001c0  97 3f 29 56 30 77 15 df  15 c9 b1 26 9c f4 6a 59  |.?)V0w.....&..jY|
-000001d0  00 3e d8 28 74 19 6c 38  6c 68 63 16 ab cb f0 3d  |.>.(t.l8lhc....=|
-000001e0  ce 30 f6 9c 06 00 06 cc  5a 8e 78 73 af 53 a4 e6  |.0......Z.xs.S..|
-000001f0  49 10 5b 9d 4d f3 7d 48  f0 5d 87 27 d8 7e 58 a6  |I.[.M.}H.].'.~X.|
-00000200  86 51 a0 d6 e8 82 20 6b  d3 f9 99 4d 11 b7 49 ad  |.Q.... k...M..I.|
-00000210  f9 1a 1b f5 cd 81 81 bd  51 76 a4 5a 5f 35 7a 52  |........Qv.Z_5zR|
-00000220  12 1b 73 f6 f3 1d cf 93  7a 8e a0 1d 4c f3 b2 f5  |..s.....z...L...|
-00000230  16 00 57 21 2f c6 85 af  8c 8b f9 bd 2a f1 ee 15  |..W!/.......*...|
-00000240  ec ee 80 b9 8b 0a 50 36  cb 53 fd ca 53 b4 0e 96  |......P6.S..S...|
-00000250  7b db e6 93 f7 9e 8d e4  6a d5 ff e3 74 31 76 3a  |{.......j...t1v:|
-00000260  a8 de ce 06 97 3d 4e 91  c5 cd 85 06 c9 a6 02 91  |.....=N.........|
-00000270  f9 36 33 8d 28 23 54 f5  c3 f0 b2 1a a1 6b b7 c6  |.63.(#T......k..|
-00000280  d1 c3 31 ad d6 6f 0c 44  e4 34 d8 26 b6 ff 06 6f  |..1..o.D.4.&...o|
-00000290  f3 56 19 46 8d f3 75 c2  d9 69 4a 5b ff 3a b8 1d  |.V.F..u..iJ[.:..|
-000002a0  86 a9 6f 45 dc 3a e4 aa  9b 7d 3a 5a 50 ad c6 f6  |..oE.:...}:ZP...|
-000002b0  8c e3 0e ca b6 7a 99 e7  4b 58 26 c2 18 95 14 a4  |.....z..KX&.....|
-000002c0  f9 ae 79 4f f6 c0 f8 0e  d4 52 fb 3c 5d a2 30 9c  |..yO.....R.<].0.|
-000002d0  ea d9 8d f4 27 4c 6f 7a  02 45 8f ca 8c b1 bc d2  |....'Loz.E......|
-000002e0  c5 dc 8b 09 d7 c4 0f ea  f6 51 be f7 cd 01 1e 78  |.........Q.....x|
-000002f0  a1 37 4a 88 ae 5f c5 79  9c e2 4d c9 74 e7 2e 18  |.7J.._.y..M.t...|
-00000300  86 e8 62 3f 6c 39 73 eb  c2 e2 54 0c 13 ca f6 57  |..b?l9s...T....W|
-00000310  20 92 6a 1d 03 28 d0 53  6f 6e cb 57 da 33 20 1a  | .j..(.Son.W.3 .|
-00000320  c8 3d 09 73 5f 28 14 6f  4c 16 8c 41 cd 44 ad df  |.=.s_(.oL..A.D..|
-00000330  77 08 0f f1 3c 4c 2b 37  03 60 9d 07 85 e7 66 f7  |w...<L+7.`....f.|
-00000340  e7 7f 7b 45 0a db 3f 62  88 ca 84 ff e9 08 32 92  |..{E..?b......2.|
-00000350  07 77 cc c0 b7 31 17 03  03 00 99 d0 7e f0 62 28  |.w...1......~.b(|
-00000360  21 cb 07 5c 54 0b 79 94  26 e3 63 25 57 df e4 79  |!..\T.y.&.c%W..y|
-00000370  32 d1 1d 08 dc 66 76 30  68 62 c1 a7 9c 72 f6 07  |2....fv0hb...r..|
-00000380  e6 0e 30 de ef 4a 6e d8  0d 0e df 40 e7 6e 8b 48  |..0..Jn....@.n.H|
-00000390  07 62 27 7f 97 c8 8d 3f  8d ce b3 e4 9e ed c5 e0  |.b'....?........|
-000003a0  9e ec f2 7b 7e 4d e0 1b  14 69 ef c6 5d 04 5c a6  |...{~M...i..].\.|
-000003b0  1a 41 62 25 79 88 39 0e  b5 1a 6c 75 d0 fe 92 6a  |.Ab%y.9...lu...j|
-000003c0  7e 4f e2 36 f0 09 b8 a7  1a 4a 3a 94 f6 27 25 7f  |~O.6.....J:..'%.|
-000003d0  c9 ad 2e 50 41 64 a4 73  34 d2 4e 02 05 af 68 84  |...PAd.s4.N...h.|
-000003e0  40 81 d9 f7 a9 0b 77 ee  6c 83 0c d5 d5 70 49 e5  |@.....w.l....pI.|
-000003f0  a5 0a 3e 12 17 03 03 00  35 35 88 42 4c 14 18 a9  |..>.....55.BL...|
-00000400  3e 26 15 0a f1 c3 a6 ab  94 a3 72 bd c7 04 22 bc  |>&........r...".|
-00000410  67 32 15 16 23 f5 50 97  bc 7f ab f8 ef f0 02 7d  |g2..#.P........}|
-00000420  2d 76 01 18 72 18 77 c1  f5 9b e9 e9 97 8d        |-v..r.w.......|
+00000080  03 03 00 01 01 17 03 03  00 17 a6 29 77 32 51 25  |...........)w2Q%|
+00000090  13 ae e8 7d c0 5a f3 83  7f 50 15 73 af 17 a2 56  |...}.Z...P.s...V|
+000000a0  f8 17 03 03 00 3e 63 73  83 d1 42 19 08 d5 ec 98  |.....>cs..B.....|
+000000b0  64 95 f1 eb 5f 60 51 5d  07 21 48 25 d8 d3 76 51  |d..._`Q].!H%..vQ|
+000000c0  9d d5 9b 5f 87 6c c0 b2  b0 b2 b8 7f 9b ed 4a 41  |..._.l........JA|
+000000d0  f1 3e dc 21 8c 7c 2a da  fd 7a 82 38 8c c2 e9 c1  |.>.!.|*..z.8....|
+000000e0  5f f3 fe f8 17 03 03 02  6d 58 3c 00 1d ad b9 90  |_.......mX<.....|
+000000f0  64 ef cb be 77 5a 5e f7  46 1e 50 18 67 53 05 d5  |d...wZ^.F.P.gS..|
+00000100  b8 63 91 89 78 dc 49 0e  fa d6 1f 1e 21 20 9f 4a  |.c..x.I.....! .J|
+00000110  a0 b4 4a 70 9c 7e 7b 33  bf f6 9d c1 b9 b1 e7 57  |..Jp.~{3.......W|
+00000120  46 4e 59 a0 39 28 38 8b  1f 53 5e cf fe 90 82 fd  |FNY.9(8..S^.....|
+00000130  8c a3 aa 00 8a fa 75 d3  9b 9b 64 af 8a d5 18 e9  |......u...d.....|
+00000140  23 d2 80 3c b7 ed fe c0  d7 59 e8 e1 62 a0 c3 bb  |#..<.....Y..b...|
+00000150  b4 19 1a 1a 83 02 1b 61  aa c7 d9 81 84 b4 bb 30  |.......a.......0|
+00000160  3e f2 a8 55 b4 fb 1b 2c  25 72 f6 8a f5 5d 53 48  |>..U...,%r...]SH|
+00000170  fb 27 d8 e3 8b 19 6c e0  94 78 e5 b6 73 05 bc cb  |.'....l..x..s...|
+00000180  db 36 37 d2 24 8e 0d ac  fb 8a d5 20 ce f7 e8 45  |.67.$...... ...E|
+00000190  d0 d6 dc 5e 15 e4 b4 f0  63 74 c7 76 14 ec e5 41  |...^....ct.v...A|
+000001a0  32 e8 4b b6 eb 44 c8 95  56 6a 2e 8c 3a 8d b7 ff  |2.K..D..Vj..:...|
+000001b0  68 87 9c aa fa b0 0c 32  e7 6e ac df 04 47 3f fd  |h......2.n...G?.|
+000001c0  04 63 78 ac 48 85 81 7e  c7 8c d7 55 8b 57 73 8b  |.cx.H..~...U.Ws.|
+000001d0  78 23 c3 8b e2 ff 10 9c  e3 cb 69 ce 13 7a cf 31  |x#........i..z.1|
+000001e0  2d 05 8b 6e 36 69 a9 c2  5e 77 19 7c b5 1c 04 08  |-..n6i..^w.|....|
+000001f0  e9 71 00 c5 49 27 47 bb  52 e4 54 7b da 6c cf 2d  |.q..I'G.R.T{.l.-|
+00000200  c7 4b 80 bf 64 96 73 3e  54 5b 72 c5 2b 66 e2 8c  |.K..d.s>T[r.+f..|
+00000210  94 5c 6e 36 07 a0 a5 17  46 71 84 73 57 06 3e 9d  |.\n6....Fq.sW.>.|
+00000220  b6 6c 9b 84 44 a5 4c f5  d1 74 1a 65 81 5b 37 b2  |.l..D.L..t.e.[7.|
+00000230  46 9c 83 10 e2 db 21 3b  ca e8 16 25 1e 93 69 03  |F.....!;...%..i.|
+00000240  06 08 a8 06 1e 89 b6 5f  45 28 29 df 44 48 c9 37  |......._E().DH.7|
+00000250  06 b4 59 5f 41 bd b8 89  dd 74 a4 b2 d6 7a 87 fa  |..Y_A....t...z..|
+00000260  ea 8b 3d ca a7 a1 f0 44  59 af a2 c4 51 e0 17 0c  |..=....DY...Q...|
+00000270  a5 e7 bf f8 09 4b 97 ed  34 59 d5 97 df ba fd 05  |.....K..4Y......|
+00000280  d0 47 22 8b 25 16 88 7d  e7 0d 66 49 22 c3 08 01  |.G".%..}..fI"...|
+00000290  ba 99 82 3e c7 5c c5 b9  b9 50 c3 4f af 5c 1d 68  |...>.\...P.O.\.h|
+000002a0  6b c4 e0 06 23 75 ba f0  e3 3b 4e b7 6c 8e 78 ab  |k...#u...;N.l.x.|
+000002b0  bb 52 a1 f3 40 a7 be 0b  58 89 e5 20 69 ab 2d 50  |.R..@...X.. i.-P|
+000002c0  74 b9 cd 92 07 bb e1 b2  45 7d ad a2 13 90 71 4d  |t.......E}....qM|
+000002d0  2f 45 ea e9 ac 3e 2b aa  57 b9 0f 8f 61 99 56 bc  |/E...>+.W...a.V.|
+000002e0  62 39 4e 23 b2 5a 89 91  b7 2e 2c 8e 1f 1d 5b 69  |b9N#.Z....,...[i|
+000002f0  6d 47 13 50 1f 3f 77 f8  c0 de c0 32 7e 57 ef 35  |mG.P.?w....2~W.5|
+00000300  8e c0 13 88 34 79 af ca  8d 8f 7d 43 7c 54 70 a6  |....4y....}C|Tp.|
+00000310  77 8d 72 87 e5 50 5c d4  4e f3 80 cd 9b af 99 71  |w.r..P\.N......q|
+00000320  16 27 0b 0c 5c 03 a0 38  60 38 c4 20 5c 14 a6 a5  |.'..\..8`8. \...|
+00000330  57 f6 5b bc 26 4c 5d a8  73 10 5c 2c aa ad 8f 98  |W.[.&L].s.\,....|
+00000340  70 1b a8 04 8f 5b 56 7b  ee e3 e4 66 95 fa 2c 29  |p....[V{...f..,)|
+00000350  07 ae cb 92 a7 cc 17 03  03 00 99 cd e6 b8 49 6c  |..............Il|
+00000360  97 64 24 17 30 f7 4a 79  41 13 23 4b 2b e6 87 e0  |.d$.0.JyA.#K+...|
+00000370  89 19 cc 21 70 2b d6 a0  db 6c 17 8c 03 a4 0c 45  |...!p+...l.....E|
+00000380  25 90 0b 73 de 8d f3 8a  41 5d 21 78 39 f5 7c d8  |%..s....A]!x9.|.|
+00000390  9b 26 54 b9 4c 9c 19 95  1d 9b ef 02 f8 76 52 7e  |.&T.L........vR~|
+000003a0  d8 17 65 6d 61 47 d5 78  df 70 f9 07 95 c1 ec 8e  |..emaG.x.p......|
+000003b0  dd 91 11 1f be 85 24 96  5e 32 7a 46 ae 8e 99 6e  |......$.^2zF...n|
+000003c0  0a be a0 4a 4d 25 34 4f  18 9a cc 3a 8d 91 72 4e  |...JM%4O...:..rN|
+000003d0  d4 a2 17 8d 77 6a f3 b8  52 ec 06 d8 3d 7a b4 fa  |....wj..R...=z..|
+000003e0  d4 e8 36 0a ea 39 e3 da  61 32 26 95 18 1b b6 c3  |..6..9..a2&.....|
+000003f0  da e0 02 ed 17 03 03 00  35 32 c6 2e 2c e6 46 e5  |........52..,.F.|
+00000400  fa b0 ed c5 3d 32 28 9d  85 8d 05 07 94 64 2b b1  |....=2(......d+.|
+00000410  01 94 03 80 cb 94 de aa  2e 3e 63 21 5d b9 32 86  |.........>c!].2.|
+00000420  3d bf 33 72 6a a6 0c 7a  da 94 a3 33 67 9d        |=.3rj..z...3g.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 02 11 4b 29 10 c9 7b  |...........K)..{|
-00000010  98 9a fa ce 7a 17 a4 7d  15 5f 97 4f 40 67 37 f0  |....z..}._.O@g7.|
-00000020  0b 2d ca 62 77 23 ab 78  d7 9f b6 1d 5c 64 fb 68  |.-.bw#.x....\d.h|
-00000030  70 5f 21 df e1 55 3b e3  bb 8e 61 31 11 ba 2b eb  |p_!..U;...a1..+.|
-00000040  de 78 39 5c 31 62 a3 fb  9a 57 a4 50 34 43 76 55  |.x9\1b...W.P4CvU|
-00000050  ae f9 36 b1 35 ee 2b 8d  ab c2 70 52 b0 8c d6 1b  |..6.5.+...pR....|
-00000060  fe 0f fc 5e 79 c3 cf ab  d3 9a 81 af 63 2c b3 f7  |...^y.......c,..|
-00000070  a6 b7 13 c4 70 22 fa 56  6d 77 cb d1 bf a5 9e c8  |....p".Vmw......|
-00000080  74 83 80 f9 9a 19 f3 a3  94 15 72 7c 55 0e 21 47  |t.........r|U.!G|
-00000090  2b a2 d3 b8 74 e1 07 37  7f 12 f6 ad ba 71 e5 ca  |+...t..7.....q..|
-000000a0  17 42 2b 78 9e 90 7d 28  b1 f4 dd 7d b8 69 dd c6  |.B+x..}(...}.i..|
-000000b0  eb 3d 93 45 06 ac 5d fe  02 18 b8 f3 8c e4 4e 97  |.=.E..].......N.|
-000000c0  05 8b 36 94 cb 0f 66 64  ed a8 50 22 ba c8 a7 23  |..6...fd..P"...#|
-000000d0  7d f9 d5 4f d5 27 83 f3  b6 09 3f 4f 69 92 6d be  |}..O.'....?Oi.m.|
-000000e0  4a 30 02 d2 d5 e6 14 d4  21 e2 c8 5b cb 08 1e 9a  |J0......!..[....|
-000000f0  28 f7 f4 13 8c 58 9b 69  2c 55 3d 78 f2 ce 93 89  |(....X.i,U=x....|
-00000100  2f 62 56 ea a3 21 96 f6  e7 ee a4 3d d8 7d 86 4d  |/bV..!.....=.}.M|
-00000110  79 c9 3b c8 cf ea a0 6b  5f 29 8c ed c2 d6 73 27  |y.;....k_)....s'|
-00000120  a0 35 bb 2b 8b 6c 4e 59  74 e5 84 c4 d2 1a f1 0d  |.5.+.lNYt.......|
-00000130  5c 36 33 f7 42 d6 08 c3  f8 5b ea 27 a1 cc b9 72  |\63.B....[.'...r|
-00000140  d5 b9 4e 17 36 b3 05 29  50 da 52 bc 23 f7 82 82  |..N.6..)P.R.#...|
-00000150  c0 67 2b 80 a2 7f e2 ec  b9 12 bb dc b6 04 b6 4f  |.g+............O|
-00000160  87 15 16 13 de c4 1c 04  71 33 ba d7 a7 da f1 f5  |........q3......|
-00000170  77 c6 4e 8e b2 65 a1 6c  a8 c2 5b a1 f5 da 49 6c  |w.N..e.l..[...Il|
-00000180  85 ee 21 8d 10 6b 82 bf  0c 0f 7e 33 8b 5e 44 5b  |..!..k....~3.^D[|
-00000190  70 db bc 76 40 a0 5c 02  f6 8a 9b de aa a4 b2 94  |p..v@.\.........|
-000001a0  d0 e0 b7 60 af df ad 3d  e3 17 a9 60 e0 d9 a8 3e  |...`...=...`...>|
-000001b0  c6 06 9b ad 97 0b dc 21  16 9d 42 29 74 a1 f5 03  |.......!..B)t...|
-000001c0  d4 15 0d ee fd fa 6b 85  12 2f 8c 26 fd 96 ce 85  |......k../.&....|
-000001d0  a5 b7 ba bb ac 8a 6d 54  f5 fd e6 6c 32 24 a9 e7  |......mT...l2$..|
-000001e0  1a 11 bf 4d cb f9 18 9a  b8 1e a6 e4 1f 61 b1 ce  |...M.........a..|
-000001f0  1c ca 5d 81 e7 84 e0 a9  4e c7 f9 5d 71 72 76 4b  |..].....N..]qrvK|
-00000200  65 ca 3a a4 4d d8 ec 82  aa 33 80 bb 15 48 2d 7c  |e.:.M....3...H-||
-00000210  4e 5e d2 ec 13 1a e7 03  d5 29 95 80 17 03 03 00  |N^.......)......|
-00000220  99 60 a2 43 34 23 c0 a4  4c 0a 18 c5 27 96 2f 7c  |.`.C4#..L...'./||
-00000230  af 2b 2c 36 f2 9b cf 93  e7 3e 79 3b 20 d4 3b 60  |.+,6.....>y; .;`|
-00000240  a2 ef af 36 d5 45 d4 20  89 be 80 1d 1e ca f7 19  |...6.E. ........|
-00000250  35 8f 26 3f be c0 a2 f6  c6 85 a3 88 76 cd 06 f9  |5.&?........v...|
-00000260  4f ff 54 79 6c ac 33 71  31 90 70 36 eb 9c c1 b4  |O.Tyl.3q1.p6....|
-00000270  4a c8 3a 52 85 2b be 4a  19 8a 24 fd 6f 08 47 19  |J.:R.+.J..$.o.G.|
-00000280  84 88 a0 48 f6 17 80 f8  fe 9e 21 68 e1 75 17 14  |...H......!h.u..|
-00000290  d4 e2 3a e2 de 9d 19 56  ad cc 33 13 f3 52 b2 1b  |..:....V..3..R..|
-000002a0  f4 65 04 05 79 9f 3e 14  fb 1f 9c d1 c4 53 c0 93  |.e..y.>......S..|
-000002b0  49 ad 3c 2e de c1 b4 fe  be b3 17 03 03 00 35 32  |I.<...........52|
-000002c0  81 98 1a 6c 38 ca 67 64  c5 30 0b 81 7d fd a1 b9  |...l8.gd.0..}...|
-000002d0  2e af 41 1d e9 b7 31 17  d8 08 ce d5 f6 12 4d da  |..A...1.......M.|
-000002e0  fc db fb e1 fa 5b cd 70  12 e7 bb 26 dd 53 9c 43  |.....[.p...&.S.C|
-000002f0  02 06 1f 70                                       |...p|
+00000000  14 03 03 00 01 01 17 03  03 02 11 c9 db 52 ed e6  |.............R..|
+00000010  7e ea 09 35 cc 04 13 79  db 65 e0 1a b5 3c dd 4d  |~..5...y.e...<.M|
+00000020  19 65 18 97 a3 33 d2 02  d1 84 3b 72 e1 dd 6e a1  |.e...3....;r..n.|
+00000030  37 ac 78 b5 dd 07 7f 41  6a 4c 8f f5 8e cb ca b1  |7.x....AjL......|
+00000040  ff 8b 2b 68 7e b7 1f da  b7 f7 7a aa 6b 92 fe d8  |..+h~.....z.k...|
+00000050  a1 03 84 cf 1f dd 21 48  b9 3d 5b b7 b7 dc d5 f7  |......!H.=[.....|
+00000060  4e 5c 70 50 5d d5 96 b9  c2 e2 23 5d c6 ba 0d cb  |N\pP].....#]....|
+00000070  74 b2 3f 0b a1 a7 4b e2  3a 83 e5 07 cd cb 46 a8  |t.?...K.:.....F.|
+00000080  05 be e6 e7 3b 65 e9 d3  ac c3 31 0b 4a 5d 8b 4e  |....;e....1.J].N|
+00000090  59 a0 2d 3d 10 d8 97 73  05 f6 1a 21 4a 7c fe 01  |Y.-=...s...!J|..|
+000000a0  e5 4d 68 2b 5a cf ed 8f  37 cf 00 a3 17 bf 16 56  |.Mh+Z...7......V|
+000000b0  e9 3b 1b 5a 87 c1 03 f1  8a a4 8b 99 f3 3d 13 99  |.;.Z.........=..|
+000000c0  90 72 5c 46 ba 26 ab 1f  f2 b7 41 c5 0f 44 de 8c  |.r\F.&....A..D..|
+000000d0  5e 5f da 61 27 04 c7 6a  83 12 08 9c c1 73 88 09  |^_.a'..j.....s..|
+000000e0  64 3d 01 25 79 ed f4 7d  18 73 ec 1c 89 88 e5 ce  |d=.%y..}.s......|
+000000f0  80 3b 38 83 0b 61 a6 16  6b 96 2b 28 19 31 fa 0b  |.;8..a..k.+(.1..|
+00000100  79 1e 1f 3b fe 3f 65 26  60 0e dd 7c 4d bb 32 77  |y..;.?e&`..|M.2w|
+00000110  2a 5a 6e e6 e4 8c 38 65  d5 ae d7 1d 01 bc 19 8e  |*Zn...8e........|
+00000120  60 92 d3 f0 00 19 e7 13  35 f2 4d bb 60 41 6b c9  |`.......5.M.`Ak.|
+00000130  68 56 7d 2d b5 d7 56 63  10 7f 53 1a 5e d1 ba 42  |hV}-..Vc..S.^..B|
+00000140  e8 51 86 b6 b5 4a a1 52  e4 2c 97 94 17 d0 69 aa  |.Q...J.R.,....i.|
+00000150  bc d1 e6 c1 cf 23 c4 4e  f0 9f 96 b7 82 b4 d9 d2  |.....#.N........|
+00000160  90 1f 06 17 ac 43 fe d2  cf 31 a8 ac 31 2d 00 7e  |.....C...1..1-.~|
+00000170  86 99 31 27 af cb b1 b7  de 15 04 0f 4d 60 c5 63  |..1'........M`.c|
+00000180  9c ff 75 4e 68 9b 80 4a  b6 60 04 04 6d 50 ae 4c  |..uNh..J.`..mP.L|
+00000190  f0 34 72 e4 c7 37 06 32  fc 55 f0 b8 3c dd 06 1b  |.4r..7.2.U..<...|
+000001a0  2c bd f3 a1 77 a3 13 90  df 29 b1 6c 57 17 9d af  |,...w....).lW...|
+000001b0  94 82 17 74 27 30 ae b7  39 1a 77 02 bd 77 1c 1c  |...t'0..9.w..w..|
+000001c0  f0 62 3b 0f dd c4 b0 87  9b 41 72 02 fb 6c c0 7e  |.b;......Ar..l.~|
+000001d0  01 46 55 de c0 d2 de 26  18 d5 a1 17 40 b7 a7 a3  |.FU....&....@...|
+000001e0  a2 48 5d 6f 65 fe 3e 44  20 18 b4 82 c8 80 11 bb  |.H]oe.>D .......|
+000001f0  20 88 e5 5b 98 ab c1 fc  08 8d 62 1c 36 7a d1 55  | ..[......b.6z.U|
+00000200  73 00 e8 e4 a0 20 19 1b  59 62 eb 6a c3 ef d0 9d  |s.... ..Yb.j....|
+00000210  89 f3 7d 26 f8 9a 71 a9  85 2a 00 85 17 03 03 00  |..}&..q..*......|
+00000220  99 00 e1 e9 4d 25 62 e7  d6 a5 ec dd 17 15 0a ce  |....M%b.........|
+00000230  60 a0 00 17 53 9d f2 a7  28 c6 9c cf ec 39 0c 88  |`...S...(....9..|
+00000240  30 b2 52 85 cb 07 c9 87  49 da 76 88 04 df 5f 8a  |0.R.....I.v..._.|
+00000250  53 a4 e0 1d ff 1e 9a 47  e8 af f5 14 36 e5 24 bf  |S......G....6.$.|
+00000260  2d cf 98 2d 97 f8 46 c1  9c 5c 68 95 31 a1 35 fa  |-..-..F..\h.1.5.|
+00000270  b9 78 d2 82 ef 58 4c 6e  5a 92 34 c6 31 49 bb d4  |.x...XLnZ.4.1I..|
+00000280  dd 5b 64 35 65 c8 a4 99  4c fa 04 da e4 d9 10 11  |.[d5e...L.......|
+00000290  ef 04 33 98 c7 80 01 c8  32 f8 2c d9 22 75 55 5f  |..3.....2.,."uU_|
+000002a0  14 cc d3 1e 9a 91 81 ab  a7 f0 b9 04 8a 2f 43 aa  |............./C.|
+000002b0  94 ff 92 88 b1 e1 2a ca  87 67 17 03 03 00 35 ee  |......*..g....5.|
+000002c0  85 79 99 da 96 18 f0 c9  ca 6a 0e 48 93 b3 3b 0b  |.y.......j.H..;.|
+000002d0  02 05 5a 69 1e 5d 4c 10  44 02 db 6f 49 04 65 01  |..Zi.]L.D..oI.e.|
+000002e0  45 be ee c6 67 0b 07 bc  c3 3a e3 8a cf ac ca 08  |E...g....:......|
+000002f0  70 d2 20 40 17 03 03 00  13 ab 1c 1f 66 38 10 bb  |p. @........f8..|
+00000300  fa 7a f4 52 8f ba 8d 03  61 b1 5c 73              |.z.R....a.\s|
 >>> Flow 4 (server to client)
-00000000  17 03 03 02 8b 8e b1 29  40 b6 53 bc 89 c7 87 69  |.......)@.S....i|
-00000010  4c 6d 5b 61 d9 ba 5b 96  22 ac 57 71 58 f8 0e ea  |Lm[a..[.".WqX...|
-00000020  81 ea bf f9 34 6d a0 ce  1f d2 97 52 62 2b 9e f7  |....4m.....Rb+..|
-00000030  03 28 96 56 c0 a1 0e 69  7c 98 13 e5 91 8c 48 5f  |.(.V...i|.....H_|
-00000040  4e 78 87 14 38 f8 fa 3c  17 97 f9 de 38 3b cf 0f  |Nx..8..<....8;..|
-00000050  d9 dd 41 0a bb 65 ca a7  0b fd a5 11 c2 c3 6a b8  |..A..e........j.|
-00000060  5a e1 68 a1 8d f8 35 9d  c6 e1 3e e1 03 a9 06 ee  |Z.h...5...>.....|
-00000070  1f 92 ca b5 f4 df 3e e5  69 63 9e a2 ea 5e b8 d9  |......>.ic...^..|
-00000080  26 31 9e 25 de a8 ea 44  1a c0 86 0b 38 75 04 dc  |&1.%...D....8u..|
-00000090  2d 37 ad 40 e3 2f d1 b0  9e 9e 64 57 8b 31 20 d6  |-7.@./....dW.1 .|
-000000a0  16 64 fd 1b c1 01 58 af  4b 88 49 23 7a f6 a2 15  |.d....X.K.I#z...|
-000000b0  ca 02 4b d6 6d 7c f8 7a  c9 c0 0d 32 6e 1d 83 ca  |..K.m|.z...2n...|
-000000c0  47 e5 6f 86 a0 f7 8b 50  1d 91 ec fa 2b 4a 72 f7  |G.o....P....+Jr.|
-000000d0  a0 09 f1 65 fb 81 32 d2  a0 be 18 07 9f 5d 89 98  |...e..2......]..|
-000000e0  08 09 a6 1d 9a 5a 10 67  81 58 82 00 9d 01 48 a8  |.....Z.g.X....H.|
-000000f0  5b df 54 b3 cd 84 87 e0  41 e6 1e 47 46 33 56 0c  |[.T.....A..GF3V.|
-00000100  67 82 b9 bc 28 68 f3 5b  51 a8 c0 0e 43 14 62 bb  |g...(h.[Q...C.b.|
-00000110  8a bd 3f 4d d6 33 c4 76  4f c1 06 f8 9b bf 64 41  |..?M.3.vO.....dA|
-00000120  6c e5 40 8d 93 4a 6b 6f  fe 72 6b db ac 35 b4 fc  |l.@..Jko.rk..5..|
-00000130  84 13 fa 8a 7d 35 e3 73  12 eb 1a 5f a9 e2 28 53  |....}5.s..._..(S|
-00000140  0c 6d 41 ec 4b 76 f5 d9  48 2a c2 85 2a 1f 7d 61  |.mA.Kv..H*..*.}a|
-00000150  f6 1f 27 ef 47 c9 c7 b3  19 5c 07 d5 18 ec fd 3e  |..'.G....\.....>|
-00000160  78 41 cb a4 3a 47 22 cf  7e 7e 17 be 27 c4 90 ce  |xA..:G".~~..'...|
-00000170  2a cb cd ed 0f a3 bf 1e  4c 62 7a 80 ff 21 38 c5  |*.......Lbz..!8.|
-00000180  c2 37 9f 62 4b d8 c0 9e  df ae 3c 69 cd 25 f5 65  |.7.bK.....<i.%.e|
-00000190  ec f6 c2 0e 0f f0 b2 12  85 c4 2a 4b 8f 18 1a 0a  |..........*K....|
-000001a0  fa 4d 12 5f ee d4 11 64  21 f9 c7 c4 a6 ba e5 3b  |.M._...d!......;|
-000001b0  e9 54 ec ee e6 d3 09 31  9f 6e 99 ec 71 7e 42 5d  |.T.....1.n..q~B]|
-000001c0  78 88 ba eb 9f dd 99 59  fe 4e 29 1a 2e 35 12 4b  |x......Y.N)..5.K|
-000001d0  98 d4 14 79 80 b7 86 d3  da b5 c8 a6 34 cb 06 57  |...y........4..W|
-000001e0  a6 70 5c 6d 15 0b a7 ec  c9 ab fb 24 ad b7 c0 2b  |.p\m.......$...+|
-000001f0  ec fb 9b d4 57 b1 44 86  cf 75 c4 de c6 32 f9 01  |....W.D..u...2..|
-00000200  ab 84 85 17 2a 0a 7e 48  e9 94 28 0c ba a8 98 a8  |....*.~H..(.....|
-00000210  b2 36 89 62 ed 0d d8 e8  af 91 1b fd f8 97 25 c9  |.6.b..........%.|
-00000220  56 27 ff 1b d8 56 23 ec  96 8f ed 7b db 80 1e d4  |V'...V#....{....|
-00000230  b8 79 d4 23 d2 3c 89 38  32 14 b9 4e b4 55 99 1f  |.y.#.<.82..N.U..|
-00000240  4f 56 3f 65 c7 b8 bd 28  47 f8 74 50 bb 16 5f de  |OV?e...(G.tP.._.|
-00000250  e1 4d bf d9 bf 0e c0 57  3b a4 7d 7a 95 42 49 95  |.M.....W;.}z.BI.|
-00000260  b2 e2 99 68 72 38 9b 87  b6 c0 4c d5 b9 da 08 81  |...hr8....L.....|
-00000270  27 f8 5f 68 30 fd 01 7f  c4 d5 74 9f e6 3f 28 93  |'._h0.....t..?(.|
-00000280  83 18 38 bd c5 cf be c7  a1 bd 65 a1 74 fb cc e9  |..8.......e.t...|
-00000290  17 03 03 00 1e c3 24 ce  a6 69 b8 6c fe 2a 71 a9  |......$..i.l.*q.|
-000002a0  74 4a 04 8b 40 f4 06 06  99 e0 52 fd 13 78 b2 08  |tJ..@.....R..x..|
-000002b0  b7 c1 8a 17 03 03 00 13  ea fb 49 f8 a7 37 b2 f0  |..........I..7..|
-000002c0  ef 9d 6b 7e 68 04 5a 27  fa 36 a5                 |..k~h.Z'.6.|
+00000000  17 03 03 02 7b 5b 42 c8  3b a8 38 ea aa 7b 43 8b  |....{[B.;.8..{C.|
+00000010  03 a5 a4 e1 fb a4 f7 5f  e2 47 51 b5 41 22 15 62  |......._.GQ.A".b|
+00000020  80 bf 5f f1 6c 6e 9e 92  bc a3 96 5e 11 03 80 64  |.._.ln.....^...d|
+00000030  ec 42 46 1e 55 12 85 91  d8 63 7a 68 0a a5 72 bd  |.BF.U....czh..r.|
+00000040  fe 57 12 fe 7d 36 c6 a7  9d 5f 85 f6 59 85 f2 ef  |.W..}6..._..Y...|
+00000050  af f1 ea 6d ca 34 e8 41  c7 7d e3 b6 0b be 11 1b  |...m.4.A.}......|
+00000060  29 45 e9 a6 dc 08 67 0b  6e c9 fe ec 1a 82 f7 9c  |)E....g.n.......|
+00000070  42 ae 9a 88 e8 1c cd de  71 a8 8a 87 31 84 d5 fc  |B.......q...1...|
+00000080  d6 10 21 3e 14 d2 5f 54  00 15 11 49 ae c8 7f d5  |..!>.._T...I....|
+00000090  b6 9e 33 34 22 bc f4 4d  5c 72 ad e0 4b 57 9a 11  |..34"..M\r..KW..|
+000000a0  89 46 36 88 98 a6 ff 7f  d8 72 02 a5 1e 78 1c 8d  |.F6......r...x..|
+000000b0  c6 ad b4 df 57 4a dc 8a  bd 47 fa 9f dc 5a d6 1c  |....WJ...G...Z..|
+000000c0  1a 4c 8d 7f e8 f4 b6 e6  be 80 25 ba d5 d2 d5 10  |.L........%.....|
+000000d0  19 dd 3e 28 e3 af f5 67  45 60 d3 7f 11 a8 f7 e3  |..>(...gE`......|
+000000e0  55 08 75 98 45 30 2a 83  a5 cb 6b 64 fe 89 ab eb  |U.u.E0*...kd....|
+000000f0  c8 c3 52 45 08 82 e8 e7  78 4c 31 ab b6 ae 16 de  |..RE....xL1.....|
+00000100  b8 70 53 ee ec 4e 23 4f  a4 84 55 0f 53 b0 17 a9  |.pS..N#O..U.S...|
+00000110  d7 d0 e7 4e 62 02 15 a9  e7 54 1a 47 08 7d 00 b3  |...Nb....T.G.}..|
+00000120  38 58 de c7 20 ab 36 f6  be 20 38 a1 b0 80 e8 a3  |8X.. .6.. 8.....|
+00000130  a5 e7 3d 17 f5 70 6d 77  6d ae 65 9a 35 f9 25 40  |..=..pmwm.e.5.%@|
+00000140  7b 65 0d 08 27 8d fd bb  9e 2a 3d dc 29 79 80 74  |{e..'....*=.)y.t|
+00000150  53 cc e8 cd c9 b2 af 95  1d 10 98 2c f6 21 4a 30  |S..........,.!J0|
+00000160  f8 5b ea 07 0b b5 45 2c  62 fa 91 d9 a0 72 94 9c  |.[....E,b....r..|
+00000170  19 ec 01 b2 a9 f3 61 71  39 f5 55 65 16 94 67 c9  |......aq9.Ue..g.|
+00000180  87 f6 be fb d6 f9 f4 c7  c1 d1 ff 2c 78 07 63 19  |...........,x.c.|
+00000190  23 15 a2 6d 18 0d d0 05  be 5c 81 ac d8 f2 04 a9  |#..m.....\......|
+000001a0  ec 01 db cf 5f 75 e6 bc  4a 92 67 95 c5 d8 a0 94  |...._u..J.g.....|
+000001b0  5e d7 9a 97 1d a8 8b e5  07 8f 6a 51 a2 cb a4 40  |^.........jQ...@|
+000001c0  54 77 76 87 c2 aa b2 f5  35 f2 1f 31 1e 6f f1 58  |Twv.....5..1.o.X|
+000001d0  5f 4c ef 70 09 c2 d5 63  50 ff fd 9d 9a 84 94 34  |_L.p...cP......4|
+000001e0  26 26 b3 7f b2 c3 de 94  01 b2 0b 77 23 4c 95 82  |&&.........w#L..|
+000001f0  5c db 47 17 93 ab f3 b6  f4 a4 83 16 a8 2f 27 88  |\.G........../'.|
+00000200  bf b5 a1 7c 0d c0 66 2f  a7 97 a2 56 6a 3f 4b 69  |...|..f/...Vj?Ki|
+00000210  3e 68 52 62 67 15 77 f4  f5 84 14 b5 e2 a1 89 c1  |>hRbg.w.........|
+00000220  9a 89 53 6b e5 f8 77 d6  18 7c 23 c7 19 7a d8 4a  |..Sk..w..|#..z.J|
+00000230  f9 d2 03 b2 d0 30 bd b2  e9 31 c5 c0 27 67 65 18  |.....0...1..'ge.|
+00000240  2b 35 36 87 b7 70 6b 3b  05 ef c7 69 2a fc c4 e2  |+56..pk;...i*...|
+00000250  e8 27 65 a3 e3 0b 18 de  da f4 22 1e c8 f4 b0 d9  |.'e.......".....|
+00000260  34 a0 33 6f b5 e9 61 ac  13 db 14 1a a6 eb 33 44  |4.3o..a.......3D|
+00000270  39 0d 21 62 a9 7f 77 54  53 25 15 2c 5e cf 18 c5  |9.!b..wTS%.,^...|
+00000280  17 03 03 00 1e 1f b3 65  70 fb 27 cd c2 17 af 37  |.......ep.'....7|
+00000290  56 90 9b 4c b8 16 2b 7a  73 55 db ff cd f7 e7 57  |V..L..+zsU.....W|
+000002a0  af 6a d6 17 03 03 00 13  27 b4 96 07 8e 23 a3 ef  |.j......'....#..|
+000002b0  93 b6 3e b7 bd a4 e4 33  bd 29 06                 |..>....3.).|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedNotGiven b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedNotGiven
index fb2fb34d54..c16d0dec72 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedNotGiven
+++ b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedNotGiven
@@ -1,104 +1,103 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 15 b6 db 09 24  |...............$|
-00000010  50 ea d6 f7 ae d7 32 2f  72 25 23 db 11 ad 6f c1  |P.....2/r%#...o.|
-00000020  5d 62 af e7 93 63 1a 8b  f3 82 80 20 5f 15 2e 86  |]b...c..... _...|
-00000030  86 2c 2e 2f 82 11 3c d2  9f 00 32 d4 3d 05 04 fa  |.,./..<...2.=...|
-00000040  36 41 8d dc 30 ce a6 2b  6e d4 3c 9c 00 04 13 01  |6A..0..+n.<.....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 a1 eb cd fe ad  |................|
+00000010  69 19 0c 1f 2d ad 7a 14  4c dc 56 73 ba 60 ea b7  |i...-.z.L.Vs.`..|
+00000020  9f 8e 54 73 3b 18 ac 7e  15 26 7d 20 d0 3a a9 23  |..Ts;..~.&} .:.#|
+00000030  48 ec 62 65 0b 01 ed 9a  d3 27 9f 94 c3 05 91 b1  |H.be.....'......|
+00000040  88 a0 a1 1a cb 6e ed 89  f3 76 39 94 00 04 13 01  |.....n...v9.....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 98  |-.....3.&.$... .|
-000000b0  b7 40 03 d8 a3 4c 9e 16  82 77 16 9b c1 17 3a 2a  |.@...L...w....:*|
-000000c0  fc 25 73 5d 2d 5c dc 15  78 36 12 7a 28 f2 0e     |.%s]-\..x6.z(..|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 53  |-.....3.&.$... S|
+000000b0  56 2d f7 8c 59 8a 3b f9  bd eb ef 08 c3 15 e9 f2  |V-..Y.;.........|
+000000c0  8c cf fd a8 42 54 d3 8b  5d 07 06 06 d8 3c 10     |....BT..]....<.|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 5f 15 2e 86  |........... _...|
-00000030  86 2c 2e 2f 82 11 3c d2  9f 00 32 d4 3d 05 04 fa  |.,./..<...2.=...|
-00000040  36 41 8d dc 30 ce a6 2b  6e d4 3c 9c 13 01 00 00  |6A..0..+n.<.....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 d0 3a a9 23  |........... .:.#|
+00000030  48 ec 62 65 0b 01 ed 9a  d3 27 9f 94 c3 05 91 b1  |H.be.....'......|
+00000040  88 a0 a1 1a cb 6e ed 89  f3 76 39 94 13 01 00 00  |.....n...v9.....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 14 12 e8 30 75 5a  |.............0uZ|
-00000090  a4 27 7d 83 2e 51 0e 48  14 7b 53 0c 65 24 71 c5  |.'}..Q.H.{S.e$q.|
-000000a0  44 17 03 03 00 3e 34 38  ac c0 b5 05 e1 03 e1 a3  |D....>48........|
-000000b0  d3 42 ec e3 94 96 e7 a3  05 d8 44 ca 1d 89 b6 6f  |.B........D....o|
-000000c0  52 ce 3c 7d 61 f1 b4 a2  83 31 ab cf e7 ca 53 57  |R.<}a....1....SW|
-000000d0  b8 eb f4 7a 8a 7c ce 31  fe a4 b6 c7 a5 ed f2 2d  |...z.|.1.......-|
-000000e0  da 36 d6 49 17 03 03 02  6d 2c b4 e1 f3 87 4e c7  |.6.I....m,....N.|
-000000f0  ab db ea fa 0d 31 20 f2  1e 63 1d 10 bd 61 98 a2  |.....1 ..c...a..|
-00000100  50 8d 12 0d c8 5c f8 e4  97 9c 5f f3 47 f4 60 a5  |P....\...._.G.`.|
-00000110  59 16 a2 27 06 94 80 93  af 1e 9d c0 9a 23 20 bf  |Y..'.........# .|
-00000120  a4 5a 26 2c 37 86 d8 8a  b7 e2 bd e2 4f ab 53 65  |.Z&,7.......O.Se|
-00000130  bd 34 2c 1a 88 72 bf 8f  20 0c e2 51 0f ea 3f 47  |.4,..r.. ..Q..?G|
-00000140  dc 0e cd 21 3c d0 cc 7d  38 b8 b9 1b 20 67 83 a9  |...!<..}8... g..|
-00000150  af 4c f7 7b c0 d9 00 5c  66 e3 d7 2e 3b 6a b5 9c  |.L.{...\f...;j..|
-00000160  6e f6 ed 96 25 3c ce ea  db fa 85 ba e2 d8 4c 95  |n...%<........L.|
-00000170  92 06 0a 38 19 7f 52 30  2b ef fc 23 c6 b3 e5 d1  |...8..R0+..#....|
-00000180  83 2e 56 65 d6 ef 06 3a  71 d6 39 e9 16 62 65 78  |..Ve...:q.9..bex|
-00000190  59 c1 9f 7f 99 be c2 b9  0b 56 0a db 26 ec 16 15  |Y........V..&...|
-000001a0  be 27 cb bb cf 4a 9c a1  fd 5c 7d 5d c6 df a2 ed  |.'...J...\}]....|
-000001b0  f1 70 74 03 40 7c 8f af  ea 3c 6a c7 c6 30 98 4c  |.pt.@|...<j..0.L|
-000001c0  5a c1 e5 33 fb 56 8f 02  df 22 01 7b 11 f7 8a 5f  |Z..3.V...".{..._|
-000001d0  70 75 39 96 f9 1f 1b c9  d4 64 d8 8c a2 04 33 fd  |pu9......d....3.|
-000001e0  5e 07 37 30 12 2a 91 21  6f 83 23 95 2b 5a 72 13  |^.70.*.!o.#.+Zr.|
-000001f0  5a 0d 4a 05 57 c9 dd fc  77 ff 74 b1 5d 14 25 70  |Z.J.W...w.t.].%p|
-00000200  ee 8e 93 1b bc d3 3c d9  ba 3f 8a f0 79 45 a2 c6  |......<..?..yE..|
-00000210  23 f2 7d dc 21 4f cd 01  a5 4a 2c 46 96 21 5c 15  |#.}.!O...J,F.!\.|
-00000220  30 eb 1d 44 0f e7 fc 45  6b d5 e6 33 f5 88 71 53  |0..D...Ek..3..qS|
-00000230  96 2a c1 c7 61 cb 1d 6a  95 8d ee 64 8a 58 1c a6  |.*..a..j...d.X..|
-00000240  6a c9 75 86 6a f0 d2 4c  f0 1c 6d 36 18 fd 6b d8  |j.u.j..L..m6..k.|
-00000250  da 3d d0 0f 7b d3 33 f8  30 c9 f2 1a c2 1d 55 3d  |.=..{.3.0.....U=|
-00000260  2d 71 15 6d 26 f7 ad 05  23 de b0 50 83 f5 c0 39  |-q.m&...#..P...9|
-00000270  09 62 73 d6 c2 b9 53 c9  85 ff b9 ff 60 23 5c 06  |.bs...S.....`#\.|
-00000280  f9 87 e3 25 28 cf 75 9d  58 26 76 9e 55 91 71 aa  |...%(.u.X&v.U.q.|
-00000290  92 ea 3c 97 d4 43 4b d8  b8 5f 8a fc 4b a4 ad a0  |..<..CK.._..K...|
-000002a0  aa 5b 91 b6 8d 5d 84 19  40 13 93 5a 33 a9 fd 65  |.[...]..@..Z3..e|
-000002b0  86 ca b3 fe be e7 ef 75  a5 b2 35 8d 6f cb ed 27  |.......u..5.o..'|
-000002c0  17 2e 72 f8 46 60 f1 90  79 46 30 6b 42 31 09 4b  |..r.F`..yF0kB1.K|
-000002d0  fa a4 9b 69 4c 86 0c 9f  e4 6b 13 08 c4 9c 81 a3  |...iL....k......|
-000002e0  f3 74 99 1f d7 c1 d6 7c  12 25 25 92 3a 05 33 eb  |.t.....|.%%.:.3.|
-000002f0  3b be 38 f3 07 1d 3b 9d  a9 1b cc bc 37 2d 41 1d  |;.8...;.....7-A.|
-00000300  61 c6 ac b7 30 30 78 df  b4 be f6 1d d6 e5 c8 af  |a...00x.........|
-00000310  42 9b a7 b3 9c 4c 70 2c  23 e8 d5 8b 14 e0 21 d1  |B....Lp,#.....!.|
-00000320  66 af 2a 3a b4 f0 fa 44  88 2e 05 7a 2a 36 b2 21  |f.*:...D...z*6.!|
-00000330  27 5f a7 ff 3a cf dc 63  9e bd 81 d1 30 06 4b da  |'_..:..c....0.K.|
-00000340  ed f5 3f 1e 69 83 9b e2  7c 58 26 fa de d9 49 8c  |..?.i...|X&...I.|
-00000350  96 35 d0 37 63 08 17 03  03 00 99 4b 17 f2 3b bc  |.5.7c......K..;.|
-00000360  f3 b5 e2 0a da dd 4f 17  49 78 51 9b 58 b1 5c 79  |......O.IxQ.X.\y|
-00000370  d7 bd ac ee b9 25 24 9e  3d 28 37 ea 81 3c 98 ac  |.....%$.=(7..<..|
-00000380  c6 bd a8 e2 8a b4 f7 15  a3 07 b0 2c 09 de 62 4d  |...........,..bM|
-00000390  be 09 6e 3c 4f 7d c2 0e  35 d7 22 39 0e 8b 0a 99  |..n<O}..5."9....|
-000003a0  c8 60 21 cf bd 41 57 da  69 47 fe 6e 15 22 90 a7  |.`!..AW.iG.n."..|
-000003b0  34 51 64 d2 3a b6 8e 6e  28 a6 e3 42 1e 45 d9 9a  |4Qd.:..n(..B.E..|
-000003c0  95 71 82 a8 18 2b 13 93  ed 8f dd 74 8e 20 6e c7  |.q...+.....t. n.|
-000003d0  09 35 94 92 6b 98 9c c8  2c 03 30 16 67 f1 ee 4d  |.5..k...,.0.g..M|
-000003e0  26 7c be ae 38 83 e3 b9  e4 60 cc e3 6b 3f 8e ad  |&|..8....`..k?..|
-000003f0  63 90 c5 25 17 03 03 00  35 d9 2b cb 6f 6c 5b ac  |c..%....5.+.ol[.|
-00000400  01 e1 c6 f8 5e 70 62 56  03 a9 a4 19 c4 55 d2 d5  |....^pbV.....U..|
-00000410  96 1f 48 85 13 24 57 f1  34 4c 4e 79 03 ec 84 c2  |..H..$W.4LNy....|
-00000420  ce c6 83 3c 71 1d 93 6d  d7 e3 7a e0 4a 11        |...<q..m..z.J.|
+00000080  03 03 00 01 01 17 03 03  00 17 21 21 07 25 09 0b  |..........!!.%..|
+00000090  b0 e2 51 37 39 a6 b8 ab  7b 9e 53 07 3f 8c 63 18  |..Q79...{.S.?.c.|
+000000a0  8e 17 03 03 00 3e d5 39  d7 6d a6 4b 9f f9 53 8c  |.....>.9.m.K..S.|
+000000b0  78 f5 21 5f 3e f8 37 da  37 bb 6c 17 7a ab 0f 6e  |x.!_>.7.7.l.z..n|
+000000c0  7e 76 93 0b c7 84 41 c9  29 21 9e 3c 65 ee 6d c7  |~v....A.)!.<e.m.|
+000000d0  31 10 63 a4 56 fb 8b a5  1d 91 b2 19 57 62 94 6a  |1.c.V.......Wb.j|
+000000e0  23 1e ef ef 17 03 03 02  6d de c9 54 70 cf 6c 70  |#.......m..Tp.lp|
+000000f0  f7 03 0a 1e 97 c8 c7 bc  fa cb 44 bc 97 45 09 40  |..........D..E.@|
+00000100  63 ef 02 7a ee 6b 29 cc  17 6e a6 aa 8e 0c 46 41  |c..z.k)..n....FA|
+00000110  ca 36 18 77 ec 78 8b 1c  d0 c2 11 94 6e ff 19 47  |.6.w.x......n..G|
+00000120  09 c7 67 cf 4d 9c da 64  9e 80 2f b5 e5 9e e2 f3  |..g.M..d../.....|
+00000130  9d 2a ae 45 9c 1a 48 6e  5c 3f 3f f8 65 ea e9 8f  |.*.E..Hn\??.e...|
+00000140  f9 2d 1c 88 b7 ef 0e 0e  ce 2f 21 5e ef ec d1 6c  |.-......./!^...l|
+00000150  ca ad 4c 22 6a 48 4d 55  63 e2 08 78 b7 88 00 77  |..L"jHMUc..x...w|
+00000160  71 bd 4d d4 c7 b3 1a 8e  a1 67 64 d9 b6 8b 2f 92  |q.M......gd.../.|
+00000170  08 68 28 2c eb 9f 5e cb  1d c3 97 6c e7 f8 36 3c  |.h(,..^....l..6<|
+00000180  1b 0c 2d ff 9b ff be e9  28 a5 69 25 23 fb fe 28  |..-.....(.i%#..(|
+00000190  f9 b2 5a 2b 8d 55 42 f8  cc 50 1d 43 6c 09 f1 75  |..Z+.UB..P.Cl..u|
+000001a0  86 9b fc b9 34 e6 52 a8  0f 6b c9 8f 1f 35 77 c8  |....4.R..k...5w.|
+000001b0  9d ec 96 c0 0a fb 5b 64  ae 1f 79 f9 fc b5 af 20  |......[d..y.... |
+000001c0  e1 a6 dc e0 fa 29 b6 9d  15 b4 cc e5 20 54 df 0a  |.....)...... T..|
+000001d0  74 b6 46 94 11 f3 48 25  85 4d 92 f3 a5 fb 37 46  |t.F...H%.M....7F|
+000001e0  83 64 ee 61 82 85 f6 4d  8d 83 ca a5 51 7a dc f7  |.d.a...M....Qz..|
+000001f0  ed cb 5c 40 3f 31 86 67  87 d8 23 c9 8b f3 5c f6  |..\@?1.g..#...\.|
+00000200  f7 4b f7 45 51 c5 87 9e  2e d1 00 c3 71 7b 72 c6  |.K.EQ.......q{r.|
+00000210  91 f1 4e d4 a0 10 2c 73  39 0b 22 7e f6 28 08 e3  |..N...,s9."~.(..|
+00000220  28 09 09 09 f6 6e 92 73  8d 44 56 c1 f4 4a 19 4c  |(....n.s.DV..J.L|
+00000230  77 7e bc eb ce 40 04 eb  68 fa cf 32 bc c2 c7 66  |w~...@..h..2...f|
+00000240  95 45 74 2d 1b 01 85 f7  f2 76 a0 63 f9 5f b4 cf  |.Et-.....v.c._..|
+00000250  ad af 8d a5 80 1d f8 2c  ed 1a a4 4d a8 9c 80 56  |.......,...M...V|
+00000260  dd 0e 8b 93 58 cf 5e 51  b4 6e d3 a4 ec 7c 1e 92  |....X.^Q.n...|..|
+00000270  79 76 fb d2 74 c7 63 4c  51 67 d2 d5 66 06 e4 bf  |yv..t.cLQg..f...|
+00000280  bf 67 32 28 0e 4a 6c 78  58 a4 53 36 aa 3f 73 ae  |.g2(.JlxX.S6.?s.|
+00000290  c2 57 5a 04 6d 68 4f 54  54 eb 57 35 1c 46 c5 fc  |.WZ.mhOTT.W5.F..|
+000002a0  de bd 2e d1 c2 71 6a a6  01 4c 07 ae a9 29 fb 46  |.....qj..L...).F|
+000002b0  0e 6b 99 51 bf 34 fa b2  b2 4b 3b 61 65 b2 32 83  |.k.Q.4...K;ae.2.|
+000002c0  92 f7 4b 9c 55 68 5f 04  5a 6d 94 07 c4 c6 6b 10  |..K.Uh_.Zm....k.|
+000002d0  bf 8f d3 1a 65 14 7e d7  c7 07 4b 78 05 ca 6b b0  |....e.~...Kx..k.|
+000002e0  ca 79 c8 f1 23 cc 6b f9  a7 ed f9 12 e7 de 07 55  |.y..#.k........U|
+000002f0  67 52 08 92 cf 27 69 e2  f5 91 68 0d 75 ac 32 6f  |gR...'i...h.u.2o|
+00000300  7b bd dc 94 f5 0c aa aa  83 3b 52 c4 b3 a2 76 f9  |{........;R...v.|
+00000310  78 60 6c 25 1b c7 fb c6  b2 d2 8c cc e9 ea 4d 64  |x`l%..........Md|
+00000320  87 b1 8f 69 a4 f5 f3 19  34 44 fe 75 18 67 43 3c  |...i....4D.u.gC<|
+00000330  14 70 b1 fe d1 cb ac 96  cd 52 52 41 4a 8a 07 9a  |.p.......RRAJ...|
+00000340  88 37 0d 41 f2 76 45 96  e9 92 b3 68 37 e4 c9 1a  |.7.A.vE....h7...|
+00000350  cf 30 a3 82 9e bf 17 03  03 00 99 aa a6 fb 04 2a  |.0.............*|
+00000360  45 b2 46 a6 1e 10 fb 54  c1 a9 a2 78 af 18 d9 00  |E.F....T...x....|
+00000370  63 a1 4c 35 1a 4e 10 52  d5 2a 79 ec 45 aa ac 91  |c.L5.N.R.*y.E...|
+00000380  f9 10 d2 45 a7 96 5a 91  08 06 c0 0c 57 3b 51 50  |...E..Z.....W;QP|
+00000390  ad bf 6b 26 19 c4 ce a2  e1 b4 34 bf a1 1a f7 ba  |..k&......4.....|
+000003a0  ec 9f 3e a1 8b 43 09 6f  a0 d4 44 87 2a d6 a0 b7  |..>..C.o..D.*...|
+000003b0  2d 20 69 fd cb a2 a3 e1  5b 39 96 5e a7 c6 49 9a  |- i.....[9.^..I.|
+000003c0  08 ad a8 16 f7 9e 9a 70  6b bb a6 15 65 66 70 bd  |.......pk...efp.|
+000003d0  9c 8d 35 b8 04 6f 70 65  e7 13 d2 0b 01 f1 59 cc  |..5..ope......Y.|
+000003e0  34 30 c7 27 f9 7d 29 3a  06 f6 65 ee b9 e1 49 03  |40.'.}):..e...I.|
+000003f0  2e 70 2a 4e 17 03 03 00  35 0a 5c ff 25 fc 85 96  |.p*N....5.\.%...|
+00000400  d3 b8 75 be 51 0b 38 79  fa 15 3d 43 f7 b2 2c d0  |..u.Q.8y..=C..,.|
+00000410  25 ae 1d 07 87 1e 62 7e  4f 6b f6 3b 3d 8c c8 0c  |%.....b~Ok.;=...|
+00000420  65 32 75 fc 02 06 ff f8  0f 5f bb 6a cf 25        |e2u......_.j.%|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 19 83 88 d2 c3 d4  |................|
-00000010  a8 98 6c 8f fa 1b 52 a5  83 58 e3 62 89 3e 22 a3  |..l...R..X.b.>".|
-00000020  37 b8 ee 13 17 03 03 00  35 b5 5f aa fd ca 85 74  |7.......5._....t|
-00000030  ee c6 06 d9 2e d8 4f 7d  87 a2 b7 20 80 a5 3b 97  |......O}... ..;.|
-00000040  41 bc 80 20 af b5 c4 66  26 2e 39 fd 81 e0 1a a0  |A.. ...f&.9.....|
-00000050  6f c3 08 d0 23 c2 27 49  91 58 77 15 2d 49        |o...#.'I.Xw.-I|
+00000000  14 03 03 00 01 01 17 03  03 00 19 29 de a5 0a f8  |...........)....|
+00000010  13 ac df 51 6b f2 e7 95  a0 4e 86 65 f9 ea 22 c8  |...Qk....N.e..".|
+00000020  16 e8 da af 17 03 03 00  35 e3 74 44 e3 b2 b1 68  |........5.tD...h|
+00000030  3b 45 79 b8 ec 67 6b 0c  1f 8d 48 77 d4 50 2c cb  |;Ey..gk...Hw.P,.|
+00000040  d1 31 f1 fa c3 7f aa 31  83 18 73 8f 8c e8 e2 de  |.1.....1..s.....|
+00000050  6a 74 1d 4d da ec 14 fc  a5 66 d9 e8 a8 de        |jt.M.....f....|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 93 10 f4 e9  f1 51 30 25 9e f0 c4 d2  |.........Q0%....|
-00000010  b8 f4 4b ad dd 89 ad ab  1a 39 88 44 98 a2 53 4e  |..K......9.D..SN|
-00000020  1c e9 bb 4a b7 c1 d8 cc  bc 76 e6 a8 e6 41 b9 42  |...J.....v...A.B|
-00000030  c8 7a 0a f4 35 73 cc 9f  9d 30 ff 4e e3 44 89 a5  |.z..5s...0.N.D..|
-00000040  d0 2b 88 36 0a 87 72 b4  bf 48 6a 4e 2e 03 1a 96  |.+.6..r..HjN....|
-00000050  1e 01 07 90 61 b0 f1 c5  58 e0 48 30 db d6 e9 5c  |....a...X.H0...\|
-00000060  88 05 0d 47 fc d1 33 6e  7e c4 fb 81 e3 80 ce 67  |...G..3n~......g|
-00000070  93 59 5e 68 39 6c b2 c3  c3 56 09 61 e5 a1 d6 d9  |.Y^h9l...V.a....|
-00000080  95 3a 70 6a 5c 4a 51 24  d9 e7 ed 88 7f 6c 32 0a  |.:pj\JQ$.....l2.|
-00000090  2d 5d 79 40 75 c9 b9 d4  17 03 03 00 1e 24 cc 07  |-]y@u........$..|
-000000a0  53 2b 27 c1 36 47 88 b8  3c 91 9e 8b 13 da 9d 3c  |S+'.6G..<......<|
-000000b0  f9 65 9d 78 ed 92 36 11  41 fe 42 17 03 03 00 13  |.e.x..6.A.B.....|
-000000c0  2b 52 80 d0 d5 39 77 77  38 ad e0 ad 78 f8 0a 59  |+R...9ww8...x..Y|
-000000d0  96 18 7e                                          |..~|
+00000000  17 03 03 00 83 a0 be b0  41 ae 6f 75 0c dc e8 a9  |........A.ou....|
+00000010  e8 cb 7a 36 0e 70 fd 88  8b 5d a0 5c 6d 08 7d c9  |..z6.p...].\m.}.|
+00000020  0b 34 73 76 d9 b0 b9 08  d7 fd dd 19 c5 27 70 7e  |.4sv.........'p~|
+00000030  80 1b 0b b0 28 c1 4b af  27 3e 4e 94 c1 2e 8e 9e  |....(.K.'>N.....|
+00000040  7c d2 22 ad 03 7f 61 c4  3e 43 db 53 82 21 e5 06  ||."...a.>C.S.!..|
+00000050  d9 fb 18 44 6b 65 3a 98  ee 46 5c 5c 5d 4c 2c 2d  |...Dke:..F\\]L,-|
+00000060  44 0d 7c a4 bc 9f 51 a0  e3 91 02 67 87 ef e2 9a  |D.|...Q....g....|
+00000070  df 83 93 f0 81 4c bd 0e  fa 19 7c b9 9d e6 c7 7f  |.....L....|.....|
+00000080  e7 6a 4b f6 70 6a f1 06  17 03 03 00 1e 8c c6 02  |.jK.pj..........|
+00000090  f9 ca a1 5d 67 a0 08 12  6a e3 0f da 01 65 12 8d  |...]g...j....e..|
+000000a0  eb 4c aa b5 e1 d7 3a ed  cb 83 82 17 03 03 00 13  |.L....:.........|
+000000b0  2c 1f b8 b8 e0 8a 45 15  d7 8a 24 1d 84 39 e3 fb  |,.....E...$..9..|
+000000c0  29 e2 39                                          |).9|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Server-TLSv13-ECDHE-ECDSA-AES
index 22909cc335..eaee1afd4a 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Server-TLSv13-ECDHE-ECDSA-AES
@@ -1,94 +1,93 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 30 09 bc 8e d5  |...........0....|
-00000010  59 36 2b f3 2b 0f 9d 32  ff 23 ba c7 4a 1f 50 e6  |Y6+.+..2.#..J.P.|
-00000020  32 bd 0e c3 f6 df b7 70  dc d5 0c 20 44 0e b7 7b  |2......p... D..{|
-00000030  a0 37 9f 1d 8d 7e 93 f7  c0 7d 25 d3 f8 e5 65 50  |.7...~...}%...eP|
-00000040  79 5e 4f 53 e5 67 40 f0  bf ad 4d f8 00 04 13 01  |y^OS.g@...M.....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 25 a1 ee b1 c5  |...........%....|
+00000010  4d ae 10 8c f3 a9 ad 40  cd 8f ff 4c 60 d1 ce 72  |M......@...L`..r|
+00000020  84 6f 9a e3 2d 1c 56 ee  62 23 d4 20 36 79 23 56  |.o..-.V.b#. 6y#V|
+00000030  3e d1 a2 d7 e6 67 2b 74  2b 77 b1 cc 30 fe fe 27  |>....g+t+w..0..'|
+00000040  27 42 61 1d c1 07 45 eb  b0 a2 db 08 00 04 13 01  |'Ba...E.........|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 23  |-.....3.&.$... #|
-000000b0  23 ab 76 3d e8 d5 1b 9f  03 71 bc bf 3d 18 3a 86  |#.v=.....q..=.:.|
-000000c0  5d 59 ee ac b9 0a 2f f6  fc 5d 13 7b 3e 88 68     |]Y..../..].{>.h|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 9e  |-.....3.&.$... .|
+000000b0  7d d0 cb f8 6b d6 c4 8f  71 b0 28 fc 34 20 de 72  |}...k...q.(.4 .r|
+000000c0  88 d6 1b 3f 57 2b b8 ff  54 6d b2 a7 ff bf 35     |...?W+..Tm....5|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 44 0e b7 7b  |........... D..{|
-00000030  a0 37 9f 1d 8d 7e 93 f7  c0 7d 25 d3 f8 e5 65 50  |.7...~...}%...eP|
-00000040  79 5e 4f 53 e5 67 40 f0  bf ad 4d f8 13 01 00 00  |y^OS.g@...M.....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 36 79 23 56  |........... 6y#V|
+00000030  3e d1 a2 d7 e6 67 2b 74  2b 77 b1 cc 30 fe fe 27  |>....g+t+w..0..'|
+00000040  27 42 61 1d c1 07 45 eb  b0 a2 db 08 13 01 00 00  |'Ba...E.........|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 2a db 0a 1b 36 73  |..........*...6s|
-00000090  de 3d 2f d9 c8 c0 2b 93  43 b3 a8 96 30 d2 bc 3d  |.=/...+.C...0..=|
-000000a0  f7 17 03 03 02 22 72 49  cc 6d 9e 7f f5 42 1c 8b  |....."rI.m...B..|
-000000b0  8a 0e 1b ad 71 f4 21 50  be ad 91 df e0 d4 a0 dc  |....q.!P........|
-000000c0  61 d2 eb 6a 39 f1 8d 31  66 9f 97 d9 b2 79 bf 10  |a..j9..1f....y..|
-000000d0  cc e1 2a 7f da 9f ff 10  22 a8 0b d6 26 c9 7c a4  |..*....."...&.|.|
-000000e0  51 8d a7 62 af 96 ec 01  72 7b 08 27 9f ff 1d a6  |Q..b....r{.'....|
-000000f0  26 54 6e 48 09 73 ac 7c  b2 bc a5 04 4e a2 41 66  |&TnH.s.|....N.Af|
-00000100  37 07 dd 7f 0d 8b 5b fa  84 a4 12 8b 44 9b b3 44  |7.....[.....D..D|
-00000110  71 bb 3a ce 95 8b a1 c5  e2 9f d2 86 0b 2b b2 43  |q.:..........+.C|
-00000120  aa 24 4c 69 0f c8 e8 7d  ff 53 2a 56 e8 dd 53 bf  |.$Li...}.S*V..S.|
-00000130  1b a7 fa 74 f2 c3 3d fa  11 b4 30 ce c0 9b 05 a5  |...t..=...0.....|
-00000140  13 b9 d1 1d a7 02 0a a6  36 31 b5 91 1f 5e 7f 65  |........61...^.e|
-00000150  24 48 3c ec fa d3 db 11  31 d1 c3 cd 47 b2 89 95  |$H<.....1...G...|
-00000160  80 55 25 1a 66 bf d9 ba  42 05 1d 20 b3 6e 09 bc  |.U%.f...B.. .n..|
-00000170  5f 1d 81 15 b2 54 c6 65  7e 75 35 e7 54 60 28 e1  |_....T.e~u5.T`(.|
-00000180  15 0e ee 51 09 3c c1 5b  ba 90 2e af 0a 85 40 0a  |...Q.<.[......@.|
-00000190  de 78 c8 c9 15 75 61 1f  75 a2 5c 80 d5 ed a5 71  |.x...ua.u.\....q|
-000001a0  a7 d8 21 f3 9c 84 f5 af  b1 5c 45 76 de a7 05 20  |..!......\Ev... |
-000001b0  7f c4 c4 71 b1 68 e0 a2  17 7f ac f8 c4 80 a8 89  |...q.h..........|
-000001c0  e8 35 68 ae 98 cf 2d 29  4e dc 84 45 21 d3 bb 0a  |.5h...-)N..E!...|
-000001d0  d8 c9 e1 41 48 b2 a8 53  31 5c 26 d0 28 9e 8e df  |...AH..S1\&.(...|
-000001e0  72 f2 ef f7 78 3d 7e b9  09 0c a4 e8 3e c5 a5 f6  |r...x=~.....>...|
-000001f0  e3 aa 32 1d da 98 7b 0a  f1 0a 42 f6 71 92 45 01  |..2...{...B.q.E.|
-00000200  e4 28 f3 c6 0f a2 cf c3  74 3b 09 f5 75 51 8e fa  |.(......t;..uQ..|
-00000210  6c 12 9e 80 2b 0a 87 fb  29 3d 0d a6 c4 7b c8 42  |l...+...)=...{.B|
-00000220  75 57 48 b3 78 20 2c b3  a1 d7 b7 6f 95 18 a2 bc  |uWH.x ,....o....|
-00000230  fd c9 22 d3 49 ae 5b 2a  ec b1 1a ff cd 38 3a bf  |..".I.[*.....8:.|
-00000240  45 e8 a8 fe 39 d5 f8 a2  89 73 7f 8f 2c 65 8a e6  |E...9....s..,e..|
-00000250  b7 20 f7 c9 5c 02 ea 33  4f f6 fc 68 2f d6 a0 d9  |. ..\..3O..h/...|
-00000260  73 10 38 35 ba d8 74 2d  cf 05 07 ee d4 fc 09 89  |s.85..t-........|
-00000270  0b 77 72 61 74 1f 16 8d  1f 29 3b 20 8d ef 99 b8  |.wrat....); ....|
-00000280  3d 80 24 5a 1d 32 9b 2e  50 4c 35 7e 4f c9 bc a7  |=.$Z.2..PL5~O...|
-00000290  6e ae 26 42 fb 4e c3 a8  7c 77 b4 c5 4c 1b 3a db  |n.&B.N..|w..L.:.|
-000002a0  cc 3f 44 fe ae d7 3f 42  5f ee 05 6a 1d 72 98 0e  |.?D...?B_..j.r..|
-000002b0  db 97 3c 11 06 c7 9e 5b  03 95 e0 52 09 54 39 b1  |..<....[...R.T9.|
-000002c0  13 19 f3 98 6c ed e3 ab  17 03 03 00 a3 49 60 43  |....l........I`C|
-000002d0  34 81 d3 6f fe c4 eb ac  49 64 51 9f 22 81 03 41  |4..o....IdQ."..A|
-000002e0  fd bc 4f 41 78 59 81 8a  82 b5 c3 06 79 8d d4 b2  |..OAxY......y...|
-000002f0  8b 9f 08 2b 09 ae 88 7d  bd 87 6a 40 19 b8 c7 1b  |...+...}..j@....|
-00000300  e1 55 69 8d 47 7a 49 66  fe 22 1f 95 c7 b5 15 ce  |.Ui.GzIf."......|
-00000310  6b d6 5b 37 45 57 72 ba  5f a3 62 49 13 80 b9 47  |k.[7EWr._.bI...G|
-00000320  9c e3 ce 6e a0 40 03 7d  41 4e 41 0d 21 ee e4 f6  |...n.@.}ANA.!...|
-00000330  71 74 12 48 1e d1 b2 80  82 b0 bf ff 07 61 04 82  |qt.H.........a..|
-00000340  db 4b 00 a1 11 97 48 1b  9b 13 b3 0e 5b 7f 99 f3  |.K....H.....[...|
-00000350  6f c1 a0 2f 41 d9 e2 30  f9 fa 0b 8a ef 6d d1 e1  |o../A..0.....m..|
-00000360  30 3d 07 5a 8a ef 8b a1  2b 44 c5 58 0d 3f 13 d7  |0=.Z....+D.X.?..|
-00000370  17 03 03 00 35 a2 fb e8  71 06 77 fa 70 66 75 01  |....5...q.w.pfu.|
-00000380  0a a0 d7 49 20 f0 8a f0  ea bf 79 20 68 46 02 43  |...I .....y hF.C|
-00000390  3c b9 cc c9 5f 1d c7 80  d8 58 f5 e3 94 6e 85 02  |<..._....X...n..|
-000003a0  c8 b2 4e a1 a2 43 b8 8d  ae 89 17 03 03 00 93 4a  |..N..C.........J|
-000003b0  dd 6b 37 b9 20 fa 51 b2  e2 60 a1 8e 08 40 bf c6  |.k7. .Q..`...@..|
-000003c0  25 22 9a 26 3a ec 35 aa  f2 26 9c bc 39 05 91 7b  |%".&:.5..&..9..{|
-000003d0  81 45 18 8d f7 f4 29 88  76 43 a8 63 e3 d3 59 d7  |.E....).vC.c..Y.|
-000003e0  2d 67 b3 4d 2f 6d c6 62  cf fd ac ed d6 80 04 57  |-g.M/m.b.......W|
-000003f0  b3 ac af 59 ce 35 43 94  1d 97 8c 2d 8d 89 b1 a7  |...Y.5C....-....|
-00000400  90 76 89 ec e4 0a 8f a9  9b 8d 22 02 8b 87 55 a4  |.v........"...U.|
-00000410  9b 55 da 85 a6 06 47 63  4c a2 1c 96 eb e1 77 35  |.U....GcL.....w5|
-00000420  71 0d 7e e5 78 ab 25 da  ee 5e ae 07 a9 ed 44 3a  |q.~.x.%..^....D:|
-00000430  75 ff 5c 4f 4e e5 01 27  7f 9e eb 63 db e2 85 70  |u.\ON..'...c...p|
-00000440  fc 99                                             |..|
+00000080  03 03 00 01 01 17 03 03  00 17 45 c7 c6 ee 18 88  |..........E.....|
+00000090  55 a3 3c 65 63 0e f5 ce  5a e8 67 ce 69 69 5e a7  |U.<ec...Z.g.ii^.|
+000000a0  b7 17 03 03 02 22 9e 58  81 63 e1 c0 2c be 8f 15  |.....".X.c..,...|
+000000b0  28 92 62 9e 09 cd 98 31  75 f5 53 3e 8a 4b 63 c0  |(.b....1u.S>.Kc.|
+000000c0  7d d5 40 5d 23 d4 c2 21  a5 8d d4 3a e8 7c 08 49  |}.@]#..!...:.|.I|
+000000d0  a3 d6 27 0c 35 a1 f2 e4  ad 21 17 69 e0 c0 7e c0  |..'.5....!.i..~.|
+000000e0  0e 53 e2 52 37 d8 1f af  32 8b 63 ec f2 05 79 9f  |.S.R7...2.c...y.|
+000000f0  97 f1 35 27 c8 89 2f 57  96 db 0c bc b9 ec 1e e5  |..5'../W........|
+00000100  f6 56 17 99 8f 9a 4d e0  a5 6d 13 14 85 d2 2c 3f  |.V....M..m....,?|
+00000110  19 96 14 5a 4e 8f 3a 23  3b ea e0 c2 42 a5 6f 64  |...ZN.:#;...B.od|
+00000120  97 77 e4 80 16 42 2d bb  15 67 3c 85 d0 90 90 ad  |.w...B-..g<.....|
+00000130  01 c0 be a5 b8 cc 91 75  18 b2 0d 54 74 73 a2 04  |.......u...Tts..|
+00000140  a3 a3 3c e2 f3 19 48 88  32 82 cb be f1 9e b0 5c  |..<...H.2......\|
+00000150  6f 1d 7e 12 76 7b 20 fe  e5 c6 8a 20 03 4d a4 51  |o.~.v{ .... .M.Q|
+00000160  0e c0 18 df 5f 26 d4 6c  1a e2 0f ec d2 f6 d0 3e  |...._&.l.......>|
+00000170  08 a1 c7 9a 6e 3b 7c 9e  f8 37 6c b8 3b ed 97 e6  |....n;|..7l.;...|
+00000180  93 0e b0 0a 41 9c a5 04  f2 1a 15 3e 3e 88 c8 ac  |....A......>>...|
+00000190  b4 14 5b 19 d8 74 ed 1c  7c 3d 67 6b 52 72 2d 7e  |..[..t..|=gkRr-~|
+000001a0  a6 27 18 38 83 31 8d c9  2f ff 19 21 c5 85 79 ff  |.'.8.1../..!..y.|
+000001b0  60 52 0f cf 9c 26 cf 71  cb e3 fd 9b fc 62 82 2a  |`R...&.q.....b.*|
+000001c0  e9 36 aa 9c 60 77 f4 f3  58 ec ef 79 14 87 2b 22  |.6..`w..X..y..+"|
+000001d0  b0 c1 be 30 39 c9 32 c7  aa 07 16 ab 7d 51 ee e4  |...09.2.....}Q..|
+000001e0  91 98 29 3b 4e 34 69 5d  da 2b 9a 4e db e4 12 87  |..);N4i].+.N....|
+000001f0  f7 13 cc 0a 6d 3e b6 16  af 41 bc b0 bf 00 54 1c  |....m>...A....T.|
+00000200  1a 02 27 d2 e6 c0 38 dc  b1 db ed 95 5a e5 61 26  |..'...8.....Z.a&|
+00000210  89 5c 16 66 8a 71 81 10  eb 19 4c e0 9b 09 94 36  |.\.f.q....L....6|
+00000220  81 f1 f7 02 04 75 13 f8  b0 05 55 09 36 ec 0c bc  |.....u....U.6...|
+00000230  1a ed 61 da 21 35 2f 73  bb 99 74 8a 82 78 9d 47  |..a.!5/s..t..x.G|
+00000240  4f f7 56 ef b5 a2 39 68  ec ba 0b 44 0f fa fb 92  |O.V...9h...D....|
+00000250  a5 b9 6c f8 25 fa 7b 44  44 2d 66 ea 09 c1 42 1d  |..l.%.{DD-f...B.|
+00000260  f5 a4 d5 c3 56 b8 b6 95  e3 60 d2 ae 96 a0 6a 80  |....V....`....j.|
+00000270  39 88 67 8a 67 d5 11 68  c8 c8 05 9c d6 b1 b2 71  |9.g.g..h.......q|
+00000280  60 63 f4 89 24 7f 52 f9  90 48 aa 83 69 1e ce 15  |`c..$.R..H..i...|
+00000290  58 f8 a5 de 5d dc c3 b1  fe 06 03 4d 4a b0 6a c7  |X...]......MJ.j.|
+000002a0  06 3b 5b e4 78 45 fe f1  ff 64 f8 c8 4a f5 71 27  |.;[.xE...d..J.q'|
+000002b0  07 96 a2 93 17 19 a5 06  89 7c b1 ff bf 46 36 5c  |.........|...F6\|
+000002c0  a4 6d 37 92 9c de 58 d1  17 03 03 00 a4 d2 c3 c6  |.m7...X.........|
+000002d0  49 c2 0e a6 e2 84 da 85  60 86 df e6 ef 41 9b 01  |I.......`....A..|
+000002e0  81 4d e3 8a 31 7f 33 ba  6a 03 68 b1 87 f6 ea 7e  |.M..1.3.j.h....~|
+000002f0  3b e5 df 71 c1 49 4f 28  85 33 47 30 00 be 2e 8f  |;..q.IO(.3G0....|
+00000300  fc c6 69 1e 99 cb 1b d6  b5 55 14 19 d5 f1 81 23  |..i......U.....#|
+00000310  97 0c 87 25 8f 34 3f d2  81 67 8d a0 3b f1 d0 70  |...%.4?..g..;..p|
+00000320  ed f6 f9 51 3f 40 68 ed  c5 3c 04 05 f0 55 00 e6  |...Q?@h..<...U..|
+00000330  7e 4f f1 2b 93 a0 0a d8  14 5e ef b9 80 25 be bc  |~O.+.....^...%..|
+00000340  42 af 20 2b 50 7f 62 a7  49 4d b9 23 d8 8f 78 08  |B. +P.b.IM.#..x.|
+00000350  fa 6a a5 10 52 36 38 d4  54 29 8c 98 99 89 fd 45  |.j..R68.T).....E|
+00000360  06 2f 42 65 f7 2f 80 2b  76 60 eb d2 0d cb a5 6f  |./Be./.+v`.....o|
+00000370  12 17 03 03 00 35 bc 0b  13 05 9b c4 d1 48 60 fb  |.....5.......H`.|
+00000380  19 bf 36 2f 91 87 0d 2e  3c 8c 73 2f 21 69 b8 26  |..6/....<.s/!i.&|
+00000390  ae 0b 02 cc 5f 28 2d b8  0c 0c 46 5b 49 a8 4d cc  |...._(-...F[I.M.|
+000003a0  42 bd dc 96 f3 92 31 2b  d3 0e e9 17 03 03 00 83  |B.....1+........|
+000003b0  08 6f fb 8e 96 73 98 ca  4a 09 27 53 b4 5c 0e 7b  |.o...s..J.'S.\.{|
+000003c0  52 f1 96 13 9f 49 85 24  6f 93 0b 06 c9 99 00 92  |R....I.$o.......|
+000003d0  b2 ea 5d 6c 57 04 56 30  98 30 c6 61 19 e0 55 b4  |..]lW.V0.0.a..U.|
+000003e0  4d a6 0a 24 c2 1f 9a cf  c0 b1 52 dc 4a 02 b4 22  |M..$......R.J.."|
+000003f0  66 5d 31 2c 20 84 66 da  9d dd 30 c7 e0 aa cf 93  |f]1, .f...0.....|
+00000400  a0 6f fb 5c 1e c0 9b 6b  b1 39 0c 18 b0 da 9b 3c  |.o.\...k.9.....<|
+00000410  8a 90 eb db ac 73 1e 32  cf b6 65 a8 c5 0c 31 49  |.....s.2..e...1I|
+00000420  13 82 04 ae 6f 49 59 a0  5a 9f d6 ad ef 65 06 b4  |....oIY.Z....e..|
+00000430  b1 dd 70                                          |..p|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 8c c8 26 94 66  |..........5..&.f|
-00000010  2e fd e0 4e bf b8 77 9d  12 d9 f6 9c 1b 15 c4 f1  |...N..w.........|
-00000020  39 f8 91 27 16 0c 34 ef  33 46 22 4e 19 d6 d0 d2  |9..'..4.3F"N....|
-00000030  ef 6b 57 91 f8 e4 17 fe  f9 ec f4 f1 ce c0 44 26  |.kW...........D&|
+00000000  14 03 03 00 01 01 17 03  03 00 35 f2 c5 54 a5 bc  |..........5..T..|
+00000010  50 73 b8 3f 08 ff aa d4  76 fc 53 ef 00 f0 a9 ce  |Ps.?....v.S.....|
+00000020  cb 1b 35 fa 81 78 10 f4  80 46 36 14 95 b2 84 0a  |..5..x...F6.....|
+00000030  be 28 5e 17 9f 35 ea 26  66 cd 60 ee 78 6b 66 07  |.(^..5.&f.`.xkf.|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e ab 4d 1a  04 59 10 8b ef f9 b5 8a  |......M..Y......|
-00000010  62 34 91 4e f9 cd 93 8c  7a 6d be d6 72 42 ad 45  |b4.N....zm..rB.E|
-00000020  21 f5 4e 17 03 03 00 13  1e bf bd 27 1a ad ab 1f  |!.N........'....|
-00000030  32 f5 99 95 dc 34 e3 eb  9c c1 1c                 |2....4.....|
+00000000  17 03 03 00 1e 51 ee 16  18 ad 74 b8 bb 1e 7c 29  |.....Q....t...|)|
+00000010  03 0d 14 9c cb d3 40 7b  5d c1 ac a4 36 d9 ad 0e  |......@{]...6...|
+00000020  bf 88 74 17 03 03 00 13  e3 8d 5a 22 53 26 58 2c  |..t.......Z"S&X,|
+00000030  3b b8 7e 93 d2 ee f9 96  41 51 61                 |;.~.....AQa|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-Ed25519 b/src/crypto/tls/testdata/Server-TLSv13-Ed25519
index a94597acc4..e19a844c6a 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-Ed25519
+++ b/src/crypto/tls/testdata/Server-TLSv13-Ed25519
@@ -1,76 +1,75 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 a1 5b 14 56 ac  |............[.V.|
-00000010  3f 2b b0 8e e9 0b ae 7e  f7 3b 3b 20 90 b6 e4 06  |?+.....~.;; ....|
-00000020  c2 b9 71 88 e4 4c 01 28  41 b3 e8 20 49 01 f7 fc  |..q..L.(A.. I...|
-00000030  ce 52 3e f4 58 60 56 7d  36 21 ba 23 87 21 f7 36  |.R>.X`V}6!.#.!.6|
-00000040  48 88 22 78 26 37 27 a4  fc 7a 8b ea 00 04 13 03  |H."x&7'..z......|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 ee 40 7e bc 51  |............@~.Q|
+00000010  b9 44 d6 ed 10 e0 d7 89  59 51 90 e8 fa b8 c5 ee  |.D......YQ......|
+00000020  5e 35 33 26 fc 69 1d f2  b3 d3 62 20 7d 94 3a 7e  |^53&.i....b }.:~|
+00000030  84 93 91 bc 1a 79 9a b9  be 6d 57 97 e0 8f 86 2b  |.....y...mW....+|
+00000040  f2 b1 7c 74 38 22 cb d5  91 e5 de 8a 00 04 13 03  |..|t8"..........|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 f4  |-.....3.&.$... .|
-000000b0  2c db e8 c0 9e 7d 52 f6  fa 33 fe f7 9a 66 ca 5f  |,....}R..3...f._|
-000000c0  a3 28 e9 80 21 28 b8 ef  e9 9f 1e 26 9c cf 0f     |.(..!(.....&...|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 c7  |-.....3.&.$... .|
+000000b0  a5 a0 44 23 d6 3c 7c 95  ed f8 65 03 db 86 9a 30  |..D#.<|...e....0|
+000000c0  14 c4 7c af 79 45 3d d5  1b 5f ab 6d 18 6a 57     |..|.yE=.._.m.jW|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 49 01 f7 fc  |........... I...|
-00000030  ce 52 3e f4 58 60 56 7d  36 21 ba 23 87 21 f7 36  |.R>.X`V}6!.#.!.6|
-00000040  48 88 22 78 26 37 27 a4  fc 7a 8b ea 13 03 00 00  |H."x&7'..z......|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 7d 94 3a 7e  |........... }.:~|
+00000030  84 93 91 bc 1a 79 9a b9  be 6d 57 97 e0 8f 86 2b  |.....y...mW....+|
+00000040  f2 b1 7c 74 38 22 cb d5  91 e5 de 8a 13 03 00 00  |..|t8"..........|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 f9 df 7b 4f f9 a1  |............{O..|
-00000090  f7 78 eb 10 59 5c 4f ed  42 09 08 10 0f c7 a4 81  |.x..Y\O.B.......|
-000000a0  8b 17 03 03 01 50 38 d7  96 35 05 7d 3d 3a 60 02  |.....P8..5.}=:`.|
-000000b0  bf 93 37 f2 60 3e 64 cb  1a 6f 9c 69 af 06 ca 70  |..7.`>d..o.i...p|
-000000c0  94 e2 d1 7f 4a 5d c7 57  0e 11 c7 4e 24 c6 ba 57  |....J].W...N$..W|
-000000d0  9f d7 67 3a 0a 8b 93 08  d4 de c5 be 62 79 61 2a  |..g:........bya*|
-000000e0  3d 4e 57 f9 98 e5 4f 5e  5a 74 52 5b a4 d0 07 ae  |=NW...O^ZtR[....|
-000000f0  8c 2a cb 50 dd b3 76 ab  3a 61 5b 55 83 8e 37 8d  |.*.P..v.:a[U..7.|
-00000100  39 e5 4f 58 7e 7a bc 80  26 f6 0f 47 8f 11 55 77  |9.OX~z..&..G..Uw|
-00000110  24 b1 a7 06 d8 d2 30 82  0d 99 39 04 5f 97 d8 1d  |$.....0...9._...|
-00000120  99 67 99 89 f0 ee 4f 18  8b 49 24 d3 6a d0 65 c9  |.g....O..I$.j.e.|
-00000130  01 a2 48 54 8b d2 bb 56  d4 0a 73 62 88 fa 70 4e  |..HT...V..sb..pN|
-00000140  7f dd 59 5b 14 7b 28 02  07 75 01 4d 41 ab 1d 7e  |..Y[.{(..u.MA..~|
-00000150  ef 24 42 ee 85 7f fa 5f  9e f0 9f f2 7f 92 00 52  |.$B...._.......R|
-00000160  ca 73 8a 73 c6 d7 13 f5  9d 31 6f 76 75 db e7 53  |.s.s.....1ovu..S|
-00000170  4d 44 40 8f 47 be bd 0e  71 13 d0 f7 f2 72 67 3a  |MD@.G...q....rg:|
-00000180  de b8 da b0 1d 84 85 d0  c2 c4 8d 16 87 68 c7 98  |.............h..|
-00000190  40 0a 92 c8 fb 8a 3a e4  7b 34 43 47 b7 4f 28 8e  |@.....:.{4CG.O(.|
-000001a0  11 01 98 88 b6 cd ca aa  d4 dc 52 5d f9 cf 55 bb  |..........R]..U.|
-000001b0  f3 13 f2 ce dc 67 74 a7  4d 5e 65 6f 18 cd 82 4e  |.....gt.M^eo...N|
-000001c0  fc 80 2c 14 17 99 08 6d  59 b3 3f 38 00 52 a2 a3  |..,....mY.?8.R..|
-000001d0  c1 98 84 15 91 82 3f e9  47 82 12 a0 94 dc 19 9e  |......?.G.......|
-000001e0  2e b7 25 79 30 b9 81 d6  9f 33 8e 49 80 7a 4c a2  |..%y0....3.I.zL.|
-000001f0  b7 9a e6 17 2c 06 17 03  03 00 59 97 c7 4b ac c3  |....,.....Y..K..|
-00000200  ed b3 bd 82 7a c2 45 a0  18 70 7b 88 fe 8b fd 6b  |....z.E..p{....k|
-00000210  83 f2 dd 77 15 74 9c f0  a6 27 22 bf ee 25 53 07  |...w.t...'"..%S.|
-00000220  81 95 3c 91 b3 89 3c ca  f9 5b c7 cf bb 32 55 f8  |..<...<..[...2U.|
-00000230  3c 76 70 f6 11 ca 5d 92  aa 78 9e 8a 2f ab e0 6f  |<vp...]..x../..o|
-00000240  c0 94 df 24 59 05 83 1a  28 c9 23 c8 e9 92 e1 bf  |...$Y...(.#.....|
-00000250  9c 90 99 07 17 03 03 00  35 4c 01 d0 d9 5f b3 6a  |........5L..._.j|
-00000260  a3 50 58 45 99 82 f4 a5  52 73 9e 7d 54 62 88 b1  |.PXE....Rs.}Tb..|
-00000270  2a 11 56 be be 57 9c 34  77 88 ab ca a6 48 c8 47  |*.V..W.4w....H.G|
-00000280  a8 25 ff 84 c6 e7 49 4e  9a dd 6f 7f 2c 4f 17 03  |.%....IN..o.,O..|
-00000290  03 00 93 72 a7 27 87 ee  0d f2 27 49 d1 8a 3f 9a  |...r.'....'I..?.|
-000002a0  4b 8c 67 72 58 b0 cf 11  24 72 44 6e e1 53 06 1f  |K.grX...$rDn.S..|
-000002b0  6a 70 ce c8 46 40 ca a0  6c fd 09 1d b1 58 2a 8f  |jp..F@..l....X*.|
-000002c0  13 37 00 3d 02 c0 a8 e2  bc 77 39 83 43 f5 c1 c5  |.7.=.....w9.C...|
-000002d0  d8 5f 32 0a 16 b1 25 4b  74 b8 b8 09 d8 c8 dd 7e  |._2...%Kt......~|
-000002e0  c7 6e 03 16 93 f2 1e a2  14 e1 ee 14 ec 8d 59 4f  |.n............YO|
-000002f0  f4 b5 50 f0 68 d3 06 ea  22 78 94 18 52 e7 3d 98  |..P.h..."x..R.=.|
-00000300  41 8c 5a bb d0 08 f7 b1  16 91 ce c9 73 41 24 e0  |A.Z.........sA$.|
-00000310  6d ea 7b e5 3f 98 9c d7  3f 91 2c 51 5a 9f ab 82  |m.{.?...?.,QZ...|
-00000320  4a f7 b7 39 f1 b5                                 |J..9..|
+00000080  03 03 00 01 01 17 03 03  00 17 34 b2 17 39 86 54  |..........4..9.T|
+00000090  2c 17 16 6f e4 38 6f 18  a3 49 12 bb b7 a2 ba 9a  |,..o.8o..I......|
+000000a0  2d 17 03 03 01 50 be e0  77 88 30 61 5c e1 bb 64  |-....P..w.0a\..d|
+000000b0  d9 07 c7 0c ec fb 79 68  c9 f2 b8 6c d7 97 4a 72  |......yh...l..Jr|
+000000c0  d6 09 70 44 d5 83 41 c2  d3 a1 d6 0d a3 f7 8a f7  |..pD..A.........|
+000000d0  c8 9c 8c 95 51 a7 e6 7c  ad 0d 70 94 43 f8 4c aa  |....Q..|..p.C.L.|
+000000e0  5a 82 26 3b 53 bd 97 57  90 05 51 56 ae 3f 6a 7f  |Z.&;S..W..QV.?j.|
+000000f0  e8 57 2f 8e bc da 19 aa  5b 1e d6 b1 dd 98 71 33  |.W/.....[.....q3|
+00000100  17 d4 b6 b7 48 07 64 fa  1c 01 a3 96 b8 5d f4 e9  |....H.d......]..|
+00000110  77 77 58 2f 49 83 0a 7d  73 9a 87 2a f8 b3 21 96  |wwX/I..}s..*..!.|
+00000120  6c 36 05 5c 7a 30 ad 26  89 ca f1 fc f4 2c c8 6d  |l6.\z0.&.....,.m|
+00000130  6b 55 97 2c 3a 7d 8e 76  37 70 16 a4 37 45 cd f3  |kU.,:}.v7p..7E..|
+00000140  cf 7b c0 9e 70 93 c1 8e  ac a9 37 a9 66 1e f5 5b  |.{..p.....7.f..[|
+00000150  34 8e ba bc 36 4f 9b d6  f3 82 90 36 8e aa e5 4a  |4...6O.....6...J|
+00000160  34 12 52 76 c0 b8 46 76  d1 43 e8 0b 3a 93 58 95  |4.Rv..Fv.C..:.X.|
+00000170  32 7d a0 7a dc 93 f8 23  ce 53 b8 39 77 56 1e e2  |2}.z...#.S.9wV..|
+00000180  60 08 d7 76 f5 d5 b1 8b  45 9c 0e b0 6a 96 21 8f  |`..v....E...j.!.|
+00000190  c0 4c 5f a7 e0 dd aa 63  28 a9 4c 5b b2 a3 57 88  |.L_....c(.L[..W.|
+000001a0  66 7c 7e 60 14 5f 21 ee  2e ff 8e 3e 66 f2 60 ed  |f|~`._!....>f.`.|
+000001b0  b3 0f f7 7e f2 6c e2 3c  9c 5e 20 d9 5b 98 64 22  |...~.l.<.^ .[.d"|
+000001c0  bb 0c 1d bf 7a 92 7b 19  ed 95 6d c9 14 13 6d 19  |....z.{...m...m.|
+000001d0  ef 17 6a 65 cf 66 16 99  ce 21 a0 a5 ed 1f 4c de  |..je.f...!....L.|
+000001e0  fd 78 13 f2 7e e5 ae 2c  c2 05 1d 54 97 8a f9 3e  |.x..~..,...T...>|
+000001f0  c7 42 05 bf dd 9c 17 03  03 00 59 c4 d3 c1 57 11  |.B........Y...W.|
+00000200  07 55 6b 59 4d b3 82 78  cb d2 84 4c bf 60 99 6c  |.UkYM..x...L.`.l|
+00000210  f6 91 33 2e 17 d5 e0 cc  3f 64 ac 9f 21 b0 a7 e4  |..3.....?d..!...|
+00000220  80 77 44 67 8d fc 47 fe  18 38 36 11 ec f8 2d 50  |.wDg..G..86...-P|
+00000230  65 bd 75 c1 30 a2 74 5b  dd 88 be 3a 4b 00 ec 33  |e.u.0.t[...:K..3|
+00000240  08 e5 66 ed 72 2d f2 af  63 52 14 c6 01 ad e4 95  |..f.r-..cR......|
+00000250  a0 00 f8 a3 17 03 03 00  35 75 fd a6 02 da 42 c0  |........5u....B.|
+00000260  4f b4 88 d7 4b fb 5c 91  db 10 6a 4e ea c6 8e f1  |O...K.\...jN....|
+00000270  a7 e1 01 1b 10 fa 1e a7  63 f2 5c e8 c0 fa 45 1d  |........c.\...E.|
+00000280  39 6c 2a 10 38 2b bc 56  e3 a1 c4 25 44 ad 17 03  |9l*.8+.V...%D...|
+00000290  03 00 83 21 cb b0 16 f1  86 1a 5b 31 8d f8 17 ec  |...!......[1....|
+000002a0  08 ce 00 ed b4 ec 95 27  79 c0 2a 0a 52 d6 7e 74  |.......'y.*.R.~t|
+000002b0  68 74 87 f9 7e b5 c5 10  96 62 b3 0d 7c 0b 83 b7  |ht..~....b..|...|
+000002c0  ac d8 bc 28 68 64 e5 01  e7 89 92 15 25 dc 0d 4a  |...(hd......%..J|
+000002d0  ee 0c 80 ba 17 dd cd e6  63 c6 b4 e7 6f 86 91 71  |........c...o..q|
+000002e0  82 85 ba d0 86 ca 86 6f  ad 62 26 b9 29 b0 0c 98  |.......o.b&.)...|
+000002f0  a5 3a 51 2a 8c 2a 9d c0  25 6f d9 12 36 2d a3 ba  |.:Q*.*..%o..6-..|
+00000300  e4 42 5f 82 66 3a 21 a0  4b 4b d4 31 2a 12 c7 af  |.B_.f:!.KK.1*...|
+00000310  c6 e2 35 0e 1b 73                                 |..5..s|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 19 fa 19 c0 ce  |..........5.....|
-00000010  09 87 c2 06 69 56 2a 0a  a7 9c 79 76 03 1b 70 5e  |....iV*...yv..p^|
-00000020  56 2d d4 a1 09 e3 99 f7  a9 7a e5 ba 3e 17 8b b2  |V-.......z..>...|
-00000030  fe da 70 81 d9 30 83 27  b1 da 2e df da 94 75 72  |..p..0.'......ur|
+00000000  14 03 03 00 01 01 17 03  03 00 35 09 e3 19 28 82  |..........5...(.|
+00000010  50 d3 a7 97 48 e5 41 8b  67 cc 60 d4 e9 eb ab d3  |P...H.A.g.`.....|
+00000020  d0 3d 51 f3 c8 4f 7b 40  98 f3 93 ab 3b ca 77 4e  |.=Q..O{@....;.wN|
+00000030  2f 51 a6 dd 5e 96 43 59  a4 18 43 b9 ee 80 3c 77  |/Q..^.CY..C...<w|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 83 53 ed  09 07 d3 87 ab 37 a2 08  |......S......7..|
-00000010  a8 50 66 87 97 54 04 38  4b a6 25 f8 ab 75 ac 39  |.Pf..T.8K.%..u.9|
-00000020  52 e2 8d 17 03 03 00 13  86 58 ef 44 c1 59 5e 2e  |R........X.D.Y^.|
-00000030  e4 2e df 93 6e 52 76 58  c1 9d 2a                 |....nRvX..*|
+00000000  17 03 03 00 1e 26 91 a6  f0 53 5b a6 8e 25 81 db  |.....&...S[..%..|
+00000010  dd 93 3f 9f 61 b1 b7 d2  be 48 7c 7e 99 23 78 c8  |..?.a....H|~.#x.|
+00000020  f2 0c 3c 17 03 03 00 13  3b 0b 8e c6 1d 85 28 f0  |..<.....;.....(.|
+00000030  23 bb 7b 0b 0a 11 ad 42  4e 9f 0a                 |#.{....BN..|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ExportKeyingMaterial b/src/crypto/tls/testdata/Server-TLSv13-ExportKeyingMaterial
index 8267ca0f9e..c85f62db21 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ExportKeyingMaterial
+++ b/src/crypto/tls/testdata/Server-TLSv13-ExportKeyingMaterial
@@ -1,99 +1,98 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ce 01 00 00  ca 03 03 26 86 8d 61 97  |...........&..a.|
-00000010  6c da 93 d7 43 5c b3 0c  06 5c c2 cb e0 89 46 9f  |l...C\...\....F.|
-00000020  cc b0 a3 cf 41 3d cf 7a  9e 02 bc 20 a6 33 fe 0b  |....A=.z... .3..|
-00000030  90 24 8b ed 69 48 86 9b  d2 1a 5c 04 66 52 4f 5d  |.$..iH....\.fRO]|
-00000040  a4 24 6b d2 84 08 c0 48  a9 55 ef 0c 00 04 13 03  |.$k....H.U......|
+00000000  16 03 01 00 ce 01 00 00  ca 03 03 a7 10 27 b6 49  |.............'.I|
+00000010  04 9a 96 8a b3 02 f5 f3  b9 e2 04 f1 32 07 57 06  |............2.W.|
+00000020  3b 5e c0 f1 81 ef d6 1b  34 38 41 20 7c 3c 3a 55  |;^......48A |<:U|
+00000030  f6 03 a5 5a 46 6f 65 99  29 77 f6 d3 5c 36 7b 51  |...ZFoe.)w..\6{Q|
+00000040  37 d2 42 a5 e2 f5 0f 13  36 84 52 12 00 04 13 03  |7.B.....6.R.....|
 00000050  00 ff 01 00 00 7d 00 0b  00 04 03 00 01 02 00 0a  |.....}..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 16 00 00 00 17  00 00 00 0d 00 1e 00 1c  |................|
 00000080  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000090  08 04 08 05 08 06 04 01  05 01 06 01 00 2b 00 03  |.............+..|
 000000a0  02 03 04 00 2d 00 02 01  01 00 33 00 26 00 24 00  |....-.....3.&.$.|
-000000b0  1d 00 20 b9 ab 39 93 6b  9f aa 46 0a 61 c6 f8 58  |.. ..9.k..F.a..X|
-000000c0  45 26 16 6f b6 cb 42 52  e8 24 ab cc a4 2d b6 7a  |E&.o..BR.$...-.z|
-000000d0  a5 90 67                                          |..g|
+000000b0  1d 00 20 92 2d 8e e2 e4  8a 0c 1a 27 d5 40 04 2a  |.. .-......'.@.*|
+000000c0  64 7b 77 3c a5 f6 2d 27  e5 28 05 a6 b8 4d bf 99  |d{w<..-'.(...M..|
+000000d0  a0 17 6a                                          |..j|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 a6 33 fe 0b  |........... .3..|
-00000030  90 24 8b ed 69 48 86 9b  d2 1a 5c 04 66 52 4f 5d  |.$..iH....\.fRO]|
-00000040  a4 24 6b d2 84 08 c0 48  a9 55 ef 0c 13 03 00 00  |.$k....H.U......|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 7c 3c 3a 55  |........... |<:U|
+00000030  f6 03 a5 5a 46 6f 65 99  29 77 f6 d3 5c 36 7b 51  |...ZFoe.)w..\6{Q|
+00000040  37 d2 42 a5 e2 f5 0f 13  36 84 52 12 13 03 00 00  |7.B.....6.R.....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 e9 4c 8a ed 0c af  |...........L....|
-00000090  04 d2 18 14 38 48 c1 71  da 59 db 46 f4 00 0d 19  |....8H.q.Y.F....|
-000000a0  1e 17 03 03 02 6d e0 d2  7b bf 0a 51 48 a9 67 46  |.....m..{..QH.gF|
-000000b0  25 3b 07 e9 68 da 4d cf  47 31 0f 7d ad 4e 0d 6d  |%;..h.M.G1.}.N.m|
-000000c0  c3 ad 03 61 4a c0 ae 06  4d b7 84 29 1b 44 49 26  |...aJ...M..).DI&|
-000000d0  f4 99 fc 58 1e 5b f0 15  ee be 19 c3 b3 23 20 f0  |...X.[.......# .|
-000000e0  7a 10 e4 ab c8 00 f6 e4  93 d6 b3 2a fd 14 10 c9  |z..........*....|
-000000f0  72 b2 21 ba 93 50 08 4e  d2 1f 3f 64 68 73 3c c7  |r.!..P.N..?dhs<.|
-00000100  11 3c f5 84 61 b0 2c 84  42 0c ef a9 03 a2 74 aa  |.<..a.,.B.....t.|
-00000110  3b 07 e0 d5 f5 c4 d1 a8  8e f5 64 0e 52 41 b1 4d  |;.........d.RA.M|
-00000120  aa 43 0d f3 6b 0c 19 36  66 fe 4c 73 cd 52 03 2f  |.C..k..6f.Ls.R./|
-00000130  61 f1 9d 23 12 e2 b9 69  d9 48 92 07 1b 5d 6f 28  |a..#...i.H...]o(|
-00000140  e1 96 39 d8 59 19 9d 9c  bf 99 3a af 03 68 bd 34  |..9.Y.....:..h.4|
-00000150  38 04 9d 8c 9a bf 75 67  74 dd 9c eb 89 13 6d 55  |8.....ugt.....mU|
-00000160  b4 c4 17 11 05 54 d7 f9  d7 5a ed ec d5 15 31 5e  |.....T...Z....1^|
-00000170  2f ed 69 fa 99 23 57 e3  62 98 35 27 17 34 e1 c4  |/.i..#W.b.5'.4..|
-00000180  3c 95 3f 69 de 01 aa a9  66 55 4a 40 3a f1 4f 19  |<.?i....fUJ@:.O.|
-00000190  02 2f df 51 0c 69 ec 48  7a 60 f7 72 5e f6 f0 4d  |./.Q.i.Hz`.r^..M|
-000001a0  a1 b2 7a 06 df 69 a1 19  42 29 56 5c 67 99 3d 0e  |..z..i..B)V\g.=.|
-000001b0  5d da df 7b 93 8e 9a 26  6e 2e 09 c4 30 40 ad a9  |]..{...&n...0@..|
-000001c0  ee 4b bd 21 41 b6 cb fc  97 0f fc a2 cf 26 31 d6  |.K.!A........&1.|
-000001d0  d6 77 96 4e c6 a2 fd 5a  0e cb d5 31 a6 21 e8 76  |.w.N...Z...1.!.v|
-000001e0  a2 48 4d 43 d4 c9 18 b2  21 cc 13 13 84 f2 c2 cf  |.HMC....!.......|
-000001f0  60 8f 2e 36 39 8a a8 26  03 1d 51 24 b4 08 c5 5d  |`..69..&..Q$...]|
-00000200  96 b9 4a 46 02 41 1f 59  ea 47 a9 37 bc a0 c4 70  |..JF.A.Y.G.7...p|
-00000210  26 d6 8c 11 62 45 1d 92  5d ea 39 cd af af 13 38  |&...bE..].9....8|
-00000220  85 ca a8 74 1a 09 07 f2  7c d6 49 0d 2d ad 1c 9f  |...t....|.I.-...|
-00000230  db 8b 56 91 45 51 32 db  ca 9c f4 d2 72 09 8a fe  |..V.EQ2.....r...|
-00000240  98 9e a8 b5 b2 49 9c 0b  e9 3a 42 d0 53 e0 20 6c  |.....I...:B.S. l|
-00000250  e3 07 36 ef cc 85 56 fd  b4 6e ff d2 7c 96 52 27  |..6...V..n..|.R'|
-00000260  46 c9 3c b3 bf fb 16 0b  61 54 09 9c ac 3b 18 5f  |F.<.....aT...;._|
-00000270  5a 01 4b 25 67 22 ef 19  86 a3 3a 80 f0 12 f5 60  |Z.K%g"....:....`|
-00000280  4c 77 cf bd a9 e8 a1 19  d4 8c e1 a8 b2 b8 19 b8  |Lw..............|
-00000290  98 85 c3 da 1a b8 4d 6e  1f 35 73 28 32 3c a0 44  |......Mn.5s(2<.D|
-000002a0  c9 77 46 b8 c6 54 4d 80  67 72 58 c4 e3 0b f3 6c  |.wF..TM.grX....l|
-000002b0  43 eb e2 89 f1 30 cc 90  b4 e9 b8 ec e2 5f c1 31  |C....0......._.1|
-000002c0  a2 de 9d e9 fe 9c fe b0  83 b7 aa e9 2e 62 35 89  |.............b5.|
-000002d0  90 0d 36 79 8f 23 bb 7a  ae dc db db 1c c3 96 5d  |..6y.#.z.......]|
-000002e0  7c 06 e9 1c ee 82 58 46  7c 1b 90 9d cf 2d 31 54  ||.....XF|....-1T|
-000002f0  96 94 58 dc 95 26 85 c7  f4 c9 9c 2b 8a 2f ae b3  |..X..&.....+./..|
-00000300  70 10 bf f1 0e 66 ef f1  1c 66 da 6c 52 d8 6e aa  |p....f...f.lR.n.|
-00000310  3a 14 d8 17 03 03 00 99  69 45 ee c3 c9 b3 4d 9a  |:.......iE....M.|
-00000320  01 00 70 27 54 8c 12 bb  74 67 e8 88 07 ac 4e ab  |..p'T...tg....N.|
-00000330  b1 41 f4 65 ee 3b 06 87  79 5d 9b 1d 70 df 2f f7  |.A.e.;..y]..p./.|
-00000340  e0 88 45 2b a1 b9 ca 67  88 65 65 33 51 41 c0 b2  |..E+...g.ee3QA..|
-00000350  da 6a 7a 7c bf 42 58 8d  ae 7b 24 d0 8a f7 47 c0  |.jz|.BX..{$...G.|
-00000360  a9 45 da 24 82 03 a1 65  03 7c 3c 2a bf 48 e2 0d  |.E.$...e.|<*.H..|
-00000370  fa cc 3f 00 53 63 5d f9  b4 a1 00 d2 a7 3c 81 64  |..?.Sc]......<.d|
-00000380  8a d5 90 4f b9 58 2b 1e  1d a7 7e ad 3e 8f d4 4a  |...O.X+...~.>..J|
-00000390  7b 66 b7 4e 68 04 ac 66  24 6e 76 ed f4 5c aa 52  |{f.Nh..f$nv..\.R|
-000003a0  3d f8 f5 ea d0 0a 74 ba  39 da 21 e0 f1 03 80 cd  |=.....t.9.!.....|
-000003b0  5b 17 03 03 00 35 7b 1f  6e 37 6c 15 5b 1b f7 ea  |[....5{.n7l.[...|
-000003c0  bf 03 68 5f 15 1f e7 99  a8 64 f1 60 3d e0 b6 5e  |..h_.....d.`=..^|
-000003d0  c1 60 18 61 e5 ea dc ab  b5 d3 5f 10 1b 5c 3a 1b  |.`.a......_..\:.|
-000003e0  c5 fe a6 d3 fc 45 6b db  b1 27 60 17 03 03 00 93  |.....Ek..'`.....|
-000003f0  e3 f1 5f f1 18 a6 ab 67  88 e4 5a f9 fd 71 77 4b  |.._....g..Z..qwK|
-00000400  6c 0d 98 ef 71 72 2a aa  d2 0a 2d 72 ac 40 57 2d  |l...qr*...-r.@W-|
-00000410  73 ad 77 cd 01 19 19 be  e7 49 d4 6a aa 97 f9 40  |s.w......I.j...@|
-00000420  b1 85 cc bb 5c 57 1a 17  a8 48 65 d3 4d e9 a9 29  |....\W...He.M..)|
-00000430  4b 08 6b b3 33 2c 97 d0  89 0a 50 e2 66 06 c6 63  |K.k.3,....P.f..c|
-00000440  c3 6f 8d 5e ab a4 af 7a  6a 5e 25 8d 4a 17 ea aa  |.o.^...zj^%.J...|
-00000450  67 8a ad af c3 1e d6 47  db a5 b5 db 32 1b 83 f8  |g......G....2...|
-00000460  2d f9 bc 99 28 07 0d d0  fe 34 bf 52 ae 59 27 40  |-...(....4.R.Y'@|
-00000470  cd 0e 4d 4d 12 28 21 01  30 38 b1 c3 df 63 e9 9e  |..MM.(!.08...c..|
-00000480  34 91 84                                          |4..|
+00000080  03 03 00 01 01 17 03 03  00 17 fd 2a 88 8c e8 f7  |...........*....|
+00000090  59 74 7b 10 ea 48 c8 42  c0 50 ed 5f 78 fe bf 31  |Yt{..H.B.P._x..1|
+000000a0  28 17 03 03 02 6d 59 00  c3 1a f8 e1 b6 22 ae a2  |(....mY......"..|
+000000b0  7f 83 ba b1 da b7 80 08  cf 71 91 a9 42 10 bb e8  |.........q..B...|
+000000c0  5c 15 59 61 6b 68 47 06  85 3a 1a 32 a4 34 e9 55  |\.YakhG..:.2.4.U|
+000000d0  a7 4e 5e 24 44 b4 5b 08  ef 3d a3 e5 5e 78 ca bd  |.N^$D.[..=..^x..|
+000000e0  e0 6c ac 94 b1 3e ee 4f  31 53 23 83 a4 c4 3f 37  |.l...>.O1S#...?7|
+000000f0  b7 2f 9c 6b f5 4a 15 e1  ca 28 c6 30 46 e5 ff d1  |./.k.J...(.0F...|
+00000100  2e 92 7b 5c 4f 3c 5b 85  0d be 38 a7 52 e4 6f e0  |..{\O<[...8.R.o.|
+00000110  80 09 e7 10 13 5d 78 11  e3 d2 c0 d0 37 32 8c 25  |.....]x.....72.%|
+00000120  6d 11 c3 57 ad 84 14 26  7d 10 a1 54 f3 f9 52 60  |m..W...&}..T..R`|
+00000130  21 f2 0c 83 6a 78 e9 ac  e1 0e 32 13 0b 73 fa 8f  |!...jx....2..s..|
+00000140  19 52 9c e6 0b bb aa 53  5c 5e ee ae 99 fc a9 8c  |.R.....S\^......|
+00000150  41 cf a4 bf 7a 98 34 8c  75 42 77 11 28 fa 5b 55  |A...z.4.uBw.(.[U|
+00000160  74 b6 f8 ec d9 a7 63 d3  fa 15 de ba 62 ad 35 8b  |t.....c.....b.5.|
+00000170  d8 d5 93 a2 77 18 f0 0a  a8 e3 00 f3 b6 0b 53 75  |....w.........Su|
+00000180  2a 6e 5d 61 93 b8 13 ed  23 6e f4 d9 5d dd d1 32  |*n]a....#n..]..2|
+00000190  87 de c3 6f 60 6f e8 50  66 0f 21 d5 88 4f d7 d1  |...o`o.Pf.!..O..|
+000001a0  30 20 48 e2 c2 29 e5 83  17 e5 c9 6c c9 0c 69 d6  |0 H..).....l..i.|
+000001b0  bb 0f bb a2 01 f6 ee 7d  b6 ba 8b 68 38 15 73 08  |.......}...h8.s.|
+000001c0  32 39 7d 5a 6a 3d 80 54  ce 64 81 46 36 a5 ed d7  |29}Zj=.T.d.F6...|
+000001d0  f9 e5 a4 88 c2 03 f5 2b  be 35 e5 06 8a 12 50 7d  |.......+.5....P}|
+000001e0  f3 cb d8 e1 48 bb c5 78  56 21 b5 33 2b cf 8e 4a  |....H..xV!.3+..J|
+000001f0  fe c1 af 6d d3 9d 75 2f  a3 c5 62 fb 36 d5 67 09  |...m..u/..b.6.g.|
+00000200  29 61 0c 5c 97 98 f4 77  9f ef 50 ed a8 80 12 15  |)a.\...w..P.....|
+00000210  5b ac a1 c7 2c 2f 6c 76  c0 18 d3 4b 04 61 fc 4b  |[...,/lv...K.a.K|
+00000220  ff 0d a7 c0 3a 0b f0 9f  d3 8e 53 fb 60 e0 27 55  |....:.....S.`.'U|
+00000230  9d 1f 28 40 81 cd c1 38  67 a4 11 a4 13 72 83 a1  |..(@...8g....r..|
+00000240  ed c8 b9 77 77 bd d8 84  b3 43 9f 9d 85 0c c2 8c  |...ww....C......|
+00000250  89 fc e4 1a 05 aa 27 0d  c6 ce a2 0c b4 d9 23 ba  |......'.......#.|
+00000260  24 21 19 fa c2 c5 d4 a9  4d 26 ea 21 2b 4d 4b 8d  |$!......M&.!+MK.|
+00000270  f4 43 83 91 5e 1c 7b 27  c3 e0 c6 1e 01 43 8f cd  |.C..^.{'.....C..|
+00000280  a8 f7 65 fb 1a c8 7b 27  d3 bf cf 17 76 a9 3b 7d  |..e...{'....v.;}|
+00000290  37 fc e0 4b 8d 90 f7 ac  dc f0 2c 5c 5b 03 b3 9b  |7..K......,\[...|
+000002a0  ec 27 00 c1 9a 73 85 60  5f 6b 85 16 13 b6 5c 0e  |.'...s.`_k....\.|
+000002b0  ca f5 5b 77 96 55 7a e4  a2 72 0a 38 d2 8b 20 a2  |..[w.Uz..r.8.. .|
+000002c0  33 cb 0d 7a ab ef 5b 4b  f7 b8 31 12 07 63 a5 fe  |3..z..[K..1..c..|
+000002d0  32 8b 7a 6e 41 08 a3 76  37 95 21 c4 36 75 f3 60  |2.znA..v7.!.6u.`|
+000002e0  7e b9 54 5c 1b fb b7 14  5c ba 44 a0 c7 b4 db 0b  |~.T\....\.D.....|
+000002f0  38 8e 44 29 c1 fe f3 4c  1c 62 e5 ba 78 93 9c a1  |8.D)...L.b..x...|
+00000300  9f fa 69 2d 62 53 f7 49  76 2e 2b c8 bf 83 b6 ec  |..i-bS.Iv.+.....|
+00000310  42 7e 95 17 03 03 00 99  48 21 3d 9a 74 61 1f 21  |B~......H!=.ta.!|
+00000320  ef cd 27 5a df 70 2e 64  95 42 9e 5c bc ae ab c5  |..'Z.p.d.B.\....|
+00000330  6b 76 cd b9 ac cb c1 b2  f1 17 fc 66 09 65 02 7b  |kv.........f.e.{|
+00000340  52 6e 4c 0d a7 26 ab b5  d6 62 eb 3f db 63 3f 90  |RnL..&...b.?.c?.|
+00000350  29 be 91 91 47 56 86 71  f8 b4 45 00 f0 f2 2b 7e  |)...GV.q..E...+~|
+00000360  0b 65 37 91 ee d1 ab e2  d7 3f 6a 42 08 e7 c0 79  |.e7......?jB...y|
+00000370  8f 55 3e 4f dc b9 e6 ff  46 ad 8a 5b 89 91 91 fb  |.U>O....F..[....|
+00000380  44 ac 3c 22 ac 18 d9 03  68 26 ab 71 4c 46 88 0c  |D.<"....h&.qLF..|
+00000390  e0 50 0b c1 d0 1a 38 73  3b e5 12 95 a4 5a 47 3c  |.P....8s;....ZG<|
+000003a0  f2 8c 98 b5 38 39 b1 e9  37 ed da 37 d1 ba 1d e9  |....89..7..7....|
+000003b0  d9 17 03 03 00 35 2a b3  e7 51 57 c7 37 15 79 09  |.....5*..QW.7.y.|
+000003c0  bd 95 2a 87 be ee 55 0d  fa db c6 92 f3 98 af 8f  |..*...U.........|
+000003d0  3c 84 00 fb ae 7d 2f ad  e3 e9 41 c0 ba 2e 7a 0b  |<....}/...A...z.|
+000003e0  73 a4 87 d4 c9 07 83 eb  15 57 cc 17 03 03 00 83  |s........W......|
+000003f0  97 ec bd 03 76 91 79 b6  9f fb fa 7f 48 9c f3 10  |....v.y.....H...|
+00000400  e6 28 8a cf f5 2e 52 b8  1b 6c f6 ab 32 62 a2 92  |.(....R..l..2b..|
+00000410  c5 22 69 ee 4e 8a 41 fb  1e 3f bf 7b 0a 11 1f 72  |."i.N.A..?.{...r|
+00000420  0f 2d d7 a9 43 71 b8 4b  4f 3a 83 e8 32 b1 ce 5e  |.-..Cq.KO:..2..^|
+00000430  ca a3 fe df 36 83 57 55  13 69 eb 8a 93 73 11 45  |....6.WU.i...s.E|
+00000440  e8 03 1c 1a c7 39 cf 42  ac d6 37 44 cb b4 c0 5c  |.....9.B..7D...\|
+00000450  bd da 23 37 92 95 54 25  c8 8f 5e 4f cf 6f f3 e5  |..#7..T%..^O.o..|
+00000460  0e e8 b7 8e d9 14 47 0d  29 1b 85 94 82 89 81 6c  |......G.)......l|
+00000470  f8 41 1f                                          |.A.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 1d d8 d0 a8 ec  |..........5.....|
-00000010  04 45 13 43 a1 72 38 4e  54 85 7a a2 17 dc eb 39  |.E.C.r8NT.z....9|
-00000020  36 7d 50 25 5f d3 0d 7f  c3 a7 75 93 e9 1e 17 0a  |6}P%_.....u.....|
-00000030  a3 d7 a8 74 23 98 5e 3a  3a 4c 2c d3 78 b4 04 48  |...t#.^::L,.x..H|
+00000000  14 03 03 00 01 01 17 03  03 00 35 f9 6a 29 1b a1  |..........5.j)..|
+00000010  91 68 7a 29 e5 2b 80 32  df 22 27 47 25 32 cc 66  |.hz).+.2."'G%2.f|
+00000020  19 14 92 24 99 be b0 00  bf dc 0c 0a a2 e1 04 ac  |...$............|
+00000030  b8 c2 b9 37 3e 22 07 7d  d3 f5 a7 fc 16 3f 80 db  |...7>".}.....?..|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 53 e2 0d  f2 62 e8 be 84 e0 33 1a  |.....S...b....3.|
-00000010  56 bc 45 f9 0b 69 63 72  03 f3 34 c6 72 d8 f9 c4  |V.E..icr..4.r...|
-00000020  ba 53 3d 17 03 03 00 13  11 b5 0d 7f d4 e7 51 90  |.S=...........Q.|
-00000030  39 be 2b d8 d6 7c e8 12  ea 61 83                 |9.+..|...a.|
+00000000  17 03 03 00 1e cd 59 4f  27 60 f7 93 c7 d2 7c 5b  |......YO'`....|[|
+00000010  f3 70 0a 6d 1d 0f 4c 41  1f b9 76 f4 07 93 b0 d8  |.p.m..LA..v.....|
+00000020  a2 59 bf 17 03 03 00 13  c6 cd a8 7b de 92 68 eb  |.Y.........{..h.|
+00000030  66 c6 14 87 2b b6 ee 84  eb ec 28                 |f...+.....(|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-HelloRetryRequest b/src/crypto/tls/testdata/Server-TLSv13-HelloRetryRequest
index 95eefd29be..bb60cdeef9 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-HelloRetryRequest
+++ b/src/crypto/tls/testdata/Server-TLSv13-HelloRetryRequest
@@ -1,123 +1,122 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 c4 01 00 00  c0 03 03 16 5e f5 e2 4e  |............^..N|
-00000010  27 ce 8e 88 0b e9 13 6d  12 a6 6d 27 c9 ab 95 47  |'......m..m'...G|
-00000020  6f 9d 5d a0 92 64 35 c1  b6 70 90 20 ff 47 6f 67  |o.]..d5..p. .Gog|
-00000030  69 49 88 2a 84 69 79 48  fe cc 92 db 6e 9e ab 47  |iI.*.iyH....n..G|
-00000040  8e 47 10 58 db ad 22 8e  da bb 86 e6 00 04 13 03  |.G.X..".........|
+00000000  16 03 01 00 c4 01 00 00  c0 03 03 aa 3e c9 0b 99  |............>...|
+00000010  f0 27 92 d6 73 d5 6a a9  19 b2 71 4f f5 3a 02 19  |.'..s.j...qO.:..|
+00000020  e5 a2 3e f9 7b f0 bd c8  d9 0f 0a 20 c9 1e b8 0e  |..>.{...... ....|
+00000030  53 68 a6 ac 7d 3a 74 c9  1b 4f 65 52 a0 23 da d5  |Sh..}:t..OeR.#..|
+00000040  ca 87 09 43 39 79 ba c0  47 a9 44 b5 00 04 13 03  |...C9y..G.D.....|
 00000050  00 ff 01 00 00 73 00 0b  00 04 03 00 01 02 00 0a  |.....s..........|
 00000060  00 06 00 04 00 1d 00 17  00 16 00 00 00 17 00 00  |................|
 00000070  00 0d 00 1e 00 1c 04 03  05 03 06 03 08 07 08 08  |................|
 00000080  08 09 08 0a 08 0b 08 04  08 05 08 06 04 01 05 01  |................|
 00000090  06 01 00 2b 00 03 02 03  04 00 2d 00 02 01 01 00  |...+......-.....|
-000000a0  33 00 26 00 24 00 1d 00  20 7e a4 de 34 df 01 99  |3.&.$... ~..4...|
-000000b0  37 77 f7 de 6a e2 79 e7  63 eb 86 6c 62 61 fd b0  |7w..j.y.c..lba..|
-000000c0  c6 95 04 c8 63 29 cd 32  00                       |....c).2.|
+000000a0  33 00 26 00 24 00 1d 00  20 40 48 36 e0 4d ce ac  |3.&.$... @H6.M..|
+000000b0  2c cc af f0 2e f1 e4 b8  a1 33 be fb bf ad 5d a7  |,........3....].|
+000000c0  4b 00 4a 4f c1 16 1e 9a  25                       |K.JO....%|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 58 02 00 00  54 03 03 cf 21 ad 74 e5  |....X...T...!.t.|
 00000010  9a 61 11 be 1d 8c 02 1e  65 b8 91 c2 a2 11 16 7a  |.a......e......z|
-00000020  bb 8c 5e 07 9e 09 e2 c8  a8 33 9c 20 ff 47 6f 67  |..^......3. .Gog|
-00000030  69 49 88 2a 84 69 79 48  fe cc 92 db 6e 9e ab 47  |iI.*.iyH....n..G|
-00000040  8e 47 10 58 db ad 22 8e  da bb 86 e6 13 03 00 00  |.G.X..".........|
+00000020  bb 8c 5e 07 9e 09 e2 c8  a8 33 9c 20 c9 1e b8 0e  |..^......3. ....|
+00000030  53 68 a6 ac 7d 3a 74 c9  1b 4f 65 52 a0 23 da d5  |Sh..}:t..OeR.#..|
+00000040  ca 87 09 43 39 79 ba c0  47 a9 44 b5 13 03 00 00  |...C9y..G.D.....|
 00000050  0c 00 2b 00 02 03 04 00  33 00 02 00 17 14 03 03  |..+.....3.......|
 00000060  00 01 01                                          |...|
 >>> Flow 3 (client to server)
 00000000  14 03 03 00 01 01 16 03  03 00 e5 01 00 00 e1 03  |................|
-00000010  03 16 5e f5 e2 4e 27 ce  8e 88 0b e9 13 6d 12 a6  |..^..N'......m..|
-00000020  6d 27 c9 ab 95 47 6f 9d  5d a0 92 64 35 c1 b6 70  |m'...Go.]..d5..p|
-00000030  90 20 ff 47 6f 67 69 49  88 2a 84 69 79 48 fe cc  |. .GogiI.*.iyH..|
-00000040  92 db 6e 9e ab 47 8e 47  10 58 db ad 22 8e da bb  |..n..G.G.X.."...|
-00000050  86 e6 00 04 13 03 00 ff  01 00 00 94 00 0b 00 04  |................|
+00000010  03 aa 3e c9 0b 99 f0 27  92 d6 73 d5 6a a9 19 b2  |..>....'..s.j...|
+00000020  71 4f f5 3a 02 19 e5 a2  3e f9 7b f0 bd c8 d9 0f  |qO.:....>.{.....|
+00000030  0a 20 c9 1e b8 0e 53 68  a6 ac 7d 3a 74 c9 1b 4f  |. ....Sh..}:t..O|
+00000040  65 52 a0 23 da d5 ca 87  09 43 39 79 ba c0 47 a9  |eR.#.....C9y..G.|
+00000050  44 b5 00 04 13 03 00 ff  01 00 00 94 00 0b 00 04  |D...............|
 00000060  03 00 01 02 00 0a 00 06  00 04 00 1d 00 17 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
 000000a0  2d 00 02 01 01 00 33 00  47 00 45 00 17 00 41 04  |-.....3.G.E...A.|
-000000b0  ca c3 69 88 b3 ed f4 ad  7f 9c 03 6c 7a 44 55 d6  |..i........lzDU.|
-000000c0  68 1d a4 27 67 57 d7 27  08 27 e8 b9 c9 32 49 a2  |h..'gW.'.'...2I.|
-000000d0  e4 f6 c2 f2 62 bd 74 67  77 f9 26 27 ee d7 a7 f0  |....b.tgw.&'....|
-000000e0  9c 9a 41 cd 8b bf 76 25  df ff 5a 9f 4e f5 41 95  |..A...v%..Z.N.A.|
+000000b0  4a 10 f7 42 ba 2e eb b4  70 30 ce 68 08 14 20 2b  |J..B....p0.h.. +|
+000000c0  2f d9 f9 26 27 d3 2d fe  f1 5e d9 cc c7 de 9a b6  |/..&'.-..^......|
+000000d0  53 dd a4 e6 a3 48 61 99  7e 8c 1e 2d 46 84 2b b1  |S....Ha.~..-F.+.|
+000000e0  57 d7 e7 4e 82 3f 3a 13  b2 39 04 f8 77 7f f6 36  |W..N.?:..9..w..6|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 9b 02 00 00  97 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 ff 47 6f 67  |........... .Gog|
-00000030  69 49 88 2a 84 69 79 48  fe cc 92 db 6e 9e ab 47  |iI.*.iyH....n..G|
-00000040  8e 47 10 58 db ad 22 8e  da bb 86 e6 13 03 00 00  |.G.X..".........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 c9 1e b8 0e  |........... ....|
+00000030  53 68 a6 ac 7d 3a 74 c9  1b 4f 65 52 a0 23 da d5  |Sh..}:t..OeR.#..|
+00000040  ca 87 09 43 39 79 ba c0  47 a9 44 b5 13 03 00 00  |...C9y..G.D.....|
 00000050  4f 00 2b 00 02 03 04 00  33 00 45 00 17 00 41 04  |O.+.....3.E...A.|
 00000060  1e 18 37 ef 0d 19 51 88  35 75 71 b5 e5 54 5b 12  |..7...Q.5uq..T[.|
 00000070  2e 8f 09 67 fd a7 24 20  3e b2 56 1c ce 97 28 5e  |...g..$ >.V...(^|
 00000080  f8 2b 2d 4f 9e f1 07 9f  6c 4b 5b 83 56 e2 32 42  |.+-O....lK[.V.2B|
 00000090  e9 58 b6 d7 49 a6 b5 68  1a 41 03 56 6b dc 5a 89  |.X..I..h.A.Vk.Z.|
-000000a0  17 03 03 00 17 c0 07 64  56 b1 bb f8 bf 36 6b df  |.......dV....6k.|
-000000b0  e9 ee 72 cc 79 45 f5 8c  b8 0c b3 5d 17 03 03 02  |..r.yE.....]....|
-000000c0  6d 2e ab b5 84 4f d7 9e  4e 0d 6e a0 42 c1 f0 a6  |m....O..N.n.B...|
-000000d0  62 a3 26 eb 9d 9a 42 a5  5d 1f 59 ad 37 a9 8a af  |b.&...B.].Y.7...|
-000000e0  0d 7b 8f 5a d1 d5 d8 bc  15 5b 0d 0e d2 a9 bb 14  |.{.Z.....[......|
-000000f0  56 ed 30 4e 9b aa f9 5a  66 7d 4c 41 8e 6d 58 90  |V.0N...Zf}LA.mX.|
-00000100  52 4a f2 78 72 59 34 aa  58 7e 0c 44 1e bc 84 d8  |RJ.xrY4.X~.D....|
-00000110  50 17 bd aa 8c 4c d0 c5  e7 69 32 b8 c3 d6 e6 f9  |P....L...i2.....|
-00000120  70 93 99 1c 75 1b 13 f2  85 e0 b5 07 1b d8 5a 31  |p...u.........Z1|
-00000130  0a 1a 2e 97 86 ff 75 a1  db 45 b2 47 68 ed 88 d9  |......u..E.Gh...|
-00000140  fe 31 c9 c0 5e 37 f2 62  37 f7 01 81 11 07 a7 0f  |.1..^7.b7.......|
-00000150  44 ec 17 3a 4a 38 b3 91  9f 77 6f f9 58 9e 9c 12  |D..:J8...wo.X...|
-00000160  6e 54 4c de 43 58 46 a5  f6 c7 58 7e df 33 d7 91  |nTL.CXF...X~.3..|
-00000170  e5 cb 9e 28 9d 7f a7 8a  bd be 01 48 b7 b1 1e e2  |...(.......H....|
-00000180  7a 80 aa f9 cd 3f 62 0d  a0 a0 63 0c ca 4b 5f a8  |z....?b...c..K_.|
-00000190  a9 5f 42 ac 44 57 67 b2  0f 5a b5 bb 59 a9 56 bd  |._B.DWg..Z..Y.V.|
-000001a0  28 3c fb 5e 43 33 61 43  7b 60 48 7d 27 67 6a 06  |(<.^C3aC{`H}'gj.|
-000001b0  ac 0d db e4 d2 d4 b8 fa  fb e8 32 f3 22 83 3a 63  |..........2.".:c|
-000001c0  f6 73 02 62 e0 d5 8a d2  61 a5 bf e1 2d 10 59 93  |.s.b....a...-.Y.|
-000001d0  55 60 be 32 ce 5c d5 5a  f0 54 21 7d 8a 02 23 cf  |U`.2.\.Z.T!}..#.|
-000001e0  38 2b 2b 67 50 22 72 f7  f7 bf 20 c2 34 df ae 3a  |8++gP"r... .4..:|
-000001f0  44 b0 a6 2a 51 79 6f b1  7b ff d7 77 45 83 a9 fa  |D..*Qyo.{..wE...|
-00000200  bf 3c de 34 e8 6a 33 74  6c 24 0b 85 39 ea 7c 13  |.<.4.j3tl$..9.|.|
-00000210  43 26 13 1b 61 56 85 0a  08 83 04 45 5f 5a 36 df  |C&..aV.....E_Z6.|
-00000220  17 c0 59 e9 92 d8 6b 78  66 1f 43 a0 99 f8 4b b1  |..Y...kxf.C...K.|
-00000230  f0 8d 25 6f 0f 2e c7 f9  4d bb 79 74 b8 95 e6 b7  |..%o....M.yt....|
-00000240  41 0c de 2a d3 7e fc 0f  18 87 2d 21 dd 8d 5f 20  |A..*.~....-!.._ |
-00000250  4c 88 cb 63 f4 9c 07 64  14 02 0c 19 46 32 e5 1e  |L..c...d....F2..|
-00000260  85 84 4a 71 b8 a5 50 92  ca 72 fe f4 9c 69 05 d4  |..Jq..P..r...i..|
-00000270  93 22 38 c1 09 e2 da 49  17 e8 e1 b3 f9 42 ee bf  |."8....I.....B..|
-00000280  ea 40 b2 00 af b9 a8 f9  97 8e ef de 41 de 01 87  |.@..........A...|
-00000290  cc 13 23 64 8c a1 10 9a  91 38 9b cb fb 0b 04 66  |..#d.....8.....f|
-000002a0  fb 4b e3 77 e7 da 7a 75  5c 66 20 7e dc 22 a9 e6  |.K.w..zu\f ~."..|
-000002b0  6a 27 06 ed 3c fc 4c 30  ed f0 31 92 b2 eb a1 f3  |j'..<.L0..1.....|
-000002c0  a4 fd 83 20 37 62 71 95  ff 7c 65 e8 88 aa e7 c7  |... 7bq..|e.....|
-000002d0  3f 17 9c 94 6f 1a d9 c8  ac 00 8d ec 30 22 98 85  |?...o.......0"..|
-000002e0  da cc 69 41 f4 3a 66 1b  e6 4c 38 62 8d 37 dc a1  |..iA.:f..L8b.7..|
-000002f0  08 cf 88 d4 26 7f 47 33  54 d8 aa d6 c5 02 fc 72  |....&.G3T......r|
-00000300  ff 50 19 9f 4a 0e 8b c8  32 6d 8e 15 e4 f1 ed 2e  |.P..J...2m......|
-00000310  43 cb 9f 8c 7a 0e e1 a2  79 e2 f9 52 12 e4 2f a9  |C...z...y..R../.|
-00000320  c1 c5 0b 1f c2 21 c5 2e  21 de 3e 76 29 db 17 03  |.....!..!.>v)...|
-00000330  03 00 99 8a ee 54 88 93  d0 4b a0 31 18 ed 83 ff  |.....T...K.1....|
-00000340  2c 44 78 ab 88 ea 72 d2  2a 27 71 a9 a1 ba 26 a5  |,Dx...r.*'q...&.|
-00000350  9a 9b 64 92 e8 c9 f8 02  47 b9 9f 53 95 a8 ad 5b  |..d.....G..S...[|
-00000360  bd 81 17 87 69 0c 77 c1  0e d7 cb 5b 9f 2d 36 86  |....i.w....[.-6.|
-00000370  f5 fc 6d ba d8 f5 63 dd  e4 f5 0a 61 8d b2 a9 bb  |..m...c....a....|
-00000380  a5 a5 d6 41 d4 aa db 46  79 56 02 51 f4 ac d3 57  |...A...FyV.Q...W|
-00000390  57 b4 53 71 9f fe ea a6  76 f3 0f ca 39 93 f3 34  |W.Sq....v...9..4|
-000003a0  c6 96 96 09 8e 12 04 cc  1e 82 9f 78 6b 1c a2 fc  |...........xk...|
-000003b0  0c 9d c6 00 3c 33 3a 92  c5 ce 96 15 50 1a 75 6d  |....<3:.....P.um|
-000003c0  85 ec b6 64 12 2b eb 3a  52 8f 6d 35 17 03 03 00  |...d.+.:R.m5....|
-000003d0  35 7f 2b 30 fa e0 92 25  a2 1b 11 f8 cd 04 0d 57  |5.+0...%.......W|
-000003e0  01 42 cf e9 0c 92 7f d1  fd fa 26 61 0d 85 d7 d5  |.B........&a....|
-000003f0  3c fd cf 73 98 dc 88 a2  76 63 59 82 45 2d e3 bc  |<..s....vcY.E-..|
-00000400  a2 c0 0b 83 41 75 17 03  03 00 93 f3 17 09 b2 e8  |....Au..........|
-00000410  53 11 9b 3e 3a 10 a0 e6  58 04 81 82 cb eb a5 19  |S..>:...X.......|
-00000420  0f a3 25 e2 eb ab 7c 07  2b e6 22 19 30 aa fc a6  |..%...|.+.".0...|
-00000430  bd c4 7d 69 33 38 2b 58  55 5b a7 27 29 86 af d5  |..}i38+XU[.')...|
-00000440  f9 5a b4 85 ad a0 73 ab  f7 61 3f 2e 66 53 f5 8f  |.Z....s..a?.fS..|
-00000450  c7 09 4b 01 99 d0 68 93  32 d1 2e 8f 89 e5 e1 ea  |..K...h.2.......|
-00000460  ba f2 fb 07 ee 58 7c 28  ff 59 1d d7 f7 b3 e2 56  |.....X|(.Y.....V|
-00000470  98 56 cd 9d d1 4f 26 7e  77 0d a0 c1 92 c5 a0 83  |.V...O&~w.......|
-00000480  c9 7c d8 7d a8 91 d3 ae  71 41 1d 06 33 68 b8 52  |.|.}....qA..3h.R|
-00000490  ad 84 a7 21 80 8f e5 c6  37 11 da 6c 5a 3a        |...!....7..lZ:|
+000000a0  17 03 03 00 17 cd 7b ee  ba 3a ca 14 3c c9 eb a2  |......{..:..<...|
+000000b0  f0 11 0a d9 4e f4 f4 da  64 8e 03 cc 17 03 03 02  |....N...d.......|
+000000c0  6d 74 3e b3 f2 1f 5a f6  a0 0b 4c 33 af 83 71 7c  |mt>...Z...L3..q||
+000000d0  b6 52 b8 a2 78 03 39 01  38 e1 a4 cc 82 06 29 de  |.R..x.9.8.....).|
+000000e0  c9 cb 3c a8 65 d2 42 29  2a cc 5b 04 70 49 b3 80  |..<.e.B)*.[.pI..|
+000000f0  73 bb c7 9f 5f aa 48 18  04 97 f8 ac d5 14 24 a5  |s..._.H.......$.|
+00000100  48 36 9f 4b cf 18 11 9b  1f 46 74 a0 04 2c 4f 78  |H6.K.....Ft..,Ox|
+00000110  17 ce 49 7d 3a d3 69 11  fc ed 51 c4 c1 57 99 ab  |..I}:.i...Q..W..|
+00000120  fc d7 af 87 96 34 0d 26  a3 83 00 4f 47 bd 80 d7  |.....4.&...OG...|
+00000130  67 bf 62 22 83 db 1f 81  c8 cc ca 6d 6b 4a 4e c6  |g.b".......mkJN.|
+00000140  f6 5a 06 20 b3 f0 23 4c  85 cc e6 bc 32 d6 39 a1  |.Z. ..#L....2.9.|
+00000150  58 32 f7 69 0e 42 ce cb  5c 30 80 6d 0f 71 a5 3d  |X2.i.B..\0.m.q.=|
+00000160  d0 53 b2 0b e7 84 03 84  9f e4 b8 37 c4 fc 57 c4  |.S.........7..W.|
+00000170  b2 a9 4e 16 7c dd 94 d8  4c 6d b3 2e 02 85 7b 50  |..N.|...Lm....{P|
+00000180  ab 51 f4 43 bc 9e d7 f4  39 0e b8 4f e7 d2 57 17  |.Q.C....9..O..W.|
+00000190  85 c3 07 5e 67 57 4a 59  ab 27 15 9d 6c 49 35 d4  |...^gWJY.'..lI5.|
+000001a0  5b ea 78 31 ab ad 72 3a  3a a3 9a a8 79 53 3a 4e  |[.x1..r::...yS:N|
+000001b0  d4 08 2d 80 df a8 20 71  96 a0 ea 15 34 c7 8f 70  |..-... q....4..p|
+000001c0  09 6a 4e 0c 43 3d be 59  85 b6 ae 61 ea 1b 06 f3  |.jN.C=.Y...a....|
+000001d0  52 d4 06 60 b1 60 38 dd  ab 20 04 cf 0e 8a a1 fa  |R..`.`8.. ......|
+000001e0  71 90 a4 d3 53 de 05 28  74 3f fb 1b eb 9b ad 64  |q...S..(t?.....d|
+000001f0  f4 50 9a f6 3d 32 5e 28  e0 88 a2 76 94 c6 d0 80  |.P..=2^(...v....|
+00000200  60 0a c4 1a ff 67 fb f7  f8 6d 64 d9 1b c9 77 80  |`....g...md...w.|
+00000210  12 f2 80 88 c1 20 2e b5  c4 50 a9 c6 0b 01 61 5f  |..... ...P....a_|
+00000220  bf be fa 1a c8 79 e8 8d  52 a2 b8 68 74 c8 b5 e3  |.....y..R..ht...|
+00000230  00 f5 33 49 c8 2c c6 0b  ef b0 e2 5e b2 b4 d6 f1  |..3I.,.....^....|
+00000240  70 25 cc ed a4 93 31 f8  f9 71 a5 10 87 36 bf 55  |p%....1..q...6.U|
+00000250  7c 4a 96 5f 99 51 0a f4  83 9e 38 7b e9 6f 1c bc  ||J._.Q....8{.o..|
+00000260  c2 14 71 64 d5 c8 9c 9c  38 14 67 ad d2 5e 52 3a  |..qd....8.g..^R:|
+00000270  c6 a2 de 37 46 ac cf e4  1e 84 18 9d e6 87 69 5c  |...7F.........i\|
+00000280  0e 4f 9a 45 55 a6 fd b5  88 02 cc 8a 0d 83 df a9  |.O.EU...........|
+00000290  8b ae 36 21 b0 11 e5 f5  b3 d8 ac 1a 34 65 96 4f  |..6!........4e.O|
+000002a0  2f 22 8f 5f fe 6c 90 61  b4 66 95 25 33 ea 8d a8  |/"._.l.a.f.%3...|
+000002b0  41 e9 b8 b6 5e 97 56 ac  97 a9 4f f6 93 0d a1 7d  |A...^.V...O....}|
+000002c0  40 5a 32 e0 89 f2 eb 1d  8f f5 02 25 16 4a 20 a9  |@Z2........%.J .|
+000002d0  38 00 69 86 3b 36 93 66  b5 d0 73 90 7b 94 69 c9  |8.i.;6.f..s.{.i.|
+000002e0  de aa 89 ab 3c 39 f9 54  35 9b 8c e7 ee ce 56 39  |....<9.T5.....V9|
+000002f0  4a 0d 7e 83 26 25 13 25  07 43 a1 62 0e c0 df 7e  |J.~.&%.%.C.b...~|
+00000300  00 36 57 12 a9 16 e6 61  5a fc 2a fc e8 8f 17 d6  |.6W....aZ.*.....|
+00000310  4e d9 77 95 0f aa 85 c8  c4 20 ef 70 d1 99 85 43  |N.w...... .p...C|
+00000320  f1 2f 1a 29 aa 83 e5 30  00 cc d6 40 b0 d7 17 03  |./.)...0...@....|
+00000330  03 00 99 8f 7b d3 1c 15  1d 87 a8 83 e6 e2 89 b4  |....{...........|
+00000340  ee 63 f2 d1 28 39 f1 c3  a6 e9 70 ee d8 82 6e 7c  |.c..(9....p...n||
+00000350  06 a0 5d 51 69 13 37 79  e9 5f 18 1f 65 a6 1e 98  |..]Qi.7y._..e...|
+00000360  dc 7a 03 69 a6 c7 d3 c3  0d c2 5c b7 e1 3f 78 3e  |.z.i......\..?x>|
+00000370  0a 27 1b 6c 12 d3 db 3a  7a 04 56 d6 57 5b c5 40  |.'.l...:z.V.W[.@|
+00000380  de 6a 74 0a 1d d6 64 34  53 b4 3d 57 cb 27 44 80  |.jt...d4S.=W.'D.|
+00000390  cf 7b a2 fa 62 c0 a8 42  f1 cc 22 38 96 46 66 fd  |.{..b..B.."8.Ff.|
+000003a0  46 22 33 23 1b e1 21 72  95 23 9b d9 9d df 94 e1  |F"3#..!r.#......|
+000003b0  e8 03 d7 8e 92 e5 b9 34  6e 34 fd 4d 41 28 78 a3  |.......4n4.MA(x.|
+000003c0  60 69 2f b2 c5 22 59 48  86 14 bf e6 17 03 03 00  |`i/.."YH........|
+000003d0  35 02 83 5e 5e 58 76 18  37 67 8a 69 a0 d6 00 87  |5..^^Xv.7g.i....|
+000003e0  ad 27 7a ab c8 ac 51 69  40 c4 91 cf e0 46 b5 af  |.'z...Qi@....F..|
+000003f0  4b 7e 0e e9 3d 41 c3 d2  48 3a 93 10 44 18 8c df  |K~..=A..H:..D...|
+00000400  77 7b 27 94 92 94 17 03  03 00 83 35 22 9e fd 06  |w{'........5"...|
+00000410  db 2a 54 ae a2 d4 fa 7e  6f 1c 9f f5 41 2d 4c 57  |.*T....~o...A-LW|
+00000420  e8 c3 a6 da 5d 10 cb b4  56 a8 61 9f 41 30 92 56  |....]...V.a.A0.V|
+00000430  3f 13 d0 f3 c6 a7 00 e7  12 96 62 e8 c6 b1 29 fe  |?.........b...).|
+00000440  86 f2 c4 15 84 d3 ce b0  18 34 5d ad 10 22 12 50  |.........4]..".P|
+00000450  f4 26 68 04 5b e5 a4 7b  16 02 ed ed cb 23 9c 6f  |.&h.[..{.....#.o|
+00000460  76 f4 97 d4 f8 9c 8a d5  92 67 f9 67 0c 4b d0 bc  |v........g.g.K..|
+00000470  03 8b 51 3b 66 2b 2f 0c  28 57 b9 d8 4e 48 1b f6  |..Q;f+/.(W..NH..|
+00000480  56 1a be be ef 9d 65 f9  cd 01 23 68 32 63        |V.....e...#h2c|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 35 28 34 b9  16 07 9a c1 82 ad 9f b7  |....5(4.........|
-00000010  78 fa 1a d0 1f 57 98 95  37 86 cf 1d 67 19 47 48  |x....W..7...g.GH|
-00000020  e9 ab fe 0c ff 26 c6 78  88 1a ad 75 48 63 4b 6e  |.....&.x...uHcKn|
-00000030  72 4a 44 4f 27 b6 9d 56  b6 43                    |rJDO'..V.C|
+00000000  17 03 03 00 35 69 a1 50  bd 27 9f c8 95 6d d9 e6  |....5i.P.'...m..|
+00000010  c7 19 35 4b 2f 58 e4 de  10 b9 48 ab f0 39 76 df  |..5K/X....H..9v.|
+00000020  e3 45 78 74 98 4a fb 51  d4 a8 0b ec e7 eb 78 fd  |.Ext.J.Q......x.|
+00000030  ed 98 b5 6f b2 c5 8e 64  14 43                    |...o...d.C|
 >>> Flow 6 (server to client)
-00000000  17 03 03 00 1e d9 1f 35  86 22 7e 10 f1 8d e5 82  |.......5."~.....|
-00000010  f2 f6 88 81 a3 66 da 6a  1e 2f 94 94 16 02 2a 52  |.....f.j./....*R|
-00000020  69 8b bb 17 03 03 00 13  3c 87 88 8c c0 78 64 18  |i.......<....xd.|
-00000030  9a 9e 07 fd ac d7 2d 5d  ab bf a8                 |......-]...|
+00000000  17 03 03 00 1e 40 c8 fa  b5 cc 64 32 ab b4 3a 96  |.....@....d2..:.|
+00000010  36 49 85 f8 c1 14 32 3e  86 cf a3 37 f6 ce ff ca  |6I....2>...7....|
+00000020  d1 e8 40 17 03 03 00 13  0b cd ef f7 f3 39 8d ac  |..@..........9..|
+00000030  4e 5e 6f 38 ef fa 40 ed  64 0b 4f                 |N^o8..@.d.O|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-IssueTicket b/src/crypto/tls/testdata/Server-TLSv13-IssueTicket
index fa1f80181a..6b62aa25a3 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-IssueTicket
+++ b/src/crypto/tls/testdata/Server-TLSv13-IssueTicket
@@ -1,99 +1,98 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ce 01 00 00  ca 03 03 bb e2 a4 a5 7e  |...............~|
-00000010  63 65 5c a5 7f 3f 13 a1  9d 5f 53 3c d2 b1 84 bd  |ce\..?..._S<....|
-00000020  51 0c 9a 14 e8 8a 5a 53  b8 27 88 20 e7 04 4d dc  |Q.....ZS.'. ..M.|
-00000030  76 f3 7f bd 00 ce 46 d2  a6 58 26 99 02 91 88 bf  |v.....F..X&.....|
-00000040  b5 6b 56 2b b6 bc 51 b2  e4 cd 82 8d 00 04 13 01  |.kV+..Q.........|
+00000000  16 03 01 00 ce 01 00 00  ca 03 03 e0 71 48 1b 86  |............qH..|
+00000010  4b eb 3e 47 7c db 98 a9  b7 ba 7b 64 a7 da 8f 51  |K.>G|.....{d...Q|
+00000020  21 18 c4 d2 db 40 16 a9  b2 4d 0b 20 3f e6 7d 6a  |!....@...M. ?.}j|
+00000030  5e 87 45 7c 4e 90 11 52  6b fe a7 bf 59 2c 63 f0  |^.E|N..Rk...Y,c.|
+00000040  41 d2 5e df 29 32 0d e4  2f 0c 2c 16 00 04 13 01  |A.^.)2../.,.....|
 00000050  00 ff 01 00 00 7d 00 0b  00 04 03 00 01 02 00 0a  |.....}..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 16 00 00 00 17  00 00 00 0d 00 1e 00 1c  |................|
 00000080  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000090  08 04 08 05 08 06 04 01  05 01 06 01 00 2b 00 03  |.............+..|
 000000a0  02 03 04 00 2d 00 02 01  01 00 33 00 26 00 24 00  |....-.....3.&.$.|
-000000b0  1d 00 20 b2 99 9c bb d1  4c c7 61 5f aa bf 2f 06  |.. .....L.a_../.|
-000000c0  a3 50 e7 49 7d 11 ae 68  9b b0 be be 82 6d 27 29  |.P.I}..h.....m')|
-000000d0  89 4c 4a                                          |.LJ|
+000000b0  1d 00 20 ae b9 17 9c b7  a9 1e 2a d3 5a c8 83 92  |.. .......*.Z...|
+000000c0  dd 47 aa 91 f3 36 68 e6  f8 a6 66 fd 2c 9d 7d 58  |.G...6h...f.,.}X|
+000000d0  3b 81 29                                          |;.)|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 e7 04 4d dc  |........... ..M.|
-00000030  76 f3 7f bd 00 ce 46 d2  a6 58 26 99 02 91 88 bf  |v.....F..X&.....|
-00000040  b5 6b 56 2b b6 bc 51 b2  e4 cd 82 8d 13 01 00 00  |.kV+..Q.........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 3f e6 7d 6a  |........... ?.}j|
+00000030  5e 87 45 7c 4e 90 11 52  6b fe a7 bf 59 2c 63 f0  |^.E|N..Rk...Y,c.|
+00000040  41 d2 5e df 29 32 0d e4  2f 0c 2c 16 13 01 00 00  |A.^.)2../.,.....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 c6 67 93 be 69 04  |...........g..i.|
-00000090  58 4f 1d 93 b6 5c 1c 10  8a 91 d0 c0 db 0b d1 0a  |XO...\..........|
-000000a0  d1 17 03 03 02 6d da d6  28 74 c7 60 d6 02 3e 28  |.....m..(t.`..>(|
-000000b0  29 17 50 b9 01 4b 9b 93  07 9d 09 f0 17 05 e0 88  |).P..K..........|
-000000c0  53 ec c3 28 f7 a6 4e 9b  80 a3 fd 20 db 97 51 6a  |S..(..N.... ..Qj|
-000000d0  b1 7a 6d 93 26 61 c8 9c  6d 37 65 94 b4 74 a0 60  |.zm.&a..m7e..t.`|
-000000e0  b1 a1 38 4c eb 5e a9 c4  bd d4 29 ee e9 e3 ab 56  |..8L.^....)....V|
-000000f0  68 67 57 da b3 3d 85 bd  26 67 e1 52 83 a6 69 14  |hgW..=..&g.R..i.|
-00000100  3b 30 31 c7 71 83 fa 62  13 ea a3 a5 de 4b 32 3f  |;01.q..b.....K2?|
-00000110  c6 48 0b 96 cd 4b da 96  6d e2 31 88 ca 96 5f 63  |.H...K..m.1..._c|
-00000120  cb 39 37 d8 fa 8f 1f b9  e2 c5 6b ae 60 05 5b ed  |.97.......k.`.[.|
-00000130  e0 5d 83 fa 2b 22 f4 e8  33 27 48 e7 c4 3d 54 22  |.]..+"..3'H..=T"|
-00000140  5a 60 a9 7a 0d 9b 42 e2  50 28 0e 6c 13 16 a1 51  |Z`.z..B.P(.l...Q|
-00000150  60 81 8f 80 e2 1b 53 24  62 78 b7 0a 4a 9b 2f a7  |`.....S$bx..J./.|
-00000160  97 b3 ba e5 34 0d 76 a6  0e ea ec 91 f0 9c a9 6d  |....4.v........m|
-00000170  57 47 ef a3 c4 7a 62 a8  1f c0 1a d7 ea 31 90 20  |WG...zb......1. |
-00000180  76 13 ae f1 24 9d 60 9f  30 9f 2b 2a 2f 0a 39 6c  |v...$.`.0.+*/.9l|
-00000190  7a 47 fe 11 1c 78 42 a1  1c ed c3 cd d2 6a cd 4f  |zG...xB......j.O|
-000001a0  66 1b 51 d4 43 4e 45 23  15 48 e4 84 3e 89 a3 55  |f.Q.CNE#.H..>..U|
-000001b0  7e b0 a6 c2 1c cd eb cf  88 6b e7 d2 07 25 ef 37  |~........k...%.7|
-000001c0  e1 8a a5 b9 03 7e 70 73  9c 23 1a 62 07 56 db ed  |.....~ps.#.b.V..|
-000001d0  93 e3 8a 91 8b 90 74 14  14 cc ff 9e ea e5 45 dd  |......t.......E.|
-000001e0  a6 2d dc e6 cb 8c 59 33  91 da e6 5c b4 73 4f 36  |.-....Y3...\.sO6|
-000001f0  f1 3c d9 6e ba 2c c4 51  de 4f 8a 69 62 c4 db b1  |.<.n.,.Q.O.ib...|
-00000200  9e 67 7a 5f 01 7b b7 b2  55 b1 14 c0 46 d1 43 16  |.gz_.{..U...F.C.|
-00000210  a0 70 84 7e b8 a3 04 ce  e3 e0 0e 5e 5f 3f 95 7a  |.p.~.......^_?.z|
-00000220  ef 79 8d 50 84 cd 02 f1  e0 e5 f9 26 cf 7a f9 da  |.y.P.......&.z..|
-00000230  a3 7d 22 31 4d 61 82 f6  ff fd 69 23 07 53 07 df  |.}"1Ma....i#.S..|
-00000240  5a eb 50 86 28 44 24 06  9b 21 ef ef 78 bc 67 13  |Z.P.(D$..!..x.g.|
-00000250  c5 27 d8 18 db c7 fa d5  a6 0c 40 09 e3 e5 17 0c  |.'........@.....|
-00000260  61 ae bc 48 98 ab 7b 57  82 f7 87 a5 4b 96 25 77  |a..H..{W....K.%w|
-00000270  e4 59 53 d1 d3 7b 55 08  e0 1a 5d 9b 0f 2e 6f cd  |.YS..{U...]...o.|
-00000280  96 9d 19 09 07 84 08 c1  cf bd 99 af 80 52 c0 f7  |.............R..|
-00000290  0c 50 85 14 7c fd cb 61  01 05 ee 92 60 bb ac 4c  |.P..|..a....`..L|
-000002a0  b4 37 48 dc b1 34 9d 26  3a fd dc ae 21 2f d3 51  |.7H..4.&:...!/.Q|
-000002b0  84 c3 0e 8f e1 b4 fb 0b  2e 3b 51 a9 e8 c2 d9 d9  |.........;Q.....|
-000002c0  6b a5 af 90 30 97 a2 32  9a a3 9d 5d b3 75 c6 48  |k...0..2...].u.H|
-000002d0  4b ee a3 23 85 98 a5 b5  00 fd c5 3a 27 65 9e d0  |K..#.......:'e..|
-000002e0  19 a8 5a 8c 8b eb 49 c6  58 16 9a 88 67 54 82 a9  |..Z...I.X...gT..|
-000002f0  29 0a 98 82 e4 f8 f0 c9  17 a6 81 91 1b c1 2a b7  |).............*.|
-00000300  de c3 8b 2d a6 55 1f 61  89 90 84 15 c8 33 6e cb  |...-.U.a.....3n.|
-00000310  5c f4 e2 17 03 03 00 99  49 e0 38 43 34 61 b9 37  |\.......I.8C4a.7|
-00000320  2c 3e d5 c7 8c d7 9b a6  6c 8e ef a6 28 13 3c 79  |,>......l...(.<y|
-00000330  36 35 3e ba 70 5b 4e 6b  c3 f5 52 06 ae ff 68 1d  |65>.p[Nk..R...h.|
-00000340  a0 07 ac c1 17 6e d1 11  76 1d d7 1e e2 26 3e 76  |.....n..v....&>v|
-00000350  2b f9 a4 55 67 0b 9c cd  db ab 71 1a 84 33 74 eb  |+..Ug.....q..3t.|
-00000360  b1 4b 26 d8 e8 1c 84 2b  62 c7 70 27 16 fb 16 ae  |.K&....+b.p'....|
-00000370  9d 72 3a 42 c1 cb cd c8  d0 dd 9c f0 51 2e 33 c1  |.r:B........Q.3.|
-00000380  46 35 56 ad 3b ea be 6e  14 4d 05 d1 6d 85 93 86  |F5V.;..n.M..m...|
-00000390  cc 6a 1c bf 03 cf 8f 92  c9 18 74 e0 66 0a b6 9a  |.j........t.f...|
-000003a0  38 ac 1a 73 f4 e0 70 ec  93 61 67 9f b8 12 6f 1f  |8..s..p..ag...o.|
-000003b0  17 17 03 03 00 35 59 6b  86 a8 cc 89 c6 fa 4f 95  |.....5Yk......O.|
-000003c0  25 b6 90 08 ac bf 9f d5  c9 3c 6c e5 cd 0d 14 00  |%........<l.....|
-000003d0  20 c9 01 ca 44 bc 9f 66  e0 3d e9 a0 11 40 c7 72  | ...D..f.=...@.r|
-000003e0  57 c8 54 d2 30 65 34 a1  09 27 63 17 03 03 00 93  |W.T.0e4..'c.....|
-000003f0  34 b8 fe 42 51 8b 9a 39  66 52 ec 19 95 2d 38 84  |4..BQ..9fR...-8.|
-00000400  36 36 09 e8 7c 86 51 81  90 7c b8 3b ed ec 9e a9  |66..|.Q..|.;....|
-00000410  09 ef 3b ca 86 2c 4d 05  3c 83 62 1c 8c e2 73 a1  |..;..,M.<.b...s.|
-00000420  3b 99 97 d9 90 24 df be  94 67 73 36 ac 92 ce 10  |;....$...gs6....|
-00000430  7a be 6f 1f b8 9d 0c c5  31 90 47 95 02 4d bd 86  |z.o.....1.G..M..|
-00000440  1a 89 3c e7 b6 71 9a f0  5c 36 41 a2 8f b6 d3 5c  |..<..q..\6A....\|
-00000450  3b 2f a2 0e c8 c5 ae eb  d1 4a d2 ab 12 8c 86 3a  |;/.......J.....:|
-00000460  51 ef 9a e0 44 6f 0a cc  17 61 5d 12 db 2c d7 9f  |Q...Do...a]..,..|
-00000470  d1 a3 30 2e ad f2 4c c8  f8 1e 7f 4c a5 8c c6 f8  |..0...L....L....|
-00000480  3d cb 01                                          |=..|
+00000080  03 03 00 01 01 17 03 03  00 17 3c 57 c2 34 7e 2f  |..........<W.4~/|
+00000090  62 45 7f 94 6e 8d 72 d2  3f 4f 1a 9b 29 c4 d2 a9  |bE..n.r.?O..)...|
+000000a0  d1 17 03 03 02 6d 12 da  d0 63 1f 48 11 d5 5a c2  |.....m...c.H..Z.|
+000000b0  64 c3 a7 57 50 2a 39 ea  6a 24 f2 08 04 29 51 d8  |d..WP*9.j$...)Q.|
+000000c0  27 fc 8b b0 20 3e 04 aa  ea 90 aa e9 c5 d9 58 67  |'... >........Xg|
+000000d0  c2 6a 53 ec 52 cd 26 1d  8f c3 1f 34 ae b0 8e ba  |.jS.R.&....4....|
+000000e0  d1 d0 e5 00 79 6f b3 83  18 3b fb d7 60 1a 55 ff  |....yo...;..`.U.|
+000000f0  12 65 0a b8 0e e0 c9 e6  b8 cf 48 ee dd 33 a7 55  |.e........H..3.U|
+00000100  2d 7d 7e e4 07 16 6d f2  4e 3f 3f be 64 f4 5c 68  |-}~...m.N??.d.\h|
+00000110  82 f0 2a 72 0c ba 16 13  38 be 66 8b bf 01 7e 4d  |..*r....8.f...~M|
+00000120  1a 63 cf f5 03 60 b4 72  28 e8 b9 d1 0b b8 f6 b2  |.c...`.r(.......|
+00000130  61 de 7c d0 f3 81 ec 75  ce 64 a4 5f b1 2e 02 d0  |a.|....u.d._....|
+00000140  8f b7 da 2a 6e c3 44 b6  81 eb d0 d2 c8 93 6e d1  |...*n.D.......n.|
+00000150  66 d4 ea 34 a7 f3 39 ef  eb 7a 02 0d b2 28 63 af  |f..4..9..z...(c.|
+00000160  c3 29 52 e6 97 c0 98 53  8e b0 ff 5f 35 8c 27 55  |.)R....S..._5.'U|
+00000170  0c d8 32 70 16 ad 35 ee  49 2f 2d b6 42 4a a5 60  |..2p..5.I/-.BJ.`|
+00000180  2c e4 c3 36 19 d8 ae 22  71 7f c9 3d 82 01 46 fe  |,..6..."q..=..F.|
+00000190  1a 29 dd 72 27 8e 0e 20  ee fe c7 d5 68 5a 56 5a  |.).r'.. ....hZVZ|
+000001a0  9c 13 fc f4 ea 53 70 b7  bf 4e 8b 2e 5c 9e d8 ce  |.....Sp..N..\...|
+000001b0  c1 ec ae ca aa e5 f7 4a  d4 7a fc 8b 0d 1b 09 e9  |.......J.z......|
+000001c0  8a 6d ff bd 32 1a 55 ce  3b 9d af 39 05 74 a1 f6  |.m..2.U.;..9.t..|
+000001d0  6a c8 33 79 d0 f4 2a 62  1f 07 56 0b bc dd 21 b1  |j.3y..*b..V...!.|
+000001e0  51 9a 32 8a d6 07 84 de  26 20 48 2a 9c d4 41 fe  |Q.2.....& H*..A.|
+000001f0  ee 47 04 53 e2 ef 1e f5  12 a2 e1 18 26 5e 6a e1  |.G.S........&^j.|
+00000200  d0 aa 07 15 9d eb 80 bd  93 f1 e3 7b f4 63 e8 69  |...........{.c.i|
+00000210  73 6e 54 c4 c2 12 3a 00  44 a0 44 79 13 50 a1 1c  |snT...:.D.Dy.P..|
+00000220  83 a5 fe 32 fa 37 51 4f  9c 9a 49 d5 f4 35 18 05  |...2.7QO..I..5..|
+00000230  c6 31 b1 75 52 fc c4 14  4f 23 5f d6 f4 06 7f 34  |.1.uR...O#_....4|
+00000240  d3 24 7e 59 4c 9c 5c 64  e4 d1 31 8a 5d 93 3c 19  |.$~YL.\d..1.].<.|
+00000250  63 8e 72 bf 6c 48 af b5  37 1b 35 ad d0 cd e3 a2  |c.r.lH..7.5.....|
+00000260  9e 86 68 da 82 d7 47 ad  11 60 46 45 ef 3e fa 72  |..h...G..`FE.>.r|
+00000270  9f 4d 14 b5 9c b4 21 91  bc f7 d0 42 88 2e af 60  |.M....!....B...`|
+00000280  ac 78 51 52 82 bd 68 de  61 3d af cb e3 6b c0 0d  |.xQR..h.a=...k..|
+00000290  d3 ea 4c fe a0 c6 7e 92  e7 78 6e e8 8c 10 bb 18  |..L...~..xn.....|
+000002a0  6f cb e8 a1 3e 46 24 a6  89 16 f0 e3 74 02 f0 09  |o...>F$.....t...|
+000002b0  be 1e 6c fa 69 8d 3b 66  7e 21 65 0e b7 9a c2 d2  |..l.i.;f~!e.....|
+000002c0  93 13 0a 6a c7 be 0f 3d  6d 20 33 af 13 65 30 54  |...j...=m 3..e0T|
+000002d0  e8 b7 ae 1d 80 1d c8 3c  28 6e da 6e 9a d3 e6 38  |.......<(n.n...8|
+000002e0  a5 d9 e5 08 70 2e c8 67  e8 f8 c0 a1 b3 93 5a 4c  |....p..g......ZL|
+000002f0  a2 5e 38 38 87 05 f7 3a  00 3f 1c 11 3d d2 6a 4f  |.^88...:.?..=.jO|
+00000300  28 ad b2 5f cb d4 aa bd  25 db c4 5a 99 dc c4 1c  |(.._....%..Z....|
+00000310  2c e9 e2 17 03 03 00 99  03 b1 93 f2 6d a4 fd 0c  |,...........m...|
+00000320  74 1f 3f b6 a7 bb e7 31  ba e2 34 f1 30 dc 31 85  |t.?....1..4.0.1.|
+00000330  8b ab f8 aa 08 ee 7c 5a  af 8c c2 7c ed bb 5d 57  |......|Z...|..]W|
+00000340  b0 80 00 d0 3d 3d eb d9  f5 cb b9 31 a0 ba 39 8f  |....==.....1..9.|
+00000350  cd 71 be 6b 33 e7 88 68  b5 4e 74 73 c6 ae d2 b1  |.q.k3..h.Nts....|
+00000360  68 ba d3 72 c1 3a 24 2b  cc bd ba 24 44 ec 14 ce  |h..r.:$+...$D...|
+00000370  7b 46 96 44 a3 91 48 2f  12 00 b6 47 eb 7a 03 c7  |{F.D..H/...G.z..|
+00000380  9a 59 2c 78 79 4b c6 d3  22 45 07 8f d9 ba 9d c7  |.Y,xyK.."E......|
+00000390  55 23 3f d2 9d ca 33 b2  8e 53 ce 4c 72 49 6a 58  |U#?...3..S.LrIjX|
+000003a0  ad 12 a4 e8 1e 36 7b 2d  f7 88 75 19 2f 3b 0a 6b  |.....6{-..u./;.k|
+000003b0  81 17 03 03 00 35 4a 0f  d8 a6 83 4a 37 2e 29 66  |.....5J....J7.)f|
+000003c0  63 88 0f 7f cd e8 fd b9  40 9c 94 d0 dd 37 c3 2e  |c.......@....7..|
+000003d0  1f c6 e0 88 ac df 6e af  57 7b 46 68 4a 51 cc 36  |......n.W{FhJQ.6|
+000003e0  2f e7 ae 66 0e c2 8e 05  4e ec 2b 17 03 03 00 83  |/..f....N.+.....|
+000003f0  c9 1b a8 14 4f c6 47 d2  4a 96 94 cd bc 88 94 ec  |....O.G.J.......|
+00000400  80 74 78 36 33 bd f1 f4  76 61 9c 8f 59 88 2a 65  |.tx63...va..Y.*e|
+00000410  af 85 24 e2 d3 6e 74 18  ac 38 52 46 bb 72 56 57  |..$..nt..8RF.rVW|
+00000420  c2 1d 3f 1b 7c 78 c1 e9  21 d0 f1 52 b9 e9 8e 0b  |..?.|x..!..R....|
+00000430  3f 85 fd 69 91 fe 8f e8  2d 2c 33 bc 5b bc 18 64  |?..i....-,3.[..d|
+00000440  5c b5 5b 2d 3e 1f b0 6f  89 8c b9 a0 14 9b 45 15  |\.[->..o......E.|
+00000450  0e a8 e2 ce 17 c9 ce d2  45 58 62 39 b9 fb 4d 15  |........EXb9..M.|
+00000460  b1 6d db a4 2e c1 e3 c5  8a 1b 3f 08 96 6d 20 5e  |.m........?..m ^|
+00000470  cf 26 8d                                          |.&.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 74 1e 4a 56 2c  |..........5t.JV,|
-00000010  fc 14 0b 66 ab 2f 56 5b  fd 33 fe c2 a4 df 0b 62  |...f./V[.3.....b|
-00000020  63 11 40 67 d2 11 1b 53  c5 b9 1e 0e 20 83 85 b0  |c.@g...S.... ...|
-00000030  3a 81 79 bc a7 9f 49 ab  22 bd 10 8d 3e c9 95 79  |:.y...I."...>..y|
+00000000  14 03 03 00 01 01 17 03  03 00 35 45 a8 d5 cc 41  |..........5E...A|
+00000010  5e 79 4c 85 84 da 97 fd  76 e6 68 5f 9a d2 20 8b  |^yL.....v.h_.. .|
+00000020  9b 2c 63 b0 d3 de 08 5d  28 0b d7 b3 37 93 56 7c  |.,c....](...7.V||
+00000030  cd 95 c6 54 51 e3 72 4e  08 eb 50 7d cc 4e 63 63  |...TQ.rN..P}.Ncc|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e a4 83 3b  61 a1 00 d5 56 84 4c 83  |.......;a...V.L.|
-00000010  0a 8c 86 13 0c e7 95 71  aa 48 e0 d2 5f 11 5f 45  |.......q.H.._._E|
-00000020  41 7a 10 17 03 03 00 13  ca 8b f5 38 e5 5f e0 8a  |Az.........8._..|
-00000030  e3 08 ba 7d 06 f6 b3 b4  6f e9 2b                 |...}....o.+|
+00000000  17 03 03 00 1e 75 6c 1f  04 3a 4e 62 cd 44 4c 2d  |.....ul..:Nb.DL-|
+00000010  dc 14 7a 1b 7f de ca 76  be 44 c7 52 d0 99 fd 4c  |..z....v.D.R...L|
+00000020  0f c1 7d 17 03 03 00 13  cd cd 51 e5 c5 d3 9a d8  |..}.......Q.....|
+00000030  f6 8b f5 00 f5 76 9b 9f  f1 02 9d                 |.....v.....|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-IssueTicketPreDisable b/src/crypto/tls/testdata/Server-TLSv13-IssueTicketPreDisable
index a939822efc..b39f4cdb7f 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-IssueTicketPreDisable
+++ b/src/crypto/tls/testdata/Server-TLSv13-IssueTicketPreDisable
@@ -1,99 +1,98 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ce 01 00 00  ca 03 03 cd 51 e4 0b ee  |............Q...|
-00000010  9c 83 0f a1 bd 1a c8 b4  94 17 5e 17 fb 63 43 31  |..........^..cC1|
-00000020  89 86 03 fa 82 d4 bb c5  ba 9d 60 20 a1 0b c7 9c  |..........` ....|
-00000030  b0 3f d9 7a 52 bd c0 3f  cd c5 21 54 40 a5 60 73  |.?.zR..?..!T@.`s|
-00000040  fd ff 07 99 75 59 0d f3  bd 57 f6 81 00 04 13 01  |....uY...W......|
+00000000  16 03 01 00 ce 01 00 00  ca 03 03 78 86 2c 50 96  |...........x.,P.|
+00000010  db 53 0e 9c 59 2f 08 bf  b1 dc 4d a0 ab 7f 70 83  |.S..Y/....M...p.|
+00000020  9f c0 06 14 51 e8 96 9f  b9 23 ca 20 67 6c 7b 8c  |....Q....#. gl{.|
+00000030  2d de 80 d4 53 b5 1c ce  bf a7 85 ec 96 d3 84 84  |-...S...........|
+00000040  ad 3b 54 ff 7c c7 18 f6  0e 4d c3 ed 00 04 13 01  |.;T.|....M......|
 00000050  00 ff 01 00 00 7d 00 0b  00 04 03 00 01 02 00 0a  |.....}..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 16 00 00 00 17  00 00 00 0d 00 1e 00 1c  |................|
 00000080  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000090  08 04 08 05 08 06 04 01  05 01 06 01 00 2b 00 03  |.............+..|
 000000a0  02 03 04 00 2d 00 02 01  01 00 33 00 26 00 24 00  |....-.....3.&.$.|
-000000b0  1d 00 20 04 16 08 0b 67  76 58 60 4a 32 c2 ea 1b  |.. ....gvX`J2...|
-000000c0  4a 54 fa 55 9b 39 d8 80  c4 eb 42 cc 1a 84 fe d7  |JT.U.9....B.....|
-000000d0  0a 0d 43                                          |..C|
+000000b0  1d 00 20 4c e5 05 bc 23  11 3c 0e 96 aa d5 9c 17  |.. L...#.<......|
+000000c0  fc 51 1b c8 c9 eb 9e 68  80 5a 14 ca 76 09 68 ee  |.Q.....h.Z..v.h.|
+000000d0  ec b3 39                                          |..9|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 a1 0b c7 9c  |........... ....|
-00000030  b0 3f d9 7a 52 bd c0 3f  cd c5 21 54 40 a5 60 73  |.?.zR..?..!T@.`s|
-00000040  fd ff 07 99 75 59 0d f3  bd 57 f6 81 13 01 00 00  |....uY...W......|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 67 6c 7b 8c  |........... gl{.|
+00000030  2d de 80 d4 53 b5 1c ce  bf a7 85 ec 96 d3 84 84  |-...S...........|
+00000040  ad 3b 54 ff 7c c7 18 f6  0e 4d c3 ed 13 01 00 00  |.;T.|....M......|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 ec 4d 41 82 de 4f  |...........MA..O|
-00000090  c6 cf 1e 56 06 65 0e a4  e7 66 34 1d 89 59 b3 c2  |...V.e...f4..Y..|
-000000a0  0a 17 03 03 02 6d 00 e1  17 f1 b3 5e a7 14 b3 f8  |.....m.....^....|
-000000b0  3a ab 85 d4 80 75 69 01  6c 91 3f 79 ab 8f 51 e0  |:....ui.l.?y..Q.|
-000000c0  f6 a5 65 ab 7e 72 e5 83  99 b2 cb cd f9 5f 27 db  |..e.~r......._'.|
-000000d0  90 70 9c c1 e5 6d 80 3e  59 7c 4d fa f1 23 8a a7  |.p...m.>Y|M..#..|
-000000e0  f4 81 22 32 5b e2 4e d0  eb ab bd 96 05 42 05 5c  |.."2[.N......B.\|
-000000f0  20 5c 8a 3e ca fd b8 aa  dd f2 c4 3e dc 7e a5 ab  | \.>.......>.~..|
-00000100  95 a4 20 03 0e 41 9b 14  55 91 1b 9c 3b 17 bc 2a  |.. ..A..U...;..*|
-00000110  60 c0 ee b1 78 e9 37 c4  65 ef 8c 29 ec d9 10 81  |`...x.7.e..)....|
-00000120  a0 1d c9 ac cf e5 36 90  88 d3 70 6d 59 66 61 a8  |......6...pmYfa.|
-00000130  18 79 ad d8 c7 3e 1f a5  db dc b5 21 83 b0 ae 16  |.y...>.....!....|
-00000140  ce 8e 98 d4 8e 28 c1 d3  d2 ef 51 35 45 41 a7 b4  |.....(....Q5EA..|
-00000150  e1 15 bb 32 10 aa b1 27  be 53 5e 96 ef 0b bd 2f  |...2...'.S^..../|
-00000160  81 66 18 f4 8b 9a cc be  67 c1 32 e3 c0 ea e5 c0  |.f......g.2.....|
-00000170  76 2c 36 7f 91 11 13 c1  a4 04 7e 8e 7b 60 a5 3d  |v,6.......~.{`.=|
-00000180  fa 3c d8 68 9a 7e 4b 23  3d 18 1b a3 34 a9 81 a4  |.<.h.~K#=...4...|
-00000190  00 09 cd 56 eb f2 29 9f  17 8d 48 4d 21 a2 4e ec  |...V..)...HM!.N.|
-000001a0  f0 a0 8d b1 ed d6 c7 01  d0 8e 2f 25 65 9f ac eb  |........../%e...|
-000001b0  44 09 f2 75 db 37 a3 94  cb 70 29 59 37 97 71 63  |D..u.7...p)Y7.qc|
-000001c0  9b fa 0f 0f 33 75 0a 60  4f 78 97 9e 6a 2c 4b df  |....3u.`Ox..j,K.|
-000001d0  54 cc c0 ac 57 4c f3 3a  e3 79 01 b9 c3 8c 37 d2  |T...WL.:.y....7.|
-000001e0  8f d9 e7 cd 33 5a 0c bb  43 7e 39 5f 63 9f a5 11  |....3Z..C~9_c...|
-000001f0  f5 6e e0 95 1f 09 03 56  0f ec b9 7d 08 31 c5 57  |.n.....V...}.1.W|
-00000200  fa a6 57 15 6c 6b 91 d4  9f 5d c2 40 8b 3d 3a 57  |..W.lk...].@.=:W|
-00000210  c2 64 55 bd 88 bb 5e 24  7f fe 79 0c 88 f3 a7 1c  |.dU...^$..y.....|
-00000220  f8 20 6f ba d6 ec fc b2  04 2a d7 b7 17 5e 4c 2e  |. o......*...^L.|
-00000230  24 cd 1b 8a 04 fe 21 e0  5b 90 ec f4 30 df bf fe  |$.....!.[...0...|
-00000240  a8 f9 2b 40 c1 23 15 f2  44 87 9a aa 30 80 70 27  |..+@.#..D...0.p'|
-00000250  80 6f 90 08 b5 47 2e 01  ea 77 3a ba a4 4b 77 8a  |.o...G...w:..Kw.|
-00000260  12 b4 4e e1 a6 04 8a 01  31 60 27 35 bf 76 de 09  |..N.....1`'5.v..|
-00000270  aa 8a c4 c4 21 31 9f eb  c2 92 05 be a1 b5 24 eb  |....!1........$.|
-00000280  71 24 55 f9 aa 5c 62 59  49 bf 42 4c 69 01 4f f7  |q$U..\bYI.BLi.O.|
-00000290  b6 27 14 d4 cc 40 80 13  9b 8b 30 55 1f 32 c1 ee  |.'...@....0U.2..|
-000002a0  51 bd 71 f7 63 3f c2 00  90 60 dc 13 0f 62 c3 06  |Q.q.c?...`...b..|
-000002b0  80 f6 4f cc 44 71 d7 5c  2e 18 82 45 ca 80 b7 0e  |..O.Dq.\...E....|
-000002c0  0c 6f 75 1b 23 cb 86 c1  2d 1e 1b 02 2a 15 fa c7  |.ou.#...-...*...|
-000002d0  b2 af 80 5c 48 c2 b7 12  59 a3 e4 3c ed df 26 d0  |...\H...Y..<..&.|
-000002e0  85 9b 5a 2d 7b 66 e6 c4  b3 fe cd 4d 72 4d fb da  |..Z-{f.....MrM..|
-000002f0  1c 0d 5c fb 2f 8a e3 70  98 ee 95 9c 12 1a fa c7  |..\./..p........|
-00000300  94 7a 8e ca 4d a4 bb 2f  70 3b 67 95 fb 23 fb 8f  |.z..M../p;g..#..|
-00000310  8c 77 4c 17 03 03 00 99  8a 72 14 c7 82 18 d7 ed  |.wL......r......|
-00000320  c7 5d 32 df 44 91 6b 40  3e 0b eb a1 74 da d9 3a  |.]2.D.k@>...t..:|
-00000330  3c 7a 2e 7a 73 3b 63 72  33 c4 c5 27 29 33 f5 30  |<z.zs;cr3..')3.0|
-00000340  cf d3 e7 50 3f 44 33 79  6c 96 ed 80 32 02 5f 6b  |...P?D3yl...2._k|
-00000350  d7 ec d7 67 df 2d 7d bc  2b dd f0 21 39 ef 54 9b  |...g.-}.+..!9.T.|
-00000360  c3 55 1f f9 85 c4 4e 31  ce ba 28 a5 3d 68 64 60  |.U....N1..(.=hd`|
-00000370  9e 0a 99 76 a3 25 7c d6  4f 30 37 48 b4 93 6a 4f  |...v.%|.O07H..jO|
-00000380  ff 0b df 83 ac 6f 27 9e  ec d0 01 17 03 b9 a8 74  |.....o'........t|
-00000390  b9 b4 4c 59 ae da de 8a  18 16 54 18 ac 69 01 20  |..LY......T..i. |
-000003a0  6c f3 0b 93 8d 8c e7 70  79 d5 be 80 5e 87 5a 9c  |l......py...^.Z.|
-000003b0  86 17 03 03 00 35 a7 cf  76 44 4f 48 f3 8c 9b 43  |.....5..vDOH...C|
-000003c0  a2 4e bf c5 e3 e7 08 43  d1 a4 4d 92 b3 3b f4 0a  |.N.....C..M..;..|
-000003d0  06 2f b0 84 43 39 8e 29  a9 42 5d 63 c1 b2 f3 2d  |./..C9.).B]c...-|
-000003e0  0e 57 8e c6 39 aa 29 45  d3 7e 78 17 03 03 00 93  |.W..9.)E.~x.....|
-000003f0  af 0d 9c 38 bd aa 63 fc  de 80 59 28 32 11 0f f5  |...8..c...Y(2...|
-00000400  91 57 cd 15 f7 21 37 43  71 d8 32 7d 14 4b d2 28  |.W...!7Cq.2}.K.(|
-00000410  03 45 12 b5 cf f2 55 02  ae 47 34 ac f0 4c 6e d6  |.E....U..G4..Ln.|
-00000420  30 e4 eb 22 08 a8 10 8c  bb 40 6e ec 96 68 b5 6b  |0..".....@n..h.k|
-00000430  c2 a0 eb fb 53 49 4c 1d  73 b5 4d 80 18 b2 e4 af  |....SIL.s.M.....|
-00000440  8b fa 85 f4 48 d4 e6 51  58 16 04 87 53 5c ff 93  |....H..QX...S\..|
-00000450  3d a8 e4 79 7e 82 79 e9  1f 6a dc ba 43 6f 15 b6  |=..y~.y..j..Co..|
-00000460  35 1b 84 72 a3 4c 65 3d  f3 71 45 0b dc b9 74 13  |5..r.Le=.qE...t.|
-00000470  ed ce 9c fc dd b3 8c d8  ce 84 3e 95 d2 7e 62 60  |..........>..~b`|
-00000480  5d 0a 82                                          |]..|
+00000080  03 03 00 01 01 17 03 03  00 17 8d cf 99 5f 3c c1  |............._<.|
+00000090  21 8a af ce 37 12 0e 1e  1d 65 86 35 59 9d ab a9  |!...7....e.5Y...|
+000000a0  b5 17 03 03 02 6d de 3b  1b 3a ad a0 e8 2f 17 de  |.....m.;.:.../..|
+000000b0  bd 3b 72 47 9c 6d d2 f6  62 92 8e e9 27 bb cb e2  |.;rG.m..b...'...|
+000000c0  1a 2d c1 37 10 74 9b e5  bb 97 e4 a3 07 36 df f9  |.-.7.t.......6..|
+000000d0  34 44 69 cb b7 95 6f 55  55 48 cb fb 2c a0 48 a4  |4Di...oUUH..,.H.|
+000000e0  ea 24 32 14 c8 1e 3f 2c  f0 c9 a8 03 d9 29 55 d3  |.$2...?,.....)U.|
+000000f0  b7 2c 54 c6 ad 0a 07 94  f1 f3 2e 2f a0 e2 ce 6a  |.,T......../...j|
+00000100  67 a9 25 3f ec eb 89 82  01 62 ec 34 ae fd 3d 8a  |g.%?.....b.4..=.|
+00000110  24 de 35 fd bc 48 cd 80  99 7c ff 08 3e 76 e8 4c  |$.5..H...|..>v.L|
+00000120  26 3b 36 4d b1 06 57 3d  b0 e3 45 79 bd 50 9d 12  |&;6M..W=..Ey.P..|
+00000130  3e 69 43 12 07 b7 72 ad  d1 96 bc 7c cf a3 98 73  |>iC...r....|...s|
+00000140  b0 1a 9e 70 2c 05 2b 5e  5e 63 4b 93 e5 c9 16 f3  |...p,.+^^cK.....|
+00000150  a0 f5 10 63 96 10 5b 78  74 35 d9 8d f0 b2 8a ae  |...c..[xt5......|
+00000160  4c 43 2e a6 ec b6 94 a1  6f 92 6d 91 cb 16 68 d9  |LC......o.m...h.|
+00000170  83 44 75 d3 24 46 31 0c  78 a5 79 6e cd 62 15 35  |.Du.$F1.x.yn.b.5|
+00000180  48 b4 f0 de 9c cf a1 79  a1 e0 c3 88 3b ea 5f 00  |H......y....;._.|
+00000190  8f 59 16 a1 70 43 74 e6  19 fd 9c 43 c4 e5 f2 c1  |.Y..pCt....C....|
+000001a0  1b 97 98 8e d5 43 c1 d1  4e 31 b0 a6 ae 45 25 66  |.....C..N1...E%f|
+000001b0  4c 3a a6 3a 5a 9d 7d 65  dc 69 68 bb 83 21 01 7f  |L:.:Z.}e.ih..!..|
+000001c0  77 2d 9c e3 9f bd 00 2f  f5 e2 01 f1 b4 4d b5 16  |w-...../.....M..|
+000001d0  22 14 91 7a 82 21 c9 8c  cb 0e e7 2d 34 69 ee 31  |"..z.!.....-4i.1|
+000001e0  8a fd cb 03 96 00 95 14  41 cf 97 41 86 15 83 02  |........A..A....|
+000001f0  6f c3 39 ff 6d 14 9e 67  a2 1c 8b 11 36 5a 30 99  |o.9.m..g....6Z0.|
+00000200  10 88 da 51 e8 29 e4 0c  f5 44 7d e2 cb 31 2d 74  |...Q.)...D}..1-t|
+00000210  17 0d 3b e6 09 0d e3 7e  71 48 84 5d 13 ae 74 5d  |..;....~qH.]..t]|
+00000220  fa 3f 7b 66 73 dd 27 24  8a 9b 4f 3d 50 be 15 1c  |.?{fs.'$..O=P...|
+00000230  e7 71 9c 80 9d f3 8d 1f  d2 d3 66 3d 3a 2e 86 7a  |.q........f=:..z|
+00000240  16 ff eb 39 52 df 16 fa  d0 c1 d8 8a 4d 2a 03 da  |...9R.......M*..|
+00000250  98 9f c6 71 5b 07 5b 9f  b8 ea f6 a3 5d b0 06 94  |...q[.[.....]...|
+00000260  35 94 e6 9c 29 23 9d 9c  1c a6 15 0e 11 f4 0b 0d  |5...)#..........|
+00000270  b6 c9 a5 c5 94 df 18 6d  62 7a 47 54 87 7e a6 7e  |.......mbzGT.~.~|
+00000280  18 82 39 53 b3 c5 95 23  7a ce a9 62 dd 71 51 17  |..9S...#z..b.qQ.|
+00000290  4e e5 3c 45 05 64 23 c4  26 35 d8 37 cb 2f 08 7d  |N.<E.d#.&5.7./.}|
+000002a0  5a 0b a9 cb 75 3d 7a 40  97 d9 d4 6a 54 ae 03 92  |Z...u=z@...jT...|
+000002b0  21 53 df 06 ed 1f c2 49  04 a6 63 6f c8 53 aa f0  |!S.....I..co.S..|
+000002c0  76 c1 d0 da 17 44 54 5e  05 9f e9 68 25 32 47 fb  |v....DT^...h%2G.|
+000002d0  5b d6 f3 31 e2 88 25 d4  b8 b0 f7 86 69 98 87 f1  |[..1..%.....i...|
+000002e0  37 26 41 e5 52 1c 74 92  b3 05 db 0b 81 95 b5 19  |7&A.R.t.........|
+000002f0  2e b2 2c 36 73 bc c7 5c  5d 48 37 22 33 cb 1f 46  |..,6s..\]H7"3..F|
+00000300  6d cd 61 09 8f e6 c5 2a  18 d1 5e 3e 15 54 29 21  |m.a....*..^>.T)!|
+00000310  ce 49 f4 17 03 03 00 99  ef a9 b8 74 91 ea be 90  |.I.........t....|
+00000320  0d 55 6f d3 e5 6b 7b 19  bb 1c cc c2 6d 0a 49 85  |.Uo..k{.....m.I.|
+00000330  f0 30 12 6e 05 88 7c d0  80 a4 39 82 f7 24 8a 0b  |.0.n..|...9..$..|
+00000340  89 84 a1 89 3a ab bb 79  01 6a a1 48 ef 22 15 a7  |....:..y.j.H."..|
+00000350  43 e7 96 76 85 23 59 d2  27 ea 89 45 e1 76 06 52  |C..v.#Y.'..E.v.R|
+00000360  6d eb b6 89 76 be 3f 2d  4c 8f 75 a1 69 fa 52 47  |m...v.?-L.u.i.RG|
+00000370  ee 9a a7 c1 40 bd fb 76  69 da 73 55 d6 5a 4c 36  |....@..vi.sU.ZL6|
+00000380  61 ee bc b3 d5 b3 23 17  1c da 79 83 00 d6 1e 57  |a.....#...y....W|
+00000390  09 24 85 97 85 58 d6 5d  61 60 ae 3b 85 0e 28 dc  |.$...X.]a`.;..(.|
+000003a0  08 1a ea 49 11 47 b9 8a  d1 7e 47 20 48 64 ad cc  |...I.G...~G Hd..|
+000003b0  2e 17 03 03 00 35 c6 76  14 a6 a0 7d 5d 0c 03 4b  |.....5.v...}]..K|
+000003c0  2f 65 c0 55 ab aa ab 61  10 2f 0f 25 44 2b 76 9c  |/e.U...a./.%D+v.|
+000003d0  73 6b 8b 19 d8 2a 3e 1c  4d 96 1b 5f bd 80 af b2  |sk...*>.M.._....|
+000003e0  4a aa 3c 3c 65 ab 5a ca  2d 1d 65 17 03 03 00 83  |J.<<e.Z.-.e.....|
+000003f0  0a f6 d8 a3 67 b3 27 62  f5 64 c3 43 bd 08 f8 af  |....g.'b.d.C....|
+00000400  d1 56 ce 25 8b 3f d9 6b  54 9c 4e 5e 8c 06 24 95  |.V.%.?.kT.N^..$.|
+00000410  a0 49 e2 25 d2 b8 7f a0  59 06 04 26 19 16 ad 3b  |.I.%....Y..&...;|
+00000420  30 82 0f c3 84 bf 70 78  58 4c 76 f7 91 0e f2 1a  |0.....pxXLv.....|
+00000430  88 10 4e b3 c9 26 b5 7b  ab 1a 72 c6 1a 2a b0 65  |..N..&.{..r..*.e|
+00000440  92 86 c4 84 5b e7 ab 3c  7e b4 0d 67 0c 53 d9 1d  |....[..<~..g.S..|
+00000450  81 47 e3 f9 11 09 26 4a  67 ff 1a 55 5b f8 93 e0  |.G....&Jg..U[...|
+00000460  e1 52 2f e5 c3 3c 73 98  6e 98 25 d8 d7 f4 2a 6e  |.R/..<s.n.%...*n|
+00000470  f7 e8 6e                                          |..n|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 35 fd 9a 7d 02  |..........55..}.|
-00000010  fb b2 eb fa 51 27 3e 80  ab 60 f6 a1 54 31 13 2f  |....Q'>..`..T1./|
-00000020  02 b9 19 ac 68 be 25 69  b3 c4 48 87 42 75 b0 93  |....h.%i..H.Bu..|
-00000030  66 3e 2e 0b 79 4f 0b 3a  59 ef 89 83 65 c9 10 9b  |f>..yO.:Y...e...|
+00000000  14 03 03 00 01 01 17 03  03 00 35 9b 1d 48 76 dc  |..........5..Hv.|
+00000010  64 a6 c8 3e f9 f4 2c fa  cb e4 a6 f5 37 c5 77 d0  |d..>..,.....7.w.|
+00000020  02 ad e9 89 94 64 d2 6a  b8 d4 f0 f7 ac 83 bb f1  |.....d.j........|
+00000030  15 06 b2 db 33 db 2b 80  58 c0 90 c1 59 25 0d 08  |....3.+.X...Y%..|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 58 0f 73  e3 ba ff d3 19 0d 89 c9  |.....X.s........|
-00000010  94 8a fb 24 02 58 2a 2c  eb 69 29 4e 57 d3 d2 5e  |...$.X*,.i)NW..^|
-00000020  ba b2 75 17 03 03 00 13  9c 5c 46 44 71 dc 68 b8  |..u......\FDq.h.|
-00000030  39 cc e1 fd 2d 2a a1 a9  50 6c af                 |9...-*..Pl.|
+00000000  17 03 03 00 1e bc 18 62  dd 27 ff a7 68 a0 a5 43  |.......b.'..h..C|
+00000010  09 6d 07 35 df 92 1d 79  0b fb 23 c6 30 0e e4 03  |.m.5...y..#.0...|
+00000020  86 22 af 17 03 03 00 13  c8 90 55 e0 65 61 c9 22  |."........U.ea."|
+00000030  60 62 5a 1a f9 bd ed 85  ab 5c e0                 |`bZ......\.|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-P256 b/src/crypto/tls/testdata/Server-TLSv13-P256
index dd8e0f49ce..472f5a6178 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-P256
+++ b/src/crypto/tls/testdata/Server-TLSv13-P256
@@ -1,102 +1,101 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 e3 01 00 00  df 03 03 c8 5f 11 a2 29  |............_..)|
-00000010  7b c3 b7 72 5e ba e1 c5  83 45 c8 87 e1 51 27 d9  |{..r^....E...Q'.|
-00000020  33 0e 68 e0 71 76 9e 8f  4e f4 da 20 da fd c6 1d  |3.h.qv..N.. ....|
-00000030  46 55 42 89 0a 80 e0 d3  e4 dd db 7d b1 3a 76 a3  |FUB........}.:v.|
-00000040  5b d9 2a c7 f1 1a 3b 0b  8c 24 dd 4d 00 04 13 03  |[.*...;..$.M....|
+00000000  16 03 01 00 e3 01 00 00  df 03 03 0e 04 06 43 06  |..............C.|
+00000010  a4 b9 e5 86 c2 bb 7a d6  75 c4 bf 7c 8f 8a ba 87  |......z.u..|....|
+00000020  72 b9 b8 6d 55 80 ce 9c  37 24 8b 20 7e 96 80 79  |r..mU...7$. ~..y|
+00000030  4f d2 98 63 06 1a 19 2f  95 f9 12 0b 08 35 9a 8f  |O..c.../.....5..|
+00000040  f1 33 6b 25 d4 76 c8 c7  66 6a eb 79 00 04 13 03  |.3k%.v..fj.y....|
 00000050  00 ff 01 00 00 92 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 04 00 02 00 17 00 16  00 00 00 17 00 00 00 0d  |................|
 00000070  00 1e 00 1c 04 03 05 03  06 03 08 07 08 08 08 09  |................|
 00000080  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
 00000090  00 2b 00 03 02 03 04 00  2d 00 02 01 01 00 33 00  |.+......-.....3.|
-000000a0  47 00 45 00 17 00 41 04  04 48 71 9f a6 06 17 16  |G.E...A..Hq.....|
-000000b0  04 d2 b4 e7 6b 5c cf d8  9f ca 64 a7 39 9e 1a 22  |....k\....d.9.."|
-000000c0  aa fc b5 4c d9 d3 b3 37  e3 d4 e1 3b 5b 00 74 df  |...L...7...;[.t.|
-000000d0  df e5 29 8f 7c f7 6b 02  f0 e7 fb 9b 43 6a 41 fb  |..).|.k.....CjA.|
-000000e0  77 5b c2 6e 99 48 69 78                           |w[.n.Hix|
+000000a0  47 00 45 00 17 00 41 04  36 15 75 5c 22 c8 0f 64  |G.E...A.6.u\"..d|
+000000b0  b6 cb 72 ae 3f 9b 2f bf  c5 ac 0b f3 b4 b4 ce 37  |..r.?./........7|
+000000c0  de cf d4 b3 21 8f ac bd  12 5b ea e3 0d fd 21 30  |....!....[....!0|
+000000d0  85 ea 81 c7 57 9c 9a 64  67 3f c3 89 a2 0b 90 3a  |....W..dg?.....:|
+000000e0  68 72 80 a0 09 6c f3 a9                           |hr...l..|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 9b 02 00 00  97 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 da fd c6 1d  |........... ....|
-00000030  46 55 42 89 0a 80 e0 d3  e4 dd db 7d b1 3a 76 a3  |FUB........}.:v.|
-00000040  5b d9 2a c7 f1 1a 3b 0b  8c 24 dd 4d 13 03 00 00  |[.*...;..$.M....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 7e 96 80 79  |........... ~..y|
+00000030  4f d2 98 63 06 1a 19 2f  95 f9 12 0b 08 35 9a 8f  |O..c.../.....5..|
+00000040  f1 33 6b 25 d4 76 c8 c7  66 6a eb 79 13 03 00 00  |.3k%.v..fj.y....|
 00000050  4f 00 2b 00 02 03 04 00  33 00 45 00 17 00 41 04  |O.+.....3.E...A.|
 00000060  1e 18 37 ef 0d 19 51 88  35 75 71 b5 e5 54 5b 12  |..7...Q.5uq..T[.|
 00000070  2e 8f 09 67 fd a7 24 20  3e b2 56 1c ce 97 28 5e  |...g..$ >.V...(^|
 00000080  f8 2b 2d 4f 9e f1 07 9f  6c 4b 5b 83 56 e2 32 42  |.+-O....lK[.V.2B|
 00000090  e9 58 b6 d7 49 a6 b5 68  1a 41 03 56 6b dc 5a 89  |.X..I..h.A.Vk.Z.|
-000000a0  14 03 03 00 01 01 17 03  03 00 17 81 b8 e3 25 04  |..............%.|
-000000b0  6c d8 f6 7c 04 a1 2c 8b  1f 0d cb de 29 1b e1 a3  |l..|..,.....)...|
-000000c0  6f 8c 17 03 03 02 6d 81  db bc b4 f8 02 f3 c5 4e  |o.....m........N|
-000000d0  9e f7 5f 55 54 3e 25 a9  2f 03 06 62 2f 1e 7e d4  |.._UT>%./..b/.~.|
-000000e0  19 27 88 1e ac f2 44 87  29 84 08 69 2f 5d a3 ca  |.'....D.)..i/]..|
-000000f0  de 8f 98 ad 25 6b c5 94  62 34 44 95 bc 17 ed e6  |....%k..b4D.....|
-00000100  fe 89 9c ef 46 c9 cb ee  16 d4 42 b6 d3 50 7b 3a  |....F.....B..P{:|
-00000110  51 d8 20 23 02 3e 69 a8  1a 80 eb bf 7c 82 2b 1f  |Q. #.>i.....|.+.|
-00000120  10 5a 30 85 dd bc ff 65  4d c6 4f 7b bc 3d 64 e2  |.Z0....eM.O{.=d.|
-00000130  93 2a 05 a0 af de b1 41  48 85 db 98 c9 a9 96 5c  |.*.....AH......\|
-00000140  64 a4 70 2e f9 4e de 38  9f 48 f7 eb 6e 14 42 3f  |d.p..N.8.H..n.B?|
-00000150  9f 86 0f 2d 70 6a 30 96  1c dd c6 11 28 6f 86 b6  |...-pj0.....(o..|
-00000160  da bb 5b 76 c8 56 18 4a  67 bf 59 db 56 46 f0 c7  |..[v.V.Jg.Y.VF..|
-00000170  80 2b 0f 0c 8a 02 58 a1  13 aa 2e 5d 61 e2 d5 23  |.+....X....]a..#|
-00000180  3c 1c 75 06 e4 e4 e1 39  eb 65 6a ff 38 21 28 c9  |<.u....9.ej.8!(.|
-00000190  c5 8b a5 12 21 18 2a 59  e7 4e 66 53 be d3 49 97  |....!.*Y.NfS..I.|
-000001a0  f9 b1 7d e2 75 44 37 38  36 35 af 78 27 f4 74 e0  |..}.uD7865.x'.t.|
-000001b0  45 ca fd 79 3c 39 65 00  46 58 4b 8b db f9 6e c0  |E..y<9e.FXK...n.|
-000001c0  69 ec 1e 25 87 66 e1 b8  d8 cc 16 5b 16 9e 90 2e  |i..%.f.....[....|
-000001d0  16 0c 8f 25 04 cf 40 c8  50 dd c4 63 19 8f f1 76  |...%..@.P..c...v|
-000001e0  5e fa 24 1d 8a d2 c1 d4  98 49 48 f0 e6 fa f3 6e  |^.$......IH....n|
-000001f0  63 0b a5 7a 2f f2 f0 47  0b c0 89 9f 7b 9f ef 48  |c..z/..G....{..H|
-00000200  df fd 38 5d a9 71 ce 0c  3c 6f 88 0b 1b d3 93 8c  |..8].q..<o......|
-00000210  14 9a ff 8a db 3f 07 f7  46 54 fe c0 8c 06 7f e0  |.....?..FT......|
-00000220  de e9 c8 3c 4b cd 7b c3  59 11 63 01 8e 69 40 00  |...<K.{.Y.c..i@.|
-00000230  d5 e0 4c 01 00 12 89 3a  98 e3 3f e1 a3 69 f6 ee  |..L....:..?..i..|
-00000240  e7 94 65 b1 61 58 08 07  4a d5 ab aa 43 3e cf 02  |..e.aX..J...C>..|
-00000250  96 5a 3c 97 8e 7b 47 b8  f0 58 16 12 05 69 69 a1  |.Z<..{G..X...ii.|
-00000260  36 7b ff dd 92 60 26 e2  f9 53 4c 3a 25 ac 88 dd  |6{...`&..SL:%...|
-00000270  9a 81 7c 1f 58 27 33 14  68 44 06 e2 01 14 94 99  |..|.X'3.hD......|
-00000280  00 05 8f 64 47 ca 95 fa  92 57 a9 1a 53 d5 47 52  |...dG....W..S.GR|
-00000290  e8 c4 aa eb 0a f5 1b a9  09 72 92 37 f5 8d 90 b8  |.........r.7....|
-000002a0  4b 08 7f 55 19 2d a7 d8  7b d9 ba 7f 5e 56 bb 80  |K..U.-..{...^V..|
-000002b0  c7 d0 49 99 ae ce 2f a4  f0 ab d1 bd ba f3 0f 85  |..I.../.........|
-000002c0  f1 68 c1 9d 2a 37 ff de  a4 0a 6f 58 27 1d 1d 2b  |.h..*7....oX'..+|
-000002d0  87 9d 52 d3 70 37 a6 03  cd 77 61 9b 56 64 49 62  |..R.p7...wa.VdIb|
-000002e0  ef a1 ed fe 75 1a 61 4a  58 01 d6 80 2f ab ab fc  |....u.aJX.../...|
-000002f0  b2 49 1f 51 b7 51 29 c1  a1 39 fc f4 0a 9b 0d 76  |.I.Q.Q)..9.....v|
-00000300  c6 d0 89 c9 8f 88 e9 ec  13 90 78 4f 0c f5 c9 7e  |..........xO...~|
-00000310  d5 b3 13 ad 35 6d 53 d0  88 50 e8 47 15 a0 ca fc  |....5mS..P.G....|
-00000320  5f 6e 98 23 46 6a 69 84  3c a9 3f eb d1 05 f5 97  |_n.#Fji.<.?.....|
-00000330  11 39 7f 39 17 03 03 00  99 84 8e 37 a9 57 78 12  |.9.9.......7.Wx.|
-00000340  8e 9a e7 8e 45 ee 55 61  66 24 ed 5a 36 19 e3 1c  |....E.Uaf$.Z6...|
-00000350  22 3b 8b c0 4b c9 cd 2c  4c 17 d2 a9 40 2c 02 40  |";..K..,L...@,.@|
-00000360  74 ba 11 de a5 d4 01 11  ae 9d 71 76 4c f0 87 0f  |t.........qvL...|
-00000370  5e 75 c0 67 c0 33 e7 3e  9b d3 a4 21 e8 40 a6 9f  |^u.g.3.>...!.@..|
-00000380  d8 24 a7 d7 c1 99 cc 8d  33 10 91 0a 41 a6 05 1c  |.$......3...A...|
-00000390  85 4c c5 a8 c9 dd 74 d0  5c 67 2e 2a 50 4e 30 c7  |.L....t.\g.*PN0.|
-000003a0  bb fa f8 65 ee 48 23 f5  c5 d3 a1 ec 4d 3f ac 4b  |...e.H#.....M?.K|
-000003b0  ef 1e 8d 84 07 b9 69 2a  34 51 73 ba fb b5 7d 64  |......i*4Qs...}d|
-000003c0  1f fc 0e c8 33 d9 77 5e  41 00 65 25 ea 75 75 c9  |....3.w^A.e%.uu.|
-000003d0  2b 03 17 03 03 00 35 54  c2 06 55 7c 6f 92 8a d2  |+.....5T..U|o...|
-000003e0  d5 35 0c 4b 0d df cb d7  6e 5d 64 e1 2e cf 50 b8  |.5.K....n]d...P.|
-000003f0  d8 04 9a f4 ce 69 d3 ac  bb 47 cd 57 ac 07 aa 40  |.....i...G.W...@|
-00000400  e3 fc 01 bc d6 a1 0e 16  4e 6b 04 cc 17 03 03 00  |........Nk......|
-00000410  93 b2 c3 64 29 13 07 75  b4 c4 84 f7 0e 99 d9 9f  |...d)..u........|
-00000420  8d 5b fd 26 07 42 48 33  3a ab 6f 7d 07 8b f6 8a  |.[.&.BH3:.o}....|
-00000430  22 a4 ce 64 0f 69 ea 61  95 70 6d d3 f8 5f 8b ad  |"..d.i.a.pm.._..|
-00000440  02 43 94 41 51 f4 f8 0b  52 fc 58 c1 23 5e 22 a7  |.C.AQ...R.X.#^".|
-00000450  74 49 a1 46 e8 29 ab d6  ae 02 a4 7b e4 23 f1 89  |tI.F.).....{.#..|
-00000460  1c b1 74 86 92 1b 6a 7c  2f 55 2b 89 f6 01 fc e2  |..t...j|/U+.....|
-00000470  d6 15 b9 b1 64 1c 4a af  f8 fe 3e e0 76 0f cf 08  |....d.J...>.v...|
-00000480  e1 2c db f6 1c 77 6f e4  a4 80 ad 13 74 3d 02 52  |.,...wo.....t=.R|
-00000490  a1 ff 3e 85 1d d3 77 bc  f2 48 73 1c 45 09 62 34  |..>...w..Hs.E.b4|
-000004a0  80 09 21 41                                       |..!A|
+000000a0  14 03 03 00 01 01 17 03  03 00 17 57 c8 67 ef 2e  |...........W.g..|
+000000b0  e2 ba 53 0a 1b f6 d5 eb  d1 a7 e2 cb dd 28 ff d5  |..S..........(..|
+000000c0  f5 3f 17 03 03 02 6d b3  7f 44 fa f3 78 bf c7 98  |.?....m..D..x...|
+000000d0  e5 a0 e2 4b d5 60 98 63  7b 77 2f bd b5 8a 84 79  |...K.`.c{w/....y|
+000000e0  13 59 d1 f5 13 ea 25 6e  72 65 34 0f ff 92 a8 94  |.Y....%nre4.....|
+000000f0  cb d3 f7 b6 2a 54 87 19  94 ad f1 ab 70 4c 5d 62  |....*T......pL]b|
+00000100  41 fc f5 90 7a b5 f7 e3  0c e8 0e 1c e7 35 6b 40  |A...z........5k@|
+00000110  ca 34 f5 29 d7 da 8b c2  93 88 3d b8 26 be 09 46  |.4.)......=.&..F|
+00000120  ec 2f 8c c3 9c 83 26 83  b5 56 da c4 65 58 40 0d  |./....&..V..eX@.|
+00000130  29 d4 b4 bf 2e 0c ba d0  95 b4 b0 88 9a 13 e2 e3  |)...............|
+00000140  db d8 03 78 03 00 07 67  46 2c e5 7b b1 6e df d0  |...x...gF,.{.n..|
+00000150  f3 d9 5b db b5 31 80 86  31 83 c8 4a 1b 90 fb 4f  |..[..1..1..J...O|
+00000160  7a 7a c7 ac 20 e6 a6 f7  3c c3 da be fd 3b 37 1f  |zz.. ...<....;7.|
+00000170  17 9f 23 b5 a4 36 11 52  09 fe 8a 65 cc 27 0f 68  |..#..6.R...e.'.h|
+00000180  67 50 27 0f 56 d6 7f 14  48 39 73 c4 85 84 ab b4  |gP'.V...H9s.....|
+00000190  b4 71 b9 b8 ab e5 f8 b9  57 28 70 ca b0 f1 55 77  |.q......W(p...Uw|
+000001a0  0e 86 12 01 2a 19 45 56  46 6f 57 f4 10 90 a2 1a  |....*.EVFoW.....|
+000001b0  3c b1 4e 77 c8 0a e9 e5  27 f7 86 68 e4 1f 9a d0  |<.Nw....'..h....|
+000001c0  68 92 7d d0 b6 0b 04 cd  60 59 7e 88 ca 98 a4 c8  |h.}.....`Y~.....|
+000001d0  a0 e9 c2 d0 e3 2e 91 bb  d1 c6 b0 c4 31 6b c0 b9  |............1k..|
+000001e0  bf fc 1a 85 68 98 2e 18  75 9d c3 52 55 c9 bf d4  |....h...u..RU...|
+000001f0  c6 2d 70 3a ef 53 9e 99  33 07 4e cc a8 34 8a 42  |.-p:.S..3.N..4.B|
+00000200  75 69 fa 99 1b 32 a8 dd  6f b3 17 fb 72 7f a0 f5  |ui...2..o...r...|
+00000210  ae b8 65 06 7f 1f 31 8b  03 99 fd bd fc 5f 24 db  |..e...1......_$.|
+00000220  7c 1e b1 a0 b6 ed 85 9c  b6 07 9a 3b 34 e8 b8 dc  ||..........;4...|
+00000230  62 67 e0 17 59 4f b6 68  12 59 64 1a 63 c5 ca d7  |bg..YO.h.Yd.c...|
+00000240  54 41 e5 c2 f8 0e c7 47  0a 3d 2a 65 fd cd e2 fe  |TA.....G.=*e....|
+00000250  55 a7 e4 80 2c 75 34 95  1e 33 cd 9c 9c a7 26 55  |U...,u4..3....&U|
+00000260  3b 60 d4 4a 05 e6 84 91  86 09 a7 a0 e1 8a 3f dc  |;`.J..........?.|
+00000270  43 ec 99 bd 3b 0b 41 d2  02 61 3b cc a2 69 81 5c  |C...;.A..a;..i.\|
+00000280  6f 96 aa ea f3 80 e0 67  76 2c 5e 82 12 fd a2 80  |o......gv,^.....|
+00000290  91 f9 7e 8c b8 f5 5b b7  cb 59 0f 95 dc 20 51 b7  |..~...[..Y... Q.|
+000002a0  78 62 2e 48 5a 4a 3f 3a  e9 43 42 f9 58 dd b0 eb  |xb.HZJ?:.CB.X...|
+000002b0  99 05 10 39 66 83 96 a7  5d 22 5d 56 01 9f 18 9a  |...9f...]"]V....|
+000002c0  19 e3 b5 28 2f 58 56 dc  64 b9 7e f5 14 cb 2e 56  |...(/XV.d.~....V|
+000002d0  95 4b b0 4b ff 7a 79 f7  75 57 a9 63 b5 db 98 84  |.K.K.zy.uW.c....|
+000002e0  2b d8 b0 3b 61 89 0c 66  5d ad b7 be c6 b3 1d ee  |+..;a..f].......|
+000002f0  cf c1 1d 85 a1 ec d1 34  26 30 c1 49 68 ce 81 06  |.......4&0.Ih...|
+00000300  47 ea 2b 31 c3 35 e5 75  41 50 9d a9 46 b8 30 f9  |G.+1.5.uAP..F.0.|
+00000310  bf a9 82 e9 05 71 4a 2b  1f f3 0f f1 2a 90 92 5e  |.....qJ+....*..^|
+00000320  75 f3 1e 0f 4a 98 39 15  23 c9 c5 35 94 2b b8 ce  |u...J.9.#..5.+..|
+00000330  8f b9 5b 0c 17 03 03 00  99 76 cc ea df cb 6f 53  |..[......v....oS|
+00000340  4f 37 f9 06 6b ac 22 ec  47 b0 83 98 3c 20 f8 85  |O7..k.".G...< ..|
+00000350  85 69 de a8 67 bb 58 26  03 cc 6d f8 20 14 1e cc  |.i..g.X&..m. ...|
+00000360  85 87 8d 5b 32 8d 84 4c  4f 34 4b 5b be f6 88 18  |...[2..LO4K[....|
+00000370  3a fa 60 16 eb 39 3c f3  0d 3f 6d 79 30 75 89 d8  |:.`..9<..?my0u..|
+00000380  1a 38 e5 2a 9d 15 50 4b  8b 43 01 a1 fc 82 94 7e  |.8.*..PK.C.....~|
+00000390  1a 6f 42 9a 23 93 ec 94  0d f7 aa df 3e f9 9b 82  |.oB.#.......>...|
+000003a0  5a 7d 0d fd 6c e7 92 7f  46 55 36 f6 11 fa 03 89  |Z}..l...FU6.....|
+000003b0  8e 6c 1e 8e b7 45 4c 45  18 32 4d 31 f8 00 77 a0  |.l...ELE.2M1..w.|
+000003c0  75 2b c9 a0 e1 6d e4 ad  16 db 6b 8e de 7c f1 bf  |u+...m....k..|..|
+000003d0  21 b7 17 03 03 00 35 f0  fe ed cb 96 51 d4 0b 57  |!.....5.....Q..W|
+000003e0  39 53 dd 0e 9b 15 43 69  ad 5e f5 bb bf 00 a4 f5  |9S....Ci.^......|
+000003f0  23 9c 33 6b 30 ce 13 13  ac 43 69 c7 2b 60 e3 5a  |#.3k0....Ci.+`.Z|
+00000400  52 a8 c2 28 26 aa 48 41  3f c3 7c 46 17 03 03 00  |R..(&.HA?.|F....|
+00000410  83 3f 89 fe 65 3a 81 7e  7e 1f 23 76 8e 63 6a db  |.?..e:.~~.#v.cj.|
+00000420  ae b9 33 c6 32 f0 75 bd  de cf 97 68 b8 f2 a0 5d  |..3.2.u....h...]|
+00000430  9a 29 41 9d 4e 2f 4b 58  8e f9 8a 98 75 1c 95 67  |.)A.N/KX....u..g|
+00000440  46 4e f6 4c 6d e2 56 86  13 e5 eb 87 36 c9 52 90  |FN.Lm.V.....6.R.|
+00000450  11 e5 09 9f bb 57 4e 80  0b ef 21 7f 60 8f bd d6  |.....WN...!.`...|
+00000460  35 9b 1a cc d2 3e 32 0f  6c e5 97 4d 5f be 95 fc  |5....>2.l..M_...|
+00000470  63 a4 55 07 9d d1 ca 3b  72 03 d3 a1 3a 7c f7 39  |c.U....;r...:|.9|
+00000480  a7 87 09 6e c1 92 95 44  2a 5b 27 56 46 47 8f 4f  |...n...D*['VFG.O|
+00000490  8f b6 58 df                                       |..X.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 ab dd 69 66 c8  |..........5..if.|
-00000010  f9 eb e6 e6 b0 a9 9b 10  1d fc ad 89 ad 4d f5 2b  |.............M.+|
-00000020  e4 d7 12 5b 1c 1e 81 12  df 24 ba ea 6b 3e 6f 82  |...[.....$..k>o.|
-00000030  dd 2f 38 a1 65 07 55 6a  4f 8e 99 5d 4f 35 b8 5d  |./8.e.UjO..]O5.]|
+00000000  14 03 03 00 01 01 17 03  03 00 35 7e b9 91 2d d5  |..........5~..-.|
+00000010  aa 2a 8b c0 47 8f d0 2d  8b 5c cf 8b 8a 47 ab fe  |.*..G..-.\...G..|
+00000020  c3 76 22 5d 14 ef 05 22  4f bf 60 7a 1d 82 72 b3  |.v"]..."O.`z..r.|
+00000030  d7 73 9f b2 f4 da 2b 56  64 08 6d 55 37 ed 6d 2e  |.s....+Vd.mU7.m.|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e e5 f4 e6  14 79 8c b9 a9 77 6b c9  |.........y...wk.|
-00000010  ff ad 60 f3 03 cf 48 19  19 71 6c 85 da 92 cb 79  |..`...H..ql....y|
-00000020  2b 20 41 17 03 03 00 13  69 de ca 08 9c cf 70 37  |+ A.....i.....p7|
-00000030  5e fc 32 31 1c 93 d1 e4  01 f3 c6                 |^.21.......|
+00000000  17 03 03 00 1e 7e 9c 6d  68 2d f5 37 73 08 06 67  |.....~.mh-.7s..g|
+00000010  db 10 7b 41 fc 86 7f b0  75 f4 d9 0c 1b 4a 3d ca  |..{A....u....J=.|
+00000020  d5 e2 30 17 03 03 00 13  f3 a0 0e bd 16 07 10 dc  |..0.............|
+00000030  91 be 0e b4 07 a3 df d3  f4 21 26                 |.........!&|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-RSA-RSAPSS b/src/crypto/tls/testdata/Server-TLSv13-RSA-RSAPSS
index db53ebbc5f..9bd0482de1 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-RSA-RSAPSS
+++ b/src/crypto/tls/testdata/Server-TLSv13-RSA-RSAPSS
@@ -1,97 +1,96 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 b2 01 00 00  ae 03 03 4d a5 7b 2c da  |...........M.{,.|
-00000010  67 11 9d 4d a0 92 2a 96  6c 85 ef 8c 52 0a 31 cf  |g..M..*.l...R.1.|
-00000020  43 23 3e 8d 67 63 9b 7e  84 94 17 20 a2 a1 87 c6  |C#>.gc.~... ....|
-00000030  5e 64 34 75 da ac ee ba  d4 d8 8f 2a a6 55 9f 4f  |^d4u.......*.U.O|
-00000040  48 38 5a 29 61 a4 ef 7d  1d 74 a7 71 00 04 13 03  |H8Z)a..}.t.q....|
+00000000  16 03 01 00 b2 01 00 00  ae 03 03 5e 26 a7 5d 55  |...........^&.]U|
+00000010  3f f7 12 49 ea 19 a6 36  80 a4 5e 48 ce 93 ba 19  |?..I...6..^H....|
+00000020  1d 09 aa 53 1c 3d 2c ca  2b e8 b4 20 a9 49 a3 4f  |...S.=,.+.. .I.O|
+00000030  e8 65 1a e6 44 49 4d ed  5d 60 53 0e 7c 11 01 19  |.e..DIM.]`S.|...|
+00000040  62 ef 47 10 13 b0 1a 02  2e 26 d6 03 00 04 13 03  |b.G......&......|
 00000050  00 ff 01 00 00 61 00 0b  00 04 03 00 01 02 00 0a  |.....a..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 06 00 04 08 06 08 04  |................|
 00000080  00 2b 00 03 02 03 04 00  2d 00 02 01 01 00 33 00  |.+......-.....3.|
-00000090  26 00 24 00 1d 00 20 16  5e 23 ca e7 24 31 81 c2  |&.$... .^#..$1..|
-000000a0  78 21 3a ee 8a f3 61 8a  46 a0 56 ee a9 ed 82 3a  |x!:...a.F.V....:|
-000000b0  87 b7 4a 0a 03 fe 59                              |..J...Y|
+00000090  26 00 24 00 1d 00 20 ff  7f 2b 87 7b 2c df 44 26  |&.$... ..+.{,.D&|
+000000a0  04 b0 2a a4 b2 17 c1 d2  36 50 95 a7 b4 9d 2e c3  |..*.....6P......|
+000000b0  e8 6d f7 40 77 6a 6a                              |.m.@wjj|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 a2 a1 87 c6  |........... ....|
-00000030  5e 64 34 75 da ac ee ba  d4 d8 8f 2a a6 55 9f 4f  |^d4u.......*.U.O|
-00000040  48 38 5a 29 61 a4 ef 7d  1d 74 a7 71 13 03 00 00  |H8Z)a..}.t.q....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 a9 49 a3 4f  |........... .I.O|
+00000030  e8 65 1a e6 44 49 4d ed  5d 60 53 0e 7c 11 01 19  |.e..DIM.]`S.|...|
+00000040  62 ef 47 10 13 b0 1a 02  2e 26 d6 03 13 03 00 00  |b.G......&......|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 f8 7a 9c bc 58 8d  |...........z..X.|
-00000090  ce cd ff e6 ae 2d c2 e0  40 33 4e c4 ec f5 90 dd  |.....-..@3N.....|
-000000a0  ba 17 03 03 02 6d f3 65  a1 b4 fe ef 40 37 72 fa  |.....m.e....@7r.|
-000000b0  a5 b8 10 ad 32 e3 08 e1  ac bb 14 f2 34 bf 25 19  |....2.......4.%.|
-000000c0  aa 2d 1a 78 cc 26 2f 5c  0b 7e 13 73 36 85 92 96  |.-.x.&/\.~.s6...|
-000000d0  0a 7a 27 f5 35 86 f1 ea  1a 5f 5c 3a 90 28 63 6a  |.z'.5...._\:.(cj|
-000000e0  b3 7c e0 56 32 10 55 67  59 e0 65 d6 11 ef 7c 50  |.|.V2.UgY.e...|P|
-000000f0  0b 9e 88 0a 61 96 93 cf  05 51 47 33 c3 5c e3 82  |....a....QG3.\..|
-00000100  01 6d f1 f7 5c dc df b2  61 7c d7 9f de b4 3e c0  |.m..\...a|....>.|
-00000110  6d b5 52 39 3b f6 33 c2  03 65 2b 66 39 ed d6 f0  |m.R9;.3..e+f9...|
-00000120  83 46 61 db fc 27 a5 8a  68 d6 8a 85 5d 3f b1 46  |.Fa..'..h...]?.F|
-00000130  a2 3a 32 37 1f e0 76 a6  79 7f eb b2 81 52 e7 e0  |.:27..v.y....R..|
-00000140  4f b2 db 48 7d 20 61 52  d4 22 2a b7 81 2f da 5b  |O..H} aR."*../.[|
-00000150  f6 e8 0a a6 91 b5 d1 f5  6b 5e 2b ad fd 70 cd a1  |........k^+..p..|
-00000160  f8 4d 73 31 3d 2a 49 d3  2e 6b b3 31 95 61 09 08  |.Ms1=*I..k.1.a..|
-00000170  c5 f9 eb db 42 b0 e1 5d  47 00 3e 7e 80 31 c6 d2  |....B..]G.>~.1..|
-00000180  37 dc 68 d7 36 05 ad 8a  a4 05 87 7a 1c 12 f6 ab  |7.h.6......z....|
-00000190  0e e1 5b 29 b1 1c 16 20  29 75 5a b0 59 24 59 df  |..[)... )uZ.Y$Y.|
-000001a0  62 fe f2 26 ad ab bf 2b  25 d7 9e db 04 f6 26 96  |b..&...+%.....&.|
-000001b0  f7 5f 2c ff 2e 6d 85 c7  58 c8 15 9c d0 7d dd 8e  |._,..m..X....}..|
-000001c0  1a 39 fc 3d 62 58 47 ce  83 7a ff fc 45 98 02 3d  |.9.=bXG..z..E..=|
-000001d0  aa 37 b7 5e a7 7b 8e fa  f2 05 8b 61 7f 04 08 f5  |.7.^.{.....a....|
-000001e0  af 1d 6e 55 18 d2 12 2e  bd 8a 80 3d cb e6 0f cd  |..nU.......=....|
-000001f0  3c d8 a5 38 db ee 07 c6  3b 75 55 c2 ee 2e 6a a3  |<..8....;uU...j.|
-00000200  fa 54 ce e3 45 92 c0 b9  8c 10 3d 2f 86 cb a5 c9  |.T..E.....=/....|
-00000210  af 37 f7 f6 6c 3e 4b 15  04 bd 46 98 31 5a b9 8c  |.7..l>K...F.1Z..|
-00000220  ec 67 0d 97 9d 26 56 65  9c a7 74 bb 88 45 dc 4e  |.g...&Ve..t..E.N|
-00000230  ce 70 a1 fc ce fc a7 d4  e1 7d a7 43 82 a6 e2 30  |.p.......}.C...0|
-00000240  e2 94 88 e5 1a 05 c5 28  06 14 7b 29 75 f9 4d 2c  |.......(..{)u.M,|
-00000250  bb 54 ee f5 17 4e 2a bf  04 e6 38 f2 cf ed ab a2  |.T...N*...8.....|
-00000260  ef ae ac 3d 80 5e 03 71  74 70 0c 68 93 ca ea 93  |...=.^.qtp.h....|
-00000270  e5 b1 d1 18 80 98 0e c6  e8 f5 65 87 e7 9a 33 1d  |..........e...3.|
-00000280  e6 3d e2 28 82 19 2a 9d  5f 1a a2 74 fa 27 8b d0  |.=.(..*._..t.'..|
-00000290  09 9a ba 1b c5 a6 4c 3b  c3 02 12 61 a1 8a 20 d3  |......L;...a.. .|
-000002a0  a4 3c 3b aa f2 08 de e0  de 07 9f a0 13 b4 e8 23  |.<;............#|
-000002b0  d3 a5 ff 12 74 55 29 3a  57 f5 14 b3 af e6 28 ed  |....tU):W.....(.|
-000002c0  b1 60 9c 6b 7d 55 a1 58  50 ab 42 71 5d 0e dc 76  |.`.k}U.XP.Bq]..v|
-000002d0  87 cd a1 d3 e4 26 25 c4  c1 23 1e 3b 31 13 3d f8  |.....&%..#.;1.=.|
-000002e0  b2 1b a8 07 f6 68 83 b4  7e 94 ca 84 95 55 38 d1  |.....h..~....U8.|
-000002f0  eb af 19 83 90 4a ab 0a  8d f6 48 9a 25 fa 59 97  |.....J....H.%.Y.|
-00000300  3c 5f 6a 2d 68 ec 29 d5  53 b4 9a 97 ea 59 fe 74  |<_j-h.).S....Y.t|
-00000310  81 0e b9 17 03 03 00 99  12 25 df 91 85 91 ac c0  |.........%......|
-00000320  60 4e 6e ed c4 b2 f0 f3  8b 66 53 75 11 07 29 d6  |`Nn......fSu..).|
-00000330  1f 01 81 60 de 5f b7 6b  5e 39 c8 ea f1 f8 2a 94  |...`._.k^9....*.|
-00000340  dd b6 c5 a9 31 be 87 a7  aa a9 64 03 16 40 df ef  |....1.....d..@..|
-00000350  37 ac 66 4c 19 f1 60 d5  b4 88 93 a7 42 ac e3 81  |7.fL..`.....B...|
-00000360  c8 88 3f e2 30 a0 ff b7  d5 19 fc f2 72 a7 97 a8  |..?.0.......r...|
-00000370  31 ce 20 be 90 bc f5 8a  24 31 b1 c6 2b 2a ad c5  |1. .....$1..+*..|
-00000380  7a 34 69 eb a7 86 53 61  a1 88 4f 58 2a 65 a2 18  |z4i...Sa..OX*e..|
-00000390  7a 93 81 c6 bd c7 bc 84  5b ff 85 aa ff fc 68 50  |z.......[.....hP|
-000003a0  cb 57 37 54 a7 0f 2e 64  82 53 b7 dc ea c2 e3 49  |.W7T...d.S.....I|
-000003b0  fd 17 03 03 00 35 da 2a  8c 37 83 a5 a0 d4 06 c4  |.....5.*.7......|
-000003c0  ff f3 85 6f e4 11 1f 37  0f 06 35 45 e9 51 43 6f  |...o...7..5E.QCo|
-000003d0  d2 a4 cb b7 ad f0 66 1c  20 40 c3 14 32 c0 57 71  |......f. @..2.Wq|
-000003e0  d3 8c 9c 7f 5b e6 50 a1  c2 e5 62 17 03 03 00 93  |....[.P...b.....|
-000003f0  30 b8 ab dc 3b df 60 aa  b1 d2 25 5a 60 da b6 c8  |0...;.`...%Z`...|
-00000400  22 88 93 79 25 44 56 aa  ec 93 e8 01 11 bf 69 ad  |"..y%DV.......i.|
-00000410  b2 c9 43 67 33 aa 6d ae  73 a3 95 2b f0 86 ed a2  |..Cg3.m.s..+....|
-00000420  db df e3 dc 9b 16 1d 8d  fc 2f a5 c4 41 d0 86 2f  |........./..A../|
-00000430  cc a1 a1 ce 9a e5 e6 c8  a2 d1 a8 b2 a4 15 9c 69  |...............i|
-00000440  38 5a fa fd de d4 02 95  24 67 1b 61 76 1f c4 65  |8Z......$g.av..e|
-00000450  01 fc 36 2d ef 2d 0f 8e  f0 5a 6d 04 07 b8 26 18  |..6-.-...Zm...&.|
-00000460  90 fc 82 1b 99 68 b0 13  7f 6e a1 9b c4 2a f3 b8  |.....h...n...*..|
-00000470  0b 6a 44 cd 04 e8 20 96  6d f5 48 cb 71 8a 04 10  |.jD... .m.H.q...|
-00000480  b8 8d 56                                          |..V|
+00000080  03 03 00 01 01 17 03 03  00 17 5c ad 71 71 c7 04  |..........\.qq..|
+00000090  a3 a0 cb 1e 20 0f 17 74  63 9a d3 09 fc bd 3e 4b  |.... ..tc.....>K|
+000000a0  ca 17 03 03 02 6d ef 2f  4d 74 69 dd 6f df 52 16  |.....m./Mti.o.R.|
+000000b0  21 ec ef 74 66 2c 4d 38  08 8d 69 c6 a8 92 12 2a  |!..tf,M8..i....*|
+000000c0  3c ac 75 bc 97 0b d6 34  9c 41 ec 9a 4a 9c 27 e2  |<.u....4.A..J.'.|
+000000d0  78 ff cd 11 f2 62 ec a9  1c 6f d4 c4 38 94 8a 6b  |x....b...o..8..k|
+000000e0  42 c0 d4 16 2d 9b 57 2d  83 5f 13 39 02 b6 27 ed  |B...-.W-._.9..'.|
+000000f0  12 38 04 ca b5 1c 72 8d  cc 88 27 68 d6 ea 84 07  |.8....r...'h....|
+00000100  5d de 4a c3 52 07 ca c5  6a ef b4 70 4e eb b6 8c  |].J.R...j..pN...|
+00000110  d6 46 7f f9 76 11 30 17  20 02 07 16 a2 5b 77 ad  |.F..v.0. ....[w.|
+00000120  a5 d5 73 a2 41 b5 1d c5  fa a8 4e b7 b8 36 b8 cc  |..s.A.....N..6..|
+00000130  48 a6 84 36 64 49 41 fa  07 ee 32 4a 21 d9 ef a2  |H..6dIA...2J!...|
+00000140  c9 34 33 ae 76 2a c8 ac  45 fc 4d 3b e2 4a 2e 8e  |.43.v*..E.M;.J..|
+00000150  16 10 20 05 80 35 c0 30  c7 4c 5f 34 ba f7 9d ef  |.. ..5.0.L_4....|
+00000160  0c 8e bf 57 67 89 44 ba  a8 3e 94 17 09 0f b3 41  |...Wg.D..>.....A|
+00000170  54 c8 17 06 a4 4f 13 50  bb 45 7d db 73 3d 0e 63  |T....O.P.E}.s=.c|
+00000180  5c 5f 3f 9d c9 07 75 c0  10 cf 45 25 5a f7 4c f7  |\_?...u...E%Z.L.|
+00000190  66 5a 62 fc 4c fd b0 54  f3 b9 d5 00 ba e3 d8 2a  |fZb.L..T.......*|
+000001a0  70 00 9c 67 93 64 5b 45  9a b9 bc 6d c5 45 af fe  |p..g.d[E...m.E..|
+000001b0  4f 99 fa 7f 07 0b 79 93  bf 6b 95 a9 c5 b3 ca 6e  |O.....y..k.....n|
+000001c0  f6 88 37 7c 24 c1 0d 40  e3 be 07 7f a2 37 67 51  |..7|$..@.....7gQ|
+000001d0  6e b0 ab 2e 33 9d 24 45  66 9e bb c7 90 70 17 1a  |n...3.$Ef....p..|
+000001e0  f6 e3 8d d7 68 47 83 d7  83 b4 e0 67 25 c1 e3 c8  |....hG.....g%...|
+000001f0  55 ec 21 08 cc 2e 42 7e  02 30 77 5c 2b 82 f9 3e  |U.!...B~.0w\+..>|
+00000200  b6 ce 71 ba f6 d4 67 0f  79 9f 8b e4 b9 21 94 33  |..q...g.y....!.3|
+00000210  b7 68 e4 2a 48 d0 65 cf  f2 e0 3e 99 91 29 d7 87  |.h.*H.e...>..)..|
+00000220  1a 03 e2 69 50 2b cb 10  84 14 11 2a f8 e5 79 eb  |...iP+.....*..y.|
+00000230  97 97 ec af 48 73 bd c9  cf ec d4 b3 8a 93 30 b9  |....Hs........0.|
+00000240  e5 6c e9 72 e9 d7 20 85  9d 1a aa 24 64 e1 79 70  |.l.r.. ....$d.yp|
+00000250  f3 61 5d 04 f0 bc 36 b3  a1 6a 9f 94 60 5c 3f af  |.a]...6..j..`\?.|
+00000260  d6 5e f6 db 93 10 d4 56  bf 2e 3e 73 3a cd af 8d  |.^.....V..>s:...|
+00000270  fc 5e b0 d4 7c fc 21 2d  d5 fe 8d b5 8a f0 82 5d  |.^..|.!-.......]|
+00000280  5c 13 43 9b a2 83 d0 d4  09 3d 8a 06 4a 58 22 c2  |\.C......=..JX".|
+00000290  82 b5 d2 b7 72 86 4c 62  58 fb d4 58 99 2b 98 c8  |....r.LbX..X.+..|
+000002a0  1f 84 4c 16 16 08 3b cd  f3 bb 63 20 f5 31 52 01  |..L...;...c .1R.|
+000002b0  b7 06 27 6f 2c 51 d2 5a  3d be db 40 c1 db 90 35  |..'o,Q.Z=..@...5|
+000002c0  fe 67 f0 48 d1 3d e8 9f  d3 c5 e2 3c 3b f9 d5 9e  |.g.H.=.....<;...|
+000002d0  c2 f5 5e 69 15 48 b2 eb  06 97 43 e3 ea 5e 2c 26  |..^i.H....C..^,&|
+000002e0  18 d9 3c a1 7f fd ba a8  51 88 46 3d 51 0b aa c8  |..<.....Q.F=Q...|
+000002f0  72 ab ce f6 00 81 1e 88  fb 6e 91 0f b8 fe 05 80  |r........n......|
+00000300  4a fe 6f 24 d4 16 35 bf  ed ab 40 77 e9 78 7e 6e  |J.o$..5...@w.x~n|
+00000310  f0 b7 b9 17 03 03 00 99  8a 60 02 4a 1a b7 2e c9  |.........`.J....|
+00000320  dd ed b4 78 a0 8a 86 3d  d4 1d 89 00 fa 7b 08 d3  |...x...=.....{..|
+00000330  ec d1 6b fe 07 15 6e db  a3 81 19 b2 7c 64 29 bb  |..k...n.....|d).|
+00000340  04 46 f6 1b b7 12 05 bb  fa 4a 0e 92 5c b7 4f 70  |.F.......J..\.Op|
+00000350  e2 5d 08 35 20 62 e8 16  b1 f8 be eb 10 8d 1e 57  |.].5 b.........W|
+00000360  b4 60 c8 3d 2b a0 b5 86  09 76 15 eb 76 77 31 40  |.`.=+....v..vw1@|
+00000370  45 18 6b ca 90 8b ff 25  95 86 3d 7b 93 2b a8 ea  |E.k....%..={.+..|
+00000380  8c 3f 6d b9 c4 ab 58 d6  66 7b 08 22 7a 26 6a 41  |.?m...X.f{."z&jA|
+00000390  e1 54 96 e1 db 68 a0 e4  7c 2d ce 10 c3 92 53 bf  |.T...h..|-....S.|
+000003a0  84 b8 3b d6 e2 6b a0 37  b7 bf af 7e a6 82 d2 90  |..;..k.7...~....|
+000003b0  5e 17 03 03 00 35 51 f5  7a 0c ba 36 36 36 b5 8f  |^....5Q.z..666..|
+000003c0  98 20 0a fa cd 0b 5a b6  0f cd 8f 67 c9 82 2a 03  |. ....Z....g..*.|
+000003d0  8c c0 74 29 43 d9 58 a7  b8 13 2d 75 9c 7c 14 bb  |..t)C.X...-u.|..|
+000003e0  f0 6a bc a2 16 1b 82 d9  0e f5 a5 17 03 03 00 83  |.j..............|
+000003f0  91 83 67 26 71 a5 98 49  79 0a bb 1d a2 e6 0e b1  |..g&q..Iy.......|
+00000400  30 2b c4 6e 97 a9 93 74  97 85 51 65 67 43 f0 04  |0+.n...t..QegC..|
+00000410  6f cc b1 9c 02 ff 4b 52  ce 36 07 bb 42 b9 e6 4b  |o.....KR.6..B..K|
+00000420  75 3a 79 bd 3c 50 7d 86  d2 13 ff fe a4 7b e4 6b  |u:y.<P}......{.k|
+00000430  09 6a a7 08 d1 43 0c 2e  96 a9 28 46 43 27 8c f9  |.j...C....(FC'..|
+00000440  1d 4d 96 48 51 0a 86 8f  bd 03 49 46 9f 35 1b a7  |.M.HQ.....IF.5..|
+00000450  01 17 46 5e 66 32 80 c0  7d ec 62 9c 91 6f 74 ef  |..F^f2..}.b..ot.|
+00000460  fa 14 b8 50 15 dc 97 0c  d9 dd be 48 ce 51 bc 5c  |...P.......H.Q.\|
+00000470  3b 62 4b                                          |;bK|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 54 e5 3f f8 77  |..........5T.?.w|
-00000010  59 e3 8b 02 0b 80 8d 59  12 22 23 09 cb d9 93 67  |Y......Y."#....g|
-00000020  c7 35 b4 45 a0 54 49 fd  65 b5 ff e6 3e 3c b9 bf  |.5.E.TI.e...><..|
-00000030  26 ca df 86 db a4 66 b5  3e 1f 36 69 a5 99 2b ed  |&.....f.>.6i..+.|
+00000000  14 03 03 00 01 01 17 03  03 00 35 5c 22 e9 04 21  |..........5\"..!|
+00000010  29 23 9d 73 16 c1 f5 a6  40 bb 1b ee 0e ae 09 5b  |)#.s....@......[|
+00000020  01 f6 3d cb 5b c8 d3 76  2b 0c f7 6c 29 dc 86 e1  |..=.[..v+..l)...|
+00000030  96 f0 75 30 34 1f e3 07  7f 96 70 a7 3c b3 cd 2b  |..u04.....p.<..+|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e e3 b4 3e  81 ff 1a 36 f8 11 53 64  |.......>...6..Sd|
-00000010  b9 28 4e 68 de ee 9c b6  4d 71 21 fa 85 56 30 ad  |.(Nh....Mq!..V0.|
-00000020  e9 c2 27 17 03 03 00 13  3d b8 13 b0 5f df 5a 05  |..'.....=..._.Z.|
-00000030  85 cf eb 48 86 fb c5 a0  67 f7 ee                 |...H....g..|
+00000000  17 03 03 00 1e 6c f1 ac  2c 31 8d cb 72 9d 00 88  |.....l..,1..r...|
+00000010  6b 54 23 07 a4 83 07 fa  68 12 fe 70 55 fc 86 a9  |kT#.....h..pU...|
+00000020  8d e1 65 17 03 03 00 13  93 b2 83 3b 16 dc 3a 38  |..e........;..:8|
+00000030  40 bf 6b 8e 17 d6 17 2b  eb 9c f5                 |@.k....+...|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-Resume b/src/crypto/tls/testdata/Server-TLSv13-Resume
index 091ffc3347..f09aecba80 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-Resume
+++ b/src/crypto/tls/testdata/Server-TLSv13-Resume
@@ -1,60 +1,58 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 6e 01 00 01  6a 03 03 b6 39 89 61 fd  |....n...j...9.a.|
-00000010  11 84 b3 4b a9 18 23 b2  35 3d 82 85 75 5c e2 f3  |...K..#.5=..u\..|
-00000020  c9 f4 b0 2f 05 fb 5a 90  da 73 38 20 7f 06 81 e5  |.../..Z..s8 ....|
-00000030  d0 10 08 d1 b0 3c 3c 4b  28 39 34 9a 56 ca 47 4a  |.....<<K(94.V.GJ|
-00000040  01 f9 03 2b 54 f1 14 53  bd 28 22 60 00 04 13 01  |...+T..S.("`....|
-00000050  00 ff 01 00 01 1d 00 0b  00 04 03 00 01 02 00 0a  |................|
+00000000  16 03 01 01 5e 01 00 01  5a 03 03 4a d8 ce b7 81  |....^...Z..J....|
+00000010  81 08 19 ae 15 cd a3 a1  69 cf 91 35 f3 b0 77 91  |........i..5..w.|
+00000020  4c 59 7a 91 52 8b 0e 5a  e8 4c bf 20 58 4d cf b1  |LYz.R..Z.L. XM..|
+00000030  9e 71 1d 9e 95 27 83 18  b1 29 13 3b 33 79 c4 3d  |.q...'...).;3y.=|
+00000040  6c 96 a4 d5 db f3 08 5c  6d f7 fe 28 00 04 13 01  |l......\m..(....|
+00000050  00 ff 01 00 01 0d 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 16 00 00 00 17  00 00 00 0d 00 1e 00 1c  |................|
 00000080  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000090  08 04 08 05 08 06 04 01  05 01 06 01 00 2b 00 03  |.............+..|
 000000a0  02 03 04 00 2d 00 02 01  01 00 33 00 26 00 24 00  |....-.....3.&.$.|
-000000b0  1d 00 20 83 a4 df 27 8d  52 a8 ce 3c af 7e 79 0c  |.. ...'.R..<.~y.|
-000000c0  b7 30 5e 5f 8d d6 14 1c  a1 65 72 40 73 bc 22 44  |.0^_.....er@s."D|
-000000d0  58 05 10 00 29 00 9c 00  77 00 71 50 46 ad c1 db  |X...)...w.qPF...|
-000000e0  a8 38 86 7b 2b bb fd d0  c3 42 3e 00 00 00 00 00  |.8.{+....B>.....|
-000000f0  00 00 00 00 00 00 00 00  00 00 00 94 68 2c a3 82  |............h,..|
-00000100  51 ed 14 ef 68 ca 42 c5  5c ab 26 c2 91 a9 01 83  |Q...h.B.\.&.....|
-00000110  13 26 8f 62 7c 89 c0 a2  b5 9b 6d 4f a4 c9 e2 49  |.&.b|.....mO...I|
-00000120  34 03 2c b2 7d d9 af eb  1a 99 76 3c a5 ef 70 78  |4.,.}.....v<..px|
-00000130  59 58 1c 45 80 c5 f1 b8  91 b2 54 71 3f bf 4f 2a  |YX.E......Tq?.O*|
-00000140  b2 9d 9d 6f 6f 1c f1 3c  6c e6 a2 73 00 00 00 00  |...oo..<l..s....|
-00000150  00 21 20 95 92 91 9a 6d  da d5 c4 94 f7 2e ed 1a  |.! ....m........|
-00000160  5b cd 54 55 8f 87 25 ee  58 d6 92 94 a4 e7 c5 e3  |[.TU..%.X.......|
-00000170  58 4f bd                                          |XO.|
+000000b0  1d 00 20 b9 4b 27 a1 8c  14 d5 53 0c 0d e4 d5 3f  |.. .K'....S....?|
+000000c0  96 d6 fd a2 06 69 57 0f  eb c1 f9 fc 7a 36 04 ce  |.....iW.....z6..|
+000000d0  f3 7e 29 00 29 00 8c 00  67 00 61 00 00 00 00 00  |.~).)...g.a.....|
+000000e0  00 00 00 00 00 00 00 00  00 00 00 94 68 2c a3 82  |............h,..|
+000000f0  51 ed 14 ef 68 ca 42 c5  5c 0e f0 13 2b 49 4b af  |Q...h.B.\...+IK.|
+00000100  0a 68 2a 6d 66 17 44 4e  21 1f 93 74 1c 94 2e 64  |.h*mf.DN!..t...d|
+00000110  97 80 eb 5a e9 00 26 db  dd 99 76 3c c3 a2 8a 88  |...Z..&...v<....|
+00000120  24 10 e6 07 1a b5 9e 15  04 26 83 13 ba 92 76 3e  |$........&....v>|
+00000130  ef ea 7b 42 ee 47 e8 7a  f6 0e 61 db 00 00 00 00  |..{B.G.z..a.....|
+00000140  00 21 20 a3 43 af 6e e8  fc 95 e0 85 23 4d d7 b5  |.! .C.n.....#M..|
+00000150  9f 90 ba f8 73 28 a4 bf  9f b4 23 f2 cb 80 d0 c3  |....s(....#.....|
+00000160  2a 92 a0                                          |*..|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 80 02 00 00  7c 03 03 00 00 00 00 00  |........|.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 7f 06 81 e5  |........... ....|
-00000030  d0 10 08 d1 b0 3c 3c 4b  28 39 34 9a 56 ca 47 4a  |.....<<K(94.V.GJ|
-00000040  01 f9 03 2b 54 f1 14 53  bd 28 22 60 13 01 00 00  |...+T..S.("`....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 58 4d cf b1  |........... XM..|
+00000030  9e 71 1d 9e 95 27 83 18  b1 29 13 3b 33 79 c4 3d  |.q...'...).;3y.=|
+00000040  6c 96 a4 d5 db f3 08 5c  6d f7 fe 28 13 01 00 00  |l......\m..(....|
 00000050  34 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |4.+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 00  |.........._X.;t.|
 00000080  29 00 02 00 00 14 03 03  00 01 01 17 03 03 00 17  |)...............|
-00000090  18 d7 0c 38 47 21 c2 8e  01 fe e7 1f 35 ee 7f 8f  |...8G!......5...|
-000000a0  04 10 7a 06 61 1f 4d 17  03 03 00 35 b3 38 29 ce  |..z.a.M....5.8).|
-000000b0  18 2b 22 5e 01 4d 07 04  87 65 68 85 9d 10 e9 9e  |.+"^.M...eh.....|
-000000c0  5a a8 a5 cb 8d f9 48 fe  1b 17 30 04 be 55 92 ce  |Z.....H...0..U..|
-000000d0  74 9b 8e 9c 6b 77 5d 09  ca 58 8e c0 ac 85 3b 4e  |t...kw]..X....;N|
-000000e0  0b 17 03 03 00 93 90 64  70 a6 d7 20 8e 50 6d b7  |.......dp.. .Pm.|
-000000f0  53 3d ed eb 85 e0 2f fe  a2 88 84 3d 26 8a 18 65  |S=..../....=&..e|
-00000100  d1 c0 d2 c4 66 2a 2e 8c  06 5f 46 ee fe 36 f7 00  |....f*..._F..6..|
-00000110  57 3f 95 b3 36 47 0c 1a  78 c4 e3 d6 c1 ae 2f 96  |W?..6G..x...../.|
-00000120  f0 e6 5e 61 86 d7 c1 d7  cc d2 a6 19 0c 29 f5 19  |..^a.........)..|
-00000130  d5 5e 75 6f 8b 49 4b 0b  e9 c9 3c 69 87 ab b7 1d  |.^uo.IK...<i....|
-00000140  38 84 28 0e 40 79 be 71  dc 61 68 72 c9 a6 83 a4  |8.(.@y.q.ahr....|
-00000150  79 c9 53 4d 43 98 0f e9  33 3c 63 d3 99 e2 97 46  |y.SMC...3<c....F|
-00000160  d1 c1 18 b6 b8 14 ee 19  df 56 94 43 34 b8 af 1f  |.........V.C4...|
-00000170  4f f7 c1 e6 d5 17 13 6c  bd                       |O......l.|
+00000090  15 eb 8b 3b 3b 11 c3 29  34 e6 de 27 08 a2 7f 1e  |...;;..)4..'....|
+000000a0  10 ce 18 67 06 de f0 17  03 03 00 35 b4 48 82 07  |...g.......5.H..|
+000000b0  73 9e 31 b4 c1 a1 c6 f0  30 71 2f 68 42 ff e8 71  |s.1.....0q/hB..q|
+000000c0  6c b8 49 c5 c7 7f e3 8a  4c 22 46 cc 4d b1 a5 db  |l.I.....L"F.M...|
+000000d0  0f 8a 98 b2 d0 fc 1f e2  a6 5e fc 53 fe 26 aa 45  |.........^.S.&.E|
+000000e0  a8 17 03 03 00 83 c6 ab  4b b5 81 7e f7 45 02 a5  |........K..~.E..|
+000000f0  01 73 df ff f6 5f 7d fd  7e cf a7 f6 c3 6a 3e 04  |.s..._}.~....j>.|
+00000100  f2 08 e3 c1 52 bf c6 10  ff da 21 a9 31 32 c9 07  |....R.....!.12..|
+00000110  2f 63 d0 89 ef 52 61 c1  7d 47 b7 0c 10 1f 90 fe  |/c...Ra.}G......|
+00000120  17 aa 0d f2 2d 34 9b f8  85 a3 ac 78 ee cd ec 7f  |....-4.....x....|
+00000130  1e c8 32 be f4 e9 88 0a  7b c1 c6 89 7e 20 56 86  |..2.....{...~ V.|
+00000140  69 e4 1c a3 69 51 a2 53  6e 30 71 9e d8 4b 16 67  |i...iQ.Sn0q..K.g|
+00000150  c6 5c 36 36 83 3e f7 29  58 4d 52 b2 35 18 07 97  |.\66.>.)XMR.5...|
+00000160  0f 64 e3 75 e1 24 9e 8d  68                       |.d.u.$..h|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 69 08 b0 a0 71  |..........5i...q|
-00000010  1f 95 45 c4 b2 11 43 a9  b5 da ba 11 0a 2b 24 49  |..E...C......+$I|
-00000020  ac 3d 8e ec 32 c9 7f 3e  cc 1b fc 9a 68 d0 22 cb  |.=..2..>....h.".|
-00000030  37 0e 8f fe 4f 75 1a 62  44 20 60 c2 64 de 48 6d  |7...Ou.bD `.d.Hm|
+00000000  14 03 03 00 01 01 17 03  03 00 35 40 86 84 c9 1e  |..........5@....|
+00000010  28 47 1d 59 2a da 37 de  96 ea d6 29 8b 87 49 bf  |(G.Y*.7....)..I.|
+00000020  50 01 6e 25 e4 d3 5c e4  d7 a6 cc 66 fe dc aa 20  |P.n%..\....f... |
+00000030  78 b5 57 b9 1c 19 98 f5  30 f8 04 97 31 33 70 cd  |x.W.....0...13p.|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e d5 71 aa  53 2d 55 b7 76 11 45 b0  |......q.S-U.v.E.|
-00000010  f3 de f7 f1 78 0b 10 3f  49 7f ea 83 17 2e b9 50  |....x..?I......P|
-00000020  ec d2 0f 17 03 03 00 13  0a 22 58 66 d8 f7 ad fc  |........."Xf....|
-00000030  9c f2 da d1 ae 02 f8 99  d2 26 63                 |.........&c|
+00000000  17 03 03 00 1e 30 0c 80  74 7d 49 65 a2 ff 26 3a  |.....0..t}Ie..&:|
+00000010  3c 6c 97 d1 9d 04 66 e1  7b 70 a1 f2 54 03 a8 1d  |<l....f.{p..T...|
+00000020  00 8c c6 17 03 03 00 13  4f 3d b2 42 25 fa ef 85  |........O=.B%...|
+00000030  bb 31 e2 b1 ab e9 d3 38  0e 4f f0                 |.1.....8.O.|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-Resume-HelloRetryRequest b/src/crypto/tls/testdata/Server-TLSv13-Resume-HelloRetryRequest
index d0aa66a581..28e96d3ccd 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-Resume-HelloRetryRequest
+++ b/src/crypto/tls/testdata/Server-TLSv13-Resume-HelloRetryRequest
@@ -1,96 +1,93 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 68 01 00 01  64 03 03 a0 27 b0 af b0  |....h...d...'...|
-00000010  15 2c ed 88 b2 e8 c5 67  2e db 0d 29 13 64 bb 58  |.,.....g...).d.X|
-00000020  3b 71 67 a9 47 65 8a 3c  09 44 29 20 46 fe 89 4b  |;qg.Ge.<.D) F..K|
-00000030  f3 1d ed 40 2d 5c 1b 23  26 f5 72 6f d1 b4 77 f5  |...@-\.#&.ro..w.|
-00000040  1a 9f d1 98 34 46 fe 89  0b 2d c1 f9 00 04 13 01  |....4F...-......|
-00000050  00 ff 01 00 01 17 00 0b  00 04 03 00 01 02 00 0a  |................|
+00000000  16 03 01 01 58 01 00 01  54 03 03 46 58 dd 3f c2  |....X...T..FX.?.|
+00000010  d1 1c d2 b0 31 bd 51 a0  51 6a 83 fe 36 66 7e ca  |....1.Q.Qj..6f~.|
+00000020  b0 8c c1 99 7a ce 11 e7  e5 31 6b 20 62 92 49 27  |....z....1k b.I'|
+00000030  ef 4e 4a c1 9e c4 39 bf  7d 5b 1b c4 11 81 1c 50  |.NJ...9.}[.....P|
+00000040  62 56 bd dd 87 81 84 5a  97 86 b8 c1 00 04 13 01  |bV.....Z........|
+00000050  00 ff 01 00 01 07 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 06 00 04 00 1d 00 17  00 23 00 00 00 16 00 00  |.........#......|
 00000070  00 17 00 00 00 0d 00 1e  00 1c 04 03 05 03 06 03  |................|
 00000080  08 07 08 08 08 09 08 0a  08 0b 08 04 08 05 08 06  |................|
 00000090  04 01 05 01 06 01 00 2b  00 03 02 03 04 00 2d 00  |.......+......-.|
-000000a0  02 01 01 00 33 00 26 00  24 00 1d 00 20 8c 7b 61  |....3.&.$... .{a|
-000000b0  71 c8 0b 1a 17 14 d9 eb  21 38 e6 2f c0 40 e9 2d  |q.......!8./.@.-|
-000000c0  3c 91 c5 4e 9d bb dd af  40 bc 91 38 74 00 29 00  |<..N....@..8t.).|
-000000d0  9c 00 77 00 71 50 46 ad  c1 db a8 38 86 7b 2b bb  |..w.qPF....8.{+.|
-000000e0  fd d0 c3 42 3e 00 00 00  00 00 00 00 00 00 00 00  |...B>...........|
-000000f0  00 00 00 00 00 94 68 2c  a3 82 51 ed 14 ef 68 ca  |......h,..Q...h.|
-00000100  42 c5 5c ab 26 c2 91 a9  01 83 13 26 8f 62 7c 89  |B.\.&......&.b|.|
-00000110  c0 a2 b5 9b 6d 4f a4 c9  e2 49 34 03 2c b2 7d d9  |....mO...I4.,.}.|
-00000120  af eb 1a 99 76 3c a5 ef  70 78 59 58 1c 45 80 c5  |....v<..pxYX.E..|
-00000130  f1 b8 91 b2 54 71 3f bf  4f 2a b2 9d 9d 6f 6f 1c  |....Tq?.O*...oo.|
-00000140  f1 3c 6c e6 a2 73 00 00  00 00 00 21 20 7b 6e 44  |.<l..s.....! {nD|
-00000150  ea e1 4c 20 9a d4 1c b5  32 0b d4 79 8e c7 50 fb  |..L ....2..y..P.|
-00000160  4e 94 6e 02 1c d3 6a 4e  86 cb ae 2c 02           |N.n...jN...,.|
+000000a0  02 01 01 00 33 00 26 00  24 00 1d 00 20 00 cf 4b  |....3.&.$... ..K|
+000000b0  3b 91 5e 37 9e f9 de bd  54 d1 08 cc 3b 7d 7d 4c  |;.^7....T...;}}L|
+000000c0  d6 9a fe 31 77 18 10 69  f4 cf de 02 2a 00 29 00  |...1w..i....*.).|
+000000d0  8c 00 67 00 61 00 00 00  00 00 00 00 00 00 00 00  |..g.a...........|
+000000e0  00 00 00 00 00 94 68 2c  a3 82 51 ed 14 ef 68 ca  |......h,..Q...h.|
+000000f0  42 c5 5c 0e f0 13 2b 49  4b af 0a 68 2a 6d 66 17  |B.\...+IK..h*mf.|
+00000100  44 4e 21 1f 93 74 1c 94  2e 64 97 80 eb 5a e9 00  |DN!..t...d...Z..|
+00000110  26 db dd 99 76 3c c3 a2  8a 88 24 10 e6 07 1a b5  |&...v<....$.....|
+00000120  9e 15 04 26 83 13 ba 92  76 3e ef ea 7b 42 ee 47  |...&....v>..{B.G|
+00000130  e8 7a f6 0e 61 db 00 00  00 00 00 21 20 5a 80 55  |.z..a......! Z.U|
+00000140  fe 28 0d b4 8e 72 dc 57  c4 b5 53 3e 3d 14 6d d9  |.(...r.W..S>=.m.|
+00000150  44 21 68 ad f0 c5 a1 e9  70 82 99 1a b5           |D!h.....p....|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 58 02 00 00  54 03 03 cf 21 ad 74 e5  |....X...T...!.t.|
 00000010  9a 61 11 be 1d 8c 02 1e  65 b8 91 c2 a2 11 16 7a  |.a......e......z|
-00000020  bb 8c 5e 07 9e 09 e2 c8  a8 33 9c 20 46 fe 89 4b  |..^......3. F..K|
-00000030  f3 1d ed 40 2d 5c 1b 23  26 f5 72 6f d1 b4 77 f5  |...@-\.#&.ro..w.|
-00000040  1a 9f d1 98 34 46 fe 89  0b 2d c1 f9 13 01 00 00  |....4F...-......|
+00000020  bb 8c 5e 07 9e 09 e2 c8  a8 33 9c 20 62 92 49 27  |..^......3. b.I'|
+00000030  ef 4e 4a c1 9e c4 39 bf  7d 5b 1b c4 11 81 1c 50  |.NJ...9.}[.....P|
+00000040  62 56 bd dd 87 81 84 5a  97 86 b8 c1 13 01 00 00  |bV.....Z........|
 00000050  0c 00 2b 00 02 03 04 00  33 00 02 00 17 14 03 03  |..+.....3.......|
 00000060  00 01 01                                          |...|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 16 03  03 01 89 01 00 01 85 03  |................|
-00000010  03 a0 27 b0 af b0 15 2c  ed 88 b2 e8 c5 67 2e db  |..'....,.....g..|
-00000020  0d 29 13 64 bb 58 3b 71  67 a9 47 65 8a 3c 09 44  |.).d.X;qg.Ge.<.D|
-00000030  29 20 46 fe 89 4b f3 1d  ed 40 2d 5c 1b 23 26 f5  |) F..K...@-\.#&.|
-00000040  72 6f d1 b4 77 f5 1a 9f  d1 98 34 46 fe 89 0b 2d  |ro..w.....4F...-|
-00000050  c1 f9 00 04 13 01 00 ff  01 00 01 38 00 0b 00 04  |...........8....|
+00000000  14 03 03 00 01 01 16 03  03 01 79 01 00 01 75 03  |..........y...u.|
+00000010  03 46 58 dd 3f c2 d1 1c  d2 b0 31 bd 51 a0 51 6a  |.FX.?.....1.Q.Qj|
+00000020  83 fe 36 66 7e ca b0 8c  c1 99 7a ce 11 e7 e5 31  |..6f~.....z....1|
+00000030  6b 20 62 92 49 27 ef 4e  4a c1 9e c4 39 bf 7d 5b  |k b.I'.NJ...9.}[|
+00000040  1b c4 11 81 1c 50 62 56  bd dd 87 81 84 5a 97 86  |.....PbV.....Z..|
+00000050  b8 c1 00 04 13 01 00 ff  01 00 01 28 00 0b 00 04  |...........(....|
 00000060  03 00 01 02 00 0a 00 06  00 04 00 1d 00 17 00 23  |...............#|
 00000070  00 00 00 16 00 00 00 17  00 00 00 0d 00 1e 00 1c  |................|
 00000080  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000090  08 04 08 05 08 06 04 01  05 01 06 01 00 2b 00 03  |.............+..|
 000000a0  02 03 04 00 2d 00 02 01  01 00 33 00 47 00 45 00  |....-.....3.G.E.|
-000000b0  17 00 41 04 6e 14 0d ac  3f 1a 2a 36 54 4f ec 9d  |..A.n...?.*6TO..|
-000000c0  da 5b 93 12 42 eb 58 11  1b 4c 5c 39 a2 32 b8 5b  |.[..B.X..L\9.2.[|
-000000d0  41 13 51 05 88 fe 45 d2  01 ef 8d 14 bc 96 de d3  |A.Q...E.........|
-000000e0  1c e3 eb 0c a0 a7 a3 7c  1c b1 9e 38 c2 dc f6 35  |.......|...8...5|
-000000f0  7b 5b 08 2e 00 29 00 9c  00 77 00 71 50 46 ad c1  |{[...)...w.qPF..|
-00000100  db a8 38 86 7b 2b bb fd  d0 c3 42 3e 00 00 00 00  |..8.{+....B>....|
-00000110  00 00 00 00 00 00 00 00  00 00 00 00 94 68 2c a3  |.............h,.|
-00000120  82 51 ed 14 ef 68 ca 42  c5 5c ab 26 c2 91 a9 01  |.Q...h.B.\.&....|
-00000130  83 13 26 8f 62 7c 89 c0  a2 b5 9b 6d 4f a4 c9 e2  |..&.b|.....mO...|
-00000140  49 34 03 2c b2 7d d9 af  eb 1a 99 76 3c a5 ef 70  |I4.,.}.....v<..p|
-00000150  78 59 58 1c 45 80 c5 f1  b8 91 b2 54 71 3f bf 4f  |xYX.E......Tq?.O|
-00000160  2a b2 9d 9d 6f 6f 1c f1  3c 6c e6 a2 73 00 00 00  |*...oo..<l..s...|
-00000170  00 00 21 20 10 ac 47 8c  dd 4f 9c ee f3 b2 0a 6b  |..! ..G..O.....k|
-00000180  30 56 13 1e a9 53 5b 02  a8 a0 c0 db 1a 44 f7 43  |0V...S[......D.C|
-00000190  af a3 8f b8                                       |....|
+000000b0  17 00 41 04 e1 fd 0d 00  b6 d5 bb 84 6b e5 b1 a8  |..A.........k...|
+000000c0  bb ce 5b 22 3d fc 00 9d  27 87 ab f7 c2 e3 6d b7  |..["=...'.....m.|
+000000d0  42 ac 80 c6 0b b2 b3 20  e4 dc 6c a7 bd fc 68 f5  |B...... ..l...h.|
+000000e0  53 d6 70 82 de 03 19 32  16 7b cb 09 dd c8 e3 b9  |S.p....2.{......|
+000000f0  0f bd a6 28 00 29 00 8c  00 67 00 61 00 00 00 00  |...(.)...g.a....|
+00000100  00 00 00 00 00 00 00 00  00 00 00 00 94 68 2c a3  |.............h,.|
+00000110  82 51 ed 14 ef 68 ca 42  c5 5c 0e f0 13 2b 49 4b  |.Q...h.B.\...+IK|
+00000120  af 0a 68 2a 6d 66 17 44  4e 21 1f 93 74 1c 94 2e  |..h*mf.DN!..t...|
+00000130  64 97 80 eb 5a e9 00 26  db dd 99 76 3c c3 a2 8a  |d...Z..&...v<...|
+00000140  88 24 10 e6 07 1a b5 9e  15 04 26 83 13 ba 92 76  |.$........&....v|
+00000150  3e ef ea 7b 42 ee 47 e8  7a f6 0e 61 db 00 00 00  |>..{B.G.z..a....|
+00000160  00 00 21 20 25 c6 50 69  e5 8a ee cd bb 34 25 96  |..! %.Pi.....4%.|
+00000170  00 1c 51 f3 fb ec 90 eb  4d d5 60 a7 6a 55 cb 38  |..Q.....M.`.jU.8|
+00000180  71 40 81 68                                       |q@.h|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 a1 02 00 00  9d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 46 fe 89 4b  |........... F..K|
-00000030  f3 1d ed 40 2d 5c 1b 23  26 f5 72 6f d1 b4 77 f5  |...@-\.#&.ro..w.|
-00000040  1a 9f d1 98 34 46 fe 89  0b 2d c1 f9 13 01 00 00  |....4F...-......|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 62 92 49 27  |........... b.I'|
+00000030  ef 4e 4a c1 9e c4 39 bf  7d 5b 1b c4 11 81 1c 50  |.NJ...9.}[.....P|
+00000040  62 56 bd dd 87 81 84 5a  97 86 b8 c1 13 01 00 00  |bV.....Z........|
 00000050  55 00 2b 00 02 03 04 00  33 00 45 00 17 00 41 04  |U.+.....3.E...A.|
 00000060  1e 18 37 ef 0d 19 51 88  35 75 71 b5 e5 54 5b 12  |..7...Q.5uq..T[.|
 00000070  2e 8f 09 67 fd a7 24 20  3e b2 56 1c ce 97 28 5e  |...g..$ >.V...(^|
 00000080  f8 2b 2d 4f 9e f1 07 9f  6c 4b 5b 83 56 e2 32 42  |.+-O....lK[.V.2B|
 00000090  e9 58 b6 d7 49 a6 b5 68  1a 41 03 56 6b dc 5a 89  |.X..I..h.A.Vk.Z.|
-000000a0  00 29 00 02 00 00 17 03  03 00 17 ea 86 30 48 65  |.)...........0He|
-000000b0  cf a6 d4 9d af f7 75 d4  d3 dd af 79 ce 3a 42 5b  |......u....y.:B[|
-000000c0  68 7a 17 03 03 00 35 ef  d6 22 53 ec 3c 27 84 c7  |hz....5.."S.<'..|
-000000d0  7f b2 81 8e 3e 70 51 25  95 b4 6a 79 01 15 60 c0  |....>pQ%..jy..`.|
-000000e0  39 eb 5b 90 7b 50 f5 3b  50 64 d2 b2 d6 c7 72 cf  |9.[.{P.;Pd....r.|
-000000f0  35 f3 25 1c 86 4b 69 ab  6e 50 86 2e 17 03 03 00  |5.%..Ki.nP......|
-00000100  93 66 5a c1 de c6 92 96  95 92 48 90 e7 0f e1 08  |.fZ.......H.....|
-00000110  25 b2 72 a5 7f c5 17 6e  70 5d 6e 68 78 32 72 8d  |%.r....np]nhx2r.|
-00000120  3a fa 7a 66 76 26 10 9e  f9 92 ca 3b a7 6c 6c fa  |:.zfv&.....;.ll.|
-00000130  72 d1 22 f4 b0 b9 2a 90  bd ce 58 e4 ff 1d 88 99  |r."...*...X.....|
-00000140  a4 8d f9 10 af c8 35 cd  c4 6f 99 cd 9e 6c 95 b1  |......5..o...l..|
-00000150  b7 6e a4 48 9e 75 f1 d3  c0 b3 27 f1 61 83 ea 13  |.n.H.u....'.a...|
-00000160  06 7f 37 38 f1 31 9e 71  5a 97 15 b5 46 63 44 e8  |..78.1.qZ...FcD.|
-00000170  f4 a1 fc 81 5d f4 c7 65  be 76 da 79 bd fb e4 e6  |....]..e.v.y....|
-00000180  68 de ce f3 32 6b 0c ee  19 18 75 33 77 f2 34 3d  |h...2k....u3w.4=|
-00000190  9e c3 da b7                                       |....|
+000000a0  00 29 00 02 00 00 17 03  03 00 17 b5 4a 8d aa 38  |.)..........J..8|
+000000b0  5f f3 ca 15 93 0a 63 76  92 0a 22 c3 90 bd d0 2c  |_.....cv.."....,|
+000000c0  9f 69 17 03 03 00 35 99  55 50 9c 1d 81 4b 83 2d  |.i....5.UP...K.-|
+000000d0  6f 03 e6 4a 8f 59 b1 c1  4b 7a 1d f4 b7 73 b4 b9  |o..J.Y..Kz...s..|
+000000e0  57 aa 54 ea f7 d5 44 59  af d3 2c 81 08 5b 0e 24  |W.T...DY..,..[.$|
+000000f0  ec cd b0 99 41 b0 e6 aa  3a 0c c0 8b 17 03 03 00  |....A...:.......|
+00000100  83 ee e9 7f bb 8d f3 9e  a3 7b 06 2a cb 44 ab e1  |.........{.*.D..|
+00000110  d3 3d 5f 12 c8 73 fd 6c  f1 5b 53 cf 99 f2 a2 2a  |.=_..s.l.[S....*|
+00000120  f1 f2 e9 57 9d 31 65 b0  4a c0 3f 29 6a 0d 11 7c  |...W.1e.J.?)j..||
+00000130  d7 7f 37 16 53 54 95 59  0b 61 e6 aa d3 10 e1 10  |..7.ST.Y.a......|
+00000140  44 51 7d fb 73 8c 85 7f  d9 8e 02 58 ba 6b 95 b8  |DQ}.s......X.k..|
+00000150  de 2c f7 73 90 61 50 2d  44 79 99 02 fc 67 e7 88  |.,.s.aP-Dy...g..|
+00000160  b0 0c ad 71 e2 07 78 95  fb 39 10 03 71 28 23 56  |...q..x..9..q(#V|
+00000170  e1 8d 2c cd 31 07 e8 5d  f4 41 3d 83 51 a2 c0 c2  |..,.1..].A=.Q...|
+00000180  88 41 dd b0                                       |.A..|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 35 59 51 fe  aa 0a 69 ef d5 0e ee e3  |....5YQ...i.....|
-00000010  0e 21 f7 e0 80 88 a0 da  23 7a 38 7f 73 e1 da e9  |.!......#z8.s...|
-00000020  7c 02 73 5e f2 64 e5 60  0e c6 d5 9e 7a 45 c2 0b  ||.s^.d.`....zE..|
-00000030  6f 08 46 46 5b f1 5b 67  5d 42                    |o.FF[.[g]B|
+00000000  17 03 03 00 35 02 aa 9b  cf 61 04 5a ed 64 98 08  |....5....a.Z.d..|
+00000010  18 39 86 b5 83 c4 73 de  81 58 eb af af 71 fd 62  |.9....s..X...q.b|
+00000020  64 e6 1d ef 70 69 11 9c  34 1d f8 4a 95 f1 5f 45  |d...pi..4..J.._E|
+00000030  b2 d1 e0 4b 07 80 4a af  b6 86                    |...K..J...|
 >>> Flow 6 (server to client)
-00000000  17 03 03 00 1e 3c a5 86  73 ea 62 44 ee 3b 45 a2  |.....<..s.bD.;E.|
-00000010  2a 57 ed 27 0e 65 40 48  23 10 7f ff 27 e5 4e d1  |*W.'.e@H#...'.N.|
-00000020  99 9a e1 17 03 03 00 13  1e 78 1a 08 4b 24 1b fc  |.........x..K$..|
-00000030  78 e5 ab fd 8f bf 53 26  f9 b7 c0                 |x.....S&...|
+00000000  17 03 03 00 1e 46 65 d1  bf 65 cf e6 e1 6a bf ab  |.....Fe..e...j..|
+00000010  3c d3 b6 64 c8 25 52 97  ae 70 af 80 24 14 e5 6c  |<..d.%R..p..$..l|
+00000020  7b c0 90 17 03 03 00 13  f8 ee 26 da 29 34 88 a2  |{.........&.)4..|
+00000030  73 cc 17 b3 36 b3 d8 72  6d 7b 0c                 |s...6..rm{.|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-X25519 b/src/crypto/tls/testdata/Server-TLSv13-X25519
index 0160c5aea7..50934fa373 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-X25519
+++ b/src/crypto/tls/testdata/Server-TLSv13-X25519
@@ -1,98 +1,97 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 c2 01 00 00  be 03 03 cb 53 78 a8 58  |............Sx.X|
-00000010  de 5b 75 c2 c5 b3 ac fa  c3 6e 85 a7 e5 a3 a4 ca  |.[u......n......|
-00000020  1f 82 95 38 fa 79 4c e2  c8 66 8a 20 be 7a 94 d6  |...8.yL..f. .z..|
-00000030  f4 82 e2 2f 3b 2c e4 5f  ae c2 8b be d1 2f b6 67  |.../;,._...../.g|
-00000040  9e 78 7a 51 86 1f c1 d9  8f 43 2f 78 00 04 13 03  |.xzQ.....C/x....|
+00000000  16 03 01 00 c2 01 00 00  be 03 03 46 20 08 91 0e  |...........F ...|
+00000010  7f ed 55 e3 48 ef 93 60  40 a2 bf 63 e7 a0 d6 26  |..U.H..`@..c...&|
+00000020  76 98 f8 f1 fb bc 1e 6f  f9 5b 01 20 ac 49 74 ef  |v......o.[. .It.|
+00000030  05 a4 4b e5 1b be 5b 5c  8c 96 0e 9c 56 47 8c f2  |..K...[\....VG..|
+00000040  a1 09 c7 75 33 24 df f5  07 e4 d2 53 00 04 13 03  |...u3$.....S....|
 00000050  00 ff 01 00 00 71 00 0b  00 04 03 00 01 02 00 0a  |.....q..........|
 00000060  00 04 00 02 00 1d 00 16  00 00 00 17 00 00 00 0d  |................|
 00000070  00 1e 00 1c 04 03 05 03  06 03 08 07 08 08 08 09  |................|
 00000080  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
 00000090  00 2b 00 03 02 03 04 00  2d 00 02 01 01 00 33 00  |.+......-.....3.|
-000000a0  26 00 24 00 1d 00 20 7f  3e a2 2e 2f 88 8a e1 f3  |&.$... .>../....|
-000000b0  6a a4 47 d7 6d b7 3c 02  c4 bb f6 de 41 38 50 74  |j.G.m.<.....A8Pt|
-000000c0  29 21 f5 fe 9f 0b 6f                              |)!....o|
+000000a0  26 00 24 00 1d 00 20 84  49 c3 da a7 a8 ba 76 9a  |&.$... .I.....v.|
+000000b0  df 49 48 01 ec 68 42 af  ee 06 bf b9 52 d5 ab 9a  |.IH..hB.....R...|
+000000c0  4f 27 ec 04 8a b4 21                              |O'....!|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 be 7a 94 d6  |........... .z..|
-00000030  f4 82 e2 2f 3b 2c e4 5f  ae c2 8b be d1 2f b6 67  |.../;,._...../.g|
-00000040  9e 78 7a 51 86 1f c1 d9  8f 43 2f 78 13 03 00 00  |.xzQ.....C/x....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 ac 49 74 ef  |........... .It.|
+00000030  05 a4 4b e5 1b be 5b 5c  8c 96 0e 9c 56 47 8c f2  |..K...[\....VG..|
+00000040  a1 09 c7 75 33 24 df f5  07 e4 d2 53 13 03 00 00  |...u3$.....S....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 fb 0e 8b 72 0d 35  |.............r.5|
-00000090  97 db e2 2e b8 20 be 96  27 6b cd ab 6b 24 5b c4  |..... ..'k..k$[.|
-000000a0  e9 17 03 03 02 6d 3a 21  03 ea 45 e9 4e f1 19 1e  |.....m:!..E.N...|
-000000b0  33 37 04 5b 3e db 54 f0  27 6f c7 96 78 50 01 46  |37.[>.T.'o..xP.F|
-000000c0  d1 8b 8f 79 70 21 9d 62  97 b9 bf 6d 14 e5 82 f4  |...yp!.b...m....|
-000000d0  ad 89 90 77 12 1f 61 8e  1d 94 d3 27 0f 0e eb 77  |...w..a....'...w|
-000000e0  8d b2 2f fb 58 b4 ee 88  19 91 47 d1 3d 10 9e 4a  |../.X.....G.=..J|
-000000f0  1e 41 b9 c6 41 8f 59 11  7f e0 ac e7 b9 d5 be 40  |.A..A.Y........@|
-00000100  cc aa bc ab 56 5a 2b a9  c9 cf df c0 dc 8f d2 9d  |....VZ+.........|
-00000110  59 a7 88 36 98 2e 87 c6  1d af 26 a1 e8 08 2d bd  |Y..6......&...-.|
-00000120  9b 5b 1c 4e 22 d2 a1 7c  4d 0b 0f af da 5d fe f7  |.[.N"..|M....]..|
-00000130  83 4d f6 54 c1 fe 03 73  6d c9 17 02 6b 78 09 91  |.M.T...sm...kx..|
-00000140  aa 61 9a 93 04 66 fa 6b  e8 2e d7 18 d2 4d 6e 25  |.a...f.k.....Mn%|
-00000150  c3 01 2f a5 0e 1b da a1  64 67 e5 a5 c0 5b ef ec  |../.....dg...[..|
-00000160  83 5a d3 0e 44 b7 d5 97  9c c7 c4 94 b4 4b 01 e6  |.Z..D........K..|
-00000170  48 28 21 cb 04 10 be b0  3b 53 df 15 47 12 67 ea  |H(!.....;S..G.g.|
-00000180  24 65 a1 ce 0b af 05 5b  c9 95 bf 28 2e 55 3c 21  |$e.....[...(.U<!|
-00000190  dc 6f 43 54 87 4d 2a b0  4a e8 01 01 e8 cf 07 6a  |.oCT.M*.J......j|
-000001a0  09 d0 f7 ae 97 e1 68 78  ff 33 7e 07 e1 77 ee ec  |......hx.3~..w..|
-000001b0  b8 1f d5 73 34 06 3f 32  57 e2 a4 52 82 31 86 cc  |...s4.?2W..R.1..|
-000001c0  2f 1b 9c 77 78 64 de 01  ac 4c f4 b9 bc 3d 0e f8  |/..wxd...L...=..|
-000001d0  d1 b7 bd 9c 35 05 19 dc  1c 3b 05 c2 c0 66 e7 c3  |....5....;...f..|
-000001e0  68 0e 6d d0 83 92 46 d1  7b 81 9b 87 5b 3f 5b b9  |h.m...F.{...[?[.|
-000001f0  fa cc a5 cc 04 d3 01 54  39 a7 66 50 82 b8 64 a6  |.......T9.fP..d.|
-00000200  06 e3 24 34 62 80 79 28  74 15 1c 8d 91 00 b0 fa  |..$4b.y(t.......|
-00000210  af 52 c3 6a fb c8 41 af  77 3d bd 67 d3 e6 2a 76  |.R.j..A.w=.g..*v|
-00000220  ab 63 90 bc 3c 56 31 2d  62 dd 84 98 3f 6a 6b e9  |.c..<V1-b...?jk.|
-00000230  af 2a ed 1a bf da b9 bd  23 f3 b0 5b a3 a3 72 21  |.*......#..[..r!|
-00000240  fb e9 0d 27 58 27 bd 11  60 49 4f f4 6a 38 a4 db  |...'X'..`IO.j8..|
-00000250  ff 26 88 d6 1b 50 35 a6  02 d9 e8 c6 05 54 2d 62  |.&...P5......T-b|
-00000260  92 7a 45 86 e5 7d 61 93  05 d6 61 ae af b4 43 cf  |.zE..}a...a...C.|
-00000270  21 40 d0 f1 7f 92 48 92  ed d5 bd 33 3c f9 69 0d  |!@....H....3<.i.|
-00000280  bf 7c 72 c4 85 e0 c3 42  4d 69 30 d1 5a 2d 11 95  |.|r....BMi0.Z-..|
-00000290  ee 9f 69 9b 99 b9 0c 17  51 15 17 d7 ea fb c8 01  |..i.....Q.......|
-000002a0  22 ac 3e 54 9f 2c 95 9d  3f 98 d3 9c ec d9 ac d8  |".>T.,..?.......|
-000002b0  71 6a d6 0f 53 5e ea 92  53 e3 dd 96 be 38 61 74  |qj..S^..S....8at|
-000002c0  5d 74 ac c4 8c 72 c6 82  dc f4 22 fb 5c 64 0f 33  |]t...r....".\d.3|
-000002d0  b3 31 a1 a9 e0 6d 96 14  0b e1 00 7d 42 44 45 02  |.1...m.....}BDE.|
-000002e0  42 63 a1 15 14 73 b6 e4  18 a7 30 9e e0 df a9 ba  |Bc...s....0.....|
-000002f0  44 72 64 ea 06 a4 a1 46  58 07 b1 a8 48 dc ea 73  |Drd....FX...H..s|
-00000300  35 d8 98 de 6c 13 93 bb  7a 64 fb df bf 93 cb 65  |5...l...zd.....e|
-00000310  a4 1a 3a 17 03 03 00 99  41 8d 8b b5 97 ae 6a fb  |..:.....A.....j.|
-00000320  28 ae 10 17 a7 a7 bd a2  a2 54 61 33 ea 5c 3d 82  |(........Ta3.\=.|
-00000330  6c 7d fe 3e 3b 6f 92 6b  6a 0a ee fe 85 90 67 59  |l}.>;o.kj.....gY|
-00000340  df d9 fc c0 4a 9a 5b ae  57 29 5d fb ff 74 28 f1  |....J.[.W)]..t(.|
-00000350  27 f4 ab ee f9 e8 04 cf  2b 62 4d a8 6a 4f ac 85  |'.......+bM.jO..|
-00000360  ec a5 18 d7 88 74 9e 3e  ea 79 8e 5d df f8 8a 1c  |.....t.>.y.]....|
-00000370  10 1b 1d d3 4a cf 2a 56  f2 ca 90 1f 37 2c cc b7  |....J.*V....7,..|
-00000380  31 91 fb d7 7f bb 07 e2  ec 84 8a 6f 08 a1 7e 2e  |1..........o..~.|
-00000390  62 8a 5c b9 76 d3 68 e5  d0 b8 73 92 86 80 e5 af  |b.\.v.h...s.....|
-000003a0  b4 ef 13 ea 3c 09 2a 3f  7e be 16 72 1c 46 a0 29  |....<.*?~..r.F.)|
-000003b0  0a 17 03 03 00 35 a7 10  63 c4 a1 7f 26 17 ba b7  |.....5..c...&...|
-000003c0  e3 86 6e 52 36 00 8e 68  84 dc 51 8d a6 0c 21 ba  |..nR6..h..Q...!.|
-000003d0  c3 d9 84 49 ed 57 78 98  68 be 78 a6 d1 f0 67 ac  |...I.Wx.h.x...g.|
-000003e0  65 9e d2 d8 f3 b9 58 27  24 57 83 17 03 03 00 93  |e.....X'$W......|
-000003f0  00 54 de 7f 11 18 1d 12  83 10 77 b2 e9 fd a7 a4  |.T........w.....|
-00000400  46 c4 1c 15 0d 24 e0 94  f8 ff 84 19 45 ad 52 c8  |F....$......E.R.|
-00000410  85 0b c5 4a a7 6d a1 b0  12 cb 13 58 f6 44 a3 e2  |...J.m.....X.D..|
-00000420  b8 7a b5 8c 8f 8a 47 76  ef cb 2d 7b 6e 75 81 39  |.z....Gv..-{nu.9|
-00000430  3e 12 e8 b5 c6 2d cb e0  fd ac af 58 5a 01 70 32  |>....-.....XZ.p2|
-00000440  0e 12 32 95 10 70 94 28  ec 9b 50 e5 78 c4 b7 75  |..2..p.(..P.x..u|
-00000450  97 4a 54 97 bb 30 e6 19  8a 86 87 d7 50 02 8f a8  |.JT..0......P...|
-00000460  1b 97 d6 e7 bf 25 66 9a  5a cd 5c 84 33 42 f1 72  |.....%f.Z.\.3B.r|
-00000470  d2 44 f1 64 e1 3d 38 b7  7a 32 e3 e8 9a 49 19 90  |.D.d.=8.z2...I..|
-00000480  00 2b f6                                          |.+.|
+00000080  03 03 00 01 01 17 03 03  00 17 c7 1b 2e 0d 20 52  |.............. R|
+00000090  0a 72 42 e5 ce d0 94 60  87 34 3c 6d e4 52 56 ec  |.rB....`.4<m.RV.|
+000000a0  c5 17 03 03 02 6d d6 48  77 63 ef e3 27 44 1b b9  |.....m.Hwc..'D..|
+000000b0  f4 84 ea e1 6a ff d1 38  24 39 f2 55 dd cb 08 dd  |....j..8$9.U....|
+000000c0  91 29 ab 86 fc 61 91 d6  a1 bf c5 f7 11 c6 49 ad  |.)...a........I.|
+000000d0  a7 5b df 22 22 61 92 7e  f7 c3 20 3a cb 72 47 52  |.[.""a.~.. :.rGR|
+000000e0  d3 18 be c9 9e 6a 4e b0  c1 45 b8 e3 91 c3 7f 4b  |.....jN..E.....K|
+000000f0  c4 f9 3b bd 3e 18 aa ff  e2 2a 84 90 07 ed 63 7f  |..;.>....*....c.|
+00000100  2b 82 32 0a 84 4b 77 a5  fd fa 09 e0 a8 ca 16 92  |+.2..Kw.........|
+00000110  2b 7a 48 a4 2d 82 b3 1e  63 ea d2 49 c1 88 6e 93  |+zH.-...c..I..n.|
+00000120  ba e0 2d 8e 89 e0 bb bf  2b ce 42 91 8c 5b f1 f4  |..-.....+.B..[..|
+00000130  19 9c 96 11 77 d9 b0 31  5a 65 82 66 2a ec 70 41  |....w..1Ze.f*.pA|
+00000140  b7 d0 25 f3 13 94 d4 6c  c1 0c 10 b7 ed 5d 8c d0  |..%....l.....]..|
+00000150  ef 77 bc 46 90 e7 db 17  04 41 b4 64 b3 83 88 34  |.w.F.....A.d...4|
+00000160  ee c2 76 f6 76 74 fc 48  94 56 95 2a 40 10 84 d8  |..v.vt.H.V.*@...|
+00000170  ca 98 5a 9e bf 72 11 77  1f d8 f1 27 9f 08 6e 95  |..Z..r.w...'..n.|
+00000180  7b cb 3c db 18 80 bd 64  53 6e 4d 19 a0 13 ce 36  |{.<....dSnM....6|
+00000190  6f de af de bd 51 dc 10  e9 90 27 26 86 b3 6b 49  |o....Q....'&..kI|
+000001a0  37 be 9d a3 e4 b9 b6 b6  d6 80 75 58 31 a3 9d 24  |7.........uX1..$|
+000001b0  4a be f2 ee ca 6d b6 f3  5a 0e 41 92 60 5e 9d 39  |J....m..Z.A.`^.9|
+000001c0  96 02 d3 66 cc 8f d2 9d  53 12 5f b7 42 1b ad a4  |...f....S._.B...|
+000001d0  57 54 63 87 f3 12 6e 84  71 a2 58 43 9a 37 01 a6  |WTc...n.q.XC.7..|
+000001e0  97 a0 43 77 1a e8 c9 ca  a9 c9 55 e6 e6 10 95 8b  |..Cw......U.....|
+000001f0  fd 6e c9 2e 89 03 21 56  20 32 c0 c7 7a 52 5b 06  |.n....!V 2..zR[.|
+00000200  8d 46 c4 cc a0 17 11 7d  6a 97 f1 bb 1b 69 52 23  |.F.....}j....iR#|
+00000210  de 6d ac 7e be d9 00 3a  ee 7f 79 2e 56 cd 86 bb  |.m.~...:..y.V...|
+00000220  50 c1 1f c3 85 d8 e8 1c  74 87 62 be f4 da 94 74  |P.......t.b....t|
+00000230  47 d5 94 fa 3a f1 c6 7e  dc 25 1d 03 7d 2a 86 8f  |G...:..~.%..}*..|
+00000240  92 3f 44 91 a3 62 cf 75  88 87 d0 d2 fe 56 95 e7  |.?D..b.u.....V..|
+00000250  57 aa da 1f 81 91 49 de  47 75 29 64 f4 a3 d8 01  |W.....I.Gu)d....|
+00000260  9a 82 66 43 d8 1b c7 69  ac 61 22 3e 75 c4 f7 2d  |..fC...i.a">u..-|
+00000270  9a c1 f7 8a 6f 6f f6 da  fb 72 5e 13 f3 c2 68 4d  |....oo...r^...hM|
+00000280  97 e9 9e 3c 36 52 bb 89  59 23 07 d5 f5 53 eb f5  |...<6R..Y#...S..|
+00000290  c4 4e 73 c7 9d 3f ad e7  13 62 b9 90 bd 40 91 b3  |.Ns..?...b...@..|
+000002a0  c2 88 6b 4c 53 fb a1 4d  b1 6e d1 8e d7 fc 1a 77  |..kLS..M.n.....w|
+000002b0  2a 27 db 15 85 1d 55 1e  04 51 e3 ca 97 6c 65 76  |*'....U..Q...lev|
+000002c0  48 15 26 82 31 b3 d5 c1  48 5b c0 37 31 6b 4f b1  |H.&.1...H[.71kO.|
+000002d0  9d 46 45 5b 6f ee a0 fa  38 9b 87 04 23 3e ae 38  |.FE[o...8...#>.8|
+000002e0  00 e8 34 c8 28 46 27 75  05 bd 21 7c 14 54 f6 98  |..4.(F'u..!|.T..|
+000002f0  c9 f4 72 b1 1f e2 83 49  62 76 26 6a c5 74 8b b6  |..r....Ibv&j.t..|
+00000300  d9 7b 7a b0 41 bf 8d fe  0a de cc 02 55 55 d9 39  |.{z.A.......UU.9|
+00000310  ae 20 51 17 03 03 00 99  da 69 0d 52 7e 06 63 13  |. Q......i.R~.c.|
+00000320  a3 48 21 9c 10 00 04 50  46 7d f2 fe b9 d3 87 03  |.H!....PF}......|
+00000330  f5 51 c9 45 7c 2f f2 4e  fc b3 50 e4 9c 54 8d 47  |.Q.E|/.N..P..T.G|
+00000340  62 c5 0b 1c 24 00 f9 81  f2 46 c5 0b c5 61 3d 74  |b...$....F...a=t|
+00000350  b8 51 cc b3 da 0a 16 cb  a0 69 39 c2 94 00 c1 da  |.Q.......i9.....|
+00000360  42 8d 5a 20 67 90 4c f6  bd 39 10 05 4b 43 44 d0  |B.Z g.L..9..KCD.|
+00000370  9c 93 12 fa ae d6 b5 38  f3 51 f1 05 19 a4 03 d0  |.......8.Q......|
+00000380  6d 36 1c 75 92 5c 4f e4  50 f3 0c 80 ba 46 71 81  |m6.u.\O.P....Fq.|
+00000390  64 3a 63 62 99 51 ae 60  d6 c7 34 fe f3 f8 10 26  |d:cb.Q.`..4....&|
+000003a0  a0 50 29 95 9d 8f 3b 79  56 cf af 66 28 ce f9 59  |.P)...;yV..f(..Y|
+000003b0  35 17 03 03 00 35 b6 0f  b1 75 94 80 f5 7f d4 2c  |5....5...u.....,|
+000003c0  8b 5f 6e 29 06 18 78 68  81 ae 4b d5 2d 49 dc 08  |._n)..xh..K.-I..|
+000003d0  5f 14 ec 1b 63 4e af 20  b2 ea 45 b9 b6 66 c0 7a  |_...cN. ..E..f.z|
+000003e0  ee 37 80 3e a5 61 f0 ee  70 cb 46 17 03 03 00 83  |.7.>.a..p.F.....|
+000003f0  c9 79 5a b5 96 75 a0 c5  99 63 8d 49 7b a3 d4 eb  |.yZ..u...c.I{...|
+00000400  38 74 94 6d 86 5c a9 c2  b8 21 03 27 14 ee 39 c5  |8t.m.\...!.'..9.|
+00000410  7f 89 c0 e4 0b 3c 0f bb  82 6e 29 ff 61 86 2f 8e  |.....<...n).a./.|
+00000420  fa 48 a7 5f 71 1c 04 df  ed 6d 32 15 c3 d5 07 65  |.H._q....m2....e|
+00000430  10 23 68 f8 dd 28 71 5a  fc bf 7c 10 ee 38 61 b4  |.#h..(qZ..|..8a.|
+00000440  af 82 d8 32 d8 ed a2 7e  25 44 f3 d2 20 16 69 7a  |...2...~%D.. .iz|
+00000450  00 3b 5c 90 2e 9b 87 21  e8 44 cd 69 80 ab 93 0c  |.;\....!.D.i....|
+00000460  df be c0 ca bc 8b 32 3c  5e 65 e2 e7 86 ea d9 54  |......2<^e.....T|
+00000470  e0 92 af                                          |...|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 9d c7 a1 4d 5f  |..........5...M_|
-00000010  7f 3a 04 b0 cf de 09 d5  84 c1 8f 9b 85 a6 a0 53  |.:.............S|
-00000020  c3 aa 19 5e a0 b2 a2 f1  22 f2 51 e0 25 c5 49 57  |...^....".Q.%.IW|
-00000030  52 de ad 75 ec e4 e3 36  84 78 22 c8 6c 80 88 8c  |R..u...6.x".l...|
+00000000  14 03 03 00 01 01 17 03  03 00 35 a5 a0 b8 17 16  |..........5.....|
+00000010  ce dc 0e d7 0f 8c 1e 65  81 f0 0c 37 31 0e 3b 70  |.......e...71.;p|
+00000020  ed cd fc b9 73 21 a3 35  94 4f 76 e2 09 40 4a c9  |....s!.5.Ov..@J.|
+00000030  2a 54 30 23 ee 37 53 de  9f e3 38 c2 dc 04 99 d4  |*T0#.7S...8.....|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 3f 0d f6  84 47 21 4e 37 7b df eb  |.....?...G!N7{..|
-00000010  eb 38 af a5 ec b9 b6 20  24 f5 1a 1e 25 77 92 82  |.8..... $...%w..|
-00000020  97 88 9f 17 03 03 00 13  e2 80 d8 e1 2a bf d5 e3  |............*...|
-00000030  bc b7 82 2f 50 2c e5 b9  4b 8c d6                 |.../P,..K..|
+00000000  17 03 03 00 1e e0 b1 66  dc f6 28 92 9a c1 da bb  |.......f..(.....|
+00000010  f6 ba aa a4 0a 64 4d 32  69 0f dd 88 8f 04 11 8f  |.....dM2i.......|
+00000020  d7 b6 93 17 03 03 00 13  ac 48 c7 4d 12 23 ba 3d  |.........H.M.#.=|
+00000030  39 5c f9 53 d6 9f 05 b5  9b f0 e8                 |9\.S.......|
diff --git a/src/crypto/tls/ticket.go b/src/crypto/tls/ticket.go
index b82ccd141e..494f83b033 100644
--- a/src/crypto/tls/ticket.go
+++ b/src/crypto/tls/ticket.go
@@ -5,7 +5,6 @@
 package tls
 
 import (
-	"bytes"
 	"crypto/aes"
 	"crypto/cipher"
 	"crypto/hmac"
@@ -26,10 +25,6 @@ type sessionState struct {
 	masterSecret []byte // opaque master_secret<1..2^16-1>;
 	// struct { opaque certificate<1..2^24-1> } Certificate;
 	certificates [][]byte // Certificate certificate_list<0..2^24-1>;
-
-	// usedOldKey is true if the ticket from which this session came from
-	// was encrypted with an older key and thus should be refreshed.
-	usedOldKey bool
 }
 
 func (m *sessionState) marshal() ([]byte, error) {
@@ -51,7 +46,7 @@ func (m *sessionState) marshal() ([]byte, error) {
 }
 
 func (m *sessionState) unmarshal(data []byte) bool {
-	*m = sessionState{usedOldKey: m.usedOldKey}
+	*m = sessionState{}
 	s := cryptobyte.String(data)
 	if ok := s.ReadUint16(&m.vers) &&
 		s.ReadUint16(&m.cipherSuite) &&
@@ -121,65 +116,57 @@ func (c *Conn) encryptTicket(state []byte) ([]byte, error) {
 		return nil, errors.New("tls: internal error: session ticket keys unavailable")
 	}
 
-	encrypted := make([]byte, ticketKeyNameLen+aes.BlockSize+len(state)+sha256.Size)
-	keyName := encrypted[:ticketKeyNameLen]
-	iv := encrypted[ticketKeyNameLen : ticketKeyNameLen+aes.BlockSize]
+	encrypted := make([]byte, aes.BlockSize+len(state)+sha256.Size)
+	iv := encrypted[:aes.BlockSize]
+	ciphertext := encrypted[aes.BlockSize : len(encrypted)-sha256.Size]
+	authenticated := encrypted[:len(encrypted)-sha256.Size]
 	macBytes := encrypted[len(encrypted)-sha256.Size:]
 
 	if _, err := io.ReadFull(c.config.rand(), iv); err != nil {
 		return nil, err
 	}
 	key := c.ticketKeys[0]
-	copy(keyName, key.keyName[:])
 	block, err := aes.NewCipher(key.aesKey[:])
 	if err != nil {
 		return nil, errors.New("tls: failed to create cipher while encrypting ticket: " + err.Error())
 	}
-	cipher.NewCTR(block, iv).XORKeyStream(encrypted[ticketKeyNameLen+aes.BlockSize:], state)
+	cipher.NewCTR(block, iv).XORKeyStream(ciphertext, state)
 
 	mac := hmac.New(sha256.New, key.hmacKey[:])
-	mac.Write(encrypted[:len(encrypted)-sha256.Size])
+	mac.Write(authenticated)
 	mac.Sum(macBytes[:0])
 
 	return encrypted, nil
 }
 
-func (c *Conn) decryptTicket(encrypted []byte) (plaintext []byte, usedOldKey bool) {
-	if len(encrypted) < ticketKeyNameLen+aes.BlockSize+sha256.Size {
-		return nil, false
+func (c *Conn) decryptTicket(encrypted []byte) []byte {
+	if len(encrypted) < aes.BlockSize+sha256.Size {
+		return nil
 	}
 
-	keyName := encrypted[:ticketKeyNameLen]
-	iv := encrypted[ticketKeyNameLen : ticketKeyNameLen+aes.BlockSize]
+	iv := encrypted[:aes.BlockSize]
+	ciphertext := encrypted[aes.BlockSize : len(encrypted)-sha256.Size]
+	authenticated := encrypted[:len(encrypted)-sha256.Size]
 	macBytes := encrypted[len(encrypted)-sha256.Size:]
-	ciphertext := encrypted[ticketKeyNameLen+aes.BlockSize : len(encrypted)-sha256.Size]
 
-	keyIndex := -1
-	for i, candidateKey := range c.ticketKeys {
-		if bytes.Equal(keyName, candidateKey.keyName[:]) {
-			keyIndex = i
-			break
-		}
-	}
-	if keyIndex == -1 {
-		return nil, false
-	}
-	key := &c.ticketKeys[keyIndex]
+	for _, key := range c.ticketKeys {
+		mac := hmac.New(sha256.New, key.hmacKey[:])
+		mac.Write(authenticated)
+		expected := mac.Sum(nil)
 
-	mac := hmac.New(sha256.New, key.hmacKey[:])
-	mac.Write(encrypted[:len(encrypted)-sha256.Size])
-	expected := mac.Sum(nil)
+		if subtle.ConstantTimeCompare(macBytes, expected) != 1 {
+			continue
+		}
 
-	if subtle.ConstantTimeCompare(macBytes, expected) != 1 {
-		return nil, false
-	}
+		block, err := aes.NewCipher(key.aesKey[:])
+		if err != nil {
+			return nil
+		}
+		plaintext := make([]byte, len(ciphertext))
+		cipher.NewCTR(block, iv).XORKeyStream(plaintext, ciphertext)
 
-	block, err := aes.NewCipher(key.aesKey[:])
-	if err != nil {
-		return nil, false
+		return plaintext
 	}
-	plaintext = make([]byte, len(ciphertext))
-	cipher.NewCTR(block, iv).XORKeyStream(plaintext, ciphertext)
 
-	return plaintext, keyIndex > 0
+	return nil
 }
