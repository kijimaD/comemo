commit 0140aae6d0009372cb5b781df7079aa62c97ddff
Author: Youlin Feng <fengyoulin@live.com>
Date:   Tue Oct 22 17:18:11 2024 +0800

    cmd/compile: optimize Ctz64 on 386
    
    Compared with the version generated by dec64.rules based on Ctz32,
    the number of assembly instructions is reduced by half.
    
    SwissMap uses TrailingZeros64 to find the first match in its control
    group and may benefit from this CL on 386 architectures.
    
    goos: linux
    goarch: 386
    cpu: 13th Gen Intel(R) Core(TM) i7-13700H
                       │   old.txt    │               new.txt                │
                       │    sec/op    │    sec/op     vs base                │
    TrailingZeros64-20   0.8828n ± 1%   0.6299n ± 1%  -28.65% (p=0.000 n=20)
    
    Change-Id: Iba08a3f4e13efd3349715dfb7fcd5fd470286cd3
    Reviewed-on: https://go-review.googlesource.com/c/go/+/624376
    Reviewed-by: David Chase <drchase@google.com>
    Reviewed-by: Keith Randall <khr@golang.org>
    Reviewed-by: Keith Randall <khr@google.com>
    LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
    Auto-Submit: Keith Randall <khr@golang.org>

 src/cmd/compile/internal/ssa/_gen/386.rules     |  1 +
 src/cmd/compile/internal/ssa/_gen/386Ops.go     |  7 ++--
 src/cmd/compile/internal/ssa/_gen/genericOps.go |  1 +
 src/cmd/compile/internal/ssa/opGen.go           | 22 ++++++++++++
 src/cmd/compile/internal/ssa/rewrite386.go      |  3 ++
 src/cmd/compile/internal/ssagen/intrinsics.go   |  9 ++++-
 src/cmd/compile/internal/x86/ssa.go             | 48 +++++++++++++++++++++++++
 7 files changed, 87 insertions(+), 4 deletions(-)
