commit 95eb5abd6340b271ae728f99986eeccbc0354ab1
Author: Damien Neil <dneil@google.com>
Date:   Mon Dec 12 16:43:37 2022 -0800

    path/filepath: do not Clean("a/../c:/b") into c:\b on Windows
    
    Do not permit Clean to convert a relative path into one starting
    with a drive reference. This change causes Clean to insert a .
    path element at the start of a path when the original path does not
    start with a volume name, and the first path element would contain
    a colon.
    
    This may introduce a spurious but harmless . path element under
    some circumstances. For example, Clean("a/../b:/../c") becomes `.\c`.
    
    This reverts CL 401595, since the change here supersedes the one
    in that CL.
    
    Thanks to RyotaK (https://twitter.com/ryotkak) for reporting this issue.
    
    Fixes #57274
    Fixes CVE-2022-41722
    
    Change-Id: I837446285a03aa74c79d7642720e01f354c2ca17
    Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1675249
    Reviewed-by: Roland Shoemaker <bracewell@google.com>
    Run-TryBot: Damien Neil <dneil@google.com>
    Reviewed-by: Julie Qiu <julieqiu@google.com>
    TryBot-Result: Security TryBots <security-trybots@go-security-trybots.iam.gserviceaccount.com>
    Reviewed-on: https://go-review.googlesource.com/c/go/+/468123
    Run-TryBot: Michael Pratt <mpratt@google.com>
    Reviewed-by: Than McIntosh <thanm@google.com>
    Auto-Submit: Michael Pratt <mpratt@google.com>
    TryBot-Result: Gopher Robot <gobot@golang.org>

 src/path/filepath/path.go              | 27 ++++++++++++++-------------
 src/path/filepath/path_test.go         |  8 ++++++++
 src/path/filepath/path_windows_test.go |  2 +-
 3 files changed, 23 insertions(+), 14 deletions(-)
