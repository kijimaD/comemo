commit 623d653db7cd2287305347196f7f4742b6b1fb38
Author: Russ Cox <rsc@golang.org>
Date:   Thu Jun 27 20:54:14 2019 -0400

    crypto/tls: deflake localPipe in tests
    
    The localPipe implementation assumes that every successful net.Dial
    results in exactly one successful listener.Accept. I don't believe this
    is guaranteed by essentially any operating system. For this test, we're
    seeing flakes on dragonfly (#29583).
    
    But see also #19519, flakes due to the same assumption on FreeBSD
    and macOS in package net's own tests.
    
    This CL rewrites localPipe to try a few times to get a matching pair
    of connections on the dial and accept side.
    
    Fixes #29583.
    
    Change-Id: Idb045b18c404eae457f091df20456c5ae879a291
    Reviewed-on: https://go-review.googlesource.com/c/go/+/184157
    Run-TryBot: Russ Cox <rsc@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Bryan C. Mills <bcmills@google.com>

 src/crypto/tls/handshake_test.go | 75 ++++++++++++++++++++++++++++++----------
 1 file changed, 57 insertions(+), 18 deletions(-)
