commit a318d56c1e6e89996a3852a780f45c792d860d64
Author: Cherry Zhang <cherryyz@google.com>
Date:   Tue Dec 15 18:31:21 2020 -0500

    cmd/link: pass arch-specific flags to external linker when testing supported flag
    
    When testing if a flag (e.g. "-no-pie") is supported by the
    external linker, pass arch-specific flags (like "-marm").
    
    In particular, on the ARM builder, if CGO_LDFLAGS=-march=armv6
    is set, the C toolchain fails to build if -marm is not passed.
    
            # cc -march=armv6 1.c
            1.c: In function 'main':
            1.c:3:1: sorry, unimplemented: Thumb-1 hard-float VFP ABI
             int main() {
             ^~~
    
    This makes the Go linker think "-no-pie" is not supported when it
    actually is.
    
    Passing -marm makes it work.
    
    Fixes #43202.
    
    Change-Id: I4e8b71f08818993cbbcb2494b310c68d812d6b50
    Reviewed-on: https://go-review.googlesource.com/c/go/+/278592
    Trust: Cherry Zhang <cherryyz@google.com>
    Run-TryBot: Cherry Zhang <cherryyz@google.com>
    TryBot-Result: Go Bot <gobot@golang.org>
    Reviewed-by: Than McIntosh <thanm@google.com>

 src/cmd/link/internal/ld/lib.go | 8 ++++----
 1 file changed, 4 insertions(+), 4 deletions(-)
