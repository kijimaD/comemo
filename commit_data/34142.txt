commit 755b36aa532f6b23081bf5eaf83449c1a6dd8114
Author: Keith Randall <khr@google.com>
Date:   Tue Feb 13 12:33:55 2018 -0800

    cmd/compile: fix constant folding of right shifts
    
    The sub-word shifts need to sign-extend before shifting, to avoid
    bringing in data from higher in the argument.
    
    Fixes #23812
    
    Change-Id: I0a95a0b49c48f3b40b85765bb4a9bb492be0cd73
    Reviewed-on: https://go-review.googlesource.com/93716
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Cherry Zhang <cherryyz@google.com>

 src/cmd/compile/internal/ssa/gen/AMD64.rules |  6 ++---
 src/cmd/compile/internal/ssa/gen/AMD64Ops.go | 24 ++++++++++----------
 src/cmd/compile/internal/ssa/rewriteAMD64.go | 12 +++++-----
 test/fixedbugs/issue23812.go                 | 34 ++++++++++++++++++++++++++++
 4 files changed, 55 insertions(+), 21 deletions(-)
