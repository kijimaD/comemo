commit 060cd73ab930339d4565b57593293615b0e0315a
Author: wdvxdr <wdvxdr1123@gmail.com>
Date:   Thu Sep 30 09:57:04 2021 +0800

    cmd/compile: use TZCNT instruction for GOAMD64>=v3
    
    on my Intel CoffeeLake CPU:
    name               old time/op  new time/op  delta
    TrailingZeros-8    0.68ns ± 1%  0.64ns ± 1%  -6.26%  (p=0.000 n=10+10)
    TrailingZeros8-8   0.70ns ± 1%  0.70ns ± 1%    ~     (p=0.697 n=10+10)
    TrailingZeros16-8  0.70ns ± 1%  0.70ns ± 1%  +0.57%  (p=0.043 n=10+10)
    TrailingZeros32-8  0.66ns ± 1%  0.64ns ± 1%  -3.35%  (p=0.000 n=10+10)
    TrailingZeros64-8  0.68ns ± 1%  0.64ns ± 1%  -5.84%  (p=0.000 n=9+10)
    
    Updates #45453
    
    Change-Id: I228ff2d51df24b1306136f061432f8a12bb1d6fd
    Reviewed-on: https://go-review.googlesource.com/c/go/+/353249
    Trust: Michael Knyszek <mknyszek@google.com>
    Run-TryBot: Michael Knyszek <mknyszek@google.com>
    TryBot-Result: Go Bot <gobot@golang.org>
    Reviewed-by: Keith Randall <khr@golang.org>

 src/cmd/compile/internal/amd64/ssa.go        |   3 +-
 src/cmd/compile/internal/ssa/gen/AMD64.rules |  18 ++--
 src/cmd/compile/internal/ssa/gen/AMD64Ops.go |   4 +
 src/cmd/compile/internal/ssa/opGen.go        |  30 ++++++
 src/cmd/compile/internal/ssa/rewriteAMD64.go | 144 +++++++++++++++++++++++++--
 test/codegen/mathbits.go                     |  24 +++--
 6 files changed, 202 insertions(+), 21 deletions(-)
