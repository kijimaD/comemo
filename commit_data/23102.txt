commit 6ad33be2d9d6b24aa741b3007a4bcd52db222c41
Author: Srdjan Petrovic <spetrovic@google.com>
Date:   Thu Apr 16 14:32:18 2015 -0700

    runtime: implement xadduintptr and update system mstats using it
    
    The motivation is that sysAlloc/Free() currently aren't safe to be
    called without a valid G, because arm's xadd64() uses locks that require
    a valid G.
    
    The solution here was proposed by Dmitry Vyukov: use xadduintptr()
    instead of xadd64(), until arm can support xadd64 on all of its
    architectures (not a trivial task for arm).
    
    Change-Id: I250252079357ea2e4360e1235958b1c22051498f
    Reviewed-on: https://go-review.googlesource.com/9002
    Reviewed-by: Dmitry Vyukov <dvyukov@google.com>

 src/runtime/asm_amd64.s      |  3 ++
 src/runtime/asm_amd64p32.s   |  3 ++
 src/runtime/atomic_386.go    |  4 +++
 src/runtime/atomic_amd64x.go |  3 ++
 src/runtime/atomic_arm.go    |  4 +++
 src/runtime/atomic_arm64.go  |  4 +++
 src/runtime/atomic_ppc64x.go |  4 +++
 src/runtime/atomic_test.go   | 66 ++++++++++++++++++++++++++++++++++++++++++++
 src/runtime/export_test.go   |  3 ++
 src/runtime/malloc.go        | 10 +++----
 src/runtime/mem_bsd.go       | 17 ++++++++----
 src/runtime/mem_darwin.go    | 17 ++++++++----
 src/runtime/mem_linux.go     | 17 ++++++++----
 src/runtime/mem_plan9.go     | 12 ++++----
 src/runtime/mem_windows.go   | 17 ++++++++----
 src/runtime/mstats.go        | 38 +++++++++++++++++++++++++
 src/runtime/os1_darwin.go    |  3 +-
 src/runtime/os1_linux.go     |  3 +-
 18 files changed, 189 insertions(+), 39 deletions(-)
