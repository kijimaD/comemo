commit b8c8cb85092aba7dda9b5f27b1a6c940aaf3c985
Author: Russ Cox <rsc@golang.org>
Date:   Fri Aug 2 15:20:42 2013 -0400

    cmd/dist: fix build again
    
    I am really bad at this. Didn't hg add this file.
    
    TBR=bradfitz
    CC=golang-dev
    https://golang.org/cl/12372043
---
 src/cmd/dist/buildgo.c | 44 ++++++++++++++++++++++++++++++++++++++++++++
 1 file changed, 44 insertions(+)

diff --git a/src/cmd/dist/buildgo.c b/src/cmd/dist/buildgo.c
new file mode 100644
index 0000000000..a7602d9edd
--- /dev/null
+++ b/src/cmd/dist/buildgo.c
@@ -0,0 +1,44 @@
+// Copyright 2012 The Go Authors.  All rights reserved.
+// Use of this source code is governed by a BSD-style
+// license that can be found in the LICENSE file.
+
+#include "a.h"
+
+/*
+ * Helpers for building cmd/go and cmd/cgo.
+ */
+
+// mkzdefaultcc writes zdefaultcc.go:
+//
+//	package main
+//	const defaultCC = <defaultcc>
+//
+// It is invoked to write cmd/go/zdefaultcc.go
+// but we also write cmd/cgo/zdefaultcc.go.
+void
+mkzdefaultcc(char *dir, char *file)
+{
+	Buf b, out;
+	
+	USED(dir);
+
+	binit(&out);
+	bprintf(&out,
+		"// auto generated by go tool dist\n"
+		"\n"
+		"package main\n"
+		"\n"
+		"const defaultCC = `%s`\n",
+		defaultcc);
+
+	writefile(&out, file, 0);
+
+	// Convert file name to replace.
+	binit(&b);	
+	bwritestr(&b, file);
+	bsubst(&b, "/go/zdefaultcc.go", "/cgo/zdefaultcc.go");
+	writefile(&out, bstr(&b), 0);
+
+	bfree(&b);
+	bfree(&out);
+}
