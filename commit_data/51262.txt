commit a78532a4121d26c33ee3ce69b3dda3a608f5a077
Author: Meng Zhuo <mzh@golangcn.org>
Date:   Fri Dec 17 14:15:42 2021 +0800

    runtime: invalid negative frequency while tracing
    
    The riscv64 Hifive Unmatched is the only platform that
    failed on testcase TestAnalyzeAnnotations occasionally
    after CL 332954 had merged. The failure happens when
    ticks per second (freq) is over 1e12 which causing the timestamps
    of two events are same.
    
    There are 2 reasons causing big frequency:
    1. RDCYCLE is HART based according to the riscv manual which makes
       negative ticks delta
    2. negative float64 -> uint64 is undefined and "lucky" negative float
       is too big to handle for trace
    
    For #46737
    
    Change-Id: I1f3c1ac31aae249969000c719c32aaf5a66d29a5
    Reviewed-on: https://go-review.googlesource.com/c/go/+/373034
    Trust: Zhuo Meng <mzh@golangcn.org>
    Run-TryBot: Zhuo Meng <mzh@golangcn.org>
    TryBot-Result: Gopher Robot <gobot@golang.org>
    Reviewed-by: Cherry Mui <cherryyz@google.com>
    Reviewed-by: Michael Knyszek <mknyszek@google.com>

 src/runtime/asm_riscv64.s | 5 ++++-
 src/runtime/trace.go      | 3 +++
 2 files changed, 7 insertions(+), 1 deletion(-)
