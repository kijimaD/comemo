commit 991fd381d52e7cec37ab54732613d3e465916206
Author: Jay Conrod <jayconrod@google.com>
Date:   Tue Jul 6 10:38:18 2021 -0700

    cmd/go: don't lock .mod and .sum files for read in overlay
    
    On Plan 9, locking a file requires a chmod call. In general, the go
    command should not modify files in the overlay, even metadata. With
    this change, we won't lock these files for reading.
    
    The go command already reported errors when attempting to write these
    files if they were in the overlay, but this change moves those checks
    to the point of access for clearer error
    messages. cmd/go/internal/lockedfile no longer imports
    cmd/go/internal/fsys.
    
    Fixes #44700
    
    Change-Id: Ib544459dd6cf56ca0f7a27b3285f045f08040d7e
    Reviewed-on: https://go-review.googlesource.com/c/go/+/333012
    Trust: Jay Conrod <jayconrod@google.com>
    Run-TryBot: Jay Conrod <jayconrod@google.com>
    TryBot-Result: Go Bot <gobot@golang.org>
    Reviewed-by: Bryan C. Mills <bcmills@google.com>

 src/cmd/go/internal/lockedfile/lockedfile_filelock.go |  3 +--
 src/cmd/go/internal/lockedfile/lockedfile_plan9.go    |  6 ++----
 src/cmd/go/internal/modfetch/fetch.go                 | 17 ++++++++++++++++-
 src/cmd/go/internal/modload/init.go                   | 18 +++++++++++++++++-
 src/cmd/go/internal/modload/modfile.go                | 14 ++++++++++++--
 src/cmd/go/testdata/script/mod_overlay.txt            | 10 +++++-----
 6 files changed, 53 insertions(+), 15 deletions(-)
