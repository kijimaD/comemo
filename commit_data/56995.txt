commit bbeb55f5faf93659e1cfd6ab073ab3c9d126d195
Author: Roland Shoemaker <bracewell@google.com>
Date:   Fri May 5 13:10:34 2023 -0700

    cmd/go: enforce flags with non-optional arguments
    
    Enforce that linker flags which expect arguments get them, otherwise it
    may be possible to smuggle unexpected flags through as the linker can
    consume what looks like a flag as an argument to a preceding flag (i.e.
    "-Wl,-O -Wl,-R,-bad-flag" is interpreted as "-O=-R -bad-flag"). Also be
    somewhat more restrictive in the general format of some flags.
    
    Thanks to Juho Nurminen of Mattermost for reporting this issue.
    
    Fixes #60305
    Fixes CVE-2023-29404
    
    Change-Id: I913df78a692cee390deefc3cd7d8f5b031524fc9
    Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/1876275
    Reviewed-by: Ian Lance Taylor <iant@google.com>
    Reviewed-by: Damien Neil <dneil@google.com>
    Reviewed-on: https://go-review.googlesource.com/c/go/+/501225
    Run-TryBot: David Chase <drchase@google.com>
    Reviewed-by: Michael Knyszek <mknyszek@google.com>
    TryBot-Result: Gopher Robot <gobot@golang.org>

 src/cmd/go/internal/work/security.go      | 6 +++---
 src/cmd/go/internal/work/security_test.go | 5 +++++
 2 files changed, 8 insertions(+), 3 deletions(-)
