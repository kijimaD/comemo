commit 8893da7c724cf5df859a3c4ef6f32d94f0b39a00
Author: Wayne Zuo <wdvxdr@golangcn.org>
Date:   Thu Nov 17 18:10:00 2022 +0800

    cmd/compile: fix wrong optimization for eliding Not in Phi
    
    The previous rule may move the phi value into a wrong block.
    This CL make it only rewrite the phi value not the If block,
    so that the phi value will stay in old block.
    
    Fixes #56777
    
    Change-Id: I9479a5c7f28529786968413d35b82a16181bb1f1
    Reviewed-on: https://go-review.googlesource.com/c/go/+/451496
    TryBot-Result: Gopher Robot <gobot@golang.org>
    Reviewed-by: Keith Randall <khr@golang.org>
    Run-TryBot: Wayne Zuo <wdvxdr@golangcn.org>
    Reviewed-by: Keith Randall <khr@google.com>
    Reviewed-by: David Chase <drchase@google.com>

 src/cmd/compile/internal/ssa/_gen/generic.rules |  3 +-
 src/cmd/compile/internal/ssa/rewritegeneric.go  | 58 ++++++++++++-------------
 test/fixedbugs/issue56777.go                    | 56 ++++++++++++++++++++++++
 3 files changed, 87 insertions(+), 30 deletions(-)
