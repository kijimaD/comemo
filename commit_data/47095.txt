commit ed475fe53ba41c0c15b11565f8b9d00165345bc2
Author: Russ Cox <rsc@golang.org>
Date:   Wed Oct 27 22:59:55 2021 -0400

    cmd/go: update for //go:build lines
    
    cmd/go has its own //go:build evaluator, which is needed for
    patterns like 'all'. The code is a modified copy of some unexported
    routines from the go/build package. Update it by copying those
    again and re-modifying them. The modifications are primarily the new
    func eval and also ignoring errors.
    
    This CL will need to be backported to Go 1.17, or else Go 1.17
    will break when faced with certain //go:build-only repos during
    'go list all' or 'go mod tidy'.
    
    For #41184.
    Fixes #49198.
    
    Change-Id: Ie0fe3caa8d49004935ecd76d7977f767fe50e317
    Reviewed-on: https://go-review.googlesource.com/c/go/+/359355
    Trust: Russ Cox <rsc@golang.org>
    Run-TryBot: Russ Cox <rsc@golang.org>
    TryBot-Result: Go Bot <gobot@golang.org>
    Reviewed-by: Bryan C. Mills <bcmills@google.com>

 src/cmd/go/internal/imports/build.go            | 216 +++++++++++++++++-------
 src/cmd/go/testdata/script/list_all_gobuild.txt |  41 +++++
 2 files changed, 192 insertions(+), 65 deletions(-)
