commit 7466b61ba470f62126d2ce4c3d70b7ae3dd32f73
Author: Rob Pike <r@golang.org>
Date:   Fri Oct 24 10:42:54 2008 -0700

    make fmt a directory
    some build dependencies need rearrangement because fmt will depend on reflect
    
    R=rsc
    DELTA=1091  (567 added, 521 deleted, 3 changed)
    OCL=17792
    CL=17796
---
 src/lib/clean.bash       |  2 +-
 src/lib/fmt/Makefile     | 41 +++++++++++++++++++++++++++++++++++++++++
 src/lib/{ => fmt}/fmt.go |  0
 src/lib/make.bash        | 17 +++++++++++++----
 4 files changed, 55 insertions(+), 5 deletions(-)

diff --git a/src/lib/clean.bash b/src/lib/clean.bash
index cc9b09d1b9..e32e2eb07b 100755
--- a/src/lib/clean.bash
+++ b/src/lib/clean.bash
@@ -6,7 +6,7 @@
 
 rm -f $GOROOT/pkg/*
 
-for i in syscall os math net time http reflect regexp
+for i in syscall os math fmt net time http reflect regexp
 do
 	cd $i
 	make nuke
diff --git a/src/lib/fmt/Makefile b/src/lib/fmt/Makefile
new file mode 100644
index 0000000000..70ea703f19
--- /dev/null
+++ b/src/lib/fmt/Makefile
@@ -0,0 +1,41 @@
+# Copyright 2009 The Go Authors. All rights reserved.
+# Use of this source code is governed by a BSD-style
+# license that can be found in the LICENSE file.
+
+# DO NOT EDIT.  Automatically generated by gobuild.
+# gobuild -m fmt fmt.go
+O=6
+GC=$(O)g
+CC=$(O)c -w
+AS=$(O)a
+AR=$(O)ar
+
+PKG=$(GOROOT)/pkg/fmt.a
+
+install: $(PKG)
+
+nuke: clean
+	rm -f $(PKG)
+
+clean:
+	rm -f *.$O *.a
+
+%.$O: %.go
+	$(GC) $*.go
+
+%.$O: %.c
+	$(CC) $*.c
+
+%.$O: %.s
+	$(AS) $*.s
+
+
+O1=\
+	fmt.$O\
+
+$(PKG): a1
+a1:	$(O1)
+	$(AR) grc $(PKG) $(O1)
+
+$(O1): nuke
+
diff --git a/src/lib/fmt.go b/src/lib/fmt/fmt.go
similarity index 100%
rename from src/lib/fmt.go
rename to src/lib/fmt/fmt.go
diff --git a/src/lib/make.bash b/src/lib/make.bash
index db056a3717..e6e1e18955 100755
--- a/src/lib/make.bash
+++ b/src/lib/make.bash
@@ -6,7 +6,18 @@
 
 set -e
 
-for i in syscall os math
+# Don't sort the files in the for loop - some of the orderings matter.
+rm -f *.6
+for i in \
+	strings.go\
+
+do
+	base=$(basename $i .go)
+	echo 6g -o $GOROOT/pkg/$base.6 $i
+	6g -o $GOROOT/pkg/$base.6 $i
+done
+
+for i in syscall os math reflect fmt
 do
 	echo; echo; echo %%%% making lib/$i %%%%; echo
 	cd $i
@@ -17,14 +28,12 @@ done
 # Don't sort the files in the for loop - some of the orderings matter.
 rm -f *.6
 for i in \
-	fmt.go\
 	flag.go\
 	container/vector.go\
 	rand.go\
 	sort.go\
 	io.go\
 	bufio.go\
-	strings.go\
 	once.go\
 
 do
@@ -33,7 +42,7 @@ do
 	6g -o $GOROOT/pkg/$base.6 $i
 done
 
-for i in net time http reflect regexp
+for i in net time http regexp
 do
 	echo; echo; echo %%%% making lib/$i %%%%; echo
 	cd $i
