commit d42b32e321fa5c5d2c93b2ad22d48e804c9f45d2
Author: Michael Pratt <mpratt@google.com>
Date:   Fri Aug 21 11:51:25 2020 -0400

    runtime: add sched.lock assertions
    
    Functions that require holding sched.lock now have an assertion.
    
    A few places with missing locks have been fixed in this CL:
    
    Additionally, locking is added around the call to procresize in
    schedinit. This doesn't technically need a lock since the program is
    still starting (thus no concurrency) when this is called, but lock held
    checking doesn't know that.
    
    Updates #40677
    
    Change-Id: I198d3cbaa727f7088e4d55ba8fa989cf1ee8f9cf
    Reviewed-on: https://go-review.googlesource.com/c/go/+/250261
    Run-TryBot: Michael Pratt <mpratt@google.com>
    TryBot-Result: Go Bot <gobot@golang.org>
    Trust: Michael Pratt <mpratt@google.com>
    Reviewed-by: Michael Knyszek <mknyszek@google.com>

 src/runtime/proc.go | 62 ++++++++++++++++++++++++++++++++++++++++++-----------
 1 file changed, 49 insertions(+), 13 deletions(-)
