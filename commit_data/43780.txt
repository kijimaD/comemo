commit 941de9760bcf35ad1ef4eee23d2851d3f2fa087b
Author: Than McIntosh <thanm@google.com>
Date:   Tue Apr 21 18:37:43 2020 -0400

    [dev.link] cmd/link: begin converting dodata() to loader APIs
    
    This patch begins the work of converting the linker's dodata phase to
    work with loader APIs. Passes all.bash on linux/amd64, but hasn't been
    tested on anything else (more arch-specific code needs to be written).
    Use of the new dodata() phase is currently gated by a temporary
    command line flag ("-newdodata"), and there is code in the linker's
    main routine to insure that we only use the new version for the right
    GOOS/GOARCH (currently restricted to ELF + AMD64).
    
    Change-Id: Ied3966677d2a450bc3e0990e0f519b3fceaab806
    Reviewed-on: https://go-review.googlesource.com/c/go/+/229706
    Run-TryBot: Than McIntosh <thanm@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Cherry Zhang <cherryyz@google.com>

 src/cmd/link/internal/amd64/asm.go            | 260 +++----
 src/cmd/link/internal/amd64/asm2.go           | 402 +++++++++++
 src/cmd/link/internal/amd64/obj.go            |   1 +
 src/cmd/link/internal/ld/data.go              | 727 ++++++++++----------
 src/cmd/link/internal/ld/data2.go             | 938 ++++++++++++++++++++++++++
 src/cmd/link/internal/ld/elf.go               |  79 +--
 src/cmd/link/internal/ld/elf2.go              | 166 +++++
 src/cmd/link/internal/ld/go.go                |   8 +-
 src/cmd/link/internal/ld/lib.go               |  34 +-
 src/cmd/link/internal/ld/link.go              |   1 +
 src/cmd/link/internal/ld/main.go              |  22 +-
 src/cmd/link/internal/ld/symtab.go            |   7 +-
 src/cmd/link/internal/ld/xcoff.go             |  10 +-
 src/cmd/link/internal/ld/xcoff2.go            |  52 ++
 src/cmd/link/internal/loader/loader.go        |  50 +-
 src/cmd/link/internal/loader/symbolbuilder.go |   7 +
 src/cmd/link/internal/ppc64/asm.go            |   2 +-
 src/cmd/link/internal/sym/segment.go          |   5 +-
 18 files changed, 2209 insertions(+), 562 deletions(-)
