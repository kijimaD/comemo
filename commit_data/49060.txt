commit bb1f4416180511231de6d17a1f2f55c82aafc863
Author: Roland Shoemaker <roland@golang.org>
Date:   Mon Apr 25 19:02:35 2022 -0700

    crypto/rand: properly handle large Read on windows
    
    Use the batched reader to chunk large Read calls on windows to a max of
    1 << 31 - 1 bytes. This prevents an infinite loop when trying to read
    more than 1 << 32 -1 bytes, due to how RtlGenRandom works.
    
    This change moves the batched function from rand_unix.go to rand.go,
    since it is now needed for both windows and unix implementations.
    
    Fixes #52561
    
    Change-Id: Id98fc4b1427e5cb2132762a445b2aed646a37473
    Reviewed-on: https://go-review.googlesource.com/c/go/+/402257
    Run-TryBot: Roland Shoemaker <roland@golang.org>
    Reviewed-by: Filippo Valsorda <filippo@golang.org>
    Reviewed-by: Filippo Valsorda <valsorda@google.com>
    TryBot-Result: Gopher Robot <gobot@golang.org>

 src/crypto/rand/rand.go              | 18 ++++++++++++++++++
 src/crypto/rand/rand_batched_test.go | 12 ++++++------
 src/crypto/rand/rand_unix.go         | 22 ++--------------------
 src/crypto/rand/rand_windows.go      | 18 ++++++------------
 4 files changed, 32 insertions(+), 38 deletions(-)
