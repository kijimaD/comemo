commit 289da2b33ed6292c853017a15d3108d22ea7491a
Author: Matthew Dempsky <mdempsky@google.com>
Date:   Mon Dec 28 17:30:04 2020 -0800

    [dev.regabi] cmd/compile: move Node.Opt to Name
    
    Escape analysis uses Node.Opt to map nodes to their "location", so
    that other references to the same node use the same location
    again. But in the current implementation of escape analysis, we never
    need to refer back to a node's location except for named nodes (since
    other nodes are anonymous, and have no way to be referenced).
    
    This CL moves Opt from Node down to Name, turns it into a directly
    accessed field, and cleans up escape analysis to avoid setting Opt on
    non-named expressions.
    
    One nit: in walkCheckPtrArithmetic, we were abusing Opt as a way to
    detect/prevent loops. This CL adds a CheckPtr bit flag instead.
    
    Passes toolstash -cmp.
    
    Change-Id: If57d5ad8d972fa63bedbe69b9ebb6753e31aba85
    Reviewed-on: https://go-review.googlesource.com/c/go/+/280638
    Trust: Matthew Dempsky <mdempsky@google.com>
    Run-TryBot: Matthew Dempsky <mdempsky@google.com>
    Reviewed-by: Cuong Manh Le <cuong.manhle.vn@gmail.com>
    TryBot-Result: Go Bot <gobot@golang.org>

 src/cmd/compile/internal/escape/escape.go | 45 ++++++++++++++++++-------------
 src/cmd/compile/internal/ir/expr.go       |  8 +++---
 src/cmd/compile/internal/ir/mini.go       |  2 --
 src/cmd/compile/internal/ir/name.go       |  4 +--
 src/cmd/compile/internal/ir/node.go       |  2 --
 src/cmd/compile/internal/walk/convert.go  | 14 ++++------
 src/cmd/compile/internal/walk/walk.go     |  2 --
 7 files changed, 38 insertions(+), 39 deletions(-)
