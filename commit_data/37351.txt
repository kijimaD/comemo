commit 6435d0cfbf72f405f31430e60766add6d6762fe1
Author: Filippo Valsorda <filippo@golang.org>
Date:   Mon Nov 5 15:59:08 2018 -0500

    crypto/tls: implement TLS 1.3 PSK authentication (server side)
    
    Added some assertions to testHandshake, but avoided checking the error
    of one of the Close() because the one that would lose the race would
    write the closeNotify to a connection closed on the other side which is
    broken on js/wasm (#28650). Moved that Close() after the chan sync to
    ensure it happens second.
    
    Accepting a ticket with client certificates when NoClientCert is
    configured is probably not a problem, and we could hide them to avoid
    confusing the application, but the current behavior is to skip the
    ticket, and I'd rather keep behavior changes to a minimum.
    
    Updates #9671
    
    Change-Id: I93b56e44ddfe3d48c2bef52c83285ba2f46f297a
    Reviewed-on: https://go-review.googlesource.com/c/147445
    Reviewed-by: Adam Langley <agl@golang.org>

 src/crypto/tls/common.go                           |  15 ++
 src/crypto/tls/handshake_client_test.go            |  51 +++--
 src/crypto/tls/handshake_client_tls13.go           |   2 +-
 src/crypto/tls/handshake_messages.go               | 126 +++++++----
 src/crypto/tls/handshake_messages_test.go          |  22 ++
 src/crypto/tls/handshake_server.go                 |  14 +-
 src/crypto/tls/handshake_server_test.go            | 110 ++++++++--
 src/crypto/tls/handshake_server_tls13.go           | 230 ++++++++++++++++++++-
 .../tls/testdata/Server-TLSv13-AES128-SHA256       | 158 +++++++-------
 .../tls/testdata/Server-TLSv13-AES256-SHA384       | 163 ++++++++-------
 src/crypto/tls/testdata/Server-TLSv13-ALPN         | 164 ++++++++-------
 src/crypto/tls/testdata/Server-TLSv13-ALPN-NoMatch | 163 ++++++++-------
 .../tls/testdata/Server-TLSv13-CHACHA20-SHA256     | 158 +++++++-------
 .../tls/testdata/Server-TLSv13-ECDHE-ECDSA-AES     | 150 +++++++-------
 .../testdata/Server-TLSv13-ExportKeyingMaterial    | 163 ++++++++-------
 .../tls/testdata/Server-TLSv13-HelloRetryRequest   | 188 +++++++++--------
 src/crypto/tls/testdata/Server-TLSv13-IssueTicket  | 103 +++++++++
 .../testdata/Server-TLSv13-IssueTicketPreDisable   | 103 +++++++++
 src/crypto/tls/testdata/Server-TLSv13-P256         | 167 ++++++++-------
 src/crypto/tls/testdata/Server-TLSv13-RSA-RSAPSS   | 163 ++++++++-------
 src/crypto/tls/testdata/Server-TLSv13-Resume       |  66 ++++++
 .../Server-TLSv13-Resume-HelloRetryRequest         | 106 ++++++++++
 .../tls/testdata/Server-TLSv13-ResumeDisabled      | 104 ++++++++++
 src/crypto/tls/testdata/Server-TLSv13-X25519       | 163 ++++++++-------
 src/crypto/tls/ticket.go                           |  63 ++++--
 25 files changed, 1960 insertions(+), 955 deletions(-)
