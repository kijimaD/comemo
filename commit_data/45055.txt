commit 1129a60f1c1e64147ca1133857c4571ce9b87a35
Author: Keith Randall <khr@golang.org>
Date:   Fri Mar 12 12:57:39 2021 -0800

    cmd/compile: include typecheck information in export/import
    
    Include type information on exported function bodies, so that the
    importer does not have to re-typecheck the body. This involves
    including type information in the encoded output, as well as
    avoiding some of the opcode rewriting and other changes that the
    old exporter did assuming there would be a re-typechecking pass.
    
    This CL could be considered a cleanup, but is more important than that
    because it is an enabling change for generics. Without this CL, we'd
    have to upgrade the current typechecker to understand generics. With
    this CL, the current typechecker can mostly go away in favor of the
    types2 typechecker.
    
    For now, inlining of functions that contain closures is turned off.
    We will hopefully resolve this before freeze.
    
    Object files are only 0.07% bigger.
    
    Change-Id: I85c9da09f66bfdc910dc3e26abb2613a1831634d
    Reviewed-on: https://go-review.googlesource.com/c/go/+/301291
    Trust: Keith Randall <khr@golang.org>
    Trust: Dan Scales <danscales@google.com>
    Reviewed-by: Dan Scales <danscales@google.com>

 src/cmd/compile/internal/escape/escape.go     |   2 +-
 src/cmd/compile/internal/inline/inl.go        |   6 +-
 src/cmd/compile/internal/typecheck/func.go    |  19 +-
 src/cmd/compile/internal/typecheck/iexport.go | 276 +++++++++++++++++--
 src/cmd/compile/internal/typecheck/iimport.go | 371 +++++++++++++++++++++-----
 test/closure3.dir/main.go                     |  44 +--
 test/inline.go                                |  22 +-
 7 files changed, 618 insertions(+), 122 deletions(-)
