commit d45e8bf403e0296297d4028a75ad61cb309cd12c
Author: Michael Matloob <matloob@golang.org>
Date:   Wed Mar 13 13:27:03 2024 -0400

    cmd/internal/telemetry: add a shim package around telemetry
    
    The purpose of this package is to have a build tagged variant so that
    when we're building the bootstrap go command it does not depend on the
    net package. (net is a dependency of golang.org/x/telemetry/counter on
    Windows).
    
    The TESTGO_TELEMETRY_DIR environment variable used by the go tests to
    change the telemetry directory is renamed to TEST_TELEMETRY_DIR to
    make it more general to other commands that might want to set it for
    the purpose of tests. The test telemetry directory is now set using
    telemetry.Start instead of countertest.Open. This also means that the
    logic that decides whether to upload counter files is now going to run
    from the cmd/go tests (but that's okay because it's aleady been
    running when cmd/go has been invoked outside of its tests.
    
    Change-Id: Ic4272e5083facde010482d8b8fc3c95c03564bc9
    Reviewed-on: https://go-review.googlesource.com/c/go/+/571096
    LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
    Reviewed-by: Hyang-Ah Hana Kim <hyangah@gmail.com>

 src/cmd/go/go_test.go                             | 19 ++++-----
 src/cmd/go/internal/base/base.go                  | 11 +++--
 src/cmd/go/main.go                                | 19 ++++-----
 src/cmd/go/script_test.go                         |  2 +-
 src/cmd/go/telemetry.go                           | 13 ------
 src/cmd/go/telemetry_bootstrap.go                 |  9 ----
 src/cmd/internal/telemetry/telemetry.go           | 51 +++++++++++++++++++++++
 src/cmd/internal/telemetry/telemetry_bootstrap.go | 19 +++++++++
 8 files changed, 95 insertions(+), 48 deletions(-)
