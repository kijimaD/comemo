commit 2f8f51724ad2a3509603d53d8a850f9146e4016f
Author: Bryan C. Mills <bcmills@google.com>
Date:   Tue Jan 10 12:59:16 2023 -0500

    cmd/go/internal/lockedfile: avoid failing tests due to arbitrary timeouts
    
    The mustBlock helper returns a function that verifies that the blocked
    operation does eventually complete. However, it used an arbitrary
    10-second timeout in place of “eventually”.
    
    Since the test is checking a synchronization library, bugs are likely
    to manifest as deadlocks. It may be useful to log what operation is in
    flight if such a deadlock occurs; however, since we can't bound how
    long a “reasonable” operation should take, the log message should only
    be informational — it should not cause the test to fail.
    
    While we're here, let's also set a better example by not leaking
    time.After timers in the tests..
    
    Fixes #57592.
    
    Change-Id: I4e74e42390679bffac7a286824acb71b08994c17
    Reviewed-on: https://go-review.googlesource.com/c/go/+/461000
    Reviewed-by: Damien Neil <dneil@google.com>
    TryBot-Result: Gopher Robot <gobot@golang.org>
    Run-TryBot: Bryan Mills <bcmills@google.com>
    Auto-Submit: Bryan Mills <bcmills@google.com>

 src/cmd/go/internal/lockedfile/lockedfile_test.go | 33 ++++++++++++++++-------
 1 file changed, 24 insertions(+), 9 deletions(-)
