commit 4106de901a8efe914cda6f6c4e8d45ff8c115da4
Author: Filippo Valsorda <filippo@golang.org>
Date:   Thu Dec 14 22:13:29 2023 +0100

    crypto/tls: align FIPS-only mode with BoringSSL policy
    
    This enables TLS 1.3, disables P-521, and disables non-ECDHE suites.
    
    Fixes #64717
    Updates #62372
    
    Change-Id: I3a65b239ef0198bbdbe5e55e0810e7128f90a091
    Reviewed-on: https://go-review.googlesource.com/c/go/+/549975
    Reviewed-by: Roland Shoemaker <roland@golang.org>
    LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
    Reviewed-by: Than McIntosh <thanm@google.com>

 src/crypto/internal/boring/aes.go        | 29 ++++++++++----
 src/crypto/internal/boring/notboring.go  |  1 +
 src/crypto/tls/boring.go                 | 26 +++++++-----
 src/crypto/tls/boring_test.go            | 69 +++++++++++++++++++++++---------
 src/crypto/tls/cipher_suites.go          |  8 +++-
 src/crypto/tls/handshake_client.go       |  4 +-
 src/crypto/tls/handshake_client_tls13.go |  4 --
 src/crypto/tls/handshake_server_test.go  | 28 ++++++++-----
 src/crypto/tls/handshake_server_tls13.go |  7 ++--
 src/crypto/tls/notboring.go              |  2 +
 src/crypto/x509/boring.go                |  4 +-
 11 files changed, 125 insertions(+), 57 deletions(-)
