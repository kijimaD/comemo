commit de23549a3967ade982d848a5b6ae3cb3fa0dba45
Author: Michael Matloob <matloob@golang.org>
Date:   Tue Aug 24 12:37:15 2021 -0400

    [dev.cmdgo] cmd/go: fix calls to modFileGoVersion to pass in modFile
    
    Before this change, we were arbitrarily picking a module to get the Go
    version from in calls to modFileGoVersion. We now pass in the modFile to
    modFileGoVersion when we have the file. Most of the calls were to get
    the goVersion argument for commitRequirements, so now we have
    commitRequirements call modFileGoVersion on the modFile directly
    One of the calls to commitRequirements (when running go mod tidy with
    a different Go version) passed in a new go version to update the file
    to. Now, the modFile is updated before calling commitRequirements.
    
    For the remaining cases of modFileGoVersion, it's replaced by a call to
    the new (*MainModuleSet).GoVersion function, which either returns the go
    version on the workspace file (in workspace mode) or the version of the
    single go.mod file.
    
    Change-Id: Ie88c3ca76c7f29ffc4faa16bb76f6cb7eccb5029
    Reviewed-on: https://go-review.googlesource.com/c/go/+/344749
    Trust: Michael Matloob <matloob@golang.org>
    Run-TryBot: Michael Matloob <matloob@golang.org>
    TryBot-Result: Go Bot <gobot@golang.org>
    Reviewed-by: Jay Conrod <jayconrod@google.com>

 src/cmd/go/internal/modload/buildlist.go |  4 +-
 src/cmd/go/internal/modload/init.go      | 76 ++++++++++++++++++++------------
 src/cmd/go/internal/modload/list.go      |  2 +-
 src/cmd/go/internal/modload/load.go      | 14 ++++--
 src/cmd/go/internal/modload/modfile.go   |  8 +---
 5 files changed, 64 insertions(+), 40 deletions(-)
