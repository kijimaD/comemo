commit 4c51c937808ee2fb88d469cf89c85c8e700f665c
Author: Filippo Valsorda <hi@filippo.io>
Date:   Wed Nov 28 22:05:08 2018 -0500

    crypto/tls: prevent the test server from sending session tickets
    
    Since they are sent after the handshake in TLS 1.3, the client was not
    actually consuming them, as it doesn't make any Read calls. They were
    then sitting in the kernel receive buffer when the client would call
    Close. The kernel would see that and send a RST, which would race the
    closeNotify, causing errors.
    
    Also, we get to trim 600 lines of useless test data.
    
    Fixes #28852
    
    Change-Id: I7517feab77dabab7504bfc111098ba09ea07ae5e
    Reviewed-on: https://go-review.googlesource.com/c/151659
    Reviewed-by: Ian Lance Taylor <iant@golang.org>
---
 src/crypto/tls/handshake_client_test.go            | 239 ++++++++-------
 .../tls/testdata/Client-TLSv13-AES128-SHA256       | 170 +++++------
 .../tls/testdata/Client-TLSv13-AES256-SHA384       | 174 +++++------
 src/crypto/tls/testdata/Client-TLSv13-ALPN         | 172 +++++------
 .../tls/testdata/Client-TLSv13-CHACHA20-SHA256     | 170 +++++------
 .../testdata/Client-TLSv13-ClientCert-ECDSA-RSA    | 333 ++++++++-------------
 .../testdata/Client-TLSv13-ClientCert-RSA-ECDSA    | 320 +++++++-------------
 .../testdata/Client-TLSv13-ClientCert-RSA-RSAPSS   | 324 +++++++-------------
 src/crypto/tls/testdata/Client-TLSv13-ECDSA        | 160 ++++------
 .../testdata/Client-TLSv13-ExportKeyingMaterial    | 170 +++++------
 .../tls/testdata/Client-TLSv13-HelloRetryRequest   | 169 +++++------
 src/crypto/tls/testdata/Client-TLSv13-KeyUpdate    | 184 +++++-------
 src/crypto/tls/testdata/Client-TLSv13-P256-ECDHE   | 172 +++++------
 src/crypto/tls/testdata/Client-TLSv13-X25519-ECDHE | 168 +++++------
 14 files changed, 1162 insertions(+), 1763 deletions(-)

diff --git a/src/crypto/tls/handshake_client_test.go b/src/crypto/tls/handshake_client_test.go
index d7a4cc57d9..2703cc72f9 100644
--- a/src/crypto/tls/handshake_client_test.go
+++ b/src/crypto/tls/handshake_client_test.go
@@ -135,9 +135,9 @@ type clientTest struct {
 	// name is a freeform string identifying the test and the file in which
 	// the expected results will be stored.
 	name string
-	// command, if not empty, contains a series of arguments for the
+	// args, if not empty, contains a series of arguments for the
 	// command to run for the reference server.
-	command []string
+	args []string
 	// config, if not nil, contains a custom Config to use for this test.
 	config *Config
 	// cert, if not empty, contains a DER-encoded certificate for the
@@ -168,7 +168,7 @@ type clientTest struct {
 	sendKeyUpdate bool
 }
 
-var defaultServerCommand = []string{"openssl", "s_server"}
+var serverCommand = []string{"openssl", "s_server", "-no_ticket", "-num_tickets", "0"}
 
 // connFromCommand starts the reference server process, connects to it and
 // returns a recordingConn for the connection. The stdin return value is an
@@ -210,11 +210,8 @@ func (test *clientTest) connFromCommand() (conn *recordingConn, child *exec.Cmd,
 	defer os.Remove(keyPath)
 
 	var command []string
-	if len(test.command) > 0 {
-		command = append(command, test.command...)
-	} else {
-		command = append(command, defaultServerCommand...)
-	}
+	command = append(command, serverCommand...)
+	command = append(command, test.args...)
 	command = append(command, "-cert", certPath, "-certform", "DER", "-key", keyPath)
 	// serverPort contains the port that OpenSSL will listen on. OpenSSL
 	// can't take "0" as an argument here so we have to pick a number and
@@ -323,22 +320,16 @@ func (test *clientTest) run(t *testing.T, write bool) {
 		clientConn, serverConn = localPipe(t)
 	}
 
-	config := test.config
-	if config == nil {
-		config = testConfig
-	}
-	client := Client(clientConn, config)
-
 	doneChan := make(chan bool)
 	go func() {
-		defer func() {
-			// Give time to the send buffer to drain, to avoid the kernel
-			// sending a RST and cutting off the flow. See Issue 18701.
-			time.Sleep(10 * time.Millisecond)
-			client.Close()
-			clientConn.Close()
-			doneChan <- true
-		}()
+		defer close(doneChan)
+
+		config := test.config
+		if config == nil {
+			config = testConfig
+		}
+		client := Client(clientConn, config)
+		defer client.Close()
 
 		if _, err := client.Write([]byte("hello\n")); err != nil {
 			t.Errorf("Client.Write failed: %s", err)
@@ -451,11 +442,8 @@ func (test *clientTest) run(t *testing.T, write bool) {
 		// If the server sent us an alert after our last flight, give it a
 		// chance to arrive.
 		if write && test.renegotiationExpectedToFail == 0 {
-			client.SetReadDeadline(time.Now().Add(500 * time.Millisecond))
-			if _, err := client.Read(make([]byte, 1)); err != nil {
-				if netErr, ok := err.(net.Error); !ok || !netErr.Timeout() {
-					t.Errorf("final Read returned an error: %s", err)
-				}
+			if err := peekError(client); err != nil {
+				t.Errorf("final Read returned an error: %s", err)
 			}
 		}
 	}()
@@ -475,19 +463,18 @@ func (test *clientTest) run(t *testing.T, write bool) {
 			serverConn.SetReadDeadline(time.Now().Add(1 * time.Minute))
 			_, err := io.ReadFull(serverConn, bb)
 			if err != nil {
-				t.Fatalf("%s #%d: %s", test.name, i, err)
+				t.Fatalf("%s, flow %d: %s", test.name, i+1, err)
 			}
 			if !bytes.Equal(b, bb) {
-				t.Fatalf("%s #%d: mismatch on read: got:%x want:%x", test.name, i, bb, b)
+				t.Fatalf("%s, flow %d: mismatch on read: got:%x want:%x", test.name, i+1, bb, b)
 			}
 		}
-		// Give time to the send buffer to drain, to avoid the kernel
-		// sending a RST and cutting off the flow. See Issue 18701.
-		time.Sleep(10 * time.Millisecond)
-		serverConn.Close()
 	}
 
 	<-doneChan
+	if !write {
+		serverConn.Close()
+	}
 
 	if write {
 		path := test.dataPath()
@@ -509,6 +496,20 @@ func (test *clientTest) run(t *testing.T, write bool) {
 	}
 }
 
+// peekError does a read with a short timeout to check if the next read would
+// cause an error, for example if there is an alert waiting on the wire.
+func peekError(conn net.Conn) error {
+	conn.SetReadDeadline(time.Now().Add(100 * time.Millisecond))
+	if n, err := conn.Read(make([]byte, 1)); n != 0 {
+		return errors.New("unexpectedly read data")
+	} else if err != nil {
+		if netErr, ok := err.(net.Error); !ok || !netErr.Timeout() {
+			return err
+		}
+	}
+	return nil
+}
+
 func runClientTestForVersion(t *testing.T, template *clientTest, version, option string) {
 	t.Run(version, func(t *testing.T) {
 		// Make a deep copy of the template before going parallel.
@@ -522,11 +523,7 @@ func runClientTestForVersion(t *testing.T, template *clientTest, version, option
 		}
 
 		test.name = version + "-" + test.name
-		if len(test.command) == 0 {
-			test.command = defaultServerCommand
-		}
-		test.command = append([]string(nil), test.command...)
-		test.command = append(test.command, option)
+		test.args = append([]string{option}, test.args...)
 		test.run(t, *update)
 	})
 }
@@ -549,8 +546,8 @@ func runClientTestTLS13(t *testing.T, template *clientTest) {
 
 func TestHandshakeClientRSARC4(t *testing.T) {
 	test := &clientTest{
-		name:    "RSA-RC4",
-		command: []string{"openssl", "s_server", "-cipher", "RC4-SHA"},
+		name: "RSA-RC4",
+		args: []string{"-cipher", "RC4-SHA"},
 	}
 	runClientTestTLS10(t, test)
 	runClientTestTLS11(t, test)
@@ -559,24 +556,24 @@ func TestHandshakeClientRSARC4(t *testing.T) {
 
 func TestHandshakeClientRSAAES128GCM(t *testing.T) {
 	test := &clientTest{
-		name:    "AES128-GCM-SHA256",
-		command: []string{"openssl", "s_server", "-cipher", "AES128-GCM-SHA256"},
+		name: "AES128-GCM-SHA256",
+		args: []string{"-cipher", "AES128-GCM-SHA256"},
 	}
 	runClientTestTLS12(t, test)
 }
 
 func TestHandshakeClientRSAAES256GCM(t *testing.T) {
 	test := &clientTest{
-		name:    "AES256-GCM-SHA384",
-		command: []string{"openssl", "s_server", "-cipher", "AES256-GCM-SHA384"},
+		name: "AES256-GCM-SHA384",
+		args: []string{"-cipher", "AES256-GCM-SHA384"},
 	}
 	runClientTestTLS12(t, test)
 }
 
 func TestHandshakeClientECDHERSAAES(t *testing.T) {
 	test := &clientTest{
-		name:    "ECDHE-RSA-AES",
-		command: []string{"openssl", "s_server", "-cipher", "ECDHE-RSA-AES128-SHA"},
+		name: "ECDHE-RSA-AES",
+		args: []string{"-cipher", "ECDHE-RSA-AES128-SHA"},
 	}
 	runClientTestTLS10(t, test)
 	runClientTestTLS11(t, test)
@@ -585,10 +582,10 @@ func TestHandshakeClientECDHERSAAES(t *testing.T) {
 
 func TestHandshakeClientECDHEECDSAAES(t *testing.T) {
 	test := &clientTest{
-		name:    "ECDHE-ECDSA-AES",
-		command: []string{"openssl", "s_server", "-cipher", "ECDHE-ECDSA-AES128-SHA"},
-		cert:    testECDSACertificate,
-		key:     testECDSAPrivateKey,
+		name: "ECDHE-ECDSA-AES",
+		args: []string{"-cipher", "ECDHE-ECDSA-AES128-SHA"},
+		cert: testECDSACertificate,
+		key:  testECDSAPrivateKey,
 	}
 	runClientTestTLS10(t, test)
 	runClientTestTLS11(t, test)
@@ -597,46 +594,46 @@ func TestHandshakeClientECDHEECDSAAES(t *testing.T) {
 
 func TestHandshakeClientECDHEECDSAAESGCM(t *testing.T) {
 	test := &clientTest{
-		name:    "ECDHE-ECDSA-AES-GCM",
-		command: []string{"openssl", "s_server", "-cipher", "ECDHE-ECDSA-AES128-GCM-SHA256"},
-		cert:    testECDSACertificate,
-		key:     testECDSAPrivateKey,
+		name: "ECDHE-ECDSA-AES-GCM",
+		args: []string{"-cipher", "ECDHE-ECDSA-AES128-GCM-SHA256"},
+		cert: testECDSACertificate,
+		key:  testECDSAPrivateKey,
 	}
 	runClientTestTLS12(t, test)
 }
 
 func TestHandshakeClientAES256GCMSHA384(t *testing.T) {
 	test := &clientTest{
-		name:    "ECDHE-ECDSA-AES256-GCM-SHA384",
-		command: []string{"openssl", "s_server", "-cipher", "ECDHE-ECDSA-AES256-GCM-SHA384"},
-		cert:    testECDSACertificate,
-		key:     testECDSAPrivateKey,
+		name: "ECDHE-ECDSA-AES256-GCM-SHA384",
+		args: []string{"-cipher", "ECDHE-ECDSA-AES256-GCM-SHA384"},
+		cert: testECDSACertificate,
+		key:  testECDSAPrivateKey,
 	}
 	runClientTestTLS12(t, test)
 }
 
 func TestHandshakeClientAES128CBCSHA256(t *testing.T) {
 	test := &clientTest{
-		name:    "AES128-SHA256",
-		command: []string{"openssl", "s_server", "-cipher", "AES128-SHA256"},
+		name: "AES128-SHA256",
+		args: []string{"-cipher", "AES128-SHA256"},
 	}
 	runClientTestTLS12(t, test)
 }
 
 func TestHandshakeClientECDHERSAAES128CBCSHA256(t *testing.T) {
 	test := &clientTest{
-		name:    "ECDHE-RSA-AES128-SHA256",
-		command: []string{"openssl", "s_server", "-cipher", "ECDHE-RSA-AES128-SHA256"},
+		name: "ECDHE-RSA-AES128-SHA256",
+		args: []string{"-cipher", "ECDHE-RSA-AES128-SHA256"},
 	}
 	runClientTestTLS12(t, test)
 }
 
 func TestHandshakeClientECDHEECDSAAES128CBCSHA256(t *testing.T) {
 	test := &clientTest{
-		name:    "ECDHE-ECDSA-AES128-SHA256",
-		command: []string{"openssl", "s_server", "-cipher", "ECDHE-ECDSA-AES128-SHA256"},
-		cert:    testECDSACertificate,
-		key:     testECDSAPrivateKey,
+		name: "ECDHE-ECDSA-AES128-SHA256",
+		args: []string{"-cipher", "ECDHE-ECDSA-AES128-SHA256"},
+		cert: testECDSACertificate,
+		key:  testECDSAPrivateKey,
 	}
 	runClientTestTLS12(t, test)
 }
@@ -646,9 +643,9 @@ func TestHandshakeClientX25519(t *testing.T) {
 	config.CurvePreferences = []CurveID{X25519}
 
 	test := &clientTest{
-		name:    "X25519-ECDHE",
-		command: []string{"openssl", "s_server", "-cipher", "ECDHE-RSA-AES128-GCM-SHA256", "-curves", "X25519"},
-		config:  config,
+		name:   "X25519-ECDHE",
+		args:   []string{"-cipher", "ECDHE-RSA-AES128-GCM-SHA256", "-curves", "X25519"},
+		config: config,
 	}
 
 	runClientTestTLS12(t, test)
@@ -660,9 +657,9 @@ func TestHandshakeClientP256(t *testing.T) {
 	config.CurvePreferences = []CurveID{CurveP256}
 
 	test := &clientTest{
-		name:    "P256-ECDHE",
-		command: []string{"openssl", "s_server", "-cipher", "ECDHE-RSA-AES128-GCM-SHA256", "-curves", "P-256"},
-		config:  config,
+		name:   "P256-ECDHE",
+		args:   []string{"-cipher", "ECDHE-RSA-AES128-GCM-SHA256", "-curves", "P-256"},
+		config: config,
 	}
 
 	runClientTestTLS12(t, test)
@@ -674,9 +671,9 @@ func TestHandshakeClientHelloRetryRequest(t *testing.T) {
 	config.CurvePreferences = []CurveID{X25519, CurveP256}
 
 	test := &clientTest{
-		name:    "HelloRetryRequest",
-		command: []string{"openssl", "s_server", "-cipher", "ECDHE-RSA-AES128-GCM-SHA256", "-curves", "P-256"},
-		config:  config,
+		name:   "HelloRetryRequest",
+		args:   []string{"-cipher", "ECDHE-RSA-AES128-GCM-SHA256", "-curves", "P-256"},
+		config: config,
 	}
 
 	runClientTestTLS13(t, test)
@@ -687,9 +684,9 @@ func TestHandshakeClientECDHERSAChaCha20(t *testing.T) {
 	config.CipherSuites = []uint16{TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305}
 
 	test := &clientTest{
-		name:    "ECDHE-RSA-CHACHA20-POLY1305",
-		command: []string{"openssl", "s_server", "-cipher", "ECDHE-RSA-CHACHA20-POLY1305"},
-		config:  config,
+		name:   "ECDHE-RSA-CHACHA20-POLY1305",
+		args:   []string{"-cipher", "ECDHE-RSA-CHACHA20-POLY1305"},
+		config: config,
 	}
 
 	runClientTestTLS12(t, test)
@@ -700,11 +697,11 @@ func TestHandshakeClientECDHEECDSAChaCha20(t *testing.T) {
 	config.CipherSuites = []uint16{TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305}
 
 	test := &clientTest{
-		name:    "ECDHE-ECDSA-CHACHA20-POLY1305",
-		command: []string{"openssl", "s_server", "-cipher", "ECDHE-ECDSA-CHACHA20-POLY1305"},
-		config:  config,
-		cert:    testECDSACertificate,
-		key:     testECDSAPrivateKey,
+		name:   "ECDHE-ECDSA-CHACHA20-POLY1305",
+		args:   []string{"-cipher", "ECDHE-ECDSA-CHACHA20-POLY1305"},
+		config: config,
+		cert:   testECDSACertificate,
+		key:    testECDSAPrivateKey,
 	}
 
 	runClientTestTLS12(t, test)
@@ -712,22 +709,22 @@ func TestHandshakeClientECDHEECDSAChaCha20(t *testing.T) {
 
 func TestHandshakeClientAES128SHA256(t *testing.T) {
 	test := &clientTest{
-		name:    "AES128-SHA256",
-		command: []string{"openssl", "s_server", "-ciphersuites", "TLS_AES_128_GCM_SHA256"},
+		name: "AES128-SHA256",
+		args: []string{"-ciphersuites", "TLS_AES_128_GCM_SHA256"},
 	}
 	runClientTestTLS13(t, test)
 }
 func TestHandshakeClientAES256SHA384(t *testing.T) {
 	test := &clientTest{
-		name:    "AES256-SHA384",
-		command: []string{"openssl", "s_server", "-ciphersuites", "TLS_AES_256_GCM_SHA384"},
+		name: "AES256-SHA384",
+		args: []string{"-ciphersuites", "TLS_AES_256_GCM_SHA384"},
 	}
 	runClientTestTLS13(t, test)
 }
 func TestHandshakeClientCHACHA20SHA256(t *testing.T) {
 	test := &clientTest{
-		name:    "CHACHA20-SHA256",
-		command: []string{"openssl", "s_server", "-ciphersuites", "TLS_CHACHA20_POLY1305_SHA256"},
+		name: "CHACHA20-SHA256",
+		args: []string{"-ciphersuites", "TLS_CHACHA20_POLY1305_SHA256"},
 	}
 	runClientTestTLS13(t, test)
 }
@@ -747,20 +744,20 @@ func TestHandshakeClientCertRSA(t *testing.T) {
 	config.Certificates = []Certificate{cert}
 
 	test := &clientTest{
-		name:    "ClientCert-RSA-RSA",
-		command: []string{"openssl", "s_server", "-cipher", "AES128", "-verify", "1"},
-		config:  config,
+		name:   "ClientCert-RSA-RSA",
+		args:   []string{"-cipher", "AES128", "-verify", "1"},
+		config: config,
 	}
 
 	runClientTestTLS10(t, test)
 	runClientTestTLS12(t, test)
 
 	test = &clientTest{
-		name:    "ClientCert-RSA-ECDSA",
-		command: []string{"openssl", "s_server", "-cipher", "ECDHE-ECDSA-AES128-SHA", "-verify", "1"},
-		config:  config,
-		cert:    testECDSACertificate,
-		key:     testECDSAPrivateKey,
+		name:   "ClientCert-RSA-ECDSA",
+		args:   []string{"-cipher", "ECDHE-ECDSA-AES128-SHA", "-verify", "1"},
+		config: config,
+		cert:   testECDSACertificate,
+		key:    testECDSAPrivateKey,
 	}
 
 	runClientTestTLS10(t, test)
@@ -768,11 +765,11 @@ func TestHandshakeClientCertRSA(t *testing.T) {
 	runClientTestTLS13(t, test)
 
 	test = &clientTest{
-		name:    "ClientCert-RSA-AES256-GCM-SHA384",
-		command: []string{"openssl", "s_server", "-cipher", "ECDHE-RSA-AES256-GCM-SHA384", "-verify", "1"},
-		config:  config,
-		cert:    testRSACertificate,
-		key:     testRSAPrivateKey,
+		name:   "ClientCert-RSA-AES256-GCM-SHA384",
+		args:   []string{"-cipher", "ECDHE-RSA-AES256-GCM-SHA384", "-verify", "1"},
+		config: config,
+		cert:   testRSACertificate,
+		key:    testRSAPrivateKey,
 	}
 
 	runClientTestTLS12(t, test)
@@ -784,9 +781,9 @@ func TestHandshakeClientCertECDSA(t *testing.T) {
 	config.Certificates = []Certificate{cert}
 
 	test := &clientTest{
-		name:    "ClientCert-ECDSA-RSA",
-		command: []string{"openssl", "s_server", "-cipher", "AES128", "-verify", "1"},
-		config:  config,
+		name:   "ClientCert-ECDSA-RSA",
+		args:   []string{"-cipher", "AES128", "-verify", "1"},
+		config: config,
 	}
 
 	runClientTestTLS10(t, test)
@@ -794,11 +791,11 @@ func TestHandshakeClientCertECDSA(t *testing.T) {
 	runClientTestTLS13(t, test)
 
 	test = &clientTest{
-		name:    "ClientCert-ECDSA-ECDSA",
-		command: []string{"openssl", "s_server", "-cipher", "ECDHE-ECDSA-AES128-SHA", "-verify", "1"},
-		config:  config,
-		cert:    testECDSACertificate,
-		key:     testECDSAPrivateKey,
+		name:   "ClientCert-ECDSA-ECDSA",
+		args:   []string{"-cipher", "ECDHE-ECDSA-AES128-SHA", "-verify", "1"},
+		config: config,
+		cert:   testECDSACertificate,
+		key:    testECDSAPrivateKey,
 	}
 
 	runClientTestTLS10(t, test)
@@ -825,8 +822,8 @@ func TestHandshakeClientCertRSAPSS(t *testing.T) {
 
 	test := &clientTest{
 		name: "ClientCert-RSA-RSAPSS",
-		command: []string{"openssl", "s_server", "-cipher", "AES128", "-verify", "1",
-			"-client_sigalgs", "rsa_pss_rsae_sha256", "-sigalgs", "rsa_pss_rsae_sha256"},
+		args: []string{"-cipher", "AES128", "-verify", "1", "-client_sigalgs",
+			"rsa_pss_rsae_sha256", "-sigalgs", "rsa_pss_rsae_sha256"},
 		config: config,
 		cert:   testRSAPSSCertificate,
 		key:    testRSAPrivateKey,
@@ -843,8 +840,8 @@ func TestHandshakeClientCertRSAPKCS1v15(t *testing.T) {
 
 	test := &clientTest{
 		name: "ClientCert-RSA-RSAPKCS1v15",
-		command: []string{"openssl", "s_server", "-cipher", "AES128", "-verify", "1",
-			"-client_sigalgs", "rsa_pkcs1_sha256", "-sigalgs", "rsa_pkcs1_sha256"},
+		args: []string{"-cipher", "AES128", "-verify", "1", "-client_sigalgs",
+			"rsa_pkcs1_sha256", "-sigalgs", "rsa_pkcs1_sha256"},
 		config: config,
 	}
 
@@ -854,7 +851,7 @@ func TestHandshakeClientCertRSAPKCS1v15(t *testing.T) {
 func TestClientKeyUpdate(t *testing.T) {
 	test := &clientTest{
 		name:          "KeyUpdate",
-		command:       []string{"openssl", "s_server", "-state"},
+		args:          []string{"-state"},
 		sendKeyUpdate: true,
 	}
 	runClientTestTLS13(t, test)
@@ -1148,8 +1145,8 @@ func TestHandshakeClientALPNMatch(t *testing.T) {
 		name: "ALPN",
 		// Note that this needs OpenSSL 1.0.2 because that is the first
 		// version that supports the -alpn flag.
-		command: []string{"openssl", "s_server", "-alpn", "proto1,proto2"},
-		config:  config,
+		args:   []string{"-alpn", "proto1,proto2"},
+		config: config,
 		validate: func(state ConnectionState) error {
 			// The server's preferences should override the client.
 			if state.NegotiatedProtocol != "proto1" {
@@ -1206,7 +1203,7 @@ func TestRenegotiationRejected(t *testing.T) {
 	config := testConfig.Clone()
 	test := &clientTest{
 		name:                        "RenegotiationRejected",
-		command:                     []string{"openssl", "s_server", "-state"},
+		args:                        []string{"-state"},
 		config:                      config,
 		numRenegotiations:           1,
 		renegotiationExpectedToFail: 1,
@@ -1229,7 +1226,7 @@ func TestRenegotiateOnce(t *testing.T) {
 
 	test := &clientTest{
 		name:              "RenegotiateOnce",
-		command:           []string{"openssl", "s_server", "-state"},
+		args:              []string{"-state"},
 		config:            config,
 		numRenegotiations: 1,
 	}
@@ -1243,7 +1240,7 @@ func TestRenegotiateTwice(t *testing.T) {
 
 	test := &clientTest{
 		name:              "RenegotiateTwice",
-		command:           []string{"openssl", "s_server", "-state"},
+		args:              []string{"-state"},
 		config:            config,
 		numRenegotiations: 2,
 	}
@@ -1257,7 +1254,7 @@ func TestRenegotiateTwiceRejected(t *testing.T) {
 
 	test := &clientTest{
 		name:                        "RenegotiateTwiceRejected",
-		command:                     []string{"openssl", "s_server", "-state"},
+		args:                        []string{"-state"},
 		config:                      config,
 		numRenegotiations:           2,
 		renegotiationExpectedToFail: 2,
diff --git a/src/crypto/tls/testdata/Client-TLSv13-AES128-SHA256 b/src/crypto/tls/testdata/Client-TLSv13-AES128-SHA256
index da51f260c8..c35db9e681 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-AES128-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv13-AES128-SHA256
@@ -16,107 +16,75 @@
 000000e0  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
 000000f0  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 cb 6b 3c f1 71  |....z...v...k<.q|
-00000010  7d fb a1 03 ad d3 35 fb  fa 9f f5 1b 58 62 c3 83  |}.....5.....Xb..|
-00000020  18 d1 63 9f 14 57 e6 2d  82 f2 37 20 00 00 00 00  |..c..W.-..7 ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 e6 6e e6 44 9a  |....z...v...n.D.|
+00000010  c9 e2 51 58 ac ba 02 48  ea 6f dd 09 7a 08 04 d2  |..QX...H.o..z...|
+00000020  df b6 96 2f 31 d4 6b bf  ab 0e 8e 20 00 00 00 00  |.../1.k.... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 01 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 50  |..+.....3.$... P|
-00000060  5a 0c d6 69 92 a1 c7 2f  57 41 f3 29 b4 d3 a3 d3  |Z..i.../WA.)....|
-00000070  b5 62 85 2a 1d 12 dc 46  d1 ac 96 b6 16 a5 39 14  |.b.*...F......9.|
-00000080  03 03 00 01 01 17 03 03  00 17 1d a4 67 9f ac 28  |............g..(|
-00000090  dc fe 5c 58 be c0 d0 72  9d 77 05 96 1a 9c ac 54  |..\X...r.w.....T|
-000000a0  a2 17 03 03 02 6d 99 b0  fc 88 2d c2 fe 5b 84 1d  |.....m....-..[..|
-000000b0  38 f4 b9 70 87 b7 45 94  a5 09 e4 a3 2f 93 9a 9b  |8..p..E...../...|
-000000c0  ef 1f 80 a5 69 1d 81 47  d5 3e e0 f3 8e cd 1e 11  |....i..G.>......|
-000000d0  ab 2d a1 1d a7 06 9c fd  b4 dd aa 66 3e 8c e0 2f  |.-.........f>../|
-000000e0  cd e3 9a df 30 b4 c1 70  b0 be 2a 62 ba 3f f6 79  |....0..p..*b.?.y|
-000000f0  aa 74 8b f4 4f 3e bc 5c  32 25 29 69 32 d4 90 6a  |.t..O>.\2%)i2..j|
-00000100  45 45 c5 93 94 4f 90 02  9c 23 45 e0 88 14 ae 6c  |EE...O...#E....l|
-00000110  e7 be 20 4e 47 ea 50 8e  a0 c9 74 67 d2 97 d7 31  |.. NG.P...tg...1|
-00000120  52 7e f7 5a a0 55 51 c8  8f 91 12 12 d7 0e 2b a5  |R~.Z.UQ.......+.|
-00000130  ff 6c 5e 46 0d 2f d7 55  b6 c0 24 e1 5f e2 66 a0  |.l^F./.U..$._.f.|
-00000140  32 c6 cf 88 d2 35 ec fd  17 1a ec 06 19 21 5b 6c  |2....5.......![l|
-00000150  eb ac 71 0a e6 3b d3 ea  51 05 33 45 28 ef 0b 25  |..q..;..Q.3E(..%|
-00000160  7d 77 f1 76 6e fe f8 ef  74 21 ff 3b 7d 69 20 f2  |}w.vn...t!.;}i .|
-00000170  7f 99 58 cd 8a 1a ab 87  c7 b0 9c a5 77 d7 b6 54  |..X.........w..T|
-00000180  27 e5 5d ac 25 b7 7a 4a  4e 8a 74 cd 17 bf 86 4b  |'.].%.zJN.t....K|
-00000190  d4 fd a7 74 3f 03 68 d6  67 cf 05 3d 13 95 81 62  |...t?.h.g..=...b|
-000001a0  80 1a f7 d3 3c 39 3d 8b  8c 68 20 4a c4 ee 16 06  |....<9=..h J....|
-000001b0  5d 2f 3c cf 0d 26 0b 14  1a 4f 64 e4 25 c3 b5 63  |]/<..&...Od.%..c|
-000001c0  86 32 82 78 ad 3e 79 c8  c8 e5 29 78 4a a5 98 81  |.2.x.>y...)xJ...|
-000001d0  57 61 e9 3c dc f1 88 ba  a9 5b 8d e1 c1 08 a8 ed  |Wa.<.....[......|
-000001e0  c8 06 3b f7 7a 60 c7 f2  cd ea 2f 7e 0c 30 1d 2b  |..;.z`..../~.0.+|
-000001f0  e4 d6 e3 46 2d 2f d5 26  4f 63 a4 b7 7a ff 8b 29  |...F-/.&Oc..z..)|
-00000200  21 06 53 8d 99 57 f7 63  c6 72 96 cc 47 9a 80 cc  |!.S..W.c.r..G...|
-00000210  03 d5 96 3b bc ad 05 7e  49 f5 6f e6 f7 8c ae 55  |...;...~I.o....U|
-00000220  b9 59 98 a6 93 22 43 9d  62 d9 ae ba 80 c6 82 e4  |.Y..."C.b.......|
-00000230  d9 44 36 de ec dc 89 f3  45 ee bd 58 ff f5 fa de  |.D6.....E..X....|
-00000240  85 9b 0f fe 48 a1 0f 36  a4 ff f8 43 7b 18 74 49  |....H..6...C{.tI|
-00000250  87 d6 bd f0 2b b3 fd 00  8a 86 8c d1 c1 7d 66 38  |....+........}f8|
-00000260  f7 f9 72 36 77 17 7d 18  1c e6 4b 23 30 0c a4 e7  |..r6w.}...K#0...|
-00000270  34 a9 39 83 3c 25 d1 de  0d f4 61 85 7b 01 92 9f  |4.9.<%....a.{...|
-00000280  e7 47 08 e2 fa 84 59 97  8c c5 55 47 27 4f 00 da  |.G....Y...UG'O..|
-00000290  ab 88 bf b8 fe 84 36 5f  b4 f1 f1 28 75 55 29 af  |......6_...(uU).|
-000002a0  b8 a9 1b 46 dc 65 c7 97  27 4c 9a dc 00 59 3a 02  |...F.e..'L...Y:.|
-000002b0  05 2e ed b0 f1 30 74 14  dd 51 08 44 b2 9f 38 1c  |.....0t..Q.D..8.|
-000002c0  03 3c 8f 00 ad 28 e9 27  bd 75 c3 4a f6 70 5e 79  |.<...(.'.u.J.p^y|
-000002d0  7e 38 b3 df 5a 4f 69 11  f2 37 2f 52 cd cc f9 35  |~8..ZOi..7/R...5|
-000002e0  16 49 01 24 32 8a e6 da  6b 4e a8 92 a0 d7 73 7b  |.I.$2...kN....s{|
-000002f0  fb 4c 0f 00 0e 82 d7 27  d3 22 f9 82 de 41 0b 1a  |.L.....'."...A..|
-00000300  2e d3 6c 97 cb 53 b0 6c  25 b5 65 86 8e 50 87 e0  |..l..S.l%.e..P..|
-00000310  4b e6 6d 17 03 03 00 99  e1 28 35 0e 69 35 4a 55  |K.m......(5.i5JU|
-00000320  12 ab 1c 8d 43 b4 a4 44  2b 56 3c 5d c6 1b 3a a8  |....C..D+V<]..:.|
-00000330  df 0a e8 5d c2 a6 4f 83  c0 dc 07 87 53 0c 1f 63  |...]..O.....S..c|
-00000340  e2 db f0 f7 16 e9 e8 f5  5f 5a f9 b1 f1 8d 36 1d  |........_Z....6.|
-00000350  53 47 60 3f ea 22 f7 6c  7c e7 e6 79 b1 85 f2 27  |SG`?.".l|..y...'|
-00000360  5c ef 1e 99 52 5f 06 67  b3 8b 6d 13 83 06 c0 06  |\...R_.g..m.....|
-00000370  ef fa 1b 9f 92 ec 5b e5  b3 25 64 79 6c 90 11 e1  |......[..%dyl...|
-00000380  13 61 5b bf e9 4f 08 35  81 80 86 b7 77 ae 52 29  |.a[..O.5....w.R)|
-00000390  9b 24 1e b0 55 23 ca 69  2f be d1 01 38 e8 79 a8  |.$..U#.i/...8.y.|
-000003a0  e2 f7 61 0f 32 ca ff 09  44 84 84 79 19 22 54 1e  |..a.2...D..y."T.|
-000003b0  22 17 03 03 00 35 00 a1  ea bc bd 87 41 67 cc 5e  |"....5......Ag.^|
-000003c0  2f 4b 1c 52 c2 56 2c 69  7e 69 9b a3 06 69 b5 0b  |/K.R.V,i~i...i..|
-000003d0  6c 2e 1f de 53 9d 82 22  b7 36 9f ac 0e 7a 83 e5  |l...S..".6...z..|
-000003e0  18 30 5b a9 b7 15 5a 16  87 97 1b                 |.0[...Z....|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 98  |..+.....3.$... .|
+00000060  b2 16 47 4d 82 da 23 5b  2a a4 63 29 11 a8 d4 c0  |..GM..#[*.c)....|
+00000070  0b 5e 2d 73 0d d6 e7 1e  15 78 1a c2 58 93 70 14  |.^-s.....x..X.p.|
+00000080  03 03 00 01 01 17 03 03  00 17 c3 65 82 87 0c 61  |...........e...a|
+00000090  57 28 08 d5 da fc 59 8d  a3 76 49 0f d5 80 68 3d  |W(....Y..vI...h=|
+000000a0  03 17 03 03 02 6d c5 f1  b7 8a 61 03 06 9e 0f 3b  |.....m....a....;|
+000000b0  be 71 5b 29 17 c7 ed 0e  23 40 90 c6 7a 22 4e ad  |.q[)....#@..z"N.|
+000000c0  d5 f1 60 f6 db d9 37 73  1f b6 43 f7 7b fe 7b aa  |..`...7s..C.{.{.|
+000000d0  f7 16 28 e5 a8 b6 be 69  da 79 09 b5 dc ab bf d3  |..(....i.y......|
+000000e0  36 ca 19 ae 8c de 27 5c  0d 44 5e 4a e2 ac ff bc  |6.....'\.D^J....|
+000000f0  33 4e 35 d3 8d 21 22 4d  12 38 e2 f9 73 3b 3d d1  |3N5..!"M.8..s;=.|
+00000100  a7 b1 06 6a 6a 8d 25 0f  47 b1 d1 f2 da 32 cc 58  |...jj.%.G....2.X|
+00000110  9e 78 b6 b4 4e c1 bc 9d  91 38 44 ff 35 71 a7 c3  |.x..N....8D.5q..|
+00000120  39 67 5b 50 b1 9b 87 5d  fd 6d 87 42 25 10 1a 19  |9g[P...].m.B%...|
+00000130  e1 95 19 2f a1 2c 95 6e  ce 6c c9 d9 92 1d e6 7f  |.../.,.n.l......|
+00000140  9d d0 98 60 f3 6c cf 64  8e 66 bb a4 af de 1e b6  |...`.l.d.f......|
+00000150  6a 6d 7b 11 a7 ca e1 29  49 f3 57 50 73 e8 36 79  |jm{....)I.WPs.6y|
+00000160  81 fe 33 f7 04 1a 04 e3  60 8e e7 11 fa 07 bb 79  |..3.....`......y|
+00000170  73 c0 b7 5e 0f 61 b7 3a  50 85 a4 e1 8e 3b a3 43  |s..^.a.:P....;.C|
+00000180  79 8a 14 78 0a ff 66 b4  c3 c0 fe 0a 6a c6 66 72  |y..x..f.....j.fr|
+00000190  a8 8a e1 9c a6 ad ee 74  53 d9 b8 07 17 b3 9b f6  |.......tS.......|
+000001a0  eb 28 1b 64 97 aa 17 fa  80 36 cb b1 35 6e ec e1  |.(.d.....6..5n..|
+000001b0  16 1f ba 00 0c 26 fb 17  0e 00 8a e3 28 0d 6a 76  |.....&......(.jv|
+000001c0  8c 78 ee 55 02 78 66 90  5b 87 f2 16 e2 af ef fb  |.x.U.xf.[.......|
+000001d0  a1 f3 8f fd b9 8e e3 16  68 7a ec c0 54 2f 88 c4  |........hz..T/..|
+000001e0  08 6c 55 48 58 56 ac 3e  26 5b 67 42 18 72 6e a1  |.lUHXV.>&[gB.rn.|
+000001f0  b5 86 cf 55 d1 29 c5 9b  2c 7b 7d f3 a5 26 2e 5e  |...U.)..,{}..&.^|
+00000200  21 3a 40 97 5a c1 c8 13  3d c3 12 4e d8 88 e1 8f  |!:@.Z...=..N....|
+00000210  e8 c5 d3 9b 0f 49 24 42  da 27 ac e5 5e 21 2e 2c  |.....I$B.'..^!.,|
+00000220  8b 27 ae c4 39 49 6f 43  69 a3 e4 0d f1 fc 62 9f  |.'..9IoCi.....b.|
+00000230  be 65 78 01 d8 c8 4e 0f  b5 d7 12 d1 fc 73 cc 6e  |.ex...N......s.n|
+00000240  cc df d3 df 33 e4 f8 8e  4f 82 60 cd 1f a1 71 74  |....3...O.`...qt|
+00000250  20 7a e2 46 fc 7a 83 15  dc 6c 5d b3 4f 92 de a2  | z.F.z...l].O...|
+00000260  99 b5 33 4e b0 5d 19 0f  84 ae de 65 2e ee ef 40  |..3N.].....e...@|
+00000270  e9 5b c6 53 86 0d 88 fc  2a b2 2c 5c 76 66 95 a7  |.[.S....*.,\vf..|
+00000280  96 ad 7f ba 27 ea e4 54  5e 77 97 0d 6f 9e b8 e5  |....'..T^w..o...|
+00000290  b7 2f 75 13 42 7e 61 08  e3 69 31 d4 e6 d0 c0 6d  |./u.B~a..i1....m|
+000002a0  e3 e2 e4 69 5d d0 7d c2  f1 48 a1 e0 23 f1 19 81  |...i].}..H..#...|
+000002b0  23 ed a7 ac ed 88 70 60  c6 eb cf 11 23 39 cb 91  |#.....p`....#9..|
+000002c0  35 3b 32 6c 20 fc 61 cb  49 77 9c d9 5d e2 b4 41  |5;2l .a.Iw..]..A|
+000002d0  b9 c6 22 af 36 e4 a4 c4  45 47 f4 53 3f 7f b4 25  |..".6...EG.S?..%|
+000002e0  a0 34 f4 40 42 04 17 63  3b fa 05 35 c3 76 ec f7  |.4.@B..c;..5.v..|
+000002f0  b3 ee 62 fb 03 dc 06 22  90 4b fd 07 62 3b cd 27  |..b....".K..b;.'|
+00000300  da 87 32 73 3d 46 5c e7  b6 22 f7 02 8e 43 f4 46  |..2s=F\.."...C.F|
+00000310  79 cb 9b 17 03 03 00 99  81 e1 c1 b3 1d 11 4b 61  |y.............Ka|
+00000320  6a 4a f2 9a 97 52 36 2a  fc ef 77 54 aa 28 a7 4f  |jJ...R6*..wT.(.O|
+00000330  46 c5 69 2a a7 d7 da d6  ff 28 b1 21 3b 66 ac a7  |F.i*.....(.!;f..|
+00000340  ff 66 0a 10 20 1d 24 9b  f3 46 1a a7 04 4b b5 3d  |.f.. .$..F...K.=|
+00000350  e8 49 fc 3a f0 74 a8 02  b9 2d 5d e4 de 91 ef 4d  |.I.:.t...-]....M|
+00000360  ab 47 10 2c ba 70 c1 aa  a9 79 a8 96 27 71 90 e3  |.G.,.p...y..'q..|
+00000370  91 4d 4e dd 96 e0 4c ad  c5 0b 44 0a c0 4d 17 42  |.MN...L...D..M.B|
+00000380  65 12 8a ba fb 7c 66 7c  92 61 87 07 cd e3 a0 16  |e....|f|.a......|
+00000390  8b 94 23 77 85 70 88 d2  22 64 14 16 b5 ab db 6a  |..#w.p.."d.....j|
+000003a0  b9 23 26 ee c8 33 6e 9b  a6 e4 d1 85 d2 81 3a 5d  |.#&..3n.......:]|
+000003b0  33 17 03 03 00 35 b2 85  a7 fd fc 27 46 25 8f cd  |3....5.....'F%..|
+000003c0  ac ff 84 0a 54 cf f2 11  94 41 d0 7e 04 50 61 7d  |....T....A.~.Pa}|
+000003d0  71 40 df bc 48 0f c1 32  50 83 5c 05 c9 a5 02 95  |q@..H..2P.\.....|
+000003e0  77 04 8c 76 ee 44 32 44  94 e3 8b                 |w..v.D2D...|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 23 b7 8d d5 9b  |..........5#....|
-00000010  e4 f6 21 27 94 5b 11 76  5c 1f ff f3 19 f8 43 a2  |..!'.[.v\.....C.|
-00000020  4d 07 68 00 a1 de 53 c9  80 f9 e7 fa 56 2c 6b b8  |M.h...S.....V,k.|
-00000030  bc 09 5e 61 ea 0c da c8  89 1c 41 95 55 0d ef 94  |..^a......A.U...|
-00000040  17 03 03 00 17 9a 18 9a  29 27 19 1b 06 da 82 78  |........)'.....x|
-00000050  da 9a 91 77 36 47 ce 25  72 dc b9 26              |...w6G.%r..&|
->>> Flow 4 (server to client)
-00000000  17 03 03 00 ea d6 5f a3  a5 14 87 cc 16 54 4c a0  |......_......TL.|
-00000010  57 34 92 34 4d 37 fb 27  2b 71 f7 cf ac 93 96 87  |W4.4M7.'+q......|
-00000020  9a 1f 8d 58 cf 3a 0d 8c  00 e2 03 b1 6e e1 9f d3  |...X.:......n...|
-00000030  f4 dc 17 73 70 59 52 03  a7 fc 99 cb d2 2d 0e c8  |...spYR......-..|
-00000040  91 5c 18 42 a3 20 9b 1c  20 86 bc 15 71 5b b4 7d  |.\.B. .. ...q[.}|
-00000050  80 8d cf 1d 15 33 b8 aa  66 9d f0 f9 08 dc 7c 78  |.....3..f.....|x|
-00000060  b7 12 48 11 e1 00 1c e7  3e b3 8b fe bf 07 6d 6d  |..H.....>.....mm|
-00000070  4c 7b 16 90 cb 8c da 03  a8 81 94 5c 76 09 c4 bf  |L{.........\v...|
-00000080  26 b4 2b fd 9c 44 b5 c0  49 4b 83 58 70 80 8f 7f  |&.+..D..IK.Xp...|
-00000090  1e f8 d0 b4 5d 6e a2 78  f0 8c 9d 0b e8 1a 0b b4  |....]n.x........|
-000000a0  66 7e 74 88 35 a4 d0 a3  ab 6c b5 2a 90 3c ba 09  |f~t.5....l.*.<..|
-000000b0  9c 4e 72 b7 9a ba f9 1f  bb a9 bf 03 94 43 7a d2  |.Nr..........Cz.|
-000000c0  25 2f c5 e8 83 89 37 1f  ac 7b 22 7c 01 7e dc 97  |%/....7..{"|.~..|
-000000d0  b3 05 5c 60 5b 22 2f be  8c 05 e8 1a a6 51 45 13  |..\`["/......QE.|
-000000e0  7f 20 b9 24 f0 a6 7c 1d  21 37 b8 6c 47 9e e8 17  |. .$..|.!7.lG...|
-000000f0  03 03 00 ea c1 05 ef 9c  bf 4c 1a d9 36 0d d4 d0  |.........L..6...|
-00000100  68 47 ac 8b c6 13 71 17  94 e7 74 8e 21 78 91 79  |hG....q...t.!x.y|
-00000110  50 19 4e 43 0d f7 e9 a9  62 e5 25 17 67 3e 38 27  |P.NC....b.%.g>8'|
-00000120  dd 3b 5d e9 ec cb 0f b7  1f aa bd 75 76 f7 88 b8  |.;]........uv...|
-00000130  c6 60 2f b7 ad 89 17 bb  bd d2 86 55 72 bd 52 10  |.`/........Ur.R.|
-00000140  21 4d 92 2d c1 a8 24 18  63 ca 0a 38 90 6b 39 5c  |!M.-..$.c..8.k9\|
-00000150  76 58 ad 62 e5 57 e0 b5  d5 af c9 9b 64 84 76 48  |vX.b.W......d.vH|
-00000160  4d 7f a7 32 09 50 f7 9e  92 ad ed 8e b5 0f 10 27  |M..2.P.........'|
-00000170  45 bc 58 fd be 91 35 97  ec 71 af d5 6a e1 04 26  |E.X...5..q..j..&|
-00000180  00 b3 91 4f a2 be ba b8  06 f1 2f 43 21 a6 0b ba  |...O....../C!...|
-00000190  43 b5 dd a6 cd a6 b1 1c  37 28 90 26 c4 af 71 56  |C.......7(.&..qV|
-000001a0  26 4d 39 39 60 88 8d ae  d1 3e 6e 7e 15 cb 60 1c  |&M99`....>n~..`.|
-000001b0  d2 00 c3 02 b6 2b 81 ea  60 1b 3a a8 a4 dc 29 c0  |.....+..`.:...).|
-000001c0  df 86 41 b8 27 89 3a ca  bc 31 19 ca 18 08 9e 96  |..A.'.:..1......|
-000001d0  e7 b4 6b 78 8d d4 9a 75  1a 48 fb 49 6a 29        |..kx...u.H.Ij)|
->>> Flow 5 (client to server)
-00000000  17 03 03 00 13 d5 5b 3c  bb 8b 4d f2 c2 d8 dc 0b  |......[<..M.....|
-00000010  5a 94 49 38 ed 11 91 8a                           |Z.I8....|
+00000000  14 03 03 00 01 01 17 03  03 00 35 11 f3 e0 d9 39  |..........5....9|
+00000010  43 24 33 e1 54 01 5d f2  c7 50 21 9f db 2d 31 81  |C$3.T.]..P!..-1.|
+00000020  3f d5 9c cb 59 cb 24 40  2a 77 da 0a 9e 52 12 11  |?...Y.$@*w...R..|
+00000030  1e a8 f8 e2 f2 9e 32 6c  06 8c 48 e8 bf 9d ef 0f  |......2l..H.....|
+00000040  17 03 03 00 17 bc a1 a2  8a a1 6c c3 19 d1 49 7f  |..........l...I.|
+00000050  57 af 58 5b ff 7b 11 b2  bb 45 3c 6f 17 03 03 00  |W.X[.{...E<o....|
+00000060  13 54 2f ac 2b 0f 9d de  27 bc f6 90 e5 ef f3 fd  |.T/.+...'.......|
+00000070  f7 cd 07 f9                                       |....|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-AES256-SHA384 b/src/crypto/tls/testdata/Client-TLSv13-AES256-SHA384
index 306d6c85da..723a9e92d7 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-AES256-SHA384
+++ b/src/crypto/tls/testdata/Client-TLSv13-AES256-SHA384
@@ -16,109 +16,77 @@
 000000e0  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
 000000f0  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 d0 99 92 ec 66  |....z...v......f|
-00000010  25 e2 c4 9f 90 fa 7c 03  49 b9 19 3e 75 1b 37 42  |%.....|.I..>u.7B|
-00000020  2b cf b4 b7 93 81 29 ef  5a e7 c2 20 00 00 00 00  |+.....).Z.. ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 fa ff 71 26 f0  |....z...v....q&.|
+00000010  2c ee 80 2c 1c f9 ea 4b  de ad d0 61 83 7f 89 6f  |,..,...K...a...o|
+00000020  db e6 a9 53 ff c5 b5 ec  04 08 4c 20 00 00 00 00  |...S......L ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 02 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 7a  |..+.....3.$... z|
-00000060  cc 5a 50 25 51 9c 6f 4d  5a d4 dc a0 fa 55 00 33  |.ZP%Q.oMZ....U.3|
-00000070  26 0e f7 12 14 9b c2 e0  77 8e ff d3 95 3f 0c 14  |&.......w....?..|
-00000080  03 03 00 01 01 17 03 03  00 17 b1 10 59 e2 0b 67  |............Y..g|
-00000090  69 df ef 28 e4 f3 9c fc  df 48 25 d2 b6 86 68 48  |i..(.....H%...hH|
-000000a0  a2 17 03 03 02 6d 91 c1  dd 49 92 5c 77 c1 3f 38  |.....m...I.\w.?8|
-000000b0  7d 78 80 21 d1 cc 15 d4  30 ba 77 fb 64 2c ca 05  |}x.!....0.w.d,..|
-000000c0  ea bc 88 46 51 47 fd bb  39 08 a8 a8 db 3d 22 86  |...FQG..9....=".|
-000000d0  fd b0 78 17 ac 19 18 b4  bb 00 df bf 02 47 75 fb  |..x..........Gu.|
-000000e0  34 06 ea 66 1b ae 06 5c  03 2d 5a 8e a5 55 20 3a  |4..f...\.-Z..U :|
-000000f0  ca 1f e9 53 58 6f 7b e7  c4 fa fd 22 7a 7a 45 df  |...SXo{...."zzE.|
-00000100  7c a7 53 58 92 a4 f9 75  c6 17 b1 bb 68 7b 4e 59  ||.SX...u....h{NY|
-00000110  26 af 4d 1d 18 6c 6a f9  9d 14 52 89 7a 1a dd 97  |&.M..lj...R.z...|
-00000120  67 4c 4d cd 1c 3f 66 95  d0 9b 4f 77 cf 22 bf 80  |gLM..?f...Ow."..|
-00000130  49 17 45 a9 8e 8c 88 3b  21 ce d7 b9 43 e4 ff ac  |I.E....;!...C...|
-00000140  44 c2 6a 48 60 77 a1 39  8a 92 0c 9b ca f7 da 66  |D.jH`w.9.......f|
-00000150  36 9a 86 9f 6e 2d 9b 49  2a 25 30 72 4f 09 41 e5  |6...n-.I*%0rO.A.|
-00000160  37 34 30 a4 f9 f9 59 14  22 89 e7 10 2e 71 ee ac  |740...Y."....q..|
-00000170  82 e9 30 f0 1a 09 2d b5  51 26 ba 71 6b 06 dd fb  |..0...-.Q&.qk...|
-00000180  e4 e3 be 96 60 04 1c c9  45 7c 1c 58 9f b1 ae d7  |....`...E|.X....|
-00000190  6a b2 41 ce 2c b8 fb 07  0a 2d 47 92 53 95 c2 65  |j.A.,....-G.S..e|
-000001a0  3c a2 b5 84 58 c2 ae 67  46 9d 79 1e f6 52 59 36  |<...X..gF.y..RY6|
-000001b0  1b 72 fb 2a b7 6f 74 38  d7 c6 35 9d f5 ce 12 89  |.r.*.ot8..5.....|
-000001c0  25 c5 3e 0e 40 f2 75 30  2b ee 02 61 54 c6 d5 8a  |%.>.@.u0+..aT...|
-000001d0  19 b0 be 03 83 cf c7 0b  bc 56 88 62 3b 7f 80 4e  |.........V.b;..N|
-000001e0  e7 8b bd 7f 99 c4 63 76  3e da d7 51 96 c4 52 2d  |......cv>..Q..R-|
-000001f0  49 7a 8d 8e fe d0 01 bb  29 84 2e 55 70 69 fb ba  |Iz......)..Upi..|
-00000200  f8 6a 8e f4 7d e3 98 46  1b 52 f5 0f 9c 9d 73 29  |.j..}..F.R....s)|
-00000210  4d a6 f4 32 ee 2e 67 5c  f2 03 a4 12 5e 16 2b 1b  |M..2..g\....^.+.|
-00000220  98 b2 d3 6c ee f4 10 db  3d b1 7d 75 6e c0 6a bd  |...l....=.}un.j.|
-00000230  56 56 c1 7f ef f5 c5 fe  f9 48 6e 8f 93 1f 5d c2  |VV.......Hn...].|
-00000240  35 ee 2f 15 f5 bf d1 10  14 dd c8 69 08 f0 be a2  |5./........i....|
-00000250  45 4b 96 9e 12 0a 7f fa  4b 41 78 9c 54 9f 10 97  |EK......KAx.T...|
-00000260  4f a7 4b 06 af b3 ab 1a  b9 b0 b3 02 11 08 c4 f4  |O.K.............|
-00000270  21 fb 86 c5 e9 d9 87 37  d3 79 14 0a 09 c2 4f 7a  |!......7.y....Oz|
-00000280  1c c2 8e ee 00 b1 0a 78  4f ac f1 78 95 5e 93 95  |.......xO..x.^..|
-00000290  a7 ad 44 87 a1 30 d9 5b  1b 13 c5 d8 93 77 2d 2c  |..D..0.[.....w-,|
-000002a0  68 02 ff c5 91 78 8b 1f  19 eb 53 ae 5c b7 8a e9  |h....x....S.\...|
-000002b0  76 ad 62 6a 03 1f f1 ad  01 32 3f 9a 07 36 6b 0a  |v.bj.....2?..6k.|
-000002c0  80 df 8a 87 f3 76 60 53  1f a7 a9 87 92 87 0a 3f  |.....v`S.......?|
-000002d0  7d 6e f3 94 23 b6 6e ae  cd 32 4f 1c e4 06 42 cc  |}n..#.n..2O...B.|
-000002e0  33 50 81 dc e3 7b 2b 7a  e4 b9 40 63 b7 13 a9 1c  |3P...{+z..@c....|
-000002f0  6f 30 53 17 4a 6f 18 d7  98 e5 bd 2d ef c3 90 04  |o0S.Jo.....-....|
-00000300  da 3b eb 3d 79 4f 34 fb  af b1 1b b0 99 6a 7b 11  |.;.=yO4......j{.|
-00000310  e0 34 b9 17 03 03 00 99  43 66 96 ed b4 0d 38 fa  |.4......Cf....8.|
-00000320  e5 41 89 50 30 42 59 f2  35 1e 55 7f ba 7e c8 d2  |.A.P0BY.5.U..~..|
-00000330  c8 34 d1 68 56 22 99 09  76 44 51 e2 5d ba 54 d1  |.4.hV"..vDQ.].T.|
-00000340  7d ea a7 15 37 0a c9 b0  3b b5 42 97 34 4e 47 21  |}...7...;.B.4NG!|
-00000350  f8 4e 94 38 3a 29 c6 6a  e6 c7 f8 fe ef 9a 7f 42  |.N.8:).j.......B|
-00000360  d3 08 33 b2 c4 fb 63 a0  76 2d ff e9 e2 83 66 35  |..3...c.v-....f5|
-00000370  b4 1c 7e 10 4a 1d 02 ea  b3 ab 77 b2 05 08 ae d3  |..~.J.....w.....|
-00000380  33 5b f0 68 dd 4f 7e 05  99 82 b2 86 a3 49 55 b2  |3[.h.O~......IU.|
-00000390  71 52 8b d5 fe a7 ee 75  8c b9 6d 3b 24 eb 1b 0a  |qR.....u..m;$...|
-000003a0  70 f2 89 19 2e ed ff 66  06 bd 28 ee df 4f 53 60  |p......f..(..OS`|
-000003b0  66 17 03 03 00 45 6a 8f  40 5a f8 80 ff a6 e4 aa  |f....Ej.@Z......|
-000003c0  bc 7f 25 8d 99 4c 4a 87  31 39 1a 11 88 ca f5 c6  |..%..LJ.19......|
-000003d0  55 fb 6c 53 27 f8 c9 83  cd fc 91 dc cd ce 5d 9b  |U.lS'.........].|
-000003e0  70 9f 8d ca 17 82 7c d4  3a 57 87 22 4c 50 f6 ce  |p.....|.:W."LP..|
-000003f0  73 74 64 2d 83 3b 78 d2  29 d6 a3                 |std-.;x.)..|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 6f  |..+.....3.$... o|
+00000060  2a 3a fe 8e dc cf 2e 7d  26 bd 12 fb da 0a 00 16  |*:.....}&.......|
+00000070  b7 12 79 72 a0 a8 95 11  81 d5 b3 ae f8 d7 26 14  |..yr..........&.|
+00000080  03 03 00 01 01 17 03 03  00 17 42 95 95 65 84 db  |..........B..e..|
+00000090  3e dc c4 41 bb e2 21 94  27 2d 9e 27 4e dd 3e 9d  |>..A..!.'-.'N.>.|
+000000a0  6e 17 03 03 02 6d 71 24  bb 82 cf aa 37 52 4c 15  |n....mq$....7RL.|
+000000b0  6d 5c 74 44 c5 08 21 31  ab 47 5a 75 b9 31 d6 97  |m\tD..!1.GZu.1..|
+000000c0  69 64 40 b5 09 1c 2b 36  1d 54 19 52 4b ad c9 1c  |id@...+6.T.RK...|
+000000d0  d4 51 33 80 a4 b9 df 47  17 6a eb 7a d7 bc 12 3e  |.Q3....G.j.z...>|
+000000e0  7b 28 fa 15 16 aa 23 6f  b5 5f a4 f6 8e 2b 00 11  |{(....#o._...+..|
+000000f0  1b f2 00 e4 c8 31 38 ee  61 71 bc 7f dd a1 45 2d  |.....18.aq....E-|
+00000100  ac 1c 2b fd cd 40 51 29  4e 07 fd f4 04 45 09 56  |..+..@Q)N....E.V|
+00000110  72 c8 83 22 3e 20 06 3a  93 16 89 21 4a 9f 3b bc  |r.."> .:...!J.;.|
+00000120  63 7f c0 1b 6a b2 30 d1  49 43 90 08 af 28 4a c1  |c...j.0.IC...(J.|
+00000130  79 96 a1 72 0a 82 fe fb  20 1d 18 f8 b7 03 01 89  |y..r.... .......|
+00000140  05 04 d7 98 1b 77 2e ad  81 56 de 08 f1 83 1e 9c  |.....w...V......|
+00000150  7d 2b 16 e1 15 87 12 db  5f 59 5d a3 95 75 ab f8  |}+......_Y]..u..|
+00000160  54 87 91 0d 7f 80 76 6e  d8 44 f3 c5 ef d6 b4 3d  |T.....vn.D.....=|
+00000170  6e 91 4c 65 b7 94 2d 05  d1 1e e6 49 d4 78 1c 34  |n.Le..-....I.x.4|
+00000180  48 4a 5b 8c ed ad f7 cb  60 98 56 b5 98 ed 7e 88  |HJ[.....`.V...~.|
+00000190  4b 98 ec aa 7d 79 71 2c  f2 2f 15 5e c1 ed a6 14  |K...}yq,./.^....|
+000001a0  01 df 25 df 79 35 1c f0  52 85 7b 2b 46 2c 09 14  |..%.y5..R.{+F,..|
+000001b0  26 86 2c 6a d5 ec cf 24  04 49 9c d8 61 65 02 aa  |&.,j...$.I..ae..|
+000001c0  d6 ce 55 07 2f b6 23 f3  a7 8d 78 f9 72 fc 77 8b  |..U./.#...x.r.w.|
+000001d0  45 72 0e 61 c2 e8 8d 65  00 50 8b 00 42 48 d1 10  |Er.a...e.P..BH..|
+000001e0  1f 3e cc ca 21 10 4c 0b  6b fc f8 c1 b7 83 3e 25  |.>..!.L.k.....>%|
+000001f0  8e 40 11 55 32 34 83 0b  98 38 ad 2a ff e0 ae 71  |.@.U24...8.*...q|
+00000200  86 0d 9a ef 50 e8 8a 32  53 ba c8 71 4e 96 46 95  |....P..2S..qN.F.|
+00000210  c2 31 b5 64 6c 74 8e b6  be 8c e7 bd 5c 79 fd 87  |.1.dlt......\y..|
+00000220  db 7e 39 82 7c 7b 38 58  42 34 a1 64 e9 15 f8 f3  |.~9.|{8XB4.d....|
+00000230  56 2c ec c9 4f f3 4d e0  3d a6 ec 87 5f 48 be 75  |V,..O.M.=..._H.u|
+00000240  d0 9e a6 6c ef 97 db a8  66 ff 8b 5e 34 28 bb 34  |...l....f..^4(.4|
+00000250  e0 9c a0 a1 18 2a f4 98  71 e7 8b 18 2c 7c 37 a9  |.....*..q...,|7.|
+00000260  c0 75 b4 24 7f ce 85 42  fe ed 7f fd 6d 7c 3d 5b  |.u.$...B....m|=[|
+00000270  bf d4 72 b9 2f 6d b6 09  86 cd 48 2f 69 a5 94 86  |..r./m....H/i...|
+00000280  ab e9 04 b7 b3 88 3b 49  6b 28 e5 8a 30 73 60 9a  |......;Ik(..0s`.|
+00000290  c9 ff c5 ff 62 0b cc 3a  ec 8b 4b a5 f2 2e c3 9d  |....b..:..K.....|
+000002a0  a1 5d 51 9d f0 2d 88 20  24 cc bf cf 79 69 aa 4d  |.]Q..-. $...yi.M|
+000002b0  f0 86 ba 9f 7c b4 f0 e3  97 54 7b f5 68 f8 da 26  |....|....T{.h..&|
+000002c0  38 a5 5c 86 c5 0a f5 06  af 58 66 e3 40 a0 33 d4  |8.\......Xf.@.3.|
+000002d0  cb 90 52 1b 81 3d 31 9d  f9 8f 4f d9 38 80 f3 ea  |..R..=1...O.8...|
+000002e0  79 c4 2c 55 3f ea 9b 79  51 24 dc 70 6e 5c 68 ce  |y.,U?..yQ$.pn\h.|
+000002f0  b0 65 58 ec 3d 62 27 f3  1c 34 b4 7c b5 8e 91 1d  |.eX.=b'..4.|....|
+00000300  dc 6b 21 b5 3d 9c 6f 30  91 f8 39 d8 11 03 65 95  |.k!.=.o0..9...e.|
+00000310  72 71 36 17 03 03 00 99  4f 82 32 b2 1c df 6d 0d  |rq6.....O.2...m.|
+00000320  c5 6f d7 89 39 07 42 4d  d5 ae 7d 0d 6f a8 68 41  |.o..9.BM..}.o.hA|
+00000330  ca 64 5c 38 5a 31 85 02  d7 99 28 ac 0d 33 1b e2  |.d\8Z1....(..3..|
+00000340  d8 f7 f2 d3 13 30 50 0f  e9 21 3c 9e 53 1c fb cd  |.....0P..!<.S...|
+00000350  96 e7 00 ef 35 5d d6 a7  64 77 fd 76 07 fa e6 e0  |....5]..dw.v....|
+00000360  04 ec cf c0 76 41 a7 12  37 e0 c3 42 43 11 54 7e  |....vA..7..BC.T~|
+00000370  4f b8 38 3a 3e 60 0f 9c  ac 65 d1 84 d3 6e b1 c2  |O.8:>`...e...n..|
+00000380  fc be a7 96 59 89 87 c7  b9 d7 09 c0 ef 68 d7 10  |....Y........h..|
+00000390  a5 08 8a 45 23 17 47 e3  eb f7 9f d3 ab 54 d1 4a  |...E#.G......T.J|
+000003a0  8c 69 1f aa a3 43 af dd  ce 76 a3 9a 6f e5 4c 6a  |.i...C...v..o.Lj|
+000003b0  07 17 03 03 00 45 b8 72  a2 fb af 1c 5e 8f ed 0a  |.....E.r....^...|
+000003c0  53 85 d3 cd 32 ad 56 ba  38 82 1c 23 40 83 7e c1  |S...2.V.8..#@.~.|
+000003d0  ce 0f 53 f5 74 a0 54 39  aa fb f1 13 8d 5f 3a 93  |..S.t.T9....._:.|
+000003e0  fc 98 72 3f e5 70 e2 e5  97 fb 92 ca 2b 52 50 96  |..r?.p......+RP.|
+000003f0  3f d0 8d 94 d5 17 2b 0d  90 4a 12                 |?.....+..J.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 45 8b d1 99 f6 dd  |..........E.....|
-00000010  80 21 59 2a 8a 12 a2 e3  1b 57 50 bd 49 90 95 c0  |.!Y*.....WP.I...|
-00000020  17 59 0a c1 55 ff 14 f1  3d 95 e6 c9 ce 60 c7 94  |.Y..U...=....`..|
-00000030  24 a3 a2 45 69 7a b0 0d  9f 1e f4 79 2c a7 73 f3  |$..Eiz.....y,.s.|
-00000040  d1 2a f5 cb f6 86 79 3f  84 77 58 66 6d 96 0e eb  |.*....y?.wXfm...|
-00000050  17 03 03 00 17 26 45 2f  9c 9d 50 44 2d e4 a0 ce  |.....&E/..PD-...|
-00000060  fa b5 0b 37 a4 52 bb f6  ec 86 80 64              |...7.R.....d|
->>> Flow 4 (server to client)
-00000000  17 03 03 00 ea 66 4c 54  52 a3 b4 4a 24 0b 2f 8b  |.....fLTR..J$./.|
-00000010  03 f7 61 70 3b 2a 69 cf  93 95 57 88 b6 1b 6d 2f  |..ap;*i...W...m/|
-00000020  81 88 7f a9 fd 47 ee 88  00 1d 94 96 1e 37 09 d4  |.....G.......7..|
-00000030  e0 fe 47 fe 7f 33 5a 5a  74 b8 ae 63 b8 12 b2 07  |..G..3ZZt..c....|
-00000040  a6 7c 8c cd 15 6e 88 c1  41 f9 c5 c6 b6 62 08 9a  |.|...n..A....b..|
-00000050  f2 30 e5 cd 2b a8 be f1  b6 73 2d 97 21 b3 ac 42  |.0..+....s-.!..B|
-00000060  2c 35 cb 3b 9f 4a f6 3d  82 b1 91 a5 15 0a 43 e5  |,5.;.J.=......C.|
-00000070  3d 0b 86 db bf bb cf 5a  ab 67 0a 32 4b e1 ec 7b  |=......Z.g.2K..{|
-00000080  9a ea ee 8f 82 f2 0d 27  58 3d d5 85 ea 13 2c ed  |.......'X=....,.|
-00000090  87 77 95 65 55 1f ca 55  83 01 6f ee 56 74 1f 97  |.w.eU..U..o.Vt..|
-000000a0  f7 e5 aa b8 7a 76 24 51  fd 14 71 0f 34 58 99 0b  |....zv$Q..q.4X..|
-000000b0  da cf 99 38 a5 27 83 37  a8 73 6f 84 11 9c 67 d5  |...8.'.7.so...g.|
-000000c0  bc ce aa 07 73 30 2d 13  d0 6a f4 d0 51 92 89 b4  |....s0-..j..Q...|
-000000d0  d1 86 ed 50 a4 bf 95 63  77 d6 dc bc 40 75 f8 00  |...P...cw...@u..|
-000000e0  f6 b2 16 30 65 1b 46 25  8e 2d c6 f7 f4 5b 70 17  |...0e.F%.-...[p.|
-000000f0  03 03 00 ea 8e 55 c9 38  ba 01 57 ff 88 1b c0 b0  |.....U.8..W.....|
-00000100  d5 de 46 e9 17 43 2d 38  e3 c9 c2 ea 07 67 d7 8d  |..F..C-8.....g..|
-00000110  ab 36 e0 86 06 b4 ba d7  0d 93 9c da 10 fe b9 8c  |.6..............|
-00000120  7f 2e aa 8f a8 67 fd 72  fa 7e 8c 17 79 69 b7 3e  |.....g.r.~..yi.>|
-00000130  02 15 4d 72 02 80 1f f1  c6 d2 55 a8 67 07 63 db  |..Mr......U.g.c.|
-00000140  c8 92 1e fb e4 73 cd f9  48 5e aa 9b 76 c4 3e 85  |.....s..H^..v.>.|
-00000150  b7 2a 68 52 4d d9 4d be  ba 74 f5 e0 5e 4b 3d d3  |.*hRM.M..t..^K=.|
-00000160  78 24 bc ba 89 c4 6e ac  54 04 7d fd 6b ee 71 f9  |x$....n.T.}.k.q.|
-00000170  19 02 77 3a a3 d4 27 ab  c4 95 38 f4 16 b6 18 77  |..w:..'...8....w|
-00000180  8d 2a 7e d7 45 64 64 39  6f 4d 87 be 99 53 a8 ac  |.*~.Edd9oM...S..|
-00000190  f9 5e a6 e0 3d 1f 64 26  c6 f5 27 34 c8 8d 2b 1b  |.^..=.d&..'4..+.|
-000001a0  ad 12 0c 95 59 5c 07 5e  44 bf aa b0 0f b3 8c 13  |....Y\.^D.......|
-000001b0  a4 6f ed 6a af 58 dc 87  32 70 e4 6b 64 f8 44 37  |.o.j.X..2p.kd.D7|
-000001c0  cf 4a b0 3f 57 34 05 1c  b8 47 5e ba f2 93 cc b2  |.J.?W4...G^.....|
-000001d0  8e 86 ef b0 3c ea 4f 75  cf 85 ba 6e 9d 22        |....<.Ou...n."|
->>> Flow 5 (client to server)
-00000000  17 03 03 00 13 9b cd 58  dd 0c e0 fa bd 3b 5e 25  |.......X.....;^%|
-00000010  e4 9a 24 33 39 f0 b7 bf                           |..$39...|
+00000000  14 03 03 00 01 01 17 03  03 00 45 f6 a2 b0 dd 25  |..........E....%|
+00000010  6e 65 f4 c5 74 2b 60 e0  14 12 92 b3 fc 8c 18 06  |ne..t+`.........|
+00000020  fb 5d c4 de d9 41 df 39  47 b1 d0 2f 3c 4e 90 fb  |.]...A.9G../<N..|
+00000030  d3 8f 32 93 2c 7e 66 5d  a2 96 91 91 df ec a5 6f  |..2.,~f].......o|
+00000040  2e 4a 7b b4 1b 77 1e 16  76 66 c3 80 c8 d9 b0 eb  |.J{..w..vf......|
+00000050  17 03 03 00 17 8e d8 13  8e af f8 41 d2 63 19 3b  |...........A.c.;|
+00000060  e0 a8 0a 73 6c dd 76 31  b8 51 17 bc 17 03 03 00  |...sl.v1.Q......|
+00000070  13 1a ee 55 37 e1 4c d3  fc 81 4d 37 84 e6 88 52  |...U7.L...M7...R|
+00000080  65 b5 02 78                                       |e..x|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ALPN b/src/crypto/tls/testdata/Client-TLSv13-ALPN
index f46efbf287..77b0342e43 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ALPN
+++ b/src/crypto/tls/testdata/Client-TLSv13-ALPN
@@ -18,108 +18,76 @@
 00000100  ac 5f bb 29 07 30 ff f6  84 af c4 cf c2 ed 90 99  |._.).0..........|
 00000110  5f 58 cb 3b 74                                    |_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 ad d5 7d b8 f6  |....z...v....}..|
-00000010  04 29 51 7d 2c e9 69 ed  5d e5 3a 92 bc ad f8 93  |.)Q},.i.].:.....|
-00000020  dc e7 93 bd 0f 2a 3f 46  fd fd 1d 20 00 00 00 00  |.....*?F... ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 8b 65 4e 74 f0  |....z...v...eNt.|
+00000010  c4 05 7a a1 58 a7 fd b0  55 9e d2 15 67 1f 19 f9  |..z.X...U...g...|
+00000020  25 e1 3e 89 4f a6 79 90  95 5a 8c 20 00 00 00 00  |%.>.O.y..Z. ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 01 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 fe  |..+.....3.$... .|
-00000060  4b d7 8f 01 60 9e 75 40  11 72 06 64 f7 66 62 a7  |K...`.u@.r.d.fb.|
-00000070  49 81 d2 f6 65 59 10 4f  2c 68 d8 4c f0 f0 60 14  |I...eY.O,h.L..`.|
-00000080  03 03 00 01 01 17 03 03  00 24 e3 64 26 bd f9 1c  |.........$.d&...|
-00000090  ce 83 56 88 a0 a5 eb e7  a5 c5 13 53 2d 61 69 8a  |..V........S-ai.|
-000000a0  74 32 46 dc fa b2 63 58  f2 31 6a 21 8f 18 17 03  |t2F...cX.1j!....|
-000000b0  03 02 6d 5f 4f bf d0 9d  00 9d 2e c6 86 0b d5 37  |..m_O..........7|
-000000c0  01 0b a5 ac d5 ee 9c 91  87 98 89 c9 bd 2f b3 b4  |............./..|
-000000d0  10 7e 40 eb bb 6b 9e d6  cc 0b 1d 3a 18 06 a2 a5  |.~@..k.....:....|
-000000e0  1d d4 53 82 a7 3b 28 3f  3f d5 0e 23 5a f7 ff e4  |..S..;(??..#Z...|
-000000f0  3d a4 66 95 a8 d0 18 52  2c 94 c4 84 89 0f d1 05  |=.f....R,.......|
-00000100  a2 34 95 da 7b 65 e2 9c  62 b1 11 cc 15 78 58 8f  |.4..{e..b....xX.|
-00000110  43 d8 d0 04 9b db bf 06  34 d6 33 3d 55 0b 53 39  |C.......4.3=U.S9|
-00000120  9f 96 8f 67 34 6a f6 13  09 9b ae 61 b8 c5 cf 65  |...g4j.....a...e|
-00000130  f1 b5 43 bb ee fb 9c d4  2d b1 7e 3a 59 4b 56 45  |..C.....-.~:YKVE|
-00000140  d4 1f 75 b7 07 35 18 e7  bd ad b7 36 2f 63 0f 67  |..u..5.....6/c.g|
-00000150  68 3f 42 4c 53 22 bc b9  41 2c e0 a3 95 54 6b 4d  |h?BLS"..A,...TkM|
-00000160  b9 e4 00 3f 89 11 53 7e  cc 4d 8c 72 d7 d0 fe bf  |...?..S~.M.r....|
-00000170  20 81 20 d3 d3 a1 e6 c8  ba 5b 49 d7 96 9e 8f fb  | . ......[I.....|
-00000180  f8 30 d6 7e e5 4a 3b e6  a6 0d 0a 42 80 68 cf 06  |.0.~.J;....B.h..|
-00000190  19 d7 86 63 8e 23 c0 37  71 f6 bc 8b bd ab 62 a5  |...c.#.7q.....b.|
-000001a0  45 f4 37 ea 50 cc 82 c9  f4 28 11 1c 1b 90 9d f7  |E.7.P....(......|
-000001b0  67 dc 58 d2 10 59 49 26  17 68 50 a9 6c d9 e6 46  |g.X..YI&.hP.l..F|
-000001c0  c5 e8 b3 ba 01 a9 ff 33  5e 2c 7c d3 eb d2 35 56  |.......3^,|...5V|
-000001d0  b2 21 37 94 40 c7 15 d6  6f 29 ee 02 c9 98 e7 04  |.!7.@...o)......|
-000001e0  0c 56 e9 f9 21 91 e7 75  7c 8d a1 50 28 b3 da 76  |.V..!..u|..P(..v|
-000001f0  45 af 22 80 77 17 2e 96  d8 5e 05 0f 63 21 c9 32  |E.".w....^..c!.2|
-00000200  2b c0 69 e9 8a 07 40 0c  21 73 1f 7d e8 b1 11 45  |+.i...@.!s.}...E|
-00000210  37 40 c8 26 66 98 e9 0a  95 ed 08 26 12 f3 79 17  |7@.&f......&..y.|
-00000220  6d d8 92 11 4f c7 ee db  5d 77 98 1a 31 cd cc db  |m...O...]w..1...|
-00000230  1d 96 e8 b5 a1 ba be 0f  b1 84 4a a0 55 c5 41 78  |..........J.U.Ax|
-00000240  8d 96 ca a0 4e 4d 1e ed  34 54 2b 95 08 1f 00 a6  |....NM..4T+.....|
-00000250  a8 d7 35 66 0a ad 2a ac  c4 4b 5d 60 b8 89 1f af  |..5f..*..K]`....|
-00000260  65 c3 a6 10 4b 4c c1 d6  07 1b 3a dc 7c 00 3e a1  |e...KL....:.|.>.|
-00000270  06 8e ac f6 4c 4f d4 88  31 3e df 5b 6b 95 19 ed  |....LO..1>.[k...|
-00000280  6e b5 d1 0a 5e bc 5e 69  3f 5a fc ed 71 14 66 c4  |n...^.^i?Z..q.f.|
-00000290  a3 ef 82 d4 2b bc 7c 5a  34 20 33 77 e4 48 4b 82  |....+.|Z4 3w.HK.|
-000002a0  66 51 12 ac cf 9b e5 5f  17 34 2f a5 47 fd ab 53  |fQ....._.4/.G..S|
-000002b0  85 8e d2 d5 c7 b2 58 a5  d2 fa eb d8 59 f6 2a bd  |......X.....Y.*.|
-000002c0  37 fc 68 65 75 e4 5f be  a7 d8 6a da 41 36 6a 33  |7.heu._...j.A6j3|
-000002d0  f1 8d 6a 9d f0 23 73 6a  33 42 52 6f 41 80 a3 40  |..j..#sj3BRoA..@|
-000002e0  48 65 16 d9 23 dd 66 93  eb c5 d3 84 10 8b 0b ec  |He..#.f.........|
-000002f0  d8 c1 c3 3f 08 07 18 ed  d9 8e 1d a3 85 d1 70 ef  |...?..........p.|
-00000300  cd c1 90 e1 80 70 94 9d  05 41 3d 4e 8f 6b 91 d7  |.....p...A=N.k..|
-00000310  5d b4 9c 72 c0 de 2d bb  f0 d7 dd 29 c4 4e 82 56  |]..r..-....).N.V|
-00000320  17 03 03 00 99 ed 9c 42  76 9b 6c 6d 4f db 8d ca  |.......Bv.lmO...|
-00000330  4f a9 6b de 10 6e 5e 9a  1b b8 5a bd 35 0f a6 0a  |O.k..n^...Z.5...|
-00000340  cd bd 9d 60 ac 4b c9 35  4e 2a 70 5f 13 07 3f 4a  |...`.K.5N*p_..?J|
-00000350  bd 3c 9e 85 ef 6d cd 4e  91 c0 83 3e bc ac c7 03  |.<...m.N...>....|
-00000360  fa 9d 3b 11 28 de d1 8e  de c5 d3 3f cf cc ff 7b  |..;.(......?...{|
-00000370  63 27 51 4c ea 11 24 43  c5 24 20 69 f3 71 9f 1c  |c'QL..$C.$ i.q..|
-00000380  c5 a8 6f 4a 10 1b 4f 20  6c fa bc ab 79 b3 c7 15  |..oJ..O l...y...|
-00000390  de 47 4d 74 19 65 49 38  31 15 cd c8 51 68 fa 74  |.GMt.eI81...Qh.t|
-000003a0  c8 2f cf 34 17 35 0a 29  0c 45 c7 8a 99 1e 3e 18  |./.4.5.).E....>.|
-000003b0  29 74 b6 be 9d ea b1 ab  f4 0c d7 7f f3 16 17 03  |)t..............|
-000003c0  03 00 35 e6 eb 90 3b 27  87 1b d4 7b a6 77 95 4a  |..5...;'...{.w.J|
-000003d0  2f b7 52 59 c7 4c 44 75  80 ca a3 04 ea 1a ba df  |/.RY.LDu........|
-000003e0  69 4c 42 97 a5 ad a8 67  4d c3 7d a7 83 33 8a c5  |iLB....gM.}..3..|
-000003f0  ec af 2b c9 bc 32 91 8b                           |..+..2..|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 a5  |..+.....3.$... .|
+00000060  e3 ac d0 3c 26 f8 66 41  ac b5 47 6f 63 a0 8f 0a  |...<&.fA..Goc...|
+00000070  6f 79 62 23 15 01 d0 57  5d 66 9c 09 50 c5 45 14  |oyb#...W]f..P.E.|
+00000080  03 03 00 01 01 17 03 03  00 24 7d dc b2 50 38 8e  |.........$}..P8.|
+00000090  15 52 73 25 90 d3 d3 f2  19 da 76 ae 64 42 29 eb  |.Rs%......v.dB).|
+000000a0  21 1b 7d b1 d9 04 94 ac  71 b9 b3 e1 d7 59 17 03  |!.}.....q....Y..|
+000000b0  03 02 6d cb 4e 30 d0 df  41 b8 1a 76 1d e2 a2 14  |..m.N0..A..v....|
+000000c0  24 ec e4 b8 e4 5b 98 49  ed 4e 48 98 3d a7 89 d4  |$....[.I.NH.=...|
+000000d0  d1 35 2f d4 12 dc 0b c3  3f e7 0c df 11 20 41 fb  |.5/.....?.... A.|
+000000e0  5c 24 62 82 26 ad 28 25  59 c0 c0 81 41 9d 80 b7  |\$b.&.(%Y...A...|
+000000f0  db cd 41 bb 27 66 ba 55  e6 2f 52 5d 71 d4 77 6a  |..A.'f.U./R]q.wj|
+00000100  5c 5d 72 34 e6 83 9d c6  24 d1 be 3b 99 90 9b 22  |\]r4....$..;..."|
+00000110  7f d8 81 39 d4 7b a8 f9  d7 61 82 a1 72 f9 27 0b  |...9.{...a..r.'.|
+00000120  b8 6a 5c 72 bd 8f 84 34  c6 d0 c8 1a b9 27 d6 7b  |.j\r...4.....'.{|
+00000130  12 20 37 b7 64 85 19 7e  b4 37 46 df 51 77 23 be  |. 7.d..~.7F.Qw#.|
+00000140  c4 7a e4 7e 37 3b 53 3e  3b 86 8f 22 31 28 4b 8f  |.z.~7;S>;.."1(K.|
+00000150  89 0d dc 8d 67 37 53 9d  38 f2 5f 99 2c f4 76 64  |....g7S.8._.,.vd|
+00000160  87 e4 ce b7 4f d0 83 99  b2 55 8c 38 8c d0 89 d1  |....O....U.8....|
+00000170  2f 91 e8 ae ec b1 a6 29  65 3a 8f af 69 e0 48 00  |/......)e:..i.H.|
+00000180  db 3e 30 bd 7f 4b 82 56  cf f9 5b 5e 74 d7 d5 4b  |.>0..K.V..[^t..K|
+00000190  47 4f 22 17 53 fc e6 98  a4 5a 25 ca 7d ca 39 e9  |GO".S....Z%.}.9.|
+000001a0  fe 11 f5 ca 91 e1 25 3c  6d f2 b3 d0 9f ee 88 d2  |......%<m.......|
+000001b0  dd a5 9f 7c a8 33 59 20  62 fd 4e d6 98 4b ef af  |...|.3Y b.N..K..|
+000001c0  a6 fa 79 f5 26 90 fe 32  0a 6a e4 40 b9 e5 4d 1a  |..y.&..2.j.@..M.|
+000001d0  1f 02 49 4b 1b 6b 31 53  3d 0e 04 98 17 6e 1e 4a  |..IK.k1S=....n.J|
+000001e0  a3 8d ba 0e 8f 33 f6 23  41 5f f8 aa 1f 57 b1 7b  |.....3.#A_...W.{|
+000001f0  a2 fb c6 7f da b4 56 cf  d3 5e 78 de 3c 15 c5 6c  |......V..^x.<..l|
+00000200  62 ef 46 c4 a2 c0 fd a6  86 91 fb f2 98 57 cc 82  |b.F..........W..|
+00000210  7e e7 88 1b f4 65 eb df  2a 7c 7a 81 95 e8 3c 0d  |~....e..*|z...<.|
+00000220  c1 85 8f 55 49 c0 50 d0  c8 5f e7 32 7c 8c c2 ae  |...UI.P.._.2|...|
+00000230  8c af 3f 4c 4f 23 f6 80  0b c1 c3 1c a2 50 6b 37  |..?LO#.......Pk7|
+00000240  38 53 59 66 9c 5a d3 6d  39 59 99 14 79 d5 17 e3  |8SYf.Z.m9Y..y...|
+00000250  89 73 9e fe ed 43 2c 4a  2f 55 c7 c6 9e cf 82 64  |.s...C,J/U.....d|
+00000260  f5 5e 90 88 67 05 7a 00  b1 88 87 9c b2 51 61 1c  |.^..g.z......Qa.|
+00000270  c2 8a ea 9f b1 07 0c 17  ed b6 6e cc 4d 14 04 91  |..........n.M...|
+00000280  65 00 3b 8f ae d0 14 64  63 92 bd 3b 14 9c 1d 40  |e.;....dc..;...@|
+00000290  67 01 b1 38 26 86 4d e6  f3 20 ed f5 63 17 fc d0  |g..8&.M.. ..c...|
+000002a0  fb ad 5c 17 c8 d5 18 53  8b 89 70 13 2f 83 6a 3f  |..\....S..p./.j?|
+000002b0  4c 57 be 71 43 1d 9f bf  eb 30 7e de 7f 17 78 f1  |LW.qC....0~...x.|
+000002c0  af 69 13 9b f3 4a e6 69  4e 30 dc 99 af be 6f ee  |.i...J.iN0....o.|
+000002d0  1d d5 39 b4 19 29 ed 5c  58 bc 4a 08 7b 34 90 21  |..9..).\X.J.{4.!|
+000002e0  a5 ae 74 4c 17 95 79 8b  9c ee 47 99 32 f9 7d f2  |..tL..y...G.2.}.|
+000002f0  98 93 ec 12 52 7d 36 cc  a7 ca a2 cd fc ce 12 0e  |....R}6.........|
+00000300  32 e7 28 69 ce d4 a7 19  56 9f 90 1a d0 af f1 ee  |2.(i....V.......|
+00000310  77 a4 29 45 cb 2c ff 1a  90 9d 98 73 65 2a 82 77  |w.)E.,.....se*.w|
+00000320  17 03 03 00 99 76 fe 3b  d7 a3 d2 ec a0 28 bd ed  |.....v.;.....(..|
+00000330  64 41 ac 1c d0 60 79 29  26 f9 ad a1 2d 79 b6 f0  |dA...`y)&...-y..|
+00000340  cc de 8f c3 92 4a 1e 02  76 7a b4 86 d3 64 b3 a6  |.....J..vz...d..|
+00000350  2d bb d9 92 1e 12 1d e4  96 64 3c 41 7f 11 28 51  |-........d<A..(Q|
+00000360  69 83 64 45 fb a6 2c 34  97 e8 4b e8 48 92 b0 de  |i.dE..,4..K.H...|
+00000370  a0 37 8e fa d8 88 29 4c  8e e4 7e 1e d2 c1 b8 f2  |.7....)L..~.....|
+00000380  d3 5c 2f 09 9d e2 0b 4d  64 25 52 dc 77 d2 a4 fc  |.\/....Md%R.w...|
+00000390  c3 de 83 3c 04 19 f0 d9  d6 40 bb f1 8b c7 40 b3  |...<.....@....@.|
+000003a0  a9 62 99 4c 64 96 a4 67  a0 6b 7c 09 b3 10 97 e1  |.b.Ld..g.k|.....|
+000003b0  b5 83 9e 7e b4 97 bd b7  f9 70 48 2b aa f6 17 03  |...~.....pH+....|
+000003c0  03 00 35 a6 fc 3f d4 90  93 91 02 e8 0a a6 c1 6f  |..5..?.........o|
+000003d0  fa ee e2 6a 41 8d fd ac  53 ae 83 73 e1 d1 17 de  |...jA...S..s....|
+000003e0  36 5d db c6 06 98 f9 23  db d9 8a 35 c1 9b bc a5  |6].....#...5....|
+000003f0  f8 a8 8f 70 e2 c8 4e 22                           |...p..N"|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 0c 04 d4 20 a9  |..........5... .|
-00000010  67 8e 45 d1 59 75 b8 1d  89 da a3 97 ae 3f f7 a4  |g.E.Yu.......?..|
-00000020  64 3f d4 e2 05 45 da 2e  e7 a0 c3 32 a4 19 40 b6  |d?...E.....2..@.|
-00000030  af 8f cf 2c fe d2 14 88  18 cf 65 06 e3 91 a5 de  |...,......e.....|
-00000040  17 03 03 00 17 f9 61 2b  d5 c3 68 88 6f d8 86 23  |......a+..h.o..#|
-00000050  f1 7d 58 5c 75 8c 70 24  5b 4f de 74              |.}X\u.p$[O.t|
->>> Flow 4 (server to client)
-00000000  17 03 03 00 ea 33 85 9d  72 d6 99 11 8b 5d b1 a2  |.....3..r....]..|
-00000010  e8 b6 7c 00 b6 0b 4f cd  08 89 51 a5 86 4e db 28  |..|...O...Q..N.(|
-00000020  67 50 03 f7 a6 6e 02 0a  3a 3b 7c 35 74 cc 87 d8  |gP...n..:;|5t...|
-00000030  eb da 9a 07 9a 66 ce 1d  4d eb 62 51 fb 59 6f 45  |.....f..M.bQ.YoE|
-00000040  14 18 40 5b 8d e6 35 17  fe dd 8d d3 56 3d 81 18  |..@[..5.....V=..|
-00000050  83 a8 af 95 90 0a cf 6a  76 d0 a6 07 7e 1c 71 1c  |.......jv...~.q.|
-00000060  e6 c5 2f ce 47 b7 73 6d  8b 06 3a fd e8 ce 7e 34  |../.G.sm..:...~4|
-00000070  7e 6c 5c ae d3 8d 3a c0  61 b6 f9 73 07 7b 4a 3f  |~l\...:.a..s.{J?|
-00000080  0d b9 fc f2 5e 70 13 09  c1 a6 16 04 2e 13 db 12  |....^p..........|
-00000090  ab 1a 10 df c5 53 00 f8  58 46 63 86 e1 47 8a 25  |.....S..XFc..G.%|
-000000a0  88 95 d4 53 dd 8c df ae  38 15 86 70 ad 8f c0 c7  |...S....8..p....|
-000000b0  a6 ba 2a ac 4b c3 54 aa  00 41 43 1c 2e 30 47 a5  |..*.K.T..AC..0G.|
-000000c0  bf 6c e5 c2 78 67 b4 07  3e fb 11 b5 87 8d 51 92  |.l..xg..>.....Q.|
-000000d0  47 81 6b 8e 2f f9 5d 4e  66 25 5a b5 3b 92 9a d0  |G.k./.]Nf%Z.;...|
-000000e0  e0 b6 63 28 d2 80 ba c7  97 95 1a ef d9 1c c8 17  |..c(............|
-000000f0  03 03 00 ea 6a 98 5d 82  1c f0 42 0a 87 39 0c 0c  |....j.]...B..9..|
-00000100  cd e7 0b 16 1b 93 0f 1f  ce 03 1a 1c c1 64 89 a2  |.............d..|
-00000110  bb b3 73 33 0e 1b b5 7f  6f 53 73 86 cb 37 57 1a  |..s3....oSs..7W.|
-00000120  8e 1d 59 c8 5c 81 29 19  1b ca 8e 42 31 34 06 e7  |..Y.\.)....B14..|
-00000130  43 a9 4c cd 91 45 4d 1e  48 31 57 50 10 fd 9e aa  |C.L..EM.H1WP....|
-00000140  b6 f4 14 a3 ff b2 c3 47  3e f2 3e 5a b9 5c 7a c6  |.......G>.>Z.\z.|
-00000150  26 1a 91 7e c3 3a e3 7e  a4 38 cd 83 89 85 8f f2  |&..~.:.~.8......|
-00000160  fa c1 e3 1e 53 3d bd 54  ed 21 74 fb ff f0 d9 e9  |....S=.T.!t.....|
-00000170  d5 b7 46 1c 6e 1d 9c 79  5e a7 32 97 79 8f 69 70  |..F.n..y^.2.y.ip|
-00000180  e7 5c ad 7f 58 1a 0b af  16 dc fe 35 01 e3 bf 42  |.\..X......5...B|
-00000190  be 78 6f 39 d0 a9 c8 6c  48 bd b0 c8 fb 5c f7 1d  |.xo9...lH....\..|
-000001a0  1a 3f 79 7a d9 7c 07 ab  11 1b 0b bb 30 88 bf 59  |.?yz.|......0..Y|
-000001b0  36 79 5e 0b 23 2e 70 4e  84 f5 ab 6d b3 5d f6 ff  |6y^.#.pN...m.]..|
-000001c0  40 09 66 f2 89 af 58 fb  0c 29 fb 7d f6 be 97 b6  |@.f...X..).}....|
-000001d0  1b 84 53 b5 a2 f2 2b a6  d5 f4 c9 16 70 b8        |..S...+.....p.|
->>> Flow 5 (client to server)
-00000000  17 03 03 00 13 3c 30 88  da 6f 10 92 66 99 de 69  |.....<0..o..f..i|
-00000010  ea 74 e4 a2 7a d3 b8 d4                           |.t..z...|
+00000000  14 03 03 00 01 01 17 03  03 00 35 f6 6b cb 4a 37  |..........5.k.J7|
+00000010  3e e2 61 7e 5b ac c5 25  cc 54 a2 6d 4e 7c 37 19  |>.a~[..%.T.mN|7.|
+00000020  ea 21 af df 7b dc 04 2d  db 84 ad 06 04 bd 50 f5  |.!..{..-......P.|
+00000030  05 9b 19 01 37 22 d2 6f  06 c2 63 dd 95 e6 ef 45  |....7".o..c....E|
+00000040  17 03 03 00 17 6d 03 e7  38 f9 a4 3c a7 c2 ee 8d  |.....m..8..<....|
+00000050  07 49 bd e6 e4 be 3f a3  ec 64 6c 3a 17 03 03 00  |.I....?..dl:....|
+00000060  13 cc a9 19 b1 03 56 99  c1 4c d0 f5 fd 3b e2 dd  |......V..L...;..|
+00000070  0e ef a0 20                                       |... |
diff --git a/src/crypto/tls/testdata/Client-TLSv13-CHACHA20-SHA256 b/src/crypto/tls/testdata/Client-TLSv13-CHACHA20-SHA256
index 8f606cd56f..98c3c52170 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-CHACHA20-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv13-CHACHA20-SHA256
@@ -16,107 +16,75 @@
 000000e0  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
 000000f0  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 8d 7b 1d 2a 66  |....z...v...{.*f|
-00000010  8f 54 f0 d0 59 a6 ef ba  aa 1a ba 98 bf 02 45 f5  |.T..Y.........E.|
-00000020  56 69 80 67 e4 72 f4 d7  56 a1 ec 20 00 00 00 00  |Vi.g.r..V.. ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 49 41 93 3b 12  |....z...v..IA.;.|
+00000010  17 ef c7 e6 29 09 70 0e  6b df f7 3d bb 01 9d 27  |....).p.k..=...'|
+00000020  cb 0d 97 6b ce 4c 49 60  3e ff 18 20 00 00 00 00  |...k.LI`>.. ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 c8  |..+.....3.$... .|
-00000060  b8 1d 9b 00 85 3c 1c 1d  1f 5e 88 e8 ea 38 1d 63  |.....<...^...8.c|
-00000070  f4 99 b0 89 a5 c4 4e 7d  15 49 ca 27 05 26 10 14  |......N}.I.'.&..|
-00000080  03 03 00 01 01 17 03 03  00 17 07 34 7c 5e 3f 52  |...........4|^?R|
-00000090  c4 42 ed d9 50 e2 a6 cc  6e 0e 93 27 bf c1 97 d6  |.B..P...n..'....|
-000000a0  78 17 03 03 02 6d 1c 60  91 f4 1b fd 8f 9b 89 8b  |x....m.`........|
-000000b0  65 50 19 c9 41 25 9e 35  8d 75 aa ec 5f 88 bf 6c  |eP..A%.5.u.._..l|
-000000c0  85 33 02 c3 01 6d 3c 5c  86 aa 12 22 35 49 e0 81  |.3...m<\..."5I..|
-000000d0  4b e3 f2 ec 75 12 95 ed  b4 aa f3 0e 7d bf e6 a8  |K...u.......}...|
-000000e0  5d a3 6c 82 f7 f0 1e f7  e7 e8 73 af 14 77 24 ea  |].l.......s..w$.|
-000000f0  5f bc 25 88 95 93 bb 61  84 f9 36 95 b9 12 31 ff  |_.%....a..6...1.|
-00000100  f8 19 f0 76 d7 4a 1f a6  77 33 75 82 70 a7 98 71  |...v.J..w3u.p..q|
-00000110  5b dc c0 d6 9c 85 c2 41  e3 d0 32 b1 e5 c0 42 8c  |[......A..2...B.|
-00000120  e8 32 38 ad 03 3a db 46  66 0c 63 0f 65 f6 ed 66  |.28..:.Ff.c.e..f|
-00000130  34 ec c6 23 db e3 25 3e  ec eb 44 21 76 7c 35 0f  |4..#..%>..D!v|5.|
-00000140  f2 2c 0f 92 9c db 8f 3e  de 46 e8 af f8 6e c4 82  |.,.....>.F...n..|
-00000150  91 5e a3 c2 de f7 73 3c  1c e2 84 42 02 a8 bf fb  |.^....s<...B....|
-00000160  04 96 a4 a7 f4 4c c2 d7  1e 1e 6a e2 82 68 58 07  |.....L....j..hX.|
-00000170  a0 f4 e9 91 c1 bc f7 d6  d7 d7 63 6a e7 a3 9c fa  |..........cj....|
-00000180  69 57 28 e9 db 4e d1 4d  65 9a 05 41 a9 71 47 97  |iW(..N.Me..A.qG.|
-00000190  17 0b 95 79 8e 60 90 ee  4c 75 e0 c4 10 c8 21 e7  |...y.`..Lu....!.|
-000001a0  ab 62 ab a9 e7 25 86 80  93 76 f7 a2 2a c4 d2 9f  |.b...%...v..*...|
-000001b0  59 2a 15 7a 88 c0 8d 57  01 ab f2 8e 40 5d b5 49  |Y*.z...W....@].I|
-000001c0  7f d4 1e 7f 4e ae ad bd  8c bc 2d 5f 91 3f a7 6c  |....N.....-_.?.l|
-000001d0  ce 0a 8c c7 53 66 4e 28  31 16 ab 05 dc 78 f6 f4  |....SfN(1....x..|
-000001e0  5d b3 eb 38 e1 c1 53 11  11 97 69 4a 86 14 fa 34  |]..8..S...iJ...4|
-000001f0  c7 ab 6d 2d 31 17 bf a7  d8 1a 9f bf 2f 4c c9 50  |..m-1......./L.P|
-00000200  5e 21 30 b1 98 ac f3 46  a2 d9 4b 67 e7 44 cd 0c  |^!0....F..Kg.D..|
-00000210  77 2b 72 1c 6d e6 65 1b  28 6d d1 05 bb a6 15 54  |w+r.m.e.(m.....T|
-00000220  5d 93 22 e0 e4 e8 3e 99  8c 18 18 27 a7 18 c2 0c  |]."...>....'....|
-00000230  6c fb 16 b6 ab f1 91 f1  ad 84 b3 53 30 27 b8 29  |l..........S0'.)|
-00000240  82 c8 28 06 19 c8 44 3f  45 10 67 92 6a ff 94 47  |..(...D?E.g.j..G|
-00000250  49 b2 fd 08 03 15 bd f7  c9 34 cc ad 84 9c 6d 08  |I........4....m.|
-00000260  15 e8 df 10 3c 7d 28 5f  9d 77 07 49 47 2f ae 61  |....<}(_.w.IG/.a|
-00000270  af 3b 8f 19 63 f7 b3 29  3c 45 4e 0d 9d 03 97 74  |.;..c..)<EN....t|
-00000280  fc d0 bc 99 24 f5 32 af  92 a9 65 4f 06 cb 96 1d  |....$.2...eO....|
-00000290  42 46 2c 8c 77 47 99 62  6b 04 2d df 3c 2e 2a 59  |BF,.wG.bk.-.<.*Y|
-000002a0  1b 58 e5 b9 64 5d e9 34  5a 76 40 2f 50 f3 04 0e  |.X..d].4Zv@/P...|
-000002b0  b3 98 e9 fe 8e dd 3a db  e7 ff fa 10 60 17 ab 18  |......:.....`...|
-000002c0  40 bd 5b 10 48 b8 ae 98  79 f4 6a 8d 71 85 25 f3  |@.[.H...y.j.q.%.|
-000002d0  74 de 84 fe a4 ed 24 67  c2 74 37 61 be 4e 06 74  |t.....$g.t7a.N.t|
-000002e0  86 b8 4d e7 6f 90 d3 20  6c 61 02 62 45 0d 57 70  |..M.o.. la.bE.Wp|
-000002f0  3e f1 37 c9 f6 8c 45 29  f7 56 eb e3 dd 5f 56 47  |>.7...E).V..._VG|
-00000300  c2 4f cb ca 7c 86 8e ed  72 3d 3f e9 bc 38 a7 c1  |.O..|...r=?..8..|
-00000310  59 8b a2 17 03 03 00 99  dc 71 24 a3 c4 ab 62 4c  |Y........q$...bL|
-00000320  26 c3 7c 73 d3 e9 fd 4b  82 95 30 b8 3f 87 7e bf  |&.|s...K..0.?.~.|
-00000330  c1 60 40 5f 6c 7f 8d db  0e 4e 91 d4 b4 02 66 ef  |.`@_l....N....f.|
-00000340  b8 b1 a8 af 42 a3 7d 5c  6a 97 81 f6 cb c8 d2 8b  |....B.}\j.......|
-00000350  7e 1d 09 e5 f1 a4 aa 5e  c9 b6 f4 b7 43 2f 21 ba  |~......^....C/!.|
-00000360  90 d6 74 ab 8e 03 8b 54  79 57 b6 ae 77 a0 87 96  |..t....TyW..w...|
-00000370  42 0f 95 66 74 6c 1b 0d  ea 66 5c 62 57 32 b7 dd  |B..ftl...f\bW2..|
-00000380  03 65 b6 ad af 15 20 52  39 af 33 e6 08 5c 38 dd  |.e.... R9.3..\8.|
-00000390  40 42 c1 4c f6 48 0b 59  96 a0 04 c3 09 b6 bf ac  |@B.L.H.Y........|
-000003a0  7a 9d 96 8a ce 3f 7f 68  00 9e 1c 9a db e3 25 56  |z....?.h......%V|
-000003b0  54 17 03 03 00 35 55 48  0b d0 5c c0 8c a4 5e 1e  |T....5UH..\...^.|
-000003c0  30 64 b7 b5 f7 d0 0d 50  64 a8 f1 79 36 9a 0f 00  |0d.....Pd..y6...|
-000003d0  ac cb 25 c7 62 5f c1 05  e9 c2 ee 7a 87 00 19 fc  |..%.b_.....z....|
-000003e0  5b fd 4c 0a 73 ec dc f4  51 66 bd                 |[.L.s...Qf.|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 a6  |..+.....3.$... .|
+00000060  16 ca 24 6e e9 b1 38 c9  3c 45 0e 35 98 32 c5 7c  |..$n..8.<E.5.2.||
+00000070  87 14 3f ec ae 4d 4a 00  13 40 e6 81 9d 4f 78 14  |..?..MJ..@...Ox.|
+00000080  03 03 00 01 01 17 03 03  00 17 61 33 7b cd 54 2c  |..........a3{.T,|
+00000090  a6 a4 0d 2d b8 cf fe 0f  75 1d af cf f3 81 9a 7c  |...-....u......||
+000000a0  8c 17 03 03 02 6d 64 52  27 5a 66 dd c4 51 24 a3  |.....mdR'Zf..Q$.|
+000000b0  fb 72 7c 68 ed 79 1c 3d  4d ed a0 18 c9 9e c1 0c  |.r|h.y.=M.......|
+000000c0  3c 16 20 18 f5 ce 59 fd  bb fa fd 12 a5 de 4a 58  |<. ...Y.......JX|
+000000d0  d0 59 6c d3 9b 1f e9 f0  61 af aa 93 57 07 8d e0  |.Yl.....a...W...|
+000000e0  be d3 3c 9a 01 1e 70 50  b3 30 f5 e5 e2 0b ef b5  |..<...pP.0......|
+000000f0  a6 dc 6a 3c 17 1c 8a 73  db 44 38 11 59 be 87 54  |..j<...s.D8.Y..T|
+00000100  c5 43 4f da c0 93 16 c9  ef 38 22 b8 32 2b e8 22  |.CO......8".2+."|
+00000110  b7 c5 d3 94 70 5e b6 48  89 c0 2b cd 5b 59 f5 6c  |....p^.H..+.[Y.l|
+00000120  18 0e 65 6e 23 9e a4 b1  12 38 2b b1 5f 9c c9 4f  |..en#....8+._..O|
+00000130  7d 32 d9 50 97 dc 7a 26  e4 ee 00 f9 ed b8 1a 5e  |}2.P..z&.......^|
+00000140  8a fe d3 09 3d 67 68 c6  58 e1 f8 3e b3 e0 55 3c  |....=gh.X..>..U<|
+00000150  00 77 9a 72 ba fc 13 ad  7a dc 34 0f aa 26 f9 c6  |.w.r....z.4..&..|
+00000160  fe b7 ef 0f e8 d7 46 d0  a7 ee e8 39 4d c1 13 a2  |......F....9M...|
+00000170  5c 00 e2 3e 47 08 71 b7  53 94 38 f6 31 3a 60 a5  |\..>G.q.S.8.1:`.|
+00000180  57 82 4c bc c0 f7 9b c3  4e 00 5e 5e 40 ef ae 61  |W.L.....N.^^@..a|
+00000190  09 37 38 40 b7 93 12 0a  7c 02 22 b9 39 a2 43 e3  |.78@....|.".9.C.|
+000001a0  f3 09 36 a7 2a c9 2b 35  fc 2c fc 1c 82 d0 3f 03  |..6.*.+5.,....?.|
+000001b0  a9 fc bc 53 79 23 5a ce  2d 07 80 5c 2c aa 34 52  |...Sy#Z.-..\,.4R|
+000001c0  9d 71 2d 16 4a f0 09 e6  95 94 2b dd bf d5 9c 84  |.q-.J.....+.....|
+000001d0  79 fc 41 15 a6 68 81 23  7e dc 83 55 b0 a4 a4 1c  |y.A..h.#~..U....|
+000001e0  4e 1e 4d 78 6d 62 45 59  1d bb c3 98 d5 0b 3a 8c  |N.MxmbEY......:.|
+000001f0  f1 98 49 6b 0f 64 29 d5  38 ad 6a ea 8b 34 29 99  |..Ik.d).8.j..4).|
+00000200  c0 04 ce 5a 4f 74 e8 ec  bb 0a a5 cd 23 6d 31 7a  |...ZOt......#m1z|
+00000210  d6 6e 1a 74 53 57 59 76  e9 e7 b2 5d 9f 5d 9a 53  |.n.tSWYv...].].S|
+00000220  b0 e6 d1 ad ba 43 b6 40  65 65 3a 04 35 12 e1 f7  |.....C.@ee:.5...|
+00000230  0e 91 f6 0c 1e 74 65 e3  90 ed e6 ec fd 88 99 e8  |.....te.........|
+00000240  20 64 90 33 b9 a9 d8 a2  f0 d7 e8 e0 cf 8d d4 2a  | d.3...........*|
+00000250  91 12 44 28 3b 99 69 93  aa 3e b2 3b 6a f0 dc 0a  |..D(;.i..>.;j...|
+00000260  8b 2e 7c d9 c0 c7 b7 d6  f2 07 69 81 97 7b d9 6a  |..|.......i..{.j|
+00000270  56 c3 6a e5 d5 6a 06 e7  60 b2 72 1c 4f cc 3f 6e  |V.j..j..`.r.O.?n|
+00000280  e9 fe 94 79 49 36 a6 5f  6d bf b2 87 a1 59 a3 c4  |...yI6._m....Y..|
+00000290  39 ad 9a ea 57 a5 69 47  f0 9b 60 4a a6 45 e8 70  |9...W.iG..`J.E.p|
+000002a0  6c 6b 1b 17 8a 4e 5e 56  89 40 de 91 c3 8a 05 06  |lk...N^V.@......|
+000002b0  57 9e 68 87 1e 00 c8 08  93 1c f1 57 0f 91 dd 32  |W.h........W...2|
+000002c0  b7 e8 96 99 e3 90 44 5e  7a 68 d8 e0 55 67 80 a0  |......D^zh..Ug..|
+000002d0  e3 bd d5 f7 01 f4 30 58  a7 b4 62 d7 7b 9c 5b 9b  |......0X..b.{.[.|
+000002e0  62 20 b6 01 25 1b ff 6f  b3 4f bc 41 ae 9c 88 71  |b ..%..o.O.A...q|
+000002f0  51 f5 25 06 44 a1 49 6b  1b db ac 4b 37 41 78 29  |Q.%.D.Ik...K7Ax)|
+00000300  1c c9 33 82 f4 fe d3 0a  f9 e0 e8 ca 8c 7b 76 3d  |..3..........{v=|
+00000310  8b 3c 3b 17 03 03 00 99  3e 4c 63 66 48 fa 43 7a  |.<;.....>LcfH.Cz|
+00000320  4d 4b 8b 95 25 ca 9a e7  cf d8 d6 e2 4d e7 15 07  |MK..%.......M...|
+00000330  d2 cb 07 79 66 63 b5 8f  3a 7d 00 f4 3a 05 b4 ae  |...yfc..:}..:...|
+00000340  e6 7e 0e b5 a2 20 ee 0e  cc 85 de c2 5d d5 49 32  |.~... ......].I2|
+00000350  83 d8 2a 11 36 36 86 93  46 ac ce 7e b4 4d e6 20  |..*.66..F..~.M. |
+00000360  24 7d 8e c7 37 5f 05 aa  5e a7 de e6 c7 79 88 a7  |$}..7_..^....y..|
+00000370  e7 f7 86 51 07 e0 80 63  76 b2 03 a9 6c c4 86 1a  |...Q...cv...l...|
+00000380  8d 98 e7 16 e0 a2 dc 6e  5c 19 d1 98 c4 10 2b 39  |.......n\.....+9|
+00000390  f4 03 b9 0f b5 ab c3 25  18 bf 8c 59 16 7a 06 60  |.......%...Y.z.`|
+000003a0  73 9a 7c 6f d1 1e e1 de  07 23 21 0e 28 c2 fb 19  |s.|o.....#!.(...|
+000003b0  64 17 03 03 00 35 e0 fd  9c 49 88 45 b3 c7 da a3  |d....5...I.E....|
+000003c0  02 ee 8e 0c e0 33 64 01  35 7e aa 31 aa 43 75 64  |.....3d.5~.1.Cud|
+000003d0  30 fc 89 d8 f0 dc 6e 49  68 e8 4e 01 41 0d 31 07  |0.....nIh.N.A.1.|
+000003e0  c4 e1 bd db 83 b1 e6 46  f0 06 56                 |.......F..V|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 36 71 be 3a 8d  |..........56q.:.|
-00000010  ee 01 10 3e 7b a9 7a 5a  81 2f 2a 65 bd 56 8f b9  |...>{.zZ./*e.V..|
-00000020  0f a2 e9 80 eb ae 63 b0  60 69 ea f3 f7 66 d4 2c  |......c.`i...f.,|
-00000030  fd 13 2c 00 22 55 85 58  4e cf 4f 45 45 a1 ba 89  |..,."U.XN.OEE...|
-00000040  17 03 03 00 17 bc cf b6  f9 13 87 04 83 9e 1d dd  |................|
-00000050  ff 33 77 cb a1 71 bb df  23 97 2c b6              |.3w..q..#.,.|
->>> Flow 4 (server to client)
-00000000  17 03 03 00 ea 6c b0 c3  6b ed 51 ec 1e 57 a4 3e  |.....l..k.Q..W.>|
-00000010  f6 d0 e8 10 b6 b4 cd e6  0b 12 50 8f a2 26 b9 87  |..........P..&..|
-00000020  19 ad a5 25 33 ab 5e 2e  58 d4 68 c5 85 42 6c 1d  |...%3.^.X.h..Bl.|
-00000030  34 02 b0 47 59 f0 cd c2  d5 a5 bb 27 3f 60 9d 07  |4..GY......'?`..|
-00000040  22 3c 9a 25 d0 a6 2a b4  e4 52 20 18 07 f3 f8 b4  |"<.%..*..R .....|
-00000050  ad 4f 2c ec 8d 41 5f dd  b9 e1 bb 90 88 94 5e 73  |.O,..A_.......^s|
-00000060  75 a1 ed 88 cf 97 a6 67  02 02 78 be a4 20 29 ad  |u......g..x.. ).|
-00000070  91 63 a6 39 e8 42 1a 65  76 c7 17 f0 39 7a c4 62  |.c.9.B.ev...9z.b|
-00000080  d2 3e f4 12 eb ab da 7b  1f e6 94 b5 a1 b0 40 5c  |.>.....{......@\|
-00000090  e3 66 a3 7b 40 53 ce 74  10 77 d7 17 9f d0 b3 b2  |.f.{@S.t.w......|
-000000a0  a2 97 fd 42 08 5f af 79  a3 c0 c0 98 fa 71 58 8b  |...B._.y.....qX.|
-000000b0  a5 81 50 8a fc 51 d5 82  19 fb a7 6f 9f b3 6a 96  |..P..Q.....o..j.|
-000000c0  c3 d4 90 88 88 c2 96 df  70 ec 60 ca 71 9c 53 ef  |........p.`.q.S.|
-000000d0  fc a1 92 11 c9 a3 f8 b7  bc a2 6b f5 c5 dc dd b8  |..........k.....|
-000000e0  cb 7b 1b af 60 0f 16 8f  a8 d4 85 34 76 3c 35 17  |.{..`......4v<5.|
-000000f0  03 03 00 ea 7a 0f ef f0  87 83 1d 23 30 ed 14 d4  |....z......#0...|
-00000100  dc 97 19 38 71 e2 94 b1  54 e5 86 61 20 21 cd 57  |...8q...T..a !.W|
-00000110  29 e6 b3 01 8a 69 7f 06  f2 a0 3e 87 38 3c 7c 9d  |)....i....>.8<|.|
-00000120  d5 83 e3 58 26 0d 16 13  b8 af 13 a9 c3 21 27 ae  |...X&........!'.|
-00000130  32 df fb 3d fa 2c cd 7c  4e af d3 e0 32 29 7e f3  |2..=.,.|N...2)~.|
-00000140  b5 d2 56 58 bc 83 e2 c7  cd cc e7 e7 8d ff b1 70  |..VX...........p|
-00000150  c6 c6 51 ac 6a 12 de 28  4c 99 73 6d 38 4f 74 76  |..Q.j..(L.sm8Otv|
-00000160  ae 48 c8 ec a3 65 9c 3a  c3 b5 6d 47 1c 0f 5d 63  |.H...e.:..mG..]c|
-00000170  8c bb 85 61 51 89 f3 3c  9d 65 03 58 06 13 b2 d7  |...aQ..<.e.X....|
-00000180  d8 13 53 d1 11 7a cf 10  c9 8d b1 70 ac 20 7e af  |..S..z.....p. ~.|
-00000190  f5 fc cc a4 ab 91 a8 dd  2a db d6 e2 44 73 c5 57  |........*...Ds.W|
-000001a0  b8 ad 32 d4 98 ee 65 90  ee b7 c6 bf 78 b1 06 59  |..2...e.....x..Y|
-000001b0  b8 74 c9 54 e0 fc 79 92  bd ff 6f 42 c5 39 13 b3  |.t.T..y...oB.9..|
-000001c0  20 f7 e5 28 27 0e 22 4e  b5 38 81 46 14 f6 d3 a8  | ..('."N.8.F....|
-000001d0  f8 32 ca 3f da 1c d3 44  8f 21 da 5c f4 ad        |.2.?...D.!.\..|
->>> Flow 5 (client to server)
-00000000  17 03 03 00 13 6b f9 43  f6 f1 44 ba cc 47 cf 09  |.....k.C..D..G..|
-00000010  4d 94 dd 31 1e 65 ce 32                           |M..1.e.2|
+00000000  14 03 03 00 01 01 17 03  03 00 35 a3 4c 7d ed 56  |..........5.L}.V|
+00000010  62 f5 7a b9 39 08 02 7f  12 72 c2 de 2f dc 35 a2  |b.z.9....r../.5.|
+00000020  1f d0 8e 1a 7b c2 19 17  93 df 83 84 66 9e 8d 1a  |....{.......f...|
+00000030  fa 8c 37 74 04 13 b5 a2  81 7f dc 85 4c 37 f0 f1  |..7t........L7..|
+00000040  17 03 03 00 17 51 47 a8  1b bc 86 62 90 79 8a c7  |.....QG....b.y..|
+00000050  db 2c 99 95 bf 7c d0 27  6c c3 b6 24 17 03 03 00  |.,...|.'l..$....|
+00000060  13 e2 a8 b5 52 61 b0 66  54 50 60 83 78 3d 26 ef  |....Ra.fTP`.x=&.|
+00000070  f5 5e 36 58                                       |.^6X|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-ECDSA-RSA b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-ECDSA-RSA
index 8b49c0fc82..633397542c 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-ECDSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-ECDSA-RSA
@@ -16,221 +16,124 @@
 000000e0  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
 000000f0  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 16 6b 5e d7 00  |....z...v...k^..|
-00000010  ce 00 c1 8e 7d 12 51 a4  83 4b fd 6a 06 28 4b 1b  |....}.Q..K.j.(K.|
-00000020  00 fe 6e 45 a2 87 29 76  81 08 ba 20 00 00 00 00  |..nE..)v... ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 9b d5 46 91 59  |....z...v....F.Y|
+00000010  c3 26 be 21 ae 20 5f 26  4f 5f 19 ae 3c fe b9 df  |.&.!. _&O_..<...|
+00000020  16 1b 16 45 4b da 4e 08  58 e9 05 20 00 00 00 00  |...EK.N.X.. ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 01 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 82  |..+.....3.$... .|
-00000060  b2 b1 82 2f 3e e3 e5 d4  90 5e 44 a5 02 30 df 45  |.../>....^D..0.E|
-00000070  f1 c6 07 0d d8 af 64 b9  e3 51 30 6a eb a7 0e 14  |......d..Q0j....|
-00000080  03 03 00 01 01 17 03 03  00 17 a2 97 33 5b 62 2c  |............3[b,|
-00000090  69 6c 17 61 14 ba 66 9e  29 04 fa c8 3a a4 57 70  |il.a..f.)...:.Wp|
-000000a0  7f 17 03 03 00 42 30 a3  06 4b b8 20 2d ec f6 dc  |.....B0..K. -...|
-000000b0  cb e6 9c fa b2 5b b0 cc  55 54 53 1b 69 96 e1 3e  |.....[..UTS.i..>|
-000000c0  9a 57 08 6e 7a 8c 47 26  18 b6 90 f3 1f 7c c3 fc  |.W.nz.G&.....|..|
-000000d0  9f f6 f6 8c 22 d9 d7 5f  74 0e 55 2a 7f df 3b 12  |....".._t.U*..;.|
-000000e0  20 bd 07 96 77 f1 e8 ab  17 03 03 02 6d c4 d3 3b  | ...w.......m..;|
-000000f0  a3 2c 60 92 18 f1 b4 e4  10 2e 33 21 f0 43 d8 8a  |.,`.......3!.C..|
-00000100  ce 8a 60 2d 4a ff aa 91  68 7a 83 16 0b e1 30 e7  |..`-J...hz....0.|
-00000110  61 0b c4 c6 ba 60 46 72  c4 58 21 fb 3e 51 21 cb  |a....`Fr.X!.>Q!.|
-00000120  c0 77 c1 3e 40 b5 fc f5  07 83 6a aa 57 1a 30 df  |.w.>@.....j.W.0.|
-00000130  71 d9 6c 57 da d2 8a c6  2e b1 e5 29 f1 96 c1 1c  |q.lW.......)....|
-00000140  a2 c8 fe 31 be 71 c7 7a  36 c3 41 c9 2a c6 7f fc  |...1.q.z6.A.*...|
-00000150  a5 3c 5d 53 bc 7b 29 fe  62 64 bc b4 1e 2f c8 eb  |.<]S.{).bd.../..|
-00000160  98 6c 47 88 55 da bb 24  de 2b 6b c9 de 17 a1 13  |.lG.U..$.+k.....|
-00000170  70 47 7e 86 95 78 49 e7  9f 5b f9 4d d1 ea d5 60  |pG~..xI..[.M...`|
-00000180  af 66 10 b4 f5 cc f1 6e  80 56 b0 75 b4 a1 7c 22  |.f.....n.V.u..|"|
-00000190  f6 f9 b2 7d 43 24 4f c4  4a c1 f9 8b 03 b9 a5 7b  |...}C$O.J......{|
-000001a0  76 58 75 46 c4 6c cd d6  16 2f 3e ff 67 e2 31 21  |vXuF.l.../>.g.1!|
-000001b0  2c c5 cc 6a 2f 15 5e da  4b 6b e5 af 88 2f 9e 27  |,..j/.^.Kk.../.'|
-000001c0  d6 9a 5e 05 ea 20 e1 0d  03 2e b7 5a 9e f1 63 f1  |..^.. .....Z..c.|
-000001d0  31 f8 d4 bd 5a 28 6a c2  51 27 e8 d7 3d 51 fa 77  |1...Z(j.Q'..=Q.w|
-000001e0  70 1e 17 a4 7b de 3b a6  44 3c 2b 16 a8 85 28 32  |p...{.;.D<+...(2|
-000001f0  35 ff ff 60 24 32 d6 11  cb cc 23 51 97 82 b4 ac  |5..`$2....#Q....|
-00000200  66 a5 33 29 b0 2a 6c 8d  d3 69 75 3e ef bb a8 2a  |f.3).*l..iu>...*|
-00000210  a4 ed 92 1f ee 56 b6 c6  00 bd 80 ae c4 a6 ce 78  |.....V.........x|
-00000220  45 6b fc fb 7e ad cc ea  22 dd 33 0e 79 27 93 60  |Ek..~...".3.y'.`|
-00000230  a8 c0 c2 b0 2f 3b ba e9  f2 1b 2b ea f3 ff 45 9b  |..../;....+...E.|
-00000240  7b 28 aa 30 a1 14 8f a7  9c 74 53 fb 8c d6 41 d4  |{(.0.....tS...A.|
-00000250  a9 61 7a 5c 4a 20 aa 70  7f 03 52 e8 83 32 57 95  |.az\J .p..R..2W.|
-00000260  02 a7 34 37 04 9c 91 90  5f 8e 51 24 70 63 02 80  |..47...._.Q$pc..|
-00000270  dc 9c 54 e7 c1 d9 5c 8a  d8 b5 6d 8e 05 ef 2d a2  |..T...\...m...-.|
-00000280  38 74 d4 b6 83 77 4a 96  22 4d fb 3c 56 2b 29 6e  |8t...wJ."M.<V+)n|
-00000290  57 8f ad f0 a6 69 e7 1d  68 3e d6 fd 43 79 64 86  |W....i..h>..Cyd.|
-000002a0  bb 94 e6 20 c4 11 94 73  48 e3 5f 7b 1f 66 5a f8  |... ...sH._{.fZ.|
-000002b0  96 a3 9e 2e 61 4b 1c 86  80 86 26 f2 eb d6 f4 a1  |....aK....&.....|
-000002c0  29 9d dc ae de 38 f9 98  27 2e 69 d5 4f f6 ca 32  |)....8..'.i.O..2|
-000002d0  ca d4 79 90 98 2f 94 f7  0f 8f 77 9a 21 44 0a b6  |..y../....w.!D..|
-000002e0  e8 8b c3 3d 1a bd 2f 45  91 10 44 e2 74 22 6e e1  |...=../E..D.t"n.|
-000002f0  20 fc 32 d1 74 da 9d ac  0b b1 e1 d2 7b 65 96 c3  | .2.t.......{e..|
-00000300  41 eb dd a2 9e bf 7f 22  20 06 91 be 7a 94 77 fb  |A......" ...z.w.|
-00000310  88 31 f3 f4 d3 38 bb a3  01 4f e4 ee 08 b4 bf 23  |.1...8...O.....#|
-00000320  ad 46 22 28 f0 e9 4f bc  76 4d 53 7a eb 58 f3 0c  |.F"(..O.vMSz.X..|
-00000330  ae 6f 09 70 f2 96 b9 16  7a 24 4a 94 99 b3 a2 da  |.o.p....z$J.....|
-00000340  1a 61 ac 53 e0 2c ae c5  de 4b c5 e5 dd 54 e4 d5  |.a.S.,...K...T..|
-00000350  75 ea d1 dc 5d 57 04 2c  87 41 17 03 03 00 99 28  |u...]W.,.A.....(|
-00000360  54 65 ee 2f ba b3 bf 24  d6 d4 30 8a 7c ea e0 b2  |Te./...$..0.|...|
-00000370  e7 9a 32 55 f5 92 d4 1d  eb 73 fd db e3 f1 c9 83  |..2U.....s......|
-00000380  f8 89 fc bb a3 2e cb 3a  4e a9 4e 21 7c 1f 42 ce  |.......:N.N!|.B.|
-00000390  34 a7 7c 61 71 ff 58 80  f0 d2 fa 8f 01 16 02 47  |4.|aq.X........G|
-000003a0  f5 4c f4 92 7b 27 46 b7  c5 7f 11 b2 83 b5 56 c8  |.L..{'F.......V.|
-000003b0  95 79 eb 7f 11 b6 58 e7  73 6e 75 97 e7 5a 64 7b  |.y....X.snu..Zd{|
-000003c0  33 09 da 6b 1e 10 99 94  01 1d 03 fe f5 bb 69 0c  |3..k..........i.|
-000003d0  02 4b 1d 69 5f bf db a7  07 50 f0 b0 b9 8b 21 5b  |.K.i_....P....![|
-000003e0  98 55 b7 58 67 1f c7 dc  56 1b b0 58 e9 49 9a c9  |.U.Xg...V..X.I..|
-000003f0  28 d6 e6 e8 fc 7a ac c8  17 03 03 00 35 c9 67 6c  |(....z......5.gl|
-00000400  2f bd 89 41 ae c9 65 e2  be 94 a8 6d f2 d4 f2 15  |/..A..e....m....|
-00000410  74 a3 86 ed 57 67 d4 5e  76 de e4 67 5e f6 91 49  |t...Wg.^v..g^..I|
-00000420  f2 01 db af 07 ad 42 ff  a3 a1 1d e5 11 89 89 52  |......B........R|
-00000430  ee 29                                             |.)|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 08  |..+.....3.$... .|
+00000060  7c 10 a4 69 11 21 4e 78  e3 38 76 c1 4a c2 da 5e  ||..i.!Nx.8v.J..^|
+00000070  8f 82 b8 4a 32 d8 7c 48  b6 78 e2 61 1d b6 21 14  |...J2.|H.x.a..!.|
+00000080  03 03 00 01 01 17 03 03  00 17 7f ac 84 c7 d4 6a  |...............j|
+00000090  fc 73 53 a6 ae 25 f9 ad  e4 4c b9 31 71 4f ba b1  |.sS..%...L.1qO..|
+000000a0  55 17 03 03 00 42 61 ac  61 81 87 40 f1 15 d1 7a  |U....Ba.a..@...z|
+000000b0  44 ef c0 c8 4a 79 99 f1  16 28 36 4b 31 24 95 b7  |D...Jy...(6K1$..|
+000000c0  38 49 60 00 a9 aa 51 40  91 52 2f 39 20 d1 37 92  |8I`...Q@.R/9 .7.|
+000000d0  cf e1 cb 42 4a 7a 83 27  d3 77 20 4c 3c 22 0b 65  |...BJz.'.w L<".e|
+000000e0  8f ce 2a ec c2 5f 90 b0  17 03 03 02 6d 3a d2 ce  |..*.._......m:..|
+000000f0  b7 7b d3 94 d4 33 91 be  81 f1 af 80 e6 3e 28 d5  |.{...3.......>(.|
+00000100  d8 2f 23 08 b6 a6 80 ec  b4 bb 2e 85 31 ed 90 46  |./#.........1..F|
+00000110  74 34 90 77 0d d3 51 2d  6e 67 f0 4c 36 7c f2 30  |t4.w..Q-ng.L6|.0|
+00000120  08 86 6e 53 08 01 c5 06  c8 a4 c6 6a c0 32 80 d4  |..nS.......j.2..|
+00000130  0f 05 ff 91 96 a6 75 5f  71 72 be 63 fb 88 dc 5c  |......u_qr.c...\|
+00000140  06 06 eb 06 57 94 04 61  11 b5 03 1a 96 a3 c4 10  |....W..a........|
+00000150  7b b9 ee 83 3e 73 42 71  93 52 a3 44 b8 9d fb 8e  |{...>sBq.R.D....|
+00000160  5b 5d e4 af 22 0b dc 40  09 34 aa dc 08 d3 e9 54  |[].."..@.4.....T|
+00000170  0a b6 ea 87 33 e6 f5 eb  59 e0 6e c3 24 be 81 b3  |....3...Y.n.$...|
+00000180  93 89 d1 f4 dd 8f ab c9  a4 1f bf ed 58 86 f4 41  |............X..A|
+00000190  de bf 87 2e 1c fb b0 99  f0 ab 4e ec 3e 22 80 78  |..........N.>".x|
+000001a0  45 71 eb 6a f0 0a 89 bf  fe 37 e4 1d a6 90 f4 f3  |Eq.j.....7......|
+000001b0  7c 96 26 47 9d 07 53 16  7c 15 b1 8a 60 ec ad 55  ||.&G..S.|...`..U|
+000001c0  e3 50 7c 1f 5f 67 bc 29  b0 c5 12 99 db d9 b2 1f  |.P|._g.)........|
+000001d0  6c b6 bc 7d ed 0c d3 76  a0 1d c3 f1 f3 10 9d 63  |l..}...v.......c|
+000001e0  22 fd 66 f4 12 4d 4f 2e  7a 81 6e 9f 55 cb 40 26  |".f..MO.z.n.U.@&|
+000001f0  77 6a 9c 44 5b c2 cf ae  2d de 7c 85 ca 3e f6 c9  |wj.D[...-.|..>..|
+00000200  22 d0 34 f8 36 f2 a4 56  5d dc aa 7d f4 9d 3a e0  |".4.6..V]..}..:.|
+00000210  3e 4a b8 77 be 7e 8c c1  f0 0f 42 e7 54 a3 a0 b7  |>J.w.~....B.T...|
+00000220  76 33 fd 51 8c 2b e8 c3  85 de 0c d3 d7 1a 34 16  |v3.Q.+........4.|
+00000230  41 fb e4 eb fb 0f 8b b2  71 45 a7 3e 8f 82 ac b9  |A.......qE.>....|
+00000240  85 54 6f 5a 66 a0 16 90  00 24 e0 91 6e 7f 11 55  |.ToZf....$..n..U|
+00000250  cb 1a 6f f1 89 b2 a7 23  52 a7 ec 54 cc 0c 51 71  |..o....#R..T..Qq|
+00000260  e8 21 fc b2 ca 90 0d 44  ab 05 18 62 4c 01 41 44  |.!.....D...bL.AD|
+00000270  eb a9 ca 97 31 a8 0f 5f  b9 3a d3 18 a0 be a1 cc  |....1.._.:......|
+00000280  2f 88 54 b6 c3 8d e7 12  9f 2d 53 62 2e 05 ba 6e  |/.T......-Sb...n|
+00000290  9c 75 69 cb 4e 3d 2a 46  20 c0 92 c8 e6 e4 1a 16  |.ui.N=*F .......|
+000002a0  4b 09 7d 02 ec 8e 7f a2  b9 e9 05 32 88 4b be 39  |K.}........2.K.9|
+000002b0  30 c5 f9 ed ca 2a 1d a3  3b fe 18 76 2e f2 51 d4  |0....*..;..v..Q.|
+000002c0  b3 aa 61 67 3b eb 90 9c  bb ea 1a 6c 11 7b ba 86  |..ag;......l.{..|
+000002d0  38 f1 cd c7 3c 64 56 f3  ca ff fd b2 14 bf 37 7f  |8...<dV.......7.|
+000002e0  88 07 0c 82 49 05 06 50  5d 54 15 33 0a b3 38 a6  |....I..P]T.3..8.|
+000002f0  b8 e1 20 37 42 d6 0e c1  80 f4 37 e2 d7 96 9a 86  |.. 7B.....7.....|
+00000300  d9 87 a0 34 3a a2 e1 15  5f 5d 4b 36 5f 1a e5 8c  |...4:..._]K6_...|
+00000310  45 d5 10 10 3d 01 01 49  e1 3f 97 16 8a b6 08 30  |E...=..I.?.....0|
+00000320  e2 80 14 21 a3 d4 90 50  ee f7 37 91 25 c9 8a b3  |...!...P..7.%...|
+00000330  ad 99 15 c1 31 8d 4d 83  4b d0 7a a6 af 9b ed 85  |....1.M.K.z.....|
+00000340  88 be 68 af f0 dc ad 09  ca 9e 56 31 11 ba 0f bd  |..h.......V1....|
+00000350  76 d5 58 c4 db ad bc dd  77 b5 17 03 03 00 99 d6  |v.X.....w.......|
+00000360  c8 48 f5 8f e5 40 94 0e  47 da a8 99 05 3c 80 7f  |.H...@..G....<..|
+00000370  9d 03 73 06 dc d1 c3 21  23 0a 16 ae 0a bd a7 5b  |..s....!#......[|
+00000380  c7 e1 15 44 bd 47 94 ef  c0 fb 1e 1b 47 0d b8 c4  |...D.G......G...|
+00000390  e7 34 de b2 7f 75 f4 9e  02 5d 2a 90 68 4e 78 1f  |.4...u...]*.hNx.|
+000003a0  2a 06 40 4c f4 cd c7 82  f2 16 db b4 a4 d3 18 1c  |*.@L............|
+000003b0  7d ae 8b bc 29 c9 31 d7  ff 32 07 33 c5 0b 79 01  |}...).1..2.3..y.|
+000003c0  c9 91 f7 b1 4b 4a fc f9  f7 17 44 88 93 ad e4 f6  |....KJ....D.....|
+000003d0  21 d5 3d d3 a6 17 1e ac  12 df 41 eb b9 87 b7 bb  |!.=.......A.....|
+000003e0  60 b2 7d 98 ed f1 0c 4f  1c 5f 4b 16 7e 02 ba d6  |`.}....O._K.~...|
+000003f0  2d 9c c7 9b 07 fb 46 6a  17 03 03 00 35 0e 95 be  |-.....Fj....5...|
+00000400  c4 e1 78 98 78 30 95 a9  65 5b e7 e6 a4 13 47 83  |..x.x0..e[....G.|
+00000410  41 9b 87 bc ab 12 0a 85  33 7c 03 ca 73 3d c2 0f  |A.......3|..s=..|
+00000420  75 89 b7 c2 7f b1 1b 57  23 85 0c 74 25 a9 2c 53  |u......W#..t%.,S|
+00000430  12 d5                                             |..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 02 1e 71 98 b6 4f fe  |...........q..O.|
-00000010  ff bc ca 28 6c 91 6d 31  2f e4 05 f3 00 3a 04 26  |...(l.m1/....:.&|
-00000020  80 a4 bd 8a 92 8f 11 88  f1 30 46 c2 86 dc dc 32  |.........0F....2|
-00000030  fa 95 8e 52 f0 88 55 1d  c7 f6 9a 2c 64 ff c1 4b  |...R..U....,d..K|
-00000040  11 2e bc 41 83 3b ba 1b  7a de d4 99 f7 46 15 53  |...A.;..z....F.S|
-00000050  04 66 f5 57 7d 45 14 d1  cd 95 4c 33 8a 34 b1 0d  |.f.W}E....L3.4..|
-00000060  d2 a4 b4 be 41 eb 96 ae  c0 e6 55 9f ba d5 64 19  |....A.....U...d.|
-00000070  dd 84 93 cf c1 99 d2 73  3b a2 b0 30 17 df 7e 5a  |.......s;..0..~Z|
-00000080  21 14 44 4e 52 9d de 9c  4b 44 bf 6e b8 1e fc 47  |!.DNR...KD.n...G|
-00000090  cd 2b 51 8d be 96 28 7a  b7 6a c9 88 55 76 f3 80  |.+Q...(z.j..Uv..|
-000000a0  b5 2e 5e c1 53 7f 99 2e  d7 39 31 bd 16 07 b3 13  |..^.S....91.....|
-000000b0  6b d5 e6 b0 e5 79 42 36  3a 21 09 9c 8f f1 1f 09  |k....yB6:!......|
-000000c0  a6 3a d5 0c 62 d9 56 42  91 fc ba e0 8e 16 31 5a  |.:..b.VB......1Z|
-000000d0  a5 11 45 56 f8 4a 52 2d  b1 de ed 3b ac 08 dd 7a  |..EV.JR-...;...z|
-000000e0  b8 8a 7b ef e0 65 10 10  5e d5 99 ac db 95 f6 58  |..{..e..^......X|
-000000f0  a6 d7 18 72 14 9b 91 03  09 28 49 f9 63 55 92 71  |...r.....(I.cU.q|
-00000100  62 94 36 5a de 7a 1b a6  f2 b0 18 09 7f 0d 7d 68  |b.6Z.z........}h|
-00000110  c7 24 7f e1 15 86 86 01  23 91 77 76 86 37 40 3a  |.$......#.wv.7@:|
-00000120  16 ac 2d d0 55 0b 82 ef  c6 85 e7 17 27 ee c9 42  |..-.U.......'..B|
-00000130  a8 15 9c 2d a9 d5 41 bf  d8 eb 1d 03 45 51 65 66  |...-..A.....EQef|
-00000140  81 08 8e bf 86 df 5f 68  f3 b1 be 86 34 22 42 8c  |......_h....4"B.|
-00000150  e8 02 63 e2 18 bd dd db  13 36 dc 9f 0d d5 a7 fa  |..c......6......|
-00000160  4a 97 db 37 21 5c c7 fb  0a 6a f4 09 c3 5c db c1  |J..7!\...j...\..|
-00000170  49 14 eb 94 1a 3f 0b 7a  d6 cb d8 0c d7 0f 64 74  |I....?.z......dt|
-00000180  20 1b bf 68 d7 f2 91 aa  9d b0 46 47 1d 52 ad 91  | ..h......FG.R..|
-00000190  62 ed 90 42 99 fd 9e cf  80 1f 17 43 28 f4 71 90  |b..B.......C(.q.|
-000001a0  64 d0 64 ea f2 d0 a2 ba  96 36 4f 2c 53 9b ee 49  |d.d......6O,S..I|
-000001b0  a2 84 1d f2 4a eb 58 98  52 52 d3 92 91 7b 38 6c  |....J.X.RR...{8l|
-000001c0  39 2d 22 d6 92 6c 76 31  5b c3 32 fa 96 33 7a 92  |9-"..lv1[.2..3z.|
-000001d0  89 34 a0 95 66 23 0e ce  51 48 7d f1 9d b4 c9 79  |.4..f#..QH}....y|
-000001e0  b0 69 6b 9a 7c f2 4c 9c  e6 1b 39 20 9a 96 0c 0e  |.ik.|.L...9 ....|
-000001f0  5c 33 c7 05 10 aa a3 51  d4 a0 e4 e9 f2 e0 97 94  |\3.....Q........|
-00000200  dd fa 38 20 57 19 7b e5  ba 99 a5 1b 06 85 20 6c  |..8 W.{....... l|
-00000210  69 a8 ee f8 b6 fe e6 c7  af ff a8 23 0b 29 05 db  |i..........#.)..|
-00000220  d2 0f 7b ee 28 0b aa ba  75 17 03 03 00 a3 43 e7  |..{.(...u.....C.|
-00000230  59 40 d1 64 64 65 63 42  75 b3 5e 89 a2 73 3d 67  |Y@.ddecBu.^..s=g|
-00000240  1c 1b 5f 9e df f9 56 77  02 72 e4 ef 91 ab 2d 1a  |.._...Vw.r....-.|
-00000250  c6 78 cb 6a 9b 08 bb d4  6b 3e 46 73 0e 14 ee d8  |.x.j....k>Fs....|
-00000260  b6 0e 68 a2 34 da 55 61  c9 3a f3 dd de 37 eb 41  |..h.4.Ua.:...7.A|
-00000270  8d 26 3a 5f 47 31 34 2b  d2 c0 b8 cd 8d 24 d3 2a  |.&:_G14+.....$.*|
-00000280  34 64 29 c5 0a 5c 72 57  35 50 5b fb 9b 7b 7e c5  |4d)..\rW5P[..{~.|
-00000290  1a f8 96 85 3a 32 be a2  ba a5 00 2b 8c 6a c5 aa  |....:2.....+.j..|
-000002a0  fd 65 e2 5a 8a 89 05 c3  1d e6 ad fd c3 c7 b3 3a  |.e.Z...........:|
-000002b0  57 f6 3a 08 00 b6 e6 f4  b8 a7 4e 5d 42 26 d7 2d  |W.:.......N]B&.-|
-000002c0  00 04 2c e3 ba 67 b9 f6  c2 cb cd 73 10 d9 fa 6c  |..,..g.....s...l|
-000002d0  ab 17 03 03 00 35 b6 49  bd 61 18 68 8b c8 be 43  |.....5.I.a.h...C|
-000002e0  bf ea 1c 64 f7 81 b9 9d  b7 5d 6f e7 4a 2d e8 ae  |...d.....]o.J-..|
-000002f0  37 a0 bd 3a b6 d5 da ad  77 dd 8d e8 c7 5c 35 ba  |7..:....w....\5.|
-00000300  b9 af 67 21 1c c3 bd 6a  6e 9d a2 17 03 03 00 17  |..g!...jn.......|
-00000310  9c 58 47 b5 ba 24 69 1d  c5 88 10 31 8f 35 2f 24  |.XG..$i....1.5/$|
-00000320  37 d5 ae b7 70 5c 8e                              |7...p\.|
->>> Flow 4 (server to client)
-00000000  17 03 03 02 ea 4d 07 a0  65 50 d9 de ab ad 80 30  |.....M..eP.....0|
-00000010  4a 6e 26 79 32 0b 14 59  ad f4 41 98 4f 22 c0 6b  |Jn&y2..Y..A.O".k|
-00000020  e1 b6 c4 95 84 77 0a b2  08 33 b0 73 52 f6 65 ef  |.....w...3.sR.e.|
-00000030  27 e0 0f da a6 30 3c 87  d6 43 c9 79 d7 00 29 07  |'....0<..C.y..).|
-00000040  ee 8f e4 b8 63 bc 59 98  07 2f ea b1 57 a8 cb 8c  |....c.Y../..W...|
-00000050  5a c7 bd 2f 6e b5 1a 83  b7 c4 c3 89 d3 ec ec d2  |Z../n...........|
-00000060  71 b5 58 78 22 7e 89 ee  f1 b3 9c 3d f2 44 69 9a  |q.Xx"~.....=.Di.|
-00000070  aa 5a 13 d2 ba 28 34 11  d7 2b 78 c3 85 44 07 3d  |.Z...(4..+x..D.=|
-00000080  83 e2 13 f5 6c 63 23 77  dd bc 38 06 6e bf 5d 64  |....lc#w..8.n.]d|
-00000090  08 58 9e 49 a3 d1 53 ca  80 29 22 b5 84 96 86 3c  |.X.I..S..)"....<|
-000000a0  09 93 68 c8 c2 59 db 81  77 a1 a4 cc 13 cc 77 85  |..h..Y..w.....w.|
-000000b0  a6 d4 87 93 19 45 92 a6  5f 0e 03 23 3d a5 d5 1f  |.....E.._..#=...|
-000000c0  1b eb bb 28 17 b5 b7 85  29 6c 04 8d f2 08 a7 32  |...(....)l.....2|
-000000d0  1f 02 b9 f5 eb 28 8d 8c  b1 22 b6 84 76 fd c3 89  |.....(..."..v...|
-000000e0  92 f0 9c 9d 39 32 52 e9  57 46 ba 66 cc 3c fb 2a  |....92R.WF.f.<.*|
-000000f0  2f 8a 4f ce 7e 11 b3 42  39 33 50 5e 56 73 a4 fe  |/.O.~..B93P^Vs..|
-00000100  31 2b c6 6c be 62 d9 1c  0f 5a 88 8b 99 3b ad ec  |1+.l.b...Z...;..|
-00000110  78 e3 32 d5 ae 7d b3 0d  a4 7f 5a 79 86 65 be ed  |x.2..}....Zy.e..|
-00000120  00 ea 62 1d a3 52 fc 36  76 52 05 4a 68 9d 07 11  |..b..R.6vR.Jh...|
-00000130  d6 eb f5 c2 cd 7b ef b2  c9 20 a0 0e 78 a8 2f 2a  |.....{... ..x./*|
-00000140  e9 54 4c 92 90 a7 9e 7f  bb 48 b8 b7 f9 28 c8 9b  |.TL......H...(..|
-00000150  97 0c a2 20 da 9f 0e c9  b6 e1 07 51 c9 f0 34 32  |... .......Q..42|
-00000160  2d 6f b1 36 1a 20 c3 fb  c0 d6 88 84 b3 d8 7b 22  |-o.6. ........{"|
-00000170  89 6e cb 19 96 ad 05 6a  94 06 00 d8 71 e6 ad 78  |.n.....j....q..x|
-00000180  4c b8 4a 6a 63 fd 7a 66  4f 51 08 d3 7b 46 5f ae  |L.Jjc.zfOQ..{F_.|
-00000190  e7 39 d7 e8 97 de 3b ec  6a e0 c7 74 cb 53 74 b3  |.9....;.j..t.St.|
-000001a0  13 89 bd a4 0a b5 8b 0a  32 1a 97 5f 20 c5 b5 d0  |........2.._ ...|
-000001b0  14 ec 2e f3 20 19 e9 4e  85 28 1a 22 bf 14 3c ec  |.... ..N.(."..<.|
-000001c0  6d 4a c8 0f 0d 69 94 c0  e3 b2 86 8e 5b ac a4 84  |mJ...i......[...|
-000001d0  e3 da 21 1f 0a 17 ae 40  64 c6 db c1 1d 61 5d e9  |..!....@d....a].|
-000001e0  13 85 43 0d 72 48 09 8a  81 5a 1f 15 54 6c 1d 04  |..C.rH...Z..Tl..|
-000001f0  09 e4 c7 75 06 36 c6 5f  a9 f5 70 2e a2 68 40 b1  |...u.6._..p..h@.|
-00000200  df 50 c7 9a 81 d8 cd f9  19 2c 7c a3 aa 35 4f b5  |.P.......,|..5O.|
-00000210  62 c4 00 92 b2 f1 91 60  ce 64 bc fe 25 fc 7e da  |b......`.d..%.~.|
-00000220  48 d6 34 e8 39 bb c6 93  51 06 d0 3b 9c 29 b9 83  |H.4.9...Q..;.)..|
-00000230  05 b5 62 47 e0 1c 61 ce  8a a6 55 25 45 8b b3 29  |..bG..a...U%E..)|
-00000240  62 ab 16 ee 72 11 b9 2d  9c 00 cb 78 65 f5 8b 60  |b...r..-...xe..`|
-00000250  6d 78 a2 a4 41 9b 05 4a  79 39 03 a9 6f 77 78 a1  |mx..A..Jy9..owx.|
-00000260  fc 4c d4 4e 5b 27 b3 da  31 5c 5c 3a 10 18 a7 75  |.L.N['..1\\:...u|
-00000270  78 1a d3 f4 6c a1 22 03  55 a2 70 1d 48 ce e1 67  |x...l.".U.p.H..g|
-00000280  fe 42 f9 5e 3c 1e f8 6c  c0 8f da 67 8c fe 07 5a  |.B.^<..l...g...Z|
-00000290  53 2a c9 01 2d b4 ca cf  ac 9b 7c 9a c2 8f 24 0a  |S*..-.....|...$.|
-000002a0  fb 4a 1b b1 c8 d5 0a 9a  e1 e9 40 a5 4a c5 07 46  |.J........@.J..F|
-000002b0  28 d0 db 2b dc 40 02 70  38 09 d5 bc 04 a1 81 02  |(..+.@.p8.......|
-000002c0  6c 40 e1 79 ef 50 ae 2d  0c 82 c0 19 88 7d a0 07  |l@.y.P.-.....}..|
-000002d0  0d 4a 40 87 c0 8a 06 a3  ea 3e 5e 3e b7 3d 9d 92  |.J@......>^>.=..|
-000002e0  b3 ee bd 72 90 ea 35 81  c1 29 86 24 13 9d 2a 17  |...r..5..).$..*.|
-000002f0  03 03 02 ea 7c 16 54 e4  e2 06 d8 a1 e4 27 1b a4  |....|.T......'..|
-00000300  14 a8 b6 29 50 18 bf d3  59 5e bb 53 8e 7c 8f d3  |...)P...Y^.S.|..|
-00000310  fb bd e8 06 f2 6e 82 23  07 a7 0f 91 f6 be 11 70  |.....n.#.......p|
-00000320  89 6a c8 f1 26 1f e4 09  88 38 01 ba 81 dc 4d 2c  |.j..&....8....M,|
-00000330  13 05 3b 37 2e 95 4c 7f  8a c3 a3 5b 4d 43 5c ee  |..;7..L....[MC\.|
-00000340  11 92 c3 a7 93 5a e7 7b  f8 ae 9f 83 ef 25 d4 af  |.....Z.{.....%..|
-00000350  a3 4b 04 7e 8f 54 3a 5b  f6 61 75 61 80 e0 40 cb  |.K.~.T:[.aua..@.|
-00000360  1d 4c ab 55 e9 35 ea 91  af b7 10 e4 ac 9d d5 d0  |.L.U.5..........|
-00000370  1c c6 3e 73 ea 15 08 bb  53 76 0b 44 64 64 5b 98  |..>s....Sv.Ddd[.|
-00000380  e8 d8 b6 32 43 91 53 2d  3d f9 04 a9 03 d4 73 c8  |...2C.S-=.....s.|
-00000390  49 fe a2 48 a0 09 31 d1  08 47 d1 7d 71 4b 2f 43  |I..H..1..G.}qK/C|
-000003a0  e6 67 a9 4f 66 0c 01 8c  4c 5b 36 84 d0 bb df 4d  |.g.Of...L[6....M|
-000003b0  c5 d3 27 9c c0 48 d3 49  b3 73 ce 51 38 70 a3 d8  |..'..H.I.s.Q8p..|
-000003c0  53 88 a9 f8 2d 68 21 fd  7c b8 68 84 f5 f6 fd d5  |S...-h!.|.h.....|
-000003d0  62 77 af dc 28 8b 44 46  3b a7 12 fc 28 72 d3 b9  |bw..(.DF;...(r..|
-000003e0  de e9 73 af 93 d3 37 ce  60 81 8d 62 02 ff 78 d3  |..s...7.`..b..x.|
-000003f0  9a 60 68 f9 54 df b7 f0  7b cc 4a 92 9e 31 76 0d  |.`h.T...{.J..1v.|
-00000400  02 31 fe e2 c6 03 63 a6  b2 cf aa 00 f8 93 3f a4  |.1....c.......?.|
-00000410  d1 45 9c 7d b6 06 11 30  c9 7a 12 16 6a 0a 8f 5c  |.E.}...0.z..j..\|
-00000420  a8 aa 5d 3f 8c d6 89 de  5c a5 d9 da b7 92 dd a6  |..]?....\.......|
-00000430  d3 a0 7f 62 95 c5 12 54  6d a3 2a 38 99 b2 12 d6  |...b...Tm.*8....|
-00000440  47 56 56 f6 3d cf 37 9c  31 bd 9c 32 ae 52 05 e9  |GVV.=.7.1..2.R..|
-00000450  2e c7 3b 84 45 ef 1f 94  ff ee d8 47 88 ea 09 ae  |..;.E......G....|
-00000460  27 51 9c 59 bb ff 7a 75  f7 72 38 35 f6 3e cc 01  |'Q.Y..zu.r85.>..|
-00000470  54 72 5f e6 2e 16 12 25  b4 9b 69 76 fa 2a 2d 76  |Tr_....%..iv.*-v|
-00000480  d2 bb e0 cf d2 41 00 20  d9 0b 88 42 7f 7c f8 70  |.....A. ...B.|.p|
-00000490  67 7f 06 d9 a6 17 79 6d  6d 53 87 9a 28 df 97 8f  |g.....ymmS..(...|
-000004a0  f3 35 4b 5a 43 43 9a 07  6d c3 00 5b 58 7a 7a 80  |.5KZCC..m..[Xzz.|
-000004b0  5e 0e 9c 6a da 8d 0b 65  26 af e6 2f f4 a5 cf 6e  |^..j...e&../...n|
-000004c0  07 9b 24 2b 5b 36 fd 07  3b 46 f5 f4 15 cc ea 11  |..$+[6..;F......|
-000004d0  f9 d0 97 ea 1d b7 3d db  bf 7c e2 dd 68 1e 8b ea  |......=..|..h...|
-000004e0  90 cb 67 8a 2e 25 77 40  3b 76 c1 0f 4e b0 33 95  |..g..%w@;v..N.3.|
-000004f0  d0 b1 39 44 d9 7c eb 34  98 8d 2c 54 5b a8 9a 22  |..9D.|.4..,T[.."|
-00000500  68 a7 74 10 6f 69 f0 9c  07 11 0b 9b 81 da 3e 16  |h.t.oi........>.|
-00000510  a9 b6 92 55 ce a0 15 25  5e 25 6e 41 5a d6 34 83  |...U...%^%nAZ.4.|
-00000520  83 fa b3 53 0c b0 5c 60  83 1e 42 09 90 e0 5d 20  |...S..\`..B...] |
-00000530  79 6c 34 ec a0 da fa 32  b6 6e d3 37 a5 ad 5a f6  |yl4....2.n.7..Z.|
-00000540  b7 85 a3 e2 75 c7 b0 c8  1b bc 71 73 24 c4 4f 7f  |....u.....qs$.O.|
-00000550  34 d4 0f a0 c1 53 f9 35  b3 c1 5e e9 32 a8 2d f0  |4....S.5..^.2.-.|
-00000560  9b 8e 24 82 93 92 85 e5  82 56 84 a8 f2 e5 6f 81  |..$......V....o.|
-00000570  a8 cd e9 34 ce 24 48 0a  c5 07 32 ec a1 ec 44 37  |...4.$H...2...D7|
-00000580  42 af 4f ef 33 de fb 98  e6 95 59 63 bc e0 aa 0a  |B.O.3.....Yc....|
-00000590  62 dc c0 28 7f b2 53 62  fb d6 42 d7 cc 60 b6 5b  |b..(..Sb..B..`.[|
-000005a0  8d 30 a7 94 36 9d c2 d0  fe 38 aa 95 0a 3f 7f 6f  |.0..6....8...?.o|
-000005b0  5b a3 bb 25 d9 e7 a6 7b  46 e9 e0 42 c7 73 c9 a8  |[..%...{F..B.s..|
-000005c0  01 ec 54 93 d4 28 f1 ba  c9 26 04 22 02 88 04 4d  |..T..(...&."...M|
-000005d0  e3 c8 6f a8 de fb fd 48  76 41 cc e2 98 52        |..o....HvA...R|
->>> Flow 5 (client to server)
-00000000  17 03 03 00 13 3b cc e0  8a fe cd f3 1f 2c 07 cc  |.....;.......,..|
-00000010  9d c3 62 ae 15 fe 68 64                           |..b...hd|
+00000000  14 03 03 00 01 01 17 03  03 02 1e e2 06 ae 3e 78  |..............>x|
+00000010  b4 85 1b 44 b7 6d 04 4b  9f 2c ea 23 79 66 d5 7d  |...D.m.K.,.#yf.}|
+00000020  c5 39 57 5c 15 49 9a 6e  c8 19 1b ed 5d 95 ce 6f  |.9W\.I.n....]..o|
+00000030  df 96 3a 16 87 88 c0 25  6a 36 fc 62 05 01 bd c1  |..:....%j6.b....|
+00000040  00 a8 11 da 7f 0e a3 6c  28 26 9f 4a 18 e2 44 b9  |.......l(&.J..D.|
+00000050  aa 71 b2 f6 fa 8b cc 67  c5 29 72 32 cf 78 36 6b  |.q.....g.)r2.x6k|
+00000060  22 67 86 ac 71 19 cb 9d  9e 36 7b 03 42 01 e5 4b  |"g..q....6{.B..K|
+00000070  4c c0 0d 93 22 51 a6 d3  65 00 87 ef 92 f3 08 33  |L..."Q..e......3|
+00000080  4b e1 18 bc ba 2b 43 90  0f 2f d5 8e 4c 79 9f a7  |K....+C../..Ly..|
+00000090  bd 00 2a b7 89 27 b3 e3  db b7 a7 26 b4 8e 48 6f  |..*..'.....&..Ho|
+000000a0  e7 12 55 f0 8e 02 a8 3f  30 d4 22 a4 d0 e3 89 63  |..U....?0."....c|
+000000b0  7d cf c2 46 27 31 8c 10  5f 28 9f 85 fb 02 64 6a  |}..F'1.._(....dj|
+000000c0  8d 50 26 e6 73 57 43 53  39 c7 bb 72 4e c2 dd 07  |.P&.sWCS9..rN...|
+000000d0  86 b0 96 30 f5 d8 f0 5a  a0 09 1c 42 26 65 50 d1  |...0...Z...B&eP.|
+000000e0  65 1f 97 fd a0 3a c2 ae  d6 a4 08 af 5c 9d 30 12  |e....:......\.0.|
+000000f0  fc d8 a2 cd d3 b1 7b de  4b be df 54 aa 31 48 32  |......{.K..T.1H2|
+00000100  7a d2 d5 59 f1 39 bc cd  23 2b ac 17 ff e4 0e ec  |z..Y.9..#+......|
+00000110  55 d2 b9 6b a0 30 65 db  5b e9 b4 ab b9 1e dd 3c  |U..k.0e.[......<|
+00000120  fd 38 7b 19 7f ea 79 56  90 f8 41 bc 3d 64 0b df  |.8{...yV..A.=d..|
+00000130  05 a3 6c b8 14 5f f5 41  4f 3c 6d 46 a3 24 92 22  |..l.._.AO<mF.$."|
+00000140  65 f5 42 52 c7 56 0c 14  e2 3d e4 5c 68 33 91 5e  |e.BR.V...=.\h3.^|
+00000150  a2 8e b4 fc d9 2b 8d 2f  b9 32 4f 86 b1 6f 58 b2  |.....+./.2O..oX.|
+00000160  ae 55 2d 75 a6 8c 2b f1  2b b6 2b 47 5f 9d b1 71  |.U-u..+.+.+G_..q|
+00000170  64 8d a3 c1 48 29 b5 ef  aa d3 10 05 05 9c 73 10  |d...H)........s.|
+00000180  76 b5 c2 3f 5d 91 3f e8  1e b0 f7 62 74 3f 59 ea  |v..?].?....bt?Y.|
+00000190  db c8 ac d1 f2 e6 9d bd  08 f3 bf 8a 2a 0c 5a 10  |............*.Z.|
+000001a0  c7 4b ee f3 1a 7d fa 69  4b 5e e5 43 79 07 ce c8  |.K...}.iK^.Cy...|
+000001b0  29 96 e3 4e e6 fb c6 2c  cd 2a 78 72 0a 4e c6 44  |)..N...,.*xr.N.D|
+000001c0  53 d7 8b 16 1b 98 4c 39  8f 8f 1a f5 00 0a e5 e8  |S.....L9........|
+000001d0  31 62 d0 fb e5 0e e6 c0  95 6e d6 7c 6e b0 9d 63  |1b.......n.|n..c|
+000001e0  f0 74 38 d5 08 9d d1 b6  62 95 59 bf 6e d2 75 5d  |.t8.....b.Y.n.u]|
+000001f0  7a dd f0 11 3c 6f 55 b7  19 91 fc 5b cd e0 8f c6  |z...<oU....[....|
+00000200  28 e4 38 45 1b e3 4d d6  39 96 b3 4a 00 e7 ea 78  |(.8E..M.9..J...x|
+00000210  f7 a1 a7 00 83 04 ba c3  9f f9 21 07 c4 9a fd ed  |..........!.....|
+00000220  e9 a0 2a 3b 11 92 80 4e  89 17 03 03 00 a4 fd af  |..*;...N........|
+00000230  e1 d4 b1 20 76 34 06 f3  cc 9b 11 3d bc f3 5b e5  |... v4.....=..[.|
+00000240  0f 5f 32 40 6d 16 68 92  12 32 3e cd df e3 9b da  |._2@m.h..2>.....|
+00000250  18 9d de 95 a3 d2 00 98  88 90 4d d0 19 a0 47 60  |..........M...G`|
+00000260  6f 1b 36 e4 c0 d8 02 52  b8 0b f4 78 44 8d 72 56  |o.6....R...xD.rV|
+00000270  e4 68 ce c0 cd 71 34 60  6b 6c 8f 22 cb 78 d2 d7  |.h...q4`kl.".x..|
+00000280  fc 89 b9 d6 34 34 c9 f1  44 78 84 36 27 bc 73 0e  |....44..Dx.6'.s.|
+00000290  ae 43 72 66 07 e4 6c fd  ee da ca 99 a2 25 21 a7  |.Crf..l......%!.|
+000002a0  eb 63 11 21 c4 30 45 b3  82 27 7d 8c 9d 37 86 8d  |.c.!.0E..'}..7..|
+000002b0  35 90 5c 13 be 21 fc bd  65 af ec 65 3d c0 9a 1d  |5.\..!..e..e=...|
+000002c0  6b 75 38 17 8d d1 92 ba  43 c1 e8 a5 43 f5 0b ab  |ku8.....C...C...|
+000002d0  16 4d 17 03 03 00 35 a9  24 2a fd af f5 da 3b ed  |.M....5.$*....;.|
+000002e0  d7 15 86 16 c5 e8 bf 95  bc e1 90 fb 0f be f2 3c  |...............<|
+000002f0  75 b0 30 1b ce f9 ac f7  97 ae 7e 29 d7 17 aa a4  |u.0.......~)....|
+00000300  ba c3 2a db 1a 7c 5e bc  18 84 6e e0 17 03 03 00  |..*..|^...n.....|
+00000310  17 52 2f 82 87 2d ca 50  2c 51 f6 99 9d 54 5a 68  |.R/..-.P,Q...TZh|
+00000320  38 61 ca 02 81 2c 62 dc  17 03 03 00 13 35 e5 58  |8a...,b......5.X|
+00000330  b4 26 e0 83 2a 8e 61 e9  96 1a cd 1a 6e c9 67 c0  |.&..*.a.....n.g.|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-ECDSA
index a4823303e6..74163f0521 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-ECDSA
@@ -16,213 +16,119 @@
 000000e0  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
 000000f0  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 0d bc 10 4c a6  |....z...v.....L.|
-00000010  07 5d ee 65 44 88 da cb  ec 3e e7 9f e7 e4 12 01  |.].eD....>......|
-00000020  bf 4c ca 2a 69 77 b7 ce  2e 4d b0 20 00 00 00 00  |.L.*iw...M. ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 dd 25 8d f2 41  |....z...v...%..A|
+00000010  0b 2f 7b 80 24 03 af 9d  81 4e fd a8 ae e4 00 ee  |./{.$....N......|
+00000020  99 5f 09 05 8b 2a c2 0a  7c 92 ad 20 00 00 00 00  |._...*..|.. ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 01 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 fa  |..+.....3.$... .|
-00000060  d3 a7 66 61 08 f4 5e 78  2b 04 6b 67 f6 db 95 c2  |..fa..^x+.kg....|
-00000070  2f bc 13 13 ec 29 ca e3  88 77 33 08 1b b5 6e 14  |/....)...w3...n.|
-00000080  03 03 00 01 01 17 03 03  00 17 04 08 27 c4 db 89  |............'...|
-00000090  a1 a7 75 ec 5e 05 07 9a  47 40 89 a5 7c e1 77 e2  |..u.^...G@..|.w.|
-000000a0  a6 17 03 03 00 42 70 bc  31 0d 73 a8 b5 ec 55 a5  |.....Bp.1.s...U.|
-000000b0  87 cd 02 f9 8f 5c 77 59  b7 62 a0 7c 9a 6e 70 ca  |.....\wY.b.|.np.|
-000000c0  41 68 b6 0e 41 ba 28 e6  4b cc 64 ea 8a 08 5c 79  |Ah..A.(.K.d...\y|
-000000d0  6d e7 06 bf ee 94 c9 04  84 0d df 4a 69 05 1d 37  |m..........Ji..7|
-000000e0  68 36 17 61 53 58 ac 87  17 03 03 02 22 e6 c6 58  |h6.aSX......"..X|
-000000f0  9d ca d8 79 54 67 64 72  8d 9b 12 4a 93 55 b7 70  |...yTgdr...J.U.p|
-00000100  e1 15 6f a0 d1 64 17 b5  2b ec 29 37 91 0c 21 ff  |..o..d..+.)7..!.|
-00000110  ba d9 e9 4b 5a af a3 4a  6d 07 64 02 b1 a4 54 19  |...KZ..Jm.d...T.|
-00000120  44 b2 a0 e6 b4 28 75 f0  d8 7e 0d 20 f0 45 ba 93  |D....(u..~. .E..|
-00000130  3a 55 d6 e2 17 d7 ad fe  54 ac fe a9 a1 01 2d 62  |:U......T.....-b|
-00000140  61 7d 20 90 2f d5 f3 e8  46 6d 7c 54 37 25 da 49  |a} ./...Fm|T7%.I|
-00000150  56 db 9d da a3 60 7c 31  cb 5e e7 89 6d 23 30 7e  |V....`|1.^..m#0~|
-00000160  83 96 11 f7 4a 62 b7 e7  96 e7 f8 c9 c2 c9 bd 12  |....Jb..........|
-00000170  b3 fc b0 8d 17 35 99 c4  ef f7 e8 9f 4f ad a0 bf  |.....5......O...|
-00000180  ea 6c 55 cd 0f 2d e3 85  4a 74 e7 94 89 e3 6d 94  |.lU..-..Jt....m.|
-00000190  d1 d6 d3 1a aa c2 2e 32  37 79 1a ee f0 44 14 3a  |.......27y...D.:|
-000001a0  a1 61 bb cb 95 ce f5 e4  fe c4 c2 8b 90 38 00 ce  |.a...........8..|
-000001b0  46 4a b0 83 e2 d9 ae 7f  bf fe 72 65 4a 5f bb 07  |FJ........reJ_..|
-000001c0  78 a9 90 c0 9e b3 5c 4d  79 e3 de a0 5c c3 1f f8  |x.....\My...\...|
-000001d0  7f a0 db e7 88 8c 5b e1  f0 0e f5 00 80 0a 5f 3b  |......[......._;|
-000001e0  2a a3 a9 7f 73 9b b3 3e  91 e4 5c 96 74 fe e5 41  |*...s..>..\.t..A|
-000001f0  99 cb 14 a7 28 b3 ca 47  ec 53 88 0e 71 1d 26 11  |....(..G.S..q.&.|
-00000200  60 d8 b5 9c 5e 93 79 9d  9f 84 74 f4 f7 90 82 dd  |`...^.y...t.....|
-00000210  8e 0a 29 10 45 9c 05 60  82 52 29 88 c9 09 d6 9a  |..).E..`.R).....|
-00000220  57 ee 72 62 0c 57 80 ec  46 b8 b1 c9 83 8b e6 c6  |W.rb.W..F.......|
-00000230  2b d9 cf 9d 3c e0 51 c1  2d 68 96 c4 70 c8 60 9a  |+...<.Q.-h..p.`.|
-00000240  b0 95 6b 81 70 8e bd 7d  c7 91 f6 e2 e6 66 f6 a9  |..k.p..}.....f..|
-00000250  6c db 9a c1 42 3f 90 93  2f 9b cd 39 95 95 89 4f  |l...B?../..9...O|
-00000260  b8 a6 2e 70 25 a7 37 d1  9f 97 16 2d 41 2b de 80  |...p%.7....-A+..|
-00000270  33 c3 72 e4 ac 7d f9 ba  2f 30 ed 0e c8 7a ac d7  |3.r..}../0...z..|
-00000280  34 c5 a9 a5 e3 18 71 63  d1 33 94 5a b5 39 eb d5  |4.....qc.3.Z.9..|
-00000290  25 da d0 47 0e e2 48 5a  af e5 6f a7 ed 18 44 ce  |%..G..HZ..o...D.|
-000002a0  6c 3a 17 de b9 00 f9 cb  de d2 cb 3b 29 fc 5d 69  |l:.........;).]i|
-000002b0  ed 8e 64 83 07 c1 3d fa  6e 98 d4 45 b2 5a ff ca  |..d...=.n..E.Z..|
-000002c0  85 13 73 d9 19 8c e7 60  fc 2a cc 2d d0 1a 0c e3  |..s....`.*.-....|
-000002d0  22 ec d6 38 f4 47 d0 96  b6 f8 11 2b 43 da 2a f9  |"..8.G.....+C.*.|
-000002e0  e8 80 c6 63 68 bf fe ae  05 08 c7 4e 52 2f 2e 08  |...ch......NR/..|
-000002f0  62 2b 2a 06 f2 f0 e3 22  be c6 8f 72 82 fd 33 29  |b+*...."...r..3)|
-00000300  58 c8 5f 6d 36 d6 4c 02  c5 c5 e6 f2 66 1a f3 17  |X._m6.L.....f...|
-00000310  03 03 00 a3 4e ac b9 1a  db ec b9 f6 82 f6 07 c7  |....N...........|
-00000320  7c a3 cf 11 bc 18 c1 8e  5d bc c4 52 af ac 20 a3  ||.......]..R.. .|
-00000330  a0 90 28 01 6f 81 18 7f  14 d4 fd 87 55 54 13 73  |..(.o.......UT.s|
-00000340  95 49 1b ad a8 29 d9 8d  5e 6e 02 49 2f a8 e0 a6  |.I...)..^n.I/...|
-00000350  48 dc e5 6d 8e d6 7f 8f  fe 40 94 c9 5b 3d 63 c4  |H..m.....@..[=c.|
-00000360  85 a5 97 27 db 31 64 67  ab 81 62 8a 2b 2a fd 61  |...'.1dg..b.+*.a|
-00000370  b1 c8 c8 d3 c4 e0 ad 5d  7a 59 1a 62 0c 2b e9 7e  |.......]zY.b.+.~|
-00000380  bb 6b af 63 f0 32 f1 b8  72 13 ca 69 06 cf 82 67  |.k.c.2..r..i...g|
-00000390  8e 76 7a c2 d4 96 c9 ab  d4 dd a4 22 c3 e3 32 a4  |.vz........"..2.|
-000003a0  e6 e1 fd 3a 56 95 2a 0e  ef 5c 87 d3 b0 e3 27 04  |...:V.*..\....'.|
-000003b0  61 1a 5e 1c 9a 77 09 17  03 03 00 35 29 50 c2 81  |a.^..w.....5)P..|
-000003c0  02 68 53 fe ef 46 7c eb  0c 2f 00 c1 67 8f 25 b6  |.hS..F|../..g.%.|
-000003d0  6a fd 51 3a db fc cb 50  c8 32 9b cf 5a ba be ab  |j.Q:...P.2..Z...|
-000003e0  c8 fb 58 d5 5c 77 66 65  70 a2 2c 65 d2 5c 22 51  |..X.\wfep.,e.\"Q|
-000003f0  09                                                |.|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 fd  |..+.....3.$... .|
+00000060  03 d1 75 4e 57 ae b0 cc  43 4f 7e 2b de a8 01 46  |..uNW...CO~+...F|
+00000070  98 c7 f9 8e a5 46 95 68  fa 5e 07 c3 a1 55 5e 14  |.....F.h.^...U^.|
+00000080  03 03 00 01 01 17 03 03  00 17 df 30 a4 ce 8e db  |...........0....|
+00000090  20 0d 74 59 0a df 8e 67  23 af 3d 2f 87 8f 31 a0  | .tY...g#.=/..1.|
+000000a0  bf 17 03 03 00 42 0f 0a  20 4e 21 cd d8 01 13 ea  |.....B.. N!.....|
+000000b0  74 29 8d e4 a0 1b 6a a5  be 89 03 8d 2b 39 c4 23  |t)....j.....+9.#|
+000000c0  5e b1 f7 4f e4 1f dd ea  f8 38 fe 07 89 ca f1 e6  |^..O.....8......|
+000000d0  11 e9 2d 40 ca f1 63 11  ac 29 44 c2 25 18 4d 29  |..-@..c..)D.%.M)|
+000000e0  30 aa cb 35 b4 33 27 8a  17 03 03 02 22 36 fb 97  |0..5.3'....."6..|
+000000f0  fd ba 12 9b e5 19 14 79  2b 78 0e 6c a9 d8 13 a2  |.......y+x.l....|
+00000100  51 d8 c1 4b 53 ac a4 73  cf b1 2d 2c 4d 14 b8 10  |Q..KS..s..-,M...|
+00000110  de 5d 86 81 19 77 19 a0  b4 1b eb 85 f4 dc 21 2f  |.]...w........!/|
+00000120  c5 5c 62 44 1b ca f2 91  06 95 14 7a 07 02 1f 98  |.\bD.......z....|
+00000130  0d bc a4 89 7c 96 21 6b  37 1c 47 4a 10 e8 e2 b6  |....|.!k7.GJ....|
+00000140  f9 e2 97 06 a5 88 ad 5c  f1 08 28 4b f5 d5 9a a0  |.......\..(K....|
+00000150  51 74 30 ab 9c 52 b0 b9  2d 38 bb 25 b8 6e 71 a7  |Qt0..R..-8.%.nq.|
+00000160  7b c9 76 56 13 e6 60 bf  70 15 11 0c 21 12 cd a1  |{.vV..`.p...!...|
+00000170  b8 e5 3a 49 00 ad 9c 2f  e5 2b 1f cc 4e 4f 0b 90  |..:I.../.+..NO..|
+00000180  e1 77 64 5f b5 fc 7b 1c  f3 09 cb 0e c4 94 d7 33  |.wd_..{........3|
+00000190  59 5b 8f ae e1 9c e4 f6  83 10 f0 71 5f 17 4b b3  |Y[.........q_.K.|
+000001a0  3f 81 2c 0a 22 c5 f4 6b  bd 83 32 37 4a 2a 9a db  |?.,."..k..27J*..|
+000001b0  7b 42 c2 c0 7d 13 e0 e7  ea d7 58 a6 b1 20 68 bc  |{B..}.....X.. h.|
+000001c0  ba 4e 1a 91 6d dd 11 b9  fc 57 02 4d d4 e8 47 74  |.N..m....W.M..Gt|
+000001d0  9d e1 a0 25 2f d9 7d 21  39 b9 ca 4c ff de 42 8c  |...%/.}!9..L..B.|
+000001e0  36 bb 46 79 d3 52 be bc  1c dc 1f e3 6e 18 b8 4e  |6.Fy.R......n..N|
+000001f0  b2 47 e6 74 d3 50 fa cf  fd 5a c8 33 9a 17 2f 48  |.G.t.P...Z.3../H|
+00000200  e6 20 29 b3 7b e3 de a1  c8 e7 74 f0 ca eb f9 6e  |. ).{.....t....n|
+00000210  29 2c 73 17 df 5f 8f ed  dc ae 2a a6 37 f2 b7 f7  |),s.._....*.7...|
+00000220  38 da 45 63 cd 2e e6 bf  c7 a4 3c 15 c2 89 6f 59  |8.Ec......<...oY|
+00000230  c2 19 29 19 13 4f a4 59  57 f9 da 8c 7d 5a 82 7a  |..)..O.YW...}Z.z|
+00000240  9f 79 01 51 94 7c 25 46  7e c2 b2 bf b4 dd c1 e8  |.y.Q.|%F~.......|
+00000250  12 14 3e 77 44 8c 47 8b  9b ab 88 47 5d 12 cd 63  |..>wD.G....G]..c|
+00000260  17 c2 15 29 a3 cf 8c 08  e0 12 f6 36 ff ae a6 72  |...).......6...r|
+00000270  3b 71 4d c7 a2 3b 38 63  be 77 43 67 fb 78 e6 a8  |;qM..;8c.wCg.x..|
+00000280  1d aa 3a 42 f5 47 f8 d4  8d 83 f7 f0 93 ba 90 6d  |..:B.G.........m|
+00000290  25 65 e1 49 f5 3e fe e9  76 ea fb 23 38 6f b2 8f  |%e.I.>..v..#8o..|
+000002a0  3c 72 d3 fc 85 92 a0 d1  11 7c 6a 0b 0f 31 5d 8b  |<r.......|j..1].|
+000002b0  ab 61 bf 8b 06 a5 54 06  ff a0 70 da 38 e0 58 3d  |.a....T...p.8.X=|
+000002c0  d1 79 2b d8 ea 93 b2 0f  11 02 24 46 7f 27 e1 22  |.y+.......$F.'."|
+000002d0  42 b2 39 86 c7 08 62 5f  d4 18 0b 8b e3 40 80 76  |B.9...b_.....@.v|
+000002e0  f0 ad 86 48 54 52 d8 7a  ff da 3a 3a 93 d5 46 b5  |...HTR.z..::..F.|
+000002f0  67 0d 17 b3 43 c2 e3 73  de 49 cf a4 35 b8 17 db  |g...C..s.I..5...|
+00000300  ea 2c 8d e8 ba 1f a6 b2  a6 91 26 19 a2 b8 95 17  |.,........&.....|
+00000310  03 03 00 a3 d2 c7 70 d0  6d ab a9 63 7e 35 b4 a4  |......p.m..c~5..|
+00000320  7c 32 ea c9 25 83 88 3d  1a e3 a5 5e b9 7e 60 99  ||2..%..=...^.~`.|
+00000330  23 5e 28 13 61 77 ad e7  74 34 4c c8 60 7a a0 07  |#^(.aw..t4L.`z..|
+00000340  c7 e8 6e cd a2 03 33 62  43 dc 24 e8 1e 43 07 c3  |..n...3bC.$..C..|
+00000350  95 89 26 e4 7c 86 43 26  08 08 bc 62 74 1a d7 50  |..&.|.C&...bt..P|
+00000360  8d 43 e6 2b fe 47 8e 35  4c 09 99 7d 02 cc a8 51  |.C.+.G.5L..}...Q|
+00000370  ae 87 79 5e e1 c9 88 f2  1a 40 74 4b 72 3b b0 07  |..y^.....@tKr;..|
+00000380  0b 4a c2 df b4 ad 7a 07  c2 18 fa 53 4d 3d e7 19  |.J....z....SM=..|
+00000390  54 62 eb d1 da 5e 9f 0d  3a a2 a1 72 a3 aa 77 2b  |Tb...^..:..r..w+|
+000003a0  21 59 aa cb a1 f3 4a b6  e5 b2 bb 81 3d 1c c1 9b  |!Y....J.....=...|
+000003b0  ef 1b e2 cd 73 67 18 17  03 03 00 35 29 3e 2e 10  |....sg.....5)>..|
+000003c0  4a ba 5a 91 7b d1 b9 0e  d1 98 5e 95 4d 1c 7f 77  |J.Z.{.....^.M..w|
+000003d0  6e eb b9 8c 95 ce d4 04  5c 69 8f 7e 48 89 30 2b  |n.......\i.~H.0+|
+000003e0  71 27 a3 54 c2 b7 f2 ad  23 7b ee 64 88 a0 0d 75  |q'.T....#{.d...u|
+000003f0  76                                                |v|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 02 11 77 e3 de 64 ac  |...........w..d.|
-00000010  38 0a da af 1f ce 7a 60  a6 34 74 5b 5f d5 c1 72  |8.....z`.4t[_..r|
-00000020  7f b9 4f e8 19 26 35 c2  9a 0a d5 19 50 72 72 b3  |..O..&5.....Prr.|
-00000030  de 05 ac 50 78 2a 69 8a  7f c2 5c d0 a5 58 70 b6  |...Px*i...\..Xp.|
-00000040  18 86 f5 92 83 20 fc d5  fb fc 28 89 a0 5c 5e d3  |..... ....(..\^.|
-00000050  d2 c8 d7 6e 31 47 a0 bc  9a f0 e6 75 be 55 a4 43  |...n1G.....u.U.C|
-00000060  b0 e5 42 f6 66 f0 2c dd  ce 9c 35 3d 93 a9 af 85  |..B.f.,...5=....|
-00000070  1c df 81 5f a3 19 95 45  ec 18 ce 92 91 4e 7c 59  |..._...E.....N|Y|
-00000080  12 dd b5 45 44 9d 1c b2  d3 53 a4 5b ce b6 49 c1  |...ED....S.[..I.|
-00000090  1d 22 27 73 1f f3 46 ba  05 fd 2d ac d2 ae 9b 7a  |."'s..F...-....z|
-000000a0  33 d6 9d a9 fd 29 f7 d9  57 69 91 36 10 f7 93 50  |3....)..Wi.6...P|
-000000b0  b1 c4 88 0b 55 de c4 8e  0f d3 60 9c cb 95 4a 2d  |....U.....`...J-|
-000000c0  35 37 29 03 4f a0 52 33  c9 98 60 88 33 0d f1 68  |57).O.R3..`.3..h|
-000000d0  eb 02 f7 15 70 36 d7 86  38 18 ce 89 e5 39 2e c0  |....p6..8....9..|
-000000e0  ca 23 07 2b f3 74 df 77  bc 48 5e db a4 c3 7e 68  |.#.+.t.w.H^...~h|
-000000f0  8c b3 53 c4 69 b3 45 db  be c5 04 b9 00 9e 3c 48  |..S.i.E.......<H|
-00000100  35 82 60 1f d1 74 44 ef  7d 1e 0a 9b 72 3d 67 e5  |5.`..tD.}...r=g.|
-00000110  42 e7 4d 88 49 8e f3 a4  57 4b d5 12 ff ce 1b 49  |B.M.I...WK.....I|
-00000120  6e 7f e0 52 f8 8d 70 70  1d f9 44 55 5b ec 97 ed  |n..R..pp..DU[...|
-00000130  d5 00 20 38 b7 07 ea 89  2f b8 e9 2f 50 e2 64 38  |.. 8..../../P.d8|
-00000140  cc 7c b8 97 d5 44 15 13  50 05 e4 83 d9 da c5 a4  |.|...D..P.......|
-00000150  d5 fe c1 b6 94 16 73 04  97 78 86 b5 84 b4 75 c8  |......s..x....u.|
-00000160  e2 cc 05 4b 66 c7 7f 26  54 82 49 2c 21 4f e2 3e  |...Kf..&T.I,!O.>|
-00000170  2a be 2e 04 7a f5 ee d2  6b 55 f5 3c f8 46 1a 60  |*...z...kU.<.F.`|
-00000180  a4 8d ef bb 3e 5c 35 44  73 4b d7 a9 22 ad 9e cb  |....>\5DsK.."...|
-00000190  95 01 14 2c a2 0f 72 2e  53 64 3f 11 44 9b da fb  |...,..r.Sd?.D...|
-000001a0  d5 be 42 f5 c1 c8 b2 12  6b 3c 00 27 8e 32 a3 2c  |..B.....k<.'.2.,|
-000001b0  7e d9 6f 03 2f 29 c3 84  3d 80 c3 cd a0 88 ef 7b  |~.o./)..=......{|
-000001c0  c7 52 14 2e f5 ba 12 05  1d 57 0d a9 57 7d 6b e8  |.R.......W..W}k.|
-000001d0  07 09 8a 73 9e 17 30 3a  23 b5 2b 7c 20 f0 11 8b  |...s..0:#.+| ...|
-000001e0  50 0c 56 d3 35 9c d9 46  53 f2 dc 8a 76 41 7b d8  |P.V.5..FS...vA{.|
-000001f0  d7 4b d7 c1 29 c8 41 46  a7 0a 30 85 a4 a8 d4 64  |.K..).AF..0....d|
-00000200  93 13 fc 47 88 46 0d f7  fe ae cb 0a 55 89 64 c8  |...G.F......U.d.|
-00000210  ab 0b 7f bb a1 d9 7c a4  56 fb ee 1f 17 03 03 00  |......|.V.......|
-00000220  99 85 55 c5 ed 66 4f 93  f3 7a 7c 96 5e 75 1e 34  |..U..fO..z|.^u.4|
-00000230  b1 3a ba b6 e7 2e de 4c  b4 2f 06 ee fe a7 14 f8  |.:.....L./......|
-00000240  32 3b 20 cf 9d 93 16 2a  80 e7 cc 46 de 13 f8 7e  |2; ....*...F...~|
-00000250  0b 83 69 de 4c 7d f2 cd  5e 23 30 8b 38 b9 68 cb  |..i.L}..^#0.8.h.|
-00000260  fe d9 dd ed e3 ad 59 50  71 6b f3 9c ce 6c 89 01  |......YPqk...l..|
-00000270  cc 89 ed b0 71 87 10 c4  0b 47 45 c9 4f 16 b8 2d  |....q....GE.O..-|
-00000280  88 41 6e 5e 4e 26 fa 28  10 e5 f3 74 ed a1 ba 17  |.An^N&.(...t....|
-00000290  cd 58 fa 60 26 f0 64 6f  61 51 0d 51 b3 32 bd 8e  |.X.`&.doaQ.Q.2..|
-000002a0  8a e7 8f b2 f6 c7 30 d3  22 a7 1e 0d 15 aa 64 db  |......0.".....d.|
-000002b0  26 11 e1 38 73 ee 29 b9  1f 34 17 03 03 00 35 cb  |&..8s.)..4....5.|
-000002c0  c3 5c e5 0f 1a 9b dd 44  04 89 12 b5 a2 7d 30 8f  |.\.....D.....}0.|
-000002d0  bd 67 6a 98 f0 f9 f9 7d  01 66 6e 28 05 45 56 89  |.gj....}.fn(.EV.|
-000002e0  df 1f ba b8 1e 22 56 e1  e3 1c 1c dc dd 01 53 ed  |....."V.......S.|
-000002f0  50 39 3e c2 17 03 03 00  17 c2 af ed 30 35 b0 dd  |P9>.........05..|
-00000300  99 be 51 2a dd b8 68 2c  62 ac c2 a8 38 d0 a5 53  |..Q*..h,b...8..S|
->>> Flow 4 (server to client)
-00000000  17 03 03 02 da 67 9d 9c  f7 2d bf 7b bb 80 c0 6d  |.....g...-.{...m|
-00000010  d5 18 94 70 77 34 15 6e  81 08 7b db 88 77 80 ee  |...pw4.n..{..w..|
-00000020  d6 a6 ce 4e 7d 49 87 5e  05 b5 e5 9c cc 36 82 c2  |...N}I.^.....6..|
-00000030  eb 9b 42 ed 9b 5d 6b ac  35 21 29 76 6c 84 a6 e2  |..B..]k.5!)vl...|
-00000040  29 f8 74 3d b9 c3 0e 24  45 88 c5 19 19 e1 64 35  |).t=...$E.....d5|
-00000050  a2 71 a5 42 c0 9c cc f3  51 93 f1 e5 c4 29 09 a6  |.q.B....Q....)..|
-00000060  6f bc 47 e6 ba cf 5b 64  0e 18 e1 dd e8 4f d5 59  |o.G...[d.....O.Y|
-00000070  b3 84 0d 70 12 51 9c fc  f8 51 ff 53 30 e3 a7 0d  |...p.Q...Q.S0...|
-00000080  89 82 ce 0f ff 33 b8 e8  24 5b 35 fa 56 47 11 b3  |.....3..$[5.VG..|
-00000090  77 10 c6 f6 3e a6 d0 e7  82 42 5e c0 5b 4a 1d 43  |w...>....B^.[J.C|
-000000a0  0e 84 77 29 c0 69 fe 42  d5 e1 3d 86 f2 c9 1b fe  |..w).i.B..=.....|
-000000b0  f1 54 f6 0f 8a 48 04 c4  5b d6 11 30 68 ce e6 fd  |.T...H..[..0h...|
-000000c0  59 78 18 14 a4 ce 5a 12  ec a3 31 b6 6f de 42 07  |Yx....Z...1.o.B.|
-000000d0  e1 e6 04 da d3 33 28 ef  ab 21 f2 d1 5e e3 9e 91  |.....3(..!..^...|
-000000e0  89 ad e4 12 b4 5b 11 2c  19 7e c7 d4 40 60 17 3a  |.....[.,.~..@`.:|
-000000f0  37 9a fa 62 44 fa 7e 36  1b bc 0c 55 dd f2 f3 d3  |7..bD.~6...U....|
-00000100  94 9c 6b 63 36 06 e0 ae  48 41 1c b5 c5 b7 03 bd  |..kc6...HA......|
-00000110  6e da 0d 68 4d 22 e9 7c  29 ad eb 85 9d 0b 85 14  |n..hM".|).......|
-00000120  2e 0d 3a 1f 23 08 cf e9  57 38 a8 ae 48 a0 3b af  |..:.#...W8..H.;.|
-00000130  e6 1f 83 6f d3 e1 d2 ae  42 14 af 50 1c 4a 51 fd  |...o....B..P.JQ.|
-00000140  68 1d ad d7 71 2a 0f 16  52 07 8b f9 d0 48 c0 33  |h...q*..R....H.3|
-00000150  4e 24 85 e0 61 26 28 db  44 93 86 78 74 02 1c 48  |N$..a&(.D..xt..H|
-00000160  1e cd 2a 7b 33 b3 08 f3  ba af 71 c7 f1 d8 af 46  |..*{3.....q....F|
-00000170  d8 88 dd 22 cc d7 d8 96  98 ca 20 d1 5c 7a 59 ab  |..."...... .\zY.|
-00000180  df 66 0b 59 05 40 92 7b  8f 78 ac 67 90 d5 eb 24  |.f.Y.@.{.x.g...$|
-00000190  4a 05 c3 5f cc 64 7d 26  30 2a 25 d8 8e b5 e6 a6  |J.._.d}&0*%.....|
-000001a0  b2 85 a3 cf d4 04 1e d8  92 bc 8e 2b ad c0 ff 52  |...........+...R|
-000001b0  79 8b 82 55 cd 39 7d 8e  a5 4c dc bf 81 ac 1a e6  |y..U.9}..L......|
-000001c0  ed df 61 c8 ad 70 dc 75  5b cc e9 a7 8d 96 74 a7  |..a..p.u[.....t.|
-000001d0  7a 94 3c 60 65 1c 7f e1  89 2d c0 80 5f 2f fd 9c  |z.<`e....-.._/..|
-000001e0  66 2f ad 73 c3 96 8d 74  c6 cd 68 74 39 49 87 4c  |f/.s...t..ht9I.L|
-000001f0  2c 77 3c c4 c5 4e 9a 71  1e 69 86 3a fb a8 d2 e2  |,w<..N.q.i.:....|
-00000200  9d 63 60 e5 f7 d2 63 a8  f2 5b f7 cb 57 32 00 be  |.c`...c..[..W2..|
-00000210  f2 f3 9c ae a5 f1 9d 05  be 8a c1 ed 8f f9 d0 51  |...............Q|
-00000220  85 5e ca ce 92 45 ca b4  ce 6e 26 11 9d 94 38 22  |.^...E...n&...8"|
-00000230  40 34 dc bc a0 34 f6 48  26 38 7a 59 f8 c8 d6 c4  |@4...4.H&8zY....|
-00000240  35 24 82 96 19 49 bb 24  5f 25 fc c2 a0 b7 89 4f  |5$...I.$_%.....O|
-00000250  8f 71 e1 c6 da 4f 96 fa  3f 5c 73 96 41 86 1c 9d  |.q...O..?\s.A...|
-00000260  9a eb 7a fa bc 59 e9 4c  09 cf e5 95 33 27 7a a6  |..z..Y.L....3'z.|
-00000270  61 fc ff 39 38 1e 65 79  75 48 b0 48 66 bd ad 77  |a..98.eyuH.Hf..w|
-00000280  4a d3 ce 91 65 e4 72 51  87 88 8a 2a b7 55 c4 46  |J...e.rQ...*.U.F|
-00000290  cc 35 ef d4 aa fc bb 70  36 10 7f f3 2e 8c a0 2f  |.5.....p6....../|
-000002a0  7e 14 f3 c0 5d 18 55 71  bd e9 36 dc 2f a6 9b c1  |~...].Uq..6./...|
-000002b0  b5 c5 64 f7 6e a5 8e 93  71 c6 3e ef ef c1 34 2b  |..d.n...q.>...4+|
-000002c0  f6 9b e7 ad ff a0 ec 14  0d ce 6c c7 c5 b6 c2 c2  |..........l.....|
-000002d0  a4 de d3 b9 1e d9 0c f4  67 9a 33 fe f7 35 84 17  |........g.3..5..|
-000002e0  03 03 02 da 81 75 4f 5f  38 a9 da c7 88 88 09 ee  |.....uO_8.......|
-000002f0  fd fc 5b 2a de 6c a7 d4  59 20 69 0b 5f 77 e9 9c  |..[*.l..Y i._w..|
-00000300  59 bd ed 59 d6 f2 5a 43  49 1b 0c 9a 4a ca e8 bb  |Y..Y..ZCI...J...|
-00000310  d1 d7 65 55 98 ec 0b 6b  22 a3 3e f1 12 23 d3 f2  |..eU...k".>..#..|
-00000320  cc e3 b9 cf 0f 4a 9b 16  a1 09 69 71 75 90 0d 85  |.....J....iqu...|
-00000330  37 90 de c9 c1 0a b2 af  aa 1c e9 96 17 49 11 01  |7............I..|
-00000340  74 f1 23 39 ea cb 33 d1  45 af ae 2a 11 59 7f 4a  |t.#9..3.E..*.Y.J|
-00000350  fb 57 ba ef 32 13 a1 ca  9c 31 d1 a8 6a c8 67 de  |.W..2....1..j.g.|
-00000360  13 46 60 76 4c cf be 6c  45 ae e8 29 9f 34 e9 a6  |.F`vL..lE..).4..|
-00000370  0a ed ff 8a 47 67 76 ac  a0 6a 02 1f 77 28 a2 fd  |....Ggv..j..w(..|
-00000380  fa c1 ff 43 a6 23 54 0b  c2 53 cb 1e f1 ba 4c a1  |...C.#T..S....L.|
-00000390  55 ec af b6 b3 be 4a 2a  26 21 d1 68 b5 f5 cd da  |U.....J*&!.h....|
-000003a0  c4 14 8c 5c 5e 13 31 35  d5 e8 44 a8 ff 08 bc 79  |...\^.15..D....y|
-000003b0  91 a0 42 21 67 09 fc d2  b9 95 d6 b1 da c8 75 9e  |..B!g.........u.|
-000003c0  d7 77 81 cb 35 34 29 c4  c8 62 c3 cd d4 9d 68 5f  |.w..54)..b....h_|
-000003d0  7e 14 7a 63 d9 84 22 6f  7e e8 5b f9 b5 94 ab 81  |~.zc.."o~.[.....|
-000003e0  fc 02 0a 37 6b 71 28 25  fb f6 ab 62 a2 8d 09 73  |...7kq(%...b...s|
-000003f0  74 84 39 dd 25 e8 a3 f7  bc dc 11 4a 51 41 31 05  |t.9.%......JQA1.|
-00000400  63 8e 92 48 5a a4 81 63  4c 3a 59 96 9f 55 3f fd  |c..HZ..cL:Y..U?.|
-00000410  fb 68 6a dc 6c e2 69 79  20 b5 1e b7 08 a1 71 a9  |.hj.l.iy .....q.|
-00000420  62 64 f3 5e ea dc 46 25  02 fe 3b ce b3 6e 81 de  |bd.^..F%..;..n..|
-00000430  31 e0 e3 d4 89 39 91 0b  60 dc b5 46 f6 e9 f8 92  |1....9..`..F....|
-00000440  d7 f0 00 aa 2c 4a d8 fc  fb 11 c5 cf 21 d9 0f 8e  |....,J......!...|
-00000450  49 92 57 53 9c 5a 0e 2a  05 e5 e3 88 6d dd 4f 84  |I.WS.Z.*....m.O.|
-00000460  f7 45 d5 aa a0 ff a5 c7  fb f3 77 76 35 a8 01 b2  |.E........wv5...|
-00000470  f6 95 2f e8 f7 b8 87 94  22 d6 ad 11 dc 73 47 b3  |../....."....sG.|
-00000480  5f ac ac 6f 34 84 d9 ca  50 a9 de 06 49 c7 3a 41  |_..o4...P...I.:A|
-00000490  d1 bc be c9 4f 7a 7d 6a  1e dc 51 ca f1 b9 20 f7  |....Oz}j..Q... .|
-000004a0  f9 04 d3 d1 05 0a 36 cf  28 bd 6f 71 6e 9c fb a8  |......6.(.oqn...|
-000004b0  7e 88 df 6e b3 e9 5f 7a  46 34 60 96 24 a3 f1 1d  |~..n.._zF4`.$...|
-000004c0  bd cb 34 fa 0d 54 91 03  01 9b 5d d5 95 e6 51 0d  |..4..T....]...Q.|
-000004d0  21 d0 99 c3 4f 3f bf 49  64 a8 5b 5d 46 e9 a4 ed  |!...O?.Id.[]F...|
-000004e0  09 c9 21 4f 13 60 34 51  db d8 44 d5 d3 84 59 6d  |..!O.`4Q..D...Ym|
-000004f0  8b 73 67 4e fc e3 8b 27  64 89 a3 12 6f fd 4b 27  |.sgN...'d...o.K'|
-00000500  a0 80 a1 61 46 9c 16 2a  1f 22 31 a3 3c 9a 4b 7b  |...aF..*."1.<.K{|
-00000510  cc 25 9d 83 33 9f 62 0f  55 8a 7e 8a 2b 3b b8 7c  |.%..3.b.U.~.+;.||
-00000520  3d 50 3d 85 ed 98 68 8d  e9 7f 70 f9 2e 56 79 fa  |=P=...h...p..Vy.|
-00000530  39 53 59 74 f9 fb a2 47  fb 22 39 10 c7 03 6c 78  |9SYt...G."9...lx|
-00000540  b5 7e b8 4e c2 3f 09 38  36 f9 b5 a6 2a 2a 33 aa  |.~.N.?.86...**3.|
-00000550  9b c6 29 db df 07 d7 f1  db 09 88 27 07 70 95 b2  |..)........'.p..|
-00000560  a9 ce 9d 2d 25 23 cb 8f  67 6b 2f cc 3b 01 9c c3  |...-%#..gk/.;...|
-00000570  04 7c ce ed 8b c0 e7 ed  4d 6f a9 1e 7e 87 26 e0  |.|......Mo..~.&.|
-00000580  6c ed 02 93 5e 89 91 2b  f8 5c ac 37 e3 6c 0d 71  |l...^..+.\.7.l.q|
-00000590  2d 13 42 28 b2 db c5 75  9d 93 da 6e b2 11 89 f6  |-.B(...u...n....|
-000005a0  c8 33 1a 22 92 fe 60 3f  c0 d2 79 f1 ca 5f 7f 3c  |.3."..`?..y.._.<|
-000005b0  21 a6 21 b8 01 f3 d8 c9  5a 27 04 0b 7c 18        |!.!.....Z'..|.|
->>> Flow 5 (client to server)
-00000000  17 03 03 00 13 27 46 19  d1 26 45 d8 b4 49 5c 53  |.....'F..&E..I\S|
-00000010  7a 0c 87 9c 73 0d 3a af                           |z...s.:.|
+00000000  14 03 03 00 01 01 17 03  03 02 11 1d fa f6 f0 5f  |..............._|
+00000010  36 d9 1a b8 03 4b b5 2e  ba ca 43 ea 31 c2 08 05  |6....K....C.1...|
+00000020  e5 a1 55 2e 93 82 3b d5  5a b3 ca fe 11 92 9a 30  |..U...;.Z......0|
+00000030  7e d8 02 b4 95 29 8f 29  ba b5 34 22 97 99 bc a9  |~....).)..4"....|
+00000040  43 1f 18 5c e2 26 7e 2e  5d ff 2c 68 86 82 7c da  |C..\.&~.].,h..|.|
+00000050  7e da c5 46 21 69 37 3b  f5 65 a4 cd 70 ed e3 c8  |~..F!i7;.e..p...|
+00000060  47 21 88 8d 45 3a 0f c9  1e 37 a9 0a 6e 2e 59 0e  |G!..E:...7..n.Y.|
+00000070  1b 6b 08 22 10 81 74 00  0c 15 6f c6 1e a0 2d 60  |.k."..t...o...-`|
+00000080  b1 c6 ec 65 ff 91 16 1a  e4 18 86 1b 43 04 dc b1  |...e........C...|
+00000090  a0 f2 1d e8 4e 46 72 84  20 14 75 1e 72 52 1b 46  |....NFr. .u.rR.F|
+000000a0  1f 8a ed 08 c8 e0 07 1b  6d e3 44 68 ec 52 74 d5  |........m.Dh.Rt.|
+000000b0  8d 7f 41 96 b4 77 01 25  0c 1f aa 50 2f 8b d7 1a  |..A..w.%...P/...|
+000000c0  77 1b 24 01 0b 1f 0f c2  0f e1 00 db 0a 28 e9 c5  |w.$..........(..|
+000000d0  a7 22 a2 fd c2 98 c5 69  51 91 d4 55 0f 52 da 33  |.".....iQ..U.R.3|
+000000e0  47 f2 34 bd 06 bb 22 53  55 8c 6c e1 95 b5 0f b8  |G.4..."SU.l.....|
+000000f0  e5 8a 64 51 50 47 5d ca  5b 1a 20 22 99 b2 d4 74  |..dQPG].[. "...t|
+00000100  9e 6b 01 44 6b 7c 40 a0  e3 95 eb 96 53 c0 8d c0  |.k.Dk|@.....S...|
+00000110  c1 e1 2b 21 04 f1 64 03  ba 0f d9 34 57 f2 2e 62  |..+!..d....4W..b|
+00000120  5e f6 69 d6 86 3e f0 00  96 ca b7 ed 7d b4 1c 79  |^.i..>......}..y|
+00000130  f3 ea f4 10 79 d2 6d 6e  49 6c e4 32 c1 81 da 9d  |....y.mnIl.2....|
+00000140  cc 59 ea 41 3f 1e 62 34  61 6b 0e a4 07 4f ef f7  |.Y.A?.b4ak...O..|
+00000150  a3 31 ee 52 14 60 4c 06  5c 69 49 8e 6a ab e9 94  |.1.R.`L.\iI.j...|
+00000160  bf cc a5 12 b7 94 10 87  2f cc d8 40 b1 f3 a9 27  |......../..@...'|
+00000170  97 5c 7f 85 f9 14 dd e0  66 27 9e 3d f4 eb 75 ab  |.\......f'.=..u.|
+00000180  1d 1a c0 c3 72 af 6e 13  bb 24 ac fe f0 fb 47 d0  |....r.n..$....G.|
+00000190  1d 79 37 70 86 d3 43 9b  64 8c d0 f5 2b a8 7a 77  |.y7p..C.d...+.zw|
+000001a0  4a e7 92 a3 bf 1e db 22  5a 40 39 07 76 1c 71 de  |J......"Z@9.v.q.|
+000001b0  9c ff 75 b7 0d 6e 3e 14  69 8d 08 e5 f3 24 ae 6a  |..u..n>.i....$.j|
+000001c0  61 f3 dd a7 57 52 9e da  f1 de aa 07 11 65 41 64  |a...WR.......eAd|
+000001d0  61 57 23 71 47 aa 8e 47  9c 5f 99 84 90 2d 9a fd  |aW#qG..G._...-..|
+000001e0  5b 15 27 44 41 5c a0 41  87 05 8a 53 8f ed 93 22  |[.'DA\.A...S..."|
+000001f0  50 15 b4 60 55 c7 78 20  b5 d8 dd 9d 5d 8c 69 bc  |P..`U.x ....].i.|
+00000200  74 da d6 a6 a6 86 fe 93  e1 48 48 f2 f0 36 93 86  |t........HH..6..|
+00000210  d6 62 9d 09 3a 19 f7 9d  01 9b 87 85 17 03 03 00  |.b..:...........|
+00000220  99 37 bf 65 e8 18 ef 10  d7 02 e2 73 3f 13 4a 6f  |.7.e.......s?.Jo|
+00000230  ea f0 e2 c8 a3 fc a4 3a  d2 ea 96 2d 77 cb cc b3  |.......:...-w...|
+00000240  1d 8a 77 4d 97 a6 e9 6e  6e b5 af 67 d1 e4 e6 be  |..wM...nn..g....|
+00000250  0b 05 b1 da 15 83 ca af  19 cf 57 60 05 16 47 bd  |..........W`..G.|
+00000260  ce 94 f9 bf 48 5c 2c 38  57 57 c3 39 9b 84 19 59  |....H\,8WW.9...Y|
+00000270  db fc 09 06 29 4d e7 71  be d4 86 12 fa 8e 54 e8  |....)M.q......T.|
+00000280  b0 7e 79 56 dc b2 7a 30  08 e2 8b c7 fa 46 ce 84  |.~yV..z0.....F..|
+00000290  d3 3e 6d 1c 8d 4c 5e 76  c7 d2 1d 8b 85 5d be a3  |.>m..L^v.....]..|
+000002a0  1b d8 92 72 6d b1 73 d9  b4 a7 14 00 58 80 79 a9  |...rm.s.....X.y.|
+000002b0  75 55 96 af d9 d2 20 92  ef ca 17 03 03 00 35 b0  |uU.... .......5.|
+000002c0  fe 3f 36 6e 82 b5 d3 7c  e9 7b 75 d6 b1 4d f6 7b  |.?6n...|.{u..M.{|
+000002d0  d0 10 68 32 9a 7b 04 69  38 bf a2 42 1b 3d 14 75  |..h2.{.i8..B.=.u|
+000002e0  31 00 90 d4 1b b1 bf 5b  76 65 50 42 21 60 75 30  |1......[vePB!`u0|
+000002f0  f9 b8 ee 45 17 03 03 00  17 0b b8 78 9e a2 94 45  |...E.......x...E|
+00000300  47 f4 8e af 08 d0 80 75  09 7b c6 44 45 82 19 30  |G......u.{.DE..0|
+00000310  17 03 03 00 13 0e fb b9  24 58 7c ab 97 b3 6e 2e  |........$X|...n.|
+00000320  55 50 ff 05 5d 04 dc 72                           |UP..]..r|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-RSAPSS b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-RSAPSS
index 495f9ff124..d2092baa8c 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-RSAPSS
+++ b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-RSAPSS
@@ -16,215 +16,121 @@
 000000e0  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
 000000f0  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 63 54 7d 13 b3  |....z...v..cT}..|
-00000010  e2 34 2b ce 4b 8e 0a 74  db b8 ef cd f9 6e 3f cf  |.4+.K..t.....n?.|
-00000020  01 22 34 82 8a 44 42 65  2e 5f 3d 20 00 00 00 00  |."4..DBe._= ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 01 26 b2 48 f5  |....z...v...&.H.|
+00000010  b7 cc 24 54 75 e5 9d cd  17 e1 02 e4 2d e1 32 28  |..$Tu.......-.2(|
+00000020  4e 19 1e 6d 8a 1e 3f 0e  37 3c 5f 20 00 00 00 00  |N..m..?.7<_ ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 01 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 d6  |..+.....3.$... .|
-00000060  4b 8a 50 d0 fb 13 86 36  0b a1 52 2a a3 e4 f9 4f  |K.P....6..R*...O|
-00000070  57 35 33 a7 d4 6d 4f 84  fc 83 58 78 d9 85 0c 14  |W53..mO...Xx....|
-00000080  03 03 00 01 01 17 03 03  00 17 1f 19 9a c9 99 fd  |................|
-00000090  a7 26 d2 26 17 74 5a 9c  69 92 c5 d0 bc 40 6f f2  |.&.&.tZ.i....@o.|
-000000a0  6d 17 03 03 00 20 f9 64  91 4c cd 2c 70 2e 09 4f  |m.... .d.L.,p..O|
-000000b0  89 52 61 ac 1c 1d a4 f6  45 30 c3 59 eb 6d ba 83  |.Ra.....E0.Y.m..|
-000000c0  17 53 34 54 98 37 17 03  03 02 7a 9e 5b 62 72 9f  |.S4T.7....z.[br.|
-000000d0  4f 8c 72 a7 1a a7 b4 ac  72 36 b2 21 8c 91 a3 4b  |O.r.....r6.!...K|
-000000e0  a4 ed 5d f7 a7 0b 68 c1  db 68 40 04 6f 3e b6 3c  |..]...h..h@.o>.<|
-000000f0  4c 67 84 d1 b1 9b d8 84  e3 28 b8 09 6e 7a 6d 6a  |Lg.......(..nzmj|
-00000100  91 d3 80 af 4b 2d b5 4e  0c ed 81 90 75 2e f8 1c  |....K-.N....u...|
-00000110  7f d3 c9 99 6e ba ff 42  eb 05 fb c6 5a f7 7b 5a  |....n..B....Z.{Z|
-00000120  14 c9 52 21 a6 44 a5 0c  9f 37 bb 78 c1 d9 e8 7b  |..R!.D...7.x...{|
-00000130  f3 44 84 06 32 a0 67 af  d1 5c 03 f8 2b e4 5a c5  |.D..2.g..\..+.Z.|
-00000140  18 be 1e bd dd 0c c4 84  0d 23 5e fd 2f f8 c9 4d  |.........#^./..M|
-00000150  86 e0 eb 41 66 0d de dd  ab 6f 6c 9c 4e ab b0 14  |...Af....ol.N...|
-00000160  a8 7c 6a 95 c9 02 30 df  9f 5a 45 4a 66 1e b4 15  |.|j...0..ZEJf...|
-00000170  c0 ba cb 47 7b a1 4f ab  df 81 f5 9a 2a 42 3a 1b  |...G{.O.....*B:.|
-00000180  35 f7 5b b1 c7 43 c1 b8  5a 1e b6 74 43 d8 97 2c  |5.[..C..Z..tC..,|
-00000190  63 7e 7d dd 37 77 0e 36  3f 2e cf 84 12 20 a6 5c  |c~}.7w.6?.... .\|
-000001a0  34 eb 09 25 03 89 47 89  9e cb 46 74 b9 21 2a 5f  |4..%..G...Ft.!*_|
-000001b0  63 fc 8e 2d f4 9f a6 4a  41 bf b8 3a a6 a1 7c 33  |c..-...JA..:..|3|
-000001c0  1c 86 52 b0 ff a0 66 3d  39 55 36 e5 89 21 2f c4  |..R...f=9U6..!/.|
-000001d0  3a 07 81 75 6d 62 15 9a  94 2b 5a f5 01 43 c3 a8  |:..umb...+Z..C..|
-000001e0  b6 7d 71 3c 4d 96 8d e3  3a 3f 6f 33 5f 63 01 7d  |.}q<M...:?o3_c.}|
-000001f0  15 1b be 3a 80 a3 f7 e3  52 85 be 3e a8 cf ac ff  |...:....R..>....|
-00000200  23 d7 d2 ca 3d 6e e5 71  34 14 02 71 b1 20 e9 05  |#...=n.q4..q. ..|
-00000210  2a b6 cc 50 a5 9c b3 ca  f7 f7 b4 fc ef 24 4d 47  |*..P.........$MG|
-00000220  e7 8c 0f f7 36 90 4c b5  c5 70 07 f7 33 c8 0f 42  |....6.L..p..3..B|
-00000230  f9 e1 00 11 d8 ba 71 31  44 a5 84 15 56 d3 0b ec  |......q1D...V...|
-00000240  78 38 f4 ed 74 df e4 67  33 7f e8 1a c5 70 af 1e  |x8..t..g3....p..|
-00000250  65 f6 26 f0 02 e0 71 c0  89 48 96 06 92 b7 12 21  |e.&...q..H.....!|
-00000260  bd b5 e0 30 c0 bd 5f ed  55 6b fa 3f c3 b6 30 2e  |...0.._.Uk.?..0.|
-00000270  d2 71 4f a3 45 f8 f8 ec  de 23 28 0a 43 ae 73 69  |.qO.E....#(.C.si|
-00000280  4c a1 d7 02 12 e8 f4 b6  7d 6c 3b 0f 7f 31 a8 dd  |L.......}l;..1..|
-00000290  41 f0 06 29 19 de b3 56  61 b0 55 6a bc b3 71 e7  |A..)...Va.Uj..q.|
-000002a0  13 02 d6 cc ae 60 c1 32  5d be 8f 32 c0 21 95 b9  |.....`.2]..2.!..|
-000002b0  e6 c6 cb 97 d9 66 12 a2  03 fb 3d 9d 15 dd 19 ef  |.....f....=.....|
-000002c0  62 f5 80 4f b9 27 e8 73  a3 21 57 04 bd 61 4e c8  |b..O.'.s.!W..aN.|
-000002d0  44 93 3b 8c a3 32 39 ac  73 98 36 ba da 64 f4 33  |D.;..29.s.6..d.3|
-000002e0  54 e9 ba ec f0 1d 75 74  ab 9b 18 dd c9 96 c6 66  |T.....ut.......f|
-000002f0  a5 e3 48 47 76 f9 24 1d  f7 84 05 33 d7 d8 ac 02  |..HGv.$....3....|
-00000300  02 a4 65 14 7f 63 46 aa  cd 6f ce 1a ab 5a bc 48  |..e..cF..o...Z.H|
-00000310  15 db 93 55 9b 1f a8 b0  d7 ab 51 ab 8f 0d 0e 04  |...U......Q.....|
-00000320  f3 4e 73 92 76 89 1c e4  0f 9d 00 19 6a 2b a1 6c  |.Ns.v.......j+.l|
-00000330  aa d9 21 df e5 c8 9d 6c  bc 93 f2 0c 0c f6 86 c3  |..!....l........|
-00000340  26 37 53 af f0 17 03 03  00 99 cd cf 63 df fd 8b  |&7S.........c...|
-00000350  a7 90 61 f2 37 21 17 d4  a7 c4 20 7c e3 16 2d 9b  |..a.7!.... |..-.|
-00000360  c4 c1 6a 87 2d 63 55 7e  17 ef aa f1 6d fe d1 37  |..j.-cU~....m..7|
-00000370  f8 90 0d 34 db 45 20 6e  73 0d f1 eb 2d d4 6b 4a  |...4.E ns...-.kJ|
-00000380  23 f9 d5 5f 49 75 4d 02  b0 39 fd ee ef f5 65 08  |#.._IuM..9....e.|
-00000390  d8 f6 ce fa 2a 3c 20 41  1f 5d 38 cc b4 39 0b 52  |....*< A.]8..9.R|
-000003a0  29 93 0b ce 4c c4 7a 7c  92 81 8b ca 0b 5e 31 8f  |)...L.z|.....^1.|
-000003b0  6d 06 03 6f 25 19 52 f3  8f 3a 47 33 9b 15 d5 4f  |m..o%.R..:G3...O|
-000003c0  c8 db 6a fe fb d1 9e 32  ab 2e b2 10 83 20 c3 34  |..j....2..... .4|
-000003d0  f8 35 62 fc 30 99 9a 72  ff 57 33 fd 73 0c 08 bc  |.5b.0..r.W3.s...|
-000003e0  d4 da f0 17 03 03 00 35  27 67 18 21 60 ca 5f e5  |.......5'g.!`._.|
-000003f0  33 00 27 83 87 7c df 42  12 ba 89 78 eb b8 fa 6e  |3.'..|.B...x...n|
-00000400  a1 65 f4 33 e8 e8 99 c6  4f 71 a0 ff b8 08 5b 02  |.e.3....Oq....[.|
-00000410  1b 82 b6 58 e2 d7 d7 e5  72 1b 81 a4 93           |...X....r....|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 67  |..+.....3.$... g|
+00000060  35 32 50 33 37 9b 04 46  e4 7d 40 53 9d 3b c3 53  |52P37..F.}@S.;.S|
+00000070  6d 16 d3 7a 95 ec 2b 09  37 ff 01 55 60 9c 53 14  |m..z..+.7..U`.S.|
+00000080  03 03 00 01 01 17 03 03  00 17 b9 d8 da 19 0a e9  |................|
+00000090  37 9a 76 b8 b1 e6 38 27  83 aa 0a 3a d5 cc 9a 25  |7.v...8'...:...%|
+000000a0  1c 17 03 03 00 20 17 a1  70 92 5e 78 bf 9f e3 0c  |..... ..p.^x....|
+000000b0  cc e8 a3 6d c9 ba 77 e1  b5 0c 4b 1e 84 08 04 33  |...m..w...K....3|
+000000c0  88 a3 05 4a e2 6a 17 03  03 02 7a f0 39 57 69 59  |...J.j....z.9WiY|
+000000d0  dd 3d b1 be 1a 06 fc 7b  21 a1 7a cb b9 6e f6 ce  |.=.....{!.z..n..|
+000000e0  62 13 c8 b6 b3 85 b2 93  22 ab 5c f2 32 a2 af 32  |b.......".\.2..2|
+000000f0  42 d1 c0 94 08 f4 ba 1f  bb d9 16 f7 2b 40 8d dd  |B...........+@..|
+00000100  43 a2 80 0e 3a e4 ff 2d  a3 18 59 b4 08 88 46 bf  |C...:..-..Y...F.|
+00000110  bb 46 58 82 b2 db 98 c0  9f 3a f8 c4 71 f0 87 ac  |.FX......:..q...|
+00000120  c5 ee 30 ea c4 b2 63 ee  d0 cb 17 06 5c 80 19 3a  |..0...c.....\..:|
+00000130  bc f8 07 a1 e8 47 b4 b2  77 e0 14 ea 5d 16 c1 31  |.....G..w...]..1|
+00000140  e6 34 bc 50 92 1a e8 9f  e5 e9 0d 60 af 00 ad 9b  |.4.P.......`....|
+00000150  e3 10 bc 64 bd d4 c0 35  e8 26 67 df fb 3d d4 e8  |...d...5.&g..=..|
+00000160  11 f2 24 13 d9 fb 68 5d  69 ce 23 98 07 e8 4a 4a  |..$...h]i.#...JJ|
+00000170  d9 d1 a7 b1 63 e1 01 08  ae e5 d1 57 1c e6 9a 5a  |....c......W...Z|
+00000180  ac 4a f8 f7 9a 33 51 d1  3b 68 42 1a 0d e0 08 f3  |.J...3Q.;hB.....|
+00000190  a1 ea 83 5c 8f 95 7f ee  bb 45 e3 72 72 2c a0 39  |...\.....E.rr,.9|
+000001a0  86 f1 e0 58 6c 82 01 b0  3c 17 09 82 f3 d9 99 0c  |...Xl...<.......|
+000001b0  24 33 7d 50 b0 b7 84 3e  9b 91 a8 1f 91 02 95 aa  |$3}P...>........|
+000001c0  44 b6 de 0e 35 e1 b7 f6  ca 73 f8 6f f4 5a 21 db  |D...5....s.o.Z!.|
+000001d0  d6 f8 04 88 4e d6 04 7c  67 93 22 9a ff d0 0e 79  |....N..|g."....y|
+000001e0  e6 cb b2 03 b9 f2 46 27  a3 1a 89 2e 8f 46 4f c5  |......F'.....FO.|
+000001f0  4a ad 09 e7 79 38 a4 84  43 19 c9 1f 62 a0 5a 4a  |J...y8..C...b.ZJ|
+00000200  fa e4 98 14 e7 34 a6 3f  07 93 ab 6a fb 1c 3e 1f  |.....4.?...j..>.|
+00000210  a2 82 0a 42 43 d7 ef e7  aa fa 42 e0 be a1 dd 4e  |...BC.....B....N|
+00000220  2e 9e 49 da 81 da bc 5f  40 fa f8 00 99 19 d0 13  |..I...._@.......|
+00000230  50 77 8b c5 69 f0 ec 7c  bd 2d 9e c5 66 16 56 ca  |Pw..i..|.-..f.V.|
+00000240  bd 51 67 7b 87 5e 1f 4d  21 05 30 72 ac a8 ab 13  |.Qg{.^.M!.0r....|
+00000250  12 dd 4c f7 e0 cc 95 c3  3e f0 94 95 40 ea c5 f1  |..L.....>...@...|
+00000260  31 f9 53 32 40 64 5f c8  29 52 7a d6 22 5c 2d e8  |1.S2@d_.)Rz."\-.|
+00000270  f9 eb f8 b9 e6 66 09 48  ad ed 73 6a 42 bc a8 7c  |.....f.H..sjB..||
+00000280  d6 f9 62 45 25 f6 bf 8a  56 13 b4 50 cb 1b 5e 8b  |..bE%...V..P..^.|
+00000290  92 f3 9d 50 fc 7d 3c e4  b1 55 ae b2 3f 6a a8 a2  |...P.}<..U..?j..|
+000002a0  f1 dd 83 9a 97 0e 3f 93  a9 6d 94 e5 cc a9 53 14  |......?..m....S.|
+000002b0  24 44 80 28 a2 6a 21 57  07 63 96 78 3f 05 40 7d  |$D.(.j!W.c.x?.@}|
+000002c0  be 83 b2 b8 b3 0a 58 a7  50 29 dc bb b1 7f c6 c7  |......X.P)......|
+000002d0  4b 5a ff 95 4a c8 50 0b  8e 44 ec 9b 0f 95 ac 8f  |KZ..J.P..D......|
+000002e0  f9 b3 19 d0 aa a6 67 f8  ce dc 67 34 0e c9 98 98  |......g...g4....|
+000002f0  82 b1 54 4a a0 0e 02 d7  02 d3 36 06 4d 51 6f e4  |..TJ......6.MQo.|
+00000300  f5 68 ff 4d 8f 00 94 a6  6b 6c 33 41 31 1a 9e 2c  |.h.M....kl3A1..,|
+00000310  f5 df 4a 43 b7 00 01 5b  6e 59 af 9c 9f bb c5 37  |..JC...[nY.....7|
+00000320  22 32 35 25 bf 69 0a 9d  75 7e aa 19 b9 4e b1 17  |"25%.i..u~...N..|
+00000330  cb f8 b5 8f 0f 81 9c df  b1 ce a0 5b f2 ed df 20  |...........[... |
+00000340  5a bd 8a 88 b1 17 03 03  00 99 15 09 f2 8d 63 c0  |Z.............c.|
+00000350  f2 00 9f e8 1a d3 0f cc  35 0b ce eb 3c 45 87 59  |........5...<E.Y|
+00000360  d9 8f f1 59 08 00 2f 6f  67 78 30 b4 cc f9 bb 7c  |...Y../ogx0....||
+00000370  ef ab 74 f5 23 fb 3d d3  95 98 2a 39 31 8b a9 88  |..t.#.=...*91...|
+00000380  12 18 36 c7 aa 7c 5c bf  16 44 b5 69 ff e4 91 96  |..6..|\..D.i....|
+00000390  c8 f9 c0 3b d2 50 18 18  21 d1 6a 36 12 2d 8c 08  |...;.P..!.j6.-..|
+000003a0  40 64 c2 cd b0 ee 73 31  ac f3 18 9f c6 d0 23 b7  |@d....s1......#.|
+000003b0  c1 bf 99 a6 62 d6 b8 6c  0e 96 2a 99 fe aa 58 60  |....b..l..*...X`|
+000003c0  3c c7 60 d6 05 64 6b 68  62 62 38 13 1e fc a9 4f  |<.`..dkhbb8....O|
+000003d0  ad e9 99 4e 7f b0 70 7d  38 79 d9 c7 d5 39 84 a8  |...N..p}8y...9..|
+000003e0  4e 63 66 17 03 03 00 35  fd 5c 31 7d ad c3 bf a2  |Ncf....5.\1}....|
+000003f0  a9 d8 15 8f aa 72 e9 db  f4 4c e7 19 e0 ca 98 65  |.....r...L.....e|
+00000400  8f 0e ac d9 e9 12 c7 37  cf 6e 0e 68 64 6e cd 29  |.......7.n.hdn.)|
+00000410  94 05 63 79 9c c6 c7 17  5a 26 c1 6f 3b           |..cy....Z&.o;|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 02 11 5e 13 11 0e f1  |...........^....|
-00000010  96 10 11 c9 e7 a3 dc 79  80 fc 2a a9 60 55 07 b2  |.......y..*.`U..|
-00000020  59 b3 69 97 2f ef 14 58  9b 64 a3 19 71 fa ce 8b  |Y.i./..X.d..q...|
-00000030  86 34 92 82 f4 cd 17 c1  45 2f 69 e9 e7 84 1d 4c  |.4......E/i....L|
-00000040  d0 62 6e 30 40 e6 a7 a6  f1 c6 b2 ce 88 ae 5a 05  |.bn0@.........Z.|
-00000050  06 d2 ab 40 6b d4 17 fa  89 69 41 46 bf 96 23 37  |...@k....iAF..#7|
-00000060  07 04 5d 62 32 98 da db  a4 67 c8 7a 81 55 00 1d  |..]b2....g.z.U..|
-00000070  e2 ce c3 44 2a 24 23 c0  ef aa 8f c6 14 75 fb ad  |...D*$#......u..|
-00000080  bb 4a b5 7d c3 dd 69 29  9b 05 60 80 1c 66 c4 4a  |.J.}..i)..`..f.J|
-00000090  cc 63 fb 8a 8a cf 44 05  80 7f ed 0b c1 e0 8f 14  |.c....D.........|
-000000a0  9b 4b f8 39 f8 03 c2 c5  97 62 61 f5 7b 38 ac 07  |.K.9.....ba.{8..|
-000000b0  2b c5 c6 5a 10 fc 28 20  c7 56 2c c6 92 28 4c dd  |+..Z..( .V,..(L.|
-000000c0  a2 01 f5 90 e2 5b 9b a4  07 ef 28 27 c6 7c fb d1  |.....[....('.|..|
-000000d0  84 2f d4 ab 5d dc 13 a3  49 9d ce c5 3f c6 a4 90  |./..]...I...?...|
-000000e0  43 9c ba c8 96 c7 8b c3  a0 63 e9 99 4f d5 49 a2  |C........c..O.I.|
-000000f0  c2 a8 cd ff 5b e0 fc 29  85 80 bd 62 c1 22 c0 b1  |....[..)...b."..|
-00000100  b8 1d f0 ed d3 17 22 13  5f 06 5d a1 bd 04 ae 34  |......"._.]....4|
-00000110  d1 60 70 ad 60 10 fa da  90 82 87 09 cd 0c f7 aa  |.`p.`...........|
-00000120  1f 10 90 a5 cc b1 44 11  f6 62 92 ed 23 7b 7d 1e  |......D..b..#{}.|
-00000130  90 a1 9c 7b 5a e7 d1 f4  41 8f 8e 1f ba 4e cd 51  |...{Z...A....N.Q|
-00000140  fe 38 f2 f5 3d 6a b3 c9  9b 36 6e 58 ad c3 5c d5  |.8..=j...6nX..\.|
-00000150  54 63 e3 c6 c2 14 96 ee  46 03 cc 14 b9 09 73 0e  |Tc......F.....s.|
-00000160  1c ad 32 12 ba 85 a9 8b  b4 fe cb e9 98 f0 f9 fa  |..2.............|
-00000170  5a 8d 88 79 54 e7 8e e7  c2 ac d9 2a f1 1d b5 39  |Z..yT......*...9|
-00000180  ba 3e f0 af 08 3f f8 50  1d 8c ca 9e b2 47 c3 68  |.>...?.P.....G.h|
-00000190  12 3b 60 38 b0 d8 da b6  15 ff 0e b4 76 28 0f e9  |.;`8........v(..|
-000001a0  56 b3 41 b3 55 68 88 f7  66 41 5c 98 90 5e 10 ad  |V.A.Uh..fA\..^..|
-000001b0  20 82 a3 09 77 fb 45 3d  2c 0e 2c 5b 25 02 94 87  | ...w.E=,.,[%...|
-000001c0  e5 ee 1c a1 05 e3 70 33  7e 9a 16 55 92 35 c2 91  |......p3~..U.5..|
-000001d0  f8 0a 3d 2d f0 af ba e4  93 b3 98 4b 04 6d 6b b3  |..=-.......K.mk.|
-000001e0  ac 76 c8 48 74 84 99 d5  58 95 f1 c7 f6 2c 05 d1  |.v.Ht...X....,..|
-000001f0  7c 47 55 be 90 27 17 df  02 49 a6 b1 4b 92 23 9a  ||GU..'...I..K.#.|
-00000200  12 8a 3a 56 51 e6 4a 92  1c ae 19 de 57 b2 df b0  |..:VQ.J.....W...|
-00000210  df 07 94 a3 e0 ea 81 e3  fc d0 35 2d 17 03 03 00  |..........5-....|
-00000220  99 47 fd c2 4d a0 5f b9  dc 3b 3c ae 1e d7 c5 d6  |.G..M._..;<.....|
-00000230  94 05 6a 61 72 6e b9 29  b7 d4 e2 9b 26 6c 86 94  |..jarn.)....&l..|
-00000240  e0 7f 1d 66 1d 90 bb 09  fd e8 83 32 51 6c a1 96  |...f.......2Ql..|
-00000250  28 c3 5f c0 69 d5 09 00  60 b8 05 de 45 88 51 b8  |(._.i...`...E.Q.|
-00000260  f0 ed 67 57 97 8f b9 82  ed 4b 31 66 f2 7e e5 a4  |..gW.....K1f.~..|
-00000270  92 2b cc 63 b5 98 ea 57  6c 44 51 f6 de ee 3b bf  |.+.c...WlDQ...;.|
-00000280  ac 25 c8 21 a9 74 f8 ca  61 69 93 95 83 c9 f3 da  |.%.!.t..ai......|
-00000290  17 e5 3d 82 05 c2 3f e8  80 92 e0 14 b5 b8 40 63  |..=...?.......@c|
-000002a0  3a e7 cd 39 5e e5 1c a4  31 8a 74 97 1e 16 fb 0a  |:..9^...1.t.....|
-000002b0  2c 0d d5 fa aa b2 4b de  59 56 17 03 03 00 35 ab  |,.....K.YV....5.|
-000002c0  07 57 5c 79 b1 5f 13 6a  37 e7 a4 a1 97 0c 87 cb  |.W\y._.j7.......|
-000002d0  84 1e fd d7 15 ec 37 c4  18 83 41 c7 c1 26 cf 1b  |......7...A..&..|
-000002e0  43 5e 2a 06 1b be 66 42  84 46 f5 e0 d6 a7 83 cf  |C^*...fB.F......|
-000002f0  08 d9 30 a6 17 03 03 00  17 dc b8 10 ea ce 82 16  |..0.............|
-00000300  ff ce bc 5f 46 5d d0 61  9b dd bf 64 54 8e 54 b1  |..._F].a...dT.T.|
->>> Flow 4 (server to client)
-00000000  17 03 03 02 da ad f0 96  2c a1 08 c0 c7 aa 43 b8  |........,.....C.|
-00000010  23 65 61 d2 4b 56 54 a2  0c d4 31 12 5d 19 ac 38  |#ea.KVT...1.]..8|
-00000020  b3 bd 72 1f e4 40 39 5d  a5 95 85 93 ff 53 63 0a  |..r..@9].....Sc.|
-00000030  df 7f 79 39 07 75 c2 18  ef 4e 20 6b d6 81 6c 91  |..y9.u...N k..l.|
-00000040  63 9a d8 45 99 2c ed e7  19 8e 4b 2d 06 c9 60 7e  |c..E.,....K-..`~|
-00000050  3b e7 68 bd 35 13 bb be  57 4a 43 01 74 3c 92 b6  |;.h.5...WJC.t<..|
-00000060  f9 c3 6d 0f 26 80 3f 3d  5b 86 10 27 d8 51 71 d1  |..m.&.?=[..'.Qq.|
-00000070  ad 5d d4 3d 8c 66 e7 db  9d 6f fe e2 f2 4e 56 7a  |.].=.f...o...NVz|
-00000080  76 02 94 d9 95 0f 64 8e  6b 89 b0 8c 82 c3 eb 22  |v.....d.k......"|
-00000090  1d 15 64 5a e7 3c bd 3d  64 0b 44 3c 6e 13 79 27  |..dZ.<.=d.D<n.y'|
-000000a0  d5 21 85 89 6c a3 89 dc  c8 6c ac cb 86 54 83 38  |.!..l....l...T.8|
-000000b0  7a 5b d2 d0 3e f2 62 88  2f 3f 1c b5 d5 60 d4 35  |z[..>.b./?...`.5|
-000000c0  f6 8e 2e 7d ec 17 32 f6  f4 99 b5 8c 6d b2 e6 ba  |...}..2.....m...|
-000000d0  29 1a 85 c0 1c ea 8c 2d  f2 b3 14 53 13 5d e9 2d  |)......-...S.].-|
-000000e0  db d5 7f 41 89 86 a6 88  e5 56 82 ba 6d 67 6a 33  |...A.....V..mgj3|
-000000f0  02 f6 b9 6c 5b 89 02 4e  5e df d1 c4 46 61 69 08  |...l[..N^...Fai.|
-00000100  18 91 6b 98 d1 97 bd 6c  d4 71 d9 91 c6 9c d6 58  |..k....l.q.....X|
-00000110  51 4a 34 72 34 be 59 50  4d 49 0c 60 d2 c1 bd d6  |QJ4r4.YPMI.`....|
-00000120  54 5d 8e 3f db ec b1 9a  f8 84 ce 69 ef 58 f0 63  |T].?.......i.X.c|
-00000130  17 2b fe 30 df 57 e4 c1  42 1f 1f 49 8d a1 9d d7  |.+.0.W..B..I....|
-00000140  82 b9 c8 36 59 4e f9 31  2b 3e 49 17 5d ac 30 9e  |...6YN.1+>I.].0.|
-00000150  1d a4 04 84 1b 88 51 47  4e a1 b6 5a 12 72 8f 1a  |......QGN..Z.r..|
-00000160  22 96 1c 7c a7 11 33 4c  40 33 03 cd ba fb 2d 4e  |"..|..3L@3....-N|
-00000170  8d d4 20 bd c8 d8 32 ab  81 fd c1 a5 a6 9e bf 4a  |.. ...2........J|
-00000180  26 69 be d8 62 b2 12 a8  4a 1b 44 42 20 1e fc 7d  |&i..b...J.DB ..}|
-00000190  de f1 3f f6 0e cb 3d 2a  2e d7 91 9a 74 d7 c9 24  |..?...=*....t..$|
-000001a0  35 9e c9 78 d4 b0 d0 9d  43 60 45 e3 9b 91 5a a5  |5..x....C`E...Z.|
-000001b0  47 cc 4e 1f 4b e6 ce 9a  b3 ae 3f bd ca 2b 79 cd  |G.N.K.....?..+y.|
-000001c0  e1 e7 10 bb 80 fc f2 93  7c d5 b5 5b e0 51 88 94  |........|..[.Q..|
-000001d0  53 4f 99 a6 f0 29 fa 11  56 3b 01 12 6b b1 24 5a  |SO...)..V;..k.$Z|
-000001e0  08 19 1f ed f1 c6 3a 09  ad bf d6 e3 37 17 1a e0  |......:.....7...|
-000001f0  00 8a de 74 ad 3e 2f 99  e7 f4 3f fe 6d 9a a4 5a  |...t.>/...?.m..Z|
-00000200  de 5b 8a 17 86 60 0f 91  43 77 b7 34 9a f1 fb d0  |.[...`..Cw.4....|
-00000210  34 df 0d 08 47 5a 47 f1  e4 43 86 d8 1e dd c0 7e  |4...GZG..C.....~|
-00000220  63 13 8f f3 01 a1 e1 70  d7 1b 9a 2b 82 3d c4 87  |c......p...+.=..|
-00000230  af 6c 9d d2 bb f2 cd da  8e c6 e3 5b 19 ae 31 75  |.l.........[..1u|
-00000240  1c b5 01 51 c9 38 1c 29  ca f5 8a a5 51 14 a4 e4  |...Q.8.)....Q...|
-00000250  fe 46 86 47 c4 a1 7c 56  a0 e2 6e 50 f5 7a 15 1a  |.F.G..|V..nP.z..|
-00000260  6d 9f 6c 43 24 ce 9e 1e  b2 8a f9 da 2e d3 6a 81  |m.lC$.........j.|
-00000270  5d 14 97 75 44 f1 ba 81  55 0a 38 64 1f 40 7b 4a  |]..uD...U.8d.@{J|
-00000280  23 47 13 7e cd f7 6d 67  45 7f c7 4d 42 59 ad 42  |#G.~..mgE..MBY.B|
-00000290  e1 67 53 25 dc e1 8e 56  f4 cc 14 00 9b d0 e2 d5  |.gS%...V........|
-000002a0  b9 bf fa de 74 39 60 4f  24 7c 51 5e a0 34 05 53  |....t9`O$|Q^.4.S|
-000002b0  23 01 b9 50 f4 f7 39 c2  f3 e1 62 5d d3 2a 43 98  |#..P..9...b].*C.|
-000002c0  32 3e 3d 40 39 32 8b 6f  db 77 53 ec ac 1e a3 95  |2>=@92.o.wS.....|
-000002d0  24 b5 88 f8 62 e9 f7 a5  a3 20 8a be 02 8a 58 17  |$...b.... ....X.|
-000002e0  03 03 02 da 51 d2 ea aa  e4 a6 65 20 5c c2 70 aa  |....Q.....e \.p.|
-000002f0  75 4e c1 40 69 7b 49 d7  25 65 a0 97 1e 69 5d d6  |uN.@i{I.%e...i].|
-00000300  99 cf 32 fc 4c 3d 6b 6d  b9 e5 db 20 ed 00 00 93  |..2.L=km... ....|
-00000310  6d 6a 24 8a 2f 85 49 5b  2d 18 a8 08 ac a2 b2 4f  |mj$./.I[-......O|
-00000320  c5 52 4a 2f 94 7b d5 c4  87 21 0f 60 c6 c9 fd 06  |.RJ/.{...!.`....|
-00000330  69 66 b8 8d 43 83 be 4e  64 23 e9 d8 01 02 af af  |if..C..Nd#......|
-00000340  cf 1d 8b 7d e7 38 c8 31  30 f7 e8 9f 17 46 35 9b  |...}.8.10....F5.|
-00000350  72 ba 65 6d 18 bd 0e b7  5e ec 3f c5 f5 f1 c0 dd  |r.em....^.?.....|
-00000360  a1 3d 1c 41 ca eb 0a 7e  f9 ab a1 2e 32 be 60 79  |.=.A...~....2.`y|
-00000370  0f 28 1d fa 4a 62 ff 4f  0b ba 84 a1 63 fa 4a 07  |.(..Jb.O....c.J.|
-00000380  02 d4 7c bf 42 90 1b 38  cc 21 71 1e 70 f7 65 a3  |..|.B..8.!q.p.e.|
-00000390  b5 a7 1e 54 47 ec 7f 65  8e 8f 3c 95 dc ee af 21  |...TG..e..<....!|
-000003a0  52 7a 05 a6 51 5e 1c aa  cd 5d 45 2f 11 31 2f 9a  |Rz..Q^...]E/.1/.|
-000003b0  cb e6 92 cd 21 b4 18 c1  12 bc 3c 9e d7 3b 3f 42  |....!.....<..;?B|
-000003c0  b6 df b4 4e cc af 22 9e  c3 5d 2d 2c 75 b6 0b 00  |...N.."..]-,u...|
-000003d0  3d cf bb 3b 2a 14 70 49  f2 e7 c2 07 be 16 ca 83  |=..;*.pI........|
-000003e0  b1 27 da 78 8b f0 b6 ef  2a e0 8f cb 50 f5 89 47  |.'.x....*...P..G|
-000003f0  30 f6 84 57 21 de 33 e7  fb 58 26 6a 3f 3b 72 2b  |0..W!.3..X&j?;r+|
-00000400  23 a4 09 41 41 a8 86 bd  c9 af 78 53 23 94 e6 6c  |#..AA.....xS#..l|
-00000410  87 1c f8 e9 96 b0 0e 37  b8 13 96 12 05 60 97 9e  |.......7.....`..|
-00000420  c7 d2 a3 33 4b 68 49 d4  b7 99 3c 94 c9 57 72 de  |...3KhI...<..Wr.|
-00000430  5a ff 9d ef 55 7b b9 35  e3 e1 13 ad 53 90 6e cf  |Z...U{.5....S.n.|
-00000440  2f 82 79 dd 95 ce b3 4d  5b c9 b3 3e 5e af 75 85  |/.y....M[..>^.u.|
-00000450  9b c0 58 96 40 f9 28 04  0b 28 64 c4 9d f4 fa 9c  |..X.@.(..(d.....|
-00000460  ea 59 1a c2 db 98 13 8d  5f 8b f5 32 2d ab a6 70  |.Y......_..2-..p|
-00000470  36 0d c8 f6 98 84 88 e8  31 23 c5 18 29 59 1a 5a  |6.......1#..)Y.Z|
-00000480  14 d3 fc 69 47 95 6d f9  a8 51 12 4a 91 9c 19 23  |...iG.m..Q.J...#|
-00000490  64 1b 96 5c a3 45 c4 ef  58 22 9c e2 08 46 fd 23  |d..\.E..X"...F.#|
-000004a0  3d fd e6 a2 5e 42 90 ac  a0 ad 8f 27 2f 8a e8 97  |=...^B.....'/...|
-000004b0  fa b9 72 a1 28 9a 71 87  68 9a ae 73 bb bc b3 6f  |..r.(.q.h..s...o|
-000004c0  cb c4 48 0c a8 50 b5 2d  ad f0 ca 1e d6 0f 7e 9a  |..H..P.-......~.|
-000004d0  56 ad 3e 98 43 f4 7e 56  57 7f 79 6e 9a 99 15 62  |V.>.C.~VW.yn...b|
-000004e0  98 a6 78 2e ce 18 3c 21  a5 66 7b c5 3c a1 48 49  |..x...<!.f{.<.HI|
-000004f0  df 7d d9 c0 15 4f 3f 18  fc 31 7b 31 08 0b f8 25  |.}...O?..1{1...%|
-00000500  fc 0f fb 85 92 7a 3b 33  dd 09 6b 64 f4 e7 e8 9c  |.....z;3..kd....|
-00000510  f4 8c 73 9d 3b 44 c4 7b  f7 4c 5e 30 25 c2 b9 2e  |..s.;D.{.L^0%...|
-00000520  e2 07 2d 32 4f e0 67 d4  60 18 ea de a1 f9 51 e8  |..-2O.g.`.....Q.|
-00000530  b2 4e c7 c3 c9 51 c6 aa  e2 69 88 9b fe 94 8c 02  |.N...Q...i......|
-00000540  a1 a6 3a a9 b9 e3 32 bc  9f 5d 37 6e dd 99 68 37  |..:...2..]7n..h7|
-00000550  14 67 ae 22 20 28 be 0b  fe 86 65 84 ca f1 96 a3  |.g." (....e.....|
-00000560  d5 89 c2 ea 38 1b 8b 9b  94 e2 c1 88 bb 92 3c b0  |....8.........<.|
-00000570  82 d3 cb ab a0 13 23 58  e5 ab c8 f6 84 93 3c 6b  |......#X......<k|
-00000580  03 b3 85 eb 74 8e 9b 78  22 c0 82 21 72 08 71 fd  |....t..x"..!r.q.|
-00000590  9d 3e 62 e8 d8 50 99 7f  bb 8d 4e 95 7d 3a 64 07  |.>b..P....N.}:d.|
-000005a0  71 5c 16 4a d0 66 bc 0b  cc b6 ba bd 53 ff b7 f5  |q\.J.f......S...|
-000005b0  05 c6 e1 31 0b 18 69 74  e5 63 95 7d 34 cd        |...1..it.c.}4.|
->>> Flow 5 (client to server)
-00000000  17 03 03 00 13 8e f7 f6  9b 86 95 cc d0 fb 93 36  |...............6|
-00000010  11 5a a4 7d 85 aa c7 c6                           |.Z.}....|
+00000000  14 03 03 00 01 01 17 03  03 02 11 7e e6 cb d5 bf  |...........~....|
+00000010  e1 5f 0a a5 6f 08 47 a4  27 a0 a0 2d 8e 6b 56 c6  |._..o.G.'..-.kV.|
+00000020  2e d4 7d 3d 83 f0 25 31  59 9d e5 61 a0 95 21 2e  |..}=..%1Y..a..!.|
+00000030  f8 39 8c 16 4b 6e d9 e0  19 23 05 b0 6c 89 2c f2  |.9..Kn...#..l.,.|
+00000040  e2 60 fb 83 99 2b 33 37  38 b0 85 67 cf 91 5f 22  |.`...+378..g.._"|
+00000050  32 8b 10 f6 0b 2b 0d 4a  18 32 e7 41 fc 07 58 54  |2....+.J.2.A..XT|
+00000060  d1 e2 6e da bb f7 4a 45  60 34 02 01 95 5e b3 4f  |..n...JE`4...^.O|
+00000070  0a df 33 d6 07 06 fc 20  5a 97 2f b8 bf 66 23 40  |..3.... Z./..f#@|
+00000080  32 24 0d f5 c8 a2 aa e4  6a 85 21 d5 a3 95 a8 3b  |2$......j.!....;|
+00000090  8f 6a 43 5c 96 64 80 ef  04 ed a4 10 2f e4 a8 8d  |.jC\.d....../...|
+000000a0  ff fb 77 53 28 30 cd ca  df 8e 25 08 51 ee 56 b8  |..wS(0....%.Q.V.|
+000000b0  3a ae 2f 27 a4 4a 71 9e  77 cc 70 af 62 d1 a7 2f  |:./'.Jq.w.p.b../|
+000000c0  2b 2f 98 2f e5 62 b5 3b  65 b6 2e a5 a5 19 1f c2  |+/./.b.;e.......|
+000000d0  a9 ef d8 2a 95 25 fc 10  32 31 da 29 bf 7e 58 d0  |...*.%..21.).~X.|
+000000e0  b5 2f 62 bf ed 57 c8 b4  55 85 29 66 07 52 6f 25  |./b..W..U.)f.Ro%|
+000000f0  02 2b 98 22 a5 e8 41 50  de f5 e3 e9 ce 60 f2 af  |.+."..AP.....`..|
+00000100  b3 c8 80 f1 27 2a 04 7a  1f 3b 13 0f 76 ec 6a 74  |....'*.z.;..v.jt|
+00000110  ad a9 8f e9 0d 67 9d 1c  a3 54 b3 14 a0 5c 36 80  |.....g...T...\6.|
+00000120  a7 be 7f 2b d1 89 c0 19  3f 25 c6 7a fd 04 44 c2  |...+....?%.z..D.|
+00000130  18 75 a9 44 7b cc 20 2b  f3 6a 9a e1 cc 4f aa 76  |.u.D{. +.j...O.v|
+00000140  e2 0a 45 75 81 0d d7 72  a1 e7 b2 82 02 77 45 e9  |..Eu...r.....wE.|
+00000150  f8 07 93 8b e5 79 c2 06  65 52 a5 0e 13 73 a7 f6  |.....y..eR...s..|
+00000160  be 85 5c 00 af 90 ed 83  3f b4 53 68 cf 0b b9 a6  |..\.....?.Sh....|
+00000170  06 43 3c 7a 15 6a b1 74  be af 70 3b fa 70 f3 4b  |.C<z.j.t..p;.p.K|
+00000180  d6 f7 92 8a 46 3d 46 f3  27 8b 74 6d c7 9f f4 64  |....F=F.'.tm...d|
+00000190  9b de b3 f7 1d 81 ab 8c  ca 97 fd e1 99 25 23 9f  |.............%#.|
+000001a0  54 15 fa a9 fb ab ba dd  a0 c1 b0 ad b9 4d b3 d6  |T............M..|
+000001b0  82 a1 85 06 d2 11 ff ce  03 e3 26 67 67 0e 59 17  |..........&gg.Y.|
+000001c0  ec f1 10 51 c6 26 6d ef  de e1 38 41 a0 2c 40 64  |...Q.&m...8A.,@d|
+000001d0  76 cf f7 2c 86 1f 26 4b  97 26 3c 10 cd dc 3f 3d  |v..,..&K.&<...?=|
+000001e0  27 92 50 ee d1 aa da 08  2f 01 c8 1c af 1d 39 02  |'.P...../.....9.|
+000001f0  c1 f1 17 19 64 35 70 81  9b f6 74 ec 50 42 95 ad  |....d5p...t.PB..|
+00000200  a0 72 52 67 cd 95 30 2f  c8 ad 47 11 fe 2e 60 20  |.rRg..0/..G...` |
+00000210  2c ea d5 eb 2c a2 82 6b  18 82 95 1e 17 03 03 00  |,...,..k........|
+00000220  99 7f 6a 21 64 26 3c 38  a6 39 72 58 a3 22 3d 69  |..j!d&<8.9rX."=i|
+00000230  89 1c 3d c6 79 4d 1a 92  44 4f ce 25 09 bb 8a c7  |..=.yM..DO.%....|
+00000240  ef 0c 61 85 1f 1a 0d 21  4b bd 8a 1f f9 ee 92 af  |..a....!K.......|
+00000250  78 7f 6f 3b 1b 26 09 fe  b7 fe c0 49 2a ac bf 13  |x.o;.&.....I*...|
+00000260  c3 73 b1 c4 69 bc 4c e6  b6 b5 cd 0c 69 18 57 b8  |.s..i.L.....i.W.|
+00000270  77 5a 21 8c 99 ad 09 14  26 93 fd 2e 60 03 ba 1e  |wZ!.....&...`...|
+00000280  d1 45 db c6 c9 ce c1 5c  06 67 66 68 b5 e8 43 2f  |.E.....\.gfh..C/|
+00000290  f8 ae 73 16 8a 90 75 f2  0d bc f2 6b d1 9d 99 f4  |..s...u....k....|
+000002a0  82 53 4a 54 4f 68 44 53  24 7f b3 b4 c1 4a 5d a0  |.SJTOhDS$....J].|
+000002b0  93 7a 40 12 c0 68 68 15  86 a9 17 03 03 00 35 8e  |.z@..hh.......5.|
+000002c0  86 f7 bc 9e 4e 4f 7c 69  fc 40 be 1e 71 05 42 99  |....NO|i.@..q.B.|
+000002d0  95 04 c0 a8 91 ce b8 e4  90 b9 4a 3a 3b d4 3c 27  |..........J:;.<'|
+000002e0  7b 37 27 80 17 bf 52 17  59 00 8c 67 f1 28 55 f3  |{7'...R.Y..g.(U.|
+000002f0  75 60 1e 25 17 03 03 00  17 0a 37 72 c3 59 07 9b  |u`.%......7r.Y..|
+00000300  5e 22 ec 33 fa 96 3e d2  c5 b7 87 7b 45 e1 52 24  |^".3..>....{E.R$|
+00000310  17 03 03 00 13 3b 43 97  33 75 c2 b6 9a f7 cd 96  |.....;C.3u......|
+00000320  e3 67 b7 2d cf ac d8 0a                           |.g.-....|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ECDSA b/src/crypto/tls/testdata/Client-TLSv13-ECDSA
index 55b8cc5263..96c8e8c1ee 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv13-ECDSA
@@ -16,101 +16,71 @@
 000000e0  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
 000000f0  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 48 a3 75 25 ac  |....z...v..H.u%.|
-00000010  19 49 b6 e7 5a 9a c2 15  3e e3 a6 21 c0 f5 09 40  |.I..Z...>..!...@|
-00000020  b7 ad fc 0c 39 1b 3c 44  36 13 9e 20 00 00 00 00  |....9.<D6.. ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 05 cf 30 74 87  |....z...v....0t.|
+00000010  37 6e f2 12 86 19 bd ec  54 21 42 4c 2d 1a 71 4f  |7n......T!BL-.qO|
+00000020  fe de 90 2b a0 c4 73 d1  3e 57 40 20 00 00 00 00  |...+..s.>W@ ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 01 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 20  |..+.....3.$...  |
-00000060  db 3f 51 79 d2 24 e1 e1  a4 b6 f8 84 2d 25 27 ca  |.?Qy.$......-%'.|
-00000070  9a d2 5e cc 28 ac 5e 74  2a ea 1b 56 28 24 76 14  |..^.(.^t*..V($v.|
-00000080  03 03 00 01 01 17 03 03  00 17 bc dd d4 00 24 28  |..............$(|
-00000090  82 e2 0a 74 8f a6 06 9b  14 2d ca c1 90 6c 1c 8f  |...t.....-...l..|
-000000a0  7f 17 03 03 02 22 f9 8f  72 d6 f1 34 fa 90 0e 42  |....."..r..4...B|
-000000b0  2d 2e a0 1d 9e 1f ce ee  79 af b6 b3 bd c2 6b 8f  |-.......y.....k.|
-000000c0  62 4c 5d 1c 1e 47 a7 77  97 ca 04 c5 16 f8 58 3a  |bL]..G.w......X:|
-000000d0  b7 33 15 bc 5f f0 13 7f  02 4d f2 80 95 84 6f 41  |.3.._....M....oA|
-000000e0  df 03 c8 64 23 91 e5 8c  e9 01 45 fe 8e 37 27 e0  |...d#.....E..7'.|
-000000f0  47 83 43 a2 0f ef 3d eb  11 fb ba 52 2f 8e 43 97  |G.C...=....R/.C.|
-00000100  1b fe 49 28 e7 ce 73 c4  3e 9d 18 9d 34 a4 b4 5e  |..I(..s.>...4..^|
-00000110  ee ec bf e3 75 fc 00 be  b7 0e 80 f8 a2 db 90 a9  |....u...........|
-00000120  62 74 35 c6 8e 36 55 68  4e 6c 94 b6 61 d7 d0 34  |bt5..6UhNl..a..4|
-00000130  e8 83 ae c3 75 2d eb 35  95 d3 5f 28 3e 05 f3 ea  |....u-.5.._(>...|
-00000140  18 76 6b 6d b9 98 c0 d5  ea 6d 62 9b 15 d8 be 55  |.vkm.....mb....U|
-00000150  8c f5 5a 3d 14 81 82 cc  8c 6c 34 2f e8 50 87 ef  |..Z=.....l4/.P..|
-00000160  c6 fe 92 39 e0 f4 6d ca  d1 97 c9 df 81 6d dc 3f  |...9..m......m.?|
-00000170  6f 60 58 30 e1 c7 87 d0  fb 40 f6 ce 44 96 e9 19  |o`X0.....@..D...|
-00000180  21 d3 3a 56 fd c1 60 22  96 f7 d9 07 30 15 40 f9  |!.:V..`"....0.@.|
-00000190  b3 0c 9c cf f7 38 94 43  41 8a 76 92 4a 71 55 22  |.....8.CA.v.JqU"|
-000001a0  8d ce 03 ed 97 98 54 0e  94 8c b7 a4 ee ce d6 60  |......T........`|
-000001b0  5d a2 4e 9f ff e6 90 23  69 b1 a2 0e c5 e7 5b 58  |].N....#i.....[X|
-000001c0  7b d1 13 ba f2 d3 ff 6a  48 ff 77 2d 61 05 4b 15  |{......jH.w-a.K.|
-000001d0  cc 6f 52 4a 69 1c e2 38  b3 2a 96 ff 10 bb 55 02  |.oRJi..8.*....U.|
-000001e0  50 e9 f2 09 92 66 cc 43  ea f4 4e ad aa 18 fc 9b  |P....f.C..N.....|
-000001f0  05 52 3b f1 44 3b 6e 25  47 cd 20 4d 69 86 8b 64  |.R;.D;n%G. Mi..d|
-00000200  61 31 0a 03 92 0e 21 9d  67 d5 af 00 de 88 a4 f5  |a1....!.g.......|
-00000210  3d 3e 45 0f f4 02 15 ae  bf 45 76 80 0d 8d 7a 04  |=>E......Ev...z.|
-00000220  58 d7 e5 5a 81 41 a9 04  7e aa 67 af 27 92 cf 51  |X..Z.A..~.g.'..Q|
-00000230  13 c4 e6 84 2e 28 dc 53  c8 73 11 f9 f7 d9 28 ac  |.....(.S.s....(.|
-00000240  a6 00 af cb 38 bc f2 b7  1c 6d e8 21 f0 6e e5 35  |....8....m.!.n.5|
-00000250  12 c0 a9 57 2f 87 39 bc  a6 7a ab ab 04 02 48 e8  |...W/.9..z....H.|
-00000260  13 a3 20 a4 c9 09 64 b2  2a 66 39 91 d7 3a 7a 41  |.. ...d.*f9..:zA|
-00000270  1c a4 15 4e 84 d3 72 66  31 3a ba 7a b8 18 ee 0c  |...N..rf1:.z....|
-00000280  e2 17 1a 8f f7 af 38 49  e3 4d d7 ed be 7a 1e bd  |......8I.M...z..|
-00000290  ae 70 c1 fc 6a 09 05 29  bb fc 78 5b 8f a4 f7 81  |.p..j..)..x[....|
-000002a0  34 fd ad 9b 22 87 67 15  0f ee d4 99 90 e7 af 4b  |4...".g........K|
-000002b0  14 bd af f3 ab 04 e0 d1  58 f5 34 b2 e1 ee 65 92  |........X.4...e.|
-000002c0  80 05 68 c3 b2 6a bc 6d  17 03 03 00 a4 f4 d6 df  |..h..j.m........|
-000002d0  b6 61 6a c2 6c a6 25 f9  b2 95 8f 73 10 05 e2 63  |.aj.l.%....s...c|
-000002e0  37 22 63 bd 50 af 18 0c  71 17 61 40 c9 a1 b1 6d  |7"c.P...q.a@...m|
-000002f0  d7 a6 2f c6 c2 46 9d 40  06 e3 30 04 e1 d9 97 c1  |../..F.@..0.....|
-00000300  a8 6c ce 97 47 4e 9e 54  bc 8e 2c 77 e8 21 c3 0b  |.l..GN.T..,w.!..|
-00000310  8f 51 0c c2 8f 0d 64 b9  79 26 c0 33 07 e0 df 08  |.Q....d.y&.3....|
-00000320  50 98 26 b1 2b 69 6a 5d  b4 9c b7 4e 20 97 cc d9  |P.&.+ij]...N ...|
-00000330  43 94 9f 4d 2b d1 72 24  a7 a8 3e 7d 9e 84 7a 98  |C..M+.r$..>}..z.|
-00000340  23 64 7b b9 17 15 d6 27  80 6c 60 2d 38 c7 4d cd  |#d{....'.l`-8.M.|
-00000350  9a 87 d6 ab 31 8d 59 62  58 b4 11 f4 2e d5 81 10  |....1.YbX.......|
-00000360  87 e5 58 3e 37 99 37 af  68 6f 11 cc 0b a2 f1 d1  |..X>7.7.ho......|
-00000370  b0 17 03 03 00 35 be f6  19 d0 66 ec cd 14 d5 28  |.....5....f....(|
-00000380  b8 bf 0d f4 37 5d 55 3d  2e 2c 1e 0c 62 0a 49 3e  |....7]U=.,..b.I>|
-00000390  df cf c2 dc 2c 27 df 54  64 67 8d 33 8b f0 b1 50  |....,'.Tdg.3...P|
-000003a0  c5 dd fc 47 5c e7 58 5b  74 57 4b                 |...G\.X[tWK|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 16  |..+.....3.$... .|
+00000060  4c 6f 4f d1 32 2e 2e b5  4c 48 29 0f cb 65 23 b2  |LoO.2...LH)..e#.|
+00000070  ab 2e 41 d8 c4 70 30 88  4f a1 d9 bb 52 e8 35 14  |..A..p0.O...R.5.|
+00000080  03 03 00 01 01 17 03 03  00 17 a7 86 3a 06 dc db  |............:...|
+00000090  c6 bc d5 8e 55 0f 93 b5  fc f4 d4 17 40 dc 3e d7  |....U.......@.>.|
+000000a0  16 17 03 03 02 22 b3 07  3f ab 52 ac c4 0d 50 75  |....."..?.R...Pu|
+000000b0  18 37 a5 f5 4b ba e7 e7  c0 30 3c b4 3f e4 11 2d  |.7..K....0<.?..-|
+000000c0  d1 33 07 a7 9d 41 47 61  40 ec db bb dd 7c 89 7b  |.3...AGa@....|.{|
+000000d0  e4 3e db 5a 30 c6 a3 74  7c 7a b1 53 d2 0a 48 65  |.>.Z0..t|z.S..He|
+000000e0  2c f6 d9 ca b4 f4 88 d2  d8 7e a6 ce b0 30 c6 32  |,........~...0.2|
+000000f0  36 fa 73 b2 0e 39 8e d5  af 41 ab 88 8c 3d d1 56  |6.s..9...A...=.V|
+00000100  2e 7b 7d 93 77 c6 51 66  d6 ed 20 52 a9 b1 98 ae  |.{}.w.Qf.. R....|
+00000110  c9 04 a5 1a 97 36 91 b9  38 39 7c 7c 8c bb 0f 37  |.....6..89||...7|
+00000120  e2 37 9c c0 49 fb a7 59  7d f2 0f 97 ee 15 9c e9  |.7..I..Y}.......|
+00000130  5a 9b 6d fd 7e 36 61 fb  30 69 ea 2f e8 37 70 b0  |Z.m.~6a.0i./.7p.|
+00000140  b5 65 1c 05 25 7a 32 36  6e 24 c9 e2 ca 6c c2 82  |.e..%z26n$...l..|
+00000150  d0 5b 1f 85 ba 1b f0 b2  49 71 2a bd 8d ae 16 95  |.[......Iq*.....|
+00000160  2c b9 ab ce f1 05 47 59  e5 65 02 57 34 85 df 26  |,.....GY.e.W4..&|
+00000170  cf 97 94 29 09 4d aa a6  dd 18 ef 9d 15 38 10 90  |...).M.......8..|
+00000180  ea a3 76 b7 25 c8 9c cd  b6 1e 88 a6 4e b8 b1 34  |..v.%.......N..4|
+00000190  70 1f 7b a1 83 e2 2e 3f  d8 e8 f2 2e 74 f1 93 bc  |p.{....?....t...|
+000001a0  ee 80 8a c3 d0 e0 d2 7a  16 5a 97 a5 57 1c c6 37  |.......z.Z..W..7|
+000001b0  ba 8a cd 07 8f ca 93 3a  d7 57 82 be 69 1d 83 5e  |.......:.W..i..^|
+000001c0  62 0e 65 f3 7f 3b 28 8f  51 f0 96 da 55 4c f5 55  |b.e..;(.Q...UL.U|
+000001d0  60 59 7c c4 61 1f 1d 50  38 09 e0 7b 90 ed b9 35  |`Y|.a..P8..{...5|
+000001e0  4d 70 37 f8 c8 59 09 9e  77 02 27 cc 5a cc 7c 8d  |Mp7..Y..w.'.Z.|.|
+000001f0  a8 cc 83 9d 3d dc e1 85  89 98 65 e9 aa 16 f9 e9  |....=.....e.....|
+00000200  85 f9 ec 6d 28 8d 20 4b  33 01 2f df fb 7d 6c 6e  |...m(. K3./..}ln|
+00000210  b8 28 d4 2e 72 1d af 66  15 1a ff ba bc 68 31 cb  |.(..r..f.....h1.|
+00000220  3e c8 62 d3 3e fd e8 ce  90 bc 30 36 31 e2 6d 47  |>.b.>.....061.mG|
+00000230  06 d4 df ad e8 51 3d 61  b7 8f b6 16 d5 e1 81 ff  |.....Q=a........|
+00000240  c7 ad 99 04 e1 af d0 a8  37 5e 57 44 93 7b e0 6d  |........7^WD.{.m|
+00000250  c2 23 f2 b7 7d 14 41 c6  ab 17 c8 3b de 48 20 73  |.#..}.A....;.H s|
+00000260  78 78 78 4a c4 1f ea 55  11 6e dc 55 48 5d 9b f1  |xxxJ...U.n.UH]..|
+00000270  33 84 17 35 cc b9 8d d4  6e 86 87 f1 c3 ab 31 46  |3..5....n.....1F|
+00000280  79 39 5f 41 19 40 7b 54  44 79 21 25 06 a1 ca 36  |y9_A.@{TDy!%...6|
+00000290  e0 9f d6 70 7c 3f 9f 5c  17 29 cc a3 ed a2 cd 6f  |...p|?.\.).....o|
+000002a0  12 19 d9 89 aa a1 fa 51  53 98 9f 34 d2 75 12 22  |.......QS..4.u."|
+000002b0  ea 63 85 3c 32 c8 cb e2  74 15 13 55 61 a1 80 1f  |.c.<2...t..Ua...|
+000002c0  85 5e 45 95 9c 92 4a 8d  17 03 03 00 a4 e8 50 d5  |.^E...J.......P.|
+000002d0  71 f4 21 a6 79 63 11 6a  8e 5e 3e 5d 96 63 4e 42  |q.!.yc.j.^>].cNB|
+000002e0  08 27 34 b7 4c 36 8a fe  b1 ed f2 f1 3c 72 00 99  |.'4.L6......<r..|
+000002f0  c6 09 9b 19 9c 96 e9 41  7f 09 89 17 ff 48 db 94  |.......A.....H..|
+00000300  f6 17 55 ef b0 48 34 a2  b7 14 b9 e6 b6 74 21 e1  |..U..H4......t!.|
+00000310  48 e2 ed 17 27 b9 93 55  1f b7 84 3a 18 e1 19 16  |H...'..U...:....|
+00000320  4f 5d be d0 59 39 90 be  94 74 e0 ad 79 84 31 01  |O]..Y9...t..y.1.|
+00000330  ab bc f2 34 39 cd 34 e8  f5 a0 00 94 75 0a 3d 78  |...49.4.....u.=x|
+00000340  f7 a2 9b eb ac 0e 5d 1a  ba c1 be 4f 1c 60 65 0d  |......]....O.`e.|
+00000350  2c a2 9c 99 66 d8 31 a0  02 ce bd 27 99 9c e3 48  |,...f.1....'...H|
+00000360  0a 1f 8c 65 24 a9 b6 de  bf d2 e7 66 fe 43 d3 8d  |...e$......f.C..|
+00000370  ea 17 03 03 00 35 d1 19  b3 a5 0c 0e 63 4d 32 bf  |.....5......cM2.|
+00000380  49 85 97 14 ac 78 ab e7  cc 59 48 96 d2 3c 66 0f  |I....x...YH..<f.|
+00000390  5e a2 a9 30 2a 3e 97 44  ab c0 68 1a 53 f9 71 41  |^..0*>.D..h.S.qA|
+000003a0  61 17 e3 da 92 ff 5a 8f  21 06 f5                 |a.....Z.!..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 2d 01 39 11 82  |..........5-.9..|
-00000010  67 c7 e5 db 3f dd 18 c3  0b 0a 25 8a 24 2e e1 f4  |g...?.....%.$...|
-00000020  5e a2 0f 8a 1c 70 83 26  d0 5d b1 8d cf c6 69 a9  |^....p.&.]....i.|
-00000030  38 8c 14 22 74 4a 85 fe  f5 86 e6 c2 07 44 bf 87  |8.."tJ.......D..|
-00000040  17 03 03 00 17 a8 2f 45  46 d9 59 7e 5f 4c 9e 46  |....../EF.Y~_L.F|
-00000050  09 e4 38 e1 e3 e3 5e ab  62 14 eb 2f              |..8...^.b../|
->>> Flow 4 (server to client)
-00000000  17 03 03 00 da 41 7f 38  18 5c d5 fc c7 ba 60 66  |.....A.8.\....`f|
-00000010  d6 92 60 81 83 bc f3 35  ff 00 ef 4b 99 48 de 1c  |..`....5...K.H..|
-00000020  aa 1c f8 80 6d 59 48 30  83 03 ad fd e3 15 23 16  |....mYH0......#.|
-00000030  aa c8 d7 71 58 df 65 fc  8c d3 77 56 f4 19 f2 5e  |...qX.e...wV...^|
-00000040  c2 d5 15 1b b7 9a 46 68  81 68 c6 2b be 81 f2 f5  |......Fh.h.+....|
-00000050  5a 71 81 55 10 0f 09 9a  9a 9e c4 be 28 db fa 50  |Zq.U........(..P|
-00000060  f6 fa 88 5b c6 63 35 77  8c d0 1b 4a 50 b8 42 6d  |...[.c5w...JP.Bm|
-00000070  5d f5 b7 5a 5e 73 0f 12  ba 86 92 44 23 bc 70 e1  |]..Z^s.....D#.p.|
-00000080  3d f4 1b 20 87 e6 c2 89  43 2a 76 7f e3 8f 2c db  |=.. ....C*v...,.|
-00000090  86 31 4a 38 5b 5e 44 3e  6c 72 be 13 a5 77 d2 90  |.1J8[^D>lr...w..|
-000000a0  95 80 35 c6 c9 1b 0e ea  b8 0a 18 65 78 23 e4 0e  |..5........ex#..|
-000000b0  bc 67 86 5b 6a 77 32 66  f3 38 89 01 86 d3 c2 3e  |.g.[jw2f.8.....>|
-000000c0  93 70 57 11 07 1a be 26  3c 69 f8 8b 3b c3 4a 1c  |.pW....&<i..;.J.|
-000000d0  e5 bf 9c 48 20 6b 9c 91  eb ff 14 af 44 93 35 17  |...H k......D.5.|
-000000e0  03 03 00 da 42 0b c1 73  60 66 cf c6 f1 25 bc d2  |....B..s`f...%..|
-000000f0  da 72 0b 8d aa 32 82 35  70 3a e2 fa 4c 30 fd d4  |.r...2.5p:..L0..|
-00000100  12 3c 29 a5 41 71 7e e9  3a 64 61 7d e6 c3 60 3f  |.<).Aq~.:da}..`?|
-00000110  d8 e3 db b4 f9 f6 59 02  96 e3 2a 2a d1 96 70 8e  |......Y...**..p.|
-00000120  98 ec a0 84 79 46 53 3c  b1 0b a5 d8 78 6b 82 06  |....yFS<....xk..|
-00000130  43 af 5a 5a 68 b6 4e 6d  30 eb 81 63 1a 2d 72 0a  |C.ZZh.Nm0..c.-r.|
-00000140  0e 2b 68 b4 20 12 77 ef  9b d6 c4 f0 4a 59 47 86  |.+h. .w.....JYG.|
-00000150  05 59 9e 68 25 54 8d 72  04 bf 50 cf 44 0a fc 0c  |.Y.h%T.r..P.D...|
-00000160  6a bf af 26 08 7d e6 c4  3b 69 a5 7f f0 11 0c 7f  |j..&.}..;i......|
-00000170  87 bf 84 02 7b af 2e 03  35 c4 d3 36 aa da 4a e7  |....{...5..6..J.|
-00000180  eb 77 23 bd 4d e6 df 08  2a 76 47 6b 7d 04 42 20  |.w#.M...*vGk}.B |
-00000190  be 82 51 d3 af df 98 c1  6e 5d 21 da a0 da 7c 5c  |..Q.....n]!...|\|
-000001a0  29 ee 62 bb a3 aa f8 76  09 77 f4 5c 56 94 75 27  |).b....v.w.\V.u'|
-000001b0  30 4a 60 18 e8 67 9f 7d  38 ec 34 6d 9c 0e        |0J`..g.}8.4m..|
->>> Flow 5 (client to server)
-00000000  17 03 03 00 13 d2 5d 20  07 4c 51 50 40 86 e8 36  |......] .LQP@..6|
-00000010  59 ba c4 f6 13 ab 29 1f                           |Y.....).|
+00000000  14 03 03 00 01 01 17 03  03 00 35 a3 d4 49 e5 82  |..........5..I..|
+00000010  8d 09 1b 33 8a 0d 9b 4f  8d a8 95 66 0e 50 e0 85  |...3...O...f.P..|
+00000020  a7 0d f2 09 f6 05 44 f5  59 c3 48 92 9d 80 a7 db  |......D.Y.H.....|
+00000030  d0 18 7e 7b 5c fa 31 bf  c5 94 71 60 cf 0c d1 c7  |..~{\.1...q`....|
+00000040  17 03 03 00 17 f7 61 d6  c4 fa 7f 34 e7 cf cb b0  |......a....4....|
+00000050  9f 5d 13 25 8c 75 6c 1a  87 91 44 84 17 03 03 00  |.].%.ul...D.....|
+00000060  13 89 68 71 8d be 27 8e  31 f5 ca 7a 4e c5 b6 38  |..hq..'.1..zN..8|
+00000070  b2 68 b8 0d                                       |.h..|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ExportKeyingMaterial b/src/crypto/tls/testdata/Client-TLSv13-ExportKeyingMaterial
index 2045af72f4..a30a26249b 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ExportKeyingMaterial
+++ b/src/crypto/tls/testdata/Client-TLSv13-ExportKeyingMaterial
@@ -16,107 +16,75 @@
 000000e0  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
 000000f0  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 da 33 a6 d1 76  |....z...v...3..v|
-00000010  5f 72 df d4 59 9b 94 e8  e3 04 a6 c3 f0 58 4d 44  |_r..Y........XMD|
-00000020  08 e8 1e 41 c0 25 4c 0c  de c0 36 20 00 00 00 00  |...A.%L...6 ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 fe a9 2f 00 0c  |....z...v..../..|
+00000010  0b 91 a0 86 1d 9b 21 19  35 a1 07 9e 36 1d d2 82  |......!.5...6...|
+00000020  51 b7 d2 3e a6 42 ce 6f  86 e9 69 20 00 00 00 00  |Q..>.B.o..i ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 01 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 44  |..+.....3.$... D|
-00000060  7f a7 d1 f1 38 fa c2 00  dd 48 44 20 b9 32 0b 16  |....8....HD .2..|
-00000070  d4 a6 72 da cb c9 23 52  c9 fb b9 b5 2d a0 62 14  |..r...#R....-.b.|
-00000080  03 03 00 01 01 17 03 03  00 17 d5 8b b4 47 9e 59  |.............G.Y|
-00000090  ff 8b 7e bd 0b 61 97 62  14 78 56 85 a4 45 37 0a  |..~..a.b.xV..E7.|
-000000a0  fa 17 03 03 02 6d 2d e1  4d 15 4f 8b 0a 55 f4 ed  |.....m-.M.O..U..|
-000000b0  eb a8 ba e3 ba 65 b2 94  ed ca 94 18 cb e9 31 86  |.....e........1.|
-000000c0  38 0a 61 78 e6 19 38 28  7c e6 8e a3 d2 01 4f 16  |8.ax..8(|.....O.|
-000000d0  90 ce a9 db 64 e8 ec a1  97 01 04 4a ce dd f2 0f  |....d......J....|
-000000e0  f8 1c 25 4d 28 d5 07 33  f9 fd c4 f3 f9 26 15 2f  |..%M(..3.....&./|
-000000f0  66 ef f0 82 49 1b 3d a0  99 ee 27 61 d3 0f 9c d5  |f...I.=...'a....|
-00000100  85 3b 49 54 5d 58 7b 0c  e2 97 e5 ac b1 10 d5 73  |.;IT]X{........s|
-00000110  f8 18 57 2d 7a e2 15 7f  a0 e2 07 c1 7a 16 d0 05  |..W-z.......z...|
-00000120  df 2e 29 fc c4 59 2a 7c  63 2e 7e e2 b8 75 92 35  |..)..Y*|c.~..u.5|
-00000130  f6 92 e4 1e e4 43 dc 25  64 e0 32 9f fe 0a 76 d7  |.....C.%d.2...v.|
-00000140  ee 08 f0 e3 e9 02 bc 93  d8 db d2 11 28 df b1 05  |............(...|
-00000150  fa fe 70 ef 73 e7 ca f1  a1 e1 95 a1 c6 05 30 0c  |..p.s.........0.|
-00000160  23 5c 5f d0 77 f0 7e 85  cc 2d 0b 88 41 7a 95 11  |#\_.w.~..-..Az..|
-00000170  6b 87 df 6e 5b 4a e4 7a  7a bf 42 f6 d1 fa 8e e5  |k..n[J.zz.B.....|
-00000180  96 5f 3b 2e 02 ba c9 f8  40 77 9c ed 81 82 29 2b  |._;.....@w....)+|
-00000190  8f 97 5e 97 de ff 5f 30  c1 06 66 c7 b4 33 b9 eb  |..^..._0..f..3..|
-000001a0  ca ee ff 42 db 8e 9c 18  0c 19 0a a4 d0 b7 e2 74  |...B...........t|
-000001b0  be d1 6f 79 ea a0 32 44  50 16 86 41 2d d8 4f 5c  |..oy..2DP..A-.O\|
-000001c0  c1 16 b2 6c a6 5a 49 e9  a1 ff 79 9c b1 23 41 eb  |...l.ZI...y..#A.|
-000001d0  35 1a a8 f2 21 ff f5 54  a2 92 26 61 f6 53 2c e8  |5...!..T..&a.S,.|
-000001e0  c9 4d 1e 42 2b bd de c0  78 f5 9f d0 b4 1e 30 e9  |.M.B+...x.....0.|
-000001f0  0a e0 71 50 f6 72 c2 15  1f 93 72 15 c9 3e bc ab  |..qP.r....r..>..|
-00000200  96 04 e3 5c 4a ee 6f 64  87 b1 ec d4 ca 76 ab 4e  |...\J.od.....v.N|
-00000210  cf 6e 32 7a 39 15 66 3e  e0 67 10 9c 3c 59 d1 31  |.n2z9.f>.g..<Y.1|
-00000220  77 21 4c b3 7d 85 82 b6  7d a0 89 5f 08 39 d8 37  |w!L.}...}.._.9.7|
-00000230  67 b3 0b b9 eb dd d8 11  ab 8f 9e 7b bb c0 c4 60  |g..........{...`|
-00000240  0e 62 31 3b 80 4c fd c5  08 9b 32 b0 0d af b5 1b  |.b1;.L....2.....|
-00000250  23 9a 18 66 ad 75 85 62  fc da e5 2f 0c 9a 26 d4  |#..f.u.b.../..&.|
-00000260  47 26 58 cc 1d 0b 7a e3  f9 a9 52 ac 69 31 73 b6  |G&X...z...R.i1s.|
-00000270  31 61 99 6b 38 d7 0d 09  4f 95 72 fc b1 a5 0b 48  |1a.k8...O.r....H|
-00000280  f1 66 41 69 e9 4c 33 73  fd 55 32 93 a3 92 55 ee  |.fAi.L3s.U2...U.|
-00000290  0c aa ef ed 46 70 68 1b  4e 87 32 53 21 fd 5e da  |....Fph.N.2S!.^.|
-000002a0  0a 27 81 88 46 ba 10 08  f7 7d 43 e0 e5 41 22 8d  |.'..F....}C..A".|
-000002b0  dd 39 b3 ee 02 7d c7 27  63 7a d0 f1 78 5c cf 56  |.9...}.'cz..x\.V|
-000002c0  32 7d 29 2d 90 c7 bc cf  fb 44 79 dc c2 03 eb 03  |2})-.....Dy.....|
-000002d0  88 7a 57 fc cc 74 de 28  d3 5e 9f f1 1a 50 34 25  |.zW..t.(.^...P4%|
-000002e0  34 37 36 94 c6 61 d5 00  c7 da 4d d4 7b 22 9d dc  |476..a....M.{"..|
-000002f0  ea 4e ff c8 94 4b 4a a6  af a4 fa 81 01 92 cb 08  |.N...KJ.........|
-00000300  42 08 6e 7e cc 89 2f de  2e 4d 89 e3 58 48 0d 20  |B.n~../..M..XH. |
-00000310  8c 5c 0e 17 03 03 00 99  d0 d0 4f ec e9 40 14 8d  |.\........O..@..|
-00000320  12 aa c8 dd b9 64 62 02  6c 76 be 3d 97 77 65 36  |.....db.lv.=.we6|
-00000330  43 da 7f 60 90 d5 1e 69  bf bb c7 d8 e1 25 54 38  |C..`...i.....%T8|
-00000340  44 72 ee c2 fb 3d 07 bc  44 82 74 48 4a c9 c2 28  |Dr...=..D.tHJ..(|
-00000350  6e 95 67 85 49 24 99 e6  fb 72 60 84 3a 98 15 21  |n.g.I$...r`.:..!|
-00000360  ff fd bc 1b 2e 7d 43 db  dc 70 ea 1c 19 67 f6 55  |.....}C..p...g.U|
-00000370  52 c5 03 91 4d 0a cb 59  d4 76 b0 53 7b 99 2a a3  |R...M..Y.v.S{.*.|
-00000380  60 71 36 55 27 d7 16 bb  a4 dc e8 a9 e8 8f e8 a4  |`q6U'...........|
-00000390  f6 43 1f 73 d9 b9 65 a9  06 55 e6 0a 17 32 40 34  |.C.s..e..U...2@4|
-000003a0  d4 23 7d c1 d2 ae 5d 9e  c4 d9 35 22 2c c4 71 cd  |.#}...]...5",.q.|
-000003b0  e0 17 03 03 00 35 3f 7b  f8 cd 3b e4 7b 52 3a ed  |.....5?{..;.{R:.|
-000003c0  04 2e 80 d1 bc d7 3f 0b  2f 03 98 ee a6 9b 4b fe  |......?./.....K.|
-000003d0  ff 0c 3b 8d 81 b4 e2 50  d0 07 a4 9c f7 f8 8b 59  |..;....P.......Y|
-000003e0  fe 78 e0 21 d7 9b 50 99  df 01 a9                 |.x.!..P....|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 20  |..+.....3.$...  |
+00000060  8c d2 dd d7 17 cc 15 f7  0b dc 75 48 d0 82 54 36  |..........uH..T6|
+00000070  b0 f6 ae fe 29 7b 0d af  9f 06 4e 58 8c 66 10 14  |....){....NX.f..|
+00000080  03 03 00 01 01 17 03 03  00 17 8c ef b2 76 05 ee  |.............v..|
+00000090  eb e8 55 a3 56 d6 4a b7  d7 10 8e f0 f9 7e 49 eb  |..U.V.J......~I.|
+000000a0  fd 17 03 03 02 6d c2 33  a8 17 70 1e 66 4c b8 32  |.....m.3..p.fL.2|
+000000b0  99 41 79 b8 85 98 c8 f7  f4 c6 25 41 9b 30 ea f5  |.Ay.......%A.0..|
+000000c0  24 6c ad 7c b6 c1 c7 a6  d5 2c 0b d8 78 e0 ec df  |$l.|.....,..x...|
+000000d0  bb 8d ea 0a ff ba c9 aa  ec 24 05 63 2a ff 13 37  |.........$.c*..7|
+000000e0  5e fe c1 7b 6e c0 dd e1  09 c1 87 33 fc 18 90 28  |^..{n......3...(|
+000000f0  5b b2 ba 7e 69 06 dc 8e  ac c4 ca 08 84 aa df 0c  |[..~i...........|
+00000100  2a a7 74 46 e7 c8 db 23  96 67 95 f4 79 9b 6e 3d  |*.tF...#.g..y.n=|
+00000110  94 fc 80 07 d9 e7 cf 0d  31 27 84 08 66 23 2d 05  |........1'..f#-.|
+00000120  64 2f 63 27 5c e2 1c 2e  f7 6f 99 4f 59 4c f4 3d  |d/c'\....o.OYL.=|
+00000130  cf a9 ff 32 f4 6a 7d b4  c4 11 01 9d f2 8a ce da  |...2.j}.........|
+00000140  21 51 b0 99 0c a8 a6 fa  09 b1 c4 cf a9 84 96 7d  |!Q.............}|
+00000150  aa 80 b4 b3 c7 ed 70 08  1b 50 b9 07 a5 2c a0 21  |......p..P...,.!|
+00000160  da 97 a7 5f 35 d4 55 24  8b 2d 14 85 0d 63 10 7f  |..._5.U$.-...c..|
+00000170  0b 22 03 a5 e3 26 e4 2b  ca c4 54 39 4d 52 41 8b  |."...&.+..T9MRA.|
+00000180  8e b0 60 2f 61 f5 7f d2  62 2c a3 f9 f2 46 08 76  |..`/a...b,...F.v|
+00000190  37 92 d0 bc 6c 0e 75 a2  f5 c1 f4 b3 7d f9 83 8e  |7...l.u.....}...|
+000001a0  bd 30 4f 04 77 98 b7 d0  e9 a0 19 4c 61 c1 58 09  |.0O.w......La.X.|
+000001b0  04 82 60 38 55 51 c1 94  46 40 a2 12 68 0a 83 7b  |..`8UQ..F@..h..{|
+000001c0  30 71 a3 08 83 f7 67 86  df 44 df ea 6d 56 65 25  |0q....g..D..mVe%|
+000001d0  16 55 5d cd 8a f4 03 10  86 1d 5a fd d8 2e 23 7e  |.U].......Z...#~|
+000001e0  34 77 b7 af 4b 2c 8a 36  ad 07 a5 5a 3b 39 c8 90  |4w..K,.6...Z;9..|
+000001f0  4b 77 60 81 2e ac 51 37  09 ac c0 e7 6b 18 a5 76  |Kw`...Q7....k..v|
+00000200  52 91 62 95 6d 1c 9d 8e  6c 03 f5 12 cd 80 7f 40  |R.b.m...l......@|
+00000210  4e f3 e6 7d d2 f1 3d 94  a7 16 ec fc 0c c9 72 b9  |N..}..=.......r.|
+00000220  ee 33 bb 76 d0 6d 27 3d  58 cd ed 34 60 f4 bb 23  |.3.v.m'=X..4`..#|
+00000230  49 a8 8d 94 7c 46 85 04  65 26 c2 5e 4f 22 f6 7d  |I...|F..e&.^O".}|
+00000240  46 ae 1b 63 eb 6b 43 c5  64 fa 9d 43 86 e5 29 8f  |F..c.kC.d..C..).|
+00000250  98 20 9e 21 b2 f3 32 c9  82 75 4d 97 5e cf dd cb  |. .!..2..uM.^...|
+00000260  1d 6b 6e fc 8f 61 86 a9  71 12 96 e3 18 42 d3 28  |.kn..a..q....B.(|
+00000270  f9 86 7e ab 90 9b f6 5c  c2 46 fb 93 e6 51 7d f5  |..~....\.F...Q}.|
+00000280  8a b2 e9 c6 e1 70 62 fa  08 e1 91 0b ee 89 12 01  |.....pb.........|
+00000290  ca dd 25 56 8f 2d 45 0d  a5 47 26 f0 a2 4d f5 4b  |..%V.-E..G&..M.K|
+000002a0  8b dd 6f ab 0f f1 5b 60  9c b0 dc 88 24 df 1c 5b  |..o...[`....$..[|
+000002b0  a9 90 66 44 e1 e1 6b 96  b5 3f e2 69 76 a7 84 d6  |..fD..k..?.iv...|
+000002c0  2b 68 b0 f5 8a ba e7 83  83 88 45 78 2d e0 a4 82  |+h........Ex-...|
+000002d0  74 53 4a cf 14 84 fa 49  78 ce 3b 9a 24 66 00 a9  |tSJ....Ix.;.$f..|
+000002e0  5b 0b 83 20 fb 20 a8 20  45 10 53 76 7d ee b2 d6  |[.. . . E.Sv}...|
+000002f0  af 33 f9 29 d0 f7 16 7e  d6 59 b0 4a 06 ac d4 7d  |.3.)...~.Y.J...}|
+00000300  84 1d 50 64 d0 f8 67 65  54 2f a3 2c 50 9e 93 43  |..Pd..geT/.,P..C|
+00000310  58 59 67 17 03 03 00 99  62 ac 15 76 89 cb 8d 67  |XYg.....b..v...g|
+00000320  25 75 a7 57 b6 65 8c 73  24 a6 71 ba c4 75 ad f8  |%u.W.e.s$.q..u..|
+00000330  2a a6 94 12 c2 8d ca 7e  1a 75 e4 21 da cb 1e 77  |*......~.u.!...w|
+00000340  69 d0 e1 4b 25 46 ce 99  1b e0 10 9d 12 d6 16 62  |i..K%F.........b|
+00000350  f9 42 3b b8 3a 7b 3a 11  1f d7 04 fe 88 0b 62 ba  |.B;.:{:.......b.|
+00000360  a9 d6 51 c4 f5 be d9 92  e6 d6 05 94 9b f9 76 0d  |..Q...........v.|
+00000370  ca da 55 45 e4 fe a9 f3  dc d5 08 db 50 7c 4a 7c  |..UE........P|J||
+00000380  f1 9c a7 5d e6 0d f9 cf  32 67 c0 66 a6 85 26 8b  |...]....2g.f..&.|
+00000390  57 f0 2c 5e b7 7e c1 cb  3d 6c 23 e2 18 3e c2 67  |W.,^.~..=l#..>.g|
+000003a0  97 23 3f 86 f2 38 b5 a7  df 98 68 57 89 a3 e4 86  |.#?..8....hW....|
+000003b0  d7 17 03 03 00 35 4a d4  e1 fb d1 39 57 90 d1 19  |.....5J....9W...|
+000003c0  b9 f2 1b 0b 1a 0d 8f fb  4b f3 f1 f8 31 d2 ac 3b  |........K...1..;|
+000003d0  25 ad e7 da 8a 78 ab 2a  d6 97 9b 66 88 6a db ef  |%....x.*...f.j..|
+000003e0  bf b6 ed b9 8a 39 72 8c  ea 8f 0d                 |.....9r....|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 c3 68 6c 59 46  |..........5.hlYF|
-00000010  70 ff b5 04 41 bd c5 66  a4 da cd df 04 f8 7e f9  |p...A..f......~.|
-00000020  a2 7b 0d f2 e6 cc 0c 30  df a9 66 4d 09 09 dc bf  |.{.....0..fM....|
-00000030  f4 5c 5e 30 5a 6d 2f bc  48 33 21 2b cb 6a ce f7  |.\^0Zm/.H3!+.j..|
-00000040  17 03 03 00 17 9a d0 31  9a c5 c4 4b 59 e3 a4 74  |.......1...KY..t|
-00000050  c5 d1 c5 09 a0 5e 08 48  fd 49 df 61              |.....^.H.I.a|
->>> Flow 4 (server to client)
-00000000  17 03 03 00 ea c7 4f b3  d0 32 fa 3d 4e e8 58 ea  |......O..2.=N.X.|
-00000010  d1 8c 9a ed 6d bc 41 ae  22 58 d2 cb 9b 16 4f 45  |....m.A."X....OE|
-00000020  91 86 8d 9f 9f 50 be 4d  f7 11 c9 ea 20 57 29 f8  |.....P.M.... W).|
-00000030  f3 78 8e e3 99 a1 8d 53  52 f0 1d 0a ef 64 cf 19  |.x.....SR....d..|
-00000040  9f 6f b7 c3 11 27 07 d6  1a 61 39 75 26 9b 41 a1  |.o...'...a9u&.A.|
-00000050  4d a2 a2 cd 59 c5 35 f3  58 ff 52 60 ba 04 54 3c  |M...Y.5.X.R`..T<|
-00000060  1b 2d 55 81 76 c9 59 af  b8 5e 46 4d 09 58 6c 55  |.-U.v.Y..^FM.XlU|
-00000070  66 1e d2 f5 7c bb 5e b0  e5 91 19 b0 be 32 04 46  |f...|.^......2.F|
-00000080  20 10 f2 75 55 5e 30 96  9d da 37 07 dc df 1d 6f  | ..uU^0...7....o|
-00000090  c3 f1 d5 b6 db 85 d9 04  d4 13 5b ba 83 20 17 ae  |..........[.. ..|
-000000a0  68 05 71 d5 72 46 ba 23  ad ab 76 60 68 6a d7 12  |h.q.rF.#..v`hj..|
-000000b0  91 55 07 bb b4 2b 40 9f  d1 75 6c 36 28 89 89 3d  |.U...+@..ul6(..=|
-000000c0  9a 73 25 7a 7e 49 56 4c  92 32 74 ad 49 52 a1 09  |.s%z~IVL.2t.IR..|
-000000d0  3f 02 62 fe a5 de 80 8c  93 01 de bd 59 5b 95 01  |?.b.........Y[..|
-000000e0  f1 62 5f 22 f6 e3 e6 27  ed b7 4b 81 7f 13 13 17  |.b_"...'..K.....|
-000000f0  03 03 00 ea 24 b0 f9 84  63 59 2b 30 09 4d 6e 44  |....$...cY+0.MnD|
-00000100  13 db 38 db 42 9f 20 7f  df f0 73 12 76 0d a5 57  |..8.B. ...s.v..W|
-00000110  0c 36 21 7d f6 26 98 66  67 4f 07 8d b0 25 6b 7b  |.6!}.&.fgO...%k{|
-00000120  7c d7 c0 3d b0 33 8b 87  15 e6 23 6f b5 5a 77 98  ||..=.3....#o.Zw.|
-00000130  d8 a7 d2 94 84 2a 7e 05  b2 ba 95 87 1d f5 44 54  |.....*~.......DT|
-00000140  33 32 9f 8e df ff 91 77  21 fe db 6e f6 bd 9f 2b  |32.....w!..n...+|
-00000150  63 43 a9 c4 94 e8 b7 22  ed 6f 03 42 12 95 17 fb  |cC.....".o.B....|
-00000160  7f 83 ca 8e dd 29 08 52  40 fe 2a aa f1 f2 29 b8  |.....).R@.*...).|
-00000170  5e e4 8f b7 67 a5 71 4d  4b 79 cf 5d 5d f2 72 44  |^...g.qMKy.]].rD|
-00000180  c2 3e a2 54 18 fc 58 33  d6 4c 2c bd d9 52 08 1f  |.>.T..X3.L,..R..|
-00000190  3e c3 58 bf 86 80 ad cc  8f 55 a1 b0 fb 96 e6 94  |>.X......U......|
-000001a0  43 be a6 14 b0 10 d4 27  38 93 b6 de 1d e1 3e e8  |C......'8.....>.|
-000001b0  8a 06 3c 65 49 5a fb 70  4b f7 01 eb 2a ff b0 e0  |..<eIZ.pK...*...|
-000001c0  74 ab fe bf a8 fb f8 45  c8 d6 92 f4 0c a3 d3 fb  |t......E........|
-000001d0  35 32 51 98 04 84 95 75  62 d9 8a 4d 0c b7        |52Q....ub..M..|
->>> Flow 5 (client to server)
-00000000  17 03 03 00 13 4b 79 39  94 f7 13 0c 77 5a 78 47  |.....Ky9....wZxG|
-00000010  fe e6 e8 41 96 49 84 53                           |...A.I.S|
+00000000  14 03 03 00 01 01 17 03  03 00 35 8c 85 73 71 98  |..........5..sq.|
+00000010  40 37 77 e7 8c fd d1 f0  42 a8 97 f3 7c 68 f4 a7  |@7w.....B...|h..|
+00000020  ac dc 7a ff 9b 2e f4 fe  2a c0 37 f9 56 a4 00 f5  |..z.....*.7.V...|
+00000030  b1 40 34 53 89 48 9a a6  9d af a1 75 3f 34 53 fd  |.@4S.H.....u?4S.|
+00000040  17 03 03 00 17 92 cf 4a  20 2e 0c 2b 4a dc 86 2a  |.......J ..+J..*|
+00000050  75 cd 8f 73 b3 b3 4b 3b  3a e4 39 c3 17 03 03 00  |u..s..K;:.9.....|
+00000060  13 83 08 42 b1 a8 95 2d  a5 4c 8b e8 e8 35 d2 4c  |...B...-.L...5.L|
+00000070  23 8b 83 73                                       |#..s|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-HelloRetryRequest b/src/crypto/tls/testdata/Client-TLSv13-HelloRetryRequest
index 8dac31adb6..c06837e6da 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-HelloRetryRequest
+++ b/src/crypto/tls/testdata/Client-TLSv13-HelloRetryRequest
@@ -43,107 +43,76 @@
 00000100  f8 2b 2d 4f 9e f1 07 9f  6c 4b 5b 83 56 e2 32 42  |.+-O....lK[.V.2B|
 00000110  e9 58 b6 d7 49 a6 b5 68  1a 41 03 56 6b dc 5a 89  |.X..I..h.A.Vk.Z.|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 9b 02 00 00  97 03 03 40 bb fc 8b c3  |...........@....|
-00000010  21 f3 14 d1 8d 63 52 bd  36 eb 78 47 3c 6e 8e 11  |!....cR.6.xG<n..|
-00000020  9e 51 c4 58 8c 32 6f b5  23 31 e7 20 00 00 00 00  |.Q.X.2o.#1. ....|
+00000000  16 03 03 00 9b 02 00 00  97 03 03 84 0c ed 20 38  |.............. 8|
+00000010  61 6f 28 24 e6 70 28 71  1d 3e 38 fc e2 94 da fa  |ao($.p(q.>8.....|
+00000020  34 04 33 99 7a 18 e2 2a  cc d1 67 20 00 00 00 00  |4.3.z..*..g ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 01 00 00  |................|
 00000050  4f 00 2b 00 02 03 04 00  33 00 45 00 17 00 41 04  |O.+.....3.E...A.|
-00000060  68 4b 33 bf 83 bd ff 25  68 0f b8 79 da c5 68 5e  |hK3....%h..y..h^|
-00000070  c7 ca 00 07 f1 79 17 22  41 c6 e0 24 c2 97 f7 07  |.....y."A..$....|
-00000080  b5 f1 04 20 26 17 90 6b  31 3f 25 15 bc 3b 4f 59  |... &..k1?%..;OY|
-00000090  54 b3 4f 75 4e 7a c0 2c  17 0f ea 2a 7e 5f 54 7f  |T.OuNz.,...*~_T.|
-000000a0  17 03 03 00 17 c3 10 7e  45 b9 96 05 4f a7 f1 bd  |.......~E...O...|
-000000b0  9f 79 b1 b5 88 e7 90 b1  44 b0 7d f6 17 03 03 02  |.y......D.}.....|
-000000c0  6d c3 e9 2e 7e 18 e5 0b  51 bb eb 55 62 44 6e bd  |m...~...Q..UbDn.|
-000000d0  03 6c 85 0d f5 39 52 58  b4 6b 44 cc f6 f6 0d 7c  |.l...9RX.kD....||
-000000e0  71 f1 0a 24 a7 c9 19 2a  87 92 5c f7 b9 af 4e 84  |q..$...*..\...N.|
-000000f0  94 69 df 28 a1 a0 18 2e  56 a1 15 3e 41 e2 f8 0c  |.i.(....V..>A...|
-00000100  73 98 d5 3c 04 93 d1 80  b3 21 11 a4 93 f9 2e 01  |s..<.....!......|
-00000110  bd d1 63 4b ed aa 31 3d  5d 9a ec 39 03 97 78 3c  |..cK..1=]..9..x<|
-00000120  a4 1c ee cd 72 10 a6 05  44 ff 43 09 66 b5 c4 f4  |....r...D.C.f...|
-00000130  9e fb 36 5b 73 6b 13 55  9e d5 ce 20 77 72 19 1b  |..6[sk.U... wr..|
-00000140  20 ea db d0 0f a7 ae 06  7d 95 4d d5 71 74 64 63  | .......}.M.qtdc|
-00000150  4d 88 6b f3 f8 d6 7d 56  97 b5 c4 4d a6 b7 86 a8  |M.k...}V...M....|
-00000160  9c 4d fb 53 65 7b 4b 2d  d4 49 4d 97 64 ca 39 d5  |.M.Se{K-.IM.d.9.|
-00000170  cb c7 38 a6 5b 0d 65 f6  12 d9 a4 26 a4 dd aa 2d  |..8.[.e....&...-|
-00000180  af f9 d4 2e a2 3f 28 51  87 c2 a5 b2 59 b4 23 e9  |.....?(Q....Y.#.|
-00000190  e5 e5 21 5e 90 29 1b 7c  21 3c 17 b5 96 71 4a d3  |..!^.).|!<...qJ.|
-000001a0  e4 60 58 ea 03 1c d4 b1  4a da 19 9e 75 83 1f 82  |.`X.....J...u...|
-000001b0  38 ea fe f4 3a db 36 0e  11 1d d6 09 76 52 cb 72  |8...:.6.....vR.r|
-000001c0  9f 67 44 83 c0 57 c3 1e  86 bd 73 c5 68 1c 0a ac  |.gD..W....s.h...|
-000001d0  f4 70 08 2d 9f 96 70 ca  08 c7 12 6d 58 12 6e 02  |.p.-..p....mX.n.|
-000001e0  7b 4f 1c 30 73 66 8c ce  05 35 ed 0f 19 41 88 c8  |{O.0sf...5...A..|
-000001f0  5a ed f0 c1 ff dd f9 c7  b0 0c 82 16 98 98 ec 0e  |Z...............|
-00000200  59 e5 9f e0 b2 a2 8a 62  46 21 d1 5d f3 3e e9 6d  |Y......bF!.].>.m|
-00000210  62 5f 66 0a 41 34 c7 75  05 62 ea 60 7a 9e 5e 56  |b_f.A4.u.b.`z.^V|
-00000220  32 6d 94 0a 08 ff 73 55  04 98 50 c3 d8 d6 10 cd  |2m....sU..P.....|
-00000230  80 77 29 84 d3 24 d3 dd  0a 0a 50 95 5f 41 f9 95  |.w)..$....P._A..|
-00000240  82 11 39 b3 c8 32 90 4f  6f 67 1f 14 c6 fb c5 0a  |..9..2.Oog......|
-00000250  a7 79 85 a2 0c 11 a2 d9  d1 07 66 5d 50 63 43 fb  |.y........f]PcC.|
-00000260  b5 e1 70 49 86 15 2d db  1c 8a 86 d3 97 9e 24 5c  |..pI..-.......$\|
-00000270  40 95 89 47 7a a5 0e dc  ba bd eb 0a 77 b9 42 58  |@..Gz.......w.BX|
-00000280  8b d1 18 ce 08 c5 3a eb  da 89 57 15 f0 00 9d 6f  |......:...W....o|
-00000290  ee be dc 1f e3 54 a3 ba  eb 39 61 0a f6 a6 21 26  |.....T...9a...!&|
-000002a0  d0 8e 0a ff a5 c4 53 37  5d fd b7 47 90 0d 79 dd  |......S7]..G..y.|
-000002b0  23 c4 94 54 d0 bd 59 93  68 f9 94 f0 00 ea 5a b1  |#..T..Y.h.....Z.|
-000002c0  88 79 bb e8 9b 5e 77 93  f0 36 fb 12 57 fc 3b c1  |.y...^w..6..W.;.|
-000002d0  15 d5 45 77 b5 35 ee fb  60 7f a8 cc da 99 1b 1e  |..Ew.5..`.......|
-000002e0  5c 7f 61 c0 9c 41 54 02  bc db af 48 ef a7 a8 62  |\.a..AT....H...b|
-000002f0  42 2d 1c b6 60 f8 1b ef  56 03 1d 79 68 79 a9 e9  |B-..`...V..yhy..|
-00000300  e6 78 62 66 c6 2e b4 6a  3c db 7a ee 1b f9 fa f3  |.xbf...j<.z.....|
-00000310  0a f1 10 55 18 da 2f 6d  35 67 9f c6 c6 d0 40 eb  |...U../m5g....@.|
-00000320  09 0b 6b a2 72 71 5c 77  b5 8e cf d5 ec 2b 17 03  |..k.rq\w.....+..|
-00000330  03 00 99 e4 93 85 ef 4e  a3 15 ca d2 76 f9 5a 20  |.......N....v.Z |
-00000340  40 08 b9 ad 74 93 12 7f  37 37 ab 9f 17 05 9c 0d  |@...t...77......|
-00000350  6a 84 85 c9 3e d2 3e 50  0b 7c 4e 51 6b 88 0a 91  |j...>.>P.|NQk...|
-00000360  82 67 90 99 f8 69 74 80  b8 75 4f c4 04 42 68 58  |.g...it..uO..BhX|
-00000370  26 8b 70 66 e1 b2 60 ac  63 92 3c 35 79 90 53 a2  |&.pf..`.c.<5y.S.|
-00000380  8b 37 8b c1 84 d9 ac 1f  36 83 95 25 75 89 d7 f0  |.7......6..%u...|
-00000390  44 81 be 9a 52 e7 a3 51  6d 28 50 80 e4 ea b4 db  |D...R..Qm(P.....|
-000003a0  89 68 9b 61 6e 88 7f 10  1e d7 f9 ea 12 a7 16 3c  |.h.an..........<|
-000003b0  2b 73 62 9b af 98 eb d1  7a 67 b1 6e 38 29 9d c1  |+sb.....zg.n8)..|
-000003c0  94 18 7e 2a 50 96 72 25  7a 23 21 13 17 03 03 00  |..~*P.r%z#!.....|
-000003d0  35 1f f9 91 ac 1f 78 93  2b 39 35 7e 52 22 e8 79  |5.....x.+95~R".y|
-000003e0  84 4a a6 de 74 21 c8 a5  c7 d1 35 0d 53 bd 85 7d  |.J..t!....5.S..}|
-000003f0  e0 2f 51 74 b9 69 f1 7b  a9 b2 2c b1 89 99 06 48  |./Qt.i.{..,....H|
-00000400  f8 b2 b4 c7 5d 06                                 |....].|
+00000060  c8 a0 2b 32 b8 d5 a7 19  a7 5e 02 f6 f1 e9 ad 34  |..+2.....^.....4|
+00000070  72 59 97 9e 05 a8 46 42  21 53 06 06 81 ea b6 f1  |rY....FB!S......|
+00000080  ca b6 c6 a1 b6 2e c6 b7  93 17 8e bc 92 3f ac 9c  |.............?..|
+00000090  7a 74 d0 f9 b2 00 68 e3  f2 1d b6 b8 66 7b 8a cd  |zt....h.....f{..|
+000000a0  17 03 03 00 17 69 26 9c  4e 1d ec 10 61 5f 5b ef  |.....i&.N...a_[.|
+000000b0  d1 ad 5d 6a c5 0c d4 ef  a8 c4 8c ee 17 03 03 02  |..]j............|
+000000c0  6d c1 89 98 5a 1d 09 68  1a cd 6e 75 e6 d7 9c d4  |m...Z..h..nu....|
+000000d0  fb c4 70 dd c4 0d 6b 28  09 9b 59 53 81 44 80 f3  |..p...k(..YS.D..|
+000000e0  9f 16 7a 04 e2 15 8a 80  58 2d 98 1e aa 1c ac dc  |..z.....X-......|
+000000f0  f4 60 d9 b3 ff d3 da 56  4a d4 dc 99 89 78 7b 0e  |.`.....VJ....x{.|
+00000100  0a 76 93 08 9f c4 a6 22  de fe 9f ad 19 19 92 20  |.v....."....... |
+00000110  f3 2f ba c7 dd bc 15 54  03 8a ed 2f 5f 75 32 f2  |./.....T.../_u2.|
+00000120  2b cf 0e 08 2e c6 7e 6a  4c 3f 40 4e 89 3f c5 de  |+.....~jL?@N.?..|
+00000130  f0 0d a2 f3 e7 b6 48 ac  a6 c8 e9 78 8b ee a3 f1  |......H....x....|
+00000140  7c 87 ff 5d d0 9b 4c 98  bc fc 25 1b b8 56 00 22  ||..]..L...%..V."|
+00000150  e0 7e 52 24 c6 12 a3 21  39 2a 63 77 da ff de 21  |.~R$...!9*cw...!|
+00000160  98 85 1d 73 57 df 21 6c  e3 f8 de 06 4b 50 39 0e  |...sW.!l....KP9.|
+00000170  7c c9 c9 bc 7b 16 1e d7  e3 b2 e4 9e d3 a9 94 35  ||...{..........5|
+00000180  fb 65 22 b9 a9 f8 ef 13  5e 54 ef 4b d7 09 b8 72  |.e".....^T.K...r|
+00000190  a9 a5 30 a2 67 d3 ef 6e  aa 00 7c fb fa 63 28 e7  |..0.g..n..|..c(.|
+000001a0  48 18 23 9b 7e 0f dd 8b  b2 13 4f f6 d2 e4 75 42  |H.#.~.....O...uB|
+000001b0  27 8a 42 0c 02 d8 1e 45  82 ef 1b 65 a7 eb b5 19  |'.B....E...e....|
+000001c0  26 e5 42 06 80 80 d7 84  1e 05 c5 d5 f4 ea 53 51  |&.B...........SQ|
+000001d0  78 ba f3 47 47 01 7b 25  ab 34 f7 fc 52 71 ff a4  |x..GG.{%.4..Rq..|
+000001e0  d5 50 2b b5 7d e2 62 6a  e9 8e 9c 8d b2 6f d4 78  |.P+.}.bj.....o.x|
+000001f0  07 da 3a 9c 51 a3 d4 f5  24 a6 c0 c8 39 85 5f e1  |..:.Q...$...9._.|
+00000200  03 b0 65 8b 50 c4 5d 03  f6 36 d2 3d f2 36 e3 c6  |..e.P.]..6.=.6..|
+00000210  26 5b 82 d1 bd 54 e7 90  50 23 a8 e3 36 d9 d9 a0  |&[...T..P#..6...|
+00000220  07 df 1b 47 17 9c 2a ab  56 07 d5 ea e5 c7 71 0b  |...G..*.V.....q.|
+00000230  fb 0c 4e f3 5b 0e 1d d6  75 df 21 50 c3 c9 18 5f  |..N.[...u.!P..._|
+00000240  55 e1 84 91 5c 9c 13 68  95 15 ab 0e db 17 b1 b7  |U...\..h........|
+00000250  ee 3e 89 61 0f 6f 09 8b  6a 67 b5 bc 2a 61 cd 42  |.>.a.o..jg..*a.B|
+00000260  79 9a 9c a4 99 98 0d 1c  43 2c bd 8d ee ac a9 2e  |y.......C,......|
+00000270  6d 73 cc b3 a0 b7 b7 8f  8f 09 32 8a 9f 00 87 5f  |ms........2...._|
+00000280  ae b4 0f 47 22 0b ec f4  e2 be 4e 6f 13 8d 30 97  |...G".....No..0.|
+00000290  5a a8 f0 38 46 dd 1a 28  10 8b a8 4a e4 e6 fb 84  |Z..8F..(...J....|
+000002a0  c4 85 15 11 3d 0b 08 f7  9d fd 45 6a 6b f5 bf d4  |....=.....Ejk...|
+000002b0  2b 84 e5 20 5a a8 cb df  1f a3 af 96 17 df e8 b2  |+.. Z...........|
+000002c0  61 f1 d0 d1 85 91 d2 02  a5 38 a0 5e 19 ba c4 2c  |a........8.^...,|
+000002d0  80 64 77 13 e1 27 86 d3  d4 17 07 86 c7 11 c0 38  |.dw..'.........8|
+000002e0  11 69 89 48 39 7e b2 e5  d9 72 c1 b4 29 50 ab 9b  |.i.H9~...r..)P..|
+000002f0  49 cd 74 b9 4a ce c5 67  46 47 73 81 b1 a1 82 8f  |I.t.J..gFGs.....|
+00000300  76 ee 81 28 70 66 da 94  2a 8e 20 b0 ab 2e e4 d4  |v..(pf..*. .....|
+00000310  ef 26 8b 31 07 85 b6 b0  c2 5b 05 0a 32 2e e7 73  |.&.1.....[..2..s|
+00000320  41 e7 a1 97 f7 5e 2f 9c  73 25 c1 f7 77 12 17 03  |A....^/.s%..w...|
+00000330  03 00 99 92 0a 8c 17 e9  0d 77 a3 6f ab 1a 4f dd  |.........w.o..O.|
+00000340  de 1d 0f 72 39 5c 8f 9f  80 00 b2 e5 fe 28 79 a2  |...r9\.......(y.|
+00000350  16 21 e3 a2 25 90 c6 cd  f2 28 6d b6 08 5b 51 0d  |.!..%....(m..[Q.|
+00000360  58 22 a6 11 ac 29 5d 54  aa 05 35 28 87 da 54 39  |X"...)]T..5(..T9|
+00000370  b6 7f ef 94 3e 1c 80 59  f1 12 06 77 66 20 a1 00  |....>..Y...wf ..|
+00000380  82 ed 0b 7a 1f 5d 55 5e  31 11 85 93 69 94 2a 44  |...z.]U^1...i.*D|
+00000390  96 1c 39 7b 5b 7f 5b a6  05 6a 6d 52 79 20 52 f7  |..9{[.[..jmRy R.|
+000003a0  1f 79 50 36 f1 a9 00 aa  9d 46 57 fd 00 70 7b 4a  |.yP6.....FW..p{J|
+000003b0  7a 14 75 20 91 83 3e 1b  47 2a 90 c9 09 71 b6 95  |z.u ..>.G*...q..|
+000003c0  48 53 2a 3f 22 5f 9c 46  d6 12 27 b1 17 03 03 00  |HS*?"_.F..'.....|
+000003d0  35 98 15 74 4c d4 52 cf  0c 78 88 8f 82 9b c5 23  |5..tL.R..x.....#|
+000003e0  14 02 71 da 63 6c 28 36  aa 91 a0 14 74 0a 47 59  |..q.cl(6....t.GY|
+000003f0  ea 6f b1 46 1e a7 c4 5f  76 33 96 ae 82 eb 4b b4  |.o.F..._v3....K.|
+00000400  88 6a ce 37 db fd                                 |.j.7..|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 35 fa 53 f3  c8 84 37 c3 c8 b9 b6 0a  |....5.S...7.....|
-00000010  41 bb 27 76 d5 7a 32 b6  3a fe 5b d5 28 d9 a6 81  |A.'v.z2.:.[.(...|
-00000020  21 63 ee 43 03 3d b6 c0  0c 5f 3c cc 2a 2a 7f ee  |!c.C.=..._<.**..|
-00000030  f6 5e 02 f5 c9 06 c8 56  de b1 17 03 03 00 17 9a  |.^.....V........|
-00000040  8f 68 ac 18 fc f4 87 b4  fb 1e 33 b9 77 51 04 57  |.h........3.wQ.W|
-00000050  f6 34 a4 f9 62 05                                 |.4..b.|
->>> Flow 6 (server to client)
-00000000  17 03 03 00 da 4b cf 84  da 4f 53 58 d4 24 69 e4  |.....K...OSX.$i.|
-00000010  4f e1 92 ae 27 23 7e ac  05 95 aa e3 c1 fb 41 7b  |O...'#~.......A{|
-00000020  5a 94 eb bc 0b 03 df 95  77 f7 9a 47 4a 88 52 83  |Z.......w..GJ.R.|
-00000030  4d a4 c1 a6 e9 79 dd 77  76 a0 fc 9b 50 55 72 8e  |M....y.wv...PUr.|
-00000040  c8 0a d6 e4 d4 b8 18 b4  0e cc 06 05 2a 40 17 7d  |............*@.}|
-00000050  f6 ef b5 76 93 85 fc 0b  e1 ca d7 e6 06 d0 e0 34  |...v...........4|
-00000060  86 e2 62 a4 35 fe 5d 63  6c 4a 2e 0f 3d dd ea a1  |..b.5.]clJ..=...|
-00000070  bf a8 86 56 e2 2e 21 79  47 c4 9a c4 6f 07 82 59  |...V..!yG...o..Y|
-00000080  d7 55 a9 32 97 de 5a af  0c ab fa 46 d4 2e ab b0  |.U.2..Z....F....|
-00000090  8d c8 36 0f d7 a5 cc 27  31 6e 42 a6 d0 61 72 45  |..6....'1nB..arE|
-000000a0  d7 43 8d 74 51 da a8 bb  6b 7a 69 30 79 f3 ff 92  |.C.tQ...kzi0y...|
-000000b0  dc 0a d7 52 b0 9a d8 c3  d6 c9 2b 3d 7e 60 63 5b  |...R......+=~`c[|
-000000c0  02 8c 5e 76 92 9d ad 4e  18 c3 67 a7 40 62 41 04  |..^v...N..g.@bA.|
-000000d0  0b c9 29 26 d8 0c 51 51  d1 5b a4 bf 69 d5 31 17  |..)&..QQ.[..i.1.|
-000000e0  03 03 00 da fa d6 36 16  4c 85 87 4f 4b 17 b8 65  |......6.L..OK..e|
-000000f0  3f dc c3 5d 09 c5 ed 80  b1 d4 3d aa dc f8 78 1e  |?..]......=...x.|
-00000100  c0 d5 e3 87 74 57 f4 3c  ec 7c d0 09 e6 88 fa 16  |....tW.<.|......|
-00000110  30 de 10 7c 25 14 d2 23  71 63 e5 bb 97 bf 5c 9e  |0..|%..#qc....\.|
-00000120  e4 81 cc 5d 0e b0 e4 06  0e 6b 87 93 6c ce 7c fc  |...].....k..l.|.|
-00000130  2b 66 c2 48 53 65 31 40  b8 ce 7e a2 f2 69 a0 b8  |+f.HSe1@..~..i..|
-00000140  41 ff 18 f1 1a db 96 7e  b0 e5 9a 40 de 4e d0 4f  |A......~...@.N.O|
-00000150  95 37 81 15 e9 b2 a5 fa  af 26 97 1b d7 e5 2b 17  |.7.......&....+.|
-00000160  51 5c ee d6 cd 20 6a 19  5c 80 41 f5 ca 52 d5 c8  |Q\... j.\.A..R..|
-00000170  70 e5 3a 0f 17 3e b4 b4  c5 bc f8 90 49 df ee 3b  |p.:..>......I..;|
-00000180  c5 33 43 14 16 d5 f7 f6  85 ef f2 ee cb 23 5a e8  |.3C..........#Z.|
-00000190  09 5d 15 73 98 b9 d3 1e  74 27 3e ff 7b 9d 63 13  |.].s....t'>.{.c.|
-000001a0  5c d4 b5 6a 34 b8 9e 1b  4b cf d8 5a da 4a 73 5e  |\..j4...K..Z.Js^|
-000001b0  5c ae 38 78 ba 12 00 bc  98 15 f3 c7 69 6b        |\.8x........ik|
->>> Flow 7 (client to server)
-00000000  17 03 03 00 13 d0 9e 34  0a 13 b3 c3 d9 22 79 a9  |.......4....."y.|
-00000010  66 e6 3a 8b 3e bc cf de                           |f.:.>...|
+00000000  17 03 03 00 35 7b c5 88  f4 a0 83 1e 6e 67 e6 05  |....5{......ng..|
+00000010  05 fa b4 40 e3 7f fc f8  bc 50 11 76 93 22 92 5f  |...@.....P.v."._|
+00000020  9a 67 e5 65 a1 a3 af bc  ae 3b c7 aa b3 fb 99 f0  |.g.e.....;......|
+00000030  2a c2 65 aa 4b bd 91 20  17 22 17 03 03 00 17 1d  |*.e.K.. ."......|
+00000040  4f a0 06 07 65 2e 10 e7  15 c9 56 f3 2c 18 10 51  |O...e.....V.,..Q|
+00000050  c7 d5 ac 09 e6 93 17 03  03 00 13 34 b2 1d 5e da  |...........4..^.|
+00000060  55 b2 dd 2b c1 e0 ac 65  7e a2 52 f8 a4 5b        |U..+...e~.R..[|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-KeyUpdate b/src/crypto/tls/testdata/Client-TLSv13-KeyUpdate
index 3d6c21bcee..a613b78da5 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-KeyUpdate
+++ b/src/crypto/tls/testdata/Client-TLSv13-KeyUpdate
@@ -16,117 +16,87 @@
 000000e0  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
 000000f0  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 0f 9a 86 30 a4  |....z...v.....0.|
-00000010  0a 88 2e ae a6 b9 ca ee  46 9c 87 f8 38 b3 5f d4  |........F...8._.|
-00000020  2c 42 29 e3 e7 44 e4 d3  e2 00 53 20 00 00 00 00  |,B)..D....S ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 59 2c d4 a8 e3  |....z...v..Y,...|
+00000010  ec 72 f1 2f 9b ff af 2f  ab 13 fe 21 80 a5 c1 71  |.r./.../...!...q|
+00000020  02 55 9b 06 67 0f 7b dd  27 32 66 20 00 00 00 00  |.U..g.{.'2f ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 01 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 1e  |..+.....3.$... .|
-00000060  0b 5c d8 c6 44 ba ac 71  70 3c a2 20 b0 05 d5 98  |.\..D..qp<. ....|
-00000070  c4 12 e3 43 67 53 c4 2a  72 6e 59 50 03 81 0e 14  |...CgS.*rnYP....|
-00000080  03 03 00 01 01 17 03 03  00 17 cc 54 e1 4a d7 5c  |...........T.J.\|
-00000090  1b 96 70 6e c0 ea 25 c6  0e 9d bd a6 c0 08 0a 45  |..pn..%........E|
-000000a0  1b 17 03 03 02 6d 17 74  77 1a b1 00 47 8f e5 01  |.....m.tw...G...|
-000000b0  3a 29 a3 e8 94 1b 3e ef  91 f7 05 8d 9a a4 2d 9a  |:)....>.......-.|
-000000c0  9b cf d2 83 e4 74 28 b9  d5 ae c8 79 b4 f4 6b eb  |.....t(....y..k.|
-000000d0  a0 db e7 db f3 ff 0b 2b  be 0c e7 3b d3 c6 79 ea  |.......+...;..y.|
-000000e0  39 a6 66 19 88 39 04 01  f9 8d 82 04 6d e2 ce 73  |9.f..9......m..s|
-000000f0  71 f9 bd 5b f6 66 a5 c7  f8 8b be db 1a b5 1b 38  |q..[.f.........8|
-00000100  4b b4 3a 04 01 5e 68 13  e7 51 40 fe bd b8 a0 00  |K.:..^h..Q@.....|
-00000110  7a 7d b7 60 0c 9d 23 7b  6e 77 fd 71 6f 45 30 41  |z}.`..#{nw.qoE0A|
-00000120  bf 3f 5f 45 27 b1 bd 3e  39 d1 bf 80 be 74 e1 e3  |.?_E'..>9....t..|
-00000130  ae 9c a7 68 40 ac 98 ef  3f 7f e6 41 a5 f5 c9 56  |...h@...?..A...V|
-00000140  45 1c 4e ad 1f 62 58 fc  0b 1f 06 1a 12 c5 d1 c6  |E.N..bX.........|
-00000150  0a 3d f9 f7 e9 a5 16 9b  69 bf f8 39 6f 38 8c cd  |.=......i..9o8..|
-00000160  da da 97 f7 40 9b a1 9f  3b c8 a5 5b 42 2f 44 29  |....@...;..[B/D)|
-00000170  f0 d9 0b 0e 7a b8 ae 9f  7f de fd 4c 81 c4 a2 9d  |....z......L....|
-00000180  a1 40 b3 5e a5 22 1a 1a  7b f7 83 14 4d 53 c9 68  |.@.^."..{...MS.h|
-00000190  4e e0 3f 8a 88 b0 74 51  eb 3a 85 ee 45 3b 5d d5  |N.?...tQ.:..E;].|
-000001a0  8c cd ba 55 b9 89 32 4c  6e d9 81 c3 b0 68 4d 39  |...U..2Ln....hM9|
-000001b0  0e 3b 70 31 a2 e2 6e f1  07 5a 0e 4f 6a 0c 58 f1  |.;p1..n..Z.Oj.X.|
-000001c0  71 0d dc 35 a9 ea 15 50  1e fe f4 e5 c6 ff ef 6a  |q..5...P.......j|
-000001d0  46 8c 04 27 1b cc a6 0e  40 25 c5 5e 13 e0 26 e8  |F..'....@%.^..&.|
-000001e0  5f 44 bb 05 f7 1c 6e 8c  1e 58 f3 5f af 92 98 79  |_D....n..X._...y|
-000001f0  93 50 a2 22 8d 65 62 20  78 15 8e 02 16 77 53 45  |.P.".eb x....wSE|
-00000200  fd 51 a6 db 80 26 7a 69  c1 55 69 76 96 2e 49 62  |.Q...&zi.Uiv..Ib|
-00000210  0e b8 fe 58 36 0d ac 68  b7 f0 54 16 45 bc 6a a0  |...X6..h..T.E.j.|
-00000220  8b fa 2e 00 de cf ad 73  31 ff c0 5f be ff 09 76  |.......s1.._...v|
-00000230  07 b2 08 27 90 98 2f b6  08 9f 8b 31 77 0a d1 41  |...'../....1w..A|
-00000240  ee ca 97 0d 46 03 91 d6  12 02 b3 7d 13 e8 ab 83  |....F......}....|
-00000250  79 93 96 33 f0 fc 14 3a  90 06 df 0d 38 59 1e 34  |y..3...:....8Y.4|
-00000260  a6 8a 5c 19 ae 8f ba b7  b8 6d cf 59 29 81 8c b7  |..\......m.Y)...|
-00000270  86 44 e0 a5 ef c1 24 cd  21 05 2a da 4b 01 e9 2b  |.D....$.!.*.K..+|
-00000280  b6 c0 be 8e be f1 af 1c  a4 be b1 26 4c a9 e5 e7  |...........&L...|
-00000290  41 fa 74 73 03 77 9b 5b  56 69 ca bd a5 99 ff d6  |A.ts.w.[Vi......|
-000002a0  eb 77 0c b0 3e 29 dc e7  54 7d 4e 03 5f 75 1e a5  |.w..>)..T}N._u..|
-000002b0  93 73 9a bd 53 31 57 b9  63 9c 17 f2 ae 3b 21 81  |.s..S1W.c....;!.|
-000002c0  38 55 1f 56 96 0f 02 de  ad 2a a4 7e 71 52 79 21  |8U.V.....*.~qRy!|
-000002d0  b0 76 e5 59 1c 74 10 0e  e3 90 4b 69 53 4d dd 20  |.v.Y.t....KiSM. |
-000002e0  52 25 14 d1 67 ed 72 26  6a 4e 1f 1b aa b9 03 6d  |R%..g.r&jN.....m|
-000002f0  81 67 1c c3 f2 f5 2e f0  01 b5 f5 8f d3 5e 08 2d  |.g...........^.-|
-00000300  fc f5 8a c0 3d af c1 3d  3f 14 c1 b3 18 55 6b 98  |....=..=?....Uk.|
-00000310  f5 4b c0 17 03 03 00 99  44 a2 0f 9b 62 d7 b0 e0  |.K......D...b...|
-00000320  68 2e f1 90 64 fc fe 4f  e3 e0 9a 82 8d c3 14 6d  |h...d..O.......m|
-00000330  f4 22 00 d9 74 5d 98 82  9f e5 6e fd 7e e5 9e d2  |."..t]....n.~...|
-00000340  5a 1b 11 fd 05 c0 d7 4e  48 6b 8b e1 33 8d f3 04  |Z......NHk..3...|
-00000350  2c 20 00 53 86 b7 f8 34  20 2f 6a e0 f9 c3 3a 85  |, .S...4 /j...:.|
-00000360  f2 32 4e a0 3e 3c 2d c6  91 86 d3 4b 09 ef d2 93  |.2N.><-....K....|
-00000370  3f a3 9a ad 0f f6 a3 04  ba 88 fe 9a 80 12 c5 0d  |?...............|
-00000380  f9 86 2b b8 cb 7e 46 28  16 2d 58 bf 5a 0a 2e f8  |..+..~F(.-X.Z...|
-00000390  cd c2 2e 01 c2 cf ca f7  5e b1 1d 8b 9d 1b 4b 8e  |........^.....K.|
-000003a0  62 a2 c2 17 14 e7 00 be  00 3a 0c 4c 84 d7 c1 47  |b........:.L...G|
-000003b0  61 17 03 03 00 35 7d 84  99 5a 9f b5 26 b5 f6 ce  |a....5}..Z..&...|
-000003c0  56 ca a6 25 60 84 e3 5b  c1 b8 7c ed ed 02 f1 13  |V..%`..[..|.....|
-000003d0  50 2a e8 a2 65 65 f9 88  b1 a5 01 24 0f 52 4a da  |P*..ee.....$.RJ.|
-000003e0  5d ea 2b 88 b3 9c b7 ed  d8 70 38                 |].+......p8|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 3e  |..+.....3.$... >|
+00000060  13 b1 51 26 01 be c0 e5  85 a7 18 aa b5 83 21 6e  |..Q&..........!n|
+00000070  85 48 1b ea 4c 99 13 ba  b8 de 07 30 f4 9f 5b 14  |.H..L......0..[.|
+00000080  03 03 00 01 01 17 03 03  00 17 9f 78 1e 98 cb 85  |...........x....|
+00000090  0e 65 2b e5 20 c1 63 c1  b7 49 49 76 e3 90 0c c9  |.e+. .c..IIv....|
+000000a0  b6 17 03 03 02 6d 8f 91  03 6b b7 0d 7d 79 4c 16  |.....m...k..}yL.|
+000000b0  fc cb 62 11 62 12 2a 52  9a 19 7c b6 1c fc 31 d2  |..b.b.*R..|...1.|
+000000c0  11 4d b4 e9 23 3c 58 3e  87 f1 9e e0 27 04 a2 fb  |.M..#<X>....'...|
+000000d0  21 9a 82 59 3b ea 6b 29  ec a8 0e 1c 58 99 46 9b  |!..Y;.k)....X.F.|
+000000e0  2b c2 90 10 5d bc df d1  a0 71 00 8f 9b 90 10 49  |+...]....q.....I|
+000000f0  97 1d b5 d2 8f e2 a6 78  b1 2a e9 2d 8d 13 38 2f  |.......x.*.-..8/|
+00000100  db 56 bb cd 0f 08 69 f7  04 de 53 ec 3c 90 97 ca  |.V....i...S.<...|
+00000110  9f 63 d0 96 7f 3a 98 98  77 21 c8 ee 0f 5c 4e 97  |.c...:..w!...\N.|
+00000120  3c 72 88 13 48 82 1b 70  b2 83 b4 95 03 81 05 ef  |<r..H..p........|
+00000130  81 40 69 36 29 44 75 0f  10 6c 8e a4 af 67 15 45  |.@i6)Du..l...g.E|
+00000140  42 bc 35 3f a5 c1 a7 c2  0a e0 7f bc f2 b6 a3 53  |B.5?...........S|
+00000150  b4 14 56 ed 45 5b e0 35  c6 93 3a f5 90 a7 4c 78  |..V.E[.5..:...Lx|
+00000160  01 3d 6a 16 41 52 31 e7  a9 8c 29 5e e5 e4 6a 3a  |.=j.AR1...)^..j:|
+00000170  95 59 a0 d9 67 b5 62 ed  13 98 82 b8 9b e1 f3 cf  |.Y..g.b.........|
+00000180  1f 39 0e 58 d4 19 a1 59  b3 c9 d9 dc 7a 2c 78 da  |.9.X...Y....z,x.|
+00000190  f2 54 58 91 36 59 24 dc  90 78 53 2f d7 e5 74 10  |.TX.6Y$..xS/..t.|
+000001a0  f3 ab f2 7e f8 8e 4d a9  15 b5 d8 65 85 0f e2 aa  |...~..M....e....|
+000001b0  40 ec b6 a6 3c d9 2e 11  17 72 6d 11 ab b5 65 8c  |@...<....rm...e.|
+000001c0  c1 62 8a 2e 0d b1 84 45  fa 23 b4 4e 39 9d 6b b7  |.b.....E.#.N9.k.|
+000001d0  91 3c 29 87 59 2c 95 40  29 4c af 7f 67 4c e4 fb  |.<).Y,.@)L..gL..|
+000001e0  9b 91 5f 96 bc 0b 4a b0  8b 52 d5 92 91 42 83 85  |.._...J..R...B..|
+000001f0  9a ec 81 56 ee 90 03 e7  d5 36 e9 ca e5 ed 07 4b  |...V.....6.....K|
+00000200  c8 ba c8 45 1b fc a8 95  b8 ff a0 9b 32 de 35 da  |...E........2.5.|
+00000210  af 6e 3a 0a 3a 94 6f 23  29 78 c1 21 07 7d 5e c2  |.n:.:.o#)x.!.}^.|
+00000220  9f 32 6d 78 75 58 c6 81  e2 6a ee d3 ea 69 8a 31  |.2mxuX...j...i.1|
+00000230  dc 86 9b ad b4 f6 29 0e  5f e3 aa e2 32 13 60 e5  |......)._...2.`.|
+00000240  b8 5a 45 7b bc ad f1 ae  42 18 4c dd 10 aa 60 88  |.ZE{....B.L...`.|
+00000250  b2 d5 e2 e6 cd 83 85 4d  ba c4 a4 94 52 bd 70 8e  |.......M....R.p.|
+00000260  85 4e ef 57 f9 9f ae f0  40 50 6b 5c 3a d2 cb 7b  |.N.W....@Pk\:..{|
+00000270  53 c7 01 60 7c 0b 53 39  bf a8 a2 f7 ef 6c 99 a5  |S..`|.S9.....l..|
+00000280  b5 23 3d d1 d5 a5 93 bc  40 41 10 29 4c a6 2d 91  |.#=.....@A.)L.-.|
+00000290  5a 43 2c 7b fb ef 70 73  5f f0 13 9a 5d f2 f3 41  |ZC,{..ps_...]..A|
+000002a0  7e 8b 09 f3 6f 5a c8 40  b7 18 b9 ff 4c 93 ee 8e  |~...oZ.@....L...|
+000002b0  f2 cb 6b 02 b8 d8 b7 d2  8d dd 2f 19 83 f7 7d bc  |..k......./...}.|
+000002c0  71 62 78 b4 43 29 62 76  a0 82 17 bc d8 d4 09 dd  |qbx.C)bv........|
+000002d0  8e 48 bf 4b dd 44 45 7a  1f 9c bd ae 0c 26 fc 71  |.H.K.DEz.....&.q|
+000002e0  dc c7 49 ee 13 46 c8 dd  f9 45 46 34 4c ac 02 33  |..I..F...EF4L..3|
+000002f0  64 89 02 d7 93 dd 03 3e  3a 12 d7 c1 8e 18 55 33  |d......>:.....U3|
+00000300  76 5f ce 26 f6 53 d0 23  3a e2 78 0f 0a fe 2f 89  |v_.&.S.#:.x.../.|
+00000310  43 27 b3 17 03 03 00 99  61 da d2 f7 6d 84 f0 08  |C'......a...m...|
+00000320  b0 89 f8 a4 1f b4 99 6a  cf d1 08 d6 a7 03 fa f9  |.......j........|
+00000330  db c2 8a 9a 74 62 0c 93  7d 7c 22 c0 2d 84 5d 96  |....tb..}|".-.].|
+00000340  f8 66 05 6c c5 ab b6 5b  2d f5 10 27 c6 c3 81 13  |.f.l...[-..'....|
+00000350  94 3c af 56 ca 37 ca a6  24 86 34 54 f2 60 e2 51  |.<.V.7..$.4T.`.Q|
+00000360  67 5e dd 81 7f 87 81 84  15 cf b9 92 01 9c fc 90  |g^..............|
+00000370  18 21 ad 6a 4a b8 4f fe  03 c8 83 08 fd 55 5a 4d  |.!.jJ.O......UZM|
+00000380  75 b7 e3 2d ff 9d 0a e5  61 b2 e9 82 bf 65 6a 05  |u..-....a....ej.|
+00000390  d1 8d 36 82 07 8d a0 95  78 26 9e 3a c7 99 27 3f  |..6.....x&.:..'?|
+000003a0  54 0e a3 dd 9a 93 a6 6c  9b a3 14 46 bb cc f8 70  |T......l...F...p|
+000003b0  f1 17 03 03 00 35 34 03  e6 68 dc f1 3e ae 38 69  |.....54..h..>.8i|
+000003c0  87 ce 72 92 13 4a c0 4a  0d 22 28 3a 9f df 7d d5  |..r..J.J."(:..}.|
+000003d0  de 5f 3c 0d 49 be b7 63  85 67 90 be 68 dc e7 88  |._<.I..c.g..h...|
+000003e0  e3 58 90 43 99 0a db ee  ad be 6d                 |.X.C......m|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 e7 50 0e 48 d7  |..........5.P.H.|
-00000010  8f 45 ff 48 48 1d 0c 94  b8 61 e2 ad 89 eb 4d 9b  |.E.HH....a....M.|
-00000020  20 f5 73 41 85 0c 7b c1  9b 1e d1 a1 27 b3 83 51  | .sA..{.....'..Q|
-00000030  05 51 a9 fc 98 7e fe ef  e2 43 6b a8 da f0 d0 d5  |.Q...~...Ck.....|
-00000040  17 03 03 00 17 f3 bb 74  b9 31 69 37 87 c9 eb 04  |.......t.1i7....|
-00000050  49 95 8f 30 e7 cf c5 67  27 3d 11 66              |I..0...g'=.f|
+00000000  14 03 03 00 01 01 17 03  03 00 35 ea a5 10 9a 0a  |..........5.....|
+00000010  57 40 9c b7 f8 e6 01 28  9e 3f ae ce ec 73 7f 2e  |W@.....(.?...s..|
+00000020  84 8e a9 e3 cb 03 3b b3  1b 98 3c 09 5b 23 c2 10  |......;...<.[#..|
+00000030  c1 18 47 74 a8 a5 0e 33  93 5f 83 e9 e6 aa ed f5  |..Gt...3._......|
+00000040  17 03 03 00 17 80 72 fb  00 25 ff 83 4c df 43 66  |......r..%..L.Cf|
+00000050  cd e5 64 2e 78 44 e4 b7  58 61 fe 01              |..d.xD..Xa..|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 ea 04 c2 4b  8d b2 6b 4e d5 f1 84 03  |.......K..kN....|
-00000010  22 ec f6 d5 61 ba fe 8a  e2 23 75 f3 9e b5 9f 9f  |"...a....#u.....|
-00000020  f7 23 a6 45 46 72 c1 90  cf 30 42 22 f4 7b 0b ca  |.#.EFr...0B".{..|
-00000030  6e b3 4a 74 98 3c 5b a4  1e 27 af 25 a9 af 45 ad  |n.Jt.<[..'.%..E.|
-00000040  70 0a 61 2a b3 0b 17 e6  ea 99 d5 d9 be 8e e9 97  |p.a*............|
-00000050  7a 8b 95 4b 50 91 86 35  ef c5 67 0a 10 0f fb 26  |z..KP..5..g....&|
-00000060  11 cb f7 7b 35 5a 58 79  80 38 cf f8 e8 77 c2 84  |...{5ZXy.8...w..|
-00000070  3a 91 f5 26 23 79 2c ac  8b f7 40 f1 38 dd 0f d6  |:..&#y,...@.8...|
-00000080  3c 0e be e3 12 37 5a 98  0c c8 6a 86 33 df e3 ef  |<....7Z...j.3...|
-00000090  7d a1 9b 3b 1b 1e 3e 17  58 8d 39 7b 28 c2 02 bd  |}..;..>.X.9{(...|
-000000a0  8a 5e 20 17 cb 0b 4c 01  df 36 a4 c0 0d de 26 67  |.^ ...L..6....&g|
-000000b0  18 b0 a8 b2 98 b2 01 2a  8c 0e 29 ce 2f c7 4a c5  |.......*..)./.J.|
-000000c0  ea 2a 86 06 33 62 93 ad  7a 08 15 d1 ab 46 14 43  |.*..3b..z....F.C|
-000000d0  8d 44 b8 6f ac 4a bc fe  e2 91 2f ca 03 6d 49 66  |.D.o.J..../..mIf|
-000000e0  7c bd ca 7b e1 da 73 45  c1 c2 79 02 02 55 52 17  ||..{..sE..y..UR.|
-000000f0  03 03 00 ea 3c fa 1d 62  22 67 f0 44 ac ab 17 a0  |....<..b"g.D....|
-00000100  f2 7d 44 ce 6a 3f dd 2c  d5 45 8f 2c 5d 6f 8e a6  |.}D.j?.,.E.,]o..|
-00000110  c8 97 ea e9 df 35 fd 00  57 98 33 d1 87 f4 1a ee  |.....5..W.3.....|
-00000120  8d 68 a7 ac b0 18 84 e3  26 df 08 85 8f e0 65 48  |.h......&.....eH|
-00000130  a9 94 f1 e5 09 78 6c 76  4a 1a 14 35 93 cc 44 ea  |.....xlvJ..5..D.|
-00000140  8c 8d f7 ee 33 4f cf e0  54 db ba 49 4b 5c b9 ea  |....3O..T..IK\..|
-00000150  de a9 6d eb bc f4 43 85  27 a4 d6 64 6d 1e 9d 9d  |..m...C.'..dm...|
-00000160  e1 81 22 30 b9 a1 c4 c9  b4 0b 4b 23 25 58 34 33  |.."0......K#%X43|
-00000170  40 fc ea 84 fa f5 ba 40  6d 60 cc 60 1b 95 19 f6  |@......@m`.`....|
-00000180  c6 9e ba 00 d8 fd 93 cd  bb 50 91 55 f1 e3 34 ea  |.........P.U..4.|
-00000190  f8 99 7e fd 18 02 69 e3  54 cf 15 3f d3 54 0e e9  |..~...i.T..?.T..|
-000001a0  30 4e 67 94 2e 48 49 45  b8 ae 1a 3c 6d 78 f0 2c  |0Ng..HIE...<mx.,|
-000001b0  04 15 9e 36 7d f5 c1 5c  d6 4c 16 9e a4 93 53 12  |...6}..\.L....S.|
-000001c0  08 c0 b9 c0 3c 2f b2 52  f1 5a 2f a4 8f 6c 55 57  |....</.R.Z/..lUW|
-000001d0  5b 0e d7 ef c4 a1 ee 90  99 a0 77 63 71 49 17 03  |[.........wcqI..|
-000001e0  03 00 16 cc 75 7c b6 21  9d ac 22 06 3a 15 90 e8  |....u|.!..".:...|
-000001f0  15 43 08 c7 02 aa 40 cb  d5                       |.C....@..|
+00000000  17 03 03 00 16 54 f1 cd  5a 87 da 6a e7 a6 e5 00  |.....T..Z..j....|
+00000010  60 f8 cd 6b af db 1b 85  3b 40 23                 |`..k....;@#|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 38 87 e3  aa 7a 6f 28 c7 6f bd cf  |.....8...zo(.o..|
-00000010  d0 50 21 a4 e0 44 9f fe  29 47 e9                 |.P!..D..)G.|
+00000000  17 03 03 00 16 b2 74 fa  c8 c6 6e 4f 62 4f ea 02  |......t...nObO..|
+00000010  4d 10 78 f1 b3 4a e2 e5  1d 8f 33                 |M.x..J....3|
 >>> Flow 6 (server to client)
-00000000  17 03 03 00 1a 3c be d6  90 e8 ad 97 7c 0f c9 b6  |.....<......|...|
-00000010  3d 66 52 35 57 1e 01 c5  a2 27 8b c4 17 25 20     |=fR5W....'...% |
+00000000  17 03 03 00 1a ba bc 59  f7 ad b4 77 2f bc 3d 60  |.......Y...w/.=`|
+00000010  5c bd 6c 6e 37 86 75 bd  e1 41 b9 07 f6 87 47     |\.ln7.u..A....G|
 >>> Flow 7 (client to server)
-00000000  17 03 03 00 1d 21 5f dc  8c da b2 e4 b2 9c 1e c6  |.....!_.........|
-00000010  dc 2c a5 f6 51 0d 18 03  13 e5 f3 b2 00 c8 4d 1f  |.,..Q.........M.|
-00000020  f9 1b 17 03 03 00 13 f0  2a 99 bd b7 c6 3c 9b da  |........*....<..|
-00000030  b8 c3 3d ee b3 f8 a3 0d  59 f8                    |..=.....Y.|
+00000000  17 03 03 00 1d 7d 12 1b  b2 a7 b7 ae 37 fb 2d 71  |.....}......7.-q|
+00000010  98 ec c2 f0 7f 16 e9 b9  f9 49 05 e2 b2 c3 c6 ec  |.........I......|
+00000020  38 32 17 03 03 00 13 9f  c4 f4 f7 e9 c9 5f e2 70  |82..........._.p|
+00000030  b4 33 9f 35 f3 2a b1 cd  01 d5                    |.3.5.*....|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-P256-ECDHE b/src/crypto/tls/testdata/Client-TLSv13-P256-ECDHE
index 826fd7aea8..20cafb45b6 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-P256-ECDHE
+++ b/src/crypto/tls/testdata/Client-TLSv13-P256-ECDHE
@@ -18,109 +18,77 @@
 00000100  6c 4b 5b 83 56 e2 32 42  e9 58 b6 d7 49 a6 b5 68  |lK[.V.2B.X..I..h|
 00000110  1a 41 03 56 6b dc 5a 89                           |.A.Vk.Z.|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 9b 02 00 00  97 03 03 43 72 ac ef 29  |...........Cr..)|
-00000010  8f 37 16 cf c9 d8 4c ce  9b d9 c1 93 f6 bb 47 a9  |.7....L.......G.|
-00000020  2d 23 83 b5 ff b0 e0 93  34 01 52 20 00 00 00 00  |-#......4.R ....|
+00000000  16 03 03 00 9b 02 00 00  97 03 03 42 8e 0f 88 bb  |...........B....|
+00000010  99 f5 32 74 2a 0a 66 98  59 da 0c 3f df 23 8c 72  |..2t*.f.Y..?.#.r|
+00000020  a7 ba f5 52 78 88 22 a0  db 3d cc 20 00 00 00 00  |...Rx."..=. ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 01 00 00  |................|
 00000050  4f 00 2b 00 02 03 04 00  33 00 45 00 17 00 41 04  |O.+.....3.E...A.|
-00000060  3b 16 53 b1 b9 87 04 07  c6 35 62 02 6b d1 d6 e6  |;.S......5b.k...|
-00000070  06 54 aa eb 03 ab b3 69  79 0f 86 77 1b 09 0c 70  |.T.....iy..w...p|
-00000080  2e 7d 09 86 1c df d9 a0  67 5c 87 75 f6 0d 1b 3b  |.}......g\.u...;|
-00000090  fd 0a 21 e2 2c 47 e4 be  60 79 f8 b4 e0 36 9f 1e  |..!.,G..`y...6..|
-000000a0  14 03 03 00 01 01 17 03  03 00 17 b5 fa 96 8c 5b  |...............[|
-000000b0  2b 29 ea 48 bb 2f ef d2  f2 b6 46 6c 06 9a a6 6d  |+).H./....Fl...m|
-000000c0  b5 d9 17 03 03 02 6d 54  d1 a7 bb 4a 57 68 0f 8d  |......mT...JWh..|
-000000d0  d9 1f 9c 8d da a4 30 4f  03 74 3e b7 5f 62 9e cc  |......0O.t>._b..|
-000000e0  5d bb df 24 57 db 11 f4  84 e4 65 a2 98 cf bf 27  |]..$W.....e....'|
-000000f0  75 ae 70 3b f8 15 b0 d4  3f e5 50 76 1b 12 fe 41  |u.p;....?.Pv...A|
-00000100  cb d3 f4 7b b8 e5 93 2f  25 87 e0 da ba ce 2e ee  |...{.../%.......|
-00000110  dc ee 2d ae dd e0 d2 2c  55 f8 ff e3 53 d2 c4 b5  |..-....,U...S...|
-00000120  0e dc cd 5f d9 4b dc 6b  6f e1 c8 bb 05 aa 6c 4f  |..._.K.ko.....lO|
-00000130  e9 ee 89 c8 fe 90 ee 37  21 94 c5 7b 06 3c e0 d6  |.......7!..{.<..|
-00000140  bd 94 45 96 9c 72 d3 24  cd e7 a4 14 67 5a b3 24  |..E..r.$....gZ.$|
-00000150  8c a4 5e 95 bb 5a 1a 83  a5 75 00 b6 9c 3f b4 23  |..^..Z...u...?.#|
-00000160  57 ae 19 cb c8 ae ed 17  9a 1a ed 9a c7 51 48 2b  |W............QH+|
-00000170  1e 35 a5 a3 fa 58 3d 6b  e2 06 93 4d 7b 0b 22 cd  |.5...X=k...M{.".|
-00000180  11 22 33 59 b0 21 88 97  ca 11 a6 35 4d 7a ef d0  |."3Y.!.....5Mz..|
-00000190  01 b7 da 3c 32 ce ee 50  d5 cf 3f 17 a5 8f 6c 61  |...<2..P..?...la|
-000001a0  8c b0 d2 4f c5 53 43 9a  d7 24 1f b0 75 ef fb 14  |...O.SC..$..u...|
-000001b0  c6 96 fd 2e 80 d2 9a 8a  9b 69 e0 f5 78 60 a3 47  |.........i..x`.G|
-000001c0  36 41 c1 7e 26 d9 9c c3  93 f8 c7 7c 20 77 de 1a  |6A.~&......| w..|
-000001d0  d9 33 0c 9f 60 89 e2 ac  08 df 34 92 23 fe 6a e6  |.3..`.....4.#.j.|
-000001e0  ec bc 51 3f 2f ec 95 38  39 5a e1 12 3b ca ca bb  |..Q?/..89Z..;...|
-000001f0  be 5d 87 71 4d 9a 2e 04  6c 8b 01 34 bb 71 09 45  |.].qM...l..4.q.E|
-00000200  60 a6 bd e2 33 30 04 bb  89 bc 79 01 84 06 73 04  |`...30....y...s.|
-00000210  c7 5e af 9f ad f6 62 c5  32 46 69 41 7a 31 56 e9  |.^....b.2FiAz1V.|
-00000220  01 5f 65 9f 6b 15 21 d4  a6 ba 3c 45 d7 9e cd 4a  |._e.k.!...<E...J|
-00000230  8c 19 18 ca 17 18 e9 4f  3f fb ec d8 c5 56 41 50  |.......O?....VAP|
-00000240  f9 d6 61 be 19 52 f5 a2  3d b4 27 6a a6 a2 1f 41  |..a..R..=.'j...A|
-00000250  57 e5 a5 e7 76 4e 9e ec  63 8a 45 89 04 3a 33 15  |W...vN..c.E..:3.|
-00000260  18 eb f6 71 fb 2d bc ac  c7 4f cd ed 03 e1 c9 4e  |...q.-...O.....N|
-00000270  27 0c 66 d2 c9 0d fd d7  a2 87 b5 67 29 1c 17 37  |'.f........g)..7|
-00000280  15 09 d8 e8 1b 8e f0 81  20 00 7e 7c 4b 7e 12 88  |........ .~|K~..|
-00000290  02 9c 82 81 22 95 b0 0a  58 e8 b2 85 cd f9 07 53  |...."...X......S|
-000002a0  f9 78 36 fb 8f 93 80 92  14 1d b3 07 9f 36 4f f7  |.x6..........6O.|
-000002b0  44 d6 df 7c f5 19 a6 49  aa 20 29 6e e5 df c5 07  |D..|...I. )n....|
-000002c0  30 76 6c fc f0 1e 2f d6  93 ec 55 8c 08 ce 7b e2  |0vl.../...U...{.|
-000002d0  29 f1 21 c8 eb 32 42 7b  05 21 8b 01 77 25 7f e4  |).!..2B{.!..w%..|
-000002e0  e9 52 76 87 91 2b 47 52  4c 91 40 cc 4f 81 29 6f  |.Rv..+GRL.@.O.)o|
-000002f0  57 28 6a 84 b8 6f a8 31  ef 5c f5 bd ef 96 2e e4  |W(j..o.1.\......|
-00000300  55 e2 2a 07 4d be 49 a2  89 00 41 38 a4 fa 7f 90  |U.*.M.I...A8....|
-00000310  a4 93 63 11 cf f3 36 50  dc 7a 1c f5 7a a0 1e a8  |..c...6P.z..z...|
-00000320  60 ac 41 33 79 e1 65 d2  0e 51 13 65 49 4d 52 78  |`.A3y.e..Q.eIMRx|
-00000330  0a c5 6a e2 17 03 03 00  99 80 e9 ac 5c c7 cb d1  |..j.........\...|
-00000340  47 bf 49 15 11 b6 8f 04  33 ae 0a 37 cd 3e 8a 11  |G.I.....3..7.>..|
-00000350  02 21 70 2c 25 a3 23 42  08 63 9b 34 0d 88 62 ae  |.!p,%.#B.c.4..b.|
-00000360  2c 8f ed 91 c6 2d 78 9f  bf e3 16 bb b1 83 99 e4  |,....-x.........|
-00000370  72 fd 31 ec c3 4f 16 b6  98 d8 d5 d8 46 85 a7 32  |r.1..O......F..2|
-00000380  51 d8 b4 0c 9e 31 a3 e6  80 31 ee d1 d8 e6 ad f2  |Q....1...1......|
-00000390  d5 3d 73 1d 17 5a 73 e4  f1 ac a8 ca 7f 24 a9 76  |.=s..Zs......$.v|
-000003a0  77 28 33 60 c3 fb dd d8  bd bd 38 f5 e5 fc 12 aa  |w(3`......8.....|
-000003b0  34 c4 c8 24 07 db 59 fe  46 ab ab a6 20 77 44 25  |4..$..Y.F... wD%|
-000003c0  d5 27 7c 97 14 ef 01 8a  4c 3a 2b e8 ac 8d c9 05  |.'|.....L:+.....|
-000003d0  d8 12 17 03 03 00 35 7b  1a ff 01 f0 d6 9b 24 e2  |......5{......$.|
-000003e0  e4 50 54 33 21 2b 58 6d  88 4c d7 fd a9 5a d8 6d  |.PT3!+Xm.L...Z.m|
-000003f0  78 13 9f 09 8f 8c 1d 3a  bc 76 c7 f6 95 9c 4d 04  |x......:.v....M.|
-00000400  92 06 e4 82 d1 77 24 da  05 49 4e 52              |.....w$..INR|
+00000060  42 55 a6 b0 22 e7 51 7f  ce 3c 15 f5 ef db 69 89  |BU..".Q..<....i.|
+00000070  80 e1 5a 54 37 d9 df 4c  bd 83 72 43 5f b5 bf 28  |..ZT7..L..rC_..(|
+00000080  21 41 0f 4c 71 a4 42 ae  90 20 8b 2e 95 88 1d a0  |!A.Lq.B.. ......|
+00000090  4d 50 6f 05 3d 71 26 e2  ca 12 2b bf 5b 18 b6 16  |MPo.=q&...+.[...|
+000000a0  14 03 03 00 01 01 17 03  03 00 17 fd a0 c1 f6 d6  |................|
+000000b0  f5 7c 39 25 4c 67 ad fa  10 18 d1 90 b2 61 90 3f  |.|9%Lg.......a.?|
+000000c0  71 49 17 03 03 02 6d 28  31 4d 75 d8 9d 93 a0 ee  |qI....m(1Mu.....|
+000000d0  ad ef a3 dc 14 12 a8 af  17 b4 46 20 50 96 26 54  |..........F P.&T|
+000000e0  78 4d d7 4f 08 e9 93 61  b6 53 da b2 e9 9c 67 54  |xM.O...a.S....gT|
+000000f0  e8 87 0d 64 0c cc 14 cd  d0 b5 df 1e d7 25 58 ce  |...d.........%X.|
+00000100  0b c9 a6 dc 38 9d 00 85  ce c3 01 29 3a 74 26 d4  |....8......):t&.|
+00000110  71 db c0 92 2b 95 d2 00  d0 38 8d 85 f5 22 05 c7  |q...+....8..."..|
+00000120  3b d4 d5 c7 a6 36 0d 3e  39 2c d5 0f 0d 84 80 22  |;....6.>9,....."|
+00000130  e5 f0 71 24 0d 93 68 21  db 51 e2 24 84 0c 30 2a  |..q$..h!.Q.$..0*|
+00000140  87 e5 b5 a2 b6 b8 9c 53  a1 bb 76 7d e8 10 e4 59  |.......S..v}...Y|
+00000150  f2 be 69 6f 39 75 e2 ed  70 f3 f0 fd 70 2f ce 2a  |..io9u..p...p/.*|
+00000160  24 d0 05 3e 13 ee 76 f5  6b b8 ed ee 34 40 cc e5  |$..>..v.k...4@..|
+00000170  11 58 62 22 99 04 3c 22  43 24 46 78 66 a0 04 11  |.Xb"..<"C$Fxf...|
+00000180  86 b4 b7 87 71 ff f9 ed  6f 4f 7e 9f 2d 08 ed ae  |....q...oO~.-...|
+00000190  cc 03 29 6f 34 9b 18 2c  ae d7 d5 e9 03 51 5d 37  |..)o4..,.....Q]7|
+000001a0  d5 ac 93 07 2a 78 8f 7d  b0 85 ae 19 37 a5 e8 d6  |....*x.}....7...|
+000001b0  e4 b3 01 14 04 fc ab 36  d6 5e 31 45 47 14 f8 d9  |.......6.^1EG...|
+000001c0  c8 a0 a0 49 56 74 68 5b  b4 20 f7 e0 54 34 41 45  |...IVth[. ..T4AE|
+000001d0  c0 5e ed a6 1c 84 d8 3a  c7 2d 17 5a 4c bd 7d d1  |.^.....:.-.ZL.}.|
+000001e0  a8 9e 5e d1 31 b1 6b 48  64 11 d8 89 01 9f ed 12  |..^.1.kHd.......|
+000001f0  60 73 66 80 38 13 23 8d  31 ca 94 06 22 e9 45 ff  |`sf.8.#.1...".E.|
+00000200  d6 a3 0b 7c 30 c8 d7 30  4f c0 62 84 ac f9 b0 3d  |...|0..0O.b....=|
+00000210  68 76 d2 02 27 d9 1e 7e  da ae 85 47 e1 08 0f 4f  |hv..'..~...G...O|
+00000220  74 a9 fc ca f2 38 68 6d  c6 f3 3c e9 99 c5 48 79  |t....8hm..<...Hy|
+00000230  88 37 b6 5d 4f f8 8b 53  41 9a 39 a7 2f 8e 39 81  |.7.]O..SA.9./.9.|
+00000240  75 cf 70 2f 28 4c 10 32  73 9b 6e 4f 58 1f ae 28  |u.p/(L.2s.nOX..(|
+00000250  3f 6c 3d 60 49 48 15 10  2a af ea d7 ce 55 07 47  |?l=`IH..*....U.G|
+00000260  90 3a c8 0d 6a 4a 88 c2  9c d3 08 99 02 c9 88 be  |.:..jJ..........|
+00000270  91 5b c9 41 46 cf b1 5e  fe 28 1e 97 8a 44 5a e0  |.[.AF..^.(...DZ.|
+00000280  d0 a3 a9 ea f7 51 27 87  b3 0f fd dc 7d d4 96 4a  |.....Q'.....}..J|
+00000290  39 2c 0a 58 9c 23 0d 41  89 42 5e fd 19 ab 19 a8  |9,.X.#.A.B^.....|
+000002a0  e4 70 3f ef c6 54 fb ed  80 9b 68 d6 d9 6f 21 53  |.p?..T....h..o!S|
+000002b0  89 40 06 c9 0c 56 40 8c  36 61 91 18 81 ce 76 5d  |.@...V@.6a....v]|
+000002c0  78 f5 01 9f 2e de 3e 89  61 d7 81 a5 f9 32 24 44  |x.....>.a....2$D|
+000002d0  6b fa 0b 9c 8b a4 f6 df  a1 2a 31 91 b2 40 cd 7e  |k........*1..@.~|
+000002e0  6c d1 75 c9 56 48 e3 36  eb 13 00 cf ea d5 d9 98  |l.u.VH.6........|
+000002f0  71 4c d2 af 06 e5 f1 f7  8f ce 79 7a 93 4c 1c 99  |qL........yz.L..|
+00000300  61 8f 93 76 de 1d ca ff  1b e5 c3 8f 99 ac 65 92  |a..v..........e.|
+00000310  74 a9 d6 fd 9d bd a7 da  f6 d5 94 7f 66 87 e1 7e  |t...........f..~|
+00000320  16 43 04 8a 9f 00 cc 89  1b 33 32 a2 26 e1 62 76  |.C.......32.&.bv|
+00000330  30 07 5d 0e 17 03 03 00  99 22 4f 7b 1f 73 59 91  |0.]......"O{.sY.|
+00000340  1e dc 62 ce 8b 32 7f 7d  99 b0 71 7a fb 79 09 5a  |..b..2.}..qz.y.Z|
+00000350  2e 0c b4 f2 00 13 5d ae  7d ae 80 1c 5f 8a a1 99  |......].}..._...|
+00000360  c9 20 39 a9 66 36 f0 2b  de 2e 1d ef 1f e1 ce 34  |. 9.f6.+.......4|
+00000370  9a db f7 7b 17 52 91 ac  76 ff 22 63 8c 07 dd 7d  |...{.R..v."c...}|
+00000380  72 eb 9b 34 0f e9 a4 43  6b e3 fa e1 00 e3 dc 65  |r..4...Ck......e|
+00000390  7a 49 bf a6 cd 97 4f e9  49 ae 91 4c be c3 3a b1  |zI....O.I..L..:.|
+000003a0  a1 ee 09 55 ce 87 e7 59  58 24 cb 43 16 c9 5f d6  |...U...YX$.C.._.|
+000003b0  11 32 83 47 dd 14 8d 11  c9 29 ac b8 57 7d 1e 07  |.2.G.....)..W}..|
+000003c0  34 cc 79 13 22 00 62 39  4c 7e 5f 89 dc 94 b9 ca  |4.y.".b9L~_.....|
+000003d0  d9 ef 17 03 03 00 35 6a  70 22 84 c0 ed d6 70 b1  |......5jp"....p.|
+000003e0  d5 8c 29 f9 0d 03 69 d1  0e 4c 01 79 1b 97 2f 24  |..)...i..L.y../$|
+000003f0  45 08 25 4e 56 58 7c d7  d1 79 67 73 7c e2 30 54  |E.%NVX|..ygs|.0T|
+00000400  54 2f c0 e2 28 e3 5a 87  47 0f f9 33              |T/..(.Z.G..3|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 6f 4f 2f 2f c7  |..........5oO//.|
-00000010  73 95 d9 6a ea 12 1f e4  a0 ea a0 c5 10 8b 57 99  |s..j..........W.|
-00000020  5b 6f 33 ae 14 f8 97 55  7d c2 4a 18 a7 6c 5d a8  |[o3....U}.J..l].|
-00000030  3b 33 6f fd 1e b2 78 4a  02 3f 50 b6 f5 0a 52 88  |;3o...xJ.?P...R.|
-00000040  17 03 03 00 17 c6 b1 65  78 2e 41 4e a8 a6 68 21  |.......ex.AN..h!|
-00000050  27 41 d6 8b cf 69 c4 79  6a a9 93 1e              |'A...i.yj...|
->>> Flow 4 (server to client)
-00000000  17 03 03 00 ea 38 4c b2  c8 55 46 fe 6f e7 fe 59  |.....8L..UF.o..Y|
-00000010  16 64 0d 78 97 f3 13 b1  6a 64 2b ed 64 d8 c0 96  |.d.x....jd+.d...|
-00000020  5c 52 45 ba ac 9c b0 42  14 81 15 99 79 c9 75 7c  |\RE....B....y.u||
-00000030  41 a4 15 90 7c 2c 8d 7f  75 43 37 1e 26 8f 74 a2  |A...|,..uC7.&.t.|
-00000040  13 45 40 1b ec df f6 a8  fa 75 3d e0 29 7e b9 00  |.E@......u=.)~..|
-00000050  aa b9 c5 60 dd 87 ac dc  44 74 17 0d ed 5a 50 b6  |...`....Dt...ZP.|
-00000060  8f 4e ee 4e d0 a7 97 fc  73 ef 9b 09 d3 ca aa 92  |.N.N....s.......|
-00000070  e9 32 61 9e 18 62 67 20  10 2c e5 18 fd 49 d9 76  |.2a..bg .,...I.v|
-00000080  68 9a 61 c3 be fc 1e 7c  9e ca ed 8c c5 40 dc 03  |h.a....|.....@..|
-00000090  3f 54 39 7e 3a 2a ec 78  a4 a0 91 14 30 cf 8f 9d  |?T9~:*.x....0...|
-000000a0  a9 c3 5b ba 1b 47 93 83  49 e2 dd fc c7 2b a3 11  |..[..G..I....+..|
-000000b0  27 3c dd 35 46 ef 06 d6  89 e6 81 13 c4 61 7f 47  |'<.5F........a.G|
-000000c0  5b ea b1 55 4e 6b 04 75  d1 4a a2 dc 1e 22 20 24  |[..UNk.u.J..." $|
-000000d0  f3 13 2a 63 b7 f4 51 ca  32 3c 82 75 49 e4 29 76  |..*c..Q.2<.uI.)v|
-000000e0  eb 19 20 d5 98 b0 03 9a  02 9f 1f 7e de ca 19 17  |.. ........~....|
-000000f0  03 03 00 ea 72 3d f9 82  80 34 d2 b3 a3 bd e8 cc  |....r=...4......|
-00000100  34 a2 0b 9f 40 c2 07 28  e8 55 5b 73 ce e5 4c 64  |4...@..(.U[s..Ld|
-00000110  54 8e 6b 16 22 b4 00 1c  81 1b c4 ec 2b 0b a1 9c  |T.k.".......+...|
-00000120  10 27 a4 d1 14 d7 4c 65  1e 0f 84 de a3 3e 0e eb  |.'....Le.....>..|
-00000130  46 db 04 f6 dd c4 7f 17  42 96 39 0d e7 2a ca f3  |F.......B.9..*..|
-00000140  ab fb 9b f2 4b a0 fc 8f  ba 16 97 bc ce 39 78 b9  |....K........9x.|
-00000150  fe 81 c9 de e2 c0 56 df  15 d0 ef d6 02 14 52 4b  |......V.......RK|
-00000160  a7 70 ee 46 34 22 6c 53  df b0 61 4e 79 de ad ad  |.p.F4"lS..aNy...|
-00000170  d0 c7 e7 0f fe 02 cd 68  6b e0 57 40 54 f9 7d 57  |.......hk.W@T.}W|
-00000180  42 bb 0b 63 a7 68 a0 c6  c9 92 af 5b e6 d6 ec e3  |B..c.h.....[....|
-00000190  10 a3 07 ac 2e 9a 88 a9  ec 20 47 77 22 c8 54 08  |......... Gw".T.|
-000001a0  90 19 ca 1e 01 a9 92 3e  c9 cf 70 92 5b 90 7a 75  |.......>..p.[.zu|
-000001b0  95 15 d5 e2 e2 13 6e 45  1a 51 ae e0 e0 6c 39 ed  |......nE.Q...l9.|
-000001c0  6c ef c4 c0 c4 29 f5 a2  c1 b4 a9 e9 73 fc dc a4  |l....)......s...|
-000001d0  ea 90 ec bc 33 bf 7c 94  7f e8 ed 54 e2 19        |....3.|....T..|
->>> Flow 5 (client to server)
-00000000  17 03 03 00 13 ca f6 56  a8 93 c9 5c ad 35 01 39  |.......V...\.5.9|
-00000010  17 11 3c fb a7 94 d6 e5                           |..<.....|
+00000000  14 03 03 00 01 01 17 03  03 00 35 f1 7c 55 b2 e9  |..........5.|U..|
+00000010  01 cd 57 d5 17 17 30 51  43 74 46 00 83 c7 d2 73  |..W...0QCtF....s|
+00000020  2b ff 57 45 5c 13 d9 9e  ec 56 c5 f1 d2 26 00 76  |+.WE\....V...&.v|
+00000030  75 5c f0 3c 80 39 74 4e  38 72 35 39 a3 29 4d ff  |u\.<.9tN8r59.)M.|
+00000040  17 03 03 00 17 43 aa f1  73 de 22 92 8c 54 2c 3f  |.....C..s."..T,?|
+00000050  c6 f2 f1 07 27 b2 f6 0e  54 79 4d 05 17 03 03 00  |....'...TyM.....|
+00000060  13 a5 64 ef ae 3f f0 52  08 71 9e 24 dc ea f1 50  |..d..?.R.q.$...P|
+00000070  b5 27 20 54                                       |.' T|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-X25519-ECDHE b/src/crypto/tls/testdata/Client-TLSv13-X25519-ECDHE
index 3dea0ac4cb..7de7d279b2 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-X25519-ECDHE
+++ b/src/crypto/tls/testdata/Client-TLSv13-X25519-ECDHE
@@ -16,105 +16,75 @@
 000000e0  28 da ac 5f bb 29 07 30  ff f6 84 af c4 cf c2 ed  |(.._.).0........|
 000000f0  90 99 5f 58 cb 3b 74                              |.._X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 ff 75 f5 a2 e7  |....z...v...u...|
-00000010  a6 49 83 90 e7 aa ad d6  71 53 82 9d 1c 0b 4a 8a  |.I......qS....J.|
-00000020  ea 06 7d e6 95 72 d8 f5  52 31 9a 20 00 00 00 00  |..}..r..R1. ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 cd c7 29 34 e2  |....z...v....)4.|
+00000010  96 86 e5 32 80 01 ea b9  3f d1 c5 90 da 7d 6e b9  |...2....?....}n.|
+00000020  6f c2 f3 de 0f 16 7c c6  be 22 9f 20 00 00 00 00  |o.....|..". ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 01 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 37  |..+.....3.$... 7|
-00000060  7b a6 43 94 9b 0f 95 5e  65 65 f3 50 25 27 d2 c6  |{.C....^ee.P%'..|
-00000070  40 03 1e a3 2f f4 8f c3  a0 f5 62 21 86 0e 32 14  |@.../.....b!..2.|
-00000080  03 03 00 01 01 17 03 03  00 17 4c 11 25 b7 37 16  |..........L.%.7.|
-00000090  50 0f b8 58 72 30 37 e2  25 10 6c 39 9f 7b bf b5  |P..Xr07.%.l9.{..|
-000000a0  53 17 03 03 02 6d 03 5c  76 8c 92 4d 9e f7 75 8b  |S....m.\v..M..u.|
-000000b0  31 48 b9 f9 43 c1 cf 87  3d 5e dc 10 e4 4a 57 86  |1H..C...=^...JW.|
-000000c0  f4 45 f0 9f e2 c3 ac eb  c0 c0 0e 9c d5 7f 8a 07  |.E..............|
-000000d0  c7 ca d4 9a cd a0 7b 14  c7 b3 da d2 29 19 c6 e3  |......{.....)...|
-000000e0  f5 78 e0 fc 61 4e 6a f1  1a 3d b1 ba 91 5b 5d c5  |.x..aNj..=...[].|
-000000f0  77 51 13 6a 6b 6a 68 ba  76 11 df af 6f 75 cf e9  |wQ.jkjh.v...ou..|
-00000100  08 a8 69 05 ae 1f d4 b2  aa a8 95 a2 22 2d 6e e5  |..i........."-n.|
-00000110  fb 18 ac 8c 84 77 56 17  8d 94 c3 25 59 59 b9 c6  |.....wV....%YY..|
-00000120  1a c1 f2 cd f9 41 75 64  3b 19 ff 1c 4e 7c fc 84  |.....Aud;...N|..|
-00000130  bb 42 12 57 2c d4 e1 0f  73 ae 1a 80 af e5 66 9f  |.B.W,...s.....f.|
-00000140  24 93 68 ef 41 6e 52 c7  c4 8a 50 66 2c dd ec fb  |$.h.AnR...Pf,...|
-00000150  75 e7 cd c0 83 cd d3 ce  fc 9c 2c af 2b 86 8d 58  |u.........,.+..X|
-00000160  50 05 82 dd 03 5a 89 cd  59 13 aa d6 dd 50 86 48  |P....Z..Y....P.H|
-00000170  64 a6 ad 12 90 6a 72 78  30 77 dc e1 f1 f5 30 a3  |d....jrx0w....0.|
-00000180  d3 86 60 9c bc 7f ae 28  9a f6 0c 8a 54 0c 78 a8  |..`....(....T.x.|
-00000190  e5 1f 61 73 a2 25 11 7a  92 50 59 af 67 e4 67 bf  |..as.%.z.PY.g.g.|
-000001a0  c6 36 02 fc 83 77 b4 2c  b2 a3 ab f6 43 68 29 ff  |.6...w.,....Ch).|
-000001b0  28 1c 9c bb c9 bb dc 89  d1 fa b9 1d 54 d8 bf 2b  |(...........T..+|
-000001c0  98 8c c6 df 5c bf 22 db  2d 95 2a 22 89 aa 10 98  |....\.".-.*"....|
-000001d0  66 a8 04 24 6d 44 19 2c  44 f5 80 fb be a5 84 41  |f..$mD.,D......A|
-000001e0  17 ab 01 81 a4 3e 1f 6a  fc d0 c2 af d4 fb 48 d3  |.....>.j......H.|
-000001f0  d8 a7 d6 af e7 f6 0d 6f  84 76 e5 27 6d 61 a0 95  |.......o.v.'ma..|
-00000200  cd 3c 72 c3 c3 12 61 d1  23 6f a3 3a 15 3c e1 56  |.<r...a.#o.:.<.V|
-00000210  70 74 62 67 be 0a 9e fc  f0 85 51 07 70 30 36 58  |ptbg......Q.p06X|
-00000220  5f d1 72 71 e3 1e cc e5  66 08 a8 05 c3 c9 40 f2  |_.rq....f.....@.|
-00000230  31 8a f2 bb e5 05 06 37  93 38 eb ce b8 2a f8 e6  |1......7.8...*..|
-00000240  ff fe f6 21 d1 20 96 81  29 5a bc d5 94 12 ca ed  |...!. ..)Z......|
-00000250  be 80 d4 d2 0b 39 78 af  a7 84 21 bd 4f b1 63 b3  |.....9x...!.O.c.|
-00000260  24 26 75 b9 69 0c f3 37  e5 c9 d6 1e fd 75 00 87  |$&u.i..7.....u..|
-00000270  84 97 4f 21 bc 74 3d 14  c2 36 0d 80 08 59 2e c2  |..O!.t=..6...Y..|
-00000280  e7 62 01 5a 87 48 e9 a9  a5 d2 c6 fa 50 93 bf 3e  |.b.Z.H......P..>|
-00000290  ec b5 d2 15 9c 44 cd f6  f2 65 01 ac d4 b0 7b 31  |.....D...e....{1|
-000002a0  96 5d d3 cb ee ba 29 ee  da 20 dc 39 25 f9 b8 77  |.]....).. .9%..w|
-000002b0  b1 56 e2 72 a2 1d ca 65  69 e6 31 79 b8 cd bb 70  |.V.r...ei.1y...p|
-000002c0  00 15 0b 47 e3 b5 00 e1  f1 4e 83 ca e9 2d 84 c3  |...G.....N...-..|
-000002d0  69 99 95 43 bf 89 b3 22  7b ca 17 9b 46 b6 fa 3f  |i..C..."{...F..?|
-000002e0  21 05 87 ea 60 f6 3b ea  a8 e8 30 2a c8 aa d9 9a  |!...`.;...0*....|
-000002f0  e8 4f 15 48 f1 50 54 68  b3 4e 7b e8 8c f2 78 ea  |.O.H.PTh.N{...x.|
-00000300  32 7c ed e1 32 96 90 6e  46 be 28 bb e0 d6 60 4b  |2|..2..nF.(...`K|
-00000310  48 fe 5a 17 03 03 00 99  bc bd b8 1f c4 f4 be 7e  |H.Z............~|
-00000320  e0 cc 0d 79 fe d7 ed 73  d9 c4 80 f3 e3 0a d3 26  |...y...s.......&|
-00000330  d5 d7 7d f4 5f c1 56 6a  2c 03 b4 70 46 4d 88 67  |..}._.Vj,..pFM.g|
-00000340  d2 43 6c 67 4d 2f e1 89  ff bc 9d 70 c7 de 24 0f  |.ClgM/.....p..$.|
-00000350  01 53 82 53 d4 20 30 93  8d 70 5d 3f bd b1 a8 d3  |.S.S. 0..p]?....|
-00000360  d3 46 aa fa d0 2b 9b 70  de 3c f3 1c a4 75 d8 a0  |.F...+.p.<...u..|
-00000370  6a 14 7d ec ad 6f 01 c1  d4 e0 f2 33 1a 1b 71 a8  |j.}..o.....3..q.|
-00000380  74 3d 4c dc 64 fe b9 3b  52 22 39 13 71 19 78 7c  |t=L.d..;R"9.q.x||
-00000390  bf 9d 06 0d 0d 27 4d b6  35 8a 44 f4 4f b9 f7 55  |.....'M.5.D.O..U|
-000003a0  d4 ba f5 ac 05 5b e5 ac  07 8e 49 7a 93 cf 3f 78  |.....[....Iz..?x|
-000003b0  fe 17 03 03 00 35 07 76  8c 10 f4 e8 70 e9 c6 12  |.....5.v....p...|
-000003c0  2d c8 ee 2f b3 6a 72 59  93 ae 8d af 00 8b 7e 5f  |-../.jrY......~_|
-000003d0  2a 33 87 dc 92 a9 7f e4  eb b4 09 8e 57 0f 02 16  |*3..........W...|
-000003e0  31 13 32 fe c5 88 fc b2  28 56 e5                 |1.2.....(V.|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 71  |..+.....3.$... q|
+00000060  a3 1e 19 38 17 d7 fb c4  d7 c0 c5 0b 1a 4f 43 b8  |...8.........OC.|
+00000070  36 73 5b ba ac 71 44 76  e5 18 a8 5f f0 e9 53 14  |6s[..qDv..._..S.|
+00000080  03 03 00 01 01 17 03 03  00 17 2b d0 f2 01 36 99  |..........+...6.|
+00000090  3c fe 38 af 22 1c 4f ec  1f 31 a2 48 31 a4 b9 83  |<.8.".O..1.H1...|
+000000a0  74 17 03 03 02 6d 87 69  ac 88 28 88 6e 62 c8 96  |t....m.i..(.nb..|
+000000b0  b9 32 1a 3d f6 a3 10 70  06 bd a6 3b d1 e4 a6 3a  |.2.=...p...;...:|
+000000c0  be e0 93 61 27 d4 bf 1f  b0 17 f0 19 b3 30 e1 5e  |...a'........0.^|
+000000d0  94 18 13 78 9b 9d d5 16  b2 c7 8a 21 54 c9 f0 31  |...x.......!T..1|
+000000e0  09 5b 6c 7f 22 79 9f 33  66 b7 e7 ea d4 11 63 5f  |.[l."y.3f.....c_|
+000000f0  05 21 e2 1a 66 96 ac 62  10 be 4b 51 73 df 29 9e  |.!..f..b..KQs.).|
+00000100  71 92 1a cb d2 d3 99 0c  a7 35 7d 12 b4 44 d7 96  |q........5}..D..|
+00000110  2b 29 9d 49 70 11 8c f8  5c 80 a4 98 56 21 66 2b  |+).Ip...\...V!f+|
+00000120  ac 72 1c 2e 86 e3 62 d2  e5 f1 7f 58 97 7b ac 85  |.r....b....X.{..|
+00000130  a8 c1 99 62 3b 8c 7f 47  95 09 e7 dc 7d 31 ed d2  |...b;..G....}1..|
+00000140  9b f8 71 fb 15 9c 80 1c  cc 28 dd 4d ef 95 89 92  |..q......(.M....|
+00000150  1f e8 c0 c3 78 b9 8f 92  88 e9 57 f6 2b 30 90 f1  |....x.....W.+0..|
+00000160  27 b8 d8 65 0e 12 6d 51  9c e8 f2 5d b0 58 90 88  |'..e..mQ...].X..|
+00000170  22 e3 fb 0e 2e 1f 6b 6b  a2 8e 52 2c a7 2a 32 03  |".....kk..R,.*2.|
+00000180  a4 e9 fc b7 e4 ec f5 73  37 fc bb d3 62 68 90 3d  |.......s7...bh.=|
+00000190  69 02 65 d5 35 6c 9b 89  68 c2 93 df 84 e3 f0 5f  |i.e.5l..h......_|
+000001a0  35 c7 05 d1 4d 60 93 b9  1d 5e 39 78 fd ed 85 f7  |5...M`...^9x....|
+000001b0  1b 82 f6 cc 0a 02 5e f6  e0 7a 78 55 3a 12 e3 b3  |......^..zxU:...|
+000001c0  45 ab 7e f0 12 2e 28 11  fd 73 7e 05 ef e1 c2 a0  |E.~...(..s~.....|
+000001d0  45 ac 2e 3c 0b 00 69 ad  01 78 c7 2b 15 4e 6b eb  |E..<..i..x.+.Nk.|
+000001e0  65 3d d8 c2 4b e6 9d 73  35 62 4f 58 d1 ec 7f 8d  |e=..K..s5bOX....|
+000001f0  6e 56 66 06 cf 90 56 09  70 53 bd ed 16 ff c1 14  |nVf...V.pS......|
+00000200  7f 1b 13 80 73 d2 7d f3  85 99 bd f2 f8 16 65 00  |....s.}.......e.|
+00000210  97 51 12 64 7a 34 20 b1  1a d9 fb 5c 38 e6 b7 ae  |.Q.dz4 ....\8...|
+00000220  99 34 6d 1a 87 30 09 96  13 04 f9 4d 51 b7 f5 76  |.4m..0.....MQ..v|
+00000230  30 ac 18 05 ba e4 0e 3d  28 6e 09 5e ec 52 18 d4  |0......=(n.^.R..|
+00000240  1e da d3 7e b4 16 ff 76  4e 31 10 42 5a 7e 75 ea  |...~...vN1.BZ~u.|
+00000250  86 82 4e ad 7a 11 1d a8  6b ab 5c 7d bd 7b 07 b8  |..N.z...k.\}.{..|
+00000260  aa bb 13 57 4a 24 d1 92  1d bb b9 7b 46 8b 7e 69  |...WJ$.....{F.~i|
+00000270  9c a5 ea a6 9d 20 42 b1  92 4f b6 0e 48 8a 29 be  |..... B..O..H.).|
+00000280  67 19 b8 5b 27 7f fd c0  7e b1 01 e0 19 42 bb 19  |g..['...~....B..|
+00000290  c4 91 b0 52 3e 0b 4c a6  2b 03 ff e3 e2 b9 d7 54  |...R>.L.+......T|
+000002a0  77 4c 04 83 c6 41 3b 8f  ee 8a 70 d8 16 e7 02 6f  |wL...A;...p....o|
+000002b0  13 9c a4 22 1d 1b cc 9e  6a 0e e8 96 94 54 df 2e  |..."....j....T..|
+000002c0  8a 60 53 e2 45 30 7b 8f  46 d2 ab 0e c1 6d 75 e2  |.`S.E0{.F....mu.|
+000002d0  cf 6c fe 9e 2d 31 af 9e  51 73 a6 39 02 ff 7b c2  |.l..-1..Qs.9..{.|
+000002e0  da 66 d6 27 87 9d 51 99  c9 7e 1b e7 43 8d 1e dc  |.f.'..Q..~..C...|
+000002f0  49 93 0e 9c 47 5c d6 97  19 ee 80 6d 4f 92 9d 25  |I...G\.....mO..%|
+00000300  ff ea bf ab 9a 64 a6 d4  70 80 5e 13 42 48 75 4e  |.....d..p.^.BHuN|
+00000310  8c c3 9b 17 03 03 00 99  7b 4a 09 b6 85 dc 5c 10  |........{J....\.|
+00000320  76 05 e8 11 e1 bc 63 ec  ec b8 19 14 f3 95 16 6b  |v.....c........k|
+00000330  2a a6 e1 ae b9 1c e0 5c  94 20 49 62 8c fd 76 7e  |*......\. Ib..v~|
+00000340  0e f9 9f ec 0d 01 47 4b  86 a8 b1 9f a2 bc 83 85  |......GK........|
+00000350  de e8 e0 2f c4 a4 f6 90  72 57 38 ad 2e aa 1e 4f  |.../....rW8....O|
+00000360  d4 8b e1 a2 b8 ba 80 99  ad 57 09 72 98 1c 5b 7b  |.........W.r..[{|
+00000370  a7 35 a2 c5 4a be 76 14  ee d4 63 a9 96 5e 33 7c  |.5..J.v...c..^3||
+00000380  0a e0 15 0d 14 19 f1 5a  5a e4 2c 9c 22 19 db e3  |.......ZZ.,."...|
+00000390  ea ee a1 c6 f8 1d 22 cc  5c 34 94 fa af 02 b0 26  |......".\4.....&|
+000003a0  8d 25 67 e6 f5 74 a9 38  38 37 57 ee 11 ac 0a 73  |.%g..t.887W....s|
+000003b0  01 17 03 03 00 35 bf ef  2c 2e 6c ae 90 ba d7 e0  |.....5..,.l.....|
+000003c0  99 b3 ea 42 db 8e ad 03  5b af 93 1e 35 3a fb f7  |...B....[...5:..|
+000003d0  87 bc 90 b6 98 ad e2 e6  1c 24 3b c1 20 8c 1a 79  |.........$;. ..y|
+000003e0  97 ad e3 8b 08 7b cc 7e  2b 98 fa                 |.....{.~+..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 73 82 31 66 2c  |..........5s.1f,|
-00000010  6e 22 2d 6f b5 30 4d db  eb f0 91 2e b1 11 6d 0e  |n"-o.0M.......m.|
-00000020  ca 50 e6 ce 92 bc 44 8c  e4 e4 3b 8f 13 82 6e 9c  |.P....D...;...n.|
-00000030  bb 25 bc 36 e8 27 5a c1  8f ed 6d fc f1 8c 8a e1  |.%.6.'Z...m.....|
-00000040  17 03 03 00 17 66 bb ee  75 14 79 25 af 92 97 ad  |.....f..u.y%....|
-00000050  ac 26 bf 2e 37 c1 12 e2  ab 65 1f ac              |.&..7....e..|
->>> Flow 4 (server to client)
-00000000  17 03 03 00 da 19 f9 46  cf 64 be 58 bf d0 24 37  |.......F.d.X..$7|
-00000010  9d 7a 91 0d 24 60 d7 a7  b8 8f dc ca db e2 b3 c6  |.z..$`..........|
-00000020  ec 6e 30 f6 88 8b c9 18  92 b8 f1 06 09 82 49 c5  |.n0...........I.|
-00000030  89 9b a0 76 8e 55 e0 52  ca 12 88 ef dc 62 7c ad  |...v.U.R.....b|.|
-00000040  b1 66 cb 23 b9 3b 7f 4f  d9 da 02 d8 9c c2 f8 66  |.f.#.;.O.......f|
-00000050  26 60 57 a7 99 76 d2 de  15 98 e5 9f b5 b0 54 82  |&`W..v........T.|
-00000060  a9 88 76 25 aa bd 10 7b  47 0b 3d e4 c4 a2 fd 5f  |..v%...{G.=...._|
-00000070  71 da aa 6b 4b e4 77 1e  85 7c f0 6d b8 f2 5b f3  |q..kK.w..|.m..[.|
-00000080  df 73 1e df a0 60 bb 8e  53 4b 5b ac 16 49 aa 15  |.s...`..SK[..I..|
-00000090  11 bf e1 91 a1 03 df 3d  5f 68 a0 93 08 53 c8 98  |.......=_h...S..|
-000000a0  77 b9 22 70 63 44 21 23  22 0c 27 2f b3 22 fd 47  |w."pcD!#".'/.".G|
-000000b0  a1 b9 27 8c 10 b0 e7 db  36 d1 0f 45 d4 59 24 cd  |..'.....6..E.Y$.|
-000000c0  84 db 5f e1 db 8f f8 a6  d7 11 04 6f b4 10 e7 48  |.._........o...H|
-000000d0  f7 50 4e 32 f4 a0 ed 37  04 0d 6b f9 7d 30 e8 17  |.PN2...7..k.}0..|
-000000e0  03 03 00 da 22 55 eb fb  b6 0d 36 a1 46 10 2c 0a  |...."U....6.F.,.|
-000000f0  22 00 59 c0 e2 69 98 4d  f8 38 4b 23 d0 49 a2 3e  |".Y..i.M.8K#.I.>|
-00000100  d6 f3 64 f7 e1 47 39 a4  90 a5 17 81 c4 9a 2a 0f  |..d..G9.......*.|
-00000110  6f e9 71 9a 9e e5 c6 e4  5b fe 91 4a 78 68 9b d7  |o.q.....[..Jxh..|
-00000120  3e 2b c4 81 cd 0b 7a 1a  a0 5d 85 5b 49 db 15 0b  |>+....z..].[I...|
-00000130  c8 90 34 e6 8e 5f 44 4e  85 07 23 4c aa 41 8a 94  |..4.._DN..#L.A..|
-00000140  49 87 69 39 e3 0c 6f 80  19 7c 81 4a 8a 42 5b ed  |I.i9..o..|.J.B[.|
-00000150  1d 65 0b 7e f0 28 60 87  24 ce 23 4e 34 6e f2 10  |.e.~.(`.$.#N4n..|
-00000160  91 85 b1 a0 10 6c ec 30  c0 c3 dd b7 d8 eb 59 71  |.....l.0......Yq|
-00000170  80 20 8a 58 f1 79 f7 70  e9 fa d5 12 58 fd 68 06  |. .X.y.p....X.h.|
-00000180  66 3e 0a 21 4d 9c aa df  92 fc b4 1f 20 e4 df 98  |f>.!M....... ...|
-00000190  c4 11 e1 7b 1f 55 6c e5  75 c1 b9 b6 29 91 85 58  |...{.Ul.u...)..X|
-000001a0  85 a0 7c 9f 29 ea 51 3e  4a 93 21 e6 3a ce 69 c5  |..|.).Q>J.!.:.i.|
-000001b0  60 77 ca fc 04 13 f7 6e  ce 14 73 8d 21 b1        |`w.....n..s.!.|
->>> Flow 5 (client to server)
-00000000  17 03 03 00 13 03 3a 80  ef 54 48 49 d8 a1 d8 66  |......:..THI...f|
-00000010  3d 5b 76 16 c0 d6 68 5e                           |=[v...h^|
+00000000  14 03 03 00 01 01 17 03  03 00 35 ce 50 b5 dc 27  |..........5.P..'|
+00000010  34 5b ea 1b 27 76 67 d1  9e 24 cf f9 51 4a 9a 6b  |4[..'vg..$..QJ.k|
+00000020  cd 57 12 b2 5a 52 03 be  e8 62 e2 29 64 1e 16 f1  |.W..ZR...b.)d...|
+00000030  61 af 70 a7 11 f1 41 ef  e3 44 da 0e 9b 90 05 ad  |a.p...A..D......|
+00000040  17 03 03 00 17 b4 9d 4e  de fb da 13 02 ad 51 40  |.......N......Q@|
+00000050  b0 55 1d 89 ec 09 2b 52  e5 51 34 1f 17 03 03 00  |.U....+R.Q4.....|
+00000060  13 52 89 42 ba d7 14 f0  53 b4 b1 5a a5 a3 37 55  |.R.B....S..Z..7U|
+00000070  bd f8 e9 e5                                       |....|
