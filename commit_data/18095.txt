commit 6f149492bf939d30de3d02049939768041b73aba
Author: Adam Langley <agl@golang.org>
Date:   Fri Dec 20 11:37:05 2013 -0500

    crypto/tls: rework reference tests.
    
    The practice of storing reference connections for testing has worked
    reasonably well, but the large blocks of literal data in the .go files
    is ugly and updating the tests is a real problem because their number
    has grown.
    
    This CL changes the way that reference tests work. It's now possible to
    automatically update the tests and the test data is now stored in
    testdata/. This should make it easier to implement changes that affect
    all connections, like implementing the renegotiation extension.
    
    R=golang-codereviews, r
    CC=golang-codereviews
    https://golang.org/cl/42060044
---
 src/pkg/crypto/tls/handshake_client_test.go        | 3269 ++---------------
 src/pkg/crypto/tls/handshake_server_test.go        | 3803 ++------------------
 src/pkg/crypto/tls/handshake_test.go               |  167 +
 .../testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA  |  129 +
 .../testdata/Client-TLSv10-ClientCert-ECDSA-RSA    |  125 +
 .../testdata/Client-TLSv10-ClientCert-RSA-ECDSA    |  128 +
 .../tls/testdata/Client-TLSv10-ClientCert-RSA-RSA  |  124 +
 .../tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES     |   86 +
 .../tls/testdata/Client-TLSv10-ECDHE-RSA-AES       |   97 +
 src/pkg/crypto/tls/testdata/Client-TLSv10-RSA-RC4  |   82 +
 .../tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES     |   88 +
 .../tls/testdata/Client-TLSv11-ECDHE-RSA-AES       |   99 +
 src/pkg/crypto/tls/testdata/Client-TLSv11-RSA-RC4  |   82 +
 .../testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA  |  133 +
 .../testdata/Client-TLSv12-ClientCert-ECDSA-RSA    |  127 +
 .../testdata/Client-TLSv12-ClientCert-RSA-ECDSA    |  132 +
 .../tls/testdata/Client-TLSv12-ClientCert-RSA-RSA  |  126 +
 .../tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES     |   89 +
 .../tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM |   84 +
 .../tls/testdata/Client-TLSv12-ECDHE-RSA-AES       |   99 +
 src/pkg/crypto/tls/testdata/Client-TLSv12-RSA-RC4  |   82 +
 src/pkg/crypto/tls/testdata/Server-SSLv3-RSA-3DES  |   82 +
 src/pkg/crypto/tls/testdata/Server-SSLv3-RSA-AES   |   83 +
 src/pkg/crypto/tls/testdata/Server-SSLv3-RSA-RC4   |   78 +
 .../tls/testdata/Server-TLSv10-ECDHE-ECDSA-AES     |   92 +
 src/pkg/crypto/tls/testdata/Server-TLSv10-RSA-3DES |   78 +
 src/pkg/crypto/tls/testdata/Server-TLSv10-RSA-AES  |   81 +
 src/pkg/crypto/tls/testdata/Server-TLSv10-RSA-RC4  |   75 +
 src/pkg/crypto/tls/testdata/Server-TLSv11-RSA-RC4  |   75 +
 .../Server-TLSv12-CipherSuiteCertPreferenceECDSA   |  106 +
 .../Server-TLSv12-CipherSuiteCertPreferenceRSA     |  117 +
 .../Server-TLSv12-ClientAuthRequestedAndECDSAGiven |  122 +
 .../Server-TLSv12-ClientAuthRequestedAndGiven      |  120 +
 .../Server-TLSv12-ClientAuthRequestedNotGiven      |   80 +
 .../tls/testdata/Server-TLSv12-ECDHE-ECDSA-AES     |   97 +
 .../crypto/tls/testdata/Server-TLSv12-IssueTicket  |   87 +
 src/pkg/crypto/tls/testdata/Server-TLSv12-RSA-3DES |   82 +
 src/pkg/crypto/tls/testdata/Server-TLSv12-RSA-AES  |   86 +
 .../crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM  |  102 +
 src/pkg/crypto/tls/testdata/Server-TLSv12-RSA-RC4  |   78 +
 src/pkg/crypto/tls/testdata/Server-TLSv12-Resume   |   35 +
 src/pkg/crypto/tls/testdata/Server-TLSv12-SNI      |   75 +
 42 files changed, 4540 insertions(+), 6442 deletions(-)

diff --git a/src/pkg/crypto/tls/handshake_client_test.go b/src/pkg/crypto/tls/handshake_client_test.go
index 6c564001b0..766cb1320e 100644
--- a/src/pkg/crypto/tls/handshake_client_test.go
+++ b/src/pkg/crypto/tls/handshake_client_test.go
@@ -6,3045 +6,350 @@ package tls
 
 import (
 	"bytes"
-	"flag"
+	"crypto/ecdsa"
+	"crypto/rsa"
+	"crypto/x509"
+	"encoding/pem"
+	"fmt"
 	"io"
 	"net"
 	"os"
+	"os/exec"
+	"path/filepath"
+	"strconv"
 	"testing"
+	"time"
 )
 
-func testClientScript(t *testing.T, name string, clientScript [][]byte, config *Config) {
-	c, s := net.Pipe()
-	cli := Client(c, config)
-	go func() {
-		cli.Write([]byte("hello\n"))
-		cli.Close()
-		c.Close()
-	}()
+// Note: see comment in handshake_test.go for details of how the reference
+// tests work.
 
-	defer c.Close()
-	for i, b := range clientScript {
-		if i%2 == 1 {
-			s.Write(b)
-			continue
-		}
-		bb := make([]byte, len(b))
-		_, err := io.ReadFull(s, bb)
-		if err != nil {
-			t.Fatalf("%s #%d: %s", name, i, err)
-		}
-		if !bytes.Equal(b, bb) {
-			t.Fatalf("%s #%d: mismatch on read: got:%x want:%x", name, i, bb, b)
-		}
-	}
-}
+// blockingSource is an io.Reader that blocks a Read call until it's closed.
+type blockingSource chan bool
 
-func TestHandshakeClientRSARC4(t *testing.T) {
-	var config = *testConfig
-	config.CipherSuites = []uint16{TLS_RSA_WITH_RC4_128_SHA}
-	testClientScript(t, "RSA-RC4", rsaRC4ClientScript, &config)
+func (b blockingSource) Read([]byte) (n int, err error) {
+	<-b
+	return 0, io.EOF
 }
 
-func TestHandshakeClientECDHERSAAES(t *testing.T) {
-	var config = *testConfig
-	config.CipherSuites = []uint16{TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA}
-	testClientScript(t, "ECDHE-RSA-AES", ecdheRSAAESClientScript, &config)
+// clientTest represents a test of the TLS client handshake against a reference
+// implementation.
+type clientTest struct {
+	// name is a freeform string identifying the test and the file in which
+	// the expected results will be stored.
+	name string
+	// command, if not empty, contains a series of arguments for the
+	// command to run for the reference server.
+	command []string
+	// config, if not nil, contains a custom Config to use for this test.
+	config *Config
+	// cert, if not empty, contains a DER-encoded certificate for the
+	// reference server.
+	cert []byte
+	// key, if not nil, contains either a *rsa.PrivateKey or
+	// *ecdsa.PrivateKey which is the private key for the reference server.
+	key interface{}
 }
 
-func TestHandshakeClientECDHECDSAAES(t *testing.T) {
-	var config = *testConfig
-	config.CipherSuites = []uint16{TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA}
-	config.Certificates = nil
-	config.BuildNameToCertificate()
-	testClientScript(t, "ECDHE-ECDSA-AES", ecdheECDSAAESClientScript, &config)
-}
-
-func TestLongClientCerticiateChain(t *testing.T) {
-	config := *testConfig
-	cert, _ := X509KeyPair(testClientChainCertificate, testClientChainCertificate)
-	config.Certificates = []Certificate{cert}
-	testClientScript(t, "Long client certificate chains", clientChainCertificateScript, &config)
-}
+var defaultServerCommand = []string{"openssl", "s_server"}
 
-func TestHandshakeClientTLS11(t *testing.T) {
-	var config = *testConfig
-	config.MaxVersion = VersionTLS11
-	config.CipherSuites = []uint16{TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA}
-	testClientScript(t, "TLS11-ECDHE-AES", tls11ECDHEAESClientScript, &config)
-}
+// connFromCommand starts the reference server process, connects to it and
+// returns a recordingConn for the connection. The stdin return value is a
+// blockingSource for the stdin of the child process. It must be closed before
+// Waiting for child.
+func (test *clientTest) connFromCommand() (conn *recordingConn, child *exec.Cmd, stdin blockingSource, err error) {
+	cert := testRSACertificate
+	if len(test.cert) > 0 {
+		cert = test.cert
+	}
+	certPath := tempFile(string(cert))
+	defer os.Remove(certPath)
 
-func TestHandshakeClientTLS12(t *testing.T) {
-	config := *testConfig
-	config.MaxVersion = VersionTLS12
-	config.CipherSuites = []uint16{TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA}
-	cert, _ := X509KeyPair(testClientChainCertificate, testClientChainCertificate)
-	config.Certificates = []Certificate{cert}
-	testClientScript(t, "TLS12", clientTLS12Script, &config)
-}
+	var key interface{} = testRSAPrivateKey
+	if test.key != nil {
+		key = test.key
+	}
+	var pemType string
+	var derBytes []byte
+	switch key := key.(type) {
+	case *rsa.PrivateKey:
+		pemType = "RSA"
+		derBytes = x509.MarshalPKCS1PrivateKey(key)
+	case *ecdsa.PrivateKey:
+		pemType = "EC"
+		var err error
+		derBytes, err = x509.MarshalECPrivateKey(key)
+		if err != nil {
+			panic(err)
+		}
+	default:
+		panic("unknown key type")
+	}
 
-func TestHandshakeClientTLS12ClientCert(t *testing.T) {
-	config := *testConfig
-	config.MaxVersion = VersionTLS12
-	config.CipherSuites = []uint16{TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256}
-	cert, _ := X509KeyPair(testClientChainCertificate, testClientChainCertificate)
-	config.Certificates = []Certificate{cert}
-	testClientScript(t, "TLS12ClientCert", clientTLS12ClientCertScript, &config)
-}
+	var pemOut bytes.Buffer
+	pem.Encode(&pemOut, &pem.Block{Type: pemType + " PRIVATE KEY", Bytes: derBytes})
 
-var connect = flag.Bool("connect", false, "connect to a TLS server on :10443")
+	keyPath := tempFile(string(pemOut.Bytes()))
+	defer os.Remove(keyPath)
 
-func TestRunClient(t *testing.T) {
-	if !*connect {
-		return
+	var command []string
+	if len(test.command) > 0 {
+		command = append(command, test.command...)
+	} else {
+		command = append(command, defaultServerCommand...)
+	}
+	command = append(command, "-cert", certPath, "-certform", "DER", "-key", keyPath)
+	// serverPort contains the port that OpenSSL will listen on. OpenSSL
+	// can't take "0" as an argument here so we have to pick a number and
+	// hope that it's not in use on the machine. Since this only occurs
+	// when -update is given and thus when there's a human watching the
+	// test, this isn't too bad.
+	const serverPort = 24323
+	command = append(command, "-accept", strconv.Itoa(serverPort))
+
+	cmd := exec.Command(command[0], command[1:]...)
+	stdin = blockingSource(make(chan bool))
+	cmd.Stdin = stdin
+	var out bytes.Buffer
+	cmd.Stdout = &out
+	cmd.Stderr = &out
+	if err := cmd.Start(); err != nil {
+		return nil, nil, nil, err
 	}
 
-	tcpConn, err := net.Dial("tcp", "127.0.0.1:10443")
-	if err != nil {
-		t.Fatal(err)
+	// OpenSSL does print an "ACCEPT" banner, but it does so *before*
+	// opening the listening socket, so we can't use that to wait until it
+	// has started listening. Thus we are forced to poll until we get a
+	// connection.
+	var tcpConn net.Conn
+	for i := uint(0); i < 5; i++ {
+		var err error
+		tcpConn, err = net.DialTCP("tcp", nil, &net.TCPAddr{
+			IP:   net.IPv4(127, 0, 0, 1),
+			Port: serverPort,
+		})
+		if err == nil {
+			break
+		}
+		time.Sleep((1 << i) * 5 * time.Millisecond)
+	}
+	if tcpConn == nil {
+		close(stdin)
+		out.WriteTo(os.Stdout)
+		cmd.Process.Kill()
+		return nil, nil, nil, cmd.Wait()
 	}
 
 	record := &recordingConn{
 		Conn: tcpConn,
 	}
 
-	config := GetTestConfig()
-	conn := Client(record, config)
-	if err := conn.Handshake(); err != nil {
-		t.Fatalf("error from TLS handshake: %s", err)
-	}
+	return record, cmd, stdin, nil
+}
 
-	conn.Write([]byte("hello\n"))
-	conn.Close()
+func (test *clientTest) dataPath() string {
+	return filepath.Join("testdata", "Client-"+test.name)
+}
 
-	record.WriteTo(os.Stdout)
+func (test *clientTest) loadData() (flows [][]byte, err error) {
+	in, err := os.Open(test.dataPath())
+	if err != nil {
+		return nil, err
+	}
+	defer in.Close()
+	return parseTestData(in)
 }
 
-func TestEmptyRecords(t *testing.T) {
-	// emptyRecordScript contains a TLS connection with an empty record as
-	// the first application data from the server. This test ensures that
-	// the empty record doesn't cause (0, nil) to be returned from
-	// Conn.Read.
-	config := *testConfig
-	config.CipherSuites = []uint16{TLS_RSA_WITH_AES_256_CBC_SHA}
-
-	c, s := net.Pipe()
-	cli := Client(c, &config)
-	go func() {
-		buf := make([]byte, 1024)
-		n, err := cli.Read(buf)
-		defer c.Close()
-		defer cli.Close()
+func (test *clientTest) run(t *testing.T, write bool) {
+	var clientConn, serverConn net.Conn
+	var recordingConn *recordingConn
+	var childProcess *exec.Cmd
+	var stdin blockingSource
 
+	if write {
+		var err error
+		recordingConn, childProcess, stdin, err = test.connFromCommand()
 		if err != nil {
-			t.Fatalf("error reading from tls.Client: %s", err)
+			t.Fatalf("Failed to start subcommand: %s", err)
 		}
-		const expectedLength = 197
-		if n != expectedLength {
-			t.Fatalf("incorrect length reading from tls.Client, got %d, want %d", n, expectedLength)
+		clientConn = recordingConn
+	} else {
+		clientConn, serverConn = net.Pipe()
+	}
+
+	config := test.config
+	if config == nil {
+		config = testConfig
+	}
+	client := Client(clientConn, config)
+
+	doneChan := make(chan bool)
+	go func() {
+		if _, err := client.Write([]byte("hello\n")); err != nil {
+			t.Logf("Client.Write failed: %s", err)
 		}
+		client.Close()
+		clientConn.Close()
+		doneChan <- true
 	}()
 
-	defer c.Close()
-	for i, b := range emptyRecordScript {
-		if i%2 == 1 {
-			s.Write(b)
-			continue
+	if !write {
+		flows, err := test.loadData()
+		if err != nil {
+			t.Fatalf("%s: failed to load data from %s", test.name, test.dataPath())
+		}
+		for i, b := range flows {
+			if i%2 == 1 {
+				serverConn.Write(b)
+				continue
+			}
+			bb := make([]byte, len(b))
+			_, err := io.ReadFull(serverConn, bb)
+			if err != nil {
+				t.Fatalf("%s #%d: %s", test.name, i, err)
+			}
+			if !bytes.Equal(b, bb) {
+				t.Fatalf("%s #%d: mismatch on read: got:%x want:%x", test.name, i, bb, b)
+			}
 		}
-		bb := make([]byte, len(b))
-		_, err := io.ReadFull(s, bb)
+		serverConn.Close()
+	}
+
+	<-doneChan
+
+	if write {
+		path := test.dataPath()
+		out, err := os.OpenFile(path, os.O_WRONLY|os.O_CREATE|os.O_TRUNC, 0644)
 		if err != nil {
-			t.Fatalf("#%d: %s", i, err)
+			t.Fatalf("Failed to create output file: %s", err)
 		}
-		if !bytes.Equal(b, bb) {
-			t.Fatalf("#%d: mismatch on read: got:%x want:%x", i, bb, b)
+		defer out.Close()
+		recordingConn.Close()
+		close(stdin)
+		childProcess.Process.Kill()
+		childProcess.Wait()
+		if len(recordingConn.flows) < 3 {
+			childProcess.Stdout.(*bytes.Buffer).WriteTo(os.Stdout)
+			t.Fatalf("Client connection didn't work")
 		}
+		recordingConn.WriteTo(out)
+		fmt.Printf("Wrote %s\n", path)
 	}
 }
 
-// Script of interaction with gnutls implementation.
-// The values for this test are obtained by building and running in client mode:
-//   % go test -test.run "TestRunClient" -connect
-// The recorded bytes are written to stdout.
-//
-// The server private key is:
-// -----BEGIN RSA PRIVATE KEY-----
-// MIIBPAIBAAJBAJ+zw4Qnlf8SMVIPFe9GEcStgOY2Ww/dgNdhjeD8ckUJNP5VZkVD
-// TGiXav6ooKXfX3j/7tdkuD8Ey2//Kv7+ue0CAwEAAQJAN6W31vDEP2DjdqhzCDDu
-// OA4NACqoiFqyblo7yc2tM4h4xMbC3Yx5UKMN9ZkCtX0gzrz6DyF47bdKcWBzNWCj
-// gQIhANEoojVt7hq+SQ6MCN6FTAysGgQf56Q3TYoJMoWvdiXVAiEAw3e3rc+VJpOz
-// rHuDo6bgpjUAAXM+v3fcpsfZSNO6V7kCIQCtbVjanpUwvZkMI9by02oUk9taki3b
-// PzPfAfNPYAbCJQIhAJXNQDWyqwn/lGmR11cqY2y9nZ1+5w3yHGatLrcDnQHxAiEA
-// vnlEGo8K85u+KwIOimM48ZG8oTk7iFdkqLJR1utT3aU=
-// -----END RSA PRIVATE KEY-----
-//
-// and certificate is:
-// -----BEGIN CERTIFICATE-----
-// MIICKzCCAdWgAwIBAgIJALE1E2URIMWSMA0GCSqGSIb3DQEBBQUAMEUxCzAJBgNV
-// BAYTAkFVMRMwEQYDVQQIEwpTb21lLVN0YXRlMSEwHwYDVQQKExhJbnRlcm5ldCBX
-// aWRnaXRzIFB0eSBMdGQwHhcNMTIwNDA2MTcxMDEzWhcNMTUwNDA2MTcxMDEzWjBF
-// MQswCQYDVQQGEwJBVTETMBEGA1UECBMKU29tZS1TdGF0ZTEhMB8GA1UEChMYSW50
-// ZXJuZXQgV2lkZ2l0cyBQdHkgTHRkMFwwDQYJKoZIhvcNAQEBBQADSwAwSAJBAJ+z
-// w4Qnlf8SMVIPFe9GEcStgOY2Ww/dgNdhjeD8ckUJNP5VZkVDTGiXav6ooKXfX3j/
-// 7tdkuD8Ey2//Kv7+ue0CAwEAAaOBpzCBpDAdBgNVHQ4EFgQUeKaXmmO1xaGlM7oi
-// fCNuWxt6zCswdQYDVR0jBG4wbIAUeKaXmmO1xaGlM7oifCNuWxt6zCuhSaRHMEUx
-// CzAJBgNVBAYTAkFVMRMwEQYDVQQIEwpTb21lLVN0YXRlMSEwHwYDVQQKExhJbnRl
-// cm5ldCBXaWRnaXRzIFB0eSBMdGSCCQCxNRNlESDFkjAMBgNVHRMEBTADAQH/MA0G
-// CSqGSIb3DQEBBQUAA0EAhTZAc8G7GtrUWZ8tonAxRnTsg26oyDxRrzms7EC86CJG
-// HZnWRiok1IsFCEv7NRFukrt3uuQSu/TIXpyBqJdgTA==
-// -----END CERTIFICATE-----
-var rsaRC4ClientScript = [][]byte{
-	{
-		0x16, 0x03, 0x01, 0x00, 0x4a, 0x01, 0x00, 0x00,
-		0x46, 0x03, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x05,
-		0x01, 0x00, 0x00, 0x1b, 0x00, 0x05, 0x00, 0x05,
-		0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0a, 0x00,
-		0x08, 0x00, 0x06, 0x00, 0x17, 0x00, 0x18, 0x00,
-		0x19, 0x00, 0x0b, 0x00, 0x02, 0x01, 0x00,
-	},
-
-	{
-		0x16, 0x03, 0x01, 0x00, 0x4a, 0x02, 0x00, 0x00,
-		0x46, 0x03, 0x01, 0x4d, 0x0a, 0x56, 0x16, 0xb5,
-		0x91, 0xd1, 0xcb, 0x80, 0x4d, 0xc7, 0x46, 0xf3,
-		0x37, 0x0c, 0xef, 0xea, 0x64, 0x11, 0x14, 0x56,
-		0x97, 0x9b, 0xc5, 0x67, 0x08, 0xb7, 0x13, 0xea,
-		0xf8, 0xc9, 0xb3, 0x20, 0xe2, 0xfc, 0x41, 0xf6,
-		0x96, 0x90, 0x9d, 0x43, 0x9b, 0xe9, 0x6e, 0xf8,
-		0x41, 0x16, 0xcc, 0xf3, 0xc7, 0xde, 0xda, 0x5a,
-		0xa1, 0x33, 0x69, 0xe2, 0xde, 0x5b, 0xaf, 0x2a,
-		0x92, 0xe7, 0xd4, 0xa0, 0x00, 0x05, 0x00, 0x16,
-		0x03, 0x01, 0x01, 0xf7, 0x0b, 0x00, 0x01, 0xf3,
-		0x00, 0x01, 0xf0, 0x00, 0x01, 0xed, 0x30, 0x82,
-		0x01, 0xe9, 0x30, 0x82, 0x01, 0x52, 0x02, 0x01,
-		0x06, 0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48,
-		0x86, 0xf7, 0x0d, 0x01, 0x01, 0x04, 0x05, 0x00,
-		0x30, 0x5b, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03,
-		0x55, 0x04, 0x06, 0x13, 0x02, 0x41, 0x55, 0x31,
-		0x13, 0x30, 0x11, 0x06, 0x03, 0x55, 0x04, 0x08,
-		0x13, 0x0a, 0x51, 0x75, 0x65, 0x65, 0x6e, 0x73,
-		0x6c, 0x61, 0x6e, 0x64, 0x31, 0x1a, 0x30, 0x18,
-		0x06, 0x03, 0x55, 0x04, 0x0a, 0x13, 0x11, 0x43,
-		0x72, 0x79, 0x70, 0x74, 0x53, 0x6f, 0x66, 0x74,
-		0x20, 0x50, 0x74, 0x79, 0x20, 0x4c, 0x74, 0x64,
-		0x31, 0x1b, 0x30, 0x19, 0x06, 0x03, 0x55, 0x04,
-		0x03, 0x13, 0x12, 0x54, 0x65, 0x73, 0x74, 0x20,
-		0x43, 0x41, 0x20, 0x28, 0x31, 0x30, 0x32, 0x34,
-		0x20, 0x62, 0x69, 0x74, 0x29, 0x30, 0x1e, 0x17,
-		0x0d, 0x30, 0x30, 0x31, 0x30, 0x31, 0x36, 0x32,
-		0x32, 0x33, 0x31, 0x30, 0x33, 0x5a, 0x17, 0x0d,
-		0x30, 0x33, 0x30, 0x31, 0x31, 0x34, 0x32, 0x32,
-		0x33, 0x31, 0x30, 0x33, 0x5a, 0x30, 0x63, 0x31,
-		0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06,
-		0x13, 0x02, 0x41, 0x55, 0x31, 0x13, 0x30, 0x11,
-		0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0a, 0x51,
-		0x75, 0x65, 0x65, 0x6e, 0x73, 0x6c, 0x61, 0x6e,
-		0x64, 0x31, 0x1a, 0x30, 0x18, 0x06, 0x03, 0x55,
-		0x04, 0x0a, 0x13, 0x11, 0x43, 0x72, 0x79, 0x70,
-		0x74, 0x53, 0x6f, 0x66, 0x74, 0x20, 0x50, 0x74,
-		0x79, 0x20, 0x4c, 0x74, 0x64, 0x31, 0x23, 0x30,
-		0x21, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13, 0x1a,
-		0x53, 0x65, 0x72, 0x76, 0x65, 0x72, 0x20, 0x74,
-		0x65, 0x73, 0x74, 0x20, 0x63, 0x65, 0x72, 0x74,
-		0x20, 0x28, 0x35, 0x31, 0x32, 0x20, 0x62, 0x69,
-		0x74, 0x29, 0x30, 0x5c, 0x30, 0x0d, 0x06, 0x09,
-		0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01,
-		0x01, 0x05, 0x00, 0x03, 0x4b, 0x00, 0x30, 0x48,
-		0x02, 0x41, 0x00, 0x9f, 0xb3, 0xc3, 0x84, 0x27,
-		0x95, 0xff, 0x12, 0x31, 0x52, 0x0f, 0x15, 0xef,
-		0x46, 0x11, 0xc4, 0xad, 0x80, 0xe6, 0x36, 0x5b,
-		0x0f, 0xdd, 0x80, 0xd7, 0x61, 0x8d, 0xe0, 0xfc,
-		0x72, 0x45, 0x09, 0x34, 0xfe, 0x55, 0x66, 0x45,
-		0x43, 0x4c, 0x68, 0x97, 0x6a, 0xfe, 0xa8, 0xa0,
-		0xa5, 0xdf, 0x5f, 0x78, 0xff, 0xee, 0xd7, 0x64,
-		0xb8, 0x3f, 0x04, 0xcb, 0x6f, 0xff, 0x2a, 0xfe,
-		0xfe, 0xb9, 0xed, 0x02, 0x03, 0x01, 0x00, 0x01,
-		0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86,
-		0xf7, 0x0d, 0x01, 0x01, 0x04, 0x05, 0x00, 0x03,
-		0x81, 0x81, 0x00, 0x93, 0xd2, 0x0a, 0xc5, 0x41,
-		0xe6, 0x5a, 0xa9, 0x86, 0xf9, 0x11, 0x87, 0xe4,
-		0xdb, 0x45, 0xe2, 0xc5, 0x95, 0x78, 0x1a, 0x6c,
-		0x80, 0x6d, 0x73, 0x1f, 0xb4, 0x6d, 0x44, 0xa3,
-		0xba, 0x86, 0x88, 0xc8, 0x58, 0xcd, 0x1c, 0x06,
-		0x35, 0x6c, 0x44, 0x62, 0x88, 0xdf, 0xe4, 0xf6,
-		0x64, 0x61, 0x95, 0xef, 0x4a, 0xa6, 0x7f, 0x65,
-		0x71, 0xd7, 0x6b, 0x88, 0x39, 0xf6, 0x32, 0xbf,
-		0xac, 0x93, 0x67, 0x69, 0x51, 0x8c, 0x93, 0xec,
-		0x48, 0x5f, 0xc9, 0xb1, 0x42, 0xf9, 0x55, 0xd2,
-		0x7e, 0x4e, 0xf4, 0xf2, 0x21, 0x6b, 0x90, 0x57,
-		0xe6, 0xd7, 0x99, 0x9e, 0x41, 0xca, 0x80, 0xbf,
-		0x1a, 0x28, 0xa2, 0xca, 0x5b, 0x50, 0x4a, 0xed,
-		0x84, 0xe7, 0x82, 0xc7, 0xd2, 0xcf, 0x36, 0x9e,
-		0x6a, 0x67, 0xb9, 0x88, 0xa7, 0xf3, 0x8a, 0xd0,
-		0x04, 0xf8, 0xe8, 0xc6, 0x17, 0xe3, 0xc5, 0x29,
-		0xbc, 0x17, 0xf1, 0x16, 0x03, 0x01, 0x00, 0x04,
-		0x0e, 0x00, 0x00, 0x00,
-	},
+func runClientTestForVersion(t *testing.T, template *clientTest, prefix, option string) {
+	test := *template
+	test.name = prefix + test.name
+	if len(test.command) == 0 {
+		test.command = defaultClientCommand
+	}
+	test.command = append([]string(nil), test.command...)
+	test.command = append(test.command, option)
+	test.run(t, *update)
+}
 
-	{
-		0x16, 0x03, 0x01, 0x00, 0x46, 0x10, 0x00, 0x00,
-		0x42, 0x00, 0x40, 0x87, 0xa1, 0x1f, 0x14, 0xe1,
-		0xfb, 0x91, 0xac, 0x58, 0x2e, 0xf3, 0x71, 0xce,
-		0x01, 0x85, 0x2c, 0xc7, 0xfe, 0x84, 0x87, 0x82,
-		0xb7, 0x57, 0xdb, 0x37, 0x4d, 0x46, 0x83, 0x67,
-		0x52, 0x82, 0x51, 0x01, 0x95, 0x23, 0x68, 0x69,
-		0x6b, 0xd0, 0xa7, 0xa7, 0xe5, 0x88, 0xd0, 0x47,
-		0x71, 0xb8, 0xd2, 0x03, 0x05, 0x25, 0x56, 0x5c,
-		0x10, 0x08, 0xc6, 0x9b, 0xd4, 0x67, 0xcd, 0x28,
-		0xbe, 0x9c, 0x48, 0x14, 0x03, 0x01, 0x00, 0x01,
-		0x01, 0x16, 0x03, 0x01, 0x00, 0x24, 0xc1, 0xb8,
-		0xd3, 0x7f, 0xc5, 0xc2, 0x5a, 0x1d, 0x6d, 0x5b,
-		0x2d, 0x5c, 0x82, 0x87, 0xc2, 0x6f, 0x0d, 0x63,
-		0x7b, 0x72, 0x2b, 0xda, 0x69, 0xc4, 0xfe, 0x3c,
-		0x84, 0xa1, 0x5a, 0x62, 0x38, 0x37, 0xc6, 0x54,
-		0x25, 0x2a,
-	},
+func runClientTestTLS10(t *testing.T, template *clientTest) {
+	runClientTestForVersion(t, template, "TLSv10-", "-tls1")
+}
 
-	{
-		0x14, 0x03, 0x01, 0x00, 0x01, 0x01, 0x16, 0x03,
-		0x01, 0x00, 0x24, 0xea, 0x88, 0x9c, 0x00, 0xf6,
-		0x35, 0xb8, 0x42, 0x7f, 0x15, 0x17, 0x76, 0x5e,
-		0x4b, 0x24, 0xcb, 0x7e, 0xa0, 0x7b, 0xc3, 0x70,
-		0x52, 0x0a, 0x88, 0x2a, 0x7a, 0x45, 0x59, 0x90,
-		0x59, 0xac, 0xc6, 0xb5, 0x56, 0x55, 0x96,
-	},
+func runClientTestTLS11(t *testing.T, template *clientTest) {
+	runClientTestForVersion(t, template, "TLSv11-", "-tls1_1")
 }
 
-var ecdheRSAAESClientScript = [][]byte{
-	{
-		0x16, 0x03, 0x01, 0x00, 0x4a, 0x01, 0x00, 0x00,
-		0x46, 0x03, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0xc0, 0x13,
-		0x01, 0x00, 0x00, 0x1b, 0x00, 0x05, 0x00, 0x05,
-		0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0a, 0x00,
-		0x08, 0x00, 0x06, 0x00, 0x17, 0x00, 0x18, 0x00,
-		0x19, 0x00, 0x0b, 0x00, 0x02, 0x01, 0x00,
-	},
-	{
-		0x16, 0x03, 0x01, 0x00, 0x52, 0x02, 0x00, 0x00,
-		0x4e, 0x03, 0x01, 0x50, 0xad, 0x72, 0xb1, 0x14,
-		0x45, 0xce, 0x0a, 0x95, 0xf9, 0x63, 0xef, 0xa8,
-		0xe5, 0x07, 0x34, 0x04, 0xe9, 0x08, 0x0f, 0x38,
-		0xe4, 0x28, 0x27, 0x91, 0x07, 0x03, 0xe2, 0xfe,
-		0xe3, 0x25, 0xf7, 0x20, 0x08, 0x42, 0xa2, 0x01,
-		0x69, 0x53, 0xf0, 0xd9, 0x4c, 0xfa, 0x01, 0xa1,
-		0xce, 0x4b, 0xf8, 0x28, 0x21, 0xad, 0x06, 0xbe,
-		0xe0, 0x1b, 0x3b, 0xf7, 0xec, 0xd2, 0x52, 0xae,
-		0x2a, 0x57, 0xb7, 0xa8, 0xc0, 0x13, 0x00, 0x00,
-		0x06, 0x00, 0x0b, 0x00, 0x02, 0x01, 0x00, 0x16,
-		0x03, 0x01, 0x02, 0x39, 0x0b, 0x00, 0x02, 0x35,
-		0x00, 0x02, 0x32, 0x00, 0x02, 0x2f, 0x30, 0x82,
-		0x02, 0x2b, 0x30, 0x82, 0x01, 0xd5, 0xa0, 0x03,
-		0x02, 0x01, 0x02, 0x02, 0x09, 0x00, 0xb1, 0x35,
-		0x13, 0x65, 0x11, 0x20, 0xc5, 0x92, 0x30, 0x0d,
-		0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d,
-		0x01, 0x01, 0x05, 0x05, 0x00, 0x30, 0x45, 0x31,
-		0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06,
-		0x13, 0x02, 0x41, 0x55, 0x31, 0x13, 0x30, 0x11,
-		0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0a, 0x53,
-		0x6f, 0x6d, 0x65, 0x2d, 0x53, 0x74, 0x61, 0x74,
-		0x65, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x03, 0x55,
-		0x04, 0x0a, 0x13, 0x18, 0x49, 0x6e, 0x74, 0x65,
-		0x72, 0x6e, 0x65, 0x74, 0x20, 0x57, 0x69, 0x64,
-		0x67, 0x69, 0x74, 0x73, 0x20, 0x50, 0x74, 0x79,
-		0x20, 0x4c, 0x74, 0x64, 0x30, 0x1e, 0x17, 0x0d,
-		0x31, 0x32, 0x30, 0x34, 0x30, 0x36, 0x31, 0x37,
-		0x31, 0x30, 0x31, 0x33, 0x5a, 0x17, 0x0d, 0x31,
-		0x35, 0x30, 0x34, 0x30, 0x36, 0x31, 0x37, 0x31,
-		0x30, 0x31, 0x33, 0x5a, 0x30, 0x45, 0x31, 0x0b,
-		0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13,
-		0x02, 0x41, 0x55, 0x31, 0x13, 0x30, 0x11, 0x06,
-		0x03, 0x55, 0x04, 0x08, 0x13, 0x0a, 0x53, 0x6f,
-		0x6d, 0x65, 0x2d, 0x53, 0x74, 0x61, 0x74, 0x65,
-		0x31, 0x21, 0x30, 0x1f, 0x06, 0x03, 0x55, 0x04,
-		0x0a, 0x13, 0x18, 0x49, 0x6e, 0x74, 0x65, 0x72,
-		0x6e, 0x65, 0x74, 0x20, 0x57, 0x69, 0x64, 0x67,
-		0x69, 0x74, 0x73, 0x20, 0x50, 0x74, 0x79, 0x20,
-		0x4c, 0x74, 0x64, 0x30, 0x5c, 0x30, 0x0d, 0x06,
-		0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01,
-		0x01, 0x01, 0x05, 0x00, 0x03, 0x4b, 0x00, 0x30,
-		0x48, 0x02, 0x41, 0x00, 0x9f, 0xb3, 0xc3, 0x84,
-		0x27, 0x95, 0xff, 0x12, 0x31, 0x52, 0x0f, 0x15,
-		0xef, 0x46, 0x11, 0xc4, 0xad, 0x80, 0xe6, 0x36,
-		0x5b, 0x0f, 0xdd, 0x80, 0xd7, 0x61, 0x8d, 0xe0,
-		0xfc, 0x72, 0x45, 0x09, 0x34, 0xfe, 0x55, 0x66,
-		0x45, 0x43, 0x4c, 0x68, 0x97, 0x6a, 0xfe, 0xa8,
-		0xa0, 0xa5, 0xdf, 0x5f, 0x78, 0xff, 0xee, 0xd7,
-		0x64, 0xb8, 0x3f, 0x04, 0xcb, 0x6f, 0xff, 0x2a,
-		0xfe, 0xfe, 0xb9, 0xed, 0x02, 0x03, 0x01, 0x00,
-		0x01, 0xa3, 0x81, 0xa7, 0x30, 0x81, 0xa4, 0x30,
-		0x1d, 0x06, 0x03, 0x55, 0x1d, 0x0e, 0x04, 0x16,
-		0x04, 0x14, 0x78, 0xa6, 0x97, 0x9a, 0x63, 0xb5,
-		0xc5, 0xa1, 0xa5, 0x33, 0xba, 0x22, 0x7c, 0x23,
-		0x6e, 0x5b, 0x1b, 0x7a, 0xcc, 0x2b, 0x30, 0x75,
-		0x06, 0x03, 0x55, 0x1d, 0x23, 0x04, 0x6e, 0x30,
-		0x6c, 0x80, 0x14, 0x78, 0xa6, 0x97, 0x9a, 0x63,
-		0xb5, 0xc5, 0xa1, 0xa5, 0x33, 0xba, 0x22, 0x7c,
-		0x23, 0x6e, 0x5b, 0x1b, 0x7a, 0xcc, 0x2b, 0xa1,
-		0x49, 0xa4, 0x47, 0x30, 0x45, 0x31, 0x0b, 0x30,
-		0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02,
-		0x41, 0x55, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03,
-		0x55, 0x04, 0x08, 0x13, 0x0a, 0x53, 0x6f, 0x6d,
-		0x65, 0x2d, 0x53, 0x74, 0x61, 0x74, 0x65, 0x31,
-		0x21, 0x30, 0x1f, 0x06, 0x03, 0x55, 0x04, 0x0a,
-		0x13, 0x18, 0x49, 0x6e, 0x74, 0x65, 0x72, 0x6e,
-		0x65, 0x74, 0x20, 0x57, 0x69, 0x64, 0x67, 0x69,
-		0x74, 0x73, 0x20, 0x50, 0x74, 0x79, 0x20, 0x4c,
-		0x74, 0x64, 0x82, 0x09, 0x00, 0xb1, 0x35, 0x13,
-		0x65, 0x11, 0x20, 0xc5, 0x92, 0x30, 0x0c, 0x06,
-		0x03, 0x55, 0x1d, 0x13, 0x04, 0x05, 0x30, 0x03,
-		0x01, 0x01, 0xff, 0x30, 0x0d, 0x06, 0x09, 0x2a,
-		0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x05,
-		0x05, 0x00, 0x03, 0x41, 0x00, 0x85, 0x36, 0x40,
-		0x73, 0xc1, 0xbb, 0x1a, 0xda, 0xd4, 0x59, 0x9f,
-		0x2d, 0xa2, 0x70, 0x31, 0x46, 0x74, 0xec, 0x83,
-		0x6e, 0xa8, 0xc8, 0x3c, 0x51, 0xaf, 0x39, 0xac,
-		0xec, 0x40, 0xbc, 0xe8, 0x22, 0x46, 0x1d, 0x99,
-		0xd6, 0x46, 0x2a, 0x24, 0xd4, 0x8b, 0x05, 0x08,
-		0x4b, 0xfb, 0x35, 0x11, 0x6e, 0x92, 0xbb, 0x77,
-		0xba, 0xe4, 0x12, 0xbb, 0xf4, 0xc8, 0x5e, 0x9c,
-		0x81, 0xa8, 0x97, 0x60, 0x4c, 0x16, 0x03, 0x01,
-		0x00, 0x8b, 0x0c, 0x00, 0x00, 0x87, 0x03, 0x00,
-		0x17, 0x41, 0x04, 0x1c, 0x8f, 0x9c, 0x6d, 0xe7,
-		0xab, 0x3e, 0xf8, 0x0a, 0x5d, 0xe1, 0x86, 0xb4,
-		0xe2, 0x8e, 0xb2, 0x1c, 0x3b, 0xd9, 0xb6, 0x08,
-		0x80, 0x58, 0x21, 0xe9, 0x0e, 0xc6, 0x66, 0x67,
-		0x97, 0xcb, 0xb9, 0x92, 0x07, 0x00, 0xc4, 0xe5,
-		0xec, 0x5f, 0xb4, 0xe2, 0x20, 0xa9, 0xc9, 0x62,
-		0xd0, 0x98, 0xd5, 0xe3, 0x53, 0xff, 0xd0, 0x0a,
-		0x6e, 0x29, 0x69, 0x39, 0x2a, 0x4b, 0x5c, 0xd8,
-		0x6c, 0xf5, 0xfe, 0x00, 0x40, 0x35, 0xa7, 0x26,
-		0x2e, 0xc2, 0x48, 0x93, 0x32, 0xf7, 0x7d, 0x0f,
-		0x0d, 0x77, 0x56, 0x9a, 0x85, 0x0c, 0xa6, 0x74,
-		0x06, 0xb8, 0x3d, 0x90, 0x56, 0x12, 0x63, 0xff,
-		0x00, 0x5e, 0x0f, 0xf7, 0x24, 0xf7, 0xdb, 0x48,
-		0x71, 0xe9, 0x2e, 0x03, 0xd3, 0xfa, 0x3a, 0xae,
-		0xa0, 0xc1, 0x77, 0x3c, 0x4c, 0x59, 0xce, 0x33,
-		0x1a, 0xd2, 0x47, 0x83, 0xfa, 0xea, 0xd8, 0x1e,
-		0x06, 0xe7, 0x7d, 0xa0, 0x9b, 0x16, 0x03, 0x01,
-		0x00, 0x04, 0x0e, 0x00, 0x00, 0x00,
-	},
-	{
-		0x16, 0x03, 0x01, 0x00, 0x46, 0x10, 0x00, 0x00,
-		0x42, 0x41, 0x04, 0x1e, 0x18, 0x37, 0xef, 0x0d,
-		0x19, 0x51, 0x88, 0x35, 0x75, 0x71, 0xb5, 0xe5,
-		0x54, 0x5b, 0x12, 0x2e, 0x8f, 0x09, 0x67, 0xfd,
-		0xa7, 0x24, 0x20, 0x3e, 0xb2, 0x56, 0x1c, 0xce,
-		0x97, 0x28, 0x5e, 0xf8, 0x2b, 0x2d, 0x4f, 0x9e,
-		0xf1, 0x07, 0x9f, 0x6c, 0x4b, 0x5b, 0x83, 0x56,
-		0xe2, 0x32, 0x42, 0xe9, 0x58, 0xb6, 0xd7, 0x49,
-		0xa6, 0xb5, 0x68, 0x1a, 0x41, 0x03, 0x56, 0x6b,
-		0xdc, 0x5a, 0x89, 0x14, 0x03, 0x01, 0x00, 0x01,
-		0x01, 0x16, 0x03, 0x01, 0x00, 0x30, 0xd9, 0xa7,
-		0x80, 0x56, 0x3f, 0xa3, 0x8f, 0x96, 0x72, 0x4e,
-		0x4e, 0x6e, 0x23, 0x41, 0x8f, 0xda, 0x91, 0xb2,
-		0x9e, 0x63, 0x23, 0x82, 0x64, 0xcd, 0x07, 0x24,
-		0xd3, 0x40, 0x20, 0x22, 0x4c, 0xe3, 0xff, 0x38,
-		0xbb, 0x43, 0x9d, 0x57, 0x11, 0xd5, 0x46, 0xa5,
-		0x05, 0x29, 0x92, 0x02, 0xce, 0xdf,
-	},
-	{
-		0x14, 0x03, 0x01, 0x00, 0x01, 0x01, 0x16, 0x03,
-		0x01, 0x00, 0x90, 0xe7, 0xba, 0x0e, 0xb1, 0xda,
-		0x92, 0xb5, 0x77, 0x56, 0x38, 0xa6, 0x22, 0xc1,
-		0x72, 0xeb, 0x8a, 0x68, 0x09, 0xb6, 0x74, 0xad,
-		0xb3, 0x4a, 0xf2, 0xdd, 0x09, 0x9b, 0xc9, 0x4f,
-		0x84, 0x73, 0x8b, 0xd6, 0x97, 0x50, 0x23, 0x1c,
-		0xa0, 0xc2, 0x0c, 0x25, 0x18, 0xdd, 0x5e, 0x15,
-		0x4d, 0xd9, 0xef, 0x4f, 0x6a, 0x43, 0x61, 0x9c,
-		0x95, 0xde, 0x3c, 0x66, 0xc4, 0xc1, 0x33, 0x56,
-		0xdd, 0x2f, 0x90, 0xaf, 0x68, 0x5c, 0x9c, 0xa4,
-		0x90, 0x6d, 0xbf, 0x51, 0x1d, 0x68, 0xcb, 0x81,
-		0x77, 0x52, 0xa0, 0x93, 0x2a, 0xf8, 0xc7, 0x61,
-		0x87, 0x76, 0xca, 0x93, 0x9e, 0xd6, 0xee, 0x6f,
-		0x3f, 0xeb, 0x7d, 0x06, 0xdd, 0x73, 0x4e, 0x27,
-		0x16, 0x63, 0x92, 0xe4, 0xb2, 0x3f, 0x91, 0x23,
-		0x21, 0x97, 0x90, 0xce, 0x53, 0xb8, 0xb0, 0x9d,
-		0xbd, 0xbd, 0x33, 0x84, 0xad, 0x6b, 0x2e, 0x7b,
-		0xf5, 0xeb, 0x1d, 0x64, 0x37, 0x2e, 0x29, 0x4e,
-		0xb0, 0x93, 0xdb, 0x92, 0xc7, 0xaa, 0x94, 0xa5,
-		0x3b, 0x64, 0xd0,
-	},
-	{
-		0x17, 0x03, 0x01, 0x00, 0x20, 0x11, 0xd8, 0x6b,
-		0x3c, 0xf6, 0xbe, 0xf4, 0x54, 0x87, 0xec, 0x75,
-		0x0c, 0x44, 0xdb, 0x92, 0xfc, 0xde, 0x7e, 0x0f,
-		0x9f, 0x87, 0x87, 0x9c, 0x03, 0xd5, 0x07, 0x84,
-		0xe0, 0x3a, 0xf8, 0xae, 0x14, 0x17, 0x03, 0x01,
-		0x00, 0x20, 0xba, 0x54, 0xef, 0x5b, 0xce, 0xfd,
-		0x47, 0x76, 0x6d, 0xa1, 0x8b, 0xfd, 0x48, 0xde,
-		0x6e, 0x26, 0xc1, 0x0c, 0x9d, 0x54, 0xbf, 0x98,
-		0xf6, 0x1c, 0x80, 0xb9, 0xca, 0x93, 0x81, 0x0a,
-		0x2e, 0x06, 0x15, 0x03, 0x01, 0x00, 0x20, 0x93,
-		0x3e, 0x38, 0x17, 0xc9, 0x0a, 0xc3, 0xea, 0xd3,
-		0x92, 0x75, 0xa6, 0x53, 0x37, 0x4d, 0x74, 0x94,
-		0xbe, 0x01, 0xdc, 0x5c, 0x5a, 0x0f, 0x09, 0xf6,
-		0x57, 0x33, 0xc3, 0xbc, 0x3f, 0x7a, 0x4d,
-	},
+func runClientTestTLS12(t *testing.T, template *clientTest) {
+	runClientTestForVersion(t, template, "TLSv12-", "-tls1_2")
 }
 
-var emptyRecordScript = [][]byte{
-	{
-		0x16, 0x03, 0x01, 0x00, 0x4a, 0x01, 0x00, 0x00,
-		0x46, 0x03, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x35,
-		0x01, 0x00, 0x00, 0x1b, 0x00, 0x05, 0x00, 0x05,
-		0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0a, 0x00,
-		0x08, 0x00, 0x06, 0x00, 0x17, 0x00, 0x18, 0x00,
-		0x19, 0x00, 0x0b, 0x00, 0x02, 0x01, 0x00,
-	},
-	{
-		0x16, 0x03, 0x01, 0x00, 0x4a, 0x02, 0x00, 0x00,
-		0x46, 0x03, 0x01, 0x51, 0x71, 0x8e, 0x03, 0x02,
-		0xef, 0x09, 0xf2, 0x0e, 0xf5, 0x3b, 0x29, 0x9a,
-		0xa8, 0x8b, 0x46, 0xa3, 0xd4, 0xb4, 0xc1, 0x14,
-		0xc3, 0x19, 0x99, 0xba, 0x3d, 0x78, 0xcf, 0x50,
-		0xd1, 0xe7, 0x26, 0x20, 0xa0, 0x37, 0x6d, 0xc9,
-		0xae, 0x93, 0x33, 0x81, 0x20, 0xe3, 0xc1, 0x90,
-		0x64, 0x6e, 0x67, 0x93, 0xdb, 0xb4, 0x04, 0x16,
-		0xc4, 0x25, 0xdd, 0x10, 0x79, 0x3c, 0x18, 0x0a,
-		0x7c, 0xfd, 0x28, 0x65, 0x00, 0x35, 0x00, 0x16,
-		0x03, 0x01, 0x09, 0x9e, 0x0b, 0x00, 0x09, 0x9a,
-		0x00, 0x09, 0x97, 0x00, 0x04, 0xea, 0x30, 0x82,
-		0x04, 0xe6, 0x30, 0x82, 0x03, 0xce, 0xa0, 0x03,
-		0x02, 0x01, 0x02, 0x02, 0x11, 0x00, 0xff, 0xab,
-		0x02, 0x93, 0xe0, 0x72, 0x99, 0x18, 0x6c, 0x9e,
-		0x96, 0xb8, 0xb9, 0xf7, 0x47, 0xcb, 0x30, 0x0d,
-		0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d,
-		0x01, 0x01, 0x05, 0x05, 0x00, 0x30, 0x41, 0x31,
-		0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06,
-		0x13, 0x02, 0x46, 0x52, 0x31, 0x12, 0x30, 0x10,
-		0x06, 0x03, 0x55, 0x04, 0x0a, 0x13, 0x09, 0x47,
-		0x41, 0x4e, 0x44, 0x49, 0x20, 0x53, 0x41, 0x53,
-		0x31, 0x1e, 0x30, 0x1c, 0x06, 0x03, 0x55, 0x04,
-		0x03, 0x13, 0x15, 0x47, 0x61, 0x6e, 0x64, 0x69,
-		0x20, 0x53, 0x74, 0x61, 0x6e, 0x64, 0x61, 0x72,
-		0x64, 0x20, 0x53, 0x53, 0x4c, 0x20, 0x43, 0x41,
-		0x30, 0x1e, 0x17, 0x0d, 0x31, 0x33, 0x30, 0x31,
-		0x31, 0x34, 0x30, 0x30, 0x30, 0x30, 0x30, 0x30,
-		0x5a, 0x17, 0x0d, 0x31, 0x34, 0x30, 0x31, 0x31,
-		0x34, 0x32, 0x33, 0x35, 0x39, 0x35, 0x39, 0x5a,
-		0x30, 0x62, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x03,
-		0x55, 0x04, 0x0b, 0x13, 0x18, 0x44, 0x6f, 0x6d,
-		0x61, 0x69, 0x6e, 0x20, 0x43, 0x6f, 0x6e, 0x74,
-		0x72, 0x6f, 0x6c, 0x20, 0x56, 0x61, 0x6c, 0x69,
-		0x64, 0x61, 0x74, 0x65, 0x64, 0x31, 0x24, 0x30,
-		0x22, 0x06, 0x03, 0x55, 0x04, 0x0b, 0x13, 0x1b,
-		0x47, 0x61, 0x6e, 0x64, 0x69, 0x20, 0x53, 0x74,
-		0x61, 0x6e, 0x64, 0x61, 0x72, 0x64, 0x20, 0x57,
-		0x69, 0x6c, 0x64, 0x63, 0x61, 0x72, 0x64, 0x20,
-		0x53, 0x53, 0x4c, 0x31, 0x17, 0x30, 0x15, 0x06,
-		0x03, 0x55, 0x04, 0x03, 0x14, 0x0e, 0x2a, 0x2e,
-		0x66, 0x72, 0x65, 0x65, 0x6e, 0x6f, 0x64, 0x65,
-		0x2e, 0x6e, 0x65, 0x74, 0x30, 0x82, 0x01, 0x22,
-		0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86,
-		0xf7, 0x0d, 0x01, 0x01, 0x01, 0x05, 0x00, 0x03,
-		0x82, 0x01, 0x0f, 0x00, 0x30, 0x82, 0x01, 0x0a,
-		0x02, 0x82, 0x01, 0x01, 0x00, 0xdc, 0xe3, 0xfd,
-		0xce, 0xc1, 0x66, 0x62, 0x28, 0x8b, 0x99, 0x65,
-		0x72, 0x52, 0x88, 0x93, 0x5b, 0x3f, 0x8d, 0xde,
-		0x2b, 0xb0, 0xa0, 0xf4, 0xbd, 0xb4, 0x07, 0x5f,
-		0x9e, 0x01, 0x47, 0x60, 0x57, 0x5f, 0xdf, 0xdc,
-		0x63, 0x28, 0x1c, 0x1e, 0x5b, 0xc8, 0xe6, 0x29,
-		0xdd, 0xeb, 0x26, 0x63, 0xd5, 0xbf, 0x83, 0xb2,
-		0x2d, 0xcd, 0x2c, 0xa0, 0xb6, 0x91, 0xad, 0xaf,
-		0x95, 0x21, 0x1d, 0x1f, 0x39, 0x8d, 0x3e, 0x17,
-		0xd6, 0xbd, 0x99, 0xf5, 0x6c, 0xd4, 0xcb, 0x79,
-		0x12, 0x3e, 0x11, 0xb9, 0x7e, 0x62, 0xbc, 0x2d,
-		0xbf, 0xe0, 0x55, 0x1b, 0x5c, 0x1e, 0xce, 0x31,
-		0xd9, 0xf8, 0x56, 0x68, 0x95, 0x2b, 0x15, 0x84,
-		0x35, 0xae, 0x98, 0x2c, 0x63, 0x01, 0xb2, 0x0d,
-		0xab, 0xa8, 0x61, 0xef, 0x7f, 0x15, 0x2c, 0x6d,
-		0xf7, 0x67, 0x1d, 0xb8, 0x8d, 0xf6, 0xa2, 0x1c,
-		0x4e, 0x85, 0xf0, 0xea, 0x1a, 0x2b, 0xc8, 0xac,
-		0x70, 0x86, 0x9a, 0xbb, 0x9e, 0x9d, 0xbd, 0xc9,
-		0x87, 0x2b, 0x9f, 0x5e, 0x40, 0x44, 0x9b, 0xba,
-		0x96, 0x45, 0x24, 0xbc, 0x49, 0xb8, 0xfe, 0x26,
-		0x3a, 0x1d, 0x1a, 0x0a, 0x3a, 0x90, 0x9c, 0x75,
-		0x51, 0x59, 0x89, 0x98, 0x1a, 0x56, 0xe1, 0x3a,
-		0x1a, 0xba, 0xff, 0xb4, 0x37, 0x7d, 0xd8, 0x99,
-		0xe2, 0xeb, 0x45, 0x27, 0xe2, 0x42, 0x42, 0x46,
-		0xbb, 0x00, 0x29, 0x9f, 0x30, 0xc9, 0x1e, 0x6c,
-		0xce, 0x59, 0x0e, 0xbe, 0x16, 0x03, 0x31, 0xec,
-		0x10, 0xc1, 0x6d, 0xca, 0x9d, 0x5f, 0x6d, 0xf1,
-		0x26, 0x11, 0xe5, 0x50, 0xa1, 0xbb, 0x67, 0xb2,
-		0xe0, 0x2b, 0xed, 0x76, 0x5b, 0xc7, 0x68, 0xc0,
-		0x18, 0xad, 0x91, 0x9e, 0xb5, 0xd4, 0x4d, 0x21,
-		0xcd, 0x98, 0xd9, 0xe0, 0x05, 0x0a, 0x4d, 0x24,
-		0xa3, 0xe6, 0x12, 0x04, 0xdd, 0x50, 0xe6, 0xc8,
-		0x7a, 0x69, 0xb9, 0x32, 0x43, 0x02, 0x03, 0x01,
-		0x00, 0x01, 0xa3, 0x82, 0x01, 0xb6, 0x30, 0x82,
-		0x01, 0xb2, 0x30, 0x1f, 0x06, 0x03, 0x55, 0x1d,
-		0x23, 0x04, 0x18, 0x30, 0x16, 0x80, 0x14, 0xb6,
-		0xa8, 0xff, 0xa2, 0xa8, 0x2f, 0xd0, 0xa6, 0xcd,
-		0x4b, 0xb1, 0x68, 0xf3, 0xe7, 0x50, 0x10, 0x31,
-		0xa7, 0x79, 0x21, 0x30, 0x1d, 0x06, 0x03, 0x55,
-		0x1d, 0x0e, 0x04, 0x16, 0x04, 0x14, 0x62, 0x37,
-		0xd4, 0x3c, 0xbf, 0xd9, 0xc2, 0x99, 0xf3, 0x28,
-		0x3e, 0xdb, 0xca, 0xee, 0xf3, 0xb3, 0xc8, 0x73,
-		0xb0, 0x3c, 0x30, 0x0e, 0x06, 0x03, 0x55, 0x1d,
-		0x0f, 0x01, 0x01, 0xff, 0x04, 0x04, 0x03, 0x02,
-		0x05, 0xa0, 0x30, 0x0c, 0x06, 0x03, 0x55, 0x1d,
-		0x13, 0x01, 0x01, 0xff, 0x04, 0x02, 0x30, 0x00,
-		0x30, 0x1d, 0x06, 0x03, 0x55, 0x1d, 0x25, 0x04,
-		0x16, 0x30, 0x14, 0x06, 0x08, 0x2b, 0x06, 0x01,
-		0x05, 0x05, 0x07, 0x03, 0x01, 0x06, 0x08, 0x2b,
-		0x06, 0x01, 0x05, 0x05, 0x07, 0x03, 0x02, 0x30,
-		0x60, 0x06, 0x03, 0x55, 0x1d, 0x20, 0x04, 0x59,
-		0x30, 0x57, 0x30, 0x4b, 0x06, 0x0b, 0x2b, 0x06,
-		0x01, 0x04, 0x01, 0xb2, 0x31, 0x01, 0x02, 0x02,
-		0x1a, 0x30, 0x3c, 0x30, 0x3a, 0x06, 0x08, 0x2b,
-		0x06, 0x01, 0x05, 0x05, 0x07, 0x02, 0x01, 0x16,
-		0x2e, 0x68, 0x74, 0x74, 0x70, 0x3a, 0x2f, 0x2f,
-		0x77, 0x77, 0x77, 0x2e, 0x67, 0x61, 0x6e, 0x64,
-		0x69, 0x2e, 0x6e, 0x65, 0x74, 0x2f, 0x63, 0x6f,
-		0x6e, 0x74, 0x72, 0x61, 0x63, 0x74, 0x73, 0x2f,
-		0x66, 0x72, 0x2f, 0x73, 0x73, 0x6c, 0x2f, 0x63,
-		0x70, 0x73, 0x2f, 0x70, 0x64, 0x66, 0x2f, 0x30,
-		0x08, 0x06, 0x06, 0x67, 0x81, 0x0c, 0x01, 0x02,
-		0x01, 0x30, 0x3c, 0x06, 0x03, 0x55, 0x1d, 0x1f,
-		0x04, 0x35, 0x30, 0x33, 0x30, 0x31, 0xa0, 0x2f,
-		0xa0, 0x2d, 0x86, 0x2b, 0x68, 0x74, 0x74, 0x70,
-		0x3a, 0x2f, 0x2f, 0x63, 0x72, 0x6c, 0x2e, 0x67,
-		0x61, 0x6e, 0x64, 0x69, 0x2e, 0x6e, 0x65, 0x74,
-		0x2f, 0x47, 0x61, 0x6e, 0x64, 0x69, 0x53, 0x74,
-		0x61, 0x6e, 0x64, 0x61, 0x72, 0x64, 0x53, 0x53,
-		0x4c, 0x43, 0x41, 0x2e, 0x63, 0x72, 0x6c, 0x30,
-		0x6a, 0x06, 0x08, 0x2b, 0x06, 0x01, 0x05, 0x05,
-		0x07, 0x01, 0x01, 0x04, 0x5e, 0x30, 0x5c, 0x30,
-		0x37, 0x06, 0x08, 0x2b, 0x06, 0x01, 0x05, 0x05,
-		0x07, 0x30, 0x02, 0x86, 0x2b, 0x68, 0x74, 0x74,
-		0x70, 0x3a, 0x2f, 0x2f, 0x63, 0x72, 0x74, 0x2e,
-		0x67, 0x61, 0x6e, 0x64, 0x69, 0x2e, 0x6e, 0x65,
-		0x74, 0x2f, 0x47, 0x61, 0x6e, 0x64, 0x69, 0x53,
-		0x74, 0x61, 0x6e, 0x64, 0x61, 0x72, 0x64, 0x53,
-		0x53, 0x4c, 0x43, 0x41, 0x2e, 0x63, 0x72, 0x74,
-		0x30, 0x21, 0x06, 0x08, 0x2b, 0x06, 0x01, 0x05,
-		0x05, 0x07, 0x30, 0x01, 0x86, 0x15, 0x68, 0x74,
-		0x74, 0x70, 0x3a, 0x2f, 0x2f, 0x6f, 0x63, 0x73,
-		0x70, 0x2e, 0x67, 0x61, 0x6e, 0x64, 0x69, 0x2e,
-		0x6e, 0x65, 0x74, 0x30, 0x27, 0x06, 0x03, 0x55,
-		0x1d, 0x11, 0x04, 0x20, 0x30, 0x1e, 0x82, 0x0e,
-		0x2a, 0x2e, 0x66, 0x72, 0x65, 0x65, 0x6e, 0x6f,
-		0x64, 0x65, 0x2e, 0x6e, 0x65, 0x74, 0x82, 0x0c,
-		0x66, 0x72, 0x65, 0x65, 0x6e, 0x6f, 0x64, 0x65,
-		0x2e, 0x6e, 0x65, 0x74, 0x30, 0x0d, 0x06, 0x09,
-		0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01,
-		0x05, 0x05, 0x00, 0x03, 0x82, 0x01, 0x01, 0x00,
-		0x5b, 0x4a, 0x3a, 0x1d, 0x75, 0xe0, 0xc0, 0x9e,
-		0xc9, 0x16, 0x66, 0x7f, 0x73, 0x95, 0x6e, 0x35,
-		0xe4, 0x27, 0xfa, 0x8c, 0x9d, 0xee, 0xb1, 0x37,
-		0x42, 0x3f, 0x54, 0x6a, 0x9d, 0x41, 0x84, 0x57,
-		0xe1, 0x03, 0x3d, 0x69, 0x61, 0x77, 0x3b, 0x91,
-		0xa2, 0x70, 0x94, 0xb6, 0x8e, 0x41, 0x63, 0x70,
-		0xf2, 0x16, 0x04, 0x50, 0x05, 0x14, 0xfb, 0x59,
-		0x7d, 0x89, 0x09, 0x3f, 0xb6, 0xef, 0xca, 0x3c,
-		0x89, 0x88, 0x08, 0xe9, 0xa1, 0xf3, 0x33, 0x31,
-		0x05, 0x4d, 0x70, 0xff, 0xdd, 0xa7, 0xd2, 0xe2,
-		0xa0, 0x94, 0x3a, 0xf7, 0xc2, 0x9f, 0xad, 0x2b,
-		0x2e, 0x20, 0xfa, 0x6c, 0xe1, 0xfc, 0xe6, 0x62,
-		0x22, 0xa1, 0x38, 0x93, 0xec, 0x3e, 0xce, 0xfd,
-		0x1f, 0xdd, 0xd4, 0x7c, 0x39, 0x46, 0x8b, 0xb4,
-		0x64, 0xfa, 0xa1, 0x46, 0x87, 0x78, 0x2c, 0xd7,
-		0x9c, 0xdd, 0x60, 0xd6, 0xda, 0x8e, 0xd8, 0x29,
-		0x6d, 0x61, 0xa7, 0x29, 0x07, 0x76, 0xfc, 0xf9,
-		0xbd, 0xfd, 0x14, 0xeb, 0x44, 0x70, 0xff, 0xd0,
-		0x23, 0x99, 0x83, 0xc5, 0x5c, 0x56, 0x88, 0xaa,
-		0x34, 0xda, 0xa6, 0xb3, 0x9a, 0xbf, 0xda, 0x58,
-		0x1e, 0xa4, 0xb8, 0xc0, 0x40, 0x9d, 0xf0, 0xfc,
-		0xf1, 0x23, 0xc2, 0xbc, 0x59, 0xe1, 0x82, 0xed,
-		0x5d, 0xfb, 0x99, 0xaf, 0xf5, 0xf5, 0x15, 0xb8,
-		0x8b, 0x59, 0xce, 0xaa, 0xca, 0xdf, 0xdc, 0x94,
-		0x11, 0xe0, 0x96, 0xbf, 0x9f, 0x54, 0xa4, 0x9f,
-		0x54, 0x36, 0x4a, 0xe8, 0x93, 0xda, 0xf4, 0x8c,
-		0xb0, 0x6b, 0x8d, 0x4a, 0x9e, 0x11, 0xae, 0xcb,
-		0xcb, 0x33, 0x8a, 0x4d, 0xcd, 0x4e, 0xa5, 0x9b,
-		0xe9, 0x14, 0x46, 0x43, 0x9b, 0x96, 0x5f, 0x6d,
-		0xf2, 0xea, 0x40, 0xef, 0x14, 0xc3, 0x99, 0x9f,
-		0x23, 0x1e, 0xa5, 0x13, 0xab, 0x08, 0xea, 0x8f,
-		0x68, 0x5b, 0x7d, 0x71, 0xdf, 0x18, 0xd1, 0x57,
-		0x00, 0x04, 0xa7, 0x30, 0x82, 0x04, 0xa3, 0x30,
-		0x82, 0x03, 0x8b, 0xa0, 0x03, 0x02, 0x01, 0x02,
-		0x02, 0x10, 0x5a, 0xb6, 0x1d, 0xac, 0x1e, 0x4d,
-		0xa2, 0x06, 0x14, 0xc7, 0x55, 0x3d, 0x3d, 0xa9,
-		0xb2, 0xdc, 0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86,
-		0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x05, 0x05,
-		0x00, 0x30, 0x81, 0x97, 0x31, 0x0b, 0x30, 0x09,
-		0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x55,
-		0x53, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55,
-		0x04, 0x08, 0x13, 0x02, 0x55, 0x54, 0x31, 0x17,
-		0x30, 0x15, 0x06, 0x03, 0x55, 0x04, 0x07, 0x13,
-		0x0e, 0x53, 0x61, 0x6c, 0x74, 0x20, 0x4c, 0x61,
-		0x6b, 0x65, 0x20, 0x43, 0x69, 0x74, 0x79, 0x31,
-		0x1e, 0x30, 0x1c, 0x06, 0x03, 0x55, 0x04, 0x0a,
-		0x13, 0x15, 0x54, 0x68, 0x65, 0x20, 0x55, 0x53,
-		0x45, 0x52, 0x54, 0x52, 0x55, 0x53, 0x54, 0x20,
-		0x4e, 0x65, 0x74, 0x77, 0x6f, 0x72, 0x6b, 0x31,
-		0x21, 0x30, 0x1f, 0x06, 0x03, 0x55, 0x04, 0x0b,
-		0x13, 0x18, 0x68, 0x74, 0x74, 0x70, 0x3a, 0x2f,
-		0x2f, 0x77, 0x77, 0x77, 0x2e, 0x75, 0x73, 0x65,
-		0x72, 0x74, 0x72, 0x75, 0x73, 0x74, 0x2e, 0x63,
-		0x6f, 0x6d, 0x31, 0x1f, 0x30, 0x1d, 0x06, 0x03,
-		0x55, 0x04, 0x03, 0x13, 0x16, 0x55, 0x54, 0x4e,
-		0x2d, 0x55, 0x53, 0x45, 0x52, 0x46, 0x69, 0x72,
-		0x73, 0x74, 0x2d, 0x48, 0x61, 0x72, 0x64, 0x77,
-		0x61, 0x72, 0x65, 0x30, 0x1e, 0x17, 0x0d, 0x30,
-		0x38, 0x31, 0x30, 0x32, 0x33, 0x30, 0x30, 0x30,
-		0x30, 0x30, 0x30, 0x5a, 0x17, 0x0d, 0x32, 0x30,
-		0x30, 0x35, 0x33, 0x30, 0x31, 0x30, 0x34, 0x38,
-		0x33, 0x38, 0x5a, 0x30, 0x41, 0x31, 0x0b, 0x30,
-		0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02,
-		0x46, 0x52, 0x31, 0x12, 0x30, 0x10, 0x06, 0x03,
-		0x55, 0x04, 0x0a, 0x13, 0x09, 0x47, 0x41, 0x4e,
-		0x44, 0x49, 0x20, 0x53, 0x41, 0x53, 0x31, 0x1e,
-		0x30, 0x1c, 0x06, 0x03, 0x55, 0x04, 0x03, 0x13,
-		0x15, 0x47, 0x61, 0x6e, 0x64, 0x69, 0x20, 0x53,
-		0x74, 0x61, 0x6e, 0x64, 0x61, 0x72, 0x64, 0x20,
-		0x53, 0x53, 0x4c, 0x20, 0x43, 0x41, 0x30, 0x82,
-		0x01, 0x22, 0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86,
-		0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x01, 0x05,
-		0x00, 0x03, 0x82, 0x01, 0x0f, 0x00, 0x30, 0x82,
-		0x01, 0x0a, 0x02, 0x82, 0x01, 0x01, 0x00, 0xb6,
-		0x54, 0x3d, 0xa5, 0xdb, 0x0d, 0x22, 0x78, 0x50,
-		0x6a, 0x5a, 0x23, 0x89, 0x3f, 0x97, 0xa1, 0xd4,
-		0x07, 0x1a, 0xa9, 0x58, 0x08, 0x9b, 0xa0, 0x15,
-		0xc3, 0x32, 0xb6, 0xb7, 0xf1, 0xe8, 0xb9, 0xa5,
-		0x6f, 0xad, 0x37, 0xf6, 0x6e, 0x71, 0x1b, 0xb4,
-		0x75, 0x2d, 0x48, 0x5e, 0x9f, 0xc6, 0x15, 0xaa,
-		0x81, 0xef, 0xe5, 0xc4, 0x88, 0x95, 0x8a, 0x3a,
-		0x6c, 0x77, 0xcc, 0xb5, 0xcd, 0x65, 0xe4, 0x67,
-		0xe5, 0x73, 0xc9, 0x50, 0x52, 0x94, 0xc1, 0x27,
-		0x49, 0x3e, 0xa0, 0x6b, 0x41, 0x16, 0x41, 0xb6,
-		0x94, 0x99, 0x41, 0xae, 0x3e, 0xcb, 0xe2, 0x06,
-		0x46, 0x09, 0xe9, 0x4d, 0xbe, 0xc9, 0x4c, 0x55,
-		0xa9, 0x18, 0x7e, 0xa6, 0xdf, 0x6e, 0xfd, 0x4a,
-		0xb2, 0xcc, 0x6c, 0x4e, 0xd9, 0xc8, 0x50, 0x15,
-		0x93, 0xb3, 0xf2, 0xe9, 0xe3, 0xc2, 0x6a, 0xad,
-		0x3a, 0xd5, 0xfb, 0xc3, 0x79, 0x50, 0x9f, 0x25,
-		0x79, 0x29, 0xb2, 0x47, 0x64, 0x7c, 0x20, 0x3e,
-		0xe2, 0x08, 0x4d, 0x93, 0x29, 0x14, 0xb6, 0x34,
-		0x6e, 0xcf, 0x71, 0x46, 0x7e, 0x76, 0x10, 0xf4,
-		0xfd, 0x6c, 0xaa, 0x01, 0xd2, 0xc2, 0x06, 0xde,
-		0x92, 0x83, 0xcc, 0x58, 0x90, 0x2e, 0x92, 0xde,
-		0x1e, 0x65, 0xb7, 0x63, 0x2f, 0x3d, 0xb2, 0xeb,
-		0x70, 0x8c, 0x4c, 0xe0, 0xbe, 0x15, 0x9d, 0xde,
-		0xc1, 0x4d, 0x56, 0xf8, 0x0b, 0xc6, 0x8e, 0x07,
-		0xb9, 0x5d, 0xdf, 0x95, 0xf0, 0x7b, 0x40, 0x1f,
-		0x1a, 0x2c, 0xd7, 0x9c, 0x2b, 0x4b, 0x76, 0xf4,
-		0x59, 0xf5, 0x43, 0xc1, 0x2c, 0x66, 0x10, 0x9e,
-		0x9e, 0x66, 0x96, 0x60, 0x9d, 0x1c, 0x74, 0x1b,
-		0x4e, 0x18, 0x5c, 0x08, 0xb0, 0x6e, 0x6c, 0xca,
-		0x69, 0x1a, 0x02, 0xe9, 0xbb, 0xca, 0x78, 0xef,
-		0x66, 0x2e, 0xe3, 0x32, 0xfd, 0x41, 0x5c, 0x95,
-		0x74, 0x81, 0x4d, 0xf4, 0xda, 0xfe, 0x4b, 0x02,
-		0x03, 0x01, 0x00, 0x01, 0xa3, 0x82, 0x01, 0x3e,
-		0x30, 0x82, 0x01, 0x3a, 0x30, 0x1f, 0x06, 0x03,
-		0x55, 0x1d, 0x23, 0x04, 0x18, 0x30, 0x16, 0x80,
-		0x14, 0xa1, 0x72, 0x5f, 0x26, 0x1b, 0x28, 0x98,
-		0x43, 0x95, 0x5d, 0x07, 0x37, 0xd5, 0x85, 0x96,
-		0x9d, 0x4b, 0xd2, 0xc3, 0x45, 0x30, 0x1d, 0x06,
-		0x03, 0x55, 0x1d, 0x0e, 0x04, 0x16, 0x04, 0x14,
-		0xb6, 0xa8, 0xff, 0xa2, 0xa8, 0x2f, 0xd0, 0xa6,
-		0xcd, 0x4b, 0xb1, 0x68, 0xf3, 0xe7, 0x50, 0x10,
-		0x31, 0xa7, 0x79, 0x21, 0x30, 0x0e, 0x06, 0x03,
-		0x55, 0x1d, 0x0f, 0x01, 0x01, 0xff, 0x04, 0x04,
-		0x03, 0x02, 0x01, 0x06, 0x30, 0x12, 0x06, 0x03,
-		0x55, 0x1d, 0x13, 0x01, 0x01, 0xff, 0x04, 0x08,
-		0x30, 0x06, 0x01, 0x01, 0xff, 0x02, 0x01, 0x00,
-		0x30, 0x18, 0x06, 0x03, 0x55, 0x1d, 0x20, 0x04,
-		0x11, 0x30, 0x0f, 0x30, 0x0d, 0x06, 0x0b, 0x2b,
-		0x06, 0x01, 0x04, 0x01, 0xb2, 0x31, 0x01, 0x02,
-		0x02, 0x1a, 0x30, 0x44, 0x06, 0x03, 0x55, 0x1d,
-		0x1f, 0x04, 0x3d, 0x30, 0x3b, 0x30, 0x39, 0xa0,
-		0x37, 0xa0, 0x35, 0x86, 0x33, 0x68, 0x74, 0x74,
-		0x70, 0x3a, 0x2f, 0x2f, 0x63, 0x72, 0x6c, 0x2e,
-		0x75, 0x73, 0x65, 0x72, 0x74, 0x72, 0x75, 0x73,
-		0x74, 0x2e, 0x63, 0x6f, 0x6d, 0x2f, 0x55, 0x54,
-		0x4e, 0x2d, 0x55, 0x53, 0x45, 0x52, 0x46, 0x69,
-		0x72, 0x73, 0x74, 0x2d, 0x48, 0x61, 0x72, 0x64,
-		0x77, 0x61, 0x72, 0x65, 0x2e, 0x63, 0x72, 0x6c,
-		0x30, 0x74, 0x06, 0x08, 0x2b, 0x06, 0x01, 0x05,
-		0x05, 0x07, 0x01, 0x01, 0x04, 0x68, 0x30, 0x66,
-		0x30, 0x3d, 0x06, 0x08, 0x2b, 0x06, 0x01, 0x05,
-		0x05, 0x07, 0x30, 0x02, 0x86, 0x31, 0x68, 0x74,
-		0x74, 0x70, 0x3a, 0x2f, 0x2f, 0x63, 0x72, 0x74,
-		0x2e, 0x75, 0x73, 0x65, 0x72, 0x74, 0x72, 0x75,
-		0x73, 0x74, 0x2e, 0x63, 0x6f, 0x6d, 0x2f, 0x55,
-		0x54, 0x4e, 0x41, 0x64, 0x64, 0x54, 0x72, 0x75,
-		0x73, 0x74, 0x53, 0x65, 0x72, 0x76, 0x65, 0x72,
-		0x5f, 0x43, 0x41, 0x2e, 0x63, 0x72, 0x74, 0x30,
-		0x25, 0x06, 0x08, 0x2b, 0x06, 0x01, 0x05, 0x05,
-		0x07, 0x30, 0x01, 0x86, 0x19, 0x68, 0x74, 0x74,
-		0x70, 0x3a, 0x2f, 0x2f, 0x6f, 0x63, 0x73, 0x70,
-		0x2e, 0x75, 0x73, 0x65, 0x72, 0x74, 0x72, 0x75,
-		0x73, 0x74, 0x2e, 0x63, 0x6f, 0x6d, 0x30, 0x0d,
-		0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d,
-		0x01, 0x01, 0x05, 0x05, 0x00, 0x03, 0x82, 0x01,
-		0x01, 0x00, 0x19, 0x53, 0xbf, 0x03, 0x3d, 0x9b,
-		0xe2, 0x6b, 0x5a, 0xfd, 0xba, 0x49, 0x1f, 0x4f,
-		0xec, 0xe1, 0xc6, 0x82, 0x39, 0x3c, 0xd2, 0x03,
-		0x04, 0x0f, 0xab, 0x7b, 0x3e, 0x82, 0xa9, 0x85,
-		0x10, 0x1f, 0xf4, 0xde, 0x32, 0xaf, 0x58, 0x3f,
-		0xff, 0x70, 0xf3, 0x30, 0x1d, 0x97, 0x2d, 0x4c,
-		0x9a, 0xe2, 0xec, 0x0c, 0x3e, 0x14, 0x2d, 0x2f,
-		0x98, 0x48, 0x9d, 0xae, 0x16, 0x6a, 0xac, 0x2d,
-		0x42, 0xaa, 0xb5, 0x64, 0xa4, 0x70, 0xbb, 0xeb,
-		0x73, 0x94, 0x7b, 0x46, 0x4c, 0xe7, 0x7a, 0x14,
-		0x76, 0x5b, 0x4c, 0x1d, 0x84, 0xa1, 0x20, 0x74,
-		0x1f, 0x2e, 0x4b, 0x5c, 0x70, 0x88, 0xdc, 0xbd,
-		0xf7, 0x19, 0x3d, 0xed, 0x59, 0x0d, 0xe2, 0x3f,
-		0x26, 0xe2, 0x9c, 0xac, 0xa4, 0x3c, 0x95, 0x1c,
-		0xf8, 0xbe, 0x8c, 0x03, 0xae, 0xf0, 0xe5, 0x9c,
-		0x4d, 0xbc, 0xc7, 0x9b, 0x58, 0x00, 0xbf, 0xaf,
-		0xad, 0xfa, 0x37, 0x6e, 0x71, 0x6d, 0x18, 0x34,
-		0x0e, 0xc1, 0xea, 0x6a, 0xf8, 0x0d, 0xdf, 0x69,
-		0x54, 0x56, 0x15, 0xf2, 0x28, 0xb3, 0xfe, 0xa4,
-		0x63, 0xec, 0xc5, 0x04, 0x64, 0x60, 0xbb, 0xfe,
-		0x2a, 0xf0, 0xf4, 0x87, 0xa1, 0xb0, 0xae, 0xbd,
-		0xaa, 0xe4, 0x2f, 0xe3, 0x03, 0x0b, 0x2f, 0x66,
-		0x5f, 0x85, 0xa4, 0x32, 0x7b, 0x46, 0xed, 0x25,
-		0x0c, 0xe7, 0xf1, 0xb7, 0xe7, 0x19, 0xfd, 0x60,
-		0xba, 0x5f, 0x87, 0x77, 0xde, 0x98, 0x07, 0x96,
-		0xe4, 0x5e, 0xea, 0x63, 0x7d, 0xa8, 0xde, 0x55,
-		0xda, 0x61, 0x5c, 0x3c, 0x90, 0x83, 0x43, 0x04,
-		0x07, 0x3c, 0xdd, 0xf3, 0xf8, 0x9f, 0x06, 0x52,
-		0x0a, 0xde, 0xc7, 0xb6, 0x7b, 0x8f, 0xe1, 0x11,
-		0xf7, 0x04, 0x7a, 0x35, 0xff, 0x6a, 0xbc, 0x5b,
-		0xc7, 0x50, 0x49, 0x08, 0x70, 0x6f, 0x94, 0x43,
-		0xcd, 0x9e, 0xc7, 0x70, 0xf1, 0xdb, 0xd0, 0x6d,
-		0xda, 0x8f, 0x16, 0x03, 0x01, 0x00, 0x0e, 0x0d,
-		0x00, 0x00, 0x06, 0x03, 0x01, 0x02, 0x40, 0x00,
-		0x00, 0x0e, 0x00, 0x00, 0x00,
-	},
-	{
-		0x16, 0x03, 0x01, 0x02, 0xbe, 0x0b, 0x00, 0x02,
-		0xba, 0x00, 0x02, 0xb7, 0x00, 0x02, 0xb4, 0x30,
-		0x82, 0x02, 0xb0, 0x30, 0x82, 0x02, 0x19, 0xa0,
-		0x03, 0x02, 0x01, 0x02, 0x02, 0x09, 0x00, 0x85,
-		0xb0, 0xbb, 0xa4, 0x8a, 0x7f, 0xb8, 0xca, 0x30,
-		0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7,
-		0x0d, 0x01, 0x01, 0x05, 0x05, 0x00, 0x30, 0x45,
-		0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04,
-		0x06, 0x13, 0x02, 0x41, 0x55, 0x31, 0x13, 0x30,
-		0x11, 0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0a,
-		0x53, 0x6f, 0x6d, 0x65, 0x2d, 0x53, 0x74, 0x61,
-		0x74, 0x65, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x03,
-		0x55, 0x04, 0x0a, 0x13, 0x18, 0x49, 0x6e, 0x74,
-		0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x57, 0x69,
-		0x64, 0x67, 0x69, 0x74, 0x73, 0x20, 0x50, 0x74,
-		0x79, 0x20, 0x4c, 0x74, 0x64, 0x30, 0x1e, 0x17,
-		0x0d, 0x31, 0x30, 0x30, 0x34, 0x32, 0x34, 0x30,
-		0x39, 0x30, 0x39, 0x33, 0x38, 0x5a, 0x17, 0x0d,
-		0x31, 0x31, 0x30, 0x34, 0x32, 0x34, 0x30, 0x39,
-		0x30, 0x39, 0x33, 0x38, 0x5a, 0x30, 0x45, 0x31,
-		0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06,
-		0x13, 0x02, 0x41, 0x55, 0x31, 0x13, 0x30, 0x11,
-		0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0a, 0x53,
-		0x6f, 0x6d, 0x65, 0x2d, 0x53, 0x74, 0x61, 0x74,
-		0x65, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x03, 0x55,
-		0x04, 0x0a, 0x13, 0x18, 0x49, 0x6e, 0x74, 0x65,
-		0x72, 0x6e, 0x65, 0x74, 0x20, 0x57, 0x69, 0x64,
-		0x67, 0x69, 0x74, 0x73, 0x20, 0x50, 0x74, 0x79,
-		0x20, 0x4c, 0x74, 0x64, 0x30, 0x81, 0x9f, 0x30,
-		0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7,
-		0x0d, 0x01, 0x01, 0x01, 0x05, 0x00, 0x03, 0x81,
-		0x8d, 0x00, 0x30, 0x81, 0x89, 0x02, 0x81, 0x81,
-		0x00, 0xbb, 0x79, 0xd6, 0xf5, 0x17, 0xb5, 0xe5,
-		0xbf, 0x46, 0x10, 0xd0, 0xdc, 0x69, 0xbe, 0xe6,
-		0x2b, 0x07, 0x43, 0x5a, 0xd0, 0x03, 0x2d, 0x8a,
-		0x7a, 0x43, 0x85, 0xb7, 0x14, 0x52, 0xe7, 0xa5,
-		0x65, 0x4c, 0x2c, 0x78, 0xb8, 0x23, 0x8c, 0xb5,
-		0xb4, 0x82, 0xe5, 0xde, 0x1f, 0x95, 0x3b, 0x7e,
-		0x62, 0xa5, 0x2c, 0xa5, 0x33, 0xd6, 0xfe, 0x12,
-		0x5c, 0x7a, 0x56, 0xfc, 0xf5, 0x06, 0xbf, 0xfa,
-		0x58, 0x7b, 0x26, 0x3f, 0xb5, 0xcd, 0x04, 0xd3,
-		0xd0, 0xc9, 0x21, 0x96, 0x4a, 0xc7, 0xf4, 0x54,
-		0x9f, 0x5a, 0xbf, 0xef, 0x42, 0x71, 0x00, 0xfe,
-		0x18, 0x99, 0x07, 0x7f, 0x7e, 0x88, 0x7d, 0x7d,
-		0xf1, 0x04, 0x39, 0xc4, 0xa2, 0x2e, 0xdb, 0x51,
-		0xc9, 0x7c, 0xe3, 0xc0, 0x4c, 0x3b, 0x32, 0x66,
-		0x01, 0xcf, 0xaf, 0xb1, 0x1d, 0xb8, 0x71, 0x9a,
-		0x1d, 0xdb, 0xdb, 0x89, 0x6b, 0xae, 0xda, 0x2d,
-		0x79, 0x02, 0x03, 0x01, 0x00, 0x01, 0xa3, 0x81,
-		0xa7, 0x30, 0x81, 0xa4, 0x30, 0x1d, 0x06, 0x03,
-		0x55, 0x1d, 0x0e, 0x04, 0x16, 0x04, 0x14, 0xb1,
-		0xad, 0xe2, 0x85, 0x5a, 0xcf, 0xcb, 0x28, 0xdb,
-		0x69, 0xce, 0x23, 0x69, 0xde, 0xd3, 0x26, 0x8e,
-		0x18, 0x88, 0x39, 0x30, 0x75, 0x06, 0x03, 0x55,
-		0x1d, 0x23, 0x04, 0x6e, 0x30, 0x6c, 0x80, 0x14,
-		0xb1, 0xad, 0xe2, 0x85, 0x5a, 0xcf, 0xcb, 0x28,
-		0xdb, 0x69, 0xce, 0x23, 0x69, 0xde, 0xd3, 0x26,
-		0x8e, 0x18, 0x88, 0x39, 0xa1, 0x49, 0xa4, 0x47,
-		0x30, 0x45, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03,
-		0x55, 0x04, 0x06, 0x13, 0x02, 0x41, 0x55, 0x31,
-		0x13, 0x30, 0x11, 0x06, 0x03, 0x55, 0x04, 0x08,
-		0x13, 0x0a, 0x53, 0x6f, 0x6d, 0x65, 0x2d, 0x53,
-		0x74, 0x61, 0x74, 0x65, 0x31, 0x21, 0x30, 0x1f,
-		0x06, 0x03, 0x55, 0x04, 0x0a, 0x13, 0x18, 0x49,
-		0x6e, 0x74, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20,
-		0x57, 0x69, 0x64, 0x67, 0x69, 0x74, 0x73, 0x20,
-		0x50, 0x74, 0x79, 0x20, 0x4c, 0x74, 0x64, 0x82,
-		0x09, 0x00, 0x85, 0xb0, 0xbb, 0xa4, 0x8a, 0x7f,
-		0xb8, 0xca, 0x30, 0x0c, 0x06, 0x03, 0x55, 0x1d,
-		0x13, 0x04, 0x05, 0x30, 0x03, 0x01, 0x01, 0xff,
-		0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86,
-		0xf7, 0x0d, 0x01, 0x01, 0x05, 0x05, 0x00, 0x03,
-		0x81, 0x81, 0x00, 0x08, 0x6c, 0x45, 0x24, 0xc7,
-		0x6b, 0xb1, 0x59, 0xab, 0x0c, 0x52, 0xcc, 0xf2,
-		0xb0, 0x14, 0xd7, 0x87, 0x9d, 0x7a, 0x64, 0x75,
-		0xb5, 0x5a, 0x95, 0x66, 0xe4, 0xc5, 0x2b, 0x8e,
-		0xae, 0x12, 0x66, 0x1f, 0xeb, 0x4f, 0x38, 0xb3,
-		0x6e, 0x60, 0xd3, 0x92, 0xfd, 0xf7, 0x41, 0x08,
-		0xb5, 0x25, 0x13, 0xb1, 0x18, 0x7a, 0x24, 0xfb,
-		0x30, 0x1d, 0xba, 0xed, 0x98, 0xb9, 0x17, 0xec,
-		0xe7, 0xd7, 0x31, 0x59, 0xdb, 0x95, 0xd3, 0x1d,
-		0x78, 0xea, 0x50, 0x56, 0x5c, 0xd5, 0x82, 0x5a,
-		0x2d, 0x5a, 0x5f, 0x33, 0xc4, 0xb6, 0xd8, 0xc9,
-		0x75, 0x90, 0x96, 0x8c, 0x0f, 0x52, 0x98, 0xb5,
-		0xcd, 0x98, 0x1f, 0x89, 0x20, 0x5f, 0xf2, 0xa0,
-		0x1c, 0xa3, 0x1b, 0x96, 0x94, 0xdd, 0xa9, 0xfd,
-		0x57, 0xe9, 0x70, 0xe8, 0x26, 0x6d, 0x71, 0x99,
-		0x9b, 0x26, 0x6e, 0x38, 0x50, 0x29, 0x6c, 0x90,
-		0xa7, 0xbd, 0xd9, 0x16, 0x03, 0x01, 0x01, 0x06,
-		0x10, 0x00, 0x01, 0x02, 0x01, 0x00, 0x25, 0x48,
-		0x6c, 0x0a, 0xde, 0x9d, 0x3a, 0x57, 0xe4, 0x2e,
-		0xb9, 0xfc, 0xb4, 0x46, 0x1f, 0x20, 0x4f, 0x58,
-		0x4d, 0x12, 0x08, 0xb4, 0x3e, 0x4c, 0xf5, 0xa8,
-		0xa5, 0x16, 0x40, 0x29, 0x19, 0x04, 0x4d, 0xf9,
-		0x54, 0x3a, 0x32, 0xd7, 0x79, 0xf2, 0x0e, 0xc1,
-		0x7b, 0x0c, 0x62, 0x71, 0xbb, 0xb4, 0x8c, 0xe7,
-		0x84, 0xd5, 0xf8, 0x11, 0x77, 0x7f, 0x87, 0x6c,
-		0xfc, 0x25, 0xf3, 0x2d, 0x97, 0x3d, 0x1f, 0xf5,
-		0xfc, 0x64, 0x94, 0x9f, 0xdd, 0x90, 0x82, 0xdd,
-		0x11, 0x74, 0x74, 0x59, 0xa2, 0x1a, 0x71, 0xb2,
-		0x55, 0x6d, 0x18, 0xca, 0x85, 0x47, 0x8b, 0x79,
-		0x73, 0x06, 0x24, 0x38, 0xc3, 0x34, 0x98, 0x84,
-		0x62, 0x81, 0xd8, 0xad, 0x54, 0xad, 0x13, 0xa5,
-		0xf4, 0xe4, 0x82, 0x85, 0xd3, 0xe3, 0x9e, 0xeb,
-		0xb5, 0xf5, 0x95, 0x83, 0x0e, 0xb9, 0x7d, 0xb6,
-		0xda, 0x0c, 0xf6, 0x14, 0x6a, 0x60, 0x8c, 0x75,
-		0x56, 0xf0, 0xe9, 0x60, 0xe0, 0x4c, 0xf4, 0x4e,
-		0x84, 0x8b, 0x4f, 0xf4, 0x2f, 0xde, 0xb7, 0xec,
-		0x61, 0xd3, 0x77, 0x07, 0x6e, 0x41, 0x57, 0xc9,
-		0xd9, 0x1d, 0x75, 0xee, 0x42, 0x63, 0xdc, 0x58,
-		0xad, 0xfc, 0xc7, 0xe1, 0x77, 0x49, 0xb1, 0x58,
-		0x21, 0x96, 0x00, 0x55, 0x90, 0x6b, 0xf6, 0x2a,
-		0x5a, 0x19, 0x25, 0x93, 0x59, 0x9d, 0xaf, 0x79,
-		0x9b, 0x18, 0x5d, 0xf6, 0x5d, 0x64, 0x4b, 0x9a,
-		0xf4, 0xde, 0xf2, 0x7f, 0xbd, 0x93, 0x7e, 0x45,
-		0x3e, 0x17, 0xae, 0xbf, 0x52, 0xe1, 0xba, 0x8e,
-		0x0b, 0xbc, 0x1e, 0x91, 0x9d, 0xf1, 0x4e, 0x0b,
-		0xab, 0x9e, 0x5c, 0x4c, 0x6f, 0xf7, 0xf3, 0x8d,
-		0x8c, 0x6d, 0xeb, 0x46, 0x05, 0x36, 0x7e, 0x2f,
-		0x9c, 0xa1, 0x86, 0x15, 0xe1, 0xe4, 0xb4, 0x20,
-		0x06, 0x44, 0x7b, 0x3c, 0x8b, 0x13, 0x96, 0xf5,
-		0x02, 0xb1, 0x4f, 0x3c, 0x2d, 0x4a, 0x16, 0x03,
-		0x01, 0x00, 0x86, 0x0f, 0x00, 0x00, 0x82, 0x00,
-		0x80, 0x52, 0xb1, 0x0d, 0xfc, 0x85, 0x34, 0x56,
-		0xb9, 0xdf, 0xa7, 0x8e, 0xf4, 0xfd, 0x02, 0x46,
-		0x8a, 0x23, 0xcc, 0x53, 0x3b, 0x0f, 0xa7, 0x61,
-		0xf3, 0xb5, 0xbf, 0xfe, 0x59, 0x77, 0x10, 0xd6,
-		0x56, 0x93, 0x19, 0x6b, 0x2c, 0xf1, 0x35, 0x71,
-		0xe3, 0x36, 0x2f, 0xa0, 0x90, 0x4e, 0x5a, 0xdf,
-		0x8d, 0x06, 0x88, 0xcf, 0xb1, 0x06, 0x56, 0x8b,
-		0x74, 0x8f, 0x02, 0x8e, 0x10, 0xd2, 0xab, 0x8d,
-		0x3f, 0x3e, 0x02, 0xf1, 0x1a, 0x80, 0x6d, 0x0f,
-		0x9e, 0x77, 0xd8, 0xfa, 0x92, 0xb3, 0x16, 0x40,
-		0xeb, 0x9e, 0xca, 0xd7, 0xe4, 0x31, 0xcc, 0x63,
-		0x5f, 0xe2, 0x4c, 0x85, 0x0e, 0xf2, 0xdd, 0xd3,
-		0xfe, 0x7e, 0xa7, 0x60, 0x1c, 0xb4, 0x00, 0xd8,
-		0xbe, 0x4b, 0x9b, 0x66, 0x78, 0x0f, 0xfb, 0x3b,
-		0x52, 0x30, 0x2b, 0x8b, 0xd9, 0xef, 0x82, 0x0a,
-		0xa4, 0x18, 0x1d, 0xb0, 0xb5, 0xbf, 0x54, 0x97,
-		0x0c, 0x14, 0x03, 0x01, 0x00, 0x01, 0x01, 0x16,
-		0x03, 0x01, 0x00, 0x30, 0xa1, 0x74, 0x22, 0xd8,
-		0x86, 0x6a, 0xbe, 0x53, 0x34, 0x1d, 0xb3, 0x73,
-		0xff, 0x51, 0xc0, 0xce, 0x8e, 0x7d, 0x9b, 0xab,
-		0xcb, 0x8b, 0x79, 0xae, 0x04, 0x01, 0xa7, 0xf2,
-		0x8e, 0x9d, 0xab, 0xa3, 0x73, 0x80, 0x5c, 0xff,
-		0x96, 0x20, 0xbb, 0x8d, 0xc0, 0x02, 0x66, 0x6c,
-		0x83, 0x4b, 0x78, 0x20,
-	},
-	{
-		0x14, 0x03, 0x01, 0x00, 0x01, 0x01, 0x16, 0x03,
-		0x01, 0x00, 0x30, 0x29, 0xd4, 0xfd, 0x03, 0x8b,
-		0x30, 0x20, 0xf7, 0xca, 0xc0, 0x6c, 0x83, 0x5d,
-		0x73, 0xcb, 0x81, 0x60, 0xe0, 0x9a, 0x09, 0xcb,
-		0x33, 0x03, 0x80, 0x81, 0x4e, 0x84, 0x47, 0xd5,
-		0x74, 0x6c, 0x3b, 0xb5, 0xc0, 0x48, 0x0d, 0x52,
-		0xdd, 0xbe, 0xc2, 0x06, 0xf5, 0x79, 0x2b, 0x3e,
-		0x99, 0x56, 0x94, 0x17, 0x03, 0x01, 0x00, 0x20,
-		0x26, 0x46, 0x90, 0x9d, 0xef, 0x59, 0x00, 0xb6,
-		0x70, 0xe8, 0x1e, 0x1a, 0x80, 0x8b, 0x04, 0xb2,
-		0xfc, 0x51, 0xf8, 0x93, 0xbe, 0x00, 0x28, 0xba,
-		0xb8, 0xdc, 0x51, 0x7e, 0x92, 0x80, 0xfa, 0xf2,
-		0x17, 0x03, 0x01, 0x00, 0xe0, 0xb8, 0x2e, 0xc4,
-		0x6b, 0x3f, 0xda, 0x39, 0x87, 0x7f, 0x03, 0x43,
-		0x28, 0xdd, 0xb9, 0xf9, 0x9e, 0x16, 0xf5, 0xce,
-		0x3f, 0x7e, 0x6a, 0x7b, 0xb3, 0x60, 0x14, 0xe1,
-		0xea, 0x54, 0xc5, 0xe6, 0x05, 0x0a, 0x6c, 0xe0,
-		0xef, 0x58, 0x29, 0x8a, 0x77, 0x64, 0x77, 0x5d,
-		0x9c, 0xe2, 0xe0, 0x3c, 0x6d, 0x87, 0x82, 0xbe,
-		0x47, 0x63, 0xd4, 0xfd, 0x0c, 0x25, 0xc4, 0xb1,
-		0xfe, 0x29, 0x6f, 0x84, 0xfb, 0xab, 0x6e, 0xa7,
-		0xf9, 0x22, 0x89, 0x97, 0x5b, 0x91, 0x0a, 0x07,
-		0xe0, 0xef, 0x3d, 0x67, 0xee, 0x87, 0xa8, 0x33,
-		0x02, 0x64, 0x33, 0xca, 0x15, 0x10, 0xb9, 0x57,
-		0xd8, 0xe5, 0x1a, 0x4b, 0xe3, 0x45, 0xc1, 0x62,
-		0x85, 0x50, 0xf1, 0x79, 0x54, 0xe1, 0x2e, 0x25,
-		0x01, 0x3c, 0xdb, 0x2d, 0x39, 0x14, 0x2f, 0x9b,
-		0xd0, 0x1d, 0xc1, 0xac, 0x73, 0x7d, 0xa4, 0xed,
-		0x89, 0x98, 0xb1, 0xae, 0x8a, 0x9e, 0xc8, 0xa7,
-		0xfe, 0x55, 0x27, 0xb5, 0xb5, 0xa2, 0xec, 0x7e,
-		0xe3, 0x6b, 0x45, 0x19, 0xfa, 0x20, 0x1c, 0x33,
-		0x83, 0x22, 0x33, 0x97, 0xd2, 0x5a, 0xc4, 0xf8,
-		0x9a, 0x03, 0x13, 0x85, 0xf2, 0x2b, 0x04, 0x59,
-		0x27, 0xd7, 0x0b, 0x42, 0x47, 0x9b, 0x7d, 0x4d,
-		0xb2, 0x1a, 0x85, 0x7f, 0x97, 0xc2, 0xf2, 0x10,
-		0xf0, 0xfa, 0x4e, 0x4b, 0x62, 0x43, 0x3a, 0x09,
-		0x2e, 0xcd, 0x8f, 0xa8, 0xb6, 0x0b, 0x5f, 0x34,
-		0xd7, 0x3b, 0xba, 0xd9, 0xe5, 0x01, 0x2d, 0x35,
-		0xae, 0xc5, 0x4c, 0xab, 0x40, 0x64, 0xc2, 0xc9,
-		0x8c, 0x69, 0x44, 0xf4, 0xb8, 0xb5, 0x3a, 0x05,
-		0x3c, 0x29, 0x19, 0xb4, 0x09, 0x17, 0x03, 0x01,
-		0x00, 0x20, 0xc8, 0xc5, 0xb7, 0xe3, 0xd2, 0x3e,
-		0x27, 0xb5, 0x71, 0x8f, 0x52, 0x0b, 0xce, 0x17,
-		0x64, 0x86, 0xa4, 0x34, 0x16, 0x1b, 0x61, 0x64,
-		0x7c, 0xb3, 0xf2, 0xe5, 0x3e, 0xfd, 0xdd, 0xfb,
-		0x40, 0x78, 0x17, 0x03, 0x01, 0x00, 0x50, 0x8e,
-		0x79, 0xf0, 0x8e, 0x76, 0x5d, 0x34, 0x09, 0xdc,
-		0xec, 0x6d, 0xc3, 0x43, 0x1d, 0xcb, 0x2d, 0xaa,
-		0x08, 0x7a, 0x51, 0x94, 0x4e, 0xc5, 0x26, 0xe4,
-		0x0b, 0x8e, 0x8f, 0x51, 0xf2, 0x9f, 0xeb, 0xc3,
-		0x18, 0x43, 0x95, 0x15, 0xfc, 0x59, 0x18, 0x25,
-		0x47, 0xb6, 0x4a, 0x6e, 0xa3, 0xa4, 0x3b, 0xa3,
-		0x47, 0x34, 0x74, 0x6b, 0xc5, 0x3d, 0x41, 0x14,
-		0x64, 0xd5, 0x69, 0x5f, 0x77, 0xf3, 0x7c, 0x41,
-		0xc6, 0xed, 0x2e, 0xcf, 0xff, 0x40, 0xf2, 0xce,
-		0xbb, 0xa7, 0x4e, 0x73, 0x88, 0x98, 0x10,
-	},
-	{
-		0x15, 0x03, 0x01, 0x00, 0x20, 0x1a, 0xbc, 0x70,
-		0x24, 0xf8, 0xfb, 0xf2, 0x4a, 0xf9, 0x44, 0x1e,
-		0x58, 0xf8, 0xaa, 0x41, 0x24, 0xe8, 0x80, 0x33,
-		0x45, 0x18, 0xa1, 0x5d, 0xee, 0x16, 0x80, 0xae,
-		0x40, 0x41, 0x8e, 0x41, 0x9b,
-	},
+func TestHandshakeClientRSARC4(t *testing.T) {
+	test := &clientTest{
+		name:    "RSA-RC4",
+		command: []string{"openssl", "s_server", "-cipher", "RC4-SHA"},
+	}
+	runClientTestTLS10(t, test)
+	runClientTestTLS11(t, test)
+	runClientTestTLS12(t, test)
 }
 
-var tls11ECDHEAESClientScript = [][]byte{
-	{
-		0x16, 0x03, 0x01, 0x00, 0x4a, 0x01, 0x00, 0x00,
-		0x46, 0x03, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0xc0, 0x13,
-		0x01, 0x00, 0x00, 0x1b, 0x00, 0x05, 0x00, 0x05,
-		0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0a, 0x00,
-		0x08, 0x00, 0x06, 0x00, 0x17, 0x00, 0x18, 0x00,
-		0x19, 0x00, 0x0b, 0x00, 0x02, 0x01, 0x00,
-	},
-	{
-		0x16, 0x03, 0x02, 0x00, 0x54, 0x02, 0x00, 0x00,
-		0x50, 0x03, 0x02, 0x51, 0x9f, 0xa2, 0x21, 0x1a,
-		0xb7, 0x75, 0x42, 0x69, 0xd3, 0x14, 0xdd, 0x05,
-		0x1e, 0xda, 0x13, 0x71, 0x8d, 0x6a, 0x45, 0x97,
-		0xcb, 0xee, 0x0e, 0x77, 0x01, 0x0d, 0x6e, 0xe5,
-		0x22, 0x70, 0x16, 0x20, 0x69, 0xfc, 0xa6, 0x9a,
-		0xe8, 0x21, 0xcc, 0x46, 0x65, 0x05, 0xb4, 0x48,
-		0x0f, 0x34, 0x63, 0x2c, 0xac, 0xa4, 0xf5, 0x4b,
-		0x64, 0xd1, 0x07, 0x13, 0xa7, 0xe4, 0x5b, 0xa3,
-		0x4d, 0x31, 0x41, 0x53, 0xc0, 0x13, 0x00, 0x00,
-		0x08, 0x00, 0x0b, 0x00, 0x04, 0x03, 0x00, 0x01,
-		0x02, 0x16, 0x03, 0x02, 0x02, 0x39, 0x0b, 0x00,
-		0x02, 0x35, 0x00, 0x02, 0x32, 0x00, 0x02, 0x2f,
-		0x30, 0x82, 0x02, 0x2b, 0x30, 0x82, 0x01, 0xd5,
-		0xa0, 0x03, 0x02, 0x01, 0x02, 0x02, 0x09, 0x00,
-		0xb1, 0x35, 0x13, 0x65, 0x11, 0x20, 0xc5, 0x92,
-		0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86,
-		0xf7, 0x0d, 0x01, 0x01, 0x05, 0x05, 0x00, 0x30,
-		0x45, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55,
-		0x04, 0x06, 0x13, 0x02, 0x41, 0x55, 0x31, 0x13,
-		0x30, 0x11, 0x06, 0x03, 0x55, 0x04, 0x08, 0x13,
-		0x0a, 0x53, 0x6f, 0x6d, 0x65, 0x2d, 0x53, 0x74,
-		0x61, 0x74, 0x65, 0x31, 0x21, 0x30, 0x1f, 0x06,
-		0x03, 0x55, 0x04, 0x0a, 0x13, 0x18, 0x49, 0x6e,
-		0x74, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x57,
-		0x69, 0x64, 0x67, 0x69, 0x74, 0x73, 0x20, 0x50,
-		0x74, 0x79, 0x20, 0x4c, 0x74, 0x64, 0x30, 0x1e,
-		0x17, 0x0d, 0x31, 0x32, 0x30, 0x34, 0x30, 0x36,
-		0x31, 0x37, 0x31, 0x30, 0x31, 0x33, 0x5a, 0x17,
-		0x0d, 0x31, 0x35, 0x30, 0x34, 0x30, 0x36, 0x31,
-		0x37, 0x31, 0x30, 0x31, 0x33, 0x5a, 0x30, 0x45,
-		0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04,
-		0x06, 0x13, 0x02, 0x41, 0x55, 0x31, 0x13, 0x30,
-		0x11, 0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0a,
-		0x53, 0x6f, 0x6d, 0x65, 0x2d, 0x53, 0x74, 0x61,
-		0x74, 0x65, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x03,
-		0x55, 0x04, 0x0a, 0x13, 0x18, 0x49, 0x6e, 0x74,
-		0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x57, 0x69,
-		0x64, 0x67, 0x69, 0x74, 0x73, 0x20, 0x50, 0x74,
-		0x79, 0x20, 0x4c, 0x74, 0x64, 0x30, 0x5c, 0x30,
-		0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7,
-		0x0d, 0x01, 0x01, 0x01, 0x05, 0x00, 0x03, 0x4b,
-		0x00, 0x30, 0x48, 0x02, 0x41, 0x00, 0x9f, 0xb3,
-		0xc3, 0x84, 0x27, 0x95, 0xff, 0x12, 0x31, 0x52,
-		0x0f, 0x15, 0xef, 0x46, 0x11, 0xc4, 0xad, 0x80,
-		0xe6, 0x36, 0x5b, 0x0f, 0xdd, 0x80, 0xd7, 0x61,
-		0x8d, 0xe0, 0xfc, 0x72, 0x45, 0x09, 0x34, 0xfe,
-		0x55, 0x66, 0x45, 0x43, 0x4c, 0x68, 0x97, 0x6a,
-		0xfe, 0xa8, 0xa0, 0xa5, 0xdf, 0x5f, 0x78, 0xff,
-		0xee, 0xd7, 0x64, 0xb8, 0x3f, 0x04, 0xcb, 0x6f,
-		0xff, 0x2a, 0xfe, 0xfe, 0xb9, 0xed, 0x02, 0x03,
-		0x01, 0x00, 0x01, 0xa3, 0x81, 0xa7, 0x30, 0x81,
-		0xa4, 0x30, 0x1d, 0x06, 0x03, 0x55, 0x1d, 0x0e,
-		0x04, 0x16, 0x04, 0x14, 0x78, 0xa6, 0x97, 0x9a,
-		0x63, 0xb5, 0xc5, 0xa1, 0xa5, 0x33, 0xba, 0x22,
-		0x7c, 0x23, 0x6e, 0x5b, 0x1b, 0x7a, 0xcc, 0x2b,
-		0x30, 0x75, 0x06, 0x03, 0x55, 0x1d, 0x23, 0x04,
-		0x6e, 0x30, 0x6c, 0x80, 0x14, 0x78, 0xa6, 0x97,
-		0x9a, 0x63, 0xb5, 0xc5, 0xa1, 0xa5, 0x33, 0xba,
-		0x22, 0x7c, 0x23, 0x6e, 0x5b, 0x1b, 0x7a, 0xcc,
-		0x2b, 0xa1, 0x49, 0xa4, 0x47, 0x30, 0x45, 0x31,
-		0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06,
-		0x13, 0x02, 0x41, 0x55, 0x31, 0x13, 0x30, 0x11,
-		0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0a, 0x53,
-		0x6f, 0x6d, 0x65, 0x2d, 0x53, 0x74, 0x61, 0x74,
-		0x65, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x03, 0x55,
-		0x04, 0x0a, 0x13, 0x18, 0x49, 0x6e, 0x74, 0x65,
-		0x72, 0x6e, 0x65, 0x74, 0x20, 0x57, 0x69, 0x64,
-		0x67, 0x69, 0x74, 0x73, 0x20, 0x50, 0x74, 0x79,
-		0x20, 0x4c, 0x74, 0x64, 0x82, 0x09, 0x00, 0xb1,
-		0x35, 0x13, 0x65, 0x11, 0x20, 0xc5, 0x92, 0x30,
-		0x0c, 0x06, 0x03, 0x55, 0x1d, 0x13, 0x04, 0x05,
-		0x30, 0x03, 0x01, 0x01, 0xff, 0x30, 0x0d, 0x06,
-		0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01,
-		0x01, 0x05, 0x05, 0x00, 0x03, 0x41, 0x00, 0x85,
-		0x36, 0x40, 0x73, 0xc1, 0xbb, 0x1a, 0xda, 0xd4,
-		0x59, 0x9f, 0x2d, 0xa2, 0x70, 0x31, 0x46, 0x74,
-		0xec, 0x83, 0x6e, 0xa8, 0xc8, 0x3c, 0x51, 0xaf,
-		0x39, 0xac, 0xec, 0x40, 0xbc, 0xe8, 0x22, 0x46,
-		0x1d, 0x99, 0xd6, 0x46, 0x2a, 0x24, 0xd4, 0x8b,
-		0x05, 0x08, 0x4b, 0xfb, 0x35, 0x11, 0x6e, 0x92,
-		0xbb, 0x77, 0xba, 0xe4, 0x12, 0xbb, 0xf4, 0xc8,
-		0x5e, 0x9c, 0x81, 0xa8, 0x97, 0x60, 0x4c, 0x16,
-		0x03, 0x02, 0x00, 0x8b, 0x0c, 0x00, 0x00, 0x87,
-		0x03, 0x00, 0x17, 0x41, 0x04, 0x34, 0xde, 0x50,
-		0x32, 0x8f, 0x25, 0x6b, 0x37, 0x2c, 0x36, 0x24,
-		0x27, 0x0e, 0xf9, 0x67, 0xb4, 0xf8, 0x29, 0x1c,
-		0xa5, 0xa4, 0x59, 0x9a, 0xca, 0x40, 0x26, 0x15,
-		0x61, 0x72, 0x34, 0x4a, 0xd3, 0x0c, 0xac, 0x69,
-		0xcb, 0x2a, 0x9e, 0xf8, 0x80, 0xfb, 0x7a, 0xc4,
-		0xd4, 0x4b, 0x91, 0x1b, 0xbe, 0x24, 0x26, 0xad,
-		0x19, 0x24, 0xbe, 0x32, 0x58, 0xfb, 0xc7, 0x77,
-		0xce, 0x7e, 0x71, 0x51, 0x1a, 0x00, 0x40, 0x1a,
-		0x0b, 0xe8, 0x91, 0x84, 0x64, 0x54, 0xb6, 0x19,
-		0xe8, 0xd4, 0x43, 0x7c, 0x09, 0x0c, 0x2e, 0xba,
-		0x42, 0xb9, 0x74, 0xc3, 0x6c, 0x06, 0x9b, 0xa6,
-		0x7e, 0x92, 0xe9, 0xee, 0x7c, 0x74, 0xa9, 0xd3,
-		0x63, 0xf0, 0x16, 0x20, 0x60, 0x71, 0x8e, 0x24,
-		0xc7, 0x7f, 0xc5, 0x5b, 0x9c, 0x19, 0x0c, 0x80,
-		0x15, 0x61, 0xbf, 0xb6, 0xed, 0x5b, 0x7b, 0x90,
-		0xc5, 0x05, 0x13, 0x72, 0x45, 0x79, 0xdf, 0x16,
-		0x03, 0x02, 0x00, 0x04, 0x0e, 0x00, 0x00, 0x00,
-	},
-	{
-		0x16, 0x03, 0x02, 0x00, 0x46, 0x10, 0x00, 0x00,
-		0x42, 0x41, 0x04, 0x1e, 0x18, 0x37, 0xef, 0x0d,
-		0x19, 0x51, 0x88, 0x35, 0x75, 0x71, 0xb5, 0xe5,
-		0x54, 0x5b, 0x12, 0x2e, 0x8f, 0x09, 0x67, 0xfd,
-		0xa7, 0x24, 0x20, 0x3e, 0xb2, 0x56, 0x1c, 0xce,
-		0x97, 0x28, 0x5e, 0xf8, 0x2b, 0x2d, 0x4f, 0x9e,
-		0xf1, 0x07, 0x9f, 0x6c, 0x4b, 0x5b, 0x83, 0x56,
-		0xe2, 0x32, 0x42, 0xe9, 0x58, 0xb6, 0xd7, 0x49,
-		0xa6, 0xb5, 0x68, 0x1a, 0x41, 0x03, 0x56, 0x6b,
-		0xdc, 0x5a, 0x89, 0x14, 0x03, 0x02, 0x00, 0x01,
-		0x01, 0x16, 0x03, 0x02, 0x00, 0x40, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xf8, 0x50,
-		0x32, 0x26, 0x51, 0xbd, 0xbd, 0x3c, 0x4f, 0x72,
-		0xbf, 0xbc, 0x91, 0x70, 0x4b, 0x5d, 0x43, 0x4a,
-		0x65, 0x26, 0x0d, 0xaa, 0xed, 0x00, 0x91, 0xaf,
-		0x4f, 0x47, 0x09, 0xaa, 0x79, 0xc4, 0x47, 0x21,
-		0x71, 0xd8, 0x2b, 0xc1, 0x51, 0xc8, 0xef, 0xed,
-		0x67, 0xde, 0x97, 0xef, 0x18, 0x53,
-	},
-	{
-		0x14, 0x03, 0x02, 0x00, 0x01, 0x01, 0x16, 0x03,
-		0x02, 0x00, 0x40, 0x72, 0x20, 0xbf, 0xd1, 0xbd,
-		0x83, 0x53, 0x57, 0xb0, 0x4e, 0xac, 0xba, 0x1a,
-		0x2b, 0x2d, 0xeb, 0x8a, 0x48, 0x17, 0xfa, 0x69,
-		0xf9, 0xb5, 0x94, 0x8e, 0x6f, 0x9c, 0xda, 0x59,
-		0xba, 0x6c, 0x7c, 0x82, 0xe2, 0x53, 0xa9, 0x46,
-		0xdc, 0x33, 0xa0, 0x9b, 0xf0, 0x1e, 0xf1, 0x53,
-		0x83, 0x48, 0xbf, 0x5e, 0xef, 0x03, 0x2b, 0x50,
-		0x7a, 0xa6, 0xf8, 0xc3, 0x9e, 0x24, 0x43, 0x3a,
-		0xdf, 0x44, 0x3e,
-	},
-	{
-		0x17, 0x03, 0x02, 0x00, 0x30, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x22, 0x0b, 0x8f,
-		0x6b, 0xf9, 0xd3, 0x9f, 0x2b, 0x49, 0xe0, 0x62,
-		0x9a, 0x0b, 0x3e, 0xa2, 0x72, 0x8b, 0x96, 0x0c,
-		0x41, 0x09, 0x95, 0x9e, 0x6b, 0x26, 0xa1, 0x46,
-		0xca, 0xb8, 0xb6, 0xd2, 0xd4, 0x15, 0x03, 0x02,
-		0x00, 0x30, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0xa0, 0xd4, 0x84, 0xc6, 0x7e, 0x1c,
-		0x2f, 0xbd, 0x6b, 0x45, 0x31, 0x1d, 0x7d, 0x8f,
-		0x31, 0x39, 0x5a, 0x4e, 0xaa, 0xf1, 0x0a, 0x8a,
-		0x6c, 0x33, 0x59, 0x19, 0xd8, 0x75, 0x80, 0xab,
-		0x93, 0x81,
-	},
+func TestHandshakeClientECDHERSAAES(t *testing.T) {
+	test := &clientTest{
+		name:    "ECDHE-RSA-AES",
+		command: []string{"openssl", "s_server", "-cipher", "ECDHE-RSA-AES128-SHA"},
+	}
+	runClientTestTLS10(t, test)
+	runClientTestTLS11(t, test)
+	runClientTestTLS12(t, test)
 }
 
-var clientChainCertificateScript = [][]byte{
-	{
-		0x16, 0x03, 0x01, 0x00, 0x4a, 0x01, 0x00, 0x00,
-		0x46, 0x03, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0x00, 0x05,
-		0x01, 0x00, 0x00, 0x1b, 0x00, 0x05, 0x00, 0x05,
-		0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0a, 0x00,
-		0x08, 0x00, 0x06, 0x00, 0x17, 0x00, 0x18, 0x00,
-		0x19, 0x00, 0x0b, 0x00, 0x02, 0x01, 0x00,
-	},
-	{
-		0x16, 0x03, 0x01, 0x00, 0x4a, 0x02, 0x00, 0x00,
-		0x46, 0x03, 0x01, 0x51, 0xa2, 0x9b, 0x8b, 0xd4,
-		0xe6, 0x33, 0xa2, 0x70, 0x38, 0x37, 0xba, 0x55,
-		0x86, 0xcf, 0x87, 0xea, 0x6d, 0x2c, 0x3e, 0x17,
-		0xc2, 0x09, 0xf8, 0x4d, 0xb0, 0x5d, 0x93, 0x2b,
-		0x15, 0x99, 0x0c, 0x20, 0x5d, 0x61, 0x21, 0x2c,
-		0xed, 0x49, 0x32, 0x29, 0x08, 0x6e, 0x21, 0x58,
-		0x00, 0xdb, 0x34, 0xb7, 0x37, 0xcd, 0x27, 0x75,
-		0x31, 0x1e, 0x6c, 0x74, 0xa6, 0xef, 0xa2, 0xc4,
-		0x2b, 0x6c, 0xc3, 0x03, 0x00, 0x05, 0x00, 0x16,
-		0x03, 0x01, 0x03, 0xef, 0x0b, 0x00, 0x03, 0xeb,
-		0x00, 0x03, 0xe8, 0x00, 0x03, 0xe5, 0x30, 0x82,
-		0x03, 0xe1, 0x30, 0x82, 0x02, 0xc9, 0xa0, 0x03,
-		0x02, 0x01, 0x02, 0x02, 0x09, 0x00, 0xcc, 0x22,
-		0x4c, 0x4b, 0x98, 0xa2, 0x88, 0xfc, 0x30, 0x0d,
-		0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d,
-		0x01, 0x01, 0x05, 0x05, 0x00, 0x30, 0x81, 0x86,
-		0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04,
-		0x06, 0x13, 0x02, 0x55, 0x53, 0x31, 0x0b, 0x30,
-		0x09, 0x06, 0x03, 0x55, 0x04, 0x08, 0x0c, 0x02,
-		0x4e, 0x59, 0x31, 0x11, 0x30, 0x0f, 0x06, 0x03,
-		0x55, 0x04, 0x07, 0x0c, 0x08, 0x42, 0x72, 0x6f,
-		0x6f, 0x6b, 0x6c, 0x79, 0x6e, 0x31, 0x21, 0x30,
-		0x1f, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x0c, 0x18,
-		0x4d, 0x79, 0x20, 0x43, 0x65, 0x72, 0x74, 0x69,
-		0x66, 0x69, 0x63, 0x61, 0x74, 0x65, 0x20, 0x41,
-		0x75, 0x74, 0x68, 0x6f, 0x72, 0x69, 0x74, 0x79,
-		0x31, 0x11, 0x30, 0x0f, 0x06, 0x03, 0x55, 0x04,
-		0x03, 0x0c, 0x08, 0x6d, 0x79, 0x63, 0x61, 0x2e,
-		0x6f, 0x72, 0x67, 0x31, 0x21, 0x30, 0x1f, 0x06,
-		0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01,
-		0x09, 0x01, 0x16, 0x12, 0x6a, 0x76, 0x73, 0x68,
-		0x61, 0x68, 0x69, 0x64, 0x40, 0x67, 0x6d, 0x61,
-		0x69, 0x6c, 0x2e, 0x63, 0x6f, 0x6d, 0x30, 0x1e,
-		0x17, 0x0d, 0x31, 0x33, 0x30, 0x35, 0x32, 0x36,
-		0x32, 0x31, 0x30, 0x35, 0x30, 0x31, 0x5a, 0x17,
-		0x0d, 0x32, 0x33, 0x30, 0x35, 0x32, 0x34, 0x32,
-		0x31, 0x30, 0x35, 0x30, 0x31, 0x5a, 0x30, 0x81,
-		0x86, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55,
-		0x04, 0x06, 0x13, 0x02, 0x55, 0x53, 0x31, 0x0b,
-		0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x08, 0x0c,
-		0x02, 0x4e, 0x59, 0x31, 0x11, 0x30, 0x0f, 0x06,
-		0x03, 0x55, 0x04, 0x07, 0x0c, 0x08, 0x42, 0x72,
-		0x6f, 0x6f, 0x6b, 0x6c, 0x79, 0x6e, 0x31, 0x21,
-		0x30, 0x1f, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x0c,
-		0x18, 0x4d, 0x79, 0x20, 0x43, 0x65, 0x72, 0x74,
-		0x69, 0x66, 0x69, 0x63, 0x61, 0x74, 0x65, 0x20,
-		0x41, 0x75, 0x74, 0x68, 0x6f, 0x72, 0x69, 0x74,
-		0x79, 0x31, 0x11, 0x30, 0x0f, 0x06, 0x03, 0x55,
-		0x04, 0x03, 0x0c, 0x08, 0x6d, 0x79, 0x63, 0x61,
-		0x2e, 0x6f, 0x72, 0x67, 0x31, 0x21, 0x30, 0x1f,
-		0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d,
-		0x01, 0x09, 0x01, 0x16, 0x12, 0x6a, 0x76, 0x73,
-		0x68, 0x61, 0x68, 0x69, 0x64, 0x40, 0x67, 0x6d,
-		0x61, 0x69, 0x6c, 0x2e, 0x63, 0x6f, 0x6d, 0x30,
-		0x82, 0x01, 0x22, 0x30, 0x0d, 0x06, 0x09, 0x2a,
-		0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x01,
-		0x05, 0x00, 0x03, 0x82, 0x01, 0x0f, 0x00, 0x30,
-		0x82, 0x01, 0x0a, 0x02, 0x82, 0x01, 0x01, 0x00,
-		0xf0, 0xfb, 0xad, 0x80, 0x5e, 0x37, 0xd3, 0x6d,
-		0xee, 0x2e, 0xcc, 0xbc, 0x0c, 0xd7, 0x56, 0x4b,
-		0x56, 0x45, 0xcd, 0x28, 0xb6, 0x22, 0xe9, 0xe2,
-		0x0f, 0xd1, 0x87, 0x2a, 0x27, 0xce, 0x77, 0x8d,
-		0x6e, 0x0e, 0x0f, 0xfb, 0x66, 0xe1, 0xb5, 0x0e,
-		0x9a, 0xb6, 0x05, 0x8e, 0xb3, 0xe1, 0xc5, 0x77,
-		0x86, 0x5b, 0x46, 0xd2, 0x0b, 0x92, 0x03, 0x1b,
-		0x89, 0x0c, 0x1b, 0x10, 0x0e, 0x99, 0x8f, 0xe2,
-		0x17, 0xe8, 0xc2, 0x30, 0x00, 0x47, 0xd6, 0xfc,
-		0xf9, 0x0f, 0x3b, 0x75, 0x34, 0x8d, 0x4d, 0xb0,
-		0x99, 0xb7, 0xa0, 0x6d, 0xa0, 0xb6, 0xad, 0xda,
-		0x07, 0x5e, 0x38, 0x2e, 0x02, 0xe4, 0x30, 0x6d,
-		0xae, 0x13, 0x72, 0xd4, 0xc8, 0xce, 0x14, 0x07,
-		0xae, 0x23, 0x8c, 0x8f, 0x9e, 0x8c, 0x60, 0xd6,
-		0x06, 0xb9, 0xef, 0x00, 0x18, 0xc0, 0x1d, 0x25,
-		0x1e, 0xda, 0x3e, 0x2f, 0xcf, 0x2b, 0x56, 0x84,
-		0x9e, 0x30, 0x21, 0xc7, 0x29, 0xf6, 0x03, 0x8a,
-		0x24, 0xf9, 0x34, 0xac, 0x65, 0x9d, 0x80, 0x36,
-		0xc8, 0x3b, 0x15, 0x10, 0xbd, 0x51, 0xe9, 0xbc,
-		0x02, 0xe1, 0xe9, 0xb3, 0x5a, 0x9a, 0x99, 0x41,
-		0x1b, 0x27, 0xa0, 0x4d, 0x50, 0x9e, 0x27, 0x7f,
-		0xa1, 0x7d, 0x09, 0x87, 0xbd, 0x8a, 0xca, 0x5f,
-		0xb1, 0xa5, 0x08, 0xb8, 0x04, 0xd4, 0x52, 0x89,
-		0xaa, 0xe0, 0x7d, 0x42, 0x2e, 0x2f, 0x15, 0xee,
-		0x66, 0x57, 0x0f, 0x13, 0x19, 0x45, 0xa8, 0x4b,
-		0x5d, 0x81, 0x66, 0xcc, 0x12, 0x37, 0x94, 0x5e,
-		0xfd, 0x3c, 0x10, 0x81, 0x51, 0x3f, 0xfa, 0x0f,
-		0xdd, 0xa1, 0x89, 0x03, 0xa9, 0x78, 0x91, 0xf5,
-		0x3b, 0xf3, 0xbc, 0xac, 0xbe, 0x93, 0x30, 0x2e,
-		0xbe, 0xca, 0x7f, 0x46, 0xd3, 0x28, 0xb4, 0x4e,
-		0x91, 0x7b, 0x5b, 0x43, 0x6c, 0xaf, 0x9b, 0x5c,
-		0x6a, 0x6d, 0x5a, 0xdb, 0x79, 0x5e, 0x6a, 0x6b,
-		0x02, 0x03, 0x01, 0x00, 0x01, 0xa3, 0x50, 0x30,
-		0x4e, 0x30, 0x1d, 0x06, 0x03, 0x55, 0x1d, 0x0e,
-		0x04, 0x16, 0x04, 0x14, 0x6b, 0x1e, 0x00, 0xa8,
-		0x9f, 0xfa, 0x7d, 0x00, 0xf9, 0xe0, 0x9d, 0x0f,
-		0x90, 0x8c, 0x90, 0xa8, 0xa1, 0x37, 0x6b, 0xda,
-		0x30, 0x1f, 0x06, 0x03, 0x55, 0x1d, 0x23, 0x04,
-		0x18, 0x30, 0x16, 0x80, 0x14, 0x6b, 0x1e, 0x00,
-		0xa8, 0x9f, 0xfa, 0x7d, 0x00, 0xf9, 0xe0, 0x9d,
-		0x0f, 0x90, 0x8c, 0x90, 0xa8, 0xa1, 0x37, 0x6b,
-		0xda, 0x30, 0x0c, 0x06, 0x03, 0x55, 0x1d, 0x13,
-		0x04, 0x05, 0x30, 0x03, 0x01, 0x01, 0xff, 0x30,
-		0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7,
-		0x0d, 0x01, 0x01, 0x05, 0x05, 0x00, 0x03, 0x82,
-		0x01, 0x01, 0x00, 0xcd, 0x6f, 0x73, 0x4d, 0x56,
-		0x0b, 0xf3, 0x2e, 0x1c, 0xe2, 0x02, 0x0c, 0x14,
-		0xbb, 0x2f, 0xdd, 0x3c, 0x43, 0xfe, 0xdf, 0x94,
-		0x2d, 0xa9, 0x89, 0x81, 0x51, 0xf8, 0x5f, 0xa7,
-		0xa0, 0x13, 0xaa, 0xcc, 0xb0, 0x18, 0xe2, 0x57,
-		0x3e, 0x0d, 0x29, 0x93, 0xe8, 0x95, 0xd5, 0x1b,
-		0x53, 0xd2, 0x51, 0xf2, 0xbd, 0xf5, 0x9e, 0x7b,
-		0x22, 0x65, 0x62, 0x5c, 0xc4, 0x4c, 0x1d, 0xe8,
-		0xe9, 0xc3, 0xd4, 0x2b, 0xe7, 0x78, 0xcb, 0x10,
-		0xf3, 0xfe, 0x06, 0x83, 0xdc, 0x3a, 0x1e, 0x62,
-		0x10, 0xc0, 0x46, 0x77, 0xc6, 0x9d, 0x9f, 0xab,
-		0x96, 0x25, 0x5c, 0xfb, 0x26, 0xc1, 0x15, 0x1f,
-		0xa5, 0x33, 0xee, 0x4f, 0x9a, 0x14, 0x6a, 0x14,
-		0x97, 0x93, 0x2b, 0x95, 0x0b, 0xdc, 0xa8, 0xd7,
-		0x69, 0x2e, 0xf0, 0x01, 0x0e, 0xfd, 0x4e, 0xd0,
-		0xd9, 0xa8, 0xe5, 0x65, 0xde, 0xfb, 0xca, 0xca,
-		0x1c, 0x5f, 0xf9, 0x53, 0xa0, 0x87, 0xe7, 0x33,
-		0x9b, 0x2f, 0xcf, 0xe4, 0x13, 0xfc, 0xec, 0x7a,
-		0x6c, 0xb0, 0x90, 0x13, 0x9b, 0xb6, 0xc5, 0x03,
-		0xf6, 0x0e, 0x5e, 0xe2, 0xe4, 0x26, 0xc1, 0x7e,
-		0x53, 0xfe, 0x69, 0xa3, 0xc7, 0xd8, 0x8e, 0x6e,
-		0x94, 0x32, 0xa0, 0xde, 0xca, 0xb6, 0xcc, 0xd6,
-		0x01, 0xd5, 0x78, 0x40, 0x28, 0x63, 0x9b, 0xee,
-		0xcf, 0x09, 0x3b, 0x35, 0x04, 0xf0, 0x14, 0x02,
-		0xf6, 0x80, 0x0e, 0x90, 0xb2, 0x94, 0xd2, 0x25,
-		0x16, 0xb8, 0x7a, 0x76, 0x87, 0x84, 0x9f, 0x84,
-		0xc5, 0xaf, 0xc2, 0x6d, 0x68, 0x7a, 0x84, 0x9c,
-		0xc6, 0x8a, 0x63, 0x60, 0x87, 0x6a, 0x25, 0xc1,
-		0xa1, 0x78, 0x0f, 0xba, 0xe8, 0x5f, 0xe1, 0xba,
-		0xac, 0xa4, 0x6f, 0xdd, 0x09, 0x3f, 0x12, 0xcb,
-		0x1d, 0xf3, 0xcf, 0x48, 0xd7, 0xd3, 0x26, 0xe8,
-		0x9c, 0xc3, 0x53, 0xb3, 0xba, 0xdc, 0x32, 0x99,
-		0x98, 0x96, 0xd6, 0x16, 0x03, 0x01, 0x00, 0x99,
-		0x0d, 0x00, 0x00, 0x91, 0x03, 0x01, 0x02, 0x40,
-		0x00, 0x8b, 0x00, 0x89, 0x30, 0x81, 0x86, 0x31,
-		0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06,
-		0x13, 0x02, 0x55, 0x53, 0x31, 0x0b, 0x30, 0x09,
-		0x06, 0x03, 0x55, 0x04, 0x08, 0x0c, 0x02, 0x4e,
-		0x59, 0x31, 0x11, 0x30, 0x0f, 0x06, 0x03, 0x55,
-		0x04, 0x07, 0x0c, 0x08, 0x42, 0x72, 0x6f, 0x6f,
-		0x6b, 0x6c, 0x79, 0x6e, 0x31, 0x21, 0x30, 0x1f,
-		0x06, 0x03, 0x55, 0x04, 0x0a, 0x0c, 0x18, 0x4d,
-		0x79, 0x20, 0x43, 0x65, 0x72, 0x74, 0x69, 0x66,
-		0x69, 0x63, 0x61, 0x74, 0x65, 0x20, 0x41, 0x75,
-		0x74, 0x68, 0x6f, 0x72, 0x69, 0x74, 0x79, 0x31,
-		0x11, 0x30, 0x0f, 0x06, 0x03, 0x55, 0x04, 0x03,
-		0x0c, 0x08, 0x6d, 0x79, 0x63, 0x61, 0x2e, 0x6f,
-		0x72, 0x67, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x09,
-		0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x09,
-		0x01, 0x16, 0x12, 0x6a, 0x76, 0x73, 0x68, 0x61,
-		0x68, 0x69, 0x64, 0x40, 0x67, 0x6d, 0x61, 0x69,
-		0x6c, 0x2e, 0x63, 0x6f, 0x6d, 0x0e, 0x00, 0x00,
-		0x00,
-	},
-	{
-		0x16, 0x03, 0x01, 0x0a, 0xfb, 0x0b, 0x00, 0x0a,
-		0xf7, 0x00, 0x0a, 0xf4, 0x00, 0x03, 0x7e, 0x30,
-		0x82, 0x03, 0x7a, 0x30, 0x82, 0x02, 0x62, 0x02,
-		0x09, 0x00, 0xb4, 0x47, 0x58, 0x57, 0x2b, 0x67,
-		0xc8, 0xc2, 0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86,
-		0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x05, 0x05,
-		0x00, 0x30, 0x81, 0x80, 0x31, 0x0b, 0x30, 0x09,
-		0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x55,
-		0x53, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55,
-		0x04, 0x08, 0x0c, 0x02, 0x4e, 0x59, 0x31, 0x11,
-		0x30, 0x0f, 0x06, 0x03, 0x55, 0x04, 0x07, 0x0c,
-		0x08, 0x42, 0x72, 0x6f, 0x6f, 0x6b, 0x6c, 0x79,
-		0x6e, 0x31, 0x15, 0x30, 0x13, 0x06, 0x03, 0x55,
-		0x04, 0x0a, 0x0c, 0x0c, 0x4d, 0x79, 0x20, 0x43,
-		0x41, 0x20, 0x43, 0x6c, 0x69, 0x65, 0x6e, 0x74,
-		0x31, 0x17, 0x30, 0x15, 0x06, 0x03, 0x55, 0x04,
-		0x03, 0x0c, 0x0e, 0x6d, 0x79, 0x63, 0x61, 0x63,
-		0x6c, 0x69, 0x65, 0x6e, 0x74, 0x2e, 0x63, 0x6f,
-		0x6d, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x09, 0x2a,
-		0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x09, 0x01,
-		0x16, 0x12, 0x6a, 0x76, 0x73, 0x68, 0x61, 0x68,
-		0x69, 0x64, 0x40, 0x67, 0x6d, 0x61, 0x69, 0x6c,
-		0x2e, 0x63, 0x6f, 0x6d, 0x30, 0x1e, 0x17, 0x0d,
-		0x31, 0x33, 0x30, 0x35, 0x32, 0x36, 0x32, 0x31,
-		0x34, 0x34, 0x30, 0x30, 0x5a, 0x17, 0x0d, 0x31,
-		0x33, 0x30, 0x36, 0x32, 0x35, 0x32, 0x31, 0x34,
-		0x34, 0x30, 0x30, 0x5a, 0x30, 0x7d, 0x31, 0x0b,
-		0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13,
-		0x02, 0x55, 0x53, 0x31, 0x11, 0x30, 0x0f, 0x06,
-		0x03, 0x55, 0x04, 0x08, 0x0c, 0x08, 0x4e, 0x65,
-		0x77, 0x20, 0x59, 0x6f, 0x72, 0x6b, 0x31, 0x11,
-		0x30, 0x0f, 0x06, 0x03, 0x55, 0x04, 0x07, 0x0c,
-		0x08, 0x42, 0x72, 0x6f, 0x6f, 0x6b, 0x6c, 0x79,
-		0x6e, 0x31, 0x10, 0x30, 0x0e, 0x06, 0x03, 0x55,
-		0x04, 0x0a, 0x0c, 0x07, 0x4d, 0x79, 0x20, 0x4c,
-		0x65, 0x61, 0x66, 0x31, 0x13, 0x30, 0x11, 0x06,
-		0x03, 0x55, 0x04, 0x03, 0x0c, 0x0a, 0x6d, 0x79,
-		0x6c, 0x65, 0x61, 0x66, 0x2e, 0x63, 0x6f, 0x6d,
-		0x31, 0x21, 0x30, 0x1f, 0x06, 0x09, 0x2a, 0x86,
-		0x48, 0x86, 0xf7, 0x0d, 0x01, 0x09, 0x01, 0x16,
-		0x12, 0x6a, 0x76, 0x73, 0x68, 0x61, 0x68, 0x69,
-		0x64, 0x40, 0x67, 0x6d, 0x61, 0x69, 0x6c, 0x2e,
-		0x63, 0x6f, 0x6d, 0x30, 0x82, 0x01, 0x22, 0x30,
-		0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7,
-		0x0d, 0x01, 0x01, 0x01, 0x05, 0x00, 0x03, 0x82,
-		0x01, 0x0f, 0x00, 0x30, 0x82, 0x01, 0x0a, 0x02,
-		0x82, 0x01, 0x01, 0x00, 0xa0, 0xa3, 0xef, 0xc1,
-		0x44, 0x7d, 0xa2, 0xe3, 0x71, 0x98, 0x27, 0x63,
-		0xb3, 0x1d, 0x71, 0x50, 0xa6, 0x34, 0x15, 0xcb,
-		0xc9, 0x2a, 0xc3, 0xea, 0xe4, 0x9e, 0x9c, 0x49,
-		0xa6, 0x01, 0x9b, 0x7e, 0xa9, 0xb5, 0x7a, 0xff,
-		0x15, 0x92, 0x71, 0xc8, 0x97, 0x9c, 0x25, 0xb7,
-		0x79, 0x2b, 0xff, 0xab, 0xc6, 0xb1, 0xa7, 0x00,
-		0x90, 0xb2, 0x8b, 0xd7, 0x71, 0xd5, 0xc2, 0x3a,
-		0xe6, 0x82, 0x42, 0x37, 0x89, 0x41, 0x04, 0xb0,
-		0xba, 0xc7, 0x5b, 0x8a, 0x43, 0x9f, 0x97, 0x39,
-		0x0c, 0x0f, 0xd5, 0x6d, 0x9e, 0x8d, 0xeb, 0xc0,
-		0x26, 0xc5, 0x18, 0xe8, 0x7a, 0x3d, 0x32, 0x2e,
-		0x38, 0x90, 0x40, 0x5b, 0x39, 0x2c, 0x07, 0xcb,
-		0x24, 0x10, 0xc5, 0xc9, 0x3b, 0xe3, 0x66, 0x47,
-		0x57, 0xb9, 0x6a, 0xad, 0x44, 0xf8, 0xd0, 0x70,
-		0x62, 0x3b, 0x8e, 0xed, 0x60, 0x5f, 0x22, 0xf8,
-		0xb8, 0x0c, 0xc9, 0x41, 0x2b, 0xc9, 0x80, 0x6e,
-		0x4e, 0x1b, 0xe1, 0x20, 0xfc, 0x47, 0xa4, 0xac,
-		0xc3, 0x3f, 0xe6, 0xc2, 0x81, 0x79, 0x03, 0x37,
-		0x25, 0x89, 0xca, 0xd6, 0xa5, 0x46, 0x91, 0x63,
-		0x41, 0xc5, 0x3e, 0xd5, 0xed, 0x7f, 0x4f, 0x8d,
-		0x06, 0xc0, 0x89, 0x00, 0xbe, 0x37, 0x7b, 0x7e,
-		0x73, 0xca, 0x70, 0x00, 0x14, 0x34, 0xbe, 0x47,
-		0xbc, 0xb2, 0x6a, 0x28, 0xa5, 0x29, 0x84, 0xa8,
-		0x9d, 0xc8, 0x1e, 0x77, 0x66, 0x1f, 0x9f, 0xaa,
-		0x2b, 0x47, 0xdb, 0xdd, 0x6b, 0x9c, 0xa8, 0xfc,
-		0x82, 0x36, 0x94, 0x62, 0x0d, 0x5c, 0x3f, 0xb2,
-		0x01, 0xb4, 0xa5, 0xb8, 0xc6, 0x0e, 0x94, 0x5b,
-		0xec, 0x5e, 0xbb, 0x7a, 0x63, 0x24, 0xf1, 0xf9,
-		0xd6, 0x50, 0x08, 0xc1, 0xa3, 0xcc, 0x90, 0x07,
-		0x5b, 0x04, 0x04, 0x42, 0x74, 0xcf, 0x37, 0xfa,
-		0xf0, 0xa5, 0xd9, 0xd3, 0x86, 0x89, 0x89, 0x18,
-		0xf3, 0x4c, 0xe2, 0x11, 0x02, 0x03, 0x01, 0x00,
-		0x01, 0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48,
-		0x86, 0xf7, 0x0d, 0x01, 0x01, 0x05, 0x05, 0x00,
-		0x03, 0x82, 0x01, 0x01, 0x00, 0x90, 0xbb, 0xf9,
-		0x5e, 0xba, 0x17, 0x1f, 0xac, 0x21, 0x9f, 0x6b,
-		0x4a, 0x46, 0xd0, 0x6d, 0x3c, 0x8f, 0x3d, 0xf8,
-		0x5e, 0x3e, 0x72, 0xaf, 0xa0, 0x1a, 0xf3, 0xff,
-		0x89, 0xac, 0x5b, 0x7a, 0xe2, 0x91, 0x2a, 0x23,
-		0x85, 0xc6, 0x4d, 0x47, 0x67, 0x01, 0x08, 0xa8,
-		0x05, 0x1d, 0x01, 0x60, 0x50, 0x5f, 0x59, 0xad,
-		0xfe, 0x7b, 0xc6, 0x0c, 0x54, 0x90, 0x68, 0x70,
-		0x67, 0x2e, 0xed, 0x87, 0xf8, 0x69, 0x8a, 0xac,
-		0x32, 0xfe, 0x6f, 0x90, 0x19, 0x2a, 0x64, 0x8d,
-		0x82, 0x66, 0x05, 0x43, 0x88, 0xee, 0xf2, 0x30,
-		0xed, 0xa4, 0x8f, 0xbf, 0xd6, 0x57, 0x20, 0xd4,
-		0x43, 0x1d, 0x52, 0x96, 0x6f, 0xae, 0x09, 0x96,
-		0x01, 0x52, 0x38, 0xe3, 0xaf, 0x99, 0xd7, 0xdc,
-		0x14, 0x99, 0xc4, 0x8b, 0x0e, 0x04, 0x0f, 0xb3,
-		0x14, 0x14, 0xd4, 0xa5, 0x93, 0xe1, 0xc9, 0x8a,
-		0x81, 0xef, 0x63, 0xfc, 0x36, 0x77, 0x05, 0x06,
-		0xf0, 0x2a, 0x04, 0x0a, 0xbe, 0x2e, 0xce, 0x81,
-		0x3d, 0x23, 0xa1, 0xda, 0xd8, 0xeb, 0xc6, 0xea,
-		0x5e, 0xcf, 0x28, 0x36, 0x51, 0x31, 0x95, 0x5e,
-		0x40, 0x04, 0xed, 0xac, 0xc1, 0xc8, 0x56, 0x69,
-		0x87, 0xec, 0x3b, 0x03, 0x3e, 0x9d, 0x0f, 0x4c,
-		0x4c, 0xeb, 0xd7, 0xba, 0x26, 0xdf, 0xe3, 0xde,
-		0x10, 0xee, 0x93, 0x62, 0x8d, 0x73, 0x52, 0x6e,
-		0xff, 0x37, 0x36, 0x98, 0x7b, 0x2d, 0x56, 0x4c,
-		0xba, 0x09, 0xb8, 0xa7, 0xf0, 0x3b, 0x16, 0x81,
-		0xca, 0xdb, 0x43, 0xab, 0xec, 0x4c, 0x6e, 0x7c,
-		0xc1, 0x0b, 0x22, 0x22, 0x43, 0x1d, 0xb6, 0x0c,
-		0xc1, 0xb9, 0xcf, 0xe4, 0x53, 0xee, 0x1d, 0x3e,
-		0x88, 0xa7, 0x13, 0xbe, 0x7f, 0xbd, 0xae, 0x72,
-		0xcf, 0xcd, 0x63, 0xd2, 0xc3, 0x18, 0x58, 0x92,
-		0xa2, 0xad, 0xb5, 0x09, 0x9d, 0x91, 0x03, 0xdd,
-		0x3c, 0xe2, 0x1c, 0xde, 0x78, 0x00, 0x03, 0x88,
-		0x30, 0x82, 0x03, 0x84, 0x30, 0x82, 0x02, 0x6c,
-		0x02, 0x09, 0x00, 0xab, 0xed, 0xa6, 0xe4, 0x4a,
-		0x2b, 0x2b, 0xf8, 0x30, 0x0d, 0x06, 0x09, 0x2a,
-		0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x05,
-		0x05, 0x00, 0x30, 0x81, 0x86, 0x31, 0x0b, 0x30,
-		0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02,
-		0x55, 0x53, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03,
-		0x55, 0x04, 0x08, 0x0c, 0x02, 0x4e, 0x59, 0x31,
-		0x11, 0x30, 0x0f, 0x06, 0x03, 0x55, 0x04, 0x07,
-		0x0c, 0x08, 0x42, 0x72, 0x6f, 0x6f, 0x6b, 0x6c,
-		0x79, 0x6e, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x03,
-		0x55, 0x04, 0x0a, 0x0c, 0x18, 0x4d, 0x79, 0x20,
-		0x43, 0x65, 0x72, 0x74, 0x69, 0x66, 0x69, 0x63,
-		0x61, 0x74, 0x65, 0x20, 0x41, 0x75, 0x74, 0x68,
-		0x6f, 0x72, 0x69, 0x74, 0x79, 0x31, 0x11, 0x30,
-		0x0f, 0x06, 0x03, 0x55, 0x04, 0x03, 0x0c, 0x08,
-		0x6d, 0x79, 0x63, 0x61, 0x2e, 0x6f, 0x72, 0x67,
-		0x31, 0x21, 0x30, 0x1f, 0x06, 0x09, 0x2a, 0x86,
-		0x48, 0x86, 0xf7, 0x0d, 0x01, 0x09, 0x01, 0x16,
-		0x12, 0x6a, 0x76, 0x73, 0x68, 0x61, 0x68, 0x69,
-		0x64, 0x40, 0x67, 0x6d, 0x61, 0x69, 0x6c, 0x2e,
-		0x63, 0x6f, 0x6d, 0x30, 0x1e, 0x17, 0x0d, 0x31,
-		0x33, 0x30, 0x35, 0x32, 0x36, 0x32, 0x31, 0x31,
-		0x38, 0x34, 0x30, 0x5a, 0x17, 0x0d, 0x31, 0x33,
-		0x30, 0x36, 0x32, 0x35, 0x32, 0x31, 0x31, 0x38,
-		0x34, 0x30, 0x5a, 0x30, 0x81, 0x80, 0x31, 0x0b,
-		0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13,
-		0x02, 0x55, 0x53, 0x31, 0x0b, 0x30, 0x09, 0x06,
-		0x03, 0x55, 0x04, 0x08, 0x0c, 0x02, 0x4e, 0x59,
-		0x31, 0x11, 0x30, 0x0f, 0x06, 0x03, 0x55, 0x04,
-		0x07, 0x0c, 0x08, 0x42, 0x72, 0x6f, 0x6f, 0x6b,
-		0x6c, 0x79, 0x6e, 0x31, 0x15, 0x30, 0x13, 0x06,
-		0x03, 0x55, 0x04, 0x0a, 0x0c, 0x0c, 0x4d, 0x79,
-		0x20, 0x43, 0x41, 0x20, 0x43, 0x6c, 0x69, 0x65,
-		0x6e, 0x74, 0x31, 0x17, 0x30, 0x15, 0x06, 0x03,
-		0x55, 0x04, 0x03, 0x0c, 0x0e, 0x6d, 0x79, 0x63,
-		0x61, 0x63, 0x6c, 0x69, 0x65, 0x6e, 0x74, 0x2e,
-		0x63, 0x6f, 0x6d, 0x31, 0x21, 0x30, 0x1f, 0x06,
-		0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01,
-		0x09, 0x01, 0x16, 0x12, 0x6a, 0x76, 0x73, 0x68,
-		0x61, 0x68, 0x69, 0x64, 0x40, 0x67, 0x6d, 0x61,
-		0x69, 0x6c, 0x2e, 0x63, 0x6f, 0x6d, 0x30, 0x82,
-		0x01, 0x22, 0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86,
-		0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x01, 0x05,
-		0x00, 0x03, 0x82, 0x01, 0x0f, 0x00, 0x30, 0x82,
-		0x01, 0x0a, 0x02, 0x82, 0x01, 0x01, 0x00, 0xce,
-		0x13, 0xf0, 0x72, 0xb0, 0x61, 0xc8, 0x18, 0x37,
-		0x8a, 0x41, 0x3d, 0x20, 0xa1, 0x1c, 0xcb, 0xbf,
-		0xf6, 0x3b, 0x74, 0x26, 0x2a, 0x96, 0x11, 0xec,
-		0x53, 0xa1, 0xcc, 0x7d, 0x77, 0x56, 0x45, 0x0f,
-		0x36, 0xb7, 0xf2, 0x48, 0x92, 0x1a, 0x62, 0xcc,
-		0xb6, 0xc0, 0xa1, 0x2f, 0x44, 0x2b, 0xc1, 0x89,
-		0xcb, 0x6e, 0x1e, 0xdb, 0x57, 0x92, 0xd5, 0x97,
-		0x60, 0x8c, 0x41, 0x2c, 0xd9, 0x20, 0xfe, 0xe9,
-		0x1f, 0x8e, 0xfc, 0x7f, 0x02, 0x44, 0x0f, 0x28,
-		0x81, 0xd6, 0x0c, 0xcd, 0xbc, 0xf0, 0x57, 0x6c,
-		0xcc, 0xa7, 0xba, 0x06, 0xa0, 0xa6, 0x91, 0xda,
-		0xef, 0x46, 0x8a, 0x60, 0x0f, 0x52, 0x6c, 0x90,
-		0x6c, 0x8c, 0x44, 0xaf, 0xb0, 0x9d, 0x90, 0xba,
-		0x21, 0x58, 0xa0, 0x3c, 0xee, 0x54, 0xb5, 0x29,
-		0x26, 0x1f, 0x0a, 0xac, 0xef, 0x48, 0x68, 0x33,
-		0xd0, 0x33, 0xd0, 0x8b, 0x1a, 0xec, 0x6e, 0x2f,
-		0xb5, 0x4a, 0x53, 0xc2, 0x1a, 0xd2, 0xf1, 0x50,
-		0x05, 0x59, 0x5c, 0xd9, 0xda, 0x03, 0x0a, 0x47,
-		0xb7, 0xdd, 0xf7, 0x3a, 0x69, 0xf5, 0x4e, 0xea,
-		0x4a, 0xc2, 0xca, 0x54, 0xb0, 0x8b, 0x76, 0xe1,
-		0x02, 0x2d, 0x52, 0x67, 0xb9, 0xdd, 0x50, 0xc9,
-		0x3b, 0x07, 0x24, 0x22, 0x6a, 0x00, 0x1d, 0x58,
-		0x83, 0xa8, 0xec, 0x95, 0xf1, 0xda, 0xe2, 0x73,
-		0xa0, 0xa1, 0x72, 0x60, 0x9e, 0x86, 0x53, 0xcb,
-		0x45, 0xa8, 0xc2, 0xa0, 0x50, 0xa0, 0x53, 0xd6,
-		0xfc, 0x18, 0x84, 0xb5, 0x4a, 0x26, 0xd0, 0xa2,
-		0xaa, 0xd0, 0xff, 0xb6, 0xfe, 0x3a, 0x9c, 0xb5,
-		0x19, 0x3b, 0x3f, 0xe1, 0x48, 0x0d, 0xa4, 0x09,
-		0x4f, 0x83, 0xc9, 0xc0, 0xc9, 0xa6, 0x0b, 0x58,
-		0x1f, 0x1c, 0x7b, 0xac, 0xa2, 0x42, 0xbc, 0x61,
-		0xf4, 0x21, 0x8a, 0x00, 0xda, 0x14, 0xa0, 0x60,
-		0x03, 0xfe, 0x93, 0x12, 0x6c, 0x56, 0xcd, 0x02,
-		0x03, 0x01, 0x00, 0x01, 0x30, 0x0d, 0x06, 0x09,
-		0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01,
-		0x05, 0x05, 0x00, 0x03, 0x82, 0x01, 0x01, 0x00,
-		0x25, 0x29, 0x3b, 0x1e, 0xc3, 0x58, 0x32, 0xe6,
-		0x23, 0xc8, 0xee, 0x18, 0xf0, 0x1d, 0x62, 0x6d,
-		0x3b, 0x59, 0x99, 0x3a, 0xfe, 0x49, 0x72, 0x07,
-		0x3f, 0x58, 0x93, 0xdb, 0xc0, 0xaf, 0xb0, 0xb3,
-		0x5c, 0xd1, 0x5c, 0x98, 0xc8, 0xea, 0x4a, 0xe4,
-		0x58, 0x73, 0x0d, 0x57, 0xc5, 0x13, 0x7c, 0x5c,
-		0x79, 0x66, 0xda, 0x04, 0x1d, 0xe5, 0x98, 0xda,
-		0x35, 0x47, 0x44, 0xb0, 0xd2, 0x7a, 0x66, 0x9d,
-		0xcd, 0x41, 0xa5, 0x8f, 0xa1, 0x11, 0xb2, 0x1a,
-		0x87, 0xc0, 0xcd, 0x55, 0xed, 0xb4, 0x7b, 0x33,
-		0x72, 0xeb, 0xf7, 0xe3, 0x7b, 0x8b, 0x02, 0x86,
-		0xe9, 0x2b, 0x26, 0x32, 0x9f, 0x99, 0xf1, 0xcb,
-		0x93, 0xab, 0xb9, 0x16, 0xb3, 0x9a, 0xb2, 0x22,
-		0x13, 0x21, 0x1f, 0x5b, 0xcc, 0xa2, 0x59, 0xbb,
-		0x69, 0xf2, 0xb8, 0x07, 0x80, 0xce, 0x0c, 0xf7,
-		0x98, 0x4c, 0x85, 0xc2, 0x96, 0x6a, 0x22, 0x05,
-		0xe9, 0xbe, 0x48, 0xb0, 0x02, 0x5b, 0x69, 0x28,
-		0x18, 0x88, 0x96, 0xe3, 0xd7, 0xc6, 0x7a, 0xd3,
-		0xe9, 0x99, 0xff, 0x9d, 0xc3, 0x61, 0x4d, 0x9a,
-		0x96, 0xf2, 0xc6, 0x33, 0x4d, 0xe5, 0x5d, 0x5a,
-		0x68, 0x64, 0x5a, 0x82, 0x35, 0x65, 0x25, 0xe3,
-		0x8c, 0x5b, 0xb0, 0xf6, 0x96, 0x56, 0xbc, 0xbf,
-		0x97, 0x76, 0x4b, 0x66, 0x44, 0x81, 0xa4, 0xc4,
-		0xa7, 0x31, 0xc5, 0xa1, 0x4f, 0xe8, 0xa4, 0xca,
-		0x20, 0xf5, 0x01, 0x5b, 0x99, 0x4f, 0x5a, 0xf4,
-		0xf0, 0x78, 0xbf, 0x71, 0x49, 0xd5, 0xf1, 0xc1,
-		0xa2, 0x18, 0xfd, 0x72, 0x5b, 0x16, 0xe8, 0x92,
-		0xc7, 0x37, 0x48, 0xaf, 0xee, 0x24, 0xfc, 0x35,
-		0x0b, 0xc2, 0xdd, 0x05, 0xc7, 0x6e, 0xa3, 0x29,
-		0xbb, 0x29, 0x7d, 0xd3, 0x2b, 0x94, 0x80, 0xc3,
-		0x40, 0x53, 0x0e, 0x03, 0x54, 0x3d, 0x7b, 0x8b,
-		0xce, 0xf9, 0xa4, 0x03, 0x27, 0x63, 0xec, 0x51,
-		0x00, 0x03, 0xe5, 0x30, 0x82, 0x03, 0xe1, 0x30,
-		0x82, 0x02, 0xc9, 0xa0, 0x03, 0x02, 0x01, 0x02,
-		0x02, 0x09, 0x00, 0xcc, 0x22, 0x4c, 0x4b, 0x98,
-		0xa2, 0x88, 0xfc, 0x30, 0x0d, 0x06, 0x09, 0x2a,
-		0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x05,
-		0x05, 0x00, 0x30, 0x81, 0x86, 0x31, 0x0b, 0x30,
-		0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02,
-		0x55, 0x53, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03,
-		0x55, 0x04, 0x08, 0x0c, 0x02, 0x4e, 0x59, 0x31,
-		0x11, 0x30, 0x0f, 0x06, 0x03, 0x55, 0x04, 0x07,
-		0x0c, 0x08, 0x42, 0x72, 0x6f, 0x6f, 0x6b, 0x6c,
-		0x79, 0x6e, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x03,
-		0x55, 0x04, 0x0a, 0x0c, 0x18, 0x4d, 0x79, 0x20,
-		0x43, 0x65, 0x72, 0x74, 0x69, 0x66, 0x69, 0x63,
-		0x61, 0x74, 0x65, 0x20, 0x41, 0x75, 0x74, 0x68,
-		0x6f, 0x72, 0x69, 0x74, 0x79, 0x31, 0x11, 0x30,
-		0x0f, 0x06, 0x03, 0x55, 0x04, 0x03, 0x0c, 0x08,
-		0x6d, 0x79, 0x63, 0x61, 0x2e, 0x6f, 0x72, 0x67,
-		0x31, 0x21, 0x30, 0x1f, 0x06, 0x09, 0x2a, 0x86,
-		0x48, 0x86, 0xf7, 0x0d, 0x01, 0x09, 0x01, 0x16,
-		0x12, 0x6a, 0x76, 0x73, 0x68, 0x61, 0x68, 0x69,
-		0x64, 0x40, 0x67, 0x6d, 0x61, 0x69, 0x6c, 0x2e,
-		0x63, 0x6f, 0x6d, 0x30, 0x1e, 0x17, 0x0d, 0x31,
-		0x33, 0x30, 0x35, 0x32, 0x36, 0x32, 0x31, 0x30,
-		0x35, 0x30, 0x31, 0x5a, 0x17, 0x0d, 0x32, 0x33,
-		0x30, 0x35, 0x32, 0x34, 0x32, 0x31, 0x30, 0x35,
-		0x30, 0x31, 0x5a, 0x30, 0x81, 0x86, 0x31, 0x0b,
-		0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13,
-		0x02, 0x55, 0x53, 0x31, 0x0b, 0x30, 0x09, 0x06,
-		0x03, 0x55, 0x04, 0x08, 0x0c, 0x02, 0x4e, 0x59,
-		0x31, 0x11, 0x30, 0x0f, 0x06, 0x03, 0x55, 0x04,
-		0x07, 0x0c, 0x08, 0x42, 0x72, 0x6f, 0x6f, 0x6b,
-		0x6c, 0x79, 0x6e, 0x31, 0x21, 0x30, 0x1f, 0x06,
-		0x03, 0x55, 0x04, 0x0a, 0x0c, 0x18, 0x4d, 0x79,
-		0x20, 0x43, 0x65, 0x72, 0x74, 0x69, 0x66, 0x69,
-		0x63, 0x61, 0x74, 0x65, 0x20, 0x41, 0x75, 0x74,
-		0x68, 0x6f, 0x72, 0x69, 0x74, 0x79, 0x31, 0x11,
-		0x30, 0x0f, 0x06, 0x03, 0x55, 0x04, 0x03, 0x0c,
-		0x08, 0x6d, 0x79, 0x63, 0x61, 0x2e, 0x6f, 0x72,
-		0x67, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x09, 0x2a,
-		0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x09, 0x01,
-		0x16, 0x12, 0x6a, 0x76, 0x73, 0x68, 0x61, 0x68,
-		0x69, 0x64, 0x40, 0x67, 0x6d, 0x61, 0x69, 0x6c,
-		0x2e, 0x63, 0x6f, 0x6d, 0x30, 0x82, 0x01, 0x22,
-		0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86,
-		0xf7, 0x0d, 0x01, 0x01, 0x01, 0x05, 0x00, 0x03,
-		0x82, 0x01, 0x0f, 0x00, 0x30, 0x82, 0x01, 0x0a,
-		0x02, 0x82, 0x01, 0x01, 0x00, 0xf0, 0xfb, 0xad,
-		0x80, 0x5e, 0x37, 0xd3, 0x6d, 0xee, 0x2e, 0xcc,
-		0xbc, 0x0c, 0xd7, 0x56, 0x4b, 0x56, 0x45, 0xcd,
-		0x28, 0xb6, 0x22, 0xe9, 0xe2, 0x0f, 0xd1, 0x87,
-		0x2a, 0x27, 0xce, 0x77, 0x8d, 0x6e, 0x0e, 0x0f,
-		0xfb, 0x66, 0xe1, 0xb5, 0x0e, 0x9a, 0xb6, 0x05,
-		0x8e, 0xb3, 0xe1, 0xc5, 0x77, 0x86, 0x5b, 0x46,
-		0xd2, 0x0b, 0x92, 0x03, 0x1b, 0x89, 0x0c, 0x1b,
-		0x10, 0x0e, 0x99, 0x8f, 0xe2, 0x17, 0xe8, 0xc2,
-		0x30, 0x00, 0x47, 0xd6, 0xfc, 0xf9, 0x0f, 0x3b,
-		0x75, 0x34, 0x8d, 0x4d, 0xb0, 0x99, 0xb7, 0xa0,
-		0x6d, 0xa0, 0xb6, 0xad, 0xda, 0x07, 0x5e, 0x38,
-		0x2e, 0x02, 0xe4, 0x30, 0x6d, 0xae, 0x13, 0x72,
-		0xd4, 0xc8, 0xce, 0x14, 0x07, 0xae, 0x23, 0x8c,
-		0x8f, 0x9e, 0x8c, 0x60, 0xd6, 0x06, 0xb9, 0xef,
-		0x00, 0x18, 0xc0, 0x1d, 0x25, 0x1e, 0xda, 0x3e,
-		0x2f, 0xcf, 0x2b, 0x56, 0x84, 0x9e, 0x30, 0x21,
-		0xc7, 0x29, 0xf6, 0x03, 0x8a, 0x24, 0xf9, 0x34,
-		0xac, 0x65, 0x9d, 0x80, 0x36, 0xc8, 0x3b, 0x15,
-		0x10, 0xbd, 0x51, 0xe9, 0xbc, 0x02, 0xe1, 0xe9,
-		0xb3, 0x5a, 0x9a, 0x99, 0x41, 0x1b, 0x27, 0xa0,
-		0x4d, 0x50, 0x9e, 0x27, 0x7f, 0xa1, 0x7d, 0x09,
-		0x87, 0xbd, 0x8a, 0xca, 0x5f, 0xb1, 0xa5, 0x08,
-		0xb8, 0x04, 0xd4, 0x52, 0x89, 0xaa, 0xe0, 0x7d,
-		0x42, 0x2e, 0x2f, 0x15, 0xee, 0x66, 0x57, 0x0f,
-		0x13, 0x19, 0x45, 0xa8, 0x4b, 0x5d, 0x81, 0x66,
-		0xcc, 0x12, 0x37, 0x94, 0x5e, 0xfd, 0x3c, 0x10,
-		0x81, 0x51, 0x3f, 0xfa, 0x0f, 0xdd, 0xa1, 0x89,
-		0x03, 0xa9, 0x78, 0x91, 0xf5, 0x3b, 0xf3, 0xbc,
-		0xac, 0xbe, 0x93, 0x30, 0x2e, 0xbe, 0xca, 0x7f,
-		0x46, 0xd3, 0x28, 0xb4, 0x4e, 0x91, 0x7b, 0x5b,
-		0x43, 0x6c, 0xaf, 0x9b, 0x5c, 0x6a, 0x6d, 0x5a,
-		0xdb, 0x79, 0x5e, 0x6a, 0x6b, 0x02, 0x03, 0x01,
-		0x00, 0x01, 0xa3, 0x50, 0x30, 0x4e, 0x30, 0x1d,
-		0x06, 0x03, 0x55, 0x1d, 0x0e, 0x04, 0x16, 0x04,
-		0x14, 0x6b, 0x1e, 0x00, 0xa8, 0x9f, 0xfa, 0x7d,
-		0x00, 0xf9, 0xe0, 0x9d, 0x0f, 0x90, 0x8c, 0x90,
-		0xa8, 0xa1, 0x37, 0x6b, 0xda, 0x30, 0x1f, 0x06,
-		0x03, 0x55, 0x1d, 0x23, 0x04, 0x18, 0x30, 0x16,
-		0x80, 0x14, 0x6b, 0x1e, 0x00, 0xa8, 0x9f, 0xfa,
-		0x7d, 0x00, 0xf9, 0xe0, 0x9d, 0x0f, 0x90, 0x8c,
-		0x90, 0xa8, 0xa1, 0x37, 0x6b, 0xda, 0x30, 0x0c,
-		0x06, 0x03, 0x55, 0x1d, 0x13, 0x04, 0x05, 0x30,
-		0x03, 0x01, 0x01, 0xff, 0x30, 0x0d, 0x06, 0x09,
-		0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01,
-		0x05, 0x05, 0x00, 0x03, 0x82, 0x01, 0x01, 0x00,
-		0xcd, 0x6f, 0x73, 0x4d, 0x56, 0x0b, 0xf3, 0x2e,
-		0x1c, 0xe2, 0x02, 0x0c, 0x14, 0xbb, 0x2f, 0xdd,
-		0x3c, 0x43, 0xfe, 0xdf, 0x94, 0x2d, 0xa9, 0x89,
-		0x81, 0x51, 0xf8, 0x5f, 0xa7, 0xa0, 0x13, 0xaa,
-		0xcc, 0xb0, 0x18, 0xe2, 0x57, 0x3e, 0x0d, 0x29,
-		0x93, 0xe8, 0x95, 0xd5, 0x1b, 0x53, 0xd2, 0x51,
-		0xf2, 0xbd, 0xf5, 0x9e, 0x7b, 0x22, 0x65, 0x62,
-		0x5c, 0xc4, 0x4c, 0x1d, 0xe8, 0xe9, 0xc3, 0xd4,
-		0x2b, 0xe7, 0x78, 0xcb, 0x10, 0xf3, 0xfe, 0x06,
-		0x83, 0xdc, 0x3a, 0x1e, 0x62, 0x10, 0xc0, 0x46,
-		0x77, 0xc6, 0x9d, 0x9f, 0xab, 0x96, 0x25, 0x5c,
-		0xfb, 0x26, 0xc1, 0x15, 0x1f, 0xa5, 0x33, 0xee,
-		0x4f, 0x9a, 0x14, 0x6a, 0x14, 0x97, 0x93, 0x2b,
-		0x95, 0x0b, 0xdc, 0xa8, 0xd7, 0x69, 0x2e, 0xf0,
-		0x01, 0x0e, 0xfd, 0x4e, 0xd0, 0xd9, 0xa8, 0xe5,
-		0x65, 0xde, 0xfb, 0xca, 0xca, 0x1c, 0x5f, 0xf9,
-		0x53, 0xa0, 0x87, 0xe7, 0x33, 0x9b, 0x2f, 0xcf,
-		0xe4, 0x13, 0xfc, 0xec, 0x7a, 0x6c, 0xb0, 0x90,
-		0x13, 0x9b, 0xb6, 0xc5, 0x03, 0xf6, 0x0e, 0x5e,
-		0xe2, 0xe4, 0x26, 0xc1, 0x7e, 0x53, 0xfe, 0x69,
-		0xa3, 0xc7, 0xd8, 0x8e, 0x6e, 0x94, 0x32, 0xa0,
-		0xde, 0xca, 0xb6, 0xcc, 0xd6, 0x01, 0xd5, 0x78,
-		0x40, 0x28, 0x63, 0x9b, 0xee, 0xcf, 0x09, 0x3b,
-		0x35, 0x04, 0xf0, 0x14, 0x02, 0xf6, 0x80, 0x0e,
-		0x90, 0xb2, 0x94, 0xd2, 0x25, 0x16, 0xb8, 0x7a,
-		0x76, 0x87, 0x84, 0x9f, 0x84, 0xc5, 0xaf, 0xc2,
-		0x6d, 0x68, 0x7a, 0x84, 0x9c, 0xc6, 0x8a, 0x63,
-		0x60, 0x87, 0x6a, 0x25, 0xc1, 0xa1, 0x78, 0x0f,
-		0xba, 0xe8, 0x5f, 0xe1, 0xba, 0xac, 0xa4, 0x6f,
-		0xdd, 0x09, 0x3f, 0x12, 0xcb, 0x1d, 0xf3, 0xcf,
-		0x48, 0xd7, 0xd3, 0x26, 0xe8, 0x9c, 0xc3, 0x53,
-		0xb3, 0xba, 0xdc, 0x32, 0x99, 0x98, 0x96, 0xd6,
-		0x16, 0x03, 0x01, 0x01, 0x06, 0x10, 0x00, 0x01,
-		0x02, 0x01, 0x00, 0x6e, 0xea, 0x15, 0x6f, 0x21,
-		0xbd, 0x2d, 0x14, 0xde, 0x9d, 0x02, 0xeb, 0xdf,
-		0x3b, 0x09, 0x75, 0xaf, 0x32, 0x80, 0x0c, 0xe2,
-		0xc2, 0x7b, 0x0d, 0xca, 0x24, 0x96, 0xf6, 0x3e,
-		0xa5, 0x97, 0xba, 0x0c, 0x50, 0x7e, 0xb3, 0x68,
-		0x58, 0xc6, 0xd8, 0xec, 0xab, 0xa9, 0xd9, 0x3a,
-		0xb1, 0x49, 0xea, 0x2f, 0xd7, 0xdb, 0x15, 0x1b,
-		0xb5, 0xaf, 0xec, 0xcc, 0x40, 0x5c, 0xe6, 0x0f,
-		0xc4, 0x33, 0x71, 0xe7, 0x41, 0xc0, 0x04, 0x89,
-		0x60, 0x3e, 0xb7, 0xe6, 0xda, 0x38, 0x62, 0x27,
-		0x6a, 0xd9, 0xfb, 0x93, 0x94, 0x9d, 0xc1, 0x63,
-		0x92, 0x5c, 0x88, 0x19, 0x38, 0x81, 0x79, 0x9d,
-		0x59, 0x48, 0x5e, 0xd3, 0xc8, 0xea, 0xcb, 0x6e,
-		0x66, 0x66, 0x03, 0xdc, 0x0c, 0x2d, 0x95, 0xb1,
-		0x4d, 0x68, 0xc7, 0xc5, 0x6e, 0xfa, 0x94, 0x14,
-		0xdf, 0x2c, 0x70, 0x69, 0x04, 0xf4, 0x69, 0xf1,
-		0xf0, 0x07, 0xbd, 0x23, 0x53, 0x63, 0xb3, 0x41,
-		0xec, 0xa7, 0x10, 0xa5, 0x04, 0x84, 0x24, 0xb5,
-		0xf5, 0x0c, 0x0f, 0x5d, 0x02, 0x47, 0x79, 0x60,
-		0x76, 0xbb, 0xdf, 0x60, 0xa6, 0xd7, 0x4d, 0x08,
-		0x7d, 0xa6, 0x85, 0x4f, 0x61, 0xac, 0x96, 0x3d,
-		0xbc, 0xaf, 0x07, 0xb0, 0x7c, 0xb6, 0x23, 0x3e,
-		0x1f, 0x0a, 0x62, 0x77, 0x97, 0x77, 0xae, 0x33,
-		0x55, 0x0f, 0x85, 0xdf, 0xdc, 0xbe, 0xc6, 0xe0,
-		0xe0, 0x14, 0x83, 0x4c, 0x50, 0xf0, 0xe5, 0x2d,
-		0xdc, 0x0b, 0x74, 0x7f, 0xc3, 0x28, 0x98, 0x16,
-		0xda, 0x74, 0xe6, 0x40, 0xc2, 0xf0, 0xea, 0xc0,
-		0x00, 0xd5, 0xfc, 0x16, 0xe4, 0x43, 0xa1, 0xfc,
-		0x31, 0x19, 0x81, 0x62, 0xec, 0x2b, 0xfe, 0xcc,
-		0xe8, 0x19, 0xed, 0xa1, 0x1e, 0x6a, 0x49, 0x73,
-		0xde, 0xc4, 0xe9, 0x22, 0x0a, 0x21, 0xde, 0x45,
-		0x1e, 0x55, 0x12, 0xd9, 0x44, 0xef, 0x4e, 0xaa,
-		0x5e, 0x26, 0x57, 0x16, 0x03, 0x01, 0x01, 0x06,
-		0x0f, 0x00, 0x01, 0x02, 0x01, 0x00, 0x23, 0xde,
-		0xb0, 0x39, 0x60, 0xe9, 0x82, 0xb8, 0xed, 0x17,
-		0x78, 0xd2, 0x37, 0x0e, 0x85, 0x69, 0xda, 0xcc,
-		0x9f, 0x54, 0x4d, 0xda, 0xce, 0xe8, 0x5a, 0xeb,
-		0x3c, 0x61, 0x4c, 0x7a, 0x84, 0x1f, 0x21, 0x03,
-		0xb3, 0x8a, 0x74, 0x3b, 0x6a, 0x9e, 0x4f, 0x44,
-		0xd9, 0x75, 0x0a, 0xd8, 0x7e, 0x56, 0xa3, 0xef,
-		0x5a, 0xfe, 0x8a, 0x35, 0xce, 0x29, 0x18, 0xfe,
-		0xa6, 0x61, 0x8e, 0x8f, 0x00, 0x90, 0x2d, 0x85,
-		0xe3, 0x6c, 0x0e, 0x8d, 0x8c, 0x27, 0x80, 0x8c,
-		0x9f, 0x51, 0xe9, 0xd3, 0xe6, 0x7d, 0x70, 0xe9,
-		0xfb, 0xcb, 0xb8, 0x24, 0x94, 0x30, 0x9b, 0xba,
-		0x01, 0x14, 0x49, 0x9f, 0xaf, 0x09, 0xd8, 0x26,
-		0x1b, 0x23, 0xa4, 0xb8, 0xd9, 0x44, 0x0a, 0xdc,
-		0x4e, 0x27, 0xe7, 0x32, 0xf5, 0x9c, 0xf3, 0x8d,
-		0xa0, 0xc5, 0xc4, 0xbe, 0x92, 0x02, 0x85, 0x4f,
-		0x33, 0x8f, 0xa7, 0xf7, 0x87, 0xa9, 0x44, 0xf3,
-		0x64, 0xbd, 0x32, 0x04, 0xeb, 0xc5, 0xc3, 0x62,
-		0xe9, 0xda, 0x2f, 0x95, 0x5c, 0xf7, 0x58, 0x3e,
-		0xad, 0x35, 0xd7, 0x7e, 0xad, 0xdd, 0x32, 0x8d,
-		0xce, 0x81, 0x08, 0xad, 0x49, 0xf7, 0xdb, 0xf7,
-		0xaf, 0xe3, 0xc6, 0xb2, 0xdd, 0x76, 0x0c, 0xcf,
-		0x0f, 0x87, 0x79, 0x90, 0x10, 0x79, 0xc6, 0xc8,
-		0x7b, 0xe6, 0x23, 0xf2, 0xda, 0x33, 0xca, 0xe1,
-		0xf0, 0x59, 0x42, 0x43, 0x03, 0x56, 0x19, 0xe3,
-		0x8b, 0xe6, 0xa8, 0x70, 0xbc, 0x80, 0xfa, 0x24,
-		0xae, 0x03, 0x13, 0x30, 0x0d, 0x1f, 0xab, 0xb7,
-		0x82, 0xd9, 0x24, 0x90, 0x80, 0xbf, 0x75, 0xe1,
-		0x0d, 0x1c, 0xb2, 0xfe, 0x92, 0x2c, 0x4d, 0x21,
-		0xe9, 0x5d, 0xa1, 0x68, 0xf3, 0x16, 0xd8, 0x3f,
-		0xb2, 0xc3, 0x00, 0x3e, 0xd8, 0x42, 0x25, 0x5c,
-		0x90, 0x11, 0xc0, 0x1b, 0xd4, 0x26, 0x5c, 0x37,
-		0x47, 0xbd, 0xf8, 0x1e, 0x34, 0xa9, 0x14, 0x03,
-		0x01, 0x00, 0x01, 0x01, 0x16, 0x03, 0x01, 0x00,
-		0x24, 0x8f, 0x94, 0x7e, 0x01, 0xee, 0xd5, 0x4f,
-		0x83, 0x41, 0x31, 0xc0, 0x36, 0x81, 0x46, 0xc3,
-		0xc0, 0xcc, 0x9c, 0xea, 0x0f, 0x29, 0x04, 0x10,
-		0x43, 0x1e, 0x08, 0x6e, 0x08, 0xce, 0xb2, 0x62,
-		0xa6, 0x0f, 0x68, 0x9f, 0x99,
-	},
-	{
-		0x14, 0x03, 0x01, 0x00, 0x01, 0x01, 0x16, 0x03,
-		0x01, 0x00, 0x24, 0xd9, 0x46, 0x5b, 0xbf, 0xfd,
-		0x8a, 0xa1, 0x08, 0xd5, 0xf3, 0x0c, 0x1c, 0xd8,
-		0xa8, 0xb3, 0xe5, 0x89, 0x83, 0x9e, 0x23, 0x47,
-		0x81, 0x66, 0x77, 0x11, 0x98, 0xe5, 0xf4, 0xac,
-		0x06, 0xe9, 0x4c, 0x05, 0x8b, 0xc4, 0x16,
-	},
-	{
-		0x17, 0x03, 0x01, 0x00, 0x1a, 0xc5, 0x28, 0xfd,
-		0x71, 0xc0, 0xe6, 0x89, 0xb8, 0x82, 0x92, 0x1b,
-		0xdd, 0x39, 0xe5, 0xbf, 0x41, 0x82, 0x1f, 0xc1,
-		0xbc, 0x85, 0xe5, 0x32, 0x1b, 0x93, 0x46, 0x15,
-		0x03, 0x01, 0x00, 0x16, 0x1a, 0x8b, 0x10, 0x42,
-		0x12, 0xb2, 0xbd, 0xd3, 0xf1, 0x74, 0x1f, 0xc2,
-		0x10, 0x08, 0xc2, 0x79, 0x99, 0x2c, 0x55, 0xef,
-		0x4a, 0xbd,
-	},
+func TestHandshakeClientECDHEECDSAAES(t *testing.T) {
+	test := &clientTest{
+		name:    "ECDHE-ECDSA-AES",
+		command: []string{"openssl", "s_server", "-cipher", "ECDHE-ECDSA-AES128-SHA"},
+		cert:    testECDSACertificate,
+		key:     testECDSAPrivateKey,
+	}
+	runClientTestTLS10(t, test)
+	runClientTestTLS11(t, test)
+	runClientTestTLS12(t, test)
 }
 
-// $ openssl s_server -tls1_2 -cert server.crt -key server.key \
-//     -cipher ECDHE-RSA-AES128-SHA -port 10443
-// $ go test -test.run "TestRunClient" -connect -ciphersuites=0xc013 \
-//     -minversion=0x0303 -maxversion=0x0303
-var clientTLS12Script = [][]byte{
-	{
-		0x16, 0x03, 0x01, 0x00, 0x58, 0x01, 0x00, 0x00,
-		0x54, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0xc0, 0x13,
-		0x01, 0x00, 0x00, 0x29, 0x00, 0x05, 0x00, 0x05,
-		0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0a, 0x00,
-		0x08, 0x00, 0x06, 0x00, 0x17, 0x00, 0x18, 0x00,
-		0x19, 0x00, 0x0b, 0x00, 0x02, 0x01, 0x00, 0x00,
-		0x0d, 0x00, 0x0a, 0x00, 0x08, 0x04, 0x01, 0x04,
-		0x03, 0x02, 0x01, 0x02, 0x03,
-	},
-	{
-		0x16, 0x03, 0x03, 0x00, 0x54, 0x02, 0x00, 0x00,
-		0x50, 0x03, 0x03, 0x52, 0x65, 0x67, 0xbd, 0xe8,
-		0x72, 0x03, 0x6a, 0x52, 0x8d, 0x28, 0x2c, 0x9a,
-		0x53, 0xff, 0xc2, 0xa1, 0x62, 0x5f, 0x54, 0xfb,
-		0x73, 0x00, 0xcf, 0x4d, 0x28, 0x36, 0xc2, 0xee,
-		0xfd, 0x78, 0xf0, 0x20, 0x6f, 0xbe, 0x49, 0xec,
-		0x5b, 0x6f, 0xf9, 0x53, 0x42, 0x69, 0x0d, 0x6d,
-		0x8b, 0x68, 0x2e, 0xca, 0x3c, 0x3c, 0x88, 0x9e,
-		0x8b, 0xf9, 0x32, 0x65, 0x09, 0xd6, 0xa0, 0x7d,
-		0xea, 0xc6, 0xd5, 0xc4, 0xc0, 0x13, 0x00, 0x00,
-		0x08, 0x00, 0x0b, 0x00, 0x04, 0x03, 0x00, 0x01,
-		0x02, 0x16, 0x03, 0x03, 0x02, 0x39, 0x0b, 0x00,
-		0x02, 0x35, 0x00, 0x02, 0x32, 0x00, 0x02, 0x2f,
-		0x30, 0x82, 0x02, 0x2b, 0x30, 0x82, 0x01, 0xd5,
-		0xa0, 0x03, 0x02, 0x01, 0x02, 0x02, 0x09, 0x00,
-		0xb1, 0x35, 0x13, 0x65, 0x11, 0x20, 0xc5, 0x92,
-		0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86,
-		0xf7, 0x0d, 0x01, 0x01, 0x05, 0x05, 0x00, 0x30,
-		0x45, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55,
-		0x04, 0x06, 0x13, 0x02, 0x41, 0x55, 0x31, 0x13,
-		0x30, 0x11, 0x06, 0x03, 0x55, 0x04, 0x08, 0x13,
-		0x0a, 0x53, 0x6f, 0x6d, 0x65, 0x2d, 0x53, 0x74,
-		0x61, 0x74, 0x65, 0x31, 0x21, 0x30, 0x1f, 0x06,
-		0x03, 0x55, 0x04, 0x0a, 0x13, 0x18, 0x49, 0x6e,
-		0x74, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x57,
-		0x69, 0x64, 0x67, 0x69, 0x74, 0x73, 0x20, 0x50,
-		0x74, 0x79, 0x20, 0x4c, 0x74, 0x64, 0x30, 0x1e,
-		0x17, 0x0d, 0x31, 0x32, 0x30, 0x34, 0x30, 0x36,
-		0x31, 0x37, 0x31, 0x30, 0x31, 0x33, 0x5a, 0x17,
-		0x0d, 0x31, 0x35, 0x30, 0x34, 0x30, 0x36, 0x31,
-		0x37, 0x31, 0x30, 0x31, 0x33, 0x5a, 0x30, 0x45,
-		0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04,
-		0x06, 0x13, 0x02, 0x41, 0x55, 0x31, 0x13, 0x30,
-		0x11, 0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0a,
-		0x53, 0x6f, 0x6d, 0x65, 0x2d, 0x53, 0x74, 0x61,
-		0x74, 0x65, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x03,
-		0x55, 0x04, 0x0a, 0x13, 0x18, 0x49, 0x6e, 0x74,
-		0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x57, 0x69,
-		0x64, 0x67, 0x69, 0x74, 0x73, 0x20, 0x50, 0x74,
-		0x79, 0x20, 0x4c, 0x74, 0x64, 0x30, 0x5c, 0x30,
-		0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7,
-		0x0d, 0x01, 0x01, 0x01, 0x05, 0x00, 0x03, 0x4b,
-		0x00, 0x30, 0x48, 0x02, 0x41, 0x00, 0x9f, 0xb3,
-		0xc3, 0x84, 0x27, 0x95, 0xff, 0x12, 0x31, 0x52,
-		0x0f, 0x15, 0xef, 0x46, 0x11, 0xc4, 0xad, 0x80,
-		0xe6, 0x36, 0x5b, 0x0f, 0xdd, 0x80, 0xd7, 0x61,
-		0x8d, 0xe0, 0xfc, 0x72, 0x45, 0x09, 0x34, 0xfe,
-		0x55, 0x66, 0x45, 0x43, 0x4c, 0x68, 0x97, 0x6a,
-		0xfe, 0xa8, 0xa0, 0xa5, 0xdf, 0x5f, 0x78, 0xff,
-		0xee, 0xd7, 0x64, 0xb8, 0x3f, 0x04, 0xcb, 0x6f,
-		0xff, 0x2a, 0xfe, 0xfe, 0xb9, 0xed, 0x02, 0x03,
-		0x01, 0x00, 0x01, 0xa3, 0x81, 0xa7, 0x30, 0x81,
-		0xa4, 0x30, 0x1d, 0x06, 0x03, 0x55, 0x1d, 0x0e,
-		0x04, 0x16, 0x04, 0x14, 0x78, 0xa6, 0x97, 0x9a,
-		0x63, 0xb5, 0xc5, 0xa1, 0xa5, 0x33, 0xba, 0x22,
-		0x7c, 0x23, 0x6e, 0x5b, 0x1b, 0x7a, 0xcc, 0x2b,
-		0x30, 0x75, 0x06, 0x03, 0x55, 0x1d, 0x23, 0x04,
-		0x6e, 0x30, 0x6c, 0x80, 0x14, 0x78, 0xa6, 0x97,
-		0x9a, 0x63, 0xb5, 0xc5, 0xa1, 0xa5, 0x33, 0xba,
-		0x22, 0x7c, 0x23, 0x6e, 0x5b, 0x1b, 0x7a, 0xcc,
-		0x2b, 0xa1, 0x49, 0xa4, 0x47, 0x30, 0x45, 0x31,
-		0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06,
-		0x13, 0x02, 0x41, 0x55, 0x31, 0x13, 0x30, 0x11,
-		0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0a, 0x53,
-		0x6f, 0x6d, 0x65, 0x2d, 0x53, 0x74, 0x61, 0x74,
-		0x65, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x03, 0x55,
-		0x04, 0x0a, 0x13, 0x18, 0x49, 0x6e, 0x74, 0x65,
-		0x72, 0x6e, 0x65, 0x74, 0x20, 0x57, 0x69, 0x64,
-		0x67, 0x69, 0x74, 0x73, 0x20, 0x50, 0x74, 0x79,
-		0x20, 0x4c, 0x74, 0x64, 0x82, 0x09, 0x00, 0xb1,
-		0x35, 0x13, 0x65, 0x11, 0x20, 0xc5, 0x92, 0x30,
-		0x0c, 0x06, 0x03, 0x55, 0x1d, 0x13, 0x04, 0x05,
-		0x30, 0x03, 0x01, 0x01, 0xff, 0x30, 0x0d, 0x06,
-		0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01,
-		0x01, 0x05, 0x05, 0x00, 0x03, 0x41, 0x00, 0x85,
-		0x36, 0x40, 0x73, 0xc1, 0xbb, 0x1a, 0xda, 0xd4,
-		0x59, 0x9f, 0x2d, 0xa2, 0x70, 0x31, 0x46, 0x74,
-		0xec, 0x83, 0x6e, 0xa8, 0xc8, 0x3c, 0x51, 0xaf,
-		0x39, 0xac, 0xec, 0x40, 0xbc, 0xe8, 0x22, 0x46,
-		0x1d, 0x99, 0xd6, 0x46, 0x2a, 0x24, 0xd4, 0x8b,
-		0x05, 0x08, 0x4b, 0xfb, 0x35, 0x11, 0x6e, 0x92,
-		0xbb, 0x77, 0xba, 0xe4, 0x12, 0xbb, 0xf4, 0xc8,
-		0x5e, 0x9c, 0x81, 0xa8, 0x97, 0x60, 0x4c, 0x16,
-		0x03, 0x03, 0x00, 0x8d, 0x0c, 0x00, 0x00, 0x89,
-		0x03, 0x00, 0x17, 0x41, 0x04, 0x48, 0x93, 0x62,
-		0x6a, 0xf8, 0x7c, 0x94, 0xcc, 0xcc, 0x0a, 0x9b,
-		0x5e, 0x11, 0xad, 0x0b, 0x30, 0xc4, 0x5d, 0xf7,
-		0x63, 0x24, 0xc1, 0xb0, 0x40, 0x5f, 0xff, 0x9f,
-		0x0d, 0x7e, 0xd5, 0xa5, 0xd0, 0x4f, 0x80, 0x16,
-		0xa8, 0x66, 0x18, 0x31, 0x1f, 0x81, 0xb2, 0x9a,
-		0x41, 0x62, 0x5b, 0xcf, 0x73, 0xac, 0x4a, 0x64,
-		0xb5, 0xc1, 0x46, 0x4d, 0x8a, 0xac, 0x25, 0xba,
-		0x81, 0x7f, 0xbe, 0x64, 0x68, 0x04, 0x01, 0x00,
-		0x40, 0x4e, 0x3f, 0x1e, 0x04, 0x4c, 0xef, 0xd2,
-		0xa6, 0x82, 0xe6, 0x7c, 0x76, 0x23, 0x17, 0xb9,
-		0xe7, 0x52, 0x15, 0x6b, 0x3d, 0xb2, 0xb1, 0x17,
-		0x7d, 0xe6, 0xde, 0x06, 0x87, 0x30, 0xb0, 0xb5,
-		0x57, 0xae, 0xdf, 0xb2, 0xdc, 0x8d, 0xab, 0x76,
-		0x9c, 0xaa, 0x45, 0x6d, 0x23, 0x5d, 0xc1, 0xa8,
-		0x7b, 0x79, 0x79, 0xb1, 0x3c, 0xdc, 0xf5, 0x33,
-		0x2c, 0xa1, 0x62, 0x3e, 0xbd, 0xf5, 0x5d, 0x6c,
-		0x87, 0x16, 0x03, 0x03, 0x00, 0x04, 0x0e, 0x00,
-		0x00, 0x00,
-	},
-	{
-		0x16, 0x03, 0x03, 0x00, 0x46, 0x10, 0x00, 0x00,
-		0x42, 0x41, 0x04, 0x1e, 0x18, 0x37, 0xef, 0x0d,
-		0x19, 0x51, 0x88, 0x35, 0x75, 0x71, 0xb5, 0xe5,
-		0x54, 0x5b, 0x12, 0x2e, 0x8f, 0x09, 0x67, 0xfd,
-		0xa7, 0x24, 0x20, 0x3e, 0xb2, 0x56, 0x1c, 0xce,
-		0x97, 0x28, 0x5e, 0xf8, 0x2b, 0x2d, 0x4f, 0x9e,
-		0xf1, 0x07, 0x9f, 0x6c, 0x4b, 0x5b, 0x83, 0x56,
-		0xe2, 0x32, 0x42, 0xe9, 0x58, 0xb6, 0xd7, 0x49,
-		0xa6, 0xb5, 0x68, 0x1a, 0x41, 0x03, 0x56, 0x6b,
-		0xdc, 0x5a, 0x89, 0x14, 0x03, 0x03, 0x00, 0x01,
-		0x01, 0x16, 0x03, 0x03, 0x00, 0x40, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0xee, 0x17,
-		0x54, 0x51, 0xb6, 0x1d, 0x8e, 0xe4, 0x6b, 0xed,
-		0x5b, 0xa1, 0x27, 0x7f, 0xdc, 0xa9, 0xa5, 0xcf,
-		0x38, 0xe6, 0x5d, 0x17, 0x34, 0xf9, 0xc0, 0x07,
-		0xb8, 0xbe, 0x56, 0xe6, 0xd6, 0x6a, 0xb6, 0x26,
-		0x4e, 0x45, 0x8d, 0x48, 0xe9, 0xc6, 0xb1, 0xa1,
-		0xea, 0xdc, 0xb1, 0x37, 0xd9, 0xf6,
-	},
-	{
-		0x14, 0x03, 0x03, 0x00, 0x01, 0x01, 0x16, 0x03,
-		0x03, 0x00, 0x40, 0x00, 0x68, 0xc5, 0x27, 0xd5,
-		0x3d, 0xba, 0x04, 0xde, 0x63, 0xf1, 0x5b, 0xc3,
-		0x86, 0xb9, 0x82, 0xc7, 0xb3, 0x90, 0x31, 0xea,
-		0x15, 0xe1, 0x42, 0x76, 0x7d, 0x90, 0xcb, 0xc9,
-		0xd1, 0x05, 0xe6, 0x8c, 0x76, 0xc7, 0x9a, 0x35,
-		0x67, 0xa2, 0x70, 0x9a, 0x8a, 0x6c, 0xb5, 0x6b,
-		0xc7, 0x87, 0xf3, 0x65, 0x0a, 0xa0, 0x98, 0xba,
-		0x57, 0xbb, 0x31, 0x7b, 0x1f, 0x1a, 0xf7, 0x2a,
-		0xf3, 0x12, 0xf6,
-	},
-	{
-		0x17, 0x03, 0x03, 0x00, 0x30, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x14, 0x10, 0x80,
-		0x54, 0x1e, 0x72, 0xd3, 0x1a, 0x86, 0x1c, 0xc4,
-		0x4a, 0x9b, 0xd4, 0x80, 0xd2, 0x03, 0x35, 0x0d,
-		0xe4, 0x12, 0xc2, 0x3d, 0x79, 0x4a, 0x2c, 0xba,
-		0xc2, 0xad, 0xf3, 0xd2, 0x16, 0x15, 0x03, 0x03,
-		0x00, 0x30, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x04, 0x9b, 0x68, 0x78, 0x92, 0x28,
-		0x62, 0x02, 0x65, 0x87, 0x90, 0xe4, 0x32, 0xd7,
-		0x72, 0x08, 0x70, 0xb8, 0x52, 0x32, 0x1f, 0x97,
-		0xd4, 0x6a, 0xc6, 0x28, 0x83, 0xb0, 0x1d, 0x6e,
-		0x16, 0xd5,
-	},
+func TestHandshakeClientECDHEECDSAAESGCM(t *testing.T) {
+	test := &clientTest{
+		name:    "ECDHE-ECDSA-AES-GCM",
+		command: []string{"openssl", "s_server", "-cipher", "ECDHE-ECDSA-AES128-GCM-SHA256"},
+		cert:    testECDSACertificate,
+		key:     testECDSAPrivateKey,
+	}
+	runClientTestTLS12(t, test)
 }
 
-// $ openssl s_server -tls1_2 -cert server.crt -key server.key \
-//     -port 10443 -verify 0
-// $ go test -test.run "TestRunClient" -connect -ciphersuites=0xc02f \
-//     -maxversion=0x0303
-var clientTLS12ClientCertScript = [][]byte{
-	{
-		0x16, 0x03, 0x01, 0x00, 0x58, 0x01, 0x00, 0x00,
-		0x54, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0xc0, 0x2f,
-		0x01, 0x00, 0x00, 0x29, 0x00, 0x05, 0x00, 0x05,
-		0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0a, 0x00,
-		0x08, 0x00, 0x06, 0x00, 0x17, 0x00, 0x18, 0x00,
-		0x19, 0x00, 0x0b, 0x00, 0x02, 0x01, 0x00, 0x00,
-		0x0d, 0x00, 0x0a, 0x00, 0x08, 0x04, 0x01, 0x04,
-		0x03, 0x02, 0x01, 0x02, 0x03,
-	},
-	{
-		0x16, 0x03, 0x03, 0x00, 0x54, 0x02, 0x00, 0x00,
-		0x50, 0x03, 0x03, 0x52, 0x65, 0x67, 0xe0, 0xe8,
-		0xf1, 0x13, 0x2a, 0x83, 0x28, 0xa8, 0x2e, 0x76,
-		0x69, 0xe6, 0x89, 0x55, 0x6c, 0x48, 0x49, 0x2e,
-		0x00, 0xf6, 0x87, 0x6c, 0x13, 0xa1, 0xd4, 0xaa,
-		0xd0, 0x76, 0x3b, 0x20, 0xe4, 0xd6, 0x5b, 0x1d,
-		0x11, 0xf2, 0x42, 0xf2, 0x82, 0x0c, 0x0d, 0x66,
-		0x6d, 0xec, 0x52, 0xf8, 0x4a, 0xd9, 0x45, 0xcf,
-		0xe4, 0x4a, 0xba, 0x8b, 0xf1, 0xab, 0x55, 0xe4,
-		0x57, 0x18, 0xa9, 0x36, 0xc0, 0x2f, 0x00, 0x00,
-		0x08, 0x00, 0x0b, 0x00, 0x04, 0x03, 0x00, 0x01,
-		0x02, 0x16, 0x03, 0x03, 0x02, 0x39, 0x0b, 0x00,
-		0x02, 0x35, 0x00, 0x02, 0x32, 0x00, 0x02, 0x2f,
-		0x30, 0x82, 0x02, 0x2b, 0x30, 0x82, 0x01, 0xd5,
-		0xa0, 0x03, 0x02, 0x01, 0x02, 0x02, 0x09, 0x00,
-		0xb1, 0x35, 0x13, 0x65, 0x11, 0x20, 0xc5, 0x92,
-		0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86,
-		0xf7, 0x0d, 0x01, 0x01, 0x05, 0x05, 0x00, 0x30,
-		0x45, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55,
-		0x04, 0x06, 0x13, 0x02, 0x41, 0x55, 0x31, 0x13,
-		0x30, 0x11, 0x06, 0x03, 0x55, 0x04, 0x08, 0x13,
-		0x0a, 0x53, 0x6f, 0x6d, 0x65, 0x2d, 0x53, 0x74,
-		0x61, 0x74, 0x65, 0x31, 0x21, 0x30, 0x1f, 0x06,
-		0x03, 0x55, 0x04, 0x0a, 0x13, 0x18, 0x49, 0x6e,
-		0x74, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x57,
-		0x69, 0x64, 0x67, 0x69, 0x74, 0x73, 0x20, 0x50,
-		0x74, 0x79, 0x20, 0x4c, 0x74, 0x64, 0x30, 0x1e,
-		0x17, 0x0d, 0x31, 0x32, 0x30, 0x34, 0x30, 0x36,
-		0x31, 0x37, 0x31, 0x30, 0x31, 0x33, 0x5a, 0x17,
-		0x0d, 0x31, 0x35, 0x30, 0x34, 0x30, 0x36, 0x31,
-		0x37, 0x31, 0x30, 0x31, 0x33, 0x5a, 0x30, 0x45,
-		0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04,
-		0x06, 0x13, 0x02, 0x41, 0x55, 0x31, 0x13, 0x30,
-		0x11, 0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0a,
-		0x53, 0x6f, 0x6d, 0x65, 0x2d, 0x53, 0x74, 0x61,
-		0x74, 0x65, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x03,
-		0x55, 0x04, 0x0a, 0x13, 0x18, 0x49, 0x6e, 0x74,
-		0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x57, 0x69,
-		0x64, 0x67, 0x69, 0x74, 0x73, 0x20, 0x50, 0x74,
-		0x79, 0x20, 0x4c, 0x74, 0x64, 0x30, 0x5c, 0x30,
-		0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7,
-		0x0d, 0x01, 0x01, 0x01, 0x05, 0x00, 0x03, 0x4b,
-		0x00, 0x30, 0x48, 0x02, 0x41, 0x00, 0x9f, 0xb3,
-		0xc3, 0x84, 0x27, 0x95, 0xff, 0x12, 0x31, 0x52,
-		0x0f, 0x15, 0xef, 0x46, 0x11, 0xc4, 0xad, 0x80,
-		0xe6, 0x36, 0x5b, 0x0f, 0xdd, 0x80, 0xd7, 0x61,
-		0x8d, 0xe0, 0xfc, 0x72, 0x45, 0x09, 0x34, 0xfe,
-		0x55, 0x66, 0x45, 0x43, 0x4c, 0x68, 0x97, 0x6a,
-		0xfe, 0xa8, 0xa0, 0xa5, 0xdf, 0x5f, 0x78, 0xff,
-		0xee, 0xd7, 0x64, 0xb8, 0x3f, 0x04, 0xcb, 0x6f,
-		0xff, 0x2a, 0xfe, 0xfe, 0xb9, 0xed, 0x02, 0x03,
-		0x01, 0x00, 0x01, 0xa3, 0x81, 0xa7, 0x30, 0x81,
-		0xa4, 0x30, 0x1d, 0x06, 0x03, 0x55, 0x1d, 0x0e,
-		0x04, 0x16, 0x04, 0x14, 0x78, 0xa6, 0x97, 0x9a,
-		0x63, 0xb5, 0xc5, 0xa1, 0xa5, 0x33, 0xba, 0x22,
-		0x7c, 0x23, 0x6e, 0x5b, 0x1b, 0x7a, 0xcc, 0x2b,
-		0x30, 0x75, 0x06, 0x03, 0x55, 0x1d, 0x23, 0x04,
-		0x6e, 0x30, 0x6c, 0x80, 0x14, 0x78, 0xa6, 0x97,
-		0x9a, 0x63, 0xb5, 0xc5, 0xa1, 0xa5, 0x33, 0xba,
-		0x22, 0x7c, 0x23, 0x6e, 0x5b, 0x1b, 0x7a, 0xcc,
-		0x2b, 0xa1, 0x49, 0xa4, 0x47, 0x30, 0x45, 0x31,
-		0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06,
-		0x13, 0x02, 0x41, 0x55, 0x31, 0x13, 0x30, 0x11,
-		0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0a, 0x53,
-		0x6f, 0x6d, 0x65, 0x2d, 0x53, 0x74, 0x61, 0x74,
-		0x65, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x03, 0x55,
-		0x04, 0x0a, 0x13, 0x18, 0x49, 0x6e, 0x74, 0x65,
-		0x72, 0x6e, 0x65, 0x74, 0x20, 0x57, 0x69, 0x64,
-		0x67, 0x69, 0x74, 0x73, 0x20, 0x50, 0x74, 0x79,
-		0x20, 0x4c, 0x74, 0x64, 0x82, 0x09, 0x00, 0xb1,
-		0x35, 0x13, 0x65, 0x11, 0x20, 0xc5, 0x92, 0x30,
-		0x0c, 0x06, 0x03, 0x55, 0x1d, 0x13, 0x04, 0x05,
-		0x30, 0x03, 0x01, 0x01, 0xff, 0x30, 0x0d, 0x06,
-		0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01,
-		0x01, 0x05, 0x05, 0x00, 0x03, 0x41, 0x00, 0x85,
-		0x36, 0x40, 0x73, 0xc1, 0xbb, 0x1a, 0xda, 0xd4,
-		0x59, 0x9f, 0x2d, 0xa2, 0x70, 0x31, 0x46, 0x74,
-		0xec, 0x83, 0x6e, 0xa8, 0xc8, 0x3c, 0x51, 0xaf,
-		0x39, 0xac, 0xec, 0x40, 0xbc, 0xe8, 0x22, 0x46,
-		0x1d, 0x99, 0xd6, 0x46, 0x2a, 0x24, 0xd4, 0x8b,
-		0x05, 0x08, 0x4b, 0xfb, 0x35, 0x11, 0x6e, 0x92,
-		0xbb, 0x77, 0xba, 0xe4, 0x12, 0xbb, 0xf4, 0xc8,
-		0x5e, 0x9c, 0x81, 0xa8, 0x97, 0x60, 0x4c, 0x16,
-		0x03, 0x03, 0x00, 0x8d, 0x0c, 0x00, 0x00, 0x89,
-		0x03, 0x00, 0x17, 0x41, 0x04, 0xaa, 0xf0, 0x0c,
-		0xa3, 0x60, 0xcf, 0x69, 0x1e, 0xad, 0x16, 0x9a,
-		0x01, 0x40, 0xc6, 0x22, 0xc4, 0xbb, 0x06, 0x3b,
-		0x84, 0x65, 0xea, 0xc7, 0xa2, 0x96, 0x79, 0x17,
-		0x2f, 0xc7, 0xbe, 0x56, 0x39, 0xe4, 0x79, 0xf3,
-		0xad, 0x17, 0xf3, 0x7e, 0xe2, 0x7b, 0xa2, 0x6f,
-		0x3f, 0x96, 0xea, 0xe5, 0x0e, 0xea, 0x39, 0x79,
-		0x77, 0xeb, 0x14, 0x18, 0xbb, 0x7c, 0x95, 0xda,
-		0xa7, 0x51, 0x09, 0xba, 0xd7, 0x04, 0x01, 0x00,
-		0x40, 0x82, 0x3e, 0xce, 0xee, 0x7e, 0xba, 0x3b,
-		0x51, 0xb1, 0xba, 0x71, 0x2e, 0x54, 0xa9, 0xb9,
-		0xe2, 0xb1, 0x59, 0x17, 0xa1, 0xac, 0x76, 0xb4,
-		0x4e, 0xf1, 0xae, 0x65, 0x17, 0x2b, 0x43, 0x06,
-		0x31, 0x29, 0x0b, 0xa0, 0x1e, 0xb6, 0xfa, 0x35,
-		0xe8, 0x63, 0x06, 0xde, 0x13, 0x89, 0x83, 0x69,
-		0x3b, 0xc2, 0x15, 0x73, 0x1c, 0xc5, 0x07, 0xe9,
-		0x38, 0x9b, 0x06, 0x81, 0x1b, 0x97, 0x7c, 0xa6,
-		0x89, 0x16, 0x03, 0x03, 0x00, 0x30, 0x0d, 0x00,
-		0x00, 0x28, 0x03, 0x01, 0x02, 0x40, 0x00, 0x20,
-		0x06, 0x01, 0x06, 0x02, 0x06, 0x03, 0x05, 0x01,
-		0x05, 0x02, 0x05, 0x03, 0x04, 0x01, 0x04, 0x02,
-		0x04, 0x03, 0x03, 0x01, 0x03, 0x02, 0x03, 0x03,
-		0x02, 0x01, 0x02, 0x02, 0x02, 0x03, 0x01, 0x01,
-		0x00, 0x00, 0x0e, 0x00, 0x00, 0x00,
-	},
-	{
-		0x16, 0x03, 0x03, 0x0a, 0xfb, 0x0b, 0x00, 0x0a,
-		0xf7, 0x00, 0x0a, 0xf4, 0x00, 0x03, 0x7e, 0x30,
-		0x82, 0x03, 0x7a, 0x30, 0x82, 0x02, 0x62, 0x02,
-		0x09, 0x00, 0xb4, 0x47, 0x58, 0x57, 0x2b, 0x67,
-		0xc8, 0xc2, 0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86,
-		0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x05, 0x05,
-		0x00, 0x30, 0x81, 0x80, 0x31, 0x0b, 0x30, 0x09,
-		0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x55,
-		0x53, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55,
-		0x04, 0x08, 0x0c, 0x02, 0x4e, 0x59, 0x31, 0x11,
-		0x30, 0x0f, 0x06, 0x03, 0x55, 0x04, 0x07, 0x0c,
-		0x08, 0x42, 0x72, 0x6f, 0x6f, 0x6b, 0x6c, 0x79,
-		0x6e, 0x31, 0x15, 0x30, 0x13, 0x06, 0x03, 0x55,
-		0x04, 0x0a, 0x0c, 0x0c, 0x4d, 0x79, 0x20, 0x43,
-		0x41, 0x20, 0x43, 0x6c, 0x69, 0x65, 0x6e, 0x74,
-		0x31, 0x17, 0x30, 0x15, 0x06, 0x03, 0x55, 0x04,
-		0x03, 0x0c, 0x0e, 0x6d, 0x79, 0x63, 0x61, 0x63,
-		0x6c, 0x69, 0x65, 0x6e, 0x74, 0x2e, 0x63, 0x6f,
-		0x6d, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x09, 0x2a,
-		0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x09, 0x01,
-		0x16, 0x12, 0x6a, 0x76, 0x73, 0x68, 0x61, 0x68,
-		0x69, 0x64, 0x40, 0x67, 0x6d, 0x61, 0x69, 0x6c,
-		0x2e, 0x63, 0x6f, 0x6d, 0x30, 0x1e, 0x17, 0x0d,
-		0x31, 0x33, 0x30, 0x35, 0x32, 0x36, 0x32, 0x31,
-		0x34, 0x34, 0x30, 0x30, 0x5a, 0x17, 0x0d, 0x31,
-		0x33, 0x30, 0x36, 0x32, 0x35, 0x32, 0x31, 0x34,
-		0x34, 0x30, 0x30, 0x5a, 0x30, 0x7d, 0x31, 0x0b,
-		0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13,
-		0x02, 0x55, 0x53, 0x31, 0x11, 0x30, 0x0f, 0x06,
-		0x03, 0x55, 0x04, 0x08, 0x0c, 0x08, 0x4e, 0x65,
-		0x77, 0x20, 0x59, 0x6f, 0x72, 0x6b, 0x31, 0x11,
-		0x30, 0x0f, 0x06, 0x03, 0x55, 0x04, 0x07, 0x0c,
-		0x08, 0x42, 0x72, 0x6f, 0x6f, 0x6b, 0x6c, 0x79,
-		0x6e, 0x31, 0x10, 0x30, 0x0e, 0x06, 0x03, 0x55,
-		0x04, 0x0a, 0x0c, 0x07, 0x4d, 0x79, 0x20, 0x4c,
-		0x65, 0x61, 0x66, 0x31, 0x13, 0x30, 0x11, 0x06,
-		0x03, 0x55, 0x04, 0x03, 0x0c, 0x0a, 0x6d, 0x79,
-		0x6c, 0x65, 0x61, 0x66, 0x2e, 0x63, 0x6f, 0x6d,
-		0x31, 0x21, 0x30, 0x1f, 0x06, 0x09, 0x2a, 0x86,
-		0x48, 0x86, 0xf7, 0x0d, 0x01, 0x09, 0x01, 0x16,
-		0x12, 0x6a, 0x76, 0x73, 0x68, 0x61, 0x68, 0x69,
-		0x64, 0x40, 0x67, 0x6d, 0x61, 0x69, 0x6c, 0x2e,
-		0x63, 0x6f, 0x6d, 0x30, 0x82, 0x01, 0x22, 0x30,
-		0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7,
-		0x0d, 0x01, 0x01, 0x01, 0x05, 0x00, 0x03, 0x82,
-		0x01, 0x0f, 0x00, 0x30, 0x82, 0x01, 0x0a, 0x02,
-		0x82, 0x01, 0x01, 0x00, 0xa0, 0xa3, 0xef, 0xc1,
-		0x44, 0x7d, 0xa2, 0xe3, 0x71, 0x98, 0x27, 0x63,
-		0xb3, 0x1d, 0x71, 0x50, 0xa6, 0x34, 0x15, 0xcb,
-		0xc9, 0x2a, 0xc3, 0xea, 0xe4, 0x9e, 0x9c, 0x49,
-		0xa6, 0x01, 0x9b, 0x7e, 0xa9, 0xb5, 0x7a, 0xff,
-		0x15, 0x92, 0x71, 0xc8, 0x97, 0x9c, 0x25, 0xb7,
-		0x79, 0x2b, 0xff, 0xab, 0xc6, 0xb1, 0xa7, 0x00,
-		0x90, 0xb2, 0x8b, 0xd7, 0x71, 0xd5, 0xc2, 0x3a,
-		0xe6, 0x82, 0x42, 0x37, 0x89, 0x41, 0x04, 0xb0,
-		0xba, 0xc7, 0x5b, 0x8a, 0x43, 0x9f, 0x97, 0x39,
-		0x0c, 0x0f, 0xd5, 0x6d, 0x9e, 0x8d, 0xeb, 0xc0,
-		0x26, 0xc5, 0x18, 0xe8, 0x7a, 0x3d, 0x32, 0x2e,
-		0x38, 0x90, 0x40, 0x5b, 0x39, 0x2c, 0x07, 0xcb,
-		0x24, 0x10, 0xc5, 0xc9, 0x3b, 0xe3, 0x66, 0x47,
-		0x57, 0xb9, 0x6a, 0xad, 0x44, 0xf8, 0xd0, 0x70,
-		0x62, 0x3b, 0x8e, 0xed, 0x60, 0x5f, 0x22, 0xf8,
-		0xb8, 0x0c, 0xc9, 0x41, 0x2b, 0xc9, 0x80, 0x6e,
-		0x4e, 0x1b, 0xe1, 0x20, 0xfc, 0x47, 0xa4, 0xac,
-		0xc3, 0x3f, 0xe6, 0xc2, 0x81, 0x79, 0x03, 0x37,
-		0x25, 0x89, 0xca, 0xd6, 0xa5, 0x46, 0x91, 0x63,
-		0x41, 0xc5, 0x3e, 0xd5, 0xed, 0x7f, 0x4f, 0x8d,
-		0x06, 0xc0, 0x89, 0x00, 0xbe, 0x37, 0x7b, 0x7e,
-		0x73, 0xca, 0x70, 0x00, 0x14, 0x34, 0xbe, 0x47,
-		0xbc, 0xb2, 0x6a, 0x28, 0xa5, 0x29, 0x84, 0xa8,
-		0x9d, 0xc8, 0x1e, 0x77, 0x66, 0x1f, 0x9f, 0xaa,
-		0x2b, 0x47, 0xdb, 0xdd, 0x6b, 0x9c, 0xa8, 0xfc,
-		0x82, 0x36, 0x94, 0x62, 0x0d, 0x5c, 0x3f, 0xb2,
-		0x01, 0xb4, 0xa5, 0xb8, 0xc6, 0x0e, 0x94, 0x5b,
-		0xec, 0x5e, 0xbb, 0x7a, 0x63, 0x24, 0xf1, 0xf9,
-		0xd6, 0x50, 0x08, 0xc1, 0xa3, 0xcc, 0x90, 0x07,
-		0x5b, 0x04, 0x04, 0x42, 0x74, 0xcf, 0x37, 0xfa,
-		0xf0, 0xa5, 0xd9, 0xd3, 0x86, 0x89, 0x89, 0x18,
-		0xf3, 0x4c, 0xe2, 0x11, 0x02, 0x03, 0x01, 0x00,
-		0x01, 0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48,
-		0x86, 0xf7, 0x0d, 0x01, 0x01, 0x05, 0x05, 0x00,
-		0x03, 0x82, 0x01, 0x01, 0x00, 0x90, 0xbb, 0xf9,
-		0x5e, 0xba, 0x17, 0x1f, 0xac, 0x21, 0x9f, 0x6b,
-		0x4a, 0x46, 0xd0, 0x6d, 0x3c, 0x8f, 0x3d, 0xf8,
-		0x5e, 0x3e, 0x72, 0xaf, 0xa0, 0x1a, 0xf3, 0xff,
-		0x89, 0xac, 0x5b, 0x7a, 0xe2, 0x91, 0x2a, 0x23,
-		0x85, 0xc6, 0x4d, 0x47, 0x67, 0x01, 0x08, 0xa8,
-		0x05, 0x1d, 0x01, 0x60, 0x50, 0x5f, 0x59, 0xad,
-		0xfe, 0x7b, 0xc6, 0x0c, 0x54, 0x90, 0x68, 0x70,
-		0x67, 0x2e, 0xed, 0x87, 0xf8, 0x69, 0x8a, 0xac,
-		0x32, 0xfe, 0x6f, 0x90, 0x19, 0x2a, 0x64, 0x8d,
-		0x82, 0x66, 0x05, 0x43, 0x88, 0xee, 0xf2, 0x30,
-		0xed, 0xa4, 0x8f, 0xbf, 0xd6, 0x57, 0x20, 0xd4,
-		0x43, 0x1d, 0x52, 0x96, 0x6f, 0xae, 0x09, 0x96,
-		0x01, 0x52, 0x38, 0xe3, 0xaf, 0x99, 0xd7, 0xdc,
-		0x14, 0x99, 0xc4, 0x8b, 0x0e, 0x04, 0x0f, 0xb3,
-		0x14, 0x14, 0xd4, 0xa5, 0x93, 0xe1, 0xc9, 0x8a,
-		0x81, 0xef, 0x63, 0xfc, 0x36, 0x77, 0x05, 0x06,
-		0xf0, 0x2a, 0x04, 0x0a, 0xbe, 0x2e, 0xce, 0x81,
-		0x3d, 0x23, 0xa1, 0xda, 0xd8, 0xeb, 0xc6, 0xea,
-		0x5e, 0xcf, 0x28, 0x36, 0x51, 0x31, 0x95, 0x5e,
-		0x40, 0x04, 0xed, 0xac, 0xc1, 0xc8, 0x56, 0x69,
-		0x87, 0xec, 0x3b, 0x03, 0x3e, 0x9d, 0x0f, 0x4c,
-		0x4c, 0xeb, 0xd7, 0xba, 0x26, 0xdf, 0xe3, 0xde,
-		0x10, 0xee, 0x93, 0x62, 0x8d, 0x73, 0x52, 0x6e,
-		0xff, 0x37, 0x36, 0x98, 0x7b, 0x2d, 0x56, 0x4c,
-		0xba, 0x09, 0xb8, 0xa7, 0xf0, 0x3b, 0x16, 0x81,
-		0xca, 0xdb, 0x43, 0xab, 0xec, 0x4c, 0x6e, 0x7c,
-		0xc1, 0x0b, 0x22, 0x22, 0x43, 0x1d, 0xb6, 0x0c,
-		0xc1, 0xb9, 0xcf, 0xe4, 0x53, 0xee, 0x1d, 0x3e,
-		0x88, 0xa7, 0x13, 0xbe, 0x7f, 0xbd, 0xae, 0x72,
-		0xcf, 0xcd, 0x63, 0xd2, 0xc3, 0x18, 0x58, 0x92,
-		0xa2, 0xad, 0xb5, 0x09, 0x9d, 0x91, 0x03, 0xdd,
-		0x3c, 0xe2, 0x1c, 0xde, 0x78, 0x00, 0x03, 0x88,
-		0x30, 0x82, 0x03, 0x84, 0x30, 0x82, 0x02, 0x6c,
-		0x02, 0x09, 0x00, 0xab, 0xed, 0xa6, 0xe4, 0x4a,
-		0x2b, 0x2b, 0xf8, 0x30, 0x0d, 0x06, 0x09, 0x2a,
-		0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x05,
-		0x05, 0x00, 0x30, 0x81, 0x86, 0x31, 0x0b, 0x30,
-		0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02,
-		0x55, 0x53, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03,
-		0x55, 0x04, 0x08, 0x0c, 0x02, 0x4e, 0x59, 0x31,
-		0x11, 0x30, 0x0f, 0x06, 0x03, 0x55, 0x04, 0x07,
-		0x0c, 0x08, 0x42, 0x72, 0x6f, 0x6f, 0x6b, 0x6c,
-		0x79, 0x6e, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x03,
-		0x55, 0x04, 0x0a, 0x0c, 0x18, 0x4d, 0x79, 0x20,
-		0x43, 0x65, 0x72, 0x74, 0x69, 0x66, 0x69, 0x63,
-		0x61, 0x74, 0x65, 0x20, 0x41, 0x75, 0x74, 0x68,
-		0x6f, 0x72, 0x69, 0x74, 0x79, 0x31, 0x11, 0x30,
-		0x0f, 0x06, 0x03, 0x55, 0x04, 0x03, 0x0c, 0x08,
-		0x6d, 0x79, 0x63, 0x61, 0x2e, 0x6f, 0x72, 0x67,
-		0x31, 0x21, 0x30, 0x1f, 0x06, 0x09, 0x2a, 0x86,
-		0x48, 0x86, 0xf7, 0x0d, 0x01, 0x09, 0x01, 0x16,
-		0x12, 0x6a, 0x76, 0x73, 0x68, 0x61, 0x68, 0x69,
-		0x64, 0x40, 0x67, 0x6d, 0x61, 0x69, 0x6c, 0x2e,
-		0x63, 0x6f, 0x6d, 0x30, 0x1e, 0x17, 0x0d, 0x31,
-		0x33, 0x30, 0x35, 0x32, 0x36, 0x32, 0x31, 0x31,
-		0x38, 0x34, 0x30, 0x5a, 0x17, 0x0d, 0x31, 0x33,
-		0x30, 0x36, 0x32, 0x35, 0x32, 0x31, 0x31, 0x38,
-		0x34, 0x30, 0x5a, 0x30, 0x81, 0x80, 0x31, 0x0b,
-		0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13,
-		0x02, 0x55, 0x53, 0x31, 0x0b, 0x30, 0x09, 0x06,
-		0x03, 0x55, 0x04, 0x08, 0x0c, 0x02, 0x4e, 0x59,
-		0x31, 0x11, 0x30, 0x0f, 0x06, 0x03, 0x55, 0x04,
-		0x07, 0x0c, 0x08, 0x42, 0x72, 0x6f, 0x6f, 0x6b,
-		0x6c, 0x79, 0x6e, 0x31, 0x15, 0x30, 0x13, 0x06,
-		0x03, 0x55, 0x04, 0x0a, 0x0c, 0x0c, 0x4d, 0x79,
-		0x20, 0x43, 0x41, 0x20, 0x43, 0x6c, 0x69, 0x65,
-		0x6e, 0x74, 0x31, 0x17, 0x30, 0x15, 0x06, 0x03,
-		0x55, 0x04, 0x03, 0x0c, 0x0e, 0x6d, 0x79, 0x63,
-		0x61, 0x63, 0x6c, 0x69, 0x65, 0x6e, 0x74, 0x2e,
-		0x63, 0x6f, 0x6d, 0x31, 0x21, 0x30, 0x1f, 0x06,
-		0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01,
-		0x09, 0x01, 0x16, 0x12, 0x6a, 0x76, 0x73, 0x68,
-		0x61, 0x68, 0x69, 0x64, 0x40, 0x67, 0x6d, 0x61,
-		0x69, 0x6c, 0x2e, 0x63, 0x6f, 0x6d, 0x30, 0x82,
-		0x01, 0x22, 0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86,
-		0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x01, 0x05,
-		0x00, 0x03, 0x82, 0x01, 0x0f, 0x00, 0x30, 0x82,
-		0x01, 0x0a, 0x02, 0x82, 0x01, 0x01, 0x00, 0xce,
-		0x13, 0xf0, 0x72, 0xb0, 0x61, 0xc8, 0x18, 0x37,
-		0x8a, 0x41, 0x3d, 0x20, 0xa1, 0x1c, 0xcb, 0xbf,
-		0xf6, 0x3b, 0x74, 0x26, 0x2a, 0x96, 0x11, 0xec,
-		0x53, 0xa1, 0xcc, 0x7d, 0x77, 0x56, 0x45, 0x0f,
-		0x36, 0xb7, 0xf2, 0x48, 0x92, 0x1a, 0x62, 0xcc,
-		0xb6, 0xc0, 0xa1, 0x2f, 0x44, 0x2b, 0xc1, 0x89,
-		0xcb, 0x6e, 0x1e, 0xdb, 0x57, 0x92, 0xd5, 0x97,
-		0x60, 0x8c, 0x41, 0x2c, 0xd9, 0x20, 0xfe, 0xe9,
-		0x1f, 0x8e, 0xfc, 0x7f, 0x02, 0x44, 0x0f, 0x28,
-		0x81, 0xd6, 0x0c, 0xcd, 0xbc, 0xf0, 0x57, 0x6c,
-		0xcc, 0xa7, 0xba, 0x06, 0xa0, 0xa6, 0x91, 0xda,
-		0xef, 0x46, 0x8a, 0x60, 0x0f, 0x52, 0x6c, 0x90,
-		0x6c, 0x8c, 0x44, 0xaf, 0xb0, 0x9d, 0x90, 0xba,
-		0x21, 0x58, 0xa0, 0x3c, 0xee, 0x54, 0xb5, 0x29,
-		0x26, 0x1f, 0x0a, 0xac, 0xef, 0x48, 0x68, 0x33,
-		0xd0, 0x33, 0xd0, 0x8b, 0x1a, 0xec, 0x6e, 0x2f,
-		0xb5, 0x4a, 0x53, 0xc2, 0x1a, 0xd2, 0xf1, 0x50,
-		0x05, 0x59, 0x5c, 0xd9, 0xda, 0x03, 0x0a, 0x47,
-		0xb7, 0xdd, 0xf7, 0x3a, 0x69, 0xf5, 0x4e, 0xea,
-		0x4a, 0xc2, 0xca, 0x54, 0xb0, 0x8b, 0x76, 0xe1,
-		0x02, 0x2d, 0x52, 0x67, 0xb9, 0xdd, 0x50, 0xc9,
-		0x3b, 0x07, 0x24, 0x22, 0x6a, 0x00, 0x1d, 0x58,
-		0x83, 0xa8, 0xec, 0x95, 0xf1, 0xda, 0xe2, 0x73,
-		0xa0, 0xa1, 0x72, 0x60, 0x9e, 0x86, 0x53, 0xcb,
-		0x45, 0xa8, 0xc2, 0xa0, 0x50, 0xa0, 0x53, 0xd6,
-		0xfc, 0x18, 0x84, 0xb5, 0x4a, 0x26, 0xd0, 0xa2,
-		0xaa, 0xd0, 0xff, 0xb6, 0xfe, 0x3a, 0x9c, 0xb5,
-		0x19, 0x3b, 0x3f, 0xe1, 0x48, 0x0d, 0xa4, 0x09,
-		0x4f, 0x83, 0xc9, 0xc0, 0xc9, 0xa6, 0x0b, 0x58,
-		0x1f, 0x1c, 0x7b, 0xac, 0xa2, 0x42, 0xbc, 0x61,
-		0xf4, 0x21, 0x8a, 0x00, 0xda, 0x14, 0xa0, 0x60,
-		0x03, 0xfe, 0x93, 0x12, 0x6c, 0x56, 0xcd, 0x02,
-		0x03, 0x01, 0x00, 0x01, 0x30, 0x0d, 0x06, 0x09,
-		0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01,
-		0x05, 0x05, 0x00, 0x03, 0x82, 0x01, 0x01, 0x00,
-		0x25, 0x29, 0x3b, 0x1e, 0xc3, 0x58, 0x32, 0xe6,
-		0x23, 0xc8, 0xee, 0x18, 0xf0, 0x1d, 0x62, 0x6d,
-		0x3b, 0x59, 0x99, 0x3a, 0xfe, 0x49, 0x72, 0x07,
-		0x3f, 0x58, 0x93, 0xdb, 0xc0, 0xaf, 0xb0, 0xb3,
-		0x5c, 0xd1, 0x5c, 0x98, 0xc8, 0xea, 0x4a, 0xe4,
-		0x58, 0x73, 0x0d, 0x57, 0xc5, 0x13, 0x7c, 0x5c,
-		0x79, 0x66, 0xda, 0x04, 0x1d, 0xe5, 0x98, 0xda,
-		0x35, 0x47, 0x44, 0xb0, 0xd2, 0x7a, 0x66, 0x9d,
-		0xcd, 0x41, 0xa5, 0x8f, 0xa1, 0x11, 0xb2, 0x1a,
-		0x87, 0xc0, 0xcd, 0x55, 0xed, 0xb4, 0x7b, 0x33,
-		0x72, 0xeb, 0xf7, 0xe3, 0x7b, 0x8b, 0x02, 0x86,
-		0xe9, 0x2b, 0x26, 0x32, 0x9f, 0x99, 0xf1, 0xcb,
-		0x93, 0xab, 0xb9, 0x16, 0xb3, 0x9a, 0xb2, 0x22,
-		0x13, 0x21, 0x1f, 0x5b, 0xcc, 0xa2, 0x59, 0xbb,
-		0x69, 0xf2, 0xb8, 0x07, 0x80, 0xce, 0x0c, 0xf7,
-		0x98, 0x4c, 0x85, 0xc2, 0x96, 0x6a, 0x22, 0x05,
-		0xe9, 0xbe, 0x48, 0xb0, 0x02, 0x5b, 0x69, 0x28,
-		0x18, 0x88, 0x96, 0xe3, 0xd7, 0xc6, 0x7a, 0xd3,
-		0xe9, 0x99, 0xff, 0x9d, 0xc3, 0x61, 0x4d, 0x9a,
-		0x96, 0xf2, 0xc6, 0x33, 0x4d, 0xe5, 0x5d, 0x5a,
-		0x68, 0x64, 0x5a, 0x82, 0x35, 0x65, 0x25, 0xe3,
-		0x8c, 0x5b, 0xb0, 0xf6, 0x96, 0x56, 0xbc, 0xbf,
-		0x97, 0x76, 0x4b, 0x66, 0x44, 0x81, 0xa4, 0xc4,
-		0xa7, 0x31, 0xc5, 0xa1, 0x4f, 0xe8, 0xa4, 0xca,
-		0x20, 0xf5, 0x01, 0x5b, 0x99, 0x4f, 0x5a, 0xf4,
-		0xf0, 0x78, 0xbf, 0x71, 0x49, 0xd5, 0xf1, 0xc1,
-		0xa2, 0x18, 0xfd, 0x72, 0x5b, 0x16, 0xe8, 0x92,
-		0xc7, 0x37, 0x48, 0xaf, 0xee, 0x24, 0xfc, 0x35,
-		0x0b, 0xc2, 0xdd, 0x05, 0xc7, 0x6e, 0xa3, 0x29,
-		0xbb, 0x29, 0x7d, 0xd3, 0x2b, 0x94, 0x80, 0xc3,
-		0x40, 0x53, 0x0e, 0x03, 0x54, 0x3d, 0x7b, 0x8b,
-		0xce, 0xf9, 0xa4, 0x03, 0x27, 0x63, 0xec, 0x51,
-		0x00, 0x03, 0xe5, 0x30, 0x82, 0x03, 0xe1, 0x30,
-		0x82, 0x02, 0xc9, 0xa0, 0x03, 0x02, 0x01, 0x02,
-		0x02, 0x09, 0x00, 0xcc, 0x22, 0x4c, 0x4b, 0x98,
-		0xa2, 0x88, 0xfc, 0x30, 0x0d, 0x06, 0x09, 0x2a,
-		0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x05,
-		0x05, 0x00, 0x30, 0x81, 0x86, 0x31, 0x0b, 0x30,
-		0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02,
-		0x55, 0x53, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03,
-		0x55, 0x04, 0x08, 0x0c, 0x02, 0x4e, 0x59, 0x31,
-		0x11, 0x30, 0x0f, 0x06, 0x03, 0x55, 0x04, 0x07,
-		0x0c, 0x08, 0x42, 0x72, 0x6f, 0x6f, 0x6b, 0x6c,
-		0x79, 0x6e, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x03,
-		0x55, 0x04, 0x0a, 0x0c, 0x18, 0x4d, 0x79, 0x20,
-		0x43, 0x65, 0x72, 0x74, 0x69, 0x66, 0x69, 0x63,
-		0x61, 0x74, 0x65, 0x20, 0x41, 0x75, 0x74, 0x68,
-		0x6f, 0x72, 0x69, 0x74, 0x79, 0x31, 0x11, 0x30,
-		0x0f, 0x06, 0x03, 0x55, 0x04, 0x03, 0x0c, 0x08,
-		0x6d, 0x79, 0x63, 0x61, 0x2e, 0x6f, 0x72, 0x67,
-		0x31, 0x21, 0x30, 0x1f, 0x06, 0x09, 0x2a, 0x86,
-		0x48, 0x86, 0xf7, 0x0d, 0x01, 0x09, 0x01, 0x16,
-		0x12, 0x6a, 0x76, 0x73, 0x68, 0x61, 0x68, 0x69,
-		0x64, 0x40, 0x67, 0x6d, 0x61, 0x69, 0x6c, 0x2e,
-		0x63, 0x6f, 0x6d, 0x30, 0x1e, 0x17, 0x0d, 0x31,
-		0x33, 0x30, 0x35, 0x32, 0x36, 0x32, 0x31, 0x30,
-		0x35, 0x30, 0x31, 0x5a, 0x17, 0x0d, 0x32, 0x33,
-		0x30, 0x35, 0x32, 0x34, 0x32, 0x31, 0x30, 0x35,
-		0x30, 0x31, 0x5a, 0x30, 0x81, 0x86, 0x31, 0x0b,
-		0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13,
-		0x02, 0x55, 0x53, 0x31, 0x0b, 0x30, 0x09, 0x06,
-		0x03, 0x55, 0x04, 0x08, 0x0c, 0x02, 0x4e, 0x59,
-		0x31, 0x11, 0x30, 0x0f, 0x06, 0x03, 0x55, 0x04,
-		0x07, 0x0c, 0x08, 0x42, 0x72, 0x6f, 0x6f, 0x6b,
-		0x6c, 0x79, 0x6e, 0x31, 0x21, 0x30, 0x1f, 0x06,
-		0x03, 0x55, 0x04, 0x0a, 0x0c, 0x18, 0x4d, 0x79,
-		0x20, 0x43, 0x65, 0x72, 0x74, 0x69, 0x66, 0x69,
-		0x63, 0x61, 0x74, 0x65, 0x20, 0x41, 0x75, 0x74,
-		0x68, 0x6f, 0x72, 0x69, 0x74, 0x79, 0x31, 0x11,
-		0x30, 0x0f, 0x06, 0x03, 0x55, 0x04, 0x03, 0x0c,
-		0x08, 0x6d, 0x79, 0x63, 0x61, 0x2e, 0x6f, 0x72,
-		0x67, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x09, 0x2a,
-		0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x09, 0x01,
-		0x16, 0x12, 0x6a, 0x76, 0x73, 0x68, 0x61, 0x68,
-		0x69, 0x64, 0x40, 0x67, 0x6d, 0x61, 0x69, 0x6c,
-		0x2e, 0x63, 0x6f, 0x6d, 0x30, 0x82, 0x01, 0x22,
-		0x30, 0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86,
-		0xf7, 0x0d, 0x01, 0x01, 0x01, 0x05, 0x00, 0x03,
-		0x82, 0x01, 0x0f, 0x00, 0x30, 0x82, 0x01, 0x0a,
-		0x02, 0x82, 0x01, 0x01, 0x00, 0xf0, 0xfb, 0xad,
-		0x80, 0x5e, 0x37, 0xd3, 0x6d, 0xee, 0x2e, 0xcc,
-		0xbc, 0x0c, 0xd7, 0x56, 0x4b, 0x56, 0x45, 0xcd,
-		0x28, 0xb6, 0x22, 0xe9, 0xe2, 0x0f, 0xd1, 0x87,
-		0x2a, 0x27, 0xce, 0x77, 0x8d, 0x6e, 0x0e, 0x0f,
-		0xfb, 0x66, 0xe1, 0xb5, 0x0e, 0x9a, 0xb6, 0x05,
-		0x8e, 0xb3, 0xe1, 0xc5, 0x77, 0x86, 0x5b, 0x46,
-		0xd2, 0x0b, 0x92, 0x03, 0x1b, 0x89, 0x0c, 0x1b,
-		0x10, 0x0e, 0x99, 0x8f, 0xe2, 0x17, 0xe8, 0xc2,
-		0x30, 0x00, 0x47, 0xd6, 0xfc, 0xf9, 0x0f, 0x3b,
-		0x75, 0x34, 0x8d, 0x4d, 0xb0, 0x99, 0xb7, 0xa0,
-		0x6d, 0xa0, 0xb6, 0xad, 0xda, 0x07, 0x5e, 0x38,
-		0x2e, 0x02, 0xe4, 0x30, 0x6d, 0xae, 0x13, 0x72,
-		0xd4, 0xc8, 0xce, 0x14, 0x07, 0xae, 0x23, 0x8c,
-		0x8f, 0x9e, 0x8c, 0x60, 0xd6, 0x06, 0xb9, 0xef,
-		0x00, 0x18, 0xc0, 0x1d, 0x25, 0x1e, 0xda, 0x3e,
-		0x2f, 0xcf, 0x2b, 0x56, 0x84, 0x9e, 0x30, 0x21,
-		0xc7, 0x29, 0xf6, 0x03, 0x8a, 0x24, 0xf9, 0x34,
-		0xac, 0x65, 0x9d, 0x80, 0x36, 0xc8, 0x3b, 0x15,
-		0x10, 0xbd, 0x51, 0xe9, 0xbc, 0x02, 0xe1, 0xe9,
-		0xb3, 0x5a, 0x9a, 0x99, 0x41, 0x1b, 0x27, 0xa0,
-		0x4d, 0x50, 0x9e, 0x27, 0x7f, 0xa1, 0x7d, 0x09,
-		0x87, 0xbd, 0x8a, 0xca, 0x5f, 0xb1, 0xa5, 0x08,
-		0xb8, 0x04, 0xd4, 0x52, 0x89, 0xaa, 0xe0, 0x7d,
-		0x42, 0x2e, 0x2f, 0x15, 0xee, 0x66, 0x57, 0x0f,
-		0x13, 0x19, 0x45, 0xa8, 0x4b, 0x5d, 0x81, 0x66,
-		0xcc, 0x12, 0x37, 0x94, 0x5e, 0xfd, 0x3c, 0x10,
-		0x81, 0x51, 0x3f, 0xfa, 0x0f, 0xdd, 0xa1, 0x89,
-		0x03, 0xa9, 0x78, 0x91, 0xf5, 0x3b, 0xf3, 0xbc,
-		0xac, 0xbe, 0x93, 0x30, 0x2e, 0xbe, 0xca, 0x7f,
-		0x46, 0xd3, 0x28, 0xb4, 0x4e, 0x91, 0x7b, 0x5b,
-		0x43, 0x6c, 0xaf, 0x9b, 0x5c, 0x6a, 0x6d, 0x5a,
-		0xdb, 0x79, 0x5e, 0x6a, 0x6b, 0x02, 0x03, 0x01,
-		0x00, 0x01, 0xa3, 0x50, 0x30, 0x4e, 0x30, 0x1d,
-		0x06, 0x03, 0x55, 0x1d, 0x0e, 0x04, 0x16, 0x04,
-		0x14, 0x6b, 0x1e, 0x00, 0xa8, 0x9f, 0xfa, 0x7d,
-		0x00, 0xf9, 0xe0, 0x9d, 0x0f, 0x90, 0x8c, 0x90,
-		0xa8, 0xa1, 0x37, 0x6b, 0xda, 0x30, 0x1f, 0x06,
-		0x03, 0x55, 0x1d, 0x23, 0x04, 0x18, 0x30, 0x16,
-		0x80, 0x14, 0x6b, 0x1e, 0x00, 0xa8, 0x9f, 0xfa,
-		0x7d, 0x00, 0xf9, 0xe0, 0x9d, 0x0f, 0x90, 0x8c,
-		0x90, 0xa8, 0xa1, 0x37, 0x6b, 0xda, 0x30, 0x0c,
-		0x06, 0x03, 0x55, 0x1d, 0x13, 0x04, 0x05, 0x30,
-		0x03, 0x01, 0x01, 0xff, 0x30, 0x0d, 0x06, 0x09,
-		0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01,
-		0x05, 0x05, 0x00, 0x03, 0x82, 0x01, 0x01, 0x00,
-		0xcd, 0x6f, 0x73, 0x4d, 0x56, 0x0b, 0xf3, 0x2e,
-		0x1c, 0xe2, 0x02, 0x0c, 0x14, 0xbb, 0x2f, 0xdd,
-		0x3c, 0x43, 0xfe, 0xdf, 0x94, 0x2d, 0xa9, 0x89,
-		0x81, 0x51, 0xf8, 0x5f, 0xa7, 0xa0, 0x13, 0xaa,
-		0xcc, 0xb0, 0x18, 0xe2, 0x57, 0x3e, 0x0d, 0x29,
-		0x93, 0xe8, 0x95, 0xd5, 0x1b, 0x53, 0xd2, 0x51,
-		0xf2, 0xbd, 0xf5, 0x9e, 0x7b, 0x22, 0x65, 0x62,
-		0x5c, 0xc4, 0x4c, 0x1d, 0xe8, 0xe9, 0xc3, 0xd4,
-		0x2b, 0xe7, 0x78, 0xcb, 0x10, 0xf3, 0xfe, 0x06,
-		0x83, 0xdc, 0x3a, 0x1e, 0x62, 0x10, 0xc0, 0x46,
-		0x77, 0xc6, 0x9d, 0x9f, 0xab, 0x96, 0x25, 0x5c,
-		0xfb, 0x26, 0xc1, 0x15, 0x1f, 0xa5, 0x33, 0xee,
-		0x4f, 0x9a, 0x14, 0x6a, 0x14, 0x97, 0x93, 0x2b,
-		0x95, 0x0b, 0xdc, 0xa8, 0xd7, 0x69, 0x2e, 0xf0,
-		0x01, 0x0e, 0xfd, 0x4e, 0xd0, 0xd9, 0xa8, 0xe5,
-		0x65, 0xde, 0xfb, 0xca, 0xca, 0x1c, 0x5f, 0xf9,
-		0x53, 0xa0, 0x87, 0xe7, 0x33, 0x9b, 0x2f, 0xcf,
-		0xe4, 0x13, 0xfc, 0xec, 0x7a, 0x6c, 0xb0, 0x90,
-		0x13, 0x9b, 0xb6, 0xc5, 0x03, 0xf6, 0x0e, 0x5e,
-		0xe2, 0xe4, 0x26, 0xc1, 0x7e, 0x53, 0xfe, 0x69,
-		0xa3, 0xc7, 0xd8, 0x8e, 0x6e, 0x94, 0x32, 0xa0,
-		0xde, 0xca, 0xb6, 0xcc, 0xd6, 0x01, 0xd5, 0x78,
-		0x40, 0x28, 0x63, 0x9b, 0xee, 0xcf, 0x09, 0x3b,
-		0x35, 0x04, 0xf0, 0x14, 0x02, 0xf6, 0x80, 0x0e,
-		0x90, 0xb2, 0x94, 0xd2, 0x25, 0x16, 0xb8, 0x7a,
-		0x76, 0x87, 0x84, 0x9f, 0x84, 0xc5, 0xaf, 0xc2,
-		0x6d, 0x68, 0x7a, 0x84, 0x9c, 0xc6, 0x8a, 0x63,
-		0x60, 0x87, 0x6a, 0x25, 0xc1, 0xa1, 0x78, 0x0f,
-		0xba, 0xe8, 0x5f, 0xe1, 0xba, 0xac, 0xa4, 0x6f,
-		0xdd, 0x09, 0x3f, 0x12, 0xcb, 0x1d, 0xf3, 0xcf,
-		0x48, 0xd7, 0xd3, 0x26, 0xe8, 0x9c, 0xc3, 0x53,
-		0xb3, 0xba, 0xdc, 0x32, 0x99, 0x98, 0x96, 0xd6,
-		0x16, 0x03, 0x03, 0x00, 0x46, 0x10, 0x00, 0x00,
-		0x42, 0x41, 0x04, 0x1e, 0x18, 0x37, 0xef, 0x0d,
-		0x19, 0x51, 0x88, 0x35, 0x75, 0x71, 0xb5, 0xe5,
-		0x54, 0x5b, 0x12, 0x2e, 0x8f, 0x09, 0x67, 0xfd,
-		0xa7, 0x24, 0x20, 0x3e, 0xb2, 0x56, 0x1c, 0xce,
-		0x97, 0x28, 0x5e, 0xf8, 0x2b, 0x2d, 0x4f, 0x9e,
-		0xf1, 0x07, 0x9f, 0x6c, 0x4b, 0x5b, 0x83, 0x56,
-		0xe2, 0x32, 0x42, 0xe9, 0x58, 0xb6, 0xd7, 0x49,
-		0xa6, 0xb5, 0x68, 0x1a, 0x41, 0x03, 0x56, 0x6b,
-		0xdc, 0x5a, 0x89, 0x16, 0x03, 0x03, 0x01, 0x08,
-		0x0f, 0x00, 0x01, 0x04, 0x04, 0x01, 0x01, 0x00,
-		0x7e, 0xe4, 0x65, 0x02, 0x8e, 0xb3, 0x34, 0x6a,
-		0x47, 0x71, 0xd1, 0xb0, 0x8d, 0x3c, 0x0c, 0xe1,
-		0xde, 0x7e, 0x5f, 0xb4, 0x15, 0x2d, 0x32, 0x0a,
-		0x2a, 0xdb, 0x9b, 0x40, 0xba, 0xce, 0x8b, 0xf5,
-		0x74, 0xc1, 0x68, 0x20, 0x7c, 0x87, 0x23, 0x13,
-		0xc3, 0x13, 0xa7, 0xdb, 0xec, 0x59, 0xa0, 0x40,
-		0x9e, 0x64, 0x03, 0x60, 0xac, 0x76, 0xff, 0x01,
-		0x34, 0x7b, 0x32, 0x26, 0xd9, 0x41, 0x31, 0x93,
-		0xaa, 0x30, 0x51, 0x83, 0x85, 0x40, 0xeb, 0x4e,
-		0x66, 0x39, 0x83, 0xb1, 0x30, 0x0d, 0x96, 0x01,
-		0xee, 0x81, 0x53, 0x5e, 0xec, 0xa9, 0xc9, 0xdf,
-		0x7e, 0xc1, 0x09, 0x47, 0x8b, 0x35, 0xdb, 0x10,
-		0x15, 0xd4, 0xc7, 0x5a, 0x39, 0xe3, 0xc0, 0xf3,
-		0x93, 0x38, 0x11, 0xdc, 0x71, 0xbb, 0xc7, 0x62,
-		0x2b, 0x85, 0xad, 0x6b, 0x4f, 0x09, 0xb3, 0x31,
-		0xa8, 0xe5, 0xd1, 0xb3, 0xa9, 0x21, 0x37, 0x50,
-		0xc8, 0x7d, 0xc3, 0xd2, 0xf7, 0x00, 0xd3, 0xdb,
-		0x0f, 0x82, 0xf2, 0x43, 0xcf, 0x36, 0x6c, 0x98,
-		0x63, 0xd8, 0x1d, 0xb3, 0xf3, 0xde, 0x63, 0x79,
-		0x64, 0xf0, 0xdb, 0x46, 0x04, 0xe1, 0x1c, 0x57,
-		0x0f, 0x9e, 0x96, 0xb9, 0x93, 0x45, 0x71, 0x1c,
-		0x8b, 0x65, 0x7d, 0x1e, 0xad, 0xbd, 0x03, 0x51,
-		0xae, 0x44, 0xef, 0x97, 0x45, 0x0d, 0x8d, 0x41,
-		0x5c, 0x80, 0x7b, 0xe6, 0xe0, 0xbc, 0xa6, 0x72,
-		0x95, 0xa0, 0x97, 0xe1, 0xbb, 0xc0, 0xcc, 0xe5,
-		0x1e, 0xc3, 0xbe, 0xd7, 0x42, 0x2a, 0xf3, 0x75,
-		0x8a, 0x44, 0x67, 0x3c, 0xe5, 0x68, 0x78, 0xe5,
-		0x40, 0x1f, 0xf0, 0x89, 0x57, 0xda, 0xee, 0x45,
-		0xf4, 0x44, 0x81, 0x01, 0x77, 0xf0, 0x4a, 0x14,
-		0xb1, 0x3f, 0x60, 0x2b, 0xeb, 0x42, 0x38, 0xa6,
-		0xfb, 0xe5, 0x4d, 0x71, 0xdc, 0x7d, 0x0a, 0x72,
-		0x56, 0x28, 0x9d, 0xa6, 0x8e, 0x74, 0x2d, 0xbd,
-		0x14, 0x03, 0x03, 0x00, 0x01, 0x01, 0x16, 0x03,
-		0x03, 0x00, 0x28, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x31, 0x4d, 0x58, 0x94, 0x0b,
-		0x0b, 0x06, 0x5f, 0xae, 0x57, 0x17, 0x98, 0x86,
-		0xaa, 0x49, 0x17, 0x7f, 0xbd, 0x41, 0x05, 0xa5,
-		0x74, 0x1c, 0x58, 0xc8, 0x38, 0x2d, 0x99, 0x5d,
-		0xe5, 0x12, 0x43,
-	},
-	{
-		0x14, 0x03, 0x03, 0x00, 0x01, 0x01, 0x16, 0x03,
-		0x03, 0x00, 0x28, 0xf2, 0x60, 0xc2, 0x75, 0x27,
-		0x64, 0xf4, 0x05, 0x98, 0xc9, 0xd3, 0xa8, 0x00,
-		0x4c, 0xa0, 0x49, 0x82, 0x68, 0xf1, 0x21, 0x05,
-		0x7b, 0x4b, 0x25, 0x3e, 0xe1, 0x5f, 0x0f, 0x84,
-		0x26, 0x2d, 0x16, 0x2e, 0xc0, 0xfd, 0xdf, 0x0a,
-		0xf4, 0xba, 0x19,
-	},
-	{
-		0x17, 0x03, 0x03, 0x00, 0x1e, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x01, 0x35, 0xef, 0x9d,
-		0x6a, 0x86, 0x98, 0xc5, 0xca, 0x55, 0xca, 0x89,
-		0x29, 0xb4, 0x55, 0xd4, 0x41, 0x08, 0x96, 0xe0,
-		0xf3, 0x39, 0xfc, 0x15, 0x03, 0x03, 0x00, 0x1a,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x02,
-		0x02, 0x63, 0x1b, 0xaa, 0xc6, 0xc9, 0x6d, 0x72,
-		0x24, 0x10, 0x55, 0xa9, 0x8c, 0x3b, 0x23, 0xce,
-		0xd8, 0x4a,
-	},
+func TestHandshakeClientCertRSA(t *testing.T) {
+	config := *testConfig
+	cert, _ := X509KeyPair([]byte(clientCertificatePEM), []byte(clientKeyPEM))
+	config.Certificates = []Certificate{cert}
+
+	test := &clientTest{
+		name:    "ClientCert-RSA-RSA",
+		command: []string{"openssl", "s_server", "-cipher", "RC4-SHA", "-verify", "1"},
+		config:  &config,
+	}
+
+	runClientTestTLS10(t, test)
+	runClientTestTLS12(t, test)
+
+	test = &clientTest{
+		name:    "ClientCert-RSA-ECDSA",
+		command: []string{"openssl", "s_server", "-cipher", "ECDHE-ECDSA-AES128-SHA", "-verify", "1"},
+		config:  &config,
+		cert:    testECDSACertificate,
+		key:     testECDSAPrivateKey,
+	}
+
+	runClientTestTLS10(t, test)
+	runClientTestTLS12(t, test)
 }
 
-var testClientChainCertificate = fromHex(
-	"2d2d2d2d2d424547494e2050524956415445204b" +
-		"45592d2d2d2d2d0a4d494945766749424144414e" +
-		"42676b71686b6947397730424151454641415343" +
-		"424b67776767536b41674541416f494241514367" +
-		"6f2b2f4252483269343347590a4a324f7a485846" +
-		"51706a515679386b71772b726b6e70784a706747" +
-		"6266716d31657638566b6e48496c35776c74336b" +
-		"722f367647736163416b4c4b4c313348560a776a" +
-		"726d676b493369554545734c7248573470446e35" +
-		"633544412f56625a364e3638416d78526a6f656a" +
-		"30794c6a6951514673354c41664c4a4244467954" +
-		"766a0a5a6b64587557717452506a51634749376a" +
-		"75316758794c3475417a4a5153764a6747354f47" +
-		"2b45672f45656b724d4d2f35734b4265514d334a" +
-		"596e4b317156470a6b574e427854375637583950" +
-		"6a5162416951432b4e33742b6338707741425130" +
-		"766b6538736d6f6f70536d45714a3349486e646d" +
-		"48352b714b306662335775630a715079434e7052" +
-		"694456772f7367473070626a4744705262374636" +
-		"37656d4d6b38666e5755416a426f387951423173" +
-		"4542454a307a7a6636384b585a3034614a0a6952" +
-		"6a7a544f495241674d424141454367674542414a" +
-		"4b613676326b5a3144596146786e586d7369624c" +
-		"386734426f67514c6a42307362524a6d746b6b4d" +
-		"54370a685343325873537551522f446c654d7148" +
-		"664555786731784a717579597643544d44585972" +
-		"473667354a5051744d4432465a424a7239626c65" +
-		"467138386c706a0a543766514e793571354c2b4f" +
-		"682f6b62433835436e623641753641656978776d" +
-		"2b6e77665a4f3766726b6278306d35516b715975" +
-		"5739392f452b69502b454e570a76396a68773436" +
-		"76515065563236494b79717656462b4f7362722f" +
-		"6152316138707948336361566e3579594a433346" +
-		"5855756c6f5a77516331714a6b4c434c4c0a375a" +
-		"49744f525a78514c486d4d4a654d44722f5a4942" +
-		"34675467645650636145375a4d5141714d6d3066" +
-		"4c6b6d7671723149526b77642f6831455a645650" +
-		"79320a742f6b6b43413039566336663749556575" +
-		"6f67706d705a50303130564e376b6277394a6348" +
-		"75544561564543675945417a47395679426e6d62" +
-		"6858496c57764f0a71583747524f2f5231636a2b" +
-		"6b564e35377876674b54756b35592b7a4d774a48" +
-		"32626c57435945513251753974446c476854756b" +
-		"664273385746772b6e6263460a7a6f706d535245" +
-		"6c6d464d2f6141536d464733574e5a7072696a68" +
-		"504b77726338376470636b31703131635a415478" +
-		"5a413168566d43743457616343673634690a4d74" +
-		"64507a334e2f34416147664956794d2b69624949" +
-		"35332f515543675945417953693556735a356f6a" +
-		"644a795077426e6c6142554231686f2b336b7068" +
-		"70770a7264572b2b4d796b51494a345564534437" +
-		"3052486e5a315839754359713978616671746c51" +
-		"664c44395963442f436d665264706461586c5673" +
-		"5249467a5a556c0a454630557149644e77337046" +
-		"68634f4a6d6e5a3241434470434342476f763542" +
-		"6e3068302b3137686a4b376f69315833716e4542" +
-		"7857326c7462593476556a500a44394c5330666e" +
-		"4a76703043675942504a527330714c4a4a464333" +
-		"6669796b712f57574d38727474354b364a584b50" +
-		"734b674b53644144577a7463316645434d0a7a65" +
-		"2b394a6a5a376b4d77557063666a644c2b745047" +
-		"3455563048326c524375635735414131396d7058" +
-		"50367454494733713737655a6b416e65516f6163" +
-		"41340a716c3073583051476c6a5763414e30464b" +
-		"6f4759733975582b6378445a6e7265362f52392f" +
-		"3930567766443237454c57546373677734633463" +
-		"514b42675143420a6f5432326e745a5a59396d6e" +
-		"72455a36752f492f4a332f35664e396737783733" +
-		"3177746e463745745a5361575453587364597256" +
-		"466b564f6362505135494a6f0a714a6a7249372b" +
-		"474a4d69376f6a4c69642f4c45656f31764f3163" +
-		"454158334f43723236554e38612f6c7434394f5a" +
-		"69354c337348556b756c475951755671650a6737" +
-		"6e6e4632437749544c34503645486443575a4461" +
-		"7a4136626d7375524f2b6462536e335a6c567651" +
-		"4b42674859524c5a665458536c44755264776977" +
-		"746b0a513148546b6d6b57694156726c4f577864" +
-		"5858456d546130303045574c46446145797a7358" +
-		"7834424863357166776b5a4e746b634a56396e58" +
-		"63536e647441530a35767a427a676e797a4f7962" +
-		"68315878484a3966427472414f3847555878446c" +
-		"6634394457616753393449763072596e616b7656" +
-		"2f673039786875415763366e0a5365757230576b" +
-		"5376453847666653734d485149584c456b0a2d2d" +
-		"2d2d2d454e442050524956415445204b45592d2d" +
-		"2d2d2d0a2d2d2d2d2d424547494e204345525449" +
-		"4649434154452d2d2d2d2d0a4d494944656a4343" +
-		"416d494343514330523168584b326649776a414e" +
-		"42676b71686b6947397730424151554641444342" +
-		"6744454c4d416b474131554542684d430a56564d" +
-		"78437a414a42674e564241674d416b355a4d5245" +
-		"77447759445651514844416843636d3976613278" +
-		"35626a45564d424d47413155454367774d54586b" +
-		"670a51304567513278705a5735304d5263774651" +
-		"5944565151444441357465574e68593278705a57" +
-		"35304c6d4e76625445684d423847435371475349" +
-		"62334451454a0a41525953616e5a7a6147466f61" +
-		"5752415a32316861577775593239744d42345844" +
-		"54457a4d4455794e6a49784e4451774d466f5844" +
-		"54457a4d4459794e5449780a4e4451774d466f77" +
-		"6654454c4d416b474131554542684d4356564d78" +
-		"4554415042674e564241674d4345356c6479425a" +
-		"62334a724d52457744775944565151480a444168" +
-		"43636d397661327835626a45514d413447413155" +
-		"454367774854586b67544756685a6a45544d4245" +
-		"47413155454177774b62586c735a57466d4c6d4e" +
-		"760a625445684d42384743537147534962334451" +
-		"454a41525953616e5a7a6147466f615752415a32" +
-		"316861577775593239744d494942496a414e4267" +
-		"6b71686b69470a397730424151454641414f4341" +
-		"5138414d49494243674b43415145416f4b507677" +
-		"5552396f754e786d43646a73783178554b593046" +
-		"63764a4b735071354a36630a536159426d333670" +
-		"7458722f465a4a78794a65634a6264354b2f2b72" +
-		"7872476e414a43796939647831634936356f4a43" +
-		"4e346c42424c43367831754b51352b580a4f5177" +
-		"50315732656a6576414a73555936486f394d6934" +
-		"346b4542624f5377487979515178636b3734325a" +
-		"4856376c7172555434304842694f343774594638" +
-		"690a2b4c674d7955457279594275546876684950" +
-		"7848704b7a44502b624367586b444e79574a7974" +
-		"616c5270466a5163552b3165312f543430477749" +
-		"6b41766a64370a666e504b634141554e4c354876" +
-		"4c4a714b4b5570684b6964794235335a682b6671" +
-		"697448323931726e4b6a38676a61555967316350" +
-		"374942744b5734786736550a572b78657533706a" +
-		"4a504835316c41497761504d6b41646242415243" +
-		"644d38332b76436c32644f4769596b5938307a69" +
-		"45514944415141424d413047435371470a534962" +
-		"3344514542425155414134494241514351752f6c" +
-		"65756863667243476661307047304730386a7a33" +
-		"34586a357972364161382f2b4a72467436347045" +
-		"710a493458475455646e4151696f425230425946" +
-		"42665761332b6538594d564a426f634763753759" +
-		"6634615971734d7635766b426b715a4932435a67" +
-		"5644694f37790a4d4f326b6a372f575679445551" +
-		"7831536c6d2b75435a5942556a6a6a72356e5833" +
-		"42535a7849734f42412b7a46425455705a506879" +
-		"597142373250384e6e63460a427641714241712b" +
-		"4c73364250534f6832746a72787570657a796732" +
-		"55544756586b414537617a4279465a70682b7737" +
-		"417a36644430784d363965364a742f6a0a336844" +
-		"756b324b4e63314a752f7a63326d487374566b79" +
-		"364362696e384473576763726251367673544735" +
-		"3877517369496b4d6474677a4275632f6b552b34" +
-		"640a506f696e4537352f766135797a38316a3073" +
-		"4d59574a4b697262554a6e5a454433547a69484e" +
-		"35340a2d2d2d2d2d454e44204345525449464943" +
-		"4154452d2d2d2d2d0a2d2d2d2d2d424547494e20" +
-		"43455254494649434154452d2d2d2d2d0a4d4949" +
-		"4468444343416d7743435143723761626b536973" +
-		"722b44414e42676b71686b694739773042415155" +
-		"4641444342686a454c4d416b474131554542684d" +
-		"430a56564d78437a414a42674e564241674d416b" +
-		"355a4d524577447759445651514844416843636d" +
-		"397661327835626a45684d423847413155454367" +
-		"775954586b670a5132567964476c6d61574e6864" +
-		"4755675158563061473979615852354d52457744" +
-		"775944565151444441687465574e684c6d39795a" +
-		"7a45684d423847435371470a534962334451454a" +
-		"41525953616e5a7a6147466f615752415a323168" +
-		"61577775593239744d4234584454457a4d445579" +
-		"4e6a49784d5467304d466f584454457a0a4d4459" +
-		"794e5449784d5467304d466f7767594178437a41" +
-		"4a42674e5642415954416c56544d517377435159" +
-		"445651514944414a4f575445524d413847413155" +
-		"450a42777749516e4a7662327473655734784654" +
-		"415442674e5642416f4d4445313549454e424945" +
-		"4e7361575675644445584d425547413155454177" +
-		"774f62586c6a0a59574e73615756756443356a62" +
-		"3230784954416642676b71686b69473977304243" +
-		"514557456d70326332686861476c6b5147647459" +
-		"576c734c6d4e76625443430a415349774451594a" +
-		"4b6f5a496876634e415145424251414467674550" +
-		"4144434341516f4367674542414d345438484b77" +
-		"596367594e34704250534368484d752f0a396a74" +
-		"304a697157456578546f63783964315a46447a61" +
-		"33386b6953476d4c4d747343684c30517277596e" +
-		"4c6268376256354c566c32434d51537a5a495037" +
-		"700a4834373866774a454479694231677a4e7650" +
-		"4258624d796e75676167707048613730614b5941" +
-		"3953624a42736a455376734a3251756946596f44" +
-		"7a75564c55700a4a68384b724f3949614450514d" +
-		"39434c477578754c37564b553849613076465142" +
-		"566c6332646f44436b6533336663366166564f36" +
-		"6b7243796c5377693362680a416931535a376e64" +
-		"554d6b37427951696167416457494f6f374a5878" +
-		"32754a7a6f4b4679594a364755387446714d4b67" +
-		"554b425431767759684c564b4a7443690a717444" +
-		"2f747634366e4c555a4f7a2f685341326b43552b" +
-		"447963444a7067745948787837724b4a43764748" +
-		"3049596f41326853675941502b6b784a73567330" +
-		"430a417745414154414e42676b71686b69473977" +
-		"30424151554641414f43415145414a536b374873" +
-		"4e594d75596a794f3459384231696254745a6d54" +
-		"722b535849480a5031695432384376734c4e6330" +
-		"567959794f704b3546687a445666464533786365" +
-		"5762614242336c6d4e6f3152305377306e706d6e" +
-		"63314270592b68456249610a6838444e56653230" +
-		"657a4e79362f666a6534734368756b724a6a4b66" +
-		"6d66484c6b36753546724f617369495449523962" +
-		"7a4b4a5a75326e79754165417a677a330a6d4579" +
-		"4677705a7149675870766b6977416c74704b4269" +
-		"496c755058786e7254365a6e2f6e634e68545a71" +
-		"573873597a54655664576d686b576f49315a5358" +
-		"6a0a6a46757739705a57764c2b58646b746d5249" +
-		"476b784b637878614650364b544b495055425735" +
-		"6c5057765477654c397853645878776149592f58" +
-		"4a62467569530a787a6449722b346b2f44554c77" +
-		"7430467832366a4b62737066644d726c49444451" +
-		"464d4f413151396534764f2b6151444a32507355" +
-		"513d3d0a2d2d2d2d2d454e442043455254494649" +
-		"434154452d2d2d2d2d0a2d2d2d2d2d424547494e" +
-		"2043455254494649434154452d2d2d2d2d0a4d49" +
-		"49443454434341736d67417749424167494a414d" +
-		"7769544575596f6f6a384d413047435371475349" +
-		"623344514542425155414d4947474d5173774351" +
-		"59440a5651514745774a56557a454c4d416b4741" +
-		"31554543417743546c6b784554415042674e5642" +
-		"41634d43454a796232397262486c754d53457748" +
-		"7759445651514b0a4442684e655342445a584a30" +
-		"61575a70593246305a5342426458526f62334a70" +
-		"64486b784554415042674e5642414d4d43473135" +
-		"5932457562334a6e4d5345770a4877594a4b6f5a" +
-		"496876634e41516b4246684a71646e4e6f595768" +
-		"705a45426e625746706243356a62323077486863" +
-		"4e4d544d774e5449324d6a45774e5441780a5768" +
-		"634e4d6a4d774e5449304d6a45774e544178576a" +
-		"4342686a454c4d416b474131554542684d435656" +
-		"4d78437a414a42674e564241674d416b355a4d52" +
-		"45770a447759445651514844416843636d397661" +
-		"327835626a45684d423847413155454367775954" +
-		"586b675132567964476c6d61574e686447556751" +
-		"585630614739790a615852354d52457744775944" +
-		"565151444441687465574e684c6d39795a7a4568" +
-		"4d42384743537147534962334451454a41525953" +
-		"616e5a7a6147466f615752410a5a323168615777" +
-		"75593239744d494942496a414e42676b71686b69" +
-		"47397730424151454641414f43415138414d4949" +
-		"4243674b434151454138507574674634330a3032" +
-		"33754c737938444e645753315a467a5369324975" +
-		"6e69443947484b69664f6434317544672f375a75" +
-		"4731447071324259367a34635633686c74473067" +
-		"75530a4178754a4442735144706d503468666f77" +
-		"6a4141523962382b5138376454534e5462435a74" +
-		"3642746f4c6174326764654f4334433544427472" +
-		"684e79314d6a4f0a46416575493479506e6f7867" +
-		"31676135377741597742306c48746f2b4c383872" +
-		"566f53654d4348484b665944696954354e4b786c" +
-		"6e59413279447356454c31520a3662774334656d" +
-		"7a5770715a5152736e6f4531516e69642f6f5830" +
-		"4a6837324b796c2b7870516934424e5253696172" +
-		"67665549754c7858755a6c635045786c460a7145" +
-		"74646757624d456a65555876303845494652502f" +
-		"6f503361474a41366c346b665537383779737670" +
-		"4d774c72374b663062544b4c524f6b5874625132" +
-		"79760a6d31787162567262655635716177494441" +
-		"5141426f314177546a416442674e564851344546" +
-		"67515561783441714a2f3666514435344a30506b" +
-		"497951714b45330a61396f77487759445652306a" +
-		"42426777466f415561783441714a2f3666514435" +
-		"344a30506b497951714b453361396f7744415944" +
-		"5652305442415577417745420a2f7a414e42676b" +
-		"71686b6947397730424151554641414f43415145" +
-		"417a57397a5456594c387934633467494d464c73" +
-		"76335478442f742b554c616d4a675648340a5836" +
-		"65674536724d73426a69567a344e4b5a506f6c64" +
-		"556255394a52387233316e6e73695a574a637845" +
-		"7764364f6e443143766e654d7351382f34476739" +
-		"77360a486d495177455a33787032667135596c58" +
-		"50736d775255667054507554356f55616853586b" +
-		"7975564339796f31326b753841454f2f55375132" +
-		"616a6c5a6437370a79736f63582f6c546f49666e" +
-		"4d3573767a2b51542f4f7836624c435145357532" +
-		"78515032446c376935436242666c502b61615048" +
-		"324935756c444b67337371320a7a4e5942315868" +
-		"414b474f623773384a4f7a554538425143396f41" +
-		"4f6b4c4b55306955577548703268345366684d57" +
-		"76776d316f656f5363786f706a594964710a4a63" +
-		"476865412b3636462f687571796b6239304a5078" +
-		"4c4c48665050534e66544a75696377314f7a7574" +
-		"77796d5a695731673d3d0a2d2d2d2d2d454e4420" +
-		"43455254494649434154452d2d2d2d2d0a",
-)
+func TestHandshakeClientCertECDSA(t *testing.T) {
+	config := *testConfig
+	cert, _ := X509KeyPair([]byte(clientECDSACertificatePEM), []byte(clientECDSAKeyPEM))
+	config.Certificates = []Certificate{cert}
+
+	test := &clientTest{
+		name:    "ClientCert-ECDSA-RSA",
+		command: []string{"openssl", "s_server", "-cipher", "RC4-SHA", "-verify", "1"},
+		config:  &config,
+	}
+
+	runClientTestTLS10(t, test)
+	runClientTestTLS12(t, test)
+
+	test = &clientTest{
+		name:    "ClientCert-ECDSA-ECDSA",
+		command: []string{"openssl", "s_server", "-cipher", "ECDHE-ECDSA-AES128-SHA", "-verify", "1"},
+		config:  &config,
+		cert:    testECDSACertificate,
+		key:     testECDSAPrivateKey,
+	}
 
-// Script of interaction with openssl implementation:
-//
-//   openssl s_server -cipher ECDHE-ECDSA-AES128-SHA \
-//     -key server.key -cert server.crt -port 10443
-//
-// The values for this test are obtained by building and running in client mode:
-//   % go test -test.run "TestRunClient" -connect -ciphersuites=0xc009
-// The recorded bytes are written to stdout.
-//
-// The server private key is:
-//
-// -----BEGIN EC PARAMETERS-----
-// BgUrgQQAIw==
-// -----END EC PARAMETERS-----
-// -----BEGIN EC PRIVATE KEY-----
-// MIHcAgEBBEIBmIPpCa0Kyeo9M/nq5mHxeFIGlw+MqakWcvHu3Keo7xK9ZWG7JG3a
-// XfS01efjqSZJvF2DoL+Sly4A5iBn0Me9mdegBwYFK4EEACOhgYkDgYYABADEoe2+
-// mPkLSHM2fsMWVhEi8j1TwztNIT3Na3Xm9rDcmt8mwbyyh/ByMnyzZC8ckLzqaCMQ
-// fv7jJcBIOmngKG3TNwDvBGLdDaCccGKD2IHTZDGqnpcxvZawaMCbI952ZD8aXH/p
-// Eg5YWLZfcN2b2OrV1/XVzLm2nzBmW2aaIOIn5b/+Ow==
-// -----END EC PRIVATE KEY-----
-//
-// and certificate is:
-//
-// -----BEGIN CERTIFICATE-----
-// MIICADCCAWICCQC4vy1HoNLr9DAJBgcqhkjOPQQBMEUxCzAJBgNVBAYTAkFVMRMw
-// EQYDVQQIEwpTb21lLVN0YXRlMSEwHwYDVQQKExhJbnRlcm5ldCBXaWRnaXRzIFB0
-// eSBMdGQwHhcNMTIxMTIyMTUwNjMyWhcNMjIxMTIwMTUwNjMyWjBFMQswCQYDVQQG
-// EwJBVTETMBEGA1UECBMKU29tZS1TdGF0ZTEhMB8GA1UEChMYSW50ZXJuZXQgV2lk
-// Z2l0cyBQdHkgTHRkMIGbMBAGByqGSM49AgEGBSuBBAAjA4GGAAQAxKHtvpj5C0hz
-// Nn7DFlYRIvI9U8M7TSE9zWt15vaw3JrfJsG8sofwcjJ8s2QvHJC86mgjEH7+4yXA
-// SDpp4Cht0zcA7wRi3Q2gnHBig9iB02Qxqp6XMb2WsGjAmyPedmQ/Glx/6RIOWFi2
-// X3Ddm9jq1df11cy5tp8wZltmmiDiJ+W//jswCQYHKoZIzj0EAQOBjAAwgYgCQgGI
-// ok/r4kXFSH0brPXtmJ2uR3DAXhu2L73xtk23YUDTEaLO7gt+kn7/dp3DO36lP876
-// EOJZ7EctfKzaTpcOFaBv0AJCAU38vmcTnC0FDr0/o4wlwTMTgw2UBrvUN3r27HrJ
-// hi7d1xFpf4V8Vt77MXgr5Md4Da7Lvp5ONiQxe2oPOZUSB48q
-// -----END CERTIFICATE-----
-var ecdheECDSAAESClientScript = [][]byte{
-	{
-		0x16, 0x03, 0x01, 0x00, 0x4a, 0x01, 0x00, 0x00,
-		0x46, 0x03, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x02, 0xc0, 0x09,
-		0x01, 0x00, 0x00, 0x1b, 0x00, 0x05, 0x00, 0x05,
-		0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x0a, 0x00,
-		0x08, 0x00, 0x06, 0x00, 0x17, 0x00, 0x18, 0x00,
-		0x19, 0x00, 0x0b, 0x00, 0x02, 0x01, 0x00,
-	},
-	{
-		0x16, 0x03, 0x01, 0x00, 0x54, 0x02, 0x00, 0x00,
-		0x50, 0x03, 0x01, 0x50, 0xd7, 0x19, 0xc9, 0x03,
-		0xc2, 0x3a, 0xc6, 0x1f, 0x0a, 0x84, 0x9e, 0xd7,
-		0xf4, 0x7e, 0x07, 0x6d, 0xa8, 0xe4, 0xa9, 0x4f,
-		0x22, 0x50, 0xa2, 0x19, 0x24, 0x44, 0x42, 0x65,
-		0xaa, 0xba, 0x3a, 0x20, 0x90, 0x70, 0xb7, 0xe5,
-		0x57, 0xed, 0xb1, 0xb1, 0x43, 0x4b, 0xa1, 0x4e,
-		0xee, 0x7a, 0x5b, 0x88, 0xf6, 0xa6, 0x73, 0x3b,
-		0xcb, 0xa7, 0xbd, 0x57, 0x50, 0xf2, 0x72, 0x8c,
-		0xbc, 0x45, 0x73, 0xaa, 0xc0, 0x09, 0x00, 0x00,
-		0x08, 0x00, 0x0b, 0x00, 0x04, 0x03, 0x00, 0x01,
-		0x02, 0x16, 0x03, 0x01, 0x02, 0x0e, 0x0b, 0x00,
-		0x02, 0x0a, 0x00, 0x02, 0x07, 0x00, 0x02, 0x04,
-		0x30, 0x82, 0x02, 0x00, 0x30, 0x82, 0x01, 0x62,
-		0x02, 0x09, 0x00, 0xb8, 0xbf, 0x2d, 0x47, 0xa0,
-		0xd2, 0xeb, 0xf4, 0x30, 0x09, 0x06, 0x07, 0x2a,
-		0x86, 0x48, 0xce, 0x3d, 0x04, 0x01, 0x30, 0x45,
-		0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04,
-		0x06, 0x13, 0x02, 0x41, 0x55, 0x31, 0x13, 0x30,
-		0x11, 0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0a,
-		0x53, 0x6f, 0x6d, 0x65, 0x2d, 0x53, 0x74, 0x61,
-		0x74, 0x65, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x03,
-		0x55, 0x04, 0x0a, 0x13, 0x18, 0x49, 0x6e, 0x74,
-		0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x57, 0x69,
-		0x64, 0x67, 0x69, 0x74, 0x73, 0x20, 0x50, 0x74,
-		0x79, 0x20, 0x4c, 0x74, 0x64, 0x30, 0x1e, 0x17,
-		0x0d, 0x31, 0x32, 0x31, 0x31, 0x32, 0x32, 0x31,
-		0x35, 0x30, 0x36, 0x33, 0x32, 0x5a, 0x17, 0x0d,
-		0x32, 0x32, 0x31, 0x31, 0x32, 0x30, 0x31, 0x35,
-		0x30, 0x36, 0x33, 0x32, 0x5a, 0x30, 0x45, 0x31,
-		0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06,
-		0x13, 0x02, 0x41, 0x55, 0x31, 0x13, 0x30, 0x11,
-		0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0a, 0x53,
-		0x6f, 0x6d, 0x65, 0x2d, 0x53, 0x74, 0x61, 0x74,
-		0x65, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x03, 0x55,
-		0x04, 0x0a, 0x13, 0x18, 0x49, 0x6e, 0x74, 0x65,
-		0x72, 0x6e, 0x65, 0x74, 0x20, 0x57, 0x69, 0x64,
-		0x67, 0x69, 0x74, 0x73, 0x20, 0x50, 0x74, 0x79,
-		0x20, 0x4c, 0x74, 0x64, 0x30, 0x81, 0x9b, 0x30,
-		0x10, 0x06, 0x07, 0x2a, 0x86, 0x48, 0xce, 0x3d,
-		0x02, 0x01, 0x06, 0x05, 0x2b, 0x81, 0x04, 0x00,
-		0x23, 0x03, 0x81, 0x86, 0x00, 0x04, 0x00, 0xc4,
-		0xa1, 0xed, 0xbe, 0x98, 0xf9, 0x0b, 0x48, 0x73,
-		0x36, 0x7e, 0xc3, 0x16, 0x56, 0x11, 0x22, 0xf2,
-		0x3d, 0x53, 0xc3, 0x3b, 0x4d, 0x21, 0x3d, 0xcd,
-		0x6b, 0x75, 0xe6, 0xf6, 0xb0, 0xdc, 0x9a, 0xdf,
-		0x26, 0xc1, 0xbc, 0xb2, 0x87, 0xf0, 0x72, 0x32,
-		0x7c, 0xb3, 0x64, 0x2f, 0x1c, 0x90, 0xbc, 0xea,
-		0x68, 0x23, 0x10, 0x7e, 0xfe, 0xe3, 0x25, 0xc0,
-		0x48, 0x3a, 0x69, 0xe0, 0x28, 0x6d, 0xd3, 0x37,
-		0x00, 0xef, 0x04, 0x62, 0xdd, 0x0d, 0xa0, 0x9c,
-		0x70, 0x62, 0x83, 0xd8, 0x81, 0xd3, 0x64, 0x31,
-		0xaa, 0x9e, 0x97, 0x31, 0xbd, 0x96, 0xb0, 0x68,
-		0xc0, 0x9b, 0x23, 0xde, 0x76, 0x64, 0x3f, 0x1a,
-		0x5c, 0x7f, 0xe9, 0x12, 0x0e, 0x58, 0x58, 0xb6,
-		0x5f, 0x70, 0xdd, 0x9b, 0xd8, 0xea, 0xd5, 0xd7,
-		0xf5, 0xd5, 0xcc, 0xb9, 0xb6, 0x9f, 0x30, 0x66,
-		0x5b, 0x66, 0x9a, 0x20, 0xe2, 0x27, 0xe5, 0xbf,
-		0xfe, 0x3b, 0x30, 0x09, 0x06, 0x07, 0x2a, 0x86,
-		0x48, 0xce, 0x3d, 0x04, 0x01, 0x03, 0x81, 0x8c,
-		0x00, 0x30, 0x81, 0x88, 0x02, 0x42, 0x01, 0x88,
-		0xa2, 0x4f, 0xeb, 0xe2, 0x45, 0xc5, 0x48, 0x7d,
-		0x1b, 0xac, 0xf5, 0xed, 0x98, 0x9d, 0xae, 0x47,
-		0x70, 0xc0, 0x5e, 0x1b, 0xb6, 0x2f, 0xbd, 0xf1,
-		0xb6, 0x4d, 0xb7, 0x61, 0x40, 0xd3, 0x11, 0xa2,
-		0xce, 0xee, 0x0b, 0x7e, 0x92, 0x7e, 0xff, 0x76,
-		0x9d, 0xc3, 0x3b, 0x7e, 0xa5, 0x3f, 0xce, 0xfa,
-		0x10, 0xe2, 0x59, 0xec, 0x47, 0x2d, 0x7c, 0xac,
-		0xda, 0x4e, 0x97, 0x0e, 0x15, 0xa0, 0x6f, 0xd0,
-		0x02, 0x42, 0x01, 0x4d, 0xfc, 0xbe, 0x67, 0x13,
-		0x9c, 0x2d, 0x05, 0x0e, 0xbd, 0x3f, 0xa3, 0x8c,
-		0x25, 0xc1, 0x33, 0x13, 0x83, 0x0d, 0x94, 0x06,
-		0xbb, 0xd4, 0x37, 0x7a, 0xf6, 0xec, 0x7a, 0xc9,
-		0x86, 0x2e, 0xdd, 0xd7, 0x11, 0x69, 0x7f, 0x85,
-		0x7c, 0x56, 0xde, 0xfb, 0x31, 0x78, 0x2b, 0xe4,
-		0xc7, 0x78, 0x0d, 0xae, 0xcb, 0xbe, 0x9e, 0x4e,
-		0x36, 0x24, 0x31, 0x7b, 0x6a, 0x0f, 0x39, 0x95,
-		0x12, 0x07, 0x8f, 0x2a, 0x16, 0x03, 0x01, 0x00,
-		0xd6, 0x0c, 0x00, 0x00, 0xd2, 0x03, 0x00, 0x17,
-		0x41, 0x04, 0x33, 0xed, 0xe1, 0x10, 0x3d, 0xe2,
-		0xb0, 0x81, 0x5e, 0x01, 0x1b, 0x00, 0x4a, 0x7d,
-		0xdc, 0xc5, 0x78, 0x02, 0xb1, 0x9a, 0x78, 0x92,
-		0x34, 0xd9, 0x23, 0xcc, 0x01, 0xfb, 0x0c, 0x49,
-		0x1c, 0x4a, 0x59, 0x8a, 0x80, 0x1b, 0x34, 0xf0,
-		0xe8, 0x87, 0x1b, 0x7c, 0xfb, 0x72, 0xf5, 0xea,
-		0xf9, 0xf3, 0xff, 0xa6, 0x3e, 0x4e, 0xac, 0xbc,
-		0xee, 0x14, 0x2b, 0x87, 0xd4, 0x0b, 0xda, 0x19,
-		0x60, 0x2b, 0x00, 0x8b, 0x30, 0x81, 0x88, 0x02,
-		0x42, 0x01, 0x75, 0x46, 0x4f, 0x97, 0x9f, 0xc5,
-		0xf9, 0x4c, 0x38, 0xcf, 0x3b, 0x37, 0x1a, 0x6b,
-		0x53, 0xfc, 0x05, 0x73, 0x7d, 0x98, 0x2c, 0x5b,
-		0x76, 0xd4, 0x37, 0x1f, 0x50, 0x6d, 0xad, 0xc6,
-		0x0f, 0x8f, 0x7b, 0xcc, 0x60, 0x8e, 0x04, 0x00,
-		0x21, 0x80, 0xa8, 0xa5, 0x98, 0xf2, 0x42, 0xf2,
-		0xc3, 0xf6, 0x44, 0x50, 0xc4, 0x7a, 0xae, 0x6f,
-		0x74, 0xa0, 0x7f, 0x07, 0x7a, 0x0b, 0xbb, 0x41,
-		0x9e, 0x3c, 0x0b, 0x02, 0x42, 0x01, 0xbe, 0x64,
-		0xaa, 0x12, 0x03, 0xfb, 0xd8, 0x4f, 0x93, 0xf9,
-		0x92, 0x54, 0x0d, 0x9c, 0x9d, 0x53, 0x88, 0x19,
-		0x69, 0x94, 0xfc, 0xd6, 0xf7, 0x60, 0xcf, 0x70,
-		0x64, 0x15, 0x1b, 0x02, 0x22, 0x56, 0xb0, 0x2c,
-		0xb1, 0x72, 0x4c, 0x9e, 0x7b, 0xf0, 0x53, 0x97,
-		0x43, 0xac, 0x11, 0x62, 0xe5, 0x5a, 0xf1, 0x7e,
-		0x87, 0x8f, 0x5c, 0x43, 0x1d, 0xae, 0x56, 0x28,
-		0xdb, 0x76, 0x15, 0xd8, 0x1c, 0x73, 0xce, 0x16,
-		0x03, 0x01, 0x00, 0x04, 0x0e, 0x00, 0x00, 0x00,
-	},
-	{
-		0x16, 0x03, 0x01, 0x00, 0x46, 0x10, 0x00, 0x00,
-		0x42, 0x41, 0x04, 0x1e, 0x18, 0x37, 0xef, 0x0d,
-		0x19, 0x51, 0x88, 0x35, 0x75, 0x71, 0xb5, 0xe5,
-		0x54, 0x5b, 0x12, 0x2e, 0x8f, 0x09, 0x67, 0xfd,
-		0xa7, 0x24, 0x20, 0x3e, 0xb2, 0x56, 0x1c, 0xce,
-		0x97, 0x28, 0x5e, 0xf8, 0x2b, 0x2d, 0x4f, 0x9e,
-		0xf1, 0x07, 0x9f, 0x6c, 0x4b, 0x5b, 0x83, 0x56,
-		0xe2, 0x32, 0x42, 0xe9, 0x58, 0xb6, 0xd7, 0x49,
-		0xa6, 0xb5, 0x68, 0x1a, 0x41, 0x03, 0x56, 0x6b,
-		0xdc, 0x5a, 0x89, 0x14, 0x03, 0x01, 0x00, 0x01,
-		0x01, 0x16, 0x03, 0x01, 0x00, 0x30, 0x1a, 0x45,
-		0x92, 0x3b, 0xac, 0x8d, 0x91, 0x89, 0xd3, 0x2c,
-		0xf4, 0x3c, 0x5f, 0x70, 0xf1, 0x79, 0xa5, 0x6a,
-		0xcf, 0x97, 0x8f, 0x3f, 0x73, 0x08, 0xca, 0x3f,
-		0x55, 0xb0, 0x28, 0xd1, 0x6f, 0xcd, 0x9b, 0xca,
-		0xb6, 0xb7, 0xd0, 0xa5, 0x21, 0x5b, 0x08, 0xf8,
-		0x42, 0xe2, 0xdf, 0x25, 0x6a, 0x16,
-	},
-	{
-		0x14, 0x03, 0x01, 0x00, 0x01, 0x01, 0x16, 0x03,
-		0x01, 0x00, 0x30, 0x30, 0x83, 0xb6, 0x51, 0x8a,
-		0x85, 0x4a, 0xee, 0xe4, 0xb6, 0xae, 0xf3, 0xc1,
-		0xdc, 0xd2, 0x04, 0xb3, 0xd0, 0x25, 0x47, 0x5f,
-		0xac, 0x83, 0xa3, 0x7d, 0xcf, 0x47, 0x92, 0xed,
-		0x92, 0x6c, 0xd1, 0x6e, 0xfd, 0x63, 0xf5, 0x2d,
-		0x89, 0xd8, 0x04, 0x8c, 0x62, 0x71, 0xae, 0x5e,
-		0x32, 0x48, 0xf8,
-	},
-	{
-		0x17, 0x03, 0x01, 0x00, 0x20, 0xcf, 0x5e, 0xba,
-		0xf4, 0x47, 0x32, 0x35, 0x9b, 0x85, 0xdc, 0xb3,
-		0xff, 0x77, 0x90, 0xd9, 0x2b, 0xbd, 0x59, 0x2a,
-		0x33, 0xe4, 0x6e, 0x9b, 0xfc, 0x1c, 0x73, 0x3f,
-		0x5e, 0x1e, 0xe3, 0xa4, 0xc2, 0x17, 0x03, 0x01,
-		0x00, 0x20, 0x05, 0xdf, 0x2d, 0x9b, 0x29, 0x7f,
-		0x97, 0xcd, 0x49, 0x04, 0x53, 0x22, 0x1a, 0xa1,
-		0xa1, 0xe6, 0x38, 0x3a, 0x56, 0x37, 0x1f, 0xd8,
-		0x3a, 0x12, 0x2c, 0xf0, 0xeb, 0x61, 0x35, 0x76,
-		0xe5, 0xf0, 0x15, 0x03, 0x01, 0x00, 0x20, 0xa5,
-		0x56, 0xb5, 0x49, 0x4b, 0xc2, 0xd4, 0x4c, 0xf6,
-		0x95, 0x15, 0x7d, 0x41, 0x1d, 0x5c, 0x00, 0x0e,
-		0x20, 0xb1, 0x0a, 0xbc, 0xc9, 0x2a, 0x09, 0x17,
-		0xb4, 0xaa, 0x1c, 0x79, 0xda, 0x79, 0x27,
-	},
+	runClientTestTLS10(t, test)
+	runClientTestTLS12(t, test)
 }
diff --git a/src/pkg/crypto/tls/handshake_server_test.go b/src/pkg/crypto/tls/handshake_server_test.go
index c08eba7f17..1eb420af47 100644
--- a/src/pkg/crypto/tls/handshake_server_test.go
+++ b/src/pkg/crypto/tls/handshake_server_test.go
@@ -12,20 +12,19 @@ import (
 	"crypto/x509"
 	"encoding/hex"
 	"encoding/pem"
-	"flag"
+	"errors"
 	"fmt"
 	"io"
-	"log"
 	"math/big"
 	"net"
 	"os"
-	"strconv"
-	"strings"
-	"sync"
+	"os/exec"
+	"path/filepath"
 	"testing"
 	"time"
 )
 
+// zeroSource is an io.Reader that returns an unlimited number of zero bytes.
 type zeroSource struct{}
 
 func (zeroSource) Read(b []byte) (n int, err error) {
@@ -39,19 +38,19 @@ func (zeroSource) Read(b []byte) (n int, err error) {
 var testConfig *Config
 
 func init() {
-	testConfig = new(Config)
-	testConfig.Time = func() time.Time { return time.Unix(0, 0) }
-	testConfig.Rand = zeroSource{}
-	testConfig.Certificates = make([]Certificate, 2)
+	testConfig = &Config{
+		Time:               func() time.Time { return time.Unix(0, 0) },
+		Rand:               zeroSource{},
+		Certificates:       make([]Certificate, 2),
+		InsecureSkipVerify: true,
+		MinVersion:         VersionSSL30,
+		MaxVersion:         VersionTLS12,
+	}
 	testConfig.Certificates[0].Certificate = [][]byte{testRSACertificate}
 	testConfig.Certificates[0].PrivateKey = testRSAPrivateKey
 	testConfig.Certificates[1].Certificate = [][]byte{testSNICertificate}
 	testConfig.Certificates[1].PrivateKey = testRSAPrivateKey
 	testConfig.BuildNameToCertificate()
-	testConfig.CipherSuites = []uint16{TLS_RSA_WITH_RC4_128_SHA}
-	testConfig.InsecureSkipVerify = true
-	testConfig.MinVersion = VersionSSL30
-	testConfig.MaxVersion = VersionTLS10
 }
 
 func testClientHelloFailure(t *testing.T, m handshakeMessage, expected error) {
@@ -221,2920 +220,327 @@ func TestCipherSuitePreference(t *testing.T) {
 	}
 }
 
-func testServerScript(t *testing.T, name string, serverScript [][]byte, config *Config, peers []*x509.Certificate) {
-	c, s := net.Pipe()
-	srv := Server(s, config)
-	pchan := make(chan []*x509.Certificate, 1)
-	go func() {
-		srv.Write([]byte("hello, world\n"))
-		srv.Close()
-		s.Close()
-		st := srv.ConnectionState()
-		pchan <- st.PeerCertificates
-	}()
-
-	for i, b := range serverScript {
-		if i%2 == 0 {
-			c.Write(b)
-			continue
-		}
-		bb := make([]byte, len(b))
-		n, err := io.ReadFull(c, bb)
-		if err != nil {
-			t.Fatalf("%s #%d: %s\nRead %d, wanted %d, got %x, wanted %x\n", name, i, err, n, len(bb), bb[:n], b)
-		}
-		if !bytes.Equal(b, bb) {
-			t.Fatalf("%s #%d: mismatch on read: got:%x want:%x", name, i, bb, b)
-		}
-	}
-	c.Close()
-
-	if peers != nil {
-		gotpeers := <-pchan
-		if len(peers) == len(gotpeers) {
-			for i := range peers {
-				if !peers[i].Equal(gotpeers[i]) {
-					t.Fatalf("%s: mismatch on peer cert %d", name, i)
-				}
-			}
-		} else {
-			t.Fatalf("%s: mismatch on peer list length: %d (wanted) != %d (got)", name, len(peers), len(gotpeers))
-		}
+// Note: see comment in handshake_test.go for details of how the reference
+// tests work.
+
+// serverTest represents a test of the TLS server handshake against a reference
+// implementation.
+type serverTest struct {
+	// name is a freeform string identifying the test and the file in which
+	// the expected results will be stored.
+	name string
+	// command, if not empty, contains a series of arguments for the
+	// command to run for the reference server.
+	command []string
+	// expectedPeerCerts contains a list of PEM blocks of expected
+	// certificates from the client.
+	expectedPeerCerts []string
+	// config, if not nil, contains a custom Config to use for this test.
+	config *Config
+}
+
+var defaultClientCommand = []string{"openssl", "s_client", "-no_ticket"}
+
+// connFromCommand starts opens a listening socket and starts the reference
+// client to connect to it. It returns a recordingConn that wraps the resulting
+// connection.
+func (test *serverTest) connFromCommand() (conn *recordingConn, child *exec.Cmd, err error) {
+	l, err := net.ListenTCP("tcp", &net.TCPAddr{
+		IP:   net.IPv4(127, 0, 0, 1),
+		Port: 0,
+	})
+	if err != nil {
+		return nil, nil, err
 	}
-}
-
-func TestHandshakeServerRSARC4(t *testing.T) {
-	testServerScript(t, "RSA-RC4", rsaRC4ServerScript, testConfig, nil)
-}
+	defer l.Close()
 
-func TestHandshakeServerRSA3DES(t *testing.T) {
-	des3Config := new(Config)
-	*des3Config = *testConfig
-	des3Config.CipherSuites = []uint16{TLS_RSA_WITH_3DES_EDE_CBC_SHA}
-	testServerScript(t, "RSA-3DES", rsaDES3ServerScript, des3Config, nil)
-}
-
-func TestHandshakeServerRSAAES(t *testing.T) {
-	aesConfig := new(Config)
-	*aesConfig = *testConfig
-	aesConfig.CipherSuites = []uint16{TLS_RSA_WITH_AES_128_CBC_SHA}
-	testServerScript(t, "RSA-AES", rsaAESServerScript, aesConfig, nil)
-}
-
-func TestHandshakeServerECDHEECDSAAES(t *testing.T) {
-	ecdsaConfig := new(Config)
-	*ecdsaConfig = *testConfig
-	ecdsaConfig.Certificates = make([]Certificate, 1)
-	ecdsaConfig.Certificates[0].Certificate = [][]byte{testECDSACertificate}
-	ecdsaConfig.Certificates[0].PrivateKey = testECDSAPrivateKey
-	ecdsaConfig.BuildNameToCertificate()
-	ecdsaConfig.CipherSuites = []uint16{TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA}
-	testServerScript(t, "ECDHE-ECDSA-AES", ecdheECDSAAESServerScript, ecdsaConfig, nil)
-}
-
-func TestHandshakeServerSSLv3(t *testing.T) {
-	testServerScript(t, "SSLv3", sslv3ServerScript, testConfig, nil)
-}
+	port := l.Addr().(*net.TCPAddr).Port
 
-// TestHandshakeServerSNI involves a client sending an SNI extension of
-// "snitest.com", which happens to match the CN of testSNICertificate. The test
-// verifies that the server correctly selects that certificate.
-func TestHandshakeServerSNI(t *testing.T) {
-	testServerScript(t, "SNI", selectCertificateBySNIScript, testConfig, nil)
-}
-
-func TestResumption(t *testing.T) {
-	testServerScript(t, "IssueTicket", issueSessionTicketTest, testConfig, nil)
-	testServerScript(t, "Resume", serverResumeTest, testConfig, nil)
-}
-
-func TestTLS12ClientCertServer(t *testing.T) {
-	config := *testConfig
-	config.MaxVersion = VersionTLS12
-	config.ClientAuth = RequireAnyClientCert
-	config.CipherSuites = []uint16{TLS_ECDHE_RSA_WITH_RC4_128_SHA}
-
-	testServerScript(t, "TLS12", tls12ServerScript, &config, nil)
-}
-
-type clientauthTest struct {
-	name       string
-	clientauth ClientAuthType
-	peers      []*x509.Certificate
-	script     [][]byte
-}
-
-func TestClientAuthRSA(t *testing.T) {
-	for _, cat := range clientauthRSATests {
-		t.Log("running", cat.name)
-		cfg := new(Config)
-		*cfg = *testConfig
-		cfg.ClientAuth = cat.clientauth
-		testServerScript(t, cat.name, cat.script, cfg, cat.peers)
+	var command []string
+	command = append(command, test.command...)
+	if len(command) == 0 {
+		command = defaultClientCommand
 	}
-}
-
-func TestClientAuthECDSA(t *testing.T) {
-	for _, cat := range clientauthECDSATests {
-		t.Log("running", cat.name)
-		cfg := new(Config)
-		*cfg = *testConfig
-		cfg.Certificates = make([]Certificate, 1)
-		cfg.Certificates[0].Certificate = [][]byte{testECDSACertificate}
-		cfg.Certificates[0].PrivateKey = testECDSAPrivateKey
-		cfg.BuildNameToCertificate()
-		cfg.CipherSuites = []uint16{TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA}
-		cfg.ClientAuth = cat.clientauth
-		testServerScript(t, cat.name, cat.script, cfg, cat.peers)
+	command = append(command, "-connect")
+	command = append(command, fmt.Sprintf("127.0.0.1:%d", port))
+	cmd := exec.Command(command[0], command[1:]...)
+	cmd.Stdin = nil
+	var output bytes.Buffer
+	cmd.Stdout = &output
+	cmd.Stderr = &output
+	if err := cmd.Start(); err != nil {
+		return nil, nil, err
 	}
-}
 
-// TestCipherSuiteCertPreferance ensures that we select an RSA ciphersuite with
-// an RSA certificate and an ECDSA ciphersuite with an ECDSA certificate.
-func TestCipherSuiteCertPreferance(t *testing.T) {
-	var config = *testConfig
-	config.CipherSuites = []uint16{TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA, TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA}
-	config.MaxVersion = VersionTLS11
-	config.PreferServerCipherSuites = true
-	testServerScript(t, "CipherSuiteCertPreference", tls11ECDHEAESServerScript, &config, nil)
+	connChan := make(chan interface{})
+	go func() {
+		tcpConn, err := l.Accept()
+		if err != nil {
+			connChan <- err
+		}
+		connChan <- tcpConn
+	}()
 
-	config = *testConfig
-	config.CipherSuites = []uint16{TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA, TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA}
-	config.Certificates = []Certificate{
-		Certificate{
-			Certificate: [][]byte{testECDSACertificate},
-			PrivateKey:  testECDSAPrivateKey,
-		},
+	var tcpConn net.Conn
+	select {
+	case connOrError := <-connChan:
+		if err, ok := connOrError.(error); ok {
+			return nil, nil, err
+		}
+		tcpConn = connOrError.(net.Conn)
+	case <-time.After(2 * time.Second):
+		output.WriteTo(os.Stdout)
+		return nil, nil, errors.New("timed out waiting for connection from child process")
 	}
-	config.BuildNameToCertificate()
-	config.PreferServerCipherSuites = true
-	testServerScript(t, "CipherSuiteCertPreference2", ecdheECDSAAESServerScript, &config, nil)
-}
-
-func TestTLS11Server(t *testing.T) {
-	var config = *testConfig
-	config.CipherSuites = []uint16{TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA}
-	config.MaxVersion = VersionTLS11
-	testServerScript(t, "TLS11", tls11ECDHEAESServerScript, &config, nil)
-}
-
-func TestAESGCM(t *testing.T) {
-	var config = *testConfig
-	config.CipherSuites = []uint16{TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256}
-	config.MaxVersion = VersionTLS12
-	testServerScript(t, "AES-GCM", aesGCMServerScript, &config, nil)
-}
 
-// recordingConn is a net.Conn that records the traffic that passes through it.
-// WriteTo can be used to produce Go code that contains the recorded traffic.
-type recordingConn struct {
-	net.Conn
-	lock             sync.Mutex
-	flows            [][]byte
-	currentlyReading bool
-}
-
-func (r *recordingConn) Read(b []byte) (n int, err error) {
-	if n, err = r.Conn.Read(b); n == 0 {
-		return
+	record := &recordingConn{
+		Conn: tcpConn,
 	}
-	b = b[:n]
-
-	r.lock.Lock()
-	defer r.lock.Unlock()
 
-	if l := len(r.flows); l == 0 || !r.currentlyReading {
-		buf := make([]byte, len(b))
-		copy(buf, b)
-		r.flows = append(r.flows, buf)
-	} else {
-		r.flows[l-1] = append(r.flows[l-1], b[:n]...)
-	}
-	r.currentlyReading = true
-	return
+	return record, cmd, nil
 }
 
-func (r *recordingConn) Write(b []byte) (n int, err error) {
-	if n, err = r.Conn.Write(b); n == 0 {
-		return
-	}
-	b = b[:n]
-
-	r.lock.Lock()
-	defer r.lock.Unlock()
-
-	if l := len(r.flows); l == 0 || r.currentlyReading {
-		buf := make([]byte, len(b))
-		copy(buf, b)
-		r.flows = append(r.flows, buf)
-	} else {
-		r.flows[l-1] = append(r.flows[l-1], b[:n]...)
-	}
-	r.currentlyReading = false
-	return
+func (test *serverTest) dataPath() string {
+	return filepath.Join("testdata", "Server-"+test.name)
 }
 
-// WriteTo writes Go source code to w that contains the recorded traffic.
-func (r *recordingConn) WriteTo(w io.Writer) {
-	fmt.Fprintf(w, "var changeMe = [][]byte {\n")
-	for _, buf := range r.flows {
-		fmt.Fprintf(w, "\t{")
-		for i, b := range buf {
-			if i%8 == 0 {
-				fmt.Fprintf(w, "\n\t\t")
-			}
-			fmt.Fprintf(w, "0x%02x, ", b)
-		}
-		fmt.Fprintf(w, "\n\t},\n")
+func (test *serverTest) loadData() (flows [][]byte, err error) {
+	in, err := os.Open(test.dataPath())
+	if err != nil {
+		return nil, err
 	}
-	fmt.Fprintf(w, "}\n")
+	defer in.Close()
+	return parseTestData(in)
 }
 
-var serve = flag.Bool("serve", false, "run a TLS server on :10443")
-var testCipherSuites = flag.String("ciphersuites",
-	"0x"+strconv.FormatInt(int64(TLS_RSA_WITH_RC4_128_SHA), 16),
-	"cipher suites to accept in serving mode")
-var testMinVersion = flag.String("minversion",
-	"0x"+strconv.FormatInt(int64(VersionSSL30), 16),
-	"minimum version to negotiate")
-var testMaxVersion = flag.String("maxversion",
-	"0x"+strconv.FormatInt(int64(VersionTLS10), 16),
-	"maximum version to negotiate")
-var testClientAuth = flag.Int("clientauth", 0, "value for tls.Config.ClientAuth")
-
-func GetTestConfig() *Config {
-	var config = *testConfig
-
-	minVersion, err := strconv.ParseUint(*testMinVersion, 0, 64)
-	if err != nil {
-		panic(err)
-	}
-	config.MinVersion = uint16(minVersion)
-	maxVersion, err := strconv.ParseUint(*testMaxVersion, 0, 64)
-	if err != nil {
-		panic(err)
-	}
-	config.MaxVersion = uint16(maxVersion)
+func (test *serverTest) run(t *testing.T, write bool) {
+	var clientConn, serverConn net.Conn
+	var recordingConn *recordingConn
+	var childProcess *exec.Cmd
 
-	suites := strings.Split(*testCipherSuites, ",")
-	config.CipherSuites = make([]uint16, len(suites))
-	for i := range suites {
-		suite, err := strconv.ParseUint(suites[i], 0, 64)
+	if write {
+		var err error
+		recordingConn, childProcess, err = test.connFromCommand()
 		if err != nil {
-			panic(err)
+			t.Fatalf("Failed to start subcommand: %s", err)
 		}
-		config.CipherSuites[i] = uint16(suite)
+		serverConn = recordingConn
+	} else {
+		clientConn, serverConn = net.Pipe()
 	}
-
-	ecdsa := false
-	for _, suite := range config.CipherSuites {
-		switch suite {
-		case TLS_ECDHE_ECDSA_WITH_RC4_128_SHA,
-			TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA,
-			TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA:
-			ecdsa = true
-		}
+	config := test.config
+	if config == nil {
+		config = testConfig
 	}
-	if ecdsa {
-		config.Certificates = nil
-		if !*connect {
-			config.Certificates = make([]Certificate, 1)
-			config.Certificates[0].Certificate = [][]byte{testECDSACertificate}
-			config.Certificates[0].PrivateKey = testECDSAPrivateKey
+	server := Server(serverConn, config)
+	peerCertsChan := make(chan []*x509.Certificate, 1)
+	go func() {
+		if _, err := server.Write([]byte("hello, world\n")); err != nil {
+			t.Logf("Error from Server.Write: %s", err)
 		}
-		config.BuildNameToCertificate()
-	}
-
-	config.ClientAuth = ClientAuthType(*testClientAuth)
-	return &config
-}
-
-func TestRunServer(t *testing.T) {
-	if !*serve {
-		return
-	}
-
-	config := GetTestConfig()
-
-	const addr = ":10443"
-	l, err := net.Listen("tcp", addr)
-	if err != nil {
-		t.Fatal(err)
-	}
-	log.Printf("Now listening for connections on %s", addr)
+		server.Close()
+		serverConn.Close()
+		peerCertsChan <- server.ConnectionState().PeerCertificates
+	}()
 
-	for {
-		tcpConn, err := l.Accept()
+	if !write {
+		flows, err := test.loadData()
 		if err != nil {
-			log.Printf("error accepting connection: %s", err)
-			break
+			t.Fatalf("%s: failed to load data from %s", test.name, test.dataPath())
 		}
-
-		record := &recordingConn{
-			Conn: tcpConn,
+		for i, b := range flows {
+			if i%2 == 0 {
+				clientConn.Write(b)
+				continue
+			}
+			bb := make([]byte, len(b))
+			n, err := io.ReadFull(clientConn, bb)
+			if err != nil {
+				t.Fatalf("%s #%d: %s\nRead %d, wanted %d, got %x, wanted %x\n", test.name, i+1, err, n, len(bb), bb[:n], b)
+			}
+			if !bytes.Equal(b, bb) {
+				t.Fatalf("%s #%d: mismatch on read: got:%x want:%x", test.name, i+1, bb, b)
+			}
 		}
+		clientConn.Close()
+	}
 
-		conn := Server(record, config)
-		if err := conn.Handshake(); err != nil {
-			log.Printf("error from TLS handshake: %s", err)
-			break
+	peerCerts := <-peerCertsChan
+	if len(peerCerts) == len(test.expectedPeerCerts) {
+		for i, peerCert := range peerCerts {
+			block, _ := pem.Decode([]byte(test.expectedPeerCerts[i]))
+			if !bytes.Equal(block.Bytes, peerCert.Raw) {
+				t.Fatalf("%s: mismatch on peer cert %d", test.name, i+1)
+			}
 		}
+	} else {
+		t.Fatalf("%s: mismatch on peer list length: %d (wanted) != %d (got)", test.name, len(test.expectedPeerCerts), len(peerCerts))
+	}
 
-		_, err = conn.Write([]byte("hello, world\n"))
+	if write {
+		path := test.dataPath()
+		out, err := os.OpenFile(path, os.O_WRONLY|os.O_CREATE|os.O_TRUNC, 0644)
 		if err != nil {
-			log.Printf("error from Write: %s", err)
-			continue
+			t.Fatalf("Failed to create output file: %s", err)
 		}
-
-		conn.Close()
-
-		record.WriteTo(os.Stdout)
+		defer out.Close()
+		recordingConn.Close()
+		if len(recordingConn.flows) < 3 {
+			childProcess.Stdout.(*bytes.Buffer).WriteTo(os.Stdout)
+			t.Fatalf("Handshake failed")
+		}
+		recordingConn.WriteTo(out)
+		fmt.Printf("Wrote %s\n", path)
+		childProcess.Wait()
 	}
 }
 
-func bigFromString(s string) *big.Int {
-	ret := new(big.Int)
-	ret.SetString(s, 10)
-	return ret
+func runServerTestForVersion(t *testing.T, template *serverTest, prefix, option string) {
+	test := *template
+	test.name = prefix + test.name
+	if len(test.command) == 0 {
+		test.command = defaultClientCommand
+	}
+	test.command = append([]string(nil), test.command...)
+	test.command = append(test.command, option)
+	test.run(t, *update)
 }
 
-func fromHex(s string) []byte {
-	b, _ := hex.DecodeString(s)
-	return b
+func runServerTestSSLv3(t *testing.T, template *serverTest) {
+	runServerTestForVersion(t, template, "SSLv3-", "-ssl3")
 }
 
-var testRSACertificate = fromHex("308202b030820219a00302010202090085b0bba48a7fb8ca300d06092a864886f70d01010505003045310b3009060355040613024155311330110603550408130a536f6d652d53746174653121301f060355040a1318496e7465726e6574205769646769747320507479204c7464301e170d3130303432343039303933385a170d3131303432343039303933385a3045310b3009060355040613024155311330110603550408130a536f6d652d53746174653121301f060355040a1318496e7465726e6574205769646769747320507479204c746430819f300d06092a864886f70d010101050003818d0030818902818100bb79d6f517b5e5bf4610d0dc69bee62b07435ad0032d8a7a4385b71452e7a5654c2c78b8238cb5b482e5de1f953b7e62a52ca533d6fe125c7a56fcf506bffa587b263fb5cd04d3d0c921964ac7f4549f5abfef427100fe1899077f7e887d7df10439c4a22edb51c97ce3c04c3b326601cfafb11db8719a1ddbdb896baeda2d790203010001a381a73081a4301d0603551d0e04160414b1ade2855acfcb28db69ce2369ded3268e18883930750603551d23046e306c8014b1ade2855acfcb28db69ce2369ded3268e188839a149a4473045310b3009060355040613024155311330110603550408130a536f6d652d53746174653121301f060355040a1318496e7465726e6574205769646769747320507479204c746482090085b0bba48a7fb8ca300c0603551d13040530030101ff300d06092a864886f70d010105050003818100086c4524c76bb159ab0c52ccf2b014d7879d7a6475b55a9566e4c52b8eae12661feb4f38b36e60d392fdf74108b52513b1187a24fb301dbaed98b917ece7d73159db95d31d78ea50565cd5825a2d5a5f33c4b6d8c97590968c0f5298b5cd981f89205ff2a01ca31b9694dda9fd57e970e8266d71999b266e3850296c90a7bdd9")
-
-var testECDSACertificate = fromHex("3082020030820162020900b8bf2d47a0d2ebf4300906072a8648ce3d04013045310b3009060355040613024155311330110603550408130a536f6d652d53746174653121301f060355040a1318496e7465726e6574205769646769747320507479204c7464301e170d3132313132323135303633325a170d3232313132303135303633325a3045310b3009060355040613024155311330110603550408130a536f6d652d53746174653121301f060355040a1318496e7465726e6574205769646769747320507479204c746430819b301006072a8648ce3d020106052b81040023038186000400c4a1edbe98f90b4873367ec316561122f23d53c33b4d213dcd6b75e6f6b0dc9adf26c1bcb287f072327cb3642f1c90bcea6823107efee325c0483a69e0286dd33700ef0462dd0da09c706283d881d36431aa9e9731bd96b068c09b23de76643f1a5c7fe9120e5858b65f70dd9bd8ead5d7f5d5ccb9b69f30665b669a20e227e5bffe3b300906072a8648ce3d040103818c0030818802420188a24febe245c5487d1bacf5ed989dae4770c05e1bb62fbdf1b64db76140d311a2ceee0b7e927eff769dc33b7ea53fcefa10e259ec472d7cacda4e970e15a06fd00242014dfcbe67139c2d050ebd3fa38c25c13313830d9406bbd4377af6ec7ac9862eddd711697f857c56defb31782be4c7780daecbbe9e4e3624317b6a0f399512078f2a")
-
-var testSNICertificate = fromHex("308201f23082015da003020102020100300b06092a864886f70d01010530283110300e060355040a130741636d6520436f311430120603550403130b736e69746573742e636f6d301e170d3132303431313137343033355a170d3133303431313137343533355a30283110300e060355040a130741636d6520436f311430120603550403130b736e69746573742e636f6d30819d300b06092a864886f70d01010103818d0030818902818100bb79d6f517b5e5bf4610d0dc69bee62b07435ad0032d8a7a4385b71452e7a5654c2c78b8238cb5b482e5de1f953b7e62a52ca533d6fe125c7a56fcf506bffa587b263fb5cd04d3d0c921964ac7f4549f5abfef427100fe1899077f7e887d7df10439c4a22edb51c97ce3c04c3b326601cfafb11db8719a1ddbdb896baeda2d790203010001a3323030300e0603551d0f0101ff0404030200a0300d0603551d0e0406040401020304300f0603551d2304083006800401020304300b06092a864886f70d0101050381810089c6455f1c1f5ef8eb1ab174ee2439059f5c4259bb1a8d86cdb1d056f56a717da40e95ab90f59e8deaf627c157995094db0802266eb34fc6842dea8a4b68d9c1389103ab84fb9e1f85d9b5d23ff2312c8670fbb540148245a4ebafe264d90c8a4cf4f85b0fac12ac2fc4a3154bad52462868af96c62c6525d652b6e31845bdcc")
+func runServerTestTLS10(t *testing.T, template *serverTest) {
+	runServerTestForVersion(t, template, "TLSv10-", "-tls1")
+}
 
-var testRSAPrivateKey = &rsa.PrivateKey{
-	PublicKey: rsa.PublicKey{
-		N: bigFromString("131650079503776001033793877885499001334664249354723305978524647182322416328664556247316495448366990052837680518067798333412266673813370895702118944398081598789828837447552603077848001020611640547221687072142537202428102790818451901395596882588063427854225330436740647715202971973145151161964464812406232198521"),
-		E: 65537,
-	},
-	D: bigFromString("29354450337804273969007277378287027274721892607543397931919078829901848876371746653677097639302788129485893852488285045793268732234230875671682624082413996177431586734171663258657462237320300610850244186316880055243099640544518318093544057213190320837094958164973959123058337475052510833916491060913053867729"),
-	Primes: []*big.Int{
-		bigFromString("11969277782311800166562047708379380720136961987713178380670422671426759650127150688426177829077494755200794297055316163155755835813760102405344560929062149"),
-		bigFromString("10998999429884441391899182616418192492905073053684657075974935218461686523870125521822756579792315215543092255516093840728890783887287417039645833477273829"),
-	},
+func runServerTestTLS11(t *testing.T, template *serverTest) {
+	runServerTestForVersion(t, template, "TLSv11-", "-tls1_1")
 }
 
-var testECDSAPrivateKey = &ecdsa.PrivateKey{
-	PublicKey: ecdsa.PublicKey{
-		Curve: &elliptic.CurveParams{
-			P:       bigFromString("6864797660130609714981900799081393217269435300143305409394463459185543183397656052122559640661454554977296311391480858037121987999716643812574028291115057151"),
-			N:       bigFromString("6864797660130609714981900799081393217269435300143305409394463459185543183397655394245057746333217197532963996371363321113864768612440380340372808892707005449"),
-			B:       bigFromString("1093849038073734274511112390766805569936207598951683748994586394495953116150735016013708737573759623248592132296706313309438452531591012912142327488478985984"),
-			Gx:      bigFromString("2661740802050217063228768716723360960729859168756973147706671368418802944996427808491545080627771902352094241225065558662157113545570916814161637315895999846"),
-			Gy:      bigFromString("3757180025770020463545507224491183603594455134769762486694567779615544477440556316691234405012945539562144444537289428522585666729196580810124344277578376784"),
-			BitSize: 521,
-		},
-		X: bigFromString("2636411247892461147287360222306590634450676461695221912739908880441342231985950069527906976759812296359387337367668045707086543273113073382714101597903639351"),
-		Y: bigFromString("3204695818431246682253994090650952614555094516658732116404513121125038617915183037601737180082382202488628239201196033284060130040574800684774115478859677243"),
-	},
-	D: bigFromString("5477294338614160138026852784385529180817726002953041720191098180813046231640184669647735805135001309477695746518160084669446643325196003346204701381388769751"),
+func runServerTestTLS12(t *testing.T, template *serverTest) {
+	runServerTestForVersion(t, template, "TLSv12-", "-tls1_2")
 }
 
-func loadPEMCert(in string) *x509.Certificate {
-	block, _ := pem.Decode([]byte(in))
-	if block.Type == "CERTIFICATE" && len(block.Headers) == 0 {
-		cert, err := x509.ParseCertificate(block.Bytes)
-		if err == nil {
-			return cert
-		}
-		panic("error parsing cert")
+func TestHandshakeServerRSARC4(t *testing.T) {
+	test := &serverTest{
+		name:    "RSA-RC4",
+		command: []string{"openssl", "s_client", "-no_ticket", "-cipher", "RC4-SHA"},
 	}
-	panic("error parsing PEM")
+	runServerTestSSLv3(t, test)
+	runServerTestTLS10(t, test)
+	runServerTestTLS11(t, test)
+	runServerTestTLS12(t, test)
 }
 
-// Script of interaction with gnutls implementation.
-// The values for this test are obtained by building and running in server mode:
-//   % go test -test.run "TestRunServer" -serve
-// The recorded bytes are written to stdout.
-var rsaRC4ServerScript = [][]byte{
-	{
-		0x16, 0x03, 0x01, 0x00, 0x54, 0x01, 0x00, 0x00,
-		0x50, 0x03, 0x01, 0x50, 0x77, 0x3d, 0xbd, 0x32,
-		0x13, 0xd7, 0xea, 0x33, 0x65, 0x02, 0xb8, 0x70,
-		0xb7, 0x84, 0xc4, 0x05, 0x1f, 0xa4, 0x24, 0xc4,
-		0x91, 0x69, 0x04, 0x32, 0x96, 0xfe, 0x5b, 0x49,
-		0x71, 0x60, 0x9a, 0x00, 0x00, 0x28, 0x00, 0x39,
-		0x00, 0x38, 0x00, 0x35, 0x00, 0x16, 0x00, 0x13,
-		0x00, 0x0a, 0x00, 0x33, 0x00, 0x32, 0x00, 0x2f,
-		0x00, 0x05, 0x00, 0x04, 0x00, 0x15, 0x00, 0x12,
-		0x00, 0x09, 0x00, 0x14, 0x00, 0x11, 0x00, 0x08,
-		0x00, 0x06, 0x00, 0x03, 0x00, 0xff, 0x02, 0x01,
-		0x00,
-	},
-	{
-		0x16, 0x03, 0x01, 0x00, 0x2a, 0x02, 0x00, 0x00,
-		0x26, 0x03, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x00, 0x16,
-		0x03, 0x01, 0x02, 0xbe, 0x0b, 0x00, 0x02, 0xba,
-		0x00, 0x02, 0xb7, 0x00, 0x02, 0xb4, 0x30, 0x82,
-		0x02, 0xb0, 0x30, 0x82, 0x02, 0x19, 0xa0, 0x03,
-		0x02, 0x01, 0x02, 0x02, 0x09, 0x00, 0x85, 0xb0,
-		0xbb, 0xa4, 0x8a, 0x7f, 0xb8, 0xca, 0x30, 0x0d,
-		0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d,
-		0x01, 0x01, 0x05, 0x05, 0x00, 0x30, 0x45, 0x31,
-		0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06,
-		0x13, 0x02, 0x41, 0x55, 0x31, 0x13, 0x30, 0x11,
-		0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0a, 0x53,
-		0x6f, 0x6d, 0x65, 0x2d, 0x53, 0x74, 0x61, 0x74,
-		0x65, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x03, 0x55,
-		0x04, 0x0a, 0x13, 0x18, 0x49, 0x6e, 0x74, 0x65,
-		0x72, 0x6e, 0x65, 0x74, 0x20, 0x57, 0x69, 0x64,
-		0x67, 0x69, 0x74, 0x73, 0x20, 0x50, 0x74, 0x79,
-		0x20, 0x4c, 0x74, 0x64, 0x30, 0x1e, 0x17, 0x0d,
-		0x31, 0x30, 0x30, 0x34, 0x32, 0x34, 0x30, 0x39,
-		0x30, 0x39, 0x33, 0x38, 0x5a, 0x17, 0x0d, 0x31,
-		0x31, 0x30, 0x34, 0x32, 0x34, 0x30, 0x39, 0x30,
-		0x39, 0x33, 0x38, 0x5a, 0x30, 0x45, 0x31, 0x0b,
-		0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13,
-		0x02, 0x41, 0x55, 0x31, 0x13, 0x30, 0x11, 0x06,
-		0x03, 0x55, 0x04, 0x08, 0x13, 0x0a, 0x53, 0x6f,
-		0x6d, 0x65, 0x2d, 0x53, 0x74, 0x61, 0x74, 0x65,
-		0x31, 0x21, 0x30, 0x1f, 0x06, 0x03, 0x55, 0x04,
-		0x0a, 0x13, 0x18, 0x49, 0x6e, 0x74, 0x65, 0x72,
-		0x6e, 0x65, 0x74, 0x20, 0x57, 0x69, 0x64, 0x67,
-		0x69, 0x74, 0x73, 0x20, 0x50, 0x74, 0x79, 0x20,
-		0x4c, 0x74, 0x64, 0x30, 0x81, 0x9f, 0x30, 0x0d,
-		0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d,
-		0x01, 0x01, 0x01, 0x05, 0x00, 0x03, 0x81, 0x8d,
-		0x00, 0x30, 0x81, 0x89, 0x02, 0x81, 0x81, 0x00,
-		0xbb, 0x79, 0xd6, 0xf5, 0x17, 0xb5, 0xe5, 0xbf,
-		0x46, 0x10, 0xd0, 0xdc, 0x69, 0xbe, 0xe6, 0x2b,
-		0x07, 0x43, 0x5a, 0xd0, 0x03, 0x2d, 0x8a, 0x7a,
-		0x43, 0x85, 0xb7, 0x14, 0x52, 0xe7, 0xa5, 0x65,
-		0x4c, 0x2c, 0x78, 0xb8, 0x23, 0x8c, 0xb5, 0xb4,
-		0x82, 0xe5, 0xde, 0x1f, 0x95, 0x3b, 0x7e, 0x62,
-		0xa5, 0x2c, 0xa5, 0x33, 0xd6, 0xfe, 0x12, 0x5c,
-		0x7a, 0x56, 0xfc, 0xf5, 0x06, 0xbf, 0xfa, 0x58,
-		0x7b, 0x26, 0x3f, 0xb5, 0xcd, 0x04, 0xd3, 0xd0,
-		0xc9, 0x21, 0x96, 0x4a, 0xc7, 0xf4, 0x54, 0x9f,
-		0x5a, 0xbf, 0xef, 0x42, 0x71, 0x00, 0xfe, 0x18,
-		0x99, 0x07, 0x7f, 0x7e, 0x88, 0x7d, 0x7d, 0xf1,
-		0x04, 0x39, 0xc4, 0xa2, 0x2e, 0xdb, 0x51, 0xc9,
-		0x7c, 0xe3, 0xc0, 0x4c, 0x3b, 0x32, 0x66, 0x01,
-		0xcf, 0xaf, 0xb1, 0x1d, 0xb8, 0x71, 0x9a, 0x1d,
-		0xdb, 0xdb, 0x89, 0x6b, 0xae, 0xda, 0x2d, 0x79,
-		0x02, 0x03, 0x01, 0x00, 0x01, 0xa3, 0x81, 0xa7,
-		0x30, 0x81, 0xa4, 0x30, 0x1d, 0x06, 0x03, 0x55,
-		0x1d, 0x0e, 0x04, 0x16, 0x04, 0x14, 0xb1, 0xad,
-		0xe2, 0x85, 0x5a, 0xcf, 0xcb, 0x28, 0xdb, 0x69,
-		0xce, 0x23, 0x69, 0xde, 0xd3, 0x26, 0x8e, 0x18,
-		0x88, 0x39, 0x30, 0x75, 0x06, 0x03, 0x55, 0x1d,
-		0x23, 0x04, 0x6e, 0x30, 0x6c, 0x80, 0x14, 0xb1,
-		0xad, 0xe2, 0x85, 0x5a, 0xcf, 0xcb, 0x28, 0xdb,
-		0x69, 0xce, 0x23, 0x69, 0xde, 0xd3, 0x26, 0x8e,
-		0x18, 0x88, 0x39, 0xa1, 0x49, 0xa4, 0x47, 0x30,
-		0x45, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55,
-		0x04, 0x06, 0x13, 0x02, 0x41, 0x55, 0x31, 0x13,
-		0x30, 0x11, 0x06, 0x03, 0x55, 0x04, 0x08, 0x13,
-		0x0a, 0x53, 0x6f, 0x6d, 0x65, 0x2d, 0x53, 0x74,
-		0x61, 0x74, 0x65, 0x31, 0x21, 0x30, 0x1f, 0x06,
-		0x03, 0x55, 0x04, 0x0a, 0x13, 0x18, 0x49, 0x6e,
-		0x74, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x57,
-		0x69, 0x64, 0x67, 0x69, 0x74, 0x73, 0x20, 0x50,
-		0x74, 0x79, 0x20, 0x4c, 0x74, 0x64, 0x82, 0x09,
-		0x00, 0x85, 0xb0, 0xbb, 0xa4, 0x8a, 0x7f, 0xb8,
-		0xca, 0x30, 0x0c, 0x06, 0x03, 0x55, 0x1d, 0x13,
-		0x04, 0x05, 0x30, 0x03, 0x01, 0x01, 0xff, 0x30,
-		0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7,
-		0x0d, 0x01, 0x01, 0x05, 0x05, 0x00, 0x03, 0x81,
-		0x81, 0x00, 0x08, 0x6c, 0x45, 0x24, 0xc7, 0x6b,
-		0xb1, 0x59, 0xab, 0x0c, 0x52, 0xcc, 0xf2, 0xb0,
-		0x14, 0xd7, 0x87, 0x9d, 0x7a, 0x64, 0x75, 0xb5,
-		0x5a, 0x95, 0x66, 0xe4, 0xc5, 0x2b, 0x8e, 0xae,
-		0x12, 0x66, 0x1f, 0xeb, 0x4f, 0x38, 0xb3, 0x6e,
-		0x60, 0xd3, 0x92, 0xfd, 0xf7, 0x41, 0x08, 0xb5,
-		0x25, 0x13, 0xb1, 0x18, 0x7a, 0x24, 0xfb, 0x30,
-		0x1d, 0xba, 0xed, 0x98, 0xb9, 0x17, 0xec, 0xe7,
-		0xd7, 0x31, 0x59, 0xdb, 0x95, 0xd3, 0x1d, 0x78,
-		0xea, 0x50, 0x56, 0x5c, 0xd5, 0x82, 0x5a, 0x2d,
-		0x5a, 0x5f, 0x33, 0xc4, 0xb6, 0xd8, 0xc9, 0x75,
-		0x90, 0x96, 0x8c, 0x0f, 0x52, 0x98, 0xb5, 0xcd,
-		0x98, 0x1f, 0x89, 0x20, 0x5f, 0xf2, 0xa0, 0x1c,
-		0xa3, 0x1b, 0x96, 0x94, 0xdd, 0xa9, 0xfd, 0x57,
-		0xe9, 0x70, 0xe8, 0x26, 0x6d, 0x71, 0x99, 0x9b,
-		0x26, 0x6e, 0x38, 0x50, 0x29, 0x6c, 0x90, 0xa7,
-		0xbd, 0xd9, 0x16, 0x03, 0x01, 0x00, 0x04, 0x0e,
-		0x00, 0x00, 0x00,
-	},
-	{
-		0x16, 0x03, 0x01, 0x00, 0x86, 0x10, 0x00, 0x00,
-		0x82, 0x00, 0x80, 0x2d, 0x09, 0x7c, 0x7f, 0xfc,
-		0x84, 0xce, 0xb3, 0x30, 0x9b, 0xf9, 0xb7, 0xc8,
-		0xc3, 0xff, 0xee, 0x6f, 0x20, 0x8a, 0xf4, 0xfb,
-		0x86, 0x55, 0x1f, 0x6a, 0xb4, 0x81, 0x50, 0x3a,
-		0x46, 0x1b, 0xd3, 0xca, 0x4b, 0x11, 0xff, 0xef,
-		0x02, 0xbc, 0x18, 0xb8, 0x4a, 0x7d, 0x43, 0x23,
-		0x96, 0x92, 0x27, 0x7c, 0xca, 0xcf, 0xe6, 0x91,
-		0xe8, 0x14, 0x97, 0x68, 0xb4, 0xe5, 0xc0, 0xc9,
-		0x23, 0xdd, 0x54, 0x07, 0xa6, 0x2e, 0x8c, 0x98,
-		0xfc, 0xc6, 0x8c, 0x04, 0x6b, 0x1b, 0x5f, 0xd5,
-		0x3d, 0x8b, 0x6c, 0x55, 0x4f, 0x7a, 0xe6, 0x6c,
-		0x74, 0x2c, 0x1e, 0x34, 0xdb, 0xfb, 0x00, 0xb1,
-		0x4e, 0x10, 0x21, 0x16, 0xe0, 0x3e, 0xc5, 0x64,
-		0x84, 0x28, 0x2b, 0x2b, 0x29, 0x47, 0x51, 0x34,
-		0x76, 0x15, 0x20, 0x71, 0x0b, 0x30, 0xa1, 0x85,
-		0xd5, 0x15, 0x18, 0x14, 0x64, 0x4b, 0x40, 0x7c,
-		0x4f, 0xb3, 0x7b, 0x14, 0x03, 0x01, 0x00, 0x01,
-		0x01, 0x16, 0x03, 0x01, 0x00, 0x24, 0xab, 0xee,
-		0xf5, 0x97, 0x5f, 0xc6, 0x78, 0xf3, 0xc6, 0x83,
-		0x5b, 0x55, 0x4f, 0xcb, 0x45, 0x3f, 0xfa, 0xf7,
-		0x05, 0x02, 0xc2, 0x63, 0x87, 0x18, 0xb5, 0x9a,
-		0x62, 0xe2, 0x3f, 0x88, 0x5a, 0x60, 0x61, 0x72,
-		0xfa, 0x9c,
-	},
-	{
-		0x14, 0x03, 0x01, 0x00, 0x01, 0x01, 0x16, 0x03,
-		0x01, 0x00, 0x24, 0x72, 0xa4, 0xe4, 0xaa, 0xd2,
-		0xc4, 0x39, 0x7e, 0x2a, 0xc1, 0x6f, 0x34, 0x42,
-		0x28, 0xcb, 0x9d, 0x7a, 0x09, 0xca, 0x96, 0xad,
-		0x0e, 0x11, 0x51, 0x8a, 0x06, 0xb0, 0xe9, 0xca,
-		0xeb, 0xce, 0xe2, 0xd5, 0x2e, 0xc1, 0x8d, 0x17,
-		0x03, 0x01, 0x00, 0x21, 0x2e, 0x61, 0x86, 0x17,
-		0xdb, 0xa6, 0x30, 0xe2, 0x62, 0x06, 0x2a, 0x8b,
-		0x75, 0x2c, 0x2d, 0xcf, 0xf5, 0x01, 0x11, 0x52,
-		0x81, 0x38, 0xcf, 0xd5, 0xf7, 0xdc, 0x52, 0x31,
-		0x1f, 0x97, 0x43, 0xc2, 0x71, 0x15, 0x03, 0x01,
-		0x00, 0x16, 0xe0, 0x21, 0xfe, 0x36, 0x2e, 0x68,
-		0x2c, 0xf1, 0xbe, 0x04, 0xec, 0xd4, 0xc6, 0xdd,
-		0xac, 0x6f, 0x4c, 0x85, 0x32, 0x3f, 0x87, 0x1b,
-	},
+func TestHandshakeServerRSA3DES(t *testing.T) {
+	test := &serverTest{
+		name:    "RSA-3DES",
+		command: []string{"openssl", "s_client", "-no_ticket", "-cipher", "DES-CBC3-SHA"},
+	}
+	runServerTestSSLv3(t, test)
+	runServerTestTLS10(t, test)
+	runServerTestTLS12(t, test)
 }
 
-var rsaDES3ServerScript = [][]byte{
-	{
-		0x16, 0x03, 0x00, 0x00, 0xc5, 0x01, 0x00, 0x00,
-		0xc1, 0x03, 0x03, 0x50, 0xae, 0x5d, 0x38, 0xec,
-		0xaa, 0x2f, 0x41, 0xf9, 0xd2, 0x7b, 0xa1, 0xfd,
-		0x0f, 0xff, 0x4e, 0x54, 0x0e, 0x15, 0x57, 0xaf,
-		0x2c, 0x91, 0xb5, 0x35, 0x5b, 0x2e, 0xb0, 0xec,
-		0x20, 0xe5, 0xd2, 0x00, 0x00, 0x50, 0xc0, 0x09,
-		0xc0, 0x23, 0xc0, 0x2b, 0xc0, 0x0a, 0xc0, 0x24,
-		0xc0, 0x2c, 0xc0, 0x08, 0xc0, 0x13, 0xc0, 0x27,
-		0xc0, 0x2f, 0xc0, 0x14, 0xc0, 0x30, 0xc0, 0x12,
-		0x00, 0x33, 0x00, 0x67, 0x00, 0x45, 0x00, 0x9e,
-		0x00, 0x39, 0x00, 0x6b, 0x00, 0x88, 0x00, 0x16,
-		0x00, 0x32, 0x00, 0x40, 0x00, 0x44, 0x00, 0xa2,
-		0x00, 0x38, 0x00, 0x6a, 0x00, 0x87, 0x00, 0x13,
-		0x00, 0x66, 0x00, 0x2f, 0x00, 0x3c, 0x00, 0x41,
-		0x00, 0x9c, 0x00, 0x35, 0x00, 0x3d, 0x00, 0x84,
-		0x00, 0x0a, 0x00, 0x05, 0x00, 0x04, 0x01, 0x00,
-		0x00, 0x48, 0x00, 0x05, 0x00, 0x05, 0x01, 0x00,
-		0x00, 0x00, 0x00, 0xff, 0x01, 0x00, 0x01, 0x00,
-		0x00, 0x23, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x0c,
-		0x00, 0x0a, 0x00, 0x13, 0x00, 0x15, 0x00, 0x17,
-		0x00, 0x18, 0x00, 0x19, 0x00, 0x0b, 0x00, 0x02,
-		0x01, 0x00, 0x00, 0x0d, 0x00, 0x1c, 0x00, 0x1a,
-		0x04, 0x01, 0x04, 0x02, 0x04, 0x03, 0x05, 0x01,
-		0x05, 0x03, 0x06, 0x01, 0x06, 0x03, 0x03, 0x01,
-		0x03, 0x02, 0x03, 0x03, 0x02, 0x01, 0x02, 0x02,
-		0x02, 0x03,
-	},
-	{
-		0x16, 0x03, 0x01, 0x00, 0x30, 0x02, 0x00, 0x00,
-		0x2c, 0x03, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x00,
-		0x04, 0x00, 0x23, 0x00, 0x00, 0x16, 0x03, 0x01,
-		0x02, 0xbe, 0x0b, 0x00, 0x02, 0xba, 0x00, 0x02,
-		0xb7, 0x00, 0x02, 0xb4, 0x30, 0x82, 0x02, 0xb0,
-		0x30, 0x82, 0x02, 0x19, 0xa0, 0x03, 0x02, 0x01,
-		0x02, 0x02, 0x09, 0x00, 0x85, 0xb0, 0xbb, 0xa4,
-		0x8a, 0x7f, 0xb8, 0xca, 0x30, 0x0d, 0x06, 0x09,
-		0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01,
-		0x05, 0x05, 0x00, 0x30, 0x45, 0x31, 0x0b, 0x30,
-		0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02,
-		0x41, 0x55, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03,
-		0x55, 0x04, 0x08, 0x13, 0x0a, 0x53, 0x6f, 0x6d,
-		0x65, 0x2d, 0x53, 0x74, 0x61, 0x74, 0x65, 0x31,
-		0x21, 0x30, 0x1f, 0x06, 0x03, 0x55, 0x04, 0x0a,
-		0x13, 0x18, 0x49, 0x6e, 0x74, 0x65, 0x72, 0x6e,
-		0x65, 0x74, 0x20, 0x57, 0x69, 0x64, 0x67, 0x69,
-		0x74, 0x73, 0x20, 0x50, 0x74, 0x79, 0x20, 0x4c,
-		0x74, 0x64, 0x30, 0x1e, 0x17, 0x0d, 0x31, 0x30,
-		0x30, 0x34, 0x32, 0x34, 0x30, 0x39, 0x30, 0x39,
-		0x33, 0x38, 0x5a, 0x17, 0x0d, 0x31, 0x31, 0x30,
-		0x34, 0x32, 0x34, 0x30, 0x39, 0x30, 0x39, 0x33,
-		0x38, 0x5a, 0x30, 0x45, 0x31, 0x0b, 0x30, 0x09,
-		0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x41,
-		0x55, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03, 0x55,
-		0x04, 0x08, 0x13, 0x0a, 0x53, 0x6f, 0x6d, 0x65,
-		0x2d, 0x53, 0x74, 0x61, 0x74, 0x65, 0x31, 0x21,
-		0x30, 0x1f, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13,
-		0x18, 0x49, 0x6e, 0x74, 0x65, 0x72, 0x6e, 0x65,
-		0x74, 0x20, 0x57, 0x69, 0x64, 0x67, 0x69, 0x74,
-		0x73, 0x20, 0x50, 0x74, 0x79, 0x20, 0x4c, 0x74,
-		0x64, 0x30, 0x81, 0x9f, 0x30, 0x0d, 0x06, 0x09,
-		0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01,
-		0x01, 0x05, 0x00, 0x03, 0x81, 0x8d, 0x00, 0x30,
-		0x81, 0x89, 0x02, 0x81, 0x81, 0x00, 0xbb, 0x79,
-		0xd6, 0xf5, 0x17, 0xb5, 0xe5, 0xbf, 0x46, 0x10,
-		0xd0, 0xdc, 0x69, 0xbe, 0xe6, 0x2b, 0x07, 0x43,
-		0x5a, 0xd0, 0x03, 0x2d, 0x8a, 0x7a, 0x43, 0x85,
-		0xb7, 0x14, 0x52, 0xe7, 0xa5, 0x65, 0x4c, 0x2c,
-		0x78, 0xb8, 0x23, 0x8c, 0xb5, 0xb4, 0x82, 0xe5,
-		0xde, 0x1f, 0x95, 0x3b, 0x7e, 0x62, 0xa5, 0x2c,
-		0xa5, 0x33, 0xd6, 0xfe, 0x12, 0x5c, 0x7a, 0x56,
-		0xfc, 0xf5, 0x06, 0xbf, 0xfa, 0x58, 0x7b, 0x26,
-		0x3f, 0xb5, 0xcd, 0x04, 0xd3, 0xd0, 0xc9, 0x21,
-		0x96, 0x4a, 0xc7, 0xf4, 0x54, 0x9f, 0x5a, 0xbf,
-		0xef, 0x42, 0x71, 0x00, 0xfe, 0x18, 0x99, 0x07,
-		0x7f, 0x7e, 0x88, 0x7d, 0x7d, 0xf1, 0x04, 0x39,
-		0xc4, 0xa2, 0x2e, 0xdb, 0x51, 0xc9, 0x7c, 0xe3,
-		0xc0, 0x4c, 0x3b, 0x32, 0x66, 0x01, 0xcf, 0xaf,
-		0xb1, 0x1d, 0xb8, 0x71, 0x9a, 0x1d, 0xdb, 0xdb,
-		0x89, 0x6b, 0xae, 0xda, 0x2d, 0x79, 0x02, 0x03,
-		0x01, 0x00, 0x01, 0xa3, 0x81, 0xa7, 0x30, 0x81,
-		0xa4, 0x30, 0x1d, 0x06, 0x03, 0x55, 0x1d, 0x0e,
-		0x04, 0x16, 0x04, 0x14, 0xb1, 0xad, 0xe2, 0x85,
-		0x5a, 0xcf, 0xcb, 0x28, 0xdb, 0x69, 0xce, 0x23,
-		0x69, 0xde, 0xd3, 0x26, 0x8e, 0x18, 0x88, 0x39,
-		0x30, 0x75, 0x06, 0x03, 0x55, 0x1d, 0x23, 0x04,
-		0x6e, 0x30, 0x6c, 0x80, 0x14, 0xb1, 0xad, 0xe2,
-		0x85, 0x5a, 0xcf, 0xcb, 0x28, 0xdb, 0x69, 0xce,
-		0x23, 0x69, 0xde, 0xd3, 0x26, 0x8e, 0x18, 0x88,
-		0x39, 0xa1, 0x49, 0xa4, 0x47, 0x30, 0x45, 0x31,
-		0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06,
-		0x13, 0x02, 0x41, 0x55, 0x31, 0x13, 0x30, 0x11,
-		0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0a, 0x53,
-		0x6f, 0x6d, 0x65, 0x2d, 0x53, 0x74, 0x61, 0x74,
-		0x65, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x03, 0x55,
-		0x04, 0x0a, 0x13, 0x18, 0x49, 0x6e, 0x74, 0x65,
-		0x72, 0x6e, 0x65, 0x74, 0x20, 0x57, 0x69, 0x64,
-		0x67, 0x69, 0x74, 0x73, 0x20, 0x50, 0x74, 0x79,
-		0x20, 0x4c, 0x74, 0x64, 0x82, 0x09, 0x00, 0x85,
-		0xb0, 0xbb, 0xa4, 0x8a, 0x7f, 0xb8, 0xca, 0x30,
-		0x0c, 0x06, 0x03, 0x55, 0x1d, 0x13, 0x04, 0x05,
-		0x30, 0x03, 0x01, 0x01, 0xff, 0x30, 0x0d, 0x06,
-		0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01,
-		0x01, 0x05, 0x05, 0x00, 0x03, 0x81, 0x81, 0x00,
-		0x08, 0x6c, 0x45, 0x24, 0xc7, 0x6b, 0xb1, 0x59,
-		0xab, 0x0c, 0x52, 0xcc, 0xf2, 0xb0, 0x14, 0xd7,
-		0x87, 0x9d, 0x7a, 0x64, 0x75, 0xb5, 0x5a, 0x95,
-		0x66, 0xe4, 0xc5, 0x2b, 0x8e, 0xae, 0x12, 0x66,
-		0x1f, 0xeb, 0x4f, 0x38, 0xb3, 0x6e, 0x60, 0xd3,
-		0x92, 0xfd, 0xf7, 0x41, 0x08, 0xb5, 0x25, 0x13,
-		0xb1, 0x18, 0x7a, 0x24, 0xfb, 0x30, 0x1d, 0xba,
-		0xed, 0x98, 0xb9, 0x17, 0xec, 0xe7, 0xd7, 0x31,
-		0x59, 0xdb, 0x95, 0xd3, 0x1d, 0x78, 0xea, 0x50,
-		0x56, 0x5c, 0xd5, 0x82, 0x5a, 0x2d, 0x5a, 0x5f,
-		0x33, 0xc4, 0xb6, 0xd8, 0xc9, 0x75, 0x90, 0x96,
-		0x8c, 0x0f, 0x52, 0x98, 0xb5, 0xcd, 0x98, 0x1f,
-		0x89, 0x20, 0x5f, 0xf2, 0xa0, 0x1c, 0xa3, 0x1b,
-		0x96, 0x94, 0xdd, 0xa9, 0xfd, 0x57, 0xe9, 0x70,
-		0xe8, 0x26, 0x6d, 0x71, 0x99, 0x9b, 0x26, 0x6e,
-		0x38, 0x50, 0x29, 0x6c, 0x90, 0xa7, 0xbd, 0xd9,
-		0x16, 0x03, 0x01, 0x00, 0x04, 0x0e, 0x00, 0x00,
-		0x00,
-	},
-	{
-		0x16, 0x03, 0x01, 0x00, 0x86, 0x10, 0x00, 0x00,
-		0x82, 0x00, 0x80, 0x51, 0x04, 0xf1, 0x7a, 0xbf,
-		0xe8, 0xa5, 0x86, 0x09, 0xa7, 0xf3, 0xcc, 0x93,
-		0x00, 0x10, 0x5b, 0xb8, 0xc1, 0x51, 0x0d, 0x5b,
-		0xcd, 0xed, 0x26, 0x01, 0x69, 0x73, 0xf4, 0x05,
-		0x8a, 0x6a, 0xc3, 0xb1, 0x9e, 0x84, 0x4e, 0x39,
-		0xcf, 0x5e, 0x55, 0xa9, 0x70, 0x19, 0x96, 0x91,
-		0xcd, 0x2c, 0x78, 0x3c, 0xa2, 0x6d, 0xb0, 0x49,
-		0x86, 0xf6, 0xd1, 0x3a, 0xde, 0x00, 0x4b, 0xa6,
-		0x25, 0xbf, 0x85, 0x39, 0xce, 0xb1, 0xcf, 0xbc,
-		0x16, 0xc7, 0x66, 0xac, 0xf8, 0xd2, 0x3b, 0xd1,
-		0xcc, 0x16, 0xac, 0x63, 0x3c, 0xbe, 0xd9, 0xb6,
-		0x6a, 0xe4, 0x13, 0x8a, 0xf4, 0x56, 0x2f, 0x92,
-		0x54, 0xd8, 0xf0, 0x84, 0x01, 0x32, 0x1a, 0xa9,
-		0x2d, 0xaf, 0x82, 0x0e, 0x00, 0xfa, 0x07, 0x88,
-		0xd9, 0x87, 0xe7, 0xdc, 0x9e, 0xe9, 0x72, 0x49,
-		0xb8, 0xfa, 0x8c, 0x7b, 0x07, 0x0b, 0x03, 0x7c,
-		0x10, 0x8c, 0x8a, 0x14, 0x03, 0x01, 0x00, 0x01,
-		0x01, 0x16, 0x03, 0x01, 0x00, 0xa8, 0x61, 0xa4,
-		0xf4, 0x5f, 0x8a, 0x1f, 0x5c, 0x92, 0x3f, 0x8c,
-		0xdb, 0xd6, 0x10, 0xcd, 0x9e, 0xe7, 0xf0, 0xc4,
-		0x3c, 0xb6, 0x1c, 0x9a, 0x56, 0x73, 0x7f, 0xa6,
-		0x14, 0x24, 0xcb, 0x96, 0x1f, 0xe0, 0xaf, 0xcd,
-		0x3c, 0x66, 0x43, 0xb7, 0x37, 0x65, 0x34, 0x47,
-		0xf8, 0x43, 0xf1, 0xcc, 0x15, 0xb8, 0xdc, 0x35,
-		0xe0, 0xa4, 0x2d, 0x78, 0x94, 0xe0, 0x02, 0xf3,
-		0x76, 0x46, 0xf7, 0x9b, 0x8d, 0x0d, 0x5d, 0x0b,
-		0xd3, 0xdd, 0x9a, 0x9e, 0x62, 0x2e, 0xc5, 0x98,
-		0x75, 0x63, 0x0c, 0xbf, 0x8e, 0x49, 0x33, 0x23,
-		0x7c, 0x00, 0xcf, 0xfb, 0xcf, 0xba, 0x0f, 0x41,
-		0x39, 0x89, 0xb9, 0xcc, 0x59, 0xd0, 0x2b, 0xb6,
-		0xec, 0x04, 0xe2, 0xc0, 0x52, 0xc7, 0xcf, 0x71,
-		0x47, 0xff, 0x70, 0x7e, 0xa9, 0xbd, 0x1c, 0xdd,
-		0x17, 0xa5, 0x6c, 0xb7, 0x10, 0x4f, 0x42, 0x18,
-		0x37, 0x69, 0xa9, 0xd2, 0xb3, 0x18, 0x84, 0x92,
-		0xa7, 0x47, 0x21, 0xf6, 0x95, 0x63, 0x29, 0xd6,
-		0xa5, 0xb6, 0xda, 0x65, 0x67, 0x69, 0xc4, 0x26,
-		0xac, 0x8b, 0x08, 0x58, 0xdd, 0x3c, 0x31, 0x20,
-		0xd5, 0x0c, 0x88, 0x72, 0x18, 0x16, 0x88, 0x1e,
-		0x4a, 0x0f, 0xe1, 0xcf, 0x95, 0x24,
-	},
-	{
-		0x16, 0x03, 0x01, 0x00, 0x72, 0x04, 0x00, 0x00,
-		0x6e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x68, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x65,
-		0xe8, 0x4b, 0xde, 0xef, 0xba, 0x3e, 0x18, 0x1c,
-		0x1e, 0x5e, 0xbc, 0x87, 0xf1, 0x87, 0x8d, 0x72,
-		0xe3, 0xbe, 0x0f, 0xdf, 0xfd, 0xd0, 0xb2, 0x89,
-		0xf8, 0x05, 0x9a, 0x52, 0x47, 0x77, 0x9e, 0xe8,
-		0xb1, 0x1d, 0x18, 0xed, 0x6a, 0x4b, 0x63, 0x1d,
-		0xf1, 0x62, 0xd2, 0x65, 0x21, 0x26, 0x73, 0xd4,
-		0x35, 0x5b, 0x95, 0x89, 0x12, 0x59, 0x23, 0x8c,
-		0xc3, 0xfc, 0xf9, 0x4d, 0x21, 0x79, 0xa0, 0xbd,
-		0xff, 0x33, 0xa2, 0x3d, 0x0b, 0x6f, 0x89, 0xc9,
-		0x23, 0xe4, 0xe7, 0x9f, 0x1d, 0x98, 0xf6, 0xed,
-		0x02, 0x8d, 0xac, 0x1a, 0xf9, 0xcb, 0xa5, 0x14,
-		0x03, 0x01, 0x00, 0x01, 0x01, 0x16, 0x03, 0x01,
-		0x00, 0x28, 0x91, 0x56, 0x80, 0xe2, 0x6d, 0x51,
-		0x88, 0x03, 0xf8, 0x49, 0xe6, 0x6a, 0x5a, 0xfb,
-		0x2f, 0x0b, 0xb5, 0xa1, 0x0d, 0x63, 0x83, 0xae,
-		0xb9, 0xbc, 0x05, 0xf0, 0x81, 0x00, 0x61, 0x83,
-		0x38, 0xda, 0x14, 0xf6, 0xea, 0xd8, 0x78, 0x65,
-		0xc7, 0x26, 0x17, 0x03, 0x01, 0x00, 0x18, 0x81,
-		0x30, 0x8b, 0x22, 0x5a, 0xd3, 0x7f, 0xc8, 0xf2,
-		0x8a, 0x6b, 0xa3, 0xba, 0x4d, 0xe7, 0x6e, 0xd2,
-		0xfd, 0xbf, 0xf2, 0xc5, 0x28, 0xa0, 0x62, 0x17,
-		0x03, 0x01, 0x00, 0x28, 0x17, 0x83, 0x3c, 0x78,
-		0x18, 0xfa, 0x8d, 0x58, 0x5c, 0xaa, 0x05, 0x7d,
-		0x67, 0x96, 0x11, 0x60, 0x11, 0xc0, 0x1e, 0x0d,
-		0x6a, 0x6e, 0x5f, 0x1d, 0x98, 0x4b, 0xff, 0x82,
-		0xee, 0x21, 0x06, 0x29, 0xd3, 0x8b, 0x80, 0x78,
-		0x39, 0x05, 0x34, 0x9b, 0x15, 0x03, 0x01, 0x00,
-		0x18, 0xa9, 0x38, 0x18, 0x4f, 0x9d, 0x84, 0x75,
-		0x88, 0x53, 0xd6, 0x85, 0xc2, 0x15, 0x4b, 0xe3,
-		0xe3, 0x35, 0x9a, 0x74, 0xc9, 0x3e, 0x13, 0xc1,
-		0x8c,
-	},
+func TestHandshakeServerRSAAES(t *testing.T) {
+	test := &serverTest{
+		name:    "RSA-AES",
+		command: []string{"openssl", "s_client", "-no_ticket", "-cipher", "AES128-SHA"},
+	}
+	runServerTestSSLv3(t, test)
+	runServerTestTLS10(t, test)
+	runServerTestTLS12(t, test)
 }
 
-var rsaAESServerScript = [][]byte{
-	{
-		0x16, 0x03, 0x00, 0x00, 0xc5, 0x01, 0x00, 0x00,
-		0xc1, 0x03, 0x03, 0x50, 0xae, 0x5c, 0xe9, 0x5e,
-		0x31, 0x93, 0x82, 0xa5, 0x6f, 0x51, 0x82, 0xc8,
-		0x55, 0x4f, 0x1f, 0x2e, 0x90, 0x98, 0x81, 0x13,
-		0x27, 0x80, 0x68, 0xb4, 0x2d, 0xba, 0x3a, 0x76,
-		0xd8, 0xd7, 0x2c, 0x00, 0x00, 0x50, 0xc0, 0x09,
-		0xc0, 0x23, 0xc0, 0x2b, 0xc0, 0x0a, 0xc0, 0x24,
-		0xc0, 0x2c, 0xc0, 0x08, 0xc0, 0x13, 0xc0, 0x27,
-		0xc0, 0x2f, 0xc0, 0x14, 0xc0, 0x30, 0xc0, 0x12,
-		0x00, 0x33, 0x00, 0x67, 0x00, 0x45, 0x00, 0x9e,
-		0x00, 0x39, 0x00, 0x6b, 0x00, 0x88, 0x00, 0x16,
-		0x00, 0x32, 0x00, 0x40, 0x00, 0x44, 0x00, 0xa2,
-		0x00, 0x38, 0x00, 0x6a, 0x00, 0x87, 0x00, 0x13,
-		0x00, 0x66, 0x00, 0x2f, 0x00, 0x3c, 0x00, 0x41,
-		0x00, 0x9c, 0x00, 0x35, 0x00, 0x3d, 0x00, 0x84,
-		0x00, 0x0a, 0x00, 0x05, 0x00, 0x04, 0x01, 0x00,
-		0x00, 0x48, 0x00, 0x05, 0x00, 0x05, 0x01, 0x00,
-		0x00, 0x00, 0x00, 0xff, 0x01, 0x00, 0x01, 0x00,
-		0x00, 0x23, 0x00, 0x00, 0x00, 0x0a, 0x00, 0x0c,
-		0x00, 0x0a, 0x00, 0x13, 0x00, 0x15, 0x00, 0x17,
-		0x00, 0x18, 0x00, 0x19, 0x00, 0x0b, 0x00, 0x02,
-		0x01, 0x00, 0x00, 0x0d, 0x00, 0x1c, 0x00, 0x1a,
-		0x04, 0x01, 0x04, 0x02, 0x04, 0x03, 0x05, 0x01,
-		0x05, 0x03, 0x06, 0x01, 0x06, 0x03, 0x03, 0x01,
-		0x03, 0x02, 0x03, 0x03, 0x02, 0x01, 0x02, 0x02,
-		0x02, 0x03,
-	},
-	{
-		0x16, 0x03, 0x01, 0x00, 0x30, 0x02, 0x00, 0x00,
-		0x2c, 0x03, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x2f, 0x00, 0x00,
-		0x04, 0x00, 0x23, 0x00, 0x00, 0x16, 0x03, 0x01,
-		0x02, 0xbe, 0x0b, 0x00, 0x02, 0xba, 0x00, 0x02,
-		0xb7, 0x00, 0x02, 0xb4, 0x30, 0x82, 0x02, 0xb0,
-		0x30, 0x82, 0x02, 0x19, 0xa0, 0x03, 0x02, 0x01,
-		0x02, 0x02, 0x09, 0x00, 0x85, 0xb0, 0xbb, 0xa4,
-		0x8a, 0x7f, 0xb8, 0xca, 0x30, 0x0d, 0x06, 0x09,
-		0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01,
-		0x05, 0x05, 0x00, 0x30, 0x45, 0x31, 0x0b, 0x30,
-		0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02,
-		0x41, 0x55, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03,
-		0x55, 0x04, 0x08, 0x13, 0x0a, 0x53, 0x6f, 0x6d,
-		0x65, 0x2d, 0x53, 0x74, 0x61, 0x74, 0x65, 0x31,
-		0x21, 0x30, 0x1f, 0x06, 0x03, 0x55, 0x04, 0x0a,
-		0x13, 0x18, 0x49, 0x6e, 0x74, 0x65, 0x72, 0x6e,
-		0x65, 0x74, 0x20, 0x57, 0x69, 0x64, 0x67, 0x69,
-		0x74, 0x73, 0x20, 0x50, 0x74, 0x79, 0x20, 0x4c,
-		0x74, 0x64, 0x30, 0x1e, 0x17, 0x0d, 0x31, 0x30,
-		0x30, 0x34, 0x32, 0x34, 0x30, 0x39, 0x30, 0x39,
-		0x33, 0x38, 0x5a, 0x17, 0x0d, 0x31, 0x31, 0x30,
-		0x34, 0x32, 0x34, 0x30, 0x39, 0x30, 0x39, 0x33,
-		0x38, 0x5a, 0x30, 0x45, 0x31, 0x0b, 0x30, 0x09,
-		0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x41,
-		0x55, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03, 0x55,
-		0x04, 0x08, 0x13, 0x0a, 0x53, 0x6f, 0x6d, 0x65,
-		0x2d, 0x53, 0x74, 0x61, 0x74, 0x65, 0x31, 0x21,
-		0x30, 0x1f, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13,
-		0x18, 0x49, 0x6e, 0x74, 0x65, 0x72, 0x6e, 0x65,
-		0x74, 0x20, 0x57, 0x69, 0x64, 0x67, 0x69, 0x74,
-		0x73, 0x20, 0x50, 0x74, 0x79, 0x20, 0x4c, 0x74,
-		0x64, 0x30, 0x81, 0x9f, 0x30, 0x0d, 0x06, 0x09,
-		0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01,
-		0x01, 0x05, 0x00, 0x03, 0x81, 0x8d, 0x00, 0x30,
-		0x81, 0x89, 0x02, 0x81, 0x81, 0x00, 0xbb, 0x79,
-		0xd6, 0xf5, 0x17, 0xb5, 0xe5, 0xbf, 0x46, 0x10,
-		0xd0, 0xdc, 0x69, 0xbe, 0xe6, 0x2b, 0x07, 0x43,
-		0x5a, 0xd0, 0x03, 0x2d, 0x8a, 0x7a, 0x43, 0x85,
-		0xb7, 0x14, 0x52, 0xe7, 0xa5, 0x65, 0x4c, 0x2c,
-		0x78, 0xb8, 0x23, 0x8c, 0xb5, 0xb4, 0x82, 0xe5,
-		0xde, 0x1f, 0x95, 0x3b, 0x7e, 0x62, 0xa5, 0x2c,
-		0xa5, 0x33, 0xd6, 0xfe, 0x12, 0x5c, 0x7a, 0x56,
-		0xfc, 0xf5, 0x06, 0xbf, 0xfa, 0x58, 0x7b, 0x26,
-		0x3f, 0xb5, 0xcd, 0x04, 0xd3, 0xd0, 0xc9, 0x21,
-		0x96, 0x4a, 0xc7, 0xf4, 0x54, 0x9f, 0x5a, 0xbf,
-		0xef, 0x42, 0x71, 0x00, 0xfe, 0x18, 0x99, 0x07,
-		0x7f, 0x7e, 0x88, 0x7d, 0x7d, 0xf1, 0x04, 0x39,
-		0xc4, 0xa2, 0x2e, 0xdb, 0x51, 0xc9, 0x7c, 0xe3,
-		0xc0, 0x4c, 0x3b, 0x32, 0x66, 0x01, 0xcf, 0xaf,
-		0xb1, 0x1d, 0xb8, 0x71, 0x9a, 0x1d, 0xdb, 0xdb,
-		0x89, 0x6b, 0xae, 0xda, 0x2d, 0x79, 0x02, 0x03,
-		0x01, 0x00, 0x01, 0xa3, 0x81, 0xa7, 0x30, 0x81,
-		0xa4, 0x30, 0x1d, 0x06, 0x03, 0x55, 0x1d, 0x0e,
-		0x04, 0x16, 0x04, 0x14, 0xb1, 0xad, 0xe2, 0x85,
-		0x5a, 0xcf, 0xcb, 0x28, 0xdb, 0x69, 0xce, 0x23,
-		0x69, 0xde, 0xd3, 0x26, 0x8e, 0x18, 0x88, 0x39,
-		0x30, 0x75, 0x06, 0x03, 0x55, 0x1d, 0x23, 0x04,
-		0x6e, 0x30, 0x6c, 0x80, 0x14, 0xb1, 0xad, 0xe2,
-		0x85, 0x5a, 0xcf, 0xcb, 0x28, 0xdb, 0x69, 0xce,
-		0x23, 0x69, 0xde, 0xd3, 0x26, 0x8e, 0x18, 0x88,
-		0x39, 0xa1, 0x49, 0xa4, 0x47, 0x30, 0x45, 0x31,
-		0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06,
-		0x13, 0x02, 0x41, 0x55, 0x31, 0x13, 0x30, 0x11,
-		0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0a, 0x53,
-		0x6f, 0x6d, 0x65, 0x2d, 0x53, 0x74, 0x61, 0x74,
-		0x65, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x03, 0x55,
-		0x04, 0x0a, 0x13, 0x18, 0x49, 0x6e, 0x74, 0x65,
-		0x72, 0x6e, 0x65, 0x74, 0x20, 0x57, 0x69, 0x64,
-		0x67, 0x69, 0x74, 0x73, 0x20, 0x50, 0x74, 0x79,
-		0x20, 0x4c, 0x74, 0x64, 0x82, 0x09, 0x00, 0x85,
-		0xb0, 0xbb, 0xa4, 0x8a, 0x7f, 0xb8, 0xca, 0x30,
-		0x0c, 0x06, 0x03, 0x55, 0x1d, 0x13, 0x04, 0x05,
-		0x30, 0x03, 0x01, 0x01, 0xff, 0x30, 0x0d, 0x06,
-		0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01,
-		0x01, 0x05, 0x05, 0x00, 0x03, 0x81, 0x81, 0x00,
-		0x08, 0x6c, 0x45, 0x24, 0xc7, 0x6b, 0xb1, 0x59,
-		0xab, 0x0c, 0x52, 0xcc, 0xf2, 0xb0, 0x14, 0xd7,
-		0x87, 0x9d, 0x7a, 0x64, 0x75, 0xb5, 0x5a, 0x95,
-		0x66, 0xe4, 0xc5, 0x2b, 0x8e, 0xae, 0x12, 0x66,
-		0x1f, 0xeb, 0x4f, 0x38, 0xb3, 0x6e, 0x60, 0xd3,
-		0x92, 0xfd, 0xf7, 0x41, 0x08, 0xb5, 0x25, 0x13,
-		0xb1, 0x18, 0x7a, 0x24, 0xfb, 0x30, 0x1d, 0xba,
-		0xed, 0x98, 0xb9, 0x17, 0xec, 0xe7, 0xd7, 0x31,
-		0x59, 0xdb, 0x95, 0xd3, 0x1d, 0x78, 0xea, 0x50,
-		0x56, 0x5c, 0xd5, 0x82, 0x5a, 0x2d, 0x5a, 0x5f,
-		0x33, 0xc4, 0xb6, 0xd8, 0xc9, 0x75, 0x90, 0x96,
-		0x8c, 0x0f, 0x52, 0x98, 0xb5, 0xcd, 0x98, 0x1f,
-		0x89, 0x20, 0x5f, 0xf2, 0xa0, 0x1c, 0xa3, 0x1b,
-		0x96, 0x94, 0xdd, 0xa9, 0xfd, 0x57, 0xe9, 0x70,
-		0xe8, 0x26, 0x6d, 0x71, 0x99, 0x9b, 0x26, 0x6e,
-		0x38, 0x50, 0x29, 0x6c, 0x90, 0xa7, 0xbd, 0xd9,
-		0x16, 0x03, 0x01, 0x00, 0x04, 0x0e, 0x00, 0x00,
-		0x00,
-	},
-	{
-		0x16, 0x03, 0x01, 0x00, 0x86, 0x10, 0x00, 0x00,
-		0x82, 0x00, 0x80, 0x51, 0x2e, 0xec, 0x0d, 0x86,
-		0xf3, 0x9f, 0xf2, 0x77, 0x04, 0x27, 0x2b, 0x0e,
-		0x9c, 0xab, 0x35, 0x84, 0x65, 0xff, 0x36, 0xef,
-		0xc0, 0x08, 0xc9, 0x1d, 0x9f, 0x29, 0xae, 0x8d,
-		0xc5, 0x66, 0x81, 0x31, 0x92, 0x5e, 0x3d, 0xac,
-		0xaa, 0x37, 0x28, 0x2c, 0x06, 0x91, 0xa6, 0xc2,
-		0xd0, 0x83, 0x34, 0x24, 0x1c, 0x88, 0xfc, 0x0a,
-		0xcf, 0xbf, 0xc2, 0x94, 0xe2, 0xed, 0xa7, 0x6a,
-		0xa8, 0x8d, 0x3d, 0xf7, 0x06, 0x7d, 0x69, 0xf8,
-		0x0d, 0xb2, 0xf7, 0xe4, 0x45, 0xcb, 0x0a, 0x25,
-		0xcb, 0xb2, 0x2e, 0x38, 0x9a, 0x84, 0x75, 0xe8,
-		0xe1, 0x42, 0x39, 0xa2, 0x18, 0x0e, 0x48, 0xca,
-		0x33, 0x16, 0x4e, 0xf6, 0x2f, 0xec, 0x07, 0xe7,
-		0x57, 0xe1, 0x20, 0x40, 0x40, 0x6d, 0x4e, 0x29,
-		0x04, 0x1a, 0x8c, 0x99, 0xfb, 0x19, 0x3c, 0xaa,
-		0x75, 0x64, 0xd3, 0xa6, 0xe6, 0xed, 0x3f, 0x5a,
-		0xd2, 0xc9, 0x80, 0x14, 0x03, 0x01, 0x00, 0x01,
-		0x01, 0x16, 0x03, 0x01, 0x01, 0x10, 0xe9, 0x9e,
-		0x06, 0x92, 0x18, 0xbf, 0x5e, 0xaf, 0x33, 0xc1,
-		0xbf, 0x0e, 0x12, 0x07, 0x48, 0x4f, 0x6b, 0x6c,
-		0xf5, 0x23, 0x5e, 0x87, 0xa7, 0xd3, 0x50, 0x79,
-		0x38, 0xdc, 0xe0, 0x49, 0xd3, 0x81, 0x21, 0x12,
-		0xd0, 0x3d, 0x9a, 0xfb, 0x83, 0xc1, 0x8b, 0xfc,
-		0x14, 0xd5, 0xd5, 0xa7, 0xa3, 0x34, 0x14, 0x71,
-		0xbe, 0xea, 0x37, 0x18, 0x12, 0x7f, 0x41, 0xfb,
-		0xc5, 0x51, 0x17, 0x9d, 0x96, 0x58, 0x14, 0xfb,
-		0x4f, 0xd7, 0xd3, 0x15, 0x0f, 0xec, 0x5a, 0x0d,
-		0x35, 0xbb, 0x3c, 0x81, 0x5b, 0x3f, 0xdf, 0x52,
-		0xa4, 0x4c, 0xcd, 0x13, 0xe1, 0x10, 0x37, 0x34,
-		0xbf, 0xb4, 0x80, 0x1e, 0x8d, 0xe2, 0xc3, 0x7a,
-		0x0f, 0x7b, 0x7d, 0x23, 0xeb, 0xd0, 0x99, 0x69,
-		0xad, 0x0a, 0x2d, 0xb3, 0x6c, 0xd6, 0x80, 0x11,
-		0x7f, 0x6c, 0xed, 0x1b, 0xcd, 0x08, 0x22, 0x56,
-		0x90, 0x0e, 0xa4, 0xc3, 0x29, 0x33, 0x96, 0x30,
-		0x34, 0x94, 0xa1, 0xeb, 0x9c, 0x1b, 0x5a, 0xd1,
-		0x03, 0x61, 0xf9, 0xdd, 0xf3, 0x64, 0x8a, 0xfd,
-		0x5f, 0x44, 0xdb, 0x2e, 0xa7, 0xfd, 0xe1, 0x1a,
-		0x66, 0xc5, 0x01, 0x9c, 0xc7, 0xd1, 0xc4, 0xd3,
-		0xea, 0x14, 0x3c, 0xed, 0x74, 0xbb, 0x1b, 0x97,
-		0x8f, 0xf1, 0x29, 0x39, 0x33, 0x92, 0x93, 0x4e,
-		0xf5, 0x87, 0x91, 0x61, 0x65, 0x8d, 0x27, 0x8d,
-		0x76, 0xc1, 0xfa, 0x6a, 0x99, 0x80, 0xb1, 0x9b,
-		0x29, 0x53, 0xce, 0x3e, 0xb6, 0x9a, 0xce, 0x3c,
-		0x19, 0x5e, 0x48, 0x83, 0xaa, 0xa7, 0x66, 0x98,
-		0x59, 0xf4, 0xbb, 0xf2, 0xbc, 0xd9, 0xc5, 0x9a,
-		0xc8, 0x2c, 0x63, 0x58, 0xd5, 0xd4, 0xbc, 0x03,
-		0xa9, 0x06, 0xa9, 0x80, 0x0d, 0xb3, 0x46, 0x2d,
-		0xe3, 0xc6, 0xaf, 0x1a, 0x39, 0x18, 0x7e, 0x1e,
-		0x83, 0x80, 0x46, 0x11, 0xd2, 0x13, 0x9f, 0xda,
-		0xfc, 0x2d, 0x42, 0xaa, 0x5a, 0x1d, 0x4c, 0x31,
-		0xe5, 0x58, 0x78, 0x5e, 0xe2, 0x04, 0xd6, 0x23,
-		0x7f, 0x3f, 0x06, 0xc0, 0x54, 0xf8,
-	},
-	{
-		0x16, 0x03, 0x01, 0x00, 0x72, 0x04, 0x00, 0x00,
-		0x6e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x68, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x65,
-		0xe8, 0x4b, 0xfb, 0xef, 0xba, 0xed, 0xc5, 0x36,
-		0xc8, 0x5a, 0x41, 0x3f, 0x05, 0xfa, 0xfe, 0x48,
-		0xc3, 0x91, 0x12, 0x8b, 0xe8, 0x32, 0x6a, 0x9f,
-		0xdc, 0x97, 0xe2, 0x77, 0xb9, 0x96, 0x2d, 0xd4,
-		0xe5, 0xbd, 0xa1, 0xfd, 0x94, 0xbb, 0x74, 0x63,
-		0xb1, 0x0c, 0x38, 0xbc, 0x6f, 0x69, 0xaf, 0xa3,
-		0x46, 0x9c, 0x96, 0x41, 0xde, 0x59, 0x23, 0xff,
-		0x15, 0x6b, 0x3a, 0xef, 0x91, 0x6d, 0x92, 0x44,
-		0xdc, 0x72, 0x1f, 0x40, 0x3d, 0xb5, 0x34, 0x8f,
-		0x2a, 0xac, 0x21, 0x69, 0x05, 0x6f, 0xb2, 0x60,
-		0x32, 0x5d, 0x3d, 0x97, 0xb4, 0x24, 0x99, 0x14,
-		0x03, 0x01, 0x00, 0x01, 0x01, 0x16, 0x03, 0x01,
-		0x00, 0x30, 0x68, 0x27, 0x97, 0xca, 0x63, 0x09,
-		0x22, 0xed, 0x0e, 0x61, 0x7c, 0x76, 0x31, 0x9c,
-		0xbe, 0x27, 0xc9, 0xe6, 0x09, 0xc3, 0xc3, 0xc2,
-		0xf4, 0xa2, 0x32, 0xba, 0x7c, 0xf2, 0x0f, 0xb8,
-		0x3d, 0xcb, 0xe2, 0x4c, 0xc0, 0x7d, 0x8e, 0x5b,
-		0x5a, 0xed, 0x05, 0x5c, 0x15, 0x96, 0x69, 0xc2,
-		0x6f, 0x5f, 0x17, 0x03, 0x01, 0x00, 0x20, 0x5a,
-		0xfe, 0x0b, 0xe1, 0x6f, 0xa8, 0x54, 0x19, 0x78,
-		0xca, 0xba, 0x2e, 0x1e, 0x2e, 0xe1, 0x5d, 0x17,
-		0xe5, 0x97, 0x05, 0x2c, 0x08, 0x0c, 0xff, 0xa8,
-		0x59, 0xa9, 0xde, 0x5e, 0x21, 0x34, 0x04, 0x17,
-		0x03, 0x01, 0x00, 0x30, 0x86, 0xb1, 0x3f, 0x88,
-		0x43, 0xf0, 0x07, 0xee, 0xa8, 0xf4, 0xbc, 0xe7,
-		0x5f, 0xc6, 0x8c, 0x86, 0x4c, 0xca, 0x70, 0x88,
-		0xcc, 0x6a, 0xb4, 0x3d, 0x40, 0xe8, 0x54, 0x89,
-		0x19, 0x43, 0x1f, 0x76, 0xe2, 0xac, 0xb2, 0x5b,
-		0x92, 0xf8, 0x57, 0x39, 0x2a, 0xc3, 0x6d, 0x13,
-		0x45, 0xfa, 0x36, 0x9e, 0x15, 0x03, 0x01, 0x00,
-		0x20, 0x6d, 0xed, 0x7b, 0x59, 0x28, 0x2a, 0x27,
-		0x04, 0x15, 0x07, 0x4e, 0xeb, 0x13, 0x00, 0xe3,
-		0x3a, 0x3f, 0xf8, 0xaa, 0x2b, 0x3b, 0x1a, 0x8c,
-		0x12, 0xd6, 0x4c, 0xec, 0x2a, 0xaf, 0x33, 0x60,
-		0xaf,
-	},
+func TestHandshakeServerAESGCM(t *testing.T) {
+	test := &serverTest{
+		name:    "RSA-AES-GCM",
+		command: []string{"openssl", "s_client", "-no_ticket", "-cipher", "ECDHE-RSA-AES128-GCM-SHA256"},
+	}
+	runServerTestTLS12(t, test)
 }
 
-// Generated using:
-// $ go test -test.run TestRunServer -serve -ciphersuites=0xc00a
-// $ openssl s_client -host 127.0.0.1 -port 10443 -cipher ECDHE-ECDSA-AES256-SHA
-var ecdheECDSAAESServerScript = [][]byte{
-	{
-		0x16, 0x03, 0x01, 0x00, 0xa0, 0x01, 0x00, 0x00,
-		0x9c, 0x03, 0x03, 0x50, 0xd7, 0x18, 0x31, 0x49,
-		0xde, 0x19, 0x8d, 0x08, 0x5c, 0x4b, 0x60, 0x67,
-		0x0f, 0xfe, 0xd0, 0x62, 0xf9, 0x31, 0x48, 0x17,
-		0x9e, 0x50, 0xc1, 0xd8, 0x35, 0x24, 0x0e, 0xa6,
-		0x09, 0x06, 0x51, 0x00, 0x00, 0x04, 0xc0, 0x0a,
-		0x00, 0xff, 0x01, 0x00, 0x00, 0x6f, 0x00, 0x0b,
-		0x00, 0x04, 0x03, 0x00, 0x01, 0x02, 0x00, 0x0a,
-		0x00, 0x34, 0x00, 0x32, 0x00, 0x0e, 0x00, 0x0d,
-		0x00, 0x19, 0x00, 0x0b, 0x00, 0x0c, 0x00, 0x18,
-		0x00, 0x09, 0x00, 0x0a, 0x00, 0x16, 0x00, 0x17,
-		0x00, 0x08, 0x00, 0x06, 0x00, 0x07, 0x00, 0x14,
-		0x00, 0x15, 0x00, 0x04, 0x00, 0x05, 0x00, 0x12,
-		0x00, 0x13, 0x00, 0x01, 0x00, 0x02, 0x00, 0x03,
-		0x00, 0x0f, 0x00, 0x10, 0x00, 0x11, 0x00, 0x23,
-		0x00, 0x00, 0x00, 0x0d, 0x00, 0x22, 0x00, 0x20,
-		0x06, 0x01, 0x06, 0x02, 0x06, 0x03, 0x05, 0x01,
-		0x05, 0x02, 0x05, 0x03, 0x04, 0x01, 0x04, 0x02,
-		0x04, 0x03, 0x03, 0x01, 0x03, 0x02, 0x03, 0x03,
-		0x02, 0x01, 0x02, 0x02, 0x02, 0x03, 0x01, 0x01,
-		0x00, 0x0f, 0x00, 0x01, 0x01,
-	},
-	{
-		0x16, 0x03, 0x01, 0x00, 0x30, 0x02, 0x00, 0x00,
-		0x2c, 0x03, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0xc0, 0x0a, 0x00, 0x00,
-		0x04, 0x00, 0x23, 0x00, 0x00, 0x16, 0x03, 0x01,
-		0x02, 0x0e, 0x0b, 0x00, 0x02, 0x0a, 0x00, 0x02,
-		0x07, 0x00, 0x02, 0x04, 0x30, 0x82, 0x02, 0x00,
-		0x30, 0x82, 0x01, 0x62, 0x02, 0x09, 0x00, 0xb8,
-		0xbf, 0x2d, 0x47, 0xa0, 0xd2, 0xeb, 0xf4, 0x30,
-		0x09, 0x06, 0x07, 0x2a, 0x86, 0x48, 0xce, 0x3d,
-		0x04, 0x01, 0x30, 0x45, 0x31, 0x0b, 0x30, 0x09,
-		0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x41,
-		0x55, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03, 0x55,
-		0x04, 0x08, 0x13, 0x0a, 0x53, 0x6f, 0x6d, 0x65,
-		0x2d, 0x53, 0x74, 0x61, 0x74, 0x65, 0x31, 0x21,
-		0x30, 0x1f, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13,
-		0x18, 0x49, 0x6e, 0x74, 0x65, 0x72, 0x6e, 0x65,
-		0x74, 0x20, 0x57, 0x69, 0x64, 0x67, 0x69, 0x74,
-		0x73, 0x20, 0x50, 0x74, 0x79, 0x20, 0x4c, 0x74,
-		0x64, 0x30, 0x1e, 0x17, 0x0d, 0x31, 0x32, 0x31,
-		0x31, 0x32, 0x32, 0x31, 0x35, 0x30, 0x36, 0x33,
-		0x32, 0x5a, 0x17, 0x0d, 0x32, 0x32, 0x31, 0x31,
-		0x32, 0x30, 0x31, 0x35, 0x30, 0x36, 0x33, 0x32,
-		0x5a, 0x30, 0x45, 0x31, 0x0b, 0x30, 0x09, 0x06,
-		0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x41, 0x55,
-		0x31, 0x13, 0x30, 0x11, 0x06, 0x03, 0x55, 0x04,
-		0x08, 0x13, 0x0a, 0x53, 0x6f, 0x6d, 0x65, 0x2d,
-		0x53, 0x74, 0x61, 0x74, 0x65, 0x31, 0x21, 0x30,
-		0x1f, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13, 0x18,
-		0x49, 0x6e, 0x74, 0x65, 0x72, 0x6e, 0x65, 0x74,
-		0x20, 0x57, 0x69, 0x64, 0x67, 0x69, 0x74, 0x73,
-		0x20, 0x50, 0x74, 0x79, 0x20, 0x4c, 0x74, 0x64,
-		0x30, 0x81, 0x9b, 0x30, 0x10, 0x06, 0x07, 0x2a,
-		0x86, 0x48, 0xce, 0x3d, 0x02, 0x01, 0x06, 0x05,
-		0x2b, 0x81, 0x04, 0x00, 0x23, 0x03, 0x81, 0x86,
-		0x00, 0x04, 0x00, 0xc4, 0xa1, 0xed, 0xbe, 0x98,
-		0xf9, 0x0b, 0x48, 0x73, 0x36, 0x7e, 0xc3, 0x16,
-		0x56, 0x11, 0x22, 0xf2, 0x3d, 0x53, 0xc3, 0x3b,
-		0x4d, 0x21, 0x3d, 0xcd, 0x6b, 0x75, 0xe6, 0xf6,
-		0xb0, 0xdc, 0x9a, 0xdf, 0x26, 0xc1, 0xbc, 0xb2,
-		0x87, 0xf0, 0x72, 0x32, 0x7c, 0xb3, 0x64, 0x2f,
-		0x1c, 0x90, 0xbc, 0xea, 0x68, 0x23, 0x10, 0x7e,
-		0xfe, 0xe3, 0x25, 0xc0, 0x48, 0x3a, 0x69, 0xe0,
-		0x28, 0x6d, 0xd3, 0x37, 0x00, 0xef, 0x04, 0x62,
-		0xdd, 0x0d, 0xa0, 0x9c, 0x70, 0x62, 0x83, 0xd8,
-		0x81, 0xd3, 0x64, 0x31, 0xaa, 0x9e, 0x97, 0x31,
-		0xbd, 0x96, 0xb0, 0x68, 0xc0, 0x9b, 0x23, 0xde,
-		0x76, 0x64, 0x3f, 0x1a, 0x5c, 0x7f, 0xe9, 0x12,
-		0x0e, 0x58, 0x58, 0xb6, 0x5f, 0x70, 0xdd, 0x9b,
-		0xd8, 0xea, 0xd5, 0xd7, 0xf5, 0xd5, 0xcc, 0xb9,
-		0xb6, 0x9f, 0x30, 0x66, 0x5b, 0x66, 0x9a, 0x20,
-		0xe2, 0x27, 0xe5, 0xbf, 0xfe, 0x3b, 0x30, 0x09,
-		0x06, 0x07, 0x2a, 0x86, 0x48, 0xce, 0x3d, 0x04,
-		0x01, 0x03, 0x81, 0x8c, 0x00, 0x30, 0x81, 0x88,
-		0x02, 0x42, 0x01, 0x88, 0xa2, 0x4f, 0xeb, 0xe2,
-		0x45, 0xc5, 0x48, 0x7d, 0x1b, 0xac, 0xf5, 0xed,
-		0x98, 0x9d, 0xae, 0x47, 0x70, 0xc0, 0x5e, 0x1b,
-		0xb6, 0x2f, 0xbd, 0xf1, 0xb6, 0x4d, 0xb7, 0x61,
-		0x40, 0xd3, 0x11, 0xa2, 0xce, 0xee, 0x0b, 0x7e,
-		0x92, 0x7e, 0xff, 0x76, 0x9d, 0xc3, 0x3b, 0x7e,
-		0xa5, 0x3f, 0xce, 0xfa, 0x10, 0xe2, 0x59, 0xec,
-		0x47, 0x2d, 0x7c, 0xac, 0xda, 0x4e, 0x97, 0x0e,
-		0x15, 0xa0, 0x6f, 0xd0, 0x02, 0x42, 0x01, 0x4d,
-		0xfc, 0xbe, 0x67, 0x13, 0x9c, 0x2d, 0x05, 0x0e,
-		0xbd, 0x3f, 0xa3, 0x8c, 0x25, 0xc1, 0x33, 0x13,
-		0x83, 0x0d, 0x94, 0x06, 0xbb, 0xd4, 0x37, 0x7a,
-		0xf6, 0xec, 0x7a, 0xc9, 0x86, 0x2e, 0xdd, 0xd7,
-		0x11, 0x69, 0x7f, 0x85, 0x7c, 0x56, 0xde, 0xfb,
-		0x31, 0x78, 0x2b, 0xe4, 0xc7, 0x78, 0x0d, 0xae,
-		0xcb, 0xbe, 0x9e, 0x4e, 0x36, 0x24, 0x31, 0x7b,
-		0x6a, 0x0f, 0x39, 0x95, 0x12, 0x07, 0x8f, 0x2a,
-		0x16, 0x03, 0x01, 0x01, 0x1a, 0x0c, 0x00, 0x01,
-		0x16, 0x03, 0x00, 0x19, 0x85, 0x04, 0x01, 0x39,
-		0xdc, 0xee, 0x44, 0x17, 0x5e, 0xdb, 0xd7, 0x27,
-		0xaf, 0xb6, 0x56, 0xd9, 0xb4, 0x43, 0x5a, 0x99,
-		0xcf, 0xaa, 0x31, 0x37, 0x0c, 0x6f, 0x3a, 0xa0,
-		0xf8, 0x53, 0xc4, 0x74, 0xd1, 0x91, 0x0a, 0x46,
-		0xf5, 0x38, 0x3b, 0x5c, 0x09, 0xd8, 0x97, 0xdc,
-		0x4b, 0xaa, 0x70, 0x26, 0x48, 0xf2, 0xd6, 0x0b,
-		0x31, 0xc9, 0xf8, 0xd4, 0x98, 0x43, 0xe1, 0x6c,
-		0xd5, 0xc7, 0xb2, 0x8e, 0x0b, 0x01, 0xe6, 0xb6,
-		0x00, 0x28, 0x80, 0x7b, 0xfc, 0x96, 0x8f, 0x0d,
-		0xa2, 0x4f, 0xb0, 0x79, 0xaf, 0xdc, 0x61, 0x28,
-		0x63, 0x33, 0x78, 0xf6, 0x31, 0x39, 0xfd, 0x8a,
-		0xf4, 0x15, 0x18, 0x11, 0xfe, 0xdb, 0xd5, 0x07,
-		0xda, 0x2c, 0xed, 0x49, 0xa0, 0x23, 0xbf, 0xd0,
-		0x3a, 0x38, 0x1d, 0x54, 0xae, 0x1c, 0x7b, 0xea,
-		0x29, 0xee, 0xd0, 0x38, 0xc1, 0x76, 0xa7, 0x7f,
-		0x2a, 0xf4, 0xce, 0x1e, 0xac, 0xcc, 0x94, 0x79,
-		0x90, 0x33, 0x00, 0x8b, 0x30, 0x81, 0x88, 0x02,
-		0x42, 0x00, 0xc6, 0x85, 0x8e, 0x06, 0xb7, 0x04,
-		0x04, 0xe9, 0xcd, 0x9e, 0x3e, 0xcb, 0x66, 0x23,
-		0x95, 0xb4, 0x42, 0x9c, 0x64, 0x81, 0x39, 0x05,
-		0x3f, 0xb5, 0x21, 0xf8, 0x28, 0xaf, 0x60, 0x6b,
-		0x4d, 0x3d, 0xba, 0xa1, 0x4b, 0x5e, 0x77, 0xef,
-		0xe7, 0x59, 0x28, 0xfe, 0x1d, 0xc1, 0x27, 0xa2,
-		0xff, 0xa8, 0xde, 0x33, 0x48, 0xb3, 0xc1, 0x85,
-		0x6a, 0x42, 0x9b, 0xf9, 0x7e, 0x7e, 0x31, 0xc2,
-		0xe5, 0xbd, 0x66, 0x02, 0x42, 0x00, 0xad, 0x7d,
-		0x06, 0x35, 0xab, 0xec, 0x8d, 0xac, 0xd4, 0xba,
-		0x1b, 0x49, 0x5e, 0x05, 0x5f, 0xf0, 0x97, 0x93,
-		0x82, 0xb8, 0x2b, 0x8d, 0x91, 0x98, 0x63, 0x8e,
-		0xb4, 0x14, 0x62, 0xdb, 0x1e, 0xc9, 0x2b, 0x30,
-		0xf8, 0x41, 0x9b, 0xa6, 0xe6, 0xbc, 0xde, 0x0e,
-		0x68, 0x30, 0x22, 0x50, 0xe6, 0x98, 0x97, 0x7b,
-		0x69, 0xf7, 0x93, 0xed, 0xcd, 0x19, 0x2f, 0x44,
-		0x6c, 0x2e, 0xdf, 0x25, 0xee, 0xcc, 0x46, 0x16,
-		0x03, 0x01, 0x00, 0x04, 0x0e, 0x00, 0x00, 0x00,
-	},
-	{
-		0x16, 0x03, 0x01, 0x00, 0x8a, 0x10, 0x00, 0x00,
-		0x86, 0x85, 0x04, 0x00, 0x1c, 0xc5, 0xe8, 0xb3,
-		0x42, 0xb4, 0xad, 0xca, 0x45, 0xcd, 0x42, 0x7b,
-		0xfb, 0x0c, 0xea, 0x32, 0x26, 0xd4, 0x8a, 0xef,
-		0xdf, 0xc9, 0xff, 0xd2, 0xe0, 0x36, 0xea, 0x4e,
-		0xbb, 0x3e, 0xf4, 0x9c, 0x76, 0x4f, 0x44, 0xbd,
-		0x84, 0x72, 0xdd, 0xcb, 0xe5, 0x28, 0x8d, 0x31,
-		0x72, 0x3b, 0xd3, 0xf2, 0x9a, 0x13, 0xfb, 0x8a,
-		0xa7, 0x72, 0xca, 0x21, 0x6c, 0xea, 0xbf, 0xe9,
-		0x8c, 0x0a, 0xcc, 0x8f, 0xd6, 0x00, 0x20, 0x87,
-		0xf3, 0x7d, 0x18, 0xc5, 0xfd, 0x9e, 0xdd, 0x6b,
-		0x06, 0xdc, 0x52, 0xeb, 0x14, 0xc0, 0x67, 0x5a,
-		0x06, 0xd8, 0x98, 0x19, 0x14, 0xe7, 0xd4, 0x36,
-		0x32, 0xee, 0xb7, 0xfa, 0xe2, 0x85, 0x4a, 0x16,
-		0x42, 0x0c, 0xa6, 0x21, 0xcf, 0x1f, 0xae, 0x10,
-		0x8b, 0x28, 0x32, 0x19, 0xa4, 0x0a, 0xd7, 0xce,
-		0xe6, 0xe1, 0x93, 0xfb, 0x5f, 0x08, 0x8b, 0x42,
-		0xa2, 0x20, 0xed, 0x0d, 0x62, 0xca, 0xed, 0x14,
-		0x03, 0x01, 0x00, 0x01, 0x01, 0x16, 0x03, 0x01,
-		0x00, 0x30, 0x2e, 0x33, 0xc0, 0x57, 0x6c, 0xb4,
-		0x1b, 0xd2, 0x63, 0xe8, 0x67, 0x10, 0x2d, 0x87,
-		0x71, 0x6e, 0x19, 0x60, 0xf4, 0xa4, 0x10, 0x52,
-		0x73, 0x2d, 0x09, 0x5e, 0xdb, 0x6c, 0xdc, 0xcf,
-		0x2d, 0xff, 0x03, 0x11, 0x95, 0x76, 0x90, 0xd7,
-		0x87, 0x54, 0x43, 0xed, 0xc2, 0x36, 0x69, 0x14,
-		0x72, 0x4a,
-	},
-	{
-		0x16, 0x03, 0x01, 0x00, 0x72, 0x04, 0x00, 0x00,
-		0x6e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x68, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x65,
-		0xe8, 0x8b, 0xde, 0xef, 0xba, 0xc5, 0x7e, 0x04,
-		0xab, 0xfd, 0x79, 0x56, 0xf3, 0xe1, 0xa5, 0x3e,
-		0x02, 0xdf, 0x69, 0x6d, 0x1f, 0x41, 0x9f, 0xbc,
-		0x93, 0xe2, 0x6c, 0xf1, 0xb1, 0x38, 0xf5, 0x2b,
-		0x8c, 0x4c, 0xf4, 0x74, 0xe1, 0x79, 0x35, 0x34,
-		0x97, 0x9b, 0xd5, 0xba, 0xfd, 0xf7, 0x2f, 0x2d,
-		0x9e, 0x84, 0x54, 0xee, 0x77, 0x59, 0x23, 0x8f,
-		0xc8, 0x84, 0xb4, 0xd6, 0xea, 0x4c, 0x44, 0x8a,
-		0xc6, 0x9c, 0xf9, 0x9b, 0x27, 0xea, 0x4f, 0x28,
-		0x72, 0x33, 0x12, 0x20, 0x7c, 0xd7, 0x3f, 0x56,
-		0xa6, 0x76, 0xc7, 0x48, 0xe4, 0x2d, 0x6f, 0x14,
-		0x03, 0x01, 0x00, 0x01, 0x01, 0x16, 0x03, 0x01,
-		0x00, 0x30, 0x36, 0xe3, 0xd4, 0xf7, 0xb1, 0x69,
-		0x18, 0x8d, 0x09, 0xba, 0x52, 0x1e, 0xd5, 0x7d,
-		0x2c, 0x15, 0x3a, 0xd6, 0xe3, 0x99, 0x30, 0x2c,
-		0x99, 0x97, 0xbc, 0x19, 0x3c, 0x63, 0xa1, 0x25,
-		0x68, 0xbc, 0x8a, 0x16, 0x47, 0xec, 0xae, 0x13,
-		0xa4, 0x03, 0x96, 0x29, 0x11, 0x92, 0x90, 0x1a,
-		0xc8, 0xa4, 0x17, 0x03, 0x01, 0x00, 0x20, 0xc1,
-		0x10, 0x1d, 0xa6, 0xf1, 0xe2, 0x8a, 0xcc, 0x37,
-		0x7d, 0x8e, 0x05, 0x00, 0xfb, 0xd1, 0x9f, 0xc7,
-		0x11, 0xd2, 0x00, 0xb4, 0x27, 0x0a, 0x25, 0x14,
-		0xd9, 0x79, 0x1b, 0xcb, 0x4d, 0x81, 0x61, 0x17,
-		0x03, 0x01, 0x00, 0x30, 0x5c, 0x7c, 0x2d, 0xc0,
-		0x9e, 0xa6, 0xc4, 0x8e, 0xfd, 0xf4, 0xe2, 0xe5,
-		0xe4, 0xe6, 0x56, 0x9f, 0x7d, 0x4c, 0x4c, 0x2d,
-		0xb7, 0xa9, 0xac, 0xfa, 0x9f, 0x12, 0x7f, 0x2d,
-		0x30, 0x57, 0xe4, 0x8e, 0x30, 0x86, 0x65, 0x59,
-		0xcd, 0x24, 0xda, 0xe2, 0x8a, 0x7b, 0x0c, 0x5e,
-		0x86, 0x05, 0x06, 0x2a, 0x15, 0x03, 0x01, 0x00,
-		0x20, 0xd6, 0xb7, 0x70, 0xf8, 0x47, 0xbc, 0x0f,
-		0xf4, 0x66, 0x98, 0x1b, 0x1e, 0x8a, 0x8c, 0x0b,
-		0xa1, 0x4a, 0x04, 0x29, 0x60, 0x72, 0x8b, 0xc4,
-		0x73, 0xc1, 0xd6, 0x41, 0x72, 0xb7, 0x17, 0x39,
-		0xda,
-	},
-}
+func TestHandshakeServerECDHEECDSAAES(t *testing.T) {
+	config := *testConfig
+	config.Certificates = make([]Certificate, 1)
+	config.Certificates[0].Certificate = [][]byte{testECDSACertificate}
+	config.Certificates[0].PrivateKey = testECDSAPrivateKey
+	config.BuildNameToCertificate()
 
-var sslv3ServerScript = [][]byte{
-	{
-		0x16, 0x03, 0x00, 0x00, 0x54, 0x01, 0x00, 0x00,
-		0x50, 0x03, 0x00, 0x50, 0x77, 0x3d, 0x42, 0xae,
-		0x84, 0xbd, 0xc5, 0x07, 0xa5, 0xc4, 0xd6, 0x16,
-		0x4e, 0xd5, 0xc5, 0xfa, 0x02, 0x7a, 0x0f, 0x1d,
-		0xc1, 0xe1, 0xaa, 0xe3, 0x3b, 0x4b, 0x6f, 0x11,
-		0xfa, 0x1a, 0xa4, 0x00, 0x00, 0x28, 0x00, 0x39,
-		0x00, 0x38, 0x00, 0x35, 0x00, 0x16, 0x00, 0x13,
-		0x00, 0x0a, 0x00, 0x33, 0x00, 0x32, 0x00, 0x2f,
-		0x00, 0x05, 0x00, 0x04, 0x00, 0x15, 0x00, 0x12,
-		0x00, 0x09, 0x00, 0x14, 0x00, 0x11, 0x00, 0x08,
-		0x00, 0x06, 0x00, 0x03, 0x00, 0xff, 0x02, 0x01,
-		0x00,
-	},
-	{
-		0x16, 0x03, 0x00, 0x00, 0x2a, 0x02, 0x00, 0x00,
-		0x26, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x00, 0x16,
-		0x03, 0x00, 0x02, 0xbe, 0x0b, 0x00, 0x02, 0xba,
-		0x00, 0x02, 0xb7, 0x00, 0x02, 0xb4, 0x30, 0x82,
-		0x02, 0xb0, 0x30, 0x82, 0x02, 0x19, 0xa0, 0x03,
-		0x02, 0x01, 0x02, 0x02, 0x09, 0x00, 0x85, 0xb0,
-		0xbb, 0xa4, 0x8a, 0x7f, 0xb8, 0xca, 0x30, 0x0d,
-		0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d,
-		0x01, 0x01, 0x05, 0x05, 0x00, 0x30, 0x45, 0x31,
-		0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06,
-		0x13, 0x02, 0x41, 0x55, 0x31, 0x13, 0x30, 0x11,
-		0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0a, 0x53,
-		0x6f, 0x6d, 0x65, 0x2d, 0x53, 0x74, 0x61, 0x74,
-		0x65, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x03, 0x55,
-		0x04, 0x0a, 0x13, 0x18, 0x49, 0x6e, 0x74, 0x65,
-		0x72, 0x6e, 0x65, 0x74, 0x20, 0x57, 0x69, 0x64,
-		0x67, 0x69, 0x74, 0x73, 0x20, 0x50, 0x74, 0x79,
-		0x20, 0x4c, 0x74, 0x64, 0x30, 0x1e, 0x17, 0x0d,
-		0x31, 0x30, 0x30, 0x34, 0x32, 0x34, 0x30, 0x39,
-		0x30, 0x39, 0x33, 0x38, 0x5a, 0x17, 0x0d, 0x31,
-		0x31, 0x30, 0x34, 0x32, 0x34, 0x30, 0x39, 0x30,
-		0x39, 0x33, 0x38, 0x5a, 0x30, 0x45, 0x31, 0x0b,
-		0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13,
-		0x02, 0x41, 0x55, 0x31, 0x13, 0x30, 0x11, 0x06,
-		0x03, 0x55, 0x04, 0x08, 0x13, 0x0a, 0x53, 0x6f,
-		0x6d, 0x65, 0x2d, 0x53, 0x74, 0x61, 0x74, 0x65,
-		0x31, 0x21, 0x30, 0x1f, 0x06, 0x03, 0x55, 0x04,
-		0x0a, 0x13, 0x18, 0x49, 0x6e, 0x74, 0x65, 0x72,
-		0x6e, 0x65, 0x74, 0x20, 0x57, 0x69, 0x64, 0x67,
-		0x69, 0x74, 0x73, 0x20, 0x50, 0x74, 0x79, 0x20,
-		0x4c, 0x74, 0x64, 0x30, 0x81, 0x9f, 0x30, 0x0d,
-		0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d,
-		0x01, 0x01, 0x01, 0x05, 0x00, 0x03, 0x81, 0x8d,
-		0x00, 0x30, 0x81, 0x89, 0x02, 0x81, 0x81, 0x00,
-		0xbb, 0x79, 0xd6, 0xf5, 0x17, 0xb5, 0xe5, 0xbf,
-		0x46, 0x10, 0xd0, 0xdc, 0x69, 0xbe, 0xe6, 0x2b,
-		0x07, 0x43, 0x5a, 0xd0, 0x03, 0x2d, 0x8a, 0x7a,
-		0x43, 0x85, 0xb7, 0x14, 0x52, 0xe7, 0xa5, 0x65,
-		0x4c, 0x2c, 0x78, 0xb8, 0x23, 0x8c, 0xb5, 0xb4,
-		0x82, 0xe5, 0xde, 0x1f, 0x95, 0x3b, 0x7e, 0x62,
-		0xa5, 0x2c, 0xa5, 0x33, 0xd6, 0xfe, 0x12, 0x5c,
-		0x7a, 0x56, 0xfc, 0xf5, 0x06, 0xbf, 0xfa, 0x58,
-		0x7b, 0x26, 0x3f, 0xb5, 0xcd, 0x04, 0xd3, 0xd0,
-		0xc9, 0x21, 0x96, 0x4a, 0xc7, 0xf4, 0x54, 0x9f,
-		0x5a, 0xbf, 0xef, 0x42, 0x71, 0x00, 0xfe, 0x18,
-		0x99, 0x07, 0x7f, 0x7e, 0x88, 0x7d, 0x7d, 0xf1,
-		0x04, 0x39, 0xc4, 0xa2, 0x2e, 0xdb, 0x51, 0xc9,
-		0x7c, 0xe3, 0xc0, 0x4c, 0x3b, 0x32, 0x66, 0x01,
-		0xcf, 0xaf, 0xb1, 0x1d, 0xb8, 0x71, 0x9a, 0x1d,
-		0xdb, 0xdb, 0x89, 0x6b, 0xae, 0xda, 0x2d, 0x79,
-		0x02, 0x03, 0x01, 0x00, 0x01, 0xa3, 0x81, 0xa7,
-		0x30, 0x81, 0xa4, 0x30, 0x1d, 0x06, 0x03, 0x55,
-		0x1d, 0x0e, 0x04, 0x16, 0x04, 0x14, 0xb1, 0xad,
-		0xe2, 0x85, 0x5a, 0xcf, 0xcb, 0x28, 0xdb, 0x69,
-		0xce, 0x23, 0x69, 0xde, 0xd3, 0x26, 0x8e, 0x18,
-		0x88, 0x39, 0x30, 0x75, 0x06, 0x03, 0x55, 0x1d,
-		0x23, 0x04, 0x6e, 0x30, 0x6c, 0x80, 0x14, 0xb1,
-		0xad, 0xe2, 0x85, 0x5a, 0xcf, 0xcb, 0x28, 0xdb,
-		0x69, 0xce, 0x23, 0x69, 0xde, 0xd3, 0x26, 0x8e,
-		0x18, 0x88, 0x39, 0xa1, 0x49, 0xa4, 0x47, 0x30,
-		0x45, 0x31, 0x0b, 0x30, 0x09, 0x06, 0x03, 0x55,
-		0x04, 0x06, 0x13, 0x02, 0x41, 0x55, 0x31, 0x13,
-		0x30, 0x11, 0x06, 0x03, 0x55, 0x04, 0x08, 0x13,
-		0x0a, 0x53, 0x6f, 0x6d, 0x65, 0x2d, 0x53, 0x74,
-		0x61, 0x74, 0x65, 0x31, 0x21, 0x30, 0x1f, 0x06,
-		0x03, 0x55, 0x04, 0x0a, 0x13, 0x18, 0x49, 0x6e,
-		0x74, 0x65, 0x72, 0x6e, 0x65, 0x74, 0x20, 0x57,
-		0x69, 0x64, 0x67, 0x69, 0x74, 0x73, 0x20, 0x50,
-		0x74, 0x79, 0x20, 0x4c, 0x74, 0x64, 0x82, 0x09,
-		0x00, 0x85, 0xb0, 0xbb, 0xa4, 0x8a, 0x7f, 0xb8,
-		0xca, 0x30, 0x0c, 0x06, 0x03, 0x55, 0x1d, 0x13,
-		0x04, 0x05, 0x30, 0x03, 0x01, 0x01, 0xff, 0x30,
-		0x0d, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7,
-		0x0d, 0x01, 0x01, 0x05, 0x05, 0x00, 0x03, 0x81,
-		0x81, 0x00, 0x08, 0x6c, 0x45, 0x24, 0xc7, 0x6b,
-		0xb1, 0x59, 0xab, 0x0c, 0x52, 0xcc, 0xf2, 0xb0,
-		0x14, 0xd7, 0x87, 0x9d, 0x7a, 0x64, 0x75, 0xb5,
-		0x5a, 0x95, 0x66, 0xe4, 0xc5, 0x2b, 0x8e, 0xae,
-		0x12, 0x66, 0x1f, 0xeb, 0x4f, 0x38, 0xb3, 0x6e,
-		0x60, 0xd3, 0x92, 0xfd, 0xf7, 0x41, 0x08, 0xb5,
-		0x25, 0x13, 0xb1, 0x18, 0x7a, 0x24, 0xfb, 0x30,
-		0x1d, 0xba, 0xed, 0x98, 0xb9, 0x17, 0xec, 0xe7,
-		0xd7, 0x31, 0x59, 0xdb, 0x95, 0xd3, 0x1d, 0x78,
-		0xea, 0x50, 0x56, 0x5c, 0xd5, 0x82, 0x5a, 0x2d,
-		0x5a, 0x5f, 0x33, 0xc4, 0xb6, 0xd8, 0xc9, 0x75,
-		0x90, 0x96, 0x8c, 0x0f, 0x52, 0x98, 0xb5, 0xcd,
-		0x98, 0x1f, 0x89, 0x20, 0x5f, 0xf2, 0xa0, 0x1c,
-		0xa3, 0x1b, 0x96, 0x94, 0xdd, 0xa9, 0xfd, 0x57,
-		0xe9, 0x70, 0xe8, 0x26, 0x6d, 0x71, 0x99, 0x9b,
-		0x26, 0x6e, 0x38, 0x50, 0x29, 0x6c, 0x90, 0xa7,
-		0xbd, 0xd9, 0x16, 0x03, 0x00, 0x00, 0x04, 0x0e,
-		0x00, 0x00, 0x00,
-	},
-	{
-		0x16, 0x03, 0x00, 0x00, 0x84, 0x10, 0x00, 0x00,
-		0x80, 0x4a, 0x8d, 0xc4, 0x38, 0x7a, 0x9c, 0xd6,
-		0xe8, 0x72, 0x9e, 0xa3, 0xdf, 0x37, 0xb4, 0x6c,
-		0x58, 0x33, 0x59, 0xd9, 0xc9, 0x4b, 0x50, 0x33,
-		0x6c, 0xed, 0x73, 0x38, 0x2a, 0x46, 0x55, 0x31,
-		0xa9, 0x8e, 0x8e, 0xfc, 0x0b, 0x5d, 0x5f, 0x3c,
-		0x88, 0x28, 0x3f, 0x60, 0x51, 0x13, 0xf1, 0x59,
-		0x0c, 0xa3, 0x5e, 0xe0, 0xa3, 0x35, 0x06, 0xb1,
-		0x71, 0x59, 0x24, 0x4e, 0xed, 0x07, 0x15, 0x88,
-		0x50, 0xef, 0xc2, 0xb2, 0x2a, 0x52, 0x30, 0x6a,
-		0x7c, 0xbe, 0x2f, 0xc6, 0x8f, 0xa8, 0x83, 0xc5,
-		0x80, 0x14, 0x62, 0x74, 0x7f, 0x96, 0x9f, 0x41,
-		0x32, 0x74, 0xdd, 0x76, 0x2d, 0x7b, 0xeb, 0x7b,
-		0xea, 0xd0, 0x4f, 0x0c, 0xcf, 0x9a, 0x9c, 0xc5,
-		0x7a, 0xe4, 0xbc, 0xf8, 0xa6, 0xe1, 0x09, 0x8e,
-		0x7c, 0x53, 0x3a, 0xe3, 0x30, 0x8f, 0x76, 0xee,
-		0x58, 0xbb, 0xfd, 0x0b, 0x06, 0xb8, 0xdf, 0xb7,
-		0x31, 0x14, 0x03, 0x00, 0x00, 0x01, 0x01, 0x16,
-		0x03, 0x00, 0x00, 0x3c, 0x13, 0x91, 0xc6, 0x4a,
-		0x0c, 0x59, 0x25, 0xce, 0x54, 0xc0, 0x1d, 0xb9,
-		0x2a, 0xff, 0x4d, 0xca, 0x26, 0x0c, 0x8c, 0x04,
-		0x98, 0x7c, 0x7c, 0x38, 0xa3, 0xf5, 0xf9, 0x36,
-		0x1c, 0x04, 0x32, 0x47, 0x2d, 0x48, 0x0e, 0x96,
-		0xe8, 0x2b, 0x5e, 0x5a, 0xc6, 0x0a, 0x48, 0x41,
-		0x34, 0x5e, 0x62, 0xd5, 0x68, 0x4e, 0x44, 0x1d,
-		0xb2, 0xa1, 0x11, 0xad, 0x6e, 0x14, 0x85, 0x61,
-	},
-	{
-		0x14, 0x03, 0x00, 0x00, 0x01, 0x01, 0x16, 0x03,
-		0x00, 0x00, 0x3c, 0x88, 0xae, 0xa9, 0xd4, 0xa8,
-		0x10, 0x8d, 0x65, 0xa6, 0x3e, 0x1e, 0xed, 0xd2,
-		0xfc, 0xc4, 0x7c, 0xa8, 0x94, 0x4f, 0x11, 0xaf,
-		0xa6, 0x87, 0x09, 0x37, 0x54, 0xf7, 0x69, 0xd1,
-		0xb5, 0x25, 0x6b, 0xb5, 0xed, 0xcb, 0x25, 0x39,
-		0x73, 0xeb, 0x53, 0x6c, 0xc7, 0xb4, 0x29, 0x8f,
-		0xd6, 0x49, 0xd1, 0x95, 0x59, 0x80, 0x9a, 0x67,
-		0x5c, 0xb2, 0xe0, 0xbd, 0x1e, 0xff, 0xaa, 0x17,
-		0x03, 0x00, 0x00, 0x21, 0x65, 0x7b, 0x99, 0x09,
-		0x02, 0xc3, 0x9d, 0x54, 0xd6, 0xe7, 0x32, 0x62,
-		0xab, 0xc1, 0x09, 0x91, 0x30, 0x0a, 0xc9, 0xfa,
-		0x70, 0xec, 0x06, 0x7b, 0xa3, 0xe1, 0x5f, 0xb4,
-		0x63, 0xe6, 0x5c, 0xba, 0x1f, 0x15, 0x03, 0x00,
-		0x00, 0x16, 0x40, 0x70, 0xbe, 0xe6, 0xa6, 0xee,
-		0x8f, 0xd0, 0x87, 0xa0, 0x43, 0xa1, 0x92, 0xd7,
-		0xd0, 0x1a, 0x0c, 0x20, 0x7c, 0xbf, 0xa2, 0xb5,
-	},
+	test := &serverTest{
+		name:    "ECDHE-ECDSA-AES",
+		command: []string{"openssl", "s_client", "-no_ticket", "-cipher", "ECDHE-ECDSA-AES256-SHA"},
+		config:  &config,
+	}
+	runServerTestTLS10(t, test)
+	runServerTestTLS12(t, test)
 }
 
-var selectCertificateBySNIScript = [][]byte{
-	{
-		0x16, 0x03, 0x01, 0x00, 0x6a, 0x01, 0x00, 0x00,
-		0x66, 0x03, 0x01, 0x50, 0x77, 0x3d, 0xfe, 0xfb,
-		0x8d, 0xc2, 0x68, 0xeb, 0xf9, 0xfa, 0x54, 0x97,
-		0x86, 0x45, 0xa2, 0xa3, 0xed, 0xb1, 0x91, 0xb8,
-		0x28, 0xc0, 0x47, 0xaf, 0xfb, 0xcd, 0xdc, 0x0e,
-		0xb3, 0xea, 0xa5, 0x00, 0x00, 0x28, 0x00, 0x39,
-		0x00, 0x38, 0x00, 0x35, 0x00, 0x16, 0x00, 0x13,
-		0x00, 0x0a, 0x00, 0x33, 0x00, 0x32, 0x00, 0x2f,
-		0x00, 0x05, 0x00, 0x04, 0x00, 0x15, 0x00, 0x12,
-		0x00, 0x09, 0x00, 0x14, 0x00, 0x11, 0x00, 0x08,
-		0x00, 0x06, 0x00, 0x03, 0x00, 0xff, 0x02, 0x01,
-		0x00, 0x00, 0x14, 0x00, 0x00, 0x00, 0x10, 0x00,
-		0x0e, 0x00, 0x00, 0x0b, 0x73, 0x6e, 0x69, 0x74,
-		0x65, 0x73, 0x74, 0x2e, 0x63, 0x6f, 0x6d,
-	},
-	{
-		0x16, 0x03, 0x01, 0x00, 0x2a, 0x02, 0x00, 0x00,
-		0x26, 0x03, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x00, 0x16,
-		0x03, 0x01, 0x02, 0x00, 0x0b, 0x00, 0x01, 0xfc,
-		0x00, 0x01, 0xf9, 0x00, 0x01, 0xf6, 0x30, 0x82,
-		0x01, 0xf2, 0x30, 0x82, 0x01, 0x5d, 0xa0, 0x03,
-		0x02, 0x01, 0x02, 0x02, 0x01, 0x00, 0x30, 0x0b,
-		0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d,
-		0x01, 0x01, 0x05, 0x30, 0x28, 0x31, 0x10, 0x30,
-		0x0e, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13, 0x07,
-		0x41, 0x63, 0x6d, 0x65, 0x20, 0x43, 0x6f, 0x31,
-		0x14, 0x30, 0x12, 0x06, 0x03, 0x55, 0x04, 0x03,
-		0x13, 0x0b, 0x73, 0x6e, 0x69, 0x74, 0x65, 0x73,
-		0x74, 0x2e, 0x63, 0x6f, 0x6d, 0x30, 0x1e, 0x17,
-		0x0d, 0x31, 0x32, 0x30, 0x34, 0x31, 0x31, 0x31,
-		0x37, 0x34, 0x30, 0x33, 0x35, 0x5a, 0x17, 0x0d,
-		0x31, 0x33, 0x30, 0x34, 0x31, 0x31, 0x31, 0x37,
-		0x34, 0x35, 0x33, 0x35, 0x5a, 0x30, 0x28, 0x31,
-		0x10, 0x30, 0x0e, 0x06, 0x03, 0x55, 0x04, 0x0a,
-		0x13, 0x07, 0x41, 0x63, 0x6d, 0x65, 0x20, 0x43,
-		0x6f, 0x31, 0x14, 0x30, 0x12, 0x06, 0x03, 0x55,
-		0x04, 0x03, 0x13, 0x0b, 0x73, 0x6e, 0x69, 0x74,
-		0x65, 0x73, 0x74, 0x2e, 0x63, 0x6f, 0x6d, 0x30,
-		0x81, 0x9d, 0x30, 0x0b, 0x06, 0x09, 0x2a, 0x86,
-		0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x01, 0x03,
-		0x81, 0x8d, 0x00, 0x30, 0x81, 0x89, 0x02, 0x81,
-		0x81, 0x00, 0xbb, 0x79, 0xd6, 0xf5, 0x17, 0xb5,
-		0xe5, 0xbf, 0x46, 0x10, 0xd0, 0xdc, 0x69, 0xbe,
-		0xe6, 0x2b, 0x07, 0x43, 0x5a, 0xd0, 0x03, 0x2d,
-		0x8a, 0x7a, 0x43, 0x85, 0xb7, 0x14, 0x52, 0xe7,
-		0xa5, 0x65, 0x4c, 0x2c, 0x78, 0xb8, 0x23, 0x8c,
-		0xb5, 0xb4, 0x82, 0xe5, 0xde, 0x1f, 0x95, 0x3b,
-		0x7e, 0x62, 0xa5, 0x2c, 0xa5, 0x33, 0xd6, 0xfe,
-		0x12, 0x5c, 0x7a, 0x56, 0xfc, 0xf5, 0x06, 0xbf,
-		0xfa, 0x58, 0x7b, 0x26, 0x3f, 0xb5, 0xcd, 0x04,
-		0xd3, 0xd0, 0xc9, 0x21, 0x96, 0x4a, 0xc7, 0xf4,
-		0x54, 0x9f, 0x5a, 0xbf, 0xef, 0x42, 0x71, 0x00,
-		0xfe, 0x18, 0x99, 0x07, 0x7f, 0x7e, 0x88, 0x7d,
-		0x7d, 0xf1, 0x04, 0x39, 0xc4, 0xa2, 0x2e, 0xdb,
-		0x51, 0xc9, 0x7c, 0xe3, 0xc0, 0x4c, 0x3b, 0x32,
-		0x66, 0x01, 0xcf, 0xaf, 0xb1, 0x1d, 0xb8, 0x71,
-		0x9a, 0x1d, 0xdb, 0xdb, 0x89, 0x6b, 0xae, 0xda,
-		0x2d, 0x79, 0x02, 0x03, 0x01, 0x00, 0x01, 0xa3,
-		0x32, 0x30, 0x30, 0x30, 0x0e, 0x06, 0x03, 0x55,
-		0x1d, 0x0f, 0x01, 0x01, 0xff, 0x04, 0x04, 0x03,
-		0x02, 0x00, 0xa0, 0x30, 0x0d, 0x06, 0x03, 0x55,
-		0x1d, 0x0e, 0x04, 0x06, 0x04, 0x04, 0x01, 0x02,
-		0x03, 0x04, 0x30, 0x0f, 0x06, 0x03, 0x55, 0x1d,
-		0x23, 0x04, 0x08, 0x30, 0x06, 0x80, 0x04, 0x01,
-		0x02, 0x03, 0x04, 0x30, 0x0b, 0x06, 0x09, 0x2a,
-		0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01, 0x05,
-		0x03, 0x81, 0x81, 0x00, 0x89, 0xc6, 0x45, 0x5f,
-		0x1c, 0x1f, 0x5e, 0xf8, 0xeb, 0x1a, 0xb1, 0x74,
-		0xee, 0x24, 0x39, 0x05, 0x9f, 0x5c, 0x42, 0x59,
-		0xbb, 0x1a, 0x8d, 0x86, 0xcd, 0xb1, 0xd0, 0x56,
-		0xf5, 0x6a, 0x71, 0x7d, 0xa4, 0x0e, 0x95, 0xab,
-		0x90, 0xf5, 0x9e, 0x8d, 0xea, 0xf6, 0x27, 0xc1,
-		0x57, 0x99, 0x50, 0x94, 0xdb, 0x08, 0x02, 0x26,
-		0x6e, 0xb3, 0x4f, 0xc6, 0x84, 0x2d, 0xea, 0x8a,
-		0x4b, 0x68, 0xd9, 0xc1, 0x38, 0x91, 0x03, 0xab,
-		0x84, 0xfb, 0x9e, 0x1f, 0x85, 0xd9, 0xb5, 0xd2,
-		0x3f, 0xf2, 0x31, 0x2c, 0x86, 0x70, 0xfb, 0xb5,
-		0x40, 0x14, 0x82, 0x45, 0xa4, 0xeb, 0xaf, 0xe2,
-		0x64, 0xd9, 0x0c, 0x8a, 0x4c, 0xf4, 0xf8, 0x5b,
-		0x0f, 0xac, 0x12, 0xac, 0x2f, 0xc4, 0xa3, 0x15,
-		0x4b, 0xad, 0x52, 0x46, 0x28, 0x68, 0xaf, 0x96,
-		0xc6, 0x2c, 0x65, 0x25, 0xd6, 0x52, 0xb6, 0xe3,
-		0x18, 0x45, 0xbd, 0xcc, 0x16, 0x03, 0x01, 0x00,
-		0x04, 0x0e, 0x00, 0x00, 0x00,
-	},
-	{
-		0x16, 0x03, 0x01, 0x00, 0x86, 0x10, 0x00, 0x00,
-		0x82, 0x00, 0x80, 0x69, 0xc3, 0xd4, 0x0e, 0xcc,
-		0xdc, 0xbc, 0x5e, 0xc2, 0x64, 0xa6, 0xde, 0x3c,
-		0x0c, 0x7e, 0x0c, 0x6b, 0x80, 0x0f, 0xd4, 0x8f,
-		0x02, 0x4b, 0xb2, 0xba, 0x8d, 0x01, 0xeb, 0x6b,
-		0xa1, 0x2e, 0x79, 0x37, 0xba, 0xae, 0x24, 0xc2,
-		0x26, 0x72, 0x51, 0xe1, 0x82, 0x8e, 0x51, 0x41,
-		0x1c, 0x54, 0xa4, 0x26, 0xbe, 0x13, 0xcd, 0x1b,
-		0xc6, 0xed, 0x3d, 0x1f, 0xfd, 0x72, 0x80, 0x90,
-		0xdb, 0xbf, 0xd6, 0x39, 0x94, 0x5f, 0x48, 0xfb,
-		0x25, 0x5a, 0xc9, 0x60, 0x9b, 0xd7, 0xc6, 0x20,
-		0xa8, 0x66, 0x64, 0x13, 0xf3, 0x65, 0xc8, 0xb1,
-		0xd5, 0x33, 0x21, 0x0e, 0x73, 0x41, 0xc0, 0x18,
-		0x1a, 0x37, 0xfe, 0xcf, 0x28, 0x2a, 0xcd, 0xe4,
-		0x0b, 0xac, 0xdd, 0x25, 0x5e, 0xcb, 0x17, 0x51,
-		0x69, 0xd5, 0x8c, 0xf4, 0xb6, 0x21, 0x98, 0xef,
-		0x20, 0xdb, 0x14, 0x67, 0xf3, 0x7c, 0x95, 0x6a,
-		0x48, 0x2a, 0x6a, 0x14, 0x03, 0x01, 0x00, 0x01,
-		0x01, 0x16, 0x03, 0x01, 0x00, 0x24, 0x36, 0x1b,
-		0x09, 0xe5, 0xb9, 0xb9, 0x4d, 0x7d, 0xae, 0x87,
-		0xb6, 0x0f, 0xaf, 0xec, 0x22, 0xba, 0x0d, 0xa5,
-		0x96, 0x5e, 0x64, 0x65, 0xe7, 0xfb, 0xe3, 0xf3,
-		0x6b, 0x72, 0xa8, 0xdb, 0xed, 0xd8, 0x69, 0x9c,
-		0x08, 0xd8,
-	},
-	{
-		0x14, 0x03, 0x01, 0x00, 0x01, 0x01, 0x16, 0x03,
-		0x01, 0x00, 0x24, 0x60, 0xf7, 0x09, 0x5f, 0xd1,
-		0xcb, 0xc9, 0xe1, 0x22, 0xb5, 0x2a, 0xcc, 0xde,
-		0x7c, 0xa7, 0xb8, 0x85, 0x00, 0xbc, 0xfd, 0x85,
-		0xe1, 0x91, 0x36, 0xbb, 0x07, 0x42, 0xad, 0x3d,
-		0x29, 0x62, 0x69, 0xc1, 0x45, 0x92, 0x6f, 0x17,
-		0x03, 0x01, 0x00, 0x21, 0x0d, 0xf9, 0xd5, 0x87,
-		0xb9, 0x57, 0x3c, 0x50, 0x19, 0xe4, 0x3a, 0x50,
-		0x45, 0xcc, 0x86, 0x89, 0xd4, 0x32, 0x79, 0x45,
-		0x7c, 0x9f, 0x96, 0xd4, 0x54, 0x56, 0x0c, 0x63,
-		0x72, 0x81, 0xc3, 0xd3, 0xe3, 0x15, 0x03, 0x01,
-		0x00, 0x16, 0x84, 0xec, 0x2e, 0xf6, 0xaf, 0x4f,
-		0xee, 0x48, 0x0f, 0xbe, 0xcd, 0x82, 0x5c, 0x56,
-		0x16, 0xe4, 0xfb, 0x89, 0xc5, 0x57, 0x3e, 0x91,
-	},
+// TestHandshakeServerSNI involves a client sending an SNI extension of
+// "snitest.com", which happens to match the CN of testSNICertificate. The test
+// verifies that the server correctly selects that certificate.
+func TestHandshakeServerSNI(t *testing.T) {
+	test := &serverTest{
+		name:    "SNI",
+		command: []string{"openssl", "s_client", "-no_ticket", "-cipher", "AES128-SHA", "-servername", "snitest.com"},
+	}
+	runServerTestTLS12(t, test)
 }
 
-var issueSessionTicketTest = [][]byte{
-	{
-		0x16, 0x03, 0x01, 0x00, 0x5a, 0x01, 0x00, 0x00,
-		0x56, 0x03, 0x01, 0x50, 0x77, 0x3e, 0x49, 0x7a,
-		0xb7, 0x86, 0x5c, 0x27, 0xd2, 0x97, 0x61, 0xe3,
-		0x49, 0x41, 0x48, 0xe7, 0x0e, 0xaa, 0x7e, 0x4d,
-		0xb8, 0xdc, 0x01, 0x97, 0xfb, 0xab, 0x53, 0xb2,
-		0x5e, 0x36, 0xf6, 0x00, 0x00, 0x28, 0x00, 0x39,
-		0x00, 0x38, 0x00, 0x35, 0x00, 0x16, 0x00, 0x13,
-		0x00, 0x0a, 0x00, 0x33, 0x00, 0x32, 0x00, 0x2f,
-		0x00, 0x05, 0x00, 0x04, 0x00, 0x15, 0x00, 0x12,
-		0x00, 0x09, 0x00, 0x14, 0x00, 0x11, 0x00, 0x08,
-		0x00, 0x06, 0x00, 0x03, 0x00, 0xff, 0x02, 0x01,
-		0x00, 0x00, 0x04, 0x00, 0x23, 0x00, 0x00,
-	},
-	{
-		0x16, 0x03, 0x01, 0x00, 0x30, 0x02, 0x00, 0x00,
-		0x2c, 0x03, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x00, 0x00,
-		0x04, 0x00, 0x23, 0x00, 0x00, 0x16, 0x03, 0x01,
-		0x02, 0xbe, 0x0b, 0x00, 0x02, 0xba, 0x00, 0x02,
-		0xb7, 0x00, 0x02, 0xb4, 0x30, 0x82, 0x02, 0xb0,
-		0x30, 0x82, 0x02, 0x19, 0xa0, 0x03, 0x02, 0x01,
-		0x02, 0x02, 0x09, 0x00, 0x85, 0xb0, 0xbb, 0xa4,
-		0x8a, 0x7f, 0xb8, 0xca, 0x30, 0x0d, 0x06, 0x09,
-		0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01,
-		0x05, 0x05, 0x00, 0x30, 0x45, 0x31, 0x0b, 0x30,
-		0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02,
-		0x41, 0x55, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03,
-		0x55, 0x04, 0x08, 0x13, 0x0a, 0x53, 0x6f, 0x6d,
-		0x65, 0x2d, 0x53, 0x74, 0x61, 0x74, 0x65, 0x31,
-		0x21, 0x30, 0x1f, 0x06, 0x03, 0x55, 0x04, 0x0a,
-		0x13, 0x18, 0x49, 0x6e, 0x74, 0x65, 0x72, 0x6e,
-		0x65, 0x74, 0x20, 0x57, 0x69, 0x64, 0x67, 0x69,
-		0x74, 0x73, 0x20, 0x50, 0x74, 0x79, 0x20, 0x4c,
-		0x74, 0x64, 0x30, 0x1e, 0x17, 0x0d, 0x31, 0x30,
-		0x30, 0x34, 0x32, 0x34, 0x30, 0x39, 0x30, 0x39,
-		0x33, 0x38, 0x5a, 0x17, 0x0d, 0x31, 0x31, 0x30,
-		0x34, 0x32, 0x34, 0x30, 0x39, 0x30, 0x39, 0x33,
-		0x38, 0x5a, 0x30, 0x45, 0x31, 0x0b, 0x30, 0x09,
-		0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x41,
-		0x55, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03, 0x55,
-		0x04, 0x08, 0x13, 0x0a, 0x53, 0x6f, 0x6d, 0x65,
-		0x2d, 0x53, 0x74, 0x61, 0x74, 0x65, 0x31, 0x21,
-		0x30, 0x1f, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13,
-		0x18, 0x49, 0x6e, 0x74, 0x65, 0x72, 0x6e, 0x65,
-		0x74, 0x20, 0x57, 0x69, 0x64, 0x67, 0x69, 0x74,
-		0x73, 0x20, 0x50, 0x74, 0x79, 0x20, 0x4c, 0x74,
-		0x64, 0x30, 0x81, 0x9f, 0x30, 0x0d, 0x06, 0x09,
-		0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01,
-		0x01, 0x05, 0x00, 0x03, 0x81, 0x8d, 0x00, 0x30,
-		0x81, 0x89, 0x02, 0x81, 0x81, 0x00, 0xbb, 0x79,
-		0xd6, 0xf5, 0x17, 0xb5, 0xe5, 0xbf, 0x46, 0x10,
-		0xd0, 0xdc, 0x69, 0xbe, 0xe6, 0x2b, 0x07, 0x43,
-		0x5a, 0xd0, 0x03, 0x2d, 0x8a, 0x7a, 0x43, 0x85,
-		0xb7, 0x14, 0x52, 0xe7, 0xa5, 0x65, 0x4c, 0x2c,
-		0x78, 0xb8, 0x23, 0x8c, 0xb5, 0xb4, 0x82, 0xe5,
-		0xde, 0x1f, 0x95, 0x3b, 0x7e, 0x62, 0xa5, 0x2c,
-		0xa5, 0x33, 0xd6, 0xfe, 0x12, 0x5c, 0x7a, 0x56,
-		0xfc, 0xf5, 0x06, 0xbf, 0xfa, 0x58, 0x7b, 0x26,
-		0x3f, 0xb5, 0xcd, 0x04, 0xd3, 0xd0, 0xc9, 0x21,
-		0x96, 0x4a, 0xc7, 0xf4, 0x54, 0x9f, 0x5a, 0xbf,
-		0xef, 0x42, 0x71, 0x00, 0xfe, 0x18, 0x99, 0x07,
-		0x7f, 0x7e, 0x88, 0x7d, 0x7d, 0xf1, 0x04, 0x39,
-		0xc4, 0xa2, 0x2e, 0xdb, 0x51, 0xc9, 0x7c, 0xe3,
-		0xc0, 0x4c, 0x3b, 0x32, 0x66, 0x01, 0xcf, 0xaf,
-		0xb1, 0x1d, 0xb8, 0x71, 0x9a, 0x1d, 0xdb, 0xdb,
-		0x89, 0x6b, 0xae, 0xda, 0x2d, 0x79, 0x02, 0x03,
-		0x01, 0x00, 0x01, 0xa3, 0x81, 0xa7, 0x30, 0x81,
-		0xa4, 0x30, 0x1d, 0x06, 0x03, 0x55, 0x1d, 0x0e,
-		0x04, 0x16, 0x04, 0x14, 0xb1, 0xad, 0xe2, 0x85,
-		0x5a, 0xcf, 0xcb, 0x28, 0xdb, 0x69, 0xce, 0x23,
-		0x69, 0xde, 0xd3, 0x26, 0x8e, 0x18, 0x88, 0x39,
-		0x30, 0x75, 0x06, 0x03, 0x55, 0x1d, 0x23, 0x04,
-		0x6e, 0x30, 0x6c, 0x80, 0x14, 0xb1, 0xad, 0xe2,
-		0x85, 0x5a, 0xcf, 0xcb, 0x28, 0xdb, 0x69, 0xce,
-		0x23, 0x69, 0xde, 0xd3, 0x26, 0x8e, 0x18, 0x88,
-		0x39, 0xa1, 0x49, 0xa4, 0x47, 0x30, 0x45, 0x31,
-		0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06,
-		0x13, 0x02, 0x41, 0x55, 0x31, 0x13, 0x30, 0x11,
-		0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0a, 0x53,
-		0x6f, 0x6d, 0x65, 0x2d, 0x53, 0x74, 0x61, 0x74,
-		0x65, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x03, 0x55,
-		0x04, 0x0a, 0x13, 0x18, 0x49, 0x6e, 0x74, 0x65,
-		0x72, 0x6e, 0x65, 0x74, 0x20, 0x57, 0x69, 0x64,
-		0x67, 0x69, 0x74, 0x73, 0x20, 0x50, 0x74, 0x79,
-		0x20, 0x4c, 0x74, 0x64, 0x82, 0x09, 0x00, 0x85,
-		0xb0, 0xbb, 0xa4, 0x8a, 0x7f, 0xb8, 0xca, 0x30,
-		0x0c, 0x06, 0x03, 0x55, 0x1d, 0x13, 0x04, 0x05,
-		0x30, 0x03, 0x01, 0x01, 0xff, 0x30, 0x0d, 0x06,
-		0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01,
-		0x01, 0x05, 0x05, 0x00, 0x03, 0x81, 0x81, 0x00,
-		0x08, 0x6c, 0x45, 0x24, 0xc7, 0x6b, 0xb1, 0x59,
-		0xab, 0x0c, 0x52, 0xcc, 0xf2, 0xb0, 0x14, 0xd7,
-		0x87, 0x9d, 0x7a, 0x64, 0x75, 0xb5, 0x5a, 0x95,
-		0x66, 0xe4, 0xc5, 0x2b, 0x8e, 0xae, 0x12, 0x66,
-		0x1f, 0xeb, 0x4f, 0x38, 0xb3, 0x6e, 0x60, 0xd3,
-		0x92, 0xfd, 0xf7, 0x41, 0x08, 0xb5, 0x25, 0x13,
-		0xb1, 0x18, 0x7a, 0x24, 0xfb, 0x30, 0x1d, 0xba,
-		0xed, 0x98, 0xb9, 0x17, 0xec, 0xe7, 0xd7, 0x31,
-		0x59, 0xdb, 0x95, 0xd3, 0x1d, 0x78, 0xea, 0x50,
-		0x56, 0x5c, 0xd5, 0x82, 0x5a, 0x2d, 0x5a, 0x5f,
-		0x33, 0xc4, 0xb6, 0xd8, 0xc9, 0x75, 0x90, 0x96,
-		0x8c, 0x0f, 0x52, 0x98, 0xb5, 0xcd, 0x98, 0x1f,
-		0x89, 0x20, 0x5f, 0xf2, 0xa0, 0x1c, 0xa3, 0x1b,
-		0x96, 0x94, 0xdd, 0xa9, 0xfd, 0x57, 0xe9, 0x70,
-		0xe8, 0x26, 0x6d, 0x71, 0x99, 0x9b, 0x26, 0x6e,
-		0x38, 0x50, 0x29, 0x6c, 0x90, 0xa7, 0xbd, 0xd9,
-		0x16, 0x03, 0x01, 0x00, 0x04, 0x0e, 0x00, 0x00,
-		0x00,
-	},
-	{
-		0x16, 0x03, 0x01, 0x00, 0x86, 0x10, 0x00, 0x00,
-		0x82, 0x00, 0x80, 0x68, 0x10, 0xdc, 0x80, 0xbc,
-		0xb3, 0x5a, 0x10, 0x75, 0x89, 0xcc, 0xe5, 0x9f,
-		0xbf, 0xe2, 0xce, 0xa4, 0x9f, 0x7f, 0x60, 0xc4,
-		0xfe, 0x5c, 0xb5, 0x02, 0x2d, 0xa5, 0xa9, 0x1e,
-		0x2c, 0x10, 0x79, 0x15, 0x0f, 0xed, 0x96, 0xb3,
-		0xa8, 0x5e, 0x21, 0xbc, 0x5b, 0xdc, 0x58, 0x04,
-		0x7d, 0x37, 0xdb, 0xa0, 0x31, 0xe8, 0x4f, 0x04,
-		0xbc, 0x46, 0x7c, 0xdb, 0x2e, 0x93, 0x07, 0xaf,
-		0xa6, 0x36, 0xd3, 0x39, 0x8d, 0x1d, 0x95, 0xa8,
-		0x50, 0x4b, 0xc4, 0x2b, 0xde, 0xd7, 0x04, 0x6d,
-		0x77, 0x6c, 0x4d, 0x70, 0x51, 0x88, 0x16, 0x31,
-		0x40, 0xb5, 0xba, 0x90, 0x47, 0x64, 0x0c, 0x87,
-		0xa5, 0x19, 0xf9, 0x89, 0x24, 0x3c, 0x5e, 0x4b,
-		0xaa, 0xe0, 0x60, 0x47, 0x0f, 0x2e, 0xcc, 0xc2,
-		0xd5, 0x21, 0xed, 0x72, 0xd0, 0xa9, 0xdd, 0x2a,
-		0x2b, 0xef, 0x08, 0x3a, 0x65, 0xea, 0x8b, 0x52,
-		0x77, 0x2d, 0xcc, 0x14, 0x03, 0x01, 0x00, 0x01,
-		0x01, 0x16, 0x03, 0x01, 0x00, 0x24, 0xe2, 0x95,
-		0x62, 0x3c, 0x18, 0xe5, 0xc7, 0x2c, 0xda, 0x16,
-		0x9b, 0x28, 0x0d, 0xf7, 0x88, 0x7b, 0x5d, 0x33,
-		0x55, 0x3b, 0x01, 0x73, 0xf2, 0xc6, 0x4e, 0x96,
-		0x01, 0x01, 0x83, 0x65, 0xd4, 0xef, 0x12, 0x13,
-		0x1d, 0x42,
-	},
-	{
-		0x16, 0x03, 0x01, 0x00, 0x72, 0x04, 0x00, 0x00,
-		0x6e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x68, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x65,
-		0xe8, 0x4b, 0xd1, 0xef, 0xba, 0xfb, 0x41, 0x92,
-		0x6d, 0x37, 0x5f, 0xf8, 0x7d, 0x90, 0x0f, 0x01,
-		0xf8, 0x8c, 0xee, 0xbc, 0xd9, 0x0c, 0x97, 0x7e,
-		0x23, 0x46, 0xe2, 0x6b, 0x52, 0xc6, 0xc6, 0x97,
-		0x1d, 0xab, 0xde, 0xa0, 0x86, 0x94, 0xc8, 0x2e,
-		0x8b, 0x2e, 0x42, 0x5f, 0xc2, 0x70, 0x35, 0xc9,
-		0xee, 0x37, 0xeb, 0x70, 0xaa, 0x59, 0x23, 0x6c,
-		0xc8, 0xc1, 0x84, 0x89, 0x39, 0x87, 0x73, 0x0a,
-		0x7e, 0xba, 0xca, 0xed, 0x63, 0xba, 0x4e, 0x4f,
-		0xf3, 0x31, 0x4b, 0xf0, 0xee, 0x91, 0xa5, 0xb4,
-		0x62, 0x01, 0x9e, 0xbd, 0xbc, 0xb3, 0x35, 0x14,
-		0x03, 0x01, 0x00, 0x01, 0x01, 0x16, 0x03, 0x01,
-		0x00, 0x24, 0x3f, 0x66, 0xe4, 0x98, 0xc1, 0x3f,
-		0xc6, 0x2c, 0x81, 0xfb, 0xa9, 0x9f, 0x27, 0xe9,
-		0x63, 0x20, 0x1e, 0x0e, 0x4f, 0xfc, 0x5d, 0x12,
-		0xee, 0x77, 0x73, 0xc6, 0x96, 0x51, 0xf2, 0x26,
-		0x35, 0x3f, 0xce, 0x6a, 0xa9, 0xfd, 0x17, 0x03,
-		0x01, 0x00, 0x21, 0x8d, 0xd5, 0x67, 0x60, 0x5d,
-		0xa7, 0x93, 0xcc, 0x39, 0x78, 0x59, 0xab, 0xdb,
-		0x10, 0x96, 0xf2, 0xad, 0xa2, 0x85, 0xe2, 0x93,
-		0x43, 0x43, 0xcf, 0x82, 0xbd, 0x1f, 0xdc, 0x7a,
-		0x72, 0xd6, 0x83, 0x3b, 0x15, 0x03, 0x01, 0x00,
-		0x16, 0x89, 0x55, 0xf6, 0x42, 0x71, 0xa9, 0xe9,
-		0x05, 0x68, 0xe8, 0xce, 0x0d, 0x21, 0xe9, 0xec,
-		0xf2, 0x27, 0x67, 0xa7, 0x94, 0xf8, 0x34,
-	},
-}
-var serverResumeTest = [][]byte{
-	{
-		0x16, 0x03, 0x01, 0x00, 0xc2, 0x01, 0x00, 0x00,
-		0xbe, 0x03, 0x01, 0x50, 0x77, 0x3e, 0x4f, 0x1f,
-		0x6f, 0xa5, 0x81, 0xeb, 0xb8, 0x80, 0x55, 0xa4,
-		0x76, 0xc2, 0x7f, 0x27, 0xf2, 0xe7, 0xc9, 0x7a,
-		0x01, 0x3c, 0xd8, 0xc1, 0xde, 0x99, 0x1f, 0x7c,
-		0xab, 0x35, 0x98, 0x00, 0x00, 0x28, 0x00, 0x39,
-		0x00, 0x38, 0x00, 0x35, 0x00, 0x16, 0x00, 0x13,
-		0x00, 0x0a, 0x00, 0x33, 0x00, 0x32, 0x00, 0x2f,
-		0x00, 0x05, 0x00, 0x04, 0x00, 0x15, 0x00, 0x12,
-		0x00, 0x09, 0x00, 0x14, 0x00, 0x11, 0x00, 0x08,
-		0x00, 0x06, 0x00, 0x03, 0x00, 0xff, 0x02, 0x01,
-		0x00, 0x00, 0x6c, 0x00, 0x23, 0x00, 0x68, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x65,
-		0xe8, 0x4b, 0xd1, 0xef, 0xba, 0xfb, 0x41, 0x92,
-		0x6d, 0x37, 0x5f, 0xf8, 0x7d, 0x90, 0x0f, 0x01,
-		0xf8, 0x8c, 0xee, 0xbc, 0xd9, 0x0c, 0x97, 0x7e,
-		0x23, 0x46, 0xe2, 0x6b, 0x52, 0xc6, 0xc6, 0x97,
-		0x1d, 0xab, 0xde, 0xa0, 0x86, 0x94, 0xc8, 0x2e,
-		0x8b, 0x2e, 0x42, 0x5f, 0xc2, 0x70, 0x35, 0xc9,
-		0xee, 0x37, 0xeb, 0x70, 0xaa, 0x59, 0x23, 0x6c,
-		0xc8, 0xc1, 0x84, 0x89, 0x39, 0x87, 0x73, 0x0a,
-		0x7e, 0xba, 0xca, 0xed, 0x63, 0xba, 0x4e, 0x4f,
-		0xf3, 0x31, 0x4b, 0xf0, 0xee, 0x91, 0xa5, 0xb4,
-		0x62, 0x01, 0x9e, 0xbd, 0xbc, 0xb3, 0x35,
-	},
-	{
-		0x16, 0x03, 0x01, 0x00, 0x2a, 0x02, 0x00, 0x00,
-		0x26, 0x03, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x00, 0x14,
-		0x03, 0x01, 0x00, 0x01, 0x01, 0x16, 0x03, 0x01,
-		0x00, 0x24, 0xc5, 0x35, 0x74, 0x19, 0x05, 0xc5,
-		0x85, 0x68, 0x48, 0xe8, 0xb5, 0xe9, 0xaf, 0x78,
-		0xbd, 0x35, 0x6f, 0xe9, 0x79, 0x34, 0x1b, 0xf0,
-		0x35, 0xd4, 0x4e, 0x55, 0x2e, 0x3c, 0xd5, 0xaf,
-		0xfc, 0xba, 0xf5, 0x1e, 0x83, 0x32,
-	},
-	{
-		0x14, 0x03, 0x01, 0x00, 0x01, 0x01, 0x16, 0x03,
-		0x01, 0x00, 0x24, 0x27, 0x28, 0x88, 0xe1, 0x7e,
-		0x0d, 0x9c, 0x12, 0x50, 0xf6, 0x7a, 0xa7, 0x32,
-		0x21, 0x68, 0xba, 0xd8, 0x0a, 0xdc, 0x39, 0xef,
-		0x68, 0x95, 0x82, 0xae, 0xbd, 0x12, 0x79, 0xa1,
-		0x99, 0xfd, 0xd0, 0x10, 0x8e, 0x4b, 0xd8,
-	},
-	{
-		0x17, 0x03, 0x01, 0x00, 0x21, 0xc5, 0x7e, 0x0a,
-		0x52, 0x6a, 0xb9, 0xaa, 0x1d, 0xae, 0x9e, 0x24,
-		0x9c, 0x34, 0x1e, 0xdb, 0x50, 0x95, 0xee, 0x76,
-		0xd7, 0x28, 0x88, 0x08, 0xe3, 0x2e, 0x58, 0xf7,
-		0xdb, 0x34, 0x75, 0xa5, 0x7f, 0x9d, 0x15, 0x03,
-		0x01, 0x00, 0x16, 0x2c, 0xc1, 0x29, 0x5f, 0x12,
-		0x1d, 0x19, 0xab, 0xb3, 0xf4, 0x35, 0x1c, 0x62,
-		0x6a, 0x80, 0x29, 0x0d, 0x0e, 0xef, 0x7d, 0x6e,
-		0x50,
-	},
-}
+// TestCipherSuiteCertPreferance ensures that we select an RSA ciphersuite with
+// an RSA certificate and an ECDSA ciphersuite with an ECDSA certificate.
+func TestCipherSuiteCertPreferance(t *testing.T) {
+	config := *testConfig
+	config.CipherSuites = []uint16{TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA, TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA}
+	config.PreferServerCipherSuites = true
 
-var clientauthRSATests = []clientauthTest{
-	// Server asks for cert with empty CA list, client doesn't give it.
-	// go test -run "TestRunServer" -serve -clientauth 1
-	{"RequestClientCert, none given", RequestClientCert, nil, [][]byte{
-		{
-			0x16, 0x03, 0x01, 0x01, 0x1e, 0x01, 0x00, 0x01,
-			0x1a, 0x03, 0x03, 0x51, 0xe5, 0x6c, 0xb5, 0x5a,
-			0xc2, 0xf5, 0xf0, 0x92, 0x94, 0x8a, 0x64, 0x18,
-			0xa4, 0x2b, 0x82, 0x07, 0xbc, 0xd9, 0xd9, 0xf9,
-			0x7b, 0xd2, 0xd0, 0xee, 0xa2, 0x70, 0x4e, 0x23,
-			0x88, 0x7c, 0x95, 0x00, 0x00, 0x82, 0xc0, 0x30,
-			0xc0, 0x2c, 0xc0, 0x28, 0xc0, 0x24, 0xc0, 0x14,
-			0xc0, 0x0a, 0x00, 0xa3, 0x00, 0x9f, 0x00, 0x6b,
-			0x00, 0x6a, 0x00, 0x39, 0x00, 0x38, 0xc0, 0x32,
-			0xc0, 0x2e, 0xc0, 0x2a, 0xc0, 0x26, 0xc0, 0x0f,
-			0xc0, 0x05, 0x00, 0x9d, 0x00, 0x3d, 0x00, 0x35,
-			0xc0, 0x12, 0xc0, 0x08, 0x00, 0x16, 0x00, 0x13,
-			0xc0, 0x0d, 0xc0, 0x03, 0x00, 0x0a, 0xc0, 0x2f,
-			0xc0, 0x2b, 0xc0, 0x27, 0xc0, 0x23, 0xc0, 0x13,
-			0xc0, 0x09, 0x00, 0xa2, 0x00, 0x9e, 0x00, 0x67,
-			0x00, 0x40, 0x00, 0x33, 0x00, 0x32, 0xc0, 0x31,
-			0xc0, 0x2d, 0xc0, 0x29, 0xc0, 0x25, 0xc0, 0x0e,
-			0xc0, 0x04, 0x00, 0x9c, 0x00, 0x3c, 0x00, 0x2f,
-			0x00, 0x07, 0xc0, 0x11, 0xc0, 0x07, 0xc0, 0x0c,
-			0xc0, 0x02, 0x00, 0x05, 0x00, 0x04, 0x00, 0x15,
-			0x00, 0x12, 0x00, 0x09, 0x00, 0x14, 0x00, 0x11,
-			0x00, 0x08, 0x00, 0x06, 0x00, 0x03, 0x00, 0xff,
-			0x01, 0x00, 0x00, 0x6f, 0x00, 0x0b, 0x00, 0x04,
-			0x03, 0x00, 0x01, 0x02, 0x00, 0x0a, 0x00, 0x34,
-			0x00, 0x32, 0x00, 0x0e, 0x00, 0x0d, 0x00, 0x19,
-			0x00, 0x0b, 0x00, 0x0c, 0x00, 0x18, 0x00, 0x09,
-			0x00, 0x0a, 0x00, 0x16, 0x00, 0x17, 0x00, 0x08,
-			0x00, 0x06, 0x00, 0x07, 0x00, 0x14, 0x00, 0x15,
-			0x00, 0x04, 0x00, 0x05, 0x00, 0x12, 0x00, 0x13,
-			0x00, 0x01, 0x00, 0x02, 0x00, 0x03, 0x00, 0x0f,
-			0x00, 0x10, 0x00, 0x11, 0x00, 0x23, 0x00, 0x00,
-			0x00, 0x0d, 0x00, 0x22, 0x00, 0x20, 0x06, 0x01,
-			0x06, 0x02, 0x06, 0x03, 0x05, 0x01, 0x05, 0x02,
-			0x05, 0x03, 0x04, 0x01, 0x04, 0x02, 0x04, 0x03,
-			0x03, 0x01, 0x03, 0x02, 0x03, 0x03, 0x02, 0x01,
-			0x02, 0x02, 0x02, 0x03, 0x01, 0x01, 0x00, 0x0f,
-			0x00, 0x01, 0x01,
-		},
-		{
-			0x16, 0x03, 0x01, 0x00, 0x30, 0x02, 0x00, 0x00,
-			0x2c, 0x03, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00,
-			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-			0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x00, 0x00,
-			0x04, 0x00, 0x23, 0x00, 0x00, 0x16, 0x03, 0x01,
-			0x02, 0xbe, 0x0b, 0x00, 0x02, 0xba, 0x00, 0x02,
-			0xb7, 0x00, 0x02, 0xb4, 0x30, 0x82, 0x02, 0xb0,
-			0x30, 0x82, 0x02, 0x19, 0xa0, 0x03, 0x02, 0x01,
-			0x02, 0x02, 0x09, 0x00, 0x85, 0xb0, 0xbb, 0xa4,
-			0x8a, 0x7f, 0xb8, 0xca, 0x30, 0x0d, 0x06, 0x09,
-			0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01,
-			0x05, 0x05, 0x00, 0x30, 0x45, 0x31, 0x0b, 0x30,
-			0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02,
-			0x41, 0x55, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03,
-			0x55, 0x04, 0x08, 0x13, 0x0a, 0x53, 0x6f, 0x6d,
-			0x65, 0x2d, 0x53, 0x74, 0x61, 0x74, 0x65, 0x31,
-			0x21, 0x30, 0x1f, 0x06, 0x03, 0x55, 0x04, 0x0a,
-			0x13, 0x18, 0x49, 0x6e, 0x74, 0x65, 0x72, 0x6e,
-			0x65, 0x74, 0x20, 0x57, 0x69, 0x64, 0x67, 0x69,
-			0x74, 0x73, 0x20, 0x50, 0x74, 0x79, 0x20, 0x4c,
-			0x74, 0x64, 0x30, 0x1e, 0x17, 0x0d, 0x31, 0x30,
-			0x30, 0x34, 0x32, 0x34, 0x30, 0x39, 0x30, 0x39,
-			0x33, 0x38, 0x5a, 0x17, 0x0d, 0x31, 0x31, 0x30,
-			0x34, 0x32, 0x34, 0x30, 0x39, 0x30, 0x39, 0x33,
-			0x38, 0x5a, 0x30, 0x45, 0x31, 0x0b, 0x30, 0x09,
-			0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x41,
-			0x55, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03, 0x55,
-			0x04, 0x08, 0x13, 0x0a, 0x53, 0x6f, 0x6d, 0x65,
-			0x2d, 0x53, 0x74, 0x61, 0x74, 0x65, 0x31, 0x21,
-			0x30, 0x1f, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13,
-			0x18, 0x49, 0x6e, 0x74, 0x65, 0x72, 0x6e, 0x65,
-			0x74, 0x20, 0x57, 0x69, 0x64, 0x67, 0x69, 0x74,
-			0x73, 0x20, 0x50, 0x74, 0x79, 0x20, 0x4c, 0x74,
-			0x64, 0x30, 0x81, 0x9f, 0x30, 0x0d, 0x06, 0x09,
-			0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01,
-			0x01, 0x05, 0x00, 0x03, 0x81, 0x8d, 0x00, 0x30,
-			0x81, 0x89, 0x02, 0x81, 0x81, 0x00, 0xbb, 0x79,
-			0xd6, 0xf5, 0x17, 0xb5, 0xe5, 0xbf, 0x46, 0x10,
-			0xd0, 0xdc, 0x69, 0xbe, 0xe6, 0x2b, 0x07, 0x43,
-			0x5a, 0xd0, 0x03, 0x2d, 0x8a, 0x7a, 0x43, 0x85,
-			0xb7, 0x14, 0x52, 0xe7, 0xa5, 0x65, 0x4c, 0x2c,
-			0x78, 0xb8, 0x23, 0x8c, 0xb5, 0xb4, 0x82, 0xe5,
-			0xde, 0x1f, 0x95, 0x3b, 0x7e, 0x62, 0xa5, 0x2c,
-			0xa5, 0x33, 0xd6, 0xfe, 0x12, 0x5c, 0x7a, 0x56,
-			0xfc, 0xf5, 0x06, 0xbf, 0xfa, 0x58, 0x7b, 0x26,
-			0x3f, 0xb5, 0xcd, 0x04, 0xd3, 0xd0, 0xc9, 0x21,
-			0x96, 0x4a, 0xc7, 0xf4, 0x54, 0x9f, 0x5a, 0xbf,
-			0xef, 0x42, 0x71, 0x00, 0xfe, 0x18, 0x99, 0x07,
-			0x7f, 0x7e, 0x88, 0x7d, 0x7d, 0xf1, 0x04, 0x39,
-			0xc4, 0xa2, 0x2e, 0xdb, 0x51, 0xc9, 0x7c, 0xe3,
-			0xc0, 0x4c, 0x3b, 0x32, 0x66, 0x01, 0xcf, 0xaf,
-			0xb1, 0x1d, 0xb8, 0x71, 0x9a, 0x1d, 0xdb, 0xdb,
-			0x89, 0x6b, 0xae, 0xda, 0x2d, 0x79, 0x02, 0x03,
-			0x01, 0x00, 0x01, 0xa3, 0x81, 0xa7, 0x30, 0x81,
-			0xa4, 0x30, 0x1d, 0x06, 0x03, 0x55, 0x1d, 0x0e,
-			0x04, 0x16, 0x04, 0x14, 0xb1, 0xad, 0xe2, 0x85,
-			0x5a, 0xcf, 0xcb, 0x28, 0xdb, 0x69, 0xce, 0x23,
-			0x69, 0xde, 0xd3, 0x26, 0x8e, 0x18, 0x88, 0x39,
-			0x30, 0x75, 0x06, 0x03, 0x55, 0x1d, 0x23, 0x04,
-			0x6e, 0x30, 0x6c, 0x80, 0x14, 0xb1, 0xad, 0xe2,
-			0x85, 0x5a, 0xcf, 0xcb, 0x28, 0xdb, 0x69, 0xce,
-			0x23, 0x69, 0xde, 0xd3, 0x26, 0x8e, 0x18, 0x88,
-			0x39, 0xa1, 0x49, 0xa4, 0x47, 0x30, 0x45, 0x31,
-			0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06,
-			0x13, 0x02, 0x41, 0x55, 0x31, 0x13, 0x30, 0x11,
-			0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0a, 0x53,
-			0x6f, 0x6d, 0x65, 0x2d, 0x53, 0x74, 0x61, 0x74,
-			0x65, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x03, 0x55,
-			0x04, 0x0a, 0x13, 0x18, 0x49, 0x6e, 0x74, 0x65,
-			0x72, 0x6e, 0x65, 0x74, 0x20, 0x57, 0x69, 0x64,
-			0x67, 0x69, 0x74, 0x73, 0x20, 0x50, 0x74, 0x79,
-			0x20, 0x4c, 0x74, 0x64, 0x82, 0x09, 0x00, 0x85,
-			0xb0, 0xbb, 0xa4, 0x8a, 0x7f, 0xb8, 0xca, 0x30,
-			0x0c, 0x06, 0x03, 0x55, 0x1d, 0x13, 0x04, 0x05,
-			0x30, 0x03, 0x01, 0x01, 0xff, 0x30, 0x0d, 0x06,
-			0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01,
-			0x01, 0x05, 0x05, 0x00, 0x03, 0x81, 0x81, 0x00,
-			0x08, 0x6c, 0x45, 0x24, 0xc7, 0x6b, 0xb1, 0x59,
-			0xab, 0x0c, 0x52, 0xcc, 0xf2, 0xb0, 0x14, 0xd7,
-			0x87, 0x9d, 0x7a, 0x64, 0x75, 0xb5, 0x5a, 0x95,
-			0x66, 0xe4, 0xc5, 0x2b, 0x8e, 0xae, 0x12, 0x66,
-			0x1f, 0xeb, 0x4f, 0x38, 0xb3, 0x6e, 0x60, 0xd3,
-			0x92, 0xfd, 0xf7, 0x41, 0x08, 0xb5, 0x25, 0x13,
-			0xb1, 0x18, 0x7a, 0x24, 0xfb, 0x30, 0x1d, 0xba,
-			0xed, 0x98, 0xb9, 0x17, 0xec, 0xe7, 0xd7, 0x31,
-			0x59, 0xdb, 0x95, 0xd3, 0x1d, 0x78, 0xea, 0x50,
-			0x56, 0x5c, 0xd5, 0x82, 0x5a, 0x2d, 0x5a, 0x5f,
-			0x33, 0xc4, 0xb6, 0xd8, 0xc9, 0x75, 0x90, 0x96,
-			0x8c, 0x0f, 0x52, 0x98, 0xb5, 0xcd, 0x98, 0x1f,
-			0x89, 0x20, 0x5f, 0xf2, 0xa0, 0x1c, 0xa3, 0x1b,
-			0x96, 0x94, 0xdd, 0xa9, 0xfd, 0x57, 0xe9, 0x70,
-			0xe8, 0x26, 0x6d, 0x71, 0x99, 0x9b, 0x26, 0x6e,
-			0x38, 0x50, 0x29, 0x6c, 0x90, 0xa7, 0xbd, 0xd9,
-			0x16, 0x03, 0x01, 0x00, 0x09, 0x0d, 0x00, 0x00,
-			0x05, 0x02, 0x01, 0x40, 0x00, 0x00, 0x16, 0x03,
-			0x01, 0x00, 0x04, 0x0e, 0x00, 0x00, 0x00,
-		},
-		{
-			0x16, 0x03, 0x01, 0x00, 0x07, 0x0b, 0x00, 0x00,
-			0x03, 0x00, 0x00, 0x00, 0x16, 0x03, 0x01, 0x00,
-			0x86, 0x10, 0x00, 0x00, 0x82, 0x00, 0x80, 0x36,
-			0xfc, 0xd8, 0xc8, 0xa2, 0x67, 0xc8, 0xc6, 0xf4,
-			0x28, 0x70, 0xe1, 0x5a, 0x02, 0x8f, 0xef, 0x42,
-			0xe0, 0xd3, 0xb8, 0xd6, 0x6b, 0xe4, 0xee, 0x5c,
-			0xcf, 0x42, 0xc4, 0xfa, 0xcd, 0x0f, 0xfe, 0xf4,
-			0x76, 0x76, 0x47, 0x73, 0xa8, 0x72, 0x8f, 0xa2,
-			0x56, 0x81, 0x83, 0xb8, 0x84, 0x72, 0x67, 0xdd,
-			0xbe, 0x05, 0x4b, 0x84, 0xd9, 0xd2, 0xb6, 0xc2,
-			0xe7, 0x20, 0xac, 0x1f, 0x46, 0x9d, 0x05, 0x47,
-			0x8e, 0x89, 0xc0, 0x42, 0x57, 0x4a, 0xa2, 0x98,
-			0xe5, 0x39, 0x4f, 0xc4, 0x27, 0x6d, 0x43, 0xa8,
-			0x83, 0x76, 0xe6, 0xad, 0xe3, 0x17, 0x68, 0x31,
-			0xcb, 0x7e, 0xfc, 0xe7, 0x4b, 0x76, 0x3d, 0x3c,
-			0xfa, 0x77, 0x65, 0xc9, 0x4c, 0x5b, 0xce, 0x5e,
-			0xf7, 0x8b, 0xa8, 0xa6, 0xdd, 0xb2, 0xef, 0x0b,
-			0x46, 0x83, 0xdf, 0x0a, 0x8c, 0x22, 0x12, 0x6e,
-			0xe1, 0x45, 0x54, 0x88, 0xd1, 0xe8, 0xd2, 0x14,
-			0x03, 0x01, 0x00, 0x01, 0x01, 0x16, 0x03, 0x01,
-			0x00, 0x24, 0x30, 0x8c, 0x7d, 0x40, 0xfc, 0x5e,
-			0x80, 0x9c, 0xc4, 0x7c, 0x62, 0x01, 0xa1, 0x37,
-			0xcf, 0x1a, 0x75, 0x28, 0x8d, 0xeb, 0x63, 0xcc,
-			0x02, 0xa6, 0x66, 0xdf, 0x36, 0x01, 0xb3, 0x9d,
-			0x38, 0x42, 0x16, 0x91, 0xf0, 0x02,
-		},
-		{
-			0x16, 0x03, 0x01, 0x00, 0x72, 0x04, 0x00, 0x00,
-			0x6e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x68, 0x00,
-			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x65,
-			0xe8, 0x4b, 0xd1, 0xef, 0xba, 0x96, 0x9a, 0x2a,
-			0x6c, 0x8c, 0x7e, 0x38, 0x10, 0x46, 0x86, 0x1d,
-			0x19, 0x1d, 0x62, 0x29, 0x3f, 0x58, 0xfb, 0x6d,
-			0x89, 0xd2, 0x81, 0x9a, 0x1c, 0xb3, 0x58, 0xb3,
-			0x19, 0x39, 0x17, 0x47, 0x49, 0xc9, 0xfe, 0x4a,
-			0x7a, 0x32, 0xac, 0x2c, 0x43, 0xf9, 0xa9, 0xea,
-			0xec, 0x51, 0x46, 0xf1, 0xb8, 0x59, 0x23, 0x70,
-			0xce, 0x7c, 0xb9, 0x47, 0x70, 0xa3, 0xc9, 0xae,
-			0x47, 0x7b, 0x7e, 0xc7, 0xcf, 0x76, 0x12, 0x76,
-			0x18, 0x90, 0x12, 0xcd, 0xf3, 0xd4, 0x27, 0x81,
-			0xfc, 0x46, 0x03, 0x3e, 0x05, 0x87, 0x6f, 0x14,
-			0x03, 0x01, 0x00, 0x01, 0x01, 0x16, 0x03, 0x01,
-			0x00, 0x24, 0xc3, 0xa0, 0x29, 0xb1, 0x52, 0x82,
-			0xef, 0x85, 0xa1, 0x64, 0x0f, 0xe4, 0xa3, 0xfb,
-			0xa7, 0x1d, 0x22, 0x4c, 0xcb, 0xd6, 0x5b, 0x18,
-			0x61, 0xc7, 0x7c, 0xf2, 0x67, 0x4a, 0xc7, 0x11,
-			0x9d, 0x8e, 0x0e, 0x15, 0x22, 0xcf, 0x17, 0x03,
-			0x01, 0x00, 0x21, 0xfd, 0xbb, 0xf1, 0xa9, 0x7c,
-			0xbf, 0x92, 0xb3, 0xfa, 0x2c, 0x08, 0x6f, 0x22,
-			0x78, 0x80, 0xf2, 0x2e, 0x86, 0x26, 0x21, 0x36,
-			0x3f, 0x32, 0xdf, 0xb6, 0x47, 0xa5, 0xf8, 0x27,
-			0xc1, 0xe9, 0x53, 0x90, 0x15, 0x03, 0x01, 0x00,
-			0x16, 0xfe, 0xef, 0x2e, 0xa0, 0x5d, 0xe0, 0xce,
-			0x94, 0x20, 0x56, 0x61, 0x6e, 0xe5, 0x62, 0xce,
-			0x27, 0x57, 0x3e, 0x30, 0x32, 0x77, 0x53,
-		},
-	}},
-
-	// Server asks for cert with empty CA list, client gives one
-	// go test -run "TestRunServer" -serve -clientauth 1
-	{"RequestClientCert, client gives it", RequestClientCert, []*x509.Certificate{clientCertificate}, [][]byte{
-		{
-			0x16, 0x03, 0x01, 0x01, 0x1e, 0x01, 0x00, 0x01,
-			0x1a, 0x03, 0x03, 0x51, 0xe5, 0x74, 0x0e, 0x95,
-			0x6f, 0x4f, 0x4a, 0xbf, 0xb7, 0xc0, 0x6c, 0xac,
-			0xd9, 0xfe, 0x7d, 0xd0, 0x51, 0x19, 0x62, 0x62,
-			0x1c, 0x6e, 0x57, 0x77, 0xd2, 0x31, 0xaf, 0x88,
-			0xb9, 0xc0, 0x1d, 0x00, 0x00, 0x82, 0xc0, 0x30,
-			0xc0, 0x2c, 0xc0, 0x28, 0xc0, 0x24, 0xc0, 0x14,
-			0xc0, 0x0a, 0x00, 0xa3, 0x00, 0x9f, 0x00, 0x6b,
-			0x00, 0x6a, 0x00, 0x39, 0x00, 0x38, 0xc0, 0x32,
-			0xc0, 0x2e, 0xc0, 0x2a, 0xc0, 0x26, 0xc0, 0x0f,
-			0xc0, 0x05, 0x00, 0x9d, 0x00, 0x3d, 0x00, 0x35,
-			0xc0, 0x12, 0xc0, 0x08, 0x00, 0x16, 0x00, 0x13,
-			0xc0, 0x0d, 0xc0, 0x03, 0x00, 0x0a, 0xc0, 0x2f,
-			0xc0, 0x2b, 0xc0, 0x27, 0xc0, 0x23, 0xc0, 0x13,
-			0xc0, 0x09, 0x00, 0xa2, 0x00, 0x9e, 0x00, 0x67,
-			0x00, 0x40, 0x00, 0x33, 0x00, 0x32, 0xc0, 0x31,
-			0xc0, 0x2d, 0xc0, 0x29, 0xc0, 0x25, 0xc0, 0x0e,
-			0xc0, 0x04, 0x00, 0x9c, 0x00, 0x3c, 0x00, 0x2f,
-			0x00, 0x07, 0xc0, 0x11, 0xc0, 0x07, 0xc0, 0x0c,
-			0xc0, 0x02, 0x00, 0x05, 0x00, 0x04, 0x00, 0x15,
-			0x00, 0x12, 0x00, 0x09, 0x00, 0x14, 0x00, 0x11,
-			0x00, 0x08, 0x00, 0x06, 0x00, 0x03, 0x00, 0xff,
-			0x01, 0x00, 0x00, 0x6f, 0x00, 0x0b, 0x00, 0x04,
-			0x03, 0x00, 0x01, 0x02, 0x00, 0x0a, 0x00, 0x34,
-			0x00, 0x32, 0x00, 0x0e, 0x00, 0x0d, 0x00, 0x19,
-			0x00, 0x0b, 0x00, 0x0c, 0x00, 0x18, 0x00, 0x09,
-			0x00, 0x0a, 0x00, 0x16, 0x00, 0x17, 0x00, 0x08,
-			0x00, 0x06, 0x00, 0x07, 0x00, 0x14, 0x00, 0x15,
-			0x00, 0x04, 0x00, 0x05, 0x00, 0x12, 0x00, 0x13,
-			0x00, 0x01, 0x00, 0x02, 0x00, 0x03, 0x00, 0x0f,
-			0x00, 0x10, 0x00, 0x11, 0x00, 0x23, 0x00, 0x00,
-			0x00, 0x0d, 0x00, 0x22, 0x00, 0x20, 0x06, 0x01,
-			0x06, 0x02, 0x06, 0x03, 0x05, 0x01, 0x05, 0x02,
-			0x05, 0x03, 0x04, 0x01, 0x04, 0x02, 0x04, 0x03,
-			0x03, 0x01, 0x03, 0x02, 0x03, 0x03, 0x02, 0x01,
-			0x02, 0x02, 0x02, 0x03, 0x01, 0x01, 0x00, 0x0f,
-			0x00, 0x01, 0x01,
-		},
-		{
-			0x16, 0x03, 0x01, 0x00, 0x30, 0x02, 0x00, 0x00,
-			0x2c, 0x03, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00,
-			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-			0x00, 0x00, 0x00, 0x00, 0x00, 0x05, 0x00, 0x00,
-			0x04, 0x00, 0x23, 0x00, 0x00, 0x16, 0x03, 0x01,
-			0x02, 0xbe, 0x0b, 0x00, 0x02, 0xba, 0x00, 0x02,
-			0xb7, 0x00, 0x02, 0xb4, 0x30, 0x82, 0x02, 0xb0,
-			0x30, 0x82, 0x02, 0x19, 0xa0, 0x03, 0x02, 0x01,
-			0x02, 0x02, 0x09, 0x00, 0x85, 0xb0, 0xbb, 0xa4,
-			0x8a, 0x7f, 0xb8, 0xca, 0x30, 0x0d, 0x06, 0x09,
-			0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01,
-			0x05, 0x05, 0x00, 0x30, 0x45, 0x31, 0x0b, 0x30,
-			0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02,
-			0x41, 0x55, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03,
-			0x55, 0x04, 0x08, 0x13, 0x0a, 0x53, 0x6f, 0x6d,
-			0x65, 0x2d, 0x53, 0x74, 0x61, 0x74, 0x65, 0x31,
-			0x21, 0x30, 0x1f, 0x06, 0x03, 0x55, 0x04, 0x0a,
-			0x13, 0x18, 0x49, 0x6e, 0x74, 0x65, 0x72, 0x6e,
-			0x65, 0x74, 0x20, 0x57, 0x69, 0x64, 0x67, 0x69,
-			0x74, 0x73, 0x20, 0x50, 0x74, 0x79, 0x20, 0x4c,
-			0x74, 0x64, 0x30, 0x1e, 0x17, 0x0d, 0x31, 0x30,
-			0x30, 0x34, 0x32, 0x34, 0x30, 0x39, 0x30, 0x39,
-			0x33, 0x38, 0x5a, 0x17, 0x0d, 0x31, 0x31, 0x30,
-			0x34, 0x32, 0x34, 0x30, 0x39, 0x30, 0x39, 0x33,
-			0x38, 0x5a, 0x30, 0x45, 0x31, 0x0b, 0x30, 0x09,
-			0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x41,
-			0x55, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03, 0x55,
-			0x04, 0x08, 0x13, 0x0a, 0x53, 0x6f, 0x6d, 0x65,
-			0x2d, 0x53, 0x74, 0x61, 0x74, 0x65, 0x31, 0x21,
-			0x30, 0x1f, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13,
-			0x18, 0x49, 0x6e, 0x74, 0x65, 0x72, 0x6e, 0x65,
-			0x74, 0x20, 0x57, 0x69, 0x64, 0x67, 0x69, 0x74,
-			0x73, 0x20, 0x50, 0x74, 0x79, 0x20, 0x4c, 0x74,
-			0x64, 0x30, 0x81, 0x9f, 0x30, 0x0d, 0x06, 0x09,
-			0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01,
-			0x01, 0x05, 0x00, 0x03, 0x81, 0x8d, 0x00, 0x30,
-			0x81, 0x89, 0x02, 0x81, 0x81, 0x00, 0xbb, 0x79,
-			0xd6, 0xf5, 0x17, 0xb5, 0xe5, 0xbf, 0x46, 0x10,
-			0xd0, 0xdc, 0x69, 0xbe, 0xe6, 0x2b, 0x07, 0x43,
-			0x5a, 0xd0, 0x03, 0x2d, 0x8a, 0x7a, 0x43, 0x85,
-			0xb7, 0x14, 0x52, 0xe7, 0xa5, 0x65, 0x4c, 0x2c,
-			0x78, 0xb8, 0x23, 0x8c, 0xb5, 0xb4, 0x82, 0xe5,
-			0xde, 0x1f, 0x95, 0x3b, 0x7e, 0x62, 0xa5, 0x2c,
-			0xa5, 0x33, 0xd6, 0xfe, 0x12, 0x5c, 0x7a, 0x56,
-			0xfc, 0xf5, 0x06, 0xbf, 0xfa, 0x58, 0x7b, 0x26,
-			0x3f, 0xb5, 0xcd, 0x04, 0xd3, 0xd0, 0xc9, 0x21,
-			0x96, 0x4a, 0xc7, 0xf4, 0x54, 0x9f, 0x5a, 0xbf,
-			0xef, 0x42, 0x71, 0x00, 0xfe, 0x18, 0x99, 0x07,
-			0x7f, 0x7e, 0x88, 0x7d, 0x7d, 0xf1, 0x04, 0x39,
-			0xc4, 0xa2, 0x2e, 0xdb, 0x51, 0xc9, 0x7c, 0xe3,
-			0xc0, 0x4c, 0x3b, 0x32, 0x66, 0x01, 0xcf, 0xaf,
-			0xb1, 0x1d, 0xb8, 0x71, 0x9a, 0x1d, 0xdb, 0xdb,
-			0x89, 0x6b, 0xae, 0xda, 0x2d, 0x79, 0x02, 0x03,
-			0x01, 0x00, 0x01, 0xa3, 0x81, 0xa7, 0x30, 0x81,
-			0xa4, 0x30, 0x1d, 0x06, 0x03, 0x55, 0x1d, 0x0e,
-			0x04, 0x16, 0x04, 0x14, 0xb1, 0xad, 0xe2, 0x85,
-			0x5a, 0xcf, 0xcb, 0x28, 0xdb, 0x69, 0xce, 0x23,
-			0x69, 0xde, 0xd3, 0x26, 0x8e, 0x18, 0x88, 0x39,
-			0x30, 0x75, 0x06, 0x03, 0x55, 0x1d, 0x23, 0x04,
-			0x6e, 0x30, 0x6c, 0x80, 0x14, 0xb1, 0xad, 0xe2,
-			0x85, 0x5a, 0xcf, 0xcb, 0x28, 0xdb, 0x69, 0xce,
-			0x23, 0x69, 0xde, 0xd3, 0x26, 0x8e, 0x18, 0x88,
-			0x39, 0xa1, 0x49, 0xa4, 0x47, 0x30, 0x45, 0x31,
-			0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06,
-			0x13, 0x02, 0x41, 0x55, 0x31, 0x13, 0x30, 0x11,
-			0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0a, 0x53,
-			0x6f, 0x6d, 0x65, 0x2d, 0x53, 0x74, 0x61, 0x74,
-			0x65, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x03, 0x55,
-			0x04, 0x0a, 0x13, 0x18, 0x49, 0x6e, 0x74, 0x65,
-			0x72, 0x6e, 0x65, 0x74, 0x20, 0x57, 0x69, 0x64,
-			0x67, 0x69, 0x74, 0x73, 0x20, 0x50, 0x74, 0x79,
-			0x20, 0x4c, 0x74, 0x64, 0x82, 0x09, 0x00, 0x85,
-			0xb0, 0xbb, 0xa4, 0x8a, 0x7f, 0xb8, 0xca, 0x30,
-			0x0c, 0x06, 0x03, 0x55, 0x1d, 0x13, 0x04, 0x05,
-			0x30, 0x03, 0x01, 0x01, 0xff, 0x30, 0x0d, 0x06,
-			0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01,
-			0x01, 0x05, 0x05, 0x00, 0x03, 0x81, 0x81, 0x00,
-			0x08, 0x6c, 0x45, 0x24, 0xc7, 0x6b, 0xb1, 0x59,
-			0xab, 0x0c, 0x52, 0xcc, 0xf2, 0xb0, 0x14, 0xd7,
-			0x87, 0x9d, 0x7a, 0x64, 0x75, 0xb5, 0x5a, 0x95,
-			0x66, 0xe4, 0xc5, 0x2b, 0x8e, 0xae, 0x12, 0x66,
-			0x1f, 0xeb, 0x4f, 0x38, 0xb3, 0x6e, 0x60, 0xd3,
-			0x92, 0xfd, 0xf7, 0x41, 0x08, 0xb5, 0x25, 0x13,
-			0xb1, 0x18, 0x7a, 0x24, 0xfb, 0x30, 0x1d, 0xba,
-			0xed, 0x98, 0xb9, 0x17, 0xec, 0xe7, 0xd7, 0x31,
-			0x59, 0xdb, 0x95, 0xd3, 0x1d, 0x78, 0xea, 0x50,
-			0x56, 0x5c, 0xd5, 0x82, 0x5a, 0x2d, 0x5a, 0x5f,
-			0x33, 0xc4, 0xb6, 0xd8, 0xc9, 0x75, 0x90, 0x96,
-			0x8c, 0x0f, 0x52, 0x98, 0xb5, 0xcd, 0x98, 0x1f,
-			0x89, 0x20, 0x5f, 0xf2, 0xa0, 0x1c, 0xa3, 0x1b,
-			0x96, 0x94, 0xdd, 0xa9, 0xfd, 0x57, 0xe9, 0x70,
-			0xe8, 0x26, 0x6d, 0x71, 0x99, 0x9b, 0x26, 0x6e,
-			0x38, 0x50, 0x29, 0x6c, 0x90, 0xa7, 0xbd, 0xd9,
-			0x16, 0x03, 0x01, 0x00, 0x09, 0x0d, 0x00, 0x00,
-			0x05, 0x02, 0x01, 0x40, 0x00, 0x00, 0x16, 0x03,
-			0x01, 0x00, 0x04, 0x0e, 0x00, 0x00, 0x00,
-		},
-		{
-			0x16, 0x03, 0x01, 0x01, 0xfb, 0x0b, 0x00, 0x01,
-			0xf7, 0x00, 0x01, 0xf4, 0x00, 0x01, 0xf1, 0x30,
-			0x82, 0x01, 0xed, 0x30, 0x82, 0x01, 0x58, 0xa0,
-			0x03, 0x02, 0x01, 0x02, 0x02, 0x01, 0x00, 0x30,
-			0x0b, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7,
-			0x0d, 0x01, 0x01, 0x05, 0x30, 0x26, 0x31, 0x10,
-			0x30, 0x0e, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13,
-			0x07, 0x41, 0x63, 0x6d, 0x65, 0x20, 0x43, 0x6f,
-			0x31, 0x12, 0x30, 0x10, 0x06, 0x03, 0x55, 0x04,
-			0x03, 0x13, 0x09, 0x31, 0x32, 0x37, 0x2e, 0x30,
-			0x2e, 0x30, 0x2e, 0x31, 0x30, 0x1e, 0x17, 0x0d,
-			0x31, 0x31, 0x31, 0x32, 0x30, 0x38, 0x30, 0x37,
-			0x35, 0x35, 0x31, 0x32, 0x5a, 0x17, 0x0d, 0x31,
-			0x32, 0x31, 0x32, 0x30, 0x37, 0x30, 0x38, 0x30,
-			0x30, 0x31, 0x32, 0x5a, 0x30, 0x26, 0x31, 0x10,
-			0x30, 0x0e, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13,
-			0x07, 0x41, 0x63, 0x6d, 0x65, 0x20, 0x43, 0x6f,
-			0x31, 0x12, 0x30, 0x10, 0x06, 0x03, 0x55, 0x04,
-			0x03, 0x13, 0x09, 0x31, 0x32, 0x37, 0x2e, 0x30,
-			0x2e, 0x30, 0x2e, 0x31, 0x30, 0x81, 0x9c, 0x30,
-			0x0b, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7,
-			0x0d, 0x01, 0x01, 0x01, 0x03, 0x81, 0x8c, 0x00,
-			0x30, 0x81, 0x88, 0x02, 0x81, 0x80, 0x4e, 0xd0,
-			0x7b, 0x31, 0xe3, 0x82, 0x64, 0xd9, 0x59, 0xc0,
-			0xc2, 0x87, 0xa4, 0x5e, 0x1e, 0x8b, 0x73, 0x33,
-			0xc7, 0x63, 0x53, 0xdf, 0x66, 0x92, 0x06, 0x84,
-			0xf6, 0x64, 0xd5, 0x8f, 0xe4, 0x36, 0xa7, 0x1d,
-			0x2b, 0xe8, 0xb3, 0x20, 0x36, 0x45, 0x23, 0xb5,
-			0xe3, 0x95, 0xae, 0xed, 0xe0, 0xf5, 0x20, 0x9c,
-			0x8d, 0x95, 0xdf, 0x7f, 0x5a, 0x12, 0xef, 0x87,
-			0xe4, 0x5b, 0x68, 0xe4, 0xe9, 0x0e, 0x74, 0xec,
-			0x04, 0x8a, 0x7f, 0xde, 0x93, 0x27, 0xc4, 0x01,
-			0x19, 0x7a, 0xbd, 0xf2, 0xdc, 0x3d, 0x14, 0xab,
-			0xd0, 0x54, 0xca, 0x21, 0x0c, 0xd0, 0x4d, 0x6e,
-			0x87, 0x2e, 0x5c, 0xc5, 0xd2, 0xbb, 0x4d, 0x4b,
-			0x4f, 0xce, 0xb6, 0x2c, 0xf7, 0x7e, 0x88, 0xec,
-			0x7c, 0xd7, 0x02, 0x91, 0x74, 0xa6, 0x1e, 0x0c,
-			0x1a, 0xda, 0xe3, 0x4a, 0x5a, 0x2e, 0xde, 0x13,
-			0x9c, 0x4c, 0x40, 0x88, 0x59, 0x93, 0x02, 0x03,
-			0x01, 0x00, 0x01, 0xa3, 0x32, 0x30, 0x30, 0x30,
-			0x0e, 0x06, 0x03, 0x55, 0x1d, 0x0f, 0x01, 0x01,
-			0xff, 0x04, 0x04, 0x03, 0x02, 0x00, 0xa0, 0x30,
-			0x0d, 0x06, 0x03, 0x55, 0x1d, 0x0e, 0x04, 0x06,
-			0x04, 0x04, 0x01, 0x02, 0x03, 0x04, 0x30, 0x0f,
-			0x06, 0x03, 0x55, 0x1d, 0x23, 0x04, 0x08, 0x30,
-			0x06, 0x80, 0x04, 0x01, 0x02, 0x03, 0x04, 0x30,
-			0x0b, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7,
-			0x0d, 0x01, 0x01, 0x05, 0x03, 0x81, 0x81, 0x00,
-			0x36, 0x1f, 0xb3, 0x7a, 0x0c, 0x75, 0xc9, 0x6e,
-			0x37, 0x46, 0x61, 0x2b, 0xd5, 0xbd, 0xc0, 0xa7,
-			0x4b, 0xcc, 0x46, 0x9a, 0x81, 0x58, 0x7c, 0x85,
-			0x79, 0x29, 0xc8, 0xc8, 0xc6, 0x67, 0xdd, 0x32,
-			0x56, 0x45, 0x2b, 0x75, 0xb6, 0xe9, 0x24, 0xa9,
-			0x50, 0x9a, 0xbe, 0x1f, 0x5a, 0xfa, 0x1a, 0x15,
-			0xd9, 0xcc, 0x55, 0x95, 0x72, 0x16, 0x83, 0xb9,
-			0xc2, 0xb6, 0x8f, 0xfd, 0x88, 0x8c, 0x38, 0x84,
-			0x1d, 0xab, 0x5d, 0x92, 0x31, 0x13, 0x4f, 0xfd,
-			0x83, 0x3b, 0xc6, 0x9d, 0xf1, 0x11, 0x62, 0xb6,
-			0x8b, 0xec, 0xab, 0x67, 0xbe, 0xc8, 0x64, 0xb0,
-			0x11, 0x50, 0x46, 0x58, 0x17, 0x6b, 0x99, 0x1c,
-			0xd3, 0x1d, 0xfc, 0x06, 0xf1, 0x0e, 0xe5, 0x96,
-			0xa8, 0x0c, 0xf9, 0x78, 0x20, 0xb7, 0x44, 0x18,
-			0x51, 0x8d, 0x10, 0x7e, 0x4f, 0x94, 0x67, 0xdf,
-			0xa3, 0x4e, 0x70, 0x73, 0x8e, 0x90, 0x91, 0x85,
-			0x16, 0x03, 0x01, 0x00, 0x86, 0x10, 0x00, 0x00,
-			0x82, 0x00, 0x80, 0x0a, 0x4e, 0x89, 0xdf, 0x3a,
-			0x3f, 0xf0, 0x4f, 0xef, 0x1a, 0x90, 0xd4, 0x3c,
-			0xaf, 0x10, 0x57, 0xb0, 0xa1, 0x5f, 0xcd, 0x62,
-			0x01, 0xe9, 0x0c, 0x36, 0x42, 0xfd, 0xaf, 0x23,
-			0xf9, 0x14, 0xa6, 0x72, 0x26, 0x4e, 0x01, 0xdb,
-			0xac, 0xb7, 0x4c, 0xe6, 0xa9, 0x52, 0xe2, 0xec,
-			0x26, 0x8c, 0x7a, 0x64, 0xf8, 0x0b, 0x4c, 0x2f,
-			0xa9, 0xcb, 0x75, 0xaf, 0x60, 0xd4, 0xb4, 0xe6,
-			0xe8, 0xdb, 0x78, 0x78, 0x85, 0xf6, 0x0c, 0x95,
-			0xcc, 0xb6, 0x55, 0xb9, 0xba, 0x9e, 0x91, 0xbc,
-			0x66, 0xdb, 0x1e, 0x28, 0xab, 0x73, 0xce, 0x8b,
-			0xd0, 0xd3, 0xe8, 0xbc, 0xd0, 0x21, 0x28, 0xbd,
-			0xfb, 0x74, 0x64, 0xde, 0x3b, 0x3b, 0xd3, 0x4c,
-			0x32, 0x40, 0x82, 0xba, 0x91, 0x1e, 0xe8, 0x47,
-			0xc2, 0x09, 0xb7, 0x16, 0xaa, 0x25, 0xa9, 0x3c,
-			0x6c, 0xa7, 0xf8, 0xc9, 0x54, 0x84, 0xc6, 0xf7,
-			0x56, 0x05, 0xa4, 0x16, 0x03, 0x01, 0x00, 0x86,
-			0x0f, 0x00, 0x00, 0x82, 0x00, 0x80, 0x4b, 0xab,
-			0xda, 0xac, 0x2a, 0xb3, 0xe6, 0x34, 0x55, 0xcd,
-			0xf2, 0x4b, 0x67, 0xe3, 0xd3, 0xff, 0xa3, 0xf4,
-			0x79, 0x82, 0x01, 0x47, 0x8a, 0xe3, 0x9f, 0x89,
-			0x70, 0xbe, 0x24, 0x24, 0xb7, 0x69, 0x60, 0xed,
-			0x55, 0xa0, 0xca, 0x72, 0xb6, 0x4a, 0xbc, 0x1d,
-			0xe2, 0x3f, 0xb5, 0x31, 0xda, 0x02, 0xf6, 0x37,
-			0x51, 0xf8, 0x4c, 0x88, 0x2e, 0xb3, 0x8a, 0xe8,
-			0x7b, 0x4a, 0x90, 0x36, 0xe4, 0xa6, 0x31, 0x95,
-			0x8b, 0xa0, 0xc6, 0x91, 0x12, 0xb9, 0x35, 0x4e,
-			0x72, 0xeb, 0x5c, 0xa2, 0xe8, 0x4c, 0x68, 0xf9,
-			0x69, 0xfa, 0x70, 0x60, 0x6c, 0x7f, 0x32, 0x99,
-			0xf1, 0xc3, 0x2d, 0xb4, 0x59, 0x58, 0x87, 0xaf,
-			0x67, 0x62, 0x90, 0xe7, 0x8d, 0xd0, 0xa3, 0x77,
-			0x33, 0xc2, 0x9b, 0xd5, 0x9c, 0xc7, 0xea, 0x25,
-			0x98, 0x76, 0x9c, 0xe0, 0x6a, 0x03, 0x3a, 0x10,
-			0xfd, 0x10, 0x3d, 0x55, 0x53, 0xa0, 0x14, 0x03,
-			0x01, 0x00, 0x01, 0x01, 0x16, 0x03, 0x01, 0x00,
-			0x24, 0xd5, 0x12, 0xfc, 0xb9, 0x5a, 0xe3, 0x27,
-			0x01, 0xbe, 0xc3, 0x77, 0x17, 0x1a, 0xbb, 0x4f,
-			0xae, 0xd5, 0xa7, 0xee, 0x56, 0x61, 0x0d, 0x40,
-			0xf4, 0xa4, 0xb5, 0xcc, 0x76, 0xfd, 0xbd, 0x13,
-			0x04, 0xe1, 0xb8, 0xc7, 0x36,
-		},
-		{
-			0x16, 0x03, 0x01, 0x02, 0x67, 0x04, 0x00, 0x02,
-			0x63, 0x00, 0x00, 0x00, 0x00, 0x02, 0x5d, 0x00,
-			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x65,
-			0xe8, 0x4b, 0xd1, 0xef, 0xba, 0x1f, 0xe2, 0x69,
-			0x07, 0x7f, 0x85, 0x2d, 0x4e, 0x2a, 0x2e, 0xbd,
-			0x05, 0xe9, 0xc1, 0x6c, 0x9e, 0xbf, 0x47, 0x18,
-			0x91, 0x77, 0xf7, 0xe8, 0xb6, 0x27, 0x37, 0xa6,
-			0x6b, 0x87, 0x29, 0xbb, 0x3b, 0xe5, 0x68, 0x62,
-			0x04, 0x3e, 0xad, 0x4d, 0xff, 0xad, 0xf1, 0x22,
-			0x87, 0x8d, 0xf6, 0x04, 0x3b, 0x59, 0x22, 0xf7,
-			0xfd, 0x88, 0x0e, 0xa4, 0x09, 0xc0, 0x0d, 0x10,
-			0x80, 0x10, 0x79, 0xee, 0x70, 0x96, 0xdb, 0x22,
-			0x8b, 0xb7, 0xac, 0xe0, 0x98, 0xad, 0xe9, 0xe3,
-			0xcb, 0xea, 0x9f, 0xe6, 0x83, 0x28, 0x7c, 0x7e,
-			0x4e, 0x9a, 0x8d, 0xd9, 0xf3, 0x86, 0xf4, 0x89,
-			0x8b, 0x79, 0x8f, 0xbb, 0xe9, 0x74, 0x02, 0x02,
-			0x14, 0x04, 0xea, 0xba, 0x16, 0x10, 0xa1, 0x85,
-			0xbe, 0x4e, 0x4e, 0x92, 0xc5, 0x83, 0xf6, 0x1e,
-			0x1f, 0xd4, 0x25, 0xc2, 0xc2, 0xb9, 0xce, 0x33,
-			0x63, 0x66, 0x79, 0x1f, 0x54, 0x35, 0xc1, 0xe8,
-			0x89, 0x34, 0x78, 0x94, 0x36, 0x14, 0xef, 0x01,
-			0x1f, 0xf1, 0xbd, 0x77, 0x2c, 0x4d, 0xac, 0x5c,
-			0x5c, 0x4a, 0xc6, 0xed, 0xd8, 0x0e, 0x72, 0x84,
-			0x83, 0xdc, 0x56, 0x84, 0xc8, 0xf3, 0x89, 0x56,
-			0xfd, 0x89, 0xc1, 0xc9, 0x9a, 0x29, 0x91, 0x7e,
-			0x19, 0xe9, 0x8b, 0x5b, 0x11, 0x15, 0x4e, 0x6c,
-			0xf4, 0x89, 0xe7, 0x6d, 0x68, 0x1e, 0xf9, 0x6c,
-			0x23, 0x72, 0x05, 0x68, 0x82, 0x60, 0x84, 0x1f,
-			0x83, 0x20, 0x09, 0x86, 0x10, 0x81, 0xec, 0xec,
-			0xdc, 0x25, 0x53, 0x20, 0xfa, 0xa9, 0x41, 0x64,
-			0xd6, 0x20, 0xf3, 0xf4, 0x52, 0xf2, 0x80, 0x62,
-			0x83, 0xc9, 0x23, 0x66, 0x44, 0x95, 0x5a, 0x99,
-			0x8a, 0xe1, 0x26, 0x63, 0xc1, 0x8b, 0x31, 0xf9,
-			0x21, 0x06, 0x77, 0x04, 0x27, 0xf2, 0x0c, 0x63,
-			0x83, 0x45, 0xa0, 0xa9, 0x7b, 0xcf, 0xdf, 0xd7,
-			0x56, 0x75, 0xbc, 0xdd, 0x95, 0x36, 0xb1, 0x75,
-			0x39, 0x05, 0x00, 0x3c, 0x8a, 0x79, 0xd6, 0xe9,
-			0xf0, 0x4b, 0xdc, 0x51, 0x6b, 0x01, 0x94, 0x16,
-			0x87, 0x12, 0x92, 0x6c, 0x07, 0xc1, 0xf5, 0x58,
-			0xb7, 0x2a, 0x81, 0xf5, 0xa0, 0x37, 0x8b, 0xa6,
-			0x22, 0xfe, 0x28, 0x0a, 0x7e, 0x68, 0xe2, 0xda,
-			0x6c, 0x53, 0xee, 0x0e, 0x8d, 0x2d, 0x8b, 0x0b,
-			0xda, 0xf8, 0x99, 0x3e, 0x0e, 0xed, 0x9f, 0xc1,
-			0x2b, 0xf6, 0xfe, 0xe9, 0x52, 0x38, 0x7b, 0x83,
-			0x9a, 0x50, 0xa6, 0xd7, 0x49, 0x83, 0x43, 0x7e,
-			0x82, 0xec, 0xc7, 0x09, 0x3d, 0x3d, 0xb1, 0xee,
-			0xe8, 0xc5, 0x6a, 0xc3, 0x3d, 0x4b, 0x4c, 0x6a,
-			0xbb, 0x0b, 0x2c, 0x24, 0x2e, 0xdb, 0x7d, 0x57,
-			0x87, 0xb4, 0x80, 0xa5, 0xae, 0xff, 0x54, 0xa8,
-			0xa5, 0x27, 0x69, 0x95, 0xc8, 0xe7, 0x79, 0xc7,
-			0x89, 0x2a, 0x73, 0x49, 0xcb, 0xf5, 0xc5, 0xbc,
-			0x4a, 0xe0, 0x73, 0xa9, 0xbc, 0x88, 0x64, 0x96,
-			0x98, 0xa5, 0x1e, 0xe3, 0x43, 0xc1, 0x7d, 0x78,
-			0xc7, 0x94, 0x72, 0xd4, 0x2c, 0x6e, 0x85, 0x39,
-			0x9a, 0xaf, 0xdb, 0xa1, 0xe9, 0xe2, 0xcb, 0x37,
-			0x04, 0xc6, 0x8c, 0x81, 0xd3, 0x2a, 0xb7, 0xbe,
-			0x6c, 0x07, 0x1f, 0x5e, 0xd9, 0x00, 0xd2, 0xf7,
-			0xe1, 0xa7, 0xbc, 0x0c, 0xb6, 0x6d, 0xfb, 0x3f,
-			0x3d, 0x24, 0xaa, 0xfb, 0x7e, 0xe1, 0xb5, 0x1b,
-			0xff, 0x38, 0xaa, 0x69, 0x59, 0x38, 0x52, 0x9a,
-			0x0e, 0x6d, 0xbc, 0xde, 0x4f, 0x13, 0x09, 0x17,
-			0xc4, 0xa9, 0x05, 0x84, 0xbc, 0x50, 0xef, 0x40,
-			0xb0, 0x4c, 0x24, 0x32, 0xed, 0x94, 0x2c, 0xdd,
-			0xda, 0x20, 0x24, 0x67, 0xe2, 0xea, 0x71, 0x3d,
-			0x4a, 0x04, 0x0d, 0x98, 0x29, 0x20, 0x4c, 0xeb,
-			0x70, 0xce, 0x45, 0x9e, 0x5a, 0xaf, 0xb6, 0xa3,
-			0x92, 0xc8, 0x28, 0xf2, 0xe3, 0xe8, 0x8a, 0x5d,
-			0x0a, 0x33, 0x79, 0x9b, 0x6a, 0xf3, 0x30, 0x01,
-			0x1d, 0x47, 0xbd, 0x01, 0xcc, 0x4d, 0x71, 0xc0,
-			0x56, 0xfa, 0xfd, 0x37, 0xed, 0x0f, 0x27, 0xc0,
-			0xbb, 0xa0, 0xee, 0xc3, 0x79, 0x8b, 0xe7, 0x41,
-			0x8f, 0xfa, 0x3a, 0xcb, 0x45, 0x3b, 0x85, 0x9f,
-			0x06, 0x90, 0xb2, 0x51, 0x7a, 0xc3, 0x11, 0x41,
-			0x4b, 0xe3, 0x26, 0x94, 0x3e, 0xa2, 0xfd, 0x0a,
-			0xda, 0x50, 0xf6, 0x50, 0x78, 0x19, 0x6c, 0x52,
-			0xd1, 0x12, 0x76, 0xc2, 0x50, 0x2f, 0x0b, 0xca,
-			0x33, 0xe5, 0x79, 0x93, 0x14, 0x03, 0x01, 0x00,
-			0x01, 0x01, 0x16, 0x03, 0x01, 0x00, 0x24, 0x2b,
-			0x51, 0x42, 0x95, 0x6b, 0xca, 0x9f, 0x42, 0x5d,
-			0xd2, 0xd9, 0x67, 0xf9, 0x49, 0x30, 0xfd, 0x2a,
-			0x46, 0xd3, 0x04, 0xf4, 0x86, 0xf9, 0x11, 0x34,
-			0x82, 0xac, 0xe2, 0xc2, 0x2d, 0xc4, 0xd0, 0xfe,
-			0xa9, 0xc9, 0x4b, 0x17, 0x03, 0x01, 0x00, 0x21,
-			0x65, 0x1c, 0xe9, 0x5c, 0xb6, 0xe2, 0x7c, 0x8e,
-			0x49, 0x12, 0x1b, 0xe6, 0x40, 0xd3, 0x97, 0x21,
-			0x76, 0x01, 0xe5, 0x80, 0x5e, 0xf3, 0x11, 0x47,
-			0x25, 0x02, 0x78, 0x8e, 0x6b, 0xae, 0xb3, 0xf3,
-			0x59, 0x15, 0x03, 0x01, 0x00, 0x16, 0x38, 0xc1,
-			0x99, 0x2e, 0xf8, 0x6f, 0x45, 0xa4, 0x10, 0x79,
-			0x5b, 0xc1, 0x47, 0x9a, 0xf6, 0x5c, 0x90, 0xeb,
-			0xa6, 0xe3, 0x1a, 0x24,
+	test := &serverTest{
+		name:   "CipherSuiteCertPreferenceRSA",
+		config: &config,
+	}
+	runServerTestTLS12(t, test)
+
+	config = *testConfig
+	config.CipherSuites = []uint16{TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA, TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA}
+	config.Certificates = []Certificate{
+		Certificate{
+			Certificate: [][]byte{testECDSACertificate},
+			PrivateKey:  testECDSAPrivateKey,
 		},
-	}},
-}
+	}
+	config.BuildNameToCertificate()
+	config.PreferServerCipherSuites = true
 
-var tls11ECDHEAESServerScript = [][]byte{
-	{
-		0x16, 0x03, 0x01, 0x01, 0x46, 0x01, 0x00, 0x01,
-		0x42, 0x03, 0x03, 0x51, 0x9f, 0xa3, 0xb0, 0xb7,
-		0x1d, 0x26, 0x93, 0x36, 0xc0, 0x8d, 0x7e, 0xf8,
-		0x4f, 0x6f, 0xc9, 0x3c, 0x31, 0x1e, 0x7f, 0xb1,
-		0xf0, 0xc1, 0x0f, 0xf9, 0x0c, 0xa2, 0xd5, 0xca,
-		0x48, 0xe5, 0x35, 0x00, 0x00, 0xd0, 0xc0, 0x30,
-		0xc0, 0x2c, 0xc0, 0x28, 0xc0, 0x24, 0xc0, 0x14,
-		0xc0, 0x0a, 0xc0, 0x22, 0xc0, 0x21, 0x00, 0xa5,
-		0x00, 0xa3, 0x00, 0xa1, 0x00, 0x9f, 0x00, 0x6b,
-		0x00, 0x6a, 0x00, 0x69, 0x00, 0x68, 0x00, 0x39,
-		0x00, 0x38, 0x00, 0x37, 0x00, 0x36, 0x00, 0x88,
-		0x00, 0x87, 0x00, 0x86, 0x00, 0x85, 0xc0, 0x32,
-		0xc0, 0x2e, 0xc0, 0x2a, 0xc0, 0x26, 0xc0, 0x0f,
-		0xc0, 0x05, 0x00, 0x9d, 0x00, 0x3d, 0x00, 0x35,
-		0x00, 0x84, 0xc0, 0x12, 0xc0, 0x08, 0xc0, 0x1c,
-		0xc0, 0x1b, 0x00, 0x16, 0x00, 0x13, 0x00, 0x10,
-		0x00, 0x0d, 0xc0, 0x0d, 0xc0, 0x03, 0x00, 0x0a,
-		0xc0, 0x2f, 0xc0, 0x2b, 0xc0, 0x27, 0xc0, 0x23,
-		0xc0, 0x13, 0xc0, 0x09, 0xc0, 0x1f, 0xc0, 0x1e,
-		0x00, 0xa4, 0x00, 0xa2, 0x00, 0xa0, 0x00, 0x9e,
-		0x00, 0x67, 0x00, 0x40, 0x00, 0x3f, 0x00, 0x3e,
-		0x00, 0x33, 0x00, 0x32, 0x00, 0x31, 0x00, 0x30,
-		0x00, 0x9a, 0x00, 0x99, 0x00, 0x98, 0x00, 0x97,
-		0x00, 0x45, 0x00, 0x44, 0x00, 0x43, 0x00, 0x42,
-		0xc0, 0x31, 0xc0, 0x2d, 0xc0, 0x29, 0xc0, 0x25,
-		0xc0, 0x0e, 0xc0, 0x04, 0x00, 0x9c, 0x00, 0x3c,
-		0x00, 0x2f, 0x00, 0x96, 0x00, 0x41, 0x00, 0x07,
-		0xc0, 0x11, 0xc0, 0x07, 0xc0, 0x0c, 0xc0, 0x02,
-		0x00, 0x05, 0x00, 0x04, 0x00, 0x15, 0x00, 0x12,
-		0x00, 0x0f, 0x00, 0x0c, 0x00, 0x09, 0x00, 0x14,
-		0x00, 0x11, 0x00, 0x0e, 0x00, 0x0b, 0x00, 0x08,
-		0x00, 0x06, 0x00, 0x03, 0x00, 0xff, 0x01, 0x00,
-		0x00, 0x49, 0x00, 0x0b, 0x00, 0x04, 0x03, 0x00,
-		0x01, 0x02, 0x00, 0x0a, 0x00, 0x34, 0x00, 0x32,
-		0x00, 0x0e, 0x00, 0x0d, 0x00, 0x19, 0x00, 0x0b,
-		0x00, 0x0c, 0x00, 0x18, 0x00, 0x09, 0x00, 0x0a,
-		0x00, 0x16, 0x00, 0x17, 0x00, 0x08, 0x00, 0x06,
-		0x00, 0x07, 0x00, 0x14, 0x00, 0x15, 0x00, 0x04,
-		0x00, 0x05, 0x00, 0x12, 0x00, 0x13, 0x00, 0x01,
-		0x00, 0x02, 0x00, 0x03, 0x00, 0x0f, 0x00, 0x10,
-		0x00, 0x11, 0x00, 0x23, 0x00, 0x00, 0x00, 0x0f,
-		0x00, 0x01, 0x01,
-	},
-	{
-		0x16, 0x03, 0x02, 0x00, 0x30, 0x02, 0x00, 0x00,
-		0x2c, 0x03, 0x02, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0xc0, 0x13, 0x00, 0x00,
-		0x04, 0x00, 0x23, 0x00, 0x00, 0x16, 0x03, 0x02,
-		0x02, 0xbe, 0x0b, 0x00, 0x02, 0xba, 0x00, 0x02,
-		0xb7, 0x00, 0x02, 0xb4, 0x30, 0x82, 0x02, 0xb0,
-		0x30, 0x82, 0x02, 0x19, 0xa0, 0x03, 0x02, 0x01,
-		0x02, 0x02, 0x09, 0x00, 0x85, 0xb0, 0xbb, 0xa4,
-		0x8a, 0x7f, 0xb8, 0xca, 0x30, 0x0d, 0x06, 0x09,
-		0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01,
-		0x05, 0x05, 0x00, 0x30, 0x45, 0x31, 0x0b, 0x30,
-		0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02,
-		0x41, 0x55, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03,
-		0x55, 0x04, 0x08, 0x13, 0x0a, 0x53, 0x6f, 0x6d,
-		0x65, 0x2d, 0x53, 0x74, 0x61, 0x74, 0x65, 0x31,
-		0x21, 0x30, 0x1f, 0x06, 0x03, 0x55, 0x04, 0x0a,
-		0x13, 0x18, 0x49, 0x6e, 0x74, 0x65, 0x72, 0x6e,
-		0x65, 0x74, 0x20, 0x57, 0x69, 0x64, 0x67, 0x69,
-		0x74, 0x73, 0x20, 0x50, 0x74, 0x79, 0x20, 0x4c,
-		0x74, 0x64, 0x30, 0x1e, 0x17, 0x0d, 0x31, 0x30,
-		0x30, 0x34, 0x32, 0x34, 0x30, 0x39, 0x30, 0x39,
-		0x33, 0x38, 0x5a, 0x17, 0x0d, 0x31, 0x31, 0x30,
-		0x34, 0x32, 0x34, 0x30, 0x39, 0x30, 0x39, 0x33,
-		0x38, 0x5a, 0x30, 0x45, 0x31, 0x0b, 0x30, 0x09,
-		0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x41,
-		0x55, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03, 0x55,
-		0x04, 0x08, 0x13, 0x0a, 0x53, 0x6f, 0x6d, 0x65,
-		0x2d, 0x53, 0x74, 0x61, 0x74, 0x65, 0x31, 0x21,
-		0x30, 0x1f, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13,
-		0x18, 0x49, 0x6e, 0x74, 0x65, 0x72, 0x6e, 0x65,
-		0x74, 0x20, 0x57, 0x69, 0x64, 0x67, 0x69, 0x74,
-		0x73, 0x20, 0x50, 0x74, 0x79, 0x20, 0x4c, 0x74,
-		0x64, 0x30, 0x81, 0x9f, 0x30, 0x0d, 0x06, 0x09,
-		0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01,
-		0x01, 0x05, 0x00, 0x03, 0x81, 0x8d, 0x00, 0x30,
-		0x81, 0x89, 0x02, 0x81, 0x81, 0x00, 0xbb, 0x79,
-		0xd6, 0xf5, 0x17, 0xb5, 0xe5, 0xbf, 0x46, 0x10,
-		0xd0, 0xdc, 0x69, 0xbe, 0xe6, 0x2b, 0x07, 0x43,
-		0x5a, 0xd0, 0x03, 0x2d, 0x8a, 0x7a, 0x43, 0x85,
-		0xb7, 0x14, 0x52, 0xe7, 0xa5, 0x65, 0x4c, 0x2c,
-		0x78, 0xb8, 0x23, 0x8c, 0xb5, 0xb4, 0x82, 0xe5,
-		0xde, 0x1f, 0x95, 0x3b, 0x7e, 0x62, 0xa5, 0x2c,
-		0xa5, 0x33, 0xd6, 0xfe, 0x12, 0x5c, 0x7a, 0x56,
-		0xfc, 0xf5, 0x06, 0xbf, 0xfa, 0x58, 0x7b, 0x26,
-		0x3f, 0xb5, 0xcd, 0x04, 0xd3, 0xd0, 0xc9, 0x21,
-		0x96, 0x4a, 0xc7, 0xf4, 0x54, 0x9f, 0x5a, 0xbf,
-		0xef, 0x42, 0x71, 0x00, 0xfe, 0x18, 0x99, 0x07,
-		0x7f, 0x7e, 0x88, 0x7d, 0x7d, 0xf1, 0x04, 0x39,
-		0xc4, 0xa2, 0x2e, 0xdb, 0x51, 0xc9, 0x7c, 0xe3,
-		0xc0, 0x4c, 0x3b, 0x32, 0x66, 0x01, 0xcf, 0xaf,
-		0xb1, 0x1d, 0xb8, 0x71, 0x9a, 0x1d, 0xdb, 0xdb,
-		0x89, 0x6b, 0xae, 0xda, 0x2d, 0x79, 0x02, 0x03,
-		0x01, 0x00, 0x01, 0xa3, 0x81, 0xa7, 0x30, 0x81,
-		0xa4, 0x30, 0x1d, 0x06, 0x03, 0x55, 0x1d, 0x0e,
-		0x04, 0x16, 0x04, 0x14, 0xb1, 0xad, 0xe2, 0x85,
-		0x5a, 0xcf, 0xcb, 0x28, 0xdb, 0x69, 0xce, 0x23,
-		0x69, 0xde, 0xd3, 0x26, 0x8e, 0x18, 0x88, 0x39,
-		0x30, 0x75, 0x06, 0x03, 0x55, 0x1d, 0x23, 0x04,
-		0x6e, 0x30, 0x6c, 0x80, 0x14, 0xb1, 0xad, 0xe2,
-		0x85, 0x5a, 0xcf, 0xcb, 0x28, 0xdb, 0x69, 0xce,
-		0x23, 0x69, 0xde, 0xd3, 0x26, 0x8e, 0x18, 0x88,
-		0x39, 0xa1, 0x49, 0xa4, 0x47, 0x30, 0x45, 0x31,
-		0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06,
-		0x13, 0x02, 0x41, 0x55, 0x31, 0x13, 0x30, 0x11,
-		0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0a, 0x53,
-		0x6f, 0x6d, 0x65, 0x2d, 0x53, 0x74, 0x61, 0x74,
-		0x65, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x03, 0x55,
-		0x04, 0x0a, 0x13, 0x18, 0x49, 0x6e, 0x74, 0x65,
-		0x72, 0x6e, 0x65, 0x74, 0x20, 0x57, 0x69, 0x64,
-		0x67, 0x69, 0x74, 0x73, 0x20, 0x50, 0x74, 0x79,
-		0x20, 0x4c, 0x74, 0x64, 0x82, 0x09, 0x00, 0x85,
-		0xb0, 0xbb, 0xa4, 0x8a, 0x7f, 0xb8, 0xca, 0x30,
-		0x0c, 0x06, 0x03, 0x55, 0x1d, 0x13, 0x04, 0x05,
-		0x30, 0x03, 0x01, 0x01, 0xff, 0x30, 0x0d, 0x06,
-		0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01,
-		0x01, 0x05, 0x05, 0x00, 0x03, 0x81, 0x81, 0x00,
-		0x08, 0x6c, 0x45, 0x24, 0xc7, 0x6b, 0xb1, 0x59,
-		0xab, 0x0c, 0x52, 0xcc, 0xf2, 0xb0, 0x14, 0xd7,
-		0x87, 0x9d, 0x7a, 0x64, 0x75, 0xb5, 0x5a, 0x95,
-		0x66, 0xe4, 0xc5, 0x2b, 0x8e, 0xae, 0x12, 0x66,
-		0x1f, 0xeb, 0x4f, 0x38, 0xb3, 0x6e, 0x60, 0xd3,
-		0x92, 0xfd, 0xf7, 0x41, 0x08, 0xb5, 0x25, 0x13,
-		0xb1, 0x18, 0x7a, 0x24, 0xfb, 0x30, 0x1d, 0xba,
-		0xed, 0x98, 0xb9, 0x17, 0xec, 0xe7, 0xd7, 0x31,
-		0x59, 0xdb, 0x95, 0xd3, 0x1d, 0x78, 0xea, 0x50,
-		0x56, 0x5c, 0xd5, 0x82, 0x5a, 0x2d, 0x5a, 0x5f,
-		0x33, 0xc4, 0xb6, 0xd8, 0xc9, 0x75, 0x90, 0x96,
-		0x8c, 0x0f, 0x52, 0x98, 0xb5, 0xcd, 0x98, 0x1f,
-		0x89, 0x20, 0x5f, 0xf2, 0xa0, 0x1c, 0xa3, 0x1b,
-		0x96, 0x94, 0xdd, 0xa9, 0xfd, 0x57, 0xe9, 0x70,
-		0xe8, 0x26, 0x6d, 0x71, 0x99, 0x9b, 0x26, 0x6e,
-		0x38, 0x50, 0x29, 0x6c, 0x90, 0xa7, 0xbd, 0xd9,
-		0x16, 0x03, 0x02, 0x01, 0x0f, 0x0c, 0x00, 0x01,
-		0x0b, 0x03, 0x00, 0x19, 0x85, 0x04, 0x01, 0x39,
-		0xdc, 0xee, 0x44, 0x17, 0x5e, 0xdb, 0xd7, 0x27,
-		0xaf, 0xb6, 0x56, 0xd9, 0xb4, 0x43, 0x5a, 0x99,
-		0xcf, 0xaa, 0x31, 0x37, 0x0c, 0x6f, 0x3a, 0xa0,
-		0xf8, 0x53, 0xc4, 0x74, 0xd1, 0x91, 0x0a, 0x46,
-		0xf5, 0x38, 0x3b, 0x5c, 0x09, 0xd8, 0x97, 0xdc,
-		0x4b, 0xaa, 0x70, 0x26, 0x48, 0xf2, 0xd6, 0x0b,
-		0x31, 0xc9, 0xf8, 0xd4, 0x98, 0x43, 0xe1, 0x6c,
-		0xd5, 0xc7, 0xb2, 0x8e, 0x0b, 0x01, 0xe6, 0xb6,
-		0x00, 0x28, 0x80, 0x7b, 0xfc, 0x96, 0x8f, 0x0d,
-		0xa2, 0x4f, 0xb0, 0x79, 0xaf, 0xdc, 0x61, 0x28,
-		0x63, 0x33, 0x78, 0xf6, 0x31, 0x39, 0xfd, 0x8a,
-		0xf4, 0x15, 0x18, 0x11, 0xfe, 0xdb, 0xd5, 0x07,
-		0xda, 0x2c, 0xed, 0x49, 0xa0, 0x23, 0xbf, 0xd0,
-		0x3a, 0x38, 0x1d, 0x54, 0xae, 0x1c, 0x7b, 0xea,
-		0x29, 0xee, 0xd0, 0x38, 0xc1, 0x76, 0xa7, 0x7f,
-		0x2a, 0xf4, 0xce, 0x1e, 0xac, 0xcc, 0x94, 0x79,
-		0x90, 0x33, 0x00, 0x80, 0x16, 0x83, 0x9b, 0xf9,
-		0x72, 0xdb, 0x9f, 0x55, 0x02, 0xe1, 0x04, 0xf7,
-		0xb5, 0x3f, 0x4c, 0x71, 0x13, 0x5a, 0x91, 0xe9,
-		0x1d, 0xeb, 0x9d, 0x9c, 0xfb, 0x88, 0xef, 0xca,
-		0xec, 0x7d, 0x9b, 0xdd, 0xd9, 0xee, 0x2b, 0x8e,
-		0xef, 0xf8, 0xb6, 0xc7, 0x7d, 0xfe, 0xda, 0x7f,
-		0x90, 0x2e, 0x53, 0xf1, 0x64, 0x95, 0xfc, 0x66,
-		0xfc, 0x87, 0x27, 0xb6, 0x9f, 0xc8, 0x3a, 0x95,
-		0x68, 0x17, 0xe1, 0x7d, 0xf1, 0x88, 0xe8, 0x17,
-		0x5f, 0x99, 0x90, 0x3f, 0x47, 0x47, 0x81, 0x06,
-		0xe2, 0x8e, 0x22, 0x56, 0x8f, 0xc2, 0x14, 0xe5,
-		0x62, 0xa7, 0x0d, 0x41, 0x3c, 0xc7, 0x4a, 0x0a,
-		0x74, 0x4b, 0xda, 0x00, 0x8e, 0x4f, 0x90, 0xe6,
-		0xd7, 0x68, 0xe5, 0x8b, 0xf2, 0x3f, 0x53, 0x1d,
-		0x7a, 0xe6, 0xb3, 0xe9, 0x8a, 0xc9, 0x4d, 0x19,
-		0xa6, 0xcf, 0xf9, 0xed, 0x5e, 0x26, 0xdc, 0x90,
-		0x1c, 0x41, 0xad, 0x7c, 0x16, 0x03, 0x02, 0x00,
-		0x04, 0x0e, 0x00, 0x00, 0x00,
-	},
-	{
-		0x16, 0x03, 0x02, 0x00, 0x8a, 0x10, 0x00, 0x00,
-		0x86, 0x85, 0x04, 0x01, 0x11, 0xf2, 0xa4, 0x2d,
-		0x1a, 0x75, 0x6c, 0xbc, 0x2d, 0x91, 0x95, 0x07,
-		0xbe, 0xd6, 0x41, 0x7a, 0xbb, 0xc2, 0x7b, 0xa6,
-		0x9b, 0xe3, 0xdc, 0x41, 0x7f, 0x1e, 0x2e, 0xcc,
-		0x6d, 0xa3, 0x85, 0x53, 0x98, 0x9f, 0x2d, 0xe6,
-		0x3c, 0xb9, 0x82, 0xa6, 0x80, 0x53, 0x9b, 0x71,
-		0xfd, 0x27, 0xe5, 0xe5, 0xdf, 0x13, 0xba, 0x56,
-		0x62, 0x30, 0x4a, 0x57, 0x27, 0xa7, 0xcc, 0x26,
-		0x54, 0xe8, 0x65, 0x6e, 0x4d, 0x00, 0xbf, 0x8a,
-		0xcc, 0x89, 0x6a, 0x6c, 0x88, 0xda, 0x79, 0x4f,
-		0xc5, 0xad, 0x6d, 0x1d, 0x7c, 0x53, 0x7b, 0x1a,
-		0x96, 0xf2, 0xf8, 0x30, 0x01, 0x0b, 0xc2, 0xf0,
-		0x78, 0x41, 0xf4, 0x0d, 0xe0, 0xbe, 0xb9, 0x36,
-		0xe0, 0xb7, 0xee, 0x16, 0xeb, 0x25, 0x67, 0x04,
-		0xc0, 0x2e, 0xd8, 0x34, 0x4a, 0x65, 0xa5, 0xf1,
-		0x95, 0x75, 0xc7, 0x39, 0xa9, 0x68, 0xa9, 0x53,
-		0x93, 0x5b, 0xca, 0x7b, 0x7f, 0xc0, 0x63, 0x14,
-		0x03, 0x02, 0x00, 0x01, 0x01, 0x16, 0x03, 0x02,
-		0x00, 0x40, 0x01, 0xb1, 0xae, 0x1b, 0x8a, 0x65,
-		0xf8, 0x37, 0x50, 0x39, 0x76, 0xef, 0xaa, 0xda,
-		0x84, 0xc9, 0x5f, 0x80, 0xdc, 0xfa, 0xe0, 0x46,
-		0x5a, 0xc7, 0x77, 0x9d, 0x76, 0x03, 0xa6, 0xd5,
-		0x0e, 0xbf, 0x25, 0x30, 0x5c, 0x99, 0x7d, 0xcd,
-		0x2b, 0xaa, 0x2e, 0x8c, 0xdd, 0xda, 0xaa, 0xd7,
-		0xf1, 0xf6, 0x33, 0x47, 0x51, 0x1e, 0x83, 0xa1,
-		0x83, 0x04, 0xd2, 0xb2, 0xc8, 0xbc, 0x11, 0xc5,
-		0x1a, 0x87,
-	},
-	{
-		0x16, 0x03, 0x02, 0x00, 0x72, 0x04, 0x00, 0x00,
-		0x6e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x68, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x65,
-		0xeb, 0x8b, 0xc7, 0xef, 0xba, 0xe8, 0x0f, 0x69,
-		0xfe, 0xfb, 0xc3, 0x3d, 0x90, 0x5d, 0xd7, 0xb2,
-		0x51, 0x64, 0xac, 0xc3, 0xae, 0x33, 0x03, 0x42,
-		0x45, 0x2d, 0xa7, 0x57, 0xbd, 0xa3, 0x85, 0x64,
-		0xa6, 0xfe, 0x5c, 0x33, 0x04, 0x93, 0xf2, 0x7c,
-		0x06, 0x6d, 0xd7, 0xd7, 0xcf, 0x4a, 0xaf, 0xb2,
-		0xdd, 0x06, 0xdc, 0x28, 0x14, 0x59, 0x23, 0x02,
-		0xef, 0x97, 0x6a, 0xe8, 0xec, 0xca, 0x10, 0x44,
-		0xcd, 0xb8, 0x50, 0x16, 0x46, 0x5a, 0x05, 0xda,
-		0x04, 0xb3, 0x0e, 0xe9, 0xf0, 0x74, 0xc5, 0x23,
-		0xc2, 0x0e, 0xa1, 0x54, 0x66, 0x7b, 0xe8, 0x14,
-		0x03, 0x02, 0x00, 0x01, 0x01, 0x16, 0x03, 0x02,
-		0x00, 0x40, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x6b, 0x43, 0x1c, 0x58, 0xbc, 0x85,
-		0xf7, 0xc1, 0x76, 0xbc, 0x72, 0x33, 0x41, 0x6b,
-		0xb8, 0xf8, 0xfd, 0x53, 0x21, 0xc2, 0x41, 0x1b,
-		0x72, 0x4f, 0xce, 0x97, 0xca, 0x14, 0x23, 0x4d,
-		0xbc, 0x44, 0xd6, 0xd7, 0xfc, 0xbc, 0xfd, 0xfd,
-		0x5d, 0x33, 0x42, 0x1b, 0x52, 0x40, 0x0a, 0x2b,
-		0x6c, 0x98, 0x17, 0x03, 0x02, 0x00, 0x40, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x1d,
-		0x31, 0xef, 0x03, 0x7d, 0xa5, 0x74, 0x92, 0x24,
-		0x34, 0xae, 0x4e, 0xc9, 0xfc, 0x59, 0xcb, 0x64,
-		0xf4, 0x45, 0xb1, 0xac, 0x02, 0xf2, 0x87, 0xe7,
-		0x2f, 0xfd, 0x01, 0xca, 0x78, 0x02, 0x2e, 0x3a,
-		0x38, 0xcd, 0xb1, 0xe0, 0xf2, 0x2e, 0xf6, 0x27,
-		0xa0, 0xac, 0x1f, 0x91, 0x43, 0xc2, 0x3d, 0x15,
-		0x03, 0x02, 0x00, 0x30, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x9f, 0x30, 0x24, 0x56,
-		0x2c, 0xde, 0xa0, 0xe6, 0x44, 0x35, 0x30, 0x51,
-		0xec, 0xd4, 0x69, 0x2d, 0x46, 0x64, 0x04, 0x21,
-		0xfe, 0x7c, 0x4d, 0xc5, 0xd0, 0x8c, 0xf9, 0xd2,
-		0x3f, 0x88, 0x69, 0xd5,
-	},
+	test = &serverTest{
+		name:   "CipherSuiteCertPreferenceECDSA",
+		config: &config,
+	}
+	runServerTestTLS12(t, test)
 }
 
-// $ go test -run TestRunServer -serve -clientauth 1 \
-//     -ciphersuites=0xc011 -minversion=0x0303 -maxversion=0x0303
-var tls12ServerScript = [][]byte{
-	{
-		0x16, 0x03, 0x01, 0x01, 0x1e, 0x01, 0x00, 0x01,
-		0x1a, 0x03, 0x03, 0x51, 0xe5, 0x76, 0x84, 0x0e,
-		0xb9, 0x17, 0xca, 0x08, 0x47, 0xd9, 0xbd, 0xd0,
-		0x94, 0xd1, 0x97, 0xca, 0x5b, 0xe7, 0x20, 0xac,
-		0x8e, 0xbb, 0xc7, 0x29, 0xe9, 0x26, 0xcf, 0x7d,
-		0xb3, 0xdc, 0x99, 0x00, 0x00, 0x82, 0xc0, 0x30,
-		0xc0, 0x2c, 0xc0, 0x28, 0xc0, 0x24, 0xc0, 0x14,
-		0xc0, 0x0a, 0x00, 0xa3, 0x00, 0x9f, 0x00, 0x6b,
-		0x00, 0x6a, 0x00, 0x39, 0x00, 0x38, 0xc0, 0x32,
-		0xc0, 0x2e, 0xc0, 0x2a, 0xc0, 0x26, 0xc0, 0x0f,
-		0xc0, 0x05, 0x00, 0x9d, 0x00, 0x3d, 0x00, 0x35,
-		0xc0, 0x12, 0xc0, 0x08, 0x00, 0x16, 0x00, 0x13,
-		0xc0, 0x0d, 0xc0, 0x03, 0x00, 0x0a, 0xc0, 0x2f,
-		0xc0, 0x2b, 0xc0, 0x27, 0xc0, 0x23, 0xc0, 0x13,
-		0xc0, 0x09, 0x00, 0xa2, 0x00, 0x9e, 0x00, 0x67,
-		0x00, 0x40, 0x00, 0x33, 0x00, 0x32, 0xc0, 0x31,
-		0xc0, 0x2d, 0xc0, 0x29, 0xc0, 0x25, 0xc0, 0x0e,
-		0xc0, 0x04, 0x00, 0x9c, 0x00, 0x3c, 0x00, 0x2f,
-		0x00, 0x07, 0xc0, 0x11, 0xc0, 0x07, 0xc0, 0x0c,
-		0xc0, 0x02, 0x00, 0x05, 0x00, 0x04, 0x00, 0x15,
-		0x00, 0x12, 0x00, 0x09, 0x00, 0x14, 0x00, 0x11,
-		0x00, 0x08, 0x00, 0x06, 0x00, 0x03, 0x00, 0xff,
-		0x01, 0x00, 0x00, 0x6f, 0x00, 0x0b, 0x00, 0x04,
-		0x03, 0x00, 0x01, 0x02, 0x00, 0x0a, 0x00, 0x34,
-		0x00, 0x32, 0x00, 0x0e, 0x00, 0x0d, 0x00, 0x19,
-		0x00, 0x0b, 0x00, 0x0c, 0x00, 0x18, 0x00, 0x09,
-		0x00, 0x0a, 0x00, 0x16, 0x00, 0x17, 0x00, 0x08,
-		0x00, 0x06, 0x00, 0x07, 0x00, 0x14, 0x00, 0x15,
-		0x00, 0x04, 0x00, 0x05, 0x00, 0x12, 0x00, 0x13,
-		0x00, 0x01, 0x00, 0x02, 0x00, 0x03, 0x00, 0x0f,
-		0x00, 0x10, 0x00, 0x11, 0x00, 0x23, 0x00, 0x00,
-		0x00, 0x0d, 0x00, 0x22, 0x00, 0x20, 0x06, 0x01,
-		0x06, 0x02, 0x06, 0x03, 0x05, 0x01, 0x05, 0x02,
-		0x05, 0x03, 0x04, 0x01, 0x04, 0x02, 0x04, 0x03,
-		0x03, 0x01, 0x03, 0x02, 0x03, 0x03, 0x02, 0x01,
-		0x02, 0x02, 0x02, 0x03, 0x01, 0x01, 0x00, 0x0f,
-		0x00, 0x01, 0x01,
-	},
-	{
-		0x16, 0x03, 0x03, 0x00, 0x30, 0x02, 0x00, 0x00,
-		0x2c, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0xc0, 0x11, 0x00, 0x00,
-		0x04, 0x00, 0x23, 0x00, 0x00, 0x16, 0x03, 0x03,
-		0x02, 0xbe, 0x0b, 0x00, 0x02, 0xba, 0x00, 0x02,
-		0xb7, 0x00, 0x02, 0xb4, 0x30, 0x82, 0x02, 0xb0,
-		0x30, 0x82, 0x02, 0x19, 0xa0, 0x03, 0x02, 0x01,
-		0x02, 0x02, 0x09, 0x00, 0x85, 0xb0, 0xbb, 0xa4,
-		0x8a, 0x7f, 0xb8, 0xca, 0x30, 0x0d, 0x06, 0x09,
-		0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01,
-		0x05, 0x05, 0x00, 0x30, 0x45, 0x31, 0x0b, 0x30,
-		0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02,
-		0x41, 0x55, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03,
-		0x55, 0x04, 0x08, 0x13, 0x0a, 0x53, 0x6f, 0x6d,
-		0x65, 0x2d, 0x53, 0x74, 0x61, 0x74, 0x65, 0x31,
-		0x21, 0x30, 0x1f, 0x06, 0x03, 0x55, 0x04, 0x0a,
-		0x13, 0x18, 0x49, 0x6e, 0x74, 0x65, 0x72, 0x6e,
-		0x65, 0x74, 0x20, 0x57, 0x69, 0x64, 0x67, 0x69,
-		0x74, 0x73, 0x20, 0x50, 0x74, 0x79, 0x20, 0x4c,
-		0x74, 0x64, 0x30, 0x1e, 0x17, 0x0d, 0x31, 0x30,
-		0x30, 0x34, 0x32, 0x34, 0x30, 0x39, 0x30, 0x39,
-		0x33, 0x38, 0x5a, 0x17, 0x0d, 0x31, 0x31, 0x30,
-		0x34, 0x32, 0x34, 0x30, 0x39, 0x30, 0x39, 0x33,
-		0x38, 0x5a, 0x30, 0x45, 0x31, 0x0b, 0x30, 0x09,
-		0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x41,
-		0x55, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03, 0x55,
-		0x04, 0x08, 0x13, 0x0a, 0x53, 0x6f, 0x6d, 0x65,
-		0x2d, 0x53, 0x74, 0x61, 0x74, 0x65, 0x31, 0x21,
-		0x30, 0x1f, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13,
-		0x18, 0x49, 0x6e, 0x74, 0x65, 0x72, 0x6e, 0x65,
-		0x74, 0x20, 0x57, 0x69, 0x64, 0x67, 0x69, 0x74,
-		0x73, 0x20, 0x50, 0x74, 0x79, 0x20, 0x4c, 0x74,
-		0x64, 0x30, 0x81, 0x9f, 0x30, 0x0d, 0x06, 0x09,
-		0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01,
-		0x01, 0x05, 0x00, 0x03, 0x81, 0x8d, 0x00, 0x30,
-		0x81, 0x89, 0x02, 0x81, 0x81, 0x00, 0xbb, 0x79,
-		0xd6, 0xf5, 0x17, 0xb5, 0xe5, 0xbf, 0x46, 0x10,
-		0xd0, 0xdc, 0x69, 0xbe, 0xe6, 0x2b, 0x07, 0x43,
-		0x5a, 0xd0, 0x03, 0x2d, 0x8a, 0x7a, 0x43, 0x85,
-		0xb7, 0x14, 0x52, 0xe7, 0xa5, 0x65, 0x4c, 0x2c,
-		0x78, 0xb8, 0x23, 0x8c, 0xb5, 0xb4, 0x82, 0xe5,
-		0xde, 0x1f, 0x95, 0x3b, 0x7e, 0x62, 0xa5, 0x2c,
-		0xa5, 0x33, 0xd6, 0xfe, 0x12, 0x5c, 0x7a, 0x56,
-		0xfc, 0xf5, 0x06, 0xbf, 0xfa, 0x58, 0x7b, 0x26,
-		0x3f, 0xb5, 0xcd, 0x04, 0xd3, 0xd0, 0xc9, 0x21,
-		0x96, 0x4a, 0xc7, 0xf4, 0x54, 0x9f, 0x5a, 0xbf,
-		0xef, 0x42, 0x71, 0x00, 0xfe, 0x18, 0x99, 0x07,
-		0x7f, 0x7e, 0x88, 0x7d, 0x7d, 0xf1, 0x04, 0x39,
-		0xc4, 0xa2, 0x2e, 0xdb, 0x51, 0xc9, 0x7c, 0xe3,
-		0xc0, 0x4c, 0x3b, 0x32, 0x66, 0x01, 0xcf, 0xaf,
-		0xb1, 0x1d, 0xb8, 0x71, 0x9a, 0x1d, 0xdb, 0xdb,
-		0x89, 0x6b, 0xae, 0xda, 0x2d, 0x79, 0x02, 0x03,
-		0x01, 0x00, 0x01, 0xa3, 0x81, 0xa7, 0x30, 0x81,
-		0xa4, 0x30, 0x1d, 0x06, 0x03, 0x55, 0x1d, 0x0e,
-		0x04, 0x16, 0x04, 0x14, 0xb1, 0xad, 0xe2, 0x85,
-		0x5a, 0xcf, 0xcb, 0x28, 0xdb, 0x69, 0xce, 0x23,
-		0x69, 0xde, 0xd3, 0x26, 0x8e, 0x18, 0x88, 0x39,
-		0x30, 0x75, 0x06, 0x03, 0x55, 0x1d, 0x23, 0x04,
-		0x6e, 0x30, 0x6c, 0x80, 0x14, 0xb1, 0xad, 0xe2,
-		0x85, 0x5a, 0xcf, 0xcb, 0x28, 0xdb, 0x69, 0xce,
-		0x23, 0x69, 0xde, 0xd3, 0x26, 0x8e, 0x18, 0x88,
-		0x39, 0xa1, 0x49, 0xa4, 0x47, 0x30, 0x45, 0x31,
-		0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06,
-		0x13, 0x02, 0x41, 0x55, 0x31, 0x13, 0x30, 0x11,
-		0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0a, 0x53,
-		0x6f, 0x6d, 0x65, 0x2d, 0x53, 0x74, 0x61, 0x74,
-		0x65, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x03, 0x55,
-		0x04, 0x0a, 0x13, 0x18, 0x49, 0x6e, 0x74, 0x65,
-		0x72, 0x6e, 0x65, 0x74, 0x20, 0x57, 0x69, 0x64,
-		0x67, 0x69, 0x74, 0x73, 0x20, 0x50, 0x74, 0x79,
-		0x20, 0x4c, 0x74, 0x64, 0x82, 0x09, 0x00, 0x85,
-		0xb0, 0xbb, 0xa4, 0x8a, 0x7f, 0xb8, 0xca, 0x30,
-		0x0c, 0x06, 0x03, 0x55, 0x1d, 0x13, 0x04, 0x05,
-		0x30, 0x03, 0x01, 0x01, 0xff, 0x30, 0x0d, 0x06,
-		0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01,
-		0x01, 0x05, 0x05, 0x00, 0x03, 0x81, 0x81, 0x00,
-		0x08, 0x6c, 0x45, 0x24, 0xc7, 0x6b, 0xb1, 0x59,
-		0xab, 0x0c, 0x52, 0xcc, 0xf2, 0xb0, 0x14, 0xd7,
-		0x87, 0x9d, 0x7a, 0x64, 0x75, 0xb5, 0x5a, 0x95,
-		0x66, 0xe4, 0xc5, 0x2b, 0x8e, 0xae, 0x12, 0x66,
-		0x1f, 0xeb, 0x4f, 0x38, 0xb3, 0x6e, 0x60, 0xd3,
-		0x92, 0xfd, 0xf7, 0x41, 0x08, 0xb5, 0x25, 0x13,
-		0xb1, 0x18, 0x7a, 0x24, 0xfb, 0x30, 0x1d, 0xba,
-		0xed, 0x98, 0xb9, 0x17, 0xec, 0xe7, 0xd7, 0x31,
-		0x59, 0xdb, 0x95, 0xd3, 0x1d, 0x78, 0xea, 0x50,
-		0x56, 0x5c, 0xd5, 0x82, 0x5a, 0x2d, 0x5a, 0x5f,
-		0x33, 0xc4, 0xb6, 0xd8, 0xc9, 0x75, 0x90, 0x96,
-		0x8c, 0x0f, 0x52, 0x98, 0xb5, 0xcd, 0x98, 0x1f,
-		0x89, 0x20, 0x5f, 0xf2, 0xa0, 0x1c, 0xa3, 0x1b,
-		0x96, 0x94, 0xdd, 0xa9, 0xfd, 0x57, 0xe9, 0x70,
-		0xe8, 0x26, 0x6d, 0x71, 0x99, 0x9b, 0x26, 0x6e,
-		0x38, 0x50, 0x29, 0x6c, 0x90, 0xa7, 0xbd, 0xd9,
-		0x16, 0x03, 0x03, 0x01, 0x11, 0x0c, 0x00, 0x01,
-		0x0d, 0x03, 0x00, 0x19, 0x85, 0x04, 0x01, 0x39,
-		0xdc, 0xee, 0x44, 0x17, 0x5e, 0xdb, 0xd7, 0x27,
-		0xaf, 0xb6, 0x56, 0xd9, 0xb4, 0x43, 0x5a, 0x99,
-		0xcf, 0xaa, 0x31, 0x37, 0x0c, 0x6f, 0x3a, 0xa0,
-		0xf8, 0x53, 0xc4, 0x74, 0xd1, 0x91, 0x0a, 0x46,
-		0xf5, 0x38, 0x3b, 0x5c, 0x09, 0xd8, 0x97, 0xdc,
-		0x4b, 0xaa, 0x70, 0x26, 0x48, 0xf2, 0xd6, 0x0b,
-		0x31, 0xc9, 0xf8, 0xd4, 0x98, 0x43, 0xe1, 0x6c,
-		0xd5, 0xc7, 0xb2, 0x8e, 0x0b, 0x01, 0xe6, 0xb6,
-		0x00, 0x28, 0x80, 0x7b, 0xfc, 0x96, 0x8f, 0x0d,
-		0xa2, 0x4f, 0xb0, 0x79, 0xaf, 0xdc, 0x61, 0x28,
-		0x63, 0x33, 0x78, 0xf6, 0x31, 0x39, 0xfd, 0x8a,
-		0xf4, 0x15, 0x18, 0x11, 0xfe, 0xdb, 0xd5, 0x07,
-		0xda, 0x2c, 0xed, 0x49, 0xa0, 0x23, 0xbf, 0xd0,
-		0x3a, 0x38, 0x1d, 0x54, 0xae, 0x1c, 0x7b, 0xea,
-		0x29, 0xee, 0xd0, 0x38, 0xc1, 0x76, 0xa7, 0x7f,
-		0x2a, 0xf4, 0xce, 0x1e, 0xac, 0xcc, 0x94, 0x79,
-		0x90, 0x33, 0x04, 0x01, 0x00, 0x80, 0x4a, 0xf9,
-		0xf5, 0x0a, 0x61, 0x37, 0x7e, 0x4e, 0x92, 0xb5,
-		0x1c, 0x91, 0x21, 0xb2, 0xb5, 0x17, 0x00, 0xbf,
-		0x01, 0x5f, 0x30, 0xec, 0x62, 0x08, 0xd6, 0x9d,
-		0x1a, 0x08, 0x05, 0x72, 0x8b, 0xf4, 0x49, 0x85,
-		0xa7, 0xbf, 0x3f, 0x75, 0x58, 0x3e, 0x26, 0x82,
-		0xc3, 0x28, 0x07, 0xf9, 0x41, 0x7d, 0x03, 0x14,
-		0x3b, 0xc3, 0x05, 0x64, 0xff, 0x52, 0xf4, 0x75,
-		0x6a, 0x87, 0xcd, 0xdf, 0x93, 0x31, 0x0a, 0x71,
-		0x60, 0x17, 0xc6, 0x33, 0xf0, 0x79, 0xb6, 0x7b,
-		0xd0, 0x9c, 0xa0, 0x5f, 0x74, 0x14, 0x2c, 0x5a,
-		0xb4, 0x3f, 0x39, 0xf5, 0xe4, 0x9f, 0xbe, 0x6d,
-		0x21, 0xd2, 0xa9, 0x42, 0xf7, 0xdc, 0xa6, 0x65,
-		0xb7, 0x6a, 0x7e, 0x2e, 0x14, 0xd3, 0xf6, 0xf3,
-		0x4b, 0x4c, 0x5b, 0x1a, 0x70, 0x7a, 0xbc, 0xb0,
-		0x12, 0xf3, 0x6e, 0x0c, 0xcf, 0x43, 0x22, 0xae,
-		0x5b, 0xba, 0x00, 0xf8, 0xfd, 0xaf, 0x16, 0x03,
-		0x03, 0x00, 0x0f, 0x0d, 0x00, 0x00, 0x0b, 0x02,
-		0x01, 0x40, 0x00, 0x04, 0x04, 0x01, 0x04, 0x03,
-		0x00, 0x00, 0x16, 0x03, 0x03, 0x00, 0x04, 0x0e,
-		0x00, 0x00, 0x00,
-	},
-	{
-		0x16, 0x03, 0x03, 0x01, 0xfb, 0x0b, 0x00, 0x01,
-		0xf7, 0x00, 0x01, 0xf4, 0x00, 0x01, 0xf1, 0x30,
-		0x82, 0x01, 0xed, 0x30, 0x82, 0x01, 0x58, 0xa0,
-		0x03, 0x02, 0x01, 0x02, 0x02, 0x01, 0x00, 0x30,
-		0x0b, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7,
-		0x0d, 0x01, 0x01, 0x05, 0x30, 0x26, 0x31, 0x10,
-		0x30, 0x0e, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13,
-		0x07, 0x41, 0x63, 0x6d, 0x65, 0x20, 0x43, 0x6f,
-		0x31, 0x12, 0x30, 0x10, 0x06, 0x03, 0x55, 0x04,
-		0x03, 0x13, 0x09, 0x31, 0x32, 0x37, 0x2e, 0x30,
-		0x2e, 0x30, 0x2e, 0x31, 0x30, 0x1e, 0x17, 0x0d,
-		0x31, 0x31, 0x31, 0x32, 0x30, 0x38, 0x30, 0x37,
-		0x35, 0x35, 0x31, 0x32, 0x5a, 0x17, 0x0d, 0x31,
-		0x32, 0x31, 0x32, 0x30, 0x37, 0x30, 0x38, 0x30,
-		0x30, 0x31, 0x32, 0x5a, 0x30, 0x26, 0x31, 0x10,
-		0x30, 0x0e, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13,
-		0x07, 0x41, 0x63, 0x6d, 0x65, 0x20, 0x43, 0x6f,
-		0x31, 0x12, 0x30, 0x10, 0x06, 0x03, 0x55, 0x04,
-		0x03, 0x13, 0x09, 0x31, 0x32, 0x37, 0x2e, 0x30,
-		0x2e, 0x30, 0x2e, 0x31, 0x30, 0x81, 0x9c, 0x30,
-		0x0b, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7,
-		0x0d, 0x01, 0x01, 0x01, 0x03, 0x81, 0x8c, 0x00,
-		0x30, 0x81, 0x88, 0x02, 0x81, 0x80, 0x4e, 0xd0,
-		0x7b, 0x31, 0xe3, 0x82, 0x64, 0xd9, 0x59, 0xc0,
-		0xc2, 0x87, 0xa4, 0x5e, 0x1e, 0x8b, 0x73, 0x33,
-		0xc7, 0x63, 0x53, 0xdf, 0x66, 0x92, 0x06, 0x84,
-		0xf6, 0x64, 0xd5, 0x8f, 0xe4, 0x36, 0xa7, 0x1d,
-		0x2b, 0xe8, 0xb3, 0x20, 0x36, 0x45, 0x23, 0xb5,
-		0xe3, 0x95, 0xae, 0xed, 0xe0, 0xf5, 0x20, 0x9c,
-		0x8d, 0x95, 0xdf, 0x7f, 0x5a, 0x12, 0xef, 0x87,
-		0xe4, 0x5b, 0x68, 0xe4, 0xe9, 0x0e, 0x74, 0xec,
-		0x04, 0x8a, 0x7f, 0xde, 0x93, 0x27, 0xc4, 0x01,
-		0x19, 0x7a, 0xbd, 0xf2, 0xdc, 0x3d, 0x14, 0xab,
-		0xd0, 0x54, 0xca, 0x21, 0x0c, 0xd0, 0x4d, 0x6e,
-		0x87, 0x2e, 0x5c, 0xc5, 0xd2, 0xbb, 0x4d, 0x4b,
-		0x4f, 0xce, 0xb6, 0x2c, 0xf7, 0x7e, 0x88, 0xec,
-		0x7c, 0xd7, 0x02, 0x91, 0x74, 0xa6, 0x1e, 0x0c,
-		0x1a, 0xda, 0xe3, 0x4a, 0x5a, 0x2e, 0xde, 0x13,
-		0x9c, 0x4c, 0x40, 0x88, 0x59, 0x93, 0x02, 0x03,
-		0x01, 0x00, 0x01, 0xa3, 0x32, 0x30, 0x30, 0x30,
-		0x0e, 0x06, 0x03, 0x55, 0x1d, 0x0f, 0x01, 0x01,
-		0xff, 0x04, 0x04, 0x03, 0x02, 0x00, 0xa0, 0x30,
-		0x0d, 0x06, 0x03, 0x55, 0x1d, 0x0e, 0x04, 0x06,
-		0x04, 0x04, 0x01, 0x02, 0x03, 0x04, 0x30, 0x0f,
-		0x06, 0x03, 0x55, 0x1d, 0x23, 0x04, 0x08, 0x30,
-		0x06, 0x80, 0x04, 0x01, 0x02, 0x03, 0x04, 0x30,
-		0x0b, 0x06, 0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7,
-		0x0d, 0x01, 0x01, 0x05, 0x03, 0x81, 0x81, 0x00,
-		0x36, 0x1f, 0xb3, 0x7a, 0x0c, 0x75, 0xc9, 0x6e,
-		0x37, 0x46, 0x61, 0x2b, 0xd5, 0xbd, 0xc0, 0xa7,
-		0x4b, 0xcc, 0x46, 0x9a, 0x81, 0x58, 0x7c, 0x85,
-		0x79, 0x29, 0xc8, 0xc8, 0xc6, 0x67, 0xdd, 0x32,
-		0x56, 0x45, 0x2b, 0x75, 0xb6, 0xe9, 0x24, 0xa9,
-		0x50, 0x9a, 0xbe, 0x1f, 0x5a, 0xfa, 0x1a, 0x15,
-		0xd9, 0xcc, 0x55, 0x95, 0x72, 0x16, 0x83, 0xb9,
-		0xc2, 0xb6, 0x8f, 0xfd, 0x88, 0x8c, 0x38, 0x84,
-		0x1d, 0xab, 0x5d, 0x92, 0x31, 0x13, 0x4f, 0xfd,
-		0x83, 0x3b, 0xc6, 0x9d, 0xf1, 0x11, 0x62, 0xb6,
-		0x8b, 0xec, 0xab, 0x67, 0xbe, 0xc8, 0x64, 0xb0,
-		0x11, 0x50, 0x46, 0x58, 0x17, 0x6b, 0x99, 0x1c,
-		0xd3, 0x1d, 0xfc, 0x06, 0xf1, 0x0e, 0xe5, 0x96,
-		0xa8, 0x0c, 0xf9, 0x78, 0x20, 0xb7, 0x44, 0x18,
-		0x51, 0x8d, 0x10, 0x7e, 0x4f, 0x94, 0x67, 0xdf,
-		0xa3, 0x4e, 0x70, 0x73, 0x8e, 0x90, 0x91, 0x85,
-		0x16, 0x03, 0x03, 0x00, 0x8a, 0x10, 0x00, 0x00,
-		0x86, 0x85, 0x04, 0x01, 0x5d, 0x3a, 0x92, 0x59,
-		0x7f, 0x9a, 0x22, 0x36, 0x0e, 0x1b, 0x1d, 0x2a,
-		0x05, 0xb7, 0xa4, 0xb6, 0x5d, 0xfc, 0x51, 0x6e,
-		0x15, 0xe5, 0x89, 0x7c, 0xe2, 0xfa, 0x87, 0x38,
-		0x05, 0x79, 0x15, 0x92, 0xb4, 0x8f, 0x88, 0x8f,
-		0x9d, 0x5d, 0xa0, 0xaf, 0xf8, 0xce, 0xf9, 0x6f,
-		0x83, 0xf4, 0x08, 0x69, 0xe4, 0x91, 0xc5, 0xed,
-		0xb9, 0xc5, 0xa8, 0x1f, 0x4b, 0xec, 0xef, 0x91,
-		0xc1, 0xa3, 0x34, 0x24, 0x18, 0x00, 0x2d, 0xcd,
-		0xe6, 0x44, 0xef, 0x5a, 0x3e, 0x52, 0x63, 0x5b,
-		0x36, 0x1f, 0x7e, 0xce, 0x9e, 0xaa, 0xda, 0x8d,
-		0xb5, 0xc9, 0xea, 0xd8, 0x1b, 0xd1, 0x1c, 0x7c,
-		0x07, 0xfc, 0x3c, 0x2d, 0x70, 0x1f, 0xf9, 0x4d,
-		0xcb, 0xaa, 0xad, 0x07, 0xd5, 0x6d, 0xbd, 0xa6,
-		0x61, 0xf3, 0x2f, 0xa3, 0x9c, 0x45, 0x02, 0x4a,
-		0xac, 0x6c, 0xb6, 0x37, 0x95, 0xb1, 0x4a, 0xb5,
-		0x0a, 0x4e, 0x60, 0x67, 0xd7, 0xe0, 0x04, 0x16,
-		0x03, 0x03, 0x00, 0x88, 0x0f, 0x00, 0x00, 0x84,
-		0x04, 0x01, 0x00, 0x80, 0x08, 0x83, 0x53, 0xf0,
-		0xf8, 0x14, 0xf5, 0xc2, 0xd1, 0x8b, 0xf0, 0xa5,
-		0xc1, 0xd8, 0x1a, 0x36, 0x4b, 0x75, 0x77, 0x02,
-		0x19, 0xd8, 0x11, 0x3f, 0x5a, 0x36, 0xfc, 0xe9,
-		0x2b, 0x4b, 0xf9, 0xfe, 0xda, 0x8a, 0x0f, 0x6e,
-		0x3d, 0xd3, 0x52, 0x87, 0xf7, 0x9c, 0x78, 0x39,
-		0xa8, 0xf1, 0xd7, 0xf7, 0x4e, 0x35, 0x33, 0xf9,
-		0xc5, 0x76, 0xa8, 0x12, 0xc4, 0x91, 0x33, 0x1d,
-		0x93, 0x8c, 0xbf, 0xb1, 0x83, 0x00, 0x90, 0xc5,
-		0x52, 0x3e, 0xe0, 0x0a, 0xe8, 0x92, 0x75, 0xdf,
-		0x54, 0x5f, 0x9f, 0x95, 0x76, 0x62, 0xb5, 0x85,
-		0x69, 0xa4, 0x86, 0x85, 0x6c, 0xf3, 0x6b, 0x2a,
-		0x72, 0x7b, 0x4d, 0x42, 0x33, 0x67, 0x4a, 0xce,
-		0xb5, 0xdb, 0x9b, 0xae, 0xc0, 0xb0, 0x10, 0xeb,
-		0x3b, 0xf4, 0xc2, 0x9a, 0x64, 0x47, 0x4c, 0x1e,
-		0xa5, 0x91, 0x7f, 0x6d, 0xd1, 0x03, 0xf5, 0x4a,
-		0x90, 0x69, 0x18, 0xb1, 0x14, 0x03, 0x03, 0x00,
-		0x01, 0x01, 0x16, 0x03, 0x03, 0x00, 0x24, 0x59,
-		0xfc, 0x7e, 0xae, 0xb3, 0xbf, 0xab, 0x4d, 0xdb,
-		0x4e, 0xab, 0xa9, 0x6d, 0x6b, 0x4c, 0x60, 0xb6,
-		0x16, 0xe0, 0xab, 0x7f, 0x52, 0x2d, 0xa1, 0xfc,
-		0xe1, 0x80, 0xd2, 0x8a, 0xa1, 0xe5, 0x8f, 0xa1,
-		0x70, 0x93, 0x23,
-	},
-	{
-		0x16, 0x03, 0x03, 0x02, 0x67, 0x04, 0x00, 0x02,
-		0x63, 0x00, 0x00, 0x00, 0x00, 0x02, 0x5d, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x65,
-		0xea, 0x8b, 0xc5, 0xef, 0xba, 0x64, 0xb7, 0x23,
-		0x08, 0x86, 0x4f, 0x37, 0xe0, 0x8f, 0xbd, 0x75,
-		0x71, 0x2b, 0xcb, 0x20, 0x75, 0x11, 0x3b, 0xa2,
-		0x9e, 0x39, 0x3c, 0x03, 0xef, 0x6e, 0x41, 0xd7,
-		0xcf, 0x1a, 0x2c, 0xf2, 0xfe, 0xc2, 0xd3, 0x65,
-		0x59, 0x00, 0x9d, 0x03, 0xb4, 0xf2, 0x20, 0xe4,
-		0x33, 0x80, 0xcd, 0xf6, 0xe4, 0x59, 0x22, 0xf7,
-		0xfd, 0x88, 0x0e, 0xa4, 0x09, 0xc0, 0x0d, 0x10,
-		0x80, 0x10, 0x79, 0xee, 0x70, 0x96, 0xdb, 0x22,
-		0x8b, 0xb7, 0xac, 0xe0, 0x98, 0xad, 0xe9, 0xe3,
-		0xcb, 0xea, 0x9f, 0xe6, 0x83, 0x28, 0x7c, 0x7e,
-		0x4e, 0x9a, 0x8d, 0xd9, 0xf3, 0x86, 0xf4, 0x89,
-		0x8b, 0x79, 0x8f, 0xbb, 0xe9, 0x74, 0x02, 0x02,
-		0x14, 0x04, 0xea, 0xba, 0x16, 0x10, 0xa1, 0x85,
-		0xbe, 0x4e, 0x4e, 0x92, 0xc5, 0x83, 0xf6, 0x1e,
-		0x1f, 0xd4, 0x25, 0xc2, 0xc2, 0xb9, 0xce, 0x33,
-		0x63, 0x66, 0x79, 0x1f, 0x54, 0x35, 0xc1, 0xe8,
-		0x89, 0x34, 0x78, 0x94, 0x36, 0x14, 0xef, 0x01,
-		0x1f, 0xf1, 0xbd, 0x77, 0x2c, 0x4d, 0xac, 0x5c,
-		0x5c, 0x4a, 0xc6, 0xed, 0xd8, 0x0e, 0x72, 0x84,
-		0x83, 0xdc, 0x56, 0x84, 0xc8, 0xf3, 0x89, 0x56,
-		0xfd, 0x89, 0xc1, 0xc9, 0x9a, 0x29, 0x91, 0x7e,
-		0x19, 0xe9, 0x8b, 0x5b, 0x11, 0x15, 0x4e, 0x6c,
-		0xf4, 0x89, 0xe7, 0x6d, 0x68, 0x1e, 0xf9, 0x6c,
-		0x23, 0x72, 0x05, 0x68, 0x82, 0x60, 0x84, 0x1f,
-		0x83, 0x20, 0x09, 0x86, 0x10, 0x81, 0xec, 0xec,
-		0xdc, 0x25, 0x53, 0x20, 0xfa, 0xa9, 0x41, 0x64,
-		0xd6, 0x20, 0xf3, 0xf4, 0x52, 0xf2, 0x80, 0x62,
-		0x83, 0xc9, 0x23, 0x66, 0x44, 0x95, 0x5a, 0x99,
-		0x8a, 0xe1, 0x26, 0x63, 0xc1, 0x8b, 0x31, 0xf9,
-		0x21, 0x06, 0x77, 0x04, 0x27, 0xf2, 0x0c, 0x63,
-		0x83, 0x45, 0xa0, 0xa9, 0x7b, 0xcf, 0xdf, 0xd7,
-		0x56, 0x75, 0xbc, 0xdd, 0x95, 0x36, 0xb1, 0x75,
-		0x39, 0x05, 0x00, 0x3c, 0x8a, 0x79, 0xd6, 0xe9,
-		0xf0, 0x4b, 0xdc, 0x51, 0x6b, 0x01, 0x94, 0x16,
-		0x87, 0x12, 0x92, 0x6c, 0x07, 0xc1, 0xf5, 0x58,
-		0xb7, 0x2a, 0x81, 0xf5, 0xa0, 0x37, 0x8b, 0xa6,
-		0x22, 0xfe, 0x28, 0x0a, 0x7e, 0x68, 0xe2, 0xda,
-		0x6c, 0x53, 0xee, 0x0e, 0x8d, 0x2d, 0x8b, 0x0b,
-		0xda, 0xf8, 0x99, 0x3e, 0x0e, 0xed, 0x9f, 0xc1,
-		0x2b, 0xf6, 0xfe, 0xe9, 0x52, 0x38, 0x7b, 0x83,
-		0x9a, 0x50, 0xa6, 0xd7, 0x49, 0x83, 0x43, 0x7e,
-		0x82, 0xec, 0xc7, 0x09, 0x3d, 0x3d, 0xb1, 0xee,
-		0xe8, 0xc5, 0x6a, 0xc3, 0x3d, 0x4b, 0x4c, 0x6a,
-		0xbb, 0x0b, 0x2c, 0x24, 0x2e, 0xdb, 0x7d, 0x57,
-		0x87, 0xb4, 0x80, 0xa5, 0xae, 0xff, 0x54, 0xa8,
-		0xa5, 0x27, 0x69, 0x95, 0xc8, 0xe7, 0x79, 0xc7,
-		0x89, 0x2a, 0x73, 0x49, 0xcb, 0xf5, 0xc5, 0xbc,
-		0x4a, 0xe0, 0x73, 0xa9, 0xbc, 0x88, 0x64, 0x96,
-		0x98, 0xa5, 0x1e, 0xe3, 0x43, 0xc1, 0x7d, 0x78,
-		0xc7, 0x94, 0x72, 0xd4, 0x2c, 0x6e, 0x85, 0x39,
-		0x9a, 0xaf, 0xdb, 0xa1, 0xe9, 0xe2, 0xcb, 0x37,
-		0x04, 0xc6, 0x8c, 0x81, 0xd3, 0x2a, 0xb7, 0xbe,
-		0x6c, 0x07, 0x1f, 0x5e, 0xd9, 0x00, 0xd2, 0xf7,
-		0xe1, 0xa7, 0xbc, 0x0c, 0xb6, 0x6d, 0xfb, 0x3f,
-		0x3d, 0x24, 0xaa, 0xfb, 0x7e, 0xe1, 0xb5, 0x1b,
-		0xff, 0x38, 0xaa, 0x69, 0x59, 0x38, 0x52, 0x9a,
-		0x0e, 0x6d, 0xbc, 0xde, 0x4f, 0x13, 0x09, 0x17,
-		0xc4, 0xa9, 0x05, 0x84, 0xbc, 0x50, 0xef, 0x40,
-		0xb0, 0x4c, 0x24, 0x32, 0xed, 0x94, 0x2c, 0xdd,
-		0xda, 0x20, 0x24, 0x67, 0xe2, 0xea, 0x71, 0x3d,
-		0x4a, 0x04, 0x0d, 0x98, 0x29, 0x20, 0x4c, 0xeb,
-		0x70, 0xce, 0x45, 0x9e, 0x5a, 0xaf, 0xb6, 0xa3,
-		0x92, 0xc8, 0x28, 0xf2, 0xe3, 0xe8, 0x8a, 0x5d,
-		0x0a, 0x33, 0x79, 0x9b, 0x6a, 0xf3, 0x30, 0x01,
-		0x1d, 0x47, 0xbd, 0x01, 0xcc, 0x4d, 0x71, 0xc0,
-		0x56, 0xfa, 0xfd, 0x37, 0xed, 0x0f, 0x27, 0xc0,
-		0xbb, 0xa0, 0xee, 0xc3, 0x79, 0x8b, 0xe7, 0x41,
-		0x8f, 0xfa, 0x3a, 0xcb, 0x45, 0x3b, 0x85, 0x9f,
-		0x06, 0x90, 0xb2, 0x51, 0xc0, 0x48, 0x10, 0xac,
-		0x2a, 0xec, 0xec, 0x48, 0x7a, 0x19, 0x47, 0xc4,
-		0x2a, 0xeb, 0xb3, 0xa2, 0x07, 0x22, 0x32, 0x78,
-		0xf4, 0x73, 0x5e, 0x92, 0x42, 0x15, 0xa1, 0x90,
-		0x91, 0xd0, 0xeb, 0x12, 0x14, 0x03, 0x03, 0x00,
-		0x01, 0x01, 0x16, 0x03, 0x03, 0x00, 0x24, 0x45,
-		0x4b, 0x80, 0x42, 0x46, 0xde, 0xbb, 0xe7, 0x76,
-		0xd1, 0x33, 0x92, 0xfc, 0x46, 0x17, 0x6d, 0x21,
-		0xf6, 0x0e, 0x16, 0xca, 0x9b, 0x9b, 0x04, 0x65,
-		0x16, 0x40, 0x44, 0x64, 0xbc, 0x58, 0xfa, 0x2a,
-		0x49, 0xe9, 0xed, 0x17, 0x03, 0x03, 0x00, 0x21,
-		0x89, 0x71, 0xcd, 0x56, 0x54, 0xbf, 0x73, 0xde,
-		0xfb, 0x4b, 0x4e, 0xf1, 0x7f, 0xc6, 0x75, 0xa6,
-		0xbd, 0x6b, 0x6c, 0xd9, 0xdc, 0x0c, 0x71, 0xb4,
-		0xb9, 0xbb, 0x6e, 0xfa, 0x9e, 0xc7, 0xc7, 0x4c,
-		0x24, 0x15, 0x03, 0x03, 0x00, 0x16, 0x62, 0xea,
-		0x65, 0x69, 0x68, 0x4a, 0xce, 0xa7, 0x9e, 0xce,
-		0xc0, 0xf1, 0x5c, 0x96, 0xd9, 0x1f, 0x49, 0xac,
-		0x2d, 0x05, 0x89, 0x94,
-	},
+func TestResumption(t *testing.T) {
+	sessionFilePath := tempFile("")
+	defer os.Remove(sessionFilePath)
+
+	test := &serverTest{
+		name:    "IssueTicket",
+		command: []string{"openssl", "s_client", "-cipher", "RC4-SHA", "-sess_out", sessionFilePath},
+	}
+	runServerTestTLS12(t, test)
+
+	test = &serverTest{
+		name:    "Resume",
+		command: []string{"openssl", "s_client", "-cipher", "RC4-SHA", "-sess_in", sessionFilePath},
+	}
+	runServerTestTLS12(t, test)
 }
 
 // cert.pem and key.pem were generated with generate_cert.go
 // Thus, they have no ExtKeyUsage fields and trigger an error
 // when verification is turned on.
 
-var clientCertificate = loadPEMCert(`
+const clientCertificatePEM = `
 -----BEGIN CERTIFICATE-----
 MIIB7TCCAVigAwIBAgIBADALBgkqhkiG9w0BAQUwJjEQMA4GA1UEChMHQWNtZSBD
 bzESMBAGA1UEAxMJMTI3LjAuMC4xMB4XDTExMTIwODA3NTUxMloXDTEyMTIwNzA4
@@ -3147,10 +553,9 @@ DwYDVR0jBAgwBoAEAQIDBDALBgkqhkiG9w0BAQUDgYEANh+zegx1yW43RmEr1b3A
 p0vMRpqBWHyFeSnIyMZn3TJWRSt1tukkqVCavh9a+hoV2cxVlXIWg7nCto/9iIw4
 hB2rXZIxE0/9gzvGnfERYraL7KtnvshksBFQRlgXa5kc0x38BvEO5ZaoDPl4ILdE
 GFGNEH5PlGffo05wc46QkYU=
------END CERTIFICATE-----
-`)
+-----END CERTIFICATE-----`
 
-/* corresponding key.pem for cert.pem is:
+const clientKeyPEM = `
 -----BEGIN RSA PRIVATE KEY-----
 MIICWgIBAAKBgE7QezHjgmTZWcDCh6ReHotzM8djU99mkgaE9mTVj+Q2px0r6LMg
 NkUjteOVru3g9SCcjZXff1oS74fkW2jk6Q507ASKf96TJ8QBGXq98tw9FKvQVMoh
@@ -3165,10 +570,9 @@ saG9sF+UEhRt9AxUfW/U/tIQ9V0ZHHcSg1XaCM5Nvp934brdKdvTOKnJAkBD5h/3
 Rybatlvg/fzBEaJFyq09zhngkxlZOUtBVTqzl17RVvY2orgH02U4HbCHy4phxOn7
 qTdQRYlHRftgnWK1AkANibn9PRYJ7mJyJ9Dyj2QeNcSkSTzrt0tPvUMf4+meJymN
 1Ntu5+S1DLLzfxlaljWG6ylW6DNxujCyuXIV2rvA
------END RSA PRIVATE KEY-----
-*/
+-----END RSA PRIVATE KEY-----`
 
-var clientECDSACertificate = loadPEMCert(`
+const clientECDSACertificatePEM = `
 -----BEGIN CERTIFICATE-----
 MIIB/DCCAV4CCQCaMIRsJjXZFzAJBgcqhkjOPQQBMEUxCzAJBgNVBAYTAkFVMRMw
 EQYDVQQIEwpTb21lLVN0YXRlMSEwHwYDVQQKExhJbnRlcm5ldCBXaWRnaXRzIFB0
@@ -3181,10 +585,9 @@ ixgnTy5w/hOWusPTQBbNZU6sER7m8TAJBgcqhkjOPQQBA4GMADCBiAJCAOAUxGBg
 C3JosDJdYUoCdFzCgbkWqD8pyDbHgf9stlvZcPE4O1BIKJTLCRpS8V3ujfK58PDa
 2RU6+b0DeoeiIzXsAkIBo9SKeDUcSpoj0gq+KxAxnZxfvuiRs9oa9V2jI/Umi0Vw
 jWVim34BmT0Y9hCaOGGbLlfk+syxis7iI6CH8OFnUes=
------END CERTIFICATE-----
-`)
+-----END CERTIFICATE-----`
 
-/* corresponding key for cert is:
+const clientECDSAKeyPEM = `
 -----BEGIN EC PARAMETERS-----
 BgUrgQQAIw==
 -----END EC PARAMETERS-----
@@ -3194,603 +597,83 @@ k+wLWoqizS3NpQyMtrU8JFdWfj+C57UNkOugBwYFK4EEACOhgYkDgYYABACVjJF1
 FMBexFe01MNvja5oHt1vzobhfm6ySD6B5U7ixohLZNz1MLvT/2XMW/TdtWo+PtAd
 3kfDdq0Z9kUsjLzYHQFMH3CQRnZIi4+DzEpcj0B22uCJ7B0rxE4wdihBsmKo+1vx
 +U56jb0JuK7qixgnTy5w/hOWusPTQBbNZU6sER7m8Q==
------END EC PRIVATE KEY-----
-*/
-var clientauthECDSATests = []clientauthTest{
-	// Server asks for cert with empty CA list, client gives one
-	//   go test -run "TestRunServer" -serve \
-	//     -clientauth 1 -ciphersuites=0xc00a
-	//   openssl s_client -host 127.0.0.1 -port 10443 \
-	//     -cipher ECDHE-ECDSA-AES256-SHA -key client.key -cert client.crt
-	{"RequestClientCert, client gives it", RequestClientCert, []*x509.Certificate{clientECDSACertificate}, [][]byte{
-		{
-			0x16, 0x03, 0x01, 0x00, 0xa0, 0x01, 0x00, 0x00,
-			0x9c, 0x03, 0x03, 0x51, 0xe5, 0x73, 0xc5, 0xae,
-			0x51, 0x94, 0xb4, 0xf2, 0xe8, 0xf6, 0x03, 0x0e,
-			0x3b, 0x34, 0xaf, 0xf0, 0xdc, 0x1b, 0xcc, 0xd8,
-			0x0c, 0x45, 0x82, 0xd4, 0xd6, 0x76, 0x04, 0x6e,
-			0x4f, 0x7a, 0x24, 0x00, 0x00, 0x04, 0xc0, 0x0a,
-			0x00, 0xff, 0x01, 0x00, 0x00, 0x6f, 0x00, 0x0b,
-			0x00, 0x04, 0x03, 0x00, 0x01, 0x02, 0x00, 0x0a,
-			0x00, 0x34, 0x00, 0x32, 0x00, 0x0e, 0x00, 0x0d,
-			0x00, 0x19, 0x00, 0x0b, 0x00, 0x0c, 0x00, 0x18,
-			0x00, 0x09, 0x00, 0x0a, 0x00, 0x16, 0x00, 0x17,
-			0x00, 0x08, 0x00, 0x06, 0x00, 0x07, 0x00, 0x14,
-			0x00, 0x15, 0x00, 0x04, 0x00, 0x05, 0x00, 0x12,
-			0x00, 0x13, 0x00, 0x01, 0x00, 0x02, 0x00, 0x03,
-			0x00, 0x0f, 0x00, 0x10, 0x00, 0x11, 0x00, 0x23,
-			0x00, 0x00, 0x00, 0x0d, 0x00, 0x22, 0x00, 0x20,
-			0x06, 0x01, 0x06, 0x02, 0x06, 0x03, 0x05, 0x01,
-			0x05, 0x02, 0x05, 0x03, 0x04, 0x01, 0x04, 0x02,
-			0x04, 0x03, 0x03, 0x01, 0x03, 0x02, 0x03, 0x03,
-			0x02, 0x01, 0x02, 0x02, 0x02, 0x03, 0x01, 0x01,
-			0x00, 0x0f, 0x00, 0x01, 0x01,
-		},
-		{
-			0x16, 0x03, 0x01, 0x00, 0x30, 0x02, 0x00, 0x00,
-			0x2c, 0x03, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00,
-			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-			0x00, 0x00, 0x00, 0x00, 0xc0, 0x0a, 0x00, 0x00,
-			0x04, 0x00, 0x23, 0x00, 0x00, 0x16, 0x03, 0x01,
-			0x02, 0x0e, 0x0b, 0x00, 0x02, 0x0a, 0x00, 0x02,
-			0x07, 0x00, 0x02, 0x04, 0x30, 0x82, 0x02, 0x00,
-			0x30, 0x82, 0x01, 0x62, 0x02, 0x09, 0x00, 0xb8,
-			0xbf, 0x2d, 0x47, 0xa0, 0xd2, 0xeb, 0xf4, 0x30,
-			0x09, 0x06, 0x07, 0x2a, 0x86, 0x48, 0xce, 0x3d,
-			0x04, 0x01, 0x30, 0x45, 0x31, 0x0b, 0x30, 0x09,
-			0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x41,
-			0x55, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03, 0x55,
-			0x04, 0x08, 0x13, 0x0a, 0x53, 0x6f, 0x6d, 0x65,
-			0x2d, 0x53, 0x74, 0x61, 0x74, 0x65, 0x31, 0x21,
-			0x30, 0x1f, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13,
-			0x18, 0x49, 0x6e, 0x74, 0x65, 0x72, 0x6e, 0x65,
-			0x74, 0x20, 0x57, 0x69, 0x64, 0x67, 0x69, 0x74,
-			0x73, 0x20, 0x50, 0x74, 0x79, 0x20, 0x4c, 0x74,
-			0x64, 0x30, 0x1e, 0x17, 0x0d, 0x31, 0x32, 0x31,
-			0x31, 0x32, 0x32, 0x31, 0x35, 0x30, 0x36, 0x33,
-			0x32, 0x5a, 0x17, 0x0d, 0x32, 0x32, 0x31, 0x31,
-			0x32, 0x30, 0x31, 0x35, 0x30, 0x36, 0x33, 0x32,
-			0x5a, 0x30, 0x45, 0x31, 0x0b, 0x30, 0x09, 0x06,
-			0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x41, 0x55,
-			0x31, 0x13, 0x30, 0x11, 0x06, 0x03, 0x55, 0x04,
-			0x08, 0x13, 0x0a, 0x53, 0x6f, 0x6d, 0x65, 0x2d,
-			0x53, 0x74, 0x61, 0x74, 0x65, 0x31, 0x21, 0x30,
-			0x1f, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13, 0x18,
-			0x49, 0x6e, 0x74, 0x65, 0x72, 0x6e, 0x65, 0x74,
-			0x20, 0x57, 0x69, 0x64, 0x67, 0x69, 0x74, 0x73,
-			0x20, 0x50, 0x74, 0x79, 0x20, 0x4c, 0x74, 0x64,
-			0x30, 0x81, 0x9b, 0x30, 0x10, 0x06, 0x07, 0x2a,
-			0x86, 0x48, 0xce, 0x3d, 0x02, 0x01, 0x06, 0x05,
-			0x2b, 0x81, 0x04, 0x00, 0x23, 0x03, 0x81, 0x86,
-			0x00, 0x04, 0x00, 0xc4, 0xa1, 0xed, 0xbe, 0x98,
-			0xf9, 0x0b, 0x48, 0x73, 0x36, 0x7e, 0xc3, 0x16,
-			0x56, 0x11, 0x22, 0xf2, 0x3d, 0x53, 0xc3, 0x3b,
-			0x4d, 0x21, 0x3d, 0xcd, 0x6b, 0x75, 0xe6, 0xf6,
-			0xb0, 0xdc, 0x9a, 0xdf, 0x26, 0xc1, 0xbc, 0xb2,
-			0x87, 0xf0, 0x72, 0x32, 0x7c, 0xb3, 0x64, 0x2f,
-			0x1c, 0x90, 0xbc, 0xea, 0x68, 0x23, 0x10, 0x7e,
-			0xfe, 0xe3, 0x25, 0xc0, 0x48, 0x3a, 0x69, 0xe0,
-			0x28, 0x6d, 0xd3, 0x37, 0x00, 0xef, 0x04, 0x62,
-			0xdd, 0x0d, 0xa0, 0x9c, 0x70, 0x62, 0x83, 0xd8,
-			0x81, 0xd3, 0x64, 0x31, 0xaa, 0x9e, 0x97, 0x31,
-			0xbd, 0x96, 0xb0, 0x68, 0xc0, 0x9b, 0x23, 0xde,
-			0x76, 0x64, 0x3f, 0x1a, 0x5c, 0x7f, 0xe9, 0x12,
-			0x0e, 0x58, 0x58, 0xb6, 0x5f, 0x70, 0xdd, 0x9b,
-			0xd8, 0xea, 0xd5, 0xd7, 0xf5, 0xd5, 0xcc, 0xb9,
-			0xb6, 0x9f, 0x30, 0x66, 0x5b, 0x66, 0x9a, 0x20,
-			0xe2, 0x27, 0xe5, 0xbf, 0xfe, 0x3b, 0x30, 0x09,
-			0x06, 0x07, 0x2a, 0x86, 0x48, 0xce, 0x3d, 0x04,
-			0x01, 0x03, 0x81, 0x8c, 0x00, 0x30, 0x81, 0x88,
-			0x02, 0x42, 0x01, 0x88, 0xa2, 0x4f, 0xeb, 0xe2,
-			0x45, 0xc5, 0x48, 0x7d, 0x1b, 0xac, 0xf5, 0xed,
-			0x98, 0x9d, 0xae, 0x47, 0x70, 0xc0, 0x5e, 0x1b,
-			0xb6, 0x2f, 0xbd, 0xf1, 0xb6, 0x4d, 0xb7, 0x61,
-			0x40, 0xd3, 0x11, 0xa2, 0xce, 0xee, 0x0b, 0x7e,
-			0x92, 0x7e, 0xff, 0x76, 0x9d, 0xc3, 0x3b, 0x7e,
-			0xa5, 0x3f, 0xce, 0xfa, 0x10, 0xe2, 0x59, 0xec,
-			0x47, 0x2d, 0x7c, 0xac, 0xda, 0x4e, 0x97, 0x0e,
-			0x15, 0xa0, 0x6f, 0xd0, 0x02, 0x42, 0x01, 0x4d,
-			0xfc, 0xbe, 0x67, 0x13, 0x9c, 0x2d, 0x05, 0x0e,
-			0xbd, 0x3f, 0xa3, 0x8c, 0x25, 0xc1, 0x33, 0x13,
-			0x83, 0x0d, 0x94, 0x06, 0xbb, 0xd4, 0x37, 0x7a,
-			0xf6, 0xec, 0x7a, 0xc9, 0x86, 0x2e, 0xdd, 0xd7,
-			0x11, 0x69, 0x7f, 0x85, 0x7c, 0x56, 0xde, 0xfb,
-			0x31, 0x78, 0x2b, 0xe4, 0xc7, 0x78, 0x0d, 0xae,
-			0xcb, 0xbe, 0x9e, 0x4e, 0x36, 0x24, 0x31, 0x7b,
-			0x6a, 0x0f, 0x39, 0x95, 0x12, 0x07, 0x8f, 0x2a,
-			0x16, 0x03, 0x01, 0x01, 0x1a, 0x0c, 0x00, 0x01,
-			0x16, 0x03, 0x00, 0x19, 0x85, 0x04, 0x01, 0x39,
-			0xdc, 0xee, 0x44, 0x17, 0x5e, 0xdb, 0xd7, 0x27,
-			0xaf, 0xb6, 0x56, 0xd9, 0xb4, 0x43, 0x5a, 0x99,
-			0xcf, 0xaa, 0x31, 0x37, 0x0c, 0x6f, 0x3a, 0xa0,
-			0xf8, 0x53, 0xc4, 0x74, 0xd1, 0x91, 0x0a, 0x46,
-			0xf5, 0x38, 0x3b, 0x5c, 0x09, 0xd8, 0x97, 0xdc,
-			0x4b, 0xaa, 0x70, 0x26, 0x48, 0xf2, 0xd6, 0x0b,
-			0x31, 0xc9, 0xf8, 0xd4, 0x98, 0x43, 0xe1, 0x6c,
-			0xd5, 0xc7, 0xb2, 0x8e, 0x0b, 0x01, 0xe6, 0xb6,
-			0x00, 0x28, 0x80, 0x7b, 0xfc, 0x96, 0x8f, 0x0d,
-			0xa2, 0x4f, 0xb0, 0x79, 0xaf, 0xdc, 0x61, 0x28,
-			0x63, 0x33, 0x78, 0xf6, 0x31, 0x39, 0xfd, 0x8a,
-			0xf4, 0x15, 0x18, 0x11, 0xfe, 0xdb, 0xd5, 0x07,
-			0xda, 0x2c, 0xed, 0x49, 0xa0, 0x23, 0xbf, 0xd0,
-			0x3a, 0x38, 0x1d, 0x54, 0xae, 0x1c, 0x7b, 0xea,
-			0x29, 0xee, 0xd0, 0x38, 0xc1, 0x76, 0xa7, 0x7f,
-			0x2a, 0xf4, 0xce, 0x1e, 0xac, 0xcc, 0x94, 0x79,
-			0x90, 0x33, 0x00, 0x8b, 0x30, 0x81, 0x88, 0x02,
-			0x42, 0x00, 0xc6, 0x85, 0x8e, 0x06, 0xb7, 0x04,
-			0x04, 0xe9, 0xcd, 0x9e, 0x3e, 0xcb, 0x66, 0x23,
-			0x95, 0xb4, 0x42, 0x9c, 0x64, 0x81, 0x39, 0x05,
-			0x3f, 0xb5, 0x21, 0xf8, 0x28, 0xaf, 0x60, 0x6b,
-			0x4d, 0x3d, 0xba, 0xa1, 0x4b, 0x5e, 0x77, 0xef,
-			0xe7, 0x59, 0x28, 0xfe, 0x1d, 0xc1, 0x27, 0xa2,
-			0xff, 0xa8, 0xde, 0x33, 0x48, 0xb3, 0xc1, 0x85,
-			0x6a, 0x42, 0x9b, 0xf9, 0x7e, 0x7e, 0x31, 0xc2,
-			0xe5, 0xbd, 0x66, 0x02, 0x42, 0x00, 0xad, 0x7d,
-			0x06, 0x35, 0xab, 0xec, 0x8d, 0xac, 0xd4, 0xba,
-			0x1b, 0x49, 0x5e, 0x05, 0x5f, 0xf0, 0x97, 0x93,
-			0x82, 0xb8, 0x2b, 0x8d, 0x91, 0x98, 0x63, 0x8e,
-			0xb4, 0x14, 0x62, 0xdb, 0x1e, 0xc9, 0x2b, 0x30,
-			0xf8, 0x41, 0x9b, 0xa6, 0xe6, 0xbc, 0xde, 0x0e,
-			0x68, 0x30, 0x21, 0xf4, 0xa8, 0xa9, 0x1b, 0xec,
-			0x44, 0x4f, 0x5d, 0x02, 0x2f, 0x60, 0x45, 0x60,
-			0xba, 0xe0, 0x4e, 0xc0, 0xd4, 0x3b, 0x01, 0x16,
-			0x03, 0x01, 0x00, 0x09, 0x0d, 0x00, 0x00, 0x05,
-			0x02, 0x01, 0x40, 0x00, 0x00, 0x16, 0x03, 0x01,
-			0x00, 0x04, 0x0e, 0x00, 0x00, 0x00,
-		},
-		{
-			0x16, 0x03, 0x01, 0x02, 0x0a, 0x0b, 0x00, 0x02,
-			0x06, 0x00, 0x02, 0x03, 0x00, 0x02, 0x00, 0x30,
-			0x82, 0x01, 0xfc, 0x30, 0x82, 0x01, 0x5e, 0x02,
-			0x09, 0x00, 0x9a, 0x30, 0x84, 0x6c, 0x26, 0x35,
-			0xd9, 0x17, 0x30, 0x09, 0x06, 0x07, 0x2a, 0x86,
-			0x48, 0xce, 0x3d, 0x04, 0x01, 0x30, 0x45, 0x31,
-			0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06,
-			0x13, 0x02, 0x41, 0x55, 0x31, 0x13, 0x30, 0x11,
-			0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0a, 0x53,
-			0x6f, 0x6d, 0x65, 0x2d, 0x53, 0x74, 0x61, 0x74,
-			0x65, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x03, 0x55,
-			0x04, 0x0a, 0x13, 0x18, 0x49, 0x6e, 0x74, 0x65,
-			0x72, 0x6e, 0x65, 0x74, 0x20, 0x57, 0x69, 0x64,
-			0x67, 0x69, 0x74, 0x73, 0x20, 0x50, 0x74, 0x79,
-			0x20, 0x4c, 0x74, 0x64, 0x30, 0x1e, 0x17, 0x0d,
-			0x31, 0x32, 0x31, 0x31, 0x31, 0x34, 0x31, 0x33,
-			0x32, 0x35, 0x35, 0x33, 0x5a, 0x17, 0x0d, 0x32,
-			0x32, 0x31, 0x31, 0x31, 0x32, 0x31, 0x33, 0x32,
-			0x35, 0x35, 0x33, 0x5a, 0x30, 0x41, 0x31, 0x0b,
-			0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13,
-			0x02, 0x41, 0x55, 0x31, 0x0c, 0x30, 0x0a, 0x06,
-			0x03, 0x55, 0x04, 0x08, 0x13, 0x03, 0x4e, 0x53,
-			0x57, 0x31, 0x10, 0x30, 0x0e, 0x06, 0x03, 0x55,
-			0x04, 0x07, 0x13, 0x07, 0x50, 0x79, 0x72, 0x6d,
-			0x6f, 0x6e, 0x74, 0x31, 0x12, 0x30, 0x10, 0x06,
-			0x03, 0x55, 0x04, 0x03, 0x13, 0x09, 0x4a, 0x6f,
-			0x65, 0x6c, 0x20, 0x53, 0x69, 0x6e, 0x67, 0x30,
-			0x81, 0x9b, 0x30, 0x10, 0x06, 0x07, 0x2a, 0x86,
-			0x48, 0xce, 0x3d, 0x02, 0x01, 0x06, 0x05, 0x2b,
-			0x81, 0x04, 0x00, 0x23, 0x03, 0x81, 0x86, 0x00,
-			0x04, 0x00, 0x95, 0x8c, 0x91, 0x75, 0x14, 0xc0,
-			0x5e, 0xc4, 0x57, 0xb4, 0xd4, 0xc3, 0x6f, 0x8d,
-			0xae, 0x68, 0x1e, 0xdd, 0x6f, 0xce, 0x86, 0xe1,
-			0x7e, 0x6e, 0xb2, 0x48, 0x3e, 0x81, 0xe5, 0x4e,
-			0xe2, 0xc6, 0x88, 0x4b, 0x64, 0xdc, 0xf5, 0x30,
-			0xbb, 0xd3, 0xff, 0x65, 0xcc, 0x5b, 0xf4, 0xdd,
-			0xb5, 0x6a, 0x3e, 0x3e, 0xd0, 0x1d, 0xde, 0x47,
-			0xc3, 0x76, 0xad, 0x19, 0xf6, 0x45, 0x2c, 0x8c,
-			0xbc, 0xd8, 0x1d, 0x01, 0x4c, 0x1f, 0x70, 0x90,
-			0x46, 0x76, 0x48, 0x8b, 0x8f, 0x83, 0xcc, 0x4a,
-			0x5c, 0x8f, 0x40, 0x76, 0xda, 0xe0, 0x89, 0xec,
-			0x1d, 0x2b, 0xc4, 0x4e, 0x30, 0x76, 0x28, 0x41,
-			0xb2, 0x62, 0xa8, 0xfb, 0x5b, 0xf1, 0xf9, 0x4e,
-			0x7a, 0x8d, 0xbd, 0x09, 0xb8, 0xae, 0xea, 0x8b,
-			0x18, 0x27, 0x4f, 0x2e, 0x70, 0xfe, 0x13, 0x96,
-			0xba, 0xc3, 0xd3, 0x40, 0x16, 0xcd, 0x65, 0x4e,
-			0xac, 0x11, 0x1e, 0xe6, 0xf1, 0x30, 0x09, 0x06,
-			0x07, 0x2a, 0x86, 0x48, 0xce, 0x3d, 0x04, 0x01,
-			0x03, 0x81, 0x8c, 0x00, 0x30, 0x81, 0x88, 0x02,
-			0x42, 0x00, 0xe0, 0x14, 0xc4, 0x60, 0x60, 0x0b,
-			0x72, 0x68, 0xb0, 0x32, 0x5d, 0x61, 0x4a, 0x02,
-			0x74, 0x5c, 0xc2, 0x81, 0xb9, 0x16, 0xa8, 0x3f,
-			0x29, 0xc8, 0x36, 0xc7, 0x81, 0xff, 0x6c, 0xb6,
-			0x5b, 0xd9, 0x70, 0xf1, 0x38, 0x3b, 0x50, 0x48,
-			0x28, 0x94, 0xcb, 0x09, 0x1a, 0x52, 0xf1, 0x5d,
-			0xee, 0x8d, 0xf2, 0xb9, 0xf0, 0xf0, 0xda, 0xd9,
-			0x15, 0x3a, 0xf9, 0xbd, 0x03, 0x7a, 0x87, 0xa2,
-			0x23, 0x35, 0xec, 0x02, 0x42, 0x01, 0xa3, 0xd4,
-			0x8a, 0x78, 0x35, 0x1c, 0x4a, 0x9a, 0x23, 0xd2,
-			0x0a, 0xbe, 0x2b, 0x10, 0x31, 0x9d, 0x9c, 0x5f,
-			0xbe, 0xe8, 0x91, 0xb3, 0xda, 0x1a, 0xf5, 0x5d,
-			0xa3, 0x23, 0xf5, 0x26, 0x8b, 0x45, 0x70, 0x8d,
-			0x65, 0x62, 0x9b, 0x7e, 0x01, 0x99, 0x3d, 0x18,
-			0xf6, 0x10, 0x9a, 0x38, 0x61, 0x9b, 0x2e, 0x57,
-			0xe4, 0xfa, 0xcc, 0xb1, 0x8a, 0xce, 0xe2, 0x23,
-			0xa0, 0x87, 0xf0, 0xe1, 0x67, 0x51, 0xeb, 0x16,
-			0x03, 0x01, 0x00, 0x8a, 0x10, 0x00, 0x00, 0x86,
-			0x85, 0x04, 0x00, 0xcd, 0x1c, 0xe8, 0x66, 0x5b,
-			0xa8, 0x9d, 0x83, 0x2f, 0x7e, 0x1d, 0x0b, 0x59,
-			0x23, 0xbc, 0x30, 0xcf, 0xa3, 0xaf, 0x21, 0xdc,
-			0xf2, 0x57, 0x49, 0x56, 0x30, 0x25, 0x7c, 0x84,
-			0x5d, 0xad, 0xaa, 0x9c, 0x7b, 0x2a, 0x95, 0x58,
-			0x3d, 0x30, 0x87, 0x01, 0x3b, 0xb7, 0xea, 0xcb,
-			0xc4, 0xa3, 0xeb, 0x22, 0xbf, 0x2d, 0x61, 0x17,
-			0x8c, 0x9b, 0xe8, 0x1b, 0xb2, 0x87, 0x16, 0x78,
-			0xd5, 0xfd, 0x8b, 0xdd, 0x00, 0x0f, 0xda, 0x8e,
-			0xfd, 0x28, 0x36, 0xeb, 0xe4, 0xc5, 0x42, 0x14,
-			0xc7, 0xbd, 0x29, 0x5e, 0x9a, 0xed, 0x5e, 0xc1,
-			0xf7, 0xf4, 0xbd, 0xbd, 0x15, 0x9c, 0xe8, 0x44,
-			0x71, 0xa7, 0xb6, 0xe9, 0xfa, 0x7e, 0x97, 0xcb,
-			0x96, 0x3e, 0x53, 0x76, 0xfb, 0x11, 0x1f, 0x36,
-			0x8f, 0x30, 0xfb, 0x71, 0x3a, 0x75, 0x3a, 0x25,
-			0x7b, 0xa2, 0xc1, 0xf9, 0x3e, 0x58, 0x5f, 0x07,
-			0x16, 0xed, 0xe1, 0xf7, 0xc1, 0xb1, 0x16, 0x03,
-			0x01, 0x00, 0x90, 0x0f, 0x00, 0x00, 0x8c, 0x00,
-			0x8a, 0x30, 0x81, 0x87, 0x02, 0x42, 0x00, 0xb2,
-			0xd3, 0x91, 0xe6, 0xd5, 0x9b, 0xb2, 0xb8, 0x03,
-			0xf4, 0x85, 0x4d, 0x43, 0x79, 0x1f, 0xb6, 0x6f,
-			0x0c, 0xcd, 0x67, 0x5f, 0x5e, 0xca, 0xee, 0xb3,
-			0xe4, 0xab, 0x1e, 0x58, 0xc3, 0x04, 0xa9, 0x8a,
-			0xa7, 0xcf, 0xaa, 0x33, 0x88, 0xd5, 0x35, 0xd2,
-			0x80, 0x8f, 0xfa, 0x1b, 0x3c, 0x3d, 0xf7, 0x80,
-			0x50, 0xde, 0x80, 0x30, 0x64, 0xee, 0xc0, 0xb3,
-			0x91, 0x6e, 0x5d, 0x1e, 0xc0, 0xdc, 0x3a, 0x93,
-			0x02, 0x41, 0x4e, 0xca, 0x98, 0x41, 0x8c, 0x36,
-			0xf2, 0x12, 0xbf, 0x8e, 0x0f, 0x69, 0x8e, 0xf8,
-			0x7b, 0x9d, 0xba, 0x9c, 0x5c, 0x48, 0x79, 0xf4,
-			0xba, 0x3d, 0x06, 0xa5, 0xab, 0x47, 0xe0, 0x1a,
-			0x45, 0x28, 0x3a, 0x8f, 0xbf, 0x14, 0x24, 0x36,
-			0xd1, 0x1d, 0x29, 0xdc, 0xde, 0x72, 0x5b, 0x76,
-			0x41, 0x67, 0xe8, 0xe5, 0x71, 0x4a, 0x77, 0xe9,
-			0xed, 0x02, 0x19, 0xdd, 0xe4, 0xaa, 0xe9, 0x2d,
-			0xe7, 0x47, 0x32, 0x14, 0x03, 0x01, 0x00, 0x01,
-			0x01, 0x16, 0x03, 0x01, 0x00, 0x30, 0xfa, 0xc3,
-			0xf2, 0x35, 0xd0, 0x6d, 0x32, 0x78, 0x6a, 0xd6,
-			0xe6, 0x70, 0x5e, 0x00, 0x4c, 0x35, 0xf1, 0xe0,
-			0x21, 0xcf, 0xc3, 0x78, 0xcd, 0xe0, 0x2b, 0x0b,
-			0xf4, 0xeb, 0xf9, 0xc0, 0x38, 0xf2, 0x9a, 0x31,
-			0x55, 0x07, 0x2b, 0x8d, 0x68, 0x40, 0x31, 0x08,
-			0xaa, 0xe3, 0x16, 0xcf, 0x4b, 0xd4,
-		},
-		{
-			0x16, 0x03, 0x01, 0x02, 0x76, 0x04, 0x00, 0x02,
-			0x72, 0x00, 0x00, 0x00, 0x00, 0x02, 0x6c, 0x00,
-			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-			0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x65,
-			0xe8, 0x8b, 0xde, 0xef, 0xba, 0xf9, 0xdb, 0x95,
-			0x24, 0xa5, 0x49, 0xb3, 0x23, 0xd8, 0x73, 0x88,
-			0x50, 0x42, 0xed, 0xeb, 0xa3, 0xd8, 0xab, 0x31,
-			0x9c, 0xd0, 0x00, 0x01, 0xef, 0xc0, 0xbf, 0xab,
-			0x59, 0x55, 0xb5, 0xb9, 0xef, 0xa5, 0xa6, 0xec,
-			0x69, 0xed, 0x00, 0x2f, 0x47, 0xdb, 0x75, 0x52,
-			0x0c, 0xe5, 0x86, 0xb7, 0x02, 0x59, 0x22, 0xf7,
-			0xfd, 0x8b, 0xff, 0xa4, 0x09, 0xc0, 0x1c, 0x10,
-			0x80, 0x10, 0x7f, 0x4c, 0x7a, 0x94, 0x40, 0x10,
-			0x0d, 0xda, 0x8a, 0xe5, 0x4a, 0xbc, 0xd0, 0xc0,
-			0x4b, 0xa5, 0x33, 0x97, 0xc6, 0xe7, 0x40, 0x7f,
-			0x7f, 0x8c, 0xf9, 0xf8, 0xc8, 0xb8, 0xfb, 0x8c,
-			0xdd, 0x28, 0x81, 0xae, 0xfd, 0x37, 0x20, 0x3a,
-			0x40, 0x37, 0x99, 0xc4, 0x21, 0x01, 0xc4, 0x91,
-			0xb0, 0x5e, 0x11, 0xc5, 0xa9, 0xfd, 0x9a, 0x02,
-			0x7e, 0x97, 0x6a, 0x86, 0x89, 0xb8, 0xc1, 0x32,
-			0x4c, 0x7e, 0x6d, 0x47, 0x61, 0x0e, 0xe3, 0xc2,
-			0xf0, 0x62, 0x3c, 0xc6, 0x71, 0x4f, 0xbb, 0x47,
-			0x65, 0xb1, 0xd9, 0x22, 0x79, 0x15, 0xea, 0x1f,
-			0x4b, 0x2a, 0x8a, 0xa4, 0xc8, 0x73, 0x34, 0xba,
-			0x83, 0xe4, 0x70, 0x99, 0xc9, 0xcf, 0xbe, 0x64,
-			0x99, 0xb9, 0xfa, 0xe9, 0xaf, 0x5d, 0xc7, 0x20,
-			0x26, 0xde, 0xc5, 0x06, 0x12, 0x36, 0x4f, 0x4d,
-			0xc0, 0xbb, 0x81, 0x5b, 0x5e, 0x38, 0xc3, 0x07,
-			0x21, 0x04, 0x1a, 0x53, 0x9c, 0x59, 0xac, 0x2d,
-			0xe6, 0xa5, 0x93, 0xa5, 0x19, 0xc6, 0xb0, 0xf7,
-			0x56, 0x5d, 0xdf, 0xd1, 0xf4, 0xfd, 0x44, 0x6d,
-			0xc6, 0xa2, 0x31, 0xa7, 0x35, 0x42, 0x18, 0x50,
-			0x0c, 0x4f, 0x6e, 0xe3, 0x3b, 0xa3, 0xaa, 0x1c,
-			0xbe, 0x41, 0x0d, 0xce, 0x6c, 0x62, 0xe1, 0x96,
-			0x2d, 0xbd, 0x14, 0x31, 0xe3, 0xc4, 0x5b, 0xbf,
-			0xf6, 0xde, 0xec, 0x42, 0xe8, 0xc7, 0x2a, 0x0b,
-			0xdb, 0x2d, 0x7c, 0xf0, 0x3f, 0x45, 0x32, 0x45,
-			0x09, 0x47, 0x09, 0x0f, 0x21, 0x22, 0x45, 0x06,
-			0x11, 0xb8, 0xf9, 0xe6, 0x67, 0x90, 0x4b, 0x4a,
-			0xde, 0x81, 0xfb, 0xeb, 0xe7, 0x9a, 0x08, 0x30,
-			0xcf, 0x51, 0xe1, 0xd9, 0xfa, 0x79, 0xa3, 0xcc,
-			0x65, 0x1a, 0x83, 0x86, 0xc9, 0x7a, 0x41, 0xf5,
-			0xdf, 0xa0, 0x7c, 0x44, 0x23, 0x17, 0xf3, 0x62,
-			0xe8, 0xa9, 0x31, 0x1e, 0x6b, 0x05, 0x4b, 0x4f,
-			0x9d, 0x91, 0x46, 0x92, 0xa6, 0x25, 0x32, 0xca,
-			0xa1, 0x75, 0xda, 0xe6, 0x80, 0x3e, 0x7f, 0xd1,
-			0x26, 0x57, 0x07, 0x42, 0xe4, 0x91, 0xff, 0xbd,
-			0x44, 0xae, 0x98, 0x5c, 0x1d, 0xdf, 0x11, 0xe3,
-			0xae, 0x87, 0x5e, 0xb7, 0x69, 0xad, 0x34, 0x7f,
-			0x3a, 0x07, 0x7c, 0xdf, 0xfc, 0x76, 0x17, 0x8b,
-			0x62, 0xc8, 0xe1, 0x78, 0x2a, 0xc8, 0xb9, 0x8a,
-			0xbb, 0x5c, 0xfb, 0x38, 0x74, 0x91, 0x6e, 0x12,
-			0x0c, 0x1f, 0x8e, 0xe1, 0xc2, 0x01, 0xd8, 0x9d,
-			0x23, 0x0f, 0xc4, 0x67, 0x5d, 0xe5, 0x67, 0x4b,
-			0x94, 0x6e, 0x69, 0x72, 0x90, 0x2d, 0x52, 0x78,
-			0x8e, 0x61, 0xba, 0xdf, 0x4e, 0xf5, 0xdc, 0xfb,
-			0x73, 0xbe, 0x03, 0x70, 0xd9, 0x01, 0x30, 0xf3,
-			0xa1, 0xbb, 0x9a, 0x5f, 0xec, 0x9e, 0xed, 0x8d,
-			0xdd, 0x53, 0xfd, 0x60, 0xc3, 0x2b, 0x7a, 0x00,
-			0x2c, 0xf9, 0x0a, 0x57, 0x47, 0x45, 0x43, 0xb3,
-			0x23, 0x01, 0x9c, 0xee, 0x54, 0x4d, 0x58, 0xd3,
-			0x71, 0x1c, 0xc9, 0xd3, 0x30, 0x9e, 0x14, 0xa5,
-			0xf3, 0xbf, 0x4d, 0x9b, 0xb7, 0x13, 0x21, 0xae,
-			0xd2, 0x8d, 0x6e, 0x6f, 0x1c, 0xcc, 0xb2, 0x41,
-			0xb2, 0x64, 0x56, 0x83, 0xce, 0xd1, 0x0c, 0x79,
-			0x32, 0x78, 0xef, 0xc5, 0x21, 0xb1, 0xe8, 0xc4,
-			0x42, 0xa7, 0x8d, 0xc1, 0xfa, 0xa1, 0x9c, 0x3c,
-			0x21, 0xd8, 0xe9, 0x90, 0xe2, 0x7c, 0x14, 0x26,
-			0xfe, 0x61, 0x3e, 0xf9, 0x71, 0x1d, 0x5d, 0x49,
-			0x3b, 0xb1, 0xb8, 0x42, 0xa1, 0xb8, 0x1c, 0x75,
-			0x7d, 0xee, 0xed, 0xfc, 0xe6, 0x20, 0x2b, 0x9e,
-			0x10, 0x52, 0xda, 0x56, 0x4d, 0x64, 0x6c, 0x41,
-			0xc1, 0xf7, 0x60, 0x0c, 0x10, 0x65, 0x6f, 0xd4,
-			0xe9, 0x9b, 0x0d, 0x83, 0x13, 0xc8, 0x5a, 0xa3,
-			0x56, 0x2a, 0x42, 0xc6, 0x1c, 0xfe, 0xdb, 0xba,
-			0x3d, 0x04, 0x12, 0xfd, 0x28, 0xeb, 0x78, 0xdd,
-			0xbc, 0xc8, 0x0d, 0xa1, 0xce, 0xd4, 0x54, 0xbf,
-			0xaf, 0xe1, 0x60, 0x0c, 0xa3, 0xc3, 0xc3, 0x62,
-			0x58, 0xc1, 0x79, 0xa7, 0x95, 0x41, 0x09, 0x24,
-			0xc6, 0x9a, 0x50, 0x14, 0x03, 0x01, 0x00, 0x01,
-			0x01, 0x16, 0x03, 0x01, 0x00, 0x30, 0x4d, 0x7b,
-			0x5f, 0x28, 0x5e, 0x68, 0x6c, 0xa3, 0x65, 0xc7,
-			0x7e, 0x49, 0x6c, 0xb3, 0x67, 0xbb, 0xd0, 0x75,
-			0xa2, 0x9e, 0x8c, 0x92, 0x4f, 0x8c, 0x33, 0x14,
-			0x7c, 0x6c, 0xf1, 0x74, 0x97, 0xc3, 0xe0, 0x10,
-			0xe9, 0x0d, 0xc2, 0x30, 0x5c, 0x23, 0xee, 0x1d,
-			0x16, 0x2e, 0xb9, 0x96, 0x2b, 0x2d, 0x17, 0x03,
-			0x01, 0x00, 0x20, 0xf2, 0xc8, 0xa7, 0x1b, 0x60,
-			0x46, 0xee, 0xe5, 0x7e, 0xc9, 0x35, 0xb3, 0xf1,
-			0x7c, 0x32, 0x0c, 0x85, 0x94, 0x59, 0x57, 0x27,
-			0xb0, 0xbd, 0x52, 0x86, 0x90, 0xf1, 0xb7, 0x4d,
-			0x1e, 0xc1, 0x16, 0x17, 0x03, 0x01, 0x00, 0x30,
-			0xff, 0x85, 0x50, 0xdf, 0x3f, 0xfc, 0xa2, 0x61,
-			0x1a, 0x12, 0xc0, 0x1e, 0x10, 0x32, 0x88, 0x50,
-			0xa0, 0x2c, 0x80, 0xda, 0x77, 0xea, 0x09, 0x47,
-			0xe0, 0x85, 0x07, 0x29, 0x45, 0x65, 0x19, 0xa3,
-			0x8d, 0x99, 0xb8, 0xbf, 0xb6, 0xbc, 0x76, 0xe2,
-			0x50, 0x24, 0x82, 0x0a, 0xfd, 0xdd, 0x35, 0x09,
-			0x15, 0x03, 0x01, 0x00, 0x20, 0xe7, 0x36, 0xf6,
-			0x61, 0xd2, 0x95, 0x3c, 0xb6, 0x65, 0x7b, 0xb2,
-			0xb8, 0xdf, 0x03, 0x53, 0xeb, 0xf7, 0x16, 0xe0,
-			0xe0, 0x15, 0x22, 0x71, 0x70, 0x62, 0x73, 0xad,
-			0xb5, 0x1a, 0x77, 0x44, 0x57,
-		},
-	}},
+-----END EC PRIVATE KEY-----`
+
+func TestClientAuth(t *testing.T) {
+	var certPath, keyPath, ecdsaCertPath, ecdsaKeyPath string
+
+	if *update {
+		certPath = tempFile(clientCertificatePEM)
+		defer os.Remove(certPath)
+		keyPath = tempFile(clientKeyPEM)
+		defer os.Remove(keyPath)
+		ecdsaCertPath = tempFile(clientECDSACertificatePEM)
+		defer os.Remove(ecdsaCertPath)
+		ecdsaKeyPath = tempFile(clientECDSAKeyPEM)
+		defer os.Remove(ecdsaKeyPath)
+	}
+
+	config := *testConfig
+	config.ClientAuth = RequestClientCert
+
+	test := &serverTest{
+		name:    "ClientAuthRequestedNotGiven",
+		command: []string{"openssl", "s_client", "-no_ticket", "-cipher", "RC4-SHA"},
+		config:  &config,
+	}
+	runServerTestTLS12(t, test)
+
+	test = &serverTest{
+		name:              "ClientAuthRequestedAndGiven",
+		command:           []string{"openssl", "s_client", "-no_ticket", "-cipher", "RC4-SHA", "-cert", certPath, "-key", keyPath},
+		config:            &config,
+		expectedPeerCerts: []string{clientCertificatePEM},
+	}
+	runServerTestTLS12(t, test)
+
+	test = &serverTest{
+		name:              "ClientAuthRequestedAndECDSAGiven",
+		command:           []string{"openssl", "s_client", "-no_ticket", "-cipher", "RC4-SHA", "-cert", ecdsaCertPath, "-key", ecdsaKeyPath},
+		config:            &config,
+		expectedPeerCerts: []string{clientECDSACertificatePEM},
+	}
+	runServerTestTLS12(t, test)
 }
 
-var aesGCMServerScript = [][]byte{
-	{
-		0x16, 0x03, 0x01, 0x01, 0x1c, 0x01, 0x00, 0x01,
-		0x18, 0x03, 0x03, 0x52, 0x1e, 0x74, 0xf0, 0xb0,
-		0xc1, 0x8b, 0x16, 0xf9, 0x74, 0xfc, 0x16, 0xc4,
-		0x11, 0x18, 0x96, 0x08, 0x25, 0x38, 0x4f, 0x98,
-		0x98, 0xbe, 0xb5, 0x61, 0xdf, 0x94, 0x15, 0xcc,
-		0x9b, 0x61, 0xef, 0x00, 0x00, 0x80, 0xc0, 0x30,
-		0xc0, 0x2c, 0xc0, 0x28, 0xc0, 0x24, 0xc0, 0x14,
-		0xc0, 0x0a, 0x00, 0xa3, 0x00, 0x9f, 0x00, 0x6b,
-		0x00, 0x6a, 0x00, 0x39, 0x00, 0x38, 0xc0, 0x32,
-		0xc0, 0x2e, 0xc0, 0x2a, 0xc0, 0x26, 0xc0, 0x0f,
-		0xc0, 0x05, 0x00, 0x9d, 0x00, 0x3d, 0x00, 0x35,
-		0xc0, 0x12, 0xc0, 0x08, 0x00, 0x16, 0x00, 0x13,
-		0xc0, 0x0d, 0xc0, 0x03, 0x00, 0x0a, 0xc0, 0x2f,
-		0xc0, 0x2b, 0xc0, 0x27, 0xc0, 0x23, 0xc0, 0x13,
-		0xc0, 0x09, 0x00, 0xa2, 0x00, 0x9e, 0x00, 0x67,
-		0x00, 0x40, 0x00, 0x33, 0x00, 0x32, 0xc0, 0x31,
-		0xc0, 0x2d, 0xc0, 0x29, 0xc0, 0x25, 0xc0, 0x0e,
-		0xc0, 0x04, 0x00, 0x9c, 0x00, 0x3c, 0x00, 0x2f,
-		0xc0, 0x11, 0xc0, 0x07, 0xc0, 0x0c, 0xc0, 0x02,
-		0x00, 0x05, 0x00, 0x04, 0x00, 0x15, 0x00, 0x12,
-		0x00, 0x09, 0x00, 0x14, 0x00, 0x11, 0x00, 0x08,
-		0x00, 0x06, 0x00, 0x03, 0x00, 0xff, 0x01, 0x00,
-		0x00, 0x6f, 0x00, 0x0b, 0x00, 0x04, 0x03, 0x00,
-		0x01, 0x02, 0x00, 0x0a, 0x00, 0x34, 0x00, 0x32,
-		0x00, 0x0e, 0x00, 0x0d, 0x00, 0x19, 0x00, 0x0b,
-		0x00, 0x0c, 0x00, 0x18, 0x00, 0x09, 0x00, 0x0a,
-		0x00, 0x16, 0x00, 0x17, 0x00, 0x08, 0x00, 0x06,
-		0x00, 0x07, 0x00, 0x14, 0x00, 0x15, 0x00, 0x04,
-		0x00, 0x05, 0x00, 0x12, 0x00, 0x13, 0x00, 0x01,
-		0x00, 0x02, 0x00, 0x03, 0x00, 0x0f, 0x00, 0x10,
-		0x00, 0x11, 0x00, 0x23, 0x00, 0x00, 0x00, 0x0d,
-		0x00, 0x22, 0x00, 0x20, 0x06, 0x01, 0x06, 0x02,
-		0x06, 0x03, 0x05, 0x01, 0x05, 0x02, 0x05, 0x03,
-		0x04, 0x01, 0x04, 0x02, 0x04, 0x03, 0x03, 0x01,
-		0x03, 0x02, 0x03, 0x03, 0x02, 0x01, 0x02, 0x02,
-		0x02, 0x03, 0x01, 0x01, 0x00, 0x0f, 0x00, 0x01,
-		0x01,
-	},
-	{
-		0x16, 0x03, 0x03, 0x00, 0x30, 0x02, 0x00, 0x00,
-		0x2c, 0x03, 0x03, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0xc0, 0x2f, 0x00, 0x00,
-		0x04, 0x00, 0x23, 0x00, 0x00, 0x16, 0x03, 0x03,
-		0x02, 0xbe, 0x0b, 0x00, 0x02, 0xba, 0x00, 0x02,
-		0xb7, 0x00, 0x02, 0xb4, 0x30, 0x82, 0x02, 0xb0,
-		0x30, 0x82, 0x02, 0x19, 0xa0, 0x03, 0x02, 0x01,
-		0x02, 0x02, 0x09, 0x00, 0x85, 0xb0, 0xbb, 0xa4,
-		0x8a, 0x7f, 0xb8, 0xca, 0x30, 0x0d, 0x06, 0x09,
-		0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01,
-		0x05, 0x05, 0x00, 0x30, 0x45, 0x31, 0x0b, 0x30,
-		0x09, 0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02,
-		0x41, 0x55, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03,
-		0x55, 0x04, 0x08, 0x13, 0x0a, 0x53, 0x6f, 0x6d,
-		0x65, 0x2d, 0x53, 0x74, 0x61, 0x74, 0x65, 0x31,
-		0x21, 0x30, 0x1f, 0x06, 0x03, 0x55, 0x04, 0x0a,
-		0x13, 0x18, 0x49, 0x6e, 0x74, 0x65, 0x72, 0x6e,
-		0x65, 0x74, 0x20, 0x57, 0x69, 0x64, 0x67, 0x69,
-		0x74, 0x73, 0x20, 0x50, 0x74, 0x79, 0x20, 0x4c,
-		0x74, 0x64, 0x30, 0x1e, 0x17, 0x0d, 0x31, 0x30,
-		0x30, 0x34, 0x32, 0x34, 0x30, 0x39, 0x30, 0x39,
-		0x33, 0x38, 0x5a, 0x17, 0x0d, 0x31, 0x31, 0x30,
-		0x34, 0x32, 0x34, 0x30, 0x39, 0x30, 0x39, 0x33,
-		0x38, 0x5a, 0x30, 0x45, 0x31, 0x0b, 0x30, 0x09,
-		0x06, 0x03, 0x55, 0x04, 0x06, 0x13, 0x02, 0x41,
-		0x55, 0x31, 0x13, 0x30, 0x11, 0x06, 0x03, 0x55,
-		0x04, 0x08, 0x13, 0x0a, 0x53, 0x6f, 0x6d, 0x65,
-		0x2d, 0x53, 0x74, 0x61, 0x74, 0x65, 0x31, 0x21,
-		0x30, 0x1f, 0x06, 0x03, 0x55, 0x04, 0x0a, 0x13,
-		0x18, 0x49, 0x6e, 0x74, 0x65, 0x72, 0x6e, 0x65,
-		0x74, 0x20, 0x57, 0x69, 0x64, 0x67, 0x69, 0x74,
-		0x73, 0x20, 0x50, 0x74, 0x79, 0x20, 0x4c, 0x74,
-		0x64, 0x30, 0x81, 0x9f, 0x30, 0x0d, 0x06, 0x09,
-		0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01, 0x01,
-		0x01, 0x05, 0x00, 0x03, 0x81, 0x8d, 0x00, 0x30,
-		0x81, 0x89, 0x02, 0x81, 0x81, 0x00, 0xbb, 0x79,
-		0xd6, 0xf5, 0x17, 0xb5, 0xe5, 0xbf, 0x46, 0x10,
-		0xd0, 0xdc, 0x69, 0xbe, 0xe6, 0x2b, 0x07, 0x43,
-		0x5a, 0xd0, 0x03, 0x2d, 0x8a, 0x7a, 0x43, 0x85,
-		0xb7, 0x14, 0x52, 0xe7, 0xa5, 0x65, 0x4c, 0x2c,
-		0x78, 0xb8, 0x23, 0x8c, 0xb5, 0xb4, 0x82, 0xe5,
-		0xde, 0x1f, 0x95, 0x3b, 0x7e, 0x62, 0xa5, 0x2c,
-		0xa5, 0x33, 0xd6, 0xfe, 0x12, 0x5c, 0x7a, 0x56,
-		0xfc, 0xf5, 0x06, 0xbf, 0xfa, 0x58, 0x7b, 0x26,
-		0x3f, 0xb5, 0xcd, 0x04, 0xd3, 0xd0, 0xc9, 0x21,
-		0x96, 0x4a, 0xc7, 0xf4, 0x54, 0x9f, 0x5a, 0xbf,
-		0xef, 0x42, 0x71, 0x00, 0xfe, 0x18, 0x99, 0x07,
-		0x7f, 0x7e, 0x88, 0x7d, 0x7d, 0xf1, 0x04, 0x39,
-		0xc4, 0xa2, 0x2e, 0xdb, 0x51, 0xc9, 0x7c, 0xe3,
-		0xc0, 0x4c, 0x3b, 0x32, 0x66, 0x01, 0xcf, 0xaf,
-		0xb1, 0x1d, 0xb8, 0x71, 0x9a, 0x1d, 0xdb, 0xdb,
-		0x89, 0x6b, 0xae, 0xda, 0x2d, 0x79, 0x02, 0x03,
-		0x01, 0x00, 0x01, 0xa3, 0x81, 0xa7, 0x30, 0x81,
-		0xa4, 0x30, 0x1d, 0x06, 0x03, 0x55, 0x1d, 0x0e,
-		0x04, 0x16, 0x04, 0x14, 0xb1, 0xad, 0xe2, 0x85,
-		0x5a, 0xcf, 0xcb, 0x28, 0xdb, 0x69, 0xce, 0x23,
-		0x69, 0xde, 0xd3, 0x26, 0x8e, 0x18, 0x88, 0x39,
-		0x30, 0x75, 0x06, 0x03, 0x55, 0x1d, 0x23, 0x04,
-		0x6e, 0x30, 0x6c, 0x80, 0x14, 0xb1, 0xad, 0xe2,
-		0x85, 0x5a, 0xcf, 0xcb, 0x28, 0xdb, 0x69, 0xce,
-		0x23, 0x69, 0xde, 0xd3, 0x26, 0x8e, 0x18, 0x88,
-		0x39, 0xa1, 0x49, 0xa4, 0x47, 0x30, 0x45, 0x31,
-		0x0b, 0x30, 0x09, 0x06, 0x03, 0x55, 0x04, 0x06,
-		0x13, 0x02, 0x41, 0x55, 0x31, 0x13, 0x30, 0x11,
-		0x06, 0x03, 0x55, 0x04, 0x08, 0x13, 0x0a, 0x53,
-		0x6f, 0x6d, 0x65, 0x2d, 0x53, 0x74, 0x61, 0x74,
-		0x65, 0x31, 0x21, 0x30, 0x1f, 0x06, 0x03, 0x55,
-		0x04, 0x0a, 0x13, 0x18, 0x49, 0x6e, 0x74, 0x65,
-		0x72, 0x6e, 0x65, 0x74, 0x20, 0x57, 0x69, 0x64,
-		0x67, 0x69, 0x74, 0x73, 0x20, 0x50, 0x74, 0x79,
-		0x20, 0x4c, 0x74, 0x64, 0x82, 0x09, 0x00, 0x85,
-		0xb0, 0xbb, 0xa4, 0x8a, 0x7f, 0xb8, 0xca, 0x30,
-		0x0c, 0x06, 0x03, 0x55, 0x1d, 0x13, 0x04, 0x05,
-		0x30, 0x03, 0x01, 0x01, 0xff, 0x30, 0x0d, 0x06,
-		0x09, 0x2a, 0x86, 0x48, 0x86, 0xf7, 0x0d, 0x01,
-		0x01, 0x05, 0x05, 0x00, 0x03, 0x81, 0x81, 0x00,
-		0x08, 0x6c, 0x45, 0x24, 0xc7, 0x6b, 0xb1, 0x59,
-		0xab, 0x0c, 0x52, 0xcc, 0xf2, 0xb0, 0x14, 0xd7,
-		0x87, 0x9d, 0x7a, 0x64, 0x75, 0xb5, 0x5a, 0x95,
-		0x66, 0xe4, 0xc5, 0x2b, 0x8e, 0xae, 0x12, 0x66,
-		0x1f, 0xeb, 0x4f, 0x38, 0xb3, 0x6e, 0x60, 0xd3,
-		0x92, 0xfd, 0xf7, 0x41, 0x08, 0xb5, 0x25, 0x13,
-		0xb1, 0x18, 0x7a, 0x24, 0xfb, 0x30, 0x1d, 0xba,
-		0xed, 0x98, 0xb9, 0x17, 0xec, 0xe7, 0xd7, 0x31,
-		0x59, 0xdb, 0x95, 0xd3, 0x1d, 0x78, 0xea, 0x50,
-		0x56, 0x5c, 0xd5, 0x82, 0x5a, 0x2d, 0x5a, 0x5f,
-		0x33, 0xc4, 0xb6, 0xd8, 0xc9, 0x75, 0x90, 0x96,
-		0x8c, 0x0f, 0x52, 0x98, 0xb5, 0xcd, 0x98, 0x1f,
-		0x89, 0x20, 0x5f, 0xf2, 0xa0, 0x1c, 0xa3, 0x1b,
-		0x96, 0x94, 0xdd, 0xa9, 0xfd, 0x57, 0xe9, 0x70,
-		0xe8, 0x26, 0x6d, 0x71, 0x99, 0x9b, 0x26, 0x6e,
-		0x38, 0x50, 0x29, 0x6c, 0x90, 0xa7, 0xbd, 0xd9,
-		0x16, 0x03, 0x03, 0x01, 0x11, 0x0c, 0x00, 0x01,
-		0x0d, 0x03, 0x00, 0x19, 0x85, 0x04, 0x01, 0x39,
-		0xdc, 0xee, 0x44, 0x17, 0x5e, 0xdb, 0xd7, 0x27,
-		0xaf, 0xb6, 0x56, 0xd9, 0xb4, 0x43, 0x5a, 0x99,
-		0xcf, 0xaa, 0x31, 0x37, 0x0c, 0x6f, 0x3a, 0xa0,
-		0xf8, 0x53, 0xc4, 0x74, 0xd1, 0x91, 0x0a, 0x46,
-		0xf5, 0x38, 0x3b, 0x5c, 0x09, 0xd8, 0x97, 0xdc,
-		0x4b, 0xaa, 0x70, 0x26, 0x48, 0xf2, 0xd6, 0x0b,
-		0x31, 0xc9, 0xf8, 0xd4, 0x98, 0x43, 0xe1, 0x6c,
-		0xd5, 0xc7, 0xb2, 0x8e, 0x0b, 0x01, 0xe6, 0xb6,
-		0x00, 0x28, 0x80, 0x7b, 0xfc, 0x96, 0x8f, 0x0d,
-		0xa2, 0x4f, 0xb0, 0x79, 0xaf, 0xdc, 0x61, 0x28,
-		0x63, 0x33, 0x78, 0xf6, 0x31, 0x39, 0xfd, 0x8a,
-		0xf4, 0x15, 0x18, 0x11, 0xfe, 0xdb, 0xd5, 0x07,
-		0xda, 0x2c, 0xed, 0x49, 0xa0, 0x23, 0xbf, 0xd0,
-		0x3a, 0x38, 0x1d, 0x54, 0xae, 0x1c, 0x7b, 0xea,
-		0x29, 0xee, 0xd0, 0x38, 0xc1, 0x76, 0xa7, 0x7f,
-		0x2a, 0xf4, 0xce, 0x1e, 0xac, 0xcc, 0x94, 0x79,
-		0x90, 0x33, 0x04, 0x01, 0x00, 0x80, 0x0d, 0x8e,
-		0x79, 0xe6, 0x86, 0xf6, 0xb6, 0xfb, 0x6b, 0x6a,
-		0xcc, 0x55, 0xe4, 0x80, 0x4d, 0xc5, 0x0c, 0xc6,
-		0xa3, 0x9f, 0x1d, 0x39, 0xd2, 0x98, 0x57, 0x31,
-		0xa2, 0x90, 0x73, 0xe8, 0xd2, 0xcd, 0xb0, 0x93,
-		0x1a, 0x60, 0x0f, 0x38, 0x02, 0x3b, 0x1b, 0x25,
-		0x56, 0xec, 0x44, 0xab, 0xbe, 0x2e, 0x0c, 0xc0,
-		0x6e, 0x54, 0x91, 0x50, 0xd6, 0xb1, 0xa2, 0x98,
-		0x14, 0xa8, 0x35, 0x62, 0x9d, 0xca, 0xfb, 0x0f,
-		0x64, 0x2b, 0x05, 0xa0, 0xa0, 0x57, 0xef, 0xcd,
-		0x95, 0x45, 0x13, 0x5a, 0x9b, 0x3d, 0xdb, 0x42,
-		0x54, 0x7f, 0xb9, 0x17, 0x08, 0x7f, 0xb2, 0xf0,
-		0xb1, 0xc3, 0xdf, 0x67, 0x95, 0xe2, 0x73, 0xf2,
-		0x76, 0xa3, 0x97, 0xfd, 0x9c, 0x92, 0x4a, 0xdb,
-		0x95, 0x1e, 0x91, 0x95, 0xae, 0x3d, 0xae, 0x58,
-		0xb5, 0x03, 0x6f, 0x5c, 0x3a, 0x19, 0xab, 0x92,
-		0xa5, 0x09, 0x6b, 0x40, 0x61, 0xb0, 0x16, 0x03,
-		0x03, 0x00, 0x04, 0x0e, 0x00, 0x00, 0x00,
+func bigFromString(s string) *big.Int {
+	ret := new(big.Int)
+	ret.SetString(s, 10)
+	return ret
+}
+
+func fromHex(s string) []byte {
+	b, _ := hex.DecodeString(s)
+	return b
+}
+
+var testRSACertificate = fromHex("308202b030820219a00302010202090085b0bba48a7fb8ca300d06092a864886f70d01010505003045310b3009060355040613024155311330110603550408130a536f6d652d53746174653121301f060355040a1318496e7465726e6574205769646769747320507479204c7464301e170d3130303432343039303933385a170d3131303432343039303933385a3045310b3009060355040613024155311330110603550408130a536f6d652d53746174653121301f060355040a1318496e7465726e6574205769646769747320507479204c746430819f300d06092a864886f70d010101050003818d0030818902818100bb79d6f517b5e5bf4610d0dc69bee62b07435ad0032d8a7a4385b71452e7a5654c2c78b8238cb5b482e5de1f953b7e62a52ca533d6fe125c7a56fcf506bffa587b263fb5cd04d3d0c921964ac7f4549f5abfef427100fe1899077f7e887d7df10439c4a22edb51c97ce3c04c3b326601cfafb11db8719a1ddbdb896baeda2d790203010001a381a73081a4301d0603551d0e04160414b1ade2855acfcb28db69ce2369ded3268e18883930750603551d23046e306c8014b1ade2855acfcb28db69ce2369ded3268e188839a149a4473045310b3009060355040613024155311330110603550408130a536f6d652d53746174653121301f060355040a1318496e7465726e6574205769646769747320507479204c746482090085b0bba48a7fb8ca300c0603551d13040530030101ff300d06092a864886f70d010105050003818100086c4524c76bb159ab0c52ccf2b014d7879d7a6475b55a9566e4c52b8eae12661feb4f38b36e60d392fdf74108b52513b1187a24fb301dbaed98b917ece7d73159db95d31d78ea50565cd5825a2d5a5f33c4b6d8c97590968c0f5298b5cd981f89205ff2a01ca31b9694dda9fd57e970e8266d71999b266e3850296c90a7bdd9")
+
+var testECDSACertificate = fromHex("3082020030820162020900b8bf2d47a0d2ebf4300906072a8648ce3d04013045310b3009060355040613024155311330110603550408130a536f6d652d53746174653121301f060355040a1318496e7465726e6574205769646769747320507479204c7464301e170d3132313132323135303633325a170d3232313132303135303633325a3045310b3009060355040613024155311330110603550408130a536f6d652d53746174653121301f060355040a1318496e7465726e6574205769646769747320507479204c746430819b301006072a8648ce3d020106052b81040023038186000400c4a1edbe98f90b4873367ec316561122f23d53c33b4d213dcd6b75e6f6b0dc9adf26c1bcb287f072327cb3642f1c90bcea6823107efee325c0483a69e0286dd33700ef0462dd0da09c706283d881d36431aa9e9731bd96b068c09b23de76643f1a5c7fe9120e5858b65f70dd9bd8ead5d7f5d5ccb9b69f30665b669a20e227e5bffe3b300906072a8648ce3d040103818c0030818802420188a24febe245c5487d1bacf5ed989dae4770c05e1bb62fbdf1b64db76140d311a2ceee0b7e927eff769dc33b7ea53fcefa10e259ec472d7cacda4e970e15a06fd00242014dfcbe67139c2d050ebd3fa38c25c13313830d9406bbd4377af6ec7ac9862eddd711697f857c56defb31782be4c7780daecbbe9e4e3624317b6a0f399512078f2a")
+
+var testSNICertificate = fromHex("308201f23082015da003020102020100300b06092a864886f70d01010530283110300e060355040a130741636d6520436f311430120603550403130b736e69746573742e636f6d301e170d3132303431313137343033355a170d3133303431313137343533355a30283110300e060355040a130741636d6520436f311430120603550403130b736e69746573742e636f6d30819d300b06092a864886f70d01010103818d0030818902818100bb79d6f517b5e5bf4610d0dc69bee62b07435ad0032d8a7a4385b71452e7a5654c2c78b8238cb5b482e5de1f953b7e62a52ca533d6fe125c7a56fcf506bffa587b263fb5cd04d3d0c921964ac7f4549f5abfef427100fe1899077f7e887d7df10439c4a22edb51c97ce3c04c3b326601cfafb11db8719a1ddbdb896baeda2d790203010001a3323030300e0603551d0f0101ff0404030200a0300d0603551d0e0406040401020304300f0603551d2304083006800401020304300b06092a864886f70d0101050381810089c6455f1c1f5ef8eb1ab174ee2439059f5c4259bb1a8d86cdb1d056f56a717da40e95ab90f59e8deaf627c157995094db0802266eb34fc6842dea8a4b68d9c1389103ab84fb9e1f85d9b5d23ff2312c8670fbb540148245a4ebafe264d90c8a4cf4f85b0fac12ac2fc4a3154bad52462868af96c62c6525d652b6e31845bdcc")
+
+var testRSAPrivateKey = &rsa.PrivateKey{
+	PublicKey: rsa.PublicKey{
+		N: bigFromString("131650079503776001033793877885499001334664249354723305978524647182322416328664556247316495448366990052837680518067798333412266673813370895702118944398081598789828837447552603077848001020611640547221687072142537202428102790818451901395596882588063427854225330436740647715202971973145151161964464812406232198521"),
+		E: 65537,
 	},
-	{
-		0x16, 0x03, 0x03, 0x00, 0x8a, 0x10, 0x00, 0x00,
-		0x86, 0x85, 0x04, 0x01, 0xba, 0xb8, 0xad, 0x69,
-		0x20, 0x5e, 0xc1, 0x61, 0xc3, 0x0f, 0xb4, 0x30,
-		0x64, 0x66, 0x70, 0x96, 0x33, 0x3c, 0x8e, 0x12,
-		0x56, 0xbf, 0x6d, 0xb8, 0x6d, 0xc6, 0xba, 0xea,
-		0xfc, 0x38, 0xc0, 0x8b, 0x87, 0xa8, 0xf3, 0x87,
-		0xa1, 0xd5, 0xb6, 0xb0, 0x72, 0xc7, 0xd4, 0x19,
-		0x56, 0xa0, 0x91, 0xe1, 0x45, 0xc7, 0xf1, 0x7d,
-		0xb0, 0x1d, 0x78, 0x18, 0xf6, 0x3d, 0xbf, 0x1a,
-		0x23, 0x93, 0x0b, 0x19, 0xb1, 0x00, 0x56, 0xc9,
-		0x5e, 0x89, 0xd4, 0x9d, 0xd9, 0x5b, 0xe0, 0xb8,
-		0xff, 0x2f, 0x7d, 0x93, 0xae, 0x5b, 0xa5, 0x1f,
-		0x1f, 0x2b, 0x09, 0xe5, 0xf6, 0x07, 0x26, 0xa3,
-		0xed, 0xcb, 0x6a, 0x1a, 0xd6, 0x14, 0x83, 0x9b,
-		0xd3, 0x9d, 0x47, 0x1b, 0xf3, 0x72, 0x5f, 0x69,
-		0x21, 0x8f, 0xfa, 0x09, 0x38, 0x1a, 0x6b, 0x91,
-		0xcf, 0x19, 0x32, 0x54, 0x58, 0x8e, 0xee, 0xaf,
-		0xeb, 0x06, 0x9b, 0x3a, 0x34, 0x16, 0x66, 0x14,
-		0x03, 0x03, 0x00, 0x01, 0x01, 0x16, 0x03, 0x03,
-		0x00, 0x28, 0xc6, 0x96, 0x67, 0x62, 0xcc, 0x47,
-		0x01, 0xb5, 0xbd, 0xb7, 0x24, 0xd3, 0xb6, 0xfd,
-		0xb8, 0x46, 0xce, 0x82, 0x6d, 0x31, 0x1f, 0x15,
-		0x11, 0x8f, 0xed, 0x62, 0x71, 0x5f, 0xae, 0xb6,
-		0xa9, 0x0c, 0x24, 0x1d, 0xe8, 0x26, 0x51, 0xca,
-		0x7c, 0x42,
+	D: bigFromString("29354450337804273969007277378287027274721892607543397931919078829901848876371746653677097639302788129485893852488285045793268732234230875671682624082413996177431586734171663258657462237320300610850244186316880055243099640544518318093544057213190320837094958164973959123058337475052510833916491060913053867729"),
+	Primes: []*big.Int{
+		bigFromString("11969277782311800166562047708379380720136961987713178380670422671426759650127150688426177829077494755200794297055316163155755835813760102405344560929062149"),
+		bigFromString("10998999429884441391899182616418192492905073053684657075974935218461686523870125521822756579792315215543092255516093840728890783887287417039645833477273829"),
 	},
-	{
-		0x16, 0x03, 0x03, 0x00, 0x72, 0x04, 0x00, 0x00,
-		0x6e, 0x00, 0x00, 0x00, 0x00, 0x00, 0x68, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x65,
-		0xea, 0x8b, 0xfb, 0xef, 0xba, 0xc8, 0x88, 0x94,
-		0x44, 0x99, 0x5f, 0x02, 0x68, 0x3a, 0x12, 0x67,
-		0x7f, 0xb9, 0x39, 0x71, 0x84, 0xe0, 0x30, 0xe6,
-		0x90, 0x6c, 0xcf, 0x32, 0x29, 0x29, 0x5c, 0x5a,
-		0x8b, 0x7d, 0xaa, 0x11, 0x28, 0x26, 0xb5, 0xce,
-		0xd2, 0x88, 0xd5, 0xb0, 0x5f, 0x94, 0x37, 0xa2,
-		0x48, 0xd9, 0x53, 0xb2, 0xab, 0x59, 0x23, 0x3d,
-		0x81, 0x6e, 0x64, 0x89, 0xca, 0x1a, 0x84, 0x16,
-		0xdf, 0x31, 0x10, 0xde, 0x52, 0x7f, 0x50, 0xf3,
-		0xd9, 0x27, 0xa0, 0xe8, 0x34, 0x15, 0x9e, 0x11,
-		0xdd, 0xba, 0xce, 0x40, 0x17, 0xf3, 0x67, 0x14,
-		0x03, 0x03, 0x00, 0x01, 0x01, 0x16, 0x03, 0x03,
-		0x00, 0x28, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x00, 0x00, 0x35, 0xcb, 0x17, 0x66, 0xee, 0xfd,
-		0x27, 0xdb, 0xb8, 0xa8, 0x8a, 0xf1, 0x56, 0x67,
-		0x89, 0x0d, 0x13, 0xac, 0xe2, 0x31, 0xb9, 0xa2,
-		0x26, 0xbb, 0x1c, 0xcf, 0xd1, 0xb2, 0x48, 0x1d,
-		0x0d, 0xb1, 0x17, 0x03, 0x03, 0x00, 0x25, 0x00,
-		0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0xc0,
-		0x89, 0x7c, 0x58, 0x6a, 0x9b, 0x00, 0x05, 0x8c,
-		0x7f, 0x28, 0x54, 0x61, 0x44, 0x10, 0xee, 0x85,
-		0x26, 0xa8, 0x04, 0xcd, 0xca, 0x85, 0x60, 0xf2,
-		0xeb, 0x22, 0xbd, 0x9e, 0x15, 0x03, 0x03, 0x00,
-		0x1a, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00,
-		0x02, 0x10, 0xe4, 0xe5, 0xf9, 0x85, 0xe3, 0xb0,
-		0xec, 0x84, 0x29, 0x91, 0x05, 0x7d, 0x86, 0xe3,
-		0x97, 0xeb, 0xb2,
+}
+
+var testECDSAPrivateKey = &ecdsa.PrivateKey{
+	PublicKey: ecdsa.PublicKey{
+		Curve: elliptic.P521(),
+		X:     bigFromString("2636411247892461147287360222306590634450676461695221912739908880441342231985950069527906976759812296359387337367668045707086543273113073382714101597903639351"),
+		Y:     bigFromString("3204695818431246682253994090650952614555094516658732116404513121125038617915183037601737180082382202488628239201196033284060130040574800684774115478859677243"),
 	},
+	D: bigFromString("5477294338614160138026852784385529180817726002953041720191098180813046231640184669647735805135001309477695746518160084669446643325196003346204701381388769751"),
 }
diff --git a/src/pkg/crypto/tls/handshake_test.go b/src/pkg/crypto/tls/handshake_test.go
new file mode 100644
index 0000000000..f95f274ab4
--- /dev/null
+++ b/src/pkg/crypto/tls/handshake_test.go
@@ -0,0 +1,167 @@
+// Copyright 2013 The Go Authors. All rights reserved.
+// Use of this source code is governed by a BSD-style
+// license that can be found in the LICENSE file.
+
+package tls
+
+import (
+	"bufio"
+	"encoding/hex"
+	"errors"
+	"flag"
+	"fmt"
+	"io"
+	"io/ioutil"
+	"net"
+	"strconv"
+	"strings"
+	"sync"
+)
+
+// TLS reference tests run a connection against a reference implementation
+// (OpenSSL) of TLS and record the bytes of the resulting connection. The Go
+// code, during a test, is configured with deterministic randomness and so the
+// reference test can be reproduced exactly in the future.
+//
+// In order to save everyone who wishes to run the tests from needing the
+// reference implementation installed, the reference connections are saved in
+// files in the testdata directory. Thus running the tests involves nothing
+// external, but creating and updating them requires the reference
+// implementation.
+//
+// Tests can be updated by running them with the -update flag. This will cause
+// the test files. Generally one should combine the -update flag with -test.run
+// to updated a specific test. Since the reference implementation will always
+// generate fresh random numbers, large parts of the reference connection will
+// always change.
+
+var update = flag.Bool("update", false, "update golden files on disk")
+
+// recordingConn is a net.Conn that records the traffic that passes through it.
+// WriteTo can be used to produce output that can be later be loaded with
+// ParseTestData.
+type recordingConn struct {
+	net.Conn
+	sync.Mutex
+	flows   [][]byte
+	reading bool
+}
+
+func (r *recordingConn) Read(b []byte) (n int, err error) {
+	if n, err = r.Conn.Read(b); n == 0 {
+		return
+	}
+	b = b[:n]
+
+	r.Lock()
+	defer r.Unlock()
+
+	if l := len(r.flows); l == 0 || !r.reading {
+		buf := make([]byte, len(b))
+		copy(buf, b)
+		r.flows = append(r.flows, buf)
+	} else {
+		r.flows[l-1] = append(r.flows[l-1], b[:n]...)
+	}
+	r.reading = true
+	return
+}
+
+func (r *recordingConn) Write(b []byte) (n int, err error) {
+	if n, err = r.Conn.Write(b); n == 0 {
+		return
+	}
+	b = b[:n]
+
+	r.Lock()
+	defer r.Unlock()
+
+	if l := len(r.flows); l == 0 || r.reading {
+		buf := make([]byte, len(b))
+		copy(buf, b)
+		r.flows = append(r.flows, buf)
+	} else {
+		r.flows[l-1] = append(r.flows[l-1], b[:n]...)
+	}
+	r.reading = false
+	return
+}
+
+// WriteTo writes Go source code to w that contains the recorded traffic.
+func (r *recordingConn) WriteTo(w io.Writer) {
+	// TLS always starts with a client to server flow.
+	clientToServer := true
+
+	for i, flow := range r.flows {
+		source, dest := "client", "server"
+		if !clientToServer {
+			source, dest = dest, source
+		}
+		fmt.Fprintf(w, ">>> Flow %d (%s to %s)\n", i+1, source, dest)
+		dumper := hex.Dumper(w)
+		dumper.Write(flow)
+		dumper.Close()
+		clientToServer = !clientToServer
+	}
+}
+
+func parseTestData(r io.Reader) (flows [][]byte, err error) {
+	var currentFlow []byte
+
+	scanner := bufio.NewScanner(r)
+	for scanner.Scan() {
+		line := scanner.Text()
+		// If the line starts with ">>> " then it marks the beginning
+		// of a new flow.
+		if strings.HasPrefix(line, ">>> ") {
+			if len(currentFlow) > 0 || len(flows) > 0 {
+				flows = append(flows, currentFlow)
+				currentFlow = nil
+			}
+			continue
+		}
+
+		// Otherwise the line is a line of hex dump that looks like:
+		// 00000170  fc f5 06 bf (...)  |.....X{&?......!|
+		// (Some bytes have been omitted from the middle section.)
+
+		if i := strings.IndexByte(line, ' '); i >= 0 {
+			line = line[i:]
+		} else {
+			return nil, errors.New("invalid test data")
+		}
+
+		if i := strings.IndexByte(line, '|'); i >= 0 {
+			line = line[:i]
+		} else {
+			return nil, errors.New("invalid test data")
+		}
+
+		hexBytes := strings.Fields(line)
+		for _, hexByte := range hexBytes {
+			val, err := strconv.ParseUint(hexByte, 16, 8)
+			if err != nil {
+				return nil, errors.New("invalid hex byte in test data: " + err.Error())
+			}
+			currentFlow = append(currentFlow, byte(val))
+		}
+	}
+
+	if len(currentFlow) > 0 {
+		flows = append(flows, currentFlow)
+	}
+
+	return flows, nil
+}
+
+// tempFile creates a temp file containing contents and returns its path.
+func tempFile(contents string) string {
+	file, err := ioutil.TempFile("", "go-tls-test")
+	if err != nil {
+		panic("failed to create temp file: " + err.Error())
+	}
+	path := file.Name()
+	file.WriteString(contents)
+	file.Close()
+	return path
+}
diff --git a/src/pkg/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA b/src/pkg/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA
new file mode 100644
index 0000000000..990a8c6b2a
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA
@@ -0,0 +1,129 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 70 01 00 00  6c 03 03 00 00 00 00 00  |....p...l.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 1a c0 2f  |.............../|
+00000030  c0 2b c0 11 c0 07 c0 13  c0 09 c0 14 c0 0a 00 05  |.+..............|
+00000040  00 2f 00 35 c0 12 00 0a  01 00 00 29 00 05 00 05  |./.5.......)....|
+00000050  01 00 00 00 00 00 0a 00  08 00 06 00 17 00 18 00  |................|
+00000060  19 00 0b 00 02 01 00 00  0d 00 0a 00 08 04 01 04  |................|
+00000070  03 02 01 02 03                                    |.....|
+>>> Flow 2 (server to client)
+00000000  16 03 01 00 54 02 00 00  50 03 01 52 ac 77 f8 34  |....T...P..R.w.4|
+00000010  93 89 d0 c8 9e 83 58 9b  46 f1 4e 67 40 4c ea 67  |......X.F.Ng@L.g|
+00000020  6b 70 0e 24 0e 95 3e 49  96 56 7d 20 2e 80 c6 ef  |kp.$..>I.V} ....|
+00000030  c7 dc 41 e1 86 f4 7c d9  8a 01 b5 70 9e 02 20 6b  |..A...|....p.. k|
+00000040  bb 4a 4c 8f ed 79 dc 15  be 16 cb ef c0 09 00 00  |.JL..y..........|
+00000050  08 00 0b 00 04 03 00 01  02 16 03 01 02 0e 0b 00  |................|
+00000060  02 0a 00 02 07 00 02 04  30 82 02 00 30 82 01 62  |........0...0..b|
+00000070  02 09 00 b8 bf 2d 47 a0  d2 eb f4 30 09 06 07 2a  |.....-G....0...*|
+00000080  86 48 ce 3d 04 01 30 45  31 0b 30 09 06 03 55 04  |.H.=..0E1.0...U.|
+00000090  06 13 02 41 55 31 13 30  11 06 03 55 04 08 13 0a  |...AU1.0...U....|
+000000a0  53 6f 6d 65 2d 53 74 61  74 65 31 21 30 1f 06 03  |Some-State1!0...|
+000000b0  55 04 0a 13 18 49 6e 74  65 72 6e 65 74 20 57 69  |U....Internet Wi|
+000000c0  64 67 69 74 73 20 50 74  79 20 4c 74 64 30 1e 17  |dgits Pty Ltd0..|
+000000d0  0d 31 32 31 31 32 32 31  35 30 36 33 32 5a 17 0d  |.121122150632Z..|
+000000e0  32 32 31 31 32 30 31 35  30 36 33 32 5a 30 45 31  |221120150632Z0E1|
+000000f0  0b 30 09 06 03 55 04 06  13 02 41 55 31 13 30 11  |.0...U....AU1.0.|
+00000100  06 03 55 04 08 13 0a 53  6f 6d 65 2d 53 74 61 74  |..U....Some-Stat|
+00000110  65 31 21 30 1f 06 03 55  04 0a 13 18 49 6e 74 65  |e1!0...U....Inte|
+00000120  72 6e 65 74 20 57 69 64  67 69 74 73 20 50 74 79  |rnet Widgits Pty|
+00000130  20 4c 74 64 30 81 9b 30  10 06 07 2a 86 48 ce 3d  | Ltd0..0...*.H.=|
+00000140  02 01 06 05 2b 81 04 00  23 03 81 86 00 04 00 c4  |....+...#.......|
+00000150  a1 ed be 98 f9 0b 48 73  36 7e c3 16 56 11 22 f2  |......Hs6~..V.".|
+00000160  3d 53 c3 3b 4d 21 3d cd  6b 75 e6 f6 b0 dc 9a df  |=S.;M!=.ku......|
+00000170  26 c1 bc b2 87 f0 72 32  7c b3 64 2f 1c 90 bc ea  |&.....r2|.d/....|
+00000180  68 23 10 7e fe e3 25 c0  48 3a 69 e0 28 6d d3 37  |h#.~..%.H:i.(m.7|
+00000190  00 ef 04 62 dd 0d a0 9c  70 62 83 d8 81 d3 64 31  |...b....pb....d1|
+000001a0  aa 9e 97 31 bd 96 b0 68  c0 9b 23 de 76 64 3f 1a  |...1...h..#.vd?.|
+000001b0  5c 7f e9 12 0e 58 58 b6  5f 70 dd 9b d8 ea d5 d7  |\....XX._p......|
+000001c0  f5 d5 cc b9 b6 9f 30 66  5b 66 9a 20 e2 27 e5 bf  |......0f[f. .'..|
+000001d0  fe 3b 30 09 06 07 2a 86  48 ce 3d 04 01 03 81 8c  |.;0...*.H.=.....|
+000001e0  00 30 81 88 02 42 01 88  a2 4f eb e2 45 c5 48 7d  |.0...B...O..E.H}|
+000001f0  1b ac f5 ed 98 9d ae 47  70 c0 5e 1b b6 2f bd f1  |.......Gp.^../..|
+00000200  b6 4d b7 61 40 d3 11 a2  ce ee 0b 7e 92 7e ff 76  |.M.a@......~.~.v|
+00000210  9d c3 3b 7e a5 3f ce fa  10 e2 59 ec 47 2d 7c ac  |..;~.?....Y.G-|.|
+00000220  da 4e 97 0e 15 a0 6f d0  02 42 01 4d fc be 67 13  |.N....o..B.M..g.|
+00000230  9c 2d 05 0e bd 3f a3 8c  25 c1 33 13 83 0d 94 06  |.-...?..%.3.....|
+00000240  bb d4 37 7a f6 ec 7a c9  86 2e dd d7 11 69 7f 85  |..7z..z......i..|
+00000250  7c 56 de fb 31 78 2b e4  c7 78 0d ae cb be 9e 4e  ||V..1x+..x.....N|
+00000260  36 24 31 7b 6a 0f 39 95  12 07 8f 2a 16 03 01 00  |6$1{j.9....*....|
+00000270  d5 0c 00 00 d1 03 00 17  41 04 13 22 64 a7 fc 9c  |........A.."d...|
+00000280  f8 90 f2 4d 68 a1 cc b0  03 48 d7 e5 14 1e 3b e9  |...Mh....H....;.|
+00000290  d0 be 49 ee c7 b3 98 b5  b2 9c 52 d0 ab 28 b5 16  |..I.......R..(..|
+000002a0  ef 17 ee 7a 64 a3 81 8b  0e 3f 44 81 18 67 2c c1  |...zd....?D..g,.|
+000002b0  17 da be f4 59 bc 0e d8  c5 4f 00 8a 30 81 87 02  |....Y....O..0...|
+000002c0  41 0f be e7 a5 29 04 dc  89 b5 02 bd 59 8f c1 66  |A....)......Y..f|
+000002d0  47 1c c0 ad 25 52 22 91  fc 6a 17 37 cc b5 a7 42  |G...%R"..j.7...B|
+000002e0  06 36 44 7a 78 33 df 25  34 85 82 9b 9d ed 98 1c  |.6Dzx3.%4.......|
+000002f0  43 72 3e 79 61 0d ca 5f  a1 2e ff 47 bf ae 11 c6  |Cr>ya.._...G....|
+00000300  60 ec 02 42 00 de 6f 7b  44 78 f5 70 9c 95 f6 09  |`..B..o{Dx.p....|
+00000310  9f 84 f5 10 c8 f3 b2 ab  4c 67 07 c1 6f a2 94 18  |........Lg..o...|
+00000320  3b b0 6b d9 43 70 e3 d5  ef be 23 79 5f 84 33 20  |;.k.Cp....#y_.3 |
+00000330  0c c3 f6 cd d9 18 d3 0a  a5 e8 2e 27 69 07 47 72  |...........'i.Gr|
+00000340  d4 cd 38 3e 30 9e 16 03  01 00 0e 0d 00 00 06 03  |..8>0...........|
+00000350  01 02 40 00 00 0e 00 00  00                       |..@......|
+>>> Flow 3 (client to server)
+00000000  16 03 01 02 0a 0b 00 02  06 00 02 03 00 02 00 30  |...............0|
+00000010  82 01 fc 30 82 01 5e 02  09 00 9a 30 84 6c 26 35  |...0..^....0.l&5|
+00000020  d9 17 30 09 06 07 2a 86  48 ce 3d 04 01 30 45 31  |..0...*.H.=..0E1|
+00000030  0b 30 09 06 03 55 04 06  13 02 41 55 31 13 30 11  |.0...U....AU1.0.|
+00000040  06 03 55 04 08 13 0a 53  6f 6d 65 2d 53 74 61 74  |..U....Some-Stat|
+00000050  65 31 21 30 1f 06 03 55  04 0a 13 18 49 6e 74 65  |e1!0...U....Inte|
+00000060  72 6e 65 74 20 57 69 64  67 69 74 73 20 50 74 79  |rnet Widgits Pty|
+00000070  20 4c 74 64 30 1e 17 0d  31 32 31 31 31 34 31 33  | Ltd0...12111413|
+00000080  32 35 35 33 5a 17 0d 32  32 31 31 31 32 31 33 32  |2553Z..221112132|
+00000090  35 35 33 5a 30 41 31 0b  30 09 06 03 55 04 06 13  |553Z0A1.0...U...|
+000000a0  02 41 55 31 0c 30 0a 06  03 55 04 08 13 03 4e 53  |.AU1.0...U....NS|
+000000b0  57 31 10 30 0e 06 03 55  04 07 13 07 50 79 72 6d  |W1.0...U....Pyrm|
+000000c0  6f 6e 74 31 12 30 10 06  03 55 04 03 13 09 4a 6f  |ont1.0...U....Jo|
+000000d0  65 6c 20 53 69 6e 67 30  81 9b 30 10 06 07 2a 86  |el Sing0..0...*.|
+000000e0  48 ce 3d 02 01 06 05 2b  81 04 00 23 03 81 86 00  |H.=....+...#....|
+000000f0  04 00 95 8c 91 75 14 c0  5e c4 57 b4 d4 c3 6f 8d  |.....u..^.W...o.|
+00000100  ae 68 1e dd 6f ce 86 e1  7e 6e b2 48 3e 81 e5 4e  |.h..o...~n.H>..N|
+00000110  e2 c6 88 4b 64 dc f5 30  bb d3 ff 65 cc 5b f4 dd  |...Kd..0...e.[..|
+00000120  b5 6a 3e 3e d0 1d de 47  c3 76 ad 19 f6 45 2c 8c  |.j>>...G.v...E,.|
+00000130  bc d8 1d 01 4c 1f 70 90  46 76 48 8b 8f 83 cc 4a  |....L.p.FvH....J|
+00000140  5c 8f 40 76 da e0 89 ec  1d 2b c4 4e 30 76 28 41  |\.@v.....+.N0v(A|
+00000150  b2 62 a8 fb 5b f1 f9 4e  7a 8d bd 09 b8 ae ea 8b  |.b..[..Nz.......|
+00000160  18 27 4f 2e 70 fe 13 96  ba c3 d3 40 16 cd 65 4e  |.'O.p......@..eN|
+00000170  ac 11 1e e6 f1 30 09 06  07 2a 86 48 ce 3d 04 01  |.....0...*.H.=..|
+00000180  03 81 8c 00 30 81 88 02  42 00 e0 14 c4 60 60 0b  |....0...B....``.|
+00000190  72 68 b0 32 5d 61 4a 02  74 5c c2 81 b9 16 a8 3f  |rh.2]aJ.t\.....?|
+000001a0  29 c8 36 c7 81 ff 6c b6  5b d9 70 f1 38 3b 50 48  |).6...l.[.p.8;PH|
+000001b0  28 94 cb 09 1a 52 f1 5d  ee 8d f2 b9 f0 f0 da d9  |(....R.]........|
+000001c0  15 3a f9 bd 03 7a 87 a2  23 35 ec 02 42 01 a3 d4  |.:...z..#5..B...|
+000001d0  8a 78 35 1c 4a 9a 23 d2  0a be 2b 10 31 9d 9c 5f  |.x5.J.#...+.1.._|
+000001e0  be e8 91 b3 da 1a f5 5d  a3 23 f5 26 8b 45 70 8d  |.......].#.&.Ep.|
+000001f0  65 62 9b 7e 01 99 3d 18  f6 10 9a 38 61 9b 2e 57  |eb.~..=....8a..W|
+00000200  e4 fa cc b1 8a ce e2 23  a0 87 f0 e1 67 51 eb 16  |.......#....gQ..|
+00000210  03 01 00 46 10 00 00 42  41 04 1e 18 37 ef 0d 19  |...F...BA...7...|
+00000220  51 88 35 75 71 b5 e5 54  5b 12 2e 8f 09 67 fd a7  |Q.5uq..T[....g..|
+00000230  24 20 3e b2 56 1c ce 97  28 5e f8 2b 2d 4f 9e f1  |$ >.V...(^.+-O..|
+00000240  07 9f 6c 4b 5b 83 56 e2  32 42 e9 58 b6 d7 49 a6  |..lK[.V.2B.X..I.|
+00000250  b5 68 1a 41 03 56 6b dc  5a 89 16 03 01 00 90 0f  |.h.A.Vk.Z.......|
+00000260  00 00 8c 00 8a 30 81 87  02 42 00 c6 85 8e 06 b7  |.....0...B......|
+00000270  04 04 e9 cd 9e 3e cb 66  23 95 b4 42 9c 64 81 39  |.....>.f#..B.d.9|
+00000280  05 3f b5 21 f8 28 af 60  6b 4d 3d ba a1 4b 5e 77  |.?.!.(.`kM=..K^w|
+00000290  ef e7 59 28 fe 1d c1 27  a2 ff a8 de 33 48 b3 c1  |..Y(...'....3H..|
+000002a0  85 6a 42 9b f9 7e 7e 31  c2 e5 bd 66 02 41 4b 49  |.jB..~~1...f.AKI|
+000002b0  c6 cd 02 e3 83 f7 03 50  18 6d b4 c9 51 02 c0 ab  |.......P.m..Q...|
+000002c0  87 bc e0 3e 4b 89 53 3a  e2 65 89 97 02 c1 87 f1  |...>K.S:.e......|
+000002d0  67 d0 f2 06 28 4e 51 4e  fd f0 01 ee b8 6b e0 01  |g...(NQN.....k..|
+000002e0  1c 57 7e a8 fc 82 71 26  10 42 27 8c 5d c8 a9 14  |.W~...q&.B'.]...|
+000002f0  03 01 00 01 01 16 03 01  00 30 6e 6b 80 06 bb 98  |.........0nk....|
+00000300  c1 47 e3 92 1b 4d 98 4a  b4 3f 18 2e 73 a9 57 84  |.G...M.J.?..s.W.|
+00000310  92 b5 cb 45 db bb db 89  dd 10 04 7c 60 3e a0 d1  |...E.......|`>..|
+00000320  22 1d 7c 51 11 28 09 4a  26 f6                    |".|Q.(.J&.|
+>>> Flow 4 (server to client)
+00000000  14 03 01 00 01 01 16 03  01 00 30 05 ba 98 98 0f  |..........0.....|
+00000010  f9 f8 f4 4d 9a 29 99 ce  d7 d4 9a 4b d1 ed 54 d1  |...M.).....K..T.|
+00000020  a7 32 9a b8 ce 80 53 c4  50 61 83 37 35 c8 99 25  |.2....S.Pa.75..%|
+00000030  0b ac 66 91 62 ce 12 ba  cf dc 6f                 |..f.b.....o|
+>>> Flow 5 (client to server)
+00000000  17 03 01 00 20 7a 1e c3  4c 5f dd f1 14 f4 97 45  |.... z..L_.....E|
+00000010  21 4f 75 a5 a5 53 4a d7  91 a4 ad 1b cd 4b da 5a  |!Ou..SJ......K.Z|
+00000020  92 96 48 1f bc 17 03 01  00 20 a4 c9 d5 67 2f d9  |..H...... ...g/.|
+00000030  d2 ee e4 82 a5 ff 2d fa  41 8f 3d cc 3d ce 08 4a  |......-.A.=.=..J|
+00000040  39 7d 0c 6c 69 a4 71 e2  c0 98 15 03 01 00 20 19  |9}.li.q....... .|
+00000050  ae 20 b2 ff ce d4 71 37  ed 92 6a b3 3c 8d df 00  |. ....q7..j.<...|
+00000060  3b 69 5d f9 45 b1 8b 33  37 fe 52 d2 a1 56 01     |;i].E..37.R..V.|
diff --git a/src/pkg/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA b/src/pkg/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA
new file mode 100644
index 0000000000..2030e4b7f9
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA
@@ -0,0 +1,125 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 70 01 00 00  6c 03 03 00 00 00 00 00  |....p...l.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 1a c0 2f  |.............../|
+00000030  c0 2b c0 11 c0 07 c0 13  c0 09 c0 14 c0 0a 00 05  |.+..............|
+00000040  00 2f 00 35 c0 12 00 0a  01 00 00 29 00 05 00 05  |./.5.......)....|
+00000050  01 00 00 00 00 00 0a 00  08 00 06 00 17 00 18 00  |................|
+00000060  19 00 0b 00 02 01 00 00  0d 00 0a 00 08 04 01 04  |................|
+00000070  03 02 01 02 03                                    |.....|
+>>> Flow 2 (server to client)
+00000000  16 03 01 00 4a 02 00 00  46 03 01 52 ac 77 f8 32  |....J...F..R.w.2|
+00000010  42 f3 96 ae d6 f1 36 23  a4 c5 c0 ba 05 5a 67 bb  |B.....6#.....Zg.|
+00000020  12 5c 64 95 96 3d cc 0c  3a 85 38 20 13 48 bf 31  |.\d..=..:.8 .H.1|
+00000030  52 76 11 55 05 5d 24 5a  53 17 9e be d5 88 c1 d7  |Rv.U.]$ZS.......|
+00000040  88 35 b9 70 2b 66 46 35  a6 aa ff 8f 00 05 00 16  |.5.p+fF5........|
+00000050  03 01 02 be 0b 00 02 ba  00 02 b7 00 02 b4 30 82  |..............0.|
+00000060  02 b0 30 82 02 19 a0 03  02 01 02 02 09 00 85 b0  |..0.............|
+00000070  bb a4 8a 7f b8 ca 30 0d  06 09 2a 86 48 86 f7 0d  |......0...*.H...|
+00000080  01 01 05 05 00 30 45 31  0b 30 09 06 03 55 04 06  |.....0E1.0...U..|
+00000090  13 02 41 55 31 13 30 11  06 03 55 04 08 13 0a 53  |..AU1.0...U....S|
+000000a0  6f 6d 65 2d 53 74 61 74  65 31 21 30 1f 06 03 55  |ome-State1!0...U|
+000000b0  04 0a 13 18 49 6e 74 65  72 6e 65 74 20 57 69 64  |....Internet Wid|
+000000c0  67 69 74 73 20 50 74 79  20 4c 74 64 30 1e 17 0d  |gits Pty Ltd0...|
+000000d0  31 30 30 34 32 34 30 39  30 39 33 38 5a 17 0d 31  |100424090938Z..1|
+000000e0  31 30 34 32 34 30 39 30  39 33 38 5a 30 45 31 0b  |10424090938Z0E1.|
+000000f0  30 09 06 03 55 04 06 13  02 41 55 31 13 30 11 06  |0...U....AU1.0..|
+00000100  03 55 04 08 13 0a 53 6f  6d 65 2d 53 74 61 74 65  |.U....Some-State|
+00000110  31 21 30 1f 06 03 55 04  0a 13 18 49 6e 74 65 72  |1!0...U....Inter|
+00000120  6e 65 74 20 57 69 64 67  69 74 73 20 50 74 79 20  |net Widgits Pty |
+00000130  4c 74 64 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |Ltd0..0...*.H...|
+00000140  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+00000150  bb 79 d6 f5 17 b5 e5 bf  46 10 d0 dc 69 be e6 2b  |.y......F...i..+|
+00000160  07 43 5a d0 03 2d 8a 7a  43 85 b7 14 52 e7 a5 65  |.CZ..-.zC...R..e|
+00000170  4c 2c 78 b8 23 8c b5 b4  82 e5 de 1f 95 3b 7e 62  |L,x.#........;~b|
+00000180  a5 2c a5 33 d6 fe 12 5c  7a 56 fc f5 06 bf fa 58  |.,.3...\zV.....X|
+00000190  7b 26 3f b5 cd 04 d3 d0  c9 21 96 4a c7 f4 54 9f  |{&?......!.J..T.|
+000001a0  5a bf ef 42 71 00 fe 18  99 07 7f 7e 88 7d 7d f1  |Z..Bq......~.}}.|
+000001b0  04 39 c4 a2 2e db 51 c9  7c e3 c0 4c 3b 32 66 01  |.9....Q.|..L;2f.|
+000001c0  cf af b1 1d b8 71 9a 1d  db db 89 6b ae da 2d 79  |.....q.....k..-y|
+000001d0  02 03 01 00 01 a3 81 a7  30 81 a4 30 1d 06 03 55  |........0..0...U|
+000001e0  1d 0e 04 16 04 14 b1 ad  e2 85 5a cf cb 28 db 69  |..........Z..(.i|
+000001f0  ce 23 69 de d3 26 8e 18  88 39 30 75 06 03 55 1d  |.#i..&...90u..U.|
+00000200  23 04 6e 30 6c 80 14 b1  ad e2 85 5a cf cb 28 db  |#.n0l......Z..(.|
+00000210  69 ce 23 69 de d3 26 8e  18 88 39 a1 49 a4 47 30  |i.#i..&...9.I.G0|
+00000220  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+00000230  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+00000240  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+00000250  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+00000260  74 79 20 4c 74 64 82 09  00 85 b0 bb a4 8a 7f b8  |ty Ltd..........|
+00000270  ca 30 0c 06 03 55 1d 13  04 05 30 03 01 01 ff 30  |.0...U....0....0|
+00000280  0d 06 09 2a 86 48 86 f7  0d 01 01 05 05 00 03 81  |...*.H..........|
+00000290  81 00 08 6c 45 24 c7 6b  b1 59 ab 0c 52 cc f2 b0  |...lE$.k.Y..R...|
+000002a0  14 d7 87 9d 7a 64 75 b5  5a 95 66 e4 c5 2b 8e ae  |....zdu.Z.f..+..|
+000002b0  12 66 1f eb 4f 38 b3 6e  60 d3 92 fd f7 41 08 b5  |.f..O8.n`....A..|
+000002c0  25 13 b1 18 7a 24 fb 30  1d ba ed 98 b9 17 ec e7  |%...z$.0........|
+000002d0  d7 31 59 db 95 d3 1d 78  ea 50 56 5c d5 82 5a 2d  |.1Y....x.PV\..Z-|
+000002e0  5a 5f 33 c4 b6 d8 c9 75  90 96 8c 0f 52 98 b5 cd  |Z_3....u....R...|
+000002f0  98 1f 89 20 5f f2 a0 1c  a3 1b 96 94 dd a9 fd 57  |... _..........W|
+00000300  e9 70 e8 26 6d 71 99 9b  26 6e 38 50 29 6c 90 a7  |.p.&mq..&n8P)l..|
+00000310  bd d9 16 03 01 00 0e 0d  00 00 06 03 01 02 40 00  |..............@.|
+00000320  00 0e 00 00 00                                    |.....|
+>>> Flow 3 (client to server)
+00000000  16 03 01 02 0a 0b 00 02  06 00 02 03 00 02 00 30  |...............0|
+00000010  82 01 fc 30 82 01 5e 02  09 00 9a 30 84 6c 26 35  |...0..^....0.l&5|
+00000020  d9 17 30 09 06 07 2a 86  48 ce 3d 04 01 30 45 31  |..0...*.H.=..0E1|
+00000030  0b 30 09 06 03 55 04 06  13 02 41 55 31 13 30 11  |.0...U....AU1.0.|
+00000040  06 03 55 04 08 13 0a 53  6f 6d 65 2d 53 74 61 74  |..U....Some-Stat|
+00000050  65 31 21 30 1f 06 03 55  04 0a 13 18 49 6e 74 65  |e1!0...U....Inte|
+00000060  72 6e 65 74 20 57 69 64  67 69 74 73 20 50 74 79  |rnet Widgits Pty|
+00000070  20 4c 74 64 30 1e 17 0d  31 32 31 31 31 34 31 33  | Ltd0...12111413|
+00000080  32 35 35 33 5a 17 0d 32  32 31 31 31 32 31 33 32  |2553Z..221112132|
+00000090  35 35 33 5a 30 41 31 0b  30 09 06 03 55 04 06 13  |553Z0A1.0...U...|
+000000a0  02 41 55 31 0c 30 0a 06  03 55 04 08 13 03 4e 53  |.AU1.0...U....NS|
+000000b0  57 31 10 30 0e 06 03 55  04 07 13 07 50 79 72 6d  |W1.0...U....Pyrm|
+000000c0  6f 6e 74 31 12 30 10 06  03 55 04 03 13 09 4a 6f  |ont1.0...U....Jo|
+000000d0  65 6c 20 53 69 6e 67 30  81 9b 30 10 06 07 2a 86  |el Sing0..0...*.|
+000000e0  48 ce 3d 02 01 06 05 2b  81 04 00 23 03 81 86 00  |H.=....+...#....|
+000000f0  04 00 95 8c 91 75 14 c0  5e c4 57 b4 d4 c3 6f 8d  |.....u..^.W...o.|
+00000100  ae 68 1e dd 6f ce 86 e1  7e 6e b2 48 3e 81 e5 4e  |.h..o...~n.H>..N|
+00000110  e2 c6 88 4b 64 dc f5 30  bb d3 ff 65 cc 5b f4 dd  |...Kd..0...e.[..|
+00000120  b5 6a 3e 3e d0 1d de 47  c3 76 ad 19 f6 45 2c 8c  |.j>>...G.v...E,.|
+00000130  bc d8 1d 01 4c 1f 70 90  46 76 48 8b 8f 83 cc 4a  |....L.p.FvH....J|
+00000140  5c 8f 40 76 da e0 89 ec  1d 2b c4 4e 30 76 28 41  |\.@v.....+.N0v(A|
+00000150  b2 62 a8 fb 5b f1 f9 4e  7a 8d bd 09 b8 ae ea 8b  |.b..[..Nz.......|
+00000160  18 27 4f 2e 70 fe 13 96  ba c3 d3 40 16 cd 65 4e  |.'O.p......@..eN|
+00000170  ac 11 1e e6 f1 30 09 06  07 2a 86 48 ce 3d 04 01  |.....0...*.H.=..|
+00000180  03 81 8c 00 30 81 88 02  42 00 e0 14 c4 60 60 0b  |....0...B....``.|
+00000190  72 68 b0 32 5d 61 4a 02  74 5c c2 81 b9 16 a8 3f  |rh.2]aJ.t\.....?|
+000001a0  29 c8 36 c7 81 ff 6c b6  5b d9 70 f1 38 3b 50 48  |).6...l.[.p.8;PH|
+000001b0  28 94 cb 09 1a 52 f1 5d  ee 8d f2 b9 f0 f0 da d9  |(....R.]........|
+000001c0  15 3a f9 bd 03 7a 87 a2  23 35 ec 02 42 01 a3 d4  |.:...z..#5..B...|
+000001d0  8a 78 35 1c 4a 9a 23 d2  0a be 2b 10 31 9d 9c 5f  |.x5.J.#...+.1.._|
+000001e0  be e8 91 b3 da 1a f5 5d  a3 23 f5 26 8b 45 70 8d  |.......].#.&.Ep.|
+000001f0  65 62 9b 7e 01 99 3d 18  f6 10 9a 38 61 9b 2e 57  |eb.~..=....8a..W|
+00000200  e4 fa cc b1 8a ce e2 23  a0 87 f0 e1 67 51 eb 16  |.......#....gQ..|
+00000210  03 01 00 86 10 00 00 82  00 80 6d 51 f3 7f f9 3e  |..........mQ...>|
+00000220  fb 75 82 41 36 83 e8 6a  ee 2a 2e 25 90 67 4c 8e  |.u.A6..j.*.%.gL.|
+00000230  62 2f 30 81 17 e0 85 09  0c 2b b7 23 d7 b0 e2 1d  |b/0......+.#....|
+00000240  f7 3b d7 f5 a1 27 b6 ee  24 b6 1b cc 5b ea 66 0d  |.;...'..$...[.f.|
+00000250  6a f4 e5 85 f9 da 43 b4  0e 86 85 e1 f5 aa be c8  |j.....C.........|
+00000260  ce 39 4c 9c 86 00 08 c2  4b e2 c6 ec 2f f7 ce e6  |.9L.....K.../...|
+00000270  bd 77 82 6f 23 b6 e0 bd  a2 92 b7 3a ac e8 56 f1  |.w.o#......:..V.|
+00000280  af 54 5e 46 87 e9 3b 33  e7 b8 28 b7 d6 c8 90 35  |.T^F..;3..(....5|
+00000290  d4 1c 43 d1 30 6f 55 4e  0a 70 16 03 01 00 90 0f  |..C.0oUN.p......|
+000002a0  00 00 8c 00 8a 30 81 87  02 42 00 c6 85 8e 06 b7  |.....0...B......|
+000002b0  04 04 e9 cd 9e 3e cb 66  23 95 b4 42 9c 64 81 39  |.....>.f#..B.d.9|
+000002c0  05 3f b5 21 f8 28 af 60  6b 4d 3d ba a1 4b 5e 77  |.?.!.(.`kM=..K^w|
+000002d0  ef e7 59 28 fe 1d c1 27  a2 ff a8 de 33 48 b3 c1  |..Y(...'....3H..|
+000002e0  85 6a 42 9b f9 7e 7e 31  c2 e5 bd 66 02 41 4b 49  |.jB..~~1...f.AKI|
+000002f0  c6 cd 02 e3 83 f7 03 50  18 6d b4 c9 51 02 c0 ab  |.......P.m..Q...|
+00000300  87 bc e0 3e 4b 89 53 3a  e2 65 89 97 02 c1 87 f1  |...>K.S:.e......|
+00000310  67 d0 f2 06 28 4e 51 4e  fd f0 01 92 6d 54 ed 77  |g...(NQN....mT.w|
+00000320  96 b9 6c 79 66 fc c7 4e  db 53 7a 61 f3 31 9b 14  |..lyf..N.Sza.1..|
+00000330  03 01 00 01 01 16 03 01  00 24 4d cd f0 d5 d5 4c  |.........$M....L|
+00000340  2b 51 9f 88 04 10 65 c9  1c 92 26 d0 07 0a af 06  |+Q....e...&.....|
+00000350  bd 0a 2d 1e e6 dd 2a a5  3f c9 39 2d f8 0d        |..-...*.?.9-..|
+>>> Flow 4 (server to client)
+00000000  14 03 01 00 01 01 16 03  01 00 24 79 e0 a5 d6 1c  |..........$y....|
+00000010  2d c9 2f 3d 35 96 2f ce  97 9c 33 38 8b fc ba 02  |-./=5./...38....|
+00000020  6f 46 13 64 82 d5 ff 9d  16 9a ad 90 e3 ec 46     |oF.d..........F|
+>>> Flow 5 (client to server)
+00000000  17 03 01 00 1a 8b 3c 90  3e 94 ef fd 6e 32 42 fa  |......<.>...n2B.|
+00000010  70 0b d0 65 62 23 25 a4  0f b5 a7 9a 45 f0 52 15  |p..eb#%.....E.R.|
+00000020  03 01 00 16 74 72 64 8d  b8 41 13 07 49 7c d7 d0  |....trd..A..I|..|
+00000030  b6 c9 cf 33 20 69 5e f4  d2 a8                    |...3 i^...|
diff --git a/src/pkg/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA b/src/pkg/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA
new file mode 100644
index 0000000000..11fd37a9f6
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA
@@ -0,0 +1,128 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 70 01 00 00  6c 03 03 00 00 00 00 00  |....p...l.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 1a c0 2f  |.............../|
+00000030  c0 2b c0 11 c0 07 c0 13  c0 09 c0 14 c0 0a 00 05  |.+..............|
+00000040  00 2f 00 35 c0 12 00 0a  01 00 00 29 00 05 00 05  |./.5.......)....|
+00000050  01 00 00 00 00 00 0a 00  08 00 06 00 17 00 18 00  |................|
+00000060  19 00 0b 00 02 01 00 00  0d 00 0a 00 08 04 01 04  |................|
+00000070  03 02 01 02 03                                    |.....|
+>>> Flow 2 (server to client)
+00000000  16 03 01 00 54 02 00 00  50 03 01 52 ac 77 f7 ee  |....T...P..R.w..|
+00000010  90 30 d2 75 be d4 70 dd  2d 4f a7 9e 0f 6f 0b ac  |.0.u..p.-O...o..|
+00000020  bf 02 7d 53 1d 05 7f 93  9a c3 50 20 c8 18 17 c2  |..}S......P ....|
+00000030  70 76 8d a8 52 c8 b7 ff  32 35 cb bb 7e e0 4c 9c  |pv..R...25..~.L.|
+00000040  42 69 90 26 b5 c8 b7 22  da 52 db f9 c0 09 00 00  |Bi.&...".R......|
+00000050  08 00 0b 00 04 03 00 01  02 16 03 01 02 0e 0b 00  |................|
+00000060  02 0a 00 02 07 00 02 04  30 82 02 00 30 82 01 62  |........0...0..b|
+00000070  02 09 00 b8 bf 2d 47 a0  d2 eb f4 30 09 06 07 2a  |.....-G....0...*|
+00000080  86 48 ce 3d 04 01 30 45  31 0b 30 09 06 03 55 04  |.H.=..0E1.0...U.|
+00000090  06 13 02 41 55 31 13 30  11 06 03 55 04 08 13 0a  |...AU1.0...U....|
+000000a0  53 6f 6d 65 2d 53 74 61  74 65 31 21 30 1f 06 03  |Some-State1!0...|
+000000b0  55 04 0a 13 18 49 6e 74  65 72 6e 65 74 20 57 69  |U....Internet Wi|
+000000c0  64 67 69 74 73 20 50 74  79 20 4c 74 64 30 1e 17  |dgits Pty Ltd0..|
+000000d0  0d 31 32 31 31 32 32 31  35 30 36 33 32 5a 17 0d  |.121122150632Z..|
+000000e0  32 32 31 31 32 30 31 35  30 36 33 32 5a 30 45 31  |221120150632Z0E1|
+000000f0  0b 30 09 06 03 55 04 06  13 02 41 55 31 13 30 11  |.0...U....AU1.0.|
+00000100  06 03 55 04 08 13 0a 53  6f 6d 65 2d 53 74 61 74  |..U....Some-Stat|
+00000110  65 31 21 30 1f 06 03 55  04 0a 13 18 49 6e 74 65  |e1!0...U....Inte|
+00000120  72 6e 65 74 20 57 69 64  67 69 74 73 20 50 74 79  |rnet Widgits Pty|
+00000130  20 4c 74 64 30 81 9b 30  10 06 07 2a 86 48 ce 3d  | Ltd0..0...*.H.=|
+00000140  02 01 06 05 2b 81 04 00  23 03 81 86 00 04 00 c4  |....+...#.......|
+00000150  a1 ed be 98 f9 0b 48 73  36 7e c3 16 56 11 22 f2  |......Hs6~..V.".|
+00000160  3d 53 c3 3b 4d 21 3d cd  6b 75 e6 f6 b0 dc 9a df  |=S.;M!=.ku......|
+00000170  26 c1 bc b2 87 f0 72 32  7c b3 64 2f 1c 90 bc ea  |&.....r2|.d/....|
+00000180  68 23 10 7e fe e3 25 c0  48 3a 69 e0 28 6d d3 37  |h#.~..%.H:i.(m.7|
+00000190  00 ef 04 62 dd 0d a0 9c  70 62 83 d8 81 d3 64 31  |...b....pb....d1|
+000001a0  aa 9e 97 31 bd 96 b0 68  c0 9b 23 de 76 64 3f 1a  |...1...h..#.vd?.|
+000001b0  5c 7f e9 12 0e 58 58 b6  5f 70 dd 9b d8 ea d5 d7  |\....XX._p......|
+000001c0  f5 d5 cc b9 b6 9f 30 66  5b 66 9a 20 e2 27 e5 bf  |......0f[f. .'..|
+000001d0  fe 3b 30 09 06 07 2a 86  48 ce 3d 04 01 03 81 8c  |.;0...*.H.=.....|
+000001e0  00 30 81 88 02 42 01 88  a2 4f eb e2 45 c5 48 7d  |.0...B...O..E.H}|
+000001f0  1b ac f5 ed 98 9d ae 47  70 c0 5e 1b b6 2f bd f1  |.......Gp.^../..|
+00000200  b6 4d b7 61 40 d3 11 a2  ce ee 0b 7e 92 7e ff 76  |.M.a@......~.~.v|
+00000210  9d c3 3b 7e a5 3f ce fa  10 e2 59 ec 47 2d 7c ac  |..;~.?....Y.G-|.|
+00000220  da 4e 97 0e 15 a0 6f d0  02 42 01 4d fc be 67 13  |.N....o..B.M..g.|
+00000230  9c 2d 05 0e bd 3f a3 8c  25 c1 33 13 83 0d 94 06  |.-...?..%.3.....|
+00000240  bb d4 37 7a f6 ec 7a c9  86 2e dd d7 11 69 7f 85  |..7z..z......i..|
+00000250  7c 56 de fb 31 78 2b e4  c7 78 0d ae cb be 9e 4e  ||V..1x+..x.....N|
+00000260  36 24 31 7b 6a 0f 39 95  12 07 8f 2a 16 03 01 00  |6$1{j.9....*....|
+00000270  d6 0c 00 00 d2 03 00 17  41 04 14 a3 b3 8a d0 9a  |........A.......|
+00000280  93 50 4e 4c ad b1 61 10  09 96 cc 65 d0 85 02 17  |.PNL..a....e....|
+00000290  e6 12 56 e5 f3 6b 97 0e  4e 04 60 49 46 39 a9 a9  |..V..k..N.`IF9..|
+000002a0  70 20 fa 28 d7 91 01 24  3a 52 90 7d ac dc 1c 87  |p .(...$:R.}....|
+000002b0  fe 05 2a 23 ff d6 f7 84  ad 08 00 8b 30 81 88 02  |..*#........0...|
+000002c0  42 00 f0 df fd cb 17 ba  68 6e 1c b5 6c ee 29 68  |B.......hn..l.)h|
+000002d0  a4 a7 15 c8 88 cd 60 57  fd ec b3 53 31 6f 19 64  |......`W...S1o.d|
+000002e0  fd 91 c8 59 c3 19 d3 67  5d 38 26 07 c5 93 c1 92  |...Y...g]8&.....|
+000002f0  86 5b 89 99 01 24 db ab  d0 51 a3 6a 54 e8 7f bb  |.[...$...Q.jT...|
+00000300  de 9c 1c 02 42 01 7c d6  5f b8 f9 15 b4 a2 89 04  |....B.|._.......|
+00000310  46 36 2f a9 cc 5c 7c 78  24 17 fd 11 b8 3f 0b 4a  |F6/..\|x$....?.J|
+00000320  5e 4d 55 1a 65 b2 27 d8  51 97 6c d8 a7 b2 62 30  |^MU.e.'.Q.l...b0|
+00000330  01 3d b0 ef 27 fe f6 cd  40 0e 7b 54 c6 bc 38 b0  |.=..'...@.{T..8.|
+00000340  b1 b2 37 6c 87 ac d1 16  03 01 00 0e 0d 00 00 06  |..7l............|
+00000350  03 01 02 40 00 00 0e 00  00 00                    |...@......|
+>>> Flow 3 (client to server)
+00000000  16 03 01 01 fb 0b 00 01  f7 00 01 f4 00 01 f1 30  |...............0|
+00000010  82 01 ed 30 82 01 58 a0  03 02 01 02 02 01 00 30  |...0..X........0|
+00000020  0b 06 09 2a 86 48 86 f7  0d 01 01 05 30 26 31 10  |...*.H......0&1.|
+00000030  30 0e 06 03 55 04 0a 13  07 41 63 6d 65 20 43 6f  |0...U....Acme Co|
+00000040  31 12 30 10 06 03 55 04  03 13 09 31 32 37 2e 30  |1.0...U....127.0|
+00000050  2e 30 2e 31 30 1e 17 0d  31 31 31 32 30 38 30 37  |.0.10...11120807|
+00000060  35 35 31 32 5a 17 0d 31  32 31 32 30 37 30 38 30  |5512Z..121207080|
+00000070  30 31 32 5a 30 26 31 10  30 0e 06 03 55 04 0a 13  |012Z0&1.0...U...|
+00000080  07 41 63 6d 65 20 43 6f  31 12 30 10 06 03 55 04  |.Acme Co1.0...U.|
+00000090  03 13 09 31 32 37 2e 30  2e 30 2e 31 30 81 9c 30  |...127.0.0.10..0|
+000000a0  0b 06 09 2a 86 48 86 f7  0d 01 01 01 03 81 8c 00  |...*.H..........|
+000000b0  30 81 88 02 81 80 4e d0  7b 31 e3 82 64 d9 59 c0  |0.....N.{1..d.Y.|
+000000c0  c2 87 a4 5e 1e 8b 73 33  c7 63 53 df 66 92 06 84  |...^..s3.cS.f...|
+000000d0  f6 64 d5 8f e4 36 a7 1d  2b e8 b3 20 36 45 23 b5  |.d...6..+.. 6E#.|
+000000e0  e3 95 ae ed e0 f5 20 9c  8d 95 df 7f 5a 12 ef 87  |...... .....Z...|
+000000f0  e4 5b 68 e4 e9 0e 74 ec  04 8a 7f de 93 27 c4 01  |.[h...t......'..|
+00000100  19 7a bd f2 dc 3d 14 ab  d0 54 ca 21 0c d0 4d 6e  |.z...=...T.!..Mn|
+00000110  87 2e 5c c5 d2 bb 4d 4b  4f ce b6 2c f7 7e 88 ec  |..\...MKO..,.~..|
+00000120  7c d7 02 91 74 a6 1e 0c  1a da e3 4a 5a 2e de 13  ||...t......JZ...|
+00000130  9c 4c 40 88 59 93 02 03  01 00 01 a3 32 30 30 30  |.L@.Y.......2000|
+00000140  0e 06 03 55 1d 0f 01 01  ff 04 04 03 02 00 a0 30  |...U...........0|
+00000150  0d 06 03 55 1d 0e 04 06  04 04 01 02 03 04 30 0f  |...U..........0.|
+00000160  06 03 55 1d 23 04 08 30  06 80 04 01 02 03 04 30  |..U.#..0.......0|
+00000170  0b 06 09 2a 86 48 86 f7  0d 01 01 05 03 81 81 00  |...*.H..........|
+00000180  36 1f b3 7a 0c 75 c9 6e  37 46 61 2b d5 bd c0 a7  |6..z.u.n7Fa+....|
+00000190  4b cc 46 9a 81 58 7c 85  79 29 c8 c8 c6 67 dd 32  |K.F..X|.y)...g.2|
+000001a0  56 45 2b 75 b6 e9 24 a9  50 9a be 1f 5a fa 1a 15  |VE+u..$.P...Z...|
+000001b0  d9 cc 55 95 72 16 83 b9  c2 b6 8f fd 88 8c 38 84  |..U.r.........8.|
+000001c0  1d ab 5d 92 31 13 4f fd  83 3b c6 9d f1 11 62 b6  |..].1.O..;....b.|
+000001d0  8b ec ab 67 be c8 64 b0  11 50 46 58 17 6b 99 1c  |...g..d..PFX.k..|
+000001e0  d3 1d fc 06 f1 0e e5 96  a8 0c f9 78 20 b7 44 18  |...........x .D.|
+000001f0  51 8d 10 7e 4f 94 67 df  a3 4e 70 73 8e 90 91 85  |Q..~O.g..Nps....|
+00000200  16 03 01 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
+00000210  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
+00000220  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
+00000230  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
+00000240  a6 b5 68 1a 41 03 56 6b  dc 5a 89 16 03 01 00 86  |..h.A.Vk.Z......|
+00000250  0f 00 00 82 00 80 1b 62  58 10 7f d1 fb 94 fd 4e  |.......bX......N|
+00000260  29 d8 ce fb 46 c4 16 ce  32 a0 a6 40 10 a8 24 0c  |)...F...2..@..$.|
+00000270  c3 a2 50 34 2c 50 e4 b9  0f d8 2a d1 c6 d5 d9 ee  |..P4,P....*.....|
+00000280  66 38 dd 68 7d 9f a4 78  b7 9c e3 fb 29 d9 8d ff  |f8.h}..x....)...|
+00000290  0e b4 94 6e a9 58 a3 74  d7 b7 47 1a 0f 37 2b ab  |...n.X.t..G..7+.|
+000002a0  cc ee 90 36 58 72 2a cb  2a 0f 2f 1b a0 fa 43 18  |...6Xr*.*./...C.|
+000002b0  1f 4a 24 9a 67 55 11 e5  b9 f3 f0 d2 ff 66 26 dd  |.J$.gU.......f&.|
+000002c0  b9 d1 ab b3 35 52 95 98  dd 86 8a 1b f8 8e ba 7e  |....5R.........~|
+000002d0  10 07 0f a6 85 dc 14 03  01 00 01 01 16 03 01 00  |................|
+000002e0  30 c6 a2 49 6c 31 b1 a8  d2 9e 0c 96 b1 0b 0d 57  |0..Il1.........W|
+000002f0  8d f0 93 37 93 ea 06 b5  a7 d7 ba 3f 0e a2 f5 6a  |...7.......?...j|
+00000300  38 88 cc 53 66 18 61 a5  e1 79 99 59 0e 44 58 79  |8..Sf.a..y.Y.DXy|
+00000310  c7                                                |.|
+>>> Flow 4 (server to client)
+00000000  14 03 01 00 01 01 16 03  01 00 30 68 f5 47 9c 34  |..........0h.G.4|
+00000010  ba c1 96 05 d0 bd 77 e9  6c fb 88 c8 45 f5 fe 37  |......w.l...E..7|
+00000020  e2 6b b9 3c 95 36 bf cc  76 2b 1c 3e 1e 8f 63 e7  |.k.<.6..v+.>..c.|
+00000030  9b c2 84 fb 76 cf 97 a0  da 96 42                 |....v.....B|
+>>> Flow 5 (client to server)
+00000000  17 03 01 00 20 99 81 8e  c7 04 d1 03 0c 80 e2 44  |.... ..........D|
+00000010  14 7c 74 5a 85 36 55 f0  62 d5 36 d4 da 6f 43 98  |.|tZ.6U.b.6..oC.|
+00000020  36 7c 53 76 89 17 03 01  00 20 ec d3 7f fa 49 6c  |6|Sv..... ....Il|
+00000030  60 89 16 ee 6a 1f 69 4f  5a 88 0c 5c 89 a6 e0 3f  |`...j.iOZ..\...?|
+00000040  38 89 fa da 39 16 d2 9b  08 1f 15 03 01 00 20 64  |8...9......... d|
+00000050  a1 7a 98 b4 ff 54 a4 a0  e1 01 e4 0b 6c 67 80 b6  |.z...T......lg..|
+00000060  b6 76 90 e5 e5 cf 9b ca  fe 5c a3 4a 24 53 e4     |.v.......\.J$S.|
diff --git a/src/pkg/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA b/src/pkg/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA
new file mode 100644
index 0000000000..f689b8e41e
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA
@@ -0,0 +1,124 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 70 01 00 00  6c 03 03 00 00 00 00 00  |....p...l.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 1a c0 2f  |.............../|
+00000030  c0 2b c0 11 c0 07 c0 13  c0 09 c0 14 c0 0a 00 05  |.+..............|
+00000040  00 2f 00 35 c0 12 00 0a  01 00 00 29 00 05 00 05  |./.5.......)....|
+00000050  01 00 00 00 00 00 0a 00  08 00 06 00 17 00 18 00  |................|
+00000060  19 00 0b 00 02 01 00 00  0d 00 0a 00 08 04 01 04  |................|
+00000070  03 02 01 02 03                                    |.....|
+>>> Flow 2 (server to client)
+00000000  16 03 01 00 4a 02 00 00  46 03 01 52 ac 77 f7 f0  |....J...F..R.w..|
+00000010  99 da 46 81 2b c1 04 7a  9e 61 bf 0f 67 e3 40 ed  |..F.+..z.a..g.@.|
+00000020  9c 69 17 75 6f 64 63 14  4f 0f 99 20 06 c2 0e 89  |.i.uodc.O.. ....|
+00000030  2e 5a bb e6 ce e1 39 f6  11 53 a5 92 95 61 b4 e3  |.Z....9..S...a..|
+00000040  20 35 72 f8 e3 8d 19 6e  e3 5c a9 af 00 05 00 16  | 5r....n.\......|
+00000050  03 01 02 be 0b 00 02 ba  00 02 b7 00 02 b4 30 82  |..............0.|
+00000060  02 b0 30 82 02 19 a0 03  02 01 02 02 09 00 85 b0  |..0.............|
+00000070  bb a4 8a 7f b8 ca 30 0d  06 09 2a 86 48 86 f7 0d  |......0...*.H...|
+00000080  01 01 05 05 00 30 45 31  0b 30 09 06 03 55 04 06  |.....0E1.0...U..|
+00000090  13 02 41 55 31 13 30 11  06 03 55 04 08 13 0a 53  |..AU1.0...U....S|
+000000a0  6f 6d 65 2d 53 74 61 74  65 31 21 30 1f 06 03 55  |ome-State1!0...U|
+000000b0  04 0a 13 18 49 6e 74 65  72 6e 65 74 20 57 69 64  |....Internet Wid|
+000000c0  67 69 74 73 20 50 74 79  20 4c 74 64 30 1e 17 0d  |gits Pty Ltd0...|
+000000d0  31 30 30 34 32 34 30 39  30 39 33 38 5a 17 0d 31  |100424090938Z..1|
+000000e0  31 30 34 32 34 30 39 30  39 33 38 5a 30 45 31 0b  |10424090938Z0E1.|
+000000f0  30 09 06 03 55 04 06 13  02 41 55 31 13 30 11 06  |0...U....AU1.0..|
+00000100  03 55 04 08 13 0a 53 6f  6d 65 2d 53 74 61 74 65  |.U....Some-State|
+00000110  31 21 30 1f 06 03 55 04  0a 13 18 49 6e 74 65 72  |1!0...U....Inter|
+00000120  6e 65 74 20 57 69 64 67  69 74 73 20 50 74 79 20  |net Widgits Pty |
+00000130  4c 74 64 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |Ltd0..0...*.H...|
+00000140  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+00000150  bb 79 d6 f5 17 b5 e5 bf  46 10 d0 dc 69 be e6 2b  |.y......F...i..+|
+00000160  07 43 5a d0 03 2d 8a 7a  43 85 b7 14 52 e7 a5 65  |.CZ..-.zC...R..e|
+00000170  4c 2c 78 b8 23 8c b5 b4  82 e5 de 1f 95 3b 7e 62  |L,x.#........;~b|
+00000180  a5 2c a5 33 d6 fe 12 5c  7a 56 fc f5 06 bf fa 58  |.,.3...\zV.....X|
+00000190  7b 26 3f b5 cd 04 d3 d0  c9 21 96 4a c7 f4 54 9f  |{&?......!.J..T.|
+000001a0  5a bf ef 42 71 00 fe 18  99 07 7f 7e 88 7d 7d f1  |Z..Bq......~.}}.|
+000001b0  04 39 c4 a2 2e db 51 c9  7c e3 c0 4c 3b 32 66 01  |.9....Q.|..L;2f.|
+000001c0  cf af b1 1d b8 71 9a 1d  db db 89 6b ae da 2d 79  |.....q.....k..-y|
+000001d0  02 03 01 00 01 a3 81 a7  30 81 a4 30 1d 06 03 55  |........0..0...U|
+000001e0  1d 0e 04 16 04 14 b1 ad  e2 85 5a cf cb 28 db 69  |..........Z..(.i|
+000001f0  ce 23 69 de d3 26 8e 18  88 39 30 75 06 03 55 1d  |.#i..&...90u..U.|
+00000200  23 04 6e 30 6c 80 14 b1  ad e2 85 5a cf cb 28 db  |#.n0l......Z..(.|
+00000210  69 ce 23 69 de d3 26 8e  18 88 39 a1 49 a4 47 30  |i.#i..&...9.I.G0|
+00000220  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+00000230  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+00000240  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+00000250  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+00000260  74 79 20 4c 74 64 82 09  00 85 b0 bb a4 8a 7f b8  |ty Ltd..........|
+00000270  ca 30 0c 06 03 55 1d 13  04 05 30 03 01 01 ff 30  |.0...U....0....0|
+00000280  0d 06 09 2a 86 48 86 f7  0d 01 01 05 05 00 03 81  |...*.H..........|
+00000290  81 00 08 6c 45 24 c7 6b  b1 59 ab 0c 52 cc f2 b0  |...lE$.k.Y..R...|
+000002a0  14 d7 87 9d 7a 64 75 b5  5a 95 66 e4 c5 2b 8e ae  |....zdu.Z.f..+..|
+000002b0  12 66 1f eb 4f 38 b3 6e  60 d3 92 fd f7 41 08 b5  |.f..O8.n`....A..|
+000002c0  25 13 b1 18 7a 24 fb 30  1d ba ed 98 b9 17 ec e7  |%...z$.0........|
+000002d0  d7 31 59 db 95 d3 1d 78  ea 50 56 5c d5 82 5a 2d  |.1Y....x.PV\..Z-|
+000002e0  5a 5f 33 c4 b6 d8 c9 75  90 96 8c 0f 52 98 b5 cd  |Z_3....u....R...|
+000002f0  98 1f 89 20 5f f2 a0 1c  a3 1b 96 94 dd a9 fd 57  |... _..........W|
+00000300  e9 70 e8 26 6d 71 99 9b  26 6e 38 50 29 6c 90 a7  |.p.&mq..&n8P)l..|
+00000310  bd d9 16 03 01 00 0e 0d  00 00 06 03 01 02 40 00  |..............@.|
+00000320  00 0e 00 00 00                                    |.....|
+>>> Flow 3 (client to server)
+00000000  16 03 01 01 fb 0b 00 01  f7 00 01 f4 00 01 f1 30  |...............0|
+00000010  82 01 ed 30 82 01 58 a0  03 02 01 02 02 01 00 30  |...0..X........0|
+00000020  0b 06 09 2a 86 48 86 f7  0d 01 01 05 30 26 31 10  |...*.H......0&1.|
+00000030  30 0e 06 03 55 04 0a 13  07 41 63 6d 65 20 43 6f  |0...U....Acme Co|
+00000040  31 12 30 10 06 03 55 04  03 13 09 31 32 37 2e 30  |1.0...U....127.0|
+00000050  2e 30 2e 31 30 1e 17 0d  31 31 31 32 30 38 30 37  |.0.10...11120807|
+00000060  35 35 31 32 5a 17 0d 31  32 31 32 30 37 30 38 30  |5512Z..121207080|
+00000070  30 31 32 5a 30 26 31 10  30 0e 06 03 55 04 0a 13  |012Z0&1.0...U...|
+00000080  07 41 63 6d 65 20 43 6f  31 12 30 10 06 03 55 04  |.Acme Co1.0...U.|
+00000090  03 13 09 31 32 37 2e 30  2e 30 2e 31 30 81 9c 30  |...127.0.0.10..0|
+000000a0  0b 06 09 2a 86 48 86 f7  0d 01 01 01 03 81 8c 00  |...*.H..........|
+000000b0  30 81 88 02 81 80 4e d0  7b 31 e3 82 64 d9 59 c0  |0.....N.{1..d.Y.|
+000000c0  c2 87 a4 5e 1e 8b 73 33  c7 63 53 df 66 92 06 84  |...^..s3.cS.f...|
+000000d0  f6 64 d5 8f e4 36 a7 1d  2b e8 b3 20 36 45 23 b5  |.d...6..+.. 6E#.|
+000000e0  e3 95 ae ed e0 f5 20 9c  8d 95 df 7f 5a 12 ef 87  |...... .....Z...|
+000000f0  e4 5b 68 e4 e9 0e 74 ec  04 8a 7f de 93 27 c4 01  |.[h...t......'..|
+00000100  19 7a bd f2 dc 3d 14 ab  d0 54 ca 21 0c d0 4d 6e  |.z...=...T.!..Mn|
+00000110  87 2e 5c c5 d2 bb 4d 4b  4f ce b6 2c f7 7e 88 ec  |..\...MKO..,.~..|
+00000120  7c d7 02 91 74 a6 1e 0c  1a da e3 4a 5a 2e de 13  ||...t......JZ...|
+00000130  9c 4c 40 88 59 93 02 03  01 00 01 a3 32 30 30 30  |.L@.Y.......2000|
+00000140  0e 06 03 55 1d 0f 01 01  ff 04 04 03 02 00 a0 30  |...U...........0|
+00000150  0d 06 03 55 1d 0e 04 06  04 04 01 02 03 04 30 0f  |...U..........0.|
+00000160  06 03 55 1d 23 04 08 30  06 80 04 01 02 03 04 30  |..U.#..0.......0|
+00000170  0b 06 09 2a 86 48 86 f7  0d 01 01 05 03 81 81 00  |...*.H..........|
+00000180  36 1f b3 7a 0c 75 c9 6e  37 46 61 2b d5 bd c0 a7  |6..z.u.n7Fa+....|
+00000190  4b cc 46 9a 81 58 7c 85  79 29 c8 c8 c6 67 dd 32  |K.F..X|.y)...g.2|
+000001a0  56 45 2b 75 b6 e9 24 a9  50 9a be 1f 5a fa 1a 15  |VE+u..$.P...Z...|
+000001b0  d9 cc 55 95 72 16 83 b9  c2 b6 8f fd 88 8c 38 84  |..U.r.........8.|
+000001c0  1d ab 5d 92 31 13 4f fd  83 3b c6 9d f1 11 62 b6  |..].1.O..;....b.|
+000001d0  8b ec ab 67 be c8 64 b0  11 50 46 58 17 6b 99 1c  |...g..d..PFX.k..|
+000001e0  d3 1d fc 06 f1 0e e5 96  a8 0c f9 78 20 b7 44 18  |...........x .D.|
+000001f0  51 8d 10 7e 4f 94 67 df  a3 4e 70 73 8e 90 91 85  |Q..~O.g..Nps....|
+00000200  16 03 01 00 86 10 00 00  82 00 80 6d 51 f3 7f f9  |...........mQ...|
+00000210  3e fb 75 82 41 36 83 e8  6a ee 2a 2e 25 90 67 4c  |>.u.A6..j.*.%.gL|
+00000220  8e 62 2f 30 81 17 e0 85  09 0c 2b b7 23 d7 b0 e2  |.b/0......+.#...|
+00000230  1d f7 3b d7 f5 a1 27 b6  ee 24 b6 1b cc 5b ea 66  |..;...'..$...[.f|
+00000240  0d 6a f4 e5 85 f9 da 43  b4 0e 86 85 e1 f5 aa be  |.j.....C........|
+00000250  c8 ce 39 4c 9c 86 00 08  c2 4b e2 c6 ec 2f f7 ce  |..9L.....K.../..|
+00000260  e6 bd 77 82 6f 23 b6 e0  bd a2 92 b7 3a ac e8 56  |..w.o#......:..V|
+00000270  f1 af 54 5e 46 87 e9 3b  33 e7 b8 28 b7 d6 c8 90  |..T^F..;3..(....|
+00000280  35 d4 1c 43 d1 30 6f 55  4e 0a 70 16 03 01 00 86  |5..C.0oUN.p.....|
+00000290  0f 00 00 82 00 80 4d 9d  67 d8 0f e2 4e f4 bc eb  |......M.g...N...|
+000002a0  5f ad 77 c6 4d d4 2f 2c  77 dd a5 f7 4c 87 7e 99  |_.w.M./,w...L.~.|
+000002b0  86 70 f3 8a 9d b4 29 21  75 17 f1 cf 66 63 a1 76  |.p....)!u...fc.v|
+000002c0  3c 6c d7 3c 23 ee 35 1a  18 46 86 60 25 81 e3 25  |<l.<#.5..F.`%..%|
+000002d0  df ab 2c 28 26 53 a8 92  6c 35 5a 9a cc cb d5 43  |..,(&S..l5Z....C|
+000002e0  74 2f 6e a3 df d3 60 6a  97 97 71 ce 81 10 51 2d  |t/n...`j..q...Q-|
+000002f0  50 f7 8a b2 ff d2 56 ba  e3 e5 03 e9 99 79 9e b4  |P.....V......y..|
+00000300  a7 16 6e 08 98 1b f0 a5  d1 81 79 cc f4 48 34 58  |..n.......y..H4X|
+00000310  df 69 49 b5 77 81 14 03  01 00 01 01 16 03 01 00  |.iI.w...........|
+00000320  24 a2 58 ce 9a 68 34 da  df f7 21 41 da da 3d f1  |$.X..h4...!A..=.|
+00000330  a1 cf 87 9e 50 96 aa 3d  80 71 50 0f 30 56 75 fe  |....P..=.qP.0Vu.|
+00000340  97 48 66 de 13                                    |.Hf..|
+>>> Flow 4 (server to client)
+00000000  14 03 01 00 01 01 16 03  01 00 24 83 7b dc b5 11  |..........$.{...|
+00000010  28 12 6b d0 8a a3 dd f2  eb 29 cb fd 04 54 a1 31  |(.k......)...T.1|
+00000020  8c 08 40 c3 bd 21 3a 13  be 57 47 89 f3 26 30     |..@..!:..WG..&0|
+>>> Flow 5 (client to server)
+00000000  17 03 01 00 1a 52 d0 be  a9 8f fb 91 38 7b a4 82  |.....R......8{..|
+00000010  5d ff 93 61 f8 e9 80 b4  26 0e 21 42 2d 44 5a 15  |]..a....&.!B-DZ.|
+00000020  03 01 00 16 49 68 5c 35  7e 9d eb ed 16 a4 60 16  |....Ih\5~.....`.|
+00000030  fb 25 80 5c 15 9e 31 68  aa 5b                    |.%.\..1h.[|
diff --git a/src/pkg/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES b/src/pkg/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES
new file mode 100644
index 0000000000..f1e925d650
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES
@@ -0,0 +1,86 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 70 01 00 00  6c 03 03 00 00 00 00 00  |....p...l.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 1a c0 2f  |.............../|
+00000030  c0 2b c0 11 c0 07 c0 13  c0 09 c0 14 c0 0a 00 05  |.+..............|
+00000040  00 2f 00 35 c0 12 00 0a  01 00 00 29 00 05 00 05  |./.5.......)....|
+00000050  01 00 00 00 00 00 0a 00  08 00 06 00 17 00 18 00  |................|
+00000060  19 00 0b 00 02 01 00 00  0d 00 0a 00 08 04 01 04  |................|
+00000070  03 02 01 02 03                                    |.....|
+>>> Flow 2 (server to client)
+00000000  16 03 01 00 54 02 00 00  50 03 01 52 ac 77 f7 24  |....T...P..R.w.$|
+00000010  5b 96 60 d7 6a 2e 9f 05  ea 1e 61 15 64 16 ab a6  |[.`.j.....a.d...|
+00000020  a8 4e 72 f2 09 14 c2 fd  64 2d 22 20 e9 e3 04 64  |.Nr.....d-" ...d|
+00000030  7a 93 f1 de 0c d5 f9 5a  9a 5b d3 af 2b 03 84 bd  |z......Z.[..+...|
+00000040  69 71 dd 35 a7 ca 52 bf  90 a1 03 f0 c0 09 00 00  |iq.5..R.........|
+00000050  08 00 0b 00 04 03 00 01  02 16 03 01 02 0e 0b 00  |................|
+00000060  02 0a 00 02 07 00 02 04  30 82 02 00 30 82 01 62  |........0...0..b|
+00000070  02 09 00 b8 bf 2d 47 a0  d2 eb f4 30 09 06 07 2a  |.....-G....0...*|
+00000080  86 48 ce 3d 04 01 30 45  31 0b 30 09 06 03 55 04  |.H.=..0E1.0...U.|
+00000090  06 13 02 41 55 31 13 30  11 06 03 55 04 08 13 0a  |...AU1.0...U....|
+000000a0  53 6f 6d 65 2d 53 74 61  74 65 31 21 30 1f 06 03  |Some-State1!0...|
+000000b0  55 04 0a 13 18 49 6e 74  65 72 6e 65 74 20 57 69  |U....Internet Wi|
+000000c0  64 67 69 74 73 20 50 74  79 20 4c 74 64 30 1e 17  |dgits Pty Ltd0..|
+000000d0  0d 31 32 31 31 32 32 31  35 30 36 33 32 5a 17 0d  |.121122150632Z..|
+000000e0  32 32 31 31 32 30 31 35  30 36 33 32 5a 30 45 31  |221120150632Z0E1|
+000000f0  0b 30 09 06 03 55 04 06  13 02 41 55 31 13 30 11  |.0...U....AU1.0.|
+00000100  06 03 55 04 08 13 0a 53  6f 6d 65 2d 53 74 61 74  |..U....Some-Stat|
+00000110  65 31 21 30 1f 06 03 55  04 0a 13 18 49 6e 74 65  |e1!0...U....Inte|
+00000120  72 6e 65 74 20 57 69 64  67 69 74 73 20 50 74 79  |rnet Widgits Pty|
+00000130  20 4c 74 64 30 81 9b 30  10 06 07 2a 86 48 ce 3d  | Ltd0..0...*.H.=|
+00000140  02 01 06 05 2b 81 04 00  23 03 81 86 00 04 00 c4  |....+...#.......|
+00000150  a1 ed be 98 f9 0b 48 73  36 7e c3 16 56 11 22 f2  |......Hs6~..V.".|
+00000160  3d 53 c3 3b 4d 21 3d cd  6b 75 e6 f6 b0 dc 9a df  |=S.;M!=.ku......|
+00000170  26 c1 bc b2 87 f0 72 32  7c b3 64 2f 1c 90 bc ea  |&.....r2|.d/....|
+00000180  68 23 10 7e fe e3 25 c0  48 3a 69 e0 28 6d d3 37  |h#.~..%.H:i.(m.7|
+00000190  00 ef 04 62 dd 0d a0 9c  70 62 83 d8 81 d3 64 31  |...b....pb....d1|
+000001a0  aa 9e 97 31 bd 96 b0 68  c0 9b 23 de 76 64 3f 1a  |...1...h..#.vd?.|
+000001b0  5c 7f e9 12 0e 58 58 b6  5f 70 dd 9b d8 ea d5 d7  |\....XX._p......|
+000001c0  f5 d5 cc b9 b6 9f 30 66  5b 66 9a 20 e2 27 e5 bf  |......0f[f. .'..|
+000001d0  fe 3b 30 09 06 07 2a 86  48 ce 3d 04 01 03 81 8c  |.;0...*.H.=.....|
+000001e0  00 30 81 88 02 42 01 88  a2 4f eb e2 45 c5 48 7d  |.0...B...O..E.H}|
+000001f0  1b ac f5 ed 98 9d ae 47  70 c0 5e 1b b6 2f bd f1  |.......Gp.^../..|
+00000200  b6 4d b7 61 40 d3 11 a2  ce ee 0b 7e 92 7e ff 76  |.M.a@......~.~.v|
+00000210  9d c3 3b 7e a5 3f ce fa  10 e2 59 ec 47 2d 7c ac  |..;~.?....Y.G-|.|
+00000220  da 4e 97 0e 15 a0 6f d0  02 42 01 4d fc be 67 13  |.N....o..B.M..g.|
+00000230  9c 2d 05 0e bd 3f a3 8c  25 c1 33 13 83 0d 94 06  |.-...?..%.3.....|
+00000240  bb d4 37 7a f6 ec 7a c9  86 2e dd d7 11 69 7f 85  |..7z..z......i..|
+00000250  7c 56 de fb 31 78 2b e4  c7 78 0d ae cb be 9e 4e  ||V..1x+..x.....N|
+00000260  36 24 31 7b 6a 0f 39 95  12 07 8f 2a 16 03 01 00  |6$1{j.9....*....|
+00000270  d5 0c 00 00 d1 03 00 17  41 04 65 02 4b f2 bc 54  |........A.e.K..T|
+00000280  3d c2 42 3d 8d 06 b4 9a  7a 15 c8 04 0f 2b a0 f8  |=.B=....z....+..|
+00000290  ee e8 5d 52 10 c3 36 30  e0 cc 34 67 bb 83 29 ea  |..]R..60..4g..).|
+000002a0  d3 47 56 54 95 c5 29 25  53 d8 97 15 66 69 f2 cb  |.GVT..)%S...fi..|
+000002b0  59 05 97 f7 ac 66 27 d9  19 4a 00 8a 30 81 87 02  |Y....f'..J..0...|
+000002c0  41 6a 3c ca 93 ea 20 84  0e 04 2b 1b 52 28 32 29  |Aj<... ...+.R(2)|
+000002d0  af b9 8d fb 1c 5c c3 02  6b 45 02 c7 25 4e 19 51  |.....\..kE..%N.Q|
+000002e0  19 8b 3c 34 5d 20 b8 77  77 4a f1 b1 ba 47 03 14  |..<4] .wwJ...G..|
+000002f0  09 74 42 df 82 39 b0 51  54 ad e9 4d 1a 9d b9 18  |.tB..9.QT..M....|
+00000300  14 58 02 42 01 b8 18 1d  a1 53 a2 52 ad a3 13 85  |.X.B.....S.R....|
+00000310  f5 fb c4 75 0e 6b f1 f9  a6 7d 21 63 d0 fe 20 ba  |...u.k...}!c.. .|
+00000320  4b 38 3d 25 12 dc 73 5e  1d 5e 23 e5 52 ae cf 62  |K8=%..s^.^#.R..b|
+00000330  5a f4 a5 11 b7 33 1e 08  06 32 bb 7f 8d 40 db 5f  |Z....3...2...@._|
+00000340  f7 39 93 0e 32 9e 16 03  01 00 04 0e 00 00 00     |.9..2..........|
+>>> Flow 3 (client to server)
+00000000  16 03 01 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
+00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
+00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
+00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
+00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 01 00 01  |..h.A.Vk.Z......|
+00000050  01 16 03 01 00 30 6d 72  30 82 5b 76 0b bd a7 a2  |.....0mr0.[v....|
+00000060  ed 1e de bd 14 1d 25 69  97 4c ad 9c b1 50 8e 2f  |......%i.L...P./|
+00000070  a0 65 ac e7 52 e0 b4 fb  f9 8c e7 26 09 96 53 6f  |.e..R......&..So|
+00000080  bc 77 24 8c 1f a7                                 |.w$...|
+>>> Flow 4 (server to client)
+00000000  14 03 01 00 01 01 16 03  01 00 30 a0 97 45 7d 58  |..........0..E}X|
+00000010  2d 6e 6b 51 ad 5b 4f e0  f3 58 d3 48 a6 e1 b7 71  |-nkQ.[O..X.H...q|
+00000020  f8 94 e2 fe c5 c9 b2 0b  27 4f 48 11 df 01 5f ef  |........'OH..._.|
+00000030  5d 9c f5 85 91 39 75 f4  21 1b ed                 |]....9u.!..|
+>>> Flow 5 (client to server)
+00000000  17 03 01 00 20 31 c0 13  eb 77 e7 51 f6 14 fc bd  |.... 1...w.Q....|
+00000010  94 32 2c 31 58 28 72 29  a9 6a 11 56 f2 c1 de 96  |.2,1X(r).j.V....|
+00000020  e0 cd cf 4a 47 17 03 01  00 20 b2 95 e4 81 56 f3  |...JG.... ....V.|
+00000030  f8 6a b1 4f a0 41 41 fd  1f 7e b8 bb 7f 71 80 0d  |.j.O.AA..~...q..|
+00000040  22 9f 46 be cb b9 b6 bd  c0 0e 15 03 01 00 20 fa  |".F........... .|
+00000050  4e 05 c4 29 a5 92 4e 68  34 b7 5b 99 a8 b3 46 1b  |N..)..Nh4.[...F.|
+00000060  f9 f6 fc e5 b4 f4 cd c4  be 1a b2 af b7 13 43     |..............C|
diff --git a/src/pkg/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES b/src/pkg/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES
new file mode 100644
index 0000000000..f4904a3db6
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES
@@ -0,0 +1,97 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 70 01 00 00  6c 03 03 00 00 00 00 00  |....p...l.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 1a c0 2f  |.............../|
+00000030  c0 2b c0 11 c0 07 c0 13  c0 09 c0 14 c0 0a 00 05  |.+..............|
+00000040  00 2f 00 35 c0 12 00 0a  01 00 00 29 00 05 00 05  |./.5.......)....|
+00000050  01 00 00 00 00 00 0a 00  08 00 06 00 17 00 18 00  |................|
+00000060  19 00 0b 00 02 01 00 00  0d 00 0a 00 08 04 01 04  |................|
+00000070  03 02 01 02 03                                    |.....|
+>>> Flow 2 (server to client)
+00000000  16 03 01 00 54 02 00 00  50 03 01 52 ac 77 f7 b6  |....T...P..R.w..|
+00000010  40 88 14 a0 46 9b 24 3c  7c 8d cb 63 70 b3 fc 60  |@...F.$<|..cp..`|
+00000020  fb 04 97 82 c4 f6 d4 02  ab c6 5b 20 da cf c2 62  |..........[ ...b|
+00000030  87 5b 67 63 3a fa e1 f7  cd 64 d2 84 ee 95 bb 86  |.[gc:....d......|
+00000040  f5 c7 32 20 74 99 34 6c  ad 92 07 de c0 13 00 00  |..2 t.4l........|
+00000050  08 00 0b 00 04 03 00 01  02 16 03 01 02 be 0b 00  |................|
+00000060  02 ba 00 02 b7 00 02 b4  30 82 02 b0 30 82 02 19  |........0...0...|
+00000070  a0 03 02 01 02 02 09 00  85 b0 bb a4 8a 7f b8 ca  |................|
+00000080  30 0d 06 09 2a 86 48 86  f7 0d 01 01 05 05 00 30  |0...*.H........0|
+00000090  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+000000a0  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+000000b0  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+000000c0  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+000000d0  74 79 20 4c 74 64 30 1e  17 0d 31 30 30 34 32 34  |ty Ltd0...100424|
+000000e0  30 39 30 39 33 38 5a 17  0d 31 31 30 34 32 34 30  |090938Z..1104240|
+000000f0  39 30 39 33 38 5a 30 45  31 0b 30 09 06 03 55 04  |90938Z0E1.0...U.|
+00000100  06 13 02 41 55 31 13 30  11 06 03 55 04 08 13 0a  |...AU1.0...U....|
+00000110  53 6f 6d 65 2d 53 74 61  74 65 31 21 30 1f 06 03  |Some-State1!0...|
+00000120  55 04 0a 13 18 49 6e 74  65 72 6e 65 74 20 57 69  |U....Internet Wi|
+00000130  64 67 69 74 73 20 50 74  79 20 4c 74 64 30 81 9f  |dgits Pty Ltd0..|
+00000140  30 0d 06 09 2a 86 48 86  f7 0d 01 01 01 05 00 03  |0...*.H.........|
+00000150  81 8d 00 30 81 89 02 81  81 00 bb 79 d6 f5 17 b5  |...0.......y....|
+00000160  e5 bf 46 10 d0 dc 69 be  e6 2b 07 43 5a d0 03 2d  |..F...i..+.CZ..-|
+00000170  8a 7a 43 85 b7 14 52 e7  a5 65 4c 2c 78 b8 23 8c  |.zC...R..eL,x.#.|
+00000180  b5 b4 82 e5 de 1f 95 3b  7e 62 a5 2c a5 33 d6 fe  |.......;~b.,.3..|
+00000190  12 5c 7a 56 fc f5 06 bf  fa 58 7b 26 3f b5 cd 04  |.\zV.....X{&?...|
+000001a0  d3 d0 c9 21 96 4a c7 f4  54 9f 5a bf ef 42 71 00  |...!.J..T.Z..Bq.|
+000001b0  fe 18 99 07 7f 7e 88 7d  7d f1 04 39 c4 a2 2e db  |.....~.}}..9....|
+000001c0  51 c9 7c e3 c0 4c 3b 32  66 01 cf af b1 1d b8 71  |Q.|..L;2f......q|
+000001d0  9a 1d db db 89 6b ae da  2d 79 02 03 01 00 01 a3  |.....k..-y......|
+000001e0  81 a7 30 81 a4 30 1d 06  03 55 1d 0e 04 16 04 14  |..0..0...U......|
+000001f0  b1 ad e2 85 5a cf cb 28  db 69 ce 23 69 de d3 26  |....Z..(.i.#i..&|
+00000200  8e 18 88 39 30 75 06 03  55 1d 23 04 6e 30 6c 80  |...90u..U.#.n0l.|
+00000210  14 b1 ad e2 85 5a cf cb  28 db 69 ce 23 69 de d3  |.....Z..(.i.#i..|
+00000220  26 8e 18 88 39 a1 49 a4  47 30 45 31 0b 30 09 06  |&...9.I.G0E1.0..|
+00000230  03 55 04 06 13 02 41 55  31 13 30 11 06 03 55 04  |.U....AU1.0...U.|
+00000240  08 13 0a 53 6f 6d 65 2d  53 74 61 74 65 31 21 30  |...Some-State1!0|
+00000250  1f 06 03 55 04 0a 13 18  49 6e 74 65 72 6e 65 74  |...U....Internet|
+00000260  20 57 69 64 67 69 74 73  20 50 74 79 20 4c 74 64  | Widgits Pty Ltd|
+00000270  82 09 00 85 b0 bb a4 8a  7f b8 ca 30 0c 06 03 55  |...........0...U|
+00000280  1d 13 04 05 30 03 01 01  ff 30 0d 06 09 2a 86 48  |....0....0...*.H|
+00000290  86 f7 0d 01 01 05 05 00  03 81 81 00 08 6c 45 24  |.............lE$|
+000002a0  c7 6b b1 59 ab 0c 52 cc  f2 b0 14 d7 87 9d 7a 64  |.k.Y..R.......zd|
+000002b0  75 b5 5a 95 66 e4 c5 2b  8e ae 12 66 1f eb 4f 38  |u.Z.f..+...f..O8|
+000002c0  b3 6e 60 d3 92 fd f7 41  08 b5 25 13 b1 18 7a 24  |.n`....A..%...z$|
+000002d0  fb 30 1d ba ed 98 b9 17  ec e7 d7 31 59 db 95 d3  |.0.........1Y...|
+000002e0  1d 78 ea 50 56 5c d5 82  5a 2d 5a 5f 33 c4 b6 d8  |.x.PV\..Z-Z_3...|
+000002f0  c9 75 90 96 8c 0f 52 98  b5 cd 98 1f 89 20 5f f2  |.u....R...... _.|
+00000300  a0 1c a3 1b 96 94 dd a9  fd 57 e9 70 e8 26 6d 71  |.........W.p.&mq|
+00000310  99 9b 26 6e 38 50 29 6c  90 a7 bd d9 16 03 01 00  |..&n8P)l........|
+00000320  cb 0c 00 00 c7 03 00 17  41 04 eb a8 6e 0a 31 5e  |........A...n.1^|
+00000330  20 2a 31 db 85 82 43 e0  b6 ca a5 3c 1c e1 32 52  | *1...C....<..2R|
+00000340  e8 75 50 f2 e2 e0 de 30  06 3f e5 6d 8f d5 00 61  |.uP....0.?.m...a|
+00000350  22 8a bc e0 58 4a 37 3b  fd b7 67 2e c4 07 22 4c  |"...XJ7;..g..."L|
+00000360  ac 27 6d bb 10 b6 e3 6e  34 35 00 80 8c e7 14 84  |.'m....n45......|
+00000370  84 d0 ab f9 8f c7 ae 6d  34 c7 f8 9e e4 93 3e 67  |.......m4.....>g|
+00000380  be 03 7a 7a 5b 30 15 99  e2 e8 ff c1 28 af 40 9a  |..zz[0......(.@.|
+00000390  20 8c 11 e1 c7 12 fe bc  b5 12 51 f8 59 ed af a2  | .........Q.Y...|
+000003a0  78 d2 77 e2 bc 0e 97 0b  69 8f 98 40 04 6e 59 4e  |x.w.....i..@.nYN|
+000003b0  6d 50 c2 06 7e a6 74 27  97 a0 35 43 7d 9f 44 66  |mP..~.t'..5C}.Df|
+000003c0  17 91 fe 19 50 c2 d4 9a  f7 4f 0b 8a 40 c9 33 c8  |....P....O..@.3.|
+000003d0  a5 b0 0a d4 18 72 4a 1d  5d cd b3 9a 62 d9 1d 04  |.....rJ.]...b...|
+000003e0  d2 42 04 a1 27 5a 19 02  19 d9 cd ab 16 03 01 00  |.B..'Z..........|
+000003f0  04 0e 00 00 00                                    |.....|
+>>> Flow 3 (client to server)
+00000000  16 03 01 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
+00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
+00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
+00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
+00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 01 00 01  |..h.A.Vk.Z......|
+00000050  01 16 03 01 00 30 33 95  ec 63 ff 89 fe 3b f8 80  |.....03..c...;..|
+00000060  1b 05 c6 29 a4 72 78 af  04 c1 21 53 fd 02 28 36  |...).rx...!S..(6|
+00000070  29 b1 c7 a8 25 02 3d b0  ad 5b f3 52 9c a0 f5 8d  |)...%.=..[.R....|
+00000080  da 03 65 b6 ac 27                                 |..e..'|
+>>> Flow 4 (server to client)
+00000000  14 03 01 00 01 01 16 03  01 00 30 20 59 0a 77 5a  |..........0 Y.wZ|
+00000010  15 63 2b 9e f0 ff 27 ce  a8 57 89 e3 32 91 2d 5b  |.c+...'..W..2.-[|
+00000020  55 e1 c0 fd 50 69 c8 e1  d8 02 e3 3f d4 56 d7 b8  |U...Pi.....?.V..|
+00000030  80 5f 83 53 5e 2e 17 c3  41 72 bd                 |._.S^...Ar.|
+>>> Flow 5 (client to server)
+00000000  17 03 01 00 20 f5 42 0c  71 9c 27 35 6f 89 96 ca  |.... .B.q.'5o...|
+00000010  25 55 ce d3 81 3a 99 6e  c3 25 29 c6 71 05 f2 e2  |%U...:.n.%).q...|
+00000020  4d 21 6f d9 d6 17 03 01  00 20 a2 03 64 b9 0e e9  |M!o...... ..d...|
+00000030  cf 8e aa 15 f4 46 66 52  a6 c1 8b 00 3b 22 36 cc  |.....FfR....;"6.|
+00000040  34 b6 43 08 a5 73 eb 3f  1f e6 15 03 01 00 20 52  |4.C..s.?...... R|
+00000050  4d 42 9f 91 8e 0d d9 3f  ca 35 7f 47 af 30 14 5c  |MB.....?.5.G.0.\|
+00000060  10 6d de 84 84 36 2e f3  24 44 a3 5f 2b e4 7e     |.m...6..$D._+.~|
diff --git a/src/pkg/crypto/tls/testdata/Client-TLSv10-RSA-RC4 b/src/pkg/crypto/tls/testdata/Client-TLSv10-RSA-RC4
new file mode 100644
index 0000000000..a691255747
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Client-TLSv10-RSA-RC4
@@ -0,0 +1,82 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 70 01 00 00  6c 03 03 00 00 00 00 00  |....p...l.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 1a c0 2f  |.............../|
+00000030  c0 2b c0 11 c0 07 c0 13  c0 09 c0 14 c0 0a 00 05  |.+..............|
+00000040  00 2f 00 35 c0 12 00 0a  01 00 00 29 00 05 00 05  |./.5.......)....|
+00000050  01 00 00 00 00 00 0a 00  08 00 06 00 17 00 18 00  |................|
+00000060  19 00 0b 00 02 01 00 00  0d 00 0a 00 08 04 01 04  |................|
+00000070  03 02 01 02 03                                    |.....|
+>>> Flow 2 (server to client)
+00000000  16 03 01 00 4a 02 00 00  46 03 01 52 ac 77 f7 17  |....J...F..R.w..|
+00000010  4c 25 27 29 1a fe 71 9e  69 96 e9 a7 8a 5f dc 47  |L%')..q.i...._.G|
+00000020  b1 70 9a 23 e0 3a 32 95  4e 73 a4 20 b1 7a f0 69  |.p.#.:2.Ns. .z.i|
+00000030  f6 26 55 0b 6b 77 cc b6  f2 03 5b 6c 81 25 28 ea  |.&U.kw....[l.%(.|
+00000040  4b 2e ac 7a fe 54 62 bf  62 b4 0c e3 00 05 00 16  |K..z.Tb.b.......|
+00000050  03 01 02 be 0b 00 02 ba  00 02 b7 00 02 b4 30 82  |..............0.|
+00000060  02 b0 30 82 02 19 a0 03  02 01 02 02 09 00 85 b0  |..0.............|
+00000070  bb a4 8a 7f b8 ca 30 0d  06 09 2a 86 48 86 f7 0d  |......0...*.H...|
+00000080  01 01 05 05 00 30 45 31  0b 30 09 06 03 55 04 06  |.....0E1.0...U..|
+00000090  13 02 41 55 31 13 30 11  06 03 55 04 08 13 0a 53  |..AU1.0...U....S|
+000000a0  6f 6d 65 2d 53 74 61 74  65 31 21 30 1f 06 03 55  |ome-State1!0...U|
+000000b0  04 0a 13 18 49 6e 74 65  72 6e 65 74 20 57 69 64  |....Internet Wid|
+000000c0  67 69 74 73 20 50 74 79  20 4c 74 64 30 1e 17 0d  |gits Pty Ltd0...|
+000000d0  31 30 30 34 32 34 30 39  30 39 33 38 5a 17 0d 31  |100424090938Z..1|
+000000e0  31 30 34 32 34 30 39 30  39 33 38 5a 30 45 31 0b  |10424090938Z0E1.|
+000000f0  30 09 06 03 55 04 06 13  02 41 55 31 13 30 11 06  |0...U....AU1.0..|
+00000100  03 55 04 08 13 0a 53 6f  6d 65 2d 53 74 61 74 65  |.U....Some-State|
+00000110  31 21 30 1f 06 03 55 04  0a 13 18 49 6e 74 65 72  |1!0...U....Inter|
+00000120  6e 65 74 20 57 69 64 67  69 74 73 20 50 74 79 20  |net Widgits Pty |
+00000130  4c 74 64 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |Ltd0..0...*.H...|
+00000140  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+00000150  bb 79 d6 f5 17 b5 e5 bf  46 10 d0 dc 69 be e6 2b  |.y......F...i..+|
+00000160  07 43 5a d0 03 2d 8a 7a  43 85 b7 14 52 e7 a5 65  |.CZ..-.zC...R..e|
+00000170  4c 2c 78 b8 23 8c b5 b4  82 e5 de 1f 95 3b 7e 62  |L,x.#........;~b|
+00000180  a5 2c a5 33 d6 fe 12 5c  7a 56 fc f5 06 bf fa 58  |.,.3...\zV.....X|
+00000190  7b 26 3f b5 cd 04 d3 d0  c9 21 96 4a c7 f4 54 9f  |{&?......!.J..T.|
+000001a0  5a bf ef 42 71 00 fe 18  99 07 7f 7e 88 7d 7d f1  |Z..Bq......~.}}.|
+000001b0  04 39 c4 a2 2e db 51 c9  7c e3 c0 4c 3b 32 66 01  |.9....Q.|..L;2f.|
+000001c0  cf af b1 1d b8 71 9a 1d  db db 89 6b ae da 2d 79  |.....q.....k..-y|
+000001d0  02 03 01 00 01 a3 81 a7  30 81 a4 30 1d 06 03 55  |........0..0...U|
+000001e0  1d 0e 04 16 04 14 b1 ad  e2 85 5a cf cb 28 db 69  |..........Z..(.i|
+000001f0  ce 23 69 de d3 26 8e 18  88 39 30 75 06 03 55 1d  |.#i..&...90u..U.|
+00000200  23 04 6e 30 6c 80 14 b1  ad e2 85 5a cf cb 28 db  |#.n0l......Z..(.|
+00000210  69 ce 23 69 de d3 26 8e  18 88 39 a1 49 a4 47 30  |i.#i..&...9.I.G0|
+00000220  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+00000230  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+00000240  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+00000250  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+00000260  74 79 20 4c 74 64 82 09  00 85 b0 bb a4 8a 7f b8  |ty Ltd..........|
+00000270  ca 30 0c 06 03 55 1d 13  04 05 30 03 01 01 ff 30  |.0...U....0....0|
+00000280  0d 06 09 2a 86 48 86 f7  0d 01 01 05 05 00 03 81  |...*.H..........|
+00000290  81 00 08 6c 45 24 c7 6b  b1 59 ab 0c 52 cc f2 b0  |...lE$.k.Y..R...|
+000002a0  14 d7 87 9d 7a 64 75 b5  5a 95 66 e4 c5 2b 8e ae  |....zdu.Z.f..+..|
+000002b0  12 66 1f eb 4f 38 b3 6e  60 d3 92 fd f7 41 08 b5  |.f..O8.n`....A..|
+000002c0  25 13 b1 18 7a 24 fb 30  1d ba ed 98 b9 17 ec e7  |%...z$.0........|
+000002d0  d7 31 59 db 95 d3 1d 78  ea 50 56 5c d5 82 5a 2d  |.1Y....x.PV\..Z-|
+000002e0  5a 5f 33 c4 b6 d8 c9 75  90 96 8c 0f 52 98 b5 cd  |Z_3....u....R...|
+000002f0  98 1f 89 20 5f f2 a0 1c  a3 1b 96 94 dd a9 fd 57  |... _..........W|
+00000300  e9 70 e8 26 6d 71 99 9b  26 6e 38 50 29 6c 90 a7  |.p.&mq..&n8P)l..|
+00000310  bd d9 16 03 01 00 04 0e  00 00 00                 |...........|
+>>> Flow 3 (client to server)
+00000000  16 03 01 00 86 10 00 00  82 00 80 6d 51 f3 7f f9  |...........mQ...|
+00000010  3e fb 75 82 41 36 83 e8  6a ee 2a 2e 25 90 67 4c  |>.u.A6..j.*.%.gL|
+00000020  8e 62 2f 30 81 17 e0 85  09 0c 2b b7 23 d7 b0 e2  |.b/0......+.#...|
+00000030  1d f7 3b d7 f5 a1 27 b6  ee 24 b6 1b cc 5b ea 66  |..;...'..$...[.f|
+00000040  0d 6a f4 e5 85 f9 da 43  b4 0e 86 85 e1 f5 aa be  |.j.....C........|
+00000050  c8 ce 39 4c 9c 86 00 08  c2 4b e2 c6 ec 2f f7 ce  |..9L.....K.../..|
+00000060  e6 bd 77 82 6f 23 b6 e0  bd a2 92 b7 3a ac e8 56  |..w.o#......:..V|
+00000070  f1 af 54 5e 46 87 e9 3b  33 e7 b8 28 b7 d6 c8 90  |..T^F..;3..(....|
+00000080  35 d4 1c 43 d1 30 6f 55  4e 0a 70 14 03 01 00 01  |5..C.0oUN.p.....|
+00000090  01 16 03 01 00 24 8f 42  2e 1a 6f 42 a2 d1 51 ae  |.....$.B..oB..Q.|
+000000a0  68 c4 3c 76 d0 df c3 41  3e 79 88 1a 43 28 bf 08  |h.<v...A>y..C(..|
+000000b0  ad 4e e2 1c f1 7f 87 3d  9d ba                    |.N.....=..|
+>>> Flow 4 (server to client)
+00000000  14 03 01 00 01 01 16 03  01 00 24 19 91 48 bb ae  |..........$..H..|
+00000010  63 9d 91 d8 2f 8b 97 00  b4 ae 79 06 88 a8 23 a0  |c.../.....y...#.|
+00000020  2d f4 dc 0f d9 6e c9 24  61 dd 3f 54 ec 9b 2f     |-....n.$a.?T../|
+>>> Flow 5 (client to server)
+00000000  17 03 01 00 1a 80 15 48  e1 1a 02 3e 0f 11 0a 8b  |.......H...>....|
+00000010  ff 31 28 5f 7c 1e af fb  c7 c2 1f 8b fc 0f 12 15  |.1(_|...........|
+00000020  03 01 00 16 67 d2 c4 57  fd e1 55 9f 51 0d ff 89  |....g..W..U.Q...|
+00000030  09 17 87 2c 6c d4 96 9d  d9 86                    |...,l.....|
diff --git a/src/pkg/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES b/src/pkg/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES
new file mode 100644
index 0000000000..0c0474d470
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES
@@ -0,0 +1,88 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 70 01 00 00  6c 03 03 00 00 00 00 00  |....p...l.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 1a c0 2f  |.............../|
+00000030  c0 2b c0 11 c0 07 c0 13  c0 09 c0 14 c0 0a 00 05  |.+..............|
+00000040  00 2f 00 35 c0 12 00 0a  01 00 00 29 00 05 00 05  |./.5.......)....|
+00000050  01 00 00 00 00 00 0a 00  08 00 06 00 17 00 18 00  |................|
+00000060  19 00 0b 00 02 01 00 00  0d 00 0a 00 08 04 01 04  |................|
+00000070  03 02 01 02 03                                    |.....|
+>>> Flow 2 (server to client)
+00000000  16 03 02 00 54 02 00 00  50 03 02 52 ac 77 f7 1a  |....T...P..R.w..|
+00000010  64 f7 56 af 0c d1 f7 5c  35 fb 48 6a b7 29 65 d6  |d.V....\5.Hj.)e.|
+00000020  3c b0 76 37 16 02 3c ed  25 24 d5 20 29 00 2f 99  |<.v7..<.%$. )./.|
+00000030  d5 2b 2e 59 f5 59 c6 ca  04 57 a9 5c ec ee f7 38  |.+.Y.Y...W.\...8|
+00000040  c9 0d 3b 6b e9 01 8b bd  5a e5 0d 68 c0 09 00 00  |..;k....Z..h....|
+00000050  08 00 0b 00 04 03 00 01  02 16 03 02 02 0e 0b 00  |................|
+00000060  02 0a 00 02 07 00 02 04  30 82 02 00 30 82 01 62  |........0...0..b|
+00000070  02 09 00 b8 bf 2d 47 a0  d2 eb f4 30 09 06 07 2a  |.....-G....0...*|
+00000080  86 48 ce 3d 04 01 30 45  31 0b 30 09 06 03 55 04  |.H.=..0E1.0...U.|
+00000090  06 13 02 41 55 31 13 30  11 06 03 55 04 08 13 0a  |...AU1.0...U....|
+000000a0  53 6f 6d 65 2d 53 74 61  74 65 31 21 30 1f 06 03  |Some-State1!0...|
+000000b0  55 04 0a 13 18 49 6e 74  65 72 6e 65 74 20 57 69  |U....Internet Wi|
+000000c0  64 67 69 74 73 20 50 74  79 20 4c 74 64 30 1e 17  |dgits Pty Ltd0..|
+000000d0  0d 31 32 31 31 32 32 31  35 30 36 33 32 5a 17 0d  |.121122150632Z..|
+000000e0  32 32 31 31 32 30 31 35  30 36 33 32 5a 30 45 31  |221120150632Z0E1|
+000000f0  0b 30 09 06 03 55 04 06  13 02 41 55 31 13 30 11  |.0...U....AU1.0.|
+00000100  06 03 55 04 08 13 0a 53  6f 6d 65 2d 53 74 61 74  |..U....Some-Stat|
+00000110  65 31 21 30 1f 06 03 55  04 0a 13 18 49 6e 74 65  |e1!0...U....Inte|
+00000120  72 6e 65 74 20 57 69 64  67 69 74 73 20 50 74 79  |rnet Widgits Pty|
+00000130  20 4c 74 64 30 81 9b 30  10 06 07 2a 86 48 ce 3d  | Ltd0..0...*.H.=|
+00000140  02 01 06 05 2b 81 04 00  23 03 81 86 00 04 00 c4  |....+...#.......|
+00000150  a1 ed be 98 f9 0b 48 73  36 7e c3 16 56 11 22 f2  |......Hs6~..V.".|
+00000160  3d 53 c3 3b 4d 21 3d cd  6b 75 e6 f6 b0 dc 9a df  |=S.;M!=.ku......|
+00000170  26 c1 bc b2 87 f0 72 32  7c b3 64 2f 1c 90 bc ea  |&.....r2|.d/....|
+00000180  68 23 10 7e fe e3 25 c0  48 3a 69 e0 28 6d d3 37  |h#.~..%.H:i.(m.7|
+00000190  00 ef 04 62 dd 0d a0 9c  70 62 83 d8 81 d3 64 31  |...b....pb....d1|
+000001a0  aa 9e 97 31 bd 96 b0 68  c0 9b 23 de 76 64 3f 1a  |...1...h..#.vd?.|
+000001b0  5c 7f e9 12 0e 58 58 b6  5f 70 dd 9b d8 ea d5 d7  |\....XX._p......|
+000001c0  f5 d5 cc b9 b6 9f 30 66  5b 66 9a 20 e2 27 e5 bf  |......0f[f. .'..|
+000001d0  fe 3b 30 09 06 07 2a 86  48 ce 3d 04 01 03 81 8c  |.;0...*.H.=.....|
+000001e0  00 30 81 88 02 42 01 88  a2 4f eb e2 45 c5 48 7d  |.0...B...O..E.H}|
+000001f0  1b ac f5 ed 98 9d ae 47  70 c0 5e 1b b6 2f bd f1  |.......Gp.^../..|
+00000200  b6 4d b7 61 40 d3 11 a2  ce ee 0b 7e 92 7e ff 76  |.M.a@......~.~.v|
+00000210  9d c3 3b 7e a5 3f ce fa  10 e2 59 ec 47 2d 7c ac  |..;~.?....Y.G-|.|
+00000220  da 4e 97 0e 15 a0 6f d0  02 42 01 4d fc be 67 13  |.N....o..B.M..g.|
+00000230  9c 2d 05 0e bd 3f a3 8c  25 c1 33 13 83 0d 94 06  |.-...?..%.3.....|
+00000240  bb d4 37 7a f6 ec 7a c9  86 2e dd d7 11 69 7f 85  |..7z..z......i..|
+00000250  7c 56 de fb 31 78 2b e4  c7 78 0d ae cb be 9e 4e  ||V..1x+..x.....N|
+00000260  36 24 31 7b 6a 0f 39 95  12 07 8f 2a 16 03 02 00  |6$1{j.9....*....|
+00000270  d5 0c 00 00 d1 03 00 17  41 04 6f c1 70 ca c9 46  |........A.o.p..F|
+00000280  2c 5e 69 58 33 1f 6f d6  aa 87 b7 bb d5 66 42 e9  |,^iX3.o......fB.|
+00000290  34 2e 37 d1 0b 04 11 14  ce 57 f4 00 6c ec 47 31  |4.7......W..l.G1|
+000002a0  e4 5a 38 25 50 51 f7 3a  22 b0 9f 7c 4d 81 f9 9a  |.Z8%PQ.:"..|M...|
+000002b0  b3 c9 fd 4e f4 20 62 0b  73 ce 00 8a 30 81 87 02  |...N. b.s...0...|
+000002c0  41 4d ee 15 33 7a 88 5f  20 15 e8 76 1f c9 0f 16  |AM..3z._ ..v....|
+000002d0  64 8c e1 d6 97 45 6a 56  1f 75 1b 41 6a ca de 86  |d....EjV.u.Aj...|
+000002e0  3e de 50 49 e7 21 ac f9  09 14 ca 96 c7 e6 23 ba  |>.PI.!........#.|
+000002f0  32 8d d4 22 b7 02 0b 40  77 cc 3f 19 50 9e a1 72  |2.."...@w.?.P..r|
+00000300  b8 8d 02 42 01 2c d4 47  4c 0b 20 3a 14 dd 11 ed  |...B.,.GL. :....|
+00000310  90 ed 83 ff 94 62 ec 88  d9 11 fd 2d 0c b0 01 b7  |.....b.....-....|
+00000320  0c 47 0b a2 1f 7f 73 5a  77 7d 76 27 8b 8c ca 29  |.G....sZw}v'...)|
+00000330  b5 b8 fb 22 79 25 4b dd  0a a1 39 c9 81 c7 2b 24  |..."y%K...9...+$|
+00000340  c9 5c b5 31 17 95 16 03  02 00 04 0e 00 00 00     |.\.1...........|
+>>> Flow 3 (client to server)
+00000000  16 03 02 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
+00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
+00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
+00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
+00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 02 00 01  |..h.A.Vk.Z......|
+00000050  01 16 03 02 00 40 00 00  00 00 00 00 00 00 00 00  |.....@..........|
+00000060  00 00 00 00 00 00 8d 08  b9 eb b8 28 6a 9b b0 fb  |...........(j...|
+00000070  c3 79 06 07 ed b2 e5 56  5e 80 5d 0a 12 3b 50 b7  |.y.....V^.]..;P.|
+00000080  eb a0 6c eb aa d2 16 02  86 a8 76 13 23 65 ce ff  |..l.......v.#e..|
+00000090  57 52 7c 30 f2 a0                                 |WR|0..|
+>>> Flow 4 (server to client)
+00000000  14 03 02 00 01 01 16 03  02 00 40 8f b3 15 b3 54  |..........@....T|
+00000010  3b e9 7e c5 ec b7 df 4b  ae e4 d7 0f e5 4a d5 8e  |;.~....K.....J..|
+00000020  1c 94 f8 19 d9 a7 f3 5d  8b 18 6b 1f e8 a2 94 e4  |.......]..k.....|
+00000030  f9 31 ed ab 38 3b 25 22  12 61 d6 c9 c7 76 6d 82  |.1..8;%".a...vm.|
+00000040  ac 16 02 89 73 4f 02 98  e2 95 0f                 |....sO.....|
+>>> Flow 5 (client to server)
+00000000  17 03 02 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
+00000010  00 00 00 00 00 f3 c1 b3  fb 58 f0 ce 01 e4 23 4f  |.........X....#O|
+00000020  de d9 81 9b d8 80 66 7a  fb 7b 45 1b a8 ac a0 f5  |......fz.{E.....|
+00000030  0b b4 92 74 e9 15 03 02  00 30 00 00 00 00 00 00  |...t.....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 0b 89 72 90 d6 30  |............r..0|
+00000050  1c fb 6d ab 68 79 48 6d  2a 32 1a 4f b7 45 0b 08  |..m.hyHm*2.O.E..|
+00000060  11 dd 52 66 76 65 fc 02  e1 7e                    |..Rfve...~|
diff --git a/src/pkg/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES b/src/pkg/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES
new file mode 100644
index 0000000000..9a6de9ffcc
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES
@@ -0,0 +1,99 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 70 01 00 00  6c 03 03 00 00 00 00 00  |....p...l.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 1a c0 2f  |.............../|
+00000030  c0 2b c0 11 c0 07 c0 13  c0 09 c0 14 c0 0a 00 05  |.+..............|
+00000040  00 2f 00 35 c0 12 00 0a  01 00 00 29 00 05 00 05  |./.5.......)....|
+00000050  01 00 00 00 00 00 0a 00  08 00 06 00 17 00 18 00  |................|
+00000060  19 00 0b 00 02 01 00 00  0d 00 0a 00 08 04 01 04  |................|
+00000070  03 02 01 02 03                                    |.....|
+>>> Flow 2 (server to client)
+00000000  16 03 02 00 54 02 00 00  50 03 02 52 ac 77 f7 e5  |....T...P..R.w..|
+00000010  29 8d 77 7e b2 af b8 50  dd 1f d4 2d 86 c1 bd c6  |).w~...P...-....|
+00000020  13 77 41 6c a1 2a 68 20  80 ce 0f 20 b4 52 61 8d  |.wAl.*h ... .Ra.|
+00000030  44 36 59 2b fa 58 be 5f  fa 69 f9 cd cf 4b 6f 9e  |D6Y+.X._.i...Ko.|
+00000040  dd 2f bf 58 e1 5f 11 5f  fa 24 75 38 c0 13 00 00  |./.X._._.$u8....|
+00000050  08 00 0b 00 04 03 00 01  02 16 03 02 02 be 0b 00  |................|
+00000060  02 ba 00 02 b7 00 02 b4  30 82 02 b0 30 82 02 19  |........0...0...|
+00000070  a0 03 02 01 02 02 09 00  85 b0 bb a4 8a 7f b8 ca  |................|
+00000080  30 0d 06 09 2a 86 48 86  f7 0d 01 01 05 05 00 30  |0...*.H........0|
+00000090  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+000000a0  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+000000b0  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+000000c0  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+000000d0  74 79 20 4c 74 64 30 1e  17 0d 31 30 30 34 32 34  |ty Ltd0...100424|
+000000e0  30 39 30 39 33 38 5a 17  0d 31 31 30 34 32 34 30  |090938Z..1104240|
+000000f0  39 30 39 33 38 5a 30 45  31 0b 30 09 06 03 55 04  |90938Z0E1.0...U.|
+00000100  06 13 02 41 55 31 13 30  11 06 03 55 04 08 13 0a  |...AU1.0...U....|
+00000110  53 6f 6d 65 2d 53 74 61  74 65 31 21 30 1f 06 03  |Some-State1!0...|
+00000120  55 04 0a 13 18 49 6e 74  65 72 6e 65 74 20 57 69  |U....Internet Wi|
+00000130  64 67 69 74 73 20 50 74  79 20 4c 74 64 30 81 9f  |dgits Pty Ltd0..|
+00000140  30 0d 06 09 2a 86 48 86  f7 0d 01 01 01 05 00 03  |0...*.H.........|
+00000150  81 8d 00 30 81 89 02 81  81 00 bb 79 d6 f5 17 b5  |...0.......y....|
+00000160  e5 bf 46 10 d0 dc 69 be  e6 2b 07 43 5a d0 03 2d  |..F...i..+.CZ..-|
+00000170  8a 7a 43 85 b7 14 52 e7  a5 65 4c 2c 78 b8 23 8c  |.zC...R..eL,x.#.|
+00000180  b5 b4 82 e5 de 1f 95 3b  7e 62 a5 2c a5 33 d6 fe  |.......;~b.,.3..|
+00000190  12 5c 7a 56 fc f5 06 bf  fa 58 7b 26 3f b5 cd 04  |.\zV.....X{&?...|
+000001a0  d3 d0 c9 21 96 4a c7 f4  54 9f 5a bf ef 42 71 00  |...!.J..T.Z..Bq.|
+000001b0  fe 18 99 07 7f 7e 88 7d  7d f1 04 39 c4 a2 2e db  |.....~.}}..9....|
+000001c0  51 c9 7c e3 c0 4c 3b 32  66 01 cf af b1 1d b8 71  |Q.|..L;2f......q|
+000001d0  9a 1d db db 89 6b ae da  2d 79 02 03 01 00 01 a3  |.....k..-y......|
+000001e0  81 a7 30 81 a4 30 1d 06  03 55 1d 0e 04 16 04 14  |..0..0...U......|
+000001f0  b1 ad e2 85 5a cf cb 28  db 69 ce 23 69 de d3 26  |....Z..(.i.#i..&|
+00000200  8e 18 88 39 30 75 06 03  55 1d 23 04 6e 30 6c 80  |...90u..U.#.n0l.|
+00000210  14 b1 ad e2 85 5a cf cb  28 db 69 ce 23 69 de d3  |.....Z..(.i.#i..|
+00000220  26 8e 18 88 39 a1 49 a4  47 30 45 31 0b 30 09 06  |&...9.I.G0E1.0..|
+00000230  03 55 04 06 13 02 41 55  31 13 30 11 06 03 55 04  |.U....AU1.0...U.|
+00000240  08 13 0a 53 6f 6d 65 2d  53 74 61 74 65 31 21 30  |...Some-State1!0|
+00000250  1f 06 03 55 04 0a 13 18  49 6e 74 65 72 6e 65 74  |...U....Internet|
+00000260  20 57 69 64 67 69 74 73  20 50 74 79 20 4c 74 64  | Widgits Pty Ltd|
+00000270  82 09 00 85 b0 bb a4 8a  7f b8 ca 30 0c 06 03 55  |...........0...U|
+00000280  1d 13 04 05 30 03 01 01  ff 30 0d 06 09 2a 86 48  |....0....0...*.H|
+00000290  86 f7 0d 01 01 05 05 00  03 81 81 00 08 6c 45 24  |.............lE$|
+000002a0  c7 6b b1 59 ab 0c 52 cc  f2 b0 14 d7 87 9d 7a 64  |.k.Y..R.......zd|
+000002b0  75 b5 5a 95 66 e4 c5 2b  8e ae 12 66 1f eb 4f 38  |u.Z.f..+...f..O8|
+000002c0  b3 6e 60 d3 92 fd f7 41  08 b5 25 13 b1 18 7a 24  |.n`....A..%...z$|
+000002d0  fb 30 1d ba ed 98 b9 17  ec e7 d7 31 59 db 95 d3  |.0.........1Y...|
+000002e0  1d 78 ea 50 56 5c d5 82  5a 2d 5a 5f 33 c4 b6 d8  |.x.PV\..Z-Z_3...|
+000002f0  c9 75 90 96 8c 0f 52 98  b5 cd 98 1f 89 20 5f f2  |.u....R...... _.|
+00000300  a0 1c a3 1b 96 94 dd a9  fd 57 e9 70 e8 26 6d 71  |.........W.p.&mq|
+00000310  99 9b 26 6e 38 50 29 6c  90 a7 bd d9 16 03 02 00  |..&n8P)l........|
+00000320  cb 0c 00 00 c7 03 00 17  41 04 f2 1f af 58 08 d7  |........A....X..|
+00000330  4e ac d4 ee 2b 56 df 11  96 c8 01 d8 c8 0c 97 95  |N...+V..........|
+00000340  3c 34 1c 24 8b e9 a0 92  1a 74 71 9c ee 56 ec 0f  |<4.$.....tq..V..|
+00000350  b5 c6 3b 3c f1 a2 4d 52  11 f1 e3 3b 43 f8 fc 43  |..;<..MR...;C..C|
+00000360  83 67 7d 62 c7 56 0c 38  01 5c 00 80 83 5f df 3b  |.g}b.V.8.\..._.;|
+00000370  fe 4f 90 30 c6 c3 c7 16  df 7b 58 dc 5a c1 68 e6  |.O.0.....{X.Z.h.|
+00000380  18 7f 5e 4c 0f ae d2 f0  81 2c 48 a9 c4 7b 05 f6  |..^L.....,H..{..|
+00000390  e0 9e 17 95 dd fe a3 53  32 57 12 f4 96 55 94 ff  |.......S2W...U..|
+000003a0  0a ee cf 95 85 43 7c 75  fc f3 13 5e e0 cf c2 ff  |.....C|u...^....|
+000003b0  56 c6 2b 60 09 b3 32 b2  1a 93 49 2e f0 b6 5c 2f  |V.+`..2...I...\/|
+000003c0  5a 45 c9 da 8c ee 26 72  ca 9e b4 63 13 a8 7d 60  |ZE....&r...c..}`|
+000003d0  54 dd 17 70 40 60 15 e1  85 d5 64 02 83 e2 b3 e9  |T..p@`....d.....|
+000003e0  b3 de 84 6e 9d 62 18 48  99 66 cd 63 16 03 02 00  |...n.b.H.f.c....|
+000003f0  04 0e 00 00 00                                    |.....|
+>>> Flow 3 (client to server)
+00000000  16 03 02 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
+00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
+00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
+00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
+00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 02 00 01  |..h.A.Vk.Z......|
+00000050  01 16 03 02 00 40 00 00  00 00 00 00 00 00 00 00  |.....@..........|
+00000060  00 00 00 00 00 00 a4 c5  6a e0 d6 3d 47 a8 17 8f  |........j..=G...|
+00000070  5e 21 57 ac d5 0a 7c f7  fb df 33 e2 68 c4 46 82  |^!W...|...3.h.F.|
+00000080  b4 48 d2 d3 f5 79 14 0a  db f9 00 f2 59 ff c3 f4  |.H...y......Y...|
+00000090  11 a2 e9 90 49 d6                                 |....I.|
+>>> Flow 4 (server to client)
+00000000  14 03 02 00 01 01 16 03  02 00 40 84 bb 5f a3 9a  |..........@.._..|
+00000010  07 af bf a2 3a 48 23 7c  a9 45 0c 07 ba ea bf 62  |....:H#|.E.....b|
+00000020  c0 4f f3 2f f1 70 0e b1  ee ec 90 4e ea b4 0f 50  |.O./.p.....N...P|
+00000030  47 e2 29 f3 ef ee 01 c7  eb db a4 56 d6 e8 d9 77  |G.)........V...w|
+00000040  9a 64 42 50 40 42 d9 4b  ef 04 48                 |.dBP@B.K..H|
+>>> Flow 5 (client to server)
+00000000  17 03 02 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
+00000010  00 00 00 00 00 d4 03 ec  a2 a8 1b 0a 4f 63 36 5e  |............Oc6^|
+00000020  df 85 45 e0 e7 1e 2d 48  be 2f 1a 09 5f 02 cb 91  |..E...-H./.._...|
+00000030  b2 76 35 39 a2 15 03 02  00 30 00 00 00 00 00 00  |.v59.....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 b1 f1 a5 97 1d e5  |................|
+00000050  29 4c e4 d0 c7 43 3a 43  b1 15 fc 84 6e 54 ab 92  |)L...C:C....nT..|
+00000060  d4 c0 62 c9 fc 8b 73 83  62 a3                    |..b...s.b.|
diff --git a/src/pkg/crypto/tls/testdata/Client-TLSv11-RSA-RC4 b/src/pkg/crypto/tls/testdata/Client-TLSv11-RSA-RC4
new file mode 100644
index 0000000000..fb39b4a9db
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Client-TLSv11-RSA-RC4
@@ -0,0 +1,82 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 70 01 00 00  6c 03 03 00 00 00 00 00  |....p...l.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 1a c0 2f  |.............../|
+00000030  c0 2b c0 11 c0 07 c0 13  c0 09 c0 14 c0 0a 00 05  |.+..............|
+00000040  00 2f 00 35 c0 12 00 0a  01 00 00 29 00 05 00 05  |./.5.......)....|
+00000050  01 00 00 00 00 00 0a 00  08 00 06 00 17 00 18 00  |................|
+00000060  19 00 0b 00 02 01 00 00  0d 00 0a 00 08 04 01 04  |................|
+00000070  03 02 01 02 03                                    |.....|
+>>> Flow 2 (server to client)
+00000000  16 03 02 00 4a 02 00 00  46 03 02 52 ac 77 f7 01  |....J...F..R.w..|
+00000010  a9 ef 15 61 bf ac 76 b1  88 0d de 98 8c de f4 3e  |...a..v........>|
+00000020  52 04 64 33 6f ca b5 b4  19 5b 8f 20 1a d3 25 e1  |R.d3o....[. ..%.|
+00000030  d0 17 4c 71 8e ec 5b be  e6 99 f0 c0 07 76 8a be  |..Lq..[......v..|
+00000040  43 35 9b 98 71 e4 22 cc  88 48 fb c0 00 05 00 16  |C5..q."..H......|
+00000050  03 02 02 be 0b 00 02 ba  00 02 b7 00 02 b4 30 82  |..............0.|
+00000060  02 b0 30 82 02 19 a0 03  02 01 02 02 09 00 85 b0  |..0.............|
+00000070  bb a4 8a 7f b8 ca 30 0d  06 09 2a 86 48 86 f7 0d  |......0...*.H...|
+00000080  01 01 05 05 00 30 45 31  0b 30 09 06 03 55 04 06  |.....0E1.0...U..|
+00000090  13 02 41 55 31 13 30 11  06 03 55 04 08 13 0a 53  |..AU1.0...U....S|
+000000a0  6f 6d 65 2d 53 74 61 74  65 31 21 30 1f 06 03 55  |ome-State1!0...U|
+000000b0  04 0a 13 18 49 6e 74 65  72 6e 65 74 20 57 69 64  |....Internet Wid|
+000000c0  67 69 74 73 20 50 74 79  20 4c 74 64 30 1e 17 0d  |gits Pty Ltd0...|
+000000d0  31 30 30 34 32 34 30 39  30 39 33 38 5a 17 0d 31  |100424090938Z..1|
+000000e0  31 30 34 32 34 30 39 30  39 33 38 5a 30 45 31 0b  |10424090938Z0E1.|
+000000f0  30 09 06 03 55 04 06 13  02 41 55 31 13 30 11 06  |0...U....AU1.0..|
+00000100  03 55 04 08 13 0a 53 6f  6d 65 2d 53 74 61 74 65  |.U....Some-State|
+00000110  31 21 30 1f 06 03 55 04  0a 13 18 49 6e 74 65 72  |1!0...U....Inter|
+00000120  6e 65 74 20 57 69 64 67  69 74 73 20 50 74 79 20  |net Widgits Pty |
+00000130  4c 74 64 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |Ltd0..0...*.H...|
+00000140  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+00000150  bb 79 d6 f5 17 b5 e5 bf  46 10 d0 dc 69 be e6 2b  |.y......F...i..+|
+00000160  07 43 5a d0 03 2d 8a 7a  43 85 b7 14 52 e7 a5 65  |.CZ..-.zC...R..e|
+00000170  4c 2c 78 b8 23 8c b5 b4  82 e5 de 1f 95 3b 7e 62  |L,x.#........;~b|
+00000180  a5 2c a5 33 d6 fe 12 5c  7a 56 fc f5 06 bf fa 58  |.,.3...\zV.....X|
+00000190  7b 26 3f b5 cd 04 d3 d0  c9 21 96 4a c7 f4 54 9f  |{&?......!.J..T.|
+000001a0  5a bf ef 42 71 00 fe 18  99 07 7f 7e 88 7d 7d f1  |Z..Bq......~.}}.|
+000001b0  04 39 c4 a2 2e db 51 c9  7c e3 c0 4c 3b 32 66 01  |.9....Q.|..L;2f.|
+000001c0  cf af b1 1d b8 71 9a 1d  db db 89 6b ae da 2d 79  |.....q.....k..-y|
+000001d0  02 03 01 00 01 a3 81 a7  30 81 a4 30 1d 06 03 55  |........0..0...U|
+000001e0  1d 0e 04 16 04 14 b1 ad  e2 85 5a cf cb 28 db 69  |..........Z..(.i|
+000001f0  ce 23 69 de d3 26 8e 18  88 39 30 75 06 03 55 1d  |.#i..&...90u..U.|
+00000200  23 04 6e 30 6c 80 14 b1  ad e2 85 5a cf cb 28 db  |#.n0l......Z..(.|
+00000210  69 ce 23 69 de d3 26 8e  18 88 39 a1 49 a4 47 30  |i.#i..&...9.I.G0|
+00000220  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+00000230  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+00000240  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+00000250  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+00000260  74 79 20 4c 74 64 82 09  00 85 b0 bb a4 8a 7f b8  |ty Ltd..........|
+00000270  ca 30 0c 06 03 55 1d 13  04 05 30 03 01 01 ff 30  |.0...U....0....0|
+00000280  0d 06 09 2a 86 48 86 f7  0d 01 01 05 05 00 03 81  |...*.H..........|
+00000290  81 00 08 6c 45 24 c7 6b  b1 59 ab 0c 52 cc f2 b0  |...lE$.k.Y..R...|
+000002a0  14 d7 87 9d 7a 64 75 b5  5a 95 66 e4 c5 2b 8e ae  |....zdu.Z.f..+..|
+000002b0  12 66 1f eb 4f 38 b3 6e  60 d3 92 fd f7 41 08 b5  |.f..O8.n`....A..|
+000002c0  25 13 b1 18 7a 24 fb 30  1d ba ed 98 b9 17 ec e7  |%...z$.0........|
+000002d0  d7 31 59 db 95 d3 1d 78  ea 50 56 5c d5 82 5a 2d  |.1Y....x.PV\..Z-|
+000002e0  5a 5f 33 c4 b6 d8 c9 75  90 96 8c 0f 52 98 b5 cd  |Z_3....u....R...|
+000002f0  98 1f 89 20 5f f2 a0 1c  a3 1b 96 94 dd a9 fd 57  |... _..........W|
+00000300  e9 70 e8 26 6d 71 99 9b  26 6e 38 50 29 6c 90 a7  |.p.&mq..&n8P)l..|
+00000310  bd d9 16 03 02 00 04 0e  00 00 00                 |...........|
+>>> Flow 3 (client to server)
+00000000  16 03 02 00 86 10 00 00  82 00 80 6d 51 f3 7f f9  |...........mQ...|
+00000010  3e fb 75 82 41 36 83 e8  6a ee 2a 2e 25 90 67 4c  |>.u.A6..j.*.%.gL|
+00000020  8e 62 2f 30 81 17 e0 85  09 0c 2b b7 23 d7 b0 e2  |.b/0......+.#...|
+00000030  1d f7 3b d7 f5 a1 27 b6  ee 24 b6 1b cc 5b ea 66  |..;...'..$...[.f|
+00000040  0d 6a f4 e5 85 f9 da 43  b4 0e 86 85 e1 f5 aa be  |.j.....C........|
+00000050  c8 ce 39 4c 9c 86 00 08  c2 4b e2 c6 ec 2f f7 ce  |..9L.....K.../..|
+00000060  e6 bd 77 82 6f 23 b6 e0  bd a2 92 b7 3a ac e8 56  |..w.o#......:..V|
+00000070  f1 af 54 5e 46 87 e9 3b  33 e7 b8 28 b7 d6 c8 90  |..T^F..;3..(....|
+00000080  35 d4 1c 43 d1 30 6f 55  4e 0a 70 14 03 02 00 01  |5..C.0oUN.p.....|
+00000090  01 16 03 02 00 24 8e 02  46 f8 a6 27 03 86 ce 21  |.....$..F..'...!|
+000000a0  3e c1 64 75 2d fa db 7c  01 2f 89 43 9a 75 63 92  |>.du-..|./.C.uc.|
+000000b0  b0 03 5e a8 97 59 40 81  75 10                    |..^..Y@.u.|
+>>> Flow 4 (server to client)
+00000000  14 03 02 00 01 01 16 03  02 00 24 0f 50 8b d8 76  |..........$.P..v|
+00000010  1b 47 9d 1a 8f 8c 48 d1  1d 14 57 f5 54 6b f8 59  |.G....H...W.Tk.Y|
+00000020  cf 2c 6e ab f6 cb dd 43  0d f7 59 6d 41 cb 50     |.,n....C..YmA.P|
+>>> Flow 5 (client to server)
+00000000  17 03 02 00 1a 3d 52 8b  ae aa b7 15 dd 68 bd b5  |.....=R......h..|
+00000010  bb 49 fb 5c ab eb aa cd  1e af 5b 3c 75 6f 51 15  |.I.\......[<uoQ.|
+00000020  03 02 00 16 ca fb 12 88  a0 47 f3 fa 9c d9 21 ee  |.........G....!.|
+00000030  20 35 0c 6d 37 04 2c 75  f8 c6                    | 5.m7.,u..|
diff --git a/src/pkg/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA b/src/pkg/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA
new file mode 100644
index 0000000000..1cc6b3bdc1
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA
@@ -0,0 +1,133 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 70 01 00 00  6c 03 03 00 00 00 00 00  |....p...l.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 1a c0 2f  |.............../|
+00000030  c0 2b c0 11 c0 07 c0 13  c0 09 c0 14 c0 0a 00 05  |.+..............|
+00000040  00 2f 00 35 c0 12 00 0a  01 00 00 29 00 05 00 05  |./.5.......)....|
+00000050  01 00 00 00 00 00 0a 00  08 00 06 00 17 00 18 00  |................|
+00000060  19 00 0b 00 02 01 00 00  0d 00 0a 00 08 04 01 04  |................|
+00000070  03 02 01 02 03                                    |.....|
+>>> Flow 2 (server to client)
+00000000  16 03 03 00 54 02 00 00  50 03 03 52 ac 77 f8 c5  |....T...P..R.w..|
+00000010  96 12 04 26 41 58 b0 da  a3 63 a6 7c 30 17 a4 95  |...&AX...c.|0...|
+00000020  72 dc 9b 08 6b 5c cd f0  93 9e 64 20 b7 5d af c1  |r...k\....d .]..|
+00000030  b7 ca 6f 52 3b d8 51 da  34 4a 39 38 31 ed 69 01  |..oR;.Q.4J981.i.|
+00000040  bf e5 57 4c bb 90 07 f8  7b 59 e4 4c c0 09 00 00  |..WL....{Y.L....|
+00000050  08 00 0b 00 04 03 00 01  02 16 03 03 02 0e 0b 00  |................|
+00000060  02 0a 00 02 07 00 02 04  30 82 02 00 30 82 01 62  |........0...0..b|
+00000070  02 09 00 b8 bf 2d 47 a0  d2 eb f4 30 09 06 07 2a  |.....-G....0...*|
+00000080  86 48 ce 3d 04 01 30 45  31 0b 30 09 06 03 55 04  |.H.=..0E1.0...U.|
+00000090  06 13 02 41 55 31 13 30  11 06 03 55 04 08 13 0a  |...AU1.0...U....|
+000000a0  53 6f 6d 65 2d 53 74 61  74 65 31 21 30 1f 06 03  |Some-State1!0...|
+000000b0  55 04 0a 13 18 49 6e 74  65 72 6e 65 74 20 57 69  |U....Internet Wi|
+000000c0  64 67 69 74 73 20 50 74  79 20 4c 74 64 30 1e 17  |dgits Pty Ltd0..|
+000000d0  0d 31 32 31 31 32 32 31  35 30 36 33 32 5a 17 0d  |.121122150632Z..|
+000000e0  32 32 31 31 32 30 31 35  30 36 33 32 5a 30 45 31  |221120150632Z0E1|
+000000f0  0b 30 09 06 03 55 04 06  13 02 41 55 31 13 30 11  |.0...U....AU1.0.|
+00000100  06 03 55 04 08 13 0a 53  6f 6d 65 2d 53 74 61 74  |..U....Some-Stat|
+00000110  65 31 21 30 1f 06 03 55  04 0a 13 18 49 6e 74 65  |e1!0...U....Inte|
+00000120  72 6e 65 74 20 57 69 64  67 69 74 73 20 50 74 79  |rnet Widgits Pty|
+00000130  20 4c 74 64 30 81 9b 30  10 06 07 2a 86 48 ce 3d  | Ltd0..0...*.H.=|
+00000140  02 01 06 05 2b 81 04 00  23 03 81 86 00 04 00 c4  |....+...#.......|
+00000150  a1 ed be 98 f9 0b 48 73  36 7e c3 16 56 11 22 f2  |......Hs6~..V.".|
+00000160  3d 53 c3 3b 4d 21 3d cd  6b 75 e6 f6 b0 dc 9a df  |=S.;M!=.ku......|
+00000170  26 c1 bc b2 87 f0 72 32  7c b3 64 2f 1c 90 bc ea  |&.....r2|.d/....|
+00000180  68 23 10 7e fe e3 25 c0  48 3a 69 e0 28 6d d3 37  |h#.~..%.H:i.(m.7|
+00000190  00 ef 04 62 dd 0d a0 9c  70 62 83 d8 81 d3 64 31  |...b....pb....d1|
+000001a0  aa 9e 97 31 bd 96 b0 68  c0 9b 23 de 76 64 3f 1a  |...1...h..#.vd?.|
+000001b0  5c 7f e9 12 0e 58 58 b6  5f 70 dd 9b d8 ea d5 d7  |\....XX._p......|
+000001c0  f5 d5 cc b9 b6 9f 30 66  5b 66 9a 20 e2 27 e5 bf  |......0f[f. .'..|
+000001d0  fe 3b 30 09 06 07 2a 86  48 ce 3d 04 01 03 81 8c  |.;0...*.H.=.....|
+000001e0  00 30 81 88 02 42 01 88  a2 4f eb e2 45 c5 48 7d  |.0...B...O..E.H}|
+000001f0  1b ac f5 ed 98 9d ae 47  70 c0 5e 1b b6 2f bd f1  |.......Gp.^../..|
+00000200  b6 4d b7 61 40 d3 11 a2  ce ee 0b 7e 92 7e ff 76  |.M.a@......~.~.v|
+00000210  9d c3 3b 7e a5 3f ce fa  10 e2 59 ec 47 2d 7c ac  |..;~.?....Y.G-|.|
+00000220  da 4e 97 0e 15 a0 6f d0  02 42 01 4d fc be 67 13  |.N....o..B.M..g.|
+00000230  9c 2d 05 0e bd 3f a3 8c  25 c1 33 13 83 0d 94 06  |.-...?..%.3.....|
+00000240  bb d4 37 7a f6 ec 7a c9  86 2e dd d7 11 69 7f 85  |..7z..z......i..|
+00000250  7c 56 de fb 31 78 2b e4  c7 78 0d ae cb be 9e 4e  ||V..1x+..x.....N|
+00000260  36 24 31 7b 6a 0f 39 95  12 07 8f 2a 16 03 03 00  |6$1{j.9....*....|
+00000270  d7 0c 00 00 d3 03 00 17  41 04 d8 75 d0 64 77 b8  |........A..u.dw.|
+00000280  77 cf 62 09 56 22 8d 7c  c9 ad 95 b6 20 e1 22 53  |w.b.V".|.... ."S|
+00000290  04 a2 ff ef 55 98 32 a1  93 35 0d 75 21 cf f3 8b  |....U.2..5.u!...|
+000002a0  75 f1 8c da 6a d1 4d 3f  ee 45 bd 10 4c c3 cc 45  |u...j.M?.E..L..E|
+000002b0  ea 3c f7 6d 0f be 49 2c  f7 82 04 03 00 8a 30 81  |.<.m..I,......0.|
+000002c0  87 02 42 01 d5 04 fa a4  10 ff 0e 5f bb a3 ab ae  |..B........_....|
+000002d0  19 ee f0 cf 01 f1 c5 5a  ed b3 2c 08 21 e2 36 2f  |.......Z..,.!.6/|
+000002e0  ef ab 04 ab 03 2f 8c 3a  c6 1d 02 44 ca 91 dd 43  |...../.:...D...C|
+000002f0  a5 00 08 0c 5d ff d7 4e  31 5c 0c b3 da 7f 6d 6d  |....]..N1\....mm|
+00000300  0a ef 36 2e 55 02 41 2e  74 02 05 c1 4f 48 6e 3a  |..6.U.A.t...OHn:|
+00000310  59 fc 67 1d 31 b2 85 67  24 ea ed be 99 87 b3 03  |Y.g.1..g$.......|
+00000320  3c a5 bb fa f0 39 39 b6  a1 3a 3d b0 7e c4 c8 8f  |<....99..:=.~...|
+00000330  5b 74 9c bf df a0 84 f5  6c c5 c8 2a b5 65 f3 60  |[t......l..*.e.`|
+00000340  5f 38 10 c7 9b 71 64 a3  16 03 03 00 30 0d 00 00  |_8...qd.....0...|
+00000350  28 03 01 02 40 00 20 06  01 06 02 06 03 05 01 05  |(...@. .........|
+00000360  02 05 03 04 01 04 02 04  03 03 01 03 02 03 03 02  |................|
+00000370  01 02 02 02 03 01 01 00  00 0e 00 00 00           |.............|
+>>> Flow 3 (client to server)
+00000000  16 03 03 02 0a 0b 00 02  06 00 02 03 00 02 00 30  |...............0|
+00000010  82 01 fc 30 82 01 5e 02  09 00 9a 30 84 6c 26 35  |...0..^....0.l&5|
+00000020  d9 17 30 09 06 07 2a 86  48 ce 3d 04 01 30 45 31  |..0...*.H.=..0E1|
+00000030  0b 30 09 06 03 55 04 06  13 02 41 55 31 13 30 11  |.0...U....AU1.0.|
+00000040  06 03 55 04 08 13 0a 53  6f 6d 65 2d 53 74 61 74  |..U....Some-Stat|
+00000050  65 31 21 30 1f 06 03 55  04 0a 13 18 49 6e 74 65  |e1!0...U....Inte|
+00000060  72 6e 65 74 20 57 69 64  67 69 74 73 20 50 74 79  |rnet Widgits Pty|
+00000070  20 4c 74 64 30 1e 17 0d  31 32 31 31 31 34 31 33  | Ltd0...12111413|
+00000080  32 35 35 33 5a 17 0d 32  32 31 31 31 32 31 33 32  |2553Z..221112132|
+00000090  35 35 33 5a 30 41 31 0b  30 09 06 03 55 04 06 13  |553Z0A1.0...U...|
+000000a0  02 41 55 31 0c 30 0a 06  03 55 04 08 13 03 4e 53  |.AU1.0...U....NS|
+000000b0  57 31 10 30 0e 06 03 55  04 07 13 07 50 79 72 6d  |W1.0...U....Pyrm|
+000000c0  6f 6e 74 31 12 30 10 06  03 55 04 03 13 09 4a 6f  |ont1.0...U....Jo|
+000000d0  65 6c 20 53 69 6e 67 30  81 9b 30 10 06 07 2a 86  |el Sing0..0...*.|
+000000e0  48 ce 3d 02 01 06 05 2b  81 04 00 23 03 81 86 00  |H.=....+...#....|
+000000f0  04 00 95 8c 91 75 14 c0  5e c4 57 b4 d4 c3 6f 8d  |.....u..^.W...o.|
+00000100  ae 68 1e dd 6f ce 86 e1  7e 6e b2 48 3e 81 e5 4e  |.h..o...~n.H>..N|
+00000110  e2 c6 88 4b 64 dc f5 30  bb d3 ff 65 cc 5b f4 dd  |...Kd..0...e.[..|
+00000120  b5 6a 3e 3e d0 1d de 47  c3 76 ad 19 f6 45 2c 8c  |.j>>...G.v...E,.|
+00000130  bc d8 1d 01 4c 1f 70 90  46 76 48 8b 8f 83 cc 4a  |....L.p.FvH....J|
+00000140  5c 8f 40 76 da e0 89 ec  1d 2b c4 4e 30 76 28 41  |\.@v.....+.N0v(A|
+00000150  b2 62 a8 fb 5b f1 f9 4e  7a 8d bd 09 b8 ae ea 8b  |.b..[..Nz.......|
+00000160  18 27 4f 2e 70 fe 13 96  ba c3 d3 40 16 cd 65 4e  |.'O.p......@..eN|
+00000170  ac 11 1e e6 f1 30 09 06  07 2a 86 48 ce 3d 04 01  |.....0...*.H.=..|
+00000180  03 81 8c 00 30 81 88 02  42 00 e0 14 c4 60 60 0b  |....0...B....``.|
+00000190  72 68 b0 32 5d 61 4a 02  74 5c c2 81 b9 16 a8 3f  |rh.2]aJ.t\.....?|
+000001a0  29 c8 36 c7 81 ff 6c b6  5b d9 70 f1 38 3b 50 48  |).6...l.[.p.8;PH|
+000001b0  28 94 cb 09 1a 52 f1 5d  ee 8d f2 b9 f0 f0 da d9  |(....R.]........|
+000001c0  15 3a f9 bd 03 7a 87 a2  23 35 ec 02 42 01 a3 d4  |.:...z..#5..B...|
+000001d0  8a 78 35 1c 4a 9a 23 d2  0a be 2b 10 31 9d 9c 5f  |.x5.J.#...+.1.._|
+000001e0  be e8 91 b3 da 1a f5 5d  a3 23 f5 26 8b 45 70 8d  |.......].#.&.Ep.|
+000001f0  65 62 9b 7e 01 99 3d 18  f6 10 9a 38 61 9b 2e 57  |eb.~..=....8a..W|
+00000200  e4 fa cc b1 8a ce e2 23  a0 87 f0 e1 67 51 eb 16  |.......#....gQ..|
+00000210  03 03 00 46 10 00 00 42  41 04 1e 18 37 ef 0d 19  |...F...BA...7...|
+00000220  51 88 35 75 71 b5 e5 54  5b 12 2e 8f 09 67 fd a7  |Q.5uq..T[....g..|
+00000230  24 20 3e b2 56 1c ce 97  28 5e f8 2b 2d 4f 9e f1  |$ >.V...(^.+-O..|
+00000240  07 9f 6c 4b 5b 83 56 e2  32 42 e9 58 b6 d7 49 a6  |..lK[.V.2B.X..I.|
+00000250  b5 68 1a 41 03 56 6b dc  5a 89 16 03 03 00 92 0f  |.h.A.Vk.Z.......|
+00000260  00 00 8e 04 03 00 8a 30  81 87 02 42 00 c6 85 8e  |.......0...B....|
+00000270  06 b7 04 04 e9 cd 9e 3e  cb 66 23 95 b4 42 9c 64  |.......>.f#..B.d|
+00000280  81 39 05 3f b5 21 f8 28  af 60 6b 4d 3d ba a1 4b  |.9.?.!.(.`kM=..K|
+00000290  5e 77 ef e7 59 28 fe 1d  c1 27 a2 ff a8 de 33 48  |^w..Y(...'....3H|
+000002a0  b3 c1 85 6a 42 9b f9 7e  7e 31 c2 e5 bd 66 02 41  |...jB..~~1...f.A|
+000002b0  4b 49 c6 cd 02 e3 83 f7  03 50 18 6d b4 c9 51 02  |KI.......P.m..Q.|
+000002c0  c0 ab 87 bc e0 3e 4b 89  53 3a e2 65 89 97 02 c1  |.....>K.S:.e....|
+000002d0  88 4a bb 6d c8 1f 2a 63  e4 a7 25 02 5c 95 a7 f1  |.J.m..*c..%.\...|
+000002e0  2c 8f bb f1 f6 95 31 b6  6b bc 29 61 b6 36 27 6e  |,.....1.k.)a.6'n|
+000002f0  ee 14 03 03 00 01 01 16  03 03 00 40 00 00 00 00  |...........@....|
+00000300  00 00 00 00 00 00 00 00  00 00 00 00 2b ec 49 d6  |............+.I.|
+00000310  bc 29 f0 dd ad 8f 56 56  1f e1 1e 8a 52 f1 ec d0  |.)....VV....R...|
+00000320  60 21 d9 6f e0 82 7b 5a  de 2d 9e e9 74 6d 7a e5  |`!.o..{Z.-..tmz.|
+00000330  c6 9f 6b da 1e 4c d6 2e  e8 57 cd 9f              |..k..L...W..|
+>>> Flow 4 (server to client)
+00000000  14 03 03 00 01 01 16 03  03 00 40 17 41 a0 69 d4  |..........@.A.i.|
+00000010  a0 9d aa dd 16 bf 06 ef  8d 63 e2 c8 d8 60 d9 a1  |.........c...`..|
+00000020  15 9e 28 76 6c 68 07 1a  e9 d6 68 f7 d2 51 5e b2  |..(vlh....h..Q^.|
+00000030  fb 5a 3c 39 5f d9 6a 1f  dd 23 06 63 47 b5 9e c1  |.Z<9_.j..#.cG...|
+00000040  7f 7a 3a e9 d9 fa 72 8a  44 e8 01                 |.z:...r.D..|
+>>> Flow 5 (client to server)
+00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
+00000010  00 00 00 00 00 36 4a d2  bf e3 17 b8 b0 08 09 2e  |.....6J.........|
+00000020  75 9e 67 b6 86 09 6a f5  ed fa 75 3a 17 1e a8 9e  |u.g...j...u:....|
+00000030  50 e7 b5 79 75 15 03 03  00 30 00 00 00 00 00 00  |P..yu....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 ee b2 c1 37 7d 4d  |.............7}M|
+00000050  9c 00 34 26 42 7f 3b d1  f2 f1 a9 7d 35 18 25 bb  |..4&B.;....}5.%.|
+00000060  a5 46 cc 2c 2b 90 02 a2  3b cc                    |.F.,+...;.|
diff --git a/src/pkg/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA b/src/pkg/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA
new file mode 100644
index 0000000000..04368440ff
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA
@@ -0,0 +1,127 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 70 01 00 00  6c 03 03 00 00 00 00 00  |....p...l.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 1a c0 2f  |.............../|
+00000030  c0 2b c0 11 c0 07 c0 13  c0 09 c0 14 c0 0a 00 05  |.+..............|
+00000040  00 2f 00 35 c0 12 00 0a  01 00 00 29 00 05 00 05  |./.5.......)....|
+00000050  01 00 00 00 00 00 0a 00  08 00 06 00 17 00 18 00  |................|
+00000060  19 00 0b 00 02 01 00 00  0d 00 0a 00 08 04 01 04  |................|
+00000070  03 02 01 02 03                                    |.....|
+>>> Flow 2 (server to client)
+00000000  16 03 03 00 4a 02 00 00  46 03 03 52 ac 77 f8 46  |....J...F..R.w.F|
+00000010  c2 25 41 4d f8 87 23 8f  4b f7 71 de cf 3b 78 df  |.%AM..#.K.q..;x.|
+00000020  77 c6 71 a2 6e f6 87 de  31 c6 89 20 23 7f ad 48  |w.q.n...1.. #..H|
+00000030  70 f7 2c 4f 87 c8 fb fd  0c 6f af a3 c1 a9 be 57  |p.,O.....o.....W|
+00000040  0f e0 d4 cc 2c f3 31 94  6f 60 b0 1e 00 05 00 16  |....,.1.o`......|
+00000050  03 03 02 be 0b 00 02 ba  00 02 b7 00 02 b4 30 82  |..............0.|
+00000060  02 b0 30 82 02 19 a0 03  02 01 02 02 09 00 85 b0  |..0.............|
+00000070  bb a4 8a 7f b8 ca 30 0d  06 09 2a 86 48 86 f7 0d  |......0...*.H...|
+00000080  01 01 05 05 00 30 45 31  0b 30 09 06 03 55 04 06  |.....0E1.0...U..|
+00000090  13 02 41 55 31 13 30 11  06 03 55 04 08 13 0a 53  |..AU1.0...U....S|
+000000a0  6f 6d 65 2d 53 74 61 74  65 31 21 30 1f 06 03 55  |ome-State1!0...U|
+000000b0  04 0a 13 18 49 6e 74 65  72 6e 65 74 20 57 69 64  |....Internet Wid|
+000000c0  67 69 74 73 20 50 74 79  20 4c 74 64 30 1e 17 0d  |gits Pty Ltd0...|
+000000d0  31 30 30 34 32 34 30 39  30 39 33 38 5a 17 0d 31  |100424090938Z..1|
+000000e0  31 30 34 32 34 30 39 30  39 33 38 5a 30 45 31 0b  |10424090938Z0E1.|
+000000f0  30 09 06 03 55 04 06 13  02 41 55 31 13 30 11 06  |0...U....AU1.0..|
+00000100  03 55 04 08 13 0a 53 6f  6d 65 2d 53 74 61 74 65  |.U....Some-State|
+00000110  31 21 30 1f 06 03 55 04  0a 13 18 49 6e 74 65 72  |1!0...U....Inter|
+00000120  6e 65 74 20 57 69 64 67  69 74 73 20 50 74 79 20  |net Widgits Pty |
+00000130  4c 74 64 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |Ltd0..0...*.H...|
+00000140  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+00000150  bb 79 d6 f5 17 b5 e5 bf  46 10 d0 dc 69 be e6 2b  |.y......F...i..+|
+00000160  07 43 5a d0 03 2d 8a 7a  43 85 b7 14 52 e7 a5 65  |.CZ..-.zC...R..e|
+00000170  4c 2c 78 b8 23 8c b5 b4  82 e5 de 1f 95 3b 7e 62  |L,x.#........;~b|
+00000180  a5 2c a5 33 d6 fe 12 5c  7a 56 fc f5 06 bf fa 58  |.,.3...\zV.....X|
+00000190  7b 26 3f b5 cd 04 d3 d0  c9 21 96 4a c7 f4 54 9f  |{&?......!.J..T.|
+000001a0  5a bf ef 42 71 00 fe 18  99 07 7f 7e 88 7d 7d f1  |Z..Bq......~.}}.|
+000001b0  04 39 c4 a2 2e db 51 c9  7c e3 c0 4c 3b 32 66 01  |.9....Q.|..L;2f.|
+000001c0  cf af b1 1d b8 71 9a 1d  db db 89 6b ae da 2d 79  |.....q.....k..-y|
+000001d0  02 03 01 00 01 a3 81 a7  30 81 a4 30 1d 06 03 55  |........0..0...U|
+000001e0  1d 0e 04 16 04 14 b1 ad  e2 85 5a cf cb 28 db 69  |..........Z..(.i|
+000001f0  ce 23 69 de d3 26 8e 18  88 39 30 75 06 03 55 1d  |.#i..&...90u..U.|
+00000200  23 04 6e 30 6c 80 14 b1  ad e2 85 5a cf cb 28 db  |#.n0l......Z..(.|
+00000210  69 ce 23 69 de d3 26 8e  18 88 39 a1 49 a4 47 30  |i.#i..&...9.I.G0|
+00000220  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+00000230  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+00000240  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+00000250  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+00000260  74 79 20 4c 74 64 82 09  00 85 b0 bb a4 8a 7f b8  |ty Ltd..........|
+00000270  ca 30 0c 06 03 55 1d 13  04 05 30 03 01 01 ff 30  |.0...U....0....0|
+00000280  0d 06 09 2a 86 48 86 f7  0d 01 01 05 05 00 03 81  |...*.H..........|
+00000290  81 00 08 6c 45 24 c7 6b  b1 59 ab 0c 52 cc f2 b0  |...lE$.k.Y..R...|
+000002a0  14 d7 87 9d 7a 64 75 b5  5a 95 66 e4 c5 2b 8e ae  |....zdu.Z.f..+..|
+000002b0  12 66 1f eb 4f 38 b3 6e  60 d3 92 fd f7 41 08 b5  |.f..O8.n`....A..|
+000002c0  25 13 b1 18 7a 24 fb 30  1d ba ed 98 b9 17 ec e7  |%...z$.0........|
+000002d0  d7 31 59 db 95 d3 1d 78  ea 50 56 5c d5 82 5a 2d  |.1Y....x.PV\..Z-|
+000002e0  5a 5f 33 c4 b6 d8 c9 75  90 96 8c 0f 52 98 b5 cd  |Z_3....u....R...|
+000002f0  98 1f 89 20 5f f2 a0 1c  a3 1b 96 94 dd a9 fd 57  |... _..........W|
+00000300  e9 70 e8 26 6d 71 99 9b  26 6e 38 50 29 6c 90 a7  |.p.&mq..&n8P)l..|
+00000310  bd d9 16 03 03 00 30 0d  00 00 28 03 01 02 40 00  |......0...(...@.|
+00000320  20 06 01 06 02 06 03 05  01 05 02 05 03 04 01 04  | ...............|
+00000330  02 04 03 03 01 03 02 03  03 02 01 02 02 02 03 01  |................|
+00000340  01 00 00 0e 00 00 00                              |.......|
+>>> Flow 3 (client to server)
+00000000  16 03 03 02 0a 0b 00 02  06 00 02 03 00 02 00 30  |...............0|
+00000010  82 01 fc 30 82 01 5e 02  09 00 9a 30 84 6c 26 35  |...0..^....0.l&5|
+00000020  d9 17 30 09 06 07 2a 86  48 ce 3d 04 01 30 45 31  |..0...*.H.=..0E1|
+00000030  0b 30 09 06 03 55 04 06  13 02 41 55 31 13 30 11  |.0...U....AU1.0.|
+00000040  06 03 55 04 08 13 0a 53  6f 6d 65 2d 53 74 61 74  |..U....Some-Stat|
+00000050  65 31 21 30 1f 06 03 55  04 0a 13 18 49 6e 74 65  |e1!0...U....Inte|
+00000060  72 6e 65 74 20 57 69 64  67 69 74 73 20 50 74 79  |rnet Widgits Pty|
+00000070  20 4c 74 64 30 1e 17 0d  31 32 31 31 31 34 31 33  | Ltd0...12111413|
+00000080  32 35 35 33 5a 17 0d 32  32 31 31 31 32 31 33 32  |2553Z..221112132|
+00000090  35 35 33 5a 30 41 31 0b  30 09 06 03 55 04 06 13  |553Z0A1.0...U...|
+000000a0  02 41 55 31 0c 30 0a 06  03 55 04 08 13 03 4e 53  |.AU1.0...U....NS|
+000000b0  57 31 10 30 0e 06 03 55  04 07 13 07 50 79 72 6d  |W1.0...U....Pyrm|
+000000c0  6f 6e 74 31 12 30 10 06  03 55 04 03 13 09 4a 6f  |ont1.0...U....Jo|
+000000d0  65 6c 20 53 69 6e 67 30  81 9b 30 10 06 07 2a 86  |el Sing0..0...*.|
+000000e0  48 ce 3d 02 01 06 05 2b  81 04 00 23 03 81 86 00  |H.=....+...#....|
+000000f0  04 00 95 8c 91 75 14 c0  5e c4 57 b4 d4 c3 6f 8d  |.....u..^.W...o.|
+00000100  ae 68 1e dd 6f ce 86 e1  7e 6e b2 48 3e 81 e5 4e  |.h..o...~n.H>..N|
+00000110  e2 c6 88 4b 64 dc f5 30  bb d3 ff 65 cc 5b f4 dd  |...Kd..0...e.[..|
+00000120  b5 6a 3e 3e d0 1d de 47  c3 76 ad 19 f6 45 2c 8c  |.j>>...G.v...E,.|
+00000130  bc d8 1d 01 4c 1f 70 90  46 76 48 8b 8f 83 cc 4a  |....L.p.FvH....J|
+00000140  5c 8f 40 76 da e0 89 ec  1d 2b c4 4e 30 76 28 41  |\.@v.....+.N0v(A|
+00000150  b2 62 a8 fb 5b f1 f9 4e  7a 8d bd 09 b8 ae ea 8b  |.b..[..Nz.......|
+00000160  18 27 4f 2e 70 fe 13 96  ba c3 d3 40 16 cd 65 4e  |.'O.p......@..eN|
+00000170  ac 11 1e e6 f1 30 09 06  07 2a 86 48 ce 3d 04 01  |.....0...*.H.=..|
+00000180  03 81 8c 00 30 81 88 02  42 00 e0 14 c4 60 60 0b  |....0...B....``.|
+00000190  72 68 b0 32 5d 61 4a 02  74 5c c2 81 b9 16 a8 3f  |rh.2]aJ.t\.....?|
+000001a0  29 c8 36 c7 81 ff 6c b6  5b d9 70 f1 38 3b 50 48  |).6...l.[.p.8;PH|
+000001b0  28 94 cb 09 1a 52 f1 5d  ee 8d f2 b9 f0 f0 da d9  |(....R.]........|
+000001c0  15 3a f9 bd 03 7a 87 a2  23 35 ec 02 42 01 a3 d4  |.:...z..#5..B...|
+000001d0  8a 78 35 1c 4a 9a 23 d2  0a be 2b 10 31 9d 9c 5f  |.x5.J.#...+.1.._|
+000001e0  be e8 91 b3 da 1a f5 5d  a3 23 f5 26 8b 45 70 8d  |.......].#.&.Ep.|
+000001f0  65 62 9b 7e 01 99 3d 18  f6 10 9a 38 61 9b 2e 57  |eb.~..=....8a..W|
+00000200  e4 fa cc b1 8a ce e2 23  a0 87 f0 e1 67 51 eb 16  |.......#....gQ..|
+00000210  03 03 00 86 10 00 00 82  00 80 6d 51 f3 7f f9 3e  |..........mQ...>|
+00000220  fb 75 82 41 36 83 e8 6a  ee 2a 2e 25 90 67 4c 8e  |.u.A6..j.*.%.gL.|
+00000230  62 2f 30 81 17 e0 85 09  0c 2b b7 23 d7 b0 e2 1d  |b/0......+.#....|
+00000240  f7 3b d7 f5 a1 27 b6 ee  24 b6 1b cc 5b ea 66 0d  |.;...'..$...[.f.|
+00000250  6a f4 e5 85 f9 da 43 b4  0e 86 85 e1 f5 aa be c8  |j.....C.........|
+00000260  ce 39 4c 9c 86 00 08 c2  4b e2 c6 ec 2f f7 ce e6  |.9L.....K.../...|
+00000270  bd 77 82 6f 23 b6 e0 bd  a2 92 b7 3a ac e8 56 f1  |.w.o#......:..V.|
+00000280  af 54 5e 46 87 e9 3b 33  e7 b8 28 b7 d6 c8 90 35  |.T^F..;3..(....5|
+00000290  d4 1c 43 d1 30 6f 55 4e  0a 70 16 03 03 00 92 0f  |..C.0oUN.p......|
+000002a0  00 00 8e 04 03 00 8a 30  81 87 02 42 00 c6 85 8e  |.......0...B....|
+000002b0  06 b7 04 04 e9 cd 9e 3e  cb 66 23 95 b4 42 9c 64  |.......>.f#..B.d|
+000002c0  81 39 05 3f b5 21 f8 28  af 60 6b 4d 3d ba a1 4b  |.9.?.!.(.`kM=..K|
+000002d0  5e 77 ef e7 59 28 fe 1d  c1 27 a2 ff a8 de 33 48  |^w..Y(...'....3H|
+000002e0  b3 c1 85 6a 42 9b f9 7e  7e 31 c2 e5 bd 66 02 41  |...jB..~~1...f.A|
+000002f0  4b 49 c6 cd 02 e3 83 f7  03 50 18 6d b4 c9 51 02  |KI.......P.m..Q.|
+00000300  c0 ab 87 bc e0 3e 4b 89  53 3a e2 65 89 97 02 c1  |.....>K.S:.e....|
+00000310  88 e9 ba 78 0b 19 d9 81  39 02 7e b5 9f ec 53 0d  |...x....9.~...S.|
+00000320  7e 92 80 e5 ca c5 4a 25  50 bf 85 3a 4c 0f 73 ca  |~.....J%P..:L.s.|
+00000330  ef 14 03 03 00 01 01 16  03 03 00 24 d0 33 06 ab  |...........$.3..|
+00000340  17 88 e1 65 44 18 3a 45  51 44 6f 0e 2e 85 61 33  |...eD.:EQDo...a3|
+00000350  1d 1b bb 5b 89 b5 da f0  7d df 01 90 67 0c 27 4e  |...[....}...g.'N|
+>>> Flow 4 (server to client)
+00000000  14 03 03 00 01 01 16 03  03 00 24 4d ed 09 20 61  |..........$M.. a|
+00000010  30 03 09 eb cd d5 84 29  82 90 84 50 1e e7 9b 7b  |0......)...P...{|
+00000020  ec 8a 18 0c b5 6e 32 c7  65 fb 26 15 9e 79 41     |.....n2.e.&..yA|
+>>> Flow 5 (client to server)
+00000000  17 03 03 00 1a 85 47 11  25 35 d5 53 7f 3d 01 87  |......G.%5.S.=..|
+00000010  14 58 90 f7 25 1a 56 99  7b a2 b9 31 86 b3 45 15  |.X..%.V.{..1..E.|
+00000020  03 03 00 16 88 b2 fb 1c  f9 bb e6 7a a0 c0 d0 52  |...........z...R|
+00000030  f2 f9 b8 e4 5d e5 b7 a0  96 ca                    |....].....|
diff --git a/src/pkg/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA b/src/pkg/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA
new file mode 100644
index 0000000000..5c4b62321f
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA
@@ -0,0 +1,132 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 70 01 00 00  6c 03 03 00 00 00 00 00  |....p...l.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 1a c0 2f  |.............../|
+00000030  c0 2b c0 11 c0 07 c0 13  c0 09 c0 14 c0 0a 00 05  |.+..............|
+00000040  00 2f 00 35 c0 12 00 0a  01 00 00 29 00 05 00 05  |./.5.......)....|
+00000050  01 00 00 00 00 00 0a 00  08 00 06 00 17 00 18 00  |................|
+00000060  19 00 0b 00 02 01 00 00  0d 00 0a 00 08 04 01 04  |................|
+00000070  03 02 01 02 03                                    |.....|
+>>> Flow 2 (server to client)
+00000000  16 03 03 00 54 02 00 00  50 03 03 52 ac 77 f8 85  |....T...P..R.w..|
+00000010  40 fe 2e 6e 8e 8b 52 83  0e 17 63 15 6e a8 07 43  |@..n..R...c.n..C|
+00000020  de 66 78 c6 3b 54 c2 fe  a1 8e c8 20 d8 77 b3 a3  |.fx.;T..... .w..|
+00000030  2e bf c7 0f 1a 2f 0a 76  c7 e3 a6 62 ae 4b 57 0a  |...../.v...b.KW.|
+00000040  78 ed 7e ea 4f 4e ce 97  72 b1 04 78 c0 09 00 00  |x.~.ON..r..x....|
+00000050  08 00 0b 00 04 03 00 01  02 16 03 03 02 0e 0b 00  |................|
+00000060  02 0a 00 02 07 00 02 04  30 82 02 00 30 82 01 62  |........0...0..b|
+00000070  02 09 00 b8 bf 2d 47 a0  d2 eb f4 30 09 06 07 2a  |.....-G....0...*|
+00000080  86 48 ce 3d 04 01 30 45  31 0b 30 09 06 03 55 04  |.H.=..0E1.0...U.|
+00000090  06 13 02 41 55 31 13 30  11 06 03 55 04 08 13 0a  |...AU1.0...U....|
+000000a0  53 6f 6d 65 2d 53 74 61  74 65 31 21 30 1f 06 03  |Some-State1!0...|
+000000b0  55 04 0a 13 18 49 6e 74  65 72 6e 65 74 20 57 69  |U....Internet Wi|
+000000c0  64 67 69 74 73 20 50 74  79 20 4c 74 64 30 1e 17  |dgits Pty Ltd0..|
+000000d0  0d 31 32 31 31 32 32 31  35 30 36 33 32 5a 17 0d  |.121122150632Z..|
+000000e0  32 32 31 31 32 30 31 35  30 36 33 32 5a 30 45 31  |221120150632Z0E1|
+000000f0  0b 30 09 06 03 55 04 06  13 02 41 55 31 13 30 11  |.0...U....AU1.0.|
+00000100  06 03 55 04 08 13 0a 53  6f 6d 65 2d 53 74 61 74  |..U....Some-Stat|
+00000110  65 31 21 30 1f 06 03 55  04 0a 13 18 49 6e 74 65  |e1!0...U....Inte|
+00000120  72 6e 65 74 20 57 69 64  67 69 74 73 20 50 74 79  |rnet Widgits Pty|
+00000130  20 4c 74 64 30 81 9b 30  10 06 07 2a 86 48 ce 3d  | Ltd0..0...*.H.=|
+00000140  02 01 06 05 2b 81 04 00  23 03 81 86 00 04 00 c4  |....+...#.......|
+00000150  a1 ed be 98 f9 0b 48 73  36 7e c3 16 56 11 22 f2  |......Hs6~..V.".|
+00000160  3d 53 c3 3b 4d 21 3d cd  6b 75 e6 f6 b0 dc 9a df  |=S.;M!=.ku......|
+00000170  26 c1 bc b2 87 f0 72 32  7c b3 64 2f 1c 90 bc ea  |&.....r2|.d/....|
+00000180  68 23 10 7e fe e3 25 c0  48 3a 69 e0 28 6d d3 37  |h#.~..%.H:i.(m.7|
+00000190  00 ef 04 62 dd 0d a0 9c  70 62 83 d8 81 d3 64 31  |...b....pb....d1|
+000001a0  aa 9e 97 31 bd 96 b0 68  c0 9b 23 de 76 64 3f 1a  |...1...h..#.vd?.|
+000001b0  5c 7f e9 12 0e 58 58 b6  5f 70 dd 9b d8 ea d5 d7  |\....XX._p......|
+000001c0  f5 d5 cc b9 b6 9f 30 66  5b 66 9a 20 e2 27 e5 bf  |......0f[f. .'..|
+000001d0  fe 3b 30 09 06 07 2a 86  48 ce 3d 04 01 03 81 8c  |.;0...*.H.=.....|
+000001e0  00 30 81 88 02 42 01 88  a2 4f eb e2 45 c5 48 7d  |.0...B...O..E.H}|
+000001f0  1b ac f5 ed 98 9d ae 47  70 c0 5e 1b b6 2f bd f1  |.......Gp.^../..|
+00000200  b6 4d b7 61 40 d3 11 a2  ce ee 0b 7e 92 7e ff 76  |.M.a@......~.~.v|
+00000210  9d c3 3b 7e a5 3f ce fa  10 e2 59 ec 47 2d 7c ac  |..;~.?....Y.G-|.|
+00000220  da 4e 97 0e 15 a0 6f d0  02 42 01 4d fc be 67 13  |.N....o..B.M..g.|
+00000230  9c 2d 05 0e bd 3f a3 8c  25 c1 33 13 83 0d 94 06  |.-...?..%.3.....|
+00000240  bb d4 37 7a f6 ec 7a c9  86 2e dd d7 11 69 7f 85  |..7z..z......i..|
+00000250  7c 56 de fb 31 78 2b e4  c7 78 0d ae cb be 9e 4e  ||V..1x+..x.....N|
+00000260  36 24 31 7b 6a 0f 39 95  12 07 8f 2a 16 03 03 00  |6$1{j.9....*....|
+00000270  d8 0c 00 00 d4 03 00 17  41 04 d9 d2 72 4b ef c3  |........A...rK..|
+00000280  be a2 5b fc b3 75 52 c9  b4 5d 56 bf 23 2e e6 18  |..[..uR..]V.#...|
+00000290  96 df 4b 67 af 1c 11 c3  17 fa d5 43 81 d6 91 c3  |..Kg.......C....|
+000002a0  b2 0a d8 cc b9 24 36 1d  74 4e bf 1e 20 2f 77 cd  |.....$6.tN.. /w.|
+000002b0  6a 3b d7 07 b9 17 e8 ad  1d 5a 04 03 00 8b 30 81  |j;.......Z....0.|
+000002c0  88 02 42 01 9d ae 1a b6  0f 0a 0d 1b e1 d7 30 8c  |..B...........0.|
+000002d0  f1 63 1c 0a b9 9a 06 ef  23 59 4d c7 ba 86 ec 7e  |.c......#YM....~|
+000002e0  e4 5b 95 21 ea 7b 28 d2  a1 8c 9c fe 80 25 63 5f  |.[.!.{(......%c_|
+000002f0  42 e7 a2 59 db 76 de a2  66 cc 99 c7 96 a2 0a 54  |B..Y.v..f......T|
+00000300  15 62 cb d4 59 02 42 00  80 29 a2 cb a7 f4 ce 1d  |.b..Y.B..)......|
+00000310  4b 99 9b c1 36 70 a7 18  a4 94 8a 4b 02 6d 25 a6  |K...6p.....K.m%.|
+00000320  00 7c 84 09 21 db 31 0f  0d cc 4a 57 b6 44 5b cd  |.|..!.1...JW.D[.|
+00000330  1b be 16 ec d7 0c e4 27  bb 13 33 e9 d2 ae 13 c5  |.......'..3.....|
+00000340  05 c1 48 fd f3 c6 f9 a2  e0 16 03 03 00 30 0d 00  |..H..........0..|
+00000350  00 28 03 01 02 40 00 20  06 01 06 02 06 03 05 01  |.(...@. ........|
+00000360  05 02 05 03 04 01 04 02  04 03 03 01 03 02 03 03  |................|
+00000370  02 01 02 02 02 03 01 01  00 00 0e 00 00 00        |..............|
+>>> Flow 3 (client to server)
+00000000  16 03 03 01 fb 0b 00 01  f7 00 01 f4 00 01 f1 30  |...............0|
+00000010  82 01 ed 30 82 01 58 a0  03 02 01 02 02 01 00 30  |...0..X........0|
+00000020  0b 06 09 2a 86 48 86 f7  0d 01 01 05 30 26 31 10  |...*.H......0&1.|
+00000030  30 0e 06 03 55 04 0a 13  07 41 63 6d 65 20 43 6f  |0...U....Acme Co|
+00000040  31 12 30 10 06 03 55 04  03 13 09 31 32 37 2e 30  |1.0...U....127.0|
+00000050  2e 30 2e 31 30 1e 17 0d  31 31 31 32 30 38 30 37  |.0.10...11120807|
+00000060  35 35 31 32 5a 17 0d 31  32 31 32 30 37 30 38 30  |5512Z..121207080|
+00000070  30 31 32 5a 30 26 31 10  30 0e 06 03 55 04 0a 13  |012Z0&1.0...U...|
+00000080  07 41 63 6d 65 20 43 6f  31 12 30 10 06 03 55 04  |.Acme Co1.0...U.|
+00000090  03 13 09 31 32 37 2e 30  2e 30 2e 31 30 81 9c 30  |...127.0.0.10..0|
+000000a0  0b 06 09 2a 86 48 86 f7  0d 01 01 01 03 81 8c 00  |...*.H..........|
+000000b0  30 81 88 02 81 80 4e d0  7b 31 e3 82 64 d9 59 c0  |0.....N.{1..d.Y.|
+000000c0  c2 87 a4 5e 1e 8b 73 33  c7 63 53 df 66 92 06 84  |...^..s3.cS.f...|
+000000d0  f6 64 d5 8f e4 36 a7 1d  2b e8 b3 20 36 45 23 b5  |.d...6..+.. 6E#.|
+000000e0  e3 95 ae ed e0 f5 20 9c  8d 95 df 7f 5a 12 ef 87  |...... .....Z...|
+000000f0  e4 5b 68 e4 e9 0e 74 ec  04 8a 7f de 93 27 c4 01  |.[h...t......'..|
+00000100  19 7a bd f2 dc 3d 14 ab  d0 54 ca 21 0c d0 4d 6e  |.z...=...T.!..Mn|
+00000110  87 2e 5c c5 d2 bb 4d 4b  4f ce b6 2c f7 7e 88 ec  |..\...MKO..,.~..|
+00000120  7c d7 02 91 74 a6 1e 0c  1a da e3 4a 5a 2e de 13  ||...t......JZ...|
+00000130  9c 4c 40 88 59 93 02 03  01 00 01 a3 32 30 30 30  |.L@.Y.......2000|
+00000140  0e 06 03 55 1d 0f 01 01  ff 04 04 03 02 00 a0 30  |...U...........0|
+00000150  0d 06 03 55 1d 0e 04 06  04 04 01 02 03 04 30 0f  |...U..........0.|
+00000160  06 03 55 1d 23 04 08 30  06 80 04 01 02 03 04 30  |..U.#..0.......0|
+00000170  0b 06 09 2a 86 48 86 f7  0d 01 01 05 03 81 81 00  |...*.H..........|
+00000180  36 1f b3 7a 0c 75 c9 6e  37 46 61 2b d5 bd c0 a7  |6..z.u.n7Fa+....|
+00000190  4b cc 46 9a 81 58 7c 85  79 29 c8 c8 c6 67 dd 32  |K.F..X|.y)...g.2|
+000001a0  56 45 2b 75 b6 e9 24 a9  50 9a be 1f 5a fa 1a 15  |VE+u..$.P...Z...|
+000001b0  d9 cc 55 95 72 16 83 b9  c2 b6 8f fd 88 8c 38 84  |..U.r.........8.|
+000001c0  1d ab 5d 92 31 13 4f fd  83 3b c6 9d f1 11 62 b6  |..].1.O..;....b.|
+000001d0  8b ec ab 67 be c8 64 b0  11 50 46 58 17 6b 99 1c  |...g..d..PFX.k..|
+000001e0  d3 1d fc 06 f1 0e e5 96  a8 0c f9 78 20 b7 44 18  |...........x .D.|
+000001f0  51 8d 10 7e 4f 94 67 df  a3 4e 70 73 8e 90 91 85  |Q..~O.g..Nps....|
+00000200  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
+00000210  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
+00000220  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
+00000230  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
+00000240  a6 b5 68 1a 41 03 56 6b  dc 5a 89 16 03 03 00 88  |..h.A.Vk.Z......|
+00000250  0f 00 00 84 04 01 00 80  3c 05 23 6b 47 37 6c de  |........<.#kG7l.|
+00000260  d9 21 fc c5 ba 63 15 5d  55 d0 1c 78 cc b7 76 6f  |.!...c.]U..x..vo|
+00000270  97 d7 ce cc 28 e4 cb 2c  b4 33 c4 7b 39 3a da b8  |....(..,.3.{9:..|
+00000280  0a 6d 79 be 30 86 21 2d  40 c9 7a 5e 44 98 b7 a2  |.my.0.!-@.z^D...|
+00000290  23 9d d2 af 3d d1 df 08  a0 b5 87 9f 57 06 1b ab  |#...=.......W...|
+000002a0  1e 8b e5 1f 09 71 cd df  7d 9b d3 bd a9 06 29 7f  |.....q..}.....).|
+000002b0  6a 84 b7 1b c5 a4 ee 11  e4 11 23 c1 1c 64 00 0b  |j.........#..d..|
+000002c0  07 49 ba 2b 40 95 57 0a  e5 02 ae a1 c1 e4 0b 31  |.I.+@.W........1|
+000002d0  9b bf ad eb aa 74 a9 fa  14 03 03 00 01 01 16 03  |.....t..........|
+000002e0  03 00 40 00 00 00 00 00  00 00 00 00 00 00 00 00  |..@.............|
+000002f0  00 00 00 9b 04 da 20 1e  55 a7 d0 60 f3 7b 60 e2  |...... .U..`.{`.|
+00000300  3e 46 59 73 84 f7 1c 19  93 c5 53 95 bf 24 05 c9  |>FYs......S..$..|
+00000310  68 40 53 a9 b8 da 98 2b  08 9e 02 39 b0 a3 3f aa  |h@S....+...9..?.|
+00000320  eb ba 9c                                          |...|
+>>> Flow 4 (server to client)
+00000000  14 03 03 00 01 01 16 03  03 00 40 23 ec df cd 12  |..........@#....|
+00000010  ca 13 f8 b5 75 10 af a0  27 a7 cf f5 d7 a7 46 68  |....u...'.....Fh|
+00000020  44 6b 7e cf 0b ce dc 86  5f b7 35 16 5f 01 ae c9  |Dk~....._.5._...|
+00000030  16 15 ae 4c 9e 7a ca 8e  ae dd cb ec 24 32 32 9c  |...L.z......$22.|
+00000040  b4 b7 61 78 18 0b ee 61  74 6d 0b                 |..ax...atm.|
+>>> Flow 5 (client to server)
+00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
+00000010  00 00 00 00 00 d7 7d 87  ac 42 06 f2 4e d3 71 0c  |......}..B..N.q.|
+00000020  1b 62 8c 81 03 38 85 7e  6c 31 ae 8c b4 04 2f 19  |.b...8.~l1..../.|
+00000030  b1 c8 6c a2 6c 15 03 03  00 30 00 00 00 00 00 00  |..l.l....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 99 e8 4b a9 33 ec  |............K.3.|
+00000050  f4 5e 60 5b c0 72 ef 61  6c e2 e0 5b 4d af f8 c6  |.^`[.r.al..[M...|
+00000060  b6 57 be 07 a3 c0 fe cd  29 65                    |.W......)e|
diff --git a/src/pkg/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA b/src/pkg/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA
new file mode 100644
index 0000000000..f8f121234d
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA
@@ -0,0 +1,126 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 70 01 00 00  6c 03 03 00 00 00 00 00  |....p...l.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 1a c0 2f  |.............../|
+00000030  c0 2b c0 11 c0 07 c0 13  c0 09 c0 14 c0 0a 00 05  |.+..............|
+00000040  00 2f 00 35 c0 12 00 0a  01 00 00 29 00 05 00 05  |./.5.......)....|
+00000050  01 00 00 00 00 00 0a 00  08 00 06 00 17 00 18 00  |................|
+00000060  19 00 0b 00 02 01 00 00  0d 00 0a 00 08 04 01 04  |................|
+00000070  03 02 01 02 03                                    |.....|
+>>> Flow 2 (server to client)
+00000000  16 03 03 00 4a 02 00 00  46 03 03 52 ac 77 f7 91  |....J...F..R.w..|
+00000010  73 b5 51 be 27 c7 ba 60  72 d9 ca 1f f6 7e a2 c2  |s.Q.'..`r....~..|
+00000020  ec 8a 16 39 9a 30 c8 46  3f 34 e8 20 90 e8 71 aa  |...9.0.F?4. ..q.|
+00000030  9f 0a fe 6f f1 9c 5c 8d  10 51 45 ea 90 ef f8 6e  |...o..\..QE....n|
+00000040  88 ba 7e 37 00 e8 66 b9  53 6f 89 dc 00 05 00 16  |..~7..f.So......|
+00000050  03 03 02 be 0b 00 02 ba  00 02 b7 00 02 b4 30 82  |..............0.|
+00000060  02 b0 30 82 02 19 a0 03  02 01 02 02 09 00 85 b0  |..0.............|
+00000070  bb a4 8a 7f b8 ca 30 0d  06 09 2a 86 48 86 f7 0d  |......0...*.H...|
+00000080  01 01 05 05 00 30 45 31  0b 30 09 06 03 55 04 06  |.....0E1.0...U..|
+00000090  13 02 41 55 31 13 30 11  06 03 55 04 08 13 0a 53  |..AU1.0...U....S|
+000000a0  6f 6d 65 2d 53 74 61 74  65 31 21 30 1f 06 03 55  |ome-State1!0...U|
+000000b0  04 0a 13 18 49 6e 74 65  72 6e 65 74 20 57 69 64  |....Internet Wid|
+000000c0  67 69 74 73 20 50 74 79  20 4c 74 64 30 1e 17 0d  |gits Pty Ltd0...|
+000000d0  31 30 30 34 32 34 30 39  30 39 33 38 5a 17 0d 31  |100424090938Z..1|
+000000e0  31 30 34 32 34 30 39 30  39 33 38 5a 30 45 31 0b  |10424090938Z0E1.|
+000000f0  30 09 06 03 55 04 06 13  02 41 55 31 13 30 11 06  |0...U....AU1.0..|
+00000100  03 55 04 08 13 0a 53 6f  6d 65 2d 53 74 61 74 65  |.U....Some-State|
+00000110  31 21 30 1f 06 03 55 04  0a 13 18 49 6e 74 65 72  |1!0...U....Inter|
+00000120  6e 65 74 20 57 69 64 67  69 74 73 20 50 74 79 20  |net Widgits Pty |
+00000130  4c 74 64 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |Ltd0..0...*.H...|
+00000140  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+00000150  bb 79 d6 f5 17 b5 e5 bf  46 10 d0 dc 69 be e6 2b  |.y......F...i..+|
+00000160  07 43 5a d0 03 2d 8a 7a  43 85 b7 14 52 e7 a5 65  |.CZ..-.zC...R..e|
+00000170  4c 2c 78 b8 23 8c b5 b4  82 e5 de 1f 95 3b 7e 62  |L,x.#........;~b|
+00000180  a5 2c a5 33 d6 fe 12 5c  7a 56 fc f5 06 bf fa 58  |.,.3...\zV.....X|
+00000190  7b 26 3f b5 cd 04 d3 d0  c9 21 96 4a c7 f4 54 9f  |{&?......!.J..T.|
+000001a0  5a bf ef 42 71 00 fe 18  99 07 7f 7e 88 7d 7d f1  |Z..Bq......~.}}.|
+000001b0  04 39 c4 a2 2e db 51 c9  7c e3 c0 4c 3b 32 66 01  |.9....Q.|..L;2f.|
+000001c0  cf af b1 1d b8 71 9a 1d  db db 89 6b ae da 2d 79  |.....q.....k..-y|
+000001d0  02 03 01 00 01 a3 81 a7  30 81 a4 30 1d 06 03 55  |........0..0...U|
+000001e0  1d 0e 04 16 04 14 b1 ad  e2 85 5a cf cb 28 db 69  |..........Z..(.i|
+000001f0  ce 23 69 de d3 26 8e 18  88 39 30 75 06 03 55 1d  |.#i..&...90u..U.|
+00000200  23 04 6e 30 6c 80 14 b1  ad e2 85 5a cf cb 28 db  |#.n0l......Z..(.|
+00000210  69 ce 23 69 de d3 26 8e  18 88 39 a1 49 a4 47 30  |i.#i..&...9.I.G0|
+00000220  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+00000230  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+00000240  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+00000250  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+00000260  74 79 20 4c 74 64 82 09  00 85 b0 bb a4 8a 7f b8  |ty Ltd..........|
+00000270  ca 30 0c 06 03 55 1d 13  04 05 30 03 01 01 ff 30  |.0...U....0....0|
+00000280  0d 06 09 2a 86 48 86 f7  0d 01 01 05 05 00 03 81  |...*.H..........|
+00000290  81 00 08 6c 45 24 c7 6b  b1 59 ab 0c 52 cc f2 b0  |...lE$.k.Y..R...|
+000002a0  14 d7 87 9d 7a 64 75 b5  5a 95 66 e4 c5 2b 8e ae  |....zdu.Z.f..+..|
+000002b0  12 66 1f eb 4f 38 b3 6e  60 d3 92 fd f7 41 08 b5  |.f..O8.n`....A..|
+000002c0  25 13 b1 18 7a 24 fb 30  1d ba ed 98 b9 17 ec e7  |%...z$.0........|
+000002d0  d7 31 59 db 95 d3 1d 78  ea 50 56 5c d5 82 5a 2d  |.1Y....x.PV\..Z-|
+000002e0  5a 5f 33 c4 b6 d8 c9 75  90 96 8c 0f 52 98 b5 cd  |Z_3....u....R...|
+000002f0  98 1f 89 20 5f f2 a0 1c  a3 1b 96 94 dd a9 fd 57  |... _..........W|
+00000300  e9 70 e8 26 6d 71 99 9b  26 6e 38 50 29 6c 90 a7  |.p.&mq..&n8P)l..|
+00000310  bd d9 16 03 03 00 30 0d  00 00 28 03 01 02 40 00  |......0...(...@.|
+00000320  20 06 01 06 02 06 03 05  01 05 02 05 03 04 01 04  | ...............|
+00000330  02 04 03 03 01 03 02 03  03 02 01 02 02 02 03 01  |................|
+00000340  01 00 00 0e 00 00 00                              |.......|
+>>> Flow 3 (client to server)
+00000000  16 03 03 01 fb 0b 00 01  f7 00 01 f4 00 01 f1 30  |...............0|
+00000010  82 01 ed 30 82 01 58 a0  03 02 01 02 02 01 00 30  |...0..X........0|
+00000020  0b 06 09 2a 86 48 86 f7  0d 01 01 05 30 26 31 10  |...*.H......0&1.|
+00000030  30 0e 06 03 55 04 0a 13  07 41 63 6d 65 20 43 6f  |0...U....Acme Co|
+00000040  31 12 30 10 06 03 55 04  03 13 09 31 32 37 2e 30  |1.0...U....127.0|
+00000050  2e 30 2e 31 30 1e 17 0d  31 31 31 32 30 38 30 37  |.0.10...11120807|
+00000060  35 35 31 32 5a 17 0d 31  32 31 32 30 37 30 38 30  |5512Z..121207080|
+00000070  30 31 32 5a 30 26 31 10  30 0e 06 03 55 04 0a 13  |012Z0&1.0...U...|
+00000080  07 41 63 6d 65 20 43 6f  31 12 30 10 06 03 55 04  |.Acme Co1.0...U.|
+00000090  03 13 09 31 32 37 2e 30  2e 30 2e 31 30 81 9c 30  |...127.0.0.10..0|
+000000a0  0b 06 09 2a 86 48 86 f7  0d 01 01 01 03 81 8c 00  |...*.H..........|
+000000b0  30 81 88 02 81 80 4e d0  7b 31 e3 82 64 d9 59 c0  |0.....N.{1..d.Y.|
+000000c0  c2 87 a4 5e 1e 8b 73 33  c7 63 53 df 66 92 06 84  |...^..s3.cS.f...|
+000000d0  f6 64 d5 8f e4 36 a7 1d  2b e8 b3 20 36 45 23 b5  |.d...6..+.. 6E#.|
+000000e0  e3 95 ae ed e0 f5 20 9c  8d 95 df 7f 5a 12 ef 87  |...... .....Z...|
+000000f0  e4 5b 68 e4 e9 0e 74 ec  04 8a 7f de 93 27 c4 01  |.[h...t......'..|
+00000100  19 7a bd f2 dc 3d 14 ab  d0 54 ca 21 0c d0 4d 6e  |.z...=...T.!..Mn|
+00000110  87 2e 5c c5 d2 bb 4d 4b  4f ce b6 2c f7 7e 88 ec  |..\...MKO..,.~..|
+00000120  7c d7 02 91 74 a6 1e 0c  1a da e3 4a 5a 2e de 13  ||...t......JZ...|
+00000130  9c 4c 40 88 59 93 02 03  01 00 01 a3 32 30 30 30  |.L@.Y.......2000|
+00000140  0e 06 03 55 1d 0f 01 01  ff 04 04 03 02 00 a0 30  |...U...........0|
+00000150  0d 06 03 55 1d 0e 04 06  04 04 01 02 03 04 30 0f  |...U..........0.|
+00000160  06 03 55 1d 23 04 08 30  06 80 04 01 02 03 04 30  |..U.#..0.......0|
+00000170  0b 06 09 2a 86 48 86 f7  0d 01 01 05 03 81 81 00  |...*.H..........|
+00000180  36 1f b3 7a 0c 75 c9 6e  37 46 61 2b d5 bd c0 a7  |6..z.u.n7Fa+....|
+00000190  4b cc 46 9a 81 58 7c 85  79 29 c8 c8 c6 67 dd 32  |K.F..X|.y)...g.2|
+000001a0  56 45 2b 75 b6 e9 24 a9  50 9a be 1f 5a fa 1a 15  |VE+u..$.P...Z...|
+000001b0  d9 cc 55 95 72 16 83 b9  c2 b6 8f fd 88 8c 38 84  |..U.r.........8.|
+000001c0  1d ab 5d 92 31 13 4f fd  83 3b c6 9d f1 11 62 b6  |..].1.O..;....b.|
+000001d0  8b ec ab 67 be c8 64 b0  11 50 46 58 17 6b 99 1c  |...g..d..PFX.k..|
+000001e0  d3 1d fc 06 f1 0e e5 96  a8 0c f9 78 20 b7 44 18  |...........x .D.|
+000001f0  51 8d 10 7e 4f 94 67 df  a3 4e 70 73 8e 90 91 85  |Q..~O.g..Nps....|
+00000200  16 03 03 00 86 10 00 00  82 00 80 6d 51 f3 7f f9  |...........mQ...|
+00000210  3e fb 75 82 41 36 83 e8  6a ee 2a 2e 25 90 67 4c  |>.u.A6..j.*.%.gL|
+00000220  8e 62 2f 30 81 17 e0 85  09 0c 2b b7 23 d7 b0 e2  |.b/0......+.#...|
+00000230  1d f7 3b d7 f5 a1 27 b6  ee 24 b6 1b cc 5b ea 66  |..;...'..$...[.f|
+00000240  0d 6a f4 e5 85 f9 da 43  b4 0e 86 85 e1 f5 aa be  |.j.....C........|
+00000250  c8 ce 39 4c 9c 86 00 08  c2 4b e2 c6 ec 2f f7 ce  |..9L.....K.../..|
+00000260  e6 bd 77 82 6f 23 b6 e0  bd a2 92 b7 3a ac e8 56  |..w.o#......:..V|
+00000270  f1 af 54 5e 46 87 e9 3b  33 e7 b8 28 b7 d6 c8 90  |..T^F..;3..(....|
+00000280  35 d4 1c 43 d1 30 6f 55  4e 0a 70 16 03 03 00 88  |5..C.0oUN.p.....|
+00000290  0f 00 00 84 04 01 00 80  1d 50 f8 65 0a 2e e7 b8  |.........P.e....|
+000002a0  4e 52 51 05 bd 9f 4f 7a  31 67 dd 6c 34 ea 45 30  |NRQ...Oz1g.l4.E0|
+000002b0  57 0b ac a0 9c 41 f5 d7  82 1a fe 7d 3f 5d d4 b9  |W....A.....}?]..|
+000002c0  38 b0 3d 0c f3 57 ff 8e  e8 52 3d be 91 54 c5 49  |8.=..W...R=..T.I|
+000002d0  38 63 9e b8 8a 17 b5 36  29 e1 22 f5 a9 b8 f3 1a  |8c.....6).".....|
+000002e0  98 ab c3 32 3c 36 70 45  b0 25 e4 8c b7 e8 2c ea  |...2<6pE.%....,.|
+000002f0  cf 62 cd c0 69 6d 35 c4  3b 77 4d 90 5a ba 35 de  |.b..im5.;wM.Z.5.|
+00000300  6f 1d d3 ab bb e8 77 e7  83 6c b6 3c b3 ab b2 7e  |o.....w..l.<...~|
+00000310  f4 52 b4 e0 5f c9 9e 0d  14 03 03 00 01 01 16 03  |.R.._...........|
+00000320  03 00 24 8c 9a a2 e5 d5  9c af dc 73 d9 aa 86 a2  |..$........s....|
+00000330  f5 ff 2f 66 f1 5f 1e 65  4f ba 57 37 4f 6d 3b 47  |../f._.eO.W7Om;G|
+00000340  24 27 74 ca 91 3e e1                              |$'t..>.|
+>>> Flow 4 (server to client)
+00000000  14 03 03 00 01 01 16 03  03 00 24 a0 10 09 ea 2c  |..........$....,|
+00000010  f5 7c 55 41 84 35 47 d6  7d 75 09 fc 1a d7 b7 da  |.|UA.5G.}u......|
+00000020  8f e0 2d fb c8 a5 9e 71  12 1e eb 64 6b bb ae     |..-....q...dk..|
+>>> Flow 5 (client to server)
+00000000  17 03 03 00 1a dd 2a cd  81 c7 ed c5 29 5f ef b2  |......*.....)_..|
+00000010  f2 34 9e bb cb 00 75 8b  d5 3e a6 3e b8 42 cd 15  |.4....u..>.>.B..|
+00000020  03 03 00 16 d5 4d e2 8f  8d f1 be 2d 85 fe 49 8a  |.....M.....-..I.|
+00000030  8d f8 df ca e4 ed d0 22  72 e0                    |......."r.|
diff --git a/src/pkg/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES b/src/pkg/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES
new file mode 100644
index 0000000000..5ca0bbff05
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES
@@ -0,0 +1,89 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 70 01 00 00  6c 03 03 00 00 00 00 00  |....p...l.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 1a c0 2f  |.............../|
+00000030  c0 2b c0 11 c0 07 c0 13  c0 09 c0 14 c0 0a 00 05  |.+..............|
+00000040  00 2f 00 35 c0 12 00 0a  01 00 00 29 00 05 00 05  |./.5.......)....|
+00000050  01 00 00 00 00 00 0a 00  08 00 06 00 17 00 18 00  |................|
+00000060  19 00 0b 00 02 01 00 00  0d 00 0a 00 08 04 01 04  |................|
+00000070  03 02 01 02 03                                    |.....|
+>>> Flow 2 (server to client)
+00000000  16 03 03 00 54 02 00 00  50 03 03 52 ac 77 f7 5e  |....T...P..R.w.^|
+00000010  12 d1 1a fa 09 d7 e5 3c  eb 34 6f 79 3a 4f e8 7b  |.......<.4oy:O.{|
+00000020  92 d7 bd ff 22 37 21 58  c2 73 c2 20 7e 17 7f 83  |...."7!X.s. ~...|
+00000030  36 9e 12 f1 ce c0 3a b3  02 7f 3f 6d 58 7e 71 fe  |6.....:...?mX~q.|
+00000040  9c ce e2 7e f4 19 92 e3  45 57 69 5e c0 09 00 00  |...~....EWi^....|
+00000050  08 00 0b 00 04 03 00 01  02 16 03 03 02 0e 0b 00  |................|
+00000060  02 0a 00 02 07 00 02 04  30 82 02 00 30 82 01 62  |........0...0..b|
+00000070  02 09 00 b8 bf 2d 47 a0  d2 eb f4 30 09 06 07 2a  |.....-G....0...*|
+00000080  86 48 ce 3d 04 01 30 45  31 0b 30 09 06 03 55 04  |.H.=..0E1.0...U.|
+00000090  06 13 02 41 55 31 13 30  11 06 03 55 04 08 13 0a  |...AU1.0...U....|
+000000a0  53 6f 6d 65 2d 53 74 61  74 65 31 21 30 1f 06 03  |Some-State1!0...|
+000000b0  55 04 0a 13 18 49 6e 74  65 72 6e 65 74 20 57 69  |U....Internet Wi|
+000000c0  64 67 69 74 73 20 50 74  79 20 4c 74 64 30 1e 17  |dgits Pty Ltd0..|
+000000d0  0d 31 32 31 31 32 32 31  35 30 36 33 32 5a 17 0d  |.121122150632Z..|
+000000e0  32 32 31 31 32 30 31 35  30 36 33 32 5a 30 45 31  |221120150632Z0E1|
+000000f0  0b 30 09 06 03 55 04 06  13 02 41 55 31 13 30 11  |.0...U....AU1.0.|
+00000100  06 03 55 04 08 13 0a 53  6f 6d 65 2d 53 74 61 74  |..U....Some-Stat|
+00000110  65 31 21 30 1f 06 03 55  04 0a 13 18 49 6e 74 65  |e1!0...U....Inte|
+00000120  72 6e 65 74 20 57 69 64  67 69 74 73 20 50 74 79  |rnet Widgits Pty|
+00000130  20 4c 74 64 30 81 9b 30  10 06 07 2a 86 48 ce 3d  | Ltd0..0...*.H.=|
+00000140  02 01 06 05 2b 81 04 00  23 03 81 86 00 04 00 c4  |....+...#.......|
+00000150  a1 ed be 98 f9 0b 48 73  36 7e c3 16 56 11 22 f2  |......Hs6~..V.".|
+00000160  3d 53 c3 3b 4d 21 3d cd  6b 75 e6 f6 b0 dc 9a df  |=S.;M!=.ku......|
+00000170  26 c1 bc b2 87 f0 72 32  7c b3 64 2f 1c 90 bc ea  |&.....r2|.d/....|
+00000180  68 23 10 7e fe e3 25 c0  48 3a 69 e0 28 6d d3 37  |h#.~..%.H:i.(m.7|
+00000190  00 ef 04 62 dd 0d a0 9c  70 62 83 d8 81 d3 64 31  |...b....pb....d1|
+000001a0  aa 9e 97 31 bd 96 b0 68  c0 9b 23 de 76 64 3f 1a  |...1...h..#.vd?.|
+000001b0  5c 7f e9 12 0e 58 58 b6  5f 70 dd 9b d8 ea d5 d7  |\....XX._p......|
+000001c0  f5 d5 cc b9 b6 9f 30 66  5b 66 9a 20 e2 27 e5 bf  |......0f[f. .'..|
+000001d0  fe 3b 30 09 06 07 2a 86  48 ce 3d 04 01 03 81 8c  |.;0...*.H.=.....|
+000001e0  00 30 81 88 02 42 01 88  a2 4f eb e2 45 c5 48 7d  |.0...B...O..E.H}|
+000001f0  1b ac f5 ed 98 9d ae 47  70 c0 5e 1b b6 2f bd f1  |.......Gp.^../..|
+00000200  b6 4d b7 61 40 d3 11 a2  ce ee 0b 7e 92 7e ff 76  |.M.a@......~.~.v|
+00000210  9d c3 3b 7e a5 3f ce fa  10 e2 59 ec 47 2d 7c ac  |..;~.?....Y.G-|.|
+00000220  da 4e 97 0e 15 a0 6f d0  02 42 01 4d fc be 67 13  |.N....o..B.M..g.|
+00000230  9c 2d 05 0e bd 3f a3 8c  25 c1 33 13 83 0d 94 06  |.-...?..%.3.....|
+00000240  bb d4 37 7a f6 ec 7a c9  86 2e dd d7 11 69 7f 85  |..7z..z......i..|
+00000250  7c 56 de fb 31 78 2b e4  c7 78 0d ae cb be 9e 4e  ||V..1x+..x.....N|
+00000260  36 24 31 7b 6a 0f 39 95  12 07 8f 2a 16 03 03 00  |6$1{j.9....*....|
+00000270  d8 0c 00 00 d4 03 00 17  41 04 81 cc fd bd 41 23  |........A.....A#|
+00000280  dc cb a6 e5 8f 0b c9 bc  8a 0b 4a 26 e0 a6 5f 89  |..........J&.._.|
+00000290  a0 10 50 41 4b a9 80 f1  bf c1 a0 c0 e1 97 40 47  |..PAK.........@G|
+000002a0  f1 98 10 b2 73 a7 40 e6  8b 15 ed 83 37 4f 32 b9  |....s.@.....7O2.|
+000002b0  1f 0b 91 11 33 46 70 15  35 4d 04 03 00 8b 30 81  |....3Fp.5M....0.|
+000002c0  88 02 42 00 84 b5 7e 53  1d 32 a2 88 19 e6 bc a8  |..B...~S.2......|
+000002d0  8a b9 e8 13 af 63 8c a2  af 39 3b e0 dc d3 13 f9  |.....c...9;.....|
+000002e0  ec fe 4b 4a e1 7c 59 0a  ae 98 0c 5e ec 9b 33 d2  |..KJ.|Y....^..3.|
+000002f0  b4 ff 9a ed de 5a be 21  29 ad a6 e6 d5 c4 63 ae  |.....Z.!).....c.|
+00000300  b2 cd 8a dd 26 02 42 01  29 f0 0a 38 4d 14 ca 41  |....&.B.)..8M..A|
+00000310  89 02 31 2e 37 46 1f 60  f8 8d 4a 11 8e 86 a1 80  |..1.7F.`..J.....|
+00000320  10 be 13 79 a0 74 af 43  d8 b1 6e 52 33 3e eb bf  |...y.t.C..nR3>..|
+00000330  39 87 22 53 95 a4 15 1a  e6 d1 90 39 65 ec 75 c0  |9."S.......9e.u.|
+00000340  1c 58 fa 0b f1 83 04 f5  e7 16 03 03 00 04 0e 00  |.X..............|
+00000350  00 00                                             |..|
+>>> Flow 3 (client to server)
+00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
+00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
+00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
+00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
+00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
+00000050  01 16 03 03 00 40 00 00  00 00 00 00 00 00 00 00  |.....@..........|
+00000060  00 00 00 00 00 00 dd af  5a 6c c7 fb 45 57 e9 0b  |........Zl..EW..|
+00000070  33 b6 a9 42 7e d0 33 79  dc ba d2 9f 07 b2 a5 16  |3..B~.3y........|
+00000080  31 30 5b 72 fb 27 10 ab  0b a9 cb 18 27 6f bd 75  |10[r.'......'o.u|
+00000090  65 a8 94 ba 2d 18                                 |e...-.|
+>>> Flow 4 (server to client)
+00000000  14 03 03 00 01 01 16 03  03 00 40 2a 60 dc bf a9  |..........@*`...|
+00000010  7e 5e a9 97 17 ee 1e 62  e8 0f c5 f2 72 1b 11 86  |~^.....b....r...|
+00000020  68 83 49 30 2e d4 08 32  80 16 1d 6a 4a 98 d2 e0  |h.I0...2...jJ...|
+00000030  0b 0c fa 5b 1c 74 b6 83  b8 ec 3d c6 7c f4 c5 f1  |...[.t....=.|...|
+00000040  d9 16 68 cf 32 1b 06 9b  18 fd f6                 |..h.2......|
+>>> Flow 5 (client to server)
+00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
+00000010  00 00 00 00 00 16 b5 36  aa c9 3d 27 04 cf 9f 37  |.......6..='...7|
+00000020  a0 6c 35 d1 d3 dd 5b cf  a1 df aa e0 54 0b 5d d4  |.l5...[.....T.].|
+00000030  b0 d3 44 18 5e 15 03 03  00 30 00 00 00 00 00 00  |..D.^....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 ea de c9 15 ff e6  |................|
+00000050  28 f8 5d c4 2a de 64 64  98 22 1e ea 75 2e a7 72  |(.].*.dd."..u..r|
+00000060  65 95 98 0a e0 96 f4 de  ad 33                    |e........3|
diff --git a/src/pkg/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM b/src/pkg/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM
new file mode 100644
index 0000000000..079ccfd328
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM
@@ -0,0 +1,84 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 70 01 00 00  6c 03 03 00 00 00 00 00  |....p...l.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 1a c0 2f  |.............../|
+00000030  c0 2b c0 11 c0 07 c0 13  c0 09 c0 14 c0 0a 00 05  |.+..............|
+00000040  00 2f 00 35 c0 12 00 0a  01 00 00 29 00 05 00 05  |./.5.......)....|
+00000050  01 00 00 00 00 00 0a 00  08 00 06 00 17 00 18 00  |................|
+00000060  19 00 0b 00 02 01 00 00  0d 00 0a 00 08 04 01 04  |................|
+00000070  03 02 01 02 03                                    |.....|
+>>> Flow 2 (server to client)
+00000000  16 03 03 00 54 02 00 00  50 03 03 52 ac 77 f7 a9  |....T...P..R.w..|
+00000010  e1 80 2b b8 c5 87 2e 11  81 69 a3 0c 25 83 bb 69  |..+......i..%..i|
+00000020  4c a0 c9 cf c0 b9 f4 be  7b 8b fc 20 d4 78 d2 91  |L.......{.. .x..|
+00000030  37 58 b2 d6 0a ee 11 5c  31 c6 d3 58 83 38 c3 6a  |7X.....\1..X.8.j|
+00000040  2a da 64 70 02 0f ce f5  65 27 21 76 c0 2b 00 00  |*.dp....e'!v.+..|
+00000050  08 00 0b 00 04 03 00 01  02 16 03 03 02 0e 0b 00  |................|
+00000060  02 0a 00 02 07 00 02 04  30 82 02 00 30 82 01 62  |........0...0..b|
+00000070  02 09 00 b8 bf 2d 47 a0  d2 eb f4 30 09 06 07 2a  |.....-G....0...*|
+00000080  86 48 ce 3d 04 01 30 45  31 0b 30 09 06 03 55 04  |.H.=..0E1.0...U.|
+00000090  06 13 02 41 55 31 13 30  11 06 03 55 04 08 13 0a  |...AU1.0...U....|
+000000a0  53 6f 6d 65 2d 53 74 61  74 65 31 21 30 1f 06 03  |Some-State1!0...|
+000000b0  55 04 0a 13 18 49 6e 74  65 72 6e 65 74 20 57 69  |U....Internet Wi|
+000000c0  64 67 69 74 73 20 50 74  79 20 4c 74 64 30 1e 17  |dgits Pty Ltd0..|
+000000d0  0d 31 32 31 31 32 32 31  35 30 36 33 32 5a 17 0d  |.121122150632Z..|
+000000e0  32 32 31 31 32 30 31 35  30 36 33 32 5a 30 45 31  |221120150632Z0E1|
+000000f0  0b 30 09 06 03 55 04 06  13 02 41 55 31 13 30 11  |.0...U....AU1.0.|
+00000100  06 03 55 04 08 13 0a 53  6f 6d 65 2d 53 74 61 74  |..U....Some-Stat|
+00000110  65 31 21 30 1f 06 03 55  04 0a 13 18 49 6e 74 65  |e1!0...U....Inte|
+00000120  72 6e 65 74 20 57 69 64  67 69 74 73 20 50 74 79  |rnet Widgits Pty|
+00000130  20 4c 74 64 30 81 9b 30  10 06 07 2a 86 48 ce 3d  | Ltd0..0...*.H.=|
+00000140  02 01 06 05 2b 81 04 00  23 03 81 86 00 04 00 c4  |....+...#.......|
+00000150  a1 ed be 98 f9 0b 48 73  36 7e c3 16 56 11 22 f2  |......Hs6~..V.".|
+00000160  3d 53 c3 3b 4d 21 3d cd  6b 75 e6 f6 b0 dc 9a df  |=S.;M!=.ku......|
+00000170  26 c1 bc b2 87 f0 72 32  7c b3 64 2f 1c 90 bc ea  |&.....r2|.d/....|
+00000180  68 23 10 7e fe e3 25 c0  48 3a 69 e0 28 6d d3 37  |h#.~..%.H:i.(m.7|
+00000190  00 ef 04 62 dd 0d a0 9c  70 62 83 d8 81 d3 64 31  |...b....pb....d1|
+000001a0  aa 9e 97 31 bd 96 b0 68  c0 9b 23 de 76 64 3f 1a  |...1...h..#.vd?.|
+000001b0  5c 7f e9 12 0e 58 58 b6  5f 70 dd 9b d8 ea d5 d7  |\....XX._p......|
+000001c0  f5 d5 cc b9 b6 9f 30 66  5b 66 9a 20 e2 27 e5 bf  |......0f[f. .'..|
+000001d0  fe 3b 30 09 06 07 2a 86  48 ce 3d 04 01 03 81 8c  |.;0...*.H.=.....|
+000001e0  00 30 81 88 02 42 01 88  a2 4f eb e2 45 c5 48 7d  |.0...B...O..E.H}|
+000001f0  1b ac f5 ed 98 9d ae 47  70 c0 5e 1b b6 2f bd f1  |.......Gp.^../..|
+00000200  b6 4d b7 61 40 d3 11 a2  ce ee 0b 7e 92 7e ff 76  |.M.a@......~.~.v|
+00000210  9d c3 3b 7e a5 3f ce fa  10 e2 59 ec 47 2d 7c ac  |..;~.?....Y.G-|.|
+00000220  da 4e 97 0e 15 a0 6f d0  02 42 01 4d fc be 67 13  |.N....o..B.M..g.|
+00000230  9c 2d 05 0e bd 3f a3 8c  25 c1 33 13 83 0d 94 06  |.-...?..%.3.....|
+00000240  bb d4 37 7a f6 ec 7a c9  86 2e dd d7 11 69 7f 85  |..7z..z......i..|
+00000250  7c 56 de fb 31 78 2b e4  c7 78 0d ae cb be 9e 4e  ||V..1x+..x.....N|
+00000260  36 24 31 7b 6a 0f 39 95  12 07 8f 2a 16 03 03 00  |6$1{j.9....*....|
+00000270  d7 0c 00 00 d3 03 00 17  41 04 b1 83 29 44 4d 61  |........A...)DMa|
+00000280  7f 14 4e 4f 54 fc 9f fb  01 e7 ab 16 fb 28 20 fc  |..NOT........( .|
+00000290  9a cb 75 50 b0 47 d5 3e  d3 41 0f 0f f7 dd c8 6f  |..uP.G.>.A.....o|
+000002a0  b3 65 e2 e4 c4 2b 74 fa  4e f0 6d 27 5a 1a 5a 69  |.e...+t.N.m'Z.Zi|
+000002b0  9d 44 78 f0 9b ec 4e cc  26 70 04 03 00 8a 30 81  |.Dx...N.&p....0.|
+000002c0  87 02 42 01 16 f4 f8 7a  52 8b 0f 83 75 d9 4f b2  |..B....zR...u.O.|
+000002d0  51 10 1c a6 30 6b ac 30  ab b9 00 38 b9 44 95 47  |Q...0k.0...8.D.G|
+000002e0  4b 80 29 ca 36 f4 b2 86  32 25 14 7b 4a 99 14 18  |K.).6...2%.{J...|
+000002f0  cd 3c 43 68 cb cf d8 cb  12 d8 1c 27 7b 4e de dd  |.<Ch.......'{N..|
+00000300  91 d8 7a 23 de 02 41 4b  33 2b 28 83 e4 47 e9 a7  |..z#..AK3+(..G..|
+00000310  fb aa 8a 3b ee 5e 96 3f  dd 2c c8 cf f4 1f 1d c7  |...;.^.?.,......|
+00000320  c3 41 b5 ba c9 22 d3 5b  7f 11 d9 e6 c5 f3 a7 df  |.A...".[........|
+00000330  bb dd 4f df a0 5f 53 0b  d0 bb 73 84 8a 5c 1c 8f  |..O.._S...s..\..|
+00000340  a7 4c 6e fd 4b fe d5 b1  16 03 03 00 04 0e 00 00  |.Ln.K...........|
+00000350  00                                                |.|
+>>> Flow 3 (client to server)
+00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
+00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
+00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
+00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
+00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
+00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 cd 30  |.....(.........0|
+00000060  fd 7f db 2c e9 5d df be  c1 6d ee 15 44 e3 04 f4  |...,.]...m..D...|
+00000070  4c 32 e8 05 65 65 8f 20  93 4b 7a b2 29 e6        |L2..ee. .Kz.).|
+>>> Flow 4 (server to client)
+00000000  14 03 03 00 01 01 16 03  03 00 28 fb ad f8 e3 77  |..........(....w|
+00000010  e2 56 68 41 49 cb 4c 7b  1d 1e c4 2f 0b d2 3f 45  |.VhAI.L{.../..?E|
+00000020  e5 ec a0 72 bd 77 f7 c3  be 17 39 e2 ff 03 36 ee  |...r.w....9...6.|
+00000030  39 b0 9f                                          |9..|
+>>> Flow 5 (client to server)
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 cc 1e ea  |................|
+00000010  a9 11 7d 34 9d 73 f0 5d  76 e6 3a bf 76 9b 71 45  |..}4.s.]v.:.v.qE|
+00000020  84 4b 37 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.K7.............|
+00000030  a4 98 0c 9a 61 5f 58 48  98 b5 eb 9a 67 93 3e 6a  |....a_XH....g.>j|
+00000040  7d 49                                             |}I|
diff --git a/src/pkg/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES b/src/pkg/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES
new file mode 100644
index 0000000000..158c63a150
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES
@@ -0,0 +1,99 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 70 01 00 00  6c 03 03 00 00 00 00 00  |....p...l.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 1a c0 2f  |.............../|
+00000030  c0 2b c0 11 c0 07 c0 13  c0 09 c0 14 c0 0a 00 05  |.+..............|
+00000040  00 2f 00 35 c0 12 00 0a  01 00 00 29 00 05 00 05  |./.5.......)....|
+00000050  01 00 00 00 00 00 0a 00  08 00 06 00 17 00 18 00  |................|
+00000060  19 00 0b 00 02 01 00 00  0d 00 0a 00 08 04 01 04  |................|
+00000070  03 02 01 02 03                                    |.....|
+>>> Flow 2 (server to client)
+00000000  16 03 03 00 54 02 00 00  50 03 03 52 ac 77 f7 63  |....T...P..R.w.c|
+00000010  0f 46 31 fc 9b 1f 13 19  98 13 0f dc f0 99 40 1c  |.F1...........@.|
+00000020  a4 72 1a 73 39 8e 49 d8  bc c6 60 20 80 ba 81 b5  |.r.s9.I...` ....|
+00000030  fb 17 2e 41 f4 e3 26 4b  2e ab 4f e0 10 d6 fd 46  |...A..&K..O....F|
+00000040  b6 1e 94 ef 5f 66 34 21  e0 27 71 b9 c0 13 00 00  |...._f4!.'q.....|
+00000050  08 00 0b 00 04 03 00 01  02 16 03 03 02 be 0b 00  |................|
+00000060  02 ba 00 02 b7 00 02 b4  30 82 02 b0 30 82 02 19  |........0...0...|
+00000070  a0 03 02 01 02 02 09 00  85 b0 bb a4 8a 7f b8 ca  |................|
+00000080  30 0d 06 09 2a 86 48 86  f7 0d 01 01 05 05 00 30  |0...*.H........0|
+00000090  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+000000a0  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+000000b0  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+000000c0  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+000000d0  74 79 20 4c 74 64 30 1e  17 0d 31 30 30 34 32 34  |ty Ltd0...100424|
+000000e0  30 39 30 39 33 38 5a 17  0d 31 31 30 34 32 34 30  |090938Z..1104240|
+000000f0  39 30 39 33 38 5a 30 45  31 0b 30 09 06 03 55 04  |90938Z0E1.0...U.|
+00000100  06 13 02 41 55 31 13 30  11 06 03 55 04 08 13 0a  |...AU1.0...U....|
+00000110  53 6f 6d 65 2d 53 74 61  74 65 31 21 30 1f 06 03  |Some-State1!0...|
+00000120  55 04 0a 13 18 49 6e 74  65 72 6e 65 74 20 57 69  |U....Internet Wi|
+00000130  64 67 69 74 73 20 50 74  79 20 4c 74 64 30 81 9f  |dgits Pty Ltd0..|
+00000140  30 0d 06 09 2a 86 48 86  f7 0d 01 01 01 05 00 03  |0...*.H.........|
+00000150  81 8d 00 30 81 89 02 81  81 00 bb 79 d6 f5 17 b5  |...0.......y....|
+00000160  e5 bf 46 10 d0 dc 69 be  e6 2b 07 43 5a d0 03 2d  |..F...i..+.CZ..-|
+00000170  8a 7a 43 85 b7 14 52 e7  a5 65 4c 2c 78 b8 23 8c  |.zC...R..eL,x.#.|
+00000180  b5 b4 82 e5 de 1f 95 3b  7e 62 a5 2c a5 33 d6 fe  |.......;~b.,.3..|
+00000190  12 5c 7a 56 fc f5 06 bf  fa 58 7b 26 3f b5 cd 04  |.\zV.....X{&?...|
+000001a0  d3 d0 c9 21 96 4a c7 f4  54 9f 5a bf ef 42 71 00  |...!.J..T.Z..Bq.|
+000001b0  fe 18 99 07 7f 7e 88 7d  7d f1 04 39 c4 a2 2e db  |.....~.}}..9....|
+000001c0  51 c9 7c e3 c0 4c 3b 32  66 01 cf af b1 1d b8 71  |Q.|..L;2f......q|
+000001d0  9a 1d db db 89 6b ae da  2d 79 02 03 01 00 01 a3  |.....k..-y......|
+000001e0  81 a7 30 81 a4 30 1d 06  03 55 1d 0e 04 16 04 14  |..0..0...U......|
+000001f0  b1 ad e2 85 5a cf cb 28  db 69 ce 23 69 de d3 26  |....Z..(.i.#i..&|
+00000200  8e 18 88 39 30 75 06 03  55 1d 23 04 6e 30 6c 80  |...90u..U.#.n0l.|
+00000210  14 b1 ad e2 85 5a cf cb  28 db 69 ce 23 69 de d3  |.....Z..(.i.#i..|
+00000220  26 8e 18 88 39 a1 49 a4  47 30 45 31 0b 30 09 06  |&...9.I.G0E1.0..|
+00000230  03 55 04 06 13 02 41 55  31 13 30 11 06 03 55 04  |.U....AU1.0...U.|
+00000240  08 13 0a 53 6f 6d 65 2d  53 74 61 74 65 31 21 30  |...Some-State1!0|
+00000250  1f 06 03 55 04 0a 13 18  49 6e 74 65 72 6e 65 74  |...U....Internet|
+00000260  20 57 69 64 67 69 74 73  20 50 74 79 20 4c 74 64  | Widgits Pty Ltd|
+00000270  82 09 00 85 b0 bb a4 8a  7f b8 ca 30 0c 06 03 55  |...........0...U|
+00000280  1d 13 04 05 30 03 01 01  ff 30 0d 06 09 2a 86 48  |....0....0...*.H|
+00000290  86 f7 0d 01 01 05 05 00  03 81 81 00 08 6c 45 24  |.............lE$|
+000002a0  c7 6b b1 59 ab 0c 52 cc  f2 b0 14 d7 87 9d 7a 64  |.k.Y..R.......zd|
+000002b0  75 b5 5a 95 66 e4 c5 2b  8e ae 12 66 1f eb 4f 38  |u.Z.f..+...f..O8|
+000002c0  b3 6e 60 d3 92 fd f7 41  08 b5 25 13 b1 18 7a 24  |.n`....A..%...z$|
+000002d0  fb 30 1d ba ed 98 b9 17  ec e7 d7 31 59 db 95 d3  |.0.........1Y...|
+000002e0  1d 78 ea 50 56 5c d5 82  5a 2d 5a 5f 33 c4 b6 d8  |.x.PV\..Z-Z_3...|
+000002f0  c9 75 90 96 8c 0f 52 98  b5 cd 98 1f 89 20 5f f2  |.u....R...... _.|
+00000300  a0 1c a3 1b 96 94 dd a9  fd 57 e9 70 e8 26 6d 71  |.........W.p.&mq|
+00000310  99 9b 26 6e 38 50 29 6c  90 a7 bd d9 16 03 03 00  |..&n8P)l........|
+00000320  cd 0c 00 00 c9 03 00 17  41 04 07 bc 8a ca 81 0b  |........A.......|
+00000330  56 ef fa 13 da 6f 4b 90  77 d7 bc e0 4b b5 50 31  |V....oK.w...K.P1|
+00000340  f4 a4 bf c8 e3 28 32 42  22 ec a3 2e c6 65 21 93  |.....(2B"....e!.|
+00000350  75 26 cf b0 83 68 c4 22  ce 02 7d 9a 5a a4 2a 76  |u&...h."..}.Z.*v|
+00000360  f4 63 d1 97 48 6e 5a 5d  55 af 04 01 00 80 2f 5a  |.c..HnZ]U...../Z|
+00000370  0e 8e a3 98 6c 5d fe 45  c0 a1 80 56 9b a7 cd 3f  |....l].E...V...?|
+00000380  62 5c 65 94 4a b4 00 e1  85 6a 08 9f 21 c7 de f5  |b\e.J....j..!...|
+00000390  32 96 3a e1 24 4c a2 1a  f4 42 eb 26 34 32 98 1f  |2.:.$L...B.&42..|
+000003a0  00 1f 0c 54 ed cd d5 90  32 ac 63 7a 6b 8b 81 22  |...T....2.czk.."|
+000003b0  a0 9a 1b 72 cc b1 ea aa  a8 e5 92 dd 1b 47 59 9f  |...r.........GY.|
+000003c0  2c 0e f4 96 44 ae 40 4b  d2 12 8d 66 f3 13 a2 fe  |,...D.@K...f....|
+000003d0  e8 ec d7 69 5b fe 6b 1b  57 2a b0 e4 4c 9c d8 01  |...i[.k.W*..L...|
+000003e0  fc b6 b1 b6 b5 06 49 2f  a7 65 6c da ac a1 16 03  |......I/.el.....|
+000003f0  03 00 04 0e 00 00 00                              |.......|
+>>> Flow 3 (client to server)
+00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
+00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
+00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
+00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
+00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
+00000050  01 16 03 03 00 40 00 00  00 00 00 00 00 00 00 00  |.....@..........|
+00000060  00 00 00 00 00 00 40 b3  ad 72 14 89 dc 2f e5 ac  |......@..r.../..|
+00000070  21 94 09 2f a4 99 ea f1  6e 09 57 20 05 51 2b 0b  |!../....n.W .Q+.|
+00000080  db 16 2d d8 ab 58 71 d9  da be 75 10 69 2d ef 03  |..-..Xq...u.i-..|
+00000090  e3 68 0e ab da 21                                 |.h...!|
+>>> Flow 4 (server to client)
+00000000  14 03 03 00 01 01 16 03  03 00 40 c3 bb ef 26 e3  |..........@...&.|
+00000010  77 8d ca 38 15 ee e3 ce  2e b4 63 41 5a 07 fe b7  |w..8......cAZ...|
+00000020  9e 68 48 40 fc 09 17 f7  44 0d 04 7c af 2a 72 08  |.hH@....D..|.*r.|
+00000030  26 a0 65 13 02 04 c5 c7  63 80 86 76 cb da 67 4b  |&.e.....c..v..gK|
+00000040  6b 77 6b 69 f7 38 81 9b  22 42 36                 |kwki.8.."B6|
+>>> Flow 5 (client to server)
+00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
+00000010  00 00 00 00 00 4a b4 4a  af 44 80 31 87 26 b3 a8  |.....J.J.D.1.&..|
+00000020  1e f7 2a 4c 0c 8f 29 ac  52 55 75 e7 fe de b9 66  |..*L..).RUu....f|
+00000030  aa 16 e7 18 02 15 03 03  00 30 00 00 00 00 00 00  |.........0......|
+00000040  00 00 00 00 00 00 00 00  00 00 54 7f 4b c7 d7 93  |..........T.K...|
+00000050  90 30 ff 8f 96 4d 71 b7  ed db 65 7c af a2 00 f9  |.0...Mq...e|....|
+00000060  cb b4 77 a6 c4 5e 23 a7  77 4a                    |..w..^#.wJ|
diff --git a/src/pkg/crypto/tls/testdata/Client-TLSv12-RSA-RC4 b/src/pkg/crypto/tls/testdata/Client-TLSv12-RSA-RC4
new file mode 100644
index 0000000000..ac1d9a407f
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Client-TLSv12-RSA-RC4
@@ -0,0 +1,82 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 70 01 00 00  6c 03 03 00 00 00 00 00  |....p...l.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 1a c0 2f  |.............../|
+00000030  c0 2b c0 11 c0 07 c0 13  c0 09 c0 14 c0 0a 00 05  |.+..............|
+00000040  00 2f 00 35 c0 12 00 0a  01 00 00 29 00 05 00 05  |./.5.......)....|
+00000050  01 00 00 00 00 00 0a 00  08 00 06 00 17 00 18 00  |................|
+00000060  19 00 0b 00 02 01 00 00  0d 00 0a 00 08 04 01 04  |................|
+00000070  03 02 01 02 03                                    |.....|
+>>> Flow 2 (server to client)
+00000000  16 03 03 00 4a 02 00 00  46 03 03 52 ac 77 f7 35  |....J...F..R.w.5|
+00000010  a6 0a 57 0a 43 25 69 29  e7 14 d6 27 f3 21 ec c7  |..W.C%i)...'.!..|
+00000020  be 69 65 eb f4 ed 96 4c  9e 0a fa 20 5d 7d 71 3b  |.ie....L... ]}q;|
+00000030  c1 7d 2d 56 a9 60 2f 58  f2 05 29 36 8f 59 a6 0f  |.}-V.`/X..)6.Y..|
+00000040  13 f8 31 dc 8e b5 ca 4d  38 c4 28 19 00 05 00 16  |..1....M8.(.....|
+00000050  03 03 02 be 0b 00 02 ba  00 02 b7 00 02 b4 30 82  |..............0.|
+00000060  02 b0 30 82 02 19 a0 03  02 01 02 02 09 00 85 b0  |..0.............|
+00000070  bb a4 8a 7f b8 ca 30 0d  06 09 2a 86 48 86 f7 0d  |......0...*.H...|
+00000080  01 01 05 05 00 30 45 31  0b 30 09 06 03 55 04 06  |.....0E1.0...U..|
+00000090  13 02 41 55 31 13 30 11  06 03 55 04 08 13 0a 53  |..AU1.0...U....S|
+000000a0  6f 6d 65 2d 53 74 61 74  65 31 21 30 1f 06 03 55  |ome-State1!0...U|
+000000b0  04 0a 13 18 49 6e 74 65  72 6e 65 74 20 57 69 64  |....Internet Wid|
+000000c0  67 69 74 73 20 50 74 79  20 4c 74 64 30 1e 17 0d  |gits Pty Ltd0...|
+000000d0  31 30 30 34 32 34 30 39  30 39 33 38 5a 17 0d 31  |100424090938Z..1|
+000000e0  31 30 34 32 34 30 39 30  39 33 38 5a 30 45 31 0b  |10424090938Z0E1.|
+000000f0  30 09 06 03 55 04 06 13  02 41 55 31 13 30 11 06  |0...U....AU1.0..|
+00000100  03 55 04 08 13 0a 53 6f  6d 65 2d 53 74 61 74 65  |.U....Some-State|
+00000110  31 21 30 1f 06 03 55 04  0a 13 18 49 6e 74 65 72  |1!0...U....Inter|
+00000120  6e 65 74 20 57 69 64 67  69 74 73 20 50 74 79 20  |net Widgits Pty |
+00000130  4c 74 64 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |Ltd0..0...*.H...|
+00000140  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+00000150  bb 79 d6 f5 17 b5 e5 bf  46 10 d0 dc 69 be e6 2b  |.y......F...i..+|
+00000160  07 43 5a d0 03 2d 8a 7a  43 85 b7 14 52 e7 a5 65  |.CZ..-.zC...R..e|
+00000170  4c 2c 78 b8 23 8c b5 b4  82 e5 de 1f 95 3b 7e 62  |L,x.#........;~b|
+00000180  a5 2c a5 33 d6 fe 12 5c  7a 56 fc f5 06 bf fa 58  |.,.3...\zV.....X|
+00000190  7b 26 3f b5 cd 04 d3 d0  c9 21 96 4a c7 f4 54 9f  |{&?......!.J..T.|
+000001a0  5a bf ef 42 71 00 fe 18  99 07 7f 7e 88 7d 7d f1  |Z..Bq......~.}}.|
+000001b0  04 39 c4 a2 2e db 51 c9  7c e3 c0 4c 3b 32 66 01  |.9....Q.|..L;2f.|
+000001c0  cf af b1 1d b8 71 9a 1d  db db 89 6b ae da 2d 79  |.....q.....k..-y|
+000001d0  02 03 01 00 01 a3 81 a7  30 81 a4 30 1d 06 03 55  |........0..0...U|
+000001e0  1d 0e 04 16 04 14 b1 ad  e2 85 5a cf cb 28 db 69  |..........Z..(.i|
+000001f0  ce 23 69 de d3 26 8e 18  88 39 30 75 06 03 55 1d  |.#i..&...90u..U.|
+00000200  23 04 6e 30 6c 80 14 b1  ad e2 85 5a cf cb 28 db  |#.n0l......Z..(.|
+00000210  69 ce 23 69 de d3 26 8e  18 88 39 a1 49 a4 47 30  |i.#i..&...9.I.G0|
+00000220  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+00000230  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+00000240  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+00000250  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+00000260  74 79 20 4c 74 64 82 09  00 85 b0 bb a4 8a 7f b8  |ty Ltd..........|
+00000270  ca 30 0c 06 03 55 1d 13  04 05 30 03 01 01 ff 30  |.0...U....0....0|
+00000280  0d 06 09 2a 86 48 86 f7  0d 01 01 05 05 00 03 81  |...*.H..........|
+00000290  81 00 08 6c 45 24 c7 6b  b1 59 ab 0c 52 cc f2 b0  |...lE$.k.Y..R...|
+000002a0  14 d7 87 9d 7a 64 75 b5  5a 95 66 e4 c5 2b 8e ae  |....zdu.Z.f..+..|
+000002b0  12 66 1f eb 4f 38 b3 6e  60 d3 92 fd f7 41 08 b5  |.f..O8.n`....A..|
+000002c0  25 13 b1 18 7a 24 fb 30  1d ba ed 98 b9 17 ec e7  |%...z$.0........|
+000002d0  d7 31 59 db 95 d3 1d 78  ea 50 56 5c d5 82 5a 2d  |.1Y....x.PV\..Z-|
+000002e0  5a 5f 33 c4 b6 d8 c9 75  90 96 8c 0f 52 98 b5 cd  |Z_3....u....R...|
+000002f0  98 1f 89 20 5f f2 a0 1c  a3 1b 96 94 dd a9 fd 57  |... _..........W|
+00000300  e9 70 e8 26 6d 71 99 9b  26 6e 38 50 29 6c 90 a7  |.p.&mq..&n8P)l..|
+00000310  bd d9 16 03 03 00 04 0e  00 00 00                 |...........|
+>>> Flow 3 (client to server)
+00000000  16 03 03 00 86 10 00 00  82 00 80 6d 51 f3 7f f9  |...........mQ...|
+00000010  3e fb 75 82 41 36 83 e8  6a ee 2a 2e 25 90 67 4c  |>.u.A6..j.*.%.gL|
+00000020  8e 62 2f 30 81 17 e0 85  09 0c 2b b7 23 d7 b0 e2  |.b/0......+.#...|
+00000030  1d f7 3b d7 f5 a1 27 b6  ee 24 b6 1b cc 5b ea 66  |..;...'..$...[.f|
+00000040  0d 6a f4 e5 85 f9 da 43  b4 0e 86 85 e1 f5 aa be  |.j.....C........|
+00000050  c8 ce 39 4c 9c 86 00 08  c2 4b e2 c6 ec 2f f7 ce  |..9L.....K.../..|
+00000060  e6 bd 77 82 6f 23 b6 e0  bd a2 92 b7 3a ac e8 56  |..w.o#......:..V|
+00000070  f1 af 54 5e 46 87 e9 3b  33 e7 b8 28 b7 d6 c8 90  |..T^F..;3..(....|
+00000080  35 d4 1c 43 d1 30 6f 55  4e 0a 70 14 03 03 00 01  |5..C.0oUN.p.....|
+00000090  01 16 03 03 00 24 6e bd  04 e6 9f 42 97 d8 e5 c8  |.....$n....B....|
+000000a0  53 80 41 35 a7 f3 a3 9e  88 13 37 ac 51 25 c2 87  |S.A5......7.Q%..|
+000000b0  29 4a e1 e4 eb 2b 31 a3  8b 0b                    |)J...+1...|
+>>> Flow 4 (server to client)
+00000000  14 03 03 00 01 01 16 03  03 00 24 60 22 7f 1b 4d  |..........$`"..M|
+00000010  75 6a c3 d3 d6 7c 18 f5  94 b1 4b 80 b8 7c a5 1b  |uj...|....K..|..|
+00000020  8c 45 f0 b6 e7 8a 65 82  69 0f c0 0f 9b 71 ea     |.E....e.i....q.|
+>>> Flow 5 (client to server)
+00000000  17 03 03 00 1a 3a 50 9f  29 c9 86 ec 81 79 f0 86  |.....:P.)....y..|
+00000010  25 03 5b 0c dd a6 f7 d6  e0 ad dc bc eb 37 c7 15  |%.[..........7..|
+00000020  03 03 00 16 89 31 da 0a  95 7a 42 54 81 85 de 9f  |.....1...zBT....|
+00000030  ff 9f 7e 13 28 3a f6 84  40 24                    |..~.(:..@$|
diff --git a/src/pkg/crypto/tls/testdata/Server-SSLv3-RSA-3DES b/src/pkg/crypto/tls/testdata/Server-SSLv3-RSA-3DES
new file mode 100644
index 0000000000..28bb242216
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Server-SSLv3-RSA-3DES
@@ -0,0 +1,82 @@
+>>> Flow 1 (client to server)
+00000000  16 03 00 00 30 01 00 00  2c 03 00 52 ac 77 f8 ba  |....0...,..R.w..|
+00000010  20 7c b1 a6 c2 a5 5e 1b  b6 76 26 88 79 9b 52 56  | |....^..v&.y.RV|
+00000020  f4 f5 83 1e 23 be 66 6c  47 70 ed 00 00 04 00 0a  |....#.flGp......|
+00000030  00 ff 02 01 00                                    |.....|
+>>> Flow 2 (server to client)
+00000000  16 03 00 00 2a 02 00 00  26 03 00 00 00 00 00 00  |....*...&.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 0a 00 16  |................|
+00000030  03 00 02 be 0b 00 02 ba  00 02 b7 00 02 b4 30 82  |..............0.|
+00000040  02 b0 30 82 02 19 a0 03  02 01 02 02 09 00 85 b0  |..0.............|
+00000050  bb a4 8a 7f b8 ca 30 0d  06 09 2a 86 48 86 f7 0d  |......0...*.H...|
+00000060  01 01 05 05 00 30 45 31  0b 30 09 06 03 55 04 06  |.....0E1.0...U..|
+00000070  13 02 41 55 31 13 30 11  06 03 55 04 08 13 0a 53  |..AU1.0...U....S|
+00000080  6f 6d 65 2d 53 74 61 74  65 31 21 30 1f 06 03 55  |ome-State1!0...U|
+00000090  04 0a 13 18 49 6e 74 65  72 6e 65 74 20 57 69 64  |....Internet Wid|
+000000a0  67 69 74 73 20 50 74 79  20 4c 74 64 30 1e 17 0d  |gits Pty Ltd0...|
+000000b0  31 30 30 34 32 34 30 39  30 39 33 38 5a 17 0d 31  |100424090938Z..1|
+000000c0  31 30 34 32 34 30 39 30  39 33 38 5a 30 45 31 0b  |10424090938Z0E1.|
+000000d0  30 09 06 03 55 04 06 13  02 41 55 31 13 30 11 06  |0...U....AU1.0..|
+000000e0  03 55 04 08 13 0a 53 6f  6d 65 2d 53 74 61 74 65  |.U....Some-State|
+000000f0  31 21 30 1f 06 03 55 04  0a 13 18 49 6e 74 65 72  |1!0...U....Inter|
+00000100  6e 65 74 20 57 69 64 67  69 74 73 20 50 74 79 20  |net Widgits Pty |
+00000110  4c 74 64 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |Ltd0..0...*.H...|
+00000120  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+00000130  bb 79 d6 f5 17 b5 e5 bf  46 10 d0 dc 69 be e6 2b  |.y......F...i..+|
+00000140  07 43 5a d0 03 2d 8a 7a  43 85 b7 14 52 e7 a5 65  |.CZ..-.zC...R..e|
+00000150  4c 2c 78 b8 23 8c b5 b4  82 e5 de 1f 95 3b 7e 62  |L,x.#........;~b|
+00000160  a5 2c a5 33 d6 fe 12 5c  7a 56 fc f5 06 bf fa 58  |.,.3...\zV.....X|
+00000170  7b 26 3f b5 cd 04 d3 d0  c9 21 96 4a c7 f4 54 9f  |{&?......!.J..T.|
+00000180  5a bf ef 42 71 00 fe 18  99 07 7f 7e 88 7d 7d f1  |Z..Bq......~.}}.|
+00000190  04 39 c4 a2 2e db 51 c9  7c e3 c0 4c 3b 32 66 01  |.9....Q.|..L;2f.|
+000001a0  cf af b1 1d b8 71 9a 1d  db db 89 6b ae da 2d 79  |.....q.....k..-y|
+000001b0  02 03 01 00 01 a3 81 a7  30 81 a4 30 1d 06 03 55  |........0..0...U|
+000001c0  1d 0e 04 16 04 14 b1 ad  e2 85 5a cf cb 28 db 69  |..........Z..(.i|
+000001d0  ce 23 69 de d3 26 8e 18  88 39 30 75 06 03 55 1d  |.#i..&...90u..U.|
+000001e0  23 04 6e 30 6c 80 14 b1  ad e2 85 5a cf cb 28 db  |#.n0l......Z..(.|
+000001f0  69 ce 23 69 de d3 26 8e  18 88 39 a1 49 a4 47 30  |i.#i..&...9.I.G0|
+00000200  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+00000210  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+00000220  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+00000230  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+00000240  74 79 20 4c 74 64 82 09  00 85 b0 bb a4 8a 7f b8  |ty Ltd..........|
+00000250  ca 30 0c 06 03 55 1d 13  04 05 30 03 01 01 ff 30  |.0...U....0....0|
+00000260  0d 06 09 2a 86 48 86 f7  0d 01 01 05 05 00 03 81  |...*.H..........|
+00000270  81 00 08 6c 45 24 c7 6b  b1 59 ab 0c 52 cc f2 b0  |...lE$.k.Y..R...|
+00000280  14 d7 87 9d 7a 64 75 b5  5a 95 66 e4 c5 2b 8e ae  |....zdu.Z.f..+..|
+00000290  12 66 1f eb 4f 38 b3 6e  60 d3 92 fd f7 41 08 b5  |.f..O8.n`....A..|
+000002a0  25 13 b1 18 7a 24 fb 30  1d ba ed 98 b9 17 ec e7  |%...z$.0........|
+000002b0  d7 31 59 db 95 d3 1d 78  ea 50 56 5c d5 82 5a 2d  |.1Y....x.PV\..Z-|
+000002c0  5a 5f 33 c4 b6 d8 c9 75  90 96 8c 0f 52 98 b5 cd  |Z_3....u....R...|
+000002d0  98 1f 89 20 5f f2 a0 1c  a3 1b 96 94 dd a9 fd 57  |... _..........W|
+000002e0  e9 70 e8 26 6d 71 99 9b  26 6e 38 50 29 6c 90 a7  |.p.&mq..&n8P)l..|
+000002f0  bd d9 16 03 00 00 04 0e  00 00 00                 |...........|
+>>> Flow 3 (client to server)
+00000000  16 03 00 00 84 10 00 00  80 b6 25 91 8f 12 fc a2  |..........%.....|
+00000010  b9 f1 31 3a b5 a8 b6 cf  aa f1 b4 83 3d aa f1 1d  |..1:........=...|
+00000020  de 33 e4 25 6a 49 25 71  e9 9d 51 97 3b 9d 2a 68  |.3.%jI%q..Q.;.*h|
+00000030  84 13 3a e7 2c 97 67 36  ee 23 a9 97 6d c2 3a e5  |..:.,.g6.#..m.:.|
+00000040  33 24 37 ce 76 ed a1 8f  f8 49 e4 b8 77 2a ef 9a  |3$7.v....I..w*..|
+00000050  38 3c 4f d1 88 7b 28 1b  3a 90 4b 6b 67 8f 04 f0  |8<O..{(.:.Kkg...|
+00000060  cd d4 b7 ab a2 42 86 e9  45 38 dd 78 4c 9f fb 10  |.....B..E8.xL...|
+00000070  3c 65 35 8e f5 bc 3a 28  e1 cb 86 44 e8 bc 29 26  |<e5...:(...D..)&|
+00000080  fc 43 be 15 f2 5b e7 07  82 14 03 00 00 01 01 16  |.C...[..........|
+00000090  03 00 00 40 3d db ec d5  66 0d 92 2f 23 36 3e e6  |...@=...f../#6>.|
+000000a0  ac ee 10 8d db 11 ce dc  65 e7 cb ba 14 4d 81 34  |........e....M.4|
+000000b0  46 eb 6e fd 5e 36 20 32  bd 59 05 b6 39 a1 86 31  |F.n.^6 2.Y..9..1|
+000000c0  24 ef 53 64 0a 7a 91 95  c1 e3 aa bb 48 08 ac 22  |$.Sd.z......H.."|
+000000d0  6e 1c df e1                                       |n...|
+>>> Flow 4 (server to client)
+00000000  14 03 00 00 01 01 16 03  00 00 40 c1 e3 a0 4d 7d  |..........@...M}|
+00000010  02 0b dc 0a 12 8c 2c 5c  c4 d4 b9 76 b8 a3 dc 9a  |......,\...v....|
+00000020  7d 3a 08 a6 b6 c9 00 8b  ee b7 e6 8e 72 3c e0 07  |}:..........r<..|
+00000030  28 07 20 a7 7a 93 1a de  63 af bd 80 2b 66 74 d9  |(. .z...c...+ft.|
+00000040  d8 ef 7c 56 cd 0f c4 bf  b4 7d cc 17 03 00 00 18  |..|V.....}......|
+00000050  18 d2 23 27 f9 89 7c 47  8a a8 92 32 26 4e 7d c6  |..#'..|G...2&N}.|
+00000060  59 44 71 b3 c9 ca 31 63  17 03 00 00 28 24 09 c1  |YDq...1c....($..|
+00000070  98 2e 4c 4b 80 66 b5 cb  20 01 0f 23 06 44 be 23  |..LK.f.. ..#.D.#|
+00000080  32 0e bc e4 c1 b5 b4 f0  e3 53 5a 69 fb ae 3b 92  |2........SZi..;.|
+00000090  29 c9 b6 cf 5d 15 03 00  00 18 ec 3e e9 e6 4e 7e  |)...]......>..N~|
+000000a0  4d 8f b7 74 93 61 f4 85  28 5f e6 37 2d 9f 01 54  |M..t.a..(_.7-..T|
+000000b0  bd 24                                             |.$|
diff --git a/src/pkg/crypto/tls/testdata/Server-SSLv3-RSA-AES b/src/pkg/crypto/tls/testdata/Server-SSLv3-RSA-AES
new file mode 100644
index 0000000000..515ebac23a
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Server-SSLv3-RSA-AES
@@ -0,0 +1,83 @@
+>>> Flow 1 (client to server)
+00000000  16 03 00 00 30 01 00 00  2c 03 00 52 ac 77 f8 f2  |....0...,..R.w..|
+00000010  8a e8 25 e4 df f9 db 01  25 d2 14 4b 10 25 b8 f7  |..%.....%..K.%..|
+00000020  86 b3 83 32 96 e8 af 50  93 78 8d 00 00 04 00 2f  |...2...P.x...../|
+00000030  00 ff 02 01 00                                    |.....|
+>>> Flow 2 (server to client)
+00000000  16 03 00 00 2a 02 00 00  26 03 00 00 00 00 00 00  |....*...&.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2f 00 16  |............./..|
+00000030  03 00 02 be 0b 00 02 ba  00 02 b7 00 02 b4 30 82  |..............0.|
+00000040  02 b0 30 82 02 19 a0 03  02 01 02 02 09 00 85 b0  |..0.............|
+00000050  bb a4 8a 7f b8 ca 30 0d  06 09 2a 86 48 86 f7 0d  |......0...*.H...|
+00000060  01 01 05 05 00 30 45 31  0b 30 09 06 03 55 04 06  |.....0E1.0...U..|
+00000070  13 02 41 55 31 13 30 11  06 03 55 04 08 13 0a 53  |..AU1.0...U....S|
+00000080  6f 6d 65 2d 53 74 61 74  65 31 21 30 1f 06 03 55  |ome-State1!0...U|
+00000090  04 0a 13 18 49 6e 74 65  72 6e 65 74 20 57 69 64  |....Internet Wid|
+000000a0  67 69 74 73 20 50 74 79  20 4c 74 64 30 1e 17 0d  |gits Pty Ltd0...|
+000000b0  31 30 30 34 32 34 30 39  30 39 33 38 5a 17 0d 31  |100424090938Z..1|
+000000c0  31 30 34 32 34 30 39 30  39 33 38 5a 30 45 31 0b  |10424090938Z0E1.|
+000000d0  30 09 06 03 55 04 06 13  02 41 55 31 13 30 11 06  |0...U....AU1.0..|
+000000e0  03 55 04 08 13 0a 53 6f  6d 65 2d 53 74 61 74 65  |.U....Some-State|
+000000f0  31 21 30 1f 06 03 55 04  0a 13 18 49 6e 74 65 72  |1!0...U....Inter|
+00000100  6e 65 74 20 57 69 64 67  69 74 73 20 50 74 79 20  |net Widgits Pty |
+00000110  4c 74 64 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |Ltd0..0...*.H...|
+00000120  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+00000130  bb 79 d6 f5 17 b5 e5 bf  46 10 d0 dc 69 be e6 2b  |.y......F...i..+|
+00000140  07 43 5a d0 03 2d 8a 7a  43 85 b7 14 52 e7 a5 65  |.CZ..-.zC...R..e|
+00000150  4c 2c 78 b8 23 8c b5 b4  82 e5 de 1f 95 3b 7e 62  |L,x.#........;~b|
+00000160  a5 2c a5 33 d6 fe 12 5c  7a 56 fc f5 06 bf fa 58  |.,.3...\zV.....X|
+00000170  7b 26 3f b5 cd 04 d3 d0  c9 21 96 4a c7 f4 54 9f  |{&?......!.J..T.|
+00000180  5a bf ef 42 71 00 fe 18  99 07 7f 7e 88 7d 7d f1  |Z..Bq......~.}}.|
+00000190  04 39 c4 a2 2e db 51 c9  7c e3 c0 4c 3b 32 66 01  |.9....Q.|..L;2f.|
+000001a0  cf af b1 1d b8 71 9a 1d  db db 89 6b ae da 2d 79  |.....q.....k..-y|
+000001b0  02 03 01 00 01 a3 81 a7  30 81 a4 30 1d 06 03 55  |........0..0...U|
+000001c0  1d 0e 04 16 04 14 b1 ad  e2 85 5a cf cb 28 db 69  |..........Z..(.i|
+000001d0  ce 23 69 de d3 26 8e 18  88 39 30 75 06 03 55 1d  |.#i..&...90u..U.|
+000001e0  23 04 6e 30 6c 80 14 b1  ad e2 85 5a cf cb 28 db  |#.n0l......Z..(.|
+000001f0  69 ce 23 69 de d3 26 8e  18 88 39 a1 49 a4 47 30  |i.#i..&...9.I.G0|
+00000200  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+00000210  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+00000220  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+00000230  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+00000240  74 79 20 4c 74 64 82 09  00 85 b0 bb a4 8a 7f b8  |ty Ltd..........|
+00000250  ca 30 0c 06 03 55 1d 13  04 05 30 03 01 01 ff 30  |.0...U....0....0|
+00000260  0d 06 09 2a 86 48 86 f7  0d 01 01 05 05 00 03 81  |...*.H..........|
+00000270  81 00 08 6c 45 24 c7 6b  b1 59 ab 0c 52 cc f2 b0  |...lE$.k.Y..R...|
+00000280  14 d7 87 9d 7a 64 75 b5  5a 95 66 e4 c5 2b 8e ae  |....zdu.Z.f..+..|
+00000290  12 66 1f eb 4f 38 b3 6e  60 d3 92 fd f7 41 08 b5  |.f..O8.n`....A..|
+000002a0  25 13 b1 18 7a 24 fb 30  1d ba ed 98 b9 17 ec e7  |%...z$.0........|
+000002b0  d7 31 59 db 95 d3 1d 78  ea 50 56 5c d5 82 5a 2d  |.1Y....x.PV\..Z-|
+000002c0  5a 5f 33 c4 b6 d8 c9 75  90 96 8c 0f 52 98 b5 cd  |Z_3....u....R...|
+000002d0  98 1f 89 20 5f f2 a0 1c  a3 1b 96 94 dd a9 fd 57  |... _..........W|
+000002e0  e9 70 e8 26 6d 71 99 9b  26 6e 38 50 29 6c 90 a7  |.p.&mq..&n8P)l..|
+000002f0  bd d9 16 03 00 00 04 0e  00 00 00                 |...........|
+>>> Flow 3 (client to server)
+00000000  16 03 00 00 84 10 00 00  80 00 0a a1 56 18 df ac  |............V...|
+00000010  c2 e2 64 41 17 df 7f 05  29 0a 72 65 46 ea c9 ff  |..dA....).reF...|
+00000020  c6 67 75 62 9a e8 46 05  e3 08 1a 14 ea e7 ff 35  |.gub..F........5|
+00000030  a8 d1 fa 96 cc e2 d8 d9  7a a3 40 64 37 96 54 29  |........z.@d7.T)|
+00000040  ad 72 7c 98 13 de c3 a8  fb c6 4a 6e 2a 8b e7 5f  |.r|.......Jn*.._|
+00000050  ef f3 c5 76 7f fb b3 24  ed 80 57 b6 ce 0e 53 65  |...v...$..W...Se|
+00000060  2b db da fd a5 6a ee 46  b4 2e 26 8c 53 d5 67 d4  |+....j.F..&.S.g.|
+00000070  8a 4c 56 58 40 68 7d b5  d7 51 f3 05 1f 68 b5 54  |.LVX@h}..Q...h.T|
+00000080  f5 91 86 71 cd 3c 6d 0a  d6 14 03 00 00 01 01 16  |...q.<m.........|
+00000090  03 00 00 40 1c 55 bc ea  55 12 63 36 f2 1a f4 ae  |...@.U..U.c6....|
+000000a0  34 51 d6 d0 63 e1 13 4c  d9 a0 a9 ac 3b cb 1e e4  |4Q..c..L....;...|
+000000b0  de 21 f7 bf ae 7f 27 31  cb 01 58 e4 b1 57 00 39  |.!....'1..X..W.9|
+000000c0  13 e0 e3 be 2b b1 24 cc  41 55 69 c4 f0 a6 cc 38  |....+.$.AUi....8|
+000000d0  e8 a8 ba c1                                       |....|
+>>> Flow 4 (server to client)
+00000000  14 03 00 00 01 01 16 03  00 00 40 68 cb f5 14 f0  |..........@h....|
+00000010  42 7a 8c d6 69 09 37 24  92 82 ef 78 bb 4f f9 86  |Bz..i.7$...x.O..|
+00000020  9f f1 db 3c da 97 f1 02  ab f0 9d c9 8a 71 8e b4  |...<.........q..|
+00000030  ac 6f 83 1a 44 90 80 a3  3b 97 a2 7f 64 b9 63 b1  |.o..D...;...d.c.|
+00000040  6b 80 2a a5 5f 2d c3 14  b6 d5 0c 17 03 00 00 20  |k.*._-......... |
+00000050  b1 d5 04 a3 c4 05 f9 8d  96 84 78 a6 cb 8e 0a 04  |..........x.....|
+00000060  a9 e3 97 f9 dc f0 7a 7d  f5 44 0e e5 eb 80 83 9a  |......z}.D......|
+00000070  17 03 00 00 30 8d c7 b7  e4 ac 13 79 cc fb f8 74  |....0......y...t|
+00000080  00 cb 89 5c b0 fb bd 3c  f6 9f e0 72 02 34 4f d2  |...\...<...r.4O.|
+00000090  f5 6e 29 da 14 d2 11 45  85 dd ae 72 8e b6 4e eb  |.n)....E...r..N.|
+000000a0  56 cb a9 33 fd 15 03 00  00 20 10 46 5e 81 a1 29  |V..3..... .F^..)|
+000000b0  69 2b 66 52 6c d9 4b 8f  79 c0 7f d9 13 8a 67 99  |i+fRl.K.y.....g.|
+000000c0  14 b2 eb a8 2a 2e 2d b0  0f 5a                    |....*.-..Z|
diff --git a/src/pkg/crypto/tls/testdata/Server-SSLv3-RSA-RC4 b/src/pkg/crypto/tls/testdata/Server-SSLv3-RSA-RC4
new file mode 100644
index 0000000000..15c0e22132
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Server-SSLv3-RSA-RC4
@@ -0,0 +1,78 @@
+>>> Flow 1 (client to server)
+00000000  16 03 00 00 30 01 00 00  2c 03 00 52 ac 77 f8 34  |....0...,..R.w.4|
+00000010  e1 b1 2e 93 67 6d 6e 49  b5 9d 74 06 e1 1b 73 92  |....gmnI..t...s.|
+00000020  0f c3 39 5f 4b 17 88 45  84 28 fd 00 00 04 00 05  |..9_K..E.(......|
+00000030  00 ff 02 01 00                                    |.....|
+>>> Flow 2 (server to client)
+00000000  16 03 00 00 2a 02 00 00  26 03 00 00 00 00 00 00  |....*...&.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 05 00 16  |................|
+00000030  03 00 02 be 0b 00 02 ba  00 02 b7 00 02 b4 30 82  |..............0.|
+00000040  02 b0 30 82 02 19 a0 03  02 01 02 02 09 00 85 b0  |..0.............|
+00000050  bb a4 8a 7f b8 ca 30 0d  06 09 2a 86 48 86 f7 0d  |......0...*.H...|
+00000060  01 01 05 05 00 30 45 31  0b 30 09 06 03 55 04 06  |.....0E1.0...U..|
+00000070  13 02 41 55 31 13 30 11  06 03 55 04 08 13 0a 53  |..AU1.0...U....S|
+00000080  6f 6d 65 2d 53 74 61 74  65 31 21 30 1f 06 03 55  |ome-State1!0...U|
+00000090  04 0a 13 18 49 6e 74 65  72 6e 65 74 20 57 69 64  |....Internet Wid|
+000000a0  67 69 74 73 20 50 74 79  20 4c 74 64 30 1e 17 0d  |gits Pty Ltd0...|
+000000b0  31 30 30 34 32 34 30 39  30 39 33 38 5a 17 0d 31  |100424090938Z..1|
+000000c0  31 30 34 32 34 30 39 30  39 33 38 5a 30 45 31 0b  |10424090938Z0E1.|
+000000d0  30 09 06 03 55 04 06 13  02 41 55 31 13 30 11 06  |0...U....AU1.0..|
+000000e0  03 55 04 08 13 0a 53 6f  6d 65 2d 53 74 61 74 65  |.U....Some-State|
+000000f0  31 21 30 1f 06 03 55 04  0a 13 18 49 6e 74 65 72  |1!0...U....Inter|
+00000100  6e 65 74 20 57 69 64 67  69 74 73 20 50 74 79 20  |net Widgits Pty |
+00000110  4c 74 64 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |Ltd0..0...*.H...|
+00000120  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+00000130  bb 79 d6 f5 17 b5 e5 bf  46 10 d0 dc 69 be e6 2b  |.y......F...i..+|
+00000140  07 43 5a d0 03 2d 8a 7a  43 85 b7 14 52 e7 a5 65  |.CZ..-.zC...R..e|
+00000150  4c 2c 78 b8 23 8c b5 b4  82 e5 de 1f 95 3b 7e 62  |L,x.#........;~b|
+00000160  a5 2c a5 33 d6 fe 12 5c  7a 56 fc f5 06 bf fa 58  |.,.3...\zV.....X|
+00000170  7b 26 3f b5 cd 04 d3 d0  c9 21 96 4a c7 f4 54 9f  |{&?......!.J..T.|
+00000180  5a bf ef 42 71 00 fe 18  99 07 7f 7e 88 7d 7d f1  |Z..Bq......~.}}.|
+00000190  04 39 c4 a2 2e db 51 c9  7c e3 c0 4c 3b 32 66 01  |.9....Q.|..L;2f.|
+000001a0  cf af b1 1d b8 71 9a 1d  db db 89 6b ae da 2d 79  |.....q.....k..-y|
+000001b0  02 03 01 00 01 a3 81 a7  30 81 a4 30 1d 06 03 55  |........0..0...U|
+000001c0  1d 0e 04 16 04 14 b1 ad  e2 85 5a cf cb 28 db 69  |..........Z..(.i|
+000001d0  ce 23 69 de d3 26 8e 18  88 39 30 75 06 03 55 1d  |.#i..&...90u..U.|
+000001e0  23 04 6e 30 6c 80 14 b1  ad e2 85 5a cf cb 28 db  |#.n0l......Z..(.|
+000001f0  69 ce 23 69 de d3 26 8e  18 88 39 a1 49 a4 47 30  |i.#i..&...9.I.G0|
+00000200  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+00000210  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+00000220  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+00000230  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+00000240  74 79 20 4c 74 64 82 09  00 85 b0 bb a4 8a 7f b8  |ty Ltd..........|
+00000250  ca 30 0c 06 03 55 1d 13  04 05 30 03 01 01 ff 30  |.0...U....0....0|
+00000260  0d 06 09 2a 86 48 86 f7  0d 01 01 05 05 00 03 81  |...*.H..........|
+00000270  81 00 08 6c 45 24 c7 6b  b1 59 ab 0c 52 cc f2 b0  |...lE$.k.Y..R...|
+00000280  14 d7 87 9d 7a 64 75 b5  5a 95 66 e4 c5 2b 8e ae  |....zdu.Z.f..+..|
+00000290  12 66 1f eb 4f 38 b3 6e  60 d3 92 fd f7 41 08 b5  |.f..O8.n`....A..|
+000002a0  25 13 b1 18 7a 24 fb 30  1d ba ed 98 b9 17 ec e7  |%...z$.0........|
+000002b0  d7 31 59 db 95 d3 1d 78  ea 50 56 5c d5 82 5a 2d  |.1Y....x.PV\..Z-|
+000002c0  5a 5f 33 c4 b6 d8 c9 75  90 96 8c 0f 52 98 b5 cd  |Z_3....u....R...|
+000002d0  98 1f 89 20 5f f2 a0 1c  a3 1b 96 94 dd a9 fd 57  |... _..........W|
+000002e0  e9 70 e8 26 6d 71 99 9b  26 6e 38 50 29 6c 90 a7  |.p.&mq..&n8P)l..|
+000002f0  bd d9 16 03 00 00 04 0e  00 00 00                 |...........|
+>>> Flow 3 (client to server)
+00000000  16 03 00 00 84 10 00 00  80 a0 f8 7e 56 69 88 3a  |...........~Vi.:|
+00000010  75 b6 bc 7f 3f a5 15 0c  7a 33 7c 3d c9 84 ce 06  |u...?...z3|=....|
+00000020  52 a4 c3 47 8d 91 c1 0d  27 b6 56 a8 92 b8 b5 2c  |R..G....'.V....,|
+00000030  6b 19 54 3f 14 e2 d8 b5  39 6a 53 0a ba 3d 7f bc  |k.T?....9jS..=..|
+00000040  69 e5 fd 93 88 15 84 27  ea e0 ef f3 6b 17 5c 07  |i......'....k.\.|
+00000050  76 5f 71 0f 3e 94 d3 7b  2f 63 88 03 5e 79 28 d9  |v_q.>..{/c..^y(.|
+00000060  e8 c7 fc 65 b1 5a a3 91  1c fe cc a3 f6 13 d3 a2  |...e.Z..........|
+00000070  7c e0 5f 51 97 a3 a7 32  14 c5 d4 fa 09 5d de 04  ||._Q...2.....]..|
+00000080  59 7d 78 af 1e e5 d9 99  68 14 03 00 00 01 01 16  |Y}x.....h.......|
+00000090  03 00 00 3c de c0 8f 60  be 89 4f 61 5e 88 72 50  |...<...`..Oa^.rP|
+000000a0  b4 c8 e0 ff 9d 91 2e c4  ba 11 3e fb 92 ba dd ab  |..........>.....|
+000000b0  96 ba 56 91 78 70 f6 fe  73 fb a3 85 47 28 9e 57  |..V.xp..s...G(.W|
+000000c0  80 18 f0 e7 44 d6 0c a6  6e 5a 03 9e c1 7a f3 a4  |....D...nZ...z..|
+>>> Flow 4 (server to client)
+00000000  14 03 00 00 01 01 16 03  00 00 3c 8e ae 6b 37 56  |..........<..k7V|
+00000010  42 96 37 76 e9 48 a0 4d  67 5e e9 e0 48 4e 75 4d  |B.7v.H.Mg^..HNuM|
+00000020  a8 58 01 a5 e5 c2 0c ec  43 ae a1 86 8d 0f be fc  |.X......C.......|
+00000030  de c3 5c 15 c3 84 fc ed  6a 48 6f dd 22 94 4f 54  |..\.....jHo.".OT|
+00000040  83 ab 76 ab 38 ea a1 17  03 00 00 21 64 56 94 f9  |..v.8......!dV..|
+00000050  ba 22 a3 af 63 30 16 b0  23 54 e2 22 92 4e 67 5d  |."..c0..#T.".Ng]|
+00000060  a2 37 92 83 1f 28 78 bb  02 6b fe 4d de 15 03 00  |.7...(x..k.M....|
+00000070  00 16 c3 1b bb 58 03 ce  44 9b 3c 6e e9 75 ba 66  |.....X..D.<n.u.f|
+00000080  1c 03 08 19 75 64 9c 98                           |....ud..|
diff --git a/src/pkg/crypto/tls/testdata/Server-TLSv10-ECDHE-ECDSA-AES b/src/pkg/crypto/tls/testdata/Server-TLSv10-ECDHE-ECDSA-AES
new file mode 100644
index 0000000000..e824b152fe
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Server-TLSv10-ECDHE-ECDSA-AES
@@ -0,0 +1,92 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 77 01 00 00  73 03 01 52 ac 77 f8 0f  |....w...s..R.w..|
+00000010  da f5 85 29 f9 40 1c fd  b5 88 59 30 92 9d 24 66  |...).@....Y0..$f|
+00000020  d5 14 a0 f2 f3 31 5f 55  a2 6e 49 00 00 04 c0 0a  |.....1_U.nI.....|
+00000030  00 ff 02 01 00 00 45 00  0b 00 04 03 00 01 02 00  |......E.........|
+00000040  0a 00 34 00 32 00 0e 00  0d 00 19 00 0b 00 0c 00  |..4.2...........|
+00000050  18 00 09 00 0a 00 16 00  17 00 08 00 06 00 07 00  |................|
+00000060  14 00 15 00 04 00 05 00  12 00 13 00 01 00 02 00  |................|
+00000070  03 00 0f 00 10 00 11 00  0f 00 01 01              |............|
+>>> Flow 2 (server to client)
+00000000  16 03 01 00 2a 02 00 00  26 03 01 00 00 00 00 00  |....*...&.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 c0 0a 00 16  |................|
+00000030  03 01 02 0e 0b 00 02 0a  00 02 07 00 02 04 30 82  |..............0.|
+00000040  02 00 30 82 01 62 02 09  00 b8 bf 2d 47 a0 d2 eb  |..0..b.....-G...|
+00000050  f4 30 09 06 07 2a 86 48  ce 3d 04 01 30 45 31 0b  |.0...*.H.=..0E1.|
+00000060  30 09 06 03 55 04 06 13  02 41 55 31 13 30 11 06  |0...U....AU1.0..|
+00000070  03 55 04 08 13 0a 53 6f  6d 65 2d 53 74 61 74 65  |.U....Some-State|
+00000080  31 21 30 1f 06 03 55 04  0a 13 18 49 6e 74 65 72  |1!0...U....Inter|
+00000090  6e 65 74 20 57 69 64 67  69 74 73 20 50 74 79 20  |net Widgits Pty |
+000000a0  4c 74 64 30 1e 17 0d 31  32 31 31 32 32 31 35 30  |Ltd0...121122150|
+000000b0  36 33 32 5a 17 0d 32 32  31 31 32 30 31 35 30 36  |632Z..2211201506|
+000000c0  33 32 5a 30 45 31 0b 30  09 06 03 55 04 06 13 02  |32Z0E1.0...U....|
+000000d0  41 55 31 13 30 11 06 03  55 04 08 13 0a 53 6f 6d  |AU1.0...U....Som|
+000000e0  65 2d 53 74 61 74 65 31  21 30 1f 06 03 55 04 0a  |e-State1!0...U..|
+000000f0  13 18 49 6e 74 65 72 6e  65 74 20 57 69 64 67 69  |..Internet Widgi|
+00000100  74 73 20 50 74 79 20 4c  74 64 30 81 9b 30 10 06  |ts Pty Ltd0..0..|
+00000110  07 2a 86 48 ce 3d 02 01  06 05 2b 81 04 00 23 03  |.*.H.=....+...#.|
+00000120  81 86 00 04 00 c4 a1 ed  be 98 f9 0b 48 73 36 7e  |............Hs6~|
+00000130  c3 16 56 11 22 f2 3d 53  c3 3b 4d 21 3d cd 6b 75  |..V.".=S.;M!=.ku|
+00000140  e6 f6 b0 dc 9a df 26 c1  bc b2 87 f0 72 32 7c b3  |......&.....r2|.|
+00000150  64 2f 1c 90 bc ea 68 23  10 7e fe e3 25 c0 48 3a  |d/....h#.~..%.H:|
+00000160  69 e0 28 6d d3 37 00 ef  04 62 dd 0d a0 9c 70 62  |i.(m.7...b....pb|
+00000170  83 d8 81 d3 64 31 aa 9e  97 31 bd 96 b0 68 c0 9b  |....d1...1...h..|
+00000180  23 de 76 64 3f 1a 5c 7f  e9 12 0e 58 58 b6 5f 70  |#.vd?.\....XX._p|
+00000190  dd 9b d8 ea d5 d7 f5 d5  cc b9 b6 9f 30 66 5b 66  |............0f[f|
+000001a0  9a 20 e2 27 e5 bf fe 3b  30 09 06 07 2a 86 48 ce  |. .'...;0...*.H.|
+000001b0  3d 04 01 03 81 8c 00 30  81 88 02 42 01 88 a2 4f  |=......0...B...O|
+000001c0  eb e2 45 c5 48 7d 1b ac  f5 ed 98 9d ae 47 70 c0  |..E.H}.......Gp.|
+000001d0  5e 1b b6 2f bd f1 b6 4d  b7 61 40 d3 11 a2 ce ee  |^../...M.a@.....|
+000001e0  0b 7e 92 7e ff 76 9d c3  3b 7e a5 3f ce fa 10 e2  |.~.~.v..;~.?....|
+000001f0  59 ec 47 2d 7c ac da 4e  97 0e 15 a0 6f d0 02 42  |Y.G-|..N....o..B|
+00000200  01 4d fc be 67 13 9c 2d  05 0e bd 3f a3 8c 25 c1  |.M..g..-...?..%.|
+00000210  33 13 83 0d 94 06 bb d4  37 7a f6 ec 7a c9 86 2e  |3.......7z..z...|
+00000220  dd d7 11 69 7f 85 7c 56  de fb 31 78 2b e4 c7 78  |...i..|V..1x+..x|
+00000230  0d ae cb be 9e 4e 36 24  31 7b 6a 0f 39 95 12 07  |.....N6$1{j.9...|
+00000240  8f 2a 16 03 01 01 1a 0c  00 01 16 03 00 19 85 04  |.*..............|
+00000250  01 39 dc ee 44 17 5e db  d7 27 af b6 56 d9 b4 43  |.9..D.^..'..V..C|
+00000260  5a 99 cf aa 31 37 0c 6f  3a a0 f8 53 c4 74 d1 91  |Z...17.o:..S.t..|
+00000270  0a 46 f5 38 3b 5c 09 d8  97 dc 4b aa 70 26 48 f2  |.F.8;\....K.p&H.|
+00000280  d6 0b 31 c9 f8 d4 98 43  e1 6c d5 c7 b2 8e 0b 01  |..1....C.l......|
+00000290  e6 b6 00 28 80 7b fc 96  8f 0d a2 4f b0 79 af dc  |...(.{.....O.y..|
+000002a0  61 28 63 33 78 f6 31 39  fd 8a f4 15 18 11 fe db  |a(c3x.19........|
+000002b0  d5 07 da 2c ed 49 a0 23  bf d0 3a 38 1d 54 ae 1c  |...,.I.#..:8.T..|
+000002c0  7b ea 29 ee d0 38 c1 76  a7 7f 2a f4 ce 1e ac cc  |{.)..8.v..*.....|
+000002d0  94 79 90 33 00 8b 30 81  88 02 42 00 c6 85 8e 06  |.y.3..0...B.....|
+000002e0  b7 04 04 e9 cd 9e 3e cb  66 23 95 b4 42 9c 64 81  |......>.f#..B.d.|
+000002f0  39 05 3f b5 21 f8 28 af  60 6b 4d 3d ba a1 4b 5e  |9.?.!.(.`kM=..K^|
+00000300  77 ef e7 59 28 fe 1d c1  27 a2 ff a8 de 33 48 b3  |w..Y(...'....3H.|
+00000310  c1 85 6a 42 9b f9 7e 7e  31 c2 e5 bd 66 02 42 00  |..jB..~~1...f.B.|
+00000320  ad 7d 06 35 ab ec 8d ac  d4 ba 1b 49 5e 05 5f f0  |.}.5.......I^._.|
+00000330  97 93 82 b8 2b 8d 91 98  63 8e b4 14 62 db 1e c9  |....+...c...b...|
+00000340  2b 30 f8 41 9b a6 e6 bc  de 0e 68 30 21 d7 c5 13  |+0.A......h0!...|
+00000350  c5 0d 59 07 a1 c7 28 ca  0c e3 9b 45 fa d3 04 fb  |..Y...(....E....|
+00000360  31 16 03 01 00 04 0e 00  00 00                    |1.........|
+>>> Flow 3 (client to server)
+00000000  16 03 01 00 8a 10 00 00  86 85 04 00 dc a9 a1 fb  |................|
+00000010  01 f0 3c 35 4f f0 67 6c  7b de 7d dc 6e bb 59 6f  |..<5O.gl{.}.n.Yo|
+00000020  5b 42 57 b1 55 c6 78 28  69 cb c5 c0 c1 e3 b5 89  |[BW.U.x(i.......|
+00000030  dd 03 20 6b d2 08 17 50  68 11 64 ad 0c 2f aa 4f  |.. k...Ph.d../.O|
+00000040  df ea e1 b9 1a 3c 92 ec  e7 78 f4 19 f8 01 77 e0  |.....<...x....w.|
+00000050  e2 c5 a2 d1 39 e3 e4 6b  78 0c 70 ae d4 2b 9f e4  |....9..kx.p..+..|
+00000060  79 a2 ab 23 82 9e ec 3c  7c 62 f1 66 b9 9a 06 4f  |y..#...<|b.f...O|
+00000070  49 a0 39 79 b4 32 7a 38  0e 6c ec e0 aa fc e2 d9  |I.9y.2z8.l......|
+00000080  fe 2a c0 88 bc 9c 29 8c  78 06 bb bc 5d 0f 01 14  |.*....).x...]...|
+00000090  03 01 00 01 01 16 03 01  00 30 76 33 00 79 15 52  |.........0v3.y.R|
+000000a0  12 d8 c0 34 74 b3 50 76  98 e3 29 db 30 9c 82 1f  |...4t.Pv..).0...|
+000000b0  89 47 b7 ab 26 bc 19 d8  b1 49 7b f8 d2 71 88 b0  |.G..&....I{..q..|
+000000c0  05 c4 0d 96 54 d2 61 c4  ad b8                    |....T.a...|
+>>> Flow 4 (server to client)
+00000000  14 03 01 00 01 01 16 03  01 00 30 7a 2a 1b a8 08  |..........0z*...|
+00000010  56 fa a3 93 04 45 31 8d  8b 9b 55 36 bb 5b 18 53  |V....E1...U6.[.S|
+00000020  b5 da d6 9f 51 89 a5 b5  ff 8d 26 24 df 05 1e 09  |....Q.....&$....|
+00000030  ee 7d 59 d3 e0 8b 9b d7  10 93 ce 17 03 01 00 20  |.}Y............ |
+00000040  b0 68 94 01 e0 38 37 6d  5c 4e ec 9d 77 f7 e6 a8  |.h...87m\N..w...|
+00000050  1a 06 bd ec 9f a2 63 ce  25 10 d2 ad 48 00 30 8f  |......c.%...H.0.|
+00000060  17 03 01 00 30 6f c4 67  87 d4 b2 1e 32 31 44 23  |....0o.g....21D#|
+00000070  54 45 95 99 16 7a 83 32  86 75 5d 14 d1 ae 65 3c  |TE...z.2.u]...e<|
+00000080  71 2c c7 ca 84 4a ea 1d  6a 54 33 6f d6 38 21 4d  |q,...J..jT3o.8!M|
+00000090  e0 6c 64 a9 58 15 03 01  00 20 8f 9e 96 b1 74 b0  |.ld.X.... ....t.|
+000000a0  93 1e 6b ba c3 ce 53 f5  0a 11 ae cb 08 ac 1d 2c  |..k...S........,|
+000000b0  e4 79 9a 6b bf fb db 0b  29 a1                    |.y.k....).|
diff --git a/src/pkg/crypto/tls/testdata/Server-TLSv10-RSA-3DES b/src/pkg/crypto/tls/testdata/Server-TLSv10-RSA-3DES
new file mode 100644
index 0000000000..a93c2dbcc4
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Server-TLSv10-RSA-3DES
@@ -0,0 +1,78 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 37 01 00 00  33 03 01 52 ac 77 f8 13  |....7...3..R.w..|
+00000010  46 58 6c 7e 9a 3d 5b 13  de 27 23 60 5a a9 8e 0b  |FXl~.=[..'#`Z...|
+00000020  b9 f0 f8 f9 ad d5 fc f9  c2 50 10 00 00 04 00 0a  |.........P......|
+00000030  00 ff 02 01 00 00 05 00  0f 00 01 01              |............|
+>>> Flow 2 (server to client)
+00000000  16 03 01 00 2a 02 00 00  26 03 01 00 00 00 00 00  |....*...&.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 0a 00 16  |................|
+00000030  03 01 02 be 0b 00 02 ba  00 02 b7 00 02 b4 30 82  |..............0.|
+00000040  02 b0 30 82 02 19 a0 03  02 01 02 02 09 00 85 b0  |..0.............|
+00000050  bb a4 8a 7f b8 ca 30 0d  06 09 2a 86 48 86 f7 0d  |......0...*.H...|
+00000060  01 01 05 05 00 30 45 31  0b 30 09 06 03 55 04 06  |.....0E1.0...U..|
+00000070  13 02 41 55 31 13 30 11  06 03 55 04 08 13 0a 53  |..AU1.0...U....S|
+00000080  6f 6d 65 2d 53 74 61 74  65 31 21 30 1f 06 03 55  |ome-State1!0...U|
+00000090  04 0a 13 18 49 6e 74 65  72 6e 65 74 20 57 69 64  |....Internet Wid|
+000000a0  67 69 74 73 20 50 74 79  20 4c 74 64 30 1e 17 0d  |gits Pty Ltd0...|
+000000b0  31 30 30 34 32 34 30 39  30 39 33 38 5a 17 0d 31  |100424090938Z..1|
+000000c0  31 30 34 32 34 30 39 30  39 33 38 5a 30 45 31 0b  |10424090938Z0E1.|
+000000d0  30 09 06 03 55 04 06 13  02 41 55 31 13 30 11 06  |0...U....AU1.0..|
+000000e0  03 55 04 08 13 0a 53 6f  6d 65 2d 53 74 61 74 65  |.U....Some-State|
+000000f0  31 21 30 1f 06 03 55 04  0a 13 18 49 6e 74 65 72  |1!0...U....Inter|
+00000100  6e 65 74 20 57 69 64 67  69 74 73 20 50 74 79 20  |net Widgits Pty |
+00000110  4c 74 64 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |Ltd0..0...*.H...|
+00000120  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+00000130  bb 79 d6 f5 17 b5 e5 bf  46 10 d0 dc 69 be e6 2b  |.y......F...i..+|
+00000140  07 43 5a d0 03 2d 8a 7a  43 85 b7 14 52 e7 a5 65  |.CZ..-.zC...R..e|
+00000150  4c 2c 78 b8 23 8c b5 b4  82 e5 de 1f 95 3b 7e 62  |L,x.#........;~b|
+00000160  a5 2c a5 33 d6 fe 12 5c  7a 56 fc f5 06 bf fa 58  |.,.3...\zV.....X|
+00000170  7b 26 3f b5 cd 04 d3 d0  c9 21 96 4a c7 f4 54 9f  |{&?......!.J..T.|
+00000180  5a bf ef 42 71 00 fe 18  99 07 7f 7e 88 7d 7d f1  |Z..Bq......~.}}.|
+00000190  04 39 c4 a2 2e db 51 c9  7c e3 c0 4c 3b 32 66 01  |.9....Q.|..L;2f.|
+000001a0  cf af b1 1d b8 71 9a 1d  db db 89 6b ae da 2d 79  |.....q.....k..-y|
+000001b0  02 03 01 00 01 a3 81 a7  30 81 a4 30 1d 06 03 55  |........0..0...U|
+000001c0  1d 0e 04 16 04 14 b1 ad  e2 85 5a cf cb 28 db 69  |..........Z..(.i|
+000001d0  ce 23 69 de d3 26 8e 18  88 39 30 75 06 03 55 1d  |.#i..&...90u..U.|
+000001e0  23 04 6e 30 6c 80 14 b1  ad e2 85 5a cf cb 28 db  |#.n0l......Z..(.|
+000001f0  69 ce 23 69 de d3 26 8e  18 88 39 a1 49 a4 47 30  |i.#i..&...9.I.G0|
+00000200  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+00000210  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+00000220  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+00000230  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+00000240  74 79 20 4c 74 64 82 09  00 85 b0 bb a4 8a 7f b8  |ty Ltd..........|
+00000250  ca 30 0c 06 03 55 1d 13  04 05 30 03 01 01 ff 30  |.0...U....0....0|
+00000260  0d 06 09 2a 86 48 86 f7  0d 01 01 05 05 00 03 81  |...*.H..........|
+00000270  81 00 08 6c 45 24 c7 6b  b1 59 ab 0c 52 cc f2 b0  |...lE$.k.Y..R...|
+00000280  14 d7 87 9d 7a 64 75 b5  5a 95 66 e4 c5 2b 8e ae  |....zdu.Z.f..+..|
+00000290  12 66 1f eb 4f 38 b3 6e  60 d3 92 fd f7 41 08 b5  |.f..O8.n`....A..|
+000002a0  25 13 b1 18 7a 24 fb 30  1d ba ed 98 b9 17 ec e7  |%...z$.0........|
+000002b0  d7 31 59 db 95 d3 1d 78  ea 50 56 5c d5 82 5a 2d  |.1Y....x.PV\..Z-|
+000002c0  5a 5f 33 c4 b6 d8 c9 75  90 96 8c 0f 52 98 b5 cd  |Z_3....u....R...|
+000002d0  98 1f 89 20 5f f2 a0 1c  a3 1b 96 94 dd a9 fd 57  |... _..........W|
+000002e0  e9 70 e8 26 6d 71 99 9b  26 6e 38 50 29 6c 90 a7  |.p.&mq..&n8P)l..|
+000002f0  bd d9 16 03 01 00 04 0e  00 00 00                 |...........|
+>>> Flow 3 (client to server)
+00000000  16 03 01 00 86 10 00 00  82 00 80 17 30 df 06 a4  |............0...|
+00000010  8d 51 21 4a 76 9f 8b d2  2d 5d 0b 5e b1 72 63 7f  |.Q!Jv...-].^.rc.|
+00000020  f6 66 50 76 7a e0 90 de  3a 30 3f c3 66 1e 06 e4  |.fPvz...:0?.f...|
+00000030  ae fa 2f e5 a9 e9 9e fe  a6 b8 78 44 73 72 31 91  |../.......xDsr1.|
+00000040  78 76 7e e3 86 58 2f 62  79 5c 04 08 63 24 bd 29  |xv~..X/by\..c$.)|
+00000050  42 af fc c7 40 8b b0 26  1b a7 e1 a6 00 be e7 3a  |B...@..&.......:|
+00000060  60 bd a9 ff de 21 7f 87  55 7f d5 5f 5c 0f dc 5e  |`....!..U.._\..^|
+00000070  af b1 be 7f f6 5a fc e1  fc 81 2a 5d 5a 57 17 4c  |.....Z....*]ZW.L|
+00000080  76 b7 33 9a a2 89 46 66  b8 70 86 14 03 01 00 01  |v.3...Ff.p......|
+00000090  01 16 03 01 00 28 02 28  ba 24 9f 8c aa d8 e6 ce  |.....(.(.$......|
+000000a0  48 cf d5 6a 38 8b d4 d3  68 7a ce 6e a6 92 c7 47  |H..j8...hz.n...G|
+000000b0  85 72 c5 06 2f f1 5b b7  be 89 04 f3 b6 af        |.r../.[.......|
+>>> Flow 4 (server to client)
+00000000  14 03 01 00 01 01 16 03  01 00 28 d8 7a 71 41 9f  |..........(.zqA.|
+00000010  63 7a a8 5e ad 34 83 75  6a 15 29 d0 87 43 9b 3f  |cz.^.4.uj.)..C.?|
+00000020  b6 79 b1 44 92 f6 fd 9c  9b cc ec fc 05 8e 55 e9  |.y.D..........U.|
+00000030  7b 6a fe 17 03 01 00 18  52 2c 2b 19 63 fa 1f f0  |{j......R,+.c...|
+00000040  3a c2 1a 7e ba 3a 90 aa  25 46 f9 a4 f6 57 0e 32  |:..~.:..%F...W.2|
+00000050  17 03 01 00 28 49 ad 51  5e 27 fe e7 e4 1b bc 79  |....(I.Q^'.....y|
+00000060  34 51 f2 ea 3f cb 16 51  c5 d1 01 9a 65 7b e1 97  |4Q..?..Q....e{..|
+00000070  d4 28 f1 e6 ab cd 19 86  d3 01 79 9c 53 15 03 01  |.(........y.S...|
+00000080  00 18 ee 5b 0a 3c c5 0f  6f 85 2b 24 de 93 55 31  |...[.<..o.+$..U1|
+00000090  d8 17 a5 77 3c d4 10 48  cf af                    |...w<..H..|
diff --git a/src/pkg/crypto/tls/testdata/Server-TLSv10-RSA-AES b/src/pkg/crypto/tls/testdata/Server-TLSv10-RSA-AES
new file mode 100644
index 0000000000..40cd947565
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Server-TLSv10-RSA-AES
@@ -0,0 +1,81 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 37 01 00 00  33 03 01 52 ac 77 f8 da  |....7...3..R.w..|
+00000010  b3 ba 8c d1 0a a2 3b 35  7c db 1b ff cc e0 c4 f1  |......;5|.......|
+00000020  aa a3 40 fe 92 15 5b ed  29 3d 07 00 00 04 00 2f  |..@...[.)=...../|
+00000030  00 ff 02 01 00 00 05 00  0f 00 01 01              |............|
+>>> Flow 2 (server to client)
+00000000  16 03 01 00 2a 02 00 00  26 03 01 00 00 00 00 00  |....*...&.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2f 00 16  |............./..|
+00000030  03 01 02 be 0b 00 02 ba  00 02 b7 00 02 b4 30 82  |..............0.|
+00000040  02 b0 30 82 02 19 a0 03  02 01 02 02 09 00 85 b0  |..0.............|
+00000050  bb a4 8a 7f b8 ca 30 0d  06 09 2a 86 48 86 f7 0d  |......0...*.H...|
+00000060  01 01 05 05 00 30 45 31  0b 30 09 06 03 55 04 06  |.....0E1.0...U..|
+00000070  13 02 41 55 31 13 30 11  06 03 55 04 08 13 0a 53  |..AU1.0...U....S|
+00000080  6f 6d 65 2d 53 74 61 74  65 31 21 30 1f 06 03 55  |ome-State1!0...U|
+00000090  04 0a 13 18 49 6e 74 65  72 6e 65 74 20 57 69 64  |....Internet Wid|
+000000a0  67 69 74 73 20 50 74 79  20 4c 74 64 30 1e 17 0d  |gits Pty Ltd0...|
+000000b0  31 30 30 34 32 34 30 39  30 39 33 38 5a 17 0d 31  |100424090938Z..1|
+000000c0  31 30 34 32 34 30 39 30  39 33 38 5a 30 45 31 0b  |10424090938Z0E1.|
+000000d0  30 09 06 03 55 04 06 13  02 41 55 31 13 30 11 06  |0...U....AU1.0..|
+000000e0  03 55 04 08 13 0a 53 6f  6d 65 2d 53 74 61 74 65  |.U....Some-State|
+000000f0  31 21 30 1f 06 03 55 04  0a 13 18 49 6e 74 65 72  |1!0...U....Inter|
+00000100  6e 65 74 20 57 69 64 67  69 74 73 20 50 74 79 20  |net Widgits Pty |
+00000110  4c 74 64 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |Ltd0..0...*.H...|
+00000120  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+00000130  bb 79 d6 f5 17 b5 e5 bf  46 10 d0 dc 69 be e6 2b  |.y......F...i..+|
+00000140  07 43 5a d0 03 2d 8a 7a  43 85 b7 14 52 e7 a5 65  |.CZ..-.zC...R..e|
+00000150  4c 2c 78 b8 23 8c b5 b4  82 e5 de 1f 95 3b 7e 62  |L,x.#........;~b|
+00000160  a5 2c a5 33 d6 fe 12 5c  7a 56 fc f5 06 bf fa 58  |.,.3...\zV.....X|
+00000170  7b 26 3f b5 cd 04 d3 d0  c9 21 96 4a c7 f4 54 9f  |{&?......!.J..T.|
+00000180  5a bf ef 42 71 00 fe 18  99 07 7f 7e 88 7d 7d f1  |Z..Bq......~.}}.|
+00000190  04 39 c4 a2 2e db 51 c9  7c e3 c0 4c 3b 32 66 01  |.9....Q.|..L;2f.|
+000001a0  cf af b1 1d b8 71 9a 1d  db db 89 6b ae da 2d 79  |.....q.....k..-y|
+000001b0  02 03 01 00 01 a3 81 a7  30 81 a4 30 1d 06 03 55  |........0..0...U|
+000001c0  1d 0e 04 16 04 14 b1 ad  e2 85 5a cf cb 28 db 69  |..........Z..(.i|
+000001d0  ce 23 69 de d3 26 8e 18  88 39 30 75 06 03 55 1d  |.#i..&...90u..U.|
+000001e0  23 04 6e 30 6c 80 14 b1  ad e2 85 5a cf cb 28 db  |#.n0l......Z..(.|
+000001f0  69 ce 23 69 de d3 26 8e  18 88 39 a1 49 a4 47 30  |i.#i..&...9.I.G0|
+00000200  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+00000210  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+00000220  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+00000230  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+00000240  74 79 20 4c 74 64 82 09  00 85 b0 bb a4 8a 7f b8  |ty Ltd..........|
+00000250  ca 30 0c 06 03 55 1d 13  04 05 30 03 01 01 ff 30  |.0...U....0....0|
+00000260  0d 06 09 2a 86 48 86 f7  0d 01 01 05 05 00 03 81  |...*.H..........|
+00000270  81 00 08 6c 45 24 c7 6b  b1 59 ab 0c 52 cc f2 b0  |...lE$.k.Y..R...|
+00000280  14 d7 87 9d 7a 64 75 b5  5a 95 66 e4 c5 2b 8e ae  |....zdu.Z.f..+..|
+00000290  12 66 1f eb 4f 38 b3 6e  60 d3 92 fd f7 41 08 b5  |.f..O8.n`....A..|
+000002a0  25 13 b1 18 7a 24 fb 30  1d ba ed 98 b9 17 ec e7  |%...z$.0........|
+000002b0  d7 31 59 db 95 d3 1d 78  ea 50 56 5c d5 82 5a 2d  |.1Y....x.PV\..Z-|
+000002c0  5a 5f 33 c4 b6 d8 c9 75  90 96 8c 0f 52 98 b5 cd  |Z_3....u....R...|
+000002d0  98 1f 89 20 5f f2 a0 1c  a3 1b 96 94 dd a9 fd 57  |... _..........W|
+000002e0  e9 70 e8 26 6d 71 99 9b  26 6e 38 50 29 6c 90 a7  |.p.&mq..&n8P)l..|
+000002f0  bd d9 16 03 01 00 04 0e  00 00 00                 |...........|
+>>> Flow 3 (client to server)
+00000000  16 03 01 00 86 10 00 00  82 00 80 ae 53 cd ef fb  |............S...|
+00000010  31 07 cb 0b 1b a6 da c6  b6 b6 49 1b fb 5c f9 2f  |1.........I..\./|
+00000020  6b fe c9 5c 46 0c 2b 01  a2 4b 2e df 65 6d d9 61  |k..\F.+..K..em.a|
+00000030  59 93 72 89 d1 38 72 49  a7 28 e8 7a 70 7d 96 6e  |Y.r..8rI.(.zp}.n|
+00000040  72 0b 4d d4 f8 59 46 32  49 8b e4 97 35 de 77 19  |r.M..YF2I...5.w.|
+00000050  e9 30 12 ff d9 3d 32 07  4b 26 f7 d3 1a 32 dc 36  |.0...=2.K&...2.6|
+00000060  d9 f3 f9 33 fb 34 73 a4  35 15 f1 a9 cc 1a 30 55  |...3.4s.5.....0U|
+00000070  f3 25 20 8a 9e 25 87 13  58 ec e7 07 87 5d a7 84  |.% ..%..X....]..|
+00000080  e9 f8 83 c3 9e 08 0a 01  fa c2 8f 14 03 01 00 01  |................|
+00000090  01 16 03 01 00 30 dd 53  57 25 a0 e3 91 a1 0b fd  |.....0.SW%......|
+000000a0  16 91 90 59 4a 12 fe 96  a2 4b ca c9 85 a2 91 ef  |...YJ....K......|
+000000b0  ac 1f aa dc ff c3 9a 6d  79 5a 56 36 8d 48 fd e4  |.......myZV6.H..|
+000000c0  9a d2 4d 47 8e d0                                 |..MG..|
+>>> Flow 4 (server to client)
+00000000  14 03 01 00 01 01 16 03  01 00 30 12 3f 15 b4 79  |..........0.?..y|
+00000010  a8 f7 48 a3 f5 fa 0b 8e  58 f2 f0 cb dc 56 54 95  |..H.....X....VT.|
+00000020  8d fa 83 3a 09 da 97 28  bd 01 7f 0d 88 1d 46 33  |...:...(......F3|
+00000030  42 58 b3 d5 31 45 c2 4c  cb 0b fc 17 03 01 00 20  |BX..1E.L....... |
+00000040  9c 90 ff 54 aa 89 5a f7  70 0a 1e 99 47 94 1e b6  |...T..Z.p...G...|
+00000050  b7 66 14 4a 25 4f b8 b1  cc 60 65 5d 0b 5a c1 c2  |.f.J%O...`e].Z..|
+00000060  17 03 01 00 30 b6 f0 49  f3 b1 2e 3a b5 d8 9e 35  |....0..I...:...5|
+00000070  fc 2a 77 6e d3 d8 5a 17  dc d8 8a ac 29 d3 90 28  |.*wn..Z.....)..(|
+00000080  8b bf 3c 8a b0 59 05 15  e6 ac 53 5b 59 ae 61 30  |..<..Y....S[Y.a0|
+00000090  f8 1c b4 40 62 15 03 01  00 20 1f bb db f5 0e a8  |...@b.... ......|
+000000a0  8d ed 68 b1 aa 3d c7 15  3e 7f 00 24 41 c6 4e b8  |..h..=..>..$A.N.|
+000000b0  91 24 46 5e f1 23 b2 4d  7e 47                    |.$F^.#.M~G|
diff --git a/src/pkg/crypto/tls/testdata/Server-TLSv10-RSA-RC4 b/src/pkg/crypto/tls/testdata/Server-TLSv10-RSA-RC4
new file mode 100644
index 0000000000..7dc32b53a8
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Server-TLSv10-RSA-RC4
@@ -0,0 +1,75 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 37 01 00 00  33 03 01 52 ac 77 f8 61  |....7...3..R.w.a|
+00000010  5d ea e5 06 b5 5e 74 c9  65 dd 4b f3 12 10 82 90  |]....^t.e.K.....|
+00000020  3a 4f 56 50 1a 96 fa a1  6e 41 12 00 00 04 00 05  |:OVP....nA......|
+00000030  00 ff 02 01 00 00 05 00  0f 00 01 01              |............|
+>>> Flow 2 (server to client)
+00000000  16 03 01 00 2a 02 00 00  26 03 01 00 00 00 00 00  |....*...&.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 05 00 16  |................|
+00000030  03 01 02 be 0b 00 02 ba  00 02 b7 00 02 b4 30 82  |..............0.|
+00000040  02 b0 30 82 02 19 a0 03  02 01 02 02 09 00 85 b0  |..0.............|
+00000050  bb a4 8a 7f b8 ca 30 0d  06 09 2a 86 48 86 f7 0d  |......0...*.H...|
+00000060  01 01 05 05 00 30 45 31  0b 30 09 06 03 55 04 06  |.....0E1.0...U..|
+00000070  13 02 41 55 31 13 30 11  06 03 55 04 08 13 0a 53  |..AU1.0...U....S|
+00000080  6f 6d 65 2d 53 74 61 74  65 31 21 30 1f 06 03 55  |ome-State1!0...U|
+00000090  04 0a 13 18 49 6e 74 65  72 6e 65 74 20 57 69 64  |....Internet Wid|
+000000a0  67 69 74 73 20 50 74 79  20 4c 74 64 30 1e 17 0d  |gits Pty Ltd0...|
+000000b0  31 30 30 34 32 34 30 39  30 39 33 38 5a 17 0d 31  |100424090938Z..1|
+000000c0  31 30 34 32 34 30 39 30  39 33 38 5a 30 45 31 0b  |10424090938Z0E1.|
+000000d0  30 09 06 03 55 04 06 13  02 41 55 31 13 30 11 06  |0...U....AU1.0..|
+000000e0  03 55 04 08 13 0a 53 6f  6d 65 2d 53 74 61 74 65  |.U....Some-State|
+000000f0  31 21 30 1f 06 03 55 04  0a 13 18 49 6e 74 65 72  |1!0...U....Inter|
+00000100  6e 65 74 20 57 69 64 67  69 74 73 20 50 74 79 20  |net Widgits Pty |
+00000110  4c 74 64 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |Ltd0..0...*.H...|
+00000120  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+00000130  bb 79 d6 f5 17 b5 e5 bf  46 10 d0 dc 69 be e6 2b  |.y......F...i..+|
+00000140  07 43 5a d0 03 2d 8a 7a  43 85 b7 14 52 e7 a5 65  |.CZ..-.zC...R..e|
+00000150  4c 2c 78 b8 23 8c b5 b4  82 e5 de 1f 95 3b 7e 62  |L,x.#........;~b|
+00000160  a5 2c a5 33 d6 fe 12 5c  7a 56 fc f5 06 bf fa 58  |.,.3...\zV.....X|
+00000170  7b 26 3f b5 cd 04 d3 d0  c9 21 96 4a c7 f4 54 9f  |{&?......!.J..T.|
+00000180  5a bf ef 42 71 00 fe 18  99 07 7f 7e 88 7d 7d f1  |Z..Bq......~.}}.|
+00000190  04 39 c4 a2 2e db 51 c9  7c e3 c0 4c 3b 32 66 01  |.9....Q.|..L;2f.|
+000001a0  cf af b1 1d b8 71 9a 1d  db db 89 6b ae da 2d 79  |.....q.....k..-y|
+000001b0  02 03 01 00 01 a3 81 a7  30 81 a4 30 1d 06 03 55  |........0..0...U|
+000001c0  1d 0e 04 16 04 14 b1 ad  e2 85 5a cf cb 28 db 69  |..........Z..(.i|
+000001d0  ce 23 69 de d3 26 8e 18  88 39 30 75 06 03 55 1d  |.#i..&...90u..U.|
+000001e0  23 04 6e 30 6c 80 14 b1  ad e2 85 5a cf cb 28 db  |#.n0l......Z..(.|
+000001f0  69 ce 23 69 de d3 26 8e  18 88 39 a1 49 a4 47 30  |i.#i..&...9.I.G0|
+00000200  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+00000210  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+00000220  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+00000230  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+00000240  74 79 20 4c 74 64 82 09  00 85 b0 bb a4 8a 7f b8  |ty Ltd..........|
+00000250  ca 30 0c 06 03 55 1d 13  04 05 30 03 01 01 ff 30  |.0...U....0....0|
+00000260  0d 06 09 2a 86 48 86 f7  0d 01 01 05 05 00 03 81  |...*.H..........|
+00000270  81 00 08 6c 45 24 c7 6b  b1 59 ab 0c 52 cc f2 b0  |...lE$.k.Y..R...|
+00000280  14 d7 87 9d 7a 64 75 b5  5a 95 66 e4 c5 2b 8e ae  |....zdu.Z.f..+..|
+00000290  12 66 1f eb 4f 38 b3 6e  60 d3 92 fd f7 41 08 b5  |.f..O8.n`....A..|
+000002a0  25 13 b1 18 7a 24 fb 30  1d ba ed 98 b9 17 ec e7  |%...z$.0........|
+000002b0  d7 31 59 db 95 d3 1d 78  ea 50 56 5c d5 82 5a 2d  |.1Y....x.PV\..Z-|
+000002c0  5a 5f 33 c4 b6 d8 c9 75  90 96 8c 0f 52 98 b5 cd  |Z_3....u....R...|
+000002d0  98 1f 89 20 5f f2 a0 1c  a3 1b 96 94 dd a9 fd 57  |... _..........W|
+000002e0  e9 70 e8 26 6d 71 99 9b  26 6e 38 50 29 6c 90 a7  |.p.&mq..&n8P)l..|
+000002f0  bd d9 16 03 01 00 04 0e  00 00 00                 |...........|
+>>> Flow 3 (client to server)
+00000000  16 03 01 00 86 10 00 00  82 00 80 9a 45 b5 b4 9d  |............E...|
+00000010  1c 49 c5 52 aa 0b 43 45  45 10 ab a0 21 04 f1 ca  |.I.R..CEE...!...|
+00000020  41 d8 b3 70 10 fc c5 7c  a1 d2 d7 15 04 1e 8f ae  |A..p...|........|
+00000030  39 a4 d2 0d b9 e3 cf d4  40 9a b4 ee 8e 57 c4 41  |9.......@....W.A|
+00000040  74 d4 94 a4 7b 36 70 e9  af 43 e3 7b 02 52 7d 99  |t...{6p..C.{.R}.|
+00000050  52 65 03 b7 e3 05 72 36  7c f7 c0 07 49 27 f8 5d  |Re....r6|...I'.]|
+00000060  cb e0 00 5b 84 b1 bd b7  7f e5 6b a8 ad e3 df 9e  |...[......k.....|
+00000070  b8 7c 19 aa 6e 22 c7 0b  43 61 6d 0b d3 b9 72 10  |.|..n"..Cam...r.|
+00000080  b1 a3 ac e4 12 de 32 b5  e0 89 a0 14 03 01 00 01  |......2.........|
+00000090  01 16 03 01 00 24 ba 96  18 34 84 cc 60 cd 33 33  |.....$...4..`.33|
+000000a0  c2 24 88 ec 0d 46 93 d3  d5 42 82 a5 8b f0 a5 c6  |.$...F...B......|
+000000b0  c5 73 9a d5 85 fb 79 5e  90 09                    |.s....y^..|
+>>> Flow 4 (server to client)
+00000000  14 03 01 00 01 01 16 03  01 00 24 88 79 b1 70 0e  |..........$.y.p.|
+00000010  86 2a ec 3e a3 8b 2f 78  70 d0 92 4e ae 8e 17 78  |.*.>../xp..N...x|
+00000020  cc 91 a9 3d 5c f2 2c 36  45 12 62 e4 8d 15 0a 17  |...=\.,6E.b.....|
+00000030  03 01 00 21 f7 3b 4e 00  2b 54 e8 86 6f 84 bd 92  |...!.;N.+T..o...|
+00000040  ca 87 5f a7 4e 62 ad 84  a8 3d be 8d 61 5f e2 e8  |.._.Nb...=..a_..|
+00000050  74 83 e3 1e 1f 15 03 01  00 16 fd 57 d8 6c 17 47  |t..........W.l.G|
+00000060  af 7b 6e c6 5e 68 26 db  bc 5b 47 51 92 ac 11 b5  |.{n.^h&..[GQ....|
diff --git a/src/pkg/crypto/tls/testdata/Server-TLSv11-RSA-RC4 b/src/pkg/crypto/tls/testdata/Server-TLSv11-RSA-RC4
new file mode 100644
index 0000000000..b03742eca4
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Server-TLSv11-RSA-RC4
@@ -0,0 +1,75 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 37 01 00 00  33 03 02 52 ac 77 f8 ec  |....7...3..R.w..|
+00000010  6b 58 37 4d 43 de 2f 43  32 93 a4 d2 a1 10 21 6e  |kX7MC./C2.....!n|
+00000020  55 aa f2 0d 14 70 6d 37  cb 0e e7 00 00 04 00 05  |U....pm7........|
+00000030  00 ff 02 01 00 00 05 00  0f 00 01 01              |............|
+>>> Flow 2 (server to client)
+00000000  16 03 02 00 2a 02 00 00  26 03 02 00 00 00 00 00  |....*...&.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 05 00 16  |................|
+00000030  03 02 02 be 0b 00 02 ba  00 02 b7 00 02 b4 30 82  |..............0.|
+00000040  02 b0 30 82 02 19 a0 03  02 01 02 02 09 00 85 b0  |..0.............|
+00000050  bb a4 8a 7f b8 ca 30 0d  06 09 2a 86 48 86 f7 0d  |......0...*.H...|
+00000060  01 01 05 05 00 30 45 31  0b 30 09 06 03 55 04 06  |.....0E1.0...U..|
+00000070  13 02 41 55 31 13 30 11  06 03 55 04 08 13 0a 53  |..AU1.0...U....S|
+00000080  6f 6d 65 2d 53 74 61 74  65 31 21 30 1f 06 03 55  |ome-State1!0...U|
+00000090  04 0a 13 18 49 6e 74 65  72 6e 65 74 20 57 69 64  |....Internet Wid|
+000000a0  67 69 74 73 20 50 74 79  20 4c 74 64 30 1e 17 0d  |gits Pty Ltd0...|
+000000b0  31 30 30 34 32 34 30 39  30 39 33 38 5a 17 0d 31  |100424090938Z..1|
+000000c0  31 30 34 32 34 30 39 30  39 33 38 5a 30 45 31 0b  |10424090938Z0E1.|
+000000d0  30 09 06 03 55 04 06 13  02 41 55 31 13 30 11 06  |0...U....AU1.0..|
+000000e0  03 55 04 08 13 0a 53 6f  6d 65 2d 53 74 61 74 65  |.U....Some-State|
+000000f0  31 21 30 1f 06 03 55 04  0a 13 18 49 6e 74 65 72  |1!0...U....Inter|
+00000100  6e 65 74 20 57 69 64 67  69 74 73 20 50 74 79 20  |net Widgits Pty |
+00000110  4c 74 64 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |Ltd0..0...*.H...|
+00000120  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+00000130  bb 79 d6 f5 17 b5 e5 bf  46 10 d0 dc 69 be e6 2b  |.y......F...i..+|
+00000140  07 43 5a d0 03 2d 8a 7a  43 85 b7 14 52 e7 a5 65  |.CZ..-.zC...R..e|
+00000150  4c 2c 78 b8 23 8c b5 b4  82 e5 de 1f 95 3b 7e 62  |L,x.#........;~b|
+00000160  a5 2c a5 33 d6 fe 12 5c  7a 56 fc f5 06 bf fa 58  |.,.3...\zV.....X|
+00000170  7b 26 3f b5 cd 04 d3 d0  c9 21 96 4a c7 f4 54 9f  |{&?......!.J..T.|
+00000180  5a bf ef 42 71 00 fe 18  99 07 7f 7e 88 7d 7d f1  |Z..Bq......~.}}.|
+00000190  04 39 c4 a2 2e db 51 c9  7c e3 c0 4c 3b 32 66 01  |.9....Q.|..L;2f.|
+000001a0  cf af b1 1d b8 71 9a 1d  db db 89 6b ae da 2d 79  |.....q.....k..-y|
+000001b0  02 03 01 00 01 a3 81 a7  30 81 a4 30 1d 06 03 55  |........0..0...U|
+000001c0  1d 0e 04 16 04 14 b1 ad  e2 85 5a cf cb 28 db 69  |..........Z..(.i|
+000001d0  ce 23 69 de d3 26 8e 18  88 39 30 75 06 03 55 1d  |.#i..&...90u..U.|
+000001e0  23 04 6e 30 6c 80 14 b1  ad e2 85 5a cf cb 28 db  |#.n0l......Z..(.|
+000001f0  69 ce 23 69 de d3 26 8e  18 88 39 a1 49 a4 47 30  |i.#i..&...9.I.G0|
+00000200  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+00000210  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+00000220  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+00000230  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+00000240  74 79 20 4c 74 64 82 09  00 85 b0 bb a4 8a 7f b8  |ty Ltd..........|
+00000250  ca 30 0c 06 03 55 1d 13  04 05 30 03 01 01 ff 30  |.0...U....0....0|
+00000260  0d 06 09 2a 86 48 86 f7  0d 01 01 05 05 00 03 81  |...*.H..........|
+00000270  81 00 08 6c 45 24 c7 6b  b1 59 ab 0c 52 cc f2 b0  |...lE$.k.Y..R...|
+00000280  14 d7 87 9d 7a 64 75 b5  5a 95 66 e4 c5 2b 8e ae  |....zdu.Z.f..+..|
+00000290  12 66 1f eb 4f 38 b3 6e  60 d3 92 fd f7 41 08 b5  |.f..O8.n`....A..|
+000002a0  25 13 b1 18 7a 24 fb 30  1d ba ed 98 b9 17 ec e7  |%...z$.0........|
+000002b0  d7 31 59 db 95 d3 1d 78  ea 50 56 5c d5 82 5a 2d  |.1Y....x.PV\..Z-|
+000002c0  5a 5f 33 c4 b6 d8 c9 75  90 96 8c 0f 52 98 b5 cd  |Z_3....u....R...|
+000002d0  98 1f 89 20 5f f2 a0 1c  a3 1b 96 94 dd a9 fd 57  |... _..........W|
+000002e0  e9 70 e8 26 6d 71 99 9b  26 6e 38 50 29 6c 90 a7  |.p.&mq..&n8P)l..|
+000002f0  bd d9 16 03 02 00 04 0e  00 00 00                 |...........|
+>>> Flow 3 (client to server)
+00000000  16 03 02 00 86 10 00 00  82 00 80 04 ed f2 fd 60  |...............`|
+00000010  fe 22 e4 ed 2a d2 f4 e2  7c 50 f7 a5 20 7f aa 06  |."..*...|P.. ...|
+00000020  ab fa 73 e7 fa 52 da 1e  ee a2 27 2c 90 21 35 0e  |..s..R....',.!5.|
+00000030  b4 c7 ca 3e 94 bc 65 e0  64 cb a0 c3 80 15 6e 40  |...>..e.d.....n@|
+00000040  53 6c 02 ec e8 b9 51 29  ae b8 bc 1e fa 18 61 50  |Sl....Q)......aP|
+00000050  79 f4 31 d3 13 0d e1 36  a4 2b c1 7d 3f 88 90 a5  |y.1....6.+.}?...|
+00000060  3d bd 09 2a e8 f9 56 a5  4b 59 63 90 0a fd 79 26  |=..*..V.KYc...y&|
+00000070  2b 80 8c 40 68 ee 85 41  c1 b7 9c 6d d5 fc 2f 96  |+..@h..A...m../.|
+00000080  d3 20 7b 34 7b 8c 94 5f  fc 27 80 14 03 02 00 01  |. {4{.._.'......|
+00000090  01 16 03 02 00 24 ae b1  15 28 25 1b e0 a1 d1 6e  |.....$...(%....n|
+000000a0  6f 01 b9 ff 19 09 2e 01  c1 15 b8 04 cc ad e7 63  |o..............c|
+000000b0  29 0a fd 3e eb ea 56 f3  68 ac                    |)..>..V.h.|
+>>> Flow 4 (server to client)
+00000000  14 03 02 00 01 01 16 03  02 00 24 99 ca 80 4d cf  |..........$...M.|
+00000010  dd de 83 29 63 8c 16 36  5f e0 6b ed c4 ed 6c 03  |...)c..6_.k...l.|
+00000020  9a 56 8b 78 e1 cc 68 a5  83 ae 25 23 4d 31 0a 17  |.V.x..h...%#M1..|
+00000030  03 02 00 21 66 36 75 ae  62 17 85 e8 2e b0 3d c6  |...!f6u.b.....=.|
+00000040  c7 71 44 a5 6b 50 ea c3  8b 46 b8 b6 d0 9d 04 36  |.qD.kP...F.....6|
+00000050  cd f1 69 cf 8f 15 03 02  00 16 47 61 e8 e2 4c bb  |..i.......Ga..L.|
+00000060  10 a3 31 38 5a a1 33 61  c2 09 cf a9 95 1c df 72  |..18Z.3a.......r|
diff --git a/src/pkg/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceECDSA b/src/pkg/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceECDSA
new file mode 100644
index 0000000000..cd91d7f50a
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceECDSA
@@ -0,0 +1,106 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 01 39 01 00 01  35 03 03 52 ac 77 f8 cf  |....9...5..R.w..|
+00000010  8e 29 75 5c 1e a8 0c ef  df a1 2b c5 c0 ca fe bc  |.)u\......+.....|
+00000020  63 b1 df 9a 17 e3 5f a4  e1 1c c4 00 00 a0 c0 30  |c....._........0|
+00000030  c0 2c c0 28 c0 24 c0 14  c0 0a c0 22 c0 21 00 a3  |.,.(.$.....".!..|
+00000040  00 9f 00 6b 00 6a 00 39  00 38 00 88 00 87 c0 32  |...k.j.9.8.....2|
+00000050  c0 2e c0 2a c0 26 c0 0f  c0 05 00 9d 00 3d 00 35  |...*.&.......=.5|
+00000060  00 84 c0 12 c0 08 c0 1c  c0 1b 00 16 00 13 c0 0d  |................|
+00000070  c0 03 00 0a c0 2f c0 2b  c0 27 c0 23 c0 13 c0 09  |...../.+.'.#....|
+00000080  c0 1f c0 1e 00 a2 00 9e  00 67 00 40 00 33 00 32  |.........g.@.3.2|
+00000090  00 9a 00 99 00 45 00 44  c0 31 c0 2d c0 29 c0 25  |.....E.D.1.-.).%|
+000000a0  c0 0e c0 04 00 9c 00 3c  00 2f 00 96 00 41 00 07  |.......<./...A..|
+000000b0  c0 11 c0 07 c0 0c c0 02  00 05 00 04 00 15 00 12  |................|
+000000c0  00 09 00 14 00 11 00 08  00 06 00 03 00 ff 02 01  |................|
+000000d0  00 00 6b 00 0b 00 04 03  00 01 02 00 0a 00 34 00  |..k...........4.|
+000000e0  32 00 0e 00 0d 00 19 00  0b 00 0c 00 18 00 09 00  |2...............|
+000000f0  0a 00 16 00 17 00 08 00  06 00 07 00 14 00 15 00  |................|
+00000100  04 00 05 00 12 00 13 00  01 00 02 00 03 00 0f 00  |................|
+00000110  10 00 11 00 0d 00 22 00  20 06 01 06 02 06 03 05  |......". .......|
+00000120  01 05 02 05 03 04 01 04  02 04 03 03 01 03 02 03  |................|
+00000130  03 02 01 02 02 02 03 01  01 00 0f 00 01 01        |..............|
+>>> Flow 2 (server to client)
+00000000  16 03 03 00 2a 02 00 00  26 03 03 00 00 00 00 00  |....*...&.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 c0 0a 00 16  |................|
+00000030  03 03 02 0e 0b 00 02 0a  00 02 07 00 02 04 30 82  |..............0.|
+00000040  02 00 30 82 01 62 02 09  00 b8 bf 2d 47 a0 d2 eb  |..0..b.....-G...|
+00000050  f4 30 09 06 07 2a 86 48  ce 3d 04 01 30 45 31 0b  |.0...*.H.=..0E1.|
+00000060  30 09 06 03 55 04 06 13  02 41 55 31 13 30 11 06  |0...U....AU1.0..|
+00000070  03 55 04 08 13 0a 53 6f  6d 65 2d 53 74 61 74 65  |.U....Some-State|
+00000080  31 21 30 1f 06 03 55 04  0a 13 18 49 6e 74 65 72  |1!0...U....Inter|
+00000090  6e 65 74 20 57 69 64 67  69 74 73 20 50 74 79 20  |net Widgits Pty |
+000000a0  4c 74 64 30 1e 17 0d 31  32 31 31 32 32 31 35 30  |Ltd0...121122150|
+000000b0  36 33 32 5a 17 0d 32 32  31 31 32 30 31 35 30 36  |632Z..2211201506|
+000000c0  33 32 5a 30 45 31 0b 30  09 06 03 55 04 06 13 02  |32Z0E1.0...U....|
+000000d0  41 55 31 13 30 11 06 03  55 04 08 13 0a 53 6f 6d  |AU1.0...U....Som|
+000000e0  65 2d 53 74 61 74 65 31  21 30 1f 06 03 55 04 0a  |e-State1!0...U..|
+000000f0  13 18 49 6e 74 65 72 6e  65 74 20 57 69 64 67 69  |..Internet Widgi|
+00000100  74 73 20 50 74 79 20 4c  74 64 30 81 9b 30 10 06  |ts Pty Ltd0..0..|
+00000110  07 2a 86 48 ce 3d 02 01  06 05 2b 81 04 00 23 03  |.*.H.=....+...#.|
+00000120  81 86 00 04 00 c4 a1 ed  be 98 f9 0b 48 73 36 7e  |............Hs6~|
+00000130  c3 16 56 11 22 f2 3d 53  c3 3b 4d 21 3d cd 6b 75  |..V.".=S.;M!=.ku|
+00000140  e6 f6 b0 dc 9a df 26 c1  bc b2 87 f0 72 32 7c b3  |......&.....r2|.|
+00000150  64 2f 1c 90 bc ea 68 23  10 7e fe e3 25 c0 48 3a  |d/....h#.~..%.H:|
+00000160  69 e0 28 6d d3 37 00 ef  04 62 dd 0d a0 9c 70 62  |i.(m.7...b....pb|
+00000170  83 d8 81 d3 64 31 aa 9e  97 31 bd 96 b0 68 c0 9b  |....d1...1...h..|
+00000180  23 de 76 64 3f 1a 5c 7f  e9 12 0e 58 58 b6 5f 70  |#.vd?.\....XX._p|
+00000190  dd 9b d8 ea d5 d7 f5 d5  cc b9 b6 9f 30 66 5b 66  |............0f[f|
+000001a0  9a 20 e2 27 e5 bf fe 3b  30 09 06 07 2a 86 48 ce  |. .'...;0...*.H.|
+000001b0  3d 04 01 03 81 8c 00 30  81 88 02 42 01 88 a2 4f  |=......0...B...O|
+000001c0  eb e2 45 c5 48 7d 1b ac  f5 ed 98 9d ae 47 70 c0  |..E.H}.......Gp.|
+000001d0  5e 1b b6 2f bd f1 b6 4d  b7 61 40 d3 11 a2 ce ee  |^../...M.a@.....|
+000001e0  0b 7e 92 7e ff 76 9d c3  3b 7e a5 3f ce fa 10 e2  |.~.~.v..;~.?....|
+000001f0  59 ec 47 2d 7c ac da 4e  97 0e 15 a0 6f d0 02 42  |Y.G-|..N....o..B|
+00000200  01 4d fc be 67 13 9c 2d  05 0e bd 3f a3 8c 25 c1  |.M..g..-...?..%.|
+00000210  33 13 83 0d 94 06 bb d4  37 7a f6 ec 7a c9 86 2e  |3.......7z..z...|
+00000220  dd d7 11 69 7f 85 7c 56  de fb 31 78 2b e4 c7 78  |...i..|V..1x+..x|
+00000230  0d ae cb be 9e 4e 36 24  31 7b 6a 0f 39 95 12 07  |.....N6$1{j.9...|
+00000240  8f 2a 16 03 03 01 1c 0c  00 01 18 03 00 19 85 04  |.*..............|
+00000250  01 39 dc ee 44 17 5e db  d7 27 af b6 56 d9 b4 43  |.9..D.^..'..V..C|
+00000260  5a 99 cf aa 31 37 0c 6f  3a a0 f8 53 c4 74 d1 91  |Z...17.o:..S.t..|
+00000270  0a 46 f5 38 3b 5c 09 d8  97 dc 4b aa 70 26 48 f2  |.F.8;\....K.p&H.|
+00000280  d6 0b 31 c9 f8 d4 98 43  e1 6c d5 c7 b2 8e 0b 01  |..1....C.l......|
+00000290  e6 b6 00 28 80 7b fc 96  8f 0d a2 4f b0 79 af dc  |...(.{.....O.y..|
+000002a0  61 28 63 33 78 f6 31 39  fd 8a f4 15 18 11 fe db  |a(c3x.19........|
+000002b0  d5 07 da 2c ed 49 a0 23  bf d0 3a 38 1d 54 ae 1c  |...,.I.#..:8.T..|
+000002c0  7b ea 29 ee d0 38 c1 76  a7 7f 2a f4 ce 1e ac cc  |{.)..8.v..*.....|
+000002d0  94 79 90 33 04 03 00 8b  30 81 88 02 42 00 c6 85  |.y.3....0...B...|
+000002e0  8e 06 b7 04 04 e9 cd 9e  3e cb 66 23 95 b4 42 9c  |........>.f#..B.|
+000002f0  64 81 39 05 3f b5 21 f8  28 af 60 6b 4d 3d ba a1  |d.9.?.!.(.`kM=..|
+00000300  4b 5e 77 ef e7 59 28 fe  1d c1 27 a2 ff a8 de 33  |K^w..Y(...'....3|
+00000310  48 b3 c1 85 6a 42 9b f9  7e 7e 31 c2 e5 bd 66 02  |H...jB..~~1...f.|
+00000320  42 00 ad 7d 06 35 ab ec  8d ac d4 ba 1b 49 5e 05  |B..}.5.......I^.|
+00000330  5f f0 97 93 82 b8 2b 8d  91 98 63 8e b4 14 62 db  |_.....+...c...b.|
+00000340  1e c9 2b b9 8d 7b bf 37  1c f3 94 74 60 d6 7d a5  |..+..{.7...t`.}.|
+00000350  28 0a 74 d1 59 87 c3 42  31 9a 0e f7 85 ce ec eb  |(.t.Y..B1.......|
+00000360  fa 4a 14 16 03 03 00 04  0e 00 00 00              |.J..........|
+>>> Flow 3 (client to server)
+00000000  16 03 03 00 8a 10 00 00  86 85 04 01 31 b5 19 44  |............1..D|
+00000010  f5 d4 29 20 77 2e cc a9  bb ab 5d 3b f6 0e 5c dd  |..) w.....];..\.|
+00000020  c2 cd 42 a4 b1 ce 1f 69  0f 09 c7 ef 5a 99 96 03  |..B....i....Z...|
+00000030  5b 57 86 02 c0 d0 9a a6  5f 59 b0 5b 45 c2 ae ec  |[W......_Y.[E...|
+00000040  cf 3d 3d 60 b5 5f 7d c9  82 5a 54 0b 74 00 c2 8b  |.==`._}..ZT.t...|
+00000050  67 2f f9 dd c9 bd 2c 63  12 5b 55 61 09 8b fe 75  |g/....,c.[Ua...u|
+00000060  23 2c a2 c1 bd 6e 71 23  07 e3 c2 64 5e 13 f1 d1  |#,...nq#...d^...|
+00000070  cc db 17 dc 8b e6 4f d4  72 46 0a 1e 26 63 cb e0  |......O.rF..&c..|
+00000080  da f3 f7 f6 d3 64 f5 44  ce 01 7b 21 4e cb 23 14  |.....d.D..{!N.#.|
+00000090  03 03 00 01 01 16 03 03  00 40 5d 5b 3c 90 6b e1  |.........@][<.k.|
+000000a0  33 90 6a a3 6a 9e f8 a6  9b 2d ca 8b ea 26 10 92  |3.j.j....-...&..|
+000000b0  ca 60 7b 4b fb 8a df 5d  1d 4b 23 41 7e 4f f7 c2  |.`{K...].K#A~O..|
+000000c0  98 64 11 84 56 bc 9c ba  11 1c 19 7f a9 04 43 d3  |.d..V.........C.|
+000000d0  a0 80 47 11 09 a5 dc 08  fc a0                    |..G.......|
+>>> Flow 4 (server to client)
+00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
+00000010  00 00 00 00 00 00 00 00  00 00 00 2e 6a 39 7e ab  |............j9~.|
+00000020  da af a7 27 4f 60 4e e4  d6 6e 75 3a 03 20 af 45  |...'O`N..nu:. .E|
+00000030  a2 ad 58 2e 8b 4b e6 5f  22 41 87 79 21 eb 5c 71  |..X..K._"A.y!.\q|
+00000040  d8 63 ba 42 8b 32 8a 61  e2 6f 43 17 03 03 00 40  |.c.B.2.a.oC....@|
+00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000060  2e e2 39 2b 6c 28 9e 3a  59 f6 31 04 8b 95 be bd  |..9+l(.:Y.1.....|
+00000070  73 e6 12 77 ab 3a 30 30  1b f2 5f 7e 42 f9 53 1c  |s..w.:00.._~B.S.|
+00000080  bf 3c 58 8f e0 b6 c7 f2  c5 5d 0f d0 37 3f 37 96  |.<X......]..7?7.|
+00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
+000000a0  00 00 00 00 00 a5 fa 6a  4d 33 1a 0d 83 5e 26 39  |.......jM3...^&9|
+000000b0  a1 07 3c 00 02 7e 2b 1b  c0 95 4a 16 85 83 c4 af  |..<..~+...J.....|
+000000c0  79 0e 43 c6 c8                                    |y.C..|
diff --git a/src/pkg/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceRSA b/src/pkg/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceRSA
new file mode 100644
index 0000000000..637c8aa98f
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceRSA
@@ -0,0 +1,117 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 01 39 01 00 01  35 03 03 52 ac 77 f8 37  |....9...5..R.w.7|
+00000010  29 0d 02 21 92 09 b5 f1  91 cd bc a7 7d 84 2b 9b  |)..!........}.+.|
+00000020  f5 4f bf b6 c6 f3 a0 60  62 df cf 00 00 a0 c0 30  |.O.....`b......0|
+00000030  c0 2c c0 28 c0 24 c0 14  c0 0a c0 22 c0 21 00 a3  |.,.(.$.....".!..|
+00000040  00 9f 00 6b 00 6a 00 39  00 38 00 88 00 87 c0 32  |...k.j.9.8.....2|
+00000050  c0 2e c0 2a c0 26 c0 0f  c0 05 00 9d 00 3d 00 35  |...*.&.......=.5|
+00000060  00 84 c0 12 c0 08 c0 1c  c0 1b 00 16 00 13 c0 0d  |................|
+00000070  c0 03 00 0a c0 2f c0 2b  c0 27 c0 23 c0 13 c0 09  |...../.+.'.#....|
+00000080  c0 1f c0 1e 00 a2 00 9e  00 67 00 40 00 33 00 32  |.........g.@.3.2|
+00000090  00 9a 00 99 00 45 00 44  c0 31 c0 2d c0 29 c0 25  |.....E.D.1.-.).%|
+000000a0  c0 0e c0 04 00 9c 00 3c  00 2f 00 96 00 41 00 07  |.......<./...A..|
+000000b0  c0 11 c0 07 c0 0c c0 02  00 05 00 04 00 15 00 12  |................|
+000000c0  00 09 00 14 00 11 00 08  00 06 00 03 00 ff 02 01  |................|
+000000d0  00 00 6b 00 0b 00 04 03  00 01 02 00 0a 00 34 00  |..k...........4.|
+000000e0  32 00 0e 00 0d 00 19 00  0b 00 0c 00 18 00 09 00  |2...............|
+000000f0  0a 00 16 00 17 00 08 00  06 00 07 00 14 00 15 00  |................|
+00000100  04 00 05 00 12 00 13 00  01 00 02 00 03 00 0f 00  |................|
+00000110  10 00 11 00 0d 00 22 00  20 06 01 06 02 06 03 05  |......". .......|
+00000120  01 05 02 05 03 04 01 04  02 04 03 03 01 03 02 03  |................|
+00000130  03 02 01 02 02 02 03 01  01 00 0f 00 01 01        |..............|
+>>> Flow 2 (server to client)
+00000000  16 03 03 00 2a 02 00 00  26 03 03 00 00 00 00 00  |....*...&.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 c0 13 00 16  |................|
+00000030  03 03 02 be 0b 00 02 ba  00 02 b7 00 02 b4 30 82  |..............0.|
+00000040  02 b0 30 82 02 19 a0 03  02 01 02 02 09 00 85 b0  |..0.............|
+00000050  bb a4 8a 7f b8 ca 30 0d  06 09 2a 86 48 86 f7 0d  |......0...*.H...|
+00000060  01 01 05 05 00 30 45 31  0b 30 09 06 03 55 04 06  |.....0E1.0...U..|
+00000070  13 02 41 55 31 13 30 11  06 03 55 04 08 13 0a 53  |..AU1.0...U....S|
+00000080  6f 6d 65 2d 53 74 61 74  65 31 21 30 1f 06 03 55  |ome-State1!0...U|
+00000090  04 0a 13 18 49 6e 74 65  72 6e 65 74 20 57 69 64  |....Internet Wid|
+000000a0  67 69 74 73 20 50 74 79  20 4c 74 64 30 1e 17 0d  |gits Pty Ltd0...|
+000000b0  31 30 30 34 32 34 30 39  30 39 33 38 5a 17 0d 31  |100424090938Z..1|
+000000c0  31 30 34 32 34 30 39 30  39 33 38 5a 30 45 31 0b  |10424090938Z0E1.|
+000000d0  30 09 06 03 55 04 06 13  02 41 55 31 13 30 11 06  |0...U....AU1.0..|
+000000e0  03 55 04 08 13 0a 53 6f  6d 65 2d 53 74 61 74 65  |.U....Some-State|
+000000f0  31 21 30 1f 06 03 55 04  0a 13 18 49 6e 74 65 72  |1!0...U....Inter|
+00000100  6e 65 74 20 57 69 64 67  69 74 73 20 50 74 79 20  |net Widgits Pty |
+00000110  4c 74 64 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |Ltd0..0...*.H...|
+00000120  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+00000130  bb 79 d6 f5 17 b5 e5 bf  46 10 d0 dc 69 be e6 2b  |.y......F...i..+|
+00000140  07 43 5a d0 03 2d 8a 7a  43 85 b7 14 52 e7 a5 65  |.CZ..-.zC...R..e|
+00000150  4c 2c 78 b8 23 8c b5 b4  82 e5 de 1f 95 3b 7e 62  |L,x.#........;~b|
+00000160  a5 2c a5 33 d6 fe 12 5c  7a 56 fc f5 06 bf fa 58  |.,.3...\zV.....X|
+00000170  7b 26 3f b5 cd 04 d3 d0  c9 21 96 4a c7 f4 54 9f  |{&?......!.J..T.|
+00000180  5a bf ef 42 71 00 fe 18  99 07 7f 7e 88 7d 7d f1  |Z..Bq......~.}}.|
+00000190  04 39 c4 a2 2e db 51 c9  7c e3 c0 4c 3b 32 66 01  |.9....Q.|..L;2f.|
+000001a0  cf af b1 1d b8 71 9a 1d  db db 89 6b ae da 2d 79  |.....q.....k..-y|
+000001b0  02 03 01 00 01 a3 81 a7  30 81 a4 30 1d 06 03 55  |........0..0...U|
+000001c0  1d 0e 04 16 04 14 b1 ad  e2 85 5a cf cb 28 db 69  |..........Z..(.i|
+000001d0  ce 23 69 de d3 26 8e 18  88 39 30 75 06 03 55 1d  |.#i..&...90u..U.|
+000001e0  23 04 6e 30 6c 80 14 b1  ad e2 85 5a cf cb 28 db  |#.n0l......Z..(.|
+000001f0  69 ce 23 69 de d3 26 8e  18 88 39 a1 49 a4 47 30  |i.#i..&...9.I.G0|
+00000200  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+00000210  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+00000220  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+00000230  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+00000240  74 79 20 4c 74 64 82 09  00 85 b0 bb a4 8a 7f b8  |ty Ltd..........|
+00000250  ca 30 0c 06 03 55 1d 13  04 05 30 03 01 01 ff 30  |.0...U....0....0|
+00000260  0d 06 09 2a 86 48 86 f7  0d 01 01 05 05 00 03 81  |...*.H..........|
+00000270  81 00 08 6c 45 24 c7 6b  b1 59 ab 0c 52 cc f2 b0  |...lE$.k.Y..R...|
+00000280  14 d7 87 9d 7a 64 75 b5  5a 95 66 e4 c5 2b 8e ae  |....zdu.Z.f..+..|
+00000290  12 66 1f eb 4f 38 b3 6e  60 d3 92 fd f7 41 08 b5  |.f..O8.n`....A..|
+000002a0  25 13 b1 18 7a 24 fb 30  1d ba ed 98 b9 17 ec e7  |%...z$.0........|
+000002b0  d7 31 59 db 95 d3 1d 78  ea 50 56 5c d5 82 5a 2d  |.1Y....x.PV\..Z-|
+000002c0  5a 5f 33 c4 b6 d8 c9 75  90 96 8c 0f 52 98 b5 cd  |Z_3....u....R...|
+000002d0  98 1f 89 20 5f f2 a0 1c  a3 1b 96 94 dd a9 fd 57  |... _..........W|
+000002e0  e9 70 e8 26 6d 71 99 9b  26 6e 38 50 29 6c 90 a7  |.p.&mq..&n8P)l..|
+000002f0  bd d9 16 03 03 01 11 0c  00 01 0d 03 00 19 85 04  |................|
+00000300  01 39 dc ee 44 17 5e db  d7 27 af b6 56 d9 b4 43  |.9..D.^..'..V..C|
+00000310  5a 99 cf aa 31 37 0c 6f  3a a0 f8 53 c4 74 d1 91  |Z...17.o:..S.t..|
+00000320  0a 46 f5 38 3b 5c 09 d8  97 dc 4b aa 70 26 48 f2  |.F.8;\....K.p&H.|
+00000330  d6 0b 31 c9 f8 d4 98 43  e1 6c d5 c7 b2 8e 0b 01  |..1....C.l......|
+00000340  e6 b6 00 28 80 7b fc 96  8f 0d a2 4f b0 79 af dc  |...(.{.....O.y..|
+00000350  61 28 63 33 78 f6 31 39  fd 8a f4 15 18 11 fe db  |a(c3x.19........|
+00000360  d5 07 da 2c ed 49 a0 23  bf d0 3a 38 1d 54 ae 1c  |...,.I.#..:8.T..|
+00000370  7b ea 29 ee d0 38 c1 76  a7 7f 2a f4 ce 1e ac cc  |{.)..8.v..*.....|
+00000380  94 79 90 33 04 01 00 80  8f 6a 76 5c 33 9a 1e 46  |.y.3.....jv\3..F|
+00000390  e6 c4 91 f6 69 23 05 38  bf c0 fd 9e dc 32 49 a6  |....i#.8.....2I.|
+000003a0  9a 80 43 a0 47 d4 37 f5  98 06 2f 77 cb 30 8a 95  |..C.G.7.../w.0..|
+000003b0  04 02 76 f1 2a ee 7c a6  79 df 7f 63 1e 1a 64 75  |..v.*.|.y..c..du|
+000003c0  f5 a9 1e a9 32 49 65 8b  5b 1b 02 68 7b 6c 39 e8  |....2Ie.[..h{l9.|
+000003d0  06 99 10 08 77 f7 a2 b3  22 14 14 d6 83 b8 a2 3e  |....w..."......>|
+000003e0  e3 a6 4d dd da 99 c4 d7  5c 4c d1 2f 0e 0e 21 2e  |..M.....\L./..!.|
+000003f0  e0 9d dc bf 51 f3 da 1d  7a df 8e dc 41 77 b3 18  |....Q...z...Aw..|
+00000400  38 75 ba b6 a3 75 0f fd  16 03 03 00 04 0e 00 00  |8u...u..........|
+00000410  00                                                |.|
+>>> Flow 3 (client to server)
+00000000  16 03 03 00 8a 10 00 00  86 85 04 01 e0 a2 f2 1d  |................|
+00000010  d1 f5 e7 49 09 07 df 43  5f 45 f7 fc 42 9a 81 7d  |...I...C_E..B..}|
+00000020  39 fa bf 1c 74 df 68 de  93 49 62 3e 72 e7 78 47  |9...t.h..Ib>r.xG|
+00000030  71 71 fd d0 3d 89 d3 38  aa f0 54 4a ad 1e 87 e9  |qq..=..8..TJ....|
+00000040  f7 89 90 b0 25 5b a0 81  a0 20 1a 99 5e 01 7f 05  |....%[... ..^...|
+00000050  95 78 f7 f4 4a ec 85 a9  aa cc 56 bc f7 15 37 ab  |.x..J.....V...7.|
+00000060  31 41 62 d3 ea 46 ce 94  bf 6c 00 83 a6 f0 ee dc  |1Ab..F...l......|
+00000070  0b 2a e0 5a fb f0 db 70  cd 9f 48 92 49 c9 9d 20  |.*.Z...p..H.I.. |
+00000080  7b 8c de af 9d cd 5e 20  94 4e 95 c7 32 50 94 14  |{.....^ .N..2P..|
+00000090  03 03 00 01 01 16 03 03  00 40 6a 6c 92 ef b5 d0  |.........@jl....|
+000000a0  8f 4d c7 23 5b 31 65 71  24 50 be 5a e7 95 fc 14  |.M.#[1eq$P.Z....|
+000000b0  e7 4f 33 c8 ae e0 e7 5f  63 76 3a 7b 51 cd 18 7a  |.O3...._cv:{Q..z|
+000000c0  15 15 0c aa cc 76 be fc  1e 55 a1 3a df 05 4c 84  |.....v...U.:..L.|
+000000d0  75 6e c2 2b 3d 93 76 53  41 13                    |un.+=.vSA.|
+>>> Flow 4 (server to client)
+00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
+00000010  00 00 00 00 00 00 00 00  00 00 00 e8 4b a0 ea c7  |............K...|
+00000020  e8 9e 4a c7 c5 65 84 eb  3f 4e a5 bd 97 11 b4 0b  |..J..e..?N......|
+00000030  26 b8 6d 28 16 38 c4 92  d9 45 48 7f 7f e0 74 dd  |&.m(.8...EH...t.|
+00000040  85 b7 13 5b f8 4e 5b 3f  00 95 0a 17 03 03 00 40  |...[.N[?.......@|
+00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000060  c6 52 ac 75 32 b3 86 f4  cb cf 18 66 02 40 a3 b1  |.R.u2......f.@..|
+00000070  cb 1b 25 2e ac 91 a7 91  2b 73 37 72 c1 1f 2c 2f  |..%.....+s7r..,/|
+00000080  55 59 12 bd f0 df b4 07  fa b1 13 cc 58 f3 66 54  |UY..........X.fT|
+00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
+000000a0  00 00 00 00 00 14 49 94  f4 07 cb 98 d2 6f a5 b3  |......I......o..|
+000000b0  37 bb 55 71 04 43 f9 3c  53 1c 00 31 c9 3b 8a 5c  |7.Uq.C.<S..1.;.\|
+000000c0  53 75 90 5d 59                                    |Su.]Y|
diff --git a/src/pkg/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndECDSAGiven b/src/pkg/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndECDSAGiven
new file mode 100644
index 0000000000..fb4edae9c9
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndECDSAGiven
@@ -0,0 +1,122 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 5d 01 00 00  59 03 03 52 ac 77 f8 7c  |....]...Y..R.w.||
+00000010  ec cd d0 9c df d2 a6 8b  74 43 ed af 58 14 00 1f  |........tC..X...|
+00000020  3f 85 68 1d c9 3d 20 0a  61 87 33 00 00 04 00 05  |?.h..= .a.3.....|
+00000030  00 ff 02 01 00 00 2b 00  0d 00 22 00 20 06 01 06  |......+...". ...|
+00000040  02 06 03 05 01 05 02 05  03 04 01 04 02 04 03 03  |................|
+00000050  01 03 02 03 03 02 01 02  02 02 03 01 01 00 0f 00  |................|
+00000060  01 01                                             |..|
+>>> Flow 2 (server to client)
+00000000  16 03 03 00 2a 02 00 00  26 03 03 00 00 00 00 00  |....*...&.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 05 00 16  |................|
+00000030  03 03 02 be 0b 00 02 ba  00 02 b7 00 02 b4 30 82  |..............0.|
+00000040  02 b0 30 82 02 19 a0 03  02 01 02 02 09 00 85 b0  |..0.............|
+00000050  bb a4 8a 7f b8 ca 30 0d  06 09 2a 86 48 86 f7 0d  |......0...*.H...|
+00000060  01 01 05 05 00 30 45 31  0b 30 09 06 03 55 04 06  |.....0E1.0...U..|
+00000070  13 02 41 55 31 13 30 11  06 03 55 04 08 13 0a 53  |..AU1.0...U....S|
+00000080  6f 6d 65 2d 53 74 61 74  65 31 21 30 1f 06 03 55  |ome-State1!0...U|
+00000090  04 0a 13 18 49 6e 74 65  72 6e 65 74 20 57 69 64  |....Internet Wid|
+000000a0  67 69 74 73 20 50 74 79  20 4c 74 64 30 1e 17 0d  |gits Pty Ltd0...|
+000000b0  31 30 30 34 32 34 30 39  30 39 33 38 5a 17 0d 31  |100424090938Z..1|
+000000c0  31 30 34 32 34 30 39 30  39 33 38 5a 30 45 31 0b  |10424090938Z0E1.|
+000000d0  30 09 06 03 55 04 06 13  02 41 55 31 13 30 11 06  |0...U....AU1.0..|
+000000e0  03 55 04 08 13 0a 53 6f  6d 65 2d 53 74 61 74 65  |.U....Some-State|
+000000f0  31 21 30 1f 06 03 55 04  0a 13 18 49 6e 74 65 72  |1!0...U....Inter|
+00000100  6e 65 74 20 57 69 64 67  69 74 73 20 50 74 79 20  |net Widgits Pty |
+00000110  4c 74 64 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |Ltd0..0...*.H...|
+00000120  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+00000130  bb 79 d6 f5 17 b5 e5 bf  46 10 d0 dc 69 be e6 2b  |.y......F...i..+|
+00000140  07 43 5a d0 03 2d 8a 7a  43 85 b7 14 52 e7 a5 65  |.CZ..-.zC...R..e|
+00000150  4c 2c 78 b8 23 8c b5 b4  82 e5 de 1f 95 3b 7e 62  |L,x.#........;~b|
+00000160  a5 2c a5 33 d6 fe 12 5c  7a 56 fc f5 06 bf fa 58  |.,.3...\zV.....X|
+00000170  7b 26 3f b5 cd 04 d3 d0  c9 21 96 4a c7 f4 54 9f  |{&?......!.J..T.|
+00000180  5a bf ef 42 71 00 fe 18  99 07 7f 7e 88 7d 7d f1  |Z..Bq......~.}}.|
+00000190  04 39 c4 a2 2e db 51 c9  7c e3 c0 4c 3b 32 66 01  |.9....Q.|..L;2f.|
+000001a0  cf af b1 1d b8 71 9a 1d  db db 89 6b ae da 2d 79  |.....q.....k..-y|
+000001b0  02 03 01 00 01 a3 81 a7  30 81 a4 30 1d 06 03 55  |........0..0...U|
+000001c0  1d 0e 04 16 04 14 b1 ad  e2 85 5a cf cb 28 db 69  |..........Z..(.i|
+000001d0  ce 23 69 de d3 26 8e 18  88 39 30 75 06 03 55 1d  |.#i..&...90u..U.|
+000001e0  23 04 6e 30 6c 80 14 b1  ad e2 85 5a cf cb 28 db  |#.n0l......Z..(.|
+000001f0  69 ce 23 69 de d3 26 8e  18 88 39 a1 49 a4 47 30  |i.#i..&...9.I.G0|
+00000200  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+00000210  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+00000220  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+00000230  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+00000240  74 79 20 4c 74 64 82 09  00 85 b0 bb a4 8a 7f b8  |ty Ltd..........|
+00000250  ca 30 0c 06 03 55 1d 13  04 05 30 03 01 01 ff 30  |.0...U....0....0|
+00000260  0d 06 09 2a 86 48 86 f7  0d 01 01 05 05 00 03 81  |...*.H..........|
+00000270  81 00 08 6c 45 24 c7 6b  b1 59 ab 0c 52 cc f2 b0  |...lE$.k.Y..R...|
+00000280  14 d7 87 9d 7a 64 75 b5  5a 95 66 e4 c5 2b 8e ae  |....zdu.Z.f..+..|
+00000290  12 66 1f eb 4f 38 b3 6e  60 d3 92 fd f7 41 08 b5  |.f..O8.n`....A..|
+000002a0  25 13 b1 18 7a 24 fb 30  1d ba ed 98 b9 17 ec e7  |%...z$.0........|
+000002b0  d7 31 59 db 95 d3 1d 78  ea 50 56 5c d5 82 5a 2d  |.1Y....x.PV\..Z-|
+000002c0  5a 5f 33 c4 b6 d8 c9 75  90 96 8c 0f 52 98 b5 cd  |Z_3....u....R...|
+000002d0  98 1f 89 20 5f f2 a0 1c  a3 1b 96 94 dd a9 fd 57  |... _..........W|
+000002e0  e9 70 e8 26 6d 71 99 9b  26 6e 38 50 29 6c 90 a7  |.p.&mq..&n8P)l..|
+000002f0  bd d9 16 03 03 00 0f 0d  00 00 0b 02 01 40 00 04  |.............@..|
+00000300  04 01 04 03 00 00 16 03  03 00 04 0e 00 00 00     |...............|
+>>> Flow 3 (client to server)
+00000000  16 03 03 02 0a 0b 00 02  06 00 02 03 00 02 00 30  |...............0|
+00000010  82 01 fc 30 82 01 5e 02  09 00 9a 30 84 6c 26 35  |...0..^....0.l&5|
+00000020  d9 17 30 09 06 07 2a 86  48 ce 3d 04 01 30 45 31  |..0...*.H.=..0E1|
+00000030  0b 30 09 06 03 55 04 06  13 02 41 55 31 13 30 11  |.0...U....AU1.0.|
+00000040  06 03 55 04 08 13 0a 53  6f 6d 65 2d 53 74 61 74  |..U....Some-Stat|
+00000050  65 31 21 30 1f 06 03 55  04 0a 13 18 49 6e 74 65  |e1!0...U....Inte|
+00000060  72 6e 65 74 20 57 69 64  67 69 74 73 20 50 74 79  |rnet Widgits Pty|
+00000070  20 4c 74 64 30 1e 17 0d  31 32 31 31 31 34 31 33  | Ltd0...12111413|
+00000080  32 35 35 33 5a 17 0d 32  32 31 31 31 32 31 33 32  |2553Z..221112132|
+00000090  35 35 33 5a 30 41 31 0b  30 09 06 03 55 04 06 13  |553Z0A1.0...U...|
+000000a0  02 41 55 31 0c 30 0a 06  03 55 04 08 13 03 4e 53  |.AU1.0...U....NS|
+000000b0  57 31 10 30 0e 06 03 55  04 07 13 07 50 79 72 6d  |W1.0...U....Pyrm|
+000000c0  6f 6e 74 31 12 30 10 06  03 55 04 03 13 09 4a 6f  |ont1.0...U....Jo|
+000000d0  65 6c 20 53 69 6e 67 30  81 9b 30 10 06 07 2a 86  |el Sing0..0...*.|
+000000e0  48 ce 3d 02 01 06 05 2b  81 04 00 23 03 81 86 00  |H.=....+...#....|
+000000f0  04 00 95 8c 91 75 14 c0  5e c4 57 b4 d4 c3 6f 8d  |.....u..^.W...o.|
+00000100  ae 68 1e dd 6f ce 86 e1  7e 6e b2 48 3e 81 e5 4e  |.h..o...~n.H>..N|
+00000110  e2 c6 88 4b 64 dc f5 30  bb d3 ff 65 cc 5b f4 dd  |...Kd..0...e.[..|
+00000120  b5 6a 3e 3e d0 1d de 47  c3 76 ad 19 f6 45 2c 8c  |.j>>...G.v...E,.|
+00000130  bc d8 1d 01 4c 1f 70 90  46 76 48 8b 8f 83 cc 4a  |....L.p.FvH....J|
+00000140  5c 8f 40 76 da e0 89 ec  1d 2b c4 4e 30 76 28 41  |\.@v.....+.N0v(A|
+00000150  b2 62 a8 fb 5b f1 f9 4e  7a 8d bd 09 b8 ae ea 8b  |.b..[..Nz.......|
+00000160  18 27 4f 2e 70 fe 13 96  ba c3 d3 40 16 cd 65 4e  |.'O.p......@..eN|
+00000170  ac 11 1e e6 f1 30 09 06  07 2a 86 48 ce 3d 04 01  |.....0...*.H.=..|
+00000180  03 81 8c 00 30 81 88 02  42 00 e0 14 c4 60 60 0b  |....0...B....``.|
+00000190  72 68 b0 32 5d 61 4a 02  74 5c c2 81 b9 16 a8 3f  |rh.2]aJ.t\.....?|
+000001a0  29 c8 36 c7 81 ff 6c b6  5b d9 70 f1 38 3b 50 48  |).6...l.[.p.8;PH|
+000001b0  28 94 cb 09 1a 52 f1 5d  ee 8d f2 b9 f0 f0 da d9  |(....R.]........|
+000001c0  15 3a f9 bd 03 7a 87 a2  23 35 ec 02 42 01 a3 d4  |.:...z..#5..B...|
+000001d0  8a 78 35 1c 4a 9a 23 d2  0a be 2b 10 31 9d 9c 5f  |.x5.J.#...+.1.._|
+000001e0  be e8 91 b3 da 1a f5 5d  a3 23 f5 26 8b 45 70 8d  |.......].#.&.Ep.|
+000001f0  65 62 9b 7e 01 99 3d 18  f6 10 9a 38 61 9b 2e 57  |eb.~..=....8a..W|
+00000200  e4 fa cc b1 8a ce e2 23  a0 87 f0 e1 67 51 eb 16  |.......#....gQ..|
+00000210  03 03 00 86 10 00 00 82  00 80 b9 28 1c 08 59 6e  |...........(..Yn|
+00000220  04 5f dd 1d a2 c0 04 d9  ef 2e 9c be ae a4 ce cb  |._..............|
+00000230  a3 5e 25 da ec a7 70 95  bb 78 1f 68 37 cc 76 25  |.^%...p..x.h7.v%|
+00000240  14 64 b1 23 35 7e af 93  07 56 41 f2 f7 6b 65 03  |.d.#5~...VA..ke.|
+00000250  98 08 0d dd 0b b3 57 3c  63 09 14 3e 38 7a e8 f6  |......W<c..>8z..|
+00000260  7a 92 3d f4 cc 91 78 a0  90 19 94 a8 1b 60 e5 aa  |z.=...x......`..|
+00000270  93 48 44 6c 89 e1 d7 5c  22 20 67 8e 3c 56 ef 7d  |.HDl...\" g.<V.}|
+00000280  1b 43 7d c5 d1 06 19 d4  6d 59 d7 36 59 63 e5 08  |.C}.....mY.6Yc..|
+00000290  84 53 51 1e cf a0 d7 fc  ec 2a 16 03 03 00 93 0f  |.SQ......*......|
+000002a0  00 00 8f 04 03 00 8b 30  81 88 02 42 01 99 ca f5  |.......0...B....|
+000002b0  1d 5f 49 9c 9e 98 df 42  65 dd 3c 6a 50 95 34 94  |._I....Be.<jP.4.|
+000002c0  ff 90 c1 91 89 19 4f 8c  7a a0 f6 9a 30 6d 69 25  |......O.z...0mi%|
+000002d0  d6 73 ce 37 6f 59 cc 84  62 de 48 d9 93 41 1c cb  |.s.7oY..b.H..A..|
+000002e0  93 b0 35 c9 01 f2 2b 23  68 62 97 ab 10 4c 02 42  |..5...+#hb...L.B|
+000002f0  00 ba e9 5f ba 91 96 5d  7f d3 a3 f0 c0 29 45 0d  |..._...].....)E.|
+00000300  47 64 93 92 96 6f 3a ea  a8 48 71 68 0e 67 62 b5  |Gd...o:..Hqh.gb.|
+00000310  61 09 b3 d0 6e 28 8d 43  c8 bc 6e 15 59 91 6c 74  |a...n(.C..n.Y.lt|
+00000320  6c 63 2c 02 dd 3d 40 ce  d9 2c 7e 4c f5 92 8c aa  |lc,..=@..,~L....|
+00000330  3a b7 14 03 03 00 01 01  16 03 03 00 24 46 dd 87  |:...........$F..|
+00000340  c7 50 96 64 41 11 ad b6  68 cc 90 04 85 21 48 aa  |.P.dA...h....!H.|
+00000350  43 da 06 a6 7e ec 73 71  be 37 9a a5 10 1b c7 5c  |C...~.sq.7.....\|
+00000360  a7                                                |.|
+>>> Flow 4 (server to client)
+00000000  14 03 03 00 01 01 16 03  03 00 24 49 19 94 44 b4  |..........$I..D.|
+00000010  e7 50 8a 4f 7a 4f 05 28  e3 bc ae fc e5 ed 1c e0  |.P.OzO.(........|
+00000020  34 0e a7 99 99 08 44 fc  95 5a 91 c9 f4 29 4a 17  |4.....D..Z...)J.|
+00000030  03 03 00 21 5f 7b 31 75  5f 5c 84 a9 c6 5b cf e5  |...!_{1u_\...[..|
+00000040  90 11 a9 64 62 5d cf 54  f2 40 4f fa 1d 52 85 d1  |...db].T.@O..R..|
+00000050  52 5a 2d 7a 18 15 03 03  00 16 4c 68 39 b1 4b 18  |RZ-z......Lh9.K.|
+00000060  9e 67 77 5e 89 1d ae f9  17 fd 16 03 76 12 a6 73  |.gw^........v..s|
diff --git a/src/pkg/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndGiven b/src/pkg/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndGiven
new file mode 100644
index 0000000000..0511550287
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndGiven
@@ -0,0 +1,120 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 5d 01 00 00  59 03 03 52 ac 77 f8 5a  |....]...Y..R.w.Z|
+00000010  89 61 73 8e 24 3b 48 6d  30 b4 36 ee 17 10 58 76  |.as.$;Hm0.6...Xv|
+00000020  d0 48 1d 93 eb 78 c9 ad  c0 53 ed 00 00 04 00 05  |.H...x...S......|
+00000030  00 ff 02 01 00 00 2b 00  0d 00 22 00 20 06 01 06  |......+...". ...|
+00000040  02 06 03 05 01 05 02 05  03 04 01 04 02 04 03 03  |................|
+00000050  01 03 02 03 03 02 01 02  02 02 03 01 01 00 0f 00  |................|
+00000060  01 01                                             |..|
+>>> Flow 2 (server to client)
+00000000  16 03 03 00 2a 02 00 00  26 03 03 00 00 00 00 00  |....*...&.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 05 00 16  |................|
+00000030  03 03 02 be 0b 00 02 ba  00 02 b7 00 02 b4 30 82  |..............0.|
+00000040  02 b0 30 82 02 19 a0 03  02 01 02 02 09 00 85 b0  |..0.............|
+00000050  bb a4 8a 7f b8 ca 30 0d  06 09 2a 86 48 86 f7 0d  |......0...*.H...|
+00000060  01 01 05 05 00 30 45 31  0b 30 09 06 03 55 04 06  |.....0E1.0...U..|
+00000070  13 02 41 55 31 13 30 11  06 03 55 04 08 13 0a 53  |..AU1.0...U....S|
+00000080  6f 6d 65 2d 53 74 61 74  65 31 21 30 1f 06 03 55  |ome-State1!0...U|
+00000090  04 0a 13 18 49 6e 74 65  72 6e 65 74 20 57 69 64  |....Internet Wid|
+000000a0  67 69 74 73 20 50 74 79  20 4c 74 64 30 1e 17 0d  |gits Pty Ltd0...|
+000000b0  31 30 30 34 32 34 30 39  30 39 33 38 5a 17 0d 31  |100424090938Z..1|
+000000c0  31 30 34 32 34 30 39 30  39 33 38 5a 30 45 31 0b  |10424090938Z0E1.|
+000000d0  30 09 06 03 55 04 06 13  02 41 55 31 13 30 11 06  |0...U....AU1.0..|
+000000e0  03 55 04 08 13 0a 53 6f  6d 65 2d 53 74 61 74 65  |.U....Some-State|
+000000f0  31 21 30 1f 06 03 55 04  0a 13 18 49 6e 74 65 72  |1!0...U....Inter|
+00000100  6e 65 74 20 57 69 64 67  69 74 73 20 50 74 79 20  |net Widgits Pty |
+00000110  4c 74 64 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |Ltd0..0...*.H...|
+00000120  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+00000130  bb 79 d6 f5 17 b5 e5 bf  46 10 d0 dc 69 be e6 2b  |.y......F...i..+|
+00000140  07 43 5a d0 03 2d 8a 7a  43 85 b7 14 52 e7 a5 65  |.CZ..-.zC...R..e|
+00000150  4c 2c 78 b8 23 8c b5 b4  82 e5 de 1f 95 3b 7e 62  |L,x.#........;~b|
+00000160  a5 2c a5 33 d6 fe 12 5c  7a 56 fc f5 06 bf fa 58  |.,.3...\zV.....X|
+00000170  7b 26 3f b5 cd 04 d3 d0  c9 21 96 4a c7 f4 54 9f  |{&?......!.J..T.|
+00000180  5a bf ef 42 71 00 fe 18  99 07 7f 7e 88 7d 7d f1  |Z..Bq......~.}}.|
+00000190  04 39 c4 a2 2e db 51 c9  7c e3 c0 4c 3b 32 66 01  |.9....Q.|..L;2f.|
+000001a0  cf af b1 1d b8 71 9a 1d  db db 89 6b ae da 2d 79  |.....q.....k..-y|
+000001b0  02 03 01 00 01 a3 81 a7  30 81 a4 30 1d 06 03 55  |........0..0...U|
+000001c0  1d 0e 04 16 04 14 b1 ad  e2 85 5a cf cb 28 db 69  |..........Z..(.i|
+000001d0  ce 23 69 de d3 26 8e 18  88 39 30 75 06 03 55 1d  |.#i..&...90u..U.|
+000001e0  23 04 6e 30 6c 80 14 b1  ad e2 85 5a cf cb 28 db  |#.n0l......Z..(.|
+000001f0  69 ce 23 69 de d3 26 8e  18 88 39 a1 49 a4 47 30  |i.#i..&...9.I.G0|
+00000200  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+00000210  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+00000220  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+00000230  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+00000240  74 79 20 4c 74 64 82 09  00 85 b0 bb a4 8a 7f b8  |ty Ltd..........|
+00000250  ca 30 0c 06 03 55 1d 13  04 05 30 03 01 01 ff 30  |.0...U....0....0|
+00000260  0d 06 09 2a 86 48 86 f7  0d 01 01 05 05 00 03 81  |...*.H..........|
+00000270  81 00 08 6c 45 24 c7 6b  b1 59 ab 0c 52 cc f2 b0  |...lE$.k.Y..R...|
+00000280  14 d7 87 9d 7a 64 75 b5  5a 95 66 e4 c5 2b 8e ae  |....zdu.Z.f..+..|
+00000290  12 66 1f eb 4f 38 b3 6e  60 d3 92 fd f7 41 08 b5  |.f..O8.n`....A..|
+000002a0  25 13 b1 18 7a 24 fb 30  1d ba ed 98 b9 17 ec e7  |%...z$.0........|
+000002b0  d7 31 59 db 95 d3 1d 78  ea 50 56 5c d5 82 5a 2d  |.1Y....x.PV\..Z-|
+000002c0  5a 5f 33 c4 b6 d8 c9 75  90 96 8c 0f 52 98 b5 cd  |Z_3....u....R...|
+000002d0  98 1f 89 20 5f f2 a0 1c  a3 1b 96 94 dd a9 fd 57  |... _..........W|
+000002e0  e9 70 e8 26 6d 71 99 9b  26 6e 38 50 29 6c 90 a7  |.p.&mq..&n8P)l..|
+000002f0  bd d9 16 03 03 00 0f 0d  00 00 0b 02 01 40 00 04  |.............@..|
+00000300  04 01 04 03 00 00 16 03  03 00 04 0e 00 00 00     |...............|
+>>> Flow 3 (client to server)
+00000000  16 03 03 01 fb 0b 00 01  f7 00 01 f4 00 01 f1 30  |...............0|
+00000010  82 01 ed 30 82 01 58 a0  03 02 01 02 02 01 00 30  |...0..X........0|
+00000020  0b 06 09 2a 86 48 86 f7  0d 01 01 05 30 26 31 10  |...*.H......0&1.|
+00000030  30 0e 06 03 55 04 0a 13  07 41 63 6d 65 20 43 6f  |0...U....Acme Co|
+00000040  31 12 30 10 06 03 55 04  03 13 09 31 32 37 2e 30  |1.0...U....127.0|
+00000050  2e 30 2e 31 30 1e 17 0d  31 31 31 32 30 38 30 37  |.0.10...11120807|
+00000060  35 35 31 32 5a 17 0d 31  32 31 32 30 37 30 38 30  |5512Z..121207080|
+00000070  30 31 32 5a 30 26 31 10  30 0e 06 03 55 04 0a 13  |012Z0&1.0...U...|
+00000080  07 41 63 6d 65 20 43 6f  31 12 30 10 06 03 55 04  |.Acme Co1.0...U.|
+00000090  03 13 09 31 32 37 2e 30  2e 30 2e 31 30 81 9c 30  |...127.0.0.10..0|
+000000a0  0b 06 09 2a 86 48 86 f7  0d 01 01 01 03 81 8c 00  |...*.H..........|
+000000b0  30 81 88 02 81 80 4e d0  7b 31 e3 82 64 d9 59 c0  |0.....N.{1..d.Y.|
+000000c0  c2 87 a4 5e 1e 8b 73 33  c7 63 53 df 66 92 06 84  |...^..s3.cS.f...|
+000000d0  f6 64 d5 8f e4 36 a7 1d  2b e8 b3 20 36 45 23 b5  |.d...6..+.. 6E#.|
+000000e0  e3 95 ae ed e0 f5 20 9c  8d 95 df 7f 5a 12 ef 87  |...... .....Z...|
+000000f0  e4 5b 68 e4 e9 0e 74 ec  04 8a 7f de 93 27 c4 01  |.[h...t......'..|
+00000100  19 7a bd f2 dc 3d 14 ab  d0 54 ca 21 0c d0 4d 6e  |.z...=...T.!..Mn|
+00000110  87 2e 5c c5 d2 bb 4d 4b  4f ce b6 2c f7 7e 88 ec  |..\...MKO..,.~..|
+00000120  7c d7 02 91 74 a6 1e 0c  1a da e3 4a 5a 2e de 13  ||...t......JZ...|
+00000130  9c 4c 40 88 59 93 02 03  01 00 01 a3 32 30 30 30  |.L@.Y.......2000|
+00000140  0e 06 03 55 1d 0f 01 01  ff 04 04 03 02 00 a0 30  |...U...........0|
+00000150  0d 06 03 55 1d 0e 04 06  04 04 01 02 03 04 30 0f  |...U..........0.|
+00000160  06 03 55 1d 23 04 08 30  06 80 04 01 02 03 04 30  |..U.#..0.......0|
+00000170  0b 06 09 2a 86 48 86 f7  0d 01 01 05 03 81 81 00  |...*.H..........|
+00000180  36 1f b3 7a 0c 75 c9 6e  37 46 61 2b d5 bd c0 a7  |6..z.u.n7Fa+....|
+00000190  4b cc 46 9a 81 58 7c 85  79 29 c8 c8 c6 67 dd 32  |K.F..X|.y)...g.2|
+000001a0  56 45 2b 75 b6 e9 24 a9  50 9a be 1f 5a fa 1a 15  |VE+u..$.P...Z...|
+000001b0  d9 cc 55 95 72 16 83 b9  c2 b6 8f fd 88 8c 38 84  |..U.r.........8.|
+000001c0  1d ab 5d 92 31 13 4f fd  83 3b c6 9d f1 11 62 b6  |..].1.O..;....b.|
+000001d0  8b ec ab 67 be c8 64 b0  11 50 46 58 17 6b 99 1c  |...g..d..PFX.k..|
+000001e0  d3 1d fc 06 f1 0e e5 96  a8 0c f9 78 20 b7 44 18  |...........x .D.|
+000001f0  51 8d 10 7e 4f 94 67 df  a3 4e 70 73 8e 90 91 85  |Q..~O.g..Nps....|
+00000200  16 03 03 00 86 10 00 00  82 00 80 05 f0 5b e7 ee  |.............[..|
+00000210  1a a0 9d 54 85 3c c9 1d  e0 fd d7 21 ed d2 34 0a  |...T.<.....!..4.|
+00000220  91 da db 03 b4 c8 b5 50  d9 5f 8e 31 9e 56 ec 62  |.......P._.1.V.b|
+00000230  ff df 79 37 6e 22 c1 11  00 a2 e3 ed 63 29 9e 26  |..y7n"......c).&|
+00000240  4c d1 7a 6a d4 b6 06 cc  06 da 72 a8 4b 08 0b fc  |L.zj......r.K...|
+00000250  f4 23 e8 43 9b 9f 55 cc  dc 4a e3 45 be b5 be d7  |.#.C..U..J.E....|
+00000260  e5 34 e5 86 ca 45 b4 15  9d 8c bc 0c 66 f2 e5 24  |.4...E......f..$|
+00000270  2c af d8 1a c0 9e dc f7  cc 30 43 d1 1e 8e 4c c0  |,........0C...L.|
+00000280  e8 7b 8e a5 21 37 35 ae  b9 c4 aa 16 03 03 00 88  |.{..!75.........|
+00000290  0f 00 00 84 04 01 00 80  2f db 55 56 9a 38 36 98  |......../.UV.86.|
+000002a0  b3 46 cf 9f 91 37 92 98  97 d6 7e 7b 5e b8 cc ef  |.F...7....~{^...|
+000002b0  b9 f8 69 91 e4 f5 4a bf  2c 6d f5 b2 d0 61 b3 79  |..i...J.,m...a.y|
+000002c0  f0 6a 22 3c 32 bf 72 c3  7d 4c 30 68 dd d6 cd 53  |.j"<2.r.}L0h...S|
+000002d0  c1 88 84 11 90 7f 75 e2  5b ca 80 a9 c9 8e 6e ef  |......u.[.....n.|
+000002e0  87 8b 80 06 c5 ce 95 a5  b5 20 d6 75 04 66 87 29  |......... .u.f.)|
+000002f0  06 1d 59 0b b5 d2 b1 07  5e 09 c3 1d 9e 47 0e 07  |..Y.....^....G..|
+00000300  d9 83 dd 56 e5 93 b6 1e  e7 61 5c f8 2b 8a e7 83  |...V.....a\.+...|
+00000310  52 15 2f bd 9c 91 3b a3  14 03 03 00 01 01 16 03  |R./...;.........|
+00000320  03 00 24 64 d6 db a5 d4  0c 9f 03 be c9 f1 20 5c  |..$d.......... \|
+00000330  5f 5a 41 1e 5e c9 c6 04  e7 f5 7f 68 db 38 a6 8c  |_ZA.^......h.8..|
+00000340  cb 5e b9 99 5e b3 69                              |.^..^.i|
+>>> Flow 4 (server to client)
+00000000  14 03 03 00 01 01 16 03  03 00 24 5a 42 72 e0 fc  |..........$ZBr..|
+00000010  c7 ca 9c 74 da 0a 85 df  d5 32 f4 24 aa e1 45 39  |...t.....2.$..E9|
+00000020  5c 86 29 99 85 c8 1b cb  bc ba 1d 27 68 1a a7 17  |\.)........'h...|
+00000030  03 03 00 21 95 56 9f 44  51 a4 51 67 3f ee 8b e4  |...!.V.DQ.Qg?...|
+00000040  19 03 e4 5f 15 aa b7 ce  7f db 15 a0 15 65 e7 cc  |..._.........e..|
+00000050  c5 25 72 ae 0c 15 03 03  00 16 e5 97 49 3d f1 5e  |.%r.........I=.^|
+00000060  53 4e d9 40 cf 81 de 3b  5f 5e b2 2a 78 51 ab 66  |SN.@...;_^.*xQ.f|
diff --git a/src/pkg/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedNotGiven b/src/pkg/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedNotGiven
new file mode 100644
index 0000000000..1543e83c78
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedNotGiven
@@ -0,0 +1,80 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 5d 01 00 00  59 03 03 52 ac 77 f8 c7  |....]...Y..R.w..|
+00000010  e6 0f 80 12 13 8e 2d a8  61 1f 31 ba 94 f9 0e f8  |......-.a.1.....|
+00000020  43 a5 2b c8 95 c5 f7 47  b4 f9 b5 00 00 04 00 05  |C.+....G........|
+00000030  00 ff 02 01 00 00 2b 00  0d 00 22 00 20 06 01 06  |......+...". ...|
+00000040  02 06 03 05 01 05 02 05  03 04 01 04 02 04 03 03  |................|
+00000050  01 03 02 03 03 02 01 02  02 02 03 01 01 00 0f 00  |................|
+00000060  01 01                                             |..|
+>>> Flow 2 (server to client)
+00000000  16 03 03 00 2a 02 00 00  26 03 03 00 00 00 00 00  |....*...&.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 05 00 16  |................|
+00000030  03 03 02 be 0b 00 02 ba  00 02 b7 00 02 b4 30 82  |..............0.|
+00000040  02 b0 30 82 02 19 a0 03  02 01 02 02 09 00 85 b0  |..0.............|
+00000050  bb a4 8a 7f b8 ca 30 0d  06 09 2a 86 48 86 f7 0d  |......0...*.H...|
+00000060  01 01 05 05 00 30 45 31  0b 30 09 06 03 55 04 06  |.....0E1.0...U..|
+00000070  13 02 41 55 31 13 30 11  06 03 55 04 08 13 0a 53  |..AU1.0...U....S|
+00000080  6f 6d 65 2d 53 74 61 74  65 31 21 30 1f 06 03 55  |ome-State1!0...U|
+00000090  04 0a 13 18 49 6e 74 65  72 6e 65 74 20 57 69 64  |....Internet Wid|
+000000a0  67 69 74 73 20 50 74 79  20 4c 74 64 30 1e 17 0d  |gits Pty Ltd0...|
+000000b0  31 30 30 34 32 34 30 39  30 39 33 38 5a 17 0d 31  |100424090938Z..1|
+000000c0  31 30 34 32 34 30 39 30  39 33 38 5a 30 45 31 0b  |10424090938Z0E1.|
+000000d0  30 09 06 03 55 04 06 13  02 41 55 31 13 30 11 06  |0...U....AU1.0..|
+000000e0  03 55 04 08 13 0a 53 6f  6d 65 2d 53 74 61 74 65  |.U....Some-State|
+000000f0  31 21 30 1f 06 03 55 04  0a 13 18 49 6e 74 65 72  |1!0...U....Inter|
+00000100  6e 65 74 20 57 69 64 67  69 74 73 20 50 74 79 20  |net Widgits Pty |
+00000110  4c 74 64 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |Ltd0..0...*.H...|
+00000120  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+00000130  bb 79 d6 f5 17 b5 e5 bf  46 10 d0 dc 69 be e6 2b  |.y......F...i..+|
+00000140  07 43 5a d0 03 2d 8a 7a  43 85 b7 14 52 e7 a5 65  |.CZ..-.zC...R..e|
+00000150  4c 2c 78 b8 23 8c b5 b4  82 e5 de 1f 95 3b 7e 62  |L,x.#........;~b|
+00000160  a5 2c a5 33 d6 fe 12 5c  7a 56 fc f5 06 bf fa 58  |.,.3...\zV.....X|
+00000170  7b 26 3f b5 cd 04 d3 d0  c9 21 96 4a c7 f4 54 9f  |{&?......!.J..T.|
+00000180  5a bf ef 42 71 00 fe 18  99 07 7f 7e 88 7d 7d f1  |Z..Bq......~.}}.|
+00000190  04 39 c4 a2 2e db 51 c9  7c e3 c0 4c 3b 32 66 01  |.9....Q.|..L;2f.|
+000001a0  cf af b1 1d b8 71 9a 1d  db db 89 6b ae da 2d 79  |.....q.....k..-y|
+000001b0  02 03 01 00 01 a3 81 a7  30 81 a4 30 1d 06 03 55  |........0..0...U|
+000001c0  1d 0e 04 16 04 14 b1 ad  e2 85 5a cf cb 28 db 69  |..........Z..(.i|
+000001d0  ce 23 69 de d3 26 8e 18  88 39 30 75 06 03 55 1d  |.#i..&...90u..U.|
+000001e0  23 04 6e 30 6c 80 14 b1  ad e2 85 5a cf cb 28 db  |#.n0l......Z..(.|
+000001f0  69 ce 23 69 de d3 26 8e  18 88 39 a1 49 a4 47 30  |i.#i..&...9.I.G0|
+00000200  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+00000210  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+00000220  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+00000230  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+00000240  74 79 20 4c 74 64 82 09  00 85 b0 bb a4 8a 7f b8  |ty Ltd..........|
+00000250  ca 30 0c 06 03 55 1d 13  04 05 30 03 01 01 ff 30  |.0...U....0....0|
+00000260  0d 06 09 2a 86 48 86 f7  0d 01 01 05 05 00 03 81  |...*.H..........|
+00000270  81 00 08 6c 45 24 c7 6b  b1 59 ab 0c 52 cc f2 b0  |...lE$.k.Y..R...|
+00000280  14 d7 87 9d 7a 64 75 b5  5a 95 66 e4 c5 2b 8e ae  |....zdu.Z.f..+..|
+00000290  12 66 1f eb 4f 38 b3 6e  60 d3 92 fd f7 41 08 b5  |.f..O8.n`....A..|
+000002a0  25 13 b1 18 7a 24 fb 30  1d ba ed 98 b9 17 ec e7  |%...z$.0........|
+000002b0  d7 31 59 db 95 d3 1d 78  ea 50 56 5c d5 82 5a 2d  |.1Y....x.PV\..Z-|
+000002c0  5a 5f 33 c4 b6 d8 c9 75  90 96 8c 0f 52 98 b5 cd  |Z_3....u....R...|
+000002d0  98 1f 89 20 5f f2 a0 1c  a3 1b 96 94 dd a9 fd 57  |... _..........W|
+000002e0  e9 70 e8 26 6d 71 99 9b  26 6e 38 50 29 6c 90 a7  |.p.&mq..&n8P)l..|
+000002f0  bd d9 16 03 03 00 0f 0d  00 00 0b 02 01 40 00 04  |.............@..|
+00000300  04 01 04 03 00 00 16 03  03 00 04 0e 00 00 00     |...............|
+>>> Flow 3 (client to server)
+00000000  16 03 03 00 07 0b 00 00  03 00 00 00 16 03 03 00  |................|
+00000010  86 10 00 00 82 00 80 8c  f3 9d ed 36 34 11 9b 89  |...........64...|
+00000020  22 b2 0e 20 0c be c6 91  f5 2e 7f 35 e9 14 b1 b9  |".. .......5....|
+00000030  c6 02 cf da d2 3a 81 a4  18 1b 32 0c 21 fe cd a5  |.....:....2.!...|
+00000040  c2 74 0c db 29 9c 73 e4  de 7c c4 8d f6 2d b0 0e  |.t..).s..|...-..|
+00000050  f5 b4 48 b5 24 94 be 3f  c2 da 2a fe 82 b9 66 1f  |..H.$..?..*...f.|
+00000060  45 12 e9 50 a9 e4 09 2d  6e 67 e2 63 21 a8 e7 23  |E..P...-ng.c!..#|
+00000070  2e ec e3 e3 39 dc f9 54  c4 5a 5c 3e e8 a1 fc 6a  |....9..T.Z\>...j|
+00000080  98 38 23 85 a2 a4 f4 26  4c 8e 00 fa 99 f9 53 3f  |.8#....&L.....S?|
+00000090  ce f7 34 4e a3 1b 2e 14  03 03 00 01 01 16 03 03  |..4N............|
+000000a0  00 24 e2 c8 25 81 12 b8  b1 28 f9 a3 8c 94 9e 7c  |.$..%....(.....||
+000000b0  63 78 f0 04 74 53 31 50  40 29 2f 6c 0a 09 05 6a  |cx..tS1P@)/l...j|
+000000c0  32 5d 92 1a 0c 2e                                 |2]....|
+>>> Flow 4 (server to client)
+00000000  14 03 03 00 01 01 16 03  03 00 24 fb 18 af ff 1b  |..........$.....|
+00000010  72 08 c5 e1 1f c6 8b 43  18 0b 54 65 bd 6e d8 f4  |r......C..Te.n..|
+00000020  7e 3e e4 b0 bb 73 39 bf  24 ab d4 cd 4a 88 b2 17  |~>...s9.$...J...|
+00000030  03 03 00 21 ee 69 69 7c  70 70 d7 63 b7 cf 3c 50  |...!.ii|pp.c..<P|
+00000040  30 96 0a f8 1b ed c8 3a  c7 a4 8e d5 35 5d e1 8d  |0......:....5]..|
+00000050  bd 26 6e 1e 33 15 03 03  00 16 bc 99 f6 0b 44 7e  |.&n.3.........D~|
+00000060  6a 5b 65 51 8d 2d b9 e0  bf 47 fa 46 f7 0a f0 9f  |j[eQ.-...G.F....|
diff --git a/src/pkg/crypto/tls/testdata/Server-TLSv12-ECDHE-ECDSA-AES b/src/pkg/crypto/tls/testdata/Server-TLSv12-ECDHE-ECDSA-AES
new file mode 100644
index 0000000000..1ba6bc8388
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Server-TLSv12-ECDHE-ECDSA-AES
@@ -0,0 +1,97 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 9d 01 00 00  99 03 03 52 ac 77 f8 5b  |...........R.w.[|
+00000010  57 5f 06 3b 30 36 42 66  99 e9 c9 8c 57 1c cf 14  |W_.;06Bf....W...|
+00000020  c9 a8 20 ee da a6 55 d4  d9 ff 1c 00 00 04 c0 0a  |.. ...U.........|
+00000030  00 ff 02 01 00 00 6b 00  0b 00 04 03 00 01 02 00  |......k.........|
+00000040  0a 00 34 00 32 00 0e 00  0d 00 19 00 0b 00 0c 00  |..4.2...........|
+00000050  18 00 09 00 0a 00 16 00  17 00 08 00 06 00 07 00  |................|
+00000060  14 00 15 00 04 00 05 00  12 00 13 00 01 00 02 00  |................|
+00000070  03 00 0f 00 10 00 11 00  0d 00 22 00 20 06 01 06  |..........". ...|
+00000080  02 06 03 05 01 05 02 05  03 04 01 04 02 04 03 03  |................|
+00000090  01 03 02 03 03 02 01 02  02 02 03 01 01 00 0f 00  |................|
+000000a0  01 01                                             |..|
+>>> Flow 2 (server to client)
+00000000  16 03 03 00 2a 02 00 00  26 03 03 00 00 00 00 00  |....*...&.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 c0 0a 00 16  |................|
+00000030  03 03 02 0e 0b 00 02 0a  00 02 07 00 02 04 30 82  |..............0.|
+00000040  02 00 30 82 01 62 02 09  00 b8 bf 2d 47 a0 d2 eb  |..0..b.....-G...|
+00000050  f4 30 09 06 07 2a 86 48  ce 3d 04 01 30 45 31 0b  |.0...*.H.=..0E1.|
+00000060  30 09 06 03 55 04 06 13  02 41 55 31 13 30 11 06  |0...U....AU1.0..|
+00000070  03 55 04 08 13 0a 53 6f  6d 65 2d 53 74 61 74 65  |.U....Some-State|
+00000080  31 21 30 1f 06 03 55 04  0a 13 18 49 6e 74 65 72  |1!0...U....Inter|
+00000090  6e 65 74 20 57 69 64 67  69 74 73 20 50 74 79 20  |net Widgits Pty |
+000000a0  4c 74 64 30 1e 17 0d 31  32 31 31 32 32 31 35 30  |Ltd0...121122150|
+000000b0  36 33 32 5a 17 0d 32 32  31 31 32 30 31 35 30 36  |632Z..2211201506|
+000000c0  33 32 5a 30 45 31 0b 30  09 06 03 55 04 06 13 02  |32Z0E1.0...U....|
+000000d0  41 55 31 13 30 11 06 03  55 04 08 13 0a 53 6f 6d  |AU1.0...U....Som|
+000000e0  65 2d 53 74 61 74 65 31  21 30 1f 06 03 55 04 0a  |e-State1!0...U..|
+000000f0  13 18 49 6e 74 65 72 6e  65 74 20 57 69 64 67 69  |..Internet Widgi|
+00000100  74 73 20 50 74 79 20 4c  74 64 30 81 9b 30 10 06  |ts Pty Ltd0..0..|
+00000110  07 2a 86 48 ce 3d 02 01  06 05 2b 81 04 00 23 03  |.*.H.=....+...#.|
+00000120  81 86 00 04 00 c4 a1 ed  be 98 f9 0b 48 73 36 7e  |............Hs6~|
+00000130  c3 16 56 11 22 f2 3d 53  c3 3b 4d 21 3d cd 6b 75  |..V.".=S.;M!=.ku|
+00000140  e6 f6 b0 dc 9a df 26 c1  bc b2 87 f0 72 32 7c b3  |......&.....r2|.|
+00000150  64 2f 1c 90 bc ea 68 23  10 7e fe e3 25 c0 48 3a  |d/....h#.~..%.H:|
+00000160  69 e0 28 6d d3 37 00 ef  04 62 dd 0d a0 9c 70 62  |i.(m.7...b....pb|
+00000170  83 d8 81 d3 64 31 aa 9e  97 31 bd 96 b0 68 c0 9b  |....d1...1...h..|
+00000180  23 de 76 64 3f 1a 5c 7f  e9 12 0e 58 58 b6 5f 70  |#.vd?.\....XX._p|
+00000190  dd 9b d8 ea d5 d7 f5 d5  cc b9 b6 9f 30 66 5b 66  |............0f[f|
+000001a0  9a 20 e2 27 e5 bf fe 3b  30 09 06 07 2a 86 48 ce  |. .'...;0...*.H.|
+000001b0  3d 04 01 03 81 8c 00 30  81 88 02 42 01 88 a2 4f  |=......0...B...O|
+000001c0  eb e2 45 c5 48 7d 1b ac  f5 ed 98 9d ae 47 70 c0  |..E.H}.......Gp.|
+000001d0  5e 1b b6 2f bd f1 b6 4d  b7 61 40 d3 11 a2 ce ee  |^../...M.a@.....|
+000001e0  0b 7e 92 7e ff 76 9d c3  3b 7e a5 3f ce fa 10 e2  |.~.~.v..;~.?....|
+000001f0  59 ec 47 2d 7c ac da 4e  97 0e 15 a0 6f d0 02 42  |Y.G-|..N....o..B|
+00000200  01 4d fc be 67 13 9c 2d  05 0e bd 3f a3 8c 25 c1  |.M..g..-...?..%.|
+00000210  33 13 83 0d 94 06 bb d4  37 7a f6 ec 7a c9 86 2e  |3.......7z..z...|
+00000220  dd d7 11 69 7f 85 7c 56  de fb 31 78 2b e4 c7 78  |...i..|V..1x+..x|
+00000230  0d ae cb be 9e 4e 36 24  31 7b 6a 0f 39 95 12 07  |.....N6$1{j.9...|
+00000240  8f 2a 16 03 03 01 1c 0c  00 01 18 03 00 19 85 04  |.*..............|
+00000250  01 39 dc ee 44 17 5e db  d7 27 af b6 56 d9 b4 43  |.9..D.^..'..V..C|
+00000260  5a 99 cf aa 31 37 0c 6f  3a a0 f8 53 c4 74 d1 91  |Z...17.o:..S.t..|
+00000270  0a 46 f5 38 3b 5c 09 d8  97 dc 4b aa 70 26 48 f2  |.F.8;\....K.p&H.|
+00000280  d6 0b 31 c9 f8 d4 98 43  e1 6c d5 c7 b2 8e 0b 01  |..1....C.l......|
+00000290  e6 b6 00 28 80 7b fc 96  8f 0d a2 4f b0 79 af dc  |...(.{.....O.y..|
+000002a0  61 28 63 33 78 f6 31 39  fd 8a f4 15 18 11 fe db  |a(c3x.19........|
+000002b0  d5 07 da 2c ed 49 a0 23  bf d0 3a 38 1d 54 ae 1c  |...,.I.#..:8.T..|
+000002c0  7b ea 29 ee d0 38 c1 76  a7 7f 2a f4 ce 1e ac cc  |{.)..8.v..*.....|
+000002d0  94 79 90 33 04 03 00 8b  30 81 88 02 42 00 c6 85  |.y.3....0...B...|
+000002e0  8e 06 b7 04 04 e9 cd 9e  3e cb 66 23 95 b4 42 9c  |........>.f#..B.|
+000002f0  64 81 39 05 3f b5 21 f8  28 af 60 6b 4d 3d ba a1  |d.9.?.!.(.`kM=..|
+00000300  4b 5e 77 ef e7 59 28 fe  1d c1 27 a2 ff a8 de 33  |K^w..Y(...'....3|
+00000310  48 b3 c1 85 6a 42 9b f9  7e 7e 31 c2 e5 bd 66 02  |H...jB..~~1...f.|
+00000320  42 00 ad 7d 06 35 ab ec  8d ac d4 ba 1b 49 5e 05  |B..}.5.......I^.|
+00000330  5f f0 97 93 82 b8 2b 8d  91 98 63 8e b4 14 62 db  |_.....+...c...b.|
+00000340  1e c9 2c 13 30 dc 4e 5e  b7 d5 65 00 16 6c 30 04  |..,.0.N^..e..l0.|
+00000350  cb 66 02 97 ea 7f 7a 16  90 97 16 51 4e de 88 c8  |.f....z....QN...|
+00000360  63 95 8f 16 03 03 00 04  0e 00 00 00              |c...........|
+>>> Flow 3 (client to server)
+00000000  16 03 03 00 8a 10 00 00  86 85 04 00 c6 26 3b 69  |.............&;i|
+00000010  8e 54 b7 33 1f be ba 55  54 2d 37 79 d2 69 b9 ff  |.T.3...UT-7y.i..|
+00000020  2f 18 4f e4 64 94 84 37  d3 34 5b 51 cd cd 62 45  |/.O.d..7.4[Q..bE|
+00000030  6f b6 78 46 ed 2e 7d 75  93 d7 b9 e3 18 d2 80 1e  |o.xF..}u........|
+00000040  55 09 57 13 6d 74 04 c6  f2 18 85 d2 44 01 7e 0a  |U.W.mt......D.~.|
+00000050  d7 31 93 51 45 47 74 11  a9 db b1 1b 93 d0 64 75  |.1.QEGt.......du|
+00000060  e1 be 61 88 5c 26 c3 a6  82 b0 04 ad b2 39 26 c7  |..a.\&.......9&.|
+00000070  75 fe ac 50 cd f4 87 8d  02 3a b4 06 9d 93 d5 09  |u..P.....:......|
+00000080  2c 8a fd 20 1c 34 73 8f  47 96 85 ce 80 fc b1 14  |,.. .4s.G.......|
+00000090  03 03 00 01 01 16 03 03  00 40 f2 63 f6 c1 21 89  |.........@.c..!.|
+000000a0  34 a9 cc a3 ff 71 a0 c5  9e b7 f9 32 80 8f 60 cc  |4....q.....2..`.|
+000000b0  bf 58 43 7c 5e d5 52 f1  d4 ea a3 50 ac 0d b5 ce  |.XC|^.R....P....|
+000000c0  80 82 f7 91 9b 07 f6 38  a8 90 b2 15 77 f5 b6 7c  |.......8....w..||
+000000d0  f9 df 62 f1 dc 15 21 04  dc 89                    |..b...!...|
+>>> Flow 4 (server to client)
+00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
+00000010  00 00 00 00 00 00 00 00  00 00 00 3c d0 01 76 c9  |...........<..v.|
+00000020  0a 55 3f 92 47 ec 04 22  d8 79 3e 0c 7d f9 fe 12  |.U?.G..".y>.}...|
+00000030  c1 21 ce 50 d9 f1 2d 21  38 1a 74 44 e2 0d d0 e6  |.!.P..-!8.tD....|
+00000040  e5 e1 e2 a0 0e 20 59 7b  2c 62 57 17 03 03 00 40  |..... Y{,bW....@|
+00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000060  c7 92 46 7e 19 ca ca a3  39 e5 11 de 06 bd a8 ab  |..F~....9.......|
+00000070  68 75 b7 32 0b 8c a9 80  42 9c a2 ae a4 98 f1 5b  |hu.2....B......[|
+00000080  35 7b 05 63 2d a0 58 ae  01 9f b1 24 12 06 00 c5  |5{.c-.X....$....|
+00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
+000000a0  00 00 00 00 00 74 9c 20  9a ab fb 26 4b cd da 86  |.....t. ...&K...|
+000000b0  ad 35 0a ff 33 2f 49 59  47 f0 bd ac cf 77 b3 2e  |.5..3/IYG....w..|
+000000c0  0f 20 91 6b ed                                    |. .k.|
diff --git a/src/pkg/crypto/tls/testdata/Server-TLSv12-IssueTicket b/src/pkg/crypto/tls/testdata/Server-TLSv12-IssueTicket
new file mode 100644
index 0000000000..6350fe15dd
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Server-TLSv12-IssueTicket
@@ -0,0 +1,87 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 61 01 00 00  5d 03 03 52 ac 77 f8 de  |....a...]..R.w..|
+00000010  80 6f ff 1d 84 ca 82 41  2c 64 aa 9f a8 d3 85 c0  |.o.....A,d......|
+00000020  11 58 e0 72 b1 e7 98 03  00 cc 89 00 00 04 00 05  |.X.r............|
+00000030  00 ff 02 01 00 00 2f 00  23 00 00 00 0d 00 22 00  |....../.#.....".|
+00000040  20 06 01 06 02 06 03 05  01 05 02 05 03 04 01 04  | ...............|
+00000050  02 04 03 03 01 03 02 03  03 02 01 02 02 02 03 01  |................|
+00000060  01 00 0f 00 01 01                                 |......|
+>>> Flow 2 (server to client)
+00000000  16 03 03 00 30 02 00 00  2c 03 03 00 00 00 00 00  |....0...,.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 05 00 00  |................|
+00000030  04 00 23 00 00 16 03 03  02 be 0b 00 02 ba 00 02  |..#.............|
+00000040  b7 00 02 b4 30 82 02 b0  30 82 02 19 a0 03 02 01  |....0...0.......|
+00000050  02 02 09 00 85 b0 bb a4  8a 7f b8 ca 30 0d 06 09  |............0...|
+00000060  2a 86 48 86 f7 0d 01 01  05 05 00 30 45 31 0b 30  |*.H........0E1.0|
+00000070  09 06 03 55 04 06 13 02  41 55 31 13 30 11 06 03  |...U....AU1.0...|
+00000080  55 04 08 13 0a 53 6f 6d  65 2d 53 74 61 74 65 31  |U....Some-State1|
+00000090  21 30 1f 06 03 55 04 0a  13 18 49 6e 74 65 72 6e  |!0...U....Intern|
+000000a0  65 74 20 57 69 64 67 69  74 73 20 50 74 79 20 4c  |et Widgits Pty L|
+000000b0  74 64 30 1e 17 0d 31 30  30 34 32 34 30 39 30 39  |td0...1004240909|
+000000c0  33 38 5a 17 0d 31 31 30  34 32 34 30 39 30 39 33  |38Z..11042409093|
+000000d0  38 5a 30 45 31 0b 30 09  06 03 55 04 06 13 02 41  |8Z0E1.0...U....A|
+000000e0  55 31 13 30 11 06 03 55  04 08 13 0a 53 6f 6d 65  |U1.0...U....Some|
+000000f0  2d 53 74 61 74 65 31 21  30 1f 06 03 55 04 0a 13  |-State1!0...U...|
+00000100  18 49 6e 74 65 72 6e 65  74 20 57 69 64 67 69 74  |.Internet Widgit|
+00000110  73 20 50 74 79 20 4c 74  64 30 81 9f 30 0d 06 09  |s Pty Ltd0..0...|
+00000120  2a 86 48 86 f7 0d 01 01  01 05 00 03 81 8d 00 30  |*.H............0|
+00000130  81 89 02 81 81 00 bb 79  d6 f5 17 b5 e5 bf 46 10  |.......y......F.|
+00000140  d0 dc 69 be e6 2b 07 43  5a d0 03 2d 8a 7a 43 85  |..i..+.CZ..-.zC.|
+00000150  b7 14 52 e7 a5 65 4c 2c  78 b8 23 8c b5 b4 82 e5  |..R..eL,x.#.....|
+00000160  de 1f 95 3b 7e 62 a5 2c  a5 33 d6 fe 12 5c 7a 56  |...;~b.,.3...\zV|
+00000170  fc f5 06 bf fa 58 7b 26  3f b5 cd 04 d3 d0 c9 21  |.....X{&?......!|
+00000180  96 4a c7 f4 54 9f 5a bf  ef 42 71 00 fe 18 99 07  |.J..T.Z..Bq.....|
+00000190  7f 7e 88 7d 7d f1 04 39  c4 a2 2e db 51 c9 7c e3  |.~.}}..9....Q.|.|
+000001a0  c0 4c 3b 32 66 01 cf af  b1 1d b8 71 9a 1d db db  |.L;2f......q....|
+000001b0  89 6b ae da 2d 79 02 03  01 00 01 a3 81 a7 30 81  |.k..-y........0.|
+000001c0  a4 30 1d 06 03 55 1d 0e  04 16 04 14 b1 ad e2 85  |.0...U..........|
+000001d0  5a cf cb 28 db 69 ce 23  69 de d3 26 8e 18 88 39  |Z..(.i.#i..&...9|
+000001e0  30 75 06 03 55 1d 23 04  6e 30 6c 80 14 b1 ad e2  |0u..U.#.n0l.....|
+000001f0  85 5a cf cb 28 db 69 ce  23 69 de d3 26 8e 18 88  |.Z..(.i.#i..&...|
+00000200  39 a1 49 a4 47 30 45 31  0b 30 09 06 03 55 04 06  |9.I.G0E1.0...U..|
+00000210  13 02 41 55 31 13 30 11  06 03 55 04 08 13 0a 53  |..AU1.0...U....S|
+00000220  6f 6d 65 2d 53 74 61 74  65 31 21 30 1f 06 03 55  |ome-State1!0...U|
+00000230  04 0a 13 18 49 6e 74 65  72 6e 65 74 20 57 69 64  |....Internet Wid|
+00000240  67 69 74 73 20 50 74 79  20 4c 74 64 82 09 00 85  |gits Pty Ltd....|
+00000250  b0 bb a4 8a 7f b8 ca 30  0c 06 03 55 1d 13 04 05  |.......0...U....|
+00000260  30 03 01 01 ff 30 0d 06  09 2a 86 48 86 f7 0d 01  |0....0...*.H....|
+00000270  01 05 05 00 03 81 81 00  08 6c 45 24 c7 6b b1 59  |.........lE$.k.Y|
+00000280  ab 0c 52 cc f2 b0 14 d7  87 9d 7a 64 75 b5 5a 95  |..R.......zdu.Z.|
+00000290  66 e4 c5 2b 8e ae 12 66  1f eb 4f 38 b3 6e 60 d3  |f..+...f..O8.n`.|
+000002a0  92 fd f7 41 08 b5 25 13  b1 18 7a 24 fb 30 1d ba  |...A..%...z$.0..|
+000002b0  ed 98 b9 17 ec e7 d7 31  59 db 95 d3 1d 78 ea 50  |.......1Y....x.P|
+000002c0  56 5c d5 82 5a 2d 5a 5f  33 c4 b6 d8 c9 75 90 96  |V\..Z-Z_3....u..|
+000002d0  8c 0f 52 98 b5 cd 98 1f  89 20 5f f2 a0 1c a3 1b  |..R...... _.....|
+000002e0  96 94 dd a9 fd 57 e9 70  e8 26 6d 71 99 9b 26 6e  |.....W.p.&mq..&n|
+000002f0  38 50 29 6c 90 a7 bd d9  16 03 03 00 04 0e 00 00  |8P)l............|
+00000300  00                                                |.|
+>>> Flow 3 (client to server)
+00000000  16 03 03 00 86 10 00 00  82 00 80 01 0a 69 54 c5  |.............iT.|
+00000010  b8 a7 ab 91 53 42 ff c9  2b 27 49 12 df 7d 4d 65  |....SB..+'I..}Me|
+00000020  d1 5a 36 a0 47 ad f6 42  59 36 99 d0 d6 92 9e 16  |.Z6.G..BY6......|
+00000030  9d 8c 0c ad ee f9 7b b1  96 91 01 1e b1 b5 04 a9  |......{.........|
+00000040  0d fe 0b 88 b8 25 4f 70  f8 51 7e 6f c9 cd 7a 60  |.....%Op.Q~o..z`|
+00000050  2c 58 b4 50 36 28 01 e8  71 86 08 7e 75 b3 76 31  |,X.P6(..q..~u.v1|
+00000060  69 50 3a bb 21 95 f8 75  64 7f 0b 78 29 da 82 6b  |iP:.!..ud..x)..k|
+00000070  e1 b9 cd ca 2c f0 57 f9  e3 d0 09 df fd 51 bc fa  |....,.W......Q..|
+00000080  ef f1 68 07 4b 21 6e 52  7a 5f dc 14 03 03 00 01  |..h.K!nRz_......|
+00000090  01 16 03 03 00 24 ca a5  ab ab 2f 12 1e a8 3c 33  |.....$..../...<3|
+000000a0  24 e8 ef c9 b2 bb 58 61  c0 eb 97 66 fb e0 72 4a  |$.....Xa...f..rJ|
+000000b0  82 9e e7 d1 0f fa be aa  d0 d3                    |..........|
+>>> Flow 4 (server to client)
+00000000  16 03 03 00 72 04 00 00  6e 00 00 00 00 00 68 00  |....r...n.....h.|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 65  |...............e|
+00000020  ea 4b d1 ef ba 11 a0 88  48 34 0d 3b 22 38 1e 62  |.K......H4.;"8.b|
+00000030  c5 0a 33 b3 f0 65 ff fa  c4 f3 a8 2d 24 75 55 e4  |..3..e.....-$uU.|
+00000040  47 cc d2 6b 8d 26 c6 d1  10 cc a2 48 29 c0 a1 a5  |G..k.&.....H)...|
+00000050  52 66 dc ec 0b 59 23 02  5b 66 c3 af 88 27 f0 65  |Rf...Y#.[f...'.e|
+00000060  c0 72 de 1a db cf 9b 5f  e7 fe e8 2d 27 6f 67 fb  |.r....._...-'og.|
+00000070  91 a1 46 70 b1 ce 29 14  03 03 00 01 01 16 03 03  |..Fp..).........|
+00000080  00 24 de 3d 06 39 fa fe  ad 47 50 1e 3d 38 ff 1d  |.$.=.9...GP.=8..|
+00000090  15 7f 11 4a 90 52 de 7d  0b d3 8b f4 f8 60 a9 78  |...J.R.}.....`.x|
+000000a0  6a db e2 a7 5b b7 17 03  03 00 21 66 6f 29 59 68  |j...[.....!fo)Yh|
+000000b0  e0 64 a1 87 c8 f2 63 86  c6 5c c8 dc 05 de 6f d2  |.d....c..\....o.|
+000000c0  db 53 72 f1 ae 22 61 4e  a1 b8 c9 25 15 03 03 00  |.Sr.."aN...%....|
+000000d0  16 70 ad 3d dc 66 ab 57  2e 75 ab 1f 07 9e 70 77  |.p.=.f.W.u....pw|
+000000e0  c2 2b 88 05 34 cf da                              |.+..4..|
diff --git a/src/pkg/crypto/tls/testdata/Server-TLSv12-RSA-3DES b/src/pkg/crypto/tls/testdata/Server-TLSv12-RSA-3DES
new file mode 100644
index 0000000000..fe0a0bd3f0
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Server-TLSv12-RSA-3DES
@@ -0,0 +1,82 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 5d 01 00 00  59 03 03 52 ac 77 f8 94  |....]...Y..R.w..|
+00000010  1b 92 d4 0b 16 00 df 59  3d 0e 9b 20 4a 9a 37 b5  |.......Y=.. J.7.|
+00000020  8c 96 96 f9 a0 d4 4f b2  20 9e 22 00 00 04 00 0a  |......O. .".....|
+00000030  00 ff 02 01 00 00 2b 00  0d 00 22 00 20 06 01 06  |......+...". ...|
+00000040  02 06 03 05 01 05 02 05  03 04 01 04 02 04 03 03  |................|
+00000050  01 03 02 03 03 02 01 02  02 02 03 01 01 00 0f 00  |................|
+00000060  01 01                                             |..|
+>>> Flow 2 (server to client)
+00000000  16 03 03 00 2a 02 00 00  26 03 03 00 00 00 00 00  |....*...&.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 0a 00 16  |................|
+00000030  03 03 02 be 0b 00 02 ba  00 02 b7 00 02 b4 30 82  |..............0.|
+00000040  02 b0 30 82 02 19 a0 03  02 01 02 02 09 00 85 b0  |..0.............|
+00000050  bb a4 8a 7f b8 ca 30 0d  06 09 2a 86 48 86 f7 0d  |......0...*.H...|
+00000060  01 01 05 05 00 30 45 31  0b 30 09 06 03 55 04 06  |.....0E1.0...U..|
+00000070  13 02 41 55 31 13 30 11  06 03 55 04 08 13 0a 53  |..AU1.0...U....S|
+00000080  6f 6d 65 2d 53 74 61 74  65 31 21 30 1f 06 03 55  |ome-State1!0...U|
+00000090  04 0a 13 18 49 6e 74 65  72 6e 65 74 20 57 69 64  |....Internet Wid|
+000000a0  67 69 74 73 20 50 74 79  20 4c 74 64 30 1e 17 0d  |gits Pty Ltd0...|
+000000b0  31 30 30 34 32 34 30 39  30 39 33 38 5a 17 0d 31  |100424090938Z..1|
+000000c0  31 30 34 32 34 30 39 30  39 33 38 5a 30 45 31 0b  |10424090938Z0E1.|
+000000d0  30 09 06 03 55 04 06 13  02 41 55 31 13 30 11 06  |0...U....AU1.0..|
+000000e0  03 55 04 08 13 0a 53 6f  6d 65 2d 53 74 61 74 65  |.U....Some-State|
+000000f0  31 21 30 1f 06 03 55 04  0a 13 18 49 6e 74 65 72  |1!0...U....Inter|
+00000100  6e 65 74 20 57 69 64 67  69 74 73 20 50 74 79 20  |net Widgits Pty |
+00000110  4c 74 64 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |Ltd0..0...*.H...|
+00000120  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+00000130  bb 79 d6 f5 17 b5 e5 bf  46 10 d0 dc 69 be e6 2b  |.y......F...i..+|
+00000140  07 43 5a d0 03 2d 8a 7a  43 85 b7 14 52 e7 a5 65  |.CZ..-.zC...R..e|
+00000150  4c 2c 78 b8 23 8c b5 b4  82 e5 de 1f 95 3b 7e 62  |L,x.#........;~b|
+00000160  a5 2c a5 33 d6 fe 12 5c  7a 56 fc f5 06 bf fa 58  |.,.3...\zV.....X|
+00000170  7b 26 3f b5 cd 04 d3 d0  c9 21 96 4a c7 f4 54 9f  |{&?......!.J..T.|
+00000180  5a bf ef 42 71 00 fe 18  99 07 7f 7e 88 7d 7d f1  |Z..Bq......~.}}.|
+00000190  04 39 c4 a2 2e db 51 c9  7c e3 c0 4c 3b 32 66 01  |.9....Q.|..L;2f.|
+000001a0  cf af b1 1d b8 71 9a 1d  db db 89 6b ae da 2d 79  |.....q.....k..-y|
+000001b0  02 03 01 00 01 a3 81 a7  30 81 a4 30 1d 06 03 55  |........0..0...U|
+000001c0  1d 0e 04 16 04 14 b1 ad  e2 85 5a cf cb 28 db 69  |..........Z..(.i|
+000001d0  ce 23 69 de d3 26 8e 18  88 39 30 75 06 03 55 1d  |.#i..&...90u..U.|
+000001e0  23 04 6e 30 6c 80 14 b1  ad e2 85 5a cf cb 28 db  |#.n0l......Z..(.|
+000001f0  69 ce 23 69 de d3 26 8e  18 88 39 a1 49 a4 47 30  |i.#i..&...9.I.G0|
+00000200  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+00000210  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+00000220  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+00000230  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+00000240  74 79 20 4c 74 64 82 09  00 85 b0 bb a4 8a 7f b8  |ty Ltd..........|
+00000250  ca 30 0c 06 03 55 1d 13  04 05 30 03 01 01 ff 30  |.0...U....0....0|
+00000260  0d 06 09 2a 86 48 86 f7  0d 01 01 05 05 00 03 81  |...*.H..........|
+00000270  81 00 08 6c 45 24 c7 6b  b1 59 ab 0c 52 cc f2 b0  |...lE$.k.Y..R...|
+00000280  14 d7 87 9d 7a 64 75 b5  5a 95 66 e4 c5 2b 8e ae  |....zdu.Z.f..+..|
+00000290  12 66 1f eb 4f 38 b3 6e  60 d3 92 fd f7 41 08 b5  |.f..O8.n`....A..|
+000002a0  25 13 b1 18 7a 24 fb 30  1d ba ed 98 b9 17 ec e7  |%...z$.0........|
+000002b0  d7 31 59 db 95 d3 1d 78  ea 50 56 5c d5 82 5a 2d  |.1Y....x.PV\..Z-|
+000002c0  5a 5f 33 c4 b6 d8 c9 75  90 96 8c 0f 52 98 b5 cd  |Z_3....u....R...|
+000002d0  98 1f 89 20 5f f2 a0 1c  a3 1b 96 94 dd a9 fd 57  |... _..........W|
+000002e0  e9 70 e8 26 6d 71 99 9b  26 6e 38 50 29 6c 90 a7  |.p.&mq..&n8P)l..|
+000002f0  bd d9 16 03 03 00 04 0e  00 00 00                 |...........|
+>>> Flow 3 (client to server)
+00000000  16 03 03 00 86 10 00 00  82 00 80 49 e0 e1 1c 2f  |...........I.../|
+00000010  7a 73 f4 a2 af 83 23 1d  4a 49 2b 6d d8 95 c7 48  |zs....#.JI+m...H|
+00000020  ea 32 03 0d f8 72 06 73  92 90 67 10 d7 c5 12 b3  |.2...r.s..g.....|
+00000030  52 56 1e e9 14 d5 1b 67  68 93 9f 9f 0c 53 bf 73  |RV.....gh....S.s|
+00000040  80 09 0f 67 05 d6 de 59  4b 76 0e 8f 8d a2 6e 09  |...g...YKv....n.|
+00000050  3d 86 a4 d8 f9 af a0 89  73 5a 1a 58 9b 80 a6 28  |=.......sZ.X...(|
+00000060  4b 6b 79 af de 02 56 1e  2b d3 ec 3f 67 43 1e 45  |Kky...V.+..?gC.E|
+00000070  cd d0 69 db 88 f3 6b d8  cd cd 89 82 7a cf 5a 76  |..i...k.....z.Zv|
+00000080  5f 1e b3 ae 01 34 7c 2b  3c fa 82 14 03 03 00 01  |_....4|+<.......|
+00000090  01 16 03 03 00 30 ce 2c  83 c5 74 8b ab 3c 6b 54  |.....0.,..t..<kT|
+000000a0  73 7a d2 5e e6 db 7c c7  c1 c0 8e da 13 d3 a3 d8  |sz.^..|.........|
+000000b0  de 53 be b9 0b 45 cf 40  35 fa 77 6a 95 83 4f 26  |.S...E.@5.wj..O&|
+000000c0  74 33 5b a3 5d f8                                 |t3[.].|
+>>> Flow 4 (server to client)
+00000000  14 03 03 00 01 01 16 03  03 00 30 00 00 00 00 00  |..........0.....|
+00000010  00 00 00 fa 71 b5 6e 06  4f ba 9e 8d 44 85 b1 58  |....q.n.O...D..X|
+00000020  dc 6e 13 a7 f4 26 96 cd  9d 58 41 c3 d7 14 7c 20  |.n...&...XA...| |
+00000030  0d 77 83 e0 8c 43 a7 74  8b 7d 60 17 03 03 00 30  |.w...C.t.}`....0|
+00000040  00 00 00 00 00 00 00 00  55 f4 03 c0 00 95 bb 6d  |........U......m|
+00000050  52 29 35 7b ba 5d d5 e4  4d 8b 2a 5a 21 25 af 43  |R)5{.]..M.*Z!%.C|
+00000060  0d e5 ad 97 ba 70 4d b2  79 78 58 1d c4 d3 c9 8b  |.....pM.yxX.....|
+00000070  15 03 03 00 20 00 00 00  00 00 00 00 00 d4 54 36  |.... .........T6|
+00000080  41 07 5d e0 de 65 80 ad  b8 0f 61 22 a8 0f 87 2f  |A.]..e....a".../|
+00000090  59 91 0a de 60                                    |Y...`|
diff --git a/src/pkg/crypto/tls/testdata/Server-TLSv12-RSA-AES b/src/pkg/crypto/tls/testdata/Server-TLSv12-RSA-AES
new file mode 100644
index 0000000000..c19d37fa4e
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Server-TLSv12-RSA-AES
@@ -0,0 +1,86 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 5d 01 00 00  59 03 03 52 ac 77 f8 f2  |....]...Y..R.w..|
+00000010  28 d7 4f 30 1c 37 0e be  ff 22 60 a4 4a b4 14 11  |(.O0.7..."`.J...|
+00000020  47 2d 7b 91 55 d6 c3 58  51 c3 f1 00 00 04 00 2f  |G-{.U..XQ....../|
+00000030  00 ff 02 01 00 00 2b 00  0d 00 22 00 20 06 01 06  |......+...". ...|
+00000040  02 06 03 05 01 05 02 05  03 04 01 04 02 04 03 03  |................|
+00000050  01 03 02 03 03 02 01 02  02 02 03 01 01 00 0f 00  |................|
+00000060  01 01                                             |..|
+>>> Flow 2 (server to client)
+00000000  16 03 03 00 2a 02 00 00  26 03 03 00 00 00 00 00  |....*...&.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2f 00 16  |............./..|
+00000030  03 03 02 be 0b 00 02 ba  00 02 b7 00 02 b4 30 82  |..............0.|
+00000040  02 b0 30 82 02 19 a0 03  02 01 02 02 09 00 85 b0  |..0.............|
+00000050  bb a4 8a 7f b8 ca 30 0d  06 09 2a 86 48 86 f7 0d  |......0...*.H...|
+00000060  01 01 05 05 00 30 45 31  0b 30 09 06 03 55 04 06  |.....0E1.0...U..|
+00000070  13 02 41 55 31 13 30 11  06 03 55 04 08 13 0a 53  |..AU1.0...U....S|
+00000080  6f 6d 65 2d 53 74 61 74  65 31 21 30 1f 06 03 55  |ome-State1!0...U|
+00000090  04 0a 13 18 49 6e 74 65  72 6e 65 74 20 57 69 64  |....Internet Wid|
+000000a0  67 69 74 73 20 50 74 79  20 4c 74 64 30 1e 17 0d  |gits Pty Ltd0...|
+000000b0  31 30 30 34 32 34 30 39  30 39 33 38 5a 17 0d 31  |100424090938Z..1|
+000000c0  31 30 34 32 34 30 39 30  39 33 38 5a 30 45 31 0b  |10424090938Z0E1.|
+000000d0  30 09 06 03 55 04 06 13  02 41 55 31 13 30 11 06  |0...U....AU1.0..|
+000000e0  03 55 04 08 13 0a 53 6f  6d 65 2d 53 74 61 74 65  |.U....Some-State|
+000000f0  31 21 30 1f 06 03 55 04  0a 13 18 49 6e 74 65 72  |1!0...U....Inter|
+00000100  6e 65 74 20 57 69 64 67  69 74 73 20 50 74 79 20  |net Widgits Pty |
+00000110  4c 74 64 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |Ltd0..0...*.H...|
+00000120  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+00000130  bb 79 d6 f5 17 b5 e5 bf  46 10 d0 dc 69 be e6 2b  |.y......F...i..+|
+00000140  07 43 5a d0 03 2d 8a 7a  43 85 b7 14 52 e7 a5 65  |.CZ..-.zC...R..e|
+00000150  4c 2c 78 b8 23 8c b5 b4  82 e5 de 1f 95 3b 7e 62  |L,x.#........;~b|
+00000160  a5 2c a5 33 d6 fe 12 5c  7a 56 fc f5 06 bf fa 58  |.,.3...\zV.....X|
+00000170  7b 26 3f b5 cd 04 d3 d0  c9 21 96 4a c7 f4 54 9f  |{&?......!.J..T.|
+00000180  5a bf ef 42 71 00 fe 18  99 07 7f 7e 88 7d 7d f1  |Z..Bq......~.}}.|
+00000190  04 39 c4 a2 2e db 51 c9  7c e3 c0 4c 3b 32 66 01  |.9....Q.|..L;2f.|
+000001a0  cf af b1 1d b8 71 9a 1d  db db 89 6b ae da 2d 79  |.....q.....k..-y|
+000001b0  02 03 01 00 01 a3 81 a7  30 81 a4 30 1d 06 03 55  |........0..0...U|
+000001c0  1d 0e 04 16 04 14 b1 ad  e2 85 5a cf cb 28 db 69  |..........Z..(.i|
+000001d0  ce 23 69 de d3 26 8e 18  88 39 30 75 06 03 55 1d  |.#i..&...90u..U.|
+000001e0  23 04 6e 30 6c 80 14 b1  ad e2 85 5a cf cb 28 db  |#.n0l......Z..(.|
+000001f0  69 ce 23 69 de d3 26 8e  18 88 39 a1 49 a4 47 30  |i.#i..&...9.I.G0|
+00000200  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+00000210  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+00000220  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+00000230  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+00000240  74 79 20 4c 74 64 82 09  00 85 b0 bb a4 8a 7f b8  |ty Ltd..........|
+00000250  ca 30 0c 06 03 55 1d 13  04 05 30 03 01 01 ff 30  |.0...U....0....0|
+00000260  0d 06 09 2a 86 48 86 f7  0d 01 01 05 05 00 03 81  |...*.H..........|
+00000270  81 00 08 6c 45 24 c7 6b  b1 59 ab 0c 52 cc f2 b0  |...lE$.k.Y..R...|
+00000280  14 d7 87 9d 7a 64 75 b5  5a 95 66 e4 c5 2b 8e ae  |....zdu.Z.f..+..|
+00000290  12 66 1f eb 4f 38 b3 6e  60 d3 92 fd f7 41 08 b5  |.f..O8.n`....A..|
+000002a0  25 13 b1 18 7a 24 fb 30  1d ba ed 98 b9 17 ec e7  |%...z$.0........|
+000002b0  d7 31 59 db 95 d3 1d 78  ea 50 56 5c d5 82 5a 2d  |.1Y....x.PV\..Z-|
+000002c0  5a 5f 33 c4 b6 d8 c9 75  90 96 8c 0f 52 98 b5 cd  |Z_3....u....R...|
+000002d0  98 1f 89 20 5f f2 a0 1c  a3 1b 96 94 dd a9 fd 57  |... _..........W|
+000002e0  e9 70 e8 26 6d 71 99 9b  26 6e 38 50 29 6c 90 a7  |.p.&mq..&n8P)l..|
+000002f0  bd d9 16 03 03 00 04 0e  00 00 00                 |...........|
+>>> Flow 3 (client to server)
+00000000  16 03 03 00 86 10 00 00  82 00 80 67 83 ea ad 9c  |...........g....|
+00000010  e6 e0 e6 39 39 8a f4 1d  b0 da 2e a0 de 44 b1 92  |...99........D..|
+00000020  2a ca 64 cb e5 d2 d4 40  f9 a6 ec 12 fc 00 97 8a  |*.d....@........|
+00000030  9c bb b6 e3 55 06 93 af  3f 70 53 2a c8 93 fe 08  |....U...?pS*....|
+00000040  1a bf 92 a9 64 71 36 55  f4 7b a3 08 59 05 8d 69  |....dq6U.{..Y..i|
+00000050  e2 6d 1a d8 97 2e b9 f1  f4 16 63 6e c4 28 59 44  |.m........cn.(YD|
+00000060  5b 53 84 11 2b f6 bd 41  21 9e cc 3e c3 9a 17 8e  |[S..+..A!..>....|
+00000070  53 92 b7 cf 45 dc f3 0c  2d f2 dd 0b a2 6c 34 ab  |S...E...-....l4.|
+00000080  05 e2 48 1a 83 60 dc 8e  f7 bc 3a 14 03 03 00 01  |..H..`....:.....|
+00000090  01 16 03 03 00 40 c8 19  88 56 0b fd 75 d9 e9 7a  |.....@...V..u..z|
+000000a0  38 04 37 e3 74 fc af 7b  b6 2b d8 93 da 25 ba 14  |8.7.t..{.+...%..|
+000000b0  3b 5e ef 19 c5 45 fd cf  b4 f5 ce a5 ee 8a 9b cc  |;^...E..........|
+000000c0  52 17 87 3c c7 9f 56 72  f3 e1 03 e4 db d5 24 6a  |R..<..Vr......$j|
+000000d0  08 de 9b fd a5 2c                                 |.....,|
+>>> Flow 4 (server to client)
+00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
+00000010  00 00 00 00 00 00 00 00  00 00 00 c9 7d ec 45 ce  |............}.E.|
+00000020  b9 e1 3b 11 02 44 56 cf  86 61 44 64 0c 00 5a 9e  |..;..DV..aDd..Z.|
+00000030  f0 37 cc 56 6a 13 f7 81  67 f3 78 a2 53 a6 5c b5  |.7.Vj...g.x.S.\.|
+00000040  0f cc 5b f0 c3 6c 2d cb  48 e1 e4 17 03 03 00 40  |..[..l-.H......@|
+00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000060  6d 27 67 8e 44 ed c2 6b  e7 a8 f5 ab c9 5d a5 a6  |m'g.D..k.....]..|
+00000070  da f0 ae 72 2c 95 75 00  fb e3 94 6e b7 8f e7 44  |...r,.u....n...D|
+00000080  69 37 8c aa 7f 8d 63 5b  03 1d 8e 64 1a 75 72 cb  |i7....c[...d.ur.|
+00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
+000000a0  00 00 00 00 00 5e f4 e5  ae 1f f9 37 b7 14 26 cc  |.....^.....7..&.|
+000000b0  b0 07 f4 61 60 03 2d e3  ff f2 85 bf 1c 74 74 e2  |...a`.-......tt.|
+000000c0  db 0b e3 5f 62                                    |..._b|
diff --git a/src/pkg/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM b/src/pkg/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM
new file mode 100644
index 0000000000..54ad747412
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM
@@ -0,0 +1,102 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 9d 01 00 00  99 03 03 52 ac 77 f8 7a  |...........R.w.z|
+00000010  f5 85 72 ff ef a8 58 b7  be 86 38 82 c7 dd 79 f7  |..r...X...8...y.|
+00000020  78 20 05 9d cf 1b 44 71  92 ab b8 00 00 04 c0 2f  |x ....Dq......./|
+00000030  00 ff 02 01 00 00 6b 00  0b 00 04 03 00 01 02 00  |......k.........|
+00000040  0a 00 34 00 32 00 0e 00  0d 00 19 00 0b 00 0c 00  |..4.2...........|
+00000050  18 00 09 00 0a 00 16 00  17 00 08 00 06 00 07 00  |................|
+00000060  14 00 15 00 04 00 05 00  12 00 13 00 01 00 02 00  |................|
+00000070  03 00 0f 00 10 00 11 00  0d 00 22 00 20 06 01 06  |..........". ...|
+00000080  02 06 03 05 01 05 02 05  03 04 01 04 02 04 03 03  |................|
+00000090  01 03 02 03 03 02 01 02  02 02 03 01 01 00 0f 00  |................|
+000000a0  01 01                                             |..|
+>>> Flow 2 (server to client)
+00000000  16 03 03 00 2a 02 00 00  26 03 03 00 00 00 00 00  |....*...&.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 c0 2f 00 16  |............./..|
+00000030  03 03 02 be 0b 00 02 ba  00 02 b7 00 02 b4 30 82  |..............0.|
+00000040  02 b0 30 82 02 19 a0 03  02 01 02 02 09 00 85 b0  |..0.............|
+00000050  bb a4 8a 7f b8 ca 30 0d  06 09 2a 86 48 86 f7 0d  |......0...*.H...|
+00000060  01 01 05 05 00 30 45 31  0b 30 09 06 03 55 04 06  |.....0E1.0...U..|
+00000070  13 02 41 55 31 13 30 11  06 03 55 04 08 13 0a 53  |..AU1.0...U....S|
+00000080  6f 6d 65 2d 53 74 61 74  65 31 21 30 1f 06 03 55  |ome-State1!0...U|
+00000090  04 0a 13 18 49 6e 74 65  72 6e 65 74 20 57 69 64  |....Internet Wid|
+000000a0  67 69 74 73 20 50 74 79  20 4c 74 64 30 1e 17 0d  |gits Pty Ltd0...|
+000000b0  31 30 30 34 32 34 30 39  30 39 33 38 5a 17 0d 31  |100424090938Z..1|
+000000c0  31 30 34 32 34 30 39 30  39 33 38 5a 30 45 31 0b  |10424090938Z0E1.|
+000000d0  30 09 06 03 55 04 06 13  02 41 55 31 13 30 11 06  |0...U....AU1.0..|
+000000e0  03 55 04 08 13 0a 53 6f  6d 65 2d 53 74 61 74 65  |.U....Some-State|
+000000f0  31 21 30 1f 06 03 55 04  0a 13 18 49 6e 74 65 72  |1!0...U....Inter|
+00000100  6e 65 74 20 57 69 64 67  69 74 73 20 50 74 79 20  |net Widgits Pty |
+00000110  4c 74 64 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |Ltd0..0...*.H...|
+00000120  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+00000130  bb 79 d6 f5 17 b5 e5 bf  46 10 d0 dc 69 be e6 2b  |.y......F...i..+|
+00000140  07 43 5a d0 03 2d 8a 7a  43 85 b7 14 52 e7 a5 65  |.CZ..-.zC...R..e|
+00000150  4c 2c 78 b8 23 8c b5 b4  82 e5 de 1f 95 3b 7e 62  |L,x.#........;~b|
+00000160  a5 2c a5 33 d6 fe 12 5c  7a 56 fc f5 06 bf fa 58  |.,.3...\zV.....X|
+00000170  7b 26 3f b5 cd 04 d3 d0  c9 21 96 4a c7 f4 54 9f  |{&?......!.J..T.|
+00000180  5a bf ef 42 71 00 fe 18  99 07 7f 7e 88 7d 7d f1  |Z..Bq......~.}}.|
+00000190  04 39 c4 a2 2e db 51 c9  7c e3 c0 4c 3b 32 66 01  |.9....Q.|..L;2f.|
+000001a0  cf af b1 1d b8 71 9a 1d  db db 89 6b ae da 2d 79  |.....q.....k..-y|
+000001b0  02 03 01 00 01 a3 81 a7  30 81 a4 30 1d 06 03 55  |........0..0...U|
+000001c0  1d 0e 04 16 04 14 b1 ad  e2 85 5a cf cb 28 db 69  |..........Z..(.i|
+000001d0  ce 23 69 de d3 26 8e 18  88 39 30 75 06 03 55 1d  |.#i..&...90u..U.|
+000001e0  23 04 6e 30 6c 80 14 b1  ad e2 85 5a cf cb 28 db  |#.n0l......Z..(.|
+000001f0  69 ce 23 69 de d3 26 8e  18 88 39 a1 49 a4 47 30  |i.#i..&...9.I.G0|
+00000200  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+00000210  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+00000220  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+00000230  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+00000240  74 79 20 4c 74 64 82 09  00 85 b0 bb a4 8a 7f b8  |ty Ltd..........|
+00000250  ca 30 0c 06 03 55 1d 13  04 05 30 03 01 01 ff 30  |.0...U....0....0|
+00000260  0d 06 09 2a 86 48 86 f7  0d 01 01 05 05 00 03 81  |...*.H..........|
+00000270  81 00 08 6c 45 24 c7 6b  b1 59 ab 0c 52 cc f2 b0  |...lE$.k.Y..R...|
+00000280  14 d7 87 9d 7a 64 75 b5  5a 95 66 e4 c5 2b 8e ae  |....zdu.Z.f..+..|
+00000290  12 66 1f eb 4f 38 b3 6e  60 d3 92 fd f7 41 08 b5  |.f..O8.n`....A..|
+000002a0  25 13 b1 18 7a 24 fb 30  1d ba ed 98 b9 17 ec e7  |%...z$.0........|
+000002b0  d7 31 59 db 95 d3 1d 78  ea 50 56 5c d5 82 5a 2d  |.1Y....x.PV\..Z-|
+000002c0  5a 5f 33 c4 b6 d8 c9 75  90 96 8c 0f 52 98 b5 cd  |Z_3....u....R...|
+000002d0  98 1f 89 20 5f f2 a0 1c  a3 1b 96 94 dd a9 fd 57  |... _..........W|
+000002e0  e9 70 e8 26 6d 71 99 9b  26 6e 38 50 29 6c 90 a7  |.p.&mq..&n8P)l..|
+000002f0  bd d9 16 03 03 01 11 0c  00 01 0d 03 00 19 85 04  |................|
+00000300  01 39 dc ee 44 17 5e db  d7 27 af b6 56 d9 b4 43  |.9..D.^..'..V..C|
+00000310  5a 99 cf aa 31 37 0c 6f  3a a0 f8 53 c4 74 d1 91  |Z...17.o:..S.t..|
+00000320  0a 46 f5 38 3b 5c 09 d8  97 dc 4b aa 70 26 48 f2  |.F.8;\....K.p&H.|
+00000330  d6 0b 31 c9 f8 d4 98 43  e1 6c d5 c7 b2 8e 0b 01  |..1....C.l......|
+00000340  e6 b6 00 28 80 7b fc 96  8f 0d a2 4f b0 79 af dc  |...(.{.....O.y..|
+00000350  61 28 63 33 78 f6 31 39  fd 8a f4 15 18 11 fe db  |a(c3x.19........|
+00000360  d5 07 da 2c ed 49 a0 23  bf d0 3a 38 1d 54 ae 1c  |...,.I.#..:8.T..|
+00000370  7b ea 29 ee d0 38 c1 76  a7 7f 2a f4 ce 1e ac cc  |{.)..8.v..*.....|
+00000380  94 79 90 33 04 01 00 80  11 d6 f6 f9 49 4c ad d6  |.y.3........IL..|
+00000390  c6 50 3f 8d 28 d2 9b 32  8c c8 14 b4 75 22 81 8f  |.P?.(..2....u"..|
+000003a0  b9 dc 0b 5e 71 7a eb 15  1a 8e 50 fb 03 f0 42 de  |...^qz....P...B.|
+000003b0  06 bb d7 28 c7 b3 c5 23  2d 29 11 01 5e 03 3b 2f  |...(...#-)..^.;/|
+000003c0  3c e0 5c 26 b2 15 95 e3  30 35 1f 79 9b de a5 ee  |<.\&....05.y....|
+000003d0  01 35 14 22 c3 7f 0f 30  75 9d ec 94 bd 17 08 1a  |.5."...0u.......|
+000003e0  96 b5 7a 16 39 58 ce 96  aa 90 06 19 1b d5 64 13  |..z.9X........d.|
+000003f0  49 9f c6 84 e8 22 5c 5c  cc f9 90 75 75 ef 33 94  |I...."\\...uu.3.|
+00000400  6b 76 8a b7 c0 9a 34 aa  16 03 03 00 04 0e 00 00  |kv....4.........|
+00000410  00                                                |.|
+>>> Flow 3 (client to server)
+00000000  16 03 03 00 8a 10 00 00  86 85 04 01 bf 6a c6 3e  |.............j.>|
+00000010  39 bb 08 d0 2a 07 fd d9  9a 61 5d 0f ca e5 26 80  |9...*....a]...&.|
+00000020  09 45 b9 34 2d e8 1b 8f  9c 6f b3 c0 2b a3 48 46  |.E.4-....o..+.HF|
+00000030  ce a5 6c b9 16 0f 26 ca  65 00 11 e3 6d ff 18 89  |..l...&.e...m...|
+00000040  5d 0d 4a 94 1b a5 c7 35  59 72 a8 2d 08 01 e2 5e  |].J....5Yr.-...^|
+00000050  d8 12 2d f6 6c d2 0a b1  df d2 5a 13 5c 29 fb 59  |..-.l.....Z.\).Y|
+00000060  fc 2a 77 81 73 dd 86 4a  00 8c 61 a0 e4 b3 ae 6e  |.*w.s..J..a....n|
+00000070  7a 59 bf a2 61 7d 10 ca  4b a0 b3 70 b0 0b 77 09  |zY..a}..K..p..w.|
+00000080  6c 6c 3c b5 b0 65 4a 35  de c5 88 f0 17 b1 4a 14  |ll<..eJ5......J.|
+00000090  03 03 00 01 01 16 03 03  00 28 4a d7 fe 68 74 b5  |.........(J..ht.|
+000000a0  3d 9d 40 33 2a 96 4e 60  d6 d0 ae 2a c5 c8 51 f5  |=.@3*.N`...*..Q.|
+000000b0  aa 54 9b b4 99 56 a4 fe  06 5b 94 6a be 9b aa fa  |.T...V...[.j....|
+000000c0  15 83                                             |..|
+>>> Flow 4 (server to client)
+00000000  14 03 03 00 01 01 16 03  03 00 28 00 00 00 00 00  |..........(.....|
+00000010  00 00 00 dc 64 82 fd 0e  fc b5 a4 e0 7b 8d 62 69  |....d.......{.bi|
+00000020  6e 03 35 a6 6b 0e 19 53  7e 87 e5 fe 7b 78 e6 27  |n.5.k..S~...{x.'|
+00000030  fa 31 7d 17 03 03 00 25  00 00 00 00 00 00 00 01  |.1}....%........|
+00000040  8e 5d 8d 1c a1 07 a4 ed  d1 e2 35 28 d3 8d 47 ec  |.]........5(..G.|
+00000050  d2 67 31 c2 88 5c 23 f8  6b d1 bd a9 0b 15 03 03  |.g1..\#.k.......|
+00000060  00 1a 00 00 00 00 00 00  00 02 3e 14 30 85 89 e0  |..........>.0...|
+00000070  19 3c 0a dc 80 3f c1 28  65 12 f7 38              |.<...?.(e..8|
diff --git a/src/pkg/crypto/tls/testdata/Server-TLSv12-RSA-RC4 b/src/pkg/crypto/tls/testdata/Server-TLSv12-RSA-RC4
new file mode 100644
index 0000000000..d5cf4e4232
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Server-TLSv12-RSA-RC4
@@ -0,0 +1,78 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 5d 01 00 00  59 03 03 52 ac 77 f8 36  |....]...Y..R.w.6|
+00000010  6c 14 4d a5 96 7f 9f 63  56 81 2f ef 2b e8 4c 9d  |l.M....cV./.+.L.|
+00000020  04 92 ba 6c 99 29 47 f3  b5 22 46 00 00 04 00 05  |...l.)G.."F.....|
+00000030  00 ff 02 01 00 00 2b 00  0d 00 22 00 20 06 01 06  |......+...". ...|
+00000040  02 06 03 05 01 05 02 05  03 04 01 04 02 04 03 03  |................|
+00000050  01 03 02 03 03 02 01 02  02 02 03 01 01 00 0f 00  |................|
+00000060  01 01                                             |..|
+>>> Flow 2 (server to client)
+00000000  16 03 03 00 2a 02 00 00  26 03 03 00 00 00 00 00  |....*...&.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 05 00 16  |................|
+00000030  03 03 02 be 0b 00 02 ba  00 02 b7 00 02 b4 30 82  |..............0.|
+00000040  02 b0 30 82 02 19 a0 03  02 01 02 02 09 00 85 b0  |..0.............|
+00000050  bb a4 8a 7f b8 ca 30 0d  06 09 2a 86 48 86 f7 0d  |......0...*.H...|
+00000060  01 01 05 05 00 30 45 31  0b 30 09 06 03 55 04 06  |.....0E1.0...U..|
+00000070  13 02 41 55 31 13 30 11  06 03 55 04 08 13 0a 53  |..AU1.0...U....S|
+00000080  6f 6d 65 2d 53 74 61 74  65 31 21 30 1f 06 03 55  |ome-State1!0...U|
+00000090  04 0a 13 18 49 6e 74 65  72 6e 65 74 20 57 69 64  |....Internet Wid|
+000000a0  67 69 74 73 20 50 74 79  20 4c 74 64 30 1e 17 0d  |gits Pty Ltd0...|
+000000b0  31 30 30 34 32 34 30 39  30 39 33 38 5a 17 0d 31  |100424090938Z..1|
+000000c0  31 30 34 32 34 30 39 30  39 33 38 5a 30 45 31 0b  |10424090938Z0E1.|
+000000d0  30 09 06 03 55 04 06 13  02 41 55 31 13 30 11 06  |0...U....AU1.0..|
+000000e0  03 55 04 08 13 0a 53 6f  6d 65 2d 53 74 61 74 65  |.U....Some-State|
+000000f0  31 21 30 1f 06 03 55 04  0a 13 18 49 6e 74 65 72  |1!0...U....Inter|
+00000100  6e 65 74 20 57 69 64 67  69 74 73 20 50 74 79 20  |net Widgits Pty |
+00000110  4c 74 64 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |Ltd0..0...*.H...|
+00000120  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+00000130  bb 79 d6 f5 17 b5 e5 bf  46 10 d0 dc 69 be e6 2b  |.y......F...i..+|
+00000140  07 43 5a d0 03 2d 8a 7a  43 85 b7 14 52 e7 a5 65  |.CZ..-.zC...R..e|
+00000150  4c 2c 78 b8 23 8c b5 b4  82 e5 de 1f 95 3b 7e 62  |L,x.#........;~b|
+00000160  a5 2c a5 33 d6 fe 12 5c  7a 56 fc f5 06 bf fa 58  |.,.3...\zV.....X|
+00000170  7b 26 3f b5 cd 04 d3 d0  c9 21 96 4a c7 f4 54 9f  |{&?......!.J..T.|
+00000180  5a bf ef 42 71 00 fe 18  99 07 7f 7e 88 7d 7d f1  |Z..Bq......~.}}.|
+00000190  04 39 c4 a2 2e db 51 c9  7c e3 c0 4c 3b 32 66 01  |.9....Q.|..L;2f.|
+000001a0  cf af b1 1d b8 71 9a 1d  db db 89 6b ae da 2d 79  |.....q.....k..-y|
+000001b0  02 03 01 00 01 a3 81 a7  30 81 a4 30 1d 06 03 55  |........0..0...U|
+000001c0  1d 0e 04 16 04 14 b1 ad  e2 85 5a cf cb 28 db 69  |..........Z..(.i|
+000001d0  ce 23 69 de d3 26 8e 18  88 39 30 75 06 03 55 1d  |.#i..&...90u..U.|
+000001e0  23 04 6e 30 6c 80 14 b1  ad e2 85 5a cf cb 28 db  |#.n0l......Z..(.|
+000001f0  69 ce 23 69 de d3 26 8e  18 88 39 a1 49 a4 47 30  |i.#i..&...9.I.G0|
+00000200  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+00000210  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+00000220  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+00000230  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+00000240  74 79 20 4c 74 64 82 09  00 85 b0 bb a4 8a 7f b8  |ty Ltd..........|
+00000250  ca 30 0c 06 03 55 1d 13  04 05 30 03 01 01 ff 30  |.0...U....0....0|
+00000260  0d 06 09 2a 86 48 86 f7  0d 01 01 05 05 00 03 81  |...*.H..........|
+00000270  81 00 08 6c 45 24 c7 6b  b1 59 ab 0c 52 cc f2 b0  |...lE$.k.Y..R...|
+00000280  14 d7 87 9d 7a 64 75 b5  5a 95 66 e4 c5 2b 8e ae  |....zdu.Z.f..+..|
+00000290  12 66 1f eb 4f 38 b3 6e  60 d3 92 fd f7 41 08 b5  |.f..O8.n`....A..|
+000002a0  25 13 b1 18 7a 24 fb 30  1d ba ed 98 b9 17 ec e7  |%...z$.0........|
+000002b0  d7 31 59 db 95 d3 1d 78  ea 50 56 5c d5 82 5a 2d  |.1Y....x.PV\..Z-|
+000002c0  5a 5f 33 c4 b6 d8 c9 75  90 96 8c 0f 52 98 b5 cd  |Z_3....u....R...|
+000002d0  98 1f 89 20 5f f2 a0 1c  a3 1b 96 94 dd a9 fd 57  |... _..........W|
+000002e0  e9 70 e8 26 6d 71 99 9b  26 6e 38 50 29 6c 90 a7  |.p.&mq..&n8P)l..|
+000002f0  bd d9 16 03 03 00 04 0e  00 00 00                 |...........|
+>>> Flow 3 (client to server)
+00000000  16 03 03 00 86 10 00 00  82 00 80 91 75 8a cc 25  |............u..%|
+00000010  6e 5e c5 ce 1b a8 1d fc  ed 80 08 1a e2 fb 04 12  |n^..............|
+00000020  00 fb 52 d2 92 b0 0b 42  8a f2 66 11 fc 31 91 1c  |..R....B..f..1..|
+00000030  28 5a 9a 62 12 84 f8 fb  8b 08 18 03 58 ec 5a 5c  |(Z.b........X.Z\|
+00000040  aa 71 69 e5 c2 a9 5d c3  06 d4 cb e5 58 01 be 6e  |.qi...].....X..n|
+00000050  41 22 02 b2 71 52 d5 67  a2 fc 7c f2 f6 38 67 a3  |A"..qR.g..|..8g.|
+00000060  23 e0 21 7f b8 59 2c ca  7b 3f 8a ee 47 b2 ed 51  |#.!..Y,.{?..G..Q|
+00000070  63 cd 04 8e 19 ac ca 97  13 fb c0 b8 30 82 58 22  |c...........0.X"|
+00000080  a8 30 31 7a ed 64 8e fc  10 53 f1 14 03 03 00 01  |.01z.d...S......|
+00000090  01 16 03 03 00 24 7c 40  76 86 a1 2d 7a 0d 6a e0  |.....$|@v..-z.j.|
+000000a0  be 52 1e a4 5c 8a 8a 41  b7 65 b8 98 09 fd 84 28  |.R..\..A.e.....(|
+000000b0  31 2c b2 5f 25 dc fd 72  df 26                    |1,._%..r.&|
+>>> Flow 4 (server to client)
+00000000  14 03 03 00 01 01 16 03  03 00 24 6c 98 e2 1b ad  |..........$l....|
+00000010  22 8b 5a 5a b7 95 5c be  2f 29 97 7f 05 54 59 6f  |".ZZ..\./)...TYo|
+00000020  c6 91 98 ed 7a 81 eb 7f  5c 34 b8 f8 6d a4 da 17  |....z...\4..m...|
+00000030  03 03 00 21 4f d9 55 62  2a 4e fa 4e 28 8f 92 e2  |...!O.Ub*N.N(...|
+00000040  22 50 14 21 ca 48 ba 71  2c 36 77 b6 92 eb 67 e2  |"P.!.H.q,6w...g.|
+00000050  ba 31 f4 4c 00 15 03 03  00 16 3f a2 64 b0 a9 ed  |.1.L......?.d...|
+00000060  cf 5e b3 25 07 97 d9 1b  a5 04 e7 ff 8a 08 4f ff  |.^.%..........O.|
diff --git a/src/pkg/crypto/tls/testdata/Server-TLSv12-Resume b/src/pkg/crypto/tls/testdata/Server-TLSv12-Resume
new file mode 100644
index 0000000000..944289029d
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Server-TLSv12-Resume
@@ -0,0 +1,35 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 e9 01 00 00  e5 03 03 52 ac 77 f8 65  |...........R.w.e|
+00000010  60 65 1c ac 85 b1 4c d1  e0 5f 02 b0 22 80 c9 98  |`e....L.._.."...|
+00000020  af d9 43 87 0a e8 26 a3  d9 59 cc 20 76 ef 21 5d  |..C...&..Y. v.!]|
+00000030  53 6c 8b 2e 11 a0 43 a8  af 74 8a 58 40 a5 95 ee  |Sl....C..t.X@...|
+00000040  6d a9 ff e8 e4 d8 ba d2  88 ca 7f 0a 00 04 00 05  |m...............|
+00000050  00 ff 02 01 00 00 97 00  23 00 68 00 00 00 00 00  |........#.h.....|
+00000060  00 00 00 00 00 00 00 00  00 00 00 65 ea 4b d1 ef  |...........e.K..|
+00000070  ba 11 a0 88 48 34 0d 3b  22 38 1e 62 c5 0a 33 b3  |....H4.;"8.b..3.|
+00000080  f0 65 ff fa c4 f3 a8 2d  24 75 55 e4 47 cc d2 6b  |.e.....-$uU.G..k|
+00000090  8d 26 c6 d1 10 cc a2 48  29 c0 a1 a5 52 66 dc ec  |.&.....H)...Rf..|
+000000a0  0b 59 23 02 5b 66 c3 af  88 27 f0 65 c0 72 de 1a  |.Y#.[f...'.e.r..|
+000000b0  db cf 9b 5f e7 fe e8 2d  27 6f 67 fb 91 a1 46 70  |..._...-'og...Fp|
+000000c0  b1 ce 29 00 0d 00 22 00  20 06 01 06 02 06 03 05  |..)...". .......|
+000000d0  01 05 02 05 03 04 01 04  02 04 03 03 01 03 02 03  |................|
+000000e0  03 02 01 02 02 02 03 01  01 00 0f 00 01 01        |..............|
+>>> Flow 2 (server to client)
+00000000  16 03 03 00 4a 02 00 00  46 03 03 00 00 00 00 00  |....J...F.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 76 ef 21 5d  |........... v.!]|
+00000030  53 6c 8b 2e 11 a0 43 a8  af 74 8a 58 40 a5 95 ee  |Sl....C..t.X@...|
+00000040  6d a9 ff e8 e4 d8 ba d2  88 ca 7f 0a 00 05 00 14  |m...............|
+00000050  03 03 00 01 01 16 03 03  00 24 37 d8 ed 9b cc 6d  |.........$7....m|
+00000060  5f ce c0 40 68 4b 1f 45  ff 94 3a 98 ec c7 69 1c  |_..@hK.E..:...i.|
+00000070  26 50 9e 3c 54 e6 da b6  5c 2e 48 66 1d 65        |&P.<T...\.Hf.e|
+>>> Flow 3 (client to server)
+00000000  14 03 03 00 01 01 16 03  03 00 24 de 72 a3 15 54  |..........$.r..T|
+00000010  7e 6d a0 ce 5c 38 5c f3  6f 49 00 ba fb c0 c2 cc  |~m..\8\.oI......|
+00000020  6f 29 00 39 f9 bf 77 07  57 f1 e4 cf 6e 0c a3     |o).9..w.W...n..|
+>>> Flow 4 (server to client)
+00000000  17 03 03 00 21 b0 e7 1c  af 33 cd 5e ad 24 cf a4  |....!....3.^.$..|
+00000010  51 99 1a f6 65 1e f3 28  ec 83 93 25 3d 8f f9 57  |Q...e..(...%=..W|
+00000020  cb ec 1f 4a 47 77 15 03  03 00 16 2b 87 cb 08 f7  |...JGw.....+....|
+00000030  51 08 3b c9 73 f4 1f 22  ac 8c 7c 1a 2e 43 84 d7  |Q.;.s.."..|..C..|
+00000040  ef                                                |.|
diff --git a/src/pkg/crypto/tls/testdata/Server-TLSv12-SNI b/src/pkg/crypto/tls/testdata/Server-TLSv12-SNI
new file mode 100644
index 0000000000..667adb3aaa
--- /dev/null
+++ b/src/pkg/crypto/tls/testdata/Server-TLSv12-SNI
@@ -0,0 +1,75 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 71 01 00 00  6d 03 03 52 ac 77 f8 8f  |....q...m..R.w..|
+00000010  99 4f 1f b2 b1 8e c1 fe  52 04 d7 2f 45 db 34 55  |.O......R../E.4U|
+00000020  ca d1 ae 94 68 05 5d ae  7f 34 ae 00 00 04 00 2f  |....h.]..4...../|
+00000030  00 ff 02 01 00 00 3f 00  00 00 10 00 0e 00 00 0b  |......?.........|
+00000040  73 6e 69 74 65 73 74 2e  63 6f 6d 00 0d 00 22 00  |snitest.com...".|
+00000050  20 06 01 06 02 06 03 05  01 05 02 05 03 04 01 04  | ...............|
+00000060  02 04 03 03 01 03 02 03  03 02 01 02 02 02 03 01  |................|
+00000070  01 00 0f 00 01 01                                 |......|
+>>> Flow 2 (server to client)
+00000000  16 03 03 00 2a 02 00 00  26 03 03 00 00 00 00 00  |....*...&.......|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2f 00 16  |............./..|
+00000030  03 03 02 00 0b 00 01 fc  00 01 f9 00 01 f6 30 82  |..............0.|
+00000040  01 f2 30 82 01 5d a0 03  02 01 02 02 01 00 30 0b  |..0..]........0.|
+00000050  06 09 2a 86 48 86 f7 0d  01 01 05 30 28 31 10 30  |..*.H......0(1.0|
+00000060  0e 06 03 55 04 0a 13 07  41 63 6d 65 20 43 6f 31  |...U....Acme Co1|
+00000070  14 30 12 06 03 55 04 03  13 0b 73 6e 69 74 65 73  |.0...U....snites|
+00000080  74 2e 63 6f 6d 30 1e 17  0d 31 32 30 34 31 31 31  |t.com0...1204111|
+00000090  37 34 30 33 35 5a 17 0d  31 33 30 34 31 31 31 37  |74035Z..13041117|
+000000a0  34 35 33 35 5a 30 28 31  10 30 0e 06 03 55 04 0a  |4535Z0(1.0...U..|
+000000b0  13 07 41 63 6d 65 20 43  6f 31 14 30 12 06 03 55  |..Acme Co1.0...U|
+000000c0  04 03 13 0b 73 6e 69 74  65 73 74 2e 63 6f 6d 30  |....snitest.com0|
+000000d0  81 9d 30 0b 06 09 2a 86  48 86 f7 0d 01 01 01 03  |..0...*.H.......|
+000000e0  81 8d 00 30 81 89 02 81  81 00 bb 79 d6 f5 17 b5  |...0.......y....|
+000000f0  e5 bf 46 10 d0 dc 69 be  e6 2b 07 43 5a d0 03 2d  |..F...i..+.CZ..-|
+00000100  8a 7a 43 85 b7 14 52 e7  a5 65 4c 2c 78 b8 23 8c  |.zC...R..eL,x.#.|
+00000110  b5 b4 82 e5 de 1f 95 3b  7e 62 a5 2c a5 33 d6 fe  |.......;~b.,.3..|
+00000120  12 5c 7a 56 fc f5 06 bf  fa 58 7b 26 3f b5 cd 04  |.\zV.....X{&?...|
+00000130  d3 d0 c9 21 96 4a c7 f4  54 9f 5a bf ef 42 71 00  |...!.J..T.Z..Bq.|
+00000140  fe 18 99 07 7f 7e 88 7d  7d f1 04 39 c4 a2 2e db  |.....~.}}..9....|
+00000150  51 c9 7c e3 c0 4c 3b 32  66 01 cf af b1 1d b8 71  |Q.|..L;2f......q|
+00000160  9a 1d db db 89 6b ae da  2d 79 02 03 01 00 01 a3  |.....k..-y......|
+00000170  32 30 30 30 0e 06 03 55  1d 0f 01 01 ff 04 04 03  |2000...U........|
+00000180  02 00 a0 30 0d 06 03 55  1d 0e 04 06 04 04 01 02  |...0...U........|
+00000190  03 04 30 0f 06 03 55 1d  23 04 08 30 06 80 04 01  |..0...U.#..0....|
+000001a0  02 03 04 30 0b 06 09 2a  86 48 86 f7 0d 01 01 05  |...0...*.H......|
+000001b0  03 81 81 00 89 c6 45 5f  1c 1f 5e f8 eb 1a b1 74  |......E_..^....t|
+000001c0  ee 24 39 05 9f 5c 42 59  bb 1a 8d 86 cd b1 d0 56  |.$9..\BY.......V|
+000001d0  f5 6a 71 7d a4 0e 95 ab  90 f5 9e 8d ea f6 27 c1  |.jq}..........'.|
+000001e0  57 99 50 94 db 08 02 26  6e b3 4f c6 84 2d ea 8a  |W.P....&n.O..-..|
+000001f0  4b 68 d9 c1 38 91 03 ab  84 fb 9e 1f 85 d9 b5 d2  |Kh..8...........|
+00000200  3f f2 31 2c 86 70 fb b5  40 14 82 45 a4 eb af e2  |?.1,.p..@..E....|
+00000210  64 d9 0c 8a 4c f4 f8 5b  0f ac 12 ac 2f c4 a3 15  |d...L..[..../...|
+00000220  4b ad 52 46 28 68 af 96  c6 2c 65 25 d6 52 b6 e3  |K.RF(h...,e%.R..|
+00000230  18 45 bd cc 16 03 03 00  04 0e 00 00 00           |.E...........|
+>>> Flow 3 (client to server)
+00000000  16 03 03 00 86 10 00 00  82 00 80 53 d9 f6 6b 66  |...........S..kf|
+00000010  c8 ef e0 90 72 b4 57 ab  a0 21 1f 2b d1 da 50 6d  |....r.W..!.+..Pm|
+00000020  fc 0b bb 45 1b 5c f3 44  d3 a3 45 7f 2f ef 5c 46  |...E.\.D..E./.\F|
+00000030  d5 39 eb 28 1d bb 25 af  34 f3 f8 d3 0d c3 6f a2  |.9.(..%.4.....o.|
+00000040  c9 fc 2c 87 9e 9e 1e 73  6f 9f f2 bc 9d 03 c3 80  |..,....so.......|
+00000050  fa c5 52 70 5a 5e 64 89  bb 90 ba c3 e5 93 bc 65  |..RpZ^d........e|
+00000060  47 f6 7e f2 9c 0e 4c 8d  a7 b9 d0 51 09 b3 51 53  |G.~...L....Q..QS|
+00000070  39 12 4e f4 ed a0 39 27  d5 5f a3 cc f2 d3 05 73  |9.N...9'._.....s|
+00000080  49 d8 09 c3 1d 03 c8 1f  13 12 75 14 03 03 00 01  |I.........u.....|
+00000090  01 16 03 03 00 40 c4 16  cc fe ae db 1c dd eb 8e  |.....@..........|
+000000a0  97 ca ce 6d 88 de 64 81  91 4f 92 fe 77 50 03 77  |...m..d..O..wP.w|
+000000b0  86 31 4c b7 e7 ed 10 7a  61 b3 b0 06 7b 01 70 e4  |.1L....za...{.p.|
+000000c0  7f 04 37 f1 24 14 4f b3  32 0c 04 0d e0 90 aa ec  |..7.$.O.2.......|
+000000d0  47 8f 2d 3e cf c8                                 |G.->..|
+>>> Flow 4 (server to client)
+00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
+00000010  00 00 00 00 00 00 00 00  00 00 00 f7 24 2c f6 09  |............$,..|
+00000020  46 72 c8 41 83 e4 1b fe  6b 6e 5d b1 a0 40 07 9f  |Fr.A....kn]..@..|
+00000030  f5 45 a2 bc 12 1c cd 0c  da ac 13 c0 3d 72 fb 02  |.E..........=r..|
+00000040  70 d6 cd 6e 5b 43 16 c4  c4 cd 6b 17 03 03 00 40  |p..n[C....k....@|
+00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000060  73 ec e3 ba 42 c5 3f 17  9a 04 98 78 23 3e 8a d2  |s...B.?....x#>..|
+00000070  5c b2 6a 0b 4a 1d 6a db  4d 98 89 ba 99 36 51 bc  |\.j.J.j.M....6Q.|
+00000080  7b 12 83 28 62 c7 26 dc  04 d4 79 49 f3 08 2a 1d  |{..(b.&...yI..*.|
+00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
+000000a0  00 00 00 00 00 72 b0 8e  3b 7d 3f 74 fd 65 7a 32  |.....r..;}?t.ez2|
+000000b0  6a 3b 7f e9 75 84 a9 87  81 2f f6 08 ea 42 31 55  |j;..u..../...B1U|
+000000c0  78 82 f0 cc 89                                    |x....|
