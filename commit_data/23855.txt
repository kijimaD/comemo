commit f5e67e53e79784ceb772fea50fecbd3847ae3bdf
Author: Austin Clements <austin@google.com>
Date:   Fri Jul 24 12:33:23 2015 -0400

    runtime: allow GC drain whenever write barrier is enabled
    
    Currently we hand-code a set of phases when draining is allowed.
    However, this set of phases is conservative. The critical invariant is
    simply that the write barrier must be enabled if we're draining.
    
    Shortly we're going to enable mutator assists during the scan phase,
    which means we may drain during the scan phase. In preparation, this
    commit generalizes these assertions to check the fundamental condition
    that the write barrier is enabled, rather than checking that we're in
    any particular phase.
    
    Change-Id: I0e1bec1ca823d4a697a0831ec4c50f5dd3f2a893
    Reviewed-on: https://go-review.googlesource.com/12673
    Reviewed-by: Russ Cox <rsc@golang.org>

 src/runtime/mgcmark.go | 9 ++++++---
 1 file changed, 6 insertions(+), 3 deletions(-)
