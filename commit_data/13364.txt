commit a5aa91b9a2a013be9ced9ae05474e1dce2fe16d4
Author: Brad Fitzpatrick <bradfitz@golang.org>
Date:   Tue Jun 19 09:20:41 2012 -0700

    net/http: make client await response concurrently with writing request
    
    If the server replies with an HTTP response before we're done
    writing our body (for instance "401 Unauthorized" response), we
    were previously ignoring that, since we returned our write
    error ("broken pipe", etc) before ever reading the response.
    Now we read and write at the same time.
    
    Fixes #3595
    
    R=rsc, adg
    CC=golang-dev
    https://golang.org/cl/6238043

 src/pkg/net/http/transport.go      | 72 ++++++++++++++++++++++++++++++++------
 src/pkg/net/http/transport_test.go | 24 +++++++++++++
 2 files changed, 86 insertions(+), 10 deletions(-)
