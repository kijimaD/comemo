commit d2150c83284c06ef3d7e106ca52160a8d1caeca2
Author: Alexandru Mo»ôoi <mosoi@google.com>
Date:   Thu Aug 6 18:33:49 2015 +0200

    [dev.ssa] cmd/compile/internal/ssa/gen: generate better code when right-shifting with a constant.
    
    The lowering rules were missing the non-64 bit case.
    
    SBBLcarrymask can be folded to a int32 integer whose
    type has a smaller bit size. Without the new AND rules
    the following would be generated:
    
        v19 = MOVLconst <uint8> [-1] : SI
        v20 = ANDB <uint8> v18 v19 : DI
    
    which is obviously a NOP.
    
    Fixes #12022
    
    Change-Id: I5f4209f78edc0f118e5b9b2908739f09cefebca4
    Reviewed-on: https://go-review.googlesource.com/13301
    Reviewed-by: Keith Randall <khr@golang.org>

 src/cmd/compile/internal/ssa/gen/AMD64.rules |  12 ++
 src/cmd/compile/internal/ssa/rewriteAMD64.go | 281 +++++++++++++++++++++++++++
 2 files changed, 293 insertions(+)
