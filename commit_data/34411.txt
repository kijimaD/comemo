commit 4c1aff87f1a160c3da962cda0c48462c88260d7b
Author: Marcel van Lohuizen <mpvl@golang.org>
Date:   Wed Feb 28 13:14:44 2018 +0100

    testing: gracefully handle subtest failing parent’s T
    
    Don’t panic if a subtest inadvertently calls FailNow
    on a parent’s T.  Instead, report the offending subtest
    while still reporting the error with the ancestor test and
    keep exiting goroutines.
    
    Note that this implementation has a race if parallel
    subtests are failing the parent concurrently.
    This is fine:
    Calling FailNow on a parent is considered an error
    in principle, at the moment, and is reported if it is
    detected. Having the race allows the race detector
    to detect the error as well.
    
    Fixes #22882
    
    Change-Id: Ifa6d5e55bb88f6bcbb562fc8c99f1f77e320015a
    Reviewed-on: https://go-review.googlesource.com/97635
    Run-TryBot: Marcel van Lohuizen <mpvl@golang.org>
    Reviewed-by: Kunpei Sakai <namusyaka@gmail.com>
    Reviewed-by: Ian Lance Taylor <iant@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

 src/testing/sub_test.go | 78 ++++++++++++++++++++++++++++++++++++++++++++++++-
 src/testing/testing.go  | 21 +++++++++++--
 2 files changed, 95 insertions(+), 4 deletions(-)
