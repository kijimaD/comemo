commit 3cd890dd5a8e5be33ce6f65ab7690ba0e1c235ef
Author: Russ Cox <rsc@golang.org>
Date:   Mon Sep 24 00:06:31 2012 -0400

    test: minor fixes in run and testlib
    
    Can tell this doesn't get run very often, but it is still important
    for when you've broken everything else.
    
    R=golang-dev, r
    CC=golang-dev
    https://golang.org/cl/6547065
---
 test/run     | 2 ++
 test/testlib | 2 +-
 2 files changed, 3 insertions(+), 1 deletion(-)

diff --git a/test/run b/test/run
index 29a7905f0a..d206312a29 100755
--- a/test/run
+++ b/test/run
@@ -54,6 +54,8 @@ true >pass.out >times.out
 exclude=false	# exclude nothing
 golden=golden.out
 
+rm -f tmp.go  # generated by some tests, left behind if interrupted
+
 filterout() {
 	grep '^'"$2"'$' $1 >/dev/null
 }
diff --git a/test/testlib b/test/testlib
index 90f400dd89..29de7672ce 100644
--- a/test/testlib
+++ b/test/testlib
@@ -12,7 +12,7 @@ compile() {
 compiledir() {
 	for gofile in $D/$F.dir/*.go
 	do
-		$G ${gofile} || return 1
+		$G -I. "$gofile" || return 1
 	done
 }
 
