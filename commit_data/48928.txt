commit 29bbca5c2c1ad41b2a9747890d183b6dd3a4ace4
Author: Michael Pratt <mpratt@google.com>
Date:   Fri Mar 4 13:24:04 2022 -0500

    runtime: differentiate "user" and "system" throws
    
    "User" throws are throws due to some invariant broken by the application.
    "System" throws are due to some invariant broken by the runtime,
    environment, etc (i.e., not the fault of the application).
    
    This CL sends "user" throws through the new fatal. Currently this
    function is identical to throw, but with a different name to clearly
    differentiate the throw type in the stack trace, and hopefully be a bit
    more clear to users what it means.
    
    This CL changes a few categories of throw to fatal:
    
    1. Concurrent map read/write.
    2. Deadlock detection.
    3. Unlock of unlocked sync.Mutex.
    4. Inconsistent results from syscall.AllThreadsSyscall.
    
    "Thread exhaustion" and "out of memory" (usually address space full)
    throws are additional throws that are arguably the fault of user code,
    but I've left off for now because there is no specific invariant that
    they have broken to get into these states.
    
    For #51485
    
    Change-Id: I713276a6c290fd34a6563e6e9ef378669d74ae32
    Reviewed-on: https://go-review.googlesource.com/c/go/+/390420
    TryBot-Result: Gopher Robot <gobot@golang.org>
    Reviewed-by: Austin Clements <austin@google.com>
    Run-TryBot: Michael Pratt <mpratt@google.com>

 src/runtime/HACKING.md     |  3 +++
 src/runtime/map.go         | 18 +++++++++---------
 src/runtime/map_fast32.go  | 16 ++++++++--------
 src/runtime/map_fast64.go  | 16 ++++++++--------
 src/runtime/map_faststr.go | 12 ++++++------
 src/runtime/os_linux.go    |  2 +-
 src/runtime/panic.go       | 39 ++++++++++++++++++++++++++++++++-------
 src/runtime/proc.go        |  6 +++---
 src/sync/mutex.go          |  6 ++++--
 src/sync/rwmutex.go        |  4 ++--
 10 files changed, 76 insertions(+), 46 deletions(-)
