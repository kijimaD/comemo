commit 9e98e7e6686a500f87352e3721038d194b1db33c
Author: Adam Langley <agl@golang.org>
Date:   Tue Oct 11 15:08:35 2016 -0700

    crypto/tls: enable X25519 by default.
    
    Since this changes the offered curves in the ClientHello, all the test
    data needs to be updated too.
    
    Change-Id: I227934711104349c0f0eab11d854e5a2adcbc363
    Reviewed-on: https://go-review.googlesource.com/30825
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
---
 src/crypto/tls/common.go                           |   2 +-
 .../testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA  | 107 ++--
 .../testdata/Client-TLSv10-ClientCert-ECDSA-RSA    | 105 ++--
 .../testdata/Client-TLSv10-ClientCert-RSA-ECDSA    | 107 ++--
 .../tls/testdata/Client-TLSv10-ClientCert-RSA-RSA  | 105 ++--
 .../tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES     |  87 ++-
 .../tls/testdata/Client-TLSv10-ECDHE-RSA-AES       |  85 ++-
 src/crypto/tls/testdata/Client-TLSv10-RSA-RC4      |  41 +-
 .../tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES     |  89 ++-
 .../tls/testdata/Client-TLSv11-ECDHE-RSA-AES       |  87 ++-
 src/crypto/tls/testdata/Client-TLSv11-RSA-RC4      |  41 +-
 .../tls/testdata/Client-TLSv12-AES128-GCM-SHA256   |  45 +-
 .../tls/testdata/Client-TLSv12-AES128-SHA256       |  59 +-
 .../tls/testdata/Client-TLSv12-AES256-GCM-SHA384   |  45 +-
 src/crypto/tls/testdata/Client-TLSv12-ALPN         |  84 ++-
 .../testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA  | 113 ++--
 .../testdata/Client-TLSv12-ClientCert-ECDSA-RSA    | 105 ++--
 .../Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384 | 103 ++--
 .../testdata/Client-TLSv12-ClientCert-RSA-ECDSA    | 113 ++--
 .../tls/testdata/Client-TLSv12-ClientCert-RSA-RSA  | 103 ++--
 .../tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES     |  89 ++-
 .../tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM |  81 ++-
 .../Client-TLSv12-ECDHE-ECDSA-AES128-SHA256        |  97 ++-
 .../Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384    |  81 ++-
 .../tls/testdata/Client-TLSv12-ECDHE-RSA-AES       |  87 ++-
 .../testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256 |  95 ++-
 src/crypto/tls/testdata/Client-TLSv12-RSA-RC4      |  41 +-
 .../tls/testdata/Client-TLSv12-RenegotiateOnce     | 383 ++++++------
 .../tls/testdata/Client-TLSv12-RenegotiateTwice    | 685 ++++++++++-----------
 .../Client-TLSv12-RenegotiateTwiceRejected         | 391 ++++++------
 .../testdata/Client-TLSv12-RenegotiationRejected   |  89 ++-
 src/crypto/tls/testdata/Client-TLSv12-SCT          |  81 ++-
 .../Client-TLSv12-X25519-ECDHE-RSA-AES-GCM         |  56 +-
 src/crypto/tls/testdata/Server-SSLv3-RSA-3DES      |  58 +-
 src/crypto/tls/testdata/Server-SSLv3-RSA-AES       |  60 +-
 src/crypto/tls/testdata/Server-SSLv3-RSA-RC4       |  50 +-
 .../tls/testdata/Server-TLSv10-ECDHE-ECDSA-AES     |  74 ++-
 src/crypto/tls/testdata/Server-TLSv10-RSA-3DES     |  50 +-
 src/crypto/tls/testdata/Server-TLSv10-RSA-AES      |  56 +-
 src/crypto/tls/testdata/Server-TLSv10-RSA-RC4      |  44 +-
 src/crypto/tls/testdata/Server-TLSv11-FallbackSCSV |   6 +-
 src/crypto/tls/testdata/Server-TLSv11-RSA-RC4      |  44 +-
 src/crypto/tls/testdata/Server-TLSv12-ALPN         |  74 ++-
 src/crypto/tls/testdata/Server-TLSv12-ALPN-NoMatch |  76 ++-
 .../Server-TLSv12-CipherSuiteCertPreferenceECDSA   |  72 +--
 .../Server-TLSv12-CipherSuiteCertPreferenceRSA     |  70 +--
 .../Server-TLSv12-ClientAuthRequestedAndECDSAGiven |  72 +--
 .../Server-TLSv12-ClientAuthRequestedAndGiven      |  72 +--
 .../Server-TLSv12-ClientAuthRequestedNotGiven      |  54 +-
 .../tls/testdata/Server-TLSv12-ECDHE-ECDSA-AES     |  72 +--
 src/crypto/tls/testdata/Server-TLSv12-IssueTicket  |  68 +-
 .../testdata/Server-TLSv12-IssueTicketPreDisable   |  68 +-
 src/crypto/tls/testdata/Server-TLSv12-RSA-3DES     |  50 +-
 src/crypto/tls/testdata/Server-TLSv12-RSA-AES      |  54 +-
 src/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM  |  60 +-
 .../testdata/Server-TLSv12-RSA-AES256-GCM-SHA384   |  60 +-
 src/crypto/tls/testdata/Server-TLSv12-RSA-RC4      |  44 +-
 src/crypto/tls/testdata/Server-TLSv12-Resume       |  60 +-
 .../tls/testdata/Server-TLSv12-ResumeDisabled      |  70 +--
 src/crypto/tls/testdata/Server-TLSv12-SNI          |  54 +-
 .../tls/testdata/Server-TLSv12-SNI-GetCertificate  |  54 +-
 .../Server-TLSv12-SNI-GetCertificateNotFound       |  54 +-
 .../Server-TLSv12-X25519-ECDHE-RSA-AES-GCM         |  50 +-
 63 files changed, 2757 insertions(+), 2875 deletions(-)

diff --git a/src/crypto/tls/common.go b/src/crypto/tls/common.go
index a14712b67c..021f475700 100644
--- a/src/crypto/tls/common.go
+++ b/src/crypto/tls/common.go
@@ -550,7 +550,7 @@ func (c *Config) maxVersion() uint16 {
 	return c.MaxVersion
 }
 
-var defaultCurvePreferences = []CurveID{CurveP256, CurveP384, CurveP521}
+var defaultCurvePreferences = []CurveID{X25519, CurveP256, CurveP384, CurveP521}
 
 func (c *Config) curvePreferences() []CurveID {
 	if c == nil || len(c.CurvePreferences) == 0 {
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA
index 8d16d8b8bd..fa17b3fcdf 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 59 02 00 00  55 03 01 20 f3 26 a5 ad  |....Y...U.. .&..|
-00000010  ee a8 a9 b7 26 5f 94 f5  56 bc 50 07 70 b8 71 9f  |....&_..V.P.p.q.|
-00000020  98 0a d2 fb a6 74 84 8c  bb ac 66 20 bc f2 63 e9  |.....t....f ..c.|
-00000030  e4 84 44 8a 53 3b e4 67  24 99 af e0 79 03 f5 ac  |..D.S;.g$...y...|
-00000040  6d 18 19 b0 e5 54 ab 0f  6d b7 00 09 c0 09 00 00  |m....T..m.......|
+00000000  16 03 01 00 59 02 00 00  55 03 01 06 7a 54 62 74  |....Y...U...zTbt|
+00000010  6f db 23 bf 1e fc 82 35  4d 57 c5 09 e1 63 fb 3a  |o.#....5MW...c.:|
+00000020  44 dd 3e 60 ec bc 3e 2f  2c 6f 52 20 0c 8e 2a 1e  |D.>`..>/,oR ..*.|
+00000030  02 bf 03 ef a4 b0 2a f9  3a 16 a7 97 01 cb 78 f0  |......*.:.....x.|
+00000040  4d e9 ea 81 f6 0f 9c fb  44 a8 f8 29 c0 09 00 00  |M.......D..)....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  01 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,22 +49,20 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 01 00 d6 0c 00  00 d2 03 00 17 41 04 a3  |*............A..|
-00000280  80 39 df 4d a8 89 ae 9e  42 8c 51 ec c3 e3 9f d0  |.9.M....B.Q.....|
-00000290  46 25 b0 77 0e 95 35 c5  3e 54 e8 cc 68 56 b8 7e  |F%.w..5.>T..hV.~|
-000002a0  30 70 2e 10 b8 1e 9b 17  b2 a0 10 91 94 aa 6b d8  |0p............k.|
-000002b0  2d db 7f 1d 88 01 fa c0  73 ba 6a 49 eb 29 2b 00  |-.......s.jI.)+.|
-000002c0  8b 30 81 88 02 42 01 70  4e 19 a6 64 ea 41 c6 6b  |.0...B.pN..d.A.k|
-000002d0  35 3b d7 83 70 34 5f 73  5c 2f 45 e8 de ca 26 3c  |5;..p4_s\/E...&<|
-000002e0  b0 54 98 85 a8 95 19 ad  70 eb 95 48 b1 f2 67 58  |.T......p..H..gX|
-000002f0  23 ba 27 80 30 f3 df 61  30 51 3f 15 c3 df fb d5  |#.'.0..a0Q?.....|
-00000300  70 46 53 69 99 aa 5a 60  02 42 00 e7 5c 71 05 32  |pFSi..Z`.B..\q.2|
-00000310  19 1a c2 23 2d 6a 03 1f  d2 1f 75 9f 74 67 34 90  |...#-j....u.tg4.|
-00000320  52 90 12 ca a6 f2 1f 3f  21 6c 24 e1 40 50 4f 49  |R......?!l$.@POI|
-00000330  dc a5 68 83 1c 83 94 59  38 c3 5e ca 51 83 41 c0  |..h....Y8.^.Q.A.|
-00000340  b6 7c 35 c4 60 48 3a dc  1a 9d 91 dd 16 03 01 00  |.|5.`H:.........|
-00000350  0a 0d 00 00 06 03 01 02  40 00 00 16 03 01 00 04  |........@.......|
-00000360  0e 00 00 00                                       |....|
+00000270  2a 16 03 01 00 b4 0c 00  00 b0 03 00 1d 20 c6 bf  |*............ ..|
+00000280  da 7d da 0c 87 2f 71 3a  a4 7c 89 23 42 6a 5d d2  |.}.../q:.|.#Bj].|
+00000290  b7 85 5a 00 da bb 5e cf  ea 86 39 2a b4 20 00 8a  |..Z...^...9*. ..|
+000002a0  30 81 87 02 42 00 85 42  f6 bc c6 3c c5 9e e3 b3  |0...B..B...<....|
+000002b0  48 0f bc ed 4b 78 00 d3  30 69 29 cd 18 56 03 37  |H...Kx..0i)..V.7|
+000002c0  8c f5 da 20 33 86 cf ed  b8 d2 75 56 2f 85 7b 53  |... 3.....uV/.{S|
+000002d0  bc 06 e3 4f a1 7d 9c b6  a7 2a da 45 c8 34 29 89  |...O.}...*.E.4).|
+000002e0  3f 8d c9 39 6e b3 6d 02  41 51 02 48 28 c7 e9 75  |?..9n.m.AQ.H(..u|
+000002f0  5d b1 d2 d6 11 d1 3a b8  2f 65 af d8 5d 49 9a 42  |].....:./e..]I.B|
+00000300  7d ae 12 6a 97 9f 4e 51  9e ec 79 10 27 fd d5 19  |}..j..NQ..y.'...|
+00000310  ac 5a c8 cd 5a ac 84 8f  fa 05 e3 51 a3 4e 84 b9  |.Z..Z......Q.N..|
+00000320  08 85 41 fc e6 5b ba 4b  24 39 16 03 01 00 0a 0d  |..A..[.K$9......|
+00000330  00 00 06 03 01 02 40 00  00 16 03 01 00 04 0e 00  |......@.........|
+00000340  00 00                                             |..|
 >>> Flow 3 (client to server)
 00000000  16 03 01 02 0a 0b 00 02  06 00 02 03 00 02 00 30  |...............0|
 00000010  82 01 fc 30 82 01 5e 02  09 00 9a 30 84 6c 26 35  |...0..^....0.l&5|
@@ -98,34 +97,32 @@
 000001e0  be e8 91 b3 da 1a f5 5d  a3 23 f5 26 8b 45 70 8d  |.......].#.&.Ep.|
 000001f0  65 62 9b 7e 01 99 3d 18  f6 10 9a 38 61 9b 2e 57  |eb.~..=....8a..W|
 00000200  e4 fa cc b1 8a ce e2 23  a0 87 f0 e1 67 51 eb 16  |.......#....gQ..|
-00000210  03 01 00 46 10 00 00 42  41 04 1e 18 37 ef 0d 19  |...F...BA...7...|
-00000220  51 88 35 75 71 b5 e5 54  5b 12 2e 8f 09 67 fd a7  |Q.5uq..T[....g..|
-00000230  24 20 3e b2 56 1c ce 97  28 5e f8 2b 2d 4f 9e f1  |$ >.V...(^.+-O..|
-00000240  07 9f 6c 4b 5b 83 56 e2  32 42 e9 58 b6 d7 49 a6  |..lK[.V.2B.X..I.|
-00000250  b5 68 1a 41 03 56 6b dc  5a 89 16 03 01 00 91 0f  |.h.A.Vk.Z.......|
-00000260  00 00 8d 00 8b 30 81 88  02 42 01 37 15 41 67 9a  |.....0...B.7.Ag.|
-00000270  9b cb 2e d9 0a c0 b9 a8  47 00 81 da f8 9b bc d7  |........G.......|
-00000280  e9 89 5a fe c9 9e 7e d1  15 4b 6a 97 a0 90 c7 e8  |..Z...~..Kj.....|
-00000290  41 cb 65 39 f0 6c e7 51  7b ff 76 70 f7 94 39 23  |A.e9.l.Q{.vp..9#|
-000002a0  5c 4e 02 8d 4c b5 88 ad  77 d1 2d 33 02 42 01 41  |\N..L...w.-3.B.A|
-000002b0  06 ed 39 1b a4 ab 7a 8d  62 ce e4 aa 3a 7e b8 82  |..9...z.b...:~..|
-000002c0  04 c9 af 95 28 0d 28 69  a5 db bc fe d7 8b 73 17  |....(.(i......s.|
-000002d0  cf 1e 76 52 2d fa 05 96  be 30 a3 c6 78 10 02 4b  |..vR-....0..x..K|
-000002e0  4e d3 41 bb e0 0a a5 79  0a 60 80 bd cd 59 05 df  |N.A....y.`...Y..|
-000002f0  14 03 01 00 01 01 16 03  01 00 30 c4 d3 dc 0b 45  |..........0....E|
-00000300  cd 3a 35 45 60 d9 02 f5  ec a3 da 25 58 d8 9e e4  |.:5E`......%X...|
-00000310  af 44 d5 38 5a 90 6d 0e  58 d7 bd 77 3f 36 8c eb  |.D.8Z.m.X..w?6..|
-00000320  4e ea f3 07 eb ce e1 1f  7a c9 b0                 |N.......z..|
+00000210  03 01 00 25 10 00 00 21  20 2f e5 7d a3 47 cd 62  |...%...! /.}.G.b|
+00000220  43 15 28 da ac 5f bb 29  07 30 ff f6 84 af c4 cf  |C.(.._.).0......|
+00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 01 00 91 0f 00  |...._X.;t.......|
+00000240  00 8d 00 8b 30 81 88 02  42 01 c5 d1 33 12 b8 59  |....0...B...3..Y|
+00000250  0d 75 98 b6 11 e5 06 9d  49 3d 77 37 2a 10 f9 a0  |.u......I=w7*...|
+00000260  4f 7e 72 13 5c 3d 7e bf  17 57 ab 16 3d b7 1b f7  |O~r.\=~..W..=...|
+00000270  9a 5c 92 99 72 be a2 c7  dc 0c a4 cc 4c ed f6 80  |.\..r.......L...|
+00000280  95 7f 59 3f d4 ed 3e 36  9f 82 d1 02 42 01 da 4c  |..Y?..>6....B..L|
+00000290  27 fc a9 7f c7 1a 8c 7d  29 fe 6b 2b 1a f1 db ee  |'......}).k+....|
+000002a0  8e 61 59 92 69 ef b5 d2  eb 4a 79 7d ff 17 cc c4  |.aY.i....Jy}....|
+000002b0  6f 3e a0 2b 86 0c dd 11  6c 3c 0d e8 a2 55 7d a3  |o>.+....l<...U}.|
+000002c0  58 46 cd f9 3d 9e fc 91  7f 07 90 5c 92 3d d8 14  |XF..=......\.=..|
+000002d0  03 01 00 01 01 16 03 01  00 30 73 e5 58 cc f4 da  |.........0s.X...|
+000002e0  e0 2b 1a 26 d7 38 a3 ff  76 ef a5 66 d8 7e c2 25  |.+.&.8..v..f.~.%|
+000002f0  b6 3b 4c 61 a4 e6 66 6c  ab 0b 76 be f9 bd c1 57  |.;La..fl..v....W|
+00000300  69 8b 7b 69 f4 aa 16 80  67 66                    |i.{i....gf|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 d2 18 a6 c2 9d  |..........0.....|
-00000010  1e 31 18 80 da 63 9b 65  b8 b0 ed 9d d6 86 94 81  |.1...c.e........|
-00000020  5e 67 69 a1 2c bd 9b 8a  cf 5f 49 75 4e d4 17 fc  |^gi.,...._IuN...|
-00000030  2c 62 70 2e fb 02 65 7e  c8 ba bd                 |,bp...e~...|
+00000000  14 03 01 00 01 01 16 03  01 00 30 cd bc 57 18 7a  |..........0..W.z|
+00000010  a7 bb c8 5e 11 d0 c0 fb  97 ca 66 f9 7e 0d 87 12  |...^......f.~...|
+00000020  74 7a 16 3f eb a2 00 4e  87 38 f3 cf c5 70 c1 bd  |tz.?...N.8...p..|
+00000030  90 da f4 ac 8c de 01 89  55 6d f2                 |........Um.|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 f9 4a aa  90 28 c4 ca 6e 44 c8 8b  |.... .J..(..nD..|
-00000010  a7 97 bb 3b 58 46 bf dc  21 28 73 52 71 d2 12 90  |...;XF..!(sRq...|
-00000020  1b 74 ec e6 e0 17 03 01  00 20 fb 4d 93 22 1e 63  |.t....... .M.".c|
-00000030  31 b8 21 0e a1 46 26 48  cb 67 b8 cd 44 54 b2 a3  |1.!..F&H.g..DT..|
-00000040  b6 4d 47 67 7a e1 d8 c2  18 96 15 03 01 00 20 08  |.MGgz......... .|
-00000050  62 5e ed 25 ba 46 67 f5  61 29 e6 25 7e 41 5c b4  |b^.%.Fg.a).%~A\.|
-00000060  7f 12 05 13 9d c6 eb f2  8e 7c 37 81 51 09 c6     |.........|7.Q..|
+00000000  17 03 01 00 20 5e e2 92  23 e7 86 82 20 ff 35 ff  |.... ^..#... .5.|
+00000010  d2 d9 e0 b5 71 4b b4 f9  fb d4 01 e4 c3 52 32 ed  |....qK.......R2.|
+00000020  54 25 4e d1 30 17 03 01  00 20 39 bd 5d 9f 4b cd  |T%N.0.... 9.].K.|
+00000030  a8 92 5f e2 d6 ab 11 8d  ad 95 44 7d 24 e1 02 78  |.._.......D}$..x|
+00000040  ac 72 eb ed 01 28 a4 cc  68 d3 15 03 01 00 20 35  |.r...(..h..... 5|
+00000050  3d 90 bf 16 9a f4 27 9f  98 a7 7b 19 3f d9 2a 6c  |=.....'...{.?.*l|
+00000060  68 86 34 e0 1a f0 29 8c  22 9d 2a ca a1 52 42     |h.4...).".*..RB|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA
index 68ff000bea..1b099bf9fd 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 59 02 00 00  55 03 01 eb c3 41 78 13  |....Y...U....Ax.|
-00000010  97 9b 30 68 60 69 74 7c  8d 2e 90 f6 e7 c8 28 21  |..0h`it|......(!|
-00000020  c4 67 b4 5b a0 f7 e1 1f  7f de b7 20 01 74 23 01  |.g.[....... .t#.|
-00000030  10 ed 5a b9 37 a0 f2 44  6b fd f6 6c 25 07 ef 25  |..Z.7..Dk..l%..%|
-00000040  4b 62 59 c6 ae 4b 82 e0  34 70 6d 40 c0 13 00 00  |KbY..K..4pm@....|
+00000000  16 03 01 00 59 02 00 00  55 03 01 08 ca d5 3f fe  |....Y...U.....?.|
+00000010  f1 63 e8 2e 30 e5 03 e8  9e 7e fa cb 96 bc 97 dd  |.c..0....~......|
+00000020  a4 47 97 09 cf e2 44 1c  1b e5 f1 20 19 7a c6 2f  |.G....D.... .z./|
+00000030  55 36 8d d9 ef d1 2b 08  49 b7 65 df 9b 76 75 46  |U6....+.I.e..vuF|
+00000040  35 bb c9 29 6c 66 76 a4  3b 35 3f 9a c0 13 00 00  |5..)lfv.;5?.....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  01 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,21 +54,19 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 01 00  |.=.`.\!.;.......|
-000002c0  cb 0c 00 00 c7 03 00 17  41 04 c4 ae 64 f9 3a f5  |........A...d.:.|
-000002d0  95 29 e0 9c c1 d0 e3 e1  fa e1 f8 97 d0 69 4d b0  |.)...........iM.|
-000002e0  c0 4f cb 47 41 9c 85 32  b7 c8 71 4f c5 a1 5a ec  |.O.GA..2..qO..Z.|
-000002f0  4d 09 bc fc 07 7c 81 87  71 c7 6e f9 8b 59 f6 53  |M....|..q.n..Y.S|
-00000300  a4 eb 76 d1 2a 6d 55 5d  85 b8 00 80 3b 4f ab 1c  |..v.*mU]....;O..|
-00000310  aa ef 00 e7 7d 91 e2 73  c3 a4 d1 95 5a 6e 26 a9  |....}..s....Zn&.|
-00000320  85 15 25 ef 05 83 34 73  80 00 a6 0c df cd c7 6d  |..%...4s.......m|
-00000330  65 c6 f2 a7 23 68 0e 88  7e 7e 8e 03 4d 4b db 27  |e...#h..~~..MK.'|
-00000340  70 6a 32 2c e7 66 95 06  76 0f d7 4f ec 84 6a ee  |pj2,.f..v..O..j.|
-00000350  28 ed 90 17 f0 04 7f c5  39 a9 8b 53 bd 9a e3 51  |(.......9..S...Q|
-00000360  84 79 ee 32 ad 66 e8 77  da d9 31 4b 6b 5b f0 73  |.y.2.f.w..1Kk[.s|
-00000370  de 9f c5 b8 c7 09 06 f1  15 9d d3 3e 40 86 17 65  |...........>@..e|
-00000380  cd 47 74 4b c0 88 3f be  54 c1 ac fc 16 03 01 00  |.GtK..?.T.......|
-00000390  0a 0d 00 00 06 03 01 02  40 00 00 16 03 01 00 04  |........@.......|
-000003a0  0e 00 00 00                                       |....|
+000002c0  aa 0c 00 00 a6 03 00 1d  20 b3 f2 56 35 8a ac c5  |........ ..V5...|
+000002d0  46 cb c0 4b 69 04 e8 36  f0 9b 29 c8 f4 b8 49 3b  |F..Ki..6..)...I;|
+000002e0  4f b0 f5 71 39 5e fd 45  14 00 80 44 b1 98 23 ab  |O..q9^.E...D..#.|
+000002f0  14 4c fb ca f5 af c9 2f  74 0b 05 17 f1 88 49 69  |.L...../t.....Ii|
+00000300  d8 7f aa 0d 9c 16 64 57  cc e9 62 5e ef c0 5f 37  |......dW..b^.._7|
+00000310  6f 2b 7b 40 b0 c6 a7 a9  e5 52 45 2b e3 4b f4 b4  |o+{@.....RE+.K..|
+00000320  12 2e 7f fc 49 81 64 1a  33 d9 09 c8 a9 0e 3a cc  |....I.d.3.....:.|
+00000330  43 7e 55 76 aa 34 fd 79  ca 22 8d 29 67 f9 53 b5  |C~Uv.4.y.".)g.S.|
+00000340  77 d8 52 ae b2 d5 00 18  ae ff da 28 22 2a bd 53  |w.R........("*.S|
+00000350  63 a0 9d da f3 af f4 d2  70 47 a9 44 79 13 e6 68  |c.......pG.Dy..h|
+00000360  d3 9e 89 2e 4e 5b fa 2d  15 60 d3 16 03 01 00 0a  |....N[.-.`......|
+00000370  0d 00 00 06 03 01 02 40  00 00 16 03 01 00 04 0e  |.......@........|
+00000380  00 00 00                                          |...|
 >>> Flow 3 (client to server)
 00000000  16 03 01 02 0a 0b 00 02  06 00 02 03 00 02 00 30  |...............0|
 00000010  82 01 fc 30 82 01 5e 02  09 00 9a 30 84 6c 26 35  |...0..^....0.l&5|
@@ -102,34 +101,32 @@
 000001e0  be e8 91 b3 da 1a f5 5d  a3 23 f5 26 8b 45 70 8d  |.......].#.&.Ep.|
 000001f0  65 62 9b 7e 01 99 3d 18  f6 10 9a 38 61 9b 2e 57  |eb.~..=....8a..W|
 00000200  e4 fa cc b1 8a ce e2 23  a0 87 f0 e1 67 51 eb 16  |.......#....gQ..|
-00000210  03 01 00 46 10 00 00 42  41 04 1e 18 37 ef 0d 19  |...F...BA...7...|
-00000220  51 88 35 75 71 b5 e5 54  5b 12 2e 8f 09 67 fd a7  |Q.5uq..T[....g..|
-00000230  24 20 3e b2 56 1c ce 97  28 5e f8 2b 2d 4f 9e f1  |$ >.V...(^.+-O..|
-00000240  07 9f 6c 4b 5b 83 56 e2  32 42 e9 58 b6 d7 49 a6  |..lK[.V.2B.X..I.|
-00000250  b5 68 1a 41 03 56 6b dc  5a 89 16 03 01 00 91 0f  |.h.A.Vk.Z.......|
-00000260  00 00 8d 00 8b 30 81 88  02 42 01 03 05 ed 02 bd  |.....0...B......|
-00000270  ec d2 94 fd d9 d6 85 56  a0 b7 16 57 4a b7 91 15  |.......V...WJ...|
-00000280  50 9a 3d 08 fd 06 57 cc  65 e5 a8 26 15 dc 74 fe  |P.=...W.e..&..t.|
-00000290  7c 6b 81 10 7a 1c 3a 32  60 1a 2f e8 cc 4d dd da  ||k..z.:2`./..M..|
-000002a0  20 8a ac 1f eb dd a0 db  58 ef 79 c8 02 42 00 f7  | .......X.y..B..|
-000002b0  0f ca 90 34 ce 83 f0 dc  ec a5 5d 89 68 51 51 13  |...4......].hQQ.|
-000002c0  c6 a9 58 7d 11 cc 22 00  01 e3 04 16 3b 10 ed 93  |..X}..".....;...|
-000002d0  ab 1b b9 e4 89 95 44 5c  06 d4 2c a4 d1 e5 09 12  |......D\..,.....|
-000002e0  82 83 dc 72 f6 41 a9 d6  35 7f da 8a c8 f8 2b e6  |...r.A..5.....+.|
-000002f0  14 03 01 00 01 01 16 03  01 00 30 10 f3 9e aa 4e  |..........0....N|
-00000300  b7 50 bd 7c b4 54 e9 69  aa 49 7a 35 30 da 40 03  |.P.|.T.i.Iz50.@.|
-00000310  a8 48 c4 08 63 7a a1 84  f1 7f 83 6d 15 b1 b1 7d  |.H..cz.....m...}|
-00000320  30 94 27 9a bc a3 a0 bb  84 37 41                 |0.'......7A|
+00000210  03 01 00 25 10 00 00 21  20 2f e5 7d a3 47 cd 62  |...%...! /.}.G.b|
+00000220  43 15 28 da ac 5f bb 29  07 30 ff f6 84 af c4 cf  |C.(.._.).0......|
+00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 01 00 91 0f 00  |...._X.;t.......|
+00000240  00 8d 00 8b 30 81 88 02  42 00 ab b7 a8 9c 96 37  |....0...B......7|
+00000250  e7 dd 07 f5 8e 8f e4 a9  de 20 17 48 a2 e0 15 8c  |......... .H....|
+00000260  85 81 86 ff 7f 36 d4 a6  dd 66 33 f4 cf cd 15 20  |.....6...f3.... |
+00000270  2f 9e 52 36 2b ae ff 8d  21 59 1e a7 83 36 e6 5e  |/.R6+...!Y...6.^|
+00000280  89 77 2c b9 ea 47 b1 73  e3 e1 c2 02 42 01 5a e4  |.w,..G.s....B.Z.|
+00000290  73 4f b8 9d 35 47 88 ee  f8 ca 86 4c cd 00 f4 e3  |sO..5G.....L....|
+000002a0  f7 4a 17 20 51 bc 67 53  b7 e9 ca e2 fe ad 5d 88  |.J. Q.gS......].|
+000002b0  33 fe 5e 01 c4 e3 a1 7b  ae 06 69 cf d8 76 ba 6d  |3.^....{..i..v.m|
+000002c0  a2 3f 21 ee fa fd 58 53  49 d2 af 88 5e 5d 36 14  |.?!...XSI...^]6.|
+000002d0  03 01 00 01 01 16 03 01  00 30 37 93 45 ae 7e 87  |.........07.E.~.|
+000002e0  04 e8 1a 5e d9 24 d9 13  6c a2 e2 df 78 58 6a ea  |...^.$..l...xXj.|
+000002f0  93 f2 2d 4b 31 c2 7e ca  47 b5 8b 67 73 5d ac 33  |..-K1.~.G..gs].3|
+00000300  d6 e1 88 7b 45 7d b5 11  13 0a                    |...{E}....|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 53 ec 32 b9 5c  |..........0S.2.\|
-00000010  a8 9c 03 1e 95 92 5e 19  99 9a e7 3d fa af c5 60  |......^....=...`|
-00000020  d1 94 e0 93 fe 5d 68 e5  e3 51 67 13 c8 30 33 5f  |.....]h..Qg..03_|
-00000030  85 23 e2 cf c8 64 88 24  23 fe 93                 |.#...d.$#..|
+00000000  14 03 01 00 01 01 16 03  01 00 30 6a 8a f0 2b c4  |..........0j..+.|
+00000010  1d 07 2e f2 28 5a 26 6b  2f 2d d1 16 c1 19 4c ae  |....(Z&k/-....L.|
+00000020  6f 68 08 7f 63 b3 bd f6  14 b4 91 07 7a fb 89 29  |oh..c.......z..)|
+00000030  eb e7 ae 4e 19 5c 1a 4b  5d 7f 6f                 |...N.\.K].o|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 26 a5 85  22 18 01 84 5c 50 3b c4  |.... &.."...\P;.|
-00000010  17 58 fe 0e b3 a1 26 ec  94 8e b4 76 bd 84 7a ca  |.X....&....v..z.|
-00000020  fc 22 2c 31 d3 17 03 01  00 20 3c 0a 9a 91 f0 00  |.",1..... <.....|
-00000030  c6 69 b4 04 7d f7 8c 29  3c 7f 81 c1 79 f2 2c 34  |.i..}..)<...y.,4|
-00000040  c0 fd 21 6a b7 a3 28 9b  85 1b 15 03 01 00 20 7d  |..!j..(....... }|
-00000050  1e c7 62 ec b2 84 5f 65  30 6e 4c 7c ab bd 03 49  |..b..._e0nL|...I|
-00000060  ce 7f 0d 0c 2b 62 e1 32  01 0c 35 05 b9 f6 35     |....+b.2..5...5|
+00000000  17 03 01 00 20 8b ad b0  ee 52 ec c5 ce f0 6a a4  |.... ....R....j.|
+00000010  29 26 e3 03 b2 05 d8 bb  39 c0 15 03 f3 a2 1a 1b  |)&......9.......|
+00000020  cc 65 fb 99 9c 17 03 01  00 20 a1 71 d0 02 ee 24  |.e....... .q...$|
+00000030  4b 7a d2 7b 90 1c 45 0a  ca 30 bb 64 96 a7 87 96  |Kz.{..E..0.d....|
+00000040  35 de 1b a7 cc ec 0a b0  a7 83 15 03 01 00 20 32  |5............. 2|
+00000050  29 da b1 59 61 89 98 b1  16 49 06 16 92 d4 16 ae  |)..Ya....I......|
+00000060  ba 6a 3b 70 62 f3 78 e7  d7 44 76 4d ee e8 a0     |.j;pb.x..DvM...|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA
index 84268f0956..982bf9f209 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 59 02 00 00  55 03 01 cd ab 47 9a 95  |....Y...U....G..|
-00000010  15 43 b4 22 d8 b7 ce 1a  70 6d 95 f4 45 36 17 78  |.C."....pm..E6.x|
-00000020  45 86 98 be 9c 89 e2 b1  29 ab 7c 20 74 18 07 6a  |E.......).| t..j|
-00000030  7c 6a 26 94 18 3a f7 01  f5 06 c0 99 58 fd e1 79  ||j&..:......X..y|
-00000040  e8 f0 3d 2e 7d 24 07 ac  ab 29 84 d1 c0 09 00 00  |..=.}$...)......|
+00000000  16 03 01 00 59 02 00 00  55 03 01 f6 7e e1 10 92  |....Y...U...~...|
+00000010  38 3e b6 5d 16 20 81 f9  6e 39 c0 b1 a9 72 8d 71  |8>.]. ..n9...r.q|
+00000020  a7 74 d9 e1 49 71 4b 61  89 6c b2 20 47 cc 58 2d  |.t..IqKa.l. G.X-|
+00000030  96 27 ac ea 66 83 72 43  57 d1 e6 d5 0e 56 75 0b  |.'..f.rCW....Vu.|
+00000040  6f f2 1b 38 0f 53 7d 00  26 ec a7 5c c0 09 00 00  |o..8.S}.&..\....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  01 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,22 +49,20 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 01 00 d5 0c 00  00 d1 03 00 17 41 04 18  |*............A..|
-00000280  50 7c d8 00 90 86 7e 8b  a3 e8 fa 9e 06 2b 40 df  |P|....~......+@.|
-00000290  47 16 9a d4 ea 53 76 a5  58 fe a3 81 49 f9 39 cf  |G....Sv.X...I.9.|
-000002a0  bc b4 cd 0d 94 cc 98 66  8b 69 4f b8 6d c6 5f 85  |.......f.iO.m._.|
-000002b0  72 f3 db 5b 9a fd 31 d1  9a d0 77 e0 50 90 5a 00  |r..[..1...w.P.Z.|
-000002c0  8a 30 81 87 02 41 6c 2d  b0 9b b6 9c 79 16 07 dd  |.0...Al-....y...|
-000002d0  95 0b fa 33 32 fb a7 cf  ca f8 46 38 fb 55 b0 4f  |...32.....F8.U.O|
-000002e0  7c ef 63 12 aa b0 75 57  b9 4a 00 d7 e9 01 7a 43  ||.c...uW.J....zC|
-000002f0  42 e9 6f 93 81 39 56 77  a1 74 ef 09 a3 94 9f f5  |B.o..9Vw.t......|
-00000300  79 7b 2b b5 26 bc 46 02  42 01 7a 34 1c e8 e0 88  |y{+.&.F.B.z4....|
-00000310  b4 90 24 01 ea db 06 d1  c4 59 3f d0 62 6a 64 47  |..$......Y?.bjdG|
-00000320  d9 bc 5e d2 a9 92 85 a2  4b 11 46 98 4a e5 7c 06  |..^.....K.F.J.|.|
-00000330  75 87 f6 e8 bd 2a d1 8f  18 4d 6b 3f 96 52 8e 0a  |u....*...Mk?.R..|
-00000340  6c ad 37 c1 67 39 bb 3e  d4 82 2f 16 03 01 00 0a  |l.7.g9.>../.....|
-00000350  0d 00 00 06 03 01 02 40  00 00 16 03 01 00 04 0e  |.......@........|
-00000360  00 00 00                                          |...|
+00000270  2a 16 03 01 00 b5 0c 00  00 b1 03 00 1d 20 b4 dc  |*............ ..|
+00000280  cb b5 05 eb c2 36 db 24  a5 d7 95 09 57 b4 b3 ad  |.....6.$....W...|
+00000290  5c c0 20 1b 08 b1 6a 15  ab 20 73 5b 23 3e 00 8b  |\. ...j.. s[#>..|
+000002a0  30 81 88 02 42 01 ee a8  99 dc 57 90 78 da c5 b5  |0...B.....W.x...|
+000002b0  ca 64 9b 53 57 fc 6c f8  ca b1 f1 e7 57 e4 bd 33  |.d.SW.l.....W..3|
+000002c0  f7 0c ae 5e 89 8e 65 e5  72 2d 5d b6 a6 b5 d7 ad  |...^..e.r-].....|
+000002d0  12 c8 34 bf 4d 72 53 db  ac ba dc ed 04 64 63 13  |..4.MrS......dc.|
+000002e0  a0 43 2b 0c 4a 26 82 02  42 01 a4 70 cc b8 b3 77  |.C+.J&..B..p...w|
+000002f0  31 14 bf 51 c6 e1 01 b1  93 47 b2 12 56 74 d1 b8  |1..Q.....G..Vt..|
+00000300  41 5a 04 c5 6c c6 36 02  cb 07 b6 48 08 1c 45 ac  |AZ..l.6....H..E.|
+00000310  23 14 68 e0 38 00 1c 2d  8a 3b 74 ac 51 ea b8 13  |#.h.8..-.;t.Q...|
+00000320  e8 37 a3 c1 41 e9 ef 2c  a4 7c 66 16 03 01 00 0a  |.7..A..,.|f.....|
+00000330  0d 00 00 06 03 01 02 40  00 00 16 03 01 00 04 0e  |.......@........|
+00000340  00 00 00                                          |...|
 >>> Flow 3 (client to server)
 00000000  16 03 01 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
 00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
@@ -97,34 +96,32 @@
 000001d0  ac 11 b1 28 56 be 1d cd  61 62 84 09 bf d6 80 c6  |...(V...ab......|
 000001e0  45 8d 82 2c b4 d8 83 9b  db c9 22 b7 2a 12 11 7b  |E..,......".*..{|
 000001f0  fa 02 3b c1 c9 ff ea c9  9d a8 49 d3 95 d7 d5 0e  |..;.......I.....|
-00000200  e5 35 16 03 01 00 46 10  00 00 42 41 04 1e 18 37  |.5....F...BA...7|
-00000210  ef 0d 19 51 88 35 75 71  b5 e5 54 5b 12 2e 8f 09  |...Q.5uq..T[....|
-00000220  67 fd a7 24 20 3e b2 56  1c ce 97 28 5e f8 2b 2d  |g..$ >.V...(^.+-|
-00000230  4f 9e f1 07 9f 6c 4b 5b  83 56 e2 32 42 e9 58 b6  |O....lK[.V.2B.X.|
-00000240  d7 49 a6 b5 68 1a 41 03  56 6b dc 5a 89 16 03 01  |.I..h.A.Vk.Z....|
-00000250  00 86 0f 00 00 82 00 80  a0 3b d6 90 15 22 78 45  |.........;..."xE|
-00000260  5a 09 ac 46 db 99 cb 71  e9 40 62 10 77 47 e8 5e  |Z..F...q.@b.wG.^|
-00000270  63 90 00 28 4c 46 82 72  2e 16 84 32 67 bd 7e 83  |c..(LF.r...2g.~.|
-00000280  80 a9 b3 43 b1 bf c6 48  ad ac ed 90 7b 83 39 36  |...C...H....{.96|
-00000290  ec 90 7e 13 aa d8 39 69  cc 53 88 5c 26 38 c4 95  |..~...9i.S.\&8..|
-000002a0  43 3c 1b 5e d2 63 61 c9  05 9c 7f 7d ef df e8 3a  |C<.^.ca....}...:|
-000002b0  bb 2c 7f 2a f1 d2 9f 25  f4 61 07 99 c4 a1 17 12  |.,.*...%.a......|
-000002c0  98 52 f6 e1 d1 6f 7a 5a  2a de ce 6b 28 18 a5 b4  |.R...ozZ*..k(...|
-000002d0  13 90 ed 82 b9 34 0f 97  14 03 01 00 01 01 16 03  |.....4..........|
-000002e0  01 00 30 dd dd 54 67 e6  c1 e4 0b 89 c6 84 55 57  |..0..Tg.......UW|
-000002f0  7c 7e a8 9a 16 83 5b 01  67 d5 b7 ae dc ee bf 4e  ||~....[.g......N|
-00000300  3a 8c 3f 91 37 4e f4 2c  25 f7 2b 4a 80 3d 07 64  |:.?.7N.,%.+J.=.d|
-00000310  e8 62 3d                                          |.b=|
+00000200  e5 35 16 03 01 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
+00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
+00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 01 00  |......._X.;t....|
+00000230  86 0f 00 00 82 00 80 1c  4f 5d 53 3a 15 c0 51 44  |........O]S:..QD|
+00000240  ff fa 46 c5 01 51 0b e9  22 b8 2f 99 5b 55 5a 98  |..F..Q.."./.[UZ.|
+00000250  58 3c 0d a6 ca c6 85 39  0a c2 21 a0 68 78 a1 ab  |X<.....9..!.hx..|
+00000260  9c 1d 5c db 8c 87 86 72  3e a8 b7 38 e2 66 9f 4b  |..\....r>..8.f.K|
+00000270  d9 3d df f6 dd 64 f8 7c  03 4e a3 c1 88 9e 09 fd  |.=...d.|.N......|
+00000280  a1 20 54 6d 38 f3 14 27  11 37 01 6b c6 42 8c a2  |. Tm8..'.7.k.B..|
+00000290  c8 2b 14 0e 20 f0 66 91  4a de 02 fe f7 62 f2 5b  |.+.. .f.J....b.[|
+000002a0  74 45 e1 ed 32 1f f7 f8  10 99 8d db 2c 30 02 7a  |tE..2.......,0.z|
+000002b0  f2 6e ab 45 40 0f 50 14  03 01 00 01 01 16 03 01  |.n.E@.P.........|
+000002c0  00 30 84 fd 92 b9 4b 54  3b 1b e1 db 11 cc 3b 48  |.0....KT;.....;H|
+000002d0  c6 b3 f4 f6 8d 92 28 05  c2 c8 d7 75 7b 68 fb 06  |......(....u{h..|
+000002e0  63 a2 67 a0 77 21 a1 07  97 07 13 97 58 74 03 d5  |c.g.w!......Xt..|
+000002f0  8b ed                                             |..|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 15 7b 16 7e 05  |..........0.{.~.|
-00000010  7a d9 f3 d4 ff 87 66 b0  27 e5 e7 f5 08 08 68 bc  |z.....f.'.....h.|
-00000020  b4 23 01 f3 71 b3 c7 9c  c8 31 2d 1c eb 50 9c c0  |.#..q....1-..P..|
-00000030  71 39 a9 d9 e4 cd 30 10  18 26 d6                 |q9....0..&.|
+00000000  14 03 01 00 01 01 16 03  01 00 30 a7 c0 55 91 23  |..........0..U.#|
+00000010  2f fb 65 17 ac 60 6a c6  d2 ed 2d 0a fe 4f 5b e8  |/.e..`j...-..O[.|
+00000020  93 01 88 f8 39 8d 06 97  11 85 9d d3 40 a9 75 c6  |....9.......@.u.|
+00000030  02 66 69 c2 cd b4 6d 49  00 e7 0d                 |.fi...mI...|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 01 7d ab  a8 32 3d 62 56 ef c1 b6  |.... .}..2=bV...|
-00000010  fe 51 8d 8c 90 fa 41 08  52 d3 bd 57 48 8a d2 c5  |.Q....A.R..WH...|
-00000020  1e 41 e8 6b 71 17 03 01  00 20 15 ec 02 8a 2b 11  |.A.kq.... ....+.|
-00000030  8f 4b 8c 1e e9 5c b3 a2  53 6e 93 6a 0e 1a 72 6a  |.K...\..Sn.j..rj|
-00000040  e6 49 ec f5 17 af 95 51  a7 10 15 03 01 00 20 f5  |.I.....Q...... .|
-00000050  ad 65 db d2 71 a5 c1 1b  dc 07 8f 79 cd a3 9a 41  |.e..q......y...A|
-00000060  11 c2 e8 09 09 b4 2f fa  fc 6d 6a 31 22 e3 bd     |....../..mj1"..|
+00000000  17 03 01 00 20 c8 5f 0f  28 8e 50 2c 3d 18 97 02  |.... ._.(.P,=...|
+00000010  f2 d0 25 86 01 10 4e 51  d3 9d 1a 60 35 50 52 c8  |..%...NQ...`5PR.|
+00000020  1b 24 aa 9d 3d 17 03 01  00 20 b5 97 88 98 99 7e  |.$..=.... .....~|
+00000030  d5 49 63 85 5e 80 ba f1  42 d1 58 3d df d0 25 5a  |.Ic.^...B.X=..%Z|
+00000040  c4 2a a7 fb 45 78 d7 02  2b d2 15 03 01 00 20 3b  |.*..Ex..+..... ;|
+00000050  5d 1c 4a 60 2f 7e 66 a5  5f 87 2f 3b 14 08 ad cb  |].J`/~f._./;....|
+00000060  e7 df 4d 7c 03 cc 03 ca  b5 c4 5b 1f d7 e3 f0     |..M|......[....|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA
index 4182f8a504..cb956e9791 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 59 02 00 00  55 03 01 0a 79 c8 7c 83  |....Y...U...y.|.|
-00000010  17 78 ba 03 ce fa 53 bb  f9 18 50 34 c3 7b ff 99  |.x....S...P4.{..|
-00000020  f3 2e e5 fc 9d 0b d4 1e  c0 55 13 20 2d 5d af da  |.........U. -]..|
-00000030  02 22 75 79 66 51 6f 1a  1a e3 c1 91 78 1d 43 04  |."uyfQo.....x.C.|
-00000040  91 a5 2a 92 49 b4 c9 5a  15 39 52 b6 c0 13 00 00  |..*.I..Z.9R.....|
+00000000  16 03 01 00 59 02 00 00  55 03 01 13 70 8b ce 13  |....Y...U...p...|
+00000010  6e e5 50 5a 92 bf 18 33  b3 5b 1a bb 52 a9 47 3e  |n.PZ...3.[..R.G>|
+00000020  d3 23 e0 fa a1 af 66 9b  f0 e4 79 20 47 dc 49 70  |.#....f...y G.Ip|
+00000030  99 9e 03 5c fb a2 a8 6a  af e8 75 ff a9 e0 c1 e5  |...\...j..u.....|
+00000040  5c 5a 5e a0 78 ae d1 73  3d 29 04 b7 c0 13 00 00  |\Z^.x..s=)......|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  01 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,21 +54,19 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 01 00  |.=.`.\!.;.......|
-000002c0  cb 0c 00 00 c7 03 00 17  41 04 56 62 25 ca 89 d3  |........A.Vb%...|
-000002d0  3c eb f1 38 50 ff 7b 38  ae 1a 83 1e 07 b7 b4 ef  |<..8P.{8........|
-000002e0  2d 64 78 6e 60 f0 a8 fa  f9 f7 b9 d4 a9 43 3b a9  |-dxn`........C;.|
-000002f0  09 c8 39 77 a2 0a fe d1  00 88 1c 1c 06 6e 27 35  |..9w.........n'5|
-00000300  af 1f d4 c5 35 cd 62 8e  12 98 00 80 7d c2 93 eb  |....5.b.....}...|
-00000310  04 ee 59 d3 c2 2a ac 4c  60 ad 3a bc d2 e3 70 02  |..Y..*.L`.:...p.|
-00000320  c2 67 46 c5 a2 88 80 a3  55 4a be 55 5f 04 14 bc  |.gF.....UJ.U_...|
-00000330  23 76 87 81 ab 78 48 74  c7 ac 0a 44 40 8c d5 5e  |#v...xHt...D@..^|
-00000340  b8 b0 dd c5 02 79 d2 b6  89 e8 ea 5c 3f ad e4 7c  |.....y.....\?..||
-00000350  2f 74 db 2a 21 5d 0f ef  92 d1 d2 c6 ae 45 dd 20  |/t.*!].......E. |
-00000360  a5 58 3e 69 dc d5 71 ff  71 03 a9 92 15 e7 69 fa  |.X>i..q.q.....i.|
-00000370  31 35 23 c9 fb e4 3c 3a  e5 80 fb 86 57 06 cf 6e  |15#...<:....W..n|
-00000380  b5 e8 a3 bb 44 aa 44 c6  45 50 9f bf 16 03 01 00  |....D.D.EP......|
-00000390  0a 0d 00 00 06 03 01 02  40 00 00 16 03 01 00 04  |........@.......|
-000003a0  0e 00 00 00                                       |....|
+000002c0  aa 0c 00 00 a6 03 00 1d  20 8f 09 63 f7 eb 09 5b  |........ ..c...[|
+000002d0  90 a8 cc 46 27 10 b9 ab  ac dc ff ee 98 27 8d a8  |...F'........'..|
+000002e0  25 5a d0 0c b8 2a 5f 25  00 00 80 a2 2d 18 6c 8d  |%Z...*_%....-.l.|
+000002f0  1d a1 62 35 fe 9a 97 a3  f7 59 56 7f a3 6b 26 7d  |..b5.....YV..k&}|
+00000300  b6 7c e7 f2 d2 30 4e 77  50 91 47 bb 48 e9 3a c1  |.|...0NwP.G.H.:.|
+00000310  c6 58 a4 96 3b 98 3f a8  15 90 51 25 af 50 fc bd  |.X..;.?...Q%.P..|
+00000320  3d fa c3 d4 32 19 fe 9b  bb e5 07 f5 26 56 3a d7  |=...2.......&V:.|
+00000330  e5 00 82 7d dd 26 d8 19  16 6b db 95 20 99 13 44  |...}.&...k.. ..D|
+00000340  8b a5 8b 75 48 de a7 87  cb c4 97 56 60 66 cd d8  |...uH......V`f..|
+00000350  c1 24 7b 21 4a b5 43 1d  37 a5 02 1d 49 33 c9 87  |.${!J.C.7...I3..|
+00000360  af b1 03 0d eb 33 95 ff  ef 8a f6 16 03 01 00 0a  |.....3..........|
+00000370  0d 00 00 06 03 01 02 40  00 00 16 03 01 00 04 0e  |.......@........|
+00000380  00 00 00                                          |...|
 >>> Flow 3 (client to server)
 00000000  16 03 01 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
 00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
@@ -101,34 +100,32 @@
 000001d0  ac 11 b1 28 56 be 1d cd  61 62 84 09 bf d6 80 c6  |...(V...ab......|
 000001e0  45 8d 82 2c b4 d8 83 9b  db c9 22 b7 2a 12 11 7b  |E..,......".*..{|
 000001f0  fa 02 3b c1 c9 ff ea c9  9d a8 49 d3 95 d7 d5 0e  |..;.......I.....|
-00000200  e5 35 16 03 01 00 46 10  00 00 42 41 04 1e 18 37  |.5....F...BA...7|
-00000210  ef 0d 19 51 88 35 75 71  b5 e5 54 5b 12 2e 8f 09  |...Q.5uq..T[....|
-00000220  67 fd a7 24 20 3e b2 56  1c ce 97 28 5e f8 2b 2d  |g..$ >.V...(^.+-|
-00000230  4f 9e f1 07 9f 6c 4b 5b  83 56 e2 32 42 e9 58 b6  |O....lK[.V.2B.X.|
-00000240  d7 49 a6 b5 68 1a 41 03  56 6b dc 5a 89 16 03 01  |.I..h.A.Vk.Z....|
-00000250  00 86 0f 00 00 82 00 80  9c e4 48 ef 27 f9 b3 60  |..........H.'..`|
-00000260  30 b0 dc 64 05 6e e2 b1  16 50 4a 10 7c d6 04 23  |0..d.n...PJ.|..#|
-00000270  71 a3 0c e3 ce 73 7b 2d  d7 c3 54 35 a1 8a 17 37  |q....s{-..T5...7|
-00000280  21 d1 58 d5 42 24 49 78  6e 0b 89 6f 94 ca 7f 54  |!.X.B$Ixn..o...T|
-00000290  ae 6d 1f 21 8a 7f a5 d1  fb 9c 2a 04 03 b5 62 ce  |.m.!......*...b.|
-000002a0  7d a1 a0 57 6f 2b b8 a8  91 41 e9 12 52 c5 ec 73  |}..Wo+...A..R..s|
-000002b0  86 68 a0 56 b6 7f 78 9a  89 b9 d4 e1 2e 6c 24 f4  |.h.V..x......l$.|
-000002c0  3b 24 a8 92 05 bc cf 29  e2 dc 25 a9 bf 43 db 81  |;$.....)..%..C..|
-000002d0  e0 bd 7d 98 1a 3a 5b 4e  14 03 01 00 01 01 16 03  |..}..:[N........|
-000002e0  01 00 30 0c 10 7b c1 61  98 1c b6 57 ab e9 2d e8  |..0..{.a...W..-.|
-000002f0  65 fb 50 6f a8 39 6a dd  ca 70 37 84 64 20 65 19  |e.Po.9j..p7.d e.|
-00000300  58 39 fd e3 30 b1 2f 48  c7 22 8f c4 f1 61 a3 f2  |X9..0./H."...a..|
-00000310  70 0b b6                                          |p..|
+00000200  e5 35 16 03 01 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
+00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
+00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 01 00  |......._X.;t....|
+00000230  86 0f 00 00 82 00 80 1c  2c 0b 87 f7 a9 33 09 7e  |........,....3.~|
+00000240  0b 19 c7 ef e4 bd e9 37  4e 3c 1e 36 5d 1f d0 51  |.......7N<.6]..Q|
+00000250  f7 87 40 66 c1 d2 54 c5  58 2f 03 32 1a 3b f3 4c  |..@f..T.X/.2.;.L|
+00000260  97 db 49 93 ba c5 c0 f4  d2 eb 43 58 25 80 f8 4d  |..I.......CX%..M|
+00000270  1c 6d 10 79 ea d6 b4 07  01 58 a2 a1 48 ae 06 a2  |.m.y.....X..H...|
+00000280  a7 2b 1e 36 a3 58 ab b6  a6 60 24 1d c1 7d 49 2e  |.+.6.X...`$..}I.|
+00000290  14 2d ca 7d 7f df 3f 79  51 43 75 06 86 0b 7d de  |.-.}..?yQCu...}.|
+000002a0  a4 76 18 8d 54 fa 41 b3  d9 06 f0 44 de c7 41 53  |.v..T.A....D..AS|
+000002b0  05 33 0f 5a 48 9e 76 14  03 01 00 01 01 16 03 01  |.3.ZH.v.........|
+000002c0  00 30 ec 96 c4 f6 af 71  4f b6 c9 e0 bf b6 15 51  |.0.....qO......Q|
+000002d0  5d 0a b6 6b 39 d9 9f 53  0f 7e 0c b7 8e 76 0c c4  |]..k9..S.~...v..|
+000002e0  15 36 07 27 51 f9 3e cb  0c 4e 5f 99 19 2d 3c dd  |.6.'Q.>..N_..-<.|
+000002f0  65 0d                                             |e.|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 36 ee 87 93 dd  |..........06....|
-00000010  ec 92 92 ea 76 7f c2 98  34 30 d1 03 b4 60 70 52  |....v...40...`pR|
-00000020  84 e8 e5 88 2c 93 7a 9b  29 6a 2a 62 a3 60 f0 f6  |....,.z.)j*b.`..|
-00000030  9b 81 5d 17 0a 9f 6f cc  45 7e 55                 |..]...o.E~U|
+00000000  14 03 01 00 01 01 16 03  01 00 30 2f ff 36 c3 9e  |..........0/.6..|
+00000010  9e ac 31 15 84 6f c2 c0  fa ce d0 bd 02 9b 75 79  |..1..o........uy|
+00000020  31 d7 9d 38 ad d3 3f 3d  37 7b 2b 0c 9e 01 eb 48  |1..8..?=7{+....H|
+00000030  db fd e2 13 92 d6 75 27  67 f5 1c                 |......u'g..|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 51 b6 eb  e8 21 80 4a 60 d0 ab 86  |.... Q...!.J`...|
-00000010  25 cf 14 9c 21 8d b6 c2  7c e9 96 90 3a f2 bb de  |%...!...|...:...|
-00000020  f4 67 da 4d 9c 17 03 01  00 20 8f 04 37 73 79 25  |.g.M..... ..7sy%|
-00000030  12 95 f1 45 ca ef 71 2f  4c f2 52 67 bb 97 8e 73  |...E..q/L.Rg...s|
-00000040  df ce 2c b1 7f 40 b2 91  4b 8d 15 03 01 00 20 bb  |..,..@..K..... .|
-00000050  34 d8 f2 08 79 fc d3 b9  01 66 7b ad 58 3f f3 64  |4...y....f{.X?.d|
-00000060  4c e2 43 3d cf 32 27 2c  d8 08 c0 e4 3c 23 7b     |L.C=.2',....<#{|
+00000000  17 03 01 00 20 6e b9 45  11 17 34 fd 03 ec 49 11  |.... n.E..4...I.|
+00000010  b1 2c cb d8 53 20 21 8f  1a 0f 04 3e ef 73 0f a0  |.,..S !....>.s..|
+00000020  4c 1f df 63 08 17 03 01  00 20 ab 15 7e c9 84 36  |L..c..... ..~..6|
+00000030  06 f2 f3 fe a6 cf ad 04  16 26 49 a2 bd 32 b2 a1  |.........&I..2..|
+00000040  08 8c c6 98 2f 1f 01 8a  13 be 15 03 01 00 20 90  |..../......... .|
+00000050  6a b8 ab fc 99 e0 79 1e  fc 5d 7d f4 07 f8 ff c5  |j.....y..]}.....|
+00000060  e7 62 c6 31 1e 93 08 4c  78 50 b5 d2 db 7f 79     |.b.1...LxP....y|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES
index e927c3a9e4..97a3c75bd5 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 59 02 00 00  55 03 01 ad 73 ab 19 40  |....Y...U...s..@|
-00000010  f9 55 c6 66 42 22 d2 dd  1b ab da 28 bb 0d cc f6  |.U.fB".....(....|
-00000020  88 75 f0 52 d1 90 39 42  16 25 7a 20 21 96 87 ab  |.u.R..9B.%z !...|
-00000030  12 5c 25 5e d3 84 fb 53  b5 b3 d9 3d bb 42 72 c8  |.\%^...S...=.Br.|
-00000040  55 3e 4e 43 cb 36 38 47  cd dc fa ad c0 09 00 00  |U>NC.68G........|
+00000000  16 03 01 00 59 02 00 00  55 03 01 7f 7a 72 0f 01  |....Y...U...zr..|
+00000010  51 e6 e1 84 7c c5 e8 70  bf 7f a9 19 17 76 24 90  |Q...|..p.....v$.|
+00000020  23 b9 ca 72 9c c1 53 d7  da 58 75 20 d6 44 9b 50  |#..r..S..Xu .D.P|
+00000030  2e 64 10 11 07 5e 33 cb  b2 13 72 74 a4 02 f7 46  |.d...^3...rt...F|
+00000040  fe 88 dc 32 3e 9b 04 fc  b1 cc 17 70 c0 09 00 00  |...2>......p....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  01 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,41 +49,37 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 01 00 d4 0c 00  00 d0 03 00 17 41 04 0d  |*............A..|
-00000280  e8 5a 74 30 43 bb 24 3b  77 5e 60 c8 05 57 ca 5e  |.Zt0C.$;w^`..W.^|
-00000290  79 e1 35 a1 48 3a b2 af  c5 9d c8 fa 38 f7 4b ec  |y.5.H:......8.K.|
-000002a0  09 fb 29 e0 ac f1 43 70  ca ec b7 8c f5 22 42 a6  |..)...Cp....."B.|
-000002b0  56 7b 4a db 84 dc 2b 31  f8 46 35 3f 9c 72 fb 00  |V{J...+1.F5?.r..|
-000002c0  89 30 81 86 02 41 27 a5  3b 2c f0 d9 a6 74 6f b6  |.0...A'.;,...to.|
-000002d0  2c 3a 9f 9b bf 1c 50 9c  07 7f 50 b1 82 41 17 4e  |,:....P...P..A.N|
-000002e0  c2 77 13 84 27 5c 28 a9  14 c7 e2 d1 4b 84 eb 22  |.w..'\(.....K.."|
-000002f0  b0 d1 f9 6b 6e 08 52 11  aa 21 34 82 43 d1 ed 73  |...kn.R..!4.C..s|
-00000300  3a 04 e3 a1 3f e5 4e 02  41 6e 4c a9 ab d6 e0 b1  |:...?.N.AnL.....|
-00000310  45 88 00 44 47 af 64 d0  51 20 ca b4 52 79 3e de  |E..DG.d.Q ..Ry>.|
-00000320  e7 ba 9a 06 03 b6 c5 7f  7f e1 8f 54 eb 4b 0b 6e  |...........T.K.n|
-00000330  e3 b7 a2 86 b6 b6 49 d1  2e 0d 50 33 75 c5 49 8b  |......I...P3u.I.|
-00000340  0a 7d fa 6d 57 e8 35 50  0a c3 16 03 01 00 04 0e  |.}.mW.5P........|
-00000350  00 00 00                                          |...|
+00000270  2a 16 03 01 00 b5 0c 00  00 b1 03 00 1d 20 9a 73  |*............ .s|
+00000280  13 72 2e de 36 07 b0 c7  05 90 f6 d7 83 06 85 0a  |.r..6...........|
+00000290  d5 d7 be 7a ed 5c 12 e2  57 95 8e fc 96 6b 00 8b  |...z.\..W....k..|
+000002a0  30 81 88 02 42 01 a7 30  a7 09 63 5c d3 1f 82 80  |0...B..0..c\....|
+000002b0  11 41 fe 84 53 7b 1c fa  a6 d6 f5 cd 21 f5 85 e2  |.A..S{......!...|
+000002c0  c3 29 4b e7 9c e1 6e 59  d8 89 4a ac dd 6a 28 60  |.)K...nY..J..j(`|
+000002d0  c2 74 36 92 86 9e 7d 03  90 54 41 d9 2e 95 1e 6e  |.t6...}..TA....n|
+000002e0  e6 02 e9 f6 99 e7 35 02  42 01 5f a8 f1 3f 05 2f  |......5.B._..?./|
+000002f0  ab a5 14 86 71 35 9a 41  f5 21 57 a4 8e 2f e6 d7  |....q5.A.!W../..|
+00000300  1b dc 35 65 10 11 92 47  59 8e 26 32 45 66 03 3b  |..5e...GY.&2Ef.;|
+00000310  98 31 d5 cc 39 d1 30 f9  40 75 3d ac 1b 4b 0d 03  |.1..9.0.@u=..K..|
+00000320  60 6a 0d 84 62 b8 30 f7  b4 4e 3c 16 03 01 00 04  |`j..b.0..N<.....|
+00000330  0e 00 00 00                                       |....|
 >>> Flow 3 (client to server)
-00000000  16 03 01 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
-00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
-00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
-00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
-00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 01 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 01 00 30 57 49  e2 22 09 08 84 39 73 46  |.....0WI."...9sF|
-00000060  f3 cf 03 7a d4 fd ca 18  05 6b eb da c7 b0 9d 05  |...z.....k......|
-00000070  c8 aa 61 f5 fd 1d c3 a4  5d 15 51 dd 03 67 aa 9d  |..a.....].Q..g..|
-00000080  85 9d 78 bc 82 00                                 |..x...|
+00000000  16 03 01 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
+00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
+00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 01 00 01 01  |....._X.;t......|
+00000030  16 03 01 00 30 9f b5 ef  8e cb 94 f6 4a 6f 97 77  |....0.......Jo.w|
+00000040  36 bc ff a0 06 30 8e 22  54 95 63 64 b7 6e fc 89  |6....0."T.cd.n..|
+00000050  19 be 38 7b 66 11 a1 54  4e e7 27 f6 8e db e6 48  |..8{f..TN.'....H|
+00000060  74 68 34 d2 0f                                    |th4..|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 d0 dc fe f9 3a  |..........0....:|
-00000010  df b1 1d ea b6 49 27 b3  7f 96 5d a9 ec e4 b4 01  |.....I'...].....|
-00000020  6f 46 db 4d ed 43 a7 fb  6a 8b b4 4c 51 8a 1a 7f  |oF.M.C..j..LQ...|
-00000030  f2 92 54 3b 20 1c 58 de  27 93 a3                 |..T; .X.'..|
+00000000  14 03 01 00 01 01 16 03  01 00 30 66 46 33 1e e1  |..........0fF3..|
+00000010  bd 36 f4 a0 f7 88 96 36  7c 4b a4 26 c8 e3 07 e6  |.6.....6|K.&....|
+00000020  ed 9e 65 dd bc 72 ca d0  c5 d1 b4 f0 0c f9 65 ff  |..e..r........e.|
+00000030  44 ef 92 cb 03 21 05 1f  00 d7 14                 |D....!.....|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 03 4c a7  c8 19 e2 e1 e7 ba 7d 96  |.... .L.......}.|
-00000010  77 83 e8 db ee 41 3d 6e  66 c8 1d 54 85 d8 14 92  |w....A=nf..T....|
-00000020  33 b8 e8 f5 de 17 03 01  00 20 3c c4 6e d3 1f 0a  |3........ <.n...|
-00000030  43 b0 0f 7b c7 f8 48 e9  90 5d 50 6b 74 79 b3 47  |C..{..H..]Pkty.G|
-00000040  71 12 7e 31 e1 d6 ab 6e  58 48 15 03 01 00 20 fc  |q.~1...nXH.... .|
-00000050  bb 86 b3 d0 44 b1 ef 80  87 e4 d9 76 b7 68 f4 a9  |....D......v.h..|
-00000060  3b 86 56 c3 2c 54 0e cb  69 ec 60 c1 c4 a1 e9     |;.V.,T..i.`....|
+00000000  17 03 01 00 20 38 08 92  32 d9 fe 2c 0b 82 11 d2  |.... 8..2..,....|
+00000010  d5 b5 02 42 19 87 15 03  8e ca 79 6b 6b b1 82 ba  |...B......ykk...|
+00000020  65 9d 53 67 6b 17 03 01  00 20 9d 95 f7 f3 d3 d5  |e.Sgk.... ......|
+00000030  98 47 3b 78 89 40 43 b2  3b 3c 32 1a 08 fc 02 00  |.G;x.@C.;<2.....|
+00000040  1b ad be a6 2a 65 6e 15  b7 8e 15 03 01 00 20 d7  |....*en....... .|
+00000050  4d d1 d1 58 bc 6e 19 3e  28 66 f0 a6 74 ba 02 78  |M..X.n.>(f..t..x|
+00000060  d2 aa 62 2b c1 91 05 3d  11 89 9e c3 6d 33 16     |..b+...=....m3.|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES
index 214a0c87d9..9e81c4dbe5 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 59 02 00 00  55 03 01 7e 9f ae 06 96  |....Y...U..~....|
-00000010  f9 31 05 96 e9 ee 59 8d  84 dd 40 25 4c 1e e9 b2  |.1....Y...@%L...|
-00000020  b9 d0 7b e1 a9 4d d9 ea  f9 f7 d1 20 21 35 e2 5a  |..{..M..... !5.Z|
-00000030  8f 72 0c b4 4e 5e 55 00  98 db a7 18 d3 60 01 be  |.r..N^U......`..|
-00000040  0f 0a 06 56 29 0b 67 fc  fa aa 09 f4 c0 13 00 00  |...V).g.........|
+00000000  16 03 01 00 59 02 00 00  55 03 01 12 98 43 77 a8  |....Y...U....Cw.|
+00000010  19 99 16 b4 38 09 9b b6  b7 29 66 0b 73 88 be 43  |....8....)f.s..C|
+00000020  ac 06 f1 d6 64 bd 79 3e  3b d8 38 20 b7 8b 0e 4f  |....d.y>;.8 ...O|
+00000030  89 ad 72 b3 23 84 36 25  d1 ab 64 f3 8f ab b4 a0  |..r.#.6%..d.....|
+00000040  d0 30 78 c0 9d f7 63 c1  d9 8e 92 ce c0 13 00 00  |.0x...c.........|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  01 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,40 +54,36 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 01 00  |.=.`.\!.;.......|
-000002c0  cb 0c 00 00 c7 03 00 17  41 04 82 46 ed 76 ab f8  |........A..F.v..|
-000002d0  33 eb fe 17 f8 83 d6 68  bb b6 fc 2b 86 f6 18 a6  |3......h...+....|
-000002e0  bd dc 3e 35 6b 03 48 03  5f f0 3f a9 70 41 bd a4  |..>5k.H._.?.pA..|
-000002f0  83 67 83 42 86 fc f5 ba  9e f5 4c b8 5a b7 ab 8b  |.g.B......L.Z...|
-00000300  77 33 79 ea 99 21 88 06  bc f0 00 80 9b f9 31 3a  |w3y..!........1:|
-00000310  7c 33 31 01 e2 a3 e9 97  a3 03 93 bb b7 fd 60 42  ||31...........`B|
-00000320  89 3a b1 ff 59 11 ca 71  5f 05 06 a7 6d ec c5 7d  |.:..Y..q_...m..}|
-00000330  9e 93 2c 26 5c 29 9f 80  b1 dc 5a 1c 80 5d b9 a0  |..,&\)....Z..]..|
-00000340  5e f7 05 d8 ad 9d c7 f2  69 11 d5 69 a8 51 16 06  |^.......i..i.Q..|
-00000350  76 5d 49 a4 ac 7b 5c 73  1f 31 da 2f b7 83 6a 6e  |v]I..{\s.1./..jn|
-00000360  4a d6 56 53 91 66 0a e3  3d 70 c6 ee 42 84 15 12  |J.VS.f..=p..B...|
-00000370  68 d3 9d f8 95 26 bd b4  2f 06 25 f0 34 9c f8 8e  |h....&../.%.4...|
-00000380  f5 ed 1d a3 0e 99 47 52  46 88 08 2d 16 03 01 00  |......GRF..-....|
-00000390  04 0e 00 00 00                                    |.....|
+000002c0  aa 0c 00 00 a6 03 00 1d  20 b7 6f b1 79 f8 fb ab  |........ .o.y...|
+000002d0  c6 75 22 1e 08 cc e7 cd  69 0a 86 1c de 60 9d 0e  |.u".....i....`..|
+000002e0  90 5b 9f b5 7b 6d 20 56  5d 00 80 a4 c0 4c 9c 50  |.[..{m V]....L.P|
+000002f0  da bc d7 ae 93 14 57 a9  1c b2 e6 3c 06 f4 7c 78  |......W....<..|x|
+00000300  a9 e9 06 ae ce 95 89 f1  1c 38 8f 45 40 b5 a9 67  |.........8.E@..g|
+00000310  b4 7d f6 65 10 6f 9e a7  64 e6 fa 0a 02 1b bf ea  |.}.e.o..d.......|
+00000320  b5 3f 59 e2 73 c6 e0 02  3e eb 23 16 77 a7 6a aa  |.?Y.s...>.#.w.j.|
+00000330  60 08 71 4f 36 37 cb cf  6d 11 31 fd 45 42 4a 1c  |`.qO67..m.1.EBJ.|
+00000340  37 27 02 13 6d d5 34 7a  64 61 12 38 17 26 ea c4  |7'..m.4zda.8.&..|
+00000350  16 bc c5 9c 57 31 e3 05  2a ff 65 29 2a 03 af f2  |....W1..*.e)*...|
+00000360  8b 00 cd f1 8a dd d1 5e  49 a5 ec 16 03 01 00 04  |.......^I.......|
+00000370  0e 00 00 00                                       |....|
 >>> Flow 3 (client to server)
-00000000  16 03 01 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
-00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
-00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
-00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
-00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 01 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 01 00 30 dd cd  57 a9 ae 84 df 19 da ed  |.....0..W.......|
-00000060  18 3e 8b f9 79 42 33 4f  15 8a a1 28 a1 44 92 5d  |.>..yB3O...(.D.]|
-00000070  ad 8e 47 54 e9 1a 51 f2  a8 9e 99 88 79 fd 0d de  |..GT..Q.....y...|
-00000080  21 33 24 80 3e 84                                 |!3$.>.|
+00000000  16 03 01 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
+00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
+00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 01 00 01 01  |....._X.;t......|
+00000030  16 03 01 00 30 45 0b 24  ee b4 ec 5e 4b 00 50 9a  |....0E.$...^K.P.|
+00000040  7d c7 db 51 b4 c4 31 f8  dc 62 d5 44 d2 5a 02 ce  |}..Q..1..b.D.Z..|
+00000050  c9 fa 35 2a fd 89 7d 64  3f b5 42 03 b1 b2 08 ee  |..5*..}d?.B.....|
+00000060  9e da 12 26 37                                    |...&7|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 e2 27 e3 07 92  |..........0.'...|
-00000010  b6 3b 3b 0e b4 31 39 12  0b ae 5a b3 16 10 59 3f  |.;;..19...Z...Y?|
-00000020  c3 b1 ea 5c 04 21 4f 7b  25 3c ac 2b 70 e7 fe 76  |...\.!O{%<.+p..v|
-00000030  05 36 bd a4 e1 9e 13 d6  cd 29 53                 |.6.......)S|
+00000000  14 03 01 00 01 01 16 03  01 00 30 6a 3c 82 03 56  |..........0j<..V|
+00000010  6d 7c f1 cd 57 54 73 a7  d2 91 f8 51 07 e4 f7 86  |m|..WTs....Q....|
+00000020  bc 61 e0 86 1a ff fa f8  c9 4a 74 14 3a fa c9 67  |.a.......Jt.:..g|
+00000030  10 78 3e 30 14 4d ee 2e  e6 0f 4b                 |.x>0.M....K|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 77 65 af  9b 27 6e eb fb 36 4c 76  |.... we..'n..6Lv|
-00000010  4e 5b 37 4d f3 43 dd 44  9f b4 97 60 4c 02 5a b8  |N[7M.C.D...`L.Z.|
-00000020  90 7f 95 3e 31 17 03 01  00 20 41 4a b3 b3 e1 8c  |...>1.... AJ....|
-00000030  5f c2 82 c5 ed 29 81 64  cf 45 9b 04 82 de ae 9e  |_....).d.E......|
-00000040  b7 8b 66 64 2b 7e f7 86  e9 29 15 03 01 00 20 1a  |..fd+~...).... .|
-00000050  f7 c8 58 66 1c eb 52 66  a1 e0 5d f6 67 74 84 9a  |..Xf..Rf..].gt..|
-00000060  76 dc 0d 8b 2c 02 04 ff  5a d1 71 4b 12 73 c7     |v...,...Z.qK.s.|
+00000000  17 03 01 00 20 b2 62 65  f3 1d ec ed 26 8e e0 a3  |.... .be....&...|
+00000010  18 63 88 0e 50 13 61 a5  eb eb 61 30 e7 f8 ea 55  |.c..P.a...a0...U|
+00000020  bd e8 0e d4 4d 17 03 01  00 20 ac 64 b0 07 83 d2  |....M.... .d....|
+00000030  53 bb 7e 2f a2 9a e4 c8  e0 51 30 bd b7 2e f9 bf  |S.~/.....Q0.....|
+00000040  6a 9c c7 68 eb 7a 97 a9  de 14 15 03 01 00 20 84  |j..h.z........ .|
+00000050  8f 8d 04 b0 40 88 93 66  d7 e2 ea 74 d7 34 b9 c4  |....@..f...t.4..|
+00000060  43 27 f8 f5 4b e5 04 f0  ba e3 c7 b0 7c 0e c1     |C'..K.......|..|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4 b/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4
index d21b849858..6028d9f802 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4
+++ b/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 51 02 00 00  4d 03 01 a8 a1 28 82 1d  |....Q...M....(..|
-00000010  4c 2e bb c6 1d f1 cd 6f  a2 89 b7 d9 51 e4 40 b9  |L......o....Q.@.|
-00000020  f7 5f 36 cc d3 e1 61 bc  39 d7 4c 20 4a 5f 29 a5  |._6...a.9.L J_).|
-00000030  83 41 83 e8 20 ce 40 e0  04 15 28 d9 f8 51 ec 70  |.A.. .@...(..Q.p|
-00000040  9b 2b a4 07 5c 4b d8 d0  64 50 16 76 00 05 00 00  |.+..\K..dP.v....|
+00000000  16 03 01 00 51 02 00 00  4d 03 01 d8 50 e1 90 2e  |....Q...M...P...|
+00000010  c0 9d 17 02 7c a3 9a 9e  4c 4f 4a 80 32 49 b9 32  |....|...LOJ.2I.2|
+00000020  2d ef b2 31 b4 d4 22 27  e9 09 ba 20 f1 93 96 a2  |-..1.."'... ....|
+00000030  0c d1 b3 27 ac 67 f3 e7  fa e7 b4 fb a6 b6 b1 47  |...'.g.........G|
+00000040  f8 f5 f0 94 c0 97 0b 05  80 a9 b9 c2 00 05 00 00  |................|
 00000050  05 ff 01 00 01 00 16 03  01 02 59 0b 00 02 55 00  |..........Y...U.|
 00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -63,15 +64,15 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 01 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 01 00 24 1c 9e  2b bf 0b c8 64 ce 4c bd  |.....$..+...d.L.|
-000000a0  e1 88 27 6b 3f 62 c1 6e  28 3a 4e 5b 32 b3 37 4f  |..'k?b.n(:N[2.7O|
-000000b0  0f 7d 00 3d d4 bc e9 18  aa b4                    |.}.=......|
+00000090  01 16 03 01 00 24 88 be  a9 b7 ed 3f 07 86 ec 30  |.....$.....?...0|
+000000a0  67 0c 26 37 3f dc 9b 79  10 13 9a bb 35 e4 a9 0f  |g.&7?..y....5...|
+000000b0  9c 45 47 38 48 10 1b a8  30 7b                    |.EG8H...0{|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 24 38 e2 4f f3 c0  |..........$8.O..|
-00000010  95 8e 42 2b c3 2c a8 52  ea 47 5f 1b 5c c6 44 e0  |..B+.,.R.G_.\.D.|
-00000020  c6 1d 4f ab 4e 14 3b 83  66 cc 08 a3 0e bd 2b     |..O.N.;.f.....+|
+00000000  14 03 01 00 01 01 16 03  01 00 24 70 ec d0 14 62  |..........$p...b|
+00000010  2f a5 fb 33 c7 0d 26 63  9f 46 78 63 a3 9a e3 88  |/..3..&c.Fxc....|
+00000020  9c ce d0 4f 99 d5 eb b0  5a 2f 68 84 44 7a de     |...O....Z/h.Dz.|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 1a da d8 1b  9a 14 00 7d cc f3 c9 4f  |...........}...O|
-00000010  f3 b9 db 10 91 42 5b 2c  51 d7 05 17 92 7a d5 15  |.....B[,Q....z..|
-00000020  03 01 00 16 3f 5d 3d 95  2a a3 b5 39 1d 48 13 b5  |....?]=.*..9.H..|
-00000030  50 87 6c e4 07 12 e3 97  5d d0                    |P.l.....].|
+00000000  17 03 01 00 1a dd 13 a6  7b 27 eb e7 9d fe 4a 3a  |........{'....J:|
+00000010  e5 f7 80 4a 24 d6 53 74  94 91 06 4f 1e d7 8d 15  |...J$.St...O....|
+00000020  03 01 00 16 ca c6 19 10  63 5d a6 40 d2 c2 f9 8e  |........c].@....|
+00000030  f6 e9 16 2c c6 d3 7d 07  63 33                    |...,..}.c3|
diff --git a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES
index a1d6e5b439..5dda2335cc 100644
--- a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 02 00 59 02 00 00  55 03 02 e2 b2 bb 18 7a  |....Y...U......z|
-00000010  68 b6 d5 cf b0 11 28 3f  e5 4d aa ad 08 de 60 e3  |h.....(?.M....`.|
-00000020  d3 48 76 bc bf a7 7f 11  40 f8 b6 20 e1 f2 01 fb  |.Hv.....@.. ....|
-00000030  f7 e4 32 e3 d9 63 e1 90  fa c7 a1 05 42 ae c2 50  |..2..c......B..P|
-00000040  da 5b d4 30 16 90 f5 1a  1a 2e 82 49 c0 09 00 00  |.[.0.......I....|
+00000000  16 03 02 00 59 02 00 00  55 03 02 a7 3e a2 92 d9  |....Y...U...>...|
+00000010  36 4c 15 c8 71 41 b5 f1  05 ad f8 23 e5 85 d6 ca  |6L..qA.....#....|
+00000020  8d e8 c7 e6 f1 82 32 a8  0b 9f 60 20 90 89 d0 ea  |......2...` ....|
+00000030  a5 15 50 f0 56 6d e7 94  5a 2b 42 3c 8f b8 f9 42  |..P.Vm..Z+B<...B|
+00000040  1a 7c ee 4e b4 1e 0c 9a  83 7f 69 87 c0 09 00 00  |.|.N......i.....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  02 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,43 +49,39 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 02 00 d6 0c 00  00 d2 03 00 17 41 04 ce  |*............A..|
-00000280  1f 5b a2 66 41 7d 08 48  a2 82 da da bc 0d 8c 09  |.[.fA}.H........|
-00000290  39 84 9c 9c 48 20 ac 0a  d1 a4 6e db 94 48 ae a6  |9...H ....n..H..|
-000002a0  56 6e 3d c4 a2 82 f5 c7  e1 19 cc d0 25 5a 97 9b  |Vn=.........%Z..|
-000002b0  34 93 98 81 c1 4f 3b 6e  38 49 28 a4 a3 39 25 00  |4....O;n8I(..9%.|
-000002c0  8b 30 81 88 02 42 00 b6  51 8c 31 a6 9a 3b 2f 29  |.0...B..Q.1..;/)|
-000002d0  1f c1 03 80 ea 4a 94 a6  7d 7e ef c8 c6 cc 21 4d  |.....J..}~....!M|
-000002e0  2e 95 c7 57 94 d6 a0 bf  c5 c8 99 8a 93 1d 2a 9f  |...W..........*.|
-000002f0  c7 bd 71 1a c7 8c 97 0c  72 5d 60 53 e7 80 fe 3c  |..q.....r]`S...<|
-00000300  18 7a 00 60 ba 14 70 71  02 42 01 98 78 54 f0 f8  |.z.`..pq.B..xT..|
-00000310  9b f8 0f 8f e4 e0 9d 4a  08 d9 61 a9 8b 36 b4 bc  |.......J..a..6..|
-00000320  15 c1 33 93 d3 62 0c a2  b1 af 77 1e 44 39 f4 b2  |..3..b....w.D9..|
-00000330  10 b4 d0 ee 89 6a 85 af  ab 00 eb 11 b0 ba 3a 15  |.....j........:.|
-00000340  e3 b4 39 23 a8 d5 95 fe  27 8a b6 38 16 03 02 00  |..9#....'..8....|
-00000350  04 0e 00 00 00                                    |.....|
+00000270  2a 16 03 02 00 b4 0c 00  00 b0 03 00 1d 20 1d 37  |*............ .7|
+00000280  90 ee f8 eb a1 2b 65 dc  a4 97 04 48 c6 0d 64 2b  |.....+e....H..d+|
+00000290  97 a9 c6 50 c7 b5 a8 06  4c 74 9e 7f f4 45 00 8a  |...P....Lt...E..|
+000002a0  30 81 87 02 41 4d 99 60  cb 80 0d 97 ea a8 57 cb  |0...AM.`......W.|
+000002b0  bb 5c c2 ad 14 60 80 3b  d9 e3 7a 93 bf 51 c0 45  |.\...`.;..z..Q.E|
+000002c0  98 65 e7 d8 c7 a0 36 8b  e2 ae 5f 84 cc 1a 1d 8b  |.e....6..._.....|
+000002d0  d3 a6 da 4d 53 0a ac aa  5d 69 7c 9c 0f c1 c8 0b  |...MS...]i|.....|
+000002e0  4f d6 c3 ba de 51 02 42  00 ab c8 7b c7 97 98 7c  |O....Q.B...{...||
+000002f0  84 39 55 7d f1 63 00 bf  9f 46 d1 6f 9a 69 0c cb  |.9U}.c...F.o.i..|
+00000300  bb db 53 bb 80 8e 80 8b  48 63 9f 0f 24 a3 dc 50  |..S.....Hc..$..P|
+00000310  d3 f9 52 0c 0a d9 3b 45  49 56 c8 38 97 70 ce 7f  |..R...;EIV.8.p..|
+00000320  83 c9 76 b6 ef cd b5 80  17 7b 16 03 02 00 04 0e  |..v......{......|
+00000330  00 00 00                                          |...|
 >>> Flow 3 (client to server)
-00000000  16 03 02 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
-00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
-00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
-00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
-00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 02 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 02 00 40 00 00  00 00 00 00 00 00 00 00  |.....@..........|
-00000060  00 00 00 00 00 00 d5 c5  43 cf 56 45 ce 5f f6 ea  |........C.VE._..|
-00000070  ad 4a 93 47 a4 f0 66 41  cf 06 5d 50 dc 74 4b 35  |.J.G..fA..]P.tK5|
-00000080  69 0b 89 85 44 70 81 96  91 24 33 0c 7b 32 1f 98  |i...Dp...$3.{2..|
-00000090  9c b5 80 34 eb a0                                 |...4..|
+00000000  16 03 02 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
+00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
+00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 02 00 01 01  |....._X.;t......|
+00000030  16 03 02 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
+00000040  00 00 00 00 00 a2 0b a0  d7 8a 85 1b 42 24 ff 1e  |............B$..|
+00000050  ea f6 a4 f6 40 94 f7 08  3b 12 4d f9 05 af fa 58  |....@...;.M....X|
+00000060  9d 46 5b 6c fe de b8 da  b0 4e 05 b1 ce 87 6a 35  |.F[l.....N....j5|
+00000070  bf 81 cb e6 90                                    |.....|
 >>> Flow 4 (server to client)
-00000000  14 03 02 00 01 01 16 03  02 00 40 bb 38 4b e5 5d  |..........@.8K.]|
-00000010  8a a1 39 b8 77 c5 b4 4e  ac f7 f9 8d ef 2b 66 0c  |..9.w..N.....+f.|
-00000020  d8 5a 93 64 fc a3 13 7a  10 f0 86 1e ff 0b 6c 02  |.Z.d...z......l.|
-00000030  b6 d6 d8 3e 5c dd 6c 0b  b5 2b c5 22 b1 4d b5 b5  |...>\.l..+.".M..|
-00000040  c8 47 30 d7 b1 2e 38 0c  22 35 0c                 |.G0...8."5.|
+00000000  14 03 02 00 01 01 16 03  02 00 40 13 43 c7 e3 2d  |..........@.C..-|
+00000010  85 78 cd 81 14 ff 31 15  d9 42 c2 b1 b2 d2 54 37  |.x....1..B....T7|
+00000020  81 9a 2a e3 40 44 13 18  ed bd 4d fd 8e 81 fd 52  |..*.@D....M....R|
+00000030  23 bb ee 2e f6 d3 e4 b4  2b 54 e0 eb 11 90 fb 15  |#.......+T......|
+00000040  61 a6 db ea 7d 0b 67 96  ac de cc                 |a...}.g....|
 >>> Flow 5 (client to server)
 00000000  17 03 02 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 af a4 14  82 b5 d4 d1 c4 ec f5 64  |...............d|
-00000020  c4 75 5b f5 8b 23 7e c9  06 06 4c a8 4e b2 5b eb  |.u[..#~...L.N.[.|
-00000030  c8 a9 f8 57 b3 15 03 02  00 30 00 00 00 00 00 00  |...W.....0......|
-00000040  00 00 00 00 00 00 00 00  00 00 13 bc 2d 1e 5c 26  |............-.\&|
-00000050  b7 3e 9d 0f 65 b8 83 01  d6 67 9e 15 e8 59 4f 18  |.>..e....g...YO.|
-00000060  2b 69 a5 d6 44 11 0f f7  b7 b7                    |+i..D.....|
+00000010  00 00 00 00 00 55 2c 91  b9 62 d3 39 e0 76 fd 21  |.....U,..b.9.v.!|
+00000020  5a 61 68 2c d3 01 0e 40  df d8 2f 4b 06 ed 83 bd  |Zah,...@../K....|
+00000030  4f 68 00 d2 93 15 03 02  00 30 00 00 00 00 00 00  |Oh.......0......|
+00000040  00 00 00 00 00 00 00 00  00 00 a5 ba 0b eb 8b 86  |................|
+00000050  55 11 70 3e c3 bf 2b 36  bb 21 9c 51 ee e7 54 89  |U.p>..+6.!.Q..T.|
+00000060  50 94 54 23 85 91 d2 c7  e4 20                    |P.T#..... |
diff --git a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES
index c808ccb1b4..2dd5d2c73d 100644
--- a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 02 00 59 02 00 00  55 03 02 8e 97 02 97 9c  |....Y...U.......|
-00000010  0c 25 1f fa 9f 0f 70 80  83 46 4f 18 d4 e3 11 a0  |.%....p..FO.....|
-00000020  78 06 b5 ad fd 89 5e bc  06 e0 18 20 3d 4c be ba  |x.....^.... =L..|
-00000030  2f 16 d8 dc 82 2c 21 39  71 5e aa 4f f5 ff e3 38  |/....,!9q^.O...8|
-00000040  66 b6 ca 93 bd 17 14 ee  2c cb 3d ce c0 13 00 00  |f.......,.=.....|
+00000000  16 03 02 00 59 02 00 00  55 03 02 74 de 20 08 26  |....Y...U..t. .&|
+00000010  5d 65 19 a0 72 a2 44 44  b1 f6 78 1f 6e f4 d9 cb  |]e..r.DD..x.n...|
+00000020  2c 37 c1 89 a3 60 57 36  15 37 da 20 c5 e3 68 84  |,7...`W6.7. ..h.|
+00000030  71 08 ec 9b 2e 50 36 88  15 5e 8a b8 4d 01 de 99  |q....P6..^..M...|
+00000040  c3 20 5a 53 d6 c4 6c 08  dc d7 d6 b0 c0 13 00 00  |. ZS..l.........|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  02 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,42 +54,38 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 02 00  |.=.`.\!.;.......|
-000002c0  cb 0c 00 00 c7 03 00 17  41 04 85 18 55 b4 c4 60  |........A...U..`|
-000002d0  58 34 50 d5 5f 50 3b fa  38 25 98 96 56 4b 9c 20  |X4P._P;.8%..VK. |
-000002e0  0b 17 45 a4 1f 19 71 a6  d6 71 97 3b a3 01 6c e3  |..E...q..q.;..l.|
-000002f0  4d 6f ec 76 31 c7 e4 9f  60 24 d2 2a e1 03 03 40  |Mo.v1...`$.*...@|
-00000300  9e b1 de 70 3e 44 ab ab  1d 8a 00 80 40 75 96 e1  |...p>D......@u..|
-00000310  d2 01 e4 9b bf 21 6d 9f  f9 44 b2 5f 8e f4 02 ff  |.....!m..D._....|
-00000320  b2 ec 98 b6 37 29 1b bd  0f a0 5d 91 7a d9 35 70  |....7)....].z.5p|
-00000330  67 15 72 96 00 19 b9 40  83 a4 c8 7c 06 e4 c8 b8  |g.r....@...|....|
-00000340  d5 5c ac e5 db c1 01 cc  26 0e 6f 93 d9 d4 07 b3  |.\......&.o.....|
-00000350  8d 05 21 0e 20 5c f7 5c  84 24 71 74 99 af 50 27  |..!. \.\.$qt..P'|
-00000360  64 49 ce 3b cd 3e 84 f7  ef 76 de 3a 22 88 fa 15  |dI.;.>...v.:"...|
-00000370  c1 6c 27 60 ec 2a 3f 6b  10 a0 52 d6 6e 75 b0 6f  |.l'`.*?k..R.nu.o|
-00000380  ff 85 fe 1f d2 46 85 ab  89 41 56 e4 16 03 02 00  |.....F...AV.....|
-00000390  04 0e 00 00 00                                    |.....|
+000002c0  aa 0c 00 00 a6 03 00 1d  20 4f f4 9c cd f7 d4 5f  |........ O....._|
+000002d0  50 18 a3 99 05 c4 f8 87  27 dd fd 29 ee e3 df e8  |P.......'..)....|
+000002e0  02 7b 0c ee 35 b2 34 57  35 00 80 83 0a a7 f8 0b  |.{..5.4W5.......|
+000002f0  ab 54 e3 37 5e 75 db 34  fa 66 72 59 3d fe dc fd  |.T.7^u.4.frY=...|
+00000300  2c e3 50 7a 5f 31 c3 3f  41 80 34 c6 3f 32 3f 83  |,.Pz_1.?A.4.?2?.|
+00000310  f6 eb 30 46 e2 86 45 98  33 08 c7 a4 6f 46 30 f9  |..0F..E.3...oF0.|
+00000320  74 ca ab 16 84 f7 75 d9  2f 09 9e b7 b5 a9 a5 ec  |t.....u./.......|
+00000330  63 d2 b1 e8 d1 1e 0b 99  d9 c2 3e 75 80 8d 5a 67  |c.........>u..Zg|
+00000340  ee cd ee b8 03 cb 48 14  43 5e 78 0b 36 cd b3 6d  |......H.C^x.6..m|
+00000350  56 29 b6 c9 cb fc 1f 6a  d9 cc 50 ec 85 ac db ef  |V).....j..P.....|
+00000360  34 cd 14 6b 2f d4 81 51  0b 5a 93 16 03 02 00 04  |4..k/..Q.Z......|
+00000370  0e 00 00 00                                       |....|
 >>> Flow 3 (client to server)
-00000000  16 03 02 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
-00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
-00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
-00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
-00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 02 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 02 00 40 00 00  00 00 00 00 00 00 00 00  |.....@..........|
-00000060  00 00 00 00 00 00 fb 9c  16 6d 8d 12 6a ea 0a b6  |.........m..j...|
-00000070  61 50 73 10 7c 91 e7 e8  93 db 85 81 2b a2 d0 f6  |aPs.|.......+...|
-00000080  d0 9a 69 50 cd c9 c2 d5  d3 2c 35 65 4f 6a 04 c0  |..iP.....,5eOj..|
-00000090  d3 10 8d 8f 00 0d                                 |......|
+00000000  16 03 02 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
+00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
+00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 02 00 01 01  |....._X.;t......|
+00000030  16 03 02 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
+00000040  00 00 00 00 00 7c 90 f4  5b 3d 6b 48 fe 58 f4 55  |.....|..[=kH.X.U|
+00000050  b2 f0 9a 62 c3 08 b6 a6  b5 df c8 7d 99 32 6b 99  |...b.......}.2k.|
+00000060  fb fb 51 54 19 10 77 b2  c8 59 fa ee f7 e7 90 19  |..QT..w..Y......|
+00000070  ed e4 04 3a 6b                                    |...:k|
 >>> Flow 4 (server to client)
-00000000  14 03 02 00 01 01 16 03  02 00 40 c9 0d 8e ea 5e  |..........@....^|
-00000010  49 d1 09 34 4a 4e 58 43  bd ce ed fe 38 77 5a 6b  |I..4JNXC....8wZk|
-00000020  55 ad ec 48 7a 91 4a 86  6f e8 eb 76 c8 5b ac 98  |U..Hz.J.o..v.[..|
-00000030  9d ce 04 ae 8c 1f 97 e8  c3 75 74 75 57 e8 f1 31  |.........utuW..1|
-00000040  bd d6 39 7d 63 dc e1 a1  68 38 a3                 |..9}c...h8.|
+00000000  14 03 02 00 01 01 16 03  02 00 40 a2 a4 67 d8 51  |..........@..g.Q|
+00000010  c7 44 1d 74 49 22 fe d4  56 f4 19 e4 52 57 3a 8c  |.D.tI"..V...RW:.|
+00000020  ad fc 3f ce 30 9d f5 cb  cc 79 cb d6 63 60 74 33  |..?.0....y..c`t3|
+00000030  86 6a ba dd e4 2f 42 03  16 85 f2 f5 93 0d 5e 00  |.j.../B.......^.|
+00000040  89 fa b8 5e 22 8c 44 78  cd 70 69                 |...^".Dx.pi|
 >>> Flow 5 (client to server)
 00000000  17 03 02 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 78 a4 2e  0b 07 f4 e4 0c de 6b fc  |.....x........k.|
-00000020  7e c5 0d f2 a6 7c 2a 0e  cf 71 b4 79 40 7b 38 f1  |~....|*..q.y@{8.|
-00000030  89 e4 00 f1 f4 15 03 02  00 30 00 00 00 00 00 00  |.........0......|
-00000040  00 00 00 00 00 00 00 00  00 00 b8 56 bf 9a a3 93  |...........V....|
-00000050  07 84 de b3 cb 7c 17 d8  92 52 45 d7 07 fb c6 09  |.....|...RE.....|
-00000060  d9 4a 96 c0 73 62 d8 12  94 69                    |.J..sb...i|
+00000010  00 00 00 00 00 77 f6 75  ad 54 68 a4 ab 34 c1 42  |.....w.u.Th..4.B|
+00000020  48 b8 f8 f4 67 e9 61 0f  80 6e f9 f8 de 10 5d 28  |H...g.a..n....](|
+00000030  d1 8f f6 e6 91 15 03 02  00 30 00 00 00 00 00 00  |.........0......|
+00000040  00 00 00 00 00 00 00 00  00 00 28 df 02 7c 5a 06  |..........(..|Z.|
+00000050  f3 97 4f d7 4e 2e df bd  5e 8f df ac 24 b2 06 03  |..O.N...^...$...|
+00000060  9d 2e da a7 ba e0 27 f8  f9 79                    |......'..y|
diff --git a/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4 b/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4
index 17079531ee..d8a484fb70 100644
--- a/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4
+++ b/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 02 00 51 02 00 00  4d 03 02 07 14 79 f7 7c  |....Q...M....y.||
-00000010  2b b0 4e 8c 64 60 3b 6f  f9 ae fe fd 72 4d 18 84  |+.N.d`;o....rM..|
-00000020  33 9d 89 6b 9c 82 02 8a  49 5a 13 20 26 8b 4d d2  |3..k....IZ. &.M.|
-00000030  af 0e 10 62 4d 20 8f 53  81 b9 da 40 9f fc 35 f8  |...bM .S...@..5.|
-00000040  d2 35 8b e0 05 1e 40 d4  43 7c ac 23 00 05 00 00  |.5....@.C|.#....|
+00000000  16 03 02 00 51 02 00 00  4d 03 02 84 8a c8 f2 a5  |....Q...M.......|
+00000010  1c cd b7 c5 2a ee df 38  9a 03 31 81 84 5d 0a 11  |....*..8..1..]..|
+00000020  0a 3c b2 08 aa bc 32 ce  7b 90 01 20 4e 24 ed 86  |.<....2.{.. N$..|
+00000030  9f 7a eb 86 1d 75 de 36  6e 0a b3 f5 98 18 b3 8c  |.z...u.6n.......|
+00000040  d7 0f 0d 49 84 43 91 74  4d 02 64 13 00 05 00 00  |...I.C.tM.d.....|
 00000050  05 ff 01 00 01 00 16 03  02 02 59 0b 00 02 55 00  |..........Y...U.|
 00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -63,15 +64,15 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 02 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 02 00 24 b7 ab  3d c9 24 dc 26 aa 3c 1d  |.....$..=.$.&.<.|
-000000a0  86 71 38 8a 58 3e fe 3c  48 4f f4 d5 27 43 ae 88  |.q8.X>.<HO..'C..|
-000000b0  fb 07 df 17 9b 87 d9 0b  20 a6                    |........ .|
+00000090  01 16 03 02 00 24 a1 e6  c7 78 c4 07 3c cb f7 81  |.....$...x..<...|
+000000a0  54 c8 32 76 29 24 31 a9  02 bc 19 a9 16 8e cf 9f  |T.2v)$1.........|
+000000b0  73 25 95 92 8a 80 97 35  e5 49                    |s%.....5.I|
 >>> Flow 4 (server to client)
-00000000  14 03 02 00 01 01 16 03  02 00 24 04 ee d2 d4 23  |..........$....#|
-00000010  c0 5e aa 9a 39 cc fc 9f  85 c7 4e 23 ed 89 0f f5  |.^..9.....N#....|
-00000020  0d 79 36 f5 04 92 a7 3d  08 1b e6 44 94 ca 03     |.y6....=...D...|
+00000000  14 03 02 00 01 01 16 03  02 00 24 73 e4 77 fd 6d  |..........$s.w.m|
+00000010  87 a8 3e 3a 05 d2 ba c1  fd 23 df 89 d4 a5 61 3a  |..>:.....#....a:|
+00000020  53 05 c0 54 9b df 5b d7  08 2f a2 6d d4 3f c2     |S..T..[../.m.?.|
 >>> Flow 5 (client to server)
-00000000  17 03 02 00 1a f4 bd cb  9f 9c 3c 42 de 9a 41 6b  |..........<B..Ak|
-00000010  62 a1 ca 8f e6 3d d2 39  98 5c 89 b9 c6 32 ee 15  |b....=.9.\...2..|
-00000020  03 02 00 16 c2 99 ce 1b  f8 7a f4 83 59 02 96 ef  |.........z..Y...|
-00000030  33 5e e6 8f 5f 5c e7 e4  0e 5a                    |3^.._\...Z|
+00000000  17 03 02 00 1a 2c 3e d4  b4 c3 61 d2 26 20 16 25  |.....,>...a.& .%|
+00000010  cc b3 e8 b4 aa 90 11 75  da 7f a1 bf a9 58 21 15  |.......u.....X!.|
+00000020  03 02 00 16 0e d5 9e ec  b5 7e 83 1a 5b f1 5a 7b  |.........~..[.Z{|
+00000030  ad ee 18 10 0e e1 ec 61  72 c9                    |.......ar.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256
index 315b7a66ad..c073badc11 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 51 02 00 00  4d 03 03 c5 42 c0 de 64  |....Q...M...B..d|
-00000010  f2 2a cc a1 5e ab 9e 11  b0 d7 63 23 02 4e b3 8a  |.*..^.....c#.N..|
-00000020  08 07 0a f0 ac 7f b4 77  26 8a b7 20 37 1f 7c 28  |.......w&.. 7.|(|
-00000030  3d 7a 6a 58 ee c3 b9 36  cd f0 38 a6 1e 90 a3 6e  |=zjX...6..8....n|
-00000040  c1 ee e3 55 30 50 9a 55  bc 2c be dc 00 9c 00 00  |...U0P.U.,......|
+00000000  16 03 03 00 51 02 00 00  4d 03 03 7a 32 08 d2 4a  |....Q...M..z2..J|
+00000010  af 6c 9f c8 46 15 1c 46  60 43 4c c9 6a 6c 43 12  |.l..F..F`CL.jlC.|
+00000020  c0 d8 56 97 b5 01 c2 96  9f d9 28 20 48 7e b0 97  |..V.......( H~..|
+00000030  10 ef a4 1b a7 f1 0e 15  f5 95 53 72 35 14 ed c9  |..........Sr5...|
+00000040  50 e2 1a 9f 7c c5 d2 f3  1e dd f8 4e 00 9c 00 00  |P...|......N....|
 00000050  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
 00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -63,17 +64,17 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 de a7  |.....(..........|
-000000a0  bc ad 94 20 fb 58 5e 46  9e 3f 31 63 14 ea e9 a4  |... .X^F.?1c....|
-000000b0  30 9e 12 3f a0 cd 9d b9  94 c2 31 58 38 2f        |0..?......1X8/|
+00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 0d fe  |.....(..........|
+000000a0  d9 28 21 4a bd 29 c8 a6  4c 37 b4 bd 32 35 c6 21  |.(!J.)..L7..25.!|
+000000b0  d5 29 3c c6 d3 18 d3 3e  38 0b 9e 51 1e c5        |.)<....>8..Q..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 17 43 47 b8 bb  |..........(.CG..|
-00000010  2d 6a 77 a9 de 2d a5 15  95 cd 41 89 1a b2 c1 9f  |-jw..-....A.....|
-00000020  af fd 13 20 8a 42 1d 7e  47 45 91 c3 5a 11 75 a8  |... .B.~GE..Z.u.|
-00000030  fd 8d 1b                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 28 da f5 83 53 c6  |..........(...S.|
+00000010  97 4c c2 33 83 04 7d 35  c5 48 61 86 06 37 2e e8  |.L.3..}5.Ha..7..|
+00000020  18 4d de 6a 32 13 95 77  ac 03 3e 64 4f e0 fb 99  |.M.j2..w..>dO...|
+00000030  4c 6b 3d                                          |Lk=|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 73 97 7e  |.............s.~|
-00000010  de 2c d2 b9 cb fd cc 6d  f1 2c df fd 17 84 1f 21  |.,.....m.,.....!|
-00000020  d3 63 da 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.c..............|
-00000030  2a 78 32 6b b3 fb 8e f2  35 44 00 f2 32 8e b7 41  |*x2k....5D..2..A|
-00000040  34 24                                             |4$|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 8e a9 14  |................|
+00000010  42 04 b1 b8 63 0d f1 4b  e9 5c 3c 54 7e 28 14 31  |B...c..K.\<T~(.1|
+00000020  a6 2e 90 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
+00000030  ff e2 9e a8 be 31 0b f6  87 a6 11 39 5f b9 71 ff  |.....1.....9_.q.|
+00000040  90 83                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-AES128-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-AES128-SHA256
index 01a40f3ae0..ded7c7bd8d 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-AES128-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv12-AES128-SHA256
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 51 02 00 00  4d 03 03 18 36 ba 7c 68  |....Q...M...6.|h|
-00000010  f1 d6 d4 2e c8 08 97 dd  29 50 9c cf ca d1 59 7e  |........)P....Y~|
-00000020  ec 70 1e 26 e6 9e 9e f8  32 25 1c 20 a0 45 0c ab  |.p.&....2%. .E..|
-00000030  82 2f 2a de fa 34 72 cd  55 2f f3 ac 8b 02 e9 38  |./*..4r.U/.....8|
-00000040  eb 9c a1 c5 fa e4 f6 44  88 1e 5f 42 00 3c 00 00  |.......D.._B.<..|
+00000000  16 03 03 00 51 02 00 00  4d 03 03 8c 19 dc bf e8  |....Q...M.......|
+00000010  10 70 a2 51 1e d0 bd a8  c5 11 aa b7 e0 dd 29 f8  |.p.Q..........).|
+00000020  ab ad 4c e9 62 2f b5 54  5f 66 12 20 a4 90 11 92  |..L.b/.T_f. ....|
+00000030  c9 cc 4c 8e f4 e9 bf 32  da 7f 67 3b 40 7c b3 86  |..L....2..g;@|..|
+00000040  18 c6 23 d0 1c e1 f6 de  5c 0b ef aa 00 3c 00 00  |..#.....\....<..|
 00000050  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
 00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -64,25 +65,25 @@
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
 00000090  01 16 03 03 00 50 00 00  00 00 00 00 00 00 00 00  |.....P..........|
-000000a0  00 00 00 00 00 00 c6 3f  74 c9 ec e1 37 a5 d1 ed  |.......?t...7...|
-000000b0  e2 08 b5 97 01 cb 15 db  9a fb 31 f7 fa 6b fd e6  |..........1..k..|
-000000c0  f1 4f 9c 90 f2 cb 78 e6  2d 9c 30 ba d4 d0 8e b4  |.O....x.-.0.....|
-000000d0  6d f1 ca 3d ec 03 6d aa  8b e2 ed 2f 46 79 30 8f  |m..=..m..../Fy0.|
-000000e0  6f bb cf 6f 11 93                                 |o..o..|
+000000a0  00 00 00 00 00 00 c9 1b  bf 6d f6 95 cc cf 9d 3b  |.........m.....;|
+000000b0  15 6a da 27 dc b9 d3 b2  98 9e 9f f4 fc 85 c8 cd  |.j.'............|
+000000c0  6a f6 6d 20 cf bf 0f 87  c9 b2 9e 16 12 69 1d f8  |j.m .........i..|
+000000d0  f2 52 12 23 58 a5 23 45  d0 3c f9 98 b5 1e 02 d0  |.R.#X.#E.<......|
+000000e0  d6 a1 7f bf 67 ed                                 |....g.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 50 d3 02 06 a8 ab  |..........P.....|
-00000010  30 1e 01 16 cb ef 01 de  36 9c 7e 8f 3e c4 74 e9  |0.......6.~.>.t.|
-00000020  8f 33 c3 ab c3 bf 6e 46  c3 1d 43 16 be bb 63 cf  |.3....nF..C...c.|
-00000030  79 c5 d3 f8 97 b7 ea 73  9d bb e9 3a 02 c6 4d 6f  |y......s...:..Mo|
-00000040  75 cb 8d bd 16 22 1f 0e  56 d6 ef 6f 31 b9 a5 2e  |u...."..V..o1...|
-00000050  ca 02 21 0b 10 d8 44 6a  09 ae 14                 |..!...Dj...|
+00000000  14 03 03 00 01 01 16 03  03 00 50 b5 19 8a 2a a2  |..........P...*.|
+00000010  33 73 ff 3f 94 c6 a6 16  b5 a0 5f 64 33 11 77 90  |3s.?......_d3.w.|
+00000020  26 96 97 32 1d b2 aa c5  7d 86 78 db 98 b4 d7 65  |&..2....}.x....e|
+00000030  e9 4b 11 42 1b c5 6f 28  fe 1c 9e 0f 35 9f 6f 76  |.K.B..o(....5.ov|
+00000040  e5 f6 f8 6e c0 6f 93 a6  ff 49 e0 46 65 8f 8b 8f  |...n.o...I.Fe...|
+00000050  c5 6f 69 5b 67 2f c1 ab  61 e1 8c                 |.oi[g/..a..|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000010  00 00 00 00 00 38 7f df  9d 49 fc e7 b7 f8 ba 53  |.....8...I.....S|
-00000020  d6 0f c1 b8 2e 54 76 3e  d8 c9 93 16 2c 63 09 dc  |.....Tv>....,c..|
-00000030  ac 4b 73 59 7c 71 c2 46  4d 37 a7 c6 9b ab 7f 4c  |.KsY|q.FM7.....L|
-00000040  6a cb fe 1e a3 15 03 03  00 40 00 00 00 00 00 00  |j........@......|
-00000050  00 00 00 00 00 00 00 00  00 00 65 f8 5f f9 73 a7  |..........e._.s.|
-00000060  6c a0 b1 58 b7 3c 63 77  df d0 64 54 fb 76 d8 ca  |l..X.<cw..dT.v..|
-00000070  01 11 0b cb ad 41 f7 ad  cb 56 d2 be 89 1b 70 dd  |.....A...V....p.|
-00000080  23 5e 96 82 bd c1 8e a4  0d 30                    |#^.......0|
+00000010  00 00 00 00 00 88 f5 2a  f7 2d 8b d8 e0 8e e2 8f  |.......*.-......|
+00000020  38 20 33 46 45 0c 75 cc  d0 08 b0 e6 b8 dc 6f 6a  |8 3FE.u.......oj|
+00000030  7b 57 0d 27 a5 e3 82 ee  e7 e3 24 79 0c a9 4a 7c  |{W.'......$y..J||
+00000040  65 45 a8 04 3b 15 03 03  00 40 00 00 00 00 00 00  |eE..;....@......|
+00000050  00 00 00 00 00 00 00 00  00 00 43 52 7c 12 59 f5  |..........CR|.Y.|
+00000060  ec 15 56 f9 ff 9e 8b c7  3d 99 06 a3 5a 98 1d 4e  |..V.....=...Z..N|
+00000070  0f 34 bc 90 3e 61 64 cc  64 f4 23 8d e0 d5 cc 8a  |.4..>ad.d.#.....|
+00000080  9b 43 c2 2e 93 ed eb 91  3f 02                    |.C......?.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384 b/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384
index e088893cbd..794f0955ea 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384
+++ b/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 51 02 00 00  4d 03 03 1e 58 69 db 16  |....Q...M...Xi..|
-00000010  a1 d9 2c 3c b5 68 b6 b1  dc 1e 1d ba 9e dc bf b0  |..,<.h..........|
-00000020  15 7e ea b1 40 66 3b fc  95 75 0d 20 4c 96 db 56  |.~..@f;..u. L..V|
-00000030  fc 7d 2b 0a 06 89 1e 62  9e ee 36 51 f4 e4 2b f8  |.}+....b..6Q..+.|
-00000040  5a 7a ef a4 d1 1f 7e ff  06 13 a1 38 00 9d 00 00  |Zz....~....8....|
+00000000  16 03 03 00 51 02 00 00  4d 03 03 b4 42 95 ec 29  |....Q...M...B..)|
+00000010  a8 f3 4b db 10 02 3d fb  31 89 39 88 6d 13 44 ad  |..K...=.1.9.m.D.|
+00000020  bc e9 0b 66 de c2 48 b2  da 96 ba 20 04 63 b1 f5  |...f..H.... .c..|
+00000030  26 20 3a 2a ee 15 35 ad  c7 98 52 c1 bd d4 bf 7c  |& :*..5...R....||
+00000040  8e cd 9c d8 81 ee b2 60  93 e4 b0 f1 00 9d 00 00  |.......`........|
 00000050  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
 00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -63,17 +64,17 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 6b a3  |.....(........k.|
-000000a0  3b 4a 47 f7 43 00 7d 7b  9e 35 91 8d e4 b1 00 86  |;JG.C.}{.5......|
-000000b0  e2 04 db e8 c5 c4 66 34  b8 4b fc 7e a6 68        |......f4.K.~.h|
+00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 c7 5c  |.....(.........\|
+000000a0  ab a3 37 82 62 49 d3 df  82 9a 8f 14 4e 93 99 94  |..7.bI......N...|
+000000b0  b8 47 7b 52 f4 2c 47 4a  ce ef 97 30 92 51        |.G{R.,GJ...0.Q|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 9c 20 45 1f 6b  |..........(. E.k|
-00000010  0f 08 fb 61 03 12 ca ac  78 04 30 1c 98 50 d8 44  |...a....x.0..P.D|
-00000020  4e 6f d6 57 70 cd 86 49  92 a0 7d 3e 12 a0 3d ab  |No.Wp..I..}>..=.|
-00000030  a6 59 ca                                          |.Y.|
+00000000  14 03 03 00 01 01 16 03  03 00 28 10 d5 f7 84 5b  |..........(....[|
+00000010  55 20 9e ce c3 9e 8c 61  9f 1f 0e 25 df 8f b2 b8  |U .....a...%....|
+00000020  b3 ec 3d 39 43 d2 6c ac  2c 68 84 b8 85 df a8 ee  |..=9C.l.,h......|
+00000030  27 32 7d                                          |'2}|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 06 e7 a0  |................|
-00000010  e1 37 e0 e9 2c e9 cb 2f  3d d8 52 e0 b6 37 22 d2  |.7..,../=.R..7".|
-00000020  cb 3f d9 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.?..............|
-00000030  9d 73 09 7a bd 3c c8 db  b6 5f 2d 3b c6 ce 5f eb  |.s.z.<..._-;.._.|
-00000040  2e 40                                             |.@|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 20 19 28  |............. .(|
+00000010  34 11 61 7d 8e 25 9c 35  57 98 3c 6c 47 45 7d ab  |4.a}.%.5W.<lGE}.|
+00000020  7f 92 8a 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
+00000030  ae 7d 0c 55 c0 8c dc 9c  55 aa f5 6c 6c 7a d3 f9  |.}.U....U..llz..|
+00000040  68 ac                                             |h.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ALPN b/src/crypto/tls/testdata/Client-TLSv12-ALPN
index 0d11e9768f..16c8dae440 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ALPN
+++ b/src/crypto/tls/testdata/Client-TLSv12-ALPN
@@ -1,21 +1,21 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 a3 01 00 00  9f 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 a5 01 00 00  a1 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 4e 33 74 00 00 00 05  |.........N3t....|
-00000060  00 05 01 00 00 00 00 00  0a 00 08 00 06 00 17 00  |................|
-00000070  18 00 19 00 0b 00 02 01  00 00 0d 00 0e 00 0c 04  |................|
-00000080  01 04 03 05 01 05 03 02  01 02 03 ff 01 00 01 00  |................|
-00000090  00 10 00 10 00 0e 06 70  72 6f 74 6f 32 06 70 72  |.......proto2.pr|
-000000a0  6f 74 6f 31 00 12 00 00                           |oto1....|
+00000050  00 05 c0 11 c0 07 01 00  00 50 33 74 00 00 00 05  |.........P3t....|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 10 00 10 00 0e  06 70 72 6f 74 6f 32 06  |.........proto2.|
+000000a0  70 72 6f 74 6f 31 00 12  00 00                    |proto1....|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 66 02 00 00  62 03 03 d6 86 dc 38 ce  |....f...b.....8.|
-00000010  7a e4 81 d8 c8 2a 65 a4  90 70 da 03 5c 29 48 69  |z....*e..p..\)Hi|
-00000020  90 f5 cb 00 5d 3e 98 a5  5c 80 4f 20 42 df b6 1f  |....]>..\.O B...|
-00000030  c7 db 87 d5 8a 0c 5d 56  cb 4e 95 7e 7a 82 f1 5f  |......]V.N.~z.._|
-00000040  d5 2d 33 a6 a8 82 09 e6  a9 5f d2 7b c0 2f 00 00  |.-3......_.{./..|
+00000000  16 03 03 00 66 02 00 00  62 03 03 ec fd fc 73 30  |....f...b.....s0|
+00000010  c2 72 d9 b3 1a 41 65 1c  59 8e c9 92 c5 00 3c 2d  |.r...Ae.Y.....<-|
+00000020  34 ba 48 74 0a c5 fa be  81 41 b7 20 9a b9 f5 01  |4.Ht.....A. ....|
+00000030  7b 21 77 0f a7 a4 51 d6  8d 11 17 19 ec 6a 52 ce  |{!w...Q......jR.|
+00000040  50 6e 95 fc 2e 8f 09 53  e5 ca 62 e8 c0 2f 00 00  |Pn.....S..b../..|
 00000050  1a ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 10  |................|
 00000060  00 09 00 07 06 70 72 6f  74 6f 31 16 03 03 02 59  |.....proto1....Y|
 00000070  0b 00 02 55 00 02 52 00  02 4f 30 82 02 4b 30 82  |...U..R..O0..K0.|
@@ -55,38 +55,34 @@
 00000290  5c ee b1 87 82 f1 6c 04  ed 73 bb b3 43 77 8d 0c  |\.....l..s..Cw..|
 000002a0  1c f1 0f a1 d8 40 83 61  c9 4c 72 2b 9d ae db 46  |.....@.a.Lr+...F|
 000002b0  06 06 4d f4 c1 b3 3e c0  d1 bd 42 d4 db fe 3d 13  |..M...>...B...=.|
-000002c0  60 84 5c 21 d3 3b e9 fa  e7 16 03 03 00 cd 0c 00  |`.\!.;..........|
-000002d0  00 c9 03 00 17 41 04 89  49 b3 e4 a9 b8 e5 08 ff  |.....A..I.......|
-000002e0  5f f5 8c 97 d5 a0 66 9c  9d 36 22 1e 39 32 be c2  |_.....f..6".92..|
-000002f0  05 6c d5 15 28 31 f8 e7  98 f1 6e 94 d6 72 41 b4  |.l..(1....n..rA.|
-00000300  87 39 0e 63 74 43 de 0a  d5 93 51 48 c4 2d f4 20  |.9.ctC....QH.-. |
-00000310  c6 f7 ac 95 a1 b2 40 04  01 00 80 29 ac 3f 1e 0f  |......@....).?..|
-00000320  68 56 c5 02 f6 05 63 58  58 56 11 22 d7 e4 8e 22  |hV....cXXV."..."|
-00000330  c9 9f 7e c0 09 08 d6 ba  b7 e2 e4 ef 93 4e de b6  |..~..........N..|
-00000340  67 e4 89 10 ef cf b1 c1  bd bc 52 2c 96 4d 4d a5  |g.........R,.MM.|
-00000350  fc 74 97 f8 d5 a2 aa a9  7f 98 0c 08 30 2d b3 de  |.t..........0-..|
-00000360  a7 1b 73 ed e1 a1 6f 03  84 71 2e 12 da 86 53 57  |..s...o..q....SW|
-00000370  d1 93 b0 6b 18 53 ec b4  e1 ed ed 82 07 75 dc ff  |...k.S.......u..|
-00000380  4f 6d 86 96 67 b8 f1 cb  53 89 74 0f d8 26 38 52  |Om..g...S.t..&8R|
-00000390  1d 36 b6 a7 04 e4 04 bf  a6 aa dd 16 03 03 00 04  |.6..............|
-000003a0  0e 00 00 00                                       |....|
+000002c0  60 84 5c 21 d3 3b e9 fa  e7 16 03 03 00 ac 0c 00  |`.\!.;..........|
+000002d0  00 a8 03 00 1d 20 ca b0  0d d6 56 b2 89 4d 97 56  |..... ....V..M.V|
+000002e0  20 1a 0f 23 22 83 41 8d  fb 40 7f e9 df 64 cf 2c  | ..#".A..@...d.,|
+000002f0  84 5c 64 ca 91 33 04 01  00 80 55 f4 c0 61 5a 5a  |.\d..3....U..aZZ|
+00000300  f8 05 d6 7f 43 e9 55 68  d4 e6 5b e3 63 27 f9 90  |....C.Uh..[.c'..|
+00000310  82 40 ee bb 85 ab 64 bd  fa 3f 16 9e 10 c7 b1 a5  |.@....d..?......|
+00000320  10 ef 8e 20 17 f9 fa 5b  8a 59 d2 c3 bb 24 33 6c  |... ...[.Y...$3l|
+00000330  01 ce 39 d2 58 47 6b 7b  0f 06 e2 7b c8 ca f7 6b  |..9.XGk{...{...k|
+00000340  ba e3 47 4c d9 b9 78 4a  19 e4 e7 38 19 9d d2 6d  |..GL..xJ...8...m|
+00000350  b2 74 ff 08 25 7b bd c9  30 f4 ec a6 f2 e0 d9 e9  |.t..%{..0.......|
+00000360  90 20 38 e3 4e 39 7c 30  13 72 63 e8 07 92 50 2e  |. 8.N9|0.rc...P.|
+00000370  f2 62 ee 16 42 c8 9c 44  b0 ab 16 03 03 00 04 0e  |.b..B..D........|
+00000380  00 00 00                                          |...|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
-00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
-00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
-00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
-00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 cc 8c  |.....(..........|
-00000060  69 a0 e9 29 fb 63 97 e7  c8 6c 78 55 54 52 0c 5a  |i..).c...lxUTR.Z|
-00000070  e7 4e bd f7 6d c6 f0 58  f1 85 25 a4 f2 ba        |.N..m..X..%...|
+00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
+00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
+00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
+00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 b0 62 c7  |....(.........b.|
+00000040  ca 6c 09 54 20 b6 eb 74  1d 10 94 80 28 59 42 13  |.l.T ..t....(YB.|
+00000050  12 72 3e 5b ed 36 ee df  17 fc 1a b3 15           |.r>[.6.......|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 f7 4a 03 ad c5  |..........(.J...|
-00000010  25 e7 e1 b9 1b 24 42 d5  09 e0 d1 3a 0d 9f 1c f7  |%....$B....:....|
-00000020  ff 50 58 a0 94 df ec db  51 b7 78 0d 37 0c 27 e2  |.PX.....Q.x.7.'.|
-00000030  eb f5 de                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 28 73 48 b3 32 5e  |..........(sH.2^|
+00000010  85 03 97 1b bb ca bc 98  95 b5 b7 1d 21 68 f2 2c  |............!h.,|
+00000020  ac 6c 7b 1c fd e1 02 46  70 b7 ba 1e f4 ec f8 44  |.l{....Fp......D|
+00000030  b7 6f f2                                          |.o.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 68 c1 51  |.............h.Q|
-00000010  af fa bd 62 55 11 ef 68  f1 1f 7d b2 16 a1 98 20  |...bU..h..}.... |
-00000020  1b d8 2d 15 03 03 00 1a  00 00 00 00 00 00 00 02  |..-.............|
-00000030  f6 3b 3e 30 66 9b 16 22  34 77 4e 7c b5 45 0a b7  |.;>0f.."4wN|.E..|
-00000040  bd 03                                             |..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 8c 2c e6  |..............,.|
+00000010  31 e3 41 ef bb 3c 22 9a  3a 30 94 c1 0e 2e c0 6e  |1.A..<".:0.....n|
+00000020  51 7d ee 15 03 03 00 1a  00 00 00 00 00 00 00 02  |Q}..............|
+00000030  5f 63 44 89 67 6f 11 03  6b 79 6e 95 30 ea b0 b8  |_cD.go..kyn.0...|
+00000040  b0 d7                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA
index 09e53fa8ab..94e118f7fe 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 64 64 5f 03 5d  |....Y...U..dd_.]|
-00000010  dd b2 e8 09 d6 a7 26 0b  52 06 1e 3b 10 36 fd a3  |......&.R..;.6..|
-00000020  32 ef 0b d9 90 a6 94 d0  f4 84 af 20 c3 56 fb 0e  |2.......... .V..|
-00000030  1c be 28 5e 5c 11 8d ca  db 7b c2 55 ff b3 b0 c6  |..(^\....{.U....|
-00000040  73 04 5c c4 d1 3b ef f2  f0 73 5b f4 c0 09 00 00  |s.\..;...s[.....|
+00000000  16 03 03 00 59 02 00 00  55 03 03 06 d8 a5 58 9e  |....Y...U.....X.|
+00000010  fd 74 7b 40 b9 db c7 55  80 57 55 1a 5a c1 e2 bb  |.t{@...U.WU.Z...|
+00000020  bc a4 8a d6 8c 0c 0a 6e  d2 30 66 20 7a 9d fa 67  |.......n.0f z..g|
+00000030  69 40 76 32 8f 62 42 ec  36 c1 f8 c8 99 5e 18 3b  |i@v2.bB.6....^.;|
+00000040  34 45 34 f9 19 1b 75 bb  d2 79 4d 2c c0 09 00 00  |4E4...u..yM,....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,24 +49,22 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 d7 0c 00  00 d3 03 00 17 41 04 c7  |*............A..|
-00000280  a9 99 b7 b8 af 34 55 af  9f 34 23 d6 ca 9b 12 3c  |.....4U..4#....<|
-00000290  c6 53 40 29 60 98 b9 eb  d6 8e b5 4b 63 7f 93 fd  |.S@)`......Kc...|
-000002a0  9d b9 6b bb 56 32 4f 7d  20 9e d8 c5 85 7b 03 75  |..k.V2O} ....{.u|
-000002b0  06 c9 dd 41 38 46 95 0b  68 b0 59 bf cf 6a c4 04  |...A8F..h.Y..j..|
-000002c0  03 00 8a 30 81 87 02 42  01 7c 38 39 37 3a 27 bc  |...0...B.|897:'.|
-000002d0  e9 31 2d df 09 0c 7f eb  63 52 92 ca 72 53 ee 0b  |.1-.....cR..rS..|
-000002e0  1f 8b d0 54 4a e5 4e 3a  55 50 d4 8d 44 bf 69 f1  |...TJ.N:UP..D.i.|
-000002f0  4b c1 8c d5 02 61 d1 e7  28 6d 02 5d e8 23 e9 7a  |K....a..(m.].#.z|
-00000300  78 de a7 12 2b 6c 58 d1  1b 53 02 41 0d 45 b6 ac  |x...+lX..S.A.E..|
-00000310  91 97 f9 95 08 4c 81 fc  15 7d 29 92 fa 1d ac 8a  |.....L...}).....|
-00000320  63 36 b6 4e 70 5b 7a 23  9d 1b 7d c7 59 64 0c 79  |c6.Np[z#..}.Yd.y|
-00000330  29 e1 b6 24 92 4a b4 8e  5a de ba 3e 72 e6 64 b5  |)..$.J..Z..>r.d.|
-00000340  1a 22 15 0b 29 a6 68 a9  04 79 11 e6 90 16 03 03  |."..).h..y......|
-00000350  00 2a 0d 00 00 26 03 01  02 40 00 1e 06 01 06 02  |.*...&...@......|
-00000360  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
-00000370  03 02 03 03 02 01 02 02  02 03 00 00 16 03 03 00  |................|
-00000380  04 0e 00 00 00                                    |.....|
+00000270  2a 16 03 03 00 b7 0c 00  00 b3 03 00 1d 20 aa 57  |*............ .W|
+00000280  9d bc 48 b3 81 25 b6 57  78 35 41 10 32 b4 96 e8  |..H..%.Wx5A.2...|
+00000290  b0 eb ab 71 be 87 bb 24  c3 05 fa fa b6 08 04 03  |...q...$........|
+000002a0  00 8b 30 81 88 02 42 01  61 87 5f 9a 58 37 f1 ff  |..0...B.a._.X7..|
+000002b0  b5 ff a7 89 fb c1 38 c9  99 00 89 6a 55 7d 2f d8  |......8....jU}/.|
+000002c0  e2 3f 55 b1 44 89 9d 30  7c 01 88 52 2b ef ba 90  |.?U.D..0|..R+...|
+000002d0  47 3f 9e 2e 22 83 1e 89  77 7a 81 c2 d0 fd 09 4b  |G?.."...wz.....K|
+000002e0  77 1e 9b 3b d1 95 b4 fb  ad 02 42 01 7c b4 80 5a  |w..;......B.|..Z|
+000002f0  13 e8 f7 00 42 93 f5 5b  be 61 fc 60 e5 3e 3c 04  |....B..[.a.`.><.|
+00000300  53 c9 5c 21 9c 43 0f 0c  a8 56 be 23 97 1f d7 cf  |S.\!.C...V.#....|
+00000310  e9 88 0f cf 8b 1d cf 45  d2 f2 e9 1d ab 64 af 72  |.......E.....d.r|
+00000320  e2 11 f9 d7 00 80 7a 9d  4d c3 ed fe 69 16 03 03  |......z.M...i...|
+00000330  00 2a 0d 00 00 26 03 01  02 40 00 1e 06 01 06 02  |.*...&...@......|
+00000340  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
+00000350  03 02 03 03 02 01 02 02  02 03 00 00 16 03 03 00  |................|
+00000360  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
 00000000  16 03 03 02 0a 0b 00 02  06 00 02 03 00 02 00 30  |...............0|
 00000010  82 01 fc 30 82 01 5e 02  09 00 9a 30 84 6c 26 35  |...0..^....0.l&5|
@@ -100,36 +99,34 @@
 000001e0  be e8 91 b3 da 1a f5 5d  a3 23 f5 26 8b 45 70 8d  |.......].#.&.Ep.|
 000001f0  65 62 9b 7e 01 99 3d 18  f6 10 9a 38 61 9b 2e 57  |eb.~..=....8a..W|
 00000200  e4 fa cc b1 8a ce e2 23  a0 87 f0 e1 67 51 eb 16  |.......#....gQ..|
-00000210  03 03 00 46 10 00 00 42  41 04 1e 18 37 ef 0d 19  |...F...BA...7...|
-00000220  51 88 35 75 71 b5 e5 54  5b 12 2e 8f 09 67 fd a7  |Q.5uq..T[....g..|
-00000230  24 20 3e b2 56 1c ce 97  28 5e f8 2b 2d 4f 9e f1  |$ >.V...(^.+-O..|
-00000240  07 9f 6c 4b 5b 83 56 e2  32 42 e9 58 b6 d7 49 a6  |..lK[.V.2B.X..I.|
-00000250  b5 68 1a 41 03 56 6b dc  5a 89 16 03 03 00 92 0f  |.h.A.Vk.Z.......|
-00000260  00 00 8e 05 03 00 8a 30  81 87 02 41 1b 43 f7 73  |.......0...A.C.s|
-00000270  e1 be a7 4a 35 78 2c a2  e1 44 e0 61 3f ea 46 0b  |...J5x,..D.a?.F.|
-00000280  b7 d2 63 4e a6 3b 09 77  93 f3 25 45 27 b0 dc 19  |..cN.;.w..%E'...|
-00000290  21 68 4a 74 bc 5b 9c c0  b0 d6 3f cb 99 91 0f 39  |!hJt.[....?....9|
-000002a0  58 0a f6 cd 41 7f 51 70  9e 4c 49 9f 6f 02 42 00  |X...A.Qp.LI.o.B.|
-000002b0  82 7e e2 38 b5 92 c8 3a  48 97 49 9f 75 ae c6 d5  |.~.8...:H.I.u...|
-000002c0  dc 8f 2c 81 7a 92 8c a0  01 93 98 30 ca b3 af da  |..,.z......0....|
-000002d0  4e 0d 7b a8 fb a9 a4 62  c7 29 4b 0b 93 57 e8 b7  |N.{....b.)K..W..|
-000002e0  cb bf 3a c7 31 6b 35 02  a1 c9 01 60 bb 51 fa 52  |..:.1k5....`.Q.R|
-000002f0  f9 14 03 03 00 01 01 16  03 03 00 40 00 00 00 00  |...........@....|
-00000300  00 00 00 00 00 00 00 00  00 00 00 00 4b 54 84 bf  |............KT..|
-00000310  47 6f 0d 7b 08 4b e4 4c  b9 6f 3b 9b 3a 1c 80 25  |Go.{.K.L.o;.:..%|
-00000320  d5 68 7c 9c d9 db 22 69  17 8a 54 17 8a d7 40 b9  |.h|..."i..T...@.|
-00000330  32 d0 d3 a8 a5 1c e9 3d  da e6 24 44              |2......=..$D|
+00000210  03 03 00 25 10 00 00 21  20 2f e5 7d a3 47 cd 62  |...%...! /.}.G.b|
+00000220  43 15 28 da ac 5f bb 29  07 30 ff f6 84 af c4 cf  |C.(.._.).0......|
+00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 03 00 93 0f 00  |...._X.;t.......|
+00000240  00 8f 05 03 00 8b 30 81  88 02 42 01 af 55 e0 ee  |......0...B..U..|
+00000250  49 f4 29 a2 53 02 b0 7c  82 de 7d 0b 18 f9 be 28  |I.).S..|..}....(|
+00000260  63 8d d4 e5 a7 5f 3e 0c  e8 77 4d 67 5f 1b a1 55  |c...._>..wMg_..U|
+00000270  d1 f2 02 34 96 08 4c 06  40 9c 08 60 37 38 9b 90  |...4..L.@..`78..|
+00000280  a8 81 9d 70 b9 3d be 67  e8 25 51 07 52 02 42 00  |...p.=.g.%Q.R.B.|
+00000290  80 8b 8a 47 d2 7e df b8  2b fc 75 4c ce d7 8e 3c  |...G.~..+.uL...<|
+000002a0  fa a0 59 d2 b2 5a 89 69  25 24 81 ec c3 66 af 52  |..Y..Z.i%$...f.R|
+000002b0  83 76 f6 ee 18 9f 2e fa  78 76 b3 ef d0 fe 67 38  |.v......xv....g8|
+000002c0  f1 b2 3e 20 80 78 20 9e  3d ea fa 7a 92 f8 a8 ed  |..> .x .=..z....|
+000002d0  5e 14 03 03 00 01 01 16  03 03 00 40 00 00 00 00  |^..........@....|
+000002e0  00 00 00 00 00 00 00 00  00 00 00 00 b5 f1 10 d6  |................|
+000002f0  73 66 b5 f6 f3 ab 36 5b  f2 80 6a 1c 0b da 18 fc  |sf....6[..j.....|
+00000300  ac 20 c2 55 66 ae 25 f4  62 e1 16 2c 49 a0 e9 aa  |. .Uf.%.b..,I...|
+00000310  1f 08 06 f3 72 06 93 cd  64 46 06 aa              |....r...dF..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 dd cb 8d c7 40  |..........@....@|
-00000010  d6 f0 0c 37 3b ed d3 ff  b7 6e f7 ba fb 66 bd 0c  |...7;....n...f..|
-00000020  d2 c5 d9 50 0e 3a ed 75  98 fc 97 4e 29 d5 57 8d  |...P.:.u...N).W.|
-00000030  cb 76 7c 24 d2 0a b4 de  4f ab 36 85 96 e9 e0 f1  |.v|$....O.6.....|
-00000040  f2 c5 3d 0e b2 fe 79 13  7e 07 a1                 |..=...y.~..|
+00000000  14 03 03 00 01 01 16 03  03 00 40 9e 01 51 a4 a0  |..........@..Q..|
+00000010  37 31 94 d1 2f e3 0d c6  a4 99 bb 3e 70 9f e8 fe  |71../......>p...|
+00000020  38 73 ba c5 35 4e b9 5d  dd 5a ec e9 41 c1 f4 f6  |8s..5N.].Z..A...|
+00000030  5f 66 3d 27 d2 15 fc c9  0f 22 95 03 7b 1f a5 ff  |_f='....."..{...|
+00000040  43 f1 73 64 99 a2 eb fa  e6 e9 ee                 |C.sd.......|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 6b 68 4c  8a e3 df 9b 61 66 a4 01  |.....khL....af..|
-00000020  63 0c b1 0f 2b e4 2c 81  48 74 82 db e6 35 e2 25  |c...+.,.Ht...5.%|
-00000030  2c 72 a5 75 5d 15 03 03  00 30 00 00 00 00 00 00  |,r.u]....0......|
-00000040  00 00 00 00 00 00 00 00  00 00 83 87 5a 1d fe 25  |............Z..%|
-00000050  d0 42 46 0e 43 11 bf 9e  83 eb 94 bb 92 68 ea 51  |.BF.C........h.Q|
-00000060  51 2d 7e 48 f8 a6 46 15  65 cd                    |Q-~H..F.e.|
+00000010  00 00 00 00 00 ca 47 da  6e 04 55 13 d0 01 13 e4  |......G.n.U.....|
+00000020  18 02 64 9c 1f 3c 3f 4f  5b ba e1 87 20 c5 a2 c4  |..d..<?O[... ...|
+00000030  f1 70 f6 84 6c 15 03 03  00 30 00 00 00 00 00 00  |.p..l....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 2e 11 23 3c e2 a4  |............#<..|
+00000050  18 f3 91 73 57 5f 6c 10  3b cf 9e a2 17 1a 76 d5  |...sW_l.;.....v.|
+00000060  e6 4a 86 b1 42 d5 02 dc  5a 2d                    |.J..B...Z-|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA
index 07601f038c..89426a602d 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 47 51 31 ee d9  |....Y...U..GQ1..|
-00000010  77 ae 4c 37 cc 0c 65 22  09 63 a0 65 bd 13 46 cf  |w.L7..e".c.e..F.|
-00000020  a2 87 3e 04 75 be 32 80  8e 3f 15 20 4d 0a 0d ae  |..>.u.2..?. M...|
-00000030  e5 67 84 b5 5d 3b 08 51  4a 89 c8 e9 ae 9e 16 7b  |.g..];.QJ......{|
-00000040  3e 0a 7c 3c f5 a2 a7 29  45 cb 8b 02 c0 2f 00 00  |>.|<...)E..../..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 04 3b 69 ac b4  |....Y...U...;i..|
+00000010  14 b1 67 6d 1e 99 ab f5  57 c2 a9 99 33 8c 9d 31  |..gm....W...3..1|
+00000020  26 ec 17 43 1a b2 62 36  a0 c3 bd 20 52 d5 07 92  |&..C..b6... R...|
+00000030  e5 d8 a6 2f a5 8d e6 df  b1 90 69 7a 94 2d d7 73  |.../......iz.-.s|
+00000040  cb da 29 ee 6f 13 e5 2d  7f 3a 0e cd c0 2f 00 00  |..).o..-.:.../..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,23 +54,21 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  cd 0c 00 00 c9 03 00 17  41 04 b4 86 33 cb c3 2f  |........A...3../|
-000002d0  37 f0 7c d9 2e f9 7e af  3d db e7 ef 56 03 7e 7c  |7.|...~.=...V.~||
-000002e0  ac 8a 40 8b 7f bc 6f 6f  0a 47 4c 8c 8c 91 ce 9b  |..@...oo.GL.....|
-000002f0  8f a3 2d bb db 46 3b b1  ab 1e 49 4e 11 d4 23 3d  |..-..F;...IN..#=|
-00000300  4b a9 16 0e aa 32 4e 91  f4 8e 04 01 00 80 0a 3a  |K....2N........:|
-00000310  da 17 ac 91 8b 43 8e 51  39 a0 c0 42 32 e7 77 85  |.....C.Q9..B2.w.|
-00000320  73 82 db d5 8b cc e5 b8  94 89 e8 7c 47 5d 88 ea  |s..........|G]..|
-00000330  04 76 a1 88 e5 5f e1 a7  45 d2 46 b9 26 be 9f 52  |.v..._..E.F.&..R|
-00000340  7f c3 11 a5 c7 65 8c 92  29 d0 e9 31 97 a5 a6 2a  |.....e..)..1...*|
-00000350  e0 a9 97 ed f3 88 88 59  66 dc 85 e6 5b fe 33 33  |.......Yf...[.33|
-00000360  f1 80 b4 11 01 da 07 15  7b 9f e3 e0 cb ab d9 53  |........{......S|
-00000370  ed 59 7f 88 f0 5d d8 06  b6 c4 87 75 ee df b1 39  |.Y...].....u...9|
-00000380  32 7d 62 b5 4c c5 35 e7  c1 ae db 30 e3 ce 16 03  |2}b.L.5....0....|
-00000390  03 00 2a 0d 00 00 26 03  01 02 40 00 1e 06 01 06  |..*...&...@.....|
-000003a0  02 06 03 05 01 05 02 05  03 04 01 04 02 04 03 03  |................|
-000003b0  01 03 02 03 03 02 01 02  02 02 03 00 00 16 03 03  |................|
-000003c0  00 04 0e 00 00 00                                 |......|
+000002c0  ac 0c 00 00 a8 03 00 1d  20 d7 5f 84 86 e0 7c 20  |........ ._...| |
+000002d0  c5 97 78 c1 40 3f 64 2e  ae 06 51 c3 6f d3 86 a2  |..x.@?d...Q.o...|
+000002e0  03 d3 f8 75 ed 20 28 6b  26 04 01 00 80 c3 8b b6  |...u. (k&.......|
+000002f0  81 65 e3 d2 98 33 78 c8  d4 d4 6a 80 3b cc 26 ab  |.e...3x...j.;.&.|
+00000300  7a 2f d0 0e 02 57 0d 34  30 78 a1 7b d4 df e1 da  |z/...W.40x.{....|
+00000310  7f 8e 04 65 45 8d b9 ad  04 13 84 e2 81 da e0 b6  |...eE...........|
+00000320  20 07 02 f9 e5 78 5e d4  0d 74 f5 d2 98 a8 9b d8  | ....x^..t......|
+00000330  f4 f3 7b 2f 8f 58 58 77  b6 db 4d d0 94 53 df 5a  |..{/.XXw..M..S.Z|
+00000340  61 43 2d a7 64 ec b1 8f  48 80 b4 fd 6c 05 f6 84  |aC-.d...H...l...|
+00000350  b5 d2 0d 30 5d 2f 9d 9f  8f 14 d0 e1 70 64 0b 86  |...0]/......pd..|
+00000360  c3 26 7d b2 b2 f5 9f 9e  de 6e 92 47 76 16 03 03  |.&}......n.Gv...|
+00000370  00 2a 0d 00 00 26 03 01  02 40 00 1e 06 01 06 02  |.*...&...@......|
+00000380  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
+00000390  03 02 03 03 02 01 02 02  02 03 00 00 16 03 03 00  |................|
+000003a0  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
 00000000  16 03 03 02 0a 0b 00 02  06 00 02 03 00 02 00 30  |...............0|
 00000010  82 01 fc 30 82 01 5e 02  09 00 9a 30 84 6c 26 35  |...0..^....0.l&5|
@@ -104,32 +103,30 @@
 000001e0  be e8 91 b3 da 1a f5 5d  a3 23 f5 26 8b 45 70 8d  |.......].#.&.Ep.|
 000001f0  65 62 9b 7e 01 99 3d 18  f6 10 9a 38 61 9b 2e 57  |eb.~..=....8a..W|
 00000200  e4 fa cc b1 8a ce e2 23  a0 87 f0 e1 67 51 eb 16  |.......#....gQ..|
-00000210  03 03 00 46 10 00 00 42  41 04 1e 18 37 ef 0d 19  |...F...BA...7...|
-00000220  51 88 35 75 71 b5 e5 54  5b 12 2e 8f 09 67 fd a7  |Q.5uq..T[....g..|
-00000230  24 20 3e b2 56 1c ce 97  28 5e f8 2b 2d 4f 9e f1  |$ >.V...(^.+-O..|
-00000240  07 9f 6c 4b 5b 83 56 e2  32 42 e9 58 b6 d7 49 a6  |..lK[.V.2B.X..I.|
-00000250  b5 68 1a 41 03 56 6b dc  5a 89 16 03 03 00 92 0f  |.h.A.Vk.Z.......|
-00000260  00 00 8e 05 03 00 8a 30  81 87 02 41 78 65 c2 1f  |.......0...Axe..|
-00000270  7f 35 30 79 47 e4 78 f5  92 ed fc ae 83 3e 8a 98  |.50yG.x......>..|
-00000280  7c d2 63 f2 e4 40 e2 80  d3 2b b3 9a f4 39 1e ec  ||.c..@...+...9..|
-00000290  94 9f 7f 62 99 76 62 d5  63 66 66 44 56 d5 32 d5  |...b.vb.cffDV.2.|
-000002a0  fa ee e7 b3 2e 1a af 7d  3d dc 4f 5d cf 02 42 00  |.......}=.O]..B.|
-000002b0  f8 89 d3 86 c8 6d 90 e5  2c 75 34 5c de 21 d5 b7  |.....m..,u4\.!..|
-000002c0  86 eb 42 3f 23 71 f5 c3  c4 d9 5a db cc fa 1e e3  |..B?#q....Z.....|
-000002d0  4a e8 2c 36 e8 43 58 2f  85 d5 bb 12 c2 12 d0 aa  |J.,6.CX/........|
-000002e0  dd 2e 30 ca 7d 32 d4 c9  08 68 de 15 79 17 2e 6f  |..0.}2...h..y..o|
-000002f0  73 14 03 03 00 01 01 16  03 03 00 28 00 00 00 00  |s..........(....|
-00000300  00 00 00 00 ea 79 14 38  d6 93 fd 01 1b 71 f9 2e  |.....y.8.....q..|
-00000310  67 23 0c 52 26 5b 7c 63  6e 6d a2 7e 40 62 88 31  |g#.R&[|cnm.~@b.1|
-00000320  5c cd 05 4a                                       |\..J|
+00000210  03 03 00 25 10 00 00 21  20 2f e5 7d a3 47 cd 62  |...%...! /.}.G.b|
+00000220  43 15 28 da ac 5f bb 29  07 30 ff f6 84 af c4 cf  |C.(.._.).0......|
+00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 03 00 93 0f 00  |...._X.;t.......|
+00000240  00 8f 05 03 00 8b 30 81  88 02 42 01 6d 16 77 ad  |......0...B.m.w.|
+00000250  3f 82 a2 df 03 16 35 64  a0 19 e9 e1 dd 21 f3 dc  |?.....5d.....!..|
+00000260  a4 c8 98 ae 2c 28 02 cc  85 c3 f9 fe eb 60 6f ac  |....,(.......`o.|
+00000270  b8 03 25 2e 48 fb 7c 8b  4a 6e b3 5c 4d 83 77 a1  |..%.H.|.Jn.\M.w.|
+00000280  d6 ed c3 df 8b 16 09 81  3d 81 a7 e2 6d 02 42 01  |........=...m.B.|
+00000290  df a2 14 a8 e5 4b 02 63  1e 3a a6 70 18 75 78 d9  |.....K.c.:.p.ux.|
+000002a0  ae eb 89 35 09 7b 56 9c  1e 61 82 26 6e c1 f5 02  |...5.{V..a.&n...|
+000002b0  5e 7c 71 53 5b 3a a2 17  5f 58 38 86 f5 32 17 40  |^|qS[:.._X8..2.@|
+000002c0  e8 b6 04 61 ee 0a df c0  ee d1 e0 16 aa 88 34 f4  |...a..........4.|
+000002d0  ad 14 03 03 00 01 01 16  03 03 00 28 00 00 00 00  |...........(....|
+000002e0  00 00 00 00 4b b7 1d c9  55 aa 66 46 df 94 39 e9  |....K...U.fF..9.|
+000002f0  96 9e 89 e0 e6 f3 f2 11  0b f2 9a 71 25 e2 2f aa  |...........q%./.|
+00000300  8a 77 a8 7b                                       |.w.{|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 a4 a0 92 38 ea  |..........(...8.|
-00000010  01 64 36 a4 83 8b a4 77  d2 b0 fd 84 89 41 33 6f  |.d6....w.....A3o|
-00000020  4e c9 cd c0 30 1f 9d 43  3d a1 d5 f6 48 5e 07 e5  |N...0..C=...H^..|
-00000030  90 64 59                                          |.dY|
+00000000  14 03 03 00 01 01 16 03  03 00 28 11 75 ff 06 73  |..........(.u..s|
+00000010  15 0d 08 4b e8 0b 91 56  b0 bb 28 2b 5d df 73 21  |...K...V..(+].s!|
+00000020  16 99 52 30 56 e9 fb a2  9f c6 8b 3b 38 be 32 96  |..R0V......;8.2.|
+00000030  3c 8d cb                                          |<..|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 c4 4b 2d  |..............K-|
-00000010  31 e5 1a ed 8c 6d 44 74  d5 22 60 8a c3 91 7d 20  |1....mDt."`...} |
-00000020  c0 47 22 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.G".............|
-00000030  df d5 1d 8c b4 8b 2a 42  b5 bd 0a 0d 46 79 90 a7  |......*B....Fy..|
-00000040  39 79                                             |9y|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 8d b0 1a  |................|
+00000010  28 53 1d 8f df ad 0c f4  29 b1 89 01 6d f4 f2 7f  |(S......)...m...|
+00000020  29 88 4c 15 03 03 00 1a  00 00 00 00 00 00 00 02  |).L.............|
+00000030  6b b0 6f ca 9a 62 19 e9  a1 37 27 dc 3c 00 b8 03  |k.o..b...7'.<...|
+00000040  4c b4                                             |L.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384 b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384
index f18e7f7b8c..839334b8b5 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 e5 6a 08 9d 28  |....Y...U...j..(|
-00000010  49 64 df 4d bd 0e b8 d3  0d af d9 20 78 4a a0 b8  |Id.M....... xJ..|
-00000020  0d 12 83 5a 9a 9f 73 fe  53 d6 75 20 d5 6f df 86  |...Z..s.S.u .o..|
-00000030  33 7a 02 8c cd f9 a4 8c  ff 21 89 29 a4 ee 54 81  |3z.......!.)..T.|
-00000040  fc 52 99 f5 0f 1e d3 a5  f9 fe 64 d1 c0 30 00 00  |.R........d..0..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 e2 04 c7 2b 8b  |....Y...U.....+.|
+00000010  3e 9b 44 e7 fa 11 ea 60  b5 e9 c1 94 53 8e 28 49  |>.D....`....S.(I|
+00000020  cc 2a 91 8b 81 3a c0 6b  e6 81 8c 20 6a ea 72 bb  |.*...:.k... j.r.|
+00000030  44 d3 54 e5 f7 96 02 69  85 8d 76 97 5c 14 df f6  |D.T....i..v.\...|
+00000040  64 42 49 fe f3 2a a6 d4  ef 65 e0 00 c0 30 00 00  |dBI..*...e...0..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,23 +54,21 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  cd 0c 00 00 c9 03 00 17  41 04 af 8b 15 ee fc b2  |........A.......|
-000002d0  95 b3 38 67 05 c0 3f fd  a4 1e 25 e1 58 a2 35 27  |..8g..?...%.X.5'|
-000002e0  55 e1 05 01 8d 77 8b 77  b6 d8 23 1f 79 e8 66 cc  |U....w.w..#.y.f.|
-000002f0  e0 cd 01 1f 37 ab ad c6  dd ae 41 f9 2b 2d 77 b9  |....7.....A.+-w.|
-00000300  28 34 5d 27 5d 7a fe 32  86 e4 04 01 00 80 d0 ba  |(4]']z.2........|
-00000310  8b c2 67 5e 8f 83 8a 32  34 56 4d b7 83 4c 6a 85  |..g^...24VM..Lj.|
-00000320  44 24 e5 21 a6 f2 a2 f3  4e 59 bc 86 d9 ed d0 a6  |D$.!....NY......|
-00000330  ed 48 ac 3c c4 4b 0c c8  10 34 b0 1a 10 db 7c a6  |.H.<.K...4....|.|
-00000340  76 26 15 06 ee 01 22 2f  81 95 3b cd c6 3f fa 24  |v&...."/..;..?.$|
-00000350  59 f6 da 4b e1 7d 5e f0  f7 96 cc 67 73 74 c0 76  |Y..K.}^....gst.v|
-00000360  50 50 74 87 33 f2 92 66  8f 87 de 5b e2 a4 f8 c4  |PPt.3..f...[....|
-00000370  60 c5 ac a9 86 93 fc 81  73 d6 77 da c8 7a db 71  |`.......s.w..z.q|
-00000380  61 2c cf ea 23 85 89 70  f4 f4 5a c9 c9 bc 16 03  |a,..#..p..Z.....|
-00000390  03 00 2a 0d 00 00 26 03  01 02 40 00 1e 06 01 06  |..*...&...@.....|
-000003a0  02 06 03 05 01 05 02 05  03 04 01 04 02 04 03 03  |................|
-000003b0  01 03 02 03 03 02 01 02  02 02 03 00 00 16 03 03  |................|
-000003c0  00 04 0e 00 00 00                                 |......|
+000002c0  ac 0c 00 00 a8 03 00 1d  20 92 df c1 68 51 1f 9a  |........ ...hQ..|
+000002d0  84 6d e0 69 15 15 53 fc  0d f4 cf 05 c6 b9 ad cb  |.m.i..S.........|
+000002e0  68 a8 7d f9 af 59 53 9e  1e 04 01 00 80 97 26 59  |h.}..YS.......&Y|
+000002f0  c6 ad f8 fd 9c 7c 6e 79  fc cc f5 3a 11 f1 ac aa  |.....|ny...:....|
+00000300  48 a8 92 25 f7 d7 e5 a0  0d e9 da e2 ff ea d8 a0  |H..%............|
+00000310  df 90 3f 53 4c a5 df 77  43 ff d7 95 80 f2 40 c1  |..?SL..wC.....@.|
+00000320  4d 12 09 f6 ea 0b c7 19  5d b2 b9 67 60 13 2f cc  |M.......]..g`./.|
+00000330  cb 16 ae e0 ae c5 b0 c7  8a 32 5c 31 e3 cf 85 22  |.........2\1..."|
+00000340  16 76 f3 0a 7d 84 98 f7  bc 63 56 a9 50 ae 55 a8  |.v..}....cV.P.U.|
+00000350  63 a5 93 a1 3a 7f bd 30  e4 90 d1 29 d2 0f a1 ad  |c...:..0...)....|
+00000360  c4 e8 11 05 da 47 3e 8f  16 80 cd 8b 9e 16 03 03  |.....G>.........|
+00000370  00 2a 0d 00 00 26 03 01  02 40 00 1e 06 01 06 02  |.*...&...@......|
+00000380  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
+00000390  03 02 03 03 02 01 02 02  02 03 00 00 16 03 03 00  |................|
+000003a0  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
 00000000  16 03 03 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
 00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
@@ -103,31 +102,29 @@
 000001d0  ac 11 b1 28 56 be 1d cd  61 62 84 09 bf d6 80 c6  |...(V...ab......|
 000001e0  45 8d 82 2c b4 d8 83 9b  db c9 22 b7 2a 12 11 7b  |E..,......".*..{|
 000001f0  fa 02 3b c1 c9 ff ea c9  9d a8 49 d3 95 d7 d5 0e  |..;.......I.....|
-00000200  e5 35 16 03 03 00 46 10  00 00 42 41 04 1e 18 37  |.5....F...BA...7|
-00000210  ef 0d 19 51 88 35 75 71  b5 e5 54 5b 12 2e 8f 09  |...Q.5uq..T[....|
-00000220  67 fd a7 24 20 3e b2 56  1c ce 97 28 5e f8 2b 2d  |g..$ >.V...(^.+-|
-00000230  4f 9e f1 07 9f 6c 4b 5b  83 56 e2 32 42 e9 58 b6  |O....lK[.V.2B.X.|
-00000240  d7 49 a6 b5 68 1a 41 03  56 6b dc 5a 89 16 03 03  |.I..h.A.Vk.Z....|
-00000250  00 88 0f 00 00 84 05 01  00 80 2d 1c c8 23 f4 9e  |..........-..#..|
-00000260  ff fe 30 db 7d 25 41 74  5b 3b e1 f7 c3 92 eb 12  |..0.}%At[;......|
-00000270  46 0d f3 3b 4f ff 9c ed  d6 f5 4e 3f 58 ad ba 02  |F..;O.....N?X...|
-00000280  0b 44 66 94 78 83 a0 ee  0f 05 ec fd f7 4d 97 52  |.Df.x........M.R|
-00000290  6c ca 54 28 3c e2 77 92  d5 a3 0d 67 93 cf a9 4c  |l.T(<.w....g...L|
-000002a0  c6 03 4a c9 cd 22 bb d5  5b 8c 85 60 72 ef f3 2a  |..J.."..[..`r..*|
-000002b0  ef 6e 74 77 98 6e 19 c0  f0 d4 fa bf ab 36 90 30  |.ntw.n.......6.0|
-000002c0  16 63 6b af 74 e4 94 46  6d eb b0 5e fa ff e8 73  |.ck.t..Fm..^...s|
-000002d0  05 3f f8 bb f3 be 74 d0  d4 4a 14 03 03 00 01 01  |.?....t..J......|
-000002e0  16 03 03 00 28 00 00 00  00 00 00 00 00 02 e2 55  |....(..........U|
-000002f0  ab d8 a2 bf 4f 5f 9a 66  ee 0a 94 79 7c 63 04 c0  |....O_.f...y|c..|
-00000300  d6 57 c2 c1 d3 0f 0a d5  1e 7d 23 fa 25           |.W.......}#.%|
+00000200  e5 35 16 03 03 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
+00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
+00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 03 00  |......._X.;t....|
+00000230  88 0f 00 00 84 05 01 00  80 2c f5 ed 80 3e 10 d8  |.........,...>..|
+00000240  1d 7f c4 1b 1a 16 36 0b  07 ec ad 68 4f dc b3 56  |......6....hO..V|
+00000250  67 c9 21 ba 71 a7 2f b0  2b 7b 45 69 30 88 ec 8c  |g.!.q./.+{Ei0...|
+00000260  aa 12 50 3b 07 ea 94 55  42 74 5e bf 6b 57 d0 7c  |..P;...UBt^.kW.||
+00000270  bb 44 6e e2 1c 7a 5f e1  dc 3a cc 38 d4 3d 0b 1e  |.Dn..z_..:.8.=..|
+00000280  9a ed 82 dc 26 45 48 a2  c1 2a 9e 66 da f2 0b b2  |....&EH..*.f....|
+00000290  eb b7 4d 1a 78 5b d4 0d  c1 fa 02 60 25 20 9b a4  |..M.x[.....`% ..|
+000002a0  34 03 5c b9 4c 7a 49 78  43 8b 0e d4 c1 bd 82 b3  |4.\.LzIxC.......|
+000002b0  12 5a bf 09 a3 c5 30 a2  f7 14 03 03 00 01 01 16  |.Z....0.........|
+000002c0  03 03 00 28 00 00 00 00  00 00 00 00 9f 75 ff e1  |...(.........u..|
+000002d0  e9 59 e8 7b b8 7f 4e 4f  9a a4 89 4d 75 3d bd a1  |.Y.{..NO...Mu=..|
+000002e0  92 df c8 71 fe c3 32 f5  96 9c 69 ef              |...q..2...i.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 17 86 07 f3 42  |..........(....B|
-00000010  10 db 93 d3 46 35 51 1d  7d 20 ec fa 37 c7 25 15  |....F5Q.} ..7.%.|
-00000020  e1 99 46 a0 2f a1 b8 4a  36 af 1d aa d3 ba 70 a2  |..F./..J6.....p.|
-00000030  4e bc 8b                                          |N..|
+00000000  14 03 03 00 01 01 16 03  03 00 28 ef fc fe 76 da  |..........(...v.|
+00000010  6e 36 8d db 71 67 10 68  80 6c 6e 05 68 f1 0f e8  |n6..qg.h.ln.h...|
+00000020  74 47 ab 40 78 28 75 81  b3 92 70 ca 08 c7 3b c9  |tG.@x(u...p...;.|
+00000030  e7 b9 c1                                          |...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 ba 98 6c  |...............l|
-00000010  77 50 2f f1 8c 09 ed 9f  74 cb bc 4a e4 57 5e b5  |wP/.....t..J.W^.|
-00000020  93 16 42 15 03 03 00 1a  00 00 00 00 00 00 00 02  |..B.............|
-00000030  ee 1b 6a 8a 33 31 f2 4b  64 f8 1d 0e a5 7d c4 43  |..j.31.Kd....}.C|
-00000040  be 3e                                             |.>|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 f3 2e 79  |...............y|
+00000010  00 81 81 2f 95 2c 3f 47  22 13 53 c1 fc 2a 7c 08  |.../.,?G".S..*|.|
+00000020  8a cc a8 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
+00000030  fa d6 18 b5 54 9d ea eb  d6 16 97 64 18 25 89 48  |....T......d.%.H|
+00000040  b8 8d                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA
index 2a39bc5221..a61dccc246 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 e7 ed 8d 74 39  |....Y...U.....t9|
-00000010  b5 4e 79 35 85 b5 46 22  fc 7f 2d 2a 28 f3 98 db  |.Ny5..F"..-*(...|
-00000020  69 76 44 b2 0b ac df 25  1c 59 da 20 0c dd a5 75  |ivD....%.Y. ...u|
-00000030  50 94 02 87 20 42 1e c8  42 55 32 d7 e3 6b 00 e9  |P... B..BU2..k..|
-00000040  b4 57 ff ad 5b 9d e5 4e  f8 8b 37 d4 c0 09 00 00  |.W..[..N..7.....|
+00000000  16 03 03 00 59 02 00 00  55 03 03 b5 1b a7 76 84  |....Y...U.....v.|
+00000010  6b 76 c7 d4 db 65 6e e7  f8 df 4e cb 27 33 77 e3  |kv...en...N.'3w.|
+00000020  15 b3 47 eb 35 c8 11 80  d9 33 6f 20 a4 6c b2 e6  |..G.5....3o .l..|
+00000030  95 77 72 69 11 59 10 8b  ee 75 a3 68 f8 87 36 31  |.wri.Y...u.h..61|
+00000040  19 09 80 27 e4 63 cf 93  4f 85 82 f5 c0 09 00 00  |...'.c..O.......|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,24 +49,22 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 d7 0c 00  00 d3 03 00 17 41 04 31  |*............A.1|
-00000280  a3 27 68 39 f0 49 74 4b  bf a9 65 19 0b 33 41 96  |.'h9.ItK..e..3A.|
-00000290  b3 41 d9 61 d5 b1 8a b6  2d d3 46 32 63 a6 13 19  |.A.a....-.F2c...|
-000002a0  25 04 78 85 62 73 2a 94  32 9d 75 bd f2 f8 44 d7  |%.x.bs*.2.u...D.|
-000002b0  f1 f2 dd ce ca 97 b6 6e  10 79 a6 cd 4a f0 73 04  |.......n.y..J.s.|
-000002c0  03 00 8a 30 81 87 02 42  00 e4 2b 1c c4 56 74 bd  |...0...B..+..Vt.|
-000002d0  fb 41 8a c7 f0 6a 17 c1  8a 1c 0e 48 6f 65 1f d9  |.A...j.....Hoe..|
-000002e0  cd a6 9c ed f2 25 45 d3  eb 75 74 c0 0f 38 3d e7  |.....%E..ut..8=.|
-000002f0  63 fe 46 95 27 78 c8 d1  b0 82 5e 9f ac 3e f1 9b  |c.F.'x....^..>..|
-00000300  37 b6 5c dc e1 3b 63 6c  54 b7 02 41 5c e8 d5 4c  |7.\..;clT..A\..L|
-00000310  bc 65 e5 57 c1 f8 f4 d0  2f 8d 63 76 3c 87 e6 a5  |.e.W..../.cv<...|
-00000320  3e 10 ca 4a 9f 87 19 e0  48 9f 0c a2 e7 b1 16 b6  |>..J....H.......|
-00000330  a9 f8 4c c1 fc a8 29 75  11 d2 de 7a d9 70 8e 3a  |..L...)u...z.p.:|
-00000340  6e 29 5c f6 9c 86 1e 73  d0 2e 4b 1f f2 16 03 03  |n)\....s..K.....|
-00000350  00 2a 0d 00 00 26 03 01  02 40 00 1e 06 01 06 02  |.*...&...@......|
-00000360  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
-00000370  03 02 03 03 02 01 02 02  02 03 00 00 16 03 03 00  |................|
-00000380  04 0e 00 00 00                                    |.....|
+00000270  2a 16 03 03 00 b7 0c 00  00 b3 03 00 1d 20 20 fd  |*............  .|
+00000280  ab d5 d0 a5 9d bd ff 8f  03 f1 45 8d 64 04 50 1c  |..........E.d.P.|
+00000290  72 e7 29 36 af 91 39 d8  10 3d e8 6f 7d 17 04 03  |r.)6..9..=.o}...|
+000002a0  00 8b 30 81 88 02 42 00  ca bc 74 65 5b 16 c0 66  |..0...B...te[..f|
+000002b0  01 73 bb 25 6f 14 1b 91  06 b4 07 a9 b1 9e 89 77  |.s.%o..........w|
+000002c0  7f 9f 00 85 be 66 96 58  63 c5 8b c5 84 2c 16 04  |.....f.Xc....,..|
+000002d0  7f 78 0b 48 2b 4c 41 50  6f d3 e4 0d 0c e9 42 39  |.x.H+LAPo.....B9|
+000002e0  07 2f fc d4 53 43 9f 82  52 02 42 01 17 01 a4 8b  |./..SC..R.B.....|
+000002f0  bf af 45 8a 92 fe 88 f5  00 7e 29 d1 9d 8b d4 a9  |..E......~).....|
+00000300  7c 07 50 74 44 7d 6d 3a  ac ee ca 14 18 a7 dc 54  ||.PtD}m:.......T|
+00000310  38 58 be fd 00 75 53 26  cd 8c a9 cf a0 ce d7 97  |8X...uS&........|
+00000320  d9 20 1d cf 3c 27 0c 0d  20 62 33 d5 e8 16 03 03  |. ..<'.. b3.....|
+00000330  00 2a 0d 00 00 26 03 01  02 40 00 1e 06 01 06 02  |.*...&...@......|
+00000340  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
+00000350  03 02 03 03 02 01 02 02  02 03 00 00 16 03 03 00  |................|
+00000360  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
 00000000  16 03 03 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
 00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
@@ -99,36 +98,34 @@
 000001d0  ac 11 b1 28 56 be 1d cd  61 62 84 09 bf d6 80 c6  |...(V...ab......|
 000001e0  45 8d 82 2c b4 d8 83 9b  db c9 22 b7 2a 12 11 7b  |E..,......".*..{|
 000001f0  fa 02 3b c1 c9 ff ea c9  9d a8 49 d3 95 d7 d5 0e  |..;.......I.....|
-00000200  e5 35 16 03 03 00 46 10  00 00 42 41 04 1e 18 37  |.5....F...BA...7|
-00000210  ef 0d 19 51 88 35 75 71  b5 e5 54 5b 12 2e 8f 09  |...Q.5uq..T[....|
-00000220  67 fd a7 24 20 3e b2 56  1c ce 97 28 5e f8 2b 2d  |g..$ >.V...(^.+-|
-00000230  4f 9e f1 07 9f 6c 4b 5b  83 56 e2 32 42 e9 58 b6  |O....lK[.V.2B.X.|
-00000240  d7 49 a6 b5 68 1a 41 03  56 6b dc 5a 89 16 03 03  |.I..h.A.Vk.Z....|
-00000250  00 88 0f 00 00 84 05 01  00 80 4d 6a 6e 18 c9 95  |..........Mjn...|
-00000260  1a d0 42 4a 56 3f 82 40  d9 66 63 cb 78 9a d0 dd  |..BJV?.@.fc.x...|
-00000270  55 71 b5 be 40 bc 83 d5  73 0c 91 aa ad 3b c4 0f  |Uq..@...s....;..|
-00000280  d8 db ba 8c 06 8c 71 e0  a5 32 67 be 32 c6 b1 91  |......q..2g.2...|
-00000290  3d e8 d8 fe 42 64 c4 83  83 52 fd 95 d4 87 e6 a0  |=...Bd...R......|
-000002a0  e8 a3 1f 5b 4a 79 95 65  bf 53 92 87 d5 26 6b 09  |...[Jy.e.S...&k.|
-000002b0  7c 2f 74 e7 af dc 01 3b  ad 8e 52 84 ac a0 47 c7  ||/t....;..R...G.|
-000002c0  ad 37 7c 62 5a ae 8e de  f9 14 86 fc 5c 4c b3 7e  |.7|bZ.......\L.~|
-000002d0  35 d8 f4 e4 ab 33 b6 ca  6a 0f 14 03 03 00 01 01  |5....3..j.......|
-000002e0  16 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-000002f0  00 00 00 00 00 10 2d 03  5b 66 40 d5 41 e2 05 e4  |......-.[f@.A...|
-00000300  ad a7 8c 69 21 90 9e 48  07 ad df 55 9e 85 6e 33  |...i!..H...U..n3|
-00000310  d6 e5 2e 95 12 6c 68 ce  c8 27 1e ca fc 91 64 ef  |.....lh..'....d.|
-00000320  67 40 87 8c 2f                                    |g@../|
+00000200  e5 35 16 03 03 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
+00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
+00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 03 00  |......._X.;t....|
+00000230  88 0f 00 00 84 05 01 00  80 18 5b ff 66 70 07 cd  |..........[.fp..|
+00000240  9b 6d a3 a6 dc c6 5b 53  42 27 13 71 0c 0e aa 5e  |.m....[SB'.q...^|
+00000250  01 0c 84 34 20 1a af 48  8c 0c 28 07 68 1f 89 4d  |...4 ..H..(.h..M|
+00000260  1c 96 1e de cc 55 5a cd  59 cd 6d fd 8a 5d 09 f4  |.....UZ.Y.m..]..|
+00000270  a0 38 ec e5 c5 84 70 f8  3c c2 4d b7 9b 93 bb 22  |.8....p.<.M...."|
+00000280  e1 d9 4d d7 c1 54 73 55  99 63 fb 0e 1d 2a 41 51  |..M..TsU.c...*AQ|
+00000290  c7 9d 91 d1 1c 1c f2 ae  7e 8f b8 5a 71 20 3a 82  |........~..Zq :.|
+000002a0  99 ef 4c 8f 84 e4 3a 17  d8 a3 f0 06 e4 89 95 89  |..L...:.........|
+000002b0  c8 f3 39 c5 a0 52 00 16  c6 14 03 03 00 01 01 16  |..9..R..........|
+000002c0  03 03 00 40 00 00 00 00  00 00 00 00 00 00 00 00  |...@............|
+000002d0  00 00 00 00 6f 19 d0 de  11 e8 13 98 0e ba 3a fd  |....o.........:.|
+000002e0  ba 8d da 63 73 a8 2c 28  a8 b6 de bc 76 ee ec 43  |...cs.,(....v..C|
+000002f0  7b 4a d7 9c 70 4d 59 02  6a 87 5e 33 51 49 63 88  |{J..pMY.j.^3QIc.|
+00000300  cd 6a 4f 13                                       |.jO.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 f1 77 7c 5e e9  |..........@.w|^.|
-00000010  68 2b 4c 80 0a 14 97 b2  30 69 e5 be e2 e8 46 bb  |h+L.....0i....F.|
-00000020  05 02 47 d9 df b9 a7 e4  0d d6 48 e3 6d cd da 30  |..G.......H.m..0|
-00000030  c7 be f0 1d ad c7 33 50  88 f5 83 90 f5 8d d3 91  |......3P........|
-00000040  a4 55 57 f8 f9 30 e4 df  98 a4 47                 |.UW..0....G|
+00000000  14 03 03 00 01 01 16 03  03 00 40 59 c9 2e 02 4d  |..........@Y...M|
+00000010  ac c3 f4 a2 97 8f 92 12  fd 99 c4 80 59 96 f4 af  |............Y...|
+00000020  eb 1b 2d 70 55 8b 28 22  42 9a 61 cd 9c 64 54 d3  |..-pU.("B.a..dT.|
+00000030  f1 a2 25 98 ad 15 cf 7d  82 12 b0 b5 06 1d 5b 21  |..%....}......[!|
+00000040  1d b9 14 69 f8 1b 30 55  67 df 22                 |...i..0Ug."|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 02 aa 83  b3 3b fd b1 d5 4a e3 78  |.........;...J.x|
-00000020  cb b5 d4 4f b9 69 12 da  c7 fa bc 7d 8e 8c d2 c7  |...O.i.....}....|
-00000030  c4 d1 5f 7b 8d 15 03 03  00 30 00 00 00 00 00 00  |.._{.....0......|
-00000040  00 00 00 00 00 00 00 00  00 00 c3 1e c6 f6 f6 f6  |................|
-00000050  f9 c6 a5 34 5f c6 ee 92  a5 3c 7a 1e 51 ef ca 72  |...4_....<z.Q..r|
-00000060  04 e5 1b cb f4 a7 f7 10  64 f0                    |........d.|
+00000010  00 00 00 00 00 95 75 2b  6f 14 f6 25 db 2e 1a 98  |......u+o..%....|
+00000020  62 91 50 6d b8 88 ed c4  33 58 2b 33 5f 64 78 e8  |b.Pm....3X+3_dx.|
+00000030  cf 89 29 b5 69 15 03 03  00 30 00 00 00 00 00 00  |..).i....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 d5 d3 10 25 68 c0  |.............%h.|
+00000050  65 67 23 fb cd ee 4c c1  7d ec 15 76 c9 1f cd d5  |eg#...L.}..v....|
+00000060  a5 6e 67 03 d9 27 0d 47  c0 90                    |.ng..'.G..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA
index 67cc2e2ba7..494bad391f 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 cc 6d d6 f4 ad  |....Y...U...m...|
-00000010  da e3 e3 4d 06 1c 2d 3b  cc 52 82 4b a2 2f 18 c3  |...M..-;.R.K./..|
-00000020  a8 c9 ba b0 ca 93 87 ad  bc 4e 55 20 cb 8d 51 98  |.........NU ..Q.|
-00000030  35 01 2e 3c 2c 1e 36 20  82 18 f4 e1 08 1e 08 af  |5..<,.6 ........|
-00000040  22 f3 df 45 d2 c9 0d 81  57 c8 12 2f c0 2f 00 00  |"..E....W.././..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 ec cc 8c b3 7b  |....Y...U......{|
+00000010  7a 62 0f 0c 6b a8 15 b8  cc 1f fd 10 bf e5 37 34  |zb..k.........74|
+00000020  ef 7e 62 15 14 59 11 91  6d 49 a1 20 91 fb 98 6d  |.~b..Y..mI. ...m|
+00000030  d2 7e 50 30 c5 c5 c2 bd  d2 b2 7d 02 82 1d 1e 80  |.~P0......}.....|
+00000040  01 b7 df f6 4b 30 cb ce  d0 d4 2e 92 c0 2f 00 00  |....K0......./..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,23 +54,21 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  cd 0c 00 00 c9 03 00 17  41 04 2a 05 cf 47 ee 3d  |........A.*..G.=|
-000002d0  d5 25 3e 5f f1 ea 99 b1  82 cd 4f af 1f 19 07 bb  |.%>_......O.....|
-000002e0  56 84 c2 9e 68 5b 49 b3  f6 a0 33 fe 4b c4 fa 00  |V...h[I...3.K...|
-000002f0  32 6e 04 d9 16 4a 83 6a  82 86 94 06 e0 53 c0 a9  |2n...J.j.....S..|
-00000300  3c 99 72 7f b7 11 5c b4  97 8f 04 01 00 80 ce b7  |<.r...\.........|
-00000310  71 2e f2 82 4a d0 f8 1c  4d 14 68 da e3 90 30 dd  |q...J...M.h...0.|
-00000320  9b 87 ae be ad e4 7a 57  cd ea 0f 11 a2 e3 1a dd  |......zW........|
-00000330  71 da ec 0f 4b 0f a3 90  05 c5 0f 25 92 a8 ef 25  |q...K......%...%|
-00000340  03 98 57 97 ed 5e 82 b1  ce d5 26 65 b1 cd dd 87  |..W..^....&e....|
-00000350  8a 19 b3 aa 22 17 de e7  55 4f 0e cb 99 8f ca 8a  |...."...UO......|
-00000360  d9 9f f6 eb 6a f5 76 e0  f8 15 54 21 f1 58 6b b1  |....j.v...T!.Xk.|
-00000370  7c f1 15 cc 4b 12 84 be  8a 38 d2 62 ee fe 83 6c  ||...K....8.b...l|
-00000380  f0 14 d5 76 8d 4a b1 cf  65 8a dc af d5 c4 16 03  |...v.J..e.......|
-00000390  03 00 2a 0d 00 00 26 03  01 02 40 00 1e 06 01 06  |..*...&...@.....|
-000003a0  02 06 03 05 01 05 02 05  03 04 01 04 02 04 03 03  |................|
-000003b0  01 03 02 03 03 02 01 02  02 02 03 00 00 16 03 03  |................|
-000003c0  00 04 0e 00 00 00                                 |......|
+000002c0  ac 0c 00 00 a8 03 00 1d  20 f0 12 33 b8 af 7f 1e  |........ ..3....|
+000002d0  11 b6 9a aa 42 0d 8e 1f  5d 3f a5 38 10 b6 6c cf  |....B...]?.8..l.|
+000002e0  36 14 6b 50 d6 73 78 38  63 04 01 00 80 cc 76 3b  |6.kP.sx8c.....v;|
+000002f0  f2 ee 84 7c 46 ed 0f ff  06 bd f7 ab 5c d2 68 b9  |...|F.......\.h.|
+00000300  fc 9e 8c 19 5b 6d 5c be  be 0f 09 e7 1c 1d 67 77  |....[m\.......gw|
+00000310  00 c2 22 02 2f 2d 86 c0  f3 48 fb 0e 4c 5c f0 b7  |.."./-...H..L\..|
+00000320  f9 e8 86 3a 94 0c b5 a0  56 8a 89 49 dd 5d 34 80  |...:....V..I.]4.|
+00000330  02 fe 23 fe 3e 2f 22 b5  09 9d 9a 03 66 d0 6e 3d  |..#.>/".....f.n=|
+00000340  a7 2f d3 2a b5 8c 6e eb  1e 9c fe 53 fb 94 a0 45  |./.*..n....S...E|
+00000350  1e 20 2b 96 1b 1f 9c ee  64 df 27 66 6e 5d ec 61  |. +.....d.'fn].a|
+00000360  e9 aa 76 31 8f 9d ce f7  2b 03 8b ac 05 16 03 03  |..v1....+.......|
+00000370  00 2a 0d 00 00 26 03 01  02 40 00 1e 06 01 06 02  |.*...&...@......|
+00000380  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
+00000390  03 02 03 03 02 01 02 02  02 03 00 00 16 03 03 00  |................|
+000003a0  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
 00000000  16 03 03 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
 00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
@@ -103,31 +102,29 @@
 000001d0  ac 11 b1 28 56 be 1d cd  61 62 84 09 bf d6 80 c6  |...(V...ab......|
 000001e0  45 8d 82 2c b4 d8 83 9b  db c9 22 b7 2a 12 11 7b  |E..,......".*..{|
 000001f0  fa 02 3b c1 c9 ff ea c9  9d a8 49 d3 95 d7 d5 0e  |..;.......I.....|
-00000200  e5 35 16 03 03 00 46 10  00 00 42 41 04 1e 18 37  |.5....F...BA...7|
-00000210  ef 0d 19 51 88 35 75 71  b5 e5 54 5b 12 2e 8f 09  |...Q.5uq..T[....|
-00000220  67 fd a7 24 20 3e b2 56  1c ce 97 28 5e f8 2b 2d  |g..$ >.V...(^.+-|
-00000230  4f 9e f1 07 9f 6c 4b 5b  83 56 e2 32 42 e9 58 b6  |O....lK[.V.2B.X.|
-00000240  d7 49 a6 b5 68 1a 41 03  56 6b dc 5a 89 16 03 03  |.I..h.A.Vk.Z....|
-00000250  00 88 0f 00 00 84 05 01  00 80 28 75 56 c7 d3 be  |..........(uV...|
-00000260  c0 45 b3 9e 08 1a 61 fa  f7 e9 2d 33 7b 3f 7a db  |.E....a...-3{?z.|
-00000270  7d 8e 34 8e 34 69 1b 41  80 4f bd b8 18 9e 35 91  |}.4.4i.A.O....5.|
-00000280  4c 48 26 8c 0b f0 9a b3  85 cd 32 04 90 45 eb 27  |LH&.......2..E.'|
-00000290  ed c9 c7 78 8b 27 12 25  6a 1c 1b 70 37 ce 27 fd  |...x.'.%j..p7.'.|
-000002a0  fd da 54 db 98 f9 05 65  de a8 41 e7 12 07 84 7d  |..T....e..A....}|
-000002b0  96 4b 59 71 5e e1 58 1f  88 87 4e d8 43 c2 9d bf  |.KYq^.X...N.C...|
-000002c0  a0 e2 eb d3 67 79 c5 c0  d8 a2 bb 50 13 3d 6b bf  |....gy.....P.=k.|
-000002d0  99 8a f6 a8 91 1f 8d 74  49 35 14 03 03 00 01 01  |.......tI5......|
-000002e0  16 03 03 00 28 00 00 00  00 00 00 00 00 bb 51 07  |....(.........Q.|
-000002f0  ab b3 89 a0 04 91 ee c0  43 96 00 50 2d 5f b8 4d  |........C..P-_.M|
-00000300  f3 d8 e1 44 ec b3 37 0e  a9 b9 2f cd 2e           |...D..7.../..|
+00000200  e5 35 16 03 03 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
+00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
+00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 03 00  |......._X.;t....|
+00000230  88 0f 00 00 84 05 01 00  80 6a 76 53 cc dd 4d d8  |.........jvS..M.|
+00000240  33 94 d3 5d 48 ec b6 0a  de 44 58 fc 95 a9 87 a4  |3..]H....DX.....|
+00000250  e7 9d 60 0c 33 69 e7 bc  f6 83 2d 03 28 8e dc 20  |..`.3i....-.(.. |
+00000260  15 71 10 dc 8e b2 e0 a3  4e 68 0c 6d a9 34 f0 e3  |.q......Nh.m.4..|
+00000270  8a 24 e6 ba 6b 8c c1 23  ae 5d c4 2d cd 21 9e e1  |.$..k..#.].-.!..|
+00000280  13 84 a4 1b 10 df 43 f2  4d 04 93 46 51 c7 36 0b  |......C.M..FQ.6.|
+00000290  ca e2 dc 35 2a 80 18 e5  72 06 c0 51 81 21 2f 62  |...5*...r..Q.!/b|
+000002a0  60 a7 f9 f3 d3 85 5f 22  4b 78 62 76 70 db 8c f0  |`....._"Kxbvp...|
+000002b0  0a 29 d1 ab 64 c5 d5 45  dc 14 03 03 00 01 01 16  |.)..d..E........|
+000002c0  03 03 00 28 00 00 00 00  00 00 00 00 63 18 f4 94  |...(........c...|
+000002d0  17 00 8b 17 4e b6 3d e7  d5 24 e6 a8 a6 90 fa bd  |....N.=..$......|
+000002e0  3e e4 78 bf 4e 50 ae 92  1f bb 27 7b              |>.x.NP....'{|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 df 01 78 2e ef  |..........(..x..|
-00000010  b5 6d ea c6 2d fa 23 b9  3f db e9 c1 27 0f 90 1f  |.m..-.#.?...'...|
-00000020  1e a0 b0 6e ab aa 1c ab  4e de 7f 18 82 b1 45 b9  |...n....N.....E.|
-00000030  c9 a6 e1                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 28 bc 3c df ab 59  |..........(.<..Y|
+00000010  84 ac 66 96 2a 71 da 4c  6d 43 69 c9 62 44 e2 2a  |..f.*q.LmCi.bD.*|
+00000020  36 cc a7 c6 ef df 3f 95  8a 07 d4 95 fc 84 7d 88  |6.....?.......}.|
+00000030  98 70 c8                                          |.p.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 02 12 eb  |................|
-00000010  61 0e 5e 44 5b d0 3c 78  42 ae 47 31 5a 98 9a a3  |a.^D[.<xB.G1Z...|
-00000020  0a 96 1b 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
-00000030  a4 b2 43 e3 bc 24 ca 03  b8 7e ce 42 b9 6a 1f 91  |..C..$...~.B.j..|
-00000040  5e f2                                             |^.|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 d3 a5 de  |................|
+00000010  f4 95 bc eb 72 cc 58 ea  10 ed 66 20 29 4c a1 ff  |....r.X...f )L..|
+00000020  e5 28 56 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.(V.............|
+00000030  bf b4 94 6d 93 b1 be 47  dd 79 3f b4 b4 91 e8 8d  |...m...G.y?.....|
+00000040  65 d6                                             |e.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES
index b9f2be6d6a..571444adab 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 d1 a1 83 db e7  |....Y...U.......|
-00000010  27 f7 0f 1b 97 54 17 5a  c4 54 db 13 7e c3 ab c5  |'....T.Z.T..~...|
-00000020  cc 0d 79 79 2d a8 01 db  e1 cc d9 20 3a b3 dc 1a  |..yy-...... :...|
-00000030  4f 6a 33 53 1e 40 78 28  4a c6 86 8c 76 df d9 2f  |Oj3S.@x(J...v../|
-00000040  f4 06 63 db 9e 7a c9 db  fd 00 d4 60 c0 09 00 00  |..c..z.....`....|
+00000000  16 03 03 00 59 02 00 00  55 03 03 cc ba 3b af 48  |....Y...U....;.H|
+00000010  3b 97 a2 49 16 17 cc 05  1b 5e 7d aa b1 5b d9 6a  |;..I.....^}..[.j|
+00000020  a8 58 3b f6 d0 bc 5a 25  17 4c 78 20 6f 77 88 e6  |.X;...Z%.Lx ow..|
+00000030  da 0d 64 f7 26 dd e5 33  3d 67 86 a5 93 38 54 68  |..d.&..3=g...8Th|
+00000040  f6 57 eb e7 ad eb 1e 6e  86 9e 5b 05 c0 09 00 00  |.W.....n..[.....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,43 +49,39 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 d7 0c 00  00 d3 03 00 17 41 04 2a  |*............A.*|
-00000280  ed 71 f5 82 ca f4 a1 2c  2a 18 c4 30 94 8a 2a 54  |.q.....,*..0..*T|
-00000290  cb aa 18 b7 5e d1 77 21  c4 75 41 d7 a5 1e 77 bc  |....^.w!.uA...w.|
-000002a0  cc f2 1a 9b a5 c1 66 88  63 17 04 64 61 e0 9e d2  |......f.c..da...|
-000002b0  f2 ab 7a 03 4d 3a fe 29  ed f1 70 eb 2a 56 fa 04  |..z.M:.)..p.*V..|
-000002c0  03 00 8a 30 81 87 02 41  61 9b d1 a4 96 1a 40 99  |...0...Aa.....@.|
-000002d0  4b 72 a9 fb 1e bb 55 a8  a9 33 ee 70 f9 c9 9d 58  |Kr....U..3.p...X|
-000002e0  99 19 0b cc af 31 48 51  79 cc 80 e2 68 18 57 a7  |.....1HQy...h.W.|
-000002f0  ff c5 d3 32 24 8d cb 70  48 87 0b 5a d3 65 aa d5  |...2$..pH..Z.e..|
-00000300  45 ad 7d 82 51 09 02 8a  16 02 42 01 d3 39 3d 24  |E.}.Q.....B..9=$|
-00000310  d6 d2 d4 b5 6e e3 c4 f1  57 14 10 a5 74 1b 21 e8  |....n...W...t.!.|
-00000320  82 f7 d4 da 22 de 11 80  87 cc 7b 2a c3 c1 c8 98  |....".....{*....|
-00000330  8a c6 18 f2 66 db cd 62  f0 38 5a bf 0a 31 0d b4  |....f..b.8Z..1..|
-00000340  9a 99 67 a4 44 75 66 36  b1 93 10 40 93 16 03 03  |..g.Duf6...@....|
-00000350  00 04 0e 00 00 00                                 |......|
+00000270  2a 16 03 03 00 b7 0c 00  00 b3 03 00 1d 20 90 28  |*............ .(|
+00000280  b7 79 32 a9 4a 79 c7 fc  d9 d6 e9 f6 2b b9 e0 38  |.y2.Jy......+..8|
+00000290  2b a8 90 54 f8 f4 4c bd  de ab ea cf 1f 08 04 03  |+..T..L.........|
+000002a0  00 8b 30 81 88 02 42 01  6f ee c9 73 6e 16 d8 36  |..0...B.o..sn..6|
+000002b0  70 c9 84 9c 65 6a d8 f1  b2 8b 9f 49 bc e1 2c 80  |p...ej.....I..,.|
+000002c0  fb ff 9d 5e 96 4b b3 5a  0e 99 70 bc f6 0c 47 35  |...^.K.Z..p...G5|
+000002d0  fc 04 80 f4 4c 31 5d a9  08 db 9c e5 82 59 0a 9a  |....L1]......Y..|
+000002e0  d0 23 ee f5 10 5e fb 07  c6 02 42 00 e2 f8 2a 1a  |.#...^....B...*.|
+000002f0  53 77 ae a1 f8 ca 16 90  5c 97 df 31 3b de 7b f4  |Sw......\..1;.{.|
+00000300  e0 87 de 2f d1 0e 1c e2  50 bb f6 53 51 79 97 02  |.../....P..SQy..|
+00000310  2e 12 0a 26 45 a4 4f 54  31 79 f6 ec d9 c1 3a 9d  |...&E.OT1y....:.|
+00000320  a0 24 f0 4c 91 d4 c3 25  ba 1f 76 f8 22 16 03 03  |.$.L...%..v."...|
+00000330  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
-00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
-00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
-00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
-00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 40 00 00  00 00 00 00 00 00 00 00  |.....@..........|
-00000060  00 00 00 00 00 00 ca d5  41 a7 18 c7 67 46 2a e2  |........A...gF*.|
-00000070  18 ee 61 10 82 2b 8e 03  b7 cd 74 07 10 1c d5 f1  |..a..+....t.....|
-00000080  dc c8 42 48 09 1c 67 d8  bf c2 19 e6 14 c2 7d 6f  |..BH..g.......}o|
-00000090  4d 97 95 c4 bc e2                                 |M.....|
+00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
+00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
+00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
+00000030  16 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
+00000040  00 00 00 00 00 a6 6f ce  95 59 bb 73 cf f9 09 cf  |......o..Y.s....|
+00000050  46 e1 2d 5e 65 b3 05 98  5f 80 de 93 0d 8c 0c 5c  |F.-^e..._......\|
+00000060  ff 11 94 b8 ed e6 4c 1b  cf dd 93 9d b9 1d 54 9e  |......L.......T.|
+00000070  6c 02 17 68 d4                                    |l..h.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 e3 89 06 9b 4b  |..........@....K|
-00000010  a5 68 3c f6 3b e0 c7 b7  07 e8 e1 4c 61 24 5d ba  |.h<.;......La$].|
-00000020  cd e5 2e 3b c3 1b 7b 89  df 2b 5f 06 54 a1 40 b9  |...;..{..+_.T.@.|
-00000030  37 2a aa ae 12 15 91 8e  ac 82 e2 9c f0 28 25 08  |7*...........(%.|
-00000040  43 3d 57 95 95 ae f6 74  e8 77 89                 |C=W....t.w.|
+00000000  14 03 03 00 01 01 16 03  03 00 40 24 e7 00 f7 28  |..........@$...(|
+00000010  db 79 5f 29 87 c4 8d 87  9c fc a7 a8 43 13 53 70  |.y_)........C.Sp|
+00000020  3b 67 bf 4b 06 76 e5 d0  88 82 79 c4 ea f0 3e c1  |;g.K.v....y...>.|
+00000030  39 5b 80 54 b9 7e 48 71  21 d5 58 de 4b 36 ff b6  |9[.T.~Hq!.X.K6..|
+00000040  5a 74 8d 76 77 1c ae 1e  e7 cb ea                 |Zt.vw......|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 af e7 22  23 14 ff f9 41 e1 7a 3b  |......."#...A.z;|
-00000020  be 86 a6 e7 31 20 50 11  98 62 be 23 7b 1a 55 e2  |....1 P..b.#{.U.|
-00000030  99 1c 36 63 84 15 03 03  00 30 00 00 00 00 00 00  |..6c.....0......|
-00000040  00 00 00 00 00 00 00 00  00 00 40 7b c1 49 9b 4c  |..........@{.I.L|
-00000050  a8 d6 30 86 7e 3b bc ae  aa 03 a7 1e e7 a1 fb f0  |..0.~;..........|
-00000060  fc f0 54 5a ba 3a 8e ec  15 11                    |..TZ.:....|
+00000010  00 00 00 00 00 74 3d bf  2b f1 04 fc f9 c0 df 76  |.....t=.+......v|
+00000020  d8 e3 42 b5 7a ad 59 8a  d2 62 d0 9e 8f ad f6 60  |..B.z.Y..b.....`|
+00000030  e3 4c 93 29 db 15 03 03  00 30 00 00 00 00 00 00  |.L.).....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 e7 b6 9c 5c 9f 5f  |.............\._|
+00000050  d3 4c e5 9c 64 10 0b 85  df fd 5f 88 3d 23 cd 22  |.L..d....._.=#."|
+00000060  e4 43 c4 ce fd 4a c0 be  7d a3                    |.C...J..}.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM
index 8280eb44cb..810c18c490 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 25 5f ff 82 ec  |....Y...U..%_...|
-00000010  e6 e0 34 9a e8 88 b2 e1  ee 44 6c 11 62 b2 14 ba  |..4......Dl.b...|
-00000020  8e 71 cb 48 70 4b 47 7f  86 3e f1 20 ad b0 3f 8e  |.q.HpKG..>. ..?.|
-00000030  4e bc 26 fb 01 18 12 8e  b2 30 b8 25 ae 0e 2d 88  |N.&......0.%..-.|
-00000040  c4 8a 60 1c 45 aa 3c 42  63 cb 4d ca c0 2b 00 00  |..`.E.<Bc.M..+..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 a3 a9 01 44 b1  |....Y...U.....D.|
+00000010  c8 87 6e ff 14 27 1c e0  76 38 b5 0b 40 41 5e b1  |..n..'..v8..@A^.|
+00000020  d8 72 13 77 6c 43 fb 17  3c eb 01 20 0e 69 39 c1  |.r.wlC..<.. .i9.|
+00000030  69 15 71 5e 9a bc f5 86  5d f2 f9 c8 12 42 f8 a6  |i.q^....]....B..|
+00000040  29 42 30 76 bb c6 e5 de  66 da 3b 05 c0 2b 00 00  |)B0v....f.;..+..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,38 +49,34 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 d8 0c 00  00 d4 03 00 17 41 04 06  |*............A..|
-00000280  53 ba c4 c9 36 1d a0 ea  75 2c 14 b7 f9 fc dd e6  |S...6...u,......|
-00000290  4b 16 11 13 15 6f 3f 30  6c dc 65 07 28 5c 78 b4  |K....o?0l.e.(\x.|
-000002a0  14 f8 20 1e 37 6b ab 5f  c7 f8 e3 9b ba 74 7d 87  |.. .7k._.....t}.|
-000002b0  ec 5c d9 5a 84 39 46 85  6f 18 35 5e 60 5a 2e 04  |.\.Z.9F.o.5^`Z..|
-000002c0  03 00 8b 30 81 88 02 42  01 8d 25 04 bd 14 00 19  |...0...B..%.....|
-000002d0  dd c5 ff 7e 31 4f 46 55  f8 50 ae f9 81 43 07 ac  |...~1OFU.P...C..|
-000002e0  cb 11 3f d4 32 f9 b8 38  1f 19 57 69 ec af cc 45  |..?.2..8..Wi...E|
-000002f0  f7 35 a9 be 4f 53 f4 35  eb fb 42 bb ab 45 0d 06  |.5..OS.5..B..E..|
-00000300  01 6e b6 12 2b 3c 91 e3  40 20 02 42 01 9e 00 e3  |.n..+<..@ .B....|
-00000310  ea 37 9d a7 fa f0 58 f4  29 ce d0 24 15 e1 10 e4  |.7....X.)..$....|
-00000320  74 f5 33 a2 15 26 0d 45  65 09 36 c4 43 9e 42 b4  |t.3..&.Ee.6.C.B.|
-00000330  0f 29 32 22 52 ff 75 28  a3 cb 73 ca 06 ef 71 8c  |.)2"R.u(..s...q.|
-00000340  02 98 5e 5f 7b 02 7b 6f  a7 bd 66 a5 6f f8 16 03  |..^_{.{o..f.o...|
-00000350  03 00 04 0e 00 00 00                              |.......|
+00000270  2a 16 03 03 00 b7 0c 00  00 b3 03 00 1d 20 4a a7  |*............ J.|
+00000280  d3 89 bd f0 46 ae 52 3b  3c 6c 92 77 ca fe 97 9f  |....F.R;<l.w....|
+00000290  1c ff 6e fc 1f 46 46 57  b4 75 a3 bc a6 53 04 03  |..n..FFW.u...S..|
+000002a0  00 8b 30 81 88 02 42 00  b2 6a ce c1 71 51 f4 e1  |..0...B..j..qQ..|
+000002b0  86 cb 55 40 00 e5 a0 62  f6 27 c2 23 d5 96 aa 66  |..U@...b.'.#...f|
+000002c0  14 36 eb 03 d9 be 01 9f  cb 7b 9e 91 44 81 5d 24  |.6.......{..D.]$|
+000002d0  8c b3 cb 29 47 c8 19 72  4e af 92 4e e1 04 4c 1b  |...)G..rN..N..L.|
+000002e0  12 1e ad 47 56 d9 7d 8a  94 02 42 01 95 dd 16 f5  |...GV.}...B.....|
+000002f0  fa b3 7a b8 d2 eb a0 e5  24 2e 8e fd 3d 5d 79 cb  |..z.....$...=]y.|
+00000300  7a 6f 48 40 f7 1e b8 6e  e6 0f 09 f4 1a ae 23 7b  |zoH@...n......#{|
+00000310  51 30 67 52 20 d7 03 85  43 a8 92 32 fa 83 8f f8  |Q0gR ...C..2....|
+00000320  b1 fb 71 6f b3 b8 34 e8  29 ba e3 26 e2 16 03 03  |..qo..4.)..&....|
+00000330  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
-00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
-00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
-00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
-00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 67 56  |.....(........gV|
-00000060  17 d8 0c 91 de 6c 80 59  0c cc f2 92 8a d4 c5 ef  |.....l.Y........|
-00000070  4b e3 c0 43 ae db 66 71  a0 a8 a6 86 ca 97        |K..C..fq......|
+00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
+00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
+00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
+00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 40 2f 97  |....(........@/.|
+00000040  9b c7 73 95 f0 c2 5d 70  bd 09 eb 6f cf ba 1c 42  |..s...]p...o...B|
+00000050  30 c4 6c 3d 9d fc d2 4e  dc 1e 5b 5c 2b           |0.l=...N..[\+|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 74 15 df d3 2d  |..........(t...-|
-00000010  c0 33 af 01 f9 50 22 97  19 b3 9a f5 68 69 35 a9  |.3...P".....hi5.|
-00000020  ac 4c 1b f6 6d b3 4e b4  5f ce 56 0b 46 4d 0f 40  |.L..m.N._.V.FM.@|
-00000030  d7 01 69                                          |..i|
+00000000  14 03 03 00 01 01 16 03  03 00 28 32 4f ac f9 b4  |..........(2O...|
+00000010  07 64 7f 6e 88 a6 c6 76  45 fc 63 ae 19 af a4 55  |.d.n...vE.c....U|
+00000020  1d d0 ab ad 81 0f 6e 20  c9 29 e1 1e 9e 19 2c ac  |......n .)....,.|
+00000030  68 5e f2                                          |h^.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 d2 0d e5  |................|
-00000010  9a c2 77 8a 81 0b d1 62  58 fa 7a 34 14 b1 14 1f  |..w....bX.z4....|
-00000020  ef e8 6d 15 03 03 00 1a  00 00 00 00 00 00 00 02  |..m.............|
-00000030  0f e6 f9 67 74 d7 95 5a  2c 17 f4 24 62 4f a8 a7  |...gt..Z,..$bO..|
-00000040  b5 fd                                             |..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 31 b6 ad  |.............1..|
+00000010  67 67 4a 76 ce 08 e1 70  8e 76 7b 4d 8a a8 7f 9c  |ggJv...p.v{M....|
+00000020  05 3e 1f 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.>..............|
+00000030  60 fd 32 5b e3 f9 cf 4a  01 9e 5a 1d 97 33 9e 82  |`.2[...J..Z..3..|
+00000040  9e 10                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES128-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES128-SHA256
index 96f2f4a956..585afbaf79 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES128-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES128-SHA256
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 1f 9e 85 7e e3  |....Y...U.....~.|
-00000010  30 5b 4c b0 e3 34 4d 13  93 97 ed 3a 38 3c a6 d5  |0[L..4M....:8<..|
-00000020  b2 9d 0c 9b 3d e8 13 85  ef e7 56 20 eb c2 eb 19  |....=.....V ....|
-00000030  fd 5e 61 08 6b 8b 6f a5  22 8d 0c 67 e0 1c 96 e1  |.^a.k.o."..g....|
-00000040  59 7b 36 82 0f c4 15 f5  b1 70 cb 1c c0 23 00 00  |Y{6......p...#..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 00 49 d2 dd b7  |....Y...U...I...|
+00000010  58 8b 60 4b b7 df 87 44  1e c9 04 77 1b e5 95 dc  |X.`K...D...w....|
+00000020  44 f9 d1 7d e1 3a 00 bf  58 a6 52 20 a4 f6 7c 43  |D..}.:..X.R ..|C|
+00000030  ed c6 51 10 f9 4f ed c2  97 ca 06 a1 b2 80 b7 ad  |..Q..O..........|
+00000040  25 ae ca 90 f3 36 bf 6f  e9 f8 e7 ce c0 23 00 00  |%....6.o.....#..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,47 +49,43 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 d8 0c 00  00 d4 03 00 17 41 04 84  |*............A..|
-00000280  28 39 9d 53 e8 8b 3f 0e  6b ed 13 79 79 ad e0 e9  |(9.S..?.k..yy...|
-00000290  a6 87 87 14 4f 32 7b 3e  c5 80 eb f3 3f af 21 1d  |....O2{>....?.!.|
-000002a0  86 3b 97 53 9d 30 1f ca  0f 57 07 c3 6e 9e e9 03  |.;.S.0...W..n...|
-000002b0  bd 0a f8 5d 79 3e 6a 98  13 0e 38 16 33 84 87 04  |...]y>j...8.3...|
-000002c0  03 00 8b 30 81 88 02 42  01 3d 4d fd 3f b3 7a 31  |...0...B.=M.?.z1|
-000002d0  50 4d 0c 56 ad 93 6f 51  36 6b ed eb c2 5f 40 e6  |PM.V..oQ6k..._@.|
-000002e0  bd d4 68 de 05 90 cb 90  e1 dd f4 dd 13 2d e3 bc  |..h..........-..|
-000002f0  77 3a 4c 75 ff d7 7a 45  1a 62 9d 1c af cb d9 a7  |w:Lu..zE.b......|
-00000300  b9 0b 52 d0 94 e9 a1 11  7e 63 02 42 01 e5 25 47  |..R.....~c.B..%G|
-00000310  4f fd 02 4d 8d 81 8e ef  90 15 a5 29 8d 11 40 0f  |O..M.......)..@.|
-00000320  e0 2f 59 da e6 63 da 23  9f fe 61 53 13 7a 2d 1a  |./Y..c.#..aS.z-.|
-00000330  f2 26 23 91 06 bf 36 dd  d5 6b 0e 4b 7b 32 b0 41  |.&#...6..k.K{2.A|
-00000340  0e 00 17 c6 95 04 5a 88  41 61 b6 ec 82 38 16 03  |......Z.Aa...8..|
-00000350  03 00 04 0e 00 00 00                              |.......|
+00000270  2a 16 03 03 00 b7 0c 00  00 b3 03 00 1d 20 b1 5f  |*............ ._|
+00000280  40 ca dd 4d 6d 01 43 2b  15 33 20 d9 bb 48 b9 b9  |@..Mm.C+.3 ..H..|
+00000290  03 0a 59 16 fc 77 86 3d  0f 7d 90 4d 67 54 04 03  |..Y..w.=.}.MgT..|
+000002a0  00 8b 30 81 88 02 42 01  8e 02 19 76 bc bf 30 db  |..0...B....v..0.|
+000002b0  98 5a e0 07 79 bd d1 b6  13 b6 cd b0 fc d9 30 24  |.Z..y.........0$|
+000002c0  3e 22 bc e6 87 a5 6a d3  6c a1 cc ef 43 91 5d eb  |>"....j.l...C.].|
+000002d0  1f e8 09 90 b2 06 6d 2c  cb cc d4 68 27 2b 7a be  |......m,...h'+z.|
+000002e0  6d 7b 10 96 d0 70 a5 70  32 02 42 01 43 e2 f9 8e  |m{...p.p2.B.C...|
+000002f0  d9 ef ca 5c 6c 90 18 07  db 22 21 33 0a 1f 6f d1  |...\l...."!3..o.|
+00000300  6d 6d 3a 46 81 2b 2b ee  ee 58 94 7a cd 7a a5 59  |mm:F.++..X.z.z.Y|
+00000310  b1 c3 c3 15 ef 9d 68 a5  8f 9d df 23 11 9c f0 49  |......h....#...I|
+00000320  ce 70 fd 74 77 ba 0a cd  b3 73 97 89 ad 16 03 03  |.p.tw....s......|
+00000330  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
-00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
-00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
-00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
-00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 50 00 00  00 00 00 00 00 00 00 00  |.....P..........|
-00000060  00 00 00 00 00 00 b6 be  a3 13 26 66 59 78 6b f0  |..........&fYxk.|
-00000070  a4 b4 db 3e 48 98 dd 0e  fb b7 1e 72 4d 5c 60 d9  |...>H......rM\`.|
-00000080  33 30 4e 75 e3 5b 03 73  dd d3 b9 a2 ad a4 c7 4c  |30Nu.[.s.......L|
-00000090  d2 1d e3 98 6f 93 dd 66  4d 33 61 66 bb d1 e9 a0  |....o..fM3af....|
-000000a0  d7 95 47 01 85 3a                                 |..G..:|
+00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
+00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
+00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
+00000030  16 03 03 00 50 00 00 00  00 00 00 00 00 00 00 00  |....P...........|
+00000040  00 00 00 00 00 9f b7 57  59 ea 5f 87 fe 2b b4 29  |.......WY._..+.)|
+00000050  a3 15 1a d2 c8 90 a1 46  f1 3d ce 43 40 ec 54 19  |.......F.=.C@.T.|
+00000060  80 12 61 b8 1f de 80 e1  14 94 9b e5 aa 9c e3 b3  |..a.............|
+00000070  fb 34 e1 ef 46 97 e7 7b  3f 47 15 84 86 a8 bb 8d  |.4..F..{?G......|
+00000080  8c 4d 5e 93 27                                    |.M^.'|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 50 b8 1f f2 b7 07  |..........P.....|
-00000010  83 90 22 d9 91 47 d8 d3  40 ab db 22 30 7e f4 d0  |.."..G..@.."0~..|
-00000020  f3 79 16 d3 6b 8c 58 ad  47 f9 4d 96 46 e4 b1 73  |.y..k.X.G.M.F..s|
-00000030  ba 9c 43 73 d2 31 e3 de  30 5a 81 3e 7e e5 30 3d  |..Cs.1..0Z.>~.0=|
-00000040  ba 93 06 40 93 ed 07 1e  a6 82 e6 0b 20 b7 6c a8  |...@........ .l.|
-00000050  bc 9a cd 34 3f 38 b0 7a  34 f8 3d                 |...4?8.z4.=|
+00000000  14 03 03 00 01 01 16 03  03 00 50 8d d4 d3 b9 3a  |..........P....:|
+00000010  e6 52 2f ca 1c 86 f6 ca  66 a1 27 51 0a b7 d0 8d  |.R/.....f.'Q....|
+00000020  bf bc df f3 af 7d e5 6e  33 a3 49 82 20 fd 70 80  |.....}.n3.I. .p.|
+00000030  1c 7b 6a a5 10 9a b8 51  b6 8f 2a 19 61 82 1f 47  |.{j....Q..*.a..G|
+00000040  65 87 0c dd 71 51 ab 2b  97 b9 d9 4d ca 09 84 de  |e...qQ.+...M....|
+00000050  ef a2 4a 15 41 fa d0 0d  8b c0 8c                 |..J.A......|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000010  00 00 00 00 00 e3 3d e1  1d 9e ff cb ab df 74 53  |......=.......tS|
-00000020  81 09 16 1c 85 ac d9 43  50 9c 50 9d f5 30 20 87  |.......CP.P..0 .|
-00000030  cb d5 af 13 42 d3 c7 8f  df ef ef ae 28 3b d8 75  |....B.......(;.u|
-00000040  28 b5 c4 87 66 15 03 03  00 40 00 00 00 00 00 00  |(...f....@......|
-00000050  00 00 00 00 00 00 00 00  00 00 62 9a 7b 83 27 b4  |..........b.{.'.|
-00000060  b8 80 54 c6 6f d8 b7 44  f3 60 b7 fe 04 bd c3 98  |..T.o..D.`......|
-00000070  b1 7b df 26 2c a7 97 36  65 a1 50 bd 20 d9 fe cf  |.{.&,..6e.P. ...|
-00000080  d8 f9 6a 2d 00 c7 ca 54  f2 7b                    |..j-...T.{|
+00000010  00 00 00 00 00 62 2c 4f  5b fa b8 8a ac ee 13 c3  |.....b,O[.......|
+00000020  e2 d7 de 8e 16 0f af fb  1f 65 a5 ba 5e b6 aa 11  |.........e..^...|
+00000030  0c 22 e1 7d 74 57 e4 0b  8c c9 cf fa 41 82 28 cc  |.".}tW......A.(.|
+00000040  91 32 96 c8 7d 15 03 03  00 40 00 00 00 00 00 00  |.2..}....@......|
+00000050  00 00 00 00 00 00 00 00  00 00 9d 9e f4 64 68 31  |.............dh1|
+00000060  86 ba eb f3 35 23 61 ff  25 d6 48 c6 7b 14 4f 07  |....5#a.%.H.{.O.|
+00000070  86 1a 47 48 75 37 f5 08  4c a2 64 cd 9e fa 0c 21  |..GHu7..L.d....!|
+00000080  6e 2a 66 b4 ba 61 d5 cc  a5 5b                    |n*f..a...[|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384 b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384
index 7f8fc4d055..c413dfde3b 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 1d 78 37 0a 00  |....Y...U...x7..|
-00000010  70 94 45 3c 49 1b 82 94  3f d4 4c b7 00 70 a6 65  |p.E<I...?.L..p.e|
-00000020  af 8d 9b be 78 b5 98 22  75 5e a8 20 86 0e 17 77  |....x.."u^. ...w|
-00000030  6b 15 41 0b 51 d3 74 dc  5a a6 fc 7c 29 7d 30 3b  |k.A.Q.t.Z..|)}0;|
-00000040  7e 69 5c a1 4a 45 c9 8a  52 80 c3 3d c0 2c 00 00  |~i\.JE..R..=.,..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 25 53 12 07 e9  |....Y...U..%S...|
+00000010  0c 84 dd 43 23 7e 89 4d  de 4f d2 a6 86 1f be f1  |...C#~.M.O......|
+00000020  33 4c 11 b1 c7 ab 97 5a  ce a0 af 20 1d 1d 0d d6  |3L.....Z... ....|
+00000030  44 8e e8 14 aa c3 07 ac  26 f9 4b 62 2f ab 1d 83  |D.......&.Kb/...|
+00000040  0c 0e f4 99 c9 1b 63 83  6f 9b 0e 26 c0 2c 00 00  |......c.o..&.,..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,38 +49,34 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 d7 0c 00  00 d3 03 00 17 41 04 bd  |*............A..|
-00000280  d5 51 1a c3 69 ca 47 cd  74 e5 9b 48 be a6 8f 86  |.Q..i.G.t..H....|
-00000290  70 cc d6 c5 d2 d7 85 8f  e0 fa be 49 5c fc de 21  |p..........I\..!|
-000002a0  98 b9 7c 88 12 a6 76 d9  47 c8 3f 0f 49 1d 7d 1b  |..|...v.G.?.I.}.|
-000002b0  15 77 7a 8b 0c f4 3a b6  de eb 70 69 50 88 3f 04  |.wz...:...piP.?.|
-000002c0  03 00 8a 30 81 87 02 41  65 34 f2 1d db 9b 31 35  |...0...Ae4....15|
-000002d0  a0 bc 4a b8 aa 78 93 54  c7 43 3b 4b 9d eb 3d ba  |..J..x.T.C;K..=.|
-000002e0  38 ba ad 5a 26 fc 67 46  ca d6 c4 21 42 6c 31 51  |8..Z&.gF...!Bl1Q|
-000002f0  16 8e a3 59 d3 2c 55 9b  00 19 0e 40 ad 3c 3d ec  |...Y.,U....@.<=.|
-00000300  a2 da 87 5b b0 31 0e 4b  8e 02 42 01 f9 7e 5b a4  |...[.1.K..B..~[.|
-00000310  d5 d1 7f 38 c5 59 31 29  4c c0 42 ad 2e e0 20 cc  |...8.Y1)L.B... .|
-00000320  24 53 70 d6 f2 ff c3 79  8d 56 14 62 12 5e fe 97  |$Sp....y.V.b.^..|
-00000330  a0 c1 d6 25 d7 ae b1 c7  51 93 dd 06 8c 88 c8 af  |...%....Q.......|
-00000340  b4 38 d1 fd 2a 4f 35 1c  bb 46 e6 06 c6 16 03 03  |.8..*O5..F......|
-00000350  00 04 0e 00 00 00                                 |......|
+00000270  2a 16 03 03 00 b7 0c 00  00 b3 03 00 1d 20 0d ae  |*............ ..|
+00000280  d8 d1 97 30 6d b0 2f a9  d5 42 5d 36 7c 86 19 3d  |...0m./..B]6|..=|
+00000290  1c ad fe 32 a7 09 c7 b7  5c 13 3a 36 39 1a 04 03  |...2....\.:69...|
+000002a0  00 8b 30 81 88 02 42 01  61 83 4b 88 59 3b 1a 77  |..0...B.a.K.Y;.w|
+000002b0  b3 bf d9 dc f5 49 ba c8  9e 68 f2 df ed ab 19 f9  |.....I...h......|
+000002c0  b1 2d cb d9 35 b2 03 59  9f 11 dd 3f 48 a0 b6 15  |.-..5..Y...?H...|
+000002d0  3b df e6 3d bf 3e 51 ac  92 cc 55 32 81 11 95 85  |;..=.>Q...U2....|
+000002e0  50 7d b2 7e 81 3e 9a b2  2e 02 42 00 a3 24 28 c0  |P}.~.>....B..$(.|
+000002f0  56 f8 20 29 77 f4 3d ff  2d 09 36 58 31 cf 9d d5  |V. )w.=.-.6X1...|
+00000300  9c b6 df 95 b1 5f f7 88  2b 09 a3 58 17 41 79 ae  |....._..+..X.Ay.|
+00000310  9e 6a 80 6a a6 d2 64 77  1b 79 44 55 bc af 8f df  |.j.j..dw.yDU....|
+00000320  07 58 fe e7 97 4b d7 39  3f 8a 10 ae 0d 16 03 03  |.X...K.9?.......|
+00000330  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
-00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
-00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
-00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
-00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 1b f7  |.....(..........|
-00000060  98 9e a2 1c a6 d9 0e 55  2f d4 6b be db ba 2f 4a  |.......U/.k.../J|
-00000070  4f 46 8b 8b b2 65 27 d8  18 d5 83 61 12 68        |OF...e'....a.h|
+00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
+00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
+00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
+00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 53 ce b7  |....(........S..|
+00000040  2e 05 87 4b dc da ee 78  8e b9 24 7c 79 a3 29 c2  |...K...x..$|y.).|
+00000050  03 35 d5 81 91 4a a7 b5  d4 86 a0 76 91           |.5...J.....v.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 09 2c dd e4 d7  |..........(.,...|
-00000010  60 74 68 8f b0 48 1d 53  54 b8 f8 fc 27 d4 9b ca  |`th..H.ST...'...|
-00000020  4a e3 29 ad 49 53 46 9b  ed 2f 9c c8 2c 17 b3 50  |J.).ISF../..,..P|
-00000030  a3 87 81                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 28 fc 0c 83 69 48  |..........(...iH|
+00000010  3c ef b2 24 08 0b 80 4f  37 48 a1 47 21 b1 99 d9  |<..$...O7H.G!...|
+00000020  06 1e db 1b 13 21 18 99  ad 2d a9 7e 66 1f 00 39  |.....!...-.~f..9|
+00000030  53 2f 36                                          |S/6|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 93 96 d9  |................|
-00000010  50 d6 f9 00 c5 06 60 0b  94 2c cf b6 08 99 57 a3  |P.....`..,....W.|
-00000020  f5 2c de 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.,..............|
-00000030  95 6f b0 94 f7 79 c6 5e  50 e6 42 e9 76 d0 7b 26  |.o...y.^P.B.v.{&|
-00000040  c6 0d                                             |..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 c2 08 d0  |................|
+00000010  5a f6 bd a8 68 a9 91 91  be b8 d9 bb 71 96 c7 e0  |Z...h.......q...|
+00000020  0e 30 10 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.0..............|
+00000030  b9 c5 46 64 12 c1 bb 38  69 1b 59 59 f0 69 75 01  |..Fd...8i.YY.iu.|
+00000040  3f 8b                                             |?.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES
index 1c8ed6ee7d..cf9d149bff 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 e9 05 b4 d9 e5  |....Y...U.......|
-00000010  32 15 3b fb c4 88 26 da  a2 fc 28 87 81 6f 7c 64  |2.;...&...(..o|d|
-00000020  fb 23 c7 aa 04 5c d0 db  6d 17 53 20 8c ad 1e ab  |.#...\..m.S ....|
-00000030  af a2 f7 95 23 46 34 eb  67 4a ee 08 c4 be c9 bc  |....#F4.gJ......|
-00000040  2c 7b 5a bd ac ce b6 33  2f f0 ce 6d c0 13 00 00  |,{Z....3/..m....|
+00000000  16 03 03 00 59 02 00 00  55 03 03 38 32 f1 94 2f  |....Y...U..82../|
+00000010  66 62 c3 36 54 d2 56 0d  0c 10 41 47 78 cb 38 0b  |fb.6T.V...AGx.8.|
+00000020  d5 09 34 55 e1 1c 00 d8  dc 60 cf 20 20 98 6e f8  |..4U.....`.  .n.|
+00000030  d4 01 2d 22 7c 9b 06 60  af 94 5b e7 d5 ce 1c eb  |..-"|..`..[.....|
+00000040  20 c2 7b ec c5 e9 09 d4  1f 63 4c 29 c0 13 00 00  | .{......cL)....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,42 +54,38 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  cd 0c 00 00 c9 03 00 17  41 04 08 89 35 71 9c 6f  |........A...5q.o|
-000002d0  6d 23 7d e8 c5 97 18 ae  55 5d cc 58 72 3a 4e 57  |m#}.....U].Xr:NW|
-000002e0  0f 09 4d a3 81 b4 be 8d  7e 9b 97 7a 23 99 16 3d  |..M.....~..z#..=|
-000002f0  3b d6 84 85 e8 84 ac 40  5d 09 56 68 10 1d c8 56  |;......@].Vh...V|
-00000300  bd ce 9d f0 06 08 28 43  b1 68 04 01 00 80 8f 8f  |......(C.h......|
-00000310  3a e7 1a ad 4e 90 22 30  5c ac e6 f3 82 65 a4 79  |:...N."0\....e.y|
-00000320  45 17 da 02 fd 35 19 77  0b 9a 4b f9 f4 ae 4a 73  |E....5.w..K...Js|
-00000330  75 95 6b ba c5 2d 98 4a  81 f5 ef c2 49 d5 ed 6c  |u.k..-.J....I..l|
-00000340  14 2f 17 a1 ad f1 23 21  98 db d8 e0 83 4e b8 58  |./....#!.....N.X|
-00000350  3b bf 00 a2 62 ad f9 2b  8a 85 3f 29 be d3 5f 70  |;...b..+..?).._p|
-00000360  83 3e 0f a7 c9 27 86 e4  4e 9f 1f d9 18 01 be 97  |.>...'..N.......|
-00000370  5c 3a c0 1f e6 a5 fb 44  42 be 20 a0 77 4c 2a 37  |\:.....DB. .wL*7|
-00000380  e3 e9 fb 18 4c 12 1e a3  6a 0b a4 bf 7e f7 16 03  |....L...j...~...|
-00000390  03 00 04 0e 00 00 00                              |.......|
+000002c0  ac 0c 00 00 a8 03 00 1d  20 12 34 a3 04 5f 07 78  |........ .4.._.x|
+000002d0  27 c5 3f 34 a9 7e 50 01  66 a8 54 65 7b 12 93 61  |'.?4.~P.f.Te{..a|
+000002e0  40 d0 8d 22 55 ad f1 56  7f 04 01 00 80 58 2b 24  |@.."U..V.....X+$|
+000002f0  66 a3 b3 31 45 18 63 13  e1 7f 2d 45 b9 13 30 89  |f..1E.c...-E..0.|
+00000300  43 85 1d bc 0e f9 90 85  4d c5 db 78 81 02 78 0c  |C.......M..x..x.|
+00000310  ca fa 9d 61 46 04 7f 1b  29 81 7f 68 b1 11 12 63  |...aF...)..h...c|
+00000320  07 b9 c4 a2 1b 60 d9 88  ca 81 4a 9f 13 65 3b 85  |.....`....J..e;.|
+00000330  7f 2a 69 a4 23 d6 7d 2b  be 33 2d be e3 ae ab 57  |.*i.#.}+.3-....W|
+00000340  a1 b0 3f 32 40 c3 c6 8d  5f d2 a8 9b 7c 5a cf f7  |..?2@..._...|Z..|
+00000350  ea 26 bc ef 9d 01 71 4a  b3 c7 04 7d f7 90 f3 a9  |.&....qJ...}....|
+00000360  a9 18 fe ed c1 11 86 09  f8 3e 25 24 53 16 03 03  |.........>%$S...|
+00000370  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
-00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
-00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
-00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
-00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 40 00 00  00 00 00 00 00 00 00 00  |.....@..........|
-00000060  00 00 00 00 00 00 94 cc  f2 40 05 2f 97 32 ef 64  |.........@./.2.d|
-00000070  12 ff d2 3b df 70 1e d1  0d 9b f8 96 a8 bd 4d 24  |...;.p........M$|
-00000080  a8 e1 a8 ee 01 9d f4 72  a7 aa e7 46 87 52 34 10  |.......r...F.R4.|
-00000090  33 c7 81 29 83 e3                                 |3..)..|
+00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
+00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
+00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
+00000030  16 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
+00000040  00 00 00 00 00 ba e9 52  18 ee 63 97 4c 29 49 0f  |.......R..c.L)I.|
+00000050  bb 95 42 f0 4d cd 6e c4  cd 24 36 94 76 50 e7 67  |..B.M.n..$6.vP.g|
+00000060  cc 9f d1 3f d9 1c 2e 84  c7 bb 51 c5 13 32 84 1d  |...?......Q..2..|
+00000070  c5 c7 51 ef 69                                    |..Q.i|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 88 a5 62 83 1c  |..........@..b..|
-00000010  b4 3c 98 eb 2b ed c1 88  f5 4c 44 d8 9c ef b0 4c  |.<..+....LD....L|
-00000020  38 c0 ff e9 7b 20 ad 32  ff 23 3f a7 cb b7 53 47  |8...{ .2.#?...SG|
-00000030  58 c3 a3 49 8b 18 fd d4  72 6d 9a 05 3a 40 c9 93  |X..I....rm..:@..|
-00000040  3d b5 35 20 96 f4 bd 4e  d5 e8 ed                 |=.5 ...N...|
+00000000  14 03 03 00 01 01 16 03  03 00 40 dd 38 41 53 63  |..........@.8ASc|
+00000010  d4 07 dd ce 6b 26 a2 86  9e ba 83 1d 56 ac e3 59  |....k&......V..Y|
+00000020  07 9c 27 0b 86 f7 51 66  fa 3c 5a 72 28 af 2e e9  |..'...Qf.<Zr(...|
+00000030  ca b8 ac 91 c1 89 49 d1  47 09 f4 0f 4b 9c 75 e2  |......I.G...K.u.|
+00000040  d1 c5 20 fe da c9 e8 ce  0e da 7b                 |.. .......{|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 d6 43 ac  cb ab 11 db ae bb ca 95  |......C.........|
-00000020  35 e8 1b 29 60 ef 52 40  15 74 e4 b7 29 ea 45 36  |5..)`.R@.t..).E6|
-00000030  4a cf 6e ed bc 15 03 03  00 30 00 00 00 00 00 00  |J.n......0......|
-00000040  00 00 00 00 00 00 00 00  00 00 20 76 c9 f9 21 23  |.......... v..!#|
-00000050  c9 a0 bd 00 69 34 19 dc  81 18 a0 e4 90 f1 fb c5  |....i4..........|
-00000060  70 a6 51 2e 77 24 71 57  69 15                    |p.Q.w$qWi.|
+00000010  00 00 00 00 00 a2 50 3f  eb 7c 39 a1 21 87 f9 8a  |......P?.|9.!...|
+00000020  55 de 65 45 43 ae de 8c  a3 0f ef 56 dc 8c 0b 71  |U.eEC......V...q|
+00000030  07 ea 4f 52 8d 15 03 03  00 30 00 00 00 00 00 00  |..OR.....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 e0 66 38 fb 98 f1  |...........f8...|
+00000050  44 af e2 f6 d2 1d 0d e9  47 23 57 89 00 26 02 51  |D.......G#W..&.Q|
+00000060  d7 0f d2 a3 06 dc 72 b6  7e 0e                    |......r.~.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256
index da96c5e698..ba2983ff79 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 52 ec 3d ca 8e  |....Y...U..R.=..|
-00000010  66 39 93 aa 74 f0 ae 26  75 a6 2d 79 9f 14 26 8d  |f9..t..&u.-y..&.|
-00000020  97 ee 01 b3 8c 11 6a ba  07 23 e8 20 08 b2 b2 24  |......j..#. ...$|
-00000030  08 4f 6e 70 fa b6 a3 c5  39 0a c7 ee 66 dd 6c 91  |.Onp....9...f.l.|
-00000040  35 0f 2e 27 8b b9 11 5b  d1 a2 fb d9 c0 27 00 00  |5..'...[.....'..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 cd 1e 03 fa a9  |....Y...U.......|
+00000010  7c d2 a2 c1 2e f9 22 1d  58 0f 1b 40 c9 17 57 a2  ||.....".X..@..W.|
+00000020  cd 7f a8 ee 5e 5f 4a b3  30 49 14 20 6d ff 6a 17  |....^_J.0I. m.j.|
+00000030  a6 30 74 f5 bc de 0e 43  16 10 a1 4d f5 a9 90 b8  |.0t....C...M....|
+00000040  ab c9 b9 af 6a 9f a2 6b  70 2c c2 69 c0 27 00 00  |....j..kp,.i.'..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,46 +54,42 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  cd 0c 00 00 c9 03 00 17  41 04 ed d1 a9 86 54 01  |........A.....T.|
-000002d0  2e 20 c1 f1 41 03 c7 88  f0 e4 45 49 54 08 12 f0  |. ..A.....EIT...|
-000002e0  1c 3c 2b ae bc c6 72 00  5c 3b 52 1d 96 7e a4 95  |.<+...r.\;R..~..|
-000002f0  88 6b 43 a9 a2 e9 62 35  d8 36 11 df 5c aa 53 ab  |.kC...b5.6..\.S.|
-00000300  d6 3c a3 0a 54 b7 48 10  f4 7f 04 01 00 80 1e d5  |.<..T.H.........|
-00000310  e4 e9 34 e2 3d e6 a1 ee  00 b8 1c b1 48 d1 ed c1  |..4.=.......H...|
-00000320  3b 55 55 a8 ed 42 ae fb  5e 51 35 ec be 18 27 69  |;UU..B..^Q5...'i|
-00000330  38 1f c0 af 1d 1c da 51  b1 14 59 32 fb c8 c2 02  |8......Q..Y2....|
-00000340  12 03 64 7c 01 c4 e8 32  03 b8 7e a7 ff 4c 13 54  |..d|...2..~..L.T|
-00000350  a8 91 9b 41 07 72 24 9b  0d 7d a5 f8 a0 a9 a3 90  |...A.r$..}......|
-00000360  8a d8 cd c1 4d 4e d1 da  26 7a 19 8a 2b b7 93 b4  |....MN..&z..+...|
-00000370  46 e8 9b c2 93 f5 80 52  9a ec b6 f5 68 02 b4 a0  |F......R....h...|
-00000380  51 43 61 fa a3 63 40 16  92 4f e2 7f f8 7c 16 03  |QCa..c@..O...|..|
-00000390  03 00 04 0e 00 00 00                              |.......|
+000002c0  ac 0c 00 00 a8 03 00 1d  20 86 06 90 6a e1 df 61  |........ ...j..a|
+000002d0  43 2a 25 80 42 80 ab c7  99 59 40 e4 e5 43 66 e1  |C*%.B....Y@..Cf.|
+000002e0  b6 96 a1 12 60 9b bc 07  50 04 01 00 80 4f 3e 31  |....`...P....O>1|
+000002f0  0a dd 7b 73 5d 8d b7 ed  77 9f 65 06 6b 5d b3 a4  |..{s]...w.e.k]..|
+00000300  54 0c db 5a 20 bb e0 ae  d9 9f bc 58 47 aa 62 55  |T..Z ......XG.bU|
+00000310  f1 70 9b fd b0 1b 55 d3  aa 2f 3e 7d 63 b0 fd 40  |.p....U../>}c..@|
+00000320  15 f3 47 9f f1 99 46 cf  c5 34 d4 81 39 4d 9c 12  |..G...F..4..9M..|
+00000330  8e 16 93 85 7a 9c aa ae  f6 28 48 81 1d f6 34 82  |....z....(H...4.|
+00000340  b4 ec 85 8a d6 21 c7 a3  ac df ec 25 0d 12 d6 b8  |.....!.....%....|
+00000350  e8 4d e8 69 89 cc 1a e3  c3 77 81 0e a1 8d 54 eb  |.M.i.....w....T.|
+00000360  e5 5f 50 be a4 e8 79 f7  fb 99 98 4a 13 16 03 03  |._P...y....J....|
+00000370  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
-00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
-00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
-00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
-00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 50 00 00  00 00 00 00 00 00 00 00  |.....P..........|
-00000060  00 00 00 00 00 00 cd 3d  7e db 65 76 06 d5 cf 73  |.......=~.ev...s|
-00000070  9b 6e 94 99 6e 55 e9 3c  74 08 6b 29 7a 73 fe dc  |.n..nU.<t.k)zs..|
-00000080  97 1b 55 23 f0 d7 7a d4  c5 1b 55 9f 82 88 c3 9b  |..U#..z...U.....|
-00000090  51 89 f5 df f5 36 91 4f  cd 3f 11 5c 3d 08 29 35  |Q....6.O.?.\=.)5|
-000000a0  17 a8 a9 5a 95 cc                                 |...Z..|
+00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
+00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
+00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
+00000030  16 03 03 00 50 00 00 00  00 00 00 00 00 00 00 00  |....P...........|
+00000040  00 00 00 00 00 1b f5 41  8d 0a 5c 6f 2b de 74 41  |.......A..\o+.tA|
+00000050  25 99 e0 e0 24 bb 7e 3d  85 62 96 cb e4 27 bb cb  |%...$.~=.b...'..|
+00000060  82 49 a6 4a 2c 27 f3 47  43 b5 b4 cd 26 aa 35 c0  |.I.J,'.GC...&.5.|
+00000070  af 6e 9a ca e1 ea 54 86  c2 0a 08 3d 42 67 7f d6  |.n....T....=Bg..|
+00000080  03 a0 18 42 dd                                    |...B.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 50 ab 66 1f 17 93  |..........P.f...|
-00000010  3b a3 98 c0 05 76 7e c6  21 90 01 73 7c 63 ab 4a  |;....v~.!..s|c.J|
-00000020  3c bf 16 ed dd a5 24 f1  7b 46 21 bc 15 ef 92 3e  |<.....$.{F!....>|
-00000030  e4 ff 9e 60 cd cd 38 4b  5d 0c 56 b2 5b 65 77 a2  |...`..8K].V.[ew.|
-00000040  b3 8f fe 91 81 2b 10 cb  6b 13 7d e5 53 da 90 02  |.....+..k.}.S...|
-00000050  d9 c7 bb 7b 32 a3 2c 91  92 1d aa                 |...{2.,....|
+00000000  14 03 03 00 01 01 16 03  03 00 50 55 90 23 a2 84  |..........PU.#..|
+00000010  93 dd 42 57 d7 2f 20 14  b5 71 64 6e a0 b5 29 31  |..BW./ ..qdn..)1|
+00000020  b7 5c 15 ec 30 e7 c7 82  c3 f7 a6 54 d8 80 dc e7  |.\..0......T....|
+00000030  32 8c 65 cd 9c 65 36 a8  5f 8f 71 0d f4 f3 f4 c0  |2.e..e6._.q.....|
+00000040  ea 78 44 62 84 27 bd 09  6a d9 6b c4 6d 40 75 02  |.xDb.'..j.k.m@u.|
+00000050  9e fe e2 8e e6 1a a0 18  f2 f3 8b                 |...........|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000010  00 00 00 00 00 b5 31 ff  15 87 a2 df 7a 4e 00 0e  |......1.....zN..|
-00000020  f2 45 59 71 01 d7 8b d0  f8 25 16 96 e1 76 42 ec  |.EYq.....%...vB.|
-00000030  f2 c7 08 aa 70 72 9c a4  51 85 8f 7e f5 74 93 72  |....pr..Q..~.t.r|
-00000040  1a c5 c3 29 7c 15 03 03  00 40 00 00 00 00 00 00  |...)|....@......|
-00000050  00 00 00 00 00 00 00 00  00 00 ba 82 2e f5 da 08  |................|
-00000060  e8 53 81 54 b9 00 1b 58  91 1d c2 f6 f5 03 f8 55  |.S.T...X.......U|
-00000070  c0 9e ee b9 83 ef 3c ff  2c d0 38 0c 41 c3 24 f9  |......<.,.8.A.$.|
-00000080  c2 98 64 b0 73 8f eb 67  f9 b8                    |..d.s..g..|
+00000010  00 00 00 00 00 ee b7 c3  ba 79 9b 0d 6c 9f 8f da  |.........y..l...|
+00000020  60 65 68 7b 86 c8 21 35  5a 08 ba 8f f9 ac 36 d6  |`eh{..!5Z.....6.|
+00000030  9d af 28 bc 01 1a 07 3f  9b 23 32 05 9a b8 d4 99  |..(....?.#2.....|
+00000040  5d b0 4b 2e d3 15 03 03  00 40 00 00 00 00 00 00  |].K......@......|
+00000050  00 00 00 00 00 00 00 00  00 00 25 72 95 d3 f0 92  |..........%r....|
+00000060  8a ac 7e 45 41 f0 1d 61  44 55 12 05 75 e8 30 19  |..~EA..aDU..u.0.|
+00000070  8a d5 d1 96 64 bb 2f 9a  eb 49 4d 87 ce 5e e3 b6  |....d./..IM..^..|
+00000080  90 52 8d 52 87 e6 bc d8  ac 5a                    |.R.R.....Z|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4 b/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4
index 15ddf693e8..90a06782f2 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4
+++ b/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 51 02 00 00  4d 03 03 4f 7d f5 58 ff  |....Q...M..O}.X.|
-00000010  e5 bb bc 25 94 2b be d7  85 62 7b 07 53 7d d2 28  |...%.+...b{.S}.(|
-00000020  fb 4a 26 e5 e2 f9 c8 22  28 7f 59 20 3d bf 46 07  |.J&...."(.Y =.F.|
-00000030  2c 89 95 ae f3 7d ae bc  d5 35 4a ef 3b 46 58 cc  |,....}...5J.;FX.|
-00000040  5e ed b7 61 a5 e1 e2 e7  24 5c ad f0 00 05 00 00  |^..a....$\......|
+00000000  16 03 03 00 51 02 00 00  4d 03 03 12 53 68 12 43  |....Q...M...Sh.C|
+00000010  a3 91 bb e6 22 05 1c d6  87 ad 68 d7 45 ea 3b 90  |....".....h.E.;.|
+00000020  7f f5 07 cf 6d c4 49 19  6d 53 7d 20 7f 55 1f 51  |....m.I.mS} .U.Q|
+00000030  cd 69 69 cf a1 50 aa 9a  fc 45 7a 3f e5 70 dd 71  |.ii..P...Ez?.p.q|
+00000040  cd 78 79 28 e2 36 ef 75  87 7c 84 5f 00 05 00 00  |.xy(.6.u.|._....|
 00000050  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
 00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -63,15 +64,15 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 03 00 24 27 99  56 77 84 61 43 cc 59 29  |.....$'.Vw.aC.Y)|
-000000a0  b2 ae a6 31 1a eb 1f 27  11 16 68 9b 79 c4 71 cc  |...1...'..h.y.q.|
-000000b0  97 56 2b 1e 1b 2b a6 a5  88 89                    |.V+..+....|
+00000090  01 16 03 03 00 24 66 80  5a e0 f0 3a 90 d7 30 b9  |.....$f.Z..:..0.|
+000000a0  14 9d e5 34 27 c1 da 12  43 62 3d e2 11 ae 80 52  |...4'...Cb=....R|
+000000b0  97 07 7b 50 64 fc 8b 5f  82 b8                    |..{Pd.._..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 24 de 0a aa e2 89  |..........$.....|
-00000010  c1 c2 ef 7e 8b 89 54 46  33 fc 62 50 5a 9a 93 28  |...~..TF3.bPZ..(|
-00000020  27 ed b0 5a 94 07 67 66  49 a4 54 ca a2 05 16     |'..Z..gfI.T....|
+00000000  14 03 03 00 01 01 16 03  03 00 24 ff 23 b0 21 e6  |..........$.#.!.|
+00000010  01 06 83 ac 3b f0 82 74  67 12 f5 43 63 dd a8 c7  |....;..tg..Cc...|
+00000020  21 27 82 5c ef bf 1e 5b  78 94 9a bb e3 dd c9     |!'.\...[x......|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1a b4 8a e4  10 87 52 70 fd 05 ed 37  |..........Rp...7|
-00000010  6f 12 35 91 41 58 80 63  37 cc 59 52 a2 cd 3d 15  |o.5.AX.c7.YR..=.|
-00000020  03 03 00 16 b0 38 38 37  b1 f7 af f0 3a 0d d9 ea  |.....887....:...|
-00000030  eb 32 57 ce ff 36 fc 44  94 ac                    |.2W..6.D..|
+00000000  17 03 03 00 1a ef ae ef  88 45 4e eb 6c 80 9c 0f  |.........EN.l...|
+00000010  9f aa 1d 80 e6 eb ad 51  9b e7 f7 0e 36 17 6d 15  |.......Q....6.m.|
+00000020  03 03 00 16 dd c0 76 8b  cb 4f 4a 91 4b 62 9c a5  |......v..OJ.Kb..|
+00000030  5f 68 b6 63 8c 71 86 ba  c9 b4                    |_h.c.q....|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce
index 71f3006530..4daddebd26 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 d0 8f ad 7c 5c  |....Y...U.....|\|
-00000010  c1 51 df d4 b5 9f df 51  97 c9 5e 32 63 a1 c1 51  |.Q.....Q..^2c..Q|
-00000020  04 1f 16 56 c7 0a 7e ee  4d b7 35 20 e8 5f ae 69  |...V..~.M.5 ._.i|
-00000030  a3 ad f2 2d ba d3 c5 8c  07 b1 b9 38 39 b5 ef 1e  |...-.......89...|
-00000040  7a 5e 2d f0 63 7a 60 4f  43 10 07 e1 c0 2f 00 00  |z^-.cz`OC..../..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 77 3c a8 02 e5  |....Y...U..w<...|
+00000010  54 b6 41 12 c0 c1 81 1a  c0 07 ed 06 f9 9b d3 88  |T.A.............|
+00000020  c4 14 b1 c0 c8 a9 0d d2  75 52 ce 20 7e 62 c0 0c  |........uR. ~b..|
+00000030  f5 6a be b9 76 7c e7 1b  14 46 0a 0e 54 18 73 23  |.j..v|...F..T.s#|
+00000040  71 1d 80 86 2b cb 7a 12  1f 95 fc 29 c0 2f 00 00  |q...+.z....)./..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,197 +54,189 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  cd 0c 00 00 c9 03 00 17  41 04 83 e4 35 de e3 59  |........A...5..Y|
-000002d0  fd 3c 52 7d 20 97 25 7d  1d c2 8b ad 46 af 18 9e  |.<R} .%}....F...|
-000002e0  70 d0 97 44 f0 92 c7 eb  74 2e 49 bd 32 63 2b 78  |p..D....t.I.2c+x|
-000002f0  c1 0c a9 70 31 1f a7 41  98 fb e8 71 a8 31 a7 6b  |...p1..A...q.1.k|
-00000300  53 27 34 72 e9 fd 7b f2  61 a6 04 01 00 80 26 22  |S'4r..{.a.....&"|
-00000310  53 23 07 76 1c df 3e 9a  57 15 a0 ff 9b 92 e4 6d  |S#.v..>.W......m|
-00000320  8a 8a 5a 5d a7 69 c2 09  bb 7d 1d 30 58 4e 7d 38  |..Z].i...}.0XN}8|
-00000330  de ec 97 52 eb 80 00 d6  20 cc 51 b7 3f 6c 8b 4a  |...R.... .Q.?l.J|
-00000340  f6 05 8e e5 15 63 98 24  da 10 17 dd aa 73 ab ff  |.....c.$.....s..|
-00000350  d0 55 1c cd b7 e8 fd cf  93 f1 13 62 14 e4 4a a0  |.U.........b..J.|
-00000360  bf 15 09 68 47 d7 6c 24  06 b3 62 ac c5 70 b5 6d  |...hG.l$..b..p.m|
-00000370  ae 54 95 d2 4b 49 51 3f  c6 cf 57 c5 dd 5d a5 b3  |.T..KIQ?..W..]..|
-00000380  9a bb df a6 98 43 a5 b3  65 dc 3e 15 31 e0 16 03  |.....C..e.>.1...|
-00000390  03 00 04 0e 00 00 00                              |.......|
+000002c0  ac 0c 00 00 a8 03 00 1d  20 e0 d6 30 9f b3 12 5e  |........ ..0...^|
+000002d0  62 1c 67 7d 59 18 6b 74  db b3 44 d3 6d ab ec 16  |b.g}Y.kt..D.m...|
+000002e0  c0 ed 87 af 9d 4b 08 60  47 04 01 00 80 89 b3 66  |.....K.`G......f|
+000002f0  b7 4d a9 9c c5 27 12 51  34 66 e7 47 d9 cd ac 78  |.M...'.Q4f.G...x|
+00000300  29 c8 a9 f3 77 72 a4 b0  0b 9a ed 5b 27 2c 52 fb  |)...wr.....[',R.|
+00000310  1f d0 2b cc af c2 70 df  ad 4d a9 0f 1f 3d d8 2c  |..+...p..M...=.,|
+00000320  bf b4 e9 5d 0b 52 d8 9b  c0 28 0b 4a 78 54 a8 bf  |...].R...(.JxT..|
+00000330  4e 5e 13 dc 80 35 6a cb  e1 b4 77 ac 6e 65 b5 8a  |N^...5j...w.ne..|
+00000340  1a d5 c6 a5 a5 03 ee 9f  3d 16 4a 9c b0 78 a7 71  |........=.J..x.q|
+00000350  7f f7 3c cd da 03 c4 87  3b 22 16 a4 41 c9 a2 f3  |..<.....;"..A...|
+00000360  67 7e 66 b2 97 fe 4d fb  f3 71 b7 55 25 16 03 03  |g~f...M..q.U%...|
+00000370  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
-00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
-00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
-00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
-00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 29 1e  |.....(........).|
-00000060  f5 7d 69 cf 87 63 a7 68  94 5b 63 79 ea 69 cb 18  |.}i..c.h.[cy.i..|
-00000070  93 ce c5 8a 6d 08 12 5a  25 29 b6 e3 8e d9        |....m..Z%)....|
+00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
+00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
+00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
+00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 22 f2 81  |....(........"..|
+00000040  c1 9e 57 bf 35 e0 4e 46  77 c1 c1 68 0f c5 d6 96  |..W.5.NFw..h....|
+00000050  81 4b f6 ec 43 d9 1e 49  cc 66 a2 c5 ad           |.K..C..I.f...|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 dc 61 07 b0 47  |..........(.a..G|
-00000010  de b3 54 36 57 08 d0 3b  03 8d a0 bc d5 d9 33 44  |..T6W..;......3D|
-00000020  2c e6 0e 83 d2 2b 76 68  79 40 3d bd dc 94 b3 78  |,....+vhy@=....x|
-00000030  f3 a9 90                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 28 ac 76 22 b0 0b  |..........(.v"..|
+00000010  85 4e 17 d4 d8 1d 06 39  d6 f5 e5 e8 86 39 99 15  |.N.....9.....9..|
+00000020  3a 76 a4 79 2d b1 42 82  ca c6 e5 ad 47 43 69 c6  |:v.y-.B.....GCi.|
+00000030  da ef 3d                                          |..=|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 f9 c2 34  |...............4|
-00000010  5f 2a 2d ed 0a b4 ad 06  df b0 a9 b8 d4 c0 c8 40  |_*-............@|
-00000020  86 c8 12                                          |...|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 fa e1 18  |................|
+00000010  17 c0 45 b7 78 c9 1e 1f  ae 5d 08 8e 4e a0 02 53  |..E.x....]..N..S|
+00000020  1b 13 6f                                          |..o|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 1c dc 61 07  b0 47 de b3 55 e6 b0 75  |......a..G..U..u|
-00000010  46 b3 e7 a0 f2 83 e9 18  cf 06 1d 3c 31 a2 ba a7  |F..........<1...|
-00000020  80                                                |.|
+00000000  16 03 03 00 1c ac 76 22  b0 0b 85 4e 18 dd 2d ce  |......v"...N..-.|
+00000010  3d b7 de 08 16 f8 88 9e  ed 75 25 97 d8 a5 ca c6  |=........u%.....|
+00000020  d1                                                |.|
 >>> Flow 7 (client to server)
-00000000  16 03 03 00 af 00 00 00  00 00 00 00 02 cc 27 82  |..............'.|
-00000010  46 a9 cf ee e3 94 6b 8b  a9 e2 08 e1 b9 f1 60 c8  |F.....k.......`.|
-00000020  57 46 61 c0 7a a8 d1 31  1e 6f 0c d0 5b 29 ca 85  |WFa.z..1.o..[)..|
-00000030  86 42 ba 0b df 5e d2 87  6e 86 43 3f 99 42 5d b2  |.B...^..n.C?.B].|
-00000040  65 1d f7 a8 fb 6e 93 58  c7 52 ec a6 b8 ef d7 69  |e....n.X.R.....i|
-00000050  7b 3a f4 a5 db 3b bd 2c  1a d6 8d 3b db 18 be 33  |{:...;.,...;...3|
-00000060  b1 c7 57 d3 6a 70 41 ff  86 08 ce b8 69 e8 20 29  |..W.jpA.....i. )|
-00000070  c5 42 e5 bd d0 e5 0a 90  dd fb ae cf dc f1 f5 87  |.B..............|
-00000080  24 88 bb 5d 98 8f dd 4b  c4 df 1c 8c 4c 30 19 ee  |$..]...K....L0..|
-00000090  22 7b 34 f7 e1 b7 94 38  62 35 a4 b5 24 dd bb 10  |"{4....8b5..$...|
-000000a0  47 09 18 71 7f ba fc 49  79 40 ca 98 d7 a7 53 b6  |G..q...Iy@....S.|
-000000b0  8d 07 5e 75                                       |..^u|
+00000000  16 03 03 00 b1 00 00 00  00 00 00 00 02 7d 29 8c  |.............}).|
+00000010  c6 53 bf 06 8d f4 e4 89  a1 be 0b d7 54 50 38 06  |.S..........TP8.|
+00000020  61 c6 38 bb 17 be 5d d3  cf 20 4a 1e 93 c6 ce 46  |a.8...].. J....F|
+00000030  e2 fb 7b 76 df 70 4f 9f  cb 19 65 c9 2e b7 97 fe  |..{v.pO...e.....|
+00000040  09 37 9c 41 69 a0 50 63  a9 17 46 71 11 64 47 1b  |.7.Ai.Pc..Fq.dG.|
+00000050  79 08 19 98 03 a9 a7 1a  8a 1a 50 b0 3e 95 28 8f  |y.........P.>.(.|
+00000060  51 51 56 06 c3 b6 0e db  a2 4e e2 0d 10 ab cb 6a  |QQV......N.....j|
+00000070  b5 5e 80 74 c6 c7 26 bd  58 80 13 09 c8 76 ef cb  |.^.t..&.X....v..|
+00000080  47 ac d3 a9 5f 72 dc 91  05 fa 2a b0 0e 0c 24 09  |G..._r....*...$.|
+00000090  79 27 cb d6 f4 60 29 7f  d7 1a 8e 16 a8 2e 53 ad  |y'...`).......S.|
+000000a0  af 6a d8 82 48 9f d8 97  1e f9 82 86 bc e1 8c 18  |.j..H...........|
+000000b0  fe 60 8f 7e 3d 82                                 |.`.~=.|
 >>> Flow 8 (server to client)
-00000000  16 03 03 00 89 dc 61 07  b0 47 de b3 56 aa 83 11  |......a..G..V...|
-00000010  cb 18 ad c3 f8 44 c0 d3  34 2f f1 dc 97 86 59 ec  |.....D..4/....Y.|
-00000020  f9 f6 ff dd 09 84 9a f0  7b 77 93 24 06 1d 58 6f  |........{w.$..Xo|
-00000030  80 93 9b 10 fc ad 65 22  62 4a ad 31 2d 2e 8b 17  |......e"bJ.1-...|
-00000040  f8 09 dc aa f4 67 86 db  28 14 d1 36 3c e7 60 1a  |.....g..(..6<.`.|
-00000050  4b 1e 2c f0 d6 ce 34 d6  ee 6a 5e 92 bd e5 3e d8  |K.,...4..j^...>.|
-00000060  de 7a e9 03 69 5d 28 4e  d6 7c ef 1b 4b da ed 80  |.z..i](N.|..K...|
-00000070  3c 39 17 ea 36 6a 71 2c  12 7b 63 19 4c 5d 65 b2  |<9..6jq,.{c.L]e.|
-00000080  3f 55 9b 65 86 0f 73 2a  a7 b8 a4 2e ab 83 16 03  |?U.e..s*........|
-00000090  03 02 71 dc 61 07 b0 47  de b3 57 38 03 44 38 6f  |..q.a..G..W8.D8o|
-000000a0  8b e4 93 68 fe 4b 58 09  de 5f c1 9e 6c ab bf 65  |...h.KX.._..l..e|
-000000b0  70 37 b1 12 46 e7 eb e2  86 26 67 0a 30 e9 91 09  |p7..F....&g.0...|
-000000c0  7a 4c d4 bb 01 52 5b 77  a8 61 69 5e 8b 1b 03 a6  |zL...R[w.ai^....|
-000000d0  97 7f b0 6e 71 9d d4 32  3f df 71 35 5c 83 6e bc  |...nq..2?.q5\.n.|
-000000e0  ed ac cb 54 90 d1 f6 1b  6e 15 cf 4a a5 b1 0a 85  |...T....n..J....|
-000000f0  01 0c b5 cf ae 9e 41 7e  bc 59 81 53 64 af f7 5c  |......A~.Y.Sd..\|
-00000100  f9 07 be d7 35 01 b6 1d  1e 0f 74 4e 38 5b f6 6c  |....5.....tN8[.l|
-00000110  02 74 a5 04 10 e9 6c 55  89 f6 e7 3d f7 2a a1 62  |.t....lU...=.*.b|
-00000120  3e 2d 0e c6 6d 12 0a db  95 6d 38 a0 a0 13 c8 88  |>-..m....m8.....|
-00000130  c8 7d f1 a9 9e bd 0c cb  0a af 5a 07 3d ee 5e 2e  |.}........Z.=.^.|
-00000140  74 18 ca 5b c6 f0 d3 57  9d ea fb 74 8e 6f a2 70  |t..[...W...t.o.p|
-00000150  09 69 e2 e5 92 c0 83 2e  2c df 16 9d 71 a4 29 51  |.i......,...q.)Q|
-00000160  c8 e9 13 c6 fc 2b 4b 4d  ad cf d9 0a 47 8e ae d3  |.....+KM....G...|
-00000170  0a 88 aa f8 28 be 88 dc  b1 d3 03 a0 23 7d f6 f7  |....(.......#}..|
-00000180  cd d1 81 fe b6 6a a4 7c  21 d4 c7 3d 5e 17 83 b6  |.....j.|!..=^...|
-00000190  ce cd 45 6e ed 3c d1 f3  e2 a8 68 6e 91 b1 e7 4e  |..En.<....hn...N|
-000001a0  35 60 df c7 e6 cb e2 c8  c6 2d 68 d7 4d 8c ac c3  |5`.......-h.M...|
-000001b0  71 6b 46 a0 c3 7d a0 59  22 01 ed 26 6d e2 d2 4c  |qkF..}.Y"..&m..L|
-000001c0  8c b9 94 17 18 98 96 a2  52 ec 24 b7 f3 09 5e e4  |........R.$...^.|
-000001d0  89 f8 23 f3 73 5f 3c 3d  15 67 05 c9 39 f7 71 88  |..#.s_<=.g..9.q.|
-000001e0  9e 86 18 2e ae 47 4f 3e  d7 2c fa 29 f1 c0 58 94  |.....GO>.,.)..X.|
-000001f0  5f 37 26 1c f1 87 5c b5  fb c4 4d 9e ae 17 40 7c  |_7&...\...M...@||
-00000200  fa e7 b6 e8 9c 3a 43 13  8d 3c 00 5c 72 fc 40 c1  |.....:C..<.\r.@.|
-00000210  03 0f fd 4c c0 5b d8 42  30 6b 3a 05 85 05 9d db  |...L.[.B0k:.....|
-00000220  ab 34 00 d1 cd 6f 74 eb  d3 ed 49 f8 d3 ca 35 59  |.4...ot...I...5Y|
-00000230  90 d4 93 4e 04 8d 73 13  dc 21 de 40 94 2f d6 3a  |...N..s..!.@./.:|
-00000240  aa a1 47 94 18 3b 56 18  91 18 22 e7 56 e8 6c b4  |..G..;V...".V.l.|
-00000250  9f 47 09 b1 c4 8c ba 3d  45 8f b8 82 fa 03 61 df  |.G.....=E.....a.|
-00000260  55 9a 31 a8 03 13 ab b1  b0 38 68 7d e9 3e c0 bc  |U.1......8h}.>..|
-00000270  6c d8 75 8f 4c 10 09 07  3b 7e a5 dc ec 77 02 c4  |l.u.L...;~...w..|
-00000280  8d a0 ad 30 55 4d f8 8e  06 d4 47 ea 8a 29 ee 1d  |...0UM....G..)..|
-00000290  93 fb 51 17 3d 93 ab 57  34 1f 4d 85 90 fe e4 88  |..Q.=..W4.M.....|
-000002a0  ab 4a 0f 43 c4 b7 73 70  fc fe 46 db 59 79 f3 34  |.J.C..sp..F.Yy.4|
-000002b0  d1 48 61 a7 6b 45 bc e3  b7 9e 02 ce a0 c8 a8 4f  |.Ha.kE.........O|
-000002c0  01 7e bd 96 7f c3 5e 33  d8 1b 87 7f 7f 98 dc 60  |.~....^3.......`|
-000002d0  ff f8 41 3a 7d ea 40 71  ab 6f f3 fd eb b1 49 54  |..A:}.@q.o....IT|
-000002e0  91 35 f2 49 e0 59 86 f5  7d e0 47 b1 fd 03 f0 a4  |.5.I.Y..}.G.....|
-000002f0  69 a1 27 87 ef c7 a4 e3  b9 cf 5e 81 6a c0 86 19  |i.'.......^.j...|
-00000300  e1 e9 60 d2 16 03 03 00  e5 dc 61 07 b0 47 de b3  |..`.......a..G..|
-00000310  58 c5 55 fc 9d ec dd 21  9b 1c 21 1a 02 b2 a1 34  |X.U....!..!....4|
-00000320  e3 ea 8b f6 ff 85 e1 65  3f 3d f2 df 89 56 7f 76  |.......e?=...V.v|
-00000330  56 f1 de 1e 22 90 03 f7  32 74 67 64 54 ce cd 05  |V..."...2tgdT...|
-00000340  39 b0 48 c9 d6 fd 07 bd  a3 e5 5d ea 54 68 95 23  |9.H.......].Th.#|
-00000350  72 0b ec 1b 22 b4 9e 09  98 be c7 c3 03 ce 97 95  |r..."...........|
-00000360  c0 31 d8 c1 48 b3 bc b8  76 69 19 1a 8a eb 41 08  |.1..H...vi....A.|
-00000370  c2 a2 b1 f6 fb d9 01 1e  12 22 a4 90 12 97 61 f0  |........."....a.|
-00000380  79 5b cc 82 5c 3c d0 38  28 1c 70 d2 24 f5 02 4c  |y[..\<.8(.p.$..L|
-00000390  b9 dc f3 6f 10 e7 63 7d  2a e5 7c b1 55 37 b1 37  |...o..c}*.|.U7.7|
-000003a0  b3 7d 67 d7 06 b7 83 a0  f9 e9 e5 40 f2 6a 52 ee  |.}g........@.jR.|
-000003b0  70 06 c2 92 bc 0c c3 55  ff 73 98 58 f6 c7 4d 50  |p......U.s.X..MP|
-000003c0  8b fe 69 ac ae 7e bf 7e  22 33 11 0c e3 e4 04 65  |..i..~.~"3.....e|
-000003d0  aa 71 4c 52 0b 3c a8 c3  d1 a2 77 2b 03 e7 b6 72  |.qLR.<....w+...r|
-000003e0  53 d5 c9 f2 3a 88 51 01  26 f0 15 92 ca ed 16 03  |S...:.Q.&.......|
-000003f0  03 00 42 dc 61 07 b0 47  de b3 59 a9 38 ea 5e a2  |..B.a..G..Y.8.^.|
-00000400  dc 8e 61 8a 36 8b df 7d  94 cc 9e 4d b5 e7 ed 98  |..a.6..}...M....|
-00000410  70 1f b6 05 a4 92 98 e3  81 56 ae fe cf 60 90 71  |p........V...`.q|
-00000420  7d e1 b3 52 71 2a 41 b2  88 47 3e bb f9 83 40 1a  |}..Rq*A..G>...@.|
-00000430  1b dd 4d cd e0 16 03 03  00 1c dc 61 07 b0 47 de  |..M........a..G.|
-00000440  b3 5a 6c e8 c1 8f e5 32  03 e9 2d 9f 5e b9 a1 03  |.Zl....2..-.^...|
-00000450  30 08 89 eb 60 2d                                 |0...`-|
+00000000  16 03 03 00 89 ac 76 22  b0 0b 85 4e 19 fd 36 f0  |......v"...N..6.|
+00000010  79 fd 03 a2 38 d4 84 9d  46 01 68 31 dc 70 68 14  |y...8...F.h1.ph.|
+00000020  cf 0b 63 f0 74 0c 0d 35  7c 5f 5c 32 bb b3 50 30  |..c.t..5|_\2..P0|
+00000030  91 77 a0 14 0e f1 24 26  1f 6f e3 72 46 72 f0 ef  |.w....$&.o.rFr..|
+00000040  65 47 cd a8 2e 5f 19 f6  df 54 50 9b ab ba 4f 52  |eG..._...TP...OR|
+00000050  88 0f 1c 93 ef b9 40 31  e6 a1 1f 2d 95 ae 4d 11  |......@1...-..M.|
+00000060  5c e3 8f 79 6c 78 ae 50  23 48 45 d0 8a 76 81 2f  |\..ylx.P#HE..v./|
+00000070  b1 72 9a 1b 40 41 a4 b9  a5 b4 97 d6 df b2 3e b6  |.r..@A........>.|
+00000080  d0 31 2f 50 aa 30 26 8b  b1 e8 f2 33 a8 e2 16 03  |.1/P.0&....3....|
+00000090  03 02 71 ac 76 22 b0 0b  85 4e 1a d9 dc 6b b4 5a  |..q.v"...N...k.Z|
+000000a0  87 40 43 fa cf 3f b9 f0  c1 79 99 f6 a8 5e 39 07  |.@C..?...y...^9.|
+000000b0  d9 f3 36 32 0e 99 72 e2  72 ca 2c e3 6a fc 6e 78  |..62..r.r.,.j.nx|
+000000c0  1f 3a 21 8e 79 fa 65 75  ae 2d 05 6d fc ef 07 f1  |.:!.y.eu.-.m....|
+000000d0  84 24 f6 d2 bb eb 69 38  3b 1d f5 b0 3d 1f bb 8f  |.$....i8;...=...|
+000000e0  9f 3f 10 9a 8c f8 c5 d8  bb b1 a9 2a 60 97 d6 fd  |.?.........*`...|
+000000f0  04 b5 86 1e 42 47 ec 52  b1 6c e9 53 eb 90 cf b8  |....BG.R.l.S....|
+00000100  d5 8f 6d 82 60 39 67 15  6b 29 3a 55 e6 d0 e1 11  |..m.`9g.k):U....|
+00000110  c3 f3 95 51 11 e6 2b d8  c8 50 81 ff 0f 97 9f 53  |...Q..+..P.....S|
+00000120  90 49 2d e1 bc 25 b2 3f  c7 5b 38 7f bf 16 ad 37  |.I-..%.?.[8....7|
+00000130  78 df 72 1d 58 a2 50 99  c8 37 2e 86 ab 30 7f ec  |x.r.X.P..7...0..|
+00000140  d3 3f 4d ea 7f 74 42 8b  bc 9e 01 e6 c3 50 e9 7c  |.?M..tB......P.||
+00000150  5a 40 5f e6 2a 23 02 d1  9b df ab 7c 8c c4 cc fc  |Z@_.*#.....|....|
+00000160  b8 74 1e a4 e5 8c 9e 5a  78 5a a4 64 4a 3f b4 63  |.t.....ZxZ.dJ?.c|
+00000170  4e e2 65 ae 5d 36 c7 19  5d b0 b6 66 21 79 d5 09  |N.e.]6..]..f!y..|
+00000180  53 be 87 8f 16 31 35 59  af 15 3b 36 c5 99 d8 c5  |S....15Y..;6....|
+00000190  35 59 de e0 22 86 d2 83  71 eb 7e eb c9 e0 92 4b  |5Y.."...q.~....K|
+000001a0  11 b5 42 40 83 22 73 65  5d be c5 47 7f e3 b2 15  |..B@."se]..G....|
+000001b0  a3 37 71 49 4a d8 04 ac  3e 82 63 3f 20 c0 dd d0  |.7qIJ...>.c? ...|
+000001c0  9f f3 08 dd 1c aa e3 82  c1 d5 64 c4 2e 52 8a 2b  |..........d..R.+|
+000001d0  8a 16 c0 67 f4 15 9c 20  ab 89 55 f5 7b bc 0c 9b  |...g... ..U.{...|
+000001e0  75 02 9f e5 b0 e3 6c 54  0c 44 45 69 23 4a cb b1  |u.....lT.DEi#J..|
+000001f0  e9 82 c9 54 c2 88 35 70  14 a5 40 c2 41 9e dc 92  |...T..5p..@.A...|
+00000200  b4 86 f9 a7 3f e3 db e9  ce f1 9d 50 93 85 f0 26  |....?......P...&|
+00000210  21 a6 ae ca 9e ea 16 53  09 8f ac 77 4d b6 70 db  |!......S...wM.p.|
+00000220  d7 67 3c 13 b3 ae a1 aa  82 c1 6b cd 1c a4 48 71  |.g<.......k...Hq|
+00000230  61 4b 80 3e 6a cf a7 4d  7a d5 48 40 74 e4 b5 65  |aK.>j..Mz.H@t..e|
+00000240  90 d3 4f 28 4a 64 3f 8b  5e 52 0f 36 b2 49 c2 29  |..O(Jd?.^R.6.I.)|
+00000250  8e 06 15 99 63 9a 81 90  6a 91 5c 18 71 5d 3f df  |....c...j.\.q]?.|
+00000260  90 0c 22 cd 76 d2 9d 65  d9 4e 28 da b3 84 d2 a0  |..".v..e.N(.....|
+00000270  9c e7 83 31 56 a9 62 65  28 02 7e c0 05 4f 4c 14  |...1V.be(.~..OL.|
+00000280  5a 9e 3d 89 15 75 13 20  68 fb a9 b2 c7 91 b2 8e  |Z.=..u. h.......|
+00000290  35 45 22 55 f8 76 e1 48  a2 cb 37 cd 05 a9 a8 92  |5E"U.v.H..7.....|
+000002a0  91 32 de 32 b7 7b 6a 55  88 0d d2 53 c3 7e 50 c3  |.2.2.{jU...S.~P.|
+000002b0  90 9c 97 53 e4 94 40 72  35 c2 a4 20 f8 9c 39 25  |...S..@r5.. ..9%|
+000002c0  a9 f6 a4 aa 3b 9a a8 11  30 b5 80 b3 21 4b 37 da  |....;...0...!K7.|
+000002d0  e6 50 14 ce 14 d0 81 c4  aa 05 86 f2 ac 53 b1 1a  |.P...........S..|
+000002e0  7c 8c 64 e7 36 d4 4a 5f  29 9a 43 0d 6d ef 61 ca  ||.d.6.J_).C.m.a.|
+000002f0  95 af 43 1c 29 80 e3 5b  c4 d4 8e 5d 23 80 7f 34  |..C.)..[...]#..4|
+00000300  2d f0 ab eb 16 03 03 00  c4 ac 76 22 b0 0b 85 4e  |-.........v"...N|
+00000310  1b a3 d4 e2 99 38 d2 37  38 51 5d ae 0d e1 25 53  |.....8.78Q]...%S|
+00000320  21 df 5b 96 d0 5c 9f 1c  01 4d b0 58 77 43 cb ac  |!.[..\...M.XwC..|
+00000330  14 dc b0 27 4c cf 01 4b  d8 1b d0 ba 1a 3c f2 ea  |...'L..K.....<..|
+00000340  9c ae 6f bb 28 bb d7 91  63 e4 17 3b 73 94 35 a8  |..o.(...c..;s.5.|
+00000350  0c a3 45 09 82 b6 31 bb  98 2e 77 98 4c 38 42 c9  |..E...1...w.L8B.|
+00000360  b7 c7 1c f6 7a f7 6a f4  79 37 da 6b 81 21 fc 51  |....z.j.y7.k.!.Q|
+00000370  46 0a 80 da 70 a9 00 1e  f9 b9 7d a8 9a 5f 54 7d  |F...p.....}.._T}|
+00000380  f0 0a 77 95 bd 99 01 88  81 0e 85 38 14 13 b9 14  |..w........8....|
+00000390  37 6b 32 70 63 6e 4b 51  70 ae 6f 11 20 9b 07 08  |7k2pcnKQp.o. ...|
+000003a0  e8 54 42 6f c7 65 58 2d  ad 50 fe a6 ba f8 0b ca  |.TBo.eX-.P......|
+000003b0  41 57 e1 0c fe 73 1e cd  e5 59 3b f0 6e 10 a7 63  |AW...s...Y;.n..c|
+000003c0  0d 12 d5 91 3d 59 be b6  bb 17 e6 19 c2 16 03 03  |....=Y..........|
+000003d0  00 42 ac 76 22 b0 0b 85  4e 1c 4c 28 e9 56 ec 92  |.B.v"...N.L(.V..|
+000003e0  c3 a4 ec 60 71 3d 86 20  6b 92 92 7d 0b 3d e0 d8  |...`q=. k..}.=..|
+000003f0  c8 ee fd a7 60 41 71 e3  5b 88 c1 7e 50 c5 4e 63  |....`Aq.[..~P.Nc|
+00000400  04 ab 64 ab 92 73 28 09  1c ee d6 30 69 67 f6 8b  |..d..s(....0ig..|
+00000410  a7 57 bb a0 16 03 03 00  1c ac 76 22 b0 0b 85 4e  |.W........v"...N|
+00000420  1d 20 75 d5 7c 7c 82 15  77 6f 4f 8c 97 eb a6 bd  |. u.||..woO.....|
+00000430  e6 35 27 0c e5                                    |.5'..|
 >>> Flow 9 (client to server)
-00000000  16 03 03 02 71 00 00 00  00 00 00 00 03 c8 62 78  |....q.........bx|
-00000010  36 de 67 bf c2 e0 5e 6d  d3 d5 9b 78 9d d8 a3 ee  |6.g...^m...x....|
-00000020  dc 87 9d dc f9 c4 07 a1  fa 5a 6c 5c 4a 3a 77 4d  |.........Zl\J:wM|
-00000030  5e ac 07 7a 10 f1 d4 00  3d 91 97 17 28 aa 08 61  |^..z....=...(..a|
-00000040  ad 1c 55 61 ab 2f d7 21  c5 49 48 a5 f0 5e c9 30  |..Ua./.!.IH..^.0|
-00000050  38 a3 ea ec 6b 51 8b 30  c9 e4 af b9 49 83 d3 69  |8...kQ.0....I..i|
-00000060  2a d5 97 75 c7 ec 6d 38  05 f6 a9 00 37 dd 73 bc  |*..u..m8....7.s.|
-00000070  45 a9 c2 d8 5b 55 54 93  11 4c 52 7d 0c 3b f2 50  |E...[UT..LR}.;.P|
-00000080  d7 70 c4 59 e6 42 f3 8a  45 79 15 f7 18 ce 7e d7  |.p.Y.B..Ey....~.|
-00000090  72 07 ec c7 77 2c 71 f1  38 de d4 f8 ce 80 e7 a9  |r...w,q.8.......|
-000000a0  ef 3b b4 e8 73 f4 10 ca  5b 03 f5 30 86 f1 c3 74  |.;..s...[..0...t|
-000000b0  83 ed 26 93 f3 71 35 59  58 e5 a1 be 40 14 2c 57  |..&..q5YX...@.,W|
-000000c0  8a b7 18 23 c5 e4 53 41  17 d0 a7 a7 d9 18 29 64  |...#..SA......)d|
-000000d0  48 5e 2a 70 da 1f 70 ac  3b b6 0c b2 2a da bd 38  |H^*p..p.;...*..8|
-000000e0  99 d5 cc 71 b1 2e 27 11  22 65 0d bd ca 73 dc ac  |...q..'."e...s..|
-000000f0  98 f0 48 54 c1 36 40 9e  11 87 05 77 18 31 80 09  |..HT.6@....w.1..|
-00000100  c1 1b df f8 20 cc 7b b3  80 93 fb f2 7c b7 30 32  |.... .{.....|.02|
-00000110  22 fa db af 2d 45 6e 3e  75 0d e8 85 9b ce 96 0f  |"...-En>u.......|
-00000120  99 f7 9c 4d 13 f6 08 20  ab 8a e2 f2 b7 08 3c fe  |...M... ......<.|
-00000130  2f 39 bb 9d 59 d7 14 f4  2e 94 c0 21 52 50 cf 59  |/9..Y......!RP.Y|
-00000140  0f b0 7e fa 9f 46 46 19  18 68 3a 0c ac 3b c6 79  |..~..FF..h:..;.y|
-00000150  b7 77 83 29 2d 1f 97 1d  7e 16 c6 7b 89 d0 75 45  |.w.)-...~..{..uE|
-00000160  be 7c a6 31 af e5 33 91  f1 e8 4f 5a 2c 58 e7 d4  |.|.1..3...OZ,X..|
-00000170  30 f1 19 8b 9c f5 11 3c  b1 49 78 af f1 f5 31 29  |0......<.Ix...1)|
-00000180  f0 9e 21 2d 45 a1 fb 4a  40 44 64 68 e4 2e 73 40  |..!-E..J@Ddh..s@|
-00000190  91 8d b4 a1 61 5f b7 ee  d1 87 f1 be 99 b5 b3 eb  |....a_..........|
-000001a0  1a b4 52 35 96 af 61 bd  d0 bc cd 41 8c 8b 96 3b  |..R5..a....A...;|
-000001b0  70 79 fb b0 e5 9b f6 cb  13 47 00 99 9d 87 cc 71  |py.......G.....q|
-000001c0  f2 a5 74 17 11 ba 3d 43  b0 d9 90 66 e7 0f d1 04  |..t...=C...f....|
-000001d0  8c 9d ff 4b 2d c9 1c d4  7d 6b 5f 5c d0 bb 61 a5  |...K-...}k_\..a.|
-000001e0  eb fb b1 6f 2a 25 41 aa  ef b7 92 f1 fe d7 b8 72  |...o*%A........r|
-000001f0  4e 7c f4 8a 1d fb 0e 6e  fd 39 04 93 c2 19 7e 95  |N|.....n.9....~.|
-00000200  55 62 7d c9 95 64 d2 3f  ba bd 3a 0a 3d a7 fd 2f  |Ub}..d.?..:.=../|
-00000210  70 86 a4 b6 4b c3 81 d5  fa 4a 17 6f 1f c5 e8 6d  |p...K....J.o...m|
-00000220  bc 2d 49 af f0 c8 d9 ea  62 0b 81 43 53 3c a5 79  |.-I.....b..CS<.y|
-00000230  44 ff 9e 62 78 63 de 7e  15 2a ec 91 d6 ae a3 2d  |D..bxc.~.*.....-|
-00000240  57 00 89 b2 43 06 5b bd  8c 3f ec 74 d6 b0 7d 6a  |W...C.[..?.t..}j|
-00000250  b5 c8 d0 13 e1 40 ce 3f  95 36 64 75 6d 61 e1 12  |.....@.?.6duma..|
-00000260  a5 53 90 7c 95 ef 15 40  3b ae 00 52 0c bd b5 80  |.S.|...@;..R....|
-00000270  96 e7 e2 d3 a3 d9 16 03  03 00 5e 00 00 00 00 00  |..........^.....|
-00000280  00 00 04 ed 6b 0e fe 2e  8d db a1 1b f4 2c 2a e6  |....k........,*.|
-00000290  b9 be 51 d5 8d d9 8c 09  36 ab 43 46 84 44 f0 43  |..Q.....6.CF.D.C|
-000002a0  da 85 cb c4 ab 31 a9 46  19 4a 6b c3 32 5b 32 14  |.....1.F.Jk.2[2.|
-000002b0  d5 ca 17 c7 30 aa c4 5c  17 38 f2 22 e6 8c cc 0e  |....0..\.8."....|
-000002c0  cd e6 4c b4 90 df 1a f1  04 6b ee 91 f3 29 04 ce  |..L......k...)..|
-000002d0  b7 9f 47 c6 15 9f f7 00  34 16 03 03 00 a0 00 00  |..G.....4.......|
-000002e0  00 00 00 00 00 05 15 10  0d 8b 37 50 ea 57 b2 80  |..........7P.W..|
-000002f0  99 7c 19 0a 5c 5f 2b 9d  aa 3d 07 55 b5 ad d2 e4  |.|..\_+..=.U....|
-00000300  f6 81 ac 2a 14 d7 ba f0  d9 f2 ca c5 68 b5 6b fa  |...*........h.k.|
-00000310  14 82 ee 15 a0 b4 64 53  61 83 de 32 d4 3a 94 3f  |......dSa..2.:.?|
-00000320  f5 aa 3f d6 db 95 02 55  20 1b cb 64 86 82 60 e2  |..?....U ..d..`.|
-00000330  b4 73 d2 34 b7 e5 25 aa  2d eb 4e 54 8e b6 62 d6  |.s.4..%.-.NT..b.|
-00000340  59 e4 e2 a3 55 bc c6 a7  7d bf ea 15 86 6d ff ab  |Y...U...}....m..|
-00000350  3c 66 9e 70 35 b8 e6 da  eb b8 1d 4c 42 f7 37 2c  |<f.p5......LB.7,|
-00000360  cc da 15 1c da 40 1e 8b  71 f6 1a c5 cc b1 58 d9  |.....@..q.....X.|
-00000370  3b 1e 9a 30 13 c4 5e dc  e8 66 9a 38 3d 1c 14 03  |;..0..^..f.8=...|
-00000380  03 00 19 00 00 00 00 00  00 00 06 0d be a5 be 34  |...............4|
-00000390  0d c7 d2 db 75 0a 66 e7  32 a4 60 d4 16 03 03 00  |....u.f.2.`.....|
-000003a0  28 00 00 00 00 00 00 00  00 15 8e c6 9c 8e 3e fe  |(.............>.|
-000003b0  f1 71 ff 38 df 7e 47 86  47 0e 07 93 6f 1c fc 3e  |.q.8.~G.G...o..>|
-000003c0  43 a9 55 73 14 f9 1a 03  cf                       |C.Us.....|
+00000000  16 03 03 02 71 00 00 00  00 00 00 00 03 5e 4f 6b  |....q........^Ok|
+00000010  a3 20 3b f4 1e 15 a6 69  c0 b6 c0 e4 1f e6 89 d1  |. ;....i........|
+00000020  e2 05 c1 b9 39 1c f2 a9  91 c0 5c 42 e7 04 34 85  |....9.....\B..4.|
+00000030  78 f5 17 d8 df 6a 98 c4  b8 cf 06 8c 36 7d e3 3e  |x....j......6}.>|
+00000040  e0 0b dc de ed 0b f7 fd  52 90 e2 65 34 42 e9 6e  |........R..e4B.n|
+00000050  7d 47 eb 82 ba 62 bc 44  65 a4 2d 4b 3b 7e 94 7a  |}G...b.De.-K;~.z|
+00000060  8c 87 8d 41 a9 7f 9e d4  f8 21 39 6f 1b 0e 99 91  |...A.....!9o....|
+00000070  90 5d 14 bb b4 79 9d c7  32 8d 41 63 38 11 ed 10  |.]...y..2.Ac8...|
+00000080  30 f0 62 26 a5 89 97 dc  06 68 af 91 7b 21 73 4c  |0.b&.....h..{!sL|
+00000090  77 91 84 a3 f4 6e a9 7f  9c 3a 76 49 62 9b 79 e4  |w....n...:vIb.y.|
+000000a0  a7 18 fd f7 0a 8b 3a f8  cf 04 fd f9 72 ee cc f0  |......:.....r...|
+000000b0  98 9a 17 28 27 70 8c c6  83 d6 11 96 6e 6c 3f 79  |...('p......nl?y|
+000000c0  ca b8 52 51 18 e7 e1 e3  8c 63 dd 8a 98 8f 4e 01  |..RQ.....c....N.|
+000000d0  a0 6f a7 e1 8b d6 62 f0  24 c4 1a 6e 2e 88 ba 63  |.o....b.$..n...c|
+000000e0  88 62 1b a9 54 5f 06 9f  ee f0 20 63 23 68 89 18  |.b..T_.... c#h..|
+000000f0  78 76 9f 9b 7d 2b b8 79  8b d1 02 93 06 e5 93 9e  |xv..}+.y........|
+00000100  86 cc 84 a4 fe 30 20 ac  1e 20 3e d8 a4 56 b9 a5  |.....0 .. >..V..|
+00000110  ce 95 e0 6c fa 0d 9f 74  e1 2f 22 f4 ee 34 3d d7  |...l...t./"..4=.|
+00000120  88 4d 57 5e 25 6d 9c 8f  c3 bc 37 16 2e 52 01 ff  |.MW^%m....7..R..|
+00000130  e3 c2 13 6c b1 57 3a ce  eb 93 63 81 bd 40 1f 24  |...l.W:...c..@.$|
+00000140  f3 e6 31 e0 68 38 c1 8a  37 34 d4 7d 51 23 de a6  |..1.h8..74.}Q#..|
+00000150  1a c4 14 98 11 60 8b 14  00 b8 dc 97 39 c0 0b 05  |.....`......9...|
+00000160  65 c4 ae b7 db d9 ed 31  39 93 61 d1 22 08 aa e4  |e......19.a."...|
+00000170  eb 9a a3 71 46 0d b1 3b  a5 97 45 62 e4 a8 21 c2  |...qF..;..Eb..!.|
+00000180  09 f3 95 0b 43 d1 21 5c  5b 6b d8 db 0c 49 81 c7  |....C.!\[k...I..|
+00000190  67 89 97 ea b5 87 17 da  38 d2 c9 df 7a 47 3a af  |g.......8...zG:.|
+000001a0  c6 91 19 a2 09 2c 3f 07  69 c8 ca ec 31 94 96 d8  |.....,?.i...1...|
+000001b0  b8 3e c4 bd d3 f7 63 b5  f7 6a 50 93 85 f5 8b be  |.>....c..jP.....|
+000001c0  8d 56 39 b5 6e a7 1a ef  40 cd e1 90 f0 81 95 35  |.V9.n...@......5|
+000001d0  b3 35 46 09 33 93 35 20  ed a6 ad c7 7b 34 2a 58  |.5F.3.5 ....{4*X|
+000001e0  9f 57 63 f2 b7 22 ef 88  8a bd 00 b9 25 c1 bd 93  |.Wc.."......%...|
+000001f0  d6 f3 38 5d d1 e6 fd a2  04 94 cc 4b f7 c2 f7 a5  |..8].......K....|
+00000200  1e e8 60 ec 7d 23 7b 4d  38 b6 d8 a7 9b 56 7d d9  |..`.}#{M8....V}.|
+00000210  25 f0 1b fa 59 e4 01 b0  a7 af 61 67 5f ed 9d 76  |%...Y.....ag_..v|
+00000220  01 44 ca b9 df d8 dd 27  fb 04 de c0 45 f6 5b 2a  |.D.....'....E.[*|
+00000230  9c 6f 0b f7 b4 40 74 40  86 d1 2b 3f d3 7c 55 2f  |.o...@t@..+?.|U/|
+00000240  d7 21 85 84 04 e1 99 d7  27 a5 cf b8 5c 4f 39 12  |.!......'...\O9.|
+00000250  2f b5 e1 d2 b0 67 b1 fd  86 1c a6 4c 36 77 73 31  |/....g.....L6ws1|
+00000260  ec 6d 20 dc 96 e9 6e 17  58 fa 2b da 16 de 7c c9  |.m ...n.X.+...|.|
+00000270  5d 84 89 2d 41 f2 16 03  03 00 3d 00 00 00 00 00  |]..-A.....=.....|
+00000280  00 00 04 17 b0 b2 53 3e  b3 89 72 5c 19 b1 a3 5f  |......S>..r\..._|
+00000290  74 29 a3 d2 3d ff 7f fa  13 e4 f1 3d a2 ae 1e bf  |t)..=......=....|
+000002a0  b1 1d 1e 5f 23 7e 59 93  49 06 c8 be 4e 77 bc b3  |..._#~Y.I...Nw..|
+000002b0  f8 f5 86 eb f1 12 e6 f0  16 03 03 00 a0 00 00 00  |................|
+000002c0  00 00 00 00 05 34 71 88  83 c9 a7 00 bf e5 be b8  |.....4q.........|
+000002d0  63 f8 c7 d7 05 dc 55 e9  cc 41 ab 91 26 f8 e9 8c  |c.....U..A..&...|
+000002e0  16 1f 14 be b5 df e8 96  64 2a 6e c3 e0 28 10 7c  |........d*n..(.||
+000002f0  2b b0 7d bc 5d 5f 16 a8  64 a6 33 62 60 47 1b b8  |+.}.]_..d.3b`G..|
+00000300  bd 3d 79 d3 38 77 a5 2b  09 39 44 70 59 15 2b 54  |.=y.8w.+.9DpY.+T|
+00000310  38 58 35 06 fa 4e 09 09  d1 2c 02 fd cb 12 fe 63  |8X5..N...,.....c|
+00000320  70 db 67 d9 8a 83 75 73  0d f1 63 d0 83 a7 5c 21  |p.g...us..c...\!|
+00000330  28 7e 13 bc 75 5b ec 06  32 a4 6f 6b 91 1c e4 df  |(~..u[..2.ok....|
+00000340  30 d5 29 2d 18 b8 25 2a  46 65 04 80 d3 68 1e 15  |0.)-..%*Fe...h..|
+00000350  c7 7d 25 dd d6 18 11 ae  89 6c ee f8 d8 14 03 03  |.}%......l......|
+00000360  00 19 00 00 00 00 00 00  00 06 8b 2b cb ec 40 fd  |...........+..@.|
+00000370  00 53 6d 35 a1 e9 ff ff  94 84 2c 16 03 03 00 28  |.Sm5......,....(|
+00000380  00 00 00 00 00 00 00 00  5a 79 0e fc b6 e4 6a cb  |........Zy....j.|
+00000390  ff 00 ed 25 dd db 3a 57  1c f0 04 e6 cd 45 02 39  |...%..:W.....E.9|
+000003a0  f8 59 7e 98 67 e3 20 39                           |.Y~.g. 9|
 >>> Flow 10 (server to client)
-00000000  14 03 03 00 19 dc 61 07  b0 47 de b3 5b 79 38 7d  |......a..G..[y8}|
-00000010  3f e2 f7 da 0e 9b 06 de  96 d1 81 8c c6 75 16 03  |?............u..|
-00000020  03 00 28 51 d6 d7 c6 a9  7b ba 7d 50 af 15 35 ea  |..(Q....{.}P..5.|
-00000030  02 ee 38 f0 32 9b 6a 9c  8a a6 7a 11 58 9b ba 1d  |..8.2.j...z.X...|
-00000040  c2 c4 81 5c bd 84 be c3  af a9 c9 17 03 03 00 21  |...\...........!|
-00000050  51 d6 d7 c6 a9 7b ba 7e  eb 69 5a de 10 a7 46 bf  |Q....{.~.iZ...F.|
-00000060  a4 d9 05 fb 23 79 3e 3c  96 ea 02 56 4e b1 1c e3  |....#y><...VN...|
-00000070  b0                                                |.|
+00000000  14 03 03 00 19 ac 76 22  b0 0b 85 4e 1e a3 53 2c  |......v"...N..S,|
+00000010  c7 2a d7 41 8b f3 64 9a  3b 03 5c 93 ed 8c 16 03  |.*.A..d.;.\.....|
+00000020  03 00 28 fc db 23 05 58  b4 df 03 4c 03 35 fc 9b  |..(..#.X...L.5..|
+00000030  a0 58 ce b4 10 77 ed 56  4f 6b 7a 6c a7 4d 8b 1b  |.X...w.VOkzl.M..|
+00000040  a6 7c f3 cc 6c 32 f6 64  62 f7 20 17 03 03 00 21  |.|..l2.db. ....!|
+00000050  fc db 23 05 58 b4 df 04  4f 35 64 2c 33 0e 67 9e  |..#.X...O5d,3.g.|
+00000060  2d 0b 8e 4b 70 78 c6 41  ef 3f ed f6 75 85 74 81  |-..Kpx.A.?..u.t.|
+00000070  90                                                |.|
 >>> Flow 11 (client to server)
-00000000  15 03 03 00 1a 00 00 00  00 00 00 00 01 b5 05 b2  |................|
-00000010  56 10 fb 8d fd 54 39 85  f3 a8 0f f4 10 bf 5d     |V....T9.......]|
+00000000  15 03 03 00 1a 00 00 00  00 00 00 00 01 43 67 19  |.............Cg.|
+00000010  21 e1 a7 e3 3b 35 67 49  d8 cb 5c fc 43 0b 92     |!...;5gI..\.C..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice
index 4f7ab0696c..e6b3baa8bc 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 ef 61 1c 86 c9  |....Y...U...a...|
-00000010  ee 30 91 d1 11 c7 da 05  50 0a a4 59 84 3a 7b 5d  |.0......P..Y.:{]|
-00000020  a0 12 7d 8e a7 7c 0b ad  b1 b4 24 20 04 66 50 88  |..}..|....$ .fP.|
-00000030  fd 57 a6 83 51 f9 1a b7  36 ce 96 f1 1b 08 24 95  |.W..Q...6.....$.|
-00000040  77 48 8d 53 b4 4a 17 a0  ce 21 42 41 c0 2f 00 00  |wH.S.J...!BA./..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 9d 09 7f 85 b3  |....Y...U.......|
+00000010  ad 89 88 42 6f 57 a0 c6  2e 98 22 d3 62 31 56 0f  |...BoW....".b1V.|
+00000020  b8 a6 b1 9c f9 4d 6a 55  bf a2 16 20 60 e7 ec 61  |.....MjU... `..a|
+00000030  a4 06 aa de 03 9e b0 ba  73 d2 49 f2 e8 b7 3c b9  |........s.I...<.|
+00000040  82 76 9a 4e cb bd 1d 4b  54 96 e1 34 c0 2f 00 00  |.v.N...KT..4./..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,354 +54,342 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  cd 0c 00 00 c9 03 00 17  41 04 c7 1f 36 21 38 eb  |........A...6!8.|
-000002d0  e1 da bf e3 a5 92 ef 4d  45 4c 96 70 f1 3c 50 ee  |.......MEL.p.<P.|
-000002e0  4c d7 db f7 e0 31 e3 be  60 a3 f1 f7 e3 0a ce 51  |L....1..`......Q|
-000002f0  e7 bb 87 08 62 5d 70 26  14 2c 9f de 92 7f 42 7e  |....b]p&.,....B~|
-00000300  50 04 56 b1 0c c9 e1 4a  30 a8 04 01 00 80 25 6a  |P.V....J0.....%j|
-00000310  70 ee 08 92 9d 5e 8a 80  a8 bc 8d 2d 95 30 cb b2  |p....^.....-.0..|
-00000320  a4 5b eb 60 2e 96 28 54  6b 46 89 29 5d 6c de e6  |.[.`..(TkF.)]l..|
-00000330  6f 40 9e 04 d5 7a 1a e7  7a e1 79 b0 a3 c6 37 d3  |o@...z..z.y...7.|
-00000340  83 0f 10 8d f5 2f ba 6a  ee 71 4e 2a bd 8f 30 cc  |...../.j.qN*..0.|
-00000350  8f 2f a2 87 d6 7f 53 a0  d5 a2 73 76 08 d5 79 08  |./....S...sv..y.|
-00000360  ac 88 39 8b 07 ae 4a 01  b2 64 74 82 de ab d2 5d  |..9...J..dt....]|
-00000370  33 bf 5c fe 9d 02 22 46  2f fa 9a 2f fa 57 80 52  |3.\..."F/../.W.R|
-00000380  d1 bc 6a e5 cb 59 fa cc  e2 c8 d1 80 2d 64 16 03  |..j..Y......-d..|
-00000390  03 00 04 0e 00 00 00                              |.......|
+000002c0  ac 0c 00 00 a8 03 00 1d  20 a4 dc 29 cd 8d a1 92  |........ ..)....|
+000002d0  f7 36 09 db 41 2c a4 86  28 64 ae 97 bf 72 1c f6  |.6..A,..(d...r..|
+000002e0  fa 14 d8 5f fb 90 1d a5  40 04 01 00 80 bf f1 c9  |..._....@.......|
+000002f0  e2 7a 76 1a 3b c8 9e c8  17 d7 58 c4 73 05 3b dc  |.zv.;.....X.s.;.|
+00000300  d2 6c 8c ba ff d9 ff 5e  14 9b 5a 00 66 68 c3 df  |.l.....^..Z.fh..|
+00000310  2e 37 b0 97 19 3c f4 ba  b3 44 65 30 30 62 81 58  |.7...<...De00b.X|
+00000320  61 b6 eb 19 fb 98 28 23  ab c1 f0 50 87 5e 4a bd  |a.....(#...P.^J.|
+00000330  c3 37 6f 69 1d e3 88 22  90 bb cc 08 f3 5f 4b 8f  |.7oi..."....._K.|
+00000340  71 fe 49 1e 47 e7 32 4f  f6 ee c2 5e 39 56 53 d9  |q.I.G.2O...^9VS.|
+00000350  32 36 78 0a 3e 12 24 19  65 f3 9c ed e1 24 ca 29  |26x.>.$.e....$.)|
+00000360  91 1c b5 99 5b 1e f3 0f  ab 54 18 e1 be 16 03 03  |....[....T......|
+00000370  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
-00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
-00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
-00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
-00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 8e 77  |.....(.........w|
-00000060  d5 cd 3a 36 aa 0f b8 d4  92 20 be ca 3b f5 74 74  |..:6..... ..;.tt|
-00000070  7c 89 e6 8b a2 92 56 ca  ca 91 92 f0 20 44        ||.....V..... D|
+00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
+00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
+00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
+00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 ad 88 72  |....(..........r|
+00000040  bd f8 bf df 18 6c d6 2b  d4 16 1a f7 71 a2 9c ea  |.....l.+....q...|
+00000050  ba ec 40 12 48 67 1c 05  b2 ff 1c 0a ad           |..@.Hg.......|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 f4 ab 49 aa 08  |..........(..I..|
-00000010  16 71 3b 0e fa 97 30 03  73 60 7e 73 e0 63 b4 38  |.q;...0.s`~s.c.8|
-00000020  b3 19 15 17 25 c4 f4 c1  0c b4 c9 3e e6 94 56 25  |....%......>..V%|
-00000030  3c a4 25                                          |<.%|
+00000000  14 03 03 00 01 01 16 03  03 00 28 98 d1 ca 15 41  |..........(....A|
+00000010  e6 74 f1 06 00 0a a4 a0  a6 f5 30 57 3e 2a dc d2  |.t........0W>*..|
+00000020  18 d0 f7 5c 1a 36 7d 48  4e 40 18 e5 37 63 54 9c  |...\.6}HN@..7cT.|
+00000030  c9 e3 19                                          |...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 df 72 ee  |..............r.|
-00000010  e7 65 97 48 d3 47 7a 3c  df 39 c7 29 00 14 09 41  |.e.H.Gz<.9.)...A|
-00000020  31 02 01                                          |1..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 20 22 c4  |............. ".|
+00000010  04 54 71 8c b7 b8 40 6e  88 20 99 8b ab 7f 77 c3  |.Tq...@n. ....w.|
+00000020  db 5b 4a                                          |.[J|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 1c f4 ab 49  aa 08 16 71 3c fc f2 15  |.......I...q<...|
-00000010  e0 e1 c8 dd 74 f8 33 af  25 f7 64 d1 d1 11 92 2a  |....t.3.%.d....*|
-00000020  b1                                                |.|
+00000000  16 03 03 00 1c 98 d1 ca  15 41 e6 74 f2 ed f5 22  |.........A.t..."|
+00000010  24 30 61 20 d6 0d d6 52  74 77 8d 7c 4f 94 59 c0  |$0a ...Rtw.|O.Y.|
+00000020  ff                                                |.|
 >>> Flow 7 (client to server)
-00000000  16 03 03 00 af 00 00 00  00 00 00 00 02 97 1d 91  |................|
-00000010  65 55 ce 20 d9 30 4b 94  a2 37 f3 aa 4c aa 17 69  |eU. .0K..7..L..i|
-00000020  d3 af fd 28 52 ae 91 5d  c0 bc 8c 3b 54 68 98 16  |...(R..]...;Th..|
-00000030  72 f0 65 9f ad cd 78 d0  87 af 77 49 0b d4 73 22  |r.e...x...wI..s"|
-00000040  f9 ae e7 94 f6 63 6c 00  2d 32 2c 7b a9 e5 b5 12  |.....cl.-2,{....|
-00000050  43 ea 6e 04 44 f5 4f e7  c3 a9 bf 2c 13 fe 4e a6  |C.n.D.O....,..N.|
-00000060  97 f9 12 1d 54 75 6d e7  91 db f4 01 0d 5c 2d 7c  |....Tum......\-||
-00000070  c7 1f f7 98 68 ff 67 3f  c0 81 c4 8c 84 49 a8 54  |....h.g?.....I.T|
-00000080  fa 10 d5 0c e4 09 58 ed  4e 77 9f 12 73 2c 49 76  |......X.Nw..s,Iv|
-00000090  52 7d ed 36 dc b5 36 bf  16 7c 28 53 7b e0 b8 20  |R}.6..6..|(S{.. |
-000000a0  1e 23 63 af 98 a3 95 b1  33 32 a6 26 10 33 c7 80  |.#c.....32.&.3..|
-000000b0  32 19 8f 6f                                       |2..o|
+00000000  16 03 03 00 b1 00 00 00  00 00 00 00 02 47 13 39  |.............G.9|
+00000010  b8 9c a3 ec b6 be b3 d9  0c 73 98 14 cc 58 c4 06  |.........s...X..|
+00000020  4a ae ea 14 32 31 83 8f  73 33 56 bf f1 66 2f 48  |J...21..s3V..f/H|
+00000030  2d d3 6b 71 84 13 ae 13  05 26 71 08 47 dd 44 64  |-.kq.....&q.G.Dd|
+00000040  a9 81 d4 a2 19 9b 42 86  be 39 e1 ce 71 8b bf f0  |......B..9..q...|
+00000050  7c 81 e6 bd 53 3b 20 f8  8e 07 11 09 39 d0 6e 2c  ||...S; .....9.n,|
+00000060  9f 10 7b 2a b2 5b 53 5c  1b 20 13 91 8f bb 2f 55  |..{*.[S\. ..../U|
+00000070  51 16 42 e4 d4 d0 3c 87  d5 30 20 84 5c 81 b9 83  |Q.B...<..0 .\...|
+00000080  2f 25 1c ae 38 c2 f4 6b  f6 a7 e7 4f eb c8 de 26  |/%..8..k...O...&|
+00000090  9f 16 1e d0 60 e7 8f f7  1c 92 20 69 c0 2d b2 fa  |....`..... i.-..|
+000000a0  25 c2 b1 f0 e9 8d 44 e7  73 03 79 17 82 e7 dc db  |%.....D.s.y.....|
+000000b0  b6 85 a3 a3 3e b6                                 |....>.|
 >>> Flow 8 (server to client)
-00000000  16 03 03 00 89 f4 ab 49  aa 08 16 71 3d f2 ea bb  |.......I...q=...|
-00000010  28 9b 7a b2 e3 10 07 f2  8a 9e f6 02 fe 47 fe 26  |(.z..........G.&|
-00000020  23 9c 5e 18 67 ad ec 45  94 4b 40 d4 a8 4a 11 ef  |#.^.g..E.K@..J..|
-00000030  67 07 b0 5e e3 58 bb f8  2a 46 fc 5a 0f 6c d1 d9  |g..^.X..*F.Z.l..|
-00000040  98 72 55 bd 45 15 2f 3a  87 4e 49 68 40 a8 c8 0a  |.rU.E./:.NIh@...|
-00000050  5c fb 23 32 ce 72 3a 13  6e a4 15 fa d6 53 73 77  |\.#2.r:.n....Ssw|
-00000060  36 44 86 67 b3 c8 e7 65  f0 ef 53 cc 87 91 b0 4a  |6D.g...e..S....J|
-00000070  70 01 22 62 d9 31 23 bc  b8 26 17 03 6e 02 d8 fd  |p."b.1#..&..n...|
-00000080  8a 4a 75 fc 08 58 a9 0b  50 1e 7d bf 38 3c 16 03  |.Ju..X..P.}.8<..|
-00000090  03 02 71 f4 ab 49 aa 08  16 71 3e 15 6d d8 c8 ad  |..q..I...q>.m...|
-000000a0  44 2d 49 b9 e3 e1 1b da  22 e0 65 16 a1 cd 77 17  |D-I.....".e...w.|
-000000b0  40 de 68 18 a6 af 7c 0a  e4 66 d0 30 ed 4d ca 8d  |@.h...|..f.0.M..|
-000000c0  9d a6 27 59 3e 6b 25 56  6f 47 e5 50 98 dd 53 e9  |..'Y>k%VoG.P..S.|
-000000d0  53 35 5a 76 82 f0 cb 9a  a2 98 10 fb c5 9d 43 a6  |S5Zv..........C.|
-000000e0  e7 e3 01 bf 86 2f 41 fc  fd 7e c8 d8 0e b8 a8 79  |...../A..~.....y|
-000000f0  62 53 75 1b 67 4b 8b d3  6c ba 94 28 af 31 d2 3c  |bSu.gK..l..(.1.<|
-00000100  c4 2c 2c 86 1d 1f 11 fa  f4 df 8e c4 46 22 db 26  |.,,.........F".&|
-00000110  68 4f b5 a0 87 f2 82 bb  9d 31 c0 d8 41 57 53 c7  |hO.......1..AWS.|
-00000120  4b 7f 01 43 43 28 ea bb  27 83 8d 3d 60 b9 62 b2  |K..CC(..'..=`.b.|
-00000130  66 e6 cc b5 be a3 e2 2f  a1 c8 ae 49 3c 4d b1 dc  |f....../...I<M..|
-00000140  b2 7d 30 9b dc 64 04 dc  67 61 ba 85 36 29 c7 7b  |.}0..d..ga..6).{|
-00000150  f6 bf 59 62 8d 3d 19 5d  9a ba cf 30 b6 18 0a 60  |..Yb.=.]...0...`|
-00000160  7a aa 2c a6 48 44 9c 07  18 e2 40 93 a6 4b 39 eb  |z.,.HD....@..K9.|
-00000170  b1 69 9d 0d 5c e0 9d 52  3e 47 70 fb 3b 19 34 f2  |.i..\..R>Gp.;.4.|
-00000180  01 15 e0 0c 04 9e 2e d7  b0 c7 18 b7 95 67 8c 84  |.............g..|
-00000190  61 2c f6 08 39 53 b1 29  94 ca c5 8e 70 48 18 8a  |a,..9S.)....pH..|
-000001a0  c3 36 22 c3 84 e8 55 89  ab c7 50 1e 7d ec 81 6c  |.6"...U...P.}..l|
-000001b0  3d 33 50 84 b6 e4 ef d7  e6 43 45 c0 9f e4 87 1a  |=3P......CE.....|
-000001c0  0a 67 4f f6 57 3d 0e b4  7a 0a f6 ba 69 47 85 ea  |.gO.W=..z...iG..|
-000001d0  5d 1a 55 28 3d 90 3a 6d  c5 ed ac 3c 49 ec c1 f3  |].U(=.:m...<I...|
-000001e0  a0 e4 47 99 15 72 cf a9  5e fa 78 24 5c 7e 43 f5  |..G..r..^.x$\~C.|
-000001f0  36 60 4d 0e 2e a0 83 3c  4b a1 cb 55 1b 97 4c 9f  |6`M....<K..U..L.|
-00000200  08 3c 5d c7 bd 61 b5 ad  2c db 8a 61 ea 49 fa 72  |.<]..a..,..a.I.r|
-00000210  2e 41 57 ee fc c0 35 58  c6 6f da c7 ea 58 ff db  |.AW...5X.o...X..|
-00000220  99 47 5f f2 2e 4b 19 cf  0e 72 e1 6f 14 ed 18 b7  |.G_..K...r.o....|
-00000230  7d 78 cf 69 d1 63 e5 12  84 a9 95 5d bf 8d 77 b8  |}x.i.c.....]..w.|
-00000240  e4 dc 8b fd 13 30 f4 38  6b d1 bd f8 6b 9e 14 32  |.....0.8k...k..2|
-00000250  52 b8 eb 7a 92 a6 ac f9  cb d4 ea 50 3d 53 66 25  |R..z.......P=Sf%|
-00000260  7c 26 f8 bc 87 46 f2 8b  fa 78 ec 93 74 28 03 e9  ||&...F...x..t(..|
-00000270  47 05 ec 8b 1d 70 9e f2  07 24 43 8c 2c 4b e2 0f  |G....p...$C.,K..|
-00000280  49 19 c5 68 61 a6 74 83  db c4 fe a6 e7 b2 7c 8a  |I..ha.t.......|.|
-00000290  e7 b0 f7 67 8b bc 54 7e  a1 62 37 83 23 cf c9 31  |...g..T~.b7.#..1|
-000002a0  25 9c 07 6b 74 37 08 38  82 65 59 a4 7e f5 35 ad  |%..kt7.8.eY.~.5.|
-000002b0  f3 c9 f5 32 37 e2 ee 4d  78 de 1e 59 b0 3e 81 30  |...27..Mx..Y.>.0|
-000002c0  c1 da 6b 11 ac b4 a5 b7  e6 b3 b8 df a7 42 4d b8  |..k..........BM.|
-000002d0  3b c2 a7 fe e6 66 b4 c2  dd 91 03 35 46 b5 86 6a  |;....f.....5F..j|
-000002e0  39 3f 1b 25 77 35 8c 31  7e 0b 3b 63 ed 6c 6c cf  |9?.%w5.1~.;c.ll.|
-000002f0  6f eb 8e 9f f1 dd 0d f1  36 51 92 5e a2 f5 ad 3e  |o.......6Q.^...>|
-00000300  eb d7 96 ae 16 03 03 00  e5 f4 ab 49 aa 08 16 71  |...........I...q|
-00000310  3f c6 e0 e2 9c 98 c0 71  c0 41 d3 d4 c4 03 4e a6  |?......q.A....N.|
-00000320  69 da bb 23 81 84 5f bd  39 1c 16 00 34 ad 3d dd  |i..#.._.9...4.=.|
-00000330  ee f8 03 0b 07 f4 90 68  2f 49 57 21 c3 b2 4c 00  |.......h/IW!..L.|
-00000340  fd 06 4b 7a 72 fc 50 06  26 a4 6c 44 92 61 c3 aa  |..Kzr.P.&.lD.a..|
-00000350  76 98 f8 6c c7 9f 38 b2  6c a2 26 38 b7 f3 f4 aa  |v..l..8.l.&8....|
-00000360  56 ff a3 ac 4a ce a2 a2  5e 77 dc e2 29 df e1 24  |V...J...^w..)..$|
-00000370  2c e4 b0 5b fc 7e 39 51  ee 5b 96 18 d5 d8 04 ba  |,..[.~9Q.[......|
-00000380  a1 fb a6 11 d7 27 fc 17  58 b9 e8 43 a2 ce dc 6d  |.....'..X..C...m|
-00000390  2b d6 44 6f 08 c9 37 f6  43 7a 3d dc 5c d3 55 5c  |+.Do..7.Cz=.\.U\|
-000003a0  13 09 84 4e b5 3b 6f 4f  bf e4 74 e0 cd d6 a2 c6  |...N.;oO..t.....|
-000003b0  1a d3 65 44 8f 21 a0 04  f7 97 fc a9 f7 cd 3a 01  |..eD.!........:.|
-000003c0  3c ea 95 e8 ba 1f cc 88  48 66 5e b9 a4 2b 26 dd  |<.......Hf^..+&.|
-000003d0  b5 73 54 47 4c 5c d9 fb  c6 fa db 98 6e ba 77 6f  |.sTGL\......n.wo|
-000003e0  6f d8 c6 e9 c3 e1 6b 59  b7 e0 08 16 30 4d 16 03  |o.....kY....0M..|
-000003f0  03 00 42 f4 ab 49 aa 08  16 71 40 fa e0 25 7c 6f  |..B..I...q@..%|o|
-00000400  f7 1e 5b 19 8a 31 4e 48  ce da c2 97 3a 62 85 ae  |..[..1NH....:b..|
-00000410  07 d1 27 52 1b c1 f2 48  c5 1b ee bf 72 ac 29 5e  |..'R...H....r.)^|
-00000420  8f 5f 71 f4 85 07 54 61  d0 54 31 99 d6 9b 9c 73  |._q...Ta.T1....s|
-00000430  16 93 8a 31 e2 16 03 03  00 1c f4 ab 49 aa 08 16  |...1........I...|
-00000440  71 41 70 18 29 89 1a 9e  4f 6b 8d 02 fa 91 e0 f0  |qAp.)...Ok......|
-00000450  5d 9c 9e a9 01 8d                                 |].....|
+00000000  16 03 03 00 89 98 d1 ca  15 41 e6 74 f3 d7 25 44  |.........A.t..%D|
+00000010  8b c1 d3 1c 83 97 ee b8  b8 37 dc 86 dd 19 19 82  |.........7......|
+00000020  45 23 03 e0 d1 55 bf 62  17 c8 b1 fa 7d f1 8e 3b  |E#...U.b....}..;|
+00000030  5f 34 71 81 46 53 30 29  ee 3e 2d 53 38 fd 90 8a  |_4q.FS0).>-S8...|
+00000040  d4 85 b6 5c c3 80 35 7c  8e c0 f1 5b 8a 53 4b 06  |...\..5|...[.SK.|
+00000050  6e d8 41 84 b3 3a 87 da  04 fb 56 af fe 14 4a 6e  |n.A..:....V...Jn|
+00000060  7c ac 93 2b 0d 08 4f d7  50 63 b0 31 5d 91 a6 b0  ||..+..O.Pc.1]...|
+00000070  3f 46 db ba f2 ba 37 65  e6 23 87 37 84 47 3f e6  |?F....7e.#.7.G?.|
+00000080  b2 93 f3 19 d1 3e a6 cb  b1 c0 62 4f 33 2e 16 03  |.....>....bO3...|
+00000090  03 02 71 98 d1 ca 15 41  e6 74 f4 6c e2 59 a3 1e  |..q....A.t.l.Y..|
+000000a0  f8 fb 6d 47 5f 18 58 5c  c5 67 d5 fe df f7 1c fc  |..mG_.X\.g......|
+000000b0  5d f8 74 0e 88 d8 2e 2e  50 e2 c0 b3 9d 18 73 9c  |].t.....P.....s.|
+000000c0  2c ea cf cb 52 81 74 c6  f8 af d7 5f 5c 40 96 97  |,...R.t...._\@..|
+000000d0  64 ea c1 d8 88 2c 05 2c  59 0b 20 eb d6 c2 e0 b3  |d....,.,Y. .....|
+000000e0  f8 42 c4 4d c1 5a b3 9a  c7 22 e3 66 4f 29 59 f2  |.B.M.Z...".fO)Y.|
+000000f0  ba 0c 6b 61 c4 9b a6 52  12 42 8f 7c d7 f0 4a 09  |..ka...R.B.|..J.|
+00000100  76 e0 45 52 9b 4e da 0f  80 43 16 73 5c cf 3f b0  |v.ER.N...C.s\.?.|
+00000110  e8 7a 78 a1 09 e3 89 d5  1f ff 5e d9 25 5f dc f9  |.zx.......^.%_..|
+00000120  16 f4 07 ea a1 0f e3 39  eb fe 42 22 80 7a be 49  |.......9..B".z.I|
+00000130  93 86 ed 39 e6 b6 ec 35  88 ec 02 03 a7 3d cc 21  |...9...5.....=.!|
+00000140  cf 0c 51 66 68 a9 9e a5  99 5e 6e 08 f2 38 96 35  |..Qfh....^n..8.5|
+00000150  8e e8 6f 73 92 39 39 af  ce 29 13 ed a7 53 78 26  |..os.99..)...Sx&|
+00000160  03 ba c2 dc 01 54 16 3b  d2 c3 bd cc 96 31 94 d1  |.....T.;.....1..|
+00000170  2a 97 59 8c 27 e2 3f e3  c5 69 83 81 48 27 a1 6f  |*.Y.'.?..i..H'.o|
+00000180  e6 ef a2 0b 0a ba b9 11  ed fc 0f f8 63 b9 66 55  |............c.fU|
+00000190  f4 1c 62 2b ba 11 9f 26  3a 35 b0 df 64 6f 4c 1f  |..b+...&:5..doL.|
+000001a0  9f 91 61 81 1e 8b 2c 9b  d9 7a d7 9b 2b 0c 9a 6e  |..a...,..z..+..n|
+000001b0  82 4f 31 89 ff 53 19 71  a4 74 bd 8f e4 54 fd db  |.O1..S.q.t...T..|
+000001c0  23 33 f6 b4 db d8 2b 95  f9 47 50 6b 5e 43 3e dc  |#3....+..GPk^C>.|
+000001d0  25 4d 79 06 38 4c 55 13  4f a1 27 c5 4a 47 10 5a  |%My.8LU.O.'.JG.Z|
+000001e0  a0 0e 05 dd 0d ab a8 c5  d2 3b 1f 9a 32 19 4c 4b  |.........;..2.LK|
+000001f0  c0 40 33 e8 65 8c d7 8a  25 4f f7 7c 66 d7 d9 cd  |.@3.e...%O.|f...|
+00000200  60 bf bb 9f f7 2f 93 ba  bb b0 57 b3 3a 5d 17 61  |`..../....W.:].a|
+00000210  b8 a6 5e 01 da 1a f1 d7  99 eb 33 c2 b6 b0 1d fd  |..^.......3.....|
+00000220  2d ba 6c af 51 ba 40 25  dc 52 0e de d4 9a b7 03  |-.l.Q.@%.R......|
+00000230  e2 95 a0 da 1c 0c 05 d8  77 3e 0d 47 96 9d a1 cc  |........w>.G....|
+00000240  5b ce 3b 11 26 45 52 5a  40 cb 37 27 a5 1a b3 0f  |[.;.&ERZ@.7'....|
+00000250  cb c3 cf 13 1b 86 5c 78  84 09 de d9 34 18 f1 f0  |......\x....4...|
+00000260  94 70 46 01 04 21 c5 3a  7e c2 36 70 c5 c3 aa b5  |.pF..!.:~.6p....|
+00000270  7d 27 83 19 76 07 8b 33  cf 5d 4b 16 92 22 66 b4  |}'..v..3.]K.."f.|
+00000280  a3 55 86 15 80 21 0c 8e  18 fa c7 c3 47 82 b3 fa  |.U...!......G...|
+00000290  d7 2b 86 26 6d fb f1 ca  81 37 2e 0e e0 c5 f5 4d  |.+.&m....7.....M|
+000002a0  d5 40 15 df 63 de 9e 4d  52 6f ed b4 a3 62 72 c3  |.@..c..MRo...br.|
+000002b0  3e 04 9a 5f 1e a4 74 03  bf cc 41 c9 ca cf a5 08  |>.._..t...A.....|
+000002c0  57 af b6 43 5b 32 b8 74  03 20 c0 aa 90 be 0a fd  |W..C[2.t. ......|
+000002d0  50 69 b6 33 e2 b3 69 a8  b0 ab 72 bc 22 ea be 6a  |Pi.3..i...r."..j|
+000002e0  4f 6a 62 d8 29 e4 e1 09  76 5c bd 26 ff d6 9b 95  |Ojb.)...v\.&....|
+000002f0  50 f0 d1 4c e5 70 fc 97  a9 5f b9 c6 48 bc a4 e2  |P..L.p..._..H...|
+00000300  cc ab f9 e2 16 03 03 00  c4 98 d1 ca 15 41 e6 74  |.............A.t|
+00000310  f5 d6 42 53 94 36 97 0f  18 0f 9a a9 86 8b 8a 97  |..BS.6..........|
+00000320  8a 73 11 a5 9d f0 d0 a6  a0 4f de 52 dd a0 c3 be  |.s.......O.R....|
+00000330  82 33 a7 16 f1 57 58 59  e0 d4 41 5e da 3e fc 6e  |.3...WXY..A^.>.n|
+00000340  f7 90 57 10 6b 2f 04 ff  cb 2d fe 75 3a 79 62 2e  |..W.k/...-.u:yb.|
+00000350  ba 2b e1 2b c7 89 4e 26  8d bf 5b af e8 20 e7 fd  |.+.+..N&..[.. ..|
+00000360  ca 4e f1 6f 4b 12 9c 70  47 0e 7d c5 ab 53 fe 13  |.N.oK..pG.}..S..|
+00000370  4a e4 39 c1 4b 41 68 60  c8 19 ad 38 3d eb 4c 01  |J.9.KAh`...8=.L.|
+00000380  fc 60 e1 bb c4 34 dd 33  43 2e 6b 3c 00 23 8c ce  |.`...4.3C.k<.#..|
+00000390  a8 5c 9f 20 4f 62 2a c2  9c cd 33 a6 16 7b 9c 46  |.\. Ob*...3..{.F|
+000003a0  71 7d c6 22 6a 40 57 b4  4c 67 79 32 8c 6f 40 d5  |q}."j@W.Lgy2.o@.|
+000003b0  76 ba 6e a4 76 84 72 6c  e2 96 9d 88 d2 43 a5 03  |v.n.v.rl.....C..|
+000003c0  62 b4 4f 52 95 8c 27 85  d5 bc f7 de bb 16 03 03  |b.OR..'.........|
+000003d0  00 42 98 d1 ca 15 41 e6  74 f6 36 a4 20 03 5b 37  |.B....A.t.6. .[7|
+000003e0  ea 7f 6c eb 47 8e 79 f8  ed e0 8d de 34 65 ae 01  |..l.G.y.....4e..|
+000003f0  7f c7 24 41 dc d5 3d ee  95 6c f7 32 08 59 69 e7  |..$A..=..l.2.Yi.|
+00000400  7f 8c c6 e2 50 47 ae d7  85 b2 82 4b e5 43 06 97  |....PG.....K.C..|
+00000410  18 69 5c 95 16 03 03 00  1c 98 d1 ca 15 41 e6 74  |.i\..........A.t|
+00000420  f7 9c 19 d2 d1 dd 9e 24  52 ed 31 8a 49 42 20 56  |.......$R.1.IB V|
+00000430  1e f3 b5 a6 e6                                    |.....|
 >>> Flow 9 (client to server)
-00000000  16 03 03 02 71 00 00 00  00 00 00 00 03 23 0f d3  |....q........#..|
-00000010  6c b4 ee 06 48 2f 9f 75  99 cc 94 4a 9e ff c0 4b  |l...H/.u...J...K|
-00000020  30 fa 2b bf 54 a7 f2 05  ff 63 7b 43 a3 ac 04 a3  |0.+.T....c{C....|
-00000030  71 39 57 00 2a d1 80 48  9c bf 19 12 60 35 d6 89  |q9W.*..H....`5..|
-00000040  49 c7 57 6e 7c a6 27 ab  97 f3 f6 ab 6d b9 f0 ab  |I.Wn|.'.....m...|
-00000050  7f 9a cc 06 92 22 08 44  3b 94 2b 0e 31 6a 93 96  |.....".D;.+.1j..|
-00000060  89 7f 4a 6c 06 df dc a6  1f e7 c4 7b 72 0e ed 04  |..Jl.......{r...|
-00000070  d6 c7 ff 48 b6 0c 53 fd  a8 4f 42 89 c5 97 2a 9c  |...H..S..OB...*.|
-00000080  22 1f df cc c0 cc 86 0d  ea 45 36 88 93 01 27 78  |"........E6...'x|
-00000090  ab 9c d0 59 fc 63 dd 53  04 a3 a7 21 e3 26 22 95  |...Y.c.S...!.&".|
-000000a0  f0 63 21 13 04 f7 d1 5a  6e c0 03 ef b6 9d 87 e9  |.c!....Zn.......|
-000000b0  b0 fc c2 40 4e f7 9b 25  c4 ae d4 cc 05 3a 41 5a  |...@N..%.....:AZ|
-000000c0  a3 c2 42 1e 5b 7d 6d 03  f0 e3 6a 2c 92 98 ca 46  |..B.[}m...j,...F|
-000000d0  7d 8a 11 45 1b 12 ca c9  b2 e7 e2 a2 b8 ad f7 ad  |}..E............|
-000000e0  bb 2b 70 ab 0a 87 ac 7c  f7 55 2c 5c 0e 6e 90 de  |.+p....|.U,\.n..|
-000000f0  89 1e e0 d3 a1 a5 80 b7  25 bb d4 df 35 ad ad ed  |........%...5...|
-00000100  8e e9 21 da 30 62 51 d8  8d 45 fb ee 40 dc e8 f4  |..!.0bQ..E..@...|
-00000110  f6 bd b0 ad 2f 23 6b fc  62 4d 51 8f 30 c2 b8 c2  |..../#k.bMQ.0...|
-00000120  2b 16 dc 86 cf 19 b4 aa  48 9b b6 c5 3b 15 29 c4  |+.......H...;.).|
-00000130  a0 7f 40 74 89 95 ba 62  b5 13 ed 69 99 a5 8c 9d  |..@t...b...i....|
-00000140  d2 2d bc 2c c1 db 4d 4d  c8 f5 94 8b 5b ad 0d a9  |.-.,..MM....[...|
-00000150  51 52 a9 c5 85 7a b6 48  4d 44 92 1e 51 53 af 64  |QR...z.HMD..QS.d|
-00000160  39 4b c1 ad d8 e4 43 19  c7 e6 ec 44 33 31 01 89  |9K....C....D31..|
-00000170  40 e3 93 22 3c 97 42 0f  8e 49 3a ca a4 08 ca 02  |@.."<.B..I:.....|
-00000180  96 2b 83 3b 5d 1e 98 9c  f9 ec 31 6e 03 8d 52 56  |.+.;].....1n..RV|
-00000190  9f 8a d6 2b a6 bc 99 89  f1 c2 76 f4 fa 56 f1 9f  |...+......v..V..|
-000001a0  1c d8 4f bd e2 9b af 02  bb f7 71 ba 27 85 e0 9a  |..O.......q.'...|
-000001b0  c9 30 09 d0 ce 4f 06 80  a7 29 34 a8 eb 52 49 a8  |.0...O...)4..RI.|
-000001c0  b9 7d de b2 51 5f f9 d9  84 52 73 03 60 db ee 97  |.}..Q_...Rs.`...|
-000001d0  b9 ca da e5 f1 4b 38 c6  36 eb 25 8e 62 59 7a 8a  |.....K8.6.%.bYz.|
-000001e0  e9 59 0f 41 30 8d 33 64  1a 1a ee 0d 79 1c da 53  |.Y.A0.3d....y..S|
-000001f0  f4 e1 04 2e 5b 6a cb 4f  0a b6 3a b1 76 49 41 cb  |....[j.O..:.vIA.|
-00000200  1d 59 0d 1d a6 89 22 ee  33 60 2b 7f a8 43 3a c7  |.Y....".3`+..C:.|
-00000210  26 65 1b 56 54 83 09 6d  ec 08 ef db bd 61 71 ee  |&e.VT..m.....aq.|
-00000220  2e 49 00 0b cf 89 e9 d5  48 a3 c1 6a b7 6c e1 6a  |.I......H..j.l.j|
-00000230  1a d1 f1 f7 03 25 4a 98  48 9b 59 eb 8e b4 b1 4b  |.....%J.H.Y....K|
-00000240  0f 0b 35 6d c1 e2 8e b9  96 35 dc da 2f 53 21 45  |..5m.....5../S!E|
-00000250  7a d0 3d 8e 20 99 f3 22  e0 e4 33 83 95 04 6a 4c  |z.=. .."..3...jL|
-00000260  91 fc 0c 90 57 dd b9 9c  19 37 5e d4 2e cd ff 34  |....W....7^....4|
-00000270  22 44 d3 d1 69 13 16 03  03 00 5e 00 00 00 00 00  |"D..i.....^.....|
-00000280  00 00 04 53 f5 4d 21 83  84 9c 36 8e ce 3b 27 8c  |...S.M!...6..;'.|
-00000290  9f fd 85 28 56 09 c6 99  a2 af cc 7d 2d af 85 79  |...(V......}-..y|
-000002a0  78 3d f4 88 cd 60 89 40  a2 e4 bb f2 ae 45 53 48  |x=...`.@.....ESH|
-000002b0  6d e9 ca a2 36 7d 25 01  38 e9 77 01 1d 05 b0 58  |m...6}%.8.w....X|
-000002c0  5b da 87 c5 5c df 7e b0  f6 6d a7 38 8a 63 a3 43  |[...\.~..m.8.c.C|
-000002d0  60 18 40 7b 5b c1 05 92  b5 16 03 03 00 a0 00 00  |`.@{[...........|
-000002e0  00 00 00 00 00 05 8b df  bf 56 8b 21 81 b1 7d 55  |.........V.!..}U|
-000002f0  89 e7 b6 c7 2e 68 6d 05  e3 d3 af 31 ef be a2 db  |.....hm....1....|
-00000300  1d d2 ec f0 8e db a4 76  cb 42 df 29 1d 4d 86 c1  |.......v.B.).M..|
-00000310  e4 32 f2 a1 f6 4a c3 82  70 f8 cf a5 41 af 44 b5  |.2...J..p...A.D.|
-00000320  47 c9 6e ee 75 38 44 08  a7 81 f6 da d6 68 c9 53  |G.n.u8D......h.S|
-00000330  e5 2f f0 a9 0f db 5d 4b  d0 4c 01 e4 e3 a1 2f a7  |./....]K.L..../.|
-00000340  99 75 1c 3e 7a 47 f0 78  ef 61 f2 d6 da 0f c0 08  |.u.>zG.x.a......|
-00000350  03 6f 13 3c a5 d2 24 18  c2 6a db 58 e1 d4 8a 27  |.o.<..$..j.X...'|
-00000360  78 a6 e0 ec 9b e9 5f 94  b8 48 f2 bc e6 29 d4 60  |x....._..H...).`|
-00000370  89 ed 79 52 ce 95 5c b3  c4 81 cf 9d cb 5b 14 03  |..yR..\......[..|
-00000380  03 00 19 00 00 00 00 00  00 00 06 46 6b 4e 92 89  |...........FkN..|
-00000390  d3 45 bf 20 0b 7a 6a 0d  71 8f eb 06 16 03 03 00  |.E. .zj.q.......|
-000003a0  28 00 00 00 00 00 00 00  00 68 c4 4c 4f 17 4a 4d  |(........h.LO.JM|
-000003b0  73 fe 0a b8 a2 2f e4 8a  d6 62 d7 40 ca 04 83 22  |s..../...b.@..."|
-000003c0  41 c9 1f 8f f2 44 bb 88  32                       |A....D..2|
+00000000  16 03 03 02 71 00 00 00  00 00 00 00 03 3c 02 ab  |....q........<..|
+00000010  79 07 da ce 77 c0 2f 8d  8e 8f 9d 3c 31 9d fc 91  |y...w./....<1...|
+00000020  92 bc 88 b1 e7 3a ad 80  f5 ea 4f 61 85 ff 51 e1  |.....:....Oa..Q.|
+00000030  0a 97 fe e5 cc bb 05 88  4d e3 01 88 30 03 2b 7c  |........M...0.+||
+00000040  3d ab 9a c4 bf da cc 60  38 cd c0 e0 9f 10 d0 38  |=......`8......8|
+00000050  ac b5 68 52 f2 31 b8 12  90 c3 9d 2d 81 7c 6d d8  |..hR.1.....-.|m.|
+00000060  3c 92 a8 a2 df 08 fe 59  fa 44 38 d5 5a f4 5f 10  |<......Y.D8.Z._.|
+00000070  d9 ba 93 a8 fc 25 64 18  52 8e 14 e7 e9 02 5f 6a  |.....%d.R....._j|
+00000080  ee a6 7f 9a 56 60 fc 38  a3 fa f3 58 6b e1 21 98  |....V`.8...Xk.!.|
+00000090  67 9b 21 81 bb 62 55 8a  6a 23 54 38 89 9a 56 2e  |g.!..bU.j#T8..V.|
+000000a0  4c 11 ed 62 33 36 1d 86  92 72 05 63 b1 1f 2d f4  |L..b36...r.c..-.|
+000000b0  59 57 9b 3b 5a cb ab 57  c9 8a 02 da 25 a9 41 97  |YW.;Z..W....%.A.|
+000000c0  26 1b b1 3e 80 ff b8 2c  17 28 46 22 f3 6d 73 f6  |&..>...,.(F".ms.|
+000000d0  d1 59 73 73 a9 4a e9 6b  60 7f 2d 02 4a b3 f9 27  |.Yss.J.k`.-.J..'|
+000000e0  97 40 50 be 4d 2c f8 b4  ef e7 ac 37 dd 09 c8 ef  |.@P.M,.....7....|
+000000f0  95 9b fd 7e ef 4d bc c0  98 f3 60 04 7a bf fc f4  |...~.M....`.z...|
+00000100  c8 48 cf 4a ab a0 7d 2f  97 09 0f 11 28 6d 97 d3  |.H.J..}/....(m..|
+00000110  4e b4 8f 89 16 f6 f4 6a  d4 cc bb b4 06 47 7d b9  |N......j.....G}.|
+00000120  b4 ae bf 82 02 d3 2c 7b  c0 cc 58 8c f8 88 a5 6f  |......,{..X....o|
+00000130  e3 2c 74 ad 29 a3 3e c5  5d d2 62 01 c6 a3 0c d2  |.,t.).>.].b.....|
+00000140  d1 fd cc c3 52 97 97 07  6f 87 a2 ae 8f 47 4e c6  |....R...o....GN.|
+00000150  5a ac 35 a2 d1 e0 bb de  fc c3 62 b6 e5 53 fb 09  |Z.5.......b..S..|
+00000160  1f a9 fb 41 d3 47 63 2b  f2 e6 a4 a8 47 f5 fb 41  |...A.Gc+....G..A|
+00000170  f1 f5 31 a3 04 ff 1f 5e  f0 e9 9e ad 13 34 de cc  |..1....^.....4..|
+00000180  97 28 e3 bd c4 2f d0 8b  05 50 34 14 82 05 5b ff  |.(.../...P4...[.|
+00000190  ac a2 08 08 9e 68 39 e8  9b 68 e4 f5 67 c0 15 7c  |.....h9..h..g..||
+000001a0  07 15 51 9e 99 bd fe e7  e6 77 a4 ef d9 61 a1 bf  |..Q......w...a..|
+000001b0  ac 66 79 7f e0 d2 e9 48  34 82 56 8f 17 e3 7b 11  |.fy....H4.V...{.|
+000001c0  47 9b b0 c9 14 73 2e d6  8c c2 9a f5 06 96 13 0f  |G....s..........|
+000001d0  9d 2e 10 06 e6 49 2a 73  14 8b 5c 92 83 a0 65 2a  |.....I*s..\...e*|
+000001e0  8a 44 83 cf d0 6a c1 09  42 fa f3 f4 cd d5 58 cf  |.D...j..B.....X.|
+000001f0  e2 aa 4e f5 01 56 2d 52  c5 84 96 af 2d af 79 41  |..N..V-R....-.yA|
+00000200  9f 39 96 54 27 64 93 e0  dd be 0a 08 dd 65 d6 38  |.9.T'd.......e.8|
+00000210  f1 c6 db 40 6b f5 b7 05  86 f6 f2 31 7e 87 ed 07  |...@k......1~...|
+00000220  58 55 9a 0a f9 a0 c1 32  18 f3 34 ad a5 f5 71 37  |XU.....2..4...q7|
+00000230  1b a2 f6 ed 9f 03 ad 68  4f 5d 43 5a a7 a9 46 8e  |.......hO]CZ..F.|
+00000240  2f d9 8c 9c d5 b9 04 57  4b b1 df 16 ec 6d 79 6e  |/......WK....myn|
+00000250  f2 6b ea 91 f8 ca 36 09  0e 1a ac e7 71 db 8c 26  |.k....6.....q..&|
+00000260  cd 6c 94 92 38 26 34 2d  87 b4 86 91 16 ff 4d a6  |.l..8&4-......M.|
+00000270  b1 a7 49 8d 45 8e 16 03  03 00 3d 00 00 00 00 00  |..I.E.....=.....|
+00000280  00 00 04 d2 19 0e 9e 8f  9a f8 e4 ff 12 43 94 ca  |.............C..|
+00000290  d0 f0 6e 04 ee a2 ce 85  10 82 d5 a9 eb 68 8f b4  |..n..........h..|
+000002a0  c5 b1 f6 3d 5b 2b f2 6b  2d c9 47 11 69 33 86 ef  |...=[+.k-.G.i3..|
+000002b0  5e 64 6c 47 1d 3b 0a 5e  16 03 03 00 a0 00 00 00  |^dlG.;.^........|
+000002c0  00 00 00 00 05 af 3b d3  9b dc eb 85 66 b9 5a 29  |......;.....f.Z)|
+000002d0  ca b9 ad a5 52 31 2e 11  21 b8 b9 93 5e 69 7a 65  |....R1..!...^ize|
+000002e0  b9 68 d2 b1 4e d9 28 ea  d6 70 0e 7d 02 f7 d7 fc  |.h..N.(..p.}....|
+000002f0  86 0b d3 fa 48 8f 84 2e  1a b9 94 59 43 27 39 e8  |....H......YC'9.|
+00000300  ed 53 22 57 5d 75 1a 8c  b5 71 01 83 08 a3 56 d8  |.S"W]u...q....V.|
+00000310  a0 b8 cd 58 95 ca 6a c2  44 73 f3 a2 67 83 a1 be  |...X..j.Ds..g...|
+00000320  ec 33 58 b9 fd 24 8a c2  b2 93 18 70 05 04 3c 70  |.3X..$.....p..<p|
+00000330  60 b3 6f e4 9f 31 01 82  be 86 5b b4 9a 57 84 6d  |`.o..1....[..W.m|
+00000340  08 4a a6 23 0d 73 48 15  34 32 f6 0f a2 a6 d6 24  |.J.#.sH.42.....$|
+00000350  95 fe b0 0d e7 f1 bf 2e  14 c8 af 59 5a 14 03 03  |...........YZ...|
+00000360  00 19 00 00 00 00 00 00  00 06 d7 0d 95 8b 51 4b  |..............QK|
+00000370  ee e9 14 c0 ca 96 29 cf  21 80 1c 16 03 03 00 28  |......).!......(|
+00000380  00 00 00 00 00 00 00 00  7c 2b d1 a3 a4 f7 6a a3  |........|+....j.|
+00000390  c1 da 0a 0f 8f 85 b0 01  1d 19 fc 90 c7 16 1d 8e  |................|
+000003a0  58 06 ed 0f f3 b5 3c fd                           |X.....<.|
 >>> Flow 10 (server to client)
-00000000  14 03 03 00 19 f4 ab 49  aa 08 16 71 42 9d 75 f7  |.......I...qB.u.|
-00000010  35 40 8d b7 01 de 6a 81  bf ed fa d1 85 fa 16 03  |5@....j.........|
-00000020  03 00 28 7a 20 c2 1d 3e  3c 2d 69 ac 93 5b b6 dc  |..(z ..><-i..[..|
-00000030  d9 08 e8 80 9c 10 7d d0  d7 64 55 d8 7e af f6 a0  |......}..dU.~...|
-00000040  98 7c 16 99 24 ba 9d d3  96 43 a4 17 03 03 00 21  |.|..$....C.....!|
-00000050  7a 20 c2 1d 3e 3c 2d 6a  63 af 4e e0 22 3a 61 68  |z ..><-jc.N.":ah|
-00000060  2c c3 d7 7b c9 80 46 51  cf 8b b0 af 02 3c 5d a9  |,..{..FQ.....<].|
-00000070  3a 16 03 03 00 1c 7a 20  c2 1d 3e 3c 2d 6b 24 26  |:.....z ..><-k$&|
-00000080  da ff 4d 39 fb 70 85 9d  25 e2 23 ef af bb 27 93  |..M9.p..%.#...'.|
-00000090  c0 f5                                             |..|
+00000000  14 03 03 00 19 98 d1 ca  15 41 e6 74 f8 13 8f 65  |.........A.t...e|
+00000010  bb f3 00 de 62 15 71 01  b1 bd df 37 f6 e4 16 03  |....b.q....7....|
+00000020  03 00 28 25 6e 41 dc 6a  a3 2a 95 39 fc 36 e6 70  |..(%nA.j.*.9.6.p|
+00000030  c6 e5 55 e5 ac 96 04 f1  a2 47 30 b6 10 98 aa 38  |..U......G0....8|
+00000040  79 1d 3f 29 b8 5c 1a b6  6e c8 0f 17 03 03 00 21  |y.?).\..n......!|
+00000050  25 6e 41 dc 6a a3 2a 96  3f e3 66 d8 ca 28 36 ff  |%nA.j.*.?.f..(6.|
+00000060  4a 95 5e a8 31 a3 2d 75  fd d1 80 a4 db 0b 25 ec  |J.^.1.-u......%.|
+00000070  73 16 03 03 00 1c 25 6e  41 dc 6a a3 2a 97 df f5  |s.....%nA.j.*...|
+00000080  9b 44 0e 0c f2 55 ec ed  1a 50 ba d4 70 96 cc fa  |.D...U...P..p...|
+00000090  5e a6                                             |^.|
 >>> Flow 11 (client to server)
-00000000  16 03 03 00 af 00 00 00  00 00 00 00 01 ac bb 56  |...............V|
-00000010  33 88 ab 77 b9 93 64 7b  8d 42 bf 2e 65 36 60 07  |3..w..d{.B..e6`.|
-00000020  f2 d4 22 2a 75 ac 04 9e  11 48 85 ef 96 09 ae a3  |.."*u....H......|
-00000030  af 37 7f 4c 01 5e 3a e2  0f 72 b2 77 40 56 a6 c2  |.7.L.^:..r.w@V..|
-00000040  26 19 f2 67 8e a6 92 91  6f f6 59 5e ec 2e 35 3a  |&..g....o.Y^..5:|
-00000050  1e 03 e3 50 99 8f a3 ba  82 30 3c 24 83 55 9f be  |...P.....0<$.U..|
-00000060  4b 0b a7 86 64 42 25 0d  80 1c 88 e2 a3 c8 3e 6d  |K...dB%.......>m|
-00000070  de 43 46 4e 37 61 32 63  b4 af 77 d1 ba 77 c9 69  |.CFN7a2c..w..w.i|
-00000080  11 4a a8 fd 9d be 8d d8  dc 8e ea f5 12 52 c9 c2  |.J...........R..|
-00000090  c3 34 a0 72 55 34 87 21  aa 93 79 34 64 17 0e 02  |.4.rU4.!..y4d...|
-000000a0  37 a0 9d ea 1b c2 71 4b  46 c7 5e 0a 84 b2 57 d6  |7.....qKF.^...W.|
-000000b0  5e 31 8f c1                                       |^1..|
+00000000  16 03 03 00 b1 00 00 00  00 00 00 00 01 2e 2c 48  |..............,H|
+00000010  d4 db 08 b2 af c8 68 92  e4 17 d2 b7 cd 56 50 7e  |......h......VP~|
+00000020  ef 8d 7e 0d 14 15 3f e4  12 ec aa 9a ad dd 1c 81  |..~...?.........|
+00000030  5d 5e 79 75 82 0f f6 50  ad 81 33 c3 1d 3c c2 6c  |]^yu...P..3..<.l|
+00000040  6a 2a b7 29 0a e7 ee cf  02 12 39 80 96 47 5e 28  |j*.)......9..G^(|
+00000050  6f 38 e1 52 b9 bb 6b 9a  c9 fa df dc 0d a2 12 1b  |o8.R..k.........|
+00000060  20 f8 2f 94 1a 43 5b ec  b4 e6 0b ef 4d 4d 5e ef  | ./..C[.....MM^.|
+00000070  18 04 54 96 94 9f e6 77  90 30 13 0b 20 00 23 33  |..T....w.0.. .#3|
+00000080  d4 6b fe cb 4d dc 5c b9  e7 7c 43 14 03 f9 ce 11  |.k..M.\..|C.....|
+00000090  07 e2 fd f5 86 ba f4 1f  61 16 86 db c9 78 f8 2a  |........a....x.*|
+000000a0  90 11 56 1e d3 97 33 b0  3a e4 e3 bd 70 d1 89 58  |..V...3.:...p..X|
+000000b0  41 1b a2 d2 77 59                                 |A...wY|
 >>> Flow 12 (server to client)
-00000000  16 03 03 00 89 7a 20 c2  1d 3e 3c 2d 6c c8 b4 49  |.....z ..><-l..I|
-00000010  38 99 74 59 97 53 30 1c  b3 a0 cd d0 01 33 53 cc  |8.tY.S0......3S.|
-00000020  84 f3 db 3b c2 92 6b c0  6e 46 62 04 66 0d 32 cb  |...;..k.nFb.f.2.|
-00000030  72 22 db 95 66 ce ff a6  1f 43 03 05 2d da 47 b1  |r"..f....C..-.G.|
-00000040  34 67 aa 3f eb a5 fa da  c5 2f c1 43 04 62 9e 70  |4g.?...../.C.b.p|
-00000050  9f 07 d1 0d 8c 5b c0 b0  32 2f 2e d3 26 cf 1d 18  |.....[..2/..&...|
-00000060  c6 dc 42 f2 a5 4f d8 64  03 24 17 7c 83 b9 64 1c  |..B..O.d.$.|..d.|
-00000070  33 9b d1 87 59 f8 f4 f5  87 ce 47 f1 59 fe db 78  |3...Y.....G.Y..x|
-00000080  a2 1c ee 71 bb 00 41 cc  0d a0 89 0a b1 aa 16 03  |...q..A.........|
-00000090  03 02 71 7a 20 c2 1d 3e  3c 2d 6d f1 4d 60 35 28  |..qz ..><-m.M`5(|
-000000a0  a5 5f 97 2b 51 5b b2 02  7b b7 eb 23 15 20 02 a0  |._.+Q[..{..#. ..|
-000000b0  a3 fd 7b 90 29 f8 98 2e  d7 6f 05 70 bd 5b 64 d3  |..{.)....o.p.[d.|
-000000c0  aa 67 54 e0 04 b1 7a 5c  5a 4d bb e7 e6 29 34 66  |.gT...z\ZM...)4f|
-000000d0  81 6e 71 94 28 22 90 db  24 c3 c9 bb 9d fb 3b 4c  |.nq.("..$.....;L|
-000000e0  7f fe ba ad 69 ca 87 26  e6 bd 29 5b e2 a7 75 8a  |....i..&..)[..u.|
-000000f0  e5 00 bc 6a 51 42 ff 1f  5b ff a0 b7 e2 0f 9d e6  |...jQB..[.......|
-00000100  b6 62 ff 7d f4 58 a9 98  3e 4d 53 c0 d0 e3 c4 ac  |.b.}.X..>MS.....|
-00000110  46 6f e1 b7 68 5f 5f 90  c2 0b a6 85 9d bf ec 84  |Fo..h__.........|
-00000120  b4 7e 35 91 e0 19 b2 06  f0 55 b6 e4 23 78 a7 c8  |.~5......U..#x..|
-00000130  76 a0 a5 e6 b1 59 fd da  04 bd 49 51 8f 3b 67 37  |v....Y....IQ.;g7|
-00000140  75 73 84 75 b5 88 1c 11  5b 48 be e3 3d db 7e 3c  |us.u....[H..=.~<|
-00000150  9d 1e 95 41 56 67 d2 98  06 36 7f 83 3c 25 a2 4c  |...AVg...6..<%.L|
-00000160  5d 93 b2 75 a3 89 7c a0  e5 bf 2e 21 58 d4 25 ff  |]..u..|....!X.%.|
-00000170  00 e2 01 60 50 33 5c 70  ca a2 20 d6 67 d4 b2 cb  |...`P3\p.. .g...|
-00000180  90 2f 9b 86 4f 1f c5 a4  6d ec 82 60 5b 56 70 7f  |./..O...m..`[Vp.|
-00000190  94 be 72 1a 44 6b 6b 08  e7 5e d4 cb c0 4b b2 cb  |..r.Dkk..^...K..|
-000001a0  ac e8 a9 3e 28 ce b8 9b  93 6b c2 67 4c b7 ad 87  |...>(....k.gL...|
-000001b0  19 d2 c0 b4 5b 29 82 22  10 f0 d0 04 b0 2e 46 fc  |....[)."......F.|
-000001c0  90 c3 d5 0e d1 b6 61 74  ae 4d f2 90 14 51 d3 6f  |......at.M...Q.o|
-000001d0  df cc bb ed bc f9 9b 2b  63 62 bf 08 09 7d 10 31  |.......+cb...}.1|
-000001e0  b8 05 ad f6 ee d5 e5 5c  6e b9 1f 73 c8 bc 9d 33  |.......\n..s...3|
-000001f0  8d b1 1e d3 5b 8f bd ea  b9 8c 02 05 f8 84 ff b7  |....[...........|
-00000200  bd d5 2b ce f4 f9 c7 92  7c 4b 62 17 18 3d 72 40  |..+.....|Kb..=r@|
-00000210  66 cf 8a 02 d0 fa 90 30  62 1d 6d ba 9f b6 53 6c  |f......0b.m...Sl|
-00000220  40 3d e7 eb 2e 88 06 67  8d 53 d9 84 66 a0 c5 9d  |@=.....g.S..f...|
-00000230  60 31 21 40 13 17 10 c2  89 1b 39 8f cd 0f 27 7f  |`1!@......9...'.|
-00000240  d0 84 3e 78 ce 9b 91 5d  8c 67 30 a3 30 e1 77 f5  |..>x...].g0.0.w.|
-00000250  7b 86 6b f4 01 26 c2 46  73 49 1b 69 e0 24 9d 8d  |{.k..&.FsI.i.$..|
-00000260  b2 0b 8b 80 28 05 3e d4  09 e2 f6 90 1f 7f 50 d0  |....(.>.......P.|
-00000270  86 d4 f1 ce a9 4f 2f 3a  4d 9d 72 2c 2d e9 d0 d8  |.....O/:M.r,-...|
-00000280  a3 cb 28 16 f3 1d 11 41  1c c7 92 2d e0 c2 ba 0b  |..(....A...-....|
-00000290  57 86 84 93 d7 a9 51 43  2f d1 df c8 f0 ef e6 b4  |W.....QC/.......|
-000002a0  31 43 c2 1f dc 7c 30 3e  5c b6 6f d7 37 0c de 0f  |1C...|0>\.o.7...|
-000002b0  43 76 6d cd da fb 2a 57  17 9c 0f 53 d1 e5 ce 61  |Cvm...*W...S...a|
-000002c0  00 dc 4b 0f 90 70 3b b6  1c a3 38 1d 5e 0d b1 3d  |..K..p;...8.^..=|
-000002d0  40 15 ec eb 6f ed c9 c6  c5 26 ae da 46 b5 00 6a  |@...o....&..F..j|
-000002e0  68 1e 9d b7 4e 42 a5 a3  4d 8d bc 5e 52 cc a3 44  |h...NB..M..^R..D|
-000002f0  e3 72 86 be 70 d2 cf 11  3a 5f 25 dc 3a b3 e3 ee  |.r..p...:_%.:...|
-00000300  31 45 4b cc 16 03 03 00  e5 7a 20 c2 1d 3e 3c 2d  |1EK......z ..><-|
-00000310  6e 40 dd 3e 1f d0 91 3e  bd 15 68 cb 36 24 40 16  |n@.>...>..h.6$@.|
-00000320  25 71 38 95 f3 ba c6 63  ae aa 29 7a e2 f8 1d 1b  |%q8....c..)z....|
-00000330  79 5f 5a 19 9f 4b eb 30  cf ad f0 72 e8 b4 2a a4  |y_Z..K.0...r..*.|
-00000340  e0 d6 c1 44 b6 05 e2 ba  e7 6e fc 9d 82 59 d1 a6  |...D.....n...Y..|
-00000350  f9 2a bb 15 a8 bd e5 61  e4 7f 8c 17 38 d9 34 0d  |.*.....a....8.4.|
-00000360  21 b5 80 78 7e a6 03 af  af 9d 83 c9 41 d9 89 04  |!..x~.......A...|
-00000370  b7 06 65 33 d4 2b 97 75  a4 8b d5 63 0e c9 06 d6  |..e3.+.u...c....|
-00000380  06 c1 fe ce 96 dc c8 3b  0d 18 02 d4 e7 7e e6 c8  |.......;.....~..|
-00000390  f4 da b0 0f 1b 1c 49 73  b3 85 70 2e 43 d3 89 42  |......Is..p.C..B|
-000003a0  ac 7f 56 69 fd 85 d8 a7  60 90 37 02 b0 c3 fc 87  |..Vi....`.7.....|
-000003b0  10 04 f5 e6 29 a6 24 61  d2 ec ba 6b e9 02 94 b0  |....).$a...k....|
-000003c0  c7 3c b5 9b 74 7e d7 e1  78 ce b2 4d 0c ef 7c cc  |.<..t~..x..M..|.|
-000003d0  c2 a5 32 d3 3b 9a b4 df  07 7a c4 c6 55 bd 95 e1  |..2.;....z..U...|
-000003e0  40 24 5f 92 63 7f 38 ff  6f fb fa 61 1b f3 16 03  |@$_.c.8.o..a....|
-000003f0  03 00 42 7a 20 c2 1d 3e  3c 2d 6f 34 89 7c 3a 9a  |..Bz ..><-o4.|:.|
-00000400  75 0b 68 6b 7e eb 87 c1  30 27 0f 9e 4f 9d 58 f4  |u.hk~...0'..O.X.|
-00000410  27 38 c0 d7 cf 4f 8d 74  7b 18 1f b3 b7 51 16 aa  |'8...O.t{....Q..|
-00000420  53 e8 bc 43 3e 40 1a a4  da 6f b0 57 92 a7 37 4f  |S..C>@...o.W..7O|
-00000430  70 fd f1 bc 77 16 03 03  00 1c 7a 20 c2 1d 3e 3c  |p...w.....z ..><|
-00000440  2d 70 ee 59 90 0a c3 b1  25 e7 67 51 10 b6 9b 06  |-p.Y....%.gQ....|
-00000450  6b 71 66 d2 aa e8                                 |kqf...|
+00000000  16 03 03 00 89 25 6e 41  dc 6a a3 2a 98 ae d6 7c  |.....%nA.j.*...||
+00000010  58 19 84 e4 2d 04 bb 86  f2 9e e6 31 23 18 25 9f  |X...-......1#.%.|
+00000020  67 f7 13 ab 3b cb 50 a6  3f 55 fd 55 1f ea cd 49  |g...;.P.?U.U...I|
+00000030  5a ff 31 be 53 73 07 10  28 cd 22 29 3e 85 6c c7  |Z.1.Ss..(.")>.l.|
+00000040  c3 f8 c0 48 ce 97 17 33  4c 39 71 d9 f6 08 a2 9b  |...H...3L9q.....|
+00000050  a7 4b 4d d3 df a4 28 9d  47 a4 72 7c a1 dd 13 23  |.KM...(.G.r|...#|
+00000060  13 c5 46 5b cd 6f 9a 34  d9 0f ac 3d da 91 af 8a  |..F[.o.4...=....|
+00000070  c7 0a 7b de 25 ad aa 97  dc 7f 48 5a e2 0e f5 4a  |..{.%.....HZ...J|
+00000080  a7 75 8b 18 9e 2e a3 2e  95 b5 70 4a 47 e7 16 03  |.u........pJG...|
+00000090  03 02 71 25 6e 41 dc 6a  a3 2a 99 a7 b3 a9 44 0a  |..q%nA.j.*....D.|
+000000a0  b6 2b fa 58 6e 64 2a 55  5e 2c 37 ac de 8c 46 18  |.+.Xnd*U^,7...F.|
+000000b0  81 38 ec b6 d7 07 a7 82  a8 cc 02 8b 52 81 54 9c  |.8..........R.T.|
+000000c0  66 4d d8 0a a5 72 37 0d  53 a2 eb f6 c7 ed 2c da  |fM...r7.S.....,.|
+000000d0  d8 70 ab 8a 10 d5 e6 58  ea f8 0b 55 1d 4f f1 e5  |.p.....X...U.O..|
+000000e0  f9 00 f7 ee 81 a3 8e 8f  21 70 34 10 bc 98 72 de  |........!p4...r.|
+000000f0  8f aa 87 b6 02 75 1a 0f  5d b1 0e 98 1f 49 83 aa  |.....u..]....I..|
+00000100  4f 43 49 65 3f 2e f2 d0  d1 8f b2 ab e1 e4 2d 75  |OCIe?.........-u|
+00000110  2d 4f c7 75 fd 78 aa d7  31 97 b9 dc a6 62 c5 e6  |-O.u.x..1....b..|
+00000120  8d a9 73 f8 2c 14 4c a7  f3 ca ed 98 0e c7 99 51  |..s.,.L........Q|
+00000130  a5 e1 bf af f6 6f 25 fc  6e 71 f3 c9 a1 38 f7 bc  |.....o%.nq...8..|
+00000140  3f f5 29 61 60 26 f2 d4  32 30 6c 09 7d c0 f8 af  |?.)a`&..20l.}...|
+00000150  63 d9 d3 5b e6 c8 af fb  0a 56 ca 61 3f 0c f6 1f  |c..[.....V.a?...|
+00000160  9a 07 2b 8c b0 30 db 2e  e4 b4 82 ad 10 fa 13 88  |..+..0..........|
+00000170  13 06 d3 d6 68 0d 60 ab  d2 24 4b a7 70 ca bb f5  |....h.`..$K.p...|
+00000180  14 ab dc a2 c0 a3 27 98  c4 ba 16 76 4c fb ed 10  |......'....vL...|
+00000190  55 a8 2d 72 80 de d3 72  34 6c 40 46 00 d9 7f 37  |U.-r...r4l@F...7|
+000001a0  2b d7 33 cd e6 78 12 b9  68 56 b8 a9 e9 0c 17 7a  |+.3..x..hV.....z|
+000001b0  66 6a a7 06 d6 de b0 75  9e 9f bf ab 9a 59 b0 7c  |fj.....u.....Y.||
+000001c0  2a 5a d1 af f9 91 dc da  54 95 88 37 2d 05 9a a1  |*Z......T..7-...|
+000001d0  66 32 54 21 32 5f dc 7a  1e 34 36 46 db 46 00 68  |f2T!2_.z.46F.F.h|
+000001e0  11 38 38 13 cb f5 eb d1  57 ed f0 41 02 59 20 c9  |.88.....W..A.Y .|
+000001f0  75 2e bc 65 4c 38 d2 fc  c5 45 6f fa 15 39 44 cf  |u..eL8...Eo..9D.|
+00000200  63 25 c6 06 55 4b 34 af  4c af 0e da cd 1e 25 b5  |c%..UK4.L.....%.|
+00000210  ba 83 1b a4 5a 8d 53 81  3b 51 03 d4 ca 23 cb 03  |....Z.S.;Q...#..|
+00000220  31 97 40 67 98 4b 4c 01  af e2 76 34 b8 b7 3d 64  |1.@g.KL...v4..=d|
+00000230  79 f5 c9 6e bd 9c f2 85  fc 00 70 88 23 66 60 b9  |y..n......p.#f`.|
+00000240  76 fb 14 b6 f1 8d 17 bd  f2 60 97 72 79 85 a5 99  |v........`.ry...|
+00000250  f2 c9 e8 cc ae 41 e8 f4  4b ac b7 0b 41 bb 87 f9  |.....A..K...A...|
+00000260  4d 61 03 b4 b9 cd 5d fb  33 37 7a 5e 3b b3 05 cb  |Ma....].37z^;...|
+00000270  2d bb 71 31 ef 6c 34 93  cd f0 ce fa ce 28 82 c1  |-.q1.l4......(..|
+00000280  1f 9b ec 14 fa 72 77 1b  0b c1 7a 79 97 bd 2d e8  |.....rw...zy..-.|
+00000290  d0 91 02 fe 34 92 34 c4  6f 22 02 99 d6 0e 91 2f  |....4.4.o"...../|
+000002a0  36 2b 61 80 c1 27 c6 6f  71 a0 87 80 f4 8e 7c 65  |6+a..'.oq.....|e|
+000002b0  4e 21 f5 a4 50 5d e4 6a  e4 19 1b b9 0f 88 bb 3f  |N!..P].j.......?|
+000002c0  67 7e c5 b1 7f 99 a6 f2  d9 c6 9b de dd 62 b9 d3  |g~...........b..|
+000002d0  d7 40 05 4a 04 49 a8 3e  84 5b a0 bd d4 b6 2a 15  |.@.J.I.>.[....*.|
+000002e0  19 8f a9 37 9d d1 1f 18  be 46 51 1a 47 ac 89 63  |...7.....FQ.G..c|
+000002f0  5f af 59 ce 05 b3 97 11  b9 a9 c1 a4 89 03 06 ad  |_.Y.............|
+00000300  ff c9 ce 01 16 03 03 00  c4 25 6e 41 dc 6a a3 2a  |.........%nA.j.*|
+00000310  9a f9 98 ae dd 3e ac c5  c9 19 fe 6a 0e a4 4a 03  |.....>.....j..J.|
+00000320  16 e1 d3 fd c3 3a de e5  25 f3 b6 92 fe d4 00 c2  |.....:..%.......|
+00000330  21 25 15 fe a9 5f 74 92  6a 61 90 47 f5 cc ac 9a  |!%..._t.ja.G....|
+00000340  f1 a1 ae 47 77 66 b1 66  9d c4 9f 85 75 c7 7f 3a  |...Gwf.f....u..:|
+00000350  df 78 08 17 a0 a4 35 34  69 af c1 9e d6 f4 9b 1d  |.x....54i.......|
+00000360  54 e7 99 cf f0 d5 99 bd  ae 44 d3 3a 3a d2 b3 4d  |T........D.::..M|
+00000370  10 0e 3f 06 5b 31 c2 a5  23 b1 a2 df 7d 7b 8e fb  |..?.[1..#...}{..|
+00000380  d0 76 b5 5e 38 1e 3e 3a  61 4d 56 cb 43 48 d2 be  |.v.^8.>:aMV.CH..|
+00000390  ec 3b cf 05 52 24 5a cb  a5 3a d4 b6 33 e8 f1 25  |.;..R$Z..:..3..%|
+000003a0  89 72 68 ed 95 9e f9 f9  69 f2 fb 2b 93 35 8f 78  |.rh.....i..+.5.x|
+000003b0  42 13 29 33 9f 79 5c 22  e6 f5 d0 e3 61 da 0e a0  |B.)3.y\"....a...|
+000003c0  1a d4 c2 03 ad ed 11 d0  ec 40 c9 76 27 16 03 03  |.........@.v'...|
+000003d0  00 42 25 6e 41 dc 6a a3  2a 9b 57 3a 29 5f 04 91  |.B%nA.j.*.W:)_..|
+000003e0  df 00 15 50 55 f2 e5 93  58 e8 0a e2 41 3c 3f 34  |...PU...X...A<?4|
+000003f0  a0 95 b5 72 d6 a8 70 3b  f6 5b 1c 5f 1f b6 0e 04  |...r..p;.[._....|
+00000400  15 cf d2 e9 a1 40 ca 76  e4 1a 6e 80 0f 03 b9 f2  |.....@.v..n.....|
+00000410  7e c2 e6 d7 16 03 03 00  1c 25 6e 41 dc 6a a3 2a  |~........%nA.j.*|
+00000420  9c ec f9 ef 1c 18 dd 59  ee cb a1 fd ec da 67 b1  |.......Y......g.|
+00000430  27 02 27 49 d5                                    |'.'I.|
 >>> Flow 13 (client to server)
-00000000  16 03 03 02 71 00 00 00  00 00 00 00 02 6f 24 b6  |....q........o$.|
-00000010  bf d6 f9 08 28 0e 73 38  ac 9f 2f cd 67 94 f1 cc  |....(.s8../.g...|
-00000020  90 29 42 a9 39 d6 c4 eb  ca ad a6 e0 70 4b 57 30  |.)B.9.......pKW0|
-00000030  67 fc 7f 96 17 0c 9e cb  8b 4e ad 29 68 6d d9 f7  |g........N.)hm..|
-00000040  ec 39 31 a3 1e ec 26 57  f0 18 42 be 5a df 9e 3d  |.91...&W..B.Z..=|
-00000050  89 34 9c 4d c4 aa fe ae  14 ea 67 15 ca d1 f5 c1  |.4.M......g.....|
-00000060  6d c7 25 d2 b5 6e f3 c6  a9 69 19 c9 d2 8a fc c5  |m.%..n...i......|
-00000070  c5 10 14 cd 30 e2 a6 20  9d 53 32 68 8d f1 d4 d6  |....0.. .S2h....|
-00000080  ea eb 5f 3e 08 24 57 02  65 73 f5 8c 6b d2 67 1d  |.._>.$W.es..k.g.|
-00000090  8b ec ed c5 a2 52 f3 05  c2 96 a6 4c a4 cf e6 c3  |.....R.....L....|
-000000a0  83 8c 24 34 75 d9 07 df  13 e6 14 98 74 6b 1c 30  |..$4u.......tk.0|
-000000b0  3f 2a f8 90 f0 3b 56 5e  d8 2f ce e9 bc a9 42 b1  |?*...;V^./....B.|
-000000c0  ca 35 09 1d 5c 54 a9 53  76 a5 3c 77 16 0e f9 a8  |.5..\T.Sv.<w....|
-000000d0  a1 e0 74 39 6a f3 2b 6c  92 de 33 1b 71 e9 59 2f  |..t9j.+l..3.q.Y/|
-000000e0  7f 5b e5 b4 c3 b7 03 0b  9c 20 94 1e 65 b0 3e 77  |.[....... ..e.>w|
-000000f0  c5 13 f1 e5 83 40 2d 90  f2 e1 52 e7 8d 98 00 15  |.....@-...R.....|
-00000100  9f 0f 99 1a 0d 6e 65 cc  79 7e a7 2e 49 0f 86 e8  |.....ne.y~..I...|
-00000110  a7 e5 06 b4 55 50 30 5c  1f ac 43 a7 9b 8a 80 ff  |....UP0\..C.....|
-00000120  6c 83 3a 42 45 b4 92 69  b4 4a c4 d7 d4 e0 e0 d4  |l.:BE..i.J......|
-00000130  3b cc 1d c6 27 c1 f2 07  a4 f8 cc 6f 2b 9a 3f de  |;...'......o+.?.|
-00000140  f4 1b 8d 51 73 45 ad b4  03 5e 86 02 3a 7c 03 ce  |...QsE...^..:|..|
-00000150  92 a1 8f 71 b1 8a 57 05  1b 54 21 e4 c9 af 32 96  |...q..W..T!...2.|
-00000160  a6 2f df ee e0 54 9f 3f  ba ee fe d0 75 7d 51 92  |./...T.?....u}Q.|
-00000170  81 59 9a 8c 56 35 7f 2d  ee 65 d8 9c 13 2b 3b b2  |.Y..V5.-.e...+;.|
-00000180  1d cd 66 0c 7d 3c 74 b4  7f 97 59 17 46 8f 75 50  |..f.}<t...Y.F.uP|
-00000190  f5 c6 d0 77 ad e7 06 b1  c8 5b 30 fd 9c a0 ac 5f  |...w.....[0...._|
-000001a0  c5 d4 e8 20 21 00 a7 f5  b3 f4 8a 7f eb a2 00 61  |... !..........a|
-000001b0  45 b9 2b 40 f6 9a a6 7f  52 da 94 14 4c 7c d6 e9  |E.+@....R...L|..|
-000001c0  49 68 ed da 90 01 69 cb  f4 dc 55 41 cd 66 16 ed  |Ih....i...UA.f..|
-000001d0  18 e9 e7 1f 02 bf d2 ec  66 12 ff e4 7d dc e2 d8  |........f...}...|
-000001e0  90 ba b7 73 e7 9d 96 77  aa 9c c6 af 62 0c 5c b1  |...s...w....b.\.|
-000001f0  57 0a 03 e4 44 58 7f b3  79 b0 4f f2 78 90 64 d3  |W...DX..y.O.x.d.|
-00000200  41 f4 56 56 30 0c 57 04  8f 11 bd c4 cc b3 9d cb  |A.VV0.W.........|
-00000210  13 a7 81 78 bf cf ed 2d  cc 5c 09 54 ba 36 e7 e0  |...x...-.\.T.6..|
-00000220  a6 42 e8 c1 f7 bd 14 d0  e8 a7 50 71 1f a4 e0 b0  |.B........Pq....|
-00000230  6d d6 98 76 19 0e 2f e3  ad c4 82 04 9e 8a 4a f6  |m..v../.......J.|
-00000240  31 57 01 9b c5 f6 b6 56  7a cb 39 fa 3c 97 52 1c  |1W.....Vz.9.<.R.|
-00000250  88 8d 3c e4 98 d1 72 9a  51 9e d5 36 fd 44 7b 6f  |..<...r.Q..6.D{o|
-00000260  37 c4 76 4b 1f 3a 1f d2  e8 b0 d6 78 29 e8 4a 42  |7.vK.:.....x).JB|
-00000270  6b 83 08 e8 6f 09 16 03  03 00 5e 00 00 00 00 00  |k...o.....^.....|
-00000280  00 00 03 0e 1c a5 6c c1  72 32 d4 eb 06 53 0d 41  |......l.r2...S.A|
-00000290  93 e1 f8 db 43 b3 45 d2  f5 6d 67 32 55 9d 33 1d  |....C.E..mg2U.3.|
-000002a0  fb 12 fe 48 0f e5 a4 83  f0 73 c1 35 03 ea a0 4d  |...H.....s.5...M|
-000002b0  f6 3d d9 31 0b 70 55 52  ba 9d bb f5 8a d3 f3 cd  |.=.1.pUR........|
-000002c0  17 28 24 72 3d 2b fa 57  0a 3a 50 b3 27 91 d5 d2  |.($r=+.W.:P.'...|
-000002d0  a7 5d 99 88 71 98 e9 79  1f 16 03 03 00 a0 00 00  |.]..q..y........|
-000002e0  00 00 00 00 00 04 9f be  d5 6d ea ba e7 46 f1 c5  |.........m...F..|
-000002f0  10 27 c2 47 4c 2a 45 3e  fe 4c 90 e2 3b 8f c5 cf  |.'.GL*E>.L..;...|
-00000300  df d6 93 40 10 65 77 0d  d0 97 1d af 22 8a 48 9f  |...@.ew.....".H.|
-00000310  ba 43 19 19 4a 50 d3 b4  4a f8 70 39 fe b8 39 af  |.C..JP..J.p9..9.|
-00000320  6e d8 e9 3e 33 5d a4 b5  37 a9 88 87 06 4e b8 9f  |n..>3]..7....N..|
-00000330  67 9b 0a fc ec e4 cf 7b  cc 41 6a a3 20 f8 ae 9d  |g......{.Aj. ...|
-00000340  6f f9 85 a9 77 c9 5c 7b  31 75 85 b9 43 a8 cc 5f  |o...w.\{1u..C.._|
-00000350  c1 47 bd 31 15 61 3b ac  8d 2b 92 56 33 12 a8 fa  |.G.1.a;..+.V3...|
-00000360  be 42 03 5f 57 6e 40 63  3f f8 87 d1 4a 5c 11 99  |.B._Wn@c?...J\..|
-00000370  7d 31 cd 13 95 44 e1 a4  22 9b 58 64 6a 25 14 03  |}1...D..".Xdj%..|
-00000380  03 00 19 00 00 00 00 00  00 00 05 c1 fa 7d 26 1e  |.............}&.|
-00000390  2c 71 d5 c8 76 2a 6e 69  58 55 b9 7c 16 03 03 00  |,q..v*niXU.|....|
-000003a0  28 00 00 00 00 00 00 00  00 81 7a 4e 36 a5 96 c0  |(.........zN6...|
-000003b0  9f 46 6e 29 1a cb 06 cd  62 4d a3 14 6c 59 e6 e0  |.Fn)....bM..lY..|
-000003c0  4a ca 84 cb 07 28 5d 1f  a1                       |J....(]..|
+00000000  16 03 03 02 71 00 00 00  00 00 00 00 02 a7 99 f2  |....q...........|
+00000010  84 7b 66 b5 68 75 59 8b  2e 69 af bd 1d da 7a 72  |.{f.huY..i....zr|
+00000020  58 ad ba c4 9c 4b f2 80  96 ea e5 8a ba 67 75 f2  |X....K.......gu.|
+00000030  80 1f 4d b9 89 dd 4e 0e  60 5b 09 58 43 45 51 19  |..M...N.`[.XCEQ.|
+00000040  ae e7 92 49 85 09 2d 98  42 fc c5 4c ae 73 e8 1f  |...I..-.B..L.s..|
+00000050  93 b0 02 b6 cf 69 12 70  08 07 15 1d 46 3d 15 c9  |.....i.p....F=..|
+00000060  71 67 77 0b fc e9 14 5c  08 a6 7e 68 e7 ad 2b 22  |qgw....\..~h..+"|
+00000070  58 ba 95 28 82 2b 9f d4  3a 24 3a 82 08 1c 69 62  |X..(.+..:$:...ib|
+00000080  e3 cd 1d c6 06 d8 5f a0  c4 90 e7 22 89 69 de 13  |......_....".i..|
+00000090  9b 53 db c6 de d0 98 0e  e9 b3 6b 35 ba 5b 3f 9d  |.S........k5.[?.|
+000000a0  e6 d1 2b 0e e8 bd 83 a9  ed 7b 3a 8c 52 fb 74 17  |..+......{:.R.t.|
+000000b0  68 76 8b a7 00 0e 25 69  be 4d e9 90 2d 84 ff 6e  |hv....%i.M..-..n|
+000000c0  fb 3a 63 03 cd 4c 63 a8  99 db a9 4f e8 4f 03 66  |.:c..Lc....O.O.f|
+000000d0  b5 7c f0 06 b3 98 70 51  8c f1 ad cf 08 13 3c cb  |.|....pQ......<.|
+000000e0  87 69 7f 16 0e 9d b1 bc  eb 5f 28 df 44 c4 7c 36  |.i......._(.D.|6|
+000000f0  e9 78 85 08 6b 59 26 ed  9f ed e1 be f7 05 7e 21  |.x..kY&.......~!|
+00000100  cc 6a 14 17 86 a1 47 f5  90 20 49 84 16 e4 af 62  |.j....G.. I....b|
+00000110  00 e2 43 97 65 f6 17 c2  17 94 28 0f 86 c9 e6 6b  |..C.e.....(....k|
+00000120  f9 ac 9d 69 9c fe e3 c1  1a a3 11 0e ab 50 14 d3  |...i.........P..|
+00000130  9e 55 37 80 b3 bc 41 6d  dd 8f 3b 78 ff 37 da 65  |.U7...Am..;x.7.e|
+00000140  af 38 3a b2 50 67 79 46  d1 a5 d9 c3 42 ba 53 be  |.8:.PgyF....B.S.|
+00000150  4c 68 4e f7 33 5a 08 95  9c cc ca 9f ea 43 c4 20  |LhN.3Z.......C. |
+00000160  22 e4 34 1e 83 d2 db 0d  cb f9 c5 86 b0 73 88 a4  |".4..........s..|
+00000170  eb 23 2c e2 a5 9d de f9  54 57 29 40 10 49 5d 5b  |.#,.....TW)@.I][|
+00000180  81 52 42 89 b3 02 31 c1  6e 85 3b ad fb 69 7f cb  |.RB...1.n.;..i..|
+00000190  f2 29 59 43 3a 67 f5 61  d2 40 8c 21 22 41 2b fd  |.)YC:g.a.@.!"A+.|
+000001a0  bc 3f ac 68 66 55 7b 27  81 bf 3f 31 37 ac 4e 86  |.?.hfU{'..?17.N.|
+000001b0  0f e5 02 4c f1 00 ed a0  f9 0d aa a0 d1 0e f1 93  |...L............|
+000001c0  8e 34 4d 52 97 18 87 16  04 84 f0 5e 3a 2f 47 58  |.4MR.......^:/GX|
+000001d0  fb 91 cb b7 60 a9 50 30  44 cf 67 ae 9c b6 a0 65  |....`.P0D.g....e|
+000001e0  54 ef 6d 06 d3 02 ba 62  bf 16 ab b9 ff 89 19 c2  |T.m....b........|
+000001f0  77 20 13 ec 88 45 97 04  94 c6 7c 16 c2 83 df 34  |w ...E....|....4|
+00000200  5e 2e 5f d9 ee 96 ce e2  39 6f 4b 44 95 be 31 7b  |^._.....9oKD..1{|
+00000210  91 3b 1d c5 a7 e2 7a a4  b0 de 8a 1f bf e4 81 5d  |.;....z........]|
+00000220  99 72 ed f2 b0 a3 3a 87  ff 89 69 11 a8 13 de 37  |.r....:...i....7|
+00000230  ff af 84 e4 1a e3 c3 b5  e5 88 c6 0c d1 41 3e 2a  |.............A>*|
+00000240  52 4c 7c 2a 7d 3b ba 05  99 0c 53 18 04 ca 22 a2  |RL|*};....S...".|
+00000250  f8 27 7d e3 80 f7 fa 11  58 af 97 25 cd 64 e7 73  |.'}.....X..%.d.s|
+00000260  e1 b5 b6 43 8e 58 70 ea  ba c8 41 80 44 2f 8f 9a  |...C.Xp...A.D/..|
+00000270  ad 6e aa 94 46 2d 16 03  03 00 3d 00 00 00 00 00  |.n..F-....=.....|
+00000280  00 00 03 4e a3 b3 f0 40  ba e4 ec 9a 5f 74 01 67  |...N...@...._t.g|
+00000290  eb 84 7e f9 b9 e5 6c 26  3a 65 98 27 89 5b 09 c4  |..~...l&:e.'.[..|
+000002a0  f4 dd e1 c4 10 fe 89 09  83 57 3a c1 33 d4 85 12  |.........W:.3...|
+000002b0  1d 3e 18 0d 8f 51 b2 b5  16 03 03 00 a0 00 00 00  |.>...Q..........|
+000002c0  00 00 00 00 04 10 6f 74  0f 87 52 8b d6 9e 39 0e  |......ot..R...9.|
+000002d0  66 06 ac 12 71 6b 49 49  52 36 f9 f7 80 f1 0c e0  |f...qkIIR6......|
+000002e0  58 f0 6b 88 e4 ef 6b cf  83 d1 6c 85 fc 39 1d bd  |X.k...k...l..9..|
+000002f0  2a 9f ae 5b 27 6b e3 f0  d8 21 57 54 67 1c 35 d3  |*..['k...!WTg.5.|
+00000300  6a d3 c3 1b 2c c3 95 03  4b ef cc 03 76 ff 4a 2b  |j...,...K...v.J+|
+00000310  35 b7 86 09 2e 42 3c 59  43 92 4d 27 f7 3a f1 1d  |5....B<YC.M'.:..|
+00000320  8d 32 a5 0d bd ff 97 76  8d b9 21 13 4a 74 93 96  |.2.....v..!.Jt..|
+00000330  66 e8 d4 f9 5a 36 6c 6f  d3 89 08 1b bc f1 6e 80  |f...Z6lo......n.|
+00000340  2b 09 41 01 62 d6 51 60  1e a8 39 3d 05 94 7b 65  |+.A.b.Q`..9=..{e|
+00000350  a4 ea f3 7b 09 e8 09 b8  a6 6c 78 a0 c9 14 03 03  |...{.....lx.....|
+00000360  00 19 00 00 00 00 00 00  00 05 7f 9c 56 2b 82 35  |............V+.5|
+00000370  df 72 ee 34 8f 22 d7 d4  eb 1d 38 16 03 03 00 28  |.r.4."....8....(|
+00000380  00 00 00 00 00 00 00 00  fd 40 5f 2a 85 2c e9 5e  |.........@_*.,.^|
+00000390  2f eb aa ef c9 bf 22 31  b8 ea ee 1e 31 e1 07 60  |/....."1....1..`|
+000003a0  62 65 38 a9 93 f8 bd 1d                           |be8.....|
 >>> Flow 14 (server to client)
-00000000  14 03 03 00 19 7a 20 c2  1d 3e 3c 2d 71 89 d6 e0  |.....z ..><-q...|
-00000010  81 c6 82 a7 40 2f 3e 1e  8c e3 e1 8f dc a2 16 03  |....@/>.........|
-00000020  03 00 28 a2 41 d8 86 76  bd 14 82 e7 6a f4 24 2b  |..(.A..v....j.$+|
-00000030  f3 c0 96 9c f0 70 75 11  c8 bc 9c c9 69 95 31 6f  |.....pu.....i.1o|
-00000040  09 7d 55 09 c7 81 0d d5  36 58 bf 17 03 03 00 21  |.}U.....6X.....!|
-00000050  a2 41 d8 86 76 bd 14 83  ff 94 3c e4 8f 4a 25 7a  |.A..v.....<..J%z|
-00000060  45 65 88 77 e6 87 dc 63  29 8f 44 67 70 0d 25 0f  |Ee.w...c).Dgp.%.|
-00000070  de                                                |.|
+00000000  14 03 03 00 19 25 6e 41  dc 6a a3 2a 9d e9 bc 46  |.....%nA.j.*...F|
+00000010  a3 41 4d c3 59 d7 93 dd  27 08 d0 f7 d9 03 16 03  |.AM.Y...'.......|
+00000020  03 00 28 be d9 c1 5c b1  b4 75 8a af 62 82 c0 09  |..(...\..u..b...|
+00000030  2c 06 b4 5e 65 17 ed 62  95 5b d0 9f 2c f1 37 3d  |,..^e..b.[..,.7=|
+00000040  5f 07 4c b0 08 0c de 4d  c1 3e b5 17 03 03 00 21  |_.L....M.>.....!|
+00000050  be d9 c1 5c b1 b4 75 8b  d3 5b c4 8f 86 fd 68 41  |...\..u..[....hA|
+00000060  9e 0b bb 83 9e 94 31 d1  fa 10 0b 1a e5 0e 50 ae  |......1.......P.|
+00000070  5d                                                |]|
 >>> Flow 15 (client to server)
-00000000  15 03 03 00 1a 00 00 00  00 00 00 00 01 26 a8 f1  |.............&..|
-00000010  b6 ae af 74 3b 31 70 08  49 cd 85 ab f4 82 3d     |...t;1p.I.....=|
+00000000  15 03 03 00 1a 00 00 00  00 00 00 00 01 89 01 4f  |...............O|
+00000010  91 3f 59 58 b0 05 a0 5e  9d 93 29 87 17 72 88     |.?YX...^..)..r.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected
index 387637e2bf..74d6378074 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 8e 2b 17 9a cb  |....Y...U...+...|
-00000010  44 bb cc 82 0f 8f 7e 90  52 0b ee 44 99 25 2d c8  |D.....~.R..D.%-.|
-00000020  47 ae b6 15 36 69 0d f5  b8 6e 38 20 f6 94 68 6b  |G...6i...n8 ..hk|
-00000030  1a 51 d8 1a bb 24 68 7e  05 bf e6 bd 20 82 f0 19  |.Q...$h~.... ...|
-00000040  f3 e7 7a 06 23 8d a1 5d  7a e3 d8 02 c0 2f 00 00  |..z.#..]z..../..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 aa b9 87 c0 6f  |....Y...U......o|
+00000010  84 98 c2 14 74 06 d5 a9  96 3f d1 30 d2 97 50 72  |....t....?.0..Pr|
+00000020  6a f1 82 ce 03 f1 32 49  16 4f 77 20 ee b2 8e df  |j.....2I.Ow ....|
+00000030  8f 78 92 36 4a 2d ea 99  1e 24 7f 3f ee 50 11 c3  |.x.6J-...$.?.P..|
+00000040  4d 40 92 2f 94 0b b4 6a  5f 72 b8 08 c0 2f 00 00  |M@./...j_r.../..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,201 +54,193 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  cd 0c 00 00 c9 03 00 17  41 04 76 45 d0 d8 e2 07  |........A.vE....|
-000002d0  b2 f0 fd af 1c 34 15 0e  3f 3a d2 f4 6d 40 7f 26  |.....4..?:..m@.&|
-000002e0  3a ea 12 0e f0 f0 c5 66  7d 14 56 5d 55 07 08 dd  |:......f}.V]U...|
-000002f0  a2 5f ea 93 1c ad 1f 1d  1c 28 8e 8d 7c 5f 4b 6d  |._.......(..|_Km|
-00000300  66 d1 58 ae f1 da 43 ce  0e a7 04 01 00 80 a9 bf  |f.X...C.........|
-00000310  00 3b cd b4 58 11 0f a5  b0 b5 2d ac 3c 85 a5 3a  |.;..X.....-.<..:|
-00000320  73 d6 9a 94 e5 fd 67 47  db b6 75 7e 04 5d 47 75  |s.....gG..u~.]Gu|
-00000330  d7 43 03 bd 51 3f ee 1e  54 b5 0e fd 3b 60 81 ef  |.C..Q?..T...;`..|
-00000340  81 26 28 2b 0d b4 74 24  3f 55 fb 32 03 b5 60 57  |.&(+..t$?U.2..`W|
-00000350  9c 69 5a 4a ec 7c 81 f1  e8 2a 81 f6 0b 22 82 6b  |.iZJ.|...*...".k|
-00000360  dc e7 fb 52 6d 33 cb 97  00 c6 f8 df ed f2 6f 58  |...Rm3........oX|
-00000370  63 1e a9 cd 6a 5e 9b fe  69 c5 4e aa 03 ec 7e ba  |c...j^..i.N...~.|
-00000380  38 30 63 77 98 b0 25 66  0e 87 dd 2d 7f 74 16 03  |80cw..%f...-.t..|
-00000390  03 00 04 0e 00 00 00                              |.......|
+000002c0  ac 0c 00 00 a8 03 00 1d  20 5f 7f 61 d4 5d de 8b  |........ _.a.]..|
+000002d0  8d d1 48 dc 96 d3 87 f1  64 92 fe 0f e8 ab 89 31  |..H.....d......1|
+000002e0  ae 5c 57 af 59 be 0b 29  6a 04 01 00 80 0d 88 71  |.\W.Y..)j......q|
+000002f0  58 d0 23 d9 81 81 a8 df  44 4d 9e 3b 66 90 f9 c3  |X.#.....DM.;f...|
+00000300  b4 98 ac 4e d6 0f 1f a6  92 44 2f 29 73 fb 18 79  |...N.....D/)s..y|
+00000310  51 63 cd 13 15 52 92 a0  c4 b0 45 1f fe 8f ac ba  |Qc...R....E.....|
+00000320  76 1e 2f 97 fc 7d bf 91  fa 0b aa 47 5e 18 80 20  |v./..}.....G^.. |
+00000330  0e 68 0d a3 ad 83 28 eb  6a 7d a0 45 d4 00 1b ed  |.h....(.j}.E....|
+00000340  65 e3 e1 83 92 35 d0 5a  fd cd cb ea 4e b7 76 15  |e....5.Z....N.v.|
+00000350  35 e2 12 7c e8 8d 78 50  2a eb 16 66 0c a3 38 35  |5..|..xP*..f..85|
+00000360  56 d5 62 e8 8d 7d 5e 3e  72 63 4c 9b 3a 16 03 03  |V.b..}^>rcL.:...|
+00000370  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
-00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
-00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
-00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
-00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 2f 6c  |.....(......../l|
-00000060  3b 07 9f 28 8a a1 6b 6d  07 43 87 e3 08 25 cb f1  |;..(..km.C...%..|
-00000070  82 54 49 19 67 c9 33 15  34 7a 9f 3e 38 ea        |.TI.g.3.4z.>8.|
+00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
+00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
+00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
+00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 f6 96 e2  |....(...........|
+00000040  7e fa ee c9 29 9b 3e 14  c8 a0 1c 7f 1f 58 47 a1  |~...).>......XG.|
+00000050  12 a0 07 52 c4 e7 77 51  16 9e 1b 8e d1           |...R..wQ.....|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 29 f3 ac 3d c8  |..........()..=.|
-00000010  6d 0c bc be 29 f6 ca 1c  ae fa 41 2a dd b5 fb a2  |m...).....A*....|
-00000020  ec 8a dd a3 cc 6e bc b2  b2 4c f7 22 06 4c 7b 1f  |.....n...L.".L{.|
-00000030  77 77 40                                          |ww@|
+00000000  14 03 03 00 01 01 16 03  03 00 28 d5 b6 c4 29 29  |..........(...))|
+00000010  df 16 db bb c8 b8 6b 27  29 1f ce 55 8a 24 4c fa  |......k')..U.$L.|
+00000020  4d 94 e1 3c c8 49 a0 75  fa 86 21 58 f1 d4 f3 b5  |M..<.I.u..!X....|
+00000030  7c 9c 10                                          ||..|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 fe c0 da  |................|
-00000010  da fd 7f 10 6a 29 cd 7a  3b 79 fe e0 0f 37 19 ec  |....j).z;y...7..|
-00000020  d2 15 c7                                          |...|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 54 43 2d  |.............TC-|
+00000010  2b 31 18 3a be d4 48 5a  a1 4a d7 d0 7a 9a f4 42  |+1.:..HZ.J..z..B|
+00000020  9e 0d d4                                          |...|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 1c 29 f3 ac  3d c8 6d 0c bd d8 1c 55  |.....)..=.m....U|
-00000010  34 2f 9f a7 8c 92 9e 0b  57 46 08 6a 11 54 82 94  |4/......WF.j.T..|
-00000020  e3                                                |.|
+00000000  16 03 03 00 1c d5 b6 c4  29 29 df 16 dc 50 d5 50  |........))...P.P|
+00000010  eb 32 df 33 ef b2 45 52  cc fa 9c 5e 24 2f 0d a0  |.2.3..ER...^$/..|
+00000020  ec                                                |.|
 >>> Flow 7 (client to server)
-00000000  16 03 03 00 af 00 00 00  00 00 00 00 02 36 0a ba  |.............6..|
-00000010  2d db 68 c5 94 97 9d 3f  41 71 8d 92 37 4b 12 ca  |-.h....?Aq..7K..|
-00000020  b9 c0 ab 5e 0e 98 f5 fc  28 47 32 c3 98 ca 04 30  |...^....(G2....0|
-00000030  24 14 1f b1 69 86 b0 de  b6 f2 15 f9 e0 eb 5a 37  |$...i.........Z7|
-00000040  69 94 26 8b 8e 19 cb 1a  ba 7f fb a8 b9 61 25 f2  |i.&..........a%.|
-00000050  68 8b 97 af fd 3b 59 04  50 3f 27 97 7b df 61 bd  |h....;Y.P?'.{.a.|
-00000060  cb e7 6d 6a d8 c0 1d 8d  8b fc 68 49 a7 13 bf 5c  |..mj......hI...\|
-00000070  fe 80 70 13 09 0b 35 4a  9b 3c 32 95 0f a2 31 c3  |..p...5J.<2...1.|
-00000080  b5 4f 19 82 30 a1 65 fc  5b 48 16 49 10 2b 2f c5  |.O..0.e.[H.I.+/.|
-00000090  f4 eb 02 87 a8 f7 e4 94  34 72 c9 a6 e6 c4 de 7e  |........4r.....~|
-000000a0  48 50 57 33 9e 30 eb fa  92 e7 9b fe 33 52 2b e5  |HPW3.0......3R+.|
-000000b0  b3 e4 47 b3                                       |..G.|
+00000000  16 03 03 00 b1 00 00 00  00 00 00 00 02 cc 36 06  |..............6.|
+00000010  ab 2b 1e 50 26 39 44 e2  37 21 c5 f7 75 21 71 49  |.+.P&9D.7!..u!qI|
+00000020  b7 4d ea 13 a1 0a 98 b3  0f 06 d4 ca e5 72 7b 7c  |.M...........r{||
+00000030  23 4e ba ef 34 fa a5 90  a1 b2 e7 56 02 86 43 41  |#N..4......V..CA|
+00000040  ca 87 dd fb 83 1b f1 68  4f 12 63 97 67 91 48 4c  |.......hO.c.g.HL|
+00000050  92 fe d6 41 00 3b 40 c0  1e 93 18 d6 ba d5 a7 58  |...A.;@........X|
+00000060  f4 21 b4 87 28 59 94 46  9b c8 af e1 c5 d4 1d 2d  |.!..(Y.F.......-|
+00000070  5b 03 5d 8c 35 dc b3 63  8a e3 bb 74 8c b3 e7 49  |[.].5..c...t...I|
+00000080  bc 19 d7 d4 55 7c d4 09  08 55 da 68 5d 0b 1f 87  |....U|...U.h]...|
+00000090  8f bd 77 a1 32 b5 76 30  ef e0 21 b7 d5 b7 cc 80  |..w.2.v0..!.....|
+000000a0  a5 41 7c 69 7a e3 49 d9  35 18 76 61 d1 27 6d 96  |.A|iz.I.5.va.'m.|
+000000b0  1d 39 12 2d 98 3b                                 |.9.-.;|
 >>> Flow 8 (server to client)
-00000000  16 03 03 00 89 29 f3 ac  3d c8 6d 0c be 61 86 67  |.....)..=.m..a.g|
-00000010  ed 4a a6 8b 53 5c 8c e0  3e b8 e4 91 8b 45 df 9d  |.J..S\..>....E..|
-00000020  1a 08 eb 71 3b 7c d8 43  9a e3 83 36 d6 5d 9e 4b  |...q;|.C...6.].K|
-00000030  e7 4b b3 a2 f1 98 43 f4  e2 f3 39 cf 2c cb 48 49  |.K....C...9.,.HI|
-00000040  97 33 83 7b 27 b8 16 07  87 8e 6d 5f c8 d8 75 64  |.3.{'.....m_..ud|
-00000050  91 51 3c bf 28 09 c0 87  12 2e e4 7a cc 53 a4 bf  |.Q<.(......z.S..|
-00000060  dc 0c d5 72 26 51 13 d2  9f a5 1b 1d a3 da 91 2b  |...r&Q.........+|
-00000070  e7 dd 5b a4 a7 18 70 2a  4b 87 25 05 e6 e1 14 ec  |..[...p*K.%.....|
-00000080  63 25 d6 f4 31 8e d1 d1  0d 53 1c 80 ea 11 16 03  |c%..1....S......|
-00000090  03 02 71 29 f3 ac 3d c8  6d 0c bf 37 88 e8 06 f8  |..q)..=.m..7....|
-000000a0  ed ce 83 7c 1c 40 a9 7a  6d 0b 99 76 03 89 f6 61  |...|.@.zm..v...a|
-000000b0  a6 18 53 2f ac 03 ba 49  44 bf 76 0d 7e e4 d5 04  |..S/...ID.v.~...|
-000000c0  83 a2 d6 20 23 f3 78 43  b4 d6 85 c0 12 59 89 4d  |... #.xC.....Y.M|
-000000d0  c4 bf b4 e8 99 21 6c 73  82 67 59 1d 86 a8 d5 df  |.....!ls.gY.....|
-000000e0  5f 74 73 3a ef 20 ed 55  c7 0f 20 62 ee 5c 6f 63  |_ts:. .U.. b.\oc|
-000000f0  c6 bc a2 60 3a 5e 27 e9  4c 04 c7 ce 6d 36 3b 7e  |...`:^'.L...m6;~|
-00000100  81 ee bc e3 53 bd ab 52  78 aa 8c 37 f0 6b 9c 1c  |....S..Rx..7.k..|
-00000110  52 63 68 3d 14 0c e2 89  6c 6b 95 4b 97 b8 76 06  |Rch=....lk.K..v.|
-00000120  4b 05 08 92 dc d8 26 56  ae 47 9b 9e 1b e4 16 66  |K.....&V.G.....f|
-00000130  53 63 0e 68 0d 33 f1 68  4d fc fb c5 1e d9 20 2c  |Sc.h.3.hM..... ,|
-00000140  e5 61 27 be aa c9 a0 22  23 c8 ec bd 44 51 20 40  |.a'...."#...DQ @|
-00000150  65 0a 2f 91 47 30 ac 40  91 a9 6e 3a 7c 53 80 2a  |e./.G0.@..n:|S.*|
-00000160  70 f9 fa 93 ad d3 c4 ce  59 89 e7 85 fa cd ee 93  |p.......Y.......|
-00000170  8b f6 c2 96 3b 37 d5 ed  ae 2c 65 ea e5 53 72 3f  |....;7...,e..Sr?|
-00000180  87 5e 8e 08 7b 82 38 fd  95 2e 11 8a 78 b8 f4 07  |.^..{.8.....x...|
-00000190  2c 3a c7 d3 4f 9c 8f 43  7c fa 81 eb f0 c6 16 82  |,:..O..C|.......|
-000001a0  a2 73 d3 76 05 6b 6e 52  49 fc d9 e1 c1 2f 06 d7  |.s.v.knRI..../..|
-000001b0  b6 3c cd d8 35 9c 0b 2b  3c ec 38 21 47 22 1d 3d  |.<..5..+<.8!G".=|
-000001c0  b8 dc 62 86 b5 c4 ab d4  de 15 fe 80 1e 6b d6 56  |..b..........k.V|
-000001d0  cd 62 dc f2 31 f8 a0 b1  b5 93 35 98 e2 5d 97 9b  |.b..1.....5..]..|
-000001e0  f2 ce af bf 3c 38 56 28  17 c9 ae 17 e5 aa e3 8b  |....<8V(........|
-000001f0  7b 3b 5d 67 95 89 94 7e  57 81 8f 2e 33 5c 42 24  |{;]g...~W...3\B$|
-00000200  e4 ea 55 8c eb 23 1a b9  19 72 65 9a e5 30 e5 f9  |..U..#...re..0..|
-00000210  78 31 6e b9 43 45 a3 fd  c6 d8 ad dc 96 70 06 1c  |x1n.CE.......p..|
-00000220  e5 7e 5f c1 f5 00 f7 e7  f2 6a b7 8c 9b bd 77 6a  |.~_......j....wj|
-00000230  1f da 78 4a a9 e1 f1 2e  78 ed 07 57 7d a1 84 67  |..xJ....x..W}..g|
-00000240  27 13 d1 c4 1e 24 0d 0a  85 ea 86 10 fd 21 08 40  |'....$.......!.@|
-00000250  e6 38 66 44 8c 77 07 d7  60 70 9a e6 6d 94 c8 6e  |.8fD.w..`p..m..n|
-00000260  fb 2f ff 30 27 21 b8 f7  16 24 bd 80 b9 56 ce 24  |./.0'!...$...V.$|
-00000270  67 74 b6 c7 cd de 96 3b  d9 10 21 12 c3 83 9e f8  |gt.....;..!.....|
-00000280  d7 fc 6f a8 91 4b f4 ea  47 ff 72 31 56 2f ee 25  |..o..K..G.r1V/.%|
-00000290  34 69 21 17 b2 7f 6e 5e  10 8c 47 0b ca 55 31 3e  |4i!...n^..G..U1>|
-000002a0  ba 22 53 ed 23 85 17 cf  35 6f a9 37 3e 69 7b b7  |."S.#...5o.7>i{.|
-000002b0  f5 a7 61 93 ee c0 f8 ac  62 37 ba 8d ab cf 66 f6  |..a.....b7....f.|
-000002c0  5a fb c6 dd 20 09 89 bb  a8 58 1a 69 4e 91 d3 36  |Z... ....X.iN..6|
-000002d0  23 0d ed f2 32 59 8d 9e  77 76 36 ad 6d bf d9 68  |#...2Y..wv6.m..h|
-000002e0  fe 4b ad 67 9f 8d 13 d9  2e b8 be 1b b2 4f e9 13  |.K.g.........O..|
-000002f0  be 38 63 e1 d8 14 35 b9  ce d0 65 d6 9c f1 c1 d8  |.8c...5...e.....|
-00000300  a4 d7 23 84 16 03 03 00  e5 29 f3 ac 3d c8 6d 0c  |..#......)..=.m.|
-00000310  c0 05 31 37 9f 4e 42 90  51 56 63 6f 86 e9 6d 67  |..17.NB.QVco..mg|
-00000320  0e 7e 8a d6 a9 7a 62 02  94 9b 6b 48 fc a9 bc 94  |.~...zb...kH....|
-00000330  a8 d5 9b 94 5e 3d 50 a0  df f8 23 c0 a3 1f a0 de  |....^=P...#.....|
-00000340  6b c9 75 fa 7f 8e 4a 85  04 d8 2f 97 37 b9 e3 84  |k.u...J.../.7...|
-00000350  25 47 2f 66 d2 68 00 46  12 95 83 d4 9b 4d 1d d2  |%G/f.h.F.....M..|
-00000360  53 50 b8 97 f0 46 64 86  58 be a0 ef 00 c7 50 a3  |SP...Fd.X.....P.|
-00000370  84 9f 3f 41 fe 94 cc 9f  c8 e1 c3 23 a5 02 2b 0e  |..?A.......#..+.|
-00000380  80 d6 f5 30 ed 60 ba 46  fe 3a 08 0d 0e 76 db a5  |...0.`.F.:...v..|
-00000390  ed 18 85 8e a3 81 1c 38  8b a1 3f 1c 72 ea 61 03  |.......8..?.r.a.|
-000003a0  65 68 db 25 8e 8d 93 6a  a5 ce c2 94 eb b1 49 6e  |eh.%...j......In|
-000003b0  f5 e7 99 fa 5f 08 ee 0c  f8 a4 1d e2 3c e2 be 82  |...._.......<...|
-000003c0  50 9e 60 22 fc 0b 58 1e  5a b8 b2 1f 1f be 05 83  |P.`"..X.Z.......|
-000003d0  1f 94 e1 01 29 c1 e8 2a  4b 17 e4 8f 0f 01 e3 3d  |....)..*K......=|
-000003e0  b8 72 54 b8 a5 3e 2f d5  7b 85 7e 5e 30 b8 16 03  |.rT..>/.{.~^0...|
-000003f0  03 00 42 29 f3 ac 3d c8  6d 0c c1 f6 2b 68 fb 23  |..B)..=.m...+h.#|
-00000400  d7 ad 81 aa 70 50 d8 6c  30 bc 09 3d bb ce df 6a  |....pP.l0..=...j|
-00000410  77 7d 83 11 c0 cb 07 c9  5d 0b 85 29 9d 53 7b 70  |w}......]..).S{p|
-00000420  4a 62 ae 0e 98 21 17 8a  b5 a3 c1 03 ce c9 0e 54  |Jb...!.........T|
-00000430  19 c8 af 9f 2a 16 03 03  00 1c 29 f3 ac 3d c8 6d  |....*.....)..=.m|
-00000440  0c c2 ef 6b fd 83 40 47  bf 43 52 68 dd b5 76 2b  |...k..@G.CRh..v+|
-00000450  20 b6 cc 6d eb 52                                 | ..m.R|
+00000000  16 03 03 00 89 d5 b6 c4  29 29 df 16 dd 91 28 de  |........))....(.|
+00000010  3a 91 8b 69 bf be fb 8b  e7 bb 2e 0a 9b fa fb f7  |:..i............|
+00000020  6c d1 18 b0 9e 8f 15 15  70 72 3b e6 f4 a8 90 f0  |l.......pr;.....|
+00000030  ec 59 9e 25 bd d5 ca 00  ce 7c e8 52 99 65 e4 f4  |.Y.%.....|.R.e..|
+00000040  9d 65 f7 84 d5 5c 9e 6f  3c 7b 67 82 07 6f 25 3b  |.e...\.o<{g..o%;|
+00000050  26 1c c4 b7 19 7a 9f bd  5a 59 15 56 55 09 46 0e  |&....z..ZY.VU.F.|
+00000060  80 3b 1c fb e6 d8 30 a2  94 96 37 5c 7c 0d 8c 8a  |.;....0...7\|...|
+00000070  ef e3 d2 19 bc e5 22 ae  ae 5f b2 04 13 24 dc 67  |......".._...$.g|
+00000080  9e b6 38 8c 9b cf 53 90  23 1c c8 a7 b7 1b 16 03  |..8...S.#.......|
+00000090  03 02 71 d5 b6 c4 29 29  df 16 de 2b fa 2d 83 6f  |..q...))...+.-.o|
+000000a0  56 ee 36 44 13 53 99 76  46 53 ca cf 61 72 9b 3b  |V.6D.S.vFS..ar.;|
+000000b0  a0 8f 0a d5 7a 01 ad d6  e9 fc 85 de e4 97 02 0d  |....z...........|
+000000c0  8b 27 a2 a5 4e 04 59 30  d4 ff fd b4 99 a4 8a ac  |.'..N.Y0........|
+000000d0  29 97 7e 10 47 e2 a8 eb  d9 8a b7 f7 1c 64 8d 24  |).~.G........d.$|
+000000e0  9b 7d c3 9b e7 42 72 e5  26 88 4a d4 40 89 bf a2  |.}...Br.&.J.@...|
+000000f0  44 b9 d8 cb 79 0d 35 37  6b 2d 04 49 f6 97 10 66  |D...y.57k-.I...f|
+00000100  e0 1d e8 66 43 f0 65 b7  35 8a cb 41 60 b3 ae 31  |...fC.e.5..A`..1|
+00000110  fb b4 2e 1e 0f 0f 2d a8  f8 b1 7d 36 af 8f a1 39  |......-...}6...9|
+00000120  0b 94 7a 4d 48 57 14 30  b2 c9 e4 bf 80 73 85 59  |..zMHW.0.....s.Y|
+00000130  73 4b d2 e8 2b 89 8e 45  b1 0f 47 1e 53 ad 7e 24  |sK..+..E..G.S.~$|
+00000140  b6 40 de 58 06 5f cb 1a  36 51 cd a1 d1 8a 66 a9  |.@.X._..6Q....f.|
+00000150  3a 83 a7 42 c5 5c 08 88  6d 21 7e 58 92 b6 a8 93  |:..B.\..m!~X....|
+00000160  5d 47 e2 7e bb 89 94 56  a1 47 69 a6 f8 3a 5d 1a  |]G.~...V.Gi..:].|
+00000170  f0 0f e9 a4 5a 5b d0 74  76 f6 0f e1 3f 00 00 53  |....Z[.tv...?..S|
+00000180  dd d7 32 c6 3d 52 a1 a6  98 0a 41 63 3f 67 74 dc  |..2.=R....Ac?gt.|
+00000190  78 5f 39 b0 27 1c d7 ad  b6 0d 6a 8f 71 65 e0 43  |x_9.'.....j.qe.C|
+000001a0  82 cd 01 45 b2 f2 93 de  aa fd 5b 53 d9 7a 47 36  |...E......[S.zG6|
+000001b0  54 55 30 63 b0 c3 bf fe  17 10 d7 85 b9 24 8f 8f  |TU0c.........$..|
+000001c0  30 61 a3 96 c6 03 96 cc  1f bc 76 31 e0 61 39 bb  |0a........v1.a9.|
+000001d0  1e 1c d5 d8 94 a8 bd a4  27 a0 ef a9 e3 87 21 79  |........'.....!y|
+000001e0  ac f0 3c 13 c8 71 ae 41  5f 25 25 14 38 3b 65 0b  |..<..q.A_%%.8;e.|
+000001f0  4f eb 93 22 93 d1 31 73  59 f6 5b 78 da 83 08 8b  |O.."..1sY.[x....|
+00000200  13 cb 93 d0 1f 57 85 67  46 ae 22 41 1c 4d c2 4e  |.....W.gF."A.M.N|
+00000210  91 a8 3b 92 6d 23 6e 6c  3a c3 da 0f e3 70 27 9b  |..;.m#nl:....p'.|
+00000220  df f0 5a 83 9f 21 ba 63  3b 55 4d 53 0b a2 7e 99  |..Z..!.c;UMS..~.|
+00000230  b9 7a ba 78 ba e6 ce ee  71 d1 cf 8b c8 79 8d f9  |.z.x....q....y..|
+00000240  75 c6 3c f3 16 99 ea d4  94 cc e3 7d 7e 84 b9 69  |u.<........}~..i|
+00000250  7a d2 10 de 17 7c 98 2a  d2 5e c0 0f ce a5 65 21  |z....|.*.^....e!|
+00000260  40 fa 31 82 7b 86 10 ac  fe b3 24 8b 83 6e 7f bc  |@.1.{.....$..n..|
+00000270  f6 2c 3d ef 6f 82 b3 01  da 3a e8 a6 07 dd 2a c8  |.,=.o....:....*.|
+00000280  56 ba 62 83 20 0b 68 bc  15 cb 53 f0 61 e7 bd 56  |V.b. .h...S.a..V|
+00000290  d6 79 5a b2 af f9 18 d3  7b 91 ce be 27 0d ef f8  |.yZ.....{...'...|
+000002a0  90 62 45 39 39 2f 89 ff  36 ad 56 f2 1a 58 13 dc  |.bE99/..6.V..X..|
+000002b0  09 9c 2a a8 a2 b2 6c 8b  04 7b aa 24 e6 1c 01 22  |..*...l..{.$..."|
+000002c0  5f 0c ac a3 c3 6e 5c f5  5d a7 56 5e 7d 1f f8 43  |_....n\.].V^}..C|
+000002d0  ec b4 83 26 7e 65 67 55  c9 af 82 8d 7e ac f7 ad  |...&~egU....~...|
+000002e0  cf d1 e9 f8 70 be 50 38  f0 eb 3e 2e 9e 79 74 26  |....p.P8..>..yt&|
+000002f0  bd da 05 9e bf b8 22 cb  33 9b 28 4e c9 1f 12 ce  |......".3.(N....|
+00000300  c5 df 1e f7 16 03 03 00  c4 d5 b6 c4 29 29 df 16  |............))..|
+00000310  df b5 a6 17 34 4d 63 d7  7f 48 e1 ab 14 76 59 d1  |....4Mc..H...vY.|
+00000320  86 93 6a 7e e4 a7 9e be  ce e9 df 02 e3 47 94 b6  |..j~.........G..|
+00000330  64 63 fd d8 b0 17 29 54  67 a6 b4 d4 04 07 0a 21  |dc....)Tg......!|
+00000340  1d 55 90 c2 d0 b9 ed 85  cb 0a 78 19 a5 0f 8a 2d  |.U........x....-|
+00000350  f0 43 b9 6a 80 d1 7a 4d  35 84 ef 30 5f f5 00 20  |.C.j..zM5..0_.. |
+00000360  81 7a bc 4b c3 eb 08 49  83 10 77 0d 3d e2 6e d2  |.z.K...I..w.=.n.|
+00000370  16 fd 52 b5 53 11 f1 d2  d8 72 fd f7 0c f8 42 44  |..R.S....r....BD|
+00000380  00 e2 b9 60 68 34 3a f2  3a d1 c6 8e 11 10 15 8f  |...`h4:.:.......|
+00000390  bf 2c 36 a1 fb 89 55 a4  bf 52 97 64 c1 1d ad 20  |.,6...U..R.d... |
+000003a0  f2 b0 10 82 00 af da aa  76 51 2e 4c 0a 54 97 0d  |........vQ.L.T..|
+000003b0  6c d0 17 7d 6e f9 87 90  52 9c 32 d4 f3 ba be eb  |l..}n...R.2.....|
+000003c0  34 13 33 fc b9 c4 d3 8a  ca e0 28 26 c9 16 03 03  |4.3.......(&....|
+000003d0  00 42 d5 b6 c4 29 29 df  16 e0 0e e2 f7 7f 26 ef  |.B...)).......&.|
+000003e0  10 f0 f9 38 ad 39 bf aa  3d 50 c7 e1 52 47 1d 3c  |...8.9..=P..RG.<|
+000003f0  c3 a2 09 d0 c5 e1 f3 ad  c7 86 54 aa ff 74 d5 8e  |..........T..t..|
+00000400  46 88 aa 00 95 3c f5 80  87 a7 1f 74 ec a9 b4 23  |F....<.....t...#|
+00000410  f5 28 5e 99 16 03 03 00  1c d5 b6 c4 29 29 df 16  |.(^.........))..|
+00000420  e1 d0 9f 65 f1 3c 76 53  ca e7 93 0c 0e 9e 56 29  |...e.<vS......V)|
+00000430  56 90 bc 92 92                                    |V....|
 >>> Flow 9 (client to server)
-00000000  16 03 03 02 71 00 00 00  00 00 00 00 03 44 f0 d0  |....q........D..|
-00000010  5b e0 72 8f 3d 87 1e 11  b6 07 38 c2 87 c9 43 3b  |[.r.=.....8...C;|
-00000020  17 5d 1e e6 b6 5f 60 3d  aa 22 25 0f a6 a1 e3 c0  |.]..._`=."%.....|
-00000030  13 3e a2 ef f1 90 24 47  06 e7 77 af 6b be 9c 20  |.>....$G..w.k.. |
-00000040  95 25 45 5d 50 50 28 0a  d6 8a 96 11 cd 0a b1 20  |.%E]PP(........ |
-00000050  03 4e e9 0f e4 8d d8 e6  0f e7 c2 0f ea a3 b0 a6  |.N..............|
-00000060  63 09 ac 93 1a cf cf 71  91 cc ef d4 f7 38 28 b3  |c......q.....8(.|
-00000070  21 2d 7e 01 93 6c 6b da  d1 72 d2 b4 83 62 c7 1a  |!-~..lk..r...b..|
-00000080  06 eb 9a 4c 0c b3 26 93  7d 7b fd 87 76 ac 9a 72  |...L..&.}{..v..r|
-00000090  99 5d 5a e2 d7 3b d8 de  0d bb 9e 78 bd 38 d7 9f  |.]Z..;.....x.8..|
-000000a0  21 ea 61 f1 2b 36 2e 27  88 c7 26 7d d5 ca 5f 9e  |!.a.+6.'..&}.._.|
-000000b0  be 9d aa 43 0a 18 5f ef  a8 0c 27 07 01 bb 31 f3  |...C.._...'...1.|
-000000c0  c0 9d c1 66 a8 0e 08 c3  0d 3b 83 c8 2f 13 4f af  |...f.....;../.O.|
-000000d0  89 bc ca 3d 01 00 50 ec  4a ac 4b 90 79 35 c0 5e  |...=..P.J.K.y5.^|
-000000e0  ea 18 48 31 73 bb 62 24  c4 45 7e a1 78 a2 59 cd  |..H1s.b$.E~.x.Y.|
-000000f0  2e 78 80 f4 55 62 37 64  a9 7d b1 ad bf a4 71 54  |.x..Ub7d.}....qT|
-00000100  63 ae aa eb 07 b1 63 e3  70 5d 8e d9 b6 f2 44 d3  |c.....c.p]....D.|
-00000110  e5 f2 b8 af 78 8c ed 9d  69 70 19 19 74 3b 4c c8  |....x...ip..t;L.|
-00000120  6e ee 58 72 e0 82 bb 5b  f7 7c c7 13 7b 57 50 7b  |n.Xr...[.|..{WP{|
-00000130  6f 81 2e 6e 97 08 07 e0  64 ad 9b 50 e0 ed d8 11  |o..n....d..P....|
-00000140  17 27 1b 32 87 ed fd 04  66 7b e3 e8 13 63 e1 98  |.'.2....f{...c..|
-00000150  75 4e 58 ac 0f 32 b0 6a  dd 8c 23 e4 63 e7 20 54  |uNX..2.j..#.c. T|
-00000160  b4 1f 57 95 17 73 aa 67  09 f3 4c 1a 63 94 65 fd  |..W..s.g..L.c.e.|
-00000170  d0 b1 b0 0e e9 f9 62 12  87 d0 1a 4e ca 26 50 4e  |......b....N.&PN|
-00000180  23 c6 3b 52 fe 0e 26 40  2f 0a 03 89 1a 58 5d 89  |#.;R..&@/....X].|
-00000190  91 2b 84 82 ec b2 29 8c  40 d3 a0 ec 57 c8 10 4d  |.+....).@...W..M|
-000001a0  67 2b fb 11 1b 68 58 93  ae bb 6c e7 8b 55 d9 35  |g+...hX...l..U.5|
-000001b0  79 e8 7e bf 58 1f c2 bf  86 d2 7f 60 f7 2b 16 72  |y.~.X......`.+.r|
-000001c0  2d 15 ef fc 71 93 e7 74  0a 28 89 53 f2 62 8c f0  |-...q..t.(.S.b..|
-000001d0  ec 8b 2a bf cf 1b 87 87  18 15 d5 f2 01 59 14 74  |..*..........Y.t|
-000001e0  16 f8 d0 8b 86 f4 5d 6a  d9 59 fe 08 d7 ba 04 e1  |......]j.Y......|
-000001f0  1a 27 78 e0 9d 61 52 8f  98 75 d7 c4 2b fb 62 72  |.'x..aR..u..+.br|
-00000200  d2 42 48 03 22 31 b2 c5  0c e3 f4 b4 c5 01 ae 29  |.BH."1.........)|
-00000210  fd a2 13 eb ed fe 40 5a  50 9f 2e d1 9c 01 d4 81  |......@ZP.......|
-00000220  4c bd 1f d0 19 42 c6 0f  1e 04 f4 91 53 49 63 88  |L....B......SIc.|
-00000230  a8 52 72 fc cc c5 3e 7c  84 90 34 5d b5 ce 2a b0  |.Rr...>|..4]..*.|
-00000240  4b ad 0c 7f e7 9a 56 c4  d3 5c 25 ba d9 67 b9 b1  |K.....V..\%..g..|
-00000250  46 09 86 09 6e be 45 fa  8c bb 8c 0b 57 f2 43 e2  |F...n.E.....W.C.|
-00000260  f2 f3 eb ac 6b 3a 06 ac  76 da 69 d7 94 68 2b 91  |....k:..v.i..h+.|
-00000270  f4 d8 4f a0 2c ce 16 03  03 00 5e 00 00 00 00 00  |..O.,.....^.....|
-00000280  00 00 04 5a cf 0b b8 b8  64 ac f5 5e 9e b0 01 db  |...Z....d..^....|
-00000290  4b 44 cb 17 7b f1 1f 25  79 2f 8b 01 41 83 1b 3c  |KD..{..%y/..A..<|
-000002a0  8e c3 0f 3b 8a 62 97 ed  da 81 cc 46 26 f8 ec 51  |...;.b.....F&..Q|
-000002b0  3e 05 99 d8 33 c7 6f 44  1e f0 11 7d 58 a5 f3 2e  |>...3.oD...}X...|
-000002c0  23 84 61 98 2e c8 d4 95  ae f8 ca 8e 9e 5e 8b 4b  |#.a..........^.K|
-000002d0  b4 ac 49 f1 f1 de da 56  76 16 03 03 00 a0 00 00  |..I....Vv.......|
-000002e0  00 00 00 00 00 05 02 51  00 38 af 32 10 48 88 a2  |.......Q.8.2.H..|
-000002f0  3b b3 35 46 b4 c7 9c 3e  ad ab ff 64 aa 8d 51 78  |;.5F...>...d..Qx|
-00000300  f5 74 d0 b7 56 30 d7 35  d6 f6 bf 7e 92 c8 3a 99  |.t..V0.5...~..:.|
-00000310  85 24 09 53 f8 fc 04 d7  de 43 96 c0 27 76 05 a7  |.$.S.....C..'v..|
-00000320  b7 07 e2 6f 22 c7 d7 b0  85 b1 bf e0 4d 27 df 45  |...o".......M'.E|
-00000330  ac 09 2a 04 1f f7 ed b0  37 f6 73 39 80 a6 b9 27  |..*.....7.s9...'|
-00000340  dc 5d a1 19 19 cd df ce  c2 90 93 26 76 10 fd 8a  |.].........&v...|
-00000350  cf cf bb f3 fb 2d f2 10  df 6e 93 74 2c be 7a 23  |.....-...n.t,.z#|
-00000360  12 97 ae 99 d8 91 d3 12  40 dd c9 2f 58 19 79 d1  |........@../X.y.|
-00000370  a9 84 a5 ea 5c af f2 72  88 36 e1 00 07 52 14 03  |....\..r.6...R..|
-00000380  03 00 19 00 00 00 00 00  00 00 06 71 ef 3b 74 cb  |...........q.;t.|
-00000390  56 03 aa 33 92 b3 2b 14  1b 58 a4 b6 16 03 03 00  |V..3..+..X......|
-000003a0  28 00 00 00 00 00 00 00  00 bd 60 39 44 46 e2 0d  |(.........`9DF..|
-000003b0  9d 6a cf b8 ba 6e ef e8  a7 3f a9 25 ce 8b 51 7a  |.j...n...?.%..Qz|
-000003c0  81 fc 50 67 dc 55 d0 11  18                       |..Pg.U...|
+00000000  16 03 03 02 71 00 00 00  00 00 00 00 03 6d b0 55  |....q........m.U|
+00000010  6c 78 64 b3 f3 37 eb 16  e0 59 c9 c5 63 f7 57 8c  |lxd..7...Y..c.W.|
+00000020  0a 96 bc 53 31 73 e4 4a  ff ad 54 8d 9e a9 da 19  |...S1s.J..T.....|
+00000030  1b 84 21 c1 75 49 05 ca  ef 69 91 ad 32 25 34 77  |..!.uI...i..2%4w|
+00000040  35 74 ef d3 8d 3d 1b 4d  22 32 ef c1 b5 50 52 75  |5t...=.M"2...PRu|
+00000050  23 29 27 98 e0 a1 e9 c1  9f e2 ee 25 f5 18 45 ca  |#)'........%..E.|
+00000060  bf 97 73 44 bb 1e ea 7d  c5 ee 1c cc e7 bb 5d e8  |..sD...}......].|
+00000070  a3 e8 85 2d 94 6c de 25  f0 70 a8 51 5a 18 c0 49  |...-.l.%.p.QZ..I|
+00000080  ab d6 ff 30 64 39 63 fd  87 80 f7 df 56 5c c9 17  |...0d9c.....V\..|
+00000090  65 b1 fa 00 d1 6c 05 b0  08 68 4d 78 15 2a 8a d1  |e....l...hMx.*..|
+000000a0  e6 f9 3a 08 48 43 36 08  f0 bb 75 29 a5 81 1e 28  |..:.HC6...u)...(|
+000000b0  70 0f 23 47 0d bf 63 f2  fb f0 c4 64 39 c2 1c 35  |p.#G..c....d9..5|
+000000c0  ed 3c c3 06 ed b8 db e0  e8 4f 5c ab 37 fe 7c df  |.<.......O\.7.|.|
+000000d0  eb 62 9c d0 9a 9a 93 b1  a6 47 5a 18 11 15 eb db  |.b.......GZ.....|
+000000e0  37 99 d9 2b 60 31 96 1f  63 1f a9 4d 0b 8a 4c 68  |7..+`1..c..M..Lh|
+000000f0  19 01 b6 11 90 7c fb b8  b2 83 24 12 14 d0 fd 4c  |.....|....$....L|
+00000100  56 12 2b 82 05 2b a2 5a  af 88 f0 f7 cb 7c 06 64  |V.+..+.Z.....|.d|
+00000110  11 d6 05 65 16 8b 3f b4  49 22 4f 3e 05 2d 62 e5  |...e..?.I"O>.-b.|
+00000120  06 12 0f e3 81 c6 34 8b  08 3e 56 6a 0f 09 69 68  |......4..>Vj..ih|
+00000130  45 5c 7d 4f d2 a6 cb 50  e5 c6 22 52 22 f2 8f 68  |E\}O...P.."R"..h|
+00000140  07 8b f7 e6 64 16 2f 53  01 55 05 f5 67 ad 03 28  |....d./S.U..g..(|
+00000150  9e 57 6b 57 1a c5 41 46  1c 76 64 37 02 b6 0d c8  |.WkW..AF.vd7....|
+00000160  32 1a 50 25 4d b8 16 66  6c ec 88 5a 4a 91 f9 5d  |2.P%M..fl..ZJ..]|
+00000170  af 00 f0 43 97 c3 b8 b5  3f b7 ca bf 1e ad fb c7  |...C....?.......|
+00000180  eb a7 47 75 8c ba 92 89  e2 e5 dc 46 6c 5a bf bf  |..Gu.......FlZ..|
+00000190  3d a5 f2 69 a2 ca 38 66  8b 40 68 db 5f 47 70 a5  |=..i..8f.@h._Gp.|
+000001a0  c4 cc 4e b0 3c 60 c6 56  18 b6 b5 21 94 38 e3 bf  |..N.<`.V...!.8..|
+000001b0  98 94 4b 4e bc 0c 71 5a  5b a7 ba 4b 5b 1d 31 aa  |..KN..qZ[..K[.1.|
+000001c0  48 68 f9 3a 76 1d b2 6e  2d 92 13 17 ed b6 1f 9f  |Hh.:v..n-.......|
+000001d0  81 63 83 c4 49 8d 0c f1  7e a7 d9 10 32 3f 82 43  |.c..I...~...2?.C|
+000001e0  14 b5 a6 d3 56 cb f9 7a  96 5a 5f 78 8c 04 17 d0  |....V..z.Z_x....|
+000001f0  7d 87 78 a0 1d 8d b5 7c  a5 76 df cb 46 4a 84 03  |}.x....|.v..FJ..|
+00000200  b6 b4 ee 71 7d 2e 64 5c  82 82 18 ec c3 db 9e 0f  |...q}.d\........|
+00000210  fe 15 c5 0c 7e 2c 19 15  be 35 4e 1f 04 9f b3 a4  |....~,...5N.....|
+00000220  b5 55 ed 86 1c b1 a4 9a  34 7e 26 0e dc 3d c8 5d  |.U......4~&..=.]|
+00000230  75 9e c7 60 76 dc ab de  e0 9f 44 1c 08 99 8d c8  |u..`v.....D.....|
+00000240  90 8a f7 bc 25 54 f1 3b  e1 d4 fc 40 b1 c3 b6 c4  |....%T.;...@....|
+00000250  de d4 0f 2c ad 16 26 1d  4b e1 70 2b 5c 71 0a fd  |...,..&.K.p+\q..|
+00000260  e8 b9 91 a7 2a 63 62 00  b7 c2 e4 2f 7d cc 4b fd  |....*cb..../}.K.|
+00000270  64 cb 22 8a ff 50 16 03  03 00 3d 00 00 00 00 00  |d."..P....=.....|
+00000280  00 00 04 e8 59 f7 44 61  0c 43 cd f8 7f ad 5a a4  |....Y.Da.C....Z.|
+00000290  98 e8 01 ae 9f 7f 3c b3  3b 27 51 e6 a3 1a b8 83  |......<.;'Q.....|
+000002a0  14 aa a7 4c 2e 9d 26 c1  6e bc bb 9c e4 f7 71 7a  |...L..&.n.....qz|
+000002b0  c6 6a 31 68 8d a5 bd a4  16 03 03 00 a0 00 00 00  |.j1h............|
+000002c0  00 00 00 00 05 17 e6 f8  67 74 57 c0 06 b4 7f d7  |........gtW.....|
+000002d0  a8 52 96 20 fc a8 2b 2b  c4 a1 b2 04 73 ae db bc  |.R. ..++....s...|
+000002e0  40 e5 41 fe 7d 5f 2c ba  1e b5 0c e1 8e 03 02 25  |@.A.}_,........%|
+000002f0  11 8c 78 f0 50 06 59 6d  d0 98 d7 20 64 c5 79 ba  |..x.P.Ym... d.y.|
+00000300  0f 3a 60 5d cc f9 03 7f  a7 10 22 38 78 e7 82 0f  |.:`]......"8x...|
+00000310  b3 d8 38 89 46 bb 75 42  59 8e e2 53 3f 0c 14 5e  |..8.F.uBY..S?..^|
+00000320  6e dd b1 c7 3e 0d ba bf  02 0a 64 d8 33 2f 1d 10  |n...>.....d.3/..|
+00000330  30 03 fc be f3 af 1b 0b  a9 05 31 e7 32 c3 41 9d  |0.........1.2.A.|
+00000340  2e 00 02 a0 71 42 f9 49  df eb 48 63 71 df 09 63  |....qB.I..Hcq..c|
+00000350  5f 9c 34 18 43 32 30 75  c3 6d de 8e a2 14 03 03  |_.4.C20u.m......|
+00000360  00 19 00 00 00 00 00 00  00 06 da 28 dc 12 7b 5d  |...........(..{]|
+00000370  41 c4 ea b9 e1 a1 d4 ab  05 c3 1b 16 03 03 00 28  |A..............(|
+00000380  00 00 00 00 00 00 00 00  ce 17 3c 16 85 79 e9 b8  |..........<..y..|
+00000390  93 ee df 0f 87 ab 3a 5f  bb 64 0f f3 59 0d 35 87  |......:_.d..Y.5.|
+000003a0  2b 06 4d 43 9e 3a f7 72                           |+.MC.:.r|
 >>> Flow 10 (server to client)
-00000000  14 03 03 00 19 29 f3 ac  3d c8 6d 0c c3 1c 92 f7  |.....)..=.m.....|
-00000010  3f c4 1e c9 d0 16 44 4e  c0 95 18 a7 31 93 16 03  |?.....DN....1...|
-00000020  03 00 28 3c f8 a4 be d9  b2 97 71 b0 02 2b a6 74  |..(<......q..+.t|
-00000030  26 e0 d1 dc fb 5e 80 13  4a 4c ef ee 85 4a d0 53  |&....^..JL...J.S|
-00000040  a9 0f a1 44 15 90 f3 6b  d4 2e 2e 17 03 03 00 21  |...D...k.......!|
-00000050  3c f8 a4 be d9 b2 97 72  d0 2b 1b db 4b 45 93 eb  |<......r.+..KE..|
-00000060  6a 9f 79 84 32 ec de 4e  6f 4d 40 d2 51 af e9 46  |j.y.2..NoM@.Q..F|
-00000070  89 16 03 03 00 1c 3c f8  a4 be d9 b2 97 73 f2 99  |......<......s..|
-00000080  89 f3 d9 74 af f5 b8 5f  bc 04 fe f3 67 20 3f 3a  |...t..._....g ?:|
-00000090  3d 25                                             |=%|
+00000000  14 03 03 00 19 d5 b6 c4  29 29 df 16 e2 4a a4 51  |........))...J.Q|
+00000010  c8 7b 79 11 78 29 f0 64  44 70 52 fa 52 8d 16 03  |.{y.x).dDpR.R...|
+00000020  03 00 28 ce 2a 17 67 6b  54 f1 47 d5 70 2f c6 a9  |..(.*.gkT.G.p/..|
+00000030  05 08 32 a0 fd 6a 3f cd  a6 3f c6 82 a7 52 e2 bb  |..2..j?..?...R..|
+00000040  bf 20 39 f4 9c fe 09 a0  43 1b 67 17 03 03 00 21  |. 9.....C.g....!|
+00000050  ce 2a 17 67 6b 54 f1 48  b0 87 d9 2e f5 cc 2a de  |.*.gkT.H......*.|
+00000060  72 76 57 41 18 3d 5b 13  73 c3 0c 81 b8 a2 59 b6  |rvWA.=[.s.....Y.|
+00000070  84 16 03 03 00 1c ce 2a  17 67 6b 54 f1 49 11 da  |.......*.gkT.I..|
+00000080  63 9e 68 53 c5 e2 f1 b8  94 68 b6 e7 42 80 24 9f  |c.hS.....h..B.$.|
+00000090  fd ff                                             |..|
 >>> Flow 11 (client to server)
-00000000  15 03 03 00 1a 00 00 00  00 00 00 00 01 3e 03 9b  |.............>..|
-00000010  14 92 cf 34 45 d0 e6 94  fd c4 9c 14 58 8b e5 15  |...4E.......X...|
-00000020  03 03 00 1a 00 00 00 00  00 00 00 02 7b 6d 0c ee  |............{m..|
-00000030  ae 77 a8 12 1f ea 4b 4a  f3 9e 58 2d 8e 28        |.w....KJ..X-.(|
+00000000  15 03 03 00 1a 00 00 00  00 00 00 00 01 dd 54 03  |..............T.|
+00000010  74 9c e9 bd 9a 25 c3 dd  2d 92 76 e6 a3 8c f8 15  |t....%..-.v.....|
+00000020  03 03 00 1a 00 00 00 00  00 00 00 02 44 99 ff f4  |............D...|
+00000030  f2 45 00 b3 0b 1c 14 90  38 e2 4e 80 71 ce        |.E......8.N.q.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected b/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected
index 678bfdb609..a824099ccb 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 0d aa 10 87 54  |....Y...U......T|
-00000010  c4 b8 34 96 39 d5 bb 7f  82 8f 01 74 3e ef fc 88  |..4.9......t>...|
-00000020  b9 b0 02 d5 a0 98 b6 4c  fe d1 bb 20 37 30 b4 1e  |.......L... 70..|
-00000030  6b a2 33 9f 7a eb 4e 9c  59 de 57 5d 2b a7 80 a5  |k.3.z.N.Y.W]+...|
-00000040  f5 e7 64 3d fa 2d 91 02  74 8c e2 f2 c0 2f 00 00  |..d=.-..t..../..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 bf 1a 08 27 45  |....Y...U.....'E|
+00000010  0a 77 6e 2a 2e 86 6d 5f  90 13 84 99 ff d5 3e 7a  |.wn*..m_......>z|
+00000020  39 87 cf d5 6f 68 8e 68  7d 47 59 20 79 cd 8b 6a  |9...oh.h}GY y..j|
+00000030  70 88 0b 0d f3 d4 08 f3  99 2f c2 4a b3 f3 a7 89  |p......../.J....|
+00000040  ab f6 0c 91 9a f0 b1 aa  2f 27 3e 92 c0 2f 00 00  |......../'>../..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,44 +54,40 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  cd 0c 00 00 c9 03 00 17  41 04 c9 6b 86 80 19 10  |........A..k....|
-000002d0  ce 09 18 3b 64 f8 b1 a2  ab 7c 93 90 e5 be a4 34  |...;d....|.....4|
-000002e0  7f df b4 54 89 93 8b 60  fb 5d b3 05 74 65 dc b3  |...T...`.]..te..|
-000002f0  c8 86 71 7d bf 16 bc 96  95 47 43 d8 f0 a3 88 b7  |..q}.....GC.....|
-00000300  dc a2 0d c4 86 65 f3 d4  5e 69 04 01 00 80 69 45  |.....e..^i....iE|
-00000310  c7 29 bf 55 23 d2 56 03  68 dd d1 d5 d4 fd 0f a7  |.).U#.V.h.......|
-00000320  27 93 fc 63 57 a1 64 fc  0b 5e 83 72 19 73 2e 48  |'..cW.d..^.r.s.H|
-00000330  89 10 33 db ec bb d9 ad  f6 55 0d 28 df b6 3e 3c  |..3......U.(..><|
-00000340  d4 c7 29 d3 49 58 be e3  b6 9a 1f e9 6b 13 df 7b  |..).IX......k..{|
-00000350  ab 05 d1 b3 c4 2f 50 9e  6b d6 91 91 07 17 0c 3d  |...../P.k......=|
-00000360  2e 10 c6 02 43 b3 aa 52  70 0a 02 bd a6 e5 7c 92  |....C..Rp.....|.|
-00000370  b0 3a f4 c2 e6 cd f5 b4  b3 31 5f 79 92 65 5d cc  |.:.......1_y.e].|
-00000380  8b fa bd f5 1e 0a bc a8  b4 53 fe a6 94 76 16 03  |.........S...v..|
-00000390  03 00 04 0e 00 00 00                              |.......|
+000002c0  ac 0c 00 00 a8 03 00 1d  20 e3 0e 3b be 13 b7 01  |........ ..;....|
+000002d0  32 0e bf ab ee 5d ea e1  79 f4 16 34 b3 ce 5d e4  |2....]..y..4..].|
+000002e0  8b 4d a2 ef 83 78 b2 ab  60 04 01 00 80 31 3f da  |.M...x..`....1?.|
+000002f0  24 88 42 84 73 4e 0b 80  7c d8 a1 c0 c2 c8 b6 27  |$.B.sN..|......'|
+00000300  df 41 23 0a 30 91 3f 01  cc d2 8b 66 03 4b 63 c1  |.A#.0.?....f.Kc.|
+00000310  02 18 b5 44 77 ae 7e 7d  eb b5 5c 76 fc c9 c5 ec  |...Dw.~}..\v....|
+00000320  27 71 a1 09 c1 34 6f 48  10 4d da e0 21 4b 30 32  |'q...4oH.M..!K02|
+00000330  9b 71 34 6b 6e 79 a3 80  2c 2b 85 5d 3c 44 4f 64  |.q4kny..,+.]<DOd|
+00000340  f3 d1 85 ad 03 41 8c 84  ff ab 95 0e d2 8d d0 8b  |.....A..........|
+00000350  31 78 f7 78 06 56 97 28  49 6c 01 0f 1e a7 b4 be  |1x.x.V.(Il......|
+00000360  b0 88 7a 44 68 f3 fc a2  1d 36 a6 e0 cc 16 03 03  |..zDh....6......|
+00000370  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
-00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
-00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
-00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
-00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 3e 37  |.....(........>7|
-00000060  59 15 7b c7 5f aa 2f 10  6b d1 00 f1 a0 64 2b c9  |Y.{._./.k....d+.|
-00000070  3b 38 c1 92 63 b8 9b bf  ec 01 b7 a5 91 52        |;8..c........R|
+00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
+00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
+00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
+00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 8d 66 75  |....(.........fu|
+00000040  38 f8 b0 d3 0d 81 49 01  73 1e eb 1d 00 71 08 d9  |8.....I.s....q..|
+00000050  87 20 83 14 4c 54 f1 60  61 4d 19 53 42           |. ..LT.`aM.SB|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 96 3b 97 5d 87  |..........(.;.].|
-00000010  1a de f5 b7 11 86 32 12  eb 41 59 8a 29 b5 20 bd  |......2..AY.). .|
-00000020  35 7b 47 c7 94 6e c4 d4  4e 58 08 d2 9c 05 05 8f  |5{G..n..NX......|
-00000030  4e 94 ac                                          |N..|
+00000000  14 03 03 00 01 01 16 03  03 00 28 23 7e 00 58 a6  |..........(#~.X.|
+00000010  9c 0b ad 95 ad 99 7e d0  ff e3 ef 7c 14 c8 49 39  |......~....|..I9|
+00000020  0e 46 24 16 22 a7 94 51  9c c6 8d 8a cb f1 66 14  |.F$."..Q......f.|
+00000030  99 fd 15                                          |...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 cb cd d9  |................|
-00000010  59 33 0a f1 59 9f 21 86  15 ed cd 3d 5f 21 4c dd  |Y3..Y.!....=_!L.|
-00000020  21 0b 54                                          |!.T|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 94 e4 ff  |................|
+00000010  cd 27 dd 2b c7 3d ee c1  95 b9 85 e9 46 68 2e 68  |.'.+.=......Fh.h|
+00000020  f2 4e 10                                          |.N.|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 1c 96 3b 97  5d 87 1a de f6 0c 74 11  |......;.].....t.|
-00000010  ff 59 13 7f f2 0d 64 df  38 d9 2b 37 2c 9e 0d eb  |.Y....d.8.+7,...|
-00000020  2a                                                |*|
+00000000  16 03 03 00 1c 23 7e 00  58 a6 9c 0b ae 3b 83 b7  |.....#~.X....;..|
+00000010  9d 40 bc d7 47 ea a8 f4  4e 37 50 e3 d7 21 92 8d  |.@..G...N7P..!..|
+00000020  b7                                                |.|
 >>> Flow 7 (client to server)
-00000000  15 03 03 00 1a 00 00 00  00 00 00 00 02 59 28 2e  |.............Y(.|
-00000010  9f a2 16 fd 1b 4a e8 97  72 a6 a3 ed 7d 63 4d 15  |.....J..r...}cM.|
-00000020  03 03 00 1a 00 00 00 00  00 00 00 03 ca db 71 6b  |..............qk|
-00000030  e8 54 f2 da 95 0a 25 e0  c6 70 f0 d9 62 bd        |.T....%..p..b.|
+00000000  15 03 03 00 1a 00 00 00  00 00 00 00 02 98 b4 1c  |................|
+00000010  2c c3 7c a1 9c 8c 09 b0  0a d1 d5 f4 99 ed 64 15  |,.|...........d.|
+00000020  03 03 00 1a 00 00 00 00  00 00 00 03 16 2a 34 39  |.............*49|
+00000030  17 2a 3b 3a e9 88 99 e8  b1 d9 d2 47 41 d8        |.*;:.......GA.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-SCT b/src/crypto/tls/testdata/Client-TLSv12-SCT
index d5060b1210..dcc706c702 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-SCT
+++ b/src/crypto/tls/testdata/Client-TLSv12-SCT
@@ -1,19 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
 00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
 00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
-00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
-00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
-00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
+00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
+00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
+00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
+00000090  00 00                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 01 c6 02 00 01  c2 03 03 5b 23 16 eb 30  |...........[#..0|
-00000010  c0 5d 25 18 5b 72 0a f4  ab 14 53 84 02 fd d0 7a  |.]%.[r....S....z|
-00000020  f3 e6 55 9c 07 ea e0 f2  0d 26 66 20 31 33 71 51  |..U......&f 13qQ|
-00000030  94 0f 63 20 f2 b4 ea 55  94 91 bf c4 df 84 21 a6  |..c ...U......!.|
-00000040  e8 8a 7b ca 43 6f 43 69  7a 31 01 be c0 2f 00 01  |..{.CoCiz1.../..|
+00000000  16 03 03 01 c6 02 00 01  c2 03 03 c5 2c ed 73 81  |............,.s.|
+00000010  42 44 d2 72 10 7e 8d d4  91 c3 5e 47 54 34 c8 3a  |BD.r.~....^GT4.:|
+00000020  90 1c 28 1d 02 b7 45 a8  5d db dc 20 35 81 26 bc  |..(...E.].. 5.&.|
+00000030  db 5d f3 47 e4 85 24 f6  7c 84 47 b9 5f fa 24 0c  |.].G..$.|.G._.$.|
+00000040  a5 61 35 50 fd e7 61 cb  f0 44 3d 77 c0 2f 00 01  |.a5P..a..D=w./..|
 00000050  7a ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 12  |z...............|
 00000060  01 69 01 67 00 75 00 a4  b9 09 90 b4 18 58 14 87  |.i.g.u.......X..|
 00000070  bb 13 a2 cc 67 70 0a 3c  35 98 04 f9 1b df b8 e3  |....gp.<5.......|
@@ -75,38 +76,34 @@
 000003f0  5c ee b1 87 82 f1 6c 04  ed 73 bb b3 43 77 8d 0c  |\.....l..s..Cw..|
 00000400  1c f1 0f a1 d8 40 83 61  c9 4c 72 2b 9d ae db 46  |.....@.a.Lr+...F|
 00000410  06 06 4d f4 c1 b3 3e c0  d1 bd 42 d4 db fe 3d 13  |..M...>...B...=.|
-00000420  60 84 5c 21 d3 3b e9 fa  e7 16 03 03 00 cd 0c 00  |`.\!.;..........|
-00000430  00 c9 03 00 17 41 04 bc  10 c9 49 47 0a 48 cb 16  |.....A....IG.H..|
-00000440  5c bb e6 f6 74 59 df 9c  e9 f3 00 c1 52 69 78 ab  |\...tY......Rix.|
-00000450  65 0b 5e 9f 66 88 31 68  b9 70 03 f7 ae 37 ea c8  |e.^.f.1h.p...7..|
-00000460  4b 7e 09 46 0a af 46 6c  18 4d 34 87 fb d3 bf 3f  |K~.F..Fl.M4....?|
-00000470  44 c5 9e e9 8e 73 b7 04  01 00 80 32 61 11 ce 00  |D....s.....2a...|
-00000480  cb a4 af 1a e8 f8 b2 a4  62 b1 b9 0f 76 8a 46 d0  |........b...v.F.|
-00000490  08 1b 50 76 a1 a6 a4 69  29 77 96 ed 1f c5 f3 cd  |..Pv...i)w......|
-000004a0  92 21 10 2b f3 55 c9 e8  b4 e7 58 1b c9 83 30 01  |.!.+.U....X...0.|
-000004b0  c6 e5 a4 22 ca 9e 12 a5  2d 7f f2 e2 87 df 8b 46  |..."....-......F|
-000004c0  d3 37 28 4f 33 1f d8 27  a4 f1 8a 32 28 fc f7 1f  |.7(O3..'...2(...|
-000004d0  2a 68 10 cd 32 c8 99 ef  b4 e0 52 cd 47 9d 16 35  |*h..2.....R.G..5|
-000004e0  bc 6f c0 8a e5 b9 5c 57  1c 26 5c 45 61 e3 5e d3  |.o....\W.&\Ea.^.|
-000004f0  a4 dc 7d c7 d6 2c 80 77  81 0b 10 16 03 03 00 04  |..}..,.w........|
-00000500  0e 00 00 00                                       |....|
+00000420  60 84 5c 21 d3 3b e9 fa  e7 16 03 03 00 ac 0c 00  |`.\!.;..........|
+00000430  00 a8 03 00 1d 20 36 fb  e2 0e 7c d0 a4 e6 6a 11  |..... 6...|...j.|
+00000440  b0 da 6f b9 d5 d5 27 73  3d 24 4e 06 0d 50 85 81  |..o...'s=$N..P..|
+00000450  13 94 25 dc 2c 6a 04 01  00 80 54 9b 72 01 e9 91  |..%.,j....T.r...|
+00000460  f3 71 62 c2 4e 8b 2f fa  d4 1f 8b 7f 87 0e c4 70  |.qb.N./........p|
+00000470  22 aa 93 05 2f ae 77 75  e4 16 c0 7a 0b 95 e2 60  |".../.wu...z...`|
+00000480  95 b6 a3 52 77 9a 0e cd  ab f6 af 29 28 df f1 97  |...Rw......)(...|
+00000490  56 50 54 c6 c8 ac a6 cd  a8 c1 ba 56 e1 a7 37 7f  |VPT........V..7.|
+000004a0  a6 20 ae b7 74 5b a8 66  7a c0 ef 41 02 2d ab e4  |. ..t[.fz..A.-..|
+000004b0  9e f4 44 30 49 50 8d 83  5b 0d 8c d7 31 04 f2 bc  |..D0IP..[...1...|
+000004c0  63 bf 23 8e b8 59 2b cd  0c 69 10 02 66 06 d9 74  |c.#..Y+..i..f..t|
+000004d0  33 db 7f 66 15 9f 99 f0  f7 ef 16 03 03 00 04 0e  |3..f............|
+000004e0  00 00 00                                          |...|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
-00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
-00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
-00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
-00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 c5 d9  |.....(..........|
-00000060  a8 f3 c8 f7 ee 39 b5 14  40 34 97 92 b4 cf ac ff  |.....9..@4......|
-00000070  a2 d4 71 ed 0f d1 c2 c3  e5 7d 94 77 89 7e        |..q......}.w.~|
+00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
+00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
+00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
+00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 50 1c 01  |....(........P..|
+00000040  e1 8a 32 e7 59 c3 0c b2  f0 28 e3 8c 9c 46 3e 3a  |..2.Y....(...F>:|
+00000050  fd 3e 4d 36 f7 5d c8 ed  09 94 8f f8 94           |.>M6.].......|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 19 80 f3 14 0b  |..........(.....|
-00000010  50 0f de c7 1f 73 1e b9  b3 f0 d3 5a f0 33 c4 b7  |P....s.....Z.3..|
-00000020  f2 c5 38 99 f2 01 b6 1c  d5 a6 d5 37 4a 52 d1 92  |..8........7JR..|
-00000030  5d 7f cf                                          |]..|
+00000000  14 03 03 00 01 01 16 03  03 00 28 96 72 dd fb 38  |..........(.r..8|
+00000010  e1 ac d5 ad c2 8c 0b 04  f4 6c 3a 1d f2 66 c2 d8  |.........l:..f..|
+00000020  ae 35 c3 4c a0 9c f7 7e  ac 62 63 db 3e f2 cb a5  |.5.L...~.bc.>...|
+00000030  8a 07 ef                                          |...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 36 55 d4  |.............6U.|
-00000010  a4 ef 6d 67 c2 45 61 b5  2d 1f d9 97 3c d2 04 41  |..mg.Ea.-...<..A|
-00000020  f4 43 49 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.CI.............|
-00000030  32 9f df ab 07 f9 e6 5d  0a ad 51 63 fe 3b f6 fd  |2......]..Qc.;..|
-00000040  0a 33                                             |.3|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 96 4c d3  |..............L.|
+00000010  8f ea 8e d0 ba 3d b4 a7  58 ea 8a 00 ea ee 2b 5e  |.....=..X.....+^|
+00000020  03 00 00 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
+00000030  77 9d 24 94 fa 8d ce 41  84 02 13 1e 62 63 1f 14  |w.$....A....bc..|
+00000040  69 c2                                             |i.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-X25519-ECDHE-RSA-AES-GCM b/src/crypto/tls/testdata/Client-TLSv12-X25519-ECDHE-RSA-AES-GCM
index dcbce97762..6ebbd893ec 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-X25519-ECDHE-RSA-AES-GCM
+++ b/src/crypto/tls/testdata/Client-TLSv12-X25519-ECDHE-RSA-AES-GCM
@@ -9,11 +9,11 @@
 00000070  00 00 0d 00 0e 00 0c 04  01 04 03 05 01 05 03 02  |................|
 00000080  01 02 03 ff 01 00 01 00  00 12 00 00              |............|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 64 2f 20 bb e0  |....Y...U..d/ ..|
-00000010  0c 8b 1e d9 fc 96 1d d7  66 02 62 bd 63 d8 52 48  |........f.b.c.RH|
-00000020  61 6d 4e f9 e4 26 43 f2  dd 75 00 20 e9 7d 2b 02  |amN..&C..u. .}+.|
-00000030  39 df 15 b7 24 c8 7a 61  81 cc a4 3a 3f 80 36 e2  |9...$.za...:?.6.|
-00000040  44 fd cd e1 a8 db ad a0  79 2d d3 f6 c0 2f 00 00  |D.......y-.../..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 d3 18 c0 74 b0  |....Y...U.....t.|
+00000010  98 31 6a 21 53 a8 c8 52  07 21 ae 0d 91 2d 8f 5b  |.1j!S..R.!...-.[|
+00000020  fe 84 eb 54 73 1b 3e 83  7c e1 31 20 61 c8 ef 67  |...Ts.>.|.1 a..g|
+00000030  6a f3 0c 82 86 10 f7 12  08 23 ae 25 0f 41 b4 6e  |j........#.%.A.n|
+00000040  3e 66 8b 1d f4 44 8e 81  cc ab e6 4c c0 2f 00 00  |>f...D.....L./..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,33 +53,33 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 27 08 d8 54 80 58 52  |........ '..T.XR|
-000002d0  fa d3 4e ba 1a 49 7b 20  b7 c3 c8 dc 91 42 90 9a  |..N..I{ .....B..|
-000002e0  7d 63 b7 88 16 39 6b 2f  4a 04 01 00 80 97 3b 72  |}c...9k/J.....;r|
-000002f0  f0 94 ef 26 07 b9 37 f5  6a 00 30 34 1f b8 90 46  |...&..7.j.04...F|
-00000300  fc 36 9b 19 9c de 60 c1  9a da 8e a0 94 d5 f9 d8  |.6....`.........|
-00000310  aa f0 c4 7a 3e 0a 55 9e  97 bd 27 09 77 20 a7 72  |...z>.U...'.w .r|
-00000320  bc a0 46 75 96 ab 0b 42  2c 24 06 eb ee 5a 07 cc  |..Fu...B,$...Z..|
-00000330  94 42 25 57 d9 ad a6 ae  28 fe 94 c8 bc ca a8 e0  |.B%W....(.......|
-00000340  9e 18 b0 f2 b5 b5 93 a7  a0 20 17 7e 18 ac 8f cf  |......... .~....|
-00000350  30 ea fd e8 43 25 c1 fc  48 51 5a d2 ef b5 95 13  |0...C%..HQZ.....|
-00000360  6c 37 5a 6b 55 34 8d b0  3c 8f 9e 1b e8 16 03 03  |l7ZkU4..<.......|
+000002c0  ac 0c 00 00 a8 03 00 1d  20 a8 2b 29 68 72 39 78  |........ .+)hr9x|
+000002d0  8f 28 f5 3a fb f9 79 db  cc 52 87 67 2e f9 ee fc  |.(.:..y..R.g....|
+000002e0  bb 40 b7 f5 e4 5f 65 6d  08 04 01 00 80 3b 83 43  |.@..._em.....;.C|
+000002f0  0f 0f 05 1b 50 c7 07 eb  73 23 30 68 ce eb 02 49  |....P...s#0h...I|
+00000300  08 4b 06 b9 05 1f ba 3f  fd 51 a5 55 10 d4 8d fa  |.K.....?.Q.U....|
+00000310  b1 6b 4b b7 46 e4 e5 59  d9 3d fc 50 4c 86 d0 0d  |.kK.F..Y.=.PL...|
+00000320  cd dd c9 cf 86 f8 38 ef  3f 70 27 ea fc 82 ba b9  |......8.?p'.....|
+00000330  c1 36 82 0c ec a8 a5 32  97 f3 64 b5 04 01 36 21  |.6.....2..d...6!|
+00000340  69 4b a4 26 5e 28 e2 06  40 84 48 08 38 a5 0d 87  |iK.&^(..@.H.8...|
+00000350  c2 a5 7b a1 f7 bc 5a 0e  f8 50 9a a5 c5 d9 57 f2  |..{...Z..P....W.|
+00000360  71 71 d6 ec 3f 48 fe 90  ff 88 91 9b 24 16 03 03  |qq..?H......$...|
 00000370  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 17 40 ca  |....(.........@.|
-00000040  78 e3 f2 c9 05 71 6b 37  98 79 21 d0 b1 e1 49 b5  |x....qk7.y!...I.|
-00000050  54 45 35 e9 58 bd f9 60  5f c8 16 e7 42           |TE5.X..`_...B|
+00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 13 06 e2  |....(...........|
+00000040  11 1b 5b d1 a9 96 26 eb  3e db 2f c4 ed d7 55 fc  |..[...&.>./...U.|
+00000050  c3 51 16 be 82 ec d9 97  74 8f c6 bd 74           |.Q......t...t|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 2d d9 e6 e1 eb  |..........(-....|
-00000010  b7 65 e5 f4 fc 56 4a 35  00 0c 90 bf 5f c3 73 dc  |.e...VJ5...._.s.|
-00000020  86 f8 44 2c c7 18 fd ca  24 f6 34 98 5e ef 25 44  |..D,....$.4.^.%D|
-00000030  41 74 4a                                          |AtJ|
+00000000  14 03 03 00 01 01 16 03  03 00 28 e5 77 89 4c b3  |..........(.w.L.|
+00000010  94 20 9b e8 49 07 a6 6d  b1 e9 8f 5e 3c d9 7a db  |. ..I..m...^<.z.|
+00000020  f1 8b 1a f1 92 25 3f 3d  87 db 89 37 37 c0 9c 8d  |.....%?=...77...|
+00000030  29 ee 2a                                          |).*|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 84 48 a7  |..............H.|
-00000010  d1 2e f0 75 1a da f9 d4  bc 88 42 e0 8c 68 09 ae  |...u......B..h..|
-00000020  0a ac 46 15 03 03 00 1a  00 00 00 00 00 00 00 02  |..F.............|
-00000030  0b fb c3 cb 27 17 0c 35  e9 8f 8f 96 dd ce d5 5d  |....'..5.......]|
-00000040  42 44                                             |BD|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 39 86 ce  |.............9..|
+00000010  b1 3e a5 42 81 e0 73 0f  bc 95 eb 8b 35 58 ca f7  |.>.B..s.....5X..|
+00000020  4c 1e 87 15 03 03 00 1a  00 00 00 00 00 00 00 02  |L...............|
+00000030  0f 02 2a 17 15 2a 53 27  7d 7a d1 29 25 b0 8d 61  |..*..*S'}z.)%..a|
+00000040  9f 68                                             |.h|
diff --git a/src/crypto/tls/testdata/Server-SSLv3-RSA-3DES b/src/crypto/tls/testdata/Server-SSLv3-RSA-3DES
index f6cb8e46e3..ec9162b3a9 100644
--- a/src/crypto/tls/testdata/Server-SSLv3-RSA-3DES
+++ b/src/crypto/tls/testdata/Server-SSLv3-RSA-3DES
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 00 00 2f 01 00 00  2b 03 00 24 a1 89 3a e8  |..../...+..$..:.|
-00000010  17 0f 35 02 cf 11 e8 31  71 5d ba f4 82 f1 f4 a1  |..5....1q]......|
-00000020  63 61 2a 99 28 5f 9a 8b  21 ea 00 00 00 04 00 0a  |ca*.(_..!.......|
+00000000  16 03 00 00 2f 01 00 00  2b 03 00 07 be 0a 0c 3a  |..../...+......:|
+00000010  70 ad 1a 60 e2 e4 63 91  1b 93 c8 ef 10 95 24 5e  |p..`..c.......$^|
+00000020  95 e9 f7 82 2c 42 4f 74  44 90 3b 00 00 04 00 0a  |....,BOtD.;.....|
 00000030  00 ff 01 00                                       |....|
 >>> Flow 2 (server to client)
 00000000  16 03 00 00 31 02 00 00  2d 03 00 00 00 00 00 00  |....1...-.......|
@@ -47,30 +47,30 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 00 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 00 00 84 10 00 00  80 c5 e0 de 32 09 54 8b  |............2.T.|
-00000010  8f a1 7c 5c fa 4f 04 d7  66 52 52 14 a0 03 28 21  |..|\.O..fRR...(!|
-00000020  9a 40 e8 d1 21 66 de 85  1a 9f 73 ea e3 6f 8c ef  |.@..!f....s..o..|
-00000030  7f 80 0d 00 2a 68 27 0a  7a 0b 4b 7d a4 a6 e7 0b  |....*h'.z.K}....|
-00000040  61 35 0c 1d 9b c9 7c a8  d8 e8 3b 8a 10 7e c0 5e  |a5....|...;..~.^|
-00000050  e9 d3 ac e1 2a 28 c3 68  d3 ab 96 6d cf 3a 70 f7  |....*(.h...m.:p.|
-00000060  12 a0 85 52 20 38 ef 20  04 df f4 f5 57 0a 99 97  |...R 8. ....W...|
-00000070  da 24 0b c3 81 9e 69 c3  9a cc 5f 69 80 40 93 24  |.$....i..._i.@.$|
-00000080  5a 78 61 be 7d 14 91 50  ad 14 03 00 00 01 01 16  |Zxa.}..P........|
-00000090  03 00 00 40 e9 b5 fa 8a  0c e6 58 1a a6 05 ef 49  |...@......X....I|
-000000a0  75 bd a4 05 af 6b cd 08  65 88 ee 04 b7 49 d1 bc  |u....k..e....I..|
-000000b0  a6 0e 83 37 6b 5d 7e 5d  4b 84 4a ab 7e 3c fe 87  |...7k]~]K.J.~<..|
-000000c0  d8 da bd 88 c9 3a a9 2a  61 49 bf ff ac 10 81 b6  |.....:.*aI......|
-000000d0  f8 f8 10 a8                                       |....|
+00000000  16 03 00 00 84 10 00 00  80 0b 53 ae 4b 24 12 d9  |..........S.K$..|
+00000010  66 2e f6 3f 3b f4 4f 75  0d 0f a2 40 3f db 8c 04  |f..?;.Ou...@?...|
+00000020  db 31 d4 12 3b 72 26 1e  70 4a bc ec 40 97 40 9c  |.1..;r&.pJ..@.@.|
+00000030  44 2d 11 ac ae 47 47 bb  46 bb 0a 47 bc e5 d7 3b  |D-...GG.F..G...;|
+00000040  b4 a3 df c7 cf 60 46 94  e7 5d 7d 00 49 b8 1e 5a  |.....`F..]}.I..Z|
+00000050  e9 71 e0 80 ff d8 d6 bb  22 8a 1a f8 1c a8 83 06  |.q......".......|
+00000060  12 bc e1 1e 2d fa 14 6f  7b 0f fb 85 ad b7 3d 5c  |....-..o{.....=\|
+00000070  b3 9e 83 05 05 d8 e9 ae  bc 82 29 ab 95 78 72 5a  |..........)..xrZ|
+00000080  a3 12 71 ff a4 ba e0 c5  56 14 03 00 00 01 01 16  |..q.....V.......|
+00000090  03 00 00 40 f0 85 00 68  b5 a7 cb d1 2f 52 c4 a2  |...@...h..../R..|
+000000a0  ab a1 41 64 21 b8 d3 e4  97 fb 08 a4 86 8e 59 94  |..Ad!.........Y.|
+000000b0  3e 24 e6 b9 4d 4f 3a ac  e6 91 dd 82 59 e8 7d ca  |>$..MO:.....Y.}.|
+000000c0  bc d0 e8 85 08 14 f9 05  2e fc e5 a3 bc 9c 88 65  |...............e|
+000000d0  93 b8 be 25                                       |...%|
 >>> Flow 4 (server to client)
-00000000  14 03 00 00 01 01 16 03  00 00 40 ec 2d 5a ad c6  |..........@.-Z..|
-00000010  3f a4 cb 6c af e5 fd 24  d1 d5 79 cc 91 f3 fb d6  |?..l...$..y.....|
-00000020  01 3a 0a 2c cf 89 ae 90  49 48 83 cc f8 85 b4 1f  |.:.,....IH......|
-00000030  ff 93 60 25 5f 05 b9 fd  5d ef 8d fa 87 5a a6 77  |..`%_...]....Z.w|
-00000040  c9 ee 8f bb a1 28 52 5c  6e a8 42 17 03 00 00 18  |.....(R\n.B.....|
-00000050  14 a5 b1 7c df 66 c2 f3  1c f6 ef c9 c6 c2 1c 11  |...|.f..........|
-00000060  91 b0 d4 6a a9 a7 80 c3  17 03 00 00 28 cc 2e d8  |...j........(...|
-00000070  63 5b a4 dd 44 51 22 7f  1f 1a a3 ae 42 ae e9 21  |c[..DQ".....B..!|
-00000080  fc 6c ec 07 25 28 1a 3e  e8 e6 e6 15 8f 80 76 e3  |.l..%(.>......v.|
-00000090  56 89 c6 20 0b 15 03 00  00 18 5d 5f d7 ff 88 34  |V.. ......]_...4|
-000000a0  8d 7d 1b 81 ed 29 3e 1b  05 7b 48 47 69 fb 02 32  |.}...)>..{HGi..2|
-000000b0  1c 87                                             |..|
+00000000  14 03 00 00 01 01 16 03  00 00 40 46 58 3a 0e 47  |..........@FX:.G|
+00000010  b9 be 1e af b5 3d 61 34  d0 8d 0b 41 b7 de 3c 04  |.....=a4...A..<.|
+00000020  24 4f 50 c0 ba 64 1f c8  b0 3e 4e cb e7 56 bb fc  |$OP..d...>N..V..|
+00000030  d9 ff 18 88 85 1e 40 cd  d0 c9 ed d2 49 af 16 14  |......@.....I...|
+00000040  35 d5 0b b2 ce 68 bf b0  52 2c 70 17 03 00 00 18  |5....h..R,p.....|
+00000050  14 44 b1 72 b9 f4 cc eb  4f 53 88 c8 89 26 d3 02  |.D.r....OS...&..|
+00000060  65 66 6e e5 d2 0c 67 98  17 03 00 00 28 fb d9 98  |efn...g.....(...|
+00000070  8d 59 96 5e 1b 4c 28 88  42 83 f3 58 ed 5a fe 05  |.Y.^.L(.B..X.Z..|
+00000080  77 6d 64 49 54 c8 1a 57  ac f9 14 15 61 ea d2 29  |wmdIT..W....a..)|
+00000090  e4 1c 91 46 f7 15 03 00  00 18 a4 f2 67 43 7b e9  |...F........gC{.|
+000000a0  99 35 05 f4 5e 6f a1 36  c3 06 2b 0b d0 75 dc 98  |.5..^o.6..+..u..|
+000000b0  59 ad                                             |Y.|
diff --git a/src/crypto/tls/testdata/Server-SSLv3-RSA-AES b/src/crypto/tls/testdata/Server-SSLv3-RSA-AES
index 647eddb642..6bdd75e900 100644
--- a/src/crypto/tls/testdata/Server-SSLv3-RSA-AES
+++ b/src/crypto/tls/testdata/Server-SSLv3-RSA-AES
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 00 00 2f 01 00 00  2b 03 00 f6 aa e8 ab 4b  |..../...+......K|
-00000010  a0 ca 86 5d bf ca 26 5b  b6 75 3b 97 dc 3d 25 51  |...]..&[.u;..=%Q|
-00000020  d3 f9 c7 af 7a 76 4f 55  54 6d 4f 00 00 04 00 2f  |....zvOUTmO..../|
+00000000  16 03 00 00 2f 01 00 00  2b 03 00 86 5f 7b c1 4d  |..../...+..._{.M|
+00000010  b6 d6 fb 10 1e bd 5c 89  a3 d8 f3 e4 e3 ad 49 86  |......\.......I.|
+00000020  be a8 f1 5a fc 48 7d b7  43 89 0d 00 00 04 00 2f  |...Z.H}.C....../|
 00000030  00 ff 01 00                                       |....|
 >>> Flow 2 (server to client)
 00000000  16 03 00 00 31 02 00 00  2d 03 00 00 00 00 00 00  |....1...-.......|
@@ -47,31 +47,31 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 00 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 00 00 84 10 00 00  80 3d 72 68 31 73 65 81  |.........=rh1se.|
-00000010  2f 15 5b 7b d2 c0 34 2a  f9 95 1a fa c1 07 c0 1f  |/.[{..4*........|
-00000020  e8 35 3c 32 58 a0 e3 c1  8a ff 23 78 18 5e 32 29  |.5<2X.....#x.^2)|
-00000030  66 ef 08 b0 29 d5 92 f8  23 5b a9 55 14 ca 00 9f  |f...)...#[.U....|
-00000040  12 86 50 49 1f 5b 55 13  d1 f0 fc da 95 54 75 8e  |..PI.[U......Tu.|
-00000050  55 5c 00 6d e6 8e 54 9e  d1 8a 05 fe a9 a5 c7 85  |U\.m..T.........|
-00000060  45 8b f6 f9 5b 96 04 f9  f2 7b 01 01 4b 5f e3 5c  |E...[....{..K_.\|
-00000070  c0 5a 9c 54 a5 1f e8 d0  92 5d ca af 5d db 4e f3  |.Z.T.....]..].N.|
-00000080  fb 24 98 b5 01 5e 21 58  b1 14 03 00 00 01 01 16  |.$...^!X........|
-00000090  03 00 00 40 4c 0e 28 67  35 3a fb 62 a8 f1 1c 2d  |...@L.(g5:.b...-|
-000000a0  da 41 56 a2 47 5b 6b 7d  e6 ee ca 94 05 57 af cf  |.AV.G[k}.....W..|
-000000b0  a5 2b d9 a0 58 a4 ff 01  e8 29 33 a7 90 fa 35 cc  |.+..X....)3...5.|
-000000c0  33 92 84 62 3b 99 bd 83  c2 c1 68 56 c2 18 bc 22  |3..b;.....hV..."|
-000000d0  d6 2f 7d 37                                       |./}7|
+00000000  16 03 00 00 84 10 00 00  80 62 b2 02 df a7 af 20  |.........b..... |
+00000010  cb 59 b7 1b 70 26 00 18  2c c8 14 25 fb 3d f2 ec  |.Y..p&..,..%.=..|
+00000020  b0 52 83 c6 7c 1f dd 60  64 32 98 aa 5a 4f 48 df  |.R..|..`d2..ZOH.|
+00000030  14 f5 c3 6c dd 50 ac 14  27 f4 c9 08 e2 c7 e4 0d  |...l.P..'.......|
+00000040  ae 31 61 dd 39 03 f5 b4  92 d1 c7 67 a9 cf d0 d5  |.1a.9......g....|
+00000050  1a 00 9a 6a aa 16 d5 c3  16 1d 38 20 67 93 41 92  |...j......8 g.A.|
+00000060  14 41 26 6d 7f 2e 25 92  4d ac bd 1a e6 d3 91 33  |.A&m..%.M......3|
+00000070  c9 9b d2 0c 1f d2 2c 36  0f 2b b0 e8 15 1f 1a 5b  |......,6.+.....[|
+00000080  f4 00 7f db e9 01 e0 85  c9 14 03 00 00 01 01 16  |................|
+00000090  03 00 00 40 7b ac 74 d9  51 7c db 62 e0 60 31 89  |...@{.t.Q|.b.`1.|
+000000a0  52 cd c2 77 e7 fe fd 8e  23 43 9f 7d e4 36 5c c7  |R..w....#C.}.6\.|
+000000b0  2c 41 27 09 59 48 1e 93  7b 8b 03 18 6c ce 6c 72  |,A'.YH..{...l.lr|
+000000c0  9a 0e 5b 87 7b 97 76 b6  ce b8 2e 98 19 e7 04 a9  |..[.{.v.........|
+000000d0  cd 8e 9a f9                                       |....|
 >>> Flow 4 (server to client)
-00000000  14 03 00 00 01 01 16 03  00 00 40 3a 79 26 3a 75  |..........@:y&:u|
-00000010  84 84 1e bc 09 02 1e 2f  96 8b d3 e9 ed f6 3f b5  |......./......?.|
-00000020  5c ea 6e f8 c0 9c ff c8  d4 8c 1f 0c 45 51 32 30  |\.n.........EQ20|
-00000030  60 a1 54 8e a8 d0 2c 16  97 6b 2e 56 2c f3 b9 69  |`.T...,..k.V,..i|
-00000040  f2 80 3b c9 a6 d3 53 de  e4 61 e8 17 03 00 00 20  |..;...S..a..... |
-00000050  51 ab 4e 58 99 62 26 98  63 34 3a ee aa dc 74 17  |Q.NX.b&.c4:...t.|
-00000060  a4 43 a7 97 53 18 3f 1c  43 f4 04 2d ba 8d f5 29  |.C..S.?.C..-...)|
-00000070  17 03 00 00 30 3c 31 84  e4 57 fa e5 ed f1 e6 8b  |....0<1..W......|
-00000080  8a d7 2e af 97 88 91 4d  b3 f1 63 99 1c c9 30 74  |.......M..c...0t|
-00000090  50 f6 a1 9d a3 4a 6b 5b  30 61 5b a7 7e b6 5f 24  |P....Jk[0a[.~._$|
-000000a0  09 af af 52 a9 15 03 00  00 20 5f a3 4e f7 60 bd  |...R..... _.N.`.|
-000000b0  a4 19 44 24 09 3b fe 0f  ea 75 e8 f9 79 80 0a 37  |..D$.;...u..y..7|
-000000c0  18 98 3f 56 4b 3e 21 eb  70 82                    |..?VK>!.p.|
+00000000  14 03 00 00 01 01 16 03  00 00 40 3b 7c 65 fa a4  |..........@;|e..|
+00000010  dc 7a 8d ba 59 23 b7 44  e8 c8 01 95 60 19 9a a1  |.z..Y#.D....`...|
+00000020  6e 33 c8 0a 06 f2 9c ae  d7 f4 f7 99 2e 33 92 de  |n3...........3..|
+00000030  0d 81 13 8f 82 f3 2b 71  fa c5 97 9d 64 a0 b3 f5  |......+q....d...|
+00000040  c6 f2 4b dd 1a 8c c6 49  61 e0 cf 17 03 00 00 20  |..K....Ia...... |
+00000050  e6 0e 8a 0d 1d 87 bb 07  5e dc ed 48 c8 99 c3 87  |........^..H....|
+00000060  55 d4 51 c9 c7 a8 47 57  e5 0c 8b 93 01 8a 46 46  |U.Q...GW......FF|
+00000070  17 03 00 00 30 55 56 66  a2 9e e1 43 91 06 38 fa  |....0UVf...C..8.|
+00000080  81 bf 0a d1 68 8d 0d 80  a9 ee 7d 90 f4 15 2f e6  |....h.....}.../.|
+00000090  cb 11 3b 63 91 54 b6 7d  62 5d 79 57 1d 3b b7 d1  |..;c.T.}b]yW.;..|
+000000a0  71 75 63 5c f8 15 03 00  00 20 fc 44 3a bc 00 d9  |quc\..... .D:...|
+000000b0  7e ed c6 ad 77 27 98 af  4b 1a 84 d5 90 6c 7e 2e  |~...w'..K....l~.|
+000000c0  c3 d8 b9 a4 74 77 65 08  72 b0                    |....twe.r.|
diff --git a/src/crypto/tls/testdata/Server-SSLv3-RSA-RC4 b/src/crypto/tls/testdata/Server-SSLv3-RSA-RC4
index 2868d6ba8d..7da1078c3d 100644
--- a/src/crypto/tls/testdata/Server-SSLv3-RSA-RC4
+++ b/src/crypto/tls/testdata/Server-SSLv3-RSA-RC4
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 00 00 2f 01 00 00  2b 03 00 6e 74 3e 5d f4  |..../...+..nt>].|
-00000010  b5 4a 4a 5b d6 fc 29 d8  be 87 68 cf ce a5 ee 14  |.JJ[..)...h.....|
-00000020  8a 7a 44 1d 03 27 8c fd  00 1b 83 00 00 04 00 05  |.zD..'..........|
+00000000  16 03 00 00 2f 01 00 00  2b 03 00 8d 0b 00 b4 a0  |..../...+.......|
+00000010  73 70 84 0e b0 5c 82 9f  5c 36 ed 55 c4 a7 cd 4b  |sp...\..\6.U...K|
+00000020  93 cc 06 59 9a fb 2a 6e  4d 7f 17 00 00 04 00 05  |...Y..*nM.......|
 00000030  00 ff 01 00                                       |....|
 >>> Flow 2 (server to client)
 00000000  16 03 00 00 31 02 00 00  2d 03 00 00 00 00 00 00  |....1...-.......|
@@ -47,26 +47,26 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 00 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 00 00 84 10 00 00  80 0d 70 3b bc b1 b4 f8  |..........p;....|
-00000010  4e f7 9c 7e c6 33 c9 d2  af 4d ae 0f 65 55 68 1c  |N..~.3...M..eUh.|
-00000020  a0 af ad cc cd 25 a8 05  31 d8 50 11 45 cc 44 e6  |.....%..1.P.E.D.|
-00000030  89 1e a6 76 12 0e 8a ac  a6 d3 6c 53 69 d5 e4 6d  |...v......lSi..m|
-00000040  37 90 b8 af b7 ab 3e 84  d2 7e 42 27 81 0d c4 f8  |7.....>..~B'....|
-00000050  6c 54 62 58 83 33 53 ab  3c 1e dd ba 8f 3b ef f6  |lTbX.3S.<....;..|
-00000060  d3 f3 e4 6e 6c 5e ff 94  69 9a d3 be 69 26 db 40  |...nl^..i...i&.@|
-00000070  2e a2 79 c2 b3 71 bb 8c  e7 7c 15 5e 16 fe cf 4c  |..y..q...|.^...L|
-00000080  b1 25 df ac b1 42 86 0e  cb 14 03 00 00 01 01 16  |.%...B..........|
-00000090  03 00 00 3c 94 08 28 54  f4 2c d0 3b dd 1e 0f 7b  |...<..(T.,.;...{|
-000000a0  d7 cf 61 36 1b 50 e7 46  e3 5f cc cd 4d dc f6 7a  |..a6.P.F._..M..z|
-000000b0  37 15 20 62 af e2 38 c7  48 42 1b 3f 70 65 84 97  |7. b..8.HB.?pe..|
-000000c0  42 a5 52 e7 fe 33 c6 27  97 10 db 17 42 10 5b f1  |B.R..3.'....B.[.|
+00000000  16 03 00 00 84 10 00 00  80 a0 a5 4c 14 f2 56 43  |...........L..VC|
+00000010  59 5b c2 80 ef 64 48 99  ba 56 85 c1 63 70 a4 01  |Y[...dH..V..cp..|
+00000020  cc 23 b6 86 b6 1a 70 1d  1a 04 24 8b 7e 6c a9 23  |.#....p...$.~l.#|
+00000030  ac 9e f4 a7 ab 2e bc 25  0c f7 e0 98 c2 e9 d2 31  |.......%.......1|
+00000040  6a b0 cd bd c4 c7 da b3  7c b7 0f 8c d7 e6 08 b3  |j.......|.......|
+00000050  76 c9 cc 3b 19 dc 07 23  2c 2b 0d 2c bc 09 cc 3a  |v..;...#,+.,...:|
+00000060  c4 eb 12 55 69 fd b9 8f  de 5a f5 a1 4b bc 20 c5  |...Ui....Z..K. .|
+00000070  cc 42 93 e9 59 f3 9c a6  cd b4 20 78 3a f3 96 83  |.B..Y..... x:...|
+00000080  73 4a 55 38 0f d4 92 ae  a1 14 03 00 00 01 01 16  |sJU8............|
+00000090  03 00 00 3c 7a 24 99 d4  14 cd df c2 f3 ad 09 59  |...<z$.........Y|
+000000a0  79 bf d7 dd 2b 59 97 24  61 79 02 0f d9 21 65 1c  |y...+Y.$ay...!e.|
+000000b0  f0 b3 8c 24 ba 05 42 56  9b 54 45 5a a9 b4 d5 a4  |...$..BV.TEZ....|
+000000c0  ab 9e 69 73 90 ed 39 99  35 c5 97 20 5f 1d 29 82  |..is..9.5.. _.).|
 >>> Flow 4 (server to client)
-00000000  14 03 00 00 01 01 16 03  00 00 3c 62 42 ff 8f e7  |..........<bB...|
-00000010  72 88 7a f0 80 c1 8e 67  bf f1 0a 20 e4 89 ba f9  |r.z....g... ....|
-00000020  c5 79 1b 68 82 36 0f 88  64 1f e8 31 bf 8c 40 fd  |.y.h.6..d..1..@.|
-00000030  9f 77 1c 99 18 16 d0 ac  00 68 44 ee 5f d2 00 d2  |.w.......hD._...|
-00000040  5c e6 7e f3 03 88 52 17  03 00 00 21 2b d8 95 ab  |\.~...R....!+...|
-00000050  5f 0e 36 84 cb 0c 20 87  72 72 88 a8 95 62 84 81  |_.6... .rr...b..|
-00000060  0a 78 b9 b9 76 dd 52 89  b4 09 19 83 ee 15 03 00  |.x..v.R.........|
-00000070  00 16 de e9 58 8d d1 00  51 da 2b 9f 07 bd 05 db  |....X...Q.+.....|
-00000080  65 80 d0 11 6f 1c 56 b4                           |e...o.V.|
+00000000  14 03 00 00 01 01 16 03  00 00 3c 72 f5 ba 83 22  |..........<r..."|
+00000010  28 2a 24 93 43 ee 18 a5  8c 5f c6 a9 c0 01 2d 30  |(*$.C...._....-0|
+00000020  95 6f 37 5f 5d df 59 b1  da 6f 0f e0 d8 64 3b 65  |.o7_].Y..o...d;e|
+00000030  91 2e 08 06 1b de ff bc  b3 d5 d1 2c 6c 30 7c d4  |...........,l0|.|
+00000040  4b 4e e7 e5 d6 d8 43 17  03 00 00 21 ad 6d a8 a9  |KN....C....!.m..|
+00000050  4b b7 2e 7a 51 84 2d 07  b3 a5 de 5d 7f 7b ac 97  |K..zQ.-....].{..|
+00000060  81 8f 54 35 78 f8 09 fa  2e 90 fa b3 5f 15 03 00  |..T5x......._...|
+00000070  00 16 0c f0 98 1c c0 0b  84 86 74 e3 73 a0 7d 0e  |..........t.s.}.|
+00000080  6e 8a 36 b1 3b 31 12 34                           |n.6.;1.4|
diff --git a/src/crypto/tls/testdata/Server-TLSv10-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Server-TLSv10-ECDHE-ECDSA-AES
index 0973c0a52e..fc00682a6c 100644
--- a/src/crypto/tls/testdata/Server-TLSv10-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Server-TLSv10-ECDHE-ECDSA-AES
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 4f 01 00 00  4b 03 01 2b 50 d8 3b 1f  |....O...K..+P.;.|
-00000010  df 1c ad 85 72 c0 cc 9c  4b 34 83 2c e5 1f a8 da  |....r...K4.,....|
-00000020  f2 74 50 de b9 7f 76 03  6a 0e 99 00 00 04 c0 0a  |.tP...v.j.......|
+00000000  16 03 01 00 4f 01 00 00  4b 03 01 fe 61 b4 5d ae  |....O...K...a.].|
+00000010  19 2f b0 b6 45 79 41 a6  87 85 18 21 7f 67 91 4f  |./..EyA....!.g.O|
+00000020  1c 5a 8f 96 18 88 e6 15  63 8e 19 00 00 04 c0 0a  |.Z......c.......|
 00000030  00 ff 01 00 00 1e 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000040  00 0a 00 08 00 1d 00 17  00 19 00 18 00 16 00 00  |................|
 00000050  00 17 00 00                                       |....|
@@ -42,41 +42,37 @@
 00000210  0e bd 3f a3 8c 25 c1 33  13 83 0d 94 06 bb d4 37  |..?..%.3.......7|
 00000220  7a f6 ec 7a c9 86 2e dd  d7 11 69 7f 85 7c 56 de  |z..z......i..|V.|
 00000230  fb 31 78 2b e4 c7 78 0d  ae cb be 9e 4e 36 24 31  |.1x+..x.....N6$1|
-00000240  7b 6a 0f 39 95 12 07 8f  2a 16 03 01 00 d5 0c 00  |{j.9....*.......|
-00000250  00 d1 03 00 17 41 04 1e  18 37 ef 0d 19 51 88 35  |.....A...7...Q.5|
-00000260  75 71 b5 e5 54 5b 12 2e  8f 09 67 fd a7 24 20 3e  |uq..T[....g..$ >|
-00000270  b2 56 1c ce 97 28 5e f8  2b 2d 4f 9e f1 07 9f 6c  |.V...(^.+-O....l|
-00000280  4b 5b 83 56 e2 32 42 e9  58 b6 d7 49 a6 b5 68 1a  |K[.V.2B.X..I..h.|
-00000290  41 03 56 6b dc 5a 89 00  8a 30 81 87 02 42 01 87  |A.Vk.Z...0...B..|
-000002a0  16 fb 72 db d2 a4 23 7f  d9 7d 42 2c e5 f1 4c 7e  |..r...#..}B,..L~|
-000002b0  76 30 90 3b cb a3 60 43  8a 9b 22 b3 fe e2 97 a0  |v0.;..`C..".....|
-000002c0  6f 6e 74 cb c1 c9 f3 59  63 18 e3 cb 7a a6 82 86  |ont....Yc...z...|
-000002d0  f0 f8 40 e0 38 3c 6e 8d  aa 18 79 89 fc 5f 93 8d  |..@.8<n...y.._..|
-000002e0  02 41 6d 23 f9 c2 4c 6d  da a8 be 8a e9 b5 d5 cc  |.Am#..Lm........|
-000002f0  28 f0 48 0c 7d a8 80 60  02 9f fc f9 38 a1 e3 5b  |(.H.}..`....8..[|
-00000300  b5 f4 11 d5 f3 94 52 f2  c2 73 5f b7 05 2b 96 7c  |......R..s_..+.||
-00000310  27 4d 94 94 f2 00 0a 50  53 e6 72 1f 2d fb 91 1b  |'M.....PS.r.-...|
-00000320  d1 67 cf 16 03 01 00 04  0e 00 00 00              |.g..........|
+00000240  7b 6a 0f 39 95 12 07 8f  2a 16 03 01 00 b4 0c 00  |{j.9....*.......|
+00000250  00 b0 03 00 1d 20 2f e5  7d a3 47 cd 62 43 15 28  |..... /.}.G.bC.(|
+00000260  da ac 5f bb 29 07 30 ff  f6 84 af c4 cf c2 ed 90  |.._.).0.........|
+00000270  99 5f 58 cb 3b 74 00 8a  30 81 87 02 42 00 9b 23  |._X.;t..0...B..#|
+00000280  b7 7f 16 df 0f 3e c0 51  b0 97 7f 75 54 e7 3f a8  |.....>.Q...uT.?.|
+00000290  f6 c4 64 ca 69 ad 3b 56  7f 58 c2 94 b3 b2 5c ee  |..d.i.;V.X....\.|
+000002a0  66 ea f7 bc f6 0d 06 02  94 08 e0 d6 99 03 3c da  |f.............<.|
+000002b0  80 80 34 46 52 8b 9a c6  31 61 6f 4e a0 1c a6 02  |..4FR...1aoN....|
+000002c0  41 79 ba 2e d2 48 85 b5  bc b4 08 bd be 11 d8 62  |Ay...H.........b|
+000002d0  cd 06 22 f2 a6 49 e7 14  9b 79 56 c1 29 26 de 7e  |.."..I...yV.)&.~|
+000002e0  1f 41 a3 a3 1d 0f 67 90  0b da 20 dc e6 04 18 f2  |.A....g... .....|
+000002f0  fb f0 4f 30 ed e5 97 90  37 01 f4 8a 86 ed 5f 40  |..O0....7....._@|
+00000300  fe ba 16 03 01 00 04 0e  00 00 00                 |...........|
 >>> Flow 3 (client to server)
-00000000  16 03 01 00 46 10 00 00  42 41 04 cb cc 3f 30 f8  |....F...BA...?0.|
-00000010  bb c5 88 d5 12 fa 24 96  57 74 76 86 f2 2f e4 16  |......$.Wtv../..|
-00000020  dd 03 db 0a ca 22 53 85  97 cd d8 cc 30 a6 c9 29  |....."S.....0..)|
-00000030  2a 1b 22 cd d1 e8 30 43  c8 2f ca 1b 49 d0 4a 63  |*."...0C./..I.Jc|
-00000040  dd 28 68 42 64 c4 53 46  40 42 dd 14 03 01 00 01  |.(hBd.SF@B......|
-00000050  01 16 03 01 00 30 17 1c  8d fa fc 33 93 2d 7e 94  |.....0.....3.-~.|
-00000060  fc 97 65 5f 9d cf 37 f4  1a e6 80 28 e6 f7 f5 97  |..e_..7....(....|
-00000070  57 8e b2 0b 88 45 2f d6  2f e5 11 e5 45 85 06 a0  |W....E/./...E...|
-00000080  52 eb 5c cb 14 db                                 |R.\...|
+00000000  16 03 01 00 25 10 00 00  21 20 74 53 a0 24 31 0e  |....%...! tS.$1.|
+00000010  24 0f be da 29 8c 2c a2  50 c4 f1 bc 96 36 4c b2  |$...).,.P....6L.|
+00000020  be 4e f3 71 e2 9f 00 e5  d1 2d 14 03 01 00 01 01  |.N.q.....-......|
+00000030  16 03 01 00 30 cc 38 0f  1e 21 0e e7 19 f0 6f 45  |....0.8..!....oE|
+00000040  44 c3 d4 3c 18 16 c5 b3  0f 30 71 c2 92 db 0e 29  |D..<.....0q....)|
+00000050  e5 07 0c 59 7a c6 94 da  8d 83 47 5b af 57 7f 20  |...Yz.....G[.W. |
+00000060  bb 74 cc 67 03                                    |.t.g.|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 d8 bc 10 62 c8  |..........0...b.|
-00000010  73 d4 eb 2f c1 41 e8 e4  71 08 ea 60 f2 59 0f f9  |s../.A..q..`.Y..|
-00000020  51 fe f3 32 86 d7 bc 66  02 c1 0d 61 f2 7b 90 81  |Q..2...f...a.{..|
-00000030  49 5d 66 cc 8a 38 30 85  4c 98 1c 17 03 01 00 20  |I]f..80.L...... |
-00000040  88 37 8d 00 97 b0 a5 93  ff fb 47 9a db 4c ad 58  |.7........G..L.X|
-00000050  3d 49 d1 4e 3e 24 74 47  df 78 1a f2 c4 ef 3f 8c  |=I.N>$tG.x....?.|
-00000060  17 03 01 00 30 15 49 5a  f7 5c 09 76 69 b6 20 0d  |....0.IZ.\.vi. .|
-00000070  02 f9 c4 95 d4 08 fe c0  1d 49 0f 61 a7 ca 5e d5  |.........I.a..^.|
-00000080  93 c4 8f d1 4d 53 04 76  c7 90 a2 b6 ee d2 fe 13  |....MS.v........|
-00000090  bc bb b3 83 2b 15 03 01  00 20 e4 f3 84 e5 09 c8  |....+.... ......|
-000000a0  dc 40 26 7c 42 59 08 4d  8e 1a 70 41 03 9e a6 a2  |.@&|BY.M..pA....|
-000000b0  ac cd 62 1e b9 e2 fb c2  33 0a                    |..b.....3.|
+00000000  14 03 01 00 01 01 16 03  01 00 30 03 83 0b c1 bb  |..........0.....|
+00000010  69 43 63 46 48 8d 18 e2  d7 8d 0d 8b 69 d7 98 a8  |iCcFH.......i...|
+00000020  eb 11 94 5a 37 70 ef 4c  74 28 1d d0 9e 19 b7 4f  |...Z7p.Lt(.....O|
+00000030  2e 01 7d a4 e2 22 12 89  26 64 3a 17 03 01 00 20  |..}.."..&d:.... |
+00000040  d3 a1 47 e6 96 87 67 f0  44 a9 0b 6b 58 c8 00 6a  |..G...g.D..kX..j|
+00000050  74 76 58 82 3a 70 b9 37  b1 ce 6a 0a 19 8c 22 64  |tvX.:p.7..j..."d|
+00000060  17 03 01 00 30 c4 c9 e2  83 68 ac f3 a6 4e a4 38  |....0....h...N.8|
+00000070  bb 52 3f be a7 19 89 ea  73 36 79 04 f3 d2 e0 b4  |.R?.....s6y.....|
+00000080  a6 fb 9c d8 40 a4 5a af  17 c1 c9 61 af a8 90 e5  |....@.Z....a....|
+00000090  e0 06 c4 40 4f 15 03 01  00 20 e2 08 3c 9a e3 c5  |...@O.... ..<...|
+000000a0  44 ad 0e fc 07 4d 64 80  e2 9d 82 67 8a 62 10 34  |D....Md....g.b.4|
+000000b0  7a 68 6c 15 79 76 eb a0  5f 30                    |zhl.yv.._0|
diff --git a/src/crypto/tls/testdata/Server-TLSv10-RSA-3DES b/src/crypto/tls/testdata/Server-TLSv10-RSA-3DES
index 4f5bc6dc0b..6001c07536 100644
--- a/src/crypto/tls/testdata/Server-TLSv10-RSA-3DES
+++ b/src/crypto/tls/testdata/Server-TLSv10-RSA-3DES
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 39 01 00 00  35 03 01 63 6b 8e 7a ec  |....9...5..ck.z.|
-00000010  88 b1 0d 62 36 11 11 df  7f da 1f ff 51 fe 8c 4d  |...b6.......Q..M|
-00000020  2a c0 15 01 3e df d5 d8  db 0c 5e 00 00 04 00 0a  |*...>.....^.....|
+00000000  16 03 01 00 39 01 00 00  35 03 01 3e a7 9d c2 8e  |....9...5..>....|
+00000010  ec 45 f8 00 79 94 62 4e  3a 12 92 c1 78 c8 9e bc  |.E..y.bN:...x...|
+00000020  af a4 ff 81 1f 92 d7 74  a8 a2 34 00 00 04 00 0a  |.......t..4.....|
 00000030  00 ff 01 00 00 08 00 16  00 00 00 17 00 00        |..............|
 >>> Flow 2 (server to client)
 00000000  16 03 01 00 31 02 00 00  2d 03 01 00 00 00 00 00  |....1...-.......|
@@ -47,26 +47,26 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 01 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 01 00 86 10 00 00  82 00 80 6a e2 d7 29 60  |...........j..)`|
-00000010  85 e0 f0 41 59 05 d2 c4  ed c8 cb b2 66 ef 87 b5  |...AY.......f...|
-00000020  2d db 83 f0 b2 60 75 27  e4 ab c8 a0 26 fd bd ef  |-....`u'....&...|
-00000030  d0 54 4c 61 b2 56 0d fa  f5 12 4d 6f 75 2a 61 82  |.TLa.V....Mou*a.|
-00000040  fa 8f ed 70 77 d2 7f f3  70 38 a3 fa 0a eb 5a 32  |...pw...p8....Z2|
-00000050  f6 70 8b c5 ac 85 04 d2  fc fa cf 46 8e be 41 f0  |.p.........F..A.|
-00000060  3b 6a 0e 74 86 0b a3 2b  73 e7 b6 09 d4 6c 9c 4d  |;j.t...+s....l.M|
-00000070  5c 9a c3 b2 81 0b b2 36  21 15 98 18 61 8f 9b 83  |\......6!...a...|
-00000080  e7 3e b0 d1 5f 75 f1 69  41 7c fd 14 03 01 00 01  |.>.._u.iA|......|
-00000090  01 16 03 01 00 28 ef 8a  53 0e 3b 9c d4 2b 48 85  |.....(..S.;..+H.|
-000000a0  db ae 99 cf 74 06 b9 7d  44 69 99 d8 42 d7 c8 1f  |....t..}Di..B...|
-000000b0  b0 01 6b 8c 4b 02 7d 6b  2d 2e 39 8f fa a8        |..k.K.}k-.9...|
+00000000  16 03 01 00 86 10 00 00  82 00 80 d8 ed ab 33 83  |..............3.|
+00000010  d3 ee fe 42 f2 8d 87 18  06 cd b4 b0 d0 01 b7 7d  |...B...........}|
+00000020  77 c3 86 21 6a a4 25 f6  97 9a 66 61 4f ec 9e 88  |w..!j.%...faO...|
+00000030  f1 f5 c9 7b a7 23 29 72  9e 9d 51 0f 40 08 ad b6  |...{.#)r..Q.@...|
+00000040  43 80 3a 9a 6f 83 8b 40  df 8c 38 ff b4 9b 2a 32  |C.:.o..@..8...*2|
+00000050  f6 b7 01 20 2b 2e db ed  f2 37 15 50 e0 3d 1d 89  |... +....7.P.=..|
+00000060  b9 94 d9 a8 30 2d e4 95  e1 6d 1f e7 17 cd ee 03  |....0-...m......|
+00000070  54 bb 23 d0 ce 80 66 5b  0f 85 13 ac 9b 0a 34 76  |T.#...f[......4v|
+00000080  8f 1f a1 7f ba 09 56 42  cb 26 72 14 03 01 00 01  |......VB.&r.....|
+00000090  01 16 03 01 00 28 86 ac  2e 12 8f ee b9 c8 2a c7  |.....(........*.|
+000000a0  49 2f 2b c0 15 bf d8 81  87 82 bd 24 36 54 65 c8  |I/+........$6Te.|
+000000b0  52 e7 2d 9e 78 cb a0 ab  5c 53 f0 48 61 f4        |R.-.x...\S.Ha.|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 28 05 03 3e 8c b0  |..........(..>..|
-00000010  bf 14 c9 a3 38 2f ea 0c  e9 a0 bc 0b ef a5 04 21  |....8/.........!|
-00000020  60 d7 20 db d7 ef 61 45  b8 45 2b 51 cc c4 7f f8  |`. ...aE.E+Q....|
-00000030  e0 4c dd 17 03 01 00 18  f8 ac 9e c4 cd b7 4f c0  |.L............O.|
-00000040  eb 6d a8 ff a2 36 f5 4b  87 c5 d5 27 d9 79 c2 2b  |.m...6.K...'.y.+|
-00000050  17 03 01 00 28 50 e5 f9  5b 27 2c 10 10 d8 f6 1f  |....(P..[',.....|
-00000060  58 e9 80 76 cf f7 03 c4  45 f7 e8 27 f9 60 12 f0  |X..v....E..'.`..|
-00000070  b7 d0 c1 1c 34 31 f5 46  2c 2c 43 d4 b0 15 03 01  |....41.F,,C.....|
-00000080  00 18 71 16 fe 91 c1 3d  17 40 2c 34 a8 69 45 71  |..q....=.@,4.iEq|
-00000090  1d b9 83 99 7f 6e 86 08  12 0e                    |.....n....|
+00000000  14 03 01 00 01 01 16 03  01 00 28 56 86 55 d2 a0  |..........(V.U..|
+00000010  a9 8f 3f ad ca 38 48 66  86 86 05 64 66 17 fd 0c  |..?..8Hf...df...|
+00000020  07 99 c9 58 da 05 88 84  71 f3 c0 3d 6a 46 fb 79  |...X....q..=jF.y|
+00000030  15 7e b4 17 03 01 00 18  96 47 ec e1 0f 85 c8 5d  |.~.......G.....]|
+00000040  b2 9e cf 8a 78 41 e2 bd  95 c8 e3 eb 83 9c 10 05  |....xA..........|
+00000050  17 03 01 00 28 ee ca 01  96 ee ed 75 39 39 82 7a  |....(......u99.z|
+00000060  8d 2f 2a c4 ef a7 d7 2f  ac 03 65 e7 c8 6e 66 b2  |./*..../..e..nf.|
+00000070  13 8c a8 08 e5 f8 59 8b  54 01 96 7b 17 15 03 01  |......Y.T..{....|
+00000080  00 18 d3 37 d1 a8 e3 0d  6b fa b6 bb a5 ef fe 5e  |...7....k......^|
+00000090  3a 44 2e af 4f 02 59 49  10 97                    |:D..O.YI..|
diff --git a/src/crypto/tls/testdata/Server-TLSv10-RSA-AES b/src/crypto/tls/testdata/Server-TLSv10-RSA-AES
index c988215a89..3fef9e7b1b 100644
--- a/src/crypto/tls/testdata/Server-TLSv10-RSA-AES
+++ b/src/crypto/tls/testdata/Server-TLSv10-RSA-AES
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 39 01 00 00  35 03 01 aa c3 56 39 53  |....9...5....V9S|
-00000010  94 16 6b 51 7f e2 eb a8  7c 25 59 55 9b 28 38 b1  |..kQ....|%YU.(8.|
-00000020  c0 94 af 2e f5 94 ba 0e  f0 a1 b1 00 00 04 00 2f  |.............../|
+00000000  16 03 01 00 39 01 00 00  35 03 01 f1 24 4a eb 06  |....9...5...$J..|
+00000010  63 7d f7 29 75 f6 eb c7  4c 75 95 9e 7f b7 48 1a  |c}.)u...Lu....H.|
+00000020  2e 15 dd 5b 0d 5a a8 10  bd 79 21 00 00 04 00 2f  |...[.Z...y!..../|
 00000030  00 ff 01 00 00 08 00 16  00 00 00 17 00 00        |..............|
 >>> Flow 2 (server to client)
 00000000  16 03 01 00 31 02 00 00  2d 03 01 00 00 00 00 00  |....1...-.......|
@@ -47,29 +47,29 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 01 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 01 00 86 10 00 00  82 00 80 73 3f 17 54 6f  |...........s?.To|
-00000010  c6 c8 08 e2 d5 e6 49 cc  51 89 d1 c8 dc cd 4f ec  |......I.Q.....O.|
-00000020  0b b4 71 0b d5 44 b4 fa  9e 97 a4 52 69 0a c8 f7  |..q..D.....Ri...|
-00000030  79 cb 79 52 46 94 95 32  a1 d1 17 c0 ba fd 65 9b  |y.yRF..2......e.|
-00000040  52 c3 99 dc 06 07 54 0d  90 8e 4d ff 31 72 8c 80  |R.....T...M.1r..|
-00000050  86 cf 3b be 09 f4 df dc  93 40 c4 7d 88 55 72 e8  |..;......@.}.Ur.|
-00000060  f4 26 f3 8b 0d 3c 8d 07  97 90 87 a6 91 96 60 0e  |.&...<........`.|
-00000070  4c ec ac a4 be 36 36 32  81 8b 7e 5f 6a 7e 0d d5  |L....662..~_j~..|
-00000080  9c 2b 1e 3f e2 14 fa 22  d2 8d 34 14 03 01 00 01  |.+.?..."..4.....|
-00000090  01 16 03 01 00 30 43 50  a9 47 03 3b 38 0a 62 cf  |.....0CP.G.;8.b.|
-000000a0  74 56 a7 9c 56 a3 a2 05  dc d5 60 7a 4f 10 37 c6  |tV..V.....`zO.7.|
-000000b0  13 d5 5b c8 cc b7 96 22  e4 58 a4 8a 2a 9d 48 14  |..[....".X..*.H.|
-000000c0  97 03 2f 6d a0 35                                 |../m.5|
+00000000  16 03 01 00 86 10 00 00  82 00 80 32 35 8d 1a 4c  |...........25..L|
+00000010  5e 87 88 94 63 a4 5d 44  12 b2 22 0e f0 d0 ac 99  |^...c.]D..".....|
+00000020  cb 3b 83 62 29 50 9c 4a  22 2a 14 10 d4 36 25 8c  |.;.b)P.J"*...6%.|
+00000030  ca ba ec dc c1 73 6b a0  ae c4 eb 21 42 ab 4a ee  |.....sk....!B.J.|
+00000040  6e 6d 06 32 d1 ed 97 a4  ef 8d a5 d9 10 e6 fe d0  |nm.2............|
+00000050  ed 6c b1 a4 b3 c1 26 f5  be 91 e9 97 13 46 a2 c9  |.l....&......F..|
+00000060  d0 da d7 1c f0 d3 68 d7  45 85 9f 64 ed d5 d2 71  |......h.E..d...q|
+00000070  d6 42 8a 40 db da 7b 2b  82 c5 7b 9c 26 53 fe e0  |.B.@..{+..{.&S..|
+00000080  20 6e 0c 0d d1 3c cb 28  56 6f c0 14 03 01 00 01  | n...<.(Vo......|
+00000090  01 16 03 01 00 30 44 4f  5c d8 1d ec c2 05 cd 60  |.....0DO\......`|
+000000a0  88 d6 c5 4a 67 ef 84 40  06 cc b7 42 68 73 6b 46  |...Jg..@...BhskF|
+000000b0  f9 55 29 30 b9 95 d0 cf  43 40 8f 6d ca e5 f9 6e  |.U)0....C@.m...n|
+000000c0  9b 44 44 70 dd 18                                 |.DDp..|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 e1 7c 3f cc a9  |..........0.|?..|
-00000010  00 c1 05 00 95 e4 39 b8  82 92 14 83 c3 a4 d2 d9  |......9.........|
-00000020  8a 47 c6 b5 e8 70 ff 9d  6b 90 d1 13 e5 6b ff 77  |.G...p..k....k.w|
-00000030  55 eb 76 37 e3 df fa 9b  82 5a c3 17 03 01 00 20  |U.v7.....Z..... |
-00000040  f3 81 d3 e6 ac fb f9 49  06 8c 27 aa f4 ad 76 6f  |.......I..'...vo|
-00000050  45 4e 7b 27 c0 bb db fe  d9 da 7c 19 cc 7d 40 0e  |EN{'......|..}@.|
-00000060  17 03 01 00 30 c2 33 a6  cb 1f 5f 2e 30 94 54 1c  |....0.3..._.0.T.|
-00000070  02 3b 1f 9c f4 5c 41 2a  67 9d b8 af 6b 48 cc 25  |.;...\A*g...kH.%|
-00000080  8c a5 1e be 88 91 20 06  dd 75 d5 68 15 ae be b1  |...... ..u.h....|
-00000090  e3 7a 5b 73 9b 15 03 01  00 20 3a ab ff b4 54 57  |.z[s..... :...TW|
-000000a0  68 e1 d7 0e 20 fc 9d 8f  20 f5 1e 8d f8 40 bb 55  |h... ... ....@.U|
-000000b0  1f 81 76 d9 e5 ef f8 00  05 91                    |..v.......|
+00000000  14 03 01 00 01 01 16 03  01 00 30 ec 7f ed 3c 99  |..........0...<.|
+00000010  48 25 e1 0f 53 7b ef ee  41 14 7b 77 e5 c7 e9 2f  |H%..S{..A.{w.../|
+00000020  1f 2e 60 ef 30 4e 07 05  37 bb 2d 4d 46 d0 8a ed  |..`.0N..7.-MF...|
+00000030  78 1e 6e 2d ca 2e 1d 9a  50 e7 18 17 03 01 00 20  |x.n-....P...... |
+00000040  06 fd b0 35 0a a9 af be  11 92 de aa 90 64 45 fc  |...5.........dE.|
+00000050  29 ff 28 8c 4c 05 33 83  c8 0c f0 dc 6e e0 85 b3  |).(.L.3.....n...|
+00000060  17 03 01 00 30 c8 08 87  81 5c ec 60 b9 05 ca b2  |....0....\.`....|
+00000070  66 02 43 d3 f0 64 8d 07  bf 66 ac 53 ed b8 10 08  |f.C..d...f.S....|
+00000080  8a 11 92 c8 51 ab 59 e3  c4 51 ed b8 76 b5 b0 68  |....Q.Y..Q..v..h|
+00000090  e0 24 1f 3f 8a 15 03 01  00 20 6a 30 6a c0 bc 1a  |.$.?..... j0j...|
+000000a0  1a ff ef fe 40 b6 53 a4  ab b4 76 c1 c0 2b de 35  |....@.S...v..+.5|
+000000b0  04 e7 fa 8d 47 23 0c b1  d1 f4                    |....G#....|
diff --git a/src/crypto/tls/testdata/Server-TLSv10-RSA-RC4 b/src/crypto/tls/testdata/Server-TLSv10-RSA-RC4
index af18e99bec..e381d57615 100644
--- a/src/crypto/tls/testdata/Server-TLSv10-RSA-RC4
+++ b/src/crypto/tls/testdata/Server-TLSv10-RSA-RC4
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 39 01 00 00  35 03 01 9e 6c 99 0f 16  |....9...5...l...|
-00000010  2d d6 48 26 4e 2a d1 e4  80 53 0e 74 ee 6d bc 7c  |-.H&N*...S.t.m.||
-00000020  9b 65 9b 33 8d 6b 15 61  f6 53 b5 00 00 04 00 05  |.e.3.k.a.S......|
+00000000  16 03 01 00 39 01 00 00  35 03 01 76 2e dd 69 ea  |....9...5..v..i.|
+00000010  11 7e 3f 79 af ee 09 52  ba 1e ee e4 13 bb 18 1c  |.~?y...R........|
+00000020  8e cf ae 7e c3 bf d2 c4  29 3e a4 00 00 04 00 05  |...~....)>......|
 00000030  00 ff 01 00 00 08 00 16  00 00 00 17 00 00        |..............|
 >>> Flow 2 (server to client)
 00000000  16 03 01 00 31 02 00 00  2d 03 01 00 00 00 00 00  |....1...-.......|
@@ -47,23 +47,23 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 01 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 01 00 86 10 00 00  82 00 80 d8 7a 11 ec dd  |............z...|
-00000010  8c 50 97 3a 9b 21 28 7d  52 8c fc a0 62 17 e8 3a  |.P.:.!(}R...b..:|
-00000020  0f 97 42 44 cd 9c ec d3  74 c3 2c 70 33 37 0f 57  |..BD....t.,p37.W|
-00000030  9b a9 b9 24 2a be 87 8f  ec ca 3f 40 da 1b 06 82  |...$*.....?@....|
-00000040  4e e8 8a 3e 45 30 97 b5  b5 f1 e6 42 4e 7e 2e 0d  |N..>E0.....BN~..|
-00000050  aa b2 fc 21 8f fb 0f dd  ca 7c 2b d2 c6 cb f8 60  |...!.....|+....`|
-00000060  0b 18 68 8e 51 54 dd 1f  4c ba 8e db e5 31 52 ed  |..h.QT..L....1R.|
-00000070  d5 a6 fe 13 f3 9b d1 47  42 b0 33 6b f3 c1 d9 c4  |.......GB.3k....|
-00000080  5b 16 54 6d 58 1c ea c8  a6 b2 ba 14 03 01 00 01  |[.TmX...........|
-00000090  01 16 03 01 00 24 c0 bc  e5 37 fe 6e 63 a9 ca ca  |.....$...7.nc...|
-000000a0  f3 2a ff 07 5c e7 79 7b  e9 3f cc f5 13 dd dd 76  |.*..\.y{.?.....v|
-000000b0  ae 9e 91 fe e6 b7 6a d8  85 b1                    |......j...|
+00000000  16 03 01 00 86 10 00 00  82 00 80 64 0b 64 c6 55  |...........d.d.U|
+00000010  d3 ca 6e 45 18 52 e7 cf  60 ab b2 9f b4 3c dd 1b  |..nE.R..`....<..|
+00000020  dd 59 3d 7a 59 03 b2 7c  d5 91 a7 18 83 97 ec d9  |.Y=zY..|........|
+00000030  4e 3c db 39 f1 5d 55 ea  13 aa cb 36 5d 47 0c b7  |N<.9.]U....6]G..|
+00000040  e3 1f b7 cd ef db 51 ba  2e cb 54 47 69 f0 11 29  |......Q...TGi..)|
+00000050  90 1d d2 84 39 f7 54 62  53 1d 6b 53 43 74 62 cc  |....9.TbS.kSCtb.|
+00000060  6c 6c 4a a0 e8 da 62 9f  c3 83 fc db 6e 42 b3 cd  |llJ...b.....nB..|
+00000070  d7 0b 93 76 22 a3 ba 80  43 b4 41 ed cf 15 27 39  |...v"...C.A...'9|
+00000080  be 80 0a 6e b6 32 d8 c3  a5 a6 8c 14 03 01 00 01  |...n.2..........|
+00000090  01 16 03 01 00 24 b4 91  95 93 9c c7 dd 7b 4a 84  |.....$.......{J.|
+000000a0  9e ad aa 40 c0 c6 49 8d  0f e8 9b 44 40 4f 89 1f  |...@..I....D@O..|
+000000b0  47 bd e1 60 1a f4 83 51  1f 62                    |G..`...Q.b|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 24 de 85 1d 5d 44  |..........$...]D|
-00000010  17 e3 fc 09 0d 25 bf 8c  0c 23 c8 42 89 b8 4c 08  |.....%...#.B..L.|
-00000020  bc 4d cf ad df 6f 32 94  99 0e a9 dd 8b 9e 06 17  |.M...o2.........|
-00000030  03 01 00 21 8a 73 0e 9b  2e 61 3a 84 57 05 c1 fd  |...!.s...a:.W...|
-00000040  f8 34 27 c5 71 73 58 3c  21 ba d5 d3 a0 26 1a 78  |.4'.qsX<!....&.x|
-00000050  28 3c 7e ec 0c 15 03 01  00 16 c3 d1 38 8f fa 36  |(<~.........8..6|
-00000060  76 fe cd 42 bd ac af 69  16 e5 61 6f 68 da 88 99  |v..B...i..aoh...|
+00000000  14 03 01 00 01 01 16 03  01 00 24 e0 00 f9 63 16  |..........$...c.|
+00000010  a2 85 2e c9 6b 98 8b 84  39 42 68 1a 80 f8 ea 6f  |....k...9Bh....o|
+00000020  40 c0 bf 02 81 4a 50 cd  8f af 4a a6 6d d2 56 17  |@....JP...J.m.V.|
+00000030  03 01 00 21 61 35 98 a6  e9 61 70 2c 0f a6 61 71  |...!a5...ap,..aq|
+00000040  1c b4 29 87 e0 ee c8 26  38 b9 7b 5b 6a b2 e9 e4  |..)....&8.{[j...|
+00000050  db 77 2d 64 c8 15 03 01  00 16 59 41 cf 6f a9 0c  |.w-d......YA.o..|
+00000060  17 9d f0 d8 a5 1d 60 90  74 3e e2 c6 f7 ff fc dc  |......`.t>......|
diff --git a/src/crypto/tls/testdata/Server-TLSv11-FallbackSCSV b/src/crypto/tls/testdata/Server-TLSv11-FallbackSCSV
index 27f7d18813..9130ec4cfb 100644
--- a/src/crypto/tls/testdata/Server-TLSv11-FallbackSCSV
+++ b/src/crypto/tls/testdata/Server-TLSv11-FallbackSCSV
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 63 01 00 00  5f 03 02 b0 a9 a8 af 69  |....c..._......i|
-00000010  fe b4 56 38 e7 7f 2f 55  2e 08 ef 69 e0 83 76 62  |..V8../U...i..vb|
-00000020  82 a6 37 7d 49 b4 61 a9  c7 09 14 00 00 14 c0 0a  |..7}I.a.........|
+00000000  16 03 01 00 63 01 00 00  5f 03 02 ad a6 80 eb e2  |....c..._.......|
+00000010  84 2f 8d e0 c8 02 51 53  4a c7 3f 37 91 32 52 5e  |./....QSJ.?7.2R^|
+00000020  0d dc 13 21 6f 97 70 cb  a2 a4 4c 00 00 14 c0 0a  |...!o.p...L.....|
 00000030  c0 14 00 39 c0 09 c0 13  00 33 00 35 00 2f 00 ff  |...9.....3.5./..|
 00000040  56 00 01 00 00 22 00 0b  00 04 03 00 01 02 00 0a  |V...."..........|
 00000050  00 0a 00 08 00 1d 00 17  00 19 00 18 00 23 00 00  |.............#..|
diff --git a/src/crypto/tls/testdata/Server-TLSv11-RSA-RC4 b/src/crypto/tls/testdata/Server-TLSv11-RSA-RC4
index e40d082d7d..03551924d4 100644
--- a/src/crypto/tls/testdata/Server-TLSv11-RSA-RC4
+++ b/src/crypto/tls/testdata/Server-TLSv11-RSA-RC4
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 39 01 00 00  35 03 02 63 e6 95 c1 f3  |....9...5..c....|
-00000010  75 c2 d4 68 74 5c d6 7d  00 60 8b 8e 72 ff f4 3d  |u..ht\.}.`..r..=|
-00000020  15 24 8b 15 8e 15 6e 1e  bf 47 ae 00 00 04 00 05  |.$....n..G......|
+00000000  16 03 01 00 39 01 00 00  35 03 02 b3 b4 1f 1a fe  |....9...5.......|
+00000010  f1 01 25 aa 2c 22 0d 6f  be 5d 46 a1 81 21 46 ad  |..%.,".o.]F..!F.|
+00000020  20 59 17 b9 81 f8 f6 1d  51 a5 86 00 00 04 00 05  | Y......Q.......|
 00000030  00 ff 01 00 00 08 00 16  00 00 00 17 00 00        |..............|
 >>> Flow 2 (server to client)
 00000000  16 03 02 00 31 02 00 00  2d 03 02 00 00 00 00 00  |....1...-.......|
@@ -47,23 +47,23 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 02 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 02 00 86 10 00 00  82 00 80 d7 54 f9 63 0f  |............T.c.|
-00000010  8e 38 e7 f7 2c 35 69 18  ae b0 54 ac 55 a9 8e c1  |.8..,5i...T.U...|
-00000020  e1 f7 09 b8 6d aa 2d 3e  f5 be 2d 2e 1c f2 e4 95  |....m.->..-.....|
-00000030  3e c3 6a 15 af 49 e8 38  3b e2 90 3f df ab 89 44  |>.j..I.8;..?...D|
-00000040  34 63 f9 c5 47 a5 30 3c  45 5d 16 23 0d d6 d5 e6  |4c..G.0<E].#....|
-00000050  9d e7 90 ee 9a b8 bc c9  49 7d 85 00 da 53 5b cb  |........I}...S[.|
-00000060  2f 19 56 31 64 4f 9a ce  15 02 4d ee 67 7c be 9a  |/.V1dO....M.g|..|
-00000070  c5 5f 21 c7 a7 1f 29 56  ee ab ce 07 ff a2 6e 94  |._!...)V......n.|
-00000080  57 da 74 9d d7 63 82 43  b0 e6 48 14 03 02 00 01  |W.t..c.C..H.....|
-00000090  01 16 03 02 00 24 88 75  fb e9 20 0b 3b c7 fb 4a  |.....$.u.. .;..J|
-000000a0  2f 1c 54 76 3d 8c 14 6e  c0 1e 56 6e ce ce 4f a9  |/.Tv=..n..Vn..O.|
-000000b0  f5 bd f9 9b 25 18 bd de  18 86                    |....%.....|
+00000000  16 03 02 00 86 10 00 00  82 00 80 bc 7a 1c d7 e5  |............z...|
+00000010  b1 c8 4d 94 b6 92 d5 e4  4a 46 f5 ae 54 a8 c5 09  |..M.....JF..T...|
+00000020  bb 4b aa 27 73 31 fe c7  ee 98 69 ec 34 8c 29 1e  |.K.'s1....i.4.).|
+00000030  41 97 af db 17 c1 27 df  6f 1f 96 31 d0 f1 92 94  |A.....'.o..1....|
+00000040  32 b4 ce 79 79 55 1c 07  99 21 60 af dd 66 31 03  |2..yyU...!`..f1.|
+00000050  2b ac b6 83 09 77 7b 44  50 21 9c d3 c6 f7 9f 47  |+....w{DP!.....G|
+00000060  f0 88 91 16 6e 75 a9 f9  67 9a f3 a1 82 64 eb 61  |....nu..g....d.a|
+00000070  1a 01 03 e5 f8 18 12 ef  ac 51 e1 5f 2c 6d 39 dd  |.........Q._,m9.|
+00000080  97 a5 c5 0d a9 65 b3 9d  47 98 84 14 03 02 00 01  |.....e..G.......|
+00000090  01 16 03 02 00 24 eb b8  87 0c 82 ab 86 d3 83 5c  |.....$.........\|
+000000a0  e0 b6 c2 f8 44 10 2f 31  30 b3 0a b2 a7 5a c3 dd  |....D./10....Z..|
+000000b0  1d c9 92 3a cf 62 5f af  fd cb                    |...:.b_...|
 >>> Flow 4 (server to client)
-00000000  14 03 02 00 01 01 16 03  02 00 24 9b 7a 77 60 f7  |..........$.zw`.|
-00000010  d3 a2 6f 51 c8 52 41 57  30 88 e0 5e e8 ec dd 36  |..oQ.RAW0..^...6|
-00000020  61 cd 78 bf 03 e5 1d 95  09 75 0e b8 30 9d 5d 17  |a.x......u..0.].|
-00000030  03 02 00 21 9e 7b fe b8  35 4e 86 6f c9 bd 92 4b  |...!.{..5N.o...K|
-00000040  28 59 a4 54 d9 ab 70 fe  95 1e 81 b2 ab 08 27 e6  |(Y.T..p.......'.|
-00000050  c3 b2 c0 b9 8c 15 03 02  00 16 54 95 b1 e5 6e 0c  |..........T...n.|
-00000060  ff 80 15 30 b5 a7 5f ea  8e ab 49 d8 20 4a 80 f0  |...0.._...I. J..|
+00000000  14 03 02 00 01 01 16 03  02 00 24 e3 de 71 0b 6a  |..........$..q.j|
+00000010  77 28 4a 44 6e da 3e 94  94 e8 f3 30 a0 2d a5 16  |w(JDn.>....0.-..|
+00000020  84 02 2c 8e 8b 4f 3c 44  5d ec f0 fd de 5c b8 17  |..,..O<D]....\..|
+00000030  03 02 00 21 94 f2 b2 63  cb 04 cd 70 96 ba b9 cd  |...!...c...p....|
+00000040  84 f2 d7 48 0e a1 bf df  fc ab b1 20 f7 fb 78 a7  |...H....... ..x.|
+00000050  16 59 b1 27 8c 15 03 02  00 16 4f 4c 97 9d 52 05  |.Y.'......OL..R.|
+00000060  b8 cf 90 8a 32 ba 47 96  f6 3a 01 54 ac e6 1c 14  |....2.G..:.T....|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ALPN b/src/crypto/tls/testdata/Server-TLSv12-ALPN
index 9e397185b3..0c5ebc8105 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ALPN
+++ b/src/crypto/tls/testdata/Server-TLSv12-ALPN
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 bf 01 00 00  bb 03 03 88 3e 03 e9 31  |............>..1|
-00000010  b2 d6 0d 3f f0 26 65 6f  db 03 86 f1 47 d0 0c b3  |...?.&eo....G...|
-00000020  54 92 56 0d 24 e8 01 11  ce 83 44 00 00 38 c0 2c  |T.V.$.....D..8.,|
+00000000  16 03 01 00 bf 01 00 00  bb 03 03 fb b9 9e 20 13  |.............. .|
+00000010  7f 9d 92 9e 7b 42 b7 ab  c6 70 c6 3b 44 00 00 e9  |....{B...p.;D...|
+00000020  32 98 5a c3 e2 be c2 a5  af 4d 96 00 00 38 c0 2c  |2.Z......M...8.,|
 00000030  c0 30 00 9f cc a9 cc a8  cc aa c0 2b c0 2f 00 9e  |.0.........+./..|
 00000040  c0 24 c0 28 00 6b c0 23  c0 27 00 67 c0 0a c0 14  |.$.(.k.#.'.g....|
 00000050  00 39 c0 09 c0 13 00 33  00 9d 00 9c 00 3d 00 3c  |.9.....3.....=.<|
@@ -55,44 +55,40 @@
 00000270  82 f1 6c 04 ed 73 bb b3  43 77 8d 0c 1c f1 0f a1  |..l..s..Cw......|
 00000280  d8 40 83 61 c9 4c 72 2b  9d ae db 46 06 06 4d f4  |.@.a.Lr+...F..M.|
 00000290  c1 b3 3e c0 d1 bd 42 d4  db fe 3d 13 60 84 5c 21  |..>...B...=.`.\!|
-000002a0  d3 3b e9 fa e7 16 03 03  00 cd 0c 00 00 c9 03 00  |.;..............|
-000002b0  17 41 04 1e 18 37 ef 0d  19 51 88 35 75 71 b5 e5  |.A...7...Q.5uq..|
-000002c0  54 5b 12 2e 8f 09 67 fd  a7 24 20 3e b2 56 1c ce  |T[....g..$ >.V..|
-000002d0  97 28 5e f8 2b 2d 4f 9e  f1 07 9f 6c 4b 5b 83 56  |.(^.+-O....lK[.V|
-000002e0  e2 32 42 e9 58 b6 d7 49  a6 b5 68 1a 41 03 56 6b  |.2B.X..I..h.A.Vk|
-000002f0  dc 5a 89 05 01 00 80 5b  dc 03 ef f0 ad 7c 4d 90  |.Z.....[.....|M.|
-00000300  5c 90 1d 46 65 cd 9a 96  21 a7 9f 91 ae 71 45 72  |\..Fe...!....qEr|
-00000310  38 8d c7 79 5d 29 90 47  50 e5 4c 7c 40 e5 1b 64  |8..y]).GP.L|@..d|
-00000320  da b1 b6 7b f1 d5 59 12  2d 5f f2 17 86 8d 25 cd  |...{..Y.-_....%.|
-00000330  85 37 07 32 e5 5e 19 a8  81 0c c7 02 1c 33 93 72  |.7.2.^.......3.r|
-00000340  dc 9b b1 60 85 12 4c 6c  aa 6a 43 66 08 23 d1 35  |...`..Ll.jCf.#.5|
-00000350  f1 5d a4 db fa 5d f4 dd  23 c8 c8 43 76 48 47 aa  |.]...]..#..CvHG.|
-00000360  e1 19 f6 f1 28 86 5d 6b  f4 06 9f 1b 09 6d 00 8f  |....(.]k.....m..|
-00000370  61 c7 85 d9 06 8c a1 16  03 03 00 04 0e 00 00 00  |a...............|
+000002a0  d3 3b e9 fa e7 16 03 03  00 ac 0c 00 00 a8 03 00  |.;..............|
+000002b0  1d 20 2f e5 7d a3 47 cd  62 43 15 28 da ac 5f bb  |. /.}.G.bC.(.._.|
+000002c0  29 07 30 ff f6 84 af c4  cf c2 ed 90 99 5f 58 cb  |).0.........._X.|
+000002d0  3b 74 05 01 00 80 ac 76  dc d2 23 3e 4b 9c b7 8e  |;t.....v..#>K...|
+000002e0  a8 07 ea 92 f2 99 11 f9  c9 2b fb 52 e3 f7 d4 56  |.........+.R...V|
+000002f0  c1 30 8d 04 16 d5 ee a2  81 48 21 53 51 03 19 bf  |.0.......H!SQ...|
+00000300  4d 68 7e 28 40 7c 71 cf  5e 36 3d 2d 14 3e 38 26  |Mh~(@|q.^6=-.>8&|
+00000310  db ca db 07 5d 6a 42 bb  5c e2 f1 dc fb c8 46 07  |....]jB.\.....F.|
+00000320  5a b6 5f c5 32 ea 7e ca  85 08 97 97 44 cb 05 3e  |Z._.2.~.....D..>|
+00000330  61 ca 7d f0 96 6e f8 59  14 e4 42 50 52 a2 a1 10  |a.}..n.Y..BPR...|
+00000340  62 3f 56 15 f6 4e 11 c7  c9 ad 42 4e 76 37 14 d7  |b?V..N....BNv7..|
+00000350  5f fc 29 6e c4 bf 16 03  03 00 04 0e 00 00 00     |_.)n...........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 f3 2d 56 31 b2  |....F...BA..-V1.|
-00000010  42 82 38 35 3b f0 53 2b  12 4b bb 08 88 32 36 8f  |B.85;.S+.K...26.|
-00000020  2f 94 a0 72 5e 0b b8 0d  95 49 b2 e7 38 89 bb b4  |/..r^....I..8...|
-00000030  04 2b a0 0d 1f eb 7d eb  90 04 fd 1e c0 8b 70 18  |.+....}.......p.|
-00000040  be c9 a0 82 08 6b 81 04  39 b4 1b 14 03 03 00 01  |.....k..9.......|
-00000050  01 16 03 03 00 28 3d 97  3c d5 1c b8 3f 63 3e ac  |.....(=.<...?c>.|
-00000060  74 08 ce ce b5 0d 68 a6  45 73 c8 0d 84 c5 76 35  |t.....h.Es....v5|
-00000070  c6 f0 47 24 3d c5 2a c7  e8 85 26 6f 5f 14        |..G$=.*...&o_.|
+00000000  16 03 03 00 25 10 00 00  21 20 5a 6f 39 fe 8e 70  |....%...! Zo9..p|
+00000010  43 68 a5 08 af ec 37 0e  5c 6f aa 63 c5 9c 3f 63  |Ch....7.\o.c..?c|
+00000020  61 f0 c5 fa 61 7f 81 1c  94 25 14 03 03 00 01 01  |a...a....%......|
+00000030  16 03 03 00 28 a5 f4 4c  fe ba ca 6b 9d 47 ba 7f  |....(..L...k.G..|
+00000040  b3 6d e1 24 25 a3 35 cb  58 7d fa 70 6e 04 07 a4  |.m.$%.5.X}.pn...|
+00000050  e4 0b 8c 98 fe e4 43 4a  f7 aa 1a 47 71           |......CJ...Gq|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 82 04 00 00  7e 00 00 00 00 00 78 50  |........~.....xP|
 00000010  46 ad c1 db a8 38 86 7b  2b bb fd d0 c3 42 3e 00  |F....8.{+....B>.|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000030  6f ec 80 83 61 74 ca b7  d0 0f 86 1e bd d2 13 2a  |o...at.........*|
-00000040  fb 4c c8 c3 ba 1d ee ca  47 89 1e 20 22 60 bf 71  |.L......G.. "`.q|
-00000050  e2 65 0f f1 05 3d 96 8f  29 51 bd b4 d0 d8 d4 50  |.e...=..)Q.....P|
-00000060  42 3b c1 dd 60 33 94 7c  a7 da 69 63 58 0e 76 ee  |B;..`3.|..icX.v.|
-00000070  a8 0d 04 39 05 d2 ab f7  64 f1 51 29 47 2b a0 fb  |...9....d.Q)G+..|
-00000080  ca e7 8b 4a 2b ae ee 14  03 03 00 01 01 16 03 03  |...J+...........|
-00000090  00 28 00 00 00 00 00 00  00 00 d9 44 b3 c5 8c 0d  |.(.........D....|
-000000a0  04 4b 07 ea e7 f6 5a 1d  43 cf 24 91 6e 49 36 f8  |.K....Z.C.$.nI6.|
-000000b0  f1 8b c2 40 85 46 2d e2  ab 64 17 03 03 00 25 00  |...@.F-..d....%.|
-000000c0  00 00 00 00 00 00 01 56  17 f0 39 6a 82 00 08 f2  |.......V..9j....|
-000000d0  d7 16 3a 24 04 63 59 c0  4e 5c 81 31 2a d4 c5 06  |..:$.cY.N\.1*...|
-000000e0  c9 0a 7f 68 15 03 03 00  1a 00 00 00 00 00 00 00  |...h............|
-000000f0  02 b6 1b ca a1 7d 0e b8  1a 7e e8 6d a2 f1 9a 2e  |.....}...~.m....|
-00000100  de f4 df                                          |...|
+00000030  6f ec 80 83 61 fd 51 ae  21 14 ec 44 ae 68 36 16  |o...a.Q.!..D.h6.|
+00000040  83 86 87 5a f7 2c f9 52  9e bd 28 87 e8 55 1c ec  |...Z.,.R..(..U..|
+00000050  f5 36 2b c2 96 88 ce 94  ae fc 5a 10 bc 3c 77 66  |.6+.......Z..<wf|
+00000060  f6 f8 d3 e9 40 33 94 30  73 2a c4 31 91 7d fe eb  |....@3.0s*.1.}..|
+00000070  7a ae 50 f1 e1 af 08 78  d5 3c fb 05 85 66 74 aa  |z.P....x.<...ft.|
+00000080  7a 35 29 07 be 08 b6 14  03 03 00 01 01 16 03 03  |z5).............|
+00000090  00 28 00 00 00 00 00 00  00 00 a1 d3 10 34 ec 89  |.(...........4..|
+000000a0  67 57 f1 f4 28 e5 9b b8  6b e1 3f 45 88 45 ca 32  |gW..(...k.?E.E.2|
+000000b0  da 79 76 48 73 c9 08 e3  2d 1e 17 03 03 00 25 00  |.yvHs...-.....%.|
+000000c0  00 00 00 00 00 00 01 1a  35 76 f5 78 3a c4 53 26  |........5v.x:.S&|
+000000d0  fc 88 a7 14 6d e8 f3 65  6b fd 91 2d 02 10 9c 58  |....m..ek..-...X|
+000000e0  0b d0 82 31 15 03 03 00  1a 00 00 00 00 00 00 00  |...1............|
+000000f0  02 10 75 b1 bb 71 c3 4e  12 d4 3f 9d 7f 15 15 c8  |..u..q.N..?.....|
+00000100  c2 25 51                                          |.%Q|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ALPN-NoMatch b/src/crypto/tls/testdata/Server-TLSv12-ALPN-NoMatch
index 992ee661c4..bc79effe52 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ALPN-NoMatch
+++ b/src/crypto/tls/testdata/Server-TLSv12-ALPN-NoMatch
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 bf 01 00 00  bb 03 03 60 8c 9e 48 42  |...........`..HB|
-00000010  d1 55 7b 73 05 12 ae ec  61 7d 25 30 ed 1c b8 39  |.U{s....a}%0...9|
-00000020  72 d9 11 5e f6 a7 a4 cf  df 24 76 00 00 38 c0 2c  |r..^.....$v..8.,|
+00000000  16 03 01 00 bf 01 00 00  bb 03 03 98 e1 7f 2e 26  |...............&|
+00000010  b2 9d d5 8e 2e 48 40 fd  ec 48 ea ea 1e d6 b5 97  |.....H@..H......|
+00000020  45 30 1d 04 4b d7 08 15  38 98 69 00 00 38 c0 2c  |E0..K...8.i..8.,|
 00000030  c0 30 00 9f cc a9 cc a8  cc aa c0 2b c0 2f 00 9e  |.0.........+./..|
 00000040  c0 24 c0 28 00 6b c0 23  c0 27 00 67 c0 0a c0 14  |.$.(.k.#.'.g....|
 00000050  00 39 c0 09 c0 13 00 33  00 9d 00 9c 00 3d 00 3c  |.9.....3.....=.<|
@@ -54,45 +54,41 @@
 00000260  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
 00000270  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
 00000280  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
-00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 cd 0c 00 00  |.\!.;...........|
-000002a0  c9 03 00 17 41 04 1e 18  37 ef 0d 19 51 88 35 75  |....A...7...Q.5u|
-000002b0  71 b5 e5 54 5b 12 2e 8f  09 67 fd a7 24 20 3e b2  |q..T[....g..$ >.|
-000002c0  56 1c ce 97 28 5e f8 2b  2d 4f 9e f1 07 9f 6c 4b  |V...(^.+-O....lK|
-000002d0  5b 83 56 e2 32 42 e9 58  b6 d7 49 a6 b5 68 1a 41  |[.V.2B.X..I..h.A|
-000002e0  03 56 6b dc 5a 89 05 01  00 80 a5 52 65 aa 70 b9  |.Vk.Z......Re.p.|
-000002f0  58 76 c8 07 4f 93 d4 8c  2b 37 ef 90 0b 6f 28 41  |Xv..O...+7...o(A|
-00000300  2a cc 74 34 38 ad 67 eb  ff 00 ba 89 03 dc 28 64  |*.t48.g.......(d|
-00000310  c7 61 44 95 e6 f7 9c 13  58 a6 62 57 e0 fc 64 7c  |.aD.....X.bW..d||
-00000320  49 74 e2 d5 fe ff 94 7a  22 59 11 5d 04 7c db f5  |It.....z"Y.].|..|
-00000330  55 7f 98 a0 70 15 9d 9b  e9 41 d9 aa cc 5f 68 71  |U...p....A..._hq|
-00000340  f6 cd ee 1a 8d 4a 66 b2  3a ce 4a 76 1d 3d 5b 53  |.....Jf.:.Jv.=[S|
-00000350  f8 27 c9 31 4e d5 fd 40  4f 5d ef 12 83 5e 5d 69  |.'.1N..@O]...^]i|
-00000360  38 6a 88 8d 92 41 6d 2d  3e 69 16 03 03 00 04 0e  |8j...Am->i......|
-00000370  00 00 00                                          |...|
+00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 ac 0c 00 00  |.\!.;...........|
+000002a0  a8 03 00 1d 20 2f e5 7d  a3 47 cd 62 43 15 28 da  |.... /.}.G.bC.(.|
+000002b0  ac 5f bb 29 07 30 ff f6  84 af c4 cf c2 ed 90 99  |._.).0..........|
+000002c0  5f 58 cb 3b 74 05 01 00  80 8c af fb 3a 4e 21 31  |_X.;t.......:N!1|
+000002d0  7f 11 bb fe a1 fc b6 49  0b 62 cc c5 6b 38 9e 37  |.......I.b..k8.7|
+000002e0  a7 8f 2a 3c 55 fe 37 c6  9c d9 d9 cb ae 0d e5 78  |..*<U.7........x|
+000002f0  59 91 71 d9 e6 99 3a 9f  d1 67 5e 38 07 8c 00 04  |Y.q...:..g^8....|
+00000300  bb 28 6e 6f 94 67 39 eb  58 0a f5 d5 62 5a d2 7d  |.(no.g9.X...bZ.}|
+00000310  b7 9e 6a 18 dc a3 1c e7  ea bf 18 f2 51 7b 69 96  |..j.........Q{i.|
+00000320  fa 9a 36 92 c7 6b 18 37  b0 9f 89 93 cb e7 1e a1  |..6..k.7........|
+00000330  6c df 77 d9 b2 a9 8a ee  c9 10 eb cf 6f 1d a8 c0  |l.w.........o...|
+00000340  51 e8 2a 4a 06 b2 dd 06  65 16 03 03 00 04 0e 00  |Q.*J....e.......|
+00000350  00 00                                             |..|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 e3 0b 0e 3c d4  |....F...BA....<.|
-00000010  63 8c 7c 65 4c 64 cb d1  76 25 78 16 e7 68 b5 3c  |c.|eLd..v%x..h.<|
-00000020  2b 86 94 f8 07 39 e1 a3  f6 f7 d3 57 d0 c5 5f f5  |+....9.....W.._.|
-00000030  eb c6 67 d0 c0 d4 1a 78  39 61 03 7b 9a 53 db 8a  |..g....x9a.{.S..|
-00000040  2f 43 b4 ef 31 b8 ac d0  49 fe 45 14 03 03 00 01  |/C..1...I.E.....|
-00000050  01 16 03 03 00 28 b3 d6  bc 4f 3c c8 a5 d4 47 1b  |.....(...O<...G.|
-00000060  17 db be 1b 20 73 5f 3f  b9 d2 9a 41 15 92 bc 28  |.... s_?...A...(|
-00000070  73 30 5d c5 c2 82 8c 01  c5 dd 12 f1 76 f1        |s0].........v.|
+00000000  16 03 03 00 25 10 00 00  21 20 60 e5 8f 49 20 e7  |....%...! `..I .|
+00000010  a0 88 47 cd 43 d9 b8 2e  6f e5 5e c5 8a 1c be 95  |..G.C...o.^.....|
+00000020  0e 02 f4 0b e1 c1 4a fe  97 08 14 03 03 00 01 01  |......J.........|
+00000030  16 03 03 00 28 b2 c2 69  3a b6 b5 f1 c2 b0 e8 d2  |....(..i:.......|
+00000040  e1 31 26 2d a5 a7 4d 9f  d5 66 53 b7 0b 05 b7 a5  |.1&-..M..fS.....|
+00000050  16 c5 1c 93 e8 e7 4b 62  c6 0f 28 84 aa           |......Kb..(..|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 82 04 00 00  7e 00 00 00 00 00 78 50  |........~.....xP|
 00000010  46 ad c1 db a8 38 86 7b  2b bb fd d0 c3 42 3e 00  |F....8.{+....B>.|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000030  6f ec 80 83 61 dd a0 38  1e bf 55 20 48 cf 04 4c  |o...a..8..U H..L|
-00000040  7f 7d f9 e8 62 2b 25 72  6d fc 89 4e e6 20 51 5e  |.}..b+%rm..N. Q^|
-00000050  b6 a8 4b 26 95 bb 03 93  43 2f a8 a3 86 2f 88 45  |..K&....C/.../.E|
-00000060  95 17 03 e9 85 33 94 8e  88 8e 25 7a c7 e6 8f 21  |.....3....%z...!|
-00000070  a7 a7 ca 81 07 e4 0b a6  44 60 df 19 66 9c d9 3d  |........D`..f..=|
-00000080  47 1b a2 29 3e a7 09 14  03 03 00 01 01 16 03 03  |G..)>...........|
-00000090  00 28 00 00 00 00 00 00  00 00 94 37 d6 25 aa 5c  |.(.........7.%.\|
-000000a0  28 f9 7b ab 15 d4 77 9c  ee 67 ed 04 58 b0 f8 90  |(.{...w..g..X...|
-000000b0  bf 57 2c 83 19 2d 2c 1d  63 cd 17 03 03 00 25 00  |.W,..-,.c.....%.|
-000000c0  00 00 00 00 00 00 01 41  3a 44 90 fa a5 73 a8 cb  |.......A:D...s..|
-000000d0  a7 1b 08 38 b9 15 a4 87  76 55 4a 04 d8 13 54 8e  |...8....vUJ...T.|
-000000e0  56 a0 d6 1e 15 03 03 00  1a 00 00 00 00 00 00 00  |V...............|
-000000f0  02 18 41 23 67 cf a2 be  f2 72 4d 49 55 9d 51 56  |..A#g....rMIU.QV|
-00000100  ef c1 f8                                          |...|
+00000030  6f ec 80 83 61 92 c1 74  0b f2 b3 d6 e0 f0 a6 b2  |o...a..t........|
+00000040  3d bd aa d0 86 b4 cc 3f  38 38 43 d8 a2 e6 20 0d  |=......?88C... .|
+00000050  76 9b fc e2 98 e7 68 13  77 17 d3 f2 a7 9f c0 47  |v.....h.w......G|
+00000060  39 0d 90 12 cb 33 94 d0  76 b9 ee 13 62 f8 3f 8d  |9....3..v...b.?.|
+00000070  3f 37 60 68 e7 19 e0 5c  1e 43 67 ba 00 14 86 1b  |?7`h...\.Cg.....|
+00000080  29 49 d6 c5 85 18 16 14  03 03 00 01 01 16 03 03  |)I..............|
+00000090  00 28 00 00 00 00 00 00  00 00 e1 8e a9 ec 25 a7  |.(............%.|
+000000a0  ba 5c 63 37 a8 cd 8c d2  51 32 f8 de 46 85 0a 64  |.\c7....Q2..F..d|
+000000b0  7c a3 f8 2c b0 f5 75 4a  af 03 17 03 03 00 25 00  ||..,..uJ......%.|
+000000c0  00 00 00 00 00 00 01 45  06 45 ae 60 76 ac 41 8a  |.......E.E.`v.A.|
+000000d0  d7 96 0a 98 56 a8 1b 27  20 5e c6 99 ef 26 c4 b8  |....V..' ^...&..|
+000000e0  de 14 f3 70 15 03 03 00  1a 00 00 00 00 00 00 00  |...p............|
+000000f0  02 dd 30 a5 8c f5 3a 88  4a 68 14 a7 ef 37 ce ad  |..0...:.Jh...7..|
+00000100  a7 1d 67                                          |..g|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceECDSA b/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceECDSA
index 8d43c703bd..beb917f6a0 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceECDSA
+++ b/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceECDSA
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 a7 01 00 00  a3 03 03 83 d8 14 88 ec  |................|
-00000010  13 67 4d 0f 73 63 85 9c  87 14 3e ee 9c 0e 00 72  |.gM.sc....>....r|
-00000020  79 8c 2a c9 61 1e c3 fa  21 5a 94 00 00 38 c0 2c  |y.*.a...!Z...8.,|
+00000000  16 03 01 00 a7 01 00 00  a3 03 03 58 3e 61 87 99  |...........X>a..|
+00000010  e5 1f ec 7f 33 d0 56 2a  80 ae 0f 01 e1 51 1e 31  |....3.V*.....Q.1|
+00000020  20 be 50 b3 63 f8 de 85  6c ff 85 00 00 38 c0 2c  | .P.c...l....8.,|
 00000030  c0 30 00 9f cc a9 cc a8  cc aa c0 2b c0 2f 00 9e  |.0.........+./..|
 00000040  c0 24 c0 28 00 6b c0 23  c0 27 00 67 c0 0a c0 14  |.$.(.k.#.'.g....|
 00000050  00 39 c0 09 c0 13 00 33  00 9d 00 9c 00 3d 00 3c  |.9.....3.....=.<|
@@ -47,43 +47,39 @@
 00000210  0e bd 3f a3 8c 25 c1 33  13 83 0d 94 06 bb d4 37  |..?..%.3.......7|
 00000220  7a f6 ec 7a c9 86 2e dd  d7 11 69 7f 85 7c 56 de  |z..z......i..|V.|
 00000230  fb 31 78 2b e4 c7 78 0d  ae cb be 9e 4e 36 24 31  |.1x+..x.....N6$1|
-00000240  7b 6a 0f 39 95 12 07 8f  2a 16 03 03 00 d8 0c 00  |{j.9....*.......|
-00000250  00 d4 03 00 17 41 04 1e  18 37 ef 0d 19 51 88 35  |.....A...7...Q.5|
-00000260  75 71 b5 e5 54 5b 12 2e  8f 09 67 fd a7 24 20 3e  |uq..T[....g..$ >|
-00000270  b2 56 1c ce 97 28 5e f8  2b 2d 4f 9e f1 07 9f 6c  |.V...(^.+-O....l|
-00000280  4b 5b 83 56 e2 32 42 e9  58 b6 d7 49 a6 b5 68 1a  |K[.V.2B.X..I..h.|
-00000290  41 03 56 6b dc 5a 89 05  03 00 8b 30 81 88 02 42  |A.Vk.Z.....0...B|
-000002a0  00 b8 f1 eb 86 28 6b 15  e3 40 4a ff 9c de 64 4b  |.....(k..@J...dK|
-000002b0  0c d5 94 f5 80 bd 5e 1e  7c 44 df 9b 93 e3 5c 14  |......^.|D....\.|
-000002c0  db 5c 37 f5 dc 66 52 d3  11 63 39 ca 3a 54 80 e1  |.\7..fR..c9.:T..|
-000002d0  f7 80 1f 71 54 cd bd 96  42 4a 69 1a 0f 84 10 68  |...qT...BJi....h|
-000002e0  e2 22 02 42 01 59 e6 60  75 6d e9 f2 c9 13 0c b7  |.".B.Y.`um......|
-000002f0  be 37 7f 7f e0 ba c9 94  ad 50 b9 a3 28 3f 32 a9  |.7.......P..(?2.|
-00000300  20 d9 e6 5c 15 e5 54 2b  25 32 80 c6 b8 c4 27 36  | ..\..T+%2....'6|
-00000310  8b 52 c2 bb 3a 6e d0 67  8c 4b 69 b7 3b 23 11 cc  |.R..:n.g.Ki.;#..|
-00000320  d5 0d 72 07 85 d8 16 03  03 00 04 0e 00 00 00     |..r............|
+00000240  7b 6a 0f 39 95 12 07 8f  2a 16 03 03 00 b7 0c 00  |{j.9....*.......|
+00000250  00 b3 03 00 1d 20 2f e5  7d a3 47 cd 62 43 15 28  |..... /.}.G.bC.(|
+00000260  da ac 5f bb 29 07 30 ff  f6 84 af c4 cf c2 ed 90  |.._.).0.........|
+00000270  99 5f 58 cb 3b 74 05 03  00 8b 30 81 88 02 42 00  |._X.;t....0...B.|
+00000280  ab 8e 88 16 6d 70 4d 1f  80 08 6f 65 38 03 d0 f1  |....mpM...oe8...|
+00000290  bb 90 17 cb e1 43 c2 8f  eb e0 0f bc 76 82 a2 a3  |.....C......v...|
+000002a0  cf 7b c7 53 96 64 a1 ef  47 e5 09 b7 de 38 03 9a  |.{.S.d..G....8..|
+000002b0  23 15 12 ea ea 16 c6 ba  00 03 a6 69 f7 4b 3e b3  |#..........i.K>.|
+000002c0  e0 02 42 01 8c 8a fa 30  9b f0 79 b8 4f c4 bd 37  |..B....0..y.O..7|
+000002d0  d4 98 5e e7 b3 a7 a4 d6  97 46 d8 3a 7e 48 cf 84  |..^......F.:~H..|
+000002e0  a6 ca aa e2 bd 09 d2 bf  ec 1a 63 8f c6 82 90 4c  |..........c....L|
+000002f0  97 ae 6b 58 62 f5 08 61  de a5 e6 0b 6a 20 5a 0f  |..kXb..a....j Z.|
+00000300  4a 62 94 f4 3b 16 03 03  00 04 0e 00 00 00        |Jb..;.........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 9f 54 db bd 3a  |....F...BA..T..:|
-00000010  d2 71 42 ed 24 99 95 5a  4c 97 12 3c d3 bd 5f 4d  |.qB.$..ZL..<.._M|
-00000020  f3 8b 70 5f e8 cb c1 f4  bc 25 0c 2f 2a 80 4f 46  |..p_.....%./*.OF|
-00000030  61 b5 66 99 42 71 de 41  fb 29 44 a5 bb c3 de 49  |a.f.Bq.A.)D....I|
-00000040  f6 83 c7 50 14 49 36 be  3c 8c 2c 14 03 03 00 01  |...P.I6.<.,.....|
-00000050  01 16 03 03 00 40 9b f8  d7 5b ba 0a 97 2b ef f2  |.....@...[...+..|
-00000060  94 a2 03 83 f1 aa 62 31  d5 42 a2 98 11 25 fa ba  |......b1.B...%..|
-00000070  5e d1 59 40 07 20 93 21  80 4f 63 ca 6e 64 77 28  |^.Y@. .!.Oc.ndw(|
-00000080  da 69 12 a7 68 a7 f8 ed  ff 26 7b cb 22 d5 76 1b  |.i..h....&{.".v.|
-00000090  f1 3b 67 66 07 a4                                 |.;gf..|
+00000000  16 03 03 00 25 10 00 00  21 20 17 87 df 7b b5 9d  |....%...! ...{..|
+00000010  bf 65 b8 f9 15 f9 aa e6  cc 1f 84 9d 62 da 04 05  |.e..........b...|
+00000020  19 d8 dc ec 99 4f 93 92  8e 63 14 03 03 00 01 01  |.....O...c......|
+00000030  16 03 03 00 40 6b 25 cd  48 fb 07 e4 cb ce 34 d2  |....@k%.H.....4.|
+00000040  b2 ea 74 03 f3 ec 96 e7  11 f5 88 b2 73 12 b5 19  |..t.........s...|
+00000050  70 b4 0b 67 c4 4e 9a b2  ad e7 fe 75 00 a3 74 1b  |p..g.N.....u..t.|
+00000060  60 50 fe 25 d7 e8 69 c0  ae 34 90 3a 6d 45 19 10  |`P.%..i..4.:mE..|
+00000070  9b 78 66 d6 f1                                    |.xf..|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 83 55 25 ad d6  |............U%..|
-00000020  5c d1 75 26 44 f9 d8 fc  41 58 22 00 db a2 da 4b  |\.u&D...AX"....K|
-00000030  90 a1 69 32 b2 48 72 6b  7c 5c 4b 8f 97 f4 0b e7  |..i2.Hrk|\K.....|
-00000040  f5 83 c4 4e fd f2 8d 88  1a e9 75 17 03 03 00 40  |...N......u....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 1f be 2f 53 d8  |............./S.|
+00000020  61 79 10 70 69 11 04 2e  77 f5 93 e4 64 94 86 fe  |ay.pi...w...d...|
+00000030  c1 aa 33 ce 45 be 6a 73  d6 5e 55 2d 24 66 3f e0  |..3.E.js.^U-$f?.|
+00000040  5b 87 eb ff 51 f3 97 f8  5f 92 97 17 03 03 00 40  |[...Q..._......@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  e1 e2 ae 44 cf 87 a0 b9  1f 34 bb dd 07 a8 cb 3d  |...D.....4.....=|
-00000070  3b 1f 0e 9f be 40 56 04  93 44 e8 ef fb a4 b4 97  |;....@V..D......|
-00000080  60 ce 62 6b 95 6a 0e fd  5b 7b 03 c3 68 d7 51 df  |`.bk.j..[{..h.Q.|
+00000060  e1 b7 e7 08 53 75 8b 29  8f f0 92 35 b8 13 e1 42  |....Su.)...5...B|
+00000070  eb 19 6f 51 62 7b 1d 87  50 0b df 6b c8 cc b0 7a  |..oQb{..P..k...z|
+00000080  41 3a da 00 71 a3 d3 9f  45 a7 ff 9d ca b6 37 0e  |A:..q...E.....7.|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 bb 62 4c  32 c1 27 d9 f5 d6 c3 af  |......bL2.'.....|
-000000b0  4b 15 d2 ae 2a 3b d5 57  d3 64 68 ca b4 1b 55 d0  |K...*;.W.dh...U.|
-000000c0  ee fb e0 69 28                                    |...i(|
+000000a0  00 00 00 00 00 00 8e 25  7b c3 46 04 f8 80 7b c0  |.......%{.F...{.|
+000000b0  ee 1a 8c 03 6f 24 81 2f  ff 26 d5 d3 72 9d e6 c5  |....o$./.&..r...|
+000000c0  78 b0 30 c4 9a                                    |x.0..|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceRSA b/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceRSA
index 80857b52f3..ce64b55a35 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceRSA
+++ b/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceRSA
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 a7 01 00 00  a3 03 03 c6 e0 ed 21 7c  |..............!||
-00000010  09 45 6b 15 e9 26 d1 1c  39 d8 e7 b9 45 4f 35 0d  |.Ek..&..9...EO5.|
-00000020  b5 7f 57 0b e0 2d 9b 32  a0 85 f8 00 00 38 c0 2c  |..W..-.2.....8.,|
+00000000  16 03 01 00 a7 01 00 00  a3 03 03 1a 3d c8 bf 28  |............=..(|
+00000010  26 dd dc a9 bc 97 31 d4  9c fb 79 e6 77 82 a7 7e  |&.....1...y.w..~|
+00000020  d7 87 71 5e fb 7f fe c8  12 01 23 00 00 38 c0 2c  |..q^......#..8.,|
 00000030  c0 30 00 9f cc a9 cc a8  cc aa c0 2b c0 2f 00 9e  |.0.........+./..|
 00000040  c0 24 c0 28 00 6b c0 23  c0 27 00 67 c0 0a c0 14  |.$.(.k.#.'.g....|
 00000050  00 39 c0 09 c0 13 00 33  00 9d 00 9c 00 3d 00 3c  |.9.....3.....=.<|
@@ -52,42 +52,38 @@
 00000260  f1 6c 04 ed 73 bb b3 43  77 8d 0c 1c f1 0f a1 d8  |.l..s..Cw.......|
 00000270  40 83 61 c9 4c 72 2b 9d  ae db 46 06 06 4d f4 c1  |@.a.Lr+...F..M..|
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
-00000290  3b e9 fa e7 16 03 03 00  cd 0c 00 00 c9 03 00 17  |;...............|
-000002a0  41 04 1e 18 37 ef 0d 19  51 88 35 75 71 b5 e5 54  |A...7...Q.5uq..T|
-000002b0  5b 12 2e 8f 09 67 fd a7  24 20 3e b2 56 1c ce 97  |[....g..$ >.V...|
-000002c0  28 5e f8 2b 2d 4f 9e f1  07 9f 6c 4b 5b 83 56 e2  |(^.+-O....lK[.V.|
-000002d0  32 42 e9 58 b6 d7 49 a6  b5 68 1a 41 03 56 6b dc  |2B.X..I..h.A.Vk.|
-000002e0  5a 89 05 01 00 80 92 d2  50 33 89 38 da 9b ca f6  |Z.......P3.8....|
-000002f0  5c e4 71 81 e3 c2 20 4e  76 7f 5a fd db 23 30 a4  |\.q... Nv.Z..#0.|
-00000300  13 23 b5 21 5d 07 48 bf  4d d9 cd cc 9e 61 3c ef  |.#.!].H.M....a<.|
-00000310  2e 08 39 0e 67 a4 04 61  ce ed de 8d b6 fd c1 6c  |..9.g..a.......l|
-00000320  40 bf a5 0a 81 58 8d 19  f6 00 ea e8 f3 da 86 d1  |@....X..........|
-00000330  6f 30 bc af 7f a0 ff 55  26 8a c4 aa 67 7e dd 51  |o0.....U&...g~.Q|
-00000340  99 2d d7 6c b0 1f ad 5b  7e 2b c4 2c c1 61 87 3b  |.-.l...[~+.,.a.;|
-00000350  99 46 8d a4 60 a6 e1 6a  76 84 a7 d9 d0 7a f7 cf  |.F..`..jv....z..|
-00000360  25 d5 e7 f7 ec 98 16 03  03 00 04 0e 00 00 00     |%..............|
+00000290  3b e9 fa e7 16 03 03 00  ac 0c 00 00 a8 03 00 1d  |;...............|
+000002a0  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+000002b0  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+000002c0  74 05 01 00 80 ce 89 0e  f4 4b ca f2 d0 0a ed 13  |t........K......|
+000002d0  a8 3b 0c 59 26 c2 70 65  1d ec fd 35 d3 0d 06 a1  |.;.Y&.pe...5....|
+000002e0  23 3e 8c a1 11 8b c8 87  5c 6b f9 f0 75 f6 14 61  |#>......\k..u..a|
+000002f0  16 42 77 f2 25 3f d6 67  89 06 9d 2d b0 99 b6 5e  |.Bw.%?.g...-...^|
+00000300  ad 96 03 c2 df e9 1b cf  df f3 5b 36 eb 88 48 86  |..........[6..H.|
+00000310  cc ee 31 dd 9e 9e 6d 3b  06 f4 66 26 9e 1f 32 b2  |..1...m;..f&..2.|
+00000320  10 37 43 0f 5c c2 21 e9  a9 40 3c 25 b0 81 3a 2a  |.7C.\.!..@<%..:*|
+00000330  24 b5 55 61 cb eb d8 c9  80 5b ac 19 94 79 ab 3d  |$.Ua.....[...y.=|
+00000340  f0 98 84 01 f2 16 03 03  00 04 0e 00 00 00        |..............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 81 f6 51 07 43  |....F...BA...Q.C|
-00000010  27 64 fd ac a7 30 b0 06  97 ba 85 50 f9 41 da 33  |'d...0.....P.A.3|
-00000020  8c 1a 4b 17 b4 63 04 2c  14 f7 35 a8 8b 79 40 08  |..K..c.,..5..y@.|
-00000030  a8 b2 7e 24 cf 51 f0 1e  2b a9 f9 42 0d 7e 0a 17  |..~$.Q..+..B.~..|
-00000040  bb 94 f0 7e 66 e1 bf 87  e6 f3 65 14 03 03 00 01  |...~f.....e.....|
-00000050  01 16 03 03 00 40 7b 65  a7 15 d5 d9 03 c8 79 ab  |.....@{e......y.|
-00000060  16 eb 0d 78 d7 31 9f bb  88 be aa 19 fd 15 dc e7  |...x.1..........|
-00000070  9e 89 df cf 28 e6 e9 be  7b ec 9b 79 05 9e d8 4d  |....(...{..y...M|
-00000080  0a 43 90 97 2e b0 f7 f4  a7 98 36 9b b5 45 a0 5c  |.C........6..E.\|
-00000090  e6 cf 8f 52 66 6f                                 |...Rfo|
+00000000  16 03 03 00 25 10 00 00  21 20 1c b3 c7 8a 87 21  |....%...! .....!|
+00000010  44 31 74 33 0b 51 ca 9a  7a c8 91 b4 53 23 34 39  |D1t3.Q..z...S#49|
+00000020  f0 8c 43 52 79 90 38 51  74 6c 14 03 03 00 01 01  |..CRy.8Qtl......|
+00000030  16 03 03 00 40 02 b6 4c  52 fb 2c dc 5e 5b b7 12  |....@..LR.,.^[..|
+00000040  79 e0 10 e4 11 c5 eb 19  dc 36 fd 70 17 9a 3b 24  |y........6.p..;$|
+00000050  52 38 68 3e 06 47 4f 52  1d 46 5b 4d aa 89 e5 5f  |R8h>.GOR.F[M..._|
+00000060  0f 9a b4 a4 a6 ca 5d 52  9f 4d 29 05 43 c0 68 e1  |......]R.M).C.h.|
+00000070  32 dc 67 7c 0e                                    |2.g|.|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 65 e7 6e b1 7b  |...........e.n.{|
-00000020  eb cc 56 f0 b6 d5 f3 62  0f 04 e9 f3 19 40 ff 10  |..V....b.....@..|
-00000030  62 1b 5d f8 d9 58 4d 0f  c1 21 2d ce 27 22 3e 1b  |b.]..XM..!-.'">.|
-00000040  83 b2 08 bd a6 1d f8 d8  51 39 72 17 03 03 00 40  |........Q9r....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 8a 7e 9c ce 95  |............~...|
+00000020  63 33 ff 0f 64 cb ea 9a  da 0a 46 e4 84 be 78 ed  |c3..d.....F...x.|
+00000030  7a cb 2d be 49 fb 5d 37  50 02 95 7c ca 40 f7 b9  |z.-.I.]7P..|.@..|
+00000040  4d fb e7 33 96 d3 e5 f5  fe 2c 80 17 03 03 00 40  |M..3.....,.....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  4c 58 dd ee ab 29 35 6e  c1 b7 17 14 80 71 99 3e  |LX...)5n.....q.>|
-00000070  f2 1d 70 14 95 87 c1 b9  75 a3 26 78 b0 93 22 33  |..p.....u.&x.."3|
-00000080  42 77 6f 0a 13 45 a4 5b  76 69 b8 a1 4b 6e c3 37  |Bwo..E.[vi..Kn.7|
+00000060  71 8c 9b 72 d1 a7 57 77  ec 4b bd 4c 77 b7 38 18  |q..r..Ww.K.Lw.8.|
+00000070  1f 48 9a 29 a7 bd 5a 4e  90 24 8d 9a 51 72 b4 d4  |.H.)..ZN.$..Qr..|
+00000080  40 01 df cf b8 d1 bf e0  69 de 39 ca 89 2c 0e e8  |@.......i.9..,..|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 60 8b 42  ec 29 a7 60 fc 3a 0a d3  |.....`.B.).`.:..|
-000000b0  72 c0 42 e0 13 16 46 5a  2b 17 ee 62 56 bc f2 c1  |r.B...FZ+..bV...|
-000000c0  ed db 99 cf aa                                    |.....|
+000000a0  00 00 00 00 00 88 c0 bf  4d 33 2f 6d 34 13 15 8c  |........M3/m4...|
+000000b0  10 d4 40 6c f6 f2 3e a2  d2 d9 e9 95 53 64 4d a0  |..@l..>.....SdM.|
+000000c0  72 a6 bf 8f b1                                    |r....|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndECDSAGiven b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndECDSAGiven
index a7ff62fab1..b20f9342fb 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndECDSAGiven
+++ b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndECDSAGiven
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 5d 01 00 00  59 03 03 d7 12 82 dd 63  |....]...Y......c|
-00000010  23 f8 ad 94 0d f4 8a c7  8c b3 55 99 6a 6d d7 f6  |#.........U.jm..|
-00000020  d5 f5 5b 7c b0 20 ee ed  3b 04 c0 00 00 04 00 2f  |..[|. ..;....../|
+00000000  16 03 01 00 5d 01 00 00  59 03 03 6e 8f fe 9e 99  |....]...Y..n....|
+00000010  2c 27 44 3b b6 f0 f9 d9  dc 9a 5c 2a 73 24 54 85  |,'D;......\*s$T.|
+00000020  71 9b 2a be 33 0c a5 64  4f 4b d4 00 00 04 00 2f  |q.*.3..dOK...../|
 00000030  00 ff 01 00 00 2c 00 0d  00 20 00 1e 06 01 06 02  |.....,... ......|
 00000040  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
 00000050  03 02 03 03 02 01 02 02  02 03 00 16 00 00 00 17  |................|
@@ -85,40 +85,40 @@
 000001e0  be e8 91 b3 da 1a f5 5d  a3 23 f5 26 8b 45 70 8d  |.......].#.&.Ep.|
 000001f0  65 62 9b 7e 01 99 3d 18  f6 10 9a 38 61 9b 2e 57  |eb.~..=....8a..W|
 00000200  e4 fa cc b1 8a ce e2 23  a0 87 f0 e1 67 51 eb 16  |.......#....gQ..|
-00000210  03 03 00 86 10 00 00 82  00 80 b1 97 e3 ae b9 19  |................|
-00000220  17 f8 a8 98 30 6c 4b 53  a0 44 c9 8a ad b4 6a 2c  |....0lKS.D....j,|
-00000230  19 c8 96 88 dd 9d 00 7b  7f f3 d7 c8 5d 87 86 49  |.......{....]..I|
-00000240  52 fb 3c d5 68 b5 75 dd  de 9e 19 2f e2 ed 0c a6  |R.<.h.u..../....|
-00000250  05 12 29 b6 e8 16 af ef  6e f9 b4 c3 86 6e 0c 65  |..).....n....n.e|
-00000260  9a 9d 1e 52 98 4f e3 b1  a1 c3 d5 9d ea 90 ab 69  |...R.O.........i|
-00000270  e7 1c 37 5e c8 a2 d9 50  dd b3 00 fe b2 a1 6a 05  |..7^...P......j.|
-00000280  62 61 2e 89 fa ad b6 9f  a4 74 27 f8 bd ba ee 41  |ba.......t'....A|
-00000290  2a 44 82 31 86 9a 58 43  b1 bc 16 03 03 00 93 0f  |*D.1..XC........|
-000002a0  00 00 8f 04 03 00 8b 30  81 88 02 42 01 f3 07 47  |.......0...B...G|
-000002b0  ea f9 5c 44 67 6e 37 d5  63 c0 df 91 3a cb a5 1b  |..\Dgn7.c...:...|
-000002c0  0f e4 f2 36 56 19 49 84  88 8e 4d bf e4 ba 2f 47  |...6V.I...M.../G|
-000002d0  f8 d8 96 2e 8c 41 3a 4f  42 a8 4c f1 06 1d 8f 9b  |.....A:OB.L.....|
-000002e0  62 be 3d c3 e9 7e 68 f9  39 b6 88 cf 1a 56 02 42  |b.=..~h.9....V.B|
-000002f0  00 8f de d5 78 72 56 f0  ef 92 fb 96 2b 4a f7 14  |....xrV.....+J..|
-00000300  36 89 a5 36 73 78 c0 e9  e0 e6 3b 8b 45 9a 13 e5  |6..6sx....;.E...|
-00000310  a8 21 d3 63 e0 03 37 92  6f c7 71 b9 64 55 05 04  |.!.c..7.o.q.dU..|
-00000320  89 d4 e1 af 3e 8f ee 1c  52 67 b8 c5 78 ca 54 0f  |....>...Rg..x.T.|
-00000330  4d 5f 14 03 03 00 01 01  16 03 03 00 40 d6 87 b0  |M_..........@...|
-00000340  39 ff 10 da 8b 36 e9 11  84 84 ae c3 f2 83 1d fd  |9....6..........|
-00000350  86 ff 03 b9 0f c0 6d 10  8b 40 1b 30 96 ce 7f a8  |......m..@.0....|
-00000360  5a b2 a8 0a 46 81 cc 9b  14 bf 62 8b b2 f1 5c 22  |Z...F.....b...\"|
-00000370  47 75 cb 44 d6 a1 a2 6a  94 2b 25 54 9d           |Gu.D...j.+%T.|
+00000210  03 03 00 86 10 00 00 82  00 80 01 5a 87 e9 2e 55  |...........Z...U|
+00000220  20 98 fa f9 aa 05 bb 1a  91 dc 48 df f6 df 89 c7  | .........H.....|
+00000230  a5 8e 5b 8b 22 b1 ea 7c  b3 7e 1a 17 4c 85 33 26  |..[."..|.~..L.3&|
+00000240  e3 f5 23 f7 1f 68 8c 07  92 13 c1 57 6c bc 54 b0  |..#..h.....Wl.T.|
+00000250  a5 d5 bc 98 d3 c2 1e 05  c8 e4 76 3e fc 99 bd 64  |..........v>...d|
+00000260  b6 92 86 bb c5 00 38 2e  1e 31 d2 ae ac 35 23 fa  |......8..1...5#.|
+00000270  91 0e 37 75 61 7b 95 a6  27 12 3c b2 92 9a db 36  |..7ua{..'.<....6|
+00000280  c1 74 f7 60 f9 ad 15 27  62 e2 8b 8a 98 b8 d5 80  |.t.`...'b.......|
+00000290  72 23 6d 7c f2 50 50 bd  4b 18 16 03 03 00 93 0f  |r#m|.PP.K.......|
+000002a0  00 00 8f 04 03 00 8b 30  81 88 02 42 01 54 cf 40  |.......0...B.T.@|
+000002b0  89 32 38 70 58 26 f8 fa  7c 7b 19 22 d8 17 49 73  |.28pX&..|{."..Is|
+000002c0  d3 8d 7b 33 67 cc 70 5b  62 03 6e 8f 46 6f 67 c9  |..{3g.p[b.n.Fog.|
+000002d0  be a2 ef 13 46 97 e0 7c  5b 92 2e 44 7a 13 1f bc  |....F..|[..Dz...|
+000002e0  87 e0 f3 fd 20 d7 f1 d5  a3 5e df 6a bc 9b 02 42  |.... ....^.j...B|
+000002f0  00 83 a6 28 27 3e 0c a4  1e 4e 8e 10 a0 66 8d f8  |...('>...N...f..|
+00000300  fc 5a d9 02 23 6a 27 cc  0c 71 50 0d 3e 82 8d 82  |.Z..#j'..qP.>...|
+00000310  4d e4 02 0b b0 b7 46 b6  08 9e a3 79 96 6e 5e 5a  |M.....F....y.n^Z|
+00000320  d3 8a 79 d5 6f 0f a7 31  5c 3f d5 a1 a0 88 b8 41  |..y.o..1\?.....A|
+00000330  d7 70 14 03 03 00 01 01  16 03 03 00 40 ef 8f 04  |.p..........@...|
+00000340  5a 8a 16 32 69 4c 41 de  87 4f 08 01 c1 61 2a 0c  |Z..2iLA..O...a*.|
+00000350  c4 c6 4c 52 41 71 14 d2  b4 4f 3d 70 d7 55 f2 9f  |..LRAq...O=p.U..|
+00000360  28 8b 37 7a f4 f7 de 9f  57 c5 44 b1 91 43 a3 9c  |(.7z....W.D..C..|
+00000370  5f 19 d6 6b c6 71 5f 61  a2 4d 45 c5 ff           |_..k.q_a.ME..|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 85 e3 d1 d9 d5  |................|
-00000020  65 15 4f 6b 60 52 11 4f  a8 dd 8a f6 86 77 34 9a  |e.Ok`R.O.....w4.|
-00000030  20 1c b6 08 21 8a 58 6a  ad 7f 78 1b 61 18 a5 9e  | ...!.Xj..x.a...|
-00000040  58 56 14 12 5c e7 3e bc  53 66 c5 17 03 03 00 40  |XV..\.>.Sf.....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 d1 52 a9 0b 1c  |............R...|
+00000020  ba 60 c1 93 59 a0 d7 1e  95 bb 84 fe bc 76 15 1e  |.`..Y........v..|
+00000030  72 1f c0 a2 7a be a4 8c  60 f3 f3 78 81 16 26 8c  |r...z...`..x..&.|
+00000040  d7 83 e4 4f 06 ba 6c 72  7d a7 fa 17 03 03 00 40  |...O..lr}......@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  88 a3 55 9e 29 cc 97 6a  b9 67 94 2b 22 c4 2b 24  |..U.)..j.g.+".+$|
-00000070  22 3c af 8d b4 20 03 73  3d 9d d6 d7 42 f8 22 0d  |"<... .s=...B.".|
-00000080  bf 9a d0 70 42 7b 7b 6f  3f 2e d8 9b 59 8b eb 5f  |...pB{{o?...Y.._|
+00000060  7e 9c b9 e4 f1 a6 87 0c  ce d8 f0 eb 37 fc aa 57  |~...........7..W|
+00000070  5f 98 d6 b5 5e 9a 82 6c  19 80 ba 36 93 c0 67 42  |_...^..l...6..gB|
+00000080  57 88 d7 3f 66 f1 15 09  3c 40 16 bc 9f c4 8c 54  |W..?f...<@.....T|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 64 b3 8c  5a 16 0d bf 69 66 05 58  |.....d..Z...if.X|
-000000b0  d0 5d 67 a7 29 0c ec e1  f4 99 6f c6 96 de 4e a2  |.]g.).....o...N.|
-000000c0  55 6d 33 b5 58                                    |Um3.X|
+000000a0  00 00 00 00 00 b1 fc ed  bd 8b d8 f7 1c a6 65 6a  |..............ej|
+000000b0  85 03 6b ab ee d6 df 8d  e7 69 9f a1 ac fc 4d 2e  |..k......i....M.|
+000000c0  07 a4 ec fc ec                                    |.....|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndGiven b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndGiven
index 56752fbc23..a6a7676b4b 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndGiven
+++ b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndGiven
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 5d 01 00 00  59 03 03 15 ae f7 7e 39  |....]...Y.....~9|
-00000010  6a 96 da d0 a0 58 44 b7  38 92 d7 4c 41 72 49 d3  |j....XD.8..LArI.|
-00000020  e8 65 74 4c 1c a0 1a de  e5 03 53 00 00 04 00 2f  |.etL......S..../|
+00000000  16 03 01 00 5d 01 00 00  59 03 03 94 e5 c5 27 21  |....]...Y.....'!|
+00000010  3f de 6d 5e 20 2f a9 54  9b db db fd 60 38 22 1e  |?.m^ /.T....`8".|
+00000020  df 4a ba e7 40 4e e5 f1  64 58 fa 00 00 04 00 2f  |.J..@N..dX...../|
 00000030  00 ff 01 00 00 2c 00 0d  00 20 00 1e 06 01 06 02  |.....,... ......|
 00000040  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
 00000050  03 02 03 03 02 01 02 02  02 03 00 16 00 00 00 17  |................|
@@ -84,40 +84,40 @@
 000001d0  ac 11 b1 28 56 be 1d cd  61 62 84 09 bf d6 80 c6  |...(V...ab......|
 000001e0  45 8d 82 2c b4 d8 83 9b  db c9 22 b7 2a 12 11 7b  |E..,......".*..{|
 000001f0  fa 02 3b c1 c9 ff ea c9  9d a8 49 d3 95 d7 d5 0e  |..;.......I.....|
-00000200  e5 35 16 03 03 00 86 10  00 00 82 00 80 20 d8 e1  |.5........... ..|
-00000210  b1 0a 0d a5 85 07 d9 45  a0 36 29 4e 37 b7 17 13  |.......E.6)N7...|
-00000220  b7 c4 52 a6 a0 55 3b ad  ee 67 20 3f 96 76 d4 6d  |..R..U;..g ?.v.m|
-00000230  bd 4c 76 23 e4 a3 df a8  1e 73 22 ce ca 99 02 39  |.Lv#.....s"....9|
-00000240  2f 75 3a 7d 60 7e c8 dd  9e 51 d6 f5 7b 14 b1 e4  |/u:}`~...Q..{...|
-00000250  1e ed 71 e0 26 99 41 68  0d d2 61 3e 5f 90 f1 58  |..q.&.Ah..a>_..X|
-00000260  20 af ab 5f a6 e2 61 47  b8 d2 14 e0 d8 51 54 16  | .._..aG.....QT.|
-00000270  9c f8 75 13 ec e6 df 7e  eb 06 c9 0a 12 b2 b3 09  |..u....~........|
-00000280  2f 59 97 e7 c5 33 e1 24  59 bf 66 a9 51 16 03 03  |/Y...3.$Y.f.Q...|
-00000290  00 88 0f 00 00 84 04 01  00 80 b0 6e dd cd d8 26  |...........n...&|
-000002a0  26 e3 4c e9 1c 30 4e 15  99 fb 79 b0 3d 78 38 76  |&.L..0N...y.=x8v|
-000002b0  fe 42 f5 50 af 38 69 17  83 3b 08 93 13 65 36 59  |.B.P.8i..;...e6Y|
-000002c0  69 55 85 cf 42 dc 04 38  14 a5 f2 6f 64 35 8a 58  |iU..B..8...od5.X|
-000002d0  1a de ea 53 f8 69 f4 d0  08 d7 7a b2 c0 b3 66 b6  |...S.i....z...f.|
-000002e0  ef a1 f0 59 19 72 78 b9  c1 61 77 06 00 b2 43 51  |...Y.rx..aw...CQ|
-000002f0  ae 97 2c be 29 b8 61 fc  4d 15 fd db 44 4d 16 4c  |..,.).a.M...DM.L|
-00000300  0b bb 2c 2e 1b 66 c1 4c  68 7e 20 21 75 1d c9 56  |..,..f.Lh~ !u..V|
-00000310  d8 88 01 79 bd 64 d8 2e  6f 24 14 03 03 00 01 01  |...y.d..o$......|
-00000320  16 03 03 00 40 74 6a 8d  2f bc 4c 1f cf cc c0 db  |....@tj./.L.....|
-00000330  a8 e6 bf d4 6b 42 00 b2  f3 97 fb db 5a 62 01 47  |....kB......Zb.G|
-00000340  49 83 04 7f ac 1c 2f 97  36 86 04 d0 14 55 9f ba  |I...../.6....U..|
-00000350  8d b5 af df 31 8b 05 ae  b5 42 93 fc 4f 0f 47 78  |....1....B..O.Gx|
-00000360  69 1e 7b b1 85                                    |i.{..|
+00000200  e5 35 16 03 03 00 86 10  00 00 82 00 80 07 40 a1  |.5............@.|
+00000210  a4 df e2 86 a1 2b 63 f9  2b 60 e2 ee 53 2c 31 19  |.....+c.+`..S,1.|
+00000220  30 f6 ca 42 4d 16 c8 f6  7a 93 7c c9 49 b5 46 f5  |0..BM...z.|.I.F.|
+00000230  f8 fc 24 91 83 06 51 b4  96 a3 c4 29 a0 3c c4 64  |..$...Q....).<.d|
+00000240  a9 e3 28 79 88 0a b2 98  26 c7 e3 bf 36 74 cd b7  |..(y....&...6t..|
+00000250  b6 90 6c 6b 52 41 1d 0b  34 3f 28 24 fd 0a fd 53  |..lkRA..4?($...S|
+00000260  e1 ba f8 54 0f a0 01 d1  41 4b ab 2e c6 8a 6e d7  |...T....AK....n.|
+00000270  6b b5 f8 e0 8b 24 b9 d2  ce 67 58 77 95 ad c9 84  |k....$...gXw....|
+00000280  7f a3 6f bc 3c 25 aa 5d  ae b0 d8 9e ac 16 03 03  |..o.<%.]........|
+00000290  00 88 0f 00 00 84 04 01  00 80 54 6c d7 6f 08 34  |..........Tl.o.4|
+000002a0  30 5d 62 1c d2 47 c2 03  1d f3 74 36 f0 41 be 1c  |0]b..G....t6.A..|
+000002b0  b6 d6 e2 69 52 4d 05 19  1e 29 03 fa 84 69 c6 f0  |...iRM...)...i..|
+000002c0  83 2c e1 05 8f 6c 3b 6d  85 a2 5b 17 d1 65 5a 5d  |.,...l;m..[..eZ]|
+000002d0  7a 17 d1 4d b5 10 f7 a5  6d a6 22 5e 34 5c c9 eb  |z..M....m."^4\..|
+000002e0  fc 6e 82 7b fb bc aa 13  56 3e 42 d5 ea 81 25 a8  |.n.{....V>B...%.|
+000002f0  5e 1d cc f8 b3 db 88 68  1b 9d f2 b1 e8 31 07 b4  |^......h.....1..|
+00000300  4e 8f 51 ac a3 7b a8 91  20 30 21 41 c9 b6 db 91  |N.Q..{.. 0!A....|
+00000310  6c 55 e5 95 1a 59 14 82  0f 79 14 03 03 00 01 01  |lU...Y...y......|
+00000320  16 03 03 00 40 5d 23 b8  61 24 07 ff 4c 52 c5 41  |....@]#.a$..LR.A|
+00000330  f2 5c 67 c1 bc 98 82 15  d2 f0 9c fb c8 bc ad df  |.\g.............|
+00000340  20 c0 3f dd 14 68 ec b9  e3 b4 1b 75 8b 90 90 75  | .?..h.....u...u|
+00000350  e6 46 5b 53 76 d4 53 98  d2 e5 13 fa a8 74 18 74  |.F[Sv.S......t.t|
+00000360  ef dd a5 02 2d                                    |....-|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 1d 68 a8 dc aa  |............h...|
-00000020  c4 e4 11 4a 2b 96 20 bf  e8 53 ec 78 1d e6 b8 62  |...J+. ..S.x...b|
-00000030  c0 3e 87 3b 1a 1c 21 55  76 99 33 83 8b d1 d1 dd  |.>.;..!Uv.3.....|
-00000040  3b 4e 11 5b 32 18 4c 08  1d 0a 75 17 03 03 00 40  |;N.[2.L...u....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 8b ed 4b 14 13  |.............K..|
+00000020  c8 be 9e d4 63 ab 7e 4e  b5 61 43 a2 aa 64 a4 00  |....c.~N.aC..d..|
+00000030  b7 85 b5 67 c5 0c 85 09  c3 d5 b9 2e 70 60 59 d1  |...g........p`Y.|
+00000040  32 68 55 6a 4f 19 e8 5d  c0 06 c5 17 03 03 00 40  |2hUjO..].......@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  13 bc 72 77 fa 97 52 ce  b3 0a 0d fb 2d 2e a0 81  |..rw..R.....-...|
-00000070  12 3b 9d 9d c3 ad bd 6e  ab d9 17 ec d5 e8 f4 76  |.;.....n.......v|
-00000080  94 5c 96 a3 1a 78 0c 0a  de cd fb 35 f6 95 90 4a  |.\...x.....5...J|
+00000060  cd ae 88 cd bb 85 80 23  ac ca d5 3e 67 f7 c1 2d  |.......#...>g..-|
+00000070  0c 08 3f c6 b4 32 c8 ac  ce e8 04 4f 80 41 30 bc  |..?..2.....O.A0.|
+00000080  c2 58 7a 7e 20 e3 4a 63  96 23 70 3e 83 b2 ec 90  |.Xz~ .Jc.#p>....|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 61 34 c5  62 46 75 7d a3 af ba f0  |.....a4.bFu}....|
-000000b0  e8 f5 9c 79 a7 4c f4 b6  d0 63 56 29 92 c5 26 1f  |...y.L...cV)..&.|
-000000c0  54 85 e4 74 80                                    |T..t.|
+000000a0  00 00 00 00 00 9f 18 6b  e8 4b 70 8c e6 f7 d4 bc  |.......k.Kp.....|
+000000b0  3e 65 77 94 7a 51 a0 fb  81 e1 58 94 2f 9a cf 72  |>ew.zQ....X./..r|
+000000c0  1c 22 93 c1 af                                    |."...|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedNotGiven b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedNotGiven
index 1308ad69c1..b89a57577e 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedNotGiven
+++ b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedNotGiven
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 5d 01 00 00  59 03 03 36 f8 aa 81 3e  |....]...Y..6...>|
-00000010  79 7c 8a 8a 5c 87 73 70  c6 2b dd fc bc 8d ab e8  |y|..\.sp.+......|
-00000020  ec 85 c1 69 d0 9a a5 4e  29 96 a0 00 00 04 00 2f  |...i...N)....../|
+00000000  16 03 01 00 5d 01 00 00  59 03 03 e9 74 a4 35 e3  |....]...Y...t.5.|
+00000010  a6 49 5f b8 ec 02 22 c1  4f de d9 a7 f9 da c4 50  |.I_...".O......P|
+00000020  00 c6 9b 77 ab 06 6d 15  2b f0 dd 00 00 04 00 2f  |...w..m.+....../|
 00000030  00 ff 01 00 00 2c 00 0d  00 20 00 1e 06 01 06 02  |.....,... ......|
 00000040  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
 00000050  03 02 03 03 02 01 02 02  02 03 00 16 00 00 00 17  |................|
@@ -53,31 +53,31 @@
 000002b0  16 03 03 00 04 0e 00 00  00                       |.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 07 0b 00 00  03 00 00 00 16 03 03 00  |................|
-00000010  86 10 00 00 82 00 80 3e  56 5e ef 42 78 3b 12 a5  |.......>V^.Bx;..|
-00000020  4a 53 1c 72 c8 d4 91 3a  45 42 e9 f2 50 55 ec 9b  |JS.r...:EB..PU..|
-00000030  6c 2e 87 57 95 e5 fd 1d  9f 19 99 a4 16 30 ea fe  |l..W.........0..|
-00000040  97 b4 ac 58 14 b0 2c fa  f0 5c b4 58 c6 c3 5e 37  |...X..,..\.X..^7|
-00000050  da 13 e9 8b 1b 3e 4c 4e  c3 a6 60 f9 17 4e 7f 67  |.....>LN..`..N.g|
-00000060  4c db 4d 50 36 aa dc 86  48 ab be 10 06 03 4f ef  |L.MP6...H.....O.|
-00000070  a0 58 3a 37 67 ba 50 a8  35 19 69 27 1f c1 a7 ac  |.X:7g.P.5.i'....|
-00000080  d7 8c fa 0e 6c 21 c8 be  5e 03 34 2e 3e 91 6d dd  |....l!..^.4.>.m.|
-00000090  ba ca e9 7a c0 1a 18 14  03 03 00 01 01 16 03 03  |...z............|
-000000a0  00 40 27 ed e0 28 80 fe  a9 75 21 33 09 40 20 80  |.@'..(...u!3.@ .|
-000000b0  93 f3 41 5c 3b ac 82 73  61 fd 32 30 c3 3f 0b 81  |..A\;..sa.20.?..|
-000000c0  24 49 32 95 c2 54 5d eb  3a a5 c1 ea f2 0f 83 a7  |$I2..T].:.......|
-000000d0  54 48 6e bd 1f 84 e8 a9  34 e1 c5 55 db 5b 1c e2  |THn.....4..U.[..|
-000000e0  85 02                                             |..|
+00000010  86 10 00 00 82 00 80 53  39 b1 0b b6 ea 9a 09 ca  |.......S9.......|
+00000020  9d a9 f8 c3 4a 3b 1c a1  6a ee 75 30 ce df ce 5f  |....J;..j.u0..._|
+00000030  ba 1c c6 12 c6 8d 43 5a  b1 e5 50 20 53 a3 cd db  |......CZ..P S...|
+00000040  8b d9 76 89 8f d5 62 5f  97 d6 27 26 bb f1 b8 db  |..v...b_..'&....|
+00000050  1b a0 6b 9d 2c 2c 47 d5  8e f5 1c db 7c 87 c9 0c  |..k.,,G.....|...|
+00000060  7e 15 de 73 98 93 f8 73  00 1b 0e 15 7a 0a 50 66  |~..s...s....z.Pf|
+00000070  d9 8d f9 47 19 a6 3b 7e  d9 2f 03 09 c8 c2 30 e2  |...G..;~./....0.|
+00000080  61 66 55 0b 4e 99 65 3b  ab 68 90 9c d8 7b 80 0f  |afU.N.e;.h...{..|
+00000090  24 02 f2 c6 8a 3e 90 14  03 03 00 01 01 16 03 03  |$....>..........|
+000000a0  00 40 2b a7 23 ee f4 6f  46 81 ac a2 01 8b 0f 8e  |.@+.#..oF.......|
+000000b0  5c 96 2c 9e 49 89 17 96  43 18 dc 01 f3 cd e7 d9  |\.,.I...C.......|
+000000c0  81 b4 77 b3 85 a8 ba 4d  20 e5 bd 0e 51 1e 2a 53  |..w....M ...Q.*S|
+000000d0  ea 11 61 61 52 3d 81 c8  dd e9 7c bb 4b 17 72 a2  |..aaR=....|.K.r.|
+000000e0  1b a0                                             |..|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 2a c4 ad 60 17  |...........*..`.|
-00000020  f4 8a 21 78 04 83 ea 17  df 32 7d 92 46 1a 99 b2  |..!x.....2}.F...|
-00000030  4e 21 6b da 9c e2 24 71  a4 fc 9f a4 c1 b0 45 43  |N!k...$q......EC|
-00000040  71 05 14 49 8e 8c 45 15  24 ed b0 17 03 03 00 40  |q..I..E.$......@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 64 dc 26 49 ef  |...........d.&I.|
+00000020  f1 2e cc aa e4 3c 6b 23  48 f5 88 20 b3 8b 68 c5  |.....<k#H.. ..h.|
+00000030  95 6d 5a 35 36 05 88 c3  db 6a 04 92 27 c1 92 7d  |.mZ56....j..'..}|
+00000040  99 99 ff 88 90 a0 78 f2  7d 2b e9 17 03 03 00 40  |......x.}+.....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  43 89 2a ac ba 92 98 96  c1 bf 06 bd 04 27 36 1b  |C.*..........'6.|
-00000070  28 8b de eb c2 4c 5f 17  f4 88 7c 56 9f b0 a8 c9  |(....L_...|V....|
-00000080  22 f4 91 f8 cf 78 e6 c4  ba 2b 08 73 ee bb c4 96  |"....x...+.s....|
+00000060  1b 00 0d bd 13 a5 fb d0  52 55 c5 45 ea 3c e2 1e  |........RU.E.<..|
+00000070  9c 15 89 12 27 a1 da 13  3d 3f 8c 97 ae 62 90 cf  |....'...=?...b..|
+00000080  60 e9 5b d9 11 38 26 9d  15 7d f8 d8 20 ec a0 0b  |`.[..8&..}.. ...|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 07 aa 18  1d 67 a4 0b b3 d0 2b 38  |.........g....+8|
-000000b0  a8 57 da 98 f7 66 59 a8  6a fa c8 c9 03 91 c3 f5  |.W...fY.j.......|
-000000c0  57 e2 8f e1 45                                    |W...E|
+000000a0  00 00 00 00 00 c8 e0 56  c2 b5 ed fb 73 88 d0 3c  |.......V....s..<|
+000000b0  1e 5c 36 00 74 86 0d e7  ea be fc 3d d0 51 bb 05  |.\6.t......=.Q..|
+000000c0  a5 b2 05 86 11                                    |.....|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Server-TLSv12-ECDHE-ECDSA-AES
index 7d06a5e5e3..fd2961800f 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Server-TLSv12-ECDHE-ECDSA-AES
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 73 01 00 00  6f 03 03 3a 87 41 97 6b  |....s...o..:.A.k|
-00000010  86 2e 9d 9c 1d d1 b7 19  a6 98 2f 1a e0 e1 7a 2f  |........../...z/|
-00000020  92 42 4a 5f fd 5c 59 d6  58 6b 6a 00 00 04 c0 0a  |.BJ_.\Y.Xkj.....|
+00000000  16 03 01 00 73 01 00 00  6f 03 03 10 0f a5 0c d4  |....s...o.......|
+00000010  33 47 41 2c 03 89 9d 67  48 36 c2 b0 16 9f fc eb  |3GA,...gH6......|
+00000020  1d e8 98 ee 77 7f c6 f3  65 ee ff 00 00 04 c0 0a  |....w...e.......|
 00000030  00 ff 01 00 00 42 00 0b  00 04 03 00 01 02 00 0a  |.....B..........|
 00000040  00 0a 00 08 00 1d 00 17  00 19 00 18 00 0d 00 20  |............... |
 00000050  00 1e 06 01 06 02 06 03  05 01 05 02 05 03 04 01  |................|
@@ -44,43 +44,39 @@
 00000210  0e bd 3f a3 8c 25 c1 33  13 83 0d 94 06 bb d4 37  |..?..%.3.......7|
 00000220  7a f6 ec 7a c9 86 2e dd  d7 11 69 7f 85 7c 56 de  |z..z......i..|V.|
 00000230  fb 31 78 2b e4 c7 78 0d  ae cb be 9e 4e 36 24 31  |.1x+..x.....N6$1|
-00000240  7b 6a 0f 39 95 12 07 8f  2a 16 03 03 00 d8 0c 00  |{j.9....*.......|
-00000250  00 d4 03 00 17 41 04 1e  18 37 ef 0d 19 51 88 35  |.....A...7...Q.5|
-00000260  75 71 b5 e5 54 5b 12 2e  8f 09 67 fd a7 24 20 3e  |uq..T[....g..$ >|
-00000270  b2 56 1c ce 97 28 5e f8  2b 2d 4f 9e f1 07 9f 6c  |.V...(^.+-O....l|
-00000280  4b 5b 83 56 e2 32 42 e9  58 b6 d7 49 a6 b5 68 1a  |K[.V.2B.X..I..h.|
-00000290  41 03 56 6b dc 5a 89 05  03 00 8b 30 81 88 02 42  |A.Vk.Z.....0...B|
-000002a0  00 ba df e4 f7 1e 3c 94  da d9 68 d8 aa 42 36 13  |......<...h..B6.|
-000002b0  c4 ff 16 a5 6a 95 ff f8  cf 78 e5 5d 82 9c 2a 5b  |....j....x.]..*[|
-000002c0  21 1c 20 0b 08 8f e2 bb  fa a4 a3 3a 99 3f ff 5d  |!. ........:.?.]|
-000002d0  4f 28 b4 a7 0a 2b eb 18  e7 f7 01 83 40 75 d4 2c  |O(...+......@u.,|
-000002e0  aa 5e 02 42 01 12 a3 ea  97 d9 2e f9 69 42 d2 5a  |.^.B........iB.Z|
-000002f0  83 aa fb 89 a0 a8 d3 3e  34 0b 65 1d 16 b3 dc fb  |.......>4.e.....|
-00000300  fa 1e 09 0d 8c 92 02 c1  07 55 49 0f 11 4b bc 97  |.........UI..K..|
-00000310  f9 c6 ff f3 7f 7c ec 51  f9 9a 25 e1 e7 f3 93 56  |.....|.Q..%....V|
-00000320  b6 c9 59 f5 a8 02 16 03  03 00 04 0e 00 00 00     |..Y............|
+00000240  7b 6a 0f 39 95 12 07 8f  2a 16 03 03 00 b7 0c 00  |{j.9....*.......|
+00000250  00 b3 03 00 1d 20 2f e5  7d a3 47 cd 62 43 15 28  |..... /.}.G.bC.(|
+00000260  da ac 5f bb 29 07 30 ff  f6 84 af c4 cf c2 ed 90  |.._.).0.........|
+00000270  99 5f 58 cb 3b 74 05 03  00 8b 30 81 88 02 42 01  |._X.;t....0...B.|
+00000280  75 a2 d9 c3 52 e6 73 3c  a4 28 1d 89 7f a3 e0 96  |u...R.s<.(......|
+00000290  b8 19 da 01 b4 3a c3 ac  13 38 58 00 00 e0 a3 13  |.....:...8X.....|
+000002a0  10 b2 d9 20 01 45 25 00  1c be ee c4 71 72 e2 b7  |... .E%.....qr..|
+000002b0  ed 00 c6 9f 59 d7 ad 4f  7b ea 15 94 93 a2 fa 16  |....Y..O{.......|
+000002c0  a2 02 42 01 c5 09 c2 bc  8a 86 9c 20 12 5e 8a 91  |..B........ .^..|
+000002d0  d6 58 45 8a 06 37 e1 99  5a 34 65 9e 59 94 a7 50  |.XE..7..Z4e.Y..P|
+000002e0  2f 38 8c 02 54 1b 29 3c  94 f3 62 4e 17 cc 8c bf  |/8..T.)<..bN....|
+000002f0  d8 dc 22 b0 a1 83 dc 5a  5d a3 16 08 83 cd ad 77  |.."....Z]......w|
+00000300  1c 4f 49 ff f2 16 03 03  00 04 0e 00 00 00        |.OI...........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 9d 5a 16 50 2d  |....F...BA..Z.P-|
-00000010  3e 2f 94 f9 c5 cb 3b ee  56 44 0b 06 ae ea b2 ff  |>/....;.VD......|
-00000020  ec cf 1d 9b 03 b3 d8 82  f5 9f 62 6f 13 2e 44 f0  |..........bo..D.|
-00000030  13 b4 e3 33 50 f0 07 40  04 66 68 47 eb be af 77  |...3P..@.fhG...w|
-00000040  8e 34 c9 29 f2 96 76 61  2c 08 e4 14 03 03 00 01  |.4.)..va,.......|
-00000050  01 16 03 03 00 40 2f c7  d4 8e a4 0d 38 ed 11 1f  |.....@/.....8...|
-00000060  5d 98 6b 84 a4 7e c5 c3  e4 5c 79 63 15 b1 c4 ff  |].k..~...\yc....|
-00000070  08 a7 c7 04 db d3 3f 89  ea bb 6c 9c 0f e7 9b dd  |......?...l.....|
-00000080  f5 15 e3 37 3c 8c 4d ec  62 7d 73 2c 2b 89 a3 68  |...7<.M.b}s,+..h|
-00000090  23 7a 6a 11 a9 87                                 |#zj...|
+00000000  16 03 03 00 25 10 00 00  21 20 11 07 b7 a1 ff d3  |....%...! ......|
+00000010  7c 94 4a 05 18 29 55 84  b1 c6 e0 f4 c7 9c 65 54  ||.J..)U.......eT|
+00000020  88 30 20 ac 42 b8 df 42  87 54 14 03 03 00 01 01  |.0 .B..B.T......|
+00000030  16 03 03 00 40 80 ed 21  31 50 41 aa 8d 54 33 4e  |....@..!1PA..T3N|
+00000040  3f 6b de 0e aa 9d a3 d5  76 1f ec 61 f3 58 e6 17  |?k......v..a.X..|
+00000050  fd 57 ba 66 9e e0 ca 3b  e6 a2 0b 56 15 f8 5d 79  |.W.f...;...V..]y|
+00000060  9a d2 bf 71 49 15 07 67  eb b9 bc 48 2e 57 71 fb  |...qI..g...H.Wq.|
+00000070  9f f3 9e 45 15                                    |...E.|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 71 1f 17 b1 37  |...........q...7|
-00000020  bc 77 6a 77 04 9f 5f f1  50 72 a3 c6 72 b4 85 05  |.wjw.._.Pr..r...|
-00000030  4e 15 8e 80 5c 14 ad 64  b8 bd 4f ee e8 bd 26 ff  |N...\..d..O...&.|
-00000040  d8 13 49 c7 e6 4c 52 da  4f 84 e1 17 03 03 00 40  |..I..LR.O......@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 58 53 cf 30 2c  |...........XS.0,|
+00000020  81 b6 7f 48 49 0f 6d ae  48 db c0 6c 7e c8 63 c8  |...HI.m.H..l~.c.|
+00000030  1e 2d 6e f2 73 56 b2 74  6c 2f 44 e3 db 18 cb f4  |.-n.sV.tl/D.....|
+00000040  e8 ba 0a 33 15 f9 32 94  ec f2 61 17 03 03 00 40  |...3..2...a....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  6a d3 f5 95 70 8f b0 c1  08 ad dc da 7f ed c5 d3  |j...p...........|
-00000070  f0 fb 48 fd 9f 3c 30 c8  67 38 3a 7e bc ea 3b 13  |..H..<0.g8:~..;.|
-00000080  d9 bc a8 96 1c 2c 55 76  d6 df 04 bf e0 e8 0b dc  |.....,Uv........|
+00000060  ed 19 a6 04 9c 4d 32 7e  0e 89 10 6f 3d ab 37 5d  |.....M2~...o=.7]|
+00000070  2f fc 26 fe e8 a0 e9 3a  4e 38 e4 75 82 2c 5c ea  |/.&....:N8.u.,\.|
+00000080  ae b3 a4 93 5b 52 af 68  2c 86 26 d3 2a b2 6f 88  |....[R.h,.&.*.o.|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 90 29 fa  1c 7e f7 5a 1b 21 bf df  |......)..~.Z.!..|
-000000b0  dd d3 0e 12 b1 19 bb 17  35 f7 6a 0f 7a 08 91 4a  |........5.j.z..J|
-000000c0  2a 1e 46 68 da                                    |*.Fh.|
+000000a0  00 00 00 00 00 59 eb 95  fa 51 b5 26 7a cd 88 ba  |.....Y...Q.&z...|
+000000b0  36 8e a2 49 08 80 6e f6  3f cd aa a0 97 c0 de 2e  |6..I..n.?.......|
+000000c0  ae 66 55 48 25                                    |.fUH%|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-IssueTicket b/src/crypto/tls/testdata/Server-TLSv12-IssueTicket
index 7000807563..ecd538f40f 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-IssueTicket
+++ b/src/crypto/tls/testdata/Server-TLSv12-IssueTicket
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 61 01 00 00  5d 03 03 7f 9d 96 78 84  |....a...].....x.|
-00000010  4f a7 cd c1 26 60 84 3f  d6 e6 06 ca 01 12 69 07  |O...&`.?......i.|
-00000020  cc cf 91 61 9a 7e 4c c7  e5 73 29 00 00 04 00 2f  |...a.~L..s)..../|
+00000000  16 03 01 00 61 01 00 00  5d 03 03 23 70 bb 15 df  |....a...]..#p...|
+00000010  ba a2 24 4c 6a 3f 34 0c  75 40 a6 ee 11 1c 7e 74  |..$Lj?4.u@....~t|
+00000020  7e 7f 01 51 97 c3 de 3e  d4 e0 c1 00 00 04 00 2f  |~..Q...>......./|
 00000030  00 ff 01 00 00 30 00 23  00 00 00 0d 00 20 00 1e  |.....0.#..... ..|
 00000040  06 01 06 02 06 03 05 01  05 02 05 03 04 01 04 02  |................|
 00000050  04 03 03 01 03 02 03 03  02 01 02 02 02 03 00 16  |................|
@@ -51,39 +51,39 @@
 00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 04 0e 00 00  |.\!.;...........|
 000002a0  00                                                |.|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 48 95 70 68 ee  |...........H.ph.|
-00000010  93 9a 44 8c c7 53 48 06  13 2f fc f7 5f a2 84 53  |..D..SH../.._..S|
-00000020  0e 60 15 c2 2a d1 75 99  77 89 74 70 9b e9 96 95  |.`..*.u.w.tp....|
-00000030  82 0e 02 49 e6 f5 2e 79  b6 a9 42 63 89 de d6 f9  |...I...y..Bc....|
-00000040  77 d2 ed d2 8b ac 45 d3  10 14 92 4b 20 06 b8 7e  |w.....E....K ..~|
-00000050  91 9c 3b 71 25 75 d6 44  75 7b 2e 07 a0 d2 06 56  |..;q%u.Du{.....V|
-00000060  6f 39 c0 1e d6 3c b2 4b  ce 5d 51 ee 9a 1a 72 bd  |o9...<.K.]Q...r.|
-00000070  cf ba f3 db 09 92 7a cd  35 ec e9 5c 80 ab d3 b8  |......z.5..\....|
-00000080  13 51 75 a7 3a 5e 95 10  31 4c 4a 14 03 03 00 01  |.Qu.:^..1LJ.....|
-00000090  01 16 03 03 00 40 6a 2b  e6 c9 1a 30 dc 68 66 55  |.....@j+...0.hfU|
-000000a0  61 5e 78 15 5c 3f 1c c2  57 ae 98 62 2f fc 27 64  |a^x.\?..W..b/.'d|
-000000b0  fa a9 10 f7 6d 66 44 4b  50 89 b5 5f a6 7f 96 9b  |....mfDKP.._....|
-000000c0  07 8f ed f9 cf ea 27 c8  7f 1d 08 c9 68 17 0e 05  |......'.....h...|
-000000d0  73 90 0b 86 6d 9a                                 |s...m.|
+00000000  16 03 03 00 86 10 00 00  82 00 80 ce 22 39 8f e2  |............"9..|
+00000010  00 3a 42 d3 2c 0f 60 59  3d 7c 51 02 88 ae dd 49  |.:B.,.`Y=|Q....I|
+00000020  b2 c3 6b c4 9a 1d 97 b1  07 bc 84 70 32 95 6d 8a  |..k........p2.m.|
+00000030  2f 01 48 29 96 d1 a4 c9  e9 12 9e 31 11 d5 22 21  |/.H).......1.."!|
+00000040  86 b6 8d a1 7e 8f ad be  9e a9 7f 64 f6 b4 07 be  |....~......d....|
+00000050  f3 a0 34 af 7f 9f 73 70  16 24 2f ae f2 8a bb 51  |..4...sp.$/....Q|
+00000060  34 4a ed 1e 53 32 cb b3  b8 84 b1 0e 79 c1 5b 9e  |4J..S2......y.[.|
+00000070  6c 61 08 6f 9b dd a5 c7  b1 fb 8f ce e2 37 79 39  |la.o.........7y9|
+00000080  1c 6a 57 60 91 89 53 25  b5 9b 41 14 03 03 00 01  |.jW`..S%..A.....|
+00000090  01 16 03 03 00 40 b0 f3  19 1f 2b 96 7f 05 72 a9  |.....@....+...r.|
+000000a0  21 48 d8 77 7f d3 e0 39  e6 58 8f 8d 06 b1 bd 9e  |!H.w...9.X......|
+000000b0  53 6a cd 5b 52 a8 2f a5  7c fb 6a b4 88 f7 b2 c4  |Sj.[R./.|.j.....|
+000000c0  a7 a8 69 fe a9 ae 07 4e  4f 11 6d 51 55 0c 10 7c  |..i....NO.mQU..||
+000000d0  9c 31 a7 45 3c 0f                                 |.1.E<.|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 82 04 00 00  7e 00 00 00 00 00 78 50  |........~.....xP|
 00000010  46 ad c1 db a8 38 86 7b  2b bb fd d0 c3 42 3e 00  |F....8.{+....B>.|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000030  6f 2c 9f 83 61 ba 85 c2  4f 82 f7 76 6c 2f 9d 4c  |o,..a...O..vl/.L|
-00000040  16 0e 46 88 f4 1b 1b 35  62 9c c7 e6 0e 44 a4 62  |..F....5b....D.b|
-00000050  8c 1e 2d 53 f3 8b cd a6  ca dc 12 52 b4 43 a9 d0  |..-S.......R.C..|
-00000060  16 4c 9a f7 a6 33 94 f7  58 26 2b 75 74 62 e3 11  |.L...3..X&+utb..|
-00000070  dc f6 40 b0 ab 32 8b 79  63 d1 7e d8 9f db cf cf  |..@..2.yc.~.....|
-00000080  25 29 ea e9 89 43 39 14  03 03 00 01 01 16 03 03  |%)...C9.........|
+00000030  6f 2c 9f 83 61 f0 a9 9a  d5 65 c7 25 32 9d 86 4e  |o,..a....e.%2..N|
+00000040  fb 8e 2a dd 84 8d 32 6d  6b f0 a9 de 59 fa 15 20  |..*...2mk...Y.. |
+00000050  7a 85 cd 2e 42 e1 f3 44  62 6c 24 24 e7 1f b6 fa  |z...B..Dbl$$....|
+00000060  4d 8a cd 30 83 33 94 65  b6 e2 01 d8 fb a0 37 ca  |M..0.3.e......7.|
+00000070  87 59 a4 29 cf d9 85 7c  54 2f 2d 5d 73 69 9a ae  |.Y.)...|T/-]si..|
+00000080  6f 85 29 8b c3 eb 97 14  03 03 00 01 01 16 03 03  |o.).............|
 00000090  00 40 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |.@..............|
-000000a0  00 00 a7 14 ba 74 9a 16  b9 cf 08 ec c6 6e d2 fd  |.....t.......n..|
-000000b0  39 92 5d b0 2e 38 35 80  7b 94 fb e4 63 e0 01 0b  |9.]..85.{...c...|
-000000c0  40 a9 61 56 cc 31 44 7f  aa c7 91 03 46 55 6a c8  |@.aV.1D.....FUj.|
-000000d0  c0 d0 17 03 03 00 40 00  00 00 00 00 00 00 00 00  |......@.........|
-000000e0  00 00 00 00 00 00 00 e3  eb 91 1a 2d 03 f7 bf 29  |...........-...)|
-000000f0  64 93 36 4e a1 d0 12 86  63 bc 08 ca b1 98 b0 b9  |d.6N....c.......|
-00000100  d1 4d 65 42 92 68 34 db  bd 1b 2b f4 73 8f 84 0c  |.MeB.h4...+.s...|
-00000110  89 aa af b6 48 b5 5d 15  03 03 00 30 00 00 00 00  |....H.]....0....|
-00000120  00 00 00 00 00 00 00 00  00 00 00 00 92 00 e5 db  |................|
-00000130  4d d0 77 51 0d 26 de 48  9b 4f cd 33 9b 33 ca fd  |M.wQ.&.H.O.3.3..|
-00000140  e2 d3 ff 0d 7f db 9e 0f  3e a8 50 94              |........>.P.|
+000000a0  00 00 28 59 a1 a9 c9 27  e0 1d ff c1 18 37 83 6f  |..(Y...'.....7.o|
+000000b0  5d 48 af a3 6b 5e b0 d7  54 46 49 e8 6d be 73 74  |]H..k^..TFI.m.st|
+000000c0  fa a3 80 df 41 ce 6a 43  ee b9 ec a4 cc 24 e8 a9  |....A.jC.....$..|
+000000d0  1f 3a 17 03 03 00 40 00  00 00 00 00 00 00 00 00  |.:....@.........|
+000000e0  00 00 00 00 00 00 00 e8  7d 83 df d2 6e 2b 00 cc  |........}...n+..|
+000000f0  4b fd 3c 20 4e 84 b3 b6  31 e5 47 ab 3f 45 81 f8  |K.< N...1.G.?E..|
+00000100  d3 a9 2f 07 9a 45 5a c5  cb 8a 68 ee d9 20 78 72  |../..EZ...h.. xr|
+00000110  8c a0 be 3d 3b 46 56 15  03 03 00 30 00 00 00 00  |...=;FV....0....|
+00000120  00 00 00 00 00 00 00 00  00 00 00 00 d7 b5 17 2a  |...............*|
+00000130  14 69 7e f7 c7 9a 0c 66  56 19 d1 e3 d4 6b ef 27  |.i~....fV....k.'|
+00000140  d3 a7 ce 96 d8 2a 20 38  8a b5 50 f8              |.....* 8..P.|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable b/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable
index e0bf62551c..0552907c21 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable
+++ b/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 61 01 00 00  5d 03 03 10 94 97 3f c0  |....a...].....?.|
-00000010  47 0f c3 66 65 4e 8b 1b  cc be b4 39 0f 8f d7 52  |G..feN.....9...R|
-00000020  88 e6 60 2c 2f 22 95 5b  08 e2 4a 00 00 04 00 2f  |..`,/".[..J..../|
+00000000  16 03 01 00 61 01 00 00  5d 03 03 f3 a0 a9 e8 90  |....a...].......|
+00000010  a2 0e bd 78 fa c2 ad 27  d4 bd 3e 07 62 de 29 a0  |...x...'..>.b.).|
+00000020  0a c3 ca f0 7a f5 1f fb  e8 8d 37 00 00 04 00 2f  |....z.....7..../|
 00000030  00 ff 01 00 00 30 00 23  00 00 00 0d 00 20 00 1e  |.....0.#..... ..|
 00000040  06 01 06 02 06 03 05 01  05 02 05 03 04 01 04 02  |................|
 00000050  04 03 03 01 03 02 03 03  02 01 02 02 02 03 00 16  |................|
@@ -51,39 +51,39 @@
 00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 04 0e 00 00  |.\!.;...........|
 000002a0  00                                                |.|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 b5 e3 31 fc c3  |.............1..|
-00000010  22 4a 86 6d 04 2c 69 31  36 0f 74 72 58 3e a2 4e  |"J.m.,i16.trX>.N|
-00000020  f4 d0 6f 78 ea d7 92 04  4a 93 e1 50 dd 30 f7 b6  |..ox....J..P.0..|
-00000030  6f 15 de 51 83 07 3b 93  60 ee 43 f2 41 0f 24 e5  |o..Q..;.`.C.A.$.|
-00000040  50 79 62 f8 85 09 86 13  a3 25 3e e4 6c 6b fa 0f  |Pyb......%>.lk..|
-00000050  7d d9 f4 99 49 1d 67 12  77 06 9a 0c e7 bb 7c 82  |}...I.g.w.....|.|
-00000060  2f 74 fb f9 c7 93 89 0b  3e 5a a2 12 0a 91 23 6d  |/t......>Z....#m|
-00000070  7e 51 ee b8 14 c8 b2 d9  19 7b fc 70 5a ba 2e 6e  |~Q.......{.pZ..n|
-00000080  a2 98 64 31 7a af c0 17  52 fd e3 14 03 03 00 01  |..d1z...R.......|
-00000090  01 16 03 03 00 40 ef d5  01 2f c7 2c db 45 cf 6f  |.....@.../.,.E.o|
-000000a0  9e af 3b ec ea 49 7f bf  bf 30 29 6a 0c 36 3e da  |..;..I...0)j.6>.|
-000000b0  9f 94 ef d2 85 41 9d b1  9f 69 9b 1a 24 be e6 d1  |.....A...i..$...|
-000000c0  c6 56 0e c9 89 6c 51 5d  9a 5c c7 ec e9 eb 84 c5  |.V...lQ].\......|
-000000d0  fd ab 12 5e 47 f5                                 |...^G.|
+00000000  16 03 03 00 86 10 00 00  82 00 80 57 a4 71 b3 2a  |...........W.q.*|
+00000010  1a 97 ab 54 0f 92 de 70  97 6d fa e4 ac 5f eb 29  |...T...p.m..._.)|
+00000020  7a 4d 22 16 c1 29 a5 d0  13 dd 05 87 e9 b2 21 4d  |zM"..)........!M|
+00000030  50 6d d9 39 ba ff 7d 41  a7 6b 80 dd af 6d 6f 9f  |Pm.9..}A.k...mo.|
+00000040  cf a9 e7 4f 64 ab 9b 5a  44 39 ce 8d 6e a4 0b 42  |...Od..ZD9..n..B|
+00000050  61 15 28 7d 0b 53 a6 8e  15 0c e6 1c 13 09 fb 5d  |a.(}.S.........]|
+00000060  cb 62 31 d3 ca 8d e4 74  6e 47 90 8a 76 60 7a 24  |.b1....tnG..v`z$|
+00000070  28 d2 1f 74 b4 cf 18 05  44 7a 87 28 76 c0 57 5a  |(..t....Dz.(v.WZ|
+00000080  94 3f d5 af e8 86 ce 45  7a ea 22 14 03 03 00 01  |.?.....Ez.".....|
+00000090  01 16 03 03 00 40 33 1e  6b 67 3d 57 5c 82 39 58  |.....@3.kg=W\.9X|
+000000a0  d0 e9 54 cb 41 03 0c 4d  db d0 a7 af a0 fd 56 a7  |..T.A..M......V.|
+000000b0  d0 88 27 e5 39 81 a8 ae  b3 9b 0e 08 54 16 0a 1b  |..'.9.......T...|
+000000c0  8e d5 52 80 4d 07 96 1a  64 d1 ac 93 71 43 5b 88  |..R.M...d...qC[.|
+000000d0  95 cc 32 ee fc b4                                 |..2...|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 82 04 00 00  7e 00 00 00 00 00 78 50  |........~.....xP|
 00000010  46 ad c1 db a8 38 86 7b  2b bb fd d0 c3 42 3e 00  |F....8.{+....B>.|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000030  6f 2c 9f 83 61 67 87 d5  79 1d 56 b8 ca 6d e2 b0  |o,..ag..y.V..m..|
-00000040  2e a7 2e c9 d7 b3 5a de  91 3b 6f 30 a7 14 af d1  |......Z..;o0....|
-00000050  b4 af 5b 9e a0 65 e6 fe  cd d3 77 f3 88 c6 cf 52  |..[..e....w....R|
-00000060  74 28 4b a2 14 33 94 9a  e0 60 f2 0b df c5 58 4b  |t(K..3...`....XK|
-00000070  56 46 52 6a 3a 83 15 89  c6 a9 31 83 83 ef 29 2a  |VFRj:.....1...)*|
-00000080  9f c6 5f ba 8d 91 de 14  03 03 00 01 01 16 03 03  |.._.............|
+00000030  6f 2c 9f 83 61 60 24 85  1b 46 9d 93 96 8f 27 6f  |o,..a`$..F....'o|
+00000040  bf 17 0e 2d 0d f1 3c 3d  ce 85 b5 9c 8f 3a 6a c8  |...-..<=.....:j.|
+00000050  b4 e2 a1 03 c9 9c 34 72  d5 7e 60 d3 f3 f6 20 d6  |......4r.~`... .|
+00000060  0f 1b b9 18 0c 33 94 71  92 ec 74 0e eb a0 f7 ec  |.....3.q..t.....|
+00000070  81 b3 d2 63 90 b8 0f d9  9e d2 12 aa b5 78 06 7f  |...c.........x..|
+00000080  1b d3 33 fc d0 9c 73 14  03 03 00 01 01 16 03 03  |..3...s.........|
 00000090  00 40 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |.@..............|
-000000a0  00 00 86 9a 2e f8 cb 67  ef 2b 40 e7 4c 80 b7 ae  |.......g.+@.L...|
-000000b0  da 1c 94 94 48 ec 21 80  b5 04 de fe a5 ee e0 a5  |....H.!.........|
-000000c0  54 71 54 60 9a c8 01 56  16 43 27 49 a0 01 7a e0  |TqT`...V.C'I..z.|
-000000d0  d5 af 17 03 03 00 40 00  00 00 00 00 00 00 00 00  |......@.........|
-000000e0  00 00 00 00 00 00 00 71  88 56 13 c2 a6 d6 5b 95  |.......q.V....[.|
-000000f0  31 c6 39 30 47 f8 cf 03  07 51 4d 25 4f 7c f2 e2  |1.90G....QM%O|..|
-00000100  d5 94 02 8b 23 05 93 8c  23 ab 11 ca d8 30 27 37  |....#...#....0'7|
-00000110  0e 66 57 9c aa 01 d9 15  03 03 00 30 00 00 00 00  |.fW........0....|
-00000120  00 00 00 00 00 00 00 00  00 00 00 00 8d a5 38 52  |..............8R|
-00000130  5b 93 4a 59 72 8d ee d4  dd 9c e7 a1 5d 88 aa a0  |[.JYr.......]...|
-00000140  d0 35 ff 31 50 c7 4b ee  96 51 26 35              |.5.1P.K..Q&5|
+000000a0  00 00 0e 56 25 a5 d8 15  57 44 da da f4 9f 40 c9  |...V%...WD....@.|
+000000b0  e2 a4 73 7c 3c 14 61 b7  aa 25 cb a1 4a d8 da b3  |..s|<.a..%..J...|
+000000c0  07 68 d0 8b 01 30 51 ad  f9 eb f6 0f a3 8c 59 97  |.h...0Q.......Y.|
+000000d0  33 81 17 03 03 00 40 00  00 00 00 00 00 00 00 00  |3.....@.........|
+000000e0  00 00 00 00 00 00 00 86  da 95 d0 e5 86 ff 3c e2  |..............<.|
+000000f0  26 90 2b 55 28 1c 9f 4f  77 f8 dc e9 f7 90 a6 5d  |&.+U(..Ow......]|
+00000100  e3 12 b2 16 36 bc d0 6e  cc 96 99 06 56 81 d3 77  |....6..n....V..w|
+00000110  26 6d ce 48 74 87 61 15  03 03 00 30 00 00 00 00  |&m.Ht.a....0....|
+00000120  00 00 00 00 00 00 00 00  00 00 00 00 fb 58 84 41  |.............X.A|
+00000130  a0 c3 57 82 4b a2 bd 70  6f 63 a0 5e c9 6b 02 ea  |..W.K..poc.^.k..|
+00000140  ce 64 b9 09 d3 50 d6 d6  df 2c 9a 4b              |.d...P...,.K|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-3DES b/src/crypto/tls/testdata/Server-TLSv12-RSA-3DES
index 254628b304..e84a02230f 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-3DES
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-3DES
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 5d 01 00 00  59 03 03 18 ce 7a 5d c3  |....]...Y....z].|
-00000010  89 32 dc b4 3e 0c f7 7c  32 8f 30 05 a4 2d c2 97  |.2..>..|2.0..-..|
-00000020  ca d2 97 3b af 9b 1f 66  5e 13 67 00 00 04 00 0a  |...;...f^.g.....|
+00000000  16 03 01 00 5d 01 00 00  59 03 03 00 30 28 24 eb  |....]...Y...0($.|
+00000010  07 45 88 ea 2f a1 74 48  c0 02 60 0d 4f 1e e5 6f  |.E../.tH..`.O..o|
+00000020  05 1e 71 cc 95 19 f4 b7  00 7e cc 00 00 04 00 0a  |..q......~......|
 00000030  00 ff 01 00 00 2c 00 0d  00 20 00 1e 06 01 06 02  |.....,... ......|
 00000040  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
 00000050  03 02 03 03 02 01 02 02  02 03 00 16 00 00 00 17  |................|
@@ -50,27 +50,27 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 1b e1 54 3c 9d  |.............T<.|
-00000010  39 01 71 91 ff fc 49 57  2f a9 56 88 69 59 da 18  |9.q...IW/.V.iY..|
-00000020  1a d7 7e 2c 61 cd b3 b6  69 db 15 2b be 67 1d d4  |..~,a...i..+.g..|
-00000030  a4 07 78 f4 83 76 5b 70  f8 f1 ca bb 90 bf a1 b5  |..x..v[p........|
-00000040  f7 03 28 d3 27 e2 70 e6  8d 31 f4 81 90 04 da 3b  |..(.'.p..1.....;|
-00000050  1a 61 be 1d fb 58 40 66  ed 74 ab 3e d8 67 37 e9  |.a...X@f.t.>.g7.|
-00000060  e5 88 ba 8f 8a 48 a4 28  78 80 32 5a 1e d0 6e ad  |.....H.(x.2Z..n.|
-00000070  09 cb d0 6e cd c4 0f d1  6e 02 0f 1e 25 44 dc d7  |...n....n...%D..|
-00000080  d9 5f 9b 60 05 f4 7d e1  23 f6 5c 14 03 03 00 01  |._.`..}.#.\.....|
-00000090  01 16 03 03 00 30 97 db  a5 d7 55 8b e0 37 e1 46  |.....0....U..7.F|
-000000a0  b5 18 c6 c8 5b 9b 43 43  65 8e fe 9d eb b1 a4 61  |....[.CCe......a|
-000000b0  96 e1 7e 0a 60 96 34 6f  5a b4 7f dd fe 14 7b a6  |..~.`.4oZ.....{.|
-000000c0  3c b8 c2 09 fb 9c                                 |<.....|
+00000000  16 03 03 00 86 10 00 00  82 00 80 29 fc c5 28 19  |...........)..(.|
+00000010  32 c7 79 f9 16 4c d9 be  cb 43 e3 04 d2 6d 7f 38  |2.y..L...C...m.8|
+00000020  a5 da 32 97 eb bb 7f 9c  eb 78 16 2a e8 5a ea 49  |..2......x.*.Z.I|
+00000030  2e 3d 60 48 68 42 94 60  e3 cb da fa 3d cf 7f fb  |.=`HhB.`....=...|
+00000040  9f c3 4c ec 22 23 ff 0c  16 5c c5 c3 5e fa 1c c7  |..L."#...\..^...|
+00000050  60 eb f5 23 2f be 54 e0  10 a3 25 19 a3 39 49 ad  |`..#/.T...%..9I.|
+00000060  53 8e cd 65 af e7 d0 94  55 a6 64 6f 1f 59 dd b1  |S..e....U.do.Y..|
+00000070  d5 7e 98 c1 ad af 8e 72  88 b8 a3 68 fb 0c 2c 58  |.~.....r...h..,X|
+00000080  6c 0c a7 53 ad a1 bc bf  7c 6a d9 14 03 03 00 01  |l..S....|j......|
+00000090  01 16 03 03 00 30 d4 e1  2c f5 56 5e 14 75 62 02  |.....0..,.V^.ub.|
+000000a0  41 a3 f0 cb fd 52 00 b9  c0 88 db 58 7a 4c 7b 49  |A....R.....XzL{I|
+000000b0  02 02 34 33 1d a1 70 bf  ad 1a 92 86 9e 30 d6 01  |..43..p......0..|
+000000c0  9d dd ae 9b 52 43                                 |....RC|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 30 00 00 00 00 00  |..........0.....|
-00000010  00 00 00 c3 99 75 8d 3c  51 97 9a e6 f0 dd d8 93  |.....u.<Q.......|
-00000020  ba e2 10 1f 16 2d 55 65  e2 e5 21 2c e0 54 c0 d2  |.....-Ue..!,.T..|
-00000030  95 75 8b d0 c8 32 30 6c  4b ab 57 17 03 03 00 30  |.u...20lK.W....0|
-00000040  00 00 00 00 00 00 00 00  b6 4a aa 2c 1f 71 39 35  |.........J.,.q95|
-00000050  d2 9e 3d 72 74 68 17 d0  cd 0f 8e f7 13 32 76 ea  |..=rth.......2v.|
-00000060  3c 01 3c 7b 6e 0a e0 1f  b2 f3 83 7c 13 11 cb cf  |<.<{n......|....|
-00000070  15 03 03 00 20 00 00 00  00 00 00 00 00 23 22 40  |.... ........#"@|
-00000080  d5 a1 87 5a 57 da e3 d0  6d d0 e1 d5 48 00 75 10  |...ZW...m...H.u.|
-00000090  a0 c1 cf 98 82                                    |.....|
+00000010  00 00 00 c0 8f cc 51 1d  09 6f e2 aa 29 a3 36 8c  |......Q..o..).6.|
+00000020  6b 15 72 2a 54 d3 47 c2  2d f2 54 21 35 12 bd 89  |k.r*T.G.-.T!5...|
+00000030  7e b6 3f cc 61 f4 80 1f  e8 f5 32 17 03 03 00 30  |~.?.a.....2....0|
+00000040  00 00 00 00 00 00 00 00  85 74 6a 10 4f 55 b4 5c  |.........tj.OU.\|
+00000050  50 e5 76 d1 b0 77 97 a7  35 35 fd 2a 24 95 f4 96  |P.v..w..55.*$...|
+00000060  6d 02 6a 36 cc 79 08 03  fc 06 67 0a 90 3d 19 c7  |m.j6.y....g..=..|
+00000070  15 03 03 00 20 00 00 00  00 00 00 00 00 5c 3a 48  |.... ........\:H|
+00000080  26 6c 49 13 58 35 1e c6  22 07 6a 67 6a 58 1d e5  |&lI.X5..".jgjX..|
+00000090  77 6d d7 62 4f                                    |wm.bO|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES
index 5b4788cf7b..678f9a1963 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 5d 01 00 00  59 03 03 eb b8 69 bb 4f  |....]...Y....i.O|
-00000010  6e 80 93 7e eb ad d2 54  28 45 af c2 46 3d b5 2c  |n..~...T(E..F=.,|
-00000020  3f 31 14 d5 23 da d8 a9  e8 c4 6f 00 00 04 00 2f  |?1..#.....o..../|
+00000000  16 03 01 00 5d 01 00 00  59 03 03 50 0b 78 b2 4c  |....]...Y..P.x.L|
+00000010  1e 56 23 02 c5 62 24 b5  a1 59 9d 2e fc 74 81 cc  |.V#..b$..Y...t..|
+00000020  48 25 bb 7f 14 0d aa 77  c4 17 4e 00 00 04 00 2f  |H%.....w..N..../|
 00000030  00 ff 01 00 00 2c 00 0d  00 20 00 1e 06 01 06 02  |.....,... ......|
 00000040  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
 00000050  03 02 03 03 02 01 02 02  02 03 00 16 00 00 00 17  |................|
@@ -50,31 +50,31 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 8f 7d 6e f4 65  |............}n.e|
-00000010  ae d4 3c 5b 21 c5 d4 f2  b8 31 94 2e bb 50 b5 33  |..<[!....1...P.3|
-00000020  0c c4 51 89 8a c2 34 0d  11 e4 78 6c f0 00 76 4b  |..Q...4...xl..vK|
-00000030  77 db 01 a7 2e 35 65 c7  83 78 85 92 57 c7 eb c9  |w....5e..x..W...|
-00000040  cb ec 86 72 59 db cd 29  3b a5 8e d4 d1 67 15 f3  |...rY..);....g..|
-00000050  e8 90 68 65 81 66 6e 65  7b d2 29 a5 76 26 d9 81  |..he.fne{.).v&..|
-00000060  08 3b 62 13 86 25 a8 a1  67 7f a3 e3 f2 e9 2c b7  |.;b..%..g.....,.|
-00000070  cd 93 20 25 fc aa cc 9c  09 43 7f be f1 70 b6 54  |.. %.....C...p.T|
-00000080  69 cb 56 d8 dc 03 b7 57  a0 24 4d 14 03 03 00 01  |i.V....W.$M.....|
-00000090  01 16 03 03 00 40 72 e6  0e 90 53 91 e4 ce fa 93  |.....@r...S.....|
-000000a0  78 30 20 8f 6c 20 4d d0  08 4d da 62 87 f3 9f f3  |x0 .l M..M.b....|
-000000b0  e1 77 7a e5 7c e9 47 a0  85 c3 3a 35 59 b5 9b 2f  |.wz.|.G...:5Y../|
-000000c0  6b f1 75 38 89 5f aa ac  e1 c5 b0 e6 52 b5 f4 12  |k.u8._......R...|
-000000d0  ca 9d 39 82 c2 dc                                 |..9...|
+00000000  16 03 03 00 86 10 00 00  82 00 80 5b ee e9 53 45  |...........[..SE|
+00000010  1b 58 be 12 94 b2 42 8d  50 22 f8 7c af 2b 56 dd  |.X....B.P".|.+V.|
+00000020  0d 67 25 5d 26 b4 f8 3e  6a 1b de a1 05 17 25 e7  |.g%]&..>j.....%.|
+00000030  50 5e fa c3 57 7e d6 5a  66 4c d8 9e e1 ec 7a 58  |P^..W~.ZfL....zX|
+00000040  13 8b 88 77 3e 36 49 6f  25 aa 9f 31 75 95 48 78  |...w>6Io%..1u.Hx|
+00000050  54 48 e5 dd 37 1f a3 5a  f8 93 ce b4 14 c5 16 be  |TH..7..Z........|
+00000060  30 54 d6 f5 26 08 0e b9  80 5a 70 c6 92 2b 89 50  |0T..&....Zp..+.P|
+00000070  3e 44 3c b8 2b 0a 37 d9  ff 81 81 ff 5c f9 73 75  |>D<.+.7.....\.su|
+00000080  a3 24 6f 3f 36 4e f6 26  ed 8c 67 14 03 03 00 01  |.$o?6N.&..g.....|
+00000090  01 16 03 03 00 40 eb 95  ee 33 f8 ed d0 38 47 1e  |.....@...3...8G.|
+000000a0  bf 62 95 87 2b d7 96 0d  17 af ec 89 2d e7 33 83  |.b..+.......-.3.|
+000000b0  2e c3 18 67 22 06 31 f2  47 3b 10 28 98 e6 e7 b3  |...g".1.G;.(....|
+000000c0  f6 19 52 92 ad 77 74 89  4f 92 66 e7 00 a9 60 12  |..R..wt.O.f...`.|
+000000d0  30 c8 d6 d9 b3 fd                                 |0.....|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 e9 de 46 69 c7  |.............Fi.|
-00000020  6f cc f7 15 4a bd cc a9  c6 50 ae c8 7d 92 d1 ae  |o...J....P..}...|
-00000030  f6 05 0b c6 93 25 d5 e8  b7 a4 8e e9 78 08 5d ba  |.....%......x.].|
-00000040  4e 6f b9 64 56 85 0c 0c  8e 25 67 17 03 03 00 40  |No.dV....%g....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 2c 6f 4a 71 23  |...........,oJq#|
+00000020  84 5a 5c f9 93 8c c6 91  17 8a fb f5 cd d6 72 9a  |.Z\...........r.|
+00000030  f8 01 9b 54 cc 82 fd d5  51 62 a3 88 1b ce 42 b9  |...T....Qb....B.|
+00000040  f6 f6 a3 f9 35 2b 24 93  d0 ba c0 17 03 03 00 40  |....5+$........@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  3f a8 60 c9 b8 cc 5a 16  8b b0 a8 05 09 ae dc d8  |?.`...Z.........|
-00000070  f3 8e 84 39 58 46 64 72  8d 17 48 45 91 08 95 d6  |...9XFdr..HE....|
-00000080  e2 e3 24 27 bb 93 e1 02  f1 04 bd 38 c5 b8 04 47  |..$'.......8...G|
+00000060  84 ad d5 dd 56 ce ec 6f  91 4f cc 02 6e ab 88 4b  |....V..o.O..n..K|
+00000070  04 46 9e 84 8f d5 56 5d  8d 7a e3 e4 f1 32 1c e9  |.F....V].z...2..|
+00000080  b7 cc 44 aa bc 00 80 8d  39 c0 36 42 d2 f5 8e bf  |..D.....9.6B....|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 4b 1d 43  0c 1c e8 f1 e9 bc 23 be  |.....K.C......#.|
-000000b0  10 c7 53 d5 ae d1 b0 db  bb 2c a5 0b be 77 cf 49  |..S......,...w.I|
-000000c0  1c 3f fd 9b 6c                                    |.?..l|
+000000a0  00 00 00 00 00 c6 5b b6  1d 1e 53 03 95 3d fc 1c  |......[...S..=..|
+000000b0  1c 22 67 dc 2c c3 46 1d  d7 23 69 7e 3d c6 a0 10  |."g.,.F..#i~=...|
+000000c0  a5 e0 ce 54 d4                                    |...T.|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM
index 9c36eea880..2fd755e50c 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 73 01 00 00  6f 03 03 0e 36 4c 20 d7  |....s...o...6L .|
-00000010  e1 fb 69 a3 91 ed 02 d5  91 44 de fa ab 04 51 21  |..i......D....Q!|
-00000020  92 10 05 30 38 c6 7a f2  e9 2d 9a 00 00 04 c0 2f  |...08.z..-...../|
+00000000  16 03 01 00 73 01 00 00  6f 03 03 e0 a2 fa ce e1  |....s...o.......|
+00000010  09 f4 dc 29 05 6d 58 a3  76 ee 23 bc eb e3 11 b0  |...).mX.v.#.....|
+00000020  93 43 91 69 27 8a e1 fb  0b a2 60 00 00 04 c0 2f  |.C.i'.....`..../|
 00000030  00 ff 01 00 00 42 00 0b  00 04 03 00 01 02 00 0a  |.....B..........|
 00000040  00 0a 00 08 00 1d 00 17  00 19 00 18 00 0d 00 20  |............... |
 00000050  00 1e 06 01 06 02 06 03  05 01 05 02 05 03 04 01  |................|
@@ -49,35 +49,31 @@
 00000260  f1 6c 04 ed 73 bb b3 43  77 8d 0c 1c f1 0f a1 d8  |.l..s..Cw.......|
 00000270  40 83 61 c9 4c 72 2b 9d  ae db 46 06 06 4d f4 c1  |@.a.Lr+...F..M..|
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
-00000290  3b e9 fa e7 16 03 03 00  cd 0c 00 00 c9 03 00 17  |;...............|
-000002a0  41 04 1e 18 37 ef 0d 19  51 88 35 75 71 b5 e5 54  |A...7...Q.5uq..T|
-000002b0  5b 12 2e 8f 09 67 fd a7  24 20 3e b2 56 1c ce 97  |[....g..$ >.V...|
-000002c0  28 5e f8 2b 2d 4f 9e f1  07 9f 6c 4b 5b 83 56 e2  |(^.+-O....lK[.V.|
-000002d0  32 42 e9 58 b6 d7 49 a6  b5 68 1a 41 03 56 6b dc  |2B.X..I..h.A.Vk.|
-000002e0  5a 89 05 01 00 80 62 7c  f0 82 f2 5c 25 2d 56 de  |Z.....b|...\%-V.|
-000002f0  80 98 83 3e df e0 d0 2a  f6 cf 4a 63 ad 3a e2 bb  |...>...*..Jc.:..|
-00000300  e0 31 e3 91 1f a7 14 07  fc c7 4a c4 7d 64 96 49  |.1........J.}d.I|
-00000310  a3 a5 9e 96 16 78 db 5b  16 d8 f2 30 e3 2b 75 07  |.....x.[...0.+u.|
-00000320  f5 18 58 90 08 46 5f 3d  5c 56 50 3c e0 4d 96 c6  |..X..F_=\VP<.M..|
-00000330  2b 71 bd 4f 52 28 b0 56  fe b2 a8 35 1e d0 9c 33  |+q.OR(.V...5...3|
-00000340  73 d7 92 e8 88 ea fb 97  64 a0 15 0f d0 c5 8b 18  |s.......d.......|
-00000350  af 3f cf 41 83 e1 fe 7f  d4 83 aa be 6c b6 c7 e9  |.?.A........l...|
-00000360  d4 aa 11 8c 64 96 16 03  03 00 04 0e 00 00 00     |....d..........|
+00000290  3b e9 fa e7 16 03 03 00  ac 0c 00 00 a8 03 00 1d  |;...............|
+000002a0  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+000002b0  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+000002c0  74 05 01 00 80 48 99 55  da 4d dc cb 40 a5 ae 4f  |t....H.U.M..@..O|
+000002d0  d7 01 11 60 a8 70 c3 4e  0b 46 55 59 8c 7c 24 2d  |...`.p.N.FUY.|$-|
+000002e0  15 93 f9 a4 6e 74 00 f5  2f f3 35 69 58 b6 f1 5c  |....nt../.5iX..\|
+000002f0  0e 2f ba 55 28 fb 7a 34  6f e1 a1 dc 91 f1 6f 9e  |./.U(.z4o.....o.|
+00000300  84 3a e6 12 9a 4d 49 45  8b 14 59 ca 18 aa a5 33  |.:...MIE..Y....3|
+00000310  4f b3 1a 88 97 d5 c2 fa  cb 24 bc 5b cb 2a d6 46  |O........$.[.*.F|
+00000320  54 68 42 7c c8 eb 8b 93  68 2f 4b e2 cf 81 43 af  |ThB|....h/K...C.|
+00000330  d1 d2 50 9f d7 d6 1c 41  62 c1 36 75 d2 b1 e6 0e  |..P....Ab.6u....|
+00000340  4d 17 18 0a 5d 16 03 03  00 04 0e 00 00 00        |M...].........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 00 47 70 8d f0  |....F...BA..Gp..|
-00000010  14 23 bf e2 e7 68 56 b1  d1 d6 70 ba a1 bd 32 c2  |.#...hV...p...2.|
-00000020  b9 ee ac 66 f8 0a c3 20  62 56 ad 14 a4 b4 ac 4b  |...f... bV.....K|
-00000030  31 9e 94 28 91 34 2c c5  d4 7a f7 a6 d4 e5 bc 29  |1..(.4,..z.....)|
-00000040  b4 d0 c6 e2 ec 91 9d e5  b7 56 60 14 03 03 00 01  |.........V`.....|
-00000050  01 16 03 03 00 28 61 b4  6a ce 74 23 40 fa b6 15  |.....(a.j.t#@...|
-00000060  43 ba db f0 54 44 c6 d1  ae c7 56 a2 12 54 43 85  |C...TD....V..TC.|
-00000070  f9 8d a2 fc 8c 30 54 6b  c4 73 3b 60 bf da        |.....0Tk.s;`..|
+00000000  16 03 03 00 25 10 00 00  21 20 c6 88 23 46 a5 6c  |....%...! ..#F.l|
+00000010  ba 69 bb 5e 23 b1 27 01  5e 9d 7f 45 72 93 63 31  |.i.^#.'.^..Er.c1|
+00000020  e8 f2 87 08 9d 01 75 32  82 56 14 03 03 00 01 01  |......u2.V......|
+00000030  16 03 03 00 28 1e f0 f4  f5 2d b5 37 5b e1 59 60  |....(....-.7[.Y`|
+00000040  70 eb 63 31 ca 3b 41 7c  39 52 fd 33 1b 40 61 22  |p.c1.;A|9R.3.@a"|
+00000050  8f 24 69 dd 91 62 f8 d3  a2 2a a4 31 a9           |.$i..b...*.1.|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 28 00 00 00 00 00  |..........(.....|
-00000010  00 00 00 6f 28 3d 5b 9b  82 06 4b 3b d9 3a cc 5f  |...o(=[...K;.:._|
-00000020  8f cb a4 4d 83 e5 29 1d  fe f6 e2 21 4d 55 5d 8c  |...M..)....!MU].|
-00000030  a5 7b d1 17 03 03 00 25  00 00 00 00 00 00 00 01  |.{.....%........|
-00000040  e1 56 f0 28 e2 8f 74 61  91 a5 f0 62 06 b0 a7 d3  |.V.(..ta...b....|
-00000050  4e 86 1a 13 f0 cb 21 35  52 8e 86 08 99 15 03 03  |N.....!5R.......|
-00000060  00 1a 00 00 00 00 00 00  00 02 6b 2b aa ff 88 97  |..........k+....|
-00000070  56 29 3a fd 60 09 61 90  71 c8 0b ab              |V):.`.a.q...|
+00000010  00 00 00 4e d7 27 fc b0  64 d8 64 a2 4b d3 a7 52  |...N.'..d.d.K..R|
+00000020  2a 30 7a 97 d2 61 6f 4b  2f d3 81 5c 99 b3 69 3e  |*0z..aoK/..\..i>|
+00000030  29 aa 7b 17 03 03 00 25  00 00 00 00 00 00 00 01  |).{....%........|
+00000040  0a e3 da e2 13 b5 b8 d5  01 e9 54 ba ad 43 3c 11  |..........T..C<.|
+00000050  12 70 23 b6 c4 6c 5c 5a  c5 14 3c ef cd 15 03 03  |.p#..l\Z..<.....|
+00000060  00 1a 00 00 00 00 00 00  00 02 37 f7 d8 64 bb 4b  |..........7..d.K|
+00000070  ff b9 8d 5a aa 47 0a 33  12 37 29 f8              |...Z.G.3.7).|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES256-GCM-SHA384 b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES256-GCM-SHA384
index 1b5e5dc273..88c52371c1 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES256-GCM-SHA384
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES256-GCM-SHA384
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 73 01 00 00  6f 03 03 71 08 6a 82 51  |....s...o..q.j.Q|
-00000010  f9 01 7b f6 24 f8 33 62  3f 4e 35 51 9d 5c 7a 8d  |..{.$.3b?N5Q.\z.|
-00000020  10 81 c3 cd 6a b5 1c cd  a2 4b 2a 00 00 04 c0 30  |....j....K*....0|
+00000000  16 03 01 00 73 01 00 00  6f 03 03 bc e7 1a ca 08  |....s...o.......|
+00000010  96 da c8 af ca 82 23 6b  38 66 bf ae ce e1 1e 9a  |......#k8f......|
+00000020  b8 3f 89 85 4e a8 3c 97  a4 89 b8 00 00 04 c0 30  |.?..N.<........0|
 00000030  00 ff 01 00 00 42 00 0b  00 04 03 00 01 02 00 0a  |.....B..........|
 00000040  00 0a 00 08 00 1d 00 17  00 19 00 18 00 0d 00 20  |............... |
 00000050  00 1e 06 01 06 02 06 03  05 01 05 02 05 03 04 01  |................|
@@ -49,35 +49,31 @@
 00000260  f1 6c 04 ed 73 bb b3 43  77 8d 0c 1c f1 0f a1 d8  |.l..s..Cw.......|
 00000270  40 83 61 c9 4c 72 2b 9d  ae db 46 06 06 4d f4 c1  |@.a.Lr+...F..M..|
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
-00000290  3b e9 fa e7 16 03 03 00  cd 0c 00 00 c9 03 00 17  |;...............|
-000002a0  41 04 1e 18 37 ef 0d 19  51 88 35 75 71 b5 e5 54  |A...7...Q.5uq..T|
-000002b0  5b 12 2e 8f 09 67 fd a7  24 20 3e b2 56 1c ce 97  |[....g..$ >.V...|
-000002c0  28 5e f8 2b 2d 4f 9e f1  07 9f 6c 4b 5b 83 56 e2  |(^.+-O....lK[.V.|
-000002d0  32 42 e9 58 b6 d7 49 a6  b5 68 1a 41 03 56 6b dc  |2B.X..I..h.A.Vk.|
-000002e0  5a 89 05 01 00 80 24 35  9f 10 13 d9 ae 05 b2 37  |Z.....$5.......7|
-000002f0  ff 96 89 d1 fd 47 19 d5  42 1c 72 0a f8 06 a9 37  |.....G..B.r....7|
-00000300  a9 ef b8 58 64 71 23 86  1c 23 94 16 10 f6 4f f9  |...Xdq#..#....O.|
-00000310  ce 43 86 fb c6 25 1e 5e  e4 53 50 f0 e4 af b2 1c  |.C...%.^.SP.....|
-00000320  a8 b3 9e 89 4a 36 da 95  3b a0 30 ce 60 44 82 c8  |....J6..;.0.`D..|
-00000330  79 e1 dd 6f 19 6b 91 c8  37 8b 9e 86 c3 6f cc ad  |y..o.k..7....o..|
-00000340  e0 75 a2 72 0b 8a 82 15  2f 2b f4 57 2d cf 63 d4  |.u.r..../+.W-.c.|
-00000350  68 cb 31 bd 00 dd c4 f8  5a 63 ca 7f 19 9e f4 c6  |h.1.....Zc......|
-00000360  15 66 8d 0a 06 af 16 03  03 00 04 0e 00 00 00     |.f.............|
+00000290  3b e9 fa e7 16 03 03 00  ac 0c 00 00 a8 03 00 1d  |;...............|
+000002a0  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+000002b0  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+000002c0  74 05 01 00 80 89 eb fc  69 bd e7 5a 8d 4a 9c 7e  |t.......i..Z.J.~|
+000002d0  2a b8 8c 5e 9e 37 62 89  7b 95 0c aa 78 c8 87 d5  |*..^.7b.{...x...|
+000002e0  50 38 25 9e 42 52 51 c5  85 de 76 48 78 44 3a 96  |P8%.BRQ...vHxD:.|
+000002f0  87 dd b8 83 c7 89 d2 39  88 c0 e1 77 c5 eb 92 21  |.......9...w...!|
+00000300  cb 5e 40 5a 82 13 cb d6  86 ce 26 17 b0 7c d7 56  |.^@Z......&..|.V|
+00000310  8a 49 9c a2 70 a3 cb 61  12 f5 0e b9 dd f2 ec c4  |.I..p..a........|
+00000320  74 b6 bf a1 83 9a 94 3b  ff b1 82 2e 14 da 3f 86  |t......;......?.|
+00000330  31 86 c5 92 ee e4 f1 41  06 57 06 de 5d 36 58 31  |1......A.W..]6X1|
+00000340  2b ac e0 47 04 16 03 03  00 04 0e 00 00 00        |+..G..........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 09 59 de cb 3c  |....F...BA..Y..<|
-00000010  da 19 78 97 95 3b 38 03  01 f8 0b 54 e8 02 65 e5  |..x..;8....T..e.|
-00000020  36 78 c4 03 8f 54 09 15  4a 2f ab 21 c8 66 76 64  |6x...T..J/.!.fvd|
-00000030  61 bf b4 c0 cb ce 30 1a  45 36 d1 cc 31 dc 49 42  |a.....0.E6..1.IB|
-00000040  d6 60 86 cf 63 da 6c eb  18 5a a1 14 03 03 00 01  |.`..c.l..Z......|
-00000050  01 16 03 03 00 28 09 75  e9 46 b4 92 ae 93 ef c4  |.....(.u.F......|
-00000060  84 98 c7 b1 8c c6 f2 02  06 91 b3 65 5d f3 19 81  |...........e]...|
-00000070  f1 6c 60 3d f5 78 da 70  6a 0c 8e 3f 9f 0c        |.l`=.x.pj..?..|
+00000000  16 03 03 00 25 10 00 00  21 20 54 93 b9 c3 5d 0f  |....%...! T...].|
+00000010  9f 34 0a a0 0c bd df 96  12 a6 35 ed c3 ab ae d0  |.4........5.....|
+00000020  41 3c 7d 7e b4 f4 0b a6  4c 1a 14 03 03 00 01 01  |A<}~....L.......|
+00000030  16 03 03 00 28 5d a3 8e  f4 82 cd 79 ff a1 4a f6  |....(].....y..J.|
+00000040  8b f5 fd 79 b1 db 00 33  a8 e0 65 fa 6a 66 77 92  |...y...3..e.jfw.|
+00000050  f1 9a 03 f6 c3 04 8d e9  fd 77 23 41 ed           |.........w#A.|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 28 00 00 00 00 00  |..........(.....|
-00000010  00 00 00 48 dd ca d6 1f  f4 09 7b ab 99 c0 e6 45  |...H......{....E|
-00000020  78 54 a5 f9 b0 fd 84 88  a8 74 27 8b 20 57 99 07  |xT.......t'. W..|
-00000030  ad 4d 07 17 03 03 00 25  00 00 00 00 00 00 00 01  |.M.....%........|
-00000040  49 61 3f ce 95 60 ee d8  b4 38 4f 38 8e 13 a4 dc  |Ia?..`...8O8....|
-00000050  32 dd 22 c9 20 b3 81 fa  98 96 c8 34 02 15 03 03  |2.". ......4....|
-00000060  00 1a 00 00 00 00 00 00  00 02 47 7e 19 de ee 36  |..........G~...6|
-00000070  90 5d 7a 4f 10 bc ec aa  14 49 54 bc              |.]zO.....IT.|
+00000010  00 00 00 48 6d dc 6d 66  cd 9f e1 f7 9c fa 39 d0  |...Hm.mf......9.|
+00000020  f9 25 1d 03 43 1f b8 78  1c e5 1e 46 1f ee fe 05  |.%..C..x...F....|
+00000030  1d 4b 3c 17 03 03 00 25  00 00 00 00 00 00 00 01  |.K<....%........|
+00000040  f3 ee a6 01 db 34 54 f0  9a ee 15 da ff d7 7a a2  |.....4T.......z.|
+00000050  55 c5 55 3f df 8a f7 70  f6 62 67 10 05 15 03 03  |U.U?...p.bg.....|
+00000060  00 1a 00 00 00 00 00 00  00 02 64 17 7b 79 a6 0d  |..........d.{y..|
+00000070  a2 3e 5a 11 60 72 ba 4d  5e 03 de 49              |.>Z.`r.M^..I|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-RC4 b/src/crypto/tls/testdata/Server-TLSv12-RSA-RC4
index 2fbf3d92f7..8a5924e168 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-RC4
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-RC4
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 5d 01 00 00  59 03 03 a3 60 98 78 96  |....]...Y...`.x.|
-00000010  54 77 9a 56 e1 a4 1f 0c  18 53 03 e4 f7 b2 6d 73  |Tw.V.....S....ms|
-00000020  43 00 fe 40 34 c9 1e 15  76 84 a6 00 00 04 00 05  |C..@4...v.......|
+00000000  16 03 01 00 5d 01 00 00  59 03 03 3f 8c 20 8d f7  |....]...Y..?. ..|
+00000010  a8 0e 9d 16 b3 9b d9 b6  68 5e 3b bd f4 44 37 5b  |........h^;..D7[|
+00000020  07 c7 dc 89 b4 5b 0f 0e  d9 a2 fd 00 00 04 00 05  |.....[..........|
 00000030  00 ff 01 00 00 2c 00 0d  00 20 00 1e 06 01 06 02  |.....,... ......|
 00000040  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
 00000050  03 02 03 03 02 01 02 02  02 03 00 16 00 00 00 17  |................|
@@ -50,23 +50,23 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 55 2f e8 6c 17  |...........U/.l.|
-00000010  e8 b3 29 bb cb b3 b6 77  3d cf 15 57 03 2a 3b 1c  |..)....w=..W.*;.|
-00000020  f4 d1 da 6a f1 42 17 13  bf 22 fb 54 78 9c d8 83  |...j.B...".Tx...|
-00000030  bf 8d 23 02 9c 96 a1 19  19 b3 40 5a 11 86 2a 1f  |..#.......@Z..*.|
-00000040  55 4b 42 fb 98 1f 8f 65  dc 2b 7e a5 aa 6a f9 27  |UKB....e.+~..j.'|
-00000050  27 bd ce dc 6a 16 85 36  a7 39 d8 e0 c3 e9 b4 f4  |'...j..6.9......|
-00000060  c4 36 f2 4a b8 64 e0 67  ab 9e d2 f6 11 c3 55 42  |.6.J.d.g......UB|
-00000070  72 a8 60 35 99 13 45 ff  df 95 67 47 86 e4 a2 33  |r.`5..E...gG...3|
-00000080  f1 e2 9d 34 5f ea 8c 71  29 aa 69 14 03 03 00 01  |...4_..q).i.....|
-00000090  01 16 03 03 00 24 a8 bb  de a4 19 50 51 a5 7b 50  |.....$.....PQ.{P|
-000000a0  c6 a8 37 ec f0 da 12 0a  45 d5 16 b0 27 7a 00 0a  |..7.....E...'z..|
-000000b0  0b 72 6a fb 67 2c e6 b4  6d fe                    |.rj.g,..m.|
+00000000  16 03 03 00 86 10 00 00  82 00 80 47 b2 00 f9 96  |...........G....|
+00000010  fc 53 53 1a 05 b1 89 5f  39 0d 5e 86 e7 fe 69 e5  |.SS...._9.^...i.|
+00000020  7c 2f b7 70 f3 eb 11 95  f2 45 0f 09 36 ae 85 4f  ||/.p.....E..6..O|
+00000030  cf 9e 92 ea 5a 79 90 1e  d6 dd 43 f3 50 40 82 d7  |....Zy....C.P@..|
+00000040  36 53 3b 7f 17 71 0f 83  58 4d 2d 35 b0 70 d1 68  |6S;..q..XM-5.p.h|
+00000050  63 97 00 de 77 8f 0d 89  bb d2 a9 01 4b 6c e7 3f  |c...w.......Kl.?|
+00000060  1d 64 a0 c5 38 99 a5 70  f7 66 df ac c5 08 cd 48  |.d..8..p.f.....H|
+00000070  a4 e7 c0 8b a6 5a dd 2e  d3 24 2d b4 3a c5 09 98  |.....Z...$-.:...|
+00000080  4f 49 cb 23 ea fb 73 ed  92 3e 76 14 03 03 00 01  |OI.#..s..>v.....|
+00000090  01 16 03 03 00 24 b9 43  a4 09 06 d2 f4 ab e8 15  |.....$.C........|
+000000a0  5c 23 09 60 7c cf 1f 77  af 39 11 b8 5e e5 28 87  |\#.`|..w.9..^.(.|
+000000b0  03 83 6b bd 98 a9 cb dd  c7 37                    |..k......7|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 24 64 b0 e3 b3 bb  |..........$d....|
-00000010  70 9a 1c af 9c 93 91 67  87 ea d2 7b 84 5c 2b 1f  |p......g...{.\+.|
-00000020  89 c0 7d 6d 28 31 ad 8b  d8 ab 8a 7c ad c3 d8 17  |..}m(1.....|....|
-00000030  03 03 00 21 5c 30 69 29  a7 22 b9 fa d6 65 38 77  |...!\0i)."...e8w|
-00000040  6b 2b c7 4e 4b 6d 6f 91  c1 cf 8c 2c 08 e8 c7 b2  |k+.NKmo....,....|
-00000050  21 8c dd 3e 36 15 03 03  00 16 7b 1a bd 2e 9b 56  |!..>6.....{....V|
-00000060  4c b8 0d 1c 34 3f 3a 7e  e1 65 aa bf ad f1 1f 5e  |L...4?:~.e.....^|
+00000000  14 03 03 00 01 01 16 03  03 00 24 ac 96 d0 45 b1  |..........$...E.|
+00000010  78 80 cc 3a dc d2 28 06  99 8b 1a 25 c0 2d f3 80  |x..:..(....%.-..|
+00000020  54 25 5e 6c 63 87 e4 9f  9f a3 c9 ef e9 8f 87 17  |T%^lc...........|
+00000030  03 03 00 21 95 00 3a 52  a8 11 64 d3 f4 bc 8c f3  |...!..:R..d.....|
+00000040  90 cf 26 3b 41 62 c8 2c  ee 78 60 a2 85 7b 5d 5c  |..&;Ab.,.x`..{]\|
+00000050  3e 4a 6e c9 c2 15 03 03  00 16 76 d8 e0 a9 f6 f9  |>Jn.......v.....|
+00000060  2c aa d6 68 ab 27 9c ee  c6 ba 50 e0 1e 17 fa 79  |,..h.'....P....y|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-Resume b/src/crypto/tls/testdata/Server-TLSv12-Resume
index 599da5b67d..51c5cd285a 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-Resume
+++ b/src/crypto/tls/testdata/Server-TLSv12-Resume
@@ -1,44 +1,44 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 f9 01 00 00  f5 03 03 87 90 a5 92 ea  |................|
-00000010  48 25 c2 91 01 8a e4 bb  16 2d d3 8c b7 e9 a3 9a  |H%.......-......|
-00000020  6d e1 6f b4 11 f3 9b 61  c9 03 cf 20 d9 a8 04 8f  |m.o....a... ....|
-00000030  3b f8 1c 73 d8 4b 55 40  43 95 26 1f ed 67 cc 18  |;..s.KU@C.&..g..|
-00000040  0d 8f e8 d4 ab 1a 2e 53  d0 e6 89 d8 00 04 00 2f  |.......S......./|
+00000000  16 03 01 00 f9 01 00 00  f5 03 03 a5 54 3e b4 52  |............T>.R|
+00000010  e5 0f 00 26 8b b6 97 99  3d 32 64 42 6c 97 f8 0c  |...&....=2dBl...|
+00000020  46 10 42 83 bb d1 d3 a0  70 58 4e 20 0b ef 27 4e  |F.B.....pXN ..'N|
+00000030  90 45 03 73 c9 18 0f 5b  25 77 c9 5d ca 77 2c fb  |.E.s...[%w.].w,.|
+00000040  4f 0e d1 a3 dc 76 4d d6  97 70 ab a6 00 04 00 2f  |O....vM..p...../|
 00000050  00 ff 01 00 00 a8 00 23  00 78 50 46 ad c1 db a8  |.......#.xPF....|
 00000060  38 86 7b 2b bb fd d0 c3  42 3e 00 00 00 00 00 00  |8.{+....B>......|
 00000070  00 00 00 00 00 00 00 00  00 00 94 6f 2c 9f 83 61  |...........o,..a|
-00000080  ba 85 c2 4f 82 f7 76 6c  2f 9d 4c 16 0e 46 88 f4  |...O..vl/.L..F..|
-00000090  1b 1b 35 62 9c c7 e6 0e  44 a4 62 8c 1e 2d 53 f3  |..5b....D.b..-S.|
-000000a0  8b cd a6 ca dc 12 52 b4  43 a9 d0 16 4c 9a f7 a6  |......R.C...L...|
-000000b0  33 94 f7 58 26 2b 75 74  62 e3 11 dc f6 40 b0 ab  |3..X&+utb....@..|
-000000c0  32 8b 79 63 d1 7e d8 9f  db cf cf 25 29 ea e9 89  |2.yc.~.....%)...|
-000000d0  43 39 00 0d 00 20 00 1e  06 01 06 02 06 03 05 01  |C9... ..........|
+00000080  f0 a9 9a d5 65 c7 25 32  9d 86 4e fb 8e 2a dd 84  |....e.%2..N..*..|
+00000090  8d 32 6d 6b f0 a9 de 59  fa 15 20 7a 85 cd 2e 42  |.2mk...Y.. z...B|
+000000a0  e1 f3 44 62 6c 24 24 e7  1f b6 fa 4d 8a cd 30 83  |..Dbl$$....M..0.|
+000000b0  33 94 65 b6 e2 01 d8 fb  a0 37 ca 87 59 a4 29 cf  |3.e......7..Y.).|
+000000c0  d9 85 7c 54 2f 2d 5d 73  69 9a ae 6f 85 29 8b c3  |..|T/-]si..o.)..|
+000000d0  eb 97 00 0d 00 20 00 1e  06 01 06 02 06 03 05 01  |..... ..........|
 000000e0  05 02 05 03 04 01 04 02  04 03 03 01 03 02 03 03  |................|
 000000f0  02 01 02 02 02 03 00 16  00 00 00 17 00 00        |..............|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 51 02 00 00  4d 03 03 00 00 00 00 00  |....Q...M.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 d9 a8 04 8f  |........... ....|
-00000030  3b f8 1c 73 d8 4b 55 40  43 95 26 1f ed 67 cc 18  |;..s.KU@C.&..g..|
-00000040  0d 8f e8 d4 ab 1a 2e 53  d0 e6 89 d8 00 2f 00 00  |.......S...../..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 0b ef 27 4e  |........... ..'N|
+00000030  90 45 03 73 c9 18 0f 5b  25 77 c9 5d ca 77 2c fb  |.E.s...[%w.].w,.|
+00000040  4f 0e d1 a3 dc 76 4d d6  97 70 ab a6 00 2f 00 00  |O....vM..p.../..|
 00000050  05 ff 01 00 01 00 14 03  03 00 01 01 16 03 03 00  |................|
 00000060  40 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |@...............|
-00000070  00 31 1c ed f9 93 71 b9  b1 52 b7 8c d2 cc 1c ea  |.1....q..R......|
-00000080  2b bb c3 56 88 d4 40 ff  71 d4 33 4b 1a 17 6e ab  |+..V..@.q.3K..n.|
-00000090  70 78 3f 87 bf cd 8c 67  91 a0 17 d7 ee 16 37 68  |px?....g......7h|
-000000a0  5b                                                |[|
+00000070  00 a1 cc 3b 14 4e 15 da  e3 6f 67 2a 4b 28 1e 4f  |...;.N...og*K(.O|
+00000080  a6 e3 bc fd ae 38 e3 31  6f 65 78 2b 3d c5 c7 bf  |.....8.1oex+=...|
+00000090  1a ff 10 a1 b1 cd 1e 0e  54 a8 9c 89 86 ab 76 46  |........T.....vF|
+000000a0  3e                                                |>|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 16 03  03 00 40 a5 40 0c 73 e9  |..........@.@.s.|
-00000010  c5 b5 65 d6 1c a7 17 c4  9b 3f 1a 6d e1 02 c4 b0  |..e......?.m....|
-00000020  27 9b ab 24 d5 68 d3 98  3e 06 13 c3 d9 a7 b9 07  |'..$.h..>.......|
-00000030  fb fa fa 1b ba 41 b4 26  94 ba e7 5c a3 bf ae b7  |.....A.&...\....|
-00000040  69 f9 55 71 bd 04 97 04  0c fc 96                 |i.Uq.......|
+00000000  14 03 03 00 01 01 16 03  03 00 40 9b 58 5e e3 6d  |..........@.X^.m|
+00000010  aa 65 b6 82 e4 60 bd 74  92 11 99 88 03 14 bf b4  |.e...`.t........|
+00000020  24 e8 2f 89 ff 9b e4 b5  ca 2e b5 cf a0 56 b0 23  |$./..........V.#|
+00000030  96 d7 92 40 83 f8 fa fd  7a 11 6d 8d 1a 29 59 75  |...@....z.m..)Yu|
+00000040  88 b8 54 23 d0 01 ef 67  40 c0 41                 |..T#...g@.A|
 >>> Flow 4 (server to client)
 00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000010  00 00 00 00 00 fc f8 67  97 50 34 a5 05 b2 f0 ea  |.......g.P4.....|
-00000020  77 5c bb 63 78 79 a4 a0  58 37 3b ae 96 9a c5 16  |w\.cxy..X7;.....|
-00000030  82 9c b0 4b 02 27 01 0d  c9 ac e0 f5 3d d6 32 f7  |...K.'......=.2.|
-00000040  df 41 68 b0 38 15 03 03  00 30 00 00 00 00 00 00  |.Ah.8....0......|
-00000050  00 00 00 00 00 00 00 00  00 00 ea 57 3b c1 9f f4  |...........W;...|
-00000060  79 d7 76 f0 d6 1c 9d cd  0e 5a 2a 98 29 36 96 47  |y.v......Z*.)6.G|
-00000070  4e 9c 76 ef 4c 69 c1 e3  4b b3                    |N.v.Li..K.|
+00000010  00 00 00 00 00 a2 64 88  a2 a3 a9 ca 7a ba 88 8d  |......d.....z...|
+00000020  19 b2 8a 34 5b 72 9e 4e  69 81 e6 65 00 04 49 ac  |...4[r.Ni..e..I.|
+00000030  9f 64 8b 97 32 1c c2 cb  b6 29 be b9 4b e0 b6 0b  |.d..2....)..K...|
+00000040  4e 54 ad 2a c5 15 03 03  00 30 00 00 00 00 00 00  |NT.*.....0......|
+00000050  00 00 00 00 00 00 00 00  00 00 1d 78 fa 81 56 36  |...........x..V6|
+00000060  98 ec b2 f8 3c b8 60 8b  1a c7 92 86 02 c3 bd b6  |....<.`.........|
+00000070  0b 01 78 c9 41 2a 16 a2  fe 0d                    |..x.A*....|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ResumeDisabled b/src/crypto/tls/testdata/Server-TLSv12-ResumeDisabled
index 96bd098fda..cda60afee8 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ResumeDisabled
+++ b/src/crypto/tls/testdata/Server-TLSv12-ResumeDisabled
@@ -1,18 +1,18 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 f9 01 00 00  f5 03 03 c0 f1 8f 13 ed  |................|
-00000010  61 9a 75 ae 73 8d 36 f2  23 33 0c e0 7f 78 a5 d2  |a.u.s.6.#3...x..|
-00000020  57 62 6c 5c 2b b7 1d aa  fe db 57 20 78 df e5 41  |Wbl\+.....W x..A|
-00000030  23 3f dc 1b 76 d9 dd cf  a5 bf 00 8d 54 ca 0b c1  |#?..v.......T...|
-00000040  69 f4 d5 2a 50 ce 27 fd  58 22 50 14 00 04 00 2f  |i..*P.'.X"P..../|
+00000000  16 03 01 00 f9 01 00 00  f5 03 03 d6 dc 77 de b6  |.............w..|
+00000010  db d8 b9 19 e5 8a 59 88  8f ca f7 76 08 1e 41 1f  |......Y....v..A.|
+00000020  ed 8b 3e 54 9c 8c c4 1d  30 fa d6 20 5d 5a dc 87  |..>T....0.. ]Z..|
+00000030  c6 ca 58 3c f2 df 11 66  38 25 03 a7 90 2f 30 ef  |..X<...f8%.../0.|
+00000040  cd 98 f5 48 70 10 ba 94  fb a3 25 58 00 04 00 2f  |...Hp.....%X.../|
 00000050  00 ff 01 00 00 a8 00 23  00 78 50 46 ad c1 db a8  |.......#.xPF....|
 00000060  38 86 7b 2b bb fd d0 c3  42 3e 00 00 00 00 00 00  |8.{+....B>......|
 00000070  00 00 00 00 00 00 00 00  00 00 94 6f 2c 9f 83 61  |...........o,..a|
-00000080  67 87 d5 79 1d 56 b8 ca  6d e2 b0 2e a7 2e c9 d7  |g..y.V..m.......|
-00000090  b3 5a de 91 3b 6f 30 a7  14 af d1 b4 af 5b 9e a0  |.Z..;o0......[..|
-000000a0  65 e6 fe cd d3 77 f3 88  c6 cf 52 74 28 4b a2 14  |e....w....Rt(K..|
-000000b0  33 94 9a e0 60 f2 0b df  c5 58 4b 56 46 52 6a 3a  |3...`....XKVFRj:|
-000000c0  83 15 89 c6 a9 31 83 83  ef 29 2a 9f c6 5f ba 8d  |.....1...)*.._..|
-000000d0  91 de 00 0d 00 20 00 1e  06 01 06 02 06 03 05 01  |..... ..........|
+00000080  60 24 85 1b 46 9d 93 96  8f 27 6f bf 17 0e 2d 0d  |`$..F....'o...-.|
+00000090  f1 3c 3d ce 85 b5 9c 8f  3a 6a c8 b4 e2 a1 03 c9  |.<=.....:j......|
+000000a0  9c 34 72 d5 7e 60 d3 f3  f6 20 d6 0f 1b b9 18 0c  |.4r.~`... ......|
+000000b0  33 94 71 92 ec 74 0e eb  a0 f7 ec 81 b3 d2 63 90  |3.q..t........c.|
+000000c0  b8 0f d9 9e d2 12 aa b5  78 06 7f 1b d3 33 fc d0  |........x....3..|
+000000d0  9c 73 00 0d 00 20 00 1e  06 01 06 02 06 03 05 01  |.s... ..........|
 000000e0  05 02 05 03 04 01 04 02  04 03 03 01 03 02 03 03  |................|
 000000f0  02 01 02 02 02 03 00 16  00 00 00 17 00 00        |..............|
 >>> Flow 2 (server to client)
@@ -59,31 +59,31 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 62 1e 90 15 39  |...........b...9|
-00000010  f4 61 dd 1a ae ce 4b 84  1c dc 0b c8 b6 16 6d bb  |.a....K.......m.|
-00000020  77 02 c3 69 02 b6 b1 9c  de 1f 09 01 50 e6 3e 51  |w..i........P.>Q|
-00000030  96 36 5a 6c 87 63 5f fe  8a da bd ee 01 6d a3 3e  |.6Zl.c_......m.>|
-00000040  ff b2 72 47 60 6d ca c3  a4 03 57 4e 1f ea 7d cc  |..rG`m....WN..}.|
-00000050  f7 0c 2a 06 8f a6 c6 fe  1a bb 75 81 92 5e 44 3d  |..*.......u..^D=|
-00000060  78 49 1e 88 79 19 8a df  79 09 2e 61 10 48 7a 60  |xI..y...y..a.Hz`|
-00000070  e0 58 51 ec 33 4c b1 d0  6d ad 01 03 9f 38 21 bb  |.XQ.3L..m....8!.|
-00000080  8f 9d 23 c1 06 38 f3 90  dc 7f af 14 03 03 00 01  |..#..8..........|
-00000090  01 16 03 03 00 40 3d 60  a9 d5 ae 59 72 dc ef 8e  |.....@=`...Yr...|
-000000a0  9a 77 ab 3c 8d 98 bb 5a  67 d1 2b 00 2d 97 8d af  |.w.<...Zg.+.-...|
-000000b0  ef 1b bb 8c 0b ce ab 2a  e7 a8 0e 2a 28 83 34 5a  |.......*...*(.4Z|
-000000c0  00 d0 5d dc 6e 9c e3 a6  eb e7 fa 4c 7f 14 76 1f  |..].n......L..v.|
-000000d0  76 56 c0 61 78 d1                                 |vV.ax.|
+00000000  16 03 03 00 86 10 00 00  82 00 80 4f e7 7f 83 54  |...........O...T|
+00000010  80 1b 49 a5 7c b0 eb 3f  3b 24 74 9a 90 65 ed 2c  |..I.|..?;$t..e.,|
+00000020  30 13 3d 5d 26 91 b6 09  d2 22 f6 5d ed 96 c0 80  |0.=]&....".]....|
+00000030  15 f5 07 87 c3 ee bf 83  19 a4 2f 09 1f dd 05 02  |........../.....|
+00000040  9e 15 de 36 c4 0c ab ff  2e 6b f2 f3 dd 86 18 ea  |...6.....k......|
+00000050  15 8d 96 9f f9 93 26 1d  45 d4 12 c6 40 ab 09 b6  |......&.E...@...|
+00000060  11 dc 74 86 49 58 ce 90  3f 84 ff 47 77 5d 20 22  |..t.IX..?..Gw] "|
+00000070  90 1c d8 cc 18 83 e2 cb  58 20 54 4c 81 c2 0d 3b  |........X TL...;|
+00000080  2c 9a 4b 53 f0 87 61 c2  5e 61 d6 14 03 03 00 01  |,.KS..a.^a......|
+00000090  01 16 03 03 00 40 c2 2e  e7 31 9c 22 4b bf 84 69  |.....@...1."K..i|
+000000a0  fb b9 c1 03 a9 29 93 94  86 2a 57 48 9b 1d 54 99  |.....)...*WH..T.|
+000000b0  d8 89 f4 88 db 93 72 66  8f a2 03 a0 50 9f e0 a4  |......rf....P...|
+000000c0  12 38 83 7d c3 89 20 e4  04 18 82 5a bf 96 19 2d  |.8.}.. ....Z...-|
+000000d0  dc 6a 81 12 e4 cf                                 |.j....|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 89 71 57 1b 74  |............qW.t|
-00000020  93 38 ff 69 12 59 5a 24  3c 47 67 96 f6 4f 2d 0f  |.8.i.YZ$<Gg..O-.|
-00000030  dc 00 d0 1e 43 78 19 7e  b0 79 73 19 c6 67 43 94  |....Cx.~.ys..gC.|
-00000040  cb 66 2c 75 d8 54 90 62  33 5a 21 17 03 03 00 40  |.f,u.T.b3Z!....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 8f 66 fd 10 60  |............f..`|
+00000020  f0 28 41 5b 3a 14 9c d6  ba d9 a1 9d 94 20 11 85  |.(A[:........ ..|
+00000030  db 8d 87 00 bb 90 2a 42  68 3d 14 ba b2 ae 25 ca  |......*Bh=....%.|
+00000040  1a 68 3d e8 45 95 52 0f  c1 5c cd 17 03 03 00 40  |.h=.E.R..\.....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  8d 20 2f 9e b8 84 fc 5c  4b 3d 95 eb 4b 02 db 7f  |. /....\K=..K...|
-00000070  2b 66 1a 46 d0 2e 3e e8  18 58 c0 1f 37 ad db da  |+f.F..>..X..7...|
-00000080  78 5d ec eb 8a 39 2c 9d  e9 2e 37 ba 34 53 92 d3  |x]...9,...7.4S..|
+00000060  62 6a 19 3d 6e b6 c5 fc  9a a2 e9 f8 b2 23 6c ce  |bj.=n........#l.|
+00000070  66 4b e2 c0 b1 72 d7 16  43 19 05 a4 b4 75 01 15  |fK...r..C....u..|
+00000080  93 54 20 37 8e 62 02 5a  0c 68 bc 3c c3 0b d7 37  |.T 7.b.Z.h.<...7|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 0b fb 0f  fc f1 36 24 05 99 aa bb  |..........6$....|
-000000b0  e6 b2 be cd e9 f1 8a 4b  bb 94 67 6d 87 4e 98 0e  |.......K..gm.N..|
-000000c0  a2 9e 46 2e 8b                                    |..F..|
+000000a0  00 00 00 00 00 a2 33 5f  d7 0a 20 20 f6 d1 59 6a  |......3_..  ..Yj|
+000000b0  3e 40 15 da 8f 9f b3 98  63 85 18 46 24 45 40 94  |>@......c..F$E@.|
+000000c0  c8 c6 5e d5 fc                                    |..^..|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-SNI b/src/crypto/tls/testdata/Server-TLSv12-SNI
index a6b5334354..65bdfa951d 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-SNI
+++ b/src/crypto/tls/testdata/Server-TLSv12-SNI
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 71 01 00 00  6d 03 03 bd c9 cf c6 3f  |....q...m......?|
-00000010  0b a6 a0 f8 a6 c5 91 f1  45 fa 20 cb 42 67 2f d7  |........E. .Bg/.|
-00000020  cb be 35 d4 6a a5 07 47  11 bb fe 00 00 04 00 2f  |..5.j..G......./|
+00000000  16 03 01 00 71 01 00 00  6d 03 03 e8 20 88 32 3c  |....q...m... .2<|
+00000010  30 7c b0 e8 86 e7 08 16  e0 47 4e 4a a9 b8 c6 5e  |0|.......GNJ...^|
+00000020  21 4e 80 31 cf 25 6f 8f  f7 e4 3e 00 00 04 00 2f  |!N.1.%o...>..../|
 00000030  00 ff 01 00 00 40 00 00  00 10 00 0e 00 00 0b 73  |.....@.........s|
 00000040  6e 69 74 65 73 74 2e 63  6f 6d 00 0d 00 20 00 1e  |nitest.com... ..|
 00000050  06 01 06 02 06 03 05 01  05 02 05 03 04 01 04 02  |................|
@@ -51,31 +51,31 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 a4 72 d8 04 ea  |............r...|
-00000010  75 da c4 14 85 8d d7 7d  08 43 3a 38 fc 02 50 8e  |u......}.C:8..P.|
-00000020  54 8a 49 a7 fc 4b 3f 13  a0 63 c6 69 72 93 2d cd  |T.I..K?..c.ir.-.|
-00000030  f5 08 fe 24 bb d8 54 76  25 eb f8 9c 5d b9 a9 df  |...$..Tv%...]...|
-00000040  56 f9 42 81 c1 29 0e 4e  05 f3 f7 44 bb ee a4 de  |V.B..).N...D....|
-00000050  a6 cc 22 68 40 1b 81 4e  fe e2 02 8e e7 7c 25 71  |.."h@..N.....|%q|
-00000060  cc 9e 86 01 e6 80 68 b2  4e 80 3d fc bc 4f 8f 30  |......h.N.=..O.0|
-00000070  fa 17 be 2c 7f c5 5f 17  b0 b3 3c 4b 90 a2 5e cc  |...,.._...<K..^.|
-00000080  35 94 9c e4 9c 35 12 a2  ba a3 c3 14 03 03 00 01  |5....5..........|
-00000090  01 16 03 03 00 40 20 48  00 ff 46 9b e5 61 a3 1f  |.....@ H..F..a..|
-000000a0  c3 cc 86 b3 b5 4d dc f8  b3 6f 61 1f b8 03 83 93  |.....M...oa.....|
-000000b0  58 be bf 77 5d db 9c 3d  26 ed e2 cd a6 1d 4b e3  |X..w]..=&.....K.|
-000000c0  37 c2 0d 4d b6 80 e1 f1  17 19 1e 9e 77 90 ec 16  |7..M........w...|
-000000d0  55 92 a4 f9 36 a7                                 |U...6.|
+00000000  16 03 03 00 86 10 00 00  82 00 80 4f 68 55 f9 ae  |...........OhU..|
+00000010  17 7b ff 2c c9 d2 87 cb  12 30 3a 4a 55 30 c6 31  |.{.,.....0:JU0.1|
+00000020  9e 3d 1d fd 19 43 cd 07  89 a1 6b ad ac 65 df 9d  |.=...C....k..e..|
+00000030  e7 ff f5 85 8a 5f e3 4e  1a ab 1a 48 65 ee f1 3b  |....._.N...He..;|
+00000040  63 b3 db ab cb 69 13 31  25 dd 7d 31 78 3f 80 48  |c....i.1%.}1x?.H|
+00000050  f4 2f b1 f9 c8 a1 02 bd  10 53 d9 46 90 c4 c2 87  |./.......S.F....|
+00000060  99 44 ad 89 0a b2 9c b2  8e 59 2a 1e 87 9b 79 2d  |.D.......Y*...y-|
+00000070  e0 20 72 95 43 64 b3 6a  c9 25 ec 26 76 ad b2 ff  |. r.Cd.j.%.&v...|
+00000080  24 31 c0 b6 b2 75 8f c7  51 2f 53 14 03 03 00 01  |$1...u..Q/S.....|
+00000090  01 16 03 03 00 40 4c 1c  1d 4c cb b2 dc 2c 37 b4  |.....@L..L...,7.|
+000000a0  c7 dd ab 06 99 b7 4c 81  33 9e ef 07 4a 9a eb 88  |......L.3...J...|
+000000b0  39 c6 bf a6 df 0e 07 62  de 32 80 7f 9b a4 b6 6d  |9......b.2.....m|
+000000c0  77 24 9f 5d 4d 1c 53 68  4f f4 7a da 60 5f b4 e5  |w$.]M.ShO.z.`_..|
+000000d0  61 06 e6 bd 52 15                                 |a...R.|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 85 9f 5f d6 b1  |............._..|
-00000020  f2 c9 ad b8 01 16 9f 20  b1 41 06 f4 6d 44 b5 6d  |....... .A..mD.m|
-00000030  0a 68 d0 e3 6a 24 66 de  39 f1 7a d9 81 5e f7 d4  |.h..j$f.9.z..^..|
-00000040  36 e6 11 12 f6 0f 01 ef  6e af 0d 17 03 03 00 40  |6.......n......@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 2d 65 c0 13 cf  |...........-e...|
+00000020  c5 4e 83 5b c3 6a d9 65  e8 b1 38 16 47 94 61 06  |.N.[.j.e..8.G.a.|
+00000030  28 da 6e 60 c0 0c d8 31  f5 61 58 55 b2 24 61 9a  |(.n`...1.aXU.$a.|
+00000040  21 cb 64 31 3a 08 bb 29  1b 98 f8 17 03 03 00 40  |!.d1:..).......@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  b4 b8 fe 91 27 cb 85 b3  4c 2c 42 8e ce c0 17 40  |....'...L,B....@|
-00000070  82 34 21 c6 fe b6 c8 90  07 d2 a7 5e f2 01 34 ed  |.4!........^..4.|
-00000080  0a 51 33 af 4b 72 80 49  4b d1 a1 02 99 f5 26 3d  |.Q3.Kr.IK.....&=|
+00000060  71 cd f8 e4 7d dd 2c 03  a5 c9 11 ff 11 d2 19 fd  |q...}.,.........|
+00000070  69 fa 88 a6 f2 cb 64 43  56 e0 d5 a6 eb d4 17 50  |i.....dCV......P|
+00000080  89 dd 34 3c 5d 1e 80 35  06 e9 c3 a0 11 83 41 cc  |..4<]..5......A.|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 63 81 63  33 d1 2b db 09 8b b6 57  |.....c.c3.+....W|
-000000b0  54 c9 34 e8 56 e4 e3 b4  86 90 d5 86 df 71 a9 85  |T.4.V........q..|
-000000c0  56 be d5 9c b8                                    |V....|
+000000a0  00 00 00 00 00 a1 31 41  88 62 af e7 df b9 9a 3b  |......1A.b.....;|
+000000b0  d7 8a f0 11 0c 2f 9b 6d  c5 91 cf 9f 51 a0 c1 06  |...../.m....Q...|
+000000c0  e4 3f da 7b 7a                                    |.?.{z|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificate b/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificate
index e1f46c3268..50b6840e60 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificate
+++ b/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificate
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 71 01 00 00  6d 03 03 ad e2 aa a7 cf  |....q...m.......|
-00000010  1c a3 74 6b a5 fb 38 80  57 ef 86 1e 67 50 df 44  |..tk..8.W...gP.D|
-00000020  f2 02 60 01 b5 6f 60 c7  25 1f 6e 00 00 04 00 2f  |..`..o`.%.n..../|
+00000000  16 03 01 00 71 01 00 00  6d 03 03 79 aa a3 4c 5e  |....q...m..y..L^|
+00000010  d3 2a f5 2a 49 d4 18 09  b0 60 b3 8b 5f 36 6e 55  |.*.*I....`.._6nU|
+00000020  9c 96 95 b5 d1 63 02 38  06 c2 21 00 00 04 00 2f  |.....c.8..!..../|
 00000030  00 ff 01 00 00 40 00 00  00 10 00 0e 00 00 0b 73  |.....@.........s|
 00000040  6e 69 74 65 73 74 2e 63  6f 6d 00 0d 00 20 00 1e  |nitest.com... ..|
 00000050  06 01 06 02 06 03 05 01  05 02 05 03 04 01 04 02  |................|
@@ -51,31 +51,31 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 81 d4 77 fd 52  |.............w.R|
-00000010  f9 35 bd de 30 cd c9 6a  ec 57 97 e3 51 14 3f d4  |.5..0..j.W..Q.?.|
-00000020  b2 34 8f 2e f3 d1 f5 31  84 7c 9f cd 59 14 93 18  |.4.....1.|..Y...|
-00000030  9d e4 19 09 f2 55 cb ed  29 90 54 69 43 24 aa d7  |.....U..).TiC$..|
-00000040  9c a8 04 cd 25 e2 b1 d7  f1 15 32 3a 59 82 2c 1a  |....%.....2:Y.,.|
-00000050  bc 3b ab bf 68 aa 93 6f  b3 46 b9 fd d9 5e 33 0d  |.;..h..o.F...^3.|
-00000060  7f 02 24 5e 04 5e 49 40  36 ab a9 8a c0 dd d2 07  |..$^.^I@6.......|
-00000070  0e d8 a2 22 1a f5 e0 59  a6 16 64 76 de b3 00 d9  |..."...Y..dv....|
-00000080  a0 56 74 b4 10 6f 7f e4  b6 d1 60 14 03 03 00 01  |.Vt..o....`.....|
-00000090  01 16 03 03 00 40 63 b4  75 30 a8 65 b3 a5 00 59  |.....@c.u0.e...Y|
-000000a0  08 be 07 6f 6a 3d 0b 30  da 78 7d 93 69 56 0b b9  |...oj=.0.x}.iV..|
-000000b0  37 27 48 fc 50 b4 90 7c  4a d3 4b 0c a5 1e b5 1a  |7'H.P..|J.K.....|
-000000c0  2b 55 7f 32 04 0d 38 ac  16 3b 49 df ca 2e 9b 4d  |+U.2..8..;I....M|
-000000d0  c4 0e f7 77 c4 9d                                 |...w..|
+00000000  16 03 03 00 86 10 00 00  82 00 80 06 73 7f 8c 53  |............s..S|
+00000010  81 65 a2 7d 94 f3 dd 38  37 ed 17 8d e5 c4 c0 62  |.e.}...87......b|
+00000020  b8 73 49 e3 91 19 72 af  e3 bf 64 20 40 65 fb 0e  |.sI...r...d @e..|
+00000030  83 72 54 c9 73 ad 2b c9  86 0e d3 7c 8d 82 13 fb  |.rT.s.+....|....|
+00000040  5c 61 61 c5 04 2d 8b c9  55 2f 3e 64 c1 af ba 22  |\aa..-..U/>d..."|
+00000050  1b 6b 26 42 62 f9 e9 e0  3b 91 c7 62 77 ee bf ec  |.k&Bb...;..bw...|
+00000060  03 2f 94 74 42 c2 48 e9  08 89 a9 b4 9f aa f6 d4  |./.tB.H.........|
+00000070  00 fe d9 a4 b2 38 88 b9  8d 60 26 f6 c3 d7 6e ed  |.....8...`&...n.|
+00000080  13 17 46 bf 53 5a 0b 9c  29 4b 1a 14 03 03 00 01  |..F.SZ..)K......|
+00000090  01 16 03 03 00 40 97 ce  83 9d 12 fe 16 f4 26 9c  |.....@........&.|
+000000a0  ac a7 02 0a a9 e6 71 b6  8a 6f 8c 2c d2 5b e7 72  |......q..o.,.[.r|
+000000b0  45 8f e3 56 21 f0 a8 c9  2c ae db 17 88 3b 33 82  |E..V!...,....;3.|
+000000c0  2c 8f 5f ca 33 be 5a ca  13 13 0a 7b a9 72 cc 72  |,._.3.Z....{.r.r|
+000000d0  07 ff c0 c3 7a ef                                 |....z.|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 a1 f3 cb 74 1a  |..............t.|
-00000020  21 65 72 3e f0 50 54 fb  28 b1 dd 0f 0f ce 68 fd  |!er>.PT.(.....h.|
-00000030  a6 2b e6 0f 5e e9 99 85  c6 b8 8e 08 d6 ad 49 bc  |.+..^.........I.|
-00000040  5b 99 66 3d 31 55 f5 c8  24 8f 50 17 03 03 00 40  |[.f=1U..$.P....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 d6 0c 58 67 cc  |.............Xg.|
+00000020  1d d7 70 79 a9 fc 71 23  7f 3f 02 83 64 1c 30 62  |..py..q#.?..d.0b|
+00000030  c8 23 1f f8 30 9d 1a 5e  ad 96 39 2d d3 b0 7d 17  |.#..0..^..9-..}.|
+00000040  7c 8f 10 ee a3 a1 88 0e  66 37 03 17 03 03 00 40  ||.......f7.....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  40 7a c9 4b fb ec d9 86  ec 6a 6e c1 1d e3 a6 2a  |@z.K.....jn....*|
-00000070  da f8 c6 d4 32 27 bf b3  f6 ad 82 a0 e7 7d 4b f2  |....2'.......}K.|
-00000080  73 92 c6 ef 80 9a b8 84  ba 65 e5 53 01 2c 83 5f  |s........e.S.,._|
+00000060  5f da fe 30 21 c9 a4 85  4b a4 0a a6 93 74 ae 92  |_..0!...K....t..|
+00000070  d5 88 9b 39 1a 7e fe 9f  00 19 ad fb ba 7e bd c1  |...9.~.......~..|
+00000080  0a ea 4f 40 3b 76 a0 83  8f f7 77 1f 4d b9 ec c6  |..O@;v....w.M...|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 89 9d a2  ee 1c cd ee cb 79 55 e5  |.............yU.|
-000000b0  22 94 11 6c b2 b1 db 5e  0a 37 3d 92 01 01 ee 09  |"..l...^.7=.....|
-000000c0  e6 80 48 e2 c9                                    |..H..|
+000000a0  00 00 00 00 00 e6 81 5b  64 4f 8b bc 47 0b 5d 24  |.......[dO..G.]$|
+000000b0  a8 f9 39 82 25 84 4d 57  9d ac 90 d0 3b 6c 4f f0  |..9.%.MW....;lO.|
+000000c0  e1 1c 2c 5a 3e                                    |..,Z>|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificateNotFound b/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificateNotFound
index 181a9abfc8..d3ef005bc8 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificateNotFound
+++ b/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificateNotFound
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 71 01 00 00  6d 03 03 3f de 5d 94 64  |....q...m..?.].d|
-00000010  21 fd 53 6e f0 fe 81 99  4d ac 16 42 e6 92 db dd  |!.Sn....M..B....|
-00000020  36 6a d8 4e 94 c3 0a a7  3c 6a 2a 00 00 04 00 2f  |6j.N....<j*..../|
+00000000  16 03 01 00 71 01 00 00  6d 03 03 4b 5c 12 23 9d  |....q...m..K\.#.|
+00000010  76 5b 5b 5a 1d dd 71 96  49 fb 11 a8 94 24 7e 0e  |v[[Z..q.I....$~.|
+00000020  39 a4 ba 09 eb 56 1e 04  d7 11 0b 00 00 04 00 2f  |9....V........./|
 00000030  00 ff 01 00 00 40 00 00  00 10 00 0e 00 00 0b 73  |.....@.........s|
 00000040  6e 69 74 65 73 74 2e 63  6f 6d 00 0d 00 20 00 1e  |nitest.com... ..|
 00000050  06 01 06 02 06 03 05 01  05 02 05 03 04 01 04 02  |................|
@@ -51,31 +51,31 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 8f 1f 52 21 82  |.............R!.|
-00000010  f8 5f 48 ca f4 17 36 2f  4b 92 d9 ee cf 73 41 97  |._H...6/K....sA.|
-00000020  25 8c e5 a5 d0 33 55 f0  e9 f1 d1 7f fd ed fc 46  |%....3U........F|
-00000030  0d a1 f8 fe 39 7b 78 39  4e 47 26 b1 c6 ce ea 34  |....9{x9NG&....4|
-00000040  f2 59 2f ea b6 21 ac 14  5f 2c 3b 36 4a 9a 89 d2  |.Y/..!.._,;6J...|
-00000050  00 df e8 e8 ba d4 dd 90  d1 98 ff 9d a0 d2 b9 c1  |................|
-00000060  a8 41 3b ed 89 40 9a 15  e8 07 e6 5a 77 d3 d4 8c  |.A;..@.....Zw...|
-00000070  a9 00 a6 5d b4 db 15 cd  59 9d ee f3 85 c0 66 12  |...]....Y.....f.|
-00000080  ba 67 fe b9 40 5b 17 80  78 35 49 14 03 03 00 01  |.g..@[..x5I.....|
-00000090  01 16 03 03 00 40 73 e4  be 74 13 2b 52 eb c6 25  |.....@s..t.+R..%|
-000000a0  b8 8d 07 e7 ad cb 13 ff  1b ab 61 e7 60 b0 d7 ec  |..........a.`...|
-000000b0  b6 35 d9 a9 82 84 79 3c  09 57 a6 d6 26 c6 54 4b  |.5....y<.W..&.TK|
-000000c0  16 c4 e1 84 df 9d 13 4f  b2 6c 95 b6 a5 2c 3d 63  |.......O.l...,=c|
-000000d0  a0 ab db c4 c6 2c                                 |.....,|
+00000000  16 03 03 00 86 10 00 00  82 00 80 1c fa 6e 9f 45  |.............n.E|
+00000010  74 2e 9b 55 71 0c ba d2  4f 16 62 54 ad 9e 75 77  |t..Uq...O.bT..uw|
+00000020  7e 76 72 0d c5 4d d0 f8  05 0a e9 07 be d7 f3 62  |~vr..M.........b|
+00000030  82 10 14 49 0e 06 38 ff  01 db ac 11 5f 59 b2 ea  |...I..8....._Y..|
+00000040  37 35 3e ae f7 9b 0d bd  8a 16 f5 e2 2b a2 77 b2  |75>.........+.w.|
+00000050  3e cc 75 f6 29 90 d9 c3  4b 3a 1a 75 49 dc c1 30  |>.u.)...K:.uI..0|
+00000060  5e 24 df f5 0f 54 52 33  1b 05 ea df 05 cc fa 0d  |^$...TR3........|
+00000070  f7 42 00 89 1a 6c ea a3  da 63 ef 32 e1 15 b9 c3  |.B...l...c.2....|
+00000080  d2 c5 94 96 fc fd f3 1c  97 0b 1c 14 03 03 00 01  |................|
+00000090  01 16 03 03 00 40 e8 66  12 ca f5 37 2f db c9 03  |.....@.f...7/...|
+000000a0  f1 ef 3e 9c 01 b0 ae a3  11 a2 78 41 63 31 12 38  |..>.......xAc1.8|
+000000b0  6c 8a 59 81 9e a4 a8 da  f0 fb 5f 6f d0 14 ae 18  |l.Y......._o....|
+000000c0  68 f7 8a 0a c7 a1 2e 63  42 b7 9f bd 03 cb c5 6d  |h......cB......m|
+000000d0  f9 39 f9 95 a8 16                                 |.9....|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 54 ef 5e a4 7c  |...........T.^.||
-00000020  61 ca e9 6c 23 b3 7e ac  e5 dc ee a0 67 e7 b1 4a  |a..l#.~.....g..J|
-00000030  4e bd d1 6e 1b 7d 37 10  02 ba 9c 67 54 0a cb fa  |N..n.}7....gT...|
-00000040  ed c5 db 07 a3 21 9a 16  71 3d 6e 17 03 03 00 40  |.....!..q=n....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 3a 4c df 03 f5  |...........:L...|
+00000020  8d 52 86 04 3a e2 e4 93  ab 53 24 c6 ba 35 67 8d  |.R..:....S$..5g.|
+00000030  dd f8 f3 23 0a e9 77 ee  91 ff 55 08 55 de 85 ab  |...#..w...U.U...|
+00000040  82 37 8f 25 50 b9 10 e9  0a ec 74 17 03 03 00 40  |.7.%P.....t....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  a5 bd 15 cb 51 43 97 ec  6b c0 1d 29 8d 48 cb df  |....QC..k..).H..|
-00000070  d0 8b dc 1a 0b 01 d9 74  4d 22 bd 91 4c 1f b2 56  |.......tM"..L..V|
-00000080  37 23 dc 4a 33 1e a5 ff  79 80 f2 f9 c3 82 ca 67  |7#.J3...y......g|
+00000060  d9 16 96 1d 60 ac 73 7b  06 1d 8b 53 05 4b eb 4b  |....`.s{...S.K.K|
+00000070  fe 6d fd 6f a7 08 57 68  a6 23 63 b4 dc 32 f4 e3  |.m.o..Wh.#c..2..|
+00000080  10 85 cf 3d 8b e7 dc 7d  3a bc f8 3b 2f 27 60 03  |...=...}:..;/'`.|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 72 fe 8c  2d fb dd 85 d6 c2 af 72  |.....r..-......r|
-000000b0  00 62 3c ae e1 75 6d 9f  ed e9 fa 6a b9 22 1b ba  |.b<..um....j."..|
-000000c0  df 0c d7 25 f1                                    |...%.|
+000000a0  00 00 00 00 00 96 c0 82  ff 64 89 19 76 7e f5 e7  |.........d..v~..|
+000000b0  95 31 76 76 f2 2b a7 c3  f0 4b 5f ec 9b e4 06 73  |.1vv.+...K_....s|
+000000c0  15 7b 7f d3 35                                    |.{..5|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-X25519-ECDHE-RSA-AES-GCM b/src/crypto/tls/testdata/Server-TLSv12-X25519-ECDHE-RSA-AES-GCM
index c2c0199a08..e84bd94946 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-X25519-ECDHE-RSA-AES-GCM
+++ b/src/crypto/tls/testdata/Server-TLSv12-X25519-ECDHE-RSA-AES-GCM
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 73 01 00 00  6f 03 03 c5 04 fb 19 85  |....s...o.......|
-00000010  7c 1d 96 0a 68 50 5d f9  03 4d be d6 62 e0 ba 08  ||...hP]..M..b...|
-00000020  8e 36 d5 4e ed ed 1a 63  72 eb 94 00 00 04 c0 2f  |.6.N...cr....../|
+00000000  16 03 01 00 73 01 00 00  6f 03 03 56 96 0f 18 d8  |....s...o..V....|
+00000010  69 34 8a 58 8b 70 1e aa  b1 0d 73 72 5a 18 3b 2c  |i4.X.p....srZ.;,|
+00000020  ef 9a f6 ee c9 83 af af  1f e1 04 00 00 04 c0 2f  |.............../|
 00000030  00 ff 01 00 00 42 00 0b  00 04 03 00 01 02 00 0a  |.....B..........|
 00000040  00 0a 00 08 00 1d 00 17  00 19 00 18 00 0d 00 20  |............... |
 00000050  00 1e 06 01 06 02 06 03  05 01 05 02 05 03 04 01  |................|
@@ -52,28 +52,28 @@
 00000290  3b e9 fa e7 16 03 03 00  ac 0c 00 00 a8 03 00 1d  |;...............|
 000002a0  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
 000002b0  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-000002c0  74 05 01 00 80 93 b5 4c  a5 01 aa c4 dd ab de 51  |t......L.......Q|
-000002d0  16 79 81 b3 61 06 88 4c  56 4f ad 10 89 a4 95 62  |.y..a..LVO.....b|
-000002e0  4e be bb c0 a2 13 31 1d  29 aa c1 d4 c5 ac b1 39  |N.....1.)......9|
-000002f0  9d 23 07 ba b9 a1 5e 00  ed e2 32 bb 2b 7c 7f e8  |.#....^...2.+|..|
-00000300  81 c0 bf 22 6a 99 e7 1a  f8 88 08 80 ba e3 2d c6  |..."j.........-.|
-00000310  64 7b c6 f1 c5 3f 86 a8  0d 61 bb df 46 43 b2 72  |d{...?...a..FC.r|
-00000320  4f ef 00 13 15 d1 4a 5d  66 82 88 76 26 b8 9f ee  |O.....J]f..v&...|
-00000330  c5 fb 39 55 16 11 79 3e  ef 52 80 b7 3e 8f 0d 9f  |..9U..y>.R..>...|
-00000340  59 6a 23 1a 75 16 03 03  00 04 0e 00 00 00        |Yj#.u.........|
+000002c0  74 05 01 00 80 d7 92 17  d2 86 e1 9c 49 01 f6 55  |t...........I..U|
+000002d0  c1 8e 5d a6 71 84 1e 3a  ab 39 0f 6a 08 32 22 c9  |..].q..:.9.j.2".|
+000002e0  4a 42 73 cc a3 1f 1f 40  61 05 a8 5d a5 2e 0a 11  |JBs....@a..]....|
+000002f0  70 be f3 13 f7 d4 3d e3  ea 8c cf 1d cc 14 cd 97  |p.....=.........|
+00000300  00 95 bd 83 f6 38 65 94  b2 bb 87 61 ce 7c 3b da  |.....8e....a.|;.|
+00000310  b3 dc c6 4c c5 9d ca f3  3e dc 08 39 16 ac aa c7  |...L....>..9....|
+00000320  5c a9 d4 94 f1 f0 ca a6  e3 cb 6e e7 9a 85 8b 7f  |\.........n.....|
+00000330  15 cb 7e 0d b8 f8 ab 7f  e4 ed 6b 21 de 64 f7 e3  |..~.......k!.d..|
+00000340  69 9f 8c 4d a4 16 03 03  00 04 0e 00 00 00        |i..M..........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 c5 a2 cd 04 66 cf  |....%...! ....f.|
-00000010  18 3a c6 55 7c 23 87 f2  e9 1e 08 d1 77 17 1d ee  |.:.U|#......w...|
-00000020  ea 46 48 b2 f1 a6 00 90  d0 0b 14 03 03 00 01 01  |.FH.............|
-00000030  16 03 03 00 28 f6 13 89  ff 83 6a 6f 2c 9e d4 49  |....(.....jo,..I|
-00000040  0d 1b 28 68 00 e4 fb f7  61 a3 e6 61 c7 12 1d 87  |..(h....a..a....|
-00000050  65 23 77 0a 47 fe 82 74  09 1b c1 05 e7           |e#w.G..t.....|
+00000000  16 03 03 00 25 10 00 00  21 20 91 0e 49 63 be 46  |....%...! ..Ic.F|
+00000010  31 e4 49 bb 7d c2 07 80  84 44 57 96 09 58 63 8f  |1.I.}....DW..Xc.|
+00000020  de f2 ab bc d9 d3 06 26  56 5c 14 03 03 00 01 01  |.......&V\......|
+00000030  16 03 03 00 28 98 e0 60  00 e5 4a 41 c2 e2 61 c9  |....(..`..JA..a.|
+00000040  ff 8f 84 6f e4 3d bb a5  65 6d c9 12 2b 48 26 11  |...o.=..em..+H&.|
+00000050  9d 3a 81 cc 03 e1 7e 90  1a ba fe 89 50           |.:....~.....P|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 28 00 00 00 00 00  |..........(.....|
-00000010  00 00 00 e3 14 42 2a 28  3c 8a df 74 1a 4f 13 b1  |.....B*(<..t.O..|
-00000020  d8 ec a5 bb 26 02 b1 a9  70 8c e3 81 30 ba 87 c5  |....&...p...0...|
-00000030  45 bf a5 17 03 03 00 25  00 00 00 00 00 00 00 01  |E......%........|
-00000040  29 8f bb c2 42 f4 40 61  d5 fe 04 87 a6 5f 0e 2d  |)...B.@a....._.-|
-00000050  0c ce 9e 2f d6 df be 10  fe 3d 4f d4 72 15 03 03  |.../.....=O.r...|
-00000060  00 1a 00 00 00 00 00 00  00 02 55 da b5 79 7b 1e  |..........U..y{.|
-00000070  be e0 d2 83 40 6f 0c 38  83 a5 6e bd              |....@o.8..n.|
+00000010  00 00 00 17 a9 94 2f 0e  87 92 82 dd 73 8d 52 07  |....../.....s.R.|
+00000020  f7 6f 24 b6 cb a0 2e 3c  63 ec a2 e0 d4 bc 49 9d  |.o$....<c.....I.|
+00000030  08 08 3d 17 03 03 00 25  00 00 00 00 00 00 00 01  |..=....%........|
+00000040  57 5d ae ed 89 fd b1 a8  8c 9c cc ab 42 92 8e 1b  |W]..........B...|
+00000050  83 03 29 be ad e3 25 77  58 ef 15 80 36 15 03 03  |..)...%wX...6...|
+00000060  00 1a 00 00 00 00 00 00  00 02 34 75 6b 24 45 18  |..........4uk$E.|
+00000070  14 11 8a 38 be 71 f7 bf  84 c6 58 41              |...8.q....XA|
