commit ed737fd8cdc1a668027bb5f5dac8879afabcca3b
Author: Keith Randall <khr@golang.org>
Date:   Wed Feb 24 10:29:27 2016 -0800

    [dev.ssa] cmd/compile: fix @ rewrite rules
    
    The @ directive used to read the target block after some value
    structure had already changed.  I don't think it was ever really
    a bug, but it's confusing.
    
    It might fail like this:
    
    (Foo x y) -> @v.Args[0].Block (Bar y (Baz ...))
    
    v.Op = Bar
    v.Args[0] = y
    v.Args[1] = v.Args[0].Block.NewValue(Baz, ...)
    
    That new value is allocated in the block of y, not the
    block of x.
    
    Anyway, read the destination block first so this
    potential bug can't happen.
    
    Change-Id: Ie41d2fc349b35cefaa319fa9327808bcb781b4e2
    Reviewed-on: https://go-review.googlesource.com/19900
    Run-TryBot: Todd Neal <todd@tneal.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Todd Neal <todd@tneal.org>

 src/cmd/compile/internal/ssa/TODO              |  2 --
 src/cmd/compile/internal/ssa/gen/rulegen.go    | 19 ++++++++++---------
 src/cmd/compile/internal/ssa/rewriteAMD64.go   | 18 ++++++++++++------
 src/cmd/compile/internal/ssa/rewritegeneric.go |  7 +++++--
 4 files changed, 27 insertions(+), 19 deletions(-)
