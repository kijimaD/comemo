commit 96d8d3eb3294e85972aed190aec1806ef3c30712
Author: Russ Cox <rsc@golang.org>
Date:   Mon Jun 5 11:19:03 2023 -0400

    cmd/go: handle -C properly during toolchain switches
    
    The -C dir flag was added in Go 1.20.
    This CL adds a new restriction: the -C must appear as the first flag on the command line.
    This restriction makes finding the -C flag robust and matches the general way
    people tend to think about and use the -C flag anyway.
    It may break a few scripts that have been written since Go 1.20
    but hopefully they will not be hard to find and fix.
    (There is no strict compatibility guarantee for the command line.)
    
    For #57001.
    
    Change-Id: Ice2e5982c58d41eabdaef42a80d3624cde2c9873
    Reviewed-on: https://go-review.googlesource.com/c/go/+/500915
    TryBot-Bypass: Russ Cox <rsc@golang.org>
    Reviewed-by: Michael Matloob <matloob@golang.org>

 src/cmd/go/alldocs.go                              |   9 +-
 src/cmd/go/internal/base/base.go                   |  14 +++
 src/cmd/go/internal/base/flag.go                   |  10 +-
 src/cmd/go/internal/vet/vet.go                     |   8 +-
 src/cmd/go/internal/work/build.go                  |   1 +
 src/cmd/go/main.go                                 | 119 ++++++++++++++++-----
 src/cmd/go/testdata/script/chdir.txt               |  10 +-
 .../go/testdata/script/mod_get_exec_toolchain.txt  |  15 +++
 8 files changed, 140 insertions(+), 46 deletions(-)
