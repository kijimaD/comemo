commit 6824765b4b981291712ae6d60702f6f0350f57d5
Author: Filippo Valsorda <filippo@golang.org>
Date:   Mon May 22 10:49:07 2023 +0200

    crypto/tls: add WrapSession and UnwrapSession
    
    There was a bug in TestResumption: the first ExpiredSessionTicket was
    inserting a ticket far in the future, so the second ExpiredSessionTicket
    wasn't actually supposed to fail. However, there was a bug in
    checkForResumption->sendSessionTicket, too: if a session was not resumed
    because it was too old, its createdAt was still persisted in the next
    ticket. The two bugs used to cancel each other out.
    
    For #60105
    Fixes #19199
    
    Change-Id: Ic9b2aab943dcbf0de62b8758a6195319dc286e2f
    Reviewed-on: https://go-review.googlesource.com/c/go/+/496821
    Run-TryBot: Filippo Valsorda <filippo@golang.org>
    TryBot-Result: Gopher Robot <gobot@golang.org>
    Reviewed-by: Roland Shoemaker <roland@golang.org>
    Reviewed-by: Damien Neil <dneil@google.com>

 api/next/60105.txt                       |  4 ++
 src/crypto/tls/common.go                 | 31 +++++++++++
 src/crypto/tls/handshake_client_test.go  |  6 ++-
 src/crypto/tls/handshake_server.go       | 88 ++++++++++++++++++++------------
 src/crypto/tls/handshake_server_tls13.go | 50 +++++++++++++-----
 src/crypto/tls/ticket.go                 | 44 +++++++++++++---
 src/crypto/tls/tls_test.go               | 14 ++++-
 7 files changed, 182 insertions(+), 55 deletions(-)
