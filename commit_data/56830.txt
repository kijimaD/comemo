commit 869da4a2a48555d71f0298caba6385c4d10590ba
Author: Filippo Valsorda <filippo@golang.org>
Date:   Mon May 22 19:23:04 2023 +0200

    crypto/tls: add QUIC 0-RTT APIs
    
    Fixes #60107
    
    Change-Id: I158b1c2d80d8ebb5ed7a8e6f313f69060754e220
    Reviewed-on: https://go-review.googlesource.com/c/go/+/496995
    Reviewed-by: Damien Neil <dneil@google.com>
    Reviewed-by: Roland Shoemaker <roland@golang.org>
    Run-TryBot: Filippo Valsorda <filippo@golang.org>
    Auto-Submit: Filippo Valsorda <filippo@golang.org>
    TryBot-Result: Gopher Robot <gobot@golang.org>
---
 api/next/44886.txt                                 |   6 +-
 api/next/60107.txt                                 |   6 +
 src/crypto/tls/conn.go                             |   2 +-
 src/crypto/tls/handshake_client.go                 |  23 ++
 src/crypto/tls/handshake_client_tls13.go           |  30 ++
 src/crypto/tls/handshake_messages.go               |   9 +
 src/crypto/tls/handshake_messages_test.go          |   9 +
 src/crypto/tls/handshake_server_tls13.go           |  71 +++--
 src/crypto/tls/key_schedule.go                     |   1 +
 src/crypto/tls/quic.go                             |  42 ++-
 src/crypto/tls/quic_test.go                        |   8 +-
 .../testdata/Server-TLSv10-ExportKeyingMaterial    |  76 ++---
 src/crypto/tls/testdata/Server-TLSv12-ALPN         |  64 ++--
 .../tls/testdata/Server-TLSv12-ALPN-Fallback       |  64 ++--
 .../tls/testdata/Server-TLSv12-ALPN-NotConfigured  |  64 ++--
 .../testdata/Server-TLSv12-ExportKeyingMaterial    |  80 ++---
 src/crypto/tls/testdata/Server-TLSv12-IssueTicket  |  74 ++---
 .../testdata/Server-TLSv12-IssueTicketPreDisable   |  74 ++---
 src/crypto/tls/testdata/Server-TLSv12-Resume       |  88 +++---
 .../tls/testdata/Server-TLSv13-AES128-SHA256       | 166 +++++------
 .../tls/testdata/Server-TLSv13-AES256-SHA384       | 172 +++++------
 src/crypto/tls/testdata/Server-TLSv13-ALPN         | 170 ++++++-----
 .../tls/testdata/Server-TLSv13-ALPN-Fallback       | 164 +++++-----
 src/crypto/tls/testdata/Server-TLSv13-ALPN-NoMatch |  27 +-
 .../tls/testdata/Server-TLSv13-ALPN-NotConfigured  | 166 +++++------
 .../tls/testdata/Server-TLSv13-CHACHA20-SHA256     | 166 +++++------
 .../Server-TLSv13-ClientAuthRequestedAndECDSAGiven | 332 ++++++++++-----------
 ...erver-TLSv13-ClientAuthRequestedAndEd25519Given | 268 ++++++++---------
 .../Server-TLSv13-ClientAuthRequestedAndGiven      | 326 ++++++++++----------
 .../Server-TLSv13-ClientAuthRequestedNotGiven      | 178 +++++------
 .../tls/testdata/Server-TLSv13-ECDHE-ECDSA-AES     | 158 +++++-----
 src/crypto/tls/testdata/Server-TLSv13-Ed25519      | 122 ++++----
 .../testdata/Server-TLSv13-ExportKeyingMaterial    | 166 +++++------
 .../tls/testdata/Server-TLSv13-HelloRetryRequest   | 190 ++++++------
 src/crypto/tls/testdata/Server-TLSv13-IssueTicket  | 166 +++++------
 .../testdata/Server-TLSv13-IssueTicketPreDisable   | 166 +++++------
 src/crypto/tls/testdata/Server-TLSv13-P256         | 170 +++++------
 src/crypto/tls/testdata/Server-TLSv13-RSA-RSAPSS   | 166 +++++------
 src/crypto/tls/testdata/Server-TLSv13-Resume       |  84 +++---
 .../Server-TLSv13-Resume-HelloRetryRequest         | 131 ++++----
 src/crypto/tls/testdata/Server-TLSv13-X25519       | 166 +++++------
 src/crypto/tls/ticket.go                           |  40 ++-
 42 files changed, 2416 insertions(+), 2235 deletions(-)

diff --git a/api/next/44886.txt b/api/next/44886.txt
index b3ab6996ea..4effaf2541 100644
--- a/api/next/44886.txt
+++ b/api/next/44886.txt
@@ -1,10 +1,10 @@
-pkg crypto/tls, const QUICEncryptionLevelApplication = 2 #44886
+pkg crypto/tls, const QUICEncryptionLevelApplication = 3 #44886
 pkg crypto/tls, const QUICEncryptionLevelApplication QUICEncryptionLevel #44886
-pkg crypto/tls, const QUICEncryptionLevelHandshake = 1 #44886
+pkg crypto/tls, const QUICEncryptionLevelHandshake = 2 #44886
 pkg crypto/tls, const QUICEncryptionLevelHandshake QUICEncryptionLevel #44886
 pkg crypto/tls, const QUICEncryptionLevelInitial = 0 #44886
 pkg crypto/tls, const QUICEncryptionLevelInitial QUICEncryptionLevel #44886
-pkg crypto/tls, const QUICHandshakeDone = 6 #44886
+pkg crypto/tls, const QUICHandshakeDone = 7 #44886
 pkg crypto/tls, const QUICHandshakeDone QUICEventKind #44886
 pkg crypto/tls, const QUICNoEvent = 0 #44886
 pkg crypto/tls, const QUICNoEvent QUICEventKind #44886
diff --git a/api/next/60107.txt b/api/next/60107.txt
new file mode 100644
index 0000000000..9c55f935fc
--- /dev/null
+++ b/api/next/60107.txt
@@ -0,0 +1,6 @@
+pkg crypto/tls, const QUICEncryptionLevelEarly = 1 #60107
+pkg crypto/tls, const QUICEncryptionLevelEarly QUICEncryptionLevel #60107
+pkg crypto/tls, const QUICRejectedEarlyData = 6 #60107
+pkg crypto/tls, const QUICRejectedEarlyData QUICEventKind #60107
+pkg crypto/tls, method (*QUICConn) SendSessionTicket(bool) error #60107
+pkg crypto/tls, type SessionState struct, EarlyData bool #60107
diff --git a/src/crypto/tls/conn.go b/src/crypto/tls/conn.go
index e3607c8fec..1b696183da 100644
--- a/src/crypto/tls/conn.go
+++ b/src/crypto/tls/conn.go
@@ -65,7 +65,7 @@ type Conn struct {
 	// ekm is a closure for exporting keying material.
 	ekm func(label string, context []byte, length int) ([]byte, error)
 	// resumptionSecret is the resumption_master_secret for handling
-	// NewSessionTicket messages. nil if config.SessionTicketsDisabled.
+	// or sending NewSessionTicket messages.
 	resumptionSecret []byte
 
 	// ticketKeys is the set of active session ticket keys for this
diff --git a/src/crypto/tls/handshake_client.go b/src/crypto/tls/handshake_client.go
index 2156e9183b..dd9f206067 100644
--- a/src/crypto/tls/handshake_client.go
+++ b/src/crypto/tls/handshake_client.go
@@ -202,6 +202,16 @@ func (c *Conn) clientHandshake(ctx context.Context) (err error) {
 		return err
 	}
 
+	if hello.earlyData {
+		suite := cipherSuiteTLS13ByID(session.cipherSuite)
+		transcript := suite.hash.New()
+		if err := transcriptMsg(hello, transcript); err != nil {
+			return err
+		}
+		earlyTrafficSecret := suite.deriveSecret(earlySecret, clientEarlyTrafficLabel, transcript)
+		c.quicSetWriteSecret(QUICEncryptionLevelEarly, suite.id, earlyTrafficSecret)
+	}
+
 	// serverHelloMsg is not included in the transcript
 	msg, err := c.readHandshake(nil)
 	if err != nil {
@@ -359,6 +369,19 @@ func (c *Conn) loadSession(hello *clientHelloMsg) (
 		return nil, nil, nil, nil
 	}
 
+	if c.quic != nil && session.EarlyData {
+		// For 0-RTT, the cipher suite has to match exactly, and we need to be
+		// offering the same ALPN.
+		if mutualCipherSuite(hello.cipherSuites, session.cipherSuite) != nil {
+			for _, alpn := range hello.alpnProtocols {
+				if alpn == session.alpnProtocol {
+					hello.earlyData = true
+					break
+				}
+			}
+		}
+	}
+
 	// Set the pre_shared_key extension. See RFC 8446, Section 4.2.11.1.
 	ticketAge := c.config.time().Sub(time.Unix(int64(session.createdAt), 0))
 	identity := pskIdentity{
diff --git a/src/crypto/tls/handshake_client_tls13.go b/src/crypto/tls/handshake_client_tls13.go
index b26992b19e..06530ae559 100644
--- a/src/crypto/tls/handshake_client_tls13.go
+++ b/src/crypto/tls/handshake_client_tls13.go
@@ -281,6 +281,11 @@ func (hs *clientHandshakeStateTLS13) processHelloRetryRequest() error {
 		}
 	}
 
+	if hs.hello.earlyData {
+		hs.hello.earlyData = false
+		c.quicRejectedEarlyData()
+	}
+
 	if _, err := hs.c.writeHandshakeRecord(hs.hello, hs.transcript); err != nil {
 		return err
 	}
@@ -455,6 +460,24 @@ func (hs *clientHandshakeStateTLS13) readServerParameters() error {
 		}
 	}
 
+	if !hs.hello.earlyData && encryptedExtensions.earlyData {
+		c.sendAlert(alertUnsupportedExtension)
+		return errors.New("tls: server sent an unexpected early_data extension")
+	}
+	if hs.hello.earlyData && !encryptedExtensions.earlyData {
+		c.quicRejectedEarlyData()
+	}
+	if encryptedExtensions.earlyData {
+		if hs.session.cipherSuite != c.cipherSuite {
+			c.sendAlert(alertHandshakeFailure)
+			return errors.New("tls: server accepted 0-RTT with the wrong cipher suite")
+		}
+		if hs.session.alpnProtocol != c.clientProtocol {
+			c.sendAlert(alertHandshakeFailure)
+			return errors.New("tls: server accepted 0-RTT with the wrong ALPN")
+		}
+	}
+
 	return nil
 }
 
@@ -715,6 +738,12 @@ func (c *Conn) handleNewSessionTicket(msg *newSessionTicketMsgTLS13) error {
 		return errors.New("tls: received a session ticket with invalid lifetime")
 	}
 
+	// RFC 9001, Section 4.6.1
+	if c.quic != nil && msg.maxEarlyData != 0 && msg.maxEarlyData != 0xffffffff {
+		c.sendAlert(alertIllegalParameter)
+		return errors.New("tls: invalid early data for QUIC connection")
+	}
+
 	cipherSuite := cipherSuiteTLS13ByID(c.cipherSuite)
 	if cipherSuite == nil || c.resumptionSecret == nil {
 		return c.sendAlert(alertInternalError)
@@ -731,6 +760,7 @@ func (c *Conn) handleNewSessionTicket(msg *newSessionTicketMsgTLS13) error {
 	session.secret = psk
 	session.useBy = uint64(c.config.time().Add(lifetime).Unix())
 	session.ageAdd = msg.ageAdd
+	session.EarlyData = c.quic != nil && msg.maxEarlyData == 0xffffffff // RFC 9001, Section 4.6.1
 	cs := &ClientSessionState{ticket: msg.label, session: session}
 
 	if cacheKey := c.clientSessionCacheKey(); cacheKey != "" {
diff --git a/src/crypto/tls/handshake_messages.go b/src/crypto/tls/handshake_messages.go
index eac01fd085..70871b9a90 100644
--- a/src/crypto/tls/handshake_messages.go
+++ b/src/crypto/tls/handshake_messages.go
@@ -876,6 +876,7 @@ type encryptedExtensionsMsg struct {
 	raw                     []byte
 	alpnProtocol            string
 	quicTransportParameters []byte
+	earlyData               bool
 }
 
 func (m *encryptedExtensionsMsg) marshal() ([]byte, error) {
@@ -904,6 +905,11 @@ func (m *encryptedExtensionsMsg) marshal() ([]byte, error) {
 					b.AddBytes(m.quicTransportParameters)
 				})
 			}
+			if m.earlyData {
+				// RFC 8446, Section 4.2.10
+				b.AddUint16(extensionEarlyData)
+				b.AddUint16(0) // empty extension_data
+			}
 		})
 	})
 
@@ -947,6 +953,9 @@ func (m *encryptedExtensionsMsg) unmarshal(data []byte) bool {
 			if !extData.CopyBytes(m.quicTransportParameters) {
 				return false
 			}
+		case extensionEarlyData:
+			// RFC 8446, Section 4.2.10
+			m.earlyData = true
 		default:
 			// Ignore unknown extensions.
 			continue
diff --git a/src/crypto/tls/handshake_messages_test.go b/src/crypto/tls/handshake_messages_test.go
index 1536e75fdd..2785116935 100644
--- a/src/crypto/tls/handshake_messages_test.go
+++ b/src/crypto/tls/handshake_messages_test.go
@@ -264,6 +264,9 @@ func (*encryptedExtensionsMsg) Generate(rand *rand.Rand, size int) reflect.Value
 	if rand.Intn(10) > 5 {
 		m.alpnProtocol = randomString(rand.Intn(32)+1, rand)
 	}
+	if rand.Intn(10) > 5 {
+		m.earlyData = true
+	}
 
 	return reflect.ValueOf(m)
 }
@@ -347,6 +350,9 @@ func (*SessionState) Generate(rand *rand.Rand, size int) reflect.Value {
 	s.createdAt = uint64(rand.Int63())
 	s.secret = randomBytes(rand.Intn(100)+1, rand)
 	s.Extra = randomBytes(rand.Intn(100), rand)
+	if rand.Intn(10) > 5 {
+		s.EarlyData = true
+	}
 	if s.isClient || rand.Intn(10) > 5 {
 		if rand.Intn(10) > 5 {
 			s.peerCertificates = sessionTestCerts
@@ -362,6 +368,9 @@ func (*SessionState) Generate(rand *rand.Rand, size int) reflect.Value {
 			s.scts = append(s.scts, randomBytes(rand.Intn(500)+1, rand))
 		}
 	}
+	if rand.Intn(10) > 5 && s.EarlyData {
+		s.alpnProtocol = string(randomBytes(rand.Intn(10), rand))
+	}
 	if s.isClient {
 		for i := 0; i < rand.Intn(3); i++ {
 			if rand.Intn(10) > 5 {
diff --git a/src/crypto/tls/handshake_server_tls13.go b/src/crypto/tls/handshake_server_tls13.go
index 0b6b16eb12..7cc93c0678 100644
--- a/src/crypto/tls/handshake_server_tls13.go
+++ b/src/crypto/tls/handshake_server_tls13.go
@@ -29,6 +29,7 @@ type serverHandshakeStateTLS13 struct {
 	hello           *serverHelloMsg
 	sentDummyCCS    bool
 	usingPSK        bool
+	earlyData       bool
 	suite           *cipherSuiteTLS13
 	cert            *Certificate
 	sigAlg          SignatureScheme
@@ -139,7 +140,12 @@ func (hs *serverHandshakeStateTLS13) processClientHello() error {
 		return errors.New("tls: initial handshake had non-empty renegotiation extension")
 	}
 
-	if hs.clientHello.earlyData {
+	if hs.clientHello.earlyData && c.quic != nil {
+		if len(hs.clientHello.pskIdentities) == 0 {
+			c.sendAlert(alertIllegalParameter)
+			return errors.New("tls: early_data without pre_shared_key")
+		}
+	} else if hs.clientHello.earlyData {
 		// See RFC 8446, Section 4.2.10 for the complicated behavior required
 		// here. The scenario is that a different server at our address offered
 		// to accept early data in the past, which we can't handle. For now, all
@@ -226,6 +232,13 @@ GroupSelection:
 		return errors.New("tls: invalid client key share")
 	}
 
+	selectedProto, err := negotiateALPN(c.config.NextProtos, hs.clientHello.alpnProtocols, c.quic != nil)
+	if err != nil {
+		c.sendAlert(alertNoApplicationProtocol)
+		return err
+	}
+	c.clientProtocol = selectedProto
+
 	if c.quic != nil {
 		if hs.clientHello.quicTransportParameters == nil {
 			// RFC 9001 Section 8.2.
@@ -306,10 +319,6 @@ func (hs *serverHandshakeStateTLS13) checkForResumption() error {
 			continue
 		}
 
-		// We don't check the obfuscated ticket age because it's affected by
-		// clock skew and it's only a freshness signal useful for shrinking the
-		// window for replay attacks, which don't affect us as we don't do 0-RTT.
-
 		pskSuite := cipherSuiteTLS13ByID(sessionState.cipherSuite)
 		if pskSuite == nil || pskSuite.hash != hs.suite.hash {
 			continue
@@ -347,6 +356,19 @@ func (hs *serverHandshakeStateTLS13) checkForResumption() error {
 			return errors.New("tls: invalid PSK binder")
 		}
 
+		if c.quic != nil && hs.clientHello.earlyData && i == 0 &&
+			sessionState.EarlyData && sessionState.cipherSuite == hs.suite.id &&
+			sessionState.alpnProtocol == c.clientProtocol {
+			hs.earlyData = true
+
+			transcript := hs.suite.hash.New()
+			if err := transcriptMsg(hs.clientHello, transcript); err != nil {
+				return err
+			}
+			earlyTrafficSecret := hs.suite.deriveSecret(hs.earlySecret, clientEarlyTrafficLabel, transcript)
+			c.quicSetReadSecret(QUICEncryptionLevelEarly, hs.suite.id, earlyTrafficSecret)
+		}
+
 		c.didResume = true
 		if err := c.processCertsFromClient(sessionState.certificate()); err != nil {
 			return err
@@ -605,14 +627,7 @@ func (hs *serverHandshakeStateTLS13) sendServerParameters() error {
 	}
 
 	encryptedExtensions := new(encryptedExtensionsMsg)
-
-	selectedProto, err := negotiateALPN(c.config.NextProtos, hs.clientHello.alpnProtocols, c.quic != nil)
-	if err != nil {
-		c.sendAlert(alertNoApplicationProtocol)
-		return err
-	}
-	encryptedExtensions.alpnProtocol = selectedProto
-	c.clientProtocol = selectedProto
+	encryptedExtensions.alpnProtocol = c.clientProtocol
 
 	if c.quic != nil {
 		p, err := c.quicGetTransportParameters()
@@ -620,6 +635,7 @@ func (hs *serverHandshakeStateTLS13) sendServerParameters() error {
 			return err
 		}
 		encryptedExtensions.quicTransportParameters = p
+		encryptedExtensions.earlyData = hs.earlyData
 	}
 
 	if _, err := hs.c.writeHandshakeRecord(encryptedExtensions, hs.transcript); err != nil {
@@ -760,6 +776,11 @@ func (hs *serverHandshakeStateTLS13) shouldSendSessionTickets() bool {
 		return false
 	}
 
+	// QUIC tickets are sent by QUICConn.SendSessionTicket, not automatically.
+	if hs.c.quic != nil {
+		return false
+	}
+
 	// Don't send tickets the client wouldn't use. See RFC 8446, Section 4.2.9.
 	for _, pskMode := range hs.clientHello.pskModes {
 		if pskMode == pskModeDHE {
@@ -780,16 +801,24 @@ func (hs *serverHandshakeStateTLS13) sendSessionTickets() error {
 		return err
 	}
 
+	c.resumptionSecret = hs.suite.deriveSecret(hs.masterSecret,
+		resumptionLabel, hs.transcript)
+
 	if !hs.shouldSendSessionTickets() {
 		return nil
 	}
+	return c.sendSessionTicket(false)
+}
 
-	resumptionSecret := hs.suite.deriveSecret(hs.masterSecret,
-		resumptionLabel, hs.transcript)
+func (c *Conn) sendSessionTicket(earlyData bool) error {
+	suite := cipherSuiteTLS13ByID(c.cipherSuite)
+	if suite == nil {
+		return errors.New("tls: internal error: unknown cipher suite")
+	}
 	// ticket_nonce, which must be unique per connection, is always left at
 	// zero because we only ever send one ticket per connection.
-	psk := hs.suite.expandLabel(resumptionSecret, "resumption",
-		nil, hs.suite.hash.Size())
+	psk := suite.expandLabel(c.resumptionSecret, "resumption",
+		nil, suite.hash.Size())
 
 	m := new(newSessionTicketMsgTLS13)
 
@@ -798,6 +827,7 @@ func (hs *serverHandshakeStateTLS13) sendSessionTickets() error {
 		return err
 	}
 	state.secret = psk
+	state.EarlyData = earlyData
 	if c.config.WrapSession != nil {
 		m.label, err = c.config.WrapSession(c.connectionStateLocked(), state)
 		if err != nil {
@@ -820,12 +850,17 @@ func (hs *serverHandshakeStateTLS13) sendSessionTickets() error {
 	// The value is not stored anywhere; we never need to check the ticket age
 	// because 0-RTT is not supported.
 	ageAdd := make([]byte, 4)
-	_, err = hs.c.config.rand().Read(ageAdd)
+	_, err = c.config.rand().Read(ageAdd)
 	if err != nil {
 		return err
 	}
 	m.ageAdd = binary.LittleEndian.Uint32(ageAdd)
 
+	if earlyData {
+		// RFC 9001, Section 4.6.1
+		m.maxEarlyData = 0xffffffff
+	}
+
 	if _, err := c.writeHandshakeRecord(m, nil); err != nil {
 		return err
 	}
diff --git a/src/crypto/tls/key_schedule.go b/src/crypto/tls/key_schedule.go
index ae8f80a7cf..d7f082c9ee 100644
--- a/src/crypto/tls/key_schedule.go
+++ b/src/crypto/tls/key_schedule.go
@@ -21,6 +21,7 @@ import (
 
 const (
 	resumptionBinderLabel         = "res binder"
+	clientEarlyTrafficLabel       = "c e traffic"
 	clientHandshakeTrafficLabel   = "c hs traffic"
 	serverHandshakeTrafficLabel   = "s hs traffic"
 	clientApplicationTrafficLabel = "c ap traffic"
diff --git a/src/crypto/tls/quic.go b/src/crypto/tls/quic.go
index a59b893738..6cb10df8ba 100644
--- a/src/crypto/tls/quic.go
+++ b/src/crypto/tls/quic.go
@@ -16,6 +16,7 @@ type QUICEncryptionLevel int
 
 const (
 	QUICEncryptionLevelInitial = QUICEncryptionLevel(iota)
+	QUICEncryptionLevelEarly
 	QUICEncryptionLevelHandshake
 	QUICEncryptionLevelApplication
 )
@@ -24,6 +25,8 @@ func (l QUICEncryptionLevel) String() string {
 	switch l {
 	case QUICEncryptionLevelInitial:
 		return "Initial"
+	case QUICEncryptionLevelEarly:
+		return "Early"
 	case QUICEncryptionLevelHandshake:
 		return "Handshake"
 	case QUICEncryptionLevelApplication:
@@ -39,6 +42,8 @@ func (l QUICEncryptionLevel) String() string {
 // Methods of QUICConn are not safe for concurrent use.
 type QUICConn struct {
 	conn *Conn
+
+	sessionTicketSent bool
 }
 
 // A QUICConfig configures a QUICConn.
@@ -79,6 +84,11 @@ const (
 	// connection will never generate a QUICTransportParametersRequired event.
 	QUICTransportParametersRequired
 
+	// QUICRejectedEarlyData indicates that the server rejected 0-RTT data even
+	// if we offered it. It's returned before QUICEncryptionLevelApplication
+	// keys are returned.
+	QUICRejectedEarlyData
+
 	// QUICHandshakeDone indicates that the TLS handshake has completed.
 	QUICHandshakeDone
 )
@@ -106,10 +116,10 @@ type quicState struct {
 	nextEvent int
 
 	// eventArr is a statically allocated event array, large enough to handle
-	// the usual maximum number of events resulting from a single call:
-	// transport parameters, Initial data, Handshake write and read secrets,
-	// Handshake data, Application write secret, Application data.
-	eventArr [7]QUICEvent
+	// the usual maximum number of events resulting from a single call: transport
+	// parameters, Initial data, Early read secret, Handshake write and read
+	// secrets, Handshake data, Application write secret, Application data.
+	eventArr [8]QUICEvent
 
 	started  bool
 	signalc  chan struct{}   // handshake data is available to be read
@@ -236,6 +246,24 @@ func (q *QUICConn) HandleData(level QUICEncryptionLevel, data []byte) error {
 	return nil
 }
 
+// SendSessionTicket sends a session ticket to the client.
+// It produces connection events, which may be read with NextEvent.
+// Currently, it can only be called once.
+func (q *QUICConn) SendSessionTicket(earlyData bool) error {
+	c := q.conn
+	if !c.isHandshakeComplete.Load() {
+		return quicError(errors.New("tls: SendSessionTicket called before handshake completed"))
+	}
+	if c.isClient {
+		return quicError(errors.New("tls: SendSessionTicket called on the client"))
+	}
+	if q.sessionTicketSent {
+		return quicError(errors.New("tls: SendSessionTicket called multiple times"))
+	}
+	q.sessionTicketSent = true
+	return quicError(c.sendSessionTicket(earlyData))
+}
+
 // ConnectionState returns basic TLS details about the connection.
 func (q *QUICConn) ConnectionState() ConnectionState {
 	return q.conn.ConnectionState()
@@ -344,6 +372,12 @@ func (c *Conn) quicHandshakeComplete() {
 	})
 }
 
+func (c *Conn) quicRejectedEarlyData() {
+	c.quic.events = append(c.quic.events, QUICEvent{
+		Kind: QUICRejectedEarlyData,
+	})
+}
+
 // quicWaitForSignal notifies the QUICConn that handshake progress is blocked,
 // and waits for a signal that the handshake should proceed.
 //
diff --git a/src/crypto/tls/quic_test.go b/src/crypto/tls/quic_test.go
index 58054de80d..02503cff82 100644
--- a/src/crypto/tls/quic_test.go
+++ b/src/crypto/tls/quic_test.go
@@ -85,7 +85,8 @@ func (q *testQUICConn) setWriteSecret(level QUICEncryptionLevel, suite uint16, s
 
 var errTransportParametersRequired = errors.New("transport parameters required")
 
-func runTestQUICConnection(ctx context.Context, a, b *testQUICConn, onHandleCryptoData func()) error {
+func runTestQUICConnection(ctx context.Context, cli, srv *testQUICConn, onHandleCryptoData func()) error {
+	a, b := cli, srv
 	for _, c := range []*testQUICConn{a, b} {
 		if !c.conn.conn.quic.started {
 			if err := c.conn.Start(ctx); err != nil {
@@ -123,6 +124,11 @@ func runTestQUICConnection(ctx context.Context, a, b *testQUICConn, onHandleCryp
 			return errTransportParametersRequired
 		case QUICHandshakeDone:
 			a.complete = true
+			if a == srv {
+				if err := srv.conn.SendSessionTicket(false); err != nil {
+					return err
+				}
+			}
 		}
 		if e.Kind != QUICNoEvent {
 			idleCount = 0
diff --git a/src/crypto/tls/testdata/Server-TLSv10-ExportKeyingMaterial b/src/crypto/tls/testdata/Server-TLSv10-ExportKeyingMaterial
index e4acd3b630..d16e1d6970 100644
--- a/src/crypto/tls/testdata/Server-TLSv10-ExportKeyingMaterial
+++ b/src/crypto/tls/testdata/Server-TLSv10-ExportKeyingMaterial
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 55 01 00 00  51 03 01 88 09 31 1b f2  |....U...Q....1..|
-00000010  1b 22 bc f5 54 1d 81 65  72 79 ee 51 6f 4d ba 7b  |."..T..ery.QoM.{|
-00000020  65 d8 94 8c 31 f9 27 83  cd c5 49 00 00 04 c0 14  |e...1.'...I.....|
+00000000  16 03 01 00 55 01 00 00  51 03 01 4a 04 66 d2 7b  |....U...Q..J.f.{|
+00000010  6f 41 ef b3 5f b2 ba af  1f 0e c8 26 93 2b 2b 83  |oA.._......&.++.|
+00000020  75 69 94 8f 6d c7 bf c6  c9 37 2d 00 00 04 c0 14  |ui..m....7-.....|
 00000030  00 ff 01 00 00 24 00 0b  00 04 03 00 01 02 00 0a  |.....$..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000050  00 00 00 16 00 00 00 17  00 00                    |..........|
@@ -50,42 +50,42 @@
 00000290  d4 db fe 3d 13 60 84 5c  21 d3 3b e9 fa e7 16 03  |...=.`.\!.;.....|
 000002a0  01 00 aa 0c 00 00 a6 03  00 1d 20 2f e5 7d a3 47  |.......... /.}.G|
 000002b0  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
-000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 00 80 7a 72 89  |......_X.;t..zr.|
-000002d0  46 c7 31 28 82 75 ec 56  d6 e3 6c 7a 7d 2f 21 23  |F.1(.u.V..lz}/!#|
-000002e0  fb 5c 30 b8 28 5d 32 33  75 6e 4e 47 47 aa 01 0f  |.\0.(]23unNGG...|
-000002f0  14 1c 22 03 a4 ac c5 33  ed 49 23 9c 5c 7e 69 cf  |.."....3.I#.\~i.|
-00000300  d2 0d be a9 0d 41 8b 40  29 30 f9 6d 06 93 d2 2c  |.....A.@)0.m...,|
-00000310  e3 28 cb c2 8f 78 d5 e5  da 9d eb 00 6f a5 47 5d  |.(...x......o.G]|
-00000320  d6 97 61 92 85 bc c2 26  87 b0 fe 97 ff 51 a5 80  |..a....&.....Q..|
-00000330  41 9c 31 9a 5d c3 09 ce  8b 48 c1 23 41 8d 55 84  |A.1.]....H.#A.U.|
-00000340  a1 3e 11 32 b1 de fb 7b  35 32 bb ed e6 16 03 01  |.>.2...{52......|
+000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 00 80 3b 7c 08  |......_X.;t..;|.|
+000002d0  03 13 a9 f1 f3 35 23 03  23 59 6a c7 1b e8 d8 39  |.....5#.#Yj....9|
+000002e0  ad 14 28 33 b8 ab 9f e8  fa 78 d6 9d d4 71 54 dc  |..(3.....x...qT.|
+000002f0  93 31 12 d3 c3 f6 f1 18  ea e1 9a d9 55 14 e3 8d  |.1..........U...|
+00000300  d1 cb b5 40 98 ef c6 bb  3d 6d ea 39 db f9 26 83  |...@....=m.9..&.|
+00000310  88 7c 71 1c f9 f2 47 f1  fc d1 b9 ae 1c d8 7b 2b  |.|q...G.......{+|
+00000320  79 8d 43 76 3d 15 17 3f  90 94 8e c7 45 ae 01 d2  |y.Cv=..?....E...|
+00000330  22 da 9d 03 f7 62 64 a5  0e 33 8b 5c d7 22 65 dd  |"....bd..3.\."e.|
+00000340  34 29 6f 20 d6 66 27 d4  27 e9 2d 5f e6 16 03 01  |4)o .f'.'.-_....|
 00000350  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
-00000000  16 03 01 00 25 10 00 00  21 20 22 9d 12 40 df 4b  |....%...! "..@.K|
-00000010  cf ac 72 de d6 ed 77 75  6a c1 2d b7 1d e1 69 b2  |..r...wuj.-...i.|
-00000020  08 6c 04 8b f3 98 ea 42  ed 47 14 03 01 00 01 01  |.l.....B.G......|
-00000030  16 03 01 00 30 0e 1f 00  ee 0c ee ff e7 e5 86 a0  |....0...........|
-00000040  14 b0 50 d6 0d a1 d5 2b  80 51 70 98 94 fb 38 25  |..P....+.Qp...8%|
-00000050  09 b5 c8 16 21 b8 e5 00  0d 96 56 c0 fa d5 a3 7d  |....!.....V....}|
-00000060  0d 50 93 82 19                                    |.P...|
+00000000  16 03 01 00 25 10 00 00  21 20 99 c5 6e 2d 41 d5  |....%...! ..n-A.|
+00000010  41 d2 c6 96 4c ff 14 10  32 46 b6 8d e8 ea 2a 89  |A...L...2F....*.|
+00000020  f1 7b 9c 59 46 c9 e1 44  0a 7f 14 03 01 00 01 01  |.{.YF..D........|
+00000030  16 03 01 00 30 ff 29 a0  25 25 53 bc fb 94 cb 4e  |....0.).%%S....N|
+00000040  9f 53 29 b5 71 46 12 9a  fb 29 b2 d8 a8 8a 13 17  |.S).qF...)......|
+00000050  dc 88 88 24 8b 16 be c4  19 11 0c 1c 9a 27 fb f7  |...$.........'..|
+00000060  da 91 98 7c c7                                    |...|.|
 >>> Flow 4 (server to client)
-00000000  16 03 01 00 7e 04 00 00  7a 00 00 00 00 00 74 00  |....~...z.....t.|
+00000000  16 03 01 00 7f 04 00 00  7b 00 00 00 00 00 75 00  |........{.....u.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6d 2d 70 97 51 ed 14 ef  68 ca 42 c5 4c 8e 61 3d  |m-p.Q...h.B.L.a=|
-00000030  69 2c 37 a8 27 cd 45 84  ac 4e 96 db 42 38 84 dd  |i,7.'.E..N..B8..|
-00000040  ad f4 5d 57 11 a9 7b 27  c0 7d 2b 2f d5 67 c8 1e  |..]W..{'.}+/.g..|
-00000050  d0 31 3d 46 64 76 91 4a  33 08 4d be 03 49 38 16  |.1=Fdv.J3.M..I8.|
-00000060  7f 51 5c fd af 26 1d d3  f2 3c 6a f1 ac 4d bd c0  |.Q\..&...<j..M..|
-00000070  cb f4 48 da e3 30 36 80  2c ff b7 3a 24 c0 c8 6b  |..H..06.,..:$..k|
-00000080  e7 e7 92 14 03 01 00 01  01 16 03 01 00 30 63 77  |.............0cw|
-00000090  97 7d 25 0f cf 11 d3 71  f3 2e 35 d1 eb 87 94 cc  |.}%....q..5.....|
-000000a0  d2 85 e8 7d 98 a7 1f b0  49 27 cd 32 02 12 dd 47  |...}....I'.2...G|
-000000b0  94 5e 77 ce dd 96 a4 e9  ca c6 e6 fa 51 4b 17 03  |.^w.........QK..|
-000000c0  01 00 20 5f f0 56 1b 19  f0 5c 43 c5 60 52 d1 7e  |.. _.V...\C.`R.~|
-000000d0  a1 5f 2b ff 75 ac 15 2a  3f b4 e2 01 5c 58 70 12  |._+.u..*?...\Xp.|
-000000e0  9e 52 0e 17 03 01 00 30  a3 91 02 02 2a c0 3d 40  |.R.....0....*.=@|
-000000f0  e9 14 ee 4e b9 5e 58 fa  02 e8 eb c8 9b 4b 3c d3  |...N.^X......K<.|
-00000100  c2 ac 6b 2f f6 b1 20 0b  83 15 f4 f9 d4 c8 2b da  |..k/.. .......+.|
-00000110  43 8b 1e 12 01 88 a9 78  15 03 01 00 20 f7 97 dd  |C......x.... ...|
-00000120  20 b3 69 79 2e 81 a8 eb  2e 66 60 15 1b 75 16 ee  | .iy.....f`..u..|
-00000130  0a e8 77 29 6d 77 76 59  16 13 08 2d 0a           |..w)mwvY...-.|
+00000020  6d 2d 70 97 51 ed 14 ef  68 ca 42 c5 4c a2 c9 88  |m-p.Q...h.B.L...|
+00000030  e5 0f 86 1e 3c 6b ae 30  31 14 f0 45 e8 6b d5 9a  |....<k.01..E.k..|
+00000040  ec d5 95 b3 53 58 ec 99  b0 a8 99 3e 6f 99 1e d7  |....SX.....>o...|
+00000050  7a 9c 81 67 e3 33 22 75  60 ce 31 21 f6 49 38 16  |z..g.3"u`.1!.I8.|
+00000060  7f 51 5c e5 ab f1 d6 72  14 6d 02 24 ed 8d 42 63  |.Q\....r.m.$..Bc|
+00000070  74 3e c3 2f f4 75 61 0d  d6 07 bd a3 5c f3 4b ea  |t>./.ua.....\.K.|
+00000080  ce f4 6d 80 14 03 01 00  01 01 16 03 01 00 30 71  |..m...........0q|
+00000090  84 71 e0 23 7e c6 19 76  ad 7d 7f b2 ad f4 2f e2  |.q.#~..v.}..../.|
+000000a0  57 6d 78 73 49 86 67 a0  c6 8c d2 a0 08 9c ba 8c  |WmxsI.g.........|
+000000b0  09 47 03 69 5f 97 cc d2  66 c6 ce f0 e5 9c 88 17  |.G.i_...f.......|
+000000c0  03 01 00 20 8f e4 c8 2a  1b 66 ff 6d 56 e6 8f fb  |... ...*.f.mV...|
+000000d0  9a 08 f4 b3 4d 91 35 c6  6d fc b0 5f c9 ad 7e a3  |....M.5.m.._..~.|
+000000e0  c4 8c fc 47 17 03 01 00  30 1b 33 c8 40 3e 33 ed  |...G....0.3.@>3.|
+000000f0  73 f3 24 32 38 1d e6 72  e1 58 ef 43 54 0f 6d a9  |s.$28..r.X.CT.m.|
+00000100  68 21 10 eb fe 1d 51 d7  56 0f da 11 7c b5 3c ff  |h!....Q.V...|.<.|
+00000110  89 74 28 12 88 14 a7 fb  f2 15 03 01 00 20 ce 95  |.t(.......... ..|
+00000120  1c a0 ae 96 f9 58 0a 0b  26 a2 19 e5 86 80 d2 f4  |.....X..&.......|
+00000130  69 c8 ee bd 6f e1 db c0  67 11 dd a5 c8 f0        |i...o...g.....|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ALPN b/src/crypto/tls/testdata/Server-TLSv12-ALPN
index 5d9172606a..0dc338e2c2 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ALPN
+++ b/src/crypto/tls/testdata/Server-TLSv12-ALPN
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 9d 01 00 00  99 03 03 c4 ca 1b 93 30  |...............0|
-00000010  88 15 e8 01 6e 14 a9 74  3e 94 b0 a0 44 78 7e 1a  |....n..t>...Dx~.|
-00000020  cb 23 2c 44 d4 74 dd 20  d7 43 bc 00 00 04 cc a8  |.#,D.t. .C......|
+00000000  16 03 01 00 9d 01 00 00  99 03 03 a8 f7 f4 62 fd  |..............b.|
+00000010  2b d9 41 3a 08 1f a3 b9  94 bf 2f fc 54 fc bf 65  |+.A:....../.T..e|
+00000020  c6 5a e9 8d fc cd 72 b8  55 37 85 00 00 04 cc a8  |.Z....r.U7......|
 00000030  00 ff 01 00 00 6c 00 0b  00 04 03 00 01 02 00 0a  |.....l..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000050  00 00 00 10 00 10 00 0e  06 70 72 6f 74 6f 32 06  |.........proto2.|
@@ -56,36 +56,36 @@
 000002a0  3d 13 60 84 5c 21 d3 3b  e9 fa e7 16 03 03 00 ac  |=.`.\!.;........|
 000002b0  0c 00 00 a8 03 00 1d 20  2f e5 7d a3 47 cd 62 43  |....... /.}.G.bC|
 000002c0  15 28 da ac 5f bb 29 07  30 ff f6 84 af c4 cf c2  |.(.._.).0.......|
-000002d0  ed 90 99 5f 58 cb 3b 74  08 04 00 80 47 0f 58 60  |..._X.;t....G.X`|
-000002e0  7a 20 b5 47 15 dd 83 63  e0 07 ec 4f 50 fe de 32  |z .G...c...OP..2|
-000002f0  64 13 12 00 84 6c 94 a7  ac 16 8c 76 93 0f 72 ae  |d....l.....v..r.|
-00000300  3b c8 50 d6 9e 94 b8 62  38 65 89 fa e4 3e ba 89  |;.P....b8e...>..|
-00000310  f2 2f e8 09 15 7e fc ac  c0 b7 1b 90 6e d6 4a 29  |./...~......n.J)|
-00000320  ff f8 50 aa be 74 ec 94  08 2c 97 5e a9 9c a9 73  |..P..t...,.^...s|
-00000330  02 8c 58 4c e2 ed 7d e6  47 42 64 d3 1c c7 69 ed  |..XL..}.GBd...i.|
-00000340  97 7d af bc 36 19 e8 0b  5a 4a 9c 0b c8 4a a3 69  |.}..6...ZJ...J.i|
-00000350  d0 5b d0 19 7d 83 36 ca  d3 1c a1 13 16 03 03 00  |.[..}.6.........|
+000002d0  ed 90 99 5f 58 cb 3b 74  08 04 00 80 4f 05 7c c3  |..._X.;t....O.|.|
+000002e0  96 ca f9 10 21 59 a9 2a  63 fc be b5 cf 4d 0c 01  |....!Y.*c....M..|
+000002f0  a2 4a 6a 3d 29 aa b1 bf  eb 7a aa 22 a3 4e b4 db  |.Jj=)....z.".N..|
+00000300  c8 e5 4c d2 3f b1 3a 04  90 11 3b aa 2d be c9 20  |..L.?.:...;.-.. |
+00000310  42 f0 2a 43 d4 33 3d d3  5e bb e6 59 87 5d 04 c7  |B.*C.3=.^..Y.]..|
+00000320  a5 32 75 51 b6 55 18 4d  29 72 2d cc 17 12 08 f4  |.2uQ.U.M)r-.....|
+00000330  bf cf 61 2a 67 59 e0 8f  9f c9 57 8a a0 7e 1e bd  |..a*gY....W..~..|
+00000340  2e 06 3d 0c 1f b2 83 50  08 8f 88 40 5d 9d a8 3d  |..=....P...@]..=|
+00000350  93 e9 cc 70 8a 05 ab a5  af cd 75 81 16 03 03 00  |...p......u.....|
 00000360  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 d9 5c 9d ec db b5  |....%...! .\....|
-00000010  4b a0 c7 46 36 f0 82 b9  de b7 52 55 d5 b4 d1 a0  |K..F6.....RU....|
-00000020  1a 85 30 ec 0b 2e 2c 9d  f8 7e 14 03 03 00 01 01  |..0...,..~......|
-00000030  16 03 03 00 20 a8 c5 50  45 f2 63 37 59 c2 59 91  |.... ..PE.c7Y.Y.|
-00000040  85 6f 3d 10 5f 08 7b d4  da 7d de 78 23 8c ae 5f  |.o=._.{..}.x#.._|
-00000050  0f ad 08 38 bb                                    |...8.|
+00000000  16 03 03 00 25 10 00 00  21 20 8a e9 9e c4 7f 94  |....%...! ......|
+00000010  a6 2b ed 7d de 1f 3d e1  dc b9 36 b9 1a 90 57 17  |.+.}..=...6...W.|
+00000020  fc 06 0f 74 9c 04 4e 2e  6e 5f 14 03 03 00 01 01  |...t..N.n_......|
+00000030  16 03 03 00 20 71 01 29  a9 89 d3 ce ba 8d 91 96  |.... q.)........|
+00000040  10 e8 90 5b 9b 5c 4d 17  40 6e b7 69 25 ce 15 1d  |...[.\M.@n.i%...|
+00000050  0f ec ff 86 fe                                    |.....|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 7e 04 00 00  7a 00 00 00 00 00 74 00  |....~...z.....t.|
+00000000  16 03 03 00 7f 04 00 00  7b 00 00 00 00 00 75 00  |........{.....u.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6f 2d 7c 2b 51 ed 14 ef  68 ca 42 c5 4c 80 c4 80  |o-|+Q...h.B.L...|
-00000030  f2 3a 68 eb 76 3e 83 5c  e8 b2 c7 00 f7 1b 9c a0  |.:h.v>.\........|
-00000040  90 aa 8d 00 90 2f 2f e9  6f d0 1b d1 dd 79 49 7e  |.....//.o....yI~|
-00000050  db 1c 3d 2b 63 53 bd d8  d8 7f d3 8b 85 49 38 16  |..=+cS.......I8.|
-00000060  7f 51 5c ea 14 13 c9 2b  b5 4c 78 35 57 f5 94 33  |.Q\....+.Lx5W..3|
-00000070  54 f6 c0 8b 4e ca 68 54  ed 57 c4 9b 37 71 44 70  |T...N.hT.W..7qDp|
-00000080  ba 66 b2 14 03 03 00 01  01 16 03 03 00 20 b0 47  |.f........... .G|
-00000090  e3 7d d1 63 44 d9 1a e0  79 6c 7a 4d b7 79 de 30  |.}.cD...ylzM.y.0|
-000000a0  01 77 2c 48 70 ac 84 9e  fd 9a 2f c2 c3 2d 17 03  |.w,Hp...../..-..|
-000000b0  03 00 1d 66 db 8f bc 7c  8c 60 be 0d 45 8a 3b 08  |...f...|.`..E.;.|
-000000c0  55 b0 8b f6 4f 41 5d 1b  b6 ee 93 a1 98 e4 cf 26  |U...OA]........&|
-000000d0  15 03 03 00 12 13 67 6b  05 2b d4 a6 5b 08 19 e2  |......gk.+..[...|
-000000e0  11 c5 5f 08 72 f4 7d                              |.._.r.}|
+00000020  6f 2d 7c 2b 51 ed 14 ef  68 ca 42 c5 4c ed 10 ee  |o-|+Q...h.B.L...|
+00000030  2e 3f 7c c5 f4 bd af 04  18 a4 76 3d 61 1c 7c c4  |.?|.......v=a.|.|
+00000040  00 93 f6 69 ba 5f 90 14  57 55 05 89 27 80 57 df  |...i._..WU..'.W.|
+00000050  d5 d5 fb 4c e0 45 64 8b  67 28 58 7b 18 49 38 16  |...L.Ed.g(X{.I8.|
+00000060  7f 51 5c e5 28 cf 13 b4  e5 60 f7 5e 60 4c 44 84  |.Q\.(....`.^`LD.|
+00000070  c3 2e 8a c1 db e4 7f e2  13 35 84 47 ef 1a db 4d  |.........5.G...M|
+00000080  e8 34 53 56 14 03 03 00  01 01 16 03 03 00 20 47  |.4SV.......... G|
+00000090  fa 88 ff 79 40 30 ab 4d  9c 2b c1 e0 10 60 eb 4a  |...y@0.M.+...`.J|
+000000a0  5d 9f 6d 74 01 f0 f8 15  1d 13 79 cd fb 30 88 17  |].mt......y..0..|
+000000b0  03 03 00 1d 48 00 42 d7  1c 5f 8d 04 bd 78 3f e6  |....H.B.._...x?.|
+000000c0  6c c8 79 ba e1 5e 87 82  49 3d 55 37 6e 3f 04 be  |l.y..^..I=U7n?..|
+000000d0  5a 15 03 03 00 12 75 d9  4c 34 ae c9 7b 3c 1e 6c  |Z.....u.L4..{<.l|
+000000e0  cf 34 95 d6 8d ca 5f 0c                           |.4...._.|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ALPN-Fallback b/src/crypto/tls/testdata/Server-TLSv12-ALPN-Fallback
index 672edb2b86..f23432e87c 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ALPN-Fallback
+++ b/src/crypto/tls/testdata/Server-TLSv12-ALPN-Fallback
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 a6 01 00 00  a2 03 03 7b 4d 0f 01 d5  |...........{M...|
-00000010  e8 07 a4 be 67 dc 2c c4  1a 6d 90 c9 59 4c 16 b1  |....g.,..m..YL..|
-00000020  5b 34 be 10 9d 25 99 bf  42 88 9b 00 00 04 cc a8  |[4...%..B.......|
+00000000  16 03 01 00 a6 01 00 00  a2 03 03 5d 7d ed 76 f3  |...........]}.v.|
+00000010  d2 de b6 b7 c4 71 b0 75  6b 7f 49 e9 7f bb 5e b3  |.....q.uk.I...^.|
+00000020  df 8b 25 a1 af 9f 8a c5  23 e5 22 00 00 04 cc a8  |..%.....#.".....|
 00000030  00 ff 01 00 00 75 00 0b  00 04 03 00 01 02 00 0a  |.....u..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000050  00 00 00 10 00 19 00 17  06 70 72 6f 74 6f 33 08  |.........proto3.|
@@ -55,36 +55,36 @@
 00000290  d4 db fe 3d 13 60 84 5c  21 d3 3b e9 fa e7 16 03  |...=.`.\!.;.....|
 000002a0  03 00 ac 0c 00 00 a8 03  00 1d 20 2f e5 7d a3 47  |.......... /.}.G|
 000002b0  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
-000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 08 04 00 80 17  |......_X.;t.....|
-000002d0  0b 6f e7 b3 28 09 8e fb  c0 ce 3c a4 95 aa d8 e7  |.o..(.....<.....|
-000002e0  8e 80 cf d0 6a 42 10 c7  d7 02 8d 05 77 81 eb 2f  |....jB......w../|
-000002f0  fb c2 a7 95 4c 89 3a 4a  b5 92 19 e7 4f a5 0e 0a  |....L.:J....O...|
-00000300  27 04 59 b2 b7 79 c9 30  be 6e 90 b8 67 77 63 e2  |'.Y..y.0.n..gwc.|
-00000310  01 16 61 e9 a6 70 2c b0  c6 0a 22 7b 33 98 73 e8  |..a..p,..."{3.s.|
-00000320  3f f3 11 6b 14 07 67 c9  2b dc 94 6a 7c e9 44 a1  |?..k..g.+..j|.D.|
-00000330  30 c7 b4 37 7f 96 1c 07  87 1b c7 ac a1 8c b7 8d  |0..7............|
-00000340  21 d0 e6 e8 00 2b 86 60  58 d2 f7 da 4b 78 bd 16  |!....+.`X...Kx..|
+000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 08 04 00 80 d6  |......_X.;t.....|
+000002d0  d1 b7 44 aa 4b 34 94 1e  40 0b 50 d3 03 c2 b4 65  |..D.K4..@.P....e|
+000002e0  87 e4 cc 58 95 25 34 dc  c4 a6 fa 0a 5e 8a 02 5d  |...X.%4.....^..]|
+000002f0  ab 55 62 d7 32 49 f7 31  33 80 48 9f c5 8d 0f ad  |.Ub.2I.13.H.....|
+00000300  cc 0b 26 c7 ff 57 14 f1  b8 c6 b2 7d 68 b3 01 a8  |..&..W.....}h...|
+00000310  a3 56 d6 6c 65 ca 7b b0  08 97 c2 66 d0 06 b8 e0  |.V.le.{....f....|
+00000320  bb bd 97 fc 3e 80 45 3c  73 8f 59 8b 76 5d 30 e0  |....>.E<s.Y.v]0.|
+00000330  d1 eb 5d 27 7a ed 52 2f  fb 2a 54 51 f9 92 46 ed  |..]'z.R/.*TQ..F.|
+00000340  7f c5 df 2a 59 fe 58 10  69 86 cd 50 3f 27 e5 16  |...*Y.X.i..P?'..|
 00000350  03 03 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 1d 07 e8 61 85 1e  |....%...! ...a..|
-00000010  b6 c1 c6 bf 00 a6 37 af  ff d5 00 61 5a 9b 88 03  |......7....aZ...|
-00000020  0b 57 03 5a 1f e1 e8 71  ea 7f 14 03 03 00 01 01  |.W.Z...q........|
-00000030  16 03 03 00 20 09 7e b8  64 e0 c9 ca 03 9b db 74  |.... .~.d......t|
-00000040  10 69 c4 00 62 d5 35 0c  0a 29 ae fe f2 90 1f 23  |.i..b.5..).....#|
-00000050  cf fc 8b a9 eb                                    |.....|
+00000000  16 03 03 00 25 10 00 00  21 20 13 c8 d8 37 18 ec  |....%...! ...7..|
+00000010  37 61 44 eb 0b 4d ca 43  89 92 65 74 fc 38 16 03  |7aD..M.C..et.8..|
+00000020  11 77 5f cf 4c a0 d3 06  b4 12 14 03 03 00 01 01  |.w_.L...........|
+00000030  16 03 03 00 20 b8 08 12  b6 17 66 b9 73 a3 30 21  |.... .....f.s.0!|
+00000040  7c 97 2f fe 8b d7 91 ae  24 65 04 76 3d f0 71 f2  ||./.....$e.v=.q.|
+00000050  88 48 bc bc 1b                                    |.H...|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 7e 04 00 00  7a 00 00 00 00 00 74 00  |....~...z.....t.|
+00000000  16 03 03 00 7f 04 00 00  7b 00 00 00 00 00 75 00  |........{.....u.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6f 2d 7c 2b 51 ed 14 ef  68 ca 42 c5 4c df 43 5c  |o-|+Q...h.B.L.C\|
-00000030  31 7d 05 44 a0 0d 34 f4  ae b3 71 41 7f 69 fb 8d  |1}.D..4...qA.i..|
-00000040  52 58 75 1b 31 f1 f9 28  7f 2e d2 2f 30 17 d3 6f  |RXu.1..(.../0..o|
-00000050  1c 37 71 1f 5e ac 74 67  d3 52 b9 ad 8b 49 38 16  |.7q.^.tg.R...I8.|
-00000060  7f 51 5c c3 da 32 cc a6  7a 0c 82 36 eb 47 e0 b2  |.Q\..2..z..6.G..|
-00000070  72 74 de d6 61 d0 f7 ef  16 7b e7 41 f7 1e 88 ac  |rt..a....{.A....|
-00000080  9d 0f 54 14 03 03 00 01  01 16 03 03 00 20 3f 66  |..T.......... ?f|
-00000090  ff f9 21 f0 2b c3 4b 16  d0 40 b6 9e 99 70 58 c8  |..!.+.K..@...pX.|
-000000a0  2e c8 fc 46 cf f9 23 cb  b4 de 0e 31 5a 81 17 03  |...F..#....1Z...|
-000000b0  03 00 1d 26 e5 43 0e bd  e0 8f 91 27 4b 67 a0 30  |...&.C.....'Kg.0|
-000000c0  f9 76 00 76 8a d7 a0 09  0e da 02 49 16 e4 51 14  |.v.v.......I..Q.|
-000000d0  15 03 03 00 12 0f 7a b3  47 27 ce 18 bb 40 93 d2  |......z.G'...@..|
-000000e0  5a 0e ea 1d 6d cf 1c                              |Z...m..|
+00000020  6f 2d 7c 2b 51 ed 14 ef  68 ca 42 c5 4c 61 30 a6  |o-|+Q...h.B.La0.|
+00000030  99 04 8a 0d aa af 2c 0d  d6 05 50 cf a2 ba a5 da  |......,...P.....|
+00000040  81 ed ee 22 c9 39 14 3d  7e 5e 39 e4 58 05 65 27  |...".9.=~^9.X.e'|
+00000050  88 ac 7a e4 75 64 2d 02  d7 6c 6b 9f 7f 49 38 16  |..z.ud-..lk..I8.|
+00000060  7f 51 5c e5 09 42 7b a4  77 e1 9c b2 df 97 e2 c1  |.Q\..B{.w.......|
+00000070  3a de bb 9c 1d 7b bd 51  f7 de 83 2e 02 bf 86 4f  |:....{.Q.......O|
+00000080  cf fa f4 51 14 03 03 00  01 01 16 03 03 00 20 85  |...Q.......... .|
+00000090  b1 8b bf bc c7 44 af b8  dc d7 ca 93 79 0e 03 43  |.....D......y..C|
+000000a0  d7 4c fd 4e 1f 29 c6 cd  85 68 65 3e 7e 3b 1e 17  |.L.N.)...he>~;..|
+000000b0  03 03 00 1d c1 66 d8 51  98 dc c0 d6 95 c0 c6 5c  |.....f.Q.......\|
+000000c0  dc d7 df 66 60 ea 45 4a  58 47 d0 02 58 34 80 61  |...f`.EJXG..X4.a|
+000000d0  e9 15 03 03 00 12 53 74  d3 60 f8 95 e4 cf a3 64  |......St.`.....d|
+000000e0  a3 19 0a 0c e0 c5 7e e5                           |......~.|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ALPN-NotConfigured b/src/crypto/tls/testdata/Server-TLSv12-ALPN-NotConfigured
index 33a35cf422..0f36ba036c 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ALPN-NotConfigured
+++ b/src/crypto/tls/testdata/Server-TLSv12-ALPN-NotConfigured
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 9d 01 00 00  99 03 03 bd 4f 16 ff 46  |............O..F|
-00000010  37 4d f2 40 29 d4 6f c2  2f 78 26 a4 6f f6 d2 6f  |7M.@).o./x&.o..o|
-00000020  08 4e a0 d8 e8 68 72 ea  56 14 16 00 00 04 cc a8  |.N...hr.V.......|
+00000000  16 03 01 00 9d 01 00 00  99 03 03 35 f2 2c 2d b2  |...........5.,-.|
+00000010  fa c9 5e 17 3b 13 3b 12  25 98 a2 2c dd 7b 95 17  |..^.;.;.%..,.{..|
+00000020  7b c1 79 76 58 3e 1c 7a  f3 b9 5b 00 00 04 cc a8  |{.yvX>.z..[.....|
 00000030  00 ff 01 00 00 6c 00 0b  00 04 03 00 01 02 00 0a  |.....l..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000050  00 00 00 10 00 10 00 0e  06 70 72 6f 74 6f 32 06  |.........proto2.|
@@ -55,36 +55,36 @@
 00000290  d4 db fe 3d 13 60 84 5c  21 d3 3b e9 fa e7 16 03  |...=.`.\!.;.....|
 000002a0  03 00 ac 0c 00 00 a8 03  00 1d 20 2f e5 7d a3 47  |.......... /.}.G|
 000002b0  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
-000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 08 04 00 80 55  |......_X.;t....U|
-000002d0  23 26 e9 ba 72 ff e0 7c  79 4b 26 13 4b d1 ab bb  |#&..r..|yK&.K...|
-000002e0  74 ea 95 12 c0 9f a0 cd  24 61 a3 f5 e8 a7 b3 15  |t.......$a......|
-000002f0  1a c1 90 f9 77 2d 13 49  ef 9e 63 19 9b b9 a5 cc  |....w-.I..c.....|
-00000300  9a f5 bc 25 f9 2c 60 c4  54 7c 46 71 7e d0 d3 43  |...%.,`.T|Fq~..C|
-00000310  a3 9a 61 bb 79 be 69 8d  32 d7 e3 95 26 e5 25 b7  |..a.y.i.2...&.%.|
-00000320  cf e3 d2 91 34 90 ef ad  10 ed 1b 25 77 3f 83 33  |....4......%w?.3|
-00000330  c7 d8 6a f3 3e b2 9d 88  6f 0e b0 7d 96 19 08 9d  |..j.>...o..}....|
-00000340  47 87 b1 13 0b 53 e4 0c  f9 04 08 4e 0c 6c f7 16  |G....S.....N.l..|
+000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 08 04 00 80 c1  |......_X.;t.....|
+000002d0  0e 3d 12 2b ba 02 54 c3  73 58 20 d2 af d4 0c a4  |.=.+..T.sX .....|
+000002e0  df 78 7a aa d8 09 5a e8  84 b2 71 4f 89 85 f8 ae  |.xz...Z...qO....|
+000002f0  d1 f7 8b d0 53 00 47 34  ef 54 5a 76 64 8b ab 39  |....S.G4.TZvd..9|
+00000300  0a 1f 5b cb d6 46 4c 36  3a 12 ea 8b f4 ef 53 79  |..[..FL6:.....Sy|
+00000310  4b e7 2a 9a de 9a 80 f2  fa 77 0d 3e 36 3a 01 d5  |K.*......w.>6:..|
+00000320  c9 3b df 6c eb d3 70 8a  96 1f bf 8f 23 e0 00 e0  |.;.l..p.....#...|
+00000330  4a b3 83 5c 22 9a 11 b6  b3 6f c7 cd 41 f1 ae c2  |J..\"....o..A...|
+00000340  3b 53 bd f2 58 a3 77 c2  ba ca 65 e4 c8 dc 0e 16  |;S..X.w...e.....|
 00000350  03 03 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 51 32 9b 93 26 d6  |....%...! Q2..&.|
-00000010  59 05 74 8f 5e 31 ad 2b  42 da c4 0d db f8 ef ed  |Y.t.^1.+B.......|
-00000020  17 42 e6 e9 5b a9 b4 1b  e3 70 14 03 03 00 01 01  |.B..[....p......|
-00000030  16 03 03 00 20 e6 7b 74  dc 96 d3 8b 40 a2 ff 92  |.... .{t....@...|
-00000040  72 1c ce ad 57 1d cf 9c  3b a6 bb 94 9f 40 48 50  |r...W...;....@HP|
-00000050  77 38 3b 8e 3e                                    |w8;.>|
+00000000  16 03 03 00 25 10 00 00  21 20 15 2b c4 cc 7a b3  |....%...! .+..z.|
+00000010  d9 82 a3 9a bd a5 3d 6a  1d 82 b6 b8 0c 63 2c 1c  |......=j.....c,.|
+00000020  50 47 28 c9 75 aa 9e 62  26 7e 14 03 03 00 01 01  |PG(.u..b&~......|
+00000030  16 03 03 00 20 f5 a1 df  ec ed 87 95 af eb 0b 4a  |.... ..........J|
+00000040  eb 5c 5e b9 36 ec 9e 24  e9 a5 34 bb 1c ac f5 4f  |.\^.6..$..4....O|
+00000050  3a 2d 8b 21 26                                    |:-.!&|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 7e 04 00 00  7a 00 00 00 00 00 74 00  |....~...z.....t.|
+00000000  16 03 03 00 7f 04 00 00  7b 00 00 00 00 00 75 00  |........{.....u.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6f 2d 7c 2b 51 ed 14 ef  68 ca 42 c5 4c 78 9b e4  |o-|+Q...h.B.Lx..|
-00000030  e8 ca 70 55 19 e0 56 d1  ef 20 b0 cb da 65 6b f8  |..pU..V.. ...ek.|
-00000040  e0 38 13 37 74 13 f4 9a  4c 34 4b 39 09 da c1 d2  |.8.7t...L4K9....|
-00000050  00 75 18 4d de c0 66 a9  5d a9 74 2b 51 49 38 16  |.u.M..f.].t+QI8.|
-00000060  7f 51 5c 28 d6 8d 66 0b  94 c8 b6 04 f5 f9 16 ce  |.Q\(..f.........|
-00000070  de ca 44 02 a2 94 1a 1c  d9 4a cf a6 a8 ab ce 0a  |..D......J......|
-00000080  03 9f fb 14 03 03 00 01  01 16 03 03 00 20 7b 74  |............. {t|
-00000090  30 d0 4a 39 75 3c 24 c0  b4 9c 57 53 ab 9c 9a 36  |0.J9u<$...WS...6|
-000000a0  7a 06 0b 2d a0 82 2b d7  1e b8 cb 3f b0 cc 17 03  |z..-..+....?....|
-000000b0  03 00 1d a2 03 06 3a 7c  96 2f 9c ea 07 8f e5 6b  |......:|./.....k|
-000000c0  37 97 7f 4b 65 d9 f1 da  00 26 79 3d 7b ea de e2  |7..Ke....&y={...|
-000000d0  15 03 03 00 12 26 e8 a6  c6 b4 c1 af 59 f1 b4 1f  |.....&......Y...|
-000000e0  a7 23 b4 6e 5b 3b ae                              |.#.n[;.|
+00000020  6f 2d 7c 2b 51 ed 14 ef  68 ca 42 c5 4c 72 9e 40  |o-|+Q...h.B.Lr.@|
+00000030  d3 e0 46 f1 a8 b9 11 11  3c bd 49 e9 ef a6 31 25  |..F.....<.I...1%|
+00000040  a0 09 e7 8d aa d3 30 82  e1 de 0d 98 a5 5f 34 70  |......0......_4p|
+00000050  f6 05 04 90 7a 45 c4 68  51 17 da cd b3 49 38 16  |....zE.hQ....I8.|
+00000060  7f 51 5c e5 9c 44 6c 3e  83 b4 22 a9 b2 d4 83 1f  |.Q\..Dl>..".....|
+00000070  81 92 12 23 6e 57 78 0d  26 92 9e 95 27 8f 44 73  |...#nWx.&...'.Ds|
+00000080  6b 1a ec 88 14 03 03 00  01 01 16 03 03 00 20 8a  |k............. .|
+00000090  c9 7a bb 7a 8b 97 39 a4  fb 25 2e 28 a9 80 a4 81  |.z.z..9..%.(....|
+000000a0  a5 c6 5a 54 59 16 8b 7c  fa 16 72 01 fa bb ec 17  |..ZTY..|..r.....|
+000000b0  03 03 00 1d 94 86 ae 94  a7 31 fe d8 a5 7b 4f d1  |.........1...{O.|
+000000c0  9e 20 7a a3 b2 43 ca 6b  50 c9 a0 cf f7 4f 9c c9  |. z..C.kP....O..|
+000000d0  99 15 03 03 00 12 19 d8  ab 36 79 8f 0e 43 28 89  |.........6y..C(.|
+000000e0  9a 79 c6 74 52 5f 14 38                           |.y.tR_.8|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ExportKeyingMaterial b/src/crypto/tls/testdata/Server-TLSv12-ExportKeyingMaterial
index 9d1256cf28..db88c0305c 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ExportKeyingMaterial
+++ b/src/crypto/tls/testdata/Server-TLSv12-ExportKeyingMaterial
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 89 01 00 00  85 03 03 8c 22 0a 8a d9  |............"...|
-00000010  eb 77 89 34 7e 89 ff 20  c0 8a 74 c8 b5 30 12 6e  |.w.4~.. ..t..0.n|
-00000020  cc e2 7c b2 50 28 a9 a8  d0 fa 95 00 00 04 c0 14  |..|.P(..........|
+00000000  16 03 01 00 89 01 00 00  85 03 03 04 7b 4a a9 93  |............{J..|
+00000010  39 1c 16 6b ab 54 e1 e1  39 6d ef 18 83 4b 73 a6  |9..k.T..9m...Ks.|
+00000020  0b ff a8 6c ba e7 e3 81  84 33 f5 00 00 04 c0 14  |...l.....3......|
 00000030  00 ff 01 00 00 58 00 0b  00 04 03 00 01 02 00 0a  |.....X..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000050  00 00 00 16 00 00 00 17  00 00 00 0d 00 30 00 2e  |.............0..|
@@ -53,44 +53,44 @@
 00000290  d4 db fe 3d 13 60 84 5c  21 d3 3b e9 fa e7 16 03  |...=.`.\!.;.....|
 000002a0  03 00 ac 0c 00 00 a8 03  00 1d 20 2f e5 7d a3 47  |.......... /.}.G|
 000002b0  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
-000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 08 04 00 80 70  |......_X.;t....p|
-000002d0  28 b4 c1 c9 52 83 7a 12  96 5f 7e c3 eb 80 fc 56  |(...R.z.._~....V|
-000002e0  c8 bd e8 62 9a 3b 30 08  03 b2 2a 7d 8a 28 b3 2d  |...b.;0...*}.(.-|
-000002f0  11 10 f2 32 21 4b 6d e1  5b 57 2b 67 cc 38 3f 52  |...2!Km.[W+g.8?R|
-00000300  bf 14 9b 32 78 68 0f 98  2b 29 e0 29 ad f4 d7 75  |...2xh..+).)...u|
-00000310  92 ae 6a 1b 3d b5 ac d6  ed 0a ad 22 75 ab 76 d5  |..j.=......"u.v.|
-00000320  c9 5c 46 3f 7c b9 1b 58  ac 8e a5 be c5 87 87 59  |.\F?|..X.......Y|
-00000330  0e 33 70 71 d0 00 f4 7a  c1 7f 07 b8 7c 88 c5 10  |.3pq...z....|...|
-00000340  ae d0 ff 11 93 76 e8 45  46 58 55 cb 0e 82 a4 16  |.....v.EFXU.....|
+000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 08 04 00 80 77  |......_X.;t....w|
+000002d0  06 34 da cb a5 23 a2 c7  c4 c2 f2 91 ce 79 51 c7  |.4...#.......yQ.|
+000002e0  da d9 b8 15 4f b9 37 dc  fb fe 76 76 a2 13 b4 3e  |....O.7...vv...>|
+000002f0  8c 1f 6a f9 00 b0 19 4a  78 d2 f5 16 8a 21 19 58  |..j....Jx....!.X|
+00000300  da 7e b3 eb 6d d0 86 08  3b 98 d8 a0 f4 8f d6 ad  |.~..m...;.......|
+00000310  16 42 f9 67 e1 81 61 fc  6a 0b 21 0f 32 f3 0b 88  |.B.g..a.j.!.2...|
+00000320  24 e4 82 cd c2 a5 42 07  87 97 47 3b 3e a0 a8 77  |$.....B...G;>..w|
+00000330  8b 4d 3d 78 7e 99 48 c0  94 c5 97 30 32 6f c4 77  |.M=x~.H....02o.w|
+00000340  71 b8 0c dc c5 ad 9b 9a  6d 53 95 97 fd d8 5b 16  |q.......mS....[.|
 00000350  03 03 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 2f 49 fe 93 93 da  |....%...! /I....|
-00000010  ff e2 0a 57 ae 1e 0c 86  7b 35 e0 a9 8a c5 47 42  |...W....{5....GB|
-00000020  83 8e 9c 2b 14 1e 37 26  ed 11 14 03 03 00 01 01  |...+..7&........|
-00000030  16 03 03 00 40 67 24 a8  b3 b1 85 5a e7 65 94 9b  |....@g$....Z.e..|
-00000040  0f 83 8d e9 fa 40 27 a8  95 51 62 86 36 28 89 53  |.....@'..Qb.6(.S|
-00000050  b4 9e f3 5c 56 7f 47 27  df 60 0e 57 ea ad df 9d  |...\V.G'.`.W....|
-00000060  05 64 9d eb 86 e7 11 85  9f 5f b9 43 fa db cf 1e  |.d......._.C....|
-00000070  96 1d d7 56 9d                                    |...V.|
+00000000  16 03 03 00 25 10 00 00  21 20 1b a4 34 56 cd d9  |....%...! ..4V..|
+00000010  6b 18 c2 e5 c0 3f 27 28  23 2a 6f 1d 13 4a 84 e7  |k....?'(#*o..J..|
+00000020  af a6 46 cf 52 a6 a9 2b  98 4a 14 03 03 00 01 01  |..F.R..+.J......|
+00000030  16 03 03 00 40 28 73 6f  2a d2 6c 4a 60 60 57 fc  |....@(so*.lJ``W.|
+00000040  85 5e d0 b9 95 9c 72 4a  7d a5 40 89 3c 22 b0 31  |.^....rJ}.@.<".1|
+00000050  a4 ed cd ba 4a 05 04 d2  e0 d7 be ee 6a 41 45 5d  |....J.......jAE]|
+00000060  db bd 1a bf a1 59 ba 1f  f3 82 68 c4 f5 7c 61 8f  |.....Y....h..|a.|
+00000070  b0 4b 43 3f 7b                                    |.KC?{|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 7e 04 00 00  7a 00 00 00 00 00 74 00  |....~...z.....t.|
+00000000  16 03 03 00 7f 04 00 00  7b 00 00 00 00 00 75 00  |........{.....u.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6f 2d 70 97 51 ed 14 ef  68 ca 42 c5 4c 06 d3 31  |o-p.Q...h.B.L..1|
-00000030  17 c4 8a 79 68 bb 41 5e  1c 47 3b c8 f4 b6 9b 13  |...yh.A^.G;.....|
-00000040  11 d4 af 1c 21 8f e3 db  5c 45 ab 24 b7 3b 05 27  |....!...\E.$.;.'|
-00000050  59 4b 60 75 83 3f 24 11  ef ef 59 5b 9a 49 38 16  |YK`u.?$...Y[.I8.|
-00000060  7f 51 5c 78 18 b0 2a 9b  95 67 7b 34 47 53 c0 87  |.Q\x..*..g{4GS..|
-00000070  65 b7 9a 34 f7 99 e0 2c  46 7b 52 9c 76 32 d1 da  |e..4...,F{R.v2..|
-00000080  2e 8b 5d 14 03 03 00 01  01 16 03 03 00 40 00 00  |..]..........@..|
-00000090  00 00 00 00 00 00 00 00  00 00 00 00 00 00 bf b5  |................|
-000000a0  66 43 ce b0 8d c3 27 a4  de e9 d1 af 49 43 29 fc  |fC....'.....IC).|
-000000b0  2a ff ee 59 9e 1f 21 f1  86 18 ec b6 dd 75 17 d6  |*..Y..!......u..|
-000000c0  63 7c 5f b1 7a 98 b0 4c  72 0f 89 48 ed 80 17 03  |c|_.z..Lr..H....|
-000000d0  03 00 40 00 00 00 00 00  00 00 00 00 00 00 00 00  |..@.............|
-000000e0  00 00 00 3c 97 90 f1 15  45 f3 73 ea 6e db 47 b3  |...<....E.s.n.G.|
-000000f0  f3 9a 9b c9 4d ab ef f7  8f b5 60 81 46 dd 5d a7  |....M.....`.F.].|
-00000100  2e 13 ca 1e 26 73 2d 50  87 43 74 8d 1a cf df 6e  |....&s-P.Ct....n|
-00000110  a6 92 0a 15 03 03 00 30  00 00 00 00 00 00 00 00  |.......0........|
-00000120  00 00 00 00 00 00 00 00  5d 28 1b 4e 3f 92 cc c3  |........](.N?...|
-00000130  36 12 d7 71 f4 77 6a 55  a8 21 23 0a 4a 3f 0a f1  |6..q.wjU.!#.J?..|
-00000140  5f 33 3e 81 26 82 76 08                           |_3>.&.v.|
+00000020  6f 2d 70 97 51 ed 14 ef  68 ca 42 c5 4c e3 e3 2a  |o-p.Q...h.B.L..*|
+00000030  ac 0e a1 46 90 cc 35 e9  6d 08 a3 48 76 f7 b0 3b  |...F..5.m..Hv..;|
+00000040  7a 25 c1 fb 1f db 71 e7  9b 21 03 42 0e 03 7d 80  |z%....q..!.B..}.|
+00000050  5e 6f 94 85 f9 1d 17 38  22 01 84 43 bb 49 38 16  |^o.....8"..C.I8.|
+00000060  7f 51 5c e5 90 2f b3 81  05 4f af 51 9c 9a 7e 88  |.Q\../...O.Q..~.|
+00000070  cb 7f 5d 42 33 eb 80 22  54 d0 45 ac e4 3d d0 3e  |..]B3.."T.E..=.>|
+00000080  3b 45 8e 79 14 03 03 00  01 01 16 03 03 00 40 00  |;E.y..........@.|
+00000090  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 c5  |................|
+000000a0  28 84 30 0e f4 f4 87 7f  2e 39 e6 8d 35 38 d5 1d  |(.0......9..58..|
+000000b0  e1 ea 93 77 52 bc 4e 42  43 65 0b 70 6e c0 52 3f  |...wR.NBCe.pn.R?|
+000000c0  38 b1 aa 3b 7b a4 4c da  7d ff db 2f ac f6 d8 17  |8..;{.L.}../....|
+000000d0  03 03 00 40 00 00 00 00  00 00 00 00 00 00 00 00  |...@............|
+000000e0  00 00 00 00 03 0b 19 1c  76 4e d6 8d b6 25 bb 3e  |........vN...%.>|
+000000f0  21 72 37 9b 2e 22 41 c8  72 f0 3a d7 79 cd a7 13  |!r7.."A.r.:.y...|
+00000100  4f 62 e6 5d b7 f2 eb f6  72 1b 0a f9 ea e3 3a 23  |Ob.]....r.....:#|
+00000110  19 a1 e8 2a 15 03 03 00  30 00 00 00 00 00 00 00  |...*....0.......|
+00000120  00 00 00 00 00 00 00 00  00 1c bd a5 d9 71 01 32  |.............q.2|
+00000130  82 f5 99 3f 90 88 83 7e  24 5f a5 a2 64 15 7a d3  |...?...~$_..d.z.|
+00000140  2c d2 c7 2c aa 21 be 4f  41                       |,..,.!.OA|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-IssueTicket b/src/crypto/tls/testdata/Server-TLSv12-IssueTicket
index 7fa9bdaf7b..7f0a6270cd 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-IssueTicket
+++ b/src/crypto/tls/testdata/Server-TLSv12-IssueTicket
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 71 01 00 00  6d 03 03 79 6f 8d 39 bc  |....q...m..yo.9.|
-00000010  b5 02 98 11 c0 0b 3c 37  71 7f f7 e4 e0 e4 a1 43  |......<7q......C|
-00000020  35 2f 8c ff 2d 15 53 76  fd b1 b1 00 00 04 00 2f  |5/..-.Sv......./|
+00000000  16 03 01 00 71 01 00 00  6d 03 03 1c 26 44 a7 cf  |....q...m...&D..|
+00000010  05 36 75 57 76 87 4d 35  40 59 a7 97 7e 7a d6 6b  |.6uWv.M5@Y..~z.k|
+00000020  d5 f9 18 d8 a5 e9 1e 3d  ea ef e1 00 00 04 00 2f  |.......=......./|
 00000030  00 ff 01 00 00 40 00 23  00 00 00 16 00 00 00 17  |.....@.#........|
 00000040  00 00 00 0d 00 30 00 2e  04 03 05 03 06 03 08 07  |.....0..........|
 00000050  08 08 08 09 08 0a 08 0b  08 04 08 05 08 06 04 01  |................|
@@ -52,39 +52,39 @@
 00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 04 0e 00 00  |.\!.;...........|
 000002a0  00                                                |.|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 ba 94 e0 2a 97  |..............*.|
-00000010  f4 d6 7a 6e b2 c9 49 5d  4f 9c c4 88 77 7c 2d 7e  |..zn..I]O...w|-~|
-00000020  21 8e 05 11 09 55 75 ba  0e e2 44 b3 bb 16 90 85  |!....Uu...D.....|
-00000030  a7 a6 9b 99 25 30 23 3e  10 3f a9 35 49 02 a1 92  |....%0#>.?.5I...|
-00000040  98 78 9d 40 9b 51 7a 75  05 ad 59 e4 3d 70 0f 07  |.x.@.Qzu..Y.=p..|
-00000050  be 91 1a 78 59 cc b5 3d  88 36 1e 54 61 87 55 af  |...xY..=.6.Ta.U.|
-00000060  8a 63 c4 00 15 ed 4c e7  72 01 26 13 c2 7e fe c6  |.c....L.r.&..~..|
-00000070  7f ff 43 ca 0a 94 64 d3  81 e9 4c 00 93 f0 08 a1  |..C...d...L.....|
-00000080  e5 a2 7a 37 94 c9 56 5f  82 14 e1 14 03 03 00 01  |..z7..V_........|
-00000090  01 16 03 03 00 40 e0 8a  9b 9e 22 1b 47 b5 f2 59  |.....@....".G..Y|
-000000a0  f3 0d e1 c7 9f 2a 72 5c  c8 4d ae 2e ee 9c 86 f6  |.....*r\.M......|
-000000b0  9b 77 b0 cd 81 f2 e8 91  a8 61 1d ab 99 02 72 d3  |.w.......a....r.|
-000000c0  d4 c0 e0 fe d3 e8 3e 8c  9e c5 c0 09 39 67 8e da  |......>.....9g..|
-000000d0  de 94 04 fc f1 fd                                 |......|
+00000000  16 03 03 00 86 10 00 00  82 00 80 01 1d 8d e1 c8  |................|
+00000010  9a ef 1d a1 e7 2d 19 42  86 b7 8c 70 95 7d a8 86  |.....-.B...p.}..|
+00000020  61 8f c7 6e c6 77 10 6b  b8 1e a9 35 ae f1 05 d2  |a..n.w.k...5....|
+00000030  ba 95 64 5b f5 83 d2 4c  80 81 3a b9 82 09 a7 2e  |..d[...L..:.....|
+00000040  ae 0a 43 65 66 4e 7e f8  f8 c5 00 21 bd 78 65 ab  |..CefN~....!.xe.|
+00000050  d2 a6 04 3f 9c 69 50 87  2c d9 ce cd fc f4 22 e3  |...?.iP.,.....".|
+00000060  06 84 20 06 e9 60 91 e3  2f f6 10 eb 18 a6 c3 e8  |.. ..`../.......|
+00000070  8f bf 27 66 f1 46 fa a1  61 96 31 63 62 bb 2f d9  |..'f.F..a.1cb./.|
+00000080  7c 32 7a 33 34 54 c3 a0  47 11 7e 14 03 03 00 01  ||2z34T..G.~.....|
+00000090  01 16 03 03 00 40 58 67  9d 57 43 1e 4e 83 f3 ca  |.....@Xg.WC.N...|
+000000a0  56 e8 8c 27 e0 9b b8 2c  13 95 ac a6 26 c4 28 29  |V..'...,....&.()|
+000000b0  49 e5 9f 77 74 ea 79 01  e5 69 b7 92 19 d4 db ce  |I..wt.y..i......|
+000000c0  5e fd 95 e0 01 eb 57 b6  36 03 47 b1 5e 01 c9 8d  |^.....W.6.G.^...|
+000000d0  d2 c8 cf 0b b1 aa                                 |......|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 7e 04 00 00  7a 00 00 00 00 00 74 00  |....~...z.....t.|
+00000000  16 03 03 00 7f 04 00 00  7b 00 00 00 00 00 75 00  |........{.....u.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6f 2d b0 ac 51 ed 14 ef  68 ca 42 c5 4c e9 15 fa  |o-..Q...h.B.L...|
-00000030  fe b2 4f ef a2 fd be 46  bf 69 cf 6e 88 f7 cb c8  |..O....F.i.n....|
-00000040  05 f9 ba 50 df b7 c6 45  d8 4a e8 fa 84 3c be 98  |...P...E.J...<..|
-00000050  48 28 09 30 35 34 cb c0  28 0f c6 46 aa 49 38 16  |H(.054..(..F.I8.|
-00000060  7f 51 5c e7 86 d0 16 09  9c 42 1c c3 15 4d db 4d  |.Q\......B...M.M|
-00000070  c3 54 fd e0 01 8e 57 ba  d7 94 9f 0d a3 38 34 ef  |.T....W......84.|
-00000080  11 ef 3b 14 03 03 00 01  01 16 03 03 00 40 00 00  |..;..........@..|
-00000090  00 00 00 00 00 00 00 00  00 00 00 00 00 00 dc a1  |................|
-000000a0  d6 3b 78 1d 51 55 b9 b6  93 d2 65 a3 c6 a8 b1 89  |.;x.QU....e.....|
-000000b0  8f 05 7f bc d3 8b cf 58  9c 53 5a 0b 53 c2 85 26  |.......X.SZ.S..&|
-000000c0  75 63 a4 0b 85 ca 67 d1  da 33 e6 23 b1 96 17 03  |uc....g..3.#....|
-000000d0  03 00 40 00 00 00 00 00  00 00 00 00 00 00 00 00  |..@.............|
-000000e0  00 00 00 74 ce ff 3d 1c  a5 fe fc 79 df fe cb b8  |...t..=....y....|
-000000f0  02 cd 55 73 a9 fb b6 8f  b1 83 b0 be 1a d7 93 41  |..Us...........A|
-00000100  57 24 6d 1b 9d 77 13 97  a5 6d ce 33 92 09 e5 6c  |W$m..w...m.3...l|
-00000110  f3 33 c7 15 03 03 00 30  00 00 00 00 00 00 00 00  |.3.....0........|
-00000120  00 00 00 00 00 00 00 00  cc 0d d4 56 c3 33 99 93  |...........V.3..|
-00000130  cb f8 e4 d3 05 58 95 6e  c5 2c 76 10 fa 95 69 54  |.....X.n.,v...iT|
-00000140  22 56 f0 7d e7 18 7f ab                           |"V.}....|
+00000020  6f 2d b0 ac 51 ed 14 ef  68 ca 42 c5 4c 67 af 2c  |o-..Q...h.B.Lg.,|
+00000030  17 93 9b 23 75 eb 14 42  1b 7a 25 cb 05 f0 c1 bd  |...#u..B.z%.....|
+00000040  c8 e7 60 6b 0e 1c 45 8d  51 32 a6 7c 6d 01 20 34  |..`k..E.Q2.|m. 4|
+00000050  54 8e dd d5 41 df fe a1  02 4e b5 d1 0b 49 38 16  |T...A....N...I8.|
+00000060  7f 51 5c e5 6a 1a 49 22  f3 54 3e f9 69 5c 2a b3  |.Q\.j.I".T>.i\*.|
+00000070  e6 f7 d8 eb d2 f3 76 65  fa 45 39 d0 15 85 19 40  |......ve.E9....@|
+00000080  bd 38 81 50 14 03 03 00  01 01 16 03 03 00 40 00  |.8.P..........@.|
+00000090  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 1a  |................|
+000000a0  ae 04 aa c1 7a 3a 27 ac  ca 1c 45 5d bd bb bb 59  |....z:'...E]...Y|
+000000b0  b3 ea da 09 fc 8e af 8a  2c d9 56 8a fd 1b 3c e1  |........,.V...<.|
+000000c0  38 de ce 83 87 79 3c 9a  86 cf 88 4b da 39 20 17  |8....y<....K.9 .|
+000000d0  03 03 00 40 00 00 00 00  00 00 00 00 00 00 00 00  |...@............|
+000000e0  00 00 00 00 6f 28 41 26  6e 1e 67 25 43 fc 84 91  |....o(A&n.g%C...|
+000000f0  96 19 28 d0 91 3a dc 8f  8b 63 06 d6 94 73 e9 75  |..(..:...c...s.u|
+00000100  ab 6f ce 39 18 84 c0 0e  04 ca 13 75 db f8 f3 0c  |.o.9.......u....|
+00000110  57 46 9e 59 15 03 03 00  30 00 00 00 00 00 00 00  |WF.Y....0.......|
+00000120  00 00 00 00 00 00 00 00  00 00 01 b3 55 6c 58 f0  |............UlX.|
+00000130  ee f9 bb 5f eb 97 9b a7  95 a6 82 95 bf 06 29 1b  |..._..........).|
+00000140  ff 2c 5f d8 01 5e 2d 93  cf                       |.,_..^-..|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable b/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable
index c301a979d4..4a5a468530 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable
+++ b/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 71 01 00 00  6d 03 03 b2 15 ab ab 54  |....q...m......T|
-00000010  1e cf 9f 7c b3 ea 3a 63  d4 4a 05 c8 02 6b e8 46  |...|..:c.J...k.F|
-00000020  55 42 dc a0 92 cc 52 27  9d 59 a3 00 00 04 00 2f  |UB....R'.Y...../|
+00000000  16 03 01 00 71 01 00 00  6d 03 03 5f 50 63 b3 9f  |....q...m.._Pc..|
+00000010  b9 30 07 c9 0e 79 4f 1e  0b 61 0c 04 36 77 19 c8  |.0...yO..a..6w..|
+00000020  b1 36 a4 34 e7 ba be e4  f2 6c b3 00 00 04 00 2f  |.6.4.....l...../|
 00000030  00 ff 01 00 00 40 00 23  00 00 00 16 00 00 00 17  |.....@.#........|
 00000040  00 00 00 0d 00 30 00 2e  04 03 05 03 06 03 08 07  |.....0..........|
 00000050  08 08 08 09 08 0a 08 0b  08 04 08 05 08 06 04 01  |................|
@@ -52,39 +52,39 @@
 00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 04 0e 00 00  |.\!.;...........|
 000002a0  00                                                |.|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 b0 3b f7 da 19  |............;...|
-00000010  17 7c 1d 7a 93 0d 20 43  38 04 44 ff 29 de 0a 00  |.|.z.. C8.D.)...|
-00000020  35 59 a5 3e 59 b4 47 68  62 88 9f 59 85 68 1a 97  |5Y.>Y.Ghb..Y.h..|
-00000030  1e 11 51 b9 97 2d ae be  bb f3 84 5b d6 0f e7 3b  |..Q..-.....[...;|
-00000040  0f 31 79 5f 10 0f 73 22  f0 d6 fa ca 15 ad 7c a5  |.1y_..s"......|.|
-00000050  84 a4 f1 55 80 5e b0 ca  2a 8a 1f fc 77 ec 68 84  |...U.^..*...w.h.|
-00000060  f0 b7 32 93 8e a8 e4 8c  65 3a 64 51 d8 dc 1e 7b  |..2.....e:dQ...{|
-00000070  b0 b7 eb 2b 06 55 03 5c  31 af a9 a8 91 ad 99 f1  |...+.U.\1.......|
-00000080  5d a9 08 f9 6e 12 4e 5f  92 68 bc 14 03 03 00 01  |]...n.N_.h......|
-00000090  01 16 03 03 00 40 60 5c  75 c7 33 05 0d e7 90 30  |.....@`\u.3....0|
-000000a0  4c cb 93 8b e5 6d 27 98  c0 39 a4 11 68 0b a4 8f  |L....m'..9..h...|
-000000b0  8a d7 6f 60 27 be 0c f0  95 15 c3 e8 45 8e 2d c6  |..o`'.......E.-.|
-000000c0  68 61 e1 36 2a b0 e8 38  96 32 78 ce 76 f8 ad 97  |ha.6*..8.2x.v...|
-000000d0  30 5b 11 84 86 c2                                 |0[....|
+00000000  16 03 03 00 86 10 00 00  82 00 80 0d 51 76 ac f8  |............Qv..|
+00000010  bb 03 34 db 0a fe c9 3b  8a 03 6e 33 5d 77 36 74  |..4....;..n3]w6t|
+00000020  c0 10 fa d6 61 d7 33 09  8f 09 fa 1a d3 52 96 27  |....a.3......R.'|
+00000030  c0 9e 54 47 0d 91 ff 39  11 8c 16 c1 4e 1b 6b 1e  |..TG...9....N.k.|
+00000040  ee 40 25 12 6c 96 fa 0e  45 f4 01 84 1e cd e7 79  |.@%.l...E......y|
+00000050  84 d0 c3 ed 83 ba e6 a6  9f 8d 7e 74 19 0a bc 5f  |..........~t..._|
+00000060  6d 34 a9 3f 4d 80 dc 24  1c a0 7e 5a 3a 0d 30 23  |m4.?M..$..~Z:.0#|
+00000070  65 49 16 32 89 9a 62 0f  77 7d c5 e5 e9 37 b5 f7  |eI.2..b.w}...7..|
+00000080  62 7e 42 57 87 5c d4 01  b1 2c 59 14 03 03 00 01  |b~BW.\...,Y.....|
+00000090  01 16 03 03 00 40 99 b2  ff f0 2b 92 3a b1 5f 7d  |.....@....+.:._}|
+000000a0  d8 fa 25 b4 89 75 0a fa  c2 b6 e8 f9 c2 0c af 6c  |..%..u.........l|
+000000b0  e6 ad 41 7b 08 ef 51 1d  25 71 ef 4e 2b 05 62 87  |..A{..Q.%q.N+.b.|
+000000c0  dd c4 3d bd ac 2f 26 3b  6c 84 bd ba 77 0b f5 19  |..=../&;l...w...|
+000000d0  8b b6 50 46 20 c0                                 |..PF .|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 7e 04 00 00  7a 00 00 00 00 00 74 00  |....~...z.....t.|
+00000000  16 03 03 00 7f 04 00 00  7b 00 00 00 00 00 75 00  |........{.....u.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6f 2d b0 ac 51 ed 14 ef  68 ca 42 c5 4c 2b 4d d4  |o-..Q...h.B.L+M.|
-00000030  87 c8 18 46 0d f6 1b ca  1c f5 2a cd 8d d3 62 79  |...F......*...by|
-00000040  7d 3e 2e ac f2 cf 2e 8f  dd 09 0a 5b ae 6d f3 0b  |}>.........[.m..|
-00000050  18 bc d1 1e 0d d6 49 2d  d7 5d 97 0a 6c 49 38 16  |......I-.]..lI8.|
-00000060  7f 51 5c a8 58 21 c8 9c  b3 2e 84 7b 88 14 2c f2  |.Q\.X!.....{..,.|
-00000070  cc 4c 41 78 a2 77 db e9  77 2a c1 48 31 a5 7d a2  |.LAx.w..w*.H1.}.|
-00000080  44 f9 e1 14 03 03 00 01  01 16 03 03 00 40 00 00  |D............@..|
-00000090  00 00 00 00 00 00 00 00  00 00 00 00 00 00 a3 05  |................|
-000000a0  88 c4 18 4a 6c 36 cc a3  0c bf 35 44 00 f1 2c 0d  |...Jl6....5D..,.|
-000000b0  75 e4 1b f8 90 fb 4a d7  04 69 63 bc e7 d0 84 8d  |u.....J..ic.....|
-000000c0  69 ba 7a f4 43 87 08 60  af dd c9 34 42 f1 17 03  |i.z.C..`...4B...|
-000000d0  03 00 40 00 00 00 00 00  00 00 00 00 00 00 00 00  |..@.............|
-000000e0  00 00 00 5c 8f 96 ee 0a  75 30 4c 84 04 c3 50 b5  |...\....u0L...P.|
-000000f0  ef 71 30 53 5f 0f cb 82  fa fa 5d 93 1f 5c 06 f3  |.q0S_.....]..\..|
-00000100  58 25 8d 86 21 29 90 4f  72 7e cf c5 77 1e c1 a5  |X%..!).Or~..w...|
-00000110  ec 32 c9 15 03 03 00 30  00 00 00 00 00 00 00 00  |.2.....0........|
-00000120  00 00 00 00 00 00 00 00  35 23 8d b1 e8 2e 8d a7  |........5#......|
-00000130  0e 72 48 bc 04 c2 4b 0b  fe b8 4a 7b 66 0b 41 c6  |.rH...K...J{f.A.|
-00000140  63 a0 ce 6a 55 ee ae 79                           |c..jU..y|
+00000020  6f 2d b0 ac 51 ed 14 ef  68 ca 42 c5 4c 70 b7 ba  |o-..Q...h.B.Lp..|
+00000030  31 5b 35 fd 69 77 46 6b  65 45 a4 33 54 ac 51 ea  |1[5.iwFkeE.3T.Q.|
+00000040  95 d9 10 78 5d 9a 64 3e  45 62 ac f3 02 97 15 b7  |...x].d>Eb......|
+00000050  a0 30 21 2f 35 fd fa 24  af 05 0e e7 32 49 38 16  |.0!/5..$....2I8.|
+00000060  7f 51 5c e5 41 73 f0 28  93 1c ec 01 25 f6 8a d4  |.Q\.As.(....%...|
+00000070  50 c8 71 30 08 29 35 bf  67 34 37 a0 4d e8 9b 69  |P.q0.)5.g47.M..i|
+00000080  9e 96 99 20 14 03 03 00  01 01 16 03 03 00 40 00  |... ..........@.|
+00000090  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 ef  |................|
+000000a0  f7 d7 8f 1f fd fa e3 3f  73 96 8c 91 0c 45 c9 e7  |.......?s....E..|
+000000b0  b3 7d 6b 46 d8 cd 6b 57  34 41 c0 82 16 c5 54 d5  |.}kF..kW4A....T.|
+000000c0  6d 6e 28 4f 34 b3 5b 38  a9 16 65 c5 0e 82 62 17  |mn(O4.[8..e...b.|
+000000d0  03 03 00 40 00 00 00 00  00 00 00 00 00 00 00 00  |...@............|
+000000e0  00 00 00 00 66 82 40 65  1f e8 a5 e9 19 20 87 c6  |....f.@e..... ..|
+000000f0  72 4e 15 19 ea ca cd 6e  6d 74 23 b5 1c ac eb 16  |rN.....nmt#.....|
+00000100  d2 88 a1 db 90 72 a0 85  ec 06 9e 3d ae e1 19 e1  |.....r.....=....|
+00000110  ba 3d 4b ec 15 03 03 00  30 00 00 00 00 00 00 00  |.=K.....0.......|
+00000120  00 00 00 00 00 00 00 00  00 48 50 fd 3c de 1e 5f  |.........HP.<.._|
+00000130  94 2b 1f e9 97 d9 e2 22  66 0c 27 78 d0 69 87 dc  |.+....."f.'x.i..|
+00000140  06 1d c6 3c 33 47 3c 04  db                       |...<3G<..|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-Resume b/src/crypto/tls/testdata/Server-TLSv12-Resume
index d288afe96c..d4ba75fe7a 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-Resume
+++ b/src/crypto/tls/testdata/Server-TLSv12-Resume
@@ -1,53 +1,53 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 05 01 00 01  01 03 03 22 d7 15 d6 33  |..........."...3|
-00000010  3e 09 ed 65 fe da f8 1a  3e 96 e6 6d 5a 9e 2b 68  |>..e....>..mZ.+h|
-00000020  8d b5 fb 4c 08 57 f2 ca  16 e2 40 20 fa 95 12 e8  |...L.W....@ ....|
-00000030  88 8f fc 7e df b4 6c 3f  1a 05 2c 02 07 39 aa 0b  |...~..l?..,..9..|
-00000040  48 42 2d 19 e0 e0 fa 9c  8c 7c c8 04 00 04 00 2f  |HB-......|...../|
-00000050  00 ff 01 00 00 b4 00 23  00 74 00 00 00 00 00 00  |.......#.t......|
+00000000  16 03 01 01 06 01 00 01  02 03 03 da ae e2 11 62  |...............b|
+00000010  9d 53 a1 e1 cc 53 d2 04  b6 70 1a fb c4 c0 a2 10  |.S...S...p......|
+00000020  22 a2 ab b2 f6 fb 4e e9  95 6d 38 20 c1 4f 3e 5a  |".....N..m8 .O>Z|
+00000030  2c 67 93 3a 59 ad fe 52  d6 66 b1 d9 85 ad 71 2c  |,g.:Y..R.f....q,|
+00000040  0a 02 89 73 e3 39 08 bc  3e 91 d4 f3 00 04 00 2f  |...s.9..>....../|
+00000050  00 ff 01 00 00 b5 00 23  00 75 00 00 00 00 00 00  |.......#.u......|
 00000060  00 00 00 00 00 00 00 00  00 00 94 6f 2d b0 ac 51  |...........o-..Q|
-00000070  ed 14 ef 68 ca 42 c5 4c  e9 15 fa fe b2 4f ef a2  |...h.B.L.....O..|
-00000080  fd be 46 bf 69 cf 6e 88  f7 cb c8 05 f9 ba 50 df  |..F.i.n.......P.|
-00000090  b7 c6 45 d8 4a e8 fa 84  3c be 98 48 28 09 30 35  |..E.J...<..H(.05|
-000000a0  34 cb c0 28 0f c6 46 aa  49 38 16 7f 51 5c e7 86  |4..(..F.I8..Q\..|
-000000b0  d0 16 09 9c 42 1c c3 15  4d db 4d c3 54 fd e0 01  |....B...M.M.T...|
-000000c0  8e 57 ba d7 94 9f 0d a3  38 34 ef 11 ef 3b 00 16  |.W......84...;..|
-000000d0  00 00 00 17 00 00 00 0d  00 30 00 2e 04 03 05 03  |.........0......|
-000000e0  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
-000000f0  08 06 04 01 05 01 06 01  03 03 02 03 03 01 02 01  |................|
-00000100  03 02 02 02 04 02 05 02  06 02                    |..........|
+00000070  ed 14 ef 68 ca 42 c5 4c  67 af 2c 17 93 9b 23 75  |...h.B.Lg.,...#u|
+00000080  eb 14 42 1b 7a 25 cb 05  f0 c1 bd c8 e7 60 6b 0e  |..B.z%.......`k.|
+00000090  1c 45 8d 51 32 a6 7c 6d  01 20 34 54 8e dd d5 41  |.E.Q2.|m. 4T...A|
+000000a0  df fe a1 02 4e b5 d1 0b  49 38 16 7f 51 5c e5 6a  |....N...I8..Q\.j|
+000000b0  1a 49 22 f3 54 3e f9 69  5c 2a b3 e6 f7 d8 eb d2  |.I".T>.i\*......|
+000000c0  f3 76 65 fa 45 39 d0 15  85 19 40 bd 38 81 50 00  |.ve.E9....@.8.P.|
+000000d0  16 00 00 00 17 00 00 00  0d 00 30 00 2e 04 03 05  |..........0.....|
+000000e0  03 06 03 08 07 08 08 08  09 08 0a 08 0b 08 04 08  |................|
+000000f0  05 08 06 04 01 05 01 06  01 03 03 02 03 03 01 02  |................|
+00000100  01 03 02 02 02 04 02 05  02 06 02                 |...........|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 55 02 00 00  51 03 03 00 00 00 00 00  |....U...Q.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 44 4f 57 4e 47  52 44 01 20 fa 95 12 e8  |...DOWNGRD. ....|
-00000030  88 8f fc 7e df b4 6c 3f  1a 05 2c 02 07 39 aa 0b  |...~..l?..,..9..|
-00000040  48 42 2d 19 e0 e0 fa 9c  8c 7c c8 04 00 2f 00 00  |HB-......|.../..|
-00000050  09 00 23 00 00 ff 01 00  01 00 16 03 03 00 7e 04  |..#...........~.|
-00000060  00 00 7a 00 00 00 00 00  74 00 00 00 00 00 00 00  |..z.....t.......|
+00000020  00 00 00 44 4f 57 4e 47  52 44 01 20 c1 4f 3e 5a  |...DOWNGRD. .O>Z|
+00000030  2c 67 93 3a 59 ad fe 52  d6 66 b1 d9 85 ad 71 2c  |,g.:Y..R.f....q,|
+00000040  0a 02 89 73 e3 39 08 bc  3e 91 d4 f3 00 2f 00 00  |...s.9..>..../..|
+00000050  09 00 23 00 00 ff 01 00  01 00 16 03 03 00 7f 04  |..#.............|
+00000060  00 00 7b 00 00 00 00 00  75 00 00 00 00 00 00 00  |..{.....u.......|
 00000070  00 00 00 00 00 00 00 00  00 94 6f 2d b0 ac 51 ed  |..........o-..Q.|
-00000080  14 ef 68 ca 42 c5 4c e9  15 fa fe b2 4f ef a2 fd  |..h.B.L.....O...|
-00000090  be 46 bf 69 cf 6e 88 f7  cb c8 05 f9 ba 50 df b7  |.F.i.n.......P..|
-000000a0  c6 45 d8 4a e8 fa 84 3c  be 98 48 28 09 30 35 34  |.E.J...<..H(.054|
-000000b0  cb c0 28 0f c6 46 aa 49  38 16 7f 51 5c e7 86 d0  |..(..F.I8..Q\...|
-000000c0  16 09 9c 42 1c c3 15 4d  db 4d c3 54 fd e0 01 8e  |...B...M.M.T....|
-000000d0  57 ba d7 94 9f 0d a3 38  34 ef 11 ef 3b 14 03 03  |W......84...;...|
-000000e0  00 01 01 16 03 03 00 40  00 00 00 00 00 00 00 00  |.......@........|
-000000f0  00 00 00 00 00 00 00 00  60 a0 d1 54 92 14 51 e2  |........`..T..Q.|
-00000100  4e 9e 8a 25 04 7a 3e a5  ce 98 6d d5 84 c3 81 e6  |N..%.z>...m.....|
-00000110  3a 3b df eb f8 67 b7 6f  99 1c e3 6f d4 c2 6d 0c  |:;...g.o...o..m.|
-00000120  b2 03 c7 0c c9 83 3b ec                           |......;.|
+00000080  14 ef 68 ca 42 c5 4c 67  af 2c 17 93 9b 23 75 eb  |..h.B.Lg.,...#u.|
+00000090  14 42 1b 7a 25 cb 05 f0  c1 bd c8 e7 60 6b 0e 1c  |.B.z%.......`k..|
+000000a0  45 8d 51 32 a6 7c 6d 01  20 34 54 8e dd d5 41 df  |E.Q2.|m. 4T...A.|
+000000b0  fe a1 02 4e b5 d1 0b 49  38 16 7f 51 5c e5 6a 1a  |...N...I8..Q\.j.|
+000000c0  49 22 f3 54 3e f9 69 5c  2a b3 e6 f7 d8 eb d2 f3  |I".T>.i\*.......|
+000000d0  76 65 fa 45 39 d0 15 85  19 40 bd 38 81 50 14 03  |ve.E9....@.8.P..|
+000000e0  03 00 01 01 16 03 03 00  40 00 00 00 00 00 00 00  |........@.......|
+000000f0  00 00 00 00 00 00 00 00  00 d2 17 9f 6a 4e bc aa  |............jN..|
+00000100  fe 5f cf 69 89 42 9a 9b  80 e5 6d 8a dd 0e 70 e1  |._.i.B....m...p.|
+00000110  13 6b d8 ac a2 39 8b 71  e6 f2 f7 57 d2 eb 75 dd  |.k...9.q...W..u.|
+00000120  d8 5f 82 02 96 2f 08 f0  68                       |._.../..h|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 16 03  03 00 40 91 32 55 4e 8a  |..........@.2UN.|
-00000010  72 b6 a4 91 2f 9a 65 8a  6a 1e 37 67 bc 45 1f 40  |r.../.e.j.7g.E.@|
-00000020  59 d2 7a 1a 10 7c bc 52  3c 11 21 12 b6 45 f0 3b  |Y.z..|.R<.!..E.;|
-00000030  7f 28 30 01 25 30 51 10  df f8 aa 34 07 fb 0b 60  |.(0.%0Q....4...`|
-00000040  44 c7 26 81 02 1a c1 bc  e8 67 fb                 |D.&......g.|
+00000000  14 03 03 00 01 01 16 03  03 00 40 3f f0 78 82 66  |..........@?.x.f|
+00000010  1c 1c 9b cf a0 13 30 13  02 ba 01 1f e6 ee e3 51  |......0........Q|
+00000020  66 b6 2d 0b 39 b5 6b 5f  d3 e3 51 e5 b0 03 cd 5e  |f.-.9.k_..Q....^|
+00000030  5b 16 28 cf dc f2 9b c9  fa cd b7 3d 30 e9 79 50  |[.(........=0.yP|
+00000040  1d 73 b2 0a 66 b1 d3 c3  a4 f3 af                 |.s..f......|
 >>> Flow 4 (server to client)
 00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000010  00 00 00 00 00 a8 17 fd  e4 72 57 91 0d 5c 81 69  |.........rW..\.i|
-00000020  90 a2 f9 d0 18 9b df 24  7d 86 d9 c9 c1 f8 07 75  |.......$}......u|
-00000030  78 e0 69 f9 8a 02 ee cb  a3 16 31 ac 35 5f 11 7a  |x.i.......1.5_.z|
-00000040  e0 06 68 0c 00 15 03 03  00 30 00 00 00 00 00 00  |..h......0......|
-00000050  00 00 00 00 00 00 00 00  00 00 b3 3a 79 6e a1 97  |...........:yn..|
-00000060  c1 2a 90 e3 41 b5 49 c0  4d 43 74 69 c6 0d c1 0c  |.*..A.I.MCti....|
-00000070  49 bd a9 4a 54 62 c5 13  c4 83                    |I..JTb....|
+00000010  00 00 00 00 00 3a 2b 11  b9 79 12 43 3d 22 ac 93  |.....:+..y.C="..|
+00000020  b6 31 4a 21 61 0a f2 bf  c4 e3 9a c7 8f de 13 eb  |.1J!a...........|
+00000030  d4 0f 42 55 b5 89 1f 64  61 2b c6 c6 79 fe d1 70  |..BU...da+..y..p|
+00000040  3c 70 e2 ad cc 15 03 03  00 30 00 00 00 00 00 00  |<p.......0......|
+00000050  00 00 00 00 00 00 00 00  00 00 00 59 94 cc f6 ad  |...........Y....|
+00000060  c2 70 88 42 55 91 c6 a3  f5 67 52 36 24 ef dc da  |.p.BU....gR6$...|
+00000070  0c fb 0d a2 7f 77 8a 24  e2 f7                    |.....w.$..|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-AES128-SHA256 b/src/crypto/tls/testdata/Server-TLSv13-AES128-SHA256
index f735610cf9..3d5a826019 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-AES128-SHA256
+++ b/src/crypto/tls/testdata/Server-TLSv13-AES128-SHA256
@@ -1,97 +1,97 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 78 74 90 42 07  |...........xt.B.|
-00000010  8e 49 31 6d f8 1e d8 67  33 dc d3 7b 5a a4 9a 0f  |.I1m...g3..{Z...|
-00000020  e1 b2 71 d6 e1 c7 1e 73  f4 6d 81 20 c7 fe 3d 4d  |..q....s.m. ..=M|
-00000030  c7 fe 07 d9 49 ef e0 e7  1d 9e 84 c8 21 c0 fe 59  |....I.......!..Y|
-00000040  7f 5d 69 8f 4b 49 e0 12  5f ce e9 76 00 04 13 01  |.]i.KI.._..v....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 f9 c0 a4 c6 5f  |..............._|
+00000010  04 e0 32 2f 9e e4 a7 e6  9b e0 6f bd a3 60 4d 7a  |..2/......o..`Mz|
+00000020  a4 ad 5c a7 93 f3 aa e4  10 15 f6 20 b7 d5 8a f0  |..\........ ....|
+00000030  9f 0b b4 da a8 9f af 4b  b3 70 a1 60 cc 01 65 d9  |.......K.p.`..e.|
+00000040  fd d8 e6 3e ad 03 97 44  f9 86 5f aa 00 04 13 01  |...>...D.._.....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 59  |-.....3.&.$... Y|
-000000b0  a7 e1 0f 4f 1c ee e3 14  3f f8 1d 3c ae d5 f6 82  |...O....?..<....|
-000000c0  de b0 37 52 d9 e9 a1 af  68 18 24 19 a6 6b 61     |..7R....h.$..ka|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 6d  |-.....3.&.$... m|
+000000b0  e0 28 0f bf 26 99 ae d5  25 52 86 99 0a 45 1e 71  |.(..&...%R...E.q|
+000000c0  60 ce 9c 41 9c fb ba 7e  f0 53 de 92 4c d8 67     |`..A...~.S..L.g|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 c7 fe 3d 4d  |........... ..=M|
-00000030  c7 fe 07 d9 49 ef e0 e7  1d 9e 84 c8 21 c0 fe 59  |....I.......!..Y|
-00000040  7f 5d 69 8f 4b 49 e0 12  5f ce e9 76 13 01 00 00  |.]i.KI.._..v....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 b7 d5 8a f0  |........... ....|
+00000030  9f 0b b4 da a8 9f af 4b  b3 70 a1 60 cc 01 65 d9  |.......K.p.`..e.|
+00000040  fd d8 e6 3e ad 03 97 44  f9 86 5f aa 13 01 00 00  |...>...D.._.....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 2d 22 50 eb 7e f0  |..........-"P.~.|
-00000090  22 ac 52 1a 63 f4 3c 12  6a 56 e5 5b e6 f4 f4 97  |".R.c.<.jV.[....|
-000000a0  31 17 03 03 02 6d 08 23  fa 9a 63 51 0a 2b 66 37  |1....m.#..cQ.+f7|
-000000b0  1c 66 64 ae 16 c7 bb 53  36 45 20 ca 87 eb 56 9c  |.fd....S6E ...V.|
-000000c0  b2 c4 51 33 b2 f3 dc f0  c4 27 08 64 a1 f7 8c 10  |..Q3.....'.d....|
-000000d0  7d 14 1d 6c 6f 10 39 4b  77 8b 09 28 28 7d 15 b4  |}..lo.9Kw..((}..|
-000000e0  2d 6b 9f 30 99 09 e1 4d  f6 eb 2f d5 c0 09 fc 1c  |-k.0...M../.....|
-000000f0  c0 2f be 35 37 8d 15 39  87 68 d7 e8 9a 94 26 c7  |./.57..9.h....&.|
-00000100  b0 29 10 48 91 b4 7f e8  5f 32 9a 8e 57 79 81 38  |.).H...._2..Wy.8|
-00000110  3c 66 da ce 78 c5 61 03  5e e3 4a 8e 84 32 f2 af  |<f..x.a.^.J..2..|
-00000120  f7 99 83 53 81 bb db 22  c7 81 b4 82 94 42 ec 9e  |...S...".....B..|
-00000130  5f 56 7f 43 2a c1 bf d3  a7 f7 81 8f e6 3a 0e 99  |_V.C*........:..|
-00000140  9f b3 43 ab 08 d7 d3 a9  b1 29 19 c4 7b 42 98 8a  |..C......)..{B..|
-00000150  58 5d 76 41 33 68 6e d8  47 90 85 fd 1b 76 99 ea  |X]vA3hn.G....v..|
-00000160  d1 51 e0 cd 10 e2 9b f2  28 fb 48 f4 c9 b6 6b 55  |.Q......(.H...kU|
-00000170  63 cd da 61 6e 91 d7 05  60 43 0a 7c 8a 01 0e 50  |c..an...`C.|...P|
-00000180  10 0e 4a f9 7f 60 8f 38  1d fd 92 5c d4 9d 3e 15  |..J..`.8...\..>.|
-00000190  70 ac 23 79 d2 47 0a 79  11 91 25 ff 86 2c 60 f8  |p.#y.G.y..%..,`.|
-000001a0  68 cd d2 21 eb db 18 ca  5e 80 a4 8c 88 08 92 e9  |h..!....^.......|
-000001b0  ab 15 25 0d c8 ae fa 45  c2 d9 1f cf 78 1c b5 ec  |..%....E....x...|
-000001c0  07 e2 6e 8a 22 4d 7f 99  3a 11 f6 21 ed 19 f0 63  |..n."M..:..!...c|
-000001d0  ee 1a 56 ea 11 f8 81 2a  2b e5 18 94 fe e2 0a 49  |..V....*+......I|
-000001e0  38 8c e5 9b d4 a0 d8 f8  2e 12 d7 3e b6 26 2d d7  |8..........>.&-.|
-000001f0  37 44 0c 07 10 f1 58 32  de 57 8c a9 86 fa 84 e9  |7D....X2.W......|
-00000200  f8 44 4f ed b1 c4 76 16  a5 1b 95 0c 59 3c 4b a4  |.DO...v.....Y<K.|
-00000210  36 ef 7d c2 88 10 80 34  f3 c2 f6 df 59 da e3 48  |6.}....4....Y..H|
-00000220  83 6b 8a 42 2f e6 35 55  a4 bd e9 52 41 ab 56 41  |.k.B/.5U...RA.VA|
-00000230  71 3d be aa 57 b3 8c 4a  27 c9 85 6d 54 f3 a8 d4  |q=..W..J'..mT...|
-00000240  68 32 73 87 e3 97 e0 6f  6a c3 0e 79 f7 e1 d1 c9  |h2s....oj..y....|
-00000250  9c d1 a7 71 18 a6 37 0f  e8 6a 66 82 74 ff 7b 4e  |...q..7..jf.t.{N|
-00000260  48 af 02 a5 b4 92 3d b5  38 25 d8 34 81 14 53 9f  |H.....=.8%.4..S.|
-00000270  a5 b0 82 74 c1 53 b1 dc  fe 2e 10 64 40 c7 ba 26  |...t.S.....d@..&|
-00000280  34 5c 61 42 86 c9 15 22  c7 02 01 8a 57 58 79 f0  |4\aB..."....WXy.|
-00000290  db 4b 61 85 fe da d8 bb  d9 42 60 ea 59 8b e5 6e  |.Ka......B`.Y..n|
-000002a0  7a 91 2e bc 52 db 15 b4  f1 2c 8f a3 14 5f 66 f4  |z...R....,..._f.|
-000002b0  d0 4e 27 86 04 8f 9b b2  4b b6 42 52 62 c8 d0 83  |.N'.....K.BRb...|
-000002c0  17 65 47 d2 9f 5b 57 06  6e e5 44 92 11 bc 85 fd  |.eG..[W.n.D.....|
-000002d0  6c 22 dc 45 60 d9 9f 6b  18 9d 9c 65 0a f1 6d 6b  |l".E`..k...e..mk|
-000002e0  c0 ba 90 fa 73 4e 26 0a  a2 b1 32 c7 0b 5e 2f 18  |....sN&...2..^/.|
-000002f0  f0 25 24 c9 ec b9 8a 9d  b7 ad 54 fe c2 08 90 7d  |.%$.......T....}|
-00000300  7e 53 62 93 e6 c9 7a 83  82 e7 bf ac 9b ff 33 2f  |~Sb...z.......3/|
-00000310  07 60 e2 17 03 03 00 99  27 6e de 8d 82 fe b9 0f  |.`......'n......|
-00000320  f7 53 71 f5 c9 c7 ff 8f  f0 b5 90 c8 e2 39 19 92  |.Sq..........9..|
-00000330  83 ef f6 0b 02 65 ff 45  2b 28 63 1a 56 25 05 b3  |.....e.E+(c.V%..|
-00000340  77 ea f6 e8 3b 43 e3 d7  41 f2 1a d6 36 ee 75 62  |w...;C..A...6.ub|
-00000350  f7 6e d9 0f 86 fb 39 53  de 79 4c 52 e0 c0 30 f3  |.n....9S.yLR..0.|
-00000360  45 bf 30 22 8a 4a 9a 1d  51 f5 a6 3f 1e ff ba 34  |E.0".J..Q..?...4|
-00000370  06 ba 47 aa d6 21 e5 a2  86 dd 00 b3 fb 31 2d 4a  |..G..!.......1-J|
-00000380  29 9f 2d 3c 85 b3 6d 6b  12 84 81 7c 5a 1b 92 a2  |).-<..mk...|Z...|
-00000390  85 0e a1 58 01 bb 41 ea  89 a9 4f 3d 0f 9d e4 ac  |...X..A...O=....|
-000003a0  af db 64 39 88 5e 67 44  49 e2 3b 0c 04 b2 a0 c6  |..d9.^gDI.;.....|
-000003b0  49 17 03 03 00 35 cb 08  ae 14 58 8b 6f a1 fd 50  |I....5....X.o..P|
-000003c0  ea a3 e4 f2 e4 c6 9f ba  0c af ab ff a3 b7 96 f2  |................|
-000003d0  3f 52 49 f9 4d c6 98 0e  3e 0a c9 14 41 10 bd 69  |?RI.M...>...A..i|
-000003e0  f4 d2 0d c3 bb 4b e1 ca  97 30 65 17 03 03 00 86  |.....K...0e.....|
-000003f0  3e 5a a9 aa e7 18 03 ea  8a 92 c1 32 8c 54 ac 8b  |>Z.........2.T..|
-00000400  4e 30 b7 ab 92 d0 cd 31  72 b7 09 c7 f8 d9 e5 ae  |N0.....1r.......|
-00000410  15 aa 2b 92 93 9e 0e ff  7c ec c0 53 d8 df 00 5d  |..+.....|..S...]|
-00000420  80 09 54 b8 dd 58 8c 80  e8 19 eb 3a d6 90 c1 ab  |..T..X.....:....|
-00000430  67 fc eb 4a 72 8c 77 c6  4b 78 65 2d 30 86 d2 1a  |g..Jr.w.Kxe-0...|
-00000440  87 d7 02 0c 26 73 5f c9  42 8d 80 cb 82 ae 7c 7a  |....&s_.B.....|z|
-00000450  d3 4c 25 bd 9f 9a b6 12  5d 27 52 b1 af e7 57 64  |.L%.....]'R...Wd|
-00000460  d7 eb 04 55 bd 34 0a a8  96 4d 9e 26 8c 0a 8c 41  |...U.4...M.&...A|
-00000470  28 e6 cb 31 07 05                                 |(..1..|
+00000080  03 03 00 01 01 17 03 03  00 17 22 86 b1 3d ec 2d  |.........."..=.-|
+00000090  76 34 3f fc 20 aa 5c 5b  9e c8 a0 40 7a 4e ea 7c  |v4?. .\[...@zN.||
+000000a0  f6 17 03 03 02 6d 65 77  82 9e b8 b4 11 76 10 1d  |.....mew.....v..|
+000000b0  b9 4d a0 22 26 1f ee 0d  13 a7 8e c3 84 f0 e9 45  |.M."&..........E|
+000000c0  ff 68 61 61 48 a1 cf 17  26 17 ab 38 0a 3c 8a 9d  |.haaH...&..8.<..|
+000000d0  54 21 c3 b7 df 06 02 14  53 5f 24 50 00 ab 98 52  |T!......S_$P...R|
+000000e0  97 f5 7a 0e 3a 28 d3 b2  9c 6c a9 1c ca 19 7d 5c  |..z.:(...l....}\|
+000000f0  45 39 eb 65 fb 46 16 cf  84 f5 e6 6a bd 5d a0 f2  |E9.e.F.....j.]..|
+00000100  dd 2d 0e 43 4c c2 79 fd  76 68 5e 53 0e 5f 09 46  |.-.CL.y.vh^S._.F|
+00000110  46 7c b3 49 57 a9 29 19  a0 9a 28 63 90 0e 46 e4  |F|.IW.)...(c..F.|
+00000120  e6 99 7d cf 3a c7 e3 8a  f4 4f 38 06 8d 12 92 f3  |..}.:....O8.....|
+00000130  50 0b 48 dc 84 3c be bf  8a b7 ec 0a 2a 59 9f 5f  |P.H..<......*Y._|
+00000140  18 8a c9 29 f9 f2 24 61  32 ef db c0 07 cb 02 6b  |...)..$a2......k|
+00000150  66 d8 da 15 bd d9 d0 17  17 80 d3 39 c6 45 d6 de  |f..........9.E..|
+00000160  52 f0 7d 4f d8 7e bd b9  7c 04 c8 1f 11 a4 d2 11  |R.}O.~..|.......|
+00000170  a8 2d 33 4f 01 e7 07 b3  21 26 c2 56 45 a2 37 6a  |.-3O....!&.VE.7j|
+00000180  72 4d 25 a3 55 42 a6 f9  d6 71 08 5a 0b d9 be 69  |rM%.UB...q.Z...i|
+00000190  2a 96 87 32 ba 90 e5 12  fc bd d1 03 9f 83 96 fc  |*..2............|
+000001a0  b4 8a 7a 00 3f a9 f3 64  af 6a 43 e4 7a 33 8c ed  |..z.?..d.jC.z3..|
+000001b0  ed 2e c3 92 fe 60 ee 78  af 9e 5b 59 99 53 74 bb  |.....`.x..[Y.St.|
+000001c0  e0 ef 54 3e 78 0c 17 f9  c7 f5 07 8d d1 07 01 36  |..T>x..........6|
+000001d0  9d 17 dd 29 d6 01 50 f7  fa bc f3 2e 34 1f d8 33  |...)..P.....4..3|
+000001e0  bb 23 a3 e2 b6 d6 f4 9a  06 84 d4 5e 9b 81 66 be  |.#.........^..f.|
+000001f0  c5 c4 2e 4a 57 bc ab 3b  1b 49 bf b7 87 32 b1 94  |...JW..;.I...2..|
+00000200  e9 05 e6 0b cf 7b c4 15  b3 43 ec d8 3d 79 97 23  |.....{...C..=y.#|
+00000210  42 75 3f 7c 1a af cc c4  22 f4 60 ce 51 23 14 02  |Bu?|....".`.Q#..|
+00000220  9d aa c2 92 06 69 ed 03  17 59 cf cd 56 19 c9 aa  |.....i...Y..V...|
+00000230  a2 71 e4 1f 3e 9b ec 1d  52 09 ed d1 e6 79 cd e2  |.q..>...R....y..|
+00000240  b1 a7 bd 48 71 56 95 d0  96 a4 28 ab 07 c7 51 0c  |...HqV....(...Q.|
+00000250  f9 f8 69 03 d2 a4 c6 99  06 dc 12 07 cb a9 71 58  |..i...........qX|
+00000260  53 b9 98 07 30 96 10 c2  45 27 45 1d 1e 0b 90 30  |S...0...E'E....0|
+00000270  82 66 84 d0 c4 c4 2d db  63 60 e1 dc 4f 50 61 02  |.f....-.c`..OPa.|
+00000280  2f d5 e6 a1 c5 ae 32 36  7d 51 9c ff 8f 12 2e 1f  |/.....26}Q......|
+00000290  97 e0 f0 67 4c 64 39 87  15 e8 b3 83 96 14 3b d9  |...gLd9.......;.|
+000002a0  f7 2e 6f 2e c8 30 ab 4f  1d 44 4a 08 97 e8 d0 fb  |..o..0.O.DJ.....|
+000002b0  f5 3f df d7 8c f8 6a c2  77 d5 f4 e4 0d dc c8 3a  |.?....j.w......:|
+000002c0  66 68 53 3f 3b bf cc 4f  4f 2b f3 4e 25 d1 8e 60  |fhS?;..OO+.N%..`|
+000002d0  34 f9 a6 d5 1e a5 27 7e  07 15 25 09 34 8b 2b 36  |4.....'~..%.4.+6|
+000002e0  a0 bd 54 8f d1 e9 b7 1f  38 d8 4b c7 ac 52 78 71  |..T.....8.K..Rxq|
+000002f0  17 32 53 4d c5 96 3c 62  6b 78 4f 01 2e 89 90 bf  |.2SM..<bkxO.....|
+00000300  4c c4 12 77 37 95 5a 51  3e e5 31 d4 ad 71 dc e1  |L..w7.ZQ>.1..q..|
+00000310  14 48 48 17 03 03 00 99  60 97 e4 cb 6b f0 10 74  |.HH.....`...k..t|
+00000320  44 00 88 5a af 34 40 b3  d2 1f 48 ea 16 a9 5b b7  |D..Z.4@...H...[.|
+00000330  ea 27 5d 34 7f c8 2f 5d  f9 46 7f f2 ce c9 fc ae  |.']4../].F......|
+00000340  59 c4 a4 75 b3 7b 5a 38  ab b1 4c 82 9e b6 b1 fd  |Y..u.{Z8..L.....|
+00000350  5a f2 69 c1 61 fb 6d 31  08 68 26 d8 70 90 10 12  |Z.i.a.m1.h&.p...|
+00000360  7d 47 99 e1 52 fd fe cb  d6 44 b0 c9 05 25 ab bd  |}G..R....D...%..|
+00000370  23 d2 45 2c b6 05 8d 6e  3a c1 6d df ea 4e bd 55  |#.E,...n:.m..N.U|
+00000380  d0 51 fa 57 95 02 f9 15  b7 d0 9e ec be cc 45 12  |.Q.W..........E.|
+00000390  69 39 3c 5c d9 d3 ed 08  56 17 0c 08 4f 3c 60 4c  |i9<\....V...O<`L|
+000003a0  f7 89 f0 fd f7 88 ed 02  2a 22 bc bf 08 1f 00 a7  |........*"......|
+000003b0  47 17 03 03 00 35 82 e5  0a 8e e0 f5 e2 95 0a 3f  |G....5.........?|
+000003c0  6a 9d 5d 02 e0 57 19 b8  9f c1 48 c3 3e 5e eb a1  |j.]..W....H.>^..|
+000003d0  06 da 46 17 7c c7 07 1b  76 88 bc bc 47 f3 c2 39  |..F.|...v...G..9|
+000003e0  70 ba 17 7b 3a 22 ed 48  b3 23 f1 17 03 03 00 87  |p..{:".H.#......|
+000003f0  99 cb 06 4a 24 80 04 ac  3c 1e 2b 72 c9 45 d3 1f  |...J$...<.+r.E..|
+00000400  a7 30 22 2c 27 6a 01 97  f0 2d ff 82 b9 fd b9 df  |.0",'j...-......|
+00000410  f1 f7 5c 26 7b 70 f7 7b  dd 55 84 8c 3b 28 b5 e4  |..\&{p.{.U..;(..|
+00000420  ea f8 f3 c6 50 6d cd e5  ec 05 98 51 b8 e0 4b 87  |....Pm.....Q..K.|
+00000430  f6 45 9e 6e 9c 98 b8 20  7c 4b 74 38 b3 f8 53 ba  |.E.n... |Kt8..S.|
+00000440  76 95 f6 4f cb c7 3e d3  26 79 16 99 97 1a 0c fb  |v..O..>.&y......|
+00000450  fa 9d 41 aa 0f f5 68 e5  52 0d f3 56 2f 2b e4 22  |..A...h.R..V/+."|
+00000460  f0 12 51 11 21 4d df 10  92 23 53 af 6a 17 e9 8e  |..Q.!M...#S.j...|
+00000470  f6 f1 10 fe 98 da d7                              |.......|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 b9 ad e6 3f 45  |..........5...?E|
-00000010  fa 69 22 89 32 b6 54 65  8a 4c ce 4a 3d 76 95 58  |.i".2.Te.L.J=v.X|
-00000020  29 62 a5 e2 73 37 27 7d  13 43 02 04 37 67 b9 92  |)b..s7'}.C..7g..|
-00000030  c6 6d e9 23 84 fa 9d f8  83 15 53 49 da 56 05 d1  |.m.#......SI.V..|
+00000000  14 03 03 00 01 01 17 03  03 00 35 cc d8 67 80 d4  |..........5..g..|
+00000010  36 90 38 52 46 ab fb f9  69 e3 12 6a 62 a7 81 ba  |6.8RF...i..jb...|
+00000020  38 91 03 dd 09 3e bb 3f  90 b3 f6 f6 69 c0 cb 0d  |8....>.?....i...|
+00000030  57 56 f9 fe b6 43 72 9f  02 2f 12 98 d4 f3 42 81  |WV...Cr../....B.|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e e7 3b 87  f4 2c 65 0c d0 e8 10 83  |......;..,e.....|
-00000010  d9 8b f8 7e 8e ab 64 8b  da 22 36 2a eb 99 15 0d  |...~..d.."6*....|
-00000020  fb 8e 06 17 03 03 00 13  09 a3 c5 58 33 6a 9d 3c  |...........X3j.<|
-00000030  aa 20 d3 02 81 f8 18 f0  fb 6c 66                 |. .......lf|
+00000000  17 03 03 00 1e 33 a7 7b  5d 62 77 a4 51 5e 3e 8d  |.....3.{]bw.Q^>.|
+00000010  d9 1c 0b 3b 75 81 fc dc  85 aa e3 8e 39 8a 8b 4d  |...;u.......9..M|
+00000020  12 f0 66 17 03 03 00 13  c8 2d eb 40 33 59 7c eb  |..f......-.@3Y|.|
+00000030  a7 7f 23 87 86 e1 f6 c3  6b 4a e9                 |..#.....kJ.|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-AES256-SHA384 b/src/crypto/tls/testdata/Server-TLSv13-AES256-SHA384
index 8e9f47609b..325cb90cdc 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-AES256-SHA384
+++ b/src/crypto/tls/testdata/Server-TLSv13-AES256-SHA384
@@ -1,100 +1,100 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 cd 8e c1 d0 5a  |...............Z|
-00000010  f3 76 9f 75 5b ee e9 27  39 dd c9 1f 8f 29 89 36  |.v.u[..'9....).6|
-00000020  4e c7 b9 20 99 2f 90 36  4a e8 bb 20 69 57 2d 73  |N.. ./.6J.. iW-s|
-00000030  5a 64 37 92 08 83 55 56  52 c6 5b 2f b1 98 c7 9f  |Zd7...UVR.[/....|
-00000040  aa aa 19 4d c8 0c ce a0  2d 77 d9 4e 00 04 13 02  |...M....-w.N....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 d2 82 a1 1c 7a  |...............z|
+00000010  d7 ad fb 77 f1 0a 21 b2  b7 31 9c 55 d5 ab 7f 7d  |...w..!..1.U...}|
+00000020  64 ba dd 1f 31 0d c8 a1  93 e3 7f 20 7a a3 e3 78  |d...1...... z..x|
+00000030  b3 07 16 dc fc 47 50 5b  18 82 31 50 04 9a f1 e3  |.....GP[..1P....|
+00000040  2e fc 78 43 5f 49 30 08  ca de 8d 28 00 04 13 02  |..xC_I0....(....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 fd  |-.....3.&.$... .|
-000000b0  87 02 b8 d8 e8 27 13 ec  75 07 cf 90 59 04 df 7a  |.....'..u...Y..z|
-000000c0  87 ff 4b 07 e6 d6 01 23  64 9d 51 a4 75 63 37     |..K....#d.Q.uc7|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 f3  |-.....3.&.$... .|
+000000b0  04 be fd 97 6c 73 6d 9c  a0 74 e4 97 ff 83 8a 55  |....lsm..t.....U|
+000000c0  22 41 ad a5 9c 07 3d 3a  11 f1 33 89 bc e9 3b     |"A....=:..3...;|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 69 57 2d 73  |........... iW-s|
-00000030  5a 64 37 92 08 83 55 56  52 c6 5b 2f b1 98 c7 9f  |Zd7...UVR.[/....|
-00000040  aa aa 19 4d c8 0c ce a0  2d 77 d9 4e 13 02 00 00  |...M....-w.N....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 7a a3 e3 78  |........... z..x|
+00000030  b3 07 16 dc fc 47 50 5b  18 82 31 50 04 9a f1 e3  |.....GP[..1P....|
+00000040  2e fc 78 43 5f 49 30 08  ca de 8d 28 13 02 00 00  |..xC_I0....(....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 d8 3e 22 27 e3 d7  |...........>"'..|
-00000090  29 6a d2 09 58 4f 30 fa  9d 02 13 67 03 e1 37 a7  |)j..XO0....g..7.|
-000000a0  fa 17 03 03 02 6d a0 2d  58 63 73 b6 a6 7f 9e 7c  |.....m.-Xcs....||
-000000b0  dd 03 4c 53 cf e9 04 4e  a0 87 3e 91 79 1e 28 50  |..LS...N..>.y.(P|
-000000c0  6b 6e bc a5 98 35 d8 03  a1 00 47 8d b6 a1 b6 71  |kn...5....G....q|
-000000d0  09 eb d1 d5 cb 56 eb 6f  fb 5c ec 58 99 f6 c3 3a  |.....V.o.\.X...:|
-000000e0  54 c1 7b af 20 9f 1b a6  58 01 fd de e4 2a 17 6d  |T.{. ...X....*.m|
-000000f0  2e 44 38 11 48 5a ec 58  e3 39 5f 91 a9 61 ae c6  |.D8.HZ.X.9_..a..|
-00000100  ba f1 a0 bd 40 30 3f b3  34 f7 b3 52 ee 62 40 bb  |....@0?.4..R.b@.|
-00000110  78 10 d7 e9 86 67 83 94  df 22 db 49 70 58 3b 2d  |x....g...".IpX;-|
-00000120  db 6c 1c 16 7e b1 c9 51  99 8c 5b 1b 09 fe 0b 8f  |.l..~..Q..[.....|
-00000130  84 69 20 31 a4 78 7a 53  d1 ed 57 20 b4 25 a7 a3  |.i 1.xzS..W .%..|
-00000140  95 50 0f ee 48 5f 1f 78  36 47 6d 18 d8 e3 76 b8  |.P..H_.x6Gm...v.|
-00000150  cb 13 b6 11 0e 39 f8 d1  1f 7d 58 7a 33 fe bc 86  |.....9...}Xz3...|
-00000160  f2 6e 73 32 60 5c c6 4b  fe e0 38 52 b7 09 10 4c  |.ns2`\.K..8R...L|
-00000170  f7 2f e2 54 8b a1 29 98  be d4 f7 0e bc 4a 5e 12  |./.T..)......J^.|
-00000180  e6 f2 2b 27 10 68 cd 7b  5f 63 74 6f e8 6f 45 04  |..+'.h.{_cto.oE.|
-00000190  30 67 ac d1 b9 27 c6 84  ce ad 9f 93 ed 49 e5 20  |0g...'.......I. |
-000001a0  5a b7 7c e5 31 ee e4 3f  8c d4 95 eb ff 3e 97 b7  |Z.|.1..?.....>..|
-000001b0  c8 77 45 47 43 f7 c4 92  2d 6c 8e 01 aa 4e da 5f  |.wEGC...-l...N._|
-000001c0  12 ff 65 fa ed 9e 72 3a  82 ab d3 06 9c ab 40 3c  |..e...r:......@<|
-000001d0  b0 af 73 16 15 8c 93 05  f0 50 9b 2d 9b 0d b0 10  |..s......P.-....|
-000001e0  a8 bf 17 a8 44 d7 85 2e  ff 42 c6 f5 84 9e 43 de  |....D....B....C.|
-000001f0  f6 95 e8 89 53 6e ec 72  94 ce 2e 86 6c eb 9e f4  |....Sn.r....l...|
-00000200  5b c0 f8 c7 57 3e 97 a1  e7 7e a4 1b 2d 32 73 2e  |[...W>...~..-2s.|
-00000210  ef 8e 90 bb a0 44 ea 82  85 0f 28 ee ac 0d 3c 26  |.....D....(...<&|
-00000220  5f 67 00 b5 d7 bb 07 9c  0e c1 02 72 e4 dc 0b fd  |_g.........r....|
-00000230  81 c3 ce 0c fa e9 ec 1c  a9 1b 06 fb 6d 98 f3 e1  |............m...|
-00000240  8d 6e fd 65 12 41 d5 7b  c5 c4 a2 8a b7 64 3f d5  |.n.e.A.{.....d?.|
-00000250  64 50 b5 19 34 85 44 63  fa a3 5b 34 fd a4 65 f2  |dP..4.Dc..[4..e.|
-00000260  f4 1c 33 c9 26 84 45 73  8e 83 c9 65 5f c3 e6 4a  |..3.&.Es...e_..J|
-00000270  01 34 dc 00 fb 08 ec b6  36 ae 8f a9 98 bd a3 9b  |.4......6.......|
-00000280  43 ef 4d 22 16 d3 df e4  f7 f1 0c 22 25 8a c3 c9  |C.M"......."%...|
-00000290  df 2b 22 d6 f6 b2 32 ff  d5 41 e9 29 2b 76 f8 1b  |.+"...2..A.)+v..|
-000002a0  55 c5 05 02 23 14 eb fc  4d a3 bd ca 57 f6 90 59  |U...#...M...W..Y|
-000002b0  dc 48 cb bc 50 57 d3 03  bd 9a 80 f1 a1 d9 77 50  |.H..PW........wP|
-000002c0  26 79 16 50 ea f6 22 53  f2 62 11 c2 5e 1f d6 56  |&y.P.."S.b..^..V|
-000002d0  7a ad b6 f8 d9 35 4f a8  2e 3a b8 7a f3 36 7c 0e  |z....5O..:.z.6|.|
-000002e0  47 d3 cf 23 c5 c4 e1 fa  f0 43 4a 7c e8 13 e3 bf  |G..#.....CJ|....|
-000002f0  3a a0 a3 84 d1 ef 9f d4  02 b3 a8 36 9f 89 d3 3f  |:..........6...?|
-00000300  d1 51 b0 b8 c6 14 94 a1  78 b7 1b 6a 31 91 f4 91  |.Q......x..j1...|
-00000310  66 66 7c 17 03 03 00 99  cf 79 f1 cd 93 6f 58 e5  |ff|......y...oX.|
-00000320  94 9c 42 3d b2 d3 2a 74  fc 5d 2d a3 7c 7d 5b 1c  |..B=..*t.]-.|}[.|
-00000330  ff c7 1d dd 1f a0 aa c3  9f db 50 ec 2a e8 ba 4c  |..........P.*..L|
-00000340  c9 6f f1 a3 cf de a7 33  bb 0c 2c 5f 1a c3 31 1c  |.o.....3..,_..1.|
-00000350  01 c0 d4 86 cb 91 97 53  a7 c5 11 22 d6 8d 17 2e  |.......S..."....|
-00000360  8e 6b 83 91 99 4c 93 bb  73 2d 07 61 c1 40 c2 3d  |.k...L..s-.a.@.=|
-00000370  68 de 07 38 e4 30 05 ec  2b d5 ff 25 ed 86 ae 0d  |h..8.0..+..%....|
-00000380  b4 b1 59 03 32 3e 06 86  6a b5 f5 6a 77 9f 32 71  |..Y.2>..j..jw.2q|
-00000390  2d 60 56 75 55 28 d0 8e  99 e7 a4 5e b8 2f 16 00  |-`VuU(.....^./..|
-000003a0  57 07 bb 6e 8e 12 6b 2c  9a dc 08 32 e7 51 ff f7  |W..n..k,...2.Q..|
-000003b0  f7 17 03 03 00 45 43 af  d9 02 71 82 e1 e7 3c b7  |.....EC...q...<.|
-000003c0  d0 4e 00 d6 dd 5e 9f 43  9a ac 54 df ea 1e 71 64  |.N...^.C..T...qd|
-000003d0  9a 87 66 f9 f9 c2 12 e0  ec c2 49 91 2c 13 4f 66  |..f.......I.,.Of|
-000003e0  49 89 e2 66 31 e5 36 6a  ae 2e a1 b8 4e 22 e8 55  |I..f1.6j....N".U|
-000003f0  ee 63 cb 6c 30 9d 88 80  de 97 0c 17 03 03 00 96  |.c.l0...........|
-00000400  0e 46 97 49 0a 02 66 e4  47 b3 41 10 43 fa f6 11  |.F.I..f.G.A.C...|
-00000410  2b 0b 2a 17 d0 f3 07 fe  ee c3 f5 a9 c7 74 78 a6  |+.*..........tx.|
-00000420  17 88 d7 cf d8 c0 86 bd  29 98 57 9c c5 8e 5c 87  |........).W...\.|
-00000430  b6 5e e7 9d 3f 61 c2 5b  a6 f9 4c 43 8b b9 80 88  |.^..?a.[..LC....|
-00000440  00 bf 5e f4 97 f0 b1 f6  46 fb cd 72 03 4c f3 fe  |..^.....F..r.L..|
-00000450  90 94 c3 25 84 6c 2a 34  c2 1c c0 28 e1 a1 1f a1  |...%.l*4...(....|
-00000460  5a e2 f6 d8 45 e0 15 c1  98 bc dd 08 51 df fd 64  |Z...E.......Q..d|
-00000470  98 2c fa 7c dd e5 bb 96  df eb 2d 1b 91 4f 4b 1d  |.,.|......-..OK.|
-00000480  2c 67 6d d7 55 fa 7c 86  dc f1 5f 95 fd 7c cc 07  |,gm.U.|..._..|..|
-00000490  9f c8 a9 2f df c9                                 |.../..|
+00000080  03 03 00 01 01 17 03 03  00 17 4d e5 22 bd f4 3c  |..........M."..<|
+00000090  12 74 90 1e 49 3b 2f d7  bc 97 22 ef e8 a2 4c cd  |.t..I;/..."...L.|
+000000a0  ae 17 03 03 02 6d 65 3e  11 94 12 ce ba bd 89 a4  |.....me>........|
+000000b0  02 4e f2 02 33 01 54 d0  61 f4 a5 ff fc f3 04 25  |.N..3.T.a......%|
+000000c0  dc 70 aa 6f 49 9b d9 8a  73 1d 6b 88 3d c6 48 06  |.p.oI...s.k.=.H.|
+000000d0  ef cb 13 c7 a5 c5 97 14  34 08 ac e3 4f 11 db 56  |........4...O..V|
+000000e0  69 56 41 cb c2 13 79 d8  52 16 9c f0 8d c3 40 2d  |iVA...y.R.....@-|
+000000f0  9e 33 2a a7 5b 88 85 2d  ff c8 56 f9 6a 81 d6 53  |.3*.[..-..V.j..S|
+00000100  97 14 c0 d6 b8 ef 85 42  ce 99 a1 8a 02 46 00 13  |.......B.....F..|
+00000110  9a 6b 7d 29 04 e1 40 90  76 37 00 35 16 b0 04 85  |.k})..@.v7.5....|
+00000120  3c cf 6f 1a 79 9a e0 30  d0 03 11 e1 4f bb f9 27  |<.o.y..0....O..'|
+00000130  de 15 b9 32 18 9d 22 c0  af ab 44 ac 35 5d da 90  |...2.."...D.5]..|
+00000140  04 81 c9 b6 55 17 40 02  6b 99 9f 6f c9 c5 6b 56  |....U.@.k..o..kV|
+00000150  07 e7 60 51 35 d5 5a 13  77 cd fb 78 7b 64 01 f3  |..`Q5.Z.w..x{d..|
+00000160  a7 5e b8 c8 3f 62 42 c4  45 d7 d0 2c 5a 9e e1 7f  |.^..?bB.E..,Z...|
+00000170  9a 45 35 f8 e3 eb 14 79  0e b0 ef 85 79 44 78 30  |.E5....y....yDx0|
+00000180  85 83 e5 87 d1 6e 71 cc  e7 39 8d 2d 42 38 24 b1  |.....nq..9.-B8$.|
+00000190  b9 66 74 3b 34 6b a7 8a  ce 4b 33 c9 e8 85 13 6d  |.ft;4k...K3....m|
+000001a0  5e 6e 89 b0 e4 88 ff d2  ca 4d 24 f0 1a c7 e1 91  |^n.......M$.....|
+000001b0  6f 50 69 2d 4d 94 65 d5  aa 9e e3 fe cc d7 38 ac  |oPi-M.e.......8.|
+000001c0  59 b2 3a 2a 3d 72 6e db  09 af c4 b0 d5 17 21 1e  |Y.:*=rn.......!.|
+000001d0  ef 62 30 8f 8f 57 2e 34  31 e8 ef 0d 43 75 10 63  |.b0..W.41...Cu.c|
+000001e0  02 b0 ae 92 d2 59 78 0c  8b 0c 7d 2b 8d 37 61 d7  |.....Yx...}+.7a.|
+000001f0  d0 81 37 c7 2a 0a 0e 5d  34 a2 c2 e9 e2 86 dc dd  |..7.*..]4.......|
+00000200  c9 d1 ab 76 0d d6 eb 53  ca 8f 0a 62 0b 06 19 39  |...v...S...b...9|
+00000210  51 be f6 ac 1d 53 9c 80  4c e7 44 fd 0f 31 9c f2  |Q....S..L.D..1..|
+00000220  fd 37 0b 61 96 ee a0 dc  cf 61 25 7e d2 cf 72 16  |.7.a.....a%~..r.|
+00000230  21 c2 7c a7 c7 45 3b 8a  a2 6e 98 85 6e b6 c8 e9  |!.|..E;..n..n...|
+00000240  a0 10 be dc 4f 44 6a 4f  ea 4c 5a a8 16 27 a5 91  |....ODjO.LZ..'..|
+00000250  56 55 ca 0c 87 2d 53 b1  08 01 4c 29 69 e9 0f b0  |VU...-S...L)i...|
+00000260  13 3f 85 bd 77 a4 c9 bd  2e 2b 25 cd 6f ca cb 3e  |.?..w....+%.o..>|
+00000270  c7 d7 6f 30 c8 f0 59 80  c2 0b dc 82 ea 03 c1 e6  |..o0..Y.........|
+00000280  b1 66 87 e2 e0 a5 74 67  52 6e 91 5d 91 4f a4 cc  |.f....tgRn.].O..|
+00000290  23 66 5c 13 d9 82 aa 92  5c df c7 78 9d 85 b6 93  |#f\.....\..x....|
+000002a0  f8 d9 1c b9 43 42 1e b8  a1 ec 54 9f 3c b0 5d 73  |....CB....T.<.]s|
+000002b0  a7 d3 67 09 de 23 d8 dc  b9 0b 05 f5 17 26 77 47  |..g..#.......&wG|
+000002c0  a1 1c 06 5b 6a ac 17 57  03 8f ec a6 31 4e f6 a2  |...[j..W....1N..|
+000002d0  e9 5f 54 96 7c 88 8c d3  3a 81 78 43 87 dc 03 d4  |._T.|...:.xC....|
+000002e0  a2 bd ea dd 0c 8d 96 ce  cc ac 5a 61 9d 7b b7 b9  |..........Za.{..|
+000002f0  57 58 12 8c 50 45 49 0b  83 d4 da 05 79 4d 16 0d  |WX..PEI.....yM..|
+00000300  c5 8a ee ca df 61 8f 75  57 dd 9a af 88 5a c5 36  |.....a.uW....Z.6|
+00000310  e2 3d 5b 17 03 03 00 99  92 29 a9 08 fc 03 57 eb  |.=[......)....W.|
+00000320  e1 14 9e ba 07 88 38 68  4e bc bc 8c 72 c6 44 71  |......8hN...r.Dq|
+00000330  d2 ad f5 38 4b 43 bc 05  1a 8e 7c 8d 91 66 70 26  |...8KC....|..fp&|
+00000340  fe a5 d3 c8 3b fb dd 44  53 73 31 01 54 09 dc df  |....;..DSs1.T...|
+00000350  c1 8a 67 7e c0 99 d8 6c  fc 00 fb 69 f8 d3 12 0a  |..g~...l...i....|
+00000360  6d 5a 5f 4b 42 f9 0a a9  d7 2a c0 d7 d1 05 b0 79  |mZ_KB....*.....y|
+00000370  44 1c 69 b1 c4 d9 fc ff  1e 62 95 7f c1 70 f1 b5  |D.i......b...p..|
+00000380  da af ff 5a 41 47 a8 7f  ff 35 03 4d ac 1c 24 09  |...ZAG...5.M..$.|
+00000390  12 88 ff 1d 1d f3 bc 1f  b2 57 8a 26 43 92 02 7e  |.........W.&C..~|
+000003a0  1c c2 31 56 1c d4 5e 12  fa 53 91 03 4b 2c 11 52  |..1V..^..S..K,.R|
+000003b0  94 17 03 03 00 45 7c 97  c5 b9 f8 de 80 9e 51 71  |.....E|.......Qq|
+000003c0  4b 17 eb d5 a0 55 13 1f  43 dc 58 d9 72 bd 9d 36  |K....U..C.X.r..6|
+000003d0  dc 18 38 11 28 0f b7 94  06 01 ba 05 7f 7e 3f 43  |..8.(........~?C|
+000003e0  1e f2 fe 43 64 6f d1 88  78 23 38 5a 8d 21 f9 b2  |...Cdo..x#8Z.!..|
+000003f0  8c 6d 88 df f3 ba 71 e6  c6 3f 96 17 03 03 00 97  |.m....q..?......|
+00000400  74 19 44 58 88 9c da 45  44 78 db 5d 4a fd a2 00  |t.DX...EDx.]J...|
+00000410  af 10 ff 47 64 a0 f0 44  64 64 c0 e5 df 8c 1e 3c  |...Gd..Ddd.....<|
+00000420  6c ae 98 3f bf f0 05 4a  be 95 e6 35 d9 54 c8 87  |l..?...J...5.T..|
+00000430  bf 4b 1d 5b c2 f9 4d ec  01 09 b3 25 d6 ac 0f 6d  |.K.[..M....%...m|
+00000440  2c 5b c4 d0 ab 52 f7 39  b9 2f 6c e3 78 19 92 9d  |,[...R.9./l.x...|
+00000450  51 20 6d db 34 b8 c2 d1  cf a4 d8 ee 0a 9a 78 60  |Q m.4.........x`|
+00000460  20 71 6f 08 26 3b d0 75  a2 4f df 0a 36 2c bc 69  | qo.&;.u.O..6,.i|
+00000470  de 41 23 c1 6f f3 03 91  97 c4 4b 4a 4f 54 18 96  |.A#.o.....KJOT..|
+00000480  41 ad 62 d1 b1 c2 f8 cb  b7 72 23 0a 7b cd 40 a9  |A.b......r#.{.@.|
+00000490  9a 4f ea f8 af 05 7d                              |.O....}|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 45 f8 ae df dc 18  |..........E.....|
-00000010  cc 64 0b 01 f1 41 54 e4  32 75 06 01 fc 9f 92 cc  |.d...AT.2u......|
-00000020  8b 22 83 bf dc 10 cd 1d  24 7b be b0 25 93 2b f9  |."......${..%.+.|
-00000030  21 2e 81 e7 09 46 4e 8e  67 a1 69 6d 40 ad 90 54  |!....FN.g.im@..T|
-00000040  11 04 06 be f9 7c 76 4f  f2 a3 4e ad 2e 81 0d ec  |.....|vO..N.....|
+00000000  14 03 03 00 01 01 17 03  03 00 45 94 19 4b 1a 6c  |..........E..K.l|
+00000010  e0 52 9b 9e 12 b7 c4 59  32 b5 fa 8d 11 72 0e 0a  |.R.....Y2....r..|
+00000020  b8 3a 70 15 a7 c5 74 70  e0 6f 41 c1 5c 0b 43 73  |.:p...tp.oA.\.Cs|
+00000030  0e 14 7a e2 2b 65 2c 96  6e 21 61 2b 4f b8 4e f1  |..z.+e,.n!a+O.N.|
+00000040  65 c2 a2 d4 31 f5 f7 93  86 1f 53 aa 39 d1 56 cd  |e...1.....S.9.V.|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e c5 a1 21  ce b9 c0 c1 b8 82 0f 1a  |.......!........|
-00000010  4e 72 51 5b ad 3f e1 ca  da f7 17 a1 4e 09 b7 3a  |NrQ[.?......N..:|
-00000020  f0 2f 66 17 03 03 00 13  3b 3f aa 77 c3 e6 c9 f5  |./f.....;?.w....|
-00000030  a3 c2 4a 21 3b db f3 e5  c1 16 f6                 |..J!;......|
+00000000  17 03 03 00 1e 4f 8f be  14 c3 c7 c3 9a 72 26 01  |.....O.......r&.|
+00000010  d7 6a 23 51 0d 0e 63 b0  b0 95 5d 15 44 71 ce 60  |.j#Q..c...].Dq.`|
+00000020  c0 bc 54 17 03 03 00 13  6c 72 16 fc b9 f2 66 c8  |..T.....lr....f.|
+00000030  2b 61 90 ab 05 02 0c e0  12 b0 d1                 |+a.........|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ALPN b/src/crypto/tls/testdata/Server-TLSv13-ALPN
index 142d4e48a6..92bb51b80e 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ALPN
+++ b/src/crypto/tls/testdata/Server-TLSv13-ALPN
@@ -1,9 +1,9 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 e2 01 00 00  de 03 03 a4 e8 c2 98 b2  |................|
-00000010  24 e6 24 8e 1b 39 ea 99  5d b7 81 59 ea 82 15 10  |$.$..9..]..Y....|
-00000020  f3 bd 73 52 df ad b4 cc  78 f3 a7 20 52 33 05 f6  |..sR....x.. R3..|
-00000030  bd 55 9c 7a 83 3c 95 c9  d9 2e 07 52 d1 63 cf b4  |.U.z.<.....R.c..|
-00000040  c3 17 2c 3e 64 e1 8a 00  ae 1b 90 7f 00 04 13 03  |..,>d...........|
+00000000  16 03 01 00 e2 01 00 00  de 03 03 2e e8 1a 78 13  |..............x.|
+00000010  b1 35 2f d1 8a 01 b5 0f  27 a7 67 d8 b3 b3 b7 9c  |.5/.....'.g.....|
+00000020  e9 86 8b 8d 3e 40 2b 69  05 c5 f2 20 33 4d 75 fe  |....>@+i... 3Mu.|
+00000030  78 ff 77 7d 59 fc 2b 52  d0 f5 8d 17 99 74 d4 55  |x.w}Y.+R.....t.U|
+00000040  ab 36 4c 9b f4 c7 e3 c7  b3 af 4f 2f 00 04 13 03  |.6L.......O/....|
 00000050  00 ff 01 00 00 91 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 10 00 10 00 0e  06 70 72 6f 74 6f 32 06  |.........proto2.|
@@ -11,92 +11,90 @@
 00000090  00 1e 00 1c 04 03 05 03  06 03 08 07 08 08 08 09  |................|
 000000a0  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
 000000b0  00 2b 00 03 02 03 04 00  2d 00 02 01 01 00 33 00  |.+......-.....3.|
-000000c0  26 00 24 00 1d 00 20 49  6b b8 0f d9 19 e4 0e 14  |&.$... Ik.......|
-000000d0  c8 af 36 9a a5 57 3d 1c  aa 5b c2 ba 52 a7 50 d2  |..6..W=..[..R.P.|
-000000e0  13 04 c0 c7 d1 fb 2c                              |......,|
+000000c0  26 00 24 00 1d 00 20 3b  c9 4d 90 a7 cf 43 df cd  |&.$... ;.M...C..|
+000000d0  a7 de 9f 3b 2c 07 dc 7b  9c 40 f1 45 f2 d1 d2 7a  |...;,..{.@.E...z|
+000000e0  03 3e d1 35 90 f1 35                              |.>.5..5|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 52 33 05 f6  |........... R3..|
-00000030  bd 55 9c 7a 83 3c 95 c9  d9 2e 07 52 d1 63 cf b4  |.U.z.<.....R.c..|
-00000040  c3 17 2c 3e 64 e1 8a 00  ae 1b 90 7f 13 03 00 00  |..,>d...........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 33 4d 75 fe  |........... 3Mu.|
+00000030  78 ff 77 7d 59 fc 2b 52  d0 f5 8d 17 99 74 d4 55  |x.w}Y.+R.....t.U|
+00000040  ab 36 4c 9b f4 c7 e3 c7  b3 af 4f 2f 13 03 00 00  |.6L.......O/....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 24 27 e9 f2 b6 05 c9  |.........$'.....|
-00000090  c6 31 c2 91 79 c9 fb 8d  e7 54 42 b9 f9 8f 63 0a  |.1..y....TB...c.|
-000000a0  96 33 46 bb ef 88 47 16  14 1e dc 2e 00 02 17 03  |.3F...G.........|
-000000b0  03 02 6d b6 5a 13 ee 5f  27 b7 1a 4d c2 21 32 42  |..m.Z.._'..M.!2B|
-000000c0  62 c4 0d d6 62 78 13 c5  43 9e f3 ad d4 bb df 2f  |b...bx..C....../|
-000000d0  2c e6 91 a2 5b 78 52 3d  17 4a 3c d2 fd f6 78 12  |,...[xR=.J<...x.|
-000000e0  1a 53 17 ce 24 e0 24 9f  14 d4 b8 81 6f f2 18 eb  |.S..$.$.....o...|
-000000f0  01 49 dd 73 f4 bf 2b 0e  3f 9d f7 58 a9 76 f4 d3  |.I.s..+.?..X.v..|
-00000100  31 c4 a3 d1 bd bb a2 2b  6f 55 53 50 c1 07 74 4d  |1......+oUSP..tM|
-00000110  18 02 ca c8 ba df 14 5a  93 ab 82 10 2f d1 ff 8c  |.......Z..../...|
-00000120  58 04 4c 56 76 05 75 67  48 04 e9 3d 9b b7 9d 50  |X.LVv.ugH..=...P|
-00000130  7c 0e 7e fa 2e 0e e6 dc  6f 10 18 f5 6f 7c 92 54  ||.~.....o...o|.T|
-00000140  3a d8 39 a1 ee e6 a9 bf  ca 58 c8 29 9c 88 53 ad  |:.9......X.)..S.|
-00000150  6c a5 09 8f e3 71 d3 68  1c 62 4b 2f ea cc b3 2f  |l....q.h.bK/.../|
-00000160  7f 0f 17 04 ad 03 78 35  06 6e c7 90 02 ab 3d a3  |......x5.n....=.|
-00000170  64 6e 57 db 41 de ec d2  7b ad 5e f6 9d 21 09 e6  |dnW.A...{.^..!..|
-00000180  34 72 20 58 74 04 ac 6d  f3 6f 25 e8 42 85 69 8e  |4r Xt..m.o%.B.i.|
-00000190  97 fb 9a af c6 2b 9f 12  94 b8 8b fe 27 d3 82 19  |.....+......'...|
-000001a0  07 89 bd ce 2c cc c5 41  77 af df 83 dd 6d e1 b2  |....,..Aw....m..|
-000001b0  28 ed 33 56 60 18 43 74  bd 75 86 14 00 46 97 2e  |(.3V`.Ct.u...F..|
-000001c0  06 e3 08 e8 a4 9c ae 3a  05 7c b0 8b 8b 73 16 f7  |.......:.|...s..|
-000001d0  4f 30 b4 3d 9b 41 15 88  33 30 b9 9e 96 06 01 45  |O0.=.A..30.....E|
-000001e0  a8 96 ec a5 b1 44 2f 92  c3 87 aa c2 a7 38 a3 2e  |.....D/......8..|
-000001f0  46 c5 29 0d 68 0e ea 2c  fb 85 e0 b4 2b b5 10 f1  |F.).h..,....+...|
-00000200  8a d0 6c 06 dc 5f 12 0a  1c e2 a6 a7 e3 ad 58 ca  |..l.._........X.|
-00000210  90 77 8e b9 38 17 a5 c5  69 fd 6e e9 6e 16 72 e9  |.w..8...i.n.n.r.|
-00000220  24 6a 94 5d 90 94 6b 56  b9 59 cb 2f 1d dc 6d cf  |$j.]..kV.Y./..m.|
-00000230  2b b1 fb 1f 6b 5e 34 bd  00 69 63 c6 e5 54 23 6b  |+...k^4..ic..T#k|
-00000240  65 89 fb 52 e0 7c d6 95  e3 0b 77 b1 93 39 74 1b  |e..R.|....w..9t.|
-00000250  a0 2a 26 1d 1c 25 09 7b  28 20 90 7d 58 a1 7b 76  |.*&..%.{( .}X.{v|
-00000260  d9 38 5c 65 3a b4 10 c9  f0 84 28 76 87 03 86 ac  |.8\e:.....(v....|
-00000270  4b 2e 42 ce e9 67 76 48  ae 40 ca aa 6e 31 7e 78  |K.B..gvH.@..n1~x|
-00000280  f9 67 ae 6c c1 71 6b 37  0f a6 bb 43 b1 0e 13 7e  |.g.l.qk7...C...~|
-00000290  39 12 68 09 bf 3e 58 16  53 e2 0e 48 e2 ed 2c 91  |9.h..>X.S..H..,.|
-000002a0  50 fc c1 4d be 3c a7 33  9e b1 b5 4d 1a 56 20 33  |P..M.<.3...M.V 3|
-000002b0  36 81 df 4f 6d 48 8e 98  60 ae e0 0f c2 c4 ea ed  |6..OmH..`.......|
-000002c0  1c d9 a5 73 d6 76 62 6d  1b e0 cf 3f 29 1c a9 62  |...s.vbm...?)..b|
-000002d0  d8 8d ef 26 68 08 1a 15  7b 5e ca 68 83 e0 f9 08  |...&h...{^.h....|
-000002e0  ff d4 60 fd 32 ad 97 b3  05 98 57 f6 70 fa c0 13  |..`.2.....W.p...|
-000002f0  35 a0 61 0e d1 33 95 da  58 5e 4e ad f5 9e e6 37  |5.a..3..X^N....7|
-00000300  e6 3b 6a a7 ca 14 c5 b7  89 7a 9c 41 97 27 59 f5  |.;j......z.A.'Y.|
-00000310  21 22 06 a2 3c 67 4d 48  f7 4d fa dd 00 87 1b e4  |!"..<gMH.M......|
-00000320  17 03 03 00 99 87 17 f8  15 b7 9a d1 5b 0e 71 c9  |............[.q.|
-00000330  54 5f d9 98 5c 78 ad e0  d6 43 e5 3c 98 11 02 49  |T_..\x...C.<...I|
-00000340  66 04 e1 1e 89 fb d0 dc  f9 06 3c 01 a0 8b 3d 12  |f.........<...=.|
-00000350  57 10 9a 56 9d d4 11 d5  c6 b8 46 f4 3f d2 97 b4  |W..V......F.?...|
-00000360  5c 09 ed 82 3d d4 42 37  c8 33 31 94 fb 56 32 f6  |\...=.B7.31..V2.|
-00000370  4e a0 f9 5d dd fc 2f 52  4e 9a 41 f8 1d f1 21 e7  |N..]../RN.A...!.|
-00000380  2a c3 c1 88 27 43 8c 35  97 57 e2 e5 3e b8 62 59  |*...'C.5.W..>.bY|
-00000390  84 7f 92 12 da 53 8b e3  e1 74 2f 4e cd 30 81 67  |.....S...t/N.0.g|
-000003a0  c0 d5 b9 a9 6b a7 b5 b5  6f 28 3b 5b 70 53 d9 db  |....k...o(;[pS..|
-000003b0  63 55 b3 67 ad 85 2a c1  5f f1 f6 de 03 87 17 03  |cU.g..*._.......|
-000003c0  03 00 35 6d 6c ab b4 2b  ff d1 19 f2 a5 3b 44 5d  |..5ml..+.....;D]|
-000003d0  35 77 97 fb d1 14 38 ce  ff ae a3 6d 1b 1a 34 43  |5w....8....m..4C|
-000003e0  c9 d5 f2 be 0d 38 8d bb  38 5e 3b 61 f2 e4 6b a7  |.....8..8^;a..k.|
-000003f0  1c 29 2a bc 6c c3 32 86  17 03 03 00 86 b8 79 43  |.)*.l.2.......yC|
-00000400  01 bd 74 c8 ab 1c cf 64  38 f8 34 99 d2 2d 80 3a  |..t....d8.4..-.:|
-00000410  4d f9 b4 53 51 72 cf ba  ee 58 a7 c4 cd c6 d8 bf  |M..SQr...X......|
-00000420  0c aa f4 a6 bd f6 c7 aa  3e 61 13 39 80 82 34 2c  |........>a.9..4,|
-00000430  80 d8 e5 3b 98 a5 20 08  c7 a7 d7 af 7b d9 47 b8  |...;.. .....{.G.|
-00000440  b3 4f fa 20 ea b8 d8 4f  6c c0 b9 46 81 fb 06 66  |.O. ...Ol..F...f|
-00000450  3b 2b 7f f7 a0 be ab 1e  92 d6 2b 3e 66 9f b9 9e  |;+........+>f...|
-00000460  f1 6c d9 ad a9 11 a7 2a  a5 ff f8 e7 5b ce cf a4  |.l.....*....[...|
-00000470  eb 7a 92 08 72 21 44 f5  5c 1a 92 95 5f ea e8 dc  |.z..r!D.\..._...|
-00000480  63 7d d7                                          |c}.|
+00000080  03 03 00 01 01 17 03 03  00 24 4c 67 ee 74 f2 40  |.........$Lg.t.@|
+00000090  8d 45 8f fc ca 38 87 91  6b 84 27 c6 98 01 51 f3  |.E...8..k.'...Q.|
+000000a0  72 a9 4a e9 18 f1 66 55  3b 5f a0 00 fe 1c 17 03  |r.J...fU;_......|
+000000b0  03 02 6d 2c 30 58 8e 9b  e9 39 18 81 5b 0f e7 b5  |..m,0X...9..[...|
+000000c0  cc 1f cb 4c 76 17 4f 64  a3 58 d4 70 d6 5f 8b c8  |...Lv.Od.X.p._..|
+000000d0  0e a6 6b e5 ee 64 67 3d  d7 b6 34 ce f2 5d 2f 25  |..k..dg=..4..]/%|
+000000e0  5c 41 6b b9 58 cf 93 da  b7 8e 74 7e c7 91 ad db  |\Ak.X.....t~....|
+000000f0  e3 55 f8 24 f6 22 81 1e  18 6a 01 b8 29 cb 2a 53  |.U.$."...j..).*S|
+00000100  93 67 82 d4 97 34 29 ba  13 25 0a 0c ed 24 35 ec  |.g...4)..%...$5.|
+00000110  d8 d4 3e 6e cd d3 4c b4  26 75 df 32 5e 29 b0 da  |..>n..L.&u.2^)..|
+00000120  63 e7 e0 4a bd 59 50 3c  71 a6 af 5f 5d f4 b8 9d  |c..J.YP<q.._]...|
+00000130  37 66 3f b8 13 85 e1 7e  c4 b0 6a fe ad 0c 74 ce  |7f?....~..j...t.|
+00000140  36 1c 6d 03 8a 5f 5c c1  e8 4b 00 06 1f 29 90 a9  |6.m.._\..K...)..|
+00000150  af e5 9f 35 1d 7a 0f 07  b7 ae d2 84 c5 48 bc b0  |...5.z.......H..|
+00000160  98 c7 3b 20 a4 0a 0c 18  79 5e 85 65 ce 08 ad 1b  |..; ....y^.e....|
+00000170  bb ac 59 f4 ed cf e3 32  0b 16 00 12 30 56 2c 33  |..Y....2....0V,3|
+00000180  2b 67 10 4d 59 07 13 a4  5f 28 8f bb 3a 6e bb cb  |+g.MY..._(..:n..|
+00000190  92 15 c4 03 d4 e0 37 82  2a 54 07 c4 e1 95 ed 67  |......7.*T.....g|
+000001a0  3f 3a 9a 02 e1 6b 3b a5  74 68 13 92 10 e2 df 73  |?:...k;.th.....s|
+000001b0  04 2c e6 20 d7 a0 55 be  0e 98 27 10 8f b7 11 52  |.,. ..U...'....R|
+000001c0  9a 20 2b 8b d2 b8 5b fe  0d 30 8c ab 63 cc 3f ca  |. +...[..0..c.?.|
+000001d0  38 5d 27 16 fe 42 3b ad  de 37 d0 b9 fc eb 13 7d  |8]'..B;..7.....}|
+000001e0  af de 82 2b 43 60 ab 8a  12 10 d1 06 98 64 e7 bd  |...+C`.......d..|
+000001f0  ac 00 a0 7d 2b 19 77 b4  76 40 33 3e 8f 35 19 67  |...}+.w.v@3>.5.g|
+00000200  02 7a f3 b0 47 f1 3f c6  ef 81 19 02 48 3a 9f 67  |.z..G.?.....H:.g|
+00000210  c0 08 82 ce d2 db 07 14  fe d7 7c 2c b3 40 3c 88  |..........|,.@<.|
+00000220  92 9a 3a 1b 5d 5a c9 ee  f8 92 de 40 4f 96 ac ee  |..:.]Z.....@O...|
+00000230  99 71 47 5c 0c de 92 eb  24 b6 2c 6d c0 e9 37 d0  |.qG\....$.,m..7.|
+00000240  1f d8 ec 8c b8 ab d9 01  91 6f 35 57 14 fb 98 ce  |.........o5W....|
+00000250  17 60 fd a1 5a 90 f2 6f  32 32 98 94 ab ed 02 f7  |.`..Z..o22......|
+00000260  72 54 f0 e3 c0 fa 56 1b  d8 05 c7 c4 15 d0 1c b7  |rT....V.........|
+00000270  71 f1 3f 01 cf 63 97 8a  02 73 d2 97 15 2c 70 c1  |q.?..c...s...,p.|
+00000280  bf bc 5e 4f 01 58 81 f6  59 c2 45 c3 d4 95 ff 8f  |..^O.X..Y.E.....|
+00000290  ae 10 97 e2 ab ac c6 da  ed cb 6f a0 b8 5d 2c a1  |..........o..],.|
+000002a0  01 1d 96 7a 30 86 8b cf  fb b4 b6 d5 95 9c 0c b8  |...z0...........|
+000002b0  47 2c 49 bf c7 6a 76 b8  f5 28 4b d6 20 5c 0e 37  |G,I..jv..(K. \.7|
+000002c0  29 6a 45 2b 1c 4e db ed  2e 38 88 de f0 07 14 a9  |)jE+.N...8......|
+000002d0  04 33 3b 31 16 47 74 cc  02 24 b7 0b 05 a9 4e 74  |.3;1.Gt..$....Nt|
+000002e0  d8 c4 37 53 78 fc ef 4d  e2 b5 72 2a 5c e0 68 5b  |..7Sx..M..r*\.h[|
+000002f0  14 28 52 a8 92 6e 88 62  52 b7 bf 4a 5e 88 a9 f5  |.(R..n.bR..J^...|
+00000300  08 08 04 9d 0a dc 4f e6  39 80 9d ba 74 16 83 6c  |......O.9...t..l|
+00000310  3a 01 9e fa 07 c9 b5 73  15 9a 6f 4e 2a ef 76 d9  |:......s..oN*.v.|
+00000320  17 03 03 00 99 4a cc 37  f7 66 8f 64 a5 4d 79 86  |.....J.7.f.d.My.|
+00000330  70 f9 7c 9e 3a 7f 31 1a  12 cb e0 4e 39 8f c5 2e  |p.|.:.1....N9...|
+00000340  af ad 05 8f bc 78 a8 18  7d 6a 22 c7 d2 3d 94 e6  |.....x..}j"..=..|
+00000350  93 88 e4 c0 df 64 dc db  eb 9c 52 3a 74 19 4f 70  |.....d....R:t.Op|
+00000360  ce 98 7f d7 b0 c9 e3 53  e8 63 3f a8 3e d8 60 04  |.......S.c?.>.`.|
+00000370  ca fc 8f ae 20 e5 64 bb  d8 1c 31 74 39 2a 89 ac  |.... .d...1t9*..|
+00000380  87 ab fd 79 a4 e2 57 e1  8d 9b e6 d9 13 32 1c 78  |...y..W......2.x|
+00000390  0d 13 bd e6 ef fa b5 a8  3a 4a 09 ef 27 3e 1a fb  |........:J..'>..|
+000003a0  4c ea 06 57 b4 69 15 c2  1d 7d cf cb db 85 2f c6  |L..W.i...}..../.|
+000003b0  e1 6f 65 35 67 6c d5 9c  f6 37 fd 2d c9 80 17 03  |.oe5gl...7.-....|
+000003c0  03 00 35 62 93 bb d3 3f  46 a9 58 d6 ff 0e 08 0e  |..5b...?F.X.....|
+000003d0  22 09 eb fa b4 8c 98 5d  81 8e d4 3a 68 02 bc f7  |"......]...:h...|
+000003e0  0d 76 04 11 3e 39 38 24  e1 cc c7 0b f3 dd 55 22  |.v..>98$......U"|
+000003f0  c5 e3 9c 30 dc c9 51 08  17 03 03 00 87 3a 87 55  |...0..Q......:.U|
+00000400  53 28 6e ae 80 01 a8 53  02 29 50 7c 3d e1 1a a2  |S(n....S.)P|=...|
+00000410  d4 d3 45 48 de 8e b2 07  26 d5 a4 00 5f a5 db 07  |..EH....&..._...|
+00000420  9d 9b 5c a3 8e a2 df 54  d1 50 25 25 5c 0c 65 9d  |..\....T.P%%\.e.|
+00000430  6a 1b 7b 1b bd 26 c5 ec  15 57 b3 50 b1 bf 63 a9  |j.{..&...W.P..c.|
+00000440  d3 fc 99 1e f3 7f c7 2b  dd f7 0b ba b6 b6 77 e7  |.......+......w.|
+00000450  26 03 f9 e2 08 2b b3 80  f6 5b f6 eb 96 f1 0d c0  |&....+...[......|
+00000460  11 8c e2 16 13 2e 9a 79  44 f7 6c 8d 41 58 56 ea  |.......yD.l.AXV.|
+00000470  e7 56 33 06 8f ed b5 ea  f8 90 76 98 d9 04 3b f7  |.V3.......v...;.|
+00000480  e5 86 94 07                                       |....|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 cb d3 88 98 55  |..........5....U|
-00000010  01 99 18 4d 8f 1b 6e 66  f3 07 a6 cf 8c 3c 30 d2  |...M..nf.....<0.|
-00000020  8d 78 00 56 5f df 3b f2  45 4c da c6 f2 b4 08 42  |.x.V_.;.EL.....B|
-00000030  9d 4e f2 3f 61 dd 42 0b  95 29 b7 39 65 17 55 12  |.N.?a.B..).9e.U.|
-00000040  17 03 03 00 13 88 d5 ca  24 63 cf a2 55 b6 83 b5  |........$c..U...|
-00000050  bc 36 87 d1 77 99 d2 f4                           |.6..w...|
+00000000  14 03 03 00 01 01 17 03  03 00 35 90 fe a0 7d 87  |..........5...}.|
+00000010  c6 c2 c2 a9 e7 1d de c5  51 68 ed 8c 61 ea b2 25  |........Qh..a..%|
+00000020  ff 4c 1b f2 67 b9 b0 c3  fd 8d cf 47 88 c5 60 71  |.L..g......G..`q|
+00000030  35 7c 67 bb e7 93 b2 a7  47 74 01 a7 8d e1 35 1f  |5|g.....Gt....5.|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 0a e2 c0  76 2b de ba 74 d9 6c 0d  |........v+..t.l.|
-00000010  10 c7 bb aa dc ad d2 3b  13 95 88 83 74 a9 b7 a2  |.......;....t...|
-00000020  bf 37 17 17 03 03 00 13  2a 66 55 53 c9 82 8a 35  |.7......*fUS...5|
-00000030  a4 d2 e3 a8 8b b6 3b b7  c4 5a 5d                 |......;..Z]|
+00000000  17 03 03 00 1e 33 6d d3  22 c3 bb 8f 30 3c c6 e6  |.....3m."...0<..|
+00000010  01 6f 4a 34 55 21 35 01  10 89 8f b2 ab a6 c3 13  |.oJ4U!5.........|
+00000020  a8 0c a3 17 03 03 00 13  32 87 af 0f 58 18 6c 43  |........2...X.lC|
+00000030  40 51 6b f4 c7 1c 42 f1  19 f0 76                 |@Qk...B...v|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ALPN-Fallback b/src/crypto/tls/testdata/Server-TLSv13-ALPN-Fallback
index 61e2c0d0fc..2479b3bd3e 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ALPN-Fallback
+++ b/src/crypto/tls/testdata/Server-TLSv13-ALPN-Fallback
@@ -1,9 +1,9 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 eb 01 00 00  e7 03 03 db 45 a7 85 23  |............E..#|
-00000010  06 fa 88 89 69 5d bc f6  e2 cc 61 1a e8 63 3d 12  |....i]....a..c=.|
-00000020  de 11 25 86 f1 10 2a 2e  1a bb 80 20 15 b0 4b 7d  |..%...*.... ..K}|
-00000030  d5 a7 79 88 71 4d 48 d8  3a 15 65 ee 97 91 74 a4  |..y.qMH.:.e...t.|
-00000040  18 f5 08 63 63 a6 06 82  04 cc 3f a5 00 04 13 03  |...cc.....?.....|
+00000000  16 03 01 00 eb 01 00 00  e7 03 03 ff 2b 30 06 29  |............+0.)|
+00000010  23 b0 1f ae 32 ec 31 3d  e5 a8 58 51 5e 1a 94 a0  |#...2.1=..XQ^...|
+00000020  00 10 96 8d d4 3e d9 c9  3f fe fb 20 80 6d 42 18  |.....>..?.. .mB.|
+00000030  67 9d 57 53 06 26 91 f5  bc f0 64 11 2b 03 ec c6  |g.WS.&....d.+...|
+00000040  9e a7 4a 94 40 c7 8f b6  73 3c 7c 41 00 04 13 03  |..J.@...s<|A....|
 00000050  00 ff 01 00 00 9a 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 10 00 19 00 17  06 70 72 6f 74 6f 33 08  |.........proto3.|
@@ -12,88 +12,88 @@
 000000a0  03 06 03 08 07 08 08 08  09 08 0a 08 0b 08 04 08  |................|
 000000b0  05 08 06 04 01 05 01 06  01 00 2b 00 03 02 03 04  |..........+.....|
 000000c0  00 2d 00 02 01 01 00 33  00 26 00 24 00 1d 00 20  |.-.....3.&.$... |
-000000d0  c5 7d 91 08 04 ef ab 2d  3c 92 84 d1 c7 83 51 4d  |.}.....-<.....QM|
-000000e0  c2 41 65 d9 34 c2 eb a4  f9 69 8e bc be ce 0d 39  |.Ae.4....i.....9|
+000000d0  f6 f4 17 de e2 da f3 3e  6b ac 51 b1 15 01 3a 3b  |.......>k.Q...:;|
+000000e0  26 8f e2 79 83 f5 bb 27  70 73 59 2a 15 b2 d6 6c  |&..y...'psY*...l|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 15 b0 4b 7d  |........... ..K}|
-00000030  d5 a7 79 88 71 4d 48 d8  3a 15 65 ee 97 91 74 a4  |..y.qMH.:.e...t.|
-00000040  18 f5 08 63 63 a6 06 82  04 cc 3f a5 13 03 00 00  |...cc.....?.....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 80 6d 42 18  |........... .mB.|
+00000030  67 9d 57 53 06 26 91 f5  bc f0 64 11 2b 03 ec c6  |g.WS.&....d.+...|
+00000040  9e a7 4a 94 40 c7 8f b6  73 3c 7c 41 13 03 00 00  |..J.@...s<|A....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 a2 16 2d c5 ef c1  |............-...|
-00000090  3f 96 b4 28 52 19 af 1f  a1 97 0a 95 a4 53 e6 ff  |?..(R........S..|
-000000a0  10 17 03 03 02 6d 2a 59  db 78 7a cd 63 58 1a 2f  |.....m*Y.xz.cX./|
-000000b0  f7 c9 2c f4 37 97 fc 96  15 5f 57 bf 62 cd 82 e7  |..,.7...._W.b...|
-000000c0  5b ae 3e c0 56 d5 65 1f  2d 6e 86 32 c3 19 81 e7  |[.>.V.e.-n.2....|
-000000d0  aa ed f3 20 ea 58 3c 5c  50 00 4b 67 91 fb 45 b9  |... .X<\P.Kg..E.|
-000000e0  3c 6f 6e 0f 2e 7a 47 e9  be 31 b0 4e 14 5c c9 df  |<on..zG..1.N.\..|
-000000f0  48 50 dc 01 86 bd 92 9b  a5 ad 00 f1 71 7e 5c 37  |HP..........q~\7|
-00000100  04 72 53 6c af e3 c2 8a  d2 b9 03 83 77 98 31 28  |.rSl........w.1(|
-00000110  b4 37 b4 54 5c e4 07 6d  1f 75 ba ac 83 00 0d ec  |.7.T\..m.u......|
-00000120  d2 3d 6b e3 e6 33 b1 c2  5d 51 2c 94 36 26 c4 a9  |.=k..3..]Q,.6&..|
-00000130  0b 50 d3 df f3 06 9e 7e  7c e7 dc 7e 4f 3e 4a c6  |.P.....~|..~O>J.|
-00000140  7e 98 56 b3 37 bf c6 c5  92 d1 f1 ea 43 a2 00 86  |~.V.7.......C...|
-00000150  94 e7 9b 4d 7e 73 89 44  2f 9f 1f f0 d9 97 b5 a9  |...M~s.D/.......|
-00000160  2c 84 1c aa 63 00 da 93  a7 ee 57 7f 3d 55 c0 23  |,...c.....W.=U.#|
-00000170  7a 6c ee 5d 01 dd da 35  74 1c 8e c3 7d 20 48 fd  |zl.]...5t...} H.|
-00000180  b3 38 0c 93 c5 8b 1e df  6b d4 01 97 46 45 b4 62  |.8......k...FE.b|
-00000190  3a 06 3a 23 76 1d af 2a  ae 5f 35 57 7e 77 1d 27  |:.:#v..*._5W~w.'|
-000001a0  f8 d1 03 06 f0 76 4e 05  20 f6 0e aa a3 4a 19 5c  |.....vN. ....J.\|
-000001b0  85 2e e6 20 de 75 67 0a  84 0d fd fa 99 9a 4e fc  |... .ug.......N.|
-000001c0  d6 b2 6e 9c b5 87 a2 5b  4f 2d ab ce 74 76 1c 71  |..n....[O-..tv.q|
-000001d0  d9 9b 7e 0b 38 59 b0 6d  83 c6 d7 6b 8d 3b 51 88  |..~.8Y.m...k.;Q.|
-000001e0  7b 42 7a 03 ee b2 52 91  d6 84 a1 16 d9 df 3a 42  |{Bz...R.......:B|
-000001f0  cb 6e 0c 9d 53 5b bc 11  8d b7 6b 55 0b 70 30 ec  |.n..S[....kU.p0.|
-00000200  ee 55 5d 2f 12 e9 36 10  d1 10 e5 54 63 d6 85 4f  |.U]/..6....Tc..O|
-00000210  6b 63 9c b1 bf ee 1d 09  2b 89 0e 91 a1 c3 82 20  |kc......+...... |
-00000220  a5 ad 10 f4 dd 2d 28 ed  83 64 b3 c1 7b 31 5b 65  |.....-(..d..{1[e|
-00000230  fd 17 bc 3b ca 30 b8 10  06 ed 8b 40 27 bb e3 dc  |...;.0.....@'...|
-00000240  7a df 5e 9b d8 01 f9 ef  b1 06 09 e0 61 89 f3 b4  |z.^.........a...|
-00000250  09 63 eb b2 fa 19 cf d8  4e b2 4b 62 db a5 2f ef  |.c......N.Kb../.|
-00000260  35 d1 59 5a ad 25 0c f4  40 48 e2 d4 1a ba 50 29  |5.YZ.%..@H....P)|
-00000270  57 65 3a 89 c1 5b f9 d1  9a d2 c7 04 72 47 4a e1  |We:..[......rGJ.|
-00000280  4b 28 39 52 a3 65 db fb  76 89 8c 3b 37 6d d7 b9  |K(9R.e..v..;7m..|
-00000290  62 83 3a 15 27 db 6d a3  b9 59 12 27 85 52 5f 4e  |b.:.'.m..Y.'.R_N|
-000002a0  86 e7 61 b0 56 c4 68 62  e9 a9 5c a3 ff d7 5c 58  |..a.V.hb..\...\X|
-000002b0  59 b5 b8 ca 4c 07 4d 23  17 dc 15 b5 20 43 11 88  |Y...L.M#.... C..|
-000002c0  b0 45 4c c0 dd f2 62 c0  b3 11 59 28 32 f7 25 4c  |.EL...b...Y(2.%L|
-000002d0  ba 1a 62 84 dc c8 83 83  d8 52 50 9a ab 7b ef 73  |..b......RP..{.s|
-000002e0  b1 42 9e 91 e0 f0 44 8a  d7 35 e7 7e 0c e2 1c 74  |.B....D..5.~...t|
-000002f0  67 1b 38 5c 53 e4 9b 5f  77 a9 d4 54 cf ce 5d 18  |g.8\S.._w..T..].|
-00000300  94 41 8a 99 0b 93 be 58  d7 f0 9a 4a f0 69 e4 a5  |.A.....X...J.i..|
-00000310  57 db b4 17 03 03 00 99  64 e7 3f f1 a7 8c 32 19  |W.......d.?...2.|
-00000320  b4 27 03 85 0e 25 5a 73  3d e3 7d 13 56 b5 6d b6  |.'...%Zs=.}.V.m.|
-00000330  f5 86 cd c9 df 39 7e a9  f0 f7 3b 9b 41 54 e1 0e  |.....9~...;.AT..|
-00000340  14 43 9b de 4c c0 6b ec  d3 ff 72 e3 40 f4 7c 46  |.C..L.k...r.@.|F|
-00000350  b2 97 00 94 e5 37 20 01  70 5f 38 c3 b5 6a 68 d0  |.....7 .p_8..jh.|
-00000360  c4 f4 96 0e 6a dd b2 41  80 cb 70 4b 16 af ad dd  |....j..A..pK....|
-00000370  ed 89 2c 0b 32 b7 ab 60  bc ed 1f 08 16 45 60 c6  |..,.2..`.....E`.|
-00000380  64 e6 b2 9d 84 ab b1 8e  09 62 2d 6c 0d a2 52 61  |d........b-l..Ra|
-00000390  6a ee 59 51 06 4f 77 5c  41 30 84 1a 8c ff 80 65  |j.YQ.Ow\A0.....e|
-000003a0  15 e4 8f 6a e0 eb a0 6e  fe 41 42 08 97 cf e7 95  |...j...n.AB.....|
-000003b0  ab 17 03 03 00 35 a9 d4  a4 52 af 66 91 c5 df 11  |.....5...R.f....|
-000003c0  c8 29 a9 ec a2 d5 be 95  51 ae 17 cd 57 60 b4 c8  |.)......Q...W`..|
-000003d0  2e 52 bc af 75 2f e9 a3  19 0c b1 98 01 8a 32 22  |.R..u/........2"|
-000003e0  88 00 e4 db b9 73 00 4d  81 d1 f6 17 03 03 00 86  |.....s.M........|
-000003f0  a8 72 46 cd fc c9 b2 c9  33 60 17 50 5f 48 52 b1  |.rF.....3`.P_HR.|
-00000400  fe 6d 3c 5d 76 cd 19 c2  5d c2 30 36 ff a3 d9 9f  |.m<]v...].06....|
-00000410  f2 af a4 e3 bb 7f 93 5c  e7 ad 37 2f b6 9d 3f 65  |.......\..7/..?e|
-00000420  6f f0 67 39 aa 0a c9 f4  35 45 de 38 fe 89 66 6a  |o.g9....5E.8..fj|
-00000430  8e da b3 a9 b3 91 55 c1  e1 2d a9 ce 02 12 3e 19  |......U..-....>.|
-00000440  ac 85 a9 2a 4b 78 93 02  52 ef 22 35 72 04 fb 81  |...*Kx..R."5r...|
-00000450  92 ea 31 c5 06 a4 07 7f  97 56 8f cb b0 d5 6a 15  |..1......V....j.|
-00000460  25 49 d9 f9 f8 2e 2d e2  07 3e 4f 7f 8d 29 48 41  |%I....-..>O..)HA|
-00000470  48 50 e1 1d ad 27                                 |HP...'|
+00000080  03 03 00 01 01 17 03 03  00 17 60 18 7e 49 26 0a  |..........`.~I&.|
+00000090  6e f7 b8 03 c5 5a 60 4d  7b 10 a8 61 f2 83 52 d5  |n....Z`M{..a..R.|
+000000a0  5a 17 03 03 02 6d bb 23  f7 ba 82 cf a9 73 fa 74  |Z....m.#.....s.t|
+000000b0  da a7 91 bf 48 48 ec 8a  59 4d 1e 96 27 18 79 60  |....HH..YM..'.y`|
+000000c0  c7 03 0c 03 cc e9 96 4d  1b 07 66 9c dc e9 d7 0c  |.......M..f.....|
+000000d0  4f d0 92 07 8e 02 89 ec  77 1c df b5 b5 8d 5c 21  |O.......w.....\!|
+000000e0  c7 88 07 4f c4 87 06 c5  82 ff 2c 28 0e 4e d2 38  |...O......,(.N.8|
+000000f0  68 2b 42 6b 83 af 2a a7  f9 6d c6 aa f3 e7 82 35  |h+Bk..*..m.....5|
+00000100  5c 7f 36 73 e9 60 b7 01  6b 40 3d 20 b7 2d 8a b5  |\.6s.`..k@= .-..|
+00000110  62 5d 7c f3 cf 7f 2d 65  d8 40 01 2d aa c1 da 27  |b]|...-e.@.-...'|
+00000120  06 ff e3 cd f2 37 76 f3  82 65 49 94 37 04 d1 a0  |.....7v..eI.7...|
+00000130  c3 ae f5 5d 26 19 ea 6d  c1 bf a3 ef b6 7f d2 b2  |...]&..m........|
+00000140  69 77 d3 f1 1b 9b b5 bf  a1 2d 12 ec 8d bf ea 6b  |iw.......-.....k|
+00000150  45 7f f3 87 3c b7 70 02  1e b8 46 18 36 b9 7c cc  |E...<.p...F.6.|.|
+00000160  70 2e e2 3b 2a 8b c0 a4  7e ec 62 cb 6d 46 d9 60  |p..;*...~.b.mF.`|
+00000170  f8 90 a3 7c a7 56 06 90  9a 2b 7b 20 ce d8 1d 2b  |...|.V...+{ ...+|
+00000180  93 69 0b f4 5c c1 79 06  bf 28 0d c2 2e 60 7d aa  |.i..\.y..(...`}.|
+00000190  a6 68 78 fd bf f0 8a a2  b9 7f f0 0a 69 3c 46 ed  |.hx.........i<F.|
+000001a0  0d 49 6a 94 6d b2 fe ce  44 53 ae 45 9a 8c 19 62  |.Ij.m...DS.E...b|
+000001b0  6d cb 9a 4a b6 a3 56 f1  bf a0 ec bb 37 a9 78 6c  |m..J..V.....7.xl|
+000001c0  cb 3c b7 e3 e3 c5 a7 aa  cc 5f 1f f2 c4 5b d1 f0  |.<......._...[..|
+000001d0  77 c3 bb a6 60 2c d4 2d  ec 8f 44 64 72 49 fe 38  |w...`,.-..DdrI.8|
+000001e0  15 be 4b 5d 9e 16 a2 5a  05 b9 6d 35 e0 4a d3 1d  |..K]...Z..m5.J..|
+000001f0  25 1f ca ef c7 79 29 84  c9 37 c6 01 a8 fc 73 76  |%....y)..7....sv|
+00000200  53 73 24 ce 3c 4d 53 fc  d9 11 b6 ef 41 77 e6 28  |Ss$.<MS.....Aw.(|
+00000210  fa 17 f2 43 a6 9a f1 c4  10 67 4c 68 e7 d9 d8 97  |...C.....gLh....|
+00000220  22 b3 c6 0b b0 6a ce 05  18 2a 62 0f d6 99 15 d6  |"....j...*b.....|
+00000230  6b f9 89 61 06 a8 57 76  13 f3 d3 75 45 be e4 c0  |k..a..Wv...uE...|
+00000240  01 28 8c b6 b6 50 43 2e  54 71 61 47 fc a4 83 ca  |.(...PC.TqaG....|
+00000250  5b a3 b5 e2 bc f3 c3 94  ab 33 21 8c e0 a6 75 0e  |[........3!...u.|
+00000260  a3 5d e6 a5 6e ac 2d 63  eb b0 6a 75 7f 76 6f 05  |.]..n.-c..ju.vo.|
+00000270  79 b0 e3 d4 54 ed 45 0c  6d 75 98 28 1e a2 63 65  |y...T.E.mu.(..ce|
+00000280  54 79 c4 a5 e5 37 c2 34  58 62 59 40 b3 e3 15 4b  |Ty...7.4XbY@...K|
+00000290  44 23 c4 cd 44 a1 0d 8e  85 b2 c9 cd 12 fa 72 f6  |D#..D.........r.|
+000002a0  9a c8 ae 9e d0 d7 60 21  41 6b 19 a1 f2 d2 53 0a  |......`!Ak....S.|
+000002b0  7e 21 bf ad d3 6d 73 8a  e2 ce 45 c0 cd 12 14 cd  |~!...ms...E.....|
+000002c0  49 f8 e3 4e e7 43 39 59  41 5a eb ed 4f d6 47 16  |I..N.C9YAZ..O.G.|
+000002d0  17 15 35 26 5f c2 39 19  2c 81 59 85 d0 f9 8c 81  |..5&_.9.,.Y.....|
+000002e0  b8 f8 d8 5f 8b 51 5e f8  6b 72 34 60 e2 4b 04 10  |..._.Q^.kr4`.K..|
+000002f0  29 b7 f4 f6 36 4d 89 fc  2f 07 a2 10 47 ea 8e 22  |)...6M../...G.."|
+00000300  60 5f 50 19 bd c1 0d 52  c6 cb 43 79 c4 54 a8 85  |`_P....R..Cy.T..|
+00000310  49 0e 5b 17 03 03 00 99  67 ad a1 0b 84 de 72 8d  |I.[.....g.....r.|
+00000320  34 79 02 38 6a 72 ff 5d  95 6b 7c 57 0f 3c b2 fd  |4y.8jr.].k|W.<..|
+00000330  b8 de d0 0f 81 0d 8c 24  37 d5 ba cf 88 7c 98 38  |.......$7....|.8|
+00000340  b9 aa ab bd ca 81 2f 30  fa 1a a1 f3 ee ae fa 6e  |....../0.......n|
+00000350  b9 9f 0a 06 73 47 3a 66  e4 fd ac 72 1c 9e 12 63  |....sG:f...r...c|
+00000360  8a 58 36 7f 39 06 48 af  38 75 45 7d 83 22 e9 30  |.X6.9.H.8uE}.".0|
+00000370  7b 45 2c 17 6d b8 40 6a  90 b5 87 d0 5e 2e b3 43  |{E,.m.@j....^..C|
+00000380  ba 08 6b 2d 79 4d 83 1e  76 eb 23 09 e0 9d f9 c2  |..k-yM..v.#.....|
+00000390  d8 ac bb a1 7f 1e 09 22  b9 66 32 7a e5 4c 2c eb  |.......".f2z.L,.|
+000003a0  fa b6 51 e4 e9 4d a7 78  59 43 fd 0d af 86 9f 9b  |..Q..M.xYC......|
+000003b0  a3 17 03 03 00 35 0d 42  ed 73 34 a0 06 72 47 15  |.....5.B.s4..rG.|
+000003c0  ad 16 05 ee a3 98 88 dd  52 09 78 9d 99 c5 c2 b7  |........R.x.....|
+000003d0  39 90 0c f0 4a cb 9e da  0f 9a 31 29 af 86 7b 79  |9...J.....1)..{y|
+000003e0  c5 2f 35 21 85 51 8c 2e  29 f2 ea 17 03 03 00 87  |./5!.Q..).......|
+000003f0  e6 0a ee 9e a6 aa 7d c6  b8 3d 08 82 9e 1c 7f e2  |......}..=......|
+00000400  ed b1 58 85 75 d0 ae e6  af bf 54 98 2a 4d 64 ab  |..X.u.....T.*Md.|
+00000410  33 3b d1 32 17 94 db 29  22 5e 51 b0 3e 0f 48 fe  |3;.2...)"^Q.>.H.|
+00000420  fd 3e de b6 78 25 16 7a  a9 52 e3 b8 93 89 4b 50  |.>..x%.z.R....KP|
+00000430  d9 4a 0f af 60 34 48 2b  f4 27 2d 99 63 d8 33 a3  |.J..`4H+.'-.c.3.|
+00000440  1c 68 0b e1 e8 13 21 cd  37 58 7c 66 1f cf 35 5d  |.h....!.7X|f..5]|
+00000450  06 8a 66 2b dd 87 56 05  69 af 6f b6 59 01 a8 8c  |..f+..V.i.o.Y...|
+00000460  35 0b fd 35 98 64 97 42  33 d1 b8 0e ac 85 51 5d  |5..5.d.B3.....Q]|
+00000470  26 cb 1d 81 c7 8d 32                              |&.....2|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 f5 9f 68 68 ef  |..........5..hh.|
-00000010  84 42 13 69 d3 fb e5 1d  9c 13 44 5a 7a ff 69 db  |.B.i......DZz.i.|
-00000020  54 71 be d2 da 45 60 ad  f9 b3 90 cd 1c ea fc 96  |Tq...E`.........|
-00000030  c3 b2 00 6e e5 9a 90 bf  58 bd 35 0f 94 ed 0e be  |...n....X.5.....|
+00000000  14 03 03 00 01 01 17 03  03 00 35 b2 e1 64 9b 19  |..........5..d..|
+00000010  0e 81 eb 63 91 f0 ea 5a  a4 28 cd 78 62 32 2e 64  |...c...Z.(.xb2.d|
+00000020  b2 82 e8 5c d9 67 8a 14  41 83 c4 8c 4d f7 33 cc  |...\.g..A...M.3.|
+00000030  9b 0e 6d 2d cd 69 45 0f  51 11 29 23 2c c4 3c cc  |..m-.iE.Q.)#,.<.|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 7c 63 79  6f bf f4 3f 6d 1c 1c 0c  |.....|cyo..?m...|
-00000010  bb b4 17 4f 80 a3 d5 42  d6 f2 6b 65 29 76 d2 8a  |...O...B..ke)v..|
-00000020  2d d3 d3 17 03 03 00 13  9f 1a 0a 5d 7b 47 da 27  |-..........]{G.'|
-00000030  65 1b 3a 75 f9 52 29 0f  b0 ad 6c                 |e.:u.R)...l|
+00000000  17 03 03 00 1e de 26 6a  04 bf d7 1a 06 e6 94 35  |......&j.......5|
+00000010  dc 74 5a 0c ca 4c bb a2  e2 ba 7d 01 2e 87 c5 17  |.tZ..L....}.....|
+00000020  c2 e1 da 17 03 03 00 13  4b 04 5a ab 20 c7 22 2e  |........K.Z. .".|
+00000030  5d 89 57 b2 1d ea d2 1b  91 0d b9                 |].W........|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ALPN-NoMatch b/src/crypto/tls/testdata/Server-TLSv13-ALPN-NoMatch
index b51ff258c5..a8b3d80738 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ALPN-NoMatch
+++ b/src/crypto/tls/testdata/Server-TLSv13-ALPN-NoMatch
@@ -1,9 +1,9 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 e2 01 00 00  de 03 03 9f 73 81 5f 56  |............s._V|
-00000010  a9 02 5f 8c 33 db dc 2a  92 d0 5e 7c e9 e6 01 d7  |.._.3..*..^|....|
-00000020  67 b6 bb 74 da bb d0 c1  11 08 20 20 9f bd d6 f8  |g..t......  ....|
-00000030  d7 8c e5 32 15 1d 4a 4c  36 ce 72 90 cb 68 ca dc  |...2..JL6.r..h..|
-00000040  ea b3 57 93 9a 12 e6 0e  9a bd 91 1a 00 04 13 03  |..W.............|
+00000000  16 03 01 00 e2 01 00 00  de 03 03 3d ae 42 d4 d3  |...........=.B..|
+00000010  a9 75 5b a6 8f 9f 47 6f  fe e7 3d 3e 5c d8 35 01  |.u[...Go..=>\.5.|
+00000020  c9 25 fd 94 e4 ac 7e b4  e1 4e 0f 20 56 29 44 cd  |.%....~..N. V)D.|
+00000030  7f 99 7b a6 9a 4d d4 3c  e8 01 00 93 e5 e0 a8 7b  |..{..M.<.......{|
+00000040  81 13 85 e9 2e 4e 12 a2  b9 d4 7d 8e 00 04 13 03  |.....N....}.....|
 00000050  00 ff 01 00 00 91 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 10 00 10 00 0e  06 70 72 6f 74 6f 32 06  |.........proto2.|
@@ -11,17 +11,8 @@
 00000090  00 1e 00 1c 04 03 05 03  06 03 08 07 08 08 08 09  |................|
 000000a0  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
 000000b0  00 2b 00 03 02 03 04 00  2d 00 02 01 01 00 33 00  |.+......-.....3.|
-000000c0  26 00 24 00 1d 00 20 79  79 04 d3 03 58 93 22 5d  |&.$... yy...X."]|
-000000d0  06 69 1a 03 11 4e 65 e5  30 85 29 02 22 c8 11 6d  |.i...Ne.0.)."..m|
-000000e0  21 86 d4 4d 58 93 74                              |!..MX.t|
+000000c0  26 00 24 00 1d 00 20 3c  8b f2 09 ad ff 96 76 0f  |&.$... <......v.|
+000000d0  9b 05 eb c8 5a 48 68 be  a6 6e dd f6 f5 7d 56 89  |....ZHh..n...}V.|
+000000e0  ff 37 75 13 b1 1b 01                              |.7u....|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
-00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 9f bd d6 f8  |........... ....|
-00000030  d7 8c e5 32 15 1d 4a 4c  36 ce 72 90 cb 68 ca dc  |...2..JL6.r..h..|
-00000040  ea b3 57 93 9a 12 e6 0e  9a bd 91 1a 13 03 00 00  |..W.............|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
-00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 13 7c ab 7f dd 94 cf  |..........|.....|
-00000090  d7 98 34 16 75 02 63 37  fa 4f 19 4e 18           |..4.u.c7.O.N.|
+00000000  15 03 03 00 02 02 78                              |......x|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ALPN-NotConfigured b/src/crypto/tls/testdata/Server-TLSv13-ALPN-NotConfigured
index bbb8fad548..55e62f69ef 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ALPN-NotConfigured
+++ b/src/crypto/tls/testdata/Server-TLSv13-ALPN-NotConfigured
@@ -1,9 +1,9 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 e2 01 00 00  de 03 03 95 24 e6 3d a7  |............$.=.|
-00000010  e2 d8 ae e5 5c ad 0f a7  1e 5a 15 58 54 ca c7 0b  |....\....Z.XT...|
-00000020  6d 80 82 73 46 ff 0f d3  c2 9d 48 20 29 8e 42 be  |m..sF.....H ).B.|
-00000030  3d b4 78 d0 6c c2 a6 27  3d bd 63 08 68 a8 4f fc  |=.x.l..'=.c.h.O.|
-00000040  31 14 9c b4 e0 c1 e3 08  ec e5 b2 dd 00 04 13 03  |1...............|
+00000000  16 03 01 00 e2 01 00 00  de 03 03 f7 c1 b5 6c 3e  |..............l>|
+00000010  00 f7 90 29 26 19 9e 28  d7 d6 2f 4a 85 d6 c8 2a  |...)&..(../J...*|
+00000020  7b c8 2c 6b f1 34 5f c5  f7 5c 76 20 20 c2 9b c1  |{.,k.4_..\v  ...|
+00000030  b5 4b a5 ae 98 ba 6a db  21 eb 8e cf ea 9e 01 fd  |.K....j.!.......|
+00000040  48 b3 47 b1 eb 70 04 3c  0a f8 73 55 00 04 13 03  |H.G..p.<..sU....|
 00000050  00 ff 01 00 00 91 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 10 00 10 00 0e  06 70 72 6f 74 6f 32 06  |.........proto2.|
@@ -11,89 +11,89 @@
 00000090  00 1e 00 1c 04 03 05 03  06 03 08 07 08 08 08 09  |................|
 000000a0  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
 000000b0  00 2b 00 03 02 03 04 00  2d 00 02 01 01 00 33 00  |.+......-.....3.|
-000000c0  26 00 24 00 1d 00 20 12  18 c0 ca 9e 9c a6 a8 28  |&.$... ........(|
-000000d0  dc c9 d1 b9 ac ef 1e 82  2f 8d e5 32 fc d5 7f b0  |......../..2....|
-000000e0  e4 e9 10 e0 c3 cf 5a                              |......Z|
+000000c0  26 00 24 00 1d 00 20 50  65 db 00 14 47 27 81 9a  |&.$... Pe...G'..|
+000000d0  e5 5a 7c eb 89 1f 29 af  39 e6 4b 23 a7 10 3a 83  |.Z|...).9.K#..:.|
+000000e0  b2 8e f3 ff a8 5a 63                              |.....Zc|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 29 8e 42 be  |........... ).B.|
-00000030  3d b4 78 d0 6c c2 a6 27  3d bd 63 08 68 a8 4f fc  |=.x.l..'=.c.h.O.|
-00000040  31 14 9c b4 e0 c1 e3 08  ec e5 b2 dd 13 03 00 00  |1...............|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 20 c2 9b c1  |...........  ...|
+00000030  b5 4b a5 ae 98 ba 6a db  21 eb 8e cf ea 9e 01 fd  |.K....j.!.......|
+00000040  48 b3 47 b1 eb 70 04 3c  0a f8 73 55 13 03 00 00  |H.G..p.<..sU....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 3c 49 80 85 f7 21  |..........<I...!|
-00000090  bc 84 dc 56 5c bb d2 8a  a4 20 17 79 02 07 74 2a  |...V\.... .y..t*|
-000000a0  07 17 03 03 02 6d ab 63  1b 6f 12 5c 0c 28 92 4c  |.....m.c.o.\.(.L|
-000000b0  78 13 bb 81 37 6c 33 52  b7 c1 5d 89 42 43 55 30  |x...7l3R..].BCU0|
-000000c0  aa 81 81 ca 07 bb 0b 43  b4 97 d9 e3 d3 04 e1 5c  |.......C.......\|
-000000d0  66 50 68 97 55 b6 51 ad  b4 21 1f e7 15 28 54 4a  |fPh.U.Q..!...(TJ|
-000000e0  f9 07 dd c5 2d 95 e5 9e  5c bc 82 5d 13 98 e2 8d  |....-...\..]....|
-000000f0  80 44 aa 22 7c 15 d6 21  cc 4c 1c d4 2e 7d a3 4a  |.D."|..!.L...}.J|
-00000100  1a 75 6d 54 67 0e bf ef  0d ec ad 43 27 95 45 3f  |.umTg......C'.E?|
-00000110  4f 0e f4 a8 71 01 db b3  67 7f 1d 85 8f 4a 32 5e  |O...q...g....J2^|
-00000120  c2 4f 81 86 8d 2d f3 dd  f2 35 2b a5 c3 04 d2 fb  |.O...-...5+.....|
-00000130  1c b7 61 45 79 aa 38 3f  46 85 0a 0e 50 ba 21 cc  |..aEy.8?F...P.!.|
-00000140  7e 30 87 2a 8b da 84 af  7d aa 5c ab 67 b4 1b 8c  |~0.*....}.\.g...|
-00000150  d3 ac 62 29 3e 91 5f 68  90 fd 1d 64 6c 44 8a 55  |..b)>._h...dlD.U|
-00000160  18 52 e2 df 69 87 42 5d  ca 1c 03 27 58 c2 75 3e  |.R..i.B]...'X.u>|
-00000170  1b fc 23 b5 70 63 60 0e  93 be 51 7f 31 88 66 1e  |..#.pc`...Q.1.f.|
-00000180  98 eb d3 ad 8e a5 fa 40  24 61 e4 bb 5f 22 67 00  |.......@$a.._"g.|
-00000190  1a 79 18 e0 41 53 b2 c6  39 a4 68 e1 e0 ca cc 79  |.y..AS..9.h....y|
-000001a0  fd 32 e5 d5 1c 8e 7d 5e  c1 9f 7b 8c 81 3c fd 2a  |.2....}^..{..<.*|
-000001b0  13 63 fa 6c 70 e1 e5 04  e2 ec 9f 3b b3 b5 38 b5  |.c.lp......;..8.|
-000001c0  10 0c fc 9f 7c 87 e9 6e  1d b9 d0 ab 86 64 b1 3b  |....|..n.....d.;|
-000001d0  9c 4e 5e fb 7a aa e8 44  b8 94 fe 66 5e bb 19 7e  |.N^.z..D...f^..~|
-000001e0  3d 38 b3 ea 8a bc ac 43  80 36 7c 04 64 04 6c 6c  |=8.....C.6|.d.ll|
-000001f0  d6 d2 42 39 c8 f3 77 dc  ba 05 63 18 d7 44 73 b1  |..B9..w...c..Ds.|
-00000200  b9 4e e4 76 d2 79 09 80  60 59 bd 57 2d 4c b1 c9  |.N.v.y..`Y.W-L..|
-00000210  0c 2c e8 3c bd 3e 81 20  32 25 d8 88 4a 63 47 0d  |.,.<.>. 2%..JcG.|
-00000220  c4 98 71 ed 25 72 e8 71  47 20 0e 5d e9 5f b0 65  |..q.%r.qG .]._.e|
-00000230  ca ea 45 d5 f8 b8 d1 1b  cb ba 19 e3 c9 d1 7c 44  |..E...........|D|
-00000240  81 93 95 70 cc d0 1c 89  01 bb c2 b7 48 ac 8d 3e  |...p........H..>|
-00000250  b6 3a ae 98 5c 15 88 23  f0 90 f5 12 4e 2d c2 d1  |.:..\..#....N-..|
-00000260  09 00 01 c4 da 50 36 00  b8 61 10 78 53 9f b1 a8  |.....P6..a.xS...|
-00000270  de 6c 75 78 0d 49 6f d7  00 e3 58 80 38 b8 67 9a  |.lux.Io...X.8.g.|
-00000280  07 c3 fb 98 8e f3 74 ad  6c 07 a7 33 3b 13 fb f7  |......t.l..3;...|
-00000290  f4 26 57 c0 01 c7 2d 47  01 80 95 27 10 08 55 83  |.&W...-G...'..U.|
-000002a0  a9 18 5f e1 4e ff 4e 22  23 f6 91 f3 e4 36 8b eb  |.._.N.N"#....6..|
-000002b0  78 a8 7f 27 f2 c0 10 a1  54 d2 f8 64 66 e8 6b a4  |x..'....T..df.k.|
-000002c0  36 0a 0c 4b a2 d2 4b c5  f9 1e 5d fb 31 22 60 77  |6..K..K...].1"`w|
-000002d0  a6 df f2 cc 0b 86 c7 56  19 12 58 e7 a2 17 af 99  |.......V..X.....|
-000002e0  d7 52 8f 79 fe 86 95 1f  0b 8d 54 5c 61 af 36 45  |.R.y......T\a.6E|
-000002f0  9b d8 7c 6e 79 c7 c5 3b  e8 19 f9 63 02 81 56 c5  |..|ny..;...c..V.|
-00000300  a2 ec a3 db bd 6c 2a 40  c3 21 49 fe 8f 5f e7 aa  |.....l*@.!I.._..|
-00000310  b4 fc fe 17 03 03 00 99  1a b2 6f d0 ef 20 9f 93  |..........o.. ..|
-00000320  2a 3f 51 11 fc 27 04 86  15 24 6f 06 29 8b da 20  |*?Q..'...$o.).. |
-00000330  c4 a4 17 ba cf 2d 7c 63  80 58 92 62 e6 20 a0 93  |.....-|c.X.b. ..|
-00000340  ad d7 81 0f 8b e2 fe d4  80 6f 8a 07 8a 31 ab cc  |.........o...1..|
-00000350  72 bd bd b2 e6 f1 4b ac  02 39 29 dd 76 53 61 a0  |r.....K..9).vSa.|
-00000360  b3 b6 ae 50 00 1b c6 dd  d3 0d 55 18 f2 a9 83 03  |...P......U.....|
-00000370  4c d2 aa 65 78 cd 97 45  a7 f1 10 bf a5 22 2d b2  |L..ex..E....."-.|
-00000380  32 e7 26 89 d6 d6 de 40  9b d0 49 db e6 d2 c5 5d  |2.&....@..I....]|
-00000390  8b 92 df 79 1a 6f 9f 01  66 f4 ae 55 0c 0c 53 b6  |...y.o..f..U..S.|
-000003a0  13 c7 1b 77 bc ca 28 73  76 81 78 e8 18 30 ab 62  |...w..(sv.x..0.b|
-000003b0  b2 17 03 03 00 35 ad cb  0e f2 f1 9c ac c0 d4 cb  |.....5..........|
-000003c0  dd 48 27 14 7f 4b 57 4f  92 ef 6f f0 39 9c d7 a2  |.H'..KWO..o.9...|
-000003d0  7e 63 0d d5 cb 79 d6 cc  de b8 d6 1f 2b 2d f6 b4  |~c...y......+-..|
-000003e0  f1 ab c7 95 b5 e0 ea 77  46 45 9d 17 03 03 00 86  |.......wFE......|
-000003f0  13 b5 fa 20 fe a5 15 2d  3c cd 75 03 00 e5 b4 b9  |... ...-<.u.....|
-00000400  20 db 06 4f 91 93 03 d0  32 af 05 2c 18 da c0 b2  | ..O....2..,....|
-00000410  fe aa 85 51 73 55 87 fb  01 1a 23 80 11 10 c0 6c  |...QsU....#....l|
-00000420  8f 3d ff a9 12 67 bc ec  4f 3b ea f0 32 54 87 17  |.=...g..O;..2T..|
-00000430  71 df 51 b9 44 1e 63 80  eb e3 e1 1b 0d 56 d1 91  |q.Q.D.c......V..|
-00000440  b7 ff 6d 63 70 54 d3 54  bc 0b a2 42 b6 97 fb 6d  |..mcpT.T...B...m|
-00000450  8d 5f d3 bc ff b2 a7 f2  1a c6 ca 57 98 97 8e fd  |._.........W....|
-00000460  21 59 38 b0 3e b0 86 42  48 cc 8b 7d a4 14 1a 42  |!Y8.>..BH..}...B|
-00000470  76 c9 93 c0 b9 74                                 |v....t|
+00000080  03 03 00 01 01 17 03 03  00 17 d0 b0 cf 60 6a bb  |.............`j.|
+00000090  18 72 9f fa fa f7 2a 04  7e be a2 ce 21 38 42 42  |.r....*.~...!8BB|
+000000a0  2a 17 03 03 02 6d 87 5c  50 7e ed 23 18 aa 4d 59  |*....m.\P~.#..MY|
+000000b0  32 c8 d0 64 89 7f ca 53  08 bb 68 3c 7b 7e 74 5a  |2..d...S..h<{~tZ|
+000000c0  87 f9 d1 aa 7b 85 a4 2b  2d 76 39 65 e7 5e ec d5  |....{..+-v9e.^..|
+000000d0  35 1a 3d 35 33 bd 78 ff  16 e9 e1 72 a6 35 a0 2a  |5.=53.x....r.5.*|
+000000e0  11 b0 42 57 bb a2 3e 1e  c7 87 56 43 08 f0 78 19  |..BW..>...VC..x.|
+000000f0  bd 9c d8 a6 3e 65 81 b4  64 0f 55 e1 1e 64 dc a5  |....>e..d.U..d..|
+00000100  f3 da 15 e2 b3 90 a5 5c  a1 71 ba ec 57 05 ae 70  |.......\.q..W..p|
+00000110  78 2e 10 68 86 0f c4 97  16 0b 8d b1 5d 05 59 ca  |x..h........].Y.|
+00000120  5f 55 ff 2d 89 d3 27 17  06 7f 4a 31 92 cb 34 ac  |_U.-..'...J1..4.|
+00000130  49 fd b3 21 a8 27 3e 21  bd e4 82 f8 26 57 e6 64  |I..!.'>!....&W.d|
+00000140  26 87 87 16 f6 80 78 02  05 92 e1 d4 d7 12 92 ed  |&.....x.........|
+00000150  69 54 bb 35 e2 73 d0 20  9f b1 80 a6 4e 8f 78 ec  |iT.5.s. ....N.x.|
+00000160  94 d7 c4 76 1c 33 e0 7d  92 e8 ed 80 cb 27 7f 2c  |...v.3.}.....'.,|
+00000170  c0 9e 21 f2 26 cc 39 9a  e2 cd 9e 9b 3d 4d 66 2d  |..!.&.9.....=Mf-|
+00000180  ca ab 1f 70 83 4c b6 8b  d1 6f 2c 19 35 55 78 90  |...p.L...o,.5Ux.|
+00000190  7b 01 49 f4 81 d1 02 9f  8d 0b bf 2e ae c6 15 93  |{.I.............|
+000001a0  f4 cc ee d7 9f 61 74 e9  93 e8 dc 9e 38 45 61 40  |.....at.....8Ea@|
+000001b0  b5 7a e7 e2 b4 bf 8b 01  41 05 a7 b8 f1 cb 33 b3  |.z......A.....3.|
+000001c0  c8 f4 8b 99 5c 84 1e a3  e3 06 9a fc de 1a 37 54  |....\.........7T|
+000001d0  9c 4a 58 b0 c6 83 8e 40  80 ee b5 07 74 3c 50 35  |.JX....@....t<P5|
+000001e0  5b a3 61 8b 34 91 9d 2f  b2 b2 44 9f b3 5a 82 ca  |[.a.4../..D..Z..|
+000001f0  07 e6 14 15 c8 40 8c b8  c9 ac 97 52 73 6f d8 d2  |.....@.....Rso..|
+00000200  c4 45 ac 52 a3 fd f5 4f  91 10 8d d6 84 96 81 c1  |.E.R...O........|
+00000210  fc 8f da b0 69 ec ad ca  ba 1a 8d 09 d0 2a 19 14  |....i........*..|
+00000220  88 9e c2 17 24 a6 c2 48  0c bd ec da 01 f1 e1 e9  |....$..H........|
+00000230  40 6a 21 0c aa 00 5a 2e  b5 b7 a4 a3 42 cf 73 82  |@j!...Z.....B.s.|
+00000240  cf 78 fb f6 0b 95 e0 ad  9d 83 2c bb 88 f8 7e 57  |.x........,...~W|
+00000250  95 99 43 c4 3f de e9 69  c3 45 b1 0c 19 df bb 7d  |..C.?..i.E.....}|
+00000260  b4 86 12 2c 60 d5 76 3f  b2 80 8e 6e d2 fa b0 11  |...,`.v?...n....|
+00000270  de 77 7d b7 99 37 eb 74  99 84 31 7f 9e d0 1a 94  |.w}..7.t..1.....|
+00000280  aa c8 83 49 a1 80 06 16  e7 a7 c2 9a eb 1a b6 18  |...I............|
+00000290  0e ec 28 aa 71 a5 11 84  d2 2e 76 8b 38 33 1f 4e  |..(.q.....v.83.N|
+000002a0  8a 03 fb d8 37 a7 b0 09  32 cd 7f 9e 91 d1 25 05  |....7...2.....%.|
+000002b0  63 b5 da d0 68 7e 4c 03  c0 15 c3 74 d1 ba 25 0e  |c...h~L....t..%.|
+000002c0  03 ea 75 04 e9 67 a4 05  a8 db 01 97 2e 3f 36 c8  |..u..g.......?6.|
+000002d0  55 32 aa b4 0e 4a a0 d3  94 c9 a4 62 3d 35 e3 38  |U2...J.....b=5.8|
+000002e0  47 88 10 95 56 ed 93 0d  3a 7e 18 e2 31 7c e2 39  |G...V...:~..1|.9|
+000002f0  ec c3 f7 b5 a5 44 a0 5f  6f dc 6b 4a 55 8e ab b2  |.....D._o.kJU...|
+00000300  a3 25 45 9a 19 ed 7c 7c  da c6 ab 90 55 19 34 9c  |.%E...||....U.4.|
+00000310  af 22 48 17 03 03 00 99  53 3d cf 89 5b 20 fd 91  |."H.....S=..[ ..|
+00000320  16 54 2c 6d c5 ae d3 aa  d2 d3 c6 96 14 43 4f f2  |.T,m.........CO.|
+00000330  4e e5 2e aa f1 6e 58 ba  62 b6 d9 da 21 e7 02 ac  |N....nX.b...!...|
+00000340  9f 45 d4 a9 37 e5 5c 81  26 76 56 0b 53 b3 3e bd  |.E..7.\.&vV.S.>.|
+00000350  cf 2b 05 5d 23 d8 65 16  b3 88 0b db f0 54 15 73  |.+.]#.e......T.s|
+00000360  3f cc 8b fd 3b 46 23 29  7a 99 10 b2 62 02 ac 0b  |?...;F#)z...b...|
+00000370  ef 01 46 94 b9 09 4b af  c3 3e f9 5e bb 28 7e 3b  |..F...K..>.^.(~;|
+00000380  83 7f e9 fd 51 56 e2 a5  83 8d e4 1a 0e 85 7e b9  |....QV........~.|
+00000390  56 1c 0b dd 7a ce 7d d8  c7 8d f0 d0 66 d4 84 ea  |V...z.}.....f...|
+000003a0  54 1b 4b 08 bb e8 28 9f  b7 d2 f3 e4 b7 72 47 14  |T.K...(......rG.|
+000003b0  cb 17 03 03 00 35 30 f8  65 a3 16 fd 3a b5 17 7c  |.....50.e...:..||
+000003c0  c1 a2 00 5d b9 e4 13 0d  2c 91 29 c9 11 8d 5a 70  |...]....,.)...Zp|
+000003d0  3e 74 81 e0 00 68 a0 23  c0 d5 98 ce 51 b7 22 f4  |>t...h.#....Q.".|
+000003e0  8c 62 50 0a 67 d5 fb 33  10 8c ef 17 03 03 00 87  |.bP.g..3........|
+000003f0  34 00 8b e7 16 aa 15 e3  c8 0b ce 84 f1 45 f1 73  |4............E.s|
+00000400  24 46 6c ac 9a f9 0c 19  28 6f da 3b bf 68 6a 8e  |$Fl.....(o.;.hj.|
+00000410  a1 0e 40 6a c5 3c 8f 03  41 bb c0 70 c7 a3 6c 41  |..@j.<..A..p..lA|
+00000420  b8 fc 55 97 ba 19 c7 74  92 70 05 ac b7 fe a8 52  |..U....t.p.....R|
+00000430  db 4b 05 7b 83 63 12 18  36 27 6d 15 ec e2 59 54  |.K.{.c..6'm...YT|
+00000440  16 bf ee e0 4f 2c de 00  c7 e0 4c 27 1e d5 64 21  |....O,....L'..d!|
+00000450  84 31 b5 62 40 44 47 01  d7 8b 01 9c 4d 5e 73 9c  |.1.b@DG.....M^s.|
+00000460  fa 26 5b 46 63 60 a1 ad  62 ce 53 a4 eb c6 a4 8c  |.&[Fc`..b.S.....|
+00000470  0e ad 5c 1f 4a ce 95                              |..\.J..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 3b 57 39 f5 9c  |..........5;W9..|
-00000010  b7 99 0e 51 5e fb 2d d4  01 5d f3 de 06 82 d0 c4  |...Q^.-..]......|
-00000020  50 65 e8 83 8a 13 91 a1  c2 37 b6 6c 77 31 2d 67  |Pe.......7.lw1-g|
-00000030  f4 d4 4f 9a e3 51 eb b6  c4 6c 91 3a f2 e7 0d 67  |..O..Q...l.:...g|
+00000000  14 03 03 00 01 01 17 03  03 00 35 d4 53 b7 a1 18  |..........5.S...|
+00000010  c5 00 cf c8 d3 56 ca 87  9b c7 56 7b b8 e0 64 c7  |.....V....V{..d.|
+00000020  73 3b de d6 e1 8a 87 b3  ab 6e 8c f7 ec 11 c3 b9  |s;.......n......|
+00000030  6a 76 d0 f0 cf e3 b9 e2  05 e3 7b e8 9c 12 86 c6  |jv........{.....|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e bf ec f8  67 db ef c8 61 9f d0 19  |........g...a...|
-00000010  e4 71 84 5a d2 23 b7 e4  9b c3 dd ef b0 4c d8 e9  |.q.Z.#.......L..|
-00000020  a5 dc 67 17 03 03 00 13  73 bd 59 16 25 e6 2a ef  |..g.....s.Y.%.*.|
-00000030  0c a6 af a8 48 cb f6 38  39 71 1d                 |....H..89q.|
+00000000  17 03 03 00 1e 8c 41 16  ea ee 93 ac e4 81 4f 7d  |......A.......O}|
+00000010  ec 0f f6 c5 20 0b f4 20  43 fd a6 2b 96 ad c8 b1  |.... .. C..+....|
+00000020  88 31 72 17 03 03 00 13  d7 74 49 62 e8 91 a8 b1  |.1r......tIb....|
+00000030  97 47 20 8f 18 53 3e 6c  42 f5 48                 |.G ..S>lB.H|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-CHACHA20-SHA256 b/src/crypto/tls/testdata/Server-TLSv13-CHACHA20-SHA256
index 15748d8cbe..5b48ecbbb4 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-CHACHA20-SHA256
+++ b/src/crypto/tls/testdata/Server-TLSv13-CHACHA20-SHA256
@@ -1,97 +1,97 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 d6 39 ab da 14  |............9...|
-00000010  df d1 3a 9c 4e b4 a6 23  2a a5 dc 89 48 f3 a6 ed  |..:.N..#*...H...|
-00000020  e8 17 87 0c 0b df fc b2  5b 7a 75 20 b3 f6 4a 78  |........[zu ..Jx|
-00000030  c1 33 1a aa 94 76 f4 b4  88 2b 39 f4 c5 c4 a5 c6  |.3...v...+9.....|
-00000040  2c 07 6a c8 2e 86 61 6b  06 d9 ef 79 00 04 13 03  |,.j...ak...y....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 b8 16 74 4b c0  |.............tK.|
+00000010  6a c7 0c aa 46 54 67 2c  85 24 bf a9 ae 0e ed 87  |j...FTg,.$......|
+00000020  04 3a 0a e1 ad 01 f6 5f  3b 0e f9 20 d9 4d 7e 08  |.:....._;.. .M~.|
+00000030  39 73 54 49 6a dc 4f 2f  b8 18 8f d5 7e d3 09 7e  |9sTIj.O/....~..~|
+00000040  4e 62 71 c8 00 06 2c 78  f0 ad 3a 67 00 04 13 03  |Nbq...,x..:g....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 a5  |-.....3.&.$... .|
-000000b0  9b 90 b4 bb 83 8e 9e da  a9 b5 41 3e 6d c9 51 37  |..........A>m.Q7|
-000000c0  75 4d b6 21 b9 e6 f6 f8  aa 84 9d 6b 79 2b 22     |uM.!.......ky+"|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 51  |-.....3.&.$... Q|
+000000b0  36 47 08 eb b9 87 4e da  f8 20 ab e7 ff 54 d4 d8  |6G....N.. ...T..|
+000000c0  be a9 9d 54 d5 09 82 12  94 be d8 59 37 e5 65     |...T.......Y7.e|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 b3 f6 4a 78  |........... ..Jx|
-00000030  c1 33 1a aa 94 76 f4 b4  88 2b 39 f4 c5 c4 a5 c6  |.3...v...+9.....|
-00000040  2c 07 6a c8 2e 86 61 6b  06 d9 ef 79 13 03 00 00  |,.j...ak...y....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 d9 4d 7e 08  |........... .M~.|
+00000030  39 73 54 49 6a dc 4f 2f  b8 18 8f d5 7e d3 09 7e  |9sTIj.O/....~..~|
+00000040  4e 62 71 c8 00 06 2c 78  f0 ad 3a 67 13 03 00 00  |Nbq...,x..:g....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 34 14 91 74 62 f0  |..........4..tb.|
-00000090  6b 41 ca 4d ee 4c c8 a1  54 5b b6 8f 96 74 c0 b7  |kA.M.L..T[...t..|
-000000a0  a9 17 03 03 02 6d 21 04  e8 e3 e6 09 c1 43 6a b8  |.....m!......Cj.|
-000000b0  2d ad 94 76 03 ac 14 62  2c 09 c7 ec 9f 1c 7f c2  |-..v...b,.......|
-000000c0  55 cb 56 fd a4 0e ce 2e  4d 36 a3 9b 78 f8 88 12  |U.V.....M6..x...|
-000000d0  ee 0c fa de 45 00 19 94  45 99 37 d1 5b 5f 76 4a  |....E...E.7.[_vJ|
-000000e0  9d 03 61 86 95 99 9e 84  58 b7 05 bf 2b 5e 4c ad  |..a.....X...+^L.|
-000000f0  d9 3b c9 0b 98 59 82 cf  62 a1 ae 8c 63 d8 15 31  |.;...Y..b...c..1|
-00000100  34 42 04 12 6d 6e 68 57  37 ac 55 26 6d 2f cd 3e  |4B..mnhW7.U&m/.>|
-00000110  ff c1 64 80 c7 f0 91 ab  95 15 e4 69 fa f9 9b ab  |..d........i....|
-00000120  79 d7 dd 27 b3 40 04 d4  b8 24 68 74 ab 6d 8f 7b  |y..'.@...$ht.m.{|
-00000130  8d 65 b4 5b 8b 90 c4 95  18 06 bb 02 27 6b 97 a9  |.e.[........'k..|
-00000140  2d 03 11 4b 8e 1b bf 2c  21 3d c1 ff 8c a9 2c 14  |-..K...,!=....,.|
-00000150  b2 03 f5 8e 23 9b 02 a5  9b e7 ba 36 da 43 a5 2d  |....#......6.C.-|
-00000160  35 27 8c 36 7f fc 50 bc  60 ec 6e 1d 17 2c 02 a6  |5'.6..P.`.n..,..|
-00000170  58 07 77 58 a8 f0 a4 27  f4 85 65 d6 57 2b 6c e0  |X.wX...'..e.W+l.|
-00000180  a0 6b 0d db 6a de 00 3d  a6 4b 59 36 46 a7 d1 bb  |.k..j..=.KY6F...|
-00000190  b3 6c bd d1 8c e6 23 90  53 4f da 54 95 17 92 d5  |.l....#.SO.T....|
-000001a0  76 c6 40 59 e4 c3 6b ba  ba 2c 9f a7 14 76 b6 ac  |v.@Y..k..,...v..|
-000001b0  d8 47 1e b1 49 bb 3f 7a  cf 6a 98 d9 47 d1 b7 9d  |.G..I.?z.j..G...|
-000001c0  03 b6 6b a5 d8 ce ed 96  8f 9b f2 f9 a1 62 e0 06  |..k..........b..|
-000001d0  6e eb 58 59 d4 6c e5 62  d8 78 e3 79 eb 16 09 59  |n.XY.l.b.x.y...Y|
-000001e0  a3 cf b5 67 61 cd 7c 62  2b 43 55 66 fa fe 79 96  |...ga.|b+CUf..y.|
-000001f0  8f 7c 0c 0f 56 1d 51 7e  f1 c8 b2 b4 70 fc 19 80  |.|..V.Q~....p...|
-00000200  a7 5b eb e7 4c 61 01 a6  3a af 9f 3e 19 94 4a 88  |.[..La..:..>..J.|
-00000210  51 66 c5 69 e2 5b 52 62  a7 29 5a 76 c8 2f 16 a8  |Qf.i.[Rb.)Zv./..|
-00000220  b1 eb fc 63 ef 62 5d 41  80 d9 41 8e 68 11 85 09  |...c.b]A..A.h...|
-00000230  e4 bd c6 76 52 a6 50 81  58 26 2b f4 4b e9 88 48  |...vR.P.X&+.K..H|
-00000240  7f 4b d7 de 8f 34 29 65  66 42 13 ef 43 29 1c c9  |.K...4)efB..C)..|
-00000250  a6 8f 5a 39 8b f4 7d fc  71 07 dc 12 64 37 f1 c8  |..Z9..}.q...d7..|
-00000260  f4 f7 ad 26 e1 ba be d1  f2 2d a2 ea dc 75 95 ef  |...&.....-...u..|
-00000270  c0 ee b5 96 4a 07 39 32  0d 06 d5 ee 19 0a a1 e0  |....J.92........|
-00000280  bb 4d d0 59 29 36 4f f1  ae 92 65 21 74 e3 54 45  |.M.Y)6O...e!t.TE|
-00000290  05 6c fd cd 5c c3 9d 10  64 45 00 2c ab f9 07 eb  |.l..\...dE.,....|
-000002a0  e6 76 ea 3a 20 6b 21 4f  4b 98 cd a3 bd eb f2 19  |.v.: k!OK.......|
-000002b0  78 ae a5 92 93 12 ec 63  1f 9c 25 d7 0a 72 00 6b  |x......c..%..r.k|
-000002c0  40 ba cb 3e ca d4 8c 06  c7 4c 8a 5c 5d a5 9a c3  |@..>.....L.\]...|
-000002d0  45 65 5d c1 58 f6 25 0b  77 b8 84 23 1a 7e d7 e6  |Ee].X.%.w..#.~..|
-000002e0  30 e5 ab 0a 69 60 f4 33  f2 08 ae 6a 21 2d 12 5e  |0...i`.3...j!-.^|
-000002f0  bf f2 3c 3f 23 ef f5 73  e1 38 35 0e b7 0f 09 5b  |..<?#..s.85....[|
-00000300  97 d7 8e 89 4b da 95 7f  8a b3 75 39 2c 81 a5 e2  |....K.....u9,...|
-00000310  10 94 09 17 03 03 00 99  f4 56 1c 42 87 bf bb 69  |.........V.B...i|
-00000320  3f 7b a7 2f 5a c4 f3 57  c6 aa 2a 3b bd f9 5e c9  |?{./Z..W..*;..^.|
-00000330  f1 57 fa 23 90 21 c0 b6  cf 43 1b 40 c1 12 17 05  |.W.#.!...C.@....|
-00000340  36 fb 29 e5 11 50 5a d7  d7 fb ce c9 f7 b7 66 2d  |6.)..PZ.......f-|
-00000350  2e a9 8e 8e a8 2e a3 74  c0 ab 54 03 7a 6a 8f c2  |.......t..T.zj..|
-00000360  f6 4f 71 b3 ae b2 ce b5  3f c1 46 7f c8 7a ab 97  |.Oq.....?.F..z..|
-00000370  62 f1 b7 68 67 8e 89 f1  70 31 7e bc ab 50 5d e2  |b..hg...p1~..P].|
-00000380  25 af 2a 11 2b d9 79 b7  78 83 0d 69 2b 22 44 b9  |%.*.+.y.x..i+"D.|
-00000390  8b 7f 83 46 23 b3 e7 b9  16 a0 6f b2 76 01 aa 46  |...F#.....o.v..F|
-000003a0  b9 8e 41 08 56 ec e8 bf  b0 e8 da a6 d1 b2 70 99  |..A.V.........p.|
-000003b0  50 17 03 03 00 35 09 87  aa 1b d1 ef 61 7b 6c eb  |P....5......a{l.|
-000003c0  60 e0 3f 80 03 b6 94 c2  55 91 b8 4e d3 9f 22 3e  |`.?.....U..N..">|
-000003d0  ec 42 2b d1 7d 03 92 bd  df 57 b6 9d 9d fc dd f3  |.B+.}....W......|
-000003e0  62 b8 49 45 bd d3 15 d9  21 18 c3 17 03 03 00 86  |b.IE....!.......|
-000003f0  f5 8e d9 b8 7f 6e 16 b7  7c da 7c 9e 1b 6b 9d 47  |.....n..|.|..k.G|
-00000400  40 51 e2 47 e7 78 6a 93  97 76 b6 1e 9b 07 91 aa  |@Q.G.xj..v......|
-00000410  cf ed c2 f4 55 61 74 f8  a3 27 62 f0 98 b0 c9 3c  |....Uat..'b....<|
-00000420  b2 91 b5 c2 d2 0f 15 77  39 70 52 d3 1c df 78 e2  |.......w9pR...x.|
-00000430  d1 9c 0a dd af 18 56 d0  0f 3e 89 35 98 c1 8a 46  |......V..>.5...F|
-00000440  7e 2d 2a ea ee 99 ab f9  68 c0 53 6f cd d5 83 5e  |~-*.....h.So...^|
-00000450  d5 f4 89 23 2b 7c 35 41  3c 30 d5 05 fe 1c d5 b2  |...#+|5A<0......|
-00000460  45 4b 49 4a 3b 84 c6 4b  c8 54 15 32 79 d3 b2 8b  |EKIJ;..K.T.2y...|
-00000470  fd 82 dc 16 05 40                                 |.....@|
+00000080  03 03 00 01 01 17 03 03  00 17 d1 78 60 c7 92 ce  |...........x`...|
+00000090  f7 40 3f a2 00 50 01 08  29 f0 ae 48 f6 7d 18 01  |.@?..P..)..H.}..|
+000000a0  32 17 03 03 02 6d bf b8  82 e1 3a b7 70 aa 92 ec  |2....m....:.p...|
+000000b0  9a 11 03 ed 4c e5 58 9f  28 33 ce ac c1 ae da 15  |....L.X.(3......|
+000000c0  b7 7f c9 ba 95 38 51 78  04 7f 6b d4 d7 0a 58 8f  |.....8Qx..k...X.|
+000000d0  cf 84 50 01 4b 61 bb b3  a3 98 10 09 4c 3b f9 a8  |..P.Ka......L;..|
+000000e0  44 77 19 01 96 e1 da 26  4e 27 a2 4f 07 69 f0 68  |Dw.....&N'.O.i.h|
+000000f0  ec 45 a3 7f 37 67 0b 65  0f 0b 15 21 b3 36 04 36  |.E..7g.e...!.6.6|
+00000100  eb cb 25 90 a2 64 19 fb  c8 0f de af 91 4b 87 13  |..%..d.......K..|
+00000110  3c d8 9d 38 d6 9c e3 e7  81 96 3b f4 b3 ec 88 fd  |<..8......;.....|
+00000120  30 4a 01 c5 b3 bc 30 08  2a 90 e5 92 4e d5 e2 4d  |0J....0.*...N..M|
+00000130  3f 2e 4f c8 4c d7 19 fb  43 83 7a c2 2d 37 37 8a  |?.O.L...C.z.-77.|
+00000140  e2 51 aa 44 fe 7e 2b bd  f2 96 f4 22 84 20 cc 20  |.Q.D.~+....". . |
+00000150  ab db 58 c5 ae 85 16 41  93 4e 6a 27 3f dc fc 05  |..X....A.Nj'?...|
+00000160  a3 73 d5 bb 7c 80 1f 8f  f8 67 36 e6 88 12 bc 92  |.s..|....g6.....|
+00000170  3c d4 b1 88 db ea cd 8f  4c 12 b1 76 ce 44 8a 6b  |<.......L..v.D.k|
+00000180  5f 21 9c b4 f1 0e 97 a8  9c 98 ac e5 d4 b8 76 00  |_!............v.|
+00000190  63 96 1a 38 92 3f d8 d9  63 40 e3 db ba 01 1d eb  |c..8.?..c@......|
+000001a0  8e 1c 7d e6 5b 4a b8 83  48 a3 f0 df 95 d9 aa 44  |..}.[J..H......D|
+000001b0  c1 28 cc 40 51 c1 2a 7a  09 f9 08 d6 e0 26 db 92  |.(.@Q.*z.....&..|
+000001c0  1a 82 83 be 10 32 e7 bf  31 db eb 69 99 ed 9e 92  |.....2..1..i....|
+000001d0  eb 16 60 d4 07 00 70 43  3c f7 b2 1b d9 b9 54 75  |..`...pC<.....Tu|
+000001e0  99 37 bc c0 54 d8 72 42  09 63 5f 44 06 9b de 23  |.7..T.rB.c_D...#|
+000001f0  d0 f0 db 2e 91 df 29 ee  74 f3 eb 5f e5 d1 1a 25  |......).t.._...%|
+00000200  9d 66 5f 5e 82 53 ab d3  b2 2a 8b 0a 7e d6 c9 c0  |.f_^.S...*..~...|
+00000210  0b 3d c1 9c 4f 49 34 24  6b 49 ed 63 5e 05 c8 b2  |.=..OI4$kI.c^...|
+00000220  65 16 b8 3a 99 3b c6 a7  b9 2c e9 49 67 fc 0d 8a  |e..:.;...,.Ig...|
+00000230  ac 4d d8 b3 c6 c4 9f 21  11 8e 40 64 b5 b0 d9 0e  |.M.....!..@d....|
+00000240  46 af 8e ae 4e 62 ff 7f  b8 4c 0b 1c 27 b6 27 45  |F...Nb...L..'.'E|
+00000250  dc 0e 8d 9b 6d 2a 10 b2  aa dd 01 4e d5 c5 a5 6a  |....m*.....N...j|
+00000260  b0 10 5b c0 a7 d4 8f d8  cb e1 6f 1f e4 f4 97 70  |..[.......o....p|
+00000270  13 b5 7d 34 e2 46 db f8  d0 ed 82 91 fa 53 0d e6  |..}4.F.......S..|
+00000280  21 fe 5b 8e 2f 19 9c c8  ed 6f c3 11 ee ed fc eb  |!.[./....o......|
+00000290  23 1c 2a 04 f6 65 dd 07  db e3 7b 91 fb 67 cb f2  |#.*..e....{..g..|
+000002a0  7b 67 4b e7 c0 91 cb 9c  7e b8 c8 d3 69 74 48 f0  |{gK.....~...itH.|
+000002b0  8b 3e f0 79 7f b3 fc 2e  06 ee 07 ca cf 9d 06 8d  |.>.y............|
+000002c0  62 07 33 51 3b 80 8d 47  a2 53 7c 6b 18 80 5c 30  |b.3Q;..G.S|k..\0|
+000002d0  2a 7b 32 ae de 53 c8 c8  04 95 c2 46 0c 88 c0 69  |*{2..S.....F...i|
+000002e0  0c e2 40 38 1d db a8 06  9e fb 8b 28 82 c4 46 7f  |..@8.......(..F.|
+000002f0  4d af 99 04 fc 7b 74 4f  14 7f 3b bd 66 0a 93 c6  |M....{tO..;.f...|
+00000300  e6 e0 31 ee d6 b2 06 50  23 21 cd 7f 85 10 df e1  |..1....P#!......|
+00000310  e2 dd 9e 17 03 03 00 99  8d 3f 93 fd e4 a1 07 76  |.........?.....v|
+00000320  fb fd b1 10 a1 9b d1 2c  e0 f1 44 35 42 2a 4a 4a  |.......,..D5B*JJ|
+00000330  3a 4e 14 bc 9f 8e d0 f9  7b 67 ef 2b 16 3e fd d7  |:N......{g.+.>..|
+00000340  19 98 2e 95 38 a7 21 61  1f 02 9d 12 23 04 ed b0  |....8.!a....#...|
+00000350  7c 50 d0 f3 41 7e 61 24  55 b1 53 fb 11 7e e2 86  ||P..A~a$U.S..~..|
+00000360  9d 00 6e 73 70 d0 e4 54  90 48 ef 77 8a e0 15 7b  |..nsp..T.H.w...{|
+00000370  cf 00 8e 83 29 ee 99 c5  5a 83 54 14 9e 3b 68 7b  |....)...Z.T..;h{|
+00000380  e5 0a 55 f7 d9 24 5e 70  11 26 41 82 fc 63 52 e9  |..U..$^p.&A..cR.|
+00000390  17 48 87 6c 35 42 c5 b4  92 b3 c9 b4 fe 7d 47 ac  |.H.l5B.......}G.|
+000003a0  4f 55 82 6a 14 e2 5a e1  98 cb 31 59 04 b6 cf 4e  |OU.j..Z...1Y...N|
+000003b0  62 17 03 03 00 35 63 58  16 de 31 44 14 25 7d 16  |b....5cX..1D.%}.|
+000003c0  f0 52 f8 ee 73 b4 e4 5c  a4 dd b0 f3 a8 f9 cf 39  |.R..s..\.......9|
+000003d0  87 2b 4d 60 c9 a0 f0 e4  69 37 a1 b5 52 fe 39 e4  |.+M`....i7..R.9.|
+000003e0  e9 82 d5 93 4a 2a df 05  af 33 56 17 03 03 00 87  |....J*...3V.....|
+000003f0  81 c8 b7 c7 09 16 97 f1  d1 e8 95 eb 05 d6 19 a4  |................|
+00000400  b7 ed de 7d 0c 75 eb f0  55 dc 2c 31 23 8e 11 28  |...}.u..U.,1#..(|
+00000410  98 db 37 d1 88 9f 70 17  e2 c4 ca 53 61 ee 8d b5  |..7...p....Sa...|
+00000420  48 90 00 9a 36 85 2f 2e  12 1b 9b ee 0f 47 20 dc  |H...6./......G .|
+00000430  79 34 e0 8d 04 e9 57 36  ed e4 e6 b4 b5 a2 19 4d  |y4....W6.......M|
+00000440  84 1e e2 07 4a 0f 76 5a  c6 00 f9 1d 39 9c df 43  |....J.vZ....9..C|
+00000450  42 37 40 48 e6 60 d7 d0  8a 8d c5 c1 7d 52 18 59  |B7@H.`......}R.Y|
+00000460  9c 3a d8 55 11 cc cc 07  a5 8f ef 70 e1 91 7d 2d  |.:.U.......p..}-|
+00000470  47 91 a3 07 f7 25 6a                              |G....%j|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 c5 a7 dd 3d 2a  |..........5...=*|
-00000010  73 ab 68 90 23 4e 7e f7  62 33 17 2c f1 fe c4 38  |s.h.#N~.b3.,...8|
-00000020  d8 82 e1 3a 7c 4d cc a0  42 60 0b 0a 95 d2 30 10  |...:|M..B`....0.|
-00000030  96 fe af 54 27 a7 7d 25  82 a4 0b 67 89 a2 fb 6d  |...T'.}%...g...m|
+00000000  14 03 03 00 01 01 17 03  03 00 35 0a ef 78 71 0b  |..........5..xq.|
+00000010  b7 cd 3e 05 16 87 99 d7  b9 61 0a 5d 14 d9 d1 12  |..>......a.]....|
+00000020  26 cf 80 34 33 54 f0 cf  99 73 1c e8 f8 6d 7a d7  |&..43T...s...mz.|
+00000030  20 bf a8 a9 7f d9 ef ee  b0 2e a4 52 d1 e5 16 c8  | ..........R....|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e f7 33 07  91 15 3f 10 e8 7b 3c 23  |......3...?..{<#|
-00000010  0f 21 16 b5 53 09 e9 bd  c4 b5 02 c9 07 f9 83 bc  |.!..S...........|
-00000020  57 12 b9 17 03 03 00 13  2c e8 03 f7 39 92 93 f5  |W.......,...9...|
-00000030  3c 43 04 6b 0f 41 43 83  f9 6a af                 |<C.k.AC..j.|
+00000000  17 03 03 00 1e 2d 9a a1  59 ea 0b b5 0d 00 c2 e2  |.....-..Y.......|
+00000010  93 bd 8c 29 e0 48 e5 7f  f0 74 35 12 11 08 0d 09  |...).H...t5.....|
+00000020  6c 18 d8 17 03 03 00 13  09 3e 2b 79 2d d9 ca 26  |l........>+y-..&|
+00000030  b9 3f 85 96 bf 64 e1 9c  d0 4e f0                 |.?...d...N.|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndECDSAGiven b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndECDSAGiven
index 5e7942f529..d424d42dfb 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndECDSAGiven
+++ b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndECDSAGiven
@@ -1,180 +1,180 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 67 df f1 45 11  |...........g..E.|
-00000010  23 2e f9 c7 b7 79 9c d2  de 79 f5 c8 05 95 76 ae  |#....y...y....v.|
-00000020  6e ae 30 53 4e 00 cb 8d  7e 76 d5 20 2c a2 11 43  |n.0SN...~v. ,..C|
-00000030  95 21 85 87 45 b8 05 61  33 53 21 4d 52 cd 30 24  |.!..E..a3S!MR.0$|
-00000040  6c ae d5 19 af c0 7f 1b  db ca ca 4c 00 04 13 01  |l..........L....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 41 00 0b fe 6e  |...........A...n|
+00000010  db 4b f8 8c db 23 04 20  39 bd 29 85 5b ef 5e 36  |.K...#. 9.).[.^6|
+00000020  37 a2 1c 47 de 53 ee 1b  5b 4b 2f 20 89 aa 8d 4a  |7..G.S..[K/ ...J|
+00000030  3c a7 8b aa 92 ca 1f 83  fa 60 cc 90 b5 54 d4 d9  |<........`...T..|
+00000040  e2 c8 a3 1b d7 a4 15 9f  a6 f4 be b9 00 04 13 01  |................|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 6b  |-.....3.&.$... k|
-000000b0  fb ae 27 db eb 54 a0 61  ad 59 20 9e 0f ac 6c 2c  |..'..T.a.Y ...l,|
-000000c0  63 9b 23 d0 5a 29 45 a8  5f 03 41 66 18 cd 59     |c.#.Z)E._.Af..Y|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 89  |-.....3.&.$... .|
+000000b0  d2 23 60 c4 08 7b 62 54  11 ad fe 71 3d 10 1a 92  |.#`..{bT...q=...|
+000000c0  49 52 7a ad 57 41 1e e1  46 64 09 34 79 0e 04     |IRz.WA..Fd.4y..|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 2c a2 11 43  |........... ,..C|
-00000030  95 21 85 87 45 b8 05 61  33 53 21 4d 52 cd 30 24  |.!..E..a3S!MR.0$|
-00000040  6c ae d5 19 af c0 7f 1b  db ca ca 4c 13 01 00 00  |l..........L....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 89 aa 8d 4a  |........... ...J|
+00000030  3c a7 8b aa 92 ca 1f 83  fa 60 cc 90 b5 54 d4 d9  |<........`...T..|
+00000040  e2 c8 a3 1b d7 a4 15 9f  a6 f4 be b9 13 01 00 00  |................|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 f8 ec 84 1c c6 fc  |................|
-00000090  84 d0 a7 1b fa 55 1f 9e  d3 90 f2 88 83 79 77 8f  |.....U.......yw.|
-000000a0  10 17 03 03 00 3e 0e b5  4c d7 0b ef 3e c6 84 42  |.....>..L...>..B|
-000000b0  52 80 be 05 05 7e a1 8c  be 8c ad 65 35 87 6d 1f  |R....~.....e5.m.|
-000000c0  91 81 29 bc ec a0 ba 2b  af 54 aa 95 c8 8e 93 1d  |..)....+.T......|
-000000d0  26 39 21 06 fe 56 66 55  b1 6d de 4b 3f ee 64 f3  |&9!..VfU.m.K?.d.|
-000000e0  9c e5 b8 50 17 03 03 02  6d 5c fb 39 21 7c 17 36  |...P....m\.9!|.6|
-000000f0  b2 f3 3d f7 58 f1 1a 13  f2 e2 62 6e 0d 16 9c 37  |..=.X.....bn...7|
-00000100  aa 7e e6 93 d9 4b de e8  80 b4 bf 15 0b 86 dd fc  |.~...K..........|
-00000110  e5 55 c1 0a 29 b1 86 28  dd 31 e9 15 45 8d f1 b2  |.U..)..(.1..E...|
-00000120  3d 46 19 57 f3 2c 0b d4  49 74 ba 0a be 43 96 3c  |=F.W.,..It...C.<|
-00000130  e9 49 1c 6a 1f 4e 81 cc  f6 86 f7 7b 21 51 24 90  |.I.j.N.....{!Q$.|
-00000140  6d 9f 6c 54 4a 36 b5 a2  ad d9 92 2f 25 e6 b3 84  |m.lTJ6...../%...|
-00000150  89 86 a5 be 6b e3 38 ea  59 58 be f3 d6 eb 04 33  |....k.8.YX.....3|
-00000160  a6 3c 9a 1f ae 74 42 b1  88 3b 00 07 e9 00 7b ef  |.<...tB..;....{.|
-00000170  e9 84 2c 27 1f a3 fe a7  40 bf 86 59 5a f5 3c 24  |..,'....@..YZ.<$|
-00000180  d2 65 39 16 88 fa 62 52  54 05 fe 1f d7 12 e0 d5  |.e9...bRT.......|
-00000190  17 06 af a0 f4 66 aa 42  73 a2 b1 a3 0e 89 ed 24  |.....f.Bs......$|
-000001a0  31 0d f9 01 ff dc c9 c0  26 14 1c 1f f2 7b 7d 8a  |1.......&....{}.|
-000001b0  f6 fc 78 7a 20 b1 11 f8  bc 95 2b 70 57 da 3f c3  |..xz .....+pW.?.|
-000001c0  8e e7 02 92 b5 5e 10 54  bc 30 b7 4c 1c 76 51 a4  |.....^.T.0.L.vQ.|
-000001d0  81 65 05 17 76 15 e5 9a  5f 3a 0c 39 b4 16 de f9  |.e..v..._:.9....|
-000001e0  0d 82 5f fd 1a 8a b0 d6  2c 59 75 92 39 fb 9c ce  |.._.....,Yu.9...|
-000001f0  03 f6 52 64 49 1f d6 8e  6c 69 82 15 dd 96 99 e9  |..RdI...li......|
-00000200  2c 93 72 90 05 de d2 30  2c d1 f7 8c be 52 d2 7d  |,.r....0,....R.}|
-00000210  67 8e 25 7b 47 4d 02 d6  86 bd 1d 9a 9c 17 03 f3  |g.%{GM..........|
-00000220  ed f7 41 6b b4 65 b2 31  8f bd 82 5f 8c 4a eb 02  |..Ak.e.1..._.J..|
-00000230  4d c6 27 3c f2 d1 00 7d  1e 87 01 d0 68 34 e1 0e  |M.'<...}....h4..|
-00000240  18 65 94 67 6c 94 da 5d  39 0c f6 e8 6a e5 16 71  |.e.gl..]9...j..q|
-00000250  81 5b da 7c 31 09 8b b8  c4 1c 58 90 6b e4 34 2f  |.[.|1.....X.k.4/|
-00000260  af 3f 5d 68 ba 36 bd e3  5f 7f 6e f7 e5 1c 83 9c  |.?]h.6.._.n.....|
-00000270  5f d1 ec 75 ec bd 6b db  50 56 8b de 4d 4c 60 5b  |_..u..k.PV..ML`[|
-00000280  5f 51 13 14 c9 02 1f 42  24 75 05 13 a0 f2 05 1b  |_Q.....B$u......|
-00000290  50 a7 07 53 cb 07 14 ca  69 ce 21 66 a8 91 6d 40  |P..S....i.!f..m@|
-000002a0  ea d6 2c 08 8d 97 73 e1  04 e9 0f 63 58 0c 82 19  |..,...s....cX...|
-000002b0  f4 b0 6b b7 ae 18 62 df  fb 75 32 d7 02 73 e4 85  |..k...b..u2..s..|
-000002c0  f0 e9 e1 00 49 65 ed 2b  fa 4b 42 80 06 00 7f bf  |....Ie.+.KB.....|
-000002d0  27 49 a8 d8 4c ab 09 f5  f3 a9 61 af e4 e6 20 33  |'I..L.....a... 3|
-000002e0  18 9a 00 da 73 0c d0 86  e4 da 81 42 34 06 84 6f  |....s......B4..o|
-000002f0  a7 0c 58 be 8e 7e 02 20  ba 12 ce 61 92 3b 62 21  |..X..~. ...a.;b!|
-00000300  4d bf 72 b1 c6 aa b2 e6  21 c8 65 e1 9f 12 66 bb  |M.r.....!.e...f.|
-00000310  d9 1a 1c d7 01 1f ae e5  64 45 e2 97 35 9c ec aa  |........dE..5...|
-00000320  ca 64 d4 07 8b 90 92 d6  3f bc 90 08 36 ec c7 3b  |.d......?...6..;|
-00000330  cd f1 b5 90 75 6e 82 6d  cb 8f 5f 24 11 a9 a5 35  |....un.m.._$...5|
-00000340  48 a1 48 e4 94 4c 62 b3  3d f5 61 31 db 56 1a f8  |H.H..Lb.=.a1.V..|
-00000350  c0 8c 90 9a c1 16 17 03  03 00 99 07 62 9d 2c d2  |............b.,.|
-00000360  0e b6 f2 67 69 8d eb 23  fd 0a a2 e7 af fa a3 a1  |...gi..#........|
-00000370  39 28 71 78 32 1b 06 2f  bd 94 10 da 76 c6 68 6e  |9(qx2../....v.hn|
-00000380  a6 43 cb b5 7a 4b f1 02  00 4a 15 e9 05 6a 2b 47  |.C..zK...J...j+G|
-00000390  b2 24 a2 5c a1 48 1c 5c  4b 38 82 f8 3f 3b 1b b6  |.$.\.H.\K8..?;..|
-000003a0  37 ec ca a6 9e 50 ed 8c  88 ef a4 d6 cc ce 33 ef  |7....P........3.|
-000003b0  2f 1f 80 ac 6e 8c da 18  b9 ef 30 7a 63 30 a7 26  |/...n.....0zc0.&|
-000003c0  c8 8f c5 a7 18 d6 f3 56  08 cc 64 2b 7b 4a e3 3f  |.......V..d+{J.?|
-000003d0  b0 ad 27 7a 8c de f1 b5  92 b0 64 19 5e 06 56 9f  |..'z......d.^.V.|
-000003e0  bd 98 6f a5 99 33 03 3a  78 c3 86 3d 6a a5 4f 20  |..o..3.:x..=j.O |
-000003f0  2a 64 5d d0 17 03 03 00  35 98 c1 a0 c6 fb db e6  |*d].....5.......|
-00000400  d5 82 1c 93 77 cc aa 75  84 65 c1 4e 9e 62 fa 8e  |....w..u.e.N.b..|
-00000410  07 c7 63 52 07 bb 14 26  65 d9 2b a9 e5 51 37 82  |..cR...&e.+..Q7.|
-00000420  5d 2f 5c 21 fb fd 9a 96  d4 41 9f 79 ef b1        |]/\!.....A.y..|
+00000080  03 03 00 01 01 17 03 03  00 17 23 7d 81 4a b9 17  |..........#}.J..|
+00000090  cb 6f b4 10 3b 0d ac 24  8e e3 c9 27 9e 00 df d7  |.o..;..$...'....|
+000000a0  c0 17 03 03 00 3e 68 7a  1e 54 90 3a 52 70 2a 7c  |.....>hz.T.:Rp*||
+000000b0  c7 eb 0a 31 54 9d 91 76  9c fe 14 08 4b 11 c1 0c  |...1T..v....K...|
+000000c0  6f f7 20 8c f0 01 11 21  78 a6 83 58 c7 80 58 14  |o. ....!x..X..X.|
+000000d0  04 4a 14 26 64 d6 44 a8  f8 d8 a3 96 61 4f 50 de  |.J.&d.D.....aOP.|
+000000e0  3b fc 05 b2 17 03 03 02  6d cd f5 b9 c2 d6 56 de  |;.......m.....V.|
+000000f0  71 12 17 1a 8d c2 ee 80  ae 9e e6 d1 c4 0c d7 a3  |q...............|
+00000100  1d 1e df b5 98 d4 3c f1  08 7b 32 c5 00 c0 38 81  |......<..{2...8.|
+00000110  5c 90 86 63 25 39 22 e4  97 e6 04 ce 96 25 9f 9b  |\..c%9"......%..|
+00000120  5c ad b9 19 a5 e5 9d 3d  69 b4 46 51 74 fe ea 0d  |\......=i.FQt...|
+00000130  c9 85 ed fb b9 e7 e8 6a  6f f0 e4 0e a1 3f 73 b6  |.......jo....?s.|
+00000140  1f d4 3c 29 19 ff e3 c4  42 94 64 d7 d4 46 cf 0c  |..<)....B.d..F..|
+00000150  ed c6 57 be 33 cd c7 0b  e1 e5 50 38 bf c1 bc 45  |..W.3.....P8...E|
+00000160  33 ff f7 59 ed 7f 83 23  ee aa 5b a3 e2 7e 43 e8  |3..Y...#..[..~C.|
+00000170  ec f8 c9 49 83 00 92 7a  63 5d 8e 8d 6a 98 f0 97  |...I...zc]..j...|
+00000180  8b 9d d9 32 7f fd 57 0a  75 24 74 e2 37 5a e5 8b  |...2..W.u$t.7Z..|
+00000190  78 d2 98 a5 05 44 6e 2b  d2 d5 41 3c dd 07 60 46  |x....Dn+..A<..`F|
+000001a0  f3 78 14 83 2a 81 1d 24  de 62 57 bd d3 fd 5b 53  |.x..*..$.bW...[S|
+000001b0  0d 53 0d 86 16 33 fb 1a  d1 ad 0a d1 1d 25 bb ad  |.S...3.......%..|
+000001c0  55 d2 9e 8b 67 c7 b1 fe  4f 17 7c 86 bc 76 93 e7  |U...g...O.|..v..|
+000001d0  47 c0 29 b9 a7 2e 4e 84  4a 75 a2 6f cc 25 28 52  |G.)...N.Ju.o.%(R|
+000001e0  d2 87 e1 8e 0e 70 f1 11  2a ca ad 2e 4c a8 c3 79  |.....p..*...L..y|
+000001f0  46 80 39 ba 27 a8 f4 2a  3f d7 73 92 7a 61 05 db  |F.9.'..*?.s.za..|
+00000200  18 85 9a 02 9e aa 17 ab  ee 0a cb 4c 33 72 bc 4c  |...........L3r.L|
+00000210  57 a6 fd 23 0f 0c 72 bd  10 d3 54 9d dc ff 84 9a  |W..#..r...T.....|
+00000220  64 c5 b6 24 54 ad 45 14  d1 c4 15 c9 9c 09 e5 96  |d..$T.E.........|
+00000230  f0 48 03 8c 35 3d 6b 91  68 58 a6 37 b1 a5 e3 d8  |.H..5=k.hX.7....|
+00000240  f1 7e 6f 96 34 d1 e0 6a  a6 90 6d 4b 3b 12 e8 f2  |.~o.4..j..mK;...|
+00000250  29 18 93 5d 45 29 f2 e3  a8 08 25 2d 0c a1 87 f9  |)..]E)....%-....|
+00000260  46 29 57 57 ef 0d b9 17  4e d2 bb 5d 26 29 cc 8b  |F)WW....N..]&)..|
+00000270  55 d5 ff a4 44 1f e4 e9  bc d4 bf 68 d5 cf aa 1a  |U...D......h....|
+00000280  45 b6 56 99 d8 27 5d b9  88 2d a1 a2 55 51 0f 99  |E.V..']..-..UQ..|
+00000290  be cc 9b ad b5 bd 8a d5  ad 86 9f a3 6b 71 5d 17  |............kq].|
+000002a0  f0 98 a7 84 b2 6e 63 1e  ae 02 0a 50 88 53 b8 58  |.....nc....P.S.X|
+000002b0  a7 d8 74 4b 39 85 eb a5  1d 37 51 e5 40 b2 d7 3b  |..tK9....7Q.@..;|
+000002c0  5e 88 e2 96 c1 1a 84 53  7e 33 a7 cc 49 f1 b0 ae  |^......S~3..I...|
+000002d0  d6 37 e0 6d c8 2f c0 07  72 fa 7d 3d e7 91 cb 68  |.7.m./..r.}=...h|
+000002e0  f5 ae ca 4d da 44 70 b4  8e 7c 90 70 f4 7f 20 e3  |...M.Dp..|.p.. .|
+000002f0  1c 61 75 ef c4 ca ad dd  b9 9f e6 86 73 31 a4 c5  |.au.........s1..|
+00000300  55 f8 6a 27 d8 56 c6 c2  11 de ed 01 20 08 01 fe  |U.j'.V...... ...|
+00000310  5e e2 91 fb c8 91 d3 40  e0 b2 d7 a7 01 9b 1d f7  |^......@........|
+00000320  19 ee e6 fe 62 a4 a2 cc  33 30 00 04 14 11 bb 2e  |....b...30......|
+00000330  7f da 29 27 5d e9 6c ba  93 62 93 d4 31 97 48 2d  |..)'].l..b..1.H-|
+00000340  32 e0 3f 97 c3 ca fb 58  10 52 5d e6 4b 8b d5 37  |2.?....X.R].K..7|
+00000350  27 e3 28 74 65 20 17 03  03 00 99 22 7a 53 75 d8  |'.(te ....."zSu.|
+00000360  bf 52 be e9 c9 d0 17 f9  cc d5 50 7f 5c d0 89 64  |.R........P.\..d|
+00000370  52 6f 47 b1 a1 a4 4c 65  59 b9 c7 86 d3 fc 42 3c  |RoG...LeY.....B<|
+00000380  9e ae f2 a3 21 35 fb 72  eb df e6 78 9b 2a b8 be  |....!5.r...x.*..|
+00000390  b1 68 b0 6a fa ff 01 e0  6a 5b a7 f8 1f 8d 00 70  |.h.j....j[.....p|
+000003a0  aa 5d ab a9 1b c2 37 1e  5b 70 ed fc 10 92 47 98  |.]....7.[p....G.|
+000003b0  d9 ec 15 3c 30 65 a6 1b  0c b3 56 74 2b d0 c2 8f  |...<0e....Vt+...|
+000003c0  91 b2 07 5e 90 c4 9c f4  77 5c d4 c4 ab 70 e7 e0  |...^....w\...p..|
+000003d0  44 8a 52 c0 b7 42 84 f4  4f a4 d3 55 53 af 4a a2  |D.R..B..O..US.J.|
+000003e0  ce a7 c4 2c ed 0b a8 07  28 4e f5 b4 3f f0 cc 89  |...,....(N..?...|
+000003f0  e6 a6 e0 3d 17 03 03 00  35 28 89 45 89 0a 9b 22  |...=....5(.E..."|
+00000400  cf 6b ce 32 1d 62 fc 2a  87 3e 21 12 12 c0 36 54  |.k.2.b.*.>!...6T|
+00000410  f9 4f 70 da 3e 87 17 49  a1 43 6e ff cc 9e 34 06  |.Op.>..I.Cn...4.|
+00000420  e7 38 bd 9b e8 13 47 0e  de fe 61 56 19 fa        |.8....G...aV..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 02 1e 0c 53 fd 6c c9  |............S.l.|
-00000010  be 5e 14 17 cf 01 1c 65  7c fc 02 8b 36 24 ce d3  |.^.....e|...6$..|
-00000020  0d 7f 68 4d 10 75 59 d9  ba 3a 91 27 8a 37 61 74  |..hM.uY..:.'.7at|
-00000030  bd 69 96 dd e1 b8 0b ec  7c 9f 75 97 62 f6 46 6e  |.i......|.u.b.Fn|
-00000040  24 bb a8 27 7a c1 e4 68  3a 93 52 ea f7 28 07 85  |$..'z..h:.R..(..|
-00000050  6f a0 3b 00 5f 15 d3 16  17 80 4c ea ba ca 00 11  |o.;._.....L.....|
-00000060  27 5c f3 cb c7 ed 6f dd  54 91 42 41 82 43 32 18  |'\....o.T.BA.C2.|
-00000070  62 bd d6 4e 9e d6 45 3d  1d b5 95 1c c1 ab 5b a8  |b..N..E=......[.|
-00000080  fe 47 88 54 a7 cf 56 9c  bb d5 49 8a cc 6e 28 d6  |.G.T..V...I..n(.|
-00000090  ad a4 55 61 f4 82 ff 60  79 9b 88 64 ec b7 5a 3e  |..Ua...`y..d..Z>|
-000000a0  62 16 a4 74 30 59 61 b1  4b 4c 60 25 98 50 97 f3  |b..t0Ya.KL`%.P..|
-000000b0  48 70 1d c2 3b 0c 78 7f  dd 57 90 cf 5d 2a 6b ef  |Hp..;.x..W..]*k.|
-000000c0  a8 ab 82 d9 5b 69 94 16  16 68 2e e7 36 7e 02 c9  |....[i...h..6~..|
-000000d0  41 9d f2 be 26 83 3c 4b  b9 a7 e1 3b 7d 49 cd 69  |A...&.<K...;}I.i|
-000000e0  60 74 91 0a cc 1c c5 fe  53 6b cf 0f 2e 1f 79 5b  |`t......Sk....y[|
-000000f0  9d 60 55 1c 30 0e 25 ce  37 7f 39 67 fa f6 b8 e6  |.`U.0.%.7.9g....|
-00000100  cc c5 28 6f 50 0b ac b1  b5 d8 e9 44 b1 8c 60 b1  |..(oP......D..`.|
-00000110  b4 a8 6c be 53 0c e3 75  fc f2 20 49 ce e4 7a 2c  |..l.S..u.. I..z,|
-00000120  8f 7a f3 19 39 db b8 bc  96 b3 eb 66 9e f2 dd 24  |.z..9......f...$|
-00000130  95 a9 48 61 31 48 b3 23  66 d2 ca 06 08 2d 1b 60  |..Ha1H.#f....-.`|
-00000140  68 b1 c6 fa 0c a7 bb 3e  f8 c9 9e 47 de 5f 3c 78  |h......>...G._<x|
-00000150  3e 7d b7 aa 5c e7 6b 9a  ca 60 eb f7 1e 8f bb 7c  |>}..\.k..`.....||
-00000160  85 2f 81 df 30 fc 15 5e  8a c0 b8 eb 19 5d 2e d7  |./..0..^.....]..|
-00000170  4c 4b 99 60 ee 22 96 a3  59 9b 20 a8 eb 62 33 bb  |LK.`."..Y. ..b3.|
-00000180  58 82 f4 83 aa 4c 0a 24  68 c8 2e d8 17 44 08 51  |X....L.$h....D.Q|
-00000190  94 d2 a8 dc 9d 65 8e cf  14 ec e8 68 c0 e4 bc 30  |.....e.....h...0|
-000001a0  b6 a4 57 a1 f5 3a c5 ef  53 81 f9 a2 cd d7 ca d8  |..W..:..S.......|
-000001b0  9c e1 72 ec d1 87 ee e4  85 30 74 ae 5b 63 e0 6c  |..r......0t.[c.l|
-000001c0  09 19 86 56 8e 91 ba ce  13 24 1c 2b 04 43 5d a5  |...V.....$.+.C].|
-000001d0  db 83 3b 89 e6 ff 90 54  e2 31 e8 b9 5e 70 db 38  |..;....T.1..^p.8|
-000001e0  9f 0c b2 af 58 14 06 9c  f7 68 90 5c 3e 35 77 54  |....X....h.\>5wT|
-000001f0  3e 66 87 cb 52 23 21 0b  ab 3a 93 9a e4 ac cc c6  |>f..R#!..:......|
-00000200  61 d5 2c b9 3d d0 16 9e  19 6f 21 51 e3 73 94 96  |a.,.=....o!Q.s..|
-00000210  a8 2c f1 0c c3 3f 93 3e  ce 4a 86 57 9e 7d eb 8d  |.,...?.>.J.W.}..|
-00000220  fa b4 65 00 93 bc f1 36  55 17 03 03 00 a3 22 15  |..e....6U.....".|
-00000230  02 7a 68 4a a7 e8 89 36  48 c2 03 37 6a c5 14 30  |.zhJ...6H..7j..0|
-00000240  88 85 99 3a 35 b4 1c 73  77 d2 36 13 5f cd 20 6e  |...:5..sw.6._. n|
-00000250  df 42 d5 9e 71 cf 9a 48  98 a5 9d c3 d5 d5 1b 76  |.B..q..H.......v|
-00000260  38 c7 48 94 31 f2 80 d0  bb a1 32 90 2b a4 13 40  |8.H.1.....2.+..@|
-00000270  ac f9 eb c0 1f ca 35 ff  61 10 79 b8 e5 47 d7 7e  |......5.a.y..G.~|
-00000280  b2 46 46 37 c7 f7 21 89  59 a1 a5 b9 96 a4 51 ba  |.FF7..!.Y.....Q.|
-00000290  09 e7 9b b4 53 c0 87 29  5c f1 a3 e3 10 fc 4c a7  |....S..)\.....L.|
-000002a0  6f 30 cc cc 80 58 c8 7d  be 9f ea b6 24 42 90 9a  |o0...X.}....$B..|
-000002b0  a6 c2 2e 49 f9 97 e9 4c  4e 64 4f 1e 5b c3 04 7d  |...I...LNdO.[..}|
-000002c0  7c 36 34 05 d2 d5 29 55  20 35 fb d1 63 24 1f 3b  ||64...)U 5..c$.;|
-000002d0  54 17 03 03 00 35 d5 85  e3 e3 b1 c4 03 6b c5 1a  |T....5.......k..|
-000002e0  7f cb b8 a9 0e 73 90 5c  82 95 fa 25 f8 aa 43 ea  |.....s.\...%..C.|
-000002f0  27 d5 70 c0 0f 6b ee 06  63 e9 2e 59 d7 12 4f 3a  |'.p..k..c..Y..O:|
-00000300  b6 1b 98 4d 91 9a a0 38  db e2 c7 17 03 03 00 13  |...M...8........|
-00000310  19 23 f2 af 5d 63 d6 e1  09 a7 8d 68 18 6b 06 af  |.#..]c.....h.k..|
-00000320  45 44 02                                          |ED.|
+00000000  14 03 03 00 01 01 17 03  03 02 1e 15 99 04 e9 2f  |.............../|
+00000010  0f 5f a2 83 6c d3 6f 14  ec 36 cd ac ad 44 40 0e  |._..l.o..6...D@.|
+00000020  8a e5 62 a1 f7 0b b7 52  04 0b a9 6f 60 be 36 c3  |..b....R...o`.6.|
+00000030  5c d1 76 47 41 32 b6 61  52 32 71 46 03 40 11 aa  |\.vGA2.aR2qF.@..|
+00000040  44 ad e7 40 26 c8 2d 4a  85 4a 24 ef 05 31 c9 91  |D..@&.-J.J$..1..|
+00000050  9c 16 7f f5 1c 5e ef d5  2c 3c 88 ed d3 e6 09 fd  |.....^..,<......|
+00000060  a4 7e 5e 4f 34 84 30 38  e1 dd cc 9b 21 d5 bc c4  |.~^O4.08....!...|
+00000070  c2 7e fa 9a 9e 0c fe f8  c3 80 02 8a 6c 00 2b ac  |.~..........l.+.|
+00000080  dd ca 45 5b c1 80 53 3d  3f 37 e6 b4 ab 09 28 f3  |..E[..S=?7....(.|
+00000090  8c 41 c4 cc 6d d6 2a d8  dc 37 51 7c 35 d9 aa 44  |.A..m.*..7Q|5..D|
+000000a0  c3 1a ba 2d 6b 1d cf 4b  20 be fb a5 1a ea 0f 83  |...-k..K .......|
+000000b0  64 88 4b a1 03 d2 b2 19  d4 df ae 2f b4 f0 79 85  |d.K......../..y.|
+000000c0  de 89 81 2d 0c 18 1b e8  3a 70 9b 26 cc 11 45 62  |...-....:p.&..Eb|
+000000d0  6f 2a a7 06 61 f9 b2 d7  9a 93 79 27 a6 ef c7 26  |o*..a.....y'...&|
+000000e0  e3 df 53 09 c5 a3 27 6b  bf aa 1b 6b 1d 4e 09 ab  |..S...'k...k.N..|
+000000f0  65 28 16 11 44 cc ea 97  aa a1 14 a2 2d f6 b9 cb  |e(..D.......-...|
+00000100  1a 4f ce b7 67 01 86 f6  d0 a6 73 94 6a bc e0 e5  |.O..g.....s.j...|
+00000110  68 20 f9 da 1d 62 9c 8b  3a a5 e9 bc e7 df 2c 07  |h ...b..:.....,.|
+00000120  f8 59 33 69 61 22 96 47  57 96 a7 eb ae 9f 65 2b  |.Y3ia".GW.....e+|
+00000130  5c 99 4e 3e f5 50 16 0b  9e 85 5e c4 28 ba fb 70  |\.N>.P....^.(..p|
+00000140  31 af ad 11 74 00 1c b5  d0 23 ce 36 e9 98 e3 09  |1...t....#.6....|
+00000150  a5 31 74 f8 5b ed a8 8e  7b 89 41 81 c4 8f 93 12  |.1t.[...{.A.....|
+00000160  61 33 95 48 6f 81 e5 9f  ef a0 05 fd c0 ae 3d f2  |a3.Ho.........=.|
+00000170  43 e2 17 7f 0a 78 b7 fd  25 1d 68 3d 3c 55 49 68  |C....x..%.h=<UIh|
+00000180  46 43 bc df 0c 2f 56 54  2a 0b db 4e 83 97 82 47  |FC.../VT*..N...G|
+00000190  f6 64 64 35 9f 29 56 43  9c 8b 54 07 b8 73 b2 e4  |.dd5.)VC..T..s..|
+000001a0  06 83 49 38 cc 3d 78 15  d2 7c 57 57 55 61 5a c5  |..I8.=x..|WWUaZ.|
+000001b0  7e 42 fe ae a5 00 0e 0b  01 4e 21 3d a8 65 98 33  |~B.......N!=.e.3|
+000001c0  40 00 de 02 9c 5e b0 33  a9 d2 24 62 20 29 d3 bc  |@....^.3..$b )..|
+000001d0  8f 3c 3c 0d 9a 12 59 fe  f1 5f da a2 c3 66 ff 28  |.<<...Y.._...f.(|
+000001e0  97 38 fd 0c c8 a8 f5 be  49 36 df 0b e1 3c 2d 05  |.8......I6...<-.|
+000001f0  04 29 c8 5d 3e 4f 51 12  92 be 90 4a f4 9f 47 4d  |.).]>OQ....J..GM|
+00000200  e7 b2 e8 f0 35 11 06 59  37 ce 11 3c 38 39 34 32  |....5..Y7..<8942|
+00000210  67 99 a7 d0 08 a6 5a 8f  d3 51 4c 72 7b 8a c1 82  |g.....Z..QLr{...|
+00000220  b9 67 37 d3 95 5c 98 47  a5 17 03 03 00 a4 18 dd  |.g7..\.G........|
+00000230  ae ad f2 7b 11 07 aa a3  e9 0d 0f ef 69 6b 29 bb  |...{........ik).|
+00000240  76 ec 64 80 d7 ae f9 70  0b 2a 04 e9 86 6c 9a 38  |v.d....p.*...l.8|
+00000250  85 a5 1f 3e 89 f9 26 2e  36 d2 0b 61 86 e7 06 01  |...>..&.6..a....|
+00000260  fd 9e a5 63 84 30 61 2a  e3 12 ca 4a a7 77 de 14  |...c.0a*...J.w..|
+00000270  7b ff d6 7c a6 ce 34 0a  3a f8 26 66 b1 19 aa fa  |{..|..4.:.&f....|
+00000280  06 73 c8 e3 12 cd 71 a4  4b 8b 71 fe 20 5f de a6  |.s....q.K.q. _..|
+00000290  01 3a 9e 8e 67 10 66 ba  e2 19 39 51 5e a4 33 71  |.:..g.f...9Q^.3q|
+000002a0  65 e1 9f b1 99 2b 3c bf  1c a2 3e e8 20 e9 87 1b  |e....+<...>. ...|
+000002b0  1f ef 17 9e 09 fd f3 52  70 d0 c6 38 bf 63 d8 bf  |.......Rp..8.c..|
+000002c0  48 4f 21 83 b1 89 b7 41  30 f2 8a 50 fe 48 ab a0  |HO!....A0..P.H..|
+000002d0  ee 26 17 03 03 00 35 1c  c5 ba 62 85 94 3f 3e 91  |.&....5...b..?>.|
+000002e0  1b 75 7c 58 17 a4 8c 18  03 dd 58 c5 fb 58 ba d3  |.u|X......X..X..|
+000002f0  36 c9 17 11 ed 80 6d 28  da 0f 74 06 97 eb 65 b9  |6.....m(..t...e.|
+00000300  00 f2 1a 31 31 30 56 0c  d8 03 fd 97 17 03 03 00  |...110V.........|
+00000310  13 22 2f 15 cb 78 1d f6  80 d0 fc ab 56 87 57 db  |."/..x......V.W.|
+00000320  7e 9a cd be                                       |~...|
 >>> Flow 4 (server to client)
-00000000  17 03 03 02 8b 45 f4 a2  5f b5 c1 41 7c 7c c7 6f  |.....E.._..A||.o|
-00000010  5b 96 ea 1a 5c 6c e1 f6  fc 78 48 ad 9b de 10 39  |[...\l...xH....9|
-00000020  c3 3f af 90 9f 0d 54 1e  8a fb 95 b8 2b 3e 0d 8e  |.?....T.....+>..|
-00000030  fb 4d d6 73 de 23 41 96  8c 2d 72 8f fb bd f9 ad  |.M.s.#A..-r.....|
-00000040  27 d1 69 cb d5 23 3d 3c  a9 2c b8 1b 8b ee c9 bf  |'.i..#=<.,......|
-00000050  2f 8a 09 f7 e5 d8 c8 8f  bd 7b fc 84 2e 06 61 4c  |/........{....aL|
-00000060  4f d0 5c 92 f3 66 18 f9  e1 36 ea 3e 01 22 0c 1d  |O.\..f...6.>."..|
-00000070  ab 86 0b b4 a7 10 63 19  7c b8 30 35 a2 f8 0a ef  |......c.|.05....|
-00000080  d0 12 98 26 92 56 3a 68  ba d7 96 4e be cd b5 03  |...&.V:h...N....|
-00000090  e1 01 d6 3a a1 8f f4 3b  11 0c b6 7d 30 37 c8 09  |...:...;...}07..|
-000000a0  73 0b 49 f6 d5 b3 77 85  1e d1 20 4e 7a da 98 6c  |s.I...w... Nz..l|
-000000b0  1d 7b b5 a7 0e 11 56 d6  cc 78 b7 7a f7 fd 10 2f  |.{....V..x.z.../|
-000000c0  8b e3 3f 61 7a 3f 58 db  17 26 05 ff 03 6d 5c 11  |..?az?X..&...m\.|
-000000d0  f5 53 68 d6 7b d8 ed 9c  d2 a7 a3 c5 ca 54 36 3d  |.Sh.{........T6=|
-000000e0  9a 35 b1 fc a1 99 a9 19  19 f3 60 13 ca c0 2e a1  |.5........`.....|
-000000f0  73 1e d1 b1 90 80 d6 6b  ab e6 a4 95 da 27 cb 50  |s......k.....'.P|
-00000100  0f d0 9e 2a 98 ca 9a 1c  86 82 95 07 35 8d f2 ef  |...*........5...|
-00000110  4b 3f 45 93 2d cc 15 82  7c e1 70 2d ab 02 b1 ae  |K?E.-...|.p-....|
-00000120  e1 38 9e 12 09 55 bf ad  c9 49 fb c9 ba f7 13 ad  |.8...U...I......|
-00000130  e7 b7 6b dd 97 df cf 6e  29 10 8e 60 68 31 f4 3d  |..k....n)..`h1.=|
-00000140  c9 29 0f 2e 7a 43 ce c3  e2 ce 08 d7 a2 aa cc e1  |.)..zC..........|
-00000150  fb fd 73 01 19 5f 14 9f  93 cc 16 06 59 86 f0 4b  |..s.._......Y..K|
-00000160  75 12 5e a7 2a 2e d8 40  b8 fd 03 38 37 80 b1 4b  |u.^.*..@...87..K|
-00000170  8f 98 cb e1 b0 db d5 c3  87 ef 2c 50 2d 52 c6 cb  |..........,P-R..|
-00000180  4e 8a cd dc 99 56 4b 2f  3b aa 8b 9d ea ef 9a ad  |N....VK/;.......|
-00000190  68 eb 9d 42 e0 0d 76 e9  6c 6b bb b7 36 d2 06 23  |h..B..v.lk..6..#|
-000001a0  c0 98 c4 4b db ee 3a 53  87 9a 17 7f 5d 98 6c 0b  |...K..:S....].l.|
-000001b0  4f 8a d1 97 17 d9 76 35  f9 b9 01 57 79 68 0f b4  |O.....v5...Wyh..|
-000001c0  a7 99 99 05 2d 99 d6 71  03 56 e0 8e 2e 83 0e d0  |....-..q.V......|
-000001d0  45 e2 24 43 67 c1 2b c9  4b 6f 82 d9 b5 a3 8a 8b  |E.$Cg.+.Ko......|
-000001e0  9f dc 11 a3 97 89 2c cb  86 ba 3e a5 c8 d0 ef 2c  |......,...>....,|
-000001f0  ba 5e 98 0e 07 36 3b f9  d9 51 c6 9c 8b 55 b6 a0  |.^...6;..Q...U..|
-00000200  2a 05 30 aa 48 7e 8e 3a  41 1f 99 b2 f9 55 8f ac  |*.0.H~.:A....U..|
-00000210  0c 12 ba 49 54 8a 2c 62  9e 6f cd 3c 9c 47 d2 bc  |...IT.,b.o.<.G..|
-00000220  b8 f1 9e a7 e7 45 be f4  94 ce be b2 81 59 79 e3  |.....E.......Yy.|
-00000230  9c a2 7e 17 47 3d a7 48  ea a4 6c 2b d5 57 3b a7  |..~.G=.H..l+.W;.|
-00000240  e4 1a f3 5b 72 e8 f4 c2  1e fb 12 75 27 69 0c fa  |...[r......u'i..|
-00000250  17 a7 6c b8 13 0f b9 ce  50 79 a1 30 ec a1 81 20  |..l.....Py.0... |
-00000260  da 0d 63 d0 5f 93 c4 ba  43 0e 37 36 82 3f 7f 4c  |..c._...C.76.?.L|
-00000270  e3 b7 94 f5 71 32 ae 47  0b 55 b3 00 15 5d a8 40  |....q2.G.U...].@|
-00000280  98 08 83 2f 2a c1 9d 02  c5 70 c1 9f 7b c3 c6 c8  |.../*....p..{...|
-00000290  17 03 03 00 1e 02 0a 00  8d e6 e2 35 8a c5 c4 ae  |...........5....|
-000002a0  aa d8 0b 9e e3 63 61 48  fd 6c 8b 99 68 df 9d 7c  |.....caH.l..h..||
-000002b0  3a c4 ae 17 03 03 00 13  38 6f 14 38 83 76 f4 78  |:.......8o.8.v.x|
-000002c0  23 ef 93 42 ac 56 d7 5f  7d a7 03                 |#..B.V._}..|
+00000000  17 03 03 02 8c 20 58 a6  78 18 96 db a9 a6 7b 82  |..... X.x.....{.|
+00000010  12 1d 91 3c d2 f2 53 46  22 56 17 ba 71 7e ab 85  |...<..SF"V..q~..|
+00000020  9d eb d3 23 8a d2 b5 fe  d0 40 ad 25 d6 bb cf f1  |...#.....@.%....|
+00000030  94 6e ea b8 f7 dc 4b cf  7c 6e 04 c7 cf 8c 00 4f  |.n....K.|n.....O|
+00000040  99 1c 4a 0d 54 02 9c 0c  48 af 82 ac b3 1c 56 91  |..J.T...H.....V.|
+00000050  36 ab b8 3a 1e 95 68 7d  70 cb be 3b c4 77 36 7d  |6..:..h}p..;.w6}|
+00000060  37 62 88 85 30 c7 a1 12  a6 ca 95 9b d7 42 71 ec  |7b..0........Bq.|
+00000070  7e f6 b8 bf f6 27 73 c0  2b 83 a5 25 c7 3c 5c 19  |~....'s.+..%.<\.|
+00000080  c1 42 8f 10 5b d9 40 cd  f7 6a b6 0d 93 54 78 9e  |.B..[.@..j...Tx.|
+00000090  f1 35 68 2a 9d fd bf 34  9d ac 97 78 bf 12 0e 2b  |.5h*...4...x...+|
+000000a0  82 91 14 32 46 0c 6b 9c  b5 74 65 24 07 e7 c0 7e  |...2F.k..te$...~|
+000000b0  76 ff 29 f1 2d 6a dc 4d  59 ef 3b 51 f5 30 b4 df  |v.).-j.MY.;Q.0..|
+000000c0  8a 28 ff 38 2f e4 30 ae  a6 5f b8 3e f5 22 eb 2d  |.(.8/.0.._.>.".-|
+000000d0  14 6a f4 ec ad c1 e2 70  be 31 76 d7 7c 41 2b 3a  |.j.....p.1v.|A+:|
+000000e0  be 55 56 dc 86 fa 44 ee  da c4 5c 52 2c 02 60 72  |.UV...D...\R,.`r|
+000000f0  03 8e f2 ea 51 c7 4c 69  16 34 93 e2 61 d3 42 96  |....Q.Li.4..a.B.|
+00000100  04 f1 fa 47 14 29 36 38  d9 f1 80 31 6f 0a 29 fa  |...G.)68...1o.).|
+00000110  c6 a9 f7 4e 54 1d 15 e8  8c fb 66 3b 0c 9d 00 b7  |...NT.....f;....|
+00000120  c4 b7 6b 3c be 14 79 0b  bd 6e 1c a6 0b 31 ac 15  |..k<..y..n...1..|
+00000130  a6 3d 61 3e fa 52 06 17  5a dc 76 ef 49 2e 36 a2  |.=a>.R..Z.v.I.6.|
+00000140  d0 e5 96 5c bf 86 1c 43  66 ba 15 a3 40 ad e5 f7  |...\...Cf...@...|
+00000150  0c e5 74 a4 e7 09 4a ed  a5 0b 96 b6 f1 c3 9a 3b  |..t...J........;|
+00000160  f3 9c 47 5f 22 4f 16 47  14 1c 75 4a 5c 84 52 d6  |..G_"O.G..uJ\.R.|
+00000170  87 15 dd 14 1b 63 bc 38  5a 03 1f 66 eb dd f4 84  |.....c.8Z..f....|
+00000180  a3 ac 6f c1 eb f6 aa 27  2c 21 aa 27 8c b5 79 a6  |..o....',!.'..y.|
+00000190  cd 0e ca 49 a6 75 ac 44  c7 fd ec 34 a2 8b bf b1  |...I.u.D...4....|
+000001a0  d2 93 1e 48 83 cc 24 c5  7a 64 fb ac 98 9c e5 c2  |...H..$.zd......|
+000001b0  8c 93 1f 7e 59 14 1b 08  33 e7 49 3d 0a 0a fb 2a  |...~Y...3.I=...*|
+000001c0  a9 ed 88 08 08 d1 1b 03  7c 50 22 6c a8 c8 1e 0d  |........|P"l....|
+000001d0  9a ab 6d 88 2b e4 6c 64  cd f1 44 5f 96 45 2a 30  |..m.+.ld..D_.E*0|
+000001e0  76 ae 91 cc c2 41 ea 95  36 c0 f2 d0 44 fd 34 ce  |v....A..6...D.4.|
+000001f0  fd 70 50 ca 4f 14 60 8b  cd e4 0c 56 fa 73 b4 f9  |.pP.O.`....V.s..|
+00000200  9c b5 cd 3f cf f5 03 65  ea a9 cc 9e f2 b3 43 ed  |...?...e......C.|
+00000210  0c 3f 71 41 d7 e7 aa bc  2b c8 25 8c d2 45 7a d7  |.?qA....+.%..Ez.|
+00000220  7d 39 b0 bf 6b 89 96 07  5a 84 29 5b 6e 4a 63 62  |}9..k...Z.)[nJcb|
+00000230  54 b2 9d b0 0b 25 4a b5  65 04 9c 86 d1 09 d8 e5  |T....%J.e.......|
+00000240  71 c1 8a 1f 8a ae 56 b5  dd 3b 20 6f b9 43 f5 23  |q.....V..; o.C.#|
+00000250  0c 9e 69 1f c8 71 38 93  e1 d0 75 14 c8 1b c6 9c  |..i..q8...u.....|
+00000260  69 04 b2 a2 a6 7f 8e 2d  e2 20 58 f5 f7 c1 0e 2c  |i......-. X....,|
+00000270  4f 81 e1 da 38 e9 1b dd  c7 18 d6 6b e0 03 01 00  |O...8......k....|
+00000280  89 4e 06 1e e4 79 e9 21  dc 3e 95 a9 07 58 f2 ee  |.N...y.!.>...X..|
+00000290  6a 17 03 03 00 1e 82 69  04 dd 7f d3 0d fa da 75  |j......i.......u|
+000002a0  cf c4 d0 19 aa c8 5b 7e  c3 6b 85 ea 7c 73 05 31  |......[~.k..|s.1|
+000002b0  35 c0 41 56 17 03 03 00  13 98 b3 91 b2 b9 db df  |5.AV............|
+000002c0  59 17 6f 97 fb 8f c7 76  bc 98 86 7a              |Y.o....v...z|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndEd25519Given b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndEd25519Given
index 326a1c591c..9878c1ecc0 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndEd25519Given
+++ b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndEd25519Given
@@ -1,148 +1,148 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 56 5e e8 13 56  |...........V^..V|
-00000010  8a 7a 4e 78 78 c9 12 15  2c 6f 85 a2 be 2e 94 fd  |.zNxx...,o......|
-00000020  e8 6f 4d ea f5 21 f6 1b  f6 7b af 20 db da ad 7d  |.oM..!...{. ...}|
-00000030  f4 77 4a d3 a0 03 d8 09  f7 6a 57 24 df e8 4c 7d  |.wJ......jW$..L}|
-00000040  cf 66 f5 1a 52 d9 e5 35  93 a2 2d 40 00 04 13 01  |.f..R..5..-@....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 40 1e b6 d9 30  |...........@...0|
+00000010  d9 57 2f 28 6c 09 8d c1  3e 27 0a 68 10 a3 9e 88  |.W/(l...>'.h....|
+00000020  2d d0 dc 8a d6 a7 d5 b4  64 fe 7d 20 09 1f bf 22  |-.......d.} ..."|
+00000030  80 8f c9 fd 67 56 3d 25  fc 8a 86 21 21 73 e2 df  |....gV=%...!!s..|
+00000040  72 fb 55 22 68 e1 b4 fb  16 82 f5 49 00 04 13 01  |r.U"h......I....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 dd  |-.....3.&.$... .|
-000000b0  14 d5 d6 4f 56 ba e0 f1  a8 7f 17 c6 23 6d 0b 62  |...OV.......#m.b|
-000000c0  65 39 88 7f de 4a 26 38  df 31 25 45 0c 93 23     |e9...J&8.1%E..#|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 53  |-.....3.&.$... S|
+000000b0  8c 84 59 9b 88 47 70 88  41 36 ac db 79 7b 1b 5c  |..Y..Gp.A6..y{.\|
+000000c0  73 d3 f3 f9 0e b9 4c a8  fb 6b 22 23 9a cd 49     |s.....L..k"#..I|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 db da ad 7d  |........... ...}|
-00000030  f4 77 4a d3 a0 03 d8 09  f7 6a 57 24 df e8 4c 7d  |.wJ......jW$..L}|
-00000040  cf 66 f5 1a 52 d9 e5 35  93 a2 2d 40 13 01 00 00  |.f..R..5..-@....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 09 1f bf 22  |........... ..."|
+00000030  80 8f c9 fd 67 56 3d 25  fc 8a 86 21 21 73 e2 df  |....gV=%...!!s..|
+00000040  72 fb 55 22 68 e1 b4 fb  16 82 f5 49 13 01 00 00  |r.U"h......I....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 cf 36 08 f7 30 63  |...........6..0c|
-00000090  92 17 af e6 41 e1 80 5f  90 d9 9c 7b c2 04 b7 91  |....A.._...{....|
-000000a0  2f 17 03 03 00 3e f0 04  0e ca ba 73 eb 91 4a e7  |/....>.....s..J.|
-000000b0  29 8f d5 59 71 71 1d 25  cc 1c 11 38 b1 65 ba 47  |)..Yqq.%...8.e.G|
-000000c0  9d 44 f3 25 31 cc c2 37  68 70 d2 ed dc bd a7 1a  |.D.%1..7hp......|
-000000d0  33 93 9c 67 71 b9 87 c7  68 dc 34 f1 71 5e 5b 13  |3..gq...h.4.q^[.|
-000000e0  0e 1f e5 c4 17 03 03 02  6d 8d e6 61 0a 3d 5e 07  |........m..a.=^.|
-000000f0  98 18 e8 bf af e5 e2 35  4c 99 ce 41 bb 0e 28 2f  |.......5L..A..(/|
-00000100  9a 20 90 11 46 cf 08 fd  b2 7f d7 61 02 76 ac 57  |. ..F......a.v.W|
-00000110  a4 12 53 76 9c 80 bd 14  de 86 d9 84 fc ce ec bb  |..Sv............|
-00000120  a6 21 ee 67 28 2f bc b7  1b 19 28 66 cd 73 28 39  |.!.g(/....(f.s(9|
-00000130  9e ae b8 a7 5c 33 c5 72  92 67 20 92 55 3c f3 01  |....\3.r.g .U<..|
-00000140  b5 2f d7 cc 7a 9e 94 b6  29 98 08 0b 73 a0 21 03  |./..z...)...s.!.|
-00000150  d0 a7 c3 b2 39 3c b3 2b  8f 07 c8 aa f2 2a 24 26  |....9<.+.....*$&|
-00000160  f2 3e e0 d5 23 cf 70 54  14 4a 07 bd e1 fa 51 c0  |.>..#.pT.J....Q.|
-00000170  aa 79 0d c2 0c 12 f2 7d  da 4e 5a a2 92 64 94 e8  |.y.....}.NZ..d..|
-00000180  05 aa f8 14 9d 52 f5 c2  13 cd f8 92 cb e1 ce 08  |.....R..........|
-00000190  93 4b 08 74 93 21 70 ad  4d a0 b0 82 c9 dd dc 0d  |.K.t.!p.M.......|
-000001a0  5d 3e e8 fb 0e a1 58 c6  fa 28 90 c1 77 27 7b d5  |]>....X..(..w'{.|
-000001b0  bf 54 24 7b 6e 07 96 da  07 d9 b8 1f e8 e1 c2 67  |.T${n..........g|
-000001c0  71 f5 86 65 ab d8 02 d3  99 eb 43 07 91 fc 4b e7  |q..e......C...K.|
-000001d0  7e 49 c1 64 d6 e9 b7 dc  30 3a f1 2d 0a 05 15 0c  |~I.d....0:.-....|
-000001e0  16 d8 e1 f1 67 da 06 31  21 4b 6a 7f 05 c6 c5 a4  |....g..1!Kj.....|
-000001f0  4b eb 66 95 04 99 d7 47  7e 83 39 e6 78 ee 98 33  |K.f....G~.9.x..3|
-00000200  f9 39 92 17 f8 82 0d 19  45 d2 19 3b 37 39 9d 9e  |.9......E..;79..|
-00000210  6a 32 42 06 cf f5 e0 84  25 44 c7 f8 43 13 ac 0b  |j2B.....%D..C...|
-00000220  bd ac 94 60 c2 fa 5a 22  d8 e9 66 ed 12 1a 3f 07  |...`..Z"..f...?.|
-00000230  76 59 c0 34 a4 c5 27 97  51 cb d0 60 f0 c1 bc 01  |vY.4..'.Q..`....|
-00000240  8b ba e9 7d a2 b8 94 d6  50 6d 6f ed d2 53 52 1b  |...}....Pmo..SR.|
-00000250  b6 d8 f5 2c a3 b2 e0 6b  88 20 a4 6b 28 e3 be 1c  |...,...k. .k(...|
-00000260  a4 95 a6 ee fb 87 f4 27  4d f8 96 aa 88 23 1b 61  |.......'M....#.a|
-00000270  fb 19 80 fc 1f 00 e3 c6  9f 57 9e 8d 35 ae fd 52  |.........W..5..R|
-00000280  1b 75 51 af 99 a8 48 4d  20 04 99 3e 83 78 31 66  |.uQ...HM ..>.x1f|
-00000290  3e 1a 46 52 b6 d2 00 de  bf 0e 92 91 f8 1e 91 85  |>.FR............|
-000002a0  2c 5e 5e f6 74 e2 e9 b6  ab f8 77 ab 25 6f 63 0f  |,^^.t.....w.%oc.|
-000002b0  a1 57 1f 65 26 56 6b 84  09 fe e0 ce d8 f8 01 c3  |.W.e&Vk.........|
-000002c0  15 bc 5d 9a ff a7 25 60  f0 05 b9 66 4c 6a db 19  |..]...%`...fLj..|
-000002d0  2c e0 f7 c5 a3 e5 1d 8c  57 58 d5 45 42 15 73 a3  |,.......WX.EB.s.|
-000002e0  ad 6e f4 33 19 a1 a4 df  0a bf 44 99 26 3f ff 2f  |.n.3......D.&?./|
-000002f0  fe 56 95 4f 44 88 59 d6  f1 d9 e4 e3 35 27 36 5f  |.V.OD.Y.....5'6_|
-00000300  9c 68 ba 71 10 92 22 41  64 15 e2 dd a2 eb ec 4d  |.h.q.."Ad......M|
-00000310  a3 0a 01 9e 97 1d c0 3c  d4 63 a5 bb 27 f0 a5 98  |.......<.c..'...|
-00000320  d6 76 a1 f9 ac 39 f1 e3  94 9b 4f 33 15 a9 dd 38  |.v...9....O3...8|
-00000330  62 2b f7 51 a5 04 15 68  e4 d8 0e 83 d5 34 0d 10  |b+.Q...h.....4..|
-00000340  c8 81 b1 6f 33 56 fa b6  33 ae aa f8 4b ec ab 4f  |...o3V..3...K..O|
-00000350  39 1a ac 6c 95 fa 17 03  03 00 99 52 6c d3 77 91  |9..l.......Rl.w.|
-00000360  c1 6e 8b b4 95 a8 b4 e2  ad 3c 36 90 a3 28 9a 12  |.n.......<6..(..|
-00000370  00 fb e2 f6 8b 35 d1 f6  23 5b 65 1f 5f 99 19 90  |.....5..#[e._...|
-00000380  b7 ad 0c 81 4b 23 0e eb  66 16 08 23 52 9a a4 ac  |....K#..f..#R...|
-00000390  f0 ab 06 ba 7e 43 52 2d  04 93 6c 44 ed c8 bf 22  |....~CR-..lD..."|
-000003a0  85 46 08 e8 f9 f4 86 71  c6 a6 d4 2d 86 ad 1e ef  |.F.....q...-....|
-000003b0  45 19 65 c5 a6 28 cd 02  b3 f3 bb 39 f4 e1 3c a8  |E.e..(.....9..<.|
-000003c0  85 7a b5 e8 2f 07 75 4f  5c ce 7c be 9f 0f d2 95  |.z../.uO\.|.....|
-000003d0  a1 ca 35 4c ee 45 b7 76  c6 18 cd f3 fe 5b e8 b8  |..5L.E.v.....[..|
-000003e0  f8 67 40 88 3b 68 80 13  20 9c b7 ef ce a3 fd e9  |.g@.;h.. .......|
-000003f0  96 b5 ba 7b 17 03 03 00  35 88 e1 29 ed 53 da e1  |...{....5..).S..|
-00000400  15 c9 86 41 14 77 90 17  a6 df 40 4f 75 47 1d 67  |...A.w....@OuG.g|
-00000410  f0 4b 8c b8 d6 d7 23 0d  0c e4 22 de 7b d1 cc f5  |.K....#...".{...|
-00000420  a1 81 9c d5 8e 7a 37 e4  3d c9 7d c4 0a e4        |.....z7.=.}...|
+00000080  03 03 00 01 01 17 03 03  00 17 b1 ed b3 08 b6 d5  |................|
+00000090  23 a6 3e d5 62 8e 9c 5a  4c aa 53 03 dd 2b 4b 3f  |#.>.b..ZL.S..+K?|
+000000a0  5a 17 03 03 00 3e 27 1c  9d cb b2 1f 1e dd 1c e6  |Z....>'.........|
+000000b0  7a 5d 47 f0 f2 01 48 d3  2b b5 16 5c 41 94 3d ff  |z]G...H.+..\A.=.|
+000000c0  72 5b aa c3 8b ee 58 e3  ed 99 08 85 52 40 b2 47  |r[....X.....R@.G|
+000000d0  65 7b df 40 05 71 64 16  49 c5 79 c3 cc 0b 72 bc  |e{.@.qd.I.y...r.|
+000000e0  b4 f9 78 fd 17 03 03 02  6d 4a 7c 95 64 3f 45 00  |..x.....mJ|.d?E.|
+000000f0  36 94 f4 4f 07 3b 60 cf  e0 c4 8c 83 34 7b bf 93  |6..O.;`.....4{..|
+00000100  1c 22 9a 86 30 a2 d2 e9  ad d2 27 bc af 42 82 2f  |."..0.....'..B./|
+00000110  38 65 30 db ae 64 d4 22  ee 68 db 37 d6 64 7d 28  |8e0..d.".h.7.d}(|
+00000120  b4 1c 98 6d 05 73 e7 f5  9b c9 24 d9 c5 32 c0 4f  |...m.s....$..2.O|
+00000130  68 67 13 a0 d8 28 7d 21  e8 75 51 2a a7 15 31 82  |hg...(}!.uQ*..1.|
+00000140  b6 f1 40 44 6c cb 0e 14  1c e1 c5 ab 1a b5 ff 82  |..@Dl...........|
+00000150  7e dd 4b 02 5a ad c5 63  cf 76 49 93 b2 4b ad 66  |~.K.Z..c.vI..K.f|
+00000160  7c f8 43 c6 f2 c9 25 71  fe 62 5e 28 69 b7 8d 28  ||.C...%q.b^(i..(|
+00000170  df 48 d0 12 f0 0d 18 eb  ff 5b f6 1b 22 ef b7 b3  |.H.......[.."...|
+00000180  e0 6e f6 3d b9 2c d3 df  7e 47 50 e9 53 6e 69 16  |.n.=.,..~GP.Sni.|
+00000190  ea 50 e8 70 9e bc d8 ea  29 77 82 63 79 e7 c3 30  |.P.p....)w.cy..0|
+000001a0  75 6d 41 ea ac 88 aa 28  e0 2f e4 c2 ba 59 4b 20  |umA....(./...YK |
+000001b0  59 1e 7a 67 15 b9 b6 b2  a4 71 da 09 80 bd 50 ad  |Y.zg.....q....P.|
+000001c0  57 1d c9 a0 6d d6 88 c4  e7 b8 e9 27 c7 af 61 03  |W...m......'..a.|
+000001d0  b2 ca 1a 2f ae 67 f9 fe  b6 a9 a3 2e 84 60 42 fc  |.../.g.......`B.|
+000001e0  ae f5 ea 55 fa 77 66 93  32 7f fc 99 a1 5d 8c e2  |...U.wf.2....]..|
+000001f0  9b 05 5b 2e 46 39 57 d8  29 06 73 ec b2 3b aa df  |..[.F9W.).s..;..|
+00000200  ac 51 0b 14 af 16 22 73  7e a5 f0 d7 28 30 a3 a4  |.Q...."s~...(0..|
+00000210  7a b5 e0 01 e4 4b 76 7d  23 6f c6 91 0b bb 39 56  |z....Kv}#o....9V|
+00000220  f3 c6 79 bd 37 58 8b a2  94 35 44 ee d7 d3 dd 4a  |..y.7X...5D....J|
+00000230  0a ed 7b c0 77 13 c5 ba  46 c3 ba c3 3a 87 e8 3f  |..{.w...F...:..?|
+00000240  ce 55 c5 51 39 9b e1 db  fb 3c a6 7d 24 9b b5 34  |.U.Q9....<.}$..4|
+00000250  d3 54 44 7c 01 70 49 c4  1e 28 b5 12 46 17 33 96  |.TD|.pI..(..F.3.|
+00000260  7e 95 b2 02 2a 10 8d 87  5f 36 d3 c9 05 44 81 00  |~...*..._6...D..|
+00000270  f4 55 fa 12 81 cf 6e d5  3a 2f 2a 9b 28 9c 5a 8b  |.U....n.:/*.(.Z.|
+00000280  1a 10 03 53 c3 7b 67 5b  54 ae f8 01 42 24 f5 64  |...S.{g[T...B$.d|
+00000290  e9 c1 be 0f 37 0e 06 cc  b4 7e 79 14 4e 75 a7 b5  |....7....~y.Nu..|
+000002a0  c1 4d eb c8 42 3a 46 bb  b4 a4 87 a0 de 24 d7 58  |.M..B:F......$.X|
+000002b0  00 4d ae f0 f6 4e 44 aa  87 f5 54 37 00 be 1a ab  |.M...ND...T7....|
+000002c0  24 c6 b7 8e 9c 8d 86 64  d4 27 f0 74 88 88 aa df  |$......d.'.t....|
+000002d0  65 d8 62 b4 38 7c 64 7e  47 9c 62 ac d3 d9 2c 20  |e.b.8|d~G.b..., |
+000002e0  5d 3b f6 cd be 58 f9 3e  fc 79 bb 0d c5 af ca d7  |];...X.>.y......|
+000002f0  a8 ea b4 fc e2 3b 2e 91  5c 8c a1 b6 f8 7e d1 05  |.....;..\....~..|
+00000300  da ad 36 17 fc 7d 31 8f  9c b6 9e 17 cf df 50 56  |..6..}1.......PV|
+00000310  3d 5e 12 df a5 88 1a 42  5e 06 5d 98 bb d3 50 1d  |=^.....B^.]...P.|
+00000320  d3 2a fa 7d ed 75 cd 31  74 88 2c 0c 29 5a af ff  |.*.}.u.1t.,.)Z..|
+00000330  72 d2 f4 d4 d7 6d eb 61  50 4c 1a 6d 60 a1 5d d4  |r....m.aPL.m`.].|
+00000340  ee 1e 0c 10 e0 d0 e8 77  e5 f4 b2 72 65 9c f5 97  |.......w...re...|
+00000350  1d ec 01 08 a6 0a 17 03  03 00 99 a0 a0 65 1a bc  |.............e..|
+00000360  a8 c7 b5 28 b7 02 b3 c3  59 fb 87 b8 58 54 ff aa  |...(....Y...XT..|
+00000370  bf 5d 88 e1 8b 76 a1 2e  65 2b f2 3f 16 a0 38 44  |.]...v..e+.?..8D|
+00000380  72 67 5a ce 87 56 54 de  cd 3d 00 97 f9 8b 93 68  |rgZ..VT..=.....h|
+00000390  78 1e 8a 8f 25 41 49 0f  0f f6 62 de d0 a8 e1 22  |x...%AI...b...."|
+000003a0  ee 1f ce 48 0e b6 40 94  06 07 00 0c d0 89 6d 9e  |...H..@.......m.|
+000003b0  09 aa d6 87 c7 df 21 e2  74 79 3e 07 87 da 0c 03  |......!.ty>.....|
+000003c0  5a 4f 52 1a 52 27 4f 87  45 af b5 81 52 9c 0f 3b  |ZOR.R'O.E...R..;|
+000003d0  1e 04 0e 29 e8 74 7b 7d  d3 a6 3d 35 4d cd 54 50  |...).t{}..=5M.TP|
+000003e0  25 a4 43 48 d1 2b d9 f0  d4 12 60 84 ac 04 d6 aa  |%.CH.+....`.....|
+000003f0  43 0a 51 2d 17 03 03 00  35 2a 98 29 36 07 d1 45  |C.Q-....5*.)6..E|
+00000400  76 2c 1f 45 05 3b 18 ab  5d 1e e8 14 ef e7 8e 00  |v,.E.;..].......|
+00000410  94 e2 2d eb b6 64 bb 1a  98 d4 b9 d4 81 4a 48 ea  |..-..d.......JH.|
+00000420  31 a3 42 78 b2 c4 5b 72  26 73 ee 0e 98 47        |1.Bx..[r&s...G|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 01 50 2a 3f 0f 95 a8  |..........P*?...|
-00000010  68 39 33 6d 23 60 b1 70  41 82 cc a9 37 ca b7 f9  |h93m#`.pA...7...|
-00000020  67 35 ce 2f 83 72 35 a9  2a 29 b9 85 68 e3 00 5e  |g5./.r5.*)..h..^|
-00000030  1f c4 e6 dc df 72 89 ae  70 b9 1f e3 14 e3 b2 da  |.....r..p.......|
-00000040  d8 37 a6 2d 2d a2 8b 84  f3 a6 e2 d3 8f 18 a5 56  |.7.--..........V|
-00000050  78 53 ba bf 9f 90 7e fe  9c 1d ce d7 e5 6c 93 9d  |xS....~......l..|
-00000060  b0 8c 81 49 7c 87 62 9c  55 e2 5b 4f af cb f8 55  |...I|.b.U.[O...U|
-00000070  d8 74 61 53 9a 36 e6 61  56 ac 0a 5d 01 fa 88 1b  |.taS.6.aV..]....|
-00000080  1c 7f 21 06 e3 54 f7 7a  ea 74 e7 33 9e 61 81 08  |..!..T.z.t.3.a..|
-00000090  07 65 68 cd fe 56 83 2c  20 23 f9 88 3a 7d c9 8d  |.eh..V., #..:}..|
-000000a0  54 dd 76 95 88 2a 10 ba  f3 9b 80 be 54 6f 67 ca  |T.v..*......Tog.|
-000000b0  59 41 bb 9c 20 27 29 73  ae 76 92 b2 1e db 95 4a  |YA.. ')s.v.....J|
-000000c0  12 16 87 f8 c9 5c a7 2a  ac 40 4b 90 de 0b bf 51  |.....\.*.@K....Q|
-000000d0  9b 09 b8 7d db 7f 7c 68  d9 3a 1a 86 e8 27 c2 1a  |...}..|h.:...'..|
-000000e0  20 74 8c 0f a0 5e eb 73  fd bf 1c b0 6b 3f 79 57  | t...^.s....k?yW|
-000000f0  8f 81 c4 1e 4d 97 0a f3  8b bb 37 92 43 1a 1b 65  |....M.....7.C..e|
-00000100  12 dd c3 c1 ec 9f b8 16  65 7a d9 41 60 b5 76 4e  |........ez.A`.vN|
-00000110  84 f4 6e 7b 2c 1e d6 73  29 1c 83 f0 6c df bd c4  |..n{,..s)...l...|
-00000120  14 6d ff 64 54 95 f5 57  a1 e1 8b a7 fb f2 86 c5  |.m.dT..W........|
-00000130  f7 98 4c 6c a1 e6 37 8d  e0 8f 82 e2 68 64 ec 86  |..Ll..7.....hd..|
-00000140  16 b0 e2 da f9 c2 37 74  77 c1 c5 64 c6 95 6d a5  |......7tw..d..m.|
-00000150  d8 cd 28 f3 ad f3 c8 36  1a 7e 6b 17 03 03 00 59  |..(....6.~k....Y|
-00000160  6b 8e 4a f5 e1 21 9f 87  d3 ba 2b 1b 54 91 95 4e  |k.J..!....+.T..N|
-00000170  9e af 4c fd 32 4b cc 24  f7 08 8d ac 77 96 87 7f  |..L.2K.$....w...|
-00000180  c9 97 95 09 99 61 9f bb  a7 5f 6f c2 e7 7d 7f 5c  |.....a..._o..}.\|
-00000190  3e 70 d9 df f1 eb 21 94  de 01 73 45 b3 26 5a 71  |>p....!...sE.&Zq|
-000001a0  2e 01 ea a3 68 f1 3c 6e  83 c9 6d 61 7b 10 fd ed  |....h.<n..ma{...|
-000001b0  b3 ee d6 52 10 bc b5 fd  37 17 03 03 00 35 eb ed  |...R....7....5..|
-000001c0  48 3c db c8 bd 15 79 85  04 2b 61 d5 16 98 8a a6  |H<....y..+a.....|
-000001d0  63 bf 63 a0 73 eb a9 77  f0 08 0b 93 8e 0c e5 f2  |c.c.s..w........|
-000001e0  a0 fa a4 0c 11 dc b6 ab  ef 1f df 9b 57 df ab 40  |............W..@|
-000001f0  13 b6 27                                          |..'|
+00000000  14 03 03 00 01 01 17 03  03 01 50 b6 3d c2 a4 ba  |..........P.=...|
+00000010  60 55 e6 40 0c 30 6b 5d  cc 4c 09 98 96 65 bd 9b  |`U.@.0k].L...e..|
+00000020  f0 e3 f2 6b 34 11 e1 79  bf cf 95 15 77 29 ef 63  |...k4..y....w).c|
+00000030  0f ce a4 7a aa 14 80 34  e3 09 0b b9 87 f7 e3 7d  |...z...4.......}|
+00000040  26 a4 83 ad e4 a1 ef 38  b7 aa 8c ea 9a 96 53 b1  |&......8......S.|
+00000050  4a 78 b7 eb 16 c0 89 10  ba af 9b d5 e7 ee f2 bd  |Jx..............|
+00000060  86 f2 80 dc 47 7e 84 c5  3c 22 40 85 0c 62 71 61  |....G~..<"@..bqa|
+00000070  e2 c7 f6 80 9a 40 7d 81  71 00 76 1d 72 39 7b ad  |.....@}.q.v.r9{.|
+00000080  4b 2a 65 5f a6 7b e2 a6  45 de 5f 60 9d f7 d7 cb  |K*e_.{..E._`....|
+00000090  7f 1f ba 2c cd fa 33 00  c7 de b3 e1 f9 5b 9b 3f  |...,..3......[.?|
+000000a0  eb 59 24 c0 f6 fb f7 fa  11 f0 ea 99 b3 cc 93 8c  |.Y$.............|
+000000b0  9a 43 6b b2 f4 6f cd 87  25 a4 c6 a8 77 4f 05 04  |.Ck..o..%...wO..|
+000000c0  78 a4 0d ef b4 dd b3 7c  6b 00 3e d2 1d b1 0a fa  |x......|k.>.....|
+000000d0  ab cf a5 8d 95 92 de eb  78 ce 3c 29 da 01 d6 4f  |........x.<)...O|
+000000e0  aa d4 a6 20 8f 87 2b 8c  11 4e 10 85 d4 0c 9e 23  |... ..+..N.....#|
+000000f0  09 f1 06 1d 31 1e d1 b5  3f b3 cf 12 2a c1 f8 30  |....1...?...*..0|
+00000100  59 97 06 3c 7c 09 17 ac  f5 6a ce fc a4 00 dc dd  |Y..<|....j......|
+00000110  ab 7c 9a b3 97 c8 c3 ed  be d2 a5 25 bb e7 cc 6b  |.|.........%...k|
+00000120  d9 29 9e 67 77 2b ec f3  b4 94 e9 bf fd 76 ff 57  |.).gw+.......v.W|
+00000130  c4 da 8f 1e d1 de 28 32  e4 22 0c 51 52 b2 9c 75  |......(2.".QR..u|
+00000140  7c 26 83 1e a2 39 b8 76  eb 0e 93 c3 35 be f0 3a  ||&...9.v....5..:|
+00000150  13 ae 99 da 73 3c ee 78  a9 b8 72 17 03 03 00 59  |....s<.x..r....Y|
+00000160  9a 16 31 a8 6a ac b6 a0  a3 b2 d4 6a 17 cd 43 e4  |..1.j......j..C.|
+00000170  4d e3 3e 33 fb 30 ca 89  8c 1d 82 ce 41 44 ec 08  |M.>3.0......AD..|
+00000180  bc ad 97 27 e8 b2 83 05  f5 0f a0 47 79 f3 f5 9c  |...'.......Gy...|
+00000190  de 4d 55 27 a3 12 91 29  8b ea a3 35 ce 7d dd 88  |.MU'...)...5.}..|
+000001a0  fa 81 59 a2 fb 43 0a f3  b4 f8 9c 95 c0 e3 58 86  |..Y..C........X.|
+000001b0  fa d6 5f 02 ee 90 ac ab  b1 17 03 03 00 35 97 c6  |.._..........5..|
+000001c0  ff 66 1b 4f 7f c4 bb a6  99 45 df f0 e9 13 48 79  |.f.O.....E....Hy|
+000001d0  57 00 cc 9f 4f e1 dc 6a  c4 b5 77 a6 09 3e 48 34  |W...O..j..w..>H4|
+000001e0  6a 8c b3 32 a1 71 60 fd  9a ee 61 0a fc f4 94 18  |j..2.q`...a.....|
+000001f0  57 c6 19                                          |W..|
 >>> Flow 4 (server to client)
-00000000  17 03 03 01 bd 8d 22 4b  6c e9 53 d4 e8 d7 9d 9f  |......"Kl.S.....|
-00000010  95 ef 5e 8e 6f d3 c8 f0  b6 76 46 03 b7 4f df 65  |..^.o....vF..O.e|
-00000020  52 e1 93 d2 3f 38 a1 c8  bc 70 60 88 01 ff 15 4a  |R...?8...p`....J|
-00000030  51 2c ea 33 ee 72 e6 d1  7c 52 d2 c9 04 3f 39 2f  |Q,.3.r..|R...?9/|
-00000040  f0 d8 f8 30 76 dd e5 22  10 0c 79 51 8c 48 da dd  |...0v.."..yQ.H..|
-00000050  c4 31 8f 63 ee 9f 78 e2  a7 a9 90 ba d9 00 3d b8  |.1.c..x.......=.|
-00000060  1f f1 0a 17 30 e7 f2 fa  48 7a e3 7c ac b0 ae 13  |....0...Hz.|....|
-00000070  55 1b ba fe 09 e9 45 1f  1b df 68 0c 9e 74 92 41  |U.....E...h..t.A|
-00000080  74 f4 a3 e3 75 88 8b 5c  b4 28 51 c2 c9 59 fe cf  |t...u..\.(Q..Y..|
-00000090  1a fe f0 85 23 05 1c c6  78 89 29 16 50 40 e1 f5  |....#...x.).P@..|
-000000a0  cf 98 e1 7e a8 a9 ab b9  d5 82 80 bb df 50 25 5d  |...~.........P%]|
-000000b0  a1 4c 17 d9 73 de 84 f4  65 7a b9 00 fe 0c aa b6  |.L..s...ez......|
-000000c0  22 53 fb 1f 5e 88 49 18  cc 32 cc ac bd 94 7d c7  |"S..^.I..2....}.|
-000000d0  41 19 b2 71 7c 14 59 4e  9e 06 fb f2 46 f2 4b b3  |A..q|.YN....F.K.|
-000000e0  7a d2 e4 aa e1 fc b8 c3  81 c7 ac a3 41 19 68 30  |z...........A.h0|
-000000f0  16 94 5f c8 5a 26 c4 6f  6a b3 94 a7 03 47 e5 50  |.._.Z&.oj....G.P|
-00000100  dd 7b ad 3f 09 1c 3c ac  68 f0 8e 46 cd af 60 2e  |.{.?..<.h..F..`.|
-00000110  92 80 9d d0 ce b5 13 83  56 b2 b2 07 fc 1f 04 9e  |........V.......|
-00000120  52 ad 00 39 0d ec f5 49  58 c0 4c 47 f7 9d a7 01  |R..9...IX.LG....|
-00000130  c9 56 ff c3 f0 fd 9c 4d  e1 c7 e6 41 40 67 cf 85  |.V.....M...A@g..|
-00000140  aa fe 17 d9 42 f9 5e 80  45 fd ce fc d8 7e ac c4  |....B.^.E....~..|
-00000150  e1 5b 0b 78 86 78 5b 6b  97 ea 95 46 13 27 fd c6  |.[.x.x[k...F.'..|
-00000160  f1 5b 14 a8 20 4e 36 60  9e 2a 41 be 2d 71 66 28  |.[.. N6`.*A.-qf(|
-00000170  f5 8f 33 f2 34 57 97 50  5a 95 6d d1 b6 33 f0 2c  |..3.4W.PZ.m..3.,|
-00000180  bf 19 65 7a 08 46 fc ba  3e f1 a3 ba 92 9a 31 7e  |..ez.F..>.....1~|
-00000190  be 70 99 a6 2c 0e 93 e7  75 5e 37 1b 45 f8 6d 76  |.p..,...u^7.E.mv|
-000001a0  ee 7b 62 89 c7 89 5b cc  38 f0 67 bb b2 b0 d6 a4  |.{b...[.8.g.....|
-000001b0  bb b3 9d 4d 4b 2a 3b 5f  9b d8 51 c4 ec ef 6a 75  |...MK*;_..Q...ju|
-000001c0  8f 30 17 03 03 00 1e 5f  c9 8f 51 dd fe 66 c0 e5  |.0....._..Q..f..|
-000001d0  a9 6a b0 94 cf ae 69 dd  44 f1 03 ff 37 ba 18 c2  |.j....i.D...7...|
-000001e0  3d 08 54 4f 38 17 03 03  00 13 11 a6 8a 9f 34 a6  |=.TO8.........4.|
-000001f0  1b bd 28 5b 1d 7f 24 74  65 b5 5b 16 d4           |..([..$te.[..|
+00000000  17 03 03 01 be f9 61 23  3a 18 47 1e bd 6b 35 3c  |......a#:.G..k5<|
+00000010  81 14 80 f4 7c 37 6b ed  31 57 ee e5 11 85 1d 0f  |....|7k.1W......|
+00000020  22 ee 33 f3 c6 94 22 dc  de cd a0 97 fb de 0f 32  |".3..."........2|
+00000030  be 73 3e db 6b b6 26 b3  3f e5 27 35 e2 37 57 56  |.s>.k.&.?.'5.7WV|
+00000040  81 9a 6e 7a 36 18 20 f4  8e 8f 03 cd 8f d8 db b3  |..nz6. .........|
+00000050  ea 15 da 67 74 64 94 21  77 75 7f e7 f6 49 99 05  |...gtd.!wu...I..|
+00000060  23 d9 24 5b b9 06 1b fe  76 70 7f f7 cf 35 13 e2  |#.$[....vp...5..|
+00000070  fb 61 ca 2b 52 fb e6 fc  ea ec ed b3 35 02 38 7d  |.a.+R.......5.8}|
+00000080  50 b9 e4 3e b4 21 d3 b0  20 03 ee e3 76 df 42 5b  |P..>.!.. ...v.B[|
+00000090  27 0e 5b 89 82 cb dd e2  68 a4 41 5c a8 d9 4d 0e  |'.[.....h.A\..M.|
+000000a0  87 8a 2e 77 80 ca 24 dc  67 0f 06 83 6e 55 fc ef  |...w..$.g...nU..|
+000000b0  96 0c 19 3a cd 90 cc 45  07 3e c1 cf 84 8a be 42  |...:...E.>.....B|
+000000c0  c6 47 2a 54 c6 89 bf 50  ee 1a 48 18 b5 0f d7 6b  |.G*T...P..H....k|
+000000d0  08 94 3c b7 c0 22 d4 4d  eb 54 50 ec 02 69 12 98  |..<..".M.TP..i..|
+000000e0  67 39 46 6c d3 f6 57 73  ed f7 f2 43 8a e0 b3 ed  |g9Fl..Ws...C....|
+000000f0  e3 49 41 f1 38 ce ed 21  d5 22 7c db a1 cc 23 59  |.IA.8..!."|...#Y|
+00000100  38 ef 7d ec 23 95 12 90  c4 bc 29 09 ac c4 92 89  |8.}.#.....).....|
+00000110  61 eb 08 65 ab 2f 70 1e  1b 1d 97 7f 80 79 85 69  |a..e./p......y.i|
+00000120  c5 93 e6 d5 ff 91 f1 29  a8 9a c7 62 72 ee f6 4b  |.......)...br..K|
+00000130  7c d8 7d d5 f8 30 db f4  1d a8 1d d7 68 52 11 27  ||.}..0......hR.'|
+00000140  27 cb 62 af 75 cb 73 7b  8e ee 69 b6 42 bd 2d ea  |'.b.u.s{..i.B.-.|
+00000150  f3 74 e7 2e 5b 0c dd 1a  d1 af e4 3c c9 7b 55 a3  |.t..[......<.{U.|
+00000160  dd d2 11 02 cb 98 b1 46  67 f1 76 96 1e 4d 0f ac  |.......Fg.v..M..|
+00000170  29 07 f5 3c a6 0e d3 97  1a f5 7e 3b 60 bf 8c 68  |)..<......~;`..h|
+00000180  99 a0 ae 48 56 b3 87 57  c7 d3 77 3b f8 39 55 47  |...HV..W..w;.9UG|
+00000190  e6 ac f1 b2 ff a4 a1 37  38 73 6e 9a 96 e6 17 e2  |.......78sn.....|
+000001a0  aa f3 b7 d5 cc 76 a6 74  2f 87 04 e4 f5 e2 73 4c  |.....v.t/.....sL|
+000001b0  a7 ed d0 9b 43 f9 57 b0  59 ac e9 fd 2b ff 3f ff  |....C.W.Y...+.?.|
+000001c0  0b 05 6c 17 03 03 00 1e  4a 76 aa 8c bf 6e 14 7a  |..l.....Jv...n.z|
+000001d0  cc 6b f8 ce 01 ee 5f 0a  7a f0 4d 59 ba a8 3f 7a  |.k...._.z.MY..?z|
+000001e0  66 62 b9 4c 7a 90 17 03  03 00 13 ac 76 f9 79 f1  |fb.Lz.......v.y.|
+000001f0  4b d8 92 39 f7 24 83 03  c6 0a 57 0c 95 4a        |K..9.$....W..J|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndGiven b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndGiven
index 6c1e97fc80..b01d5301d3 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndGiven
+++ b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndGiven
@@ -1,177 +1,177 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 18 79 19 6c 5f  |............y.l_|
-00000010  8e 7e de 6a cc e3 5e 4e  a1 d6 21 a5 63 a2 1e 45  |.~.j..^N..!.c..E|
-00000020  71 00 38 34 b5 3b f9 0a  8e bf 5b 20 b0 73 93 ae  |q.84.;....[ .s..|
-00000030  9d 29 8f 6b 18 78 3b 58  25 a3 8f f3 95 d2 a4 eb  |.).k.x;X%.......|
-00000040  b5 49 b0 78 ea 2c 55 c2  e8 3f b3 e4 00 04 13 01  |.I.x.,U..?......|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 4f de d7 58 dd  |...........O..X.|
+00000010  16 7a 68 25 12 f9 5b 58  6c c4 d9 1a 1d 09 b0 0e  |.zh%..[Xl.......|
+00000020  8f 20 10 5b 75 aa a6 67  4f 35 9e 20 02 03 10 7f  |. .[u..gO5. ....|
+00000030  60 84 8f 68 a4 ce cb c2  ef 77 3d 7f 86 2e e7 33  |`..h.....w=....3|
+00000040  3d 36 63 8d bc 68 88 f1  2f 68 62 f7 00 04 13 01  |=6c..h../hb.....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 55  |-.....3.&.$... U|
-000000b0  e9 8b 12 7c 69 c5 3e 44  c0 28 29 21 73 a8 ee ea  |...|i.>D.()!s...|
-000000c0  e9 ea e3 04 f1 cf 5f b2  5a ca ad 4b 90 a8 27     |......_.Z..K..'|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 9e  |-.....3.&.$... .|
+000000b0  09 b9 66 03 aa 02 2e 71  e4 a3 31 5b a9 f9 a8 4e  |..f....q..1[...N|
+000000c0  3a a8 36 77 ca 74 a1 f6  41 2c a3 b7 55 00 27     |:.6w.t..A,..U.'|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 b0 73 93 ae  |........... .s..|
-00000030  9d 29 8f 6b 18 78 3b 58  25 a3 8f f3 95 d2 a4 eb  |.).k.x;X%.......|
-00000040  b5 49 b0 78 ea 2c 55 c2  e8 3f b3 e4 13 01 00 00  |.I.x.,U..?......|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 02 03 10 7f  |........... ....|
+00000030  60 84 8f 68 a4 ce cb c2  ef 77 3d 7f 86 2e e7 33  |`..h.....w=....3|
+00000040  3d 36 63 8d bc 68 88 f1  2f 68 62 f7 13 01 00 00  |=6c..h../hb.....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 d0 3a e4 c9 5f fd  |...........:.._.|
-00000090  77 3d 9d 92 1f 1f 46 f8  55 ab be 60 3c 9c 10 5c  |w=....F.U..`<..\|
-000000a0  d4 17 03 03 00 3e 5e 7f  10 62 59 38 3d 89 e8 47  |.....>^..bY8=..G|
-000000b0  44 5c 30 1d 3b c4 f2 ef  8d 14 cf 10 f4 10 9f 3e  |D\0.;..........>|
-000000c0  db 88 40 38 f4 c9 96 61  db a6 7f ce 13 33 47 bc  |..@8...a.....3G.|
-000000d0  70 dc 81 f6 bb fe a5 06  a0 50 f0 5c 14 6a a3 e4  |p........P.\.j..|
-000000e0  d0 86 1a 03 17 03 03 02  6d eb f2 cf ab b0 43 23  |........m.....C#|
-000000f0  d8 a6 d1 51 37 1e 48 03  e2 15 4e a0 e8 a1 55 47  |...Q7.H...N...UG|
-00000100  d4 74 b6 da 43 90 c5 04  cd 13 8d d1 2c 88 e9 ee  |.t..C.......,...|
-00000110  7c a6 80 b7 f9 da ea 84  da cf b3 6c 3c 4c e3 d3  ||..........l<L..|
-00000120  cd 08 5a 3b db cb 79 57  25 1c 8a c7 21 5f 06 0f  |..Z;..yW%...!_..|
-00000130  a4 9f 1e 44 dd af 57 4d  10 02 e1 6f 39 06 2b 5c  |...D..WM...o9.+\|
-00000140  56 0b cd 2f 82 29 81 a6  90 b8 62 eb cb ac ad 6a  |V../.)....b....j|
-00000150  56 16 74 03 5d 58 4d a9  c5 02 ac d2 18 b4 91 0c  |V.t.]XM.........|
-00000160  f8 2a d6 25 7d 05 55 eb  c7 3a 3d fa 01 bf 17 f0  |.*.%}.U..:=.....|
-00000170  a9 b5 fe 8a 5f 6b 20 9a  7a 6f 67 69 a0 a2 66 70  |...._k .zogi..fp|
-00000180  61 78 7b f9 bf c9 0c da  bf 96 d7 f0 49 e9 fd c7  |ax{.........I...|
-00000190  28 56 a5 cb 11 7d 36 23  ad 6b 63 68 e2 9e 80 a7  |(V...}6#.kch....|
-000001a0  ea f7 60 0f 10 0c df b2  36 7b 8b 09 63 54 d9 bf  |..`.....6{..cT..|
-000001b0  d6 69 d7 74 6d 49 0a bc  57 44 34 ee 38 98 d3 14  |.i.tmI..WD4.8...|
-000001c0  79 9d 5c a2 c2 43 08 b6  76 33 48 ca 51 fe 40 66  |y.\..C..v3H.Q.@f|
-000001d0  50 fd 9f 5d 27 fc 8a 95  e2 80 8c 44 d8 ae e1 e4  |P..]'......D....|
-000001e0  5b 67 d0 3b d7 e3 d2 3d  1d 8c 0d 83 df 6f 7f 56  |[g.;...=.....o.V|
-000001f0  aa fe ab ab 8f 57 8d fd  6f 63 7c 9a 33 86 b9 91  |.....W..oc|.3...|
-00000200  fe 45 e2 dd c2 f7 32 81  d8 d6 3d 28 3f 6a 7f a3  |.E....2...=(?j..|
-00000210  76 df d5 c5 fb 75 7a 63  5e 67 92 d3 5d a9 84 59  |v....uzc^g..]..Y|
-00000220  57 4b ec e8 09 39 e3 a5  d3 f1 31 e0 3f 30 9f 27  |WK...9....1.?0.'|
-00000230  59 e8 40 cb 96 ec 7e ee  e2 90 d8 63 11 19 1f e2  |Y.@...~....c....|
-00000240  b8 87 9d 18 7f db ae 08  d8 66 c4 64 8a 1f 4c 93  |.........f.d..L.|
-00000250  ae c0 99 1a 2e 0a 04 45  b5 21 49 89 56 08 a0 c4  |.......E.!I.V...|
-00000260  5f c5 13 c5 4e 14 6f bb  64 73 20 18 ac 9f b7 ed  |_...N.o.ds .....|
-00000270  cf d1 c4 a5 07 4a 0c b3  89 c9 46 3b 35 68 15 01  |.....J....F;5h..|
-00000280  16 a3 61 08 26 81 31 65  a8 6a 61 d4 48 23 f8 1c  |..a.&.1e.ja.H#..|
-00000290  2f 0d 85 d5 24 9d 98 10  62 45 b5 d6 df 17 dc 04  |/...$...bE......|
-000002a0  59 88 ee c2 4f 5b f4 ab  3d c7 f7 1a 60 57 15 8b  |Y...O[..=...`W..|
-000002b0  63 0a b2 d2 d3 b4 82 79  72 dc 5e 05 e4 4d f8 c6  |c......yr.^..M..|
-000002c0  db 25 05 0a cd 0c dd 5d  30 b1 90 fd 78 f2 6d ca  |.%.....]0...x.m.|
-000002d0  9b 58 a7 dd fc a9 ac 38  46 77 cc df 1b c9 29 66  |.X.....8Fw....)f|
-000002e0  d6 54 f6 c0 53 96 71 a1  8e 83 d3 36 c5 6c 08 63  |.T..S.q....6.l.c|
-000002f0  32 ef b2 cb 9a 40 9d ec  7f d3 8a 48 e5 d1 20 5e  |2....@.....H.. ^|
-00000300  98 8e 78 d7 fa ea a5 f7  cc 7f 1d c7 67 03 f8 55  |..x.........g..U|
-00000310  47 9c 63 73 ee b4 3a 0b  9d 72 8e eb 26 11 59 dd  |G.cs..:..r..&.Y.|
-00000320  81 a0 68 c6 81 0e 91 b9  cd 30 2c 16 e5 6d 94 13  |..h......0,..m..|
-00000330  11 86 97 db d6 76 27 a8  d2 d1 2e b1 33 7e d4 bc  |.....v'.....3~..|
-00000340  fb b1 5e a5 68 b0 ab b2  e4 2b 1b ed 66 b9 85 45  |..^.h....+..f..E|
-00000350  8e 49 98 ac 27 27 17 03  03 00 99 66 0a 35 88 0e  |.I..''.....f.5..|
-00000360  1c 1f 80 4e 26 3a 37 ae  e5 f4 73 06 6b e5 c0 bc  |...N&:7...s.k...|
-00000370  96 9c c0 cd 31 97 d1 db  d0 f5 f5 6e 7e 15 18 37  |....1......n~..7|
-00000380  e7 8d 4d d8 bc 2e 8b d9  96 7e 8a d0 63 33 99 87  |..M......~..c3..|
-00000390  be 33 e2 78 8f 7e 7d e2  9f 79 d4 07 45 bb 58 24  |.3.x.~}..y..E.X$|
-000003a0  2b f4 ae d6 0c 8e bf 69  67 14 f4 b1 a2 4f 12 68  |+......ig....O.h|
-000003b0  f7 95 9c 7f b4 c2 57 87  a8 a7 38 1a c9 fa 17 21  |......W...8....!|
-000003c0  39 90 eb 7f 55 e6 a9 c0  1c d9 cf 93 08 e6 8d 0a  |9...U...........|
-000003d0  90 69 d6 d0 d3 1d 62 6b  74 55 e7 c4 7f 62 26 10  |.i....bktU...b&.|
-000003e0  18 34 34 fe e4 6c a2 16  c0 1b 11 67 6b 7e 7d a2  |.44..l.....gk~}.|
-000003f0  b1 fa cf b1 17 03 03 00  35 92 89 4a be 5d a4 ef  |........5..J.]..|
-00000400  7f b9 4d ad 95 bb 21 a3  25 03 62 65 08 ba d0 f0  |..M...!.%.be....|
-00000410  49 a8 36 2c a6 c7 0a 2a  51 b2 90 09 ef 93 f7 15  |I.6,...*Q.......|
-00000420  c5 70 e1 31 71 10 69 13  02 de e3 a4 ac 21        |.p.1q.i......!|
+00000080  03 03 00 01 01 17 03 03  00 17 f8 88 ec 38 ea 22  |.............8."|
+00000090  23 5f e5 c9 a5 7c 19 12  7a 57 65 3f 41 4d d5 f7  |#_...|..zWe?AM..|
+000000a0  87 17 03 03 00 3e 50 76  ed c0 b5 0d f0 f0 01 94  |.....>Pv........|
+000000b0  0e 5b f0 7c 2c be b7 2c  e1 1f 2e d9 17 62 84 e5  |.[.|,..,.....b..|
+000000c0  2f 5a 84 bc 80 41 7b 07  56 b4 53 74 e6 3a ce 8e  |/Z...A{.V.St.:..|
+000000d0  c4 0a 64 35 ba 91 24 49  a2 23 98 85 77 89 9a d2  |..d5..$I.#..w...|
+000000e0  cd 38 06 6b 17 03 03 02  6d 2e 8f 37 ba ec b7 03  |.8.k....m..7....|
+000000f0  a3 76 a2 89 b4 27 e7 22  8a 03 c7 0e 90 c0 43 6b  |.v...'."......Ck|
+00000100  42 73 c7 a7 7c 1e 9c 3b  5b 70 c2 e4 b3 f6 26 67  |Bs..|..;[p....&g|
+00000110  ba 05 5f c8 10 9c 27 98  01 d6 b2 27 a2 d8 d4 95  |.._...'....'....|
+00000120  7e 3e 80 ee 82 a0 d0 42  95 24 84 39 7c 9d fa b8  |~>.....B.$.9|...|
+00000130  bd 5f 01 f7 52 03 a5 ee  cb 8d 57 2a 94 36 c9 f8  |._..R.....W*.6..|
+00000140  b5 07 75 33 e0 1d 38 70  5d 3d 0e 15 3c fb 7d 48  |..u3..8p]=..<.}H|
+00000150  55 9b a3 30 43 11 a3 f6  53 de 38 86 1c c8 f0 91  |U..0C...S.8.....|
+00000160  db 32 46 38 d8 e5 a7 74  46 76 79 b8 cc b9 3c 5e  |.2F8...tFvy...<^|
+00000170  75 61 45 26 ea 87 49 b1  ad f8 72 e7 3f f9 f3 f0  |uaE&..I...r.?...|
+00000180  20 06 65 91 d6 b5 ef 27  88 f3 5b de f2 b4 66 94  | .e....'..[...f.|
+00000190  66 39 f6 e8 b5 3a 30 53  0e 38 a6 02 75 00 04 13  |f9...:0S.8..u...|
+000001a0  f4 99 c5 fa 6c d5 3f 3e  69 85 03 a2 8e 03 a6 ae  |....l.?>i.......|
+000001b0  15 89 fa 32 0b ee 4a e9  dd 41 51 e3 ed 9f 78 df  |...2..J..AQ...x.|
+000001c0  19 d6 2a 9e cb 18 68 51  58 f0 60 6d 06 97 e8 2c  |..*...hQX.`m...,|
+000001d0  5a 10 b0 79 e9 a9 78 2e  d5 b2 50 5a 82 49 20 79  |Z..y..x...PZ.I y|
+000001e0  5b 8e 3d cc 5e ca a0 75  7c bd 62 ba 58 d4 d9 29  |[.=.^..u|.b.X..)|
+000001f0  85 ad 69 31 2c d1 c2 84  01 d2 23 63 79 9f 3e 85  |..i1,.....#cy.>.|
+00000200  8a 0e 33 4e 12 b4 2d c8  b9 62 45 d9 41 6e ae ef  |..3N..-..bE.An..|
+00000210  7c 1d df 1e dc 3d 3f b8  4e 68 ef 23 2b 23 9a 4e  ||....=?.Nh.#+#.N|
+00000220  21 00 22 02 1d 24 45 58  b6 51 17 bd cd fb b0 7d  |!."..$EX.Q.....}|
+00000230  5d d4 de 81 7a 4f e3 d6  87 a7 0e 26 c4 df 92 96  |]...zO.....&....|
+00000240  98 14 fa aa 22 e8 15 f1  b7 d1 d2 8e 3d c4 0c 71  |....".......=..q|
+00000250  72 29 fd 00 c7 ed b7 45  a1 51 55 41 51 d2 a3 be  |r).....E.QUAQ...|
+00000260  08 a9 31 6c 51 9a ab 5a  b6 a6 33 29 72 c9 a4 ad  |..1lQ..Z..3)r...|
+00000270  f1 c2 9c 59 41 34 9a 65  17 a4 21 fd 93 fb 2e 92  |...YA4.e..!.....|
+00000280  55 d6 20 00 9f 31 dc 6e  02 b8 71 68 6b 36 53 e2  |U. ..1.n..qhk6S.|
+00000290  92 04 2f f1 4a cd 27 3f  e4 e2 ca 6d b9 95 3d b0  |../.J.'?...m..=.|
+000002a0  ff 7b f4 f1 33 f9 fb 32  86 1e 7e 9c 5f 68 83 04  |.{..3..2..~._h..|
+000002b0  96 98 31 16 0f ca 71 e6  c0 ad f4 69 a0 b2 dc 8b  |..1...q....i....|
+000002c0  6d 61 2e 70 15 80 89 29  13 80 b9 45 43 57 45 f7  |ma.p...)...ECWE.|
+000002d0  17 74 70 7f 2f b8 02 4d  1f 15 4c 31 ec 8c 26 4a  |.tp./..M..L1..&J|
+000002e0  c4 eb c1 92 6b c4 48 3c  54 e9 d8 0b 89 a4 c4 00  |....k.H<T.......|
+000002f0  ba b4 5a 92 8d 00 af bc  ef 32 9b 41 fa 80 ff 44  |..Z......2.A...D|
+00000300  26 42 94 f1 21 e4 e2 b2  6c 3d 43 37 e1 7e 19 62  |&B..!...l=C7.~.b|
+00000310  4b 2b e1 b7 62 70 42 be  64 ae 10 f2 b3 9b fa 52  |K+..bpB.d......R|
+00000320  be 23 7a 16 f2 60 d8 91  c4 aa d6 2e 8f 35 f2 65  |.#z..`.......5.e|
+00000330  29 af 09 ff 8a 57 02 fb  3e 11 9e c7 15 db de 35  |)....W..>......5|
+00000340  8b a8 81 de 50 7b 89 8a  2d d8 66 2b de a1 f0 4d  |....P{..-.f+...M|
+00000350  00 52 89 ae a0 9b 17 03  03 00 99 88 04 b0 7b c8  |.R............{.|
+00000360  03 34 60 a9 2a 0c 3b 63  ba bb 83 84 b1 55 f1 75  |.4`.*.;c.....U.u|
+00000370  ec 54 2e 6a bb 8a b9 e9  d7 d9 08 3f 56 34 5c 47  |.T.j.......?V4\G|
+00000380  fe 09 64 60 1e 4f e9 91  3f 18 68 1a f8 8a 11 80  |..d`.O..?.h.....|
+00000390  48 50 93 37 c3 b6 fc e8  da e9 e6 5d c9 0b f7 ad  |HP.7.......]....|
+000003a0  cd ed a7 7e 1d ee 03 9a  8f be 66 73 c7 b7 ab a1  |...~......fs....|
+000003b0  26 71 1f a7 d0 e7 67 02  b3 41 49 db 3b 0c 1f 41  |&q....g..AI.;..A|
+000003c0  56 59 eb 5a 5f 4f 87 6b  72 d4 35 d7 54 1f fa 5c  |VY.Z_O.kr.5.T..\|
+000003d0  a6 08 4f 16 46 5e 93 a2  95 5a 2d ce cd c0 c6 35  |..O.F^...Z-....5|
+000003e0  ac d4 cb 32 58 16 66 53  08 26 8e 68 24 14 72 98  |...2X.fS.&.h$.r.|
+000003f0  b5 0e bd da 17 03 03 00  35 52 71 08 e7 71 9d 1e  |........5Rq..q..|
+00000400  95 08 6c 92 d2 d3 8c 17  c2 69 9c c0 8d c2 ac 8b  |..l......i......|
+00000410  08 4e 53 b9 c3 32 13 ba  3c b7 b2 e4 c1 f4 d3 a8  |.NS..2..<.......|
+00000420  49 06 e4 b3 f5 85 31 60  f1 c5 40 1e 8f 85        |I.....1`..@...|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 02 11 7a 11 5a 3f be  |...........z.Z?.|
-00000010  f9 3f 6a 2b d3 f6 ce 15  f2 a4 52 7f 7c e9 c0 54  |.?j+......R.|..T|
-00000020  3a f1 26 37 d5 c5 61 2e  32 26 37 fd 3e 04 ea 9a  |:.&7..a.2&7.>...|
-00000030  f0 a1 03 b8 3c ec 66 37  2f 98 d7 e8 ad d3 61 ac  |....<.f7/.....a.|
-00000040  e4 ec e0 87 66 05 94 48  35 7f 85 81 82 39 e7 14  |....f..H5....9..|
-00000050  be 77 08 33 e3 49 3a 4e  48 60 b3 98 1b 73 8c 66  |.w.3.I:NH`...s.f|
-00000060  85 d3 5a 37 97 91 26 6b  f9 4f b2 a8 be 31 7b 31  |..Z7..&k.O...1{1|
-00000070  92 99 34 2b 20 20 b7 e6  f2 87 af 45 32 55 ee 73  |..4+  .....E2U.s|
-00000080  33 cc 96 ca f9 e1 32 2e  45 3d 9c 7c 1a 7a 41 cc  |3.....2.E=.|.zA.|
-00000090  7c 55 ba 2e 14 9e a8 eb  a8 c8 2c 60 b2 f5 bf 7b  ||U........,`...{|
-000000a0  e5 4c 32 34 5e fa 68 a3  d1 00 1b 57 a3 ed eb 7e  |.L24^.h....W...~|
-000000b0  5e 01 a4 07 4a 9c 7b 99  e2 e1 90 03 25 1c fc 39  |^...J.{.....%..9|
-000000c0  51 27 4c 54 de 3f 20 ed  67 89 83 2f cb a9 b7 3d  |Q'LT.? .g../...=|
-000000d0  0a 62 3c 5c 95 03 68 02  00 59 63 d4 55 ae 15 2f  |.b<\..h..Yc.U../|
-000000e0  b2 b2 36 6e fa c2 11 75  03 f9 02 8a f5 cb 32 7a  |..6n...u......2z|
-000000f0  8d 1c 40 ed d7 2e 7b 45  94 3b df e3 bd b3 70 c5  |..@...{E.;....p.|
-00000100  6a 77 c1 f7 1d dd 4f 39  71 1e 4a 92 ba 43 9f 0f  |jw....O9q.J..C..|
-00000110  77 d2 f3 a7 51 6d d6 b4  95 03 1f 4f f9 fc 2a 06  |w...Qm.....O..*.|
-00000120  c7 f4 a4 3c cd 3a 0c 2d  a4 c5 f2 3e c4 bf 30 1c  |...<.:.-...>..0.|
-00000130  53 09 a9 45 d0 d9 95 88  ca 25 cb e3 73 70 72 bc  |S..E.....%..spr.|
-00000140  0b cf e5 bb 2c 9c a0 79  91 1b b9 5a 17 10 05 c1  |....,..y...Z....|
-00000150  49 f5 f8 b1 35 17 b0 c8  cb 56 63 86 65 47 9f 13  |I...5....Vc.eG..|
-00000160  d9 21 b7 fd 6a 99 17 a4  35 9a 5e bc 44 49 6d 7b  |.!..j...5.^.DIm{|
-00000170  f6 7e e8 0e eb a9 ee 41  4a 46 15 ab c7 50 cb 31  |.~.....AJF...P.1|
-00000180  88 7e d0 9c 73 f2 07 13  c0 dd 3a 07 f3 86 f4 f9  |.~..s.....:.....|
-00000190  4f 3d 28 c0 13 3a eb 5f  a5 59 27 b6 03 82 e5 19  |O=(..:._.Y'.....|
-000001a0  ee 47 8b 11 25 8c d7 20  1c 91 8d 97 c8 71 f8 7a  |.G..%.. .....q.z|
-000001b0  64 85 e7 00 5e 35 bc f8  f8 2a 4a b3 0b e6 91 91  |d...^5...*J.....|
-000001c0  02 f8 28 b3 28 d2 e5 81  41 b2 5b 2b 9f 44 e1 8b  |..(.(...A.[+.D..|
-000001d0  48 94 82 7b 5b 03 5f fa  aa 75 78 52 f9 11 91 30  |H..{[._..uxR...0|
-000001e0  cd d3 4e 80 c3 d2 23 3a  5a 8a 42 12 8c b1 d1 51  |..N...#:Z.B....Q|
-000001f0  08 cc 8a 45 60 d2 88 62  46 97 2d 56 7e 02 d4 2e  |...E`..bF.-V~...|
-00000200  8f ec 91 72 60 a9 0c a9  05 1d 21 a3 fe c6 8c 0c  |...r`.....!.....|
-00000210  77 36 a8 bc 4c be 74 10  7d 47 3d 77 17 03 03 00  |w6..L.t.}G=w....|
-00000220  99 cd 14 d0 44 69 23 47  8a bc a3 dc ec 15 f4 c2  |....Di#G........|
-00000230  fd f5 ff e4 55 73 bf 2a  32 36 a3 0b 88 12 2b 3b  |....Us.*26....+;|
-00000240  60 9b 70 70 3b d5 0e 7f  3c ed c8 d8 d2 e1 da b5  |`.pp;...<.......|
-00000250  2c 79 40 78 23 b4 2b ec  18 c1 1d 9f 41 44 8a af  |,y@x#.+.....AD..|
-00000260  49 53 4c 8b e8 e2 3c 55  eb b4 1c 15 42 59 2d a2  |ISL...<U....BY-.|
-00000270  12 cb 8e 23 b2 bb 32 1b  b3 55 ba 56 ca 84 81 f9  |...#..2..U.V....|
-00000280  b4 da ba f4 c8 08 00 90  a4 2c 9d 64 8f fb aa 88  |.........,.d....|
-00000290  7a 06 9a 3a e3 a8 fa 8e  84 da 31 51 0c 13 db 44  |z..:......1Q...D|
-000002a0  20 5c 48 43 3c 3c e1 43  f6 6e ef 67 ba b9 04 b1  | \HC<<.C.n.g....|
-000002b0  23 4c 87 3a 63 66 f3 92  3f 73 17 03 03 00 35 7c  |#L.:cf..?s....5||
-000002c0  8e fd 7d a8 3f 66 1e 41  ca a6 f9 f0 ef 1a 5e 69  |..}.?f.A......^i|
-000002d0  7e 03 50 ff bc 70 2b 16  35 2e 6f 69 7f ef 8a 1b  |~.P..p+.5.oi....|
-000002e0  36 bd c4 04 9f 54 50 80  e2 79 c0 a4 fb 4d f7 6c  |6....TP..y...M.l|
-000002f0  56 f0 9b a6 17 03 03 00  13 e9 0d 3c 8b 42 35 7e  |V..........<.B5~|
-00000300  00 ca d2 ba 14 90 4c 87  3d bf 96 87              |......L.=...|
+00000000  14 03 03 00 01 01 17 03  03 02 11 0d aa ff 0a 4b  |...............K|
+00000010  ad e4 59 a9 c1 f5 f3 68  d8 75 aa 56 95 3e c2 79  |..Y....h.u.V.>.y|
+00000020  95 b4 86 21 5d 58 8c 27  09 be 59 21 6e 87 f3 fb  |...!]X.'..Y!n...|
+00000030  7a 77 fb a8 22 e4 93 bf  38 1d 4d a5 6f b5 5a dc  |zw.."...8.M.o.Z.|
+00000040  ac 1a a9 98 54 9a 87 a9  7a 31 38 eb e9 39 ec 4b  |....T...z18..9.K|
+00000050  b3 36 9f 9b 5a 44 d8 70  4d f4 53 1b 00 7e 3e 95  |.6..ZD.pM.S..~>.|
+00000060  34 1a 64 39 36 91 25 ab  c4 84 66 c9 e1 35 d1 57  |4.d96.%...f..5.W|
+00000070  0f 42 2a 7b 95 7e 6f 8f  87 7a 2e eb b5 57 3d d7  |.B*{.~o..z...W=.|
+00000080  c9 e4 0f a2 64 20 72 f2  78 fd 2b a1 29 11 da db  |....d r.x.+.)...|
+00000090  77 d9 08 f4 bf 71 e7 fb  62 87 8c fe 42 c7 1b 68  |w....q..b...B..h|
+000000a0  4c 4f a2 12 d9 1f dd 90  cc 09 83 20 21 16 01 9a  |LO......... !...|
+000000b0  da f1 74 ea a5 d9 8c 43  f0 1c 9a 44 62 54 ed bd  |..t....C...DbT..|
+000000c0  9d f2 04 73 e2 35 ce 0d  70 9c 16 d5 3d 80 b5 5d  |...s.5..p...=..]|
+000000d0  89 dd 64 82 12 65 a3 e7  70 16 25 ff ef 06 77 78  |..d..e..p.%...wx|
+000000e0  9e 37 32 1f ca 77 8c 01  f5 d6 8c 7a ef f9 5f f7  |.72..w.....z.._.|
+000000f0  eb 40 75 c5 36 c4 dd d8  3e 04 06 0e fa 18 d9 ac  |.@u.6...>.......|
+00000100  90 e6 3d 18 7e 34 c9 a4  ce 77 87 df 2d 74 ff 91  |..=.~4...w..-t..|
+00000110  67 7a 96 ac 7c b4 49 b5  52 c9 60 e5 34 75 b8 d1  |gz..|.I.R.`.4u..|
+00000120  b6 7a a1 c8 75 c4 d0 57  0a 16 01 e0 ef 44 90 3a  |.z..u..W.....D.:|
+00000130  95 06 bc 0e bc 0d 12 3b  ea eb 0e 1e f4 16 c9 da  |.......;........|
+00000140  06 f9 8b e6 b5 c2 ce 48  e4 5a b5 34 fb 9a 73 96  |.......H.Z.4..s.|
+00000150  20 67 2f 6a c6 04 53 75  e8 43 a2 99 4d 04 25 3e  | g/j..Su.C..M.%>|
+00000160  11 20 12 5e 48 dc eb f1  ea 35 3a e6 76 a4 dd df  |. .^H....5:.v...|
+00000170  66 6a 9e 94 46 a1 16 8c  d5 1a 3d 3c 3d 3c 3a aa  |fj..F.....=<=<:.|
+00000180  d6 31 4f 11 f0 5c 42 a1  ba 05 96 11 99 7e 2b 08  |.1O..\B......~+.|
+00000190  1b 20 e9 40 8a 00 b0 c0  2e e6 21 8f 98 76 59 4c  |. .@......!..vYL|
+000001a0  19 d8 b5 d3 48 2d 08 10  75 e8 98 7f 2b 0d c2 81  |....H-..u...+...|
+000001b0  0d 7a e9 6c 2d 25 cc 94  d3 90 d5 7d 49 a7 01 eb  |.z.l-%.....}I...|
+000001c0  e4 34 85 a4 42 5d 63 7d  50 8f 73 0d 31 ee 10 3d  |.4..B]c}P.s.1..=|
+000001d0  5f d7 72 c2 ea 84 35 e8  b8 e8 5d 4a 05 7a b9 66  |_.r...5...]J.z.f|
+000001e0  fa f0 07 6e aa 05 a7 69  a6 07 7c fc 46 3a d5 92  |...n...i..|.F:..|
+000001f0  44 97 59 ca ac de 01 7b  f2 67 9a 7b 01 5d 4d f7  |D.Y....{.g.{.]M.|
+00000200  58 44 60 72 a8 bd 21 2a  96 59 01 35 2a 41 6d a0  |XD`r..!*.Y.5*Am.|
+00000210  0e 1b ab 04 28 25 9f 37  19 84 e6 1c 17 03 03 00  |....(%.7........|
+00000220  99 f8 2e d9 3a 39 38 87  40 24 7a da f1 5b 8d 26  |....:98.@$z..[.&|
+00000230  30 a2 e6 d1 83 4f 68 bc  c4 6b e9 9c 91 58 e0 6b  |0....Oh..k...X.k|
+00000240  52 0d 82 fe 5b 54 22 51  a7 19 f7 c0 82 89 fe a3  |R...[T"Q........|
+00000250  da cc 79 a4 0c 48 99 71  ca ee 3c 2b d7 e6 e8 0b  |..y..H.q..<+....|
+00000260  55 f8 f6 09 3a 9e 3b 05  60 e2 3b 69 be 2b d3 50  |U...:.;.`.;i.+.P|
+00000270  63 79 91 e8 0d 7a 6f 1e  e6 85 80 0b ba dd bf 39  |cy...zo........9|
+00000280  1a 85 90 40 a9 88 4b 80  a2 16 05 69 7e b0 61 4c  |...@..K....i~.aL|
+00000290  39 53 04 46 5a 17 1a c2  5a 89 6e 69 9d 8c 57 ff  |9S.FZ...Z.ni..W.|
+000002a0  89 31 83 26 0c 8a ef a4  1a 08 87 ee 75 43 6d aa  |.1.&........uCm.|
+000002b0  80 b9 a0 f0 7f ea 35 8f  3e 71 17 03 03 00 35 67  |......5.>q....5g|
+000002c0  92 3c c8 8c 87 e7 a5 05  3d 0a 43 11 40 bb 4d 18  |.<......=.C.@.M.|
+000002d0  17 bf 0c 26 59 c8 16 15  03 0e 5f 05 d7 e0 4e ab  |...&Y....._...N.|
+000002e0  6d bf 19 9c bd 10 95 2b  c0 24 69 bc 70 d6 40 8f  |m......+.$i.p.@.|
+000002f0  ad 34 e4 1c 17 03 03 00  13 f0 f5 bb 11 53 b6 7d  |.4...........S.}|
+00000300  e7 3d 17 41 72 ff fb 3f  55 49 06 05              |.=.Ar..?UI..|
 >>> Flow 4 (server to client)
-00000000  17 03 03 02 7e 54 17 d0  0c d1 74 8e f6 a8 27 4f  |....~T....t...'O|
-00000010  c0 89 fa f3 4c 5f 2d 93  61 36 f5 bb fc 58 41 e7  |....L_-.a6...XA.|
-00000020  4e b9 87 92 a4 af 27 81  58 ad 76 0a 4b 42 77 48  |N.....'.X.v.KBwH|
-00000030  3c 0e 9f b6 b8 82 c3 cd  e7 4e 93 00 4b 4c ce ee  |<........N..KL..|
-00000040  6d 13 c4 d3 28 53 40 d6  45 95 62 ad 9f 31 63 ca  |m...(S@.E.b..1c.|
-00000050  86 ce 82 7d f6 d6 e1 7c  36 d1 8e 78 07 27 81 06  |...}...|6..x.'..|
-00000060  1d 6e 64 e2 f3 9f 23 2f  d1 4d b3 e5 13 32 ac 29  |.nd...#/.M...2.)|
-00000070  27 cc 2f a9 3d 12 a8 6a  3f 7b c1 56 b4 98 34 35  |'./.=..j?{.V..45|
-00000080  d4 ed 8d c0 61 dd 4a 54  f0 66 b4 4a 05 bb 25 fb  |....a.JT.f.J..%.|
-00000090  d8 85 af 78 33 9e b8 01  6f 01 cc 2f d6 7b 46 3e  |...x3...o../.{F>|
-000000a0  1c 95 2c 34 7b 8e 0b c2  a2 27 92 4d af 5a 48 42  |..,4{....'.M.ZHB|
-000000b0  55 ea 08 62 2a 12 c2 b7  0e 27 d9 85 64 1c 6c 29  |U..b*....'..d.l)|
-000000c0  da 0e ca 8d 49 d8 ba 8b  81 3b fa 66 5e 97 89 68  |....I....;.f^..h|
-000000d0  18 43 37 6a 7c 3a b2 f2  b5 c1 92 49 f4 45 db 6b  |.C7j|:.....I.E.k|
-000000e0  49 8a 4a dd 9c 23 e9 a0  31 65 b2 73 e3 c5 1b 9d  |I.J..#..1e.s....|
-000000f0  51 d6 16 bc 79 d6 c4 e8  66 7c 43 5d c6 22 ab 50  |Q...y...f|C].".P|
-00000100  8a 51 5d f1 79 8e 18 df  ca 6a 8d 98 d0 11 7a ce  |.Q].y....j....z.|
-00000110  e8 dc 57 8a 95 e5 39 36  0a 9e 84 bd b4 b3 f4 85  |..W...96........|
-00000120  eb 3e 3a 50 1e dc 09 ff  21 44 98 50 a5 35 90 9f  |.>:P....!D.P.5..|
-00000130  b3 06 b4 b1 4a 87 1e a9  59 a0 72 44 2f 1c 15 f4  |....J...Y.rD/...|
-00000140  16 e4 a9 95 e1 b8 11 01  be e8 eb 21 37 97 4f a0  |...........!7.O.|
-00000150  9d fb 76 57 77 33 22 78  ed 97 23 a9 58 6b a2 05  |..vWw3"x..#.Xk..|
-00000160  6c 4e 91 80 e0 2c 45 cb  ee 12 dc 85 d2 11 2f ea  |lN...,E......./.|
-00000170  2f 62 56 3d ec bf 45 4d  e7 76 c5 0b 8d 07 ea 26  |/bV=..EM.v.....&|
-00000180  9b 36 79 8f d6 9f 45 ea  e9 d4 7c 50 ed a8 bb d8  |.6y...E...|P....|
-00000190  09 89 98 0b 44 f5 5e b5  a0 5e 16 3e af 5d 71 5b  |....D.^..^.>.]q[|
-000001a0  15 95 d7 96 d6 76 0c 49  36 ea 9b a3 52 41 be df  |.....v.I6...RA..|
-000001b0  3b 70 95 9a 9f ff f4 70  12 ab d9 1b fe 30 b1 af  |;p.....p.....0..|
-000001c0  61 e2 67 1d 23 aa 77 90  63 a2 cf c2 9e 62 aa af  |a.g.#.w.c....b..|
-000001d0  c9 6a 1d c3 37 fd aa 7d  a6 09 89 4d 0b 2a 17 ea  |.j..7..}...M.*..|
-000001e0  ec b0 67 20 85 60 c8 bf  64 68 a8 e2 5b 34 a2 d2  |..g .`..dh..[4..|
-000001f0  14 e1 d8 f8 79 91 da 96  05 ce 5b 0b ed b7 34 e9  |....y.....[...4.|
-00000200  36 a0 40 5a 06 c3 d8 02  fe fd c6 91 b1 dd 89 fb  |6.@Z............|
-00000210  01 f8 5f d9 8a 3d 00 29  f2 e4 b4 56 48 3c c8 b4  |.._..=.)...VH<..|
-00000220  2f 59 dc e1 10 a4 ac db  e7 ef b0 18 3d 5b ce b0  |/Y..........=[..|
-00000230  97 66 d0 07 c5 97 2f f4  8c c2 44 25 ae 5b 3a 8e  |.f..../...D%.[:.|
-00000240  5a a3 9e cc 54 7d d0 9a  55 fc d4 f8 94 f9 90 83  |Z...T}..U.......|
-00000250  1c f6 59 9c f8 9d a5 b4  42 7c 25 b9 27 b9 67 19  |..Y.....B|%.'.g.|
-00000260  4e 04 04 8e 19 69 dc d2  23 cf f5 a2 75 3e 04 3b  |N....i..#...u>.;|
-00000270  87 c4 cd 6d 80 8f b1 12  bc dd 85 c7 bf 8a b1 4f  |...m...........O|
-00000280  5c a2 e0 17 03 03 00 1e  82 98 bd 26 61 20 71 62  |\..........&a qb|
-00000290  2b 5b e6 85 81 c5 26 d0  20 7a e7 22 b3 88 e9 c0  |+[....&. z."....|
-000002a0  70 3e f3 cb 27 46 17 03  03 00 13 04 f4 df d7 47  |p>..'F.........G|
-000002b0  fc 4d 90 4e e7 91 b5 32  eb ed e5 10 9b ee        |.M.N...2......|
+00000000  17 03 03 02 7f 1f 4c f6  5d 2e fd 21 bb 97 e0 c7  |......L.]..!....|
+00000010  88 69 42 99 49 d3 1e 6d  ce 16 95 01 ca 10 47 d2  |.iB.I..m......G.|
+00000020  7c f1 aa 53 3d cc ec 49  11 9e f1 7b 85 40 64 20  ||..S=..I...{.@d |
+00000030  44 7c 74 1f e5 a7 aa c2  95 b3 9d 98 ae 5d 73 6b  |D|t..........]sk|
+00000040  48 8c 63 b6 ab 38 f4 e7  95 28 66 1c 79 5f f0 e8  |H.c..8...(f.y_..|
+00000050  ca 6c ce e8 bf f3 7f 16  2b f0 62 aa 04 c7 96 dd  |.l......+.b.....|
+00000060  6f 1c 37 37 f4 41 b4 d3  87 fc d0 fd 67 cc 4d 15  |o.77.A......g.M.|
+00000070  80 69 88 19 c8 95 9b be  53 c8 a6 29 99 a2 8c 14  |.i......S..)....|
+00000080  cd 71 3d 11 0a 65 fa d5  fe 7c e7 5f 5a b4 96 fc  |.q=..e...|._Z...|
+00000090  ef 39 ad 13 38 a6 a0 42  9c 1e ee 61 89 79 f5 ee  |.9..8..B...a.y..|
+000000a0  df 0b 49 f8 e5 ab fc 4c  28 3f 33 ca b2 6d 8a 66  |..I....L(?3..m.f|
+000000b0  3b 88 ff 9c 30 08 c0 42  5c 26 29 0a 0c 52 6a f5  |;...0..B\&)..Rj.|
+000000c0  27 79 db 39 af 4b b6 5b  ba 00 7d 55 f5 41 86 9b  |'y.9.K.[..}U.A..|
+000000d0  bb d0 91 b7 ba 5f ff 19  06 20 85 a3 45 c7 44 45  |....._... ..E.DE|
+000000e0  5c e4 c9 41 0a d4 66 f5  5b 63 64 64 89 47 39 6f  |\..A..f.[cdd.G9o|
+000000f0  08 93 d8 e7 9c b0 fb 0b  9b 7c 90 d3 5b 32 61 61  |.........|..[2aa|
+00000100  03 cd 16 fa eb 39 1a 43  40 b9 52 e6 27 ac 33 43  |.....9.C@.R.'.3C|
+00000110  78 53 bb 6c 5f e8 4d 80  c8 1b b8 79 b6 43 63 b8  |xS.l_.M....y.Cc.|
+00000120  ea 19 71 8c 9e f4 46 b5  b4 df 2b df 84 f2 70 c2  |..q...F...+...p.|
+00000130  e5 40 16 79 f4 39 1f c0  7a 6b 54 d3 12 c7 e8 4a  |.@.y.9..zkT....J|
+00000140  2f aa fa 0d 20 ee b4 b3  bf 6f 75 c4 61 21 0d c9  |/... ....ou.a!..|
+00000150  e5 2a 3c cf 84 65 44 bf  4b a7 12 d1 4b 39 2c df  |.*<..eD.K...K9,.|
+00000160  bf 29 80 86 41 8a ee b8  7c a4 3a c5 5d 45 93 94  |.)..A...|.:.]E..|
+00000170  1d b9 4f 39 a9 ea 39 97  24 63 81 28 0d 22 7f 9b  |..O9..9.$c.(."..|
+00000180  bf a1 2f b3 c6 b6 a6 8e  67 67 80 35 4f 3a bb a8  |../.....gg.5O:..|
+00000190  ab 72 7d 33 b9 df 9c c9  97 e1 a6 51 9e a4 6e 39  |.r}3.......Q..n9|
+000001a0  80 7d 2c 76 40 f3 86 a8  ff 62 12 d4 4c 07 90 f1  |.},v@....b..L...|
+000001b0  0d 99 d7 1e c9 47 24 52  a6 61 05 ab 6a 0d 83 ba  |.....G$R.a..j...|
+000001c0  bd 1d 6f 8a 5e ce 67 9f  f3 a5 ef 07 36 d5 69 70  |..o.^.g.....6.ip|
+000001d0  01 f4 52 22 69 5f 23 f5  43 ad 54 84 d3 eb 59 77  |..R"i_#.C.T...Yw|
+000001e0  c4 b3 3e 86 35 5b 7d 62  40 fb 25 b8 1b 81 2b e3  |..>.5[}b@.%...+.|
+000001f0  d7 a3 36 5a 93 42 bf cf  a9 3b f7 9e 79 7c 9c 7c  |..6Z.B...;..y|.||
+00000200  86 ad af d2 14 7a a7 db  20 dc d3 2a 58 a9 73 6c  |.....z.. ..*X.sl|
+00000210  30 b1 1c 94 78 7f 5b 30  4e 8f 4d e2 8c 4a 23 ce  |0...x.[0N.M..J#.|
+00000220  b2 41 c8 5e 68 93 59 db  db 4b 95 c6 88 56 7d 02  |.A.^h.Y..K...V}.|
+00000230  d2 a5 57 61 2b 19 30 2d  58 ec 02 c9 44 3a fd 97  |..Wa+.0-X...D:..|
+00000240  73 c3 84 be 61 20 4b 02  88 b3 5f 44 af ba a0 9b  |s...a K..._D....|
+00000250  16 de ca e1 dd 60 6d ee  81 61 a4 9f 69 1c ef 1a  |.....`m..a..i...|
+00000260  c9 d1 65 3f 4b 25 7e 31  3d 94 61 d6 89 90 97 4d  |..e?K%~1=.a....M|
+00000270  0e 17 ed 23 2e 11 a3 7b  41 5e 8c 79 81 3f 57 18  |...#...{A^.y.?W.|
+00000280  f2 53 83 ef 17 03 03 00  1e cb 06 95 24 4d 96 ee  |.S..........$M..|
+00000290  8f 2c 0b 86 e7 d8 7d f7  78 08 46 0e 68 6d 80 3d  |.,....}.x.F.hm.=|
+000002a0  a0 d7 30 a5 c5 2b 93 17  03 03 00 13 1d 74 a3 82  |..0..+.......t..|
+000002b0  5e b1 94 71 59 c1 87 d0  3b 92 f3 cd b9 55 ac     |^..qY...;....U.|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedNotGiven b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedNotGiven
index 2f6585669f..ee5ef6e2cb 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedNotGiven
+++ b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedNotGiven
@@ -1,103 +1,103 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 28 56 dd b3 e1  |...........(V...|
-00000010  b1 b6 be 0c 44 59 e6 3e  32 87 f3 3b 08 9b e2 a1  |....DY.>2..;....|
-00000020  d4 a5 eb 85 2f c5 66 18  d0 43 75 20 13 5e 32 16  |..../.f..Cu .^2.|
-00000030  7d f3 b7 f6 06 4a 99 a6  99 13 23 23 b4 21 59 9b  |}....J....##.!Y.|
-00000040  09 4f 65 c9 63 02 ad 0a  85 76 14 0f 00 04 13 01  |.Oe.c....v......|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 34 04 ee af f8  |...........4....|
+00000010  8b c6 1a 77 bd cb b1 82  59 34 02 65 e1 68 c3 1f  |...w....Y4.e.h..|
+00000020  ae 37 9f 54 c0 05 90 a8  ec 75 f4 20 4f 50 95 61  |.7.T.....u. OP.a|
+00000030  59 7f 52 38 ba 5c db 01  10 c9 59 57 19 cd d8 cf  |Y.R8.\....YW....|
+00000040  34 c0 92 af 94 2e 00 05  eb d2 27 23 00 04 13 01  |4.........'#....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 77  |-.....3.&.$... w|
-000000b0  ca 45 b1 18 d7 b1 59 b5  bc 4c 2e 41 5d 5c 8c 5f  |.E....Y..L.A]\._|
-000000c0  2f 57 f0 7e af 4b c9 f0  c7 71 d5 29 a1 d5 32     |/W.~.K...q.)..2|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 e7  |-.....3.&.$... .|
+000000b0  1d 50 18 f8 b5 25 14 ed  eb e2 da 8d 44 25 df 67  |.P...%......D%.g|
+000000c0  31 9e 8e 22 b3 c9 63 e0  f2 03 e2 c1 f4 23 48     |1.."..c......#H|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 13 5e 32 16  |........... .^2.|
-00000030  7d f3 b7 f6 06 4a 99 a6  99 13 23 23 b4 21 59 9b  |}....J....##.!Y.|
-00000040  09 4f 65 c9 63 02 ad 0a  85 76 14 0f 13 01 00 00  |.Oe.c....v......|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 4f 50 95 61  |........... OP.a|
+00000030  59 7f 52 38 ba 5c db 01  10 c9 59 57 19 cd d8 cf  |Y.R8.\....YW....|
+00000040  34 c0 92 af 94 2e 00 05  eb d2 27 23 13 01 00 00  |4.........'#....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 a4 e0 fe 82 8a b3  |................|
-00000090  56 38 dd e4 df d9 30 77  4a a0 ec 47 3a 1f 26 d9  |V8....0wJ..G:.&.|
-000000a0  94 17 03 03 00 3e b6 b2  28 3a e1 58 03 cb ae b2  |.....>..(:.X....|
-000000b0  b3 10 69 dd 92 bb cf 86  25 11 03 29 13 07 2c b6  |..i.....%..)..,.|
-000000c0  43 94 09 d8 a1 a5 85 2b  81 91 76 d7 a1 f4 4d ce  |C......+..v...M.|
-000000d0  d3 47 dc 19 83 72 9d df  02 fd 46 c4 89 1c c0 fc  |.G...r....F.....|
-000000e0  fa ff 4d d5 17 03 03 02  6d 4c ee 73 a4 1c 19 ab  |..M.....mL.s....|
-000000f0  8e 38 82 ea 30 c4 aa 71  0f 64 6b e0 dd d4 22 7d  |.8..0..q.dk..."}|
-00000100  07 6d 0e 56 94 ac 80 70  9f b5 35 93 c3 b0 0e 8f  |.m.V...p..5.....|
-00000110  3d fd 20 93 3b 56 8b c9  e4 f8 0d 97 a7 d2 8f 41  |=. .;V.........A|
-00000120  d6 29 3c 15 88 32 5e 6f  4d 6a dc 76 20 c1 9d 4b  |.)<..2^oMj.v ..K|
-00000130  84 52 a8 64 78 61 ea ff  32 0a 08 11 ff 6e 03 cc  |.R.dxa..2....n..|
-00000140  83 dc 8f 88 64 e3 81 8b  42 b3 9e e9 6d cf c8 18  |....d...B...m...|
-00000150  7a 71 4a 2d a9 9a 0c 67  c5 c4 86 96 a2 98 49 ed  |zqJ-...g......I.|
-00000160  57 4c 33 41 47 67 8d 00  26 fd 78 14 48 2c d0 42  |WL3AGg..&.x.H,.B|
-00000170  25 ba 0d fd d5 65 42 fd  22 28 e1 90 e4 0d 4e 0d  |%....eB."(....N.|
-00000180  c9 8e 83 c4 c0 e8 42 8b  a9 c6 3e 94 95 8a 9b 23  |......B...>....#|
-00000190  e8 aa 3d 3c 3f d9 fb 14  64 25 28 25 33 5a 4d 98  |..=<?...d%(%3ZM.|
-000001a0  62 c8 b7 9c d5 e0 32 26  2d 24 86 80 0c b0 49 fc  |b.....2&-$....I.|
-000001b0  fc 58 8a 1a b8 90 c6 19  e1 22 b9 4b 34 7e 28 6e  |.X.......".K4~(n|
-000001c0  0e 19 32 e1 63 d3 78 c0  99 4c 5d 00 5f 05 af 7d  |..2.c.x..L]._..}|
-000001d0  f1 20 1a 39 97 8f 62 a9  a6 26 07 d1 e1 5c d0 55  |. .9..b..&...\.U|
-000001e0  cf 70 52 1c 15 64 4c 6a  a0 1d 8d ad 4d 16 54 00  |.pR..dLj....M.T.|
-000001f0  e6 2a 10 ca b6 b5 6b 6b  da 80 d6 ac fc 8b 0a 0e  |.*....kk........|
-00000200  c9 d3 35 cd 81 56 27 81  b8 88 4a 11 ae 2c 44 7c  |..5..V'...J..,D||
-00000210  36 f2 eb 8e b3 b8 14 1e  14 c0 e9 30 95 9d 17 9b  |6..........0....|
-00000220  98 a1 33 a2 f4 72 f5 69  4f bf c6 70 b4 40 d9 5d  |..3..r.iO..p.@.]|
-00000230  f1 fd 13 4b b3 16 99 b3  b1 3d 3d 80 02 19 b1 0b  |...K.....==.....|
-00000240  f2 f1 3d a0 18 c6 6d a3  b9 46 0e 7d ab fe ba 14  |..=...m..F.}....|
-00000250  8d 3e e8 10 42 93 27 fb  ae cb c5 a1 ad 60 7a 5a  |.>..B.'......`zZ|
-00000260  58 45 af 76 a3 4b 83 a5  13 74 77 2e f7 06 a5 42  |XE.v.K...tw....B|
-00000270  a8 fa 75 60 ec 6e 7d b8  a9 54 e1 89 05 e3 fc f0  |..u`.n}..T......|
-00000280  de dc d1 cf b3 76 db 91  2d 65 04 30 2d 2c e0 5e  |.....v..-e.0-,.^|
-00000290  71 c0 00 83 50 aa 17 7a  2c 29 c7 a5 78 31 b0 32  |q...P..z,)..x1.2|
-000002a0  3c 3a 98 9a 67 ee 73 7b  f0 1f 53 8d cf c5 ef 97  |<:..g.s{..S.....|
-000002b0  36 df 88 7b bb d6 0a 9d  07 f6 48 73 1b 8c 08 48  |6..{......Hs...H|
-000002c0  55 02 21 b2 68 6d 41 d1  28 92 20 bf b1 26 ab 9b  |U.!.hmA.(. ..&..|
-000002d0  01 80 33 d9 b1 84 17 40  7f 81 e4 84 6e ca 8d 78  |..3....@....n..x|
-000002e0  6f fc 6e 46 f8 71 85 b5  03 f7 09 ef 23 8d 36 c7  |o.nF.q......#.6.|
-000002f0  43 e8 72 f3 ba 25 86 a9  f1 70 fb 8f 7e 28 28 1c  |C.r..%...p..~((.|
-00000300  72 96 d7 23 71 4a 64 23  db 79 e2 fe 5a 53 e3 be  |r..#qJd#.y..ZS..|
-00000310  04 33 34 50 19 f4 fe cd  9c a0 39 c5 5a 7c 52 71  |.34P......9.Z|Rq|
-00000320  93 9b 98 15 7d fd bf 89  f5 03 08 aa 6c fe ae a2  |....}.......l...|
-00000330  8d e5 c7 91 3b 67 78 59  f5 37 09 12 f1 ec f8 8b  |....;gxY.7......|
-00000340  47 a4 ff 07 9f 66 ea 03  ff c0 33 aa 9f ca 91 9c  |G....f....3.....|
-00000350  02 b6 c7 f0 92 87 17 03  03 00 99 64 2a 36 be c9  |...........d*6..|
-00000360  0b f2 83 99 e2 9d 3d 1c  ca f9 6a a0 19 e2 0d b1  |......=...j.....|
-00000370  b0 4a a6 00 70 9d 73 9a  95 78 4b 63 39 57 5c 45  |.J..p.s..xKc9W\E|
-00000380  ae 09 50 c1 fc 0b f4 f6  3b 50 95 06 52 62 5c 55  |..P.....;P..Rb\U|
-00000390  e2 08 fa d7 c1 6d c2 8f  3b b8 42 ac b1 b0 31 04  |.....m..;.B...1.|
-000003a0  66 2c fe cc c9 c5 82 46  b9 43 79 fd ca cd c8 37  |f,.....F.Cy....7|
-000003b0  de 39 e8 2d 63 33 c5 74  85 bc c1 86 1d 91 5e 48  |.9.-c3.t......^H|
-000003c0  e3 75 50 0d f1 5c 24 4a  48 e9 ff 6d 4c 46 ee b8  |.uP..\$JH..mLF..|
-000003d0  42 72 48 35 86 1c 68 ea  0e bc df a6 4f 23 91 33  |BrH5..h.....O#.3|
-000003e0  b3 39 61 8d 75 e7 d3 d4  b2 10 65 50 f7 11 15 a2  |.9a.u.....eP....|
-000003f0  d6 4c c3 ff 17 03 03 00  35 20 83 d9 3c 1d ae 54  |.L......5 ..<..T|
-00000400  66 5a 8b 8e a5 5b 00 c0  3b b2 c7 02 13 18 aa ef  |fZ...[..;.......|
-00000410  c3 9f 8d 9f 06 82 c2 29  0b 82 5c 9f 0e 88 29 33  |.......)..\...)3|
-00000420  06 13 de a2 89 bc 4c 42  97 e2 4c 75 bd fe        |......LB..Lu..|
+00000080  03 03 00 01 01 17 03 03  00 17 7f 73 17 e9 4a 7b  |...........s..J{|
+00000090  f4 74 f9 b5 89 8d d7 4a  cc d7 27 f5 fd be dc 5a  |.t.....J..'....Z|
+000000a0  43 17 03 03 00 3e c3 cc  a5 91 3d bc c0 4d 89 a6  |C....>....=..M..|
+000000b0  17 e3 40 cc 3c b2 d5 d2  f9 14 76 52 1b dd 9f aa  |..@.<.....vR....|
+000000c0  50 ca 72 21 cd da e8 5c  57 02 2d b6 97 e0 e9 8a  |P.r!...\W.-.....|
+000000d0  c3 79 41 44 2d 94 3f 42  d5 62 42 b1 c8 0f a6 05  |.yAD-.?B.bB.....|
+000000e0  62 cd b4 ca 17 03 03 02  6d e1 52 03 a3 17 d1 c8  |b.......m.R.....|
+000000f0  69 5c 28 3b 4b 21 13 06  f9 66 18 4b d4 35 44 df  |i\(;K!...f.K.5D.|
+00000100  3a 72 a8 01 54 bd dc 83  50 5a 7d 3f e5 61 d3 ec  |:r..T...PZ}?.a..|
+00000110  c7 79 73 b0 e4 78 89 1c  d5 cb 4c 1d fb 89 9d e9  |.ys..x....L.....|
+00000120  51 20 16 23 a8 4f e8 c1  47 d7 3e ec 89 bf c8 a6  |Q .#.O..G.>.....|
+00000130  a8 e6 59 44 1a 00 b5 e0  05 e9 8b a0 39 2a f1 c9  |..YD........9*..|
+00000140  4b c0 9e 91 08 bd 62 3c  27 bc ea 68 c8 88 5b f6  |K.....b<'..h..[.|
+00000150  89 d7 4c bb e1 15 3f 9c  50 ad c4 ed 75 b0 8d 34  |..L...?.P...u..4|
+00000160  c4 84 b3 25 22 82 ed 63  28 06 5b 1b 0a e9 d2 32  |...%"..c(.[....2|
+00000170  a4 01 81 98 0d 24 fc 85  8d 6e 04 7d 6d 8a 23 2f  |.....$...n.}m.#/|
+00000180  a1 2f c9 4e 23 2e 14 d9  58 9d 20 ac d2 0a ef c1  |./.N#...X. .....|
+00000190  34 27 25 00 88 0f cd 9a  5c 8e 54 6c 18 87 1b ae  |4'%.....\.Tl....|
+000001a0  c6 f0 20 ab 3d a5 1c ec  9a a5 d6 9b 31 e2 05 51  |.. .=.......1..Q|
+000001b0  b5 f8 54 c9 85 6a 98 29  92 26 86 e2 a0 11 96 bd  |..T..j.).&......|
+000001c0  4c 2b cc 4b f3 7d ac 25  cd a9 c7 80 bf 7c 48 d3  |L+.K.}.%.....|H.|
+000001d0  d2 aa ae d2 17 f7 49 1c  bf bf e3 21 c2 bb e3 78  |......I....!...x|
+000001e0  3a f2 7e d6 23 7a 96 3f  34 6f dc 87 0b d4 05 02  |:.~.#z.?4o......|
+000001f0  d8 88 96 90 4d d1 a6 37  9b 93 98 1c 22 a8 a8 9a  |....M..7...."...|
+00000200  30 1d 8e bb 6c 90 90 93  37 ca f7 d1 e4 d9 ee 61  |0...l...7......a|
+00000210  55 93 b6 bf aa 5a ba 53  cf 50 22 00 fc d7 06 9e  |U....Z.S.P".....|
+00000220  93 68 dc 88 09 52 18 95  e6 70 81 1c b9 21 cd dd  |.h...R...p...!..|
+00000230  25 3e ed dc 61 3f 0d 08  06 44 47 87 4a 53 10 fa  |%>..a?...DG.JS..|
+00000240  b7 85 ff e8 c3 41 72 9d  b3 57 c0 d2 8d cd d7 c1  |.....Ar..W......|
+00000250  96 d6 e8 93 88 a5 2d 5c  db 98 38 4c 99 6e 2e c5  |......-\..8L.n..|
+00000260  8e fa c4 43 32 e1 a7 ea  29 fb be fb ca d3 0a b1  |...C2...).......|
+00000270  70 cc 30 bd 46 f9 fe c6  52 c3 10 1f 1d cb 11 55  |p.0.F...R......U|
+00000280  c7 c3 89 cf 38 68 55 7d  15 db 0a 81 a5 f0 4a d3  |....8hU}......J.|
+00000290  db 17 5d 40 86 ec e4 11  9f fb 2d c7 41 80 15 af  |..]@......-.A...|
+000002a0  5c c6 9f 15 f1 ef e6 3a  59 5e fb ba 7d 75 c8 18  |\......:Y^..}u..|
+000002b0  77 8c c4 8e 7e b3 dc 25  a2 2e 0c 42 3d d5 04 bb  |w...~..%...B=...|
+000002c0  73 6f 3b 30 3e b7 9f bc  10 28 73 46 7b b6 9a 39  |so;0>....(sF{..9|
+000002d0  8a 11 ee e4 1d af ce 96  6d 1a 5a e0 25 7e bd 65  |........m.Z.%~.e|
+000002e0  9f 4f 57 5f 8f c8 84 f4  aa d5 3a a7 a4 27 db b4  |.OW_......:..'..|
+000002f0  7f 64 f4 37 26 83 b0 d8  b0 3e 69 6c 99 a9 f8 4b  |.d.7&....>il...K|
+00000300  9b 4d 75 74 27 62 58 1b  cb e1 c0 55 72 67 d9 0a  |.Mut'bX....Urg..|
+00000310  a9 66 24 d0 6d 4a 05 8e  3a 2c ce 84 3f 8b d0 b7  |.f$.mJ..:,..?...|
+00000320  43 e5 c2 38 d3 c4 fa e5  de fe 3b b2 ac 75 3c bb  |C..8......;..u<.|
+00000330  8b 6c 97 87 37 f9 12 28  c9 c2 87 09 e4 44 45 3c  |.l..7..(.....DE<|
+00000340  66 14 08 5a 0c 31 5a d6  bc 9e 0c a8 b9 b7 04 71  |f..Z.1Z........q|
+00000350  13 4f 10 21 03 69 17 03  03 00 99 ad 02 66 57 fc  |.O.!.i.......fW.|
+00000360  bc 08 db 92 a0 3d 28 d8  be dd 13 90 8f b4 71 39  |.....=(.......q9|
+00000370  9c 09 50 88 92 c7 32 44  2b 97 d2 c5 74 76 e6 5b  |..P...2D+...tv.[|
+00000380  df 14 f4 a7 07 ce 60 6b  ac ab 96 d4 54 6d 5f 42  |......`k....Tm_B|
+00000390  b1 7a f4 d2 10 ce 39 52  ae 80 50 21 5c 50 03 c1  |.z....9R..P!\P..|
+000003a0  4f 9c b4 d5 0d e2 e0 fc  82 2b fb 05 21 ce fa 40  |O........+..!..@|
+000003b0  d4 77 29 5b cf 35 18 02  ca 78 a1 c0 d8 07 b8 16  |.w)[.5...x......|
+000003c0  f1 c1 82 af c6 dc 80 67  0e 5a c0 79 ed d2 8c 11  |.......g.Z.y....|
+000003d0  24 fd 30 3a 39 64 18 70  09 46 dc 42 fc 20 a3 d6  |$.0:9d.p.F.B. ..|
+000003e0  a0 1a eb 6e 80 68 cb dc  fe a6 1f 17 8f 5c 1f ff  |...n.h.......\..|
+000003f0  7e 7a a5 92 17 03 03 00  35 73 b3 f6 7a 14 23 07  |~z......5s..z.#.|
+00000400  6d fd 16 3c 46 9e 30 63  83 7f b3 b0 fb 47 a8 92  |m..<F.0c.....G..|
+00000410  e8 a2 26 d9 55 ed 78 a3  f1 5b 19 c3 66 5a fa 64  |..&.U.x..[..fZ.d|
+00000420  3e f0 cd b9 f4 11 18 bf  5c 5e 38 e6 b5 79        |>.......\^8..y|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 19 bf 82 c2 60 ce  |..............`.|
-00000010  13 5a ec 7f 22 d6 a9 98  a1 25 75 00 e4 14 ad 1a  |.Z.."....%u.....|
-00000020  1f 8b e5 05 17 03 03 00  35 3f 19 a3 d3 bb 77 3f  |........5?....w?|
-00000030  ab 8b b4 32 0b 80 5c b5  b5 ef 4a b8 42 03 40 59  |...2..\...J.B.@Y|
-00000040  03 aa eb 39 8f 92 95 22  8c 0c d7 e7 13 5c 1c 56  |...9...".....\.V|
-00000050  55 db 71 bd 1b bd fc 9f  2d f2 b0 d8 be 57        |U.q.....-....W|
+00000000  14 03 03 00 01 01 17 03  03 00 19 ca f6 38 db 7f  |.............8..|
+00000010  2d 71 b7 9a d9 15 0b db  23 a7 fa 77 eb dc 63 6a  |-q......#..w..cj|
+00000020  b7 ed 10 3a 17 03 03 00  35 70 c7 ee 8a b0 88 c0  |...:....5p......|
+00000030  98 e5 f8 14 8b 04 bb a0  38 1e d1 0a 7c b1 94 05  |........8...|...|
+00000040  a3 3b 56 8f bd fd f4 46  9a 51 a1 d4 c8 9e 17 ec  |.;V....F.Q......|
+00000050  87 5a 13 dd d0 66 25 75  d4 2c 33 de af 97        |.Z...f%u.,3...|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 86 bf ce 94  05 fe 47 59 59 0a a3 c4  |..........GYY...|
-00000010  4f 42 55 1c f1 2a 01 68  e6 5e ba f5 c1 3b 76 3e  |OBU..*.h.^...;v>|
-00000020  1d 0a 39 2e c0 23 e3 05  84 ec 75 99 18 7e bc 16  |..9..#....u..~..|
-00000030  bc 2a e7 4d 4f 04 2f 20  05 fc ce 7b 20 e4 66 0f  |.*.MO./ ...{ .f.|
-00000040  fa a1 2e da 62 7e fc 9d  c3 18 9d 1e 27 65 df 68  |....b~......'e.h|
-00000050  3f 95 29 d2 81 fb 52 0a  72 49 ed d6 14 6f ee 03  |?.)...R.rI...o..|
-00000060  1d 54 e8 18 17 e5 9e cf  9d ed bb 34 f8 31 c3 71  |.T.........4.1.q|
-00000070  1f 17 bf 9e c1 5f 7b 19  59 61 d3 e8 e6 3d d2 50  |....._{.Ya...=.P|
-00000080  68 8a 35 90 03 87 15 fa  37 3a a7 17 03 03 00 1e  |h.5.....7:......|
-00000090  97 51 35 9a c7 e8 9b b5  cd 35 59 8f 31 7b da 46  |.Q5......5Y.1{.F|
-000000a0  ea a9 37 53 55 1b 8f d3  58 38 28 bc b3 31 17 03  |..7SU...X8(..1..|
-000000b0  03 00 13 9d 7c 4c f7 f5  a3 ff c6 76 2a 91 fa e1  |....|L.....v*...|
-000000c0  6c 4e 8c 8c 6f 2a                                 |lN..o*|
+00000000  17 03 03 00 87 ba a5 c2  91 ad 1b 42 20 b0 cd 82  |...........B ...|
+00000010  3d 99 60 8f 9f 68 f3 3a  f5 b5 d6 11 a7 4d 33 c6  |=.`..h.:.....M3.|
+00000020  6f 22 07 64 1a 2d 22 17  18 a0 1e d4 c2 88 85 3f  |o".d.-"........?|
+00000030  47 5f 92 d2 ec b3 a7 f8  d7 62 f5 2a 75 7b ca f1  |G_.......b.*u{..|
+00000040  a7 0a bd 47 2a e3 a0 7b  15 4d dc f6 0d a8 99 f0  |...G*..{.M......|
+00000050  bf 02 0d 0e ec 4e aa 3c  6b c3 cb 90 b9 26 7a fd  |.....N.<k....&z.|
+00000060  0b 5e 76 d1 ed f0 31 e8  36 df 5e 22 9a 1f 89 01  |.^v...1.6.^"....|
+00000070  ea 8e be 29 c5 8f be f2  7f 8f af 1b e5 eb 87 dc  |...)............|
+00000080  59 3a b8 2e fa 6b 96 55  5c ff 7e 06 17 03 03 00  |Y:...k.U\.~.....|
+00000090  1e b7 4b a8 bf 31 6f 16  5e a6 40 ab 89 08 74 e0  |..K..1o.^.@...t.|
+000000a0  6d b0 ea ea c6 60 04 31  dd 9c 43 e6 b2 e9 f1 17  |m....`.1..C.....|
+000000b0  03 03 00 13 15 2a c2 ee  87 44 4e b5 c7 0b 6d 6b  |.....*...DN...mk|
+000000c0  76 96 c1 54 d4 f9 3d                              |v..T..=|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Server-TLSv13-ECDHE-ECDSA-AES
index f1539e2839..26ded5ccab 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Server-TLSv13-ECDHE-ECDSA-AES
@@ -1,93 +1,93 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 59 35 73 ce f7  |...........Y5s..|
-00000010  78 94 f6 bd 85 74 68 02  45 fd 8e b3 10 dc b2 dc  |x....th.E.......|
-00000020  80 ce 49 c1 0f 82 41 d2  0a 54 5d 20 2b 58 d8 7c  |..I...A..T] +X.||
-00000030  54 a4 ab 45 58 96 99 46  e2 a3 f3 f2 95 3f c0 2d  |T..EX..F.....?.-|
-00000040  55 d1 73 90 9e 15 2a f4  60 62 f7 f3 00 04 13 01  |U.s...*.`b......|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 ec 31 94 24 24  |............1.$$|
+00000010  c0 2c d1 9b d3 b1 5a f5  d6 cb 22 85 0b 81 77 e9  |.,....Z..."...w.|
+00000020  fb 6c 82 1d 49 2c 23 71  c3 a5 71 20 cc 60 08 08  |.l..I,#q..q .`..|
+00000030  2f 52 d8 95 0c 27 39 d9  7d 06 8f ee ad 1c 8e 48  |/R...'9.}......H|
+00000040  51 1e e6 ae 94 c9 89 7c  52 dd df 12 00 04 13 01  |Q......|R.......|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 e2  |-.....3.&.$... .|
-000000b0  6f 9c cd 54 39 56 7d 93  2a 6e e1 07 36 65 6d 4c  |o..T9V}.*n..6emL|
-000000c0  f1 ce bd 51 b3 e3 71 14  a9 90 c8 34 98 73 60     |...Q..q....4.s`|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 e7  |-.....3.&.$... .|
+000000b0  71 0c af 05 74 8e 37 8f  b3 da db 34 e3 54 72 78  |q...t.7....4.Trx|
+000000c0  95 da 57 8e 6e 78 1b bc  d7 06 23 de 6c 34 5f     |..W.nx....#.l4_|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 2b 58 d8 7c  |........... +X.||
-00000030  54 a4 ab 45 58 96 99 46  e2 a3 f3 f2 95 3f c0 2d  |T..EX..F.....?.-|
-00000040  55 d1 73 90 9e 15 2a f4  60 62 f7 f3 13 01 00 00  |U.s...*.`b......|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 cc 60 08 08  |........... .`..|
+00000030  2f 52 d8 95 0c 27 39 d9  7d 06 8f ee ad 1c 8e 48  |/R...'9.}......H|
+00000040  51 1e e6 ae 94 c9 89 7c  52 dd df 12 13 01 00 00  |Q......|R.......|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 85 5f 67 10 88 de  |..........._g...|
-00000090  22 82 8e d4 ea 9b 66 96  c3 a2 f5 d0 50 bc 5c ce  |".....f.....P.\.|
-000000a0  b7 17 03 03 02 22 06 d4  5d a7 93 32 d7 26 72 d5  |....."..]..2.&r.|
-000000b0  17 de e2 4b 17 80 65 ca  e6 3f 71 dc 61 13 dd a7  |...K..e..?q.a...|
-000000c0  33 77 30 d8 ca 67 ad db  ea 39 a9 a4 2c 0b b0 09  |3w0..g...9..,...|
-000000d0  7d d6 1f 45 ef 82 59 2e  bf 51 e1 9e 5c 0e 70 bb  |}..E..Y..Q..\.p.|
-000000e0  9b 92 80 f8 d2 2b b8 25  46 76 b2 3f 20 57 51 bb  |.....+.%Fv.? WQ.|
-000000f0  f8 d8 4e bd 1f d0 7f 5c  b9 72 a4 aa 81 7a b4 5c  |..N....\.r...z.\|
-00000100  8a bd cd 30 46 9e 59 9f  ab 6e 18 bc 78 3d 6b 21  |...0F.Y..n..x=k!|
-00000110  e1 e5 f6 0d e9 6c 3e c3  08 72 a3 ca d7 44 0f 2c  |.....l>..r...D.,|
-00000120  63 ff cc a3 29 a6 c5 b9  3c 57 be d4 3a 6c 8c 4a  |c...)...<W..:l.J|
-00000130  18 cf 3e 11 66 33 d6 a6  4a 5c a0 9b 53 8a 79 bd  |..>.f3..J\..S.y.|
-00000140  d4 4a 48 52 28 10 67 14  c0 74 6c fb e4 0b 79 b6  |.JHR(.g..tl...y.|
-00000150  c6 74 08 03 de 47 51 16  6d 63 fa bf a3 47 0e 34  |.t...GQ.mc...G.4|
-00000160  e2 d8 75 5b 0a 0c 49 8e  0d 39 45 62 70 b0 1b e4  |..u[..I..9Ebp...|
-00000170  5e d7 73 57 5d 22 44 16  aa 18 4a 07 48 bf c1 32  |^.sW]"D...J.H..2|
-00000180  ab 70 b2 41 5e 55 fc 05  cb da bd f2 02 aa d9 be  |.p.A^U..........|
-00000190  d9 e6 08 f3 61 06 df fb  29 cc 28 b2 d0 52 64 48  |....a...).(..RdH|
-000001a0  d7 8c 1f 21 68 dc 67 74  8b 39 a0 15 00 78 b9 37  |...!h.gt.9...x.7|
-000001b0  fe 89 f0 53 f7 92 66 4a  a5 91 72 ac 7d 7c 23 f7  |...S..fJ..r.}|#.|
-000001c0  50 82 22 76 27 fd 47 c0  2f ce e9 95 8a 0c 88 a6  |P."v'.G./.......|
-000001d0  a9 84 df 2a 28 5d 90 c1  20 66 10 ab f9 a1 30 9c  |...*(].. f....0.|
-000001e0  c8 25 0e 72 50 0a ee c6  df ae 1c 43 83 fc ca 18  |.%.rP......C....|
-000001f0  56 c9 f9 55 ba fb a7 13  f7 0e 37 0b ca 49 94 6e  |V..U......7..I.n|
-00000200  92 5b d4 ed 1c fd 21 e3  1e a0 1c 9c 66 b1 8a fb  |.[....!.....f...|
-00000210  ac 7e b2 31 2a d6 c1 ac  ea 8c 84 53 41 f8 cf dd  |.~.1*......SA...|
-00000220  bb 6c 91 72 37 bf 1d 02  99 3d 58 9e 1a ec 24 f8  |.l.r7....=X...$.|
-00000230  ae d0 59 63 6a f9 48 3b  c5 b2 13 e4 fa 1c 4f 8c  |..Ycj.H;......O.|
-00000240  13 80 ce 0a f8 68 39 4e  65 79 cf e2 12 cc b6 39  |.....h9Ney.....9|
-00000250  a6 d2 cb 6c 98 32 67 97  94 8d 1e fe d6 ce da 97  |...l.2g.........|
-00000260  0e b3 78 aa 03 c2 13 fa  9b e8 97 20 b7 62 15 6d  |..x........ .b.m|
-00000270  44 d1 f7 67 ff d3 e4 9f  db 3a e9 20 cd ae 77 a3  |D..g.....:. ..w.|
-00000280  88 e5 9b 49 31 67 b9 d0  4a 82 36 81 21 1d b8 d5  |...I1g..J.6.!...|
-00000290  f7 5a 10 99 6a 8b 5d e2  a8 e5 70 77 8a 25 14 e8  |.Z..j.]...pw.%..|
-000002a0  c5 46 55 6a 62 0f 24 b1  dc 55 d1 35 49 31 f0 fd  |.FUjb.$..U.5I1..|
-000002b0  8a 6f e4 99 e5 63 65 fd  bb ae f3 2a a8 89 fa 64  |.o...ce....*...d|
-000002c0  c5 2b 05 69 c9 68 ca e3  17 03 03 00 a4 74 cb 54  |.+.i.h.......t.T|
-000002d0  0a dd 78 7c b7 30 57 96  bc 02 49 43 26 d0 34 34  |..x|.0W...IC&.44|
-000002e0  20 2f 68 b0 14 20 51 75  6b 98 fb 95 c1 05 15 ac  | /h.. Quk.......|
-000002f0  ed 15 d6 d9 3c fb 7b bb  c6 9f 13 49 37 b7 43 59  |....<.{....I7.CY|
-00000300  69 be 0b a1 f8 df d4 e7  b5 5e f8 65 03 e3 f1 e9  |i........^.e....|
-00000310  84 6a b3 75 57 fc 36 6d  84 6b fb 35 04 10 0b 1e  |.j.uW.6m.k.5....|
-00000320  f2 0f 92 40 e9 41 b4 ca  10 4f 34 70 12 e6 26 81  |...@.A...O4p..&.|
-00000330  64 ea b5 ae 41 e4 1c 4b  d3 61 ee 7a 1f a2 96 c6  |d...A..K.a.z....|
-00000340  04 15 68 1e a6 20 aa 2c  c5 df 98 33 ff 06 7e fe  |..h.. .,...3..~.|
-00000350  f0 0c 29 fe e2 fc 53 aa  52 21 37 37 52 7e 26 e4  |..)...S.R!77R~&.|
-00000360  02 03 e8 95 a5 54 19 10  d5 b5 a2 b3 f0 ae e5 13  |.....T..........|
-00000370  e6 17 03 03 00 35 dc cb  96 a6 f9 61 79 5b 4f f9  |.....5.....ay[O.|
-00000380  58 65 17 0c 22 83 0f 36  c8 2a d9 fa 28 bb 5d a9  |Xe.."..6.*..(.].|
-00000390  96 45 f2 f2 73 ab de d5  85 5a 24 49 4a 9b 79 83  |.E..s....Z$IJ.y.|
-000003a0  76 15 81 ab bc 02 37 17  f2 aa 72 17 03 03 00 86  |v.....7...r.....|
-000003b0  1c da ba ea cb 26 ca a9  92 f9 3a 5a 4a 6e 2e 7e  |.....&....:ZJn.~|
-000003c0  2f 52 a2 b4 65 01 e5 de  8b 6c 89 ce 22 c6 0c 65  |/R..e....l.."..e|
-000003d0  36 0b 7a 0e 30 77 31 59  27 c4 4a 4a 53 5d 85 10  |6.z.0w1Y'.JJS]..|
-000003e0  6f 84 e5 52 1d 04 af 55  45 71 08 ac e1 d7 42 a2  |o..R...UEq....B.|
-000003f0  54 a7 9c db b9 56 5c af  08 57 76 a7 9d 1f d4 55  |T....V\..Wv....U|
-00000400  58 cc 31 82 ea 67 6c 04  f4 46 70 15 22 d4 59 43  |X.1..gl..Fp.".YC|
-00000410  c4 f2 e5 bc 09 e1 01 dd  81 bf 82 ea 0e cc 18 c0  |................|
-00000420  2c fd cc 45 dd 2d a3 fb  64 de 4e e2 ab c5 59 53  |,..E.-..d.N...YS|
-00000430  95 f3 a9 64 fc 59                                 |...d.Y|
+00000080  03 03 00 01 01 17 03 03  00 17 92 81 ab 83 5b 87  |..............[.|
+00000090  d9 40 d1 9d d9 85 46 94  48 fc 56 a5 d6 ed 37 c0  |.@....F.H.V...7.|
+000000a0  59 17 03 03 02 22 bb c7  b6 2f a0 48 1d ff a6 51  |Y....".../.H...Q|
+000000b0  b0 3d 0b bf b2 3e d3 a8  72 74 e7 27 4d 4a 9a f6  |.=...>..rt.'MJ..|
+000000c0  19 bc 79 fe 44 b5 c9 82  5f 29 7a f8 e3 7f 57 04  |..y.D..._)z...W.|
+000000d0  be ca b2 34 a7 56 85 46  8f 43 af 01 86 09 23 7b  |...4.V.F.C....#{|
+000000e0  bf 65 0d da 94 0c f3 91  bf 7d 6a e0 2b 46 64 fc  |.e.......}j.+Fd.|
+000000f0  36 ef b0 4b 9c 1c 5a 98  08 f6 52 b1 37 74 40 2f  |6..K..Z...R.7t@/|
+00000100  f4 d0 c7 3f cc 57 69 dd  81 58 63 f2 c5 66 a5 b6  |...?.Wi..Xc..f..|
+00000110  8f b6 8c 62 7f 07 8b e3  cc 00 be 96 7e 1f dc 36  |...b........~..6|
+00000120  5d 6c 37 2b 68 9c b5 b6  36 49 0d 83 02 fc c3 43  |]l7+h...6I.....C|
+00000130  8b a9 7a db b6 6b e8 35  2e a0 04 24 ce 90 d1 97  |..z..k.5...$....|
+00000140  11 cd b1 cf 2d 8f 62 ad  86 0e 72 8b 05 68 1a 97  |....-.b...r..h..|
+00000150  8c 4d 3e b4 e6 31 53 b6  5d 4b 5f 0f 90 13 47 be  |.M>..1S.]K_...G.|
+00000160  d0 87 53 f8 de 3f 32 06  ef 3c 2d 05 05 d5 9d bf  |..S..?2..<-.....|
+00000170  11 69 5b c4 9e e2 1d 1f  b5 c6 30 45 11 25 88 ed  |.i[.......0E.%..|
+00000180  fe fa 62 c5 63 86 91 f4  9e ec dc bb 3a 9a ad 7a  |..b.c.......:..z|
+00000190  2a b2 8d f1 1a bf f5 62  d6 83 4d bc 97 57 2e d3  |*......b..M..W..|
+000001a0  70 59 2f db d7 96 0a 84  21 b1 89 53 c9 7e cb 29  |pY/.....!..S.~.)|
+000001b0  b0 19 a8 66 78 a2 55 e9  2a f6 ff eb f4 5d 41 b6  |...fx.U.*....]A.|
+000001c0  ec 92 f1 70 0c 3e 82 66  1a 43 8e bd 44 80 37 03  |...p.>.f.C..D.7.|
+000001d0  6e 53 f5 f2 81 f8 10 9f  65 fe 6f 1b 5d 4d af aa  |nS......e.o.]M..|
+000001e0  12 e0 4a 58 47 13 e1 1a  71 db 37 f1 fc 12 7e 90  |..JXG...q.7...~.|
+000001f0  1e c9 7d 54 9d fd 86 19  d9 5d c4 49 0c 21 ba e4  |..}T.....].I.!..|
+00000200  98 a5 e2 48 de 82 7e 29  30 a3 e4 ce 51 a9 53 07  |...H..~)0...Q.S.|
+00000210  e1 f1 12 5e cd 62 df a0  3e 94 6b cc 74 92 d2 dc  |...^.b..>.k.t...|
+00000220  5c f1 20 73 e7 82 94 31  77 0f 9c 4a d6 50 63 fb  |\. s...1w..J.Pc.|
+00000230  0f da a5 56 61 d2 d6 21  64 e8 13 13 4a 89 a2 f6  |...Va..!d...J...|
+00000240  2e 2f 87 4e df 68 06 bf  28 5c 82 7b e4 6d 2b 22  |./.N.h..(\.{.m+"|
+00000250  6e a0 84 4b 57 dd 2b 74  fd 02 1a c0 8c 1b 46 78  |n..KW.+t......Fx|
+00000260  19 38 0c 82 77 7a 03 fb  90 be 0f 21 8f 5c 26 2d  |.8..wz.....!.\&-|
+00000270  9f 9c 02 9e 2a 10 04 c7  0d 3e 66 96 d1 8b 9d ea  |....*....>f.....|
+00000280  2c bb 0e a8 53 bd 8d 47  59 75 d4 48 8c a7 0a bb  |,...S..GYu.H....|
+00000290  83 f7 97 10 fc a2 2a 64  9b b6 4b 75 57 d8 9a 31  |......*d..KuW..1|
+000002a0  bf 10 8b 7f 46 07 b4 ee  45 57 9f 0c 07 ba b3 f1  |....F...EW......|
+000002b0  ae 1a f3 6b 0e a4 3d 96  5c 0f ea a8 02 9b 66 8d  |...k..=.\.....f.|
+000002c0  0c dd 73 d0 05 62 05 ce  17 03 03 00 a3 eb 0b 77  |..s..b.........w|
+000002d0  97 30 ff 18 7a ce fe dd  e2 30 30 eb e3 42 f0 f5  |.0..z....00..B..|
+000002e0  ca b4 c3 10 4a 9c ca 2c  59 ad a2 fb 70 d7 5f 08  |....J..,Y...p._.|
+000002f0  46 d7 12 b0 fb 91 6c 5f  bf 80 13 57 e3 d2 e2 c8  |F.....l_...W....|
+00000300  42 c9 69 da c1 16 df 91  71 d8 44 24 39 76 a6 94  |B.i.....q.D$9v..|
+00000310  f2 82 ea f5 d2 d2 56 37  d4 bd c3 e7 a2 e2 c7 f4  |......V7........|
+00000320  b1 b6 56 6a 6e f4 60 0b  cd 6b ca 4d fe 2e 51 c8  |..Vjn.`..k.M..Q.|
+00000330  1b cd 0c 9f 68 bf df 7f  bb ed b5 db 7b 2a b3 25  |....h.......{*.%|
+00000340  0d d9 b3 f2 31 93 f4 47  e9 5d 8f d0 24 e5 1f 47  |....1..G.]..$..G|
+00000350  20 85 de 13 cb 1f aa 10  71 cd 08 d2 0c 48 48 e8  | .......q....HH.|
+00000360  a7 8c 89 03 d0 c8 68 c6  63 52 99 99 e7 15 95 f0  |......h.cR......|
+00000370  17 03 03 00 35 e8 67 3c  86 c3 c5 70 79 89 bd c0  |....5.g<...py...|
+00000380  75 24 fd e2 06 e9 4e 17  86 b4 2a 65 71 61 76 5f  |u$....N...*eqav_|
+00000390  f2 15 2d 93 e0 37 80 51  1b 7f ed 23 4c 8a fe e0  |..-..7.Q...#L...|
+000003a0  7c 5c c8 bb 2f ed 54 53  75 2d 17 03 03 00 87 21  ||\../.TSu-.....!|
+000003b0  40 c2 5e 34 bb 57 92 94  4b 86 b0 22 fd 95 de d2  |@.^4.W..K.."....|
+000003c0  55 81 ff d6 36 17 cd b5  86 a4 55 1b 25 80 20 1b  |U...6.....U.%. .|
+000003d0  d0 e6 6e f5 64 24 00 58  35 71 26 27 0a a1 00 a0  |..n.d$.X5q&'....|
+000003e0  a7 01 d1 9a f9 26 c5 d8  ba d7 cd 5e 96 d3 9d 11  |.....&.....^....|
+000003f0  0e 58 e0 6f d1 e2 3c c4  f3 94 3b d0 3d 25 f3 b5  |.X.o..<...;.=%..|
+00000400  39 9c 1a 1e 2d ff e3 76  42 71 fb 9d 60 d9 06 75  |9...-..vBq..`..u|
+00000410  f9 54 59 25 68 49 be 23  36 b3 cb 39 1f 86 a3 6d  |.TY%hI.#6..9...m|
+00000420  0b 29 a9 65 e4 38 09 d2  1b c9 24 27 b4 e4 d8 61  |.).e.8....$'...a|
+00000430  41 50 ea aa 0d a3                                 |AP....|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 7f a3 e1 84 e2  |..........5.....|
-00000010  70 e6 78 59 28 33 22 53  0f 06 90 e1 a1 6f 46 f6  |p.xY(3"S.....oF.|
-00000020  08 9d 3e 3e 8b 72 f4 6d  54 93 f4 48 0f 58 81 37  |..>>.r.mT..H.X.7|
-00000030  e4 5e 2f 9c a1 5c 12 d6  eb f1 ea 8c 3f a5 5c 73  |.^/..\......?.\s|
+00000000  14 03 03 00 01 01 17 03  03 00 35 81 cb d8 28 ac  |..........5...(.|
+00000010  36 50 5e 4f d0 18 25 58  08 12 a9 92 56 09 87 bf  |6P^O..%X....V...|
+00000020  32 6a 78 d6 02 58 bb c3  fc fd 4b 75 a3 e4 65 38  |2jx..X....Ku..e8|
+00000030  cb 57 6e 85 96 f6 86 88  40 49 cd cf c8 55 72 61  |.Wn.....@I...Ura|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e ef 89 3a  8b 1e 0a 66 2f 47 6c 6c  |.......:...f/Gll|
-00000010  6f e4 f9 73 49 c7 b4 10  ad 02 fb af 24 52 a6 13  |o..sI.......$R..|
-00000020  44 82 91 17 03 03 00 13  b6 74 2f b1 40 b4 87 d0  |D........t/.@...|
-00000030  be 18 81 5a d2 11 92 98  77 df b0                 |...Z....w..|
+00000000  17 03 03 00 1e e3 d8 1c  54 b4 3d f5 8d 59 7a a9  |........T.=..Yz.|
+00000010  1d 35 6c fd 65 47 b9 42  63 8e 29 47 4f 15 06 f7  |.5l.eG.Bc.)GO...|
+00000020  5c 28 7f 17 03 03 00 13  47 bf 2d b9 cc ac ff 98  |\(......G.-.....|
+00000030  fe 4a 2e 84 0f 89 55 de  f0 ba ff                 |.J....U....|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-Ed25519 b/src/crypto/tls/testdata/Server-TLSv13-Ed25519
index 55000614f4..51d0c5781e 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-Ed25519
+++ b/src/crypto/tls/testdata/Server-TLSv13-Ed25519
@@ -1,75 +1,75 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 e4 a6 75 cd 50  |.............u.P|
-00000010  cf 9e 1a 2d bd 07 4f b7  b8 b8 5b 5a a2 99 6e b2  |...-..O...[Z..n.|
-00000020  a7 ab 20 cb ed dd 90 e2  d8 68 74 20 17 93 fe cb  |.. ......ht ....|
-00000030  83 63 5b 56 34 e7 a5 9f  c7 8b 32 e4 ce d7 32 4a  |.c[V4.....2...2J|
-00000040  bb 81 e6 b0 40 8e b5 7f  51 ce 76 78 00 04 13 03  |....@...Q.vx....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 a7 41 c9 a2 44  |............A..D|
+00000010  73 5a 14 73 33 7a 13 18  a4 65 bb d6 4b 68 21 6c  |sZ.s3z...e..Kh!l|
+00000020  44 3d 32 a7 c2 ce 52 dd  5a 2c 1b 20 08 03 9c b2  |D=2...R.Z,. ....|
+00000030  eb 7a 3b 52 2d 7f f3 6b  f1 03 e7 bf e8 85 c3 97  |.z;R-..k........|
+00000040  5f 67 6f b9 26 3a 12 16  d8 fd b0 6c 00 04 13 03  |_go.&:.....l....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 6b  |-.....3.&.$... k|
-000000b0  92 de 80 f6 61 5e df 18  d5 8f 19 3e 6c 20 24 ab  |....a^.....>l $.|
-000000c0  5e 57 8a fb 4f dd 47 1c  4f ed d1 dc 73 bd 61     |^W..O.G.O...s.a|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 df  |-.....3.&.$... .|
+000000b0  7a 7f 6b 20 c5 83 a8 62  9c 64 06 54 32 c0 8d 2a  |z.k ...b.d.T2..*|
+000000c0  9d ef 42 77 8e 9b 9a f4  eb ff a9 ef 95 a4 64     |..Bw..........d|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 17 93 fe cb  |........... ....|
-00000030  83 63 5b 56 34 e7 a5 9f  c7 8b 32 e4 ce d7 32 4a  |.c[V4.....2...2J|
-00000040  bb 81 e6 b0 40 8e b5 7f  51 ce 76 78 13 03 00 00  |....@...Q.vx....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 08 03 9c b2  |........... ....|
+00000030  eb 7a 3b 52 2d 7f f3 6b  f1 03 e7 bf e8 85 c3 97  |.z;R-..k........|
+00000040  5f 67 6f b9 26 3a 12 16  d8 fd b0 6c 13 03 00 00  |_go.&:.....l....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 48 2a 4c fe 04 1d  |..........H*L...|
-00000090  15 4c 91 6c dc b4 86 e0  c6 84 b9 97 b7 3e ed 5a  |.L.l.........>.Z|
-000000a0  b2 17 03 03 01 50 cf 44  f0 40 b3 a6 3f 5e 21 76  |.....P.D.@..?^!v|
-000000b0  5f 37 4e 32 2b cb 43 c5  d2 19 e0 61 b2 c7 5f c4  |_7N2+.C....a.._.|
-000000c0  38 b6 4b da 9d 22 ca 32  c9 ce 3c 97 98 4f 90 a1  |8.K..".2..<..O..|
-000000d0  89 76 60 0f 9d f2 15 35  41 63 48 89 14 75 b9 b6  |.v`....5AcH..u..|
-000000e0  e4 86 ab f6 55 28 5d 17  59 bc f6 08 fc 7b fd fc  |....U(].Y....{..|
-000000f0  ad e0 02 79 6c ca ba 5c  86 21 75 ea 12 7c 32 b9  |...yl..\.!u..|2.|
-00000100  9b 31 85 15 cb ed ae d8  33 ed 0c 0a c5 2f cb 8a  |.1......3..../..|
-00000110  89 72 e9 fd 84 10 a9 e4  44 02 c0 cc f9 46 89 f4  |.r......D....F..|
-00000120  bb ca 22 1b 10 f2 ee 5f  02 53 30 bf 0f ed 0c 8d  |.."...._.S0.....|
-00000130  3b 7d 6b 01 24 bf 9b 48  a0 62 3a 4b 8b 12 a1 a4  |;}k.$..H.b:K....|
-00000140  60 96 c6 3a 6c ac e1 cb  30 9e 68 59 c8 2f d1 b5  |`..:l...0.hY./..|
-00000150  a6 94 8e 34 02 46 a3 2a  7b cb e1 2b a5 71 7f 0a  |...4.F.*{..+.q..|
-00000160  43 19 5d 69 7c ed 9e 1e  2b c2 6d bd 0f ed da 08  |C.]i|...+.m.....|
-00000170  07 ea 04 50 59 38 b9 86  29 4a bd b1 3a 58 63 a9  |...PY8..)J..:Xc.|
-00000180  d3 fc 9d 9b a3 8d b3 64  21 03 e2 82 97 34 ff 7f  |.......d!....4..|
-00000190  4f 46 73 5f 1b 8e a3 5c  b0 d7 7f 9e 63 72 f8 b8  |OFs_...\....cr..|
-000001a0  40 ff 04 6a 66 7d 61 6a  29 61 2a 94 d0 e9 b9 76  |@..jf}aj)a*....v|
-000001b0  40 82 8e 7e 55 52 25 14  9c 26 d4 8d 64 d7 28 31  |@..~UR%..&..d.(1|
-000001c0  35 dd 2f a0 2a a0 5b 49  41 d0 4d ce 97 a7 ef e9  |5./.*.[IA.M.....|
-000001d0  f6 ab 63 45 5c a8 2a a7  65 73 88 97 7a 48 85 61  |..cE\.*.es..zH.a|
-000001e0  32 f7 6d 03 93 64 21 6b  9f 62 51 fa a3 b0 d6 e5  |2.m..d!k.bQ.....|
-000001f0  13 a3 7e 31 92 4e 17 03  03 00 59 bd e0 db be e6  |..~1.N....Y.....|
-00000200  09 9b 11 df 72 ef 0c 86  87 28 6c 3d 39 01 eb 1d  |....r....(l=9...|
-00000210  6b 88 91 ac 92 d6 11 87  fe 5d 44 a3 6b 39 31 a8  |k........]D.k91.|
-00000220  d8 d8 a5 36 c4 aa 1c bc  b1 95 4b 10 39 c1 55 0f  |...6......K.9.U.|
-00000230  2a 1e 1e 18 99 ba d2 4f  2a 08 4c 02 d5 b9 dc 48  |*......O*.L....H|
-00000240  b0 77 dd e1 6f e9 a9 c8  ec 08 5d b0 d1 ba 22 1f  |.w..o.....]...".|
-00000250  09 bc f2 97 17 03 03 00  35 1b 60 98 73 e4 18 4f  |........5.`.s..O|
-00000260  1e b4 71 38 b1 61 94 cb  51 ee 31 2d 2c c2 d9 5e  |..q8.a..Q.1-,..^|
-00000270  2c 1f 6f 63 2c 8d 1d a3  b1 9c 4e 28 76 9e 1d d8  |,.oc,.....N(v...|
-00000280  56 a2 ae c6 03 aa 48 81  58 a4 ad 13 79 92 17 03  |V.....H.X...y...|
-00000290  03 00 86 30 bc 76 ae 38  23 61 d9 6a b2 d0 4d 4b  |...0.v.8#a.j..MK|
-000002a0  76 63 3f 2d 18 ac 44 c6  00 56 33 3f 36 8d ac 28  |vc?-..D..V3?6..(|
-000002b0  26 40 13 7b a4 c3 c2 d0  8e 46 1c 4e 5f 76 ba 0f  |&@.{.....F.N_v..|
-000002c0  5b 00 b6 a7 be b1 12 a0  d5 b1 4e 5c 77 be a6 be  |[.........N\w...|
-000002d0  8b 2e a2 7e fb f5 b7 61  c5 7f 6d 52 96 e3 0d 99  |...~...a..mR....|
-000002e0  56 d9 7a 47 a4 e4 12 d2  09 22 98 33 74 2c 1a 2c  |V.zG.....".3t,.,|
-000002f0  a9 61 bf 34 1a 7f 44 d5  65 c0 a6 7b 7b 2c 86 ce  |.a.4..D.e..{{,..|
-00000300  09 cb 88 fc 88 09 90 5c  d7 5a e2 94 1f 1a 87 b4  |.......\.Z......|
-00000310  be 5c 3f 7d 42 1d f6 f2  22                       |.\?}B..."|
+00000080  03 03 00 01 01 17 03 03  00 17 9b 30 b4 6c 8e dc  |...........0.l..|
+00000090  d6 22 2d 4c 51 ce ee 9e  23 e8 b8 30 61 ef e7 05  |."-LQ...#..0a...|
+000000a0  72 17 03 03 01 50 aa 29  15 51 e2 93 a7 16 d0 dc  |r....P.).Q......|
+000000b0  ff 54 72 ba 92 a5 07 a9  9d 9f ef bb 35 3e 1a eb  |.Tr.........5>..|
+000000c0  9f 41 ae df 48 76 67 31  8d f3 25 16 34 b7 03 39  |.A..Hvg1..%.4..9|
+000000d0  7a fa d0 cf 36 38 ed 3d  57 85 d2 87 3e 23 4f 86  |z...68.=W...>#O.|
+000000e0  2c 64 cf 04 84 cf 3e e3  40 43 c9 06 22 b3 b6 ec  |,d....>.@C.."...|
+000000f0  af ef f3 55 e0 dd 59 fb  31 d1 59 85 f1 26 60 7c  |...U..Y.1.Y..&`||
+00000100  ca 40 ce 1a 4c c1 51 c0  5a 91 93 2c 6d 2d 69 3b  |.@..L.Q.Z..,m-i;|
+00000110  e2 f7 55 cd ce ff 9a 86  4a 47 d0 e7 6e 1f d1 fe  |..U.....JG..n...|
+00000120  4b 6e cb ba 6c df 4a fc  22 ce 17 6a 6e 09 d1 bc  |Kn..l.J."..jn...|
+00000130  c2 01 22 30 06 02 8a bf  95 8a ba 03 56 51 a3 ec  |.."0........VQ..|
+00000140  33 51 f6 09 4c 08 4d 76  af d1 88 e6 af 37 a9 1b  |3Q..L.Mv.....7..|
+00000150  c4 41 10 69 95 6c 76 1a  02 48 c9 9e 99 f3 c3 76  |.A.i.lv..H.....v|
+00000160  d6 c3 98 8b 44 67 e1 bf  43 c7 2a a5 a2 3b 16 26  |....Dg..C.*..;.&|
+00000170  bd 15 7c e7 51 dc 48 72  59 b7 d3 b0 91 84 b2 4f  |..|.Q.HrY......O|
+00000180  13 a7 81 2a 35 e3 e9 a5  5f 02 c4 cb 46 e3 6d 94  |...*5..._...F.m.|
+00000190  78 cc fc b7 49 70 ab ee  fe c3 bf 28 b4 93 c2 9f  |x...Ip.....(....|
+000001a0  b3 2a cb 64 fa f1 9d 0c  f3 bf 9e a5 7c b4 81 c2  |.*.d........|...|
+000001b0  16 44 97 01 af 5b 79 28  3c 76 cc c8 37 0a 7e 01  |.D...[y(<v..7.~.|
+000001c0  e3 a4 0d 70 80 27 d2 b0  95 a1 3a 41 9b eb b3 69  |...p.'....:A...i|
+000001d0  a8 6d cf c7 4b 5d 56 b4  ef 12 ee 66 23 54 d6 b3  |.m..K]V....f#T..|
+000001e0  9b 7e e0 9e 85 cb ee c9  42 e6 90 94 c9 24 34 e4  |.~......B....$4.|
+000001f0  9a 15 e2 59 52 0b 17 03  03 00 59 32 b4 d6 ff 40  |...YR.....Y2...@|
+00000200  f9 29 d9 da cd 4f 45 94  15 74 65 6b d3 b0 92 40  |.)...OE..tek...@|
+00000210  f0 26 6a 2b 62 8f e6 b5  ad 0c a6 2a 63 b2 70 40  |.&j+b......*c.p@|
+00000220  c2 6d 76 3f fc 89 92 0e  06 0f 86 75 ac dd 08 69  |.mv?.......u...i|
+00000230  1a 02 18 94 21 b3 ef 29  cd cf 3e f1 82 9c 5b 3d  |....!..)..>...[=|
+00000240  9f 98 21 72 b6 94 9c 7b  a1 e1 d3 79 13 8e 29 59  |..!r...{...y..)Y|
+00000250  16 0e e9 83 17 03 03 00  35 51 37 68 5d 81 9f 9d  |........5Q7h]...|
+00000260  6d 97 72 9b 5f a3 32 b7  39 ce 92 03 dd 60 22 95  |m.r._.2.9....`".|
+00000270  62 d9 59 34 cf 20 29 f4  76 33 95 3e b4 85 f2 77  |b.Y4. ).v3.>...w|
+00000280  79 45 d4 c5 a5 05 3a ba  45 c4 b6 82 9f dd 17 03  |yE....:.E.......|
+00000290  03 00 87 8d 95 fc c3 ee  c1 8d b6 a1 3b d8 58 2b  |............;.X+|
+000002a0  48 ce 92 46 b9 d4 f7 e7  82 07 e5 71 9f b4 c8 90  |H..F.......q....|
+000002b0  e3 80 8f 0f 28 49 98 ec  8d 6d 1e 49 7b 03 84 96  |....(I...m.I{...|
+000002c0  75 6a 13 b5 50 b8 1b cc  1a 26 0c 38 30 d6 fe c9  |uj..P....&.80...|
+000002d0  22 86 85 c2 83 eb a2 31  44 76 43 35 e2 cd a6 31  |"......1DvC5...1|
+000002e0  4e b1 f1 ce a8 40 ed b7  4d a5 e7 27 69 4b a0 55  |N....@..M..'iK.U|
+000002f0  97 f7 ab 7e 44 b6 f0 82  38 41 ca 72 92 d3 8f ef  |...~D...8A.r....|
+00000300  a7 94 f6 c7 a5 b5 db 69  ce 28 be 84 76 65 c1 3f  |.......i.(..ve.?|
+00000310  46 80 3e 2d a3 25 2a af  0f 1a                    |F.>-.%*...|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 a8 c1 2a 35 2b  |..........5..*5+|
-00000010  b7 9d 40 a2 db db 1e 1c  7d cb df ad f6 b1 0d d9  |..@.....}.......|
-00000020  f3 ee 0a d2 0a 9a d1 80  0a ed 5a 81 74 21 1c 47  |..........Z.t!.G|
-00000030  47 9e bf ad d0 ae 9f 44  a1 2f 1e 80 7e b1 8d 8e  |G......D./..~...|
+00000000  14 03 03 00 01 01 17 03  03 00 35 1a 6b 1b d9 09  |..........5.k...|
+00000010  91 0c be 43 0b a6 2e 07  12 bf de 90 f7 da a1 ce  |...C............|
+00000020  55 6b ac e6 04 bc ae c0  07 ec 42 81 80 f9 6c f2  |Uk........B...l.|
+00000030  ba d2 a6 f5 88 90 32 b5  1d f6 2f 6f b7 18 e5 61  |......2.../o...a|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e dd c9 3e  a8 df ba 5a 05 9d d3 3b  |.......>...Z...;|
-00000010  93 af fa f3 00 9f 82 65  6d 8a 74 9d a0 b0 c5 35  |.......em.t....5|
-00000020  9b f7 da 17 03 03 00 13  2b 7d 73 61 93 16 3a 51  |........+}sa..:Q|
-00000030  89 af 2f 18 54 b9 68 57  8b 09 3c                 |../.T.hW..<|
+00000000  17 03 03 00 1e e5 0e 95  85 e5 2f fd 5c b8 2f cc  |........../.\./.|
+00000010  e6 c7 2b e5 b6 9e 89 41  d2 fd 1e 2e 7a 88 12 0a  |..+....A....z...|
+00000020  52 0a ea 17 03 03 00 13  20 6d fc 36 6b 19 59 11  |R....... m.6k.Y.|
+00000030  08 8b 94 e1 5a ae a0 d7  c9 5b e1                 |....Z....[.|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ExportKeyingMaterial b/src/crypto/tls/testdata/Server-TLSv13-ExportKeyingMaterial
index 61111df36b..6edf872741 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ExportKeyingMaterial
+++ b/src/crypto/tls/testdata/Server-TLSv13-ExportKeyingMaterial
@@ -1,98 +1,98 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ce 01 00 00  ca 03 03 39 4a b1 b9 0d  |...........9J...|
-00000010  bc fb f7 50 c1 ef 39 a8  02 28 c7 9e f1 dd c2 a1  |...P..9..(......|
-00000020  e6 95 7d 34 ac 4d 86 18  76 0d 7d 20 02 f0 a9 12  |..}4.M..v.} ....|
-00000030  77 ae 33 00 de e8 fb 70  61 f4 e7 0d 25 a1 54 e6  |w.3....pa...%.T.|
-00000040  47 bc 2e 47 3b a2 f2 71  39 9d 41 56 00 04 13 03  |G..G;..q9.AV....|
+00000000  16 03 01 00 ce 01 00 00  ca 03 03 75 06 0d 3f 75  |...........u..?u|
+00000010  6a 2d c7 a2 a3 24 6a 0d  70 a8 53 f1 a3 29 e9 66  |j-...$j.p.S..).f|
+00000020  bc 47 f7 2f 0f 07 44 41  a4 0a 49 20 76 3d e8 a2  |.G./..DA..I v=..|
+00000030  7d 5f 02 b8 8e c1 c5 a4  10 9b 91 d0 f0 5b 42 a8  |}_...........[B.|
+00000040  c7 8f c6 30 07 54 04 1e  fb 1c bc 90 00 04 13 03  |...0.T..........|
 00000050  00 ff 01 00 00 7d 00 0b  00 04 03 00 01 02 00 0a  |.....}..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 16 00 00 00 17  00 00 00 0d 00 1e 00 1c  |................|
 00000080  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000090  08 04 08 05 08 06 04 01  05 01 06 01 00 2b 00 03  |.............+..|
 000000a0  02 03 04 00 2d 00 02 01  01 00 33 00 26 00 24 00  |....-.....3.&.$.|
-000000b0  1d 00 20 03 af 20 22 c6  47 d1 47 96 59 81 8f 04  |.. .. ".G.G.Y...|
-000000c0  c8 ab 20 ba 4e 27 f7 07  a4 e9 2a 80 36 a6 da e0  |.. .N'....*.6...|
-000000d0  7f f6 67                                          |..g|
+000000b0  1d 00 20 03 6e a7 8a de  dc 69 bb 21 92 0d 17 d5  |.. .n....i.!....|
+000000c0  c3 c3 82 d5 1d e8 12 f1  13 50 e0 2d 1b b5 dd b5  |.........P.-....|
+000000d0  0c 37 5e                                          |.7^|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 02 f0 a9 12  |........... ....|
-00000030  77 ae 33 00 de e8 fb 70  61 f4 e7 0d 25 a1 54 e6  |w.3....pa...%.T.|
-00000040  47 bc 2e 47 3b a2 f2 71  39 9d 41 56 13 03 00 00  |G..G;..q9.AV....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 76 3d e8 a2  |........... v=..|
+00000030  7d 5f 02 b8 8e c1 c5 a4  10 9b 91 d0 f0 5b 42 a8  |}_...........[B.|
+00000040  c7 8f c6 30 07 54 04 1e  fb 1c bc 90 13 03 00 00  |...0.T..........|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 74 af 85 6a 83 b4  |..........t..j..|
-00000090  ed a8 b6 b2 32 fe 1e 2a  2b c0 ee 15 c6 03 09 dc  |....2..*+.......|
-000000a0  05 17 03 03 02 6d 36 63  e1 89 03 b9 2b c0 d8 5e  |.....m6c....+..^|
-000000b0  15 2e 1d 41 d6 94 03 42  96 0c 8e e1 8f b1 6e 1a  |...A...B......n.|
-000000c0  b0 c4 63 67 63 00 e2 67  cf ba 2c f2 a1 89 22 e9  |..cgc..g..,...".|
-000000d0  91 cc 70 21 87 fa 55 2d  31 90 83 f9 45 cc 30 06  |..p!..U-1...E.0.|
-000000e0  dc eb 1e 41 27 2c 2c 9a  88 5d 4e 9a d1 ca f9 16  |...A',,..]N.....|
-000000f0  72 8f 48 ed 86 40 49 04  66 46 3c 5a 2c 71 98 a7  |r.H..@I.fF<Z,q..|
-00000100  6c bd 75 e3 f7 c0 31 c8  44 c6 c3 87 df 73 eb b3  |l.u...1.D....s..|
-00000110  a4 ef 65 af 53 b6 bd 62  8f 74 a9 9b 77 c7 f4 77  |..e.S..b.t..w..w|
-00000120  00 ad 69 2b f9 ca 3f a6  fb 66 99 39 a0 5f bc 10  |..i+..?..f.9._..|
-00000130  64 4a 15 b5 8a 88 86 2e  f3 2f b1 01 75 3c f5 c2  |dJ......./..u<..|
-00000140  86 89 42 7c 45 f2 b9 c4  45 09 22 dc 35 d9 e2 6d  |..B|E...E.".5..m|
-00000150  62 ba 0f 68 d3 39 bc 62  2a 5f 7e ec 88 88 c7 24  |b..h.9.b*_~....$|
-00000160  4b ea 08 0b 92 11 95 c6  4f cf 6b 99 ba 37 71 61  |K.......O.k..7qa|
-00000170  9a 29 c5 24 a4 0f 70 49  99 d4 0f 17 48 ac d8 ac  |.).$..pI....H...|
-00000180  27 cb 19 0d d7 ee ae 03  ce 4e 44 7b 75 02 a1 e6  |'........ND{u...|
-00000190  59 05 4a 16 5e b3 ec 92  e1 72 ee b2 79 1e 85 4a  |Y.J.^....r..y..J|
-000001a0  fa 84 58 1b 57 b1 af f9  36 dc a0 63 4f f9 b4 42  |..X.W...6..cO..B|
-000001b0  17 c1 08 88 4b ae 2e 56  e4 f6 58 6d 72 ea 8d 35  |....K..V..Xmr..5|
-000001c0  77 7f da 3a f2 54 fa c5  e0 02 f6 95 c5 91 d7 d5  |w..:.T..........|
-000001d0  3a f7 4b 72 48 d2 0f f5  de 04 c8 31 01 0d 43 64  |:.KrH......1..Cd|
-000001e0  1b 40 1c d5 9a 10 12 60  58 95 33 87 e4 05 f0 bf  |.@.....`X.3.....|
-000001f0  c9 66 86 7f 79 b9 cf 40  41 8d b0 ef 80 8b b0 27  |.f..y..@A......'|
-00000200  51 20 9b be 91 b1 39 35  05 98 6a 11 12 a5 ab c6  |Q ....95..j.....|
-00000210  bc e0 0d 6c 3f a9 f7 5c  2a 3b cd 80 c0 2a 35 a9  |...l?..\*;...*5.|
-00000220  73 39 c0 f0 8a 74 28 75  e0 7a f8 71 2e 6f 15 bf  |s9...t(u.z.q.o..|
-00000230  4e 38 b9 86 67 c3 7e bf  a8 42 06 ff d5 80 eb 85  |N8..g.~..B......|
-00000240  0e 21 64 b9 fe 42 02 d8  cd a2 49 56 ad 1a 80 3d  |.!d..B....IV...=|
-00000250  19 7a 64 52 c2 2c 3f be  b7 44 3d 37 12 4d 89 16  |.zdR.,?..D=7.M..|
-00000260  d0 53 3b c9 d2 a0 cc 31  d2 1e c7 81 d5 35 6b 65  |.S;....1.....5ke|
-00000270  d2 fb 2e 84 8e 6b 05 1f  0d 78 5a 66 b5 e0 62 39  |.....k...xZf..b9|
-00000280  8e fd a5 3b 7b db 89 5a  04 1f 48 b2 ed 52 d9 ed  |...;{..Z..H..R..|
-00000290  11 67 cd b6 85 e7 a9 52  48 13 35 b2 1e 41 d8 e5  |.g.....RH.5..A..|
-000002a0  91 2f 4d 14 47 04 fc e8  98 e6 54 04 9d 93 57 46  |./M.G.....T...WF|
-000002b0  cc 66 4b a8 85 c4 92 81  77 f1 02 5f 8d 49 e2 3a  |.fK.....w.._.I.:|
-000002c0  75 d0 26 dc b0 c7 14 24  67 e9 8b a1 16 2e 7e 36  |u.&....$g.....~6|
-000002d0  e1 7a 61 f9 b5 ea f4 3f  45 3f 32 9d 07 05 29 2d  |.za....?E?2...)-|
-000002e0  fc 85 98 7f 44 f7 72 6a  ee 3e 97 70 f3 c4 7c 73  |....D.rj.>.p..|s|
-000002f0  7f 45 46 6b 87 36 ef ea  7f c2 03 5e 85 7c 07 be  |.EFk.6.....^.|..|
-00000300  ae 29 60 b9 32 ae b0 92  3f 7c ca ff 57 18 34 7c  |.)`.2...?|..W.4||
-00000310  7f d4 6a 17 03 03 00 99  73 a8 79 d9 d9 e4 fe 9f  |..j.....s.y.....|
-00000320  e8 f0 de 0c f7 28 e3 03  49 a5 6c 41 e9 cd a9 77  |.....(..I.lA...w|
-00000330  e1 7b 81 45 46 17 06 0f  46 4a 3d 62 b6 f8 ef 18  |.{.EF...FJ=b....|
-00000340  89 78 1c 4b 62 65 f9 92  cd 47 5a 39 df 6a d3 a0  |.x.Kbe...GZ9.j..|
-00000350  22 5d b6 0d 5a d4 04 f6  dc 6d a8 62 ca e6 51 6a  |"]..Z....m.b..Qj|
-00000360  45 9b 59 93 74 ce a5 6b  2e f2 9b 63 ab b0 26 0a  |E.Y.t..k...c..&.|
-00000370  3b 56 fa 0a 00 cf db bf  eb 0f ff 65 f7 95 91 d6  |;V.........e....|
-00000380  a1 ba 51 e5 24 40 d0 95  f0 dd cb a9 56 bc 26 de  |..Q.$@......V.&.|
-00000390  28 c5 4a 26 30 35 32 c8  87 7f 1e 42 2e 6f 81 ea  |(.J&052....B.o..|
-000003a0  4c c2 51 b6 ab 87 51 95  90 dd 6c dd 1a 32 8c 5f  |L.Q...Q...l..2._|
-000003b0  1e 17 03 03 00 35 5d 6c  8e 76 00 07 c4 97 e2 8b  |.....5]l.v......|
-000003c0  af a5 95 8c 49 ff c7 0c  ea 86 27 3b b8 1d 2f 8b  |....I.....';../.|
-000003d0  e6 30 83 d0 0f a3 fa 29  55 10 7a d6 29 24 d5 a7  |.0.....)U.z.)$..|
-000003e0  5d 30 0b 8a 70 18 c3 50  56 aa 2a 17 03 03 00 86  |]0..p..PV.*.....|
-000003f0  91 18 8b 96 37 54 d5 43  31 aa 6a 56 72 a2 c6 6e  |....7T.C1.jVr..n|
-00000400  af ef 6a 2e 68 e0 01 74  4c 43 15 36 37 a0 23 35  |..j.h..tLC.67.#5|
-00000410  38 9e 6f b8 df 86 3a 2e  63 8f c9 63 cd c9 68 86  |8.o...:.c..c..h.|
-00000420  90 fd 7e 5d 30 b3 ac 86  be 50 a9 4f 41 6a f9 31  |..~]0....P.OAj.1|
-00000430  bc 4e 9f f6 e8 e7 f9 7d  e6 1a e0 16 89 d3 60 1c  |.N.....}......`.|
-00000440  98 21 83 0d 88 c1 4c f6  b7 ef 92 77 f8 72 40 be  |.!....L....w.r@.|
-00000450  7e c7 1d 48 67 8f 1d f9  a6 8c 2d bf c8 57 6b d4  |~..Hg.....-..Wk.|
-00000460  ee 23 0d 0a 3a 7a e8 b4  90 6e ea 3f 52 a8 40 e4  |.#..:z...n.?R.@.|
-00000470  24 6d e3 c1 df 69                                 |$m...i|
+00000080  03 03 00 01 01 17 03 03  00 17 dc 9d 2a 20 98 79  |............* .y|
+00000090  e4 c3 d3 63 16 d2 a6 33  a2 69 28 de 8a 3f ca cc  |...c...3.i(..?..|
+000000a0  31 17 03 03 02 6d 29 19  ee 89 44 4c 91 a0 12 ec  |1....m)...DL....|
+000000b0  cc 97 3f 1d ac 8a d5 d6  df d4 32 96 c0 5f d4 f3  |..?.......2.._..|
+000000c0  11 9c 57 71 90 0c e3 09  e4 7c 9f 8d af f4 97 82  |..Wq.....|......|
+000000d0  68 4e e0 c1 84 d6 ca 92  e1 a2 95 d8 a1 7b 85 b1  |hN...........{..|
+000000e0  da 45 54 cf d4 c2 ef b8  28 7e be 5f e7 9e ac 61  |.ET.....(~._...a|
+000000f0  0b 02 af 39 ed bd 99 c5  47 ea 05 37 ab 4d 35 0f  |...9....G..7.M5.|
+00000100  b0 77 20 8d 45 93 a3 02  45 c4 b6 66 3b 35 0e ff  |.w .E...E..f;5..|
+00000110  61 a1 89 fd d7 6a 96 01  15 70 a5 36 97 58 df 2f  |a....j...p.6.X./|
+00000120  db 19 2f 4e bf 5f 48 53  a2 88 4c cd 92 30 32 5d  |../N._HS..L..02]|
+00000130  d4 8a 3a 38 18 68 c9 89  b5 a7 74 1e 44 0e 5d 89  |..:8.h....t.D.].|
+00000140  41 94 f5 30 bf d1 86 6f  50 f3 3b 3e 28 c5 f3 65  |A..0...oP.;>(..e|
+00000150  6f c5 01 10 7e e8 e2 9c  cc 93 53 0d 09 57 6b cd  |o...~.....S..Wk.|
+00000160  db 03 b2 26 c4 5c 33 5c  f3 89 e9 2f 2c e7 b3 1b  |...&.\3\.../,...|
+00000170  b5 05 f5 13 48 d2 f0 dd  9b fd aa a7 ee d9 6c 13  |....H.........l.|
+00000180  39 2d c9 d9 3b c0 e1 8a  57 d3 7c bf 3a 8b 18 a2  |9-..;...W.|.:...|
+00000190  a6 af 36 e4 4e 94 3e e7  8a 35 ef 02 4b 61 ef 68  |..6.N.>..5..Ka.h|
+000001a0  f0 2c 99 31 84 fa d5 3b  a7 e9 29 56 82 0c 68 41  |.,.1...;..)V..hA|
+000001b0  11 e9 a3 ea d3 5e 1e f6  e3 5c cb 90 38 22 5a 65  |.....^...\..8"Ze|
+000001c0  10 62 10 f5 aa fe eb 63  dc 31 df 38 37 8f 79 2e  |.b.....c.1.87.y.|
+000001d0  36 da 4c 04 c7 ed bb 7f  2f bd 4b 9f ba c5 d1 17  |6.L...../.K.....|
+000001e0  eb d9 2a 44 6d bb 56 1f  53 db 32 2f 68 a3 25 c4  |..*Dm.V.S.2/h.%.|
+000001f0  b1 9f 42 bd 12 20 67 77  55 56 c4 5c 6b 51 81 0f  |..B.. gwUV.\kQ..|
+00000200  dd fe 82 65 33 8c ab a3  bd 4f 2f f4 21 c4 a5 2d  |...e3....O/.!..-|
+00000210  98 8d c6 df 64 18 f6 2b  09 b5 92 9f a3 d6 be 78  |....d..+.......x|
+00000220  ee a7 e2 20 e0 62 9f 5d  3b 30 07 2c ad 43 64 f6  |... .b.];0.,.Cd.|
+00000230  08 23 e5 a5 de 07 4d e0  03 98 1e 36 d9 8a d4 64  |.#....M....6...d|
+00000240  c1 67 b9 7c c6 8a b6 d7  73 76 d9 43 99 97 a5 53  |.g.|....sv.C...S|
+00000250  e1 77 50 07 b6 e6 9c 73  14 a4 e5 5c 05 d4 e3 be  |.wP....s...\....|
+00000260  f0 15 60 6a fe 0b 4b ee  78 a3 63 c7 8e 0e 20 49  |..`j..K.x.c... I|
+00000270  73 8e e0 01 f5 4c 8a 6f  4f 2d c0 a7 42 a2 92 e0  |s....L.oO-..B...|
+00000280  f4 87 10 a9 06 f7 4f 71  e7 61 86 df 6c 4d 9d ac  |......Oq.a..lM..|
+00000290  fe d0 0b 7a 44 fa 54 3d  00 f4 37 f8 48 87 05 ff  |...zD.T=..7.H...|
+000002a0  29 40 f1 c7 d0 c0 bc f3  8a 7b 81 39 61 85 75 4d  |)@.......{.9a.uM|
+000002b0  d0 97 59 1a a1 a0 e1 62  b8 ca bb 61 b1 e8 4f 92  |..Y....b...a..O.|
+000002c0  a7 ad cc 03 3e fa 72 7f  32 69 91 1b 47 42 ad 97  |....>.r.2i..GB..|
+000002d0  66 d9 67 e2 92 d8 19 b4  36 88 fc 82 1e 7d 30 5c  |f.g.....6....}0\|
+000002e0  56 7d 58 1a b9 2d 16 01  a0 35 83 5f 51 b2 27 1f  |V}X..-...5._Q.'.|
+000002f0  76 b4 b2 31 af da 81 c9  c1 11 03 c3 7a b7 b0 7b  |v..1........z..{|
+00000300  5b d0 6c 48 28 ce 3c 4e  62 fc 13 79 05 84 2c 1f  |[.lH(.<Nb..y..,.|
+00000310  8e 47 04 17 03 03 00 99  88 02 bd 4b b1 56 f4 d1  |.G.........K.V..|
+00000320  0c 60 cd 1a 09 05 d7 c2  f8 8f 71 59 d7 f2 11 16  |.`........qY....|
+00000330  ae 9d 12 03 c8 eb 65 3d  c2 0f 3e 59 2b 80 62 09  |......e=..>Y+.b.|
+00000340  89 e4 cc 49 6f 5d 86 18  14 d4 7f 88 f6 c2 db 7b  |...Io].........{|
+00000350  ba 26 70 1b 4d 1f ff ba  0d 30 38 69 8e d2 4e f9  |.&p.M....08i..N.|
+00000360  5d 14 00 c0 99 da 97 27  70 eb e5 aa 97 6f 99 ae  |]......'p....o..|
+00000370  dd 13 27 c4 c3 17 8f ee  8a c8 f5 11 68 ab 93 16  |..'.........h...|
+00000380  03 c3 02 24 b5 bd 13 23  0d 23 72 be 40 0b fd 5e  |...$...#.#r.@..^|
+00000390  d5 04 b8 1e 17 11 6f ba  27 03 91 71 95 85 5d 6d  |......o.'..q..]m|
+000003a0  87 f5 ea ab 37 8d 5d d3  81 4e 87 23 4c e0 5e 0d  |....7.]..N.#L.^.|
+000003b0  e5 17 03 03 00 35 c3 3a  23 87 b3 3a b0 cf 1a 6e  |.....5.:#..:...n|
+000003c0  1e 27 05 b1 a9 99 8d c2  03 b8 a2 43 5f b1 5e df  |.'.........C_.^.|
+000003d0  28 57 71 71 bd ff 15 89  5a 7f 62 82 76 e1 6e 7f  |(Wqq....Z.b.v.n.|
+000003e0  a6 3a 92 ef ea 70 d3 fa  91 26 ff 17 03 03 00 87  |.:...p...&......|
+000003f0  07 2a ca d2 23 9e bb bb  4a 1c 47 27 94 38 ae cb  |.*..#...J.G'.8..|
+00000400  a2 b0 5e f8 0f 78 9a da  c4 79 10 c7 15 8d 83 d5  |..^..x...y......|
+00000410  d6 18 dd 76 64 08 24 6b  87 88 b7 e5 b7 f6 c2 b2  |...vd.$k........|
+00000420  a7 e5 5d 45 d3 00 c2 e0  40 b4 bb 6e c0 82 3f 68  |..]E....@..n..?h|
+00000430  92 b7 60 fb 77 9c bc 6d  c7 3d 31 39 93 1b a4 05  |..`.w..m.=19....|
+00000440  f8 f6 ce 94 51 79 f5 e6  9a a4 f7 11 bc 6d 14 b7  |....Qy.......m..|
+00000450  ef a1 d5 7f a0 ff b7 86  2a fd c2 94 29 ad 70 5b  |........*...).p[|
+00000460  87 04 89 53 40 d1 db df  c0 c6 7f ad 00 3d 76 99  |...S@........=v.|
+00000470  d3 be 9a 18 9c 4e de                              |.....N.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 87 2f 92 b1 98  |..........5./...|
-00000010  a9 a6 61 f0 0e a9 a9 69  4b 19 4a 2f 3e 53 15 da  |..a....iK.J/>S..|
-00000020  bb 42 e4 57 2a eb b1 4a  44 7b 04 ec f4 74 80 5a  |.B.W*..JD{...t.Z|
-00000030  71 b7 9a 6e cc 7d 39 13  06 69 67 38 93 6a a3 7b  |q..n.}9..ig8.j.{|
+00000000  14 03 03 00 01 01 17 03  03 00 35 14 13 c7 27 80  |..........5...'.|
+00000010  36 50 a1 44 7f 10 cc ff  a5 11 c9 a5 00 21 54 79  |6P.D.........!Ty|
+00000020  0e 9e f7 21 ed be 38 20  b4 ff 9d 3c 26 fc a0 d2  |...!..8 ...<&...|
+00000030  bb 80 34 aa 5c 50 1c e7  b3 df 06 7c a1 eb 4c d0  |..4.\P.....|..L.|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 64 1f a9  42 05 04 ff 73 8f 9b 69  |.....d..B...s..i|
-00000010  9f d9 a1 04 81 3f 55 5c  bd 3f be 5b 6f 9b 18 a3  |.....?U\.?.[o...|
-00000020  4e a3 d2 17 03 03 00 13  51 81 49 fd 90 48 4d 7d  |N.......Q.I..HM}|
-00000030  2d 69 59 49 28 e2 74 42  6b c5 3c                 |-iYI(.tBk.<|
+00000000  17 03 03 00 1e 18 a4 c9  96 e2 fe b5 3b b1 e0 51  |............;..Q|
+00000010  a4 10 a7 46 16 17 cb 27  4c a8 24 1b 89 ac 9b d8  |...F...'L.$.....|
+00000020  32 66 f6 17 03 03 00 13  e0 ea b8 39 49 8d 9f 02  |2f.........9I...|
+00000030  40 c2 44 4e 6c 57 a3 56  5b 01 a8                 |@.DNlW.V[..|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-HelloRetryRequest b/src/crypto/tls/testdata/Server-TLSv13-HelloRetryRequest
index 226128ef76..4e55f8a834 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-HelloRetryRequest
+++ b/src/crypto/tls/testdata/Server-TLSv13-HelloRetryRequest
@@ -1,123 +1,123 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 c4 01 00 00  c0 03 03 b6 e2 d7 ef 81  |................|
-00000010  d8 02 c4 f8 8d b5 88 76  3a 4f 3c fe fd d9 35 0c  |.......v:O<...5.|
-00000020  10 76 3f 81 8c 8f 1b c1  1f c6 7b 20 b2 63 8a 91  |.v?.......{ .c..|
-00000030  ad 66 d8 f5 b9 b8 87 7c  82 cf af 47 e2 dd 55 1e  |.f.....|...G..U.|
-00000040  29 48 6d ae 86 97 e7 95  0c 25 53 cd 00 04 13 03  |)Hm......%S.....|
+00000000  16 03 01 00 c4 01 00 00  c0 03 03 8b 5c 1c 09 f2  |............\...|
+00000010  ae 17 46 82 d6 83 0c 4a  6f 95 1d 23 26 18 cf eb  |..F....Jo..#&...|
+00000020  35 e6 e1 8e 83 5f a9 50  69 c3 dd 20 c6 7e ae dd  |5...._.Pi.. .~..|
+00000030  96 1f 04 2f de 44 1c 3f  e9 ad ec 77 e6 62 ae 46  |.../.D.?...w.b.F|
+00000040  7c e7 f5 78 3f 69 ed a1  04 7f 6c 44 00 04 13 03  ||..x?i....lD....|
 00000050  00 ff 01 00 00 73 00 0b  00 04 03 00 01 02 00 0a  |.....s..........|
 00000060  00 06 00 04 00 1d 00 17  00 16 00 00 00 17 00 00  |................|
 00000070  00 0d 00 1e 00 1c 04 03  05 03 06 03 08 07 08 08  |................|
 00000080  08 09 08 0a 08 0b 08 04  08 05 08 06 04 01 05 01  |................|
 00000090  06 01 00 2b 00 03 02 03  04 00 2d 00 02 01 01 00  |...+......-.....|
-000000a0  33 00 26 00 24 00 1d 00  20 5a d9 01 21 1a 22 a3  |3.&.$... Z..!.".|
-000000b0  3e c0 df 4e ce a1 bc 1d  17 7f 64 85 56 34 69 fc  |>..N......d.V4i.|
-000000c0  c8 ad 31 54 90 67 f0 c8  0d                       |..1T.g...|
+000000a0  33 00 26 00 24 00 1d 00  20 04 32 9e 84 68 22 05  |3.&.$... .2..h".|
+000000b0  f1 d1 15 81 6a a6 ab 54  0d 89 1f 6f a2 6c 76 0d  |....j..T...o.lv.|
+000000c0  73 2e 54 f7 e9 84 11 b1  1e                       |s.T......|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 58 02 00 00  54 03 03 cf 21 ad 74 e5  |....X...T...!.t.|
 00000010  9a 61 11 be 1d 8c 02 1e  65 b8 91 c2 a2 11 16 7a  |.a......e......z|
-00000020  bb 8c 5e 07 9e 09 e2 c8  a8 33 9c 20 b2 63 8a 91  |..^......3. .c..|
-00000030  ad 66 d8 f5 b9 b8 87 7c  82 cf af 47 e2 dd 55 1e  |.f.....|...G..U.|
-00000040  29 48 6d ae 86 97 e7 95  0c 25 53 cd 13 03 00 00  |)Hm......%S.....|
+00000020  bb 8c 5e 07 9e 09 e2 c8  a8 33 9c 20 c6 7e ae dd  |..^......3. .~..|
+00000030  96 1f 04 2f de 44 1c 3f  e9 ad ec 77 e6 62 ae 46  |.../.D.?...w.b.F|
+00000040  7c e7 f5 78 3f 69 ed a1  04 7f 6c 44 13 03 00 00  ||..x?i....lD....|
 00000050  0c 00 2b 00 02 03 04 00  33 00 02 00 17 14 03 03  |..+.....3.......|
 00000060  00 01 01                                          |...|
 >>> Flow 3 (client to server)
 00000000  14 03 03 00 01 01 16 03  03 00 e5 01 00 00 e1 03  |................|
-00000010  03 b6 e2 d7 ef 81 d8 02  c4 f8 8d b5 88 76 3a 4f  |.............v:O|
-00000020  3c fe fd d9 35 0c 10 76  3f 81 8c 8f 1b c1 1f c6  |<...5..v?.......|
-00000030  7b 20 b2 63 8a 91 ad 66  d8 f5 b9 b8 87 7c 82 cf  |{ .c...f.....|..|
-00000040  af 47 e2 dd 55 1e 29 48  6d ae 86 97 e7 95 0c 25  |.G..U.)Hm......%|
-00000050  53 cd 00 04 13 03 00 ff  01 00 00 94 00 0b 00 04  |S...............|
+00000010  03 8b 5c 1c 09 f2 ae 17  46 82 d6 83 0c 4a 6f 95  |..\.....F....Jo.|
+00000020  1d 23 26 18 cf eb 35 e6  e1 8e 83 5f a9 50 69 c3  |.#&...5...._.Pi.|
+00000030  dd 20 c6 7e ae dd 96 1f  04 2f de 44 1c 3f e9 ad  |. .~...../.D.?..|
+00000040  ec 77 e6 62 ae 46 7c e7  f5 78 3f 69 ed a1 04 7f  |.w.b.F|..x?i....|
+00000050  6c 44 00 04 13 03 00 ff  01 00 00 94 00 0b 00 04  |lD..............|
 00000060  03 00 01 02 00 0a 00 06  00 04 00 1d 00 17 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
 000000a0  2d 00 02 01 01 00 33 00  47 00 45 00 17 00 41 04  |-.....3.G.E...A.|
-000000b0  e1 eb a5 5f 51 7c 2d b5  1b b6 72 89 12 b6 57 3f  |..._Q|-...r...W?|
-000000c0  f8 d2 52 29 34 65 ed 94  65 8c 7b 99 b0 fa 46 3e  |..R)4e..e.{...F>|
-000000d0  b4 bc 29 2d c7 99 07 a6  a5 d4 71 0c d1 9b a0 ea  |..)-......q.....|
-000000e0  a6 93 cc d2 5b 22 6a 56  ea cc cd f5 36 11 ab 27  |....["jV....6..'|
+000000b0  9a 8b a5 48 2d ed 77 c9  7a ed 71 4e 73 66 2a 90  |...H-.w.z.qNsf*.|
+000000c0  c9 16 cc 94 7b 60 50 35  23 6f e9 55 2a 3e 0a 3c  |....{`P5#o.U*>.<|
+000000d0  04 de ca 1a 48 42 92 98  0b d5 a4 7a 38 41 dd 5c  |....HB.....z8A.\|
+000000e0  de 02 c8 62 18 88 12 d5  70 6e 26 c5 f0 1e 03 49  |...b....pn&....I|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 9b 02 00 00  97 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 b2 63 8a 91  |........... .c..|
-00000030  ad 66 d8 f5 b9 b8 87 7c  82 cf af 47 e2 dd 55 1e  |.f.....|...G..U.|
-00000040  29 48 6d ae 86 97 e7 95  0c 25 53 cd 13 03 00 00  |)Hm......%S.....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 c6 7e ae dd  |........... .~..|
+00000030  96 1f 04 2f de 44 1c 3f  e9 ad ec 77 e6 62 ae 46  |.../.D.?...w.b.F|
+00000040  7c e7 f5 78 3f 69 ed a1  04 7f 6c 44 13 03 00 00  ||..x?i....lD....|
 00000050  4f 00 2b 00 02 03 04 00  33 00 45 00 17 00 41 04  |O.+.....3.E...A.|
 00000060  1e 18 37 ef 0d 19 51 88  35 75 71 b5 e5 54 5b 12  |..7...Q.5uq..T[.|
 00000070  2e 8f 09 67 fd a7 24 20  3e b2 56 1c ce 97 28 5e  |...g..$ >.V...(^|
 00000080  f8 2b 2d 4f 9e f1 07 9f  6c 4b 5b 83 56 e2 32 42  |.+-O....lK[.V.2B|
 00000090  e9 58 b6 d7 49 a6 b5 68  1a 41 03 56 6b dc 5a 89  |.X..I..h.A.Vk.Z.|
-000000a0  17 03 03 00 17 2c 0c 1e  66 0b 0c 3f a8 89 35 e9  |.....,..f..?..5.|
-000000b0  8b a3 29 c2 df 2c 92 62  32 72 b7 6e 17 03 03 02  |..)..,.b2r.n....|
-000000c0  6d 0a 1a 24 4c 7a d2 e8  0d 40 ce e3 f9 9a b6 52  |m..$Lz...@.....R|
-000000d0  80 09 5a 47 c5 e9 be 5d  e8 53 37 2e 3e 54 90 68  |..ZG...].S7.>T.h|
-000000e0  b9 d2 0c c4 aa 6a 84 07  9b 76 23 d7 ca e7 47 a7  |.....j...v#...G.|
-000000f0  86 b4 b6 e6 62 75 ad 62  67 9b 0a 9c 63 8f 0b 67  |....bu.bg...c..g|
-00000100  8d 36 81 07 29 a5 89 54  c6 3e c8 11 46 c9 7c 10  |.6..)..T.>..F.|.|
-00000110  4c da a0 e0 65 2c 70 68  61 d6 bf 1c 85 28 7d b2  |L...e,pha....(}.|
-00000120  ce ff 9f 32 1d 74 71 fa  87 17 06 a7 24 e9 16 cc  |...2.tq.....$...|
-00000130  59 74 c6 f4 b8 9b c8 9e  f3 9b 5c 26 f6 ec a1 93  |Yt........\&....|
-00000140  7f 5c 3f 70 42 b8 a0 11  16 37 87 99 b0 f1 d4 6b  |.\?pB....7.....k|
-00000150  d3 66 59 1b 32 0e 8d 8e  12 26 3d d7 e2 18 65 bc  |.fY.2....&=...e.|
-00000160  bd 80 7f 1f 8b e0 e9 34  4d 33 48 3d 15 a2 c1 e2  |.......4M3H=....|
-00000170  d4 79 04 d9 d5 ec ee 62  80 06 76 b0 09 81 71 d4  |.y.....b..v...q.|
-00000180  5e a7 8a c1 50 72 0d 78  59 c7 4f 70 29 65 da 7c  |^...Pr.xY.Op)e.||
-00000190  05 28 6e 94 ef 39 19 17  39 f9 16 09 25 e1 0e 3b  |.(n..9..9...%..;|
-000001a0  17 20 56 01 f4 cc 0e 05  2c 90 d5 34 ed b0 bd 7e  |. V.....,..4...~|
-000001b0  b8 41 23 c3 09 9a 89 d1  69 89 cc d1 0a e1 04 81  |.A#.....i.......|
-000001c0  8a dd 53 6b a0 52 4c 40  cb 14 7f d6 48 17 76 bb  |..Sk.RL@....H.v.|
-000001d0  c1 ee 17 88 71 b2 04 73  66 5d 2b 09 12 ce 72 ed  |....q..sf]+...r.|
-000001e0  0a 68 af 4c 87 7f 79 48  a6 f4 7e f5 fd 77 78 2a  |.h.L..yH..~..wx*|
-000001f0  69 c1 9b bb c2 b9 00 7e  22 d3 fc 75 60 d4 5a c4  |i......~"..u`.Z.|
-00000200  bc 90 f8 25 7c 3d ce 57  ef a9 a8 4e 27 06 18 30  |...%|=.W...N'..0|
-00000210  cb c0 98 87 82 54 a8 27  5c 2b d1 88 86 61 85 92  |.....T.'\+...a..|
-00000220  02 83 c1 b9 bd fd 28 ee  9e bd 9d 6d 48 fa cb df  |......(....mH...|
-00000230  d2 51 44 52 fa 3f d3 d6  b7 8a 70 99 13 99 35 41  |.QDR.?....p...5A|
-00000240  78 dc 23 55 34 11 38 c9  6d 36 df a0 fd 63 8e 36  |x.#U4.8.m6...c.6|
-00000250  d2 e1 a0 eb 78 62 58 ef  af 6c a7 97 41 06 94 2f  |....xbX..l..A../|
-00000260  54 c0 3b d1 3f 9f ff 29  5a 57 84 a6 55 7f 9e 97  |T.;.?..)ZW..U...|
-00000270  08 b9 ec 69 87 91 8e ef  4c 9f 86 28 78 92 b3 74  |...i....L..(x..t|
-00000280  a6 cf 13 bc fd 51 94 de  74 32 41 a3 98 2e 2c 90  |.....Q..t2A...,.|
-00000290  40 d5 5d 73 f7 0c 0a f2  74 37 46 fa 69 ce ac 93  |@.]s....t7F.i...|
-000002a0  5a f6 04 a9 77 89 a8 90  50 b9 74 53 f1 90 bb d8  |Z...w...P.tS....|
-000002b0  c8 e2 39 13 10 9b 2b e2  cc ae 5e 45 0a ed ba 2f  |..9...+...^E.../|
-000002c0  6b 21 c0 25 40 8d c6 5f  bf 24 ef 62 98 90 60 5e  |k!.%@.._.$.b..`^|
-000002d0  37 99 5f 64 f0 27 ed 19  b2 18 58 a4 d9 9d e0 d8  |7._d.'....X.....|
-000002e0  a7 39 18 52 2c f8 24 2f  d2 eb ad da ff 28 53 13  |.9.R,.$/.....(S.|
-000002f0  23 b4 fe 1d df 4c 64 6a  a6 fa 69 74 f7 8a e1 53  |#....Ldj..it...S|
-00000300  7d eb bc da e6 46 b5 ee  80 49 ad d0 de 80 9d 25  |}....F...I.....%|
-00000310  52 5c fa 67 64 b7 a4 c6  2b 85 cb 2f 8d ad 8b b9  |R\.gd...+../....|
-00000320  f9 6a df 6b 0a 35 7d fb  2f 9d c2 bc 1f b6 17 03  |.j.k.5}./.......|
-00000330  03 00 99 8e af ab cf 7f  a1 2e 40 67 31 f8 33 33  |..........@g1.33|
-00000340  42 55 5f 9d 3c 6c c5 96  29 e1 8b 79 63 cf fe 4a  |BU_.<l..)..yc..J|
-00000350  d0 31 4e cb 55 d0 2d 9e  97 a8 e2 59 2e 59 92 f7  |.1N.U.-....Y.Y..|
-00000360  f5 01 54 7c d3 04 aa d4  3f 66 f4 2e 73 41 4c c8  |..T|....?f..sAL.|
-00000370  70 87 ba 35 d1 cf 4c 4e  91 3f 51 21 7b 4f 9a a5  |p..5..LN.?Q!{O..|
-00000380  9e 04 28 08 f4 0d ea 26  9f f3 80 a5 2d f1 94 33  |..(....&....-..3|
-00000390  83 53 46 15 c7 1a 42 bc  01 a4 7f 9a 43 ee b4 1e  |.SF...B.....C...|
-000003a0  a7 dd c9 3a 76 ed 60 14  17 5a a8 54 45 6e 4f 0c  |...:v.`..Z.TEnO.|
-000003b0  bc 4e 09 ff 1c 2f 17 9d  32 3e f5 86 fe 3d fa da  |.N.../..2>...=..|
-000003c0  f3 38 80 7c a1 ec 5b ed  8e ec 1d 81 17 03 03 00  |.8.|..[.........|
-000003d0  35 37 1a 5e f5 a0 15 ef  89 18 ff 6b ac 37 98 53  |57.^.......k.7.S|
-000003e0  be 61 29 c3 a3 48 d3 55  a0 6b 97 69 24 7d de 10  |.a)..H.U.k.i$}..|
-000003f0  b7 81 1a 3d 02 db 47 9d  45 04 4c 34 a7 b0 b0 02  |...=..G.E.L4....|
-00000400  8b 8c 77 81 1c ff 17 03  03 00 86 b7 f0 c7 45 29  |..w...........E)|
-00000410  0e 1f fb 8d c2 97 a4 ee  51 7f 2b dd 12 61 2a 0a  |........Q.+..a*.|
-00000420  bf 25 ac 6d 71 69 03 3f  cb 75 a3 69 6b 2a 5e d3  |.%.mqi.?.u.ik*^.|
-00000430  5b 36 8d 46 a1 9d ed c7  da c7 28 2e b6 d4 97 83  |[6.F......(.....|
-00000440  cd 20 6d 7b 15 b2 f7 ac  dd 29 66 cf 56 4a 3c a3  |. m{.....)f.VJ<.|
-00000450  ab f5 bf 5d fc fa 6f 4b  74 b1 f7 d3 9c 7a 80 5a  |...]..oKt....z.Z|
-00000460  2b 01 1e 78 7c 87 14 cd  76 94 f4 8a b6 f2 a3 ad  |+..x|...v.......|
-00000470  b3 e6 0c 60 aa 51 91 c0  3c 01 88 65 85 be 14 83  |...`.Q..<..e....|
-00000480  b6 dc 7b d2 6e 3f 86 fd  16 31 28 ef 40 48 08 30  |..{.n?...1(.@H.0|
-00000490  12                                                |.|
+000000a0  17 03 03 00 17 a3 60 e4  12 08 5c 65 fc 70 2b 02  |......`...\e.p+.|
+000000b0  77 25 d6 8d 5e 0c 4c fc  ea 4b f7 72 17 03 03 02  |w%..^.L..K.r....|
+000000c0  6d a3 62 aa 8c ed d8 f0  80 ea 51 c5 13 4b 35 33  |m.b.......Q..K53|
+000000d0  d7 45 83 c8 f2 04 fc e8  e7 a4 2b d9 a2 61 9d 56  |.E........+..a.V|
+000000e0  a0 61 13 74 a6 e9 29 98  3b b6 68 7e 7f c9 25 69  |.a.t..).;.h~..%i|
+000000f0  bd 39 95 4b b4 40 ca 2b  d2 b0 d1 78 9c 32 13 41  |.9.K.@.+...x.2.A|
+00000100  6b 40 13 6f 17 3c e5 25  17 35 8c 4b d9 f7 f2 eb  |k@.o.<.%.5.K....|
+00000110  e1 af 44 46 2d cb d2 2a  06 56 03 2c a7 d7 0d c2  |..DF-..*.V.,....|
+00000120  50 ea b4 58 50 6d 32 41  9f 6b 71 c3 9b 80 e0 42  |P..XPm2A.kq....B|
+00000130  38 0d 7a 82 05 b0 f7 2e  e0 d5 5d a2 93 5c b7 e8  |8.z.......]..\..|
+00000140  c6 26 51 60 e2 f3 c1 2f  73 38 48 fd 71 be da 81  |.&Q`.../s8H.q...|
+00000150  3d 70 24 57 80 89 f0 7a  4d ab cf 39 a3 fb 65 88  |=p$W...zM..9..e.|
+00000160  1f 88 10 80 37 d9 bc 2d  3a 12 c8 99 1e d5 4c 46  |....7..-:.....LF|
+00000170  03 60 7d d4 90 4f b8 fd  db 68 26 4b 2f 9c 9c 8c  |.`}..O...h&K/...|
+00000180  19 d2 78 ed b8 28 64 4a  ca af 83 16 2c 16 9c 8c  |..x..(dJ....,...|
+00000190  20 5c 7d 6e 09 e9 c3 4f  e4 24 9f ac a8 34 79 bf  | \}n...O.$...4y.|
+000001a0  37 55 42 f1 2e 81 c1 00  59 8f 69 dd 5e c2 5f 3e  |7UB.....Y.i.^._>|
+000001b0  0c 44 6a 22 e2 a6 23 2e  bc f3 79 ff 63 9f 43 62  |.Dj"..#...y.c.Cb|
+000001c0  30 b3 6f 83 2e f2 fd dd  16 23 63 0b a5 dd 1f a7  |0.o......#c.....|
+000001d0  c6 37 85 4e 05 ec 39 7d  42 e6 be dc 65 b4 ad a9  |.7.N..9}B...e...|
+000001e0  b0 4b 76 e6 91 0e c9 0c  52 9e 8d 54 0a 16 c4 81  |.Kv.....R..T....|
+000001f0  f7 83 48 2c 30 59 ab f3  b8 50 14 a9 05 15 b2 5b  |..H,0Y...P.....[|
+00000200  0a a6 bd 5c 04 f8 43 19  08 2b 51 49 a7 c1 58 b6  |...\..C..+QI..X.|
+00000210  47 6a 46 17 ec d8 76 a1  0d 83 6b 89 69 aa 5d 33  |GjF...v...k.i.]3|
+00000220  01 d0 5e ea dd 60 e2 03  39 97 0c 51 26 c8 14 98  |..^..`..9..Q&...|
+00000230  12 49 c9 dc ca 82 9f 15  3b d1 56 47 fa dc 2e 54  |.I......;.VG...T|
+00000240  d9 c5 ab f5 9d 46 86 4e  db a8 f8 29 d1 b7 73 63  |.....F.N...)..sc|
+00000250  df f2 9a 7d 77 35 4a 6e  23 77 25 70 7e 55 c5 42  |...}w5Jn#w%p~U.B|
+00000260  ca fc bf a4 ea 18 30 91  1a 14 31 60 df f6 28 96  |......0...1`..(.|
+00000270  48 a1 8f 46 f3 94 f8 24  cc 0a 95 7b f8 ba 9b b1  |H..F...$...{....|
+00000280  99 8c f8 73 00 ba 37 cd  b0 45 0b 40 a2 97 f6 ac  |...s..7..E.@....|
+00000290  bb c4 c1 c2 9a 73 3a 68  f9 be a3 36 b4 82 da 6b  |.....s:h...6...k|
+000002a0  39 49 2d f1 43 6f 4f 4a  c0 8d 0f dc f7 e3 19 8f  |9I-.CoOJ........|
+000002b0  73 cd 57 94 34 b5 85 35  45 3c 75 98 95 4b b6 10  |s.W.4..5E<u..K..|
+000002c0  bb 72 89 ae 52 98 77 3d  e5 6f a3 08 dc 8a 48 13  |.r..R.w=.o....H.|
+000002d0  84 56 ef 99 c7 23 74 33  37 fc ad e2 28 f2 f7 cb  |.V...#t37...(...|
+000002e0  36 9d e0 be e0 27 40 40  bd 9e 70 bb dd b3 39 2c  |6....'@@..p...9,|
+000002f0  ea 25 ac 09 1c 8e 95 ca  b8 2d 1e 63 f8 4c 7c 42  |.%.......-.c.L|B|
+00000300  e6 4b d7 14 15 78 3e e0  57 0a c7 9f a5 2c 9b 32  |.K...x>.W....,.2|
+00000310  d7 09 1b 80 4c fc 0a 87  45 fc 5e ac ba ec 54 e3  |....L...E.^...T.|
+00000320  da 09 a5 eb 11 da ad c8  a9 6e b6 d0 ad 85 17 03  |.........n......|
+00000330  03 00 99 e4 24 04 be 5e  14 d6 3d 9f ae 8f fa 9a  |....$..^..=.....|
+00000340  ab ae b9 f7 04 a4 bf a1  4b 0c fb e4 30 1a cc 80  |........K...0...|
+00000350  63 45 f7 60 94 87 eb f5  53 d3 89 ba 3e 94 05 9a  |cE.`....S...>...|
+00000360  c0 0b ad 7b f5 0a bc b3  cf 7c 1d 43 8d a6 d9 d0  |...{.....|.C....|
+00000370  25 50 aa fe bd 38 04 63  dc a6 cf b7 7d 22 8d 68  |%P...8.c....}".h|
+00000380  fd 53 31 6f 18 a9 73 18  b4 ab 87 62 19 b2 7e 68  |.S1o..s....b..~h|
+00000390  c9 de b8 f9 2e cd 2f 8a  96 55 cd 0d c5 de df f8  |....../..U......|
+000003a0  3a a8 53 50 6f 50 ed 1c  4e d2 b4 8a 35 1f 81 b2  |:.SPoP..N...5...|
+000003b0  d0 50 64 bd 2c 37 2d 4b  3a 04 c1 d1 95 39 f9 f6  |.Pd.,7-K:....9..|
+000003c0  87 c6 c0 d0 44 aa f8 63  92 07 f5 2a 17 03 03 00  |....D..c...*....|
+000003d0  35 e9 89 19 15 b4 70 ab  2b 62 b5 e2 5e 02 4b 35  |5.....p.+b..^.K5|
+000003e0  27 42 61 e8 87 f8 b3 a1  22 f1 d4 a7 23 90 0c 3f  |'Ba....."...#..?|
+000003f0  d8 c9 2d dc 76 ee 7e 8e  52 ab e8 77 88 ce 6c 31  |..-.v.~.R..w..l1|
+00000400  35 95 90 ac 3a 7b 17 03  03 00 87 b7 92 53 79 c3  |5...:{.......Sy.|
+00000410  d4 30 b7 8a e1 ab 6d 97  fd fe 23 9f d1 f3 86 ee  |.0....m...#.....|
+00000420  e9 14 85 c3 33 d1 7e cf  72 62 87 a0 6e 97 62 8b  |....3.~.rb..n.b.|
+00000430  90 4d ce 74 5d cb 6b 11  ae b8 59 f5 70 a9 53 75  |.M.t].k...Y.p.Su|
+00000440  6b 31 44 4f 11 a9 cb d0  07 fc a8 af 11 67 11 ff  |k1DO.........g..|
+00000450  5b dc c1 58 15 df a1 1b  bc e4 36 e7 12 46 b8 2f  |[..X......6..F./|
+00000460  00 fb 7c 83 e8 e3 4a 08  7f 89 10 f7 f4 23 2d d9  |..|...J......#-.|
+00000470  ea 47 1d 97 d1 8d b3 13  6c 79 08 bc 47 d5 21 a0  |.G......ly..G.!.|
+00000480  95 e5 5e 2e 23 99 11 4c  2a 24 75 9d d2 d5 7e 74  |..^.#..L*$u...~t|
+00000490  22 2a                                             |"*|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 35 29 bd 8d  34 df 82 24 ec fd cb c8  |....5)..4..$....|
-00000010  82 0e de d7 b1 f9 93 d7  c4 64 5e 4d 29 42 f0 b2  |.........d^M)B..|
-00000020  61 95 4f ab d7 1f 1e b8  62 d1 5e 25 e2 cd 80 62  |a.O.....b.^%...b|
-00000030  13 c3 73 9e e8 c8 25 35  ec 1f                    |..s...%5..|
+00000000  17 03 03 00 35 dc 57 3a  57 bd 27 01 81 7d 12 1e  |....5.W:W.'..}..|
+00000010  aa 3f 06 f5 e0 24 74 7d  ed ea d3 90 6b 25 fe b8  |.?...$t}....k%..|
+00000020  a3 f7 58 0a d4 f8 73 f1  18 60 06 bf 57 4d 4f 1e  |..X...s..`..WMO.|
+00000030  a7 15 43 bd 80 79 c6 ad  89 29                    |..C..y...)|
 >>> Flow 6 (server to client)
-00000000  17 03 03 00 1e 90 42 e0  6f 94 68 e9 12 b4 16 63  |......B.o.h....c|
-00000010  8a b8 11 63 b9 4c 60 a7  9f 3d 5e ad ea 29 98 e3  |...c.L`..=^..)..|
-00000020  e1 c9 21 17 03 03 00 13  06 de de 14 d0 35 ab 2c  |..!..........5.,|
-00000030  c4 d1 78 c8 8b 92 80 aa  26 be 80                 |..x.....&..|
+00000000  17 03 03 00 1e 70 87 18  58 43 6b 0a d1 34 f0 bc  |.....p..XCk..4..|
+00000010  54 08 a9 0f 69 29 c6 8a  83 7f b4 a0 90 e3 d1 02  |T...i)..........|
+00000020  f3 44 b8 17 03 03 00 13  74 6b 59 ac 78 b5 94 7f  |.D......tkY.x...|
+00000030  9e d1 9a 3c e9 60 32 e4  4c 85 7a                 |...<.`2.L.z|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-IssueTicket b/src/crypto/tls/testdata/Server-TLSv13-IssueTicket
index b7657617a0..024f8a76b8 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-IssueTicket
+++ b/src/crypto/tls/testdata/Server-TLSv13-IssueTicket
@@ -1,98 +1,98 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ce 01 00 00  ca 03 03 c5 71 30 4c 56  |............q0LV|
-00000010  a7 9b cc 4a ec ad bc 11  de d7 60 e9 09 63 6a f4  |...J......`..cj.|
-00000020  e1 81 2f fc 75 1e aa bd  e8 75 29 20 43 f8 48 51  |../.u....u) C.HQ|
-00000030  6d 0c 23 49 bf 25 22 31  c0 2a f2 79 03 9b eb e1  |m.#I.%"1.*.y....|
-00000040  34 b9 e0 32 8f 9c fd 5e  7f 27 9e 71 00 04 13 01  |4..2...^.'.q....|
+00000000  16 03 01 00 ce 01 00 00  ca 03 03 1d 7a 10 b3 31  |............z..1|
+00000010  d0 07 51 2f b6 43 60 f1  3e 86 01 ad db 8c 95 36  |..Q/.C`.>......6|
+00000020  1c 7b 10 58 7e da ad 7e  38 7b 13 20 45 60 8a 3f  |.{.X~..~8{. E`.?|
+00000030  39 d9 c9 53 12 0a 2c b7  43 dd a7 d9 ba 84 d4 88  |9..S..,.C.......|
+00000040  cf c2 1d 57 91 8f 33 c3  1b ee 38 cf 00 04 13 01  |...W..3...8.....|
 00000050  00 ff 01 00 00 7d 00 0b  00 04 03 00 01 02 00 0a  |.....}..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 16 00 00 00 17  00 00 00 0d 00 1e 00 1c  |................|
 00000080  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000090  08 04 08 05 08 06 04 01  05 01 06 01 00 2b 00 03  |.............+..|
 000000a0  02 03 04 00 2d 00 02 01  01 00 33 00 26 00 24 00  |....-.....3.&.$.|
-000000b0  1d 00 20 c2 a9 47 f8 01  7b 9f 2e 33 8e fb 1e 9f  |.. ..G..{..3....|
-000000c0  5d a7 12 f7 57 4a bb 94  2a 2e c7 d6 2d e6 63 0f  |]...WJ..*...-.c.|
-000000d0  8d ca 0b                                          |...|
+000000b0  1d 00 20 fb fa 6d 1c 02  64 98 74 c1 77 98 bd 79  |.. ..m..d.t.w..y|
+000000c0  44 94 7a 6e 21 03 9b 28  d6 d9 1c 69 e7 13 f0 1c  |D.zn!..(...i....|
+000000d0  4e 53 07                                          |NS.|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 43 f8 48 51  |........... C.HQ|
-00000030  6d 0c 23 49 bf 25 22 31  c0 2a f2 79 03 9b eb e1  |m.#I.%"1.*.y....|
-00000040  34 b9 e0 32 8f 9c fd 5e  7f 27 9e 71 13 01 00 00  |4..2...^.'.q....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 45 60 8a 3f  |........... E`.?|
+00000030  39 d9 c9 53 12 0a 2c b7  43 dd a7 d9 ba 84 d4 88  |9..S..,.C.......|
+00000040  cf c2 1d 57 91 8f 33 c3  1b ee 38 cf 13 01 00 00  |...W..3...8.....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 71 a9 37 d8 06 12  |..........q.7...|
-00000090  d3 60 d5 d8 38 6e 29 cc  b9 75 a7 ef d3 ae f2 fe  |.`..8n)..u......|
-000000a0  b8 17 03 03 02 6d c2 c2  cb d6 b3 72 ae 67 42 f1  |.....m.....r.gB.|
-000000b0  25 6e ce b2 2b 26 59 9e  3c 6c d9 e4 1d 54 8a 65  |%n..+&Y.<l...T.e|
-000000c0  69 d1 b7 6e 1f eb bd 4d  4a da 5f 5d be 41 8b ef  |i..n...MJ._].A..|
-000000d0  64 b2 30 c4 35 f0 6e 3c  53 2e 1f 95 4f a8 cb bb  |d.0.5.n<S...O...|
-000000e0  a1 a6 87 f0 c7 76 25 fa  d7 0f 19 e5 72 be 72 da  |.....v%.....r.r.|
-000000f0  c8 37 e2 e1 3f 4f a4 61  e3 79 3c 66 7f 57 95 50  |.7..?O.a.y<f.W.P|
-00000100  91 fe 62 42 e7 09 11 73  c6 67 fc 44 eb 7d 15 95  |..bB...s.g.D.}..|
-00000110  66 50 f0 f8 c5 e8 ac 86  f5 96 06 21 6d 22 55 d8  |fP.........!m"U.|
-00000120  c8 90 ef b1 77 36 e1 fb  a0 32 8c d7 70 73 8f 05  |....w6...2..ps..|
-00000130  fd c6 d5 aa de d4 c8 82  c2 3e 03 fa fb e1 07 a7  |.........>......|
-00000140  f2 76 a7 85 a3 22 cb 6b  15 e0 59 fc 5b 8f 36 13  |.v...".k..Y.[.6.|
-00000150  1d 21 f3 1a 1f 1a d4 eb  23 2d 00 60 85 d3 a9 38  |.!......#-.`...8|
-00000160  28 0e e7 fa 7e 84 2b 63  7f 54 15 ab 64 fd e7 a8  |(...~.+c.T..d...|
-00000170  71 53 90 b2 b4 a2 55 86  24 dd 6f d2 67 a2 0c bc  |qS....U.$.o.g...|
-00000180  22 a8 ae 8a 65 6d 1f 2d  e7 37 83 43 92 49 a8 ec  |"...em.-.7.C.I..|
-00000190  b3 a0 87 25 a6 50 7e f0  df df 99 ec 89 ac 7f 86  |...%.P~.........|
-000001a0  6c 31 99 f4 85 fd ba 09  36 74 a7 1a cb f5 31 3e  |l1......6t....1>|
-000001b0  2d 82 9d ae d6 ff 04 3e  bb d9 fa fa 73 73 c1 2f  |-......>....ss./|
-000001c0  bc 66 a5 db 77 69 fa 2c  c6 57 7a 99 63 6a b9 d5  |.f..wi.,.Wz.cj..|
-000001d0  a4 03 92 e6 d5 1b 77 51  aa 24 27 0d 80 72 f3 6c  |......wQ.$'..r.l|
-000001e0  70 bb 5c 87 c7 3e b2 7b  3a 08 e3 7e 61 3d 35 71  |p.\..>.{:..~a=5q|
-000001f0  ee 20 7f b8 bb b4 24 65  1a 89 a3 73 50 2c 9f b4  |. ....$e...sP,..|
-00000200  62 ea a3 f2 b2 45 6b c5  cc 6f 30 c7 f4 39 31 ba  |b....Ek..o0..91.|
-00000210  5b d2 20 f0 bb 29 8b 90  e7 f4 fc d0 75 41 06 b9  |[. ..)......uA..|
-00000220  1c 6a 29 db b1 de 17 c8  1e 56 86 95 bf 24 7e 05  |.j)......V...$~.|
-00000230  7a bf a9 a9 e6 ad 79 71  82 b9 f9 50 b2 cc e0 b2  |z.....yq...P....|
-00000240  28 be 46 d3 2e a8 5c ab  2e a8 c8 8f 4f 65 3b 0d  |(.F...\.....Oe;.|
-00000250  e3 c2 80 60 57 00 8e 87  c9 77 95 3e 61 5f d1 73  |...`W....w.>a_.s|
-00000260  68 54 d5 2c 1c 47 fc 5d  50 cc 5c bf e1 05 d6 7d  |hT.,.G.]P.\....}|
-00000270  2e 90 aa 42 09 8b 56 28  e0 e9 8b 65 18 a3 e0 82  |...B..V(...e....|
-00000280  9f 58 3f 02 df aa 2b 76  04 03 4d 97 9b 79 de af  |.X?...+v..M..y..|
-00000290  c7 1f f2 37 c3 e6 09 9f  1f 01 52 3b 83 0c ca b7  |...7......R;....|
-000002a0  e0 fd 73 d6 56 7e de a0  98 67 c2 76 9d fd 45 36  |..s.V~...g.v..E6|
-000002b0  42 e2 62 5c c8 e7 d5 46  23 0e 2c e0 c1 59 06 d5  |B.b\...F#.,..Y..|
-000002c0  e4 2d c2 bb e1 60 22 df  ad 4f 7a 35 e2 8d da c0  |.-...`"..Oz5....|
-000002d0  80 3b cc 2e 88 8d 8e 51  f0 fd d5 92 fd 40 a1 ca  |.;.....Q.....@..|
-000002e0  b1 3a 10 95 43 9d 8f 6b  45 8e 3a 00 85 7c 85 fd  |.:..C..kE.:..|..|
-000002f0  42 95 31 5a a2 0c 60 82  97 ab 4d 96 f9 61 ce 61  |B.1Z..`...M..a.a|
-00000300  72 01 57 e6 78 4d b8 af  35 ff c4 42 9f c9 c4 36  |r.W.xM..5..B...6|
-00000310  6d f6 f8 17 03 03 00 99  26 eb 20 f0 c2 65 a4 1c  |m.......&. ..e..|
-00000320  12 79 7c 95 57 18 4f 34  cd 7a a9 7b 33 76 c6 14  |.y|.W.O4.z.{3v..|
-00000330  9a 01 2a e4 15 90 e6 28  60 ff 3d 27 10 ca 8a e8  |..*....(`.='....|
-00000340  76 51 2b 21 2d ff d5 7c  87 e1 cc f4 64 09 b2 f9  |vQ+!-..|....d...|
-00000350  a4 ec 52 14 47 67 27 07  e5 f3 bf 9c 26 19 1a 1c  |..R.Gg'.....&...|
-00000360  52 07 9b 6e b6 ad 9b 18  49 fb e0 ec 51 2f 4d 75  |R..n....I...Q/Mu|
-00000370  05 ea 3f e3 17 fe ca 24  fe b1 33 65 2e fd c3 8c  |..?....$..3e....|
-00000380  9e d7 56 37 d2 e5 84 98  81 68 7b eb 81 39 53 ca  |..V7.....h{..9S.|
-00000390  aa e7 a3 00 e4 f5 be 91  51 d1 32 e8 0b 23 6b a0  |........Q.2..#k.|
-000003a0  9d 3f 4d 22 8a d3 e8 d8  cb 25 8e ed cc c8 10 1d  |.?M".....%......|
-000003b0  66 17 03 03 00 35 f4 6b  f9 76 d9 a4 96 48 4b d6  |f....5.k.v...HK.|
-000003c0  9f d8 31 f8 3c 42 90 83  03 7f cb 45 45 31 be f7  |..1.<B.....EE1..|
-000003d0  45 35 fd d0 f1 3d d2 66  41 76 af a9 8a 74 6a 2d  |E5...=.fAv...tj-|
-000003e0  ca af 9f 56 e9 4c b3 dc  77 18 32 17 03 03 00 86  |...V.L..w.2.....|
-000003f0  af 4a 7c 23 84 f6 45 93  f8 ae 2a 4f 13 9f 5a 5a  |.J|#..E...*O..ZZ|
-00000400  35 51 34 f8 98 90 57 47  5c f4 3e b1 16 b6 08 df  |5Q4...WG\.>.....|
-00000410  88 df a8 8c 8e 41 a5 40  30 2e 68 01 e7 8f e2 4d  |.....A.@0.h....M|
-00000420  98 52 27 40 c5 46 bb 9f  a3 0b e9 fa 5f 33 2d 68  |.R'@.F......_3-h|
-00000430  76 66 2d 9c 4d 50 31 e6  60 1b a9 39 16 fe 15 74  |vf-.MP1.`..9...t|
-00000440  58 e6 9c 1c 03 44 53 f8  a6 bc 9c 92 67 a5 ed be  |X....DS.....g...|
-00000450  2b 44 db ce d8 a9 50 bd  b2 3a 69 66 9b a7 f3 ac  |+D....P..:if....|
-00000460  47 57 5f 57 76 98 f8 b0  eb f6 cb 3d da d1 d4 d7  |GW_Wv......=....|
-00000470  34 6a ea 91 5a af                                 |4j..Z.|
+00000080  03 03 00 01 01 17 03 03  00 17 42 d0 aa 82 78 28  |..........B...x(|
+00000090  88 ec b7 7d bb 3d 61 59  82 83 58 ee d6 f7 23 b6  |...}.=aY..X...#.|
+000000a0  5a 17 03 03 02 6d 07 90  87 4f bd 2e ef 93 36 f4  |Z....m...O....6.|
+000000b0  66 c3 26 82 07 35 e9 c6  30 a7 12 04 96 7b 19 b8  |f.&..5..0....{..|
+000000c0  c9 5e 09 aa 6a 7d b7 66  f8 4c 3d 74 a9 f2 8e 23  |.^..j}.f.L=t...#|
+000000d0  02 4c e2 13 4c 53 e9 c8  38 37 fc c7 f3 83 a8 7c  |.L..LS..87.....||
+000000e0  44 61 06 0f d6 43 30 5a  f0 f9 ed 01 a9 24 47 4f  |Da...C0Z.....$GO|
+000000f0  4f 01 0d 49 01 61 40 84  4d 94 b3 c3 ba 20 cd 2b  |O..I.a@.M.... .+|
+00000100  03 66 f5 dd 8f 70 71 6c  1a e9 11 33 c9 4a 5d a6  |.f...pql...3.J].|
+00000110  7d a4 42 5b 42 5b ea 31  74 08 36 78 50 45 f9 03  |}.B[B[.1t.6xPE..|
+00000120  94 84 3c 4b c7 ce 8a 5d  0c 3f e6 e4 00 71 1c 6e  |..<K...].?...q.n|
+00000130  34 f1 46 d0 09 b9 ee 1e  a8 84 74 77 2b 86 fc fe  |4.F.......tw+...|
+00000140  45 a2 d9 5b c3 42 9c 29  6e fc 86 1d 2a 21 a8 fd  |E..[.B.)n...*!..|
+00000150  33 f7 59 59 83 5d 7d fc  01 be e7 d5 bd af 92 cf  |3.YY.]}.........|
+00000160  35 37 5b 1c 0f 60 f2 a2  de 7c 31 53 6a 3e f7 d2  |57[..`...|1Sj>..|
+00000170  1d 63 ce 88 1d a0 1a a5  a0 fc 67 24 bb 9c 41 2a  |.c........g$..A*|
+00000180  df b3 0c f1 57 20 f0 cc  c0 eb 84 f0 e8 9b 12 41  |....W .........A|
+00000190  6b f4 36 50 f4 27 ff b6  cb e4 7c 25 d4 e9 1d 2d  |k.6P.'....|%...-|
+000001a0  82 42 88 9c 6b 71 de fa  f0 ba e0 5f 75 fc 05 89  |.B..kq....._u...|
+000001b0  0c 5d 61 f3 2c 0d 2f 2a  db 60 0c 06 a5 6c 93 c0  |.]a.,./*.`...l..|
+000001c0  a6 c9 8a 06 04 bb 52 25  6c 13 52 49 da 86 78 40  |......R%l.RI..x@|
+000001d0  f0 98 f8 ae d7 5c be ea  f9 7e 8b 2e ab f0 71 28  |.....\...~....q(|
+000001e0  c9 03 a2 40 8b 11 2a b4  be da f3 4e cc 0c 6a d3  |...@..*....N..j.|
+000001f0  50 79 eb 90 b0 41 d6 12  22 bf 3a 72 5d d0 00 f6  |Py...A..".:r]...|
+00000200  f9 c1 ac e5 c0 7c 2a ca  e0 3a 07 2d 3d d4 56 91  |.....|*..:.-=.V.|
+00000210  8a 87 ac f6 11 61 52 cc  ef a1 5f 9b f6 09 6e 7f  |.....aR..._...n.|
+00000220  4c 33 6c ce f8 76 0b 1d  6a b3 e7 43 af f8 1c 97  |L3l..v..j..C....|
+00000230  f0 ab ff ce 15 74 87 3a  4a 7f 6f 1b 93 bf cb 75  |.....t.:J.o....u|
+00000240  32 c2 c9 53 d7 cb 8f 39  80 51 b9 38 19 8c da f7  |2..S...9.Q.8....|
+00000250  95 96 2f 20 c2 19 d5 d9  2d f1 e4 64 99 cf 61 55  |../ ....-..d..aU|
+00000260  2c 8d 66 c4 d3 5d f1 ba  17 4c 6f 4e 06 13 9f 82  |,.f..]...LoN....|
+00000270  62 e8 64 2a 68 c3 fa 7e  d0 91 e2 11 c9 17 c7 37  |b.d*h..~.......7|
+00000280  28 db c8 72 f2 cc 3a b2  17 bc 5f 91 aa 50 79 7f  |(..r..:..._..Py.|
+00000290  0b 11 99 11 64 a9 40 01  bc fd 00 da 50 e1 a7 c7  |....d.@.....P...|
+000002a0  e8 b4 2a c5 b8 2e 35 3a  37 2e de 53 a1 68 48 2d  |..*...5:7..S.hH-|
+000002b0  7d 29 5d 7b 43 8d 8a 2b  fd c8 57 50 32 07 bd 44  |})]{C..+..WP2..D|
+000002c0  b7 08 61 ca 21 f6 ed e0  97 ae d9 de 89 67 1b a5  |..a.!........g..|
+000002d0  50 4a 0e 37 73 ba 70 ed  d8 da 4b 18 dd 77 7e 8b  |PJ.7s.p...K..w~.|
+000002e0  98 8a f4 a0 87 8f 83 3f  b7 a0 20 b0 29 72 b1 44  |.......?.. .)r.D|
+000002f0  5b de f3 62 19 6f 2d f6  a6 05 b5 22 56 61 e6 8e  |[..b.o-...."Va..|
+00000300  9f c7 61 cb 10 e4 cb 93  69 e1 62 4f 7f 24 b4 a0  |..a.....i.bO.$..|
+00000310  b8 c4 25 17 03 03 00 99  af 8e c5 f6 eb 2d 8a 0d  |..%..........-..|
+00000320  a6 88 32 94 49 a7 74 33  dc 3a 99 9d de 7f 3e b4  |..2.I.t3.:....>.|
+00000330  6c 2f 16 3e ee ec ed e8  78 32 4a f2 a5 05 dc 84  |l/.>....x2J.....|
+00000340  49 7b f2 b7 5c 60 13 b8  1c b5 89 0c 7a ac e7 7b  |I{..\`......z..{|
+00000350  a5 95 18 2a 91 29 fc 3e  46 d4 ca 3d 52 2e 7d f1  |...*.).>F..=R.}.|
+00000360  0d 7a e6 56 59 dd 24 13  93 94 06 0e 4e 12 c1 59  |.z.VY.$.....N..Y|
+00000370  31 f8 34 73 d2 6c d0 73  06 2d a6 ed b9 42 0a 92  |1.4s.l.s.-...B..|
+00000380  3e 8a 3d 6a 89 d3 cb c1  e0 d7 bd 42 74 35 08 28  |>.=j.......Bt5.(|
+00000390  ce 1c 24 2a dd d0 4f 60  67 3a 96 cf 16 8e 49 f2  |..$*..O`g:....I.|
+000003a0  fc 3c 59 de c1 62 da c5  00 91 db 56 f5 d3 df 53  |.<Y..b.....V...S|
+000003b0  57 17 03 03 00 35 2e 87  d8 a4 af c2 73 92 de c6  |W....5......s...|
+000003c0  5a 40 0f 50 2a 19 ca 52  7f 67 31 91 ce e7 df 12  |Z@.P*..R.g1.....|
+000003d0  cd a0 43 0c da 2a 33 45  b3 34 a6 8d d3 fb 18 06  |..C..*3E.4......|
+000003e0  59 75 e2 d8 4f db a9 94  be b6 db 17 03 03 00 87  |Yu..O...........|
+000003f0  f7 d4 bc fa 15 5f 98 87  73 e4 17 55 ce 85 b6 46  |....._..s..U...F|
+00000400  0b 45 20 be 8d ad c6 6c  79 c8 75 a4 0d e6 34 b8  |.E ....ly.u...4.|
+00000410  16 48 07 09 26 7a 87 19  2c 99 6d e8 7d de e5 c0  |.H..&z..,.m.}...|
+00000420  fe 3b 17 19 ed 24 9b e5  4c 5c 2b dc d3 78 ae b1  |.;...$..L\+..x..|
+00000430  dc c1 bb 6e 8d 14 3e 59  9d 9e 3d 62 f8 51 10 9b  |...n..>Y..=b.Q..|
+00000440  0f 8f d9 9f 0c 89 97 9a  db 5c 99 13 0e 08 be 46  |.........\.....F|
+00000450  ff ac 31 ff dc fd bb 93  e9 fe 9d ff 70 35 21 e7  |..1.........p5!.|
+00000460  71 96 3c 6f 03 02 42 9b  06 f7 fa 6e 24 07 c3 d8  |q.<o..B....n$...|
+00000470  bd 25 25 bf 84 81 c4                              |.%%....|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 c7 6f fc 50 f1  |..........5.o.P.|
-00000010  3a f8 1a 5d 34 0f ea c2  df 6b d9 aa 13 51 3d aa  |:..]4....k...Q=.|
-00000020  75 14 61 75 20 5b e1 db  22 52 51 8b dc 23 1f 38  |u.au [.."RQ..#.8|
-00000030  82 12 01 2d e7 0b ab f6  3a 3e 5a 06 e8 f3 ab 63  |...-....:>Z....c|
+00000000  14 03 03 00 01 01 17 03  03 00 35 2d 42 76 94 8e  |..........5-Bv..|
+00000010  3b a3 da ff 05 97 70 a6  e7 ea ea bd 53 f2 02 fd  |;.....p.....S...|
+00000020  50 2b 6a fa 22 38 7f b7  50 2c ab d2 6e ee 23 86  |P+j."8..P,..n.#.|
+00000030  ec 3e ff 13 da 96 82 df  c7 84 80 3f 5c c6 dc 0d  |.>.........?\...|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e f2 b0 45  a7 d7 6b 5a 94 39 61 1b  |.......E..kZ.9a.|
-00000010  27 4a 28 d1 0a e6 c6 8b  ae 1d 91 55 32 17 55 9d  |'J(........U2.U.|
-00000020  df 49 30 17 03 03 00 13  18 9b 5d cb ed 6e 55 40  |.I0.......]..nU@|
-00000030  5d 7a cf 60 63 4e 6c 8c  77 f0 f9                 |]z.`cNl.w..|
+00000000  17 03 03 00 1e 64 41 51  db 02 de 2c df a6 03 99  |.....dAQ...,....|
+00000010  9d 7d 0d b4 bc 11 81 a2  1e 22 0c c6 3f 54 2e fd  |.}......."..?T..|
+00000020  4a bd c7 17 03 03 00 13  c3 cf 03 93 a4 95 42 47  |J.............BG|
+00000030  72 c9 aa 09 24 98 b3 0b  af 41 ee                 |r...$....A.|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-IssueTicketPreDisable b/src/crypto/tls/testdata/Server-TLSv13-IssueTicketPreDisable
index eba0460780..3c43fda044 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-IssueTicketPreDisable
+++ b/src/crypto/tls/testdata/Server-TLSv13-IssueTicketPreDisable
@@ -1,98 +1,98 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ce 01 00 00  ca 03 03 0b 8e 38 e1 3d  |.............8.=|
-00000010  ac 71 4f 18 fd 1b 7f 0f  a1 86 3e 74 5b d3 cd 1f  |.qO.......>t[...|
-00000020  b1 98 e4 bb 17 87 ba 44  fe 4f 43 20 d2 7b 5e 84  |.......D.OC .{^.|
-00000030  db 5f e4 b6 fd db f8 db  b4 39 1e 7e 10 28 5e 88  |._.......9.~.(^.|
-00000040  20 85 5b 4a 89 dc 25 3b  d0 d4 9d 32 00 04 13 01  | .[J..%;...2....|
+00000000  16 03 01 00 ce 01 00 00  ca 03 03 7d f8 a3 41 a3  |...........}..A.|
+00000010  8e 32 fa 2b c0 94 57 7d  3c 9f 78 e0 57 59 fa bc  |.2.+..W}<.x.WY..|
+00000020  3a d0 9f ae 2a 6c da 5e  4e ed f0 20 31 ee 6b a2  |:...*l.^N.. 1.k.|
+00000030  cd b0 82 e8 f0 9e cb 84  0f 5e bf ff 87 f9 95 9d  |.........^......|
+00000040  fb 19 5e 78 e6 5a 31 02  6a d8 4c 25 00 04 13 01  |..^x.Z1.j.L%....|
 00000050  00 ff 01 00 00 7d 00 0b  00 04 03 00 01 02 00 0a  |.....}..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 16 00 00 00 17  00 00 00 0d 00 1e 00 1c  |................|
 00000080  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000090  08 04 08 05 08 06 04 01  05 01 06 01 00 2b 00 03  |.............+..|
 000000a0  02 03 04 00 2d 00 02 01  01 00 33 00 26 00 24 00  |....-.....3.&.$.|
-000000b0  1d 00 20 1b c4 cd 2b 48  e2 55 c2 fb 0c ab 86 c4  |.. ...+H.U......|
-000000c0  e5 44 a6 90 22 e1 f5 d4  42 9d 72 1a 54 45 1d 07  |.D.."...B.r.TE..|
-000000d0  00 9f 24                                          |..$|
+000000b0  1d 00 20 d3 4d 46 49 bd  60 af b2 5a 9b 6e 46 89  |.. .MFI.`..Z.nF.|
+000000c0  53 fd 32 84 7c f7 4e a1  52 4c 07 21 07 db c5 62  |S.2.|.N.RL.!...b|
+000000d0  54 a2 17                                          |T..|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 d2 7b 5e 84  |........... .{^.|
-00000030  db 5f e4 b6 fd db f8 db  b4 39 1e 7e 10 28 5e 88  |._.......9.~.(^.|
-00000040  20 85 5b 4a 89 dc 25 3b  d0 d4 9d 32 13 01 00 00  | .[J..%;...2....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 31 ee 6b a2  |........... 1.k.|
+00000030  cd b0 82 e8 f0 9e cb 84  0f 5e bf ff 87 f9 95 9d  |.........^......|
+00000040  fb 19 5e 78 e6 5a 31 02  6a d8 4c 25 13 01 00 00  |..^x.Z1.j.L%....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 59 c1 5f ff 8e c5  |..........Y._...|
-00000090  d4 07 33 d0 6e 58 06 27  8a 6f 46 8a 38 59 0e 74  |..3.nX.'.oF.8Y.t|
-000000a0  49 17 03 03 02 6d c6 73  d3 7a 6a 95 7f df 4c 81  |I....m.s.zj...L.|
-000000b0  f3 96 5d 5c bb 1f 80 af  98 3a f8 14 07 3d b4 2e  |..]\.....:...=..|
-000000c0  85 c5 23 a0 85 93 d1 64  19 87 b1 3b 7f 96 04 56  |..#....d...;...V|
-000000d0  a0 e9 04 eb f3 c8 f3 14  8b f6 91 14 6e 85 75 b0  |............n.u.|
-000000e0  3b cb 8f bc aa 4e 4b 75  15 7b b1 27 dd dc 48 34  |;....NKu.{.'..H4|
-000000f0  47 52 2c c0 5c 10 a1 cd  f4 24 fc 59 99 92 10 9f  |GR,.\....$.Y....|
-00000100  52 92 2a c2 0b ec eb 3f  26 85 0b 8c f7 ec cd 53  |R.*....?&......S|
-00000110  8d 59 df e6 7d 33 9a af  ba 67 05 1c 44 ef 9e b1  |.Y..}3...g..D...|
-00000120  3d f7 de 4f cd f0 e4 7c  ac d7 4b ce f3 fb 4e db  |=..O...|..K...N.|
-00000130  08 67 0c d8 f3 df 9c 6c  96 5f d9 ba f9 15 f9 72  |.g.....l._.....r|
-00000140  e2 fe 63 61 5a 6e 98 49  fb bf 3f 54 dd fe d3 ef  |..caZn.I..?T....|
-00000150  65 b0 3b e0 cd 58 bd 7d  3a c0 a0 5c 0e ec 3d 15  |e.;..X.}:..\..=.|
-00000160  70 6e b9 78 75 a5 fd 37  bb bd db de 8a 46 56 35  |pn.xu..7.....FV5|
-00000170  ca a6 e2 16 fa a8 3b ce  83 96 e1 08 5e ff 54 a3  |......;.....^.T.|
-00000180  09 29 36 32 43 04 aa 4d  30 f5 7c 7e 14 f8 f8 82  |.)62C..M0.|~....|
-00000190  d6 75 66 5a ec 60 ab 43  32 45 67 ed 99 e6 54 47  |.ufZ.`.C2Eg...TG|
-000001a0  a5 18 28 4c 89 87 cc 1d  99 03 45 88 36 9a 27 57  |..(L......E.6.'W|
-000001b0  63 86 94 ea 88 3b 7c 9c  ff 47 9a 3c 83 00 50 5a  |c....;|..G.<..PZ|
-000001c0  64 8c f3 5c 45 f7 a7 ea  b8 b7 55 e0 a2 ea 76 2c  |d..\E.....U...v,|
-000001d0  6f d9 8c 49 57 3f aa 83  cf 68 ab 88 33 dd dd fb  |o..IW?...h..3...|
-000001e0  c1 11 8a 34 7a 52 1f d9  10 fc a6 c8 de eb 31 9b  |...4zR........1.|
-000001f0  28 ad 3e 23 63 94 77 77  1c 8c 80 7c f6 fd a3 70  |(.>#c.ww...|...p|
-00000200  ca cb 4e c6 0e 3e f6 96  34 05 b2 19 3e e0 e8 02  |..N..>..4...>...|
-00000210  de 00 2a 12 19 19 aa 88  03 24 7c 45 4e fa c7 79  |..*......$|EN..y|
-00000220  c9 c4 79 fa 71 2c d3 55  8f d5 8c 6f 9d be 19 df  |..y.q,.U...o....|
-00000230  fe 91 b5 c2 c4 b5 ec a5  1b 5b 01 e4 19 1d fe f8  |.........[......|
-00000240  4e bd 06 57 46 c0 57 44  c9 5a 07 35 e9 9a 44 8b  |N..WF.WD.Z.5..D.|
-00000250  3f 37 47 fc 62 98 03 0e  5c 5e 47 be 75 05 5e da  |?7G.b...\^G.u.^.|
-00000260  a4 e1 42 f4 69 be f8 e2  1c 2a 96 51 3a 9d 33 69  |..B.i....*.Q:.3i|
-00000270  c9 07 16 d5 d3 93 19 b2  b6 d8 9f 30 fe 70 41 85  |...........0.pA.|
-00000280  bf ec 00 42 53 45 8e 57  80 56 6e 5f 04 c2 95 33  |...BSE.W.Vn_...3|
-00000290  de e9 d1 fa ee 0e 3b 17  31 0b 65 25 f9 bc 0a e6  |......;.1.e%....|
-000002a0  7f a6 35 60 9c db 35 40  74 e1 9b 65 09 7b b9 cf  |..5`..5@t..e.{..|
-000002b0  2c 1e 95 26 ff 8f 08 1d  f6 83 e5 e1 03 75 09 cd  |,..&.........u..|
-000002c0  20 f9 d1 0f 79 90 eb 53  d5 af 39 e9 9c 28 a1 66  | ...y..S..9..(.f|
-000002d0  c0 26 6f c9 d4 f9 ad 35  ce 74 8d 55 06 b8 7e 97  |.&o....5.t.U..~.|
-000002e0  f9 a9 6e 2f ff 6d 03 93  1e 72 46 3e d6 88 02 ff  |..n/.m...rF>....|
-000002f0  41 57 84 1b 67 61 ab 50  d1 a7 7f 06 ed c1 63 2e  |AW..ga.P......c.|
-00000300  a9 c9 e5 79 92 b4 dc 2d  f7 34 c4 c6 13 87 93 f6  |...y...-.4......|
-00000310  79 ce 96 17 03 03 00 99  5a 9b 8a c2 cb 6e 52 f7  |y.......Z....nR.|
-00000320  2a 06 03 ee 40 a2 4f 3b  b5 14 66 bb 28 8c 59 e7  |*...@.O;..f.(.Y.|
-00000330  d7 be f2 97 62 fe b8 e8  73 2b e5 b5 44 5a 1d 81  |....b...s+..DZ..|
-00000340  ce 7a a3 2f 75 38 d2 c9  4b 74 7a 22 e9 15 cf 04  |.z./u8..Ktz"....|
-00000350  2b f8 57 ff 83 ba bf cc  1e e8 79 bd ca a1 e3 89  |+.W.......y.....|
-00000360  62 ea 12 e3 f4 8a 0c 23  c1 de 92 d3 cc 29 8e 53  |b......#.....).S|
-00000370  1a f6 fc c9 05 e0 0d 80  42 f2 3e d8 9a 0d 9b 1a  |........B.>.....|
-00000380  45 66 60 e9 0a 40 f6 d9  d6 70 7b 1f 92 43 40 d8  |Ef`..@...p{..C@.|
-00000390  6d f1 ed 89 9f 22 da a4  29 a8 db c7 7a 66 fb 7e  |m...."..)...zf.~|
-000003a0  8e 53 91 9a d2 a7 78 08  68 8a a6 a8 48 f2 d3 f2  |.S....x.h...H...|
-000003b0  b8 17 03 03 00 35 a7 13  4b 3b 56 2b d8 95 d2 28  |.....5..K;V+...(|
-000003c0  7e ad b1 cf 20 56 e9 0e  52 90 ad 9e 23 b9 aa 8f  |~... V..R...#...|
-000003d0  20 14 10 9c c8 9d 87 e7  e7 d4 f5 2d ce b9 46 df  | ..........-..F.|
-000003e0  85 94 9c 59 92 b4 44 07  34 f6 e1 17 03 03 00 86  |...Y..D.4.......|
-000003f0  35 22 5b 6b 68 de 40 74  98 a0 0a 7d 01 7d cc a9  |5"[kh.@t...}.}..|
-00000400  9c 62 68 dc e1 f9 23 84  55 a9 b1 92 97 81 05 b2  |.bh...#.U.......|
-00000410  3a 47 c5 db c3 81 da 3e  c4 0c 34 35 03 7e 42 78  |:G.....>..45.~Bx|
-00000420  f3 ac 16 d3 23 5e 17 70  c6 65 2d 67 3f 69 27 8a  |....#^.p.e-g?i'.|
-00000430  01 42 a5 e2 13 64 10 5e  0a 3e 6f 8e 91 e4 72 71  |.B...d.^.>o...rq|
-00000440  c1 df 87 33 5e 20 af 62  e2 bb 95 27 b0 38 4d 7a  |...3^ .b...'.8Mz|
-00000450  22 28 85 4b 0b a5 77 9a  d8 c5 9d d2 b7 ab 08 d4  |"(.K..w.........|
-00000460  5f 1e ce 33 06 ed 66 80  2f 07 c9 bd 97 c1 aa 9e  |_..3..f./.......|
-00000470  15 83 74 ce 2b f3                                 |..t.+.|
+00000080  03 03 00 01 01 17 03 03  00 17 ed 6e e0 ce 2a 1f  |...........n..*.|
+00000090  e0 18 72 a1 ad 6e 38 82  c4 73 db ae 5b 6b 5f 8d  |..r..n8..s..[k_.|
+000000a0  ce 17 03 03 02 6d d9 e6  ad 08 ea a2 08 5a 22 5b  |.....m.......Z"[|
+000000b0  32 87 0d 6b b1 c4 59 0c  c8 bd af 20 98 22 2e 2e  |2..k..Y.... ."..|
+000000c0  7e 2f 43 3c a1 54 b2 85  8a 08 98 05 8c 43 97 32  |~/C<.T.......C.2|
+000000d0  ca bd 72 2a f8 d3 24 1e  f5 8a f9 d3 35 5f c5 6b  |..r*..$.....5_.k|
+000000e0  cc e3 46 8f 99 3b c4 2d  e8 3b ca f3 81 a6 41 87  |..F..;.-.;....A.|
+000000f0  5d 11 99 12 2c c7 43 32  e0 90 dc 1a 0c ec 4c 9f  |]...,.C2......L.|
+00000100  b0 16 bb da 79 f1 e2 05  6d 07 41 db ba 73 5c d6  |....y...m.A..s\.|
+00000110  24 87 15 2a 76 4c 9e ef  1b 5c 94 bb cb d2 ef d7  |$..*vL...\......|
+00000120  b0 50 e6 e4 dd 48 7c d1  a3 46 5b 72 23 d1 42 f0  |.P...H|..F[r#.B.|
+00000130  05 33 12 34 b1 40 4f e5  b7 82 ec 94 14 19 43 2f  |.3.4.@O.......C/|
+00000140  66 b7 a9 88 42 72 a4 0d  5e 76 4c 3e a7 f5 ae 6b  |f...Br..^vL>...k|
+00000150  ef b4 1d f0 69 37 92 de  20 5a d3 62 99 b4 56 36  |....i7.. Z.b..V6|
+00000160  8c a9 91 34 06 66 a7 bf  a8 12 21 8c e2 88 9a c3  |...4.f....!.....|
+00000170  69 60 a0 09 db 87 3a ef  4e bf f8 5a 8a d6 ae 07  |i`....:.N..Z....|
+00000180  94 1d 70 0d f3 32 dd 16  af 35 25 2a a3 80 ea 0b  |..p..2...5%*....|
+00000190  d0 e6 f0 c7 fd 95 c9 ad  91 15 ba 93 d1 0b 13 9d  |................|
+000001a0  6e d7 19 eb 69 75 1b b0  f2 d3 aa b6 55 1d d2 87  |n...iu......U...|
+000001b0  d0 fb eb 5b 9f 1b 36 7e  e9 87 7f ec 76 6a 0d 4a  |...[..6~....vj.J|
+000001c0  af dd 2f 27 2b 33 b6 24  8f f1 d7 87 71 31 8a 91  |../'+3.$....q1..|
+000001d0  b0 48 d8 13 22 ae 98 1b  7d da 8b a8 e9 9f 09 02  |.H.."...}.......|
+000001e0  92 90 72 6a 96 9e 36 0f  70 d3 f4 66 ef e6 4e 45  |..rj..6.p..f..NE|
+000001f0  e6 2b c3 0b 18 4b a2 19  fb 37 f9 63 81 31 6b 0b  |.+...K...7.c.1k.|
+00000200  eb 8b 3a 3e ab fe 6b 2f  9e 01 b4 cc cc 35 95 fa  |..:>..k/.....5..|
+00000210  8e 5c 07 a4 99 c3 9f aa  9f 73 26 0b aa 31 2b 74  |.\.......s&..1+t|
+00000220  d6 06 4b 64 1a af 18 23  87 10 d0 f2 6b 19 9b f8  |..Kd...#....k...|
+00000230  01 08 0f 71 78 c3 09 91  1d fa 1a 0d 2f 61 eb 2e  |...qx......./a..|
+00000240  db 78 b8 ec 1a a9 80 e8  88 71 74 e9 1f 70 0b 06  |.x.......qt..p..|
+00000250  9c 18 16 db 6f bc 34 af  a5 c2 2a 38 91 01 a2 7c  |....o.4...*8...||
+00000260  be f4 c7 f9 f0 a0 9a 61  d8 b5 7d e0 07 52 b7 95  |.......a..}..R..|
+00000270  0c 27 cd 4c ce 2a 55 fa  95 25 10 34 64 9b eb 59  |.'.L.*U..%.4d..Y|
+00000280  f2 3d f4 0e 25 5b a7 ab  e3 0d 4b fd 4d 68 41 3b  |.=..%[....K.MhA;|
+00000290  9d fa 05 a1 db 16 82 bb  64 aa fd 53 68 43 4c d7  |........d..ShCL.|
+000002a0  11 94 12 c9 58 6f 9a a8  85 2d d4 22 6a 89 da 4f  |....Xo...-."j..O|
+000002b0  51 4e 27 40 69 78 0d 01  0e 3f ab 02 8b 33 81 06  |QN'@ix...?...3..|
+000002c0  85 b7 1d 54 94 ec 33 21  92 18 86 4f d9 84 db 72  |...T..3!...O...r|
+000002d0  e0 40 33 21 c9 76 44 c7  68 8e 4d a5 63 0d 03 19  |.@3!.vD.h.M.c...|
+000002e0  23 1f 45 52 bc b4 8c 1a  4d 6c 7a 92 d5 ec 62 36  |#.ER....Mlz...b6|
+000002f0  d6 e1 15 05 59 78 ed 56  bd 25 46 4b a5 ad 29 7b  |....Yx.V.%FK..){|
+00000300  d9 96 30 d5 7a e1 76 a6  96 46 ae 8a 58 74 a6 8b  |..0.z.v..F..Xt..|
+00000310  97 67 d2 17 03 03 00 99  4b 45 cf 2a 67 91 dd 9c  |.g......KE.*g...|
+00000320  f9 28 8d 83 4c 89 8b bf  44 c1 d9 7a 17 10 85 9c  |.(..L...D..z....|
+00000330  79 d5 4e 2c 4f ba e6 38  bb 16 7d ff 3a 0c ae 3c  |y.N,O..8..}.:..<|
+00000340  50 eb 22 a7 df 24 73 ab  ca 46 a1 e9 a8 99 78 85  |P."..$s..F....x.|
+00000350  84 a1 13 84 53 6c 9f 3c  d7 84 6a 12 2a 5c f5 f7  |....Sl.<..j.*\..|
+00000360  23 89 19 d4 4c 21 f7 b5  b5 02 2e e3 d9 da fe c9  |#...L!..........|
+00000370  f2 37 33 f4 fd f6 45 8a  9f 73 8e 2d 80 99 e2 e4  |.73...E..s.-....|
+00000380  32 52 98 57 2c 3c 42 4f  72 de ed 89 91 68 18 ea  |2R.W,<BOr....h..|
+00000390  bb 07 64 91 27 83 04 b5  58 9b e4 28 2a fb 66 3f  |..d.'...X..(*.f?|
+000003a0  33 42 5c 9b 3f 20 fa 73  50 2c 3e bd b2 49 31 2b  |3B\.? .sP,>..I1+|
+000003b0  0b 17 03 03 00 35 f4 a5  c2 54 4d 63 16 4c 0c 73  |.....5...TMc.L.s|
+000003c0  46 06 b8 2d 31 e9 01 10  fc 57 11 32 31 f7 d2 c7  |F..-1....W.21...|
+000003d0  d4 ba 71 da f3 64 89 93  22 a4 6e ca eb 28 cf d4  |..q..d..".n..(..|
+000003e0  39 00 39 ac fa cf 45 17  ab fe cf 17 03 03 00 87  |9.9...E.........|
+000003f0  f4 ea ee 83 93 02 f2 1a  50 f6 e8 70 92 5b a3 41  |........P..p.[.A|
+00000400  4e d8 aa d9 70 f2 c1 0e  ed 87 50 d6 11 84 38 ec  |N...p.....P...8.|
+00000410  f1 2d 0c ff eb 05 14 d1  b7 37 4e cd 2d ad a0 ea  |.-.......7N.-...|
+00000420  3c ae 2d f3 0e d7 84 15  6f 07 06 16 6e 2d 79 64  |<.-.....o...n-yd|
+00000430  e8 19 4b c2 9c 36 16 48  bb 9e fc d9 90 96 b4 15  |..K..6.H........|
+00000440  4d 1b b9 ee c1 d0 de 59  90 b2 f8 a7 9b c7 f5 16  |M......Y........|
+00000450  8e 19 72 39 0c 8d 70 67  f8 e9 9b d8 6c ec 51 80  |..r9..pg....l.Q.|
+00000460  4c 77 2d f7 59 ee 8b e4  f5 6b 52 4e 3c 1a e5 e8  |Lw-.Y....kRN<...|
+00000470  fb b8 15 c0 5a be 16                              |....Z..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 75 65 be f5 cb  |..........5ue...|
-00000010  af c1 92 e0 ff 3a a2 c2  4a 08 10 9d 82 d2 27 1b  |.....:..J.....'.|
-00000020  90 cb ff 0c 16 ef 1c 04  60 20 cf e4 12 43 72 43  |........` ...CrC|
-00000030  f6 66 f1 00 14 d7 aa 2e  c3 4f 3a 47 fd 74 ed 75  |.f.......O:G.t.u|
+00000000  14 03 03 00 01 01 17 03  03 00 35 c8 76 b6 78 ce  |..........5.v.x.|
+00000010  e3 7b c8 72 95 65 c0 66  aa d4 6e 61 6f 75 9a 18  |.{.r.e.f..naou..|
+00000020  a3 43 54 45 d2 69 9a 11  d5 96 67 df 7e 08 71 1a  |.CTE.i....g.~.q.|
+00000030  66 eb ec d3 8d 20 1a 3a  e2 82 d5 3c f9 c1 6f b9  |f.... .:...<..o.|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 82 a8 9c  91 92 cf 8e 18 58 68 09  |.............Xh.|
-00000010  28 d8 29 a7 f9 76 08 2a  f4 0a 4e 53 b2 16 9d 88  |(.)..v.*..NS....|
-00000020  bf 5e 75 17 03 03 00 13  fd 46 b7 43 4f 81 44 6f  |.^u......F.CO.Do|
-00000030  23 12 5a 6b 90 f2 9a 04  88 15 9e                 |#.Zk.......|
+00000000  17 03 03 00 1e af 6d 98  41 83 13 3c 4e 60 06 a8  |......m.A..<N`..|
+00000010  f8 62 53 39 1a f5 7f 5b  54 ed 87 09 20 71 15 f6  |.bS9...[T... q..|
+00000020  ec ff 31 17 03 03 00 13  05 88 31 71 25 e2 f0 97  |..1.......1q%...|
+00000030  86 83 a4 73 ec 84 42 51  de a4 cd                 |...s..BQ...|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-P256 b/src/crypto/tls/testdata/Server-TLSv13-P256
index c5da366beb..8a95b19246 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-P256
+++ b/src/crypto/tls/testdata/Server-TLSv13-P256
@@ -1,101 +1,101 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 e3 01 00 00  df 03 03 11 f0 1e 56 d8  |..............V.|
-00000010  76 8e 41 e6 a6 e7 ff 83  54 de d4 6a 54 2c 96 b1  |v.A.....T..jT,..|
-00000020  fd c6 b3 b5 ba 39 3b 3a  57 31 ea 20 c2 02 ee 8b  |.....9;:W1. ....|
-00000030  1f 89 a2 3f 5e 24 34 2b  e2 b9 6a 21 35 70 35 04  |...?^$4+..j!5p5.|
-00000040  67 0b af ab 0c 8a b0 84  f9 fc e9 af 00 04 13 03  |g...............|
+00000000  16 03 01 00 e3 01 00 00  df 03 03 2d 03 4a 3d a9  |...........-.J=.|
+00000010  32 02 db 36 0b 4a 8c be  db 46 b0 9d 0e 63 7e 6c  |2..6.J...F...c~l|
+00000020  05 bd 11 7b ed 86 93 0a  8e 3c 05 20 a9 97 4e cc  |...{.....<. ..N.|
+00000030  6c a5 9a 89 49 e3 17 8b  f2 7c a4 eb eb 73 19 50  |l...I....|...s.P|
+00000040  e7 68 04 b8 05 28 c5 34  ef 8a 06 28 00 04 13 03  |.h...(.4...(....|
 00000050  00 ff 01 00 00 92 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 04 00 02 00 17 00 16  00 00 00 17 00 00 00 0d  |................|
 00000070  00 1e 00 1c 04 03 05 03  06 03 08 07 08 08 08 09  |................|
 00000080  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
 00000090  00 2b 00 03 02 03 04 00  2d 00 02 01 01 00 33 00  |.+......-.....3.|
-000000a0  47 00 45 00 17 00 41 04  3b 3c 68 e1 ec 2d 9d 0a  |G.E...A.;<h..-..|
-000000b0  d9 48 f3 b9 f0 7d cf 18  7b 06 55 49 98 af 49 0b  |.H...}..{.UI..I.|
-000000c0  7c 4f 69 59 37 f6 db f1  01 95 fb f4 e1 b7 2c 64  ||OiY7.........,d|
-000000d0  b4 50 7e 10 34 cc 33 74  c4 47 1a a5 bb cf 75 fe  |.P~.4.3t.G....u.|
-000000e0  ff 84 3d fe 3d 43 a4 02                           |..=.=C..|
+000000a0  47 00 45 00 17 00 41 04  8c 1a 93 91 38 e2 4f a3  |G.E...A.....8.O.|
+000000b0  b1 27 91 63 c5 34 15 17  3a 65 d4 55 76 c0 62 92  |.'.c.4..:e.Uv.b.|
+000000c0  36 87 80 19 2f c0 02 17  a5 30 b8 25 51 c0 84 1f  |6.../....0.%Q...|
+000000d0  69 f0 6a 62 86 ee 17 f7  e7 ec 39 5b 9c 02 ca f8  |i.jb......9[....|
+000000e0  f7 4c 3a 08 44 7a ad bb                           |.L:.Dz..|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 9b 02 00 00  97 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 c2 02 ee 8b  |........... ....|
-00000030  1f 89 a2 3f 5e 24 34 2b  e2 b9 6a 21 35 70 35 04  |...?^$4+..j!5p5.|
-00000040  67 0b af ab 0c 8a b0 84  f9 fc e9 af 13 03 00 00  |g...............|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 a9 97 4e cc  |........... ..N.|
+00000030  6c a5 9a 89 49 e3 17 8b  f2 7c a4 eb eb 73 19 50  |l...I....|...s.P|
+00000040  e7 68 04 b8 05 28 c5 34  ef 8a 06 28 13 03 00 00  |.h...(.4...(....|
 00000050  4f 00 2b 00 02 03 04 00  33 00 45 00 17 00 41 04  |O.+.....3.E...A.|
 00000060  1e 18 37 ef 0d 19 51 88  35 75 71 b5 e5 54 5b 12  |..7...Q.5uq..T[.|
 00000070  2e 8f 09 67 fd a7 24 20  3e b2 56 1c ce 97 28 5e  |...g..$ >.V...(^|
 00000080  f8 2b 2d 4f 9e f1 07 9f  6c 4b 5b 83 56 e2 32 42  |.+-O....lK[.V.2B|
 00000090  e9 58 b6 d7 49 a6 b5 68  1a 41 03 56 6b dc 5a 89  |.X..I..h.A.Vk.Z.|
-000000a0  14 03 03 00 01 01 17 03  03 00 17 34 c8 72 1d 54  |...........4.r.T|
-000000b0  62 f5 06 1f 90 b6 40 f1  0a d3 c8 c5 09 26 a1 69  |b.....@......&.i|
-000000c0  e0 a6 17 03 03 02 6d 84  42 b5 ee dd a7 bb c1 f8  |......m.B.......|
-000000d0  c6 08 9c c8 44 00 b7 7a  52 16 62 26 2b b8 ed 40  |....D..zR.b&+..@|
-000000e0  9d 07 91 bb 83 14 57 1e  6f a6 a7 fb d9 d5 d3 5a  |......W.o......Z|
-000000f0  08 a2 e2 ef 76 a6 2d c1  b7 5e c7 d5 bb 50 9b f8  |....v.-..^...P..|
-00000100  99 0e fe ee e2 fe 44 62  be 4d 51 04 10 fa 42 a4  |......Db.MQ...B.|
-00000110  1e 33 ac aa b5 51 55 e6  2d c2 fe 15 c0 c0 57 c4  |.3...QU.-.....W.|
-00000120  ce c9 b4 f7 bc f4 e2 1f  d5 9a 51 98 20 ce 50 81  |..........Q. .P.|
-00000130  81 56 27 3e 9c 92 b3 f7  32 c0 7e d3 ef 2f da 0d  |.V'>....2.~../..|
-00000140  e5 c1 ac e3 dd 28 34 c7  88 31 af 54 47 e8 07 b4  |.....(4..1.TG...|
-00000150  fb a3 39 9d 12 c0 b7 7b  d5 74 48 f3 c2 06 1a 79  |..9....{.tH....y|
-00000160  1d 4d fc 94 f1 8d 26 cf  55 f2 f8 18 ba 94 14 2c  |.M....&.U......,|
-00000170  7d d4 33 24 21 53 58 f2  f3 b3 72 81 f7 b4 7c 77  |}.3$!SX...r...|w|
-00000180  f7 0c 5d 2c fa 42 00 43  f4 ed b4 87 19 cb fb e4  |..],.B.C........|
-00000190  4b 06 55 8e b5 e5 55 22  96 78 25 d5 24 6d b9 c8  |K.U...U".x%.$m..|
-000001a0  35 7c 1b 4d d3 6e 1e dc  2d b0 0a 89 01 7a 31 07  |5|.M.n..-....z1.|
-000001b0  ab 91 5e 6b be db 17 a1  f6 d3 da 0d 4e 3e c2 06  |..^k........N>..|
-000001c0  69 7d 86 63 71 77 f1 7a  9b f8 9d e5 22 45 af ae  |i}.cqw.z...."E..|
-000001d0  9f 98 0d c7 0a 31 a9 d4  68 12 73 95 6d e4 d7 9a  |.....1..h.s.m...|
-000001e0  1a 78 b0 07 17 3e 5e 3a  06 7e 8f 88 5f 1f b7 72  |.x...>^:.~.._..r|
-000001f0  2e 23 9a 86 30 8a ba 40  19 34 bb 85 2f c5 b1 ba  |.#..0..@.4../...|
-00000200  8f 49 4e d5 55 51 46 7c  fa 6e e0 41 41 71 3e f1  |.IN.UQF|.n.AAq>.|
-00000210  d6 9e 54 36 7b b1 64 e4  60 6d f7 08 1d ae 13 90  |..T6{.d.`m......|
-00000220  91 a0 d3 6e c6 21 e4 58  93 5a fc 03 2e f6 80 d1  |...n.!.X.Z......|
-00000230  29 02 8d 21 3f 8b 88 ff  7b 2a 0a 27 7f be de c5  |)..!?...{*.'....|
-00000240  76 79 0e 97 f7 c0 b4 3d  a4 2e d4 4a 78 b3 f8 20  |vy.....=...Jx.. |
-00000250  4c 81 92 d3 72 6b 25 49  b5 ca 5d ae 78 58 c2 18  |L...rk%I..].xX..|
-00000260  a8 af 0b c9 c5 2d 83 5f  9d f4 5a c4 24 92 5d e1  |.....-._..Z.$.].|
-00000270  c8 a0 29 09 c3 ec 11 5e  b8 cd 58 c6 63 2c 15 cf  |..)....^..X.c,..|
-00000280  a2 aa 59 f6 7c 15 0c 15  01 eb 91 a2 f0 09 43 7f  |..Y.|.........C.|
-00000290  6e a6 6e 61 83 d2 85 fd  de 31 3e 0c c1 a3 9f f2  |n.na.....1>.....|
-000002a0  f9 67 f3 0b 83 d4 ad 50  18 c4 24 17 e8 4e 50 06  |.g.....P..$..NP.|
-000002b0  2d 54 2d e9 3c ba 3d c1  a8 11 fd a5 42 51 9e d9  |-T-.<.=.....BQ..|
-000002c0  ae f3 11 45 b3 5e cd ca  a6 de ab 61 d8 7d 8c c4  |...E.^.....a.}..|
-000002d0  dc 0c 8b f7 a1 4c cc d8  9a c7 08 a8 5e bc 95 6d  |.....L......^..m|
-000002e0  ce 62 e5 1b 64 a3 09 7d  1c f1 77 80 95 32 7a 72  |.b..d..}..w..2zr|
-000002f0  13 0a bc cc eb ae f1 01  70 03 eb 10 9d 02 69 a9  |........p.....i.|
-00000300  e8 8a e2 0d 80 e6 1d 89  bc 14 8b 1a 25 b8 fe 9a  |............%...|
-00000310  75 cd 4d a2 dc 3f 83 a4  b7 d3 16 d2 93 fc 02 32  |u.M..?.........2|
-00000320  a3 a8 11 d5 95 9e b3 b1  49 94 14 a8 0e 13 62 65  |........I.....be|
-00000330  6b b3 3b d4 17 03 03 00  99 cd 67 e6 f4 22 ef 03  |k.;.......g.."..|
-00000340  de b3 44 fa 67 ae 00 da  55 4e 0b 0c 33 2d f6 06  |..D.g...UN..3-..|
-00000350  f1 d4 88 8a 96 e9 46 1b  17 be 7c f9 5f a6 ce ec  |......F...|._...|
-00000360  31 4b 71 88 4a de 42 34  f0 5a ba 66 ae 3a 99 b2  |1Kq.J.B4.Z.f.:..|
-00000370  f4 76 93 ca f5 0c 35 1f  05 b0 3b 37 ee 21 e3 be  |.v....5...;7.!..|
-00000380  b0 1e 35 49 8a 20 85 3f  2c 5d 30 ad 10 12 a0 6e  |..5I. .?,]0....n|
-00000390  14 57 8a a0 2c e3 54 2a  5f e7 48 1b 8c 3b ca 27  |.W..,.T*_.H..;.'|
-000003a0  82 a5 06 c6 12 14 df b4  f5 6c e2 2f bf 41 a0 18  |.........l./.A..|
-000003b0  09 02 9d 5d 4c 0f 01 a0  47 f4 48 24 9b c8 1b 80  |...]L...G.H$....|
-000003c0  76 df 1a 94 6c 09 b9 60  f7 03 fc 5e f2 96 94 14  |v...l..`...^....|
-000003d0  e1 01 17 03 03 00 35 ac  74 1b 20 fc c5 5e ad c6  |......5.t. ..^..|
-000003e0  e6 ce fd 7e ec 66 37 ed  f0 61 83 d6 4c ae b8 e9  |...~.f7..a..L...|
-000003f0  61 dc 06 a0 54 27 d2 a8  c6 c0 11 d5 98 03 6e 52  |a...T'........nR|
-00000400  1c 9b 61 04 e3 71 25 a8  9b a4 d4 15 17 03 03 00  |..a..q%.........|
-00000410  86 d5 b9 33 c1 f8 26 84  cc 6f 06 1f 0a 57 39 9a  |...3..&..o...W9.|
-00000420  5a ec 42 c5 80 5e f1 12  b7 45 83 18 c1 05 bc a8  |Z.B..^...E......|
-00000430  b5 5b cb 32 b0 d5 1f 39  69 56 d3 c5 a6 0c 00 03  |.[.2...9iV......|
-00000440  b8 5d 08 2b df 97 2b 34  a4 58 14 2b f2 1d a3 fa  |.].+..+4.X.+....|
-00000450  29 65 92 01 44 30 a9 83  16 a9 b0 92 ca 1d 8e 4e  |)e..D0.........N|
-00000460  fe 0e 91 47 a7 2b 68 a9  13 31 4e aa 17 bf 39 cb  |...G.+h..1N...9.|
-00000470  95 1b 45 db 40 08 26 a6  a5 18 2a 56 91 42 9b 9f  |..E.@.&...*V.B..|
-00000480  a2 41 8a a3 a9 d8 54 63  48 c1 a7 32 5c 2b 23 e3  |.A....TcH..2\+#.|
-00000490  58 5a 74 a3 2b b3 68                              |XZt.+.h|
+000000a0  14 03 03 00 01 01 17 03  03 00 17 ba 54 2f 11 a8  |............T/..|
+000000b0  e1 fc ea 27 71 ce 16 59  ba f2 65 46 97 3f a9 be  |...'q..Y..eF.?..|
+000000c0  2d 0a 17 03 03 02 6d ed  e2 40 f3 d0 8d ed 92 ae  |-.....m..@......|
+000000d0  8a a0 b7 f1 5a ba 9b 3f  35 0a f1 63 f1 91 d5 ff  |....Z..?5..c....|
+000000e0  26 b7 57 71 d4 bd e2 38  91 fb 9a 47 b6 8a 08 3a  |&.Wq...8...G...:|
+000000f0  c2 59 32 8c 8e a4 2a e9  54 59 a8 b9 3b c8 72 34  |.Y2...*.TY..;.r4|
+00000100  8b 38 a2 19 c7 70 fd 2c  0c 73 08 ec 05 f9 7b c4  |.8...p.,.s....{.|
+00000110  74 64 af 32 4e 2b 98 fe  f6 d9 9b 10 0f 66 ec 76  |td.2N+.......f.v|
+00000120  2b b8 d1 12 23 63 0c fb  fa 56 ae a0 0b 6b 91 db  |+...#c...V...k..|
+00000130  b0 b0 6c ce 64 c6 5c 66  dd dd 2d df a8 09 a8 59  |..l.d.\f..-....Y|
+00000140  23 98 74 76 ec d1 10 57  04 2c fd e5 83 db 3c 6d  |#.tv...W.,....<m|
+00000150  6d 1a 6a 82 03 fb ab 24  a7 4c 21 ce 12 c4 3c f4  |m.j....$.L!...<.|
+00000160  0f cb ed f9 6f 26 11 03  75 72 3b 9f 4a e1 da e9  |....o&..ur;.J...|
+00000170  1e 45 73 49 96 33 26 0e  9a 83 dc 27 48 ed 8d 20  |.EsI.3&....'H.. |
+00000180  58 f4 da b5 42 9e 23 4d  b5 95 2a e2 b2 55 c4 36  |X...B.#M..*..U.6|
+00000190  3a 77 3c ca ab 52 45 94  1d 36 29 58 15 c9 ea f6  |:w<..RE..6)X....|
+000001a0  82 6d 6a e4 f0 8e 16 6f  3a 35 b0 db 3e 06 5f ea  |.mj....o:5..>._.|
+000001b0  e7 1c 89 9b 56 8a 84 5e  8f d3 65 39 46 8b bd 60  |....V..^..e9F..`|
+000001c0  c0 b5 ad 8d 13 cc 7f d0  90 08 2d c4 b5 a1 3d f7  |..........-...=.|
+000001d0  6c 14 6c 16 af 69 88 cf  50 9a 47 8f c3 a7 7f 9d  |l.l..i..P.G.....|
+000001e0  2d 75 d4 08 3b f2 ae d8  1a a8 de 67 eb 50 8c e7  |-u..;......g.P..|
+000001f0  e1 d0 37 8a 97 24 34 0f  1d 6a 65 4e 1c cf 91 6b  |..7..$4..jeN...k|
+00000200  24 20 d3 ba a0 d4 d0 95  62 fd b9 55 9c 37 69 c3  |$ ......b..U.7i.|
+00000210  27 99 f2 f5 ca 7a 27 24  3d 75 d4 5c a2 ad df e3  |'....z'$=u.\....|
+00000220  d2 69 5d cb b6 78 29 ad  90 78 f1 48 0f 80 d4 45  |.i]..x)..x.H...E|
+00000230  17 00 f4 53 9a 42 4b 6f  a2 f6 bf 95 07 e5 cc db  |...S.BKo........|
+00000240  36 d7 21 c9 42 67 40 16  d6 77 d1 5b 05 45 97 96  |6.!.Bg@..w.[.E..|
+00000250  25 8d e4 28 dc 1a c0 d6  72 2b 06 54 fc b0 0d cd  |%..(....r+.T....|
+00000260  fc 8e 06 0b 4b 1f 8c 67  8a 24 63 15 8d 60 ed 40  |....K..g.$c..`.@|
+00000270  8c d1 54 8d d8 1e 03 22  b4 5f 75 8d 4a e8 08 e8  |..T...."._u.J...|
+00000280  c8 d7 2e 84 0d 1f 9b 59  28 a2 a5 37 b7 cf 99 23  |.......Y(..7...#|
+00000290  2d 9e ab a5 dd ff 9a 3f  53 d9 56 2f a8 d7 9b 5f  |-......?S.V/..._|
+000002a0  92 44 4f 5c 6c c2 84 99  82 8c ba ff 2b 1a 0b c0  |.DO\l.......+...|
+000002b0  7c 95 8c b2 7d e3 31 d4  cd ed a0 f4 50 6a e2 07  ||...}.1.....Pj..|
+000002c0  a2 2b f8 8d 6c 9f 78 77  09 1e 8c 19 92 39 ec e3  |.+..l.xw.....9..|
+000002d0  bf 48 3f 1f 73 8e 86 bd  3f dd e8 d3 82 9b d4 1a  |.H?.s...?.......|
+000002e0  04 22 c1 8f 90 24 93 c0  52 c6 ba 74 42 fe 47 8a  |."...$..R..tB.G.|
+000002f0  07 73 a4 e9 db 92 9a b0  1c 4f 67 d7 46 30 0a c2  |.s.......Og.F0..|
+00000300  39 8a ba 8a 24 e0 73 f3  33 cb ef c6 41 75 e9 fe  |9...$.s.3...Au..|
+00000310  67 27 97 0a 8a 81 05 1e  d4 79 69 24 3a ea 74 4b  |g'.......yi$:.tK|
+00000320  cc 2a 93 bb 55 72 b6 a0  34 a8 60 ca fc 12 67 54  |.*..Ur..4.`...gT|
+00000330  70 a6 dd d9 17 03 03 00  99 a0 ed 30 29 74 62 61  |p..........0)tba|
+00000340  6a 50 3c f0 1a fa 3e 8e  7e d6 11 4a 2f b1 f7 af  |jP<...>.~..J/...|
+00000350  90 c7 16 9c e5 79 6c 69  fa f5 00 fe 94 1a f2 56  |.....yli.......V|
+00000360  ae 50 8f eb 46 ee f2 51  50 e6 d7 34 34 76 05 c0  |.P..F..QP..44v..|
+00000370  3a 28 0b 45 14 44 9e 4a  bf 3d 53 45 de 24 ea 4a  |:(.E.D.J.=SE.$.J|
+00000380  63 5a 70 fc 39 53 c4 c1  c2 62 bd 6c 7b 2c a8 57  |cZp.9S...b.l{,.W|
+00000390  f3 34 83 99 d7 52 ce 0d  07 95 a0 ff 71 d6 3c fa  |.4...R......q.<.|
+000003a0  e9 4e 79 bb c1 ac 1a 21  3e fe fe 46 0c 33 56 a6  |.Ny....!>..F.3V.|
+000003b0  09 c5 8d 13 3f 47 68 33  c2 5f c2 7c b3 bd 77 7e  |....?Gh3._.|..w~|
+000003c0  8e 20 36 25 c4 b7 63 93  c5 dd 54 d1 00 73 d8 90  |. 6%..c...T..s..|
+000003d0  45 e7 17 03 03 00 35 77  f4 d6 dd 12 6a f8 bf 23  |E.....5w....j..#|
+000003e0  10 c1 a5 53 a5 2b e0 b6  9e 6f da cf aa 99 be 98  |...S.+...o......|
+000003f0  f0 9f 0a 62 a5 d3 ff 5f  fe 17 3b 07 26 24 5b f5  |...b..._..;.&$[.|
+00000400  22 c9 20 b4 8f 08 03 ab  63 23 7a d2 17 03 03 00  |". .....c#z.....|
+00000410  87 79 4c 2d 7a ef 30 25  c1 44 10 f1 e1 30 0c 34  |.yL-z.0%.D...0.4|
+00000420  3f a8 70 e9 b0 23 b1 5c  30 a0 00 41 6c c1 83 75  |?.p..#.\0..Al..u|
+00000430  00 75 f9 f6 b9 08 9b c7  be 5b c2 40 24 43 92 66  |.u.......[.@$C.f|
+00000440  1e 13 c5 ed 7d 45 88 33  d1 fa bf 4a 44 ee 85 8c  |....}E.3...JD...|
+00000450  e9 90 8c be 5f 45 da 78  bb c0 2b 43 61 04 dd b2  |...._E.x..+Ca...|
+00000460  e3 d7 2f c3 ef c5 55 13  d1 12 13 a8 63 7d 59 9f  |../...U.....c}Y.|
+00000470  70 13 5a c7 09 36 da ee  b8 1f c8 9b f6 5d 42 e0  |p.Z..6.......]B.|
+00000480  c4 cd 49 7f b6 e8 ae 4e  c2 25 31 43 68 76 ea 06  |..I....N.%1Chv..|
+00000490  9c 35 53 46 10 fe ec 87                           |.5SF....|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 4b 47 52 ac c5  |..........5KGR..|
-00000010  e3 51 25 2d 86 7c e8 6b  4a 75 82 47 e6 43 ee 45  |.Q%-.|.kJu.G.C.E|
-00000020  36 83 d4 ea 6f 2b b9 06  66 fb 0e 9d a5 dd 13 94  |6...o+..f.......|
-00000030  15 c4 21 09 12 0d 84 2a  0b 70 57 ef ae 2a eb e2  |..!....*.pW..*..|
+00000000  14 03 03 00 01 01 17 03  03 00 35 63 d5 49 1b 6d  |..........5c.I.m|
+00000010  c5 c5 5e ae 4e 8f 75 00  a5 da 16 a8 c1 d5 96 8b  |..^.N.u.........|
+00000020  04 41 e0 8e f0 b9 13 dd  70 0a 13 b7 db 52 05 dd  |.A......p....R..|
+00000030  a0 be 58 d4 f9 7f 5b a5  17 bc 4b fe 8c a3 a4 fd  |..X...[...K.....|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 50 c4 fe  9a e5 2f d3 61 61 2d 51  |.....P..../.aa-Q|
-00000010  f1 d4 a6 d1 e9 90 65 1b  3a 84 bd ae 7f 53 a6 f2  |......e.:....S..|
-00000020  cf f9 bb 17 03 03 00 13  d2 7c be 7b 3b 74 ed 81  |.........|.{;t..|
-00000030  ff f5 c0 f4 84 f8 cd 24  0c f9 a7                 |.......$...|
+00000000  17 03 03 00 1e 53 7a 0d  da c4 f5 55 ff 4a ee e2  |.....Sz....U.J..|
+00000010  19 16 64 07 48 5c ff 6d  37 72 91 8b 42 43 a9 5f  |..d.H\.m7r..BC._|
+00000020  92 97 60 17 03 03 00 13  d7 21 73 88 27 8f ab f2  |..`......!s.'...|
+00000030  03 f7 c4 76 df 78 61 f9  43 58 50                 |...v.xa.CXP|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-RSA-RSAPSS b/src/crypto/tls/testdata/Server-TLSv13-RSA-RSAPSS
index b1c6cd016f..c46e064829 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-RSA-RSAPSS
+++ b/src/crypto/tls/testdata/Server-TLSv13-RSA-RSAPSS
@@ -1,96 +1,96 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 b2 01 00 00  ae 03 03 04 3c 95 81 f6  |............<...|
-00000010  ae 7e 74 36 13 cb f1 c2  42 6b 37 9f e0 cd b2 06  |.~t6....Bk7.....|
-00000020  2d 12 be ae c5 e8 e3 39  53 e2 09 20 0c b2 d2 0b  |-......9S.. ....|
-00000030  b8 74 04 e1 23 57 2e 4d  52 4b e1 81 7f 17 80 06  |.t..#W.MRK......|
-00000040  e1 66 41 ed d8 8a d8 dd  15 98 35 85 00 04 13 03  |.fA.......5.....|
+00000000  16 03 01 00 b2 01 00 00  ae 03 03 82 f2 2c cc cf  |.............,..|
+00000010  6f 09 ec 6f 7b a5 0b 1d  09 33 22 94 b8 df 52 be  |o..o{....3"...R.|
+00000020  f4 a0 41 5c be f4 db c7  b2 a2 ca 20 13 2e d2 75  |..A\....... ...u|
+00000030  48 59 42 d3 93 22 6e 3d  7d 10 44 e7 33 a5 5c da  |HYB.."n=}.D.3.\.|
+00000040  fd c4 8c 46 3a 26 79 dc  53 3a 3a 1b 00 04 13 03  |...F:&y.S::.....|
 00000050  00 ff 01 00 00 61 00 0b  00 04 03 00 01 02 00 0a  |.....a..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 06 00 04 08 06 08 04  |................|
 00000080  00 2b 00 03 02 03 04 00  2d 00 02 01 01 00 33 00  |.+......-.....3.|
-00000090  26 00 24 00 1d 00 20 fa  ce 58 62 e6 39 5d 7c fc  |&.$... ..Xb.9]|.|
-000000a0  3f a6 fa 02 89 d2 ae 89  a8 00 55 cc 52 fe 18 c5  |?.........U.R...|
-000000b0  7f 82 53 46 a4 54 7b                              |..SF.T{|
+00000090  26 00 24 00 1d 00 20 e4  2e b8 00 ec 94 88 6c 88  |&.$... .......l.|
+000000a0  8b ed 20 d3 62 9a a3 df  72 fe 23 8b e3 08 57 1b  |.. .b...r.#...W.|
+000000b0  f7 d1 e6 49 d3 4b 79                              |...I.Ky|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 0c b2 d2 0b  |........... ....|
-00000030  b8 74 04 e1 23 57 2e 4d  52 4b e1 81 7f 17 80 06  |.t..#W.MRK......|
-00000040  e1 66 41 ed d8 8a d8 dd  15 98 35 85 13 03 00 00  |.fA.......5.....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 13 2e d2 75  |........... ...u|
+00000030  48 59 42 d3 93 22 6e 3d  7d 10 44 e7 33 a5 5c da  |HYB.."n=}.D.3.\.|
+00000040  fd c4 8c 46 3a 26 79 dc  53 3a 3a 1b 13 03 00 00  |...F:&y.S::.....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 a9 0a a7 b2 e4 a5  |................|
-00000090  b4 9d ad 47 62 c1 1a 72  64 36 6a 84 b2 74 0d c7  |...Gb..rd6j..t..|
-000000a0  e9 17 03 03 02 6d e5 43  6c e7 db 73 c4 87 d4 fa  |.....m.Cl..s....|
-000000b0  3e 15 fb 42 59 6f cf 4e  2a 42 4a d5 92 cf f4 99  |>..BYo.N*BJ.....|
-000000c0  97 51 b4 6d e8 01 42 6d  dd ea 62 f9 07 f2 36 87  |.Q.m..Bm..b...6.|
-000000d0  cf 3b 68 7b 9a 9a 8c 42  df 40 e8 f3 e8 92 94 08  |.;h{...B.@......|
-000000e0  8d f2 7a 72 ac 65 44 d0  61 ae 56 6a 35 55 76 8f  |..zr.eD.a.Vj5Uv.|
-000000f0  d0 2b 0b a4 44 9e fb 99  ab 90 2a 4e e1 c2 ac be  |.+..D.....*N....|
-00000100  6f 01 38 2b 91 39 25 7d  a2 33 86 81 bf b5 d0 1b  |o.8+.9%}.3......|
-00000110  b8 95 a5 2c fb 12 f0 58  c8 06 d0 0c 84 a6 a6 3e  |...,...X.......>|
-00000120  ed e6 db 0a 6b d4 f4 ec  90 ae 08 da 6a 0e 46 76  |....k.......j.Fv|
-00000130  5c 9c 2e 8c 22 5f 6f 16  9f 31 aa 51 6c 24 36 42  |\..."_o..1.Ql$6B|
-00000140  d2 ef 88 d1 b6 ff c9 b2  24 1a bd 90 5c 7c 79 16  |........$...\|y.|
-00000150  db 6d 2c f6 fd bc 44 44  db b2 79 63 e2 a3 bc 2e  |.m,...DD..yc....|
-00000160  de 81 25 80 70 1f 78 69  d9 7b 54 2d c7 1a 9b ba  |..%.p.xi.{T-....|
-00000170  6e e4 a1 d1 76 a7 0e 10  27 8f 9f 15 79 6f 1d e3  |n...v...'...yo..|
-00000180  fe 3a d7 b7 20 8a f2 94  70 36 32 ad 28 e6 9a 10  |.:.. ...p62.(...|
-00000190  1b e3 1f 38 1b f2 b5 13  a9 45 44 23 4b fc df 17  |...8.....ED#K...|
-000001a0  d3 1b 6c 98 73 88 1f a3  f7 83 3f e2 71 ec 3f ab  |..l.s.....?.q.?.|
-000001b0  b3 d9 af db ce 8f d9 23  ab 90 ab c7 2a c6 44 a5  |.......#....*.D.|
-000001c0  e1 4c 4d 04 f5 66 79 00  14 77 0d 82 40 e4 ad 30  |.LM..fy..w..@..0|
-000001d0  6b 25 2c 55 c7 0c 5c 5b  4f aa f4 16 1d b5 76 12  |k%,U..\[O.....v.|
-000001e0  4d 54 ee b2 f3 7c 15 81  49 bf 25 4e b8 1a 62 06  |MT...|..I.%N..b.|
-000001f0  e0 1c c4 2b b3 f5 bc 2e  89 50 69 a1 30 28 13 ef  |...+.....Pi.0(..|
-00000200  ff 32 8c 25 7a 56 0a f9  e0 65 36 a3 b4 eb 6c 38  |.2.%zV...e6...l8|
-00000210  eb cf e7 3b b2 94 21 38  61 51 dd ec 29 da d5 e0  |...;..!8aQ..)...|
-00000220  30 fb 03 f1 a7 4c 2d e3  e0 46 7c 8b 05 74 f3 d0  |0....L-..F|..t..|
-00000230  83 5b 29 4c dd fd 64 7f  6e 9f ee 77 0c 9e 26 bc  |.[)L..d.n..w..&.|
-00000240  b6 22 48 9b 68 cd 50 f1  4e 6d c3 68 d4 dd 2b 40  |."H.h.P.Nm.h..+@|
-00000250  36 15 3e b4 0a b3 19 09  1c 40 8b 0a 77 0d f2 76  |6.>......@..w..v|
-00000260  2b 6c 44 7d 3f d1 91 b8  26 26 e2 61 fa a1 c5 73  |+lD}?...&&.a...s|
-00000270  62 5e f3 b8 59 24 a9 2f  7b 47 ae 53 7f fc f8 5d  |b^..Y$./{G.S...]|
-00000280  60 de fa 58 6e 5e 4a e8  96 99 56 1a 5d 83 4c 6e  |`..Xn^J...V.].Ln|
-00000290  33 c7 48 11 69 b6 6f a1  b7 50 d3 64 09 1f 3b 1d  |3.H.i.o..P.d..;.|
-000002a0  42 ae 32 f9 cd 71 c6 66  2f 02 81 4a 09 11 e5 6b  |B.2..q.f/..J...k|
-000002b0  56 bf fa 03 7a 02 3b 36  e5 cb 13 dd 31 81 a8 04  |V...z.;6....1...|
-000002c0  ec e0 73 97 37 00 98 c8  7a 6c 2c f8 0e 20 55 6d  |..s.7...zl,.. Um|
-000002d0  f7 07 9b 13 7f a4 47 8b  63 db 1f 27 fb 47 44 7e  |......G.c..'.GD~|
-000002e0  87 75 ed 7c 51 35 8c 62  9b 2b d6 e2 80 6e 9e db  |.u.|Q5.b.+...n..|
-000002f0  c0 0a c5 b0 dc ea 7e ce  4a 9f 87 ff 62 bb 03 e7  |......~.J...b...|
-00000300  f7 c1 9e 8a cc 14 55 d5  5c 60 ce 41 bd d9 cc da  |......U.\`.A....|
-00000310  14 69 36 17 03 03 00 99  32 c9 9f e0 6e 07 7f 3e  |.i6.....2...n..>|
-00000320  49 08 6b 91 41 c3 ba 69  45 13 59 74 e0 3b 83 e9  |I.k.A..iE.Yt.;..|
-00000330  1f 0e 0b 90 4d 87 9e b0  5c 8f 7d 74 44 82 b0 99  |....M...\.}tD...|
-00000340  5d 03 57 35 23 df ad bf  2a 01 e1 d1 75 8b a0 81  |].W5#...*...u...|
-00000350  6b e3 18 df 64 f9 b2 a7  a6 e2 7b 0d 71 f6 d6 c2  |k...d.....{.q...|
-00000360  da e1 89 a6 c3 22 fb b8  34 3b 17 ad f3 56 fb 12  |....."..4;...V..|
-00000370  da df 46 bd 49 35 1d 2f  d0 9f 1c d9 06 3d 11 39  |..F.I5./.....=.9|
-00000380  0e 07 d8 d8 16 3a 4b 97  16 b2 ec 93 ed 74 28 97  |.....:K......t(.|
-00000390  d5 44 f2 9f 9f 15 71 a5  7a 54 d1 56 99 17 6f 8c  |.D....q.zT.V..o.|
-000003a0  5c 5c f7 f1 28 0a 70 61  4d 7b 0f 62 86 44 55 35  |\\..(.paM{.b.DU5|
-000003b0  e4 17 03 03 00 35 4b 8a  d2 d4 15 3e 51 c9 97 f0  |.....5K....>Q...|
-000003c0  bb 52 e6 1f ca 62 12 61  5f d6 02 ba 95 a4 e0 0e  |.R...b.a_.......|
-000003d0  ea 5c 4c d0 6c 25 fe 17  87 8c 5b 1c 02 fb 16 11  |.\L.l%....[.....|
-000003e0  89 e4 49 d9 dd 18 e1 bd  fe d4 b8 17 03 03 00 86  |..I.............|
-000003f0  f3 f8 53 04 88 a0 01 bc  bc ed 02 8b cc fb cc 75  |..S............u|
-00000400  32 89 ec 8c 7f 78 ef 9a  62 4d 74 85 bd 53 9d 80  |2....x..bMt..S..|
-00000410  a9 92 6e 20 26 ff 34 29  b5 0e 68 36 3b 4b 61 46  |..n &.4)..h6;KaF|
-00000420  a9 fb c5 88 73 b7 5c 81  75 01 f8 d2 3d cb 74 74  |....s.\.u...=.tt|
-00000430  1b f2 a7 21 c1 14 ae 53  10 90 39 01 e6 c1 34 01  |...!...S..9...4.|
-00000440  33 af ce 32 94 35 16 13  2f 5d 8e 64 b8 d2 48 fa  |3..2.5../].d..H.|
-00000450  d9 aa d0 03 6a b0 cd f9  9d 43 18 ba e9 4c fc f2  |....j....C...L..|
-00000460  20 7c a9 d1 f2 87 0c 7d  98 78 f1 5d 7b 15 8d 15  | |.....}.x.]{...|
-00000470  f0 eb 09 a9 80 6e                                 |.....n|
+00000080  03 03 00 01 01 17 03 03  00 17 14 86 db d9 4a 74  |..............Jt|
+00000090  f2 6c ed 9e 6b a1 ac 88  be fe b5 40 14 a4 60 36  |.l..k......@..`6|
+000000a0  9e 17 03 03 02 6d 6a 41  ba 80 59 b4 a9 12 e7 7c  |.....mjA..Y....||
+000000b0  45 73 db 1c 2c 5d 0c 08  11 59 d9 4c 9f 03 66 0e  |Es..,]...Y.L..f.|
+000000c0  22 2f 1a 9e a9 5f c0 72  f1 d9 db 02 ab af f5 30  |"/..._.r.......0|
+000000d0  4c 26 18 5a 9b 19 4b 97  83 61 87 a5 c9 ab 30 6c  |L&.Z..K..a....0l|
+000000e0  7e b1 5b 09 e0 8a a0 7e  8f 31 b7 85 77 e2 2b 4b  |~.[....~.1..w.+K|
+000000f0  20 93 96 0b 8f ae 66 86  87 36 e9 6b d7 20 8a 15  | .....f..6.k. ..|
+00000100  93 4d c8 d4 6d 59 d8 7a  db 76 87 a6 7f 1c a1 10  |.M..mY.z.v......|
+00000110  82 23 4a 48 07 3d 43 44  17 02 dd 32 89 22 f2 30  |.#JH.=CD...2.".0|
+00000120  b7 6f 4c 1e d7 47 95 13  1c a5 46 e4 0f ea 23 c7  |.oL..G....F...#.|
+00000130  cf 5c a7 cb 05 a8 b3 fd  6d 3d c7 71 55 e8 85 f8  |.\......m=.qU...|
+00000140  6b 92 35 21 6f c4 4c b6  22 28 54 de 76 84 ef 90  |k.5!o.L."(T.v...|
+00000150  3a 96 a9 8a c5 26 13 46  64 2e 3f ef d0 b7 41 9e  |:....&.Fd.?...A.|
+00000160  cf 4a 6a d5 ec fc 2c c0  72 eb c6 98 27 ba 08 bb  |.Jj...,.r...'...|
+00000170  62 ef 2f 74 52 c6 34 55  2b 1d 80 6a 80 24 b8 f7  |b./tR.4U+..j.$..|
+00000180  ba 18 0a 2c 3f 86 7f 75  11 ff 7f d0 4b e1 c2 07  |...,?..u....K...|
+00000190  a0 ce 06 1b ba a9 88 fa  1a d6 7d 16 b2 6c 67 c8  |..........}..lg.|
+000001a0  c0 cc 2e fd 24 47 24 96  c0 94 93 83 60 99 1a 91  |....$G$.....`...|
+000001b0  59 49 e6 57 92 b4 bd 5f  c2 52 aa fa f8 63 80 d0  |YI.W..._.R...c..|
+000001c0  a8 23 a1 0c a2 be db 23  8a 96 e1 43 ec 69 8b 26  |.#.....#...C.i.&|
+000001d0  67 cb 3b bb f6 2c 12 af  dc ef 86 d8 c8 06 65 5a  |g.;..,........eZ|
+000001e0  e8 0b 17 17 7c 30 16 32  b7 05 24 fe 8b 73 4a 2d  |....|0.2..$..sJ-|
+000001f0  f8 2d f0 15 71 32 d1 dd  95 ad 07 c1 26 06 97 6e  |.-..q2......&..n|
+00000200  22 c0 d0 6a be 1b 49 84  c5 3a 50 c8 61 a8 d3 6a  |"..j..I..:P.a..j|
+00000210  0a 09 4d f4 d3 ba c0 bf  66 3c 1e 0b d0 df 40 12  |..M.....f<....@.|
+00000220  60 e8 c1 f7 9e 29 28 16  4b 2b 01 60 ae 1d f4 71  |`....)(.K+.`...q|
+00000230  b5 3f a9 69 4b ca 83 0a  3f 1b aa 92 37 0a e6 ce  |.?.iK...?...7...|
+00000240  30 6f 7d 40 11 ba 48 14  82 a1 6e df e3 2f 78 b2  |0o}@..H...n../x.|
+00000250  dc 92 fa 92 d2 74 ef 94  1e cc c6 af b9 1a 58 af  |.....t........X.|
+00000260  33 21 38 55 7c df b3 6b  7e 38 c9 46 67 94 0c d7  |3!8U|..k~8.Fg...|
+00000270  e3 20 49 f2 9d 93 22 9e  f3 ae e6 12 5c 6c a0 1b  |. I...".....\l..|
+00000280  8e 5f 6a 3d 26 8d 23 f9  8a 58 d1 71 d4 8a 3e e6  |._j=&.#..X.q..>.|
+00000290  47 f5 ec 4c 43 d0 a4 7c  4c b3 e1 f3 ef dd bb 1b  |G..LC..|L.......|
+000002a0  13 a0 d4 fe bf 55 67 3a  12 67 da 13 56 3d 9f 5f  |.....Ug:.g..V=._|
+000002b0  fb 73 16 c9 d9 78 90 7f  9b f6 35 3f 2f f0 71 84  |.s...x....5?/.q.|
+000002c0  97 d7 f8 59 cb 31 42 46  2e 27 ae 3c 24 60 d0 7a  |...Y.1BF.'.<$`.z|
+000002d0  30 df ed 01 63 f7 8b 21  1e f3 b6 d6 f0 57 7a 86  |0...c..!.....Wz.|
+000002e0  96 da 2d 37 94 90 7c f7  8c c4 bf 22 c9 43 6e b4  |..-7..|....".Cn.|
+000002f0  64 33 32 c1 5d 9c c8 ae  fb 20 0d bb 31 ae 72 2c  |d32.].... ..1.r,|
+00000300  ce f4 de 09 aa 93 60 3a  44 c2 a0 01 bf 43 cc 84  |......`:D....C..|
+00000310  f4 44 9e 17 03 03 00 99  18 d7 60 3d 2a 8e f6 40  |.D........`=*..@|
+00000320  30 5d d3 6b 49 b5 35 21  9a 90 e3 26 a7 17 dc 79  |0].kI.5!...&...y|
+00000330  22 5c 89 a1 24 ab 10 71  6d 64 04 65 05 7a 0c 06  |"\..$..qmd.e.z..|
+00000340  96 a8 a7 c2 f1 70 4b be  84 fc c4 55 d3 90 5d 8e  |.....pK....U..].|
+00000350  31 fe f6 24 71 45 f2 40  e9 d6 24 1e 2d a3 11 2d  |1..$qE.@..$.-..-|
+00000360  f0 55 ba 68 df c8 fb f0  f1 9a 51 e6 9c f0 0a e6  |.U.h......Q.....|
+00000370  65 fc dd 62 d0 91 ce 72  8a 7f 27 ed 20 d9 9d 8f  |e..b...r..'. ...|
+00000380  6b 1c 05 33 a5 89 ce 75  26 71 55 a0 3b 58 8e 02  |k..3...u&qU.;X..|
+00000390  9d 37 dd 9f cd d3 c5 7e  be ba ad f1 eb 5b 75 eb  |.7.....~.....[u.|
+000003a0  45 31 d1 e4 ca bf 3f 9a  f6 66 8a f9 c0 56 db 86  |E1....?..f...V..|
+000003b0  5d 17 03 03 00 35 0e 4a  03 ab fc 70 dd c7 00 e0  |]....5.J...p....|
+000003c0  93 93 8d f3 b3 1a 8e 5d  43 51 bf b1 74 78 77 35  |.......]CQ..txw5|
+000003d0  45 a7 b4 6b 6d c0 e6 b9  a4 82 3e db 1b 35 96 ab  |E..km.....>..5..|
+000003e0  35 24 b8 1f 8d c7 35 aa  85 87 c6 17 03 03 00 87  |5$....5.........|
+000003f0  75 87 27 b5 37 70 f5 08  b2 a8 b1 fb 98 c1 42 87  |u.'.7p........B.|
+00000400  e4 d8 1b 6c ac a6 28 03  92 5a 30 5b 5b 91 9a 9d  |...l..(..Z0[[...|
+00000410  43 1b 31 03 13 a7 e5 d3  82 69 5b 4a 35 df 92 80  |C.1......i[J5...|
+00000420  d3 a7 73 ab 61 60 eb 47  cb ca 91 e5 0b 8f ff e7  |..s.a`.G........|
+00000430  da 07 c9 0c c9 4b 52 f9  5d c0 a5 ce 38 78 d2 09  |.....KR.]...8x..|
+00000440  0a 5d d7 f2 07 51 b0 68  9c d2 03 86 a0 9d b2 14  |.]...Q.h........|
+00000450  b9 34 00 dd 69 34 c8 5d  5b 9b 5a cf 93 78 8f 92  |.4..i4.][.Z..x..|
+00000460  ec be 1b fd 67 df 6d a4  bf 79 d5 db f1 b5 c8 f6  |....g.m..y......|
+00000470  f3 58 02 fc c0 82 88                              |.X.....|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 11 1b 96 fd fc  |..........5.....|
-00000010  9a b4 f3 4d 6c b0 d8 bd  4a bd 0b 86 50 b3 1a d1  |...Ml...J...P...|
-00000020  02 82 80 91 a4 f8 38 97  12 59 18 49 0c 85 c5 6f  |......8..Y.I...o|
-00000030  2f b9 62 bd d7 9c 72 2b  60 eb 50 60 67 59 04 81  |/.b...r+`.P`gY..|
+00000000  14 03 03 00 01 01 17 03  03 00 35 ee 7d 75 0e 18  |..........5.}u..|
+00000010  fb 03 43 c3 79 f2 e4 de  5f 0b 66 b5 56 2f 72 d2  |..C.y..._.f.V/r.|
+00000020  a8 44 f3 30 a1 5f e2 4d  74 f4 2e 74 21 22 9c ab  |.D.0._.Mt..t!"..|
+00000030  24 21 15 17 3c ca 4f 9c  f2 ca b5 8c 41 f8 9e 33  |$!..<.O.....A..3|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e d3 6e 70  90 57 51 6b b7 b9 cb e0  |......np.WQk....|
-00000010  8e 18 2f 6b 6f af 32 45  7a bb 08 82 8f 4a a5 c3  |../ko.2Ez....J..|
-00000020  b5 50 ce 17 03 03 00 13  68 1a e3 89 f9 fb 03 55  |.P......h......U|
-00000030  f4 06 44 46 3d c8 9b 2b  73 74 46                 |..DF=..+stF|
+00000000  17 03 03 00 1e 1e 43 e9  c0 d7 07 34 99 8e 60 7f  |......C....4..`.|
+00000010  98 41 9b f2 23 34 18 4a  a0 92 8a cb 8d bd 53 a4  |.A..#4.J......S.|
+00000020  f1 59 31 17 03 03 00 13  68 a7 51 ea 2a cc 64 b0  |.Y1.....h.Q.*.d.|
+00000030  75 ad 73 59 ff 75 0c c1  3d da 3f                 |u.sY.u..=.?|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-Resume b/src/crypto/tls/testdata/Server-TLSv13-Resume
index 22778bdb33..95e18d0844 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-Resume
+++ b/src/crypto/tls/testdata/Server-TLSv13-Resume
@@ -1,58 +1,58 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 61 01 00 01  5d 03 03 33 39 e3 5f ab  |....a...]..39._.|
-00000010  2d 4f a5 59 f0 70 e7 a1  32 d1 f2 f2 88 22 1d 07  |-O.Y.p..2...."..|
-00000020  72 f2 b0 f3 58 51 d0 d5  da 33 45 20 64 6e 15 d6  |r...XQ...3E dn..|
-00000030  ff 36 2f 20 68 8d 70 4c  2d 27 45 8b 3a b9 b0 99  |.6/ h.pL-'E.:...|
-00000040  c2 78 d8 e3 2a 84 fc 09  de 62 3d eb 00 04 13 01  |.x..*....b=.....|
-00000050  00 ff 01 00 01 10 00 0b  00 04 03 00 01 02 00 0a  |................|
+00000000  16 03 01 01 62 01 00 01  5e 03 03 45 97 1a f2 a5  |....b...^..E....|
+00000010  41 22 93 8c 39 f2 ef f7  c9 02 58 d3 f1 c3 62 c7  |A"..9.....X...b.|
+00000020  e5 36 54 50 9e 2f 66 07  aa ad cb 20 34 3b 96 77  |.6TP./f.... 4;.w|
+00000030  77 cf 49 78 16 7d 7b 5c  4c 8b 5e 91 84 16 13 ee  |w.Ix.}{\L.^.....|
+00000040  9f 1f 32 df a2 9e 69 6e  95 ea 3d d7 00 04 13 01  |..2...in..=.....|
+00000050  00 ff 01 00 01 11 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 16 00 00 00 17  00 00 00 0d 00 1e 00 1c  |................|
 00000080  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000090  08 04 08 05 08 06 04 01  05 01 06 01 00 2b 00 03  |.............+..|
 000000a0  02 03 04 00 2d 00 02 01  01 00 33 00 26 00 24 00  |....-.....3.&.$.|
-000000b0  1d 00 20 03 c3 41 e0 b3  66 d7 44 65 58 53 38 0a  |.. ..A..f.DeXS8.|
-000000c0  05 d5 8d cf b4 fd 16 b7  4e 30 39 50 67 b9 61 8b  |........N09Pg.a.|
-000000d0  ba 6d 49 00 29 00 8f 00  6a 00 64 00 00 00 00 00  |.mI.)...j.d.....|
+000000b0  1d 00 20 83 a4 8c 27 2c  0c 02 4d c4 ba 81 fb f2  |.. ...',..M.....|
+000000c0  e0 6d 69 9f e6 da b2 9c  a3 e3 63 08 79 34 d2 c5  |.mi.......c.y4..|
+000000d0  5c 16 23 00 29 00 90 00  6b 00 65 00 00 00 00 00  |\.#.)...k.e.....|
 000000e0  00 00 00 00 00 00 00 00  00 00 00 94 68 2d a3 82  |............h-..|
-000000f0  51 ed 14 ef 68 ca 42 c5  5c f5 60 fc ea ba c0 8a  |Q...h.B.\.`.....|
-00000100  b6 6a 27 ae 5b c4 16 bd  47 29 f7 29 14 73 4c 95  |.j'.[...G).).sL.|
-00000110  17 76 f8 0b 23 f7 09 db  24 99 76 3c 2b 52 f2 76  |.v..#...$.v<+R.v|
-00000120  98 3d 99 d9 5c e3 3f 30  3b fa 1f 3c 16 50 e7 bd  |.=..\.?0;..<.P..|
-00000130  f2 07 36 4c 26 4f 2a 3a  5f c0 93 67 43 de d2 00  |..6L&O*:_..gC...|
-00000140  00 00 00 00 21 20 dc 2c  61 15 65 97 9f 0a 59 6a  |....! .,a.e...Yj|
-00000150  4b c1 18 87 11 b5 fa 83  6a c1 e5 0a f2 ec 3a ed  |K.......j.....:.|
-00000160  d0 74 49 8b e4 c5                                 |.tI...|
+000000f0  51 ed 14 ef 68 ca 42 c5  5c c8 cf 5f 79 2c cc b2  |Q...h.B.\.._y,..|
+00000100  ee 72 fb 49 38 e9 9b 05  4e a0 3e ca 70 03 69 28  |.r.I8...N.>.p.i(|
+00000110  72 75 95 34 2a b2 be b0  d6 99 76 3c 2b 52 f2 8f  |ru.4*.....v<+R..|
+00000120  9d bf 73 8c 79 04 d5 07  10 8a f8 c1 b7 38 bc 3a  |..s.y........8.:|
+00000130  3f 34 f1 43 6c 56 d4 96  30 86 d7 9b da b0 97 4c  |?4.ClV..0......L|
+00000140  00 00 00 00 00 21 20 16  a1 7a d4 59 cb 4d 57 73  |.....! ..z.Y.MWs|
+00000150  75 e4 3d 7d d5 56 85 5e  f2 84 3b 5c a9 94 59 5f  |u.=}.V.^..;\..Y_|
+00000160  9a 6e bc 57 60 48 a8                              |.n.W`H.|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 80 02 00 00  7c 03 03 00 00 00 00 00  |........|.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 64 6e 15 d6  |........... dn..|
-00000030  ff 36 2f 20 68 8d 70 4c  2d 27 45 8b 3a b9 b0 99  |.6/ h.pL-'E.:...|
-00000040  c2 78 d8 e3 2a 84 fc 09  de 62 3d eb 13 01 00 00  |.x..*....b=.....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 34 3b 96 77  |........... 4;.w|
+00000030  77 cf 49 78 16 7d 7b 5c  4c 8b 5e 91 84 16 13 ee  |w.Ix.}{\L.^.....|
+00000040  9f 1f 32 df a2 9e 69 6e  95 ea 3d d7 13 01 00 00  |..2...in..=.....|
 00000050  34 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |4.+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 00  |.........._X.;t.|
 00000080  29 00 02 00 00 14 03 03  00 01 01 17 03 03 00 17  |)...............|
-00000090  bd 51 2d 99 a8 f5 ae 2b  62 c5 ab b8 7f 95 f4 60  |.Q-....+b......`|
-000000a0  2e fe ee 89 2b b5 95 17  03 03 00 35 56 c3 64 f5  |....+......5V.d.|
-000000b0  6d 38 82 4f 25 b5 b9 f4  7e 3f 02 08 2e 18 a2 c8  |m8.O%...~?......|
-000000c0  62 22 7e 01 ce 12 01 86  fb 8e 84 0b fe 82 75 1e  |b"~...........u.|
-000000d0  db 40 52 8e 84 9b 10 da  31 49 49 f8 c3 9b 8b c2  |.@R.....1II.....|
-000000e0  d9 17 03 03 00 86 d1 53  45 80 db c2 74 5f 0f 9c  |.......SE...t_..|
-000000f0  a4 a5 f2 c7 0a 66 7f 80  e1 6a b7 b6 fc 89 de 9b  |.....f...j......|
-00000100  2e 29 44 7d c3 f9 25 70  b8 b0 a6 36 6f 1d 4d a3  |.)D}..%p...6o.M.|
-00000110  02 0b 48 1d 1d 51 52 b8  46 7d b5 e5 1e 15 fb eb  |..H..QR.F}......|
-00000120  f0 19 ba 32 7c ee 20 04  54 69 1a 44 d0 e9 12 9a  |...2|. .Ti.D....|
-00000130  b4 67 35 cf 99 a7 34 1a  ae d9 d9 8b 49 b4 7a 46  |.g5...4.....I.zF|
-00000140  a4 56 1c 20 ec ae 63 10  fc 7b 8f b0 75 0b 92 dc  |.V. ..c..{..u...|
-00000150  0b 78 c6 f2 8a fd b6 cf  4c 8c 18 26 bc 16 c8 ba  |.x......L..&....|
-00000160  a5 eb 30 17 49 28 26 c0  27 9f ed 27              |..0.I(&.'..'|
+00000090  49 3a 5f 64 73 d0 1a 07  4f fe f4 de 81 7b 33 1e  |I:_ds...O....{3.|
+000000a0  7f 2a da fd df 03 d0 17  03 03 00 35 90 cd 1d a8  |.*.........5....|
+000000b0  b3 5a aa 7e 0f 34 7d d2  75 d8 59 fd de 1b 14 0e  |.Z.~.4}.u.Y.....|
+000000c0  8e 86 85 df d1 0c 41 0f  f7 99 2c 00 52 38 64 5c  |......A...,.R8d\|
+000000d0  d6 74 6a 7f e4 34 2d 63  eb 90 21 6c fe 65 0c ef  |.tj..4-c..!l.e..|
+000000e0  6c 17 03 03 00 87 88 ca  a9 6c b6 cd 91 e5 5b 88  |l........l....[.|
+000000f0  c9 5d 87 79 e7 ab 15 2e  07 44 28 81 27 65 c8 76  |.].y.....D(.'e.v|
+00000100  48 4c ae 22 66 bd 56 5f  e3 52 f2 70 2f 73 4e 97  |HL."f.V_.R.p/sN.|
+00000110  e2 8e 4b 63 aa 91 05 a1  23 99 48 f3 5a 28 bb 1f  |..Kc....#.H.Z(..|
+00000120  94 d8 68 3f bb e3 c3 dc  ad 85 c8 f4 5e 61 25 a0  |..h?........^a%.|
+00000130  22 7b 61 7e f9 64 4c 8c  71 04 7a 68 7a 3d ab 91  |"{a~.dL.q.zhz=..|
+00000140  35 7a ce a6 3e b1 23 d7  32 5c a3 c0 28 8c d3 43  |5z..>.#.2\..(..C|
+00000150  25 cd 68 30 e6 d5 57 ec  fd af 83 a3 e0 83 2f 69  |%.h0..W......./i|
+00000160  a4 ce e8 84 91 62 8b 15  69 01 9d 1e c8           |.....b..i....|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 74 1d d7 07 c1  |..........5t....|
-00000010  35 f0 dd 3a b6 ca f8 1c  ce 43 8e eb c0 7b e9 e4  |5..:.....C...{..|
-00000020  93 3f 5c f5 8f c6 52 09  a9 fd e9 3c 28 3d 8c 60  |.?\...R....<(=.`|
-00000030  a0 37 80 ce bc 98 24 82  96 c0 50 10 df 1e 3e e5  |.7....$...P...>.|
+00000000  14 03 03 00 01 01 17 03  03 00 35 99 1e 5b 0c 00  |..........5..[..|
+00000010  5e 86 53 f9 ea b8 88 f7  6f 48 fb bb 32 44 87 e3  |^.S.....oH..2D..|
+00000020  d8 88 23 d0 b3 cb f8 b2  15 3d 80 89 5f 57 5d d8  |..#......=.._W].|
+00000030  97 de 43 77 5b d7 69 60  8b 04 57 3e 2f 5b d2 af  |..Cw[.i`..W>/[..|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 0b 0f 41  35 bd db ca 09 cb 5a 16  |.......A5.....Z.|
-00000010  0c bb d6 42 a6 70 4d c2  11 78 ba 51 a6 a2 91 44  |...B.pM..x.Q...D|
-00000020  dc 43 10 17 03 03 00 13  36 be 9b 91 c3 fc 9b 94  |.C......6.......|
-00000030  83 a5 fb da fc f8 5d e2  f8 7b 2c                 |......]..{,|
+00000000  17 03 03 00 1e 0e e1 ae  58 8a ca 45 0d 16 59 69  |........X..E..Yi|
+00000010  fb 31 4d 54 eb 9b 39 f9  77 d2 32 be 65 1f 5c 6f  |.1MT..9.w.2.e.\o|
+00000020  e7 85 b7 17 03 03 00 13  10 6f b3 5d 83 cb fb 04  |.........o.]....|
+00000030  7f fd 1d ec 45 e9 5e 5d  69 fb 38                 |....E.^]i.8|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-Resume-HelloRetryRequest b/src/crypto/tls/testdata/Server-TLSv13-Resume-HelloRetryRequest
index cb13497c8a..c3ce817510 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-Resume-HelloRetryRequest
+++ b/src/crypto/tls/testdata/Server-TLSv13-Resume-HelloRetryRequest
@@ -1,93 +1,94 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 5b 01 00 01  57 03 03 3b be e9 ab a4  |....[...W..;....|
-00000010  38 f2 fa ef 0e 68 3d 01  86 59 de 45 cb d7 5e 02  |8....h=..Y.E..^.|
-00000020  2e c4 a2 f9 ba 9c 17 9e  75 69 84 20 61 2d 72 35  |........ui. a-r5|
-00000030  b6 e8 09 03 bf ff 6e 1b  69 d0 c5 fa 10 a0 28 9d  |......n.i.....(.|
-00000040  19 b4 4a 99 81 61 75 cc  2e 16 42 50 00 04 13 01  |..J..au...BP....|
-00000050  00 ff 01 00 01 0a 00 0b  00 04 03 00 01 02 00 0a  |................|
+00000000  16 03 01 01 5c 01 00 01  58 03 03 3f 06 8a 40 03  |....\...X..?..@.|
+00000010  ec e1 c6 76 79 2d d2 3d  c3 f1 1c e5 f8 32 a9 ea  |...vy-.=.....2..|
+00000020  83 93 62 25 81 0f 27 f3  64 dd d1 20 18 75 f7 cf  |..b%..'.d.. .u..|
+00000030  f5 f7 36 20 d8 66 df 58  38 31 12 cc 0f 30 d4 ac  |..6 .f.X81...0..|
+00000040  f6 da f4 84 74 08 73 c9  12 14 77 e6 00 04 13 01  |....t.s...w.....|
+00000050  00 ff 01 00 01 0b 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 06 00 04 00 1d 00 17  00 23 00 00 00 16 00 00  |.........#......|
 00000070  00 17 00 00 00 0d 00 1e  00 1c 04 03 05 03 06 03  |................|
 00000080  08 07 08 08 08 09 08 0a  08 0b 08 04 08 05 08 06  |................|
 00000090  04 01 05 01 06 01 00 2b  00 03 02 03 04 00 2d 00  |.......+......-.|
-000000a0  02 01 01 00 33 00 26 00  24 00 1d 00 20 6e e3 10  |....3.&.$... n..|
-000000b0  2f c3 dc a5 0f 6d 1a d8  81 79 4b 2e 23 a3 b8 d5  |/....m...yK.#...|
-000000c0  e0 c4 ac 5a 02 02 b2 a8  46 2c 57 fe 53 00 29 00  |...Z....F,W.S.).|
-000000d0  8f 00 6a 00 64 00 00 00  00 00 00 00 00 00 00 00  |..j.d...........|
+000000a0  02 01 01 00 33 00 26 00  24 00 1d 00 20 e2 25 9f  |....3.&.$... .%.|
+000000b0  50 96 71 41 ab b5 ea 0a  17 71 61 91 74 19 8b f1  |P.qA.....qa.t...|
+000000c0  b8 4f f2 d9 2f 2c dc 16  c3 d6 82 15 48 00 29 00  |.O../,......H.).|
+000000d0  90 00 6b 00 65 00 00 00  00 00 00 00 00 00 00 00  |..k.e...........|
 000000e0  00 00 00 00 00 94 68 2d  a3 82 51 ed 14 ef 68 ca  |......h-..Q...h.|
-000000f0  42 c5 5c f5 60 fc ea ba  c0 8a b6 6a 27 ae 5b c4  |B.\.`......j'.[.|
-00000100  16 bd 47 29 f7 29 14 73  4c 95 17 76 f8 0b 23 f7  |..G).).sL..v..#.|
-00000110  09 db 24 99 76 3c 2b 52  f2 76 98 3d 99 d9 5c e3  |..$.v<+R.v.=..\.|
-00000120  3f 30 3b fa 1f 3c 16 50  e7 bd f2 07 36 4c 26 4f  |?0;..<.P....6L&O|
-00000130  2a 3a 5f c0 93 67 43 de  d2 00 00 00 00 00 21 20  |*:_..gC.......! |
-00000140  5b 21 90 5a 0e 9e 38 4e  2a a0 a5 98 cc 12 7b 52  |[!.Z..8N*.....{R|
-00000150  a9 29 90 9c 5f 15 88 94  25 23 97 d5 33 6d 71 97  |.).._...%#..3mq.|
+000000f0  42 c5 5c c8 cf 5f 79 2c  cc b2 ee 72 fb 49 38 e9  |B.\.._y,...r.I8.|
+00000100  9b 05 4e a0 3e ca 70 03  69 28 72 75 95 34 2a b2  |..N.>.p.i(ru.4*.|
+00000110  be b0 d6 99 76 3c 2b 52  f2 8f 9d bf 73 8c 79 04  |....v<+R....s.y.|
+00000120  d5 07 10 8a f8 c1 b7 38  bc 3a 3f 34 f1 43 6c 56  |.......8.:?4.ClV|
+00000130  d4 96 30 86 d7 9b da b0  97 4c 00 00 00 00 00 21  |..0......L.....!|
+00000140  20 d4 3f fe bd 45 9e 9e  ad 02 1a c9 00 4d 3a e6  | .?..E.......M:.|
+00000150  c5 ec ef c5 5b 3e 05 9e  91 45 6c 1d ca 66 4e 8d  |....[>...El..fN.|
+00000160  e7                                                |.|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 58 02 00 00  54 03 03 cf 21 ad 74 e5  |....X...T...!.t.|
 00000010  9a 61 11 be 1d 8c 02 1e  65 b8 91 c2 a2 11 16 7a  |.a......e......z|
-00000020  bb 8c 5e 07 9e 09 e2 c8  a8 33 9c 20 61 2d 72 35  |..^......3. a-r5|
-00000030  b6 e8 09 03 bf ff 6e 1b  69 d0 c5 fa 10 a0 28 9d  |......n.i.....(.|
-00000040  19 b4 4a 99 81 61 75 cc  2e 16 42 50 13 01 00 00  |..J..au...BP....|
+00000020  bb 8c 5e 07 9e 09 e2 c8  a8 33 9c 20 18 75 f7 cf  |..^......3. .u..|
+00000030  f5 f7 36 20 d8 66 df 58  38 31 12 cc 0f 30 d4 ac  |..6 .f.X81...0..|
+00000040  f6 da f4 84 74 08 73 c9  12 14 77 e6 13 01 00 00  |....t.s...w.....|
 00000050  0c 00 2b 00 02 03 04 00  33 00 02 00 17 14 03 03  |..+.....3.......|
 00000060  00 01 01                                          |...|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 16 03  03 01 7c 01 00 01 78 03  |..........|...x.|
-00000010  03 3b be e9 ab a4 38 f2  fa ef 0e 68 3d 01 86 59  |.;....8....h=..Y|
-00000020  de 45 cb d7 5e 02 2e c4  a2 f9 ba 9c 17 9e 75 69  |.E..^.........ui|
-00000030  84 20 61 2d 72 35 b6 e8  09 03 bf ff 6e 1b 69 d0  |. a-r5......n.i.|
-00000040  c5 fa 10 a0 28 9d 19 b4  4a 99 81 61 75 cc 2e 16  |....(...J..au...|
-00000050  42 50 00 04 13 01 00 ff  01 00 01 2b 00 0b 00 04  |BP.........+....|
+00000000  14 03 03 00 01 01 16 03  03 01 7d 01 00 01 79 03  |..........}...y.|
+00000010  03 3f 06 8a 40 03 ec e1  c6 76 79 2d d2 3d c3 f1  |.?..@....vy-.=..|
+00000020  1c e5 f8 32 a9 ea 83 93  62 25 81 0f 27 f3 64 dd  |...2....b%..'.d.|
+00000030  d1 20 18 75 f7 cf f5 f7  36 20 d8 66 df 58 38 31  |. .u....6 .f.X81|
+00000040  12 cc 0f 30 d4 ac f6 da  f4 84 74 08 73 c9 12 14  |...0......t.s...|
+00000050  77 e6 00 04 13 01 00 ff  01 00 01 2c 00 0b 00 04  |w..........,....|
 00000060  03 00 01 02 00 0a 00 06  00 04 00 1d 00 17 00 23  |...............#|
 00000070  00 00 00 16 00 00 00 17  00 00 00 0d 00 1e 00 1c  |................|
 00000080  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000090  08 04 08 05 08 06 04 01  05 01 06 01 00 2b 00 03  |.............+..|
 000000a0  02 03 04 00 2d 00 02 01  01 00 33 00 47 00 45 00  |....-.....3.G.E.|
-000000b0  17 00 41 04 3b 7f 27 0d  29 d3 6a df 95 e7 e2 e6  |..A.;.'.).j.....|
-000000c0  1f 0c a7 4e e2 9c 10 d9  b6 17 d8 2f 44 f7 6b cc  |...N......./D.k.|
-000000d0  95 78 1d d6 a4 55 63 59  27 dc 33 e4 63 1b dc dc  |.x...UcY'.3.c...|
-000000e0  cd bc e2 41 87 a0 c3 9c  e1 31 4e 1c de 98 db e6  |...A.....1N.....|
-000000f0  44 c9 8f 54 00 29 00 8f  00 6a 00 64 00 00 00 00  |D..T.)...j.d....|
+000000b0  17 00 41 04 9e c3 66 67  9b 02 09 0f bb fb 50 47  |..A...fg......PG|
+000000c0  f9 d1 71 bf 57 d6 ab f0  e6 3e 71 c2 98 93 e5 7c  |..q.W....>q....||
+000000d0  8a fc 15 d7 c3 3d 25 12  82 ab 25 2c 98 62 fd 43  |.....=%...%,.b.C|
+000000e0  96 da 7c 8e 69 2a a0 b6  e0 a4 d5 8b 11 75 88 1a  |..|.i*.......u..|
+000000f0  a4 6e 07 54 00 29 00 90  00 6b 00 65 00 00 00 00  |.n.T.)...k.e....|
 00000100  00 00 00 00 00 00 00 00  00 00 00 00 94 68 2d a3  |.............h-.|
-00000110  82 51 ed 14 ef 68 ca 42  c5 5c f5 60 fc ea ba c0  |.Q...h.B.\.`....|
-00000120  8a b6 6a 27 ae 5b c4 16  bd 47 29 f7 29 14 73 4c  |..j'.[...G).).sL|
-00000130  95 17 76 f8 0b 23 f7 09  db 24 99 76 3c 2b 52 f2  |..v..#...$.v<+R.|
-00000140  76 98 3d 99 d9 5c e3 3f  30 3b fa 1f 3c 16 50 e7  |v.=..\.?0;..<.P.|
-00000150  bd f2 07 36 4c 26 4f 2a  3a 5f c0 93 67 43 de d2  |...6L&O*:_..gC..|
-00000160  00 00 00 00 00 21 20 08  55 a9 ec 2e f7 88 95 1f  |.....! .U.......|
-00000170  ca e0 ec 74 02 bd 28 75  61 ba 6a 98 16 4a 92 22  |...t..(ua.j..J."|
-00000180  50 51 55 05 7e 7f b2                              |PQU.~..|
+00000110  82 51 ed 14 ef 68 ca 42  c5 5c c8 cf 5f 79 2c cc  |.Q...h.B.\.._y,.|
+00000120  b2 ee 72 fb 49 38 e9 9b  05 4e a0 3e ca 70 03 69  |..r.I8...N.>.p.i|
+00000130  28 72 75 95 34 2a b2 be  b0 d6 99 76 3c 2b 52 f2  |(ru.4*.....v<+R.|
+00000140  8f 9d bf 73 8c 79 04 d5  07 10 8a f8 c1 b7 38 bc  |...s.y........8.|
+00000150  3a 3f 34 f1 43 6c 56 d4  96 30 86 d7 9b da b0 97  |:?4.ClV..0......|
+00000160  4c 00 00 00 00 00 21 20  05 14 40 f9 a1 cc 45 81  |L.....! ..@...E.|
+00000170  73 9e f5 ea af 27 2b 46  cd 8f 8a 83 1d ce b5 96  |s....'+F........|
+00000180  ab 78 ed 4d 03 ce 63 c9                           |.x.M..c.|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 a1 02 00 00  9d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 61 2d 72 35  |........... a-r5|
-00000030  b6 e8 09 03 bf ff 6e 1b  69 d0 c5 fa 10 a0 28 9d  |......n.i.....(.|
-00000040  19 b4 4a 99 81 61 75 cc  2e 16 42 50 13 01 00 00  |..J..au...BP....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 18 75 f7 cf  |........... .u..|
+00000030  f5 f7 36 20 d8 66 df 58  38 31 12 cc 0f 30 d4 ac  |..6 .f.X81...0..|
+00000040  f6 da f4 84 74 08 73 c9  12 14 77 e6 13 01 00 00  |....t.s...w.....|
 00000050  55 00 2b 00 02 03 04 00  33 00 45 00 17 00 41 04  |U.+.....3.E...A.|
 00000060  1e 18 37 ef 0d 19 51 88  35 75 71 b5 e5 54 5b 12  |..7...Q.5uq..T[.|
 00000070  2e 8f 09 67 fd a7 24 20  3e b2 56 1c ce 97 28 5e  |...g..$ >.V...(^|
 00000080  f8 2b 2d 4f 9e f1 07 9f  6c 4b 5b 83 56 e2 32 42  |.+-O....lK[.V.2B|
 00000090  e9 58 b6 d7 49 a6 b5 68  1a 41 03 56 6b dc 5a 89  |.X..I..h.A.Vk.Z.|
-000000a0  00 29 00 02 00 00 17 03  03 00 17 13 bf a1 f8 51  |.).............Q|
-000000b0  6a 55 20 42 70 b9 b1 f9  9b a0 27 92 89 1a 38 45  |jU Bp.....'...8E|
-000000c0  d0 35 17 03 03 00 35 4c  18 4f 0f b1 6b 61 da a6  |.5....5L.O..ka..|
-000000d0  5d 16 ed c7 78 6e 7b 01  4c 64 a0 5f 10 53 b5 ed  |]...xn{.Ld._.S..|
-000000e0  9f 07 98 8f b1 49 f4 8c  ac 91 51 51 5e 10 59 b0  |.....I....QQ^.Y.|
-000000f0  14 f2 c9 1d 3a 64 a3 bd  8b 3e 1e 22 17 03 03 00  |....:d...>."....|
-00000100  86 14 ec 8f d0 96 e1 c4  b3 18 91 b8 50 df 33 90  |............P.3.|
-00000110  48 55 ff a6 7b 59 4f 3a  8b a2 a1 78 25 01 50 85  |HU..{YO:...x%.P.|
-00000120  85 9d a8 2b 79 e6 69 12  56 43 89 af c7 f4 5a 76  |...+y.i.VC....Zv|
-00000130  2b 28 3d 1d 63 d6 53 a1  1f af d6 98 6d e9 d6 fa  |+(=.c.S.....m...|
-00000140  64 52 cb 85 22 60 75 1f  6e 4d 51 2d 8f a8 d6 41  |dR.."`u.nMQ-...A|
-00000150  cb 2c cc ae 38 fd 37 84  83 fd 62 d8 09 d9 fd d4  |.,..8.7...b.....|
-00000160  e1 7f 74 db 1e d7 9c b2  e3 0b 3f e6 19 12 1f 63  |..t.......?....c|
-00000170  61 f8 ed e2 84 56 38 86  b7 6e 28 42 d7 c4 5e 75  |a....V8..n(B..^u|
-00000180  6b 44 aa 84 27 15 5e                              |kD..'.^|
+000000a0  00 29 00 02 00 00 17 03  03 00 17 9e 34 cf 17 aa  |.)..........4...|
+000000b0  19 76 ec 02 40 eb c4 22  1c ed fe 65 fc 80 21 51  |.v..@.."...e..!Q|
+000000c0  e7 41 17 03 03 00 35 7d  6a 3e 39 5f 33 a3 39 fd  |.A....5}j>9_3.9.|
+000000d0  02 2f 39 c3 38 66 99 5f  0b b5 f0 25 7f 24 43 8a  |./9.8f._...%.$C.|
+000000e0  21 24 59 b9 7b fe 08 97  31 a3 9c 9d e2 b0 51 e4  |!$Y.{...1.....Q.|
+000000f0  c6 bc 9c 60 09 02 64 32  58 0e 8b 0b 17 03 03 00  |...`..d2X.......|
+00000100  87 f9 51 62 d5 c6 03 6c  d1 0d 99 7a 64 c9 d1 24  |..Qb...l...zd..$|
+00000110  7d 1f 30 97 47 a0 7f 9a  ff 3b 03 b7 ef 67 cb 0f  |}.0.G....;...g..|
+00000120  b7 f5 d7 9d 38 4a dc 94  85 f3 73 be fa c0 fc 95  |....8J....s.....|
+00000130  a6 ae ae e2 1b 96 1b 13  4e ee 13 e2 4b 8e 09 e1  |........N...K...|
+00000140  65 d4 0c 4f 79 8b 35 fb  a2 a6 e1 e0 07 2b 4f 08  |e..Oy.5......+O.|
+00000150  f5 1b 8a 48 48 aa 20 b3  dc 80 2f 48 8d 06 2b 0c  |...HH. .../H..+.|
+00000160  ca dc a5 f7 2c 85 cb 18  ef a8 e1 6d 31 60 13 c3  |....,......m1`..|
+00000170  14 56 b9 bd ba b6 23 a6  b2 02 92 d7 1d b3 c5 04  |.V....#.........|
+00000180  86 0a 16 68 4a 94 26 70                           |...hJ.&p|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 35 d4 a7 29  b7 8f 6c e7 bf b5 da d0  |....5..)..l.....|
-00000010  41 eb 71 1b 57 4e 8c 42  69 e3 bd 82 ca c5 92 71  |A.q.WN.Bi......q|
-00000020  31 9a 24 14 50 83 12 ce  09 ec 5d 15 3b 78 dd b1  |1.$.P.....].;x..|
-00000030  de c6 25 5a 6d 15 11 40  49 f6                    |..%Zm..@I.|
+00000000  17 03 03 00 35 7d 78 c8  5b 00 b4 99 b4 72 9e 07  |....5}x.[....r..|
+00000010  4a 61 ed 4d 1e fd ac 80  80 f0 0b 5e 51 e8 98 b7  |Ja.M.......^Q...|
+00000020  fb 4e 09 05 b0 af d6 9f  24 3b 1d 1e 7f 67 14 21  |.N......$;...g.!|
+00000030  19 2b b6 ba d6 27 03 28  4f 2e                    |.+...'.(O.|
 >>> Flow 6 (server to client)
-00000000  17 03 03 00 1e 34 1c 6e  69 e5 e1 03 d0 19 9d 18  |.....4.ni.......|
-00000010  26 97 7a 56 ba 9f 86 6a  68 5a 0a d2 f7 4d 3b 08  |&.zV...jhZ...M;.|
-00000020  bc 2c 6b 17 03 03 00 13  b3 42 96 c6 9b 32 86 e1  |.,k......B...2..|
-00000030  76 37 32 3c 90 86 b9 23  0e c3 29                 |v72<...#..)|
+00000000  17 03 03 00 1e 9f f4 05  19 47 13 a8 a4 99 fd 6c  |.........G.....l|
+00000010  17 7f d1 66 4b 3c 52 26  1f b3 7c 3b c2 14 34 ec  |...fK<R&..|;..4.|
+00000020  b7 b3 3e 17 03 03 00 13  34 c3 4e a8 1f c2 2e cb  |..>.....4.N.....|
+00000030  dd 82 be a3 c1 0f 1d 3f  cd 63 84                 |.......?.c.|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-X25519 b/src/crypto/tls/testdata/Server-TLSv13-X25519
index cfb2cb6ea1..24b5a6c6e1 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-X25519
+++ b/src/crypto/tls/testdata/Server-TLSv13-X25519
@@ -1,97 +1,97 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 c2 01 00 00  be 03 03 02 63 d0 b7 50  |............c..P|
-00000010  8d da ba 48 da ba 30 47  d0 fe 7a ec 58 77 4b 0f  |...H..0G..z.XwK.|
-00000020  48 67 04 2b ce 53 09 90  4d 6e 14 20 4e 91 d4 fa  |Hg.+.S..Mn. N...|
-00000030  e8 aa 14 51 f6 af 56 01  12 62 e6 a9 e1 0b d7 90  |...Q..V..b......|
-00000040  9f 44 5a c8 dc b6 88 52  1a 97 5d 9a 00 04 13 03  |.DZ....R..].....|
+00000000  16 03 01 00 c2 01 00 00  be 03 03 ab 09 49 53 54  |.............IST|
+00000010  49 8b fb d2 08 6e 26 25  36 7a 6e 55 0f 96 ea 1d  |I....n&%6znU....|
+00000020  3c 6d 7b 14 66 ff 2c 6b  60 cc 05 20 1f 15 69 ce  |<m{.f.,k`.. ..i.|
+00000030  3b cf ef 1e 71 1b 0e 91  05 61 f7 17 b3 32 4c 52  |;...q....a...2LR|
+00000040  13 88 7a c1 27 18 0e 41  5b bf ac 96 00 04 13 03  |..z.'..A[.......|
 00000050  00 ff 01 00 00 71 00 0b  00 04 03 00 01 02 00 0a  |.....q..........|
 00000060  00 04 00 02 00 1d 00 16  00 00 00 17 00 00 00 0d  |................|
 00000070  00 1e 00 1c 04 03 05 03  06 03 08 07 08 08 08 09  |................|
 00000080  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
 00000090  00 2b 00 03 02 03 04 00  2d 00 02 01 01 00 33 00  |.+......-.....3.|
-000000a0  26 00 24 00 1d 00 20 fd  6e ba 34 4a 87 99 5b 19  |&.$... .n.4J..[.|
-000000b0  84 73 86 b0 7e 32 64 7d  b6 da 59 c0 4b a4 9b 8a  |.s..~2d}..Y.K...|
-000000c0  e9 c2 8b 2c a8 4f 75                              |...,.Ou|
+000000a0  26 00 24 00 1d 00 20 df  69 bb 81 8d b9 dd 18 8e  |&.$... .i.......|
+000000b0  c8 af 70 28 de e2 2e e0  86 9b 6d 29 e2 4d e9 87  |..p(......m).M..|
+000000c0  5a 53 fe 50 6f 1a 11                              |ZS.Po..|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 4e 91 d4 fa  |........... N...|
-00000030  e8 aa 14 51 f6 af 56 01  12 62 e6 a9 e1 0b d7 90  |...Q..V..b......|
-00000040  9f 44 5a c8 dc b6 88 52  1a 97 5d 9a 13 03 00 00  |.DZ....R..].....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 1f 15 69 ce  |........... ..i.|
+00000030  3b cf ef 1e 71 1b 0e 91  05 61 f7 17 b3 32 4c 52  |;...q....a...2LR|
+00000040  13 88 7a c1 27 18 0e 41  5b bf ac 96 13 03 00 00  |..z.'..A[.......|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 c3 cb 61 99 a7 7a  |............a..z|
-00000090  c5 02 e3 cd a8 35 3a 0c  c7 81 4c f9 41 a1 1a f7  |.....5:...L.A...|
-000000a0  74 17 03 03 02 6d 7d 0d  fc 79 87 ef b7 ef 98 c7  |t....m}..y......|
-000000b0  55 92 8a 89 c3 c0 d2 2f  a4 bf 09 a0 82 ff c1 2f  |U....../......./|
-000000c0  05 ce 80 e8 f0 76 7c ce  a8 04 74 93 3c c6 28 da  |.....v|...t.<.(.|
-000000d0  46 b5 b5 14 3f ff cd 95  29 6b 68 b5 c5 3d 2c d3  |F...?...)kh..=,.|
-000000e0  1d ec df b5 92 93 37 1e  af 56 4d 1b 73 a8 20 a9  |......7..VM.s. .|
-000000f0  ec 9f e1 25 9b 6e 0a 99  fe c5 03 13 19 ac 84 38  |...%.n.........8|
-00000100  7d d6 ce 6e 8f dc 1a 41  34 3d 39 bb a8 e0 9d 58  |}..n...A4=9....X|
-00000110  d7 84 db e8 92 94 eb 5f  c7 bb e0 4f 8c d1 cb 76  |......._...O...v|
-00000120  5a 38 ef 0d 55 a2 6b af  95 9a 52 a9 fc 12 e5 25  |Z8..U.k...R....%|
-00000130  c0 05 e8 ef 78 cb be 47  fd ec 20 c3 19 51 38 1e  |....x..G.. ..Q8.|
-00000140  15 65 27 4f 6a a0 0b cc  c4 22 49 15 0e d5 b5 48  |.e'Oj...."I....H|
-00000150  df d4 3b 28 3f d9 48 6b  1f 60 ac e6 29 04 26 90  |..;(?.Hk.`..).&.|
-00000160  d0 4c f5 f1 b9 9c 87 59  e8 3c 86 d8 62 42 77 76  |.L.....Y.<..bBwv|
-00000170  46 2b b0 d4 6e 7d eb 31  75 31 6a 76 52 57 62 4f  |F+..n}.1u1jvRWbO|
-00000180  56 b7 a6 99 09 61 52 18  69 15 4d 5c 23 d2 a7 4f  |V....aR.i.M\#..O|
-00000190  f0 3c bc 2b fe 6d e1 e7  11 53 9b 58 a7 7c f3 cf  |.<.+.m...S.X.|..|
-000001a0  ef 08 58 9f 51 c5 04 cd  c1 1e 8a e3 41 2d 3c d5  |..X.Q.......A-<.|
-000001b0  cb 67 aa 2c 0f 86 54 0b  a0 5b 9f 6f 42 b5 2d 39  |.g.,..T..[.oB.-9|
-000001c0  ed c0 29 75 01 2b 6f 82  df e0 3c a1 2c d3 80 50  |..)u.+o...<.,..P|
-000001d0  c2 0e c7 da f3 ed e5 aa  17 2f 96 af c4 d9 41 da  |........./....A.|
-000001e0  87 a9 be 75 f8 26 9a e3  01 17 eb 2d 2b e9 3d c1  |...u.&.....-+.=.|
-000001f0  a4 3c 24 dd c0 7b 6d 08  79 46 7a 26 31 cc 30 7e  |.<$..{m.yFz&1.0~|
-00000200  ab 9e 76 9f e5 27 7d cb  98 82 f7 f9 c3 f3 59 ef  |..v..'}.......Y.|
-00000210  32 b7 bf 13 53 4f d0 b2  45 0d aa 38 f1 2b 19 eb  |2...SO..E..8.+..|
-00000220  d1 96 87 39 8e 44 d0 f2  f2 97 5d 40 98 2a c0 11  |...9.D....]@.*..|
-00000230  c9 cb 6c 1c 24 e3 d1 0f  8b 8a d6 11 26 c1 1d b1  |..l.$.......&...|
-00000240  a6 3a 87 bb 6f 3f ea 7b  e8 9f 92 74 01 e5 90 f2  |.:..o?.{...t....|
-00000250  b6 a9 6f e0 a6 ac 58 0b  5c c9 12 08 3d a1 fe 76  |..o...X.\...=..v|
-00000260  0d 2c 25 1f fa 08 ee 7a  13 fc e0 13 84 9c 41 95  |.,%....z......A.|
-00000270  fc 49 c1 f5 75 9b 83 9a  5f 5a 97 d4 a8 4e 1f 0a  |.I..u..._Z...N..|
-00000280  6f 75 c9 cf 04 8d ec 6f  8c a2 65 36 be 56 01 b0  |ou.....o..e6.V..|
-00000290  b8 26 f9 2b 46 2f 22 ff  12 0a a4 f3 5e 24 52 94  |.&.+F/".....^$R.|
-000002a0  59 71 92 c5 05 da 03 3d  07 9b 64 55 a7 20 0e ec  |Yq.....=..dU. ..|
-000002b0  c6 6b 02 6b 78 1c b1 ab  1b f7 19 da 4f 02 4e 2d  |.k.kx.......O.N-|
-000002c0  01 a1 0d fe 69 64 39 0d  9c 6c cb 95 ab b5 ae 39  |....id9..l.....9|
-000002d0  f9 1c a0 41 f3 94 37 5c  a1 2a 5d 0b 78 c3 a5 cc  |...A..7\.*].x...|
-000002e0  da ef e5 2a d5 19 c4 26  af 1d dd b8 9d d6 2c 1f  |...*...&......,.|
-000002f0  29 c9 36 15 e7 75 ed eb  8c dc b5 23 4d 7f 09 25  |).6..u.....#M..%|
-00000300  d5 7f f0 5f a1 f6 44 2f  f7 bc c3 bf e3 e6 39 23  |..._..D/......9#|
-00000310  88 25 ba 17 03 03 00 99  64 fd eb ce cf 84 56 25  |.%......d.....V%|
-00000320  a0 8c dd 06 ca 62 ac 59  a2 ee c0 cc 9b d6 29 b7  |.....b.Y......).|
-00000330  12 2b e3 b0 e7 2b 81 e9  ab a8 ff 35 04 f0 fc 0d  |.+...+.....5....|
-00000340  4a 43 76 49 b0 59 02 e0  23 4c c8 3b b8 50 dc 45  |JCvI.Y..#L.;.P.E|
-00000350  63 ea 87 66 ed 6e e8 39  ac 86 96 2a b1 5b 42 2f  |c..f.n.9...*.[B/|
-00000360  42 37 34 96 ef 85 91 ac  6f 70 be 73 15 5d 1b 37  |B74.....op.s.].7|
-00000370  70 4c a6 52 97 56 47 ac  5f 78 13 28 19 bc b1 63  |pL.R.VG._x.(...c|
-00000380  e5 f1 4a cd f8 30 f6 de  26 f5 14 01 a6 28 5c 29  |..J..0..&....(\)|
-00000390  c2 45 50 c4 63 a3 a4 53  d6 e6 ce 2d 8c d7 99 8f  |.EP.c..S...-....|
-000003a0  17 2a c5 89 4e 75 aa 0b  63 36 54 c6 31 81 e4 1b  |.*..Nu..c6T.1...|
-000003b0  8b 17 03 03 00 35 8f a9  76 50 07 d6 f5 ed 2a a4  |.....5..vP....*.|
-000003c0  92 d7 ec ec eb d6 9a 29  8d c9 b3 58 a1 55 af 02  |.......)...X.U..|
-000003d0  cc bc 0e e2 9c 7d 9a 71  02 70 9f 30 f3 76 66 40  |.....}.q.p.0.vf@|
-000003e0  7c b7 7b d9 0f 10 f9 76  d6 39 d2 17 03 03 00 86  ||.{....v.9......|
-000003f0  03 90 a4 91 13 dd 86 68  00 31 ef 7d d5 2f f5 89  |.......h.1.}./..|
-00000400  da d2 76 c0 a9 ec d4 6e  73 82 66 02 0f 5b c7 c0  |..v....ns.f..[..|
-00000410  1b e3 83 63 c2 b9 36 72  77 1d ec 18 fe b7 ba 46  |...c..6rw......F|
-00000420  28 94 c8 0f 81 9b 34 df  9f 52 4a 6d f9 7e 6a d7  |(.....4..RJm.~j.|
-00000430  72 8f fb 8a bd 86 f6 02  ab ce ca c2 74 db 20 24  |r...........t. $|
-00000440  37 7e ac fc a5 8d 6b 9c  12 0b af 74 93 b3 44 06  |7~....k....t..D.|
-00000450  37 cc 1a 84 4d 20 ae ef  a3 b2 9e 78 ba 66 cd ce  |7...M .....x.f..|
-00000460  44 3b 41 b5 21 9f 31 b0  5f 9f 84 49 69 ac 0a 4a  |D;A.!.1._..Ii..J|
-00000470  3e 6c 25 30 31 cd                                 |>l%01.|
+00000080  03 03 00 01 01 17 03 03  00 17 ff b6 4a 75 54 2b  |............JuT+|
+00000090  66 2f d9 00 b2 7a 2a e3  b5 2c 28 3b 70 1d a2 cd  |f/...z*..,(;p...|
+000000a0  8b 17 03 03 02 6d 35 8a  4e a1 3c c3 87 04 63 aa  |.....m5.N.<...c.|
+000000b0  94 71 8e 6b 19 de c1 0d  a0 31 e7 99 04 7e 5f 91  |.q.k.....1...~_.|
+000000c0  3e 57 83 9a 39 d1 a4 59  5a d8 a7 7b f4 de 41 64  |>W..9..YZ..{..Ad|
+000000d0  48 f3 20 01 91 b7 c5 af  e7 d2 94 fd d2 a3 cc 22  |H. ............"|
+000000e0  2c 93 ac 06 78 56 c9 a4  e9 bb ec f4 62 99 48 a6  |,...xV......b.H.|
+000000f0  36 81 7b 7a f8 4a d3 42  31 9a df 57 ff 6a c4 03  |6.{z.J.B1..W.j..|
+00000100  84 b8 65 3e af ee 2a 33  32 d9 e2 58 ff ec 4b 40  |..e>..*32..X..K@|
+00000110  e6 76 96 f0 3f 46 a3 75  29 31 d9 f6 66 c8 f4 6a  |.v..?F.u)1..f..j|
+00000120  45 b1 9e 97 2d 83 e6 6a  00 61 e1 af 8b a6 05 b2  |E...-..j.a......|
+00000130  13 f3 e2 74 4c a0 9c a3  68 a8 d7 76 53 3b 66 df  |...tL...h..vS;f.|
+00000140  00 17 a6 f2 08 33 ba 2b  0a 9d d9 d8 b2 50 5e 99  |.....3.+.....P^.|
+00000150  a0 1d 06 bc 4a 84 19 03  d0 54 0a 12 1e 08 49 30  |....J....T....I0|
+00000160  8e a1 80 09 20 49 c7 3d  d7 e8 a7 ed 44 71 b7 9f  |.... I.=....Dq..|
+00000170  6d 2b 52 d3 1d 36 7b 92  ad 23 59 06 aa 9f f0 a5  |m+R..6{..#Y.....|
+00000180  4e 6f 1e c7 22 7a 1f bf  6c da f4 88 c2 83 1f 5d  |No.."z..l......]|
+00000190  f8 2e 93 a1 a7 34 32 7f  56 19 3a 5b 7f 1b 3d 37  |.....42.V.:[..=7|
+000001a0  d2 71 61 bc 1a eb d4 38  4f 2a 55 cc 34 7d 07 42  |.qa....8O*U.4}.B|
+000001b0  08 e0 78 74 ef 94 4a b0  1c 74 fb 17 36 e8 38 e9  |..xt..J..t..6.8.|
+000001c0  10 98 f7 3f 16 20 9e 7e  74 f3 44 0b cd 08 b9 03  |...?. .~t.D.....|
+000001d0  dd 96 12 a4 75 e7 2b 44  18 0f 71 b4 6a 51 c9 a2  |....u.+D..q.jQ..|
+000001e0  5d 84 43 f5 cd 57 31 5c  58 13 75 54 cd 6f de 80  |].C..W1\X.uT.o..|
+000001f0  86 db 07 14 1b d7 df 12  75 ef fd 15 e8 59 eb 13  |........u....Y..|
+00000200  7b d5 e9 30 29 75 48 43  c0 bd 60 44 5e db 97 53  |{..0)uHC..`D^..S|
+00000210  4c c2 60 ab e6 30 9b f2  20 59 fc 8b aa f3 0e 40  |L.`..0.. Y.....@|
+00000220  89 c1 f4 02 dd 7f cb 66  91 32 7a 74 9f ca cb c0  |.......f.2zt....|
+00000230  c9 1d ab cf 9d 31 f4 31  f7 0b 13 7d bf 9c f9 8e  |.....1.1...}....|
+00000240  92 3d 2f a1 cf ff e9 51  ae 4b f9 45 61 bd 71 49  |.=/....Q.K.Ea.qI|
+00000250  46 f9 4e 95 3c 03 35 d7  0b 5c 66 7d a4 0d a7 10  |F.N.<.5..\f}....|
+00000260  a9 98 44 4d 97 fa ac f0  6c 1f 56 fb 8d 23 df 1f  |..DM....l.V..#..|
+00000270  49 e8 7b 77 39 95 b0 b1  13 2b c6 74 f7 b6 01 18  |I.{w9....+.t....|
+00000280  ad 7d 24 8c a9 4e 26 f5  19 9f f3 8a 96 2c 53 2d  |.}$..N&......,S-|
+00000290  79 35 83 2c 05 df 14 4d  48 53 b9 80 1d cf 99 1d  |y5.,...MHS......|
+000002a0  0d 96 60 57 e7 43 d1 59  aa 58 b4 ce a8 e4 96 cb  |..`W.C.Y.X......|
+000002b0  f7 c1 e8 35 c0 00 34 77  12 25 73 6b 21 b6 49 68  |...5..4w.%sk!.Ih|
+000002c0  af c2 0d ea 4d ff 00 05  0c 57 91 e2 1f 54 03 c4  |....M....W...T..|
+000002d0  89 3b b4 2e a4 3e 97 17  54 d6 93 b9 f4 a6 df 98  |.;...>..T.......|
+000002e0  d6 1c ea 4b 4f 14 87 65  19 d2 b7 3c 71 8f 6d 88  |...KO..e...<q.m.|
+000002f0  9d 6e 89 b5 e5 35 4c 49  ba 48 3c 56 a9 e1 04 14  |.n...5LI.H<V....|
+00000300  36 42 73 b0 e3 f9 25 03  05 eb ac 14 55 93 df cd  |6Bs...%.....U...|
+00000310  8f 34 9f 17 03 03 00 99  8f 8d d1 d7 4a 61 09 ea  |.4..........Ja..|
+00000320  6b 39 2c 2c d9 1b a9 2a  d6 74 d7 bd e0 c0 43 d7  |k9,,...*.t....C.|
+00000330  1a 10 b5 ce 10 77 20 7f  50 f8 e8 fd 43 6e e1 35  |.....w .P...Cn.5|
+00000340  9e fd ec 40 24 50 9d 5c  f3 a4 6e 59 99 0b 43 bc  |...@$P.\..nY..C.|
+00000350  0c ae c8 7f ce e8 fb 22  6a b4 a6 e2 ec 3a 6d 74  |......."j....:mt|
+00000360  b9 2d 82 82 e0 17 8f f1  8c 6a fe 11 2b 7a 46 b4  |.-.......j..+zF.|
+00000370  40 5e a6 3e 80 c4 f5 bd  23 20 eb 18 5e 4e a2 98  |@^.>....# ..^N..|
+00000380  39 48 bf d7 53 fb 3a 02  1f fc ca 5d 30 13 ea 9b  |9H..S.:....]0...|
+00000390  ca 40 53 cb 8c c7 d1 02  35 8d e8 41 dc 25 3c b9  |.@S.....5..A.%<.|
+000003a0  c8 4e ed d1 0d 80 0f c8  93 2f 0e 11 ca 93 12 b7  |.N......./......|
+000003b0  9d 17 03 03 00 35 6a 5f  f5 2a fd 88 21 80 a0 84  |.....5j_.*..!...|
+000003c0  27 18 02 15 1f 78 98 a3  d2 9c 59 aa 1c f3 d4 96  |'....x....Y.....|
+000003d0  c3 04 a8 a7 c9 71 75 64  c4 33 9f f5 19 6b b1 69  |.....qud.3...k.i|
+000003e0  1d c5 ac 47 e8 71 28 3b  76 51 4d 17 03 03 00 87  |...G.q(;vQM.....|
+000003f0  89 ee 09 e0 02 61 fa 6a  9c e2 d1 de fe c7 c2 28  |.....a.j.......(|
+00000400  c8 b8 c6 c7 b7 56 91 67  58 c8 5f 0e b3 ad 13 cd  |.....V.gX._.....|
+00000410  a7 55 41 0f a1 98 4e af  59 6a ce 00 b6 fe fc 05  |.UA...N.Yj......|
+00000420  6d 6b 7c 24 ef 90 25 b5  ac de 50 bb 30 2c 63 80  |mk|$..%...P.0,c.|
+00000430  fe 04 7d 73 50 de 34 22  8d 6f 66 dd 94 73 3c 35  |..}sP.4".of..s<5|
+00000440  12 aa fa 72 2d ad 03 6b  f5 49 c4 0f 48 29 ac 8b  |...r-..k.I..H)..|
+00000450  08 fa dc 6c 4c e9 2b e4  f7 ee 02 d1 7a 33 4a c6  |...lL.+.....z3J.|
+00000460  7c 2f 32 69 46 92 34 3e  d1 c5 51 1e 41 6e fc 16  ||/2iF.4>..Q.An..|
+00000470  6f 64 23 6c aa f3 a5                              |od#l...|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 31 24 2a 60 37  |..........51$*`7|
-00000010  a2 c3 fd 2f f7 0f f0 3b  33 20 66 11 e7 fc 80 22  |.../...;3 f...."|
-00000020  de d9 d0 2c c7 bc 11 ad  70 b8 ef a8 c1 08 f5 00  |...,....p.......|
-00000030  f6 15 b1 3a 68 2d 92 46  53 bc ed 51 80 29 2c 23  |...:h-.FS..Q.),#|
+00000000  14 03 03 00 01 01 17 03  03 00 35 1b 6b 60 eb 51  |..........5.k`.Q|
+00000010  e6 06 a6 d3 a5 93 67 39  60 8a 49 bc fa 78 59 9f  |......g9`.I..xY.|
+00000020  4b d8 5d 4c 8c 7e e1 e0  cf b7 b6 82 08 60 bb 87  |K.]L.~.......`..|
+00000030  0c 42 07 02 22 65 fc e7  2c ee 1b 19 32 a6 0a 61  |.B.."e..,...2..a|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e b3 f8 c9  52 e2 df 20 f6 9c a7 3e  |........R.. ...>|
-00000010  5a 40 31 4c 8b ce b1 c1  fe f1 18 03 78 b4 39 8e  |Z@1L........x.9.|
-00000020  59 ee ef 17 03 03 00 13  f6 39 93 2f 98 f3 f5 fc  |Y........9./....|
-00000030  04 1f c0 f7 70 de 08 3a  aa 21 54                 |....p..:.!T|
+00000000  17 03 03 00 1e 27 9b 29  d1 33 5a 0e cf 05 0e 17  |.....'.).3Z.....|
+00000010  98 3c e3 c8 7f f3 01 f4  1a dd f6 fe c1 93 28 77  |.<............(w|
+00000020  12 71 56 17 03 03 00 13  1d a9 36 4e f8 0f 3e bd  |.qV.......6N..>.|
+00000030  e7 2d 4c a1 7b ad 30 73  36 3d e5                 |.-L.{.0s6=.|
diff --git a/src/crypto/tls/ticket.go b/src/crypto/tls/ticket.go
index 24f6206fe1..4aceebf2a1 100644
--- a/src/crypto/tls/ticket.go
+++ b/src/crypto/tls/ticket.go
@@ -34,7 +34,12 @@ type SessionState struct {
 	//       uint64 created_at;
 	//       opaque secret<1..2^8-1>;
 	//       opaque extra<0..2^24-1>;
+	//       uint8 early_data = { 0, 1 };
 	//       CertificateEntry certificate_list<0..2^24-1>;
+	//       select (SessionState.early_data) {
+	//           case 0: Empty;
+	//           case 1: opaque alpn<1..2^8-1>;
+	//       };
 	//       select (SessionState.type) {
 	//           case server: /* empty */;
 	//           case client: struct {
@@ -63,6 +68,11 @@ type SessionState struct {
 	// fixed-length suffix.
 	Extra []byte
 
+	// EarlyData indicates whether the ticket can be used for 0-RTT in a QUIC
+	// connection. The application may set this to false if it is true to
+	// decline to offer 0-RTT even if supported.
+	EarlyData bool
+
 	version     uint16
 	isClient    bool
 	cipherSuite uint16
@@ -75,6 +85,7 @@ type SessionState struct {
 	activeCertHandles []*activeCert
 	ocspResponse      []byte
 	scts              [][]byte
+	alpnProtocol      string // only set if EarlyData is true
 
 	// Client-side fields.
 	verifiedChains [][]*x509.Certificate
@@ -106,7 +117,17 @@ func (s *SessionState) Bytes() ([]byte, error) {
 	b.AddUint24LengthPrefixed(func(b *cryptobyte.Builder) {
 		b.AddBytes(s.Extra)
 	})
+	if s.EarlyData {
+		b.AddUint8(1)
+	} else {
+		b.AddUint8(0)
+	}
 	marshalCertificate(&b, s.certificate())
+	if s.EarlyData {
+		b.AddUint8LengthPrefixed(func(b *cryptobyte.Builder) {
+			b.AddBytes([]byte(s.alpnProtocol))
+		})
+	}
 	if s.isClient {
 		b.AddUint24LengthPrefixed(func(b *cryptobyte.Builder) {
 			for _, chain := range s.verifiedChains {
@@ -152,7 +173,7 @@ func certificatesToBytesSlice(certs []*x509.Certificate) [][]byte {
 func ParseSessionState(data []byte) (*SessionState, error) {
 	ss := &SessionState{}
 	s := cryptobyte.String(data)
-	var typ uint8
+	var typ, earlyData uint8
 	var cert Certificate
 	if !s.ReadUint16(&ss.version) ||
 		!s.ReadUint8(&typ) ||
@@ -161,10 +182,19 @@ func ParseSessionState(data []byte) (*SessionState, error) {
 		!readUint64(&s, &ss.createdAt) ||
 		!readUint8LengthPrefixed(&s, &ss.secret) ||
 		!readUint24LengthPrefixed(&s, &ss.Extra) ||
+		!s.ReadUint8(&earlyData) ||
 		len(ss.secret) == 0 ||
 		!unmarshalCertificate(&s, &cert) {
 		return nil, errors.New("tls: invalid session encoding")
 	}
+	switch earlyData {
+	case 0:
+		ss.EarlyData = false
+	case 1:
+		ss.EarlyData = true
+	default:
+		return nil, errors.New("tls: invalid session encoding")
+	}
 	for _, cert := range cert.Certificate {
 		c, err := globalCertCache.newCert(cert)
 		if err != nil {
@@ -175,6 +205,13 @@ func ParseSessionState(data []byte) (*SessionState, error) {
 	}
 	ss.ocspResponse = cert.OCSPStaple
 	ss.scts = cert.SignedCertificateTimestamps
+	if ss.EarlyData {
+		var alpn []byte
+		if !readUint8LengthPrefixed(&s, &alpn) {
+			return nil, errors.New("tls: invalid session encoding")
+		}
+		ss.alpnProtocol = string(alpn)
+	}
 	if isClient := typ == 2; !isClient {
 		if !s.Empty() {
 			return nil, errors.New("tls: invalid session encoding")
@@ -236,6 +273,7 @@ func (c *Conn) sessionState() (*SessionState, error) {
 		version:           c.vers,
 		cipherSuite:       c.cipherSuite,
 		createdAt:         uint64(c.config.time().Unix()),
+		alpnProtocol:      c.clientProtocol,
 		peerCertificates:  c.peerCertificates,
 		activeCertHandles: c.activeCertHandles,
 		ocspResponse:      c.ocspResponse,
