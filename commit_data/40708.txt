commit 0b3a57b5374bba3fdf88258e2be4c8be65e6a5de
Author: Filippo Valsorda <filippo@golang.org>
Date:   Thu Jun 13 18:33:33 2019 -0400

    crypto/tls: disable RSA-PSS in TLS 1.2 again
    
    Signing with RSA-PSS can uncover faulty crypto.Signer implementations,
    and it can fail for (broken) small keys. We'll have to take that
    breakage eventually, but it would be nice for it to be opt-out at first.
    
    TLS 1.3 requires RSA-PSS and is opt-out in Go 1.13. Instead of making a
    TLS 1.3 opt-out influence a TLS 1.2 behavior, let's wait to add RSA-PSS
    to TLS 1.2 until TLS 1.3 is on without opt-out.
    
    Note that since the Client Hello is sent before a protocol version is
    selected, we have to advertise RSA-PSS there to support TLS 1.3.
    That means that we still support RSA-PSS on the client in TLS 1.2 for
    verifying server certificates, which is fine, as all issues arise on the
    signing side. We have to be careful not to pick (or consider available)
    RSA-PSS on the client for client certificates, though.
    
    We'd expect tests to change only in TLS 1.2:
    
        * the server won't pick PSS to sign the key exchange
          (Server-TLSv12-* w/ RSA, TestHandshakeServerRSAPSS);
        * the server won't advertise PSS in CertificateRequest
          (Server-TLSv12-ClientAuthRequested*, TestClientAuth);
        * and the client won't pick PSS for its CertificateVerify
          (Client-TLSv12-ClientCert-RSA-*, TestHandshakeClientCertRSAPSS,
          Client-TLSv12-Renegotiate* because "R" requests a client cert).
    
    Client-TLSv13-ClientCert-RSA-RSAPSS was updated because of a fix in the test.
    
    This effectively reverts 88343530720a52c96b21f2bd5488c8fb607605d7.
    
    Testing was made more complex by the undocumented semantics of OpenSSL's
    -[client_]sigalgs (see openssl/openssl#9172).
    
    Updates #32425
    
    Change-Id: Iaddeb2df1f5c75cd090cc8321df2ac8e8e7db349
    Reviewed-on: https://go-review.googlesource.com/c/go/+/182339
    Reviewed-by: Adam Langley <agl@golang.org>
---
 src/crypto/tls/auth.go                             |  12 +-
 src/crypto/tls/common.go                           |  15 +
 src/crypto/tls/handshake_client.go                 |   6 +-
 src/crypto/tls/handshake_client_test.go            |  46 +-
 src/crypto/tls/handshake_server.go                 |   7 +-
 src/crypto/tls/handshake_server_test.go            |  62 ++-
 src/crypto/tls/handshake_test.go                   |   1 +
 src/crypto/tls/key_agreement.go                    |   2 +-
 .../Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384 |  74 +--
 .../testdata/Client-TLSv12-ClientCert-RSA-ECDSA    |  92 ++--
 .../tls/testdata/Client-TLSv12-ClientCert-RSA-RSA  |  74 +--
 .../Client-TLSv12-ClientCert-RSA-RSAPKCS1v15       |  74 +--
 .../testdata/Client-TLSv12-ClientCert-RSA-RSAPSS   | 153 +++---
 .../tls/testdata/Client-TLSv12-RenegotiateOnce     | 348 ++++++-------
 .../tls/testdata/Client-TLSv12-RenegotiateTwice    | 538 ++++++++++-----------
 .../Client-TLSv12-RenegotiateTwiceRejected         | 354 +++++++-------
 .../testdata/Client-TLSv13-ClientCert-RSA-RSAPSS   | 237 ++++-----
 src/crypto/tls/testdata/Server-TLSv12-ALPN         |  64 +--
 src/crypto/tls/testdata/Server-TLSv12-ALPN-NoMatch |  64 +--
 .../Server-TLSv12-CipherSuiteCertPreferenceECDSA   |  66 +--
 .../Server-TLSv12-CipherSuiteCertPreferenceRSA     |  60 +--
 .../Server-TLSv12-ClientAuthRequestedAndECDSAGiven |  79 ++-
 ...erver-TLSv12-ClientAuthRequestedAndEd25519Given |  65 ++-
 .../Server-TLSv12-ClientAuthRequestedAndGiven      | 110 ++---
 ...rver-TLSv12-ClientAuthRequestedAndPKCS1v15Given |  86 ++--
 .../Server-TLSv12-ClientAuthRequestedNotGiven      |  61 ++-
 .../testdata/Server-TLSv12-ExportKeyingMaterial    |  64 +--
 src/crypto/tls/testdata/Server-TLSv12-P256         |  54 +--
 src/crypto/tls/testdata/Server-TLSv12-RSA-3DES     |  50 +-
 src/crypto/tls/testdata/Server-TLSv12-RSA-AES      |  54 +--
 src/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM  |  50 +-
 .../testdata/Server-TLSv12-RSA-AES256-GCM-SHA384   |  50 +-
 src/crypto/tls/testdata/Server-TLSv12-RSA-RC4      |  44 +-
 .../tls/testdata/Server-TLSv12-RSA-RSAPKCS1v15     |  50 +-
 src/crypto/tls/testdata/Server-TLSv12-RSA-RSAPSS   |  35 +-
 src/crypto/tls/testdata/Server-TLSv12-SNI          |  54 +--
 .../tls/testdata/Server-TLSv12-SNI-GetCertificate  |  54 +--
 .../Server-TLSv12-SNI-GetCertificateNotFound       |  54 +--
 src/crypto/tls/testdata/Server-TLSv12-X25519       |  50 +-
 39 files changed, 1714 insertions(+), 1699 deletions(-)

diff --git a/src/crypto/tls/auth.go b/src/crypto/tls/auth.go
index 9fa0f452fd..c62c9af76b 100644
--- a/src/crypto/tls/auth.go
+++ b/src/crypto/tls/auth.go
@@ -166,9 +166,11 @@ func signedMessage(sigHash crypto.Hash, context string, transcript hash.Hash) []
 }
 
 // signatureSchemesForCertificate returns the list of supported SignatureSchemes
-// for a given certificate, based on the public key and the protocol version. It
-// does not support the crypto.Decrypter interface, so shouldn't be used on the
-// server side in TLS 1.2 and earlier.
+// for a given certificate, based on the public key and the protocol version.
+//
+// It does not support the crypto.Decrypter interface, so shouldn't be used for
+// server certificates in TLS 1.2 and earlier, and it must be kept in sync with
+// supportedSignatureAlgorithms.
 func signatureSchemesForCertificate(version uint16, cert *Certificate) []SignatureScheme {
 	priv, ok := cert.PrivateKey.(crypto.Signer)
 	if !ok {
@@ -200,16 +202,12 @@ func signatureSchemesForCertificate(version uint16, cert *Certificate) []Signatu
 	case *rsa.PublicKey:
 		if version != VersionTLS13 {
 			return []SignatureScheme{
-				PSSWithSHA256,
-				PSSWithSHA384,
-				PSSWithSHA512,
 				PKCS1WithSHA256,
 				PKCS1WithSHA384,
 				PKCS1WithSHA512,
 				PKCS1WithSHA1,
 			}
 		}
-		// RSA keys with RSA-PSS OID are not supported by crypto/x509.
 		return []SignatureScheme{
 			PSSWithSHA256,
 			PSSWithSHA384,
diff --git a/src/crypto/tls/common.go b/src/crypto/tls/common.go
index 2949994ee6..d135b1fc99 100644
--- a/src/crypto/tls/common.go
+++ b/src/crypto/tls/common.go
@@ -185,6 +185,21 @@ var supportedSignatureAlgorithms = []SignatureScheme{
 	ECDSAWithSHA1,
 }
 
+// supportedSignatureAlgorithmsTLS12 contains the signature and hash algorithms
+// that are supported in TLS 1.2, where it is possible to distinguish the
+// protocol version. This is temporary, see Issue 32425.
+var supportedSignatureAlgorithmsTLS12 = []SignatureScheme{
+	PKCS1WithSHA256,
+	ECDSAWithP256AndSHA256,
+	Ed25519,
+	PKCS1WithSHA384,
+	PKCS1WithSHA512,
+	ECDSAWithP384AndSHA384,
+	ECDSAWithP521AndSHA512,
+	PKCS1WithSHA1,
+	ECDSAWithSHA1,
+}
+
 // helloRetryRequestRandom is set as the Random value of a ServerHello
 // to signal that the message is actually a HelloRetryRequest.
 var helloRetryRequestRandom = []byte{ // See RFC 8446, Section 4.1.3.
diff --git a/src/crypto/tls/handshake_client.go b/src/crypto/tls/handshake_client.go
index 19a7e92d87..ed000eb619 100644
--- a/src/crypto/tls/handshake_client.go
+++ b/src/crypto/tls/handshake_client.go
@@ -573,7 +573,7 @@ func (hs *clientHandshakeState) doFullHandshake() error {
 			return fmt.Errorf("tls: client certificate private key of type %T does not implement crypto.Signer", chainToSend.PrivateKey)
 		}
 
-		signatureAlgorithm, sigType, hashFunc, err := pickSignatureAlgorithm(key.Public(), certReq.supportedSignatureAlgorithms, hs.hello.supportedSignatureAlgorithms, c.vers)
+		signatureAlgorithm, sigType, hashFunc, err := pickSignatureAlgorithm(key.Public(), certReq.supportedSignatureAlgorithms, supportedSignatureAlgorithmsTLS12, c.vers)
 		if err != nil {
 			c.sendAlert(alertInternalError)
 			return err
@@ -899,10 +899,8 @@ func certificateRequestInfoFromMsg(certReq *certificateRequestMsg) *CertificateR
 		return cri
 	}
 
-	// In TLS 1.2, the signature schemes apply to both the certificate chain and
-	// the leaf key, while the certificate types only apply to the leaf key.
+	// Filter the signature schemes based on the certificate types.
 	// See RFC 5246, Section 7.4.4 (where it calls this "somewhat complicated").
-	// Filter the signature schemes based on the certificate type.
 	cri.SignatureSchemes = make([]SignatureScheme, 0, len(certReq.supportedSignatureAlgorithms))
 	for _, sigScheme := range certReq.supportedSignatureAlgorithms {
 		switch signatureFromSignatureScheme(sigScheme) {
diff --git a/src/crypto/tls/handshake_client_test.go b/src/crypto/tls/handshake_client_test.go
index a27f107ba7..da17fdfa4f 100644
--- a/src/crypto/tls/handshake_client_test.go
+++ b/src/crypto/tls/handshake_client_test.go
@@ -450,12 +450,20 @@ func (test *clientTest) run(t *testing.T, write bool) {
 		}
 		for i, b := range flows {
 			if i%2 == 1 {
-				serverConn.SetWriteDeadline(time.Now().Add(1 * time.Minute))
+				if *fast {
+					serverConn.SetWriteDeadline(time.Now().Add(1 * time.Second))
+				} else {
+					serverConn.SetWriteDeadline(time.Now().Add(1 * time.Minute))
+				}
 				serverConn.Write(b)
 				continue
 			}
 			bb := make([]byte, len(b))
-			serverConn.SetReadDeadline(time.Now().Add(1 * time.Minute))
+			if *fast {
+				serverConn.SetReadDeadline(time.Now().Add(1 * time.Second))
+			} else {
+				serverConn.SetReadDeadline(time.Now().Add(1 * time.Minute))
+			}
 			_, err := io.ReadFull(serverConn, bb)
 			if err != nil {
 				t.Fatalf("%s, flow %d: %s", test.name, i+1, err)
@@ -819,22 +827,26 @@ func TestHandshakeClientCertECDSA(t *testing.T) {
 	runClientTestTLS12(t, test)
 }
 
-// TestHandshakeClientCertRSAPSS tests a few separate things:
-//  * that our client can serve a PSS-signed certificate
-//  * that our client can validate a PSS-signed certificate
-//  * that our client can use rsa_pss_rsae_sha256 in its CertificateVerify
-//  * that our client can accpet rsa_pss_rsae_sha256 in the server CertificateVerify
+// TestHandshakeClientCertRSAPSS tests rsa_pss_rsae_sha256 signatures from both
+// client and server certificates. It also serves from both sides a certificate
+// signed itself with RSA-PSS, mostly to check that crypto/x509 chain validation
+// works.
 func TestHandshakeClientCertRSAPSS(t *testing.T) {
-	issuer, err := x509.ParseCertificate(testRSAPSSCertificate)
+	cert, err := x509.ParseCertificate(testRSAPSSCertificate)
 	if err != nil {
 		panic(err)
 	}
 	rootCAs := x509.NewCertPool()
-	rootCAs.AddCert(issuer)
+	rootCAs.AddCert(cert)
 
 	config := testConfig.Clone()
-	cert, _ := X509KeyPair([]byte(clientCertificatePEM), []byte(clientKeyPEM))
-	config.Certificates = []Certificate{cert}
+	// Use GetClientCertificate to bypass the client certificate selection logic.
+	config.GetClientCertificate = func(*CertificateRequestInfo) (*Certificate, error) {
+		return &Certificate{
+			Certificate: [][]byte{testRSAPSSCertificate},
+			PrivateKey:  testRSAPrivateKey,
+		}, nil
+	}
 	config.RootCAs = rootCAs
 
 	test := &clientTest{
@@ -845,9 +857,19 @@ func TestHandshakeClientCertRSAPSS(t *testing.T) {
 		cert:   testRSAPSSCertificate,
 		key:    testRSAPrivateKey,
 	}
+	runClientTestTLS13(t, test)
 
+	// In our TLS 1.2 client, RSA-PSS is only supported for server certificates.
+	// See Issue 32425.
+	test = &clientTest{
+		name: "ClientCert-RSA-RSAPSS",
+		args: []string{"-cipher", "AES128", "-Verify", "1", "-client_sigalgs",
+			"rsa_pkcs1_sha256", "-sigalgs", "rsa_pss_rsae_sha256"},
+		config: config,
+		cert:   testRSAPSSCertificate,
+		key:    testRSAPrivateKey,
+	}
 	runClientTestTLS12(t, test)
-	runClientTestTLS13(t, test)
 }
 
 func TestHandshakeClientCertRSAPKCS1v15(t *testing.T) {
diff --git a/src/crypto/tls/handshake_server.go b/src/crypto/tls/handshake_server.go
index 29fbeee894..a3d8848caf 100644
--- a/src/crypto/tls/handshake_server.go
+++ b/src/crypto/tls/handshake_server.go
@@ -457,16 +457,17 @@ func (hs *serverHandshakeState) doFullHandshake() error {
 		}
 	}
 
+	var certReq *certificateRequestMsg
 	if c.config.ClientAuth >= RequestClientCert {
 		// Request a client certificate
-		certReq := new(certificateRequestMsg)
+		certReq = new(certificateRequestMsg)
 		certReq.certificateTypes = []byte{
 			byte(certTypeRSASign),
 			byte(certTypeECDSASign),
 		}
 		if c.vers >= VersionTLS12 {
 			certReq.hasSignatureAlgorithm = true
-			certReq.supportedSignatureAlgorithms = supportedSignatureAlgorithms
+			certReq.supportedSignatureAlgorithms = supportedSignatureAlgorithmsTLS12
 		}
 
 		// An empty list of certificateAuthorities signals to
@@ -562,7 +563,7 @@ func (hs *serverHandshakeState) doFullHandshake() error {
 		}
 
 		// Determine the signature type.
-		_, sigType, hashFunc, err := pickSignatureAlgorithm(pub, []SignatureScheme{certVerify.signatureAlgorithm}, supportedSignatureAlgorithms, c.vers)
+		_, sigType, hashFunc, err := pickSignatureAlgorithm(pub, []SignatureScheme{certVerify.signatureAlgorithm}, certReq.supportedSignatureAlgorithms, c.vers)
 		if err != nil {
 			c.sendAlert(alertIllegalParameter)
 			return err
diff --git a/src/crypto/tls/handshake_server_test.go b/src/crypto/tls/handshake_server_test.go
index 843a0a70f0..6884dff154 100644
--- a/src/crypto/tls/handshake_server_test.go
+++ b/src/crypto/tls/handshake_server_test.go
@@ -685,12 +685,20 @@ func (test *serverTest) run(t *testing.T, write bool) {
 		}
 		for i, b := range flows {
 			if i%2 == 0 {
-				clientConn.SetWriteDeadline(time.Now().Add(1 * time.Minute))
+				if *fast {
+					clientConn.SetWriteDeadline(time.Now().Add(1 * time.Second))
+				} else {
+					clientConn.SetWriteDeadline(time.Now().Add(1 * time.Minute))
+				}
 				clientConn.Write(b)
 				continue
 			}
 			bb := make([]byte, len(b))
-			clientConn.SetReadDeadline(time.Now().Add(1 * time.Minute))
+			if *fast {
+				clientConn.SetReadDeadline(time.Now().Add(1 * time.Second))
+			} else {
+				clientConn.SetReadDeadline(time.Now().Add(1 * time.Minute))
+			}
 			n, err := io.ReadFull(clientConn, bb)
 			if err != nil {
 				t.Fatalf("%s #%d: %s\nRead %d, wanted %d, got %x, wanted %x\n", test.name, i+1, err, n, len(bb), bb[:n], b)
@@ -1205,10 +1213,16 @@ func TestHandshakeServerRSAPKCS1v15(t *testing.T) {
 
 func TestHandshakeServerRSAPSS(t *testing.T) {
 	test := &serverTest{
+		name:                          "RSA-RSAPSS",
+		command:                       []string{"openssl", "s_client", "-no_ticket", "-sigalgs", "rsa_pss_rsae_sha256"},
+		expectHandshakeErrorIncluding: "peer doesn't support any common signature algorithms", // See Issue 32425.
+	}
+	runServerTestTLS12(t, test)
+
+	test = &serverTest{
 		name:    "RSA-RSAPSS",
 		command: []string{"openssl", "s_client", "-no_ticket", "-sigalgs", "rsa_pss_rsae_sha256"},
 	}
-	runServerTestTLS12(t, test)
 	runServerTestTLS13(t, test)
 }
 
@@ -1445,11 +1459,18 @@ func TestClientAuth(t *testing.T) {
 	test = &serverTest{
 		name: "ClientAuthRequestedAndGiven",
 		command: []string{"openssl", "s_client", "-no_ticket", "-cipher", "AES128-SHA",
-			"-cert", certPath, "-key", keyPath, "-sigalgs", "rsa_pss_rsae_sha256"},
+			"-cert", certPath, "-key", keyPath, "-client_sigalgs", "rsa_pss_rsae_sha256"},
 		config:            config,
-		expectedPeerCerts: []string{clientCertificatePEM},
+		expectedPeerCerts: []string{}, // See Issue 32425.
 	}
 	runServerTestTLS12(t, test)
+	test = &serverTest{
+		name: "ClientAuthRequestedAndGiven",
+		command: []string{"openssl", "s_client", "-no_ticket", "-cipher", "AES128-SHA",
+			"-cert", certPath, "-key", keyPath, "-client_sigalgs", "rsa_pss_rsae_sha256"},
+		config:            config,
+		expectedPeerCerts: []string{clientCertificatePEM},
+	}
 	runServerTestTLS13(t, test)
 
 	test = &serverTest{
@@ -1475,7 +1496,7 @@ func TestClientAuth(t *testing.T) {
 	test = &serverTest{
 		name: "ClientAuthRequestedAndPKCS1v15Given",
 		command: []string{"openssl", "s_client", "-no_ticket", "-cipher", "AES128-SHA",
-			"-cert", certPath, "-key", keyPath, "-sigalgs", "rsa_pkcs1_sha256"},
+			"-cert", certPath, "-key", keyPath, "-client_sigalgs", "rsa_pkcs1_sha256"},
 		config:            config,
 		expectedPeerCerts: []string{clientCertificatePEM},
 	}
@@ -1682,7 +1703,7 @@ var testRSACertificate = fromHex("3082024b308201b4a003020102020900e8f09d3fe25bea
 
 var testRSACertificateIssuer = fromHex("3082021930820182a003020102020900ca5e4e811a965964300d06092a864886f70d01010b0500301f310b3009060355040a1302476f3110300e06035504031307476f20526f6f74301e170d3136303130313030303030305a170d3235303130313030303030305a301f310b3009060355040a1302476f3110300e06035504031307476f20526f6f7430819f300d06092a864886f70d010101050003818d0030818902818100d667b378bb22f34143b6cd2008236abefaf2852adf3ab05e01329e2c14834f5105df3f3073f99dab5442d45ee5f8f57b0111c8cb682fbb719a86944eebfffef3406206d898b8c1b1887797c9c5006547bb8f00e694b7a063f10839f269f2c34fff7a1f4b21fbcd6bfdfb13ac792d1d11f277b5c5b48600992203059f2a8f8cc50203010001a35d305b300e0603551d0f0101ff040403020204301d0603551d250416301406082b0601050507030106082b06010505070302300f0603551d130101ff040530030101ff30190603551d0e041204104813494d137e1631bba301d5acab6e7b300d06092a864886f70d01010b050003818100c1154b4bab5266221f293766ae4138899bd4c5e36b13cee670ceeaa4cbdf4f6679017e2fe649765af545749fe4249418a56bd38a04b81e261f5ce86b8d5c65413156a50d12449554748c59a30c515bc36a59d38bddf51173e899820b282e40aa78c806526fd184fb6b4cf186ec728edffa585440d2b3225325f7ab580e87dd76")
 
-// testRSAPSSCertificate has signatureAlgorithm rsassaPss, and subjectPublicKeyInfo
+// testRSAPSSCertificate has signatureAlgorithm rsassaPss, but subjectPublicKeyInfo
 // algorithm rsaEncryption, for use with the rsa_pss_rsae_* SignatureSchemes.
 // See also TestRSAPSSKeyError. testRSAPSSCertificate is self-signed.
 var testRSAPSSCertificate = fromHex("308202583082018da003020102021100f29926eb87ea8a0db9fcc247347c11b0304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a20302012030123110300e060355040a130741636d6520436f301e170d3137313132333136313631305a170d3138313132333136313631305a30123110300e060355040a130741636d6520436f30819f300d06092a864886f70d010101050003818d0030818902818100db467d932e12270648bc062821ab7ec4b6a25dfe1e5245887a3647a5080d92425bc281c0be97799840fb4f6d14fd2b138bc2a52e67d8d4099ed62238b74a0b74732bc234f1d193e596d9747bf3589f6c613cc0b041d4d92b2b2423775b1c3bbd755dce2054cfa163871d1e24c4f31d1a508baab61443ed97a77562f414c852d70203010001a3463044300e0603551d0f0101ff0404030205a030130603551d25040c300a06082b06010505070301300c0603551d130101ff04023000300f0603551d110408300687047f000001304106092a864886f70d01010a3034a00f300d06096086480165030402010500a11c301a06092a864886f70d010108300d06096086480165030402010500a20302012003818100cdac4ef2ce5f8d79881042707f7cbf1b5a8a00ef19154b40151771006cd41626e5496d56da0c1a139fd84695593cb67f87765e18aa03ea067522dd78d2a589b8c92364e12838ce346c6e067b51f1a7e6f4b37ffab13f1411896679d18e880e0ba09e302ac067efca460288e9538122692297ad8093d4f7dd701424d7700a46a1")
@@ -1749,9 +1770,15 @@ func TestCloneHash(t *testing.T) {
 	}
 }
 
+func expectError(t *testing.T, err error, sub string) {
+	if err == nil {
+		t.Errorf(`expected error %q, got nil`, sub)
+	} else if !strings.Contains(err.Error(), sub) {
+		t.Errorf(`expected error %q, got %q`, sub, err)
+	}
+}
+
 func TestKeyTooSmallForRSAPSS(t *testing.T) {
-	clientConn, serverConn := localPipe(t)
-	client := Client(clientConn, testConfig)
 	cert, err := X509KeyPair([]byte(`-----BEGIN CERTIFICATE-----
 MIIBcTCCARugAwIBAgIQGjQnkCFlUqaFlt6ixyz/tDANBgkqhkiG9w0BAQsFADAS
 MRAwDgYDVQQKEwdBY21lIENvMB4XDTE5MDExODIzMjMyOFoXDTIwMDExODIzMjMy
@@ -1773,6 +1800,9 @@ T+E0J8wlH24pgwQHzy7Ko2qLwn1b5PW8ecrlvP1g
 	if err != nil {
 		t.Fatal(err)
 	}
+
+	clientConn, serverConn := localPipe(t)
+	client := Client(clientConn, testConfig)
 	done := make(chan struct{})
 	go func() {
 		config := testConfig.Clone()
@@ -1780,14 +1810,16 @@ T+E0J8wlH24pgwQHzy7Ko2qLwn1b5PW8ecrlvP1g
 		config.MinVersion = VersionTLS13
 		server := Server(serverConn, config)
 		err := server.Handshake()
-		if !strings.Contains(err.Error(), "key size too small for PSS signature") {
-			t.Errorf(`expected "key size too small for PSS signature", got %q`, err)
-		}
+		expectError(t, err, "key size too small for PSS signature")
 		close(done)
 	}()
 	err = client.Handshake()
-	if !strings.Contains(err.Error(), "handshake failure") {
-		t.Errorf(`expected "handshake failure", got %q`, err)
-	}
+	expectError(t, err, "handshake failure")
 	<-done
+
+	// In TLS 1.2 RSA-PSS is not used, so this should succeed. See Issue 32425.
+	serverConfig := testConfig.Clone()
+	serverConfig.Certificates = []Certificate{cert}
+	serverConfig.MaxVersion = VersionTLS12
+	testHandshake(t, testConfig, serverConfig)
 }
diff --git a/src/crypto/tls/handshake_test.go b/src/crypto/tls/handshake_test.go
index aa072cef05..718e30a5d8 100644
--- a/src/crypto/tls/handshake_test.go
+++ b/src/crypto/tls/handshake_test.go
@@ -40,6 +40,7 @@ import (
 
 var (
 	update = flag.Bool("update", false, "update golden files on disk")
+	fast   = flag.Bool("fast", false, "impose a quick, possibly flaky timeout on recorded tests")
 
 	opensslVersionTestOnce sync.Once
 	opensslVersionTestErr  error
diff --git a/src/crypto/tls/key_agreement.go b/src/crypto/tls/key_agreement.go
index 7428f3bccc..2922017cc4 100644
--- a/src/crypto/tls/key_agreement.go
+++ b/src/crypto/tls/key_agreement.go
@@ -185,7 +185,7 @@ NextCandidate:
 		return nil, errors.New("tls: certificate private key does not implement crypto.Signer")
 	}
 
-	signatureAlgorithm, sigType, hashFunc, err := pickSignatureAlgorithm(priv.Public(), clientHello.supportedSignatureAlgorithms, supportedSignatureAlgorithms, ka.version)
+	signatureAlgorithm, sigType, hashFunc, err := pickSignatureAlgorithm(priv.Public(), clientHello.supportedSignatureAlgorithms, supportedSignatureAlgorithmsTLS12, ka.version)
 	if err != nil {
 		return nil, err
 	}
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384 b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384
index 9408527297..22115d5565 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384
@@ -16,11 +16,11 @@
 000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 44 13 0c ac b2  |....Y...U..D....|
-00000010  4f 77 03 bb 69 b5 db 3f  f5 c3 14 20 6f 8b c7 e1  |Ow..i..?... o...|
-00000020  28 40 01 a0 04 f7 29 76  42 65 b0 20 91 89 84 74  |(@....)vBe. ...t|
-00000030  8e ed c8 c3 48 67 a5 75  93 ec d3 3e 26 e4 aa c6  |....Hg.u...>&...|
-00000040  39 e7 9f 78 d3 ab 3c c0  6a 05 32 7e c0 30 00 00  |9..x..<.j.2~.0..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 41 6b 69 65 47  |....Y...U..AkieG|
+00000010  8c 15 2f d5 6d 1a 3d 0c  ff 56 ad 42 31 6c 1f 86  |../.m.=..V.B1l..|
+00000020  06 62 e3 e4 18 9c 5c 47  9e 8c 66 20 af ba 7c 62  |.b....\G..f ..|b|
+00000030  c2 32 f4 49 f1 8d f4 ba  7a 51 23 32 46 96 7e b8  |.2.I....zQ#2F.~.|
+00000040  f0 2c ae 0a d4 04 49 16  4a 64 79 c8 c0 30 00 00  |.,....I.Jdy..0..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -60,17 +60,17 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 f7 1b 54 ea 8f 34 2c  |........ ..T..4,|
-000002d0  09 c5 a1 63 17 9c be f5  3d 6d 58 97 63 13 db 67  |...c....=mX.c..g|
-000002e0  fb 96 ef 45 c2 8c 30 12  02 08 04 00 80 d7 1a 46  |...E..0........F|
-000002f0  a1 90 80 71 eb 2d 27 60  a1 aa 7c 06 79 0a e7 78  |...q.-'`..|.y..x|
-00000300  47 18 95 de 90 a0 cf b4  ff 0e 35 24 43 05 18 9a  |G.........5$C...|
-00000310  e4 1d 23 af cb cd e1 09  81 3b a8 18 7e 30 50 3d  |..#......;..~0P=|
-00000320  dd be 91 3c ec 79 3c 83  aa 78 6a d0 75 70 cf 53  |...<.y<..xj.up.S|
-00000330  07 b7 8a f1 8c 4d 03 27  d5 0e 40 57 5d c3 0f 4e  |.....M.'..@W]..N|
-00000340  63 44 84 11 47 8e 5d fd  66 75 4d ce 1d 91 6f bb  |cD..G.].fuM...o.|
-00000350  f5 ae 3b b2 88 5f bb d0  55 73 74 c4 8e a8 70 44  |..;.._..Ust...pD|
-00000360  0f 08 10 7a f0 34 fc c8  4d 65 3d ed a1 16 03 03  |...z.4..Me=.....|
+000002c0  ac 0c 00 00 a8 03 00 1d  20 9e 80 b0 95 af 3b 4c  |........ .....;L|
+000002d0  e7 fb 97 65 d0 36 8f 97  88 0d 3b 5d a0 21 a8 78  |...e.6....;].!.x|
+000002e0  81 39 4c 80 5c 58 52 6e  68 08 04 00 80 41 c6 e7  |.9L.\XRnh....A..|
+000002f0  c9 48 c1 be 17 a6 a3 3c  3a de c8 c8 86 6e 70 37  |.H.....<:....np7|
+00000300  2f d3 ed 8a dd 3a 73 5c  b5 23 49 a8 4a fe e9 2b  |/....:s\.#I.J..+|
+00000310  4e 99 43 b8 e8 05 f9 fe  90 bf 74 be 92 3d d8 a3  |N.C.......t..=..|
+00000320  c2 b2 38 80 1c 82 1f 35  e1 2e 04 bf a6 0a ec 3f  |..8....5.......?|
+00000330  81 4c a2 2b 19 8f 91 4c  51 b5 0d 52 1e 69 84 0a  |.L.+...LQ..R.i..|
+00000340  b0 cb de 41 1a bd a6 3d  50 9a ca d2 c0 26 11 3f  |...A...=P....&.?|
+00000350  cd 80 b4 2d 6e 03 f2 c5  2b cd 9c b6 a4 d8 e6 cf  |...-n...+.......|
+00000360  ec 1d 7a a9 17 59 6c 89  17 2f 64 0a 7c 16 03 03  |..z..Yl../d.|...|
 00000370  00 3a 0d 00 00 36 03 01  02 40 00 2e 04 03 05 03  |.:...6...@......|
 00000380  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000390  08 06 04 01 05 01 06 01  03 03 02 03 03 01 02 01  |................|
@@ -112,26 +112,26 @@
 00000200  e5 35 16 03 03 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
 00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 03 00  |......._X.;t....|
-00000230  88 0f 00 00 84 08 04 00  80 6d 3c 47 cb 26 af e0  |.........m<G.&..|
-00000240  1a f1 41 2b 90 cd 19 44  16 37 61 0f 5b 89 2e 81  |..A+...D.7a.[...|
-00000250  52 b1 29 bd 3d f7 96 cc  aa bb 4c 0f 74 11 11 47  |R.).=.....L.t..G|
-00000260  09 c4 da 48 7a 3b e2 be  ee 08 f6 9e a0 62 c9 11  |...Hz;.......b..|
-00000270  d7 6c 06 0b eb 0b ea f0  69 ce 22 31 33 f2 b5 73  |.l......i."13..s|
-00000280  b9 a0 a7 8a d1 67 35 1d  52 5c 6d 00 9d d7 8e ba  |.....g5.R\m.....|
-00000290  a4 47 68 8b 87 27 47 47  06 09 16 d4 e1 cc ea 6f  |.Gh..'GG.......o|
-000002a0  7a ea 85 7d e0 bf b4 7d  7f 7c 3f 4c db 0a ce 61  |z..}...}.|?L...a|
-000002b0  31 ed cc 2e 03 08 80 9e  2d 14 03 03 00 01 01 16  |1.......-.......|
-000002c0  03 03 00 28 00 00 00 00  00 00 00 00 f9 c7 99 ab  |...(............|
-000002d0  ab fc da ce 64 ae f1 6e  a6 77 37 45 47 6f e7 b1  |....d..n.w7EGo..|
-000002e0  43 e1 85 5a 19 48 6a 1c  08 9f f6 8b              |C..Z.Hj.....|
+00000230  88 0f 00 00 84 04 01 00  80 29 22 23 51 c5 71 4a  |.........)"#Q.qJ|
+00000240  32 eb 72 6b f2 c8 46 99  df fe d5 a7 0c 55 3c 40  |2.rk..F......U<@|
+00000250  e1 1e 09 4c 40 83 8a 0d  67 27 63 21 d2 36 66 8f  |...L@...g'c!.6f.|
+00000260  cb 97 4b 87 8a ed 9a 44  81 97 34 4b 9b 12 27 f5  |..K....D..4K..'.|
+00000270  d8 63 9b 1f cf d7 b4 2b  54 99 86 2d cd 36 9f 3e  |.c.....+T..-.6.>|
+00000280  92 af 5a a6 0c 8a e0 e3  d3 b9 9b 47 ea 67 61 69  |..Z........G.gai|
+00000290  d8 c1 86 1d fd 43 d4 1f  5c f5 48 d8 4a 97 a7 0f  |.....C..\.H.J...|
+000002a0  57 59 b0 5f e8 24 3f 9e  1d 96 3d 4b be 9c fa e3  |WY._.$?...=K....|
+000002b0  3b 34 7e aa 67 d7 cc ea  78 14 03 03 00 01 01 16  |;4~.g...x.......|
+000002c0  03 03 00 28 00 00 00 00  00 00 00 00 33 b3 7b c9  |...(........3.{.|
+000002d0  3f e8 7d 08 3d 65 a3 22  fa e3 04 79 d9 9f 54 a3  |?.}.=e."...y..T.|
+000002e0  45 e7 64 b2 5d 95 cf dd  88 cc ba 0b              |E.d.].......|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 cf 58 0e 80 3b  |..........(.X..;|
-00000010  f9 c1 03 02 1f e3 c9 d0  24 5d 0d 7b 6d 45 f7 1a  |........$].{mE..|
-00000020  22 a7 94 82 a5 c1 f3 cd  df 0f e0 66 0e 6f 62 7b  |"..........f.ob{|
-00000030  d6 fb 07                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 28 7e 38 ab 82 0c  |..........(~8...|
+00000010  fd fa b9 83 3e 77 ed 22  b5 9d d3 c1 ca cd 18 c5  |....>w."........|
+00000020  1c 01 a0 b8 8b 96 20 92  7b bd 0a 33 ee fe be 75  |...... .{..3...u|
+00000030  95 6e 0c                                          |.n.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 66 26 3d  |.............f&=|
-00000010  31 f1 eb ae 19 79 c5 97  5d 70 b6 2f fc b9 7e c8  |1....y..]p./..~.|
-00000020  2f c7 70 15 03 03 00 1a  00 00 00 00 00 00 00 02  |/.p.............|
-00000030  30 7b dd 4c f2 3d aa 01  c5 55 07 ed 7a bb ff b6  |0{.L.=...U..z...|
-00000040  91 25                                             |.%|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 9d f0 cd  |................|
+00000010  53 8d 1a 45 ae 4a e4 01  97 dd ac f1 00 d3 aa b6  |S..E.J..........|
+00000020  bf c9 bc 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
+00000030  aa 1b 41 d5 f5 68 41 b8  32 94 9b 23 f8 60 7b 60  |..A..hA.2..#.`{`|
+00000040  2c 8a                                             |,.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA
index c9d74439f0..db82b3837e 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA
@@ -16,11 +16,11 @@
 000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 61 3f 7c 9a 87  |....Y...U..a?|..|
-00000010  de 3b 63 d2 7e 08 97 8a  84 d1 78 f0 25 0e d6 cd  |.;c.~.....x.%...|
-00000020  a0 e0 0c 90 e2 63 70 54  5b 3b 11 20 ef dc d6 32  |.....cpT[;. ...2|
-00000030  f4 4f 37 07 e9 75 89 a1  2f 8b ca 8a dd 5c 3d 6c  |.O7..u../....\=l|
-00000040  9c 8b 89 07 38 ac d2 7e  ab 98 b9 e5 c0 09 00 00  |....8..~........|
+00000000  16 03 03 00 59 02 00 00  55 03 03 59 e6 a5 3d 5a  |....Y...U..Y..=Z|
+00000010  bf 25 a3 16 e7 e3 da cb  ac b7 11 09 0a 1a 8a c5  |.%..............|
+00000020  33 a2 a6 58 12 27 cd 52  15 28 c9 20 23 9a f5 d3  |3..X.'.R.(. #...|
+00000030  d4 df 49 1d 01 87 12 36  03 c6 36 17 39 d0 db 62  |..I....6..6.9..b|
+00000040  22 48 7e 57 20 ab a3 7c  b0 53 7e f1 c0 09 00 00  |"H~W ..|.S~.....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -55,23 +55,23 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 b7 0c 00  00 b3 03 00 1d 20 9e 1c  |*............ ..|
-00000280  a9 0f 8a 83 fb 33 a7 a4  0e 75 9a 96 ba 14 59 26  |.....3...u....Y&|
-00000290  48 ad 94 ad 79 d0 81 f1  b6 39 eb c8 6b 45 04 03  |H...y....9..kE..|
-000002a0  00 8b 30 81 88 02 42 01  49 b1 7a 06 09 c7 41 16  |..0...B.I.z...A.|
-000002b0  65 2f 0b 89 47 2e 53 10  0a 9e 18 c4 c6 39 f8 74  |e/..G.S......9.t|
-000002c0  79 49 e8 45 76 88 78 d7  2b 93 61 4a 78 93 e4 32  |yI.Ev.x.+.aJx..2|
-000002d0  74 57 5f 77 d6 65 de b6  13 50 d5 06 43 40 c3 98  |tW_w.e...P..C@..|
-000002e0  87 7a 8b 90 54 3d 62 fa  7e 02 42 00 aa 6c 3b 6b  |.z..T=b.~.B..l;k|
-000002f0  3f 15 1d 23 ef 50 bf 09  18 65 4b b0 5f 67 ba d9  |?..#.P...eK._g..|
-00000300  c7 dd 1d 26 30 9c 5b 14  50 61 93 da e0 8f 77 82  |...&0.[.Pa....w.|
-00000310  43 6b d0 81 75 96 ac 0e  24 96 54 bf e2 22 a9 4e  |Ck..u...$.T..".N|
-00000320  90 07 de 61 86 f0 a4 09  59 5e d3 e5 3d 16 03 03  |...a....Y^..=...|
-00000330  00 3a 0d 00 00 36 03 01  02 40 00 2e 04 03 05 03  |.:...6...@......|
-00000340  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
-00000350  08 06 04 01 05 01 06 01  03 03 02 03 03 01 02 01  |................|
-00000360  03 02 02 02 04 02 05 02  06 02 00 00 16 03 03 00  |................|
-00000370  04 0e 00 00 00                                    |.....|
+00000270  2a 16 03 03 00 b6 0c 00  00 b2 03 00 1d 20 a7 6b  |*............ .k|
+00000280  75 97 e7 04 a7 19 99 af  c7 73 72 82 59 7d 16 46  |u........sr.Y}.F|
+00000290  de 80 c2 d3 36 c7 e8 42  89 ca 8d db 11 39 04 03  |....6..B.....9..|
+000002a0  00 8a 30 81 87 02 41 73  4f fe e2 00 9d bf 60 0a  |..0...AsO.....`.|
+000002b0  36 0b 97 8a fc 3e 8c 1d  ac ff a2 0b 7a dc 8d 2f  |6....>......z../|
+000002c0  d7 90 da 18 a0 14 8a 7c  51 4c a6 ae ec 13 ee 5e  |.......|QL.....^|
+000002d0  1a 60 aa 2f 5a d2 05 48  fb bb bb 3a 1a dc fa 21  |.`./Z..H...:...!|
+000002e0  df 7b 6d 83 23 d6 62 0f  02 42 01 7f 5a 36 6d f4  |.{m.#.b..B..Z6m.|
+000002f0  0d f5 d0 6f d9 71 52 f8  eb e3 ed 7c 40 fd 64 14  |...o.qR....|@.d.|
+00000300  c1 31 4d 4b 78 70 5d 9f  61 18 3b 87 01 10 94 e5  |.1MKxp].a.;.....|
+00000310  7b 83 34 2d cd 90 50 db  10 62 8d 36 40 45 20 c0  |{.4-..P..b.6@E .|
+00000320  db ce de 5e b3 63 de 60  db bb fe be 16 03 03 00  |...^.c.`........|
+00000330  3a 0d 00 00 36 03 01 02  40 00 2e 04 03 05 03 06  |:...6...@.......|
+00000340  03 08 07 08 08 08 09 08  0a 08 0b 08 04 08 05 08  |................|
+00000350  06 04 01 05 01 06 01 03  03 02 03 03 01 02 01 03  |................|
+00000360  02 02 02 04 02 05 02 06  02 00 00 16 03 03 00 04  |................|
+00000370  0e 00 00 00                                       |....|
 >>> Flow 3 (client to server)
 00000000  16 03 03 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
 00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
@@ -108,31 +108,31 @@
 00000200  e5 35 16 03 03 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
 00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 03 00  |......._X.;t....|
-00000230  88 0f 00 00 84 08 04 00  80 1f 32 e0 7a 18 d4 63  |..........2.z..c|
-00000240  9b a3 30 16 57 2d 0e 13  78 b6 a9 07 90 04 34 7d  |..0.W-..x.....4}|
-00000250  2d e8 db b6 bb 95 07 80  6c 4b 59 d7 47 34 b2 d5  |-.......lKY.G4..|
-00000260  3a 91 87 80 a4 7d bb 9f  f2 dc dc 9e 7c cb cc 53  |:....}......|..S|
-00000270  b2 46 60 3e 27 ab 46 94  03 d2 a8 f6 b3 66 81 b8  |.F`>'.F......f..|
-00000280  13 2d e2 78 c7 1c ad 51  05 77 79 c1 87 b4 0d 1d  |.-.x...Q.wy.....|
-00000290  95 8d 3f 4d a2 61 94 f8  bf 30 84 b4 42 6e 42 b0  |..?M.a...0..BnB.|
-000002a0  aa 73 57 65 86 1e b2 af  c8 4b 03 84 1e 2a 3a f4  |.sWe.....K...*:.|
-000002b0  6e 45 73 9e 65 0a ca 3f  8a 14 03 03 00 01 01 16  |nEs.e..?........|
+00000230  88 0f 00 00 84 04 01 00  80 88 59 ec 09 a4 c9 5e  |..........Y....^|
+00000240  37 b4 e3 04 71 52 1a 5a  6d d6 9b f6 09 14 01 c2  |7...qR.Zm.......|
+00000250  3e 07 19 2f ec 15 d9 5b  12 6a 6e de 78 a3 ac 58  |>../...[.jn.x..X|
+00000260  40 44 f2 66 0a 12 a5 62  37 8b af 5a 3a 20 be f2  |@D.f...b7..Z: ..|
+00000270  6f 43 c8 00 69 21 c8 fd  b0 cf 00 74 c3 96 a0 8b  |oC..i!.....t....|
+00000280  6f ce c1 09 e6 90 1d 8e  53 40 b8 44 83 b9 46 9c  |o.......S@.D..F.|
+00000290  78 3b c1 0a 36 68 a5 04  e8 b5 ed 6d 7d 09 21 8c  |x;..6h.....m}.!.|
+000002a0  0e 00 0c 5e d0 2b 47 c9  f6 31 f6 8f 7b b6 2d 8d  |...^.+G..1..{.-.|
+000002b0  ec 4e c2 0d 08 c5 1b 26  b6 14 03 03 00 01 01 16  |.N.....&........|
 000002c0  03 03 00 40 00 00 00 00  00 00 00 00 00 00 00 00  |...@............|
-000002d0  00 00 00 00 ae b6 dd 09  5d ec ff 1c 09 88 eb a4  |........].......|
-000002e0  be c2 76 48 0c f0 7b 6f  50 f8 52 f9 81 97 28 aa  |..vH..{oP.R...(.|
-000002f0  31 31 91 ea 98 80 50 55  e0 71 9b 82 9b e8 48 ec  |11....PU.q....H.|
-00000300  3d 45 c3 f2                                       |=E..|
+000002d0  00 00 00 00 e7 64 7d 04  bb bf dd 2a ac fd 96 81  |.....d}....*....|
+000002e0  25 d8 3e 6c 1d 53 c7 79  31 4d 13 c3 71 d3 da c0  |%.>l.S.y1M..q...|
+000002f0  f8 74 11 bb 6b 9d 62 66  ed f0 97 ab 43 fe 12 cb  |.t..k.bf....C...|
+00000300  da 8d c2 4b                                       |...K|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 ca 5e 0f 47 25  |..........@.^.G%|
-00000010  5c a6 64 4d 90 74 ba d2  0b e8 df 3b cf 43 9a a7  |\.dM.t.....;.C..|
-00000020  95 28 d2 a6 0c 27 0f a9  d0 bf 11 c1 52 52 04 32  |.(...'......RR.2|
-00000030  14 9d 4a a1 35 3b 1d 5c  84 b5 72 79 5a fc 4c c9  |..J.5;.\..ryZ.L.|
-00000040  68 ca 64 9f b1 d9 ed 0b  98 66 53                 |h.d......fS|
+00000000  14 03 03 00 01 01 16 03  03 00 40 35 ee 36 65 9a  |..........@5.6e.|
+00000010  e5 ac c7 30 18 b6 ff f9  fd fa 66 88 a7 73 be ba  |...0......f..s..|
+00000020  d5 89 59 26 cf 2d 8d 31  48 f0 fb 09 c1 66 ef eb  |..Y&.-.1H....f..|
+00000030  94 30 b7 47 71 a1 cb 03  34 37 14 f5 76 14 13 a9  |.0.Gq...47..v...|
+00000040  6f d7 4d 59 c1 63 f8 db  8b 74 36                 |o.MY.c...t6|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 b8 30 3e  37 f6 8f 50 8b 97 78 81  |......0>7..P..x.|
-00000020  aa 53 ab 4d 44 a4 0a d7  3c 49 7f 59 33 b5 0e 22  |.S.MD...<I.Y3.."|
-00000030  c8 fd c6 70 dc 15 03 03  00 30 00 00 00 00 00 00  |...p.....0......|
-00000040  00 00 00 00 00 00 00 00  00 00 dc 74 fa 86 b9 66  |...........t...f|
-00000050  eb 0b 2e ef 57 b0 09 95  31 e6 8a 06 de 93 f7 7f  |....W...1.......|
-00000060  46 f1 7d b8 e3 16 fa 68  13 60                    |F.}....h.`|
+00000010  00 00 00 00 00 19 16 39  bc a3 30 b5 1d ae e5 a9  |.......9..0.....|
+00000020  74 89 1e d1 77 86 8f 85  55 fa af cb 0a 94 45 f4  |t...w...U.....E.|
+00000030  a9 fa 21 c5 54 15 03 03  00 30 00 00 00 00 00 00  |..!.T....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 40 17 27 41 8c ae  |..........@.'A..|
+00000050  74 59 34 f0 2e 72 34 4e  98 6e d8 da 17 07 b3 14  |tY4..r4N.n......|
+00000060  d8 c8 2c ad b6 3e 44 5a  3e d7                    |..,..>DZ>.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA
index c962841760..02b11a6933 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA
@@ -16,11 +16,11 @@
 000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 34 d6 64 e9 90  |....Y...U..4.d..|
-00000010  47 32 62 4a 36 f9 2f 2b  c9 04 24 8d 9d 71 e1 ec  |G2bJ6./+..$..q..|
-00000020  63 c3 14 73 e6 db 33 53  6e 79 3b 20 10 6c f9 58  |c..s..3Sny; .l.X|
-00000030  c2 2a c8 26 39 1c 33 75  f7 7b ab e0 82 ab e1 f1  |.*.&9.3u.{......|
-00000040  11 8b d3 58 18 39 11 4f  b8 08 12 6b c0 2f 00 00  |...X.9.O...k./..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 43 a0 10 ae 54  |....Y...U..C...T|
+00000010  09 23 be 14 d7 1d b3 64  66 5e 39 4e 42 ed 58 3a  |.#.....df^9NB.X:|
+00000020  1b de 35 eb ee 9b 86 44  fe 2b a8 20 e7 f1 4a 47  |..5....D.+. ..JG|
+00000030  b1 6b f0 fb d7 ed 3c 33  4a 52 bc 9b 39 c0 16 d3  |.k....<3JR..9...|
+00000040  f4 0a 7c 38 7e b3 95 31  7a c7 c8 f4 c0 2f 00 00  |..|8~..1z..../..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -60,17 +60,17 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 7e 32 3b e9 c4 9d 93  |........ ~2;....|
-000002d0  d9 b1 b3 fc 04 33 a6 1b  b9 e8 1a 24 79 5e 0d bc  |.....3.....$y^..|
-000002e0  e2 f9 ba cc 18 15 64 0a  69 08 04 00 80 73 c1 81  |......d.i....s..|
-000002f0  fe 44 26 be 95 56 d6 89  59 3d 5f 84 69 31 50 ed  |.D&..V..Y=_.i1P.|
-00000300  77 a2 67 4a 16 3c dc f2  28 14 4e 3a 90 15 b3 db  |w.gJ.<..(.N:....|
-00000310  f1 d8 e1 75 7d 61 a6 a0  33 28 72 62 3a 09 93 75  |...u}a..3(rb:..u|
-00000320  16 63 a2 8b 89 5d 83 e4  e4 d8 89 4b 82 b5 66 b6  |.c...].....K..f.|
-00000330  09 2f 30 3f 66 36 bb ae  a1 67 c9 de 40 8d c3 6a  |./0?f6...g..@..j|
-00000340  5c 96 74 c4 29 c1 3e 6d  a0 84 f8 8d d3 0d a5 70  |\.t.).>m.......p|
-00000350  fe 38 dc 01 f0 75 64 be  bf 38 ab 70 28 e2 06 b0  |.8...ud..8.p(...|
-00000360  ea 27 14 3f 0f 4e 4f fc  01 29 b0 40 64 16 03 03  |.'.?.NO..).@d...|
+000002c0  ac 0c 00 00 a8 03 00 1d  20 e7 c6 c3 84 0a b7 55  |........ ......U|
+000002d0  ff fb ae 43 10 da 03 0d  7d 91 77 90 cd 05 6a ab  |...C....}.w...j.|
+000002e0  08 35 5a 38 23 79 45 9f  54 08 04 00 80 d8 b8 a1  |.5Z8#yE.T.......|
+000002f0  67 15 39 93 cc d0 ac e7  55 85 3e 62 f3 a6 d8 35  |g.9.....U.>b...5|
+00000300  5e bb 60 4e 33 70 05 47  b8 9e 8c e6 85 65 09 e2  |^.`N3p.G.....e..|
+00000310  95 4f 8a d9 4b cb 60 62  3c ef 57 81 ed b4 20 cf  |.O..K.`b<.W... .|
+00000320  b1 71 d9 62 57 60 fa 07  89 12 a1 90 8f 8f 06 4a  |.q.bW`.........J|
+00000330  56 c3 81 e0 b6 11 9e ce  33 fe 0f 4e b2 84 cc 4b  |V.......3..N...K|
+00000340  dc d4 71 e4 43 04 61 11  a9 a6 8a 20 43 a7 0e b6  |..q.C.a.... C...|
+00000350  a8 97 43 1b e0 a9 b1 0f  e8 19 68 0a 5d 38 d9 69  |..C.......h.]8.i|
+00000360  22 65 16 aa 05 16 11 cd  66 4a 4f be 90 16 03 03  |"e......fJO.....|
 00000370  00 3a 0d 00 00 36 03 01  02 40 00 2e 04 03 05 03  |.:...6...@......|
 00000380  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000390  08 06 04 01 05 01 06 01  03 03 02 03 03 01 02 01  |................|
@@ -112,26 +112,26 @@
 00000200  e5 35 16 03 03 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
 00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 03 00  |......._X.;t....|
-00000230  88 0f 00 00 84 08 04 00  80 5f d8 fc 5f fb e6 09  |........._.._...|
-00000240  b6 2f ff 22 c5 4c bd 42  99 cb e7 ff 86 95 11 99  |./.".L.B........|
-00000250  8f 3e 4a b3 72 78 26 02  2f af 03 a2 39 e7 e2 29  |.>J.rx&./...9..)|
-00000260  ce 66 9a 72 1d bf fc 27  87 75 bf f1 ee 18 62 bd  |.f.r...'.u....b.|
-00000270  47 bc ee 39 fa 9c c2 c5  59 f6 f5 59 09 34 48 a9  |G..9....Y..Y.4H.|
-00000280  02 25 e9 66 a8 d5 a6 a6  e2 67 8e a9 53 c1 2e 66  |.%.f.....g..S..f|
-00000290  a8 64 3e 5e a7 63 c0 10  36 5e 77 47 23 8f 6f 14  |.d>^.c..6^wG#.o.|
-000002a0  59 08 36 e4 2a 47 4d ff  12 b4 be bb 76 8c 21 5e  |Y.6.*GM.....v.!^|
-000002b0  08 36 34 6d 9e 01 0c 7c  85 14 03 03 00 01 01 16  |.64m...|........|
-000002c0  03 03 00 28 00 00 00 00  00 00 00 00 e4 36 4e c9  |...(.........6N.|
-000002d0  5c ea e3 59 ae a1 45 74  17 b1 1e fe e4 a9 b8 da  |\..Y..Et........|
-000002e0  b5 ce 4a 24 39 93 d7 ac  8f fb 74 a0              |..J$9.....t.|
+00000230  88 0f 00 00 84 04 01 00  80 2e af 25 b4 ff 00 08  |...........%....|
+00000240  c8 dc 24 49 d5 9b d0 fe  b5 81 8d 4e 15 d4 63 bf  |..$I.......N..c.|
+00000250  8e 4c a4 7d 96 58 a2 4b  f4 25 a8 e3 39 fc df 2d  |.L.}.X.K.%..9..-|
+00000260  7c a0 20 61 86 35 8e 7e  ba a5 2c f3 07 ad 84 36  ||. a.5.~..,....6|
+00000270  df ef 66 e9 78 d8 5f b3  17 45 31 d4 4a 38 5c 6c  |..f.x._..E1.J8\l|
+00000280  03 73 3b 74 60 c9 00 d1  64 59 c9 a5 39 00 fc bf  |.s;t`...dY..9...|
+00000290  9c 3a 99 46 4b 71 90 64  8a 24 2e 37 cf 8a 42 c2  |.:.FKq.d.$.7..B.|
+000002a0  56 a6 94 97 60 c5 56 ba  de 71 78 6c f2 be ce 16  |V...`.V..qxl....|
+000002b0  47 ca 0d 95 3c cc b8 6f  b2 14 03 03 00 01 01 16  |G...<..o........|
+000002c0  03 03 00 28 00 00 00 00  00 00 00 00 8e 0e 3b 43  |...(..........;C|
+000002d0  63 52 24 16 91 bc 50 85  ef 34 ad b9 f0 45 e7 4c  |cR$...P..4...E.L|
+000002e0  9a 07 1d 46 53 2c 89 79  0f 27 dc 9d              |...FS,.y.'..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 8c 03 68 37 28  |..........(..h7(|
-00000010  47 c5 6c d6 33 ef 18 7e  f0 5e 93 fe a5 8a 2e 2a  |G.l.3..~.^.....*|
-00000020  72 e3 20 4d 98 d5 c5 a1  e2 55 a4 81 2b 0b b1 75  |r. M.....U..+..u|
-00000030  6c 02 20                                          |l. |
+00000000  14 03 03 00 01 01 16 03  03 00 28 2f 40 03 cf 5a  |..........(/@..Z|
+00000010  76 6c 87 87 8d 99 4c e8  76 73 6a 62 1d a5 31 bc  |vl....L.vsjb..1.|
+00000020  2e 7e 23 8c 50 bf 07 b9  13 53 4a 59 a0 9b 74 b7  |.~#.P....SJY..t.|
+00000030  53 21 2d                                          |S!-|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 1c 99 25  |...............%|
-00000010  ba ae 73 88 34 3e 85 49  d3 b9 00 77 6e c4 fc 67  |..s.4>.I...wn..g|
-00000020  9d c8 e2 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
-00000030  34 5f 22 7e 6f ee e7 03  fd 9e 30 9d 0f 63 85 d7  |4_"~o.....0..c..|
-00000040  c5 b7                                             |..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 83 69 b1  |..............i.|
+00000010  20 19 eb db d4 58 e7 f1  5a 95 b0 d3 9d 3b 74 ad  | ....X..Z....;t.|
+00000020  bc 94 c4 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
+00000030  7d 89 89 25 40 be 0d fc  24 d0 ff 5a 0f 24 5d f2  |}..%@...$..Z.$].|
+00000040  a3 ab                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPKCS1v15 b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPKCS1v15
index 0d05500264..26308fc9df 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPKCS1v15
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPKCS1v15
@@ -16,11 +16,11 @@
 000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 57 1c f0 38 28  |....Y...U..W..8(|
-00000010  4d 98 4e 9f 99 d8 d7 4d  7d c9 d9 bb 9d 80 b8 a5  |M.N....M}.......|
-00000020  ab 06 b4 55 9f 3e 9c ab  bb 6a e4 20 40 56 d1 8a  |...U.>...j. @V..|
-00000030  95 41 5a e0 3b 23 b7 c7  b9 b1 7b 3f b8 7a 02 c3  |.AZ.;#....{?.z..|
-00000040  f5 4b 20 b9 1b 42 7a df  81 99 c0 be c0 2f 00 00  |.K ..Bz....../..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 97 f2 cb de f1  |....Y...U.......|
+00000010  bb cf 9a 6c 6d 7e e2 94  af 9d 0b ed 02 cf fc b2  |...lm~..........|
+00000020  80 b2 7b 41 2c a6 83 e7  52 62 93 20 63 23 7f 48  |..{A,...Rb. c#.H|
+00000030  be c1 7f d3 75 34 fe 3a  ad 27 f5 99 b0 73 91 df  |....u4.:.'...s..|
+00000040  b3 e9 82 95 cd 1b f9 08  b6 3d 4f 9b c0 2f 00 00  |.........=O../..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -60,17 +60,17 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 ea fc 3d 92 b1 b7 a9  |........ ..=....|
-000002d0  28 d1 cf d8 03 d7 91 8f  c6 12 01 d8 ba cf fa 9f  |(...............|
-000002e0  cf 4b bc 8a 29 89 c0 54  4e 04 01 00 80 7d 62 b4  |.K..)..TN....}b.|
-000002f0  35 a9 dd 44 4a 31 44 e0  a8 e4 47 86 1b 69 62 87  |5..DJ1D...G..ib.|
-00000300  e5 a8 06 e3 6e f1 ef b9  46 bc d8 db c0 75 81 d1  |....n...F....u..|
-00000310  4c a2 0d 30 18 cd 89 4b  7b 26 bb 0b 44 2c 56 41  |L..0...K{&..D,VA|
-00000320  97 8d be 5e 86 e9 36 e5  d0 04 c8 c3 0c d3 f3 ce  |...^..6.........|
-00000330  9b 56 6a 6d bc 05 2b 5a  2b fb 26 bd 82 b1 1e 09  |.Vjm..+Z+.&.....|
-00000340  8c c5 4c a5 e7 c0 d2 12  77 3e 31 df 19 5e 20 82  |..L.....w>1..^ .|
-00000350  4a a3 6d fe 7f ec 4e eb  01 73 e0 6f 6d 9f 77 7a  |J.m...N..s.om.wz|
-00000360  6d 6b 9c 39 00 45 e2 d8  d9 f2 42 b9 6f 16 03 03  |mk.9.E....B.o...|
+000002c0  ac 0c 00 00 a8 03 00 1d  20 f8 3a 6c 5b 6f 88 48  |........ .:l[o.H|
+000002d0  19 c5 a2 e7 4a d9 6d 21  56 23 63 1b 1f 95 aa bc  |....J.m!V#c.....|
+000002e0  33 ac aa 3b bb f8 35 ba  1a 04 01 00 80 98 6d 7b  |3..;..5.......m{|
+000002f0  7d 40 13 81 6b 70 ec ac  60 ee 1d 3e 37 36 bc f4  |}@..kp..`..>76..|
+00000300  c1 9f 3c 13 b7 06 3d 38  be 4f 8c 3e e2 2e f2 b5  |..<...=8.O.>....|
+00000310  de 16 ec a0 5b 64 00 5c  c3 50 cc 79 a2 f7 e0 8d  |....[d.\.P.y....|
+00000320  68 e6 6b 1b b8 57 a4 15  d0 2c d7 4a be 97 26 26  |h.k..W...,.J..&&|
+00000330  8c 5c 4e 26 36 96 48 b5  0f 88 7b 37 43 e4 d1 24  |.\N&6.H...{7C..$|
+00000340  01 3c 70 38 99 c6 e2 2f  66 e7 db 57 30 f2 72 d0  |.<p8.../f..W0.r.|
+00000350  17 fd ad 09 a7 bd ee de  ca fd 57 15 de 25 b6 1f  |..........W..%..|
+00000360  ed 45 86 22 83 4e 64 54  56 17 1f 81 4f 16 03 03  |.E.".NdTV...O...|
 00000370  00 0c 0d 00 00 08 01 01  00 02 04 01 00 00 16 03  |................|
 00000380  03 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
@@ -109,26 +109,26 @@
 00000200  e5 35 16 03 03 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
 00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 03 00  |......._X.;t....|
-00000230  88 0f 00 00 84 04 01 00  80 3d 2d 03 f9 c8 89 09  |.........=-.....|
-00000240  5a e2 08 62 f5 9e 8c 38  be 74 6c 17 6d b6 58 b1  |Z..b...8.tl.m.X.|
-00000250  17 6c 47 1a 66 83 a9 78  35 1b 3d 8e 2c 38 71 b3  |.lG.f..x5.=.,8q.|
-00000260  f3 4d 7d 8a fe 3b ef 19  5a 46 20 5a 38 61 42 dd  |.M}..;..ZF Z8aB.|
-00000270  d3 21 1b aa 4f 6f 2f 58  ff c0 17 a2 a3 ea f2 d3  |.!..Oo/X........|
-00000280  f4 88 c0 d6 a2 99 38 b1  6e 71 fe f8 07 ba 50 7e  |......8.nq....P~|
-00000290  54 a5 b4 9a 5d 0a 2e 48  d4 f2 c9 89 79 1a ba 8e  |T...]..H....y...|
-000002a0  10 44 3f 50 f6 7b 27 f1  a0 b2 63 80 42 d4 be 7b  |.D?P.{'...c.B..{|
-000002b0  0c 91 bf 49 3b 4d 94 04  ec 14 03 03 00 01 01 16  |...I;M..........|
-000002c0  03 03 00 28 00 00 00 00  00 00 00 00 6f d2 48 9d  |...(........o.H.|
-000002d0  1d 53 c5 a4 db b0 ef f9  17 ef 64 4b fd 11 84 ee  |.S........dK....|
-000002e0  e0 fe 42 30 43 16 a8 dc  11 30 29 b7              |..B0C....0).|
+00000230  88 0f 00 00 84 04 01 00  80 a8 12 9d 84 c2 17 0a  |................|
+00000240  03 ae bd 87 9a b6 6f 65  2f 7a 04 1f 69 2a 41 f4  |......oe/z..i*A.|
+00000250  d0 9a 4d a4 5b 6e d2 d3  42 c3 77 4f 04 28 ce e6  |..M.[n..B.wO.(..|
+00000260  d4 25 c5 81 1b 78 91 e9  1e 93 90 57 b2 58 6f 26  |.%...x.....W.Xo&|
+00000270  ed 20 15 62 ff e9 c6 c1  52 4a 9a 05 a6 cd 17 22  |. .b....RJ....."|
+00000280  75 c8 81 da a4 96 af c6  83 b5 5c 81 93 59 44 26  |u.........\..YD&|
+00000290  5b 03 59 9d ab 93 ee c7  37 61 74 e7 4a 22 1c ec  |[.Y.....7at.J"..|
+000002a0  96 fb a2 c9 ea 2d 4b 8d  d3 a7 e4 60 57 10 be b7  |.....-K....`W...|
+000002b0  60 80 4f ee 8e 21 6b a2  13 14 03 03 00 01 01 16  |`.O..!k.........|
+000002c0  03 03 00 28 00 00 00 00  00 00 00 00 16 82 4a c0  |...(..........J.|
+000002d0  98 7b 62 3e 9b da a9 ac  31 f2 32 a9 23 13 2f e3  |.{b>....1.2.#./.|
+000002e0  77 c9 1e ca 39 9f 4c 8a  10 58 33 67              |w...9.L..X3g|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 94 ad 3c 46 c1  |..........(..<F.|
-00000010  6e bc 9d 7d 55 62 44 b8  be d7 6d a1 1b 3f 27 ee  |n..}UbD...m..?'.|
-00000020  94 a8 31 56 3d b9 bc 01  f8 60 33 d7 88 dd 27 13  |..1V=....`3...'.|
-00000030  45 eb 04                                          |E..|
+00000000  14 03 03 00 01 01 16 03  03 00 28 8e 56 d0 9c 38  |..........(.V..8|
+00000010  4f d9 df 12 9b dd 96 05  94 77 2f 6d 24 a8 cb 56  |O........w/m$..V|
+00000020  91 f9 bc ec 00 b5 cc 71  c4 f4 36 42 be 68 37 78  |.......q..6B.h7x|
+00000030  8f 6e 8c                                          |.n.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 6b 76 96  |.............kv.|
-00000010  5d 39 75 c4 e6 6c 94 f7  ab 20 75 d3 9d 90 1d 50  |]9u..l... u....P|
-00000020  4a de 73 15 03 03 00 1a  00 00 00 00 00 00 00 02  |J.s.............|
-00000030  a0 62 20 d2 d8 2f e8 9f  93 97 9e 3b b9 e8 47 69  |.b ../.....;..Gi|
-00000040  3f ee                                             |?.|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 1c 19 9e  |................|
+00000010  a5 40 f6 d7 8b 80 23 8a  0b fa 14 65 08 6a 3c 66  |.@....#....e.j<f|
+00000020  07 c4 d2 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
+00000030  16 7c e2 68 a5 d4 df 64  f4 1c 7d 17 b6 14 0a 4c  |.|.h...d..}....L|
+00000040  40 8e                                             |@.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPSS b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPSS
index 312674fab5..f788e6f600 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPSS
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPSS
@@ -16,11 +16,11 @@
 000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 e5 8a 69 16 37  |....Y...U....i.7|
-00000010  65 58 a7 2b 85 d8 ff 46  bb 32 af b3 10 ef ee 84  |eX.+...F.2......|
-00000020  d4 a7 72 d0 5d 8e 59 7a  a4 07 fe 20 19 76 75 fd  |..r.].Yz... .vu.|
-00000030  19 e5 64 98 83 fc 3d 59  4b 8a 39 fc 66 61 c5 5d  |..d...=YK.9.fa.]|
-00000040  58 09 7d 04 69 3c 30 9c  e8 e8 33 6a c0 2f 00 00  |X.}.i<0...3j./..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 be 63 44 bb 7e  |....Y...U...cD.~|
+00000010  0d 88 88 15 b1 ed 7e 75  03 57 25 1a 0c 52 42 31  |......~u.W%..RB1|
+00000020  f8 e1 46 e3 11 27 ff 05  5e 26 2e 20 e6 31 d0 a6  |..F..'..^&. .1..|
+00000030  d9 7c 69 a6 57 09 ee 50  c5 3c 5e 1d a0 a7 2b 7a  |.|i.W..P.<^...+z|
+00000040  7c dd 04 b4 38 45 c9 90  a0 98 33 68 c0 2f 00 00  ||...8E....3h./..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 66 0b 00 02 62 00  02 5f 00 02 5c 30 82 02  |..f...b.._..\0..|
 00000070  58 30 82 01 8d a0 03 02  01 02 02 11 00 f2 99 26  |X0.............&|
@@ -61,75 +61,82 @@
 000002a0  11 89 66 79 d1 8e 88 0e  0b a0 9e 30 2a c0 67 ef  |..fy.......0*.g.|
 000002b0  ca 46 02 88 e9 53 81 22  69 22 97 ad 80 93 d4 f7  |.F...S."i"......|
 000002c0  dd 70 14 24 d7 70 0a 46  a1 16 03 03 00 ac 0c 00  |.p.$.p.F........|
-000002d0  00 a8 03 00 1d 20 12 58  2b bb a1 46 a0 0c 3b 58  |..... .X+..F..;X|
-000002e0  1e 57 93 c2 b2 7f 58 ec  d1 ed 91 a1 6d e9 4f 8b  |.W....X.....m.O.|
-000002f0  cb 81 c4 73 a5 04 08 04  00 80 cd 29 91 fc 9b 6c  |...s.......)...l|
-00000300  58 f7 34 95 41 87 90 f6  47 7d 26 5f 9c 0e ec 1c  |X.4.A...G}&_....|
-00000310  90 f0 16 ad 44 9f 4f a9  90 0c f0 b1 d3 39 c8 ab  |....D.O......9..|
-00000320  87 35 72 71 db d0 4a 05  78 f8 c3 2e 23 2a 57 59  |.5rq..J.x...#*WY|
-00000330  ac d4 7f c5 97 7d 0b 1e  12 71 0b cc c7 81 32 0a  |.....}...q....2.|
-00000340  9f 6e 5d 63 4a 6d e1 f1  b5 17 65 3b 49 3f 11 3a  |.n]cJm....e;I?.:|
-00000350  ac 05 e3 4b f0 12 c0 b0  ee 51 fb e5 0e 2f 30 3d  |...K.....Q.../0=|
-00000360  a9 bd 4b de 30 0b bd 41  94 39 92 51 6b ea 89 97  |..K.0..A.9.Qk...|
-00000370  36 04 ea ed 01 d9 d4 79  80 61 16 03 03 00 0c 0d  |6......y.a......|
-00000380  00 00 08 01 01 00 02 08  04 00 00 16 03 03 00 04  |................|
+000002d0  00 a8 03 00 1d 20 60 8e  8a 17 8a fc b4 4f 01 ad  |..... `......O..|
+000002e0  f8 ef 44 f3 fc af 2a 90  57 7d ba 1d dd a6 17 cc  |..D...*.W}......|
+000002f0  c6 4a 5f a2 fb 47 08 04  00 80 46 d8 62 04 19 4a  |.J_..G....F.b..J|
+00000300  29 9b cc 3c 2c 0d 7e 67  3d 97 c0 32 65 90 28 e2  |)..<,.~g=..2e.(.|
+00000310  e9 df 7d 9b e1 62 82 a9  0b 22 99 a0 ae b9 7a 31  |..}..b..."....z1|
+00000320  75 c2 6e 61 e7 a5 64 b9  72 ce b8 04 b2 ca 14 78  |u.na..d.r......x|
+00000330  d4 b4 c2 b4 57 b4 a4 70  f9 d1 bf d0 77 e3 f5 66  |....W..p....w..f|
+00000340  c0 3f dd b2 40 30 3d d5  e9 a6 d1 49 79 ac ea b9  |.?..@0=....Iy...|
+00000350  38 43 52 3c a0 1c be 0d  18 a2 fc c0 a6 43 80 91  |8CR<.........C..|
+00000360  3f c5 c2 3a 43 31 92 ff  58 a8 40 52 b3 99 0f c4  |?..:C1..X.@R....|
+00000370  c6 00 89 0b b9 f4 9e 28  cd bf 16 03 03 00 0c 0d  |.......(........|
+00000380  00 00 08 01 01 00 02 04  01 00 00 16 03 03 00 04  |................|
 00000390  0e 00 00 00                                       |....|
 >>> Flow 3 (client to server)
-00000000  16 03 03 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
-00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
-00000020  c1 89 65 83 55 6f dc 0b  c9 b9 93 9f e9 bc 30 0d  |..e.Uo........0.|
-00000030  06 09 2a 86 48 86 f7 0d  01 01 0b 05 00 30 12 31  |..*.H........0.1|
-00000040  10 30 0e 06 03 55 04 0a  13 07 41 63 6d 65 20 43  |.0...U....Acme C|
-00000050  6f 30 1e 17 0d 31 36 30  38 31 37 32 31 35 32 33  |o0...16081721523|
-00000060  31 5a 17 0d 31 37 30 38  31 37 32 31 35 32 33 31  |1Z..170817215231|
-00000070  5a 30 12 31 10 30 0e 06  03 55 04 0a 13 07 41 63  |Z0.1.0...U....Ac|
-00000080  6d 65 20 43 6f 30 81 9f  30 0d 06 09 2a 86 48 86  |me Co0..0...*.H.|
-00000090  f7 0d 01 01 01 05 00 03  81 8d 00 30 81 89 02 81  |...........0....|
-000000a0  81 00 ba 6f aa 86 bd cf  bf 9f f2 ef 5c 94 60 78  |...o........\.`x|
-000000b0  6f e8 13 f2 d1 96 6f cd  d9 32 6e 22 37 ce 41 f9  |o.....o..2n"7.A.|
-000000c0  ca 5d 29 ac e1 27 da 61  a2 ee 81 cb 10 c7 df 34  |.])..'.a.......4|
-000000d0  58 95 86 e9 3d 19 e6 5c  27 73 60 c8 8d 78 02 f4  |X...=..\'s`..x..|
-000000e0  1d a4 98 09 a3 19 70 69  3c 25 62 66 2a ab 22 23  |......pi<%bf*."#|
-000000f0  c5 7b 85 38 4f 2e 09 73  32 a7 bd 3e 9b ad ca 84  |.{.8O..s2..>....|
-00000100  07 e6 0f 3a ff 77 c5 9d  41 85 00 8a b6 9b ee b0  |...:.w..A.......|
-00000110  a4 3f 2d 4c 4c e6 42 3e  bb 51 c8 dd 48 54 f4 0c  |.?-LL.B>.Q..HT..|
-00000120  8e 47 02 03 01 00 01 a3  46 30 44 30 0e 06 03 55  |.G......F0D0...U|
-00000130  1d 0f 01 01 ff 04 04 03  02 05 a0 30 13 06 03 55  |...........0...U|
-00000140  1d 25 04 0c 30 0a 06 08  2b 06 01 05 05 07 03 01  |.%..0...+.......|
-00000150  30 0c 06 03 55 1d 13 01  01 ff 04 02 30 00 30 0f  |0...U.......0.0.|
-00000160  06 03 55 1d 11 04 08 30  06 87 04 7f 00 00 01 30  |..U....0.......0|
-00000170  0d 06 09 2a 86 48 86 f7  0d 01 01 0b 05 00 03 81  |...*.H..........|
-00000180  81 00 46 ab 44 a2 fb 28  54 f8 5a 67 f8 62 94 f1  |..F.D..(T.Zg.b..|
-00000190  9a b2 18 9e f2 b1 de 1d  7e 6f 76 95 a9 ba e7 5d  |........~ov....]|
-000001a0  a8 16 6c 9c f7 09 d3 37  e4 4b 2b 36 7c 01 ad 41  |..l....7.K+6|..A|
-000001b0  d2 32 d8 c3 d2 93 f9 10  6b 8e 95 b9 2c 17 8a a3  |.2......k...,...|
-000001c0  44 48 bc 59 13 83 16 04  88 a4 81 5c 25 0d 98 0c  |DH.Y.......\%...|
-000001d0  ac 11 b1 28 56 be 1d cd  61 62 84 09 bf d6 80 c6  |...(V...ab......|
-000001e0  45 8d 82 2c b4 d8 83 9b  db c9 22 b7 2a 12 11 7b  |E..,......".*..{|
-000001f0  fa 02 3b c1 c9 ff ea c9  9d a8 49 d3 95 d7 d5 0e  |..;.......I.....|
-00000200  e5 35 16 03 03 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
-00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
-00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 03 00  |......._X.;t....|
-00000230  88 0f 00 00 84 08 04 00  80 5a e9 85 d9 20 4b f7  |.........Z... K.|
-00000240  3e 70 ad 9b e9 8b 92 28  0f 8e 10 de bf 62 9e 34  |>p.....(.....b.4|
-00000250  5b b4 5e be 1e d4 59 18  e2 0b 46 b1 88 10 8f 19  |[.^...Y...F.....|
-00000260  3b 34 aa 4b fa 35 c4 f2  b5 09 75 af 7b 62 4f b7  |;4.K.5....u.{bO.|
-00000270  e5 6b a5 76 c4 c9 62 f3  36 aa 55 31 a0 6e 71 f1  |.k.v..b.6.U1.nq.|
-00000280  3c 40 e4 46 88 1c 96 cf  04 85 cc 92 32 65 49 be  |<@.F........2eI.|
-00000290  a7 72 c7 2b b1 71 c6 6b  a0 87 67 26 8f 5c 14 f7  |.r.+.q.k..g&.\..|
-000002a0  18 27 f3 13 f5 b5 31 a0  7e 6a b3 a9 ac b8 06 d5  |.'....1.~j......|
-000002b0  e5 9c ec 87 51 1c f6 aa  57 14 03 03 00 01 01 16  |....Q...W.......|
-000002c0  03 03 00 28 00 00 00 00  00 00 00 00 3a 36 e8 ed  |...(........:6..|
-000002d0  d0 88 1f 64 e1 89 b2 3d  2c e4 fb c0 cb 77 56 ca  |...d...=,....wV.|
-000002e0  ea 63 be 25 e4 eb 99 3e  35 aa f2 75              |.c.%...>5..u|
+00000000  16 03 03 02 66 0b 00 02  62 00 02 5f 00 02 5c 30  |....f...b.._..\0|
+00000010  82 02 58 30 82 01 8d a0  03 02 01 02 02 11 00 f2  |..X0............|
+00000020  99 26 eb 87 ea 8a 0d b9  fc c2 47 34 7c 11 b0 30  |.&........G4|..0|
+00000030  41 06 09 2a 86 48 86 f7  0d 01 01 0a 30 34 a0 0f  |A..*.H......04..|
+00000040  30 0d 06 09 60 86 48 01  65 03 04 02 01 05 00 a1  |0...`.H.e.......|
+00000050  1c 30 1a 06 09 2a 86 48  86 f7 0d 01 01 08 30 0d  |.0...*.H......0.|
+00000060  06 09 60 86 48 01 65 03  04 02 01 05 00 a2 03 02  |..`.H.e.........|
+00000070  01 20 30 12 31 10 30 0e  06 03 55 04 0a 13 07 41  |. 0.1.0...U....A|
+00000080  63 6d 65 20 43 6f 30 1e  17 0d 31 37 31 31 32 33  |cme Co0...171123|
+00000090  31 36 31 36 31 30 5a 17  0d 31 38 31 31 32 33 31  |161610Z..1811231|
+000000a0  36 31 36 31 30 5a 30 12  31 10 30 0e 06 03 55 04  |61610Z0.1.0...U.|
+000000b0  0a 13 07 41 63 6d 65 20  43 6f 30 81 9f 30 0d 06  |...Acme Co0..0..|
+000000c0  09 2a 86 48 86 f7 0d 01  01 01 05 00 03 81 8d 00  |.*.H............|
+000000d0  30 81 89 02 81 81 00 db  46 7d 93 2e 12 27 06 48  |0.......F}...'.H|
+000000e0  bc 06 28 21 ab 7e c4 b6  a2 5d fe 1e 52 45 88 7a  |..(!.~...]..RE.z|
+000000f0  36 47 a5 08 0d 92 42 5b  c2 81 c0 be 97 79 98 40  |6G....B[.....y.@|
+00000100  fb 4f 6d 14 fd 2b 13 8b  c2 a5 2e 67 d8 d4 09 9e  |.Om..+.....g....|
+00000110  d6 22 38 b7 4a 0b 74 73  2b c2 34 f1 d1 93 e5 96  |."8.J.ts+.4.....|
+00000120  d9 74 7b f3 58 9f 6c 61  3c c0 b0 41 d4 d9 2b 2b  |.t{.X.la<..A..++|
+00000130  24 23 77 5b 1c 3b bd 75  5d ce 20 54 cf a1 63 87  |$#w[.;.u]. T..c.|
+00000140  1d 1e 24 c4 f3 1d 1a 50  8b aa b6 14 43 ed 97 a7  |..$....P....C...|
+00000150  75 62 f4 14 c8 52 d7 02  03 01 00 01 a3 46 30 44  |ub...R.......F0D|
+00000160  30 0e 06 03 55 1d 0f 01  01 ff 04 04 03 02 05 a0  |0...U...........|
+00000170  30 13 06 03 55 1d 25 04  0c 30 0a 06 08 2b 06 01  |0...U.%..0...+..|
+00000180  05 05 07 03 01 30 0c 06  03 55 1d 13 01 01 ff 04  |.....0...U......|
+00000190  02 30 00 30 0f 06 03 55  1d 11 04 08 30 06 87 04  |.0.0...U....0...|
+000001a0  7f 00 00 01 30 41 06 09  2a 86 48 86 f7 0d 01 01  |....0A..*.H.....|
+000001b0  0a 30 34 a0 0f 30 0d 06  09 60 86 48 01 65 03 04  |.04..0...`.H.e..|
+000001c0  02 01 05 00 a1 1c 30 1a  06 09 2a 86 48 86 f7 0d  |......0...*.H...|
+000001d0  01 01 08 30 0d 06 09 60  86 48 01 65 03 04 02 01  |...0...`.H.e....|
+000001e0  05 00 a2 03 02 01 20 03  81 81 00 cd ac 4e f2 ce  |...... ......N..|
+000001f0  5f 8d 79 88 10 42 70 7f  7c bf 1b 5a 8a 00 ef 19  |_.y..Bp.|..Z....|
+00000200  15 4b 40 15 17 71 00 6c  d4 16 26 e5 49 6d 56 da  |.K@..q.l..&.ImV.|
+00000210  0c 1a 13 9f d8 46 95 59  3c b6 7f 87 76 5e 18 aa  |.....F.Y<...v^..|
+00000220  03 ea 06 75 22 dd 78 d2  a5 89 b8 c9 23 64 e1 28  |...u".x.....#d.(|
+00000230  38 ce 34 6c 6e 06 7b 51  f1 a7 e6 f4 b3 7f fa b1  |8.4ln.{Q........|
+00000240  3f 14 11 89 66 79 d1 8e  88 0e 0b a0 9e 30 2a c0  |?...fy.......0*.|
+00000250  67 ef ca 46 02 88 e9 53  81 22 69 22 97 ad 80 93  |g..F...S."i"....|
+00000260  d4 f7 dd 70 14 24 d7 70  0a 46 a1 16 03 03 00 25  |...p.$.p.F.....%|
+00000270  10 00 00 21 20 2f e5 7d  a3 47 cd 62 43 15 28 da  |...! /.}.G.bC.(.|
+00000280  ac 5f bb 29 07 30 ff f6  84 af c4 cf c2 ed 90 99  |._.).0..........|
+00000290  5f 58 cb 3b 74 16 03 03  00 88 0f 00 00 84 04 01  |_X.;t...........|
+000002a0  00 80 d5 bf 41 e0 65 7b  32 16 bb a3 92 48 f6 0e  |....A.e{2....H..|
+000002b0  31 eb ca a2 b7 1c b3 3a  b4 8f 91 0e 44 e8 9e ad  |1......:....D...|
+000002c0  f7 71 4c 71 20 da 59 29  09 4f 0b 1e fb 92 c5 ce  |.qLq .Y).O......|
+000002d0  7b a3 26 de 89 be f5 cc  b6 be dc af 09 6a f9 a2  |{.&..........j..|
+000002e0  f0 65 5c 39 2d ad 2c 46  ce df 26 09 2e 99 5d 9e  |.e\9-.,F..&...].|
+000002f0  58 2b cf 1f ed b5 1a 4b  21 0b d8 ec 14 fb bb f2  |X+.....K!.......|
+00000300  eb 41 9d 1c 6a 06 d8 38  b9 68 fc 1d 90 ad ff 9c  |.A..j..8.h......|
+00000310  91 c1 4a ff b0 49 59 8a  0b 25 26 eb 28 b1 a5 f8  |..J..IY..%&.(...|
+00000320  0d 8e 14 03 03 00 01 01  16 03 03 00 28 00 00 00  |............(...|
+00000330  00 00 00 00 00 cd a4 31  83 38 57 c8 91 98 4c 6c  |.......1.8W...Ll|
+00000340  76 c7 e1 d8 af f9 47 ee  45 75 f4 51 6c e5 7e da  |v.....G.Eu.Ql.~.|
+00000350  00 0f da 44 49                                    |...DI|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 31 96 46 0c 69  |..........(1.F.i|
-00000010  f0 46 54 dc 0f c7 1c c0  0f e2 b6 8b 53 71 66 94  |.FT.........Sqf.|
-00000020  f8 7b 82 7c 76 ab 8c c3  d0 a0 0a e9 03 e8 bf 4f  |.{.|v..........O|
-00000030  c4 c5 84                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 28 7f 1d 85 46 4c  |..........(...FL|
+00000010  7f 93 d7 e3 c1 3f a7 71  69 16 90 9a a6 f8 9a 22  |.....?.qi......"|
+00000020  a5 8b 0e 6d 6a f2 08 7e  40 6d ba 87 74 e4 e6 1d  |...mj..~@m..t...|
+00000030  ba 5e ff                                          |.^.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 3c 54 13  |.............<T.|
-00000010  1d 87 2b ee dc 4e 2d 29  69 0b ed 9a fe 6a 61 b7  |..+..N-)i....ja.|
-00000020  f0 db b1 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
-00000030  86 bd af cd 8b 2f 42 92  67 dc 24 df 9c 01 fb 0f  |...../B.g.$.....|
-00000040  92 a4                                             |..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 2a 5a a1  |.............*Z.|
+00000010  d5 31 ba 8b 9d 3f f1 54  e0 53 cf 84 70 3b f5 bf  |.1...?.T.S..p;..|
+00000020  11 3c ad 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.<..............|
+00000030  1b ad 23 3d 37 69 87 9d  b5 60 f1 8a 13 d6 09 ab  |..#=7i...`......|
+00000040  a4 9b                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce
index 8fc6f97832..96f7b00073 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce
@@ -16,11 +16,11 @@
 000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 9d 18 45 c0 0c  |....Y...U....E..|
-00000010  2a 95 e6 13 ac b3 e5 fd  fb b1 ed 96 75 8b d3 e9  |*...........u...|
-00000020  a9 53 cd a7 43 dc 87 18  ab 98 f4 20 2e 5d 71 f3  |.S..C...... .]q.|
-00000030  40 c8 e3 ba b1 5d 88 3d  66 71 65 a1 43 1f e8 65  |@....].=fqe.C..e|
-00000040  9c 7b 0a fc b7 81 79 e2  99 c5 c9 3e cc a8 00 00  |.{....y....>....|
+00000000  16 03 03 00 59 02 00 00  55 03 03 1c 04 37 7b 4d  |....Y...U....7{M|
+00000010  49 2a 45 1d e8 db 60 7e  7d be 7b 2d ff a2 dc aa  |I*E...`~}.{-....|
+00000020  b7 5e 66 f9 67 bf 58 f7  f1 0a 7b 20 f2 72 71 31  |.^f.g.X...{ .rq1|
+00000030  2a 6e 5e 2b e4 29 ef bc  3a 56 45 26 53 b4 9f 98  |*n^+.)..:VE&S...|
+00000040  fb 07 d5 2f b3 f3 f0 3b  02 1f 00 9b cc a8 00 00  |.../...;........|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -60,185 +60,185 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 c8 2a 20 5e 3c 62 eb  |........ .* ^<b.|
-000002d0  4b e8 82 af fb 71 2c a2  32 1d 73 da 8e 86 da 5c  |K....q,.2.s....\|
-000002e0  cd 86 ea 13 1d 07 09 cd  7a 08 04 00 80 06 72 af  |........z.....r.|
-000002f0  02 db 9d 4c 5b f8 ce 72  5c a5 55 23 2f a8 14 1f  |...L[..r\.U#/...|
-00000300  6f aa 83 1b f2 ce 28 d7  6c 7d ee 82 35 b3 26 d1  |o.....(.l}..5.&.|
-00000310  d8 ae 1a a4 be ff d5 ab  22 3f c4 c7 4e d7 60 46  |........"?..N.`F|
-00000320  c3 ae 09 17 bf 4d 29 bd  32 a9 80 f1 2d 71 24 46  |.....M).2...-q$F|
-00000330  27 81 d4 c3 13 da 84 ca  c5 ad ca 52 0d 56 02 8f  |'..........R.V..|
-00000340  62 51 9f 88 26 16 6e da  22 c8 80 29 a7 26 7c 5a  |bQ..&.n."..).&|Z|
-00000350  be 37 e4 e8 49 fd 62 be  ce 03 36 23 e9 cd a0 a0  |.7..I.b...6#....|
-00000360  69 be 23 aa f3 57 51 58  e5 41 d9 1d e7 16 03 03  |i.#..WQX.A......|
+000002c0  ac 0c 00 00 a8 03 00 1d  20 6f fe 48 78 c0 68 41  |........ o.Hx.hA|
+000002d0  fa 5a 33 f5 9b e0 b2 ae  93 e9 0c 5a 78 60 32 67  |.Z3........Zx`2g|
+000002e0  de cf 17 26 20 88 3a f5  5e 08 04 00 80 58 d9 c5  |...& .:.^....X..|
+000002f0  f0 c3 9e f5 4d a5 20 3e  ed da a2 7d b9 2a 9b 95  |....M. >...}.*..|
+00000300  ec 1c 2a c1 28 22 3e 36  4f 5a fe eb 2a 6a 9e 9e  |..*.(">6OZ..*j..|
+00000310  01 83 31 93 d1 bd 0f 6f  ff 9d e8 4e 7a cb 9d 8f  |..1....o...Nz...|
+00000320  63 92 bc f2 0e 37 1f e0  8a 1e 22 2c eb 53 e8 25  |c....7....",.S.%|
+00000330  15 20 97 1f 0c 75 5a 9d  6a aa e6 a6 86 d9 5d 4d  |. ...uZ.j.....]M|
+00000340  b8 58 d1 03 63 d4 8d cb  0b 4d 97 2e eb 50 13 39  |.X..c....M...P.9|
+00000350  07 5c d9 a8 bf cf eb 05  47 0a 48 30 5b 71 c0 ea  |.\......G.H0[q..|
+00000360  cb 4f 22 27 1a d2 58 02  ca 07 bd 03 f1 16 03 03  |.O"'..X.........|
 00000370  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 41 b1 f9  75 8c 2e 5c 22 45 0e 79  |.... A..u..\"E.y|
-00000040  e8 50 65 39 43 57 8f d7  48 c6 89 15 d7 c0 98 88  |.Pe9CW..H.......|
-00000050  55 e7 ca eb 4a                                    |U...J|
+00000030  16 03 03 00 20 f9 b0 26  8b 30 54 a5 80 7e 5b 47  |.... ..&.0T..~[G|
+00000040  2e b1 28 07 ef 12 93 33  5a 8d 5e de 8d 56 d5 c3  |..(....3Z.^..V..|
+00000050  3c 05 a8 f1 5e                                    |<...^|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 08 71 d8 91 d6  |.......... .q...|
-00000010  af 29 72 cb 85 4d a8 b2  50 e5 f4 93 d5 36 5d 6a  |.)r..M..P....6]j|
-00000020  df 15 b1 65 78 17 d7 4f  d6 9f 79                 |...ex..O..y|
+00000000  14 03 03 00 01 01 16 03  03 00 20 c1 77 25 ba a7  |.......... .w%..|
+00000010  08 ba 0d 1e 8b e2 eb 11  77 d8 c7 e2 20 e0 60 da  |........w... .`.|
+00000020  97 f5 42 f4 12 bb 94 35  b7 ee c8                 |..B....5...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 ff 2f ef  38 41 82 36 13 74 3a 38  |....../.8A.6.t:8|
-00000010  a8 52 2c bd 4c 15 4b 7b  f1 c6 f2                 |.R,.L.K{...|
+00000000  17 03 03 00 16 6f f6 5b  37 2f 21 25 ae e9 30 be  |.....o.[7/!%..0.|
+00000010  ce b4 66 f7 fd 9a 5a 02  9d 43 e8                 |..f...Z..C.|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 14 4b 1e 75  04 1a e1 14 6e 16 79 03  |.....K.u....n.y.|
-00000010  9a 3f 87 2b b1 c4 07 d7  53                       |.?.+....S|
+00000000  16 03 03 00 14 8f be 53  56 e9 19 ec 85 79 d0 cc  |.......SV....y..|
+00000010  8d ab 43 3c b2 7b a3 55  57                       |..C<.{.UW|
 >>> Flow 7 (client to server)
-00000000  16 03 03 01 16 de 71 13  6c df 97 84 38 ce 2d c6  |......q.l...8.-.|
-00000010  e3 39 e0 55 66 4e 3d 5e  6c eb c5 a8 1a aa 66 6a  |.9.UfN=^l.....fj|
-00000020  32 63 97 22 88 26 b8 ad  5f 0a 78 53 9a a4 29 bb  |2c.".&.._.xS..).|
-00000030  4e 23 90 36 22 1f a7 3d  9c 06 eb 27 c5 7e fb b2  |N#.6"..=...'.~..|
-00000040  bf de 93 c4 aa e1 da cb  23 15 1b 55 2f 54 3d 12  |........#..U/T=.|
-00000050  f2 62 7f 1f bb 09 16 be  1d 8b 13 eb 9e 53 e2 15  |.b...........S..|
-00000060  a5 37 72 41 48 20 9c e7  a6 ba ba 82 52 9d 2c 99  |.7rAH ......R.,.|
-00000070  0a c5 83 e1 7e 22 ec 11  f3 50 64 6f 36 ef 43 fd  |....~"...Pdo6.C.|
-00000080  98 92 e4 f6 b6 fb d2 a7  1f dd f8 2a 6d 78 3b ea  |...........*mx;.|
-00000090  de 84 4e 11 a1 0a 0b f6  ea c5 78 63 82 7a 0c fc  |..N.......xc.z..|
-000000a0  9e 96 b2 a5 ce a8 83 ab  02 1e b1 e1 e0 12 92 8a  |................|
-000000b0  19 7a 72 31 d0 92 95 e7  f2 f1 63 d1 80 4a c2 be  |.zr1......c..J..|
-000000c0  b5 f4 f9 23 8d ab 21 8f  c3 3d 99 5d f0 aa d2 3a  |...#..!..=.]...:|
-000000d0  ee 43 17 ba d2 6b d9 2c  ef b4 55 3c af e7 d3 22  |.C...k.,..U<..."|
-000000e0  c8 70 c5 3b 0b a2 02 54  a5 2e 8d 06 56 76 f9 3f  |.p.;...T....Vv.?|
-000000f0  d1 b6 b7 ea 2c 90 4d 37  3f 4b 05 8a ea 88 dc 5e  |....,.M7?K.....^|
-00000100  04 50 a3 d2 46 d5 22 08  e1 d6 4e a3 40 ae 0c cc  |.P..F."...N.@...|
-00000110  c4 7f be ac cd b9 74 07  ad c7 07                 |......t....|
+00000000  16 03 03 01 16 ab 36 6a  25 3d 93 3c 71 b6 5b 91  |......6j%=.<q.[.|
+00000010  8d 58 37 42 24 7f d9 16  71 64 64 49 f1 4b ff d8  |.X7B$...qddI.K..|
+00000020  47 8f 2a 27 93 d2 63 a1  7e bf 76 94 b5 e5 a6 d4  |G.*'..c.~.v.....|
+00000030  79 97 60 76 18 a5 4a 47  85 89 49 01 48 5c ff 73  |y.`v..JG..I.H\.s|
+00000040  99 b4 44 9d f6 53 44 2e  b8 21 75 b5 d6 98 c7 33  |..D..SD..!u....3|
+00000050  7c 1a 25 7f 8d 79 db 7f  05 8c 9e e4 d8 9c 4b 57  ||.%..y........KW|
+00000060  45 70 42 ba 2c c1 45 f4  69 04 5a 87 ab f7 e4 d1  |EpB.,.E.i.Z.....|
+00000070  6a ed e9 cf ab 79 1c bc  dc c6 2d 72 1b 94 51 17  |j....y....-r..Q.|
+00000080  2f 2a 1a f2 0f 85 66 97  15 81 4b 99 e7 75 ec 19  |/*....f...K..u..|
+00000090  61 20 a7 92 f3 14 e1 a0  f8 a0 ad ba 9f ef d5 5d  |a .............]|
+000000a0  f1 92 ff 50 1b 66 9f e0  39 c4 58 a5 59 c5 eb 46  |...P.f..9.X.Y..F|
+000000b0  4b f5 53 6d 04 dd bc b4  71 d8 2b cf 4d 73 67 74  |K.Sm....q.+.Msgt|
+000000c0  c1 8d ab d2 53 0a 91 ce  90 03 ed e4 d8 23 1a ff  |....S........#..|
+000000d0  2c 70 1a 42 bc fb 80 5b  a8 97 aa 9b 6e 27 2c ec  |,p.B...[....n',.|
+000000e0  78 30 5c 9f 6f 5d 65 dd  f3 e2 41 9c ad 8d 12 58  |x0\.o]e...A....X|
+000000f0  39 ef ed cf 0b 73 28 c7  f4 37 f3 a2 16 39 18 c5  |9....s(..7...9..|
+00000100  db b8 b6 db b9 b2 56 f2  9b 60 38 9f 82 60 45 06  |......V..`8..`E.|
+00000110  3e 6b cf 9c 2f 1e 5d 0b  ff 80 cb                 |>k../.]....|
 >>> Flow 8 (server to client)
-00000000  16 03 03 00 81 ed 7f 67  61 ef ed 9f 72 81 fa 1f  |.......ga...r...|
-00000010  1c be 39 c5 a4 7b a8 4d  37 1c 12 f2 92 0c 9f f7  |..9..{.M7.......|
-00000020  ca a9 40 bc 83 da 2b 57  e4 6d 90 64 9e 0b 4e f3  |..@...+W.m.d..N.|
-00000030  ee 4b 02 0a f5 db 0e 6f  84 f5 d8 21 bc c8 b7 84  |.K.....o...!....|
-00000040  4e ee ad 90 ff 55 12 37  d4 94 c8 7a 8d 44 c1 58  |N....U.7...z.D.X|
-00000050  1d d5 14 2f ef 92 39 97  0a dd c9 5f 33 c6 38 c9  |.../..9...._3.8.|
-00000060  b8 c9 e8 0b cb d9 05 83  b5 78 bd 2e 35 9e 58 77  |.........x..5.Xw|
-00000070  68 df ae 88 1f 64 f6 3c  10 b5 de ee 90 45 ba fc  |h....d.<.....E..|
-00000080  37 ea f1 86 65 a0 16 03  03 02 69 b0 a0 7c 81 6d  |7...e.....i..|.m|
-00000090  2b 18 96 82 5c 61 0f c2  f6 82 f9 7f e6 d5 98 c7  |+...\a..........|
-000000a0  43 3b e1 a5 eb 9b 4a fc  84 83 6e db 45 d1 f8 25  |C;....J...n.E..%|
-000000b0  fe b0 db 78 4a 27 3c fa  87 3d 17 75 c1 ff 4a 59  |...xJ'<..=.u..JY|
-000000c0  49 3a a9 7f c1 48 ca e3  d3 bf 63 42 b1 18 0a 4e  |I:...H....cB...N|
-000000d0  c2 b3 54 c3 59 3a 0f 8c  4d e8 c9 5d 9a 73 27 20  |..T.Y:..M..].s' |
-000000e0  8d 5b fe b3 2f bb 58 e4  f7 27 1c eb dd 3e 3a ff  |.[../.X..'...>:.|
-000000f0  75 8b e5 c9 5e 91 b6 e2  47 a4 50 88 d9 04 cf 19  |u...^...G.P.....|
-00000100  06 a3 ca 09 0f 90 e7 01  23 dc d6 fa 6f 7b 03 9d  |........#...o{..|
-00000110  a3 5b a3 c1 df 06 54 14  fb e1 ee 1f 82 5d c6 ab  |.[....T......]..|
-00000120  aa 92 73 39 20 42 5c cd  fc 55 5f 5e 61 1b 46 27  |..s9 B\..U_^a.F'|
-00000130  d9 74 c3 d0 78 87 5c df  e1 3a 7f f1 f0 f6 d3 7d  |.t..x.\..:.....}|
-00000140  93 cd 2b b2 ac e8 50 13  1a be 35 13 2d 0a 7d 52  |..+...P...5.-.}R|
-00000150  f3 9e f9 ec 6b 50 a8 b8  77 43 1a ce 92 42 4e 3d  |....kP..wC...BN=|
-00000160  83 f3 5b 65 c8 e0 c1 f6  b9 88 eb b0 7e 33 da ca  |..[e........~3..|
-00000170  c6 bd 3e 07 53 d6 79 f1  79 38 ac f8 c7 ae aa c2  |..>.S.y.y8......|
-00000180  1f aa 6f 85 22 a6 89 f3  6e 62 6e 68 f5 98 d8 98  |..o."...nbnh....|
-00000190  33 2c e0 80 f9 32 95 40  16 95 10 b2 d6 61 e2 8f  |3,...2.@.....a..|
-000001a0  09 d6 9f b8 8c fc ff 40  a3 44 dc 46 a1 b9 5c 3b  |.......@.D.F..\;|
-000001b0  2e ce 1d de ee 76 ca 7a  f6 32 84 b8 0c 06 33 19  |.....v.z.2....3.|
-000001c0  ef 0a 41 f5 0b 35 a3 c0  c0 fd a5 4d cb 23 37 87  |..A..5.....M.#7.|
-000001d0  02 ac c3 71 42 5f f4 78  58 05 d7 41 ec 71 5c d6  |...qB_.xX..A.q\.|
-000001e0  4d 27 37 c3 3c bc 20 27  05 25 34 41 8d a5 af c4  |M'7.<. '.%4A....|
-000001f0  3c 09 cb 3d fc 76 2d 1b  81 88 8d c4 14 65 f5 50  |<..=.v-......e.P|
-00000200  8f 9f f5 18 74 19 87 6e  88 92 81 15 01 9f c3 a9  |....t..n........|
-00000210  dc 3c 46 13 f6 15 38 17  d5 f2 ee 14 f8 c5 1d 74  |.<F...8........t|
-00000220  10 e8 25 5b 51 02 c1 4c  b0 6c 05 a4 3b 60 ce 10  |..%[Q..L.l..;`..|
-00000230  50 bf 3a 1e 16 87 17 fa  db d9 47 e5 b0 08 6d d0  |P.:.......G...m.|
-00000240  45 f5 a4 3c 1b a6 81 c5  a1 1c 3d bc 39 dc 26 cb  |E..<......=.9.&.|
-00000250  1f cc 29 de f7 4c af 8c  9d 6d cc 2d 89 1a a8 83  |..)..L...m.-....|
-00000260  da 7c e6 32 ba 8d 42 8e  29 a0 93 63 1d 61 1b 53  |.|.2..B.)..c.a.S|
-00000270  e3 2b cb 17 5e a5 a8 3e  b2 a1 2c 45 e1 4f 72 cd  |.+..^..>..,E.Or.|
-00000280  83 90 04 3f 98 e9 5e 43  38 d1 78 fd 54 02 d2 91  |...?..^C8.x.T...|
-00000290  6d 0d e0 90 3d 8a bc 54  53 e4 57 b0 aa db d8 c5  |m...=..TS.W.....|
-000002a0  5f e8 95 0a 6f cb d8 9c  6e 75 00 43 3c 59 91 e8  |_...o...nu.C<Y..|
-000002b0  c9 05 56 6a 32 16 3c 98  af 86 c9 0d 0b 2c d0 95  |..Vj2.<......,..|
-000002c0  32 6e bd e2 60 8d 5a c8  57 77 ea 56 31 dc 3e e6  |2n..`.Z.Ww.V1.>.|
-000002d0  33 c1 de 7e f7 aa 64 d6  0a 3e ae 23 4c 91 24 34  |3..~..d..>.#L.$4|
-000002e0  39 15 5f 00 ac ea 02 1e  45 4f 61 37 b3 18 54 b1  |9._.....EOa7..T.|
-000002f0  26 71 fd 01 16 03 03 00  bc 31 a0 07 0d d9 f1 26  |&q.......1.....&|
-00000300  b3 1f 2d 13 cf ad 92 f6  20 08 3c ff 2f dd 2a 7d  |..-..... .<./.*}|
-00000310  16 5d 62 cb e2 f0 c9 56  ff 9e 3a ee c8 7b 69 d4  |.]b....V..:..{i.|
-00000320  d5 5d 30 41 9d 5c fc 3b  e1 b7 f4 74 d1 23 fa 10  |.]0A.\.;...t.#..|
-00000330  0b c5 68 3a 67 2e 3b 85  4a 21 bb b5 3c 22 f7 e2  |..h:g.;.J!..<"..|
-00000340  b3 dd 10 8e 23 fd f8 59  78 5c 54 40 ca ba 77 49  |....#..Yx\T@..wI|
-00000350  0f 24 72 3c eb 66 73 00  ce bd c5 a2 b8 f0 94 a4  |.$r<.fs.........|
-00000360  b8 c0 fb 64 c5 61 ba bd  db 17 1d 00 ca 1d ad 62  |...d.a.........b|
-00000370  e8 7e 5a e3 37 6f 79 8d  0b 64 4f a4 a4 6d d0 ce  |.~Z.7oy..dO..m..|
-00000380  44 66 e2 f4 48 ea e9 1a  99 d2 5f 48 11 06 75 fd  |Df..H....._H..u.|
-00000390  f3 db 52 02 72 0a 5a f6  ce 3f a8 19 10 83 fe d1  |..R.r.Z..?......|
-000003a0  7c 54 b3 cf 79 c8 52 78  ee 9d 96 da 8e ae 08 9f  ||T..y.Rx........|
-000003b0  8a 96 87 a6 d1 16 03 03  00 4a cc 16 c5 00 5d 97  |.........J....].|
-000003c0  18 cc d2 93 bd fe 20 12  7d f1 21 94 27 28 22 6d  |...... .}.!.'("m|
-000003d0  64 d4 8c ae 92 fa b0 9d  13 0c 8a d8 b1 e9 7b d2  |d.............{.|
-000003e0  5f b9 2c 5f a6 92 39 c6  e3 97 88 7f 62 0c 91 ab  |_.,_..9.....b...|
-000003f0  16 6c aa d4 26 10 9c 1d  fc 96 4b 0c 1e a8 4c 05  |.l..&.....K...L.|
-00000400  f6 87 41 08 16 03 03 00  14 cb 96 40 62 2b b5 2c  |..A........@b+.,|
-00000410  a2 1e 0a b8 37 4c 0c 98  44 80 d2 80 31           |....7L..D...1|
+00000000  16 03 03 00 81 21 a2 14  95 1e 02 74 1b aa c5 ec  |.....!.....t....|
+00000010  3f 9f 1a 88 67 00 8b 16  68 54 52 bb df f7 4c 75  |?...g...hTR...Lu|
+00000020  57 49 e3 00 1e b2 6f 61  67 eb ac 1e 77 31 bc e1  |WI....oag...w1..|
+00000030  66 a9 db 13 8b 43 d3 73  f9 57 97 1d 75 bd fc 78  |f....C.s.W..u..x|
+00000040  1b 0c 92 a4 66 95 d6 89  3d 86 63 a6 e8 15 5d d2  |....f...=.c...].|
+00000050  65 4c b5 2b f7 3d be 81  17 e6 23 64 65 26 68 b8  |eL.+.=....#de&h.|
+00000060  14 6b 68 24 78 19 84 a4  a1 82 d2 b6 6f d1 58 68  |.kh$x.......o.Xh|
+00000070  43 db 14 90 af 15 3c 8d  0c 5d b3 26 f3 14 7f cf  |C.....<..].&....|
+00000080  09 05 2a 2a 5d 21 16 03  03 02 69 f3 b0 da 24 57  |..**]!....i...$W|
+00000090  c9 6b 11 b6 67 20 2c 5f  64 53 ca a5 71 26 95 89  |.k..g ,_dS..q&..|
+000000a0  47 be 7d 27 dd a9 6e 8e  af 45 de 5d bd 37 8c 2b  |G.}'..n..E.].7.+|
+000000b0  b0 d8 d0 49 7e f1 cf 1c  47 a9 0f 5f fa 99 56 46  |...I~...G.._..VF|
+000000c0  a2 41 f7 f6 08 5f 97 6b  14 64 01 aa b2 f6 55 34  |.A..._.k.d....U4|
+000000d0  25 76 f3 ef 29 a3 cc 99  f5 06 ac 30 d1 00 db 36  |%v..)......0...6|
+000000e0  9b 41 c0 45 2e d4 bc b9  02 87 0f 0a 0e 2d 9d 56  |.A.E.........-.V|
+000000f0  df b8 94 8e 54 a8 6d 0a  8d b8 71 3c c0 76 0a 94  |....T.m...q<.v..|
+00000100  6d dc c6 5b 24 7e c5 48  25 67 15 44 2b 48 d0 cd  |m..[$~.H%g.D+H..|
+00000110  82 d8 c8 5e 0c 20 32 95  a9 f8 d5 31 cd f7 44 da  |...^. 2....1..D.|
+00000120  05 c4 cb e9 04 48 72 ac  ca 7b 26 e6 76 d2 01 18  |.....Hr..{&.v...|
+00000130  c0 34 88 29 7c 8c dc 35  e3 25 c9 11 f0 2b 1f 44  |.4.)|..5.%...+.D|
+00000140  d8 7d ea 1d 6a 57 b2 2c  52 8e 89 50 e3 e4 1c 51  |.}..jW.,R..P...Q|
+00000150  91 0c 6d fd 8d ad 91 77  b1 34 02 83 96 7e 39 5f  |..m....w.4...~9_|
+00000160  bc ed b1 05 3b f0 d3 f0  b3 05 54 e8 47 36 32 b1  |....;.....T.G62.|
+00000170  88 c9 31 7e d8 41 12 3b  55 25 b3 bc e3 9f a5 17  |..1~.A.;U%......|
+00000180  a8 45 21 68 e6 12 83 0e  80 13 d5 80 4d 89 0d fb  |.E!h........M...|
+00000190  9f 06 84 35 04 e8 0e bc  8c e7 17 83 7a 0f 68 34  |...5........z.h4|
+000001a0  ee db 10 78 31 85 34 e0  d8 f4 d2 3d fa 1c 18 49  |...x1.4....=...I|
+000001b0  25 c9 b9 53 ee b1 62 ff  13 77 36 8e 59 73 f7 9b  |%..S..b..w6.Ys..|
+000001c0  5f 4d 01 2d 41 dc 9e 2e  f7 f4 4c f7 27 eb e3 35  |_M.-A.....L.'..5|
+000001d0  91 41 b5 7f 28 eb 04 2c  f6 db 80 aa 3d 4e ac 2b  |.A..(..,....=N.+|
+000001e0  9d 95 c8 97 cf 35 f5 49  0d c7 b1 4f bf 41 eb 4a  |.....5.I...O.A.J|
+000001f0  9a a6 56 b8 8a 75 53 17  dc d4 ad ab 82 25 e8 0a  |..V..uS......%..|
+00000200  ae 8b c0 a3 8e 67 4b d1  96 04 45 1d c8 12 32 3f  |.....gK...E...2?|
+00000210  7e 4c 48 95 9f 24 8c 01  cf c3 78 10 d6 12 63 37  |~LH..$....x...c7|
+00000220  38 58 d3 31 97 25 9d 43  29 29 86 fb 9a 47 b5 c1  |8X.1.%.C))...G..|
+00000230  81 dc ab 4b be 57 bf 9f  0c 0b 28 fc 13 15 4e 2d  |...K.W....(...N-|
+00000240  58 97 78 3e 7f eb bf a1  cf a1 8d ab fe 3a 47 77  |X.x>.........:Gw|
+00000250  c1 fb b7 b8 82 42 37 95  60 20 be 91 26 ca 2c 48  |.....B7.` ..&.,H|
+00000260  44 57 6c 75 24 22 93 32  cf 83 f8 0c 75 b5 4a f1  |DWlu$".2....u.J.|
+00000270  88 d0 8e 1d 4e c7 93 1b  ba ea 14 04 38 f6 7a c2  |....N.......8.z.|
+00000280  d2 4b 7c 9c 1b 8b 31 6c  d8 09 88 6a 6d a1 61 d6  |.K|...1l...jm.a.|
+00000290  ee 80 ea 76 c0 d9 5a 49  31 3b dd 0f b5 5a a1 29  |...v..ZI1;...Z.)|
+000002a0  d4 ff db 68 48 96 26 e7  a7 82 10 e9 6e 5c c4 66  |...hH.&.....n\.f|
+000002b0  d5 e0 87 c3 66 d8 7c 4e  bf a5 31 0f fa 6e f6 21  |....f.|N..1..n.!|
+000002c0  4d fe ea f0 36 91 9e 18  81 c0 21 4f 77 eb 65 c0  |M...6.....!Ow.e.|
+000002d0  fe 84 45 22 dd 28 03 eb  e5 ce 15 62 e1 b8 9f 0e  |..E".(.....b....|
+000002e0  aa 9d bc 5c 38 41 01 74  17 d0 92 a5 80 e4 4b 58  |...\8A.t......KX|
+000002f0  42 bb 42 5d 16 03 03 00  bc 09 fb 78 c1 36 2e 27  |B.B].......x.6.'|
+00000300  b2 44 17 1a a8 2b f5 cd  98 78 a4 c1 1c f2 e7 53  |.D...+...x.....S|
+00000310  92 ef c1 88 83 78 37 23  08 f5 7f 5d 9f d1 c4 32  |.....x7#...]...2|
+00000320  df 01 c6 9c 3e a8 11 31  f4 77 69 94 d7 67 bc 62  |....>..1.wi..g.b|
+00000330  8e 18 57 0a cd d8 ba db  cd 2b e8 f9 37 77 16 13  |..W......+..7w..|
+00000340  be 18 53 2a 50 0b 0a d7  9a f0 7d 10 d3 13 bb 82  |..S*P.....}.....|
+00000350  36 5c aa d1 17 ad 83 69  47 7f 81 5c 36 53 81 e3  |6\.....iG..\6S..|
+00000360  1d 65 9f ac b2 3e 76 77  5a 6a 39 e5 df 92 55 e6  |.e...>vwZj9...U.|
+00000370  90 96 9c b9 54 ac 09 17  ce f5 43 9f 3e 1e 3a b6  |....T.....C.>.:.|
+00000380  cb 61 da 1a 3e e0 b4 51  30 3e 22 09 0b 05 a7 6e  |.a..>..Q0>"....n|
+00000390  5a df 82 d2 ab b9 d8 d2  37 a7 d7 b5 7f a9 ea 49  |Z.......7......I|
+000003a0  2f 64 57 33 5a 19 7f a3  2f 6a 7e 40 18 19 4a 61  |/dW3Z.../j~@..Ja|
+000003b0  05 92 35 8b 50 16 03 03  00 4a 50 1e e6 f4 47 dd  |..5.P....JP...G.|
+000003c0  fb 02 b4 22 71 e7 1e b1  51 28 9f 2d 40 64 2c 85  |..."q...Q(.-@d,.|
+000003d0  47 33 69 3e b0 e4 c7 eb  a6 31 13 76 45 39 e7 50  |G3i>.....1.vE9.P|
+000003e0  94 86 2e dd e1 58 f2 83  60 86 07 94 29 ce 69 12  |.....X..`...).i.|
+000003f0  0f 89 e3 89 2f 00 50 2b  56 ed 1d fe 25 55 9f 33  |..../.P+V...%U.3|
+00000400  3d 30 93 3c 16 03 03 00  14 0e 3f df b0 79 70 a7  |=0.<......?..yp.|
+00000410  08 bb 01 ff 08 44 69 65  49 81 9f e5 3a           |.....DieI...:|
 >>> Flow 9 (client to server)
-00000000  16 03 03 02 69 ef e6 70  d4 42 64 ba 8b 31 22 63  |....i..p.Bd..1"c|
-00000010  d6 66 0c 78 6f 43 80 ba  dd 30 41 74 78 25 0f b2  |.f.xoC...0Atx%..|
-00000020  b2 0f d4 d5 91 45 f3 a5  24 f0 da 2c 74 57 5c 81  |.....E..$..,tW\.|
-00000030  5b 77 96 5a b0 48 26 5e  06 24 e9 98 d7 a9 ce b0  |[w.Z.H&^.$......|
-00000040  b3 a3 f4 79 0e 28 e5 fa  96 e6 b7 2e 4a 7b d4 1a  |...y.(......J{..|
-00000050  96 eb d9 f7 98 07 f1 ac  88 08 20 42 2b 41 d8 f4  |.......... B+A..|
-00000060  96 2b 34 23 fb 26 e0 2b  fe 0e dd 36 a4 d5 aa 24  |.+4#.&.+...6...$|
-00000070  9b 3b 67 76 86 90 28 17  e2 22 cc 83 b8 72 5b 1d  |.;gv..(.."...r[.|
-00000080  d4 fa 81 33 68 db a4 43  76 57 39 3a b3 22 cb d6  |...3h..CvW9:."..|
-00000090  2e 31 07 6c b9 d6 ca 56  ca 56 67 ca 17 55 2d 49  |.1.l...V.Vg..U-I|
-000000a0  a6 42 de 7a 2c c1 cc 9f  af e8 88 5f 72 10 7c 56  |.B.z,......_r.|V|
-000000b0  bf 49 54 27 0c 39 e3 2e  57 c4 c3 8c 7e 10 2b e5  |.IT'.9..W...~.+.|
-000000c0  32 a9 ba 32 02 25 e6 02  e7 a2 06 87 16 07 47 e4  |2..2.%........G.|
-000000d0  4d 6b 95 5e a9 cd 5c dc  ab 4f ae a6 e7 59 60 cb  |Mk.^..\..O...Y`.|
-000000e0  23 d9 4b a0 15 ab 39 a9  ef 4b 74 54 4b e1 b8 69  |#.K...9..KtTK..i|
-000000f0  fe f3 f2 04 d5 df 3e 5b  1e 0f 64 6a b1 96 ec 82  |......>[..dj....|
-00000100  9c 8c 0b 90 c1 1f c1 f6  6e e6 9e cc 11 50 6f 3a  |........n....Po:|
-00000110  28 55 73 0b e3 42 89 eb  ea 38 5f 29 d4 88 41 18  |(Us..B...8_)..A.|
-00000120  45 8b f9 5d 2a 35 79 ba  39 a9 d5 7f 4d 7a d3 4e  |E..]*5y.9...Mz.N|
-00000130  25 59 10 30 9c 4a 24 af  96 63 e3 e6 cb 6e 7d ff  |%Y.0.J$..c...n}.|
-00000140  a2 4b 69 30 76 9c 35 19  74 29 b6 ad e7 15 01 7d  |.Ki0v.5.t).....}|
-00000150  e8 04 9e 00 4e d6 0d 51  3f ed a9 5e e9 b9 5f a3  |....N..Q?..^.._.|
-00000160  6e 6c 65 f8 7f ec 6f 5d  c5 94 48 44 dd 02 e9 76  |nle...o]..HD...v|
-00000170  cb b2 d2 66 f8 95 6f 69  11 e3 0b a8 96 d3 ac 9b  |...f..oi........|
-00000180  d3 55 48 61 ff 80 69 a3  09 c4 5c b9 fa fd 74 7b  |.UHa..i...\...t{|
-00000190  4e 10 b0 09 05 4b 6c 75  59 7f 19 ba c2 d5 85 7e  |N....KluY......~|
-000001a0  18 ff 08 88 76 d4 1e 2e  b4 56 23 95 6c 22 68 1e  |....v....V#.l"h.|
-000001b0  42 e2 5d 3a ff 84 b9 05  c2 d0 6c c6 aa ee e7 e6  |B.]:......l.....|
-000001c0  59 07 16 9c a4 3c 8a 47  b1 98 05 8e 65 95 11 fb  |Y....<.G....e...|
-000001d0  b6 7b 9b 66 c1 53 c2 7e  3a 3e 0c 22 75 ea f0 2b  |.{.f.S.~:>."u..+|
-000001e0  31 25 16 b1 90 0a 42 e6  c5 4e 46 08 fc d7 65 bb  |1%....B..NF...e.|
-000001f0  ca a1 e4 ad 6d b5 4c 74  c5 30 85 d5 58 04 d7 1c  |....m.Lt.0..X...|
-00000200  9e 57 d3 ec 99 03 1c 0d  f9 98 ae 76 60 4e 97 67  |.W.........v`N.g|
-00000210  10 a0 e9 94 84 05 7c af  a9 61 9f bb de 9f bd 66  |......|..a.....f|
-00000220  0a b2 6d 6a 07 c8 40 78  14 93 24 2d 4a 77 e4 13  |..mj..@x..$-Jw..|
-00000230  4a db 6f ae c2 78 5e 59  ac f9 3d 1c 8b 3b ff 14  |J.o..x^Y..=..;..|
-00000240  1b fd 05 e6 f8 31 be 63  70 4c f2 ef d0 17 a6 66  |.....1.cpL.....f|
-00000250  42 3a 94 3b 4a a6 26 49  b4 18 6d 9e b5 07 8a 49  |B:.;J.&I..m....I|
-00000260  a1 72 44 25 27 46 12 e0  61 06 4d eb b2 f5 16 03  |.rD%'F..a.M.....|
-00000270  03 00 35 9e fc 71 56 3c  cc c8 d6 2b a6 b1 cb 2b  |..5..qV<...+...+|
-00000280  c8 a2 5c 2b 49 95 52 2a  91 62 74 ba 95 9d 67 f3  |..\+I.R*.bt...g.|
-00000290  2a 2c 55 1d 81 83 0d b1  25 3f ff cd 75 16 e6 83  |*,U.....%?..u...|
-000002a0  a5 bc a7 8b 4d 31 32 d5  16 03 03 00 98 98 ea f6  |....M12.........|
-000002b0  4a 46 17 cb 01 d9 33 74  ec 49 78 b1 5b c5 c0 d3  |JF....3t.Ix.[...|
-000002c0  71 82 5c 80 1e 59 4f da  5d 2d 54 78 0c 60 35 26  |q.\..YO.]-Tx.`5&|
-000002d0  29 da 64 29 02 39 84 d0  3b 0b 0d 8d 84 2e 25 fc  |).d).9..;.....%.|
-000002e0  e7 2c d1 33 ae bb fa 6f  d2 87 54 b3 f2 d5 21 69  |.,.3...o..T...!i|
-000002f0  2a 69 43 15 48 2a 5e e8  66 f8 1d 49 28 51 14 97  |*iC.H*^.f..I(Q..|
-00000300  01 1b 31 de 22 7c a7 1c  15 19 21 36 35 92 ca e6  |..1."|....!65...|
-00000310  d3 f0 2d af 0d 8e c1 16  c2 a4 ef e9 4f 97 c3 ad  |..-.........O...|
-00000320  59 0d 98 c6 d2 31 38 d5  34 e0 f3 80 6c 86 f9 bd  |Y....18.4...l...|
-00000330  84 16 c1 4e d7 2a 89 26  20 46 f4 54 b2 c7 69 0e  |...N.*.& F.T..i.|
-00000340  72 56 9b 35 4b 14 03 03  00 11 98 7b 9f 6f c5 62  |rV.5K......{.o.b|
-00000350  1e 2e f6 8a 10 5a ea b7  72 ef 02 16 03 03 00 20  |.....Z..r...... |
-00000360  9c 56 e6 cb ee 7a 86 0f  f0 47 6a d6 04 c4 41 c9  |.V...z...Gj...A.|
-00000370  36 2f 4d 5d 4b e9 54 22  9d 0f 07 a3 36 8e 83 b8  |6/M]K.T"....6...|
+00000000  16 03 03 02 69 b8 47 2d  3a 7a e4 d0 2b 45 b2 38  |....i.G-:z..+E.8|
+00000010  1e 6f 8d 3d e1 26 91 92  d7 1f e9 a4 2c d8 30 2c  |.o.=.&......,.0,|
+00000020  ce 68 50 e7 80 77 63 e1  bd c7 c8 1b 6f ca b0 bf  |.hP..wc.....o...|
+00000030  82 1d 75 85 2c 5d b2 f6  9a f2 b6 9b c4 24 54 86  |..u.,].......$T.|
+00000040  b8 fb dc ae 09 25 c4 42  fc 4d f2 18 5b a3 92 31  |.....%.B.M..[..1|
+00000050  8a 78 1f 1a 74 d4 43 0b  24 2f 14 2b 0e 05 3a 8d  |.x..t.C.$/.+..:.|
+00000060  7a 1c 21 2f cd 7b 9d 6c  32 b1 f6 14 fa 9d f5 be  |z.!/.{.l2.......|
+00000070  9c f1 8e 75 b9 27 82 ba  e7 fc 14 39 2a 6f 3e 59  |...u.'.....9*o>Y|
+00000080  d6 bc 6c 3f f1 33 5e fa  bb 07 bc e4 0b 7e 4a 5d  |..l?.3^......~J]|
+00000090  2b e8 9b d5 00 d2 cc 8f  94 01 82 0e bb 28 f9 d2  |+............(..|
+000000a0  1f ee 0c ff 9c 4d 37 5b  23 5b 23 a5 39 fe cd 2b  |.....M7[#[#.9..+|
+000000b0  ef 30 46 b7 c1 0e a3 fc  fd f6 1b d3 78 fb d9 93  |.0F.........x...|
+000000c0  3a 52 fe 91 dc 42 63 85  09 64 63 3a 9d 9f 21 74  |:R...Bc..dc:..!t|
+000000d0  c6 d9 e4 b5 cc ef 94 96  0f c1 d0 45 f6 e6 b9 32  |...........E...2|
+000000e0  01 74 88 24 bb d9 d6 25  23 14 de 25 f4 7e 9c 77  |.t.$...%#..%.~.w|
+000000f0  82 83 7e 59 dc c3 f7 d9  e4 b1 95 e0 bb 6e 66 e4  |..~Y.........nf.|
+00000100  bd cb a2 72 a0 63 d4 39  9f 57 a7 d1 88 7a 59 64  |...r.c.9.W...zYd|
+00000110  38 45 bb fc 5a 02 81 4c  2e e5 e4 1c 7d e9 e8 f0  |8E..Z..L....}...|
+00000120  e1 b7 88 f5 a6 ee d0 b7  e5 2f 9e 15 d5 76 8d f7  |........./...v..|
+00000130  68 0f 7b 6a 48 e7 19 3a  bc ef f5 fc 72 a4 62 ce  |h.{jH..:....r.b.|
+00000140  a6 66 e5 e8 74 03 c0 4d  b4 14 e4 0c 36 fd 99 0b  |.f..t..M....6...|
+00000150  0e 4f b6 5e 4c db dc 51  fe ae e9 07 37 92 6c 35  |.O.^L..Q....7.l5|
+00000160  f7 99 6c b9 36 c2 b9 7c  5e ef 72 c1 1f ba fb 18  |..l.6..|^.r.....|
+00000170  57 24 f2 d4 21 cf 46 bd  71 3d 62 63 ba 1c 0f 8b  |W$..!.F.q=bc....|
+00000180  f4 a6 fc ea 27 de 48 b8  ed e3 6e 4b 30 66 fa 1e  |....'.H...nK0f..|
+00000190  22 7b 49 e2 03 96 8a 6a  3c 6a 1a 62 81 cc 06 dd  |"{I....j<j.b....|
+000001a0  a7 6b dd 3c 1b 39 e3 36  5a 8c ec 22 71 35 af fc  |.k.<.9.6Z.."q5..|
+000001b0  74 11 68 2f bd 9a 61 57  39 1a e7 c5 df 62 45 fc  |t.h/..aW9....bE.|
+000001c0  b5 84 f0 b8 6a 63 6f dd  16 24 74 4d 81 34 3e 4c  |....jco..$tM.4>L|
+000001d0  e7 b9 9f 90 aa 1f 39 13  e2 4b 8c ff b5 13 d1 d2  |......9..K......|
+000001e0  cd ac ce 8c 2b bc b3 b3  fc f7 37 db 61 8f 6b 90  |....+.....7.a.k.|
+000001f0  c2 bc 6e e3 8e fa d9 16  ab 62 c7 3f d7 e1 0b a8  |..n......b.?....|
+00000200  2b 8a 0d b6 2c 90 dc 6e  b4 44 e0 13 32 fb 80 23  |+...,..n.D..2..#|
+00000210  a9 e4 18 ea 8d c7 8a 14  0a 82 8d 3b 21 88 bf bf  |...........;!...|
+00000220  ff 10 3c 08 6b 65 70 4c  b5 88 7d 9c 92 43 15 55  |..<.kepL..}..C.U|
+00000230  18 e9 cf 15 5d 55 3a f0  a1 46 ca d4 9e f3 c0 16  |....]U:..F......|
+00000240  4b ee f6 17 95 e0 af 1e  85 54 62 dd 56 88 6b e1  |K........Tb.V.k.|
+00000250  29 ac f9 4f dc 5c 89 16  19 6b 21 c9 6c c8 1e 1d  |)..O.\...k!.l...|
+00000260  89 7c cc a4 9b 1f c8 ce  67 c6 83 79 6a d6 16 03  |.|......g..yj...|
+00000270  03 00 35 6f 33 7d 96 3c  8d 66 a5 d1 7a 8b bc fa  |..5o3}.<.f..z...|
+00000280  ca f0 89 9d 2b 37 0c f5  aa 14 07 f2 58 be d1 d3  |....+7......X...|
+00000290  ec 73 dd b6 33 e2 df 46  1a d3 ee e8 26 d9 be 2b  |.s..3..F....&..+|
+000002a0  43 25 3b e2 78 72 10 43  16 03 03 00 98 18 03 96  |C%;.xr.C........|
+000002b0  9c eb 31 50 72 15 0e 9b  ff c7 6b b0 60 32 08 c6  |..1Pr.....k.`2..|
+000002c0  ef 70 f9 0c 22 4a a2 0f  77 31 b3 ea d0 12 65 af  |.p.."J..w1....e.|
+000002d0  c9 28 0f f9 5b b7 f3 75  9c 5a 6e df a1 6a e6 d5  |.(..[..u.Zn..j..|
+000002e0  82 0b 18 05 94 aa dd 93  e5 1d 60 06 47 f5 3e b1  |..........`.G.>.|
+000002f0  d5 e8 e7 b7 9f 43 bf 4b  8a 5e 48 3b f1 42 f6 c0  |.....C.K.^H;.B..|
+00000300  c3 65 86 e2 bc 7a 75 1d  93 cf 7f 3d 11 d3 85 c3  |.e...zu....=....|
+00000310  c3 90 90 0b 77 e1 d7 64  da 71 3c 55 de 7c b9 71  |....w..d.q<U.|.q|
+00000320  ea d9 7a ae a6 dd 7e e0  a4 2e 88 89 79 2c 40 dc  |..z...~.....y,@.|
+00000330  dd 95 b0 04 6a 76 90 70  2b c7 42 b0 2e 04 79 0c  |....jv.p+.B...y.|
+00000340  4e cb ca f0 81 14 03 03  00 11 29 9f c8 82 93 26  |N.........)....&|
+00000350  07 ce a1 23 50 1a 75 38  36 e0 92 16 03 03 00 20  |...#P.u86...... |
+00000360  75 41 82 00 9b 89 29 9b  59 2f 45 01 3e a9 ae c6  |uA....).Y/E.>...|
+00000370  f8 7e fd 4d bd 3b 0e bc  9b 74 27 09 33 c3 27 2a  |.~.M.;...t'.3.'*|
 >>> Flow 10 (server to client)
-00000000  14 03 03 00 11 6b bf 22  ed c6 d9 79 48 3b 35 2a  |.....k."...yH;5*|
-00000010  ca 29 40 05 ad fa 16 03  03 00 20 d1 2c 33 a1 63  |.)@....... .,3.c|
-00000020  c5 96 c5 ec c8 c5 cc 94  f7 92 a3 ed 3f e0 4a ab  |............?.J.|
-00000030  28 96 18 3c c1 a8 3a 03  fc ee f6 17 03 03 00 19  |(..<..:.........|
-00000040  39 e5 80 33 cc a5 f8 3a  e4 13 b5 b7 e0 1d 19 5e  |9..3...:.......^|
-00000050  82 b4 94 fd cd 6c a5 06  e2                       |.....l...|
+00000000  14 03 03 00 11 3d 29 da  dc b6 5a 09 66 34 6e 00  |.....=)...Z.f4n.|
+00000010  65 8c 29 d2 18 bd 16 03  03 00 20 63 55 d1 84 7d  |e.)....... cU..}|
+00000020  3e cc 2d f5 d3 48 c2 5c  72 d8 6b cf 69 b4 ed 5f  |>.-..H.\r.k.i.._|
+00000030  07 96 53 13 1e 53 59 18  c1 bb c7 17 03 03 00 19  |..S..SY.........|
+00000040  30 5b 6d d2 26 db ef c1  a9 00 e6 ce 87 86 9b 71  |0[m.&..........q|
+00000050  dd fb aa 79 aa b6 39 1e  70                       |...y..9.p|
 >>> Flow 11 (client to server)
-00000000  15 03 03 00 12 60 9a 8c  98 6e 55 b1 3e db b4 22  |.....`...nU.>.."|
-00000010  3c d9 51 43 36 88 eb                              |<.QC6..|
+00000000  15 03 03 00 12 32 8f cd  ef b8 3e 96 01 07 ca 0b  |.....2....>.....|
+00000010  83 21 83 97 78 25 64                              |.!..x%d|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice
index 4967e0fa41..983174f5ec 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice
@@ -16,11 +16,11 @@
 000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 1e 7a 8b a7 bd  |....Y...U...z...|
-00000010  bd 98 42 b7 80 8f d3 a5  1c b8 36 4b e3 4c d4 87  |..B.......6K.L..|
-00000020  e1 13 93 bb 9f 70 1b 21  22 15 fa 20 64 89 5b 25  |.....p.!".. d.[%|
-00000030  cb 8e 05 53 0b a4 b5 06  49 46 83 7d 8b 13 b1 e4  |...S....IF.}....|
-00000040  47 d0 21 91 fe 20 0a e2  dc 29 71 ce cc a8 00 00  |G.!.. ...)q.....|
+00000000  16 03 03 00 59 02 00 00  55 03 03 34 8b db 6b 9e  |....Y...U..4..k.|
+00000010  68 c3 92 09 72 4f 02 6c  b9 7a ac 74 72 0b 32 01  |h...rO.l.z.tr.2.|
+00000020  f4 86 9e b5 53 db da 96  c2 65 2a 20 8f 89 24 79  |....S....e* ..$y|
+00000030  8a a5 38 7a 52 68 7a a9  cc d0 5a 04 4d ce 87 0e  |..8zRhz...Z.M...|
+00000040  64 48 51 e0 00 cb 60 f0  b4 e9 99 27 cc a8 00 00  |dHQ...`....'....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -60,284 +60,284 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 db 69 f9 f0 59 b6 50  |........ .i..Y.P|
-000002d0  b8 fe a7 d0 df fa 32 b9  df 3b 31 8e 3f fb ee 82  |......2..;1.?...|
-000002e0  2e e3 e6 42 c2 61 78 ee  77 08 04 00 80 9c f6 b1  |...B.ax.w.......|
-000002f0  60 99 fe 8d 65 0a 87 0f  ec d2 35 bc 7c 26 3c 1f  |`...e.....5.|&<.|
-00000300  55 3d 6d 6c 8a 64 5b a7  95 fa cc e0 a6 9b 36 bd  |U=ml.d[.......6.|
-00000310  1e 0f 8e bc 36 d5 28 e8  ae 2e 34 97 f6 be 87 ce  |....6.(...4.....|
-00000320  c5 1b 91 7f 5a 22 db 9a  d0 cd cb 47 ac 2e 06 2f  |....Z".....G.../|
-00000330  9d f1 fe 35 c1 88 db 8e  d3 3c 8b 6f a3 38 b6 e3  |...5.....<.o.8..|
-00000340  99 42 be 6c bd b4 66 43  00 59 04 0e 6c e1 89 dc  |.B.l..fC.Y..l...|
-00000350  6f 05 6f 32 f6 aa 2b 55  3b 95 95 0f fe a4 55 18  |o.o2..+U;.....U.|
-00000360  d3 71 3c fb 33 f6 ae 15  74 4b 33 bb a3 16 03 03  |.q<.3...tK3.....|
+000002c0  ac 0c 00 00 a8 03 00 1d  20 63 06 67 5c 4e da 3f  |........ c.g\N.?|
+000002d0  0a 02 78 46 92 fe 8f ed  41 ac 1a d5 04 e6 ca 4a  |..xF....A......J|
+000002e0  7e 9c d0 32 e8 ee f3 9c  5d 08 04 00 80 c0 51 ba  |~..2....].....Q.|
+000002f0  71 28 00 53 c6 40 63 20  d4 bd 52 60 d2 f6 e2 57  |q(.S.@c ..R`...W|
+00000300  ba 6f a8 bf 42 2a 11 b5  9a eb 9f b6 53 77 87 72  |.o..B*......Sw.r|
+00000310  ea 7d bf f8 f4 cf 1d 76  6c 03 75 9d df 88 b1 13  |.}.....vl.u.....|
+00000320  66 5c 43 41 1e 97 52 32  86 d0 22 3c f6 ca 90 a5  |f\CA..R2.."<....|
+00000330  ba cf 75 94 1f 22 93 c0  0c c9 82 a5 eb d2 07 85  |..u.."..........|
+00000340  a0 39 9e 5d fa 88 1f 62  25 09 c3 97 c1 1d 4e a2  |.9.]...b%.....N.|
+00000350  fe 98 96 b8 c0 eb b9 18  07 2d e1 cf 9b fd 25 ba  |.........-....%.|
+00000360  93 fb 73 e5 7e 36 27 b3  11 00 58 95 f8 16 03 03  |..s.~6'...X.....|
 00000370  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 3e 7f d0  53 7f 67 81 82 2d 8b fd  |.... >..S.g..-..|
-00000040  68 ce ea 38 c5 3d 1f a1  0d 72 0b ac de e0 99 9c  |h..8.=...r......|
-00000050  0e d8 4f 5c 2e                                    |..O\.|
+00000030  16 03 03 00 20 02 50 f6  74 83 31 96 36 c1 22 99  |.... .P.t.1.6.".|
+00000040  1d d7 99 b2 8c 2b 04 3a  bd 3e 19 e5 ef 71 dc 72  |.....+.:.>...q.r|
+00000050  b2 0d c8 d1 3f                                    |....?|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 18 e0 d3 a6 d4  |.......... .....|
-00000010  bf cd b7 b7 6c 98 53 9d  75 bb c8 ee 29 28 6c d6  |....l.S.u...)(l.|
-00000020  4b 96 66 fb 2c 99 bc aa  3f aa 86                 |K.f.,...?..|
+00000000  14 03 03 00 01 01 16 03  03 00 20 9b a3 02 3e 55  |.......... ...>U|
+00000010  4a e6 4c 7f 9a a6 a2 65  bd 74 ff ad c5 ce 43 21  |J.L....e.t....C!|
+00000020  d3 b1 d1 89 0c 15 7d 7d  a7 d8 4c                 |......}}..L|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 72 e6 81  87 6e 2d d9 76 10 8b 7d  |.....r...n-.v..}|
-00000010  7b e4 ee ee 31 bb d5 6a  be 69 29                 |{...1..j.i)|
+00000000  17 03 03 00 16 4c 5e 0a  69 e1 e8 fc 52 f0 3d ea  |.....L^.i...R.=.|
+00000010  33 f5 02 6b 47 49 cd a5  b5 94 4e                 |3..kGI....N|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 14 c5 9f 94  4a 11 1b 2f c3 ad 90 d5  |........J../....|
-00000010  5e b5 7a 87 f1 19 33 11  52                       |^.z...3.R|
+00000000  16 03 03 00 14 6a 8d 46  e1 33 c6 63 9d 27 3e e8  |.....j.F.3.c.'>.|
+00000010  7f 31 74 7f 4f 60 b3 f7  aa                       |.1t.O`...|
 >>> Flow 7 (client to server)
-00000000  16 03 03 01 16 f9 ea fe  74 a7 a0 8c 3d a8 7f 61  |........t...=..a|
-00000010  a7 f6 7a de 4d 36 32 d0  be 7b 0b df 80 65 62 06  |..z.M62..{...eb.|
-00000020  d2 1d ce 1a f2 83 c7 0a  a3 c5 eb 37 b1 60 0c 0c  |...........7.`..|
-00000030  47 9f fd 66 61 4b 5d 55  cc 13 0b 50 77 5a 31 68  |G..faK]U...PwZ1h|
-00000040  75 94 d5 a6 ec 61 07 a2  45 f7 d6 73 af 7b ea 2d  |u....a..E..s.{.-|
-00000050  9f bd cd 08 d2 4b f8 24  27 8e 5a 24 a6 cb ed 01  |.....K.$'.Z$....|
-00000060  6d ef fc 2f ff f9 2d 23  d1 64 6b a4 d2 8c cc ff  |m../..-#.dk.....|
-00000070  55 28 cc 79 21 86 6a e9  c9 d3 c3 38 b0 ee 37 18  |U(.y!.j....8..7.|
-00000080  1b 9c 87 e2 70 42 8e e9  72 37 79 09 4c f1 e2 74  |....pB..r7y.L..t|
-00000090  ef 11 c1 ad 7b e2 b4 f1  57 19 08 51 80 f1 9f 9a  |....{...W..Q....|
-000000a0  84 40 00 61 4f 77 8a 02  69 35 44 f9 b0 a6 94 0f  |.@.aOw..i5D.....|
-000000b0  d2 a0 77 78 c8 ab cb b1  3f 81 2f f7 20 7b f1 af  |..wx....?./. {..|
-000000c0  ad c8 9a 15 77 09 3a 21  68 da c5 29 e9 3a 9e 83  |....w.:!h..).:..|
-000000d0  9d 25 c7 29 3c 02 48 71  3d be e6 a4 13 d9 1b 5a  |.%.)<.Hq=......Z|
-000000e0  79 50 00 7a 3b 29 6c b6  4e 59 0a ff e3 1c 69 65  |yP.z;)l.NY....ie|
-000000f0  f7 a9 c8 eb 74 74 05 a4  10 c3 9f 47 11 0a 4e 2c  |....tt.....G..N,|
-00000100  75 dd 31 1d 85 6c c9 2b  95 3e 61 20 61 78 d9 68  |u.1..l.+.>a ax.h|
-00000110  5b 52 b1 a1 08 70 a7 e4  89 fa 32                 |[R...p....2|
+00000000  16 03 03 01 16 6f 4d 64  ff 20 fa 1c 19 26 bc 99  |.....oMd. ...&..|
+00000010  ec 09 be e7 6d 88 73 1e  4f c6 74 35 f7 5c b3 e5  |....m.s.O.t5.\..|
+00000020  f6 d1 2a 90 7f c3 34 dc  83 6b a9 f1 32 01 a1 84  |..*...4..k..2...|
+00000030  0c 4c 06 db 88 d4 19 31  d2 46 1f 2c 3d 13 75 5b  |.L.....1.F.,=.u[|
+00000040  f3 e5 d0 b7 a8 4f 2c b2  89 35 78 82 78 b7 f5 c6  |.....O,..5x.x...|
+00000050  ea a2 1d f3 24 9d e2 01  25 e2 96 a1 06 57 5c 50  |....$...%....W\P|
+00000060  d6 5b 56 24 18 6e b4 ce  6a 2e c7 01 65 99 3f 35  |.[V$.n..j...e.?5|
+00000070  c1 07 48 75 ad 0b 1a b3  58 df 83 42 f8 78 eb 92  |..Hu....X..B.x..|
+00000080  e8 70 c9 34 af db e8 d6  b0 c8 37 ac b2 d7 18 ba  |.p.4......7.....|
+00000090  a3 1d 35 09 2e 2f 82 e0  3a 68 fd 7f ba 4d 5c 5c  |..5../..:h...M\\|
+000000a0  6c 6d ac 24 60 bf e0 37  a9 17 8d 6d 8a 69 96 23  |lm.$`..7...m.i.#|
+000000b0  4f c7 53 a0 48 65 58 cc  01 03 df 33 36 5a 8a 7e  |O.S.HeX....36Z.~|
+000000c0  3f 84 33 26 3f 02 66 48  82 22 22 b7 7d 62 7e 56  |?.3&?.fH."".}b~V|
+000000d0  94 df 43 df 08 fc 70 f6  bb 1a dd 19 b1 ea ea a2  |..C...p.........|
+000000e0  6f 36 ab b0 d2 77 e6 c8  f6 70 a6 a6 a3 0d ab c8  |o6...w...p......|
+000000f0  dc d1 9b a2 05 43 44 0c  17 8d 47 86 55 77 56 34  |.....CD...G.UwV4|
+00000100  d7 71 2c 75 9a d4 70 e4  77 5e 1a b7 b1 13 ae 14  |.q,u..p.w^......|
+00000110  d0 99 a0 9e 50 9c 35 94  4d 34 e5                 |....P.5.M4.|
 >>> Flow 8 (server to client)
-00000000  16 03 03 00 81 25 5a 30  ca 7c f0 f5 7f c4 5f e3  |.....%Z0.|...._.|
-00000010  19 4d 25 ea 3d f8 b3 3f  8d e4 89 da db 4e 19 62  |.M%.=..?.....N.b|
-00000020  d2 4e 9a a5 5d c6 84 f2  70 f3 b5 10 cb 57 f5 9e  |.N..]...p....W..|
-00000030  83 a4 78 14 86 3c 27 f5  08 bd c0 59 ab ac 3c 5f  |..x..<'....Y..<_|
-00000040  8c d7 23 9b c1 9f f4 ad  c5 5c 3c 3d bd f4 82 42  |..#......\<=...B|
-00000050  58 b8 bf 69 9a 13 2a f6  2d 18 0b df a4 02 74 7d  |X..i..*.-.....t}|
-00000060  99 69 aa a7 18 e5 2c f1  1e b4 f7 31 96 0f a3 d8  |.i....,....1....|
-00000070  63 09 b9 eb c9 15 c1 61  de 8a 8c 30 a6 3a 1f 0f  |c......a...0.:..|
-00000080  31 06 73 cb 81 57 16 03  03 02 69 b7 45 9e a0 f1  |1.s..W....i.E...|
-00000090  46 f5 05 fc 58 a3 cc 88  38 a4 80 e9 1c 31 bb 84  |F...X...8....1..|
-000000a0  b1 d2 cb 22 5e 47 cd 97  f5 21 b6 7e df 0a ca ef  |..."^G...!.~....|
-000000b0  42 71 2f b6 92 c0 44 a9  2f 36 a9 92 9e 23 2f 6a  |Bq/...D./6...#/j|
-000000c0  7a 2b 70 5b 8d 2e 53 e9  2b ac 39 22 54 e9 e2 82  |z+p[..S.+.9"T...|
-000000d0  8e 41 7c 40 c9 97 12 ac  c9 91 2d 4d 9b e3 ce 1a  |.A|@......-M....|
-000000e0  c2 57 d7 e5 89 56 56 52  17 d1 99 99 e0 21 fb f3  |.W...VVR.....!..|
-000000f0  94 1c fd 4a 8f 17 00 61  24 1e 86 cc a9 9a d2 75  |...J...a$......u|
-00000100  32 b7 44 f4 7b ed 37 46  d3 fb cf 98 0e dd 47 a9  |2.D.{.7F......G.|
-00000110  69 f9 ff 34 76 d8 6c 94  7b 97 18 dc 87 25 a0 97  |i..4v.l.{....%..|
-00000120  38 d3 df 22 4f 0e b7 c7  91 64 9a d4 04 f4 35 a3  |8.."O....d....5.|
-00000130  89 28 e9 04 8e fe ed 8c  3c 9d 18 7e e3 14 2e 4e  |.(......<..~...N|
-00000140  86 b4 3a 5c 33 f3 27 2c  08 27 91 9a 62 72 c8 98  |..:\3.',.'..br..|
-00000150  56 60 1c e6 5e 80 75 56  89 cd 0f 4d 55 1a 52 7d  |V`..^.uV...MU.R}|
-00000160  39 05 cb e2 5d 33 64 67  4d 3d 90 c6 f2 86 62 ff  |9...]3dgM=....b.|
-00000170  7f 29 ae fe 49 49 53 6e  4d b9 78 54 ee a6 d7 60  |.)..IISnM.xT...`|
-00000180  55 a8 f1 4b 8a 51 6f 09  f2 84 84 89 4b 36 9e 56  |U..K.Qo.....K6.V|
-00000190  32 28 71 c8 ec 92 f8 31  c5 af d0 4d 84 0a 1d 37  |2(q....1...M...7|
-000001a0  72 ab cf fe ce 02 7c 41  5b f9 44 9c 04 cf 7e 38  |r.....|A[.D...~8|
-000001b0  09 5b ce c5 11 ff db df  05 2e c9 66 be 60 cb 5f  |.[.........f.`._|
-000001c0  e3 ef 88 04 b6 38 a3 5f  58 cc ea bc 6c 83 52 68  |.....8._X...l.Rh|
-000001d0  39 ec 88 ca da 49 32 48  6b 5f 93 7d d8 5d 91 e5  |9....I2Hk_.}.]..|
-000001e0  4f b4 b5 47 fd 7d 46 82  fd 82 78 14 7a ca d5 e2  |O..G.}F...x.z...|
-000001f0  ec 12 09 b4 bd 85 d8 50  03 f6 d1 a7 18 29 ca df  |.......P.....)..|
-00000200  47 27 41 f7 0b 4c 36 b9  69 b0 71 2c c0 7a 6a 8b  |G'A..L6.i.q,.zj.|
-00000210  4d 2b 69 02 21 69 f3 38  77 ce ab c6 1c 15 22 f1  |M+i.!i.8w.....".|
-00000220  3a 0e b3 5e 2e e5 e5 d5  68 1f b9 60 35 f9 f3 c2  |:..^....h..`5...|
-00000230  3d ba 83 39 4f 90 9a ab  7f a1 5b 15 44 e6 b6 0a  |=..9O.....[.D...|
-00000240  7f e4 4e 5b 5d 97 98 b0  9e 9e 6f b5 c8 2e 8d 0b  |..N[].....o.....|
-00000250  0c 87 8a fb a7 39 89 9a  c9 5b 3e bf 3d 63 da a3  |.....9...[>.=c..|
-00000260  0f 1c 92 41 c4 c9 95 b5  e1 2b 37 62 b9 f3 95 ba  |...A.....+7b....|
-00000270  e5 9c 5e 39 82 5f 7d a9  2b 74 c2 a7 46 64 0f 31  |..^9._}.+t..Fd.1|
-00000280  4d 68 d3 05 1f 58 2d 11  c0 2e e2 a9 c2 cb 81 06  |Mh...X-.........|
-00000290  0b 77 34 0e af 3e 35 8e  1d 00 40 8e ca b5 02 e8  |.w4..>5...@.....|
-000002a0  10 f8 82 36 ae 70 82 74  65 97 b2 91 3f 2e d0 23  |...6.p.te...?..#|
-000002b0  40 ef bf d9 d9 1a 7d 4a  d0 c1 8b 4a 54 8c 41 22  |@.....}J...JT.A"|
-000002c0  07 63 34 bc fb fb 0d e4  9c e2 43 77 13 94 ed 74  |.c4.......Cw...t|
-000002d0  8a ac 4a 17 b6 eb 7e 8c  dd 82 14 fa 45 a9 ef 1c  |..J...~.....E...|
-000002e0  01 f7 86 18 c2 a8 33 ab  21 36 4c 6c ac 41 aa b1  |......3.!6Ll.A..|
-000002f0  f7 56 48 68 16 03 03 00  bc ab b6 6e 14 2e 1c 47  |.VHh.......n...G|
-00000300  90 fa 6f 63 4d 2f 1a 23  48 6f 1d 45 7d 07 e3 06  |..ocM/.#Ho.E}...|
-00000310  67 ec b2 b1 74 2e 1e 60  9f 36 5e a6 1c a4 b8 60  |g...t..`.6^....`|
-00000320  70 bf 31 68 c0 d5 16 da  6c 44 ce 9c 88 12 84 ef  |p.1h....lD......|
-00000330  8f 8b ee cc 0d 5b df f0  87 9e 8f 79 e3 e5 b7 cd  |.....[.....y....|
-00000340  d0 ab 56 68 5d cb 9b b1  66 f3 c3 d4 b8 72 2b 0d  |..Vh]...f....r+.|
-00000350  ae 4a 2b ea f7 40 6c 94  95 56 1f d4 0b e5 d0 6b  |.J+..@l..V.....k|
-00000360  8a 3d 11 10 57 1a c4 ad  d0 9e 24 a9 77 fb 75 48  |.=..W.....$.w.uH|
-00000370  3c 60 19 af 0c 0b 36 43  7d c2 d0 98 14 03 a5 02  |<`....6C}.......|
-00000380  36 79 bc 18 da b9 d9 3a  82 1c 9f 49 62 a4 aa cc  |6y.....:...Ib...|
-00000390  eb a3 88 ec e4 1c df a9  00 00 6e a0 d6 18 a7 da  |..........n.....|
-000003a0  4b d7 e2 d2 c8 8d d9 ce  45 d5 82 65 bc 82 6d d0  |K.......E..e..m.|
-000003b0  26 1b 06 7e eb 16 03 03  00 4a 68 73 85 c5 11 e5  |&..~.....Jhs....|
-000003c0  53 6c ee 2c ac ad e5 aa  96 b8 bc 37 8b 37 f4 ac  |Sl.,.......7.7..|
-000003d0  7a 5c c6 71 59 10 28 f9  ae b3 d7 d7 57 b8 4f 13  |z\.qY.(.....W.O.|
-000003e0  78 d0 28 17 02 38 70 d9  85 a1 d3 ae 2a e8 7e 3e  |x.(..8p.....*.~>|
-000003f0  da 6f d0 0c 62 33 c8 03  de 45 8f b9 1c b0 e4 ea  |.o..b3...E......|
-00000400  6a 20 fd df 16 03 03 00  14 4d 41 6c 0d 81 3b 6f  |j .......MAl..;o|
-00000410  9d 6b 53 d7 b7 f9 1a 57  a0 66 8a c2 11           |.kS....W.f...|
+00000000  16 03 03 00 81 28 ba 2e  7a 2b 59 83 ae aa ba c7  |.....(..z+Y.....|
+00000010  d7 49 a5 ca c0 fc 8b 49  f5 10 77 ac e7 ae 12 de  |.I.....I..w.....|
+00000020  0d ad 0e 2c d9 ee 99 c4  95 7b 09 b2 91 27 44 6a  |...,.....{...'Dj|
+00000030  7c 08 ce bb 98 4a 1c 8c  47 30 21 c7 5d 1e 86 39  ||....J..G0!.]..9|
+00000040  79 07 48 2a ac 90 7b 26  46 6a a5 b1 7c df fa ae  |y.H*..{&Fj..|...|
+00000050  0f 20 c8 f0 b5 65 57 2b  d5 1f 14 cc bc 7e 94 42  |. ...eW+.....~.B|
+00000060  b6 30 c1 d7 eb 8d 39 0f  65 7a b7 d0 38 21 eb b0  |.0....9.ez..8!..|
+00000070  2d 04 5a 8b 9c 8b 24 91  fe de ac 1f f5 4f aa 74  |-.Z...$......O.t|
+00000080  71 e1 98 8b df 2f 16 03  03 02 69 fb 1f be be 41  |q..../....i....A|
+00000090  51 00 c5 48 bc a3 18 78  2c dc e3 59 d2 0d 23 c7  |Q..H...x,..Y..#.|
+000000a0  2b 03 f3 ce 08 81 62 8a  e9 59 52 06 2a cd 7f fe  |+.....b..YR.*...|
+000000b0  f4 58 5a a4 6c d1 fa f2  1e 31 7e c5 14 39 dc 37  |.XZ.l....1~..9.7|
+000000c0  27 4f 70 ef 79 7e b1 d1  32 1b 3c cf 08 e2 8a 44  |'Op.y~..2.<....D|
+000000d0  56 48 ea 85 8b 86 1d 77  ea 75 f2 c6 8b 14 9d 57  |VH.....w.u.....W|
+000000e0  17 87 29 64 e1 ef 1a 46  25 ed e1 d3 e6 90 63 8d  |..)d...F%.....c.|
+000000f0  30 b6 4d 3c 98 68 45 95  78 11 2c c5 4e 2c 2b 3a  |0.M<.hE.x.,.N,+:|
+00000100  a8 8b 02 1c b9 15 09 ea  59 30 c7 a8 d5 28 f3 45  |........Y0...(.E|
+00000110  77 eb bc bc 4a d9 82 4a  7d 8b 5e e1 36 17 ba 95  |w...J..J}.^.6...|
+00000120  34 ea 7e d7 b8 0d 8c 63  07 30 d9 07 49 df b0 ea  |4.~....c.0..I...|
+00000130  aa 5e 95 7f 90 ab 09 79  31 88 27 00 9e bd 84 5b  |.^.....y1.'....[|
+00000140  ab f6 be 18 10 42 11 49  bd ce 42 dc 2b ae 8f 00  |.....B.I..B.+...|
+00000150  a1 74 5a d1 e3 0b ba 62  57 5f 0e 65 e4 13 ce 78  |.tZ....bW_.e...x|
+00000160  b1 da 89 03 f6 42 cd 1b  fe 03 0c f4 89 77 07 bd  |.....B.......w..|
+00000170  fa 07 5a 4a 86 1f 47 15  2a 18 ec 26 36 e9 c7 04  |..ZJ..G.*..&6...|
+00000180  75 bb 66 e1 32 97 65 e2  e8 2c b1 bc 39 14 3a d6  |u.f.2.e..,..9.:.|
+00000190  77 d0 15 32 e5 58 eb 49  52 15 c6 d6 9c 4e 2d 97  |w..2.X.IR....N-.|
+000001a0  5c 59 5a 51 11 71 1e 3b  1e 25 b8 20 ef 16 d0 27  |\YZQ.q.;.%. ...'|
+000001b0  f9 ad 01 61 96 8c 50 a2  60 86 99 8c b3 cf 04 07  |...a..P.`.......|
+000001c0  de 8a b3 85 53 95 28 e7  6c db 26 42 b2 6c 51 3c  |....S.(.l.&B.lQ<|
+000001d0  b7 54 98 ff 78 48 b2 8e  11 b9 3b 59 b9 38 0b 48  |.T..xH....;Y.8.H|
+000001e0  ac 11 b3 0c b2 f7 98 58  64 ce 16 ae 78 9f 39 ce  |.......Xd...x.9.|
+000001f0  20 2b c3 14 74 54 17 54  8e a1 b7 ed 48 77 37 a0  | +..tT.T....Hw7.|
+00000200  12 18 77 b2 ab 51 d2 e3  fc 6a af b3 a2 4b 60 87  |..w..Q...j...K`.|
+00000210  fb f9 0c e8 33 84 e1 6b  95 f0 af 04 c3 c7 b7 0d  |....3..k........|
+00000220  bd f2 a6 26 f4 b2 15 c0  9e 90 1b cf 66 3f f8 1e  |...&........f?..|
+00000230  64 bf 91 30 b9 2f 31 5b  76 99 67 50 6e b3 fa 00  |d..0./1[v.gPn...|
+00000240  1f 1f 50 1d 52 ea f9 98  7d 59 3a 1d 10 b5 cf 00  |..P.R...}Y:.....|
+00000250  49 a6 72 78 2c e8 2a b2  64 38 34 55 25 b1 4f f7  |I.rx,.*.d84U%.O.|
+00000260  3d 5d 18 d8 63 c4 34 b9  78 15 19 c8 6c d8 03 e9  |=]..c.4.x...l...|
+00000270  0b cb bd 0c b1 32 9c 32  57 ad 7f bd cd db 99 77  |.....2.2W......w|
+00000280  7f 2a 01 60 c6 ce 99 a9  a0 17 ae 02 0c 72 67 b2  |.*.`.........rg.|
+00000290  0e d3 24 c4 88 96 7f ab  c2 46 fb fe 47 b0 72 a0  |..$......F..G.r.|
+000002a0  87 6b 22 00 ee 97 ce 13  eb ab 5b 41 2e 60 79 a1  |.k".......[A.`y.|
+000002b0  4b d1 8f d2 d0 5b 02 77  9c 29 1e ea 3e 30 a9 8f  |K....[.w.)..>0..|
+000002c0  07 b7 22 2a d7 64 50 cf  0a 34 6b db b8 8d e4 f6  |.."*.dP..4k.....|
+000002d0  50 71 65 54 0f e0 87 93  ca 3e 1b 68 29 2f d9 dd  |PqeT.....>.h)/..|
+000002e0  15 76 f0 c3 1c a4 ca e9  5f 17 29 87 bb 0a 5b 74  |.v......_.)...[t|
+000002f0  6c 2d 13 63 16 03 03 00  bc a6 81 fa a1 7b 6e 54  |l-.c.........{nT|
+00000300  0b 47 30 a5 e9 ca e6 86  db f9 af 19 5e fe ae a6  |.G0.........^...|
+00000310  91 c8 e9 c0 c5 17 b4 a6  2b cd 40 ee 9e fc 2d ef  |........+.@...-.|
+00000320  8c 68 6c ce 05 66 b1 80  7d 6f 07 91 6e 9f 23 ab  |.hl..f..}o..n.#.|
+00000330  f2 a7 d1 99 d1 5f ed 58  b1 aa 7f 31 f4 7f 2a ea  |....._.X...1..*.|
+00000340  3e 21 a0 4e 1c 49 d9 ab  1e 43 84 dc 42 cf f5 75  |>!.N.I...C..B..u|
+00000350  ae fc 97 a3 e7 b8 51 1b  68 1b f5 83 2b 2d b0 a5  |......Q.h...+-..|
+00000360  7c f9 f2 21 c1 68 d9 e2  4f bf f5 1e e6 90 7b 54  ||..!.h..O.....{T|
+00000370  2c 45 d2 35 a1 5c da 57  be ce 90 a7 56 90 f2 55  |,E.5.\.W....V..U|
+00000380  08 9e b1 52 09 12 b9 f1  8b fd fb 1a f2 9f 39 bf  |...R..........9.|
+00000390  73 c2 9c dc 6c 0f 19 9b  37 ec 91 86 27 ec 1a e8  |s...l...7...'...|
+000003a0  92 f8 a2 05 71 12 e6 8b  04 0c f3 b4 4d 93 d4 b4  |....q.......M...|
+000003b0  69 7b c3 9c 22 16 03 03  00 4a ba fe c0 02 30 02  |i{.."....J....0.|
+000003c0  33 02 67 87 19 20 13 90  48 80 a1 93 97 cc a6 26  |3.g.. ..H......&|
+000003d0  51 14 4d 2b 60 3d da 72  f0 99 51 2a 8b b4 54 ff  |Q.M+`=.r..Q*..T.|
+000003e0  47 6b 6c b4 6a 92 a9 9c  3c c0 ee ae 79 25 de 17  |Gkl.j...<...y%..|
+000003f0  61 cf 06 37 6f 84 e8 b8  4c 7b 9a c1 a1 ff 6e c5  |a..7o...L{....n.|
+00000400  f3 0b 7d 8d 16 03 03 00  14 a9 38 b9 f0 df 71 c5  |..}.......8...q.|
+00000410  1f fa 77 04 1e b4 4c 2b  64 01 e6 59 cb           |..w...L+d..Y.|
 >>> Flow 9 (client to server)
-00000000  16 03 03 02 69 68 53 61  f2 30 36 9b 4b 58 b2 19  |....ihSa.06.KX..|
-00000010  39 8c b0 72 4f 09 1d 4b  85 08 49 5f 27 4c d0 a9  |9..rO..K..I_'L..|
-00000020  47 01 71 90 a8 8e da 50  ad 92 29 e5 f2 20 ac f7  |G.q....P..).. ..|
-00000030  6e 6c 25 56 8a 08 25 35  14 2a bb c5 d6 02 f9 3b  |nl%V..%5.*.....;|
-00000040  de 98 e3 c3 6a fb 48 30  36 41 22 be 41 bd 12 d4  |....j.H06A".A...|
-00000050  14 96 f6 c5 53 a9 37 ed  c0 f5 c3 42 10 f9 76 d2  |....S.7....B..v.|
-00000060  79 f9 18 18 ff 03 63 cd  bd fb 8a 90 ae 54 95 f5  |y.....c......T..|
-00000070  c9 df cb 85 93 a8 09 69  12 d2 2a bf cf 2d 62 2a  |.......i..*..-b*|
-00000080  66 7f 16 50 a9 ab 1b 86  46 ed 92 75 b5 24 42 5f  |f..P....F..u.$B_|
-00000090  a5 87 c7 08 98 46 42 6b  1f 3f a0 f0 c5 03 99 41  |.....FBk.?.....A|
-000000a0  c7 70 c0 6c 3a 31 b5 cc  1f a5 32 75 16 41 b1 82  |.p.l:1....2u.A..|
-000000b0  7e a6 23 4c 76 e7 73 a7  d2 31 d6 5e 63 75 2e 64  |~.#Lv.s..1.^cu.d|
-000000c0  8e c0 dd fc 69 c9 cd c5  cb 27 63 25 06 0a 38 e3  |....i....'c%..8.|
-000000d0  80 b5 29 44 25 b6 0f 65  81 eb 46 e4 27 7f 6d 83  |..)D%..e..F.'.m.|
-000000e0  13 2d f1 fb 20 1f 52 2f  e2 ec e6 cc 38 7a 76 6a  |.-.. .R/....8zvj|
-000000f0  a5 95 28 37 d5 fd 38 f6  b8 7f 1b d7 35 9e be 2c  |..(7..8.....5..,|
-00000100  e6 35 0d bc ac bd 60 e2  76 b7 9a 36 6b b6 e2 81  |.5....`.v..6k...|
-00000110  11 18 c1 a6 33 37 aa fc  6d 27 57 56 27 8a e6 9b  |....37..m'WV'...|
-00000120  16 65 be 8e 27 a3 cd a5  fa 12 49 22 52 18 bd 32  |.e..'.....I"R..2|
-00000130  82 c0 21 9f 39 fb b2 0f  8e 0d d3 52 e6 ca 98 a7  |..!.9......R....|
-00000140  4f b0 60 4a fd 21 f4 3d  f8 01 58 05 38 29 4c 1a  |O.`J.!.=..X.8)L.|
-00000150  52 98 a3 9d d8 0c 2a 43  36 a3 11 de 9d d4 31 a2  |R.....*C6.....1.|
-00000160  b6 3f 28 dc 3f fc cc ef  c1 34 0b b8 e7 ab ea d9  |.?(.?....4......|
-00000170  22 04 ca ac 50 4f 7c 08  16 6e d6 59 e8 2e c3 29  |"...PO|..n.Y...)|
-00000180  a1 58 42 26 77 97 36 4f  a6 22 32 cd 1b bf 54 83  |.XB&w.6O."2...T.|
-00000190  5c 58 b9 e0 9b e3 5e 2b  c9 f0 4b 12 c6 8a f2 d2  |\X....^+..K.....|
-000001a0  ce 48 84 07 85 98 4f f3  17 2c a8 18 cc 72 71 6d  |.H....O..,...rqm|
-000001b0  26 3c 2f e7 f8 04 4e c6  46 ce 1f cd 72 2f 3a 7b  |&</...N.F...r/:{|
-000001c0  39 b8 58 40 eb 4e 2e bd  5e 27 12 8c fe 43 fb f7  |9.X@.N..^'...C..|
-000001d0  7a 21 78 9d b5 25 5e 4e  66 14 74 da 26 4b 36 ed  |z!x..%^Nf.t.&K6.|
-000001e0  89 0b d0 83 be 0c 53 d0  d7 b1 54 c2 42 a6 7f 62  |......S...T.B..b|
-000001f0  4e 1b c0 a7 f3 5f 32 46  b9 10 c1 75 b8 d0 68 01  |N...._2F...u..h.|
-00000200  0f 11 5e 01 b8 3d 78 17  d5 9f f9 41 57 bd 7a fc  |..^..=x....AW.z.|
-00000210  54 73 da ba bc f3 1a 03  8c 66 bb f9 e8 e3 b1 ea  |Ts.......f......|
-00000220  28 0c 4e 5f 52 a6 37 67  e2 e4 e9 b0 1d b1 fd d0  |(.N_R.7g........|
-00000230  b7 28 fb b7 62 e6 a2 41  95 a7 06 a7 85 e0 6e f0  |.(..b..A......n.|
-00000240  58 88 83 5d 8a 6a c9 7a  83 e7 08 4c 12 f7 5a c9  |X..].j.z...L..Z.|
-00000250  cc 1e a6 96 13 19 8b f9  6e 9f 5e 83 fe e1 66 b9  |........n.^...f.|
-00000260  96 b2 87 41 16 90 54 3e  51 ba b8 95 ce d4 16 03  |...A..T>Q.......|
-00000270  03 00 35 d2 71 1a 6d a7  5d a8 ef f0 06 72 e8 fb  |..5.q.m.]....r..|
-00000280  8d 9b c4 15 49 94 33 95  ad be 75 e3 f9 0f 0a 12  |....I.3...u.....|
-00000290  aa e8 4f d9 75 b1 74 17  35 83 e5 19 ee 77 15 b8  |..O.u.t.5....w..|
-000002a0  96 b5 39 71 b4 cd ce e2  16 03 03 00 98 12 dc b2  |..9q............|
-000002b0  5d 91 b2 41 9c 15 9c 9e  02 bc 7b 53 a6 1e b4 5e  |]..A......{S...^|
-000002c0  4d 09 6d 3c 74 9c 08 59  ac 02 3a 3f 5f 20 6b 41  |M.m<t..Y..:?_ kA|
-000002d0  76 70 97 0d 9d 33 97 ee  12 1b a0 f9 47 b0 e3 7c  |vp...3......G..||
-000002e0  ee 15 07 a7 09 51 21 b2  a3 af 8d a4 fd 87 2b 88  |.....Q!.......+.|
-000002f0  a5 32 70 03 07 79 46 db  ed 9c dc 1d c3 66 9e eb  |.2p..yF......f..|
-00000300  69 53 d5 98 20 dc 85 33  d5 72 d0 86 b8 1c fc c2  |iS.. ..3.r......|
-00000310  d4 5d 6c 21 25 db 9b f9  87 55 8f 9a 49 7d f9 1e  |.]l!%....U..I}..|
-00000320  75 c9 92 24 a2 33 8f 87  a8 de 2a 4c 0c ad 22 3d  |u..$.3....*L.."=|
-00000330  08 2b eb e1 db 17 d8 b6  45 e6 73 07 2a 3e 69 53  |.+......E.s.*>iS|
-00000340  ee 6c 2f 12 b1 14 03 03  00 11 f4 df 0d 7c 69 ab  |.l/..........|i.|
-00000350  2f 66 af 42 39 df 8b 11  90 a6 32 16 03 03 00 20  |/f.B9.....2.... |
-00000360  28 f1 b1 31 fa 17 04 ab  6f c8 84 a8 47 ba 9d ac  |(..1....o...G...|
-00000370  8b a2 37 c5 47 9d 65 5f  a2 b1 fb fc e8 0e db 29  |..7.G.e_.......)|
+00000000  16 03 03 02 69 fb 20 8a  eb 44 f8 0a 95 61 0a 01  |....i. ..D...a..|
+00000010  48 6c ef 59 52 6f 99 7d  6e ce 7e 00 5e 67 f4 cd  |Hl.YRo.}n.~.^g..|
+00000020  19 08 39 12 a0 43 44 59  0f 9c 21 34 06 fe 09 6f  |..9..CDY..!4...o|
+00000030  3d de 99 a3 f8 96 03 12  78 eb 76 a7 ee 09 b4 49  |=.......x.v....I|
+00000040  50 42 48 09 f1 7b 54 aa  e9 45 73 29 e8 41 47 9a  |PBH..{T..Es).AG.|
+00000050  d5 8c fa bc f8 54 96 23  30 cb 36 ac cd 75 a4 16  |.....T.#0.6..u..|
+00000060  ee 88 cc 74 25 5d 2e e2  88 d9 9d dc 87 bd 77 8b  |...t%]........w.|
+00000070  ac 98 20 34 cb c7 1c 71  44 b1 3c a6 42 11 bd 20  |.. 4...qD.<.B.. |
+00000080  65 74 c3 36 c9 e3 6d ae  7e 37 9a b7 33 d8 6c 11  |et.6..m.~7..3.l.|
+00000090  93 49 a4 e8 14 11 27 72  9c c8 44 75 21 5d 82 1e  |.I....'r..Du!]..|
+000000a0  71 ca 7d 46 95 5f 2e c4  80 be 90 2f 5a 13 92 28  |q.}F._...../Z..(|
+000000b0  dc 54 5b e6 a0 9c c7 f8  bd 97 bd e5 6c 05 d2 68  |.T[.........l..h|
+000000c0  c3 f3 54 1c 9e bc a3 20  c1 de f1 e7 3a 7e 5a fd  |..T.... ....:~Z.|
+000000d0  4f 22 f7 d4 e7 19 fb 94  6f fd bd 15 39 bf 9e 4b  |O"......o...9..K|
+000000e0  63 35 19 0b 59 28 47 f3  56 ae 4c 13 50 30 b5 d1  |c5..Y(G.V.L.P0..|
+000000f0  d1 a9 a2 32 dc 23 5e 47  e9 dd 8c d5 32 12 d9 0d  |...2.#^G....2...|
+00000100  78 04 bc ae f9 81 5c e3  05 88 c9 89 72 c6 7d 86  |x.....\.....r.}.|
+00000110  c6 55 aa 39 cd 9e 9e 5e  ce 00 ce 51 fa 54 ee ba  |.U.9...^...Q.T..|
+00000120  64 a6 9c a8 88 00 a8 ed  6a 7a 63 cc d8 60 a4 52  |d.......jzc..`.R|
+00000130  a9 2f 23 c5 ca 96 12 d5  ec 11 46 84 1f d3 43 74  |./#.......F...Ct|
+00000140  db 87 13 42 18 71 b9 ff  18 d4 3b b5 c5 87 c8 c0  |...B.q....;.....|
+00000150  91 fb 8c 7e c8 39 77 0e  e0 52 bb 58 18 fa d8 5a  |...~.9w..R.X...Z|
+00000160  e0 e5 ab 4b 08 36 be 1d  6a ae a3 44 af 54 90 2f  |...K.6..j..D.T./|
+00000170  4f fb bc a5 d4 be c2 74  4e a1 22 61 10 09 5e 35  |O......tN."a..^5|
+00000180  1c ab 1c 73 de 20 37 38  d0 5f 6c 24 f8 8d 79 22  |...s. 78._l$..y"|
+00000190  0a b0 53 86 04 1e 73 36  57 dc c0 fb 98 15 ea 5e  |..S...s6W......^|
+000001a0  85 1d 8f 7f 7a 59 27 8d  ce 5d df 29 c8 4d 10 d2  |....zY'..].).M..|
+000001b0  87 79 9b 60 ff 17 a1 24  41 0d 12 99 dc ad ad 76  |.y.`...$A......v|
+000001c0  00 74 a3 5a 73 9e 0c f4  90 0e bb 5a 11 5a 89 c7  |.t.Zs......Z.Z..|
+000001d0  71 79 1a 72 f9 6f 19 6d  eb 29 32 39 4d da 69 e4  |qy.r.o.m.)29M.i.|
+000001e0  e9 f8 3a b0 b8 10 76 c0  21 3b 95 76 ec 01 7d f2  |..:...v.!;.v..}.|
+000001f0  10 15 5f 1d 94 b1 13 e8  ca c4 07 c4 aa d1 50 65  |.._...........Pe|
+00000200  5b 1f e9 ec 50 52 f6 33  38 e7 16 e4 e5 78 29 a1  |[...PR.38....x).|
+00000210  41 6c 4f dc 07 bb 28 59  7f 1d cb 61 4d 2d 1e 43  |AlO...(Y...aM-.C|
+00000220  b5 d5 8f b8 84 ec 4d 1c  c7 5c 62 b7 21 71 83 74  |......M..\b.!q.t|
+00000230  58 3b 70 92 c8 c8 af 7d  f6 da 75 9d 30 99 cf 33  |X;p....}..u.0..3|
+00000240  4e f0 8f 5e 44 1b 0d 35  83 80 b9 8c 80 23 a6 29  |N..^D..5.....#.)|
+00000250  34 0c 88 8f 55 da 85 f8  92 89 4c 34 6a 73 98 bd  |4...U.....L4js..|
+00000260  86 70 11 7e a3 b7 04 0a  24 07 34 6c 06 64 16 03  |.p.~....$.4l.d..|
+00000270  03 00 35 08 d2 96 51 e2  6f 68 ae 19 04 9c 59 e4  |..5...Q.oh....Y.|
+00000280  09 72 da 6a 8e ee 4f 87  b3 b3 1e 89 0b a5 45 32  |.r.j..O.......E2|
+00000290  98 a4 f3 af 64 d7 71 37  2a a5 d4 53 5a 0a 03 05  |....d.q7*..SZ...|
+000002a0  d6 33 c2 ff 5f 2d 6d 94  16 03 03 00 98 49 3c 15  |.3.._-m......I<.|
+000002b0  0a e5 ac 39 54 97 f5 2a  dd 05 02 87 16 1c 6c ae  |...9T..*......l.|
+000002c0  4e 62 1e 27 81 54 66 13  9a d1 1d d2 2c 5b 17 20  |Nb.'.Tf.....,[. |
+000002d0  a4 69 b5 69 ec 3a 59 bd  8b d2 5d f3 84 c7 65 a2  |.i.i.:Y...]...e.|
+000002e0  ad 02 57 bf 3f 72 c5 ce  61 24 09 7e e4 f4 2a a6  |..W.?r..a$.~..*.|
+000002f0  81 29 d0 9c 0f c5 d5 67  7a b0 e4 42 2f a5 5f 00  |.).....gz..B/._.|
+00000300  42 ea ef 8b c8 55 c6 c4  27 26 e5 f7 57 2e 35 f8  |B....U..'&..W.5.|
+00000310  e2 cc 41 6a 29 e2 66 b3  44 fe 2b f9 de 7d 32 96  |..Aj).f.D.+..}2.|
+00000320  96 e6 cf 57 2c b8 73 bc  e2 c2 89 20 8a 71 d3 03  |...W,.s.... .q..|
+00000330  02 7e 95 ef 94 f6 68 b5  94 4b b4 ec a4 e0 10 42  |.~....h..K.....B|
+00000340  c4 9e f2 28 dd 14 03 03  00 11 96 52 4d c7 17 35  |...(.......RM..5|
+00000350  cf 9a 66 5f 73 c3 f5 40  60 12 11 16 03 03 00 20  |..f_s..@`...... |
+00000360  67 eb 03 bf 5c 0f b8 d5  7d e4 14 0a 81 32 50 2a  |g...\...}....2P*|
+00000370  6b 02 53 f6 37 00 ef ef  8a 5f ee 3a bf 5b 84 b9  |k.S.7...._.:.[..|
 >>> Flow 10 (server to client)
-00000000  14 03 03 00 11 f5 62 67  0e 91 7e aa 24 ec 3f f2  |......bg..~.$.?.|
-00000010  9f 28 6f 5d 82 d5 16 03  03 00 20 0e 66 b9 47 16  |.(o]...... .f.G.|
-00000020  b2 77 dc c5 3f ac f9 6a  4e f9 78 c4 25 64 f2 1f  |.w..?..jN.x.%d..|
-00000030  6c f1 51 7f c8 5d 21 7f  0e 5c ac 17 03 03 00 19  |l.Q..]!..\......|
-00000040  69 4e ff 74 0b c7 7a ce  64 71 c9 a1 6b dd b9 9b  |iN.t..z.dq..k...|
-00000050  9d 6b 21 bb cb b8 37 4d  87 16 03 03 00 14 1a 98  |.k!...7M........|
-00000060  7e 2f 5a 82 51 2c 0f 0d  79 25 4e 6f 11 dc 97 86  |~/Z.Q,..y%No....|
-00000070  64 23                                             |d#|
+00000000  14 03 03 00 11 ab e7 45  c8 02 30 54 0f 5a ea 63  |.......E..0T.Z.c|
+00000010  42 ea 39 9b 46 ba 16 03  03 00 20 60 56 50 ad d0  |B.9.F..... `VP..|
+00000020  fe 7d 56 a2 e1 d9 87 76  96 3b b3 27 3b 7f be e4  |.}V....v.;.';...|
+00000030  98 d0 7a 6a a2 e3 37 1c  f5 a9 a1 17 03 03 00 19  |..zj..7.........|
+00000040  67 ee fd 6d 58 de bd b8  df aa 4d 36 e4 93 83 7b  |g..mX.....M6...{|
+00000050  e5 bd d1 ba 5c f3 2f aa  a8 16 03 03 00 14 73 29  |....\./.......s)|
+00000060  15 c9 16 62 a2 97 81 f8  44 94 86 c1 94 37 9f 19  |...b....D....7..|
+00000070  1d c2                                             |..|
 >>> Flow 11 (client to server)
-00000000  16 03 03 01 16 08 6c 5f  e7 b8 3e 36 50 c0 05 0c  |......l_..>6P...|
-00000010  a6 fa 1a f8 83 3f 1f fd  fd ae 62 15 4b 4e 80 8b  |.....?....b.KN..|
-00000020  5a f4 a2 3e 67 df 82 28  e4 eb f4 26 5c 62 53 6e  |Z..>g..(...&\bSn|
-00000030  dc 20 7f e7 af 68 7a 0b  10 77 12 36 97 c3 b9 06  |. ...hz..w.6....|
-00000040  d1 78 46 4f e9 61 f4 65  8a d6 c9 ed 2d 00 9c de  |.xFO.a.e....-...|
-00000050  20 b5 20 99 cd 90 d6 d1  04 26 bd 75 42 eb ad 6a  | . ......&.uB..j|
-00000060  27 27 9c 20 5b 22 e6 e3  cc 67 0e b2 ae c7 4c d5  |''. ["...g....L.|
-00000070  fa e5 c0 bc 7e c6 20 d1  75 f5 bf 18 fd bf 5c 36  |....~. .u.....\6|
-00000080  95 66 38 ab 53 ad 77 d7  ad fb 15 de 2a 66 86 56  |.f8.S.w.....*f.V|
-00000090  1c b9 4f 73 cb 9a d1 9d  60 a8 ce c0 22 ae f4 49  |..Os....`..."..I|
-000000a0  23 86 48 a2 a4 81 28 a9  d1 53 26 c6 a0 71 54 90  |#.H...(..S&..qT.|
-000000b0  54 a9 e8 df 9a f9 af 59  29 52 95 73 6f b3 0b 07  |T......Y)R.so...|
-000000c0  ed a5 1c fb 93 29 bf c7  30 bf e4 d1 5c 5c 04 ef  |.....)..0...\\..|
-000000d0  f0 84 15 06 f4 28 b3 a4  ad d5 48 6b e8 ff 24 09  |.....(....Hk..$.|
-000000e0  e8 28 c4 ad de d4 8e e1  d2 e5 3b f1 03 0d 9d 61  |.(........;....a|
-000000f0  f2 b3 2a 85 dd dd a6 2d  3c c0 b2 7c c6 81 fb a8  |..*....-<..|....|
-00000100  da 3b 85 72 13 37 a4 da  11 cd 54 3e 84 43 4d 47  |.;.r.7....T>.CMG|
-00000110  30 ed 39 6d c7 a1 6a ea  39 80 75                 |0.9m..j.9.u|
+00000000  16 03 03 01 16 bb 29 a6  76 e4 5a ec 09 4e a7 6a  |......).v.Z..N.j|
+00000010  66 d7 6e 39 fc 5a dd be  9f 34 1e cb 3a b3 3f 1e  |f.n9.Z...4..:.?.|
+00000020  48 ad 0b e0 0e 43 b1 3e  57 f3 4a d1 c7 c6 1a f0  |H....C.>W.J.....|
+00000030  a8 3e d1 37 de 95 ad 0f  92 85 ee b2 2b 1c 30 2f  |.>.7........+.0/|
+00000040  f5 70 ca 42 28 0c c2 e4  06 73 d5 eb 31 d2 86 f7  |.p.B(....s..1...|
+00000050  d6 42 5d e0 b0 a6 c0 94  2c 52 0b 18 2c 95 9c 2a  |.B].....,R..,..*|
+00000060  56 4d a4 17 fb 51 49 be  3a 37 27 87 c7 d5 94 56  |VM...QI.:7'....V|
+00000070  88 c5 94 a6 ff a1 dd cf  2b 70 e1 6c a9 39 1b e7  |........+p.l.9..|
+00000080  69 c3 0e ef 08 d2 fb 6d  54 8a 80 64 99 6a b3 e4  |i......mT..d.j..|
+00000090  2e 44 62 ce 1c 4d 7a 0a  45 cd ba 52 23 47 6d 05  |.Db..Mz.E..R#Gm.|
+000000a0  97 03 c6 c4 c7 5a ca bf  38 73 b4 8c e5 a5 14 1b  |.....Z..8s......|
+000000b0  10 ea 29 17 af f6 37 bd  7f 56 88 b2 63 92 9f b9  |..)...7..V..c...|
+000000c0  6c 18 9b 1b ad ce ac f0  97 45 3e 72 e0 10 8e 64  |l........E>r...d|
+000000d0  80 dc cd a1 f9 10 d1 cd  46 2a 98 cd 40 94 5b dc  |........F*..@.[.|
+000000e0  f5 07 05 96 f3 74 db 91  3c 45 f1 6e b7 f9 52 e8  |.....t..<E.n..R.|
+000000f0  95 05 c3 fc 95 f7 3d 91  45 cd fe b1 13 01 78 e0  |......=.E.....x.|
+00000100  31 fc e2 0d 5b 97 5b 92  43 0a 83 21 c4 f2 3f d3  |1...[.[.C..!..?.|
+00000110  3f 1a a0 52 e0 d0 fe a7  03 6c 1a                 |?..R.....l.|
 >>> Flow 12 (server to client)
-00000000  16 03 03 00 81 4d dc 53  4e 94 ec b0 47 9b 8f 04  |.....M.SN...G...|
-00000010  98 4e 78 3a d2 64 0a 11  65 38 15 71 35 06 83 96  |.Nx:.d..e8.q5...|
-00000020  0d 0d 54 4b 4b aa 9d 3f  a1 dc 89 78 c2 a4 6c 89  |..TKK..?...x..l.|
-00000030  c9 56 f1 aa 9a d4 23 9a  21 af 51 73 fe 52 98 af  |.V....#.!.Qs.R..|
-00000040  d5 af 55 66 f0 bf 4d a4  73 b4 06 55 aa 01 39 49  |..Uf..M.s..U..9I|
-00000050  8d 8d 21 bf 17 45 70 1a  95 ab df fa db 24 e2 f7  |..!..Ep......$..|
-00000060  e4 98 dc 86 15 b1 d4 7a  11 c4 b2 72 80 fb 51 fa  |.......z...r..Q.|
-00000070  8d b3 6e 94 5d d0 0b 47  e0 43 78 ef ce b0 69 40  |..n.]..G.Cx...i@|
-00000080  d7 b5 26 ad 90 24 16 03  03 02 69 d8 13 11 85 13  |..&..$....i.....|
-00000090  e2 4c 6a 6b 70 85 ba d4  70 c4 23 84 d5 3d 39 0c  |.Ljkp...p.#..=9.|
-000000a0  03 37 a2 e7 77 c9 0f 0d  8f 7c 6c d4 f3 6e d9 71  |.7..w....|l..n.q|
-000000b0  99 d7 33 dc ab 82 24 b7  7c 7d 92 b0 da 52 6a 5c  |..3...$.|}...Rj\|
-000000c0  b8 ae ad 8f 98 e7 65 e9  ce 16 ee d3 51 09 52 dd  |......e.....Q.R.|
-000000d0  be 96 76 37 1c 40 83 da  14 ad 61 df 09 2b 68 4f  |..v7.@....a..+hO|
-000000e0  d1 e0 93 f3 d0 c4 ad be  53 c5 5c 2e ee 79 42 3d  |........S.\..yB=|
-000000f0  fa 04 7b d0 bd 7a 8f 2b  5f 2a b0 d7 98 81 45 14  |..{..z.+_*....E.|
-00000100  28 ab 85 63 28 6f a1 49  cb 2f b2 76 f1 cc 77 5f  |(..c(o.I./.v..w_|
-00000110  6b ef 9c d5 47 b7 c9 f9  b5 58 c3 37 79 93 36 5b  |k...G....X.7y.6[|
-00000120  00 13 ef bc 36 68 33 46  58 ae 48 11 59 52 59 f2  |....6h3FX.H.YRY.|
-00000130  74 6a 71 fe 63 38 f0 84  9a 7d 39 d6 f7 a1 92 ee  |tjq.c8...}9.....|
-00000140  85 d3 3e 44 29 3d 71 b5  d5 fb 26 c3 57 ac d8 60  |..>D)=q...&.W..`|
-00000150  de 6c de 9e e0 61 e6 c4  75 3a 01 d5 ae 15 bd 51  |.l...a..u:.....Q|
-00000160  27 ff e6 b5 65 c2 30 96  10 0f 31 6c 8b d3 16 ee  |'...e.0...1l....|
-00000170  ec 52 80 dc e7 84 29 9b  e2 71 13 54 c3 58 b5 8b  |.R....)..q.T.X..|
-00000180  22 4d c0 41 33 69 c1 fe  e3 f0 42 39 ee fd c0 6a  |"M.A3i....B9...j|
-00000190  c1 52 5a 64 8b a6 f0 16  71 cf 45 2b cf fe 5d 74  |.RZd....q.E+..]t|
-000001a0  b4 7f 25 dd 46 b0 e2 51  42 59 e3 79 c9 f1 f4 d0  |..%.F..QBY.y....|
-000001b0  28 f8 74 f1 df 74 e6 b6  0b 8a be 11 e0 67 c1 79  |(.t..t.......g.y|
-000001c0  a1 7c 18 0e 65 8b 5c 76  3c c1 7c 79 5f b9 06 3a  |.|..e.\v<.|y_..:|
-000001d0  ce a3 69 04 cf 9c 1e bf  5e 53 4e ac 79 59 63 ec  |..i.....^SN.yYc.|
-000001e0  57 5b 87 c5 48 cb 13 09  9f 68 61 02 e4 3b a1 2d  |W[..H....ha..;.-|
-000001f0  a7 86 95 39 1e 83 05 50  e2 f9 ad 9b 92 2f f5 21  |...9...P...../.!|
-00000200  e9 da 58 e6 d9 ef 9e 69  62 dc e1 8f a5 04 89 db  |..X....ib.......|
-00000210  2f 41 f6 37 c6 fa e1 d6  c5 73 3f 54 e8 dc d3 bb  |/A.7.....s?T....|
-00000220  d6 83 23 c9 c5 e6 85 67  78 39 21 4f 99 88 21 81  |..#....gx9!O..!.|
-00000230  88 a7 8d cd ed e7 68 05  84 c0 32 34 39 85 79 7d  |......h...249.y}|
-00000240  18 28 94 25 ee e8 9d c6  40 03 c7 1b 6c 4c 27 33  |.(.%....@...lL'3|
-00000250  c1 65 79 8b e5 9b 54 9b  91 e0 b8 7f 7b 8b 66 b2  |.ey...T.....{.f.|
-00000260  5f 2b 18 52 ad 69 d6 6a  f8 22 c5 a9 fc e0 1d 72  |_+.R.i.j.".....r|
-00000270  ae 18 13 ba 33 b7 ed 0e  6c 49 95 01 1e 3c 72 ed  |....3...lI...<r.|
-00000280  8b 90 18 79 d9 24 db 57  ec 5b 9c 20 fe 6d c0 ea  |...y.$.W.[. .m..|
-00000290  63 78 f3 db 6b 97 a7 f0  8b 0a 09 b2 d4 9e ad 21  |cx..k..........!|
-000002a0  a4 97 26 d9 bd 50 24 ca  38 f3 1c 75 ca 03 cc 9e  |..&..P$.8..u....|
-000002b0  af b0 07 3d d3 22 28 9c  17 8c c1 bb 44 2b d8 63  |...=."(.....D+.c|
-000002c0  c8 68 7e 1b a1 db 70 3e  0b 13 90 59 80 26 31 80  |.h~...p>...Y.&1.|
-000002d0  b7 0f 37 9c 44 53 2c b7  0a 01 8c 10 00 92 0c cf  |..7.DS,.........|
-000002e0  e5 aa 62 a7 ef 8a d9 9a  2c 2a ec 35 6e ab 5c e0  |..b.....,*.5n.\.|
-000002f0  ee 34 ff dd 16 03 03 00  bc 9c 3f f9 18 06 c1 bc  |.4........?.....|
-00000300  51 3b f7 9b 00 3e db 7c  0b 6b cd 0d 15 01 2d 00  |Q;...>.|.k....-.|
-00000310  d8 be 79 94 56 a3 2f e0  fb 04 da 77 4b ff 68 42  |..y.V./....wK.hB|
-00000320  b1 ca 12 0d e8 af a7 fc  12 7a 85 82 21 71 90 9d  |.........z..!q..|
-00000330  63 ff 60 ed 18 65 c3 6c  eb 84 81 fb ff fa e5 ea  |c.`..e.l........|
-00000340  bc e7 d5 d0 14 6f ee bb  17 a8 0d ed 2d dd 94 0c  |.....o......-...|
-00000350  8c 3f db e3 57 53 e8 27  9c b5 61 e6 a4 07 9b 0e  |.?..WS.'..a.....|
-00000360  a9 0a b5 56 cb 08 8c 6d  90 8b 25 4b 56 30 70 7c  |...V...m..%KV0p||
-00000370  7a c8 a9 97 53 e1 8a 59  bb 7c bb 93 96 90 e1 af  |z...S..Y.|......|
-00000380  32 c4 14 24 06 2e 68 84  ac 21 1e 44 3b 3b 7e 35  |2..$..h..!.D;;~5|
-00000390  b8 41 27 bb 9c d8 c6 9e  dc 9d 89 9a 3b fa a5 fd  |.A'.........;...|
-000003a0  10 43 74 d6 a8 15 14 80  38 3d 30 e0 b0 eb ec 25  |.Ct.....8=0....%|
-000003b0  3b 47 ec 85 87 16 03 03  00 14 2f f9 cd f0 af 35  |;G......../....5|
-000003c0  69 f4 32 4e 55 10 9f fc  0e 69 34 be bc 06        |i.2NU....i4...|
+00000000  16 03 03 00 81 47 d2 a4  b9 04 d0 39 aa 1f d3 7a  |.....G.....9...z|
+00000010  f2 c3 a5 03 8a 35 6c 6b  bf 18 02 62 d3 ab 8a 0f  |.....5lk...b....|
+00000020  99 69 f3 84 45 7a 09 28  09 68 3a 67 8a ee 94 b1  |.i..Ez.(.h:g....|
+00000030  d3 2a e6 37 b7 f1 88 df  c0 18 42 96 78 4e cf 3b  |.*.7......B.xN.;|
+00000040  e9 35 50 af ee 96 52 e9  1c 58 47 79 87 97 ce d9  |.5P...R..XGy....|
+00000050  71 9b 4a 47 bc 60 8f 95  ea 75 4e c8 3e ca 79 0f  |q.JG.`...uN.>.y.|
+00000060  22 b2 37 19 12 d6 08 4d  01 93 d9 86 ed 4c 9e 42  |".7....M.....L.B|
+00000070  fb 9b 37 26 98 33 74 cf  84 f4 e1 23 81 6f b6 b2  |..7&.3t....#.o..|
+00000080  a9 27 e7 88 50 77 16 03  03 02 69 6b 78 db e3 0e  |.'..Pw....ikx...|
+00000090  cc 07 a4 96 1f 75 13 6d  fe cd 3d 36 8c b0 44 e9  |.....u.m..=6..D.|
+000000a0  4a 3a 41 26 c9 8c 2f 25  28 9d a8 7b dd df 28 6a  |J:A&../%(..{..(j|
+000000b0  fc ef 87 d4 06 dd 4e 05  ff 40 e3 6c 49 94 ad 1c  |......N..@.lI...|
+000000c0  c2 30 cc 41 35 39 a2 70  95 db de a7 c0 aa 05 c0  |.0.A59.p........|
+000000d0  a2 a7 18 8e ba 70 ee 4b  0d 8d de 98 c7 8a 58 9c  |.....p.K......X.|
+000000e0  8b 51 f7 8f bb 7c 8f f7  60 53 9e 11 7e 5c e6 25  |.Q...|..`S..~\.%|
+000000f0  be 22 aa 0a 3d 35 1c ac  2b 7d 98 fc 01 3a a9 9d  |."..=5..+}...:..|
+00000100  bf b5 d1 ae 10 52 ae 17  f6 df fc 24 38 0b f2 64  |.....R.....$8..d|
+00000110  a8 9a 5c ff cb 42 bd 9d  af 41 4d 6b 22 67 94 ac  |..\..B...AMk"g..|
+00000120  6b 95 2e 43 41 5d 5e c9  67 29 5f f8 8e 13 9d 18  |k..CA]^.g)_.....|
+00000130  3c d4 ff 20 66 ff a6 d1  84 1a 33 31 27 5d 28 b5  |<.. f.....31'](.|
+00000140  24 57 43 c1 83 6a e7 8c  35 0c a7 6f 5e 78 e8 84  |$WC..j..5..o^x..|
+00000150  7c ee 9a 94 dc fd f7 a4  10 3d bb 66 0a 17 14 e7  ||........=.f....|
+00000160  d7 29 47 f7 70 76 d6 ec  b2 3c e2 a0 22 e6 c5 c3  |.)G.pv...<.."...|
+00000170  bf a6 94 72 8b 70 eb 2b  b8 4f c9 7d 72 22 75 ce  |...r.p.+.O.}r"u.|
+00000180  b9 c2 34 08 ac 87 d3 a8  35 81 f7 5e 20 02 0c e8  |..4.....5..^ ...|
+00000190  0a 47 4e 37 4a 03 6d b1  c5 8f 29 77 80 c7 6c 5c  |.GN7J.m...)w..l\|
+000001a0  c3 3e 6f 3d 02 ee 5e f2  fb 20 a2 ad c1 5b 2c 02  |.>o=..^.. ...[,.|
+000001b0  ef dd 81 e7 ea af f0 01  4f 0b eb f8 a1 82 3d ee  |........O.....=.|
+000001c0  be b5 09 df f2 34 49 f0  e8 f3 bc 7e e7 6a 14 0d  |.....4I....~.j..|
+000001d0  e4 aa e5 38 8a 2c 15 01  52 48 83 46 50 13 2b 71  |...8.,..RH.FP.+q|
+000001e0  f4 48 1a 3d 3f 14 dc 3c  ba fc a8 68 57 44 5d f1  |.H.=?..<...hWD].|
+000001f0  f4 7f 23 8d ca f1 75 99  8c 36 99 38 b9 06 85 d0  |..#...u..6.8....|
+00000200  a6 76 8b ae 7e 2a 26 cb  cc 9e 8c 7c 98 e6 00 86  |.v..~*&....|....|
+00000210  a9 d4 cb 42 8c 04 dc 6b  37 1e 8b e2 98 90 0f b3  |...B...k7.......|
+00000220  c0 ea 07 1c 92 45 39 65  12 90 41 23 93 55 59 13  |.....E9e..A#.UY.|
+00000230  22 e1 68 05 cc 5d ef a2  40 85 fb 61 d5 53 cb 77  |".h..]..@..a.S.w|
+00000240  63 7b 16 bf c6 17 57 fb  58 1e d2 86 1a 4a 79 a2  |c{....W.X....Jy.|
+00000250  1f da 2c 64 65 1c 7c 13  21 1b 33 22 36 0e 03 41  |..,de.|.!.3"6..A|
+00000260  8e 6a 78 98 ae 29 71 3e  5c be 5f 83 55 f4 80 2d  |.jx..)q>\._.U..-|
+00000270  b8 2a b8 84 bd 97 7c 60  03 ae 67 77 44 47 70 c2  |.*....|`..gwDGp.|
+00000280  09 0d 1b ed a8 17 8e 84  97 1a b4 75 c2 48 86 bd  |...........u.H..|
+00000290  b1 3c 1f 7c 1a 5b 60 10  a0 66 aa 8e f7 ba 9b e8  |.<.|.[`..f......|
+000002a0  35 6c 46 f0 67 3f f1 8b  5f a0 be 31 2e 45 22 80  |5lF.g?.._..1.E".|
+000002b0  ba d1 ff 88 f0 c8 bd 31  84 64 6a 07 02 75 bd 99  |.......1.dj..u..|
+000002c0  f1 aa 3c 9d 0e b8 f4 76  b3 24 4f 68 f0 83 b1 da  |..<....v.$Oh....|
+000002d0  eb 70 1e 27 f4 17 90 a4  bc e5 1f d8 8b ee a1 e4  |.p.'............|
+000002e0  1e c5 f4 a2 5b c3 0c 6d  2e c8 0e 67 89 4b d9 fe  |....[..m...g.K..|
+000002f0  9b a0 15 97 16 03 03 00  bc 2c e6 a2 fe 1b d7 1e  |.........,......|
+00000300  38 85 ef 39 d1 d6 df ae  c4 7f af b2 ff c2 92 0b  |8..9............|
+00000310  37 e3 5c a9 6c 2c 9e f7  0e a3 88 ee 09 14 6b eb  |7.\.l,........k.|
+00000320  46 81 74 4a a7 f8 39 82  7d a0 16 69 e4 17 52 f0  |F.tJ..9.}..i..R.|
+00000330  16 5f f7 2a a1 a0 a2 bb  41 4c 0c f9 9c e3 af 5e  |._.*....AL.....^|
+00000340  bd 43 47 2d 6d 4a 88 60  95 52 29 94 3d ec 75 d4  |.CG-mJ.`.R).=.u.|
+00000350  dc f5 01 4a 57 fd 7b 96  13 75 5b ed a8 9d 29 5f  |...JW.{..u[...)_|
+00000360  5f 28 dc 04 3a 91 0f 6b  d6 7d 32 fe 75 cd 61 49  |_(..:..k.}2.u.aI|
+00000370  1b 6d b3 c6 41 87 6b 2d  09 e1 3d 8e f5 fb 9b b7  |.m..A.k-..=.....|
+00000380  04 9a 01 ab 82 e5 2b 17  4f 93 d7 ef 31 79 10 b0  |......+.O...1y..|
+00000390  1c cb 17 5b 8a 7a e9 22  ea 83 68 93 68 f6 85 34  |...[.z."..h.h..4|
+000003a0  d1 4d 75 5a b3 69 46 42  92 04 09 47 b1 8e 67 ad  |.MuZ.iFB...G..g.|
+000003b0  47 4e 2c 02 48 16 03 03  00 14 b0 40 bb eb e1 a6  |GN,.H......@....|
+000003c0  94 fd d0 8a e1 91 a7 c9  d2 4b f8 95 95 c7        |.........K....|
 >>> Flow 13 (client to server)
-00000000  16 03 03 00 35 d6 3f 29  84 29 7e 6b a9 c8 30 51  |....5.?).)~k..0Q|
-00000010  e9 ab f5 2e f6 ae 21 f0  f2 81 cd d3 29 d1 90 4a  |......!.....)..J|
-00000020  72 a0 42 0b 37 db be 88  fe eb 83 4e f8 d1 1e 11  |r.B.7......N....|
-00000030  18 13 8e 93 cd c2 be ed  fa 6b 14 03 03 00 11 43  |.........k.....C|
-00000040  58 95 9e e8 f3 55 52 86  10 4c 9f 43 4c 10 b7 c5  |X....UR..L.CL...|
-00000050  16 03 03 00 20 e8 98 d2  f8 ba 0f 82 98 f2 dc f7  |.... ...........|
-00000060  f8 62 3c 35 e6 f4 4a 8e  d4 c1 28 73 21 8d 98 ea  |.b<5..J...(s!...|
-00000070  97 c9 28 36 6e                                    |..(6n|
+00000000  16 03 03 00 35 25 1e 49  ad bf 9c 37 e2 d0 2b aa  |....5%.I...7..+.|
+00000010  44 91 d5 61 e7 a5 16 b2  cb 93 43 d7 a0 2b b7 19  |D..a......C..+..|
+00000020  f2 41 d8 36 65 95 4a bb  68 1b 65 7b de 89 a5 af  |.A.6e.J.h.e{....|
+00000030  1a aa ec bf b4 66 97 fc  76 d0 14 03 03 00 11 94  |.....f..v.......|
+00000040  b0 9b 4d 47 6e 63 e3 3d  c4 a7 36 94 3f d2 04 a3  |..MGnc.=..6.?...|
+00000050  16 03 03 00 20 34 f5 58  f2 80 c9 19 41 07 d8 6c  |.... 4.X....A..l|
+00000060  6f 64 e7 e9 76 65 cf a8  61 97 27 29 28 f8 0c 7a  |od..ve..a.')(..z|
+00000070  2c 5e 05 c6 53                                    |,^..S|
 >>> Flow 14 (server to client)
-00000000  14 03 03 00 11 f0 39 a2  95 5c ed d1 ae 22 c3 30  |......9..\...".0|
-00000010  ba 24 34 92 f9 2e 16 03  03 00 20 cb 3c c6 a2 59  |.$4....... .<..Y|
-00000020  0a 06 3b 51 dc f4 07 16  5f 59 55 3d 7a ff c6 a6  |..;Q...._YU=z...|
-00000030  5f c9 6f 05 ec a5 ca 26  e8 a2 98 17 03 03 00 19  |_.o....&........|
-00000040  e7 70 10 59 2a fd 3a a2  bb 68 f9 67 c5 02 ff 0f  |.p.Y*.:..h.g....|
-00000050  df 4b b9 4a af ae 99 3a  37                       |.K.J...:7|
+00000000  14 03 03 00 11 c3 73 b6  63 12 88 86 2b cb a8 94  |......s.c...+...|
+00000010  9b c4 10 9f 98 cb 16 03  03 00 20 1e 06 97 84 3f  |.......... ....?|
+00000020  7f 2e 8d 1a 81 1d da d1  f5 53 5d a4 89 9e 90 22  |.........S]...."|
+00000030  fd 14 58 d1 f7 b2 cd eb  42 2f e8 17 03 03 00 19  |..X.....B/......|
+00000040  1f e3 dc 74 9d 6b 81 43  cb 31 6b 48 31 50 15 e8  |...t.k.C.1kH1P..|
+00000050  80 f0 60 c4 43 f6 50 9a  3c                       |..`.C.P.<|
 >>> Flow 15 (client to server)
-00000000  15 03 03 00 12 5c bf f0  9d 23 49 46 1d 56 03 45  |.....\...#IF.V.E|
-00000010  73 2d d2 38 3e 7a 75                              |s-.8>zu|
+00000000  15 03 03 00 12 33 e5 90  b6 f4 60 f4 da 3f f5 c4  |.....3....`..?..|
+00000010  5c a1 a1 75 01 04 8a                              |\..u...|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected
index 91566b1a1f..f9a7a11374 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected
@@ -16,11 +16,11 @@
 000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 ef fc 56 c9 fb  |....Y...U....V..|
-00000010  4a 34 30 75 fd ee 15 a8  0c dd b5 a6 e8 80 9a 67  |J40u...........g|
-00000020  5f f7 a6 14 be 5b 9c b1  31 f2 5a 20 5a 88 e1 e8  |_....[..1.Z Z...|
-00000030  84 21 a5 0a 69 ca 66 d2  f0 9f a3 d8 fb f6 2c f6  |.!..i.f.......,.|
-00000040  44 50 b4 77 7e c0 ce 6c  f0 43 f4 9c cc a8 00 00  |DP.w~..l.C......|
+00000000  16 03 03 00 59 02 00 00  55 03 03 52 6a c1 e9 3d  |....Y...U..Rj..=|
+00000010  5e 12 f4 95 42 33 5e 56  98 6b e5 b9 c0 e2 b4 02  |^...B3^V.k......|
+00000020  3e 99 0c 26 52 66 69 35  ef 4a 66 20 bb ee b5 86  |>..&Rfi5.Jf ....|
+00000030  ec 40 54 e7 ef 93 8e cd  e4 bd c2 57 e7 2b d3 86  |.@T........W.+..|
+00000040  44 93 8f 4f 3a e3 4d eb  53 88 b0 43 cc a8 00 00  |D..O:.M.S..C....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -60,188 +60,188 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 8a a6 ee 07 46 48 fa  |........ ....FH.|
-000002d0  f5 c7 bb 6b f0 7f 4f dc  63 99 19 66 f7 8e 56 74  |...k..O.c..f..Vt|
-000002e0  a0 1c 7c da 8f 85 23 b6  4d 08 04 00 80 3f be fc  |..|...#.M....?..|
-000002f0  45 87 6d 9c 7d db e2 48  7d 48 e0 0c 8f e6 2b f2  |E.m.}..H}H....+.|
-00000300  ec 3b 7d d2 7c 23 56 cd  25 d5 1d 30 24 58 cd 4c  |.;}.|#V.%..0$X.L|
-00000310  79 dc 3d 27 d0 14 33 a2  4a ae 1b 2f 5c fa bc dc  |y.='..3.J../\...|
-00000320  80 0c 33 fa eb 04 5a 3a  f7 b5 8b f8 07 e4 b4 cf  |..3...Z:........|
-00000330  bd 13 7d 1f f6 c2 6e 75  a7 4d 59 23 c0 b8 31 b8  |..}...nu.MY#..1.|
-00000340  17 4e e6 d4 36 f1 63 29  82 70 4d ce 96 4e 7f 82  |.N..6.c).pM..N..|
-00000350  14 2d 1a e2 03 52 d5 c8  9f 97 67 73 f1 4c 00 fe  |.-...R....gs.L..|
-00000360  c1 da ba 85 6b e9 f9 0e  a2 dc 0d b8 7a 16 03 03  |....k.......z...|
+000002c0  ac 0c 00 00 a8 03 00 1d  20 dc 94 bc ee 1b 36 ac  |........ .....6.|
+000002d0  13 5f 6a b8 12 89 3b 05  8f 76 cf 1e 9c 20 2e 75  |._j...;..v... .u|
+000002e0  7c a4 f4 23 7f 74 72 97  74 08 04 00 80 b9 22 bb  ||..#.tr.t.....".|
+000002f0  8e 21 42 cd 1e 68 2c 47  f0 b1 7f 2d 26 ac 7b a6  |.!B..h,G...-&.{.|
+00000300  10 b0 a7 72 31 99 ce be  5e e3 a5 c0 18 a6 18 50  |...r1...^......P|
+00000310  d8 98 9c 0a f5 15 0f db  be 76 50 4b 09 8d f0 94  |.........vPK....|
+00000320  a3 48 23 7b d0 13 5e 2c  71 c1 8b e4 56 2b 69 88  |.H#{..^,q...V+i.|
+00000330  88 78 b4 b7 7c 0f 29 6c  73 21 b3 e5 26 a5 10 04  |.x..|.)ls!..&...|
+00000340  23 93 77 06 81 ff 23 df  06 be 82 4e ac 42 80 10  |#.w...#....N.B..|
+00000350  ea db 84 f9 96 98 8e bb  bf ab b4 b6 fc 21 88 02  |.............!..|
+00000360  49 cb a3 4c 89 ee 19 cb  4d 71 6f fc 37 16 03 03  |I..L....Mqo.7...|
 00000370  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 4e e0 f0  1b ee c0 b0 08 57 d2 62  |.... N.......W.b|
-00000040  42 9d 1c df c9 a7 1d a2  d9 f7 bc ad b3 4a 10 3d  |B............J.=|
-00000050  19 f9 86 65 62                                    |...eb|
+00000030  16 03 03 00 20 6e 65 ea  6e 03 fb f9 4e 00 8f d1  |.... ne.n...N...|
+00000040  99 24 83 3a 38 ef 28 7b  16 43 70 b5 af 0d de 37  |.$.:8.({.Cp....7|
+00000050  cd bf ac 83 09                                    |.....|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 d8 bd 04 97 4f  |.......... ....O|
-00000010  9b 65 26 89 85 0d 95 62  cf e0 b9 47 41 4b 63 f7  |.e&....b...GAKc.|
-00000020  c6 8a 3a a9 aa 4d 8c 75  a3 9f de                 |..:..M.u...|
+00000000  14 03 03 00 01 01 16 03  03 00 20 ef 39 04 ca 70  |.......... .9..p|
+00000010  71 ee f8 1b 72 10 b7 6a  89 cd 85 ee a4 81 a4 87  |q...r..j........|
+00000020  88 1b c7 5b 18 d9 95 fe  31 d9 c8                 |...[....1..|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 f2 0d 54  a8 f0 54 f5 46 34 47 62  |.......T..T.F4Gb|
-00000010  32 42 b1 e0 ee 58 3f 76  98 92 95                 |2B...X?v...|
+00000000  17 03 03 00 16 58 8c 23  1b 8d 7f 44 92 a4 5d 88  |.....X.#...D..].|
+00000010  3e ee 7c 98 90 14 b4 61  e9 5c ea                 |>.|....a.\.|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 14 9a 6f 93  24 77 ee 28 3b 10 cf bb  |......o.$w.(;...|
-00000010  26 6a a1 ce d8 c6 70 bf  ce                       |&j....p..|
+00000000  16 03 03 00 14 32 2b 55  14 4a 65 21 51 b0 72 e0  |.....2+U.Je!Q.r.|
+00000010  4c 57 b0 b1 78 0b e3 30  de                       |LW..x..0.|
 >>> Flow 7 (client to server)
-00000000  16 03 03 01 16 f6 d7 1b  74 c1 89 ef 25 7b 62 49  |........t...%{bI|
-00000010  5f 4f 95 ba 96 39 25 8e  d2 43 76 38 60 0b 38 83  |_O...9%..Cv8`.8.|
-00000020  31 72 c7 c1 7f 2c be 9f  fe c9 d2 14 84 cb 5b 67  |1r...,........[g|
-00000030  08 b5 a7 67 dc d9 f6 26  11 49 6d 91 42 0d 62 79  |...g...&.Im.B.by|
-00000040  c2 c8 9d 6a 20 44 03 ab  9b dd 05 e1 fd 7f e9 3d  |...j D.........=|
-00000050  17 c4 8c 54 66 87 e3 96  30 da 91 23 c6 47 a0 e5  |...Tf...0..#.G..|
-00000060  9d f0 b1 98 da b9 e8 56  85 b6 d6 c2 96 f7 44 f3  |.......V......D.|
-00000070  42 75 52 fc c6 b9 a4 11  86 81 c8 7b 96 7d 90 f4  |BuR........{.}..|
-00000080  ad 18 45 28 aa 3c 09 e0  63 37 f6 b7 c7 0a 2f 99  |..E(.<..c7..../.|
-00000090  68 60 3f 99 ae b3 81 ce  dd de 2f d4 77 64 47 5e  |h`?......./.wdG^|
-000000a0  43 a6 d4 fa 63 03 54 d6  d3 73 ab 97 54 04 08 e4  |C...c.T..s..T...|
-000000b0  c7 0c 5f 39 99 cf df af  9a 70 76 4d 11 f1 49 24  |.._9.....pvM..I$|
-000000c0  9e dc 63 68 41 e6 3d da  2c fd dc 07 8b 88 42 43  |..chA.=.,.....BC|
-000000d0  e9 b3 e0 8e 43 2e 43 d5  1f bc 9d b9 d3 ab e1 6f  |....C.C........o|
-000000e0  5a 4e ae 51 6d f8 93 c0  c8 68 e1 96 b2 f4 88 6a  |ZN.Qm....h.....j|
-000000f0  0a c5 f5 29 88 4e e1 42  17 a1 9c 15 5c 4d 71 a8  |...).N.B....\Mq.|
-00000100  1d 0e 24 48 06 ab ac 4b  62 d2 d9 37 55 b3 d7 76  |..$H...Kb..7U..v|
-00000110  83 4b bc 5e 03 17 f9 cf  62 97 02                 |.K.^....b..|
+00000000  16 03 03 01 16 ff 7a 5b  80 e0 cd 83 55 3d b5 97  |......z[....U=..|
+00000010  60 d2 51 1e 75 d2 5d b9  ea 2a 5f 67 43 03 7c 50  |`.Q.u.]..*_gC.|P|
+00000020  25 5d a2 81 5f fa 0f be  08 9d 80 ac 73 16 bc 64  |%].._.......s..d|
+00000030  51 54 33 09 cc 05 90 24  c0 ee 99 a9 d1 8f 1b 3e  |QT3....$.......>|
+00000040  9f 6a e8 b6 83 b0 30 fe  e6 6b 6e 37 dd 95 95 30  |.j....0..kn7...0|
+00000050  64 46 c7 fc 15 54 84 ef  3d 1a 28 2d ee 3b aa 19  |dF...T..=.(-.;..|
+00000060  60 21 f9 d1 98 04 b4 0f  08 79 34 1f aa 12 2e 60  |`!.......y4....`|
+00000070  93 ff 87 16 56 55 24 c7  96 00 3b c2 72 7f 9d 96  |....VU$...;.r...|
+00000080  8b b7 2b 50 8f 99 df f5  4c 6a 42 0a cc 2f 27 f2  |..+P....LjB../'.|
+00000090  88 6d 42 e3 20 c8 1f 01  2b fb e9 b3 aa f3 2f 02  |.mB. ...+...../.|
+000000a0  fa 78 34 38 00 0f 1d f9  c7 5a 08 ae 56 19 c2 6c  |.x48.....Z..V..l|
+000000b0  0b b0 d1 40 0d 0e 57 d2  00 be 3d 65 9c c1 86 00  |...@..W...=e....|
+000000c0  4c a5 1b a6 67 4d 39 cd  ba fe 96 3c c5 25 dd 43  |L...gM9....<.%.C|
+000000d0  7b 49 f0 b5 8a 66 46 d4  65 6b 2d da 55 13 14 48  |{I...fF.ek-.U..H|
+000000e0  76 c8 2c 3d a4 4d 7a 14  1e 70 32 06 b3 96 cd 4e  |v.,=.Mz..p2....N|
+000000f0  bd 4f 06 a8 83 ae 30 83  b6 6b 61 2e 08 73 0e 14  |.O....0..ka..s..|
+00000100  08 13 3d f0 7c ec cf 78  ff b4 25 21 15 5e 80 14  |..=.|..x..%!.^..|
+00000110  80 4f af c7 9e 44 04 33  da cb 27                 |.O...D.3..'|
 >>> Flow 8 (server to client)
-00000000  16 03 03 00 81 96 53 73  c8 b5 6a 00 4a 58 41 8f  |......Ss..j.JXA.|
-00000010  42 e6 47 47 2b bd 0e 1e  90 30 ae fa ab 88 0b 01  |B.GG+....0......|
-00000020  70 79 c4 39 f1 ee cf 98  5d 7f 0d 81 23 28 40 40  |py.9....]...#(@@|
-00000030  f8 7a 72 13 02 75 ec 68  d5 7a 11 8a 15 b6 bb 4c  |.zr..u.h.z.....L|
-00000040  9e f5 70 1c 17 b2 b5 bc  30 c5 43 d8 8f 12 d9 cb  |..p.....0.C.....|
-00000050  46 ba 02 36 dc bb b5 64  c4 9a 15 e7 ed 16 5c 74  |F..6...d......\t|
-00000060  df 53 d4 c1 f1 01 ab 71  25 b8 8e 7b e0 ae f2 3d  |.S.....q%..{...=|
-00000070  f2 cf 21 64 c2 61 34 c3  56 d7 80 9a fd 85 6e ac  |..!d.a4.V.....n.|
-00000080  a6 10 97 87 1d 06 16 03  03 02 69 53 75 f7 64 d8  |..........iSu.d.|
-00000090  34 23 ce 18 4c 68 b7 f6  0f 7d be a8 bb d0 c9 2f  |4#..Lh...}...../|
-000000a0  6a 4e b1 9d 88 ad 41 8b  a7 42 14 02 9d 8f 9d ee  |jN....A..B......|
-000000b0  f4 b0 6b d2 ac db 67 33  38 b1 5a d8 df c9 e8 f2  |..k...g38.Z.....|
-000000c0  e1 b2 08 bf fd 83 bb d9  9b 07 0c 05 c7 e5 e3 95  |................|
-000000d0  17 04 66 ad 22 c4 32 5e  2e b8 28 4a 4e 18 bf ee  |..f.".2^..(JN...|
-000000e0  60 81 a1 f5 b0 2a e3 a5  fd c0 7f b7 6f 1d 1e 9e  |`....*......o...|
-000000f0  6b 55 ec b5 e8 2a 95 b3  f1 91 40 e8 e9 49 f1 0e  |kU...*....@..I..|
-00000100  14 9a 83 be fb eb 1f 64  34 79 3e 62 6d 3b 3a fc  |.......d4y>bm;:.|
-00000110  7e 7b 5a 9e c4 f7 a2 97  50 fe a4 40 d6 6d a0 00  |~{Z.....P..@.m..|
-00000120  53 0b ae 67 54 fc 3f 4b  f3 ba eb e5 76 5b 8b 9f  |S..gT.?K....v[..|
-00000130  06 87 53 8c 23 93 57 00  dd 29 b3 60 38 1c e2 26  |..S.#.W..).`8..&|
-00000140  c7 ba 0b a4 ae db c2 3e  49 50 7e be 0b 47 75 bd  |.......>IP~..Gu.|
-00000150  bd 55 34 70 8e 99 a9 ed  a9 50 e7 d3 6b c2 a2 63  |.U4p.....P..k..c|
-00000160  29 73 6e 0e 22 26 92 72  71 8d b1 d6 d1 e4 98 b1  |)sn."&.rq.......|
-00000170  a4 94 73 f4 39 1b bc 6d  58 fc 4f b3 e4 24 e7 75  |..s.9..mX.O..$.u|
-00000180  48 92 f7 be 15 06 36 15  1a 30 a5 65 10 4d 45 fe  |H.....6..0.e.ME.|
-00000190  75 6d 2f a5 52 2c 71 f6  c2 e0 9e 6f 1c 7e ce f3  |um/.R,q....o.~..|
-000001a0  81 23 7e 73 c3 56 e3 26  d3 d0 d4 a5 69 05 3a 94  |.#~s.V.&....i.:.|
-000001b0  0c 4c 31 27 e3 4c ad 1a  77 db 85 4c ad ca f1 ce  |.L1'.L..w..L....|
-000001c0  5c 25 57 4b 3c 5f 58 e9  15 dc aa 3b 30 f4 72 44  |\%WK<_X....;0.rD|
-000001d0  0c 2c e3 ed bc f9 0b ef  8e e6 57 ae 6c fa ca 89  |.,........W.l...|
-000001e0  b6 91 ec 90 d6 40 65 ea  c2 33 32 d9 93 76 82 0c  |.....@e..32..v..|
-000001f0  06 a7 e1 33 e7 7a 01 23  8f cb 6a 4b 2d 0b eb a5  |...3.z.#..jK-...|
-00000200  f0 80 1a fb c4 ec 05 b8  ef c9 58 6f a4 12 87 b5  |..........Xo....|
-00000210  18 cc c0 64 5f 41 7c e3  a7 98 50 1c 68 ca 8a 89  |...d_A|...P.h...|
-00000220  c0 c8 1b 77 28 11 54 9e  5d 38 14 c5 ac 50 4c 9d  |...w(.T.]8...PL.|
-00000230  2c 72 6e 0e 98 9b 2d 29  3a 81 62 05 96 23 c8 9e  |,rn...-):.b..#..|
-00000240  bd 27 cf 16 60 e2 77 8c  af 7a 08 05 cd 2c 06 8f  |.'..`.w..z...,..|
-00000250  52 6a b1 82 ad dc 60 56  0f bd 71 1d 2c a0 4b d3  |Rj....`V..q.,.K.|
-00000260  03 1e c3 75 21 8b 8c d3  cb bb 0b 8f 9c 44 43 a4  |...u!........DC.|
-00000270  2e d8 35 2c 3d ab 0b c9  3a 23 54 45 df 48 59 ab  |..5,=...:#TE.HY.|
-00000280  df 8a bc b6 e2 68 97 64  d7 f4 9f bd c4 a0 45 9c  |.....h.d......E.|
-00000290  7d 4f 00 ce 98 60 c2 3e  4f af cd 55 27 e8 57 ef  |}O...`.>O..U'.W.|
-000002a0  5e 81 58 90 60 e3 7c ca  0a 81 fa 47 38 dc d3 6f  |^.X.`.|....G8..o|
-000002b0  3e 6e c4 62 eb 91 aa 2b  42 f3 46 8f 57 a4 b3 5a  |>n.b...+B.F.W..Z|
-000002c0  ef 5b 80 82 12 05 40 6a  63 69 53 be 20 16 ab e7  |.[....@jciS. ...|
-000002d0  72 f7 79 a6 d9 d1 46 33  2f a3 34 f8 c1 60 06 98  |r.y...F3/.4..`..|
-000002e0  10 47 3c e2 95 31 b5 69  b8 9e f0 15 2b e0 7c 22  |.G<..1.i....+.|"|
-000002f0  1b b8 e1 b6 16 03 03 00  bc 3b 1a 18 ff 2c a5 9f  |.........;...,..|
-00000300  0b 79 13 81 1f e8 df 9e  9c 95 57 50 9d 53 32 5f  |.y........WP.S2_|
-00000310  27 4b aa ca 8e 7c fb 7e  69 27 06 7c aa 7d 73 ba  |'K...|.~i'.|.}s.|
-00000320  05 d2 f6 d7 61 87 3f d5  12 b6 13 75 09 bf d2 44  |....a.?....u...D|
-00000330  d3 e7 c4 86 f9 4c 9e e7  1c 5b 3c 14 5d 0d fd f4  |.....L...[<.]...|
-00000340  03 9a 24 5c a2 fd 84 7c  2e 76 8a 15 ff 7a ad 74  |..$\...|.v...z.t|
-00000350  27 a8 ec 87 65 fc a9 f0  58 36 bd 42 54 e8 fd 89  |'...e...X6.BT...|
-00000360  62 fc 74 c2 c3 4e 54 2e  49 34 b8 08 09 da d8 75  |b.t..NT.I4.....u|
-00000370  0f 49 eb 06 9d f3 f1 29  0d db 58 1c 3e 78 8c f6  |.I.....)..X.>x..|
-00000380  3c 7a 3b b8 d0 14 57 21  96 9f 75 44 d3 5d 3c 24  |<z;...W!..uD.]<$|
-00000390  5e 16 83 8d 89 10 53 89  f8 ed 91 25 76 c8 63 f1  |^.....S....%v.c.|
-000003a0  56 c9 c4 b2 e9 c1 8c ee  73 0b 2a ca 60 cb d5 c6  |V.......s.*.`...|
-000003b0  75 70 64 99 07 16 03 03  00 4a ea 90 5d 9d 75 be  |upd......J..].u.|
-000003c0  76 0e d0 ec 72 0a 14 59  00 8a 7a 0a 9e a5 a5 bf  |v...r..Y..z.....|
-000003d0  9b 4a 12 32 26 f3 32 a3  24 64 b2 9b 89 66 d3 0a  |.J.2&.2.$d...f..|
-000003e0  64 14 44 c9 4f 17 2f 2c  ab 88 da 4e 06 5d ad 0e  |d.D.O./,...N.]..|
-000003f0  2a c1 33 6a 70 40 ec ea  14 9f b1 c0 46 df 33 bf  |*.3jp@......F.3.|
-00000400  0f 1e 7a d5 16 03 03 00  14 25 6a ab 95 71 26 8c  |..z......%j..q&.|
-00000410  7d 36 ee b2 96 02 82 20  c7 49 d1 d9 96           |}6..... .I...|
+00000000  16 03 03 00 81 f5 0b a1  9d 19 be 84 54 fd 42 47  |............T.BG|
+00000010  d9 4e f8 35 02 91 06 7e  53 5c ea 64 8b c4 34 ac  |.N.5...~S\.d..4.|
+00000020  f9 93 54 36 5d 13 d0 0d  75 9f 8f 22 20 70 17 45  |..T6]...u.." p.E|
+00000030  37 a9 ed c2 34 23 8b bc  c8 87 5f a2 ff 9c 54 48  |7...4#...._...TH|
+00000040  1b d4 85 60 39 4b 53 75  6f 65 d0 33 a7 b6 90 7d  |...`9KSuoe.3...}|
+00000050  4f 84 28 cc 59 ab af bd  85 4b 40 ed 72 ff 30 c6  |O.(.Y....K@.r.0.|
+00000060  a5 01 8b fa 03 52 7e 0d  a8 5d 86 89 9b 4e c4 05  |.....R~..]...N..|
+00000070  83 fb d4 aa f9 13 8b 06  b1 2b 89 82 12 d2 a3 e2  |.........+......|
+00000080  79 d6 6a 07 ef a0 16 03  03 02 69 65 b4 cc 90 43  |y.j.......ie...C|
+00000090  f7 6f 92 59 1b 47 32 e4  51 be 16 8c bb 7b ef 68  |.o.Y.G2.Q....{.h|
+000000a0  60 38 9c 5f 5a f6 04 da  78 1d 4e 89 a7 e9 5b e0  |`8._Z...x.N...[.|
+000000b0  27 7d 82 fa 6f 44 df 5d  59 b3 5b 4c 01 76 3e bd  |'}..oD.]Y.[L.v>.|
+000000c0  d7 b5 0b 9a 9d be d4 ec  03 9d e5 a5 e0 e2 f2 a3  |................|
+000000d0  7f b2 87 ed 09 46 b2 e1  6a e2 39 e9 82 0d fb 62  |.....F..j.9....b|
+000000e0  a4 ef 1e 29 75 96 68 da  f9 8d 75 86 df 0c 57 9c  |...)u.h...u...W.|
+000000f0  48 e9 3e de 16 ab 22 b2  6d 37 38 d6 33 44 bd 38  |H.>...".m78.3D.8|
+00000100  16 2c 49 1c 2c 17 1a 28  05 45 eb 65 44 4e 1a 02  |.,I.,..(.E.eDN..|
+00000110  fc 2f 5c c9 e8 d8 16 e6  4f 5f f4 bd b4 d7 ec 73  |./\.....O_.....s|
+00000120  2f d1 f5 5b 68 69 b6 6a  59 8e 0b 24 2d 7c 69 96  |/..[hi.jY..$-|i.|
+00000130  a6 99 66 3e 38 25 82 30  ba 1a b5 b9 66 23 ea 60  |..f>8%.0....f#.`|
+00000140  b6 30 5e f5 29 80 8a 75  fc 96 f0 af 3d d2 8e 83  |.0^.)..u....=...|
+00000150  5e 00 fc 76 1c 69 cc 2b  e8 d2 70 21 95 65 da 2c  |^..v.i.+..p!.e.,|
+00000160  ed c3 fd a4 31 de 00 e5  3a b1 81 38 fc 68 da 0f  |....1...:..8.h..|
+00000170  b0 8c 32 f4 67 08 ed 31  0d fc e1 9b 20 8c 79 99  |..2.g..1.... .y.|
+00000180  bd 52 e6 eb 27 04 a5 94  1c e9 a0 5a 18 bf 7b 59  |.R..'......Z..{Y|
+00000190  22 e6 5c 63 84 2f 0a f6  ef b8 c9 c0 cf 82 0d 07  |".\c./..........|
+000001a0  42 66 65 0b d5 5e ea 27  0d f9 de 7e 13 a9 c2 b5  |Bfe..^.'...~....|
+000001b0  ea e2 22 4f a0 13 dc 12  69 9a ec ed d4 44 b2 bc  |.."O....i....D..|
+000001c0  88 65 09 ea 50 ca d6 48  c2 f2 12 9e b3 ab 29 c5  |.e..P..H......).|
+000001d0  61 72 3d 0e 77 bd 96 d9  ff 24 4d 7f 4d 22 e0 67  |ar=.w....$M.M".g|
+000001e0  54 02 18 42 e7 78 0c 18  28 89 24 a8 4a a1 cc 70  |T..B.x..(.$.J..p|
+000001f0  a2 a1 4f ee a0 b6 1f 7e  cb 9b 20 95 1f 10 63 60  |..O....~.. ...c`|
+00000200  df fe ce 37 9e 9e ce ff  fa 49 4f 4c 5b c0 f6 35  |...7.....IOL[..5|
+00000210  b7 eb e1 ac 85 64 11 6e  83 61 6f da d9 e9 09 a6  |.....d.n.ao.....|
+00000220  10 eb c2 da 62 9c ac e0  2e 0a ff 21 2e f7 94 6d  |....b......!...m|
+00000230  a6 56 f9 1c 39 52 f3 c7  29 a9 d6 b2 8c a9 4f bf  |.V..9R..).....O.|
+00000240  62 c8 74 cb 80 3d 3e 4d  d1 25 4c 29 14 21 cd 13  |b.t..=>M.%L).!..|
+00000250  b0 92 5a ca 9b 10 f6 4c  91 6e f7 c3 55 5e 0e f0  |..Z....L.n..U^..|
+00000260  e2 8f 2f 65 f9 b8 c2 43  0c 38 45 86 22 15 ed 8f  |../e...C.8E."...|
+00000270  6b 49 ff 45 e5 59 b7 54  f8 c9 d3 b0 f6 71 82 7b  |kI.E.Y.T.....q.{|
+00000280  7d 52 be 6c 33 f2 27 5c  f8 33 96 05 64 fa b2 b9  |}R.l3.'\.3..d...|
+00000290  ae 74 23 91 46 6f 9b 42  5b 96 1c c4 1c f4 5e b0  |.t#.Fo.B[.....^.|
+000002a0  c7 78 0f f3 da d3 01 ae  25 6c c1 10 31 47 e9 0d  |.x......%l..1G..|
+000002b0  84 27 5d 5a 23 35 07 3c  2d ea e8 dc cd d3 c6 85  |.']Z#5.<-.......|
+000002c0  86 ff 48 07 b8 97 d5 c5  10 f4 47 46 af 87 d9 03  |..H.......GF....|
+000002d0  24 3d b0 80 33 46 2a 4d  15 77 5c 21 3c a4 13 99  |$=..3F*M.w\!<...|
+000002e0  6c 9e ce 69 81 2e 90 c9  ba 9a 95 91 30 cc 8d 9b  |l..i........0...|
+000002f0  6c 55 c4 09 16 03 03 00  bc 30 d3 15 d7 3b 42 a9  |lU.......0...;B.|
+00000300  9b a2 1f c8 ff 90 43 4c  0f 9c 4e 59 98 23 a2 9e  |......CL..NY.#..|
+00000310  17 e0 ea 06 ae 8f 23 e6  85 f9 ca 80 39 34 78 a3  |......#.....94x.|
+00000320  7b 7e 61 88 86 35 e3 8e  a3 61 2d f9 24 6e e4 b1  |{~a..5...a-.$n..|
+00000330  c2 7d 56 bc 9d e0 12 3d  e5 90 10 b9 39 d5 64 6b  |.}V....=....9.dk|
+00000340  a8 91 75 d7 95 e7 e6 ce  8f 11 b0 66 87 f5 48 5d  |..u........f..H]|
+00000350  c9 a1 56 b1 71 e9 74 5f  48 a6 06 32 dc 66 7b 0b  |..V.q.t_H..2.f{.|
+00000360  85 66 36 e9 d3 13 2d d8  60 8c b2 89 c5 2a de b7  |.f6...-.`....*..|
+00000370  48 63 e0 8e 27 65 3a 01  6f be 75 45 ec 2a 61 c4  |Hc..'e:.o.uE.*a.|
+00000380  a8 0b cf 95 93 a2 d6 27  fa 71 82 92 3a 95 39 a7  |.......'.q..:.9.|
+00000390  fc e5 33 e3 f2 0e a4 94  94 bb e6 65 25 3a 6f 6e  |..3........e%:on|
+000003a0  da a0 6d fc 57 2b 46 f8  ab 55 0e 5a 1e 56 92 68  |..m.W+F..U.Z.V.h|
+000003b0  7e 88 f4 d0 b2 16 03 03  00 4a 08 e0 60 21 59 5d  |~........J..`!Y]|
+000003c0  29 3e ba b9 1d 13 3a a0  e3 b2 76 39 29 00 92 d0  |)>....:...v9)...|
+000003d0  24 a6 d9 fd e2 2b c8 5d  6b 78 ea 75 ce 68 93 1b  |$....+.]kx.u.h..|
+000003e0  3b b8 59 e4 6b 60 5b 4a  28 7a e9 1d 04 72 a8 e0  |;.Y.k`[J(z...r..|
+000003f0  64 31 e4 86 da a9 f2 00  36 55 bd 56 02 d4 b3 48  |d1......6U.V...H|
+00000400  a7 21 69 11 16 03 03 00  14 44 1c 39 61 56 3d 7e  |.!i......D.9aV=~|
+00000410  ca dd cb 34 06 10 4f 5f  32 45 63 c1 98           |...4..O_2Ec..|
 >>> Flow 9 (client to server)
-00000000  16 03 03 02 69 3a 4c e1  16 19 be 83 57 cf 43 19  |....i:L.....W.C.|
-00000010  c9 1c 20 a3 43 21 4f b7  3f a3 82 1b 20 98 88 e3  |.. .C!O.?... ...|
-00000020  ef 6d d8 3d 7e 1e 80 e7  f3 39 0a 87 e8 cd 90 16  |.m.=~....9......|
-00000030  45 04 c5 0f 4d bf 63 5b  16 50 74 66 8b 3c 27 49  |E...M.c[.Ptf.<'I|
-00000040  54 7f f1 7f f7 b7 fe 1a  c4 14 46 5f f7 d5 ab 36  |T.........F_...6|
-00000050  8c 39 09 b9 9e b4 99 3f  4b 90 cc 64 cf 4e c9 a9  |.9.....?K..d.N..|
-00000060  82 7f 7a bc fa 50 3b bf  be c3 11 95 cc 88 06 ab  |..z..P;.........|
-00000070  1c 1f 95 8a a0 2a a0 6b  61 ee ee 32 06 5e 4b d2  |.....*.ka..2.^K.|
-00000080  d1 ef 70 ef 54 5f 26 0e  e3 a4 63 6b 0c 46 f3 91  |..p.T_&...ck.F..|
-00000090  a5 ce a2 69 2a d1 0e 73  04 d2 4a 3e 58 bb ad e8  |...i*..s..J>X...|
-000000a0  38 fc 6c 6f ad 6a 1a 4c  7f 1e f7 04 70 94 4d 62  |8.lo.j.L....p.Mb|
-000000b0  ed 3d ea 1e 36 d0 83 24  43 a1 1a 89 bd f6 18 6a  |.=..6..$C......j|
-000000c0  8f 31 40 1a ec 8e 18 1e  db 60 fc 76 e3 5b 20 8b  |.1@......`.v.[ .|
-000000d0  ef 61 bb 49 e2 5b 60 fe  9f 9e 22 d1 3d 1f ac 2d  |.a.I.[`...".=..-|
-000000e0  11 91 ed 38 6f f1 25 ef  6d 3a 49 52 7f 2f f1 b1  |...8o.%.m:IR./..|
-000000f0  f6 68 df aa 9c 3e 60 a7  cc 19 35 65 04 5d 7f 37  |.h...>`...5e.].7|
-00000100  86 10 14 01 17 38 1e 91  ab 3c 20 3a 13 2d ea cc  |.....8...< :.-..|
-00000110  be 79 54 76 32 e7 b2 0d  e9 f7 50 66 94 02 7d c6  |.yTv2.....Pf..}.|
-00000120  4b 02 34 92 12 93 18 56  6b a4 61 4f 5b 6f 8f 7c  |K.4....Vk.aO[o.||
-00000130  fc 80 5b cb 3e ac df b1  2d c3 85 9e 55 9b 15 22  |..[.>...-...U.."|
-00000140  46 54 e4 5c 23 35 20 05  e1 b8 89 44 57 4f dd ef  |FT.\#5 ....DWO..|
-00000150  d8 33 36 c9 d8 d6 e0 71  61 a7 e9 ff 2a cf 7c a2  |.36....qa...*.|.|
-00000160  f8 e0 78 57 d2 21 d8 07  8c 51 4b 16 83 f9 49 5a  |..xW.!...QK...IZ|
-00000170  86 ae 68 d2 b3 d3 06 42  c8 56 a5 77 56 4f 3a e8  |..h....B.V.wVO:.|
-00000180  3f ab de 12 82 1f 87 11  ef c3 fa b9 20 0b e1 e0  |?........... ...|
-00000190  1d bd 96 3e e9 f5 a4 96  79 e5 1e 3e 7e 6e cb b3  |...>....y..>~n..|
-000001a0  08 f8 ea 85 ca a2 bb a2  ef ca 8f c2 31 9a a8 56  |............1..V|
-000001b0  b1 d3 a6 dd 63 0c 1d ad  ae 69 da b2 11 77 fe 81  |....c....i...w..|
-000001c0  c1 37 34 ed 9a 3c fe 09  3a 3b 6d cd d3 45 63 cb  |.74..<..:;m..Ec.|
-000001d0  99 cc d9 88 95 0a fe 58  47 9a 14 a2 16 c0 e1 96  |.......XG.......|
-000001e0  5e 4f 8f fa a4 d5 2c c6  43 aa 94 1f 1b 90 5d 03  |^O....,.C.....].|
-000001f0  18 f3 2a f3 a3 14 44 0b  df 51 8b 66 8f dd 7f 65  |..*...D..Q.f...e|
-00000200  c6 ee 9a 60 8b b9 af ab  26 9e 5f 6a c8 dc 66 d1  |...`....&._j..f.|
-00000210  d1 58 26 9c 58 86 2d fb  98 cd 70 c5 db 37 db b2  |.X&.X.-...p..7..|
-00000220  22 bb 00 fe f4 87 68 58  22 f3 15 24 ed 89 fe db  |".....hX"..$....|
-00000230  dd 52 e5 3f 4f 90 ab fd  4b e4 e4 70 35 d3 28 72  |.R.?O...K..p5.(r|
-00000240  05 08 af fb 7c ba 63 3f  c1 a0 32 48 00 6a 6f 6c  |....|.c?..2H.jol|
-00000250  77 a1 c9 0e 23 e2 7d 6a  9b 9a 04 4e fb 6e db 53  |w...#.}j...N.n.S|
-00000260  ba 5a c1 79 ee 13 2c 8b  dd 79 5d 5b 0e b1 16 03  |.Z.y..,..y][....|
-00000270  03 00 35 a4 5c 1d bc be  f0 32 77 49 96 7e 92 b7  |..5.\....2wI.~..|
-00000280  74 d9 96 8c 86 c8 06 e6  08 6e 20 47 14 2d 9e 98  |t........n G.-..|
-00000290  ab 28 fa 26 a6 48 d4 1a  06 41 34 74 15 bd 54 bb  |.(.&.H...A4t..T.|
-000002a0  7d fc 30 10 a9 12 3a 6d  16 03 03 00 98 9d 61 7e  |}.0...:m......a~|
-000002b0  6a 9e 2a 7f 9c ff 25 6b  0d 01 1b 34 ad 00 d1 b5  |j.*...%k...4....|
-000002c0  0b 5f 0c d3 43 ca aa 61  e9 44 a7 e5 18 0d 85 87  |._..C..a.D......|
-000002d0  5f 96 7a 80 ac 56 20 19  1d 62 39 84 9e e1 a4 62  |_.z..V ..b9....b|
-000002e0  a1 bf c3 b3 9d da 1b a5  39 cb 58 2f 28 fb 57 5b  |........9.X/(.W[|
-000002f0  94 d0 49 67 f3 c0 c1 83  5b 92 04 f9 1a 6a 3b 7e  |..Ig....[....j;~|
-00000300  c8 51 d5 fb ab c3 45 44  f1 6a 07 b5 09 94 f3 4c  |.Q....ED.j.....L|
-00000310  55 27 12 3d fc 07 b3 e0  dd f5 df e9 00 f1 cb 42  |U'.=...........B|
-00000320  e0 f7 55 51 43 f6 7e 1b  62 83 e5 71 75 8e e2 1a  |..UQC.~.b..qu...|
-00000330  e0 b6 00 48 44 cf 33 fd  72 7e 91 dc d4 b9 9d cc  |...HD.3.r~......|
-00000340  29 9e e2 97 a8 14 03 03  00 11 53 e5 86 22 41 e7  |).........S.."A.|
-00000350  f0 ad 61 5c 0b d9 b5 b2  15 0f 0a 16 03 03 00 20  |..a\........... |
-00000360  d3 d8 b8 47 4a 73 3c b3  41 e3 0b a7 51 67 ca ba  |...GJs<.A...Qg..|
-00000370  57 9b 38 07 2a 76 06 2c  b3 24 6a 82 cf bf da 37  |W.8.*v.,.$j....7|
+00000000  16 03 03 02 69 68 d9 de  2a 4d 03 fe 05 cc b8 d3  |....ih..*M......|
+00000010  c8 f0 3d df 1c 73 f1 bd  55 08 45 c4 2a 6b a1 c8  |..=..s..U.E.*k..|
+00000020  35 7d 56 b7 b9 15 63 ba  09 31 59 8b f8 ce a0 f8  |5}V...c..1Y.....|
+00000030  1b 3b 5f 5e 1c 3d bb 26  43 cb 7b f3 ba 3b a2 38  |.;_^.=.&C.{..;.8|
+00000040  a3 d5 bd 0b 65 16 7c e3  79 cc ed 17 04 34 60 e7  |....e.|.y....4`.|
+00000050  1e 60 52 72 13 e4 6b ef  32 99 86 94 49 30 47 df  |.`Rr..k.2...I0G.|
+00000060  e2 6c 6d 3f 6c 19 e4 4e  b9 df 42 e3 c8 47 2c d0  |.lm?l..N..B..G,.|
+00000070  be 2c 94 3b 1d 3e 3a b3  06 67 c3 25 9b 24 4e 8e  |.,.;.>:..g.%.$N.|
+00000080  dc c7 50 ab 72 bd b4 d1  ff f7 3f 6d 13 89 55 8c  |..P.r.....?m..U.|
+00000090  14 a1 ae fe ad a0 bb 8f  fe 51 ac 5b eb 23 3d d0  |.........Q.[.#=.|
+000000a0  9e b8 5e 34 8c dd 47 79  9c 73 f5 6b 47 ff 10 7d  |..^4..Gy.s.kG..}|
+000000b0  ac 1d a7 54 5e b5 0f 75  86 67 13 70 d5 66 da 55  |...T^..u.g.p.f.U|
+000000c0  0b 48 a0 88 ae f9 81 92  33 0b 29 79 42 f7 c2 98  |.H......3.)yB...|
+000000d0  2c 2f 32 c7 df 35 ff 4a  44 10 fa 9f 66 ce 4b 9a  |,/2..5.JD...f.K.|
+000000e0  3c 5b b3 7d ac 3b 9a 68  bb 40 3d 36 6b 72 98 c5  |<[.}.;.h.@=6kr..|
+000000f0  85 3c b0 75 1c d6 45 0f  f9 4d 26 2d ec 67 90 ed  |.<.u..E..M&-.g..|
+00000100  88 33 92 7d 99 22 c4 08  90 64 17 1e 06 03 d5 a3  |.3.}."...d......|
+00000110  72 a6 92 99 d3 c8 46 9f  e7 f9 15 bb dd ba e5 f7  |r.....F.........|
+00000120  d9 06 af 5c 1c a0 03 c7  fe 51 b5 41 0c 8f 6d ad  |...\.....Q.A..m.|
+00000130  f2 41 23 a5 44 38 8a bb  b3 d9 3c e8 5e 99 98 23  |.A#.D8....<.^..#|
+00000140  9c 87 3d f8 10 df 58 c2  dd b9 2c 7e 56 a1 75 84  |..=...X...,~V.u.|
+00000150  a2 e5 66 20 58 ed fe f7  04 ff 93 e0 6e 9f 1e f3  |..f X.......n...|
+00000160  a9 8a 9a 37 38 d2 7c 4d  74 88 f5 bd 2b 5a 05 bc  |...78.|Mt...+Z..|
+00000170  53 a1 48 ab 98 ca 91 bb  fa f3 62 a9 0a fa 89 e6  |S.H.......b.....|
+00000180  22 06 1d 59 72 32 51 d6  f6 de e8 89 b6 eb 96 f2  |"..Yr2Q.........|
+00000190  4d e0 82 0d b8 ec a7 09  84 79 18 70 3e 09 ba 9a  |M........y.p>...|
+000001a0  98 27 13 e8 e6 e5 9d 7c  df 4d 42 a8 41 be 62 e0  |.'.....|.MB.A.b.|
+000001b0  1d 48 24 5d 35 e5 a5 ff  f5 67 85 cf b8 53 e1 5e  |.H$]5....g...S.^|
+000001c0  dd 82 40 9e d3 94 fd 7b  1b b3 13 d8 98 a8 1f 21  |..@....{.......!|
+000001d0  1a 04 5a df 3c 8f 3a c0  dc 86 8b e1 39 0a 03 8e  |..Z.<.:.....9...|
+000001e0  8c 9a 4c d5 15 32 2d 1c  0f ad 43 25 e6 5a 77 f9  |..L..2-...C%.Zw.|
+000001f0  2d e5 a0 a0 b2 32 43 0f  11 55 bb c2 e1 c6 45 2a  |-....2C..U....E*|
+00000200  da a0 6c 14 49 0f a7 d7  40 b1 1a c8 72 2a a8 26  |..l.I...@...r*.&|
+00000210  45 f4 66 9a e0 42 aa 25  ac 28 ec 8c a2 df 48 cc  |E.f..B.%.(....H.|
+00000220  c3 a9 9e 9e af 38 88 82  43 8f 99 02 79 90 3e d9  |.....8..C...y.>.|
+00000230  9e d0 75 a5 95 83 ec 44  2b 13 1c d8 eb 3f 2c 5d  |..u....D+....?,]|
+00000240  1b 7e e2 fe 47 89 08 5b  58 dc 3d ea 32 5e a1 af  |.~..G..[X.=.2^..|
+00000250  c5 e8 90 b8 28 4b 58 55  34 46 ef 2a d6 a0 9b 0b  |....(KXU4F.*....|
+00000260  73 b9 8b b4 38 63 08 92  03 4c 8c 12 be a8 16 03  |s...8c...L......|
+00000270  03 00 35 f5 3c 22 cc bc  cf c3 ad 84 1d dc f4 b6  |..5.<"..........|
+00000280  e0 4a 1c b9 e5 d8 a6 b7  a2 8c fb 40 11 12 40 5c  |.J.........@..@\|
+00000290  e2 f4 ce ac 83 93 69 71  19 85 43 19 9e 30 ee 97  |......iq..C..0..|
+000002a0  02 8e 69 8f 4d 1d 2c 0f  16 03 03 00 98 94 e4 82  |..i.M.,.........|
+000002b0  1d 6b d2 ce 76 6d 68 55  db bb 91 73 6e e9 73 05  |.k..vmhU...sn.s.|
+000002c0  6a d3 eb 48 f1 d7 f6 52  ba 49 6a f2 f7 74 c8 56  |j..H...R.Ij..t.V|
+000002d0  ba f5 e5 97 cb a0 b7 ab  37 2c ff 7a a6 42 e6 78  |........7,.z.B.x|
+000002e0  51 8a 9c bf fa 05 b7 66  04 6d 83 d1 0d e8 18 d0  |Q......f.m......|
+000002f0  f2 b3 4d 4d 2d c0 f7 ac  d1 55 b8 03 d7 dc d7 c2  |..MM-....U......|
+00000300  73 72 54 c9 29 e4 98 29  a3 95 11 7e 56 52 87 09  |srT.)..)...~VR..|
+00000310  05 fe 74 e2 f1 74 c7 f6  f2 28 4f 2c 24 92 ac ae  |..t..t...(O,$...|
+00000320  1c df 4e f9 db ce 3c db  48 60 6b 4d 12 9c f7 de  |..N...<.H`kM....|
+00000330  26 73 25 d2 e7 d1 2e fd  b5 5e c4 66 2a 60 4a 04  |&s%......^.f*`J.|
+00000340  2d b9 6c b1 d2 14 03 03  00 11 58 08 81 e4 4d c4  |-.l.......X...M.|
+00000350  93 47 e2 45 e2 44 73 36  3a fe ba 16 03 03 00 20  |.G.E.Ds6:...... |
+00000360  25 2d 76 2c 22 34 e9 ed  11 a5 84 ee d3 63 df 17  |%-v,"4.......c..|
+00000370  88 be 86 7c 51 35 fb 7e  aa a6 b9 a2 02 59 f7 00  |...|Q5.~.....Y..|
 >>> Flow 10 (server to client)
-00000000  14 03 03 00 11 9a a1 96  36 69 58 ba 18 5d ee 45  |........6iX..].E|
-00000010  66 02 f4 3b f8 ba 16 03  03 00 20 cf 43 d1 45 30  |f..;...... .C.E0|
-00000020  cf b9 99 27 36 a9 a1 0b  2d ab ab 14 c1 ec 97 f9  |...'6...-.......|
-00000030  e5 01 c9 81 eb f9 78 5b  82 44 05 17 03 03 00 19  |......x[.D......|
-00000040  5f c9 75 6f 23 fe 04 a6  e8 34 5f eb fb fd fd 3c  |_.uo#....4_....<|
-00000050  f6 c6 8e 64 3a 8d 35 92  d8 16 03 03 00 14 90 95  |...d:.5.........|
-00000060  39 68 e7 49 6e f6 58 7c  bd 14 76 f1 a5 fe 83 21  |9h.In.X|..v....!|
-00000070  b3 67                                             |.g|
+00000000  14 03 03 00 11 bb 91 ed  b9 75 be 6c 2c b8 7c 57  |.........u.l,.|W|
+00000010  0b 44 2e 6d 68 4a 16 03  03 00 20 49 17 51 ce 23  |.D.mhJ.... I.Q.#|
+00000020  ff 71 ad f5 45 75 01 43  4d d2 f8 08 d8 e5 4d d7  |.q..Eu.CM.....M.|
+00000030  1c 35 5e 8b 18 54 e5 f6  0c b5 2e 17 03 03 00 19  |.5^..T..........|
+00000040  ec 43 1a 6d 9e fb 53 cd  55 1a 72 2e da d1 ea 58  |.C.m..S.U.r....X|
+00000050  66 17 a9 1c be fc d9 72  dd 16 03 03 00 14 c2 98  |f......r........|
+00000060  a4 ac d5 0c a2 10 61 8b  55 3a 69 b6 26 33 4f fe  |......a.U:i.&3O.|
+00000070  2d 42                                             |-B|
 >>> Flow 11 (client to server)
-00000000  15 03 03 00 12 18 02 52  db f2 60 de 38 62 3a 06  |.......R..`.8b:.|
-00000010  7b 6d 84 74 cf ae d5 15  03 03 00 12 fd 06 4d b1  |{m.t..........M.|
-00000020  f8 71 8c b8 13 cc 9e 40  be 76 96 60 54 b7        |.q.....@.v.`T.|
+00000000  15 03 03 00 12 d4 c8 e4  36 30 00 40 d1 d5 9a 9d  |........60.@....|
+00000010  3c 2d eb 4f e0 6e a3 15  03 03 00 12 4d b6 67 e4  |<-.O.n......M.g.|
+00000020  02 d0 89 50 ef 4b 8a 1f  49 f2 f0 14 b6 7e        |...P.K..I....~|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-RSAPSS b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-RSAPSS
index e44b5a3848..9488dd6b66 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-RSAPSS
+++ b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-RSAPSS
@@ -16,121 +16,128 @@
 000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 e9 53 0e 37 17  |....z...v...S.7.|
-00000010  22 a6 ae 2f 8b 85 d4 fe  3b e1 2d 22 d1 69 3c 4b  |"../....;.-".i<K|
-00000020  d2 7a e0 21 cf b3 13 4b  19 a1 ab 20 00 00 00 00  |.z.!...K... ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 6d 36 ae 02 a9  |....z...v..m6...|
+00000010  74 ad e5 4d 55 b6 4a 70  c6 f5 cf d5 68 d9 2a 5f  |t..MU.Jp....h.*_|
+00000020  9b 4b 23 ce 38 9b f3 da  44 72 7d 20 00 00 00 00  |.K#.8...Dr} ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 01 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 cd  |..+.....3.$... .|
-00000060  ed 35 e9 13 4f 33 e4 00  74 42 28 a4 4b 76 2c 1a  |.5..O3..tB(.Kv,.|
-00000070  1f bb 16 c4 d5 52 18 1d  1a 40 24 44 37 8f 1d 14  |.....R...@$D7...|
-00000080  03 03 00 01 01 17 03 03  00 17 e5 c2 93 dd 16 d9  |................|
-00000090  46 44 02 74 74 6f fd 68  e8 27 c3 eb 3b 88 f7 f2  |FD.tto.h.'..;...|
-000000a0  e5 17 03 03 00 20 bd 88  a3 32 1c 4d 78 02 94 08  |..... ...2.Mx...|
-000000b0  50 fb d4 42 43 16 fe ae  5f f9 7e a1 b2 a6 bf 66  |P..BC..._.~....f|
-000000c0  f5 14 60 62 24 a3 17 03  03 02 7a 73 89 14 01 fc  |..`b$.....zs....|
-000000d0  d0 81 73 49 d6 56 81 85  ea 7e 2a d1 45 07 dc 69  |..sI.V...~*.E..i|
-000000e0  ed 89 66 4c 24 ab f1 ff  da 21 cc a1 e5 9e a1 87  |..fL$....!......|
-000000f0  c4 e1 b7 8c da 60 14 f8  ca b5 4f ca 2f ea db 6d  |.....`....O./..m|
-00000100  7b f8 61 2e a9 ce ba da  39 ce 02 b9 85 84 40 e5  |{.a.....9.....@.|
-00000110  22 54 84 44 5d 82 54 89  32 9b 4c 7b 93 92 84 c8  |"T.D].T.2.L{....|
-00000120  6b 1c c9 c4 0f 7c 4c 20  5f 29 65 e8 fe 2c 0a 8e  |k....|L _)e..,..|
-00000130  7e 6f f1 bc 17 c9 d4 c7  c3 27 94 03 97 e5 79 9c  |~o.......'....y.|
-00000140  ac 81 1a d5 3a 1a f8 2b  b7 a7 37 3f ba 3a 27 7f  |....:..+..7?.:'.|
-00000150  99 11 1b 71 32 bc 6a 81  c7 ce e1 ba 5e 58 6b ea  |...q2.j.....^Xk.|
-00000160  94 1d ce 35 99 31 e4 53  99 24 18 2e f4 56 57 bc  |...5.1.S.$...VW.|
-00000170  af 07 79 a1 a1 42 29 2a  a7 b2 eb 44 d6 f8 45 1b  |..y..B)*...D..E.|
-00000180  3a c1 53 c7 32 15 91 11  0c e8 3f ca 3d c6 51 97  |:.S.2.....?.=.Q.|
-00000190  0a 1a d4 31 6a e5 f8 58  52 be f3 d2 2d a2 e2 d0  |...1j..XR...-...|
-000001a0  0e 54 a2 2e 74 dc d4 2e  15 fc e5 f3 b4 c9 1c 2e  |.T..t...........|
-000001b0  8b df cc e6 8f a2 6a 63  f2 06 0a 3d cd cb 99 66  |......jc...=...f|
-000001c0  1c 6c 86 59 0c 85 00 54  9c 45 96 98 b4 d8 b5 2a  |.l.Y...T.E.....*|
-000001d0  34 a4 4a 71 d6 4b a3 4b  29 80 61 7c 6c 8b f1 65  |4.Jq.K.K).a|l..e|
-000001e0  ac 14 02 52 52 cb e0 16  16 32 a4 b9 ae 13 1f d3  |...RR....2......|
-000001f0  6e 0e da 9f 84 42 96 98  8a d6 6b 06 a3 8d 4c 26  |n....B....k...L&|
-00000200  f5 8a 8a 79 78 4d 60 c4  58 e3 4c 78 c9 7c fb 83  |...yxM`.X.Lx.|..|
-00000210  5e 8a 3b 14 66 22 eb 7b  56 67 d4 0e c6 d5 3e 59  |^.;.f".{Vg....>Y|
-00000220  b7 40 13 8e a4 dd 16 57  d1 8e 2b e3 40 57 eb b0  |.@.....W..+.@W..|
-00000230  10 03 43 4a 30 0c e7 7f  df 33 66 40 13 c7 7c ca  |..CJ0....3f@..|.|
-00000240  fc 71 e4 75 8d 78 09 05  70 34 80 a9 27 6a a1 1b  |.q.u.x..p4..'j..|
-00000250  6d 7e a1 60 81 70 52 c2  1b f6 f3 f0 92 3c 50 45  |m~.`.pR......<PE|
-00000260  0e 93 94 97 75 fd 59 db  77 21 93 bd 7e 28 47 ae  |....u.Y.w!..~(G.|
-00000270  98 d6 71 15 83 fa c3 41  fd f7 73 4f 94 bb 2e 81  |..q....A..sO....|
-00000280  7a 85 b0 59 46 32 96 f5  98 b2 26 8d 12 93 ea a8  |z..YF2....&.....|
-00000290  3a 54 5f 8d 07 81 b1 9b  73 c3 d7 1a 2b bb cc 55  |:T_.....s...+..U|
-000002a0  a4 e6 9f 6f 2e d4 ea 68  90 e4 8f bd 40 61 2d 74  |...o...h....@a-t|
-000002b0  b1 4e 29 01 54 e6 2a 1a  7f 20 82 4d 43 f9 66 7c  |.N).T.*.. .MC.f||
-000002c0  9e 81 57 ca f2 57 c6 1b  c9 50 43 2a 5f e3 4c c3  |..W..W...PC*_.L.|
-000002d0  8d e6 00 08 83 4a 20 d7  a6 94 37 96 84 58 9a 37  |.....J ...7..X.7|
-000002e0  49 b9 21 ba f0 f5 8a d4  f9 8e d2 44 17 36 5e d7  |I.!........D.6^.|
-000002f0  09 f6 e0 e7 f5 00 ac ac  d2 07 02 12 11 80 29 78  |..............)x|
-00000300  11 37 82 1c bc 03 a7 52  31 4d 1f 5e 2c 26 b7 fd  |.7.....R1M.^,&..|
-00000310  30 ec b1 99 58 69 0e a6  8a f5 2b d8 56 17 fd 4a  |0...Xi....+.V..J|
-00000320  a9 7f 38 b1 20 cd 50 7e  6e e5 f4 4b d5 d8 37 dc  |..8. .P~n..K..7.|
-00000330  7a 03 ef 33 a4 0b f5 08  e5 e8 fc c7 a6 9e 75 c1  |z..3..........u.|
-00000340  ba f6 41 70 84 17 03 03  00 99 dc 79 0c be 28 e7  |..Ap.......y..(.|
-00000350  85 bc dd 09 3a bc 9a e0  ee 34 7d d6 0a ed 60 90  |....:....4}...`.|
-00000360  29 89 ef eb a4 c1 4e aa  3d 96 4a 87 7e e6 9f 27  |).....N.=.J.~..'|
-00000370  3d 36 d6 d4 04 6e 21 9d  58 bc bf 3a 24 61 cd 94  |=6...n!.X..:$a..|
-00000380  dc 68 6c fb 04 83 79 32  62 5d 1c 53 0e ae 76 ab  |.hl...y2b].S..v.|
-00000390  56 77 b1 c3 a7 49 2b dd  17 8e b5 45 53 df 2f 85  |Vw...I+....ES./.|
-000003a0  d4 bc ab 74 ee 9c 03 13  ac 3f 20 f5 91 41 2a 0c  |...t.....? ..A*.|
-000003b0  ea e9 b2 77 e7 ec 28 37  f2 25 54 a5 b8 cf 8e 43  |...w..(7.%T....C|
-000003c0  a1 f4 de b9 f1 f4 5a be  82 b1 cb f0 ab b9 20 ba  |......Z....... .|
-000003d0  64 55 36 2a 76 e2 01 6c  32 4b b6 7e 46 6a a1 9f  |dU6*v..l2K.~Fj..|
-000003e0  5a 5a 0a 17 03 03 00 35  24 bb c3 e7 46 28 2b 24  |ZZ.....5$...F(+$|
-000003f0  75 92 13 48 84 0c ac 79  99 50 a8 f6 3b a4 fa a5  |u..H...y.P..;...|
-00000400  c0 ce 82 51 8e c4 3e 83  55 15 d0 80 69 be 42 f8  |...Q..>.U...i.B.|
-00000410  d3 38 62 a5 95 e2 a4 35  03 43 04 c7 6e           |.8b....5.C..n|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 ba  |..+.....3.$... .|
+00000060  2a 76 cb fb 6c 6b bb 30  fb ef 87 6f e5 06 5c 6f  |*v..lk.0...o..\o|
+00000070  78 a7 44 41 93 c0 33 89  be 32 8c 0f fa 5c 43 14  |x.DA..3..2...\C.|
+00000080  03 03 00 01 01 17 03 03  00 17 ac 3e 8a 31 22 16  |...........>.1".|
+00000090  d3 69 bf 1d b5 2e 18 23  b3 21 00 17 23 a4 3f 9a  |.i.....#.!..#.?.|
+000000a0  0b 17 03 03 00 20 aa f0  51 64 b5 44 f0 28 ab 56  |..... ..Qd.D.(.V|
+000000b0  da 34 2d 62 77 4d 88 07  b6 82 ad 64 df e6 59 c9  |.4-bwM.....d..Y.|
+000000c0  91 e5 f8 f2 67 88 17 03  03 02 7a cf 2d 71 db 3f  |....g.....z.-q.?|
+000000d0  05 45 b8 68 18 1c b9 66  b6 00 f8 dc 9d ae e5 d2  |.E.h...f........|
+000000e0  a3 a8 02 5f ac e4 95 a6  fc 96 78 7b fd 0a 21 62  |..._......x{..!b|
+000000f0  ff 7c 15 2c fb f1 21 15  1e 8d 9e f9 71 62 43 e4  |.|.,..!.....qbC.|
+00000100  c9 69 e4 fe 87 f0 9d 9e  aa a4 5c d8 4e ae 3c 38  |.i........\.N.<8|
+00000110  e5 76 21 7b 03 a8 70 6f  e8 96 39 34 e7 3c b9 51  |.v!{..po..94.<.Q|
+00000120  b4 ef ce 7d 0b 1e 57 7d  62 de 47 6a 0a b0 97 6d  |...}..W}b.Gj...m|
+00000130  49 fe ae 6f c9 d6 e4 4a  54 60 3d 55 53 06 aa 28  |I..o...JT`=US..(|
+00000140  7a 3e 7b e0 d1 8a 60 45  87 81 bf fc 98 13 1e de  |z>{...`E........|
+00000150  7a 90 73 81 13 91 3a c4  da 71 74 e0 1d d5 30 55  |z.s...:..qt...0U|
+00000160  46 6a 48 c2 0c 18 91 a3  79 8e c2 b9 5b 24 88 76  |FjH.....y...[$.v|
+00000170  5f e6 8f 24 91 95 5b 0d  38 39 5b a4 f6 0e 1a b8  |_..$..[.89[.....|
+00000180  e8 2b 0d ac a8 56 10 23  54 a5 78 c9 2a cb ed 24  |.+...V.#T.x.*..$|
+00000190  58 16 1a 2f 1c b7 72 fc  da ab 56 f6 27 d1 98 39  |X../..r...V.'..9|
+000001a0  1f f9 dd e0 1f 1f 23 1a  ff 6b af e1 17 9d ec 35  |......#..k.....5|
+000001b0  de 0b 4d a4 46 5a fd 07  56 ce 72 19 76 dc 0c 06  |..M.FZ..V.r.v...|
+000001c0  99 38 ce 58 3b 9f 13 9a  d5 b7 d6 08 a6 05 4d e1  |.8.X;.........M.|
+000001d0  75 da 59 4d ab d9 28 e8  af c4 50 f0 b1 49 f8 fd  |u.YM..(...P..I..|
+000001e0  c9 11 b8 01 70 bb 49 e2  0f 26 1b cb ee c2 7b bd  |....p.I..&....{.|
+000001f0  2f 72 78 be a1 67 1d 0c  d0 bb 4e e7 40 b3 bd 8c  |/rx..g....N.@...|
+00000200  e2 f4 4f b2 c5 4c 82 49  51 00 44 17 c6 82 72 f5  |..O..L.IQ.D...r.|
+00000210  cd 55 c1 43 28 52 85 2b  5d 91 33 9c 15 34 6e ae  |.U.C(R.+].3..4n.|
+00000220  77 4e 08 0c 9c d2 ae 7f  e8 83 af 60 96 10 ae dc  |wN.........`....|
+00000230  58 6a 3b ae 15 e5 9c a8  25 f3 69 71 f7 94 9c 75  |Xj;.....%.iq...u|
+00000240  e0 b5 05 16 ae ce f4 23  20 30 aa 74 a3 63 68 76  |.......# 0.t.chv|
+00000250  f6 ec 64 e1 3d f6 0e b6  c4 7d a8 08 44 a9 96 1d  |..d.=....}..D...|
+00000260  7d c8 22 a8 df 04 2c ad  65 f1 4c 99 7d a1 cb bd  |}."...,.e.L.}...|
+00000270  b7 d4 d7 b5 ee 88 bd 15  2e 75 76 e2 72 bb 7d e6  |.........uv.r.}.|
+00000280  5b eb fc f7 96 96 f0 3c  aa b6 a8 58 92 e9 29 f6  |[......<...X..).|
+00000290  40 bf 8e 14 23 7c 45 da  e9 17 4b 32 16 11 ec 74  |@...#|E...K2...t|
+000002a0  78 d5 8c 5a 06 46 e4 dc  90 b9 44 8e d6 8a 4e 43  |x..Z.F....D...NC|
+000002b0  7f f9 60 9e a1 46 fa 16  88 ab 3c f1 1e d0 2e 00  |..`..F....<.....|
+000002c0  5d 01 e6 a7 b1 27 f7 40  26 17 f3 da fb cd 06 d1  |]....'.@&.......|
+000002d0  4e 27 75 9a 6f 0b 63 82  9c 40 07 4c 6e 0d d8 4b  |N'u.o.c..@.Ln..K|
+000002e0  f1 e6 d5 1c 41 55 72 b5  43 24 53 1e 0e a4 08 d7  |....AUr.C$S.....|
+000002f0  44 93 00 c9 8b 49 ba 7a  32 0c d8 e6 46 87 5d 62  |D....I.z2...F.]b|
+00000300  9d 4a 11 04 67 21 19 42  50 ad ad ab dd 62 0f f7  |.J..g!.BP....b..|
+00000310  0f 57 78 82 71 f6 09 9f  41 bc 8e 34 24 7c b5 d2  |.Wx.q...A..4$|..|
+00000320  5d 0c 18 fb d8 f6 62 dc  57 6a 78 2c 21 35 d8 eb  |].....b.Wjx,!5..|
+00000330  bb f8 7e 01 63 50 c1 98  88 a4 b5 63 1e c0 68 3c  |..~.cP.....c..h<|
+00000340  41 3c b8 6e 48 17 03 03  00 99 b6 09 37 a6 c2 d9  |A<.nH.......7...|
+00000350  5f 39 69 e1 0b ca 40 d8  31 5b 4b 4f c1 33 bf 1f  |_9i...@.1[KO.3..|
+00000360  db c2 8c 9c d2 14 26 96  4e aa b2 63 30 40 fa 49  |......&.N..c0@.I|
+00000370  fb 2d 66 59 70 cb c7 f8  fe 59 19 8b eb d5 5c 6c  |.-fYp....Y....\l|
+00000380  5c a0 c9 ba e6 4d d9 c3  e0 fe 00 c4 fb ab 8a f1  |\....M..........|
+00000390  2b ab 53 86 a7 86 57 01  b8 ae c4 a6 12 6b 7d f8  |+.S...W......k}.|
+000003a0  ea 2d df 37 04 01 eb 14  f4 9a d0 e7 67 46 ec 9f  |.-.7........gF..|
+000003b0  35 f8 d4 2e c6 95 91 10  0e dc 01 60 9a d6 f8 d8  |5..........`....|
+000003c0  9e c1 fd f8 2e e2 51 8a  e9 2f c3 4a 4f 01 31 52  |......Q../.JO.1R|
+000003d0  af cb 4b 52 96 4c 90 57  83 1f 11 97 d6 d6 16 74  |..KR.L.W.......t|
+000003e0  77 f8 c4 17 03 03 00 35  b0 61 57 8f 52 7e 93 b1  |w......5.aW.R~..|
+000003f0  f0 90 a1 23 09 6e 11 ff  a5 6c 38 f3 31 11 be 03  |...#.n...l8.1...|
+00000400  ad 59 65 57 1b 60 2b fc  41 98 e0 79 6d 14 26 c8  |.YeW.`+.A..ym.&.|
+00000410  fb d6 5f 00 e0 cc 70 46  a3 81 e4 3c ff           |.._...pF...<.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 02 11 ee 25 34 95 80  |............%4..|
-00000010  b9 4f 23 e2 2b ed 34 ad  c8 35 e2 d1 4d 99 e1 15  |.O#.+.4..5..M...|
-00000020  5a 9a 39 79 80 1e ec 0d  24 3b 07 d8 9d e6 0c 82  |Z.9y....$;......|
-00000030  5b 42 f3 37 66 6d 41 8a  0f f8 7c 53 8d 5d 5a c2  |[B.7fmA...|S.]Z.|
-00000040  9e 7f 5e 54 1c 36 85 64  fe f3 4f b3 36 92 f1 fd  |..^T.6.d..O.6...|
-00000050  08 73 22 7a 20 37 f9 d1  1e 16 21 7e ea 4f 6a cb  |.s"z 7....!~.Oj.|
-00000060  89 19 13 4b 1a 50 49 a9  fe a6 eb 12 ac 0e 78 dc  |...K.PI.......x.|
-00000070  b8 02 d4 35 0d 2f 46 f2  97 74 2c f9 61 eb 03 f4  |...5./F..t,.a...|
-00000080  4e f7 98 69 46 ff 78 e1  9f e9 89 27 8e 83 b3 2f  |N..iF.x....'.../|
-00000090  ff 24 26 41 ad 6a dd 71  d9 b9 05 56 ea 73 d8 e9  |.$&A.j.q...V.s..|
-000000a0  11 fb 0f 64 b6 c0 57 90  6b 5b e7 7c 8d a2 40 b2  |...d..W.k[.|..@.|
-000000b0  8a 18 87 1a ec 45 cc 68  df 89 c6 93 32 2f de 7a  |.....E.h....2/.z|
-000000c0  72 ce ae 75 bb a8 37 f9  8d 75 87 e4 12 6a 59 ad  |r..u..7..u...jY.|
-000000d0  a8 3b 26 27 ab c4 1e e2  ba 42 11 6a f2 ba eb 9b  |.;&'.....B.j....|
-000000e0  3b 93 c5 9a 3d e2 20 28  92 35 60 86 27 95 c5 4a  |;...=. (.5`.'..J|
-000000f0  e3 4d b2 35 6d 64 2f 08  7d d8 c0 c5 ef 3f e0 24  |.M.5md/.}....?.$|
-00000100  64 37 d7 a6 13 6d ee ee  7f dc b8 80 5d 95 d3 84  |d7...m......]...|
-00000110  8a 4a 30 59 d9 9f 23 0f  c4 ab d7 6b cc 26 2c 4b  |.J0Y..#....k.&,K|
-00000120  b8 7f f1 f3 eb d6 10 c5  50 22 a3 45 2d 20 a4 39  |........P".E- .9|
-00000130  99 d7 1b ae 12 83 bf 75  52 56 f1 17 ee 1c e4 4f  |.......uRV.....O|
-00000140  ef b5 c2 cb 64 28 48 7a  69 d6 18 33 83 e2 70 ed  |....d(Hzi..3..p.|
-00000150  65 36 6c 4d 91 1f 61 88  d4 55 3a 09 cf d6 45 88  |e6lM..a..U:...E.|
-00000160  82 69 ce bd 63 63 3e 43  68 6b b9 6e ed 2d 4f 13  |.i..cc>Chk.n.-O.|
-00000170  89 3d d3 f4 05 19 b4 35  b1 33 84 d9 71 cc 7f 03  |.=.....5.3..q...|
-00000180  2a 77 32 be c3 ab 2d db  aa c7 99 b0 a0 29 a7 d7  |*w2...-......)..|
-00000190  9c f6 84 8d 4f 99 79 c0  52 2b 2a f1 a8 f1 85 bc  |....O.y.R+*.....|
-000001a0  b3 5f 3f de b8 df e2 e0  ac f4 f1 11 c4 c5 c5 45  |._?............E|
-000001b0  24 19 0c 8f fd ca e2 80  f8 91 2d 1c cc 5e c8 8b  |$.........-..^..|
-000001c0  c1 49 96 d5 3e 17 e3 cd  a0 38 8d aa 20 d2 12 81  |.I..>....8.. ...|
-000001d0  ff 11 a8 e6 93 77 34 a5  ab 40 a2 75 01 f8 c5 f3  |.....w4..@.u....|
-000001e0  0d e0 cc 7b b8 d1 0f d6  0d 34 a1 58 67 47 8e 47  |...{.....4.XgG.G|
-000001f0  45 89 74 de 77 3c 65 d2  5e 60 35 a1 a7 85 0a 82  |E.t.w<e.^`5.....|
-00000200  94 dd 4c 04 fb c8 79 dc  e1 bb ff e3 4b 13 c9 05  |..L...y.....K...|
-00000210  f4 7c cb 1c 3c 5b 0e 44  70 72 b1 23 17 03 03 00  |.|..<[.Dpr.#....|
-00000220  99 63 f0 14 1c 39 a3 63  ae 0b b9 11 12 2f 51 96  |.c...9.c...../Q.|
-00000230  81 4c 52 36 c1 c6 c2 d2  a5 b4 e2 6a 25 c6 15 1a  |.LR6.......j%...|
-00000240  a4 6d cc 5e 32 98 0c 1b  26 f8 4b a5 b9 ec d5 b3  |.m.^2...&.K.....|
-00000250  b5 1a 92 12 d8 7a f8 b6  e7 47 04 ee 34 04 b8 5a  |.....z...G..4..Z|
-00000260  0d c9 fe 6e 8e fc 1f 68  b7 56 1d 5a 5a c4 31 ba  |...n...h.V.ZZ.1.|
-00000270  91 29 0e 82 b7 07 f5 55  f3 e6 1b be d6 ca e1 d7  |.).....U........|
-00000280  bf 8a c4 d1 33 66 8c 17  f1 b7 f5 32 a4 d2 8b b0  |....3f.....2....|
-00000290  a0 31 39 92 07 18 11 2e  6d 2a 46 89 64 a3 4b 04  |.19.....m*F.d.K.|
-000002a0  a4 b3 b6 af dc f5 3c b0  b0 8f 03 b8 55 f3 c0 06  |......<.....U...|
-000002b0  fd 6c d0 5b 29 87 b7 43  6c 61 17 03 03 00 35 b1  |.l.[)..Cla....5.|
-000002c0  55 fd ca 21 e1 18 19 44  0d ae 22 e7 6f 92 48 29  |U..!...D..".o.H)|
-000002d0  7d 4b 34 e7 c4 2a 58 0c  70 19 9f 83 95 39 92 7a  |}K4..*X.p....9.z|
-000002e0  35 b4 ef 19 d2 f4 56 98  d7 4b e6 2d 9d 70 7b 32  |5.....V..K.-.p{2|
-000002f0  b6 35 6e af 17 03 03 00  17 26 80 b7 91 78 00 1b  |.5n......&...x..|
-00000300  3e 5d 8c 06 fa d5 b7 44  05 16 05 42 ad d5 cf 8c  |>].....D...B....|
-00000310  17 03 03 00 13 ee 2f 0d  a2 33 1f 9a ca 26 43 e8  |....../..3...&C.|
-00000320  8b 1d 41 0d 11 c9 2d 8a                           |..A...-.|
+00000000  14 03 03 00 01 01 17 03  03 02 7a 22 a3 3d 18 f8  |..........z".=..|
+00000010  a2 c7 8e 62 c3 07 99 b4  e6 bd 94 79 12 82 e9 e0  |...b.......y....|
+00000020  96 ff 5f c3 ec 34 02 2f  8d 95 2f 40 80 99 19 a3  |.._..4./../@....|
+00000030  bd 64 fd e4 0e b3 81 ad  4c 2e d9 72 d2 a3 bd 00  |.d......L..r....|
+00000040  81 42 78 5d f3 70 c3 78  0b fa cd b8 96 17 5e e7  |.Bx].p.x......^.|
+00000050  6e 03 b8 c6 ab 2b 2e 63  45 c7 b1 c9 98 71 c9 1d  |n....+.cE....q..|
+00000060  bb 7b 6e 6d c7 d5 90 b8  b2 4e 62 1a 8f cf 7d 99  |.{nm.....Nb...}.|
+00000070  52 3d 70 40 0f 0f 96 1c  ee a7 ff 29 2a 53 de d4  |R=p@.......)*S..|
+00000080  34 f9 d9 b2 33 2c 69 5e  2d f2 a7 62 dd ec 77 b1  |4...3,i^-..b..w.|
+00000090  6c 0f 61 86 8a bc 11 1f  91 ad f4 94 de 96 dd ef  |l.a.............|
+000000a0  d8 be 5e 45 50 fe af 1a  03 54 20 f6 05 8e a3 b0  |..^EP....T .....|
+000000b0  f7 31 93 f3 78 59 4d 54  50 99 a5 a1 53 81 1b 5d  |.1..xYMTP...S..]|
+000000c0  6d ea 32 e9 52 ab 83 d6  18 3f 2f 43 cd 64 ac 3f  |m.2.R....?/C.d.?|
+000000d0  11 6c 91 0d fa 86 f8 a5  12 eb 41 ac 24 2d 79 5b  |.l........A.$-y[|
+000000e0  ee 8e 02 46 f0 37 0a b1  19 c7 97 ed 97 d1 11 18  |...F.7..........|
+000000f0  df 80 8f f3 d7 61 a4 fe  6c ec b0 80 4e bc e4 52  |.....a..l...N..R|
+00000100  10 2f b1 6f 3f d4 39 08  81 f6 01 4b b4 d4 d5 20  |./.o?.9....K... |
+00000110  6b a1 be e6 cf c7 0e 95  e9 d7 00 07 63 25 1b 64  |k...........c%.d|
+00000120  4b b7 c4 79 29 84 45 45  5d 0d fe 72 2a 7e c6 bf  |K..y).EE]..r*~..|
+00000130  5a 98 ec e2 16 26 82 57  eb a6 dc ff 73 b6 e8 4c  |Z....&.W....s..L|
+00000140  87 52 e5 0a c1 6a 6f 02  69 17 17 ea e0 1c c1 07  |.R...jo.i.......|
+00000150  b4 f4 78 a7 99 39 8b 63  61 c2 7e 99 f4 64 16 d6  |..x..9.ca.~..d..|
+00000160  0a 84 9a 0f d4 f4 bd 4d  d4 4f 16 ec 19 30 a7 34  |.......M.O...0.4|
+00000170  f9 b9 60 10 39 25 ee 9d  bd 99 37 52 e6 32 a1 c9  |..`.9%....7R.2..|
+00000180  68 9b a2 4e 16 91 0e 54  54 d5 c5 77 bb 01 ba af  |h..N...TT..w....|
+00000190  97 be ea 09 85 91 69 84  4f 2c 04 f0 38 50 93 49  |......i.O,..8P.I|
+000001a0  e7 41 cb c1 d6 b6 77 59  09 7c 1e 0a 58 93 1e b4  |.A....wY.|..X...|
+000001b0  cf ed 32 85 b0 cd 6f 86  c7 94 8c 30 9d 83 a2 a0  |..2...o....0....|
+000001c0  4a de ad 8c b9 d8 58 d3  8c 34 6b 12 54 f1 28 66  |J.....X..4k.T.(f|
+000001d0  ea 55 d9 95 d0 b6 b3 aa  68 c3 31 e1 8f 1b f8 43  |.U......h.1....C|
+000001e0  51 b9 06 fc 53 69 9b 1c  e6 2c f8 b7 f0 47 4a 5a  |Q...Si...,...GJZ|
+000001f0  82 ca 27 df 0f 3d f8 79  90 8d c2 bd 27 85 74 6b  |..'..=.y....'.tk|
+00000200  9e 8b eb 74 a8 28 ba 6a  25 16 01 2c 56 3b c0 fa  |...t.(.j%..,V;..|
+00000210  91 ac af a7 c5 39 8d 2c  b1 f3 a2 c9 a5 72 c6 ff  |.....9.,.....r..|
+00000220  49 a0 78 14 5c 8c d2 71  de b9 4f 55 3a ca b6 a5  |I.x.\..q..OU:...|
+00000230  df ce bb f7 c2 d5 af 2c  c0 97 08 82 cc b4 02 26  |.......,.......&|
+00000240  c3 0c 99 39 4a df 6c d6  59 14 c4 d6 04 9d a4 92  |...9J.l.Y.......|
+00000250  d2 53 42 16 56 99 5f c2  82 a0 a8 5a 92 53 e6 b1  |.SB.V._....Z.S..|
+00000260  cd fc bc 9a b9 55 0b ae  2c 50 ce a3 bf d2 7d d2  |.....U..,P....}.|
+00000270  2b 58 ba 87 65 33 09 cf  74 51 0f 4b 4f a9 53 0d  |+X..e3..tQ.KO.S.|
+00000280  fa 60 1e ba e6 17 03 03  00 99 aa 43 d9 e2 e4 91  |.`.........C....|
+00000290  cf 65 fa 35 0e b0 21 51  9d c4 33 f5 7c 09 ff e5  |.e.5..!Q..3.|...|
+000002a0  db fd 6e 96 6d 13 7c 4c  ec 90 72 bd 54 6a 3f d8  |..n.m.|L..r.Tj?.|
+000002b0  1a a3 e2 a2 01 6b d6 50  a0 b1 d5 67 34 44 42 30  |.....k.P...g4DB0|
+000002c0  97 2e 82 07 46 04 56 0a  43 4b 9d 8c 81 64 bb 0b  |....F.V.CK...d..|
+000002d0  21 62 ea 23 0b 1c a0 c4  b2 cc 2f 51 b5 a2 9a a3  |!b.#....../Q....|
+000002e0  37 d3 0c 57 80 85 77 3b  8d 17 f1 a9 d5 ae 72 f9  |7..W..w;......r.|
+000002f0  cd 8c c4 2c fb c7 e0 f0  3a 5c d5 6a f7 8f 7e 53  |...,....:\.j..~S|
+00000300  c1 d0 7a b0 8d c9 b3 17  7c 99 df 54 d6 43 13 d5  |..z.....|..T.C..|
+00000310  78 9c 34 7e c9 11 4e e7  1c 8c f4 0f 82 89 94 61  |x.4~..N........a|
+00000320  80 d2 49 17 03 03 00 35  aa cd 97 5a a2 d3 27 78  |..I....5...Z..'x|
+00000330  d4 79 28 a7 57 dc 4f b1  2d b8 bd 3c ae ec e6 be  |.y(.W.O.-..<....|
+00000340  33 be b9 20 3b 69 22 03  31 34 7a 8d 68 39 c7 d5  |3.. ;i".14z.h9..|
+00000350  a1 a0 aa 46 15 94 93 d7  54 41 5b 6b 20 17 03 03  |...F....TA[k ...|
+00000360  00 17 f2 60 ff 91 c2 85  55 ed ab 39 6f 5d 0f 22  |...`....U..9o]."|
+00000370  45 3e 61 07 14 a3 05 f4  94 17 03 03 00 13 01 ea  |E>a.............|
+00000380  95 52 29 1c 63 71 3a 2d  73 a7 29 31 2c d0 ce 9f  |.R).cq:-s.)1,...|
+00000390  2b                                                |+|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ALPN b/src/crypto/tls/testdata/Server-TLSv12-ALPN
index ec9bf72436..0d9f63b006 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ALPN
+++ b/src/crypto/tls/testdata/Server-TLSv12-ALPN
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 e3 01 00 00  df 03 03 2d 48 5c c5 05  |...........-H\..|
-00000010  19 52 14 d8 ed 53 5d 30  50 4d 3a ae d9 58 53 96  |.R...S]0PM:..XS.|
-00000020  0a ce fb 18 ed ef f1 57  fe 42 75 00 00 38 c0 2c  |.......W.Bu..8.,|
+00000000  16 03 01 00 e3 01 00 00  df 03 03 24 c0 b7 bd da  |...........$....|
+00000010  2a 23 bd 6f a0 8f 94 be  7c 14 56 ad fd a8 87 3f  |*#.o....|.V....?|
+00000020  c1 97 38 14 7a d4 30 28  11 c4 b5 00 00 38 c0 2c  |..8.z.0(.....8.,|
 00000030  c0 30 00 9f cc a9 cc a8  cc aa c0 2b c0 2f 00 9e  |.0.........+./..|
 00000040  c0 24 c0 28 00 6b c0 23  c0 27 00 67 c0 0a c0 14  |.$.(.k.#.'.g....|
 00000050  00 39 c0 09 c0 13 00 33  00 9d 00 9c 00 3d 00 3c  |.9.....3.....=.<|
@@ -60,37 +60,37 @@
 000002a0  d3 3b e9 fa e7 16 03 03  00 ac 0c 00 00 a8 03 00  |.;..............|
 000002b0  1d 20 2f e5 7d a3 47 cd  62 43 15 28 da ac 5f bb  |. /.}.G.bC.(.._.|
 000002c0  29 07 30 ff f6 84 af c4  cf c2 ed 90 99 5f 58 cb  |).0.........._X.|
-000002d0  3b 74 08 04 00 80 0a 5e  25 64 2c 25 6d 9d 7d da  |;t.....^%d,%m.}.|
-000002e0  18 0a 9b ff c7 6a 0b 89  ed f8 96 00 70 6f ab 35  |.....j......po.5|
-000002f0  d3 3b 56 cc a1 78 c8 60  4e 50 12 1a 59 02 d9 4c  |.;V..x.`NP..Y..L|
-00000300  07 21 03 65 62 9c a4 06  2d ce 34 68 c8 01 57 f1  |.!.eb...-.4h..W.|
-00000310  b5 33 a0 00 72 9f e8 46  87 7c 18 65 e2 2a 18 5e  |.3..r..F.|.e.*.^|
-00000320  d3 9d 60 bc cf b8 38 10  2d 21 c0 9e 2c 5d 89 4c  |..`...8.-!..,].L|
-00000330  93 27 02 6b 5a 04 02 60  b0 f0 3f 7c 54 aa 9a f1  |.'.kZ..`..?|T...|
-00000340  30 10 50 31 36 0e 87 0c  86 29 53 92 3b 91 24 72  |0.P16....)S.;.$r|
-00000350  79 6d 5c 09 15 19 16 03  03 00 04 0e 00 00 00     |ym\............|
+000002d0  3b 74 04 01 00 80 8a b8  11 46 fc 88 8d f3 7d 22  |;t.......F....}"|
+000002e0  e0 1e d6 ac 45 79 e7 4d  fa 46 df 6d a2 b2 67 38  |....Ey.M.F.m..g8|
+000002f0  73 73 d9 20 9e 7c a1 a0  01 0c e7 e3 08 b2 f9 db  |ss. .|..........|
+00000300  97 82 c9 1e 27 33 f6 69  5b 8d 3c ca a8 a3 34 d5  |....'3.i[.<...4.|
+00000310  70 ac f6 62 6e 80 5d 5b  6e 1e bd 2d 27 d2 6d c3  |p..bn.][n..-'.m.|
+00000320  ca 08 8c fc ea 94 d2 99  49 d8 5f 30 6a a2 d9 c4  |........I._0j...|
+00000330  f2 17 d9 50 9e 82 9c 95  93 6d 7c b6 18 16 84 92  |...P.....m|.....|
+00000340  31 29 bd a0 df ed 09 ab  bf 32 ca c5 26 67 bb 28  |1).......2..&g.(|
+00000350  78 1b c6 5b 7a 21 16 03  03 00 04 0e 00 00 00     |x..[z!.........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 2e 56 a8 73 0e 9c  |....%...! .V.s..|
-00000010  90 0d aa 07 77 a8 09 17  61 e2 11 5c 3a f6 33 6d  |....w...a..\:.3m|
-00000020  be 6b 08 77 8a 0d eb 68  2f 21 14 03 03 00 01 01  |.k.w...h/!......|
-00000030  16 03 03 00 28 a7 07 30  a2 67 4f 2d 2f 5f 52 7c  |....(..0.gO-/_R||
-00000040  11 81 d0 ea 37 51 73 8a  fc 35 fc 58 b2 e6 6b b7  |....7Qs..5.X..k.|
-00000050  66 a9 f0 cf 16 e7 31 b6  83 58 d3 e4 58           |f.....1..X..X|
+00000000  16 03 03 00 25 10 00 00  21 20 69 44 46 d1 ad ea  |....%...! iDF...|
+00000010  ac b6 dc 35 6a b1 06 77  57 e8 94 58 49 15 4b 35  |...5j..wW..XI.K5|
+00000020  7c c9 40 a0 75 37 f0 77  79 0c 14 03 03 00 01 01  ||.@.u7.wy.......|
+00000030  16 03 03 00 28 2d 84 08  73 fc f7 b7 8d 07 63 4a  |....(-..s.....cJ|
+00000040  c4 42 37 b6 cd e1 87 9f  4f 3b 4e 8c a5 3f 95 67  |.B7.....O;N..?.g|
+00000050  74 02 9a f1 d1 39 0c 7b  7b 8e 82 79 28           |t....9.{{..y(|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 82 04 00 00  7e 00 00 00 00 00 78 50  |........~.....xP|
 00000010  46 ad c1 db a8 38 86 7b  2b bb fd d0 c3 42 3e 00  |F....8.{+....B>.|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000030  6f ec 80 83 61 8a 3f 4b  ad 3f 5f 7d 74 f9 cc 19  |o...a.?K.?_}t...|
-00000040  2b 27 d5 b0 1b 12 9a 8c  82 0f e5 b5 99 f8 0d 10  |+'..............|
-00000050  88 4a b2 65 62 bc a0 c2  2d 97 79 ad 69 58 08 fa  |.J.eb...-.y.iX..|
-00000060  6e 3b a7 b5 cb 33 94 de  ff b6 49 87 3d d4 c7 0d  |n;...3....I.=...|
-00000070  65 a6 a7 66 f9 40 27 b1  e2 28 9a b2 db 82 ab 0f  |e..f.@'..(......|
-00000080  d8 f6 10 ab f7 d3 d9 14  03 03 00 01 01 16 03 03  |................|
-00000090  00 28 00 00 00 00 00 00  00 00 09 75 fa e0 ab f5  |.(.........u....|
-000000a0  d4 57 a8 a0 0d 15 d1 25  1f b4 f3 2e 39 a3 91 75  |.W.....%....9..u|
-000000b0  5c 37 5e 26 61 6b 95 2f  41 8a 17 03 03 00 25 00  |\7^&ak./A.....%.|
-000000c0  00 00 00 00 00 00 01 64  6b d0 f8 a2 9c 0f 95 11  |.......dk.......|
-000000d0  e6 05 f2 3c 24 c0 d2 95  7f f1 cc 65 ef 5c 6d 80  |...<$......e.\m.|
-000000e0  1d c9 67 f5 15 03 03 00  1a 00 00 00 00 00 00 00  |..g.............|
-000000f0  02 f2 91 0d 39 58 1d 72  61 6e 60 36 96 03 1e 63  |....9X.ran`6...c|
-00000100  e4 d1 4c                                          |..L|
+00000030  6f ec 80 83 61 f2 44 31  c6 93 15 b9 27 68 bc ab  |o...a.D1....'h..|
+00000040  b1 7f 48 8d 99 54 9c 9c  2e 36 11 6f 38 e7 3f 79  |..H..T...6.o8.?y|
+00000050  f9 f1 a5 5d 36 9a 1a 4c  7c f2 ad 84 f4 13 a7 be  |...]6..L|.......|
+00000060  e4 79 39 c6 31 33 94 81  cf d3 85 2e 29 02 44 a8  |.y9.13......).D.|
+00000070  61 4d 70 c3 dd ed b4 a2  f2 4b 44 c0 d5 af 19 8b  |aMp......KD.....|
+00000080  3f e5 fa fa ba dd 2d 14  03 03 00 01 01 16 03 03  |?.....-.........|
+00000090  00 28 00 00 00 00 00 00  00 00 f0 16 42 20 de 60  |.(..........B .`|
+000000a0  a4 a7 12 85 e5 cb b6 53  eb 76 7f 89 62 76 e8 46  |.......S.v..bv.F|
+000000b0  69 a6 bd 1e f5 5e 13 18  1d d3 17 03 03 00 25 00  |i....^........%.|
+000000c0  00 00 00 00 00 00 01 47  51 00 3f dd 64 0c 6f 43  |.......GQ.?.d.oC|
+000000d0  d1 cb 25 22 45 af ee 64  5f a7 6e cf 6c 7e 26 b3  |..%"E..d_.n.l~&.|
+000000e0  7e cd f0 71 15 03 03 00  1a 00 00 00 00 00 00 00  |~..q............|
+000000f0  02 01 f4 16 18 8e 29 27  34 58 c4 9a f8 a7 58 3a  |......)'4X....X:|
+00000100  2e 4a 32                                          |.J2|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ALPN-NoMatch b/src/crypto/tls/testdata/Server-TLSv12-ALPN-NoMatch
index 90f146b5ba..ced69a2acf 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ALPN-NoMatch
+++ b/src/crypto/tls/testdata/Server-TLSv12-ALPN-NoMatch
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 e3 01 00 00  df 03 03 fc a5 8d 79 5f  |..............y_|
-00000010  01 7f 77 df 86 0f 60 10  0a 88 ad 68 7f 7b 3b 63  |..w...`....h.{;c|
-00000020  46 a9 7e c6 4e 7c 47 b5  00 2f a7 00 00 38 c0 2c  |F.~.N|G../...8.,|
+00000000  16 03 01 00 e3 01 00 00  df 03 03 c8 61 61 3d 4e  |............aa=N|
+00000010  9a 5e 9e 0c 59 3f 23 e0  d8 ac d9 28 27 41 6a a0  |.^..Y?#....('Aj.|
+00000020  fb 7e d3 5f 20 aa 40 6c  df cb 07 00 00 38 c0 2c  |.~._ .@l.....8.,|
 00000030  c0 30 00 9f cc a9 cc a8  cc aa c0 2b c0 2f 00 9e  |.0.........+./..|
 00000040  c0 24 c0 28 00 6b c0 23  c0 27 00 67 c0 0a c0 14  |.$.(.k.#.'.g....|
 00000050  00 39 c0 09 c0 13 00 33  00 9d 00 9c 00 3d 00 3c  |.9.....3.....=.<|
@@ -59,38 +59,38 @@
 00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 ac 0c 00 00  |.\!.;...........|
 000002a0  a8 03 00 1d 20 2f e5 7d  a3 47 cd 62 43 15 28 da  |.... /.}.G.bC.(.|
 000002b0  ac 5f bb 29 07 30 ff f6  84 af c4 cf c2 ed 90 99  |._.).0..........|
-000002c0  5f 58 cb 3b 74 08 04 00  80 62 db d2 f4 17 c6 f2  |_X.;t....b......|
-000002d0  73 d1 63 50 1f 26 96 af  9d bd cb 11 9a 95 c4 dd  |s.cP.&..........|
-000002e0  49 c3 9a 06 a3 8d 2a 1e  b9 74 76 22 36 2e fd 08  |I.....*..tv"6...|
-000002f0  a6 d1 9d 2e 20 75 e6 50  59 49 db 3f d9 b1 0e 81  |.... u.PYI.?....|
-00000300  fb 16 25 67 0d 8b 1c af  35 95 59 d4 56 b2 9f 08  |..%g....5.Y.V...|
-00000310  fd 85 68 46 30 59 2b 66  9e 86 b4 35 4c 4a 9f 6f  |..hF0Y+f...5LJ.o|
-00000320  8f 2b 8d 9f 19 c2 9a 4e  91 6e fe 56 cc 9b 39 e7  |.+.....N.n.V..9.|
-00000330  8d e2 5e 07 55 16 76 e0  7f 8b aa 0e 36 94 9f 78  |..^.U.v.....6..x|
-00000340  bd 06 a2 65 a3 f5 83 04  97 16 03 03 00 04 0e 00  |...e............|
+000002c0  5f 58 cb 3b 74 04 01 00  80 a6 d5 2b cf 48 32 3e  |_X.;t......+.H2>|
+000002d0  09 74 c1 e4 2a 69 49 d7  bc ce 5a b7 55 e5 e1 f4  |.t..*iI...Z.U...|
+000002e0  cc 3f 64 90 8a 58 e6 86  58 8b d7 94 60 d4 4e a9  |.?d..X..X...`.N.|
+000002f0  e4 e1 45 f1 7b 14 79 d0  9f 5c e3 17 79 61 f3 7a  |..E.{.y..\..ya.z|
+00000300  0e e6 cc 7c ff d8 61 29  51 eb 36 f6 f1 57 2e c0  |...|..a)Q.6..W..|
+00000310  43 de 54 fd 92 c7 d7 7a  54 77 f3 3f cf 53 b1 1f  |C.T....zTw.?.S..|
+00000320  57 53 7c 6d a3 74 b5 de  ae 0b 22 1f 2c 3e d0 41  |WS|m.t....".,>.A|
+00000330  04 7f df d8 d8 44 8d 8e  97 27 71 bc ff 6c 7f b6  |.....D...'q..l..|
+00000340  bd 05 17 2c 1f 84 c6 f1  64 16 03 03 00 04 0e 00  |...,....d.......|
 00000350  00 00                                             |..|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 56 69 9c 58 80 3e  |....%...! Vi.X.>|
-00000010  72 ee ee b1 05 fd a0 a7  8d 78 9c 5a 7d e0 21 63  |r........x.Z}.!c|
-00000020  d4 19 3c e2 b1 72 92 03  ed 6a 14 03 03 00 01 01  |..<..r...j......|
-00000030  16 03 03 00 28 6b c0 b3  6e 77 df ef 99 2d 7a 93  |....(k..nw...-z.|
-00000040  d5 9d 7f 1e 8c 36 eb 7c  bb 32 f9 a1 b0 65 b3 85  |.....6.|.2...e..|
-00000050  fb 33 64 9f 73 10 41 5a  01 6f d1 6b 73           |.3d.s.AZ.o.ks|
+00000000  16 03 03 00 25 10 00 00  21 20 c8 8e d1 4e a9 96  |....%...! ...N..|
+00000010  d4 73 45 b8 11 6e db db  00 f8 c0 c3 0e 96 62 c3  |.sE..n........b.|
+00000020  7c 04 3b 4a 40 d6 f6 81  e9 0d 14 03 03 00 01 01  ||.;J@...........|
+00000030  16 03 03 00 28 69 f9 fd  75 0d 63 bd ff 62 27 7b  |....(i..u.c..b'{|
+00000040  b2 28 b6 dc 55 c4 4b 10  f5 34 64 0d 85 a4 58 10  |.(..U.K..4d...X.|
+00000050  ee d6 93 77 00 da 6e ab  5e 9f f4 62 41           |...w..n.^..bA|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 82 04 00 00  7e 00 00 00 00 00 78 50  |........~.....xP|
 00000010  46 ad c1 db a8 38 86 7b  2b bb fd d0 c3 42 3e 00  |F....8.{+....B>.|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000030  6f ec 80 83 61 59 7e 5a  0d 70 cc 83 b5 c8 ed d4  |o...aY~Z.p......|
-00000040  79 ab 28 49 65 f8 52 5f  78 5a 83 1a d4 b6 76 fa  |y.(Ie.R_xZ....v.|
-00000050  b7 e3 ef 12 48 1b 73 42  18 ee 78 5a 4e 05 70 66  |....H.sB..xZN.pf|
-00000060  1a 51 7b 20 e0 33 94 93  4f 86 e2 54 48 67 df 11  |.Q{ .3..O..THg..|
-00000070  ca f2 6d 73 d1 06 3b 88  ef af 91 1c f0 fd 64 4f  |..ms..;.......dO|
-00000080  c8 d7 45 cb cc 90 14 14  03 03 00 01 01 16 03 03  |..E.............|
-00000090  00 28 00 00 00 00 00 00  00 00 58 a6 55 c9 de bc  |.(........X.U...|
-000000a0  04 23 e7 85 cf 8c 44 d1  da ad c2 73 45 3e 42 f0  |.#....D....sE>B.|
-000000b0  05 58 7e 7b 35 24 1c 86  93 1e 17 03 03 00 25 00  |.X~{5$........%.|
-000000c0  00 00 00 00 00 00 01 c8  90 76 8e 60 ca b3 75 47  |.........v.`..uG|
-000000d0  78 f2 5d a8 62 82 10 0f  3c b5 b6 51 d2 0b 40 40  |x.].b...<..Q..@@|
-000000e0  66 b4 82 11 15 03 03 00  1a 00 00 00 00 00 00 00  |f...............|
-000000f0  02 f4 16 23 56 26 87 e1  22 9f d3 30 e9 fa 99 a5  |...#V&.."..0....|
-00000100  f0 5b 2c                                          |.[,|
+00000030  6f ec 80 83 61 8d 11 1d  31 eb f3 00 20 b3 0f 72  |o...a...1... ..r|
+00000040  a0 7d 10 58 c8 5f da e2  cb 82 74 4d 99 0d bb 75  |.}.X._....tM...u|
+00000050  f3 cb 1a 19 11 ba 70 90  82 9e ab 73 be a9 96 58  |......p....s...X|
+00000060  96 b7 98 07 ba 33 94 81  e5 8e d1 39 08 10 01 df  |.....3.....9....|
+00000070  ba dd f7 b1 0c ce 71 96  f6 d2 8a 50 43 9a 56 b9  |......q....PC.V.|
+00000080  2c 29 d7 05 5b 0d ea 14  03 03 00 01 01 16 03 03  |,)..[...........|
+00000090  00 28 00 00 00 00 00 00  00 00 94 0f b0 0f 1a 43  |.(.............C|
+000000a0  e1 77 b5 36 55 21 8a d5  7e ae 37 eb c5 7b dc aa  |.w.6U!..~.7..{..|
+000000b0  28 1b 00 2f 31 e2 5e ca  54 89 17 03 03 00 25 00  |(../1.^.T.....%.|
+000000c0  00 00 00 00 00 00 01 eb  0e 33 bd 20 4f 18 db 26  |.........3. O..&|
+000000d0  b3 48 21 a6 87 e2 a4 1f  fe 84 ae 89 fe cf 41 20  |.H!...........A |
+000000e0  f9 d4 41 67 15 03 03 00  1a 00 00 00 00 00 00 00  |..Ag............|
+000000f0  02 f3 51 22 2e 4e 9e 87  4a 06 06 2f f6 88 0c cf  |..Q".N..J../....|
+00000100  6f 0f 9b                                          |o..|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceECDSA b/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceECDSA
index cbf7564050..ce790fc16f 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceECDSA
+++ b/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceECDSA
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 cb 01 00 00  c7 03 03 7c ce 63 72 4d  |...........|.crM|
-00000010  0b d9 aa 2f b4 22 f4 e3  88 50 10 11 1a d9 ce 5d  |.../."...P.....]|
-00000020  db 14 d4 68 61 48 c1 2d  0d ad dd 00 00 38 c0 2c  |...haH.-.....8.,|
+00000000  16 03 01 00 cb 01 00 00  c7 03 03 44 af b1 f3 8d  |...........D....|
+00000010  81 78 a9 28 a4 31 99 bb  66 17 63 ed 70 88 b7 bb  |.x.(.1..f.c.p...|
+00000020  da ef 4d 1d a2 a6 9e 18  96 97 ec 00 00 38 c0 2c  |..M..........8.,|
 00000030  c0 30 00 9f cc a9 cc a8  cc aa c0 2b c0 2f 00 9e  |.0.........+./..|
 00000040  c0 24 c0 28 00 6b c0 23  c0 27 00 67 c0 0a c0 14  |.$.(.k.#.'.g....|
 00000050  00 39 c0 09 c0 13 00 33  00 9d 00 9c 00 3d 00 3c  |.9.....3.....=.<|
@@ -49,39 +49,39 @@
 00000210  0e bd 3f a3 8c 25 c1 33  13 83 0d 94 06 bb d4 37  |..?..%.3.......7|
 00000220  7a f6 ec 7a c9 86 2e dd  d7 11 69 7f 85 7c 56 de  |z..z......i..|V.|
 00000230  fb 31 78 2b e4 c7 78 0d  ae cb be 9e 4e 36 24 31  |.1x+..x.....N6$1|
-00000240  7b 6a 0f 39 95 12 07 8f  2a 16 03 03 00 b7 0c 00  |{j.9....*.......|
-00000250  00 b3 03 00 1d 20 2f e5  7d a3 47 cd 62 43 15 28  |..... /.}.G.bC.(|
+00000240  7b 6a 0f 39 95 12 07 8f  2a 16 03 03 00 b6 0c 00  |{j.9....*.......|
+00000250  00 b2 03 00 1d 20 2f e5  7d a3 47 cd 62 43 15 28  |..... /.}.G.bC.(|
 00000260  da ac 5f bb 29 07 30 ff  f6 84 af c4 cf c2 ed 90  |.._.).0.........|
-00000270  99 5f 58 cb 3b 74 04 03  00 8b 30 81 88 02 42 01  |._X.;t....0...B.|
-00000280  f1 77 f4 3f e9 ed b7 55  54 25 08 68 ab b9 42 7c  |.w.?...UT%.h..B||
-00000290  64 71 dc ce c0 13 23 20  f3 cd b7 68 09 23 6d c9  |dq....# ...h.#m.|
-000002a0  c5 1f f3 3a 46 f1 e3 2b  b4 92 6a 1c bd c8 60 7c  |...:F..+..j...`||
-000002b0  da 63 0e c7 4f 4f c4 5e  aa 30 b4 b1 3a d4 11 09  |.c..OO.^.0..:...|
-000002c0  05 02 42 01 dd dc 50 07  2f 51 6c 75 7f 3f fd a2  |..B...P./Qlu.?..|
-000002d0  68 62 1d 7a 49 78 4e 57  1b bc 3a 4d 02 84 d5 f6  |hb.zIxNW..:M....|
-000002e0  2a 37 28 4e c0 30 2b a5  22 cc 28 d8 e0 66 2b 4d  |*7(N.0+.".(..f+M|
-000002f0  2a cd d8 01 3d 76 55 72  56 90 dc d0 99 85 ee 45  |*...=vUrV......E|
-00000300  01 03 91 88 a5 16 03 03  00 04 0e 00 00 00        |..............|
+00000270  99 5f 58 cb 3b 74 04 03  00 8a 30 81 87 02 42 01  |._X.;t....0...B.|
+00000280  96 02 ab 3d 94 2b dc 27  07 6b 1b 59 21 f2 88 3b  |...=.+.'.k.Y!..;|
+00000290  de 7a ce 4e d6 a5 47 30  0d 79 ae a9 e0 cf 9c e7  |.z.N..G0.y......|
+000002a0  0b 14 eb 44 bc a3 b9 5b  cf 01 f0 2f be 63 3e 9f  |...D...[.../.c>.|
+000002b0  63 32 4e ce 4d 4c 70 86  dd 16 09 70 f7 3e 3b f6  |c2N.MLp....p.>;.|
+000002c0  34 02 41 0a 0f a9 75 dd  a8 21 40 8f 05 82 2f e0  |4.A...u..!@.../.|
+000002d0  09 37 08 0a b6 a4 8a 1c  fd 3e 4d 1b e3 19 e1 4d  |.7.......>M....M|
+000002e0  15 90 65 00 2f e0 15 bf  2b 23 b6 2b 44 7a 3f 1a  |..e./...+#.+Dz?.|
+000002f0  4c 82 3a 95 b9 ff 37 0a  1e f2 63 e3 b1 71 81 36  |L.:...7...c..q.6|
+00000300  6d 23 3e 53 16 03 03 00  04 0e 00 00 00           |m#>S.........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 5b 72 c3 fc 0c a5  |....%...! [r....|
-00000010  a3 b1 e6 db 1d e7 f2 4a  dd c8 36 97 25 f9 4c 74  |.......J..6.%.Lt|
-00000020  68 04 e5 02 17 ca 67 e2  a6 59 14 03 03 00 01 01  |h.....g..Y......|
-00000030  16 03 03 00 40 f0 40 1c  1a a9 d8 e7 88 c4 9d 6d  |....@.@........m|
-00000040  ad bd e7 5c c4 63 1a 06  5a e9 f5 39 6d 15 ac 41  |...\.c..Z..9m..A|
-00000050  2f ed b9 3b f8 68 13 46  20 be 9b f9 be b6 8a cc  |/..;.h.F .......|
-00000060  f4 87 31 53 b3 ef 79 4e  ce 73 ea a6 45 de 21 3e  |..1S..yN.s..E.!>|
-00000070  99 87 6a cb 4d                                    |..j.M|
+00000000  16 03 03 00 25 10 00 00  21 20 e8 92 71 c8 12 80  |....%...! ..q...|
+00000010  88 d0 7f 00 71 76 83 dc  e6 e3 4c b6 e2 8a d2 0d  |....qv....L.....|
+00000020  61 7e 36 d9 a7 1d 6c 92  75 46 14 03 03 00 01 01  |a~6...l.uF......|
+00000030  16 03 03 00 40 86 48 1a  6f 89 29 b3 8b c1 b6 ad  |....@.H.o.).....|
+00000040  b5 6f af eb 32 44 e9 8f  c2 43 58 d1 71 ad 1f 13  |.o..2D...CX.q...|
+00000050  2b e3 5c bc d5 07 8a 29  9d 30 40 cd 73 2d 0a 80  |+.\....).0@.s-..|
+00000060  49 82 d5 2a 79 eb a5 3c  2e 69 ee 1a 3a d8 1a 69  |I..*y..<.i..:..i|
+00000070  63 a6 30 8e 3f                                    |c.0.?|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 10 1f 05 23 89  |..............#.|
-00000020  1d 50 5f cb 33 09 57 70  32 fc 01 76 f8 e9 dc ec  |.P_.3.Wp2..v....|
-00000030  13 b6 70 95 24 55 52 21  ed e6 5e 59 45 9f c9 c0  |..p.$UR!..^YE...|
-00000040  74 6d d1 2f e6 4d 7c 6e  1e 41 4c 17 03 03 00 40  |tm./.M|n.AL....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 33 ab 9b d6 4a  |...........3...J|
+00000020  bb e7 06 b0 d4 7e 1a 7f  78 cb d1 7a 44 26 a7 e6  |.....~..x..zD&..|
+00000030  93 42 ae ec d3 44 0c dd  b0 74 1b d8 99 75 a2 69  |.B...D...t...u.i|
+00000040  98 d4 ed 2c b8 a0 26 69  80 1c 7f 17 03 03 00 40  |...,..&i.......@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  e8 04 12 d8 cd fc 76 19  e0 27 c1 f2 12 66 d8 86  |......v..'...f..|
-00000070  a8 25 b6 3f 13 aa 5c c5  43 c5 83 a1 c0 4a 7c c6  |.%.?..\.C....J|.|
-00000080  7b d4 63 86 b8 87 d1 36  af 99 f3 6f 9d 7e 86 37  |{.c....6...o.~.7|
+00000060  a5 0b 57 10 11 ca 9e fb  f4 8b 24 86 c7 58 b9 4c  |..W.......$..X.L|
+00000070  9a 1d 6a 60 2b 7c b1 21  7e 00 f2 e5 00 6f ab 04  |..j`+|.!~....o..|
+00000080  2f 14 97 ae 70 05 0d 18  31 57 51 4a 0c c7 10 84  |/...p...1WQJ....|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 f0 fe 4c  32 8b c2 63 78 6c ba de  |.......L2..cxl..|
-000000b0  b3 55 0f e4 32 38 53 5e  2b 32 5c b9 23 4a 84 b7  |.U..28S^+2\.#J..|
-000000c0  6f 2f 86 54 11                                    |o/.T.|
+000000a0  00 00 00 00 00 d2 56 41  e1 58 30 76 2e 6e 6f 13  |......VA.X0v.no.|
+000000b0  3b 72 5d bf c4 5c ef 63  2e 0a f0 6a 3a 98 ec 97  |;r]..\.c...j:...|
+000000c0  07 b3 08 94 0d                                    |.....|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceRSA b/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceRSA
index db7199d9a9..8959740c3b 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceRSA
+++ b/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceRSA
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 cb 01 00 00  c7 03 03 39 27 e9 a6 45  |...........9'..E|
-00000010  cf a6 18 8c f0 d1 fb 71  81 b6 bf 16 d7 75 af f2  |.......q.....u..|
-00000020  1e 4f 4c 72 2a ce 66 52  a6 87 32 00 00 38 c0 2c  |.OLr*.fR..2..8.,|
+00000000  16 03 01 00 cb 01 00 00  c7 03 03 a6 9c 71 27 48  |.............q'H|
+00000010  24 f6 58 48 c8 2c 32 88  c9 01 eb f0 87 14 ba 7f  |$.XH.,2.........|
+00000020  f0 53 2d fd a1 b2 0a 72  e4 48 8e 00 00 38 c0 2c  |.S-....r.H...8.,|
 00000030  c0 30 00 9f cc a9 cc a8  cc aa c0 2b c0 2f 00 9e  |.0.........+./..|
 00000040  c0 24 c0 28 00 6b c0 23  c0 27 00 67 c0 0a c0 14  |.$.(.k.#.'.g....|
 00000050  00 39 c0 09 c0 13 00 33  00 9d 00 9c 00 3d 00 3c  |.9.....3.....=.<|
@@ -57,35 +57,35 @@
 00000290  3b e9 fa e7 16 03 03 00  ac 0c 00 00 a8 03 00 1d  |;...............|
 000002a0  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
 000002b0  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-000002c0  74 08 04 00 80 41 cd 5d  a0 ba 92 1f 26 47 6d 72  |t....A.]....&Gmr|
-000002d0  33 44 47 a4 80 66 d8 1c  17 93 1e 25 8e c3 8e 95  |3DG..f.....%....|
-000002e0  9c ae b6 99 7e f6 80 3f  b1 73 cc c3 db 7a 4b 40  |....~..?.s...zK@|
-000002f0  a1 0b bc ff 0e 4b c1 67  11 b2 ca 33 06 41 f9 ac  |.....K.g...3.A..|
-00000300  56 dc f6 26 1b a3 04 2a  28 f9 47 0f 0b 56 05 73  |V..&...*(.G..V.s|
-00000310  93 cb 12 45 4f 6b 93 5d  0f 4c ca d3 f5 64 e2 4a  |...EOk.].L...d.J|
-00000320  eb 36 bb 87 3f 71 9b 36  08 99 79 48 fc a6 02 d6  |.6..?q.6..yH....|
-00000330  38 88 09 68 cf 71 e8 d4  51 f8 b1 77 70 42 8b 18  |8..h.q..Q..wpB..|
-00000340  ab cd e1 52 d9 16 03 03  00 04 0e 00 00 00        |...R..........|
+000002c0  74 04 01 00 80 10 af cc  7e b1 33 b1 87 08 e9 d5  |t.......~.3.....|
+000002d0  b0 fc 70 a6 b6 f9 20 92  60 b2 01 90 e3 e2 0b 71  |..p... .`......q|
+000002e0  4c b9 91 4e c7 28 60 cb  b5 b7 d1 91 1f 01 f3 93  |L..N.(`.........|
+000002f0  56 5b 14 91 bb e4 95 18  f5 0c 23 47 e6 4e d0 9e  |V[........#G.N..|
+00000300  2f 1a 4a d1 f5 08 71 c0  08 70 75 78 c1 c7 89 e4  |/.J...q..pux....|
+00000310  b2 3c b9 49 c8 95 c7 ba  5b b0 04 20 18 b1 5a 3e  |.<.I....[.. ..Z>|
+00000320  2b 9f 7b 2b 9c f8 34 69  4b c2 a8 2f d1 73 ec d1  |+.{+..4iK../.s..|
+00000330  c9 22 19 6b bc aa e4 d3  89 73 5a 88 27 75 4a b6  |.".k.....sZ.'uJ.|
+00000340  c3 6d 32 b0 a2 16 03 03  00 04 0e 00 00 00        |.m2...........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 b5 a5 bc 9f 09 79  |....%...! .....y|
-00000010  25 1a 7b af 52 0f 8a c2  16 a8 20 8d 0c 11 26 11  |%.{.R..... ...&.|
-00000020  32 79 35 b9 2f ee 63 ce  b7 49 14 03 03 00 01 01  |2y5./.c..I......|
-00000030  16 03 03 00 40 d8 eb b7  d7 b4 a6 62 a1 8d c6 a5  |....@......b....|
-00000040  5f 15 8e 1f de d9 98 90  3b d8 dd b1 13 7e 49 9b  |_.......;....~I.|
-00000050  d4 82 15 b9 a9 31 ac ae  eb 77 21 dc 9f e0 8e 5b  |.....1...w!....[|
-00000060  d8 ea 09 fc a2 35 64 af  8d 1a fb a3 f1 97 0e 09  |.....5d.........|
-00000070  b4 5b c9 e9 19                                    |.[...|
+00000000  16 03 03 00 25 10 00 00  21 20 f3 07 eb 86 c5 e2  |....%...! ......|
+00000010  28 7c be 7e 34 8d c5 74  19 0b b3 cc ce ce 90 3f  |(|.~4..t.......?|
+00000020  ac 06 c8 9f 79 3d 42 08  e2 01 14 03 03 00 01 01  |....y=B.........|
+00000030  16 03 03 00 40 9b 6d a1  1e ca fb 27 67 ca 7b 57  |....@.m....'g.{W|
+00000040  60 f4 60 95 b4 56 fd 97  cb 58 c5 cb bc 04 87 1d  |`.`..V...X......|
+00000050  74 a5 98 ec 3c 6f 25 5a  ef c5 af 21 4b 2e 5c 97  |t...<o%Z...!K.\.|
+00000060  52 35 eb c8 10 a7 3e 00  94 f5 46 cc 8e 19 fe f7  |R5....>...F.....|
+00000070  08 62 88 25 1f                                    |.b.%.|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 3b 2a 79 f1 0d  |...........;*y..|
-00000020  65 b8 4a 2a aa a5 87 60  69 8f 8f 87 4b 21 24 9a  |e.J*...`i...K!$.|
-00000030  6e 07 f0 a4 be ce 3d 67  29 85 53 98 fb cf a1 ee  |n.....=g).S.....|
-00000040  b0 e0 52 61 c1 16 e5 09  b9 0b 9c 17 03 03 00 40  |..Ra...........@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 8e a1 9a 44 d4  |..............D.|
+00000020  98 c6 5f 46 2f d9 e5 ac  78 b5 91 3f 15 89 6f fb  |.._F/...x..?..o.|
+00000030  39 79 65 0b c7 09 c7 fc  eb 40 6d 8e 6d b7 8b 94  |9ye......@m.m...|
+00000040  6f 30 5a a6 4c 9d 2a 13  ed f6 f4 17 03 03 00 40  |o0Z.L.*........@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  fe d7 63 a8 10 70 b8 2c  0c 95 da 92 84 2b d3 63  |..c..p.,.....+.c|
-00000070  03 d8 19 94 68 d8 d2 da  f7 e2 83 5b 24 78 87 0f  |....h......[$x..|
-00000080  ca ce 14 3a 8a d4 da b2  90 eb 6f 0e de 14 30 96  |...:......o...0.|
+00000060  5b 96 f1 fa c4 5b a3 22  74 ef 8c 34 52 50 c6 86  |[....[."t..4RP..|
+00000070  32 19 40 b8 80 54 d9 c2  6a 43 a2 c2 fe 07 dd 37  |2.@..T..jC.....7|
+00000080  89 62 bd 68 6a 1e e7 d9  1f ba 3a 1a 83 13 1f 7c  |.b.hj.....:....||
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 ab e5 6b  f9 d3 a6 07 ce 0b 64 7e  |.......k......d~|
-000000b0  14 42 d3 17 6a d4 89 2c  37 7d cd ee 77 23 0c 60  |.B..j..,7}..w#.`|
-000000c0  e0 db 35 5e 96                                    |..5^.|
+000000a0  00 00 00 00 00 92 f0 3e  2e 3c d2 62 ce e8 2e 12  |.......>.<.b....|
+000000b0  4e 1e 77 ba ff 61 97 f9  8e e8 d1 1b a0 00 3f 2c  |N.w..a........?,|
+000000c0  8c 5c 10 ac 05                                    |.\...|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndECDSAGiven b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndECDSAGiven
index c8e4998a7e..b65a7b70f4 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndECDSAGiven
+++ b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndECDSAGiven
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 97 01 00 00  93 03 03 66 1f 74 64 d2  |...........f.td.|
-00000010  fb 53 f5 a4 7e ea ad 25  d8 e9 91 62 49 87 de 60  |.S..~..%...bI..`|
-00000020  0d 30 d5 34 21 7a 34 b4  2f 95 02 00 00 04 00 2f  |.0.4!z4./....../|
+00000000  16 03 01 00 97 01 00 00  93 03 03 75 b5 bf db ae  |...........u....|
+00000010  ee 3a 8d d7 23 e1 22 9a  42 d9 7a de ac 41 81 60  |.:..#.".B.z..A.`|
+00000020  4d 05 6e f1 11 c5 c0 de  21 46 d2 00 00 04 00 2f  |M.n.....!F...../|
 00000030  00 ff 01 00 00 66 00 00  00 0e 00 0c 00 00 09 31  |.....f.........1|
 00000040  32 37 2e 30 2e 30 2e 31  00 0b 00 04 03 00 01 02  |27.0.0.1........|
 00000050  00 0a 00 0c 00 0a 00 1d  00 17 00 1e 00 19 00 18  |................|
@@ -51,10 +51,9 @@
 00000260  f1 6c 04 ed 73 bb b3 43  77 8d 0c 1c f1 0f a1 d8  |.l..s..Cw.......|
 00000270  40 83 61 c9 4c 72 2b 9d  ae db 46 06 06 4d f4 c1  |@.a.Lr+...F..M..|
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
-00000290  3b e9 fa e7 16 03 03 00  23 0d 00 00 1f 02 01 40  |;.......#......@|
-000002a0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000002b0  06 01 05 03 06 03 02 01  02 03 00 00 16 03 03 00  |................|
-000002c0  04 0e 00 00 00                                    |.....|
+00000290  3b e9 fa e7 16 03 03 00  1d 0d 00 00 19 02 01 40  |;..............@|
+000002a0  00 12 04 01 04 03 08 07  05 01 06 01 05 03 06 03  |................|
+000002b0  02 01 02 03 00 00 16 03  03 00 04 0e 00 00 00     |...............|
 >>> Flow 3 (client to server)
 00000000  16 03 03 02 0a 0b 00 02  06 00 02 03 00 02 00 30  |...............0|
 00000010  82 01 fc 30 82 01 5e 02  09 00 9a 30 84 6c 26 35  |...0..^....0.l&5|
@@ -89,40 +88,40 @@
 000001e0  be e8 91 b3 da 1a f5 5d  a3 23 f5 26 8b 45 70 8d  |.......].#.&.Ep.|
 000001f0  65 62 9b 7e 01 99 3d 18  f6 10 9a 38 61 9b 2e 57  |eb.~..=....8a..W|
 00000200  e4 fa cc b1 8a ce e2 23  a0 87 f0 e1 67 51 eb 16  |.......#....gQ..|
-00000210  03 03 00 86 10 00 00 82  00 80 2f 1e 5b 62 64 9e  |........../.[bd.|
-00000220  68 97 bc 17 8d aa e1 4e  c7 cb 48 a1 cf dd bf e7  |h......N..H.....|
-00000230  18 5e e0 6f da 03 68 f0  be 8a e8 4f a6 c6 e1 58  |.^.o..h....O...X|
-00000240  eb 8f 10 82 36 de bf 7a  f2 ca eb af 42 9a 4e b2  |....6..z....B.N.|
-00000250  25 36 4f e5 dd 04 a2 93  f0 af 4c ca c7 cc 3e 5c  |%6O.......L...>\|
-00000260  5b 90 31 1a a8 e8 d5 a8  db c1 9d 51 ec 6d 36 20  |[.1........Q.m6 |
-00000270  ef 64 41 a7 0e 5a cd 51  9d 0c e4 1d 27 0b 0a 4f  |.dA..Z.Q....'..O|
-00000280  2b c3 92 8d ff 9e 6a f7  47 f8 34 5a 24 e6 ce 47  |+.....j.G.4Z$..G|
-00000290  d6 da 88 1f 2c f1 93 ba  0e 3f 16 03 03 00 93 0f  |....,....?......|
-000002a0  00 00 8f 04 03 00 8b 30  81 88 02 42 01 c1 a5 6a  |.......0...B...j|
-000002b0  ed 3b c8 6e 4c 41 96 db  17 f3 f1 56 8a 9d a4 9e  |.;.nLA.....V....|
-000002c0  31 8f f9 a7 78 02 ed bd  f4 97 b6 f1 d4 16 ab 22  |1...x.........."|
-000002d0  34 3f 83 72 11 1b 47 b6  e4 03 50 56 1d 9c 21 a2  |4?.r..G...PV..!.|
-000002e0  cf 4a 16 9c 12 86 03 fd  f0 5c 9a 2f db fb 02 42  |.J.......\./...B|
-000002f0  01 ae cd 98 fc 91 06 11  d1 99 0c 67 5f dd 1d 2b  |...........g_..+|
-00000300  7c a6 b0 af b0 e1 2d 81  32 2e 47 f1 48 f7 9a f3  ||.....-.2.G.H...|
-00000310  9c a2 eb 6a ea b8 02 91  d9 60 9e ab ed 51 af db  |...j.....`...Q..|
-00000320  05 3e 36 a9 df 57 ff b5  6b aa e7 8e 24 64 ef 84  |.>6..W..k...$d..|
-00000330  b7 58 14 03 03 00 01 01  16 03 03 00 40 8d cd c6  |.X..........@...|
-00000340  3c 90 dc 8b 6b 94 09 a8  80 1e 8c 4f 70 d6 c2 90  |<...k......Op...|
-00000350  16 35 92 7a ce be a9 c8  17 fc 6b 48 da a5 af bf  |.5.z......kH....|
-00000360  9a a5 e0 0f 77 aa b8 5f  b5 5d 95 7f a7 b5 a1 4a  |....w.._.].....J|
-00000370  8f 90 95 27 df 17 cc 98  34 32 6c 5a 60           |...'....42lZ`|
+00000210  03 03 00 86 10 00 00 82  00 80 6c 1d a3 55 fb a0  |..........l..U..|
+00000220  be 6f 49 64 67 b8 da 1c  27 91 f4 5d d9 9d 7e f0  |.oIdg...'..]..~.|
+00000230  53 86 15 96 93 b2 0d 11  1a cf 3c 76 5e 76 24 ac  |S.........<v^v$.|
+00000240  f5 de c0 a3 d7 be db aa  86 f4 ec f4 39 a5 96 b8  |............9...|
+00000250  6a 88 cf b0 cd 02 b4 56  2d 5a 35 4e 15 95 21 94  |j......V-Z5N..!.|
+00000260  ac 2e 90 57 94 b9 a2 31  fe a9 3e 77 4a f2 5f fe  |...W...1..>wJ._.|
+00000270  5f 51 0d 12 61 19 f6 fe  7d f7 b7 06 0d b1 de 09  |_Q..a...}.......|
+00000280  45 17 4b 2a 15 97 ce 96  c5 f5 27 95 fb e8 c5 67  |E.K*......'....g|
+00000290  5e cb 8c 98 c7 c5 68 41  36 99 16 03 03 00 91 0f  |^.....hA6.......|
+000002a0  00 00 8d 04 03 00 89 30  81 86 02 41 48 35 40 6e  |.......0...AH5@n|
+000002b0  03 2a 43 fe f8 a9 c5 f9  c7 05 f8 db 13 5e ee bb  |.*C..........^..|
+000002c0  a8 59 5b fc b4 5d 0a ec  32 18 d5 a0 01 d5 81 a5  |.Y[..]..2.......|
+000002d0  f3 8e 4f 91 54 c7 8f a1  c1 77 4c 94 5c e4 68 c2  |..O.T....wL.\.h.|
+000002e0  0b 22 e2 70 0c 32 e2 9d  6e 47 e4 0d f7 02 41 2d  |.".p.2..nG....A-|
+000002f0  0e bb 28 47 90 23 68 f2  fd 9e 7d 13 f0 ad 40 ed  |..(G.#h...}...@.|
+00000300  cb 32 e5 9d 5e a7 e1 12  d7 de 10 bc 93 df cb 03  |.2..^...........|
+00000310  4e 16 5a cf 8f 25 1e 39  ff 7c 9f 59 55 f0 df b4  |N.Z..%.9.|.YU...|
+00000320  ce 43 6d 15 8f e3 ef 76  5d 0d a9 31 a9 24 c6 58  |.Cm....v]..1.$.X|
+00000330  14 03 03 00 01 01 16 03  03 00 40 71 ca 10 08 a9  |..........@q....|
+00000340  1a f1 78 9d 6f 2d 76 1c  b0 2a f8 26 d2 f6 89 db  |..x.o-v..*.&....|
+00000350  25 50 63 cc bf 12 cb fb  39 93 91 7f 7f f7 e4 fe  |%Pc.....9.......|
+00000360  fc 28 d0 01 3b e9 f9 1b  6a 77 db 16 14 71 3d 35  |.(..;...jw...q=5|
+00000370  67 de b8 1d e3 4a 02 bc  cf 0a a6                 |g....J.....|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 f0 c3 7c f0 20  |.............|. |
-00000020  3f 75 d0 c4 b5 2d 76 82  22 9e 8c 8c 6a 83 95 84  |?u...-v."...j...|
-00000030  22 54 20 d6 62 d8 75 69  32 90 e9 d4 07 fa 6a 01  |"T .b.ui2.....j.|
-00000040  15 b8 bc 88 8d 40 ef 18  48 80 25 17 03 03 00 40  |.....@..H.%....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 0d f1 0c 52 89  |..............R.|
+00000020  61 e6 21 95 8d 6f 5d e9  07 42 23 5f 1c 74 44 57  |a.!..o]..B#_.tDW|
+00000030  38 a3 98 77 f2 62 99 71  d6 fe 03 a3 82 01 7a da  |8..w.b.q......z.|
+00000040  a5 fd 12 62 2b d2 1d e4  e2 51 25 17 03 03 00 40  |...b+....Q%....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  03 32 97 2d 46 23 92 df  55 de 53 b0 91 63 09 c2  |.2.-F#..U.S..c..|
-00000070  21 23 c9 23 fa e6 f2 a3  e0 3e 90 a4 82 d8 6a 36  |!#.#.....>....j6|
-00000080  65 af ee 69 a6 86 41 c8  7e 14 d4 bb 93 7d be 53  |e..i..A.~....}.S|
+00000060  81 82 cc a9 4e 6f 78 41  28 b3 e6 c3 44 62 48 0b  |....NoxA(...DbH.|
+00000070  b3 70 f9 f8 7a fc c5 be  36 45 58 41 6f 77 69 40  |.p..z...6EXAowi@|
+00000080  5b 6e fc 69 84 21 eb bc  95 36 e6 48 05 02 37 f5  |[n.i.!...6.H..7.|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 b2 2f 21  57 e0 e7 2a 16 8e bb 22  |....../!W..*..."|
-000000b0  7d 1e e1 34 d5 58 90 94  a7 e7 33 f8 df 9f 60 d9  |}..4.X....3...`.|
-000000c0  81 6a 44 0c d3                                    |.jD..|
+000000a0  00 00 00 00 00 d3 2f 45  d3 65 3b 64 67 43 ef aa  |....../E.e;dgC..|
+000000b0  a7 bb 98 a0 99 70 7f 56  c6 13 b2 1b 62 35 62 ea  |.....p.V....b5b.|
+000000c0  51 75 94 be 32                                    |Qu..2|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndEd25519Given b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndEd25519Given
index 51288df50f..0503b9def5 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndEd25519Given
+++ b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndEd25519Given
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 cb 01 00 00  c7 03 03 26 1e 0e df 93  |...........&....|
-00000010  13 67 d7 9a 1f d2 f1 8a  42 a4 04 d1 65 02 17 40  |.g......B...e..@|
-00000020  18 a8 c5 30 ce 23 ae 56  47 8e 1f 00 00 38 c0 2c  |...0.#.VG....8.,|
+00000000  16 03 01 00 cb 01 00 00  c7 03 03 ec bb 63 30 5c  |.............c0\|
+00000010  ea 49 54 dc 44 f7 80 47  c9 4d ff fa d4 77 44 8a  |.IT.D..G.M...wD.|
+00000020  ce 4b bd ce d7 95 b2 0d  f7 2e 88 00 00 38 c0 2c  |.K...........8.,|
 00000030  c0 30 00 9f cc a9 cc a8  cc aa c0 2b c0 2f 00 9e  |.0.........+./..|
 00000040  c0 24 c0 28 00 6b c0 23  c0 27 00 67 c0 0a c0 14  |.$.(.k.#.'.g....|
 00000050  00 39 c0 09 c0 13 00 33  00 9d 00 9c 00 3d 00 3c  |.9.....3.....=.<|
@@ -57,18 +57,17 @@
 00000290  3b e9 fa e7 16 03 03 00  ac 0c 00 00 a8 03 00 1d  |;...............|
 000002a0  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
 000002b0  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-000002c0  74 08 04 00 80 77 9b ae  6a 97 73 f6 07 89 02 91  |t....w..j.s.....|
-000002d0  79 f1 94 12 c6 60 3a 98  7e a8 1a 2b ed 05 5c e3  |y....`:.~..+..\.|
-000002e0  1c 6e 10 b8 d3 8e 32 32  6f b0 ae 84 bb fb 8b 19  |.n....22o.......|
-000002f0  0e cc ce a6 92 35 ea 79  ee b3 4e 27 04 51 85 30  |.....5.y..N'.Q.0|
-00000300  6c 83 da 21 97 2c 18 80  e8 57 b5 ec 24 2c 43 3d  |l..!.,...W..$,C=|
-00000310  70 b8 38 d1 8c 61 e0 60  40 0d 07 db 74 dc 10 ac  |p.8..a.`@...t...|
-00000320  7b cd cd 7d 16 0b 14 97  38 01 be 13 a9 04 5e 90  |{..}....8.....^.|
-00000330  f4 f3 c5 85 97 ab 1d 62  fa 2d 08 a4 ae 96 b3 0e  |.......b.-......|
-00000340  09 25 cd 4a 18 16 03 03  00 23 0d 00 00 1f 02 01  |.%.J.....#......|
-00000350  40 00 18 08 04 04 03 08  07 08 05 08 06 04 01 05  |@...............|
-00000360  01 06 01 05 03 06 03 02  01 02 03 00 00 16 03 03  |................|
-00000370  00 04 0e 00 00 00                                 |......|
+000002c0  74 04 01 00 80 94 e2 09  13 e0 7c e8 6d 3b 50 f1  |t.........|.m;P.|
+000002d0  4f f3 58 57 da 87 f4 61  f5 04 fc ec 0d 28 f1 e9  |O.XW...a.....(..|
+000002e0  be 93 20 4a 17 03 17 b1  7f 2c 32 24 2e 02 35 67  |.. J.....,2$..5g|
+000002f0  9f e7 55 0a 6d 3d af ef  e3 b2 27 2e ae 12 cd 2c  |..U.m=....'....,|
+00000300  d9 e1 60 d6 64 94 f5 f2  42 54 43 23 70 36 fe 8e  |..`.d...BTC#p6..|
+00000310  d2 0b a3 cf fd 04 74 6e  55 9b 7a 86 c8 dd 0d 40  |......tnU.z....@|
+00000320  bc b1 4e 05 c2 7f b4 40  3a d9 66 01 af ee fb 54  |..N....@:.f....T|
+00000330  b6 cc e4 5b a2 1a 39 dc  25 7d 5d 8c 37 a1 15 ae  |...[..9.%}].7...|
+00000340  ed 16 b5 25 14 16 03 03  00 1d 0d 00 00 19 02 01  |...%............|
+00000350  40 00 12 04 01 04 03 08  07 05 01 06 01 05 03 06  |@...............|
+00000360  03 02 01 02 03 00 00 16  03 03 00 04 0e 00 00 00  |................|
 >>> Flow 3 (client to server)
 00000000  16 03 03 01 3c 0b 00 01  38 00 01 35 00 01 32 30  |....<...8..5..20|
 00000010  82 01 2e 30 81 e1 a0 03  02 01 02 02 10 17 d1 81  |...0............|
@@ -90,23 +89,23 @@
 00000110  8a 4e 34 40 39 d6 b3 10  dc 19 fe a0 22 71 b3 f5  |.N4@9......."q..|
 00000120  8f a1 58 0d cd f4 f1 85  24 bf e6 3d 14 df df ed  |..X.....$..=....|
 00000130  0e e1 17 d8 11 a2 60 d0  8a 37 23 2a c2 46 aa 3a  |......`..7#*.F.:|
-00000140  08 16 03 03 00 25 10 00  00 21 20 b6 8b 9e fb b5  |.....%...! .....|
-00000150  86 80 f5 41 57 7c 05 ea  d3 42 02 24 c9 5d 26 9c  |...AW|...B.$.]&.|
-00000160  72 33 19 42 c2 70 a1 91  2c f4 58 16 03 03 00 48  |r3.B.p..,.X....H|
-00000170  0f 00 00 44 08 07 00 40  7d 84 b0 a3 bf d4 ed bc  |...D...@}.......|
-00000180  2c 8f 6f 35 47 96 32 25  4b cf 65 5a 08 ae 5a 58  |,.o5G.2%K.eZ..ZX|
-00000190  f4 a2 48 ae 70 95 d1 43  95 53 fb 56 ab 73 da d0  |..H.p..C.S.V.s..|
-000001a0  9a 7d 5e fb 83 36 81 89  6e 64 15 f7 57 16 8c 97  |.}^..6..nd..W...|
-000001b0  70 07 4f 8c 62 0e 54 0c  14 03 03 00 01 01 16 03  |p.O.b.T.........|
-000001c0  03 00 28 54 7e 52 83 b2  61 a1 2f 22 ff 29 f1 6d  |..(T~R..a./".).m|
-000001d0  fd 7c f6 ac 25 b5 9d 4e  e6 6d aa dc 3b cc ed f5  |.|..%..N.m..;...|
-000001e0  7a 42 da ce ab 76 a2 31  13 07 90                 |zB...v.1...|
+00000140  08 16 03 03 00 25 10 00  00 21 20 f1 58 f8 db 86  |.....%...! .X...|
+00000150  a5 97 07 c8 fc c8 c1 fe  e4 c9 35 13 44 f8 9b 7f  |..........5.D...|
+00000160  4a 22 6a 61 75 70 be 23  76 f4 5f 16 03 03 00 48  |J"jaup.#v._....H|
+00000170  0f 00 00 44 08 07 00 40  fb ab 8f 44 f1 7b cb 95  |...D...@...D.{..|
+00000180  e3 83 4b 85 d0 4f 41 a6  39 f8 ba c1 7c b5 7d f0  |..K..OA.9...|.}.|
+00000190  45 5b 2d e2 90 80 27 1a  b9 88 dd 4b 0d bc e8 1b  |E[-...'....K....|
+000001a0  d4 fc 69 d1 ac 59 d8 b3  0b b6 f7 ae 76 12 da 80  |..i..Y......v...|
+000001b0  6b 39 98 5b 55 c4 c1 09  14 03 03 00 01 01 16 03  |k9.[U...........|
+000001c0  03 00 28 46 3a 98 32 bf  61 b0 d2 74 f8 f4 65 ef  |..(F:.2.a..t..e.|
+000001d0  89 5b f5 ef 49 42 56 67  97 23 f2 18 de 06 30 86  |.[..IBVg.#....0.|
+000001e0  77 66 ac 0a ac 88 98 ab  93 2b 20                 |wf.......+ |
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 28 00 00 00 00 00  |..........(.....|
-00000010  00 00 00 22 de 32 e6 4c  f8 8c 2b 41 e0 25 cb 48  |...".2.L..+A.%.H|
-00000020  f4 98 1f c0 4a 06 ac db  b5 c4 a2 09 44 81 c2 c4  |....J.......D...|
-00000030  f5 c6 b4 17 03 03 00 25  00 00 00 00 00 00 00 01  |.......%........|
-00000040  b0 c7 84 90 55 23 5b 2a  cd 67 58 64 cf 43 78 b0  |....U#[*.gXd.Cx.|
-00000050  41 61 36 ff 7b 9f 75 5e  92 90 a7 8e 9d 15 03 03  |Aa6.{.u^........|
-00000060  00 1a 00 00 00 00 00 00  00 02 5b 94 c8 7a 6e 9a  |..........[..zn.|
-00000070  f5 23 4b 72 aa e4 c7 62  be 44 78 f5              |.#Kr...b.Dx.|
+00000010  00 00 00 49 81 2d e8 88  dc 52 2a 44 51 18 2e 62  |...I.-...R*DQ..b|
+00000020  28 9e 91 7a 87 b5 fb 46  89 27 01 5e dc b1 12 00  |(..z...F.'.^....|
+00000030  72 fe 34 17 03 03 00 25  00 00 00 00 00 00 00 01  |r.4....%........|
+00000040  ab a1 6a 44 4b 80 a8 2e  f4 75 ff 09 9f 11 05 74  |..jDK....u.....t|
+00000050  93 ab 97 de 54 16 36 f9  0a 3c a1 89 c0 15 03 03  |....T.6..<......|
+00000060  00 1a 00 00 00 00 00 00  00 02 2d 63 e8 72 ab 7b  |..........-c.r.{|
+00000070  20 de f4 73 05 4a 26 a1  78 7a 1c 02              | ..s.J&.xz..|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndGiven b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndGiven
index bdc4d69e2b..aa27d2c231 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndGiven
+++ b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndGiven
@@ -1,11 +1,14 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 6b 01 00 00  67 03 03 5f 6c 21 71 7b  |....k...g.._l!q{|
-00000010  56 1a fb f0 82 41 8b 3f  f0 da 02 b6 17 90 f4 37  |V....A.?.......7|
-00000020  71 5c 5d f8 00 15 d5 08  3e 9e d2 00 00 04 00 2f  |q\].....>....../|
-00000030  00 ff 01 00 00 3a 00 00  00 0e 00 0c 00 00 09 31  |.....:.........1|
+00000000  16 03 01 00 97 01 00 00  93 03 03 de e6 7c 24 10  |.............|$.|
+00000010  d1 3a 48 8f ba 9a cf 0f  4b 8d 81 8b 07 41 4f bd  |.:H.....K....AO.|
+00000020  46 9b c1 dc 24 51 aa 30  83 a2 49 00 00 04 00 2f  |F...$Q.0..I..../|
+00000030  00 ff 01 00 00 66 00 00  00 0e 00 0c 00 00 09 31  |.....f.........1|
 00000040  32 37 2e 30 2e 30 2e 31  00 0b 00 04 03 00 01 02  |27.0.0.1........|
 00000050  00 0a 00 0c 00 0a 00 1d  00 17 00 1e 00 19 00 18  |................|
-00000060  00 16 00 00 00 17 00 00  00 0d 00 04 00 02 08 04  |................|
+00000060  00 16 00 00 00 17 00 00  00 0d 00 30 00 2e 04 03  |...........0....|
+00000070  05 03 06 03 08 07 08 08  08 09 08 0a 08 0b 08 04  |................|
+00000080  08 05 08 06 04 01 05 01  06 01 03 03 02 03 03 01  |................|
+00000090  02 01 03 02 02 02 04 02  05 02 06 02              |............|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 31 02 00 00  2d 03 03 00 00 00 00 00  |....1...-.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -48,77 +51,36 @@
 00000260  f1 6c 04 ed 73 bb b3 43  77 8d 0c 1c f1 0f a1 d8  |.l..s..Cw.......|
 00000270  40 83 61 c9 4c 72 2b 9d  ae db 46 06 06 4d f4 c1  |@.a.Lr+...F..M..|
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
-00000290  3b e9 fa e7 16 03 03 00  23 0d 00 00 1f 02 01 40  |;.......#......@|
-000002a0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000002b0  06 01 05 03 06 03 02 01  02 03 00 00 16 03 03 00  |................|
-000002c0  04 0e 00 00 00                                    |.....|
+00000290  3b e9 fa e7 16 03 03 00  1d 0d 00 00 19 02 01 40  |;..............@|
+000002a0  00 12 04 01 04 03 08 07  05 01 06 01 05 03 06 03  |................|
+000002b0  02 01 02 03 00 00 16 03  03 00 04 0e 00 00 00     |...............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
-00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
-00000020  c1 89 65 83 55 6f dc 0b  c9 b9 93 9f e9 bc 30 0d  |..e.Uo........0.|
-00000030  06 09 2a 86 48 86 f7 0d  01 01 0b 05 00 30 12 31  |..*.H........0.1|
-00000040  10 30 0e 06 03 55 04 0a  13 07 41 63 6d 65 20 43  |.0...U....Acme C|
-00000050  6f 30 1e 17 0d 31 36 30  38 31 37 32 31 35 32 33  |o0...16081721523|
-00000060  31 5a 17 0d 31 37 30 38  31 37 32 31 35 32 33 31  |1Z..170817215231|
-00000070  5a 30 12 31 10 30 0e 06  03 55 04 0a 13 07 41 63  |Z0.1.0...U....Ac|
-00000080  6d 65 20 43 6f 30 81 9f  30 0d 06 09 2a 86 48 86  |me Co0..0...*.H.|
-00000090  f7 0d 01 01 01 05 00 03  81 8d 00 30 81 89 02 81  |...........0....|
-000000a0  81 00 ba 6f aa 86 bd cf  bf 9f f2 ef 5c 94 60 78  |...o........\.`x|
-000000b0  6f e8 13 f2 d1 96 6f cd  d9 32 6e 22 37 ce 41 f9  |o.....o..2n"7.A.|
-000000c0  ca 5d 29 ac e1 27 da 61  a2 ee 81 cb 10 c7 df 34  |.])..'.a.......4|
-000000d0  58 95 86 e9 3d 19 e6 5c  27 73 60 c8 8d 78 02 f4  |X...=..\'s`..x..|
-000000e0  1d a4 98 09 a3 19 70 69  3c 25 62 66 2a ab 22 23  |......pi<%bf*."#|
-000000f0  c5 7b 85 38 4f 2e 09 73  32 a7 bd 3e 9b ad ca 84  |.{.8O..s2..>....|
-00000100  07 e6 0f 3a ff 77 c5 9d  41 85 00 8a b6 9b ee b0  |...:.w..A.......|
-00000110  a4 3f 2d 4c 4c e6 42 3e  bb 51 c8 dd 48 54 f4 0c  |.?-LL.B>.Q..HT..|
-00000120  8e 47 02 03 01 00 01 a3  46 30 44 30 0e 06 03 55  |.G......F0D0...U|
-00000130  1d 0f 01 01 ff 04 04 03  02 05 a0 30 13 06 03 55  |...........0...U|
-00000140  1d 25 04 0c 30 0a 06 08  2b 06 01 05 05 07 03 01  |.%..0...+.......|
-00000150  30 0c 06 03 55 1d 13 01  01 ff 04 02 30 00 30 0f  |0...U.......0.0.|
-00000160  06 03 55 1d 11 04 08 30  06 87 04 7f 00 00 01 30  |..U....0.......0|
-00000170  0d 06 09 2a 86 48 86 f7  0d 01 01 0b 05 00 03 81  |...*.H..........|
-00000180  81 00 46 ab 44 a2 fb 28  54 f8 5a 67 f8 62 94 f1  |..F.D..(T.Zg.b..|
-00000190  9a b2 18 9e f2 b1 de 1d  7e 6f 76 95 a9 ba e7 5d  |........~ov....]|
-000001a0  a8 16 6c 9c f7 09 d3 37  e4 4b 2b 36 7c 01 ad 41  |..l....7.K+6|..A|
-000001b0  d2 32 d8 c3 d2 93 f9 10  6b 8e 95 b9 2c 17 8a a3  |.2......k...,...|
-000001c0  44 48 bc 59 13 83 16 04  88 a4 81 5c 25 0d 98 0c  |DH.Y.......\%...|
-000001d0  ac 11 b1 28 56 be 1d cd  61 62 84 09 bf d6 80 c6  |...(V...ab......|
-000001e0  45 8d 82 2c b4 d8 83 9b  db c9 22 b7 2a 12 11 7b  |E..,......".*..{|
-000001f0  fa 02 3b c1 c9 ff ea c9  9d a8 49 d3 95 d7 d5 0e  |..;.......I.....|
-00000200  e5 35 16 03 03 00 86 10  00 00 82 00 80 9a cf e4  |.5..............|
-00000210  f4 ff c6 e1 0e f3 ea 25  27 42 8f 64 39 f3 d8 51  |.......%'B.d9..Q|
-00000220  45 cd e5 e5 06 c0 59 31  79 00 1f 59 ac a8 e6 de  |E.....Y1y..Y....|
-00000230  60 45 00 e4 31 b9 d8 af  b4 9a ff 80 c8 bc a2 f1  |`E..1...........|
-00000240  14 10 48 e0 5b fc c5 04  0f b2 b4 ea ce 24 cb 88  |..H.[........$..|
-00000250  9a 53 e3 e7 94 5a 7c bd  7a f2 fa 12 53 6b 67 53  |.S...Z|.z...SkgS|
-00000260  81 18 59 ce b0 a0 37 d0  cb ed c4 b7 fd de c1 ee  |..Y...7.........|
-00000270  9b 77 09 ba fd a4 29 b9  ca 9c 28 f1 82 5f 6a 0c  |.w....)...(.._j.|
-00000280  1f 49 4c f4 b5 66 56 31  c5 80 73 46 f1 16 03 03  |.IL..fV1..sF....|
-00000290  00 88 0f 00 00 84 08 04  00 80 89 78 b7 73 5b b3  |...........x.s[.|
-000002a0  35 95 da f6 a1 3c 45 81  0b f7 19 87 ff d6 55 64  |5....<E.......Ud|
-000002b0  0e 92 f8 4d 24 43 fa 3c  65 66 ff 7a 34 fe f4 f8  |...M$C.<ef.z4...|
-000002c0  87 47 39 4c 17 f7 5f df  19 a4 b9 6b be 9d 3e af  |.G9L.._....k..>.|
-000002d0  cf 4f e7 db 75 a9 8d cd  2f e1 24 1b 26 2a c4 f2  |.O..u.../.$.&*..|
-000002e0  5d 7f 84 22 c0 9f 12 07  8e 49 a9 a3 ca 54 45 e0  |]..".....I...TE.|
-000002f0  38 58 b2 f7 3a c8 d8 08  4e ae 1b da 5f 3c 80 21  |8X..:...N..._<.!|
-00000300  67 3c 28 b1 19 b4 5d b1  d6 f7 79 bd 5a cc 4f f8  |g<(...]...y.Z.O.|
-00000310  b1 16 9c fc 79 53 f2 06  a1 fd 14 03 03 00 01 01  |....yS..........|
-00000320  16 03 03 00 40 f5 e5 0e  b1 54 f8 2f f4 3d c3 03  |....@....T./.=..|
-00000330  08 4e 48 67 5c e5 71 de  ae 38 3b a8 15 15 99 7c  |.NHg\.q..8;....||
-00000340  23 71 0a 3e d3 e2 52 36  ba ac 67 6d 9c b1 24 5b  |#q.>..R6..gm..$[|
-00000350  6e be ac 82 e2 9d be 00  15 10 93 b8 3a 13 1f 39  |n...........:..9|
-00000360  f9 a4 69 7d ba                                    |..i}.|
+00000000  16 03 03 00 07 0b 00 00  03 00 00 00 16 03 03 00  |................|
+00000010  86 10 00 00 82 00 80 2e  43 3b 39 9a be ef de 53  |........C;9....S|
+00000020  4a 94 a3 a3 bd 92 93 44  e7 27 be f9 97 c9 1b fd  |J......D.'......|
+00000030  22 1b 6a 6c c3 79 87 45  01 a8 e0 ee 34 5a 23 61  |".jl.y.E....4Z#a|
+00000040  25 e4 06 88 fd b5 0d a3  dc e4 64 02 14 7e 47 fb  |%.........d..~G.|
+00000050  3b 88 7d 7f a9 e2 63 64  1a 15 db c6 de 03 a0 ed  |;.}...cd........|
+00000060  3c 33 b6 2f cc 2a fe 44  8f d7 be 61 0f e5 ea 2f  |<3./.*.D...a.../|
+00000070  63 7f c1 fa bc de d3 fd  10 3e 89 48 2c cf ab 57  |c........>.H,..W|
+00000080  ee b4 04 11 8c 2e 2d ec  b9 e5 d0 ac e7 b7 4d 60  |......-.......M`|
+00000090  fd fe 7f 88 f1 35 9b 14  03 03 00 01 01 16 03 03  |.....5..........|
+000000a0  00 40 ae 7d 3a a0 36 5b  4c b2 fe d7 3d 8b e8 45  |.@.}:.6[L...=..E|
+000000b0  f3 43 ae c4 d0 62 74 b5  44 38 3e f0 fd 68 f2 0b  |.C...bt.D8>..h..|
+000000c0  4a e6 b9 e8 59 4d 84 6a  cd a3 83 5a 95 8f 7a a8  |J...YM.j...Z..z.|
+000000d0  32 db b7 cd ef e8 5a dc  25 e5 1b 5f 02 7b e7 02  |2.....Z.%.._.{..|
+000000e0  fd d1                                             |..|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 0c ec ca e3 53  |...............S|
-00000020  35 9f 4d ed ec 1b c4 53  51 42 01 83 7b 4e dd 8b  |5.M....SQB..{N..|
-00000030  1c 78 b7 22 46 0b da f3  b4 c2 21 a9 7d 43 b4 53  |.x."F.....!.}C.S|
-00000040  fb 50 8f f6 95 74 16 c7  f9 fe df 17 03 03 00 40  |.P...t.........@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 18 1c 14 83 35  |...............5|
+00000020  c3 40 2a 62 72 5d 6f 23  98 1e 1c cf 3c 1f 76 f0  |.@*br]o#....<.v.|
+00000030  49 cb 62 80 32 e6 d8 6d  95 9b 58 47 2d 65 ff 25  |I.b.2..m..XG-e.%|
+00000040  00 99 db 92 58 e0 e9 09  90 c3 72 17 03 03 00 40  |....X.....r....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  f0 c3 31 40 61 36 8c a3  28 47 d7 b0 5c 66 b2 e0  |..1@a6..(G..\f..|
-00000070  72 4c 3f f6 91 0a 70 4b  1b ce ce 73 87 42 89 f5  |rL?...pK...s.B..|
-00000080  ce 47 b3 28 17 e7 1b b7  25 7c c1 14 6c 8d 23 40  |.G.(....%|..l.#@|
+00000060  b5 9c b1 d1 30 6e 93 66  69 07 47 f6 31 ad e9 e1  |....0n.fi.G.1...|
+00000070  c5 d4 5c 98 ac 00 41 cd  84 c3 56 61 b1 36 fd ad  |..\...A...Va.6..|
+00000080  7f c6 b1 27 1d ef b9 ba  43 a1 7e f4 71 d9 55 6e  |...'....C.~.q.Un|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 b4 53 25  de b7 d8 e3 15 17 74 79  |......S%......ty|
-000000b0  cf d2 cb 77 c9 f2 d2 17  84 99 6c ff ce 8a 14 80  |...w......l.....|
-000000c0  aa bd bc f6 08                                    |.....|
+000000a0  00 00 00 00 00 3f 1a f4  80 31 9b 60 c0 28 76 79  |.....?...1.`.(vy|
+000000b0  c1 8f 65 f6 d3 b6 6d 99  6d 11 fa bc a6 b8 bf 7f  |..e...m.m.......|
+000000c0  8b ca c5 a1 cd                                    |.....|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndPKCS1v15Given b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndPKCS1v15Given
index 750cff3ab9..1bb602d078 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndPKCS1v15Given
+++ b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndPKCS1v15Given
@@ -1,11 +1,14 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 6b 01 00 00  67 03 03 b7 55 25 a3 57  |....k...g...U%.W|
-00000010  90 c6 59 4a 6e a0 62 cf  aa d0 c0 6b 56 d7 a7 a4  |..YJn.b....kV...|
-00000020  75 43 5d c9 c2 e8 96 fd  eb f1 e2 00 00 04 00 2f  |uC]............/|
-00000030  00 ff 01 00 00 3a 00 00  00 0e 00 0c 00 00 09 31  |.....:.........1|
+00000000  16 03 01 00 97 01 00 00  93 03 03 b1 59 5d 29 7f  |............Y]).|
+00000010  90 9c ef 9d ae 0a 91 6c  ab 05 fb 58 f7 79 9b c4  |.......l...X.y..|
+00000020  22 e1 ab 55 5c ea d1 24  27 2a 63 00 00 04 00 2f  |"..U\..$'*c..../|
+00000030  00 ff 01 00 00 66 00 00  00 0e 00 0c 00 00 09 31  |.....f.........1|
 00000040  32 37 2e 30 2e 30 2e 31  00 0b 00 04 03 00 01 02  |27.0.0.1........|
 00000050  00 0a 00 0c 00 0a 00 1d  00 17 00 1e 00 19 00 18  |................|
-00000060  00 16 00 00 00 17 00 00  00 0d 00 04 00 02 04 01  |................|
+00000060  00 16 00 00 00 17 00 00  00 0d 00 30 00 2e 04 03  |...........0....|
+00000070  05 03 06 03 08 07 08 08  08 09 08 0a 08 0b 08 04  |................|
+00000080  08 05 08 06 04 01 05 01  06 01 03 03 02 03 03 01  |................|
+00000090  02 01 03 02 02 02 04 02  05 02 06 02              |............|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 31 02 00 00  2d 03 03 00 00 00 00 00  |....1...-.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -48,10 +51,9 @@
 00000260  f1 6c 04 ed 73 bb b3 43  77 8d 0c 1c f1 0f a1 d8  |.l..s..Cw.......|
 00000270  40 83 61 c9 4c 72 2b 9d  ae db 46 06 06 4d f4 c1  |@.a.Lr+...F..M..|
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
-00000290  3b e9 fa e7 16 03 03 00  23 0d 00 00 1f 02 01 40  |;.......#......@|
-000002a0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000002b0  06 01 05 03 06 03 02 01  02 03 00 00 16 03 03 00  |................|
-000002c0  04 0e 00 00 00                                    |.....|
+00000290  3b e9 fa e7 16 03 03 00  1d 0d 00 00 19 02 01 40  |;..............@|
+000002a0  00 12 04 01 04 03 08 07  05 01 06 01 05 03 06 03  |................|
+000002b0  02 01 02 03 00 00 16 03  03 00 04 0e 00 00 00     |...............|
 >>> Flow 3 (client to server)
 00000000  16 03 03 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
 00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
@@ -85,40 +87,40 @@
 000001d0  ac 11 b1 28 56 be 1d cd  61 62 84 09 bf d6 80 c6  |...(V...ab......|
 000001e0  45 8d 82 2c b4 d8 83 9b  db c9 22 b7 2a 12 11 7b  |E..,......".*..{|
 000001f0  fa 02 3b c1 c9 ff ea c9  9d a8 49 d3 95 d7 d5 0e  |..;.......I.....|
-00000200  e5 35 16 03 03 00 86 10  00 00 82 00 80 a2 92 cd  |.5..............|
-00000210  ec 2d c5 10 6e 42 8b 0a  b3 fc c5 84 c6 b0 9e 61  |.-..nB.........a|
-00000220  6c bd 97 9e 63 7c 94 5f  4c 91 ad c1 c1 5e d7 a4  |l...c|._L....^..|
-00000230  3e 44 23 c0 fd 5b ea ef  fa 68 b9 93 a1 83 b6 ed  |>D#..[...h......|
-00000240  df 97 1e 39 04 22 d5 8c  44 2f 91 dd fd aa 24 91  |...9."..D/....$.|
-00000250  a3 e3 a7 c3 ab 61 71 80  8d b1 fd b9 fa cc 0e 8d  |.....aq.........|
-00000260  66 e1 9a cc da 95 9f aa  00 c9 a1 24 65 54 86 74  |f..........$eT.t|
-00000270  5b ca b6 dc 5b 96 64 ad  60 18 f5 9e 27 dd b1 dc  |[...[.d.`...'...|
-00000280  47 5a 32 36 41 86 0e db  ab e2 67 7f 04 16 03 03  |GZ26A.....g.....|
-00000290  00 88 0f 00 00 84 04 01  00 80 5d 71 bd f9 35 58  |..........]q..5X|
-000002a0  03 e9 8e 20 e0 bc 70 9e  ba ba 82 d9 27 b7 8d 32  |... ..p.....'..2|
-000002b0  c8 9a 57 c5 53 af f6 1f  99 75 4e 3d 58 c1 4d 06  |..W.S....uN=X.M.|
-000002c0  1a c9 a2 1d de a0 73 9a  c6 76 0e 93 d1 fa 00 08  |......s..v......|
-000002d0  84 d8 4b 4b 80 59 77 ef  fe eb d6 7f 53 6c db e8  |..KK.Yw.....Sl..|
-000002e0  60 51 b5 48 41 ba 97 71  f4 b6 4b 94 e5 bd d5 ce  |`Q.HA..q..K.....|
-000002f0  a6 7c ee f2 1f 84 48 4f  d2 27 b2 24 73 b3 c3 0f  |.|....HO.'.$s...|
-00000300  ea 9f cf 31 de 25 71 1c  91 ec b4 79 2a 47 d0 c3  |...1.%q....y*G..|
-00000310  56 cc 30 54 12 fe 59 a4  55 ab 14 03 03 00 01 01  |V.0T..Y.U.......|
-00000320  16 03 03 00 40 2b 02 10  71 bb 12 3a 19 18 f0 28  |....@+..q..:...(|
-00000330  ea 5e 65 e7 ea d6 64 21  21 b4 c2 04 9b 38 6f 42  |.^e...d!!....8oB|
-00000340  dc f7 92 3d 9a ce 4f 9f  bd ee 6d 7b 1c cd d7 4b  |...=..O...m{...K|
-00000350  80 ba 72 09 66 3e 73 00  88 1d 28 3c 59 1d 4b 71  |..r.f>s...(<Y.Kq|
-00000360  3e e2 bc e6 b3                                    |>....|
+00000200  e5 35 16 03 03 00 86 10  00 00 82 00 80 aa ad 37  |.5.............7|
+00000210  05 40 cc 04 19 d0 de aa  25 9f 20 4e ce 74 f5 70  |.@......%. N.t.p|
+00000220  ae 17 f0 29 a4 37 ac 84  67 06 da 17 9f 26 dc ab  |...).7..g....&..|
+00000230  96 c4 13 d6 a5 e5 93 57  70 17 f2 f1 fb 0e a2 e4  |.......Wp.......|
+00000240  85 82 ea 63 ab 6f 6e 1f  0b 12 e7 35 ce b0 79 da  |...c.on....5..y.|
+00000250  95 cf de 7d 8b be 5e cc  d5 8e 00 02 fe 67 61 b4  |...}..^......ga.|
+00000260  69 2c 09 90 ae 6c df 29  45 67 79 8e fe 91 fb 3e  |i,...l.)Egy....>|
+00000270  1e ec 95 11 6c 6a 15 2f  93 59 41 34 8a 35 b0 7c  |....lj./.YA4.5.||
+00000280  22 ee bb 99 cc 3d 05 1f  7b 1b 96 f6 bc 16 03 03  |"....=..{.......|
+00000290  00 88 0f 00 00 84 04 01  00 80 a5 b1 55 c7 8c 86  |............U...|
+000002a0  c1 c2 60 2d ad 40 f1 ca  56 25 39 e7 c1 83 7f 16  |..`-.@..V%9.....|
+000002b0  08 6a c9 23 6a 82 73 63  bf 1a 32 de 85 82 2a bc  |.j.#j.sc..2...*.|
+000002c0  a0 99 db ea 34 26 27 8f  c6 36 b7 53 b5 76 75 2e  |....4&'..6.S.vu.|
+000002d0  48 26 bb b0 65 55 68 57  12 cb 9c 93 96 fc 88 fc  |H&..eUhW........|
+000002e0  73 56 c1 1e 04 ae 41 aa  ad b7 f8 58 7a 55 a9 74  |sV....A....XzU.t|
+000002f0  5b b5 12 08 25 ef c1 0f  4c 39 7b c5 07 d9 34 66  |[...%...L9{...4f|
+00000300  15 d3 76 a2 65 8c 4c ce  9a 89 0f 1f a9 5f d0 93  |..v.e.L......_..|
+00000310  3e ed 92 be 42 4c fe 23  ea 40 14 03 03 00 01 01  |>...BL.#.@......|
+00000320  16 03 03 00 40 89 ff 92  80 9b 37 4b 6f 8f 3a 22  |....@.....7Ko.:"|
+00000330  aa ab 60 1f 4d 49 ba 75  b2 dc 83 06 22 5a 89 5d  |..`.MI.u...."Z.]|
+00000340  1f 95 fa 0c 18 80 a0 5a  96 09 93 7b 06 cb 6c aa  |.......Z...{..l.|
+00000350  74 79 ea ae 02 e7 a7 c9  44 0b 6d f7 f7 b2 04 8f  |ty......D.m.....|
+00000360  6e 46 2d f1 6b                                    |nF-.k|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 9a 35 84 25 85  |............5.%.|
-00000020  58 51 15 f1 61 6a f7 92  a7 0e 1a 62 3f 73 08 3c  |XQ..aj.....b?s.<|
-00000030  48 e1 f6 75 07 76 4a d4  fc 5d ff 81 d8 39 81 96  |H..u.vJ..]...9..|
-00000040  0d 13 be 17 3a 94 4b 9e  22 bf cc 17 03 03 00 40  |....:.K."......@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 67 84 0f 78 e0  |...........g..x.|
+00000020  91 c8 d4 4b 1c 69 95 f8  6c 30 23 55 2b 04 4b 24  |...K.i..l0#U+.K$|
+00000030  58 0a 46 06 94 00 72 95  77 77 4c d7 82 87 69 0a  |X.F...r.wwL...i.|
+00000040  4c 78 8a 12 76 27 ae 65  c9 20 c4 17 03 03 00 40  |Lx..v'.e. .....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  a4 83 1d d8 97 26 43 9f  99 37 14 4d bf 3a 1e 3e  |.....&C..7.M.:.>|
-00000070  0c 30 ff 88 b1 22 0d e6  bc a6 2c ce 16 8c 6d d6  |.0..."....,...m.|
-00000080  c8 90 96 34 bb 63 08 4c  18 d2 f7 d3 63 ab aa 7f  |...4.c.L....c...|
+00000060  13 3b e0 4b cd 52 d3 6c  90 91 37 38 1d 9c 75 a2  |.;.K.R.l..78..u.|
+00000070  02 a3 3f 1a 43 6c aa f4  17 da 4e 01 d7 8c 74 5e  |..?.Cl....N...t^|
+00000080  f4 d3 61 cf 3c 7f 55 73  17 e7 d1 c3 a0 da 24 c4  |..a.<.Us......$.|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 00 35 b2  33 d0 f1 dd 5b dd c7 8e  |......5.3...[...|
-000000b0  62 eb cc 0e 7c a0 93 74  d9 65 d3 6e 8c 87 f0 36  |b...|..t.e.n...6|
-000000c0  0a 76 0a d8 63                                    |.v..c|
+000000a0  00 00 00 00 00 28 75 97  89 88 21 2e fe 9b 81 87  |.....(u...!.....|
+000000b0  2a 37 f0 81 9f 76 a2 27  a4 78 69 30 87 2c 09 6e  |*7...v.'.xi0.,.n|
+000000c0  55 90 fb ab b6                                    |U....|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedNotGiven b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedNotGiven
index 833d331697..5711a3f6b6 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedNotGiven
+++ b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedNotGiven
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 97 01 00 00  93 03 03 af 6e 31 55 9f  |............n1U.|
-00000010  fb 22 73 ce a2 0a b6 a3  3e 13 14 83 09 8c e2 98  |."s.....>.......|
-00000020  c3 6f a3 80 79 e4 7c c5  ff 4e a4 00 00 04 00 2f  |.o..y.|..N...../|
+00000000  16 03 01 00 97 01 00 00  93 03 03 67 52 bd 6c 6c  |...........gR.ll|
+00000010  76 8e 81 75 11 23 27 99  07 bf 64 96 13 0b 85 78  |v..u.#'...d....x|
+00000020  b4 5b b9 b0 a8 b5 fc 87  ef f2 0e 00 00 04 00 2f  |.[............./|
 00000030  00 ff 01 00 00 66 00 00  00 0e 00 0c 00 00 09 31  |.....f.........1|
 00000040  32 37 2e 30 2e 30 2e 31  00 0b 00 04 03 00 01 02  |27.0.0.1........|
 00000050  00 0a 00 0c 00 0a 00 1d  00 17 00 1e 00 19 00 18  |................|
@@ -51,37 +51,36 @@
 00000260  f1 6c 04 ed 73 bb b3 43  77 8d 0c 1c f1 0f a1 d8  |.l..s..Cw.......|
 00000270  40 83 61 c9 4c 72 2b 9d  ae db 46 06 06 4d f4 c1  |@.a.Lr+...F..M..|
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
-00000290  3b e9 fa e7 16 03 03 00  23 0d 00 00 1f 02 01 40  |;.......#......@|
-000002a0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000002b0  06 01 05 03 06 03 02 01  02 03 00 00 16 03 03 00  |................|
-000002c0  04 0e 00 00 00                                    |.....|
+00000290  3b e9 fa e7 16 03 03 00  1d 0d 00 00 19 02 01 40  |;..............@|
+000002a0  00 12 04 01 04 03 08 07  05 01 06 01 05 03 06 03  |................|
+000002b0  02 01 02 03 00 00 16 03  03 00 04 0e 00 00 00     |...............|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 07 0b 00 00  03 00 00 00 16 03 03 00  |................|
-00000010  86 10 00 00 82 00 80 5b  78 d7 5b 4f e3 55 1f 34  |.......[x.[O.U.4|
-00000020  60 be e9 68 07 28 c0 42  b1 ff 31 2f ac 41 19 1e  |`..h.(.B..1/.A..|
-00000030  5b c3 7a d4 e4 59 49 4a  ed be b9 95 6c d5 58 4a  |[.z..YIJ....l.XJ|
-00000040  4a f5 ea f7 00 39 8b f0  6a c6 5a 5f 4e 53 40 20  |J....9..j.Z_NS@ |
-00000050  70 88 5a d4 e0 9e 25 a2  d5 50 1e 22 ed 02 14 f9  |p.Z...%..P."....|
-00000060  eb 32 dd d2 9c 66 20 4c  4d a1 97 91 48 6f 39 cf  |.2...f LM...Ho9.|
-00000070  ae e4 33 4e d9 4d 96 fa  13 39 1d b4 16 85 08 4a  |..3N.M...9.....J|
-00000080  8f dc b6 f3 19 05 de 16  aa 3d 5e 71 e7 38 ff 3d  |.........=^q.8.=|
-00000090  77 5b 63 df d2 32 3d 14  03 03 00 01 01 16 03 03  |w[c..2=.........|
-000000a0  00 40 d7 df c5 1f ec 3c  10 77 53 78 8f c7 8a 79  |.@.....<.wSx...y|
-000000b0  17 3a 31 57 6f e3 e8 85  3f 33 75 0a f8 a8 4d cc  |.:1Wo...?3u...M.|
-000000c0  70 0a d9 d0 8b 87 b5 d4  74 c8 8d 30 3b 80 bd 8c  |p.......t..0;...|
-000000d0  cb 42 6f e9 e5 c9 a6 28  16 6d 7a d8 13 cb 57 30  |.Bo....(.mz...W0|
-000000e0  3d 77                                             |=w|
+00000010  86 10 00 00 82 00 80 31  7f 5d 8c 38 ee d7 05 14  |.......1.].8....|
+00000020  4c 0f 9d 01 2d 80 e9 71  0a 51 69 7b af 75 43 76  |L...-..q.Qi{.uCv|
+00000030  d7 eb 18 14 11 00 82 df  f4 e8 d1 83 5e 32 60 6e  |............^2`n|
+00000040  49 6d 1a 3f b2 ac 85 9f  f3 3c 3c cd f2 0d a8 e0  |Im.?.....<<.....|
+00000050  06 f3 6f 96 18 a0 76 06  c3 73 89 b4 de 30 ed 7b  |..o...v..s...0.{|
+00000060  7e 71 2d 13 88 43 ff a7  42 bb 2c 17 73 5f 67 8f  |~q-..C..B.,.s_g.|
+00000070  68 e7 52 84 72 34 08 69  c6 f5 1b e9 2b 42 93 90  |h.R.r4.i....+B..|
+00000080  3f 76 f3 89 9f 70 65 da  9c ce 8c bf a3 38 65 e3  |?v...pe......8e.|
+00000090  cf b9 f9 c6 d9 86 a5 14  03 03 00 01 01 16 03 03  |................|
+000000a0  00 40 e7 dd bf f7 33 bc  f2 90 a3 43 fa 43 ec 7e  |.@....3....C.C.~|
+000000b0  e6 06 28 c1 3f 83 c5 50  65 6d 6b e7 37 cf e7 4b  |..(.?..Pemk.7..K|
+000000c0  85 34 3b df 4f 48 82 30  d0 43 f7 00 c4 3f 03 dd  |.4;.OH.0.C...?..|
+000000d0  ef c0 d4 04 48 b4 9b ec  f0 65 7c 2a bc 87 24 5f  |....H....e|*..$_|
+000000e0  7a d5                                             |z.|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 93 43 99 29 17  |............C.).|
-00000020  5b 96 2e 5b 22 fc 53 47  b2 85 76 46 d9 1a f2 12  |[..[".SG..vF....|
-00000030  58 e0 0e 0d 0f dc 88 a2  0f b1 00 39 ed d7 99 58  |X..........9...X|
-00000040  99 7b c5 ba 91 a3 72 05  1e 9e c2 17 03 03 00 40  |.{....r........@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 da 0a 2a 09 ef  |.............*..|
+00000020  39 6c c9 6d cc c3 ae 56  cd e1 a8 47 26 ec 9c b7  |9l.m...V...G&...|
+00000030  50 eb 2e 10 d4 15 3e 5e  cc 65 78 2e 47 bf 18 e8  |P.....>^.ex.G...|
+00000040  62 59 bb 7c b7 2c 28 b1  ea 82 10 17 03 03 00 40  |bY.|.,(........@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  f3 ff e7 4d b6 ca 7c 95  ed 96 13 88 70 b3 2c 8b  |...M..|.....p.,.|
-00000070  9b 0c 51 77 75 16 b4 c0  df 9f 1a c4 86 68 82 10  |..Qwu........h..|
-00000080  41 c7 1e e5 92 49 ce a3  6f c3 bc 0a 91 04 b6 fa  |A....I..o.......|
+00000060  9e 53 10 86 89 0c 8f 14  0c 22 6c 32 33 34 64 83  |.S......."l234d.|
+00000070  28 7c 02 b3 59 b7 b2 60  5a ec f2 a7 1a 21 04 dd  |(|..Y..`Z....!..|
+00000080  2a c0 ca 68 07 85 8f 7d  6b da 26 97 52 91 40 e8  |*..h...}k.&.R.@.|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 2c e7 ff  bb 3a f5 00 08 d3 8c 3f  |.....,...:.....?|
-000000b0  89 bf 97 de fc c4 91 59  2f 7b b3 b8 ea d0 b1 05  |.......Y/{......|
-000000c0  ca ff d0 78 9f                                    |...x.|
+000000a0  00 00 00 00 00 f4 ae 69  5a bc af 94 f9 7f 60 d1  |.......iZ.....`.|
+000000b0  36 83 e7 23 13 79 ae c1  5a 3b 35 d0 ed 16 12 ac  |6..#.y..Z;5.....|
+000000c0  52 b5 4e eb 31                                    |R.N.1|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ExportKeyingMaterial b/src/crypto/tls/testdata/Server-TLSv12-ExportKeyingMaterial
index 7d7ee63861..b777c62415 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ExportKeyingMaterial
+++ b/src/crypto/tls/testdata/Server-TLSv12-ExportKeyingMaterial
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 cf 01 00 00  cb 03 03 79 bf 0b 29 ec  |...........y..).|
-00000010  6a 0b 84 1e 2c d5 bf 30  b7 55 b9 7b 77 69 8f 9a  |j...,..0.U.{wi..|
-00000020  71 34 c9 83 d1 af de 50  d5 d6 fc 00 00 38 c0 2c  |q4.....P.....8.,|
+00000000  16 03 01 00 cf 01 00 00  cb 03 03 54 13 f1 1a dc  |...........T....|
+00000010  39 72 b7 e7 86 ac 83 df  9b 75 9e 71 40 7a 14 b3  |9r.......u.q@z..|
+00000020  fc ad 99 d1 8a 4f d0 d9  a3 f0 3d 00 00 38 c0 2c  |.....O....=..8.,|
 00000030  c0 30 00 9f cc a9 cc a8  cc aa c0 2b c0 2f 00 9e  |.0.........+./..|
 00000040  c0 24 c0 28 00 6b c0 23  c0 27 00 67 c0 0a c0 14  |.$.(.k.#.'.g....|
 00000050  00 39 c0 09 c0 13 00 33  00 9d 00 9c 00 3d 00 3c  |.9.....3.....=.<|
@@ -58,38 +58,38 @@
 00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 ac 0c 00 00  |.\!.;...........|
 000002a0  a8 03 00 1d 20 2f e5 7d  a3 47 cd 62 43 15 28 da  |.... /.}.G.bC.(.|
 000002b0  ac 5f bb 29 07 30 ff f6  84 af c4 cf c2 ed 90 99  |._.).0..........|
-000002c0  5f 58 cb 3b 74 08 04 00  80 36 12 82 aa d1 40 60  |_X.;t....6....@`|
-000002d0  6c fb da 0b 04 f6 23 94  3f 3d 8c a5 f4 fe ed 1f  |l.....#.?=......|
-000002e0  be 25 85 94 c9 2f 19 64  52 2b 8a 13 29 52 ae 77  |.%.../.dR+..)R.w|
-000002f0  ca 24 40 f1 31 1c f3 aa  33 29 1f cc b0 a3 8b e6  |.$@.1...3)......|
-00000300  c3 26 90 e4 11 48 e6 91  a6 5d 5e c6 18 8d 4f 2c  |.&...H...]^...O,|
-00000310  21 be bc 13 4d de bb 68  42 0b e1 29 3e 8e fc b9  |!...M..hB..)>...|
-00000320  45 ed c4 87 ed 62 1d 04  c0 4f d5 f5 94 62 65 07  |E....b...O...be.|
-00000330  8c f0 00 3d 47 f6 f5 93  e3 a9 69 ce 79 8a e5 24  |...=G.....i.y..$|
-00000340  01 d4 28 e6 f5 f5 a9 7e  ab 16 03 03 00 04 0e 00  |..(....~........|
+000002c0  5f 58 cb 3b 74 04 01 00  80 8e 2b 18 d7 2c 6d 91  |_X.;t.....+..,m.|
+000002d0  12 b3 ba 39 20 4f 43 60  08 d3 63 6e 55 01 50 3c  |...9 OC`..cnU.P<|
+000002e0  2b 6d 09 ca 27 d6 f7 42  d1 74 19 e1 6b 06 93 06  |+m..'..B.t..k...|
+000002f0  6e e6 c4 23 cc 1b c8 de  8f 30 c2 4d 22 36 10 df  |n..#.....0.M"6..|
+00000300  32 cb f3 4e ec 9a b1 d6  63 7d 11 4e 58 d2 b7 7a  |2..N....c}.NX..z|
+00000310  70 31 4b 92 3e 27 ba f0  85 ca 7d 43 c7 68 04 6a  |p1K.>'....}C.h.j|
+00000320  fa c4 ac c1 16 8b 18 c9  2e 94 2e c2 a6 f3 f0 f3  |................|
+00000330  fb 8a 21 6d 4f 3d bc 0f  fa 21 fd d5 78 57 6c 38  |..!mO=...!..xWl8|
+00000340  09 48 64 d6 ca b6 31 3c  39 16 03 03 00 04 0e 00  |.Hd...1<9.......|
 00000350  00 00                                             |..|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 ea 09 8a 21 18 89  |....%...! ...!..|
-00000010  7d 4f ee 95 8e 6c 1a 07  22 59 e7 f9 05 41 2a c2  |}O...l.."Y...A*.|
-00000020  ad 51 71 9c a4 0e 08 eb  49 71 14 03 03 00 01 01  |.Qq.....Iq......|
-00000030  16 03 03 00 28 6a ab 19  f6 b6 cb 70 34 ee 73 d2  |....(j.....p4.s.|
-00000040  05 bf 99 37 44 b7 f9 1e  b1 8a 3d f9 13 bd 0c 77  |...7D.....=....w|
-00000050  02 b0 64 08 f9 d9 f2 96  b4 5b 87 ff 0b           |..d......[...|
+00000000  16 03 03 00 25 10 00 00  21 20 af 4c 6e 57 5e f7  |....%...! .LnW^.|
+00000010  49 e2 89 33 f9 47 59 7c  81 5c 63 74 cd 27 6a 65  |I..3.GY|.\ct.'je|
+00000020  b6 55 d1 72 ad 60 08 d0  c6 6a 14 03 03 00 01 01  |.U.r.`...j......|
+00000030  16 03 03 00 28 69 f2 a5  05 8c a5 a7 5f 8f 8b cf  |....(i......_...|
+00000040  7a 18 fb f4 45 5e 1f f8  ba 60 2e fa c6 8c c6 57  |z...E^...`.....W|
+00000050  89 ac 8a 85 71 00 21 65  f3 a6 99 5d 3b           |....q.!e...];|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 82 04 00 00  7e 00 00 00 00 00 78 50  |........~.....xP|
 00000010  46 ad c1 db a8 38 86 7b  2b bb fd d0 c3 42 3e 00  |F....8.{+....B>.|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000030  6f ec 80 83 61 db f0 ce  92 57 a1 db 00 84 5e 78  |o...a....W....^x|
-00000040  0e f7 97 3e f5 f0 e8 73  d6 b0 a7 28 8f bb 24 b1  |...>...s...(..$.|
-00000050  a9 3f 60 a3 7a f2 c1 a6  12 0e 69 3b 72 89 dd 36  |.?`.z.....i;r..6|
-00000060  d8 ff 80 5d 71 33 94 32  01 77 ce 77 5e ac b8 05  |...]q3.2.w.w^...|
-00000070  69 68 e5 81 51 4d 52 f6  e9 c5 cd 70 56 23 3c aa  |ih..QMR....pV#<.|
-00000080  2e c6 a2 d6 e3 5f 29 14  03 03 00 01 01 16 03 03  |....._).........|
-00000090  00 28 00 00 00 00 00 00  00 00 59 27 e3 e7 05 60  |.(........Y'...`|
-000000a0  03 68 93 6d 28 1d 8e 7f  f1 c8 a6 eb b4 57 a5 22  |.h.m(........W."|
-000000b0  98 ce 7e 56 00 44 fe d5  5e 26 17 03 03 00 25 00  |..~V.D..^&....%.|
-000000c0  00 00 00 00 00 00 01 9d  87 53 e9 29 e4 d7 45 29  |.........S.)..E)|
-000000d0  ef 71 a6 7e b8 99 d4 4f  08 da 11 6b 9b d2 20 b9  |.q.~...O...k.. .|
-000000e0  c4 ae 7f 84 15 03 03 00  1a 00 00 00 00 00 00 00  |................|
-000000f0  02 06 17 a2 45 91 d0 b0  50 aa 8f a2 f1 8b 48 cf  |....E...P.....H.|
-00000100  40 87 a4                                          |@..|
+00000030  6f ec 80 83 61 0d 24 39  c2 e0 e0 85 93 37 1f 40  |o...a.$9.....7.@|
+00000040  0a 0e a7 45 0e 81 37 6c  7a 11 ed e6 c0 f1 69 23  |...E..7lz.....i#|
+00000050  df 14 01 ff ff 52 2f ac  da 15 14 5b a2 07 c8 bc  |.....R/....[....|
+00000060  82 4f 2b 5b 71 33 94 09  17 b4 83 76 62 b7 46 9d  |.O+[q3.....vb.F.|
+00000070  6f 0d de c2 8b a8 ce 6e  2e df f4 a3 59 fc af f2  |o......n....Y...|
+00000080  fe 3f 1e d6 75 b5 63 14  03 03 00 01 01 16 03 03  |.?..u.c.........|
+00000090  00 28 00 00 00 00 00 00  00 00 ae 8b f0 21 94 08  |.(...........!..|
+000000a0  ec aa a6 f5 40 81 5a a2  42 f7 0a 9b 6b e6 8d 7a  |....@.Z.B...k..z|
+000000b0  44 e1 85 41 fc 83 f0 e1  c0 c2 17 03 03 00 25 00  |D..A..........%.|
+000000c0  00 00 00 00 00 00 01 c4  a7 e5 72 e4 09 d0 21 b8  |..........r...!.|
+000000d0  99 ae f0 6a 2c 1c a4 ca  ae 44 79 92 ae 25 f8 37  |...j,....Dy..%.7|
+000000e0  d8 49 f3 21 15 03 03 00  1a 00 00 00 00 00 00 00  |.I.!............|
+000000f0  02 76 b5 79 33 82 76 50  e3 2b 03 e9 b8 14 2d 51  |.v.y3.vP.+....-Q|
+00000100  ac f9 6d                                          |..m|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-P256 b/src/crypto/tls/testdata/Server-TLSv12-P256
index 5295d60a8d..4e302b374c 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-P256
+++ b/src/crypto/tls/testdata/Server-TLSv12-P256
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8f 01 00 00  8b 03 03 e8 ef f7 4f 44  |..............OD|
-00000010  1a 63 08 10 fe aa 68 d5  75 18 f5 6c de 83 50 d2  |.c....h.u..l..P.|
-00000020  bb 86 6e 48 d0 cb 97 c4  56 46 9f 00 00 04 c0 2f  |..nH....VF...../|
+00000000  16 03 01 00 8f 01 00 00  8b 03 03 b1 a0 04 30 1e  |..............0.|
+00000010  a1 09 cb 31 c4 1a 15 e7  a6 06 b5 fb 51 da d6 01  |...1........Q...|
+00000020  dc c0 cc 17 85 e5 c4 c6  b1 da be 00 00 04 c0 2f  |.............../|
 00000030  00 ff 01 00 00 5e 00 00  00 0e 00 0c 00 00 09 31  |.....^.........1|
 00000040  32 37 2e 30 2e 30 2e 31  00 0b 00 04 03 00 01 02  |27.0.0.1........|
 00000050  00 0a 00 04 00 02 00 17  00 16 00 00 00 17 00 00  |................|
@@ -56,30 +56,30 @@
 000002b0  5b 12 2e 8f 09 67 fd a7  24 20 3e b2 56 1c ce 97  |[....g..$ >.V...|
 000002c0  28 5e f8 2b 2d 4f 9e f1  07 9f 6c 4b 5b 83 56 e2  |(^.+-O....lK[.V.|
 000002d0  32 42 e9 58 b6 d7 49 a6  b5 68 1a 41 03 56 6b dc  |2B.X..I..h.A.Vk.|
-000002e0  5a 89 08 04 00 80 b8 fd  6d 56 36 b6 b3 8a 6c cb  |Z.......mV6...l.|
-000002f0  6b 52 79 28 45 97 1e 97  1b 7f 96 2e e0 b0 23 af  |kRy(E.........#.|
-00000300  cb 13 cf dc e6 11 2b 04  88 08 56 2d a4 3a b1 7e  |......+...V-.:.~|
-00000310  79 b5 de 25 35 6b 82 98  d9 9e be 99 d4 37 bf 19  |y..%5k.......7..|
-00000320  bb 0e 25 86 b6 19 e8 58  de ab 63 ed 3c 09 d6 6b  |..%....X..c.<..k|
-00000330  f5 da 16 e6 75 5d e7 7b  e5 54 1b de 03 1d cd fb  |....u].{.T......|
-00000340  3d 9f 24 cc ff 07 d2 cb  f2 0b 4a 61 57 ec 84 dd  |=.$.......JaW...|
-00000350  92 44 da 71 a2 31 ba 2e  68 19 2b ee 90 19 12 a5  |.D.q.1..h.+.....|
-00000360  59 53 28 9d 0a 87 16 03  03 00 04 0e 00 00 00     |YS(............|
+000002e0  5a 89 04 01 00 80 bb 79  4d c9 d6 77 df 13 46 e6  |Z......yM..w..F.|
+000002f0  82 30 7a 03 2e 58 a8 bf  2a 53 c4 58 0a 9a 9a 0f  |.0z..X..*S.X....|
+00000300  72 51 a9 91 5b f7 88 f1  de 28 1d 56 79 2c da 89  |rQ..[....(.Vy,..|
+00000310  a4 de 25 65 20 f7 a1 a4  b1 ff 3c 5a cd 67 24 9b  |..%e .....<Z.g$.|
+00000320  44 fc a4 27 07 1b 75 88  3c 75 78 c7 b9 ec 77 4a  |D..'..u.<ux...wJ|
+00000330  a3 56 c2 e3 e9 e0 51 92  07 7f ac 0c 09 88 11 21  |.V....Q........!|
+00000340  11 40 dd 9f 5b 21 2e de  f9 be 02 de c6 9d ea 06  |.@..[!..........|
+00000350  65 d6 b0 2d 1b 41 21 e8  2d 77 e2 14 96 fc 8f 39  |e..-.A!.-w.....9|
+00000360  6c 0a f8 07 8c d9 16 03  03 00 04 0e 00 00 00     |l..............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 01 9c 4d 77 6b  |....F...BA...Mwk|
-00000010  ce 2f a7 9e 8b ae ba 9d  f2 6d c8 9e 0e 54 07 c9  |./.......m...T..|
-00000020  6d e3 58 67 c6 a8 9a a5  c2 f7 27 26 84 36 e1 6f  |m.Xg......'&.6.o|
-00000030  e3 a1 89 50 7c e0 e6 88  06 b9 94 16 d8 23 cb 2e  |...P|........#..|
-00000040  ff 62 67 1e 93 cb d6 1d  f5 43 79 14 03 03 00 01  |.bg......Cy.....|
-00000050  01 16 03 03 00 28 83 36  85 d0 b7 23 5e 7d 0a 33  |.....(.6...#^}.3|
-00000060  41 0f bd 31 4d a0 32 6a  c2 67 93 cc 8f 41 f5 bd  |A..1M.2j.g...A..|
-00000070  b2 57 af 5c 90 d6 17 24  be 76 6b b4 13 ca        |.W.\...$.vk...|
+00000000  16 03 03 00 46 10 00 00  42 41 04 1b 28 eb 97 c5  |....F...BA..(...|
+00000010  63 cc e1 64 31 f9 b3 5c  61 d8 d9 28 f9 1e 9a 4b  |c..d1..\a..(...K|
+00000020  09 2a 5a b9 64 42 15 d3  06 80 64 67 93 63 e2 c6  |.*Z.dB....dg.c..|
+00000030  51 05 3c 8b 32 41 c2 a0  5a db 73 ba 77 86 7f 1b  |Q.<.2A..Z.s.w...|
+00000040  2e b4 33 9c 20 0a 40 3a  c6 90 f1 14 03 03 00 01  |..3. .@:........|
+00000050  01 16 03 03 00 28 56 75  52 fe f7 13 79 b6 c6 ba  |.....(VuR...y...|
+00000060  f1 6a 6d f2 3d 2c 8c c2  70 3e 19 ba 32 34 88 02  |.jm.=,..p>..24..|
+00000070  73 d7 d5 db b9 52 21 32  34 fb 7e e8 17 49        |s....R!24.~..I|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 28 00 00 00 00 00  |..........(.....|
-00000010  00 00 00 80 6a 93 5b 7d  70 3c bc 7c f8 d6 4e 51  |....j.[}p<.|..NQ|
-00000020  5e 34 52 13 06 c4 aa 8c  ed b5 9f aa c6 db c0 0d  |^4R.............|
-00000030  67 97 36 17 03 03 00 25  00 00 00 00 00 00 00 01  |g.6....%........|
-00000040  d6 24 e8 21 4b 2c fb 5e  79 2d ca 7b 6d 44 dd 2d  |.$.!K,.^y-.{mD.-|
-00000050  aa 3a 33 ee ea 6f e3 b7  cd c5 c3 1d 4a 15 03 03  |.:3..o......J...|
-00000060  00 1a 00 00 00 00 00 00  00 02 4f 71 74 9e 63 ad  |..........Oqt.c.|
-00000070  d7 61 b9 c7 47 d6 44 9f  b3 3d 49 34              |.a..G.D..=I4|
+00000010  00 00 00 41 e9 67 42 6b  79 56 59 80 41 c2 3a b9  |...A.gBkyVY.A.:.|
+00000020  b2 3a 06 0e 31 76 18 ba  86 a4 2d 1a 71 19 f3 f1  |.:..1v....-.q...|
+00000030  a3 bc b3 17 03 03 00 25  00 00 00 00 00 00 00 01  |.......%........|
+00000040  57 ee 6f 74 4b 56 28 ca  71 34 c0 85 0e 26 db 9c  |W.otKV(.q4...&..|
+00000050  bb 8f 3c 3f 02 a3 d4 07  61 6e 20 93 5e 15 03 03  |..<?....an .^...|
+00000060  00 1a 00 00 00 00 00 00  00 02 6e 3c 15 67 e9 53  |..........n<.g.S|
+00000070  1d 86 d8 3a ea 6b ac fc  42 bb db 8e              |...:.k..B...|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-3DES b/src/crypto/tls/testdata/Server-TLSv12-RSA-3DES
index 8d1cadf85a..7bff8eceb0 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-3DES
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-3DES
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 97 01 00 00  93 03 03 48 e2 22 70 f7  |...........H."p.|
-00000010  9a 24 ce 92 69 d1 ff fc  c0 c9 ba b2 da 8e 83 7a  |.$..i..........z|
-00000020  6e 8d 24 60 e2 e2 81 76  e6 72 37 00 00 04 00 0a  |n.$`...v.r7.....|
+00000000  16 03 01 00 97 01 00 00  93 03 03 ed c3 64 89 19  |.............d..|
+00000010  3b fd 11 f4 d8 c9 2a d5  a8 8b 18 b5 92 cb ff c1  |;.....*.........|
+00000020  10 9a b1 a7 e4 d5 bc 78  39 29 30 00 00 04 00 0a  |.......x9)0.....|
 00000030  00 ff 01 00 00 66 00 00  00 0e 00 0c 00 00 09 31  |.....f.........1|
 00000040  32 37 2e 30 2e 30 2e 31  00 0b 00 04 03 00 01 02  |27.0.0.1........|
 00000050  00 0a 00 0c 00 0a 00 1d  00 17 00 1e 00 19 00 18  |................|
@@ -53,27 +53,27 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 20 44 e6 19 b2  |........... D...|
-00000010  c5 9f 95 af 90 29 b2 5c  e9 c5 29 8c a2 bd 72 49  |.....).\..)...rI|
-00000020  8d c8 ea e8 cc bd 65 d9  1c fe 95 f0 60 0e ee 13  |......e.....`...|
-00000030  ea 7b bf 59 3c 08 21 07  73 b7 04 16 a7 a5 98 2e  |.{.Y<.!.s.......|
-00000040  ab ee db c3 83 ea c8 b2  07 3e 76 a0 8f d4 8f df  |.........>v.....|
-00000050  70 91 b7 ed 12 54 e2 e7  68 cb ed 26 be 84 a9 24  |p....T..h..&...$|
-00000060  fb 89 48 49 4e 9b 14 98  82 ab 64 0c a5 a0 ec 1d  |..HIN.....d.....|
-00000070  96 b7 83 c3 14 cb de a5  97 d1 86 28 b6 d4 65 5d  |...........(..e]|
-00000080  0b 45 04 37 02 53 8c 96  5d f8 d3 14 03 03 00 01  |.E.7.S..].......|
-00000090  01 16 03 03 00 30 04 43  06 c4 96 f5 f6 23 5d 46  |.....0.C.....#]F|
-000000a0  ec 3d f4 18 44 3f f8 d2  e9 74 37 22 56 df f2 35  |.=..D?...t7"V..5|
-000000b0  3d a0 8d 8a 80 be 4e 40  66 28 4c 37 aa f7 43 cf  |=.....N@f(L7..C.|
-000000c0  9e 29 83 7b 39 28                                 |.).{9(|
+00000000  16 03 03 00 86 10 00 00  82 00 80 a3 a7 b7 b2 3e  |...............>|
+00000010  ee 37 62 8e 5b b3 d5 2e  e2 0e b9 24 70 95 4c 4c  |.7b.[......$p.LL|
+00000020  52 e5 9f a3 e2 79 7f a1  dc 93 1f 89 2e f8 a2 8e  |R....y..........|
+00000030  7b d8 82 6c 89 57 64 44  e9 61 66 aa 8d 42 ff d1  |{..l.WdD.af..B..|
+00000040  7f 62 21 55 78 e9 da 87  18 d5 51 dc 91 39 6b b9  |.b!Ux.....Q..9k.|
+00000050  8f ec 76 57 f7 03 62 fa  54 36 0c 18 ad 7c 1c 5d  |..vW..b.T6...|.]|
+00000060  ce fd b4 97 c3 98 15 fc  b5 e5 55 6b aa d5 d5 d4  |..........Uk....|
+00000070  17 9c a7 55 ee 8d d1 85  2e 92 10 32 67 72 d5 27  |...U.......2gr.'|
+00000080  0d aa b3 a9 5a ec d3 8c  df d4 7f 14 03 03 00 01  |....Z...........|
+00000090  01 16 03 03 00 30 8a 3c  9c 7d dd 50 68 ff 79 dc  |.....0.<.}.Ph.y.|
+000000a0  f4 b4 a7 73 8e de 93 01  85 a4 0c 9c cb 9a 2d 4d  |...s..........-M|
+000000b0  34 95 63 d7 73 9f c5 89  e0 81 8f a2 bd c1 3b e4  |4.c.s.........;.|
+000000c0  5a fe 5a ef 6a 75                                 |Z.Z.ju|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 30 00 00 00 00 00  |..........0.....|
-00000010  00 00 00 27 75 8a 8d 43  68 0e af 19 6d d2 63 1c  |...'u..Ch...m.c.|
-00000020  44 51 0b 86 4c fc 16 1c  77 f8 96 1e 72 3d b9 45  |DQ..L...w...r=.E|
-00000030  40 cc 70 bc 72 a3 d3 ff  f6 e5 3f 17 03 03 00 30  |@.p.r.....?....0|
-00000040  00 00 00 00 00 00 00 00  f4 cf bc 55 e6 d7 4f d2  |...........U..O.|
-00000050  8f ae 52 8d 16 d0 44 9a  c9 39 5b a7 69 bb 04 96  |..R...D..9[.i...|
-00000060  c9 d9 0c 92 a0 da b4 52  c5 dd 20 cb 4b 8c ad 51  |.......R.. .K..Q|
-00000070  15 03 03 00 20 00 00 00  00 00 00 00 00 43 52 b5  |.... ........CR.|
-00000080  d2 98 37 93 69 73 49 27  08 75 76 54 e7 39 b3 4c  |..7.isI'.uvT.9.L|
-00000090  da 48 84 00 20                                    |.H.. |
+00000010  00 00 00 f1 00 85 78 65  64 6e 44 50 3e 34 30 87  |......xednDP>40.|
+00000020  b8 c2 b4 ed 76 e2 65 0a  4c 21 68 46 ca ae 97 ea  |....v.e.L!hF....|
+00000030  a2 46 38 b3 65 b8 63 45  8f aa 4c 17 03 03 00 30  |.F8.e.cE..L....0|
+00000040  00 00 00 00 00 00 00 00  fd 9f bb a9 e3 72 fd 5f  |.............r._|
+00000050  5b b7 2d 34 e5 4c 19 f4  ef 1c ce 71 0f d3 0d a6  |[.-4.L.....q....|
+00000060  5f f2 ca b4 3b f8 eb c7  20 85 e7 92 41 8c c8 08  |_...;... ...A...|
+00000070  15 03 03 00 20 00 00 00  00 00 00 00 00 3b b8 8c  |.... ........;..|
+00000080  09 40 aa 11 20 a9 ee f7  e4 bb 80 a2 e6 5d e5 04  |.@.. ........]..|
+00000090  98 65 e8 bd 85                                    |.e...|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES
index e4d773d4c4..25f1269e3a 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 97 01 00 00  93 03 03 41 7b 60 d8 f5  |...........A{`..|
-00000010  1c 4a 95 f9 03 de 94 0c  b6 34 94 3c 6e 82 f2 de  |.J.......4.<n...|
-00000020  2c 28 00 98 02 56 5e 8d  53 60 da 00 00 04 00 2f  |,(...V^.S`...../|
+00000000  16 03 01 00 97 01 00 00  93 03 03 1b 05 dc 80 93  |................|
+00000010  90 62 51 a6 ce 10 03 8e  f1 02 71 53 b0 9f 80 96  |.bQ.......qS....|
+00000020  a0 48 c9 6f 1d df d9 cd  82 43 48 00 00 04 00 2f  |.H.o.....CH..../|
 00000030  00 ff 01 00 00 66 00 00  00 0e 00 0c 00 00 09 31  |.....f.........1|
 00000040  32 37 2e 30 2e 30 2e 31  00 0b 00 04 03 00 01 02  |27.0.0.1........|
 00000050  00 0a 00 0c 00 0a 00 1d  00 17 00 1e 00 19 00 18  |................|
@@ -53,31 +53,31 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 15 eb 41 72 e4  |.............Ar.|
-00000010  cf 0f 8b bb 9a ea aa 2a  f1 dc 2e c9 db d8 cf bd  |.......*........|
-00000020  5e fb 86 30 98 b4 22 62  a5 32 d0 e6 3d 38 49 1a  |^..0.."b.2..=8I.|
-00000030  70 6f fa d3 81 c0 8d 00  c6 cd 80 b6 ed 26 8b 98  |po...........&..|
-00000040  3a 26 8b 8e 88 ba 61 a6  8e 19 5a 0e 51 bb 4e 9e  |:&....a...Z.Q.N.|
-00000050  a9 21 09 77 cf 42 eb 26  90 3a 08 bb c5 89 88 2c  |.!.w.B.&.:.....,|
-00000060  19 db b3 1c 7a d0 60 76  be 9a d5 0c ec df dd 11  |....z.`v........|
-00000070  9e a0 85 a5 36 3d 07 f7  36 47 52 92 cd 84 7b 2e  |....6=..6GR...{.|
-00000080  13 18 47 58 8a 00 4b 39  59 bb da 14 03 03 00 01  |..GX..K9Y.......|
-00000090  01 16 03 03 00 40 16 0e  0a 79 db 54 11 36 73 af  |.....@...y.T.6s.|
-000000a0  eb cb 9d e8 b4 42 1a f8  94 f0 fb d1 60 f8 9f 9d  |.....B......`...|
-000000b0  ba 87 f6 27 ef 54 e4 f9  f7 1f a7 61 f5 82 1a 40  |...'.T.....a...@|
-000000c0  96 81 f6 14 db 89 ec 8b  0c 37 ba 11 55 94 d3 df  |.........7..U...|
-000000d0  df 8d 61 ec a7 43                                 |..a..C|
+00000000  16 03 03 00 86 10 00 00  82 00 80 c7 bb d2 ee 1a  |................|
+00000010  38 b1 7b 2f ad ec e6 63  d3 11 f9 69 b6 7e b9 58  |8.{/...c...i.~.X|
+00000020  79 37 c9 6e e5 6b 1e ce  e5 b7 1f 69 ec 2c 71 94  |y7.n.k.....i.,q.|
+00000030  f7 27 16 66 14 24 bd bb  ca ac 80 20 68 46 6e b8  |.'.f.$..... hFn.|
+00000040  3e f4 82 07 0a b7 0c 74  a5 66 1a 86 48 52 6e 80  |>......t.f..HRn.|
+00000050  a1 88 a3 12 8c c9 ef fc  5c 90 a8 f5 2f 0a 69 ba  |........\.../.i.|
+00000060  ce 73 48 ca 25 ea be 3c  9f 1b b6 1c e9 d7 1d bf  |.sH.%..<........|
+00000070  38 0d 6f a1 ed c0 22 16  40 51 2e c3 78 5b 69 8a  |8.o...".@Q..x[i.|
+00000080  91 30 5b 15 b1 a5 c5 ea  5f 34 38 14 03 03 00 01  |.0[....._48.....|
+00000090  01 16 03 03 00 40 78 f5  31 97 86 f4 48 5c 74 8f  |.....@x.1...H\t.|
+000000a0  ac b9 49 42 cb 83 e6 d9  bc a4 6f cc 3f f3 54 66  |..IB......o.?.Tf|
+000000b0  93 01 2c 1a e3 b4 08 09  f8 41 d4 fe 2d fa ab a9  |..,......A..-...|
+000000c0  f1 47 39 13 82 11 9e 7f  04 78 08 df 13 74 97 6c  |.G9......x...t.l|
+000000d0  ba ac a8 26 90 2e                                 |...&..|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 ef 1a ed 92 e1  |................|
-00000020  e1 81 1e a8 e1 ff 2b 2b  64 89 17 55 2d ce eb be  |......++d..U-...|
-00000030  17 a6 b8 a7 55 8a c4 3b  8a 5a c7 56 7c b5 90 c9  |....U..;.Z.V|...|
-00000040  19 bc 13 07 50 91 42 2a  46 13 d1 17 03 03 00 40  |....P.B*F......@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 53 48 ab 5a 17  |...........SH.Z.|
+00000020  07 e4 14 04 4d 96 ae 33  b7 e7 6b 37 10 34 98 66  |....M..3..k7.4.f|
+00000030  b8 38 6b 30 53 17 3e af  80 34 a6 29 0c 3b 8b 05  |.8k0S.>..4.).;..|
+00000040  53 d6 53 fb 65 e3 ec 05  16 f2 c7 17 03 03 00 40  |S.S.e..........@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  9e fe 95 fa 67 a5 af 14  f0 80 fd 65 65 ac 0a 91  |....g......ee...|
-00000070  4a 1d 4a c3 de 3f 35 a7  de 10 94 55 b0 8f be e6  |J.J..?5....U....|
-00000080  76 a2 74 4c 89 47 b9 10  8f 78 a9 01 6b ac bb d9  |v.tL.G...x..k...|
+00000060  46 14 e6 50 23 20 15 9f  a4 cc 39 69 43 e7 35 ea  |F..P# ....9iC.5.|
+00000070  3c c3 71 a6 65 dc ba 66  7b 3e b8 8d bc cc 1b f5  |<.q.e..f{>......|
+00000080  2b 65 55 9b 35 c7 30 08  ff 0b 7c b7 bb 75 f1 5c  |+eU.5.0...|..u.\|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 36 ce 1a  97 3e e3 0e 62 74 70 10  |.....6...>..btp.|
-000000b0  ec a5 30 16 1f 2d e0 5b  c9 38 4d fb 61 2e 45 35  |..0..-.[.8M.a.E5|
-000000c0  4b 69 da 43 39                                    |Ki.C9|
+000000a0  00 00 00 00 00 83 b1 d6  5e 78 d8 7d 8f 22 a2 c9  |........^x.}."..|
+000000b0  81 2d 47 ed 7e a5 65 10  af a0 b4 01 be b3 70 a8  |.-G.~.e.......p.|
+000000c0  9f 5a 07 87 f5                                    |.Z...|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM
index 01f961208f..9f48c75bab 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 97 01 00 00  93 03 03 d3 6a 87 ad b2  |............j...|
-00000010  a0 59 86 0e 34 86 c1 b3  c9 64 17 92 aa 87 04 05  |.Y..4....d......|
-00000020  32 d4 2e aa a1 48 94 87  82 a7 ab 00 00 04 c0 2f  |2....H........./|
+00000000  16 03 01 00 97 01 00 00  93 03 03 6d 19 64 2c f0  |...........m.d,.|
+00000010  95 79 38 26 9b e3 db b3  97 ce f8 9c 46 62 08 15  |.y8&........Fb..|
+00000020  a0 f0 7f 20 38 52 bb 27  f8 3b 60 00 00 04 c0 2f  |... 8R.'.;`..../|
 00000030  00 ff 01 00 00 66 00 00  00 0e 00 0c 00 00 09 31  |.....f.........1|
 00000040  32 37 2e 30 2e 30 2e 31  00 0b 00 04 03 00 01 02  |27.0.0.1........|
 00000050  00 0a 00 0c 00 0a 00 1d  00 17 00 1e 00 19 00 18  |................|
@@ -54,28 +54,28 @@
 00000290  3b e9 fa e7 16 03 03 00  ac 0c 00 00 a8 03 00 1d  |;...............|
 000002a0  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
 000002b0  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-000002c0  74 08 04 00 80 65 2f 82  18 27 04 84 db 3d c6 5e  |t....e/..'...=.^|
-000002d0  6b 33 f9 87 59 e1 06 0c  ce a7 3a f9 bd e7 54 47  |k3..Y.....:...TG|
-000002e0  03 58 f7 0b a3 16 6a 47  4b 61 b6 d9 0d 04 c8 95  |.X....jGKa......|
-000002f0  f5 d5 e5 0f 1b d2 26 3b  c5 67 c0 87 dd a5 da a8  |......&;.g......|
-00000300  e1 7e 52 a1 6a 0d 10 e8  dd 2e 09 39 21 3e a2 0f  |.~R.j......9!>..|
-00000310  a2 00 e4 a1 a6 df a8 3f  5d 1b d7 22 f8 b8 b5 32  |.......?].."...2|
-00000320  31 3a 36 16 9e 6c ab f1  d5 25 ae 3c 4a 11 c8 ae  |1:6..l...%.<J...|
-00000330  de e1 e6 b5 84 0b 3e 9d  63 75 6f b6 ba e9 fa 0a  |......>.cuo.....|
-00000340  11 40 c9 7f ca 16 03 03  00 04 0e 00 00 00        |.@............|
+000002c0  74 04 01 00 80 99 cc 0d  3d 25 73 2d 21 00 0d 42  |t.......=%s-!..B|
+000002d0  d1 6f 9e ba f4 04 58 30  5f a0 33 e9 b0 3a 69 6d  |.o....X0_.3..:im|
+000002e0  e2 a1 f2 74 f7 09 e7 ef  fb cd 56 22 93 1c 56 8e  |...t......V"..V.|
+000002f0  8f 87 4b 1d 54 f6 34 fd  e6 e0 2f 85 88 9a ab c9  |..K.T.4.../.....|
+00000300  b5 38 cd f3 44 20 7a 68  fd bf 10 ea 14 7e ae 21  |.8..D zh.....~.!|
+00000310  12 ad eb 91 2f 99 44 fb  cf 9e fe 21 19 9f d1 a0  |..../.D....!....|
+00000320  37 19 9e 48 92 0e 80 b7  51 95 45 ee 75 86 f9 52  |7..H....Q.E.u..R|
+00000330  5a f8 67 65 56 af 4d f8  ca 92 8f b7 2a f5 be c1  |Z.geV.M.....*...|
+00000340  04 e0 03 e1 b6 16 03 03  00 04 0e 00 00 00        |..............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 d1 f3 61 78 d1 34  |....%...! ..ax.4|
-00000010  36 b4 9f 5e e5 24 1e 48  02 be f0 13 c2 3d b0 ce  |6..^.$.H.....=..|
-00000020  fb 96 39 6b 96 76 aa 87  18 41 14 03 03 00 01 01  |..9k.v...A......|
-00000030  16 03 03 00 28 27 e1 50  92 20 e1 2c 98 b6 15 8f  |....('.P. .,....|
-00000040  dd bd 26 98 04 12 5d cb  29 66 ab 2d 37 f3 8e eb  |..&...].)f.-7...|
-00000050  3e 14 3b cf 4d 99 c4 2e  ea 7c 04 a5 45           |>.;.M....|..E|
+00000000  16 03 03 00 25 10 00 00  21 20 20 74 90 bd 53 18  |....%...!  t..S.|
+00000010  33 c6 a5 bf 51 71 f7 d7  c3 0c 7f 89 ad b3 73 7b  |3...Qq........s{|
+00000020  48 2f c1 ef 85 32 03 73  28 3b 14 03 03 00 01 01  |H/...2.s(;......|
+00000030  16 03 03 00 28 94 4f 85  68 15 57 b4 8f f4 21 a7  |....(.O.h.W...!.|
+00000040  e5 be 84 7d 3a e0 29 bd  99 20 24 d0 6b 9c 72 3a  |...}:.).. $.k.r:|
+00000050  fc f9 5d 1c 7e cb dd 7a  3b 7c 53 e6 3a           |..].~..z;|S.:|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 28 00 00 00 00 00  |..........(.....|
-00000010  00 00 00 88 39 9d c1 8d  8c bb c4 79 ba a5 2a bd  |....9......y..*.|
-00000020  34 62 bf 66 85 b5 cd 2e  f7 1e 6e b4 96 1c f6 b3  |4b.f......n.....|
-00000030  13 ba c9 17 03 03 00 25  00 00 00 00 00 00 00 01  |.......%........|
-00000040  c3 ca b5 57 11 26 ec 18  be 00 6c 8b 79 a5 ed f7  |...W.&....l.y...|
-00000050  7d ae 42 ff a2 8b fb 68  d0 08 0f 2e d1 15 03 03  |}.B....h........|
-00000060  00 1a 00 00 00 00 00 00  00 02 58 ad 11 d2 74 5c  |..........X...t\|
-00000070  17 f2 60 e5 d9 fa 0e 47  5a 48 31 f7              |..`....GZH1.|
+00000010  00 00 00 e3 4f 34 0e 47  ae f2 62 e3 aa 62 f3 37  |....O4.G..b..b.7|
+00000020  cf 78 ba 1d 8a 3c d8 29  0c 3c 9d 0c fa ff fd 9b  |.x...<.).<......|
+00000030  65 1b 3f 17 03 03 00 25  00 00 00 00 00 00 00 01  |e.?....%........|
+00000040  fd e1 49 0e 0d 9f a1 51  9e 19 5c 80 a5 15 dc 05  |..I....Q..\.....|
+00000050  ca f0 46 b3 da 03 5a 32  da 4e 2e 3d 33 15 03 03  |..F...Z2.N.=3...|
+00000060  00 1a 00 00 00 00 00 00  00 02 51 78 d9 14 6e a8  |..........Qx..n.|
+00000070  f4 62 60 6d db e0 d5 8c  c5 17 ac aa              |.b`m........|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES256-GCM-SHA384 b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES256-GCM-SHA384
index 83a37e0587..f6e5856f9c 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES256-GCM-SHA384
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES256-GCM-SHA384
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 97 01 00 00  93 03 03 39 40 da f7 9f  |...........9@...|
-00000010  e9 66 91 25 2a d0 74 e1  71 4b 74 ff 47 41 5e f4  |.f.%*.t.qKt.GA^.|
-00000020  d2 71 d0 3e 96 8e 8e 31  ee 81 8b 00 00 04 c0 30  |.q.>...1.......0|
+00000000  16 03 01 00 97 01 00 00  93 03 03 5e 39 96 57 2e  |...........^9.W.|
+00000010  de 43 bd 55 30 40 20 95  29 a0 38 7f 69 a3 02 4d  |.C.U0@ .).8.i..M|
+00000020  df 59 4b 17 f1 d6 0b 2e  87 62 af 00 00 04 c0 30  |.YK......b.....0|
 00000030  00 ff 01 00 00 66 00 00  00 0e 00 0c 00 00 09 31  |.....f.........1|
 00000040  32 37 2e 30 2e 30 2e 31  00 0b 00 04 03 00 01 02  |27.0.0.1........|
 00000050  00 0a 00 0c 00 0a 00 1d  00 17 00 1e 00 19 00 18  |................|
@@ -54,28 +54,28 @@
 00000290  3b e9 fa e7 16 03 03 00  ac 0c 00 00 a8 03 00 1d  |;...............|
 000002a0  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
 000002b0  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-000002c0  74 08 04 00 80 67 b9 f4  b4 4e 00 7c 40 80 f1 77  |t....g...N.|@..w|
-000002d0  2e 09 f6 04 17 bb ab f6  e1 13 03 b3 b6 71 22 0b  |.............q".|
-000002e0  38 49 98 65 54 db 3b e0  71 17 2a f3 d4 2a 0d 7e  |8I.eT.;.q.*..*.~|
-000002f0  af 56 37 ea a9 1e df 45  24 fd 90 ad 5e 3c aa 2e  |.V7....E$...^<..|
-00000300  98 74 b5 dc b5 22 0e 77  70 66 2f 6e d7 49 f6 a1  |.t...".wpf/n.I..|
-00000310  93 c9 0a ce 45 2b 55 bb  02 a3 b1 1d 5f 45 08 cd  |....E+U....._E..|
-00000320  4d 34 9e ef 27 f2 f0 af  a8 bd 14 60 45 df b4 54  |M4..'......`E..T|
-00000330  2c 6f c8 c8 dc f1 07 9a  e8 f3 f3 40 1d 29 39 9e  |,o.........@.)9.|
-00000340  a0 28 3a 19 de 16 03 03  00 04 0e 00 00 00        |.(:...........|
+000002c0  74 04 01 00 80 c0 53 9b  58 b3 88 7a 7d 7d 0f 8c  |t.....S.X..z}}..|
+000002d0  c4 10 e3 13 92 ae b4 87  ae a5 e2 2f f9 f0 db a0  |.........../....|
+000002e0  55 72 00 2f 29 eb 12 13  f7 bf 4b 44 be f2 85 f2  |Ur./).....KD....|
+000002f0  00 2d 2c 6a 14 21 44 d5  f8 78 99 67 07 db 27 74  |.-,j.!D..x.g..'t|
+00000300  32 9d 75 8d 7e f5 c2 9b  3e ce 3b aa f4 3a 1d 2d  |2.u.~...>.;..:.-|
+00000310  69 e3 0b 1e a0 95 d9 dc  47 73 42 14 7c 13 60 1f  |i.......GsB.|.`.|
+00000320  73 a9 0f 3b 64 33 18 67  b0 a3 69 f7 da 1d cd d0  |s..;d3.g..i.....|
+00000330  ea 65 9d 79 af aa a6 7f  ea ba 8a c7 d7 3f 80 76  |.e.y.........?.v|
+00000340  73 b0 c4 41 30 16 03 03  00 04 0e 00 00 00        |s..A0.........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 73 eb 70 45 10 e4  |....%...! s.pE..|
-00000010  a7 a6 35 b2 51 59 1e 6d  65 9a 0e d4 5a c2 39 13  |..5.QY.me...Z.9.|
-00000020  81 83 41 f8 60 0c 6b 0e  7f 4c 14 03 03 00 01 01  |..A.`.k..L......|
-00000030  16 03 03 00 28 44 ed a7  2b dc 7a 00 b5 26 bd 56  |....(D..+.z..&.V|
-00000040  0d b7 47 f3 2c d8 b7 c5  f6 21 3a e6 1f b8 fd 3a  |..G.,....!:....:|
-00000050  f8 44 65 0d 6e fd b8 32  cf dd f5 25 ce           |.De.n..2...%.|
+00000000  16 03 03 00 25 10 00 00  21 20 75 56 9a 51 e6 99  |....%...! uV.Q..|
+00000010  e2 7f 36 c6 3e 7b e0 17  2a 28 73 77 24 6c e9 af  |..6.>{..*(sw$l..|
+00000020  76 68 30 6a 07 4f 49 26  45 6d 14 03 03 00 01 01  |vh0j.OI&Em......|
+00000030  16 03 03 00 28 8e 42 ee  25 3a e2 8a 1a 51 f1 0c  |....(.B.%:...Q..|
+00000040  5b ce d2 2f 2b 86 c6 0f  10 d2 e2 44 da d8 4f 88  |[../+......D..O.|
+00000050  b5 2b 9c 9f 21 06 da 76  93 06 42 43 1f           |.+..!..v..BC.|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 28 00 00 00 00 00  |..........(.....|
-00000010  00 00 00 cb e9 44 b4 25  7e a5 9d ed 8e 8b 5c 4c  |.....D.%~.....\L|
-00000020  b9 c4 85 5b 9b 03 02 34  2c 61 40 fe 4a 84 9d 42  |...[...4,a@.J..B|
-00000030  67 67 53 17 03 03 00 25  00 00 00 00 00 00 00 01  |ggS....%........|
-00000040  ec a1 21 b6 85 61 d1 35  71 50 c1 6d 4d 32 81 3f  |..!..a.5qP.mM2.?|
-00000050  24 38 1d 8a 45 f7 9e 14  3b be e9 ec 37 15 03 03  |$8..E...;...7...|
-00000060  00 1a 00 00 00 00 00 00  00 02 f7 76 a1 1b bb 55  |...........v...U|
-00000070  aa 1d 10 c2 07 61 b3 0d  54 2d 6b e4              |.....a..T-k.|
+00000010  00 00 00 7c d4 b3 85 ea  5e 0c 8d 81 0c 7c 99 90  |...|....^....|..|
+00000020  5f fd cc 32 b5 d8 fd 0c  0a 9c 93 a5 35 4d a8 50  |_..2........5M.P|
+00000030  a8 6f 73 17 03 03 00 25  00 00 00 00 00 00 00 01  |.os....%........|
+00000040  49 5c 12 84 e7 cb a4 fb  b1 55 be 89 79 5c a8 df  |I\.......U..y\..|
+00000050  ab 0a e1 1b 98 e6 0f 40  fb f4 47 1f e1 15 03 03  |.......@..G.....|
+00000060  00 1a 00 00 00 00 00 00  00 02 e7 17 b1 82 70 75  |..............pu|
+00000070  42 d5 8f 2e 29 4b b3 a1  a2 3f c2 f8              |B...)K...?..|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-RC4 b/src/crypto/tls/testdata/Server-TLSv12-RSA-RC4
index da549aa32e..78ea1ff929 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-RC4
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-RC4
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 97 01 00 00  93 03 03 c7 7f 29 46 41  |.............)FA|
-00000010  08 97 7c 3f 77 e0 11 8f  14 30 23 3e fa fc ca f3  |..|?w....0#>....|
-00000020  45 10 83 10 1f 8f 25 b6  9d c1 4d 00 00 04 00 05  |E.....%...M.....|
+00000000  16 03 01 00 97 01 00 00  93 03 03 32 12 2b 12 44  |...........2.+.D|
+00000010  4f 0c 98 c0 fc f6 44 06  3a b1 64 89 a5 8b f4 e4  |O.....D.:.d.....|
+00000020  73 e1 60 1e 51 38 92 f3  83 f3 9f 00 00 04 00 05  |s.`.Q8..........|
 00000030  00 ff 01 00 00 66 00 00  00 0e 00 0c 00 00 09 31  |.....f.........1|
 00000040  32 37 2e 30 2e 30 2e 31  00 0b 00 04 03 00 01 02  |27.0.0.1........|
 00000050  00 0a 00 0c 00 0a 00 1d  00 17 00 1e 00 19 00 18  |................|
@@ -53,23 +53,23 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 d1 b0 57 28 da  |.............W(.|
-00000010  7a f8 46 7c c2 24 0d e0  04 48 33 d4 bc d7 f0 d0  |z.F|.$...H3.....|
-00000020  85 fb ff 22 27 20 91 42  19 55 7b ef d8 fd 72 42  |..."' .B.U{...rB|
-00000030  75 e6 71 e4 9f 67 30 72  68 b6 0e 00 34 d3 2f b8  |u.q..g0rh...4./.|
-00000040  23 1b 00 43 17 68 fd 0f  90 ee 97 16 23 36 90 02  |#..C.h......#6..|
-00000050  5c 71 10 03 80 ea 74 ef  a4 5a ac e4 9f 48 f0 76  |\q....t..Z...H.v|
-00000060  62 43 17 05 7c 8f 59 1d  16 b1 97 48 99 8d 66 5e  |bC..|.Y....H..f^|
-00000070  83 20 b3 02 e4 ac 73 52  b2 24 21 06 5a 49 89 df  |. ....sR.$!.ZI..|
-00000080  4b ad 4e f4 a9 7b 0c 3a  b1 39 5d 14 03 03 00 01  |K.N..{.:.9].....|
-00000090  01 16 03 03 00 24 8b de  7e 10 53 71 e0 0b 68 f6  |.....$..~.Sq..h.|
-000000a0  36 67 66 c2 b9 0a c0 3e  39 0d ab 2e eb 5e eb 06  |6gf....>9....^..|
-000000b0  a6 45 2b d7 48 8f c0 5e  f3 a0                    |.E+.H..^..|
+00000000  16 03 03 00 86 10 00 00  82 00 80 85 ad 31 da a9  |.............1..|
+00000010  fd 0f 5c ca aa 28 d1 08  7d 76 b4 5b b2 09 f4 e0  |..\..(..}v.[....|
+00000020  65 3a 82 7e f8 03 5f c9  82 ae fb 04 f8 f1 dc bc  |e:.~.._.........|
+00000030  b9 2f e8 b4 4c b0 5a de  c8 99 88 99 0b 03 ed 7f  |./..L.Z.........|
+00000040  e4 84 a0 6b 6d 55 1e f6  ea 9f 5a 55 1e 5c e5 f1  |...kmU....ZU.\..|
+00000050  f4 8a f3 7b 7c 20 fc 4b  5d 31 98 c3 bb ce ba 6a  |...{| .K]1.....j|
+00000060  e8 e5 58 a1 db 5a 84 7d  ef cd 17 52 2f 66 31 d2  |..X..Z.}...R/f1.|
+00000070  27 e4 29 1c 9e e0 39 a9  e0 7f 5f 25 d7 49 95 28  |'.)...9..._%.I.(|
+00000080  08 67 1e 25 5f 12 39 b0  a5 63 85 14 03 03 00 01  |.g.%_.9..c......|
+00000090  01 16 03 03 00 24 88 e9  9e 1d 16 8f f7 6e b1 c9  |.....$.......n..|
+000000a0  06 dc 50 e7 40 da 21 84  de 97 e6 a2 8d 78 96 9a  |..P.@.!......x..|
+000000b0  39 9d aa 91 43 15 0f cf  f4 e9                    |9...C.....|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 24 ee dc 70 d2 3a  |..........$..p.:|
-00000010  f1 9c c6 c8 01 01 84 4f  3c 95 a3 ac 7a 78 92 3d  |.......O<...zx.=|
-00000020  8c 05 a1 db 34 fe 92 f2  9e f3 81 a1 33 a5 7f 17  |....4.......3...|
-00000030  03 03 00 21 6e a9 f8 f9  99 0b c1 f5 8a d0 ab 93  |...!n...........|
-00000040  15 4d 2f 24 1c 0b 43 77  cf 14 60 87 b0 8d f7 80  |.M/$..Cw..`.....|
-00000050  c0 69 ea f6 9e 15 03 03  00 16 ef 09 73 d8 06 ec  |.i..........s...|
-00000060  b8 02 14 9c d3 39 32 d4  3d 94 ec 17 79 1d a9 d3  |.....92.=...y...|
+00000000  14 03 03 00 01 01 16 03  03 00 24 c5 34 41 0f 31  |..........$.4A.1|
+00000010  5a 94 d7 4b a9 0a 4e bf  b9 22 ec 76 2c 1f f5 e9  |Z..K..N..".v,...|
+00000020  6b 7b 26 df 41 62 91 b6  dc db 23 2b 8d 3d 49 17  |k{&.Ab....#+.=I.|
+00000030  03 03 00 21 72 31 77 51  94 c5 d4 eb 7c 18 ab 87  |...!r1wQ....|...|
+00000040  29 43 3b c5 78 aa 5c 4a  06 d3 42 5c 61 39 86 12  |)C;.x.\J..B\a9..|
+00000050  b1 ae f6 f7 97 15 03 03  00 16 8a 0e 1d 5c e0 18  |.............\..|
+00000060  12 93 ac 6c 69 32 59 b8  15 88 82 1c 97 f3 5b 9c  |...li2Y.......[.|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-RSAPKCS1v15 b/src/crypto/tls/testdata/Server-TLSv12-RSA-RSAPKCS1v15
index 6d98a309ee..2c5237153a 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-RSAPKCS1v15
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-RSAPKCS1v15
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 91 01 00 00  8d 03 03 c1 6b f6 4d 77  |............k.Mw|
-00000010  95 dc 8a 54 04 62 4a b4  dc e3 06 51 b8 88 4e 9f  |...T.bJ....Q..N.|
-00000020  9a f5 2b 87 82 51 df e9  54 c7 93 00 00 2a c0 30  |..+..Q..T....*.0|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 96 d3 ee ca ff  |................|
+00000010  77 00 8c e4 14 3a ee 2a  bb 39 8c 62 72 c7 ae 46  |w....:.*.9.br..F|
+00000020  8c 7e 8e 90 96 f1 c3 27  4d 37 3f 00 00 2a c0 30  |.~.....'M7?..*.0|
 00000030  00 9f cc a8 cc aa c0 2f  00 9e c0 28 00 6b c0 27  |......./...(.k.'|
 00000040  00 67 c0 14 00 39 c0 13  00 33 00 9d 00 9c 00 3d  |.g...9...3.....=|
 00000050  00 3c 00 35 00 2f 00 ff  01 00 00 3a 00 00 00 0e  |.<.5./.....:....|
@@ -54,28 +54,28 @@
 00000290  3b e9 fa e7 16 03 03 00  ac 0c 00 00 a8 03 00 1d  |;...............|
 000002a0  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
 000002b0  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-000002c0  74 04 01 00 80 15 c5 ee  da 37 f8 6d b8 9e 7c 68  |t........7.m..|h|
-000002d0  b2 08 2a 8d 79 6c 6e 95  4e b5 6f 8e 84 24 31 d4  |..*.yln.N.o..$1.|
-000002e0  e7 8c 6c 7e 9c 58 a4 fe  18 59 aa f7 0d 7d ff 7a  |..l~.X...Y...}.z|
-000002f0  f2 b0 eb b6 d3 4f fa 3f  36 0d 2e 43 8e d7 96 14  |.....O.?6..C....|
-00000300  99 a0 34 6a 51 cf 49 48  2f 6a 69 3b e4 ec 8b 61  |..4jQ.IH/ji;...a|
-00000310  a1 f4 ea 20 c5 72 90 b1  c6 54 75 42 4e f6 1f 12  |... .r...TuBN...|
-00000320  da e1 98 36 01 02 30 b4  75 7b 4f 4b f1 4f ac 20  |...6..0.u{OK.O. |
-00000330  ac c8 d2 0f 8f 2a 00 09  b8 2c ab 9e 5f b2 ce 25  |.....*...,.._..%|
-00000340  e3 a3 27 9d 53 16 03 03  00 04 0e 00 00 00        |..'.S.........|
+000002c0  74 04 01 00 80 c9 24 3c  3d dd 65 45 f8 e4 92 b9  |t.....$<=.eE....|
+000002d0  2b 03 c2 9f f5 73 1f 84  dd 9b da 82 2b 44 7c f1  |+....s......+D|.|
+000002e0  7c 55 d8 53 39 e9 d9 ea  f1 6a 23 7f b0 aa 30 94  ||U.S9....j#...0.|
+000002f0  37 b7 06 59 1a fc 09 ba  d9 68 f7 c8 96 5d 80 e1  |7..Y.....h...]..|
+00000300  7c f4 1b 36 0a 8a dd 2e  c5 d0 27 da 4a 75 98 fb  ||..6......'.Ju..|
+00000310  43 51 3f 8e 95 0d 7b 42  93 8a d5 dc 55 59 ef 69  |CQ?...{B....UY.i|
+00000320  91 82 a3 d8 7e 54 a4 7b  05 17 06 58 21 62 79 b7  |....~T.{...X!by.|
+00000330  67 bd ac 8c 9e 23 73 01  17 49 4b 5d 24 7a 29 0b  |g....#s..IK]$z).|
+00000340  05 ec 24 1e cb 16 03 03  00 04 0e 00 00 00        |..$...........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 fe 11 76 84 dd 42  |....%...! ..v..B|
-00000010  d9 fd ad 50 81 7e 62 d4  38 cb b3 5d ec c8 5a 7a  |...P.~b.8..]..Zz|
-00000020  40 d9 10 23 2f e6 c7 a8  95 3b 14 03 03 00 01 01  |@..#/....;......|
-00000030  16 03 03 00 28 61 18 1a  65 0c 24 59 01 fe 28 fc  |....(a..e.$Y..(.|
-00000040  4f 7f d9 c5 6d b7 bf 9c  5c 8b dc 91 e7 48 40 72  |O...m...\....H@r|
-00000050  06 4d 49 a4 4d 32 e2 10  b9 36 a4 06 a6           |.MI.M2...6...|
+00000000  16 03 03 00 25 10 00 00  21 20 8e 76 7a 64 15 47  |....%...! .vzd.G|
+00000010  60 08 88 f8 3c ca 23 ce  e3 f1 52 18 e0 94 6f 7a  |`...<.#...R...oz|
+00000020  be 7b 39 c6 42 eb 14 d9  f3 7a 14 03 03 00 01 01  |.{9.B....z......|
+00000030  16 03 03 00 28 a8 16 b6  f4 4e 1e f1 5a 8a 04 a5  |....(....N..Z...|
+00000040  4b a0 40 b1 9f 7e e7 42  22 45 01 03 52 5a 11 53  |K.@..~.B"E..RZ.S|
+00000050  c1 1f a7 19 14 c0 9c d8  53 c3 41 ae 6f           |........S.A.o|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 28 00 00 00 00 00  |..........(.....|
-00000010  00 00 00 6c 7b 84 e6 84  d3 31 8e 6a 3e e7 7e f2  |...l{....1.j>.~.|
-00000020  94 16 6c 6f 01 a9 2d f7  de 5d 94 b2 9c 4b f0 51  |..lo..-..]...K.Q|
-00000030  70 9e 3c 17 03 03 00 25  00 00 00 00 00 00 00 01  |p.<....%........|
-00000040  94 ca c5 e7 58 20 7d 3b  74 9d e0 97 a2 dd 63 ab  |....X };t.....c.|
-00000050  33 08 2f 16 69 59 ba 0e  82 52 75 98 eb 15 03 03  |3./.iY...Ru.....|
-00000060  00 1a 00 00 00 00 00 00  00 02 fc 38 72 72 09 6a  |...........8rr.j|
-00000070  ee c0 61 39 50 71 ad d3  ec a9 d1 0e              |..a9Pq......|
+00000010  00 00 00 e8 93 95 10 51  dd 7c d1 07 72 73 c1 9d  |.......Q.|..rs..|
+00000020  6b 2a 47 ce f5 56 3f e0  2f c4 41 97 ea 6d 83 07  |k*G..V?./.A..m..|
+00000030  3f 80 f5 17 03 03 00 25  00 00 00 00 00 00 00 01  |?......%........|
+00000040  44 c5 ed 59 85 39 66 98  bb de 1a d3 03 f3 29 94  |D..Y.9f.......).|
+00000050  4a 53 bd 25 bc 0a 23 11  10 68 c7 15 ad 15 03 03  |JS.%..#..h......|
+00000060  00 1a 00 00 00 00 00 00  00 02 c8 a1 07 6c d8 6a  |.............l.j|
+00000070  cc f8 6a 5b d1 8c 32 93  71 23 c8 71              |..j[..2.q#.q|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-RSAPSS b/src/crypto/tls/testdata/Server-TLSv12-RSA-RSAPSS
index 5ec0f25a17..c260afe296 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-RSAPSS
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-RSAPSS
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 91 01 00 00  8d 03 03 0f 06 da 7d 85  |..............}.|
-00000010  33 d8 3c c3 ad c5 19 f8  06 d8 f6 02 80 9a fb 8c  |3.<.............|
-00000020  55 a5 6b 67 c4 6e 68 11  74 61 28 00 00 2a c0 30  |U.kg.nh.ta(..*.0|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 de a3 85 5b 56  |..............[V|
+00000010  34 e4 d0 57 07 66 8d 3c  39 00 eb 27 02 22 c9 f3  |4..W.f.<9..'."..|
+00000020  23 a6 5e 08 3a 6d 06 09  8f d9 00 00 00 2a c0 30  |#.^.:m.......*.0|
 00000030  00 9f cc a8 cc aa c0 2f  00 9e c0 28 00 6b c0 27  |......./...(.k.'|
 00000040  00 67 c0 14 00 39 c0 13  00 33 00 9d 00 9c 00 3d  |.g...9...3.....=|
 00000050  00 3c 00 35 00 2f 00 ff  01 00 00 3a 00 00 00 0e  |.<.5./.....:....|
@@ -51,31 +51,4 @@
 00000260  f1 6c 04 ed 73 bb b3 43  77 8d 0c 1c f1 0f a1 d8  |.l..s..Cw.......|
 00000270  40 83 61 c9 4c 72 2b 9d  ae db 46 06 06 4d f4 c1  |@.a.Lr+...F..M..|
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
-00000290  3b e9 fa e7 16 03 03 00  ac 0c 00 00 a8 03 00 1d  |;...............|
-000002a0  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
-000002b0  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-000002c0  74 08 04 00 80 49 30 b1  a5 47 19 7f a7 35 61 cb  |t....I0..G...5a.|
-000002d0  dc 41 47 f0 6a 96 e1 63  48 d9 4f d3 a4 ac 06 46  |.AG.j..cH.O....F|
-000002e0  f2 8d 07 95 25 c6 61 59  4a df 35 2e ce dd 71 7e  |....%.aYJ.5...q~|
-000002f0  1e d6 f4 9f 43 93 84 35  6a 98 41 45 16 ee cb 14  |....C..5j.AE....|
-00000300  dd bb 52 27 08 d5 a2 39  e7 6e f6 d6 e4 c6 bd f3  |..R'...9.n......|
-00000310  b6 9b 6d 61 30 2a 07 c6  04 39 87 fd 99 00 15 78  |..ma0*...9.....x|
-00000320  3d bf 20 8c b9 52 fb 5d  c7 b7 77 78 fb 77 2a ac  |=. ..R.]..wx.w*.|
-00000330  f5 3e e5 4b 8f 4d 9b ca  c2 33 1c 66 3c cb e0 1f  |.>.K.M...3.f<...|
-00000340  81 36 78 39 70 16 03 03  00 04 0e 00 00 00        |.6x9p.........|
->>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 79 9a e7 42 96 52  |....%...! y..B.R|
-00000010  f6 52 7d 10 9a 36 9b aa  a7 2f 96 be 5b 0a 3b 40  |.R}..6.../..[.;@|
-00000020  d9 32 3a 0b 17 7b 8d 92  7c 7b 14 03 03 00 01 01  |.2:..{..|{......|
-00000030  16 03 03 00 28 92 3e da  41 d2 87 60 b3 e1 4f f7  |....(.>.A..`..O.|
-00000040  bb b7 09 50 47 2e 05 d5  fe f6 ed 94 ba 3b 60 aa  |...PG........;`.|
-00000050  38 2d b2 38 c7 07 64 63  dd ca 1a 8e ae           |8-.8..dc.....|
->>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 00 00 00 00 00  |..........(.....|
-00000010  00 00 00 8e c6 6e 45 21  eb 35 11 7a b5 74 d7 f7  |.....nE!.5.z.t..|
-00000020  67 53 15 23 9d 61 a1 bc  20 10 c8 8e 7e ee 45 fc  |gS.#.a.. ...~.E.|
-00000030  60 13 20 17 03 03 00 25  00 00 00 00 00 00 00 01  |`. ....%........|
-00000040  bf f9 63 b5 b1 39 70 43  c7 62 38 be d1 f5 0d a5  |..c..9pC.b8.....|
-00000050  87 91 95 71 ab 03 c2 08  d0 38 dc 70 9a 15 03 03  |...q.....8.p....|
-00000060  00 1a 00 00 00 00 00 00  00 02 0c 6f b1 f5 45 6d  |...........o..Em|
-00000070  44 2c 1f ec a4 fa 5c c1  aa 23 1e 82              |D,....\..#..|
+00000290  3b e9 fa e7 15 03 03 00  02 02 28                 |;.........(|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-SNI b/src/crypto/tls/testdata/Server-TLSv12-SNI
index f1c35527d2..380db2abb2 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-SNI
+++ b/src/crypto/tls/testdata/Server-TLSv12-SNI
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 99 01 00 00  95 03 03 4d 04 34 4d c9  |...........M.4M.|
-00000010  52 17 f0 1c 49 b6 2b d1  a0 16 a2 04 f4 d3 7c ca  |R...I.+.......|.|
-00000020  3d 4e 41 44 3d de 29 60  32 d6 a7 00 00 04 00 2f  |=NAD=.)`2....../|
+00000000  16 03 01 00 99 01 00 00  95 03 03 dd e8 cc 23 63  |..............#c|
+00000010  70 38 e5 f9 db 6c 77 0b  be e9 53 ad 06 97 cb 02  |p8...lw...S.....|
+00000020  d4 a7 bc d2 68 80 bf b8  0c 51 bc 00 00 04 00 2f  |....h....Q...../|
 00000030  00 ff 01 00 00 68 00 00  00 10 00 0e 00 00 0b 73  |.....h.........s|
 00000040  6e 69 74 65 73 74 2e 63  6f 6d 00 0b 00 04 03 00  |nitest.com......|
 00000050  01 02 00 0a 00 0c 00 0a  00 1d 00 17 00 1e 00 19  |................|
@@ -53,31 +53,31 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 ca 5a ef 73 b7  |............Z.s.|
-00000010  e2 11 b7 9a 45 22 8f 0d  44 ca 44 77 c0 ec 67 95  |....E"..D.Dw..g.|
-00000020  cc 63 2a 55 65 69 34 93  a2 64 fa f8 c0 db 56 91  |.c*Uei4..d....V.|
-00000030  d2 50 d4 a8 8c 89 13 e6  c0 ce 2b 26 46 cb ea 39  |.P........+&F..9|
-00000040  66 4c 89 58 8d 8a da 9c  bd 16 b3 28 40 a1 6f f8  |fL.X.......(@.o.|
-00000050  f7 f5 d9 9f d1 cd 44 ca  b5 ed 19 ea ec fa 97 2d  |......D........-|
-00000060  87 a5 c2 a8 1e f0 0c 70  fd fc a7 e7 1b dc 0c 99  |.......p........|
-00000070  d0 1f 6d 68 df 64 8f cb  ce 7b 3e 38 ab 9d b3 ba  |..mh.d...{>8....|
-00000080  66 a4 17 60 d6 fd ab 1d  d8 a2 b4 14 03 03 00 01  |f..`............|
-00000090  01 16 03 03 00 40 31 e3  94 eb 85 21 63 5e 29 b8  |.....@1....!c^).|
-000000a0  2b 9a 42 d1 4d f1 3c e8  df 66 ed 6f 61 42 aa 46  |+.B.M.<..f.oaB.F|
-000000b0  c0 4b 33 27 93 94 c5 6a  6c 94 f9 ba 6a 81 11 b1  |.K3'...jl...j...|
-000000c0  be 21 00 97 d9 84 9d ee  fd fd 79 18 ad 07 7a a8  |.!........y...z.|
-000000d0  d3 89 e3 2a b0 f0                                 |...*..|
+00000000  16 03 03 00 86 10 00 00  82 00 80 88 3a 3f eb 46  |............:?.F|
+00000010  28 cd 34 8f 95 5a 1e f8  c9 09 7d b0 97 9c 84 62  |(.4..Z....}....b|
+00000020  20 fd c7 cd 2e 09 27 2e  bb b7 1c b6 e1 05 7b f4  | .....'.......{.|
+00000030  cc 52 14 ee 6c 9b 18 4e  31 5a 4d be 8c 84 e3 6c  |.R..l..N1ZM....l|
+00000040  27 ca e9 c4 e9 da 9a 84  cc 7c b5 87 27 e1 be 1c  |'........|..'...|
+00000050  7a 70 3b 2a 71 a4 7d c5  4b ab 28 0e 4b ff 1f c4  |zp;*q.}.K.(.K...|
+00000060  d0 08 0b 9b ce e6 b8 ae  a2 a9 c5 c9 0a 73 1d a0  |.............s..|
+00000070  88 18 11 55 61 e1 1b 83  82 93 19 bb dc 29 f9 aa  |...Ua........)..|
+00000080  44 e0 b0 3b b9 dd 73 98  52 42 7b 14 03 03 00 01  |D..;..s.RB{.....|
+00000090  01 16 03 03 00 40 a4 e7  a1 51 63 e2 d7 df 93 32  |.....@...Qc....2|
+000000a0  01 f2 f1 14 a0 a3 1c 04  f1 c6 19 8c ab cb 51 b5  |..............Q.|
+000000b0  78 12 a4 43 08 62 14 ff  5c a0 5f aa 61 d8 c3 2c  |x..C.b..\._.a..,|
+000000c0  c8 af 05 f8 83 ff fb 6a  d9 a7 06 a9 ea b0 92 f5  |.......j........|
+000000d0  75 5a bc e7 57 c3                                 |uZ..W.|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 98 ae 81 aa e9  |................|
-00000020  4e 1f 93 59 89 05 a2 98  c3 17 dd e1 9d 9a 12 7d  |N..Y...........}|
-00000030  30 c6 6c b4 a6 f3 b7 b2  c5 df dc 9d 81 99 ce 29  |0.l............)|
-00000040  4b 75 04 9e d3 82 06 fa  22 1f a2 17 03 03 00 40  |Ku......"......@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 63 e2 4a 8d 77  |...........c.J.w|
+00000020  d8 d9 50 ae ba b0 44 d9  e2 7d 97 52 e6 65 07 5e  |..P...D..}.R.e.^|
+00000030  a1 03 19 a7 f6 a2 af 89  00 99 da 98 29 43 43 47  |............)CCG|
+00000040  9b 3c 8f 03 1a 36 27 e3  d8 db b7 17 03 03 00 40  |.<...6'........@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  dc 0e 49 1a ad 28 b6 c1  f2 27 ae bf 94 45 57 15  |..I..(...'...EW.|
-00000070  74 33 ae 3a f0 ee e5 76  7e 72 6c d9 56 64 88 58  |t3.:...v~rl.Vd.X|
-00000080  0b 96 35 a9 83 2e 4e 82  f8 a4 f8 f5 5b 08 6f 79  |..5...N.....[.oy|
+00000060  c2 6b 34 e5 79 04 14 ec  cf 14 4c 71 14 02 0d b3  |.k4.y.....Lq....|
+00000070  29 31 ec d8 40 81 12 15  8e 17 8a 42 33 1a 82 9a  |)1..@......B3...|
+00000080  be e9 6c dc dc 49 56 7a  fd 13 0a 20 37 79 e4 71  |..l..IVz... 7y.q|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 63 55 cb  53 f8 b1 48 85 33 aa c6  |.....cU.S..H.3..|
-000000b0  aa 60 c4 d0 b6 bb cc 85  3e a9 92 f9 be 53 8b 8b  |.`......>....S..|
-000000c0  3e 9c ee 8f f4                                    |>....|
+000000a0  00 00 00 00 00 4d 29 ee  b6 bf f8 71 69 4e 96 a4  |.....M)....qiN..|
+000000b0  5d 06 0e ef a9 aa 3f 16  19 c9 5d 8e 89 4f d2 cb  |].....?...]..O..|
+000000c0  17 1a e1 b0 63                                    |....c|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificate b/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificate
index f407ffd0b5..3e08bd4067 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificate
+++ b/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificate
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 99 01 00 00  95 03 03 9d e8 44 6f ac  |.............Do.|
-00000010  b8 f3 4e 96 5e c0 2a 81  4d 71 2e 0e 8a a0 2f 88  |..N.^.*.Mq..../.|
-00000020  4a 87 39 d2 ed 94 0b 41  ad 2b bf 00 00 04 00 2f  |J.9....A.+...../|
+00000000  16 03 01 00 99 01 00 00  95 03 03 78 fd 27 cc 09  |...........x.'..|
+00000010  5e 07 db a2 78 ba 7a 4d  a9 7f 74 f5 d1 6e a7 d2  |^...x.zM..t..n..|
+00000020  bc f2 ee 22 2d 68 e7 59  c4 9c bc 00 00 04 00 2f  |..."-h.Y......./|
 00000030  00 ff 01 00 00 68 00 00  00 10 00 0e 00 00 0b 73  |.....h.........s|
 00000040  6e 69 74 65 73 74 2e 63  6f 6d 00 0b 00 04 03 00  |nitest.com......|
 00000050  01 02 00 0a 00 0c 00 0a  00 1d 00 17 00 1e 00 19  |................|
@@ -53,31 +53,31 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 a4 d5 09 e3 4c  |...............L|
-00000010  78 eb 7d 76 4f 7f cf c7  2b 9d d1 fe 8f 5e a2 6b  |x.}vO...+....^.k|
-00000020  83 82 cb 93 37 63 47 ec  38 48 42 2a 3e e1 bf 6b  |....7cG.8HB*>..k|
-00000030  02 0a 8c b8 07 a7 11 5d  fd cc 6d dc 3b ed 26 24  |.......]..m.;.&$|
-00000040  18 64 ed 2e 98 93 49 45  ea 49 be 3f 12 43 47 c0  |.d....IE.I.?.CG.|
-00000050  c3 ef 25 e0 be 06 f2 e5  fe 9f 3e c7 e6 23 90 d1  |..%.......>..#..|
-00000060  2e 6f fc e2 72 ba a2 c2  e9 94 ab 7e ca 59 fa 93  |.o..r......~.Y..|
-00000070  40 4a 48 39 f9 5e 5f ac  60 a0 94 61 1c 6e 10 1e  |@JH9.^_.`..a.n..|
-00000080  30 44 1d 28 cb 2b b9 7f  00 dd 23 14 03 03 00 01  |0D.(.+....#.....|
-00000090  01 16 03 03 00 40 81 02  8e b2 b5 e2 b2 0a 95 9e  |.....@..........|
-000000a0  1e 65 4a 63 98 5b f0 30  4b 63 0a 74 87 58 20 fb  |.eJc.[.0Kc.t.X .|
-000000b0  2f 58 f8 10 a5 5f 4e b9  19 21 96 5f 13 8d d6 ed  |/X..._N..!._....|
-000000c0  a3 39 92 e5 4c 0f 31 c3  df 51 2d bb 7c 29 54 34  |.9..L.1..Q-.|)T4|
-000000d0  f6 68 fb f2 49 2d                                 |.h..I-|
+00000000  16 03 03 00 86 10 00 00  82 00 80 1f 30 ae eb ce  |............0...|
+00000010  57 b4 1c 5d f9 d0 5c 62  1e 89 6f b8 92 e3 c5 ef  |W..]..\b..o.....|
+00000020  ad cb 1b c2 86 e2 4e b5  88 4a d1 77 9d 89 07 87  |......N..J.w....|
+00000030  43 a1 90 41 70 3e 5e b6  59 29 9c 05 79 8f 97 92  |C..Ap>^.Y)..y...|
+00000040  77 6a 81 30 ec 30 ca e9  5e 66 10 6b 33 85 c8 c4  |wj.0.0..^f.k3...|
+00000050  4f 9a 0d 8e 4b cb d2 d8  93 9c 9c b8 91 95 15 01  |O...K...........|
+00000060  40 7c 61 cb bf a7 8e a9  ca dc 3e 78 ca 27 17 86  |@|a.......>x.'..|
+00000070  40 50 c5 44 03 ad 87 7a  dc 36 76 f5 79 6d 45 df  |@P.D...z.6v.ymE.|
+00000080  01 c1 d4 4f b0 d8 6a 2c  fe 18 71 14 03 03 00 01  |...O..j,..q.....|
+00000090  01 16 03 03 00 40 bc 90  46 f6 24 2f 68 47 7b 21  |.....@..F.$/hG{!|
+000000a0  01 91 67 d4 94 39 c0 8e  9f d4 75 dc f6 3a ac 22  |..g..9....u..:."|
+000000b0  4a a8 44 c9 ea 90 02 9b  fa 5c d5 17 5c 3d 81 bb  |J.D......\..\=..|
+000000c0  90 72 29 5d 92 d8 b1 2d  b7 a6 18 d1 7b 78 f4 7d  |.r)]...-....{x.}|
+000000d0  66 f8 2b 9c b1 90                                 |f.+...|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 3a 54 5f df 8a  |...........:T_..|
-00000020  c4 53 fb 18 31 f5 72 47  fd ef 38 84 72 80 81 88  |.S..1.rG..8.r...|
-00000030  45 69 81 aa c8 0d d7 4a  95 e9 cf ea b0 0e 07 3b  |Ei.....J.......;|
-00000040  9c f5 b3 47 00 58 55 e3  06 e1 a3 17 03 03 00 40  |...G.XU........@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 c6 d9 32 9f b9  |.............2..|
+00000020  e8 94 29 d3 62 fb ce 1d  de 4e de be e4 bd 58 86  |..).b....N....X.|
+00000030  96 07 c9 8e 34 77 b5 ca  18 67 39 d4 4c 33 c8 f0  |....4w...g9.L3..|
+00000040  4f 6b a2 22 c7 c1 1e 73  a7 9f 91 17 03 03 00 40  |Ok."...s.......@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  dd c3 b2 95 87 4d fb ae  ee 0e cd 78 ac f3 2d 06  |.....M.....x..-.|
-00000070  f1 a1 86 91 a3 d3 8f f6  66 b6 1c 6d 3f 6b 5b ba  |........f..m?k[.|
-00000080  4c c8 b2 5e bf 46 2b 05  bd 17 51 29 bd 1a 91 39  |L..^.F+...Q)...9|
+00000060  74 73 d2 d5 5c 5d d7 0d  83 0f c6 8b bd 7c f6 31  |ts..\].......|.1|
+00000070  2e cf 9d 01 14 f8 91 59  3d 2b 2f 4b 12 3f 72 1f  |.......Y=+/K.?r.|
+00000080  31 05 95 c9 a6 ab a4 15  b5 f3 a3 5c 68 15 f3 2f  |1..........\h../|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 17 b0 ba  69 00 94 0c 79 3f f7 39  |........i...y?.9|
-000000b0  be a6 4b 52 b6 5e c7 c1  98 f5 04 b2 78 1f 92 4f  |..KR.^......x..O|
-000000c0  4f 50 2d 59 2d                                    |OP-Y-|
+000000a0  00 00 00 00 00 78 71 a1  35 b1 2b e1 5d 85 d7 9b  |.....xq.5.+.]...|
+000000b0  77 b2 39 20 a9 86 4c 99  0c 96 0d bc 50 f6 a2 ab  |w.9 ..L.....P...|
+000000c0  04 80 30 1b 08                                    |..0..|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificateNotFound b/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificateNotFound
index 4139c92aa0..6fbad262a1 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificateNotFound
+++ b/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificateNotFound
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 99 01 00 00  95 03 03 cf 60 be 69 fc  |............`.i.|
-00000010  d8 3d f8 5e 5a 67 1d 86  93 9a b1 58 4e ca 35 d8  |.=.^Zg.....XN.5.|
-00000020  2d 92 56 f8 74 b0 9a 96  20 75 46 00 00 04 00 2f  |-.V.t... uF..../|
+00000000  16 03 01 00 99 01 00 00  95 03 03 d9 85 58 6e 7f  |.............Xn.|
+00000010  2d b4 cd f0 04 75 ef 4a  41 8a f9 2e 87 ae 63 c8  |-....u.JA.....c.|
+00000020  59 4b a2 4c 4f 46 c4 15  91 2e 7c 00 00 04 00 2f  |YK.LOF....|..../|
 00000030  00 ff 01 00 00 68 00 00  00 10 00 0e 00 00 0b 73  |.....h.........s|
 00000040  6e 69 74 65 73 74 2e 63  6f 6d 00 0b 00 04 03 00  |nitest.com......|
 00000050  01 02 00 0a 00 0c 00 0a  00 1d 00 17 00 1e 00 19  |................|
@@ -53,31 +53,31 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 aa e3 c3 d5 76  |...............v|
-00000010  d7 f7 da d5 93 39 8f 6d  c2 6a ed dc b1 69 c9 2e  |.....9.m.j...i..|
-00000020  74 55 e3 2a c8 7d 03 f5  a6 6a 4e 04 b1 7f 14 86  |tU.*.}...jN.....|
-00000030  4c 5a 0d 55 00 dc 58 2b  b6 34 bb 51 b0 d6 df ff  |LZ.U..X+.4.Q....|
-00000040  ab 0e 1a a8 df b1 58 de  73 9d 94 e4 d1 26 28 df  |......X.s....&(.|
-00000050  64 09 fd b0 bc d5 9e 85  0d e8 0c ff 1a 5c 87 47  |d............\.G|
-00000060  57 d0 3e a8 46 c6 5d c4  57 5c 95 c1 ca 91 69 c3  |W.>.F.].W\....i.|
-00000070  26 2f 93 0a f8 56 51 10  e9 ff f2 82 4f 21 54 30  |&/...VQ.....O!T0|
-00000080  d3 87 fd e9 e6 a1 05 53  d0 b4 10 14 03 03 00 01  |.......S........|
-00000090  01 16 03 03 00 40 1f 6b  ca bc 42 19 fe c6 64 cf  |.....@.k..B...d.|
-000000a0  6f de ff 54 28 56 de 1a  99 fb 19 d7 4a 5e 34 97  |o..T(V......J^4.|
-000000b0  f6 38 99 17 16 fb 06 ae  88 fb a6 07 2f 01 7b 54  |.8........../.{T|
-000000c0  63 8a 4a c1 6b ee 4e 61  4e c1 46 b5 d6 8f 51 a9  |c.J.k.NaN.F...Q.|
-000000d0  fb 07 9b 88 27 20                                 |....' |
+00000000  16 03 03 00 86 10 00 00  82 00 80 5a 46 e5 a3 fb  |...........ZF...|
+00000010  1d 57 11 df 01 db d8 df  8c 2f 25 4a 23 7a 62 38  |.W......./%J#zb8|
+00000020  49 b7 fa 2c 96 94 38 62  b5 9e db 5b 84 d8 8c 24  |I..,..8b...[...$|
+00000030  ec 80 e8 f7 c6 bf 8f fc  ba 2c 46 f6 ea e6 be 02  |.........,F.....|
+00000040  fb 43 2c 97 82 6e 0e ce  1d 16 39 80 09 97 da 65  |.C,..n....9....e|
+00000050  4a ad 87 02 2c f3 6a ce  44 c0 c3 16 ef 67 86 62  |J...,.j.D....g.b|
+00000060  14 1a 85 7a 82 a7 b8 6f  55 8f 1e fb 5d 2d a8 cb  |...z...oU...]-..|
+00000070  ec 77 0d b0 b3 1b a1 99  c9 51 e8 63 98 1a 31 f4  |.w.......Q.c..1.|
+00000080  b2 17 b5 bf 57 fb 23 47  ee 1e d3 14 03 03 00 01  |....W.#G........|
+00000090  01 16 03 03 00 40 61 a2  82 3b 6f c3 f6 8b 1d 93  |.....@a..;o.....|
+000000a0  42 f6 81 a4 e1 3b bd ab  6f d1 9d 04 a6 be f4 1b  |B....;..o.......|
+000000b0  c7 0b 63 c5 d2 4d 8b 69  41 5a 65 8d 8d b1 83 92  |..c..M.iAZe.....|
+000000c0  2d d6 6c c5 45 c7 99 83  89 b7 d5 a1 ae 1b 33 05  |-.l.E.........3.|
+000000d0  d5 00 9f cb 79 50                                 |....yP|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 62 37 c3 c7 5e  |...........b7..^|
-00000020  7a 8c 16 99 2d a4 21 cd  44 ab ae ff 52 d4 a9 6f  |z...-.!.D...R..o|
-00000030  fe 58 9a 61 2e ed 51 47  8b 9f f1 ca be b9 46 78  |.X.a..QG......Fx|
-00000040  9a fc d0 38 45 da a9 41  fd 51 8f 17 03 03 00 40  |...8E..A.Q.....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 29 51 0e ac ef  |...........)Q...|
+00000020  7b ef 53 95 05 d9 4f 28  97 a2 d6 ff 44 e1 0f fb  |{.S...O(....D...|
+00000030  ed e2 ac f4 6c 46 5f 91  07 ba f0 8f 37 37 8d 77  |....lF_.....77.w|
+00000040  7d a8 32 f5 4c f8 fd fc  86 ed 02 17 03 03 00 40  |}.2.L..........@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  7d aa 32 6f 59 1c d9 83  fe 11 2f ff b7 92 fb 22  |}.2oY...../...."|
-00000070  c0 9c 77 d6 73 66 da 10  f1 36 61 34 0f e6 e9 77  |..w.sf...6a4...w|
-00000080  8a 5c c1 8c ba 36 9d cc  8d 3f 48 03 2c c1 a5 1e  |.\...6...?H.,...|
+00000060  2d 65 8c 14 51 77 fb 37  61 b0 37 2b 74 8b 9e 8d  |-e..Qw.7a.7+t...|
+00000070  7e 72 c9 af 46 eb 05 72  8a b4 42 dc e9 6c df 01  |~r..F..r..B..l..|
+00000080  d2 c6 eb 48 f9 a9 a1 fd  6f 58 b2 76 95 13 df 29  |...H....oX.v...)|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 29 14 57  d1 dc f3 ab 63 40 92 00  |.....).W....c@..|
-000000b0  31 3b d5 36 a8 3c e3 cf  b5 64 ee b7 e9 36 86 75  |1;.6.<...d...6.u|
-000000c0  6e d8 91 29 f0                                    |n..).|
+000000a0  00 00 00 00 00 81 a1 ed  82 f3 3d d4 ea af 32 0d  |..........=...2.|
+000000b0  b2 b4 ab 7e 94 1b 88 95  8b 72 22 57 b1 35 96 12  |...~.....r"W.5..|
+000000c0  45 57 68 d7 dc                                    |EWh..|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-X25519 b/src/crypto/tls/testdata/Server-TLSv12-X25519
index f8e6ab38d1..ca3e49b93b 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-X25519
+++ b/src/crypto/tls/testdata/Server-TLSv12-X25519
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8f 01 00 00  8b 03 03 77 a6 19 8a 94  |...........w....|
-00000010  4a 1a d4 51 10 98 c3 22  5d 5d 76 2d 4f 27 ea e8  |J..Q..."]]v-O'..|
-00000020  61 d0 10 7a 08 43 23 42  b0 e0 12 00 00 04 c0 2f  |a..z.C#B......./|
+00000000  16 03 01 00 8f 01 00 00  8b 03 03 48 6b c4 66 fd  |...........Hk.f.|
+00000010  74 9f 73 e7 c8 4c 12 5b  6a e0 3d a6 5b ed f7 78  |t.s..L.[j.=.[..x|
+00000020  f1 93 b3 1b 1f ee 2e bc  85 f7 4e 00 00 04 c0 2f  |..........N..../|
 00000030  00 ff 01 00 00 5e 00 00  00 0e 00 0c 00 00 09 31  |.....^.........1|
 00000040  32 37 2e 30 2e 30 2e 31  00 0b 00 04 03 00 01 02  |27.0.0.1........|
 00000050  00 0a 00 04 00 02 00 1d  00 16 00 00 00 17 00 00  |................|
@@ -54,28 +54,28 @@
 00000290  3b e9 fa e7 16 03 03 00  ac 0c 00 00 a8 03 00 1d  |;...............|
 000002a0  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
 000002b0  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-000002c0  74 08 04 00 80 0f e7 f4  b4 b9 f2 83 95 26 d7 70  |t............&.p|
-000002d0  5f b2 e3 5e 42 86 b6 67  0a df 4e 60 2d d2 91 be  |_..^B..g..N`-...|
-000002e0  2c ba c1 24 9c 57 29 eb  aa df 52 e5 8e 5f 9c ab  |,..$.W)...R.._..|
-000002f0  9c 88 c5 8a 92 fd b6 d5  e2 6b 0d ea 1c de 73 22  |.........k....s"|
-00000300  a1 51 05 e0 b6 87 e1 e4  2b 8e 1d 06 26 53 37 4e  |.Q......+...&S7N|
-00000310  c7 8f 05 4a 0c 48 69 d3  7b f8 44 33 7b 2b 54 f5  |...J.Hi.{.D3{+T.|
-00000320  d9 a8 70 f3 6d b5 1c e4  4d 53 5f 0d 29 76 92 d3  |..p.m...MS_.)v..|
-00000330  63 19 25 b0 8c c6 31 13  e4 b5 d5 d0 b9 47 ed 54  |c.%...1......G.T|
-00000340  28 82 6c 04 a9 16 03 03  00 04 0e 00 00 00        |(.l...........|
+000002c0  74 04 01 00 80 6f 80 d8  15 ba df d3 5d d9 71 5f  |t....o......].q_|
+000002d0  25 f0 4f 03 1f 62 11 f4  33 91 34 08 6e d0 49 b9  |%.O..b..3.4.n.I.|
+000002e0  45 a6 37 85 73 36 c6 e7  45 c0 63 c9 66 0f b1 ae  |E.7.s6..E.c.f...|
+000002f0  86 33 b6 2a 24 d3 87 39  c8 62 da 0b 5d ae b0 74  |.3.*$..9.b..]..t|
+00000300  0d b9 36 6b 1b 97 86 d8  65 fa 46 75 6f ef d9 87  |..6k....e.Fuo...|
+00000310  6d b9 91 bb dc 47 42 23  c8 70 2a ba 65 0b 77 df  |m....GB#.p*.e.w.|
+00000320  57 6d 89 22 d8 36 f5 69  14 bc e1 c7 4c 80 22 0a  |Wm.".6.i....L.".|
+00000330  53 11 90 e0 61 30 48 29  2d 7c cf 17 94 a8 47 77  |S...a0H)-|....Gw|
+00000340  24 17 21 ec 04 16 03 03  00 04 0e 00 00 00        |$.!...........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 a4 db 55 a3 5a 6f  |....%...! ..U.Zo|
-00000010  af bf a2 53 ad 81 4d ea  ef c0 d7 02 5d 42 9f ee  |...S..M.....]B..|
-00000020  34 ff bf 08 c9 13 56 8c  e3 26 14 03 03 00 01 01  |4.....V..&......|
-00000030  16 03 03 00 28 bd 32 89  70 2a eb 54 d1 ae 60 08  |....(.2.p*.T..`.|
-00000040  4e 05 c9 e8 bb a7 fc 96  56 1a ba c7 51 a5 4d 2a  |N.......V...Q.M*|
-00000050  de da 6e a9 97 82 aa 37  44 00 4a 1f 0a           |..n....7D.J..|
+00000000  16 03 03 00 25 10 00 00  21 20 a0 e5 33 b9 5e e5  |....%...! ..3.^.|
+00000010  11 68 48 53 f1 06 5b ea  c7 2b 21 60 d1 ec e4 aa  |.hHS..[..+!`....|
+00000020  15 b9 38 bb c5 4d e4 c7  cf 17 14 03 03 00 01 01  |..8..M..........|
+00000030  16 03 03 00 28 41 1f 89  64 4d bb 36 48 36 97 d7  |....(A..dM.6H6..|
+00000040  1c 9c 44 9b 60 77 1e 73  87 7c f5 47 e4 e2 cd f8  |..D.`w.s.|.G....|
+00000050  fc 76 fe f3 38 34 4f ab  4a ce 55 66 6e           |.v..84O.J.Ufn|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 28 00 00 00 00 00  |..........(.....|
-00000010  00 00 00 7e 16 80 9b 85  03 3b 19 35 dc 22 75 4d  |...~.....;.5."uM|
-00000020  08 36 ad ee 24 f2 75 de  fe c2 c6 ba 91 62 1d 29  |.6..$.u......b.)|
-00000030  68 53 d3 17 03 03 00 25  00 00 00 00 00 00 00 01  |hS.....%........|
-00000040  65 36 ef c0 52 ae be bc  94 af 01 d6 c1 a8 2c 04  |e6..R.........,.|
-00000050  3c 83 a2 88 61 7f 41 c0  76 ec aa 52 8d 15 03 03  |<...a.A.v..R....|
-00000060  00 1a 00 00 00 00 00 00  00 02 4a dd b0 50 cf 59  |..........J..P.Y|
-00000070  01 67 74 45 f2 ae 47 f1  38 ef 51 04              |.gtE..G.8.Q.|
+00000010  00 00 00 44 d3 59 7d fc  8a 85 c2 67 f6 b2 6c 43  |...D.Y}....g..lC|
+00000020  5a 77 c0 96 a4 69 0f ec  f6 fa 27 00 4c 04 e1 23  |Zw...i....'.L..#|
+00000030  c5 1e d9 17 03 03 00 25  00 00 00 00 00 00 00 01  |.......%........|
+00000040  3f 7f d6 e8 bb 6c 7f 1c  d2 97 38 88 15 40 9c e5  |?....l....8..@..|
+00000050  1f 0b ac 83 e7 8b 57 0d  6b 62 22 0b 8e 15 03 03  |......W.kb".....|
+00000060  00 1a 00 00 00 00 00 00  00 02 d8 e7 53 15 ab a7  |............S...|
+00000070  e4 62 10 fd 48 be f5 c8  09 98 92 ad              |.b..H.......|
