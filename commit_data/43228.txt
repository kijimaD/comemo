commit a4b95cd092aa10b40c6be82a3e0bf1052e27122d
Author: Keith Randall <khr@golang.org>
Date:   Thu Oct 8 11:18:02 2020 -0700

    cmd/compile: fix incorrect comparison folding
    
    We lost a sign extension that was necessary. The nonnegative comparison
    didn't have the correct extension on it. If the larger constant is
    positive, but its shorter sign extension is negative, the rule breaks.
    
    Fixes #41872
    
    Change-Id: I6592ef103f840fbb786bf8cb94fd8804c760c976
    Reviewed-on: https://go-review.googlesource.com/c/go/+/260701
    Trust: Keith Randall <khr@golang.org>
    Run-TryBot: Keith Randall <khr@golang.org>
    TryBot-Result: Go Bot <gobot@golang.org>
    Reviewed-by: Alberto Donizetti <alb.donizetti@gmail.com>

 src/cmd/compile/internal/ssa/gen/AMD64.rules |  4 ++--
 src/cmd/compile/internal/ssa/rewriteAMD64.go |  8 ++++----
 test/fixedbugs/issue41872.go                 | 26 ++++++++++++++++++++++++++
 3 files changed, 32 insertions(+), 6 deletions(-)
