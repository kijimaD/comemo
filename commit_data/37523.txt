commit a4749604dc6cfea517ce2590336596a4ae570e78
Author: Russ Cox <rsc@golang.org>
Date:   Tue Aug 7 15:50:24 2018 -0400

    cmd/go: fix module loader and test-only dependencies
    
    go list all was not behaving as documented - it did not pick up
    test dependencies except when running in "go test" and "go vet".
    It should pick them up always.
    
    Also the module loader was ignoring tests when using "go list -test",
    which led to load failures.
    
    Fixing all required adjustments to mod_patterns test.
    Removed error-prone exact listings.
    
    Fixes #26279.
    Fixes #26906.
    
    Change-Id: I9c5acaf2275be20fd2349859589502190d3e7a78
    Reviewed-on: https://go-review.googlesource.com/128358
    Reviewed-by: Bryan C. Mills <bcmills@google.com>

 src/cmd/go/internal/list/list.go                   |  1 +
 src/cmd/go/internal/modload/load.go                | 13 ++----
 src/cmd/go/internal/test/test.go                   |  3 ++
 src/cmd/go/internal/vet/vet.go                     |  3 ++
 src/cmd/go/testdata/mod/rsc.io_sampler_v1.3.0.txt  |  1 +
 src/cmd/go/testdata/mod/rsc.io_testonly_v1.0.0.txt |  9 ++++
 src/cmd/go/testdata/script/mod_internal.txt        |  4 ++
 src/cmd/go/testdata/script/mod_list_bad_import.txt |  7 ++-
 src/cmd/go/testdata/script/mod_patterns.txt        | 54 ++++++++++------------
 src/cmd/go/testdata/script/mod_test.txt            | 31 ++++++++++++-
 10 files changed, 85 insertions(+), 41 deletions(-)
