commit 5d2ddcd3f51c1ff7aa0a84604b1d8610a17a7933
Author: Bryan C. Mills <bcmills@google.com>
Date:   Mon Mar 30 14:04:08 2020 -0400

    context: fix a flaky timeout in TestLayersTimeout
    
    In CL 223019, I reduced the short timeout in the testLayers helper to
    be even shorter than it was. That exposed a racy (time-dependent)
    select later in the function, which failed in one of the slower
    builders (android-386-emu).
    
    Also streamline the test to make it easier to test with a very high -count flag:
    - Run tests that sleep for shortDuration in parallel to reduce latency.
    - Use shorter durations in examples to reduce test running time.
    - Avoid mutating global state (in package math/rand) in testLayers.
    
    After this change (but not before it),
    'go test -run=TestLayersTimeout -count=100000 context' passes on my workstation.
    
    Fixes #38161
    
    Change-Id: Iaf4abe7ac308b2100d8828267cda9f4f8ae4be82
    Reviewed-on: https://go-review.googlesource.com/c/go/+/226457
    Reviewed-by: Ian Lance Taylor <iant@golang.org>

 src/context/context_test.go | 27 ++++++++++++++++++---------
 src/context/example_test.go |  6 ++++--
 2 files changed, 22 insertions(+), 11 deletions(-)
