commit 30151f2aac2882dcb369019acfec95d16fea3c02
Author: Bryan C. Mills <bcmills@google.com>
Date:   Thu Feb 9 16:35:04 2023 -0500

    cmd/go: fuzz test splitPkgConfigOutput and fix minor bugs
    
    In reviewing CL 466875, I noticed that the implementation of
    splitPkgConfigOutput from CL 86541 referred to another specific
    implementation, and that implementation has had recent changes to fix
    deviations from the POSIX specification for shell argument parsing.
    
    Curious about those changes, I decided to fuzz the function to check
    whether it agreed in practice with the way a real shell parses
    arguments in POSIX mode. It turned out to deviate in several edge
    cases, such as backslash-escapes within single quotes, quoted empty
    strings, and carriage returns. (We do not expect to see carriage
    returns in pkg-config output anyway, but the quote handling might
    matter.)
    
    This change updates the implementation to refer to the POSIX
    documentation instead of another implementation, and confirms the
    behavior with a fuzz test. It may introduce minor deviations from the
    pkgconf implementation that was previously used as a reference, but if
    so it is plausible that those could be fixed upstream in pkgconf
    (like the other recent changes there).
    
    For #35262.
    Updates ##23373.
    
    Change-Id: Ifab76e94af0ca9a6d826379f4a6e2028561e615c
    Reviewed-on: https://go-review.googlesource.com/c/go/+/466864
    Reviewed-by: Ian Lance Taylor <iant@google.com>
    TryBot-Result: Gopher Robot <gobot@golang.org>
    Run-TryBot: Bryan Mills <bcmills@google.com>
    Auto-Submit: Bryan Mills <bcmills@google.com>

 src/cmd/go/internal/work/build_test.go |  13 +--
 src/cmd/go/internal/work/exec.go       | 112 ++++++++++++++++++--------
 src/cmd/go/internal/work/shell_test.go | 139 +++++++++++++++++++++++++++++++++
 3 files changed, 225 insertions(+), 39 deletions(-)
