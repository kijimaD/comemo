commit 4f5cd0c0331943c7ec72df3b827d972584f77833
Author: Roberto Clapis <roberto@golang.org>
Date:   Wed Aug 26 08:53:03 2020 +0200

    net/http/cgi,net/http/fcgi: add Content-Type detection
    
    This CL ensures that responses served via CGI and FastCGI
    have a Content-Type header based on the content of the
    response if not explicitly set by handlers.
    
    If the implementers of the handler did not explicitly
    specify a Content-Type both CGI implementations would default
    to "text/html", potentially causing cross-site scripting.
    
    Thanks to RedTeam Pentesting GmbH for reporting this.
    
    Fixes #40928
    Fixes CVE-2020-24553
    
    Change-Id: I82cfc396309b5ab2e8d6e9a87eda8ea7e3799473
    Reviewed-on: https://team-review.git.corp.google.com/c/golang/go-private/+/823217
    Reviewed-by: Russ Cox <rsc@google.com>
    Reviewed-on: https://go-review.googlesource.com/c/go/+/252179
    Run-TryBot: Filippo Valsorda <filippo@golang.org>
    TryBot-Result: Go Bot <gobot@golang.org>
    Reviewed-by: Katie Hockman <katie@golang.org>

 src/net/http/cgi/child.go            | 36 +++++++++++++++-------
 src/net/http/cgi/child_test.go       | 58 ++++++++++++++++++++++++++++++++++++
 src/net/http/cgi/integration_test.go | 53 +++++++++++++++++++++++++++++++-
 src/net/http/fcgi/child.go           | 39 +++++++++++++++++-------
 src/net/http/fcgi/fcgi_test.go       | 52 ++++++++++++++++++++++++++++++++
 5 files changed, 216 insertions(+), 22 deletions(-)
