commit 3ab22052fbe784088cf8e4edf686707c54f51cf2
Merge: 5402d40d5b b459bc8152
Author: Cherry Zhang <cherryyz@google.com>
Date:   Fri Sep 11 12:07:44 2020 -0400

    [dev.link] all: merge branch 'master' into dev.link
    
    Clean merge.
    
    Change-Id: Ib773b0bc00fd99d494f9331c3613bcc8285e48e3

 api/next.txt                                       |   14 +
 doc/asm.html                                       |    7 +
 doc/go1.14.html                                    |    6 +
 doc/go1.16.html                                    |   77 +
 doc/install-source.html                            |    3 +
 misc/cgo/test/test.go                              |    1 +
 misc/wasm/wasm_exec.js                             |    4 +-
 src/cmd/asm/internal/asm/testdata/arm64.s          |   63 +-
 src/cmd/asm/internal/asm/testdata/arm64enc.s       |    4 +-
 src/cmd/asm/internal/asm/testdata/arm64error.s     |   14 +
 src/cmd/cgo/doc.go                                 |    7 +
 src/cmd/cgo/gcc.go                                 |   28 +-
 src/cmd/compile/internal/amd64/ssa.go              |    4 +-
 src/cmd/compile/internal/arm64/ssa.go              |    2 +-
 src/cmd/compile/internal/gc/alg.go                 |   34 +-
 src/cmd/compile/internal/gc/closure.go             |   14 +-
 src/cmd/compile/internal/gc/dcl.go                 |   26 +-
 src/cmd/compile/internal/gc/esc.go                 |   10 +-
 src/cmd/compile/internal/gc/escape.go              |   21 +-
 src/cmd/compile/internal/gc/fmt.go                 |    3 +-
 src/cmd/compile/internal/gc/gsubr.go               |    5 +-
 src/cmd/compile/internal/gc/init.go                |    1 -
 src/cmd/compile/internal/gc/noder.go               |   15 +-
 src/cmd/compile/internal/gc/order.go               |    7 +-
 src/cmd/compile/internal/gc/pgen.go                |   10 +-
 src/cmd/compile/internal/gc/pgen_test.go           |   10 +-
 src/cmd/compile/internal/gc/plive.go               |   16 +-
 src/cmd/compile/internal/gc/range.go               |    4 +-
 src/cmd/compile/internal/gc/reflect.go             |   10 +-
 src/cmd/compile/internal/gc/select.go              |    4 +-
 src/cmd/compile/internal/gc/ssa.go                 |   27 +-
 src/cmd/compile/internal/gc/subr.go                |   15 +-
 src/cmd/compile/internal/gc/syntax.go              |   41 +-
 src/cmd/compile/internal/gc/walk.go                |  102 +-
 src/cmd/compile/internal/ppc64/ssa.go              |   27 +-
 src/cmd/compile/internal/s390x/ssa.go              |    4 +-
 src/cmd/compile/internal/ssa/addressingmodes.go    |   65 +-
 src/cmd/compile/internal/ssa/check.go              |    6 +-
 src/cmd/compile/internal/ssa/config.go             |    3 +
 src/cmd/compile/internal/ssa/decompose.go          |   10 +-
 src/cmd/compile/internal/ssa/export_test.go        |    4 +
 src/cmd/compile/internal/ssa/func.go               |   64 +-
 src/cmd/compile/internal/ssa/gen/AMD64.rules       |  835 +--
 src/cmd/compile/internal/ssa/gen/ARM.rules         |    2 +-
 src/cmd/compile/internal/ssa/gen/ARM64.rules       | 1232 ++--
 src/cmd/compile/internal/ssa/gen/ARM64Ops.go       |    4 +-
 src/cmd/compile/internal/ssa/gen/MIPS64.rules      |  174 +-
 src/cmd/compile/internal/ssa/gen/PPC64.rules       |   40 +-
 src/cmd/compile/internal/ssa/gen/PPC64Ops.go       |   13 +-
 src/cmd/compile/internal/ssa/gen/S390X.rules       |  885 +--
 src/cmd/compile/internal/ssa/gen/Wasm.rules        |    4 +
 src/cmd/compile/internal/ssa/gen/dec.rules         |    4 +-
 src/cmd/compile/internal/ssa/gen/generic.rules     |   54 +-
 src/cmd/compile/internal/ssa/gen/rulegen.go        |    9 +-
 src/cmd/compile/internal/ssa/lower.go              |    2 +-
 src/cmd/compile/internal/ssa/nilcheck.go           |    2 +-
 src/cmd/compile/internal/ssa/op.go                 |    6 +
 src/cmd/compile/internal/ssa/opGen.go              |   51 +-
 src/cmd/compile/internal/ssa/opt.go                |    2 +-
 src/cmd/compile/internal/ssa/regalloc.go           |    2 +-
 src/cmd/compile/internal/ssa/rewrite.go            |   52 +-
 src/cmd/compile/internal/ssa/rewriteAMD64.go       | 4227 +++++++------
 src/cmd/compile/internal/ssa/rewriteARM.go         |   12 +-
 src/cmd/compile/internal/ssa/rewriteARM64.go       | 3438 ++++++-----
 src/cmd/compile/internal/ssa/rewriteMIPS64.go      |  804 +--
 src/cmd/compile/internal/ssa/rewritePPC64.go       |  603 +-
 src/cmd/compile/internal/ssa/rewriteS390X.go       | 6468 +++++---------------
 src/cmd/compile/internal/ssa/rewriteWasm.go        |   66 +
 src/cmd/compile/internal/ssa/rewritedec.go         |    7 +-
 src/cmd/compile/internal/ssa/rewritegeneric.go     |  816 ++-
 src/cmd/compile/internal/ssa/softfloat.go          |    3 +-
 src/cmd/compile/internal/ssa/value.go              |   42 +-
 src/cmd/compile/internal/ssa/writebarrier.go       |    2 +-
 src/cmd/compile/internal/types/type.go             |   33 +-
 src/cmd/compile/internal/x86/ssa.go                |    4 +-
 src/cmd/dist/test.go                               |    5 +-
 src/cmd/fix/fix.go                                 |  292 -
 src/cmd/go.mod                                     |    4 +-
 src/cmd/go.sum                                     |   20 +-
 src/cmd/go/alldocs.go                              |   46 +-
 src/cmd/go/internal/base/flag.go                   |   35 +-
 src/cmd/go/internal/cfg/cfg.go                     |    3 +-
 src/cmd/go/internal/fmtcmd/fmt.go                  |    3 +-
 src/cmd/go/internal/get/get.go                     |   20 +-
 src/cmd/go/internal/get/path.go                    |  192 -
 src/cmd/go/internal/get/vcs.go                     |    2 +-
 src/cmd/go/internal/get/vcs_test.go                |    7 +-
 src/cmd/go/internal/list/list.go                   |  123 +-
 src/cmd/go/internal/load/test.go                   |    2 +
 src/cmd/go/internal/modcmd/download.go             |   11 +-
 src/cmd/go/internal/modcmd/edit.go                 |  104 +-
 src/cmd/go/internal/modcmd/graph.go                |    5 +-
 src/cmd/go/internal/modcmd/init.go                 |    3 +-
 src/cmd/go/internal/modcmd/tidy.go                 |   15 +-
 src/cmd/go/internal/modcmd/vendor.go               |    5 +-
 src/cmd/go/internal/modcmd/verify.go               |    5 +-
 src/cmd/go/internal/modcmd/why.go                  |    8 +-
 src/cmd/go/internal/modfetch/fetch.go              |   14 +-
 src/cmd/go/internal/modget/get.go                  |  244 +-
 src/cmd/go/internal/modget/mvs.go                  |  202 +
 src/cmd/go/internal/modinfo/info.go                |   17 +-
 src/cmd/go/internal/modload/build.go               |   78 +-
 src/cmd/go/internal/modload/buildlist.go           |  122 +
 src/cmd/go/internal/modload/help.go                |    8 +-
 src/cmd/go/internal/modload/import.go              |  134 +-
 src/cmd/go/internal/modload/import_test.go         |   44 +-
 src/cmd/go/internal/modload/init.go                |  161 +-
 src/cmd/go/internal/modload/list.go                |   33 +-
 src/cmd/go/internal/modload/load.go                |  881 ++-
 src/cmd/go/internal/modload/modfile.go             |  384 +-
 src/cmd/go/internal/modload/mvs.go                 |  142 +-
 src/cmd/go/internal/modload/query.go               |  111 +-
 src/cmd/go/internal/modload/query_test.go          |    8 +-
 src/cmd/go/internal/modload/vendor.go              |    4 +-
 src/cmd/go/internal/mvs/errors.go                  |  101 +
 src/cmd/go/internal/mvs/mvs.go                     |   82 +-
 src/cmd/go/internal/par/queue.go                   |   88 +
 src/cmd/go/internal/par/queue_test.go              |   79 +
 src/cmd/go/internal/test/flagdefs_test.go          |   11 +-
 src/cmd/go/internal/test/genflags.go               |    7 +-
 src/cmd/go/internal/test/test.go                   |    3 +-
 src/cmd/go/internal/work/build.go                  |   14 +-
 src/cmd/go/internal/work/gc.go                     |    9 +
 src/cmd/go/internal/work/init.go                   |    2 +-
 src/cmd/go/internal/work/security.go               |    1 +
 src/cmd/go/proxy_test.go                           |   17 +-
 .../mod/example.com_retract_missingmod_v1.0.0.txt  |   10 +
 .../mod/example.com_retract_missingmod_v1.9.0.txt  |    4 +
 .../example.com_retract_rationale_v1.0.0-block.txt |    6 +
 ...m_retract_rationale_v1.0.0-blockwithcomment.txt |    6 +
 .../example.com_retract_rationale_v1.0.0-empty.txt |    8 +
 .../example.com_retract_rationale_v1.0.0-long.txt  |    8 +
 ...ple.com_retract_rationale_v1.0.0-multiline1.txt |    8 +
 ...ple.com_retract_rationale_v1.0.0-multiline2.txt |    8 +
 .../example.com_retract_rationale_v1.0.0-order.txt |    6 +
 ...le.com_retract_rationale_v1.0.0-unprintable.txt |    8 +
 .../example.com_retract_rationale_v1.0.1-order.txt |    6 +
 .../mod/example.com_retract_rationale_v1.9.0.txt   |   48 +
 .../mod/example.com_retract_self_all_v1.9.0.txt    |   14 +
 .../example.com_retract_self_prerelease_v1.0.0.txt |   16 +
 .../example.com_retract_self_prerelease_v1.9.0.txt |   19 +
 ...mple.com_retract_self_prerelease_v1.9.1-pre.txt |   16 +
 .../example.com_retract_self_prev_v1.0.0-bad.txt   |   14 +
 .../mod/example.com_retract_self_prev_v1.1.0.txt   |   14 +
 .../mod/example.com_retract_self_prev_v1.9.0.txt   |   18 +
 ..._self_pseudo_v0.0.0-20200325131415-0123456789ab |   20 +
 .../example.com_retract_self_pseudo_v1.0.0-bad.txt |   14 +
 .../mod/example.com_retract_self_pseudo_v1.9.0.txt |   16 +
 .../mod/example.com_retract_v1.0.0-bad.txt         |   10 +
 .../mod/example.com_retract_v1.0.0-good.txt        |   10 +
 .../mod/example.com_retract_v1.0.0-unused.txt      |   10 +
 .../go/testdata/mod/example.com_retract_v1.1.0.txt |   13 +
 ...xample.com_split-incompatible_subpkg_v0.1.0.txt |   14 +
 ....com_split-incompatible_v2.0.0+incompatible.txt |   10 +
 ..._split-incompatible_v2.1.0-pre+incompatible.txt |   10 +
 src/cmd/go/testdata/script/get_insecure_env.txt    |   29 +
 src/cmd/go/testdata/script/get_unicode.txt         |   40 -
 src/cmd/go/testdata/script/list_bad_import.txt     |   18 +-
 src/cmd/go/testdata/script/list_test_err.txt       |    3 +
 src/cmd/go/testdata/script/mod_all.txt             |  444 ++
 src/cmd/go/testdata/script/mod_auth.txt            |    2 +-
 src/cmd/go/testdata/script/mod_bad_filenames.txt   |    6 +-
 src/cmd/go/testdata/script/mod_build_info_err.txt  |    2 +-
 src/cmd/go/testdata/script/mod_case.txt            |    7 +-
 src/cmd/go/testdata/script/mod_concurrent.txt      |    1 +
 src/cmd/go/testdata/script/mod_doc.txt             |    2 +
 src/cmd/go/testdata/script/mod_domain_root.txt     |    2 +-
 src/cmd/go/testdata/script/mod_download.txt        |   85 +-
 src/cmd/go/testdata/script/mod_download_json.txt   |    3 +-
 .../go/testdata/script/mod_download_partial.txt    |    9 +-
 src/cmd/go/testdata/script/mod_edit.txt            |  114 +-
 src/cmd/go/testdata/script/mod_find.txt            |    5 +
 src/cmd/go/testdata/script/mod_get_commit.txt      |    1 -
 .../go/testdata/script/mod_get_incompatible.txt    |    2 +-
 src/cmd/go/testdata/script/mod_get_indirect.txt    |    2 +-
 .../go/testdata/script/mod_get_latest_pseudo.txt   |    2 +-
 src/cmd/go/testdata/script/mod_get_moved.txt       |    1 -
 src/cmd/go/testdata/script/mod_get_retract.txt     |   49 +
 src/cmd/go/testdata/script/mod_get_sum_noroot.txt  |   11 +
 .../go/testdata/script/mod_get_trailing_slash.txt  |    3 +
 src/cmd/go/testdata/script/mod_import.txt          |    2 +-
 .../go/testdata/script/mod_import_issue41113.txt   |   28 +
 src/cmd/go/testdata/script/mod_in_testdata_dir.txt |    6 +-
 src/cmd/go/testdata/script/mod_init_dep.txt        |   21 +-
 .../go/testdata/script/mod_install_versioned.txt   |    2 +
 src/cmd/go/testdata/script/mod_internal.txt        |   14 +-
 src/cmd/go/testdata/script/mod_invalid_path.txt    |   40 +
 src/cmd/go/testdata/script/mod_invalid_version.txt |    5 +-
 .../go/testdata/script/mod_lazy_import_allmod.txt  |  172 +
 src/cmd/go/testdata/script/mod_lazy_new_import.txt |  107 +
 .../go/testdata/script/mod_lazy_test_horizon.txt   |  131 +
 .../testdata/script/mod_lazy_test_of_test_dep.txt  |  145 +
 src/cmd/go/testdata/script/mod_list.txt            |    8 +-
 src/cmd/go/testdata/script/mod_list_bad_import.txt |   18 +-
 src/cmd/go/testdata/script/mod_list_dir.txt        |    5 +
 src/cmd/go/testdata/script/mod_list_direct.txt     |    2 +-
 src/cmd/go/testdata/script/mod_list_pseudo.txt     |   21 +-
 .../go/testdata/script/mod_list_replace_dir.txt    |   12 +-
 src/cmd/go/testdata/script/mod_list_retract.txt    |  108 +
 src/cmd/go/testdata/script/mod_list_std.txt        |   64 +-
 src/cmd/go/testdata/script/mod_list_test.txt       |   14 +
 src/cmd/go/testdata/script/mod_list_upgrade.txt    |    4 +
 src/cmd/go/testdata/script/mod_load_badchain.txt   |    4 +-
 src/cmd/go/testdata/script/mod_load_badmod.txt     |    7 +-
 src/cmd/go/testdata/script/mod_load_badzip.txt     |    4 +-
 .../testdata/script/mod_load_replace_mismatch.txt  |    2 +-
 .../testdata/script/mod_missingpkg_prerelease.txt  |    4 +-
 src/cmd/go/testdata/script/mod_modinfo.txt         |    1 +
 src/cmd/go/testdata/script/mod_multirepo.txt       |    1 +
 src/cmd/go/testdata/script/mod_notall.txt          |   99 +
 src/cmd/go/testdata/script/mod_permissions.txt     |    2 +-
 src/cmd/go/testdata/script/mod_query.txt           |   10 +
 src/cmd/go/testdata/script/mod_query_exclude.txt   |   41 +-
 src/cmd/go/testdata/script/mod_replace.txt         |    4 +-
 src/cmd/go/testdata/script/mod_replace_gopkgin.txt |    3 +-
 src/cmd/go/testdata/script/mod_replace_import.txt  |    1 +
 src/cmd/go/testdata/script/mod_require_exclude.txt |   62 +-
 src/cmd/go/testdata/script/mod_retention.txt       |    6 +-
 src/cmd/go/testdata/script/mod_retract.txt         |   43 +
 .../go/testdata/script/mod_retract_rationale.txt   |   79 +
 src/cmd/go/testdata/script/mod_retract_replace.txt |   61 +
 src/cmd/go/testdata/script/mod_std_vendor.txt      |    6 +-
 src/cmd/go/testdata/script/mod_sum_lookup.txt      |    5 +-
 src/cmd/go/testdata/script/mod_sumdb.txt           |    6 +
 src/cmd/go/testdata/script/mod_sumdb_golang.txt    |   12 +-
 src/cmd/go/testdata/script/mod_symlink.txt         |    5 +-
 src/cmd/go/testdata/script/mod_symlink_dotgo.txt   |   17 +
 src/cmd/go/testdata/script/mod_test.txt            |    1 +
 src/cmd/go/testdata/script/mod_tidy_replace.txt    |    1 +
 src/cmd/go/testdata/script/mod_upgrade_patch.txt   |    1 +
 src/cmd/go/testdata/script/mod_vcs_missing.txt     |    4 +-
 src/cmd/go/testdata/script/mod_vendor_build.txt    |    3 +
 src/cmd/go/testdata/script/mod_verify.txt          |    2 +-
 src/cmd/go/testdata/script/mod_why.txt             |    3 +
 src/cmd/go/testdata/script/modfile_flag.txt        |    6 +-
 src/cmd/go/testdata/script/test_example_goexit.txt |   25 +
 src/cmd/go/testdata/script/test_exit.txt           |  114 +
 src/cmd/go/testdata/script/testing_issue40908.txt  |   21 +
 src/cmd/go/testdata/script/version.txt             |    1 +
 src/cmd/go/testdata/script/version_replace.txt     |    2 +-
 src/cmd/internal/goobj/objfile.go                  |   14 +-
 src/cmd/internal/obj/arm/asm5.go                   |   16 +-
 src/cmd/internal/obj/arm/obj5.go                   |   10 +-
 src/cmd/internal/obj/arm64/a.out.go                |   11 +
 src/cmd/internal/obj/arm64/anames.go               |   11 +
 src/cmd/internal/obj/arm64/asm7.go                 |  179 +-
 src/cmd/internal/obj/arm64/obj7.go                 |   26 +-
 src/cmd/internal/obj/link.go                       |   24 +-
 src/cmd/internal/obj/mips/asm0.go                  |   24 +-
 src/cmd/internal/obj/mips/obj0.go                  |   14 +-
 src/cmd/internal/obj/pass.go                       |   17 +-
 src/cmd/internal/obj/ppc64/asm9.go                 |   18 +-
 src/cmd/internal/obj/ppc64/obj9.go                 |   12 +-
 src/cmd/internal/obj/riscv/obj.go                  |   29 +-
 src/cmd/internal/obj/s390x/asmz.go                 |   18 +-
 src/cmd/internal/obj/s390x/objz.go                 |   10 +-
 src/cmd/internal/obj/sym.go                        |    1 -
 src/cmd/internal/obj/util.go                       |    6 +-
 src/cmd/internal/obj/x86/asm6.go                   |   18 +-
 src/cmd/internal/obj/x86/obj6.go                   |   14 +-
 src/cmd/internal/objabi/doc.go                     |  122 -
 src/cmd/internal/objabi/funcdata.go                |    2 +-
 src/cmd/internal/objabi/util.go                    |   14 +-
 src/cmd/internal/objfile/macho.go                  |    2 +-
 src/cmd/internal/objfile/pe.go                     |   14 +-
 src/cmd/link/internal/arm64/obj.go                 |    2 +-
 src/cmd/link/internal/ld/data.go                   |   24 +-
 src/cmd/link/internal/ld/deadcode.go               |    2 +-
 src/cmd/link/internal/ld/lib.go                    |   44 +-
 src/cmd/link/internal/ld/macho.go                  |   41 +-
 src/cmd/link/internal/ld/macho_combine_dwarf.go    |  112 +-
 src/cmd/link/internal/ld/symtab.go                 |    4 +-
 src/cmd/link/internal/ld/target.go                 |    6 +-
 src/cmd/link/internal/loader/loader.go             |   36 +-
 src/cmd/link/internal/sym/symkind.go               |    2 +-
 src/cmd/link/internal/sym/symkind_string.go        |   24 +-
 src/cmd/link/link_test.go                          |   22 +-
 src/cmd/link/testdata/testRO/x.go                  |   22 +
 src/cmd/objdump/objdump_test.go                    |   34 +-
 src/cmd/objdump/testdata/fmthellocgo.go            |   21 +
 src/cmd/vendor/golang.org/x/mod/modfile/read.go    |    8 +
 src/cmd/vendor/golang.org/x/mod/modfile/rule.go    |  243 +-
 src/cmd/vendor/golang.org/x/mod/module/module.go   |   33 +-
 src/cmd/vendor/golang.org/x/mod/zip/zip.go         |  621 +-
 .../go/analysis/passes/structtag/structtag.go      |    6 +-
 .../go/analysis/passes/unmarshal/unmarshal.go      |    7 +-
 .../analysis/passes/unusedresult/unusedresult.go   |    2 +-
 .../x/tools/internal/analysisinternal/analysis.go  |  343 +-
 .../golang.org/x/tools/internal/lsp/fuzzy/input.go |  168 +
 .../x/tools/internal/lsp/fuzzy/matcher.go          |  398 ++
 src/cmd/vendor/modules.txt                         |    5 +-
 src/crypto/x509/x509.go                            |    1 -
 src/database/sql/sql.go                            |    7 +
 src/debug/elf/file.go                              |   77 +-
 src/debug/elf/file_test.go                         |  623 +-
 ...go-relocation-test-gcc930-ranges-no-rela-x86-64 |  Bin 0 -> 5696 bytes
 ...-relocation-test-gcc930-ranges-with-rela-x86-64 |  Bin 0 -> 7680 bytes
 src/debug/elf/testdata/multiple-code-sections.c    |   28 +
 src/encoding/binary/varint.go                      |    4 +-
 src/go.mod                                         |    2 +-
 src/go.sum                                         |    4 +-
 src/go/ast/ast.go                                  |    6 +
 src/go/build/build.go                              |    6 +
 src/go/doc/example.go                              |    2 +-
 src/go/doc/example_test.go                         |    9 +-
 src/go/types/api_test.go                           |   44 +
 src/go/types/assignments.go                        |   17 +-
 src/go/types/check_test.go                         |   32 +-
 src/go/types/errors.go                             |   39 +-
 src/go/types/expr.go                               |  153 +-
 .../types/{testdata => fixedbugs}/issue23203a.src  |    0
 .../types/{testdata => fixedbugs}/issue23203b.src  |    0
 .../types/{testdata => fixedbugs}/issue26390.src   |    2 +
 .../types/{testdata => fixedbugs}/issue28251.src   |    0
 src/go/types/{testdata => fixedbugs}/issue6977.src |    0
 src/go/types/operand.go                            |   43 +-
 src/go/types/self_test.go                          |   25 +-
 src/go/types/stdlib_test.go                        |   51 +-
 src/go/types/testdata/cycles2.src                  |    5 +-
 src/go/types/testdata/shifts.src                   |   23 +-
 src/html/template/escape.go                        |    2 +
 src/html/template/template_test.go                 |   16 +
 src/image/gif/writer_test.go                       |   34 +-
 src/internal/testlog/exit.go                       |   33 +
 src/make.bash                                      |   10 +-
 src/math/big/arith_arm64.s                         |  113 +-
 src/math/big/arith_test.go                         |  106 +-
 src/math/big/example_test.go                       |    7 +
 src/math/big/float.go                              |    7 +-
 src/mime/example_test.go                           |   26 +
 src/net/error_test.go                              |   17 +-
 src/net/http/cgi/child.go                          |    3 +
 src/net/http/cgi/integration_test.go               |   21 +
 src/net/http/export_test.go                        |   11 +
 src/net/http/fcgi/child.go                         |    3 +
 src/net/http/fs.go                                 |   10 +-
 src/net/http/fs_test.go                            |   70 +-
 src/net/http/h2_bundle.go                          |   85 +-
 src/net/http/omithttp2.go                          |    4 -
 src/net/http/requestwrite_test.go                  |   25 +-
 src/net/http/serve_test.go                         |   70 +-
 src/net/http/server.go                             |  110 +-
 src/net/http/transfer.go                           |    2 +-
 src/net/http/transport.go                          |   18 +-
 src/net/http/transport_test.go                     |  108 +-
 src/net/mail/message.go                            |   13 +-
 src/net/mail/message_test.go                       |   32 +
 src/net/net.go                                     |   12 +
 src/net/smtp/smtp.go                               |    6 +-
 src/net/smtp/smtp_test.go                          |  213 +
 src/os/dir_darwin.go                               |   10 +-
 src/os/dir_unix.go                                 |    2 +-
 src/os/os_test.go                                  |    4 +
 src/os/proc.go                                     |    8 +
 src/runtime/cgocall.go                             |    9 +-
 src/runtime/debug.go                               |    5 +-
 src/runtime/debugcall.go                           |    2 +-
 src/runtime/defs_linux_arm.go                      |    4 +
 src/runtime/defs_linux_mips64x.go                  |    4 +
 src/runtime/defs_openbsd_arm64.go                  |    4 +
 src/runtime/defs_plan9_386.go                      |    4 +
 src/runtime/defs_plan9_amd64.go                    |    4 +
 src/runtime/export_test.go                         |   24 +-
 src/runtime/internal/atomic/asm_wasm.s             |   10 +
 src/runtime/internal/atomic/atomic_test.go         |   10 +
 src/runtime/internal/atomic/atomic_wasm.go         |   13 +-
 src/runtime/lockrank.go                            |    2 +-
 src/runtime/lockrank_off.go                        |   10 +
 src/runtime/map.go                                 |    9 +
 src/runtime/map_fast32.go                          |    5 +
 src/runtime/map_fast64.go                          |    5 +
 src/runtime/map_faststr.go                         |    5 +
 src/runtime/mgcmark.go                             |    3 +-
 src/runtime/mgcstack.go                            |    2 -
 src/runtime/mkduff.go                              |    1 -
 src/runtime/mpagealloc.go                          |   13 +
 src/runtime/os_linux.go                            |   15 -
 src/runtime/preempt.go                             |    2 +-
 src/runtime/proc.go                                |   10 +-
 src/runtime/rt0_linux_ppc64.s                      |    4 +
 src/runtime/rt0_linux_ppc64le.s                    |    4 +
 src/runtime/runtime2.go                            |   13 +-
 src/runtime/select.go                              |    1 +
 src/runtime/stack.go                               |    8 +-
 src/runtime/symtab.go                              |    3 +
 src/runtime/trace/annotation.go                    |    4 +
 src/runtime/trace/annotation_test.go               |    4 +
 src/runtime/traceback.go                           |    6 +-
 src/sync/map.go                                    |    1 +
 src/sync/map_test.go                               |   24 +
 src/testing/benchmark.go                           |   18 +-
 src/testing/example.go                             |   11 +-
 src/testing/internal/testdeps/deps.go              |    5 +
 src/testing/run_example.go                         |    4 +-
 src/testing/run_example_js.go                      |    4 +-
 src/testing/sub_test.go                            |   46 +-
 src/testing/testing.go                             |  252 +-
 src/testing/testing_test.go                        |   32 +
 src/text/template/exec.go                          |    1 +
 src/text/template/parse/lex.go                     |    8 +-
 src/text/template/parse/lex_test.go                |    7 +-
 src/text/template/parse/node.go                    |   33 +
 src/text/template/parse/parse.go                   |   22 +-
 src/text/template/parse/parse_test.go              |   25 +
 src/unicode/utf8/utf8_test.go                      |   30 +-
 src/vendor/modules.txt                             |    2 +-
 test/README.md                                     |    4 +
 test/codegen/arithmetic.go                         |   73 +-
 test/codegen/comparisons.go                        |   80 +
 test/codegen/mathbits.go                           |   14 +
 test/codegen/select.go                             |   20 +
 test/codegen/slices.go                             |   21 +
 test/fixedbugs/bug229.go                           |    8 +-
 test/fixedbugs/issue13268.go                       |    6 -
 test/fixedbugs/issue21317.go                       |    2 +-
 test/fixedbugs/issue22660.go                       |    2 +-
 test/fixedbugs/issue22662b.go                      |    2 +-
 test/fixedbugs/issue22921.go                       |   18 +
 test/fixedbugs/issue24491.go                       |   45 +
 test/fixedbugs/issue38125.go                       |   22 +
 test/fixedbugs/issue39505.go                       |   31 +
 test/fixedbugs/issue39505b.go                      |  183 +
 test/fixedbugs/issue41247.go                       |   11 +
 test/fixedbugs/issue8606b.go                       |   63 +
 test/fixedbugs/issue9355.go                        |    2 +-
 test/notinheap2.go                                 |   12 +-
 test/runtime.go                                    |    2 +-
 427 files changed, 18985 insertions(+), 15059 deletions(-)

diff --cc src/cmd/link/internal/loader/loader.go
index ea9cd1bd2e,43a0352e0b..af51d9eb88
--- a/src/cmd/link/internal/loader/loader.go
+++ b/src/cmd/link/internal/loader/loader.go
@@@ -328,10 -329,10 +329,10 @@@ func NewLoader(flags uint32, elfsetstri
  	ldr := &Loader{
  		start:                make(map[*oReader]Sym),
  		objs:                 []objIdx{{}, {extReader, 0}}, // reserve index 0 for nil symbol, 1 for external symbols
 -		objSyms:              make([]objSym, 1, 100000),    // reserve index 0 for nil symbol
 +		objSyms:              make([]objSym, 1, 1),         // This will get overwritten later.
  		extReader:            extReader,
  		symsByName:           [2]map[string]Sym{make(map[string]Sym, 80000), make(map[string]Sym, 50000)}, // preallocate ~2MB for ABI0 and ~1MB for ABI1 symbols
- 		objByPkg:             make(map[string]*oReader),
+ 		objByPkg:             make(map[string]uint32),
  		outer:                make(map[Sym]Sym),
  		sub:                  make(map[Sym]Sym),
  		dynimplib:            make(map[Sym]string),
