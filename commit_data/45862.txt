commit 6826287c6b1ff2e3f23611472a9d81ac5e3aa89a
Author: Russ Cox <rsc@golang.org>
Date:   Tue Nov 24 09:37:54 2020 -0500

    [dev.regabi] cmd/compile: replace evconst with non-mutating version
    
    evconst is one of the largest sources of Op rewrites,
    which prevent separating different kinds of nodes
    (in this case, arithmetic nodes and OLITERAL nodes).
    
    The change in swt.go is necessary because otherwise
    the syntax graph ends up containing that OLEN expression
    multiple times, which violates the invariant that it's a tree
    except for ONAME, OLITERAL, and OTYPE nodes.
    (Before, the OLEN was overwritten by an OLITERAL, so the
    invariant still held, but now that we don't overwrite it,
    we need a different copy for each instance.)
    
    Passes toolstash -cmp.
    
    Change-Id: Ia004774ab6852fb384805d0f9f9f234b40842811
    Reviewed-on: https://go-review.googlesource.com/c/go/+/272869
    Trust: Russ Cox <rsc@golang.org>
    Run-TryBot: Russ Cox <rsc@golang.org>
    TryBot-Result: Go Bot <gobot@golang.org>
    Reviewed-by: Matthew Dempsky <mdempsky@google.com>

 src/cmd/compile/internal/gc/const.go     | 115 +++++++++++++++++--------------
 src/cmd/compile/internal/gc/swt.go       |   5 +-
 src/cmd/compile/internal/gc/typecheck.go |  15 ++--
 src/cmd/compile/internal/gc/walk.go      |   4 +-
 4 files changed, 76 insertions(+), 63 deletions(-)
