commit a794fa5f69dd80f5553a9fc3df4c08f9fdbb883c
Author: Filippo Valsorda <filippo@golang.org>
Date:   Thu Nov 14 14:47:55 2024 +0100

    crypto/internal/fips: wrap and lock internal dependencies
    
    The changes below src/crypto/internal/fips/ are mechanical.
    
    See fipsdeps.go and fipsdeps_test.go for the rationale.
    
    For #69536
    
    Change-Id: I292ce65237cd8d2fd87fab99814514dd0e69c4a7
    Reviewed-on: https://go-review.googlesource.com/c/go/+/627956
    LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
    Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
    Reviewed-by: Daniel McCarney <daniel@binaryparadox.net>
    Auto-Submit: Filippo Valsorda <filippo@golang.org>
    Reviewed-by: Russ Cox <rsc@golang.org>

 src/crypto/internal/fips/aes/aes_asm.go            | 17 +++---
 src/crypto/internal/fips/aes/aes_generic.go        | 36 ++++++------
 src/crypto/internal/fips/aes/aes_s390x.go          |  4 +-
 src/crypto/internal/fips/aes/ctr.go                | 10 ++--
 src/crypto/internal/fips/aes/ctr_s390x.go          |  6 +-
 src/crypto/internal/fips/aes/gcm/gcm_asm.go        | 11 ++--
 src/crypto/internal/fips/aes/gcm/gcm_generic.go    | 10 ++--
 src/crypto/internal/fips/aes/gcm/gcm_nonces.go     | 14 ++---
 src/crypto/internal/fips/aes/gcm/gcm_ppc64x.go     | 18 +++---
 src/crypto/internal/fips/aes/gcm/gcm_s390x.go      | 12 ++--
 src/crypto/internal/fips/aes/gcm/ghash.go          | 14 ++---
 src/crypto/internal/fips/cast.go                   |  6 +-
 src/crypto/internal/fips/check/asan.go             |  9 +++
 src/crypto/internal/fips/check/check.go            | 11 ++--
 src/crypto/internal/fips/check/noasan.go           |  9 +++
 src/crypto/internal/fips/drbg/ctrdrbg.go           | 10 ++--
 src/crypto/internal/fips/fips.go                   |  4 +-
 src/crypto/internal/fips/mlkem/field.go            |  6 +-
 src/crypto/internal/fips/sha256/sha256.go          | 42 +++++++-------
 .../internal/fips/sha256/sha256block_amd64.go      |  6 +-
 .../internal/fips/sha256/sha256block_arm64.go      |  4 +-
 .../internal/fips/sha256/sha256block_ppc64x.go     |  4 +-
 .../internal/fips/sha256/sha256block_s390x.go      |  4 +-
 src/crypto/internal/fips/sha3/keccakf.go           | 10 ++--
 src/crypto/internal/fips/sha3/sha3_s390x.go        |  4 +-
 src/crypto/internal/fips/sha3/shake.go             |  4 +-
 src/crypto/internal/fips/sha512/sha512.go          | 42 +++++++-------
 .../internal/fips/sha512/sha512block_amd64.go      |  4 +-
 .../internal/fips/sha512/sha512block_arm64.go      |  4 +-
 .../internal/fips/sha512/sha512block_ppc64x.go     |  4 +-
 .../internal/fips/sha512/sha512block_s390x.go      |  4 +-
 src/crypto/internal/fips/tls13/tls13.go            |  4 +-
 .../internal/fipsdeps/byteorder/byteorder.go       | 53 ++++++++++++++++++
 src/crypto/internal/fipsdeps/cpu/cpu.go            | 37 ++++++++++++
 src/crypto/internal/fipsdeps/fipsdeps.go           |  9 +++
 src/crypto/internal/fipsdeps/fipsdeps_test.go      | 65 ++++++++++++++++++++++
 src/crypto/internal/fipsdeps/godebug/godebug.go    | 23 ++++++++
 src/go/build/deps_test.go                          | 11 +++-
 38 files changed, 376 insertions(+), 169 deletions(-)
