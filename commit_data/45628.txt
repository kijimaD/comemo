commit e463c28cc116fb1f40a4e203bddf93b6ef52c8d9
Author: Quim Muntal <quimmuntal@gmail.com>
Date:   Thu Oct 22 22:32:20 2020 +0200

    cmd/link: avoid exporting all symbols on windows buildmode=pie
    
    Marking one functions with __declspec(dllexport) forces mingw to
    create .reloc section without having to export all symbols.
    
    See https://insights.sei.cmu.edu/cert/2018/08/when-aslr-is-not-really-aslr---the-case-of-incorrect-assumptions-and-bad-defaults.html for more info.
    
    This change cuts 73kb of a "hello world" pie binary.
    
    Updates #6853
    Fixes #40795
    
    Change-Id: I3cc57c3b64f61187550bc8751dfa085f106c8475
    Reviewed-on: https://go-review.googlesource.com/c/go/+/264459
    Trust: Alex Brainman <alex.brainman@gmail.com>
    Run-TryBot: Alex Brainman <alex.brainman@gmail.com>
    TryBot-Result: Go Bot <gobot@golang.org>
    Reviewed-by: Alex Brainman <alex.brainman@gmail.com>
    Reviewed-by: Austin Clements <austin@google.com>

 misc/cgo/testcshared/cshared_test.go |  9 +++++----
 src/cmd/go/go_test.go                | 33 +++++++++++++++++++++++++++++++++
 src/cmd/link/internal/ld/lib.go      |  3 ---
 src/runtime/cgo/gcc_windows_386.c    |  1 +
 src/runtime/cgo/gcc_windows_amd64.c  |  1 +
 src/runtime/cgo/libcgo_windows.h     | 12 ++++++++++++
 6 files changed, 52 insertions(+), 7 deletions(-)
