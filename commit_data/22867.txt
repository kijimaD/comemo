commit dc2d64bf81b3342d35bdbfa42b971087ade6dfc6
Author: Brad Fitzpatrick <bradfitz@golang.org>
Date:   Fri Apr 10 15:59:06 2015 +0200

    cmd/go: cache results of HTTP requests done during meta tag discovery
    
    Previously, running
    
      $ go get -u -v golang.org/x/tools/cmd/godoc
    
    would results in dozens of HTTP requests for
    
      https://golang.org/x/tools?go-get=1
    
    once per package under x/tools.
    
    Now it caches the results. We still end up doing one HTTP request for
    all the packages under x/tools, but this reduces the total number of
    HTTP requests in ~half.
    
    This also moves the singleflight package back into an internal
    package. singleflight was originally elsewhere as a package, then got
    copied into "net" (without its tests). But now that we have internal,
    put it in its own package, and restore its test.
    
    Fixes #9249
    
    Change-Id: Ieb5cf04fc4d0a0c188cb957efdc7ea3068c34e3f
    Reviewed-on: https://go-review.googlesource.com/8727
    Reviewed-by: Ian Lance Taylor <iant@golang.org>
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>

 src/cmd/dist/build.go                              |  1 +
 src/cmd/go/vcs.go                                  | 92 +++++++++++++++++-----
 src/go/build/deps_test.go                          |  2 +-
 src/{net => internal/singleflight}/singleflight.go | 34 ++++----
 src/internal/singleflight/singleflight_test.go     | 73 +++++++++++++++++
 src/net/lookup.go                                  |  9 ++-
 6 files changed, 170 insertions(+), 41 deletions(-)
