commit 5887f142a33fbb8da94088e902ced4101a16aa8f
Author: Dmitriy Vyukov <dvyukov@google.com>
Date:   Wed Jul 17 12:52:37 2013 -0400

    runtime: more reliable preemption
    Currently preemption signal g->stackguard0==StackPreempt
    can be lost if it is received when preemption is disabled
    (e.g. m->lock!=0). This change duplicates the preemption
    signal in g->preempt and restores g->stackguard0
    when preemption is enabled.
    Update #543.
    
    R=golang-dev, rsc
    CC=golang-dev
    https://golang.org/cl/10792043

 src/pkg/runtime/lock_futex.c |  3 +++
 src/pkg/runtime/lock_sema.c  |  3 +++
 src/pkg/runtime/malloc.goc   |  3 +++
 src/pkg/runtime/mgc0.c       |  4 +++-
 src/pkg/runtime/proc.c       | 14 ++++++++++++++
 src/pkg/runtime/runtime.h    |  1 +
 src/pkg/runtime/stack.c      |  2 +-
 7 files changed, 28 insertions(+), 2 deletions(-)
