commit 156e8b306d009ef118a4138f34098c8c41976a08
Author: Dmitriy Vyukov <dvyukov@google.com>
Date:   Wed Jul 31 19:59:27 2013 +0400

    runtime: do not park sysmon thread if any goroutines are running
    Sysmon thread parks if no goroutines are running (runtime.sched.npidle == runtime.gomaxprocs).
    Currently it's unparked when a goroutine enters syscall, it was enough
    to retake P's from blocking syscalls.
    But it's not enough for reliable goroutine preemption. We need to ensure that
    sysmon runs if any goroutines are running.
    
    R=golang-dev, rsc
    CC=golang-dev
    https://golang.org/cl/12167043

 src/pkg/runtime/proc.c | 30 ++++++++++++++++++++++++++----
 1 file changed, 26 insertions(+), 4 deletions(-)
