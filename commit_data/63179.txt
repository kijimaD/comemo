commit e90acc814de247f58330be1d8ba3b11c78c96077
Author: Filippo Valsorda <filippo@golang.org>
Date:   Sat Mar 15 12:12:22 2025 +0100

    crypto/tls: don't advertise TLS 1.2-only sigAlgs in TLS 1.3
    
    If a ClientHello only supports TLS 1.3, or if a CertificateRequest is
    sent after selecting TLS 1.3, we should not advertise TLS 1.2-only
    signature_algorithms like PKCS#1 v1.5 or SHA-1.
    
    However, since crypto/x509 still supports PKCS#1 v1.5, and a direct
    CertPool match might not care about the signature in the certificate at
    all, start sending a separate signature_algorithms_cert extension to
    indicate support for PKCS#1 v1.5 and SHA-1 in certificates.
    
    We were already correctly rejecting these algorithms if the peer
    selected them in a TLS 1.3 connection.
    
    Updates #72883
    
    Change-Id: I6a6a4656ab60e1b7fb20fdedc32604dc156953ae
    Reviewed-on: https://go-review.googlesource.com/c/go/+/658215
    Reviewed-by: Roland Shoemaker <roland@golang.org>
    Reviewed-by: David Chase <drchase@google.com>
    Auto-Submit: Filippo Valsorda <filippo@golang.org>
    LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
    Reviewed-by: Daniel McCarney <daniel@binaryparadox.net>
---
 src/crypto/tls/auth.go                             |   2 +-
 src/crypto/tls/auth_test.go                        |   2 +-
 src/crypto/tls/common.go                           |  33 +-
 src/crypto/tls/defaults.go                         |  58 ++-
 src/crypto/tls/defaults_boring.go                  |   2 +-
 src/crypto/tls/defaults_fips140.go                 |   2 +-
 src/crypto/tls/fips140_test.go                     |   4 +-
 src/crypto/tls/handshake_client.go                 |  13 +-
 src/crypto/tls/handshake_client_tls13.go           |   7 +-
 src/crypto/tls/handshake_messages_test.go          |   8 +-
 src/crypto/tls/handshake_server.go                 |   2 +-
 src/crypto/tls/handshake_server_tls13.go           |  10 +-
 src/crypto/tls/quic_test.go                        |   2 +-
 .../testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA  | 104 ++--
 .../testdata/Client-TLSv10-ClientCert-ECDSA-RSA    |  96 ++--
 .../testdata/Client-TLSv10-ClientCert-RSA-ECDSA    |  96 ++--
 .../tls/testdata/Client-TLSv10-ClientCert-RSA-RSA  |  96 ++--
 .../tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES     |  82 +--
 .../tls/testdata/Client-TLSv10-ECDHE-RSA-AES       |  78 +--
 .../testdata/Client-TLSv10-ExportKeyingMaterial    |  78 +--
 src/crypto/tls/testdata/Client-TLSv10-RSA-RC4      |  46 +-
 .../tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES     |  82 +--
 .../tls/testdata/Client-TLSv11-ECDHE-RSA-AES       |  78 +--
 src/crypto/tls/testdata/Client-TLSv11-RSA-RC4      |  46 +-
 .../tls/testdata/Client-TLSv12-AES128-GCM-SHA256   |  50 +-
 .../tls/testdata/Client-TLSv12-AES128-SHA256       |  64 +--
 .../tls/testdata/Client-TLSv12-AES256-GCM-SHA384   |  50 +-
 src/crypto/tls/testdata/Client-TLSv12-ALPN         |  70 +--
 .../testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA  |  96 ++--
 .../testdata/Client-TLSv12-ClientCert-ECDSA-RSA    |  96 ++--
 .../tls/testdata/Client-TLSv12-ClientCert-Ed25519  |  80 +--
 .../Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384 |  92 ++--
 .../testdata/Client-TLSv12-ClientCert-RSA-ECDSA    | 108 ++--
 .../tls/testdata/Client-TLSv12-ClientCert-RSA-RSA  |  92 ++--
 .../Client-TLSv12-ClientCert-RSA-RSAPKCS1v15       |  92 ++--
 .../testdata/Client-TLSv12-ClientCert-RSA-RSAPSS   |  90 ++--
 .../tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES     |  78 +--
 .../tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM |  72 +--
 .../Client-TLSv12-ECDHE-ECDSA-AES128-SHA256        |  90 ++--
 .../Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384    |  76 +--
 .../Client-TLSv12-ECDHE-ECDSA-CHACHA20-POLY1305    |  68 +--
 .../tls/testdata/Client-TLSv12-ECDHE-RSA-AES       |  80 +--
 .../testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256 |  88 ++--
 .../Client-TLSv12-ECDHE-RSA-CHACHA20-POLY1305      |  68 +--
 src/crypto/tls/testdata/Client-TLSv12-Ed25519      |  60 +--
 .../testdata/Client-TLSv12-ExportKeyingMaterial    |  70 +--
 src/crypto/tls/testdata/Client-TLSv12-P256-ECDHE   |  80 +--
 src/crypto/tls/testdata/Client-TLSv12-RSA-RC4      |  46 +-
 .../tls/testdata/Client-TLSv12-RenegotiateOnce     | 370 +++++++-------
 .../tls/testdata/Client-TLSv12-RenegotiateTwice    | 564 +++++++++++----------
 .../Client-TLSv12-RenegotiateTwiceRejected         | 376 +++++++-------
 .../testdata/Client-TLSv12-RenegotiationRejected   |  76 +--
 src/crypto/tls/testdata/Client-TLSv12-SCT          |  68 +--
 src/crypto/tls/testdata/Client-TLSv12-X25519-ECDHE |  72 +--
 .../tls/testdata/Client-TLSv13-AES128-SHA256       | 154 +++---
 .../tls/testdata/Client-TLSv13-AES256-SHA384       | 158 +++---
 src/crypto/tls/testdata/Client-TLSv13-ALPN         | 158 +++---
 .../tls/testdata/Client-TLSv13-CHACHA20-SHA256     | 154 +++---
 .../testdata/Client-TLSv13-ClientCert-ECDSA-RSA    | 252 ++++-----
 .../tls/testdata/Client-TLSv13-ClientCert-Ed25519  | 218 ++++----
 .../testdata/Client-TLSv13-ClientCert-RSA-ECDSA    | 242 ++++-----
 .../testdata/Client-TLSv13-ClientCert-RSA-RSAPSS   | 260 +++++-----
 src/crypto/tls/testdata/Client-TLSv13-ECDSA        | 146 +++---
 src/crypto/tls/testdata/Client-TLSv13-Ed25519      | 110 ++--
 .../testdata/Client-TLSv13-ExportKeyingMaterial    | 154 +++---
 .../tls/testdata/Client-TLSv13-HelloRetryRequest   | 172 ++++---
 src/crypto/tls/testdata/Client-TLSv13-KeyUpdate    | 170 ++++---
 src/crypto/tls/testdata/Client-TLSv13-P256-ECDHE   | 158 +++---
 src/crypto/tls/testdata/Client-TLSv13-X25519-ECDHE | 152 +++---
 .../Server-TLSv13-ClientAuthRequestedAndECDSAGiven | 334 ++++++------
 ...erver-TLSv13-ClientAuthRequestedAndEd25519Given | 272 +++++-----
 .../Server-TLSv13-ClientAuthRequestedAndGiven      | 329 ++++++------
 .../Server-TLSv13-ClientAuthRequestedNotGiven      | 180 +++----
 73 files changed, 4187 insertions(+), 3995 deletions(-)

diff --git a/src/crypto/tls/auth.go b/src/crypto/tls/auth.go
index 81a85851ee..7f072204a7 100644
--- a/src/crypto/tls/auth.go
+++ b/src/crypto/tls/auth.go
@@ -220,7 +220,7 @@ func signatureSchemesForCertificate(version uint16, cert *Certificate) []Signatu
 
 	// Filter out any unsupported signature algorithms, for example due to
 	// FIPS 140-3 policy, or any downstream changes to defaults.go.
-	supportedAlgs := supportedSignatureAlgorithms()
+	supportedAlgs := supportedSignatureAlgorithms(version)
 	sigAlgs = slices.DeleteFunc(sigAlgs, func(sigAlg SignatureScheme) bool {
 		return !isSupportedSignatureAlgorithm(sigAlg, supportedAlgs)
 	})
diff --git a/src/crypto/tls/auth_test.go b/src/crypto/tls/auth_test.go
index 9036f4c8d2..616d9bab78 100644
--- a/src/crypto/tls/auth_test.go
+++ b/src/crypto/tls/auth_test.go
@@ -159,7 +159,7 @@ func TestLegacyTypeAndHash(t *testing.T) {
 // TestSupportedSignatureAlgorithms checks that all supportedSignatureAlgorithms
 // have valid type and hash information.
 func TestSupportedSignatureAlgorithms(t *testing.T) {
-	for _, sigAlg := range supportedSignatureAlgorithms() {
+	for _, sigAlg := range supportedSignatureAlgorithms(VersionTLS12) {
 		sigType, hash, err := typeAndHashFromSignatureScheme(sigAlg)
 		if err != nil {
 			t.Errorf("%v: unexpected error: %v", sigAlg, err)
diff --git a/src/crypto/tls/common.go b/src/crypto/tls/common.go
index 1aaad7aba1..6a1c53fe9c 100644
--- a/src/crypto/tls/common.go
+++ b/src/crypto/tls/common.go
@@ -1163,6 +1163,8 @@ const roleServer = false
 
 var tls10server = godebug.New("tls10server")
 
+// supportedVersions returns the list of supported TLS versions, sorted from
+// highest to lowest (and hence also in preference order).
 func (c *Config) supportedVersions(isClient bool) []uint16 {
 	versions := make([]uint16, 0, len(supportedVersions))
 	for _, v := range supportedVersions {
@@ -1682,12 +1684,35 @@ func unexpectedMessageError(wanted, got any) error {
 	return fmt.Errorf("tls: received unexpected handshake message of type %T when waiting for %T", got, wanted)
 }
 
-// supportedSignatureAlgorithms returns the supported signature algorithms.
-func supportedSignatureAlgorithms() []SignatureScheme {
+// supportedSignatureAlgorithms returns the supported signature algorithms for
+// the given minimum TLS version, to advertise in ClientHello and
+// CertificateRequest messages.
+func supportedSignatureAlgorithms(minVers uint16) []SignatureScheme {
+	sigAlgs := defaultSupportedSignatureAlgorithms()
 	if fips140tls.Required() {
-		return allowedSupportedSignatureAlgorithmsFIPS
+		sigAlgs = slices.DeleteFunc(sigAlgs, func(s SignatureScheme) bool {
+			return !slices.Contains(allowedSignatureAlgorithmsFIPS, s)
+		})
+	}
+	if minVers > VersionTLS12 {
+		sigAlgs = slices.DeleteFunc(sigAlgs, func(s SignatureScheme) bool {
+			sigType, sigHash, _ := typeAndHashFromSignatureScheme(s)
+			return sigType == signaturePKCS1v15 || sigHash == crypto.SHA1
+		})
+	}
+	return sigAlgs
+}
+
+// supportedSignatureAlgorithmsCert returns the supported algorithms for
+// signatures in certificates.
+func supportedSignatureAlgorithmsCert() []SignatureScheme {
+	sigAlgs := defaultSupportedSignatureAlgorithmsCert()
+	if fips140tls.Required() {
+		sigAlgs = slices.DeleteFunc(sigAlgs, func(s SignatureScheme) bool {
+			return !slices.Contains(allowedSignatureAlgorithmsFIPS, s)
+		})
 	}
-	return defaultSupportedSignatureAlgorithms
+	return sigAlgs
 }
 
 func isSupportedSignatureAlgorithm(sigAlg SignatureScheme, supportedSignatureAlgorithms []SignatureScheme) bool {
diff --git a/src/crypto/tls/defaults.go b/src/crypto/tls/defaults.go
index a3f43eb87e..07986294ec 100644
--- a/src/crypto/tls/defaults.go
+++ b/src/crypto/tls/defaults.go
@@ -24,23 +24,51 @@ func defaultCurvePreferences() []CurveID {
 	return []CurveID{X25519MLKEM768, X25519, CurveP256, CurveP384, CurveP521}
 }
 
-// defaultSupportedSignatureAlgorithms contains the signature and hash algorithms that
-// the code advertises as supported in a TLS 1.2+ ClientHello and in a TLS 1.2+
+// defaultSupportedSignatureAlgorithms returns the signature and hash algorithms that
+// the code advertises and supports in a TLS 1.2+ ClientHello and in a TLS 1.2+
 // CertificateRequest. The two fields are merged to match with TLS 1.3.
 // Note that in TLS 1.2, the ECDSA algorithms are not constrained to P-256, etc.
-var defaultSupportedSignatureAlgorithms = []SignatureScheme{
-	PSSWithSHA256,
-	ECDSAWithP256AndSHA256,
-	Ed25519,
-	PSSWithSHA384,
-	PSSWithSHA512,
-	PKCS1WithSHA256,
-	PKCS1WithSHA384,
-	PKCS1WithSHA512,
-	ECDSAWithP384AndSHA384,
-	ECDSAWithP521AndSHA512,
-	PKCS1WithSHA1,
-	ECDSAWithSHA1,
+func defaultSupportedSignatureAlgorithms() []SignatureScheme {
+	return []SignatureScheme{
+		PSSWithSHA256,
+		ECDSAWithP256AndSHA256,
+		Ed25519,
+		PSSWithSHA384,
+		PSSWithSHA512,
+		PKCS1WithSHA256,
+		PKCS1WithSHA384,
+		PKCS1WithSHA512,
+		ECDSAWithP384AndSHA384,
+		ECDSAWithP521AndSHA512,
+		PKCS1WithSHA1,
+		ECDSAWithSHA1,
+	}
+}
+
+// defaultSupportedSignatureAlgorithmsCert returns the signature algorithms that
+// the code advertises as supported for signatures in certificates.
+//
+// We include all algorithms, including SHA-1 and PKCS#1 v1.5, because it's more
+// likely that something on our side will be willing to accept a *-with-SHA1
+// certificate (e.g. with a custom VerifyConnection or by a direct match with
+// the CertPool), than that the peer would have a better certificate but is just
+// choosing not to send it. crypto/x509 will refuse to verify important SHA-1
+// signatures anyway.
+func defaultSupportedSignatureAlgorithmsCert() []SignatureScheme {
+	return []SignatureScheme{
+		PSSWithSHA256,
+		ECDSAWithP256AndSHA256,
+		Ed25519,
+		PSSWithSHA384,
+		PSSWithSHA512,
+		PKCS1WithSHA256,
+		PKCS1WithSHA384,
+		PKCS1WithSHA512,
+		ECDSAWithP384AndSHA384,
+		ECDSAWithP521AndSHA512,
+		PKCS1WithSHA1,
+		ECDSAWithSHA1,
+	}
 }
 
 var tlsrsakex = godebug.New("tlsrsakex")
diff --git a/src/crypto/tls/defaults_boring.go b/src/crypto/tls/defaults_boring.go
index 96406acfca..e88f05cc50 100644
--- a/src/crypto/tls/defaults_boring.go
+++ b/src/crypto/tls/defaults_boring.go
@@ -31,7 +31,7 @@ var (
 		CurveP384,
 		CurveP521,
 	}
-	allowedSupportedSignatureAlgorithmsFIPS = []SignatureScheme{
+	allowedSignatureAlgorithmsFIPS = []SignatureScheme{
 		PSSWithSHA256,
 		PSSWithSHA384,
 		PSSWithSHA512,
diff --git a/src/crypto/tls/defaults_fips140.go b/src/crypto/tls/defaults_fips140.go
index 472bb807f0..00176795eb 100644
--- a/src/crypto/tls/defaults_fips140.go
+++ b/src/crypto/tls/defaults_fips140.go
@@ -36,7 +36,7 @@ var (
 		CurveP384,
 		CurveP521,
 	}
-	allowedSupportedSignatureAlgorithmsFIPS = []SignatureScheme{
+	allowedSignatureAlgorithmsFIPS = []SignatureScheme{
 		PSSWithSHA256,
 		ECDSAWithP256AndSHA256,
 		Ed25519,
diff --git a/src/crypto/tls/fips140_test.go b/src/crypto/tls/fips140_test.go
index c22ad485cc..46d3076864 100644
--- a/src/crypto/tls/fips140_test.go
+++ b/src/crypto/tls/fips140_test.go
@@ -195,7 +195,7 @@ func TestFIPSServerCipherSuites(t *testing.T) {
 				keyShares:                    []keyShare{generateKeyShare(CurveP256)},
 				supportedPoints:              []uint8{pointFormatUncompressed},
 				supportedVersions:            []uint16{VersionTLS12},
-				supportedSignatureAlgorithms: allowedSupportedSignatureAlgorithmsFIPS,
+				supportedSignatureAlgorithms: allowedSignatureAlgorithmsFIPS,
 			}
 			if isTLS13CipherSuite(id) {
 				clientHello.supportedVersions = []uint16{VersionTLS13}
@@ -265,7 +265,7 @@ func TestFIPSServerSignatureAndHash(t *testing.T) {
 		testingOnlyForceClientHelloSignatureAlgorithms = nil
 	}()
 
-	for _, sigHash := range defaultSupportedSignatureAlgorithms {
+	for _, sigHash := range defaultSupportedSignatureAlgorithms() {
 		t.Run(fmt.Sprintf("%v", sigHash), func(t *testing.T) {
 			serverConfig := testConfig.Clone()
 			serverConfig.Certificates = make([]Certificate, 1)
diff --git a/src/crypto/tls/handshake_client.go b/src/crypto/tls/handshake_client.go
index 55790a11b6..619b47afbf 100644
--- a/src/crypto/tls/handshake_client.go
+++ b/src/crypto/tls/handshake_client.go
@@ -66,7 +66,10 @@ func (c *Conn) makeClientHello() (*clientHelloMsg, *keySharePrivateKeys, *echCli
 	if len(supportedVersions) == 0 {
 		return nil, nil, nil, errors.New("tls: no supported versions satisfy MinVersion and MaxVersion")
 	}
-	maxVersion := config.maxSupportedVersion(roleClient)
+	// Since supportedVersions is sorted in descending order, the first element
+	// is the maximum version and the last element is the minimum version.
+	maxVersion := supportedVersions[0]
+	minVersion := supportedVersions[len(supportedVersions)-1]
 
 	hello := &clientHelloMsg{
 		vers:                         maxVersion,
@@ -120,18 +123,20 @@ func (c *Conn) makeClientHello() (*clientHelloMsg, *keySharePrivateKeys, *echCli
 	}
 
 	if maxVersion >= VersionTLS12 {
-		hello.supportedSignatureAlgorithms = supportedSignatureAlgorithms()
+		hello.supportedSignatureAlgorithms = supportedSignatureAlgorithms(minVersion)
+		hello.supportedSignatureAlgorithmsCert = supportedSignatureAlgorithmsCert()
 	}
 	if testingOnlyForceClientHelloSignatureAlgorithms != nil {
 		hello.supportedSignatureAlgorithms = testingOnlyForceClientHelloSignatureAlgorithms
 	}
 
 	var keyShareKeys *keySharePrivateKeys
-	if hello.supportedVersions[0] == VersionTLS13 {
+	if maxVersion >= VersionTLS13 {
 		// Reset the list of ciphers when the client only supports TLS 1.3.
-		if len(hello.supportedVersions) == 1 {
+		if minVersion >= VersionTLS13 {
 			hello.cipherSuites = nil
 		}
+
 		if fips140tls.Required() {
 			hello.cipherSuites = append(hello.cipherSuites, allowedCipherSuitesTLS13FIPS...)
 		} else if hasAESGCMHardwareSupport {
diff --git a/src/crypto/tls/handshake_client_tls13.go b/src/crypto/tls/handshake_client_tls13.go
index 461a0e6962..bf3cab97b8 100644
--- a/src/crypto/tls/handshake_client_tls13.go
+++ b/src/crypto/tls/handshake_client_tls13.go
@@ -675,7 +675,9 @@ func (hs *clientHandshakeStateTLS13) readServerCertificate() error {
 	}
 
 	// See RFC 8446, Section 4.4.3.
-	if !isSupportedSignatureAlgorithm(certVerify.signatureAlgorithm, supportedSignatureAlgorithms()) {
+	// We don't use hs.hello.supportedSignatureAlgorithms because it might
+	// include PKCS#1 v1.5 and SHA-1 if the ClientHello also supported TLS 1.2.
+	if !isSupportedSignatureAlgorithm(certVerify.signatureAlgorithm, supportedSignatureAlgorithms(c.vers)) {
 		c.sendAlert(alertIllegalParameter)
 		return errors.New("tls: certificate used with invalid signature algorithm")
 	}
@@ -684,8 +686,7 @@ func (hs *clientHandshakeStateTLS13) readServerCertificate() error {
 		return c.sendAlert(alertInternalError)
 	}
 	if sigType == signaturePKCS1v15 || sigHash == crypto.SHA1 {
-		c.sendAlert(alertIllegalParameter)
-		return errors.New("tls: certificate used with invalid signature algorithm")
+		return c.sendAlert(alertInternalError)
 	}
 	signed := signedMessage(sigHash, serverSignatureContext, hs.transcript)
 	if err := verifyHandshakeSignature(sigType, c.peerCertificates[0].PublicKey,
diff --git a/src/crypto/tls/handshake_messages_test.go b/src/crypto/tls/handshake_messages_test.go
index 448bc31d3a..fa81a72b0d 100644
--- a/src/crypto/tls/handshake_messages_test.go
+++ b/src/crypto/tls/handshake_messages_test.go
@@ -179,10 +179,10 @@ func (*clientHelloMsg) Generate(rand *rand.Rand, size int) reflect.Value {
 		}
 	}
 	if rand.Intn(10) > 5 {
-		m.supportedSignatureAlgorithms = supportedSignatureAlgorithms()
+		m.supportedSignatureAlgorithms = supportedSignatureAlgorithms(VersionTLS12)
 	}
 	if rand.Intn(10) > 5 {
-		m.supportedSignatureAlgorithmsCert = supportedSignatureAlgorithms()
+		m.supportedSignatureAlgorithmsCert = supportedSignatureAlgorithms(VersionTLS12)
 	}
 	for i := 0; i < rand.Intn(5); i++ {
 		m.alpnProtocols = append(m.alpnProtocols, randomString(rand.Intn(20)+1, rand))
@@ -473,10 +473,10 @@ func (*certificateRequestMsgTLS13) Generate(rand *rand.Rand, size int) reflect.V
 		m.scts = true
 	}
 	if rand.Intn(10) > 5 {
-		m.supportedSignatureAlgorithms = supportedSignatureAlgorithms()
+		m.supportedSignatureAlgorithms = supportedSignatureAlgorithms(VersionTLS12)
 	}
 	if rand.Intn(10) > 5 {
-		m.supportedSignatureAlgorithmsCert = supportedSignatureAlgorithms()
+		m.supportedSignatureAlgorithmsCert = supportedSignatureAlgorithms(VersionTLS12)
 	}
 	if rand.Intn(10) > 5 {
 		m.certificateAuthorities = make([][]byte, 3)
diff --git a/src/crypto/tls/handshake_server.go b/src/crypto/tls/handshake_server.go
index d7fadcbd59..522d3b62c2 100644
--- a/src/crypto/tls/handshake_server.go
+++ b/src/crypto/tls/handshake_server.go
@@ -650,7 +650,7 @@ func (hs *serverHandshakeState) doFullHandshake() error {
 		}
 		if c.vers >= VersionTLS12 {
 			certReq.hasSignatureAlgorithm = true
-			certReq.supportedSignatureAlgorithms = supportedSignatureAlgorithms()
+			certReq.supportedSignatureAlgorithms = supportedSignatureAlgorithms(c.vers)
 		}
 
 		// An empty list of certificateAuthorities signals to
diff --git a/src/crypto/tls/handshake_server_tls13.go b/src/crypto/tls/handshake_server_tls13.go
index 54b3cac810..090ff67fb7 100644
--- a/src/crypto/tls/handshake_server_tls13.go
+++ b/src/crypto/tls/handshake_server_tls13.go
@@ -844,7 +844,8 @@ func (hs *serverHandshakeStateTLS13) sendServerCertificate() error {
 		certReq := new(certificateRequestMsgTLS13)
 		certReq.ocspStapling = true
 		certReq.scts = true
-		certReq.supportedSignatureAlgorithms = supportedSignatureAlgorithms()
+		certReq.supportedSignatureAlgorithms = supportedSignatureAlgorithms(c.vers)
+		certReq.supportedSignatureAlgorithmsCert = supportedSignatureAlgorithmsCert()
 		if c.config.ClientCAs != nil {
 			certReq.certificateAuthorities = c.config.ClientCAs.Subjects()
 		}
@@ -1095,7 +1096,9 @@ func (hs *serverHandshakeStateTLS13) readClientCertificate() error {
 		}
 
 		// See RFC 8446, Section 4.4.3.
-		if !isSupportedSignatureAlgorithm(certVerify.signatureAlgorithm, supportedSignatureAlgorithms()) {
+		// We don't use certReq.supportedSignatureAlgorithms because it would
+		// require keeping the certificateRequestMsgTLS13 around in the hs.
+		if !isSupportedSignatureAlgorithm(certVerify.signatureAlgorithm, supportedSignatureAlgorithms(c.vers)) {
 			c.sendAlert(alertIllegalParameter)
 			return errors.New("tls: client certificate used with invalid signature algorithm")
 		}
@@ -1104,8 +1107,7 @@ func (hs *serverHandshakeStateTLS13) readClientCertificate() error {
 			return c.sendAlert(alertInternalError)
 		}
 		if sigType == signaturePKCS1v15 || sigHash == crypto.SHA1 {
-			c.sendAlert(alertIllegalParameter)
-			return errors.New("tls: client certificate used with invalid signature algorithm")
+			return c.sendAlert(alertInternalError)
 		}
 		signed := signedMessage(sigHash, clientSignatureContext, hs.transcript)
 		if err := verifyHandshakeSignature(sigType, c.peerCertificates[0].PublicKey,
diff --git a/src/crypto/tls/quic_test.go b/src/crypto/tls/quic_test.go
index 1bb2e55bdd..ba75101dd5 100644
--- a/src/crypto/tls/quic_test.go
+++ b/src/crypto/tls/quic_test.go
@@ -278,7 +278,7 @@ func TestQUICPostHandshakeClientAuthentication(t *testing.T) {
 	certReq := new(certificateRequestMsgTLS13)
 	certReq.ocspStapling = true
 	certReq.scts = true
-	certReq.supportedSignatureAlgorithms = supportedSignatureAlgorithms()
+	certReq.supportedSignatureAlgorithms = supportedSignatureAlgorithms(VersionTLS13)
 	certReqBytes, err := certReq.marshal()
 	if err != nil {
 		t.Fatal(err)
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA
index b79aec6300..1a97323780 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 5d 02 00 00  59 03 01 58 ee cb 2c 2e  |....]...Y..X..,.|
-00000010  24 e7 e4 50 2b 4b 9c 0f  ab f5 79 c1 12 b6 89 e5  |$..P+K....y.....|
-00000020  83 41 06 cb 45 f6 66 e9  e1 d2 fe 20 95 fd 7f 15  |.A..E.f.... ....|
-00000030  44 4e 44 18 9b fc 16 a7  8a a4 d9 f7 ca 49 85 e8  |DND..........I..|
-00000040  00 ce 02 26 38 38 1b 8d  6d 16 f2 b8 c0 09 00 00  |...&88..m.......|
+00000000  16 03 01 00 5d 02 00 00  59 03 01 5f db 69 f3 84  |....]...Y.._.i..|
+00000010  2a 34 27 ec 75 af b4 38  e7 d4 ec 19 70 1a 17 0e  |*4'.u..8....p...|
+00000020  4d 94 8f 93 b7 88 ba cf  60 be e3 20 10 53 38 8a  |M.......`.. .S8.|
+00000030  85 c2 1b 7d e3 21 e2 a8  6b 9f 34 dc c1 a0 38 3e  |...}.!..k.4...8>|
+00000040  66 81 bb c4 1c b8 c5 70  ce 28 81 bf c0 09 00 00  |f......p.(......|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 01 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
 00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
@@ -56,20 +58,20 @@
 00000240  8c 25 c1 33 13 83 0d 94  06 bb d4 37 7a f6 ec 7a  |.%.3.......7z..z|
 00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
 00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
-00000270  95 12 07 8f 2a 16 03 01  00 b5 0c 00 00 b1 03 00  |....*...........|
-00000280  1d 20 b2 d4 b5 f1 3f 61  7d 07 30 8b fd 17 76 41  |. ....?a}.0...vA|
-00000290  12 c5 e1 25 f1 e9 ad 68  26 55 4b f5 60 16 b0 44  |...%...h&UK.`..D|
-000002a0  90 7a 00 8b 30 81 88 02  42 01 26 8b c1 0d 38 f2  |.z..0...B.&...8.|
-000002b0  0f 22 de fd 81 53 5b 5a  87 b6 57 23 33 22 06 8f  |."...S[Z..W#3"..|
-000002c0  8b 59 f1 70 85 46 41 f2  b7 0c 80 77 df 40 08 77  |.Y.p.FA....w.@.w|
-000002d0  e1 b8 21 7f 55 77 c7 b7  ef ef b5 31 ae a0 22 a8  |..!.Uw.....1..".|
-000002e0  d3 e0 67 e8 67 bc a9 cb  03 47 76 02 42 00 f4 7a  |..g.g....Gv.B..z|
-000002f0  eb 2f d0 82 d7 06 75 35  e4 61 fb cf 27 93 95 29  |./....u5.a..'..)|
-00000300  6e 2c b5 d4 01 45 5b b6  d9 72 e9 f9 13 a6 5f bd  |n,...E[..r...._.|
-00000310  24 76 3b 8e 48 7a ce 4f  f5 c2 77 75 66 2d 18 6d  |$v;.Hz.O..wuf-.m|
-00000320  7d 9e c7 95 0c fe 0b 80  15 67 b2 f2 f6 5a dd 16  |}........g...Z..|
-00000330  03 01 00 0a 0d 00 00 06  03 01 02 40 00 00 16 03  |...........@....|
-00000340  01 00 04 0e 00 00 00                              |.......|
+00000270  95 12 07 8f 2a 16 03 01  00 b4 0c 00 00 b0 03 00  |....*...........|
+00000280  1d 20 07 a5 80 41 74 22  47 af 5d 75 5e ae bd eb  |. ...At"G.]u^...|
+00000290  20 93 4c d3 d1 c6 d0 4b  f8 68 f4 58 fc 88 ca 2a  | .L....K.h.X...*|
+000002a0  8b 08 00 8a 30 81 87 02  41 68 37 4f 22 15 13 23  |....0...Ah7O"..#|
+000002b0  1b 03 6b f2 e1 8b bf 2a  88 4b 14 b3 85 58 ae 5a  |..k....*.K...X.Z|
+000002c0  11 14 9a a3 24 77 c6 a3  a2 8c 12 ae 5c 78 ec 26  |....$w......\x.&|
+000002d0  24 49 b0 57 30 4e 46 71  5b a8 c4 3f 26 09 85 14  |$I.W0NFq[..?&...|
+000002e0  48 3a 8c 4b bf c9 c0 24  1b c1 02 42 01 e1 92 35  |H:.K...$...B...5|
+000002f0  a7 1f 8e ae 3d 3d 0d 89  cc 94 a9 e5 1a 27 6b c1  |....==.......'k.|
+00000300  89 f8 8a 4c ad 8e 84 6f  65 e9 19 ce 99 73 10 4e  |...L...oe....s.N|
+00000310  61 2a 31 19 60 bd ac 37  20 9f 54 90 a5 e2 3a 79  |a*1.`..7 .T...:y|
+00000320  98 a4 1a b4 30 2b 9f 08  86 41 ac f1 4e d7 16 03  |....0+...A..N...|
+00000330  01 00 0a 0d 00 00 06 03  01 02 40 00 00 16 03 01  |..........@.....|
+00000340  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
 00000000  16 03 01 02 0a 0b 00 02  06 00 02 03 00 02 00 30  |...............0|
 00000010  82 01 fc 30 82 01 5e 02  09 00 9a 30 84 6c 26 35  |...0..^....0.l&5|
@@ -106,30 +108,30 @@
 00000200  e4 fa cc b1 8a ce e2 23  a0 87 f0 e1 67 51 eb 16  |.......#....gQ..|
 00000210  03 01 00 25 10 00 00 21  20 2f e5 7d a3 47 cd 62  |...%...! /.}.G.b|
 00000220  43 15 28 da ac 5f bb 29  07 30 ff f6 84 af c4 cf  |C.(.._.).0......|
-00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 01 00 91 0f 00  |...._X.;t.......|
-00000240  00 8d 00 8b 30 81 88 02  42 01 87 b2 c8 53 94 c3  |....0...B....S..|
-00000250  9f ea 8a 04 35 1e 53 fb  c0 db c5 43 e8 99 b7 81  |....5.S....C....|
-00000260  43 fd 47 fd a6 cd 89 b5  0a b9 d0 5d 79 b0 c2 1a  |C.G........]y...|
-00000270  94 1f d8 2e 2b 8d 23 2a  c8 08 63 98 f6 01 1f 8f  |....+.#*..c.....|
-00000280  67 60 3a 88 44 63 7e 8b  91 3e 48 02 42 00 e1 1f  |g`:.Dc~..>H.B...|
-00000290  69 9a 97 bb b6 e9 97 4d  f5 f5 d7 23 56 be 1d ff  |i......M...#V...|
-000002a0  f0 22 67 8d a3 a1 13 33  5b f7 0b c2 a3 c8 5a 8c  |."g....3[.....Z.|
-000002b0  e8 65 b8 a8 7e 6c 99 11  db ab bd 80 0a ca dd 5a  |.e..~l.........Z|
-000002c0  d4 e0 28 12 38 7a b4 86  e7 3e 13 05 a1 3f 5f 14  |..(.8z...>...?_.|
-000002d0  03 01 00 01 01 16 03 01  00 30 9a fa ce 11 0b 50  |.........0.....P|
-000002e0  fa a1 59 9b 89 41 a9 0b  1b 74 dd 8f 7b a9 e0 39  |..Y..A...t..{..9|
-000002f0  5d e3 cc ee 11 f4 27 15  bc 4c 8f e1 2c 51 ec 8e  |].....'..L..,Q..|
-00000300  ed 6c 97 75 4c e9 da fb  68 9d                    |.l.uL...h.|
+00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 01 00 8f 0f 00  |...._X.;t.......|
+00000240  00 8b 00 89 30 81 86 02  41 7c e1 65 0a 33 fc 66  |....0...A|.e.3.f|
+00000250  85 e8 a7 9d a8 e0 12 1e  8c fa 53 00 2a 1b 70 dc  |..........S.*.p.|
+00000260  00 ba 15 e9 b2 fa 95 b1  c2 36 b6 a4 dd 4c 6c c2  |.........6...Ll.|
+00000270  d9 11 cb 12 90 c2 1e ea  7f 4c e4 94 3a a4 c6 ba  |.........L..:...|
+00000280  66 3d b9 fa 3a af 0b 74  e5 1e 02 41 30 b2 11 4f  |f=..:..t...A0..O|
+00000290  f5 06 97 76 2d c9 7c 95  df 44 ba fe 81 2d f4 3f  |...v-.|..D...-.?|
+000002a0  e0 25 81 16 90 80 60 7b  bd 88 14 b3 a4 ef 63 21  |.%....`{......c!|
+000002b0  46 0c 15 a3 bd 1a 4d 3d  fd a2 d7 3a ff bd 15 94  |F.....M=...:....|
+000002c0  40 60 d8 42 14 41 18 7e  55 ab 71 a7 9c 14 03 01  |@`.B.A.~U.q.....|
+000002d0  00 01 01 16 03 01 00 30  3d 4f 1e dd 66 64 5a c2  |.......0=O..fdZ.|
+000002e0  bc 12 e9 63 d8 95 34 7c  6c 93 66 c6 12 54 5c d0  |...c..4|l.f..T\.|
+000002f0  2b 2a 7e 20 4f fc 62 19  5d be 55 1f 82 8a 6c 9b  |+*~ O.b.].U...l.|
+00000300  85 7c b8 db 29 65 d7 7b                           |.|..)e.{|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 12 06 0c 4d 1c  |..........0...M.|
-00000010  81 47 06 5f b9 85 68 60  9c 26 4a 14 f2 40 60 7f  |.G._..h`.&J..@`.|
-00000020  d1 1e 51 9e f2 70 2f be  54 cb 42 b3 b3 8d 90 9c  |..Q..p/.T.B.....|
-00000030  9d d2 0d e2 f7 b6 56 31  11 af 5f                 |......V1.._|
+00000000  14 03 01 00 01 01 16 03  01 00 30 1c 42 dd c3 b4  |..........0.B...|
+00000010  9e e8 53 fa 2f 12 1c 80  89 97 ec 99 aa 75 04 e4  |..S./........u..|
+00000020  19 b9 7f 7f e5 61 53 8e  3f a5 1d 1a cb 02 8a 7a  |.....aS.?......z|
+00000030  f3 26 77 2d a0 23 c5 41  e1 fe 5c                 |.&w-.#.A..\|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 0f d0 65  cd d4 59 d0 9e 07 06 6d  |.... ..e..Y....m|
-00000010  8a 11 34 d9 3a 31 59 70  02 39 08 ef 28 98 36 2f  |..4.:1Yp.9..(.6/|
-00000020  0d 5b d0 23 3f 17 03 01  00 20 5b 16 82 9c 29 c6  |.[.#?.... [...).|
-00000030  78 34 76 09 5e bb 01 5e  fc 01 b2 55 9b ef 67 a8  |x4v.^..^...U..g.|
-00000040  ca 9f b9 6d b5 ea 87 48  8e 76 15 03 01 00 20 43  |...m...H.v.... C|
-00000050  12 3b f6 99 31 67 d8 8a  94 d1 37 ef 01 ca a1 62  |.;..1g....7....b|
-00000060  9f d7 2a eb 7e 37 79 d9  a4 07 15 5f fb 84 32     |..*.~7y...._..2|
+00000000  17 03 01 00 20 6f 19 91  24 21 15 50 56 db 29 4f  |.... o..$!.PV.)O|
+00000010  0c e5 d7 85 02 7b dc 76  4f ac ac a1 7d d3 02 07  |.....{.vO...}...|
+00000020  ca c2 1d e0 f5 17 03 01  00 20 f2 f4 da dc e9 c7  |......... ......|
+00000030  c3 60 af d9 7e a4 5f be  80 1d fe a1 ef 98 22 dd  |.`..~._.......".|
+00000040  8f 93 06 22 c3 a2 b1 ed  48 5e 15 03 01 00 20 6b  |..."....H^.... k|
+00000050  2b 7e 37 08 37 21 4e 80  6f 10 e8 d9 30 56 22 aa  |+~7.7!N.o...0V".|
+00000060  f6 c7 fe 33 69 b6 12 f1  11 83 14 12 b5 73 35     |...3i........s5|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA
index b02fe3d25b..a63734b648 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 5d 02 00 00  59 03 01 0b 4b bc a9 e8  |....]...Y...K...|
-00000010  4a 08 69 de 73 f8 fc 53  c6 e9 cd cf 25 7a 5f b6  |J.i.s..S....%z_.|
-00000020  60 48 65 3e f5 5f 9f 14  e7 38 a0 20 ec fe 94 b2  |`He>._...8. ....|
-00000030  6d a9 d7 91 c4 92 6b 3e  a4 2e 88 72 07 c3 47 12  |m.....k>...r..G.|
-00000040  78 cc 45 86 f9 56 16 f9  d7 d9 38 c2 c0 13 00 00  |x.E..V....8.....|
+00000000  16 03 01 00 5d 02 00 00  59 03 01 f6 fc 17 31 02  |....]...Y.....1.|
+00000010  7c 2a e4 6d 3a e7 ae a0  d9 a5 4e 59 88 a6 9c 09  ||*.m:.....NY....|
+00000020  ed 6b a1 6d fb 80 03 72  14 63 93 20 47 4b 39 ed  |.k.m...r.c. GK9.|
+00000030  48 93 f6 9e 80 e0 2a d7  75 30 81 47 b6 94 7a 75  |H.....*.u0.G..zu|
+00000040  1d 29 1f 4a fc 69 5f 92  7f d4 5f dc c0 13 00 00  |.).J.i_..._.....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 01 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -61,17 +63,17 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 01 00 aa 0c 00 00  a6 03 00 1d 20 fc 77 2f  |............ .w/|
-000002d0  88 9a a9 71 3a 14 bf 27  27 40 e0 28 ce e8 e8 3b  |...q:..''@.(...;|
-000002e0  cd 0a 43 21 75 c9 93 70  9a 22 f1 ec 3a 00 80 d2  |..C!u..p."..:...|
-000002f0  cd 71 ae f6 d8 54 5c f3  a4 da c7 64 51 b8 36 b8  |.q...T\....dQ.6.|
-00000300  46 d5 8c b1 a0 43 9b f2  b5 2c 12 89 08 39 2b c3  |F....C...,...9+.|
-00000310  79 4e 5d 3d 7e 7f d5 51  c3 c5 1e 9e 3b 7c 39 c4  |yN]=~..Q....;|9.|
-00000320  c3 64 52 91 94 2f 2c ee  aa 7c 0e ed fd 7a 65 bb  |.dR../,..|...ze.|
-00000330  5a 62 f4 45 24 3d e7 e3  f2 8a 72 74 a7 9d f2 d5  |Zb.E$=....rt....|
-00000340  69 be dc 6e 23 fb 68 bb  6e 64 9e 43 a8 f4 08 2b  |i..n#.h.nd.C...+|
-00000350  86 be ea 88 40 13 5f 3f  0b 18 74 e3 43 76 be 98  |....@._?..t.Cv..|
-00000360  b8 15 ea 4d cb 6e 23 3c  8b a9 ce d4 6a e3 13 16  |...M.n#<....j...|
+000002c0  16 03 01 00 aa 0c 00 00  a6 03 00 1d 20 2b b0 b2  |............ +..|
+000002d0  f5 17 4b 53 12 c2 b0 12  dc 16 c3 ff 62 b4 18 d9  |..KS........b...|
+000002e0  7f 1a ef e5 a8 b2 98 ea  aa a7 4f 61 01 00 80 2a  |..........Oa...*|
+000002f0  20 54 cc 3b a3 8e f5 db  04 fa 09 7b b1 bf 8a 79  | T.;.......{...y|
+00000300  25 e9 7b 5f 13 0a 3a 23  32 c9 60 90 7c 02 0e 7d  |%.{_..:#2.`.|..}|
+00000310  7f 88 8f 79 73 f7 c8 7c  fe c6 88 d1 d2 c8 88 53  |...ys..|.......S|
+00000320  0f c4 f9 e3 61 28 9d 56  f3 84 eb 88 99 b6 8e a9  |....a(.V........|
+00000330  e4 72 ec 01 a3 81 61 97  45 ab 90 cd 2a 50 a4 68  |.r....a.E...*P.h|
+00000340  35 09 9f d8 99 54 bd 9f  af 6e 63 77 2b 00 a1 e3  |5....T...ncw+...|
+00000350  d6 f8 ab 08 39 3f df 42  55 4c f7 58 69 e8 db 76  |....9?.BUL.Xi..v|
+00000360  43 24 37 5b 65 2c 17 80  c9 c1 50 ba 76 06 71 16  |C$7[e,....P.v.q.|
 00000370  03 01 00 0a 0d 00 00 06  03 01 02 40 00 00 16 03  |...........@....|
 00000380  01 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
@@ -111,29 +113,29 @@
 00000210  03 01 00 25 10 00 00 21  20 2f e5 7d a3 47 cd 62  |...%...! /.}.G.b|
 00000220  43 15 28 da ac 5f bb 29  07 30 ff f6 84 af c4 cf  |C.(.._.).0......|
 00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 01 00 90 0f 00  |...._X.;t.......|
-00000240  00 8c 00 8a 30 81 87 02  41 2c f8 d2 c2 28 75 28  |....0...A,...(u(|
-00000250  67 de 75 fb 7a 09 20 8a  ec 06 a6 42 03 ad 3c 95  |g.u.z. ....B..<.|
-00000260  bb 00 f6 10 71 c7 90 fe  08 16 fa ed 7d 71 24 a2  |....q.......}q$.|
-00000270  b6 76 ce f9 1b ff a9 ff  05 b6 dd d8 63 2b 74 86  |.v..........c+t.|
-00000280  65 f5 ef f7 36 41 47 77  b5 88 02 42 00 8a 80 f8  |e...6AGw...B....|
-00000290  9b cf de a6 b7 c3 d8 48  a1 a0 47 7e cf 33 fc f7  |.......H..G~.3..|
-000002a0  fc 87 40 cf 8d c3 81 85  c7 19 9e 37 9e 54 f7 3e  |..@........7.T.>|
-000002b0  d1 1c 42 83 21 d7 2e ae  02 7b 3c ce 97 f3 9b a0  |..B.!....{<.....|
-000002c0  a3 4e b9 a0 9c 78 f0 7e  9c 96 fc 78 e6 08 14 03  |.N...x.~...x....|
-000002d0  01 00 01 01 16 03 01 00  30 84 a0 4f 8d 01 40 ca  |........0..O..@.|
-000002e0  c0 fd ea 1a 9c df 27 cc  25 00 56 e2 30 05 c0 d9  |......'.%.V.0...|
-000002f0  c7 21 48 37 6b 35 c3 a4  4e bf 67 98 87 78 0f 3c  |.!H7k5..N.g..x.<|
-00000300  74 72 4f 6a c5 0d fd 0c  84                       |trOj.....|
+00000240  00 8c 00 8a 30 81 87 02  41 0d b5 15 00 c4 b1 af  |....0...A.......|
+00000250  33 ea 88 c2 cc 9a 1c 16  3d a0 15 bf 20 ef b2 28  |3.......=... ..(|
+00000260  de 8b 36 b4 3a 2f df 8b  b4 7e 3b a4 ad c1 04 32  |..6.:/...~;....2|
+00000270  56 6c 8f 07 ab 3c dc d7  6f 66 41 96 bc 74 e9 4a  |Vl...<..ofA..t.J|
+00000280  55 00 c4 32 df 22 26 6b  98 0d 02 42 01 67 6e 97  |U..2."&k...B.gn.|
+00000290  8b 55 e8 57 74 d8 2e c5  a4 25 1a b6 08 a5 b1 f0  |.U.Wt....%......|
+000002a0  99 26 9c 24 b3 02 82 55  0d d9 3a 13 55 f1 cb cc  |.&.$...U..:.U...|
+000002b0  84 fd b7 5d 82 dd 26 d4  c6 4c 4a 27 ae 08 e7 57  |...]..&..LJ'...W|
+000002c0  74 a3 91 b9 6c f6 50 bb  d9 34 e5 4b c2 66 14 03  |t...l.P..4.K.f..|
+000002d0  01 00 01 01 16 03 01 00  30 be 86 48 b8 3d f0 1e  |........0..H.=..|
+000002e0  b7 58 d4 b6 54 88 b4 57  1d 7d 5c 3f 17 ff 41 6f  |.X..T..W.}\?..Ao|
+000002f0  a4 60 57 21 86 bb 77 d9  dd af 96 fb eb c8 b0 86  |.`W!..w.........|
+00000300  18 e2 00 4a 1b 92 67 75  5a                       |...J..guZ|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 01 da 6e 2a 83  |..........0..n*.|
-00000010  20 ad 52 16 f2 c6 c1 55  b8 77 0d 5f c6 48 dc e7  | .R....U.w._.H..|
-00000020  72 29 88 0a 2b 1a d1 1e  fd fb c0 c3 18 c8 43 47  |r)..+.........CG|
-00000030  a9 8f d3 fe f3 d8 d2 a8  ce 79 44                 |.........yD|
+00000000  14 03 01 00 01 01 16 03  01 00 30 81 55 c5 00 ab  |..........0.U...|
+00000010  7e 16 3e 35 25 2a 86 0d  bf 69 17 1f e7 13 fd 6c  |~.>5%*...i.....l|
+00000020  a7 3e 63 e6 23 57 1e 63  ca 1f 1a ea 76 df c1 9e  |.>c.#W.c....v...|
+00000030  c9 ee fc 23 8a ec e0 e9  78 38 cb                 |...#....x8.|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 e5 74 9a  b9 0b 6c 43 0f 4e db e4  |.... .t...lC.N..|
-00000010  ba 10 5d 9a f0 96 16 17  ad a5 42 d8 0d a3 39 86  |..].......B...9.|
-00000020  6c f0 8a 64 70 17 03 01  00 20 d2 11 27 ea f2 80  |l..dp.... ..'...|
-00000030  a5 5d ba 7b 99 4b 94 25  13 24 29 05 7b 64 00 51  |.].{.K.%.$).{d.Q|
-00000040  14 8e d5 e9 e2 c0 5d 98  96 30 15 03 01 00 20 7e  |......]..0.... ~|
-00000050  87 d2 6c 5c b5 1c 11 72  e1 c4 e5 e0 f3 16 6b db  |..l\...r......k.|
-00000060  55 c3 c7 ae a9 38 d3 07  04 41 be c5 42 43 a4     |U....8...A..BC.|
+00000000  17 03 01 00 20 6f 5c 74  f2 48 38 66 86 fe 54 d9  |.... o\t.H8f..T.|
+00000010  69 ec a9 91 d4 4d 07 98  7d df 19 1f fd ec c2 d5  |i....M..}.......|
+00000020  b5 49 a7 0a 05 17 03 01  00 20 62 0d 0e 63 82 cf  |.I....... b..c..|
+00000030  74 e1 eb dd 2f 4f 05 92  7a 08 34 ff 84 6e 13 7f  |t.../O..z.4..n..|
+00000040  21 cb f6 92 c4 d1 4d 49  31 9f 15 03 01 00 20 f1  |!.....MI1..... .|
+00000050  53 aa 8e 29 2c 58 3a 9b  c3 a1 dc 85 ce d1 70 c3  |S..),X:.......p.|
+00000060  06 53 1d 66 4d 51 a5 33  4c 53 41 e8 ac 1b 10     |.S.fMQ.3LSA....|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA
index ac8a0ebad3..8f1ff3f1d3 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 5d 02 00 00  59 03 01 6f 48 26 41 da  |....]...Y..oH&A.|
-00000010  73 82 d1 cf 84 ad 06 e9  76 39 dc e4 c8 34 af 53  |s.......v9...4.S|
-00000020  06 ed ed 68 56 5f 76 11  4e f6 ff 20 55 fd 29 c5  |...hV_v.N.. U.).|
-00000030  aa 56 af bd 5d 67 74 4f  08 8a 52 a1 7e cd b9 ac  |.V..]gtO..R.~...|
-00000040  31 a0 2f 45 25 1f b2 24  71 26 80 17 c0 09 00 00  |1./E%..$q&......|
+00000000  16 03 01 00 5d 02 00 00  59 03 01 79 7e 8c 72 46  |....]...Y..y~.rF|
+00000010  e6 1a d5 db 83 07 37 34  cf f5 84 39 87 af 5f 23  |......74...9.._#|
+00000020  47 f9 e2 9d c0 76 e8 6a  7e 88 9c 20 a3 c7 5b 94  |G....v.j~.. ..[.|
+00000030  8f 63 f2 ac 89 b5 ed ee  e0 8f 87 be 2a 3e f1 6c  |.c..........*>.l|
+00000040  2f ca cc d0 ee 22 4c a9  ed 03 5e 18 c0 09 00 00  |/...."L...^.....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 01 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
 00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
@@ -57,17 +59,17 @@
 00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
 00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
 00000270  95 12 07 8f 2a 16 03 01  00 b3 0c 00 00 af 03 00  |....*...........|
-00000280  1d 20 51 4c 6f eb 08 70  52 20 15 78 d3 f8 65 5e  |. QLo..pR .x..e^|
-00000290  0f 59 03 b7 d1 0e e9 7e  be 42 d2 cd f3 57 c6 24  |.Y.....~.B...W.$|
-000002a0  6b 2c 00 89 30 81 86 02  41 7b 1b ec 11 08 f4 8f  |k,..0...A{......|
-000002b0  db 2c c5 1b 33 b2 b0 b4  da 76 b9 a7 78 ed ee 0e  |.,..3....v..x...|
-000002c0  23 5c 4b b0 10 6e 41 12  b9 d4 68 c1 15 ea 70 0a  |#\K..nA...h...p.|
-000002d0  0c 91 c1 8d 4a 4d 41 c1  c3 25 f1 90 ef 95 f3 e1  |....JMA..%......|
-000002e0  a8 30 4d ce 4d d1 eb 8c  cf 9a 02 41 09 e0 8c 8e  |.0M.M......A....|
-000002f0  70 01 f1 5d b2 8a d1 61  bc 86 f4 85 2f 6c ac 2c  |p..]...a..../l.,|
-00000300  e8 bf 20 c7 81 46 21 6e  9b bd c1 83 71 34 8d 65  |.. ..F!n....q4.e|
-00000310  fc 35 07 be c8 ad d4 3a  c6 7b 40 1c f7 17 e3 d9  |.5.....:.{@.....|
-00000320  96 19 d4 cd 0d d0 8c 4f  b2 09 6a 4b 05 16 03 01  |.......O..jK....|
+00000280  1d 20 37 50 ab 46 a8 24  be 20 fd 71 c2 8d 91 a0  |. 7P.F.$. .q....|
+00000290  88 88 0b 18 f5 ec 43 99  cb 63 45 9c ad b4 27 20  |......C..cE...' |
+000002a0  0d 11 00 89 30 81 86 02  41 35 1d fa 6c 1b a1 b4  |....0...A5..l...|
+000002b0  bc 5f 4d a6 77 64 8d e1  92 94 97 53 c5 01 c2 bb  |._M.wd.....S....|
+000002c0  5c 83 f0 c2 6d 6d d1 1f  ff 7a 00 06 4a a0 de c0  |\...mm...z..J...|
+000002d0  aa a1 9f 6d f6 62 20 d0  08 1e 5b bc 1d af 03 45  |...m.b ...[....E|
+000002e0  d5 70 8b ee d8 a8 ff 3e  2b 7d 02 41 28 ff 3e 45  |.p.....>+}.A(.>E|
+000002f0  7f ec c1 87 df dd 14 8b  64 08 84 02 2b de ff 14  |........d...+...|
+00000300  b9 6f 54 72 b1 a2 99 47  55 2d 76 91 77 ba 4f db  |.oTr...GU-v.w.O.|
+00000310  a3 4c ab 21 62 48 3a 8d  f7 32 57 12 dc 6c a9 51  |.L.!bH:..2W..l.Q|
+00000320  77 cc b3 30 1f e9 41 bf  0b b3 4b a5 e4 16 03 01  |w..0..A...K.....|
 00000330  00 0a 0d 00 00 06 03 01  02 40 00 00 16 03 01 00  |.........@......|
 00000340  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
@@ -106,29 +108,29 @@
 00000200  e5 35 16 03 01 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
 00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 01 00  |......._X.;t....|
-00000230  86 0f 00 00 82 00 80 59  18 58 aa 18 70 84 a3 26  |.......Y.X..p..&|
-00000240  8c 1d 77 52 a7 2d 00 e5  00 dc 24 1c f6 9b 9f 63  |..wR.-....$....c|
-00000250  c8 84 8b dc e7 61 78 9c  28 0d 4c 3a 1e 5f a7 ce  |.....ax.(.L:._..|
-00000260  35 17 1c b1 de e0 01 32  35 6f 85 59 22 73 50 2a  |5......25o.Y"sP*|
-00000270  36 df 39 0c c8 c1 45 70  a2 e4 53 bb de e6 0e 6a  |6.9...Ep..S....j|
-00000280  fd 45 8e 4d eb 1f de 86  d3 fb 94 e4 8d 22 cd 30  |.E.M.........".0|
-00000290  e7 29 de 65 f0 2a cd b8  3d b5 be 91 a3 7d 3b 30  |.).e.*..=....};0|
-000002a0  1a a5 63 bd 84 1f 95 19  d1 fe 25 40 b8 8f ab 96  |..c.......%@....|
-000002b0  59 42 e6 31 93 c0 39 14  03 01 00 01 01 16 03 01  |YB.1..9.........|
-000002c0  00 30 a9 f7 c0 97 f4 b8  06 65 a6 7c fb 80 a1 79  |.0.......e.|...y|
-000002d0  5f 44 72 55 13 d1 ca e3  9a 91 5d 1e 08 93 6d b5  |_DrU......]...m.|
-000002e0  1c 5e 52 24 b1 ec db aa  3b bc fe db 18 0b 18 fe  |.^R$....;.......|
-000002f0  51 6a                                             |Qj|
+00000230  86 0f 00 00 82 00 80 22  5d 5b 59 98 4a a8 53 6b  |......."][Y.J.Sk|
+00000240  78 1d 8f 51 a1 23 6a 87  fb 9d 79 5c 63 9d dc 61  |x..Q.#j...y\c..a|
+00000250  13 9f a1 36 f9 fa ec a0  6f 47 11 d6 7c 8f a4 81  |...6....oG..|...|
+00000260  fb f1 31 59 11 6c 8e 83  1c 56 3b 03 b4 a9 e0 09  |..1Y.l...V;.....|
+00000270  aa 04 c4 d1 7a c5 28 03  ae ce fe a0 95 1b 8c 5c  |....z.(........\|
+00000280  65 32 ca f0 d5 43 fc 9b  e0 8e ca 80 f3 e0 5f 8d  |e2...C........_.|
+00000290  6d 91 ff f2 4b 7b a7 38  64 dd e8 a8 d8 1f 95 31  |m...K{.8d......1|
+000002a0  04 a9 6c 72 45 9c 0d a3  80 60 8e 20 8a af f7 ae  |..lrE....`. ....|
+000002b0  87 10 26 51 0e a5 e8 14  03 01 00 01 01 16 03 01  |..&Q............|
+000002c0  00 30 46 9b a2 75 16 a9  c2 ac d7 47 ca 41 48 bd  |.0F..u.....G.AH.|
+000002d0  2c 3d 56 e3 a4 21 a6 c0  d8 71 6d fb 4a c6 9a a1  |,=V..!...qm.J...|
+000002e0  88 db a5 70 58 e0 e3 5a  c7 62 d1 d4 0f 4b c6 55  |...pX..Z.b...K.U|
+000002f0  0c aa                                             |..|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 e6 36 50 e7 a3  |..........0.6P..|
-00000010  72 0a 6a 9f 18 17 91 51  ad 48 19 54 c8 6b c0 45  |r.j....Q.H.T.k.E|
-00000020  d5 9b cb 08 34 d3 3a 73  74 04 3a 3d 24 b0 95 48  |....4.:st.:=$..H|
-00000030  97 9e c5 83 4f 20 29 c8  dd 93 6c                 |....O )...l|
+00000000  14 03 01 00 01 01 16 03  01 00 30 6b ab 63 56 79  |..........0k.cVy|
+00000010  32 ef f9 df c5 36 29 50  f5 1d 55 c2 4b 84 f5 68  |2....6)P..U.K..h|
+00000020  b0 d8 7d 7d 80 24 e2 5d  b9 0f 66 25 4e 50 21 08  |..}}.$.]..f%NP!.|
+00000030  a3 15 de 0e 04 ef 86 d6  04 2e 9b                 |...........|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 58 a1 0a  68 2c 04 68 7d e9 13 ce  |.... X..h,.h}...|
-00000010  69 4b 53 4a f6 fc e0 c8  0e 05 ad 19 d8 b3 37 67  |iKSJ..........7g|
-00000020  f2 1f 3b 33 62 17 03 01  00 20 c2 e7 d3 d2 38 ba  |..;3b.... ....8.|
-00000030  27 13 ed d1 73 fc 9b f5  4f 61 f0 35 27 8e 54 52  |'...s...Oa.5'.TR|
-00000040  b7 ce bd 6a 05 c6 61 95  1e 8a 15 03 01 00 20 6e  |...j..a....... n|
-00000050  07 21 86 31 f8 74 6b 45  4d 10 2f 5d e7 2b 64 77  |.!.1.tkEM./].+dw|
-00000060  a9 7f 1e 49 ed d5 d4 1e  2e f2 b1 c5 4d 02 46     |...I........M.F|
+00000000  17 03 01 00 20 86 3b 02  a4 5c 33 eb 57 cc 42 71  |.... .;..\3.W.Bq|
+00000010  32 81 56 00 4a b0 3b 7e  ed cd ab d9 76 2b 12 97  |2.V.J.;~....v+..|
+00000020  d6 be 22 cc 02 17 03 01  00 20 e7 53 2a b7 18 a7  |.."...... .S*...|
+00000030  6f 65 ef 20 9d 38 be 3c  f0 6c 4e 5d e9 cc ac 8c  |oe. .8.<.lN]....|
+00000040  57 7d 61 c6 23 d8 bb d4  97 15 15 03 01 00 20 c9  |W}a.#......... .|
+00000050  c1 b2 03 2b b0 a4 cb 4b  65 31 46 c4 6c e4 12 70  |...+...Ke1F.l..p|
+00000060  0e eb e8 a0 d2 1c ca 2d  4f 87 f0 16 e9 23 b0     |.......-O....#.|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA
index 48eb1ce641..2ad78c7043 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 5d 02 00 00  59 03 01 24 71 03 c6 1d  |....]...Y..$q...|
-00000010  d4 f5 09 b2 3c d8 88 51  57 4c 90 07 4b 74 fe 1d  |....<..QWL..Kt..|
-00000020  c9 7f 00 78 9b a3 b2 1b  ef 43 66 20 07 97 7c a6  |...x.....Cf ..|.|
-00000030  9b c6 a9 47 42 ae 99 bf  59 fe 52 f6 da d9 1c 68  |...GB...Y.R....h|
-00000040  c2 7a 53 3f 27 0d 11 87  9a 47 81 5c c0 13 00 00  |.zS?'....G.\....|
+00000000  16 03 01 00 5d 02 00 00  59 03 01 26 fc 57 68 fc  |....]...Y..&.Wh.|
+00000010  0d a6 0d 31 5f 98 77 d2  5d 19 e1 35 55 0e 2b d1  |...1_.w.]..5U.+.|
+00000020  08 a0 f2 23 b8 8a 4a 71  58 f5 26 20 23 a6 28 5f  |...#..JqX.& #.(_|
+00000030  5b 57 e9 7d c9 14 a1 ec  75 33 8d 42 ce 0e 3e fc  |[W.}....u3.B..>.|
+00000040  0a d6 12 ef 3e f7 7b 15  8e aa 04 4a c0 13 00 00  |....>.{....J....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 01 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -61,17 +63,17 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 01 00 aa 0c 00 00  a6 03 00 1d 20 ad a7 d5  |............ ...|
-000002d0  fc 63 e1 22 f8 1f 8d ad  50 09 1a 92 a4 57 ea 88  |.c."....P....W..|
-000002e0  6d 9c 20 70 f1 8b 85 15  ec 8e b2 b3 07 00 80 b1  |m. p............|
-000002f0  03 03 a7 cf 8f 73 e2 a3  29 0d 55 4a 06 72 db e5  |.....s..).UJ.r..|
-00000300  65 41 44 49 05 1c 37 17  1c 02 6e b1 f4 e8 a9 bb  |eADI..7...n.....|
-00000310  00 24 3e 3a 3c d6 1c f6  dd 21 a4 e3 61 b0 1d 2e  |.$>:<....!..a...|
-00000320  77 11 53 51 4d 49 1e 07  bf 07 61 d1 54 f4 c7 24  |w.SQMI....a.T..$|
-00000330  4f 7d 5c 5a fb 84 c0 9d  0e 52 12 b6 40 72 37 fd  |O}\Z.....R..@r7.|
-00000340  8c bd d0 8a b1 9e 2c 18  bc 04 a3 c2 90 a3 33 4c  |......,.......3L|
-00000350  06 7c 14 a8 73 7d d2 23  30 f9 31 12 56 31 60 19  |.|..s}.#0.1.V1`.|
-00000360  d1 0d 31 c1 3c 25 66 62  5c 9b 13 5e 34 c6 69 16  |..1.<%fb\..^4.i.|
+000002c0  16 03 01 00 aa 0c 00 00  a6 03 00 1d 20 eb d9 23  |............ ..#|
+000002d0  5f 21 7f ab f2 ae b4 9a  c8 06 2c 2a b4 01 50 5b  |_!........,*..P[|
+000002e0  7e 57 e6 7f 03 ac 36 9f  b7 f7 2f fa 5a 00 80 7e  |~W....6.../.Z..~|
+000002f0  74 f4 01 6e cd eb f6 d9  13 72 57 57 f5 2f 8d a7  |t..n.....rWW./..|
+00000300  5a 39 7b 93 ff b1 56 98  b9 72 02 44 e9 de 4f c1  |Z9{...V..r.D..O.|
+00000310  6a 7d 6f 43 73 a8 53 91  0a 82 de 66 21 22 65 f0  |j}oCs.S....f!"e.|
+00000320  31 ff e4 e8 bc 80 7a 79  23 d1 3d b8 a5 be ff 3b  |1.....zy#.=....;|
+00000330  fc 6c f1 45 4e 59 50 29  cd 35 d3 d4 93 eb 1f 65  |.l.ENYP).5.....e|
+00000340  56 b1 e8 5f 35 a8 a6 8a  2b 02 4a 84 33 5b ff 01  |V.._5...+.J.3[..|
+00000350  d0 d1 d5 17 6c 30 e9 ce  03 cc 7c 28 25 50 0c cd  |....l0....|(%P..|
+00000360  74 55 3e cf 3f dc 9c 80  19 35 f5 36 e5 ca 9a 16  |tU>.?....5.6....|
 00000370  03 01 00 0a 0d 00 00 06  03 01 02 40 00 00 16 03  |...........@....|
 00000380  01 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
@@ -110,29 +112,29 @@
 00000200  e5 35 16 03 01 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
 00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 01 00  |......._X.;t....|
-00000230  86 0f 00 00 82 00 80 59  e2 7d 00 66 f0 59 a0 19  |.......Y.}.f.Y..|
-00000240  b6 4f 26 80 ad 31 b4 b3  c2 56 af 84 bf 88 15 7f  |.O&..1...V......|
-00000250  dc 29 fc 51 f2 cf 0d ec  52 46 c5 c5 cd 24 c1 93  |.).Q....RF...$..|
-00000260  5b f6 06 09 ad bb 9a 4a  ae 5d ec 57 f8 96 a8 b1  |[......J.].W....|
-00000270  4b 81 45 7d 34 38 59 ea  76 47 76 1c 7f 7b 68 e9  |K.E}48Y.vGv..{h.|
-00000280  89 7b 5d 4c b9 bc 5a 26  e1 f7 6c 42 f7 c6 6d bb  |.{]L..Z&..lB..m.|
-00000290  c0 c7 bd f6 5e 9e 51 d8  30 ec 9f da 56 0a b7 2a  |....^.Q.0...V..*|
-000002a0  6c 5e 50 d1 74 48 70 4a  88 62 16 a1 ba f2 01 e5  |l^P.tHpJ.b......|
-000002b0  00 b6 eb cb e3 18 cf 14  03 01 00 01 01 16 03 01  |................|
-000002c0  00 30 61 51 84 02 46 3c  10 62 b5 2a a2 8b 4e 2d  |.0aQ..F<.b.*..N-|
-000002d0  57 55 26 c5 46 f2 5d a1  f5 20 46 0d 63 fd 48 5a  |WU&.F.].. F.c.HZ|
-000002e0  f3 65 90 8c 1a bd 59 6e  5f d1 5c b6 ee 33 49 12  |.e....Yn_.\..3I.|
-000002f0  46 ec                                             |F.|
+00000230  86 0f 00 00 82 00 80 8b  21 19 8e 69 f9 f2 da 9b  |........!..i....|
+00000240  58 ce 21 ce 77 f1 c4 50  be 04 63 bc 30 ac 9e 32  |X.!.w..P..c.0..2|
+00000250  f0 43 31 36 8a 87 f9 8a  3a f8 00 48 04 07 ad e0  |.C16....:..H....|
+00000260  0d 57 d6 74 86 70 6e 30  74 97 a0 26 e1 6f dd c1  |.W.t.pn0t..&.o..|
+00000270  5b b6 c5 b0 05 35 43 aa  b3 14 fb ca 59 80 fa 4a  |[....5C.....Y..J|
+00000280  d4 be 61 b2 a7 5d f0 b4  dc 9b ee 83 b6 93 09 ca  |..a..]..........|
+00000290  82 76 a8 99 1d 85 b6 77  f4 eb 7d 4b bb 7c 5b d5  |.v.....w..}K.|[.|
+000002a0  7b 40 a9 b0 77 ad a0 8b  08 81 5c 8e 20 e2 2a 62  |{@..w.....\. .*b|
+000002b0  9f 53 28 e4 e1 a3 1d 14  03 01 00 01 01 16 03 01  |.S(.............|
+000002c0  00 30 84 88 01 5f 1e 79  9b f8 60 b3 7b 50 e0 97  |.0..._.y..`.{P..|
+000002d0  e7 94 1c 75 58 89 1e ab  20 c9 2a 35 43 af 5b e1  |...uX... .*5C.[.|
+000002e0  05 25 60 49 ec 7b fc 9f  d2 ea 77 9a fe a7 86 b8  |.%`I.{....w.....|
+000002f0  89 7d                                             |.}|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 b1 3c 7f c3 15  |..........0.<...|
-00000010  e4 fe bc 1a ee 0d ec 28  ce b0 f7 fd a4 0a e4 79  |.......(.......y|
-00000020  37 09 68 de 58 f8 e8 76  7d 9c 09 35 42 7e 00 8e  |7.h.X..v}..5B~..|
-00000030  4c 8d d1 60 26 d4 09 c5  8b d0 96                 |L..`&......|
+00000000  14 03 01 00 01 01 16 03  01 00 30 ae 8c 9b 1b 85  |..........0.....|
+00000010  41 7b 53 64 51 07 12 6b  37 c0 75 81 b0 6d 4b bd  |A{SdQ..k7.u..mK.|
+00000020  30 a3 a1 5b a3 9e 3d c3  ed 4f ac e3 67 88 ec a8  |0..[..=..O..g...|
+00000030  fb 6f 09 d5 11 8c 7b ae  39 60 0c                 |.o....{.9`.|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 6c bb 09  ee 1d 96 6c 63 5b b6 69  |.... l.....lc[.i|
-00000010  bf ea ad 7a 85 36 a2 4b  d2 f0 73 18 91 b1 42 e5  |...z.6.K..s...B.|
-00000020  77 d0 6c ff ab 17 03 01  00 20 ed 85 78 3b bd 49  |w.l...... ..x;.I|
-00000030  2c f3 02 24 f2 18 72 96  a0 49 6b 06 bd bb 54 25  |,..$..r..Ik...T%|
-00000040  0a 3e ff 07 45 6b 6c cc  a6 d2 15 03 01 00 20 07  |.>..Ekl....... .|
-00000050  9a fb b7 cc 01 cd f7 b6  90 d3 b6 a7 31 15 99 e2  |............1...|
-00000060  e7 e8 2b a5 c0 e8 a9 9d  fe 4e 11 0d 4a d4 b7     |..+......N..J..|
+00000000  17 03 01 00 20 ca 25 b7  cb b1 74 e5 00 c2 65 b4  |.... .%...t...e.|
+00000010  49 9d 2c c5 a4 0b be 1d  2b 49 30 96 19 f2 10 0c  |I.,.....+I0.....|
+00000020  7a c2 23 57 5b 17 03 01  00 20 39 20 09 37 f3 b0  |z.#W[.... 9 .7..|
+00000030  8f 3a 93 2f 14 6d cd d6  ec 2c 1f 2b 3f ee 13 d3  |.:./.m...,.+?...|
+00000040  72 f4 c4 36 49 a9 80 28  f1 08 15 03 01 00 20 82  |r..6I..(...... .|
+00000050  c8 e7 e5 a1 c0 78 da 98  8a ad 93 da cb cc 9e a8  |.....x..........|
+00000060  c6 60 ec 50 fa d2 25 38  6b e3 5d 0d 1c c7 15     |.`.P..%8k.]....|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES
index ac354c50bc..b8f32392b5 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 5d 02 00 00  59 03 01 70 d2 b8 0b 74  |....]...Y..p...t|
-00000010  93 b4 60 d7 ab 1d 0f f3  7c d0 b5 f8 a2 78 45 30  |..`.....|....xE0|
-00000020  b1 41 9b b6 73 bd 05 d8  85 16 66 20 e8 26 8d 7a  |.A..s.....f .&.z|
-00000030  e2 da e0 a0 7a c9 19 d1  dd db 2b bc b4 b2 56 39  |....z.....+...V9|
-00000040  9f e6 62 75 29 96 40 b3  0d c0 db 65 c0 09 00 00  |..bu).@....e....|
+00000000  16 03 01 00 5d 02 00 00  59 03 01 65 75 f4 83 d3  |....]...Y..eu...|
+00000010  95 a2 e3 96 5d 70 09 f1  ab 22 18 3d f6 9c 27 b2  |....]p...".=..'.|
+00000020  f0 4f 17 eb f4 6a 32 4d  1f 02 59 20 75 b7 a4 c8  |.O...j2M..Y u...|
+00000030  66 a9 4b 54 d3 0b 8b 82  38 24 31 8a 01 71 95 06  |f.KT....8$1..q..|
+00000040  a9 4f dd b2 d4 42 25 77  8c 91 87 48 c0 09 00 00  |.O...B%w...H....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 01 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
 00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
@@ -56,37 +58,37 @@
 00000240  8c 25 c1 33 13 83 0d 94  06 bb d4 37 7a f6 ec 7a  |.%.3.......7z..z|
 00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
 00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
-00000270  95 12 07 8f 2a 16 03 01  00 b4 0c 00 00 b0 03 00  |....*...........|
-00000280  1d 20 5f 81 8f 18 31 4e  64 fe 87 f2 da c6 45 45  |. _...1Nd.....EE|
-00000290  54 e3 54 c6 a0 bb bf bd  d1 01 c5 7b 08 d8 32 6b  |T.T........{..2k|
-000002a0  a8 31 00 8a 30 81 87 02  42 01 21 7e c2 26 cb 5e  |.1..0...B.!~.&.^|
-000002b0  f1 2a d2 9b 7f 3f b4 d4  28 5e 63 5a 20 aa 28 87  |.*...?..(^cZ .(.|
-000002c0  bb dd 5c 6a 91 a2 2d 03  7a 69 67 8b ca 84 a6 1f  |..\j..-.zig.....|
-000002d0  d3 58 40 eb 5c 54 95 96  05 d0 37 63 e4 a6 1b 51  |.X@.\T....7c...Q|
-000002e0  9a d0 93 31 82 e6 8e a0  af 29 64 02 41 4c ff ac  |...1.....)d.AL..|
-000002f0  44 74 e0 04 2c ab 1c 23  91 dc 06 36 ff 19 a1 60  |Dt..,..#...6...`|
-00000300  19 d4 e5 d3 78 f5 ed d8  09 7b de 61 6f 65 2c 69  |....x....{.aoe,i|
-00000310  a1 d2 5d 07 bf 99 26 2b  70 fa 34 26 30 41 59 3b  |..]...&+p.4&0AY;|
-00000320  bc a3 10 9c 92 fa 60 a7  df ea e4 8a 3a 76 16 03  |......`.....:v..|
-00000330  01 00 04 0e 00 00 00                              |.......|
+00000270  95 12 07 8f 2a 16 03 01  00 b3 0c 00 00 af 03 00  |....*...........|
+00000280  1d 20 37 88 b4 b9 cb 5f  71 5e 4c 36 59 f1 37 97  |. 7...._q^L6Y.7.|
+00000290  ec 3e 16 c8 ac 23 61 8d  fe 75 14 ff 33 eb db 04  |.>...#a..u..3...|
+000002a0  7a 17 00 89 30 81 86 02  41 50 a1 8b 98 a0 b9 21  |z...0...AP.....!|
+000002b0  22 23 a1 ce 76 85 6e 7a  40 ce 2c 65 bc 3c 89 e6  |"#..v.nz@.,e.<..|
+000002c0  1c 74 1e a9 1d 6c c7 60  99 b5 68 62 74 84 0d 7c  |.t...l.`..hbt..||
+000002d0  a3 06 61 b1 d2 9a 5c 3e  92 39 d7 ac be 1d ac ff  |..a...\>.9......|
+000002e0  18 e7 76 29 f1 d2 8f 97  6e 44 02 41 07 e1 ee a8  |..v)....nD.A....|
+000002f0  cc 89 7d a5 6e e5 32 52  51 72 ff dc 9e 77 e2 c8  |..}.n.2RQr...w..|
+00000300  18 07 1e 6e fa 4a b2 05  f8 a5 e6 21 76 90 ba e4  |...n.J.....!v...|
+00000310  9f b4 2a 03 c5 86 07 58  aa 4a c2 d8 24 c9 a5 e0  |..*....X.J..$...|
+00000320  d7 04 0e 41 33 3c b7 e2  82 f1 05 0d 6a 16 03 01  |...A3<......j...|
+00000330  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
 00000000  16 03 01 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 01 00 01 01  |....._X.;t......|
-00000030  16 03 01 00 30 6d 2a 91  d7 c3 8f 1c d8 d4 cc 67  |....0m*........g|
-00000040  ed 07 41 c2 9c 48 0d bd  7f 11 61 00 58 23 55 88  |..A..H....a.X#U.|
-00000050  f9 bd da 92 bc e4 8d 47  c0 ac 72 43 7f 2d 0f b5  |.......G..rC.-..|
-00000060  de bb 67 6e 9f                                    |..gn.|
+00000030  16 03 01 00 30 8b de e9  e0 3d 21 29 46 07 eb da  |....0....=!)F...|
+00000040  60 6a 55 37 05 9c 94 e1  46 1f 12 a0 76 b6 0f 45  |`jU7....F...v..E|
+00000050  9d ad ee 69 ae 01 74 9f  de d4 d1 67 a5 0b 57 48  |...i..t....g..WH|
+00000060  69 c3 e6 2d ad                                    |i..-.|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 be 25 a7 fa 04  |..........0.%...|
-00000010  a5 dd 58 c1 5f a6 31 f8  fc fc db 27 a1 c7 0b 7c  |..X._.1....'...||
-00000020  a5 9a 0f bd 07 09 d9 9b  95 bf f4 a5 80 c7 7d bd  |..............}.|
-00000030  a0 37 25 68 46 63 37 37  5f 3d b2                 |.7%hFc77_=.|
+00000000  14 03 01 00 01 01 16 03  01 00 30 f7 8f 4a 28 80  |..........0..J(.|
+00000010  4c 9b cb 02 39 81 a4 19  84 d9 b3 64 48 4d a6 2b  |L...9......dHM.+|
+00000020  20 6a 1e 9d 6f d2 39 53  1a f4 27 0e dc 92 ec 71  | j..o.9S..'....q|
+00000030  7d 48 66 67 6a 51 68 e4  7c 68 63                 |}HfgjQh.|hc|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 98 6e bd  0c 0e 46 88 05 6d 67 b3  |.... .n...F..mg.|
-00000010  a7 92 7a 3c f2 98 8b ab  07 9e 80 bc 7a 5e 70 1a  |..z<........z^p.|
-00000020  2b 3d 2f 28 c9 17 03 01  00 20 f1 a8 ac 45 f6 60  |+=/(..... ...E.`|
-00000030  ac 76 4e 66 1b a1 23 65  9c 55 6b 0b d4 cb 0a 43  |.vNf..#e.Uk....C|
-00000040  42 d1 1e 1b 61 45 16 8e  a8 c2 15 03 01 00 20 3d  |B...aE........ =|
-00000050  c0 ac 27 49 be 69 0e 23  cd 1b ea 01 0f 97 66 34  |..'I.i.#......f4|
-00000060  f8 bd a6 40 35 af 5b 1f  cf 42 25 54 aa 2f 2e     |...@5.[..B%T./.|
+00000000  17 03 01 00 20 ca ea fd  d5 01 d1 47 40 a5 57 4f  |.... ......G@.WO|
+00000010  b0 80 29 e5 a0 4a f2 09  34 02 46 10 45 3a 05 42  |..)..J..4.F.E:.B|
+00000020  0f 19 eb a2 33 17 03 01  00 20 34 92 d3 ed e4 50  |....3.... 4....P|
+00000030  13 e9 5c 65 01 fc c1 a3  28 77 c8 d6 2c 11 7f 68  |..\e....(w..,..h|
+00000040  b9 08 51 53 c9 f3 d3 4e  9a 24 15 03 01 00 20 07  |..QS...N.$.... .|
+00000050  4d 53 0a 85 d4 49 c4 7b  a2 4c 38 8d cc 8e 2a dd  |MS...I.{.L8...*.|
+00000060  24 da 28 07 f8 4b c5 2c  d2 15 e2 b5 b9 56 b1     |$.(..K.,.....V.|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES
index 694cd4ce89..9790da472e 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 5d 02 00 00  59 03 01 5a a9 a1 6f fa  |....]...Y..Z..o.|
-00000010  19 95 38 9e 68 42 d7 0f  73 23 09 3f 01 5f e8 ae  |..8.hB..s#.?._..|
-00000020  d7 06 a2 9b d3 01 0f 0d  23 53 7d 20 55 2b 67 4e  |........#S} U+gN|
-00000030  8b 44 94 a5 25 ef b7 fb  e1 c7 85 e8 15 60 f9 d7  |.D..%........`..|
-00000040  6d a4 3f 3d 42 d7 78 a6  41 49 b7 12 c0 13 00 00  |m.?=B.x.AI......|
+00000000  16 03 01 00 5d 02 00 00  59 03 01 2d 3f 4f 1e 90  |....]...Y..-?O..|
+00000010  6e 65 37 1c 8e a3 17 98  72 de 49 69 4d b9 61 c9  |ne7.....r.IiM.a.|
+00000020  20 c2 92 6f 4f d1 a8 dc  61 71 4d 20 67 dc 24 8f  | ..oO...aqM g.$.|
+00000030  59 12 a0 19 ab ca e1 3a  44 e7 b3 32 bd 7d 04 96  |Y......:D..2.}..|
+00000040  41 1a 44 f6 fb 60 14 8f  6f f8 0e 69 c0 13 00 00  |A.D..`..o..i....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 01 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -61,36 +63,36 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 01 00 aa 0c 00 00  a6 03 00 1d 20 a7 ec f4  |............ ...|
-000002d0  c7 51 5e a0 fb 55 5a 01  34 cc d1 a6 22 df d6 00  |.Q^..UZ.4..."...|
-000002e0  f5 73 e0 9e b8 9d 2a a9  49 3a 99 ba 17 00 80 14  |.s....*.I:......|
-000002f0  95 47 77 a1 48 b4 e7 ba  6a e8 0e 4e ee 55 25 f5  |.Gw.H...j..N.U%.|
-00000300  ea 82 65 b4 3f db a2 94  03 cc d3 6c 4a e6 cf 57  |..e.?......lJ..W|
-00000310  25 4c 79 b8 fb ab dd 1f  68 e4 55 87 b1 46 12 30  |%Ly.....h.U..F.0|
-00000320  5e 9f 3d 4a 52 24 76 50  c8 54 83 a2 b9 f5 a6 e0  |^.=JR$vP.T......|
-00000330  ec e1 fb ae dd ca d2 c9  b2 31 d5 d4 73 f4 c0 0a  |.........1..s...|
-00000340  29 1c d3 8e 87 4c b4 0a  37 e8 77 e4 e2 a7 e9 9c  |)....L..7.w.....|
-00000350  04 ba af 31 dc 2e 5a b3  2e f3 58 e6 21 0a e2 1c  |...1..Z...X.!...|
-00000360  d4 c6 be b1 70 83 22 05  f8 78 12 6e bd 53 22 16  |....p."..x.n.S".|
+000002c0  16 03 01 00 aa 0c 00 00  a6 03 00 1d 20 91 5b 49  |............ .[I|
+000002d0  6b 53 81 6a 82 c4 1b db  31 cd d9 3a aa e4 a3 a8  |kS.j....1..:....|
+000002e0  76 8d 29 ba a4 27 eb fe  19 98 de 4c 20 00 80 71  |v.)..'.....L ..q|
+000002f0  a2 66 8e 70 55 ec 04 3c  dd 5a 5e 79 fb 25 2b af  |.f.pU..<.Z^y.%+.|
+00000300  dc aa 47 03 9b c3 99 d2  20 83 81 cb 82 68 8e 62  |..G..... ....h.b|
+00000310  26 90 78 d0 8c 9c 49 87  34 22 c1 0c 73 a8 de 79  |&.x...I.4"..s..y|
+00000320  3c 73 e9 49 15 f0 63 17  19 bb cb 5f 97 c6 20 80  |<s.I..c...._.. .|
+00000330  22 82 1e d0 be 40 da 53  84 53 43 cb ff 24 56 28  |"....@.S.SC..$V(|
+00000340  58 ec 85 47 3e ce eb f3  cb d6 26 9a 83 3b 4b 88  |X..G>.....&..;K.|
+00000350  15 96 f8 84 30 6d b9 e3  44 c4 45 57 aa d1 53 9e  |....0m..D.EW..S.|
+00000360  cc c9 09 c2 1b 17 0d 8f  f7 d7 0e 9d 86 33 60 16  |.............3`.|
 00000370  03 01 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
 00000000  16 03 01 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 01 00 01 01  |....._X.;t......|
-00000030  16 03 01 00 30 0f 56 a4  2c c6 11 a2 0a a8 f7 ff  |....0.V.,.......|
-00000040  6e 71 19 e9 e5 c0 e2 6b  86 9b b1 5d 46 8d 62 93  |nq.....k...]F.b.|
-00000050  69 7c 28 6f 25 3d dc ce  fa 6f 91 9e b8 8c 15 cd  |i|(o%=...o......|
-00000060  6a b1 72 ce a8                                    |j.r..|
+00000030  16 03 01 00 30 16 75 14  eb 02 a0 e1 02 79 5f fe  |....0.u......y_.|
+00000040  fe e6 89 69 f1 5b 57 01  58 0f 4c 7d 4e 27 ed ae  |...i.[W.X.L}N'..|
+00000050  b8 b2 b9 53 24 f1 f1 d0  0b f2 d2 a0 21 ca 68 37  |...S$.......!.h7|
+00000060  26 56 78 68 5c                                    |&Vxh\|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 d0 aa 00 27 9e  |..........0...'.|
-00000010  fb 56 22 9f 65 ab 3c cf  34 d9 a0 92 08 62 f2 fe  |.V".e.<.4....b..|
-00000020  29 4b 0c 14 b0 72 f5 c0  f8 2b 7e 1f 38 ad 68 7e  |)K...r...+~.8.h~|
-00000030  37 c3 fb 26 5a 5b 42 39  83 33 c0                 |7..&Z[B9.3.|
+00000000  14 03 01 00 01 01 16 03  01 00 30 0b c7 b6 d7 69  |..........0....i|
+00000010  7a f5 d7 06 f7 e3 78 7b  35 44 c0 88 4d c2 c7 6f  |z.....x{5D..M..o|
+00000020  93 0c 61 32 10 47 08 0d  e3 44 4f 1a 71 80 e3 96  |..a2.G...DO.q...|
+00000030  15 b4 f0 29 b5 d3 7a 78  94 9e a2                 |...)..zx...|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 0e 54 7f  5d b9 f2 73 9d a5 49 25  |.... .T.]..s..I%|
-00000010  c6 b9 03 1e fb 84 76 a9  69 ca 25 79 c3 a4 60 18  |......v.i.%y..`.|
-00000020  94 ff 92 47 4f 17 03 01  00 20 cd 19 d2 cd 7d 7d  |...GO.... ....}}|
-00000030  3b a1 65 ee 4e a2 f2 02  55 02 28 54 28 92 c9 ec  |;.e.N...U.(T(...|
-00000040  db 59 f6 7d 2f 9e 7b 66  0e be 15 03 01 00 20 4f  |.Y.}/.{f...... O|
-00000050  ab cd 12 5b c4 f4 03 0e  57 03 3d f5 4e 09 8b 83  |...[....W.=.N...|
-00000060  8b c6 9c c7 eb 30 8c f2  43 f6 10 30 14 80 c5     |.....0..C..0...|
+00000000  17 03 01 00 20 aa 76 ee  c2 22 9f 8a 31 45 7e 10  |.... .v.."..1E~.|
+00000010  97 00 68 2f 54 fa d9 a9  ad 6a 22 0b 85 c9 f7 f6  |..h/T....j".....|
+00000020  18 02 59 10 51 17 03 01  00 20 23 9e 9f 87 02 fd  |..Y.Q.... #.....|
+00000030  6f d9 22 8d d3 db 4a 42  ac 9b 9a 69 7e 54 20 ab  |o."...JB...i~T .|
+00000040  72 29 4f 06 c6 d2 54 a9  9f 46 15 03 01 00 20 06  |r)O...T..F.... .|
+00000050  51 cd cd 83 a9 ce c5 18  4f 5c 0f a6 68 5b c2 07  |Q.......O\..h[..|
+00000060  31 59 c1 2a bd 4e 21 be  63 5f 29 49 a7 30 4e     |1Y.*.N!.c_)I.0N|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ExportKeyingMaterial b/src/crypto/tls/testdata/Client-TLSv10-ExportKeyingMaterial
index 92ae0927a0..6c83cc335e 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ExportKeyingMaterial
+++ b/src/crypto/tls/testdata/Client-TLSv10-ExportKeyingMaterial
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 5d 02 00 00  59 03 01 6f 36 7b f5 f4  |....]...Y..o6{..|
-00000010  3b 49 31 64 aa 42 a7 8c  a2 4d 00 a7 9c b9 b6 9c  |;I1d.B...M......|
-00000020  0d 2f 09 81 e8 ab 74 77  11 fe 0b 20 e0 b9 92 4d  |./....tw... ...M|
-00000030  e2 70 fd 58 ec 58 02 f2  b3 44 d2 3d 7f c9 ad ca  |.p.X.X...D.=....|
-00000040  5c 78 fe f9 36 67 a8 b7  a8 0f 7a 1a c0 13 00 00  |\x..6g....z.....|
+00000000  16 03 01 00 5d 02 00 00  59 03 01 6f 7c ae 3c cc  |....]...Y..o|.<.|
+00000010  76 04 54 ef 3c b8 48 b2  c3 fb 68 9d a3 91 e1 43  |v.T.<.H...h....C|
+00000020  a1 d5 a0 fa 87 1c ed 6b  9c 14 da 20 c6 25 eb 72  |.......k... .%.r|
+00000030  1c 0f c4 96 6a 75 ed 73  f9 20 75 8a 58 ca 5d 72  |....ju.s. u.X.]r|
+00000040  3d 97 a2 3e e5 36 c5 04  f2 01 c7 1f c0 13 00 00  |=..>.6..........|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 01 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -61,36 +63,36 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 01 00 aa 0c 00 00  a6 03 00 1d 20 10 69 5f  |............ .i_|
-000002d0  db e5 a8 1f 14 81 0c c7  35 d4 3c 22 ee 17 a3 21  |........5.<"...!|
-000002e0  47 9b e2 3c 5a f6 f5 46  b9 73 2a 7f 62 00 80 49  |G..<Z..F.s*.b..I|
-000002f0  b9 6b f4 80 03 46 b9 64  be e0 35 93 b0 df ad 5f  |.k...F.d..5...._|
-00000300  ff 51 85 aa 65 e2 ee ea  64 4a 20 f8 14 5e b7 ea  |.Q..e...dJ ..^..|
-00000310  8c d9 70 42 4c f8 f5 34  f9 0e 7f f4 b5 76 12 0e  |..pBL..4.....v..|
-00000320  59 f2 fd 52 85 0f 31 ec  70 c5 21 22 d9 67 ba cf  |Y..R..1.p.!".g..|
-00000330  ae 3e 75 6b 76 a4 b8 c4  94 d5 a5 af 1f fc 4d 66  |.>ukv.........Mf|
-00000340  57 70 1a 4c 21 27 7f c8  69 f4 f4 83 5c 44 32 b4  |Wp.L!'..i...\D2.|
-00000350  73 18 a3 c4 4a c1 71 92  04 7a 49 49 15 25 05 a0  |s...J.q..zII.%..|
-00000360  61 69 f8 38 4b 9f 92 96  f4 6b 6b 4b 96 60 45 16  |ai.8K....kkK.`E.|
+000002c0  16 03 01 00 aa 0c 00 00  a6 03 00 1d 20 71 f2 c9  |............ q..|
+000002d0  aa 88 45 b7 8a 34 c8 0b  f4 09 5d fb c2 a2 27 ad  |..E..4....]...'.|
+000002e0  48 86 ba 5f c7 a6 55 10  a4 ef 9c 45 4e 00 80 b8  |H.._..U....EN...|
+000002f0  82 3a a3 50 23 f2 a5 b2  69 fd 5b 36 b0 7a 16 6d  |.:.P#...i.[6.z.m|
+00000300  b7 7a df 77 bd 11 48 27  6c f5 7c 41 9c 66 50 13  |.z.w..H'l.|A.fP.|
+00000310  1e 57 c5 28 79 2f 55 41  63 18 12 b6 d1 d9 6a 7b  |.W.(y/UAc.....j{|
+00000320  77 fe 95 44 16 f3 e5 6f  f3 6c 39 15 da f5 bd 13  |w..D...o.l9.....|
+00000330  35 fc dc ce 4e 7c 89 ae  46 d0 d5 5a b2 d2 d8 28  |5...N|..F..Z...(|
+00000340  b2 e0 d8 6b 09 ed 4a 17  78 27 8d c4 14 26 86 6d  |...k..J.x'...&.m|
+00000350  2d 15 9e ec a9 09 11 71  1f b8 5b a8 24 33 55 09  |-......q..[.$3U.|
+00000360  b1 b6 4d 55 b4 06 63 c5  89 a6 9d e1 19 41 b2 16  |..MU..c......A..|
 00000370  03 01 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
 00000000  16 03 01 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 01 00 01 01  |....._X.;t......|
-00000030  16 03 01 00 30 e2 8b e2  aa 5a 35 c5 e5 68 ce f4  |....0....Z5..h..|
-00000040  fa 51 3f 7b 3e 99 2f 21  b2 c6 b2 70 74 af ae ca  |.Q?{>./!...pt...|
-00000050  36 86 78 08 ea 8f 02 29  e6 a6 71 fa ad 7f c6 97  |6.x....)..q.....|
-00000060  54 6f 88 a3 4b                                    |To..K|
+00000030  16 03 01 00 30 9e df 6e  5c c6 25 f6 20 e1 0d 34  |....0..n\.%. ..4|
+00000040  c8 a7 38 07 20 b7 fc e2  4d da 40 7f 29 38 7b 42  |..8. ...M.@.)8{B|
+00000050  af 9b 6f 14 a7 68 15 2e  a0 53 67 73 19 ef 08 c3  |..o..h...Sgs....|
+00000060  d0 c5 af cf b6                                    |.....|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 af 26 01 47 8a  |..........0.&.G.|
-00000010  a3 08 b2 79 1c fe fa 91  e8 4b a6 e1 ad 8e 59 b7  |...y.....K....Y.|
-00000020  ea 41 ee 3e 3a aa 2f f2  07 9e 0d 90 3d 6f 92 d5  |.A.>:./.....=o..|
-00000030  72 92 ad ae ee c8 5d 48  a0 25 46                 |r.....]H.%F|
+00000000  14 03 01 00 01 01 16 03  01 00 30 5c e5 b5 c2 ef  |..........0\....|
+00000010  6e 64 45 f9 c8 0f 9f 6a  41 b8 47 ad f5 25 af e5  |ndE....jA.G..%..|
+00000020  4c 78 86 dc b9 25 c3 0c  69 f7 41 ec 94 a8 06 4c  |Lx...%..i.A....L|
+00000030  b5 37 f8 17 b8 34 37 c2  7c ff d3                 |.7...47.|..|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 29 2b 6a  75 2b 1b 94 f4 cb 80 14  |.... )+ju+......|
-00000010  16 91 ec 08 77 5a 08 45  e7 51 2e a2 ec 03 f0 ca  |....wZ.E.Q......|
-00000020  35 88 20 3a 2e 17 03 01  00 20 59 0c 48 6f 66 8e  |5. :..... Y.Hof.|
-00000030  88 62 90 cc 33 39 62 ce  96 28 d0 2f 40 6e ed 14  |.b..39b..(./@n..|
-00000040  94 72 88 d8 4a cb 73 24  a9 01 15 03 01 00 20 5c  |.r..J.s$...... \|
-00000050  8a 91 45 ed c9 38 e7 1d  71 02 b8 30 bf 24 0e 30  |..E..8..q..0.$.0|
-00000060  6d fa 0a 4a 39 9f 56 b2  04 99 3e 67 bd bc d9     |m..J9.V...>g...|
+00000000  17 03 01 00 20 98 c1 0e  51 02 22 68 39 62 1d 2f  |.... ...Q."h9b./|
+00000010  79 46 0d 97 2c c1 1f 9b  aa cd 21 d8 7f c9 d6 bf  |yF..,.....!.....|
+00000020  f3 ef 94 ad 18 17 03 01  00 20 59 0c 3e 4e c7 ac  |......... Y.>N..|
+00000030  d2 2e 01 b9 39 69 09 ac  76 ce d8 6e e9 ea 6f 09  |....9i..v..n..o.|
+00000040  23 f4 75 4f 20 c0 a9 a8  8f 21 15 03 01 00 20 e5  |#.uO ....!.... .|
+00000050  e1 6c 39 c4 51 0a 13 b1  ec ef 75 ce e0 b8 d5 08  |.l9.Q.....u.....|
+00000060  22 22 b1 d0 61 78 c8 7d  3c 9c f2 bf 08 12 89     |""..ax.}<......|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4 b/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4
index 8fce559c72..cf9ec918eb 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4
+++ b/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 55 02 00 00  51 03 01 9b 6a cd e3 08  |....U...Q...j...|
-00000010  29 e7 32 d1 53 14 f5 4a  cf b7 61 1a 90 d6 9a 73  |).2.S..J..a....s|
-00000020  ad 48 2a 08 ce d7 d7 cb  f8 25 b1 20 c1 24 61 85  |.H*......%. .$a.|
-00000030  31 d2 81 5e 8e c8 31 40  56 36 79 af bb f7 90 d3  |1..^..1@V6y.....|
-00000040  06 5e 4b 5a 62 50 c0 d5  89 7f 35 70 00 05 00 00  |.^KZbP....5p....|
+00000000  16 03 01 00 55 02 00 00  51 03 01 2a bd da 4f 4d  |....U...Q..*..OM|
+00000010  29 da 36 8a ab 13 02 82  da 2e 53 56 77 18 69 8a  |).6.......SVw.i.|
+00000020  52 ab b2 36 83 38 80 ca  5b 10 38 20 66 2c a6 cf  |R..6.8..[.8 f,..|
+00000030  90 d0 b5 23 0a 4f ac d8  04 09 b3 3a 87 56 f5 8e  |...#.O.....:.V..|
+00000040  68 11 9c 41 2c 3e 14 ea  b8 ad e3 c4 00 05 00 00  |h..A,>..........|
 00000050  09 ff 01 00 01 00 00 17  00 00 16 03 01 02 59 0b  |..............Y.|
 00000060  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
 00000070  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
@@ -72,15 +74,15 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 01 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 01 00 24 b3 7b  e6 d1 8f 79 04 e2 42 0f  |.....$.{...y..B.|
-000000a0  61 de d2 be 1e 4d 8f d4  6f 7e 2d 59 cf 23 ff 1e  |a....M..o~-Y.#..|
-000000b0  74 ea 2a 9c 7e e2 5b 23  05 2e                    |t.*.~.[#..|
+00000090  01 16 03 01 00 24 e7 0e  d1 a9 78 47 47 d3 9e c7  |.....$....xGG...|
+000000a0  76 6d f7 e7 5e b6 df ff  e0 e8 2f a6 9d b4 70 eb  |vm..^...../...p.|
+000000b0  06 00 c9 0e 42 f6 3f 2f  23 83                    |....B.?/#.|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 24 3c 4e 68 82 8f  |..........$<Nh..|
-00000010  af 84 ca 45 a4 3b 05 b2  73 ac 53 8c 3a f3 21 60  |...E.;..s.S.:.!`|
-00000020  4d 6c e1 1d 09 af 06 0e  f7 fa ab dc f0 22 00     |Ml...........".|
+00000000  14 03 01 00 01 01 16 03  01 00 24 3f 6d ab 1f 62  |..........$?m..b|
+00000010  0c 70 c8 df ea 23 f2 36  cf a3 01 89 f2 c4 d6 56  |.p...#.6.......V|
+00000020  59 ac 59 13 24 40 31 19  2b 66 ad d3 5d b7 a4     |Y.Y.$@1.+f..]..|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 1a e0 a4 39  3c 9c 5c 8e 60 db 8e 5c  |.......9<.\.`..\|
-00000010  13 aa 60 4a 1c f0 71 1b  f2 4d a9 f8 52 07 bd 15  |..`J..q..M..R...|
-00000020  03 01 00 16 9e f3 0a 66  42 77 5a 75 74 18 85 f1  |.......fBwZut...|
-00000030  3c fb ea d4 b8 76 6d eb  48 3d                    |<....vm.H=|
+00000000  17 03 01 00 1a a0 8c 45  7f 0d 75 48 6f 15 7b af  |.......E..uHo.{.|
+00000010  6c e5 d2 10 c6 f2 ba 1e  09 50 83 40 f2 96 7c 15  |l........P.@..|.|
+00000020  03 01 00 16 53 b3 bd 98  38 ed 20 35 0a 5a 03 f3  |....S...8. 5.Z..|
+00000030  49 5c 69 85 4d ae 7e f9  fc 9d                    |I\i.M.~...|
diff --git a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES
index 0ad2db0575..3a5fa10a13 100644
--- a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 02 00 5d 02 00 00  59 03 02 51 70 ac 24 75  |....]...Y..Qp.$u|
-00000010  53 94 02 c6 20 8e 22 0d  b2 79 30 3b ee a1 00 44  |S... ."..y0;...D|
-00000020  f3 1c b8 a3 4c 51 c4 d9  30 95 d4 20 ca 82 67 4f  |....LQ..0.. ..gO|
-00000030  8c 13 5f c2 7e fc e0 0c  04 5c e2 9a c2 a3 02 a1  |.._.~....\......|
-00000040  bc fa ca 16 38 83 2e 5a  c1 75 19 67 c0 09 00 00  |....8..Z.u.g....|
+00000000  16 03 02 00 5d 02 00 00  59 03 02 2b 28 48 86 02  |....]...Y..+(H..|
+00000010  ae 35 61 75 02 0b ea 8c  a1 3b ea c3 6c 26 e6 8d  |.5au.....;..l&..|
+00000020  a0 49 0c 96 f2 a4 75 b6  5d f5 29 20 ff 34 87 5d  |.I....u.].) .4.]|
+00000030  f9 ca 98 f2 49 10 3b 98  ff 30 5f a4 28 0d 9b d1  |....I.;..0_.(...|
+00000040  60 02 7b fe a0 b8 7e 40  4e fb 45 54 c0 09 00 00  |`.{...~@N.ET....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 02 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
 00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
@@ -56,39 +58,39 @@
 00000240  8c 25 c1 33 13 83 0d 94  06 bb d4 37 7a f6 ec 7a  |.%.3.......7z..z|
 00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
 00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
-00000270  95 12 07 8f 2a 16 03 02  00 b5 0c 00 00 b1 03 00  |....*...........|
-00000280  1d 20 4a 31 cd 48 ea 05  09 8a 6d 78 c5 46 5d ea  |. J1.H....mx.F].|
-00000290  fb aa 62 79 17 70 31 5e  5a 95 c1 ce a9 52 3e 8e  |..by.p1^Z....R>.|
-000002a0  a1 7b 00 8b 30 81 88 02  42 01 e1 c6 99 40 d7 9f  |.{..0...B....@..|
-000002b0  15 41 f4 4f 54 5f 5d 14  bd a6 cc 18 6e 67 98 ab  |.A.OT_].....ng..|
-000002c0  6a 33 9d 54 68 94 2a 89  22 66 2d 20 97 e7 53 c9  |j3.Th.*."f- ..S.|
-000002d0  f8 ee ad 64 46 6e 53 1d  d6 57 55 6a 4c bc 37 1f  |...dFnS..WUjL.7.|
-000002e0  e7 9c c4 bb 23 cb af 27  2a 19 94 02 42 01 35 b4  |....#..'*...B.5.|
-000002f0  a1 f0 c2 6d 34 f0 05 a7  25 9a 22 6c 3e 41 e7 a0  |...m4...%."l>A..|
-00000300  1e 8f 5a 28 b1 5a 88 46  48 7e 40 93 f2 38 9d 33  |..Z(.Z.FH~@..8.3|
-00000310  6b b5 92 ed 6d 44 07 03  c8 77 ee 3a 80 37 1e f9  |k...mD...w.:.7..|
-00000320  4d 5c 2b 6d c5 15 07 b2  7c eb c5 f5 c5 14 dd 16  |M\+m....|.......|
-00000330  03 02 00 04 0e 00 00 00                           |........|
+00000270  95 12 07 8f 2a 16 03 02  00 b4 0c 00 00 b0 03 00  |....*...........|
+00000280  1d 20 33 24 10 dd 39 bf  dd 42 80 f9 51 75 5d d5  |. 3$..9..B..Qu].|
+00000290  e3 97 b0 70 c8 9a e5 3c  90 5a f6 84 e7 17 2e d4  |...p...<.Z......|
+000002a0  71 6e 00 8a 30 81 87 02  42 01 f3 ed 17 7f 96 9d  |qn..0...B.......|
+000002b0  52 49 6b fd fb 94 28 67  8d 2f 75 7c 59 31 d1 b7  |RIk...(g./u|Y1..|
+000002c0  61 ed 94 c6 1a df 49 e6  9f 19 f1 54 0f 28 2f 3b  |a.....I....T.(/;|
+000002d0  18 fc 73 61 6d 7c 7e dd  61 80 d7 98 2e 20 6a 54  |..sam|~.a.... jT|
+000002e0  37 23 2b d7 11 e0 fa a4  98 49 78 02 41 39 49 af  |7#+......Ix.A9I.|
+000002f0  f9 28 5c 2b 50 0d 6e be  13 17 df 9a fb d0 71 9c  |.(\+P.n.......q.|
+00000300  6c 43 eb 09 90 ce 09 bd  f3 54 9f 73 da c7 ef f3  |lC.......T.s....|
+00000310  df 36 0e 75 d5 cc 4d 42  a5 d8 4c f9 e9 32 b9 90  |.6.u..MB..L..2..|
+00000320  9f fd 6c 70 bc d6 cf 73  b6 0b f0 db 55 d6 16 03  |..lp...s....U...|
+00000330  02 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 02 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 02 00 01 01  |....._X.;t......|
 00000030  16 03 02 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000040  00 00 00 00 00 40 aa 15  c7 e0 2e f6 9e e8 aa 92  |.....@..........|
-00000050  81 6d 83 8f 13 7e 7c d5  9f b9 bf ca 5d da fd 3c  |.m...~|.....]..<|
-00000060  ba c7 8e 8e 9a 93 86 21  49 15 04 9d b8 75 c1 fe  |.......!I....u..|
-00000070  5b a6 41 d5 46                                    |[.A.F|
+00000040  00 00 00 00 00 2b 2a 78  3f 77 6c 2d e6 26 0f ac  |.....+*x?wl-.&..|
+00000050  c3 d8 c9 0f c0 3d c7 7c  e4 08 da 9c af 0f 88 4c  |.....=.|.......L|
+00000060  2f 8e c0 96 78 a4 1f 2c  73 8c 7d 93 28 d1 ce e2  |/...x..,s.}.(...|
+00000070  06 74 35 9d ba                                    |.t5..|
 >>> Flow 4 (server to client)
-00000000  14 03 02 00 01 01 16 03  02 00 40 ba a7 6d aa 40  |..........@..m.@|
-00000010  b5 94 f8 d6 84 38 7c 19  7f b9 e9 8b 0f a8 db 4c  |.....8|........L|
-00000020  68 cf 1e d4 e0 b2 7c 78  80 76 18 c7 a5 cf 57 2d  |h.....|x.v....W-|
-00000030  1e 3d 17 b2 ce 44 93 76  38 91 4b d0 7f 09 00 2f  |.=...D.v8.K..../|
-00000040  c2 da c7 32 70 de fd cb  a4 99 90                 |...2p......|
+00000000  14 03 02 00 01 01 16 03  02 00 40 a7 8b 1b c5 b8  |..........@.....|
+00000010  b6 44 7d 9b 34 e7 c7 f1  d2 c6 19 e8 13 d4 0a b1  |.D}.4...........|
+00000020  07 ae 88 d1 7b 34 ca 0e  84 ab b3 e5 d6 13 22 22  |....{4........""|
+00000030  2b 1c e6 c9 2e b6 15 46  55 7d 2c 34 69 2b 06 62  |+......FU},4i+.b|
+00000040  d9 ef ce da d7 c8 98 3a  e5 23 87                 |.......:.#.|
 >>> Flow 5 (client to server)
 00000000  17 03 02 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 86 40 c2  e7 d4 56 43 6b e0 e4 96  |......@...VCk...|
-00000020  41 74 2e b1 65 cd c6 93  06 71 f0 25 20 21 c5 1b  |At..e....q.% !..|
-00000030  d2 ea eb e4 06 15 03 02  00 30 00 00 00 00 00 00  |.........0......|
-00000040  00 00 00 00 00 00 00 00  00 00 1e a9 c0 dc d8 23  |...............#|
-00000050  f2 08 b0 c5 b2 2e 53 9b  23 50 8a 02 c6 41 9a 36  |......S.#P...A.6|
-00000060  59 b1 23 d9 5e 91 45 cf  1b a1                    |Y.#.^.E...|
+00000010  00 00 00 00 00 8f de 5e  92 28 7d 7d 8a 7e 48 40  |.......^.(}}.~H@|
+00000020  9b a6 8c 13 d3 fe 71 c9  d7 f9 a8 3a 06 64 da f2  |......q....:.d..|
+00000030  dc cf 69 f2 4b 15 03 02  00 30 00 00 00 00 00 00  |..i.K....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 78 0f 3e c5 3c e9  |..........x.>.<.|
+00000050  39 5d 5c 7a 2c 16 f0 7f  b7 ca 3b 85 f3 ab f4 3d  |9]\z,.....;....=|
+00000060  ce df fd 6d 4d ad f4 89  38 ba                    |...mM...8.|
diff --git a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES
index 83c7d77102..f15445e584 100644
--- a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 02 00 5d 02 00 00  59 03 02 79 2f de f0 f3  |....]...Y..y/...|
-00000010  97 6a 5e e3 07 66 d9 f2  8b e9 be 1a 97 9f 6d c8  |.j^..f........m.|
-00000020  9d b5 88 57 fc 8c 5d 7f  d7 3e 34 20 e5 4c 51 33  |...W..]..>4 .LQ3|
-00000030  52 23 a0 52 77 ca 41 4a  1b e4 22 fb 1c 82 f8 e4  |R#.Rw.AJ..".....|
-00000040  aa 13 c2 1a ce cd d5 42  de b0 e9 10 c0 13 00 00  |.......B........|
+00000000  16 03 02 00 5d 02 00 00  59 03 02 87 2b b1 e5 7b  |....]...Y...+..{|
+00000010  0e 0d 78 af b9 41 3c 0b  5a 38 2f 40 6d 13 69 da  |..x..A<.Z8/@m.i.|
+00000020  3a d6 e5 62 ef 72 70 66  9d f0 f4 20 a4 e2 a1 a7  |:..b.rpf... ....|
+00000030  51 f7 7e 23 38 df 2e dd  0b 2f 87 a5 86 93 aa 9d  |Q.~#8..../......|
+00000040  0e aa 02 2b 42 31 cb 36  f3 6b 8e db c0 13 00 00  |...+B1.6.k......|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 02 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -61,38 +63,38 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 02 00 aa 0c 00 00  a6 03 00 1d 20 ef 2a b0  |............ .*.|
-000002d0  da 99 1f 17 dc 29 38 43  c2 72 18 b6 ea ad 8f e6  |.....)8C.r......|
-000002e0  f2 d2 81 e5 f6 2e 6c 5a  95 89 10 14 34 00 80 11  |......lZ....4...|
-000002f0  ff 56 fa 9e 9f 0c b9 a9  57 c4 2c cb a1 ce 70 ca  |.V......W.,...p.|
-00000300  94 bd 5e 54 0e eb da ce  1b 19 ee bc aa bb 9c 10  |..^T............|
-00000310  f8 6e 59 48 82 5e fe 3c  2e 28 6d 8a 2f 08 ce df  |.nYH.^.<.(m./...|
-00000320  52 e2 07 a6 68 68 69 fc  2b d7 fd 28 ef 48 85 c9  |R...hhi.+..(.H..|
-00000330  70 75 b4 f4 04 2f 39 69  ee 1a aa 14 c9 7b e0 f7  |pu.../9i.....{..|
-00000340  bc 50 76 df 24 57 8b a4  ca 87 8a b5 ff c9 13 9e  |.Pv.$W..........|
-00000350  d3 9e 2b e1 d4 6f 0c ce  61 83 e9 38 51 04 2e 23  |..+..o..a..8Q..#|
-00000360  b4 f8 90 f4 0f 45 93 34  14 f4 ca 4f 13 02 89 16  |.....E.4...O....|
+000002c0  16 03 02 00 aa 0c 00 00  a6 03 00 1d 20 94 fa 9b  |............ ...|
+000002d0  b7 34 fd 4c f3 a7 12 a3  0f 6a a2 d2 c3 35 71 3a  |.4.L.....j...5q:|
+000002e0  fa 5c 7e aa ab 17 c9 bf  ae 29 a0 89 4e 00 80 26  |.\~......)..N..&|
+000002f0  6a cd b9 50 a0 61 19 60  c6 fd 58 69 11 7a 11 ac  |j..P.a.`..Xi.z..|
+00000300  16 1d 20 4a 28 4d 7a 9c  7a cb b7 a0 ac 90 3d 25  |.. J(Mz.z.....=%|
+00000310  dc a7 3d d0 5c d7 34 c4  a6 4c 47 73 8e 5a 1b 06  |..=.\.4..LGs.Z..|
+00000320  a5 2d e1 5e 04 d4 c6 31  2e 24 79 6c 0b df 67 3a  |.-.^...1.$yl..g:|
+00000330  f1 7c 5f c0 37 4a ec 1e  d2 32 7c 4f fa 9a d4 51  |.|_.7J...2|O...Q|
+00000340  be 2a 76 f2 74 78 b6 cf  22 d6 3d 16 1b ca 6b 9b  |.*v.tx..".=...k.|
+00000350  d9 9a 3f 65 e4 83 63 91  15 f1 c4 69 45 a3 d9 ab  |..?e..c....iE...|
+00000360  f5 d3 a9 0e 15 00 20 bb  43 20 a7 90 db c6 1d 16  |...... .C ......|
 00000370  03 02 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
 00000000  16 03 02 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 02 00 01 01  |....._X.;t......|
 00000030  16 03 02 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000040  00 00 00 00 00 34 fa 43  0a 6f 38 d0 80 5d a1 d6  |.....4.C.o8..]..|
-00000050  61 c9 62 a9 b2 14 88 b4  7d b9 dc 20 93 11 27 37  |a.b.....}.. ..'7|
-00000060  5a 2a 5b d4 10 54 75 23  8d 39 4a 5b 51 80 48 f2  |Z*[..Tu#.9J[Q.H.|
-00000070  16 64 e5 90 38                                    |.d..8|
+00000040  00 00 00 00 00 5e 93 f4  06 23 2b f4 7e d1 4f 6c  |.....^...#+.~.Ol|
+00000050  3e ad 67 fe 6c 33 42 e7  c0 ce 2b b9 38 0e ec 6e  |>.g.l3B...+.8..n|
+00000060  dc 78 d0 51 d9 57 ef 67  69 4e cd 51 52 9b 09 df  |.x.Q.W.giN.QR...|
+00000070  7e 8d ee cc f1                                    |~....|
 >>> Flow 4 (server to client)
-00000000  14 03 02 00 01 01 16 03  02 00 40 f8 77 bf c0 dd  |..........@.w...|
-00000010  11 e1 3f 90 e0 1a c0 dc  a6 6a b2 81 9b 1b 63 bc  |..?......j....c.|
-00000020  42 b6 23 b2 1f 95 36 38  56 f8 a4 e4 c1 c9 6f d2  |B.#...68V.....o.|
-00000030  64 16 13 16 b7 25 53 ec  a1 c2 94 de 8d ae 38 b9  |d....%S.......8.|
-00000040  07 29 42 1d 16 3d fb 29  8b 76 15                 |.)B..=.).v.|
+00000000  14 03 02 00 01 01 16 03  02 00 40 22 ca 73 9e 54  |..........@".s.T|
+00000010  72 60 64 fd f2 29 fa a1  47 04 ca e7 27 db 82 a8  |r`d..)..G...'...|
+00000020  66 ed 3c 2b 8f 67 8e 09  1a 2d 24 3b 9e dc 8e 1e  |f.<+.g...-$;....|
+00000030  64 ba db a7 64 11 5a 6f  e6 29 cc ed 73 6c 13 b8  |d...d.Zo.)..sl..|
+00000040  40 44 5f d8 72 df 59 b8  a4 4f 7e                 |@D_.r.Y..O~|
 >>> Flow 5 (client to server)
 00000000  17 03 02 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 59 ac 45  2f 3f 3b d3 5d 73 08 85  |.....Y.E/?;.]s..|
-00000020  9a 0e 99 a2 ad 8d 4e de  52 e9 5b 8b 76 71 5d 5e  |......N.R.[.vq]^|
-00000030  6b ec 05 24 a5 15 03 02  00 30 00 00 00 00 00 00  |k..$.....0......|
-00000040  00 00 00 00 00 00 00 00  00 00 92 ce 2d b7 15 d2  |............-...|
-00000050  3b c5 42 ad aa 73 a8 e0  ac 26 d2 e7 ef c7 a9 72  |;.B..s...&.....r|
-00000060  75 96 5c 8c 2d 60 6e 57  bd ef                    |u.\.-`nW..|
+00000010  00 00 00 00 00 51 2f d5  ee 59 bc cc c2 73 15 e1  |.....Q/..Y...s..|
+00000020  15 cb 89 24 d8 7a 2c 2e  d9 9c 9f fc 2b 90 f6 28  |...$.z,.....+..(|
+00000030  fd e5 db 9b 0f 15 03 02  00 30 00 00 00 00 00 00  |.........0......|
+00000040  00 00 00 00 00 00 00 00  00 00 a1 7a 29 17 c3 33  |...........z)..3|
+00000050  87 e8 3a 81 97 ae df 40  97 fc 0b f4 6a 00 84 37  |..:....@....j..7|
+00000060  8c 68 d1 8e db a8 d3 04  93 60                    |.h.......`|
diff --git a/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4 b/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4
index dd58620c47..bb770e61b1 100644
--- a/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4
+++ b/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 02 00 55 02 00 00  51 03 02 42 bb c8 01 43  |....U...Q..B...C|
-00000010  e4 f7 10 09 bf 35 a3 c2  d7 ca 60 a9 60 be 1d 00  |.....5....`.`...|
-00000020  92 33 b6 3e 56 2b c2 f7  29 e3 f9 20 8c d7 b6 90  |.3.>V+..).. ....|
-00000030  03 f5 8b 55 e9 81 47 5b  84 ec 19 bc 32 58 c6 30  |...U..G[....2X.0|
-00000040  f1 79 ea 51 a2 18 cc c0  4e 8a 8e cb 00 05 00 00  |.y.Q....N.......|
+00000000  16 03 02 00 55 02 00 00  51 03 02 fa ec 74 4b af  |....U...Q....tK.|
+00000010  f7 bb 7c 03 0a 35 f9 91  1e 62 c8 d7 9d b0 cc 29  |..|..5...b.....)|
+00000020  0c 67 f1 a9 c6 be ff aa  ee 45 2c 20 7e 02 45 29  |.g.......E, ~.E)|
+00000030  e8 01 2c 76 c9 49 9c bf  ca b7 0c b0 86 69 2a d0  |..,v.I.......i*.|
+00000040  34 59 2c 16 b1 bd 67 1a  e8 f9 97 3d 00 05 00 00  |4Y,...g....=....|
 00000050  09 ff 01 00 01 00 00 17  00 00 16 03 02 02 59 0b  |..............Y.|
 00000060  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
 00000070  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
@@ -72,15 +74,15 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 02 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 02 00 24 a8 40  50 90 31 50 fc 5e d8 f5  |.....$.@P.1P.^..|
-000000a0  64 7a a5 62 8d ad ce 03  34 c9 ab 16 31 45 bc 8b  |dz.b....4...1E..|
-000000b0  26 8b fa 38 7a 2e 60 42  86 46                    |&..8z.`B.F|
+00000090  01 16 03 02 00 24 8b f8  3f ae 9d 41 27 8e 52 ca  |.....$..?..A'.R.|
+000000a0  75 8c 1b 76 fa 20 4f 7f  97 62 ac a6 85 33 71 32  |u..v. O..b...3q2|
+000000b0  34 8d 4b e3 d4 a1 a0 bc  9c 29                    |4.K......)|
 >>> Flow 4 (server to client)
-00000000  14 03 02 00 01 01 16 03  02 00 24 83 1d 5a 04 90  |..........$..Z..|
-00000010  1f 8d 07 46 39 1e 3c cf  cb 06 45 f5 88 9e 68 5c  |...F9.<...E...h\|
-00000020  96 a0 06 47 43 21 20 ce  90 1f 24 49 52 30 59     |...GC! ...$IR0Y|
+00000000  14 03 02 00 01 01 16 03  02 00 24 1d d6 e8 70 53  |..........$...pS|
+00000010  f2 9e 4f ce 5f 35 4e 8d  41 1f 78 9a 72 79 2b cc  |..O._5N.A.x.ry+.|
+00000020  17 cd 48 16 b0 69 8b 41  b7 5a c6 df ec f6 5d     |..H..i.A.Z....]|
 >>> Flow 5 (client to server)
-00000000  17 03 02 00 1a f9 9f c2  32 02 96 87 95 4b ba 17  |........2....K..|
-00000010  1f b9 af fe 6a 87 38 d4  d8 b4 f8 1d ad 05 00 15  |....j.8.........|
-00000020  03 02 00 16 54 07 15 34  f4 c3 a2 3e 01 9e 00 cb  |....T..4...>....|
-00000030  83 f7 58 79 e2 dc a4 b8  15 e9                    |..Xy......|
+00000000  17 03 02 00 1a 69 a6 2b  fe 20 e2 2e e6 b2 ed 03  |.....i.+. ......|
+00000010  92 ae e0 ff 84 56 12 f3  60 01 92 c0 f3 0e 8f 15  |.....V..`.......|
+00000020  03 02 00 16 d1 05 c5 6f  f3 3c 18 63 2b 9c 68 39  |.......o.<.c+.h9|
+00000030  c4 45 90 f1 ef 3f e1 00  2f 78                    |.E...?../x|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256
index d88acc95f9..1db74434cc 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 55 02 00 00  51 03 03 d1 5c 30 66 38  |....U...Q...\0f8|
-00000010  84 89 85 fe b6 87 de 62  8e b5 86 18 16 f7 8f b0  |.......b........|
-00000020  f2 00 09 e5 55 d7 10 a0  76 d8 58 20 23 7d ff 5f  |....U...v.X #}._|
-00000030  b4 b5 5b de b9 7a f9 d1  bc 90 ff 2c 1d d7 fe ed  |..[..z.....,....|
-00000040  2f 6e 29 d8 08 61 0b 9d  cc 7d 64 6a 00 9c 00 00  |/n)..a...}dj....|
+00000000  16 03 03 00 55 02 00 00  51 03 03 00 13 58 0b 7f  |....U...Q....X..|
+00000010  3c 39 9d df c9 4e 95 64  d5 9f 86 b0 8b 19 35 a2  |<9...N.d......5.|
+00000020  71 da 39 5b 14 a5 a4 fd  79 8b 02 20 bf a6 01 51  |q.9[....y.. ...Q|
+00000030  3e 8d 7a 68 ef 24 9a a1  92 d8 72 6a 71 0e c9 fa  |>.zh.$....rjq...|
+00000040  f9 03 36 ca 4b 8a fd 17  95 f5 53 e7 00 9c 00 00  |..6.K.....S.....|
 00000050  09 ff 01 00 01 00 00 17  00 00 16 03 03 02 59 0b  |..............Y.|
 00000060  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
 00000070  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
@@ -72,17 +74,17 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 df b8  |.....(..........|
-000000a0  35 7a 3e 44 d1 f5 6c c5  43 82 3a ac 11 c8 53 0b  |5z>D..l.C.:...S.|
-000000b0  a6 d3 5c f0 5b ca e8 6a  c7 13 88 65 50 71        |..\.[..j...ePq|
+00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 07 7c  |.....(.........||
+000000a0  26 b4 f3 ba 9c 22 69 af  a3 77 5f a3 59 9c b7 58  |&...."i..w_.Y..X|
+000000b0  90 e2 de e3 4f ab b6 2a  08 f4 63 14 9e 5f        |....O..*..c.._|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 3f 30 36 77 c6  |..........(?06w.|
-00000010  6d 4f 37 2c ac f1 c2 24  9d e1 3f 0c 51 64 12 67  |mO7,...$..?.Qd.g|
-00000020  83 47 ec f1 b8 02 6d 11  11 b7 ec ab 09 26 41 ff  |.G....m......&A.|
-00000030  e8 32 05                                          |.2.|
+00000000  14 03 03 00 01 01 16 03  03 00 28 d1 2c 6c a6 ff  |..........(.,l..|
+00000010  35 08 ad e8 3d cd f4 71  1c f7 62 97 44 c5 41 26  |5...=..q..b.D.A&|
+00000020  a4 ff a6 eb 63 e7 45 b1  31 3e ea 0e 33 b4 1d 4a  |....c.E.1>..3..J|
+00000030  9b 1f 87                                          |...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 af 3a 1e  |..............:.|
-00000010  98 3e 74 5f 66 64 eb 6c  88 36 33 f0 98 e8 46 e9  |.>t_fd.l.63...F.|
-00000020  f1 2f 32 15 03 03 00 1a  00 00 00 00 00 00 00 02  |./2.............|
-00000030  76 2b 83 08 46 7d 34 58  db e8 e8 e1 e2 cb ad 1e  |v+..F}4X........|
-00000040  e4 a5                                             |..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 6f ba 97  |.............o..|
+00000010  a1 bb 88 f8 58 ce b3 81  94 20 97 f0 cd 79 5f 9e  |....X.... ...y_.|
+00000020  3d 3f b5 15 03 03 00 1a  00 00 00 00 00 00 00 02  |=?..............|
+00000030  8e 92 d4 4f a2 0e e5 69  e5 9a 7f 7d da 93 54 5c  |...O...i...}..T\|
+00000040  6e 4d                                             |nM|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-AES128-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-AES128-SHA256
index 030cbc6f2b..57fbc75c80 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-AES128-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv12-AES128-SHA256
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 55 02 00 00  51 03 03 bd e7 e2 ea 28  |....U...Q......(|
-00000010  09 0b 7f 30 b5 91 fd b4  91 d1 c3 b8 8f 25 38 88  |...0.........%8.|
-00000020  62 28 5c 1d 14 1a 6a 50  7d 30 e8 20 c3 91 2d ea  |b(\...jP}0. ..-.|
-00000030  59 8d 1d 56 98 c9 02 c0  f1 98 94 a6 8c 2b f2 63  |Y..V.........+.c|
-00000040  ed b9 97 36 c6 c6 32 97  9e 61 6c 3b 00 3c 00 00  |...6..2..al;.<..|
+00000000  16 03 03 00 55 02 00 00  51 03 03 84 b7 a9 d5 83  |....U...Q.......|
+00000010  f6 80 cf 15 58 39 5a 3b  4b f1 6d 2a 86 8b 92 ed  |....X9Z;K.m*....|
+00000020  f8 fb e0 16 c1 2c 94 3a  eb 69 c4 20 e1 b7 43 24  |.....,.:.i. ..C$|
+00000030  e7 9c 69 47 60 48 b0 8b  2b 0b 52 2a 8b 8b 5b 1f  |..iG`H..+.R*..[.|
+00000040  67 12 f6 94 46 c5 b1 53  73 29 f9 d6 00 3c 00 00  |g...F..Ss)...<..|
 00000050  09 ff 01 00 01 00 00 17  00 00 16 03 03 02 59 0b  |..............Y.|
 00000060  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
 00000070  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
@@ -73,25 +75,25 @@
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
 00000090  01 16 03 03 00 50 00 00  00 00 00 00 00 00 00 00  |.....P..........|
-000000a0  00 00 00 00 00 00 f3 6e  c5 65 29 75 22 fe 23 6f  |.......n.e)u".#o|
-000000b0  96 fa b3 8d 98 ac df bf  3a 23 ca 4f d9 52 95 3f  |........:#.O.R.?|
-000000c0  89 8b 61 cf d2 2d f3 14  31 9d 3a 6f a9 b5 7b 69  |..a..-..1.:o..{i|
-000000d0  27 a6 2b 2d 43 6e 77 f1  cd 73 fa 80 7b bf 8a 1d  |'.+-Cnw..s..{...|
-000000e0  83 c5 9b 8c 0a 03                                 |......|
+000000a0  00 00 00 00 00 00 46 00  2f ca 25 2b 92 37 79 de  |......F./.%+.7y.|
+000000b0  88 56 36 da ea 43 78 d7  51 72 53 c1 8b ae 33 3a  |.V6..Cx.QrS...3:|
+000000c0  d2 93 57 08 a1 14 22 5b  5b 33 fe 7c 13 33 17 d6  |..W..."[[3.|.3..|
+000000d0  ef 3b be e6 1c ee 09 c0  5e 86 89 9d 50 e2 e9 b3  |.;......^...P...|
+000000e0  3b 09 4c 70 f8 eb                                 |;.Lp..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 50 f6 93 f3 85 25  |..........P....%|
-00000010  06 5c 47 ea d5 6e 90 05  21 91 9a 86 06 42 f6 54  |.\G..n..!....B.T|
-00000020  25 4a 61 65 7e 19 c8 1a  58 52 06 81 df dd 19 fc  |%Jae~...XR......|
-00000030  bd 5a 82 ff ae 80 92 b3  3b 7d 89 c0 64 b1 36 e3  |.Z......;}..d.6.|
-00000040  5c bb 2a 5b e8 6d 18 02  43 27 b5 57 bc 3f ab b1  |\.*[.m..C'.W.?..|
-00000050  27 59 0e 6a d5 07 6a 66  ad 51 82                 |'Y.j..jf.Q.|
+00000000  14 03 03 00 01 01 16 03  03 00 50 3a 02 c0 c9 cd  |..........P:....|
+00000010  98 d0 dc ec 0a 58 cf a2  c2 f2 0b b2 5a 2c 9b 6e  |.....X......Z,.n|
+00000020  30 d2 98 0e 8f 9b b5 9f  1e e2 5f 0c bd 2b ce f8  |0........._..+..|
+00000030  08 c9 c1 fe 98 a5 5b ca  be 07 81 85 56 bc f4 a3  |......[.....V...|
+00000040  05 40 48 5b 76 ac 75 14  46 1a 8a 7f e4 ff 4e 76  |.@H[v.u.F.....Nv|
+00000050  8f db 76 19 a5 e3 75 e6  ca 1c 14                 |..v...u....|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000010  00 00 00 00 00 2a 8b 84  55 57 20 b8 4f 11 d2 cc  |.....*..UW .O...|
-00000020  5e a0 ef 1a f1 62 fc 59  38 14 30 0f e0 76 04 ca  |^....b.Y8.0..v..|
-00000030  eb c2 45 a4 75 12 e6 1a  16 fc d8 bd d4 f7 fd 6f  |..E.u..........o|
-00000040  f3 99 ca d6 41 15 03 03  00 40 00 00 00 00 00 00  |....A....@......|
-00000050  00 00 00 00 00 00 00 00  00 00 8c 80 a8 e9 95 4c  |...............L|
-00000060  c9 fa 4d 9d 06 e5 d8 70  5f fa a9 44 24 15 f4 47  |..M....p_..D$..G|
-00000070  5a 0a 24 55 a7 6a 04 1c  2a 39 80 fd 08 47 d7 08  |Z.$U.j..*9...G..|
-00000080  41 8b 9d 46 74 cb 61 c6  84 84                    |A..Ft.a...|
+00000010  00 00 00 00 00 02 7a 3c  00 71 20 c9 5a 3a 94 ff  |......z<.q .Z:..|
+00000020  ed a9 a1 c9 cd 7a ec 10  96 5d b9 78 2b ff 9a d4  |.....z...].x+...|
+00000030  2d 5c a2 b5 b1 4d f8 22  b8 70 2b 7e 8d 07 13 62  |-\...M.".p+~...b|
+00000040  b2 23 e8 ff a6 15 03 03  00 40 00 00 00 00 00 00  |.#.......@......|
+00000050  00 00 00 00 00 00 00 00  00 00 f6 61 2f e6 18 fb  |...........a/...|
+00000060  dc ed 53 14 e3 a1 6e 22  2d e4 22 c9 a5 d2 cb e8  |..S...n"-.".....|
+00000070  89 35 4b e5 89 b8 20 44  1b 79 cc 83 41 42 a5 4f  |.5K... D.y..AB.O|
+00000080  38 be f4 20 c5 e6 2b 11  ad 3a                    |8.. ..+..:|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384 b/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384
index 42454d52f3..bedeedbb19 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384
+++ b/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 55 02 00 00  51 03 03 a3 a8 ef 9d b3  |....U...Q.......|
-00000010  36 14 00 fe 5b e4 07 77  e7 78 c8 b4 d8 96 8d 72  |6...[..w.x.....r|
-00000020  c5 79 99 10 8f 6e ac e3  fd 99 ee 20 53 99 57 36  |.y...n..... S.W6|
-00000030  7e 9b 89 a3 79 c7 57 c6  f6 c7 2c 66 0a 6b 48 a2  |~...y.W...,f.kH.|
-00000040  06 87 54 2c 20 3d 65 b9  1c 93 fd a3 00 9d 00 00  |..T, =e.........|
+00000000  16 03 03 00 55 02 00 00  51 03 03 ac 7e 0f a7 bc  |....U...Q...~...|
+00000010  e5 97 51 ac d1 a3 f4 e1  a4 a9 b3 52 08 ab cf cd  |..Q........R....|
+00000020  0a 2a 22 89 6e 7d c4 d4  4f 44 99 20 0f 86 62 46  |.*".n}..OD. ..bF|
+00000030  47 98 ce fc 9f ba ba 92  bf 17 dc 94 6f b4 05 ac  |G...........o...|
+00000040  81 87 89 14 c5 e1 c5 30  49 45 cf 7b 00 9d 00 00  |.......0IE.{....|
 00000050  09 ff 01 00 01 00 00 17  00 00 16 03 03 02 59 0b  |..............Y.|
 00000060  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
 00000070  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
@@ -72,17 +74,17 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 76 c9  |.....(........v.|
-000000a0  1e 50 43 51 5e 4a b6 c8  98 33 8f 18 ac f3 fe 20  |.PCQ^J...3..... |
-000000b0  09 76 7c 48 f7 e8 00 2c  3b e1 7e 2f 71 d5        |.v|H...,;.~/q.|
+00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 2a f2  |.....(........*.|
+000000a0  d8 f8 66 9b 53 99 66 59  83 4b 37 25 44 61 d8 c3  |..f.S.fY.K7%Da..|
+000000b0  ef 7f 3e be 62 9c a0 3a  61 43 0c 87 04 4c        |..>.b..:aC...L|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 55 b2 34 a3 b7  |..........(U.4..|
-00000010  18 a8 36 55 c4 ef 81 82  e4 41 9f 1a 42 2c 42 7e  |..6U.....A..B,B~|
-00000020  9b 59 c8 9d 3a 0b 59 a6  78 d0 ab 2f c4 e1 f7 2b  |.Y..:.Y.x../...+|
-00000030  9b ee 9f                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 28 7a 45 6a 5b 2a  |..........(zEj[*|
+00000010  06 e8 c8 f5 57 07 ee 91  dd f7 33 60 be f1 65 fb  |....W.....3`..e.|
+00000020  8f 3d 48 3c b2 a0 7c 30  30 b1 98 01 de 35 d2 5f  |.=H<..|00....5._|
+00000030  cb 0c de                                          |...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 ec ad 42  |...............B|
-00000010  8a cf 39 ed 82 b7 70 9b  1a 29 4c 3e b7 f6 92 35  |..9...p..)L>...5|
-00000020  12 e2 df 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
-00000030  81 d4 de 3c 03 a9 01 0e  e7 64 ae 18 84 dd d3 6c  |...<.....d.....l|
-00000040  57 6a                                             |Wj|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 13 f4 b8  |................|
+00000010  b3 95 de d6 9b b3 8e 27  6f 36 dc a4 0d ab 7d 63  |.......'o6....}c|
+00000020  35 73 a4 15 03 03 00 1a  00 00 00 00 00 00 00 02  |5s..............|
+00000030  9d 64 e3 e6 8f a7 22 ab  82 2f 60 0a 2a 5f fc 39  |.d...."../`.*_.9|
+00000040  90 93                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ALPN b/src/crypto/tls/testdata/Client-TLSv12-ALPN
index 9f3f4dc930..0cba50bd7a 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ALPN
+++ b/src/crypto/tls/testdata/Client-TLSv12-ALPN
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 12 01 00 01  0e 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 30 01 00 01  2c 03 03 00 00 00 00 00  |....0...,.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,22 +7,24 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 93 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 b1 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 10 00 10  |................|
-000000d0  00 0e 06 70 72 6f 74 6f  32 06 70 72 6f 74 6f 31  |...proto2.proto1|
-000000e0  00 2b 00 09 08 03 04 03  03 03 02 03 01 00 33 00  |.+............3.|
-000000f0  26 00 24 00 1d 00 20 2f  e5 7d a3 47 cd 62 43 15  |&.$... /.}.G.bC.|
-00000100  28 da ac 5f bb 29 07 30  ff f6 84 af c4 cf c2 ed  |(.._.).0........|
-00000110  90 99 5f 58 cb 3b 74                              |.._X.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 10 00 10 00 0e  |................|
+000000f0  06 70 72 6f 74 6f 32 06  70 72 6f 74 6f 31 00 2b  |.proto2.proto1.+|
+00000100  00 09 08 03 04 03 03 03  02 03 01 00 33 00 26 00  |............3.&.|
+00000110  24 00 1d 00 20 2f e5 7d  a3 47 cd 62 43 15 28 da  |$... /.}.G.bC.(.|
+00000120  ac 5f bb 29 07 30 ff f6  84 af c4 cf c2 ed 90 99  |._.).0..........|
+00000130  5f 58 cb 3b 74                                    |_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 6a 02 00 00  66 03 03 71 ba 32 f4 08  |....j...f..q.2..|
-00000010  31 23 ea 71 46 b6 f0 24  f9 80 c2 94 b8 13 f5 cc  |1#.qF..$........|
-00000020  6b 77 e5 46 f1 76 df a5  0c 56 6a 20 98 53 12 a3  |kw.F.v...Vj .S..|
-00000030  d2 a6 97 45 36 11 e6 b6  b6 6e 0b b9 30 2d 65 c8  |...E6....n..0-e.|
-00000040  47 c7 af 4c c5 a6 51 90  2f 77 db 8c cc a8 00 00  |G..L..Q./w......|
+00000000  16 03 03 00 6a 02 00 00  66 03 03 d7 20 92 e0 ec  |....j...f... ...|
+00000010  a0 c3 77 d9 a8 c8 fe 8f  df 7d ab 20 c4 e9 50 bd  |..w......}. ..P.|
+00000020  9c dc 33 4f ca 0b b1 b1  f4 93 cc 20 d7 5d 8b 7e  |..3O....... .].~|
+00000030  7e 45 21 86 05 21 77 d0  ed 6a 1c 5a f3 60 06 38  |~E!..!w..j.Z.`.8|
+00000040  43 de 49 df 9a 43 60 52  47 57 98 29 cc a8 00 00  |C.I..C`RGW.)....|
 00000050  1e ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 10  |................|
 00000060  00 09 00 07 06 70 72 6f  74 6f 31 00 17 00 00 16  |.....proto1.....|
 00000070  03 03 02 59 0b 00 02 55  00 02 52 00 02 4f 30 82  |...Y...U..R..O0.|
@@ -63,31 +65,31 @@
 000002a0  43 77 8d 0c 1c f1 0f a1  d8 40 83 61 c9 4c 72 2b  |Cw.......@.a.Lr+|
 000002b0  9d ae db 46 06 06 4d f4  c1 b3 3e c0 d1 bd 42 d4  |...F..M...>...B.|
 000002c0  db fe 3d 13 60 84 5c 21  d3 3b e9 fa e7 16 03 03  |..=.`.\!.;......|
-000002d0  00 ac 0c 00 00 a8 03 00  1d 20 76 16 ff 2a 83 9a  |......... v..*..|
-000002e0  07 b0 01 f6 1e 3e 4b c1  69 62 9b 00 38 35 c5 4f  |.....>K.ib..85.O|
-000002f0  d3 2c db 50 16 9d 26 b1  cc 28 08 04 00 80 56 73  |.,.P..&..(....Vs|
-00000300  39 4d ab f4 68 92 14 6d  d5 75 db 10 4b 0c a4 19  |9M..h..m.u..K...|
-00000310  9e 67 42 d3 f8 3f 91 26  06 4d f9 34 9b ad 7c 85  |.gB..?.&.M.4..|.|
-00000320  ec 11 34 43 dd 7d a8 5b  0f 59 54 ff a3 92 dc 7c  |..4C.}.[.YT....||
-00000330  26 ee 07 0e cf bc e4 6a  1a da b9 d2 9a 62 bf de  |&......j.....b..|
-00000340  37 a6 68 e2 cd 21 8e 4e  a3 66 ee e1 74 45 7d 64  |7.h..!.N.f..tE}d|
-00000350  b2 d8 1d dc 6a cd 2a 86  9e 0d 76 a3 7b f2 49 11  |....j.*...v.{.I.|
-00000360  ae ad a1 d4 f2 a9 e5 56  0e 2a 96 a5 f7 8b 74 d4  |.......V.*....t.|
-00000370  78 e0 bc cc 95 a1 f1 76  0b 4b 37 ed 77 1b 16 03  |x......v.K7.w...|
+000002d0  00 ac 0c 00 00 a8 03 00  1d 20 6c a6 83 3b fe d9  |......... l..;..|
+000002e0  f9 da 88 13 dc 34 f4 01  d4 49 a7 43 80 d7 e2 cf  |.....4...I.C....|
+000002f0  1d c9 eb 94 5a 6d 85 b5  1d 7c 08 04 00 80 d2 21  |....Zm...|.....!|
+00000300  1b 9a f4 26 ac 76 28 68  63 68 fe b5 9b e2 16 bb  |...&.v(hch......|
+00000310  fd a5 b7 85 3c f8 f9 da  49 d7 4f 62 c0 af 75 08  |....<...I.Ob..u.|
+00000320  47 3b 3a 48 26 c3 8e 13  25 08 1d 77 ce eb 30 e9  |G;:H&...%..w..0.|
+00000330  b4 2e cc 94 ca 8d b4 60  c6 92 ce 57 ba 1e 46 59  |.......`...W..FY|
+00000340  f6 76 61 da f2 59 79 da  87 08 22 1d 5a e9 1a b8  |.va..Yy...".Z...|
+00000350  9d 31 0f d9 db ab 49 80  d9 5c 20 ab ef 9e e1 4d  |.1....I..\ ....M|
+00000360  0c 69 9b 41 f2 dd 4d e9  ee ff d3 40 47 88 64 76  |.i.A..M....@G.dv|
+00000370  69 8e 3a a1 e0 68 00 6d  2f 95 b6 f9 64 12 16 03  |i.:..h.m/...d...|
 00000380  03 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 aa 8c 9c  ab fb ab ed 5b 2e 3e 4b  |.... .......[.>K|
-00000040  92 cd 18 dd ac ce af 1a  b9 f2 df aa 7f a1 d2 ad  |................|
-00000050  0e 8a 67 03 3f                                    |..g.?|
+00000030  16 03 03 00 20 d5 b6 10  b8 32 7d da 84 25 2b 18  |.... ....2}..%+.|
+00000040  78 a4 e3 6b 34 de b2 83  b6 94 12 f9 d2 9a 27 e5  |x..k4.........'.|
+00000050  ff ef a2 00 50                                    |....P|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 db cb 3a 73 0c  |.......... ..:s.|
-00000010  ab 16 44 41 5a 25 df f7  45 bf f0 70 c6 a8 4f bd  |..DAZ%..E..p..O.|
-00000020  50 99 fb 18 26 e7 cf 71  16 1a 96                 |P...&..q...|
+00000000  14 03 03 00 01 01 16 03  03 00 20 91 63 26 79 f6  |.......... .c&y.|
+00000010  6f fc 51 93 c5 9b e9 10  2e 80 f0 5f 6f 49 b8 a5  |o.Q........_oI..|
+00000020  53 d9 a6 2a 4a ec 4c 50  9f 1b 98                 |S..*J.LP...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 34 82 27  01 99 27 08 58 c4 aa 76  |.....4.'..'.X..v|
-00000010  fe 34 9c 1f 99 ea 4c f8  a0 ef 96 15 03 03 00 12  |.4....L.........|
-00000020  68 b8 da ac 77 d5 f7 95  9f 68 e0 d6 26 88 cd ef  |h...w....h..&...|
-00000030  31 d4                                             |1.|
+00000000  17 03 03 00 16 96 3e 1b  61 d9 00 1a e4 dc 49 cc  |......>.a.....I.|
+00000010  09 f8 b3 3e 21 c6 df 74  e2 6b a0 15 03 03 00 12  |...>!..t.k......|
+00000020  35 41 fc 32 06 30 3b ad  17 a4 19 3c 06 f9 59 e0  |5A.2.0;....<..Y.|
+00000030  d2 02                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA
index 55cff1d489..b3496cedd6 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 58 a7 ae 6c fc  |....]...Y..X..l.|
-00000010  0d 53 51 d5 37 8d 1f 88  75 27 bf 34 8f 3d d3 ee  |.SQ.7...u'.4.=..|
-00000020  95 db 77 d9 c0 3b f1 57  4f 84 e2 20 7f 0d d1 84  |..w..;.WO.. ....|
-00000030  0c 7a 4e 41 7f 74 58 6c  f5 38 e6 8d 5b 04 15 e1  |.zNA.tXl.8..[...|
-00000040  3d 4a ba 7e 58 f4 e8 bf  f4 42 8a f5 c0 09 00 00  |=J.~X....B......|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 c9 60 0f c9 c7  |....]...Y...`...|
+00000010  84 d4 8c 7b e8 33 a1 e2  cc 15 9b 13 21 e6 ff 3a  |...{.3......!..:|
+00000020  72 2a d2 6b 18 bd 7b aa  4c 95 7f 20 f2 dd 03 c8  |r*.k..{.L.. ....|
+00000030  a9 e6 f0 20 b4 72 81 71  ea 10 ca b1 9f 4b 86 96  |... .r.q.....K..|
+00000040  27 b5 d4 6a 6a 35 2f d5  5a f6 75 96 c0 09 00 00  |'..jj5/.Z.u.....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
 00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
@@ -57,17 +59,17 @@
 00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
 00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
 00000270  95 12 07 8f 2a 16 03 03  00 b6 0c 00 00 b2 03 00  |....*...........|
-00000280  1d 20 b2 5c fe 84 12 a5  2f 8f da 91 3f 44 52 4e  |. .\..../...?DRN|
-00000290  03 ad e4 f9 8a 14 71 0d  0b 46 86 81 d2 1b 4a 5b  |......q..F....J[|
-000002a0  d9 4e 04 03 00 8a 30 81  87 02 42 01 78 d2 c2 a9  |.N....0...B.x...|
-000002b0  b7 77 f8 eb 8d 9d 36 1f  79 e7 d1 74 a9 9d a4 53  |.w....6.y..t...S|
-000002c0  5e 08 4a 92 dc ac b3 32  bf ce e7 f0 80 af 56 48  |^.J....2......VH|
-000002d0  42 e2 fd 22 c7 35 11 13  db 2a 6d 74 4a e5 02 ce  |B..".5...*mtJ...|
-000002e0  ea 43 e6 b0 69 18 3e d3  86 85 76 ff 56 02 41 44  |.C..i.>...v.V.AD|
-000002f0  2a e1 6b ae 5d f9 39 5c  ec 76 ee 01 d7 04 42 ca  |*.k.].9\.v....B.|
-00000300  45 07 e0 59 38 75 d4 47  61 a4 5b 0f a9 7a ba 79  |E..Y8u.Ga.[..z.y|
-00000310  fa 79 92 41 88 8a d3 be  c2 38 3e f7 95 6c 99 3f  |.y.A.....8>..l.?|
-00000320  4c ff af 10 33 14 25 e0  d7 8a fd 70 17 2b 73 ee  |L...3.%....p.+s.|
+00000280  1d 20 fc dd 1d af 2f 7d  77 03 42 8b e4 01 fd 0c  |. ..../}w.B.....|
+00000290  82 3b f8 16 d7 15 cc ce  97 b4 6b ab 78 b6 c4 d5  |.;........k.x...|
+000002a0  78 0a 04 03 00 8a 30 81  87 02 42 01 b1 31 15 d3  |x.....0...B..1..|
+000002b0  f9 0d 44 57 cc d7 d3 a8  08 91 19 ac fd 6d cf f3  |..DW.........m..|
+000002c0  59 87 59 d5 a3 9b 9f 41  0c a6 9d 2f 30 df 97 2c  |Y.Y....A.../0..,|
+000002d0  e5 04 58 a4 06 b6 67 ba  19 84 5e c5 28 cd a6 29  |..X...g...^.(..)|
+000002e0  c7 56 78 ba b5 4f d6 95  34 4c 5f e9 b7 02 41 30  |.Vx..O..4L_...A0|
+000002f0  cb d1 6b 75 7a 78 62 06  13 76 49 a7 cb 05 d1 1d  |..kuzxb..vI.....|
+00000300  14 79 39 e8 80 57 0c ba  52 41 ba 4d c1 82 3b 94  |.y9..W..RA.M..;.|
+00000310  d2 0f 0c 90 9b fa 32 03  7a 53 b5 c9 6b bc 3d 0e  |......2.zS..k.=.|
+00000320  01 2d b2 ca d3 0e b4 45  1a b3 ec 07 b8 ad 28 03  |.-.....E......(.|
 00000330  16 03 03 00 3a 0d 00 00  36 03 01 02 40 00 2e 04  |....:...6...@...|
 00000340  03 05 03 06 03 08 07 08  08 08 09 08 0a 08 0b 08  |................|
 00000350  04 08 05 08 06 04 01 05  01 06 01 03 03 02 03 03  |................|
@@ -110,31 +112,31 @@
 00000210  03 03 00 25 10 00 00 21  20 2f e5 7d a3 47 cd 62  |...%...! /.}.G.b|
 00000220  43 15 28 da ac 5f bb 29  07 30 ff f6 84 af c4 cf  |C.(.._.).0......|
 00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 03 00 92 0f 00  |...._X.;t.......|
-00000240  00 8e 04 03 00 8a 30 81  87 02 41 0c 11 31 08 e0  |......0...A..1..|
-00000250  7d 4e 11 1e 80 7c 50 70  ea 1b 68 16 d9 e6 93 b7  |}N...|Pp..h.....|
-00000260  fb 6f 0d 6e ce 8b d2 7c  86 70 c3 e9 ed 35 3c 29  |.o.n...|.p...5<)|
-00000270  c7 d8 6c 8f 43 c9 a1 7a  4a ae 19 22 6e e3 85 7e  |..l.C..zJ.."n..~|
-00000280  a0 5d 7f 19 a5 b7 25 ad  d7 1a 5f 42 02 42 00 d8  |.]....%..._B.B..|
-00000290  6a 25 47 2a 0e 1a 38 51  1c 73 aa 2d 10 9e 4b 65  |j%G*..8Q.s.-..Ke|
-000002a0  56 34 72 e5 02 09 f6 30  ce a8 a0 59 75 7b 13 42  |V4r....0...Yu{.B|
-000002b0  1e 31 f3 dd 08 a9 65 df  2d e6 aa 29 5d 9a 5c eb  |.1....e.-..)].\.|
-000002c0  d3 67 af 29 4e d2 76 e5  17 1d 7e e7 0a 50 c4 d0  |.g.)N.v...~..P..|
+00000240  00 8e 04 03 00 8a 30 81  87 02 41 5f 38 d1 e6 8e  |......0...A_8...|
+00000250  cd f7 6b 2e 50 d9 e5 40  3a ba e7 67 5d a9 5a 83  |..k.P..@:..g].Z.|
+00000260  c1 9e 45 e7 c2 bc f6 a2  c0 d8 3e ca f6 48 44 72  |..E.......>..HDr|
+00000270  8b c6 e6 24 e4 aa 90 ff  81 10 c5 86 08 64 d4 30  |...$.........d.0|
+00000280  e7 27 e2 9b 66 b9 c8 30  3b 3d 61 51 02 42 01 3b  |.'..f..0;=aQ.B.;|
+00000290  a1 0b 55 d0 2b 23 90 0c  5a 14 9b f4 2b 04 f4 b3  |..U.+#..Z...+...|
+000002a0  b1 9d 6f 86 17 67 3d c1  9d 64 e6 d7 c6 54 eb 99  |..o..g=..d...T..|
+000002b0  51 83 df c9 df 41 48 b8  bc 8f 6c c9 bc 0a 36 0f  |Q....AH...l...6.|
+000002c0  c9 34 70 3a d5 82 5e 42  4f 22 64 23 33 fc e2 d3  |.4p:..^BO"d#3...|
 000002d0  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-000002e0  00 00 00 00 00 00 00 00  00 00 00 8b ef 24 70 ef  |.............$p.|
-000002f0  b9 b3 fd 59 49 62 b7 18  9c bc 7f 74 06 21 21 ab  |...YIb.....t.!!.|
-00000300  9c 4d cf 70 0c 6b 3b d3  d4 12 51 a7 f9 09 65 d1  |.M.p.k;...Q...e.|
-00000310  ce b7 28 01 c1 e9 0b e4  41 55 b6                 |..(.....AU.|
+000002e0  00 00 00 00 00 00 00 00  00 00 00 13 d5 c1 91 72  |...............r|
+000002f0  5e 32 35 1d c1 a2 d2 62  80 16 71 ea f9 67 d5 8d  |^25....b..q..g..|
+00000300  1d 98 a5 87 15 1b 7e 2a  80 a7 08 a2 c1 82 79 d2  |......~*......y.|
+00000310  60 e3 d5 8f 0b 9b 43 4f  88 09 7d                 |`.....CO..}|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 af 82 f6 ba d1  |..........@.....|
-00000010  e8 f9 c5 58 0e ba 94 ec  98 68 b3 20 5b db 4e 8c  |...X.....h. [.N.|
-00000020  f5 00 29 e8 9a c1 34 35  ac 77 af e2 a0 6a 6f 45  |..)...45.w...joE|
-00000030  05 56 d4 a0 5b 75 19 c6  1b 8a c8 65 04 ed 3d f3  |.V..[u.....e..=.|
-00000040  84 e5 1b c0 26 31 5d 03  d5 b4 31                 |....&1]...1|
+00000000  14 03 03 00 01 01 16 03  03 00 40 8a f4 68 76 16  |..........@..hv.|
+00000010  0d 13 09 2a e5 3f 25 87  0f ce 03 96 2a 86 58 41  |...*.?%.....*.XA|
+00000020  7a 40 ec 65 ff c5 64 c1  62 6e ae 1d bf b6 4e dd  |z@.e..d.bn....N.|
+00000030  f6 be 55 56 ba 43 b3 c5  3a 6f 35 e6 73 59 63 87  |..UV.C..:o5.sYc.|
+00000040  fd 10 64 b1 94 e3 a9 b7  2d e0 94                 |..d.....-..|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 2e a5 7c  6f cc f7 44 1a 38 99 4a  |.......|o..D.8.J|
-00000020  2e a4 4b 79 bf ee b6 c9  12 57 f5 2e 98 dd 1d 2a  |..Ky.....W.....*|
-00000030  5b 79 d5 ef 44 15 03 03  00 30 00 00 00 00 00 00  |[y..D....0......|
-00000040  00 00 00 00 00 00 00 00  00 00 3d fe 37 cb 65 03  |..........=.7.e.|
-00000050  13 ce 3d 3b c2 18 c2 27  f9 a4 b7 fc e6 37 eb 2a  |..=;...'.....7.*|
-00000060  27 6c 52 38 2f 3a 61 d4  a9 e6                    |'lR8/:a...|
+00000010  00 00 00 00 00 15 82 4f  fa 8d ce 67 fd 63 bb 74  |.......O...g.c.t|
+00000020  98 2f 77 fc 5b 43 70 4d  15 cf 5b 2b 45 ae e7 b3  |./w.[CpM..[+E...|
+00000030  d0 dd ae 4b 27 15 03 03  00 30 00 00 00 00 00 00  |...K'....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 d2 ce b2 c5 1a 62  |...............b|
+00000050  06 9c c1 1e 6f 1e b7 6e  18 5e 74 45 be 10 b7 69  |....o..n.^tE...i|
+00000060  6d da 09 65 3c 38 a5 3d  f1 0a                    |m..e<8.=..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA
index de57515d38..7356bfebfc 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 f8 3d 7c a4 a8  |....]...Y...=|..|
-00000010  11 e3 56 0f 1c 7e 2e 7c  50 7e 75 5c de 1c 51 8e  |..V..~.|P~u\..Q.|
-00000020  de d3 8a 84 d2 90 84 f9  e9 07 d5 20 98 6a a8 c1  |........... .j..|
-00000030  f4 28 bd 0f 6a 25 a5 26  3d 8d 35 b6 3e bb 77 c6  |.(..j%.&=.5.>.w.|
-00000040  8e ab 36 bd 7d c8 a9 b1  5b 30 0f b2 c0 2f 00 00  |..6.}...[0.../..|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 26 62 0d 9d 45  |....]...Y..&b..E|
+00000010  3d 25 b7 ed ec ce b8 d6  8f fd a6 68 0b 07 05 28  |=%.........h...(|
+00000020  d4 2a 9c d9 cf bf e9 a0  92 71 6f 20 18 af a0 13  |.*.......qo ....|
+00000030  72 10 57 69 cf 63 db 73  c4 44 b8 a9 27 cd 9a a0  |r.Wi.c.s.D..'...|
+00000040  3b be f1 57 ef 10 19 80  0b c0 51 94 c0 2f 00 00  |;..W......Q../..|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -61,18 +63,18 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 5f c1 31  |............ _.1|
-000002d0  d7 64 f0 0b 72 6a 66 2c  49 d7 d1 9c dd 6f e3 3a  |.d..rjf,I....o.:|
-000002e0  ab 2c 78 6d ca b0 ed 16  26 65 9f ff 66 08 04 00  |.,xm....&e..f...|
-000002f0  80 a6 91 d0 03 b8 d2 67  48 69 16 8e 30 dc 5b 3f  |.......gHi..0.[?|
-00000300  ac 4d e4 33 5f 46 e7 0c  49 a0 71 9d 8c 60 63 f2  |.M.3_F..I.q..`c.|
-00000310  2d ff 9e 89 21 7d af 71  ce 41 6b d2 22 fc 1f bd  |-...!}.q.Ak."...|
-00000320  a9 9e 15 2c d7 c3 cb 69  6d df 23 07 7c 13 e9 2b  |...,...im.#.|..+|
-00000330  7d 05 f0 18 1e 86 c8 37  ad cd 9e 39 26 0c 8a 9b  |}......7...9&...|
-00000340  12 90 60 12 95 06 e9 bb  f2 46 41 20 10 f5 64 ea  |..`......FA ..d.|
-00000350  66 13 cb 8e 51 7e 41 78  2a 40 fa 15 e2 0d 5b 37  |f...Q~Ax*@....[7|
-00000360  a7 a8 4a f6 8e 93 82 2a  a2 91 06 66 4e 49 72 68  |..J....*...fNIrh|
-00000370  f9 16 03 03 00 3a 0d 00  00 36 03 01 02 40 00 2e  |.....:...6...@..|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 22 fe 67  |............ ".g|
+000002d0  48 d3 90 04 ee 7d c2 2a  6d 9f 3a 36 3c b2 f8 14  |H....}.*m.:6<...|
+000002e0  24 76 54 5a ae ed 2f 62  fc 76 e0 00 07 08 04 00  |$vTZ../b.v......|
+000002f0  80 6d 8b e6 52 be ed 40  b8 b1 51 53 94 08 93 76  |.m..R..@..QS...v|
+00000300  9b 84 06 66 60 b9 be a8  f1 bb 5d fa 81 42 28 8e  |...f`.....]..B(.|
+00000310  aa ce 72 9f df a3 53 2d  c9 6d 34 10 78 36 da 33  |..r...S-.m4.x6.3|
+00000320  09 0c a0 5e ea 56 2e 6f  62 fc 3c 5e 5b 6d 97 c9  |...^.V.ob.<^[m..|
+00000330  39 1b 3c eb 6d 1f 0a b5  02 06 6d 9e 99 24 14 ee  |9.<.m.....m..$..|
+00000340  f9 55 cc 4d 7f 77 0c 58  2c 59 0f a4 66 4b 81 b4  |.U.M.w.X,Y..fK..|
+00000350  d9 e4 f6 24 4f ba 05 83  6c c3 6c 2f 5e 74 42 09  |...$O...l.l/^tB.|
+00000360  b3 be d1 c9 6a c8 a6 34  5c bc 36 65 58 cd 02 ae  |....j..4\.6eX...|
+00000370  16 16 03 03 00 3a 0d 00  00 36 03 01 02 40 00 2e  |.....:...6...@..|
 00000380  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000390  08 04 08 05 08 06 04 01  05 01 06 01 03 03 02 03  |................|
 000003a0  03 01 02 01 03 02 02 02  04 02 05 02 06 02 00 00  |................|
@@ -113,28 +115,28 @@
 00000200  e4 fa cc b1 8a ce e2 23  a0 87 f0 e1 67 51 eb 16  |.......#....gQ..|
 00000210  03 03 00 25 10 00 00 21  20 2f e5 7d a3 47 cd 62  |...%...! /.}.G.b|
 00000220  43 15 28 da ac 5f bb 29  07 30 ff f6 84 af c4 cf  |C.(.._.).0......|
-00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 03 00 93 0f 00  |...._X.;t.......|
-00000240  00 8f 04 03 00 8b 30 81  88 02 42 01 0f 51 5e 59  |......0...B..Q^Y|
-00000250  78 34 8f 99 03 da 07 66  3b 0d 48 b2 79 57 e2 d5  |x4.....f;.H.yW..|
-00000260  d2 c2 f3 81 8e 25 98 81  e2 9a f7 1f 02 99 b0 7d  |.....%.........}|
-00000270  1c d1 1f e4 ef d7 bc a1  ad 67 c7 a9 cc 4f 67 58  |.........g...OgX|
-00000280  8b 1e 8c 3f 04 73 31 53  60 aa 67 33 27 02 42 01  |...?.s1S`.g3'.B.|
-00000290  f1 66 ba 8f ec 9e 3f 76  76 ac 7a e7 56 cb fb 46  |.f....?vv.z.V..F|
-000002a0  f4 9b 64 03 3a 72 5a d7  cf 49 39 69 26 19 68 52  |..d.:rZ..I9i&.hR|
-000002b0  8b 98 8e ea d3 8e d9 6d  93 f5 e8 23 cd 20 a8 5a  |.......m...#. .Z|
-000002c0  4c 24 10 70 bd a2 ae a3  b1 4f 38 17 dd b9 f5 93  |L$.p.....O8.....|
-000002d0  4b 14 03 03 00 01 01 16  03 03 00 28 00 00 00 00  |K..........(....|
-000002e0  00 00 00 00 e1 2b da c6  4a 5c d2 03 c0 7e f0 eb  |.....+..J\...~..|
-000002f0  a0 4b ed a1 7d e4 45 93  ec f9 37 a0 5b 7e bb 64  |.K..}.E...7.[~.d|
-00000300  af d4 fc ac                                       |....|
+00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 03 00 92 0f 00  |...._X.;t.......|
+00000240  00 8e 04 03 00 8a 30 81  87 02 42 00 8e 41 5f 48  |......0...B..A_H|
+00000250  64 4e 6e 7e 7d ed 5b da  88 7a 38 1f bd 04 ee 93  |dNn~}.[..z8.....|
+00000260  88 f8 3d e5 b7 51 4a 43  6b c5 c1 02 06 c5 2c c1  |..=..QJCk.....,.|
+00000270  48 18 2e 11 63 8a 9d 94  35 98 bc d1 d7 19 1f c0  |H...c...5.......|
+00000280  f6 dc 10 15 89 bf 99 0c  87 7d 3e bf e2 02 41 4f  |.........}>...AO|
+00000290  e3 d4 a0 b2 4d 80 ec 21  2f b3 fc df 6c b7 bd 6d  |....M..!/...l..m|
+000002a0  c7 6d 0a 7a 24 56 a4 c8  36 ec 7d 2d 65 ff 8c 4b  |.m.z$V..6.}-e..K|
+000002b0  c7 cd 52 99 f1 2d e5 19  57 89 fe 52 44 ca e0 c3  |..R..-..W..RD...|
+000002c0  34 fc c5 4a da 59 f5 62  eb c4 c5 cb 1d d7 4b 63  |4..J.Y.b......Kc|
+000002d0  14 03 03 00 01 01 16 03  03 00 28 00 00 00 00 00  |..........(.....|
+000002e0  00 00 00 5d 34 16 3d d0  04 3f b7 3d a2 be 20 8b  |...]4.=..?.=.. .|
+000002f0  19 20 09 7b f0 7e 52 95  e6 b8 f1 06 08 93 6b 91  |. .{.~R.......k.|
+00000300  ee fa c8                                          |...|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 d3 4a 1e 2b ea  |..........(.J.+.|
-00000010  26 12 c9 fd b0 7b e6 bf  e4 bb b6 d2 6b b4 3c 05  |&....{......k.<.|
-00000020  1f 6c 46 44 5e 25 e6 f9  80 c8 b9 16 19 59 68 90  |.lFD^%.......Yh.|
-00000030  5a 90 16                                          |Z..|
+00000000  14 03 03 00 01 01 16 03  03 00 28 c1 1c 19 bc 14  |..........(.....|
+00000010  d3 44 ec 5d 6e 84 c4 06  ba c2 83 00 80 ea dd 7d  |.D.]n..........}|
+00000020  9b 2e 75 c7 9d 75 40 e8  89 d1 9b 69 16 20 0b 23  |..u..u@....i. .#|
+00000030  94 48 42                                          |.HB|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 35 25 df  |.............5%.|
-00000010  1f 16 81 00 e3 c4 9e 45  e2 a1 ef 54 72 66 99 3d  |.......E...Trf.=|
-00000020  30 13 25 15 03 03 00 1a  00 00 00 00 00 00 00 02  |0.%.............|
-00000030  16 a5 e9 36 c1 fb 02 d7  c8 7a aa bc aa 77 7b 5c  |...6.....z...w{\|
-00000040  4f a1                                             |O.|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 20 ce 1a  |............. ..|
+00000010  b6 65 88 6d 17 9e 9c 9d  ec 36 af d3 7e fa e5 63  |.e.m.....6..~..c|
+00000020  bc 90 f0 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
+00000030  e5 a6 0e 68 bc 75 29 7e  c1 ee 6b 3b d3 03 c8 0a  |...h.u)~..k;....|
+00000040  4d 75                                             |Mu|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-Ed25519 b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-Ed25519
index edb433fefc..e4e47030dd 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-Ed25519
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-Ed25519
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 68 ad d5 4c 88  |....]...Y..h..L.|
-00000010  60 b8 3b b4 ea e4 f2 55  7d 0f 90 d8 bd 55 b5 53  |`.;....U}....U.S|
-00000020  49 6e f7 50 e4 05 70 a2  6d 9e a5 20 d1 0a e5 58  |In.P..p.m.. ...X|
-00000030  38 f1 82 94 a7 c3 bf 77  60 d8 51 c2 c7 e9 8e d6  |8......w`.Q.....|
-00000040  94 ee 4f 23 51 d3 2c 52  06 12 4b 4a cc a8 00 00  |..O#Q.,R..KJ....|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 73 ca 08 75 98  |....]...Y..s..u.|
+00000010  14 2e b6 c4 c0 74 e2 cf  05 24 dd 70 f4 aa 22 08  |.....t...$.p..".|
+00000020  39 6d 3a 61 11 90 c6 61  50 41 96 20 d1 c7 24 aa  |9m:a...aPA. ..$.|
+00000030  3a 5e 0c 2c 37 72 8c 80  76 ab c9 2f fb a5 39 7d  |:^.,7r..v../..9}|
+00000040  f5 f3 ce 97 d8 ea e5 4c  db 1b f8 f6 cc a8 00 00  |.......L........|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -61,18 +63,18 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 4e 55 f3  |............ NU.|
-000002d0  5f 83 c8 88 d4 f2 5c 75  6a ab 0e 25 df 12 ef f0  |_.....\uj..%....|
-000002e0  ea e9 3e b4 4f 2c cd bb  43 5b 64 21 12 08 04 00  |..>.O,..C[d!....|
-000002f0  80 84 5e ca 36 b2 fa d0  29 47 1c c2 de 4e 1d 81  |..^.6...)G...N..|
-00000300  14 66 0a 26 6f 21 5f d5  b5 54 2e 37 f1 7e b1 90  |.f.&o!_..T.7.~..|
-00000310  a0 57 ab 40 81 cf e5 77  29 23 54 fa 12 76 1a 4a  |.W.@...w)#T..v.J|
-00000320  66 c0 52 08 07 3c 3c 56  06 08 02 df 9f 75 75 5e  |f.R..<<V.....uu^|
-00000330  0c d7 23 d5 b5 76 83 64  1f c2 9c dd 7d b0 c8 91  |..#..v.d....}...|
-00000340  b6 7b 25 38 e0 27 31 be  7d 62 52 b6 91 3c 21 5c  |.{%8.'1.}bR..<!\|
-00000350  25 84 85 0a 8d 9a e3 59  67 ba d7 5f 54 df 06 10  |%......Yg.._T...|
-00000360  56 1e 04 f1 b1 45 32 e6  0d 0a 26 ce 24 ae 85 ae  |V....E2...&.$...|
-00000370  2b 16 03 03 00 3a 0d 00  00 36 03 01 02 40 00 2e  |+....:...6...@..|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 35 1f 14  |............ 5..|
+000002d0  77 42 a0 9c 04 14 f7 8b  df e5 b5 e7 71 40 34 4f  |wB..........q@4O|
+000002e0  f5 0d ab c2 2f 38 97 46  3e c2 57 26 7d 08 04 00  |..../8.F>.W&}...|
+000002f0  80 9d d7 8c 28 d8 a8 6c  a8 14 5d 92 f8 59 ab e5  |....(..l..]..Y..|
+00000300  bd e3 32 1e 49 f6 e6 11  11 ce eb 0c e1 27 3c 34  |..2.I........'<4|
+00000310  8c 94 a9 e9 8f 41 51 64  c2 6c 1c d0 e7 d4 ee cf  |.....AQd.l......|
+00000320  4f 9c f4 92 0f e5 48 c5  2b b5 82 79 c3 91 ee f9  |O.....H.+..y....|
+00000330  1c a6 b2 ee ec 9d 73 7c  df 2d 2b 49 c8 27 c7 cf  |......s|.-+I.'..|
+00000340  79 b4 6a 39 f6 ac fe 6f  fd f4 6c 7d 2c f2 7f 58  |y.j9...o..l},..X|
+00000350  2f a3 d4 f5 92 83 5b 83  19 55 39 e5 f8 d2 2c fd  |/.....[..U9...,.|
+00000360  ad 89 32 90 ba 89 cd 0d  ed 16 02 96 92 bd 77 d2  |..2...........w.|
+00000370  f3 16 03 03 00 3a 0d 00  00 36 03 01 02 40 00 2e  |.....:...6...@..|
 00000380  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000390  08 04 08 05 08 06 04 01  05 01 06 01 03 03 02 03  |................|
 000003a0  03 01 02 01 03 02 02 02  04 02 05 02 06 02 00 00  |................|
@@ -101,20 +103,20 @@
 00000140  08 16 03 03 00 25 10 00  00 21 20 2f e5 7d a3 47  |.....%...! /.}.G|
 00000150  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
 00000160  c4 cf c2 ed 90 99 5f 58  cb 3b 74 16 03 03 00 48  |......_X.;t....H|
-00000170  0f 00 00 44 08 07 00 40  70 0a 4f 7d dc c7 4a 7a  |...D...@p.O}..Jz|
-00000180  aa 47 45 8e be a6 df 02  14 c0 a0 f9 b9 a5 47 eb  |.GE...........G.|
-00000190  3b d3 6f 38 17 aa 5c 48  d5 33 10 41 af 08 2c 2c  |;.o8..\H.3.A..,,|
-000001a0  86 60 85 d4 22 c0 86 b2  48 1a 9c 31 78 86 7f bf  |.`.."...H..1x...|
-000001b0  3f 42 cb 04 3d 1b f7 0b  14 03 03 00 01 01 16 03  |?B..=...........|
-000001c0  03 00 20 32 0c bb 8e f7  d5 fa a3 f3 9a 2a d1 1f  |.. 2.........*..|
-000001d0  ed 4b e3 56 ab b3 bc f9  72 ad 7c 3a 8e d2 d7 2f  |.K.V....r.|:.../|
-000001e0  a2 99 46                                          |..F|
+00000170  0f 00 00 44 08 07 00 40  a1 8a 00 6d 57 47 ab a4  |...D...@...mWG..|
+00000180  ae 93 3e dd 04 fb 04 3b  dd b7 de 93 bc 2e 40 ff  |..>....;......@.|
+00000190  29 fa d0 f7 63 4e b9 5f  1f d9 5d 8c 87 eb bb 43  |)...cN._..]....C|
+000001a0  25 e5 a7 04 8d 16 88 f8  8b 0d 17 d1 ef 75 7c f1  |%............u|.|
+000001b0  1a b4 8f 2f cd f1 18 00  14 03 03 00 01 01 16 03  |.../............|
+000001c0  03 00 20 b2 95 81 2d 8c  06 f0 54 da ef 31 9a 33  |.. ...-...T..1.3|
+000001d0  89 c3 b5 e8 6a 77 3c fe  e8 e3 d0 24 94 2d 7e f9  |....jw<....$.-~.|
+000001e0  08 d4 ce                                          |...|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 10 cb 1b e5 55  |.......... ....U|
-00000010  64 49 55 0a bf 25 e4 b0  d0 45 e1 47 b0 05 d0 f2  |dIU..%...E.G....|
-00000020  41 b7 f4 6a 84 4e 6a 66  8d 0e 43                 |A..j.Njf..C|
+00000000  14 03 03 00 01 01 16 03  03 00 20 b3 9b 27 5a 1e  |.......... ..'Z.|
+00000010  ce 80 3c 04 f7 aa 69 b6  6b 37 9a 86 e9 95 ce 73  |..<...i.k7.....s|
+00000020  8a ef 38 62 6f cb a0 0e  45 78 ad                 |..8bo...Ex.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 4a f3 ed  07 22 0d 7d 9b a6 a8 3c  |.....J...".}...<|
-00000010  88 58 f3 48 c2 f1 aa ea  c7 cd 14 15 03 03 00 12  |.X.H............|
-00000020  0b 1d 53 98 b3 69 99 e1  cd 4f 37 3c dc 63 17 9f  |..S..i...O7<.c..|
-00000030  00 7f                                             |..|
+00000000  17 03 03 00 16 bf 78 66  da 5b a7 fd cf 95 32 20  |......xf.[....2 |
+00000010  b6 ce 1e 5d 4f 21 05 6a  f7 3a 27 15 03 03 00 12  |...]O!.j.:'.....|
+00000020  42 e1 e3 e3 d3 5a 98 8c  d1 e3 ce a5 02 f9 58 ba  |B....Z........X.|
+00000030  ce 33                                             |.3|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384 b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384
index c6673f6dc0..0fb7a12f70 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 60 13 bb 4b ce  |....]...Y..`..K.|
-00000010  d6 49 3b b2 3a 0c d4 5a  e8 25 26 67 41 fd dd 0f  |.I;.:..Z.%&gA...|
-00000020  62 ec c1 ab bc 58 92 67  9d 71 fd 20 20 4c ab 4d  |b....X.g.q.  L.M|
-00000030  85 ce 87 49 68 8c cf 9c  2f 7b f9 2b 96 62 8a 75  |...Ih.../{.+.b.u|
-00000040  c3 21 05 c6 ab b6 98 5e  e7 e5 d8 4a c0 30 00 00  |.!.....^...J.0..|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 e8 4b b6 f9 1c  |....]...Y...K...|
+00000010  d9 59 e0 86 7b 9b cf 37  9f 0c f2 14 51 de 10 66  |.Y..{..7....Q..f|
+00000020  39 05 15 ab 17 25 df 89  d7 5b 41 20 e5 28 ba da  |9....%...[A .(..|
+00000030  29 8c 72 40 14 7e 06 2d  f8 04 6d 4d 37 09 62 9a  |).r@.~.-..mM7.b.|
+00000040  87 f7 52 fc 77 61 05 04  2f 65 c0 df c0 30 00 00  |..R.wa../e...0..|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -61,18 +63,18 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 85 c8 0e  |............ ...|
-000002d0  fb 1e b3 4a ec c1 b2 3a  b8 4e bb a1 ca 80 8e 13  |...J...:.N......|
-000002e0  f5 08 b5 9a b8 3e c4 6c  23 cf 17 a0 31 08 04 00  |.....>.l#...1...|
-000002f0  80 28 db ec 9d f9 f4 9a  06 12 8a 32 89 11 4a e5  |.(.........2..J.|
-00000300  b6 68 98 21 ec f1 75 9c  f9 28 bc b1 99 5b ec 77  |.h.!..u..(...[.w|
-00000310  37 8b 6b 05 ad b3 10 de  24 05 84 a4 16 fe 1d 84  |7.k.....$.......|
-00000320  af 5d 28 7d d7 bc de 2f  81 da a3 79 fb c0 a5 43  |.](}.../...y...C|
-00000330  b6 3b 8d 90 30 00 80 98  16 83 ac 50 43 c7 3e 76  |.;..0......PC.>v|
-00000340  c5 dc 85 c2 19 75 a6 90  f8 2f 71 40 d9 a0 73 7e  |.....u.../q@..s~|
-00000350  fe 3b 1c d7 66 73 0f f0  42 c5 00 b1 2b be 41 2b  |.;..fs..B...+.A+|
-00000360  40 da 8f b0 f1 9e b0 0a  83 23 04 80 fb 4c fe 7e  |@........#...L.~|
-00000370  b4 16 03 03 00 3a 0d 00  00 36 03 01 02 40 00 2e  |.....:...6...@..|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 57 e9 2a  |............ W.*|
+000002d0  eb ac 52 cf 39 70 0a c3  21 38 2d 46 66 c1 df 26  |..R.9p..!8-Ff..&|
+000002e0  38 ad b2 19 d5 a9 f5 37  15 f7 f6 dc 54 08 04 00  |8......7....T...|
+000002f0  80 35 c5 7a 73 5f 36 ed  72 f9 2d 21 a9 9f 94 3f  |.5.zs_6.r.-!...?|
+00000300  98 de 22 b1 35 c1 9d e2  d2 42 bb 32 7a f3 11 0e  |..".5....B.2z...|
+00000310  f7 3c a0 ca 44 87 95 e6  f3 1a 19 45 51 a8 f5 f2  |.<..D......EQ...|
+00000320  fe ac 00 d0 fc 79 a8 a9  83 fe 81 48 e9 f7 48 ce  |.....y.....H..H.|
+00000330  08 8c 45 3c 24 b5 d4 e0  07 17 d1 f0 fa 3d 13 3c  |..E<$........=.<|
+00000340  ef f5 7b f2 5a c2 9a 60  af de 8e 74 50 c7 df b0  |..{.Z..`...tP...|
+00000350  27 ef 0e dd db 6a 8f a4  94 69 f0 08 7e 3c 3c 93  |'....j...i..~<<.|
+00000360  03 f9 67 ad 30 0b e6 d7  f0 c0 77 bd c4 1a 6e b4  |..g.0.....w...n.|
+00000370  52 16 03 03 00 3a 0d 00  00 36 03 01 02 40 00 2e  |R....:...6...@..|
 00000380  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000390  08 04 08 05 08 06 04 01  05 01 06 01 03 03 02 03  |................|
 000003a0  03 01 02 01 03 02 02 02  04 02 05 02 06 02 00 00  |................|
@@ -113,26 +115,26 @@
 00000200  e5 35 16 03 03 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
 00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 03 00  |......._X.;t....|
-00000230  88 0f 00 00 84 08 04 00  80 41 83 55 9b 3c 8d 29  |.........A.U.<.)|
-00000240  ed 6c 58 91 85 cb 9b 19  df 61 09 d0 d3 73 fb 2b  |.lX......a...s.+|
-00000250  3b 4b 4b bd 64 7e e6 53  87 cb 6d 2f 78 1c 67 cf  |;KK.d~.S..m/x.g.|
-00000260  13 21 e0 ec 1b d7 d8 aa  06 a0 0e d5 86 6f ba 1e  |.!...........o..|
-00000270  97 e2 8c 9b 86 e2 8a 4d  62 1a bd 35 0e 2d 63 18  |.......Mb..5.-c.|
-00000280  a1 1f 7c ed fc 3b 89 c2  00 6d da 01 42 0a 47 95  |..|..;...m..B.G.|
-00000290  12 8e 01 82 62 58 f9 96  eb a9 aa c3 f8 96 ec 20  |....bX......... |
-000002a0  e1 65 a9 46 a8 af 4b 7c  aa 29 ee 9c 48 18 b3 4a  |.e.F..K|.)..H..J|
-000002b0  00 7f 79 97 87 27 92 ca  45 14 03 03 00 01 01 16  |..y..'..E.......|
-000002c0  03 03 00 28 00 00 00 00  00 00 00 00 da f3 01 f2  |...(............|
-000002d0  76 e2 df 95 82 0d cc 0c  7e b0 cc 15 69 ba 8c 64  |v.......~...i..d|
-000002e0  ac dc f3 45 58 a3 8f ed  f0 2a 43 ce              |...EX....*C.|
+00000230  88 0f 00 00 84 08 04 00  80 ac ba b5 9f a6 2e 81  |................|
+00000240  fa c5 95 f7 27 e6 1c 54  80 51 1f 98 c6 bd 54 79  |....'..T.Q....Ty|
+00000250  ca 24 1a 0d df a0 e4 c8  5a e2 2d 83 35 ed 88 8f  |.$......Z.-.5...|
+00000260  08 23 db c9 fa 56 c9 5d  14 91 43 53 57 40 a1 a6  |.#...V.]..CSW@..|
+00000270  c9 61 b4 99 d5 4b bc 32  b5 2a a0 13 68 d3 06 1b  |.a...K.2.*..h...|
+00000280  07 7f 3a a3 05 32 19 c2  d7 ed 9a 68 f7 da e9 80  |..:..2.....h....|
+00000290  54 1f 1d c3 6b fc 1f 85  b0 8d 91 76 39 a1 56 e2  |T...k......v9.V.|
+000002a0  1b 73 1e c3 1f 57 59 25  17 b2 53 6c fd 47 5f de  |.s...WY%..Sl.G_.|
+000002b0  57 2c c0 e7 76 1b 71 05  6c 14 03 03 00 01 01 16  |W,..v.q.l.......|
+000002c0  03 03 00 28 00 00 00 00  00 00 00 00 42 57 90 45  |...(........BW.E|
+000002d0  6a b9 64 64 92 ac c5 63  14 66 d1 f0 f9 65 f3 25  |j.dd...c.f...e.%|
+000002e0  de 81 74 da 68 1c cb 90  a5 46 6d 69              |..t.h....Fmi|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 e4 27 5e 80 00  |..........(.'^..|
-00000010  ee db 03 4c 17 d1 9c bf  f5 68 5f eb a6 fb 0c 3f  |...L.....h_....?|
-00000020  4f c4 38 84 3e c2 e9 f4  9b 06 39 5f 89 06 3a bd  |O.8.>.....9_..:.|
-00000030  77 db 25                                          |w.%|
+00000000  14 03 03 00 01 01 16 03  03 00 28 6b 52 88 32 f1  |..........(kR.2.|
+00000010  6e 1f dd ce 38 ba d4 7d  c7 4a 55 89 4c 91 57 34  |n...8..}.JU.L.W4|
+00000020  1e 54 12 8e 37 e2 dc a9  7d 37 b6 31 57 2f 11 27  |.T..7...}7.1W/.'|
+00000030  42 96 c2                                          |B..|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 2b 98 2b  |.............+.+|
-00000010  d6 dc d2 69 03 c9 0e 44  46 d1 5e d2 5a 14 89 7b  |...i...DF.^.Z..{|
-00000020  60 ab 62 15 03 03 00 1a  00 00 00 00 00 00 00 02  |`.b.............|
-00000030  b9 7a 17 4b 10 5f 25 90  14 75 bb aa 42 de 7b 63  |.z.K._%..u..B.{c|
-00000040  69 e8                                             |i.|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 be ea d3  |................|
+00000010  87 8c 16 62 86 4a 53 49  9d d7 f8 01 11 8b 9b 58  |...b.JSI.......X|
+00000020  39 89 cf 15 03 03 00 1a  00 00 00 00 00 00 00 02  |9...............|
+00000030  93 9d 61 38 db c4 be 69  5e fb 63 1e ae f3 57 e4  |..a8...i^.c...W.|
+00000040  fe 85                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA
index 7b2a363176..689be1097b 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 6d b7 f7 cf 1d  |....]...Y..m....|
-00000010  f9 c0 02 cb ee 90 23 93  41 8e 26 24 3e 74 31 ce  |......#.A.&$>t1.|
-00000020  4f 53 f8 9d 0f 94 02 b2  66 c9 87 20 d6 5c 35 52  |OS......f.. .\5R|
-00000030  4b b1 f2 bb 2e 1d 95 ff  7d 83 f0 58 a8 0a ed b1  |K.......}..X....|
-00000040  54 25 03 ca ea 7b 8d 1a  8f 9f 43 51 c0 09 00 00  |T%...{....CQ....|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 dc 6d a4 87 a5  |....]...Y...m...|
+00000010  a1 8e 67 3d c3 ed c0 e4  ed 38 7a 00 df b1 50 f4  |..g=.....8z...P.|
+00000020  4a cc 0f ab e2 e8 d9 77  b8 1a 18 20 cb e9 02 2a  |J......w... ...*|
+00000030  4f 17 c0 9d 3d 55 60 3e  d8 46 ee 52 dd bf 3e e6  |O...=U`>.F.R..>.|
+00000040  c9 4a b5 24 f5 19 73 56  ab 78 ce ec c0 09 00 00  |.J.$..sV.x......|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
 00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
@@ -56,23 +58,23 @@
 00000240  8c 25 c1 33 13 83 0d 94  06 bb d4 37 7a f6 ec 7a  |.%.3.......7z..z|
 00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
 00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
-00000270  95 12 07 8f 2a 16 03 03  00 b6 0c 00 00 b2 03 00  |....*...........|
-00000280  1d 20 04 b4 79 b4 2c 1d  0f b3 4b ff 67 e7 24 88  |. ..y.,...K.g.$.|
-00000290  d6 db 4f 1e 66 da 0e f2  89 5a 53 ed 4e ba ad 4c  |..O.f....ZS.N..L|
-000002a0  81 0a 04 03 00 8a 30 81  87 02 42 01 fb 16 53 43  |......0...B...SC|
-000002b0  2b 86 61 0a 58 a0 68 c1  cd 2c ff ec 79 7f 83 fa  |+.a.X.h..,..y...|
-000002c0  cc 0b 24 9d 98 54 d0 dc  90 55 e1 b3 e6 48 69 1a  |..$..T...U...Hi.|
-000002d0  55 62 f4 da 8f 60 db f7  76 80 d5 4d 37 f6 43 49  |Ub...`..v..M7.CI|
-000002e0  95 3d 96 f6 e2 fd a4 07  ae 24 8c fa bd 02 41 20  |.=.......$....A |
-000002f0  a1 50 78 a3 dd 99 c0 cf  74 f1 c0 79 b1 13 9d bc  |.Px.....t..y....|
-00000300  0b 37 cf 7c 09 11 b8 a4  71 65 e8 be ff 3a b9 85  |.7.|....qe...:..|
-00000310  cd b4 30 f8 1f d6 2e 83  96 6c 01 3e d2 00 a7 5b  |..0......l.>...[|
-00000320  23 c6 d0 69 eb 90 49 e3  46 ed 45 96 3b 07 d4 a8  |#..i..I.F.E.;...|
-00000330  16 03 03 00 3a 0d 00 00  36 03 01 02 40 00 2e 04  |....:...6...@...|
-00000340  03 05 03 06 03 08 07 08  08 08 09 08 0a 08 0b 08  |................|
-00000350  04 08 05 08 06 04 01 05  01 06 01 03 03 02 03 03  |................|
-00000360  01 02 01 03 02 02 02 04  02 05 02 06 02 00 00 16  |................|
-00000370  03 03 00 04 0e 00 00 00                           |........|
+00000270  95 12 07 8f 2a 16 03 03  00 b7 0c 00 00 b3 03 00  |....*...........|
+00000280  1d 20 d8 81 5d 07 0c 63  f2 9a bf 82 37 08 f6 6d  |. ..]..c....7..m|
+00000290  e2 20 4b 98 85 cc 62 ad  a2 ac b1 8b 15 de 1d 5e  |. K...b........^|
+000002a0  3b 74 04 03 00 8b 30 81  88 02 42 01 81 b9 d9 e7  |;t....0...B.....|
+000002b0  3b 89 ed 5f cb 0a 10 16  85 69 c3 5e 7f 82 95 f6  |;.._.....i.^....|
+000002c0  49 48 3a 6d 84 c2 f5 04  9a 00 ef 86 f9 10 fc 03  |IH:m............|
+000002d0  a8 ba eb e7 0c 0c 0c 27  7b ba aa 73 a4 23 03 cb  |.......'{..s.#..|
+000002e0  d8 be c8 39 34 1f c4 33  e4 cf 12 98 35 02 42 01  |...94..3....5.B.|
+000002f0  dc 0b c7 df 9c b2 c4 f5  dc 4a a6 b0 ef 40 3c 8c  |.........J...@<.|
+00000300  98 f3 93 ac 14 9b 4d fe  6e 7a 09 fd 23 c3 14 4f  |......M.nz..#..O|
+00000310  cf 1a e6 61 72 58 8c 75  10 6c 75 42 cc 7b 9c 4a  |...arX.u.luB.{.J|
+00000320  11 62 25 12 63 44 9d fe  3d 67 44 7e 74 bd b0 3d  |.b%.cD..=gD~t..=|
+00000330  04 16 03 03 00 3a 0d 00  00 36 03 01 02 40 00 2e  |.....:...6...@..|
+00000340  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
+00000350  08 04 08 05 08 06 04 01  05 01 06 01 03 03 02 03  |................|
+00000360  03 01 02 01 03 02 02 02  04 02 05 02 06 02 00 00  |................|
+00000370  16 03 03 00 04 0e 00 00  00                       |.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
 00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
@@ -109,31 +111,31 @@
 00000200  e5 35 16 03 03 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
 00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 03 00  |......._X.;t....|
-00000230  88 0f 00 00 84 08 04 00  80 3f 4a c2 4f 36 85 f0  |.........?J.O6..|
-00000240  d0 c6 b6 8f f1 cc 45 c1  2f f2 c7 24 1e 0f 04 dc  |......E./..$....|
-00000250  f5 af 6e 38 eb aa a6 6f  36 f4 80 dd 78 78 a7 d4  |..n8...o6...xx..|
-00000260  50 3a df e1 23 c4 3f 58  df 1a c0 1d 57 a5 46 3b  |P:..#.?X....W.F;|
-00000270  5d 09 ac 62 63 28 8a a2  b5 d4 9b 88 7c b9 4d b4  |]..bc(......|.M.|
-00000280  66 b2 9d 53 6e 15 9c f2  9b c7 14 ca 19 7f 00 38  |f..Sn..........8|
-00000290  81 a3 7b 44 e8 3d 6d 54  0f b3 81 fd 82 07 4d a1  |..{D.=mT......M.|
-000002a0  3e 8c 30 34 cd 6e 55 96  58 bf 86 8b 9c f6 be 94  |>.04.nU.X.......|
-000002b0  f4 a8 7e 4d 7f 03 07 7e  98 14 03 03 00 01 01 16  |..~M...~........|
+00000230  88 0f 00 00 84 08 04 00  80 3c 66 74 5d c3 4b d6  |.........<ft].K.|
+00000240  98 89 fe 1d 47 36 26 62  e8 19 0a 2c a9 8d 9a cf  |....G6&b...,....|
+00000250  f2 a1 15 3a bb c5 90 be  8d 09 d5 e8 3e 1f f3 87  |...:........>...|
+00000260  19 a7 d9 5d 7c f6 65 32  bd 47 e9 2f 90 a8 90 1b  |...]|.e2.G./....|
+00000270  41 05 08 35 32 f6 c2 22  70 61 37 a3 48 96 72 e0  |A..52.."pa7.H.r.|
+00000280  41 26 07 a9 6c c2 34 72  35 d5 43 ce 23 fd 34 9b  |A&..l.4r5.C.#.4.|
+00000290  56 b7 4e c0 be b9 b3 bd  81 df 32 58 3f b2 af 34  |V.N.......2X?..4|
+000002a0  c0 08 69 27 19 43 0f 34  1b 56 ed 08 cd 1b 2b f3  |..i'.C.4.V....+.|
+000002b0  41 75 8c 0a b2 43 4c f6  fe 14 03 03 00 01 01 16  |Au...CL.........|
 000002c0  03 03 00 40 00 00 00 00  00 00 00 00 00 00 00 00  |...@............|
-000002d0  00 00 00 00 c7 88 1e 15  dd 36 31 22 0f 30 d1 4d  |.........61".0.M|
-000002e0  40 2e 3a dd 05 cc fd a8  d2 ea f8 d9 79 1d 07 46  |@.:.........y..F|
-000002f0  2c 80 ab ab 54 3c 10 5a  a7 79 d2 1c 16 18 94 eb  |,...T<.Z.y......|
-00000300  46 69 cc 03                                       |Fi..|
+000002d0  00 00 00 00 ce ef 0a 09  6d 11 17 89 31 b3 ac 31  |........m...1..1|
+000002e0  76 fe 02 d1 2b f8 dc df  fc 59 e3 2f aa 14 4e 9d  |v...+....Y./..N.|
+000002f0  c1 d9 5d f6 4f 57 6f 15  db 93 f1 27 12 02 7c 08  |..].OWo....'..|.|
+00000300  75 f6 48 26                                       |u.H&|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 9e 65 27 5b 92  |..........@.e'[.|
-00000010  1e 2b 1a bc 81 ab 85 29  51 c1 38 04 b6 97 e5 4b  |.+.....)Q.8....K|
-00000020  b1 7d a5 e2 6d e7 b1 1a  33 6c f1 3d a4 9c de 2d  |.}..m...3l.=...-|
-00000030  b3 8a 01 da cc f1 d7 83  b1 1e 84 cb b7 e7 fe e6  |................|
-00000040  26 83 b0 2d 6f a9 77 46  55 44 7a                 |&..-o.wFUDz|
+00000000  14 03 03 00 01 01 16 03  03 00 40 c0 0b de 9c 60  |..........@....`|
+00000010  35 52 38 09 01 7f e5 52  b3 cf b4 e6 27 02 36 52  |5R8....R....'.6R|
+00000020  ce 84 dd f5 ee f8 65 7c  89 ad 5e 1c 86 09 36 d0  |......e|..^...6.|
+00000030  23 c7 52 63 6b 67 97 4e  bf c0 28 83 3a c8 3e a2  |#.Rckg.N..(.:.>.|
+00000040  2f f3 d7 08 8c c0 86 64  8e 9c 3e                 |/......d..>|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 e2 55 06  b8 6f 63 c4 63 78 76 4b  |......U..oc.cxvK|
-00000020  c8 63 8b 4b c6 11 2c ff  dc fc 20 f7 52 fe fa 5f  |.c.K..,... .R.._|
-00000030  e3 45 3a f2 a1 15 03 03  00 30 00 00 00 00 00 00  |.E:......0......|
-00000040  00 00 00 00 00 00 00 00  00 00 0e cb 88 2f 1f be  |............./..|
-00000050  9c 76 4d db 75 7f eb 01  ae bd 76 28 07 41 49 6c  |.vM.u.....v(.AIl|
-00000060  4c 82 84 d5 fc d3 75 f4  4b 81                    |L.....u.K.|
+00000010  00 00 00 00 00 98 7e 6b  30 28 7d e1 6f 09 17 40  |......~k0(}.o..@|
+00000020  cf 5f 98 90 46 91 b5 9b  f8 29 22 a0 85 75 f7 f6  |._..F....)"..u..|
+00000030  f4 33 c8 60 75 15 03 03  00 30 00 00 00 00 00 00  |.3.`u....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 02 c0 9e 3b 21 50  |.............;!P|
+00000050  a1 7a 16 67 32 3d 66 6d  c4 7f 9c 9b 44 30 31 f4  |.z.g2=fm....D01.|
+00000060  ea 03 7a e3 54 5d 35 7f  d3 eb                    |..z.T]5...|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA
index 25fc245b65..2dd00ba602 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 5f da ab 10 86  |....]...Y.._....|
-00000010  4c 91 60 4c ec 28 20 d4  37 84 c4 d0 87 bb 9d a9  |L.`L.( .7.......|
-00000020  5a c0 86 81 d9 91 38 5a  ef 3f ae 20 ec 14 b6 de  |Z.....8Z.?. ....|
-00000030  b7 cf 59 09 43 dc 59 3f  74 89 10 f2 82 ea 60 46  |..Y.C.Y?t.....`F|
-00000040  8f a3 6a 0f 61 0f 2d 66  24 c3 fb 7f c0 2f 00 00  |..j.a.-f$..../..|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 df 59 a1 48 61  |....]...Y...Y.Ha|
+00000010  ef db cd 29 5f 9b 90 e4  d9 6d db 10 98 ae 69 b8  |...)_....m....i.|
+00000020  97 ed 8f 57 24 42 16 32  0a b0 b1 20 79 b3 fc 90  |...W$B.2... y...|
+00000030  63 58 4b ab 45 d8 e9 39  7c 11 20 09 33 db b5 4c  |cXK.E..9|. .3..L|
+00000040  2c e2 d6 39 63 fe 74 d5  59 18 5c 7d c0 2f 00 00  |,..9c.t.Y.\}./..|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -61,18 +63,18 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 2c c4 b9  |............ ,..|
-000002d0  13 19 85 99 cb 09 f3 5c  3a a1 b2 16 ee 77 6a cd  |.......\:....wj.|
-000002e0  23 6c 08 00 7e 6b c0 67  a8 cd 8b 62 64 08 04 00  |#l..~k.g...bd...|
-000002f0  80 90 74 bf ce f7 94 f1  94 b1 95 04 4a ab d6 08  |..t.........J...|
-00000300  23 11 8d ce 4e 7b 36 ee  67 d2 26 af 11 0e 33 58  |#...N{6.g.&...3X|
-00000310  12 cb e5 3b 5b 5c f3 d1  82 19 2e 55 6b 98 05 6e  |...;[\.....Uk..n|
-00000320  3c 5e 04 f5 3e df 76 c3  e5 46 e7 a6 bb f7 d4 d5  |<^..>.v..F......|
-00000330  e8 fd 20 d3 ce 3e 9d a0  90 9a 10 52 a7 04 c9 e9  |.. ..>.....R....|
-00000340  28 6f 3f ff e1 0a 10 d0  25 04 ea e4 84 4c b7 80  |(o?.....%....L..|
-00000350  e4 fe a7 a6 da db cc b0  e0 62 80 10 fc 03 16 94  |.........b......|
-00000360  f2 dd 0d 3f aa 11 45 af  e3 e4 7b e6 bc d6 75 91  |...?..E...{...u.|
-00000370  99 16 03 03 00 3a 0d 00  00 36 03 01 02 40 00 2e  |.....:...6...@..|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 12 4b 94  |............ .K.|
+000002d0  2b 4a d0 b5 0f ca 87 05  7f 56 c3 11 b0 83 01 27  |+J.......V.....'|
+000002e0  68 a2 dd 63 b6 9b ff e5  48 7e af dd 0f 08 04 00  |h..c....H~......|
+000002f0  80 38 6f 01 25 4e 51 f1  8d 6c 89 4b 85 85 1d cd  |.8o.%NQ..l.K....|
+00000300  63 21 5e 89 d5 04 ac 81  cf 42 3c 6f df f1 53 ac  |c!^......B<o..S.|
+00000310  e3 54 28 a3 9f 06 76 96  9c 64 c7 22 55 14 2e 48  |.T(...v..d."U..H|
+00000320  7e d3 97 9a 35 b8 cf 1c  b8 a0 f2 b1 da 2f 0f a4  |~...5......../..|
+00000330  07 44 43 a8 01 67 a8 94  8d 8e 7a 60 91 48 d0 c7  |.DC..g....z`.H..|
+00000340  b5 c9 c8 ad df b0 33 cd  4a 37 75 ef 65 56 4b fd  |......3.J7u.eVK.|
+00000350  23 e7 b7 d3 3b fc 14 4e  b0 32 9b d3 cb e1 cd 4e  |#...;..N.2.....N|
+00000360  93 0e 01 cf 54 95 af e5  29 1f 8d 07 42 0f 29 67  |....T...)...B.)g|
+00000370  6d 16 03 03 00 3a 0d 00  00 36 03 01 02 40 00 2e  |m....:...6...@..|
 00000380  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000390  08 04 08 05 08 06 04 01  05 01 06 01 03 03 02 03  |................|
 000003a0  03 01 02 01 03 02 02 02  04 02 05 02 06 02 00 00  |................|
@@ -113,26 +115,26 @@
 00000200  e5 35 16 03 03 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
 00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 03 00  |......._X.;t....|
-00000230  88 0f 00 00 84 08 04 00  80 4d c1 8a 3d 2b 1f a0  |.........M..=+..|
-00000240  ad 6f 1c b6 44 7c cc 0d  21 6f e8 31 51 58 51 fe  |.o..D|..!o.1QXQ.|
-00000250  84 f3 41 40 12 48 29 0d  20 16 d1 6a 4b 38 0b c8  |..A@.H). ..jK8..|
-00000260  b3 70 3f 4a ca 17 da 05  30 ec 6c 4f 55 e2 ee e5  |.p?J....0.lOU...|
-00000270  9a 8c a7 9f c1 96 79 cf  53 b6 67 c8 cb 67 d3 23  |......y.S.g..g.#|
-00000280  07 8a 3f ef df e5 e6 84  f6 5f 5e 23 57 89 cc 77  |..?......_^#W..w|
-00000290  99 ed 3d 58 8a ec eb bb  64 62 d1 44 7f b6 45 85  |..=X....db.D..E.|
-000002a0  89 06 90 56 48 98 8a 43  93 64 53 df 3a 8c b3 93  |...VH..C.dS.:...|
-000002b0  91 81 7b 60 95 8f 99 99  eb 14 03 03 00 01 01 16  |..{`............|
-000002c0  03 03 00 28 00 00 00 00  00 00 00 00 dd 93 96 02  |...(............|
-000002d0  47 0e 1d 2f 6a 76 12 e5  56 53 8f 7f c1 cd f3 5e  |G../jv..VS.....^|
-000002e0  3c 94 35 1b fe d5 33 97  b2 5b a3 29              |<.5...3..[.)|
+00000230  88 0f 00 00 84 08 04 00  80 a5 81 a8 8a ed 68 25  |..............h%|
+00000240  5d 82 da 0f dc 93 20 56  34 c1 a0 62 0a a7 fb a5  |]..... V4..b....|
+00000250  58 07 79 b0 45 17 2d 13  99 9f 6c dc 53 9e 1c e2  |X.y.E.-...l.S...|
+00000260  1d 9b a3 bb 69 af 58 33  e1 31 d7 72 f4 86 1d 66  |....i.X3.1.r...f|
+00000270  55 a8 c9 77 5b 57 c5 86  74 a0 c9 25 a9 cc 2e da  |U..w[W..t..%....|
+00000280  26 17 6e bb 34 5b 49 94  0e 05 db b4 05 a4 65 22  |&.n.4[I.......e"|
+00000290  98 8c 91 ae d6 1c 89 f4  df 63 8b 45 17 05 0c 50  |.........c.E...P|
+000002a0  c0 1d 5e 75 67 c5 be 32  9d f0 4c a5 85 91 f6 f0  |..^ug..2..L.....|
+000002b0  8d 58 11 61 85 7b 5c e4  7e 14 03 03 00 01 01 16  |.X.a.{\.~.......|
+000002c0  03 03 00 28 00 00 00 00  00 00 00 00 30 27 fd 36  |...(........0'.6|
+000002d0  e0 91 2d 1d d7 4a 38 d2  73 5c 5d 4c b2 27 42 cf  |..-..J8.s\]L.'B.|
+000002e0  df 0d 33 ee 49 18 36 f3  bd c6 ee a8              |..3.I.6.....|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 de 60 8a ea b5  |..........(.`...|
-00000010  74 66 35 35 39 bb 62 ab  17 7d 91 c3 1a 5a e5 6c  |tf559.b..}...Z.l|
-00000020  49 14 c8 bc bd d6 b6 7e  2f 8e d4 40 5a ae ee 89  |I......~/..@Z...|
-00000030  89 ae af                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 28 30 5f 74 39 bb  |..........(0_t9.|
+00000010  c8 00 8c d7 bd 74 ce 43  62 ea 08 0f ba b4 88 74  |.....t.Cb......t|
+00000020  d3 31 c9 3c a6 3a 92 14  75 44 95 ee c0 a9 ef 75  |.1.<.:..uD.....u|
+00000030  40 25 5f                                          |@%_|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 3c 92 2d  |.............<.-|
-00000010  44 23 5b eb 34 dc 9a 4d  c2 fe a7 88 cb 6f 8d 62  |D#[.4..M.....o.b|
-00000020  4b 2a bf 15 03 03 00 1a  00 00 00 00 00 00 00 02  |K*..............|
-00000030  90 82 82 54 5d 63 6e 8b  50 71 6e e8 fd 75 96 9e  |...T]cn.Pqn..u..|
-00000040  d0 0d                                             |..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 f9 d9 d3  |................|
+00000010  ee ec ec 6e 8d 0d dd 62  f3 e1 19 0f f4 24 06 46  |...n...b.....$.F|
+00000020  76 7d 78 15 03 03 00 1a  00 00 00 00 00 00 00 02  |v}x.............|
+00000030  ce 6a 05 27 af 9a 3d 09  27 70 dc c2 4c 8a a5 ab  |.j.'..=.'p..L...|
+00000040  47 d4                                             |G.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPKCS1v15 b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPKCS1v15
index 6500aec8b0..5fab0f8c82 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPKCS1v15
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPKCS1v15
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 7b 21 bd ee 4b  |....]...Y..{!..K|
-00000010  af e3 88 cb 18 15 e5 f3  ef a5 a7 b3 a1 66 06 b2  |.............f..|
-00000020  f1 cc d7 36 7e 18 d1 f6  2e 3e cd 20 34 09 01 9f  |...6~....>. 4...|
-00000030  c6 80 10 43 c1 ed e6 c1  29 1c ed ac 61 36 37 4f  |...C....)...a67O|
-00000040  8e 00 44 9d b9 cb 51 0b  a2 9c 64 be c0 2f 00 00  |..D...Q...d../..|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 7b 1f 2c 33 ab  |....]...Y..{.,3.|
+00000010  6e f8 23 ca 20 a9 66 61  ac 29 00 3e ef a6 cd ee  |n.#. .fa.).>....|
+00000020  fe e7 18 b7 66 57 0d af  24 37 7a 20 e7 c8 bd 22  |....fW..$7z ..."|
+00000030  f7 ff 01 c5 ef c0 fb bd  b2 93 d9 81 df 30 96 91  |.............0..|
+00000040  0b af b5 a2 61 87 76 27  d4 bf ce 88 c0 2f 00 00  |....a.v'...../..|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -61,18 +63,18 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 d3 22 bb  |............ .".|
-000002d0  c4 42 90 54 0a 43 f6 26  06 c1 ad 71 c8 82 ba 03  |.B.T.C.&...q....|
-000002e0  9b cd be a4 a8 04 5a 30  69 ec b5 c9 79 04 01 00  |......Z0i...y...|
-000002f0  80 ab c7 ca 24 9b db 7d  8c 81 c4 c4 46 49 2a 45  |....$..}....FI*E|
-00000300  69 31 1b dc ef 01 ce 9f  e4 da cf 6c 04 4c e3 4e  |i1.........l.L.N|
-00000310  16 84 05 fe 48 f4 21 60  fc d4 e1 6c 48 8c 87 2d  |....H.!`...lH..-|
-00000320  1f 56 2c ad 88 2b 5c 8d  4f 36 93 d6 a3 b1 32 4a  |.V,..+\.O6....2J|
-00000330  ef 0f e6 db 82 1c f2 ea  38 08 2a 62 8b a3 bd 4e  |........8.*b...N|
-00000340  8b 2a ae eb 0e e5 f1 88  ff 3c de f8 ed d7 c3 07  |.*.......<......|
-00000350  05 92 bb e5 6d 15 23 c8  54 19 a6 cf d1 4f e2 b1  |....m.#.T....O..|
-00000360  a3 4d ff 6f 22 32 5b 58  f7 58 c1 9f 58 59 b5 e2  |.M.o"2[X.X..XY..|
-00000370  7b 16 03 03 00 0c 0d 00  00 08 01 01 00 02 04 01  |{...............|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 2d 21 55  |............ -!U|
+000002d0  c7 73 14 c1 c8 84 91 4d  16 70 ca 47 46 4a 59 fe  |.s.....M.p.GFJY.|
+000002e0  20 d8 34 0a 78 8e a3 29  f5 40 38 d9 59 04 01 00  | .4.x..).@8.Y...|
+000002f0  80 03 9f da 00 e0 50 28  6b 29 84 9b 96 05 f1 86  |......P(k)......|
+00000300  ef f5 6d 9f 17 5f 07 f7  2d 32 af 5e 0d 72 f4 86  |..m.._..-2.^.r..|
+00000310  af 7c b9 e8 2d 80 b3 10  80 dd 61 5b e5 a7 53 5a  |.|..-.....a[..SZ|
+00000320  5e 19 47 5f f1 96 a4 ab  d8 e7 65 eb be eb bc 51  |^.G_......e....Q|
+00000330  95 6f 29 48 ac cb a7 08  3a b9 45 77 37 30 a3 83  |.o)H....:.Ew70..|
+00000340  e4 ef 58 06 0e ec a1 cf  2c 06 62 a8 1c 97 64 ac  |..X.....,.b...d.|
+00000350  c7 86 13 4c 9b 80 69 d4  89 9c 96 2c f9 20 c6 2c  |...L..i....,. .,|
+00000360  d2 11 64 ab 8d df c0 ea  1c 73 da ed 10 28 dc 90  |..d......s...(..|
+00000370  8a 16 03 03 00 0c 0d 00  00 08 01 01 00 02 04 01  |................|
 00000380  00 00 16 03 03 00 04 0e  00 00 00                 |...........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
@@ -110,26 +112,26 @@
 00000200  e5 35 16 03 03 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
 00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 03 00  |......._X.;t....|
-00000230  88 0f 00 00 84 04 01 00  80 8f 22 b5 46 ab 82 02  |..........".F...|
-00000240  f8 a8 f8 63 d9 0f eb d4  2b 8d 02 de ce 79 d5 a1  |...c....+....y..|
-00000250  20 bb 70 7a b2 36 6a b5  52 81 f5 ea f7 23 b5 41  | .pz.6j.R....#.A|
-00000260  86 35 90 cc 64 4a 68 7e  e3 ae c1 97 32 3b c2 a9  |.5..dJh~....2;..|
-00000270  e0 f0 07 14 63 d5 08 15  59 46 f5 ea a6 39 5c 98  |....c...YF...9\.|
-00000280  39 7e 17 d8 74 ae 05 a3  f5 3a 71 74 e8 b4 c9 a4  |9~..t....:qt....|
-00000290  1c 82 04 ca fe 5f 97 23  8a c1 f9 ce d1 5d 0e 81  |....._.#.....]..|
-000002a0  da 5f e1 b6 76 80 3c cf  9f 19 79 cf 33 d0 0a fe  |._..v.<...y.3...|
-000002b0  19 fc 2d 9a bb 24 cd d4  79 14 03 03 00 01 01 16  |..-..$..y.......|
-000002c0  03 03 00 28 00 00 00 00  00 00 00 00 28 78 b8 0b  |...(........(x..|
-000002d0  59 d8 a8 11 21 ed 45 74  02 00 50 33 42 b9 0a d2  |Y...!.Et..P3B...|
-000002e0  8c 9c a3 45 6e b5 9d 3e  5b 30 a9 2e              |...En..>[0..|
+00000230  88 0f 00 00 84 04 01 00  80 5e cb 28 a9 f4 b7 f1  |.........^.(....|
+00000240  a7 31 a5 51 4c 2d b0 c9  fb 84 0a 77 30 bc 00 72  |.1.QL-.....w0..r|
+00000250  66 65 aa 20 78 34 f1 3f  31 93 42 f7 7c 28 23 70  |fe. x4.?1.B.|(#p|
+00000260  b6 ad 2a 8f ed 70 2f a8  db ce 69 20 3e 9f 2a 6d  |..*..p/...i >.*m|
+00000270  1f 32 f8 32 7c 74 c9 2a  cd b5 c0 0d 0e 1a 32 d5  |.2.2|t.*......2.|
+00000280  ed a3 09 fb 8b ce 1d 30  52 5e ba c2 17 85 f0 c2  |.......0R^......|
+00000290  59 e6 db 0c 17 b3 2c 81  cd 1b f1 4c 92 e7 1b 6a  |Y.....,....L...j|
+000002a0  49 86 50 25 00 59 40 df  b2 fd c8 3b 9d c7 2f 57  |I.P%.Y@....;../W|
+000002b0  e1 e5 31 91 57 60 f2 b8  e5 14 03 03 00 01 01 16  |..1.W`..........|
+000002c0  03 03 00 28 00 00 00 00  00 00 00 00 07 cd 54 b1  |...(..........T.|
+000002d0  e3 78 20 90 ca 71 5e 06  f4 32 e9 02 41 60 c1 9d  |.x ..q^..2..A`..|
+000002e0  d3 c6 42 45 d8 2e fc 3d  07 9a 9d 04              |..BE...=....|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 f8 f5 85 19 36  |..........(....6|
-00000010  be 6e 58 45 66 04 c4 f9  e7 fd 50 55 3b 07 6c 50  |.nXEf.....PU;.lP|
-00000020  16 8c 2e 72 cf be 78 0a  8a 82 91 ed c1 72 10 d3  |...r..x......r..|
-00000030  cf 42 b5                                          |.B.|
+00000000  14 03 03 00 01 01 16 03  03 00 28 75 60 b0 0a 19  |..........(u`...|
+00000010  12 ee 0f 5c c2 6a 31 f8  27 e3 53 b1 76 2b 6a 93  |...\.j1.'.S.v+j.|
+00000020  a2 37 72 74 e8 e9 c8 e7  94 56 6b d5 a3 49 09 79  |.7rt.....Vk..I.y|
+00000030  59 66 34                                          |Yf4|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 53 4b a2  |.............SK.|
-00000010  e4 5f 51 70 46 3d e3 41  28 8b 82 02 e2 27 8d eb  |._QpF=.A(....'..|
-00000020  42 65 7f 15 03 03 00 1a  00 00 00 00 00 00 00 02  |Be..............|
-00000030  f3 31 ed 2c ca e5 13 e8  93 cd d7 51 4b c5 16 88  |.1.,.......QK...|
-00000040  c0 a4                                             |..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 70 7a 77  |.............pzw|
+00000010  14 b3 3d 3e 51 19 5e ae  97 56 bc e8 3c 1c 46 dd  |..=>Q.^..V..<.F.|
+00000020  67 e6 f5 15 03 03 00 1a  00 00 00 00 00 00 00 02  |g...............|
+00000030  50 4b b6 03 84 33 58 6a  a1 95 dc 8e ad d1 1f 8b  |PK...3Xj........|
+00000040  93 ca                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPSS b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPSS
index b4c5102535..867ec87afa 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPSS
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPSS
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 0d 73 c5 43 a1  |....]...Y...s.C.|
-00000010  71 b6 21 da 7a f6 76 44  60 8a 84 ec 6b 1d 70 01  |q.!.z.vD`...k.p.|
-00000020  d8 b2 29 48 db 5d ea da  ea 79 bb 20 3f b9 66 fe  |..)H.]...y. ?.f.|
-00000030  73 db fc 90 18 3f ac e5  1f 5d 86 24 80 75 ec a3  |s....?...].$.u..|
-00000040  c6 aa e9 05 c1 47 21 bd  30 f6 41 43 c0 2f 00 00  |.....G!.0.AC./..|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 97 c2 4c 45 c0  |....]...Y....LE.|
+00000010  22 6a 7d 71 93 1a 71 a7  e1 40 a5 44 5e 39 8a 3e  |"j}q..q..@.D^9.>|
+00000020  99 04 1f e1 74 ad 3a 64  89 ad 93 20 61 76 9a e1  |....t.:d... av..|
+00000030  39 26 af 37 ad ea f2 9c  4c 2e 1b a2 18 0c 73 8e  |9&.7....L.....s.|
+00000040  5b 8b f0 0f 44 04 80 31  5a 49 39 f0 c0 2f 00 00  |[...D..1ZI9../..|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 66 0b  00 02 62 00 02 5f 00 02  |......f...b.._..|
 00000070  5c 30 82 02 58 30 82 01  8d a0 03 02 01 02 02 11  |\0..X0..........|
@@ -62,17 +64,17 @@
 000002a0  fa b1 3f 14 11 89 66 79  d1 8e 88 0e 0b a0 9e 30  |..?...fy.......0|
 000002b0  2a c0 67 ef ca 46 02 88  e9 53 81 22 69 22 97 ad  |*.g..F...S."i"..|
 000002c0  80 93 d4 f7 dd 70 14 24  d7 70 0a 46 a1 16 03 03  |.....p.$.p.F....|
-000002d0  00 ac 0c 00 00 a8 03 00  1d 20 03 05 56 dd 40 c0  |......... ..V.@.|
-000002e0  b6 4d 5a df 26 e7 4a f1  a8 47 ef af 12 6e 5f 01  |.MZ.&.J..G...n_.|
-000002f0  2a 7a 19 1a 45 52 8c 47  d2 53 08 04 00 80 8a 6a  |*z..ER.G.S.....j|
-00000300  9d 8b 38 73 da 92 bc f6  05 79 90 af 7a 43 59 62  |..8s.....y..zCYb|
-00000310  bc 97 b6 af ef ce 5f 59  07 81 93 bc c5 3c 5f f9  |......_Y.....<_.|
-00000320  4e 04 45 74 5e cc 7a 6f  82 7a cf 86 0d 68 c9 35  |N.Et^.zo.z...h.5|
-00000330  1d 62 f0 3c ee 77 b5 4c  3a 40 ec 89 fc 97 ff a6  |.b.<.w.L:@......|
-00000340  34 13 8b bc 6b 83 92 e8  52 c5 c6 42 c9 25 ad 37  |4...k...R..B.%.7|
-00000350  41 e7 5a 52 d8 0f 7d fd  a8 9e 86 c6 1b b2 8b 50  |A.ZR..}........P|
-00000360  2a 1c 15 56 00 d8 a8 85  86 05 28 7f a1 3e ba f2  |*..V......(..>..|
-00000370  fe 92 07 c8 a4 4a 2a 5f  d1 53 82 09 9c 65 16 03  |.....J*_.S...e..|
+000002d0  00 ac 0c 00 00 a8 03 00  1d 20 ae c6 bf 84 a5 c3  |......... ......|
+000002e0  05 6b fa 30 b0 ec b7 c2  ff ec 7d e4 b8 e0 f2 0f  |.k.0......}.....|
+000002f0  3d 0e ef de 32 ad f2 6e  52 55 08 04 00 80 07 86  |=...2..nRU......|
+00000300  e1 b2 04 6e b2 43 09 df  c9 20 35 11 3b 0f 10 61  |...n.C... 5.;..a|
+00000310  7e 67 cc 65 c6 60 80 c3  43 7d b8 1c 52 e3 09 af  |~g.e.`..C}..R...|
+00000320  df 38 79 e1 ea 6d b4 6b  bc 50 fe a8 6f 46 6f 9c  |.8y..m.k.P..oFo.|
+00000330  40 1c 6f f2 e5 c6 d9 a4  db 72 24 4a 9c 57 e7 d6  |@.o......r$J.W..|
+00000340  91 91 5b 1b f1 40 f2 d9  58 a2 81 4c d7 be 20 d4  |..[..@..X..L.. .|
+00000350  12 4f 64 05 e5 ec ba 35  22 a7 fe df c9 ea b3 43  |.Od....5"......C|
+00000360  dc 47 29 98 eb c9 92 11  42 a0 80 a4 2a 2e 4d 47  |.G).....B...*.MG|
+00000370  73 9e 0f 13 37 79 92 ca  db c4 84 db 05 4a 16 03  |s...7y.......J..|
 00000380  03 00 0c 0d 00 00 08 01  01 00 02 08 04 00 00 16  |................|
 00000390  03 03 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
@@ -118,26 +120,26 @@
 00000270  10 00 00 21 20 2f e5 7d  a3 47 cd 62 43 15 28 da  |...! /.}.G.bC.(.|
 00000280  ac 5f bb 29 07 30 ff f6  84 af c4 cf c2 ed 90 99  |._.).0..........|
 00000290  5f 58 cb 3b 74 16 03 03  00 88 0f 00 00 84 08 04  |_X.;t...........|
-000002a0  00 80 2e 4c af b1 f2 9c  de 14 92 81 c4 7d d1 2f  |...L.........}./|
-000002b0  a3 ba ba df 6f 26 da 2d  86 b4 1f 60 cd fe e7 c1  |....o&.-...`....|
-000002c0  77 02 a5 58 3f 6a fc 1d  ef 93 23 0a 9c c9 70 93  |w..X?j....#...p.|
-000002d0  f8 0c 67 fd 58 83 96 85  62 da 31 e7 a6 78 9f 1c  |..g.X...b.1..x..|
-000002e0  dc 02 b3 b8 bc 05 26 92  e8 6a e7 3c db 5f 80 ee  |......&..j.<._..|
-000002f0  12 75 ff e6 36 36 e6 75  c2 77 d9 63 ef 60 89 db  |.u..66.u.w.c.`..|
-00000300  21 aa 27 85 11 9b 8c eb  be a3 e3 34 0e 01 93 ca  |!.'........4....|
-00000310  a6 65 e3 cd 0f b8 b5 c6  f0 d7 15 69 db 4b 57 d2  |.e.........i.KW.|
-00000320  05 0d 14 03 03 00 01 01  16 03 03 00 28 00 00 00  |............(...|
-00000330  00 00 00 00 00 b5 09 a0  c4 55 89 df 8a 60 83 f3  |.........U...`..|
-00000340  82 12 55 1d d5 50 11 81  74 0f cd b5 ed 9a 00 e7  |..U..P..t.......|
-00000350  58 f7 65 0e 8d                                    |X.e..|
+000002a0  00 80 cb ab 63 1d e6 7e  16 22 27 8b e7 91 f4 5c  |....c..~."'....\|
+000002b0  66 fc 70 eb f7 e6 9c 86  7c 62 30 1c 78 35 bf 09  |f.p.....|b0.x5..|
+000002c0  af d1 5b e3 55 45 98 8d  4c 16 8e 69 cb 8f 45 97  |..[.UE..L..i..E.|
+000002d0  6d c4 6a 25 2a 47 43 64  ac 52 12 bd f5 b9 c0 b0  |m.j%*GCd.R......|
+000002e0  51 38 e7 d4 c8 a2 9c 35  4b 5b ab 21 76 73 68 fe  |Q8.....5K[.!vsh.|
+000002f0  d0 7a f2 95 3c 44 3b 55  b0 89 76 3e 42 e1 23 51  |.z..<D;U..v>B.#Q|
+00000300  29 92 3d 6a df 29 61 ee  52 f5 78 71 97 13 d6 09  |).=j.)a.R.xq....|
+00000310  ff 08 7a 5f 9d 20 49 83  2e 84 82 ba 08 69 db ae  |..z_. I......i..|
+00000320  e2 1b 14 03 03 00 01 01  16 03 03 00 28 00 00 00  |............(...|
+00000330  00 00 00 00 00 6a ff 4b  3d c1 06 20 69 ed f0 a8  |.....j.K=.. i...|
+00000340  7c ec a7 f8 cc 8e a6 de  2d 5e 50 f7 b2 28 9e 97  ||.......-^P..(..|
+00000350  27 35 c3 67 72                                    |'5.gr|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 3f eb 87 50 b0  |..........(?..P.|
-00000010  ae c2 fd 68 30 95 94 61  1c 78 1e 60 3e 38 17 ef  |...h0..a.x.`>8..|
-00000020  ed 9b f1 10 26 5e 53 a3  8c 46 2e 6c 24 b2 ab a7  |....&^S..F.l$...|
-00000030  6c f0 ea                                          |l..|
+00000000  14 03 03 00 01 01 16 03  03 00 28 e3 2f c4 66 7e  |..........(./.f~|
+00000010  8f bf 41 2e 56 f3 d1 76  63 f8 c0 b1 86 50 98 a0  |..A.V..vc....P..|
+00000020  63 c0 c9 23 68 c5 7c f7  08 17 0a 62 78 a8 3d 86  |c..#h.|....bx.=.|
+00000030  5c 1a c6                                          |\..|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 fe de 40  |...............@|
-00000010  52 50 79 da 5f 31 52 52  d8 96 04 35 86 92 03 0b  |RPy._1RR...5....|
-00000020  6f 5f 04 15 03 03 00 1a  00 00 00 00 00 00 00 02  |o_..............|
-00000030  9c 85 24 b0 a9 17 24 cf  18 f6 ef f5 0d c6 77 6d  |..$...$.......wm|
-00000040  e0 b2                                             |..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 e9 51 91  |..............Q.|
+00000010  f5 cb 2d b9 5e cb b3 52  14 7c e8 18 8f fe b6 ee  |..-.^..R.|......|
+00000020  7a 41 90 15 03 03 00 1a  00 00 00 00 00 00 00 02  |zA..............|
+00000030  d3 5f c1 e2 f5 12 40 c0  4c 1d ab ef 16 3a af 19  |._....@.L....:..|
+00000040  30 59                                             |0Y|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES
index 774cb40e3d..a17b1860e3 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 15 ed ca 52 59  |....]...Y.....RY|
-00000010  e2 56 80 e2 f3 20 5b 7d  52 f3 67 1f 01 0d ad 30  |.V... [}R.g....0|
-00000020  36 a6 43 c2 ed 5e 34 c5  24 89 e1 20 c7 4c 5d 06  |6.C..^4.$.. .L].|
-00000030  01 7a 80 aa 84 0c 46 48  63 36 49 4a 9b 3f 8d ba  |.z....FHc6IJ.?..|
-00000040  78 1b cd f9 ef 03 df cd  ee 2c b1 79 c0 09 00 00  |x........,.y....|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 be 37 6c 0c 68  |....]...Y...7l.h|
+00000010  bd 81 e4 4e 28 fa 5d 2c  03 8d 17 7a 47 b8 de 89  |...N(.],...zG...|
+00000020  3d 06 71 dd 40 c0 70 c1  a8 3d 00 20 22 7e 4c f8  |=.q.@.p..=. "~L.|
+00000030  1c 6b 13 c4 12 46 d3 de  c4 88 2e 41 c3 d7 df 10  |.k...F.....A....|
+00000040  23 aa 30 b1 34 a5 7b c9  03 fb d8 3e c0 09 00 00  |#.0.4.{....>....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
 00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
@@ -57,38 +59,38 @@
 00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
 00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
 00000270  95 12 07 8f 2a 16 03 03  00 b6 0c 00 00 b2 03 00  |....*...........|
-00000280  1d 20 b7 f5 92 bc 9b 4a  f9 62 3f 46 b8 b0 33 56  |. .....J.b?F..3V|
-00000290  1e 8d fc e9 68 af bf 67  9b a5 d0 9e a9 cc d9 65  |....h..g.......e|
-000002a0  7e 41 04 03 00 8a 30 81  87 02 41 08 b2 fe 6e 40  |~A....0...A...n@|
-000002b0  b7 5f 04 db eb 39 18 d5  e0 46 81 07 33 3a 29 fb  |._...9...F..3:).|
-000002c0  0b 19 76 ac 95 0d cd 4d  a4 f0 99 df 6d d6 73 79  |..v....M....m.sy|
-000002d0  ed 48 52 78 ea 7a 1d 4b  b1 67 d6 fd 21 3b c9 9d  |.HRx.z.K.g..!;..|
-000002e0  89 67 b7 b9 8e cf 35 28  62 28 3f 0b 02 42 01 7e  |.g....5(b(?..B.~|
-000002f0  4c a5 af 5b ba 3b d6 38  3b 34 b7 0c 69 27 92 ce  |L..[.;.8;4..i'..|
-00000300  34 ba bb 0d f6 32 65 fe  3c c0 9c 9d 92 88 b4 11  |4....2e.<.......|
-00000310  04 88 f5 b3 21 79 6c ed  6e f6 51 f5 e7 b1 3d 0d  |....!yl.n.Q...=.|
-00000320  bd d6 92 67 c8 90 71 7a  db cc cc 21 64 44 22 d4  |...g..qz...!dD".|
+00000280  1d 20 47 dc 78 14 d8 57  a7 37 29 1a 49 f6 07 09  |. G.x..W.7).I...|
+00000290  37 49 df 36 32 a1 e2 c9  67 e3 9c 40 ed f5 ac ea  |7I.62...g..@....|
+000002a0  c2 34 04 03 00 8a 30 81  87 02 41 14 f9 1f 8e 3d  |.4....0...A....=|
+000002b0  b6 d9 91 86 b0 b2 94 dd  14 89 47 b7 a5 2b d3 3a  |..........G..+.:|
+000002c0  b9 f8 ef 4c ae 5c 26 74  e8 c1 c5 18 f1 e5 cd 3f  |...L.\&t.......?|
+000002d0  4e 70 45 64 3b 53 14 b7  f7 86 bf d1 ee 3b cd ab  |NpEd;S.......;..|
+000002e0  cf 3a bd 12 c7 1e 89 fb  60 bf 34 be 02 42 01 7c  |.:......`.4..B.||
+000002f0  7b 7b 03 94 f9 1b 70 4c  25 3c c5 11 2c 1b e0 39  |{{....pL%<..,..9|
+00000300  6c ee d1 11 0e 73 82 97  06 c9 eb 92 44 cb 78 66  |l....s......D.xf|
+00000310  7c 9e 93 70 79 08 3e 20  90 ef 4b 9b 73 75 80 d4  ||..py.> ..K.su..|
+00000320  68 68 f0 06 b1 e8 d8 92  22 e0 07 a7 78 e7 e2 19  |hh......"...x...|
 00000330  16 03 03 00 04 0e 00 00  00                       |.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
 00000030  16 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000040  00 00 00 00 00 07 03 9e  fa a4 84 27 17 b8 dd 53  |...........'...S|
-00000050  12 4b 89 a1 47 98 22 e3  7b c8 d4 5c 18 bb 89 09  |.K..G.".{..\....|
-00000060  29 3a b9 af d3 38 4a 40  76 d6 15 37 80 19 9c ce  |):...8J@v..7....|
-00000070  32 5b 94 89 2e                                    |2[...|
+00000040  00 00 00 00 00 27 23 d3  72 40 80 76 5c b6 7a fd  |.....'#.r@.v\.z.|
+00000050  bf 45 9e 33 76 d1 3d 1b  77 23 90 ed 75 7b aa 91  |.E.3v.=.w#..u{..|
+00000060  f2 8e e7 b1 bb 69 86 84  b2 b5 40 2c 4a 1d f9 cf  |.....i....@,J...|
+00000070  3e de fe 39 36                                    |>..96|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 2d 53 b0 b0 c1  |..........@-S...|
-00000010  05 78 e3 3c 5d 57 a5 04  9a 4b b9 f7 56 ce 5a 76  |.x.<]W...K..V.Zv|
-00000020  84 4d f2 46 2e fc c2 9c  ec 37 2b 4d 99 88 ab 30  |.M.F.....7+M...0|
-00000030  1b 83 7d d8 72 bf e7 c7  f7 cf b8 13 54 d5 a2 a2  |..}.r.......T...|
-00000040  dc 76 b3 01 a4 d0 a5 cc  eb 66 29                 |.v.......f)|
+00000000  14 03 03 00 01 01 16 03  03 00 40 54 e0 6f 57 aa  |..........@T.oW.|
+00000010  e7 14 b0 06 69 45 42 ee  6c ce a7 0b a7 27 94 83  |....iEB.l....'..|
+00000020  cd 63 81 19 ac 06 1b 9f  78 86 5b 04 82 40 e7 41  |.c......x.[..@.A|
+00000030  f1 df 17 26 8a b4 1c f1  59 ca 43 6b 13 f8 d7 8b  |...&....Y.Ck....|
+00000040  4e ce 28 cd d2 9b ca c6  42 04 e6                 |N.(.....B..|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 11 31 80  89 b8 32 e7 66 a6 eb c5  |......1...2.f...|
-00000020  ca 4b f7 2b 47 73 e9 cd  9f 4e 9a 5e 3f 99 5a 29  |.K.+Gs...N.^?.Z)|
-00000030  00 0d 4f 4e 93 15 03 03  00 30 00 00 00 00 00 00  |..ON.....0......|
-00000040  00 00 00 00 00 00 00 00  00 00 d9 18 f4 dd 64 64  |..............dd|
-00000050  38 27 a7 96 d5 14 d1 b2  26 9c 14 96 54 2a cf d7  |8'......&...T*..|
-00000060  4c d0 b6 c3 20 fe 33 73  78 e5                    |L... .3sx.|
+00000010  00 00 00 00 00 d7 38 5f  c6 c8 c8 c0 2e fc 08 d7  |......8_........|
+00000020  40 aa 3d 6a 90 75 2f 90  c4 33 d9 a8 50 db 57 f6  |@.=j.u/..3..P.W.|
+00000030  3e 4d 03 c8 b0 15 03 03  00 30 00 00 00 00 00 00  |>M.......0......|
+00000040  00 00 00 00 00 00 00 00  00 00 bf 0d 85 fb 60 57  |..............`W|
+00000050  02 4a 5f 95 9e 6b 00 6e  6e e6 a9 3e 6d fd 62 b9  |.J_..k.nn..>m.b.|
+00000060  79 d3 5e e2 63 cd 3b f1  a8 0d                    |y.^.c.;...|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM
index 86095340d4..93bdcc53b2 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 e1 ed 2c 5d 15  |....]...Y....,].|
-00000010  15 24 d2 e3 a0 58 fb 2f  89 a3 26 b1 c8 06 0f dc  |.$...X./..&.....|
-00000020  ef e1 a7 a4 81 4a 71 2c  1d a2 35 20 be ff 22 db  |.....Jq,..5 ..".|
-00000030  2d 33 1b 11 24 55 96 96  54 5f 62 c7 7f b5 ba 32  |-3..$U..T_b....2|
-00000040  e7 e6 7c 11 68 f8 97 d1  17 f7 8f 4f c0 2b 00 00  |..|.h......O.+..|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 a7 4e f4 80 a2  |....]...Y...N...|
+00000010  78 28 eb 69 72 3a 45 21  e6 dd 67 7c a4 64 70 97  |x(.ir:E!..g|.dp.|
+00000020  51 60 f1 e3 27 16 b2 08  54 2d 78 20 07 7c ed b5  |Q`..'...T-x .|..|
+00000030  dd aa 68 7a a6 8b 85 3d  49 be e4 78 ac 47 b1 02  |..hz...=I..x.G..|
+00000040  15 35 ea f2 db 4b 03 f3  29 f3 d1 87 c0 2b 00 00  |.5...K..)....+..|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
 00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
@@ -57,33 +59,33 @@
 00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
 00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
 00000270  95 12 07 8f 2a 16 03 03  00 b6 0c 00 00 b2 03 00  |....*...........|
-00000280  1d 20 74 55 23 1a ff ed  d3 e7 95 30 ee ed 6d 77  |. tU#......0..mw|
-00000290  57 83 fb 09 fc 81 70 69  d8 ae 38 1b e7 da 7f c6  |W.....pi..8.....|
-000002a0  e4 01 04 03 00 8a 30 81  87 02 41 36 52 ca 91 b7  |......0...A6R...|
-000002b0  a2 b2 31 91 98 96 65 92  67 a6 9c f2 75 8a 00 91  |..1...e.g...u...|
-000002c0  8e 17 bd 22 d2 6c cb 16  0a fb 6b 27 08 3b f9 e4  |...".l....k'.;..|
-000002d0  7c b5 21 45 60 4c c0 71  0b 28 46 d2 a8 a2 ad ad  ||.!E`L.q.(F.....|
-000002e0  51 fd bc 2e 40 7d 06 89  e7 b8 07 df 02 42 00 86  |Q...@}.......B..|
-000002f0  83 4f 1d c1 c0 6d 3c f3  ed 24 47 70 65 e9 7c 5e  |.O...m<..$Gpe.|^|
-00000300  27 43 f0 05 b8 cd a4 34  ba 69 bc 81 7c fb b1 c3  |'C.....4.i..|...|
-00000310  f8 bc 99 d6 90 15 8f db  21 fe 9f 18 10 23 75 6d  |........!....#um|
-00000320  22 b2 c6 f4 a5 60 80 31  06 a3 ad 33 88 c4 52 5d  |"....`.1...3..R]|
+00000280  1d 20 26 c9 de 9d 39 5a  31 f1 7c 95 e8 c4 13 8f  |. &...9Z1.|.....|
+00000290  a7 ac 82 75 12 ac 50 ad  15 41 c9 e8 92 24 1a d1  |...u..P..A...$..|
+000002a0  c8 2b 04 03 00 8a 30 81  87 02 41 15 01 bf f7 9b  |.+....0...A.....|
+000002b0  94 32 92 67 13 9a c6 f5  31 f8 42 67 a3 74 79 24  |.2.g....1.Bg.ty$|
+000002c0  55 e5 d3 f4 14 e1 3e 5e  ac 65 8c 28 48 d5 ee 05  |U.....>^.e.(H...|
+000002d0  d0 12 96 5b 8f 14 30 fa  ce e7 19 ee f0 38 86 c2  |...[..0......8..|
+000002e0  f4 32 0a 0c d9 7d 9e 40  9b 11 a4 0e 02 42 00 fb  |.2...}.@.....B..|
+000002f0  c7 0f 07 f9 87 f7 ea af  30 3a 04 e7 6a 89 3f bd  |........0:..j.?.|
+00000300  39 3f 20 0e b5 b0 aa 5f  29 ea c4 69 22 fb 38 9f  |9? ...._)..i".8.|
+00000310  35 e1 35 a6 80 86 2d eb  bc bf 01 e9 56 78 ca 21  |5.5...-.....Vx.!|
+00000320  68 a3 01 07 3c 9e 7f c2  9a 11 3d ef b7 ce 6e 02  |h...<.....=...n.|
 00000330  16 03 03 00 04 0e 00 00  00                       |.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 6b 3d 83  |....(........k=.|
-00000040  88 db aa b0 62 30 8d 4a  6c b2 f1 14 d3 99 43 65  |....b0.Jl.....Ce|
-00000050  4c ef 26 a4 ba 46 2f 75  9a 05 0c f2 91           |L.&..F/u.....|
+00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 32 28 d6  |....(........2(.|
+00000040  94 ba 29 2f 2b 40 56 07  0b fd a7 ce a7 79 94 b6  |..)/+@V......y..|
+00000050  f6 e4 dd eb a6 23 f3 97  8c 1f c6 a5 52           |.....#......R|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 d5 c2 de 26 c1  |..........(...&.|
-00000010  ed 28 f1 d8 81 b3 9a 4f  3d 82 ad 22 d0 2c 41 61  |.(.....O=..".,Aa|
-00000020  8b 15 a3 72 01 94 44 ff  8f 01 c1 05 e6 84 56 0a  |...r..D.......V.|
-00000030  8b 1d c4                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 28 73 67 36 43 96  |..........(sg6C.|
+00000010  59 15 59 7a dd 3c 3f d5  88 bf 55 e1 cb d0 41 10  |Y.Yz.<?...U...A.|
+00000020  df f1 85 72 9e 87 7f fd  e8 b0 62 61 41 10 42 1e  |...r......baA.B.|
+00000030  2d 34 e1                                          |-4.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 c7 7d a7  |..............}.|
-00000010  c4 a5 a1 21 94 7a 23 bc  05 44 7d 4a 2f 16 dc 95  |...!.z#..D}J/...|
-00000020  25 6e 17 15 03 03 00 1a  00 00 00 00 00 00 00 02  |%n..............|
-00000030  77 fa b6 34 7e 60 77 f9  a5 09 d1 39 b0 1e 66 86  |w..4~`w....9..f.|
-00000040  50 41                                             |PA|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 31 23 80  |.............1#.|
+00000010  a4 01 5a f9 7c 3b fc 2f  4d 70 4e 4f 8f 69 fc 99  |..Z.|;./MpNO.i..|
+00000020  d4 7a a7 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.z..............|
+00000030  37 75 3a 5a 6c d8 5a fd  0d cf 1f 88 67 2c 48 89  |7u:Zl.Z.....g,H.|
+00000040  6c 9e                                             |l.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES128-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES128-SHA256
index ac5d07e69d..eed1e965d1 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES128-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES128-SHA256
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 36 c3 50 72 b9  |....]...Y..6.Pr.|
-00000010  0d e9 d9 76 1d 31 72 e6  61 ec 3e 13 93 d7 f1 52  |...v.1r.a.>....R|
-00000020  a7 36 5c 16 9a cc c5 c0  da 7e f3 20 31 79 7a ec  |.6\......~. 1yz.|
-00000030  1d db f7 cd 0a fe b3 86  6f 43 12 f4 9d 19 16 51  |........oC.....Q|
-00000040  e2 42 1b 94 43 13 71 67  2d 52 7a 86 c0 23 00 00  |.B..C.qg-Rz..#..|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 83 27 64 12 65  |....]...Y...'d.e|
+00000010  ed df dd 5e 6c 79 e4 7b  fe fd 05 26 e0 c8 5a ca  |...^ly.{...&..Z.|
+00000020  fa 08 c2 2a 78 e1 65 33  b3 b9 82 20 01 95 06 02  |...*x.e3... ....|
+00000030  41 f4 d7 e9 64 9a a8 91  df dc 15 d0 87 02 28 7c  |A...d.........(||
+00000040  e2 75 8c 94 a3 0f 20 19  e6 e8 c4 b7 c0 23 00 00  |.u.... ......#..|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
 00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
@@ -56,43 +58,43 @@
 00000240  8c 25 c1 33 13 83 0d 94  06 bb d4 37 7a f6 ec 7a  |.%.3.......7z..z|
 00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
 00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
-00000270  95 12 07 8f 2a 16 03 03  00 b7 0c 00 00 b3 03 00  |....*...........|
-00000280  1d 20 d2 2d 0f 11 29 eb  b4 23 67 1c 40 84 7f 7e  |. .-..)..#g.@..~|
-00000290  cd 8c 3d c2 62 ed 9b 0f  08 01 5b a5 fd 86 31 c5  |..=.b.....[...1.|
-000002a0  d2 76 04 03 00 8b 30 81  88 02 42 01 a4 ea c8 67  |.v....0...B....g|
-000002b0  c0 0a 93 23 7c d9 41 17  ba 91 02 78 c7 16 28 85  |...#|.A....x..(.|
-000002c0  b8 d6 5c ed ed 20 1e 8b  90 e0 19 db 67 72 7e d3  |..\.. ......gr~.|
-000002d0  2c 2e 84 6a d7 bc b7 53  74 8b 1b ef a8 bc 39 d8  |,..j...St.....9.|
-000002e0  e0 75 29 6b 1d 89 c3 12  c2 3c 51 25 84 02 42 01  |.u)k.....<Q%..B.|
-000002f0  4e 37 c9 2d 59 48 df 15  33 45 dc 4d e9 46 78 8e  |N7.-YH..3E.M.Fx.|
-00000300  cc 1e ef c4 2b ea c8 bc  a1 2e 58 18 60 a2 98 5a  |....+.....X.`..Z|
-00000310  cf 95 0d 18 6a f7 67 cb  6d a4 4a 5b 0d f1 ee 5e  |....j.g.m.J[...^|
-00000320  08 80 e5 90 cc 9a 5e 7f  ea 69 5f a9 0f f3 a2 9b  |......^..i_.....|
-00000330  15 16 03 03 00 04 0e 00  00 00                    |..........|
+00000270  95 12 07 8f 2a 16 03 03  00 b5 0c 00 00 b1 03 00  |....*...........|
+00000280  1d 20 69 77 9a 39 8f bb  af a5 cd 5e 60 af f9 6a  |. iw.9.....^`..j|
+00000290  dc e7 2a 36 a9 bc 47 e1  fa 2d 3f a6 91 1e 6f ae  |..*6..G..-?...o.|
+000002a0  43 01 04 03 00 89 30 81  86 02 41 01 b7 fa da 05  |C.....0...A.....|
+000002b0  7c 23 3c b6 32 ea 79 ea  7c 48 62 62 c1 af 4c ff  ||#<.2.y.|Hbb..L.|
+000002c0  3f 1f e6 11 a5 8e 78 76  f6 40 d3 27 a1 24 87 90  |?.....xv.@.'.$..|
+000002d0  14 5b 66 75 31 00 0a 97  f8 98 25 af 3c 59 39 a9  |.[fu1.....%.<Y9.|
+000002e0  3a df 7b 01 ac 0b 2d 69  96 f9 89 43 02 41 6f fd  |:.{...-i...C.Ao.|
+000002f0  1f 23 6d 10 61 1e 13 27  cf 44 9e 98 46 4b d3 6c  |.#m.a..'.D..FK.l|
+00000300  d4 54 57 18 85 3d 3b 19  5e 32 9c 5f 33 96 58 0e  |.TW..=;.^2._3.X.|
+00000310  b0 b6 40 89 2b 73 bb 4c  34 74 57 01 f3 8a cb 7e  |..@.+s.L4tW....~|
+00000320  6f b2 df b4 d1 d7 1b 64  df 46 0f 96 02 fd f9 16  |o......d.F......|
+00000330  03 03 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
 00000030  16 03 03 00 50 00 00 00  00 00 00 00 00 00 00 00  |....P...........|
-00000040  00 00 00 00 00 98 8d 15  68 8c 12 3e 4a 88 64 7c  |........h..>J.d||
-00000050  69 46 25 16 66 20 d7 f5  7e 08 d8 9d c4 89 c1 cf  |iF%.f ..~.......|
-00000060  ac 86 b7 ce 3a 9c 95 0c  5d d1 a2 c2 bf fd 7c e1  |....:...].....|.|
-00000070  b5 f4 04 7e 71 ae 3c fc  d2 c1 2a ec 81 e4 62 a6  |...~q.<...*...b.|
-00000080  e6 05 72 d8 9e                                    |..r..|
+00000040  00 00 00 00 00 1b 00 be  75 a8 f7 e4 b6 76 b2 7c  |........u....v.||
+00000050  30 bb 35 a2 e0 d1 ea 35  83 6d 05 6b 29 0f 4e 80  |0.5....5.m.k).N.|
+00000060  26 16 53 96 67 8e 71 ed  4a 32 1a 9f f3 8d de 34  |&.S.g.q.J2.....4|
+00000070  cb d4 b4 11 c8 7d 05 36  21 87 2b ae 33 92 d3 16  |.....}.6!.+.3...|
+00000080  1c b6 3b a3 6d                                    |..;.m|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 50 27 94 9b d3 f1  |..........P'....|
-00000010  6c 59 bb fa b7 73 8b d6  fa b2 ca c1 0c d3 60 cf  |lY...s........`.|
-00000020  50 18 a6 6f 3d b3 46 a1  06 a2 b1 62 4c ea 88 2f  |P..o=.F....bL../|
-00000030  95 bc 35 6f 55 a6 8a 52  69 6c 5b a5 fc 94 2a b6  |..5oU..Ril[...*.|
-00000040  27 7c d7 95 27 72 d4 c1  f2 f9 9c a5 b3 2a 85 52  |'|..'r.......*.R|
-00000050  ae bf 14 52 54 51 6a fe  a1 99 05                 |...RTQj....|
+00000000  14 03 03 00 01 01 16 03  03 00 50 c0 c8 04 54 26  |..........P...T&|
+00000010  72 7d 0d a5 86 d5 92 7b  09 73 02 62 37 7a 86 6f  |r}.....{.s.b7z.o|
+00000020  5b 31 1f 28 42 3c 98 2b  08 20 03 55 c0 d6 bd 62  |[1.(B<.+. .U...b|
+00000030  8b c4 18 57 f1 d8 51 ef  f1 93 6b 70 af 72 95 06  |...W..Q...kp.r..|
+00000040  77 91 b5 37 b3 31 73 a4  a3 fb bb 63 9d 41 45 30  |w..7.1s....c.AE0|
+00000050  b4 07 43 8a 74 44 83 16  50 22 a0                 |..C.tD..P".|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000010  00 00 00 00 00 9b b4 f6  7e 49 48 09 cd 4f ed 22  |........~IH..O."|
-00000020  68 db 19 94 ad af de d1  9b b6 bc f5 d6 7f c6 b2  |h...............|
-00000030  ff b1 0e b4 0e dd 77 19  e8 9e ff 68 1a 04 fc e5  |......w....h....|
-00000040  f2 3b 5b 34 aa 15 03 03  00 40 00 00 00 00 00 00  |.;[4.....@......|
-00000050  00 00 00 00 00 00 00 00  00 00 f7 95 04 54 94 ff  |.............T..|
-00000060  f7 86 df 0a 2e 5b e9 54  fe 13 30 2a 97 f9 21 8e  |.....[.T..0*..!.|
-00000070  83 8b ba 86 77 67 92 33  5e a8 ea b7 64 65 63 59  |....wg.3^...decY|
-00000080  44 2e 65 60 9a 0a 7c 78  97 a4                    |D.e`..|x..|
+00000010  00 00 00 00 00 ba c5 0e  9d f6 a1 64 f9 13 fa aa  |...........d....|
+00000020  07 1f cb d1 b6 f3 42 11  ac 2e aa 08 a4 f6 67 9e  |......B.......g.|
+00000030  1d d9 35 6a 70 85 24 25  aa b0 f3 13 87 fd 9e d5  |..5jp.$%........|
+00000040  69 60 88 bc 5c 15 03 03  00 40 00 00 00 00 00 00  |i`..\....@......|
+00000050  00 00 00 00 00 00 00 00  00 00 41 86 ed 8a 40 26  |..........A...@&|
+00000060  39 b4 bf 47 01 bf a9 9c  df 12 07 f0 dc 64 2f 5b  |9..G.........d/[|
+00000070  1e 44 94 78 85 b7 d8 92  f1 d4 d6 a7 d2 39 b5 3f  |.D.x.........9.?|
+00000080  f9 e0 78 d6 40 61 c9 4e  b0 32                    |..x.@a.N.2|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384 b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384
index ad5fa50146..2a1b29189c 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 54 28 b4 3e d3  |....]...Y..T(.>.|
-00000010  f8 21 2a 34 c9 6b 54 76  aa d2 cf 5e 07 7a aa e2  |.!*4.kTv...^.z..|
-00000020  10 cb 3e ed 87 f4 3e 70  44 d0 35 20 6e b4 f0 71  |..>...>pD.5 n..q|
-00000030  76 96 1e 2a 57 74 4b db  9a 11 0a af 06 ea 3b 20  |v..*WtK.......; |
-00000040  a8 81 51 9d 41 ef f1 f9  23 87 18 cb c0 2c 00 00  |..Q.A...#....,..|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 77 69 ed c9 15  |....]...Y..wi...|
+00000010  48 74 3a b5 29 8b 17 d7  88 88 33 ac 7d 5e b2 c1  |Ht:.).....3.}^..|
+00000020  73 a8 e2 4c 5e 66 a6 07  54 57 0e 20 9f b9 f0 03  |s..L^f..TW. ....|
+00000030  74 51 4a bc 23 0b 4c 6d  e3 09 8a d9 1f 09 68 33  |tQJ.#.Lm......h3|
+00000040  d7 13 a7 7a 8e 34 73 73  97 32 a6 02 c0 2c 00 00  |...z.4ss.2...,..|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
 00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
@@ -56,34 +58,34 @@
 00000240  8c 25 c1 33 13 83 0d 94  06 bb d4 37 7a f6 ec 7a  |.%.3.......7z..z|
 00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
 00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
-00000270  95 12 07 8f 2a 16 03 03  00 b7 0c 00 00 b3 03 00  |....*...........|
-00000280  1d 20 de df 32 23 35 b3  79 a9 49 c2 b3 ad 0c d6  |. ..2#5.y.I.....|
-00000290  23 a6 6a 9b 0f e3 52 51  7b bc f2 79 00 c9 a4 a0  |#.j...RQ{..y....|
-000002a0  94 02 04 03 00 8b 30 81  88 02 42 01 8c 12 91 28  |......0...B....(|
-000002b0  d4 6d cd 39 62 75 9a e0  e5 dd ea 31 45 f5 cd 8b  |.m.9bu.....1E...|
-000002c0  28 82 14 f5 e9 61 0e 9d  af 42 06 17 42 e9 24 1c  |(....a...B..B.$.|
-000002d0  2b 1a c8 77 e4 7a 82 2b  b0 dd 28 3f 76 5d dd fd  |+..w.z.+..(?v]..|
-000002e0  20 53 87 e6 77 26 be 45  e4 6d 31 e3 bf 02 42 01  | S..w&.E.m1...B.|
-000002f0  70 c5 97 3a e4 7b 80 2b  1b eb c9 b2 0a 79 92 2e  |p..:.{.+.....y..|
-00000300  3d b1 4d 13 69 d2 60 a9  fd e9 66 56 83 e4 f5 6a  |=.M.i.`...fV...j|
-00000310  ae cd 8b 94 9f 0b 70 81  b1 ed c6 0d 5f 33 42 04  |......p....._3B.|
-00000320  3d f7 b6 d3 e9 09 b8 bf  43 8c 19 d5 7d 60 d6 a9  |=.......C...}`..|
-00000330  f7 16 03 03 00 04 0e 00  00 00                    |..........|
+00000270  95 12 07 8f 2a 16 03 03  00 b6 0c 00 00 b2 03 00  |....*...........|
+00000280  1d 20 a4 6e f2 07 14 a1  e4 02 87 6c 49 4e bf 77  |. .n.......lIN.w|
+00000290  c0 d9 85 13 9a 65 b7 a7  27 d7 1c 34 c4 91 bc fb  |.....e..'..4....|
+000002a0  ef 31 04 03 00 8a 30 81  87 02 42 00 8f a1 f7 fa  |.1....0...B.....|
+000002b0  18 35 a7 14 ed 02 80 4d  12 bd 07 91 5c b1 e0 8f  |.5.....M....\...|
+000002c0  c8 74 e9 37 04 56 96 8a  f3 57 42 a0 53 18 45 ad  |.t.7.V...WB.S.E.|
+000002d0  1d 90 27 fb 75 f8 d2 df  e2 e7 ad b5 98 f1 b2 88  |..'.u...........|
+000002e0  d9 e0 9d 46 fb 53 6d 5a  95 31 75 a4 1e 02 41 3f  |...F.SmZ.1u...A?|
+000002f0  63 12 d6 e0 8a 92 81 7d  93 fe f6 98 5a a7 75 13  |c......}....Z.u.|
+00000300  be 4e 31 8c b0 ee a7 41  82 fe b4 05 01 69 7f 61  |.N1....A.....i.a|
+00000310  65 41 d3 9e 59 37 03 e9  e0 4b 18 88 a5 67 d2 c1  |eA..Y7...K...g..|
+00000320  83 22 3a 09 88 c0 6e b7  e5 a4 c3 e8 ce d9 3c cc  |.":...n.......<.|
+00000330  16 03 03 00 04 0e 00 00  00                       |.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 a7 5d c9  |....(.........].|
-00000040  e7 6b 78 13 ae 11 64 d0  e7 77 48 03 d4 cf b9 65  |.kx...d..wH....e|
-00000050  7f 07 75 78 7f 3d ae a1  9a 0f fb cb 74           |..ux.=......t|
+00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 dd 37 75  |....(.........7u|
+00000040  d9 75 19 9e aa 4b dd 1e  c7 af 7f 26 e2 72 30 92  |.u...K.....&.r0.|
+00000050  70 68 97 ce 03 e3 a2 99  9a 85 1a c8 09           |ph...........|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 07 4e 69 71 66  |..........(.Niqf|
-00000010  75 a0 bb b4 fd 86 8d 74  40 7e 0d e9 a5 95 d0 2d  |u......t@~.....-|
-00000020  ca eb 12 2f 7b 09 22 7c  8e bf da 97 18 d9 bd 74  |.../{."|.......t|
-00000030  cd 08 6b                                          |..k|
+00000000  14 03 03 00 01 01 16 03  03 00 28 f2 ba 40 ec e3  |..........(..@..|
+00000010  77 30 c8 b1 b3 3f 97 f1  28 3b 59 26 2c a0 d3 19  |w0...?..(;Y&,...|
+00000020  4a bd d3 f1 5d e3 6c 62  56 ee 75 75 05 05 3c 1c  |J...].lbV.uu..<.|
+00000030  17 98 0a                                          |...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 44 26 54  |.............D&T|
-00000010  a3 37 94 7a 3d 93 6a 06  35 fe 9a d4 7b 54 ab d4  |.7.z=.j.5...{T..|
-00000020  33 fd 93 15 03 03 00 1a  00 00 00 00 00 00 00 02  |3...............|
-00000030  bf ff c7 9e 4b db ee a4  a2 b9 a5 91 cd 09 97 a2  |....K...........|
-00000040  55 a5                                             |U.|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 0b bc a8  |................|
+00000010  12 42 1b c7 8e a4 e9 26  65 4d 89 d6 e1 f0 33 67  |.B.....&eM....3g|
+00000020  5a 29 8c 15 03 03 00 1a  00 00 00 00 00 00 00 02  |Z)..............|
+00000030  42 d5 85 47 7f 6e b0 ad  23 13 74 44 84 75 4b 85  |B..G.n..#.tD.uK.|
+00000040  22 3a                                             |":|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-CHACHA20-POLY1305 b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-CHACHA20-POLY1305
index 9982121ef8..3cea374342 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-CHACHA20-POLY1305
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-CHACHA20-POLY1305
@@ -1,24 +1,26 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 d4 01 00 00  d0 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 f2 01 00 00  ee 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 00 08 cc a9  |................|
-00000050  13 03 13 01 13 02 01 00  00 7f 00 0b 00 02 01 00  |................|
+00000050  13 03 13 01 13 02 01 00  00 9d 00 0b 00 02 01 00  |................|
 00000060  ff 01 00 01 00 00 17 00  00 00 12 00 00 00 05 00  |................|
 00000070  05 01 00 00 00 00 00 0a  00 0a 00 08 00 1d 00 17  |................|
 00000080  00 18 00 19 00 0d 00 1a  00 18 08 04 04 03 08 07  |................|
 00000090  08 05 08 06 04 01 05 01  06 01 05 03 06 03 02 01  |................|
-000000a0  02 03 00 2b 00 09 08 03  04 03 03 03 02 03 01 00  |...+............|
-000000b0  33 00 26 00 24 00 1d 00  20 2f e5 7d a3 47 cd 62  |3.&.$... /.}.G.b|
-000000c0  43 15 28 da ac 5f bb 29  07 30 ff f6 84 af c4 cf  |C.(.._.).0......|
-000000d0  c2 ed 90 99 5f 58 cb 3b  74                       |...._X.;t|
+000000a0  02 03 00 32 00 1a 00 18  08 04 04 03 08 07 08 05  |...2............|
+000000b0  08 06 04 01 05 01 06 01  05 03 06 03 02 01 02 03  |................|
+000000c0  00 2b 00 09 08 03 04 03  03 03 02 03 01 00 33 00  |.+............3.|
+000000d0  26 00 24 00 1d 00 20 2f  e5 7d a3 47 cd 62 43 15  |&.$... /.}.G.bC.|
+000000e0  28 da ac 5f bb 29 07 30  ff f6 84 af c4 cf c2 ed  |(.._.).0........|
+000000f0  90 99 5f 58 cb 3b 74                              |.._X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 4f ed 35 28 41  |....]...Y..O.5(A|
-00000010  4a 0f a2 da 57 ef 60 69  32 00 a5 82 22 3d d9 ea  |J...W.`i2..."=..|
-00000020  36 28 20 31 e3 4a b6 d1  b6 b4 49 20 97 f3 45 59  |6( 1.J....I ..EY|
-00000030  e7 9c f5 40 57 51 b8 f8  5a 8d f2 eb ce 83 18 2d  |...@WQ..Z......-|
-00000040  e3 28 55 6f 17 08 23 88  57 b1 a0 e4 cc a9 00 00  |.(Uo..#.W.......|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 32 3b b0 38 26  |....]...Y..2;.8&|
+00000010  a2 4b 38 02 83 42 af 10  77 e7 6b a9 d6 e7 ac c8  |.K8..B..w.k.....|
+00000020  69 ba 70 cb f8 de 6d 28  a9 b5 40 20 9f f0 a4 35  |i.p...m(..@ ...5|
+00000030  3e eb cf 99 5a 69 6c 0c  9d 45 21 ca fe e7 03 52  |>...Zil..E!....R|
+00000040  39 66 c5 90 1f 75 57 9d  03 51 3b 21 cc a9 00 00  |9f...uW..Q;!....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
 00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
@@ -54,31 +56,31 @@
 00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
 00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
 00000270  95 12 07 8f 2a 16 03 03  00 b7 0c 00 00 b3 03 00  |....*...........|
-00000280  1d 20 64 49 59 eb a9 80  c3 0a 9e 13 f4 09 04 6b  |. dIY..........k|
-00000290  1f e5 3b 0b 77 84 fe 2e  1f ea 7e d4 64 2a 7f 3f  |..;.w.....~.d*.?|
-000002a0  dc 0f 04 03 00 8b 30 81  88 02 42 00 a4 62 9b d1  |......0...B..b..|
-000002b0  ed 60 b7 2d 05 48 64 b6  94 3b a1 75 cb 41 78 e5  |.`.-.Hd..;.u.Ax.|
-000002c0  e0 12 70 d9 90 4d c0 34  39 f3 52 13 75 4b fa 10  |..p..M.49.R.uK..|
-000002d0  19 6f a6 2d b4 c3 8f 45  0c 7f 34 fb 82 01 e6 a1  |.o.-...E..4.....|
-000002e0  be 73 72 3b e5 04 80 70  7d bd 4a f9 e5 02 42 01  |.sr;...p}.J...B.|
-000002f0  69 3d 53 e9 8d 70 6d 07  84 7e 56 3f ce 53 b9 6c  |i=S..pm..~V?.S.l|
-00000300  43 0f 70 74 f1 52 ce d4  95 55 13 8c 07 e7 20 d7  |C.pt.R...U.... .|
-00000310  61 2e b7 f4 5b 34 6e 5d  9c d8 73 66 89 a1 f6 7e  |a...[4n]..sf...~|
-00000320  01 bb 9a 5e 52 59 3f fc  3e 24 fc e7 49 10 83 9d  |...^RY?.>$..I...|
-00000330  fb 16 03 03 00 04 0e 00  00 00                    |..........|
+00000280  1d 20 b4 e4 ee 96 88 73  de d8 bc 4f 90 ca fa df  |. .....s...O....|
+00000290  26 b4 88 19 04 0e d1 be  0f 3c bb 23 68 0e a6 20  |&........<.#h.. |
+000002a0  39 17 04 03 00 8b 30 81  88 02 42 00 c7 4a 60 ba  |9.....0...B..J`.|
+000002b0  7d 8f 8a 69 93 dc 5b 9d  ce a1 33 82 ed 95 00 fb  |}..i..[...3.....|
+000002c0  96 6b 31 d9 3a 10 80 fd  03 5f d2 63 40 e1 26 75  |.k1.:...._.c@.&u|
+000002d0  d3 bd d7 4e 79 c7 1a 82  c2 3b ef e0 72 c2 a6 d3  |...Ny....;..r...|
+000002e0  28 bb d4 49 46 39 8d bd  03 9d a8 98 8b 02 42 01  |(..IF9........B.|
+000002f0  d2 51 90 9c 41 a2 51 24  8f 2e 4a 24 31 69 91 d0  |.Q..A.Q$..J$1i..|
+00000300  c3 39 0b f6 55 3e e7 b0  43 36 99 50 dd c6 45 9a  |.9..U>..C6.P..E.|
+00000310  a7 e3 c0 65 c9 b5 02 85  f6 f1 55 b2 f6 f9 8e 30  |...e......U....0|
+00000320  3b 2a 3d 8a 5c 51 31 5d  9a 3f 9d e5 63 a9 4e ba  |;*=.\Q1].?..c.N.|
+00000330  fe 16 03 03 00 04 0e 00  00 00                    |..........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 cf f9 90  26 e8 2c 00 99 ae 0e e6  |.... ...&.,.....|
-00000040  a8 d9 66 6b 23 e7 c9 73  1c f7 e9 af e1 71 1d f3  |..fk#..s.....q..|
-00000050  34 60 ee 16 9d                                    |4`...|
+00000030  16 03 03 00 20 ae 4e 75  d9 a7 be a2 6c 68 b0 19  |.... .Nu....lh..|
+00000040  b6 ef dd 90 f6 6b 27 ce  52 23 66 56 54 4a e0 b7  |.....k'.R#fVTJ..|
+00000050  d8 77 fc be 32                                    |.w..2|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 39 9f 39 3a 22  |.......... 9.9:"|
-00000010  0b 27 cb 75 0d 43 98 11  06 dd 7e 73 17 e0 8a 19  |.'.u.C....~s....|
-00000020  6d eb a8 33 c6 42 b4 e9  cb dd b1                 |m..3.B.....|
+00000000  14 03 03 00 01 01 16 03  03 00 20 b5 41 67 54 66  |.......... .AgTf|
+00000010  94 8b 39 45 fb aa 66 f7  01 4b 4d d3 55 03 56 b3  |..9E..f..KM.U.V.|
+00000020  2b 08 ca bb 29 f5 0c 6b  12 8d 76                 |+...)..k..v|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 24 1f 08  49 ef 32 16 8d 76 c7 34  |.....$..I.2..v.4|
-00000010  e0 08 cb d9 e7 72 aa 0f  fb c4 94 15 03 03 00 12  |.....r..........|
-00000020  38 0b 8c e0 0b 61 20 e8  a6 7c 77 69 fb 00 96 39  |8....a ..|wi...9|
-00000030  b9 a7                                             |..|
+00000000  17 03 03 00 16 7b 7f a6  ce de 59 a8 56 2f 1b a0  |.....{....Y.V/..|
+00000010  30 39 9d 87 41 3e bf 7c  af 5d f8 15 03 03 00 12  |09..A>.|.]......|
+00000020  47 4e 8a e8 c7 b7 5e d2  0d 57 f5 7d 85 91 08 f6  |GN....^..W.}....|
+00000030  57 b9                                             |W.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES
index e2e935cc2e..2e8cf680f7 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 8d 69 e3 6e 69  |....]...Y...i.ni|
-00000010  45 96 8b 0d c8 7d 9c dc  b6 75 24 ee 61 44 95 99  |E....}...u$.aD..|
-00000020  cb a8 da df 35 ac c3 36  02 3f b9 20 2d c2 47 c9  |....5..6.?. -.G.|
-00000030  f0 47 80 9a c6 bd e4 1b  ca d6 62 17 59 ec c9 83  |.G........b.Y...|
-00000040  d5 ed 3f 2c 13 b0 30 0a  5e 1f 0e db c0 13 00 00  |..?,..0.^.......|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 aa fb 37 3d 67  |....]...Y....7=g|
+00000010  95 94 f7 8e 74 8b 21 20  8b 63 e3 61 7f 00 53 e7  |....t.! .c.a..S.|
+00000020  cc 9e b4 72 3e ae e5 36  93 b8 17 20 be 6d 69 ec  |...r>..6... .mi.|
+00000030  ba 51 86 16 80 1e e5 dc  59 d2 6f d5 c0 28 0c bd  |.Q......Y.o..(..|
+00000040  98 3b 5f 7b 70 36 ce 40  cd 37 23 98 c0 13 00 00  |.;_{p6.@.7#.....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -61,38 +63,38 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 0f 4e 12  |............ .N.|
-000002d0  ab ce 7e 62 68 64 e0 1d  7e 33 a2 ee 5d e7 2d d5  |..~bhd..~3..].-.|
-000002e0  d2 dc d0 ce b2 7e 9b be  33 8d 9c 56 7a 08 04 00  |.....~..3..Vz...|
-000002f0  80 44 b8 9b 87 5f 84 f6  8a 99 af e9 f7 f8 88 fd  |.D..._..........|
-00000300  f7 12 02 48 a1 fa 66 9c  89 a2 dc bf fd 41 08 fa  |...H..f......A..|
-00000310  6f e4 44 09 8e c1 45 bb  2a e9 e3 45 19 a3 81 50  |o.D...E.*..E...P|
-00000320  99 46 5f 86 5b 6b c0 29  d1 e5 21 4b 56 af f4 d0  |.F_.[k.)..!KV...|
-00000330  63 c4 75 ac f6 75 61 ca  fe 1a b9 70 4d 14 50 b1  |c.u..ua....pM.P.|
-00000340  12 7f 29 2d c5 d7 78 da  06 3e 4c 47 75 8a a6 01  |..)-..x..>LGu...|
-00000350  37 17 1c e8 ef 94 85 d0  e2 ee d5 25 ae 8d f8 e6  |7..........%....|
-00000360  90 10 12 37 b4 0f f5 c7  a2 85 1a 83 8a 38 e6 32  |...7.........8.2|
-00000370  98 16 03 03 00 04 0e 00  00 00                    |..........|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 67 97 c9  |............ g..|
+000002d0  92 1a a5 f1 e1 9b 81 36  74 0a 00 b1 f9 78 a3 0e  |.......6t....x..|
+000002e0  a1 44 98 69 92 ac cd 03  3e 94 a1 ee 1c 08 04 00  |.D.i....>.......|
+000002f0  80 93 2b a2 28 51 d1 7d  2e 07 e2 07 07 5b 3f 56  |..+.(Q.}.....[?V|
+00000300  1a 17 4a 70 6b 74 ac a2  12 02 f9 3d ec 85 b1 df  |..Jpkt.....=....|
+00000310  5a 17 a2 79 9b bb 40 4a  2f 27 a5 c1 71 7f 70 25  |Z..y..@J/'..q.p%|
+00000320  a1 72 c5 20 86 3a a2 1e  0c 53 a0 2e 76 7f 5f 5a  |.r. .:...S..v._Z|
+00000330  00 55 6b 9d 0b 5e 3a c7  8e 25 97 fb d5 a4 ea 68  |.Uk..^:..%.....h|
+00000340  79 9c 29 34 e5 6f 44 07  8b a7 7a 9c 31 c5 34 08  |y.)4.oD...z.1.4.|
+00000350  31 8d 5e 9f 0f cb 42 ae  e7 66 59 41 62 37 25 f6  |1.^...B..fYAb7%.|
+00000360  09 42 10 11 9e 19 08 6b  56 43 ae 05 ac 1c a4 24  |.B.....kVC.....$|
+00000370  f5 16 03 03 00 04 0e 00  00 00                    |..........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
 00000030  16 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000040  00 00 00 00 00 6c 72 1c  47 f9 89 fa 2b 0e cf 69  |.....lr.G...+..i|
-00000050  bf 95 e4 ea b8 74 e7 99  d4 c4 53 f5 97 f5 08 f9  |.....t....S.....|
-00000060  ef 03 e7 76 b8 2c 31 f6  9b 2c cd 27 c8 42 6a a8  |...v.,1..,.'.Bj.|
-00000070  c0 e0 b9 5e cd                                    |...^.|
+00000040  00 00 00 00 00 fc 6b 1b  7e 07 14 39 83 00 01 20  |......k.~..9... |
+00000050  ca 14 c9 c8 03 6e cb 3c  05 b8 63 c3 37 a1 63 c9  |.....n.<..c.7.c.|
+00000060  9b a1 94 01 de 61 0c 7f  ae 92 95 4d 31 6b e8 5e  |.....a.....M1k.^|
+00000070  bb 73 3f 3b a5                                    |.s?;.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 89 35 48 2e 99  |..........@.5H..|
-00000010  7c 13 76 5e 7f 07 a6 44  d9 95 1c 9f 25 59 3d f5  ||.v^...D....%Y=.|
-00000020  df d6 5e cb 85 3e 0c f7  48 69 95 77 29 95 88 1c  |..^..>..Hi.w)...|
-00000030  1e 76 8a c3 ea 69 07 75  46 68 09 50 fa 30 0a 57  |.v...i.uFh.P.0.W|
-00000040  84 e3 c7 d9 34 c4 40 32  7b f4 95                 |....4.@2{..|
+00000000  14 03 03 00 01 01 16 03  03 00 40 e4 fe 65 a6 8e  |..........@..e..|
+00000010  05 32 44 9d 56 27 03 e2  da 79 c9 fd 52 76 2e bb  |.2D.V'...y..Rv..|
+00000020  37 9f 40 59 ba de ba 56  82 a1 b4 39 29 b0 29 af  |7.@Y...V...9).).|
+00000030  96 42 9e f8 c4 e7 cf 72  1c 2c c8 c7 cb ba cd 82  |.B.....r.,......|
+00000040  bf 21 17 07 6b 39 2c 0a  17 0b 74                 |.!..k9,...t|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 24 6d d9  23 68 ad 8d 64 2e 3a d5  |.....$m.#h..d.:.|
-00000020  ed eb 4c e9 cb 9d 13 49  4c 44 b9 00 af af 2c e7  |..L....ILD....,.|
-00000030  22 c0 bb 31 4e 15 03 03  00 30 00 00 00 00 00 00  |"..1N....0......|
-00000040  00 00 00 00 00 00 00 00  00 00 c8 60 b8 c1 66 9b  |...........`..f.|
-00000050  52 44 3c 26 7f ff 96 a6  21 c7 eb 33 71 f8 40 23  |RD<&....!..3q.@#|
-00000060  7c 5b ef b2 e1 b4 3f 84  82 48                    ||[....?..H|
+00000010  00 00 00 00 00 e4 be e7  a6 e6 3c 1e ca 47 07 07  |..........<..G..|
+00000020  98 a3 4d 13 6d ac 75 57  45 de 8e fc ca 02 c8 b6  |..M.m.uWE.......|
+00000030  00 fc 7f e0 50 15 03 03  00 30 00 00 00 00 00 00  |....P....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 84 c2 3c b7 11 8c  |............<...|
+00000050  d2 65 43 4d aa 28 0c 7f  5f 73 9c cf 43 fe 72 d1  |.eCM.(.._s..C.r.|
+00000060  87 86 9b c8 1b 04 13 a7  44 5c                    |........D\|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256
index f8f04ac13b..ccfa718fc6 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 8f cc 68 50 60  |....]...Y....hP`|
-00000010  11 c8 c3 ce e7 e9 e1 3c  fb 29 d7 4f df 44 16 65  |.......<.).O.D.e|
-00000020  1d 3b 25 5b 32 59 f1 8e  be d8 49 20 c2 89 a7 d5  |.;%[2Y....I ....|
-00000030  cb 2c a2 05 19 6b 65 64  9b 71 2b d3 d2 19 cb 66  |.,...ked.q+....f|
-00000040  61 c1 6f 19 b4 7a 15 41  76 14 85 fc c0 27 00 00  |a.o..z.Av....'..|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 81 ab 9b 85 bf  |....]...Y.......|
+00000010  f2 7f b2 d1 38 37 f5 dd  42 34 b6 69 e9 25 48 1c  |....87..B4.i.%H.|
+00000020  65 59 3b 6a 04 17 05 49  87 42 87 20 6a da fc 8d  |eY;j...I.B. j...|
+00000030  38 a9 cd 09 65 ac f1 9c  d6 ee ab 74 ad 96 df a0  |8...e......t....|
+00000040  87 98 23 29 79 78 0b c3  8f af ea 3c c0 27 00 00  |..#)yx.....<.'..|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -61,42 +63,42 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 88 db 33  |............ ..3|
-000002d0  96 fb ae 63 de f8 2b 4b  94 fa da c2 8e 75 fa 63  |...c..+K.....u.c|
-000002e0  0a 54 2b 68 01 76 2a 76  4f e7 91 e9 2a 08 04 00  |.T+h.v*vO...*...|
-000002f0  80 d9 47 dd dd b9 94 b8  1c 1b dc 1f 79 bd f1 26  |..G.........y..&|
-00000300  66 19 52 0b 0a 2e ea 0d  69 bf 93 a0 29 0f 6a 30  |f.R.....i...).j0|
-00000310  2c 1b 44 25 13 e3 b7 03  db b3 fc 37 9c 3f bb e7  |,.D%.......7.?..|
-00000320  c7 4d 65 8f af bb 39 fa  6e 77 09 bb 08 09 7e d1  |.Me...9.nw....~.|
-00000330  0f ad 57 78 a6 cb a8 3f  2e 70 fc 38 75 2f a0 23  |..Wx...?.p.8u/.#|
-00000340  0b 0c 6c 28 0a 71 51 dc  10 8f 85 fd 97 0f c4 84  |..l(.qQ.........|
-00000350  80 cf 70 0a a9 56 9a af  2f ab 12 c7 8b d1 82 1c  |..p..V../.......|
-00000360  f0 6c 08 00 73 18 dd 6e  5a 66 ed a5 f7 7a 3d 73  |.l..s..nZf...z=s|
-00000370  88 16 03 03 00 04 0e 00  00 00                    |..........|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 88 0b 7c  |............ ..||
+000002d0  04 c5 e3 0b 1c aa 4b 4c  0a 3a 5c 67 a5 ac 01 be  |......KL.:\g....|
+000002e0  32 77 9e 69 dc ae 64 0e  c7 4c 34 7d 74 08 04 00  |2w.i..d..L4}t...|
+000002f0  80 b7 0e 09 2f 58 46 d2  7e 19 ca d3 34 31 ac 86  |..../XF.~...41..|
+00000300  94 b3 18 56 e0 b0 75 88  ed d2 5c d2 d6 80 18 30  |...V..u...\....0|
+00000310  28 75 16 eb fb ee b6 ce  13 ed f2 75 7c b5 0d a8  |(u.........u|...|
+00000320  04 33 95 aa 2b c0 21 db  8a a8 cc 9b fe eb 55 32  |.3..+.!.......U2|
+00000330  04 22 e6 02 83 ca b1 c0  1d 14 7f 8c 44 de ce c7  |."..........D...|
+00000340  6a 60 73 1f 96 c3 62 7d  9d 36 cc f9 c1 a8 12 cb  |j`s...b}.6......|
+00000350  ea 93 36 db 8c 15 29 a1  03 3a 4f 82 13 52 f8 de  |..6...)..:O..R..|
+00000360  6f 80 b6 9d ad e8 ea 04  03 0d a5 63 74 e9 bf 2f  |o..........ct../|
+00000370  5f 16 03 03 00 04 0e 00  00 00                    |_.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
 00000030  16 03 03 00 50 00 00 00  00 00 00 00 00 00 00 00  |....P...........|
-00000040  00 00 00 00 00 93 01 19  de 19 e6 58 a9 b2 bb e6  |...........X....|
-00000050  83 08 03 78 72 d8 25 fc  31 70 55 fa cd ec e4 0a  |...xr.%.1pU.....|
-00000060  a2 7b 00 5c fe 7f 08 26  a5 ca 9f d6 28 95 69 f5  |.{.\...&....(.i.|
-00000070  b9 17 23 34 83 fe 36 24  60 17 4c 90 18 30 f9 44  |..#4..6$`.L..0.D|
-00000080  af 74 ea 65 4b                                    |.t.eK|
+00000040  00 00 00 00 00 f3 03 08  16 9c 4f c9 0e 8c 2a 74  |..........O...*t|
+00000050  4f d4 8a 84 50 fa 16 da  5e 76 d5 80 26 40 6a 55  |O...P...^v..&@jU|
+00000060  75 16 4c 28 58 09 c9 88  fd af 93 f2 94 46 3d 1b  |u.L(X........F=.|
+00000070  6c 04 af af b4 c1 14 c7  76 5e 10 64 4e 61 19 a9  |l.......v^.dNa..|
+00000080  c8 94 aa 7b fc                                    |...{.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 50 b6 cf 83 c7 0d  |..........P.....|
-00000010  dc 8f 9a 96 0d 0b 4f 58  ed c9 46 fa 95 0b f1 ab  |......OX..F.....|
-00000020  9a 50 2a cc af 26 73 03  0b 93 e7 4e 96 a0 e2 44  |.P*..&s....N...D|
-00000030  01 99 9e 06 a3 81 3f 0b  e4 7c 03 53 e4 65 36 69  |......?..|.S.e6i|
-00000040  65 96 79 a2 4e 79 e8 fc  b1 6a 50 3e dd 22 1f e3  |e.y.Ny...jP>."..|
-00000050  fe e3 77 9f 8c 05 f8 cc  08 4b 6b                 |..w......Kk|
+00000000  14 03 03 00 01 01 16 03  03 00 50 9f 93 29 9e ce  |..........P..)..|
+00000010  ec cb 1f 2e 0a 4b a9 cf  2a 18 2c 6a 4e b6 4f e5  |.....K..*.,jN.O.|
+00000020  e1 15 c5 fc 8b 07 31 c1  88 ea 34 dd 14 c8 e0 e3  |......1...4.....|
+00000030  da 9e cf 42 5e 6b d9 3f  a7 00 e7 37 b0 2f cb fb  |...B^k.?...7./..|
+00000040  bb 80 4b c8 e0 00 47 af  04 26 7d e4 c0 71 0a c9  |..K...G..&}..q..|
+00000050  73 d4 35 99 e9 d8 06 c3  6f 09 69                 |s.5.....o.i|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000010  00 00 00 00 00 f8 39 8e  57 60 18 1c ef 19 c8 da  |......9.W`......|
-00000020  f4 3b dc 42 85 44 e3 59  28 ea 29 11 60 ba 2b 2b  |.;.B.D.Y(.).`.++|
-00000030  dc 6a 5d 3a ed ce f2 10  34 17 6e 10 67 00 f0 43  |.j]:....4.n.g..C|
-00000040  3e 0f e1 a1 c8 15 03 03  00 40 00 00 00 00 00 00  |>........@......|
-00000050  00 00 00 00 00 00 00 00  00 00 13 0d fa 71 e4 df  |.............q..|
-00000060  76 f3 c9 01 d5 60 b4 34  d4 6f 68 f5 cd af d6 0b  |v....`.4.oh.....|
-00000070  e6 af ab ec 64 75 38 d6  17 d4 27 81 96 e5 71 74  |....du8...'...qt|
-00000080  d5 cd 39 30 35 4a ef 92  56 6e                    |..905J..Vn|
+00000010  00 00 00 00 00 65 8e 6b  75 f5 ea 6f 63 c0 12 d8  |.....e.ku..oc...|
+00000020  c5 42 81 1a ef 04 64 0b  38 99 35 9b 4e 84 9c 40  |.B....d.8.5.N..@|
+00000030  bc d6 f9 6f 52 16 4b c3  cb 26 42 30 af a1 d0 f9  |...oR.K..&B0....|
+00000040  07 56 27 c2 12 15 03 03  00 40 00 00 00 00 00 00  |.V'......@......|
+00000050  00 00 00 00 00 00 00 00  00 00 b1 d0 14 32 93 af  |.............2..|
+00000060  02 66 bd 5d 39 26 20 3f  c5 f1 24 54 52 a6 38 18  |.f.]9& ?..$TR.8.|
+00000070  91 6e b8 07 d9 37 58 6d  cc a9 b0 86 11 c6 b1 10  |.n...7Xm........|
+00000080  06 0c dc a5 5b ad c7 a6  fe b1                    |....[.....|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-CHACHA20-POLY1305 b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-CHACHA20-POLY1305
index 2ea5debf2d..c1670a6726 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-CHACHA20-POLY1305
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-CHACHA20-POLY1305
@@ -1,24 +1,26 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 d4 01 00 00  d0 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 f2 01 00 00  ee 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 00 08 cc a8  |................|
-00000050  13 03 13 01 13 02 01 00  00 7f 00 0b 00 02 01 00  |................|
+00000050  13 03 13 01 13 02 01 00  00 9d 00 0b 00 02 01 00  |................|
 00000060  ff 01 00 01 00 00 17 00  00 00 12 00 00 00 05 00  |................|
 00000070  05 01 00 00 00 00 00 0a  00 0a 00 08 00 1d 00 17  |................|
 00000080  00 18 00 19 00 0d 00 1a  00 18 08 04 04 03 08 07  |................|
 00000090  08 05 08 06 04 01 05 01  06 01 05 03 06 03 02 01  |................|
-000000a0  02 03 00 2b 00 09 08 03  04 03 03 03 02 03 01 00  |...+............|
-000000b0  33 00 26 00 24 00 1d 00  20 2f e5 7d a3 47 cd 62  |3.&.$... /.}.G.b|
-000000c0  43 15 28 da ac 5f bb 29  07 30 ff f6 84 af c4 cf  |C.(.._.).0......|
-000000d0  c2 ed 90 99 5f 58 cb 3b  74                       |...._X.;t|
+000000a0  02 03 00 32 00 1a 00 18  08 04 04 03 08 07 08 05  |...2............|
+000000b0  08 06 04 01 05 01 06 01  05 03 06 03 02 01 02 03  |................|
+000000c0  00 2b 00 09 08 03 04 03  03 03 02 03 01 00 33 00  |.+............3.|
+000000d0  26 00 24 00 1d 00 20 2f  e5 7d a3 47 cd 62 43 15  |&.$... /.}.G.bC.|
+000000e0  28 da ac 5f bb 29 07 30  ff f6 84 af c4 cf c2 ed  |(.._.).0........|
+000000f0  90 99 5f 58 cb 3b 74                              |.._X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 01 ce 8f f1 84  |....]...Y.......|
-00000010  65 dc 47 4e 43 f2 cd 85  6c 98 40 a7 5c 7f ed 53  |e.GNC...l.@.\..S|
-00000020  78 63 03 dd 50 3e a4 27  20 21 bf 20 d9 93 9d f6  |xc..P>.' !. ....|
-00000030  1f e8 0e 72 fc 64 e0 dd  8e ef b3 ea ff 5b ad 60  |...r.d.......[.`|
-00000040  a5 f0 68 ff 7e 35 46 a4  28 71 31 fd cc a8 00 00  |..h.~5F.(q1.....|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 34 c1 8b 5f 3a  |....]...Y..4.._:|
+00000010  34 19 b4 a5 7a b6 d4 d8  83 54 60 22 6c 56 52 d0  |4...z....T`"lVR.|
+00000020  c6 ae 08 d2 17 49 97 ec  fe f2 8a 20 d5 fc 67 75  |.....I..... ..gu|
+00000030  b1 26 04 0e ce 3a 0e c3  4a e3 9a 20 0b 36 12 43  |.&...:..J.. .6.C|
+00000040  13 0e db 9e 50 ca d6 54  89 01 33 56 cc a8 00 00  |....P..T..3V....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -58,31 +60,31 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 ea 03 c7  |............ ...|
-000002d0  b0 eb 76 ba 86 25 18 e5  0d b3 70 2a 41 72 4d 88  |..v..%....p*ArM.|
-000002e0  55 6d 91 2b 65 fe e0 64  12 69 42 eb 27 08 04 00  |Um.+e..d.iB.'...|
-000002f0  80 0f 00 0a b0 35 db 39  fa ba a1 27 44 e0 9b d4  |.....5.9...'D...|
-00000300  b8 aa b3 4f 93 46 ed 09  f8 3e 1b c8 47 6e 52 8a  |...O.F...>..GnR.|
-00000310  8f fd b1 67 f6 05 87 68  de 7b 25 1b 40 df 1e f2  |...g...h.{%.@...|
-00000320  04 2b 4f 39 3d 6f a8 f7  25 37 26 34 87 84 06 c4  |.+O9=o..%7&4....|
-00000330  0e 31 bc 46 8a d2 99 14  6d 5d 14 32 a2 32 fc 10  |.1.F....m].2.2..|
-00000340  5e fb d9 f8 06 d4 05 17  5d 59 f4 38 c5 13 1c 91  |^.......]Y.8....|
-00000350  5a 5f cb dd 3e 27 78 10  2c 0c 9b 7f 1a ec 4c da  |Z_..>'x.,.....L.|
-00000360  fb d7 52 eb 76 83 75 87  d2 a3 7f e9 25 a5 8a 22  |..R.v.u.....%.."|
-00000370  dd 16 03 03 00 04 0e 00  00 00                    |..........|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 63 b1 95  |............ c..|
+000002d0  d7 d2 63 99 59 8e 56 00  0a 08 29 c9 a5 30 bd 1b  |..c.Y.V...)..0..|
+000002e0  f1 e4 ad 7d 99 c0 ea 9d  44 1c c6 22 56 08 04 00  |...}....D.."V...|
+000002f0  80 d8 02 bd 3f 32 2e 05  8b 2f 2b 98 ef fe 6b 96  |....?2.../+...k.|
+00000300  80 ab d3 e1 d0 56 45 f6  66 2a 44 52 f3 47 85 f6  |.....VE.f*DR.G..|
+00000310  3a 0a 08 11 31 be 39 68  e8 8a cd ac 83 c2 32 10  |:...1.9h......2.|
+00000320  d5 9a d6 d4 9c 93 3a 49  1e d2 43 d6 f3 b8 96 6a  |......:I..C....j|
+00000330  0b 50 53 58 77 2f 7a d5  a3 d8 f7 33 6a 29 16 05  |.PSXw/z....3j)..|
+00000340  4a 71 d3 23 dc f1 91 ec  4d be 10 53 f5 57 0d 01  |Jq.#....M..S.W..|
+00000350  36 ea 6f b7 42 68 76 6c  15 57 24 bb 92 c6 48 91  |6.o.Bhvl.W$...H.|
+00000360  b2 02 83 75 9a 52 63 2d  3c 6a b5 91 8a cf ad 52  |...u.Rc-<j.....R|
+00000370  a2 16 03 03 00 04 0e 00  00 00                    |..........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 28 48 18  85 9d 35 c7 5a 46 2c a7  |.... (H...5.ZF,.|
-00000040  5b 8b c0 71 73 66 d0 a7  53 a0 e3 ed c8 57 f3 70  |[..qsf..S....W.p|
-00000050  9a 01 58 61 84                                    |..Xa.|
+00000030  16 03 03 00 20 ab c0 00  15 90 de 61 3e 0b 60 16  |.... ......a>.`.|
+00000040  88 fe 6e a8 31 b8 cf bf  18 f5 21 c0 51 4f 96 fe  |..n.1.....!.QO..|
+00000050  47 eb c3 75 9b                                    |G..u.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 b9 72 f6 07 40  |.......... .r..@|
-00000010  0b 2f 67 8a 97 fa 17 24  81 e5 6f 5b 09 90 72 8d  |./g....$..o[..r.|
-00000020  48 59 14 00 34 e8 3c 82  b8 2f 87                 |HY..4.<../.|
+00000000  14 03 03 00 01 01 16 03  03 00 20 38 2e e1 49 d7  |.......... 8..I.|
+00000010  20 aa 42 6c 73 05 b7 37  e3 0c 14 b0 fb bd 0f 04  | .Bls..7........|
+00000020  79 a8 6c 01 63 4a 92 c8  13 a0 d9                 |y.l.cJ.....|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 f6 cf b1  93 64 54 56 f3 35 3d 8f  |.........dTV.5=.|
-00000010  31 5e 66 62 56 aa e9 81  47 4c 8b 15 03 03 00 12  |1^fbV...GL......|
-00000020  de 0b 32 2b 58 2c b5 4e  80 2a 66 e7 a0 a9 28 d9  |..2+X,.N.*f...(.|
-00000030  db 11                                             |..|
+00000000  17 03 03 00 16 d4 37 f1  77 d5 49 df 50 58 c9 41  |......7.w.I.PX.A|
+00000010  ad 99 2b bc 85 a7 33 d4  ff 96 c0 15 03 03 00 12  |..+...3.........|
+00000020  a9 7f 06 84 dd 17 63 18  26 14 5e 3e 04 87 af 37  |......c.&.^>...7|
+00000030  7f 0c                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-Ed25519 b/src/crypto/tls/testdata/Client-TLSv12-Ed25519
index d43ee07eea..a3d23b6208 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-Ed25519
+++ b/src/crypto/tls/testdata/Client-TLSv12-Ed25519
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 93 8a a3 77 84  |....]...Y.....w.|
-00000010  fd 41 3d a5 ad b5 eb 91  63 a6 b5 3a 5f 21 08 df  |.A=.....c..:_!..|
-00000020  72 07 be 1f df d7 4e 6f  f3 f8 cb 20 ae d3 e5 fe  |r.....No... ....|
-00000030  53 a3 c7 84 6c 3e c6 1d  d5 65 5d a6 a5 7d f7 5c  |S...l>...e]..}.\|
-00000040  34 65 a7 df 1e 28 3f 7d  20 08 81 2c cc a9 00 00  |4e...(?} ..,....|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 19 33 a6 0c 80  |....]...Y...3...|
+00000010  5d 56 d6 7b 85 ae 50 82  3a 61 7b b0 dd 01 f8 98  |]V.{..P.:a{.....|
+00000020  b9 51 22 e7 12 4c 98 f2  4c 50 49 20 37 6f ad 03  |.Q"..L..LPI 7o..|
+00000030  52 51 44 3e 26 19 df e3  59 cd 6a 41 37 3c 46 95  |RQD>&...Y.jA7<F.|
+00000040  1f e1 07 20 f2 6b b4 15  a2 41 0e b2 cc a9 00 00  |... .k...A......|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 01 3c 0b  00 01 38 00 01 35 00 01  |......<...8..5..|
 00000070  32 30 82 01 2e 30 81 e1  a0 03 02 01 02 02 10 0f  |20...0..........|
@@ -44,26 +46,26 @@
 00000180  fc ab 7d 4d d4 e0 93 13  d0 a9 42 e0 b6 6b fe 5d  |..}M......B..k.]|
 00000190  67 48 d7 9f 50 bc 6c cd  4b 03 83 7c f2 08 58 cd  |gH..P.l.K..|..X.|
 000001a0  ac cf 0c 16 03 03 00 6c  0c 00 00 68 03 00 1d 20  |.......l...h... |
-000001b0  e9 e7 75 b4 4c 42 14 7a  e0 50 0a 95 f1 d7 35 aa  |..u.LB.z.P....5.|
-000001c0  39 05 9e 59 73 5e cd d2  ec 56 18 f0 ee 1f 81 3c  |9..Ys^...V.....<|
-000001d0  08 07 00 40 44 e9 19 b6  00 49 f7 c8 06 62 cb c1  |...@D....I...b..|
-000001e0  b5 7c b6 cd 32 47 c9 05  82 3b f0 af d1 cd 75 8b  |.|..2G...;....u.|
-000001f0  82 8b 47 dd 85 13 78 69  5d 40 7e 9b 91 24 2e ce  |..G...xi]@~..$..|
-00000200  3e be e0 12 1e ec 56 0b  ff 25 21 92 6f 24 12 10  |>.....V..%!.o$..|
-00000210  30 33 cf 04 16 03 03 00  04 0e 00 00 00           |03...........|
+000001b0  54 12 8c 8b b0 53 e4 e0  43 90 3d 15 fb 26 ee a9  |T....S..C.=..&..|
+000001c0  12 24 60 7f d5 57 e5 1c  bc ca 4f 31 dd a2 a8 3e  |.$`..W....O1...>|
+000001d0  08 07 00 40 ad 8c 20 13  7d f5 5e 5e b2 41 9f 60  |...@.. .}.^^.A.`|
+000001e0  f7 d2 cc 2f fe 47 6d 8c  24 ca 0d 72 63 eb 0d f8  |.../.Gm.$..rc...|
+000001f0  93 0b 13 de 8f bc 92 0e  f8 77 8a de 2f 9c 32 30  |.........w../.20|
+00000200  96 cb 5b bc b8 94 68 fb  06 62 ce 01 ed b8 f8 f2  |..[...h..b......|
+00000210  c1 c4 16 01 16 03 03 00  04 0e 00 00 00           |.............|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 69 ac be  cf f1 3d 8a 4e f3 3a 54  |.... i....=.N.:T|
-00000040  05 d8 20 3a f0 67 40 3f  5b 94 cf a4 3e ec 8e 4e  |.. :.g@?[...>..N|
-00000050  75 c9 92 2c af                                    |u..,.|
+00000030  16 03 03 00 20 25 48 e8  48 d4 0e e2 2e 91 65 98  |.... %H.H.....e.|
+00000040  60 1e ae 8f e6 7e 5b 0a  bb 7b 90 8a 2b a7 b2 81  |`....~[..{..+...|
+00000050  f6 4b 17 c5 cc                                    |.K...|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 70 c5 f8 c7 7c  |.......... p...||
-00000010  4a 34 6f b0 eb 1b 13 c7  e0 21 32 cf ce 89 aa 53  |J4o......!2....S|
-00000020  5f 67 b8 a7 3e 10 bb a3  5f fa 2f                 |_g..>..._./|
+00000000  14 03 03 00 01 01 16 03  03 00 20 f5 ed d5 32 97  |.......... ...2.|
+00000010  a7 91 bc 42 03 3b f1 76  21 68 19 41 8f 70 a1 74  |...B.;.v!h.A.p.t|
+00000020  28 fb f4 7a 61 1e cf 79  b6 f7 a8                 |(..za..y...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 54 ae 8d  1c 04 40 47 8a 7e ac c3  |.....T....@G.~..|
-00000010  21 a2 8a f0 5d 3d 12 9d  b0 b5 8d 15 03 03 00 12  |!...]=..........|
-00000020  71 3b 30 89 d4 c3 ef 34  66 92 29 1b e1 af d4 d2  |q;0....4f.).....|
-00000030  7e cd                                             |~.|
+00000000  17 03 03 00 16 9b bf f5  4d cb b0 e2 bb 5c df e4  |........M....\..|
+00000010  c8 85 31 11 d1 59 9d 72  03 2a 74 15 03 03 00 12  |..1..Y.r.*t.....|
+00000020  13 fd 92 1a 96 bf 23 2e  06 8b e4 42 f6 05 7d 7e  |......#....B..}~|
+00000030  6c cd                                             |l.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ExportKeyingMaterial b/src/crypto/tls/testdata/Client-TLSv12-ExportKeyingMaterial
index 3d06b4c0ac..55644403d3 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ExportKeyingMaterial
+++ b/src/crypto/tls/testdata/Client-TLSv12-ExportKeyingMaterial
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 18 47 80 ab 8d  |....]...Y...G...|
-00000010  42 c7 73 06 75 ef 28 ff  87 46 49 af 3a 3b cb bb  |B.s.u.(..FI.:;..|
-00000020  ff 6e e3 60 11 40 2c b8  40 87 5c 20 86 3d de c2  |.n.`.@,.@.\ .=..|
-00000030  18 41 ff 1a dc 00 77 4e  17 0b 36 f3 69 92 d7 04  |.A....wN..6.i...|
-00000040  c4 c6 39 ad ed f7 06 23  8c 52 50 da cc a8 00 00  |..9....#.RP.....|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 37 1f dc 30 b6  |....]...Y..7..0.|
+00000010  6b 54 22 cd 46 38 00 7b  c2 d4 97 80 f5 b6 cb fc  |kT".F8.{........|
+00000020  01 b7 91 6a ce 1d 20 9f  fb 4a b3 20 d2 72 bb 97  |...j.. ..J. .r..|
+00000030  2a 46 3c da d1 8a 8e 1b  cd ed e7 5a 5a c7 0c ca  |*F<........ZZ...|
+00000040  1f 6e 40 b3 6a d6 7a ae  55 bd 82 42 cc a8 00 00  |.n@.j.z.U..B....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -61,31 +63,31 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 c5 28 44  |............ .(D|
-000002d0  4a 31 d9 b6 53 90 8e 41  3c 67 2c 6f 9d b0 a6 d3  |J1..S..A<g,o....|
-000002e0  ed 70 64 94 ba 80 56 ca  f8 d7 10 28 49 08 04 00  |.pd...V....(I...|
-000002f0  80 81 28 f4 bc 99 0f 3f  c4 f6 4b 1a 08 c8 ed 3b  |..(....?..K....;|
-00000300  d1 b9 03 69 8d d4 b3 50  b0 de 88 8d 94 60 16 b8  |...i...P.....`..|
-00000310  48 0d af b5 56 98 44 ad  04 6c 8b 42 ce 35 a1 28  |H...V.D..l.B.5.(|
-00000320  67 ff 5c 07 ae 49 f5 f6  00 46 6a 5b e9 54 10 15  |g.\..I...Fj[.T..|
-00000330  e5 82 0a 7c 4b d9 bb e3  e2 43 ba 41 38 7e 9d 4d  |...|K....C.A8~.M|
-00000340  68 9c 2f d8 38 c8 01 61  59 54 cb 10 48 d3 82 88  |h./.8..aYT..H...|
-00000350  22 4f 85 fc 50 59 31 61  e6 25 d7 9a b5 f0 4e e4  |"O..PY1a.%....N.|
-00000360  c1 06 c5 3a 02 dc 07 c1  cf 50 91 2b 12 17 02 25  |...:.....P.+...%|
-00000370  d1 16 03 03 00 04 0e 00  00 00                    |..........|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 da a1 33  |............ ..3|
+000002d0  ec 12 5f c7 25 b5 de 66  38 64 74 a9 e2 69 09 e3  |.._.%..f8dt..i..|
+000002e0  12 49 fe 0a 0a 74 c5 c8  04 b0 4c 01 6d 08 04 00  |.I...t....L.m...|
+000002f0  80 5d c4 70 28 74 65 b3  74 bb 2d 71 87 84 48 25  |.].p(te.t.-q..H%|
+00000300  41 14 38 17 cd e3 8c a8  24 a5 6b bd 81 62 ef bc  |A.8.....$.k..b..|
+00000310  9d 15 31 a7 6f a7 55 90  c8 fb 71 8a 45 a6 4a fb  |..1.o.U...q.E.J.|
+00000320  14 5d 92 5b fc 41 79 ca  d4 ac 5b 43 ea 18 f2 e4  |.].[.Ay...[C....|
+00000330  69 91 45 27 8e 32 ef ae  59 70 3e 43 b0 43 3f f0  |i.E'.2..Yp>C.C?.|
+00000340  1b e6 e4 aa 8f 0f 4d 7f  b7 d8 bf fb 40 59 92 2e  |......M.....@Y..|
+00000350  08 51 2a a4 ce c8 da f9  ec b3 d6 f6 63 32 e9 ef  |.Q*.........c2..|
+00000360  b8 42 25 2a 5e ec 4b 39  e5 52 d1 e7 f1 5d 18 9f  |.B%*^.K9.R...]..|
+00000370  97 16 03 03 00 04 0e 00  00 00                    |..........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 9f 16 49  2a d8 cc 0a 45 92 8d c2  |.... ..I*...E...|
-00000040  25 3c b1 5c a8 f2 c4 9b  c4 2a 66 fe 7f 87 df 35  |%<.\.....*f....5|
-00000050  77 a4 b0 05 f5                                    |w....|
+00000030  16 03 03 00 20 a6 dc 32  3e 35 76 e8 25 41 ad f7  |.... ..2>5v.%A..|
+00000040  64 02 b0 a3 19 0b ea 1c  7f d7 47 4c 73 2d 7e 6f  |d.........GLs-~o|
+00000050  7a 0c 09 41 1f                                    |z..A.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 37 55 d5 05 71  |.......... 7U..q|
-00000010  a0 00 44 56 32 c3 c8 e6  68 5e de d4 e7 65 56 d3  |..DV2...h^...eV.|
-00000020  2d 93 07 e6 72 17 e9 49  74 4d c0                 |-...r..ItM.|
+00000000  14 03 03 00 01 01 16 03  03 00 20 77 e0 48 07 28  |.......... w.H.(|
+00000010  72 79 07 2e 8a b8 1c a0  70 78 f1 a8 e9 24 6d 46  |ry......px...$mF|
+00000020  78 27 71 a0 a4 7b da 5b  77 3d 78                 |x'q..{.[w=x|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 27 a6 31  16 5c 7e bd 05 0a 2c 05  |.....'.1.\~...,.|
-00000010  ba 37 06 00 d7 8d 66 a7  8e 16 7b 15 03 03 00 12  |.7....f...{.....|
-00000020  70 38 bc 7e 6b 83 83 e1  61 3b bb a5 d9 dc f7 e7  |p8.~k...a;......|
-00000030  5e 12                                             |^.|
+00000000  17 03 03 00 16 d9 2e 8d  11 ee 6a df 43 dc 3b f4  |..........j.C.;.|
+00000010  dd 9e c3 be 2e 78 8a 39  3b 7a a1 15 03 03 00 12  |.....x.9;z......|
+00000020  d5 ef f8 2e 49 c9 f8 27  3e 29 e5 39 fc 25 3d b2  |....I..'>).9.%=.|
+00000030  ff a8                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-P256-ECDHE b/src/crypto/tls/testdata/Client-TLSv12-P256-ECDHE
index 7a0a53c03a..d991b001d5 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-P256-ECDHE
+++ b/src/crypto/tls/testdata/Client-TLSv12-P256-ECDHE
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 19 01 00 01  15 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 37 01 00 01  33 03 03 00 00 00 00 00  |....7...3.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,22 +7,24 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9a 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 b8 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 04 00 02 00 17  00 0d 00 1a 00 18 08 04  |................|
 000000b0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
-000000c0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
-000000d0  02 03 01 00 33 00 47 00  45 00 17 00 41 04 1e 18  |....3.G.E...A...|
-000000e0  37 ef 0d 19 51 88 35 75  71 b5 e5 54 5b 12 2e 8f  |7...Q.5uq..T[...|
-000000f0  09 67 fd a7 24 20 3e b2  56 1c ce 97 28 5e f8 2b  |.g..$ >.V...(^.+|
-00000100  2d 4f 9e f1 07 9f 6c 4b  5b 83 56 e2 32 42 e9 58  |-O....lK[.V.2B.X|
-00000110  b6 d7 49 a6 b5 68 1a 41  03 56 6b dc 5a 89        |..I..h.A.Vk.Z.|
+000000c0  06 03 02 01 02 03 00 32  00 1a 00 18 08 04 04 03  |.......2........|
+000000d0  08 07 08 05 08 06 04 01  05 01 06 01 05 03 06 03  |................|
+000000e0  02 01 02 03 00 2b 00 09  08 03 04 03 03 03 02 03  |.....+..........|
+000000f0  01 00 33 00 47 00 45 00  17 00 41 04 1e 18 37 ef  |..3.G.E...A...7.|
+00000100  0d 19 51 88 35 75 71 b5  e5 54 5b 12 2e 8f 09 67  |..Q.5uq..T[....g|
+00000110  fd a7 24 20 3e b2 56 1c  ce 97 28 5e f8 2b 2d 4f  |..$ >.V...(^.+-O|
+00000120  9e f1 07 9f 6c 4b 5b 83  56 e2 32 42 e9 58 b6 d7  |....lK[.V.2B.X..|
+00000130  49 a6 b5 68 1a 41 03 56  6b dc 5a 89              |I..h.A.Vk.Z.|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 1c ad ae e9 64  |....]...Y......d|
-00000010  35 80 c6 04 f5 69 05 bb  5c 38 78 d3 99 2f ad e6  |5....i..\8x../..|
-00000020  56 20 d4 79 89 1a 51 54  14 ac 6d 20 06 6d 1a bd  |V .y..QT..m .m..|
-00000030  04 cf 4f 42 3d aa 31 3b  fb dc c1 85 42 c3 6d 12  |..OB=.1;....B.m.|
-00000040  27 98 be 4b 88 93 45 0e  78 ba d8 13 c0 2f 00 00  |'..K..E.x..../..|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 f2 96 d3 16 ce  |....]...Y.......|
+00000010  7c b8 43 6a 66 b2 9f 58  d2 66 74 f6 92 61 3a 48  ||.Cjf..X.ft..a:H|
+00000020  b1 84 87 be bf 7e 5a 9c  75 e3 e1 20 a6 b6 cc cf  |.....~Z.u.. ....|
+00000030  3a 1e b5 62 01 bd ee 58  eb ea 84 58 08 dc e6 d2  |:..b...X...X....|
+00000040  86 a0 5e f2 63 f2 1f 81  29 0d f7 5c c0 2f 00 00  |..^.c...)..\./..|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -62,37 +64,37 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 cd 0c 00 00  c9 03 00 17 41 04 3a 1c  |............A.:.|
-000002d0  84 6b e6 cb 7d 3f bd ea  d7 7a c3 63 43 77 f7 14  |.k..}?...z.cCw..|
-000002e0  a7 98 52 86 49 4d 05 b2  70 e2 d3 44 c9 05 eb 83  |..R.IM..p..D....|
-000002f0  b4 11 c5 3e 9d 3b 3b cd  de d0 df 78 83 0f 0c d8  |...>.;;....x....|
-00000300  76 e7 19 9d 1f 5a 3d 2a  54 19 16 a0 c2 55 08 04  |v....Z=*T....U..|
-00000310  00 80 09 ee 97 8a d1 82  fc 4a fc f2 89 d2 a3 c7  |.........J......|
-00000320  8c 25 74 98 cf b5 67 c6  fd f6 0d 3b 62 ba 31 ca  |.%t...g....;b.1.|
-00000330  d1 67 aa c3 32 89 ee 83  22 d2 b7 3c f8 98 af 16  |.g..2..."..<....|
-00000340  dd 05 06 2c c4 57 dd fc  22 3a 2e 80 f9 84 6a ee  |...,.W..":....j.|
-00000350  f2 a1 21 d1 0f db 17 50  a1 35 94 b3 0a b7 62 ca  |..!....P.5....b.|
-00000360  2c b3 0b 68 0c 58 d7 24  83 82 d8 34 64 3f a4 61  |,..h.X.$...4d?.a|
-00000370  0e b1 ca 93 67 b3 51 11  dc 49 f2 df 26 89 8b ea  |....g.Q..I..&...|
-00000380  22 09 1a be 62 27 61 c8  93 4b dd 95 31 6a ba e2  |"...b'a..K..1j..|
-00000390  c3 2b 16 03 03 00 04 0e  00 00 00                 |.+.........|
+000002c0  16 03 03 00 cd 0c 00 00  c9 03 00 17 41 04 9f ab  |............A...|
+000002d0  e5 e2 8c b7 47 ce a4 e6  c8 ca 51 d7 28 b3 8b be  |....G.....Q.(...|
+000002e0  83 f4 d5 34 27 f5 89 2b  d0 bb 7e 2f 87 8c 64 3d  |...4'..+..~/..d=|
+000002f0  fc ee 5e c1 35 f6 ff be  49 75 58 65 22 92 5b 6f  |..^.5...IuXe".[o|
+00000300  07 08 61 d0 16 9c 6b 2f  b0 47 a0 ed 45 d8 08 04  |..a...k/.G..E...|
+00000310  00 80 58 85 e9 5f 3b b6  03 25 a8 49 da 56 87 2e  |..X.._;..%.I.V..|
+00000320  d5 89 ce 53 de f2 8e b7  4b 7a 24 be 0b c1 86 4b  |...S....Kz$....K|
+00000330  3a a3 58 ea e2 68 bd 33  91 93 8b f5 cc 6e ea 7d  |:.X..h.3.....n.}|
+00000340  e4 14 fc 6c d2 d3 25 97  73 bf 0d d4 26 65 71 c0  |...l..%.s...&eq.|
+00000350  6f 85 52 e6 e5 34 e7 05  7b 8b d0 96 db f4 cc 49  |o.R..4..{......I|
+00000360  f7 7f da c6 56 54 b0 e0  5e 60 b1 ea 8a 9b 45 06  |....VT..^`....E.|
+00000370  54 ed b4 34 ab a0 0b 72  4f 0e 0a 9c 57 f8 c2 1c  |T..4...rO...W...|
+00000380  87 8b 9c 48 97 ae 08 2b  51 07 cd 5d 5c 0a 1e 47  |...H...+Q..]\..G|
+00000390  b7 bd 16 03 03 00 04 0e  00 00 00                 |...........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
 00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
 00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 fa c4  |.....(..........|
-00000060  4e 47 d1 de 6d 60 fc af  59 43 7f 2f 4c b3 6e aa  |NG..m`..YC./L.n.|
-00000070  6f c3 bc 8a 40 5e e9 9c  d9 b0 87 c5 92 41        |o...@^.......A|
+00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 c5 59  |.....(.........Y|
+00000060  bb bb c9 dc 4d 95 d9 70  d0 bc 76 ca e7 0f 50 f8  |....M..p..v...P.|
+00000070  d5 55 e0 3c fb 12 63 ff  8d b4 a9 85 96 0e        |.U.<..c.......|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 eb 92 83 02 be  |..........(.....|
-00000010  89 55 4e 77 b2 45 1d 15  fd e0 6a 36 ab 0c 7b 4a  |.UNw.E....j6..{J|
-00000020  5d 50 e2 5a f3 c6 10 e2  ac ac a4 d3 4c 2e d8 31  |]P.Z........L..1|
-00000030  84 31 17                                          |.1.|
+00000000  14 03 03 00 01 01 16 03  03 00 28 98 cb 91 21 85  |..........(...!.|
+00000010  4a fd 3f e5 f7 31 8d 35  c9 11 31 fc 1f 0e e3 0d  |J.?..1.5..1.....|
+00000020  86 c7 93 10 1d 52 21 2c  6f 7a c7 0e 6a d8 67 9c  |.....R!,oz..j.g.|
+00000030  c8 e7 cd                                          |...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 90 44 33  |..............D3|
-00000010  cf be 4e 29 fc 6f 2f 30  c1 ef aa 8e cb 10 0e f9  |..N).o/0........|
-00000020  8f 60 fc 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.`..............|
-00000030  80 cb 52 6b e7 c9 45 af  69 6b e8 ee 88 23 61 20  |..Rk..E.ik...#a |
-00000040  74 33                                             |t3|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 b7 f9 69  |...............i|
+00000010  f9 81 f1 da b7 b7 4b fe  3a a4 d7 d2 af b5 2a e9  |......K.:.....*.|
+00000020  8f 97 c1 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
+00000030  b2 0d 99 04 5c 56 a2 6e  50 e1 52 80 c5 3c 4b 69  |....\V.nP.R..<Ki|
+00000040  21 df                                             |!.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4 b/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4
index 24a9b8e415..1bc33d7451 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4
+++ b/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 55 02 00 00  51 03 03 7c f1 44 f1 2a  |....U...Q..|.D.*|
-00000010  6f 7f 62 66 08 15 dd c8  bd 4a 30 b5 a3 73 53 82  |o.bf.....J0..sS.|
-00000020  93 78 6b f2 c6 70 70 1e  4d 8f 48 20 24 b3 17 46  |.xk..pp.M.H $..F|
-00000030  37 c0 0f 79 af f4 48 43  17 6b ea df 6b 73 07 cf  |7..y..HC.k..ks..|
-00000040  5f 95 c5 5c 8d b2 99 5c  fd 30 e5 1b 00 05 00 00  |_..\...\.0......|
+00000000  16 03 03 00 55 02 00 00  51 03 03 e6 2c 7a 70 96  |....U...Q...,zp.|
+00000010  c0 bf e7 e6 2e 51 35 c7  3e 0a 4c 1e 2a 0b 54 08  |.....Q5.>.L.*.T.|
+00000020  57 e1 66 22 94 26 fe df  ce 7e bf 20 26 07 f0 81  |W.f".&...~. &...|
+00000030  7d 73 2c 70 6f d1 1b 85  f5 af 97 7e 5b 3f 5e a0  |}s,po......~[?^.|
+00000040  fc 9b 7d 5a c3 e2 05 30  b5 f5 47 05 00 05 00 00  |..}Z...0..G.....|
 00000050  09 ff 01 00 01 00 00 17  00 00 16 03 03 02 59 0b  |..............Y.|
 00000060  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
 00000070  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
@@ -72,15 +74,15 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 03 00 24 fd 67  40 11 7e 4d 8f bb 87 e8  |.....$.g@.~M....|
-000000a0  c3 1f e8 b0 15 17 3a f4  6f 5f 87 b2 50 c5 92 e4  |......:.o_..P...|
-000000b0  ac c0 c0 98 aa 6f be bc  fc 77                    |.....o...w|
+00000090  01 16 03 03 00 24 ad c5  35 7b 7c 74 c7 24 58 ef  |.....$..5{|t.$X.|
+000000a0  55 3f 8d c1 52 97 f8 91  93 46 02 ff cf 06 00 ba  |U?..R....F......|
+000000b0  26 91 ec c4 91 23 60 b2  c8 77                    |&....#`..w|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 24 e8 ea 6f 8a 0c  |..........$..o..|
-00000010  79 70 73 a9 7b 2c a8 0a  e5 f8 26 f3 eb 05 20 65  |yps.{,....&... e|
-00000020  58 9b 0c 8e 28 3d c7 ee  cf 57 85 06 a5 d7 46     |X...(=...W....F|
+00000000  14 03 03 00 01 01 16 03  03 00 24 e6 06 60 54 3e  |..........$..`T>|
+00000010  39 d8 22 df 83 a7 7a 4d  b4 63 03 77 3d 5d e8 06  |9."...zM.c.w=]..|
+00000020  6f fe 0a 70 4b b3 82 cc  a8 aa 48 2e f2 72 7b     |o..pK.....H..r{|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1a 2d 7a c5  d0 12 79 e8 a2 05 d3 a4  |.....-z...y.....|
-00000010  51 80 8f 28 37 b9 75 64  f3 11 4c 78 de 0c f3 15  |Q..(7.ud..Lx....|
-00000020  03 03 00 16 43 89 2c 8b  9e dc c5 5d 4c ca 7b 4e  |....C.,....]L.{N|
-00000030  15 e4 e5 62 01 02 b4 d4  6f 1c                    |...b....o.|
+00000000  17 03 03 00 1a e5 e3 38  a3 34 e4 02 f1 c4 96 14  |.......8.4......|
+00000010  13 fb 50 7d 6a 26 cf 49  f8 d6 e5 f0 d8 7c b5 15  |..P}j&.I.....|..|
+00000020  03 03 00 16 a4 cd 6c b6  b2 45 d7 35 df 56 ba ae  |......l..E.5.V..|
+00000030  a9 41 09 85 67 bb 16 c0  3e d0                    |.A..g...>.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce
index 0510d5e2d3..8456e3abf7 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 55 71 df 37 76  |....]...Y..Uq.7v|
-00000010  48 bb 86 62 66 f1 58 0d  92 f4 c8 bd 17 6c 00 43  |H..bf.X......l.C|
-00000020  a9 da f1 6f 19 2c 76 81  6d aa eb 20 4f c7 eb 3f  |...o.,v.m.. O..?|
-00000030  b8 48 89 7f d8 61 bc e8  3c e6 a0 3d 6c 29 fd 60  |.H...a..<..=l).`|
-00000040  7c 0a 09 1c 71 41 07 04  24 dc e7 27 cc a8 00 00  ||...qA..$..'....|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 eb da 48 1d 79  |....]...Y....H.y|
+00000010  90 f6 67 5b 69 7b 40 07  20 12 0b 12 bd 94 75 e0  |..g[i{@. .....u.|
+00000020  84 3f 0d a5 77 c6 36 18  25 79 3c 20 07 6c 6d c7  |.?..w.6.%y< .lm.|
+00000030  b4 7e 2a 2b a5 7e 55 36  83 4d d9 94 9f 73 60 d8  |.~*+.~U6.M...s`.|
+00000040  e9 55 05 b9 bf b0 64 84  09 fe c0 2a cc a8 00 00  |.U....d....*....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -61,186 +63,188 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 7a 15 23  |............ z.#|
-000002d0  f5 78 c2 16 21 72 bb e5  d3 2e c9 67 55 a8 2c 1f  |.x..!r.....gU.,.|
-000002e0  00 50 a2 04 4f 71 9a 94  4a 90 55 69 33 08 04 00  |.P..Oq..J.Ui3...|
-000002f0  80 53 b3 16 f5 08 3a 5a  84 3c 02 5d c3 b6 0e c2  |.S....:Z.<.]....|
-00000300  93 f6 27 74 24 b4 e2 3d  22 04 30 a0 d6 5b c8 da  |..'t$..=".0..[..|
-00000310  6e 56 30 d4 fb 86 fd 76  8f 1b 47 c0 55 95 cd 15  |nV0....v..G.U...|
-00000320  bf a7 27 ce 2d c3 43 6b  ed 2d 09 bb eb 55 73 c9  |..'.-.Ck.-...Us.|
-00000330  2c ee cd 23 af d9 1c 51  1d 0c 00 14 01 61 8a fd  |,..#...Q.....a..|
-00000340  8f 95 d1 ce 32 57 ae 2b  09 15 b4 86 41 1e 74 f5  |....2W.+....A.t.|
-00000350  d5 96 d7 e1 03 03 09 f4  3c 53 fe 6b 9a c1 52 ab  |........<S.k..R.|
-00000360  91 81 9f f8 f9 6b 23 60  49 22 6b 28 10 e2 6b e8  |.....k#`I"k(..k.|
-00000370  e4 16 03 03 00 04 0e 00  00 00                    |..........|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 be 2a c0  |............ .*.|
+000002d0  ce 61 d8 36 d0 41 4c 32  83 bb be 81 66 c8 cf cb  |.a.6.AL2....f...|
+000002e0  a2 d9 ff 9d 05 51 d9 52  bc 06 be 09 10 08 04 00  |.....Q.R........|
+000002f0  80 00 d1 fc 8c 60 a1 8f  36 3d a5 53 62 06 dd 93  |.....`..6=.Sb...|
+00000300  58 30 71 f6 a1 b8 bd c4  4e 44 2d 37 b8 38 d1 6f  |X0q.....ND-7.8.o|
+00000310  16 8d f6 6d 4a 7c af e2  a2 4a 55 b5 17 d2 61 a0  |...mJ|...JU...a.|
+00000320  93 80 d4 a9 11 49 55 cf  e3 d0 87 95 c9 c2 f6 d0  |.....IU.........|
+00000330  44 6f 33 2b ae 4a 1d e4  1e 04 f5 32 ca d6 19 61  |Do3+.J.....2...a|
+00000340  9c 8e 0d d1 1a f3 38 4b  b3 c3 eb dd fb 04 40 b7  |......8K......@.|
+00000350  f7 ef 1f f1 0a 23 08 21  2a b3 d9 f8 cf 2b 65 4c  |.....#.!*....+eL|
+00000360  47 92 52 18 61 5e f3 ad  58 36 26 09 bf 12 b6 ab  |G.R.a^..X6&.....|
+00000370  21 16 03 03 00 04 0e 00  00 00                    |!.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 bf 35 ae  8c b4 63 82 40 e8 5d d4  |.... .5...c.@.].|
-00000040  bb 3d 0a 0f 07 28 3a 74  2c 5b a8 d0 a6 ab 88 ba  |.=...(:t,[......|
-00000050  7d 5c 1c 42 c7                                    |}\.B.|
+00000030  16 03 03 00 20 68 e5 aa  89 6f 05 45 05 68 e9 53  |.... h...o.E.h.S|
+00000040  35 a0 9b 96 d9 6b ab 2c  7f e1 4c de 3e 06 c6 04  |5....k.,..L.>...|
+00000050  bd 7c 28 fb db                                    |.|(..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 e7 86 48 6c 00  |.......... ..Hl.|
-00000010  0a 1e f5 5f b8 ff ad 1c  9d 74 24 c5 6e d4 c6 6e  |..._.....t$.n..n|
-00000020  25 27 7d 6e 18 44 96 29  eb db b0                 |%'}n.D.)...|
+00000000  14 03 03 00 01 01 16 03  03 00 20 fd 74 c3 42 59  |.......... .t.BY|
+00000010  0d 86 2a 1c c7 51 d9 98  2c 1e 5b bd 44 3e 97 3e  |..*..Q..,.[.D>.>|
+00000020  55 90 5e 74 45 b7 47 0f  f7 3e d7                 |U.^tE.G..>.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 64 9d 31  09 a1 ce 5a 6d ec 6f c4  |.....d.1...Zm.o.|
-00000010  e5 09 df 92 5f d2 1c 7d  62 c4 e7                 |...._..}b..|
+00000000  17 03 03 00 16 b5 ca 44  da 63 57 7f 6c e9 95 a5  |.......D.cW.l...|
+00000010  56 88 f1 98 dc 73 85 3f  36 66 6f                 |V....s.?6fo|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 14 9b cb 75  61 99 76 30 9c 14 a5 12  |.......ua.v0....|
-00000010  92 de b7 95 cc 8f fe ad  f1                       |.........|
+00000000  16 03 03 00 14 76 6b 6b  8c c1 38 cf 00 bf 20 c2  |.....vkk..8... .|
+00000010  62 ae df 09 0e 61 61 bf  24                       |b....aa.$|
 >>> Flow 7 (client to server)
-00000000  16 03 03 01 1a c7 9a be  e1 2a 62 9f 01 59 e9 6a  |.........*b..Y.j|
-00000010  5f d6 32 88 bd 39 76 1b  34 fd 39 8d c7 31 cb 97  |_.2..9v.4.9..1..|
-00000020  c6 09 8b 00 c9 f3 f9 00  c5 b6 48 e1 28 ae b8 8b  |..........H.(...|
-00000030  b2 f0 eb 8b cb e8 68 30  50 b5 23 ba cf f3 8d f3  |......h0P.#.....|
-00000040  47 5f 94 ac fb 5e 56 9e  5a f8 e7 12 60 13 83 9c  |G_...^V.Z...`...|
-00000050  34 ca 45 a7 63 5f 2c 6e  46 c8 5a a0 d3 5b 9a a6  |4.E.c_,nF.Z..[..|
-00000060  70 be da df 9e 79 21 98  bd fb 94 01 6d 14 f4 5c  |p....y!.....m..\|
-00000070  2a 13 56 26 47 33 7d 4f  ab 5a fc 9c 9e 8d f4 75  |*.V&G3}O.Z.....u|
-00000080  d0 64 16 ba f2 0d 04 ca  5d 94 6b da a8 09 b1 29  |.d......].k....)|
-00000090  70 a9 37 1e ac 94 e3 81  60 c3 19 f3 a9 99 6a 11  |p.7.....`.....j.|
-000000a0  b1 e7 23 45 8a f5 42 f5  50 76 9f 1e 9e a8 e7 75  |..#E..B.Pv.....u|
-000000b0  4a 18 84 80 da 10 ed 83  9a 14 a9 a1 90 54 8e 8b  |J............T..|
-000000c0  d1 32 83 6d e7 7e be 59  f4 66 59 53 75 37 c6 82  |.2.m.~.Y.fYSu7..|
-000000d0  15 aa 56 0a 01 e1 11 ba  64 0c 8e 44 93 60 29 a4  |..V.....d..D.`).|
-000000e0  cc 9f b0 b9 d5 df 9c aa  64 2c ef 0c 9a 18 2a 97  |........d,....*.|
-000000f0  e1 20 07 37 35 28 97 9d  00 53 61 11 81 22 45 9e  |. .75(...Sa.."E.|
-00000100  c3 d7 b2 b3 4c f2 05 5b  e6 a4 de 11 7f a7 a2 82  |....L..[........|
-00000110  88 1c cb d9 24 80 3d 34  0c fc 22 58 32 28 1b     |....$.=4.."X2(.|
+00000000  16 03 03 01 38 0f c1 53  8f f5 61 aa 61 0a f4 de  |....8..S..a.a...|
+00000010  80 a6 92 99 a0 33 e6 90  5f b0 13 b7 be 93 0f 60  |.....3.._......`|
+00000020  40 97 0a 3c dd 9f 22 fa  c1 8f 1d 3d 11 c1 16 97  |@..<.."....=....|
+00000030  c5 54 e4 08 fb 77 ff fb  51 fb 1a d1 a6 41 b8 4f  |.T...w..Q....A.O|
+00000040  a2 22 d7 11 8c 31 49 d7  d5 b2 16 02 2b 4d b6 ba  |."...1I.....+M..|
+00000050  7d 53 6c 5a 59 59 ec 54  00 c4 6b c3 bd 22 d1 b3  |}SlZYY.T..k.."..|
+00000060  78 f8 e7 25 6e 67 b5 32  51 a6 60 5b 55 9a a0 f4  |x..%ng.2Q.`[U...|
+00000070  ed e8 8c 8d 77 4b c3 04  9d b0 2a ed a0 bf 9f 03  |....wK....*.....|
+00000080  fa e5 2e 17 9e 04 d6 6c  38 70 33 bc 90 eb 6f db  |.......l8p3...o.|
+00000090  33 9e 69 5f 44 8c 63 af  9f 6e 74 e0 a8 d2 1b 7d  |3.i_D.c..nt....}|
+000000a0  d1 11 ea f4 c5 49 2c 7a  98 ae f6 28 58 76 ac da  |.....I,z...(Xv..|
+000000b0  31 0d 7a c7 2d e6 8a 34  9d 37 26 c8 3e 44 ac df  |1.z.-..4.7&.>D..|
+000000c0  0b 4b 2c 4e 7c 63 ec 23  82 13 a3 87 ac f7 9a 08  |.K,N|c.#........|
+000000d0  03 1c e9 ca 89 4a a8 93  37 a3 d6 1f fa dd c8 48  |.....J..7......H|
+000000e0  4a 4a ba 4d 54 80 20 18  a6 e4 98 3d dd 81 58 ec  |JJ.MT. ....=..X.|
+000000f0  9f c0 5f 06 d6 29 04 76  38 1f d0 f4 3f fe 82 ab  |.._..).v8...?...|
+00000100  de cb 12 44 a2 96 eb ac  d2 8d a1 76 37 85 71 80  |...D.......v7.q.|
+00000110  de 8b 66 50 8e 41 17 cf  9b 2b 3a 7e 1d a3 e2 26  |..fP.A...+:~...&|
+00000120  9f 60 1c 1e 89 06 d8 41  21 8d 3d ab 91 15 be 61  |.`.....A!.=....a|
+00000130  6c 07 2a e7 55 8f 6c a5  13 51 9d cc 6f           |l.*.U.l..Q..o|
 >>> Flow 8 (server to client)
-00000000  16 03 03 00 85 ba 55 5d  15 b8 6d 8a b6 82 a8 e1  |......U]..m.....|
-00000010  88 ea fe c0 a6 a8 fe 78  ed 8b ae 44 eb 7b 6c cc  |.......x...D.{l.|
-00000020  0f ad a1 da da 86 fb 60  07 4a 0e 5c ba 36 09 8b  |.......`.J.\.6..|
-00000030  95 3f f0 87 26 0f 7a e7  7c 1f af c7 67 42 c9 39  |.?..&.z.|...gB.9|
-00000040  39 6a 4d 8d 87 00 3b 14  76 4a 86 87 46 1e d4 04  |9jM...;.vJ..F...|
-00000050  2d ea c1 44 1f e8 87 71  da 1e 26 72 a2 e9 40 0c  |-..D...q..&r..@.|
-00000060  33 6e 6f 06 43 ed 7f fc  8f 4c d4 f4 0f 83 19 cb  |3no.C....L......|
-00000070  52 a9 94 f3 6a 64 db dd  20 d1 a7 d4 c7 6e 86 ed  |R...jd.. ....n..|
-00000080  6e ea 5c 66 d1 34 a6 92  7e b1 16 03 03 02 69 48  |n.\f.4..~.....iH|
-00000090  13 97 82 60 46 e1 c9 02  d2 e1 f3 62 da d6 3a c1  |...`F......b..:.|
-000000a0  2a a7 47 bd c2 ee 09 d5  2d 7e 5e 35 09 79 88 35  |*.G.....-~^5.y.5|
-000000b0  96 50 09 68 79 e9 de e1  71 97 11 60 c5 4e 84 54  |.P.hy...q..`.N.T|
-000000c0  03 78 69 84 e3 7f 02 1a  58 04 ed 53 47 01 b6 9e  |.xi.....X..SG...|
-000000d0  bd 5f 77 34 e7 52 3b 73  45 e1 10 3f c8 6e 4c 09  |._w4.R;sE..?.nL.|
-000000e0  d0 4b 79 f8 de 0f 15 e7  2d 42 5d 7a 89 80 1f fb  |.Ky.....-B]z....|
-000000f0  f9 02 6f a1 72 d4 8d 65  8e d0 a8 43 41 4c 48 57  |..o.r..e...CALHW|
-00000100  71 21 b3 14 45 e5 b1 f5  55 7a dd 89 c3 0f af 27  |q!..E...Uz.....'|
-00000110  03 d6 5c 2d bc 24 5b 51  fa ae 34 7b f9 56 e8 41  |..\-.$[Q..4{.V.A|
-00000120  cd 77 1c 3d c8 45 f5 a5  4a 97 92 ff bb cd 5b ff  |.w.=.E..J.....[.|
-00000130  d5 33 d6 02 9b 2a 5a 3a  e4 1b fb 48 34 b3 0b ce  |.3...*Z:...H4...|
-00000140  d7 34 5c 4a b4 4b bd 87  b6 72 40 ab 29 b0 65 25  |.4\J.K...r@.).e%|
-00000150  c7 1d 71 b6 e2 d7 b1 23  b1 96 a6 bd 74 eb ad 69  |..q....#....t..i|
-00000160  59 0c 0f af 8a 64 be e4  a7 27 c2 95 11 05 55 a1  |Y....d...'....U.|
-00000170  d6 44 df ad 1d 9c 3a 88  24 52 52 9d 42 f2 74 98  |.D....:.$RR.B.t.|
-00000180  08 9f 55 1b 2f 79 ca b4  63 38 e4 f2 fa 99 ce 66  |..U./y..c8.....f|
-00000190  77 ac 8d 31 91 05 1c bc  51 0a 31 df 5d 3e f8 69  |w..1....Q.1.]>.i|
-000001a0  b7 fa f2 35 af 57 6d 7b  c3 bf 1d 98 21 40 dd 02  |...5.Wm{....!@..|
-000001b0  1c de ac 02 40 c8 d6 04  23 30 71 16 d0 0a 26 29  |....@...#0q...&)|
-000001c0  66 e9 f1 a8 76 f8 52 18  3e 3f c5 66 c9 11 04 6c  |f...v.R.>?.f...l|
-000001d0  32 1b 35 cc 9a 34 70 07  da db 12 51 78 77 dc bc  |2.5..4p....Qxw..|
-000001e0  7a bb b8 b9 06 79 bb 04  dd d4 46 8e b5 69 d5 39  |z....y....F..i.9|
-000001f0  5e 34 8e 37 dd a2 3e 31  be 28 19 45 21 76 5b dc  |^4.7..>1.(.E!v[.|
-00000200  7d 25 a2 41 98 16 1b 5b  69 f0 90 f9 28 a8 e9 b5  |}%.A...[i...(...|
-00000210  6f 00 e3 3e eb f6 f3 e4  c9 0f bb 74 ce 40 23 df  |o..>.......t.@#.|
-00000220  12 c6 78 b0 2e bb 68 96  04 a3 e3 43 6b 4b c3 37  |..x...h....CkK.7|
-00000230  6d 97 c6 79 1a ff 4f 00  c7 76 64 5c b8 b3 17 20  |m..y..O..vd\... |
-00000240  3c 3e 6b d5 2b 72 88 11  73 1e 63 a7 6f 1e ae 83  |<>k.+r..s.c.o...|
-00000250  10 77 6f d1 96 86 84 63  fd 27 8e b9 54 da 4b b5  |.wo....c.'..T.K.|
-00000260  56 f0 50 8a aa c7 e1 b3  cb 9c 36 9e ec 38 31 39  |V.P.......6..819|
-00000270  78 ec ea 34 8a 87 cf 6b  34 fd 5e 81 92 81 61 f1  |x..4...k4.^...a.|
-00000280  88 e7 50 62 2e 58 0b d9  b9 ca f3 ed 79 a9 9a 01  |..Pb.X......y...|
-00000290  80 9d 7f 84 ae de fb 51  ac 0f 6b b9 76 fd 68 d4  |.......Q..k.v.h.|
-000002a0  f4 8d c3 92 6b 5e 9e 99  ff 7a f4 b7 0e ec 0d e7  |....k^...z......|
-000002b0  6b 24 75 fb 21 49 6f 5b  31 12 f2 88 8e 3b b4 34  |k$u.!Io[1....;.4|
-000002c0  f2 f7 c6 e7 48 0e d6 1d  81 11 32 16 01 cb b7 7f  |....H.....2.....|
-000002d0  a6 bd 9c 87 8c 0f 12 b2  dc 73 5d a0 46 fd f3 e8  |.........s].F...|
-000002e0  b8 6f e4 38 ab 94 96 a8  bd ed 90 0e 31 1f fc 2f  |.o.8........1../|
-000002f0  8f 50 e2 97 6a f5 5c b4  16 03 03 00 bc 65 bb 7c  |.P..j.\......e.||
-00000300  42 03 0d 42 46 e3 ac 9f  8a 96 b6 a3 f4 cf a5 30  |B..BF..........0|
-00000310  5b 02 17 dc 20 7d 18 19  21 a4 70 f4 4b 99 bf b5  |[... }..!.p.K...|
-00000320  cd d7 07 59 a5 82 ed 85  03 06 5c 34 3f c8 c3 4d  |...Y......\4?..M|
-00000330  c3 fb 96 05 bf b5 bd bf  e2 28 07 7e 51 a6 84 90  |.........(.~Q...|
-00000340  bf 9e 2e f6 b5 04 8e 06  7a 63 c8 00 84 a1 a3 2c  |........zc.....,|
-00000350  f3 6f 52 52 c4 ce 4a 59  31 1f d4 ab 2e f4 75 90  |.oRR..JY1.....u.|
-00000360  a5 3b ff ab 20 be 51 92  c5 f4 4d 8b f2 2a a7 ff  |.;.. .Q...M..*..|
-00000370  90 07 40 3e d6 9c cf 23  54 d1 65 d3 74 79 af 51  |..@>...#T.e.ty.Q|
-00000380  31 35 40 aa 29 42 32 7e  42 2d af 79 e8 59 6a 10  |15@.)B2~B-.y.Yj.|
-00000390  c5 55 6b 70 53 53 ab 02  48 ba 1f df 07 59 f8 34  |.UkpSS..H....Y.4|
-000003a0  ee 1d d3 e9 12 86 8b 37  2b cc 27 78 fe e1 65 2b  |.......7+.'x..e+|
-000003b0  c3 1e f2 25 a4 6d 3c b1  d4 16 03 03 00 4a 50 98  |...%.m<......JP.|
-000003c0  cd ee ab 2c 94 95 d6 46  06 ef 63 65 5c aa 6d 6e  |...,...F..ce\.mn|
-000003d0  fb a0 99 62 23 af 7a 7d  17 dc a3 c6 2b 9a 56 2e  |...b#.z}....+.V.|
-000003e0  b8 60 87 1e 88 5d 58 27  3f 02 b4 f5 2f 3b 17 8c  |.`...]X'?.../;..|
-000003f0  f9 93 0c a9 58 af 11 ed  27 9d af a5 0a 2b d6 55  |....X...'....+.U|
-00000400  7e c4 54 4a 36 51 b7 7b  16 03 03 00 14 c1 c4 d7  |~.TJ6Q.{........|
-00000410  ea 2d f0 8c 54 0e 19 33  e1 7e a8 ae 49 7c 5e 05  |.-..T..3.~..I|^.|
-00000420  23                                                |#|
+00000000  16 03 03 00 85 2f 7c ac  ad 05 49 3c 82 9c 82 20  |...../|...I<... |
+00000010  0d 77 42 bd 9d 90 c3 2f  ab c3 c2 60 a4 18 77 23  |.wB..../...`..w#|
+00000020  02 5b e8 e0 3a f3 b7 ee  b8 eb d8 7e c5 f6 52 9e  |.[..:......~..R.|
+00000030  d7 29 b8 1b 51 62 c0 b9  02 79 df 8a 3a 15 ec 74  |.)..Qb...y..:..t|
+00000040  9e 2d cf c9 b1 1f 0b d3  7a b5 95 4d 74 80 5a 31  |.-......z..Mt.Z1|
+00000050  57 f9 dc 03 be e5 d3 0b  2d 6e 55 1a 58 b4 43 a8  |W.......-nU.X.C.|
+00000060  c6 e2 d1 c1 26 30 f5 3e  25 13 b6 4d df de 16 fd  |....&0.>%..M....|
+00000070  fd 29 85 e8 7f bf 54 74  4d 40 9a 58 c9 d2 e6 af  |.)....TtM@.X....|
+00000080  e4 fe 8d fc 0f 2e bc 1a  70 25 16 03 03 02 69 23  |........p%....i#|
+00000090  0f f9 ff b3 8a ba 05 c3  be fb 3b 29 c5 4c 3f 2e  |..........;).L?.|
+000000a0  87 c5 2e ec 88 48 24 b7  25 a8 d2 b9 00 7b aa 4c  |.....H$.%....{.L|
+000000b0  bc 04 96 79 ed a3 e9 3d  cf 64 2b 7f 9c 6b b8 3a  |...y...=.d+..k.:|
+000000c0  53 c3 70 96 39 64 5d 65  c4 aa e3 88 18 7e f6 8c  |S.p.9d]e.....~..|
+000000d0  36 2b 9b 19 4e 91 40 a3  6c 49 f5 37 96 cb ec f1  |6+..N.@.lI.7....|
+000000e0  77 ea 92 dc 17 26 cd 7a  3a 94 30 6a 25 ec 98 6d  |w....&.z:.0j%..m|
+000000f0  87 ed 9b 30 1e c3 5a 40  84 93 34 a4 d3 5a d3 1b  |...0..Z@..4..Z..|
+00000100  10 94 9a 92 73 d3 6f 4d  81 72 08 5a dd 6f f0 cd  |....s.oM.r.Z.o..|
+00000110  ee 45 cf 16 40 a1 60 e8  f9 35 9a 8a 03 79 2f 7c  |.E..@.`..5...y/||
+00000120  4a 08 8d 3b a9 0f 9c f8  1e 86 b7 f5 e8 da 09 06  |J..;............|
+00000130  9b 1e f7 2d 58 22 2b d0  7d 3d 25 63 52 c4 20 e6  |...-X"+.}=%cR. .|
+00000140  a1 c5 37 52 af a2 32 a5  78 fb fb f6 d4 6c 58 cd  |..7R..2.x....lX.|
+00000150  3b 4d 0e b3 6c 7c 00 0a  dc 0e b6 7b f9 b7 42 7e  |;M..l|.....{..B~|
+00000160  0e a3 84 78 69 d5 9e 05  c1 17 4c d5 b0 5b 0a 5b  |...xi.....L..[.[|
+00000170  d1 27 dc 7c b6 44 a1 16  0c 97 80 18 2e 7b 5a fe  |.'.|.D.......{Z.|
+00000180  ca a4 05 36 76 6a a1 89  3e ad 1c 4a 60 7a 35 64  |...6vj..>..J`z5d|
+00000190  fb fc db 28 a9 96 68 86  8d 77 e9 c0 60 1d ed 18  |...(..h..w..`...|
+000001a0  9d 6f c4 4c e9 70 60 66  03 ef 28 99 f3 4b 93 03  |.o.L.p`f..(..K..|
+000001b0  06 ef be de 5a 85 de c0  9a 2f 45 f2 77 bd 2a e3  |....Z..../E.w.*.|
+000001c0  3d f3 6d 3b e8 20 f0 fd  a6 9a cf 43 cf 83 7e 77  |=.m;. .....C..~w|
+000001d0  4b 71 dc 8a d8 4d 85 a5  2d 84 3a ff 75 40 d8 7c  |Kq...M..-.:.u@.||
+000001e0  f4 2f ff 12 86 1a a6 9c  dc 28 28 0f 33 40 63 f8  |./.......((.3@c.|
+000001f0  de 3f 9d 7c ae 9f b9 3a  21 be e9 e7 ae 52 9b 85  |.?.|...:!....R..|
+00000200  2b a6 44 78 e1 23 7d 03  eb a4 c0 59 2d 0c d6 e4  |+.Dx.#}....Y-...|
+00000210  8f 6c 37 bc d5 0c 7f e5  28 e1 5a 0c 65 0b 57 c7  |.l7.....(.Z.e.W.|
+00000220  d2 61 13 b0 dc 19 4b a0  22 cc d9 1f 42 e9 3a 92  |.a....K."...B.:.|
+00000230  ce 4e 37 c9 1b 82 7c 0c  af b5 3f 5a a8 f4 c4 fb  |.N7...|...?Z....|
+00000240  fe dc 4a 19 32 da af aa  7c bf f7 2a b0 dc af ce  |..J.2...|..*....|
+00000250  c9 96 a1 30 b5 f8 4f 07  ca e6 db cd 71 c7 09 75  |...0..O.....q..u|
+00000260  0b 7d 30 d9 5d 02 b0 b7  ff fc 92 11 e0 1e 37 40  |.}0.].........7@|
+00000270  2f eb 50 8d 65 53 db 52  1c e8 42 2f 89 0d 61 cf  |/.P.eS.R..B/..a.|
+00000280  a0 a6 10 0f c7 05 c3 6a  32 eb b1 ca 26 f5 1d fc  |.......j2...&...|
+00000290  96 ec 55 f9 8a e6 05 13  d3 0a fb 74 6a 9a 3f 4f  |..U........tj.?O|
+000002a0  ca ce 4e 29 2f 46 4c ef  47 13 72 72 aa 46 c4 12  |..N)/FL.G.rr.F..|
+000002b0  9a a7 f1 90 b2 ea b2 09  d4 db 77 c7 31 7d 6c d6  |..........w.1}l.|
+000002c0  51 9f 97 91 f6 ba 0a fb  a7 63 3e 68 e3 f2 50 5d  |Q........c>h..P]|
+000002d0  b1 33 b8 8b f1 91 68 df  3f b3 9f 5d a7 b5 c1 93  |.3....h.?..]....|
+000002e0  bf 5d 8d 3e 90 05 88 bc  d9 43 d0 9d 25 17 c1 4a  |.].>.....C..%..J|
+000002f0  4a 7f e5 73 d5 0b d6 a5  16 03 03 00 bc 1d 81 1d  |J..s............|
+00000300  dd 11 fe e7 08 d4 0a 50  1a 15 75 a4 0b 49 03 96  |.......P..u..I..|
+00000310  8a 1f ba 30 e9 e3 55 c2  a7 27 cf 3a f6 4c 0a 3d  |...0..U..'.:.L.=|
+00000320  01 5a 08 9a 88 4d ac 0b  7c 84 5c 15 81 84 2d a7  |.Z...M..|.\...-.|
+00000330  8e 4b 92 0b 7c de e9 91  20 07 ca 16 cd 43 8f ec  |.K..|... ....C..|
+00000340  db 7a 16 c9 2c 19 25 23  07 01 4f 68 cc 09 af e0  |.z..,.%#..Oh....|
+00000350  cf d7 7c 2f e0 e7 65 3c  1a 24 c4 d8 b2 ae b9 25  |..|/..e<.$.....%|
+00000360  20 7b 26 e5 50 a6 e1 b0  a6 18 e1 67 79 f3 a9 f0  | {&.P......gy...|
+00000370  bf b1 16 34 47 75 f2 6c  2d 9c ce c4 c8 7b 7d c5  |...4Gu.l-....{}.|
+00000380  6f 19 3a 2f 3a 5b 3c ce  9f 8d a2 1d 77 ba 9d 15  |o.:/:[<.....w...|
+00000390  7a ee b4 88 62 f1 9e 04  4c be 48 ea 0f 2f e5 cf  |z...b...L.H../..|
+000003a0  c0 0b 11 0b 67 9e c7 1c  3d 6b da 86 31 b0 fb 9c  |....g...=k..1...|
+000003b0  55 94 18 26 7a 0e 9b e7  99 16 03 03 00 4a c4 b6  |U..&z........J..|
+000003c0  b8 bf cc 7e 5e 8f c4 a0  84 53 bd 28 e4 1d 47 48  |...~^....S.(..GH|
+000003d0  88 52 dc 46 46 e3 43 60  d2 90 62 c0 0f f5 37 5a  |.R.FF.C`..b...7Z|
+000003e0  31 4a b1 c8 45 80 b8 91  71 45 f7 64 08 ae c7 c7  |1J..E...qE.d....|
+000003f0  9c ab 03 57 fb d6 04 ff  11 3f be 41 a8 1e a6 d1  |...W.....?.A....|
+00000400  18 d7 ce 5d df 0a 12 d2  16 03 03 00 14 ea 34 3b  |...]..........4;|
+00000410  30 86 2c da 14 f5 a8 c4  0b 08 b9 1a c5 5c 7d ba  |0.,..........\}.|
+00000420  82                                                |.|
 >>> Flow 9 (client to server)
-00000000  16 03 03 02 69 83 ef 87  6b aa f1 2a cc c1 b8 5d  |....i...k..*...]|
-00000010  47 e4 2d da c5 91 62 e4  7d 49 da 54 a3 79 fb 1d  |G.-...b.}I.T.y..|
-00000020  59 49 e8 a6 ab 79 c0 9f  51 f9 d2 63 0d 8c 6b 7f  |YI...y..Q..c..k.|
-00000030  b6 77 2d f3 b3 3e 78 86  3a 14 1a ab 3b 5e 23 b2  |.w-..>x.:...;^#.|
-00000040  d3 5c b1 2b 5c f4 f0 9d  e2 87 08 d0 2f 24 30 d3  |.\.+\......./$0.|
-00000050  05 eb f8 a6 b2 d1 52 00  c3 9e 0b 82 34 3e fd 5a  |......R.....4>.Z|
-00000060  46 d5 b6 b2 f0 a0 96 11  e1 35 c2 32 57 d6 dd b2  |F........5.2W...|
-00000070  a8 ad b2 71 a2 6f 83 05  d6 f1 83 38 a0 3c 13 ff  |...q.o.....8.<..|
-00000080  c1 c1 b0 1e b5 40 5b b5  05 31 65 0b 81 a6 b0 37  |.....@[..1e....7|
-00000090  7d 16 3b 7b cb e7 58 7f  81 25 e3 39 37 98 87 b0  |}.;{..X..%.97...|
-000000a0  e1 8f c0 d5 de 33 fe de  15 37 41 25 d8 97 5d 84  |.....3...7A%..].|
-000000b0  28 12 b4 a5 b0 15 f1 f4  cf 41 28 e9 26 5d ba 36  |(........A(.&].6|
-000000c0  da b6 a6 cb 21 92 21 30  4b 21 4d 44 28 4d 76 d1  |....!.!0K!MD(Mv.|
-000000d0  61 65 fa 02 05 67 50 ec  7d 98 78 21 46 5d fe 75  |ae...gP.}.x!F].u|
-000000e0  78 8e 9d 41 6a 0a d7 0e  27 22 d0 a1 21 57 3d 23  |x..Aj...'"..!W=#|
-000000f0  d1 7d 08 f4 0b 1b 90 ec  63 74 4c e7 df c8 8f 8b  |.}......ctL.....|
-00000100  b8 cd 2b 06 a5 35 f5 c1  62 d5 46 f3 d5 19 5b ce  |..+..5..b.F...[.|
-00000110  c8 d2 f4 c1 51 5f cd b2  51 23 61 bf 93 7f 5d bd  |....Q_..Q#a...].|
-00000120  61 f2 b2 e0 ad be ab d7  c9 77 26 c2 61 fb 25 8d  |a........w&.a.%.|
-00000130  46 38 7a 30 48 9f b5 5c  47 6b ce 10 1d 03 d0 68  |F8z0H..\Gk.....h|
-00000140  7f 00 c0 94 f4 35 eb 41  e8 91 f6 d9 5c 44 d6 79  |.....5.A....\D.y|
-00000150  72 9f 22 a4 08 fd 74 1b  42 dc 49 06 34 8f b6 f5  |r."...t.B.I.4...|
-00000160  12 1c 09 f0 d4 eb e4 6e  d5 9a 31 f9 1a 88 c1 bf  |.......n..1.....|
-00000170  37 42 90 5f c8 e1 38 2b  8b 4b c1 cd 66 72 e6 49  |7B._..8+.K..fr.I|
-00000180  d3 19 0e 01 19 60 f7 7d  d3 66 b2 bf bd 94 30 c9  |.....`.}.f....0.|
-00000190  3a 01 aa b6 dc 2a d6 1a  68 cf a6 31 5e 9a 1d 5b  |:....*..h..1^..[|
-000001a0  90 bb 77 33 31 f2 28 5a  70 a5 c5 ef 91 91 27 22  |..w31.(Zp.....'"|
-000001b0  59 33 d5 22 78 8e 8f 07  91 3c 69 ec b9 81 be e8  |Y3."x....<i.....|
-000001c0  be bd 63 20 54 6c 2c 27  46 38 9a 45 06 4e aa b3  |..c Tl,'F8.E.N..|
-000001d0  37 93 72 6a 90 a6 18 14  88 6e 5b fc 54 44 48 a8  |7.rj.....n[.TDH.|
-000001e0  bc c6 86 52 a6 b8 a7 a4  02 04 91 e0 4b 28 4b dc  |...R........K(K.|
-000001f0  c8 cc db e3 f7 89 69 a3  3b 22 d0 75 16 c8 16 cc  |......i.;".u....|
-00000200  a2 3c 56 c5 00 d1 1d 11  7f 74 1f bb 3d ec 1b c0  |.<V......t..=...|
-00000210  30 67 81 36 11 11 60 d2  e1 be ce e4 0c f6 d0 df  |0g.6..`.........|
-00000220  fd 7c dc 7f 3d 40 8d 65  ec 69 c7 55 30 db 9c d3  |.|..=@.e.i.U0...|
-00000230  bc 92 ae 14 85 18 ce 10  7e 0f 52 52 a4 c7 b7 1f  |........~.RR....|
-00000240  2d 3e 87 fc fb 93 eb 47  a3 e0 cc 4e 57 51 d0 59  |->.....G...NWQ.Y|
-00000250  05 84 dc 4d fd fb d1 11  33 b6 e5 5e df 65 d4 ed  |...M....3..^.e..|
-00000260  04 af 89 b3 f0 90 9b 7c  5e 83 b1 66 71 b1 16 03  |.......|^..fq...|
-00000270  03 00 35 5b 37 fa e1 97  11 25 7c fd da 7e e8 2a  |..5[7....%|..~.*|
-00000280  9b 28 fa 20 a6 9b 9b ca  99 ed a2 eb 5b 84 df a0  |.(. ........[...|
-00000290  b9 14 c2 fe 38 a8 54 06  e4 54 38 87 2a 24 8b 1e  |....8.T..T8.*$..|
-000002a0  3e ba 0a bb c2 1d a4 74  16 03 03 00 98 8b 39 c7  |>......t......9.|
-000002b0  ac e5 80 bf 49 95 ad f4  c0 cf c9 7c 86 bf 11 65  |....I......|...e|
-000002c0  53 40 f3 64 3e 04 ad c9  8d 33 8a 10 4a f5 2e c5  |S@.d>....3..J...|
-000002d0  22 18 59 1c 81 65 8a 51  47 b4 8d b1 94 57 3c f8  |".Y..e.QG....W<.|
-000002e0  d0 06 60 ce 04 f9 50 8f  6c 43 d8 6e b0 9e d9 da  |..`...P.lC.n....|
-000002f0  4b e5 b5 05 b7 1b 4b 46  59 d6 ad 20 bb 4c fc aa  |K.....KFY.. .L..|
-00000300  9a 9b ef fd 59 4b 2a 63  01 b0 1b 2d ed b1 f4 5b  |....YK*c...-...[|
-00000310  bb ca cd fa 13 06 06 7e  1d a5 cd c3 ca 4e bf 7b  |.......~.....N.{|
-00000320  7e 92 92 09 61 35 68 a2  38 f9 13 41 f4 a9 a5 0f  |~...a5h.8..A....|
-00000330  42 63 e4 15 e8 86 00 48  90 2b 43 30 da 05 b6 fc  |Bc.....H.+C0....|
-00000340  8e 7f 52 d3 b8 14 03 03  00 11 82 73 be a9 08 9d  |..R........s....|
-00000350  5b 2f fe bd 1f 2c fb e2  f3 94 f3 16 03 03 00 20  |[/...,......... |
-00000360  d0 47 0f 2d 7e ce 8f 01  e2 7d 01 3c 32 79 a0 26  |.G.-~....}.<2y.&|
-00000370  fe 00 ce d3 37 46 20 b4  f8 af 21 81 0f 1e ba 2d  |....7F ...!....-|
+00000000  16 03 03 02 69 ee f1 51  ac 2b 75 2a 6b 31 f9 25  |....i..Q.+u*k1.%|
+00000010  5a 00 97 42 02 d8 b8 e0  2a a6 0f c2 eb 89 75 42  |Z..B....*.....uB|
+00000020  4c 94 81 59 d0 26 4b e4  51 0a 77 ac bd bc 84 8e  |L..Y.&K.Q.w.....|
+00000030  fa 68 9c 1c 38 90 08 35  96 d2 7e e9 ef 8d 00 78  |.h..8..5..~....x|
+00000040  1e 30 cd 92 df 44 d8 89  fc e5 ce 65 43 65 be db  |.0...D.....eCe..|
+00000050  92 5e 56 0c 8e 86 cf 8f  62 4c 9a a2 ab 8b 0c f6  |.^V.....bL......|
+00000060  13 b4 57 76 fb c4 de b1  68 1c ca c1 23 3d 0d 6a  |..Wv....h...#=.j|
+00000070  be ab 0f 03 19 3a 8c 36  0a ed 1c 2b 59 7a b5 f2  |.....:.6...+Yz..|
+00000080  9c 29 0b e1 ab 74 ad b4  fc f9 ab 18 bf b0 3d 5e  |.)...t........=^|
+00000090  57 70 be 2f 57 7c cc cd  4b 0d e3 c7 d6 74 d8 ae  |Wp./W|..K....t..|
+000000a0  79 b1 f8 aa 28 b7 a4 c7  27 77 a0 20 69 81 f6 a2  |y...(...'w. i...|
+000000b0  76 bc 96 fd 2d 03 9c 97  21 5d ea 50 82 5a 6d 00  |v...-...!].P.Zm.|
+000000c0  7a 80 19 09 4b 4a 8c cc  f4 b4 74 62 60 b6 71 44  |z...KJ....tb`.qD|
+000000d0  d5 06 e0 79 45 cc 78 4a  ee 4c d6 bb 96 70 ac cb  |...yE.xJ.L...p..|
+000000e0  3e 94 d6 46 a3 96 15 4f  70 f0 1a 61 13 ec 6d 0d  |>..F...Op..a..m.|
+000000f0  be ce cd c7 ee 5e c8 ae  cf 1f f1 43 dd 29 21 8b  |.....^.....C.)!.|
+00000100  f1 f0 32 5a 4d 02 09 7f  c0 15 be 33 aa eb 55 97  |..2ZM......3..U.|
+00000110  ea 74 02 dd 74 22 40 b5  33 7d cf ca be 07 0d cb  |.t..t"@.3}......|
+00000120  82 a4 62 56 b1 68 f8 25  d7 1d 57 31 83 cc 7b e9  |..bV.h.%..W1..{.|
+00000130  8a 9f d5 b5 d1 99 da 4b  55 87 c2 d3 99 ea 34 3c  |.......KU.....4<|
+00000140  01 61 5e d4 f2 4a 40 b4  ff 4b eb 68 c7 5e a7 7b  |.a^..J@..K.h.^.{|
+00000150  cf d6 2d 99 ea 6d df a8  b3 74 d1 ad 22 22 81 ae  |..-..m...t..""..|
+00000160  58 a6 1b 87 cb 75 d7 2c  5b a6 4e 04 28 fb f7 6e  |X....u.,[.N.(..n|
+00000170  2a 52 c9 19 21 d8 3c ee  0c 8d 0c 55 d9 7a 1f 75  |*R..!.<....U.z.u|
+00000180  1e 14 4f c2 7c e3 a1 b7  bd 23 32 40 68 d7 9f d7  |..O.|....#2@h...|
+00000190  bc e4 57 62 d2 ba 95 3f  1a c0 2f cf 31 6b 41 e6  |..Wb...?../.1kA.|
+000001a0  92 91 91 6f 49 4b 42 fb  ae e2 82 c2 ac 5b 5d 0f  |...oIKB......[].|
+000001b0  f1 9f e7 18 9d 1d 35 f6  6f 51 d2 05 ed a2 ab 55  |......5.oQ.....U|
+000001c0  38 19 ec 37 ac f2 25 1d  6c 9e f7 30 87 98 03 96  |8..7..%.l..0....|
+000001d0  d6 ae dd 39 74 8f 39 c9  b8 5c aa b2 88 60 5d 96  |...9t.9..\...`].|
+000001e0  7e 3f fe 21 91 41 e1 e9  88 8c 63 20 dc 8d 60 7f  |~?.!.A....c ..`.|
+000001f0  29 36 bd 81 7f 90 48 47  e4 d1 c1 f6 07 06 4f 5d  |)6....HG......O]|
+00000200  2e fa ba e7 8c 57 0d f7  82 80 31 68 a3 78 f9 73  |.....W....1h.x.s|
+00000210  2d 31 0a 76 b1 08 5e 28  af 97 e9 4f 00 b3 eb 99  |-1.v..^(...O....|
+00000220  81 0a 2f 64 53 24 63 eb  16 10 67 97 77 e4 52 98  |../dS$c...g.w.R.|
+00000230  13 d2 bb a5 26 6a 4a c9  6d 9a f7 4c 99 af 05 3b  |....&jJ.m..L...;|
+00000240  da 91 d0 1e bf bc e7 49  90 1e 9f 56 03 38 77 28  |.......I...V.8w(|
+00000250  a2 78 ca 38 51 ec a4 96  70 f2 23 24 ef d2 5e 70  |.x.8Q...p.#$..^p|
+00000260  d0 12 d8 f7 75 64 66 be  f9 30 40 13 30 ca 16 03  |....udf..0@.0...|
+00000270  03 00 35 2e 74 d1 77 b1  56 b9 b6 33 07 39 6d 6b  |..5.t.w.V..3.9mk|
+00000280  c9 c0 9e b1 35 5b 1c 5e  8b c7 15 b8 12 90 3f 62  |....5[.^......?b|
+00000290  01 4a bd 93 2e 5d 0b 6f  9a 33 f3 0f f3 ce 8b 6e  |.J...].o.3.....n|
+000002a0  a2 fb 81 8b 69 9a 3b db  16 03 03 00 98 70 68 40  |....i.;......ph@|
+000002b0  c3 43 46 fc 9b 8a 1d 3f  e2 00 0e e3 a5 a1 d3 b3  |.CF....?........|
+000002c0  4e 99 01 15 d1 91 6c be  4d 05 17 f9 67 14 f5 03  |N.....l.M...g...|
+000002d0  86 f0 f3 c1 b4 74 8d dc  d5 74 d7 b1 f3 f7 5c b1  |.....t...t....\.|
+000002e0  12 20 5e 64 aa e5 fa b4  d5 dd 34 29 42 a4 4e 46  |. ^d......4)B.NF|
+000002f0  9a e0 98 a7 9a 6c c1 b0  bc d7 4d b9 a8 1c 8d 51  |.....l....M....Q|
+00000300  5b 11 bd a3 a9 1c d7 c7  d2 c7 e1 04 a0 6c be a0  |[............l..|
+00000310  74 81 e1 9f f3 a6 ac dc  e6 ac 76 46 03 28 d3 b1  |t.........vF.(..|
+00000320  ab a9 77 b0 84 f2 61 ff  39 a0 e5 09 a0 ad fa 41  |..w...a.9......A|
+00000330  a9 09 4d fb 3f 46 11 73  71 cd 80 1b 1f 5a 43 c9  |..M.?F.sq....ZC.|
+00000340  b0 b0 df 4a 03 14 03 03  00 11 d1 98 c3 73 d0 be  |...J.........s..|
+00000350  45 ea 73 e7 71 1c 78 97  4a b9 05 16 03 03 00 20  |E.s.q.x.J...... |
+00000360  5e e3 1f 19 aa 89 11 71  09 fb 4c f4 36 d4 3a 4b  |^......q..L.6.:K|
+00000370  3e 89 3c 78 99 1a 63 7b  45 22 55 39 74 7f d6 5f  |>.<x..c{E"U9t.._|
 >>> Flow 10 (server to client)
-00000000  14 03 03 00 11 53 7f 72  ce 10 f4 0e a3 ed ed 8d  |.....S.r........|
-00000010  3a ad 2d 57 c8 e1 16 03  03 00 20 11 e9 69 5e ff  |:.-W...... ..i^.|
-00000020  22 0d f6 a3 e1 e5 3f 14  34 a0 33 d7 d5 0a 7f bc  |".....?.4.3.....|
-00000030  7c 69 9b 9a d2 aa 41 87  fe da de 17 03 03 00 19  ||i....A.........|
-00000040  bd a1 83 5d 27 9f cc 0b  40 02 23 6e 6f 18 4c bc  |...]'...@.#no.L.|
-00000050  48 c4 02 7d 45 08 71 ac  d7                       |H..}E.q..|
+00000000  14 03 03 00 11 f4 04 c6  5c 08 6d 53 9b 6e 59 7f  |........\.mS.nY.|
+00000010  75 c7 d9 a9 95 24 16 03  03 00 20 f3 82 ea ea a8  |u....$.... .....|
+00000020  ee 3f 83 7f f4 1e 31 d8  66 32 b7 d9 46 13 ac b5  |.?....1.f2..F...|
+00000030  cc b0 e6 ac 06 4f 65 3b  2e 57 f6 17 03 03 00 19  |.....Oe;.W......|
+00000040  c7 c9 1c 1c 64 a0 c0 90  03 96 5e 94 60 79 f0 85  |....d.....^.`y..|
+00000050  e7 41 db ca 6e 21 5a dd  2a                       |.A..n!Z.*|
 >>> Flow 11 (client to server)
-00000000  15 03 03 00 12 80 ae fb  45 cb a1 2d 1f c8 b6 02  |........E..-....|
-00000010  3a 28 62 d6 13 48 2c                              |:(b..H,|
+00000000  15 03 03 00 12 7a a9 2e  4b 21 84 78 cb 46 52 f3  |.....z..K!.x.FR.|
+00000010  f9 8e 75 3b 7e 77 a1                              |..u;~w.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice
index 7ff58763c5..1c7fadb2cd 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 25 9f b0 d0 c5  |....]...Y..%....|
-00000010  56 c8 79 6a 1a ff 0e e9  8b 41 b6 be c7 36 0b 58  |V.yj.....A...6.X|
-00000020  c0 9e 9d 6c 4c b4 39 1f  95 ff 8f 20 32 27 d2 39  |...lL.9.... 2'.9|
-00000030  ac f6 33 f9 48 a4 0b 0f  e1 f9 5f 0a 83 7b 75 95  |..3.H....._..{u.|
-00000040  23 55 14 ba 55 2f 47 42  e8 df 09 39 cc a8 00 00  |#U..U/GB...9....|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 c5 11 e0 7f 6f  |....]...Y......o|
+00000010  86 2d f5 8f c2 ba 8b a7  1e 15 94 51 e1 d0 ab 40  |.-.........Q...@|
+00000020  37 5b 68 a7 ee 6f de ae  d2 4b b2 20 a8 02 85 68  |7[h..o...K. ...h|
+00000030  2c 18 6b 1a 6c ba 64 81  8a 0f 72 a6 a3 3a 1a ee  |,.k.l.d...r..:..|
+00000040  6a 9a d6 9a ce 03 78 11  11 b6 fa 7a cc a8 00 00  |j.....x....z....|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -61,286 +63,290 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 2b 66 1d  |............ +f.|
-000002d0  80 f2 60 32 0f af 6f d3  03 db 28 c1 33 18 1c 5d  |..`2..o...(.3..]|
-000002e0  71 fd 2a 24 f9 3c 4d 76  ca e3 93 8d 25 08 04 00  |q.*$.<Mv....%...|
-000002f0  80 23 e3 34 5f 28 df b8  c9 fd 39 35 a9 bb 14 f9  |.#.4_(....95....|
-00000300  05 77 09 6f 2f e5 91 07  c3 6f cd 57 2a de 7e 93  |.w.o/....o.W*.~.|
-00000310  b8 9c 49 09 eb 81 45 d8  6a ff df da 06 e3 26 55  |..I...E.j.....&U|
-00000320  36 7e c9 4c 7b 6e 23 13  81 24 b2 a7 6c f6 f3 fc  |6~.L{n#..$..l...|
-00000330  ca 76 96 aa 4b d2 b9 d4  d7 c2 b0 be 2d 36 1b 0e  |.v..K.......-6..|
-00000340  bd ea 84 7e c8 ec 0c 0d  8f 88 91 f2 26 56 38 42  |...~........&V8B|
-00000350  67 ae f4 89 c0 63 9e ef  ef 59 71 86 20 0a 22 67  |g....c...Yq. ."g|
-00000360  a5 c5 44 d6 51 d1 14 fc  62 73 df ed e1 f0 7e 10  |..D.Q...bs....~.|
-00000370  81 16 03 03 00 04 0e 00  00 00                    |..........|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 42 e7 5a  |............ B.Z|
+000002d0  6b 3f 36 51 1f 06 45 c8  de 17 f8 19 9c a2 cb bb  |k?6Q..E.........|
+000002e0  89 52 59 e0 1a d5 c4 1e  42 0c 9b 93 14 08 04 00  |.RY.....B.......|
+000002f0  80 cb 39 db 19 17 fd 12  ec 25 87 ce d2 76 8c c7  |..9......%...v..|
+00000300  aa 30 e3 50 0c 22 a6 73  d0 e5 b0 b6 b6 3c 5a ab  |.0.P.".s.....<Z.|
+00000310  11 97 35 e6 ff de d4 19  46 20 5f 78 33 1c c4 24  |..5.....F _x3..$|
+00000320  48 2d 6a c0 f4 07 d4 5c  8b b6 a3 8c eb 99 e9 70  |H-j....\.......p|
+00000330  d8 46 43 00 3b 1c 4e 37  52 c8 92 57 21 ee c7 af  |.FC.;.N7R..W!...|
+00000340  f0 19 8b 2b f8 c0 e3 1a  79 13 17 fb 14 ed 5c 82  |...+....y.....\.|
+00000350  a9 77 05 b3 3d 25 92 07  3f f5 38 6d dc 86 ce 44  |.w..=%..?.8m...D|
+00000360  3c b7 72 da aa 0c 78 b8  22 bf ef af cf d4 81 bc  |<.r...x.".......|
+00000370  11 16 03 03 00 04 0e 00  00 00                    |..........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 7b de 6f  c8 b7 f1 69 89 0b 29 af  |.... {.o...i..).|
-00000040  62 1b 92 47 e9 44 f7 26  91 93 9c 3b e2 77 0e d0  |b..G.D.&...;.w..|
-00000050  c5 af fd e5 59                                    |....Y|
+00000030  16 03 03 00 20 c0 2e 41  33 99 c3 00 90 54 c8 ea  |.... ..A3....T..|
+00000040  64 b2 f5 74 5d 3c b8 eb  0c 6e 12 bb 96 01 13 46  |d..t]<...n.....F|
+00000050  1f 7d e9 3a 15                                    |.}.:.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 94 da e2 2e f3  |.......... .....|
-00000010  65 59 31 4f 58 42 57 b5  1f e6 c1 5a c6 07 97 12  |eY1OXBW....Z....|
-00000020  f6 6c 20 cc 91 50 76 42  70 dd 2c                 |.l ..PvBp.,|
+00000000  14 03 03 00 01 01 16 03  03 00 20 50 98 09 8a ad  |.......... P....|
+00000010  b9 ba cb d8 d2 5c a8 69  86 da 30 da 39 ed 3b db  |.....\.i..0.9.;.|
+00000020  5c eb 34 08 4c ca 51 b2  63 0e 08                 |\.4.L.Q.c..|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 fe 0d 78  61 f9 fe 65 3c 42 c0 98  |.......xa..e<B..|
-00000010  82 8b 4c b0 48 9b 1d 48  66 c0 13                 |..L.H..Hf..|
+00000000  17 03 03 00 16 62 a6 a2  7c 1a 5e 4b 4e 58 86 12  |.....b..|.^KNX..|
+00000010  35 8b 6e d9 00 b0 f2 31  46 e6 2a                 |5.n....1F.*|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 14 e0 bb 6e  cc 69 fc a7 02 46 c4 5e  |.......n.i...F.^|
-00000010  a5 b1 1e ce e9 c7 7a d9  76                       |......z.v|
+00000000  16 03 03 00 14 b0 3a a3  b6 16 b7 9f 65 f8 7f 64  |......:.....e..d|
+00000010  8d 4c 73 1f 41 1b b0 5c  65                       |.Ls.A..\e|
 >>> Flow 7 (client to server)
-00000000  16 03 03 01 1a a7 03 1c  ef 27 0a 04 9b 31 b0 c6  |.........'...1..|
-00000010  17 00 1f 6c d5 91 ae 7c  77 87 98 05 67 9a ea ea  |...l...|w...g...|
-00000020  6c 79 28 da 2c 91 6d a0  c6 9a e9 f3 85 a0 7f 7d  |ly(.,.m........}|
-00000030  ae 89 ac 0d 01 7f d8 34  dd fb ba c3 d8 ba ff 9b  |.......4........|
-00000040  75 dc d6 5e 8a fa ad 9c  ea fa 15 63 55 85 98 26  |u..^.......cU..&|
-00000050  65 7a 19 17 c4 99 98 85  83 c4 06 39 30 d5 63 51  |ez.........90.cQ|
-00000060  ff 22 e8 cd 55 6e fc 88  5e d5 54 24 79 52 7e b0  |."..Un..^.T$yR~.|
-00000070  71 e4 e6 cb a6 06 24 14  1a c2 a8 52 85 e9 fc e4  |q.....$....R....|
-00000080  66 47 9c 9c d1 f3 56 11  47 16 4b 7c a5 f1 81 1e  |fG....V.G.K|....|
-00000090  00 78 98 8f 70 ae 47 6d  45 3b c4 af fc 88 bd 88  |.x..p.GmE;......|
-000000a0  7b cc 8a 78 86 ff 86 25  2d 21 28 f2 c5 d7 4b 61  |{..x...%-!(...Ka|
-000000b0  c0 ea 67 38 4c d0 d6 6f  fc a0 69 62 98 6f ac 29  |..g8L..o..ib.o.)|
-000000c0  29 13 34 7a f0 2d 1b 7e  52 42 6f f1 64 ed 7f 47  |).4z.-.~RBo.d..G|
-000000d0  69 82 9b 9d 19 7b 3a c5  54 51 c8 8f 4c 9e 42 a7  |i....{:.TQ..L.B.|
-000000e0  0f 9e 05 1d 4f 85 11 05  97 42 fa 24 37 1c 4e ec  |....O....B.$7.N.|
-000000f0  55 dc e1 4e f6 e2 dd c6  63 b0 dd 60 11 93 23 8a  |U..N....c..`..#.|
-00000100  eb 68 76 21 ec 19 cf 59  c8 78 80 f0 fa 39 6a 09  |.hv!...Y.x...9j.|
-00000110  f8 7f 9d c0 e7 51 3d 75  17 e3 cf a5 bf 1c 10     |.....Q=u.......|
+00000000  16 03 03 01 38 a3 ce 00  8f a3 63 85 d9 cd 78 93  |....8.....c...x.|
+00000010  55 94 fc 68 84 5c fc c5  a3 c3 d1 cc 09 83 e0 a0  |U..h.\..........|
+00000020  b2 b7 d4 10 6f aa 32 99  a5 53 e0 c0 ae 8c 6a e2  |....o.2..S....j.|
+00000030  90 8f 46 ac 71 ce 4e 4f  0a 29 cd 70 ed 8a cc 1e  |..F.q.NO.).p....|
+00000040  53 de d1 75 72 a2 06 36  28 6e fd d0 60 00 ff c6  |S..ur..6(n..`...|
+00000050  a8 18 1e f8 1c 1a 7d e9  d8 16 36 a4 42 d5 59 ad  |......}...6.B.Y.|
+00000060  d9 01 45 e4 03 8b c8 f3  b7 2f 0f 77 62 69 ad 35  |..E....../.wbi.5|
+00000070  16 ef 99 94 7f af 7c f5  44 19 99 65 97 d3 15 af  |......|.D..e....|
+00000080  82 06 1d 80 ab 55 51 70  c7 23 15 5b 00 fb 93 e6  |.....UQp.#.[....|
+00000090  5e 06 c9 db 87 98 af 0b  38 68 5f 0a 06 35 2b bd  |^.......8h_..5+.|
+000000a0  15 04 57 e6 1c 70 35 b3  2a 16 c7 f6 7e 3b bf d7  |..W..p5.*...~;..|
+000000b0  3f f6 35 bd a9 cc 6d aa  75 b4 16 6d 81 0e 34 ab  |?.5...m.u..m..4.|
+000000c0  2e de e7 4a 2e 13 69 c5  c2 e2 2d 38 e6 3f 8a f4  |...J..i...-8.?..|
+000000d0  d5 6a a2 9d 28 a7 98 30  e3 9a 8a 86 15 e6 00 45  |.j..(..0.......E|
+000000e0  63 43 1d 28 b0 24 39 06  5e cb cb eb a1 cc 75 f3  |cC.(.$9.^.....u.|
+000000f0  18 e4 d0 e6 49 0b 00 5d  67 18 35 52 b4 fa ec 9a  |....I..]g.5R....|
+00000100  6a 26 1b f8 38 ef f4 be  30 ef af bb bb 3f 28 a2  |j&..8...0....?(.|
+00000110  0e 17 48 a6 3c d1 73 a7  45 12 4e 7e b2 87 e2 4a  |..H.<.s.E.N~...J|
+00000120  92 6e 26 3a f5 17 08 87  7b 34 bc 11 36 51 5f 0b  |.n&:....{4..6Q_.|
+00000130  e4 05 a9 b7 a5 bd 51 fa  77 e3 72 31 84           |......Q.w.r1.|
 >>> Flow 8 (server to client)
-00000000  16 03 03 00 85 14 4e 8e  de d0 5b 59 2d f6 a3 b0  |......N...[Y-...|
-00000010  c0 ff 4a ff 8b cf af 2f  09 f1 ee 03 0f b9 70 5e  |..J..../......p^|
-00000020  1b e4 ef b4 3e e7 c1 43  fb ea a8 68 4c 66 0a 55  |....>..C...hLf.U|
-00000030  e8 51 a6 30 bb e3 f5 0e  df 11 f2 e0 51 94 14 f6  |.Q.0........Q...|
-00000040  1e c6 e8 9d 10 a2 20 9f  f2 f6 1e f0 3c f3 ba ff  |...... .....<...|
-00000050  65 d1 f4 df 9e e6 18 9f  a1 a5 9c 5f 4b 4f 20 98  |e.........._KO .|
-00000060  4a f6 0b 95 da 01 1f ea  c0 c4 39 39 8b fd 19 40  |J.........99...@|
-00000070  8d 14 da 45 fd 51 3d a7  36 23 a0 b2 bb cb 81 6b  |...E.Q=.6#.....k|
-00000080  79 0a 02 71 50 84 ac d6  7b ad 16 03 03 02 69 b8  |y..qP...{.....i.|
-00000090  a9 6c 87 d7 23 6b c6 1a  4c 08 dd fa 58 e8 e8 d5  |.l..#k..L...X...|
-000000a0  44 16 3b de 77 60 33 2a  47 a5 3c e0 cb c3 1a 38  |D.;.w`3*G.<....8|
-000000b0  1d 1f 69 8e 33 a3 ba ac  55 b5 77 9b e1 fc a4 21  |..i.3...U.w....!|
-000000c0  99 90 01 5e 99 36 a3 cf  74 b4 1f 96 b7 96 1e 4b  |...^.6..t......K|
-000000d0  cf 0b 92 5f 6b 1f 1c b0  70 80 2e 87 57 ef 52 b0  |..._k...p...W.R.|
-000000e0  2b 7d 66 06 cb a1 78 a7  5a e2 af 4c fc a4 8b 99  |+}f...x.Z..L....|
-000000f0  af 6c 6d 0e 07 7e da 11  5a b7 89 af 3c ce 1e 22  |.lm..~..Z...<.."|
-00000100  1f 7d 97 d5 d4 78 09 c4  e7 fb 33 bf 36 ee 6e 5a  |.}...x....3.6.nZ|
-00000110  af f0 5b 0f 00 eb cc 3d  76 35 41 98 4c 65 81 34  |..[....=v5A.Le.4|
-00000120  74 d9 d7 ba 04 fc c8 c6  c9 ca 4b b0 8e b1 7e 87  |t.........K...~.|
-00000130  9d 69 2e d5 68 54 96 48  37 42 ae ff 18 d0 08 b2  |.i..hT.H7B......|
-00000140  dc 26 1c c1 99 f1 c3 02  3f 48 51 a8 92 10 18 01  |.&......?HQ.....|
-00000150  f3 3b 96 4b de 80 29 27  87 da f4 89 23 1b 49 b8  |.;.K..)'....#.I.|
-00000160  5b f5 50 ec 99 b0 c3 48  e2 d3 fe fb a0 95 c3 c6  |[.P....H........|
-00000170  83 fe d9 87 ef 0c cf 67  8f e7 52 3d 17 7d c0 ab  |.......g..R=.}..|
-00000180  02 1a 33 78 c8 d6 13 8b  8e 82 be 0d 5e d4 22 e8  |..3x........^.".|
-00000190  63 c3 84 a9 05 12 d3 b7  e2 36 96 a2 22 0a 77 df  |c........6..".w.|
-000001a0  20 06 5c 0d 8b c1 d6 ac  73 b0 b2 a0 be db 59 17  | .\.....s.....Y.|
-000001b0  05 60 68 b9 18 85 d5 73  9b c9 41 b9 c1 f2 02 47  |.`h....s..A....G|
-000001c0  ca 95 c8 47 e2 de 04 75  08 d4 b7 a2 41 d7 e2 6b  |...G...u....A..k|
-000001d0  ad 8c ba c5 fc f8 b1 fe  d3 23 c0 22 ec d0 2f a7  |.........#."../.|
-000001e0  d9 ed 0e da 71 18 c0 d0  1f 40 8d eb 79 ea 5f aa  |....q....@..y._.|
-000001f0  07 4f 65 81 c1 9e ea 36  7f 0d 8b 07 8b 71 81 5a  |.Oe....6.....q.Z|
-00000200  0e cb d4 0f 98 c8 5c 69  d0 61 6e b5 ef 2a dd 5f  |......\i.an..*._|
-00000210  63 92 b4 3e 6e f4 b8 fc  45 bf 58 79 08 a4 95 6f  |c..>n...E.Xy...o|
-00000220  34 01 9b 8a 19 a5 e4 11  3f d4 97 47 66 e8 42 ef  |4.......?..Gf.B.|
-00000230  92 72 01 f4 6f 07 a4 35  81 83 ee 26 d0 96 cc de  |.r..o..5...&....|
-00000240  42 2a 65 64 cc a9 0c 39  31 d5 7c 2f 42 e5 ce 36  |B*ed...91.|/B..6|
-00000250  0b bf b5 22 2a 4f 3c 56  27 29 cd fb 8e 9f 8f ab  |..."*O<V')......|
-00000260  f0 14 46 17 26 93 11 16  72 cf ab a1 66 1c 63 2e  |..F.&...r...f.c.|
-00000270  ea f8 f3 ac 84 eb 00 f0  b0 81 e7 ec f6 26 7d c0  |.............&}.|
-00000280  59 a9 cf 7b a5 2e ca 73  b1 df 48 b4 92 31 ad 15  |Y..{...s..H..1..|
-00000290  d3 7b d0 65 26 d8 2c 8c  06 62 a2 f3 fb a3 2e b6  |.{.e&.,..b......|
-000002a0  e6 0d 44 a5 7a 51 02 c5  04 16 fe 6e e0 14 96 6e  |..D.zQ.....n...n|
-000002b0  88 c4 ac 00 ac 23 bb 00  c9 a3 26 88 52 18 60 80  |.....#....&.R.`.|
-000002c0  9a 49 38 67 5a 64 cc d0  bd 28 da f1 ee bb 6a c0  |.I8gZd...(....j.|
-000002d0  91 10 5e 40 c1 e8 77 88  7c b0 46 22 b2 64 8f c5  |..^@..w.|.F".d..|
-000002e0  c6 bd 14 4d 1f 9e 2d a6  18 72 51 38 fb 7b 06 11  |...M..-..rQ8.{..|
-000002f0  9d 9b 65 f0 eb 87 ff f9  16 03 03 00 bc cf 68 7a  |..e...........hz|
-00000300  7d df a0 b7 38 40 7a 7d  68 cc 94 5d 34 9e 4c ca  |}...8@z}h..]4.L.|
-00000310  c3 7d 66 81 16 77 a7 e3  4e ef 66 fd f6 8c 67 f9  |.}f..w..N.f...g.|
-00000320  ae f2 92 61 3a 75 74 9f  60 b7 9a 2c 98 98 58 83  |...a:ut.`..,..X.|
-00000330  28 16 23 de ad ff 2b cd  e6 4e 5a 98 87 f1 8a 1c  |(.#...+..NZ.....|
-00000340  66 79 18 bc 70 a6 84 a1  90 e0 8a c3 1d e8 63 9f  |fy..p.........c.|
-00000350  71 7f 4a 5f 4e c2 e5 70  68 21 e4 31 54 c3 81 2a  |q.J_N..ph!.1T..*|
-00000360  6f c0 84 7a 98 1d f1 61  e5 71 35 ce 7d fd ad fa  |o..z...a.q5.}...|
-00000370  57 1a 1e 4b 46 7b 56 82  52 5e e1 73 1b 8a f1 fd  |W..KF{V.R^.s....|
-00000380  c9 65 a5 b6 73 1f 07 48  58 f8 d6 cb 8a ab 18 b9  |.e..s..HX.......|
-00000390  94 f5 53 7a dc a5 13 9b  ef 9a b9 31 42 60 74 02  |..Sz.......1B`t.|
-000003a0  ae 73 52 af 18 f3 52 c0  63 b3 1e 50 1c f2 1c 50  |.sR...R.c..P...P|
-000003b0  73 ea fe 13 e2 61 c1 38  05 16 03 03 00 4a 82 ab  |s....a.8.....J..|
-000003c0  72 1f 06 41 41 a7 4e 41  ab ae 2b b4 af 45 a9 11  |r..AA.NA..+..E..|
-000003d0  a4 aa d4 2e 19 82 dc 08  dc 9a 4e ae d0 7f 35 8b  |..........N...5.|
-000003e0  bc 75 59 eb 95 eb 13 10  d1 f7 25 cc b9 28 d0 fe  |.uY.......%..(..|
-000003f0  4c 63 fd 8e 7c fc 1e 2f  db 92 57 d6 18 44 2c ab  |Lc..|../..W..D,.|
-00000400  ec a5 a7 ae 1a 13 90 45  16 03 03 00 14 76 66 ce  |.......E.....vf.|
-00000410  a0 ba 5b 1b b2 2e c6 06  66 dd 89 95 7d 85 8d 81  |..[.....f...}...|
-00000420  0c                                                |.|
+00000000  16 03 03 00 85 5d 34 8c  78 d1 0e 67 b7 5c ee 45  |.....]4.x..g.\.E|
+00000010  ec f6 47 3c 67 11 2e 53  a5 a4 54 d2 25 80 88 bf  |..G<g..S..T.%...|
+00000020  41 89 8f 8f 2d a2 42 48  d7 3c 27 0f f8 45 6b 17  |A...-.BH.<'..Ek.|
+00000030  1a f7 dd 9d 1a aa 92 46  79 1c 24 01 ff 8e c3 17  |.......Fy.$.....|
+00000040  84 07 49 8c 62 8d ca 26  57 40 55 b4 1d 88 98 99  |..I.b..&W@U.....|
+00000050  57 dd e5 23 ab 8e 51 37  4b 57 4e 6e 99 0b a3 18  |W..#..Q7KWNn....|
+00000060  74 ed c5 2d 06 e6 4c e8  65 c0 96 44 44 ce ec 3c  |t..-..L.e..DD..<|
+00000070  7c ef ad c2 08 6b 9f 0f  13 03 1e 66 db 99 07 74  ||....k.....f...t|
+00000080  8b ae cd 6d 78 bd 93 25  76 8a 16 03 03 02 69 8d  |...mx..%v.....i.|
+00000090  e5 8b e8 c8 93 2e f7 70  46 e2 1f cc d5 02 65 7c  |.......pF.....e||
+000000a0  e5 b3 09 7c ea ef 81 b5  a9 f6 52 ab e5 6c f1 ee  |...|......R..l..|
+000000b0  e4 b6 f9 d0 be 7e 47 fe  f7 65 d0 e8 39 4e 99 d9  |.....~G..e..9N..|
+000000c0  4a 00 80 4d ca cb 8b 32  58 d4 63 64 e5 fe f4 1b  |J..M...2X.cd....|
+000000d0  24 c0 00 ea 10 d3 19 04  a7 7a a3 37 79 04 17 6d  |$........z.7y..m|
+000000e0  d3 35 df 6a 0e dc 26 4e  59 48 7e 56 b8 ca e4 57  |.5.j..&NYH~V...W|
+000000f0  ae 66 c9 37 54 e4 a8 0e  2a b5 e5 be 7f ed 35 80  |.f.7T...*.....5.|
+00000100  12 eb 2d 3c d1 04 0c c1  9e ef 0d 60 2e 1c 94 94  |..-<.......`....|
+00000110  b2 39 46 dd 83 22 5a 09  b5 ef 66 6d 8f 2b 32 ca  |.9F.."Z...fm.+2.|
+00000120  b9 28 08 d4 a6 36 6b 62  5c 64 c6 e5 2b 61 13 81  |.(...6kb\d..+a..|
+00000130  50 e5 56 9d d2 ab 3f 7d  ea 1b 4c d3 ff b0 ed 95  |P.V...?}..L.....|
+00000140  20 62 58 ba af 27 51 b4  91 24 37 d7 ac a8 c7 21  | bX..'Q..$7....!|
+00000150  20 54 71 d2 00 d3 39 8a  c1 c4 c7 17 87 21 9d 45  | Tq...9......!.E|
+00000160  36 22 da 4b 89 9e 8b ae  bd 8f c5 94 ee 80 4f 55  |6".K..........OU|
+00000170  6b 43 06 c7 ad 89 50 a9  64 2e de 68 df bc 21 d9  |kC....P.d..h..!.|
+00000180  28 d6 cf 3d e5 94 77 9f  8b 96 f0 fc b6 31 1f 7c  |(..=..w......1.||
+00000190  f8 85 9f 8a 2f 92 7a 52  5b 1c 42 77 87 2e 1b 0a  |..../.zR[.Bw....|
+000001a0  1d 6b a6 09 15 96 77 b0  c1 47 ee b4 54 60 df 2a  |.k....w..G..T`.*|
+000001b0  c7 86 85 c5 3a ee c9 e2  cd b8 99 fc 9d 30 9f a6  |....:........0..|
+000001c0  eb 6c ef 25 18 4c 58 11  45 1f 14 be 4f 2c a7 ed  |.l.%.LX.E...O,..|
+000001d0  71 e8 c2 70 3d e8 b6 55  3f a6 52 44 fd d1 6c 13  |q..p=..U?.RD..l.|
+000001e0  32 df e9 c2 ea 42 1b 69  ce 9d 79 77 b1 a3 f8 a2  |2....B.i..yw....|
+000001f0  ee 28 c2 bc 0e 99 86 fd  d2 e7 f7 2a 14 1c ea a7  |.(.........*....|
+00000200  3a 26 dd 23 4b 48 44 55  ac ea 5e 0e 12 18 49 7a  |:&.#KHDU..^...Iz|
+00000210  56 bc c0 2e 8a 5c 96 83  8d e7 ad c3 25 b2 dd d1  |V....\......%...|
+00000220  2c d3 f7 16 61 78 26 50  f5 69 34 e4 07 3a 0f c6  |,...ax&P.i4..:..|
+00000230  26 fb be e2 a9 b0 76 a2  67 ed 65 75 89 c8 c6 a9  |&.....v.g.eu....|
+00000240  80 8e c6 96 b6 18 61 9e  e9 2e 51 cb 8b 3d 7c db  |......a...Q..=|.|
+00000250  2a a0 5b d6 21 e8 ef a8  83 dc 1a 79 98 18 6d b5  |*.[.!......y..m.|
+00000260  8a b1 7c 6b 4e 8a ad 13  11 94 74 e8 b5 be 1d 74  |..|kN.....t....t|
+00000270  ce 13 b6 1a c4 83 cc fa  ed ec 1e a2 e8 78 2f ac  |.............x/.|
+00000280  b9 51 c7 8e d7 f4 16 e7  31 63 95 cd 79 fc a3 42  |.Q......1c..y..B|
+00000290  99 c4 a7 26 14 6a 0d c3  26 e0 08 bd 21 c8 b8 56  |...&.j..&...!..V|
+000002a0  3e 0e 98 42 76 3d e6 82  51 6c 6a a1 78 c0 c5 9a  |>..Bv=..Qlj.x...|
+000002b0  70 1b 9e 70 63 e3 e6 c4  9a ed c9 1e 9f 95 dd e2  |p..pc...........|
+000002c0  8e b9 12 7d 7a d1 3b 49  df 4c cc ba b4 2d 91 34  |...}z.;I.L...-.4|
+000002d0  f8 05 1e d1 66 39 49 99  49 18 45 da 24 65 bb f8  |....f9I.I.E.$e..|
+000002e0  d0 40 87 6d 5b 5a 2a 41  40 f0 98 07 3c 1a 9e 81  |.@.m[Z*A@...<...|
+000002f0  8f 5d 44 80 10 0b bb f4  16 03 03 00 bc 8a 5e 4c  |.]D...........^L|
+00000300  7b 86 c6 d6 f1 fa ba 03  2d 16 75 46 6a 72 b9 98  |{.......-.uFjr..|
+00000310  11 75 b5 34 96 6a f9 61  7a b4 47 2d 67 b8 ab 1f  |.u.4.j.az.G-g...|
+00000320  69 60 1f 28 ff 3d 03 61  62 22 7a 35 73 e7 0e 15  |i`.(.=.ab"z5s...|
+00000330  f5 e9 64 a6 8b dc e3 f4  fe 7b 53 82 48 6f df fb  |..d......{S.Ho..|
+00000340  69 b8 c3 4c a9 dc 87 8b  46 99 1f ef ae 6a 40 56  |i..L....F....j@V|
+00000350  81 fd e9 1d 8c 8d 12 c0  07 77 fa e3 e2 cd 48 33  |.........w....H3|
+00000360  de b9 db 09 0d d4 eb cc  a5 9e 43 75 b6 45 09 c2  |..........Cu.E..|
+00000370  08 ff cc fa c6 3b 97 da  85 9a c4 9f 56 03 ed b8  |.....;......V...|
+00000380  a5 98 ec b3 b8 d4 39 b5  07 32 b4 f6 70 1f 9f 1d  |......9..2..p...|
+00000390  6e 0e fc 22 6d 1d 29 b7  d7 83 f3 2e 1a 8e d0 77  |n.."m.)........w|
+000003a0  e9 82 4f 21 94 0d e6 39  f4 4f 57 74 0e a6 0d a3  |..O!...9.OWt....|
+000003b0  bf ee 24 ac 3e be f6 46  bb 16 03 03 00 4a 0a eb  |..$.>..F.....J..|
+000003c0  93 1a d4 ab 57 53 2c 5c  40 f1 f8 2f 6c 93 f3 2a  |....WS,\@../l..*|
+000003d0  6d a0 19 d4 d3 92 1a b0  ae 2d 15 9c 63 21 0f 06  |m........-..c!..|
+000003e0  8b ef 7c a4 a6 dc d8 6c  63 ec 24 ce ce ce 55 fa  |..|....lc.$...U.|
+000003f0  de 31 53 2b df 27 4c 20  60 97 f2 62 86 33 97 b2  |.1S+.'L `..b.3..|
+00000400  69 d0 aa 44 3f 1f 02 d5  16 03 03 00 14 0b e0 0c  |i..D?...........|
+00000410  7b 88 84 70 49 7a e4 80  7a 85 90 76 cc aa 0b 42  |{..pIz..z..v...B|
+00000420  6b                                                |k|
 >>> Flow 9 (client to server)
-00000000  16 03 03 02 69 8a dc ce  d1 c0 85 30 95 6c da 57  |....i......0.l.W|
-00000010  23 05 39 c1 4c 20 08 25  a2 96 f1 55 a1 77 3b 42  |#.9.L .%...U.w;B|
-00000020  9f 3d 69 9b 56 49 b4 94  8a 3c d5 85 43 f1 b4 4b  |.=i.VI...<..C..K|
-00000030  cd e0 67 95 83 34 90 89  81 f0 18 87 28 c0 42 88  |..g..4......(.B.|
-00000040  b0 1c d1 cc 0a f0 bb 67  91 55 0b e4 ed 22 52 09  |.......g.U..."R.|
-00000050  92 0b 56 ac d0 3f c9 41  05 8a 19 7d e7 9a d7 ff  |..V..?.A...}....|
-00000060  fa 85 f5 23 b0 98 a0 79  b1 8e 0f 90 0e c8 32 92  |...#...y......2.|
-00000070  4b 6a 37 47 45 31 70 be  8b cd 7a 26 3a 3c 0b 63  |Kj7GE1p...z&:<.c|
-00000080  a7 8c 00 2c 1d be eb 5c  1f 16 90 76 2b d7 82 5e  |...,...\...v+..^|
-00000090  31 93 40 7a e0 9a e0 4c  7d 2e e3 84 0f cb 06 7d  |1.@z...L}......}|
-000000a0  8d 76 41 ea 27 52 4a 77  e5 91 02 ab 11 cc 8c f0  |.vA.'RJw........|
-000000b0  fe 8e ee b2 f1 ba 1e ab  0d 5c e2 2d da d5 8d f9  |.........\.-....|
-000000c0  7c 22 32 e9 50 1d 88 db  af c0 82 51 e0 31 14 71  ||"2.P......Q.1.q|
-000000d0  ad c9 05 5d 8e 2b 75 4b  9e 74 b0 3a a9 e4 7c 82  |...].+uK.t.:..|.|
-000000e0  ac 75 39 31 0a dc dc 0a  5c f4 ee 55 f2 09 c2 d2  |.u91....\..U....|
-000000f0  81 c8 70 2e 8f 37 6b 90  79 5c 18 6e 38 21 c6 00  |..p..7k.y\.n8!..|
-00000100  08 be ad 21 e9 40 b6 54  06 f0 61 f9 2c 71 25 0e  |...!.@.T..a.,q%.|
-00000110  13 6c 66 ef b6 a9 61 d0  d0 42 56 58 32 3c 9c 5a  |.lf...a..BVX2<.Z|
-00000120  ee 13 1d 42 8b 94 41 9c  d1 2e c9 ac d4 ed 0f 04  |...B..A.........|
-00000130  1c 6f 5c 30 80 12 37 c6  43 07 7e 03 50 86 24 84  |.o\0..7.C.~.P.$.|
-00000140  34 2a 70 82 65 67 35 cd  5e 7c 0e 49 30 35 d4 ee  |4*p.eg5.^|.I05..|
-00000150  43 b7 7a c3 88 30 e5 ba  98 7f 8d 9e 08 a2 8c bb  |C.z..0..........|
-00000160  48 44 c2 1a 8d 7b 41 de  b6 68 ae d2 8a 64 9b 6b  |HD...{A..h...d.k|
-00000170  8a 47 88 04 49 05 8a 94  66 da d3 90 78 6d 81 64  |.G..I...f...xm.d|
-00000180  4e 6b a5 6f d2 9d 1d 36  6f a2 a3 83 0c f5 69 10  |Nk.o...6o.....i.|
-00000190  37 c8 b8 59 c7 b1 5b 91  fc e3 26 37 da 14 80 8f  |7..Y..[...&7....|
-000001a0  d4 1e 63 51 1d 77 85 67  af 7a 7d e4 5a 27 f9 3f  |..cQ.w.g.z}.Z'.?|
-000001b0  75 b0 9e 2a 1d 42 29 ac  d4 29 c6 0d 2f ee 35 38  |u..*.B)..)../.58|
-000001c0  38 91 a4 f1 60 1b d6 49  b2 eb c4 df b6 01 99 69  |8...`..I.......i|
-000001d0  06 7c ca 2d aa 15 e8 c5  4f 48 5f 77 87 4b fd 41  |.|.-....OH_w.K.A|
-000001e0  cf aa 7d 96 b9 12 ee b7  b3 a2 86 5e 4f 79 08 a1  |..}........^Oy..|
-000001f0  00 43 12 93 92 99 07 44  23 48 78 46 c8 fc 4a 96  |.C.....D#HxF..J.|
-00000200  88 72 45 2a f4 ff 92 41  7b e5 a0 74 93 ff b8 f6  |.rE*...A{..t....|
-00000210  3e e0 6a 3b 3b 12 68 50  89 d1 d3 22 e0 a1 3f ef  |>.j;;.hP..."..?.|
-00000220  da 18 15 5b c2 48 0e 78  d0 af ae d7 81 af 23 16  |...[.H.x......#.|
-00000230  ab 71 07 9d 26 b2 8b 34  7e b2 1a 1e f4 fb 02 9a  |.q..&..4~.......|
-00000240  f4 15 78 a9 d2 19 94 bb  9f b0 ba 2a 21 20 dd 87  |..x........*! ..|
-00000250  57 73 e7 01 08 bc 38 ce  2d 9e dc 3f f7 c4 75 aa  |Ws....8.-..?..u.|
-00000260  00 9d 28 43 e5 de aa 82  fb e5 ca 87 4e 6c 16 03  |..(C........Nl..|
-00000270  03 00 35 e0 37 f9 95 cd  96 f9 ba 36 12 6b 35 c5  |..5.7......6.k5.|
-00000280  02 9d 71 8a e5 07 d6 1c  77 6a 86 17 d0 01 9b 79  |..q.....wj.....y|
-00000290  74 6b 14 27 33 2f 6d c2  af cb dd 47 71 b3 73 4d  |tk.'3/m....Gq.sM|
-000002a0  7f 42 3e 7f 86 6e 63 ed  16 03 03 00 98 7f ba 78  |.B>..nc........x|
-000002b0  bf a3 d4 02 cb 19 0d 1f  48 bf 4d 9f d0 37 3a c9  |........H.M..7:.|
-000002c0  c1 76 6e fb 9a 69 63 0a  a1 76 13 2d ea 52 38 18  |.vn..ic..v.-.R8.|
-000002d0  71 89 9a f5 02 2e 44 94  72 6d 08 e1 89 9a e1 4c  |q.....D.rm.....L|
-000002e0  ee 2f 15 9c 0d b6 67 1e  0c 17 b0 e9 03 7d 66 1c  |./....g......}f.|
-000002f0  28 6b 57 6d c8 49 5d ef  ca 4c 51 59 ae 17 55 97  |(kWm.I]..LQY..U.|
-00000300  54 f1 f5 64 19 ec 36 27  96 33 0e fd 65 42 ac 50  |T..d..6'.3..eB.P|
-00000310  bb cf f9 da fe 98 3d 83  79 a0 24 0d 9f 91 5c b0  |......=.y.$...\.|
-00000320  5c c5 04 b4 90 53 c3 8b  b5 29 c5 73 7f 04 c6 55  |\....S...).s...U|
-00000330  93 4a 08 67 8f f7 a8 ba  a8 e2 62 09 85 d3 47 b9  |.J.g......b...G.|
-00000340  27 bd 6c 81 95 14 03 03  00 11 88 9b 21 1e 06 0a  |'.l.........!...|
-00000350  fa 8a 9e 4e d9 7a b3 a5  45 7a 96 16 03 03 00 20  |...N.z..Ez..... |
-00000360  6f a0 f0 cf 0b 2b c2 d1  36 d8 64 2b 72 86 7b ab  |o....+..6.d+r.{.|
-00000370  c7 86 5d c3 67 ec d6 c0  32 4d b8 1f fa d9 3a af  |..].g...2M....:.|
+00000000  16 03 03 02 69 97 93 8b  02 bb 85 f7 ec fd ae 99  |....i...........|
+00000010  d2 31 6c 04 64 02 ee dd  86 ea c2 9c 40 22 5a fc  |.1l.d.......@"Z.|
+00000020  6e 6e 66 30 1d bb 71 40  90 b1 c2 1c 38 53 37 21  |nnf0..q@....8S7!|
+00000030  87 a2 df c3 68 b9 c1 90  46 df 73 f8 ba 20 7e 83  |....h...F.s.. ~.|
+00000040  49 2d d8 3c a4 4a 4b 41  70 5d ee 65 68 31 3d f4  |I-.<.JKAp].eh1=.|
+00000050  44 ce 10 be d8 d1 bc 21  25 f0 66 36 f0 b9 8b b9  |D......!%.f6....|
+00000060  89 cc 0c b8 b2 67 ef 86  24 ed 54 2e e8 b7 b3 87  |.....g..$.T.....|
+00000070  c9 58 fa db 3d 0a 78 bb  68 fa 86 26 bd 8b aa 4c  |.X..=.x.h..&...L|
+00000080  f5 8a f8 6a 82 b1 12 79  39 20 71 c4 3f 6a fc 9c  |...j...y9 q.?j..|
+00000090  4a 44 e0 ea 7e 06 35 23  77 dd 07 0e c1 89 85 19  |JD..~.5#w.......|
+000000a0  98 7b e0 31 2d d0 a2 de  be a9 fe 1a 8d ef 45 52  |.{.1-.........ER|
+000000b0  5c ee 4e 7f 0d 69 41 9b  84 a6 84 6c 41 42 31 8c  |\.N..iA....lAB1.|
+000000c0  b8 24 0d cc 54 a6 81 dd  8b 3a 8a 6c ef 75 8c 6b  |.$..T....:.l.u.k|
+000000d0  01 ce 6a ea ae 67 c3 96  8b b6 42 20 c9 e6 7b 2c  |..j..g....B ..{,|
+000000e0  79 fe 1c 25 42 55 95 65  a4 af 16 ec aa 49 e4 fa  |y..%BU.e.....I..|
+000000f0  e5 38 5b c2 82 02 ca 34  8a 20 27 c3 46 55 79 ad  |.8[....4. '.FUy.|
+00000100  31 18 27 ed 14 dc dc ab  75 ba 1f 4c f7 1c 74 f3  |1.'.....u..L..t.|
+00000110  d4 a3 52 f8 39 fe 21 d9  fc 08 7f c6 2c 86 54 90  |..R.9.!.....,.T.|
+00000120  c1 2e b0 de 84 25 eb 36  16 4e 96 c5 fc 6f 83 2b  |.....%.6.N...o.+|
+00000130  3e ad 30 6b ae 33 b2 03  87 2f b7 33 14 50 37 a0  |>.0k.3.../.3.P7.|
+00000140  19 cf 41 1c 68 c9 b8 5c  29 f6 34 db 13 40 10 16  |..A.h..\).4..@..|
+00000150  7c 22 42 38 d5 43 4f 46  4d ae bd e2 7d 78 5f b6  ||"B8.COFM...}x_.|
+00000160  12 ba 19 5a 18 ae b7 76  d6 ae 71 c3 5b c4 b5 3a  |...Z...v..q.[..:|
+00000170  b5 b6 52 9b 0b 92 30 41  4d a0 f4 62 2c c7 4f 27  |..R...0AM..b,.O'|
+00000180  04 f5 7e 77 04 89 11 2a  e0 0c 5e 21 3b 75 13 bf  |..~w...*..^!;u..|
+00000190  1f 48 ed 4d 05 b3 67 f3  d8 71 99 fb 23 c5 0f fd  |.H.M..g..q..#...|
+000001a0  47 7c 36 f8 e0 25 53 f4  15 bd 77 db f5 71 a1 6e  |G|6..%S...w..q.n|
+000001b0  6a 1a 06 a1 8a 5d 2b 28  89 82 7b 29 aa b1 68 a6  |j....]+(..{)..h.|
+000001c0  fb 29 a8 cb ee e0 71 de  52 b8 8a 57 63 ff 74 a5  |.)....q.R..Wc.t.|
+000001d0  ca 8c b5 44 23 74 ab 86  74 cf 82 0b fc 23 90 95  |...D#t..t....#..|
+000001e0  3d 83 87 5a aa af 5d d1  c6 4b dc b0 f3 0f 44 57  |=..Z..]..K....DW|
+000001f0  ca 47 a1 28 64 64 4d 81  15 11 92 5a 8c b9 8d ef  |.G.(ddM....Z....|
+00000200  a9 18 58 67 c7 c3 3b a7  9d 41 be 74 67 cb a8 3e  |..Xg..;..A.tg..>|
+00000210  3d a4 b0 4e 92 15 c1 4a  38 6d 48 ba 57 4b 42 a9  |=..N...J8mH.WKB.|
+00000220  2c de de 6a 5b 60 3e 9d  09 5e 8e d4 97 4a 31 52  |,..j[`>..^...J1R|
+00000230  47 5c ce bc f8 14 49 78  6b 5a 36 aa 3b c7 bc e7  |G\....IxkZ6.;...|
+00000240  59 17 a1 18 d3 b1 54 e8  54 8a 1c 07 a5 3b 9f bd  |Y.....T.T....;..|
+00000250  d1 60 7d e8 78 8c be b2  ea 20 26 59 65 ef 70 71  |.`}.x.... &Ye.pq|
+00000260  98 73 0c 43 cb 3a bc 61  8a f8 19 a4 89 0b 16 03  |.s.C.:.a........|
+00000270  03 00 35 28 53 40 d2 93  99 84 8e d8 fc f1 4a 3e  |..5(S@........J>|
+00000280  22 26 d3 2b c0 e9 32 d4  49 7b 7d 19 61 29 ab 28  |"&.+..2.I{}.a).(|
+00000290  e7 e4 a2 13 2e 5a a8 7f  ef e7 19 7b 9c de fc 21  |.....Z.....{...!|
+000002a0  2a 3d f0 3a d3 dc 17 d2  16 03 03 00 98 30 c7 f4  |*=.:.........0..|
+000002b0  b6 60 3b 87 88 e1 0e 26  d2 34 49 de 8c b8 99 35  |.`;....&.4I....5|
+000002c0  fe 6f 11 4b 8b ab d9 ce  11 b1 f5 05 8d 6b c1 91  |.o.K.........k..|
+000002d0  c8 69 cb 2b 04 99 12 ed  8b 7a 63 e2 9c 5d 80 63  |.i.+.....zc..].c|
+000002e0  57 74 8f 1f 9c f4 6b cb  51 57 6b 33 3e 1b 81 54  |Wt....k.QWk3>..T|
+000002f0  73 54 5c 28 f1 fe 2f 88  41 ea 2b 52 30 93 0e 98  |sT\(../.A.+R0...|
+00000300  fe b1 59 0e 01 26 06 f0  fd 77 cb 59 ec b7 4c 4f  |..Y..&...w.Y..LO|
+00000310  cd 40 c0 36 11 d2 dd c8  1a 40 e2 ba 9c d9 39 99  |.@.6.....@....9.|
+00000320  9a d3 9b 37 ee 76 8b 22  fb 42 a8 90 c6 8d 92 4b  |...7.v.".B.....K|
+00000330  57 83 33 04 75 6a 79 69  8f f9 4d fd d6 bd 01 76  |W.3.ujyi..M....v|
+00000340  98 36 7d b2 b5 14 03 03  00 11 85 15 d7 33 6d 47  |.6}..........3mG|
+00000350  80 84 38 df a3 c2 91 0b  1c e0 82 16 03 03 00 20  |..8............ |
+00000360  0d cc f8 79 c6 13 4e 81  b7 a7 2d 03 18 7e 9d 24  |...y..N...-..~.$|
+00000370  2e 89 d7 7d bf ab a7 1d  2f 15 c1 80 3d f2 89 68  |...}..../...=..h|
 >>> Flow 10 (server to client)
-00000000  14 03 03 00 11 b4 79 7e  62 ea ea f7 37 1d a4 65  |......y~b...7..e|
-00000010  9d 02 95 b8 4a 6c 16 03  03 00 20 6a 45 d1 d0 ff  |....Jl.... jE...|
-00000020  fa 9f 6a ea d5 0d 27 b6  e7 15 8b e8 5b f9 3c d0  |..j...'.....[.<.|
-00000030  32 ff 81 24 9a de 1c 31  6a 48 f8 17 03 03 00 19  |2..$...1jH......|
-00000040  a9 07 ab fb 37 2f 88 0c  93 4a 0c 34 08 26 39 8c  |....7/...J.4.&9.|
-00000050  22 00 1b 36 3c 6d 0c 49  61 16 03 03 00 14 bb 63  |"..6<m.Ia......c|
-00000060  63 7b 28 60 22 a8 bd 17  51 2e 62 91 9e a6 88 1a  |c{(`"...Q.b.....|
-00000070  e4 61                                             |.a|
+00000000  14 03 03 00 11 81 c4 6d  51 fc a3 05 28 42 9a 59  |.......mQ...(B.Y|
+00000010  3f 84 d4 ac 19 a4 16 03  03 00 20 44 a9 25 3f 24  |?......... D.%?$|
+00000020  0a ab 91 47 24 f9 81 fc  1e ab d2 6b ee 81 04 b1  |...G$......k....|
+00000030  3e 16 1f 70 16 e2 74 f5  71 b8 74 17 03 03 00 19  |>..p..t.q.t.....|
+00000040  77 fa 0d b1 b4 fc b6 5b  d0 73 1a 94 d0 6c 05 7d  |w......[.s...l.}|
+00000050  1a fa 6e d4 00 4e 2e 91  e0 16 03 03 00 14 f0 79  |..n..N.........y|
+00000060  e5 37 1f 13 e6 a0 d3 4a  66 a9 e8 03 71 5f 67 37  |.7.....Jf...q_g7|
+00000070  aa b6                                             |..|
 >>> Flow 11 (client to server)
-00000000  16 03 03 01 1a a4 4c dc  47 09 04 ab bb ca 49 f2  |......L.G.....I.|
-00000010  63 36 35 fb e3 3f ad ae  82 2a 9b 87 cc 0c 2e ea  |c65..?...*......|
-00000020  18 af ad e9 ea 7a c8 45  de c6 9b 0e e0 32 26 95  |.....z.E.....2&.|
-00000030  ba e3 57 9e 27 ce ff 36  43 a3 bd 79 47 6c 02 86  |..W.'..6C..yGl..|
-00000040  81 44 ac b3 c6 21 d8 fa  8c 69 43 b7 66 70 ea 24  |.D...!...iC.fp.$|
-00000050  12 1b ac 44 d2 49 e3 5a  d1 0e 50 76 46 4f 58 51  |...D.I.Z..PvFOXQ|
-00000060  21 4c f8 20 63 60 c0 20  3a 12 e5 0b 86 e3 03 2c  |!L. c`. :......,|
-00000070  e1 fc 63 e4 44 d4 67 95  aa af 22 3d 40 7b 4e 12  |..c.D.g..."=@{N.|
-00000080  98 7d 05 00 57 50 d5 3a  d7 af dd 96 0f ac 77 63  |.}..WP.:......wc|
-00000090  f8 1c b0 9c d0 96 9f 20  a1 48 55 aa dc 69 fb b7  |....... .HU..i..|
-000000a0  67 58 ff 27 de 22 ea 66  48 32 56 1f ef 12 3f 44  |gX.'.".fH2V...?D|
-000000b0  38 af ae 4b c2 16 bb c8  f1 fe 13 d7 05 66 de 08  |8..K.........f..|
-000000c0  f3 4d 5c a6 e1 2d 0d c3  ce 50 7b 01 40 49 0f 83  |.M\..-...P{.@I..|
-000000d0  97 c0 37 a2 6c 2b 64 a9  40 0e e1 7b f4 6e e1 cc  |..7.l+d.@..{.n..|
-000000e0  1a 5f 0b c5 69 dc dc db  0e a2 22 7b cf ca 73 81  |._..i....."{..s.|
-000000f0  fc 47 47 c7 76 18 8e ae  55 6c fe 5e 5e 33 84 9c  |.GG.v...Ul.^^3..|
-00000100  4c 1b f8 21 29 3c 47 1b  c8 01 38 7d c2 50 45 1c  |L..!)<G...8}.PE.|
-00000110  9a be 58 62 81 f5 5d c4  03 c9 5a da 9b 47 99     |..Xb..]...Z..G.|
+00000000  16 03 03 01 38 e1 e6 8b  40 d6 ae f9 34 1a 27 20  |....8...@...4.' |
+00000010  67 ad c3 86 18 ee c0 e2  82 10 c1 33 df f6 4d 13  |g..........3..M.|
+00000020  46 a1 0b 23 25 12 2e 71  e9 50 2d 08 1c 53 47 a9  |F..#%..q.P-..SG.|
+00000030  69 bd e2 d3 f9 cf 44 91  ec 9a c7 2c ee 2a f8 4e  |i.....D....,.*.N|
+00000040  bf 07 22 9b 6d 00 48 63  78 63 ab 39 b2 be d3 64  |..".m.Hcxc.9...d|
+00000050  7b 46 7a 34 91 e0 1e fc  f4 89 49 e3 75 dc 6b 83  |{Fz4......I.u.k.|
+00000060  95 77 f0 cc 09 b0 3a 19  18 93 6e 9b 5d da b4 93  |.w....:...n.]...|
+00000070  d2 f6 ef de b0 e8 11 04  02 d2 a4 3d cd 95 fd cd  |...........=....|
+00000080  58 93 91 ed 45 1e b9 35  0b 46 5e fc f7 7a e4 18  |X...E..5.F^..z..|
+00000090  96 97 95 f9 8c 84 aa 7c  a9 67 f3 ac b6 e9 9f 12  |.......|.g......|
+000000a0  9f 0f fc 3a 3f 35 ae 13  49 42 04 21 0c b8 06 d3  |...:?5..IB.!....|
+000000b0  e2 13 7a 1e 57 cb 15 91  09 d2 9a 42 84 81 4f b7  |..z.W......B..O.|
+000000c0  6e 6f 8f c0 71 af 7b ca  37 9c 01 2a bc 37 04 8c  |no..q.{.7..*.7..|
+000000d0  ce 3e 82 7f 8b 4e 13 00  15 3c b6 8a 06 63 b6 68  |.>...N...<...c.h|
+000000e0  55 01 97 e6 d1 e1 b8 ae  2a c6 e7 4c fd e5 40 76  |U.......*..L..@v|
+000000f0  11 fa 18 12 db 98 d5 d9  61 8f 33 66 38 95 ba ae  |........a.3f8...|
+00000100  b6 1d 8e 03 27 6c 78 7a  89 82 0f ca 56 d4 19 ae  |....'lxz....V...|
+00000110  e2 79 6b 6d 80 b8 ce fc  3e 42 5a c7 e7 05 3b eb  |.ykm....>BZ...;.|
+00000120  a1 33 a0 56 92 e3 10 e6  ff 17 9b 2d 8e 40 56 fc  |.3.V.......-.@V.|
+00000130  76 9c a6 32 9f 7a a2 d8  e9 77 2f 9f e9           |v..2.z...w/..|
 >>> Flow 12 (server to client)
-00000000  16 03 03 00 85 bb 34 66  c0 a3 8c 2b 2c fe fe 82  |......4f...+,...|
-00000010  53 a1 07 1f 06 db 41 94  ac 21 f2 c4 23 0e b6 48  |S.....A..!..#..H|
-00000020  4d 16 97 2a 79 dd 95 4c  93 7f e4 8c 94 90 d4 02  |M..*y..L........|
-00000030  3c 44 b4 80 80 7b 45 84  53 3f 6b 9f f6 b6 d3 0c  |<D...{E.S?k.....|
-00000040  90 18 6e 52 1b 7d 15 85  ef da 2d fd fa b4 0e f2  |..nR.}....-.....|
-00000050  3a ab 78 1a 67 9e 3a 62  c3 f6 0d 33 e3 7a 0a 15  |:.x.g.:b...3.z..|
-00000060  de f6 ec 66 89 9d 4c 83  26 83 98 67 63 5c 74 e6  |...f..L.&..gc\t.|
-00000070  7a 38 f0 90 48 59 3d 24  8d 46 e6 ff 3c 27 d5 2e  |z8..HY=$.F..<'..|
-00000080  6c c0 c6 45 f1 95 53 96  ff 92 16 03 03 02 69 f8  |l..E..S.......i.|
-00000090  16 95 d2 48 ef 35 3d 14  4e 49 f2 2a 4a bb b7 e7  |...H.5=.NI.*J...|
-000000a0  66 4b 99 4b 9c b9 d2 22  8e 07 1e e6 b9 18 86 04  |fK.K..."........|
-000000b0  76 1c 52 77 88 60 63 99  91 88 10 1e d6 d2 8a 2b  |v.Rw.`c........+|
-000000c0  0b c1 5b b3 a6 ca f5 96  4d a1 3b 27 c5 e6 37 e5  |..[.....M.;'..7.|
-000000d0  9e 5a 15 42 7e 48 5a 46  52 aa 16 c1 af 31 e0 5e  |.Z.B~HZFR....1.^|
-000000e0  1f 0b 2e 6c b0 77 2b 18  96 df 2c b1 14 98 ab 19  |...l.w+...,.....|
-000000f0  f9 58 dc 2f 29 09 be 2f  6e 69 00 e0 de 49 5b ca  |.X./)../ni...I[.|
-00000100  2f 3d c6 41 9d 18 ca ef  4b e4 06 12 1b 08 5f 62  |/=.A....K....._b|
-00000110  53 85 a7 fc d1 26 b1 6b  20 56 56 16 87 54 bb e6  |S....&.k VV..T..|
-00000120  ed bc d5 7c 7f ce 24 c4  84 ee 01 dd 88 da bd c8  |...|..$.........|
-00000130  b7 70 a6 b4 63 cc 70 f7  1a d5 5b 9b 02 45 ec 3b  |.p..c.p...[..E.;|
-00000140  b1 64 ee 7d 74 bd 52 10  bc ee fe 36 4b cc 54 e4  |.d.}t.R....6K.T.|
-00000150  e7 7f ce a9 af 5b db 86  bb 1f 09 50 f2 a3 95 98  |.....[.....P....|
-00000160  94 c4 4f 36 2a b0 7e c7  54 8c 1e 5d 0b 3f b4 7a  |..O6*.~.T..].?.z|
-00000170  b9 43 bc 6b 74 45 12 44  1b 28 27 ff 55 fe 4e b2  |.C.ktE.D.('.U.N.|
-00000180  0b e3 d5 59 d2 55 2f d4  a7 d5 0a 38 62 c2 a6 78  |...Y.U/....8b..x|
-00000190  19 23 46 84 41 41 3d 7a  84 22 94 f1 b0 85 83 62  |.#F.AA=z.".....b|
-000001a0  17 1a 46 70 80 f7 be 0d  98 d0 07 52 52 7f ab 7f  |..Fp.......RR...|
-000001b0  d3 b9 5c eb 39 10 d4 ff  6f ba 07 0c e6 77 30 0f  |..\.9...o....w0.|
-000001c0  e2 b0 b4 40 97 f6 6b cb  53 3b 49 6f 80 7c 34 95  |...@..k.S;Io.|4.|
-000001d0  c2 5a 37 fb bd e6 10 b0  64 fe ca 6a 06 a5 db 98  |.Z7.....d..j....|
-000001e0  83 2c e7 0e 4c df b9 be  96 6e 83 ac 5c 1f f2 0a  |.,..L....n..\...|
-000001f0  3e 8b 63 fe 91 9a e2 3e  54 50 0c 14 61 6c 58 20  |>.c....>TP..alX |
-00000200  da a8 5a f7 46 9d a3 57  a1 60 72 59 82 dd f7 08  |..Z.F..W.`rY....|
-00000210  9e 48 16 8d b1 c0 f4 d2  e0 4e 5d 3c bf 23 88 0f  |.H.......N]<.#..|
-00000220  99 90 b0 a9 7e df 0b f5  1a 31 9e 59 e1 05 43 4e  |....~....1.Y..CN|
-00000230  4f d9 a5 b1 00 2e f2 c8  10 2c 73 ec c4 62 b8 c3  |O........,s..b..|
-00000240  59 53 ce 38 37 9d c3 f6  77 36 34 f2 07 a6 21 1f  |YS.87...w64...!.|
-00000250  62 56 08 d3 ed ae 51 05  4d ed ef 7e 77 c5 7d ae  |bV....Q.M..~w.}.|
-00000260  b6 aa 74 e9 9a df 5d 89  c2 9f 07 75 a0 c2 35 2d  |..t...]....u..5-|
-00000270  cc 13 c5 a9 17 85 79 b6  45 0c 82 56 0d 19 9e bc  |......y.E..V....|
-00000280  e7 1a a6 cc 20 6f f9 7c  29 54 2f 5a 92 1f c0 8b  |.... o.|)T/Z....|
-00000290  9c a7 a3 85 43 f2 4c e7  c5 e3 af 6e 40 f4 14 d4  |....C.L....n@...|
-000002a0  b8 26 5f ac d7 44 16 6d  40 d5 80 c5 49 df 8d fe  |.&_..D.m@...I...|
-000002b0  06 1c 7c 19 49 94 50 6f  e8 8c e0 59 80 9a a0 0e  |..|.I.Po...Y....|
-000002c0  50 3f 03 de c9 30 88 15  91 83 4e a8 df c3 65 75  |P?...0....N...eu|
-000002d0  cd 30 3e 7d 32 4a d9 ff  72 1e 1d 90 50 f3 67 8a  |.0>}2J..r...P.g.|
-000002e0  6a 94 c3 92 9a d4 0b 20  7e 61 98 6e db d0 71 4a  |j...... ~a.n..qJ|
-000002f0  8b 43 82 7e 76 e6 93 f7  16 03 03 00 bc e6 e6 85  |.C.~v...........|
-00000300  a8 2c 74 47 10 a3 27 26  f7 46 fb da fa 6a 93 2c  |.,tG..'&.F...j.,|
-00000310  b1 14 b2 90 d3 4e 94 42  c4 37 6d 4d 43 73 b4 a7  |.....N.B.7mMCs..|
-00000320  17 c1 3c 62 5d e4 c4 04  7c f7 13 39 9f a8 3f 05  |..<b]...|..9..?.|
-00000330  92 90 be 10 cf 2a b4 26  01 fc 6f 59 f9 8d b5 79  |.....*.&..oY...y|
-00000340  66 41 16 af 39 2d 4c 18  d4 e9 e2 aa bc d3 b9 8e  |fA..9-L.........|
-00000350  e8 59 27 01 b7 f3 05 ff  2a ef 53 41 95 f7 be 2e  |.Y'.....*.SA....|
-00000360  36 38 56 01 e6 e8 62 4d  8f 62 43 b9 cd 8a d2 6d  |68V...bM.bC....m|
-00000370  17 fb 12 65 8f ea 22 57  f1 f3 e6 00 ae c0 9f 5b  |...e.."W.......[|
-00000380  7f b1 fe e4 f5 0f 53 60  3e a3 df 64 b2 d5 cb f4  |......S`>..d....|
-00000390  e5 f8 f3 75 54 65 f4 6f  e9 c8 eb a2 6c 06 98 fd  |...uTe.o....l...|
-000003a0  e9 bb a2 93 ab ee 0b fa  c7 b4 fa e1 91 34 a9 a7  |.............4..|
-000003b0  b9 14 16 25 32 88 09 3e  b1 16 03 03 00 14 d0 c0  |...%2..>........|
-000003c0  54 b2 37 35 9b cf 51 71  28 b2 d6 86 05 16 ad a0  |T.75..Qq(.......|
-000003d0  18 e7                                             |..|
+00000000  16 03 03 00 85 12 4a cc  dd af 7e 9f 8f c0 5e dc  |......J...~...^.|
+00000010  db 49 95 90 d0 d4 78 49  8b 34 5c 22 7f f8 9b 42  |.I....xI.4\"...B|
+00000020  99 79 d3 d8 f2 ad 9e e1  67 80 84 8d b5 48 8c 9a  |.y......g....H..|
+00000030  ab 68 65 81 28 16 75 77  e6 57 8a 52 ba ab 2e 3d  |.he.(.uw.W.R...=|
+00000040  27 1c 90 fb 75 99 8f 2b  6b 4e 2c 78 3a f8 5b 25  |'...u..+kN,x:.[%|
+00000050  55 df c6 83 c6 0f 01 f0  00 b0 8e 02 51 62 aa 91  |U...........Qb..|
+00000060  1b 21 b7 2e b3 11 b6 5d  c4 38 04 3c af ad 3e a3  |.!.....].8.<..>.|
+00000070  f5 ec 8f 7f 6f 9d 7a eb  22 51 2c 9e 08 af 9d ab  |....o.z."Q,.....|
+00000080  a7 84 cb f8 68 78 9b 58  50 fa 16 03 03 02 69 07  |....hx.XP.....i.|
+00000090  17 f9 21 47 17 ee f7 d3  06 98 d4 32 e5 a1 c8 f0  |..!G.......2....|
+000000a0  ec eb 61 80 7f 2c 85 66  27 19 cd 8e 6f ca da 0f  |..a..,.f'...o...|
+000000b0  c5 34 76 9f b0 96 5d 6d  67 bd 17 7d 96 62 4e ce  |.4v...]mg..}.bN.|
+000000c0  a1 0e 40 79 6d 25 8c 81  41 a3 2d 0a ba cb d9 35  |..@ym%..A.-....5|
+000000d0  4e a7 fc 74 14 a2 c6 bd  57 46 6a d0 11 37 72 24  |N..t....WFj..7r$|
+000000e0  19 78 e5 86 51 04 f4 10  47 2f a5 d9 e6 44 47 e0  |.x..Q...G/...DG.|
+000000f0  1f 1b ce ea 6f c7 df 17  6a 68 69 01 30 73 e2 48  |....o...jhi.0s.H|
+00000100  61 50 3d 7d 85 aa 5f 74  4c 18 33 d0 e1 95 1b 9a  |aP=}.._tL.3.....|
+00000110  13 30 a2 f4 8e 8b 58 07  15 9b c8 74 ce 58 5b c1  |.0....X....t.X[.|
+00000120  03 75 97 39 5b 00 ee 5a  d6 ba 21 62 6a 19 41 0d  |.u.9[..Z..!bj.A.|
+00000130  4f 77 46 a0 2e 2d c3 77  50 2c dc 3f 04 32 6c be  |OwF..-.wP,.?.2l.|
+00000140  7f 73 c2 58 50 ac 78 eb  b9 b0 a0 2e b7 44 27 0f  |.s.XP.x......D'.|
+00000150  e8 0d 76 d5 a7 4e 9f df  36 bb 63 48 ce f6 2f 9c  |..v..N..6.cH../.|
+00000160  41 a6 76 38 63 72 a0 33  0f 88 94 0d a2 6e 46 d6  |A.v8cr.3.....nF.|
+00000170  57 25 33 e1 36 a0 bf 56  b8 d5 d0 04 2d 23 e8 ac  |W%3.6..V....-#..|
+00000180  93 2c 46 ac 1f e5 2a 48  88 0e 0d 11 67 fe de 21  |.,F...*H....g..!|
+00000190  31 e8 68 9b 7c 4c 49 b8  27 5a c4 89 a4 4c 09 f0  |1.h.|LI.'Z...L..|
+000001a0  de 5f 9c 60 bd 54 e5 96  2c bf a1 86 3a cb 5b 3f  |._.`.T..,...:.[?|
+000001b0  15 3f 4a b2 43 c9 88 0b  49 05 2d d7 61 43 dd 1c  |.?J.C...I.-.aC..|
+000001c0  a9 4d 52 17 98 4d 5b a7  cd 27 52 60 21 57 ed 09  |.MR..M[..'R`!W..|
+000001d0  29 0d c9 a1 b3 6f 11 3a  da 17 00 73 22 4e 7f 40  |)....o.:...s"N.@|
+000001e0  6f 0f 7a a7 7e 73 b8 be  08 b6 10 b3 bb 70 f5 4a  |o.z.~s.......p.J|
+000001f0  96 aa 07 9f e2 68 04 7c  01 e3 92 f9 15 cd 97 b5  |.....h.|........|
+00000200  4e 87 eb 5d 74 db 8b 5a  72 c1 7c b2 b8 73 83 2d  |N..]t..Zr.|..s.-|
+00000210  5f d9 d2 62 b2 db 20 9a  f2 54 ad d4 66 6c 52 9c  |_..b.. ..T..flR.|
+00000220  85 ef a4 90 ca e0 c4 4f  1f 82 0e 80 f5 02 56 e2  |.......O......V.|
+00000230  d0 78 fd 7e c6 73 89 12  5a 11 2e c9 6d a0 6f 8f  |.x.~.s..Z...m.o.|
+00000240  ea a1 4c 88 28 ee 66 79  9c 99 ff 6b e6 e7 f7 bf  |..L.(.fy...k....|
+00000250  1f ef 1f b9 65 46 1e 41  d8 33 13 a1 29 d1 1b 5f  |....eF.A.3..).._|
+00000260  b6 56 3c bf 28 02 d1 5b  b7 77 58 9e cd 4c 5f ac  |.V<.(..[.wX..L_.|
+00000270  2e 60 9e 0c 20 6a 0a 31  60 0b fb a4 75 20 5d c4  |.`.. j.1`...u ].|
+00000280  68 a6 94 bd 99 9c bb 00  57 9c 2e 55 e1 ca d1 0c  |h.......W..U....|
+00000290  40 1f 69 4f 88 79 da 4f  d1 b2 6f 1a 92 77 90 71  |@.iO.y.O..o..w.q|
+000002a0  34 d1 90 f7 c9 fc c9 ac  23 76 d3 2d 6c 54 fa 28  |4.......#v.-lT.(|
+000002b0  a5 2b df 1d f5 39 21 c1  4c 9c 53 08 f5 fc 19 e6  |.+...9!.L.S.....|
+000002c0  29 d4 c2 8b b1 f9 db ae  1f 29 ee 34 8f b0 fe 02  |)........).4....|
+000002d0  06 6a 3e a9 e0 2e e1 71  f8 63 15 f0 ac e5 6b f3  |.j>....q.c....k.|
+000002e0  db 3d b1 de c5 26 a5 18  22 d8 3a 74 1f 57 43 b5  |.=...&..".:t.WC.|
+000002f0  9e f6 40 cc fd ba 68 82  16 03 03 00 bc 0a 05 54  |..@...h........T|
+00000300  61 ad be a6 2a 6e ee f3  b7 fb 50 9f c5 f8 7d b3  |a...*n....P...}.|
+00000310  9a 85 ed 6f 36 5d f3 e5  05 1a c5 b9 6f 9f 2a 99  |...o6]......o.*.|
+00000320  75 d0 49 37 eb 82 fb e0  da bf 8f 6d 0e ab 11 c9  |u.I7.......m....|
+00000330  0d e1 d0 1a cd b1 e7 c9  c2 6e f4 90 ae 56 ba d2  |.........n...V..|
+00000340  65 af f4 7f c2 3c e8 d7  f6 49 57 61 c8 02 0e 72  |e....<...IWa...r|
+00000350  e5 d8 2f 3e f2 d9 4c 64  32 1a 95 f9 f4 f8 47 9f  |../>..Ld2.....G.|
+00000360  c5 63 6b f2 44 48 7f 69  ae 12 f7 ca ff 60 f0 51  |.ck.DH.i.....`.Q|
+00000370  9f 70 7b d9 86 03 fd 9d  d5 29 35 c1 bd 4d fe 45  |.p{......)5..M.E|
+00000380  e1 e0 15 dd 2d f4 20 54  50 61 ba d9 8c bf e6 f1  |....-. TPa......|
+00000390  4a 08 e1 c8 f7 24 f0 5f  41 4c 8e f3 fd 60 31 89  |J....$._AL...`1.|
+000003a0  d6 72 a9 e5 14 65 83 c1  ae be e7 b3 89 99 25 87  |.r...e........%.|
+000003b0  20 13 1b 0a a8 3d d3 dc  5c 16 03 03 00 14 71 4c  | ....=..\.....qL|
+000003c0  20 9c de 36 cc ed 88 6f  c8 84 5a 03 ee 1d cd 3c  | ..6...o..Z....<|
+000003d0  c7 88                                             |..|
 >>> Flow 13 (client to server)
-00000000  16 03 03 00 35 e8 18 a5  be 6e 3b 37 5b d3 81 d3  |....5....n;7[...|
-00000010  ad 0b 90 2e e0 df 2b 7f  c4 ec 54 58 ef 85 e3 13  |......+...TX....|
-00000020  41 07 50 d1 06 9b 3e a3  71 30 bf 7d 0c 7a bd 1e  |A.P...>.q0.}.z..|
-00000030  b6 e9 1e 10 0d 18 e3 b3  1c 38 14 03 03 00 11 bf  |.........8......|
-00000040  b3 65 ae 3b e6 c2 ad 30  83 75 65 c0 2b 0d 4b 11  |.e.;...0.ue.+.K.|
-00000050  16 03 03 00 20 c6 cb f8  69 c3 bc 36 74 ff 8a 1f  |.... ...i..6t...|
-00000060  02 ef 32 37 fe 4f 14 51  d2 11 6a 98 05 4c 8c f6  |..27.O.Q..j..L..|
-00000070  75 05 f9 39 2c                                    |u..9,|
+00000000  16 03 03 00 35 12 be 58  29 49 7c 4d 6c 24 a0 76  |....5..X)I|Ml$.v|
+00000010  72 a5 f8 e2 2b 61 fc a6  e3 97 00 cc 3f 52 26 9b  |r...+a......?R&.|
+00000020  0e 1c 0b 05 2a f3 86 79  13 2b 33 5f 99 f0 91 5f  |....*..y.+3_..._|
+00000030  95 88 fe d1 0d 84 a7 5b  f0 7b 14 03 03 00 11 82  |.......[.{......|
+00000040  33 3a 3a d4 72 53 72 1a  90 d1 d1 14 18 c6 2d 03  |3::.rSr.......-.|
+00000050  16 03 03 00 20 47 44 78  28 c6 68 5e 4e 7f ae 14  |.... GDx(.h^N...|
+00000060  3c 37 64 45 6c 91 29 ff  19 b6 dd 09 6e 2e f8 b8  |<7dEl.).....n...|
+00000070  91 ed 60 9f ec                                    |..`..|
 >>> Flow 14 (server to client)
-00000000  14 03 03 00 11 a0 fa 14  67 3f 54 1b 61 89 ed db  |........g?T.a...|
-00000010  9c 66 9f 49 77 2d 16 03  03 00 20 ca 47 f0 57 8c  |.f.Iw-.... .G.W.|
-00000020  3e 52 e6 e2 6c 01 cb 16  05 68 5e 19 12 ca 80 48  |>R..l....h^....H|
-00000030  dc e9 ed 41 33 08 01 ef  6e b0 a3 17 03 03 00 19  |...A3...n.......|
-00000040  d9 c8 68 e8 27 3d cf c0  33 71 55 a9 6a b4 6d a5  |..h.'=..3qU.j.m.|
-00000050  da 8d bb 34 94 4f b1 c6  22                       |...4.O.."|
+00000000  14 03 03 00 11 9b 5d c3  de 7d 32 e1 a2 2c d3 d7  |......]..}2..,..|
+00000010  1b c9 cb bd d3 5b 16 03  03 00 20 21 50 5c ba c2  |.....[.... !P\..|
+00000020  c3 d5 53 42 9c cf 93 86  e3 29 18 f0 4b 6c d9 a7  |..SB.....)..Kl..|
+00000030  17 d6 dc b9 7c 82 9e 61  c1 dd ea 17 03 03 00 19  |....|..a........|
+00000040  59 bd 70 5b d8 4e fd 09  1c 17 c1 82 6a 85 8b fc  |Y.p[.N......j...|
+00000050  2e 59 87 80 13 dc 3e 7a  01                       |.Y....>z.|
 >>> Flow 15 (client to server)
-00000000  15 03 03 00 12 15 66 43  1e 60 21 d1 f6 94 34 3e  |......fC.`!...4>|
-00000010  ee 90 fc 87 45 2a f5                              |....E*.|
+00000000  15 03 03 00 12 d9 80 6a  95 a6 37 81 5b d0 78 d3  |.......j..7.[.x.|
+00000010  4a 02 cc a6 ba b8 96                              |J......|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected
index 7698b6791d..3d57311bb2 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 e3 fe 9a 75 3b  |....]...Y.....u;|
-00000010  82 ac ff 66 ee c2 e9 75  d9 29 cc 89 6d e0 27 19  |...f...u.)..m.'.|
-00000020  62 07 0b 0b c0 49 df 17  26 af 63 20 2a 95 69 54  |b....I..&.c *.iT|
-00000030  3c 5d d9 67 05 4c 45 77  d0 d9 46 29 ed 25 fd 7d  |<].g.LEw..F).%.}|
-00000040  b4 ef 39 d2 ee 3b a3 88  85 c5 78 9a cc a8 00 00  |..9..;....x.....|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 0c 17 84 76 1d  |....]...Y.....v.|
+00000010  f7 2f 64 9b 6a be 05 1b  7c 96 bf f1 d3 33 37 d2  |./d.j...|....37.|
+00000020  4b 33 2d f9 16 12 0a 87  18 60 71 20 36 34 57 1e  |K3-......`q 64W.|
+00000030  53 7d 7c 52 c6 be a5 35  41 f6 72 65 3c 78 42 a5  |S}|R...5A.re<xB.|
+00000040  2b da 18 77 25 2f 0f d6  1b 3a 10 df cc a8 00 00  |+..w%/...:......|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -61,189 +63,191 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 ca 74 42  |............ .tB|
-000002d0  03 67 f2 31 ac 68 dd 2c  db 23 7d 2c 84 df e9 50  |.g.1.h.,.#},...P|
-000002e0  ff ef d4 a1 fa a4 5b 0b  0b 73 20 b7 0e 08 04 00  |......[..s .....|
-000002f0  80 41 60 3d b1 1c 1d 14  8a 0a 3e 5c ea ca ce 07  |.A`=......>\....|
-00000300  d4 45 18 6c 16 52 40 6f  b0 f4 33 38 d7 cf 11 75  |.E.l.R@o..38...u|
-00000310  08 4e 7d 8b cc 64 8c 79  dd 42 fa 43 2c 9e 84 91  |.N}..d.y.B.C,...|
-00000320  e9 d5 bc 9f 84 2d 10 4b  db 4e a6 be 37 e9 2e 34  |.....-.K.N..7..4|
-00000330  d7 3e a7 17 80 b5 cd 37  04 2a 6c 2a cc 5f 0c a1  |.>.....7.*l*._..|
-00000340  ff c2 31 86 17 50 3a 47  4d 99 49 94 9c 11 12 e2  |..1..P:GM.I.....|
-00000350  70 fa d1 f4 7e 3a f2 3a  df 16 34 45 0a b2 7b 73  |p...~:.:..4E..{s|
-00000360  fa 59 23 85 88 74 2b e6  1e cb c7 00 f5 96 c8 8a  |.Y#..t+.........|
-00000370  02 16 03 03 00 04 0e 00  00 00                    |..........|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 02 b5 bb  |............ ...|
+000002d0  3d 94 26 c2 04 4c 2d e6  e3 d0 e5 78 c1 00 eb de  |=.&..L-....x....|
+000002e0  df 23 8a f3 d7 67 0c d1  0b 5e 43 84 4f 08 04 00  |.#...g...^C.O...|
+000002f0  80 3d b9 6b 00 6e e7 cf  4a 27 67 de a2 d4 a4 ad  |.=.k.n..J'g.....|
+00000300  37 19 a3 66 ab 1e 92 7f  99 74 6b 4a 5e 3d e6 3b  |7..f.....tkJ^=.;|
+00000310  1a 0a d1 fe 2a 3a c9 08  d9 0a 1a 7f c1 83 fa 9e  |....*:..........|
+00000320  9d 8a 5e 2b 52 3a ef 09  91 63 db 4e 19 9c 59 ef  |..^+R:...c.N..Y.|
+00000330  a9 1c 23 12 8b d5 67 74  05 b7 c4 12 bd 1d 63 9a  |..#...gt......c.|
+00000340  97 a7 9c fe 94 ed 81 96  a6 e6 30 02 11 c2 97 eb  |..........0.....|
+00000350  0a f6 14 e7 d4 d3 11 5d  8f ff 77 f1 19 03 a3 16  |.......]..w.....|
+00000360  1e 0d 0e e1 9b f6 bd de  7e 40 d5 36 56 dd 85 44  |........~@.6V..D|
+00000370  5a 16 03 03 00 04 0e 00  00 00                    |Z.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 0a a7 0c  5f 47 d1 7c 5e ea 63 82  |.... ..._G.|^.c.|
-00000040  83 27 6c bc 29 20 25 ec  3d 15 2d 59 94 e7 9d 2c  |.'l.) %.=.-Y...,|
-00000050  8b 4e 95 85 fc                                    |.N...|
+00000030  16 03 03 00 20 c3 8e 95  b8 d7 c3 39 43 fd 47 5f  |.... ......9C.G_|
+00000040  b5 3f 9e a3 7a a2 82 d5  82 cf d7 b7 9e 95 9f ed  |.?..z...........|
+00000050  fc f5 76 25 96                                    |..v%.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 03 84 99 6b f7  |.......... ...k.|
-00000010  3e 44 b1 96 6a 09 75 bf  26 4b 67 30 c4 e9 86 74  |>D..j.u.&Kg0...t|
-00000020  4d e1 e3 9b fa 15 8e 1e  72 f9 5a                 |M.......r.Z|
+00000000  14 03 03 00 01 01 16 03  03 00 20 1e d5 ca 57 c6  |.......... ...W.|
+00000010  43 4f d3 11 44 d1 f8 69  d3 9e 22 17 d6 c1 7f aa  |CO..D..i..".....|
+00000020  ad d6 1f 08 67 9c cd 4f  9f 53 c0                 |....g..O.S.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 68 29 2f  1b 1c 9d 28 6e b6 e5 09  |.....h)/...(n...|
-00000010  4a 77 96 23 20 da 67 9e  14 ec 6b                 |Jw.# .g...k|
+00000000  17 03 03 00 16 8d fa 48  d3 57 aa d7 8e 75 8b ff  |.......H.W...u..|
+00000010  bd 03 ea df 3e da d3 15  ec 12 67                 |....>.....g|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 14 66 e8 13  d1 b5 13 cf 5c 71 7b d9  |.....f......\q{.|
-00000010  63 29 3d be 68 9f f4 ad  7b                       |c)=.h...{|
+00000000  16 03 03 00 14 e9 4d ee  89 18 5f bd d8 15 dd 1f  |......M..._.....|
+00000010  a4 94 98 3b 96 75 3c 2b  bc                       |...;.u<+.|
 >>> Flow 7 (client to server)
-00000000  16 03 03 01 1a cb 21 91  08 de 08 87 fc 63 10 93  |......!......c..|
-00000010  24 a3 83 e8 99 07 d5 03  19 61 4e 8e df dd d0 f6  |$........aN.....|
-00000020  50 3c fd 14 23 67 cd 74  ad 87 9b b7 8f ee a2 23  |P<..#g.t.......#|
-00000030  6c 2f 90 18 f4 01 6b 31  fe ca f7 65 f9 64 5a bc  |l/....k1...e.dZ.|
-00000040  49 3b 25 4c 35 59 50 f2  bc 70 cb 24 2f ec 47 12  |I;%L5YP..p.$/.G.|
-00000050  b6 16 22 9e ce 3b fb 17  f9 59 4e 2f 5c 03 90 47  |.."..;...YN/\..G|
-00000060  d5 e8 e9 eb d9 55 bf 8f  28 e8 72 e5 15 21 42 ba  |.....U..(.r..!B.|
-00000070  86 65 ac b4 f5 53 7e 98  38 39 b5 7d 2a 14 d6 7b  |.e...S~.89.}*..{|
-00000080  3e 69 9d dc 43 33 ed 0b  8a 77 14 54 9d b0 da 88  |>i..C3...w.T....|
-00000090  3b 75 50 01 07 02 99 36  39 4f 01 ee 02 cf 05 a5  |;uP....69O......|
-000000a0  71 75 03 3a a5 5c c4 ce  0e 1d ba dd 9d 79 c1 84  |qu.:.\.......y..|
-000000b0  81 69 7c cd 63 a4 20 a3  a2 13 8e 6e d7 01 29 8d  |.i|.c. ....n..).|
-000000c0  35 e2 fa 3d 74 ea 40 06  7e 0b 2d ab 3c 54 73 ef  |5..=t.@.~.-.<Ts.|
-000000d0  70 ad fd fa ff b3 61 da  61 c5 9f 86 8c 96 73 a6  |p.....a.a.....s.|
-000000e0  f7 53 95 0e 40 33 8b 8c  25 cd 20 e1 2e e9 f4 87  |.S..@3..%. .....|
-000000f0  ec 5c 1c 9c d7 98 d8 0a  96 32 12 51 dd c0 62 a4  |.\.......2.Q..b.|
-00000100  3e 95 09 c8 26 a5 46 55  bd ee 13 97 7f 9c cb e9  |>...&.FU........|
-00000110  43 bd e5 9f 5c 35 02 25  54 17 89 c0 be ab bc     |C...\5.%T......|
+00000000  16 03 03 01 38 1c b1 26  7d 48 7e 75 46 3c 85 68  |....8..&}H~uF<.h|
+00000010  1c ef 2b 61 c1 f1 c5 dc  38 61 a1 2f a1 f1 3d b8  |..+a....8a./..=.|
+00000020  ab 39 ee c6 c1 2b ec fe  ea a8 0d d3 81 de 73 87  |.9...+........s.|
+00000030  d1 0b e7 cf d0 88 38 11  26 20 aa f4 39 4d 64 ea  |......8.& ..9Md.|
+00000040  97 b8 7c aa 4b b0 81 3d  2b 32 db 8c be 98 73 e2  |..|.K..=+2....s.|
+00000050  e6 81 8b 23 f9 c2 a9 d7  dd 31 17 0f c2 37 b5 95  |...#.....1...7..|
+00000060  31 3f 6b 62 0f 57 73 56  bd 94 d9 87 40 e4 43 46  |1?kb.WsV....@.CF|
+00000070  fc ae cb b6 f9 7c 0a 8b  04 a6 d7 0f ca 66 42 93  |.....|.......fB.|
+00000080  f6 0e 89 b1 b3 1c 6e 4a  a2 d3 b3 1b 33 6c cd 83  |......nJ....3l..|
+00000090  15 99 4f 3c 2c 27 b0 82  18 1a 0f ba e3 b1 55 aa  |..O<,'........U.|
+000000a0  5d 2b 92 24 c4 be 22 3e  07 c6 18 d6 5a 19 f7 5a  |]+.$..">....Z..Z|
+000000b0  f0 6e fe 2a 2c 61 6b cb  9b d3 ad ea 78 c1 9e a2  |.n.*,ak.....x...|
+000000c0  fb 5a 9c e0 d7 0e fb 33  ca 9a ed 2b f9 b2 e8 bf  |.Z.....3...+....|
+000000d0  82 2c 28 09 fd 44 cd 30  b0 e4 a8 5c 8f 28 d1 f5  |.,(..D.0...\.(..|
+000000e0  93 46 33 bd ba 18 ff e5  45 19 da 52 34 48 15 7f  |.F3.....E..R4H..|
+000000f0  39 bd 78 66 9d e4 fd af  58 59 44 8a 46 cc 2c 37  |9.xf....XYD.F.,7|
+00000100  95 26 20 dd 14 65 73 d2  3c 25 e2 54 21 be c5 f6  |.& ..es.<%.T!...|
+00000110  a1 9a 94 e8 41 aa 4b 75  b7 f8 03 78 a4 8a b8 28  |....A.Ku...x...(|
+00000120  7f 72 17 60 37 07 a5 2a  dd 65 34 97 9c ee 72 27  |.r.`7..*.e4...r'|
+00000130  29 14 d8 b9 ed fc 4d fa  df 8b a9 7f 7f           |).....M......|
 >>> Flow 8 (server to client)
-00000000  16 03 03 00 85 10 dc 85  7d 1e 66 b2 a4 86 68 a7  |........}.f...h.|
-00000010  31 f3 b1 d8 c7 c9 26 6d  74 0a c0 c0 c0 39 ad b5  |1.....&mt....9..|
-00000020  1b b1 dc d3 15 9f a4 96  27 dd 65 85 ad 83 2f 97  |........'.e.../.|
-00000030  42 6f 8a 9b 58 fc f8 1b  54 89 cd 9c 11 10 b9 1d  |Bo..X...T.......|
-00000040  c3 e1 8e 89 20 a5 2d 0b  31 b5 e0 16 54 ce 93 9b  |.... .-.1...T...|
-00000050  de cc b1 af 48 48 33 96  4d a6 00 78 7b 60 3f 7c  |....HH3.M..x{`?||
-00000060  cd 86 64 5e 38 e8 fd 60  d4 b1 89 cd e4 fb 42 b5  |..d^8..`......B.|
-00000070  82 8f e5 23 91 87 6d 54  9e 85 37 34 df ae 70 a5  |...#..mT..74..p.|
-00000080  cd 4c de 95 f7 9f a9 b4  87 0b 16 03 03 02 69 d1  |.L............i.|
-00000090  c2 87 4e c8 26 b3 89 88  da c0 b9 24 84 88 c0 76  |..N.&......$...v|
-000000a0  94 08 eb 56 5d fc 96 81  18 f3 5b 90 f1 38 e5 ae  |...V].....[..8..|
-000000b0  b5 4e 9a c1 19 19 1a b3  40 55 08 cb 0e 3b 93 b3  |.N......@U...;..|
-000000c0  d7 74 80 3a 7c 0d eb be  70 0e a9 50 88 d2 52 11  |.t.:|...p..P..R.|
-000000d0  2d 55 cf d9 9d aa 92 bd  15 ab 1a 62 b3 26 09 3f  |-U.........b.&.?|
-000000e0  50 2b b8 f2 00 a2 5a 2b  98 e3 bb e2 c7 0b 07 0e  |P+....Z+........|
-000000f0  5a e5 2e 08 27 87 f3 0b  1b f7 f7 82 49 cf 08 d6  |Z...'.......I...|
-00000100  7c 78 39 0e 92 e7 28 f4  8f 12 ac 6a c2 72 46 e8  ||x9...(....j.rF.|
-00000110  92 bf 36 c7 52 46 7a 01  92 6d a9 08 19 2a 07 70  |..6.RFz..m...*.p|
-00000120  8c b2 40 7d 7f 00 27 ea  fb e6 24 5c d2 d8 ae 99  |..@}..'...$\....|
-00000130  0b cc 2a 4b 35 12 de 85  e9 b5 e2 2d 80 39 6d 17  |..*K5......-.9m.|
-00000140  7a ca ef ca bb 58 1e 13  86 10 bc 4d 8a df 32 ba  |z....X.....M..2.|
-00000150  3b 7e f5 40 ec af 2e 63  be f3 38 02 a9 9d 30 1f  |;~.@...c..8...0.|
-00000160  c4 d2 04 93 df e1 8a bb  5d f0 6a a8 d9 b9 ad bf  |........].j.....|
-00000170  da d6 5e bd a1 a8 b8 20  91 26 ab 50 fd 2b bf e1  |..^.... .&.P.+..|
-00000180  56 33 e3 e4 4f 3f 21 ea  86 10 e9 35 84 03 70 0b  |V3..O?!....5..p.|
-00000190  bd dc 44 fc 58 1d bc 9e  3a 0d 3b 61 13 d6 33 1b  |..D.X...:.;a..3.|
-000001a0  97 a8 67 bf e6 d9 1d 34  69 70 93 4a 6c 28 88 01  |..g....4ip.Jl(..|
-000001b0  01 9d 78 59 c0 58 66 c3  70 e4 ba 74 e6 0f f7 27  |..xY.Xf.p..t...'|
-000001c0  8b dd 05 ac 0d 99 dc e9  c8 2f 16 ee 59 53 91 d7  |........./..YS..|
-000001d0  28 27 db ad 85 e6 d0 72  28 81 31 e1 e7 bf dd 95  |('.....r(.1.....|
-000001e0  75 ff d6 a9 dc 4f 30 37  52 07 87 cb 8d a7 4a 00  |u....O07R.....J.|
-000001f0  22 53 3c 6d 91 94 11 5d  0a a8 21 ea 1f 18 4e 42  |"S<m...]..!...NB|
-00000200  1f 11 ea 17 55 c5 0c e2  41 e2 1f 2b 7b 4c d7 72  |....U...A..+{L.r|
-00000210  04 d6 64 45 e4 48 03 d7  ca ea 2b 78 0c 9b 03 b0  |..dE.H....+x....|
-00000220  c6 14 cc d8 89 d4 4d 4a  82 b2 e4 69 e9 2e 7f cf  |......MJ...i....|
-00000230  fa 4c b8 22 85 34 ed 97  a3 71 4d ba d7 25 b1 f6  |.L.".4...qM..%..|
-00000240  1c 47 99 75 7c 34 63 10  11 be 93 bb 0b 67 be 6f  |.G.u|4c......g.o|
-00000250  7b 41 c8 41 95 ca 4f ea  02 3d 37 5e fc 0e 12 67  |{A.A..O..=7^...g|
-00000260  84 4d be 41 6f 72 b3 e8  8b 3d 8f 71 a1 f4 f7 02  |.M.Aor...=.q....|
-00000270  23 66 88 29 5f d0 51 a2  c2 50 d7 cd bd bf f6 54  |#f.)_.Q..P.....T|
-00000280  96 7f 26 44 16 ec f5 b7  52 11 ef a1 7e 8c 4e 22  |..&D....R...~.N"|
-00000290  ed ac 1b 46 58 1a 52 ed  2c 79 64 a9 ae 8b 6c e0  |...FX.R.,yd...l.|
-000002a0  2c 51 c3 cc 49 7a 90 cf  68 74 ea 59 29 f6 bb 29  |,Q..Iz..ht.Y)..)|
-000002b0  b7 a9 bf 02 a3 94 d4 50  00 c0 98 30 1f 4a 72 46  |.......P...0.JrF|
-000002c0  de c6 aa c9 f8 b4 2b 16  38 cd 9f 39 af e4 22 37  |......+.8..9.."7|
-000002d0  4c 5a ec e0 14 bc 11 ef  db db 71 6f 8e a9 6d 17  |LZ........qo..m.|
-000002e0  cf 9b ae c3 e0 2f d4 80  f8 be 4f 9d 87 53 fd 53  |...../....O..S.S|
-000002f0  b6 a2 cf b9 8e 56 85 39  16 03 03 00 bc 63 23 39  |.....V.9.....c#9|
-00000300  de e9 93 fb f0 9b 64 b6  5e 7c a0 47 f6 b3 99 16  |......d.^|.G....|
-00000310  1c 68 f3 f6 3f bd a0 fc  80 09 6d 95 9a 17 65 e0  |.h..?.....m...e.|
-00000320  c2 ee fa cf fd af d8 05  5c 17 f1 1f a3 1c f2 47  |........\......G|
-00000330  87 a4 07 0a aa b6 6a 21  41 96 14 85 ea d0 d5 67  |......j!A......g|
-00000340  4e c2 53 fc 2a b5 5d 48  f8 f7 02 66 89 cc 7e df  |N.S.*.]H...f..~.|
-00000350  6f 8c d8 2d ac 64 3f 48  5b dc 25 38 8b 95 37 58  |o..-.d?H[.%8..7X|
-00000360  ae a9 c8 ac 91 a1 1f fb  d1 24 6b c2 13 c8 00 fd  |.........$k.....|
-00000370  14 73 d1 13 a6 17 28 93  f0 67 05 9c 90 5d 13 e0  |.s....(..g...]..|
-00000380  b4 26 16 80 23 5c a8 b6  3e f0 80 b5 41 db f0 ef  |.&..#\..>...A...|
-00000390  37 c3 62 b5 30 89 4d b6  6c 5c f2 8c ff 3c 2e 48  |7.b.0.M.l\...<.H|
-000003a0  bf 0f 5f 3e e0 b2 d7 64  2b dc 42 ad 2f 83 b5 6b  |.._>...d+.B./..k|
-000003b0  5a 04 51 f8 c4 07 c2 61  e4 16 03 03 00 4a a9 18  |Z.Q....a.....J..|
-000003c0  58 79 d8 ad 86 d7 b6 77  39 76 99 b4 0a 29 72 b1  |Xy.....w9v...)r.|
-000003d0  eb c3 ec 95 4d 30 4c 21  1a 7f 52 da 56 21 78 b7  |....M0L!..R.V!x.|
-000003e0  fe dd d3 0e fc a9 89 40  99 97 12 68 7e 28 6e 32  |.......@...h~(n2|
-000003f0  5b c0 e8 b4 42 eb ee 83  c2 ae 0d 28 99 48 46 a9  |[...B......(.HF.|
-00000400  64 38 60 59 c2 dc 5c 7b  16 03 03 00 14 78 72 cf  |d8`Y..\{.....xr.|
-00000410  ac 5d 53 7e 73 b1 6e e2  0a 8e 12 33 be 03 86 6a  |.]S~s.n....3...j|
-00000420  ce                                                |.|
+00000000  16 03 03 00 85 f4 88 c2  bb 0e c4 2f bc 16 6e 10  |.........../..n.|
+00000010  80 16 34 b2 20 c8 8f 01  64 1a 78 f9 0b d4 b9 4d  |..4. ...d.x....M|
+00000020  97 52 5e 79 86 37 c1 db  ae 6f 7a 41 d4 6f 44 0a  |.R^y.7...ozA.oD.|
+00000030  79 e6 56 02 03 e4 ff 65  cc 7f 95 08 c8 e7 bc 77  |y.V....e.......w|
+00000040  7c 7a 3f 85 04 37 50 55  6c 5f 43 b2 28 9e b5 55  ||z?..7PUl_C.(..U|
+00000050  f6 a7 3c 9a e3 ef 40 76  14 6e 22 1d 09 3f d1 7c  |..<...@v.n"..?.||
+00000060  ba 89 7c 5f e7 91 c3 e8  22 c3 a4 77 e4 da e7 63  |..|_...."..w...c|
+00000070  de ea 1b 1f a8 f2 27 a9  ec 95 03 ef b7 96 64 cf  |......'.......d.|
+00000080  56 56 58 a4 8f c0 f7 58  60 55 16 03 03 02 69 64  |VVX....X`U....id|
+00000090  1f e8 68 47 de 6d 1f 7b  ed 24 0d 7b b4 7e 45 fd  |..hG.m.{.$.{.~E.|
+000000a0  0e 76 9e b8 58 0e fb 00  b1 29 74 93 ce 54 29 e4  |.v..X....)t..T).|
+000000b0  bb 72 1d ea b7 a0 5e d2  b6 31 de 0d c5 72 8c 75  |.r....^..1...r.u|
+000000c0  13 17 41 b6 96 2b e7 f4  4f c4 3f 18 d9 3b 74 65  |..A..+..O.?..;te|
+000000d0  dd 7a df 4f b6 5b 95 ff  24 13 a4 84 15 89 d7 cc  |.z.O.[..$.......|
+000000e0  fc 26 2f e9 8c e6 89 9d  9f d8 65 46 63 5e a0 1d  |.&/.......eFc^..|
+000000f0  2e 50 65 f6 6d df 65 3c  a6 87 c5 65 e5 76 5d 31  |.Pe.m.e<...e.v]1|
+00000100  0d f5 54 4a 05 ec 19 0a  25 54 54 7b ab 34 fb df  |..TJ....%TT{.4..|
+00000110  d2 91 f5 06 36 77 39 1a  67 ab d7 c9 41 a2 eb f4  |....6w9.g...A...|
+00000120  ce c5 3e 0a 02 d8 c7 e0  48 99 2a 2b 2d 97 74 03  |..>.....H.*+-.t.|
+00000130  64 9b 8c d3 fc 65 17 ce  5a 20 2d 66 e9 9a a6 bc  |d....e..Z -f....|
+00000140  48 3c 08 65 d3 6f 47 c7  76 b1 59 6a b0 1c 45 b4  |H<.e.oG.v.Yj..E.|
+00000150  24 9d 71 83 fb 49 96 cb  c4 b9 8a 52 9a 28 92 66  |$.q..I.....R.(.f|
+00000160  6e ef 7c a9 a8 88 d5 16  de 96 8e 67 89 cf 62 12  |n.|........g..b.|
+00000170  93 63 7f e1 b0 76 0b 49  1a 61 af 02 e7 a0 51 9f  |.c...v.I.a....Q.|
+00000180  70 41 45 6f b1 d3 f8 cd  ce d5 d0 a7 e1 f3 1e 7c  |pAEo...........||
+00000190  50 20 ab 03 13 de 4c 1e  b4 f3 6b 21 3f 41 99 4d  |P ....L...k!?A.M|
+000001a0  d0 ca cd de 88 a1 bc 56  72 63 e8 55 c1 31 72 b2  |.......Vrc.U.1r.|
+000001b0  b2 a3 ea cf 39 8b 7f 82  55 1a 05 fb 6b c3 b7 6d  |....9...U...k..m|
+000001c0  08 0f 2a 34 ad 74 10 e0  4a 53 80 f7 98 a4 d6 f1  |..*4.t..JS......|
+000001d0  9c e5 9a 61 a0 f0 ca 30  54 f3 d9 a7 c4 54 08 3c  |...a...0T....T.<|
+000001e0  23 30 f5 3e c6 96 2c 97  84 7c 3d 13 0c 4a e6 0f  |#0.>..,..|=..J..|
+000001f0  ea 99 9c ba e5 34 a2 e6  74 e5 c0 86 d1 4e d4 ed  |.....4..t....N..|
+00000200  a1 e2 81 0a cc ec f8 d2  0a 0d 53 87 d7 d7 cc 75  |..........S....u|
+00000210  6d a8 c0 25 de 31 f3 cb  08 71 f0 e3 5e 7f d0 5c  |m..%.1...q..^..\|
+00000220  fb 48 1a a4 f9 70 08 14  a3 3b 90 87 94 0c 70 df  |.H...p...;....p.|
+00000230  9d b6 db 94 55 99 ac 18  df d1 d5 8c 16 8c c9 25  |....U..........%|
+00000240  2d 78 60 69 66 fb 0d 09  39 18 aa 77 b2 fb ed d1  |-x`if...9..w....|
+00000250  58 d5 53 6a 32 05 6f cc  35 16 6f 19 98 31 f4 36  |X.Sj2.o.5.o..1.6|
+00000260  af 1b 88 39 ad 3b a9 46  b5 49 b3 8e 26 76 ab 02  |...9.;.F.I..&v..|
+00000270  a4 ba f3 29 e5 08 f9 47  a6 b4 f0 ad 4d 70 c6 80  |...)...G....Mp..|
+00000280  ab 33 c7 5a 57 a7 40 37  6b 53 96 e9 35 88 78 bf  |.3.ZW.@7kS..5.x.|
+00000290  dd 81 f8 2f 9c 4d c1 d1  ce 45 16 a4 fb 57 bd ff  |.../.M...E...W..|
+000002a0  67 1c 3f 3f d2 49 89 a2  f3 b3 b9 4b 74 04 c4 e5  |g.??.I.....Kt...|
+000002b0  83 7c ff 9f a0 6b d2 c3  6a 07 ab 91 65 40 ba 20  |.|...k..j...e@. |
+000002c0  7a 59 f1 66 ba f8 47 b1  ab 03 96 c3 e2 57 8d f5  |zY.f..G......W..|
+000002d0  a6 43 a3 6b 6b 9d 42 18  9b 6a 41 09 75 db 8b b7  |.C.kk.B..jA.u...|
+000002e0  7a a6 0e 7e d4 ee da a8  eb 8b 0d 39 8a 1d 6e b5  |z..~.......9..n.|
+000002f0  9b 6a b1 57 f9 9d ec 01  16 03 03 00 bc 5a c0 bc  |.j.W.........Z..|
+00000300  54 9d 60 e3 68 3c 67 38  46 de cb 1f f0 fb 11 90  |T.`.h<g8F.......|
+00000310  10 b6 1b 7a dc f5 91 9c  74 c2 42 91 06 a2 98 17  |...z....t.B.....|
+00000320  27 d0 16 06 3f 02 f6 8e  fb 4c 64 d0 5d 42 06 cd  |'...?....Ld.]B..|
+00000330  aa 11 ec 78 e0 6b d9 97  c0 0f fc 27 9d 8d 8d 8d  |...x.k.....'....|
+00000340  89 cd c3 43 57 86 83 48  d5 00 3b 2b e2 7f 57 48  |...CW..H..;+..WH|
+00000350  4d 11 5e 7a 08 1b f9 01  9a 8e dc 0f c0 a9 9d b7  |M.^z............|
+00000360  86 09 5d 40 3c 12 60 b0  9f 08 26 f2 86 9b 4f 99  |..]@<.`...&...O.|
+00000370  50 f7 9c d6 ff f0 a8 ce  ca 17 57 7a 55 12 fb 5a  |P.........WzU..Z|
+00000380  82 9a fb 3d 05 16 7d 72  9f e5 a1 38 e3 ac fd 72  |...=..}r...8...r|
+00000390  af b0 60 5a ce 67 d9 8e  dc 16 19 17 c7 d6 19 a2  |..`Z.g..........|
+000003a0  a4 97 fe b3 a2 4f 1d 8a  99 72 8f c0 b7 a1 e1 9d  |.....O...r......|
+000003b0  9f 71 fb 90 f5 33 5f c6  e3 16 03 03 00 4a 21 2b  |.q...3_......J!+|
+000003c0  fd 5e f3 e5 f3 86 94 aa  e9 b1 29 a8 dd 96 02 28  |.^........)....(|
+000003d0  e9 8a 82 64 cb 22 06 72  5f 33 f7 70 1b 2a c4 8a  |...d.".r_3.p.*..|
+000003e0  06 fc ee 04 e8 34 d9 88  87 7c 15 7c ce 0d 04 88  |.....4...|.|....|
+000003f0  3c 56 aa 22 57 2f b8 52  eb d8 4c af 34 94 c1 9a  |<V."W/.R..L.4...|
+00000400  a0 ad f2 8d cd 3a a2 5d  16 03 03 00 14 34 4d ae  |.....:.].....4M.|
+00000410  1e 00 57 a0 80 d9 7a e6  04 1e 03 43 1f d5 49 87  |..W...z....C..I.|
+00000420  b7                                                |.|
 >>> Flow 9 (client to server)
-00000000  16 03 03 02 69 33 a1 bb  7d ff 23 ba ad dc a0 1e  |....i3..}.#.....|
-00000010  3c 7c 1f 53 59 81 13 04  49 f7 6e bf 8f ef 11 92  |<|.SY...I.n.....|
-00000020  51 bf 8a e7 fe ef 76 e4  f8 88 27 95 f4 12 f2 ed  |Q.....v...'.....|
-00000030  cc ec a6 2d 10 87 19 5e  c9 fe cd 12 ae 1a 38 f9  |...-...^......8.|
-00000040  78 f1 42 f8 47 26 1b c2  5f 82 a5 aa 65 17 eb 06  |x.B.G&.._...e...|
-00000050  03 c8 22 9c 9f 8b 87 26  4a 64 18 93 9c f4 16 82  |.."....&Jd......|
-00000060  28 eb 8d 2d f8 51 60 3a  f4 bb a3 77 f5 97 2b 6a  |(..-.Q`:...w..+j|
-00000070  19 db 2e 46 8b d8 08 d8  28 88 bb bd d8 3b c2 bb  |...F....(....;..|
-00000080  8c 87 1b 17 a0 34 a8 c6  e8 a5 a0 e5 cb d6 9c 9d  |.....4..........|
-00000090  a6 a4 6c 06 6a 85 0c 5e  ef 0c 97 6f b6 11 e7 4d  |..l.j..^...o...M|
-000000a0  60 91 95 74 48 af 1b 0b  47 03 ed 47 e9 b9 28 36  |`..tH...G..G..(6|
-000000b0  74 0d 8a b8 1e 5d 1c cb  ea 7b b7 8f 18 e3 b9 b9  |t....]...{......|
-000000c0  43 ed 53 f2 bf 7e 8c 8f  e6 c0 2a f4 31 25 f5 e8  |C.S..~....*.1%..|
-000000d0  44 48 2d 36 4f a7 11 f6  ea 7c 3f d6 2d 5d 3e 39  |DH-6O....|?.-]>9|
-000000e0  fb 50 f1 c9 eb 25 be 7a  c5 af 54 f5 12 07 04 22  |.P...%.z..T...."|
-000000f0  ec 68 45 f1 fd d1 91 0a  cf 64 0f f3 58 4e e8 ce  |.hE......d..XN..|
-00000100  f6 9e c0 57 ea 3a bd a0  5d 26 d4 ab ed 1a 34 12  |...W.:..]&....4.|
-00000110  9f fa ec 73 d6 38 06 78  85 3c f9 cd aa fb fd 32  |...s.8.x.<.....2|
-00000120  cb e0 a7 d0 bb 71 b0 a3  d2 b9 89 5e a9 57 18 7e  |.....q.....^.W.~|
-00000130  c0 c9 2e e3 e5 07 65 6f  4c ad 22 78 50 f2 87 0f  |......eoL."xP...|
-00000140  cd 93 b3 19 a9 73 e2 1d  bf 38 a0 20 8d 3a 3a 4e  |.....s...8. .::N|
-00000150  b3 02 b7 11 1f df 12 60  dd 10 1c f8 75 4a 52 86  |.......`....uJR.|
-00000160  71 61 88 37 b3 bf f7 2d  45 6d 10 4a 9f 80 b3 fc  |qa.7...-Em.J....|
-00000170  36 d4 d3 9f 08 f2 bb ce  9c 3a 9a 59 f6 0a 0a aa  |6........:.Y....|
-00000180  7f 61 29 0b df 29 92 09  55 ec 1c 84 d6 1f 7c 68  |.a)..)..U.....|h|
-00000190  72 00 88 5e e3 6a ee 35  45 7a 0b 49 35 0e 2d 7c  |r..^.j.5Ez.I5.-||
-000001a0  ac 8b 9f 9c 94 48 2d 1e  74 24 68 14 8e 16 b4 06  |.....H-.t$h.....|
-000001b0  24 66 a3 18 f4 ff 21 31  4b 9b bb 09 8a 9d 57 e4  |$f....!1K.....W.|
-000001c0  a1 5c ae f1 e1 4b 5c 2a  be 64 3c 7a 61 10 3d 73  |.\...K\*.d<za.=s|
-000001d0  76 94 27 e9 8c 9a 8f 14  9e 9f cb 75 7e 73 14 e0  |v.'........u~s..|
-000001e0  7d 78 90 3d a7 2d cb df  db 2b eb b6 b1 01 aa e4  |}x.=.-...+......|
-000001f0  5f 7f 39 7e eb e9 79 14  07 fa 9d d9 b6 4b 0d 7a  |_.9~..y......K.z|
-00000200  e7 ea 17 d5 c8 0b bd 12  c3 2d fa b1 cc 36 97 a3  |.........-...6..|
-00000210  c3 ac 03 70 f7 47 6d 79  af 96 8f c0 8b b1 84 b7  |...p.Gmy........|
-00000220  51 e5 f8 80 e5 de 8a 78  5c 9e 0a cd 0c c9 e0 27  |Q......x\......'|
-00000230  bc 9a 9b 88 f2 94 9d 3f  a2 a7 72 81 43 3f ca fd  |.......?..r.C?..|
-00000240  19 ba d1 aa 73 0f 5c 70  67 b7 38 68 18 99 e8 e8  |....s.\pg.8h....|
-00000250  51 8a 30 68 81 cc 1b ed  41 46 5d d4 cc 37 9f 8a  |Q.0h....AF]..7..|
-00000260  af 70 96 15 22 2e 5c 0d  d0 9b e9 c3 f6 76 16 03  |.p..".\......v..|
-00000270  03 00 35 e7 e7 b7 b8 af  17 8f 2f 52 a9 1c 9a 33  |..5......./R...3|
-00000280  c5 e9 3d b3 b7 25 5b 80  c1 6e 71 c8 44 bd 27 32  |..=..%[..nq.D.'2|
-00000290  16 44 ee 64 a9 1c 6e 4c  84 55 33 a0 d4 5b fc 94  |.D.d..nL.U3..[..|
-000002a0  77 15 ff 82 11 af a4 f7  16 03 03 00 98 c0 03 0e  |w...............|
-000002b0  00 a5 45 5a 08 4b fd a8  d0 1b d1 f0 12 e3 62 dd  |..EZ.K........b.|
-000002c0  91 dc 81 b2 6a 51 e3 d9  16 4c 48 c4 9a 66 bb 46  |....jQ...LH..f.F|
-000002d0  f9 e1 58 04 f7 47 18 ed  6d 4a 78 78 6e 84 b2 38  |..X..G..mJxxn..8|
-000002e0  e2 51 a6 3a 4c fe 76 d9  ef 3e b2 d9 b2 c0 5e 4f  |.Q.:L.v..>....^O|
-000002f0  f7 4b 38 70 d0 82 42 f2  5a c9 34 d2 76 7b 8d e4  |.K8p..B.Z.4.v{..|
-00000300  0b c7 3d be 86 7d 21 8c  f8 9f 1a 4a dc 48 07 12  |..=..}!....J.H..|
-00000310  ab 4c 98 f7 8b 3e 02 49  c2 d1 b5 e9 9a e0 5a 74  |.L...>.I......Zt|
-00000320  58 ce a3 33 be 0f ca 12  54 a2 0e a9 e5 22 8f 82  |X..3....T...."..|
-00000330  df 1a 3e 21 bf 66 c6 13  39 77 83 95 b1 4b 1d d3  |..>!.f..9w...K..|
-00000340  32 69 24 c2 89 14 03 03  00 11 1c eb 63 31 c9 c9  |2i$.........c1..|
-00000350  8a e3 8b 25 7e e9 b7 7d  19 03 3c 16 03 03 00 20  |...%~..}..<.... |
-00000360  c6 41 57 04 ab e8 6c 55  0b dc cd 06 f5 b3 4b 95  |.AW...lU......K.|
-00000370  40 b5 04 47 da 71 d7 70  ce d6 2e 0b c7 66 16 3c  |@..G.q.p.....f.<|
+00000000  16 03 03 02 69 3d ff d3  96 89 9f 41 3d 64 0c 71  |....i=.....A=d.q|
+00000010  e5 80 34 1f 5d 8a cb b4  47 08 c8 c0 7d 17 3b db  |..4.]...G...}.;.|
+00000020  d4 d1 9d 98 16 b9 84 73  c9 8a ff 76 bf 1e f0 bd  |.......s...v....|
+00000030  da 35 a8 2a d5 6a 28 cf  66 bf e0 dc 45 a9 8f 61  |.5.*.j(.f...E..a|
+00000040  65 75 99 29 fe 5a c8 46  2e 14 10 79 a2 b9 c9 04  |eu.).Z.F...y....|
+00000050  37 f8 01 8e 72 2b b7 c9  23 75 51 59 b9 8d 4a 87  |7...r+..#uQY..J.|
+00000060  9d 54 5d 70 25 66 5b 70  a7 04 e4 c0 6a e9 25 8f  |.T]p%f[p....j.%.|
+00000070  1b e0 39 59 b4 f3 0a 3b  42 bd 25 f3 e3 38 45 d6  |..9Y...;B.%..8E.|
+00000080  d9 22 b6 1f 40 72 19 2d  c6 1d 22 66 c5 cb 10 2c  |."..@r.-.."f...,|
+00000090  1c 6a f8 fc ca f3 b4 f1  d2 e5 cf 7b ef 89 e6 9b  |.j.........{....|
+000000a0  c5 5e 4e 83 6b 55 2f 01  da ad d4 3c 91 d4 17 f2  |.^N.kU/....<....|
+000000b0  8c ee ae e1 6c b4 c9 9d  33 b1 7c d3 e4 61 72 8f  |....l...3.|..ar.|
+000000c0  81 26 8f b9 c5 3f ca 42  00 16 57 1c 9a d2 37 80  |.&...?.B..W...7.|
+000000d0  76 47 b7 59 3c 39 b6 d2  0b 83 45 d1 3e 4d c4 8d  |vG.Y<9....E.>M..|
+000000e0  24 8f 95 f6 44 2f 45 70  69 6f 82 13 f7 42 a2 de  |$...D/Epio...B..|
+000000f0  bb 86 af c3 b1 eb aa 34  ae 5d fb c2 e1 5c 87 d1  |.......4.]...\..|
+00000100  2b f4 36 1f da cf 94 b7  fd 78 de 96 0a cd f5 80  |+.6......x......|
+00000110  6d a5 7c fa a0 1a dd aa  ef 0f 4c 7a cc 10 33 e0  |m.|.......Lz..3.|
+00000120  be c1 1c 9e 3f e0 4c a8  93 95 da 5d 01 bd a8 84  |....?.L....]....|
+00000130  8b e8 53 c2 69 04 92 fa  54 16 38 d7 82 17 07 da  |..S.i...T.8.....|
+00000140  71 af 5d 82 72 3d 6b 10  fd 46 b5 a2 8d 6e fe f8  |q.].r=k..F...n..|
+00000150  65 4a 48 6f 2e e3 8d b9  97 23 7f 51 ec 32 07 3b  |eJHo.....#.Q.2.;|
+00000160  1c df 26 be 29 e7 95 77  ed 1e d0 b2 d9 68 e4 65  |..&.)..w.....h.e|
+00000170  5b e7 97 58 ec 50 0c d1  e1 6e 76 73 d5 7b 37 41  |[..X.P...nvs.{7A|
+00000180  03 03 dd 07 53 48 d6 8c  d5 69 83 05 06 1e 59 54  |....SH...i....YT|
+00000190  9a cb 50 c5 55 12 23 47  57 83 50 83 58 ec 97 95  |..P.U.#GW.P.X...|
+000001a0  09 de e9 01 d7 62 43 eb  1d 80 82 08 c0 1e 7d d4  |.....bC.......}.|
+000001b0  6b d5 dd b7 0c 8d 7f 7c  2d ed f9 b1 16 38 ec b7  |k......|-....8..|
+000001c0  a0 1b 5a da a6 6f b2 59  ce ff d9 fc 9b 0c fc 16  |..Z..o.Y........|
+000001d0  27 5e 79 68 f8 3d 0b dc  bb 6d 9f 0d 4d 3b 19 d4  |'^yh.=...m..M;..|
+000001e0  0f 36 59 5f 41 c4 f6 9c  c1 47 f5 65 e0 d8 b1 06  |.6Y_A....G.e....|
+000001f0  3b 05 6c 90 fd f2 e8 b1  33 a9 1c a7 84 f4 e6 02  |;.l.....3.......|
+00000200  f3 80 2e 9f 81 13 01 ea  9f 09 f0 55 22 34 93 bf  |...........U"4..|
+00000210  b2 13 07 62 f0 fc 3e 08  b2 8d cb 62 64 33 a4 e6  |...b..>....bd3..|
+00000220  1c 26 ff 4e fe 28 3e 82  58 ce 82 a1 ef a4 14 f3  |.&.N.(>.X.......|
+00000230  81 59 e2 29 da 30 ef 1d  20 75 1a 7f 27 b5 90 be  |.Y.).0.. u..'...|
+00000240  40 fc 52 08 0a 62 c4 53  4f 6d e9 fb 96 81 8c 1e  |@.R..b.SOm......|
+00000250  3d 3f bc 87 fb fb 6c 8b  17 7a 14 38 53 df 0c ef  |=?....l..z.8S...|
+00000260  f4 12 24 fa 77 ce 0b 2a  ea 1d 1e 0c 8e 50 16 03  |..$.w..*.....P..|
+00000270  03 00 35 28 fe 49 cd b2  80 e8 65 78 83 02 1f 03  |..5(.I....ex....|
+00000280  75 ab 8c f6 cb c0 fa 86  8f 5e b2 63 f8 a4 37 b9  |u........^.c..7.|
+00000290  2b 82 9e 27 cb 82 97 c6  7c 90 cc de 19 d2 cc 7e  |+..'....|......~|
+000002a0  19 c1 5e da 99 87 05 31  16 03 03 00 98 09 f8 56  |..^....1.......V|
+000002b0  7f 7d 66 c3 a3 e0 e2 68  48 b6 38 cb 6c ca b9 28  |.}f....hH.8.l..(|
+000002c0  ff 5b 52 f9 7b 69 ba 92  a9 ba 25 7a 0a fe 97 3b  |.[R.{i....%z...;|
+000002d0  73 f2 b6 8b a7 cb d6 cf  9e da f1 ce d7 41 98 d3  |s............A..|
+000002e0  3d 59 ef 9c 14 78 e2 d7  46 0b 63 b2 aa 4e 02 1e  |=Y...x..F.c..N..|
+000002f0  40 78 a2 e6 55 c2 20 88  ab 0e bd a8 78 76 4d fe  |@x..U. .....xvM.|
+00000300  68 c4 ad c0 7e 9d 2b 0c  08 e9 0f 65 1c 9e 38 df  |h...~.+....e..8.|
+00000310  f9 07 1f 8a 6b 2c af 94  89 35 75 61 e9 5f 2b 90  |....k,...5ua._+.|
+00000320  b4 38 15 26 a1 ea 15 dc  76 09 0a 2b ff 2d 42 ab  |.8.&....v..+.-B.|
+00000330  b5 f7 37 ce ec 34 8e 9a  55 b5 01 56 98 46 b7 1e  |..7..4..U..V.F..|
+00000340  07 30 0d 25 8a 14 03 03  00 11 c7 b7 3a b1 86 25  |.0.%........:..%|
+00000350  cf 3e a6 ce 37 36 65 11  b2 85 13 16 03 03 00 20  |.>..76e........ |
+00000360  c8 69 c3 d3 63 3d 94 1c  78 e2 b7 dd 84 b5 f9 2d  |.i..c=..x......-|
+00000370  d6 ed 39 fe 23 48 ee 7a  75 17 21 70 eb b8 96 56  |..9.#H.zu.!p...V|
 >>> Flow 10 (server to client)
-00000000  14 03 03 00 11 c0 4e fd  fa 3a 1c 4a 19 ce 08 f6  |......N..:.J....|
-00000010  da 70 56 fa 39 42 16 03  03 00 20 0c bc c4 5e 24  |.pV.9B.... ...^$|
-00000020  e3 0e c9 23 8c cd f6 a2  45 07 e6 93 40 7c c8 02  |...#....E...@|..|
-00000030  6e 24 f7 4e 06 9a ad ba  de cd 10 17 03 03 00 19  |n$.N............|
-00000040  52 e0 85 b3 46 25 7d fd  8f d0 4c ca df fe 2f a6  |R...F%}...L.../.|
-00000050  14 d6 08 82 70 0f 93 78  bf 16 03 03 00 14 ff 68  |....p..x.......h|
-00000060  f1 6d 8d b4 5f 74 19 6b  e3 1e 6e ee 9d ee c2 34  |.m.._t.k..n....4|
-00000070  0f 44                                             |.D|
+00000000  14 03 03 00 11 ce 30 2f  ce ec 08 18 13 0f 64 04  |......0/......d.|
+00000010  6d a0 fb 38 04 17 16 03  03 00 20 03 cd 4e 30 0f  |m..8...... ..N0.|
+00000020  e3 c2 1c 52 7d 30 5f 57  e1 2f 50 7b 00 0b 8a 05  |...R}0_W./P{....|
+00000030  2e 4b 15 23 fd e6 82 35  ac 96 5f 17 03 03 00 19  |.K.#...5.._.....|
+00000040  d9 71 23 60 2a 72 ac 2e  43 66 a9 7a a9 71 5f f3  |.q#`*r..Cf.z.q_.|
+00000050  c3 43 72 41 55 49 81 95  43 16 03 03 00 14 c0 af  |.CrAUI..C.......|
+00000060  63 ad 86 4c 8b 44 8d f1  e1 2c 4e b7 a5 54 b4 1d  |c..L.D...,N..T..|
+00000070  68 de                                             |h.|
 >>> Flow 11 (client to server)
-00000000  15 03 03 00 12 81 0d 63  a5 11 7a 03 ab 66 f6 c8  |.......c..z..f..|
-00000010  15 f3 d9 23 fa 67 6b 15  03 03 00 12 71 0e 3b 52  |...#.gk.....q.;R|
-00000020  1a 05 39 4c 8c 76 c3 a9  00 35 bd 66 80 a1        |..9L.v...5.f..|
+00000000  15 03 03 00 12 6d 7f 8e  31 17 7d 45 96 a9 b0 6e  |.....m..1.}E...n|
+00000010  e1 73 b3 f3 f6 51 9a 15  03 03 00 12 ad 22 dc 06  |.s...Q......."..|
+00000020  98 ee b2 2f 09 4b 40 25  84 65 60 88 2e db        |.../.K@%.e`...|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected b/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected
index 0be2e72bf3..f70978475e 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 21 15 e1 02 00  |....]...Y..!....|
-00000010  c6 0c e5 3f c9 6f a5 59  38 7e 13 81 1b 26 50 46  |...?.o.Y8~...&PF|
-00000020  bf 2b 95 0c eb a8 bc 72  97 bc 26 20 ad 6b 84 ac  |.+.....r..& .k..|
-00000030  8f 62 26 0b 4b d8 bf 1b  7d a5 27 3b 3e 45 a5 8f  |.b&.K...}.';>E..|
-00000040  37 fb b2 25 2c d3 82 69  ed d7 c9 f0 cc a8 00 00  |7..%,..i........|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 50 07 ee 50 d2  |....]...Y..P..P.|
+00000010  77 fa a1 bb 19 fa ea 54  12 26 62 e7 0c 84 b9 2e  |w......T.&b.....|
+00000020  b2 b8 c8 19 59 34 b4 3c  60 21 d9 20 4f 36 b8 c7  |....Y4.<`!. O6..|
+00000030  5c ae b8 11 14 0d 67 88  65 37 f1 a5 16 3a af 92  |\.....g.e7...:..|
+00000040  4d 39 ed 9c 20 1c e7 c1  40 e6 ba b8 cc a8 00 00  |M9.. ...@.......|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -61,36 +63,36 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 b2 3a 28  |............ .:(|
-000002d0  2e 2c 66 f1 9b 44 58 9a  92 03 42 81 f6 1c f4 67  |.,f..DX...B....g|
-000002e0  50 b5 92 f3 06 1b 1b 23  93 99 12 c5 6b 08 04 00  |P......#....k...|
-000002f0  80 44 05 ae 8d ed c6 82  3a 2a 19 05 9d 70 f9 ba  |.D......:*...p..|
-00000300  45 66 cb 45 75 9c da 92  cc bb 4a a5 ae 41 8c f8  |Ef.Eu.....J..A..|
-00000310  9b e7 06 73 88 9f f9 7d  95 ce 74 a6 05 e9 38 a5  |...s...}..t...8.|
-00000320  26 4b b2 26 31 5c e9 f9  a8 f8 6e 6b 05 e4 39 b5  |&K.&1\....nk..9.|
-00000330  fe b1 b1 cd 40 23 e9 68  f3 9c ed 91 71 d3 0b c5  |....@#.h....q...|
-00000340  91 c5 b2 91 69 a9 4b 2c  a7 0c 24 d6 a9 e7 74 89  |....i.K,..$...t.|
-00000350  9e ce 8b 00 72 9a c9 86  8b ca 8d 39 01 a0 71 3e  |....r......9..q>|
-00000360  46 ff a6 7d c6 da 0a af  f2 84 c4 01 1c 94 47 22  |F..}..........G"|
-00000370  71 16 03 03 00 04 0e 00  00 00                    |q.........|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 5d 84 3d  |............ ].=|
+000002d0  57 67 a5 0a 3d 25 81 c0  82 e0 b9 03 29 4e e1 87  |Wg..=%......)N..|
+000002e0  37 88 c8 9a 6d 7c 4b c9  22 5a ab 5e 68 08 04 00  |7...m|K."Z.^h...|
+000002f0  80 5d 80 99 26 5c 59 a0  7f f1 96 68 9e 02 11 1c  |.]..&\Y....h....|
+00000300  80 89 f1 50 d1 5c 7c 61  29 77 5e c1 4f 42 4b 03  |...P.\|a)w^.OBK.|
+00000310  0d 92 0d 20 c4 f9 e3 60  a7 de 90 b7 5a b8 3b 06  |... ...`....Z.;.|
+00000320  0a 21 4b 9b 5b e9 2f 85  dc 23 af 5a d0 76 0a 74  |.!K.[./..#.Z.v.t|
+00000330  02 64 32 b6 9a 93 d3 b8  65 04 94 f5 c5 be c2 7f  |.d2.....e.......|
+00000340  9b 76 af cf 1f 77 e0 31  3f 63 0e 0e 78 cd f7 9c  |.v...w.1?c..x...|
+00000350  e3 d4 52 e2 80 53 7f 53  35 10 21 b9 9e 48 92 e3  |..R..S.S5.!..H..|
+00000360  ba 7e 3c 13 0c 36 bc 56  3a 00 d3 13 c1 16 f8 33  |.~<..6.V:......3|
+00000370  68 16 03 03 00 04 0e 00  00 00                    |h.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 80 26 44  1c a7 83 b7 12 29 9a 44  |.... .&D.....).D|
-00000040  7b c1 0b 96 53 c8 0e 9b  dd 8d 29 4b 4b b8 75 d7  |{...S.....)KK.u.|
-00000050  0a c7 86 c7 d9                                    |.....|
+00000030  16 03 03 00 20 72 e5 4c  81 fd 78 39 f0 bb 37 cd  |.... r.L..x9..7.|
+00000040  b4 47 cb 1b 52 25 08 9a  ab ab 9b 28 d2 b4 72 eb  |.G..R%.....(..r.|
+00000050  b0 db 8f fe 29                                    |....)|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 2e d7 9e b0 66  |.......... ....f|
-00000010  f1 39 84 a9 d9 93 17 bd  94 5a 31 49 bb eb f0 a0  |.9.......Z1I....|
-00000020  7b af d0 3b ae 1a 5d f6  46 31 36                 |{..;..].F16|
+00000000  14 03 03 00 01 01 16 03  03 00 20 68 26 ca 41 0e  |.......... h&.A.|
+00000010  ab 2f 28 5d 9e 94 17 4f  9f 25 cb 82 aa 3a e5 40  |./(]...O.%...:.@|
+00000020  8a 35 6d a8 72 bf 25 2a  8a 6d 04                 |.5m.r.%*.m.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 cd 39 a7  64 3b 6a de 14 e0 26 ea  |......9.d;j...&.|
-00000010  66 b2 73 b1 8e b0 e3 a9  94 62 4f                 |f.s......bO|
+00000000  17 03 03 00 16 73 e1 3b  86 fb 05 16 9e a9 af 73  |.....s.;.......s|
+00000010  64 72 8b 02 a0 82 7d 70  16 5c d9                 |dr....}p.\.|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 14 c5 d7 88  58 81 44 1f 8d e4 c2 19  |........X.D.....|
-00000010  15 3b 5c 43 76 82 fe 03  e1                       |.;\Cv....|
+00000000  16 03 03 00 14 9b 44 8d  b3 1c 77 2c 12 e7 fe 76  |......D...w,...v|
+00000010  31 c9 ab e7 f0 be 32 0a  e3                       |1.....2..|
 >>> Flow 7 (client to server)
-00000000  15 03 03 00 12 d4 b1 0d  fa 41 25 ab d4 e1 b7 74  |.........A%....t|
-00000010  27 5c 8b c6 0d 49 8e 15  03 03 00 12 65 3d 4e 30  |'\...I......e=N0|
-00000020  48 43 8f f6 8b 89 45 af  f4 7a e4 eb ad a1        |HC....E..z....|
+00000000  15 03 03 00 12 00 54 e7  c6 54 b7 ec 24 d4 07 ad  |......T..T..$...|
+00000010  ff a7 39 d2 7b 62 ba 15  03 03 00 12 de ad f4 f7  |..9.{b..........|
+00000020  0b 8b a3 a3 e5 19 b6 45  63 6f dc 7d f3 c4        |.......Eco.}..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-SCT b/src/crypto/tls/testdata/Client-TLSv12-SCT
index 8ea2cd4622..399c5e9ec3 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-SCT
+++ b/src/crypto/tls/testdata/Client-TLSv12-SCT
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,23 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 01 ca 02 00 01  c6 03 03 da b0 57 a0 ee  |.............W..|
-00000010  bf 74 92 06 39 a6 9a 9b  80 71 7e 57 63 ab 31 74  |.t..9....q~Wc.1t|
-00000020  d3 22 c1 e3 a6 c6 cf 6f  47 57 49 20 86 52 fb 0a  |.".....oGWI .R..|
-00000030  fd aa 10 47 00 9a 5d ad  4c d8 90 f1 cf 13 10 73  |...G..].L......s|
-00000040  31 f1 df 22 f3 42 58 b0  10 25 43 eb cc a8 00 01  |1..".BX..%C.....|
+00000000  16 03 03 01 ca 02 00 01  c6 03 03 9a 84 91 7d 3b  |..............};|
+00000010  31 f1 28 b9 57 a3 5c ea  ac 1c 43 91 1a e3 1a 88  |1.(.W.\...C.....|
+00000020  29 b8 46 87 18 0a 9d 9e  f6 6a 94 20 45 98 c2 a1  |).F......j. E...|
+00000030  3f 98 33 0f b7 d0 e8 53  70 a5 01 4e 0b a1 3b 3a  |?.3....Sp..N..;:|
+00000040  e1 cd 07 a3 b0 96 eb 05  54 26 de d8 cc a8 00 01  |........T&......|
 00000050  7e 00 12 01 69 01 67 00  75 00 a4 b9 09 90 b4 18  |~...i.g.u.......|
 00000060  58 14 87 bb 13 a2 cc 67  70 0a 3c 35 98 04 f9 1b  |X......gp.<5....|
 00000070  df b8 e3 77 cd 0e c8 0d  dc 10 00 00 01 47 97 99  |...w.........G..|
@@ -84,31 +86,31 @@
 00000400  43 77 8d 0c 1c f1 0f a1  d8 40 83 61 c9 4c 72 2b  |Cw.......@.a.Lr+|
 00000410  9d ae db 46 06 06 4d f4  c1 b3 3e c0 d1 bd 42 d4  |...F..M...>...B.|
 00000420  db fe 3d 13 60 84 5c 21  d3 3b e9 fa e7 16 03 03  |..=.`.\!.;......|
-00000430  00 ac 0c 00 00 a8 03 00  1d 20 0e e6 72 88 cf d1  |......... ..r...|
-00000440  05 c7 8d 03 64 b9 db d8  c3 5e 36 80 67 67 36 94  |....d....^6.gg6.|
-00000450  5b b7 92 f9 77 1f 6f b2  44 7f 08 04 00 80 1d 3b  |[...w.o.D......;|
-00000460  70 d5 72 87 2f 58 20 da  29 e0 f8 e8 7c 8d e5 c7  |p.r./X .)...|...|
-00000470  bf da 3c 10 f8 b0 3e 38  7b 06 0b 8e 8f d7 40 b6  |..<...>8{.....@.|
-00000480  47 9f 1c 64 6e 80 ab 9d  51 92 8c 60 a2 88 c4 43  |G..dn...Q..`...C|
-00000490  7d dc 29 64 45 83 a7 9c  2a 39 e9 bb 2a d9 f5 96  |}.)dE...*9..*...|
-000004a0  4c fb fd 0d cc 0f 9b 48  f5 ee af 8f 7a 1c 39 3e  |L......H....z.9>|
-000004b0  cf 23 15 c6 ab c3 f2 29  fd 6c 4f 17 6b d4 be 1a  |.#.....).lO.k...|
-000004c0  23 6e 74 81 e5 e5 e8 c0  de 9b b0 ed d2 32 bc 2a  |#nt..........2.*|
-000004d0  b1 30 b2 eb ac 9e 23 f8  be ea 31 9a b4 55 16 03  |.0....#...1..U..|
+00000430  00 ac 0c 00 00 a8 03 00  1d 20 4e e0 4b c5 9b e7  |......... N.K...|
+00000440  1c 85 3a 3f 64 df cb 87  18 94 c2 e2 cd e9 db 5e  |..:?d..........^|
+00000450  44 11 ee e0 89 4d 11 62  57 1a 08 04 00 80 7d 99  |D....M.bW.....}.|
+00000460  22 49 98 12 7b 7c e7 73  99 dc c1 43 7d 6c ed 8d  |"I..{|.s...C}l..|
+00000470  7e f3 d5 66 76 0b cd 5e  5f cc 60 68 8e 8c 30 6f  |~..fv..^_.`h..0o|
+00000480  54 0d 46 ca da a0 82 44  30 fc f1 bc a4 54 a1 49  |T.F....D0....T.I|
+00000490  d1 17 e6 c5 dc fd 08 41  19 5a e1 5b 9a 93 3c 3b  |.......A.Z.[..<;|
+000004a0  3b 0f be 35 51 55 0e 54  1e dc 03 28 0b fa 49 9f  |;..5QU.T...(..I.|
+000004b0  cf c8 d6 18 79 f7 84 92  0a 37 9f b3 88 3a 46 d9  |....y....7...:F.|
+000004c0  dd 7b e5 2b 52 6c a8 06  ac b5 ba 29 32 82 fb eb  |.{.+Rl.....)2...|
+000004d0  62 78 c9 97 c7 5c 03 e9  26 2e 8d 23 db 35 16 03  |bx...\..&..#.5..|
 000004e0  03 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 a1 58 d5  1a a3 9f 85 4e b6 c8 b7  |.... .X.....N...|
-00000040  cb c1 b0 cc 0a 80 59 1d  81 41 cc 4d 0b d3 bd 38  |......Y..A.M...8|
-00000050  48 69 01 23 96                                    |Hi.#.|
+00000030  16 03 03 00 20 e4 20 73  0f 70 18 f9 ef a2 7a e3  |.... . s.p....z.|
+00000040  73 d2 8d 38 45 61 89 b5  b0 77 1c 39 ba f8 56 ec  |s..8Ea...w.9..V.|
+00000050  04 0b c6 fb 02                                    |.....|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 83 ae fc 0d dd  |.......... .....|
-00000010  a1 3a 55 b0 2e 5e 21 9c  57 f3 1b 94 80 6c 0e bb  |.:U..^!.W....l..|
-00000020  78 ae f4 6c 20 d5 7e 23  11 1e 7d                 |x..l .~#..}|
+00000000  14 03 03 00 01 01 16 03  03 00 20 a8 e6 38 02 7a  |.......... ..8.z|
+00000010  d2 1c ca b1 79 ae ba 10  b6 ab e2 5e 79 28 06 7f  |....y......^y(..|
+00000020  0c d4 17 fc e3 72 e2 bf  44 4b 5f                 |.....r..DK_|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 d3 16 a3  f0 93 49 44 d4 82 60 35  |..........ID..`5|
-00000010  e3 63 08 c0 4e 66 99 37  31 90 6c 15 03 03 00 12  |.c..Nf.71.l.....|
-00000020  3c ea 2c 19 34 7b cc 6c  7a a9 15 31 6f 9c 3b b0  |<.,.4{.lz..1o.;.|
-00000030  b2 1f                                             |..|
+00000000  17 03 03 00 16 00 04 dd  86 fc e7 8c c5 67 e6 0f  |.............g..|
+00000010  32 0a 60 1b f8 b6 1c e7  e1 96 8c 15 03 03 00 12  |2.`.............|
+00000020  35 71 48 37 fb f7 d1 3a  94 aa 3f ec c1 99 8a 7c  |5qH7...:..?....||
+00000030  20 4a                                             | J|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-X25519-ECDHE b/src/crypto/tls/testdata/Client-TLSv12-X25519-ECDHE
index c851eb1a1f..a0d9a5eb1b 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-X25519-ECDHE
+++ b/src/crypto/tls/testdata/Client-TLSv12-X25519-ECDHE
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 f8 01 00 00  f4 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 16 01 00 01  12 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,20 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 79 00 0b 00 02  01 00 ff 01 00 01 00 00  |...y............|
+00000080  01 00 00 97 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 04 00 02 00 1d  00 0d 00 1a 00 18 08 04  |................|
 000000b0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
-000000c0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
-000000d0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
-000000e0  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
-000000f0  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
+000000c0  06 03 02 01 02 03 00 32  00 1a 00 18 08 04 04 03  |.......2........|
+000000d0  08 07 08 05 08 06 04 01  05 01 06 01 05 03 06 03  |................|
+000000e0  02 01 02 03 00 2b 00 09  08 03 04 03 03 03 02 03  |.....+..........|
+000000f0  01 00 33 00 26 00 24 00  1d 00 20 2f e5 7d a3 47  |..3.&.$... /.}.G|
+00000100  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
+00000110  c4 cf c2 ed 90 99 5f 58  cb 3b 74                 |......_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 5d 02 00 00  59 03 03 e0 da ea 5e 09  |....]...Y.....^.|
-00000010  bb 30 4c 10 db 85 36 44  38 9e a4 83 74 5f 2f 94  |.0L...6D8...t_/.|
-00000020  a1 b4 45 61 73 2f 88 b3  ac ad e4 20 45 55 20 90  |..Eas/..... EU .|
-00000030  b0 b0 d4 70 e6 10 13 5c  f4 49 0e 9c 2a 52 5c 84  |...p...\.I..*R\.|
-00000040  b2 55 1a ea e3 4b 5a 9f  ac e9 7b 37 c0 2f 00 00  |.U...KZ...{7./..|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 c1 cb c6 9e f2  |....]...Y.......|
+00000010  92 cb ca eb 42 5a 30 c2  1a 3f d6 ca fc 69 b9 55  |....BZ0..?...i.U|
+00000020  86 21 dd 3f 1d 33 5c 97  a1 1f b9 20 46 58 d4 b8  |.!.?.3\.... FX..|
+00000030  c4 71 e6 30 97 a1 f3 fe  1c 7f ca cd bf c2 95 96  |.q.0............|
+00000040  ef 5c df 54 60 51 f6 e2  47 7c c5 bd c0 2f 00 00  |.\.T`Q..G|.../..|
 00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
 00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
 00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
@@ -60,33 +62,33 @@
 00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
 000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
 000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
-000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 ca 07 6e  |............ ..n|
-000002d0  67 12 8e f7 b4 55 c0 d4  88 73 35 f0 f1 ae c4 34  |g....U...s5....4|
-000002e0  59 dc 05 df 75 96 54 f1  4f 7f 79 93 25 08 04 00  |Y...u.T.O.y.%...|
-000002f0  80 d2 1d 65 15 23 74 e4  57 80 58 62 b5 6d ab 06  |...e.#t.W.Xb.m..|
-00000300  11 4c e0 a0 7b 7e b5 78  87 47 71 30 c3 d8 86 b2  |.L..{~.x.Gq0....|
-00000310  af 34 24 95 9c 2f 74 bb  6e c8 2a 8e 81 f8 fb d7  |.4$../t.n.*.....|
-00000320  06 06 dc e8 95 01 65 fe  5d cb 9e 7f 36 9b 29 40  |......e.]...6.)@|
-00000330  09 81 1b df 24 66 13 94  51 2a 48 31 e3 cb 3a 06  |....$f..Q*H1..:.|
-00000340  c9 9c f4 36 b8 c0 de c1  3e 5e 79 95 f8 11 4b d8  |...6....>^y...K.|
-00000350  0a b1 6c ef f4 ce 89 ba  df ad 24 3d 7c 48 aa 70  |..l.......$=|H.p|
-00000360  d8 0e 52 a8 12 1c 6b eb  5b c9 c3 a3 fa f0 60 d4  |..R...k.[.....`.|
-00000370  54 16 03 03 00 04 0e 00  00 00                    |T.........|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 d5 3e d5  |............ .>.|
+000002d0  c0 de 8f f1 12 8d 50 f2  97 d1 d6 1d b9 9f 7f 86  |......P.........|
+000002e0  00 38 c7 77 7b 65 44 7d  97 e4 61 a3 77 08 04 00  |.8.w{eD}..a.w...|
+000002f0  80 07 71 57 61 39 64 7c  d0 1e 5d 57 23 5c 18 0c  |..qWa9d|..]W#\..|
+00000300  46 c8 62 e0 41 5a f9 4f  1b 17 d9 25 64 53 9c 41  |F.b.AZ.O...%dS.A|
+00000310  ea 6a fc 01 69 92 4c d1  4e 98 4d c8 d2 7d 5a 8b  |.j..i.L.N.M..}Z.|
+00000320  19 46 9a 54 57 27 12 ba  f2 91 cb 0b 24 08 06 91  |.F.TW'......$...|
+00000330  c0 4d 5a 9e 45 e0 34 87  93 87 59 08 ae cb 5c 08  |.MZ.E.4...Y...\.|
+00000340  05 bf 71 f7 0c 04 57 b9  d4 9c 00 ec bb 55 ee c3  |..q...W......U..|
+00000350  56 ab f9 08 ab 14 f1 f9  27 85 f3 ea 85 26 db bc  |V.......'....&..|
+00000360  25 54 e8 ad 91 0e 07 f1  bc 48 ca c3 54 c2 da 3c  |%T.......H..T..<|
+00000370  26 16 03 03 00 04 0e 00  00 00                    |&.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 21 27 7f  |....(........!'.|
-00000040  32 c6 19 c4 a9 13 bf 5e  4b 53 5f c3 47 64 bb f8  |2......^KS_.Gd..|
-00000050  21 d5 10 12 12 60 5e d8  e8 cf 1e fe 18           |!....`^......|
+00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 1c bd 15  |....(...........|
+00000040  e4 c0 92 d5 1d 85 17 46  b8 46 6b 71 ef b4 36 9f  |.......F.Fkq..6.|
+00000050  f4 0c ca a6 81 f8 da 28  63 29 29 d6 2c           |.......(c)).,|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 af e6 ee d0 75  |..........(....u|
-00000010  df 97 22 b0 ff 46 8e 51  bb 23 70 8d 4a 22 01 b6  |.."..F.Q.#p.J"..|
-00000020  13 34 68 fd 69 fe 0a 0f  df 0e e6 41 48 49 8c e7  |.4h.i......AHI..|
-00000030  d3 21 13                                          |.!.|
+00000000  14 03 03 00 01 01 16 03  03 00 28 b7 b5 af 79 b7  |..........(...y.|
+00000010  68 6f d7 fa d6 0f 73 8a  51 ea 97 a4 2f b1 29 58  |ho....s.Q.../.)X|
+00000020  73 fd f2 15 17 c6 cd 1b  2d 1a 39 32 17 78 37 fe  |s.......-.92.x7.|
+00000030  87 71 da                                          |.q.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 10 16 77  |...............w|
-00000010  99 da 71 ef 78 16 d7 cd  2c 7b 71 ba 8a 74 c1 65  |..q.x...,{q..t.e|
-00000020  f2 f6 be 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
-00000030  72 d4 4a f6 6d 63 4c ad  02 46 36 18 61 47 61 7d  |r.J.mcL..F6.aGa}|
-00000040  50 08                                             |P.|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 a5 8f 5d  |...............]|
+00000010  59 44 d3 65 6c bd b1 68  3c d2 ee 1c 5d 8c 92 4c  |YD.el..h<...]..L|
+00000020  c2 89 f3 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
+00000030  33 c1 b3 d7 37 52 f7 57  3d 00 af 02 e0 e8 9b 6f  |3...7R.W=......o|
+00000040  ad 0f                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-AES128-SHA256 b/src/crypto/tls/testdata/Client-TLSv13-AES128-SHA256
index 6c7c3d4711..c6e3f37d2d 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-AES128-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv13-AES128-SHA256
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,85 +7,87 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 63 fa e1 78 d5  |....z...v..c..x.|
-00000010  53 77 64 44 97 45 79 94  e7 79 dd da 70 81 46 66  |SwdD.Ey..y..p.Ff|
-00000020  ac 7c 77 a2 f9 29 ca 48  e6 53 56 20 00 00 00 00  |.|w..).H.SV ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 75 19 d0 fb e3  |....z...v..u....|
+00000010  11 c7 2a 09 40 fb 18 4b  17 f8 94 3f 54 2b 33 c9  |..*.@..K...?T+3.|
+00000020  96 c6 46 72 a5 92 31 7d  d3 40 d3 20 00 00 00 00  |..Fr..1}.@. ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 01 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 36  |..+.....3.$... 6|
-00000060  e2 c3 a0 14 f4 9c 50 9c  08 03 5e c2 b8 4b 66 85  |......P...^..Kf.|
-00000070  71 fb bb 20 6e 97 3a f6  74 be 02 31 29 8e 18 14  |q.. n.:.t..1)...|
-00000080  03 03 00 01 01 17 03 03  00 17 00 79 2a 2d 44 f4  |...........y*-D.|
-00000090  12 2d 7c d6 8c 7a 27 76  a5 3a 6b c1 2d 40 8f 20  |.-|..z'v.:k.-@. |
-000000a0  8b 17 03 03 02 6d 6e 16  f8 0f d2 67 3b e8 1a 95  |.....mn....g;...|
-000000b0  2a ce 16 7b 95 21 7e 03  65 bf 01 ce e9 43 83 f6  |*..{.!~.e....C..|
-000000c0  0e a9 d2 f2 d1 a3 2f d4  55 d2 27 83 44 3d f9 72  |....../.U.'.D=.r|
-000000d0  00 8d 41 44 eb 93 ca 68  09 d1 bd f3 1a cc a0 53  |..AD...h.......S|
-000000e0  a7 18 6e b7 27 d0 f5 e1  08 d8 9f 7b 37 bc 8f b9  |..n.'......{7...|
-000000f0  84 6d e0 20 cf 99 bf c1  67 c8 00 74 4c 76 3e 2d  |.m. ....g..tLv>-|
-00000100  63 48 11 f1 75 30 ab a5  5b a2 cb 13 e9 e0 65 36  |cH..u0..[.....e6|
-00000110  86 ce 8b 64 f6 dc e1 b7  0d 16 96 d1 ec 4b 93 d5  |...d.........K..|
-00000120  6c 10 0d b7 d8 a2 45 b2  f0 e0 aa ab ab 11 8d d0  |l.....E.........|
-00000130  2c fc 20 35 99 1b d6 3b  72 6d 88 03 80 5c 59 d4  |,. 5...;rm...\Y.|
-00000140  04 18 ee 7a ed fe fb 52  c1 3c 93 95 e2 00 23 0d  |...z...R.<....#.|
-00000150  cc c1 4e 0a fb 55 33 93  9f c8 31 33 29 f5 12 3e  |..N..U3...13)..>|
-00000160  39 62 62 27 05 cf d2 be  bd 7d 42 51 97 4f 71 95  |9bb'.....}BQ.Oq.|
-00000170  10 f8 eb 0f d8 d1 69 aa  22 13 a8 fe 24 f6 87 a1  |......i."...$...|
-00000180  9d ca cb 8f 99 39 2b fb  99 d9 18 8a fa fa 25 20  |.....9+.......% |
-00000190  df 6a b3 d1 ac ce 56 8b  76 5d a9 46 1c 0b c7 57  |.j....V.v].F...W|
-000001a0  90 02 10 55 85 49 48 89  d8 d6 4b 68 29 cb 28 66  |...U.IH...Kh).(f|
-000001b0  1c d1 97 e6 a0 10 90 63  83 96 33 ee 5a 5a 5b 66  |.......c..3.ZZ[f|
-000001c0  ca b3 0d be 6d 70 c5 de  fd 78 c8 f8 e1 c5 78 ef  |....mp...x....x.|
-000001d0  07 2e 60 06 28 86 ed e6  bd 7b 37 33 0e 06 5e 06  |..`.(....{73..^.|
-000001e0  fb 44 2b 96 16 fe 09 30  dc 03 53 bc c9 f9 6f 1e  |.D+....0..S...o.|
-000001f0  4b 79 a9 ac fe 20 3f 12  58 48 0c 40 a5 2f f2 6a  |Ky... ?.XH.@./.j|
-00000200  ea 44 69 93 54 4f 4d 6c  98 85 b1 c5 6f 50 83 b8  |.Di.TOMl....oP..|
-00000210  8a 20 e3 b9 da b7 7d e4  ec 33 28 96 29 d7 dc a3  |. ....}..3(.)...|
-00000220  d0 54 76 cd a6 99 17 e8  0f 14 d2 7c 4b 68 0a 80  |.Tv........|Kh..|
-00000230  4f 0b 2b b5 16 68 dc 25  42 b5 0b f7 13 6a c5 81  |O.+..h.%B....j..|
-00000240  c0 18 bc fb 40 86 cc 99  2e 70 2b 9a 72 eb be 57  |....@....p+.r..W|
-00000250  a0 43 92 83 3b 7e c8 02  43 ab 17 7a 73 87 1a a2  |.C..;~..C..zs...|
-00000260  1c 01 db b4 31 b1 d9 44  f1 c0 d9 de 27 bd 4c 8b  |....1..D....'.L.|
-00000270  1c f5 3d db d6 aa 98 7d  43 fe dd 64 85 8b c1 88  |..=....}C..d....|
-00000280  a9 1e f1 04 0b 5d 3b c2  fd 3f b2 27 a7 28 d1 82  |.....];..?.'.(..|
-00000290  13 fb 85 46 77 78 50 45  1b 4b c0 75 f2 32 8a 6d  |...FwxPE.K.u.2.m|
-000002a0  52 37 2e b1 80 e9 81 3b  60 c8 88 78 11 3f 0f 96  |R7.....;`..x.?..|
-000002b0  d1 4b 19 49 91 b5 70 44  2d 62 a1 04 8f 98 89 ab  |.K.I..pD-b......|
-000002c0  75 1f 8a 97 d5 28 dc 88  20 92 7f f2 90 16 1b de  |u....(.. .......|
-000002d0  54 7c 5f 05 8f c9 70 a1  f5 8c 99 09 43 ab 09 73  |T|_...p.....C..s|
-000002e0  dd 5e 62 c3 9f c8 e1 fa  9e 98 65 18 b5 5e 4e f9  |.^b.......e..^N.|
-000002f0  85 a4 cc dc b8 12 1b eb  0a bc bc bd 1c 2f 51 0e  |............./Q.|
-00000300  8f 55 f1 10 22 06 ca cb  f2 97 54 63 1c 98 36 9f  |.U..".....Tc..6.|
-00000310  1d 66 b0 17 03 03 00 99  f0 14 4d 69 84 b3 ca d4  |.f........Mi....|
-00000320  96 9c e2 3c a4 55 f4 b6  01 1f 1e 1f 77 98 c4 84  |...<.U......w...|
-00000330  5e ce 4c 0b bf ba 39 6b  36 a6 15 9c d1 90 87 d1  |^.L...9k6.......|
-00000340  13 39 1c dd 86 0f a0 06  f7 fc f7 c9 10 4e 46 0a  |.9...........NF.|
-00000350  03 12 a0 bf 3e f3 7d e6  1b b7 ce ec 16 84 52 8e  |....>.}.......R.|
-00000360  bc 9c 9a 4f 2f a7 d9 aa  f3 d6 be 0a f8 39 2d 18  |...O/........9-.|
-00000370  28 9e 35 6e 25 25 46 9b  49 61 a6 ee 6a 87 d2 5f  |(.5n%%F.Ia..j.._|
-00000380  54 e6 fb 96 a3 e9 8a 05  c2 fb 71 0b d7 13 2e 19  |T.........q.....|
-00000390  e5 5c a2 d0 f4 b3 34 95  e1 1d 24 ef 33 a2 0a d5  |.\....4...$.3...|
-000003a0  65 b2 5f 46 73 45 33 69  d6 c3 f6 49 20 e2 00 bd  |e._FsE3i...I ...|
-000003b0  16 17 03 03 00 35 89 2f  34 08 44 35 6a 52 1a fd  |.....5./4.D5jR..|
-000003c0  e4 be 2b 0e 0a dd 2d c1  e7 e3 20 7a 0a 3e 87 1d  |..+...-... z.>..|
-000003d0  2b 64 87 c5 11 54 46 1a  5c 89 e2 97 3f 83 b2 b4  |+d...TF.\...?...|
-000003e0  04 ed d2 c4 1d 3d 37 1f  e1 62 f2                 |.....=7..b.|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 df  |..+.....3.$... .|
+00000060  bb 62 90 62 b0 0d ee a9  4f 2a 45 58 9b d4 1d 0b  |.b.b....O*EX....|
+00000070  b8 49 ee 69 3a e4 48 65  a8 5a 94 60 99 00 2e 14  |.I.i:.He.Z.`....|
+00000080  03 03 00 01 01 17 03 03  00 17 5a fa 5d b7 3e 06  |..........Z.].>.|
+00000090  4f 87 9d 8e f7 c6 9d 6c  9a f9 c8 c1 48 69 a0 1f  |O......l....Hi..|
+000000a0  67 17 03 03 02 6d 0f 4d  e4 f2 24 16 18 d7 0f 1f  |g....m.M..$.....|
+000000b0  eb e4 ff f9 71 99 63 21  41 ff e2 65 96 90 07 88  |....q.c!A..e....|
+000000c0  b4 3b 23 8e 28 01 df c7  f3 71 71 36 25 6c d5 fe  |.;#.(....qq6%l..|
+000000d0  e7 7b 94 f3 2f ba e0 b5  02 1a 24 15 66 2f 4b 2c  |.{../.....$.f/K,|
+000000e0  8e ae da 30 67 9b 33 fa  95 bc ea 80 2d 85 b4 93  |...0g.3.....-...|
+000000f0  28 42 f3 af ab 06 b6 a2  20 4e 9a 9a 07 c4 ad 5a  |(B...... N.....Z|
+00000100  ab 91 b6 f4 b3 ae ba 08  19 4d 0b 5a c7 f8 c6 1c  |.........M.Z....|
+00000110  db b8 61 d1 55 5f 02 34  44 cf c4 f1 7b 25 b2 12  |..a.U_.4D...{%..|
+00000120  a0 37 80 3a 3d 47 b0 cc  92 31 8c 41 d9 85 fa ac  |.7.:=G...1.A....|
+00000130  ea 81 49 4e 60 b9 1a dc  2a 61 fa 89 e3 b5 93 b5  |..IN`...*a......|
+00000140  cf 22 65 46 54 56 bc 3c  f9 62 75 bd 04 8f 39 fb  |."eFTV.<.bu...9.|
+00000150  a3 94 92 20 44 5b 74 51  b1 38 fe 48 a4 26 74 82  |... D[tQ.8.H.&t.|
+00000160  ac 11 04 25 a4 76 06 ce  51 47 2f 56 e8 1d 4f 74  |...%.v..QG/V..Ot|
+00000170  d5 5c 00 b7 22 a5 47 3c  17 d5 f3 13 37 8e b0 82  |.\..".G<....7...|
+00000180  da 5f d9 85 05 e7 12 79  0a 22 97 b5 9b 03 2d 61  |._.....y."....-a|
+00000190  ab 19 4c 40 8a 9d d2 08  77 1d cc f0 b7 c7 48 ba  |..L@....w.....H.|
+000001a0  70 c4 e9 7f 1a ba 5b 0a  d2 1e 0c 95 58 e9 f0 56  |p.....[.....X..V|
+000001b0  c2 a6 a3 58 b6 b2 ea 85  55 77 c8 09 be 1a 7e 2c  |...X....Uw....~,|
+000001c0  ac d3 a0 ce 4c 6d 5a 02  c8 d9 7e b8 3b 46 e9 48  |....LmZ...~.;F.H|
+000001d0  73 9b 97 1c 32 fe e1 99  c4 2e ee 81 38 27 12 d0  |s...2.......8'..|
+000001e0  99 4f dd 18 a3 df 93 24  f3 0d 53 11 fe bb ff b7  |.O.....$..S.....|
+000001f0  cf 5e 18 41 01 d4 d3 06  6a f4 5b e3 26 1f 7c fa  |.^.A....j.[.&.|.|
+00000200  ad 9f 61 a3 b3 05 5e b4  bf 94 9c 94 4b c9 3c 63  |..a...^.....K.<c|
+00000210  88 1d b9 df a9 0d 4f 57  78 73 6a 64 cf 29 49 e4  |......OWxsjd.)I.|
+00000220  a3 f8 cb a3 f0 0d 93 c2  56 65 f8 f9 be ad b2 e6  |........Ve......|
+00000230  c6 c7 f5 73 3c 7a 85 e5  e1 73 d4 76 f6 6b 87 da  |...s<z...s.v.k..|
+00000240  99 79 e4 94 d7 77 88 a2  44 cd 60 58 3f 22 67 88  |.y...w..D.`X?"g.|
+00000250  f1 aa 99 3e 1c 04 be 98  b8 87 f7 c8 e3 0f c7 55  |...>...........U|
+00000260  75 01 95 fa 21 f2 5f df  d2 38 88 87 99 b0 10 4d  |u...!._..8.....M|
+00000270  e3 c9 74 28 59 14 90 89  6c 54 83 0b 71 c2 7e 4b  |..t(Y...lT..q.~K|
+00000280  39 21 92 0f ec 0e 98 53  39 75 54 0b 8d 12 6d 57  |9!.....S9uT...mW|
+00000290  4f bd 2a 02 9a 44 ac 45  47 c3 05 71 cc 7e 60 0e  |O.*..D.EG..q.~`.|
+000002a0  93 1b 70 5b 42 4b d6 7f  01 2d 2a 73 ed 52 b2 8d  |..p[BK...-*s.R..|
+000002b0  2f fb 6e 85 5e c6 70 2d  3b e8 3d f1 57 6e c5 f8  |/.n.^.p-;.=.Wn..|
+000002c0  7b f5 85 af 3e c8 64 28  00 24 1e 8a c9 6c f8 e3  |{...>.d(.$...l..|
+000002d0  24 83 50 39 d0 4d b4 23  62 80 7d 6b f8 ee 5a f0  |$.P9.M.#b.}k..Z.|
+000002e0  c8 63 df 43 6e ce 58 b9  39 18 91 82 3c 84 d9 12  |.c.Cn.X.9...<...|
+000002f0  4a 4b 76 67 2c 07 91 97  ac c9 16 9c b5 7a 84 54  |JKvg,........z.T|
+00000300  fb 99 2a 16 0a 00 a3 d6  04 ac 28 f5 d0 34 a6 3c  |..*.......(..4.<|
+00000310  ac 54 50 17 03 03 00 99  5f ec 9a 27 57 7e 33 28  |.TP....._..'W~3(|
+00000320  b3 06 a4 36 6d 4e 59 3e  9a 75 95 3a d2 72 c0 7c  |...6mNY>.u.:.r.||
+00000330  61 54 a5 46 01 91 2d 11  ac 6e 25 15 62 c4 8f 8f  |aT.F..-..n%.b...|
+00000340  f9 a8 a0 2a d1 51 71 12  9b df 4f 6a 1b e9 b1 c2  |...*.Qq...Oj....|
+00000350  eb 83 00 fd 32 53 b3 5d  3b 6c 34 59 e9 42 21 ff  |....2S.];l4Y.B!.|
+00000360  7a 10 c0 81 81 13 01 db  bb ef 8f 29 a3 ca 07 67  |z..........)...g|
+00000370  b8 8f 5d 27 07 9c ed 67  51 f9 35 a7 11 bf 10 f7  |..]'...gQ.5.....|
+00000380  f4 36 d8 dc fd 14 a8 56  18 c8 4e fb be 27 91 5f  |.6.....V..N..'._|
+00000390  6a a4 da 13 32 3d 6c d9  fa 18 5b 13 26 68 e2 a9  |j...2=l...[.&h..|
+000003a0  d2 b6 72 2e dd 7d 69 30  32 fd 24 35 35 a1 1d bd  |..r..}i02.$55...|
+000003b0  03 17 03 03 00 35 05 56  0b a7 86 2f 45 c1 18 c2  |.....5.V.../E...|
+000003c0  ad c5 2f 54 f6 5b b3 eb  45 fc 76 ff c9 60 89 e1  |../T.[..E.v..`..|
+000003d0  f1 e2 3a 28 60 8d e9 54  62 4d 7a 30 4f 8c 73 b7  |..:(`..TbMz0O.s.|
+000003e0  45 10 27 0f e8 56 91 1f  7c 07 3a                 |E.'..V..|.:|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 07 8e f6 0b 41  |..........5....A|
-00000010  be 74 45 99 5e 35 59 4f  2e 59 d4 37 77 ca 53 d4  |.tE.^5YO.Y.7w.S.|
-00000020  fd 33 bf dc 65 85 ee ad  c5 d6 94 7e 6e e8 02 cf  |.3..e......~n...|
-00000030  15 d2 04 cb e1 9f 5e 94  dd 5f 37 17 95 17 0c b7  |......^.._7.....|
-00000040  17 03 03 00 17 1f aa e9  7d 34 dc 12 da 3b cb dd  |........}4...;..|
-00000050  1c d3 b0 f1 79 ad cc 66  06 64 69 21 17 03 03 00  |....y..f.di!....|
-00000060  13 b7 c7 a2 01 48 27 3a  44 e6 c6 47 a9 19 5f d2  |.....H':D..G.._.|
-00000070  f8 96 98 70                                       |...p|
+00000000  14 03 03 00 01 01 17 03  03 00 35 f9 89 62 39 dc  |..........5..b9.|
+00000010  cb f6 be b1 6f db 4c 8e  44 3c 1e 13 ba 25 db dc  |....o.L.D<...%..|
+00000020  f1 64 00 ea f3 56 ba 69  00 5b bd 64 05 8d c7 27  |.d...V.i.[.d...'|
+00000030  39 b6 9c 2f ce e4 74 f1  ab 32 59 f1 6d 27 88 58  |9../..t..2Y.m'.X|
+00000040  17 03 03 00 17 90 42 5e  b1 ae d2 d7 71 4e 8f 51  |......B^....qN.Q|
+00000050  91 3b e4 b0 97 ef 35 27  4f 56 79 81 17 03 03 00  |.;....5'OVy.....|
+00000060  13 7b 6b c7 ab bf f2 de  55 52 b0 ee 67 40 ad bd  |.{k.....UR..g@..|
+00000070  6e 4d 22 f8                                       |nM".|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-AES256-SHA384 b/src/crypto/tls/testdata/Client-TLSv13-AES256-SHA384
index c5bac350a6..02eb5092fc 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-AES256-SHA384
+++ b/src/crypto/tls/testdata/Client-TLSv13-AES256-SHA384
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,87 +7,89 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 3d 39 60 81 a4  |....z...v..=9`..|
-00000010  cc 92 5d fd 8b 21 58 da  2e 4c e2 70 2b 12 d2 8c  |..]..!X..L.p+...|
-00000020  35 55 bc ba 79 c1 9e 6f  78 8c cf 20 00 00 00 00  |5U..y..ox.. ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 3e 8f 50 19 e5  |....z...v..>.P..|
+00000010  1b d8 bf 48 bf c6 b3 38  d0 a4 9d 33 39 1f 36 72  |...H...8...39.6r|
+00000020  9a a4 7d 9a e5 61 f1 9b  da 0c a3 20 00 00 00 00  |..}..a..... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 02 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 10  |..+.....3.$... .|
-00000060  0e 84 6c ef b3 7e f7 93  33 67 0e d0 5e e4 c6 a8  |..l..~..3g..^...|
-00000070  5f c5 ac e7 85 06 86 a4  21 10 aa 56 18 3a 39 14  |_.......!..V.:9.|
-00000080  03 03 00 01 01 17 03 03  00 17 a8 c3 84 a3 a2 42  |...............B|
-00000090  ba c8 40 ef f8 53 02 58  d7 39 3f b2 34 2f 4e 71  |..@..S.X.9?.4/Nq|
-000000a0  54 17 03 03 02 6d e5 41  6d ac 46 4e 7c 71 5c b9  |T....m.Am.FN|q\.|
-000000b0  c5 aa 8d 7d f2 ef f3 40  22 9d db d3 83 49 45 94  |...}...@"....IE.|
-000000c0  96 c6 85 74 ac f1 64 e2  80 7a 47 1e c1 f7 45 bb  |...t..d..zG...E.|
-000000d0  6e 56 b5 5b 90 1f 11 6e  47 d5 52 b7 5d d3 02 80  |nV.[...nG.R.]...|
-000000e0  55 59 94 53 05 ab 5c aa  18 f8 7d d0 24 1d 6f 7a  |UY.S..\...}.$.oz|
-000000f0  c7 8e e9 80 61 dc b3 2b  c0 74 09 d3 58 be e9 cb  |....a..+.t..X...|
-00000100  8b 53 ec 68 d7 b4 4b 70  83 42 bb 24 78 05 3c 8c  |.S.h..Kp.B.$x.<.|
-00000110  a9 54 af 0b 55 e2 d3 35  73 56 9b 9a 19 fd 93 9a  |.T..U..5sV......|
-00000120  21 c3 5f f8 cf fe e0 a1  63 62 b8 58 bf 35 29 1d  |!._.....cb.X.5).|
-00000130  69 58 f6 d3 e8 60 66 1b  db 53 4b 26 0b 78 d9 5e  |iX...`f..SK&.x.^|
-00000140  73 d5 34 5a 11 57 98 8d  0c 9f 85 28 80 a4 ee 47  |s.4Z.W.....(...G|
-00000150  f8 23 ca 31 7a 24 d5 dd  9b 49 7b 62 ab e5 69 fa  |.#.1z$...I{b..i.|
-00000160  e7 cc 83 0c 6e e5 0f 98  4c 07 86 2b a9 97 eb c0  |....n...L..+....|
-00000170  78 1e 2b 83 7b 9a 6f 51  60 c0 b8 e1 99 f7 b0 e3  |x.+.{.oQ`.......|
-00000180  bf d8 ec 4e 9f 69 27 c8  89 fc 18 21 58 8a ba 87  |...N.i'....!X...|
-00000190  23 4c cd 95 b7 f1 a5 9a  79 5c d7 35 74 a5 4a 2c  |#L......y\.5t.J,|
-000001a0  fc c8 f4 b4 c4 de 3b 0e  08 12 e0 24 af 10 b3 e7  |......;....$....|
-000001b0  04 74 a9 b4 de ee 98 b5  f1 ed 50 9f eb 5f eb 14  |.t........P.._..|
-000001c0  56 6f d2 f2 b3 5e 40 34  0a f9 2d 44 de 0a 29 8f  |Vo...^@4..-D..).|
-000001d0  e5 86 dc 97 4f dd 26 b6  6a 8f 69 e9 5c 87 87 92  |....O.&.j.i.\...|
-000001e0  65 04 d6 aa d0 79 bf ab  85 20 ca e9 bf 50 5d a9  |e....y... ...P].|
-000001f0  80 2c 92 26 8e 19 ef 78  a7 68 64 ba 48 3c 24 2e  |.,.&...x.hd.H<$.|
-00000200  45 69 ce 94 17 e5 8a d7  81 02 de f1 d0 d8 c0 b8  |Ei..............|
-00000210  86 c1 fb 2c 6d fe 42 1a  ce e0 1c f0 29 15 ba fc  |...,m.B.....)...|
-00000220  8d 65 5e 6d ea 9e c3 95  f4 1b 15 bb 91 ac 9c 0b  |.e^m............|
-00000230  13 f0 fa ab 46 ed f1 c5  29 6e 45 db 4c cc 1e 45  |....F...)nE.L..E|
-00000240  4d fc f2 6c 2b 0a d0 f3  70 69 32 cd 2f 23 6d f2  |M..l+...pi2./#m.|
-00000250  5f f3 f4 f0 5c 1c d7 d3  a7 0c 8f 23 29 30 7a 8e  |_...\......#)0z.|
-00000260  c3 aa a8 71 21 5c ad b6  fb c6 bd 78 ac ab b1 a0  |...q!\.....x....|
-00000270  11 84 23 61 7b ec 90 e1  2c 23 ec 9b 21 c8 ab 01  |..#a{...,#..!...|
-00000280  e0 b9 5b 0b 4c ee a5 3c  5b c0 52 bd 60 7a b1 88  |..[.L..<[.R.`z..|
-00000290  67 e3 c9 60 b9 04 a8 31  3e 34 d7 33 49 38 d9 a7  |g..`...1>4.3I8..|
-000002a0  d1 04 b4 13 a8 5f 0b f2  41 77 d4 c8 b2 d3 0e d6  |....._..Aw......|
-000002b0  8c dc 34 ad 2a d9 4b 5f  4a e2 17 0a be 2a 55 4a  |..4.*.K_J....*UJ|
-000002c0  44 a7 b0 0f d1 39 b0 e5  9d 77 6b d7 44 15 99 bf  |D....9...wk.D...|
-000002d0  c8 02 57 90 5b 73 29 fe  ab 85 93 c3 dc 1c b0 b2  |..W.[s).........|
-000002e0  14 78 01 99 f5 d2 db ef  ae 0e 2a d9 17 1e 70 fa  |.x........*...p.|
-000002f0  bb 74 fe 93 a0 aa ff 79  cd 8b 6d 3d 79 66 d2 c8  |.t.....y..m=yf..|
-00000300  90 c7 2c e6 54 26 de f7  4d b8 a7 73 cd 92 fc 42  |..,.T&..M..s...B|
-00000310  ad 4e ff 17 03 03 00 99  c6 07 36 ce 58 9c fe 38  |.N........6.X..8|
-00000320  aa b4 5c c8 8e f5 11 19  82 4c 4b 2b 0a 08 be 3f  |..\......LK+...?|
-00000330  11 76 06 4b d3 1b b7 fc  66 d9 db de fb 6a ee 29  |.v.K....f....j.)|
-00000340  f6 a5 4b 96 f3 3c a0 67  44 73 d4 46 c5 d4 a1 f8  |..K..<.gDs.F....|
-00000350  71 36 7c a5 62 79 fc be  f9 34 55 85 31 8f fc e3  |q6|.by...4U.1...|
-00000360  46 be 64 1e 2d 1b 21 c3  89 8e 1c cc df 30 05 57  |F.d.-.!......0.W|
-00000370  2e d5 d5 67 11 10 46 1a  af 99 01 0e fd 40 53 1f  |...g..F......@S.|
-00000380  b0 f0 76 3e 8e c1 7a 6a  fe fe ef c1 08 6e ea 9b  |..v>..zj.....n..|
-00000390  75 6c 62 86 07 50 ee 1f  ef 3b 55 fd 68 44 47 27  |ulb..P...;U.hDG'|
-000003a0  07 c1 53 b5 13 c5 e0 a4  d6 9e 8a 3c 78 a0 04 b7  |..S........<x...|
-000003b0  08 17 03 03 00 45 6b fc  53 20 43 7a f3 26 2f fc  |.....Ek.S Cz.&/.|
-000003c0  97 0e d3 09 f0 d9 c5 46  af be e4 c5 06 31 6f 6c  |.......F.....1ol|
-000003d0  5f 11 ec 4a c5 d5 02 50  aa d5 28 98 60 f1 79 82  |_..J...P..(.`.y.|
-000003e0  fb e9 87 c0 e0 c0 e0 60  c2 11 cf be 8f 12 d5 0c  |.......`........|
-000003f0  91 40 ed a1 93 40 60 04  98 a3 d7                 |.@...@`....|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 80  |..+.....3.$... .|
+00000060  d3 4e d4 ec ef 3e 0b c0  9b 8e 6a 91 2b af f2 cf  |.N...>....j.+...|
+00000070  78 13 e0 9b e1 41 60 7d  bd 83 69 d5 dc 1b 6d 14  |x....A`}..i...m.|
+00000080  03 03 00 01 01 17 03 03  00 17 cd 1f b4 38 20 00  |.............8 .|
+00000090  f5 52 89 92 be 23 95 90  92 b4 2a 06 f9 af f7 6c  |.R...#....*....l|
+000000a0  82 17 03 03 02 6d 4d 51  05 22 11 94 f0 2e 66 9b  |.....mMQ."....f.|
+000000b0  d0 bd b8 01 3c 23 03 3a  28 a7 74 80 81 e6 5c 5e  |....<#.:(.t...\^|
+000000c0  48 fb 4d 29 ab b3 17 c6  25 d8 15 ed 63 ef 07 61  |H.M)....%...c..a|
+000000d0  0e 14 44 da 9f 6c c1 57  37 18 34 16 e0 3a 8d ab  |..D..l.W7.4..:..|
+000000e0  98 45 84 79 e0 19 56 26  61 e1 70 c9 7d 7b 55 b0  |.E.y..V&a.p.}{U.|
+000000f0  5c d5 90 60 87 3c 55 f7  5e 4f df fc 05 6e 90 bc  |\..`.<U.^O...n..|
+00000100  7d a0 2a db 56 17 5a e6  b4 85 99 68 2a fa 83 0d  |}.*.V.Z....h*...|
+00000110  40 84 a6 20 1d 5b 30 25  b3 b2 c6 ba 73 88 f4 c1  |@.. .[0%....s...|
+00000120  30 d0 f5 48 a6 52 c9 3e  bd 8d dc 31 1c 84 25 4d  |0..H.R.>...1..%M|
+00000130  ae c0 0f de 5b 44 97 d1  bf f6 7a 84 88 fb 82 7b  |....[D....z....{|
+00000140  79 5d f0 d8 39 a3 21 5a  67 16 b9 68 55 06 bd 50  |y]..9.!Zg..hU..P|
+00000150  f2 83 77 8e e6 60 f3 46  57 d3 96 e1 f7 02 9e 1d  |..w..`.FW.......|
+00000160  d3 f2 29 0b 8e 34 0d 40  0b 1a 06 c5 33 52 bd 78  |..)..4.@....3R.x|
+00000170  4e ff a2 ec 31 a1 c3 57  0d 82 59 ab a7 46 81 94  |N...1..W..Y..F..|
+00000180  4f 31 63 25 75 3f b1 c9  99 ae 8a 60 6f 4a 96 d2  |O1c%u?.....`oJ..|
+00000190  ce 37 4c 7b f4 f9 83 56  7e 4c 0a 6d a1 0c 80 00  |.7L{...V~L.m....|
+000001a0  46 5a a9 fa d6 7c 9a 18  c2 36 b6 19 fa 76 37 65  |FZ...|...6...v7e|
+000001b0  d4 c0 33 37 c3 90 26 df  4e c7 89 65 26 f3 cb 9d  |..37..&.N..e&...|
+000001c0  a2 a0 ae 50 72 89 45 db  fb a1 44 3a 12 9e e7 4e  |...Pr.E...D:...N|
+000001d0  7a b8 aa f8 87 d2 8d 6b  43 ff 66 b7 ad 06 d5 09  |z......kC.f.....|
+000001e0  ac 4e 75 db b2 d1 4c 43  81 26 43 bf a3 af 0f 97  |.Nu...LC.&C.....|
+000001f0  83 a4 37 e1 aa 50 da e7  6b 3f a1 6c 80 ea b2 06  |..7..P..k?.l....|
+00000200  6b 51 b9 b9 b0 83 71 b1  56 fe c7 f6 9e e7 69 1c  |kQ....q.V.....i.|
+00000210  e7 6b ba 0e 46 b9 9d cb  dd 7f 9f bf a3 06 1d ba  |.k..F...........|
+00000220  5f eb 5e 1f dd 76 5f 8c  d7 4e d9 a0 c1 75 28 61  |_.^..v_..N...u(a|
+00000230  ea ef 4a 79 fc a6 8f 87  98 b2 26 ce 4e ae b7 9c  |..Jy......&.N...|
+00000240  ed 73 f3 98 a4 83 56 55  af d7 6d c3 90 fc ec 8d  |.s....VU..m.....|
+00000250  09 b4 a0 80 ac ff bc 1b  0b f9 70 4d 70 2b 19 ab  |..........pMp+..|
+00000260  d0 14 de 7c d2 ca b7 56  7f 19 d6 1a 11 04 50 3d  |...|...V......P=|
+00000270  12 dc 35 c1 ce b9 b0 e4  70 b3 27 4b 26 98 e3 af  |..5.....p.'K&...|
+00000280  7f 42 62 4b 75 33 61 54  2c 0f 03 bd b6 51 e9 5a  |.BbKu3aT,....Q.Z|
+00000290  bd 90 f9 af 8e 5f c2 ed  aa 63 a4 3b c7 e1 cb cc  |....._...c.;....|
+000002a0  8b 0f 48 39 9b 6c 49 08  9b f4 27 d8 d8 92 56 a3  |..H9.lI...'...V.|
+000002b0  ae a9 60 a9 ab 25 3d 3d  ba 36 60 00 39 bd 60 ab  |..`..%==.6`.9.`.|
+000002c0  58 bd 4d c2 ab 13 2d 70  2d ef 0c a3 65 17 45 ad  |X.M...-p-...e.E.|
+000002d0  b2 fc 92 ce cb 74 e9 b1  59 cb b2 f1 c7 06 6b 9d  |.....t..Y.....k.|
+000002e0  12 7a c1 51 3d c8 81 91  88 02 fa be 18 f2 9d 4d  |.z.Q=..........M|
+000002f0  04 53 3f 39 e9 49 1f fb  99 1b 71 94 44 dd 09 c5  |.S?9.I....q.D...|
+00000300  4a c4 71 45 2a d7 8f b9  a3 7d 2f df 23 d0 2c 83  |J.qE*....}/.#.,.|
+00000310  1a 90 0e 17 03 03 00 99  60 fb bc b6 8b 4a 50 fb  |........`....JP.|
+00000320  88 0e 23 81 34 07 98 f8  07 35 5f 12 98 4d a3 63  |..#.4....5_..M.c|
+00000330  c3 05 e7 99 eb 22 fe a9  da 60 25 70 e6 53 40 18  |....."...`%p.S@.|
+00000340  f9 66 c4 3c 0f 3c 9b 7b  3e 86 5f e9 0f 91 4e ea  |.f.<.<.{>._...N.|
+00000350  4f 38 dd ef 1c a8 80 16  ae 59 50 70 23 92 40 22  |O8.......YPp#.@"|
+00000360  01 d6 72 d4 e5 ee e7 b2  aa 07 d0 ac ee 63 8f dc  |..r..........c..|
+00000370  55 29 5e e5 6f be 28 1e  b5 ad ca 9a 30 94 57 16  |U)^.o.(.....0.W.|
+00000380  de 2b ba 7b 4a 50 a8 7a  fa 9d 45 89 d1 3c 97 d3  |.+.{JP.z..E..<..|
+00000390  9d c5 1d de cd d6 80 9b  bd 68 1c e2 8b e3 bb dc  |.........h......|
+000003a0  c5 2a 4d 38 ae d6 b3 1d  2e 35 52 d0 c0 b4 ae fd  |.*M8.....5R.....|
+000003b0  68 17 03 03 00 45 ac f9  bb 95 b5 c3 fb dc e9 21  |h....E.........!|
+000003c0  65 ef a9 2d 9c 6a 6b 51  35 9b 2b a9 6b f4 2f 66  |e..-.jkQ5.+.k./f|
+000003d0  14 9d e0 30 fc eb 43 bb  4f 1b 50 13 65 72 35 74  |...0..C.O.P.er5t|
+000003e0  dd 20 dc 88 54 e4 05 18  d7 02 ca 5b 27 dd 32 e9  |. ..T......['.2.|
+000003f0  a2 68 68 cc 55 ff 25 21  87 13 9b                 |.hh.U.%!...|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 45 ee 00 18 db 1e  |..........E.....|
-00000010  67 aa 0f 9e 5c 20 7d 25  27 49 e8 d5 60 02 78 7b  |g...\ }%'I..`.x{|
-00000020  23 58 70 67 67 93 ca 4d  50 69 b1 cf d9 dc 31 d3  |#Xpgg..MPi....1.|
-00000030  03 36 b0 07 39 59 52 e1  c7 36 6d 16 0b 56 03 c6  |.6..9YR..6m..V..|
-00000040  a0 ec 0e 6b ed de 7b ba  51 96 83 b6 b8 77 8f 6a  |...k..{.Q....w.j|
-00000050  17 03 03 00 17 77 f6 6f  83 00 ad eb be 16 26 3d  |.....w.o......&=|
-00000060  27 e8 58 73 a2 bc 11 ff  14 54 4a 15 17 03 03 00  |'.Xs.....TJ.....|
-00000070  13 bc 94 3f 6e ee 1b 40  b0 2e 03 13 47 28 38 4d  |...?n..@....G(8M|
-00000080  2d 26 5d 15                                       |-&].|
+00000000  14 03 03 00 01 01 17 03  03 00 45 87 09 9a a9 a0  |..........E.....|
+00000010  6a 25 7e 7f ef f2 95 97  45 9f 25 b3 fc 70 1d a5  |j%~.....E.%..p..|
+00000020  c5 e3 bc 95 95 c2 2e 9b  46 d9 cd 5e 04 29 33 9f  |........F..^.)3.|
+00000030  8c 35 d5 b0 4c 35 e7 f4  02 1a 1a 9f 07 e5 e4 9d  |.5..L5..........|
+00000040  6f 63 35 d5 c9 21 9f 90  95 a5 14 14 fc 8a bb 41  |oc5..!.........A|
+00000050  17 03 03 00 17 3d e1 e9  33 73 b4 29 68 d2 50 d2  |.....=..3s.)h.P.|
+00000060  58 9b 85 21 07 3a a8 87  92 37 53 90 17 03 03 00  |X..!.:...7S.....|
+00000070  13 24 0a cf 8a 3e 88 9d  9f 57 81 26 10 06 fc 70  |.$...>...W.&...p|
+00000080  1d fa da 81                                       |....|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ALPN b/src/crypto/tls/testdata/Client-TLSv13-ALPN
index f40340ac15..d83b270019 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ALPN
+++ b/src/crypto/tls/testdata/Client-TLSv13-ALPN
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 12 01 00 01  0e 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 30 01 00 01  2c 03 03 00 00 00 00 00  |....0...,.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,87 +7,89 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 93 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 b1 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 10 00 10  |................|
-000000d0  00 0e 06 70 72 6f 74 6f  32 06 70 72 6f 74 6f 31  |...proto2.proto1|
-000000e0  00 2b 00 09 08 03 04 03  03 03 02 03 01 00 33 00  |.+............3.|
-000000f0  26 00 24 00 1d 00 20 2f  e5 7d a3 47 cd 62 43 15  |&.$... /.}.G.bC.|
-00000100  28 da ac 5f bb 29 07 30  ff f6 84 af c4 cf c2 ed  |(.._.).0........|
-00000110  90 99 5f 58 cb 3b 74                              |.._X.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 10 00 10 00 0e  |................|
+000000f0  06 70 72 6f 74 6f 32 06  70 72 6f 74 6f 31 00 2b  |.proto2.proto1.+|
+00000100  00 09 08 03 04 03 03 03  02 03 01 00 33 00 26 00  |............3.&.|
+00000110  24 00 1d 00 20 2f e5 7d  a3 47 cd 62 43 15 28 da  |$... /.}.G.bC.(.|
+00000120  ac 5f bb 29 07 30 ff f6  84 af c4 cf c2 ed 90 99  |._.).0..........|
+00000130  5f 58 cb 3b 74                                    |_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 c2 2e 95 0c cf  |....z...v.......|
-00000010  63 40 d8 a0 bd 51 27 e2  62 79 72 26 b1 d4 38 5b  |c@...Q'.byr&..8[|
-00000020  50 03 66 d2 2e 8e 46 b7  cf 40 0a 20 00 00 00 00  |P.f...F..@. ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 cb f0 b7 02 94  |....z...v.......|
+00000010  1a 0a b2 1d 4b 7c 43 99  cb 50 bd aa 72 80 91 98  |....K|C..P..r...|
+00000020  bc 29 68 eb bd 81 b5 32  7c fe 9b 20 00 00 00 00  |.)h....2|.. ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 21  |..+.....3.$... !|
-00000060  18 6f 64 73 17 22 b0 11  60 92 ab 01 b3 fb 8a 2d  |.ods."..`......-|
-00000070  27 15 5a 46 ec 6c c3 0c  a7 73 00 b2 7e 9f 4f 14  |'.ZF.l...s..~.O.|
-00000080  03 03 00 01 01 17 03 03  00 24 68 7f 90 b2 66 74  |.........$h...ft|
-00000090  36 f5 fc 65 55 19 c1 78  65 d8 dc 46 fb ad b6 2c  |6..eU..xe..F...,|
-000000a0  89 f3 d1 fd 3e 46 c2 50  01 24 72 2a 64 98 17 03  |....>F.P.$r*d...|
-000000b0  03 02 6d 40 bc da 1a 9c  8b d7 15 24 4f d4 c1 9c  |..m@.......$O...|
-000000c0  8b 3c 8b 51 37 41 46 a8  cb b4 9c 50 c0 be 72 ef  |.<.Q7AF....P..r.|
-000000d0  81 d3 7f ed ec 96 e2 c2  08 0e 7e 23 95 c3 4f 79  |..........~#..Oy|
-000000e0  01 2d 26 81 c1 ba d0 58  61 d8 c5 b7 e7 79 4f 3e  |.-&....Xa....yO>|
-000000f0  d8 c1 07 ae de 6a 1e 78  eb 9d 8c a1 2a 57 9c 56  |.....j.x....*W.V|
-00000100  1f 6c 6e bb 2d 70 6d 55  92 10 3f 39 7e 8a d2 30  |.ln.-pmU..?9~..0|
-00000110  e5 1c 4b df c0 96 d0 de  16 09 c6 34 23 16 54 a8  |..K........4#.T.|
-00000120  f5 0a 1a af 9a 27 60 89  19 6a 3e 69 12 de 76 4c  |.....'`..j>i..vL|
-00000130  88 f2 ca 6c 0b 94 b8 d2  bc 09 f0 d3 86 74 3c 3f  |...l.........t<?|
-00000140  aa fd 05 cb c7 63 9f e0  5c 7f 41 18 4f df 5e ca  |.....c..\.A.O.^.|
-00000150  66 cd 15 40 df 78 e7 55  33 5f dc 3f 29 b5 7b 97  |f..@.x.U3_.?).{.|
-00000160  f7 c9 19 78 a5 a9 4e 4d  3d 10 e6 00 26 08 a6 97  |...x..NM=...&...|
-00000170  b0 f0 38 b4 48 fb c1 81  01 38 18 e2 7b 47 97 d1  |..8.H....8..{G..|
-00000180  d2 53 67 25 50 8a ab eb  4c 38 6e 3b 99 95 66 50  |.Sg%P...L8n;..fP|
-00000190  dd 31 12 88 a2 d8 74 e0  04 ae ce 54 dc 5d d6 9c  |.1....t....T.]..|
-000001a0  fb 25 26 ac 0f c1 ed cf  aa 47 9e 5e e8 a3 0e 3b  |.%&......G.^...;|
-000001b0  05 04 2e 4b b3 44 29 e9  a5 7c 71 79 83 bf e2 06  |...K.D)..|qy....|
-000001c0  87 45 18 6d de 88 12 ad  00 6c dc d6 e3 df 8c c9  |.E.m.....l......|
-000001d0  ef ae 54 5a 93 fc 7e 82  64 15 52 03 ef 14 d1 7a  |..TZ..~.d.R....z|
-000001e0  95 b9 15 04 ab 1f 49 35  f8 2e 20 48 87 b1 88 82  |......I5.. H....|
-000001f0  18 ec 2d 58 c2 1b f8 41  47 f3 cf be 1e e8 60 7b  |..-X...AG.....`{|
-00000200  40 f8 ee cc 63 cc 8e 60  b7 3a 86 9f ce 70 76 2b  |@...c..`.:...pv+|
-00000210  4f 03 d1 2d 90 8e 3f 4b  19 32 2a d6 ba b3 9f b2  |O..-..?K.2*.....|
-00000220  ce 77 47 35 0c 5e e5 ea  64 bb 52 79 01 84 4b ee  |.wG5.^..d.Ry..K.|
-00000230  b6 4f 0a bc 2f aa af f9  c4 d7 1b 8e c7 58 f1 dc  |.O../........X..|
-00000240  84 57 f4 9c 3f 40 e5 27  49 9c 4c a9 98 1b 9a b3  |.W..?@.'I.L.....|
-00000250  95 83 7e 32 b7 d8 25 85  4d bf fd 14 88 c0 f7 1c  |..~2..%.M.......|
-00000260  e2 cb 46 b3 4a 39 80 fa  08 b3 c2 18 05 dd 82 e4  |..F.J9..........|
-00000270  68 5f 72 b5 53 a8 1b e7  7c 79 64 9a 3f 63 d3 50  |h_r.S...|yd.?c.P|
-00000280  df af cd 15 e7 30 2d 28  a1 24 80 ab 3e 71 83 e3  |.....0-(.$..>q..|
-00000290  5c 9a b7 6b f2 d0 1e 55  2c 1c ac 5d 21 64 a2 d2  |\..k...U,..]!d..|
-000002a0  a9 dd a8 49 7c 22 26 8e  ca 75 a3 ef 52 42 d0 38  |...I|"&..u..RB.8|
-000002b0  f4 02 60 af ee 33 30 46  90 a5 b3 7a 66 c8 ab 10  |..`..30F...zf...|
-000002c0  3f 76 d1 76 aa 5d da c4  29 ca d7 22 c4 44 b4 e8  |?v.v.]..)..".D..|
-000002d0  64 b6 6d 0f 16 cd d9 e9  62 17 91 64 03 0f 99 8f  |d.m.....b..d....|
-000002e0  c6 97 c8 4b c9 45 c4 31  e4 1f a8 b0 aa 67 02 e7  |...K.E.1.....g..|
-000002f0  20 68 2a 89 f9 b8 e8 ce  93 d0 a3 1b 0d d1 4c 45  | h*...........LE|
-00000300  c2 19 ac aa 87 43 95 ae  c4 56 56 fe 4b 0e af db  |.....C...VV.K...|
-00000310  08 6a 14 8e 8b 7e 64 9d  6d 6e 0f 78 7c e4 f8 51  |.j...~d.mn.x|..Q|
-00000320  17 03 03 00 99 2d 7b fa  e6 dc da 89 93 da 93 91  |.....-{.........|
-00000330  9c 25 08 50 66 eb a7 e4  f1 20 da 33 e5 cd a5 89  |.%.Pf.... .3....|
-00000340  00 a7 47 9c 84 e6 cf 6d  e1 86 02 af fb 54 ff b3  |..G....m.....T..|
-00000350  b5 a4 e1 46 1a 3a 89 ad  f0 c4 63 fe d2 eb bb 6c  |...F.:....c....l|
-00000360  6e cc a9 95 b0 e4 df f8  44 46 16 43 07 d7 8e 6e  |n.......DF.C...n|
-00000370  9b ee 0b 22 7a 23 f4 b8  3e fd fe 99 13 9d 18 bc  |..."z#..>.......|
-00000380  77 99 2f 90 21 a1 5f cc  9f 08 e2 75 44 2f bf 58  |w./.!._....uD/.X|
-00000390  70 f2 95 b2 13 20 f3 ed  51 de e8 02 c6 ca 44 57  |p.... ..Q.....DW|
-000003a0  eb 0b 9f 3e 61 f1 1a 6e  6b 13 f5 14 f3 43 19 f6  |...>a..nk....C..|
-000003b0  7d 46 3a 73 49 2f fd 83  c3 68 c7 ba b4 e8 17 03  |}F:sI/...h......|
-000003c0  03 00 35 67 2b 2b 9b f0  f3 d9 09 c4 01 20 ea 22  |..5g++....... ."|
-000003d0  c9 7c e6 7a ce 3f 7f 84  c2 1f 6e eb d6 ce 85 b8  |.|.z.?....n.....|
-000003e0  2c 3c 9f 77 8b 37 11 dd  64 d1 ae ba 85 50 7e ba  |,<.w.7..d....P~.|
-000003f0  14 a9 05 ff 82 3b e5 7d                           |.....;.}|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 78  |..+.....3.$... x|
+00000060  05 c7 69 04 93 8d 93 d7  d3 eb 0b 00 70 98 99 c1  |..i.........p...|
+00000070  2a a9 84 7f e5 6c 4c d0  b1 f3 10 71 11 c6 78 14  |*....lL....q..x.|
+00000080  03 03 00 01 01 17 03 03  00 24 6d 09 77 65 0f 29  |.........$m.we.)|
+00000090  b9 e5 1d df a9 e7 98 f6  f3 37 70 4b 8f cf 49 db  |.........7pK..I.|
+000000a0  fb 8f 73 fc 7f 9e ea e0  a0 35 ee 93 a0 34 17 03  |..s......5...4..|
+000000b0  03 02 6d 90 a9 c1 79 ef  b1 e3 7a 7d 3d f6 8e bd  |..m...y...z}=...|
+000000c0  18 04 6a 1c d4 72 52 ad  36 fc 21 c6 0b 94 8b 98  |..j..rR.6.!.....|
+000000d0  0e 98 54 c5 ff 3c 6d d2  15 c4 63 51 a6 00 4b 28  |..T..<m...cQ..K(|
+000000e0  c7 63 61 5c 09 0d 15 fc  53 0d fa b6 59 ff c9 82  |.ca\....S...Y...|
+000000f0  e1 93 6d 3d b0 24 b2 5d  23 d1 da 61 7f c9 79 32  |..m=.$.]#..a..y2|
+00000100  65 5f 41 6e 49 28 8e 1f  cd 7e 12 98 48 c9 79 ea  |e_AnI(...~..H.y.|
+00000110  db 5a 7f d5 4b dc 41 3c  64 5d 50 83 a2 2b 8c d2  |.Z..K.A<d]P..+..|
+00000120  d7 9e 96 99 25 05 b6 5c  48 62 1c 65 f7 2a a2 77  |....%..\Hb.e.*.w|
+00000130  df 46 30 8f 8a 39 9f 79  49 2d 47 97 75 b7 26 a3  |.F0..9.yI-G.u.&.|
+00000140  5b ee 67 f0 67 ae 1a 9d  f2 77 2f b6 3a 70 52 f8  |[.g.g....w/.:pR.|
+00000150  5d 26 58 21 9e 73 6a 00  99 75 bb 8e 8d b0 2c b9  |]&X!.sj..u....,.|
+00000160  05 cf 69 fe ec 45 06 d5  1d ca f9 c3 08 97 c0 e9  |..i..E..........|
+00000170  38 d8 76 27 d4 4b 40 42  f8 73 bf 7b 4b 42 5e 13  |8.v'.K@B.s.{KB^.|
+00000180  11 7e 75 af 92 7f 47 92  9e d8 15 b4 07 10 bf 74  |.~u...G........t|
+00000190  4f 55 4e 0d 4c 53 b6 5c  f8 07 87 40 0f 79 4e 76  |OUN.LS.\...@.yNv|
+000001a0  0a 19 48 48 37 a6 3c a1  69 56 5f 85 19 61 84 28  |..HH7.<.iV_..a.(|
+000001b0  8c 01 cf 0b 79 94 0f 31  e9 ca ad 5e fb a4 4e 21  |....y..1...^..N!|
+000001c0  13 de b7 d3 fd 38 6f c6  37 42 23 89 e1 23 e0 92  |.....8o.7B#..#..|
+000001d0  f4 ca 3b 92 b4 6d 87 32  11 c6 b5 80 27 d9 de b3  |..;..m.2....'...|
+000001e0  80 fa c4 0d a7 de 0a b3  39 79 3a bc 38 e0 fa 5c  |........9y:.8..\|
+000001f0  ec 3f ab cb a7 d9 02 c4  56 6b f8 90 73 50 98 be  |.?......Vk..sP..|
+00000200  0f ad 95 22 3e 20 97 7c  50 f9 8d 8a 43 4a 20 d1  |..."> .|P...CJ .|
+00000210  68 1c 2f bf 4e 72 a0 51  9f 22 d1 51 bf b4 b0 b1  |h./.Nr.Q.".Q....|
+00000220  fe 78 2b 0e a9 6d f1 27  82 46 a9 2d 43 73 29 0c  |.x+..m.'.F.-Cs).|
+00000230  c2 6d f8 0c c9 78 d3 ba  5d 5f 96 13 fd 2f 1f e9  |.m...x..]_.../..|
+00000240  8f 93 e6 61 7e 0e 07 49  cb 5c af 51 72 85 67 b8  |...a~..I.\.Qr.g.|
+00000250  63 e8 f9 4f 7c d7 e4 d1  25 c0 ed 26 de 1f 65 d4  |c..O|...%..&..e.|
+00000260  2a 3b 23 30 38 12 56 97  01 f1 bd 3f 96 23 72 89  |*;#08.V....?.#r.|
+00000270  2e 88 d6 6a 9f 52 a7 3e  42 72 dc c4 e0 05 81 42  |...j.R.>Br.....B|
+00000280  45 e1 c5 6f 32 82 bf 4e  38 a0 06 eb 99 2c 8b 79  |E..o2..N8....,.y|
+00000290  f9 2e a7 26 3a 78 fd 90  66 7c 0f 53 4c 4a 00 c2  |...&:x..f|.SLJ..|
+000002a0  9d 48 2c a5 37 02 e0 cd  5d 16 1c d4 ee 03 79 71  |.H,.7...].....yq|
+000002b0  c6 c2 e4 15 98 6b 40 bb  e9 b6 21 a1 e7 fc 68 b2  |.....k@...!...h.|
+000002c0  70 cb d5 e1 5b 2d f7 b7  6b d5 2c 50 19 8a 6a 50  |p...[-..k.,P..jP|
+000002d0  54 97 bc 90 2b b2 20 6a  9c 96 5d cf d0 5f 9a 6d  |T...+. j..].._.m|
+000002e0  b4 70 33 ba 83 2d f7 86  41 8b 88 20 51 ae a8 02  |.p3..-..A.. Q...|
+000002f0  af 63 ea 1c 0c b0 99 19  73 56 02 68 a9 50 b2 43  |.c......sV.h.P.C|
+00000300  6b 9c 5d c2 f3 48 dd fe  a3 7c 2b 28 a5 e5 25 ed  |k.]..H...|+(..%.|
+00000310  05 14 a3 d6 63 25 2e 44  4e f9 fd 6d 9e 16 ae e6  |....c%.DN..m....|
+00000320  17 03 03 00 99 b8 3d db  c6 ee 13 dd 97 29 32 71  |......=......)2q|
+00000330  67 28 89 90 cf c5 23 4a  9e 94 31 7c 5d 6c b3 7c  |g(....#J..1|]l.||
+00000340  46 a6 b2 98 c2 e2 b9 a6  c1 7d fd 22 5c 7b 88 67  |F........}."\{.g|
+00000350  cc c6 4a 82 83 f9 8a 09  8b 2c d5 9f 0f c3 1d 23  |..J......,.....#|
+00000360  b5 27 89 ba 5e 0f 74 96  58 da 5e 3f 63 b2 f3 44  |.'..^.t.X.^?c..D|
+00000370  31 86 d0 da 18 54 eb 34  89 fc 11 ee 8e af c1 42  |1....T.4.......B|
+00000380  bd 6b 31 c3 f1 54 96 fd  86 37 0d 20 b9 70 3b 88  |.k1..T...7. .p;.|
+00000390  20 87 c3 9f 1a 6b 90 7d  84 1d 69 42 01 bc 3d 81  | ....k.}..iB..=.|
+000003a0  c9 ea 82 a3 d1 18 bf 4c  3a dc d4 db 92 cc 5d b2  |.......L:.....].|
+000003b0  f2 dd b4 17 39 13 ef 45  cc 66 4d d1 f2 a4 17 03  |....9..E.fM.....|
+000003c0  03 00 35 3f 02 3e 15 06  ad 50 e9 14 30 be 33 d9  |..5?.>...P..0.3.|
+000003d0  18 1c 44 df 42 fa 3f aa  84 31 a7 b3 d8 3c 8e 04  |..D.B.?..1...<..|
+000003e0  b3 fc 41 66 4a f0 71 03  0d 0b b5 46 f1 34 f5 37  |..AfJ.q....F.4.7|
+000003f0  4c 1c 1a 05 75 98 58 f3                           |L...u.X.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 39 60 84 ac d0  |..........59`...|
-00000010  b9 47 4b 47 49 af 52 88  3c 12 50 0d 65 46 f7 a1  |.GKGI.R.<.P.eF..|
-00000020  50 39 c5 39 22 b3 45 e6  d3 25 44 a6 bc 3d bc 69  |P9.9".E..%D..=.i|
-00000030  35 1d 61 cf a0 3c 53 77  94 67 66 ae 37 7f 3f 84  |5.a..<Sw.gf.7.?.|
-00000040  17 03 03 00 17 5e 1d af  5b 7c b6 2d 19 ea 18 e0  |.....^..[|.-....|
-00000050  55 47 43 e1 f2 0e 28 49  ae ef ba 86 17 03 03 00  |UGC...(I........|
-00000060  13 2c 10 48 8c cf d6 1a  a1 80 62 34 90 e4 42 50  |.,.H......b4..BP|
-00000070  44 b3 58 bb                                       |D.X.|
+00000000  14 03 03 00 01 01 17 03  03 00 35 61 48 9d d3 32  |..........5aH..2|
+00000010  7b ac 9d 5a c5 29 b2 4f  74 ef b8 8e f0 1e b9 33  |{..Z.).Ot......3|
+00000020  4f cb db 0b 3e 49 47 44  64 ce 16 6b e4 a2 7c 8a  |O...>IGDd..k..|.|
+00000030  cc e4 01 9e bd 3d a7 30  cd a1 ff 23 d2 fc 7f fc  |.....=.0...#....|
+00000040  17 03 03 00 17 6b a9 a0  55 b2 53 19 0f 58 7c 79  |.....k..U.S..X|y|
+00000050  5a 19 9a 4a 9b 1b 77 8d  78 9c 9c b6 17 03 03 00  |Z..J..w.x.......|
+00000060  13 f0 e9 91 46 e4 0a a1  0f e9 43 8e 10 d7 61 80  |....F.....C...a.|
+00000070  95 4b db 96                                       |.K..|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-CHACHA20-SHA256 b/src/crypto/tls/testdata/Client-TLSv13-CHACHA20-SHA256
index c4c29e1b85..6becede60f 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-CHACHA20-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv13-CHACHA20-SHA256
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,85 +7,87 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 3d 50 78 7e 02  |....z...v..=Px~.|
-00000010  dc 79 3a 32 6b 6a 50 24  90 65 72 5e cd fc 96 18  |.y:2kjP$.er^....|
-00000020  e1 47 21 43 50 5a 32 0f  cf e7 ae 20 00 00 00 00  |.G!CPZ2.... ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 37 bf a4 0d 23  |....z...v..7...#|
+00000010  be 83 2a 9d 84 f6 de 1c  53 be 13 92 f3 de 35 a9  |..*.....S.....5.|
+00000020  cc 95 6d e1 c6 05 2f 53  a6 ce 9f 20 00 00 00 00  |..m.../S... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 cd  |..+.....3.$... .|
-00000060  e6 a0 65 6b 1c 9e 5c f0  b7 f9 82 8e 37 d1 c4 35  |..ek..\.....7..5|
-00000070  31 c1 3f df 4a 70 33 ba  38 d9 3f 74 0c c2 61 14  |1.?.Jp3.8.?t..a.|
-00000080  03 03 00 01 01 17 03 03  00 17 63 c3 02 95 17 f4  |..........c.....|
-00000090  a8 76 8d 54 ad 3c 10 c7  cc e8 08 13 d6 9b 0b 0f  |.v.T.<..........|
-000000a0  db 17 03 03 02 6d 0f ec  8d 0d e5 1a 85 02 3f 92  |.....m........?.|
-000000b0  44 09 ac e6 da 2d c8 d7  14 68 00 9d 22 bf 05 1d  |D....-...h.."...|
-000000c0  cd 07 b5 8b b9 84 3f cf  cc c5 48 40 00 2e e1 c9  |......?...H@....|
-000000d0  0b 41 6d 39 cb 05 00 d6  7a 10 4a ba 96 e1 96 a9  |.Am9....z.J.....|
-000000e0  70 d8 20 76 2f d2 70 83  cb a0 d1 72 43 db 09 cd  |p. v/.p....rC...|
-000000f0  2d e5 89 11 e8 81 15 13  dd 29 2a c8 88 4a d8 73  |-........)*..J.s|
-00000100  35 3d 8e 8a 03 ca ed 32  a9 16 bb 71 88 d5 5f a1  |5=.....2...q.._.|
-00000110  1b ec ee 9e 3d 8c f4 d0  c2 5b 72 84 3c 75 aa de  |....=....[r.<u..|
-00000120  10 a7 78 5a 62 3e b9 11  da 83 94 29 d3 40 8f da  |..xZb>.....).@..|
-00000130  3c f4 32 90 c0 25 b7 f0  fc 6b 16 c1 ab 80 69 79  |<.2..%...k....iy|
-00000140  5e dd 95 5a ba e4 5a 68  64 a6 44 f5 a2 3a d6 30  |^..Z..Zhd.D..:.0|
-00000150  7e b1 27 b1 79 44 ef 79  95 51 75 02 24 2c ea ab  |~.'.yD.y.Qu.$,..|
-00000160  d5 e1 fd aa 81 55 89 cf  bc 9c 11 2b 0b 4a 99 9f  |.....U.....+.J..|
-00000170  50 93 68 a1 c8 79 3d d8  aa d8 54 e3 d5 1a 97 90  |P.h..y=...T.....|
-00000180  33 87 a9 70 1d 9d ba 78  d0 87 8a 98 6f 1b 1e b0  |3..p...x....o...|
-00000190  e8 92 78 df 21 61 88 36  fa 14 4b c9 b1 a4 93 88  |..x.!a.6..K.....|
-000001a0  b4 26 9a 13 1b 8f 6c 84  bc b1 78 a8 a1 e7 64 4b  |.&....l...x...dK|
-000001b0  d4 56 37 b6 d1 80 6d 8d  0f c2 2f 0c 0b 9e 42 8e  |.V7...m.../...B.|
-000001c0  37 e0 9b 73 e4 ab cf 24  43 86 bc d0 40 fd db 4a  |7..s...$C...@..J|
-000001d0  c1 f6 55 56 e9 54 5c c7  3c 17 36 44 7b 99 7e 03  |..UV.T\.<.6D{.~.|
-000001e0  48 f7 a9 cc 4d b9 b4 bf  09 dd 96 37 8c b5 d5 f0  |H...M......7....|
-000001f0  bd af 19 0e 82 6c 5d b6  96 ca 98 a2 56 d3 68 f2  |.....l].....V.h.|
-00000200  94 cd 7a 94 8d b3 97 16  03 3d 6a 94 5d 66 32 5d  |..z......=j.]f2]|
-00000210  11 28 d9 7b c1 8e b1 c4  ec b7 54 94 3b 80 f9 b3  |.(.{......T.;...|
-00000220  9d 2d 74 3c 02 55 a0 4a  02 b7 61 19 b0 a2 e6 44  |.-t<.U.J..a....D|
-00000230  3e c8 81 e3 a4 18 d7 4c  16 d2 fb e3 90 2c 61 71  |>......L.....,aq|
-00000240  a0 82 28 48 de 7c 7c bd  ba 27 85 e1 fd c9 df ac  |..(H.||..'......|
-00000250  b2 61 0f 80 f3 86 31 8f  c1 a3 dc b6 43 98 c9 0e  |.a....1.....C...|
-00000260  73 dd 1d cf 61 f6 25 23  44 ca 5a 4c 12 6c bb 35  |s...a.%#D.ZL.l.5|
-00000270  32 c4 32 0d cc 8c 11 b9  4a ee 88 92 d6 27 d4 a8  |2.2.....J....'..|
-00000280  25 59 1e fe ba 41 63 50  1e b1 e2 c5 75 95 7d 56  |%Y...AcP....u.}V|
-00000290  60 ed 81 d0 e7 12 05 e7  0f b4 5d 6f 27 98 76 72  |`.........]o'.vr|
-000002a0  e7 8a e1 ff 5d 6b 29 9f  75 24 a5 fd 6d 1f bc 58  |....]k).u$..m..X|
-000002b0  f8 b8 67 d1 b0 21 25 f1  09 c7 f9 41 f5 85 1b eb  |..g..!%....A....|
-000002c0  56 f6 14 83 bb 08 d5 3e  ed 22 e1 c5 9c 14 cc de  |V......>."......|
-000002d0  d3 45 e1 0e e3 cb 61 b5  ab f6 03 41 bc 71 5d 17  |.E....a....A.q].|
-000002e0  99 c6 8f 13 41 f8 78 e8  da 3d 40 1c 1a 47 a9 b2  |....A.x..=@..G..|
-000002f0  e7 22 90 2f d8 8f 6f 0d  36 02 b1 36 fa 6d 26 6f  |."./..o.6..6.m&o|
-00000300  82 e2 54 74 a0 26 3c 0c  57 bb d7 01 ff ee 6f 16  |..Tt.&<.W.....o.|
-00000310  63 92 00 17 03 03 00 99  ea 68 e4 08 10 2d 6f b6  |c........h...-o.|
-00000320  a2 f8 f5 03 35 00 63 c8  da 23 4c 96 b8 2a 5c f5  |....5.c..#L..*\.|
-00000330  9d 24 6f 5a 5b c3 aa d2  df d9 16 b6 9a 91 79 39  |.$oZ[.........y9|
-00000340  18 35 65 28 80 97 fe 76  26 79 45 80 4c 8a 7c cc  |.5e(...v&yE.L.|.|
-00000350  a2 36 1a 8a ad aa f3 06  08 1f b7 4a 9b 22 7f 37  |.6.........J.".7|
-00000360  62 3a ae 13 c0 f4 22 05  6f fc 92 5a e0 ed f1 5b  |b:....".o..Z...[|
-00000370  c6 6b 4f 18 83 a6 39 a7  5c 1c 53 32 08 76 25 03  |.kO...9.\.S2.v%.|
-00000380  20 d5 47 57 76 06 38 4e  bd b8 dd 7f 0e 37 b3 4e  | .GWv.8N.....7.N|
-00000390  f1 f3 b1 98 d4 f0 d6 00  ea 6a e9 ec a4 b0 fd 20  |.........j..... |
-000003a0  2d 67 20 c8 ef 9f a1 97  00 cd 15 c2 8e c2 ba 46  |-g ............F|
-000003b0  76 17 03 03 00 35 d0 f3  18 d0 71 4c 66 8c 40 ef  |v....5....qLf.@.|
-000003c0  57 92 f3 56 5a 42 1e 4c  e6 13 5a cc ab 26 90 6a  |W..VZB.L..Z..&.j|
-000003d0  9b ca 49 b0 81 ec 38 30  44 27 5a fa ac d6 1f 5c  |..I...80D'Z....\|
-000003e0  bc 64 4b 0b c3 69 b2 5b  ef 7f 4a                 |.dK..i.[..J|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 3d  |..+.....3.$... =|
+00000060  1c 09 5d 44 bc 3f 39 2d  9a dd c1 15 0f dc 5d 7c  |..]D.?9-......]||
+00000070  93 06 89 42 27 f0 cd 63  55 3e 74 3f 87 10 7a 14  |...B'..cU>t?..z.|
+00000080  03 03 00 01 01 17 03 03  00 17 bd 92 4d 21 8d dc  |............M!..|
+00000090  7b 19 1b f9 44 64 38 5c  61 c3 19 70 75 29 05 e8  |{...Dd8\a..pu)..|
+000000a0  ef 17 03 03 02 6d a4 a0  79 ad 41 c1 d2 6b 78 fd  |.....m..y.A..kx.|
+000000b0  4b 1f 6f 72 c4 92 94 17  dd 40 80 b6 f2 a0 85 4d  |K.or.....@.....M|
+000000c0  ba 4c 3a 34 80 67 21 2f  6d 2e fc 4e a8 2b ab 86  |.L:4.g!/m..N.+..|
+000000d0  18 6c 03 2d e6 ac 2c 3c  ce 4c 2d ff 7d fd 44 fc  |.l.-..,<.L-.}.D.|
+000000e0  4e 1d 62 c5 b1 22 60 6c  56 1e 6d bf d8 90 02 cb  |N.b.."`lV.m.....|
+000000f0  d2 6c 52 7c f3 51 11 49  62 7a f0 f3 8f 51 bf 0e  |.lR|.Q.Ibz...Q..|
+00000100  bc 07 9b 1f d9 32 26 d8  c5 01 4d 84 31 3f 4b 33  |.....2&...M.1?K3|
+00000110  d0 c7 0c 86 89 bc 88 7d  70 6d 70 38 89 5b 8c d0  |.......}pmp8.[..|
+00000120  4d c0 9d 35 20 50 52 c7  5d 9c b3 51 30 46 6a 12  |M..5 PR.]..Q0Fj.|
+00000130  54 36 34 55 9a 25 43 39  28 40 13 9a 56 fa a7 f9  |T64U.%C9(@..V...|
+00000140  1f 3c 0f da fb ce c2 ed  da 9f 6c 99 53 76 74 a8  |.<........l.Svt.|
+00000150  4b 62 8a 55 cf a1 bc 5f  10 bb 8e 77 c8 4f bd 1b  |Kb.U..._...w.O..|
+00000160  d4 72 07 00 4c 8b b6 d7  3a 1a 43 93 34 b4 0a 2d  |.r..L...:.C.4..-|
+00000170  62 62 a1 e6 96 1a 71 38  a9 06 ae 6f ca 08 6f 52  |bb....q8...o..oR|
+00000180  09 c7 c8 37 13 4c 3b be  7b 60 29 7b d4 28 3e 71  |...7.L;.{`){.(>q|
+00000190  55 29 bd ab 62 3c 90 1f  8c ed 55 5d 81 85 0b 63  |U)..b<....U]...c|
+000001a0  57 8e f9 50 eb b8 3e c6  e0 b0 fa cc 68 42 41 0c  |W..P..>.....hBA.|
+000001b0  b0 34 f7 5d 39 f4 cd fe  9c ac 42 78 60 b2 27 55  |.4.]9.....Bx`.'U|
+000001c0  c2 2e e0 aa 84 00 8f 80  11 d2 52 92 78 2d b7 f6  |..........R.x-..|
+000001d0  70 37 e8 87 0b 13 04 29  5b a2 50 fb 4d ad 5e 98  |p7.....)[.P.M.^.|
+000001e0  59 a1 f7 7a 80 30 42 c2  59 96 97 f8 47 88 25 f3  |Y..z.0B.Y...G.%.|
+000001f0  25 02 ec 9c f3 93 97 63  b1 b2 90 0a 96 66 17 68  |%......c.....f.h|
+00000200  3d f0 32 5b d2 4a 3b 97  95 30 f1 22 be f9 04 87  |=.2[.J;..0."....|
+00000210  8d 58 d6 81 62 00 85 6c  76 07 c4 7d 05 42 0e 25  |.X..b..lv..}.B.%|
+00000220  7b 0d 92 42 bb 8a 36 47  11 2f f1 59 aa 01 44 28  |{..B..6G./.Y..D(|
+00000230  96 f0 f6 22 c4 74 c7 1b  3f 9d 67 30 f5 72 f8 24  |...".t..?.g0.r.$|
+00000240  b7 5c 9f d5 cb 51 a8 e5  6c b3 f6 0b 00 86 fc bb  |.\...Q..l.......|
+00000250  ab 1f d8 89 07 e9 a6 0b  48 93 e6 6e ca a3 b4 9a  |........H..n....|
+00000260  bc 5c 9c 4e ae 64 17 9d  4d 1f b7 c9 fa 8e a3 94  |.\.N.d..M.......|
+00000270  a0 da 4e 17 1a b8 f8 1a  a7 df dd cb 29 3b bb cf  |..N.........);..|
+00000280  1a 26 a2 74 d6 b2 80 63  f4 fb 28 10 ea 27 fa 48  |.&.t...c..(..'.H|
+00000290  d8 e6 68 34 0f 5f ca 20  e9 3e 01 77 f2 e8 23 70  |..h4._. .>.w..#p|
+000002a0  29 67 60 96 81 63 2e 7f  7d d3 30 fa 4c e1 fc bd  |)g`..c..}.0.L...|
+000002b0  a2 94 e5 1a 0c f3 bc 68  19 aa 20 09 7c 37 68 ac  |.......h.. .|7h.|
+000002c0  d2 3e 08 1c e5 fb e6 ef  b4 1b 8b 58 9c 32 ef 66  |.>.........X.2.f|
+000002d0  a0 a3 32 4f ce 37 5b 2f  99 d0 65 1a 26 2c 69 ca  |..2O.7[/..e.&,i.|
+000002e0  53 2a a2 cb 95 b6 a4 aa  bf 51 53 ab 56 73 22 ad  |S*.......QS.Vs".|
+000002f0  b0 26 18 dd 9c 34 f4 01  bc 10 7c fb b0 b4 97 55  |.&...4....|....U|
+00000300  93 fb 94 b1 16 2f 31 50  a5 fa d4 1d 7c b1 a3 3a  |...../1P....|..:|
+00000310  28 c1 ab 17 03 03 00 99  37 2c 7e fb bc 61 42 37  |(.......7,~..aB7|
+00000320  b4 d1 ab 9c e2 45 25 1f  dd 2a d3 f2 90 a1 25 01  |.....E%..*....%.|
+00000330  26 44 18 6b f3 ba c5 a1  e2 d2 71 c8 00 81 97 2d  |&D.k......q....-|
+00000340  08 a7 f3 4e 9e 8c b4 d2  a4 22 77 89 65 23 82 56  |...N....."w.e#.V|
+00000350  f6 21 f3 5f 06 0c 50 9b  5b 09 b5 b9 a4 d8 d5 dd  |.!._..P.[.......|
+00000360  e6 2b 98 8b 7d c7 0e 5c  00 1d 2b ab 52 d0 1a 57  |.+..}..\..+.R..W|
+00000370  9f d2 ee 5c c8 5c 9e da  df 36 f5 29 2c 31 ec 93  |...\.\...6.),1..|
+00000380  36 61 2c a6 a2 09 04 f5  58 ed ac e8 cc b9 20 11  |6a,.....X..... .|
+00000390  94 73 f7 98 0b 88 46 7d  37 f2 2d 67 57 e5 66 cb  |.s....F}7.-gW.f.|
+000003a0  69 03 3b 1d ec 98 e8 98  d0 48 d1 15 34 22 f1 d5  |i.;......H..4"..|
+000003b0  2e 17 03 03 00 35 50 7a  9f 59 68 a8 06 55 35 93  |.....5Pz.Yh..U5.|
+000003c0  ae 92 9d e6 1a 9b 33 c6  bb ee 1a 4a 87 29 89 e6  |......3....J.)..|
+000003d0  69 0c b7 c9 b5 1d 73 9d  70 4c 4e 35 e2 a6 b3 9e  |i.....s.pLN5....|
+000003e0  0e 51 06 42 dd bf b0 6b  32 b3 8b                 |.Q.B...k2..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 ef 3b a2 4d 0f  |..........5.;.M.|
-00000010  69 53 f2 a3 80 a0 06 a9  99 a9 15 1e bc 8b 4a 08  |iS............J.|
-00000020  de 87 e7 b6 10 d6 b3 fc  89 f8 24 f9 2d 04 a1 fd  |..........$.-...|
-00000030  c2 ce eb 14 e9 df bf ab  80 8e f1 00 53 60 88 82  |............S`..|
-00000040  17 03 03 00 17 22 aa a9  e0 1f f8 55 03 22 9b 0f  |.....".....U."..|
-00000050  b2 6d 73 be 10 5d 6c c6  d8 0e 5e 0d 17 03 03 00  |.ms..]l...^.....|
-00000060  13 45 f2 81 7f ea ae 0d  77 bb d4 05 1e 55 af a8  |.E......w....U..|
-00000070  3e 0d 10 0f                                       |>...|
+00000000  14 03 03 00 01 01 17 03  03 00 35 6a 64 a5 70 df  |..........5jd.p.|
+00000010  c8 89 29 86 27 8e 2f 03  f0 a3 26 0b f4 d2 99 73  |..).'./...&....s|
+00000020  0d 52 8b 49 ac 3a 61 0c  30 0f 89 8b 29 91 8c 30  |.R.I.:a.0...)..0|
+00000030  1d 82 4d c2 92 9f 47 33  9a 59 b9 a0 da 8b a9 0e  |..M...G3.Y......|
+00000040  17 03 03 00 17 e2 b8 0e  b0 8d eb a1 b2 1f 07 70  |...............p|
+00000050  fc 0e 0f 06 c7 fa b3 cc  9e 95 d8 bc 17 03 03 00  |................|
+00000060  13 04 92 08 57 71 45 d0  65 d9 c9 27 05 49 e1 7e  |....WqE.e..'.I.~|
+00000070  12 c9 77 07                                       |..w.|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-ECDSA-RSA b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-ECDSA-RSA
index db13bd6387..9aa65c6754 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-ECDSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-ECDSA-RSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,134 +7,136 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 37 0c 23 2f 26  |....z...v..7.#/&|
-00000010  2a b0 8d 47 84 3b 9b 9c  7e 0f 0a cd 77 39 6c c2  |*..G.;..~...w9l.|
-00000020  7b c0 56 a8 9d 07 a0 ec  b6 e5 79 20 00 00 00 00  |{.V.......y ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 71 fd 9f ba 42  |....z...v..q...B|
+00000010  4c 98 22 8e 16 d3 63 6c  a6 34 c2 41 37 f9 98 ad  |L."...cl.4.A7...|
+00000020  7a a6 c5 61 12 df 37 32  a2 95 a3 20 00 00 00 00  |z..a..72... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 5e  |..+.....3.$... ^|
-00000060  9a da 1d cb 90 03 f2 d2  23 e3 54 fc 3d 9b 8c 92  |........#.T.=...|
-00000070  42 df cf 7a 3d 47 3f 66  a4 a6 7a 07 44 76 5c 14  |B..z=G?f..z.Dv\.|
-00000080  03 03 00 01 01 17 03 03  00 17 53 54 e6 de 6a af  |..........ST..j.|
-00000090  c2 d9 b8 39 b6 ae 3e 9f  54 60 e1 fa 29 5a fb 16  |...9..>.T`..)Z..|
-000000a0  20 17 03 03 00 42 f4 a5  7f e3 e7 ba 6a 88 e1 f2  | ....B......j...|
-000000b0  fd 25 3e ba 05 00 29 77  ff 69 6e e0 ac 50 99 50  |.%>...)w.in..P.P|
-000000c0  ac 1e bd 8c 52 e6 28 5d  67 bb bb 20 61 69 5b 97  |....R.(]g.. ai[.|
-000000d0  7f 29 79 97 bf 13 24 25  ad 3b 01 78 c4 a4 4e 9a  |.)y...$%.;.x..N.|
-000000e0  06 d6 20 da 63 27 97 8d  17 03 03 02 6d 79 7e 9e  |.. .c'......my~.|
-000000f0  01 98 a9 7c ba 63 43 2b  21 b1 bc 2c b2 17 c2 35  |...|.cC+!..,...5|
-00000100  76 f2 30 01 69 45 d4 56  e0 5a 2c 62 aa 6f a8 1f  |v.0.iE.V.Z,b.o..|
-00000110  b8 31 df be 6f 3f 60 16  dc 61 5c 9f 99 a9 63 7d  |.1..o?`..a\...c}|
-00000120  7e 2b d2 ae 02 46 12 db  be 51 9e 15 dd 1c 96 b0  |~+...F...Q......|
-00000130  74 69 20 c0 e1 78 46 01  a6 23 72 28 ba c7 a3 48  |ti ..xF..#r(...H|
-00000140  1e dc 0b 57 c9 b4 39 88  3d 39 c7 6c 38 c7 3a 29  |...W..9.=9.l8.:)|
-00000150  a4 45 79 10 04 61 cd db  df 5b 88 c1 35 4b 38 ea  |.Ey..a...[..5K8.|
-00000160  6d 72 57 9f e0 2e 37 61  3d c8 aa b2 25 a6 11 5c  |mrW...7a=...%..\|
-00000170  09 e2 3a 17 d3 c5 37 2f  a7 b4 73 fe e2 61 df 1d  |..:...7/..s..a..|
-00000180  cd 4f 72 4a 67 c3 c7 e2  53 78 61 78 2c 37 44 12  |.OrJg...Sxax,7D.|
-00000190  4d 0e 8c 14 0b de 3b a4  cf ad 8f d4 74 61 77 4b  |M.....;.....tawK|
-000001a0  36 2d f2 8f 68 95 38 9d  e2 9f cf cc 03 15 89 b9  |6-..h.8.........|
-000001b0  96 c4 47 e5 2f 65 0a 5c  5d 8f 5c 64 9d c8 76 d2  |..G./e.\].\d..v.|
-000001c0  5d a7 90 4d f5 84 2d 31  2d 6c bd ee 0d 45 2b 50  |]..M..-1-l...E+P|
-000001d0  79 f7 8c 34 40 f9 bc f4  38 b3 56 a9 6b ca 54 50  |y..4@...8.V.k.TP|
-000001e0  19 f8 9a 73 74 9b 0a 92  ee 22 53 05 01 38 43 3a  |...st...."S..8C:|
-000001f0  49 fe 2d e9 39 c1 76 b0  04 df 8a 3d cc fc 9b 84  |I.-.9.v....=....|
-00000200  cd 22 ba 40 24 69 93 b9  c5 b3 ed fd ad 94 1b 83  |.".@$i..........|
-00000210  b5 07 a9 e7 94 14 4b c1  59 89 78 56 03 28 29 c3  |......K.Y.xV.().|
-00000220  a8 a4 96 14 5a 51 9a 50  f9 34 3c 5a 76 8f 74 68  |....ZQ.P.4<Zv.th|
-00000230  63 cc 5c 0c de e2 30 b8  c0 46 13 78 c5 92 97 7f  |c.\...0..F.x....|
-00000240  23 74 0b 54 4e ea 6e 5d  bd 8e b8 89 12 2c 01 b0  |#t.TN.n].....,..|
-00000250  ed 03 4d 67 1e 96 22 03  77 78 d1 4f c0 b7 4a 71  |..Mg..".wx.O..Jq|
-00000260  6b 11 a3 c4 18 7a da c4  b5 7b 78 74 21 f5 44 49  |k....z...{xt!.DI|
-00000270  70 0e 78 34 fb 66 ed a1  86 52 3c 93 de 17 a1 4d  |p.x4.f...R<....M|
-00000280  4a f3 f6 9e ff f8 e1 18  b9 80 12 9a 34 7a 58 bb  |J...........4zX.|
-00000290  7a aa 95 d0 c7 a7 88 d2  d3 86 bf 7a c9 e3 fc 83  |z..........z....|
-000002a0  c6 b9 db ee ad eb b8 fd  4b 82 4f 34 9d eb 45 eb  |........K.O4..E.|
-000002b0  33 19 aa a5 b6 82 47 b3  5b f4 e7 be f0 49 bd 76  |3.....G.[....I.v|
-000002c0  41 82 8d 09 86 82 cb 45  12 f8 aa 9a 99 43 da 31  |A......E.....C.1|
-000002d0  4f cb 9e c4 f6 a0 40 85  2b 9d 55 6e 15 66 b5 f8  |O.....@.+.Un.f..|
-000002e0  0b 3e 0e aa 4b aa 2e 6b  2a 44 3f ea 23 d5 ab 55  |.>..K..k*D?.#..U|
-000002f0  a0 11 51 04 0b 82 02 d9  24 85 13 2e d1 29 44 9a  |..Q.....$....)D.|
-00000300  15 7f a4 1b c4 f5 36 44  88 9a 6e 5a 1e 2f 14 fa  |......6D..nZ./..|
-00000310  d0 e7 fc 6a fa e5 f3 4a  55 20 73 9b e4 73 2e 47  |...j...JU s..s.G|
-00000320  88 25 b7 69 d9 28 fe 50  8c fc f2 94 29 84 c4 7f  |.%.i.(.P....)...|
-00000330  d6 b2 eb 28 fa 51 8e ff  00 09 35 d3 b2 32 3a c6  |...(.Q....5..2:.|
-00000340  bb 91 a7 c4 b7 88 df 4b  f7 09 ef e7 e1 92 60 cd  |.......K......`.|
-00000350  de 34 4f 39 ee b8 ce 50  6a b9 17 03 03 00 99 64  |.4O9...Pj......d|
-00000360  76 ab 48 eb 68 7d a6 68  60 aa c2 93 bd 31 81 c8  |v.H.h}.h`....1..|
-00000370  b6 15 ba d1 54 94 04 1b  4b 29 86 e1 12 84 ad d5  |....T...K)......|
-00000380  ba eb 4a 7a 7a a8 56 41  04 8c 84 c7 83 46 8c 50  |..Jzz.VA.....F.P|
-00000390  c4 e3 02 d0 28 a4 fe 24  c4 b8 96 13 4f 87 27 ec  |....(..$....O.'.|
-000003a0  6b e3 84 4b 97 13 65 fa  1e 5e 9d ac 85 ea a0 3d  |k..K..e..^.....=|
-000003b0  67 96 e5 ec 88 84 6b 79  d9 16 55 c1 1c 72 17 aa  |g.....ky..U..r..|
-000003c0  9b 49 13 86 d4 39 0d 2a  c8 88 b3 5f f5 11 cb 5f  |.I...9.*..._..._|
-000003d0  bd 22 57 2c bc c1 01 72  b9 c3 f5 d9 a2 3b 8e ff  |."W,...r.....;..|
-000003e0  44 b2 82 b6 5b 35 75 b5  7a 50 40 81 4e a7 2d 40  |D...[5u.zP@.N.-@|
-000003f0  21 28 d9 c4 d9 e5 07 e1  17 03 03 00 35 23 ab b2  |!(..........5#..|
-00000400  60 56 47 6a fe cb 0e 54  22 d5 8f 29 0a 34 e6 82  |`VGj...T"..).4..|
-00000410  5b 10 35 ac 93 97 92 6b  39 5d b8 01 54 9c 86 b0  |[.5....k9]..T...|
-00000420  41 70 52 88 92 cf dd b7  f8 5d d1 18 e1 1f 78 53  |ApR......]....xS|
-00000430  e4 43                                             |.C|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 50  |..+.....3.$... P|
+00000060  f1 4d 28 5f 81 28 a7 d7  cb 82 20 48 91 0b 86 94  |.M(_.(.... H....|
+00000070  ae d8 b0 1c d0 84 55 5a  93 4c ee 65 9d 19 68 14  |......UZ.L.e..h.|
+00000080  03 03 00 01 01 17 03 03  00 17 7d af 66 34 6e f8  |..........}.f4n.|
+00000090  38 18 0a 6a 24 91 d8 6c  4d 7f e6 4c fc 40 8a a7  |8..j$..lM..L.@..|
+000000a0  bc 17 03 03 00 42 77 e7  1c fd d3 a9 f5 86 8e 92  |.....Bw.........|
+000000b0  f0 28 92 e5 e7 aa 8c 13  00 cb 07 0c b4 3d 13 7c  |.(...........=.||
+000000c0  2d 58 a0 94 0c 8f 4b 45  8d aa 97 7a 30 0e 78 d7  |-X....KE...z0.x.|
+000000d0  22 89 e0 8b 53 31 1b 9b  2d 7f f7 ff e0 b3 13 d5  |"...S1..-.......|
+000000e0  49 12 9e 50 31 38 eb d5  17 03 03 02 6d 65 2e 6f  |I..P18......me.o|
+000000f0  91 62 81 e9 8c fc 11 34  c1 59 58 44 3d 4f 74 6d  |.b.....4.YXD=Otm|
+00000100  ae 5a 47 29 56 6d 43 08  43 aa 69 d8 20 6c 02 99  |.ZG)VmC.C.i. l..|
+00000110  68 eb fa 47 c6 b0 7d 5b  70 2a a1 f9 f6 4f 70 02  |h..G..}[p*...Op.|
+00000120  88 f5 d1 b6 74 6e e2 54  7f fe 04 ce b2 03 9e e4  |....tn.T........|
+00000130  6e 3e 5d cf 27 49 de 90  7f 0a 2e 51 87 97 38 0e  |n>].'I.....Q..8.|
+00000140  cc f9 31 56 c5 bd b2 17  4c a4 a3 95 d7 c4 47 43  |..1V....L.....GC|
+00000150  58 cb 60 4f 73 65 71 e3  83 3d 60 04 d4 4d 6b a4  |X.`Oseq..=`..Mk.|
+00000160  96 c1 51 ec c5 48 29 13  ae 6d 7c 4c 0c 47 40 26  |..Q..H)..m|L.G@&|
+00000170  50 13 71 a9 55 3e bc 7b  ce a6 a5 8a 23 3e 41 d5  |P.q.U>.{....#>A.|
+00000180  2c 22 3e 3e 65 3e 53 0b  13 fb b9 36 25 77 bd 89  |,">>e>S....6%w..|
+00000190  f1 4e c2 99 5c 0a 14 c4  f8 9b da 01 a9 61 f5 a9  |.N..\........a..|
+000001a0  f5 a7 04 17 cc e5 a9 8b  b7 e8 ce 13 6c 87 75 99  |............l.u.|
+000001b0  cb 05 a5 2d c6 8d 03 73  b0 1c ba e3 64 66 d7 a9  |...-...s....df..|
+000001c0  b9 3c 16 41 ce ca 7a 9d  67 84 81 78 57 22 24 6e  |.<.A..z.g..xW"$n|
+000001d0  80 55 10 87 e4 6a b7 3e  62 23 84 ea a6 9b ee 1d  |.U...j.>b#......|
+000001e0  d0 32 96 74 7a b0 ed 05  a9 ca 53 8c 8c 66 bf ee  |.2.tz.....S..f..|
+000001f0  2d b4 5f 78 4a 7e 88 6a  bf e4 44 fc fb 71 df 9c  |-._xJ~.j..D..q..|
+00000200  34 a6 f0 4c 5b b9 0f a2  72 b4 28 0a 67 a2 99 be  |4..L[...r.(.g...|
+00000210  97 da 1d 64 24 c3 99 e6  cb 43 9a eb 28 6e 54 e9  |...d$....C..(nT.|
+00000220  34 5a 3c a1 1c 2f 07 27  a1 bf 1b fb a5 2f 61 8d  |4Z<../.'...../a.|
+00000230  26 ab f4 9f 7e ec 22 dc  4f 34 3d c9 6f 5d 6a 18  |&...~.".O4=.o]j.|
+00000240  30 09 bc f0 06 6d 3e bc  f7 96 9f 90 4b d8 e3 ac  |0....m>.....K...|
+00000250  96 3c f4 e2 3e 26 4a 43  07 1f 7e 79 08 f8 12 14  |.<..>&JC..~y....|
+00000260  82 1d 27 a5 16 d6 88 c2  31 26 8d 60 40 04 30 7b  |..'.....1&.`@.0{|
+00000270  49 7b 6d 11 d4 80 c5 09  9f 6a 85 f4 d3 41 ce c4  |I{m......j...A..|
+00000280  f6 bc 49 38 05 19 86 55  fa 9a 73 d7 5d 61 97 42  |..I8...U..s.]a.B|
+00000290  39 f2 6e 26 c7 11 ca b8  bf 85 2d 25 c2 83 30 6d  |9.n&......-%..0m|
+000002a0  17 07 af da 39 e9 c5 e4  88 f6 5f 58 e7 00 72 38  |....9....._X..r8|
+000002b0  e1 ac f4 75 eb 7f e2 00  d7 d9 e8 aa 77 8b 63 5e  |...u........w.c^|
+000002c0  85 4c c5 2a dd 8d 89 f4  ea ff 14 9d bb d7 b1 9a  |.L.*............|
+000002d0  7b d0 38 e9 9d 26 a9 79  f4 de 10 63 1f 09 67 bc  |{.8..&.y...c..g.|
+000002e0  51 ca 12 51 05 93 29 fe  5f 17 79 7f 84 e2 87 39  |Q..Q..)._.y....9|
+000002f0  d4 80 ac 76 fe c4 ab bb  63 06 64 b0 ba 5f 2f 8b  |...v....c.d.._/.|
+00000300  d9 b5 39 b5 80 69 0d 97  c6 f4 ce e1 2c cf 29 1c  |..9..i......,.).|
+00000310  e7 f4 b7 02 f5 da b4 63  26 d9 a9 4a 4e 34 66 56  |.......c&..JN4fV|
+00000320  c2 89 6a 12 95 16 9c 8b  b3 95 fb 8d 1f 4b 67 53  |..j..........KgS|
+00000330  5e 1f 68 70 ed 9b aa 89  78 16 88 d2 39 31 d9 59  |^.hp....x...91.Y|
+00000340  b5 bd 01 64 59 61 11 22  ab 73 f8 00 c3 7a 8c 45  |...dYa.".s...z.E|
+00000350  54 32 4f 5c 24 6a 0b 87  6c dc 17 03 03 00 99 4b  |T2O\$j..l......K|
+00000360  2d c9 21 11 87 71 41 cf  67 23 4e cd c8 7f e4 73  |-.!..qA.g#N....s|
+00000370  97 46 dd ff 0e 13 b4 4a  0e 81 4d fe 6c 0a 1d a0  |.F.....J..M.l...|
+00000380  b4 57 e5 4d e0 8d 82 e5  33 71 26 4a ef 72 8d 1f  |.W.M....3q&J.r..|
+00000390  a2 7b 43 e7 6c 99 19 24  18 7f 53 4a 16 c1 51 0c  |.{C.l..$..SJ..Q.|
+000003a0  3c 7d 3d c6 64 14 74 65  51 0b 04 09 dc c5 c0 ef  |<}=.d.teQ.......|
+000003b0  a1 a9 b3 d3 1d 16 2d 9a  5d 40 ec 13 9a 16 7c 9b  |......-.]@....|.|
+000003c0  6c 18 ba ec e3 e6 25 99  c3 1a 16 44 05 a3 85 ac  |l.....%....D....|
+000003d0  6a 49 e0 30 af 1c d1 5d  f5 6e e6 4b dc f3 71 49  |jI.0...].n.K..qI|
+000003e0  b0 5e 1d 7a e2 8b ba 13  7d a2 4a 12 cb 69 5a fe  |.^.z....}.J..iZ.|
+000003f0  7d cf e5 cf 0a d0 6e 26  17 03 03 00 35 cd 5a 61  |}.....n&....5.Za|
+00000400  28 1f 69 d8 c0 48 8a 10  4e 46 3a 51 06 87 28 8d  |(.i..H..NF:Q..(.|
+00000410  9d 68 60 bc e1 6e a4 a2  21 81 2a 17 57 b9 6a 7a  |.h`..n..!.*.W.jz|
+00000420  47 ae fb e0 a8 fc 7a 72  0f 9f 52 46 18 a8 b1 01  |G.....zr..RF....|
+00000430  0d 9b                                             |..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 02 1e 19 c5 11 9d 64  |...............d|
-00000010  8f f5 a9 21 53 fa cc 91  67 30 39 c0 77 d6 35 7b  |...!S...g09.w.5{|
-00000020  b8 a3 ae 44 8a 9a b1 68  5a 20 72 a6 ae 3a 1b 9f  |...D...hZ r..:..|
-00000030  03 eb d9 ed 91 20 49 ba  88 39 99 1c 4e 3a 2b 1b  |..... I..9..N:+.|
-00000040  42 b7 a3 97 a3 a3 6c 7e  3b 4c c1 74 dc 71 e6 14  |B.....l~;L.t.q..|
-00000050  6c 5a 36 12 cb 87 a6 75  ce b3 e3 a8 f2 c8 36 12  |lZ6....u......6.|
-00000060  3d c8 b8 2a 36 e4 40 38  3e 20 1d de 2a 31 b1 04  |=..*6.@8> ..*1..|
-00000070  86 cb 9b c1 f3 fc 01 67  7e 40 0b b8 c4 fa 8f a0  |.......g~@......|
-00000080  a7 5b 24 43 a9 d3 eb 55  99 ec 0b 19 cb ec 19 97  |.[$C...U........|
-00000090  c8 0f c0 5e 8c b2 b1 93  80 70 7c 0b aa 7c 6c 44  |...^.....p|..|lD|
-000000a0  1a 11 dc bd 0d 97 18 f3  ca c6 50 68 ca 77 ab 18  |..........Ph.w..|
-000000b0  79 a9 8b 73 13 48 90 c3  4a cd ae f2 60 ea 0c 20  |y..s.H..J...`.. |
-000000c0  eb ad 84 fb 2f 01 7e 2c  f6 7d ea da 22 59 5f 88  |..../.~,.}.."Y_.|
-000000d0  ff 10 19 81 d5 29 1b 0f  36 7b 84 66 eb bf e3 f9  |.....)..6{.f....|
-000000e0  1c 68 fa 03 93 3e ba c6  58 e2 a9 57 94 8c a8 29  |.h...>..X..W...)|
-000000f0  e2 f9 4b 6d 85 01 e8 f2  11 a2 04 38 73 8e 69 49  |..Km.......8s.iI|
-00000100  4b 7f ca be aa 5f 50 ac  82 16 e6 92 78 87 13 f4  |K...._P.....x...|
-00000110  fc 21 e8 2d 89 d0 f7 fb  73 0b f3 b7 6a 67 24 e8  |.!.-....s...jg$.|
-00000120  d9 33 59 49 d6 88 24 a2  66 f5 c8 4d fe 88 93 77  |.3YI..$.f..M...w|
-00000130  f9 3f ee ae 0b 6a 23 7a  8f b7 66 d4 68 7d 38 51  |.?...j#z..f.h}8Q|
-00000140  85 0a a0 f5 03 f6 e8 2f  cd 0b ac 58 64 82 38 20  |......./...Xd.8 |
-00000150  f2 72 0a 85 83 55 cb db  62 59 f4 40 08 28 f9 8a  |.r...U..bY.@.(..|
-00000160  47 a2 ea a1 1b e1 4c 0a  a4 74 cb a2 11 6f e5 68  |G.....L..t...o.h|
-00000170  e4 ff 38 b0 a5 fc 21 9e  eb de 43 b6 e7 27 cf 9a  |..8...!...C..'..|
-00000180  80 23 59 a2 e9 a8 12 ae  47 09 5c 48 c2 cb c8 e0  |.#Y.....G.\H....|
-00000190  a6 fa 81 c5 49 a4 77 4b  d3 83 0a ce 6e a5 2b 88  |....I.wK....n.+.|
-000001a0  f2 f5 12 2f 0e 7e 10 20  5b c7 31 39 54 ed 19 33  |.../.~. [.19T..3|
-000001b0  5c 94 b5 56 16 fa 0c b0  ec 28 76 fa 38 ca 08 c6  |\..V.....(v.8...|
-000001c0  13 c3 1f 8a 20 35 73 4b  bb bf d8 96 65 de cd f3  |.... 5sK....e...|
-000001d0  44 d4 5b 3d 54 aa ac 53  a9 cc 31 99 86 22 5a f9  |D.[=T..S..1.."Z.|
-000001e0  9e bd f1 f3 74 07 e4 fe  f7 3a 35 44 e5 c6 48 3f  |....t....:5D..H?|
-000001f0  a3 81 1e 67 96 51 0f e6  7d 43 67 9c 12 6c dd 91  |...g.Q..}Cg..l..|
-00000200  c4 f9 20 4d 88 41 fc 40  c5 ee c2 11 fb f1 67 da  |.. M.A.@......g.|
-00000210  7b b6 d0 1b f8 6e f7 8b  07 f2 9e 12 56 dc 75 31  |{....n......V.u1|
-00000220  cd b9 53 62 3f 2f 72 cf  ee 17 03 03 00 a4 f9 ec  |..Sb?/r.........|
-00000230  72 94 94 1c 52 ab 9e 6d  04 5a 26 07 15 3a f5 dd  |r...R..m.Z&..:..|
-00000240  f3 45 18 20 de 2e 97 f7  6a a4 7c 92 68 aa 71 55  |.E. ....j.|.h.qU|
-00000250  b7 7a 3c 8f 54 e7 cc 31  e1 54 9c ad 8e b4 57 11  |.z<.T..1.T....W.|
-00000260  1d 79 85 4a da 3f 1b ab  fb f4 d4 d9 4d 8a 2e da  |.y.J.?......M...|
-00000270  68 3e f9 aa 16 52 cc 4e  49 7a 00 bf fc e8 b5 16  |h>...R.NIz......|
-00000280  43 0c 6d aa 82 49 3c 16  43 56 55 35 ee 47 c3 1c  |C.m..I<.CVU5.G..|
-00000290  99 25 6d 30 89 64 5e 23  bf de fc cc 7c 40 94 28  |.%m0.d^#....|@.(|
-000002a0  d8 ed ec c2 e2 8b 24 64  64 b6 e8 6c 29 82 b5 ba  |......$dd..l)...|
-000002b0  d5 59 7a 6f 11 6e cc 30  91 c8 c0 8b 9f dd 13 59  |.Yzo.n.0.......Y|
-000002c0  a9 72 18 f6 6e ce 3a 47  6b 4f 26 55 61 bf 20 7a  |.r..n.:GkO&Ua. z|
-000002d0  d8 c3 17 03 03 00 35 d7  fc bc 10 29 75 c3 70 0a  |......5....)u.p.|
-000002e0  02 e4 cf 36 20 49 5d 64  78 e9 27 db 2d e3 1a 66  |...6 I]dx.'.-..f|
-000002f0  f3 a8 82 7e 64 f0 29 27  81 6c bd b7 a7 86 a2 6a  |...~d.)'.l.....j|
-00000300  ac 4e 7b da 48 7c d8 9c  39 6c 95 45 17 03 03 00  |.N{.H|..9l.E....|
-00000310  17 c9 13 54 e9 22 62 7e  89 17 de 98 52 93 26 76  |...T."b~....R.&v|
-00000320  73 a0 7d 2c 60 68 c8 68  17 03 03 00 13 ad 3a 53  |s.},`h.h......:S|
-00000330  d1 41 0e 99 26 c8 fb 22  8f e6 d3 a4 1d 83 ff 28  |.A..&..".......(|
+00000000  14 03 03 00 01 01 17 03  03 02 1e ab 60 cd 30 a1  |............`.0.|
+00000010  d1 e0 a1 d4 77 15 50 bf  aa c7 bf 1a c0 e1 cd dd  |....w.P.........|
+00000020  6a 64 0b 5e f0 83 24 77  1d 7a ff 97 5b ab 5b 15  |jd.^..$w.z..[.[.|
+00000030  eb 9e af 09 c9 38 e1 8a  7d c1 c9 04 40 b9 ca 6e  |.....8..}...@..n|
+00000040  01 8d cb 1e 66 52 a4 c2  20 44 68 bf d0 0d ec c0  |....fR.. Dh.....|
+00000050  0b d2 9e ae 60 e4 5e 19  cf 92 96 22 88 b1 35 e3  |....`.^...."..5.|
+00000060  c9 89 c8 67 6d 14 83 e1  ad 76 ca e6 9a d0 34 e0  |...gm....v....4.|
+00000070  de 9d 46 44 85 97 b0 cc  4e ef 72 d9 85 47 13 fb  |..FD....N.r..G..|
+00000080  86 9f 3c 26 20 fa fd 15  f7 83 1f c2 1f 51 3f 4a  |..<& ........Q?J|
+00000090  b4 3c 3b 09 2b 16 22 d1  30 f2 16 ae b9 28 f7 8e  |.<;.+.".0....(..|
+000000a0  a2 84 15 c8 42 58 a5 6d  8a 86 a9 7f 23 18 ed ee  |....BX.m....#...|
+000000b0  18 d7 2d 47 4f b8 f2 44  60 cb 2f 1d 1a ad 7b e7  |..-GO..D`./...{.|
+000000c0  15 d3 d8 55 9e fb 0b 0e  b8 e3 1f 4e a4 8c 14 ec  |...U.......N....|
+000000d0  4b 3a c4 d1 66 16 9d 7a  72 20 8a fb 41 33 bc 04  |K:..f..zr ..A3..|
+000000e0  4e b7 e4 65 2e 21 d2 3b  5f 07 00 cd 38 b3 9d 78  |N..e.!.;_...8..x|
+000000f0  eb 36 00 db d1 e0 8a 3f  50 84 3f d9 4b 2d 85 41  |.6.....?P.?.K-.A|
+00000100  bc cc ec 9b 15 2c f9 95  02 18 41 08 13 f3 d5 ec  |.....,....A.....|
+00000110  e7 32 8c ca 7e 0a e6 81  ed db 8a 49 46 ac a9 42  |.2..~......IF..B|
+00000120  27 13 85 f1 16 9b 15 bd  ec eb 1c 25 24 9a 7f 0e  |'..........%$...|
+00000130  a4 67 e1 32 3f cf 8b 61  49 9b 43 a4 57 79 48 14  |.g.2?..aI.C.WyH.|
+00000140  90 00 b1 2d 6f 82 9f ef  f3 a0 c6 e8 9f fd d4 08  |...-o...........|
+00000150  1f 16 5e 7f be 73 7e a6  5b d2 02 12 c9 76 c3 f3  |..^..s~.[....v..|
+00000160  13 4c 44 7f e9 8e 5b ce  d8 56 d6 2f 76 ff 5a 8e  |.LD...[..V./v.Z.|
+00000170  6d cb 5b 8e c6 62 29 4e  c6 34 a9 74 44 84 b7 28  |m.[..b)N.4.tD..(|
+00000180  96 cd fa 6d 2e ac 75 3e  86 73 c3 a9 50 ef e9 e4  |...m..u>.s..P...|
+00000190  70 a5 ba bc 1f 9c c3 05  17 30 2c 1b ba c0 15 bf  |p........0,.....|
+000001a0  f4 47 45 b1 42 d9 6c 6d  57 b0 7a 94 61 ee 78 0e  |.GE.B.lmW.z.a.x.|
+000001b0  32 4f 01 da df d8 29 51  91 1c 3f f6 40 a7 15 76  |2O....)Q..?.@..v|
+000001c0  99 d7 e0 45 af 04 5a 69  f0 65 bf 40 e9 5c 4b e5  |...E..Zi.e.@.\K.|
+000001d0  eb e6 2e 79 f7 c8 4a e4  0b 71 e3 d5 dd 7e 25 d4  |...y..J..q...~%.|
+000001e0  d9 7f 1b 9b 8b 3f b6 9c  35 59 2e 40 34 e3 c8 2a  |.....?..5Y.@4..*|
+000001f0  3c 74 0b d6 35 d3 12 e8  93 7e 44 61 b4 3d da 19  |<t..5....~Da.=..|
+00000200  60 34 e0 19 97 9f 75 a9  be ff 0e ca 14 32 7e 20  |`4....u......2~ |
+00000210  48 fa e3 43 1b 94 86 6c  e4 c2 7d 91 1c 21 42 88  |H..C...l..}..!B.|
+00000220  16 0b 26 f6 16 dc 09 d4  8e 17 03 03 00 a4 b9 22  |..&............"|
+00000230  dc d6 d7 9f a8 83 b2 a6  bd 8a 5a da 0a 75 d6 10  |..........Z..u..|
+00000240  e5 0e ff a5 ec f2 31 8a  4e ff e6 21 3a a0 65 32  |......1.N..!:.e2|
+00000250  73 e5 e2 c3 f8 24 a4 b2  34 b9 d4 e2 04 ea ff e5  |s....$..4.......|
+00000260  2e dc 75 03 9f e6 55 6b  95 06 1b f9 fb 32 ea b2  |..u...Uk.....2..|
+00000270  d6 f9 05 9c df 1f 18 cb  27 ca 40 d8 03 e5 70 fc  |........'.@...p.|
+00000280  78 9b 84 a5 28 6a 14 2e  f3 1a f1 92 8d d8 93 54  |x...(j.........T|
+00000290  68 c7 12 37 84 e5 b5 73  23 90 6f 4c d3 35 bb ba  |h..7...s#.oL.5..|
+000002a0  bd 7d 11 8e 93 25 85 f8  46 56 39 d0 23 b9 06 68  |.}...%..FV9.#..h|
+000002b0  25 86 09 28 3c 24 25 2b  fd 27 17 83 eb 5c 53 42  |%..(<$%+.'...\SB|
+000002c0  a2 0d f8 a5 5e c9 4f 53  83 e3 90 d8 0c 49 03 cf  |....^.OS.....I..|
+000002d0  b1 03 17 03 03 00 35 dc  ac dc ee c6 92 3d 1b 5d  |......5......=.]|
+000002e0  e9 c2 5c e0 0d 1b 28 9b  cb 79 7f 58 8a 02 cd 85  |..\...(..y.X....|
+000002f0  34 c0 a3 72 71 b5 26 c5  56 c5 38 09 ee 0e 9a e4  |4..rq.&.V.8.....|
+00000300  f4 29 ad 76 e2 61 27 61  ea e0 a7 1d 17 03 03 00  |.).v.a'a........|
+00000310  17 7b 6b 82 47 b6 bb 41  d0 5b b4 23 38 bf 15 58  |.{k.G..A.[.#8..X|
+00000320  27 1e fa 7a 58 09 02 e8  17 03 03 00 13 cf d5 c3  |'..zX...........|
+00000330  22 18 f9 28 3e c9 64 d0  51 8d dc 4b a2 f1 bf 9f  |"..(>.d.Q..K....|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-Ed25519 b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-Ed25519
index b524ef43d2..c174bd9f6d 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-Ed25519
+++ b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-Ed25519
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,117 +7,119 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 28 10 3b 44 b1  |....z...v..(.;D.|
-00000010  0f a9 77 89 f9 dd 3c 3a  ad 83 a0 ca 3e 60 d6 0e  |..w...<:....>`..|
-00000020  ab 94 3a ec 2e 63 ef b1  41 90 48 20 00 00 00 00  |..:..c..A.H ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 94 b3 83 34 fd  |....z...v.....4.|
+00000010  0f d0 16 30 14 0e 57 a1  d3 29 cd 81 c7 a2 59 c9  |...0..W..)....Y.|
+00000020  fb 8f 54 d4 9b 69 a8 47  7d c3 63 20 00 00 00 00  |..T..i.G}.c ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 d9  |..+.....3.$... .|
-00000060  ce 37 c6 7e 9c 0f 75 bb  b6 91 c9 af 59 eb 24 07  |.7.~..u.....Y.$.|
-00000070  2e 80 3a 7e d2 fc 39 9e  45 19 94 2d ae 33 2c 14  |..:~..9.E..-.3,.|
-00000080  03 03 00 01 01 17 03 03  00 17 c6 b7 f1 35 ee 93  |.............5..|
-00000090  75 ca 2e 3a a2 3d ed 32  5c e1 2c e0 5b 1c 01 e0  |u..:.=.2\.,.[...|
-000000a0  bb 17 03 03 00 42 02 e5  db dc 80 e1 c2 6f 31 1c  |.....B.......o1.|
-000000b0  33 7b 76 8f 51 9c f8 a8  b0 1b 1a 8a 46 00 c7 ff  |3{v.Q.......F...|
-000000c0  ff 4c c9 d8 28 14 32 74  ee 59 b3 15 4b 45 90 b6  |.L..(.2t.Y..KE..|
-000000d0  da 56 b3 ef d4 6f 8a eb  96 b9 94 ab b9 9e b1 2e  |.V...o..........|
-000000e0  fe 29 f2 0d 0d 93 66 1a  17 03 03 02 6d 84 4e 43  |.)....f.....m.NC|
-000000f0  92 85 d5 e0 7a cd da a6  c0 5a bf 8b eb 83 db a0  |....z....Z......|
-00000100  dc c3 e2 a8 d5 ca ad 87  75 19 08 dd 3e 2e 36 a0  |........u...>.6.|
-00000110  a1 53 28 09 cd 1c 1d a0  24 77 e3 e6 4d b1 8f 36  |.S(.....$w..M..6|
-00000120  43 29 79 b3 e2 fb 9e dc  39 90 b5 b7 db 6d 0a c0  |C)y.....9....m..|
-00000130  55 d2 1c fd 8d 57 5b bf  e3 70 b7 6a bc af 4f 34  |U....W[..p.j..O4|
-00000140  e7 e1 46 d3 9a cc e4 73  33 fb e6 ad f9 b5 35 af  |..F....s3.....5.|
-00000150  97 77 88 11 19 7c e6 7d  8b 08 bb 78 2c 50 29 0c  |.w...|.}...x,P).|
-00000160  87 5f ef 04 19 34 9f 59  54 df 14 71 d1 5f e7 dc  |._...4.YT..q._..|
-00000170  46 2e 73 1a 07 12 be 6e  74 e1 8e 82 ca db a2 6d  |F.s....nt......m|
-00000180  35 5b fc 4c 71 42 45 86  35 1c c0 dc 0d 4c 40 a8  |5[.LqBE.5....L@.|
-00000190  c7 ea 4a b8 33 0b 30 e2  6d a4 82 dc 28 35 1f f2  |..J.3.0.m...(5..|
-000001a0  ac 23 41 10 a4 d4 1a 40  28 4d ea db 32 d5 06 de  |.#A....@(M..2...|
-000001b0  1e 37 91 77 34 ed b4 c8  f2 1c 44 de ee 2f dd af  |.7.w4.....D../..|
-000001c0  61 cc 1e 59 87 a6 be 36  b0 8e a3 61 01 aa f4 60  |a..Y...6...a...`|
-000001d0  1e c8 3a 3c 53 57 31 28  3e 40 32 95 67 02 41 9c  |..:<SW1(>@2.g.A.|
-000001e0  58 28 50 51 5e 06 1d f1  57 e1 39 ba e0 ab 30 26  |X(PQ^...W.9...0&|
-000001f0  25 fe b6 0a a9 d5 b3 72  61 3a 71 ec a2 44 91 5e  |%......ra:q..D.^|
-00000200  30 1b d4 dd 07 cf 35 6a  85 4a 95 b2 a9 f5 5c 6e  |0.....5j.J....\n|
-00000210  35 f9 07 7b d9 b0 a5 64  2f c3 34 23 84 3f 1a 97  |5..{...d/.4#.?..|
-00000220  dd 25 75 7c 76 0f 9b 73  5b aa c0 a1 00 4b f6 b1  |.%u|v..s[....K..|
-00000230  61 34 51 d0 d1 3b 00 4f  87 93 f5 45 2e 23 93 ee  |a4Q..;.O...E.#..|
-00000240  e6 ce e5 1c 02 22 3c c1  22 ed 33 b2 71 99 52 26  |....."<.".3.q.R&|
-00000250  70 86 ad bc 41 d9 13 54  d3 3e 5d 4b 63 4d d2 6f  |p...A..T.>]KcM.o|
-00000260  bf a5 24 f8 7b 83 b2 0b  13 02 0d 42 74 9b 04 4e  |..$.{......Bt..N|
-00000270  8a 86 6b 40 92 42 3a d8  a8 21 2f ce e0 90 71 65  |..k@.B:..!/...qe|
-00000280  5f ed c7 65 38 e3 85 e2  32 d5 4b c0 84 61 24 a1  |_..e8...2.K..a$.|
-00000290  00 be 67 f3 59 b0 b2 f0  65 fe a6 49 19 41 f9 9b  |..g.Y...e..I.A..|
-000002a0  40 3a 62 ec 4d 1f 83 77  03 9d 4b 4c d2 5d 93 ca  |@:b.M..w..KL.]..|
-000002b0  01 39 44 dc c6 f7 18 6b  2a c9 1b 3d ef 27 6d a4  |.9D....k*..=.'m.|
-000002c0  2e 8f 33 63 2b c5 fb bb  52 23 68 7e 0b 16 92 64  |..3c+...R#h~...d|
-000002d0  d9 72 04 2d 0d b2 ba 67  45 ae 14 16 f1 57 3b 59  |.r.-...gE....W;Y|
-000002e0  44 ba db b0 c9 d2 9b 8f  6d b2 a4 8c c2 d1 1c e4  |D.......m.......|
-000002f0  ce d3 32 bf 04 d9 09 d1  28 3d 25 2d b5 d3 da 12  |..2.....(=%-....|
-00000300  77 01 45 09 08 e0 df cc  f3 4c c0 e0 b7 d7 d8 16  |w.E......L......|
-00000310  82 19 1d 57 dc b4 27 83  48 1b 9f a9 0e cc d6 39  |...W..'.H......9|
-00000320  c1 4a 66 b3 42 85 a5 a7  14 97 5c 58 fe 41 e1 2e  |.Jf.B.....\X.A..|
-00000330  16 e9 70 89 e7 98 a8 f3  4a 81 d4 d8 ff 5f 48 6e  |..p.....J...._Hn|
-00000340  60 c6 4a 07 c5 57 9c 22  25 3a 9f bf 7e 71 f3 0d  |`.J..W."%:..~q..|
-00000350  71 e5 a5 d4 2b 6d 70 2f  c5 a3 17 03 03 00 99 b9  |q...+mp/........|
-00000360  15 c7 70 bc 06 75 26 50  0f 22 90 43 99 25 0d 0f  |..p..u&P.".C.%..|
-00000370  05 d3 ce e7 3c 53 fb 01  d4 d2 e8 fb b7 49 87 03  |....<S.......I..|
-00000380  ac ad 15 11 46 dc 0c d1  89 01 5f 64 85 b9 6e bf  |....F....._d..n.|
-00000390  30 22 d6 2c 6d ac b0 f7  83 f6 2e 3a 4c 8c 72 37  |0".,m......:L.r7|
-000003a0  99 0f b5 80 b3 61 85 97  69 26 cc 95 a1 1f e5 9f  |.....a..i&......|
-000003b0  59 8a 30 0a f7 18 f4 c4  c5 15 11 d6 8b 8d 2a e0  |Y.0...........*.|
-000003c0  71 c3 86 dc d2 7f c4 95  98 c7 6c b7 21 78 d0 e6  |q.........l.!x..|
-000003d0  a7 3e 4b 12 11 df b7 d9  1e 23 d9 db 0f 5f 43 f0  |.>K......#..._C.|
-000003e0  75 65 ac ba 46 43 61 b4  3d be b8 49 44 ad 15 00  |ue..FCa.=..ID...|
-000003f0  3b c0 07 ba 18 b2 14 71  17 03 03 00 35 d1 22 81  |;......q....5.".|
-00000400  7f 21 e9 e2 7b 11 f5 df  dd 3f 15 ce b5 fc 71 f3  |.!..{....?....q.|
-00000410  0e f2 d0 1c a4 85 29 88  f2 ca 73 01 ee 1c e4 66  |......)...s....f|
-00000420  07 fa 5c a3 32 b0 e4 2a  e4 97 e5 70 b1 cd db 79  |..\.2..*...p...y|
-00000430  83 1f                                             |..|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 38  |..+.....3.$... 8|
+00000060  5e 40 05 c2 91 46 5b e0  c6 c4 8f b6 eb 91 98 b1  |^@...F[.........|
+00000070  b0 41 8e 34 14 8f 2a b1  5e e6 80 78 f6 0c 3e 14  |.A.4..*.^..x..>.|
+00000080  03 03 00 01 01 17 03 03  00 17 30 61 18 ba 71 15  |..........0a..q.|
+00000090  e0 75 5d 55 f2 1a d1 7e  69 fa 58 41 97 cd c1 9a  |.u]U...~i.XA....|
+000000a0  92 17 03 03 00 42 af 88  92 3e 98 ef 74 a5 06 90  |.....B...>..t...|
+000000b0  fd c0 21 20 01 ec 1d 68  93 8d dc 36 dc 2c 43 77  |..! ...h...6.,Cw|
+000000c0  02 18 47 cf 66 b3 61 88  85 be f1 04 1b da c1 03  |..G.f.a.........|
+000000d0  31 68 2c 1c fc dc ed 6b  f3 a5 e8 52 fd a7 dc c8  |1h,....k...R....|
+000000e0  e1 6a 91 67 83 ce 5c 08  17 03 03 02 6d 55 55 72  |.j.g..\.....mUUr|
+000000f0  6e cc c5 4c f0 10 d7 0d  57 5d 4d f4 61 8d 5d 78  |n..L....W]M.a.]x|
+00000100  c3 cd df 49 4a 1a 4b c6  fe 70 0a 4a 1c 1d 12 25  |...IJ.K..p.J...%|
+00000110  36 1a 68 70 7d 02 e9 cc  4b 92 f9 b8 86 d0 e8 68  |6.hp}...K......h|
+00000120  56 be 25 b3 67 3d c0 92  5a 9f 57 8e 22 63 97 78  |V.%.g=..Z.W."c.x|
+00000130  1a 7e 70 76 87 f7 3a ef  45 1f 38 d3 95 12 72 98  |.~pv..:.E.8...r.|
+00000140  d0 89 e5 bd a7 eb fe b6  89 59 27 07 51 fd 2c 71  |.........Y'.Q.,q|
+00000150  8a 99 ca b2 75 bc ae b9  39 c6 15 bf 4e a7 3d 73  |....u...9...N.=s|
+00000160  f4 2c 7d 4c 88 3b b1 b6  3a 3d 49 c7 d0 91 57 6a  |.,}L.;..:=I...Wj|
+00000170  cc 25 c7 07 dc 08 0c ac  f4 9a 1d 58 17 3b 44 84  |.%.........X.;D.|
+00000180  e4 72 eb d5 11 16 09 f5  1b fb 60 23 63 46 51 10  |.r........`#cFQ.|
+00000190  4e 94 7b 5a 31 81 db 9e  bb 82 28 4a 08 32 88 fa  |N.{Z1.....(J.2..|
+000001a0  d2 e3 c4 6e 28 7d 47 66  a1 66 05 39 9e 20 52 fe  |...n(}Gf.f.9. R.|
+000001b0  3d 4d 2e b4 b8 a6 97 dd  12 8d db 9b 74 71 96 be  |=M..........tq..|
+000001c0  38 07 62 fc 81 97 3f 85  a2 b8 eb 29 0f e6 95 ca  |8.b...?....)....|
+000001d0  7b a1 f3 94 7e a4 3c 14  71 55 eb c6 c2 15 09 35  |{...~.<.qU.....5|
+000001e0  18 22 5b 9a 2c 19 f1 d3  60 f0 ff c2 09 9f 81 93  |."[.,...`.......|
+000001f0  e0 37 6e d0 73 40 c2 66  60 b7 54 85 b4 15 83 fe  |.7n.s@.f`.T.....|
+00000200  d4 de f4 a2 1f 7d 88 7d  6d 7d 30 ab 4a 25 3a a1  |.....}.}m}0.J%:.|
+00000210  2c fa 27 f4 94 35 0d 01  b0 9d fb 58 5b 03 86 9f  |,.'..5.....X[...|
+00000220  24 d8 57 dc e2 2e bf 1a  28 78 62 f5 29 e0 20 06  |$.W.....(xb.). .|
+00000230  38 47 98 b7 44 ce d3 66  92 32 4b 68 3d 45 b9 22  |8G..D..f.2Kh=E."|
+00000240  b9 94 32 1b 93 3f c1 88  a5 91 0f 06 8a 1e e6 a1  |..2..?..........|
+00000250  62 7e 1e 50 7a 2a be 18  cc 62 93 51 e0 c1 87 21  |b~.Pz*...b.Q...!|
+00000260  b3 c3 6b 1a ce f9 95 9e  6f 98 2a 25 43 10 6e 10  |..k.....o.*%C.n.|
+00000270  97 5c 09 33 e9 06 b6 6a  a8 8b fe 11 d7 b3 38 d6  |.\.3...j......8.|
+00000280  67 3f f9 50 37 f5 d2 f0  0d d8 6f 0a 8d 58 ee bc  |g?.P7.....o..X..|
+00000290  18 c2 68 17 c7 d9 05 c4  d1 e6 a9 f3 c4 63 f5 d4  |..h..........c..|
+000002a0  f2 fb 16 05 f3 fb 45 56  c7 ec 2b af fe 26 4c c0  |......EV..+..&L.|
+000002b0  85 86 de c3 f5 81 32 b2  bd a9 6c fd 33 25 8e ad  |......2...l.3%..|
+000002c0  6a 44 3e f0 67 be c8 dc  e1 40 9e 40 88 4d e7 c8  |jD>.g....@.@.M..|
+000002d0  0b 55 18 e6 2b 10 50 84  ff 93 63 f6 93 4a d2 39  |.U..+.P...c..J.9|
+000002e0  62 45 ed 31 1d b5 5a 14  53 6f 0f d1 45 e6 6f 66  |bE.1..Z.So..E.of|
+000002f0  a3 cd ff 28 b4 34 4c 54  67 8c 1b b6 a0 b4 01 6c  |...(.4LTg......l|
+00000300  41 24 ab 5c a0 22 82 8c  fa cd 1e 4d e1 8b 7a 04  |A$.\.".....M..z.|
+00000310  00 62 e3 44 19 59 c8 e2  04 45 ac e6 46 e2 6a df  |.b.D.Y...E..F.j.|
+00000320  ce e1 d2 3b 3f 22 b9 17  f2 eb 75 ea 96 cc af f6  |...;?"....u.....|
+00000330  6b 77 29 e5 5c 96 13 19  b5 e6 0a 5d 31 9d 6e 28  |kw).\......]1.n(|
+00000340  3e ec 58 cc 76 b2 93 1e  d0 e4 c3 b7 44 fd 0e 19  |>.X.v.......D...|
+00000350  91 e5 21 91 06 56 19 80  cf 25 17 03 03 00 99 22  |..!..V...%....."|
+00000360  b0 98 6e 68 69 5c 4d 7e  81 2c dc 0f 68 3e 6c 8a  |..nhi\M~.,..h>l.|
+00000370  02 4a 56 1b f2 b4 a2 04  31 64 b4 07 2c 37 47 a3  |.JV.....1d..,7G.|
+00000380  4c b6 5a 64 94 a8 c2 b6  d8 d2 6f 2e b6 4e ce 46  |L.Zd......o..N.F|
+00000390  72 ce 87 73 c4 ce 32 8e  0e e3 6a d2 62 19 56 33  |r..s..2...j.b.V3|
+000003a0  95 94 e2 8f 1b 20 db 2a  cc c7 61 f8 bc 47 18 11  |..... .*..a..G..|
+000003b0  4e d5 d1 66 7a 33 27 e7  38 2b 4b de 01 4c df f7  |N..fz3'.8+K..L..|
+000003c0  a9 c3 e9 50 0e e2 8b 94  16 30 fa 82 51 98 b4 2b  |...P.....0..Q..+|
+000003d0  b6 e6 83 a3 49 13 a5 95  1d 37 38 86 51 08 68 0a  |....I....78.Q.h.|
+000003e0  73 5e 91 e8 24 57 41 f2  15 5f 28 ca a7 f8 9a db  |s^..$WA.._(.....|
+000003f0  e9 fc ba 22 dc e7 25 5f  17 03 03 00 35 b3 81 2b  |..."..%_....5..+|
+00000400  ca e3 9c 5c db 80 ae 0b  41 f7 8c 26 af 9f 68 0a  |...\....A..&..h.|
+00000410  33 24 6a ea 22 b6 fc 57  37 0d 4e ab 48 29 03 d6  |3$j."..W7.N.H)..|
+00000420  d4 25 5f 14 b8 74 2b 80  84 9c 99 3c 18 6c 95 0d  |.%_..t+....<.l..|
+00000430  7d e0                                             |}.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 01 50 dd d8 5d 40 64  |..........P..]@d|
-00000010  5d 35 b0 82 0d 46 97 4c  a2 d1 4d dd 3c c9 0a f9  |]5...F.L..M.<...|
-00000020  39 6a 1c 17 c3 f6 1a 6b  42 cc f7 37 23 7a e1 bf  |9j.....kB..7#z..|
-00000030  de 51 7f 87 6b 3d d6 4d  ed 24 b3 de dd 62 18 4a  |.Q..k=.M.$...b.J|
-00000040  b5 b3 1e 0f 2f a3 c5 e8  67 65 04 bc 37 97 15 a8  |..../...ge..7...|
-00000050  a8 f3 a8 79 99 82 e1 10  5d d7 f2 ee 21 46 aa b8  |...y....]...!F..|
-00000060  40 9f 3b fc 12 19 c8 82  b4 8e bc b8 9b a9 f6 aa  |@.;.............|
-00000070  18 6b 48 4e 03 92 43 12  b8 54 f2 b7 29 0b 0a a1  |.kHN..C..T..)...|
-00000080  6f c4 1c 2a af 22 c1 3d  1b 43 a5 3c 7d 39 83 5d  |o..*.".=.C.<}9.]|
-00000090  ee 09 fb f1 9a 4c ff b3  2a bb 85 53 04 18 5e 18  |.....L..*..S..^.|
-000000a0  62 e8 cf ec 01 be 76 31  82 1a 60 19 33 c7 37 0a  |b.....v1..`.3.7.|
-000000b0  fa 45 4d b1 9a 1e 07 e9  9c 45 c3 89 60 a2 c9 59  |.EM......E..`..Y|
-000000c0  8c 7d 02 f6 d6 5c 12 26  bd 6d 97 15 e2 07 27 be  |.}...\.&.m....'.|
-000000d0  2f 59 93 1b 11 0e 05 ef  83 c6 a2 c0 1a 9a 4c 60  |/Y............L`|
-000000e0  a6 84 c0 72 b6 2b 7c a1  37 4c d7 eb 76 0f 00 97  |...r.+|.7L..v...|
-000000f0  43 b6 25 ed 36 e1 eb 3a  3d 71 05 d8 d0 f9 80 18  |C.%.6..:=q......|
-00000100  b2 9b c0 4e 2c 8e 05 41  52 a5 40 57 3c 1f 48 0c  |...N,..AR.@W<.H.|
-00000110  55 ea d3 76 6d 3a 26 5d  5d 71 74 1c d5 8d 96 92  |U..vm:&]]qt.....|
-00000120  79 c5 9c 78 68 5f 20 12  01 06 c3 52 49 66 e4 5b  |y..xh_ ....RIf.[|
-00000130  41 09 fa 72 c5 d7 d9 26  1b fa a5 1d 23 b2 4a 1e  |A..r...&....#.J.|
-00000140  da 83 5e 89 c8 3a c4 26  f2 42 70 6d 1b 90 67 eb  |..^..:.&.Bpm..g.|
-00000150  37 15 35 b9 a2 b0 2b ef  93 5f 11 17 03 03 00 59  |7.5...+.._.....Y|
-00000160  b4 a0 79 ba e4 3f 78 d2  11 1a 71 8a a1 a4 28 fc  |..y..?x...q...(.|
-00000170  44 c7 bc 32 19 06 71 1b  6d 50 20 26 d5 91 39 48  |D..2..q.mP &..9H|
-00000180  59 8b fd 55 0a 35 14 f5  31 47 62 15 ee c1 69 23  |Y..U.5..1Gb...i#|
-00000190  eb db 79 ef 20 47 5c ef  31 e1 ae bd 2f 72 f8 9d  |..y. G\.1.../r..|
-000001a0  92 cc 04 6f 73 22 5d 93  59 9f 06 cb bd 70 9b d8  |...os"].Y....p..|
-000001b0  c9 41 44 8f 5b b2 59 2b  a9 17 03 03 00 35 22 65  |.AD.[.Y+.....5"e|
-000001c0  ef 1e dc 4c 63 ba 6d 6a  46 1c d2 9c 9a 81 4b f3  |...Lc.mjF.....K.|
-000001d0  1f 58 4e 08 86 93 f8 3a  53 13 64 1f ca 20 d2 da  |.XN....:S.d.. ..|
-000001e0  6b df 54 88 a8 f3 af 0d  4a 1b 29 91 3a bb 90 27  |k.T.....J.).:..'|
-000001f0  29 3a 97 17 03 03 00 17  09 78 1d f3 95 2e 92 af  |):.......x......|
-00000200  d8 af 64 59 fb 77 e3 85  de f0 37 be 11 91 2f 17  |..dY.w....7.../.|
-00000210  03 03 00 13 4e a2 06 c3  90 6f d3 b0 04 a8 25 32  |....N....o....%2|
-00000220  09 65 1c f2 ef 9c 32                              |.e....2|
+00000000  14 03 03 00 01 01 17 03  03 01 50 85 7f 0a 8b bc  |..........P.....|
+00000010  d1 2a 9f 69 55 c4 37 16  81 a5 46 23 cd af 5a 89  |.*.iU.7...F#..Z.|
+00000020  ad a6 c0 c3 5b 7a dc e5  29 c7 47 13 01 e9 64 4b  |....[z..).G...dK|
+00000030  86 83 50 72 0a bc 45 72  d1 66 47 04 ad 69 01 a7  |..Pr..Er.fG..i..|
+00000040  8c 49 4e 38 00 d7 d1 68  48 bd ff 2f a3 72 de 29  |.IN8...hH../.r.)|
+00000050  86 56 52 7b f1 2f c4 d3  93 3a c9 bc b8 e7 c2 c0  |.VR{./...:......|
+00000060  07 d8 46 81 a2 bd 36 54  79 28 91 1a 85 ab a3 64  |..F...6Ty(.....d|
+00000070  6b 33 e4 15 4c 07 c9 f0  45 49 e5 4c 9e b9 48 12  |k3..L...EI.L..H.|
+00000080  3b 31 12 51 72 89 7b 0f  79 07 6b 35 11 42 af a8  |;1.Qr.{.y.k5.B..|
+00000090  21 40 bd 9b e9 0f 98 80  70 6e e0 b1 99 58 9e 42  |!@......pn...X.B|
+000000a0  ca 0c 6f 87 2f 9b 91 10  7d fc c4 4e 57 1d 2f 79  |..o./...}..NW./y|
+000000b0  18 ba 6f 6f 61 f2 e4 c0  5e 4f fd 6c 58 06 83 6e  |..ooa...^O.lX..n|
+000000c0  52 b1 88 69 74 e1 12 3a  81 d6 32 b3 ac 06 4e 79  |R..it..:..2...Ny|
+000000d0  7a 50 1c 70 1e 63 6f 46  fa 17 b8 e2 1b b9 31 e2  |zP.p.coF......1.|
+000000e0  b0 f6 2f f3 ca 39 95 57  e2 51 82 d1 bf f0 f0 a2  |../..9.W.Q......|
+000000f0  3c 1b 28 cc e2 88 83 1d  db f7 56 b3 dd 39 d5 cb  |<.(.......V..9..|
+00000100  80 28 dc d4 2e e7 c6 a1  3a be 1f 8d 9f 53 5e 31  |.(......:....S^1|
+00000110  24 f1 25 36 2f f9 b1 f1  56 91 74 c8 44 6e bc c1  |$.%6/...V.t.Dn..|
+00000120  a3 cf 35 03 aa cf 87 66  9f 30 e7 eb f6 ff fd b9  |..5....f.0......|
+00000130  de 41 d4 b9 ef ce 99 d6  f3 e2 a6 ae 05 39 83 56  |.A...........9.V|
+00000140  5b 18 b6 52 8d a0 24 5e  34 4a 12 a6 8a 66 e3 c5  |[..R..$^4J...f..|
+00000150  70 92 3c f9 95 0c 59 58  65 b0 dc 17 03 03 00 59  |p.<...YXe......Y|
+00000160  56 82 fd bc ab b7 55 ee  45 23 0a cc 55 f7 fb d3  |V.....U.E#..U...|
+00000170  9f 75 0c 1f a1 f9 bc 3b  4f d5 4a 6b 47 14 6f 34  |.u.....;O.JkG.o4|
+00000180  61 85 c4 e5 3f fb 6d 0e  49 c8 f5 66 81 6b 3a b5  |a...?.m.I..f.k:.|
+00000190  14 f2 74 52 bf 8e d7 40  63 a0 45 ce 0b 69 e5 d6  |..tR...@c.E..i..|
+000001a0  43 6e 01 8b fd 54 6f ab  ce 03 57 c5 3f 6a 00 c1  |Cn...To...W.?j..|
+000001b0  bb 79 01 ee 90 7d 50 e7  de 17 03 03 00 35 cc 30  |.y...}P......5.0|
+000001c0  81 af c1 0c 4a e7 c9 d4  d2 fc 8f 0f a4 54 1c 41  |....J........T.A|
+000001d0  86 c9 a9 81 64 ce 4c 56  1a 94 fc 4b f7 e8 9d 50  |....d.LV...K...P|
+000001e0  33 4b b2 92 99 ee 79 43  ce 1f ea e2 14 5e 24 f1  |3K....yC.....^$.|
+000001f0  72 be c8 17 03 03 00 17  45 29 9b e2 ea a1 d3 16  |r.......E)......|
+00000200  8e 0c ce 85 30 a6 cd 37  b7 5a 42 0f dd 55 4d 17  |....0..7.ZB..UM.|
+00000210  03 03 00 13 ef e7 22 eb  4a e8 2a b4 88 da 2e 08  |......".J.*.....|
+00000220  01 95 77 ad 88 2e 53                              |..w...S|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-ECDSA
index 0cd5b76d66..e159d3e537 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-ECDSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,129 +7,131 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 40 ad 79 0c ad  |....z...v..@.y..|
-00000010  83 38 58 82 dc b2 5a d1  e2 de f5 43 99 72 8a 93  |.8X...Z....C.r..|
-00000020  ba b1 ea 17 21 52 a7 e9  ed dc 48 20 00 00 00 00  |....!R....H ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 12 8c 45 11 2d  |....z...v....E.-|
+00000010  22 19 db e3 07 f4 31 70  a6 9d f5 b2 6a df 8f b5  |".....1p....j...|
+00000020  57 6e a1 80 75 6b 6b 77  53 cd b4 20 00 00 00 00  |Wn..ukkwS.. ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 bd  |..+.....3.$... .|
-00000060  d2 3a 7e c2 30 84 4f f2  39 7e 26 11 65 49 b9 b2  |.:~.0.O.9~&.eI..|
-00000070  ac 63 c8 ef ea 5e f6 23  33 70 ec 16 86 49 03 14  |.c...^.#3p...I..|
-00000080  03 03 00 01 01 17 03 03  00 17 16 47 c1 58 83 6b  |...........G.X.k|
-00000090  66 06 c4 39 42 8f 68 fb  3a 07 9e e7 74 41 0d 10  |f..9B.h.:...tA..|
-000000a0  97 17 03 03 00 42 42 b2  84 94 a6 18 c6 b6 21 77  |.....BB.......!w|
-000000b0  1e 02 57 4a 14 2d c4 84  17 f1 fa b4 63 0f aa d7  |..WJ.-......c...|
-000000c0  4a d5 ae 75 f1 da 14 ec  51 09 93 6b 62 6f 8f 7e  |J..u....Q..kbo.~|
-000000d0  fe 0c 7f 63 ef 1b 87 d8  43 42 d0 f4 2d 6d 0f cc  |...c....CB..-m..|
-000000e0  ef 77 79 17 1e 39 1e 75  17 03 03 02 22 9c 82 27  |.wy..9.u...."..'|
-000000f0  99 e0 4b 44 a7 a7 bb a9  25 a2 58 7f 70 3f 82 1a  |..KD....%.X.p?..|
-00000100  4b bc e1 35 3e 66 fa 4f  ac 7f 7e da 73 13 06 0f  |K..5>f.O..~.s...|
-00000110  fe 97 ef 82 53 2e d0 e2  11 c6 ee 8d 25 d2 f0 5c  |....S.......%..\|
-00000120  2e b8 61 40 09 12 d4 11  9b b8 3d 38 d7 d5 a7 76  |..a@......=8...v|
-00000130  ed a7 bf 6f 39 9c 83 49  57 86 de 53 da c5 ff 8a  |...o9..IW..S....|
-00000140  ee 47 bc 19 72 d3 cc d0  5b fc 6b 25 2f 64 2a 0c  |.G..r...[.k%/d*.|
-00000150  7d e9 8a 1f f8 48 d1 74  d5 70 97 e7 b4 e2 c8 ce  |}....H.t.p......|
-00000160  dc 74 27 e9 af b1 64 56  19 28 8a 34 93 4e 1c 03  |.t'...dV.(.4.N..|
-00000170  67 ae 41 fb 5f d1 e3 20  45 6b bd 49 25 d8 b4 8b  |g.A._.. Ek.I%...|
-00000180  d4 96 d6 96 b2 72 72 f0  d0 68 f1 f7 f3 17 76 85  |.....rr..h....v.|
-00000190  78 0e dd 35 83 8a 7a 45  c5 91 86 4b a6 b5 77 b4  |x..5..zE...K..w.|
-000001a0  ef 02 43 5c 42 c7 f8 a6  1d ed 73 d2 41 02 be cb  |..C\B.....s.A...|
-000001b0  24 40 61 5a 5f 7a f6 bf  f9 d0 bd 05 7f 90 52 16  |$@aZ_z........R.|
-000001c0  65 49 c6 74 61 f0 05 fa  dd 83 69 b7 ff 5a 2c 4b  |eI.ta.....i..Z,K|
-000001d0  63 6d d2 57 01 43 67 54  25 90 72 f8 12 7e c2 39  |cm.W.CgT%.r..~.9|
-000001e0  26 a9 65 55 02 ca 87 8a  e6 13 cd a4 6b eb 3c 4d  |&.eU........k.<M|
-000001f0  3b 6e b5 4e 4e c2 64 c8  c4 70 0f 86 bb de ba 7e  |;n.NN.d..p.....~|
-00000200  9f 15 b7 11 fd f4 43 0e  f8 ad 53 b8 98 81 1c 81  |......C...S.....|
-00000210  63 1b 64 49 52 8b d8 24  49 04 1f d1 0c 7c d8 2d  |c.dIR..$I....|.-|
-00000220  89 7b 74 83 a6 eb 6a e5  5d d4 16 e8 67 20 52 a4  |.{t...j.]...g R.|
-00000230  78 3c 59 7a d2 de a0 51  c7 52 59 1e 9f 41 16 68  |x<Yz...Q.RY..A.h|
-00000240  57 68 d1 39 17 9a b3 a2  19 fb bb 49 bd 29 3e 23  |Wh.9.......I.)>#|
-00000250  59 38 6c 9f be 1b ba 60  93 e8 c9 24 fb 13 11 b7  |Y8l....`...$....|
-00000260  78 d8 a7 30 6d 06 0f 4d  59 5d d1 1f 81 13 33 99  |x..0m..MY]....3.|
-00000270  a8 4d 63 16 53 73 40 22  4b 55 21 79 c1 ce 1c 92  |.Mc.Ss@"KU!y....|
-00000280  8c d6 95 14 fd 93 5d c2  54 20 30 c5 79 b0 cd eb  |......].T 0.y...|
-00000290  ac 1b 50 6a 25 b7 e8 f1  0f da f3 d8 6b 17 2b 12  |..Pj%.......k.+.|
-000002a0  06 a8 9a 88 be 2f f3 52  b3 d7 70 05 df 57 88 f9  |...../.R..p..W..|
-000002b0  ec 59 d4 e7 ce cb c3 1f  33 3e c0 d8 04 9f 59 a0  |.Y......3>....Y.|
-000002c0  04 c0 13 b3 a6 7c ce 6c  c4 fa 82 cd da 11 17 b6  |.....|.l........|
-000002d0  c2 40 cd e6 5a 6e d3 b5  17 f0 4d c4 34 8f 2a 28  |.@..Zn....M.4.*(|
-000002e0  4d ce 93 d5 eb 7e 0a d2  57 0a 98 cf ac 48 ee a8  |M....~..W....H..|
-000002f0  8a bd ec c2 d7 d9 39 af  e2 a0 9f b2 fd d1 4e 96  |......9.......N.|
-00000300  fa fd 34 f7 a4 3e 3d 31  9a f6 a2 a7 97 a3 43 17  |..4..>=1......C.|
-00000310  03 03 00 a4 cf 0d e1 8d  b7 e4 1a c0 79 0d 7e d9  |............y.~.|
-00000320  70 a3 34 57 0f 72 b4 5c  05 7f 1e 16 52 ba d3 e7  |p.4W.r.\....R...|
-00000330  fb e5 b8 b0 8d cf 91 7e  96 c4 70 6e cb e5 7e 51  |.......~..pn..~Q|
-00000340  19 17 c1 94 e9 49 69 a0  21 59 74 a9 1d 34 9c 10  |.....Ii.!Yt..4..|
-00000350  a9 10 f0 4a 51 2c e3 1d  e3 59 28 f2 3b ea 66 c1  |...JQ,...Y(.;.f.|
-00000360  ed 6a 8d 39 72 ea 5a 24  7a ee 9f cd 85 9d 54 60  |.j.9r.Z$z.....T`|
-00000370  d4 95 fd 8d 63 a4 78 6c  2f 7d 6a a5 53 e4 42 97  |....c.xl/}j.S.B.|
-00000380  e8 19 36 bf 14 9c a8 48  9f 57 ad 29 7a 30 e5 a9  |..6....H.W.)z0..|
-00000390  32 e7 0f 24 9c ca 9d 6d  b7 47 46 1c cb 90 7d 18  |2..$...m.GF...}.|
-000003a0  39 70 d2 c1 08 28 dc d7  3a 3e 5e 62 a7 4a 4a af  |9p...(..:>^b.JJ.|
-000003b0  02 93 ce 4b 5d a2 96 f3  17 03 03 00 35 10 07 d6  |...K].......5...|
-000003c0  82 f3 28 ef 2f 08 17 f6  0b c2 da 1f b7 52 e1 eb  |..(./........R..|
-000003d0  ca f4 0b c6 21 5c 54 4d  f9 0b 04 c1 5a bf 63 58  |....!\TM....Z.cX|
-000003e0  1c e1 da 7f f7 1f 84 77  09 3a 35 7c e6 1f 89 f2  |.......w.:5|....|
-000003f0  fd 01                                             |..|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 d9  |..+.....3.$... .|
+00000060  7a 4f 73 11 d0 32 a9 32  96 d4 d6 5d 93 25 4a 83  |zOs..2.2...].%J.|
+00000070  26 6d 4d 30 02 8e ed 8e  65 0a 13 27 f3 53 5b 14  |&mM0....e..'.S[.|
+00000080  03 03 00 01 01 17 03 03  00 17 85 46 a7 e1 6f a9  |...........F..o.|
+00000090  d5 ea 00 e8 d2 7c 10 b9  e2 b1 98 9c eb a3 54 02  |.....|........T.|
+000000a0  61 17 03 03 00 42 ca 37  9a 89 50 e8 5d b2 6d 21  |a....B.7..P.].m!|
+000000b0  56 68 10 a1 47 76 16 87  f3 50 f0 5f d1 50 3a 03  |Vh..Gv...P._.P:.|
+000000c0  1e c7 27 84 d6 82 94 35  92 34 d7 54 f4 9b 30 8d  |..'....5.4.T..0.|
+000000d0  e9 9b 5a 04 88 4c 27 b3  3a 32 37 9e c2 a5 8a 19  |..Z..L'.:27.....|
+000000e0  d3 71 30 7b ba 9f d3 7f  17 03 03 02 22 4e e7 88  |.q0{........"N..|
+000000f0  d6 55 13 2b c9 db 93 db  9f 6b ca 4e a7 91 a1 30  |.U.+.....k.N...0|
+00000100  04 c7 e7 fc 5d f8 28 0d  b0 cd 73 b2 4b 59 e5 89  |....].(...s.KY..|
+00000110  68 f8 bb 47 1f 73 a2 d7  fe 75 73 8d a4 02 e7 22  |h..G.s...us...."|
+00000120  80 c0 aa d1 4c de f8 89  1a d2 12 86 35 7f cf 40  |....L.......5..@|
+00000130  e1 4f 47 f2 69 51 7c a7  7c 23 32 ed a6 53 8a 4a  |.OG.iQ|.|#2..S.J|
+00000140  47 86 e7 0c c5 5f 34 9f  91 eb d2 c1 bd 65 1e 7c  |G...._4......e.||
+00000150  6e ec 18 70 21 d9 95 dc  fe 44 cf d7 3f 58 fa e1  |n..p!....D..?X..|
+00000160  43 df 2e 44 7f a0 5f 48  e3 02 2c fd 18 f2 23 25  |C..D.._H..,...#%|
+00000170  a5 fc d1 23 2c 81 16 c3  8e 58 47 51 bf 0e c3 57  |...#,....XGQ...W|
+00000180  54 bf d1 8e f6 82 91 ce  5f 24 2d fd e5 80 52 c6  |T......._$-...R.|
+00000190  db b9 a1 3a 0d 80 25 98  17 ed cc 81 36 9f 85 31  |...:..%.....6..1|
+000001a0  11 25 65 36 50 ed 8e c7  6f b5 28 22 4c f3 93 94  |.%e6P...o.("L...|
+000001b0  61 0d c1 10 19 37 b2 3b  ec 41 3c 95 bc ae b5 8d  |a....7.;.A<.....|
+000001c0  95 87 39 bd 41 a7 cf 3e  b2 83 7c 12 fd 37 e4 6b  |..9.A..>..|..7.k|
+000001d0  0d c7 f9 7f f5 02 74 e0  37 c2 45 68 ab 84 f5 65  |......t.7.Eh...e|
+000001e0  78 4f 64 c5 d2 de 15 2b  1b d9 06 7a d5 f8 34 13  |xOd....+...z..4.|
+000001f0  19 54 2e 7a 85 04 d0 90  51 78 2a e2 4b ca 11 b9  |.T.z....Qx*.K...|
+00000200  7d 38 bd 5f be 5d d5 da  36 41 49 95 39 8e 1e df  |}8._.]..6AI.9...|
+00000210  a9 3b cc 18 8f 26 bd 37  97 f1 49 42 d4 e9 48 91  |.;...&.7..IB..H.|
+00000220  21 dc 70 9b 21 7a 24 13  8d 8e 7a d6 5f 11 2a ab  |!.p.!z$...z._.*.|
+00000230  73 9a cf cb af bf 3e 19  46 81 48 0a 17 b1 f1 24  |s.....>.F.H....$|
+00000240  a5 aa 60 91 fa d0 9b e4  95 28 7a a2 bf 2b ac 18  |..`......(z..+..|
+00000250  5f 1d 98 b8 e8 1a b4 58  fe 66 25 d2 0a 8d ad 7f  |_......X.f%.....|
+00000260  d2 46 95 8d d8 42 de 94  12 88 a6 30 80 14 ce 7c  |.F...B.....0...||
+00000270  ef 20 31 cd a3 e7 6b 29  b7 74 aa 62 c4 4c d5 52  |. 1...k).t.b.L.R|
+00000280  15 8e 7b da 51 60 24 ca  8d 65 9b 9b d8 2a df 1c  |..{.Q`$..e...*..|
+00000290  28 63 28 e7 20 07 f2 b4  99 d8 d6 2a d2 d3 ae 28  |(c(. ......*...(|
+000002a0  5e c5 12 25 fa b5 1c 31  1c 6d eb 1f d9 92 2b cf  |^..%...1.m....+.|
+000002b0  de fa d9 7c 39 69 0b a3  a3 05 aa 11 7d 41 3f d7  |...|9i......}A?.|
+000002c0  17 48 41 a7 3c 4b 42 93  46 26 da de 47 fe f8 76  |.HA.<KB.F&..G..v|
+000002d0  4a fb cc 08 78 19 98 d4  ad a7 4e c4 c6 47 2d 8f  |J...x.....N..G-.|
+000002e0  3f 59 57 09 89 8e 95 eb  a3 37 94 e2 6a a9 62 ee  |?YW......7..j.b.|
+000002f0  cd 8a b8 88 36 e1 ca 2a  ad 78 b8 2c 74 bc e0 11  |....6..*.x.,t...|
+00000300  6c 87 a3 06 51 b2 84 94  a2 d2 7b 57 94 79 5c 17  |l...Q.....{W.y\.|
+00000310  03 03 00 a4 07 a2 96 5b  70 21 8a a7 2e 2c 80 7a  |.......[p!...,.z|
+00000320  7a 70 09 bf 12 2e 80 1d  60 be 20 65 ff 02 74 ee  |zp......`. e..t.|
+00000330  33 27 10 b1 bf b8 aa 2b  f8 8e 2e b1 41 17 4d d5  |3'.....+....A.M.|
+00000340  bd 53 37 3c d0 85 2f 04  3c 92 e4 c0 0c 99 bd 34  |.S7<../.<......4|
+00000350  38 65 36 68 ae 12 1b 25  e7 a4 0e 2a 46 fc 29 1d  |8e6h...%...*F.).|
+00000360  5e 2d 32 42 00 59 33 da  43 53 d0 d0 61 03 7d 6b  |^-2B.Y3.CS..a.}k|
+00000370  ee 3a a5 bc 42 15 4d 04  5c 56 d4 b0 2d 2c 0e 5e  |.:..B.M.\V..-,.^|
+00000380  cd 2e 7b 83 22 a8 c4 bb  6d 6e 8b 5b 6d 7f cd 5d  |..{."...mn.[m..]|
+00000390  78 19 52 ff 72 a5 bf 5c  80 ba 0a 94 db c1 f8 24  |x.R.r..\.......$|
+000003a0  27 fe d7 0d 20 07 3a 8e  34 f9 32 ed 9a ae e3 de  |'... .:.4.2.....|
+000003b0  dc a7 2b c2 9e 8e 36 89  17 03 03 00 35 d8 4d df  |..+...6.....5.M.|
+000003c0  c5 6f 77 cc d2 2c 30 9b  db bb 4c 12 25 8e 2a 3a  |.ow..,0...L.%.*:|
+000003d0  ab e1 51 14 e5 16 22 8a  83 78 b1 98 7b 71 c9 a7  |..Q..."..x..{q..|
+000003e0  08 fd 5d 20 95 0b bf cb  64 08 df dd ca df f5 d7  |..] ....d.......|
+000003f0  f9 c2                                             |..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 02 11 f1 43 fc 28 7d  |............C.(}|
-00000010  43 0b 17 e4 ed cc 95 d5  09 4e 8f 44 3c 3b 46 23  |C........N.D<;F#|
-00000020  59 a4 62 a7 94 1e da b6  a7 a5 22 15 6a ed e3 eb  |Y.b.......".j...|
-00000030  4f 6d 0e 91 c6 20 74 af  97 80 95 db 6a b6 2d ac  |Om... t.....j.-.|
-00000040  a8 d9 95 84 95 5b 32 27  ec 42 42 a8 fd 05 fc ad  |.....[2'.BB.....|
-00000050  2e 00 e3 4a 9d 93 d1 5e  fd dc 22 30 1f 9c e9 cb  |...J...^.."0....|
-00000060  3f 2e ac ad 0f ab b7 46  82 69 38 db c6 8a be 77  |?......F.i8....w|
-00000070  7e 83 77 4c e1 f4 f2 cf  c2 b1 86 ff 17 d3 1d 79  |~.wL...........y|
-00000080  3e ac f8 6e 73 15 ab 02  4c bf 2a 63 41 ce 93 3b  |>..ns...L.*cA..;|
-00000090  af 11 70 8c 91 91 f4 14  5c 1b 63 4b 42 3b d8 ca  |..p.....\.cKB;..|
-000000a0  00 f6 02 b3 c8 d3 ab 01  1d f2 71 86 7b f9 13 de  |..........q.{...|
-000000b0  1e 39 1c e7 b5 3b b5 bb  26 33 f7 a9 3f 29 e2 8c  |.9...;..&3..?)..|
-000000c0  d1 67 64 11 b4 29 be 6e  c9 cf c5 6e 41 43 41 e7  |.gd..).n...nACA.|
-000000d0  43 9c 5d fb a1 b6 b3 f9  0f 4c 17 11 3c 56 0e 49  |C.]......L..<V.I|
-000000e0  a0 41 8f ca 62 38 d2 83  8d 41 9b 86 5e 47 9b 79  |.A..b8...A..^G.y|
-000000f0  c6 66 61 4d 72 05 7a 4b  e9 43 96 9b b3 09 f1 60  |.faMr.zK.C.....`|
-00000100  65 98 db 4a fb 57 dc 6b  de 48 e4 78 7c 86 0f 58  |e..J.W.k.H.x|..X|
-00000110  93 ea ec fa 7b c0 c2 c4  57 f8 99 13 c0 97 d6 df  |....{...W.......|
-00000120  01 a8 a2 3e da 7a 1a 55  ae ab f6 d1 d8 34 83 0d  |...>.z.U.....4..|
-00000130  11 86 8a 14 8e d6 5c c0  c2 55 de da 37 c4 ac 69  |......\..U..7..i|
-00000140  95 42 84 5f 1d 5f c7 32  91 a9 45 02 c3 a3 da 4f  |.B._._.2..E....O|
-00000150  96 da c0 a2 09 7a a6 2b  25 f4 a2 94 89 fa bd 0f  |.....z.+%.......|
-00000160  87 04 e1 87 00 c4 4f 45  39 7a 5a 7d 75 c5 c9 f6  |......OE9zZ}u...|
-00000170  27 34 2d ba 12 c5 2c 76  06 b0 aa d0 34 e1 99 e9  |'4-...,v....4...|
-00000180  9b 01 db 2a b4 d5 dd 55  2b 92 6d e3 9e fc f1 09  |...*...U+.m.....|
-00000190  2b 37 8b 37 8f 70 31 ee  d2 f0 86 5a 1f d3 4a 29  |+7.7.p1....Z..J)|
-000001a0  7c c9 0e 97 7c 4f e6 87  b7 c8 94 f3 d2 0b 4a 1d  ||...|O........J.|
-000001b0  59 60 09 81 55 6a 01 38  9f ca 20 e0 6e 44 f7 b5  |Y`..Uj.8.. .nD..|
-000001c0  f6 3e 2e d0 81 f6 e6 1d  15 cf c3 d8 ae 98 84 d1  |.>..............|
-000001d0  0b c9 e4 65 96 f9 eb c9  60 6d 50 37 49 9f 6d b1  |...e....`mP7I.m.|
-000001e0  b9 f6 25 20 81 2d cf b4  17 2b 4c a9 8a 76 8a db  |..% .-...+L..v..|
-000001f0  77 8c 29 47 05 0b 27 e1  52 8d 37 27 fb c0 70 26  |w.)G..'.R.7'..p&|
-00000200  3b 6d 2e 74 05 75 88 e4  63 3d ac 98 3f 74 67 3b  |;m.t.u..c=..?tg;|
-00000210  c6 dc 41 39 2b 20 ef f9  8b 2f 4e 20 17 03 03 00  |..A9+ .../N ....|
-00000220  99 7d 8a 83 dd 34 5e 37  e2 c3 85 22 f3 6b ee bc  |.}...4^7...".k..|
-00000230  a5 21 1b c5 2c 38 cf 99  09 5b 31 97 5e a0 8b 69  |.!..,8...[1.^..i|
-00000240  75 3a 23 64 18 22 fb 31  ed ac 8b 0f ae 9c 4e ee  |u:#d.".1......N.|
-00000250  06 0e 3c 3a 18 d3 8e 0c  dc d4 3f 7b 25 e3 90 85  |..<:......?{%...|
-00000260  ca f4 8a 5c 5e 5e 44 f3  1b 57 cd 14 e0 8d 67 36  |...\^^D..W....g6|
-00000270  6e c2 a6 95 60 f3 86 20  29 a6 a8 8f b3 b0 0d 57  |n...`.. )......W|
-00000280  d2 1e 4a b9 d2 63 33 09  f9 c5 87 94 89 c5 fd 2e  |..J..c3.........|
-00000290  de b3 f0 0e 7b 4e 3e d6  21 b4 3b 58 bd 2a 35 49  |....{N>.!.;X.*5I|
-000002a0  5e b0 f4 5a ca 58 dc a5  8b 45 a5 d1 7b 13 b2 00  |^..Z.X...E..{...|
-000002b0  52 c4 b2 6c d1 9a b8 c5  1b fe 17 03 03 00 35 c9  |R..l..........5.|
-000002c0  9b c7 94 b3 eb 5f 4e ab  8c c0 de cf b6 b4 5c ee  |....._N.......\.|
-000002d0  bb 5f fa 48 a2 06 f0 ed  f5 b1 ba 74 0c c5 64 1a  |._.H.......t..d.|
-000002e0  ce 2e 9e 90 4b 6e 98 13  a0 98 99 a3 b4 6f 73 76  |....Kn.......osv|
-000002f0  7b e3 26 15 17 03 03 00  17 3e a1 f0 68 e6 00 86  |{.&......>..h...|
-00000300  10 f4 bf 26 b6 f5 e6 77  85 ca b7 c1 75 bb f9 78  |...&...w....u..x|
-00000310  17 03 03 00 13 43 7f f3  84 ee d7 a9 59 9d c3 5c  |.....C......Y..\|
-00000320  c0 b7 c8 20 4e 83 ba 23                           |... N..#|
+00000000  14 03 03 00 01 01 17 03  03 02 11 67 1a 6d 9c e6  |...........g.m..|
+00000010  fd 73 aa 96 0b 7a 9b 1a  28 fd e8 5c 7b a2 65 91  |.s...z..(..\{.e.|
+00000020  e8 6a 96 48 6e 56 da 2d  8f 79 d3 d9 bb db f1 26  |.j.HnV.-.y.....&|
+00000030  27 99 e5 d2 2e b2 20 ee  af e5 b5 8b 6d a3 ea a3  |'..... .....m...|
+00000040  2a 6a a5 5e 28 61 04 10  d3 01 62 bd 16 f3 2b 84  |*j.^(a....b...+.|
+00000050  1b ca 26 67 62 4b b6 24  df 20 9a 06 57 ed 21 37  |..&gbK.$. ..W.!7|
+00000060  a1 0c e4 e1 cd c8 39 e6  5c bc 78 46 8c fb ad f1  |......9.\.xF....|
+00000070  55 15 bc d5 f5 21 2b b1  b6 03 5c 14 0f cf 8d 79  |U....!+...\....y|
+00000080  ad 64 b6 fd de 92 a9 51  f5 29 f3 d3 14 22 9a d5  |.d.....Q.)..."..|
+00000090  70 37 87 19 dd c3 d3 7b  79 ce 80 c3 f8 02 ea dc  |p7.....{y.......|
+000000a0  86 f8 af d2 fe 0d 49 a5  ba 6d ec 42 cf 28 21 ed  |......I..m.B.(!.|
+000000b0  5f 23 90 3b 83 d8 c4 73  fd 18 57 7f b1 81 9f 88  |_#.;...s..W.....|
+000000c0  19 3c bc 4b 24 4c 22 2f  07 f3 07 29 e8 6c 30 8e  |.<.K$L"/...).l0.|
+000000d0  12 b5 bc 2f 2f c0 80 fb  a1 f0 73 0c 22 ea 4f 24  |...//.....s.".O$|
+000000e0  3b 37 a5 68 65 12 42 0b  6b 7f eb ff 59 eb 92 de  |;7.he.B.k...Y...|
+000000f0  96 d9 f7 23 95 b1 b5 93  61 8b a5 bd c2 bf b0 86  |...#....a.......|
+00000100  af 54 91 21 38 b1 7e 4c  05 82 71 70 30 a0 19 ac  |.T.!8.~L..qp0...|
+00000110  10 63 fa 6a 05 95 14 18  27 cc f3 2e 2d 78 93 35  |.c.j....'...-x.5|
+00000120  65 c9 4e ec 3a 10 9e 75  60 21 18 71 f9 b5 95 37  |e.N.:..u`!.q...7|
+00000130  af 29 a1 51 a9 e5 a9 b5  5b a5 81 72 65 6c eb f2  |.).Q....[..rel..|
+00000140  2e 78 85 04 b8 c0 3c e6  3a 49 0e 28 fa 0a f8 73  |.x....<.:I.(...s|
+00000150  16 da ba 60 db ed ad de  7d 5b 10 15 03 5b 79 d0  |...`....}[...[y.|
+00000160  d7 da 91 ff 12 76 37 94  43 ad f4 f8 b9 39 23 e6  |.....v7.C....9#.|
+00000170  7c ed 92 d9 92 c4 2b bd  8c 7a fd ab 0d 17 0b b5  ||.....+..z......|
+00000180  5b 8a 5f a6 9b 19 04 88  37 75 54 a9 35 15 ff df  |[._.....7uT.5...|
+00000190  42 8b aa fb 9f 30 28 ef  bb 74 95 a5 af 44 c2 70  |B....0(..t...D.p|
+000001a0  55 c7 cc f5 37 b9 34 c6  dd fb 9b c5 70 fa 0f ed  |U...7.4.....p...|
+000001b0  45 54 38 02 34 0a 09 df  4c bd 07 78 ce 66 c7 0d  |ET8.4...L..x.f..|
+000001c0  57 94 06 97 6d b3 ec 90  70 81 37 23 77 b7 2f cb  |W...m...p.7#w./.|
+000001d0  c5 af 12 bd a7 c5 81 87  92 9e 9b ed 78 6d bf 63  |............xm.c|
+000001e0  01 aa d7 f3 50 f2 f7 c6  af a9 7f 73 d8 fb 17 27  |....P......s...'|
+000001f0  c3 33 8d 2b 2c ad 10 4d  36 5c 49 e8 19 06 34 45  |.3.+,..M6\I...4E|
+00000200  00 eb 1f c1 09 c8 19 06  55 91 52 df cd db f2 d5  |........U.R.....|
+00000210  22 2a af 92 cb 18 9f 96  2a 12 d5 ea 17 03 03 00  |"*......*.......|
+00000220  99 01 94 eb cc e4 e7 4f  90 c1 9b 85 c8 1f 73 f0  |.......O......s.|
+00000230  50 52 7d 62 50 f9 90 49  59 e8 31 a0 ea 3b 42 2c  |PR}bP..IY.1..;B,|
+00000240  2c dd e8 9c 42 d5 5f 50  84 b9 78 0a 5e 73 55 d9  |,...B._P..x.^sU.|
+00000250  21 39 e5 bc c7 88 04 1d  b8 d3 46 b3 a0 b6 07 60  |!9........F....`|
+00000260  4a 39 1a 39 cc e3 22 2f  de 30 16 71 54 1d c0 69  |J9.9.."/.0.qT..i|
+00000270  ea 73 81 bf 17 7d 82 dc  33 cd 1f c2 e8 eb 67 61  |.s...}..3.....ga|
+00000280  60 1e dd 2c 56 45 d4 49  fb 7f 21 dd a8 23 8c 13  |`..,VE.I..!..#..|
+00000290  d3 1b c5 c1 3b 08 e4 21  ac 35 eb d6 44 a6 48 c9  |....;..!.5..D.H.|
+000002a0  e2 ae 04 a8 36 fb e8 f6  2e 91 90 da 5a ae 18 3b  |....6.......Z..;|
+000002b0  a7 14 94 ed b7 f4 8a cc  74 be 17 03 03 00 35 a2  |........t.....5.|
+000002c0  9f 3f bd d0 7c 1e ac 4e  c9 7e 9d ee 9a 89 61 55  |.?..|..N.~....aU|
+000002d0  38 41 8c d9 e1 56 35 bd  0b 6e ad 77 0e 0d 08 df  |8A...V5..n.w....|
+000002e0  73 67 36 28 e0 9b 96 ba  c0 38 de 95 31 53 49 9c  |sg6(.....8..1SI.|
+000002f0  db 16 c2 90 17 03 03 00  17 6f cc cb 4e ac ef a0  |.........o..N...|
+00000300  48 75 94 28 c5 8d 06 33  28 94 11 84 25 9f 26 a6  |Hu.(...3(...%.&.|
+00000310  17 03 03 00 13 d2 ce 1b  90 04 b1 32 38 db 0d b5  |...........28...|
+00000320  3c e8 e3 34 bc c3 d1 33                           |<..4...3|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-RSAPSS b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-RSAPSS
index e557181b29..a306d4bb53 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-RSAPSS
+++ b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-RSAPSS
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,138 +7,140 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 46 b8 dc eb 72  |....z...v..F...r|
-00000010  ac 41 0a 3c 58 14 84 a0  75 91 e1 ca d7 3c c7 2c  |.A.<X...u....<.,|
-00000020  62 20 c4 28 9e 5a 09 19  2e 51 7b 20 00 00 00 00  |b .(.Z...Q{ ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 59 1d 08 4c 9a  |....z...v..Y..L.|
+00000010  08 52 d3 3b 7b 4c 3e d3  23 53 e3 17 09 07 52 8b  |.R.;{L>.#S....R.|
+00000020  e5 c9 55 c3 c1 0d db 83  aa ba 4e 20 00 00 00 00  |..U.......N ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 f9  |..+.....3.$... .|
-00000060  c2 64 c8 93 91 3a 81 55  ca 85 23 d4 91 37 3e 01  |.d...:.U..#..7>.|
-00000070  42 63 2e 2a a9 13 0c a9  f2 e6 74 14 1e 5c 52 14  |Bc.*......t..\R.|
-00000080  03 03 00 01 01 17 03 03  00 17 23 71 3e 39 7a 0c  |..........#q>9z.|
-00000090  2a fa 89 f1 65 d1 b0 23  96 8e 6a e4 55 2c fd 34  |*...e..#..j.U,.4|
-000000a0  ea 17 03 03 00 20 b7 a2  d6 ff b3 b4 db ce f8 90  |..... ..........|
-000000b0  f9 a3 9c 0c 8f f0 77 3e  37 f2 d9 e7 84 65 28 f6  |......w>7....e(.|
-000000c0  dd fe b9 42 03 3c 17 03  03 02 7a d4 cf 93 f6 2b  |...B.<....z....+|
-000000d0  64 e3 13 75 41 62 7d bd  cf 4f 42 80 23 f4 03 92  |d..uAb}..OB.#...|
-000000e0  35 02 5e ed bb c6 2f b1  a8 57 cf d4 69 94 6a db  |5.^.../..W..i.j.|
-000000f0  39 b8 3a 05 07 dd f1 1d  63 13 22 9b d7 58 68 6f  |9.:.....c."..Xho|
-00000100  4f ac 79 6a 47 0a 23 35  3c 9b 9f 15 04 e7 6b d8  |O.yjG.#5<.....k.|
-00000110  ff df 00 6c 68 5e a0 41  6a a9 34 9f 37 98 c2 3d  |...lh^.Aj.4.7..=|
-00000120  51 29 73 c4 ad 34 e5 69  78 18 eb 03 55 c0 c6 0d  |Q)s..4.ix...U...|
-00000130  43 d5 4a 5d cb 53 e6 b9  df e8 8b 0e 98 04 89 bb  |C.J].S..........|
-00000140  f4 a1 48 01 af d3 42 ef  17 e7 f9 27 b4 b1 63 99  |..H...B....'..c.|
-00000150  91 a6 c5 c1 cb 6d 1c 55  b1 69 1c ec b1 b7 c3 cd  |.....m.U.i......|
-00000160  7a 93 f2 d8 e4 c4 96 43  0a e1 18 b5 9a 3b 57 83  |z......C.....;W.|
-00000170  98 ce 74 f2 4c 65 ad 01  aa 76 b5 b0 7c a0 7d 09  |..t.Le...v..|.}.|
-00000180  ad d6 20 7d 12 67 f8 4c  2c 41 37 34 66 86 fe 3d  |.. }.g.L,A74f..=|
-00000190  44 52 f0 08 26 4c b3 e7  71 b3 89 b3 5c 78 7e db  |DR..&L..q...\x~.|
-000001a0  34 31 dc dc 7c 7d 28 e1  41 96 f4 2f 28 60 9f 5b  |41..|}(.A../(`.[|
-000001b0  b2 2b 37 6b 3f 3a 37 e2  38 7a 66 40 fe 44 44 72  |.+7k?:7.8zf@.DDr|
-000001c0  b4 e3 97 f3 db 73 c8 af  96 c8 a6 24 ef ea 34 8f  |.....s.....$..4.|
-000001d0  5e 4b 21 22 19 d8 4a db  2e f1 23 90 d0 d2 38 f3  |^K!"..J...#...8.|
-000001e0  c6 08 5d 1d c9 a3 f2 6d  01 eb 30 5e cd f4 98 f5  |..]....m..0^....|
-000001f0  0d d8 68 4f 00 f4 cd 24  9f c4 3c 6a 31 5d c0 e5  |..hO...$..<j1]..|
-00000200  21 35 9b 4f db f0 0e 9c  5a e5 be 3f 63 ed 39 b3  |!5.O....Z..?c.9.|
-00000210  ea 1a fe cb 4b 6b ae 57  9f 5d 63 40 2d 61 76 83  |....Kk.W.]c@-av.|
-00000220  7a ca c0 9c 82 55 74 16  9d e2 84 31 71 28 fd ae  |z....Ut....1q(..|
-00000230  a1 5c 66 aa b4 7e e4 bf  54 fc 95 e7 e0 e5 e7 54  |.\f..~..T......T|
-00000240  54 a9 cf 14 d1 ef 18 a6  70 b8 c6 58 2c ba 7c 74  |T.......p..X,.|t|
-00000250  e4 72 14 aa 2e e1 6d ba  dc 06 9f fd 82 cd 3f 20  |.r....m.......? |
-00000260  3b 46 bf a9 1d 54 ae 3a  40 4a 76 8c 91 de 1c 42  |;F...T.:@Jv....B|
-00000270  94 a8 62 2c 53 c0 08 a6  32 f1 5f 13 28 a4 83 d1  |..b,S...2._.(...|
-00000280  de 7e d4 2b 2e b8 f7 c8  1c e6 58 0d 66 8e 5f 88  |.~.+......X.f._.|
-00000290  47 ca 4f 98 58 36 de fa  be 59 7e 64 8a d0 3a 6c  |G.O.X6...Y~d..:l|
-000002a0  e5 9d 90 7b 3a 88 16 bc  16 10 81 8b 9d 1b 09 0a  |...{:...........|
-000002b0  0b e8 d1 1e 06 41 de 41  87 e6 52 d9 03 d9 86 d3  |.....A.A..R.....|
-000002c0  27 89 55 f3 b5 4a 6f 74  42 d8 6b 8e a1 91 da 6d  |'.U..JotB.k....m|
-000002d0  1a 23 61 5e 8b f0 50 7e  e2 17 ed 0c fc b1 a7 0b  |.#a^..P~........|
-000002e0  37 1e 91 de 6e 57 02 dd  f9 2c 70 c9 0e 24 27 e3  |7...nW...,p..$'.|
-000002f0  6e 9c ef 41 bd 7f 19 62  95 6c f6 c1 73 e5 08 2c  |n..A...b.l..s..,|
-00000300  b1 80 ec aa 64 c7 ab 77  f3 86 43 8a 61 fa b9 ba  |....d..w..C.a...|
-00000310  c0 0c ce de d9 f9 0f ea  2d 0b 77 9e bb 29 0a 7f  |........-.w..)..|
-00000320  9b 90 1c 54 5e c4 95 7c  fd 0e b9 9f 8d ff d7 7c  |...T^..|.......||
-00000330  e4 2b 4c d9 d5 b3 79 83  d3 75 cc a4 47 01 74 0b  |.+L...y..u..G.t.|
-00000340  35 84 be 59 bd 17 03 03  00 99 72 3e 53 38 42 12  |5..Y......r>S8B.|
-00000350  6f 99 20 c4 98 59 48 61  e0 13 80 8e 96 25 96 f8  |o. ..YHa.....%..|
-00000360  c9 c8 35 9c 35 c0 13 d7  34 24 0b 6e 59 4f 1b 77  |..5.5...4$.nYO.w|
-00000370  1f 9a 71 6b 6b dc 71 23  b1 a2 e8 1e c2 a0 b1 8c  |..qkk.q#........|
-00000380  27 5e 90 c5 f8 65 30 a2  de fc 6b b2 e3 5d 8d 9f  |'^...e0...k..]..|
-00000390  70 32 3c 92 47 c7 91 10  49 0d f1 3b 41 f1 14 3b  |p2<.G...I..;A..;|
-000003a0  09 55 f5 78 0e 91 1b 75  a0 58 fc c9 34 82 fe 51  |.U.x...u.X..4..Q|
-000003b0  20 73 71 3d 7f 82 a4 29  bc 04 67 d7 30 c7 a5 4b  | sq=...)..g.0..K|
-000003c0  f3 94 4d 15 35 2a 1e 46  82 3f 36 f4 7b ff 9f 88  |..M.5*.F.?6.{...|
-000003d0  3b e6 60 bc 86 51 59 ad  97 58 95 7e 6a 4b c9 6c  |;.`..QY..X.~jK.l|
-000003e0  34 96 03 17 03 03 00 35  03 94 eb e1 e5 9d eb 8f  |4......5........|
-000003f0  34 b1 28 3c 9d 26 40 a9  e7 4c 2b bf 37 32 b6 aa  |4.(<.&@..L+.72..|
-00000400  78 d2 45 0c 6c 5b 0a 0e  8a 3a b6 1a 01 09 3e 0a  |x.E.l[...:....>.|
-00000410  45 25 c6 83 8a 4a cc 22  d9 29 c8 8a 32           |E%...J.".)..2|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 d8  |..+.....3.$... .|
+00000060  b2 05 15 9a 39 db 4f d6  d1 d1 e5 6c f0 8d 6f b1  |....9.O....l..o.|
+00000070  54 d6 ff f2 48 2b a7 14  2a f6 4e cd 28 41 61 14  |T...H+..*.N.(Aa.|
+00000080  03 03 00 01 01 17 03 03  00 17 c9 09 91 34 14 6c  |.............4.l|
+00000090  de cb 9f d5 0d 03 5e 58  69 4e 61 75 8a 4b a9 35  |......^XiNau.K.5|
+000000a0  51 17 03 03 00 20 4f 41  5c 1d f6 73 a0 ca a7 a9  |Q.... OA\..s....|
+000000b0  4c b9 34 ee 7c c0 68 eb  e6 28 9f 1f 7f bf 6e 17  |L.4.|.h..(....n.|
+000000c0  17 cf 6c cb ad 72 17 03  03 02 7a 1f d1 c8 b3 7a  |..l..r....z....z|
+000000d0  7b 7b c9 fa c0 5a cb e9  18 64 b9 ef 49 8f 2d da  |{{...Z...d..I.-.|
+000000e0  cd 97 44 ec dc 2e 32 d8  39 e3 40 78 97 ef 01 69  |..D...2.9.@x...i|
+000000f0  0a b6 fc 31 d4 53 85 0c  c1 51 3a a7 02 e3 af ae  |...1.S...Q:.....|
+00000100  20 4b 44 13 c2 d1 4d de  b3 5d 24 3e 64 36 78 fd  | KD...M..]$>d6x.|
+00000110  6f 36 79 3e c2 ef 48 27  e0 e2 a3 86 61 22 14 61  |o6y>..H'....a".a|
+00000120  88 df 08 86 ed af 2a d6  2f b6 9d 30 f7 6e 28 7a  |......*./..0.n(z|
+00000130  44 2c b1 32 cc 4b 9b 6f  67 69 83 cc 7b 59 64 16  |D,.2.K.ogi..{Yd.|
+00000140  76 43 b5 0c 6f 5e 5c f0  17 e6 b4 32 0d 2d 01 91  |vC..o^\....2.-..|
+00000150  7c 00 af bf 99 fb 0b 97  8e fa 1f cc 10 4c cb 73  ||............L.s|
+00000160  81 f8 b3 7c 2e 8d ba c5  95 f1 7b 19 f2 19 48 c5  |...|......{...H.|
+00000170  ba a0 ba fd b3 29 42 1d  3a e2 f1 8f 13 c5 38 66  |.....)B.:.....8f|
+00000180  be 60 e9 a3 e4 b7 c3 e1  3d cf c3 62 85 4f f3 29  |.`......=..b.O.)|
+00000190  11 e4 72 cd c5 90 9c 45  36 11 67 8a 09 a2 f8 b1  |..r....E6.g.....|
+000001a0  48 e3 26 c5 d8 5d 8e b4  c0 af a6 e8 93 2f e8 99  |H.&..]......./..|
+000001b0  75 07 56 82 ed 58 21 2a  d8 4f dc 60 41 2f a9 49  |u.V..X!*.O.`A/.I|
+000001c0  aa 73 68 22 b7 73 5c 14  a4 46 b2 de 68 a8 f1 4a  |.sh".s\..F..h..J|
+000001d0  97 db 0d cd 29 26 d7 28  d2 d0 0c 81 43 c7 ae 0a  |....)&.(....C...|
+000001e0  c5 35 fe 55 da 7a ea 0f  78 95 f8 ed 02 84 de 5b  |.5.U.z..x......[|
+000001f0  3e ed e2 d2 25 75 a8 ec  7a 5a a9 35 eb d5 b9 08  |>...%u..zZ.5....|
+00000200  36 f9 fd 1a 18 27 d0 bf  07 46 bb 8b a8 52 bf 8b  |6....'...F...R..|
+00000210  d6 c5 3f 16 11 f9 ea 85  e9 f9 5a 68 17 20 2b 92  |..?.......Zh. +.|
+00000220  0c 58 55 b8 9a 66 6b 80  bb be 24 41 b4 2f 76 9a  |.XU..fk...$A./v.|
+00000230  c5 29 c5 86 e0 d3 1f 63  96 95 3f f2 67 7b 66 d5  |.).....c..?.g{f.|
+00000240  79 cc 47 80 8e 13 1a 29  ee 9a 97 3f 79 e0 be 20  |y.G....)...?y.. |
+00000250  c8 a1 6e 4a 85 91 7d 93  86 f4 0d 4d 5e e4 52 a9  |..nJ..}....M^.R.|
+00000260  a9 17 8b ab fd aa dc fd  a2 4b d3 d9 db 41 95 f9  |.........K...A..|
+00000270  e3 31 a4 2d 53 43 a2 b9  6a 1e f8 5b f4 0d 55 70  |.1.-SC..j..[..Up|
+00000280  f0 18 70 82 8e f3 53 3c  81 ac 13 2a b9 d0 33 dc  |..p...S<...*..3.|
+00000290  b9 8d b9 41 6a 4d 87 c6  70 f2 04 2c 60 01 5b 5d  |...AjM..p..,`.[]|
+000002a0  76 91 19 af 2d 48 82 69  59 15 c4 42 40 6a 38 3a  |v...-H.iY..B@j8:|
+000002b0  a2 db 21 b6 6d b3 e7 50  91 7c 8f f0 97 8f 7c 56  |..!.m..P.|....|V|
+000002c0  8b 4d f5 d3 7a 81 b5 4d  c5 33 ba 14 36 6f be ea  |.M..z..M.3..6o..|
+000002d0  95 1d d2 3d 29 a8 72 34  35 38 56 4c 65 47 b5 8b  |...=).r458VLeG..|
+000002e0  cb 43 9e 8d bd 1b 6b c3  2e 5b 9f f5 5a 60 e6 c9  |.C....k..[..Z`..|
+000002f0  6b c4 85 5c ac 55 fa 67  47 15 45 b4 e9 49 dd 0a  |k..\.U.gG.E..I..|
+00000300  aa be 5f d3 ec c9 88 71  52 eb 91 e9 38 e4 14 15  |.._....qR...8...|
+00000310  f3 ef 37 27 9c b1 c1 66  bb 40 c7 01 b5 8e f2 45  |..7'...f.@.....E|
+00000320  fb be c1 6a 73 a4 48 cf  e6 59 00 0b 37 56 a2 07  |...js.H..Y..7V..|
+00000330  41 29 56 2e 11 28 88 6a  37 df 46 33 a8 3d 14 3a  |A)V..(.j7.F3.=.:|
+00000340  c7 5a be 5e dc 17 03 03  00 99 15 b7 d6 a9 5d ae  |.Z.^..........].|
+00000350  e0 61 a0 09 69 01 c3 61  63 eb 94 9c e3 e3 78 e4  |.a..i..ac.....x.|
+00000360  b9 00 c3 db df cd 72 1b  86 2f 34 4f d0 da 63 c6  |......r../4O..c.|
+00000370  a9 b3 55 57 81 76 f1 fe  2b c0 85 6e 9b 6a c7 14  |..UW.v..+..n.j..|
+00000380  4c b0 48 fb a9 6d 14 f3  44 d1 30 9d ec c4 fc ac  |L.H..m..D.0.....|
+00000390  0a 79 c3 89 55 c8 92 9f  b6 bd 0b aa 85 bd 81 9b  |.y..U...........|
+000003a0  8e 94 b4 27 32 6f 26 da  40 27 6e 1f d9 7e 5e 16  |...'2o&.@'n..~^.|
+000003b0  b1 10 be 7a 9e 3a 80 ed  89 2e b9 9b b4 a9 70 11  |...z.:........p.|
+000003c0  61 46 c3 e9 b3 5e c0 b4  17 71 4a 28 44 1a 27 a4  |aF...^...qJ(D.'.|
+000003d0  20 19 47 70 2c 06 66 6a  19 a4 cb 67 2a 28 3d 4b  | .Gp,.fj...g*(=K|
+000003e0  50 02 c5 17 03 03 00 35  5b 49 ab 32 a4 7e 3c 35  |P......5[I.2.~<5|
+000003f0  a3 47 b6 57 da 5e 4a c8  5b cc 5e 71 35 32 63 7f  |.G.W.^J.[.^q52c.|
+00000400  13 ff c2 d2 db 31 d5 22  3f 6d 26 c3 d3 70 40 4d  |.....1."?m&..p@M|
+00000410  e5 2a cc 0b 51 a6 61 9e  a9 69 22 bf fb           |.*..Q.a..i"..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 02 7a 3e 62 91 75 b4  |..........z>b.u.|
-00000010  58 7d 61 ac 42 4b 1b 91  86 cd 3f c0 6d 30 5a 01  |X}a.BK....?.m0Z.|
-00000020  11 1e 77 87 92 50 bb a0  d2 c6 84 b6 10 37 02 ab  |..w..P.......7..|
-00000030  2d c2 c2 12 0a db f5 8f  e4 1f dd 16 ec 83 ad db  |-...............|
-00000040  2d 8b ec fa aa 56 44 4e  d4 af ce d2 9f 44 3d de  |-....VDN.....D=.|
-00000050  12 29 db bc 29 2a df 99  d7 d0 53 79 84 a4 b8 2d  |.)..)*....Sy...-|
-00000060  8b 5c e6 a4 b7 98 07 5a  f4 63 10 21 87 13 09 07  |.\.....Z.c.!....|
-00000070  28 98 49 48 07 70 c1 ab  8b 62 6d 40 a8 47 27 67  |(.IH.p...bm@.G'g|
-00000080  d6 ad 29 8d 2e 14 34 14  18 6b dd f0 76 3b 91 f9  |..)...4..k..v;..|
-00000090  e1 93 a2 1c 3a 5e 18 a3  c9 ca b0 c9 cf d9 3c f5  |....:^........<.|
-000000a0  a3 38 c7 83 53 67 14 ba  65 6f 11 a2 ef 78 7e ea  |.8..Sg..eo...x~.|
-000000b0  4a 90 c9 aa bf e9 8e ff  8c 9d 7c 5f 56 c3 9b 16  |J.........|_V...|
-000000c0  c1 8a a9 51 24 20 86 dc  99 ac d2 28 af 7b 2d 6e  |...Q$ .....(.{-n|
-000000d0  16 9b 71 71 82 00 94 51  a4 4f 22 c1 26 a2 6f 67  |..qq...Q.O".&.og|
-000000e0  d9 45 ff 80 13 39 16 0f  9c 43 76 54 e5 12 0f 89  |.E...9...CvT....|
-000000f0  95 ed 75 df eb cb 6b d2  77 fd fa 37 d7 a3 31 b5  |..u...k.w..7..1.|
-00000100  61 47 69 8f 99 55 70 d0  96 b0 f7 a9 1b 53 69 a3  |aGi..Up......Si.|
-00000110  e4 59 cc a1 d9 4b d5 4f  e2 47 c1 53 30 60 50 03  |.Y...K.O.G.S0`P.|
-00000120  c7 07 67 3f 68 ce 8c 32  7e f1 93 12 ba d8 67 21  |..g?h..2~.....g!|
-00000130  71 4f c9 ca ae 7b 56 8d  f7 64 14 e3 8d d6 a6 ed  |qO...{V..d......|
-00000140  d0 63 5e 00 1e f7 8a 0c  1e c3 24 e0 bd e2 e8 99  |.c^.......$.....|
-00000150  da ca 01 9e fb 21 9e 1f  57 98 f1 36 7d c8 a8 7b  |.....!..W..6}..{|
-00000160  4b 27 13 fb 8c ab d6 b3  27 3e f5 b5 08 eb cb a9  |K'......'>......|
-00000170  b0 a4 d4 3e c9 14 08 75  51 83 48 03 e7 79 65 30  |...>...uQ.H..ye0|
-00000180  a4 1a 4f a8 7a 41 c8 af  9e 74 89 4d ec eb 58 9b  |..O.zA...t.M..X.|
-00000190  20 db 80 ce e0 c8 a7 1c  b2 62 fc 85 7d 87 ca 00  | ........b..}...|
-000001a0  64 4c 25 4d 3c b2 bf 9d  46 c5 04 b5 dd 7a 29 87  |dL%M<...F....z).|
-000001b0  29 30 2e bc 42 31 9b f2  eb 7b 58 63 91 28 6f 43  |)0..B1...{Xc.(oC|
-000001c0  6b c1 4e 00 b2 4b 9d 0c  ef 18 5b 61 ec 77 84 e1  |k.N..K....[a.w..|
-000001d0  88 49 f9 e2 71 2e 35 23  b8 73 6d c2 52 d1 2f ad  |.I..q.5#.sm.R./.|
-000001e0  55 40 4e a2 b0 14 1b 50  d7 9d 12 80 89 ab 88 a5  |U@N....P........|
-000001f0  01 16 88 d5 4f 95 0c ce  79 c7 49 27 4b 44 4d fe  |....O...y.I'KDM.|
-00000200  f5 cd 95 08 b9 26 8d 52  ff d7 bc 47 11 16 d5 d0  |.....&.R...G....|
-00000210  7d 4c 3c 04 74 92 5b 85  d2 2c 95 b8 4b 02 0b 66  |}L<.t.[..,..K..f|
-00000220  60 7d b9 12 6e d3 06 73  cc c2 69 b9 fe ad f9 4c  |`}..n..s..i....L|
-00000230  f6 24 a0 eb 96 f0 b8 7c  32 dc 4c 67 04 83 15 84  |.$.....|2.Lg....|
-00000240  f9 ef 70 e7 55 85 0e 8f  b3 78 20 2c ed 69 29 89  |..p.U....x ,.i).|
-00000250  d4 d8 5e 97 16 59 90 0f  79 41 6e cf 02 d3 9d 08  |..^..Y..yAn.....|
-00000260  e4 0c 27 0c 74 97 c6 d6  89 6b c9 65 37 7b ae 6b  |..'.t....k.e7{.k|
-00000270  b7 0f e8 70 57 a3 1c 95  8d 66 da 4e 34 51 c8 e0  |...pW....f.N4Q..|
-00000280  0e 83 e3 24 64 17 03 03  00 99 e3 31 2c ae ae 1c  |...$d......1,...|
-00000290  64 6c fc 36 c8 9f c2 88  16 c7 b2 ae 4a ef 3a 90  |dl.6........J.:.|
-000002a0  f4 ad f2 91 58 37 7c 94  c2 e3 ed 76 c5 90 fb e6  |....X7|....v....|
-000002b0  88 08 a6 a2 53 5a 78 cb  bd f2 3c 6e 36 b4 cd 87  |....SZx...<n6...|
-000002c0  67 0d 0a fa c0 71 98 c8  13 dc f0 ea 51 21 16 70  |g....q......Q!.p|
-000002d0  17 03 e1 96 f5 d3 66 3b  7b f2 a1 aa 3a 67 95 13  |......f;{...:g..|
-000002e0  be 71 5f 38 a7 8a 73 4d  64 30 1c 1d 18 32 7f 7d  |.q_8..sMd0...2.}|
-000002f0  79 3e 58 43 4b c0 3c 58  58 e6 ef ac 65 99 d3 5b  |y>XCK.<XX...e..[|
-00000300  df ba 46 6d 7f ac 2e bc  8e d0 9e e1 11 ce 31 24  |..Fm..........1$|
-00000310  78 a2 1e 14 54 0a 36 9a  97 48 da 8c d4 f0 01 8c  |x...T.6..H......|
-00000320  ea 88 e1 17 03 03 00 35  95 27 fc 94 c3 7b 3b 3f  |.......5.'...{;?|
-00000330  8a 38 aa 6c d9 17 7b 69  d3 5c c5 37 61 1f 56 9f  |.8.l..{i.\.7a.V.|
-00000340  42 e3 4e ca 2d c3 ae 28  74 b2 26 ca c4 89 24 49  |B.N.-..(t.&...$I|
-00000350  fe 22 b1 6c 9b 5b 77 a3  37 fc be 06 45 17 03 03  |.".l.[w.7...E...|
-00000360  00 17 10 9e e6 81 2e 85  40 22 79 18 be 0f 7c ce  |........@"y...|.|
-00000370  c9 1e 34 c1 f6 43 94 02  59 17 03 03 00 13 da 48  |..4..C..Y......H|
-00000380  a9 c4 2f b8 08 9c ab 61  00 50 d3 ec e3 8d 50 f6  |../....a.P....P.|
-00000390  92                                                |.|
+00000000  14 03 03 00 01 01 17 03  03 02 7a 5c ca 9a 42 8c  |..........z\..B.|
+00000010  89 80 5e f5 67 03 ec e8  79 ac 9e 95 3b 12 bf 9c  |..^.g...y...;...|
+00000020  e8 c6 85 54 36 f3 7e ad  5e b8 0e 78 f7 f2 9f 73  |...T6.~.^..x...s|
+00000030  da 8a 1e f3 0f 0c be 7d  ef 3d ec d8 51 91 55 3d  |.......}.=..Q.U=|
+00000040  21 ba 3d 10 32 94 7b 1c  6b 5e 5a 18 0e 79 9c f9  |!.=.2.{.k^Z..y..|
+00000050  7c 48 73 21 ae ed 2d b7  fe 34 9c 70 10 fb 67 9f  ||Hs!..-..4.p..g.|
+00000060  c6 28 56 2e cb 42 e3 be  c5 b8 7d cf 4d 54 22 a0  |.(V..B....}.MT".|
+00000070  8f 7c ce 49 96 d2 ad 88  80 6b 06 be 36 0d c8 24  |.|.I.....k..6..$|
+00000080  c1 bd 09 e8 36 a4 a9 e7  cc 4c de ed bb d6 cf 5b  |....6....L.....[|
+00000090  da 21 75 f1 f5 6d ed 75  d2 a5 13 11 4d 4e 62 e9  |.!u..m.u....MNb.|
+000000a0  92 23 49 37 57 f4 56 a4  54 1b 59 c0 ed cf 43 d1  |.#I7W.V.T.Y...C.|
+000000b0  c3 d1 18 4d 47 5f e1 f8  13 ed f2 7d 1e 97 9d ba  |...MG_.....}....|
+000000c0  c5 49 e9 2c 76 ca 02 60  89 01 7a 47 b7 1d 07 54  |.I.,v..`..zG...T|
+000000d0  01 17 52 39 10 59 c1 58  66 3e 24 24 7d a7 94 5f  |..R9.Y.Xf>$$}.._|
+000000e0  3b df 0c 47 fc 96 bc 4a  fc 82 55 cf d3 33 b1 da  |;..G...J..U..3..|
+000000f0  37 7b b4 f3 b2 03 31 cc  2b 60 a2 e4 76 28 d5 fd  |7{....1.+`..v(..|
+00000100  4a 5f 47 e3 97 21 11 6a  5d 51 a5 43 9e bb b0 50  |J_G..!.j]Q.C...P|
+00000110  21 09 7c c8 e5 ca f9 7a  69 2c 0b 83 37 7a 8b 35  |!.|....zi,..7z.5|
+00000120  ff 63 cf df aa 18 0c 75  39 14 e7 90 0b 67 5f b6  |.c.....u9....g_.|
+00000130  94 cd 1a 49 ce 4f 46 dd  2b 61 7d 07 72 11 6e 69  |...I.OF.+a}.r.ni|
+00000140  3b 6f 0c 1c 6c 8c 10 ef  ef a1 bc 05 2f c9 20 8b  |;o..l......./. .|
+00000150  e2 fa 94 89 48 49 5d 1c  73 85 d7 e3 25 27 de a9  |....HI].s...%'..|
+00000160  1a fb 2e e0 74 c8 aa 52  4c e7 48 ec ca 99 48 ba  |....t..RL.H...H.|
+00000170  03 9b f7 75 de 01 0b 2e  9e 14 2f 1b 82 13 01 7c  |...u....../....||
+00000180  55 7e 24 06 55 59 62 f4  b6 33 69 7e c9 c1 07 07  |U~$.UYb..3i~....|
+00000190  6d 61 e0 18 d3 2b 46 4f  ff 14 01 31 06 d6 b2 d2  |ma...+FO...1....|
+000001a0  56 40 1e 69 70 21 a1 33  98 ef 23 79 6c b1 ed f6  |V@.ip!.3..#yl...|
+000001b0  15 b9 8f fc 69 7a f4 4d  3b f8 bd 50 ee 6a 15 15  |....iz.M;..P.j..|
+000001c0  0a 81 b6 4b 40 6c 15 e6  55 92 cf 8f a1 00 bf d5  |...K@l..U.......|
+000001d0  f7 74 13 30 ba ab eb 9d  82 bb 76 14 17 7e ab 30  |.t.0......v..~.0|
+000001e0  36 62 61 0a d3 2c 92 ca  95 b0 8b 41 54 b3 fa 0a  |6ba..,.....AT...|
+000001f0  82 8c aa bd 89 e2 fa 1a  87 9d 9a 1e 21 78 a4 27  |............!x.'|
+00000200  5d 16 4d e6 a7 43 a5 11  0d db 35 08 9c 23 96 8b  |].M..C....5..#..|
+00000210  80 46 5d 9f 1d 4e a2 04  17 8e 4d 57 c6 55 35 b4  |.F]..N....MW.U5.|
+00000220  ac 0b c2 44 60 f6 08 1c  cc c7 ba 7c e1 14 fb c2  |...D`......|....|
+00000230  1d 67 67 ed 20 99 14 34  5a 97 85 0b ca 36 34 8e  |.gg. ..4Z....64.|
+00000240  18 de ab 4d c6 32 6c 4f  44 eb b6 05 7b a6 37 db  |...M.2lOD...{.7.|
+00000250  57 65 8a 62 5e c4 8c 14  13 6c 41 b4 7a 0d a8 75  |We.b^....lA.z..u|
+00000260  42 a7 1b 92 34 16 2a 77  e3 63 bf 23 cc 42 9b 9d  |B...4.*w.c.#.B..|
+00000270  bd c9 ba b3 20 77 6a 56  c2 2c dc 72 9f ec b2 a8  |.... wjV.,.r....|
+00000280  57 cc 00 17 a1 17 03 03  00 99 0a d6 46 7f 5a 00  |W...........F.Z.|
+00000290  7e c4 1b 10 c4 d6 ae 8a  37 cb 47 3d bd f0 17 f3  |~.......7.G=....|
+000002a0  9b 25 fa 31 cb 75 10 1c  95 4b 80 9e ff 78 ae b4  |.%.1.u...K...x..|
+000002b0  65 b7 2f 00 3f 94 79 1d  66 52 f7 48 03 df 35 6b  |e./.?.y.fR.H..5k|
+000002c0  06 42 55 1a bd 0d f0 e0  6f 8e 8e b7 60 dc e2 ec  |.BU.....o...`...|
+000002d0  8b 9b 2e de 1a 08 65 b1  ad 9d 41 a5 32 6f bd f2  |......e...A.2o..|
+000002e0  02 47 79 4a 02 03 45 e0  2e 0e 9c e4 05 ae 8a 47  |.GyJ..E........G|
+000002f0  20 61 5a a3 da ab 84 33  11 76 81 a3 93 6b b0 9a  | aZ....3.v...k..|
+00000300  9d 64 6e f3 ba a0 ab 17  c5 3e 95 8a 1e 95 62 99  |.dn......>....b.|
+00000310  5a 12 68 96 49 05 33 b6  6e 95 46 11 9b af de 62  |Z.h.I.3.n.F....b|
+00000320  0c 5e e1 17 03 03 00 35  78 f6 24 17 fb 8f 65 3f  |.^.....5x.$...e?|
+00000330  5b 1d dd 3d 3d 73 c5 fb  1f 37 fb 54 a5 d3 58 49  |[..==s...7.T..XI|
+00000340  ed 63 22 f9 b6 fb a2 68  59 9b 04 55 03 f1 38 af  |.c"....hY..U..8.|
+00000350  2e ee 85 0c c8 95 2f f9  a9 e7 de d9 14 17 03 03  |....../.........|
+00000360  00 17 8b 72 27 df c9 0d  69 d1 95 e2 5a ea 3e dd  |...r'...i...Z.>.|
+00000370  be df 0b 72 de 0c e5 4a  19 17 03 03 00 13 0d b2  |...r...J........|
+00000380  7c 8d b1 44 32 9d 63 b1  8b 90 e1 2d 92 9c c4 b9  ||..D2.c....-....|
+00000390  cd                                                |.|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ECDSA b/src/crypto/tls/testdata/Client-TLSv13-ECDSA
index b6a3b2addb..53624650c7 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv13-ECDSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,81 +7,83 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 24 80 76 3d db  |....z...v..$.v=.|
-00000010  cf 32 53 04 de ce 2e 74  95 bb 30 a8 d5 5e ab ed  |.2S....t..0..^..|
-00000020  3c 1e 1a ae 92 63 8f 40  0b ce a4 20 00 00 00 00  |<....c.@... ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 cd 84 c1 22 3c  |....z...v....."<|
+00000010  2e 71 03 57 5f c1 27 88  ae 0e 7f 1a e7 aa 82 6d  |.q.W_.'........m|
+00000020  8d f1 18 78 8d b2 4c d6  11 c3 b0 20 00 00 00 00  |...x..L.... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 d2  |..+.....3.$... .|
-00000060  b3 86 f1 35 22 26 89 f4  07 ab b8 f5 27 a6 d5 c9  |...5"&......'...|
-00000070  87 00 59 43 b8 df da 92  f6 f5 ed f4 8d 04 26 14  |..YC..........&.|
-00000080  03 03 00 01 01 17 03 03  00 17 ed 6b 14 3a 82 c5  |...........k.:..|
-00000090  88 9d a4 96 c7 c4 c7 73  63 c6 58 65 d0 d4 a6 cb  |.......sc.Xe....|
-000000a0  dc 17 03 03 02 22 e8 c5  15 54 3c 26 7b 87 8c d3  |....."...T<&{...|
-000000b0  99 b0 af 98 21 1b 8f be  f5 d8 40 c9 05 97 39 fd  |....!.....@...9.|
-000000c0  3d b2 da 2d 80 26 c9 24  cd 14 0b 48 2e d7 c4 dc  |=..-.&.$...H....|
-000000d0  4c 61 1e 5d 46 ce 66 cd  94 50 a4 e8 c4 d7 f0 48  |La.]F.f..P.....H|
-000000e0  20 16 52 fb 12 04 17 48  7d 65 49 50 c5 b8 e6 9c  | .R....H}eIP....|
-000000f0  be f6 58 09 ea 8b 94 51  93 cf 0d 7a 76 88 78 cb  |..X....Q...zv.x.|
-00000100  37 83 43 fa 37 d5 5b 3f  10 1d 07 b1 bb 9b ac 3a  |7.C.7.[?.......:|
-00000110  43 e0 62 b1 fe 64 43 83  53 49 96 9e 81 1c 05 64  |C.b..dC.SI.....d|
-00000120  40 2a 1b 98 5f ed 8d 47  52 2c db 84 8b 6a 1e 3b  |@*.._..GR,...j.;|
-00000130  de bb 7d 20 e6 cf 2a 79  2e c4 54 71 56 2f 79 45  |..} ..*y..TqV/yE|
-00000140  07 3f 05 6c 82 e8 ab f7  62 0a 28 e0 db 83 6b bd  |.?.l....b.(...k.|
-00000150  55 81 8f 3f b6 1f d0 83  cd 97 67 71 56 f5 13 aa  |U..?......gqV...|
-00000160  45 95 65 ce 1e 42 bf 6a  83 6e bc 2e 41 28 79 b7  |E.e..B.j.n..A(y.|
-00000170  b8 3f 6e 64 14 8d ed 3a  a4 02 06 46 17 e5 c7 f8  |.?nd...:...F....|
-00000180  72 f1 5f 9b 14 96 c9 c6  53 e6 32 b2 0b cc d5 d7  |r._.....S.2.....|
-00000190  89 1e d9 52 fb 8f 48 8b  41 6e c6 f3 55 57 41 5d  |...R..H.An..UWA]|
-000001a0  95 03 9c 34 ea 3c a8 58  8d b7 89 82 e1 40 e0 60  |...4.<.X.....@.`|
-000001b0  22 ab 23 30 e8 f0 4e 21  a1 11 0a 7f 18 80 ad de  |".#0..N!........|
-000001c0  41 ba a1 12 60 31 60 0f  84 f6 91 b1 ae ca f5 81  |A...`1`.........|
-000001d0  3e d6 4e 3a 89 b6 b0 fe  3f 27 18 20 65 a9 d4 6c  |>.N:....?'. e..l|
-000001e0  ac 8a 46 08 e2 7d 06 6d  52 8c 69 9e 24 9b 8d f9  |..F..}.mR.i.$...|
-000001f0  b7 a7 74 87 bd f9 84 ca  18 7d 5b 50 1d 8e 64 e1  |..t......}[P..d.|
-00000200  39 6f f7 56 5a ef 08 6b  e2 a1 87 e4 7a 5e ea b6  |9o.VZ..k....z^..|
-00000210  12 75 2d ee e9 af a4 36  99 91 88 11 97 f3 d5 fb  |.u-....6........|
-00000220  8b 52 59 bc 9c 18 03 5b  b1 59 47 ae d4 bb a1 65  |.RY....[.YG....e|
-00000230  cf bf 40 54 e5 e7 6e e0  0c 26 0e a1 d2 4d 41 19  |..@T..n..&...MA.|
-00000240  36 b5 b6 48 33 96 8a e3  a5 56 9b 34 16 ae 36 48  |6..H3....V.4..6H|
-00000250  c5 ff 12 a7 33 f4 76 40  de d1 4b 41 ed 18 3b 04  |....3.v@..KA..;.|
-00000260  06 32 6e f3 57 c6 be 72  58 7f 78 b7 91 65 00 a8  |.2n.W..rX.x..e..|
-00000270  8d 5c 7f ff 0a 62 d4 99  82 b2 6b c8 80 3e 89 30  |.\...b....k..>.0|
-00000280  dd 31 60 7a 00 6e a2 13  c7 58 08 b0 d5 32 03 2e  |.1`z.n...X...2..|
-00000290  08 86 a2 97 7a f0 a1 95  10 5f a2 d6 fc e7 a3 93  |....z...._......|
-000002a0  16 a2 3d 33 04 e7 aa 3b  99 a5 ce c7 2c 28 71 bb  |..=3...;....,(q.|
-000002b0  ed e6 b9 5a a5 ec d1 44  54 e0 ff 41 cf 1a cb ff  |...Z...DT..A....|
-000002c0  67 43 6b af 87 19 40 74  17 03 03 00 a4 bc ef 32  |gCk...@t.......2|
-000002d0  22 da e9 d5 93 ce 06 bd  3d 6c 2e f0 0c de ec b8  |".......=l......|
-000002e0  12 d6 28 17 c6 64 aa 8d  4b 04 76 9e 41 3c 4a 94  |..(..d..K.v.A<J.|
-000002f0  9b 90 27 d2 8c bf eb 57  84 d8 72 66 c2 06 f3 99  |..'....W..rf....|
-00000300  90 d5 5d 0f fb 01 6a 29  54 25 39 3b d9 fb 1c a7  |..]...j)T%9;....|
-00000310  7e d9 cd 67 00 49 60 94  e5 47 40 15 a6 d5 d8 97  |~..g.I`..G@.....|
-00000320  57 79 1d f0 03 37 69 54  6a 7c 36 95 16 96 c3 39  |Wy...7iTj|6....9|
-00000330  d8 d2 8f 85 c3 1e 35 28  4a 62 b4 a0 47 ef 10 0c  |......5(Jb..G...|
-00000340  dc d0 b9 9a 46 42 34 e2  be 43 0f 67 bc f6 dd bc  |....FB4..C.g....|
-00000350  ab cd 44 79 77 1a 1a c3  03 4c 1f 4a ff 7e 27 3b  |..Dyw....L.J.~';|
-00000360  e1 83 84 a6 30 cf 53 ba  d9 f6 1e ae 1c 9b c3 28  |....0.S........(|
-00000370  96 17 03 03 00 35 3b b4  72 13 ca b8 f1 2f dd 42  |.....5;.r..../.B|
-00000380  5d f1 a4 93 b5 25 2b fb  12 5b dd 90 7e cb 45 3a  |]....%+..[..~.E:|
-00000390  fb 13 e6 21 42 13 08 b4  d8 3e 72 75 40 9e 30 a7  |...!B....>ru@.0.|
-000003a0  fd 46 9d 5e 79 39 e1 a8  f9 27 2b                 |.F.^y9...'+|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 1a  |..+.....3.$... .|
+00000060  28 ce a9 6b 7d 26 24 78  52 fe e1 65 34 6b 12 50  |(..k}&$xR..e4k.P|
+00000070  5c 4b b0 10 2e 94 3f b3  a0 b7 45 fc 3b 4d 31 14  |\K....?...E.;M1.|
+00000080  03 03 00 01 01 17 03 03  00 17 21 d8 25 9d 8a 8a  |..........!.%...|
+00000090  84 70 10 37 95 29 4e 00  da eb c1 e7 20 a3 09 a3  |.p.7.)N..... ...|
+000000a0  63 17 03 03 02 22 51 4c  48 48 ce 06 1d 4d 42 fa  |c...."QLHH...MB.|
+000000b0  54 16 a0 fe 66 f2 62 56  55 8e 71 0a 8a 75 8f ff  |T...f.bVU.q..u..|
+000000c0  71 72 29 09 54 f2 74 a8  0a 8c f3 62 84 2d 4c 11  |qr).T.t....b.-L.|
+000000d0  02 f1 c5 6f 2c f0 39 91  3e 58 98 e2 3d 87 0d 8b  |...o,.9.>X..=...|
+000000e0  5a 77 8f 2d 38 fb 3a b8  63 4f 79 24 bb 40 6f 09  |Zw.-8.:.cOy$.@o.|
+000000f0  28 01 bd 03 53 f0 63 fc  49 92 ba 9b 3b fd a1 75  |(...S.c.I...;..u|
+00000100  cf be 2c 5a da 3d 53 b2  11 5c f8 66 26 d0 78 6c  |..,Z.=S..\.f&.xl|
+00000110  3e a0 34 16 2b 28 6b 73  95 08 d7 e6 2f f4 f3 74  |>.4.+(ks..../..t|
+00000120  3f 1d e1 a5 e4 0e 82 af  52 58 09 b0 90 f8 ee ea  |?.......RX......|
+00000130  5a 34 b7 29 7a a6 bb 0a  2f 64 f7 51 80 71 90 82  |Z4.)z.../d.Q.q..|
+00000140  d2 1a fa c9 43 de 31 eb  a1 f6 b0 31 99 5e 8b 84  |....C.1....1.^..|
+00000150  6b f1 66 6e 49 6d 2e 52  e1 c4 21 76 7b 1e bf d4  |k.fnIm.R..!v{...|
+00000160  c1 8f 7c 1b a9 6f 4d 1b  03 86 63 8b d4 64 24 79  |..|..oM...c..d$y|
+00000170  73 00 1e cc 2b 5c a6 65  db 35 74 95 9b 04 5d ce  |s...+\.e.5t...].|
+00000180  ef 54 eb be 6a 6a 04 5d  e2 ba cb 4f c7 3f 33 8f  |.T..jj.]...O.?3.|
+00000190  20 51 6c 03 0a 1a 90 e3  74 e4 e3 2f 78 00 1b 4a  | Ql.....t../x..J|
+000001a0  17 9a 6f 35 0b b8 0e 30  cc 51 87 fa 17 d9 95 39  |..o5...0.Q.....9|
+000001b0  b5 51 c6 3f 6f 9b 39 74  c6 3e a3 8e 10 2f fc eb  |.Q.?o.9t.>.../..|
+000001c0  85 b3 a3 6e 21 5d 9f dc  fb 6a 5f 4b 42 5c a1 f5  |...n!]...j_KB\..|
+000001d0  c3 b7 5c ef 86 22 e9 bb  ae 97 96 ff 06 b1 d8 19  |..\.."..........|
+000001e0  38 6b 23 03 30 ea 1c 6f  c3 4a 94 74 35 16 61 2e  |8k#.0..o.J.t5.a.|
+000001f0  c6 9d a7 db b0 50 63 f7  e2 7c 00 2b 12 05 89 f2  |.....Pc..|.+....|
+00000200  e9 06 98 12 3c 77 6e d3  09 7f 6f 93 28 1e ce 1f  |....<wn...o.(...|
+00000210  e5 1f 18 b3 65 14 71 22  58 3b e1 a9 6a 03 16 37  |....e.q"X;..j..7|
+00000220  5c 93 3c ad 66 29 59 45  05 8f ae 0d b3 ca 79 ad  |\.<.f)YE......y.|
+00000230  40 9f ad 12 94 26 80 69  12 32 3d bf 90 90 e6 a1  |@....&.i.2=.....|
+00000240  f6 d4 ab 94 27 0c ab 1b  e9 36 7a 6f 88 58 4a 54  |....'....6zo.XJT|
+00000250  5d 86 bf 2b 1c 0d 3c 02  2e f1 93 63 7f 16 75 8b  |]..+..<....c..u.|
+00000260  a4 ef ee ea b3 dd 2a cf  c8 4a 78 79 54 ca 78 82  |......*..JxyT.x.|
+00000270  1f b2 20 af 90 39 9b 90  01 ce eb 5f 42 c1 9a 1e  |.. ..9....._B...|
+00000280  33 b9 a5 9b ff 48 40 7e  ed 26 ba 51 93 50 31 20  |3....H@~.&.Q.P1 |
+00000290  dd 38 f1 51 53 92 ee c5  63 a8 5a 62 db 1b d6 79  |.8.QS...c.Zb...y|
+000002a0  77 7c c8 45 8d f4 b3 c9  c9 60 e2 5d f3 8a 4c bc  |w|.E.....`.]..L.|
+000002b0  f8 f0 ee 10 61 50 4b 2d  df 5a e7 2b 48 fe 96 06  |....aPK-.Z.+H...|
+000002c0  c8 92 73 4c fc 5a 03 17  17 03 03 00 a3 24 2b 19  |..sL.Z.......$+.|
+000002d0  f9 ef c8 14 4e 1a 90 bc  2b a3 ff 95 52 99 b8 73  |....N...+...R..s|
+000002e0  49 10 fa 44 8e 39 a8 48  17 6c e6 7f bf 0d 93 95  |I..D.9.H.l......|
+000002f0  09 93 92 27 57 49 f2 79  16 36 2b 90 a9 1c 17 32  |...'WI.y.6+....2|
+00000300  a7 fa 2e 8d ca 68 40 09  dd c7 68 40 6a 2a 87 11  |.....h@...h@j*..|
+00000310  fc fc 2f fe e2 3a df 86  23 8b 4d 15 29 d9 a1 87  |../..:..#.M.)...|
+00000320  2b ac 58 72 eb c3 ac 3a  a2 30 6f 07 54 d1 72 ea  |+.Xr...:.0o.T.r.|
+00000330  7e 7b 7b 71 6c b6 57 64  d7 3f a6 59 f7 b0 8c 3f  |~{{ql.Wd.?.Y...?|
+00000340  8e d1 cb e6 75 f6 7d bf  43 cc be 35 a4 19 f9 48  |....u.}.C..5...H|
+00000350  c4 b7 bf 91 44 df 9a d5  97 7a f3 4c 98 08 b3 6e  |....D....z.L...n|
+00000360  a8 1c c6 d9 36 89 06 37  84 98 d3 e7 7c 11 f3 06  |....6..7....|...|
+00000370  17 03 03 00 35 9c d8 82  e3 d2 7b b5 48 1e 82 ee  |....5.....{.H...|
+00000380  05 ff a5 9f 3b bb 69 41  72 99 2e 78 57 d6 81 9c  |....;.iAr..xW...|
+00000390  57 36 f9 bf 52 cd 8d 30  f6 67 5e e3 30 12 2f f5  |W6..R..0.g^.0./.|
+000003a0  19 a1 27 97 af a8 1f c3  73 78                    |..'.....sx|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 09 35 dd b0 97  |..........5.5...|
-00000010  7b a4 5b ef 16 90 e4 15  aa 19 e4 5b e8 f1 11 c0  |{.[........[....|
-00000020  e0 fa 4b 0e df a3 4a 7c  cd 9a 0a c4 05 65 e9 5b  |..K...J|.....e.[|
-00000030  8b 0b e0 3c b2 5a cc eb  87 2b 67 0d 9f 19 d0 ec  |...<.Z...+g.....|
-00000040  17 03 03 00 17 68 1f ad  70 7c 49 62 6b 2f 67 15  |.....h..p|Ibk/g.|
-00000050  d1 bf bb 35 b3 b3 2b f3  12 27 b6 0e 17 03 03 00  |...5..+..'......|
-00000060  13 23 39 42 9f 8a 9e 68  41 39 fa 3b 50 bc 56 59  |.#9B...hA9.;P.VY|
-00000070  d0 3a 5a 9a                                       |.:Z.|
+00000000  14 03 03 00 01 01 17 03  03 00 35 c8 b8 4f 16 71  |..........5..O.q|
+00000010  03 a4 39 02 a9 6e 62 a5  62 8e 64 7d 13 8c 11 66  |..9..nb.b.d}...f|
+00000020  f2 6c 24 36 5b 9c 95 6b  5b ea fc 66 a2 ef 7c 97  |.l$6[..k[..f..|.|
+00000030  0c 75 7a 05 99 21 ff af  fc 91 b3 64 74 64 89 76  |.uz..!.....dtd.v|
+00000040  17 03 03 00 17 3f b3 8e  94 d5 bd e2 79 9c e5 d3  |.....?......y...|
+00000050  f7 3d bd aa 6a 35 5a 1a  0b 96 69 3d 17 03 03 00  |.=..j5Z...i=....|
+00000060  13 d7 34 66 9d 25 f2 de  49 40 34 20 a5 0c 88 b5  |..4f.%..I@4 ....|
+00000070  00 e8 ac ee                                       |....|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-Ed25519 b/src/crypto/tls/testdata/Client-TLSv13-Ed25519
index 3a2915d613..04c26cb654 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-Ed25519
+++ b/src/crypto/tls/testdata/Client-TLSv13-Ed25519
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,63 +7,65 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 b2 4d aa 76 5b  |....z...v...M.v[|
-00000010  b7 38 95 18 e6 81 66 f8  27 82 26 2c b3 44 50 b0  |.8....f.'.&,.DP.|
-00000020  f4 a8 f5 f2 87 f0 9d 85  4f ac 60 20 00 00 00 00  |........O.` ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 41 2a 70 9e fa  |....z...v..A*p..|
+00000010  49 ab 26 ea 07 12 90 9f  e9 be 67 21 3a 0f e8 c9  |I.&.......g!:...|
+00000020  54 97 77 ce d4 54 04 0d  2d b6 1a 20 00 00 00 00  |T.w..T..-.. ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 e7  |..+.....3.$... .|
-00000060  c2 3e 68 73 d9 fd 6e 69  16 15 85 84 24 45 36 47  |.>hs..ni....$E6G|
-00000070  1b ad d9 c4 dc 4a 61 c6  12 5c 22 bf 1e 2f 59 14  |.....Ja..\"../Y.|
-00000080  03 03 00 01 01 17 03 03  00 17 0f a4 05 81 10 48  |...............H|
-00000090  c7 b7 78 9b 56 14 6c 9f  55 28 e3 4c 42 80 cc 1c  |..x.V.l.U(.LB...|
-000000a0  31 17 03 03 01 50 0d af  3b 08 02 84 89 42 b5 75  |1....P..;....B.u|
-000000b0  c5 8f 9f c2 b1 dc cb 7c  6a d5 31 41 9a 16 8f fa  |.......|j.1A....|
-000000c0  74 40 21 5d f9 cc b0 1d  30 80 87 9a b2 57 58 53  |t@!]....0....WXS|
-000000d0  2c 9e 5c 97 20 9c 81 77  16 25 62 9b fc a4 e1 9a  |,.\. ..w.%b.....|
-000000e0  80 c8 9a 4c f6 fc ae 79  a5 c2 26 4b 55 41 ff d0  |...L...y..&KUA..|
-000000f0  25 4b 70 c9 ad b6 04 80  65 19 e0 fe 05 e7 b4 dc  |%Kp.....e.......|
-00000100  53 8f f8 3b ed 2c df b9  08 c2 da 60 b9 23 17 50  |S..;.,.....`.#.P|
-00000110  da 0f 24 76 15 21 e6 e9  a8 f5 3e 08 cc 1b ee 92  |..$v.!....>.....|
-00000120  2b 01 92 8d f9 4f 5a 3a  53 11 fc 32 52 cc af cd  |+....OZ:S..2R...|
-00000130  7b 94 0e 76 10 c2 16 36  2d a4 64 69 1c 05 70 20  |{..v...6-.di..p |
-00000140  0d 23 cd 4a 33 c5 c7 db  db 0f f8 b6 42 0c 83 0a  |.#.J3.......B...|
-00000150  a1 73 68 fb 87 2c 9d d2  d3 cf d7 3a bb 36 7e 83  |.sh..,.....:.6~.|
-00000160  c3 3f bc e2 61 d9 c2 8b  15 a2 cc bf 14 a0 69 f4  |.?..a.........i.|
-00000170  22 02 a9 ff 5e 55 37 6e  61 86 71 73 94 2f 7e 50  |"...^U7na.qs./~P|
-00000180  45 96 cf 23 dd 39 90 5d  57 04 a3 d0 9f 97 f8 56  |E..#.9.]W......V|
-00000190  fa cf 7a a9 e6 57 1f cb  33 a0 82 7a 84 94 1f 6d  |..z..W..3..z...m|
-000001a0  d8 0b c7 fb bc 62 94 36  4a d6 96 ce f6 f2 7f 06  |.....b.6J.......|
-000001b0  18 59 66 77 77 12 8c 74  06 61 8f b6 37 35 65 fd  |.Yfww..t.a..75e.|
-000001c0  f1 0b fe e6 cc a9 64 f5  b5 0d 06 4e 38 4b 4b 78  |......d....N8KKx|
-000001d0  be 6a cc 67 9e 39 f8 f2  27 33 a9 2d bc 9c 5e 06  |.j.g.9..'3.-..^.|
-000001e0  b9 fb 76 0c be 8d 2a a5  6d cf 83 55 4f c5 6e 6e  |..v...*.m..UO.nn|
-000001f0  d0 08 8b f6 5a 61 17 03  03 00 59 c1 cc 58 14 33  |....Za....Y..X.3|
-00000200  5a 39 b5 40 46 e8 b1 28  06 08 22 d3 27 b4 e6 ef  |Z9.@F..(..".'...|
-00000210  10 79 08 d4 ce 9e e2 cb  0b 86 a4 b1 80 e4 1b ac  |.y..............|
-00000220  71 15 fd 16 5b aa 01 c2  7b e3 c2 84 01 c0 f6 04  |q...[...{.......|
-00000230  a7 31 2b ec f2 50 bf 5a  07 6f b8 03 9f d2 c6 ad  |.1+..P.Z.o......|
-00000240  73 18 81 f5 fd 9a 5a b2  bc 9f 85 94 9f f6 da da  |s.....Z.........|
-00000250  dd 56 bc 66 17 03 03 00  35 9f 7e 2e 02 66 bb ac  |.V.f....5.~..f..|
-00000260  3d d8 92 70 c9 35 c6 df  ff 0f 81 b5 ca d4 56 4a  |=..p.5........VJ|
-00000270  24 06 06 57 28 e9 9d 82  0e 40 06 a7 f8 cc bc 6c  |$..W(....@.....l|
-00000280  a2 ea 2b 0e 88 77 05 de  3d 30 a0 6f bc 98        |..+..w..=0.o..|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 28  |..+.....3.$... (|
+00000060  42 18 1f f9 3f 73 01 41  63 08 8d a1 1a a5 8b 5f  |B...?s.Ac......_|
+00000070  d0 63 44 21 d2 fc d8 7e  46 9f 66 62 0d c0 19 14  |.cD!...~F.fb....|
+00000080  03 03 00 01 01 17 03 03  00 17 66 d5 4f 1f 0b 85  |..........f.O...|
+00000090  65 0a 81 21 55 2f 17 bc  ad e1 83 69 29 51 6b 7f  |e..!U/.....i)Qk.|
+000000a0  15 17 03 03 01 50 b2 f9  51 18 c9 23 24 91 b8 b0  |.....P..Q..#$...|
+000000b0  32 8d 3c 81 8a ca c3 25  8a 1f cc 17 d1 67 07 42  |2.<....%.....g.B|
+000000c0  7b 82 ae 1f b8 65 55 e2  ce 2e ad d3 90 bf 3f 2d  |{....eU.......?-|
+000000d0  85 dc 68 3a 4c 1a 79 9e  cc 86 d3 20 7b 7e ba b4  |..h:L.y.... {~..|
+000000e0  cf 8b 4b f8 9b 58 0f 7f  24 cc aa 80 4b be 8f 3e  |..K..X..$...K..>|
+000000f0  88 1e b1 10 0b 8c 74 6b  2e ad 8d c9 40 e1 3f 4a  |......tk....@.?J|
+00000100  90 5c 97 79 f4 aa 62 e1  e1 2e e4 f4 22 ce ab 85  |.\.y..b....."...|
+00000110  d6 ac e1 d8 21 f8 ed 70  3e 92 0d 2c b2 39 f9 a5  |....!..p>..,.9..|
+00000120  da ce 3e ff 76 09 54 10  35 86 80 f8 fa 86 44 a1  |..>.v.T.5.....D.|
+00000130  78 7c 9c a8 15 c9 55 92  e8 14 0d 99 c8 40 7c f7  |x|....U......@|.|
+00000140  d9 d6 cd ae bf 05 f9 da  0f 33 b1 ee ae 39 bb 30  |.........3...9.0|
+00000150  3c f2 3d e4 0a b7 e1 e7  6a 5f 48 65 a6 28 37 26  |<.=.....j_He.(7&|
+00000160  c1 18 0b 31 f2 79 00 fd  25 d6 76 8f 7b bc 7e 2e  |...1.y..%.v.{.~.|
+00000170  3d f2 bb b2 1a 5f 1b 7d  df b5 f5 bb b2 e7 1b 51  |=...._.}.......Q|
+00000180  de cc 4d 2b 32 c6 cd 33  97 32 d3 c8 02 89 a2 0a  |..M+2..3.2......|
+00000190  a2 6a 2c d4 6f b8 97 3b  7d bf 42 18 97 a3 2d 51  |.j,.o..;}.B...-Q|
+000001a0  70 a7 f0 9f 04 2a a0 6f  2f 30 7c fe b6 fc dd c5  |p....*.o/0|.....|
+000001b0  6a 65 e3 a2 7a c0 d8 31  37 3f c0 36 79 d2 a0 20  |je..z..17?.6y.. |
+000001c0  7d 4e ea 8c 44 77 53 e9  db 90 ef 24 26 05 ce b0  |}N..DwS....$&...|
+000001d0  9e 18 a9 8f 21 55 b6 40  63 b5 4c f6 74 2d 4a c5  |....!U.@c.L.t-J.|
+000001e0  7f 67 ee 95 35 21 e0 22  61 c5 68 5f e7 b3 ac 4d  |.g..5!."a.h_...M|
+000001f0  4e e5 31 bb 10 22 17 03  03 00 59 ab 04 24 cb f7  |N.1.."....Y..$..|
+00000200  33 03 08 97 0b d5 9e a7  23 18 ec b6 f6 e8 ee 1f  |3.......#.......|
+00000210  2d 5f 6b 73 92 ce ac 3b  59 50 27 77 ac 73 ac fe  |-_ks...;YP'w.s..|
+00000220  b1 5a 8e 9e 81 50 54 4d  3b f7 7b 1e f9 f9 c1 d5  |.Z...PTM;.{.....|
+00000230  c6 08 b5 88 55 96 13 c6  d4 f6 cd b5 5d 5a 27 ae  |....U.......]Z'.|
+00000240  27 95 e0 55 0e c5 fe 6b  9a ae 3d f8 3a b9 05 f6  |'..U...k..=.:...|
+00000250  ef 90 99 30 17 03 03 00  35 54 af 85 8b 06 b2 ee  |...0....5T......|
+00000260  a8 6f 18 76 9b 9a ea 2e  57 b9 2c 9e a7 56 6c 49  |.o.v....W.,..VlI|
+00000270  ab 6e 10 4e fc c8 9c 37  b3 dc 95 8b 74 07 e9 90  |.n.N...7....t...|
+00000280  a3 35 72 b4 60 9a ea 87  a7 76 72 42 7d b7        |.5r.`....vrB}.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 1c 60 8f 01 6b  |..........5.`..k|
-00000010  7c e3 d4 28 24 d8 7c 85  7f 63 44 23 97 7c a0 de  ||..($.|..cD#.|..|
-00000020  70 61 9e d9 ce 35 d9 3b  81 68 09 12 c1 b9 5e f5  |pa...5.;.h....^.|
-00000030  32 23 9b 47 fc be 74 3c  e6 1b 3f cd e8 c1 f1 4f  |2#.G..t<..?....O|
-00000040  17 03 03 00 17 1a 16 bc  fe 99 30 d8 97 c1 00 d9  |..........0.....|
-00000050  fd 1a 44 bd 84 35 dc 66  62 eb 28 3d 17 03 03 00  |..D..5.fb.(=....|
-00000060  13 b4 8a 54 df ae 97 ce  2e ae fa 38 ca 02 a1 d6  |...T.......8....|
-00000070  f5 40 64 2b                                       |.@d+|
+00000000  14 03 03 00 01 01 17 03  03 00 35 70 04 7a 93 3e  |..........5p.z.>|
+00000010  de c0 df 1d 2b 25 ea c4  7d 57 eb 94 59 80 2c d6  |....+%..}W..Y.,.|
+00000020  80 0e 5e 9f 22 00 82 1c  e0 2e 15 1e 5d b6 16 84  |..^.".......]...|
+00000030  83 83 79 29 54 49 dc bb  b8 f0 f8 71 13 09 7d e9  |..y)TI.....q..}.|
+00000040  17 03 03 00 17 93 e8 8f  30 24 3b e7 5e a4 15 b3  |........0$;.^...|
+00000050  f6 53 15 d6 f8 4c ab 0c  32 d6 28 ef 17 03 03 00  |.S...L..2.(.....|
+00000060  13 2b ea 8e 10 9d 46 08  d9 43 04 da d8 5a 78 f8  |.+....F..C...Zx.|
+00000070  33 c0 62 33                                       |3.b3|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ExportKeyingMaterial b/src/crypto/tls/testdata/Client-TLSv13-ExportKeyingMaterial
index 13ae97153a..ef0029ff07 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ExportKeyingMaterial
+++ b/src/crypto/tls/testdata/Client-TLSv13-ExportKeyingMaterial
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,85 +7,87 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 48 e6 a7 a9 4c  |....z...v..H...L|
-00000010  c3 a7 cc 18 b7 71 7d ed  c5 6a cb ca b5 9f 00 fd  |.....q}..j......|
-00000020  f8 2c ac 9c 1f 24 27 b9  c6 55 8e 20 00 00 00 00  |.,...$'..U. ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 3e 1e de 6b d3  |....z...v..>..k.|
+00000010  83 f0 87 bd 4c 26 fe 68  40 01 f3 c6 c8 39 b4 b3  |....L&.h@....9..|
+00000020  46 c7 ae 97 1a b2 67 a0  6a 7f 93 20 00 00 00 00  |F.....g.j.. ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 dd  |..+.....3.$... .|
-00000060  be 27 eb a0 9c b1 22 6a  8c 29 9a d4 47 c2 ee 14  |.'...."j.)..G...|
-00000070  39 0c 60 81 c9 06 3f dc  e5 e0 24 9a c4 88 35 14  |9.`...?...$...5.|
-00000080  03 03 00 01 01 17 03 03  00 17 25 70 5a e5 6b 9e  |..........%pZ.k.|
-00000090  56 b9 cf 83 48 b0 bc 99  6a 86 e1 cb 4e ce b5 10  |V...H...j...N...|
-000000a0  e0 17 03 03 02 6d c7 a6  79 ef b0 81 d6 e4 0e 02  |.....m..y.......|
-000000b0  59 32 88 cc b1 0d 53 f6  33 9b d2 e8 74 a9 0a a7  |Y2....S.3...t...|
-000000c0  f9 76 e9 6e 0d 16 75 0b  e0 8f 5c b5 31 47 6b 68  |.v.n..u...\.1Gkh|
-000000d0  52 c7 c2 84 cb 48 81 a3  da bd a1 50 5c ec 5c a7  |R....H.....P\.\.|
-000000e0  10 01 58 cc 03 c3 53 04  03 69 80 f4 ad 4d ce 72  |..X...S..i...M.r|
-000000f0  26 4e 6c c7 2c 31 69 2b  fd 97 67 5e 7d e0 05 b3  |&Nl.,1i+..g^}...|
-00000100  f4 40 64 a1 bd a3 fd a8  f9 7b 18 82 89 8f 25 f9  |.@d......{....%.|
-00000110  ca ca c4 8f e4 90 7b 26  7a d5 b2 1e fa 05 db ad  |......{&z.......|
-00000120  8a 9f 93 e9 13 5b 28 cc  cb 8b 30 f2 4c 1d 73 09  |.....[(...0.L.s.|
-00000130  7f 6b 63 5c 29 36 2f fc  a5 6e eb 24 79 f8 7c 63  |.kc\)6/..n.$y.|c|
-00000140  1f ef 41 72 98 69 7c d6  8d f9 76 d4 4d af b0 71  |..Ar.i|...v.M..q|
-00000150  2e f7 f8 b5 73 45 05 52  fa 25 46 02 28 0d d9 7a  |....sE.R.%F.(..z|
-00000160  60 13 b9 6c 6d fb f3 be  e3 04 74 76 72 d6 a4 91  |`..lm.....tvr...|
-00000170  d1 2c 0d 1e fa 23 ef c7  80 ff 1e aa 1b af 50 58  |.,...#........PX|
-00000180  77 ea 49 d9 22 4d ed bc  bf a6 0a 41 8e e7 5b 31  |w.I."M.....A..[1|
-00000190  de 33 05 10 46 a5 54 aa  5e 90 5c 15 64 2d 1b e9  |.3..F.T.^.\.d-..|
-000001a0  5c fc 93 8d 2f b2 af 74  d7 d2 c6 7f 27 68 fd 44  |\.../..t....'h.D|
-000001b0  13 60 70 87 e8 08 e1 e2  af 7f 1a 2c 29 5f 45 fe  |.`p........,)_E.|
-000001c0  49 9a d0 42 c9 51 ef f7  5b ae 02 df 27 1c 29 20  |I..B.Q..[...'.) |
-000001d0  35 4f 3d 7d 74 97 0c 20  be f8 a3 c9 b7 ff 65 69  |5O=}t.. ......ei|
-000001e0  08 89 92 fe 85 65 9f 8a  00 4b 9f 39 8d 6f 29 7c  |.....e...K.9.o)||
-000001f0  7c e9 16 e4 bd 06 a3 b0  5b 7f cf f0 74 14 56 a2  ||.......[...t.V.|
-00000200  76 61 b8 79 10 44 55 4f  25 55 a7 be a4 eb 2e 7d  |va.y.DUO%U.....}|
-00000210  9a b8 7a d8 d7 34 b6 ef  6c f7 fb ef fd 16 c2 61  |..z..4..l......a|
-00000220  89 bb 98 22 c6 80 9e 33  7f e9 35 7a 58 b6 33 1c  |..."...3..5zX.3.|
-00000230  d6 87 68 b7 62 21 3b 26  9b f1 b1 f2 92 d5 4b 19  |..h.b!;&......K.|
-00000240  02 58 05 3c 81 cf 00 5a  54 86 a5 61 8f 71 ae 32  |.X.<...ZT..a.q.2|
-00000250  f2 0f 08 3b 13 4d f3 e6  03 2e 73 9c 50 4a b7 6c  |...;.M....s.PJ.l|
-00000260  d8 0a 04 fc b5 44 a5 45  c8 86 c9 9f 29 b4 00 90  |.....D.E....)...|
-00000270  d8 8b e0 c8 ba 63 9f 42  65 ef ba 5b dc b2 61 53  |.....c.Be..[..aS|
-00000280  e6 4b 29 72 51 c9 21 d4  d7 2d 14 56 82 80 32 36  |.K)rQ.!..-.V..26|
-00000290  fd 72 b6 16 6f 06 71 f9  60 4f 32 ce f6 83 94 75  |.r..o.q.`O2....u|
-000002a0  d9 23 d3 41 f8 e7 90 60  80 a8 a5 95 c0 a2 dd 2e  |.#.A...`........|
-000002b0  e7 60 73 5b c0 a5 a0 bd  8b bc cc 32 8a 9e 30 6a  |.`s[.......2..0j|
-000002c0  72 2f 61 24 56 0b 1e 3e  52 92 d2 e0 11 cd 52 69  |r/a$V..>R.....Ri|
-000002d0  c4 73 7f 72 95 fd f5 c4  72 d7 77 73 85 bf be e0  |.s.r....r.ws....|
-000002e0  cd 3c 3b 3d 92 63 91 ba  c8 a8 d2 32 40 6a 33 91  |.<;=.c.....2@j3.|
-000002f0  c0 71 fe ea 76 9f a9 96  dc c0 a9 bd 67 b6 23 42  |.q..v.......g.#B|
-00000300  d9 1b 3d 8d d4 5f 81 38  74 1c db 36 9e bd 79 fd  |..=.._.8t..6..y.|
-00000310  30 c5 db 17 03 03 00 99  61 1e 25 cb 11 26 61 72  |0.......a.%..&ar|
-00000320  a0 9a de 5b ad 5b ad 8a  29 43 eb 76 5a 16 a4 d3  |...[.[..)C.vZ...|
-00000330  d4 a1 84 e4 7e a1 2b 76  75 b6 a5 a6 36 da d3 bf  |....~.+vu...6...|
-00000340  0c 3a 39 ca ef 3f 02 22  63 3d 5d c1 30 94 ba 32  |.:9..?."c=].0..2|
-00000350  fe c0 20 c1 ba c8 fa 29  e8 1c c6 ab f0 c9 53 a4  |.. ....)......S.|
-00000360  73 d0 9a 2d 50 d8 b4 0c  db e5 4a 9f 98 38 34 c9  |s..-P.....J..84.|
-00000370  9f ff 63 a9 50 7b 26 00  64 26 4d 0d 20 d5 e5 27  |..c.P{&.d&M. ..'|
-00000380  e1 41 7b 5a 03 97 0a 14  8c 55 3c 45 4b 72 ce de  |.A{Z.....U<EKr..|
-00000390  38 59 4b ed fe 70 a7 af  a7 67 c9 03 f8 fe ea 96  |8YK..p...g......|
-000003a0  ac 81 9a ed 8e ef 69 aa  7a eb 03 1b 13 1e ca da  |......i.z.......|
-000003b0  58 17 03 03 00 35 70 23  20 5a eb 40 0b b8 6f 1a  |X....5p# Z.@..o.|
-000003c0  d8 b0 ae c5 de 52 6b 77  10 87 cd 2f ec fe 99 1c  |.....Rkw.../....|
-000003d0  93 c0 f7 6b 8b d2 8b 81  9b 05 36 82 bf 4a b4 a0  |...k......6..J..|
-000003e0  d2 9f 75 b3 ef 64 50 7f  00 ac fa                 |..u..dP....|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 6a  |..+.....3.$... j|
+00000060  bc 9c e7 36 da f4 e7 90  ca e8 12 65 27 0c f0 b4  |...6.......e'...|
+00000070  e9 e4 e8 b9 6e 4c 2c 56  29 7d 97 e5 89 d6 71 14  |....nL,V)}....q.|
+00000080  03 03 00 01 01 17 03 03  00 17 14 a3 91 83 8e 8b  |................|
+00000090  cb 7b 17 d0 1d 4b 37 bb  94 3f c1 18 44 7f ac 57  |.{...K7..?..D..W|
+000000a0  0d 17 03 03 02 6d 60 0a  40 97 d6 cb 85 46 8c 9b  |.....m`.@....F..|
+000000b0  fd c6 3b 03 02 e4 57 84  00 f8 b4 8e 25 0c 85 21  |..;...W.....%..!|
+000000c0  70 bc 17 c2 32 57 46 63  a9 42 32 c6 fb 6c b1 7c  |p...2WFc.B2..l.||
+000000d0  be 7d 4d 37 9c 72 42 ca  02 39 43 9e 70 4c 73 f6  |.}M7.rB..9C.pLs.|
+000000e0  72 45 91 f4 72 8b dc cd  c4 25 68 77 d6 91 62 8f  |rE..r....%hw..b.|
+000000f0  f1 88 ee 92 f8 ce 4c dd  86 d0 eb c7 c7 75 48 fe  |......L......uH.|
+00000100  3c 27 48 f7 6c 3e 2e 18  64 02 82 0f 08 6f 93 1c  |<'H.l>..d....o..|
+00000110  15 bb d0 06 36 1c a9 ab  5e 76 b5 7b f1 fa 0b 27  |....6...^v.{...'|
+00000120  09 01 23 58 1d 5e 8e 7c  a9 ba 87 de c2 05 31 a5  |..#X.^.|......1.|
+00000130  7a 20 cc 4c 4a 72 65 3b  8a a5 66 b6 d3 49 10 49  |z .LJre;..f..I.I|
+00000140  7c 3d 27 13 88 01 48 65  41 5d 25 b7 6a 96 78 86  ||='...HeA]%.j.x.|
+00000150  03 d7 53 7b 9c fb db db  c8 d7 5e 71 f4 6c 03 49  |..S{......^q.l.I|
+00000160  6b e3 0d a4 07 ac 7c 45  b7 98 d1 0d 24 72 93 1d  |k.....|E....$r..|
+00000170  f3 f6 51 3b 5f 08 43 fe  5b db 1a ad 84 10 bd d1  |..Q;_.C.[.......|
+00000180  88 fe 24 83 e3 46 d1 40  a0 c0 e9 dc 19 75 b2 8f  |..$..F.@.....u..|
+00000190  5e ea 67 2e 0e a3 79 bd  9f 92 f4 0a d0 fd f0 26  |^.g...y........&|
+000001a0  f9 40 d1 3c 76 03 61 ab  11 d1 c6 22 e2 62 ea 35  |.@.<v.a....".b.5|
+000001b0  bf e5 22 17 1b 6a be bf  0b 8f 3b ae 3e 87 1f 40  |.."..j....;.>..@|
+000001c0  79 1f 3b 1f 56 6f b7 98  e1 6e bb 4c 0a 11 cf 1c  |y.;.Vo...n.L....|
+000001d0  68 a2 87 a6 83 72 ab d1  a8 4f 39 48 fc d0 54 bf  |h....r...O9H..T.|
+000001e0  47 7f 7c 8f 91 7d 40 96  01 b0 ec 62 b0 16 b8 d3  |G.|..}@....b....|
+000001f0  02 15 68 e0 7e d7 40 0a  9f 5e cf 21 75 40 d6 4c  |..h.~.@..^.!u@.L|
+00000200  50 c0 05 8f 8e db b5 44  d3 50 24 be c3 7b 5d 39  |P......D.P$..{]9|
+00000210  a5 cb 92 d5 dd 4b 16 c2  6a ec e5 f6 79 6d 04 6f  |.....K..j...ym.o|
+00000220  26 fd 55 ba 8a 38 db ab  dd 78 13 a7 de 23 e7 c0  |&.U..8...x...#..|
+00000230  c6 97 34 18 26 2e d0 ef  b0 d7 1a 3c af cc 2f 79  |..4.&......<../y|
+00000240  ea cd d3 b2 02 99 5a ca  c8 49 39 f7 df 64 5d 1a  |......Z..I9..d].|
+00000250  89 59 92 33 e8 ae 19 ca  42 53 c0 1a 18 6b 9e 8f  |.Y.3....BS...k..|
+00000260  65 64 b3 b3 6f 4c c8 7c  46 fb 2f 0a ad ed ef 15  |ed..oL.|F./.....|
+00000270  14 dd dd ae b0 09 d4 5a  ba 2e 78 a2 3e 8e d4 35  |.......Z..x.>..5|
+00000280  a2 96 a1 a2 08 f8 0c c6  a3 13 be 09 b8 5f 00 04  |............._..|
+00000290  22 78 98 cf 41 24 40 e9  93 4e b0 86 15 e1 5e c2  |"x..A$@..N....^.|
+000002a0  cf c3 49 51 1a d8 a1 e6  c0 a9 ea 35 b2 56 ee 2d  |..IQ.......5.V.-|
+000002b0  08 4e 3b 3d 03 cb f1 54  94 a0 d5 6a 9c bc d8 7c  |.N;=...T...j...||
+000002c0  f1 22 10 0a 5c d9 66 87  fa e2 8e e8 41 cc ce cd  |."..\.f.....A...|
+000002d0  a9 c2 c7 11 4c e2 e4 20  70 ae aa d1 1e 47 b7 ee  |....L.. p....G..|
+000002e0  b3 45 18 3a a9 31 44 bb  b0 7f 73 6a df 2a 67 00  |.E.:.1D...sj.*g.|
+000002f0  81 c6 da 9d 8b 65 98 f8  b8 e5 fb da 85 cc 68 c2  |.....e........h.|
+00000300  77 ed d5 14 a8 32 74 b1  d1 9c 89 1c 3e b8 d9 d4  |w....2t.....>...|
+00000310  89 8d d5 17 03 03 00 99  1c 42 3c cc 38 4d ed 1e  |.........B<.8M..|
+00000320  14 2e cb e7 a4 43 64 95  a5 8f c6 ff 81 a1 4f d8  |.....Cd.......O.|
+00000330  2a 1e 82 cf 4c 6a a2 32  ee 3b 8e f9 d5 63 99 2b  |*...Lj.2.;...c.+|
+00000340  7a 7e 4c 9b 1a c8 48 78  4f 8e ad af ea 3a 60 65  |z~L...HxO....:`e|
+00000350  b6 05 62 78 36 5f c1 40  e3 16 f2 be 48 41 ca a6  |..bx6_.@....HA..|
+00000360  e1 10 e4 fe 14 0b 59 6d  da fc 35 1e f5 eb fc 71  |......Ym..5....q|
+00000370  08 49 a4 04 55 df 5e 09  cc 48 79 ba 3b e6 12 20  |.I..U.^..Hy.;.. |
+00000380  4e 57 b3 22 a0 4f 62 b9  30 e3 1c 3e ed 95 6c c7  |NW.".Ob.0..>..l.|
+00000390  49 a3 b4 c5 2d 25 11 18  94 7b 10 43 d3 fe de 98  |I...-%...{.C....|
+000003a0  74 65 c1 cd d2 d1 67 a1  86 03 a4 7e 12 88 0e 6e  |te....g....~...n|
+000003b0  49 17 03 03 00 35 d3 c7  fa 89 82 0d 80 29 53 f8  |I....5.......)S.|
+000003c0  49 ba 86 1f aa dd ec d4  4c 8d cc a4 88 95 27 a8  |I.......L.....'.|
+000003d0  23 dc b2 09 e6 d3 47 34  fa e1 0c 5c 01 ae 95 a0  |#.....G4...\....|
+000003e0  4d 1c 42 fe e7 d6 ed cb  a7 83 fd                 |M.B........|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 a6 7f ef 71 68  |..........5...qh|
-00000010  8b 86 84 20 a6 e7 65 3f  3f f8 c6 8b 62 40 31 e2  |... ..e??...b@1.|
-00000020  1a ee 8d 0a 64 88 ea 4b  83 5f c5 ff 1b 9d aa 5f  |....d..K._....._|
-00000030  ce a4 31 76 06 90 da ad  b9 17 49 0b a6 b5 37 80  |..1v......I...7.|
-00000040  17 03 03 00 17 2b be e8  98 11 37 0d db 46 69 0d  |.....+....7..Fi.|
-00000050  51 34 ee 13 00 c3 f1 12  8a 13 21 b7 17 03 03 00  |Q4........!.....|
-00000060  13 8d ec 94 6f 55 b1 d5  c0 d6 a3 6e a2 8d 67 76  |....oU.....n..gv|
-00000070  7b c7 b8 1d                                       |{...|
+00000000  14 03 03 00 01 01 17 03  03 00 35 b4 e6 ba 4c 98  |..........5...L.|
+00000010  46 1c 04 eb 9a 06 4a ef  8c 2a 6e 9a 69 35 78 4c  |F.....J..*n.i5xL|
+00000020  9a 5e 43 93 11 d8 8d a5  c9 d0 1a db b6 ef 65 ec  |.^C...........e.|
+00000030  a9 21 e4 0f a6 3e 0a c1  a0 a1 49 35 c3 e7 d9 20  |.!...>....I5... |
+00000040  17 03 03 00 17 d7 8d d4  53 d5 40 dc ae d6 73 24  |........S.@...s$|
+00000050  f8 f5 65 4e 0f 8d a6 f0  9d 4a e1 5b 17 03 03 00  |..eN.....J.[....|
+00000060  13 fd e0 76 85 ee 46 e9  d4 3c 0d 05 56 9b b3 5b  |...v..F..<..V..[|
+00000070  9c 42 de d4                                       |.B..|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-HelloRetryRequest b/src/crypto/tls/testdata/Client-TLSv13-HelloRetryRequest
index a669920d93..2ef8e40657 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-HelloRetryRequest
+++ b/src/crypto/tls/testdata/Client-TLSv13-HelloRetryRequest
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 18 01 00 01  14 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,14 +7,16 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 0b 00 02  01 00 ff 01 00 01 00 00  |...{............|
+00000080  01 00 00 99 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 06 00 04 00 1d  00 17 00 0d 00 1a 00 18  |................|
 000000b0  08 04 04 03 08 07 08 05  08 06 04 01 05 01 06 01  |................|
-000000c0  05 03 06 03 02 01 02 03  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  05 03 06 03 02 01 02 03  00 32 00 1a 00 18 08 04  |.........2......|
+000000d0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
+000000e0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000f0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+00000100  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+00000110  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 58 02 00 00  54 03 03 cf 21 ad 74 e5  |....X...T...!.t.|
 00000010  9a 61 11 be 1d 8c 02 1e  65 b8 91 c2 a2 11 16 7a  |.a......e......z|
@@ -24,7 +26,7 @@
 00000050  0c 00 2b 00 02 03 04 00  33 00 02 00 17 14 03 03  |..+.....3.......|
 00000060  00 01 01                                          |...|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 16 03  03 01 1b 01 00 01 17 03  |................|
+00000000  14 03 03 00 01 01 16 03  03 01 39 01 00 01 35 03  |..........9...5.|
 00000010  03 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000030  00 20 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |. ..............|
@@ -32,88 +34,90 @@
 00000050  00 00 00 32 cc a9 cc a8  c0 2b c0 2f c0 2c c0 30  |...2.....+./.,.0|
 00000060  c0 09 c0 13 c0 0a c0 14  00 9c 00 9d 00 2f 00 35  |............./.5|
 00000070  c0 12 00 0a c0 23 c0 27  00 3c c0 07 c0 11 00 05  |.....#.'.<......|
-00000080  13 03 13 01 13 02 01 00  00 9c 00 0b 00 02 01 00  |................|
+00000080  13 03 13 01 13 02 01 00  00 ba 00 0b 00 02 01 00  |................|
 00000090  ff 01 00 01 00 00 17 00  00 00 12 00 00 00 05 00  |................|
 000000a0  05 01 00 00 00 00 00 0a  00 06 00 04 00 1d 00 17  |................|
 000000b0  00 0d 00 1a 00 18 08 04  04 03 08 07 08 05 08 06  |................|
-000000c0  04 01 05 01 06 01 05 03  06 03 02 01 02 03 00 2b  |...............+|
-000000d0  00 09 08 03 04 03 03 03  02 03 01 00 33 00 47 00  |............3.G.|
-000000e0  45 00 17 00 41 04 1e 18  37 ef 0d 19 51 88 35 75  |E...A...7...Q.5u|
-000000f0  71 b5 e5 54 5b 12 2e 8f  09 67 fd a7 24 20 3e b2  |q..T[....g..$ >.|
-00000100  56 1c ce 97 28 5e f8 2b  2d 4f 9e f1 07 9f 6c 4b  |V...(^.+-O....lK|
-00000110  5b 83 56 e2 32 42 e9 58  b6 d7 49 a6 b5 68 1a 41  |[.V.2B.X..I..h.A|
-00000120  03 56 6b dc 5a 89                                 |.Vk.Z.|
+000000c0  04 01 05 01 06 01 05 03  06 03 02 01 02 03 00 32  |...............2|
+000000d0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
+000000e0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
+000000f0  08 03 04 03 03 03 02 03  01 00 33 00 47 00 45 00  |..........3.G.E.|
+00000100  17 00 41 04 1e 18 37 ef  0d 19 51 88 35 75 71 b5  |..A...7...Q.5uq.|
+00000110  e5 54 5b 12 2e 8f 09 67  fd a7 24 20 3e b2 56 1c  |.T[....g..$ >.V.|
+00000120  ce 97 28 5e f8 2b 2d 4f  9e f1 07 9f 6c 4b 5b 83  |..(^.+-O....lK[.|
+00000130  56 e2 32 42 e9 58 b6 d7  49 a6 b5 68 1a 41 03 56  |V.2B.X..I..h.A.V|
+00000140  6b dc 5a 89                                       |k.Z.|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 9b 02 00 00  97 03 03 9a 1f 7a fa 06  |.............z..|
-00000010  c4 5f 92 61 62 d2 a5 f3  ae b9 a6 d8 6b eb 13 a7  |._.ab.......k...|
-00000020  2f 17 62 79 3a ca 42 8b  18 06 15 20 00 00 00 00  |/.by:.B.... ....|
+00000000  16 03 03 00 9b 02 00 00  97 03 03 fe 4a 7b 8f ac  |............J{..|
+00000010  ff 16 9d af dc a9 3a c4  e6 91 99 1f 20 62 3d 0b  |......:..... b=.|
+00000020  1f 75 28 88 56 eb 36 d1  84 e5 58 20 00 00 00 00  |.u(.V.6...X ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
 00000050  4f 00 2b 00 02 03 04 00  33 00 45 00 17 00 41 04  |O.+.....3.E...A.|
-00000060  d1 56 18 67 59 a5 e1 ed  99 0f ca e5 6b 5f e3 d9  |.V.gY.......k_..|
-00000070  e3 fd e6 a2 50 93 bf 87  85 60 e7 7f 0b a0 96 c4  |....P....`......|
-00000080  29 55 63 de fe 6b 75 99  b2 a6 75 92 61 d0 96 19  |)Uc..ku...u.a...|
-00000090  f5 60 8f ec e9 d3 98 4a  b9 6b 98 26 c1 3e 27 7e  |.`.....J.k.&.>'~|
-000000a0  17 03 03 00 17 5a aa bb  35 67 ec 83 da 8e 85 bd  |.....Z..5g......|
-000000b0  ae a5 0d c9 8b cd 03 bf  96 2b 35 61 17 03 03 02  |.........+5a....|
-000000c0  6d 85 0c 7c d5 ff 0f 77  0a a4 b7 97 aa d3 f7 af  |m..|...w........|
-000000d0  4b 58 cb 24 4d 9f a6 d8  e2 c3 10 ce 3a 5d e4 cc  |KX.$M.......:]..|
-000000e0  84 7d 1f 71 bd b6 25 0c  10 75 d3 8d b6 12 04 56  |.}.q..%..u.....V|
-000000f0  63 af 53 e5 cc 29 ce f7  18 7a 93 91 73 ae ff c1  |c.S..)...z..s...|
-00000100  2e 2b 3d 76 ab 99 c8 e0  fd 69 b3 67 39 e9 58 40  |.+=v.....i.g9.X@|
-00000110  4a 63 e8 71 c5 8d de 44  fb ef 4d 0a dc ae 51 12  |Jc.q...D..M...Q.|
-00000120  7e ea 6a 25 32 8e 5b 08  6e c7 b2 87 00 4e 35 d8  |~.j%2.[.n....N5.|
-00000130  cd 3b bd 8c dc e8 55 a9  2f 65 d1 7f c1 28 33 f9  |.;....U./e...(3.|
-00000140  70 e1 af d8 2d 64 4c ac  5a 3a 16 6d 3e 97 a7 0e  |p...-dL.Z:.m>...|
-00000150  cd 28 05 1c ea 28 8d 63  a3 41 e2 3a 24 27 f4 43  |.(...(.c.A.:$'.C|
-00000160  97 c8 89 09 ed 8b 96 74  b3 dc 98 f4 0c c2 6f 25  |.......t......o%|
-00000170  fc 30 8a f8 25 49 e1 91  fb c6 39 23 ca d5 16 08  |.0..%I....9#....|
-00000180  5f bf 10 88 71 a4 c5 ac  e7 ad 9e 5a 4d e8 d3 1f  |_...q......ZM...|
-00000190  f0 5d 83 9d c9 e2 b3 f8  e4 a3 a5 57 5d ca 30 74  |.].........W].0t|
-000001a0  a6 1b c7 51 50 05 5f 7e  93 71 1a 8d fc 04 d6 fe  |...QP._~.q......|
-000001b0  4e 4b 95 54 18 43 19 4d  d2 dc 81 a8 94 76 7e 23  |NK.T.C.M.....v~#|
-000001c0  56 8c 86 f9 15 d2 a8 0c  48 4e 0e 81 df e0 31 52  |V.......HN....1R|
-000001d0  c9 2e b4 39 f3 cf ae e2  29 72 01 ed 34 4f 09 ce  |...9....)r..4O..|
-000001e0  64 de a9 9b 84 61 3a bb  0b ac 4e b1 6d 37 41 10  |d....a:...N.m7A.|
-000001f0  5b cf 99 b1 3e e6 f5 7b  1c d4 d0 d5 34 fc ab c6  |[...>..{....4...|
-00000200  29 8e 0b 53 e4 7b 35 33  e4 e3 f6 77 9b f6 c6 ae  |)..S.{53...w....|
-00000210  73 3c c5 80 c8 72 f7 56  6c 4c ce e5 a7 05 63 ee  |s<...r.VlL....c.|
-00000220  07 e0 1d 3e 73 3e 55 73  ba 63 a8 d7 99 6a 48 57  |...>s>Us.c...jHW|
-00000230  0c 55 51 42 4b 27 91 4b  75 b3 3b 4c 29 f1 52 e8  |.UQBK'.Ku.;L).R.|
-00000240  85 f9 49 53 ed 87 6d 9e  8f 5c 29 7c 5c 9c 4e 9a  |..IS..m..\)|\.N.|
-00000250  90 a8 99 2a 53 65 f7 d9  61 ef 6a 56 2a da 76 ed  |...*Se..a.jV*.v.|
-00000260  04 84 11 f5 1c 40 82 52  7d fa 00 79 43 12 42 b4  |.....@.R}..yC.B.|
-00000270  ca 7a 86 d5 8d d6 c5 7b  04 13 79 08 72 0c ce d7  |.z.....{..y.r...|
-00000280  88 9a f2 2c b5 9a 18 a4  d2 87 48 ce ab 17 33 fd  |...,......H...3.|
-00000290  cf 22 3c 72 03 86 af 35  2a b3 fe 24 0e 86 d8 82  |."<r...5*..$....|
-000002a0  df 21 c6 8b ff f5 f1 0a  86 3b 28 a9 41 f6 32 df  |.!.......;(.A.2.|
-000002b0  a6 69 fa e3 38 b2 3e 1d  c3 82 8e 03 da 44 e9 2e  |.i..8.>......D..|
-000002c0  14 12 cd 16 e5 6a 58 1b  3f f8 70 d6 47 e6 1b 98  |.....jX.?.p.G...|
-000002d0  74 9c 21 2b 6d f8 8a 47  05 86 b1 fa 63 9d cc 19  |t.!+m..G....c...|
-000002e0  da 9a a0 ea 5a 26 98 e6  b7 d0 da 03 b3 1d 33 e8  |....Z&........3.|
-000002f0  55 74 ee 4b 6a 06 0f f1  45 35 72 81 bb c9 61 4e  |Ut.Kj...E5r...aN|
-00000300  60 d6 83 e6 ab 08 77 a4  f9 73 e5 d8 cb 66 9f 41  |`.....w..s...f.A|
-00000310  00 15 2c 09 0e ad 16 02  6c 06 5f bc bf 47 f1 5a  |..,.....l._..G.Z|
-00000320  85 97 ab 88 e8 45 b0 31  96 ad 56 00 97 59 17 03  |.....E.1..V..Y..|
-00000330  03 00 99 5e 77 80 46 1d  2f 47 9f b3 43 4d a6 2b  |...^w.F./G..CM.+|
-00000340  e9 f7 72 a2 d0 c6 69 7c  df 5d ce a0 3b 89 e2 69  |..r...i|.]..;..i|
-00000350  e7 35 5e 00 fb 87 10 4a  a8 41 02 b7 89 fa 88 fc  |.5^....J.A......|
-00000360  72 63 ce bf 41 61 16 91  55 06 cd b6 fa 78 09 bc  |rc..Aa..U....x..|
-00000370  f6 21 a0 c2 1f f3 fa 34  2a 9e b9 8a 0c 72 81 02  |.!.....4*....r..|
-00000380  66 a7 da 6b d6 e2 aa 99  6d 4b 42 f5 19 83 52 89  |f..k....mKB...R.|
-00000390  9a 26 56 5d d5 a4 a7 bd  ad b4 10 db ee 87 1d 15  |.&V]............|
-000003a0  15 df 30 95 d8 61 e2 c4  88 47 e1 91 e3 85 33 fe  |..0..a...G....3.|
-000003b0  7d 02 0c 22 6b 52 22 a7  cf bf bf f0 9d 25 65 e0  |}.."kR"......%e.|
-000003c0  6b da a2 8c 9a 00 3d 68  78 55 38 69 17 03 03 00  |k.....=hxU8i....|
-000003d0  35 c8 ca 51 96 aa c1 4b  a0 09 d3 bc d9 ea 35 db  |5..Q...K......5.|
-000003e0  f2 8d bb ab b3 23 09 a1  d1 9c 40 3e e4 84 d3 1c  |.....#....@>....|
-000003f0  60 64 5c ff 01 c7 78 69  c2 4a fb e1 c3 d6 f0 57  |`d\...xi.J.....W|
-00000400  fa 3a 5f 7a 8b 70                                 |.:_z.p|
+00000060  22 29 04 60 1f aa 8e 3f  bd 63 99 c0 66 e1 e1 d7  |").`...?.c..f...|
+00000070  c1 59 57 1d db 9d ba 28  a7 d4 fc fd bd 15 64 14  |.YW....(......d.|
+00000080  ec 78 e3 dc e1 c7 3e 07  c3 c5 c4 4e 43 51 10 e2  |.x....>....NCQ..|
+00000090  f0 ac 57 6b 56 4b b1 6a  46 e9 70 81 28 68 62 dc  |..WkVK.jF.p.(hb.|
+000000a0  17 03 03 00 17 2d a3 1d  ea 4e f0 8b 4b 19 3f 2d  |.....-...N..K.?-|
+000000b0  18 ef 9d b1 65 b4 e8 93  b2 80 fe 28 17 03 03 02  |....e......(....|
+000000c0  6d 3b 1b 01 88 15 65 6a  66 4a 91 e2 0a c2 c4 64  |m;....ejfJ.....d|
+000000d0  c1 f5 d0 c2 fd 1d 18 4a  e2 32 e2 d2 6f 25 04 78  |.......J.2..o%.x|
+000000e0  96 66 48 53 0b bc 24 0a  6c 46 54 28 bb 63 ed 4e  |.fHS..$.lFT(.c.N|
+000000f0  ab c3 15 bb ae 1e ea c9  63 2a f1 4b fc 55 60 b2  |........c*.K.U`.|
+00000100  8b 46 e3 09 f8 b4 72 87  3c ec 98 e2 21 53 c8 4d  |.F....r.<...!S.M|
+00000110  9b 07 4a 88 fc 0f c6 42  40 e5 74 5e 3e cf 88 3a  |..J....B@.t^>..:|
+00000120  f1 d9 ef 88 e8 eb 0a 4b  f4 64 12 d1 3f 36 25 f8  |.......K.d..?6%.|
+00000130  6d 91 49 a6 c1 ac 9e b7  e7 36 7f a0 0c af 11 48  |m.I......6.....H|
+00000140  83 e6 5c ee 23 d9 18 9a  0b 73 76 8f 0e f0 2c 4d  |..\.#....sv...,M|
+00000150  a8 07 15 da 33 b8 57 de  c4 a2 c2 97 ae d2 0b a0  |....3.W.........|
+00000160  96 da 1c c5 d6 6d 7f 66  c9 a6 ee ab 91 53 fc d4  |.....m.f.....S..|
+00000170  c1 e9 1b 7e e8 be 3e 44  65 8d 91 de 49 86 1c de  |...~..>De...I...|
+00000180  55 a1 42 5c 4c b5 24 30  67 23 d8 fe ad 54 6f e5  |U.B\L.$0g#...To.|
+00000190  e9 ae 78 46 4a f7 cc ed  d0 8d d3 65 95 76 ac fb  |..xFJ......e.v..|
+000001a0  f1 91 d2 90 35 17 5e c4  72 6c 16 2a 52 08 7b 16  |....5.^.rl.*R.{.|
+000001b0  10 e4 c4 08 28 86 f7 dd  17 50 6c d0 ea 06 f3 8a  |....(....Pl.....|
+000001c0  b9 c7 0e fd 67 9d 14 75  13 5b 85 a2 8e 1f 7a be  |....g..u.[....z.|
+000001d0  17 17 ad 72 a1 40 9d 02  5e 80 16 df e7 30 8a eb  |...r.@..^....0..|
+000001e0  2d 62 f5 63 e6 c2 96 f3  1c 19 c4 bf 14 50 73 b6  |-b.c.........Ps.|
+000001f0  6d 02 0e 7f 70 8f 6f f8  3d 6c 36 60 b5 41 3f 09  |m...p.o.=l6`.A?.|
+00000200  f9 72 26 59 fc d3 b2 70  84 2c 9b 7d 7b ab 14 a1  |.r&Y...p.,.}{...|
+00000210  43 65 89 51 75 9e 3b 4c  8c 01 8d a9 38 0a e3 fe  |Ce.Qu.;L....8...|
+00000220  0f f1 58 c5 9e b2 42 28  1e 7c 4a e0 6f fe 53 69  |..X...B(.|J.o.Si|
+00000230  e0 bc 8c c2 d5 00 c4 00  c6 f6 47 fe 70 cc a5 c0  |..........G.p...|
+00000240  cb 21 d8 89 37 8a ef bc  c6 9b 9d 5d 74 a7 22 6b  |.!..7......]t."k|
+00000250  5c e0 24 89 8d 88 a1 19  8a bf e6 bb d3 43 e3 71  |\.$..........C.q|
+00000260  38 99 60 20 2c d5 6e 93  83 20 be 0f ce 35 3d 02  |8.` ,.n.. ...5=.|
+00000270  2f 39 5e bb 06 68 b2 c7  fc 42 be a7 81 f5 40 dd  |/9^..h...B....@.|
+00000280  49 6f 4b 1b 3f a9 6c 5b  dd b9 38 29 01 be f7 76  |IoK.?.l[..8)...v|
+00000290  cc 7b 8e 34 25 72 64 2a  4b bc 38 f7 07 4e cd 16  |.{.4%rd*K.8..N..|
+000002a0  0b 9a 1f c5 5f 3e 5d 6e  fe 2c d6 fd 7c cc af 97  |...._>]n.,..|...|
+000002b0  89 04 75 20 83 c8 a9 4a  d8 65 08 a0 4f 6a f7 71  |..u ...J.e..Oj.q|
+000002c0  4a f0 34 b9 49 29 f1 44  d7 95 86 c1 cf fd 3a 46  |J.4.I).D......:F|
+000002d0  fb 0a 7a 13 ee ca 0d ce  bd 1e 62 63 cd 63 7a 75  |..z.......bc.czu|
+000002e0  26 a6 0c 6e d6 77 06 df  f7 1b e1 6c 96 e8 55 20  |&..n.w.....l..U |
+000002f0  62 f0 98 2d 22 28 3b 95  9b ec dc d7 cb 6c 1d b5  |b..-"(;......l..|
+00000300  3a de fd 2d a7 23 59 4b  69 85 20 13 8c e0 a4 b5  |:..-.#YKi. .....|
+00000310  c1 e0 72 08 e7 c2 c9 c6  c2 5c 23 e7 d3 15 dd de  |..r......\#.....|
+00000320  6a 9b d2 0c 47 4d d1 e7  d8 a9 4d 5f 60 03 17 03  |j...GM....M_`...|
+00000330  03 00 99 e8 da 65 12 48  68 fa d8 9c ee bf c8 3d  |.....e.Hh......=|
+00000340  a4 5d e1 bc 8a e3 18 46  a8 89 c9 7b 3e a2 b0 fb  |.].....F...{>...|
+00000350  1c 7e 64 69 4a 06 aa 0a  ce 79 b6 e0 8b 57 a7 7b  |.~diJ....y...W.{|
+00000360  7f b7 80 3f cf 1b f2 00  2f 22 63 00 97 60 e8 bf  |...?..../"c..`..|
+00000370  16 c1 37 fd e0 40 96 24  e1 48 c8 c5 7d a4 50 ed  |..7..@.$.H..}.P.|
+00000380  04 c4 17 88 84 e6 d3 8c  b9 8b bf 81 f8 3b 19 32  |.............;.2|
+00000390  27 d2 f6 41 2f d1 fb f3  49 79 c9 99 6d db c8 25  |'..A/...Iy..m..%|
+000003a0  36 fa 72 d1 c3 2c 1f 01  90 e0 a4 45 2b 3f 24 59  |6.r..,.....E+?$Y|
+000003b0  4c 87 04 af 4c 8b 48 04  b3 f6 e5 19 ab cd 57 f1  |L...L.H.......W.|
+000003c0  1c 4f a8 ec 48 23 20 65  df 7b cc 01 17 03 03 00  |.O..H# e.{......|
+000003d0  35 64 87 14 09 0b dd 3e  b1 58 d7 b5 46 e7 e3 c4  |5d.....>.X..F...|
+000003e0  76 fa 86 c4 6d 53 97 fd  4f c8 29 77 a7 f8 4f 70  |v...mS..O.)w..Op|
+000003f0  0d 91 e9 ba 06 a7 83 df  fb 6f 8e c9 fb fb 8f 88  |.........o......|
+00000400  1d 2b f9 ce cc 5c                                 |.+...\|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 35 24 4a 53  55 49 92 7a 21 a2 db 69  |....5$JSUI.z!..i|
-00000010  e5 2b 00 29 83 cb 91 32  17 48 73 96 89 d1 b2 11  |.+.)...2.Hs.....|
-00000020  c4 23 48 41 eb df eb 5a  10 c2 78 4e a2 e4 f0 38  |.#HA...Z..xN...8|
-00000030  4a 1c b6 d3 bb 52 bc 7e  f6 94 17 03 03 00 17 74  |J....R.~.......t|
-00000040  04 34 8d 27 19 da f3 d8  14 30 1b 85 ad 1e 99 cd  |.4.'.....0......|
-00000050  06 f0 a3 50 94 48 17 03  03 00 13 ac 8f 7e 2e 9c  |...P.H.......~..|
-00000060  90 96 db 33 e2 e9 94 c1  c9 95 f2 7a d1 8f        |...3.......z..|
+00000000  17 03 03 00 35 44 f5 f8  bb f8 ef a5 7e c7 6f 34  |....5D......~.o4|
+00000010  88 d9 96 2e 59 11 6e 08  0d 17 20 fb 45 c6 86 7c  |....Y.n... .E..||
+00000020  d3 ac 29 0f 50 89 d3 e9  b8 eb 42 63 bc 18 49 99  |..).P.....Bc..I.|
+00000030  75 d5 08 2a 72 57 ea a2  a2 21 17 03 03 00 17 38  |u..*rW...!.....8|
+00000040  12 6b 56 f1 33 2a 3d 42  94 42 85 e5 3b 49 10 52  |.kV.3*=B.B..;I.R|
+00000050  13 82 59 6d 28 fa 17 03  03 00 13 ab 4c ec 58 94  |..Ym(.......L.X.|
+00000060  13 b6 f6 91 ce b5 91 f7  34 7f c5 98 38 f2        |........4...8.|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-KeyUpdate b/src/crypto/tls/testdata/Client-TLSv13-KeyUpdate
index 1b8004ad0a..18d547b9ae 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-KeyUpdate
+++ b/src/crypto/tls/testdata/Client-TLSv13-KeyUpdate
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 1c 01 00 01  18 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,97 +7,99 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7f 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 9d 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 0a 00 08 00 1d  00 17 00 18 00 19 00 0d  |................|
 000000b0  00 1a 00 18 08 04 04 03  08 07 08 05 08 06 04 01  |................|
-000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 2b 00 09  |.............+..|
-000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000100  cb 3b 74                                          |.;t|
+000000c0  05 01 06 01 05 03 06 03  02 01 02 03 00 32 00 1a  |.............2..|
+000000d0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
+000000e0  06 01 05 03 06 03 02 01  02 03 00 2b 00 09 08 03  |...........+....|
+000000f0  04 03 03 03 02 03 01 00  33 00 26 00 24 00 1d 00  |........3.&.$...|
+00000100  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
+00000110  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
+00000120  74                                                |t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 dc 81 c4 82 2e  |....z...v.......|
-00000010  a2 4f c4 c2 53 c2 bc 6a  bd f3 46 84 b5 ba 66 b5  |.O..S..j..F...f.|
-00000020  8b 67 7c 90 51 40 12 39  18 e1 bf 20 00 00 00 00  |.g|.Q@.9... ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 84 8c be 3d 27  |....z...v.....='|
+00000010  0b ef 9d b0 8b bd 21 91  9d 12 b8 4c f2 0f bb 29  |......!....L...)|
+00000020  6a f4 1c 56 09 bb 85 c6  9b b7 7b 20 00 00 00 00  |j..V......{ ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 3b  |..+.....3.$... ;|
-00000060  6b 2a e6 c2 7e b6 59 68  e4 e3 f2 f3 14 e5 72 bc  |k*..~.Yh......r.|
-00000070  c9 61 b4 b0 0a c6 41 0d  a9 8e d9 9b 7d 2a 11 14  |.a....A.....}*..|
-00000080  03 03 00 01 01 17 03 03  00 17 43 af 38 b9 56 06  |..........C.8.V.|
-00000090  2d 10 e3 e5 1d 1b 1e a9  5f 90 ca 0d a9 52 33 86  |-......._....R3.|
-000000a0  85 17 03 03 02 6d ac 6a  a1 8f 42 27 74 80 25 f9  |.....m.j..B't.%.|
-000000b0  1f 48 49 2d c2 33 38 e7  93 7e b0 b2 50 b8 6a ea  |.HI-.38..~..P.j.|
-000000c0  a6 81 ef 9b 55 83 4e 93  df 92 97 6f 00 f5 c4 fc  |....U.N....o....|
-000000d0  ec b1 19 dd 68 b5 bd c4  bb ba 63 9a e4 c9 24 af  |....h.....c...$.|
-000000e0  88 13 65 11 bf ea d9 07  e9 46 fd 5b 60 ce 57 46  |..e......F.[`.WF|
-000000f0  8b a9 bd c6 58 1a 3b bd  5e fb 0f 46 ec fc 8b 2c  |....X.;.^..F...,|
-00000100  ea a7 19 06 6a e5 6f 10  7a 27 04 6b aa a4 2c f4  |....j.o.z'.k..,.|
-00000110  ef 3b e8 8a 51 88 fd e0  ae 33 b1 4c b3 04 5e 91  |.;..Q....3.L..^.|
-00000120  b0 98 0b 9f 38 a3 3c fb  9f d5 d2 36 e4 09 19 18  |....8.<....6....|
-00000130  a5 b3 12 aa c9 03 ac b5  ab bb f1 7a 02 d2 dd 75  |...........z...u|
-00000140  0e cb 60 09 39 23 c3 b2  c1 8e e0 18 57 72 54 61  |..`.9#......WrTa|
-00000150  4c 99 35 1d ba 31 01 0c  48 d2 f2 88 22 9c 91 7d  |L.5..1..H..."..}|
-00000160  e3 74 f9 b3 52 bf 0e 0b  e1 31 7c 2c cb fd f2 8c  |.t..R....1|,....|
-00000170  bf 27 40 6d 26 b7 62 47  56 91 22 00 67 9a df 4f  |.'@m&.bGV.".g..O|
-00000180  f0 47 57 3c a6 46 4d 16  f6 8d fc 2d 91 c4 1a bf  |.GW<.FM....-....|
-00000190  38 63 ec 63 fe 97 14 80  aa 5b 60 ff c8 77 57 9c  |8c.c.....[`..wW.|
-000001a0  d5 86 a6 76 96 b3 e9 db  c9 eb dd 94 84 2a 46 f5  |...v.........*F.|
-000001b0  6a c1 10 66 59 f1 13 b9  41 f3 89 26 ba 52 69 95  |j..fY...A..&.Ri.|
-000001c0  b1 f3 66 30 f8 aa 90 f7  90 49 19 48 4c 25 4a 1f  |..f0.....I.HL%J.|
-000001d0  12 9d 67 32 79 bb 53 d8  c5 d1 b4 6e 89 75 49 c0  |..g2y.S....n.uI.|
-000001e0  65 86 ac 72 23 2f 97 d3  ae e2 64 79 5e e2 10 4e  |e..r#/....dy^..N|
-000001f0  55 0c c6 70 d3 2e 4a 6c  b0 73 0a 11 eb ae f7 a1  |U..p..Jl.s......|
-00000200  a1 f0 5f 67 45 46 d3 8c  11 ff 21 62 7d ed f9 0e  |.._gEF....!b}...|
-00000210  2a ba b3 82 f5 6b c1 4a  4e cc 11 90 48 81 96 7a  |*....k.JN...H..z|
-00000220  df f9 22 ae 53 31 14 9d  c9 5c 85 e7 db a2 dd 02  |..".S1...\......|
-00000230  56 eb d0 fe 20 35 21 c9  33 63 b5 b7 a8 93 30 7f  |V... 5!.3c....0.|
-00000240  86 1f d1 af b1 ff 3e 9a  d1 a8 90 d9 9c 86 55 e8  |......>.......U.|
-00000250  d0 4c c4 6d a3 ce c6 c0  df f8 a8 b6 43 03 ae fc  |.L.m........C...|
-00000260  7d 94 7b fe be 85 46 d8  42 9d b6 15 b9 a3 27 3d  |}.{...F.B.....'=|
-00000270  80 64 54 c8 53 c4 a7 94  52 8f 9d 4c 58 54 a5 c4  |.dT.S...R..LXT..|
-00000280  e0 e7 2e cb f3 8c d0 82  3f 95 76 c9 ea ea 80 41  |........?.v....A|
-00000290  21 5d 3e a3 1e be 4e 0b  ce 10 ab 61 a5 76 ef 62  |!]>...N....a.v.b|
-000002a0  50 1b 52 a8 75 23 fd eb  ea 76 f9 d8 41 3c a2 e4  |P.R.u#...v..A<..|
-000002b0  21 cb 56 f7 40 81 78 56  22 06 2a 38 fc 1f d8 9f  |!.V.@.xV".*8....|
-000002c0  38 b0 7a 93 f0 8c ad 3e  54 27 a2 d7 8b 2c 79 46  |8.z....>T'...,yF|
-000002d0  15 65 f1 55 b2 2a 06 a1  97 9b 47 23 f8 9a 3f 88  |.e.U.*....G#..?.|
-000002e0  8e 26 7e 13 cd 6e 8b cb  d5 a5 78 48 f7 ba ad d8  |.&~..n....xH....|
-000002f0  08 3b 34 5b 52 cd e3 2d  12 ac 81 00 c0 d0 4d df  |.;4[R..-......M.|
-00000300  56 d6 40 86 91 31 3d ba  6b 41 bc 51 6f ac b2 df  |V.@..1=.kA.Qo...|
-00000310  90 4b 78 17 03 03 00 99  21 0f 5b 18 54 84 98 0c  |.Kx.....!.[.T...|
-00000320  3a 7b 0b db 99 0e 09 f6  b7 4f a9 cc da bf 4c ac  |:{.......O....L.|
-00000330  5f 44 fc ba 9d 5d 52 d5  ec 2e 08 0c cc 3c e1 72  |_D...]R......<.r|
-00000340  10 77 5b 7b 55 f7 c1 44  a3 25 e0 48 20 9a 3a de  |.w[{U..D.%.H .:.|
-00000350  2f ae 30 a9 e9 5b 75 84  e3 59 f0 6b 23 a6 d8 20  |/.0..[u..Y.k#.. |
-00000360  16 51 2a 19 61 60 35 28  74 41 32 fa 97 8d 3b ed  |.Q*.a`5(tA2...;.|
-00000370  ff 64 94 d7 27 4c 9b 1e  5e b8 89 43 e3 ae 2a b6  |.d..'L..^..C..*.|
-00000380  60 a8 bb f0 d1 75 85 15  bb 95 3c 82 f1 62 da b1  |`....u....<..b..|
-00000390  25 d2 58 7d 67 7f 02 5b  b4 91 68 3c 70 10 09 94  |%.X}g..[..h<p...|
-000003a0  b0 6d ca d9 39 bf 4a 16  5e 44 e8 92 a9 f5 af 81  |.m..9.J.^D......|
-000003b0  08 17 03 03 00 35 46 1a  28 22 ca 25 09 12 b5 e6  |.....5F.(".%....|
-000003c0  7e 70 f1 0a 0d 9b 7d f2  59 98 41 d5 9d fd be 8e  |~p....}.Y.A.....|
-000003d0  ff b2 89 e7 1a 3c 9a b7  50 01 ce af 22 4a 4b ce  |.....<..P..."JK.|
-000003e0  51 63 56 c3 93 28 29 fb  b2 67 1d                 |QcV..()..g.|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 32  |..+.....3.$... 2|
+00000060  ef 3c 13 61 12 2a 28 1c  73 77 7e 6f 7a 43 38 d3  |.<.a.*(.sw~ozC8.|
+00000070  6f f1 a6 87 34 92 b5 ad  55 7a a0 db 1c 5b 1e 14  |o...4...Uz...[..|
+00000080  03 03 00 01 01 17 03 03  00 17 18 cf a9 9c 7d 12  |..............}.|
+00000090  7e f7 a7 44 09 34 a6 40  22 8b 73 f8 87 69 35 ba  |~..D.4.@".s..i5.|
+000000a0  5a 17 03 03 02 6d 49 c5  1d 7e 9c f9 d7 5d 9f 3f  |Z....mI..~...].?|
+000000b0  41 5d a7 14 68 12 0b 3f  00 38 25 30 d9 9f 84 09  |A]..h..?.8%0....|
+000000c0  dd c9 9c 76 8a 73 40 5f  63 83 a9 4a b6 f1 4c 36  |...v.s@_c..J..L6|
+000000d0  74 13 bc 4b a6 47 9d 5b  50 3a 56 c7 6e 65 46 5d  |t..K.G.[P:V.neF]|
+000000e0  6a 1a 33 1d 9a 67 76 a2  7d 98 05 f3 3b 8b 62 3e  |j.3..gv.}...;.b>|
+000000f0  b0 72 f8 16 18 eb 47 ca  fe bc 83 ca 0a b6 df 6f  |.r....G........o|
+00000100  1c dd 95 6e 27 60 a3 88  40 0f a0 3f 6e f8 a8 9c  |...n'`..@..?n...|
+00000110  20 ee 43 60 66 e7 97 8c  c2 03 a8 e6 3d 87 6f cd  | .C`f.......=.o.|
+00000120  e9 3a 69 de 10 1f 49 ea  9d 9b 4d c9 e9 58 55 b2  |.:i...I...M..XU.|
+00000130  44 b7 09 f2 29 65 d1 fa  c1 00 b8 c0 0c 4d a1 89  |D...)e.......M..|
+00000140  1c 03 c5 0a 20 d9 88 b2  8e c6 b6 19 e1 a4 10 92  |.... ...........|
+00000150  2b 86 20 f8 0e 7c ed a5  37 03 9e 36 7a bd 0b de  |+. ..|..7..6z...|
+00000160  13 ef 6e e8 6d 1c 94 4d  6a 3f 17 db c8 44 84 47  |..n.m..Mj?...D.G|
+00000170  8b 23 d1 64 c8 90 7a da  ac 11 a0 51 c0 f2 76 10  |.#.d..z....Q..v.|
+00000180  57 1e bd a5 37 25 a9 a0  1d 3f cf 71 b1 d4 80 ed  |W...7%...?.q....|
+00000190  b9 eb 28 ec df 36 c4 f0  d1 2b fa 5b 13 fd b4 1a  |..(..6...+.[....|
+000001a0  82 3a e2 53 53 90 9a 42  0f 4b 3f 62 0e d5 e3 ab  |.:.SS..B.K?b....|
+000001b0  c2 93 b6 ab e2 db f5 43  fd f3 70 6d 44 68 c4 56  |.......C..pmDh.V|
+000001c0  4c 37 5a 9e 50 06 94 b6  d8 e1 f7 0c 97 f9 0f d1  |L7Z.P...........|
+000001d0  4f 5a 47 b4 1c 0a 1b 0a  ff bc 5d 08 7d ef b7 e6  |OZG.......].}...|
+000001e0  72 35 40 12 02 cc ed 48  19 ff e6 c8 e2 90 30 42  |r5@....H......0B|
+000001f0  04 bc 3a d0 a1 27 c6 c2  c8 b1 ab 48 a8 ff b2 c4  |..:..'.....H....|
+00000200  2e 1b 3b 9d 14 01 01 2e  53 1d 0c f7 6a 8d 49 64  |..;.....S...j.Id|
+00000210  5a bf 6e de 66 91 a8 97  2a 9f 2f 36 01 2e 33 2d  |Z.n.f...*./6..3-|
+00000220  de 5e a8 ba a1 66 fa 8a  18 c3 6e 33 a2 ab 3e 02  |.^...f....n3..>.|
+00000230  8b 25 21 dd 8b 9f de 4e  91 c9 14 dd 92 f0 4d b2  |.%!....N......M.|
+00000240  15 bf 44 89 8d 00 67 5e  01 c8 6d e7 44 3f 2b c6  |..D...g^..m.D?+.|
+00000250  cf 7a c1 4d fc b3 c1 81  f3 07 eb 6c 64 14 19 f1  |.z.M.......ld...|
+00000260  94 86 c0 c6 ea 95 35 c2  52 0e 67 37 74 df 27 c7  |......5.R.g7t.'.|
+00000270  76 1c 8e 2c 36 7d ef 71  c3 61 dd cb 8e 82 7b a1  |v..,6}.q.a....{.|
+00000280  78 c8 88 3c 90 31 17 7c  d6 f5 7c ed 67 64 ed 16  |x..<.1.|..|.gd..|
+00000290  bf 59 78 ee ee 6c 3e 3c  bd ba 29 21 23 15 50 68  |.Yx..l><..)!#.Ph|
+000002a0  40 23 ea b7 0f 03 9d 84  52 23 57 c1 dd 03 26 55  |@#......R#W...&U|
+000002b0  01 3d 46 ff 15 d0 08 fb  e1 a5 90 ac c2 e8 c8 18  |.=F.............|
+000002c0  96 e4 79 9a 0f 09 25 71  9a a0 fa 43 08 9a ca a4  |..y...%q...C....|
+000002d0  f8 8d cd f9 4f d4 d3 50  4e d2 5e 41 3a e0 e7 2e  |....O..PN.^A:...|
+000002e0  60 c6 70 8e 10 20 68 a3  8f ac 68 22 14 a2 54 5c  |`.p.. h...h"..T\|
+000002f0  ee 37 94 68 ff 93 cb 21  6b 2d 61 a3 ba 95 08 15  |.7.h...!k-a.....|
+00000300  cc 2d f1 be 22 3d 7b 02  63 01 c2 9a 88 37 aa 76  |.-.."={.c....7.v|
+00000310  2c 98 d1 17 03 03 00 99  21 4e 58 2e 4f 2b 3c c6  |,.......!NX.O+<.|
+00000320  2e ad 3b 8b d2 bf 54 81  ca 81 c6 7d 8c 40 62 cd  |..;...T....}.@b.|
+00000330  6a 42 6b 4a 81 b9 81 ce  dc c2 e8 3e 63 79 c8 2c  |jBkJ.......>cy.,|
+00000340  2c 8c 06 eb 70 2c 04 e1  62 6a 56 6e 72 c4 c8 69  |,...p,..bjVnr..i|
+00000350  39 39 c3 c2 94 3c bd 6f  cf 47 50 bb 8f d7 8e ac  |99...<.o.GP.....|
+00000360  68 4b 0b 06 e9 6a 44 68  fa 0e 0e 42 82 37 2a 1f  |hK...jDh...B.7*.|
+00000370  7d 0a 29 0a 18 f4 4f 5b  39 7f 40 9d 63 fe 20 b8  |}.)...O[9.@.c. .|
+00000380  6e 4a 64 9d 5f 18 68 16  6e 26 e1 5c 42 c8 0b 74  |nJd._.h.n&.\B..t|
+00000390  43 66 5a 9f 1e 32 2d bd  f3 2f 45 86 c4 e3 d2 c3  |CfZ..2-../E.....|
+000003a0  85 2e 7e ad 29 26 f8 f5  de f6 5c b2 c2 3f d1 61  |..~.)&....\..?.a|
+000003b0  6a 17 03 03 00 35 59 e1  a3 78 46 e2 7f db 1e a6  |j....5Y..xF.....|
+000003c0  28 ea 50 8a f5 33 1d eb  49 ef b3 34 ea 6a f8 76  |(.P..3..I..4.j.v|
+000003d0  69 70 ac d1 49 77 79 19  2c 2d 7c 95 9c e0 b7 c0  |ip..Iwy.,-|.....|
+000003e0  d2 6c d6 dd 3d ee 5a 89  0c 7b 66                 |.l..=.Z..{f|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 c9 09 ac f5 44  |..........5....D|
-00000010  40 83 88 5a b9 46 70 b9  ff 9b 2e bb b4 7e 72 b0  |@..Z.Fp......~r.|
-00000020  85 26 d6 37 33 ec d1 ac  ce f4 db 72 8c e1 07 b5  |.&.73......r....|
-00000030  d0 ce ee 2f 19 77 62 ec  97 ae 1b e1 5f 85 bf c4  |.../.wb....._...|
-00000040  17 03 03 00 17 1c ae 0f  1d 50 be 4b d0 64 4f 23  |.........P.K.dO#|
-00000050  41 60 d9 c7 f5 60 a6 5c  38 14 fd d5              |A`...`.\8...|
+00000000  14 03 03 00 01 01 17 03  03 00 35 38 8f 9d c3 39  |..........58...9|
+00000010  03 62 38 be b8 03 22 be  53 0a 0e ff 33 82 29 2a  |.b8...".S...3.)*|
+00000020  3e a5 4b d0 0e fe 6b c8  bc d8 07 71 77 ca 0f aa  |>.K...k....qw...|
+00000030  a9 8f 3e 6e 69 5d fc 37  0c 5a f6 1d 8b fc 46 8d  |..>ni].7.Z....F.|
+00000040  17 03 03 00 17 ac 0d 5d  2a 0b dd 2e 62 ab ac cc  |.......]*...b...|
+00000050  d6 43 d4 76 ea 52 62 7f  5b 10 93 63              |.C.v.Rb.[..c|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 16 ad 61 13  66 9c 3c dd 88 42 2c 6c  |......a.f.<..B,l|
-00000010  d1 22 5d b4 b2 6f f0 68  4f 37 4d                 |."]..o.hO7M|
+00000000  17 03 03 00 16 e0 09 97  59 52 91 65 5a cd 3b d5  |........YR.eZ.;.|
+00000010  95 c6 be 7a c7 a8 48 a6  39 73 44                 |...z..H.9sD|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 e5 b5 ff  ad d4 f5 e5 55 04 83 a7  |............U...|
-00000010  59 43 9a 3e 68 4d 38 6f  b1 1c 30                 |YC.>hM8o..0|
+00000000  17 03 03 00 16 12 d4 4b  bd d2 98 10 6a 72 29 bc  |.......K....jr).|
+00000010  6d c1 23 38 88 c3 7b d8  32 b6 7f                 |m.#8..{.2..|
 >>> Flow 6 (server to client)
-00000000  17 03 03 00 1a 64 0c f4  8e 8f 2b 04 e2 36 28 77  |.....d....+..6(w|
-00000010  a2 28 97 4b 15 ba 1b b2  10 31 b3 4d 87 09 af     |.(.K.....1.M...|
+00000000  17 03 03 00 1a 0c 7b fb  83 bb 87 60 52 4d fb b8  |......{....`RM..|
+00000010  c8 cf 95 98 80 60 87 f4  04 ee d1 0a 5d 57 51     |.....`......]WQ|
 >>> Flow 7 (client to server)
-00000000  17 03 03 00 1d 90 c9 33  bf fc 76 12 3d af 9e c8  |.......3..v.=...|
-00000010  8c ca e7 a1 63 6e 80 91  b1 7f 5e e4 dc c2 e6 1c  |....cn....^.....|
-00000020  b6 2b 17 03 03 00 13 ef  a8 30 91 b1 20 fe 82 79  |.+.......0.. ..y|
-00000030  44 31 a8 af 99 bb 5e 97  75 a3                    |D1....^.u.|
+00000000  17 03 03 00 1d b1 21 2b  13 dc 27 c2 50 07 61 8d  |......!+..'.P.a.|
+00000010  63 fa c3 1f 1b ab 19 77  a0 8b 97 5f 03 26 80 54  |c......w..._.&.T|
+00000020  04 00 17 03 03 00 13 91  28 90 11 9b f8 75 52 b8  |........(....uR.|
+00000030  de 14 32 09 9d 2b 77 bb  3c 5a                    |..2..+w.<Z|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-P256-ECDHE b/src/crypto/tls/testdata/Client-TLSv13-P256-ECDHE
index fa8d312384..5add59dadb 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-P256-ECDHE
+++ b/src/crypto/tls/testdata/Client-TLSv13-P256-ECDHE
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 19 01 00 01  15 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 37 01 00 01  33 03 03 00 00 00 00 00  |....7...3.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,88 +7,90 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 9a 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
+00000080  01 00 00 b8 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 04 00 02 00 17  00 0d 00 1a 00 18 08 04  |................|
 000000b0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
-000000c0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
-000000d0  02 03 01 00 33 00 47 00  45 00 17 00 41 04 1e 18  |....3.G.E...A...|
-000000e0  37 ef 0d 19 51 88 35 75  71 b5 e5 54 5b 12 2e 8f  |7...Q.5uq..T[...|
-000000f0  09 67 fd a7 24 20 3e b2  56 1c ce 97 28 5e f8 2b  |.g..$ >.V...(^.+|
-00000100  2d 4f 9e f1 07 9f 6c 4b  5b 83 56 e2 32 42 e9 58  |-O....lK[.V.2B.X|
-00000110  b6 d7 49 a6 b5 68 1a 41  03 56 6b dc 5a 89        |..I..h.A.Vk.Z.|
+000000c0  06 03 02 01 02 03 00 32  00 1a 00 18 08 04 04 03  |.......2........|
+000000d0  08 07 08 05 08 06 04 01  05 01 06 01 05 03 06 03  |................|
+000000e0  02 01 02 03 00 2b 00 09  08 03 04 03 03 03 02 03  |.....+..........|
+000000f0  01 00 33 00 47 00 45 00  17 00 41 04 1e 18 37 ef  |..3.G.E...A...7.|
+00000100  0d 19 51 88 35 75 71 b5  e5 54 5b 12 2e 8f 09 67  |..Q.5uq..T[....g|
+00000110  fd a7 24 20 3e b2 56 1c  ce 97 28 5e f8 2b 2d 4f  |..$ >.V...(^.+-O|
+00000120  9e f1 07 9f 6c 4b 5b 83  56 e2 32 42 e9 58 b6 d7  |....lK[.V.2B.X..|
+00000130  49 a6 b5 68 1a 41 03 56  6b dc 5a 89              |I..h.A.Vk.Z.|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 9b 02 00 00  97 03 03 1c 1a ee 30 2f  |..............0/|
-00000010  02 10 0c 84 ee 6a 2c d1  67 76 00 8a 16 e5 15 c5  |.....j,.gv......|
-00000020  4c d7 a9 26 33 43 9a 9a  d6 f8 e7 20 00 00 00 00  |L..&3C..... ....|
+00000000  16 03 03 00 9b 02 00 00  97 03 03 b4 cc 04 30 25  |..............0%|
+00000010  f5 36 2e 22 d7 f5 f2 46  5b 01 09 94 ec 5e 48 df  |.6."...F[....^H.|
+00000020  60 d5 70 b6 db 62 00 36  dc 66 cb 20 00 00 00 00  |`.p..b.6.f. ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
 00000050  4f 00 2b 00 02 03 04 00  33 00 45 00 17 00 41 04  |O.+.....3.E...A.|
-00000060  f0 2e aa 75 ea 32 f4 3c  ea b7 61 13 0f 22 8d 39  |...u.2.<..a..".9|
-00000070  9e 0a 53 c8 d6 92 ea 5e  87 5b 46 d3 71 2d d1 df  |..S....^.[F.q-..|
-00000080  fa 1e 9a 6a 0e b2 bc d7  91 6e 26 56 17 24 11 d8  |...j.....n&V.$..|
-00000090  0f be c0 1d f5 fd c7 9d  2d 3c a0 0f ee 03 70 1f  |........-<....p.|
-000000a0  14 03 03 00 01 01 17 03  03 00 17 8e 76 66 0d 44  |............vf.D|
-000000b0  aa a2 d9 80 84 7c 6d 42  f0 ee 9f a3 6c b8 83 21  |.....|mB....l..!|
-000000c0  5d 7b 17 03 03 02 6d 18  d3 53 cc 09 6a 23 fc c5  |]{....m..S..j#..|
-000000d0  a9 2e 73 b4 3d ea 54 56  42 f5 1f 71 3e 8f 8e 7b  |..s.=.TVB..q>..{|
-000000e0  12 18 d7 d6 ab ed 24 5f  16 c8 18 5e e0 28 84 40  |......$_...^.(.@|
-000000f0  89 49 a7 91 57 d6 2b a0  9c ab 5d 85 ac 4f 6b 70  |.I..W.+...]..Okp|
-00000100  c3 31 e0 57 87 d7 7c 45  27 34 54 eb 85 02 14 2c  |.1.W..|E'4T....,|
-00000110  a0 53 4f ec 21 9f 04 91  38 b8 df 2c 5d 0b 79 0a  |.SO.!...8..,].y.|
-00000120  4f 96 79 15 72 de b5 fb  43 1f d8 71 62 d8 e0 69  |O.y.r...C..qb..i|
-00000130  21 13 87 ab e5 b8 e5 86  01 74 25 b7 39 fc 86 e2  |!........t%.9...|
-00000140  2f de 0b 1f 8c db b2 98  b3 47 c1 4e dd db 36 d3  |/........G.N..6.|
-00000150  28 de cf 4c 4d 54 8e a3  e5 d3 38 19 1f 4b 05 7f  |(..LMT....8..K..|
-00000160  9a e1 59 4c a3 4e 42 b6  71 0d 9c 96 e4 d8 29 73  |..YL.NB.q.....)s|
-00000170  4e e6 f5 87 56 04 99 c2  56 15 6c 8b 04 7c e5 83  |N...V...V.l..|..|
-00000180  8b f3 42 e8 97 7a b0 cc  7d 15 b8 84 d3 08 dd c1  |..B..z..}.......|
-00000190  89 f5 d4 19 d2 f6 fd 32  b4 37 6e 6a cc 0c 7a 69  |.......2.7nj..zi|
-000001a0  09 57 78 36 d4 5b 8c 23  0f e6 39 08 4c 58 3e 3f  |.Wx6.[.#..9.LX>?|
-000001b0  b1 a0 ae 2e 85 b7 64 45  dd e1 ae c4 91 53 8c 6f  |......dE.....S.o|
-000001c0  02 70 45 f0 97 7b c8 90  88 0e 95 ed 1e 81 fc 86  |.pE..{..........|
-000001d0  27 83 3d 32 43 d6 e4 f3  84 c6 c4 c1 b2 1c 0d 4a  |'.=2C..........J|
-000001e0  22 78 cd 1c f8 0a aa 19  1a 96 cc 46 6d a0 7f c7  |"x.........Fm...|
-000001f0  2f d8 68 de 48 7d ae 42  b3 75 2a d5 ab cf e7 a7  |/.h.H}.B.u*.....|
-00000200  a1 e6 66 e0 88 d8 14 25  81 21 4a 6f f7 7c 84 57  |..f....%.!Jo.|.W|
-00000210  9c cd 45 8a c0 2d 5f 97  b6 66 96 f1 be d8 02 d2  |..E..-_..f......|
-00000220  a4 8e fb 0d c4 cc 02 12  1d b7 76 73 8d 73 8e 71  |..........vs.s.q|
-00000230  ec 62 4b ba d1 94 98 e5  de 45 f4 92 22 79 9a 2e  |.bK......E.."y..|
-00000240  b4 12 a6 f8 ab 8a 52 c3  df f8 77 a9 71 8b ff d6  |......R...w.q...|
-00000250  2b bc 47 0b 63 5b 0f cf  f8 f1 86 7a 72 91 78 7b  |+.G.c[.....zr.x{|
-00000260  b8 52 74 96 40 4c 08 f3  ca 46 ef d9 b9 6d 7a dc  |.Rt.@L...F...mz.|
-00000270  2c da f1 c2 c4 1f 19 38  84 cf 7d b7 5d f2 19 a7  |,......8..}.]...|
-00000280  bc 81 70 48 1c 5d da e7  e1 8f 94 33 fa b9 44 97  |..pH.].....3..D.|
-00000290  52 7a 22 75 f3 3e 08 f5  d3 66 be 63 8e e6 fc 7b  |Rz"u.>...f.c...{|
-000002a0  54 6d 14 2e 88 09 c7 a1  a6 b7 8e f3 9f 66 dd a4  |Tm...........f..|
-000002b0  ec 81 e9 4b 44 69 29 78  95 dd 44 80 f5 f9 41 23  |...KDi)x..D...A#|
-000002c0  97 53 71 63 2d cc d0 47  d6 f7 3f 6b 61 5f 44 33  |.Sqc-..G..?ka_D3|
-000002d0  61 d1 35 94 42 7b 88 b9  af 6f e2 c1 71 7b d9 12  |a.5.B{...o..q{..|
-000002e0  2c b6 57 fa 42 98 27 6d  8a da f8 dd de 6f b2 ea  |,.W.B.'m.....o..|
-000002f0  c8 de 5c 09 cd 47 36 10  0f 52 72 39 b2 e5 92 19  |..\..G6..Rr9....|
-00000300  81 2a e0 ae aa cc b5 d1  68 98 c4 69 02 fc 86 1a  |.*......h..i....|
-00000310  79 9c 11 54 fc 43 8a ed  63 50 83 49 ac bf 4c ad  |y..T.C..cP.I..L.|
-00000320  80 04 98 fd 33 19 76 49  8f fe 5a 0f 22 69 3e eb  |....3.vI..Z."i>.|
-00000330  d8 eb 51 71 17 03 03 00  99 42 4d 4b db 37 6c c3  |..Qq.....BMK.7l.|
-00000340  fb 93 1f a6 7a 86 3c 5e  88 e5 75 d4 a1 73 4a b3  |....z.<^..u..sJ.|
-00000350  0b 99 f1 a6 98 5f 6d 0f  00 0e 4f fa a3 5e 7d f0  |....._m...O..^}.|
-00000360  41 dd dd 5c 71 3b 10 f9  75 07 d5 6c f2 83 83 5c  |A..\q;..u..l...\|
-00000370  60 32 d9 d2 b3 13 1b 6c  84 2b 02 58 da b6 18 4e  |`2.....l.+.X...N|
-00000380  ea 7d b3 46 2b a9 ec e7  65 3a 8e 2f 77 48 92 72  |.}.F+...e:./wH.r|
-00000390  6a 82 47 bd 82 2b f7 01  6b c4 22 e2 43 78 78 03  |j.G..+..k.".Cxx.|
-000003a0  3c 40 d9 6c d1 b3 5e 21  4d 52 74 e4 07 70 56 21  |<@.l..^!MRt..pV!|
-000003b0  05 37 37 82 13 cd e6 ce  3f 93 61 74 b4 9a 42 7d  |.77.....?.at..B}|
-000003c0  26 fa 15 4f ed b7 63 22  3c 92 f3 72 9c d2 80 17  |&..O..c"<..r....|
-000003d0  30 f0 17 03 03 00 35 8c  f6 08 33 76 5a a4 7b ef  |0.....5...3vZ.{.|
-000003e0  0d 91 b6 bf fa 9e 39 19  6f 79 77 4c 4d 74 95 71  |......9.oywLMt.q|
-000003f0  00 73 37 17 50 ef 55 fb  71 04 36 87 2e 16 5e 25  |.s7.P.U.q.6...^%|
-00000400  9b d4 9c 52 f9 ec c5 26  7e 58 ed 9f              |...R...&~X..|
+00000060  a4 00 4f 38 9f 17 cc 91  60 06 78 48 40 f3 be ac  |..O8....`.xH@...|
+00000070  f4 09 3f b1 41 0d 60 66  50 d5 a8 2c bf a6 c6 c8  |..?.A.`fP..,....|
+00000080  ca fe ed 4b 3f 5f 51 eb  fb da 45 b2 ad d3 70 d4  |...K?_Q...E...p.|
+00000090  59 e5 ad 07 5a 02 2e f4  6b 01 7e 57 c5 b7 71 02  |Y...Z...k.~W..q.|
+000000a0  14 03 03 00 01 01 17 03  03 00 17 3c 06 c9 4d 5a  |...........<..MZ|
+000000b0  51 b5 51 d9 dc ae 31 6d  75 9b f8 6e c1 9f e1 48  |Q.Q...1mu..n...H|
+000000c0  d6 c4 17 03 03 02 6d 9c  e1 d2 b9 0e da 85 ab 4e  |......m........N|
+000000d0  48 10 60 40 e4 1e 47 22  6f 26 2c fc f8 39 70 0f  |H.`@..G"o&,..9p.|
+000000e0  34 c8 40 80 dd c4 2b 39  50 d2 9c 9c 13 88 61 9e  |4.@...+9P.....a.|
+000000f0  62 14 01 ac be 34 95 dd  46 b6 e9 13 36 8f 54 00  |b....4..F...6.T.|
+00000100  43 5f 34 61 88 df 09 85  c7 0f 36 f3 0d 22 ef 25  |C_4a......6..".%|
+00000110  71 01 a7 ba fa 8d 24 7d  03 34 cf 92 d4 37 be b3  |q.....$}.4...7..|
+00000120  8b 79 e4 12 6d 19 32 28  47 51 d4 ec 85 b9 e2 88  |.y..m.2(GQ......|
+00000130  60 54 9d b5 75 56 27 fe  db bb 2d c9 38 49 f9 dc  |`T..uV'...-.8I..|
+00000140  cf 3e 71 af 65 b7 c4 72  7a f9 69 d5 a3 d6 be aa  |.>q.e..rz.i.....|
+00000150  e9 79 fa ec e0 55 33 78  21 2f 2d 54 62 83 6c 77  |.y...U3x!/-Tb.lw|
+00000160  2d 1e c9 5a 97 b4 11 46  ca 0e ba 75 58 d4 c4 a0  |-..Z...F...uX...|
+00000170  49 d8 76 f1 f0 37 0c 30  c2 a8 86 78 a7 c5 24 00  |I.v..7.0...x..$.|
+00000180  6e bd 89 fb 6a e6 73 1e  11 b9 21 29 92 c2 fd 44  |n...j.s...!)...D|
+00000190  cd 84 25 e0 19 09 56 a8  65 73 01 f9 1d 26 ed 02  |..%...V.es...&..|
+000001a0  67 3c 8a 1d 53 d7 c2 ea  a4 0d dd 03 26 85 eb b8  |g<..S.......&...|
+000001b0  20 c9 06 64 76 24 9a 4a  96 44 48 78 2e 86 01 9c  | ..dv$.J.DHx....|
+000001c0  be a3 60 7e 6e 5b 56 30  c7 b4 2d ff 71 db 58 15  |..`~n[V0..-.q.X.|
+000001d0  86 22 84 fb 00 d3 96 1d  f5 5f e5 39 3a 51 cc 04  |."......._.9:Q..|
+000001e0  95 fd 49 f0 c2 cc 34 e1  0b 1d ba bb 62 f8 14 4d  |..I...4.....b..M|
+000001f0  aa 94 f0 09 b5 04 d3 b7  52 10 d2 ee 01 0c a0 68  |........R......h|
+00000200  62 83 4f 11 33 b9 1c b1  4e 23 09 e7 d1 c2 c9 a4  |b.O.3...N#......|
+00000210  de 63 c3 48 3f c7 51 9a  78 4c 2e e7 fa 2c bd 06  |.c.H?.Q.xL...,..|
+00000220  82 e8 2f 61 35 83 aa 92  8b de 76 fb 0b 5a a7 44  |../a5.....v..Z.D|
+00000230  07 6b 8f d9 de d6 dd 35  ec 08 44 31 97 15 9c 70  |.k.....5..D1...p|
+00000240  38 89 2d 06 5d 01 39 23  45 ce c1 98 ca 90 f6 4a  |8.-.].9#E......J|
+00000250  47 a2 d4 6a ea 9f bc 7e  ab 42 f5 b9 bd 54 44 0c  |G..j...~.B...TD.|
+00000260  b8 1c 34 10 53 80 ae fb  97 b5 64 75 2e c0 72 30  |..4.S.....du..r0|
+00000270  dc 4a 3d aa 73 25 42 be  18 da 7c ae 0b 31 b0 f9  |.J=.s%B...|..1..|
+00000280  55 d6 15 42 da bb e0 91  c9 ee bb b8 e3 6a ea f7  |U..B.........j..|
+00000290  bf ae 2d 29 c0 58 4f 61  0c 55 e5 07 78 aa d1 45  |..-).XOa.U..x..E|
+000002a0  76 8e e4 a9 d0 dd 49 29  7d f1 ab b8 82 39 31 23  |v.....I)}....91#|
+000002b0  4c d4 5f f4 18 e7 b0 70  5f 78 e3 22 65 3b 84 e7  |L._....p_x."e;..|
+000002c0  40 d7 cb b5 e3 8c 5d fa  77 cb 45 fa 57 c0 4c fd  |@.....].w.E.W.L.|
+000002d0  11 7c f1 80 fa 4c 51 d9  78 5d b6 cc 08 90 91 9a  |.|...LQ.x]......|
+000002e0  71 20 e3 50 ec 21 7e 0d  2d e5 97 12 4a 18 17 ab  |q .P.!~.-...J...|
+000002f0  a0 1f 74 75 71 6b 8b 81  ac 85 18 99 ad 75 88 4c  |..tuqk.......u.L|
+00000300  15 87 04 57 1e 78 10 13  4b 51 f2 e9 8a 76 17 77  |...W.x..KQ...v.w|
+00000310  32 92 6c 12 6c db 2e ef  c1 2d 18 64 e8 b1 62 79  |2.l.l....-.d..by|
+00000320  4c 8a d0 23 9a ac 14 ab  c3 9f d7 37 0c cb 57 29  |L..#.......7..W)|
+00000330  bd 89 d8 32 17 03 03 00  99 40 69 b7 6b 35 af 37  |...2.....@i.k5.7|
+00000340  fd 28 d7 52 34 fa 65 84  83 41 a8 cd d9 5d e7 68  |.(.R4.e..A...].h|
+00000350  41 9b 39 7c f8 ef cf d8  8d 50 b9 2a 11 13 df f2  |A.9|.....P.*....|
+00000360  3c b3 4c 4b 7d c5 a5 d6  cf f2 72 c8 ea 26 0b 90  |<.LK}.....r..&..|
+00000370  42 5e b3 44 da a6 7d 81  13 0f f6 eb 4d c4 98 65  |B^.D..}.....M..e|
+00000380  84 aa 47 bf ba b3 f5 57  3c 18 cd 8c b2 9d 3f eb  |..G....W<.....?.|
+00000390  0e 13 aa b2 ed 42 97 cd  3f f9 d0 b7 8c 1a 94 5c  |.....B..?......\|
+000003a0  63 c3 f8 45 be 91 61 c6  d9 01 bd 88 d7 fa 15 6d  |c..E..a........m|
+000003b0  8c 48 87 6a 10 eb 43 39  66 a2 a4 cd ef 15 db 4f  |.H.j..C9f......O|
+000003c0  0d da 85 48 81 af d1 60  4b bc b9 03 a9 c5 c0 7b  |...H...`K......{|
+000003d0  9a 60 17 03 03 00 35 9a  10 8d b7 6a 5c 8e 16 96  |.`....5....j\...|
+000003e0  0a d3 2d 81 4f 3c 47 f5  bc f8 cd 92 c0 17 07 89  |..-.O<G.........|
+000003f0  28 82 42 9f f2 b0 c5 99  4f a3 33 46 f8 ea 7a b7  |(.B.....O.3F..z.|
+00000400  9e e9 a0 d6 f2 45 7e 8b  f3 4d 80 d2              |.....E~..M..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 f5 7f 27 09 c2  |..........5..'..|
-00000010  54 9d e7 a7 3b 14 b3 f2  a6 6d 27 5f 9b 79 04 17  |T...;....m'_.y..|
-00000020  28 5c de 4f 67 cf a5 24  e4 d3 c5 e1 38 fa 7e e8  |(\.Og..$....8.~.|
-00000030  97 03 7e 66 3b d0 6b e7  f8 7e 97 e0 db 6a da 79  |..~f;.k..~...j.y|
-00000040  17 03 03 00 17 30 1a e2  fe 4a 7a 03 03 82 f6 05  |.....0...Jz.....|
-00000050  e8 18 67 1d 14 ab 4f 3c  22 c6 45 f5 17 03 03 00  |..g...O<".E.....|
-00000060  13 f8 8f 43 e7 74 3c a0  28 b2 71 5a 85 69 e5 86  |...C.t<.(.qZ.i..|
-00000070  06 e3 4c 91                                       |..L.|
+00000000  14 03 03 00 01 01 17 03  03 00 35 5e d8 a7 91 d2  |..........5^....|
+00000010  39 b1 74 e8 a4 a2 02 97  c9 23 be a2 40 f8 94 39  |9.t......#..@..9|
+00000020  4b e8 ed 35 6c 8e 23 ce  da 32 90 93 50 f6 80 75  |K..5l.#..2..P..u|
+00000030  43 91 9c 90 09 b5 bb 7d  ab 56 53 0c a8 95 a5 c3  |C......}.VS.....|
+00000040  17 03 03 00 17 7e 95 f6  cc 40 0f 64 9f 6b d6 63  |.....~...@.d.k.c|
+00000050  29 28 6d 21 12 c4 70 6f  dd 69 ad d1 17 03 03 00  |)(m!..po.i......|
+00000060  13 8a b3 a5 7b 42 fe 41  be 86 57 03 16 d4 f1 25  |....{B.A..W....%|
+00000070  95 8d 2b f7                                       |..+.|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-X25519-ECDHE b/src/crypto/tls/testdata/Client-TLSv13-X25519-ECDHE
index 855f63de21..c10e6c9182 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-X25519-ECDHE
+++ b/src/crypto/tls/testdata/Client-TLSv13-X25519-ECDHE
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 f8 01 00 00  f4 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 16 01 00 01  12 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,84 +7,86 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 79 00 0b 00 02  01 00 ff 01 00 01 00 00  |...y............|
+00000080  01 00 00 97 00 0b 00 02  01 00 ff 01 00 01 00 00  |................|
 00000090  17 00 00 00 12 00 00 00  05 00 05 01 00 00 00 00  |................|
 000000a0  00 0a 00 04 00 02 00 1d  00 0d 00 1a 00 18 08 04  |................|
 000000b0  04 03 08 07 08 05 08 06  04 01 05 01 06 01 05 03  |................|
-000000c0  06 03 02 01 02 03 00 2b  00 09 08 03 04 03 03 03  |.......+........|
-000000d0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
-000000e0  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
-000000f0  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
+000000c0  06 03 02 01 02 03 00 32  00 1a 00 18 08 04 04 03  |.......2........|
+000000d0  08 07 08 05 08 06 04 01  05 01 06 01 05 03 06 03  |................|
+000000e0  02 01 02 03 00 2b 00 09  08 03 04 03 03 03 02 03  |.....+..........|
+000000f0  01 00 33 00 26 00 24 00  1d 00 20 2f e5 7d a3 47  |..3.&.$... /.}.G|
+00000100  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
+00000110  c4 cf c2 ed 90 99 5f 58  cb 3b 74                 |......_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 6c f6 24 8a 4a  |....z...v..l.$.J|
-00000010  82 87 8f c9 9a a3 5a d2  4a 24 d3 52 c8 5d 52 95  |......Z.J$.R.]R.|
-00000020  0f 12 e8 8e e6 0c a6 5d  60 de 3c 20 00 00 00 00  |.......]`.< ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 97 02 8a b6 20  |....z...v...... |
+00000010  f7 b6 e4 eb 5b eb f8 c0  ea 29 ad 6a cb 1a 0a d7  |....[....).j....|
+00000020  40 a5 e7 dd 1d 75 88 61  b4 92 2b 20 00 00 00 00  |@....u.a..+ ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 1b  |..+.....3.$... .|
-00000060  e6 5f 3d 83 17 1c a6 90  45 f9 00 d9 96 be 4a 58  |._=.....E.....JX|
-00000070  ec 82 73 4d e6 8c 74 e9  80 bc 3a 48 1b 93 71 14  |..sM..t...:H..q.|
-00000080  03 03 00 01 01 17 03 03  00 17 71 c1 fc 68 5e 33  |..........q..h^3|
-00000090  54 8f 43 df 20 55 ac 3b  e8 a4 ee 68 ff 88 7c 71  |T.C. U.;...h..|q|
-000000a0  92 17 03 03 02 6d 2a 26  5c 45 13 5f 75 46 56 41  |.....m*&\E._uFVA|
-000000b0  25 92 a1 6f cd 7b 01 e2  cb 76 81 4d 33 f0 9d d1  |%..o.{...v.M3...|
-000000c0  0d db b1 90 1a a7 d9 a8  4a 79 b1 12 59 62 0d c8  |........Jy..Yb..|
-000000d0  cc 92 16 26 27 3e 07 b6  8a 15 77 a8 f6 c3 02 e7  |...&'>....w.....|
-000000e0  44 0d b5 d3 11 57 6b 81  15 7d 23 b3 91 82 21 3c  |D....Wk..}#...!<|
-000000f0  0a 0c ef d5 5b 96 5d 85  aa 3a 1e a6 7b fc 3a eb  |....[.]..:..{.:.|
-00000100  24 af 13 fa 7f 90 0a 83  b5 0a 0b d0 f7 0c 2d 99  |$.............-.|
-00000110  75 9b 84 0c d8 dc 60 a3  62 ed 64 55 02 73 a1 74  |u.....`.b.dU.s.t|
-00000120  c1 53 c6 97 a5 23 7c 19  c8 f7 1c 97 e9 e9 f8 ee  |.S...#|.........|
-00000130  4c 47 7e c4 5e 0f 03 fc  60 9e ba 47 ea a9 9b ef  |LG~.^...`..G....|
-00000140  9a 04 62 e3 db bf 30 d7  5a 1f 20 c9 4c 37 ff 0e  |..b...0.Z. .L7..|
-00000150  46 d9 ce 85 c5 47 16 43  9a 89 0b 97 44 7a be 09  |F....G.C....Dz..|
-00000160  5d 03 a0 b1 1f a6 ca 78  0d fb f4 1a 6d 3a ec 40  |]......x....m:.@|
-00000170  1e 58 fc 67 5e bb 69 a1  ae 1d 6d bc b4 80 b9 71  |.X.g^.i...m....q|
-00000180  1a 11 12 35 6a 2a 0c dc  b3 b5 4b 0a 06 a7 8b be  |...5j*....K.....|
-00000190  38 4b 70 32 d4 51 e3 99  5b 60 28 e7 9a 60 90 6b  |8Kp2.Q..[`(..`.k|
-000001a0  1f 3a 9b 4b 66 fd e6 76  b5 8c 29 c3 36 ae a8 81  |.:.Kf..v..).6...|
-000001b0  7e 7c bf e7 46 7d 13 27  0d 38 75 f0 15 e1 64 93  |~|..F}.'.8u...d.|
-000001c0  1e 26 bc a8 5d 95 60 a2  e5 42 7f 2f 08 a1 e8 d3  |.&..].`..B./....|
-000001d0  79 e8 5e 1f 02 45 cc 05  ca 63 7b f2 d9 ad af ab  |y.^..E...c{.....|
-000001e0  5a 94 f0 16 e7 60 14 c2  3d 05 3f 8d bb 33 c1 ca  |Z....`..=.?..3..|
-000001f0  79 28 04 c7 20 07 c8 13  89 7a 11 a2 54 6d b8 d5  |y(.. ....z..Tm..|
-00000200  e1 b7 b1 43 48 9b a9 b9  e8 e0 40 7e 5a 36 24 70  |...CH.....@~Z6$p|
-00000210  42 9a 51 70 6e 22 8a 2b  4b 9d b0 58 ff ae a9 45  |B.Qpn".+K..X...E|
-00000220  34 b2 8b c1 35 d8 65 a5  7e 1f 32 fd 51 21 79 00  |4...5.e.~.2.Q!y.|
-00000230  79 20 f7 5f 8a e2 e0 b3  4a 78 3b 03 a8 03 b6 ef  |y ._....Jx;.....|
-00000240  b2 25 37 e9 f3 ce 22 f0  2b fc f8 dd be 50 10 22  |.%7...".+....P."|
-00000250  0b fa fb 04 ab a7 33 07  48 2f ca ec 0d fe 19 75  |......3.H/.....u|
-00000260  cc c5 3d 17 36 06 5c 07  08 15 df 36 6c 4f f4 73  |..=.6.\....6lO.s|
-00000270  50 49 ff 47 ba 47 6d e1  bb 2d 8f 77 d5 44 a9 87  |PI.G.Gm..-.w.D..|
-00000280  2a 05 12 52 bf 2b e2 4b  64 94 9c 89 bb 2c 65 cb  |*..R.+.Kd....,e.|
-00000290  59 2a f0 1a 15 b2 e3 6e  5a cc 48 b4 44 6c 44 07  |Y*.....nZ.H.DlD.|
-000002a0  80 01 93 25 86 83 f2 8f  01 e6 ef 5e 9a 36 4e 7f  |...%.......^.6N.|
-000002b0  bc 27 0e 4d f0 67 3a de  29 b5 e9 6a 7f 4b b4 77  |.'.M.g:.)..j.K.w|
-000002c0  9b e2 3b 73 c9 51 e5 a6  df 97 a7 02 fa f2 f7 db  |..;s.Q..........|
-000002d0  df 71 fb d1 ad 64 37 46  3e de 57 de 1d fc 8f 6e  |.q...d7F>.W....n|
-000002e0  bb 6f 58 3f 87 00 d1 a3  52 a5 35 12 17 83 19 a4  |.oX?....R.5.....|
-000002f0  2b be 31 bd dc a6 62 ca  c3 09 39 e1 cd 0b 64 44  |+.1...b...9...dD|
-00000300  1a ef 65 26 f3 e5 31 fb  61 56 df d3 11 d9 cc 65  |..e&..1.aV.....e|
-00000310  7f 8f ab 17 03 03 00 99  94 ce 37 3c e1 7f b1 f5  |..........7<....|
-00000320  7e 2b 04 17 45 3d 38 40  1b 82 0e f7 22 ef 28 ce  |~+..E=8@....".(.|
-00000330  1a 69 33 a6 ad c6 1f ab  08 12 31 b4 c7 41 ac c5  |.i3.......1..A..|
-00000340  b3 e5 4b 84 56 d9 0c 53  58 4c 8f 40 3a 34 66 d0  |..K.V..SXL.@:4f.|
-00000350  c7 8f 9b b3 26 25 1f 68  fc 97 ba a7 de ac cf c5  |....&%.h........|
-00000360  8b b3 26 99 68 6e ca e9  65 47 07 bd 38 15 f3 0c  |..&.hn..eG..8...|
-00000370  d0 14 8e 6d 89 a2 ad cd  ad ef 00 54 07 5a 4b ef  |...m.......T.ZK.|
-00000380  02 ce b9 a1 b0 d0 d6 f7  bb e0 91 51 72 87 99 50  |...........Qr..P|
-00000390  f4 68 4c 0e d8 fa 00 d4  dd bd 1d 2e 7b f6 e2 61  |.hL.........{..a|
-000003a0  d3 a8 46 9c f7 dc 2a 04  be 3c 42 85 4f ad 59 20  |..F...*..<B.O.Y |
-000003b0  a2 17 03 03 00 35 ee cf  79 7c 39 a5 02 f9 99 e4  |.....5..y|9.....|
-000003c0  5d e5 76 ba bf 74 f9 b4  fe bc 1e 85 06 2e 2c 58  |].v..t........,X|
-000003d0  b4 a5 5f dd e5 a2 7c d0  3a 3b 95 97 85 76 7f bc  |.._...|.:;...v..|
-000003e0  6f 9d 49 98 48 93 dc 46  ac 60 ba                 |o.I.H..F.`.|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 b3  |..+.....3.$... .|
+00000060  73 c5 08 81 cd 33 2e 44  42 46 70 03 40 b1 cf 44  |s....3.DBFp.@..D|
+00000070  39 17 fa 84 e2 44 0e 37  f5 d1 3a a7 3c ca 5d 14  |9....D.7..:.<.].|
+00000080  03 03 00 01 01 17 03 03  00 17 29 94 4c 54 36 71  |..........).LT6q|
+00000090  24 9c 5c 24 f2 e7 85 50  b7 fd cb 8c db 28 14 f7  |$.\$...P.....(..|
+000000a0  f9 17 03 03 02 6d c7 4c  08 32 d5 0f 28 ec e9 4f  |.....m.L.2..(..O|
+000000b0  08 45 1d cb 93 c8 61 47  1d 6b c9 ef 33 25 e0 07  |.E....aG.k..3%..|
+000000c0  14 18 d9 ec 1b 6f 5a e1  d1 8c 9d ad 2d 46 0f b8  |.....oZ.....-F..|
+000000d0  c7 f7 0d f8 e7 86 3d 70  8d e1 ce 78 a0 3a cc 36  |......=p...x.:.6|
+000000e0  26 f0 e2 49 99 24 dd 61  c7 ae cd 10 4c 59 09 8a  |&..I.$.a....LY..|
+000000f0  43 26 35 2a b7 64 45 53  60 13 17 e6 7d 59 b7 4b  |C&5*.dES`...}Y.K|
+00000100  90 57 88 d9 21 8b d8 7d  bc 00 9e f7 bf 89 a9 d0  |.W..!..}........|
+00000110  5e 2d 17 2c cd ff cb cd  93 e8 a1 55 b7 11 fe b5  |^-.,.......U....|
+00000120  29 62 3f 6a 4c 41 ba 31  a9 ba 7a 54 7b 16 be 73  |)b?jLA.1..zT{..s|
+00000130  d4 17 35 e3 35 f2 41 a0  af d5 c7 b8 0b ea 79 bc  |..5.5.A.......y.|
+00000140  ff 2c 48 d4 2a 8b 86 e8  42 f5 75 50 31 09 4c f4  |.,H.*...B.uP1.L.|
+00000150  b8 c4 6c f4 24 9b 53 06  5c 2e c1 f0 37 22 51 9f  |..l.$.S.\...7"Q.|
+00000160  12 a1 4d 06 c8 0d 11 e4  5b 5d 72 ed f1 c2 8d 64  |..M.....[]r....d|
+00000170  74 63 0f 4e d3 9a 92 f6  68 47 36 53 5a 19 90 bc  |tc.N....hG6SZ...|
+00000180  7e de e9 05 73 5b 13 80  92 bb f4 ff 6d 4e e5 1c  |~...s[......mN..|
+00000190  40 b6 29 f3 34 0f 3c 7b  06 af 54 14 67 cb 43 43  |@.).4.<{..T.g.CC|
+000001a0  ad 30 68 a9 d1 09 29 43  02 01 ba 6e 87 e5 7a 75  |.0h...)C...n..zu|
+000001b0  67 53 54 cf bf 33 d9 f1  ca fa 63 cf 04 87 00 c6  |gST..3....c.....|
+000001c0  82 ab 0e a7 4e 8f 00 ad  0b 64 2e 87 3c 07 d7 a1  |....N....d..<...|
+000001d0  1d 4c 68 b5 78 e0 83 1f  5e d3 21 35 ed bb ca 8a  |.Lh.x...^.!5....|
+000001e0  91 cf 39 ec 74 c5 e4 51  2b 00 cf 3b 71 e1 ba af  |..9.t..Q+..;q...|
+000001f0  e6 c6 29 cc cf 8f a3 23  89 ae 3c 0f d0 47 e7 29  |..)....#..<..G.)|
+00000200  d4 11 7e 62 57 3a ee 7a  42 98 0d 53 1b 14 a7 45  |..~bW:.zB..S...E|
+00000210  12 15 8c 0b 9d 32 1d 9e  f3 a1 31 b5 34 c5 d8 03  |.....2....1.4...|
+00000220  69 df 1f ab a4 4e 01 d7  35 f7 3e 83 3d 7b 7e cc  |i....N..5.>.={~.|
+00000230  30 cd 8a 3b 9e 80 1b 5c  cc 48 2d 92 37 b8 5d 23  |0..;...\.H-.7.]#|
+00000240  8b 43 9e 1e 6d 60 04 7f  91 b1 7f 7d 4a ff 3f 5f  |.C..m`.....}J.?_|
+00000250  e8 e4 49 9e 48 04 69 20  5d e9 13 3a 61 23 fa 4e  |..I.H.i ]..:a#.N|
+00000260  31 f9 d6 3e cd fc 20 e2  14 d7 2d 47 63 7b e5 fd  |1..>.. ...-Gc{..|
+00000270  20 01 9c f4 b3 82 1f 56  60 f5 7c e2 2a 70 64 91  | ......V`.|.*pd.|
+00000280  75 75 68 fb 61 08 72 83  fc 4f a0 75 3a 2d ff f8  |uuh.a.r..O.u:-..|
+00000290  c9 1b 02 bf cf 84 fd 5e  ab dd 01 28 de d9 d8 1c  |.......^...(....|
+000002a0  78 7e a0 66 35 43 d5 54  08 66 41 74 df 43 b1 23  |x~.f5C.T.fAt.C.#|
+000002b0  f4 f1 3d 78 d0 d2 99 0d  99 c5 c1 f2 cf 86 74 29  |..=x..........t)|
+000002c0  10 31 10 4e 56 aa 90 0b  39 1f 7c 7d 6f f7 39 6b  |.1.NV...9.|}o.9k|
+000002d0  9b 4e 3c 3e 52 2f 7e 6f  6e 55 b5 64 58 08 7d dd  |.N<>R/~onU.dX.}.|
+000002e0  3b 79 08 b3 30 49 17 28  a0 6e 76 b3 38 54 56 19  |;y..0I.(.nv.8TV.|
+000002f0  f7 67 11 5f d5 54 c3 22  07 e8 83 c8 22 19 37 ab  |.g._.T."....".7.|
+00000300  8e 3a ed 07 47 02 b8 4f  03 6c ca e1 16 20 a0 b6  |.:..G..O.l... ..|
+00000310  43 d9 39 17 03 03 00 99  26 fb 79 ee 89 6d e8 ce  |C.9.....&.y..m..|
+00000320  89 95 ec 7d a2 19 ab 24  b7 b5 49 00 de ae a3 29  |...}...$..I....)|
+00000330  00 ce bf 8d 71 42 c2 dc  ae 65 ed 84 a3 af 1b d9  |....qB...e......|
+00000340  64 0a fa 49 b6 5e a9 64  bb 91 43 25 65 df 06 ee  |d..I.^.d..C%e...|
+00000350  90 a9 c9 48 99 c2 b6 0d  91 91 77 70 3b ca 58 a4  |...H......wp;.X.|
+00000360  c7 e8 fd 01 67 7c b3 ea  8e b9 9d c5 4c cf 55 67  |....g|......L.Ug|
+00000370  09 23 99 e7 2d ff 54 4b  e4 56 d5 24 72 a9 1b 03  |.#..-.TK.V.$r...|
+00000380  bc 4c d9 c8 37 f2 0b 62  88 4e 89 05 db 11 0f 3a  |.L..7..b.N.....:|
+00000390  9f 8b a7 4f a4 0a 89 d5  c8 df 11 06 af 73 71 38  |...O.........sq8|
+000003a0  bd 2f 97 15 24 b6 54 ca  bb 1c 3c e1 16 ad eb c6  |./..$.T...<.....|
+000003b0  64 17 03 03 00 35 b8 1c  a1 16 59 5c 46 6e 4c 3f  |d....5....Y\FnL?|
+000003c0  3c 79 d0 1f 4f 8a c8 49  49 6e 7e 53 de fb 43 99  |<y..O..IIn~S..C.|
+000003d0  c8 a8 3d ab 1e a4 05 de  34 0a 85 9e 9c 3e 33 2d  |..=.....4....>3-|
+000003e0  3b 78 12 70 cc 3e cf f6  36 47 23                 |;x.p.>..6G#|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 19 50 85 5d 08  |..........5.P.].|
-00000010  c9 5e 25 05 37 ed cc 54  fe ba 86 3e 8a d4 e9 fd  |.^%.7..T...>....|
-00000020  66 54 6e a3 1f 8b 4f 95  cf 04 51 db 60 96 ae 78  |fTn...O...Q.`..x|
-00000030  6b 7d 19 63 03 2a b6 e5  97 37 26 79 98 3f 85 52  |k}.c.*...7&y.?.R|
-00000040  17 03 03 00 17 c9 80 91  3e 92 1e a7 9b 00 a3 01  |........>.......|
-00000050  19 31 d0 6f 2e 69 0c 15  03 73 20 36 17 03 03 00  |.1.o.i...s 6....|
-00000060  13 97 85 32 6f a2 9c 72  be ca 43 db 18 a7 98 b7  |...2o..r..C.....|
-00000070  67 44 71 ce                                       |gDq.|
+00000000  14 03 03 00 01 01 17 03  03 00 35 59 5c b8 42 f1  |..........5Y\.B.|
+00000010  bb fc 65 3e 0a 8b 1c 70  be 4b 39 8c ae 0d 91 e1  |..e>...p.K9.....|
+00000020  82 b8 ad 51 1f f3 d4 06  13 33 96 71 27 96 1f f2  |...Q.....3.q'...|
+00000030  dd 6f ef 94 9b bb 56 bf  8a 59 2b 92 c9 01 b7 72  |.o....V..Y+....r|
+00000040  17 03 03 00 17 3a b4 c3  77 5b e6 98 a2 b4 3d f6  |.....:..w[....=.|
+00000050  83 fb f4 f5 6e f5 5f 5a  1e 5b 96 4c 17 03 03 00  |....n._Z.[.L....|
+00000060  13 3b 5f a0 57 f0 27 8d  dd 6a 36 fc 4c 33 86 f6  |.;_.W.'..j6.L3..|
+00000070  fe 8b 6f 5a                                       |..oZ|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndECDSAGiven b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndECDSAGiven
index a957c26399..686011b0fa 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndECDSAGiven
+++ b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndECDSAGiven
@@ -1,180 +1,182 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 cd 87 c0 5e 7c  |..............^||
-00000010  7b d7 c6 77 d9 21 6f 46  00 07 88 61 18 8c b9 d4  |{..w.!oF...a....|
-00000020  ad 25 6a 9d 7e 54 cc 70  52 7c 0f 20 67 9b dd 18  |.%j.~T.pR|. g...|
-00000030  84 bb 23 7d 53 10 b9 6c  01 ef 30 6f 79 7d 64 5c  |..#}S..l..0oy}d\|
-00000040  79 3e c1 11 8f 75 cf 83  02 d3 e8 d9 00 04 13 01  |y>...u..........|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 af 29 1d da b2  |............)...|
+00000010  1b 14 96 f9 c9 6a 4d 28  cc 1d 9f c4 95 d0 a6 16  |.....jM(........|
+00000020  1f 83 3d d6 17 80 5e 4f  9f d9 87 20 cb 34 16 64  |..=...^O... .4.d|
+00000030  39 bb 98 16 55 43 38 3a  a2 b4 e0 38 02 04 ee 6b  |9...UC8:...8...k|
+00000040  a6 4e b9 f8 83 09 aa 7b  f5 de e0 79 00 04 13 01  |.N.....{...y....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 d7  |-.....3.&.$... .|
-000000b0  18 8a c1 a5 4d cb 7c f2  7d e4 cf 7a c6 92 28 ee  |....M.|.}..z..(.|
-000000c0  a6 b4 79 65 bf 2b fb 71  2e a5 2a 58 da 6f 5e     |..ye.+.q..*X.o^|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 ee  |-.....3.&.$... .|
+000000b0  90 71 47 4a 18 b1 78 c4  9a 7d 65 5d 4e b3 88 96  |.qGJ..x..}e]N...|
+000000c0  6c b1 bc 2d a3 9d 2d 8e  a2 7a 7b eb 94 11 4e     |l..-..-..z{...N|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 67 9b dd 18  |........... g...|
-00000030  84 bb 23 7d 53 10 b9 6c  01 ef 30 6f 79 7d 64 5c  |..#}S..l..0oy}d\|
-00000040  79 3e c1 11 8f 75 cf 83  02 d3 e8 d9 13 01 00 00  |y>...u..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 cb 34 16 64  |........... .4.d|
+00000030  39 bb 98 16 55 43 38 3a  a2 b4 e0 38 02 04 ee 6b  |9...UC8:...8...k|
+00000040  a6 4e b9 f8 83 09 aa 7b  f5 de e0 79 13 01 00 00  |.N.....{...y....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 4d 4b 33 12 cb ed  |..........MK3...|
-00000090  f7 a2 55 e7 a6 ab 5b b1  55 16 30 c3 ee e1 5c 14  |..U...[.U.0...\.|
-000000a0  b8 17 03 03 00 3e 30 04  2a e5 e8 b8 f3 25 9b a9  |.....>0.*....%..|
-000000b0  92 e6 eb d9 fb b6 62 64  e2 de 9d c0 48 68 b3 d7  |......bd....Hh..|
-000000c0  0f 8b ad 21 69 c7 f0 d7  96 ff 6a 24 2f 01 c9 e7  |...!i.....j$/...|
-000000d0  e9 06 4b 93 94 67 97 44  46 c4 69 2f 0e aa e0 9b  |..K..g.DF.i/....|
-000000e0  8d 19 f2 2c 17 03 03 02  6d a1 fb 2b 5f 10 e9 62  |...,....m..+_..b|
-000000f0  8b ad c1 33 58 f6 a7 89  78 a6 dd 64 ff c2 c7 57  |...3X...x..d...W|
-00000100  80 9f 59 be 2d bd f5 b9  8a 6b d9 22 1c fe 10 ea  |..Y.-....k."....|
-00000110  c4 a5 3e 45 d9 d7 12 cf  48 d5 26 18 49 50 80 69  |..>E....H.&.IP.i|
-00000120  44 28 03 3b b6 f8 0a 0e  b4 cb 5e 5b 57 0f c0 2f  |D(.;......^[W../|
-00000130  59 4f 13 e3 9c 02 18 b1  ce 94 78 05 18 64 73 c6  |YO........x..ds.|
-00000140  05 89 d1 54 37 18 ea 09  61 08 c5 6a 54 f6 48 44  |...T7...a..jT.HD|
-00000150  40 63 6a 53 b9 41 5f 4f  8e 05 e7 31 7b 08 d0 67  |@cjS.A_O...1{..g|
-00000160  8e bf 56 c4 56 0a 82 b2  74 6a 89 dd b4 f7 3c 0b  |..V.V...tj....<.|
-00000170  3c fd 21 1f 00 72 1d 4f  be b1 50 44 9a 14 67 7d  |<.!..r.O..PD..g}|
-00000180  a9 93 30 a2 4e ea 61 c9  fd 44 de 5c 88 36 59 a2  |..0.N.a..D.\.6Y.|
-00000190  e3 63 b1 9c ea dd 47 0a  ca 63 9e 50 9d ca 57 12  |.c....G..c.P..W.|
-000001a0  05 9b fc f1 26 a2 5e 18  9b 32 00 38 1f ce a6 58  |....&.^..2.8...X|
-000001b0  58 0f 61 e2 44 c2 89 34  cc f4 fd 9a dc 1a 67 a6  |X.a.D..4......g.|
-000001c0  e8 b1 fc 9f dc bd 0b 21  01 49 0d 9b e1 40 00 f6  |.......!.I...@..|
-000001d0  33 1a 57 c5 84 c1 98 3d  7f 53 d3 4d 2e 04 5e 40  |3.W....=.S.M..^@|
-000001e0  7d 38 80 66 bc c5 40 d9  14 f6 83 26 82 9b c8 14  |}8.f..@....&....|
-000001f0  61 aa 6c 1c a1 53 81 f8  b0 7f 06 92 5c af be 57  |a.l..S......\..W|
-00000200  1a 54 97 02 27 31 1f 58  52 cf 39 2f 82 26 ae 6c  |.T..'1.XR.9/.&.l|
-00000210  86 d9 46 cd 38 16 e2 67  62 82 2e 53 7a 86 15 30  |..F.8..gb..Sz..0|
-00000220  08 0c a7 e2 85 18 55 79  16 44 4d 50 9e b5 e7 e1  |......Uy.DMP....|
-00000230  2c 1e 1d eb e1 83 f3 9e  d0 7b 45 b8 1e 51 d9 79  |,........{E..Q.y|
-00000240  91 7a b8 90 bc 18 94 69  ad 94 08 e5 23 de 2b fa  |.z.....i....#.+.|
-00000250  8d ef 23 4c 40 df e1 43  0d 71 51 ef 88 a9 bb 89  |..#L@..C.qQ.....|
-00000260  59 87 9c db e1 d4 31 94  a7 f5 af 7d 51 be e9 d0  |Y.....1....}Q...|
-00000270  f2 49 12 72 47 65 a0 5b  7d 9f 91 85 f7 e8 d6 90  |.I.rGe.[}.......|
-00000280  b3 4d f3 5d 6a 51 96 a9  81 84 72 95 47 e8 0a f5  |.M.]jQ....r.G...|
-00000290  8d d6 2a 64 c2 34 1b d8  f0 f9 62 0c be 17 12 9b  |..*d.4....b.....|
-000002a0  40 a2 c3 8a eb 30 20 04  e4 69 a3 27 90 a6 1a 4f  |@....0 ..i.'...O|
-000002b0  3f 95 65 e6 9e c7 ad 03  e1 d2 34 d2 84 d5 f6 8c  |?.e.......4.....|
-000002c0  1e 8a aa e4 75 c0 7f 1d  79 4e 70 10 4e 18 9c eb  |....u...yNp.N...|
-000002d0  17 76 0c 66 6c 82 72 41  83 98 fc 41 41 4a 07 03  |.v.fl.rA...AAJ..|
-000002e0  a6 16 51 0d 60 96 43 0a  97 27 72 42 31 70 6b 02  |..Q.`.C..'rB1pk.|
-000002f0  e4 58 b0 15 4f 2e a3 5a  ed dc 82 99 82 47 d5 6c  |.X..O..Z.....G.l|
-00000300  4b b4 68 70 f5 a3 31 36  52 8d af ab d1 ac f6 28  |K.hp..16R......(|
-00000310  2e 18 bc 4f 1b 7c a8 ad  c3 1f 2f 70 a6 c4 39 c6  |...O.|..../p..9.|
-00000320  ae 0f 2e b7 58 c9 c0 2a  4b 34 c2 42 12 e3 5d ed  |....X..*K4.B..].|
-00000330  d1 ac e1 f1 14 66 d4 09  1c a0 99 82 d3 04 13 2a  |.....f.........*|
-00000340  a4 20 c4 e7 38 1e 0a 02  4e 96 02 71 9d f6 f7 86  |. ..8...N..q....|
-00000350  f7 30 1a 5d 65 4f 17 03  03 00 99 3f 3d 4a 91 ae  |.0.]eO.....?=J..|
-00000360  0f 80 52 0f 1c d1 a2 75  83 e5 08 d8 1f 9d c8 24  |..R....u.......$|
-00000370  fc 85 ba 76 1f 9e 1e 35  a3 dd 45 83 8e b9 55 a6  |...v...5..E...U.|
-00000380  3b 26 ae 82 4f 1f 2e 8f  e5 25 fb d6 22 0f 55 d6  |;&..O....%..".U.|
-00000390  ac fa 93 6d d1 d3 7c 41  af c0 15 5c 8b e1 64 c1  |...m..|A...\..d.|
-000003a0  3f a2 c8 9e 48 f5 63 61  3a df 13 6e f4 e3 60 9d  |?...H.ca:..n..`.|
-000003b0  bc 52 bd b7 94 e9 4b 7a  65 97 28 ac 39 6a 77 a7  |.R....Kze.(.9jw.|
-000003c0  86 1d b4 6b e4 15 c4 bd  2b 41 b6 06 ac ff b5 9f  |...k....+A......|
-000003d0  17 47 b4 a7 1d 69 8b 6e  82 eb f7 39 03 95 10 dd  |.G...i.n...9....|
-000003e0  18 78 50 58 c8 78 80 ae  45 dc 54 0f 33 cb 4a d2  |.xPX.x..E.T.3.J.|
-000003f0  90 00 12 d4 17 03 03 00  35 76 fa bf ab 3f c3 3d  |........5v...?.=|
-00000400  dd 78 65 cc 35 1e 24 35  4f 7d 3c e4 bb 73 d8 19  |.xe.5.$5O}<..s..|
-00000410  56 94 f4 ce ad bc 1d 6a  fb 1b 75 01 93 36 2b 44  |V......j..u..6+D|
-00000420  3a 3c a3 9b 7c 57 6f 98  24 a3 64 b1 13 47        |:<..|Wo.$.d..G|
+00000080  03 03 00 01 01 17 03 03  00 17 c3 9d 29 f6 f8 18  |............)...|
+00000090  b9 39 9f 93 b2 f5 ab 30  41 d6 95 40 21 ba f8 8e  |.9.....0A..@!...|
+000000a0  25 17 03 03 00 52 08 a9  80 f3 24 c6 a6 b6 aa bc  |%....R....$.....|
+000000b0  30 c2 f7 dd e6 47 10 88  db 0c dd 43 ab 78 bd 16  |0....G.....C.x..|
+000000c0  82 7b 4f 26 9c 0e 47 6b  75 79 4e da 8e 43 8b e6  |.{O&..GkuyN..C..|
+000000d0  6a 25 0d 47 50 bf 26 c8  16 70 41 1c b2 b5 cd d1  |j%.GP.&..pA.....|
+000000e0  34 9b 26 13 92 45 b5 f5  03 04 cf 55 ee ff c8 e6  |4.&..E.....U....|
+000000f0  92 9e 04 d9 c5 f5 fd 0f  17 03 03 02 6d f6 33 26  |............m.3&|
+00000100  26 da 41 f2 4e 6e ed 41  23 44 29 5f 43 38 7d 24  |&.A.Nn.A#D)_C8}$|
+00000110  f7 a1 01 d4 23 a5 bf 85  db 39 86 27 ff 9c e9 ac  |....#....9.'....|
+00000120  6c 0e 0e 51 c7 95 8d aa  f6 59 53 0a 89 d4 e7 2d  |l..Q.....YS....-|
+00000130  6e f8 66 7d e5 b2 ac e4  7b b2 91 2b 31 c9 2b 4e  |n.f}....{..+1.+N|
+00000140  92 8f a9 c8 79 21 9a 8f  a2 79 29 47 c4 ef ab 80  |....y!...y)G....|
+00000150  25 02 d6 8c ae 32 3b 1a  55 0e f9 4a ba 92 b9 61  |%....2;.U..J...a|
+00000160  86 39 04 0a a7 d6 eb 95  50 4f 86 1b c9 d1 1d 1e  |.9......PO......|
+00000170  61 06 43 00 c2 2a a9 e2  06 ff ce 4a fd 6f d0 19  |a.C..*.....J.o..|
+00000180  2a 0e ec 14 86 19 9c bc  1d 96 e1 b1 00 b2 19 c4  |*...............|
+00000190  15 64 4c 33 54 89 fc 15  01 90 13 3b ff 99 e6 23  |.dL3T......;...#|
+000001a0  19 38 4f 67 97 ee ab b3  9f ca 1f 18 7d 45 ef 87  |.8Og........}E..|
+000001b0  42 7b 57 51 d0 c3 43 50  35 a3 33 ff 19 df 54 8e  |B{WQ..CP5.3...T.|
+000001c0  e9 98 2f 46 93 87 b4 b1  c2 73 04 4f 06 5b 3c 0a  |../F.....s.O.[<.|
+000001d0  c3 87 6c 68 68 b4 61 a2  33 bd 11 06 93 19 fb 05  |..lhh.a.3.......|
+000001e0  c3 e6 3f 14 e5 a6 6d ec  48 56 a6 37 60 81 a4 cd  |..?...m.HV.7`...|
+000001f0  89 b5 4e c8 dc 99 79 66  5e 40 44 de 4a 22 9a ce  |..N...yf^@D.J"..|
+00000200  3d c4 a0 17 03 45 e6 28  70 27 f5 24 e1 81 7a 5f  |=....E.(p'.$..z_|
+00000210  5d 6e 6c bc 28 c3 fb b1  8b 18 fa 3d 9d f3 c3 a5  |]nl.(......=....|
+00000220  f0 41 7a 0d 87 c1 70 77  d3 3a fa ef 2b 11 9b 61  |.Az...pw.:..+..a|
+00000230  12 f8 d1 25 73 bc 79 bf  ee 9a 5e e0 3b fb 06 da  |...%s.y...^.;...|
+00000240  7e d6 08 aa 13 73 8a 8c  97 d7 5a e4 dc 88 51 60  |~....s....Z...Q`|
+00000250  8c 61 51 65 f6 d0 4e 7d  b0 b1 23 2c 69 77 20 fe  |.aQe..N}..#,iw .|
+00000260  d1 ff 13 57 d8 c5 58 1f  3c e9 86 f4 3a 45 1a 9c  |...W..X.<...:E..|
+00000270  c2 e0 4d da 67 1b 81 62  bf 07 de a6 ea 74 81 e3  |..M.g..b.....t..|
+00000280  ba 1b 1f bf b0 d3 d3 08  c0 23 5f 05 d5 1f 41 51  |.........#_...AQ|
+00000290  f2 11 2e 36 ed 00 f8 b5  ea f1 4c 0b b8 d0 a3 cc  |...6......L.....|
+000002a0  c6 a7 2a ee 1f 6c 6b 33  0d 38 5b 5c 6e f4 53 d2  |..*..lk3.8[\n.S.|
+000002b0  6e 90 5b ce 44 e7 f1 50  1e 12 21 76 35 d1 2f 49  |n.[.D..P..!v5./I|
+000002c0  a1 27 66 00 93 27 27 34  5d e5 ed 4b 6f 7e 3d e3  |.'f..''4]..Ko~=.|
+000002d0  78 de 2f 48 9f 4c 36 a7  5d 62 98 1e 2c ee 82 3c  |x./H.L6.]b..,..<|
+000002e0  18 17 2d 80 f4 a2 ac e9  a6 c8 2c b9 92 d1 9e 2b  |..-.......,....+|
+000002f0  5f 3e 33 56 03 b5 76 51  ea c7 af 1c 42 8e 0e 65  |_>3V..vQ....B..e|
+00000300  f7 0f ad 36 9f fe b5 a0  06 31 f0 89 02 b4 bf c3  |...6.....1......|
+00000310  8e 2f 52 4d 97 99 dd 95  0f c4 32 9e 81 55 d1 2a  |./RM......2..U.*|
+00000320  05 ff b5 7a 02 0f 6f 1b  ef f1 de 48 dc a8 f8 44  |...z..o....H...D|
+00000330  35 8c eb df 6b 78 cd 89  75 ca ef 31 ba 8f b8 ff  |5...kx..u..1....|
+00000340  a3 74 39 ce 42 a0 01 8b  db 68 34 21 0a bf 84 fd  |.t9.B....h4!....|
+00000350  5f 28 87 d4 09 b2 91 c2  f3 1f b8 39 da 2b 55 3c  |_(.........9.+U<|
+00000360  46 a2 fa 3d 65 eb 41 0c  37 c8 17 03 03 00 99 e8  |F..=e.A.7.......|
+00000370  25 eb 99 2f 80 e2 09 ed  2f b9 78 90 7c dc e2 4a  |%../..../.x.|..J|
+00000380  78 19 49 46 a8 e7 82 a0  85 84 71 da 80 fb d2 5d  |x.IF......q....]|
+00000390  28 c4 69 cf ac 1c bc 1e  ba 90 5c 0a ec dd 31 5c  |(.i.......\...1\|
+000003a0  87 d0 4f 31 3f 62 cd 91  1e 99 a5 08 c6 de 6c 75  |..O1?b........lu|
+000003b0  91 be 31 83 12 5b fd 5a  eb 96 ae 70 9c 06 c9 ee  |..1..[.Z...p....|
+000003c0  63 e9 3c a0 5b 9c 55 cb  cd 9d a2 31 33 17 92 fa  |c.<.[.U....13...|
+000003d0  dc 34 20 43 71 92 8b 16  dd 1c 29 f5 ec a2 e4 ad  |.4 Cq.....).....|
+000003e0  d6 21 27 37 32 0c 7b f1  60 7f 58 aa fc d6 ae f3  |.!'72.{.`.X.....|
+000003f0  c9 7b 5f 59 39 cf 79 ab  5b a3 7e ea 13 72 51 9f  |.{_Y9.y.[.~..rQ.|
+00000400  a9 c5 fc fb c0 da 39 2a  17 03 03 00 35 b7 6d ed  |......9*....5.m.|
+00000410  8d d3 c6 09 fd 9b 6b be  6e bc 01 64 3b a1 4e 2d  |......k.n..d;.N-|
+00000420  3d 85 e3 5b 4b 7b 44 49  81 fd c8 d9 07 fe e5 53  |=..[K{DI.......S|
+00000430  ab 5f a3 64 f6 be 22 79  80 52 f0 ee 3c 1e 4e 65  |._.d.."y.R..<.Ne|
+00000440  0e e3                                             |..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 02 1e e0 29 6d d1 38  |............)m.8|
-00000010  a6 03 d7 fc 2b df a4 a4  d0 ae 87 01 b8 82 5d eb  |....+.........].|
-00000020  3c 25 3e a1 33 89 b5 05  eb bc 02 0f ad 84 f0 2b  |<%>.3..........+|
-00000030  5f 14 af 0d f8 f1 08 e3  ca c1 8e ad 4b a5 a0 09  |_...........K...|
-00000040  b8 a0 4f bf e4 0f 93 a9  4a 35 35 26 22 d7 04 03  |..O.....J55&"...|
-00000050  70 95 4f 80 df d4 47 5b  21 14 27 d6 17 ea 32 6e  |p.O...G[!.'...2n|
-00000060  ea 3a ca 31 7c f2 d1 46  a2 ef 47 b9 16 d6 18 d5  |.:.1|..F..G.....|
-00000070  17 35 71 9d 14 37 63 cd  e1 c6 ff 3d ec a5 d8 53  |.5q..7c....=...S|
-00000080  48 d5 d8 0b 75 39 c1 d2  66 ad 97 4e 5f eb c3 c7  |H...u9..f..N_...|
-00000090  e0 77 95 fd 16 84 e2 a3  6a f2 a8 88 5e 4c 86 be  |.w......j...^L..|
-000000a0  81 a5 f2 6b 12 86 63 f1  4f a6 8d 63 7c 07 0f 8d  |...k..c.O..c|...|
-000000b0  53 d5 d4 00 c7 b7 2a ef  b2 1d 07 4e 43 d6 25 35  |S.....*....NC.%5|
-000000c0  c9 b1 fa 91 d1 f7 87 c6  98 c7 e7 c2 c3 7d 42 09  |.............}B.|
-000000d0  e5 3c 50 83 1b 20 ef ec  e4 ac 2e f2 3e 03 73 52  |.<P.. ......>.sR|
-000000e0  2e 1d 20 cf e2 8d 15 c3  c7 a6 2f 68 b5 8e 5f bc  |.. ......./h.._.|
-000000f0  c5 73 61 ff 52 3c b0 7b  47 82 47 a0 73 f8 1c ab  |.sa.R<.{G.G.s...|
-00000100  4d ea 15 fa 94 e0 7f 70  c1 c8 9c 55 f0 96 38 42  |M......p...U..8B|
-00000110  76 d4 26 6d a7 73 11 59  43 19 2f 49 70 a9 18 1c  |v.&m.s.YC./Ip...|
-00000120  12 9e ee d3 eb ca 1c c0  3b e1 99 e3 c2 25 de 39  |........;....%.9|
-00000130  1a 15 e0 d7 20 9d 1b 95  74 8c ee 96 7b 5e de 13  |.... ...t...{^..|
-00000140  99 56 54 a2 31 7b e9 96  02 9e 86 7b 15 9d c6 3e  |.VT.1{.....{...>|
-00000150  24 a5 19 e5 8e de 85 97  05 68 4f 39 d1 49 05 c9  |$........hO9.I..|
-00000160  7a 54 90 29 e7 93 ec 8e  6f cc 73 73 82 7d 72 8d  |zT.)....o.ss.}r.|
-00000170  4a 85 29 7f a5 53 13 26  16 b2 fa c3 ce 1f 8b ae  |J.)..S.&........|
-00000180  e6 60 8c 2d b0 64 66 d4  29 7c b5 2d 1d 11 c5 09  |.`.-.df.)|.-....|
-00000190  bb a5 44 c6 c8 af e6 f1  d5 f8 d9 45 97 64 7f 03  |..D........E.d..|
-000001a0  02 f7 f5 9f cb 31 1e 89  e4 5d a0 e9 34 db be 28  |.....1...]..4..(|
-000001b0  51 15 68 54 01 7c e5 1d  b4 05 d2 d6 24 ca 10 69  |Q.hT.|......$..i|
-000001c0  31 bf 8b 7a ee d9 bf e1  2a d4 7c c8 e8 79 ca dd  |1..z....*.|..y..|
-000001d0  0f 73 09 c8 cf 97 28 78  04 5b 04 51 44 c4 5f d1  |.s....(x.[.QD._.|
-000001e0  dc da 4f f5 d9 5c 9c b1  ea f8 1b f7 43 90 c0 c0  |..O..\......C...|
-000001f0  fd 82 56 e3 71 15 18 5e  7e 5c 61 5e b3 80 c1 1c  |..V.q..^~\a^....|
-00000200  22 92 32 67 23 f6 3b 74  e4 20 4e 1f fb f8 89 55  |".2g#.;t. N....U|
-00000210  e7 3c 18 30 24 77 7c 33  5c 89 91 60 65 14 06 9e  |.<.0$w|3\..`e...|
-00000220  e2 6d f0 07 84 4b b4 14  e8 17 03 03 00 a3 a7 e1  |.m...K..........|
-00000230  f7 26 48 56 da 6d ef a5  f4 5f 19 52 37 9e e7 6d  |.&HV.m..._.R7..m|
-00000240  28 07 70 ee 1e de 85 2b  7a 2d bf eb 48 06 f5 d4  |(.p....+z-..H...|
-00000250  ea 4d 83 86 59 d4 14 4f  46 bc 17 89 f1 f5 37 0e  |.M..Y..OF.....7.|
-00000260  84 60 6e ba 73 d7 c1 bc  6f d7 aa cf f0 36 96 a2  |.`n.s...o....6..|
-00000270  83 60 81 6f 48 6c 9d 87  e5 b6 5e 77 ab c5 e3 cb  |.`.oHl....^w....|
-00000280  8e 55 94 dc 94 f3 8a ce  cb f7 b4 d5 33 55 df 88  |.U..........3U..|
-00000290  22 44 04 ee 4e f5 30 e7  30 94 dc 95 2d 97 2c e4  |"D..N.0.0...-.,.|
-000002a0  34 58 4d 38 9e 25 61 96  c1 37 66 34 2b be ee e6  |4XM8.%a..7f4+...|
-000002b0  ee 39 73 89 a3 aa 1b 0a  5a bf 44 23 4e 19 5c c4  |.9s.....Z.D#N.\.|
-000002c0  3f 27 47 5c 40 67 6c 50  b8 3f 7c c9 97 f0 55 02  |?'G\@glP.?|...U.|
-000002d0  16 17 03 03 00 35 82 8b  0d 4e 87 3c c6 bc 41 8b  |.....5...N.<..A.|
-000002e0  ec ab 71 9d 57 7b e6 22  e4 87 82 61 5d f8 69 31  |..q.W{."...a].i1|
-000002f0  8a 2c be 2c d8 4d 2f dc  9a 91 31 7a ab d8 a4 0e  |.,.,.M/...1z....|
-00000300  ba cb fc ef 17 a4 7c 87  ca 13 bb 17 03 03 00 13  |......|.........|
-00000310  3b d0 da 9f d4 be fa 59  7a 30 8b 7e 8e a0 99 c0  |;......Yz0.~....|
-00000320  c2 36 f3                                          |.6.|
+00000000  14 03 03 00 01 01 17 03  03 02 1e a8 48 8d 47 f6  |............H.G.|
+00000010  3d d8 59 5b 26 9e bd fc  d1 15 7c e1 37 1b db 3c  |=.Y[&.....|.7..<|
+00000020  e4 02 98 fd aa cc a6 45  97 6e c5 18 4e 45 8e d6  |.......E.n..NE..|
+00000030  84 7a b5 e4 da 8b 17 34  e5 fb 21 3c f6 02 c2 5c  |.z.....4..!<...\|
+00000040  ea 57 ea 16 67 4a 6d b2  0e 5a 39 f8 6b 11 84 bd  |.W..gJm..Z9.k...|
+00000050  43 80 03 40 5e d2 d2 54  2e d1 38 bc 9a 16 4f 21  |C..@^..T..8...O!|
+00000060  0e 07 38 b5 80 21 16 c6  a1 bb 23 79 a6 df ef 27  |..8..!....#y...'|
+00000070  dc 30 3c 4a 53 b1 5c 54  a7 fb ff 73 e2 12 ab 90  |.0<JS.\T...s....|
+00000080  39 2a c7 8d 8f 9c 99 02  5a cc fe ab 00 0b 69 6e  |9*......Z.....in|
+00000090  04 cd 8c 46 68 59 dc f9  cc ef f6 dd 01 7a 69 29  |...FhY.......zi)|
+000000a0  38 50 a2 37 bf 68 8b 3a  8a 7e 88 57 57 35 5f 65  |8P.7.h.:.~.WW5_e|
+000000b0  e8 d3 b0 5d 98 41 f2 32  51 9f 8f a3 83 2f 50 42  |...].A.2Q..../PB|
+000000c0  97 59 71 8a 7c 93 2c ae  ad 94 d5 87 d3 54 fc 06  |.Yq.|.,......T..|
+000000d0  fb 0f 8f 06 0f fe ec 59  38 fc e7 e0 86 45 c2 ce  |.......Y8....E..|
+000000e0  0c e2 d3 ac 0a 34 30 21  a7 cb 1e 6d c4 41 93 81  |.....40!...m.A..|
+000000f0  cd 7d 0b 10 cb 77 0d e4  5f d9 af 49 ff 11 fb 87  |.}...w.._..I....|
+00000100  d4 2b 54 78 52 86 c6 43  e1 da fb da 60 e3 76 1a  |.+TxR..C....`.v.|
+00000110  ed 0e f1 bd 33 e9 70 fa  1c 6e 75 3a 99 08 0e 9f  |....3.p..nu:....|
+00000120  e2 cd 2e a0 d0 a2 ea bd  85 44 ee 4f 93 fd 84 0b  |.........D.O....|
+00000130  d2 7b af da 5c ab c9 10  45 f0 eb e5 87 19 fd 79  |.{..\...E......y|
+00000140  80 02 da aa 25 72 15 f2  1e 5c f0 63 f5 a2 be 7c  |....%r...\.c...||
+00000150  a3 4d f5 de 92 2e 15 3a  c7 54 cf 88 c3 01 89 82  |.M.....:.T......|
+00000160  12 fb fa 92 5b 8d e0 b9  27 44 0a ed 0c b5 3c eb  |....[...'D....<.|
+00000170  72 e0 23 2d 9d f9 d4 0e  f3 c0 24 c7 1d d9 5b 02  |r.#-......$...[.|
+00000180  35 49 51 77 fb 84 58 75  72 2b 4b c1 cd dc 7d 39  |5IQw..Xur+K...}9|
+00000190  c0 9b dd cd f8 48 af 9a  00 ed 5b 92 85 18 24 8a  |.....H....[...$.|
+000001a0  4b 47 59 18 be 3e b5 fe  2a ce 8c 60 af 64 7e 71  |KGY..>..*..`.d~q|
+000001b0  45 26 b8 91 26 cc d6 bf  d5 4d 26 3f 4f c8 73 99  |E&..&....M&?O.s.|
+000001c0  a7 50 9d 14 09 b6 07 1a  af aa 9b 02 31 b2 c6 22  |.P..........1.."|
+000001d0  ca 3e e0 2f 27 87 27 2e  96 f4 b4 ba c6 01 77 d3  |.>./'.'.......w.|
+000001e0  52 09 ea 79 9b ee b4 6a  41 29 b1 de de 74 6b b2  |R..y...jA)...tk.|
+000001f0  11 b1 58 90 5c 6a 0d b5  51 4b 2e 1b 3e e6 f4 17  |..X.\j..QK..>...|
+00000200  8e 8a 1d 1e c8 bd 55 3a  fc f4 90 73 14 5f 63 1b  |......U:...s._c.|
+00000210  22 f0 81 fd 70 05 ca b2  fd 90 3c 9d 2e 73 d3 8c  |"...p.....<..s..|
+00000220  f0 0a 59 9e 46 fe 8c e2  22 17 03 03 00 a4 78 2b  |..Y.F...".....x+|
+00000230  ec c5 5e 71 85 c6 e5 5d  75 f3 b5 3d 55 de 1c f9  |..^q...]u..=U...|
+00000240  06 92 be df ef 77 31 4b  f3 13 b8 c7 7a 68 ec 1b  |.....w1K....zh..|
+00000250  e2 7c c0 ff b5 6f c2 62  bd 34 23 fd 6a 39 c7 ef  |.|...o.b.4#.j9..|
+00000260  91 47 77 7e 32 2e a9 b2  85 ae 01 3e 61 43 8a 93  |.Gw~2......>aC..|
+00000270  72 14 e1 b7 a5 14 4b ca  6e cb 4d e7 a3 cd 74 98  |r.....K.n.M...t.|
+00000280  4e 08 a4 d4 34 ea 73 17  4b 20 8b 40 03 10 a0 33  |N...4.s.K .@...3|
+00000290  c9 2f c0 4c 3b a2 2c 61  3c ab ec e3 c0 e8 e2 d6  |./.L;.,a<.......|
+000002a0  a0 85 fa 26 26 a9 65 dc  70 5b 8f b7 3f 9e b3 fb  |...&&.e.p[..?...|
+000002b0  44 36 62 79 75 af ef 94  05 6b d2 44 07 51 ae 91  |D6byu....k.D.Q..|
+000002c0  ea e3 e7 d2 f4 2f 19 17  38 aa 1c ae cb 88 db 0b  |...../..8.......|
+000002d0  66 5a 17 03 03 00 35 6d  d9 23 d1 3c c3 25 7b 5d  |fZ....5m.#.<.%{]|
+000002e0  8a 1a 41 00 00 f8 0c a7  3e 53 4e e5 f6 cb 11 3f  |..A.....>SN....?|
+000002f0  9c 66 62 80 98 6c 55 19  b1 6f 00 5d 46 93 d2 0b  |.fb..lU..o.]F...|
+00000300  79 58 1c d6 d7 f9 fc fb  38 c5 32 63 17 03 03 00  |yX......8.2c....|
+00000310  13 72 a9 fd 60 5c cf 68  b3 32 15 04 33 1c e1 5f  |.r..`\.h.2..3.._|
+00000320  11 11 9e 8c                                       |....|
 >>> Flow 4 (server to client)
-00000000  17 03 03 02 90 a2 a0 e4  83 63 ad 8d d5 45 25 dc  |.........c...E%.|
-00000010  41 02 31 28 8d b0 87 85  66 b8 9c 36 f3 1f 97 87  |A.1(....f..6....|
-00000020  8c c9 e6 b4 67 1e 42 ab  84 c4 eb 0a 41 b1 0f 50  |....g.B.....A..P|
-00000030  25 c3 7e 69 20 cf 8a d0  56 79 61 e3 e1 5b cc a4  |%.~i ...Vya..[..|
-00000040  24 5a c7 2d 3b 17 33 92  59 6c 7e 29 a9 a2 2c 73  |$Z.-;.3.Yl~)..,s|
-00000050  3e b1 65 32 3d 6a 2b 61  5d 76 c4 66 0e 4f f1 da  |>.e2=j+a]v.f.O..|
-00000060  dd d3 7e 29 3d f5 42 99  9e 04 60 a4 9a a1 c0 f7  |..~)=.B...`.....|
-00000070  54 4e d5 58 73 85 02 83  38 ba 4e 93 9a 69 68 07  |TN.Xs...8.N..ih.|
-00000080  71 c9 a7 e4 83 51 4c 11  21 26 b2 dd ad 4b 2a ef  |q....QL.!&...K*.|
-00000090  23 9b b0 f6 d6 96 9f 99  1f 69 fe 35 28 86 49 bc  |#........i.5(.I.|
-000000a0  ec 97 11 4d 4e b7 c1 c2  da 6c ae c7 40 b9 2a 1f  |...MN....l..@.*.|
-000000b0  ff 9d 9d ea 90 b9 61 6f  76 ae fe 55 70 f6 ee 54  |......aov..Up..T|
-000000c0  54 62 6d 19 9a fc 40 16  e5 c2 e2 3e d1 68 c6 09  |Tbm...@....>.h..|
-000000d0  be 54 64 25 8a a0 2b e6  b3 14 7e 74 17 91 f0 de  |.Td%..+...~t....|
-000000e0  87 e8 3c 3e 58 8d 1b b2  4e 2d 7d c1 f8 aa 16 ca  |..<>X...N-}.....|
-000000f0  2a 3e 8f aa 52 14 e4 f2  2a b9 6e 62 46 ab ed 3a  |*>..R...*.nbF..:|
-00000100  ff a1 51 53 92 7a 78 c4  ed 9d fd 1f b4 62 2e e7  |..QS.zx......b..|
-00000110  cc 9d 09 fa 06 2e 9e 55  e5 98 9e b8 be e9 12 94  |.......U........|
-00000120  33 58 6b be 71 a1 4f f8  a0 83 85 f8 7e b4 28 a7  |3Xk.q.O.....~.(.|
-00000130  ee 1b ac 3c 46 b6 ac 60  af 5d cc b0 a8 2c 3f 95  |...<F..`.]...,?.|
-00000140  75 2a 73 ac 02 7e d8 04  21 fc 68 d7 6f 1d 31 40  |u*s..~..!.h.o.1@|
-00000150  43 81 26 b7 00 5f 77 d9  21 7b b4 7c cd 9f 89 69  |C.&.._w.!{.|...i|
-00000160  ef 11 0c 60 db 22 94 98  eb 10 d9 0c 0e 29 c2 d9  |...`.".......)..|
-00000170  74 8d 71 25 b8 5a c1 13  d6 f6 01 58 6d 71 31 7c  |t.q%.Z.....Xmq1||
-00000180  66 e8 e5 36 06 b3 e4 51  0c b1 43 88 bf 2b 54 d7  |f..6...Q..C..+T.|
-00000190  52 79 3d 07 a9 c2 e5 97  cc 79 87 b1 c7 8b 30 7b  |Ry=......y....0{|
-000001a0  b1 fe 90 58 35 a1 dc 18  8a fa cc df 63 2b 72 57  |...X5.......c+rW|
-000001b0  14 e1 12 4c bc d7 ba c2  e5 f7 4c 40 d6 34 ea 11  |...L......L@.4..|
-000001c0  8f be 3d 7a 34 11 c1 1a  ad f8 2e 89 94 8a 3a ce  |..=z4.........:.|
-000001d0  e5 8f e8 bc 77 71 38 8c  3c 6e 29 a3 1a 14 9d 3d  |....wq8.<n)....=|
-000001e0  a3 28 46 32 38 f0 14 74  ff 9b 99 71 65 ab ef c8  |.(F28..t...qe...|
-000001f0  67 ab 47 91 61 d1 af cf  7d 96 89 d5 57 17 96 d3  |g.G.a...}...W...|
-00000200  30 d5 fb 74 3b b8 df 77  98 7b 04 3e a1 a8 5a f1  |0..t;..w.{.>..Z.|
-00000210  6b 5c d2 4d b2 20 35 63  9e 83 c0 7e 83 60 46 57  |k\.M. 5c...~.`FW|
-00000220  c0 80 0d d7 b9 9f 14 c0  58 2d 48 2a cc 8c 1d 32  |........X-H*...2|
-00000230  2c 34 ec 10 f2 34 b4 28  e1 0e 83 38 c4 2e 5a 09  |,4...4.(...8..Z.|
-00000240  ff e6 3f d3 9a 32 8e 33  9e 31 18 e5 1d 6b 97 12  |..?..2.3.1...k..|
-00000250  9b 93 84 86 62 8a 0a 8a  ab 8d 37 68 af a1 ec 8e  |....b.....7h....|
-00000260  38 c8 47 ef 10 f8 64 7c  e1 13 0a 33 eb c2 4b bf  |8.G...d|...3..K.|
-00000270  47 49 6d 93 3c c9 44 aa  74 67 a9 93 dd de 66 47  |GIm.<.D.tg....fG|
-00000280  1e b3 55 47 b1 16 88 68  82 24 d6 b8 81 b0 5a b6  |..UG...h.$....Z.|
-00000290  27 7a f8 0b 5c 17 03 03  00 1e a5 9b 8c d2 3e 96  |'z..\.........>.|
-000002a0  f3 49 7a ed d9 fc 33 62  15 12 43 76 11 f9 dc fc  |.Iz...3b..Cv....|
-000002b0  ea d2 d7 87 22 6f 9e 3d  17 03 03 00 13 e1 30 4e  |...."o.=......0N|
-000002c0  4c 1d 02 78 57 a5 ee 8f  1c 5f 19 f0 57 3a 8d 7e  |L..xW...._..W:.~|
+00000000  17 03 03 02 90 2e 71 49  81 51 71 9c 2f da 1e dc  |......qI.Qq./...|
+00000010  22 c0 a2 59 13 ad 41 ae  7b 18 56 d0 00 7b b5 cf  |"..Y..A.{.V..{..|
+00000020  47 e7 bc 8e 92 9e dc 88  78 3e 40 8e 8b 01 b0 30  |G.......x>@....0|
+00000030  8f 7e 88 95 77 ed de 31  bf c5 78 ba a1 44 55 ec  |.~..w..1..x..DU.|
+00000040  b6 df 49 a9 df a0 92 b2  be b7 2c 1c 39 1b a0 63  |..I.......,.9..c|
+00000050  18 e5 12 b7 5a a5 85 14  97 7d 9e e1 80 b7 15 c5  |....Z....}......|
+00000060  2f ca e3 3b 48 91 42 07  f4 49 25 99 2c ee b8 b5  |/..;H.B..I%.,...|
+00000070  05 a2 34 7d bb c0 87 4c  f3 a8 07 89 fe b7 08 2c  |..4}...L.......,|
+00000080  e2 0b 27 6f 49 88 80 2f  3b 9c ae a6 3e 38 74 23  |..'oI../;...>8t#|
+00000090  53 70 f5 84 0f 77 d4 94  68 f9 86 18 2f dc e1 94  |Sp...w..h.../...|
+000000a0  3c e1 2c f2 84 07 f5 3c  88 99 63 ef a1 96 73 f9  |<.,....<..c...s.|
+000000b0  46 43 c2 92 be 04 b8 6b  9e db e1 7f 63 b1 d4 15  |FC.....k....c...|
+000000c0  36 2c 37 e3 c2 24 b2 4c  c5 60 96 15 3b 20 01 67  |6,7..$.L.`..; .g|
+000000d0  e5 52 9a 4f 17 6c 0a f1  a0 a3 31 48 e5 31 8e d3  |.R.O.l....1H.1..|
+000000e0  b9 49 38 d2 55 4d 40 8e  a2 bf dd 0f 19 25 42 55  |.I8.UM@......%BU|
+000000f0  06 57 22 c5 06 c9 59 13  f7 c7 56 b1 68 20 f4 62  |.W"...Y...V.h .b|
+00000100  19 0a 5d ab 5f 81 c6 50  b7 a2 f8 ce 55 f2 b6 6c  |..]._..P....U..l|
+00000110  67 39 75 82 1b a1 6b 85  58 37 c0 a5 12 64 a6 ee  |g9u...k.X7...d..|
+00000120  2e f8 f0 dc d2 50 08 47  0f 15 c8 37 2d ba 69 64  |.....P.G...7-.id|
+00000130  e9 ea 7b fa 16 91 ed b6  24 0d fb e8 aa 74 6b 74  |..{.....$....tkt|
+00000140  2d 78 2d 1c 2b 98 8e ab  74 6d 06 a3 00 8a e5 be  |-x-.+...tm......|
+00000150  c0 68 09 05 e0 95 0d c1  27 8a cf 05 09 0a 7c b9  |.h......'.....|.|
+00000160  a1 3a 9b 45 3d d4 5d 16  64 5b d5 a3 6c d2 12 78  |.:.E=.].d[..l..x|
+00000170  4f 6b ba 3a fe ad 35 9e  5e 0c 5f d4 f3 32 a2 0b  |Ok.:..5.^._..2..|
+00000180  f1 af d4 e5 f1 91 c6 6c  47 6b 30 a7 2f bf 60 05  |.......lGk0./.`.|
+00000190  e3 c0 2d 9c 34 f2 f0 6b  f2 ce 7f 19 d0 86 26 b0  |..-.4..k......&.|
+000001a0  e1 7e 7b e0 0e 3d e7 f6  3c 7f 42 bc 9f a6 0a 25  |.~{..=..<.B....%|
+000001b0  eb cf 1b 4b 44 10 df 7d  f1 1f e3 a9 ea 4f 6d 52  |...KD..}.....OmR|
+000001c0  70 b2 f0 0b a9 c5 bc 66  46 21 4d 92 c4 c3 f6 71  |p......fF!M....q|
+000001d0  eb 46 c0 f3 e7 6f 4a ee  37 ad 8a ea 3b aa 51 79  |.F...oJ.7...;.Qy|
+000001e0  d5 d5 18 7e e8 ae 31 1a  db 16 04 d8 3c 94 17 f6  |...~..1.....<...|
+000001f0  ad 8f 8b 5d 7d 14 fb b4  e9 b4 7e bb 75 f1 df de  |...]}.....~.u...|
+00000200  6f 0a 0d a8 f9 b5 d8 53  73 36 88 77 db e6 0e 84  |o......Ss6.w....|
+00000210  fc 94 6b c9 cc 74 0f 01  40 39 c4 d0 66 2d 23 76  |..k..t..@9..f-#v|
+00000220  9f 0d a1 53 94 a2 dd 56  83 9e 62 39 10 13 39 40  |...S...V..b9..9@|
+00000230  55 09 b6 77 d2 22 9c 49  ef f9 af 93 ee d1 cf 3d  |U..w.".I.......=|
+00000240  1f 29 ef 27 94 3c 6d 23  d6 7c 33 e1 f7 cd 70 05  |.).'.<m#.|3...p.|
+00000250  ba c1 c3 88 d9 d4 10 22  47 74 01 27 75 f2 7b 72  |......."Gt.'u.{r|
+00000260  95 8a 19 e3 4b e1 61 2e  b2 a5 13 31 84 b1 30 74  |....K.a....1..0t|
+00000270  67 b9 55 df 4b ff ac 15  2a 01 d5 4f 2b c3 49 ee  |g.U.K...*..O+.I.|
+00000280  28 a3 aa 28 0e 51 9e 68  32 70 89 58 07 ba 07 72  |(..(.Q.h2p.X...r|
+00000290  f0 46 b4 ad d2 17 03 03  00 1e fe 98 35 5f 4c be  |.F..........5_L.|
+000002a0  c0 66 51 92 14 0c 3e 5a  eb 02 7e e2 99 69 37 e3  |.fQ...>Z..~..i7.|
+000002b0  b0 90 43 11 e6 76 5e 2d  17 03 03 00 13 4b 69 75  |..C..v^-.....Kiu|
+000002c0  3d 46 35 f6 85 4b 0b 6e  f4 6b 30 2a 28 37 3c f1  |=F5..K.n.k0*(7<.|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndEd25519Given b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndEd25519Given
index 6943bf6569..016b7da4df 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndEd25519Given
+++ b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndEd25519Given
@@ -1,149 +1,151 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 e4 83 a9 75 06  |..............u.|
-00000010  0f 8b c9 35 1e 62 89 7f  a8 df 7c 93 b6 f0 8f 94  |...5.b....|.....|
-00000020  ea 31 dc 66 11 66 bd 77  33 54 bf 20 38 77 15 8d  |.1.f.f.w3T. 8w..|
-00000030  b4 21 50 72 6f 95 61 6c  15 b8 35 c9 92 10 72 99  |.!Pro.al..5...r.|
-00000040  bc 41 03 53 7c 5e 7b b3  a4 2e b4 19 00 04 13 01  |.A.S|^{.........|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 c3 82 3b bf 9c  |.............;..|
+00000010  31 25 31 c7 8d 18 7f c1  28 22 0f 23 0c 13 b8 81  |1%1.....(".#....|
+00000020  a8 e8 35 00 92 0a 13 21  8d 76 43 20 9e 3a 45 91  |..5....!.vC .:E.|
+00000030  73 a0 99 70 ab 96 99 2b  ae 4a b1 2a 89 3c 74 94  |s..p...+.J.*.<t.|
+00000040  27 3f 71 16 d0 e6 86 a0  e6 61 9d 7a 00 04 13 01  |'?q......a.z....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 8e  |-.....3.&.$... .|
-000000b0  cf 32 24 aa f2 36 c7 41  50 66 dd 57 ce 97 72 8d  |.2$..6.APf.W..r.|
-000000c0  f3 b6 7d a0 a4 5e 5d fe  be bb ce 32 9f 03 75     |..}..^]....2..u|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 f5  |-.....3.&.$... .|
+000000b0  99 bf 34 6f 97 37 52 fd  ed 12 2f 60 bc 2b 0a ce  |..4o.7R.../`.+..|
+000000c0  17 a8 80 db d0 23 6d 82  04 03 78 81 b7 07 01     |.....#m...x....|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 38 77 15 8d  |........... 8w..|
-00000030  b4 21 50 72 6f 95 61 6c  15 b8 35 c9 92 10 72 99  |.!Pro.al..5...r.|
-00000040  bc 41 03 53 7c 5e 7b b3  a4 2e b4 19 13 01 00 00  |.A.S|^{.........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 9e 3a 45 91  |........... .:E.|
+00000030  73 a0 99 70 ab 96 99 2b  ae 4a b1 2a 89 3c 74 94  |s..p...+.J.*.<t.|
+00000040  27 3f 71 16 d0 e6 86 a0  e6 61 9d 7a 13 01 00 00  |'?q......a.z....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 3b ca 9a d3 b7 99  |..........;.....|
-00000090  d7 d8 c9 f9 96 b8 70 69  3b 22 42 0f c4 72 de 7c  |......pi;"B..r.||
-000000a0  05 17 03 03 00 3e 38 d7  00 60 b9 ce 17 31 26 9f  |.....>8..`...1&.|
-000000b0  db ef e2 b1 99 55 c8 f9  f3 a0 81 19 12 a7 63 85  |.....U........c.|
-000000c0  5a 26 2d d1 1c ad 5d ae  d6 4b 66 93 62 d7 fe 08  |Z&-...]..Kf.b...|
-000000d0  40 e9 fa 16 8b 89 f8 04  e8 33 67 20 2b 21 91 a0  |@........3g +!..|
-000000e0  c6 0a 87 ff 17 03 03 02  6d 79 97 6c 2f f6 01 7b  |........my.l/..{|
-000000f0  3a 49 0e 1a 00 96 10 fd  7f 77 db 76 b2 d4 e4 68  |:I.......w.v...h|
-00000100  46 4e 4f 3c 64 54 ca 27  9a 5c 78 98 f4 96 a4 fe  |FNO<dT.'.\x.....|
-00000110  29 e5 44 cb 6d 3e bd ce  89 15 c6 75 d8 28 00 da  |).D.m>.....u.(..|
-00000120  ff d8 ec 27 2c f2 4c e5  a0 6e 88 ce 67 6e 35 f4  |...',.L..n..gn5.|
-00000130  e5 d5 96 2d 40 af fa 88  12 8a 48 24 2c f9 82 f5  |...-@.....H$,...|
-00000140  cb a4 6e 95 a6 53 bc 79  f7 6a ef 66 77 bc 46 f0  |..n..S.y.j.fw.F.|
-00000150  1b 0d 6b 5c 76 82 15 c4  d0 1c dd ec cc ce 09 93  |..k\v...........|
-00000160  ce 21 55 9b d8 8a 11 1b  0c 24 fa 9e 5f 29 4a f1  |.!U......$.._)J.|
-00000170  2a 2e ad c0 6d 6d 46 06  5b c9 75 b3 3e 32 45 67  |*...mmF.[.u.>2Eg|
-00000180  05 26 cc d8 a8 4a a9 b1  67 71 a6 82 1c dc f0 15  |.&...J..gq......|
-00000190  6d 25 f5 6e be a2 5f 45  39 dc d1 2e df fa e1 e9  |m%.n.._E9.......|
-000001a0  48 ca 7a 78 fa 0e 53 d1  5c 8f c2 40 91 d5 fa 40  |H.zx..S.\..@...@|
-000001b0  7e a1 52 23 c8 56 1f 31  17 91 5c 38 bb 54 56 f3  |~.R#.V.1..\8.TV.|
-000001c0  1e 14 90 43 b7 ef fd 56  b5 ae 13 90 97 dc 60 15  |...C...V......`.|
-000001d0  67 72 fc c2 0a 32 90 be  ec de 69 16 d3 1b 22 2c  |gr...2....i...",|
-000001e0  25 9f 91 27 a7 6d 8c a4  de 02 fd 0e da bf ca 71  |%..'.m.........q|
-000001f0  77 9b 56 b8 07 e8 80 00  9b d9 36 1c 09 4f 9f 54  |w.V.......6..O.T|
-00000200  76 d5 76 f4 9a 03 94 bb  9e 93 f0 b5 3c a1 71 ec  |v.v.........<.q.|
-00000210  b3 83 3a 06 b4 46 97 bf  ef bb f0 26 94 4e b0 08  |..:..F.....&.N..|
-00000220  3b ec 81 20 66 92 11 85  a0 c2 90 fd c5 bc ae 39  |;.. f..........9|
-00000230  2c 87 ec e4 5d 59 ee b4  e9 0d f7 2a e0 3b 2a 94  |,...]Y.....*.;*.|
-00000240  1a 79 2f e8 5c 88 d3 61  2e 47 c0 f3 c4 01 84 a9  |.y/.\..a.G......|
-00000250  cf f6 36 13 cb 4b 0b f7  9a 14 f1 d5 0e 10 80 fd  |..6..K..........|
-00000260  11 79 20 20 ae 56 5e de  58 53 19 38 26 e2 ac bc  |.y  .V^.XS.8&...|
-00000270  0c 40 38 8b f9 67 62 4c  42 7d 18 4f 27 e9 53 96  |.@8..gbLB}.O'.S.|
-00000280  78 4b fa 44 fe c2 c3 d9  99 f2 2c 59 2b 2b 2c 88  |xK.D......,Y++,.|
-00000290  5b dc a8 98 3d 17 14 09  70 ce e4 02 8b 3c 5d 94  |[...=...p....<].|
-000002a0  44 ac ba 57 2d a9 bf b8  70 e9 b8 a8 c3 b8 90 da  |D..W-...p.......|
-000002b0  ec b1 b4 57 d6 e3 0f 41  82 bb 21 4a 57 dc ac 4b  |...W...A..!JW..K|
-000002c0  89 34 75 fc c4 56 6b 70  3d 83 2b fa be c8 2b cd  |.4u..Vkp=.+...+.|
-000002d0  f8 4f 9f 9e 9a 0e d2 d0  46 cd 21 a5 f7 07 a6 2a  |.O......F.!....*|
-000002e0  85 7b 30 92 78 a2 da a5  1d 1c 1c 54 63 4b 66 b2  |.{0.x......TcKf.|
-000002f0  f1 a7 c4 43 57 97 7f 28  37 e7 15 62 9b 1c f5 90  |...CW..(7..b....|
-00000300  0c 19 36 1a c1 48 48 e5  7d 56 93 3c 13 e3 cd 6a  |..6..HH.}V.<...j|
-00000310  aa aa ba d5 24 95 c7 df  9c a9 76 6c 07 bf 09 2d  |....$.....vl...-|
-00000320  4b 7b 55 94 37 ec d4 69  ce ab 0f 48 37 74 37 99  |K{U.7..i...H7t7.|
-00000330  83 0d 60 8a 73 56 fb e2  9e 0c 39 0e 23 bf 68 b2  |..`.sV....9.#.h.|
-00000340  92 51 12 bc cf 1b af 9d  7c fe 77 14 c8 66 4a 6f  |.Q......|.w..fJo|
-00000350  91 06 55 6a 11 61 17 03  03 00 99 c2 bf 26 a6 fa  |..Uj.a.......&..|
-00000360  67 16 a3 b9 1f 36 f8 4f  5d 59 b1 be 43 3a 70 01  |g....6.O]Y..C:p.|
-00000370  c0 3a 4b c5 20 b1 22 49  04 22 bb 7f 5f f4 bb f8  |.:K. ."I.".._...|
-00000380  35 03 0e dc ba ce de 2a  25 ea 96 dd 3d 64 34 90  |5......*%...=d4.|
-00000390  30 f8 34 22 bb e4 94 00  bb b3 ea 3c d2 87 90 9a  |0.4".......<....|
-000003a0  86 76 6b b7 e3 78 fc 35  10 50 ce b6 c0 71 52 ae  |.vk..x.5.P...qR.|
-000003b0  a5 f7 bf 8c 5e 5d c1 96  c7 92 6f f0 04 87 d9 a8  |....^]....o.....|
-000003c0  72 f4 9e ed 6d ab 28 42  7c c8 60 39 81 66 74 a1  |r...m.(B|.`9.ft.|
-000003d0  79 79 6a 59 02 29 b8 14  12 34 a7 96 8f e0 c1 d6  |yyjY.)...4......|
-000003e0  4e da e2 63 22 c1 60 b1  87 64 d3 80 b9 c4 df 9a  |N..c".`..d......|
-000003f0  5f 2c 22 91 17 03 03 00  35 9a 62 4d a2 ba 27 31  |_,".....5.bM..'1|
-00000400  fc 8e 23 cc 5f f0 5c 8c  9b c1 b0 ae 7b b8 fa e2  |..#._.\.....{...|
-00000410  f3 af 6c 6c ac 86 1e e1  2b 9f 14 a1 f3 5f b5 f9  |..ll....+...._..|
-00000420  76 b6 dd 73 f5 6a 08 29  f1 29 9e 79 87 aa        |v..s.j.).).y..|
+00000080  03 03 00 01 01 17 03 03  00 17 84 17 5a 31 cf 40  |............Z1.@|
+00000090  61 37 2b 5a 28 91 d9 e1  7b f2 50 14 8e 7b 40 30  |a7+Z(...{.P..{@0|
+000000a0  4b 17 03 03 00 52 ad d1  15 51 c8 89 48 44 23 64  |K....R...Q..HD#d|
+000000b0  8a b6 8d ac 08 47 ed 65  1d a3 ea cd 3c 89 43 4b  |.....G.e....<.CK|
+000000c0  36 28 4b b7 bc e4 93 93  ce 37 4c f5 63 ad 3b 3f  |6(K......7L.c.;?|
+000000d0  05 b9 92 56 88 35 89 30  5e 40 2d 46 ac 9d 1f ec  |...V.5.0^@-F....|
+000000e0  3d 0a 2a 32 d0 98 79 97  e2 93 2b b0 43 35 37 90  |=.*2..y...+.C57.|
+000000f0  64 e3 a6 fd 09 01 14 61  17 03 03 02 6d 3c 5b ed  |d......a....m<[.|
+00000100  d8 cf c6 d9 e4 b1 7b 15  dc a1 c1 f6 88 87 1a 5c  |......{........\|
+00000110  22 37 53 87 a7 10 13 50  1c 1c 65 70 09 67 f3 63  |"7S....P..ep.g.c|
+00000120  e7 63 88 76 50 45 e6 a8  1a 38 93 3b c0 ef fd c0  |.c.vPE...8.;....|
+00000130  17 c2 c5 04 d6 15 c6 e9  70 bd d2 be 9a 38 50 8a  |........p....8P.|
+00000140  2b 4c a2 ea 4e ad 80 09  8f 24 2c 17 4d 17 e4 d8  |+L..N....$,.M...|
+00000150  a1 47 13 fb 76 18 2d 04  8c 39 23 03 67 64 d2 d6  |.G..v.-..9#.gd..|
+00000160  3d c8 4f 1d 1c 59 44 08  80 52 6e f3 3f 90 35 bc  |=.O..YD..Rn.?.5.|
+00000170  7e 58 1e 16 2c b0 7d 89  2a 4a a9 53 5a 2a ce 65  |~X..,.}.*J.SZ*.e|
+00000180  c9 85 08 0b 6d e9 a4 9c  e7 25 30 49 3c 85 bb 83  |....m....%0I<...|
+00000190  7c 78 be 9d ee de 8f fb  01 d7 59 d5 4e 42 bc 21  ||x........Y.NB.!|
+000001a0  e6 ba ed 0c 84 3c 8a aa  70 43 8a 46 c5 7f 81 65  |.....<..pC.F...e|
+000001b0  b3 18 73 d9 73 8f 4e 67  5e 64 e3 92 0c 2f 03 e4  |..s.s.Ng^d.../..|
+000001c0  81 ec 8a a2 0c 7d e9 97  5f 4b 5f 7e 55 48 24 8c  |.....}.._K_~UH$.|
+000001d0  ea d4 34 18 2b 88 6e 07  17 a9 7a be 6a 99 59 76  |..4.+.n...z.j.Yv|
+000001e0  f5 1d 9b e9 4c ad f7 eb  94 8b bb 7d 93 46 ba a7  |....L......}.F..|
+000001f0  d5 f8 3b 82 91 6d 5c 7e  dc 0f da 08 19 06 40 f0  |..;..m\~......@.|
+00000200  fd 16 68 24 fc 85 84 12  65 71 cf 91 63 46 ea 2f  |..h$....eq..cF./|
+00000210  d6 45 be 8a f3 27 0a 66  cb ed 8a d0 38 02 59 34  |.E...'.f....8.Y4|
+00000220  4a 3d dc 6d 2d ef a4 f6  b4 c0 9d 29 85 b3 da 20  |J=.m-......)... |
+00000230  4d 60 ec 90 eb 0f f1 5f  83 b4 bd 6a d5 0b b1 01  |M`....._...j....|
+00000240  dd df a3 4c 1c b1 f6 b3  0c e0 8d 94 59 84 08 c4  |...L........Y...|
+00000250  31 58 83 11 0b 04 5c 5e  e3 ef 5a f4 6d 95 3a ca  |1X....\^..Z.m.:.|
+00000260  7a 11 b9 db e4 dd 38 66  65 b1 24 40 17 22 8f 90  |z.....8fe.$@."..|
+00000270  f3 88 c6 a0 76 21 67 be  1f 6c aa ca ad c1 58 20  |....v!g..l....X |
+00000280  dd c7 c0 20 32 a8 d7 db  9a 81 c9 82 38 a0 76 6b  |... 2.......8.vk|
+00000290  54 cf 79 cb 01 f1 59 50  3b 99 e2 68 96 2f 49 01  |T.y...YP;..h./I.|
+000002a0  f6 7a ec a5 4f a0 91 be  fb 85 52 ef 9b 6d 0c c1  |.z..O.....R..m..|
+000002b0  36 82 a2 3f 0b 4e 4e 01  31 43 29 2a c0 26 41 83  |6..?.NN.1C)*.&A.|
+000002c0  31 7b 9a b0 bf 0d 0f 96  b7 64 60 4d 07 2b 29 7e  |1{.......d`M.+)~|
+000002d0  d2 f6 c3 92 89 50 a7 19  b7 5b 15 6d 9c 0b 6e e3  |.....P...[.m..n.|
+000002e0  01 d4 58 18 c0 22 95 e6  42 a7 1b 65 a8 2f 5f 6e  |..X.."..B..e./_n|
+000002f0  fc bc 00 ed 01 21 ec a9  6c ac 9e c7 c0 f0 f5 fc  |.....!..l.......|
+00000300  bd 0c c1 26 98 20 fa 1d  a5 2a b6 fc 01 17 1c ba  |...&. ...*......|
+00000310  62 17 7d 39 25 76 bb 8c  77 5a bb 5e 74 22 f7 82  |b.}9%v..wZ.^t"..|
+00000320  f1 65 8a 25 b5 05 53 db  84 de e6 59 1a a6 e7 09  |.e.%..S....Y....|
+00000330  45 8e 14 fc e2 bc 9c 20  42 28 8d e2 ae 48 ad f4  |E...... B(...H..|
+00000340  a0 ab 6b 3e 23 02 0a 0f  ee 92 68 2f 29 1c 7e 4f  |..k>#.....h/).~O|
+00000350  8b 92 85 32 15 2f c1 dc  fa 87 14 1d 21 3e 95 c6  |...2./......!>..|
+00000360  e4 96 f1 66 d6 af bb eb  d8 d4 17 03 03 00 99 31  |...f...........1|
+00000370  1a 82 6b b3 f2 1d 12 83  7c df 15 6a 5b a8 af 96  |..k.....|..j[...|
+00000380  a3 81 92 59 7a 19 c5 6b  b4 ec e0 90 14 f1 00 ca  |...Yz..k........|
+00000390  0d d5 15 c5 24 49 a7 fc  c2 2f 40 89 61 c1 6d d4  |....$I.../@.a.m.|
+000003a0  da 39 f7 c3 42 50 e2 47  62 b2 5f 2b 91 70 e7 61  |.9..BP.Gb._+.p.a|
+000003b0  57 e0 a3 20 a2 79 1f 18  ce f9 ad 5d ea 87 fa 16  |W.. .y.....]....|
+000003c0  85 4b 50 a0 43 8f 0a 40  d7 93 cf 82 b5 82 6c 11  |.KP.C..@......l.|
+000003d0  b7 cb 7c b2 4d 7d 23 ec  a7 f8 2f b6 69 a8 83 29  |..|.M}#.../.i..)|
+000003e0  4a ff 72 86 8e 05 79 91  a7 ed 4b 3d c8 86 fc 29  |J.r...y...K=...)|
+000003f0  74 1e 88 7b a5 b2 2c 6e  62 08 2e a9 02 c9 05 d8  |t..{..,nb.......|
+00000400  66 db 9c 28 35 79 ed 6f  17 03 03 00 35 24 4d e5  |f..(5y.o....5$M.|
+00000410  81 c9 80 a9 1b c8 a9 20  27 c8 17 b3 0e 42 91 70  |....... '....B.p|
+00000420  cb 4d ac 6f b8 b7 9a 96  94 95 fb ce f1 51 65 21  |.M.o.........Qe!|
+00000430  ff 2c c5 53 42 1c b3 1c  b1 9b 38 1a 1c a0 bf 3c  |.,.SB.....8....<|
+00000440  92 06                                             |..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 01 50 ef 68 27 d6 ec  |..........P.h'..|
-00000010  76 00 e1 c6 ed 3c f6 a1  83 b4 4b 26 28 ba 0f d6  |v....<....K&(...|
-00000020  2a fd f0 4a 10 8f 9c ed  84 3f 0a 0e 5b 77 e2 7d  |*..J.....?..[w.}|
-00000030  1e 03 2a 76 5b 2b 87 78  ad bd 45 8b 03 b3 8d e7  |..*v[+.x..E.....|
-00000040  b7 66 ca 5e 36 f8 53 87  90 3c 1a 33 46 1d 32 4f  |.f.^6.S..<.3F.2O|
-00000050  f1 90 fb 36 da 96 1c 1a  db 9f 9b e6 9f 85 f8 13  |...6............|
-00000060  7d e1 ab e1 ca c6 05 df  15 ea af dd 55 58 c7 5f  |}...........UX._|
-00000070  de 62 1b 93 60 a4 fc 39  0a ef 95 bc 0c ca 8f 84  |.b..`..9........|
-00000080  98 0a 6d 5b fd c6 0c ad  02 7f 0c f8 b4 be fe 5a  |..m[...........Z|
-00000090  fb 22 00 08 09 5d c7 47  76 89 e5 06 d1 90 5b e6  |."...].Gv.....[.|
-000000a0  63 64 06 28 37 d9 1b e9  0d 27 45 f7 72 30 d7 f2  |cd.(7....'E.r0..|
-000000b0  db 8e bf 95 97 29 43 e7  16 bf a0 59 9c fa d9 59  |.....)C....Y...Y|
-000000c0  a0 a6 9b 1f b5 74 80 87  d0 61 2f d5 a5 ac dd b2  |.....t...a/.....|
-000000d0  8d 27 fc e6 68 eb 07 b3  3d 97 a9 93 5b 35 99 e9  |.'..h...=...[5..|
-000000e0  ba 99 fe 49 d6 39 1a 0a  38 98 cd 47 b9 67 9b 9a  |...I.9..8..G.g..|
-000000f0  77 65 45 f8 48 fb d3 1c  0f a2 2e af e0 29 68 bc  |weE.H........)h.|
-00000100  81 24 3b 9b 36 0a ef 51  75 ff 61 6a d4 6c 59 42  |.$;.6..Qu.aj.lYB|
-00000110  54 31 47 e9 02 9e 58 33  9e 89 65 b6 65 db b2 81  |T1G...X3..e.e...|
-00000120  bd c1 f4 0a 34 eb f3 26  f5 8d 36 6d da 78 e6 88  |....4..&..6m.x..|
-00000130  00 8f 92 24 dc 76 e3 95  dc 13 b5 92 91 ee c0 82  |...$.v..........|
-00000140  cb 63 85 b6 59 67 dc 14  2e 2d 58 8e 56 7e 7c db  |.c..Yg...-X.V~|.|
-00000150  2f 54 01 ed 17 8d 9a 97  22 39 7f 17 03 03 00 59  |/T......"9.....Y|
-00000160  a1 f2 0d 19 e7 d8 a8 6d  cd ea f6 82 ee 5d 0a 55  |.......m.....].U|
-00000170  22 61 11 21 f7 b0 1d 86  a8 4d c2 e2 9b ac bb 87  |"a.!.....M......|
-00000180  a2 82 67 ee 78 76 9b e0  c0 00 85 bf 1e 2b ab e6  |..g.xv.......+..|
-00000190  f1 43 79 69 a0 3d 04 b7  d9 7f 31 c7 7a b7 4f 5c  |.Cyi.=....1.z.O\|
-000001a0  9f 62 84 dc f4 6d a1 ce  3d ff 24 88 15 10 4a e6  |.b...m..=.$...J.|
-000001b0  5c 12 68 08 3c 55 a2 a9  d7 17 03 03 00 35 f4 d9  |\.h.<U.......5..|
-000001c0  9f 41 70 39 d4 88 2a 0b  43 c3 78 0f c2 42 48 b8  |.Ap9..*.C.x..BH.|
-000001d0  e5 26 ad e3 72 40 66 d7  a0 5e 5e 0c 6a af 1a 47  |.&..r@f..^^.j..G|
-000001e0  c6 5f 25 ce c9 13 77 60  8f 6e a7 9f bc e3 f9 58  |._%...w`.n.....X|
-000001f0  9c 12 cc                                          |...|
+00000000  14 03 03 00 01 01 17 03  03 01 50 0c e7 45 36 eb  |..........P..E6.|
+00000010  2f a0 d5 c8 d2 75 51 8f  ec 65 b5 3f 5b 6f 80 6e  |/....uQ..e.?[o.n|
+00000020  5f 88 db 8f d0 23 07 57  1b 01 d6 20 ba a2 89 6b  |_....#.W... ...k|
+00000030  a4 f8 fe 67 84 29 13 b1  f8 06 48 34 2c bd 4a b3  |...g.)....H4,.J.|
+00000040  1a 87 e1 79 1f f6 06 4e  5a c6 7f 49 87 b3 22 ea  |...y...NZ..I..".|
+00000050  be 13 44 81 ae be 60 dd  37 37 21 41 a9 e0 47 a8  |..D...`.77!A..G.|
+00000060  2f a5 24 b6 8c 1c f7 f3  b4 41 5c 0f d1 f3 08 6f  |/.$......A\....o|
+00000070  52 8b ef eb c9 0c 3a d0  cd 1a 7e fa e2 25 95 ed  |R.....:...~..%..|
+00000080  8d 62 99 e9 ba 99 e9 57  c8 a2 43 b8 36 0c 8b d7  |.b.....W..C.6...|
+00000090  b2 8b 70 12 d5 7e 36 3a  66 44 a6 66 34 e9 aa df  |..p..~6:fD.f4...|
+000000a0  fd f2 d8 1e 8c b8 2e 42  7d 0e 2d a7 54 7a e3 04  |.......B}.-.Tz..|
+000000b0  6c b3 42 90 88 c3 34 54  21 5d da 0b 58 c9 ee 68  |l.B...4T!]..X..h|
+000000c0  ef fa 4c e9 c1 bd 8e da  ef 68 b5 37 7e df 44 8f  |..L......h.7~.D.|
+000000d0  d5 ef 0a 04 98 e0 94 9c  53 37 bc 0b 34 d5 a1 12  |........S7..4...|
+000000e0  8a dc ad 2b 4e e1 3c 79  9e 9a da 18 3c b7 d8 ee  |...+N.<y....<...|
+000000f0  35 77 79 34 58 6e 98 1e  47 c4 37 a0 6c 2e a0 f6  |5wy4Xn..G.7.l...|
+00000100  e0 2c ff cb 72 18 80 3d  d0 1d 7e 4d b0 39 83 34  |.,..r..=..~M.9.4|
+00000110  3b 8d 9d 79 5f e1 a4 6c  07 62 f0 6e da 2c 0a 0b  |;..y_..l.b.n.,..|
+00000120  00 6a 2b 32 53 6f 14 96  06 2a 56 c5 3d 98 e6 01  |.j+2So...*V.=...|
+00000130  67 fa eb 9b b1 cf 3f e7  42 0e 20 f6 46 4f f1 04  |g.....?.B. .FO..|
+00000140  3b f5 f6 94 dc f1 a0 de  db b3 f6 8b 27 22 0f b1  |;...........'"..|
+00000150  19 9f 1e 66 96 fa e1 c3  58 51 79 17 03 03 00 59  |...f....XQy....Y|
+00000160  09 21 09 52 9a 3a 48 f4  b7 6b 8b f9 26 cc c6 4b  |.!.R.:H..k..&..K|
+00000170  78 1c d6 66 48 9c e4 0e  67 79 ea cf 8f 00 a1 86  |x..fH...gy......|
+00000180  3a 84 8d e0 36 7c 4a a3  5c 75 6a 27 d2 e1 d8 87  |:...6|J.\uj'....|
+00000190  5b 29 80 24 9a 7d 71 23  b8 53 29 4e 45 7e 0f ce  |[).$.}q#.S)NE~..|
+000001a0  43 0e c7 2e 72 13 e2 30  bb 62 12 57 1e 74 59 3b  |C...r..0.b.W.tY;|
+000001b0  f8 2a 83 fb 85 e6 3e b7  7a 17 03 03 00 35 3d d3  |.*....>.z....5=.|
+000001c0  94 02 6e 65 f2 98 8d 45  3e d5 af 22 46 f0 70 3e  |..ne...E>.."F.p>|
+000001d0  d4 90 9c 02 0a f9 8d e6  c7 8f 52 af ab 74 67 12  |..........R..tg.|
+000001e0  6d 8e 25 f8 03 73 02 78  5d 9c 8b 38 68 fe e9 96  |m.%..s.x]..8h...|
+000001f0  c6 83 29                                          |..)|
 >>> Flow 4 (server to client)
-00000000  17 03 03 01 c2 80 69 97  9a 20 30 2a 1c f4 31 f9  |......i.. 0*..1.|
-00000010  0f cf f7 79 c0 01 e1 f3  35 f5 16 a0 33 d6 eb 21  |...y....5...3..!|
-00000020  44 db bc c6 c4 91 6b a6  75 da ca d3 63 78 47 8b  |D.....k.u...cxG.|
-00000030  96 e5 6f 63 2c 77 c0 33  29 d8 3e ee bf 8e 6b d4  |..oc,w.3).>...k.|
-00000040  de f7 1b 0e e6 ae ce cd  17 0d 24 77 10 3d e4 89  |..........$w.=..|
-00000050  06 07 a3 77 68 ac 20 ec  0b ae 47 41 3b 80 4e 95  |...wh. ...GA;.N.|
-00000060  02 aa 13 36 19 03 06 1c  47 b3 f7 f0 4b 6d 5a c6  |...6....G...KmZ.|
-00000070  42 14 95 03 20 c7 46 96  42 d3 18 5a 40 bd a1 03  |B... .F.B..Z@...|
-00000080  b6 d2 8b f9 ff 2d d1 b1  3c 8a 34 af 23 64 31 7d  |.....-..<.4.#d1}|
-00000090  46 47 21 b4 82 16 df a2  a4 0f 96 03 4b 38 3d 5d  |FG!.........K8=]|
-000000a0  d0 d1 78 d1 6e 6a a2 95  c0 a7 e6 ee 07 eb 77 68  |..x.nj........wh|
-000000b0  35 78 72 3e df d9 4b e9  1b ab 34 99 2d fe 52 99  |5xr>..K...4.-.R.|
-000000c0  6e 57 63 13 39 ae 5e ce  b6 43 21 07 fd fe b7 6d  |nWc.9.^..C!....m|
-000000d0  8f 72 a4 f8 7e 0a 56 60  61 d5 5a d4 01 b3 47 8e  |.r..~.V`a.Z...G.|
-000000e0  f0 48 cd 85 61 a3 d2 d1  eb ba 04 39 6b 5e 5f fc  |.H..a......9k^_.|
-000000f0  e3 90 c1 cb 3f 40 30 00  5c 94 df bf 5b 89 6d ab  |....?@0.\...[.m.|
-00000100  15 1e 72 50 ac 56 ee 16  7d 84 4c e6 0c 89 68 fa  |..rP.V..}.L...h.|
-00000110  d5 8d 5f 09 85 25 5f 8c  70 df 0b b7 94 15 40 20  |.._..%_.p.....@ |
-00000120  b1 ff 41 50 5d 9f c6 8a  9b 7f 40 6f dc bd 4f 54  |..AP].....@o..OT|
-00000130  d8 1f e6 f1 44 00 11 97  45 ca 80 bc 15 eb 93 01  |....D...E.......|
-00000140  dd 54 c6 75 7e 08 b9 38  f5 4d 97 c5 50 56 97 3c  |.T.u~..8.M..PV.<|
-00000150  3c 72 9a 33 7c 68 b1 73  2b 38 c7 b8 a8 3c 5d af  |<r.3|h.s+8...<].|
-00000160  a6 3e 12 ef d1 c1 99 36  10 02 af 0c 5b 16 16 7a  |.>.....6....[..z|
-00000170  f5 74 8d ac a4 0f 38 34  ee cd 08 50 e0 33 b0 e1  |.t....84...P.3..|
-00000180  52 e1 5d f2 7d c6 7b 64  c7 46 f6 9e d0 a2 cf 89  |R.].}.{d.F......|
-00000190  3c c9 ab 2f fb 8a f3 ba  78 e9 4c c5 2d 62 32 6b  |<../....x.L.-b2k|
-000001a0  50 4c a0 7e d3 bb 2a 66  57 99 38 69 e8 77 ef 18  |PL.~..*fW.8i.w..|
-000001b0  24 af b3 cb e5 c0 37 a2  97 f6 00 d4 68 8a 71 af  |$.....7.....h.q.|
-000001c0  24 a4 ab 19 07 3b c0 17  03 03 00 1e 60 b4 fc 15  |$....;......`...|
-000001d0  f9 9c b1 a1 60 1a ba f5  1b b9 c1 33 f1 8b e5 c0  |....`......3....|
-000001e0  48 77 4f 11 42 21 ad 8c  d2 d6 17 03 03 00 13 5c  |HwO.B!.........\|
-000001f0  db 07 5e 65 40 58 74 a4  7f ab 5f cc f0 9a 91 0c  |..^e@Xt..._.....|
-00000200  17 3d                                             |.=|
+00000000  17 03 03 01 c2 48 66 ba  b6 48 e4 d9 1a 73 81 09  |.....Hf..H...s..|
+00000010  cc 26 f8 2b bd 70 e7 15  c7 29 ac 30 58 21 ee 0c  |.&.+.p...).0X!..|
+00000020  9b c6 f0 b2 85 23 20 1a  7b ad ce fc 5f b6 ce aa  |.....# .{..._...|
+00000030  af a3 40 52 bf b3 3f 3d  61 a9 14 d1 eb 3c 21 78  |..@R..?=a....<!x|
+00000040  76 4c 94 d8 88 f2 67 54  7a d5 fa bf 38 aa 13 51  |vL....gTz...8..Q|
+00000050  c9 3d d3 0e 49 b8 0c 3a  c9 dc 7b 88 f7 8e 43 11  |.=..I..:..{...C.|
+00000060  e5 76 92 1a b2 58 df a4  43 38 fa 29 23 8b a1 c4  |.v...X..C8.)#...|
+00000070  4b 62 c3 af 07 0a f5 6b  74 cc 13 0a 35 cc d7 9e  |Kb.....kt...5...|
+00000080  88 f2 8f 46 a8 bb 85 c0  27 ff 2b 98 ce 4c 33 f6  |...F....'.+..L3.|
+00000090  c5 4a 82 ca 74 e7 71 b7  48 f0 2c 0d 3a 45 bc 06  |.J..t.q.H.,.:E..|
+000000a0  0c ad 39 81 c4 38 3c 66  2d ad ae cf 2b 3a bd 8f  |..9..8<f-...+:..|
+000000b0  c7 db 2a bc 16 ee 35 99  69 43 36 ce 77 67 6a dc  |..*...5.iC6.wgj.|
+000000c0  d0 01 e9 fa 76 4b c3 12  2d fe 66 70 6e c8 30 fa  |....vK..-.fpn.0.|
+000000d0  43 55 ed dc f1 22 9c 51  80 f8 bc aa 38 94 1e 77  |CU...".Q....8..w|
+000000e0  20 3a c6 18 37 47 21 07  48 c5 b8 87 08 76 0c 78  | :..7G!.H....v.x|
+000000f0  74 c1 dd 8b d8 86 29 57  b5 5e 05 4b 9a 42 b3 c7  |t.....)W.^.K.B..|
+00000100  a2 4d 6a 6b de 81 d8 5a  13 23 f6 9b 3a 2f 92 37  |.Mjk...Z.#..:/.7|
+00000110  3c 95 cf d7 ae 82 2b ef  a3 c0 2f 76 0b d0 32 9f  |<.....+.../v..2.|
+00000120  23 64 fe 42 3d 6c 01 55  60 0c 3d 64 e7 ad aa 2f  |#d.B=l.U`.=d.../|
+00000130  9b 58 13 eb 51 c8 61 73  51 0f b1 cd 00 45 a9 b7  |.X..Q.asQ....E..|
+00000140  78 76 1a 72 2e 0b b7 b6  18 16 0c 22 29 fd 26 b8  |xv.r.......").&.|
+00000150  1c e7 c0 6a d5 5f 8e 6b  f0 83 92 4f 8f 7c a2 3d  |...j._.k...O.|.=|
+00000160  31 2c db 3e f9 c1 4a a3  a6 b6 a2 ec ff f2 db b1  |1,.>..J.........|
+00000170  fb ff 37 ce b7 5a 75 34  91 35 de 45 a2 36 71 05  |..7..Zu4.5.E.6q.|
+00000180  20 65 d3 e4 fa 48 00 c1  25 3f f2 98 e8 0f 32 2a  | e...H..%?....2*|
+00000190  ee c5 60 f6 83 25 40 91  f6 13 0b fe 26 a9 f1 4c  |..`..%@.....&..L|
+000001a0  67 0d e8 c9 25 7e f5 f3  e3 ca 34 c3 e7 0e 4b e1  |g...%~....4...K.|
+000001b0  c8 f4 40 94 69 88 a2 81  75 02 7d 6d d4 6a b3 c3  |..@.i...u.}m.j..|
+000001c0  61 84 17 29 2a e9 90 17  03 03 00 1e 43 69 c6 7c  |a..)*.......Ci.||
+000001d0  1a fa 1a cf bf 78 54 c0  8f b7 8d 83 d8 74 f9 54  |.....xT......t.T|
+000001e0  6a 62 2f b1 68 63 69 b7  46 2e 17 03 03 00 13 08  |jb/.hci.F.......|
+000001f0  49 af 4e 5f f1 e1 8a 7d  20 4e 55 2b 86 4f 03 a0  |I.N_...} NU+.O..|
+00000200  d2 b5                                             |..|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndGiven b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndGiven
index 8ba88ebf3f..2a608bda26 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndGiven
+++ b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndGiven
@@ -1,177 +1,180 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 56 2e 3c 64 35  |...........V.<d5|
-00000010  b8 7d db 8a 3c f0 93 73  0f 64 8d 84 da b6 59 37  |.}..<..s.d....Y7|
-00000020  22 99 3f 69 16 56 16 39  a2 a9 58 20 7c d3 26 20  |".?i.V.9..X |.& |
-00000030  a0 dc e9 7a 07 71 02 2d  3b 27 85 16 fb 6e 26 e5  |...z.q.-;'...n&.|
-00000040  c3 67 e5 0b bd e5 50 8f  bd 39 6f 2c 00 04 13 01  |.g....P..9o,....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 c5 cc 07 79 72  |..............yr|
+00000010  50 61 54 df 90 ab 52 54  06 7d 7b 96 7f 13 5c 3c  |PaT...RT.}{...\<|
+00000020  1f ee fe cf d5 31 0a 58  37 96 02 20 b9 21 2b 29  |.....1.X7.. .!+)|
+00000030  79 05 38 92 c6 fe 41 fa  be d7 98 08 0a e4 12 b7  |y.8...A.........|
+00000040  7a ea 10 5a 0d 1a f2 b4  81 5d 9d 01 00 04 13 01  |z..Z.....]......|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 f6  |-.....3.&.$... .|
-000000b0  96 06 42 18 9d ae a6 49  01 d1 a5 d3 ee c7 5a ed  |..B....I......Z.|
-000000c0  26 20 c7 d5 e8 3c 58 21  1b 17 28 ea f9 e3 45     |& ...<X!..(...E|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 a3  |-.....3.&.$... .|
+000000b0  b9 ae 31 09 ae 42 2d be  67 66 05 37 52 e0 3a cc  |..1..B-.gf.7R.:.|
+000000c0  44 70 80 ff fe d5 2f 0b  19 d5 15 9f ce a0 35     |Dp..../.......5|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 7c d3 26 20  |........... |.& |
-00000030  a0 dc e9 7a 07 71 02 2d  3b 27 85 16 fb 6e 26 e5  |...z.q.-;'...n&.|
-00000040  c3 67 e5 0b bd e5 50 8f  bd 39 6f 2c 13 01 00 00  |.g....P..9o,....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 b9 21 2b 29  |........... .!+)|
+00000030  79 05 38 92 c6 fe 41 fa  be d7 98 08 0a e4 12 b7  |y.8...A.........|
+00000040  7a ea 10 5a 0d 1a f2 b4  81 5d 9d 01 13 01 00 00  |z..Z.....]......|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 43 8e 41 a4 04 13  |..........C.A...|
-00000090  01 08 9f 6e 1a fd 00 68  38 5c 93 d9 9a f7 1e 36  |...n...h8\.....6|
-000000a0  ea 17 03 03 00 3e 9f ae  80 ef f4 20 66 e7 44 fc  |.....>..... f.D.|
-000000b0  4d a4 3f 0e dc bb 33 47  0f 13 96 fa 03 07 d6 6f  |M.?...3G.......o|
-000000c0  cc 9f 3c fd 01 f5 87 d9  ec c9 d0 fc dd bf c8 5c  |..<............\|
-000000d0  0b 3d aa a7 c6 1d 90 18  d9 a1 1a a0 a1 ea 49 32  |.=............I2|
-000000e0  9e 45 86 f7 17 03 03 02  6d 61 29 fe 45 7e 5c b3  |.E......ma).E~\.|
-000000f0  8a 73 f2 65 c1 90 4e 93  0d 84 b2 bd e4 46 93 c2  |.s.e..N......F..|
-00000100  52 3f 07 38 e7 23 db 25  5e 71 98 a9 7d fd e9 ef  |R?.8.#.%^q..}...|
-00000110  3f 2c d8 9c ae 41 c4 d3  c7 9e d5 6e f0 0c 33 78  |?,...A.....n..3x|
-00000120  98 cf bf 22 3d 1f d0 f3  c8 a2 34 e8 ce 5e 0d 37  |..."=.....4..^.7|
-00000130  52 e2 b8 e3 50 ea 35 3e  e5 59 a0 6d ed 9e 09 36  |R...P.5>.Y.m...6|
-00000140  59 20 33 08 a9 41 f4 72  aa 2d 0c b5 d6 96 d9 04  |Y 3..A.r.-......|
-00000150  1a f1 d8 45 ed 67 ab f9  15 fa 25 ef 6d 87 72 ad  |...E.g....%.m.r.|
-00000160  f0 06 59 a5 8e 61 80 8b  28 f9 a0 df 5b b2 a2 3a  |..Y..a..(...[..:|
-00000170  1c 91 43 18 f4 a2 f3 4e  db dc 24 1b c3 0e 77 22  |..C....N..$...w"|
-00000180  83 ae 88 9f 8e 8d 48 38  f4 60 51 42 fa f2 a4 de  |......H8.`QB....|
-00000190  33 78 35 d0 b6 01 3d 7a  f5 54 68 51 fd 0e 4c 9b  |3x5...=z.ThQ..L.|
-000001a0  92 7c a5 01 96 52 7e de  38 b9 b0 ee 60 1e aa eb  |.|...R~.8...`...|
-000001b0  8c e6 b4 f4 7c 35 d2 0b  9b 83 94 ac ac ce 7e 58  |....|5........~X|
-000001c0  51 6e c3 ae 3b cd f5 85  8a 1e 43 78 19 ee dc a1  |Qn..;.....Cx....|
-000001d0  a3 d0 93 24 0d 3b 6a 4b  cd dc 78 9c 0b 2f bc 41  |...$.;jK..x../.A|
-000001e0  46 2f 64 3c 23 95 04 8b  60 75 bf 4d 45 3b e4 1e  |F/d<#...`u.ME;..|
-000001f0  9c 5b 1a 46 bb f3 4d a9  1b 59 33 b4 40 78 bd ff  |.[.F..M..Y3.@x..|
-00000200  30 7d d4 cc 5e 83 03 de  8d a3 a6 27 b4 bc 12 6e  |0}..^......'...n|
-00000210  5e f2 88 e8 b6 60 f3 01  e8 4a 53 c7 a9 fc a1 cc  |^....`...JS.....|
-00000220  27 45 c1 06 90 38 9a fb  1b 2a 9e ed 9e f6 19 85  |'E...8...*......|
-00000230  dd f7 8a 7f 95 08 3a 25  c0 5b 63 96 44 71 c2 16  |......:%.[c.Dq..|
-00000240  9c e1 10 69 e5 6a 5c 4a  e8 2a ed 6f bd de f5 98  |...i.j\J.*.o....|
-00000250  c0 a0 c5 54 7c cc 06 11  b2 54 1a c3 b4 46 c2 b4  |...T|....T...F..|
-00000260  97 d8 9c 7d f1 f3 d4 6f  3c a0 ef 18 c5 a6 e9 13  |...}...o<.......|
-00000270  e9 f4 9d bf 9b 25 a2 da  c6 ba 7a 6d 91 fd 41 a4  |.....%....zm..A.|
-00000280  e8 88 e3 79 2c 99 df 4d  21 48 89 57 5a bf 2a 2d  |...y,..M!H.WZ.*-|
-00000290  72 4e 1e 3a e8 c9 82 7b  c0 ff 6b 7c e8 8f 41 bf  |rN.:...{..k|..A.|
-000002a0  83 19 9e 96 d1 3f 2b 60  8f 7f 0b f8 6c 70 82 dd  |.....?+`....lp..|
-000002b0  34 da 91 62 17 20 e9 99  2e e2 a9 9a 9d fd 5d f8  |4..b. ........].|
-000002c0  a5 c0 ac e8 a3 df 11 b5  df 2c bd e1 e8 0f 7e 0a  |.........,....~.|
-000002d0  f2 47 4c 92 33 7b 6b 49  e5 30 31 8b 2e 16 81 3e  |.GL.3{kI.01....>|
-000002e0  79 25 f7 d7 d2 8f 5e e6  e3 2d ed 0d e1 08 97 13  |y%....^..-......|
-000002f0  f3 ce 7d b1 36 0d 7c b0  4f 23 6b 12 ef 3a a4 8b  |..}.6.|.O#k..:..|
-00000300  b5 d0 c9 ee 48 77 70 28  61 ff ad 49 f6 48 4c 37  |....Hwp(a..I.HL7|
-00000310  7b 00 c4 01 5d 8b 54 bc  44 5c 5f 98 6f 7d 84 84  |{...].T.D\_.o}..|
-00000320  c8 d0 55 88 f9 17 f6 02  f1 84 b6 3c 1a 03 e8 7b  |..U........<...{|
-00000330  b9 4e 24 c6 d8 0a f6 8c  b9 49 c6 10 38 53 e1 10  |.N$......I..8S..|
-00000340  8f 91 cd 39 9a 3a e8 c7  10 f3 c3 91 84 3c 8c a6  |...9.:.......<..|
-00000350  55 ab f4 f5 ab e7 17 03  03 00 99 e5 40 f6 35 34  |U...........@.54|
-00000360  2d 42 3e 7f e1 51 26 56  50 4e 60 b0 2f 65 e3 cd  |-B>..Q&VPN`./e..|
-00000370  c7 08 0e 96 77 08 c7 f6  4f e6 70 90 bc 80 95 e7  |....w...O.p.....|
-00000380  b2 df 98 83 94 4d 9e 5c  8a af d3 45 da e9 d7 fa  |.....M.\...E....|
-00000390  d8 d2 60 f8 b1 06 d9 27  64 45 4d e8 d3 07 8a bb  |..`....'dEM.....|
-000003a0  72 7a c6 71 00 7e 8b b0  2b 7d d0 f7 ab 1a bf d2  |rz.q.~..+}......|
-000003b0  50 be a9 3a 0c 68 b8 48  9a 91 ee db 26 4d d3 66  |P..:.h.H....&M.f|
-000003c0  5b 00 ef c3 cc b8 f2 4e  1e 51 c7 9b 34 3c e3 01  |[......N.Q..4<..|
-000003d0  7f 75 4e 41 e4 56 34 ec  14 92 0f 1e 6d dd 51 9a  |.uNA.V4.....m.Q.|
-000003e0  e0 8b 33 54 df 77 1f ff  d3 72 67 4c 62 16 b7 f8  |..3T.w...rgLb...|
-000003f0  4f 8f f8 ee 17 03 03 00  35 b7 83 d2 27 a3 15 f2  |O.......5...'...|
-00000400  75 55 aa 06 8c 5f c4 fa  0f 43 88 c9 c5 e3 c7 36  |uU..._...C.....6|
-00000410  40 6b 35 0b 7e 60 a1 1e  48 ef 46 2c d6 e4 48 80  |@k5.~`..H.F,..H.|
-00000420  91 b0 e5 3b c0 58 5d fe  5d bd 0a 6c 19 ea        |...;.X].]..l..|
+00000080  03 03 00 01 01 17 03 03  00 17 4d 00 8b d1 bc 63  |..........M....c|
+00000090  c3 8c af c4 0f 2e 36 78  8d 2b 52 32 f6 2c 29 0e  |......6x.+R2.,).|
+000000a0  17 17 03 03 00 52 aa 37  4e 5d 56 9a 8d 72 e7 77  |.....R.7N]V..r.w|
+000000b0  f1 b7 0c 0b be 7d 63 92  58 0f 09 d7 a0 36 12 75  |.....}c.X....6.u|
+000000c0  c9 0d ec d8 44 b4 8f ad  dd a1 84 58 3f 0a 7c 47  |....D......X?.|G|
+000000d0  0b c1 6f 56 7a 90 bf 82  6d 29 22 8b b3 50 03 ea  |..oVz...m)"..P..|
+000000e0  18 96 5e f5 1b f0 67 7d  10 c8 3f a4 f5 44 84 b3  |..^...g}..?..D..|
+000000f0  f3 af 3e f2 b3 93 a1 57  17 03 03 02 6d 54 0a b5  |..>....W....mT..|
+00000100  be 3f e0 77 de 6f e3 d7  83 60 2e 17 94 77 fb e1  |.?.w.o...`...w..|
+00000110  11 e8 8d 22 1a 7b ac 36  94 35 d5 29 e5 fa 9e 07  |...".{.6.5.)....|
+00000120  62 87 34 f8 b4 c5 ae d5  ee 84 76 c8 fd 30 cf a8  |b.4.......v..0..|
+00000130  b1 a4 fe 42 12 e1 36 80  05 76 e2 d2 04 2b 6e c7  |...B..6..v...+n.|
+00000140  0d 7d dc 99 de 3d 62 41  2f 3c c2 78 22 ec 6f 37  |.}...=bA/<.x".o7|
+00000150  ab 0d 03 22 fe fc f4 82  41 49 44 fd 0a 02 4a 79  |..."....AID...Jy|
+00000160  bd 5b 40 63 46 58 cd 84  b6 cf 46 c3 31 68 38 2a  |.[@cFX....F.1h8*|
+00000170  cf e0 3f ee de 06 ee de  f8 e8 3e 37 ab 92 a6 9b  |..?.......>7....|
+00000180  0a f3 a8 64 6a 81 86 5d  ed e3 a2 8c d0 0f 09 1e  |...dj..]........|
+00000190  ba e9 b0 6f 6b 1e 32 be  03 de 97 81 e0 42 ad 6e  |...ok.2......B.n|
+000001a0  f6 af bd 12 7a 2f f4 41  63 c4 f4 6a 61 8c e5 d4  |....z/.Ac..ja...|
+000001b0  60 99 f2 d5 92 54 2f 28  ee 3f 9b ab fa c1 51 9b  |`....T/(.?....Q.|
+000001c0  f5 6b d1 d6 6d b1 17 28  95 5f 3c cc e4 41 bf 9b  |.k..m..(._<..A..|
+000001d0  c5 6e 29 4b 39 f8 ad b0  fe 51 4c 2b 92 76 ce 22  |.n)K9....QL+.v."|
+000001e0  ee 5c 9e ad 0e 50 12 3d  2a a0 7a 6d a1 63 18 f7  |.\...P.=*.zm.c..|
+000001f0  f2 a0 2a b7 b6 c9 f3 60  54 47 a8 90 dd 90 7d c3  |..*....`TG....}.|
+00000200  6e f8 58 1c 28 e7 21 b4  52 33 da 67 67 2b b1 51  |n.X.(.!.R3.gg+.Q|
+00000210  b0 41 97 a3 1f 9b cd c8  28 63 c9 f5 e5 d1 a3 3f  |.A......(c.....?|
+00000220  ac 1c 39 2e 72 1b e5 16  4d 8c b1 6b 4c 35 07 e9  |..9.r...M..kL5..|
+00000230  24 a4 98 fb 67 75 4b 76  b7 2d cc 35 d9 a4 db 74  |$...guKv.-.5...t|
+00000240  96 56 96 e0 74 8e f9 4a  45 19 30 57 a0 22 27 a9  |.V..t..JE.0W."'.|
+00000250  d9 34 d7 73 f0 16 87 e5  be 8e b3 d2 53 f2 9c 19  |.4.s........S...|
+00000260  c1 0a df 07 e7 e8 30 fb  44 ac 34 13 2b 22 4c a2  |......0.D.4.+"L.|
+00000270  00 da 45 fc 95 1f 83 a0  c9 fa b3 b9 16 95 83 0f  |..E.............|
+00000280  a9 fa ae 2f b7 bc a1 55  d2 ab 2d 31 af 39 c2 82  |.../...U..-1.9..|
+00000290  f7 bf 9a 9a 5c e6 61 d7  f2 9c d0 b5 53 85 58 cf  |....\.a.....S.X.|
+000002a0  9d 2e 50 eb 46 a1 a4 a0  aa c4 44 66 f7 61 41 0f  |..P.F.....Df.aA.|
+000002b0  75 68 36 76 11 7d 1e d7  be 0f a4 7a a8 bb 9e 26  |uh6v.}.....z...&|
+000002c0  a9 7b ea 30 14 51 37 78  58 2a 92 e2 2c d3 9e 27  |.{.0.Q7xX*..,..'|
+000002d0  86 92 83 a0 bc e8 50 ed  da 9c 06 f4 d8 3c d5 6c  |......P......<.l|
+000002e0  a5 3a cc 1a ce 00 55 30  20 74 ad 17 5c bd 98 2d  |.:....U0 t..\..-|
+000002f0  1f 11 e7 38 99 2d b4 fc  1c 42 c9 ae f1 af 46 3e  |...8.-...B....F>|
+00000300  67 13 d2 31 16 34 fd e9  26 7c dd bb a0 25 10 7d  |g..1.4..&|...%.}|
+00000310  ca 94 20 6a b9 10 b7 94  0d 26 31 46 f2 bf 45 a8  |.. j.....&1F..E.|
+00000320  ed 8f 08 15 7d db dd 3a  ad 45 9f bd 32 8d ff 80  |....}..:.E..2...|
+00000330  c6 1f bf 57 5e a0 dc 74  3c 8a b3 8f 03 ef a1 ef  |...W^..t<.......|
+00000340  12 65 2c c3 16 4f bc 63  3b 62 ab fa ae 9f d1 84  |.e,..O.c;b......|
+00000350  79 80 25 04 bc e0 f9 70  98 e1 8c 15 55 ba cf a3  |y.%....p....U...|
+00000360  0a 24 64 8c 3a b2 b7 a8  04 c1 17 03 03 00 99 c0  |.$d.:...........|
+00000370  87 16 ce 52 d1 e9 83 f3  46 02 91 89 a1 6d 24 17  |...R....F....m$.|
+00000380  dc 6a 05 bb c2 fb bd 93  94 05 60 8c 6c 47 f6 4a  |.j........`.lG.J|
+00000390  d8 ad 42 99 8b 77 92 91  f3 58 1e 10 3b 59 b1 19  |..B..w...X..;Y..|
+000003a0  55 2c 3b f2 5b f3 e5 67  b2 e1 9c a8 68 dd 0e b9  |U,;.[..g....h...|
+000003b0  67 c4 61 63 b3 bc 15 7b  d6 76 7d 44 42 46 57 96  |g.ac...{.v}DBFW.|
+000003c0  b3 10 40 39 2b 8c d5 fa  cf a0 32 c0 d5 1a aa 96  |..@9+.....2.....|
+000003d0  95 3b d5 55 fe 06 d2 34  31 7c 29 95 86 ac 7e f5  |.;.U...41|)...~.|
+000003e0  e6 6b 7d a6 b5 52 37 2d  02 56 b8 12 66 33 67 80  |.k}..R7-.V..f3g.|
+000003f0  14 5f 78 b3 a3 bf fc 4f  cb 16 82 4e f5 c4 1b a1  |._x....O...N....|
+00000400  33 3e 6c ed df 7b 4d 0b  17 03 03 00 35 dd de ca  |3>l..{M.....5...|
+00000410  4d 9e 09 ba 14 09 72 72  23 9f 3c 7e 2c 46 e5 5e  |M.....rr#.<~,F.^|
+00000420  50 a2 21 02 f7 03 4b 76  ab 4c a8 0b a2 b3 9b 7a  |P.!...Kv.L.....z|
+00000430  fc b9 5d a2 ac 0b c3 55  15 b8 b8 23 2b 61 46 00  |..]....U...#+aF.|
+00000440  1c 5c                                             |.\|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 02 11 9e 9e cf 44 84  |..............D.|
-00000010  df e7 23 47 2d 4e 85 fa  f2 02 2a 79 4d 3a 3d df  |..#G-N....*yM:=.|
-00000020  48 95 2e d7 0d 3c d0 05  fc bf bb 23 0a 25 59 76  |H....<.....#.%Yv|
-00000030  fd 04 f8 f0 81 88 85 9f  99 f0 55 91 9a 79 8a 39  |..........U..y.9|
-00000040  f4 6e 49 92 be ed 1d d1  20 19 77 bc 55 9b b0 da  |.nI..... .w.U...|
-00000050  d1 c4 9f b5 2f 5c 1a 60  38 e1 92 9b f9 a1 97 6b  |..../\.`8......k|
-00000060  1b d0 d0 d0 05 7a 41 26  d4 6b 12 a0 b3 c6 33 13  |.....zA&.k....3.|
-00000070  4f 74 10 d6 91 fb b0 69  46 46 ca de 7c 05 d6 62  |Ot.....iFF..|..b|
-00000080  51 23 12 58 00 ff 25 8e  c8 5f 54 85 f4 2f e9 f9  |Q#.X..%.._T../..|
-00000090  f1 1e 32 b9 f1 a6 fb 90  9b a9 65 d2 c9 ea a7 1a  |..2.......e.....|
-000000a0  e8 c9 a8 bb 7e 3d 3f 03  62 fc f4 06 a4 a2 f7 41  |....~=?.b......A|
-000000b0  60 f5 f1 df 3e d6 31 51  f4 dc b1 d3 60 4b 84 4f  |`...>.1Q....`K.O|
-000000c0  99 e2 9f b2 f0 d5 fd b2  f3 5c 24 5f 91 a6 94 cd  |.........\$_....|
-000000d0  37 61 91 4e cc ae cd c1  b5 cc 58 5f 9a 91 a1 13  |7a.N......X_....|
-000000e0  23 42 8a c5 27 4c 66 32  69 9c 75 9f 2a ed 73 1d  |#B..'Lf2i.u.*.s.|
-000000f0  29 2e 36 50 34 b4 80 d2  08 e6 9f c6 3e da df 9f  |).6P4.......>...|
-00000100  e0 2a 08 88 47 b6 d3 ff  f7 6c 6c 91 1a 8e 53 89  |.*..G....ll...S.|
-00000110  53 6c b8 d7 83 37 ab 03  59 e6 4f 41 42 af d4 f9  |Sl...7..Y.OAB...|
-00000120  ac 9d ae d1 77 f1 71 79  a0 16 c4 c7 b5 a6 a9 9f  |....w.qy........|
-00000130  59 da 55 fb c5 88 8c 13  04 c2 06 39 8f ae 7e ca  |Y.U........9..~.|
-00000140  99 ce cd aa 86 0a 00 bd  56 f1 98 d9 c8 d2 c1 c0  |........V.......|
-00000150  df 16 c2 6f 78 da 66 3f  cc 43 c7 38 33 1b 3b 5b  |...ox.f?.C.83.;[|
-00000160  f8 7e d8 b7 ef 4c 6d c7  f6 84 56 8d 76 f7 0d 83  |.~...Lm...V.v...|
-00000170  94 e6 ad c5 f3 05 5c f4  17 69 d5 83 98 c3 43 8e  |......\..i....C.|
-00000180  9f a5 5c 7b 12 ea f4 1f  39 ce 0d 83 15 b1 e6 ce  |..\{....9.......|
-00000190  c1 35 9b 8c ec c6 d2 d7  f9 02 36 90 24 f4 3a 70  |.5........6.$.:p|
-000001a0  ce bb 8d bb 4b b2 aa 64  f0 b5 c0 88 cc 06 e3 9c  |....K..d........|
-000001b0  f7 70 64 fd 5d 48 f5 c8  07 48 c2 09 c4 07 56 b9  |.pd.]H...H....V.|
-000001c0  86 e9 d6 7b dc ac a5 00  2c 1d 80 8f 47 f2 c4 c7  |...{....,...G...|
-000001d0  ab dc 7b 41 7b 3d 47 db  09 12 02 9f 1b 63 e7 cc  |..{A{=G......c..|
-000001e0  38 1d 33 56 e0 ae 63 7a  95 73 5f e6 da 13 53 49  |8.3V..cz.s_...SI|
-000001f0  5f 69 e9 ff 86 26 bd 9a  dd be 5c 75 e7 69 66 b4  |_i...&....\u.if.|
-00000200  27 3f 79 d2 2e 8e 79 9e  89 42 58 20 a2 ca 8c 2a  |'?y...y..BX ...*|
-00000210  37 b8 99 81 66 3a 31 66  1a 95 4c 47 17 03 03 00  |7...f:1f..LG....|
-00000220  99 66 08 07 06 6d 95 fe  f1 72 2a 7c de 84 06 b0  |.f...m...r*|....|
-00000230  3d d7 d1 6b 47 0e 4d fb  9e ab 55 f7 71 c5 5d 11  |=..kG.M...U.q.].|
-00000240  cb c7 fb 45 90 9d 22 eb  ec 03 d6 ce 8c 01 ff 81  |...E..".........|
-00000250  a2 90 23 1d 7a f3 cb 16  76 a5 05 57 77 f6 af f0  |..#.z...v..Ww...|
-00000260  29 6c 6c 39 9e 99 55 c0  38 c3 31 68 49 b3 bf cc  |)ll9..U.8.1hI...|
-00000270  31 e2 6d a4 4c e7 99 53  2f 31 3f 05 2c 7c 1b 10  |1.m.L..S/1?.,|..|
-00000280  60 ce 8b 60 47 16 eb e5  8b be 1b 7a 95 b9 3c 60  |`..`G......z..<`|
-00000290  1c d6 b5 13 5f ad b9 bb  13 dd d6 08 8e 70 cb 2a  |...._........p.*|
-000002a0  26 3e df ce 7c 21 e5 27  7e 27 ec 75 b6 47 a0 89  |&>..|!.'~'.u.G..|
-000002b0  2e e1 3c ab 0d 72 90 d1  d5 07 17 03 03 00 35 82  |..<..r........5.|
-000002c0  6b 48 4a 9a 63 16 07 8f  b2 d3 4a 65 7d e0 c4 e8  |kHJ.c.....Je}...|
-000002d0  27 3e ce 4a 0a c8 63 e0  f9 70 98 c0 6a 12 39 ec  |'>.J..c..p..j.9.|
-000002e0  e1 52 de 73 58 2d f0 7c  bc 8d 41 16 be 89 a0 88  |.R.sX-.|..A.....|
-000002f0  56 e5 ef f6                                       |V...|
+00000000  14 03 03 00 01 01 17 03  03 02 11 79 f8 bd a7 4e  |...........y...N|
+00000010  90 84 77 6f d1 a8 95 67  b7 0b e2 7a 4e 16 e9 ca  |..wo...g...zN...|
+00000020  1c f3 31 df a8 0e 99 02  c0 09 68 de 6a bb c2 bd  |..1.......h.j...|
+00000030  19 10 30 65 e6 5d d1 43  e2 aa 81 ba ea 3d 30 9a  |..0e.].C.....=0.|
+00000040  bb a8 66 ef 91 d1 1d 4c  cd 93 97 19 f5 b7 52 1f  |..f....L......R.|
+00000050  c3 4b f8 dd 2f 39 53 54  68 06 dd 90 c1 75 57 9a  |.K../9STh....uW.|
+00000060  d6 9d c5 79 36 f9 5e bc  c6 9b b8 bd 3d 14 40 71  |...y6.^.....=.@q|
+00000070  a8 db 5c a8 d0 28 f3 a6  c1 37 29 c1 38 3f a3 51  |..\..(...7).8?.Q|
+00000080  29 5c 01 eb 5c 7e c7 09  e6 2b fd 48 6f 53 77 25  |)\..\~...+.HoSw%|
+00000090  c8 55 bb fd 68 21 a4 f0  f8 0e 52 41 97 81 20 78  |.U..h!....RA.. x|
+000000a0  5e b8 77 3e 4e 6c 0a b1  32 98 2e d4 58 dd 64 fa  |^.w>Nl..2...X.d.|
+000000b0  8a 3e ba ea 79 67 c1 01  97 d2 5c d6 09 81 57 b0  |.>..yg....\...W.|
+000000c0  fa c3 b8 3d 91 ee 7e 06  47 a8 3e 7b 59 74 14 44  |...=..~.G.>{Yt.D|
+000000d0  29 28 29 1f 52 00 b8 31  4f ae 60 d5 18 72 fb a7  |)().R..1O.`..r..|
+000000e0  21 0f 79 73 d8 e2 5c 6b  b7 aa 78 53 f0 83 b5 ec  |!.ys..\k..xS....|
+000000f0  89 fc d0 fd 84 2e f6 3b  65 1d ac fe e8 75 10 f6  |.......;e....u..|
+00000100  52 01 7f 5a 67 6d 1c 1d  82 4d eb 9d 2f fa 54 4e  |R..Zgm...M../.TN|
+00000110  0f 05 c8 d0 c3 50 6b cb  15 f0 27 5e 1d 15 b4 60  |.....Pk...'^...`|
+00000120  85 bc b0 0e 54 3a 10 54  f9 4c 43 db 57 74 96 4b  |....T:.T.LC.Wt.K|
+00000130  12 1c c8 1b 4c b7 d6 44  e7 df 95 9b 1d 28 cc d0  |....L..D.....(..|
+00000140  20 a5 9f 28 5d da 20 1a  46 42 1c b5 88 81 6b 3e  | ..(]. .FB....k>|
+00000150  0f 7b 37 5f b8 8e e5 b8  57 3c e7 03 6f 4f be 83  |.{7_....W<..oO..|
+00000160  5a 3a a9 46 c6 e9 42 68  4f 10 38 bc ba 4d 67 7b  |Z:.F..BhO.8..Mg{|
+00000170  19 9a b0 bd ce 9a 8f 21  ff eb 82 59 a6 2f 0a 0f  |.......!...Y./..|
+00000180  b2 eb 76 c0 e2 dc 3f f4  3b c5 26 d3 7e 8c ed c3  |..v...?.;.&.~...|
+00000190  5d 0f 80 56 a0 07 76 88  4c ab 04 3c aa 8a 44 65  |]..V..v.L..<..De|
+000001a0  a7 5a 7b 31 29 5f 41 b8  12 c0 c0 f1 cd 95 08 0e  |.Z{1)_A.........|
+000001b0  f7 89 a0 af 91 e6 52 14  5a 2b 39 c5 c6 4e b7 72  |......R.Z+9..N.r|
+000001c0  93 e2 a7 6f 00 b4 57 9b  20 e4 90 b9 57 f0 67 40  |...o..W. ...W.g@|
+000001d0  e3 87 7d f6 6b f6 87 91  7f f6 3b 99 f2 93 b3 35  |..}.k.....;....5|
+000001e0  e7 d4 fe 7c 1c b7 08 4a  00 de 7c 6c 85 df 2d 37  |...|...J..|l..-7|
+000001f0  3b 69 62 18 c6 f9 e0 e3  6e 1d 30 cd 35 7d 83 5c  |;ib.....n.0.5}.\|
+00000200  1d 0c d8 61 df 4b f3 20  77 81 b1 9e 5f 84 79 44  |...a.K. w..._.yD|
+00000210  93 b6 30 60 2d 76 4e 6d  4d 18 3a 21 17 03 03 00  |..0`-vNmM.:!....|
+00000220  99 30 99 a3 ff 5c 70 58  5a d7 f0 ec 97 a0 d9 b8  |.0...\pXZ.......|
+00000230  9e 98 08 f6 ec 87 48 3b  c6 46 c2 45 c4 29 ab 08  |......H;.F.E.)..|
+00000240  f2 ee 94 4d 89 c9 19 b4  0d b0 f6 df f7 a5 8d 4b  |...M...........K|
+00000250  2f 53 62 b8 ee 4c 8a cf  81 be fb 7e 16 2f ec f3  |/Sb..L.....~./..|
+00000260  03 49 18 93 dc d3 53 67  fc a2 03 f8 f6 ab 26 87  |.I....Sg......&.|
+00000270  92 32 7c 06 1a 12 14 29  cf a2 43 e4 36 04 2c ad  |.2|....)..C.6.,.|
+00000280  68 ea 5f 5a d2 83 81 d7  96 7d 8c 2e 9a 98 14 56  |h._Z.....}.....V|
+00000290  a7 a3 23 69 d5 fd 21 9e  2f 81 43 2b 8a ad 2e c9  |..#i..!./.C+....|
+000002a0  50 a8 a5 5c 28 b3 a0 62  c0 95 78 92 f7 3b 7b c0  |P..\(..b..x..;{.|
+000002b0  1c a9 29 c4 34 28 39 c4  0b ef 17 03 03 00 35 8d  |..).4(9.......5.|
+000002c0  35 f3 1d 55 34 aa 92 ff  8f e6 2e c2 9b 2f c6 c8  |5..U4......../..|
+000002d0  29 69 66 08 db fb 6f b5  22 4e bf 62 35 43 6c 72  |)if...o."N.b5Clr|
+000002e0  c6 2a c4 57 8c a9 42 2c  b8 5e 82 25 b2 92 aa 82  |.*.W..B,.^.%....|
+000002f0  77 5f a4 1f 17 03 03 00  13 cc 12 01 75 9c 9f d3  |w_..........u...|
+00000300  3f 17 17 a8 b8 8b b3 ae  dc f6 08 34              |?..........4|
 >>> Flow 4 (server to client)
-00000000  17 03 03 02 83 ce c4 10  39 1a fe 62 a2 ff 27 6d  |........9..b..'m|
-00000010  b7 e3 1d d6 8e b8 a2 7e  f5 30 87 35 16 41 fb 04  |.......~.0.5.A..|
-00000020  3c 79 9e 02 9b 06 4c a7  ba 01 5b cf 94 bc c8 08  |<y....L...[.....|
-00000030  15 03 91 2c 24 34 17 a4  60 dc a5 72 04 5d 78 49  |...,$4..`..r.]xI|
-00000040  4c 2f e4 6a df 1c 38 fe  b2 8c 61 5e a8 ac 3e d1  |L/.j..8...a^..>.|
-00000050  58 7d fe c1 e3 78 79 31  48 d2 74 c0 8d 17 97 6f  |X}...xy1H.t....o|
-00000060  30 bb 8a 2c 8c d4 76 3d  3f f0 20 24 3d 5a 21 0c  |0..,..v=?. $=Z!.|
-00000070  37 7b 14 45 e6 69 db ed  52 50 a0 77 e9 a2 84 59  |7{.E.i..RP.w...Y|
-00000080  0c 96 c1 ad 48 ed 8d 9f  00 4d f2 15 86 71 c0 fa  |....H....M...q..|
-00000090  14 b9 77 cb 9f 04 d9 1b  be da 68 8e 31 8f 25 14  |..w.......h.1.%.|
-000000a0  f5 43 bd e5 6e c5 10 ab  f7 68 22 7f c2 ba 5c a6  |.C..n....h"...\.|
-000000b0  88 31 c0 a5 fb 63 05 95  52 b3 04 94 14 fe eb 0c  |.1...c..R.......|
-000000c0  53 a0 c2 bf ae 58 e3 f9  84 22 6b ca 95 33 12 80  |S....X..."k..3..|
-000000d0  09 e2 97 b0 2b 4b ed fa  34 e1 5a b1 de 52 b1 2c  |....+K..4.Z..R.,|
-000000e0  a0 aa 11 d6 fa 07 e1 41  ed 36 9f 9a 1a 56 18 b0  |.......A.6...V..|
-000000f0  ef e7 85 dc 5b 53 23 56  c2 ac 34 64 c8 9d 4b 49  |....[S#V..4d..KI|
-00000100  6d 29 7e 4b 73 4f 0b 8e  30 86 87 ea cf 1c dd 62  |m)~KsO..0......b|
-00000110  c0 a4 96 aa fe 41 e7 25  94 8e 08 b5 4d 42 26 d3  |.....A.%....MB&.|
-00000120  ba 84 98 bf 27 2b d5 3d  37 b9 b1 b5 24 33 e3 4d  |....'+.=7...$3.M|
-00000130  3f 05 38 54 fe 2c 15 63  20 2e 70 c0 c6 da 0e 89  |?.8T.,.c .p.....|
-00000140  b6 99 07 db e3 7c 3e 58  d0 a3 2b 50 c4 f3 21 92  |.....|>X..+P..!.|
-00000150  62 e0 e9 b5 d4 7a 6b 23  a2 05 ef 9c f5 f5 05 57  |b....zk#.......W|
-00000160  cd d4 4d 0a 2f 17 ca ac  fc 9d 7e 60 ec 3c 80 8c  |..M./.....~`.<..|
-00000170  1f 99 da b7 f6 14 7a e1  86 76 50 8d f8 6b 92 24  |......z..vP..k.$|
-00000180  f2 b7 82 fa 3c 9b 14 af  0f 37 40 ae 7f 10 f5 0a  |....<....7@.....|
-00000190  f2 0f 0f bd 01 b7 0a f7  b6 d0 7f cf bf e6 67 55  |..............gU|
-000001a0  cc 36 af a6 d8 c4 ca 80  c7 af 35 ff 6e 83 56 30  |.6........5.n.V0|
-000001b0  62 26 49 bb 1a 04 8b 39  10 7b 0f 09 19 2b 0f 95  |b&I....9.{...+..|
-000001c0  08 9d c8 85 3b 5d 8c 97  16 ae cd 92 00 d5 3e 50  |....;]........>P|
-000001d0  54 66 85 8f 42 9b 60 3d  f8 99 ca c7 07 3b 51 18  |Tf..B.`=.....;Q.|
-000001e0  d5 20 37 57 35 0a d8 c6  13 0f 48 94 8f 50 7d 0e  |. 7W5.....H..P}.|
-000001f0  5a f0 98 b2 5d 5f 46 fb  ba 85 c8 4f ba 02 19 86  |Z...]_F....O....|
-00000200  0b ef 4a 04 49 1f 06 cd  be dc d5 32 74 14 d8 60  |..J.I......2t..`|
-00000210  17 a5 b5 a2 70 8e b1 75  29 bc e0 02 e0 a2 1c 7b  |....p..u)......{|
-00000220  58 cd 96 69 84 0f 95 7b  78 3e 09 72 a6 e0 50 7e  |X..i...{x>.r..P~|
-00000230  76 b0 7b 44 11 9b b8 7e  7d 09 49 91 75 5b 9b 6f  |v.{D...~}.I.u[.o|
-00000240  42 a4 e6 54 4d c6 21 65  c4 64 7d c6 29 74 13 8d  |B..TM.!e.d}.)t..|
-00000250  69 5f 20 8c f1 88 e8 1e  2d c3 13 d5 f5 52 70 24  |i_ .....-....Rp$|
-00000260  de ec 64 c7 00 3f 57 e2  3f c4 23 fe e9 65 e6 d9  |..d..?W.?.#..e..|
-00000270  92 ae f0 2f 05 4d 01 72  be 0d 7d c0 f4 30 ac 69  |.../.M.r..}..0.i|
-00000280  3c 7c c1 72 c1 b7 c4 c9  17 03 03 00 1e 73 8f 48  |<|.r.........s.H|
-00000290  cf 34 35 31 9b 63 59 59  1b 23 e1 6b b2 3a 0f df  |.451.cYY.#.k.:..|
-000002a0  21 69 8e 73 1a 61 09 5b  82 c7 78 17 03 03 00 13  |!i.s.a.[..x.....|
-000002b0  4f a0 ab 25 3f a4 85 9e  78 58 69 d2 2c c3 b6 df  |O..%?...xXi.,...|
-000002c0  32 4a 7f                                          |2J.|
+00000000  17 03 03 02 83 63 68 c7  ae a5 c2 03 56 49 d3 13  |.....ch.....VI..|
+00000010  45 f0 de 02 20 70 1a cb  a5 cc 6f fa 0e 4b 28 65  |E... p....o..K(e|
+00000020  4f 6d 76 2e b0 61 cf fe  be 43 82 02 44 06 e4 1e  |Omv..a...C..D...|
+00000030  91 0c 64 1b 0e 58 53 c0  15 84 e8 6a 23 64 a1 cb  |..d..XS....j#d..|
+00000040  cd af e6 98 c1 c2 10 23  2b dd 54 9c ff d8 11 af  |.......#+.T.....|
+00000050  41 0c 88 7b 77 5c 12 47  7e f9 61 97 d6 f4 65 a7  |A..{w\.G~.a...e.|
+00000060  5e 9c 06 0e 8a 96 5a 4c  60 f9 ce fb 52 a6 61 44  |^.....ZL`...R.aD|
+00000070  7a d1 41 54 10 51 b6 26  d4 18 fb 37 75 55 7f 18  |z.AT.Q.&...7uU..|
+00000080  10 39 ea b1 f7 d5 8f 3a  a4 e8 d8 be f5 2f c2 90  |.9.....:...../..|
+00000090  1a dd bc d7 50 b7 0e 7e  c8 71 88 8f a0 04 34 2d  |....P..~.q....4-|
+000000a0  6f 35 f5 3f 43 08 1d 28  c7 30 db 8e c0 6c cd 14  |o5.?C..(.0...l..|
+000000b0  93 10 fc b4 58 43 92 6d  a3 3c 2e 87 71 12 70 c5  |....XC.m.<..q.p.|
+000000c0  ec f8 64 5a 28 ee 3c 67  05 f4 00 f8 16 11 a6 49  |..dZ(.<g.......I|
+000000d0  ff 54 ee 27 a7 9e 01 c6  3d 8a e0 8f 7f 2c d7 90  |.T.'....=....,..|
+000000e0  99 68 98 38 1c d2 ac 71  32 90 e6 cd 05 7c b8 b5  |.h.8...q2....|..|
+000000f0  99 86 8d 8e 5b 57 c9 d6  c6 b0 a0 21 09 e9 87 4c  |....[W.....!...L|
+00000100  27 f2 de e0 24 19 98 ea  3e 60 33 65 13 5e 5f 05  |'...$...>`3e.^_.|
+00000110  7b 16 78 d9 8d 2a 92 16  62 02 fc 27 ee 72 f4 2e  |{.x..*..b..'.r..|
+00000120  86 11 32 55 a2 9b b7 d3  3a 3b 87 be 28 8f 30 e7  |..2U....:;..(.0.|
+00000130  c7 ca 34 51 e5 3b 96 55  c1 d2 b2 b1 4e 84 85 0c  |..4Q.;.U....N...|
+00000140  df d9 25 3e 29 b8 56 4a  32 b7 45 1a b3 05 c1 d6  |..%>).VJ2.E.....|
+00000150  ca ac 13 74 59 b6 0d 03  14 f2 fa b7 05 c4 2f da  |...tY........./.|
+00000160  11 65 a4 89 06 c6 fd 2b  10 3c 13 3d 92 d5 6a 1c  |.e.....+.<.=..j.|
+00000170  c5 01 10 b5 1a 3d a0 a5  ea ef 11 74 8b 68 24 20  |.....=.....t.h$ |
+00000180  04 58 68 e4 e3 69 b7 12  03 f1 4c dd 78 65 04 58  |.Xh..i....L.xe.X|
+00000190  d9 85 45 39 d2 74 18 f7  5c b4 59 fc 08 fb e0 49  |..E9.t..\.Y....I|
+000001a0  c6 73 e0 0d 18 05 6a 84  95 03 11 ad 73 1d 45 d3  |.s....j.....s.E.|
+000001b0  d7 66 c9 14 14 f4 ed 39  a6 b2 bd 81 ac 23 c0 d9  |.f.....9.....#..|
+000001c0  ba 6a 82 16 75 2f c1 31  4f 83 25 ce 87 fb 23 97  |.j..u/.1O.%...#.|
+000001d0  a0 0d 7c c8 2d 35 ce a6  e8 76 65 cb 72 cc 95 fc  |..|.-5...ve.r...|
+000001e0  8c 65 eb f7 74 7f a6 fc  1e 03 05 cd dc 56 8d 3c  |.e..t........V.<|
+000001f0  09 0b 74 48 24 72 19 07  c0 c4 a3 32 28 15 33 45  |..tH$r.....2(.3E|
+00000200  ef c6 02 f2 8d bf 39 a9  b9 41 bd 99 77 be 36 67  |......9..A..w.6g|
+00000210  0e eb 62 2b fa cd c9 6e  b8 59 d8 f9 2b dd 09 1e  |..b+...n.Y..+...|
+00000220  4c 4a 90 e5 d4 4c 54 10  b9 f1 e3 5a 88 4b 3f 30  |LJ...LT....Z.K?0|
+00000230  c9 7c d5 be e5 b0 44 4f  bb 41 7a 83 e2 47 0c 73  |.|....DO.Az..G.s|
+00000240  28 b9 f2 c0 6c 28 0c 3c  3a cd 34 92 5c 13 f8 15  |(...l(.<:.4.\...|
+00000250  88 5b 02 fa 65 fd 1c b9  c0 cc 78 17 37 cc 53 50  |.[..e.....x.7.SP|
+00000260  0f 53 5e a0 fa 08 48 93  c2 4e 7d c1 f9 bb f7 6a  |.S^...H..N}....j|
+00000270  e0 0e 8b 14 1a 64 60 b6  67 3a 07 68 13 20 e1 8a  |.....d`.g:.h. ..|
+00000280  f2 7b 0d 25 c6 11 2f 9e  17 03 03 00 1e 1e a5 9c  |.{.%../.........|
+00000290  f5 56 23 e2 91 d8 e1 fd  da 88 04 24 b5 66 79 06  |.V#........$.fy.|
+000002a0  b2 3d e8 95 60 e1 86 2d  34 f4 c8 17 03 03 00 13  |.=..`..-4.......|
+000002b0  2a c7 60 04 0d 2f b5 d7  d2 c2 f9 15 bf 26 d7 84  |*.`../.......&..|
+000002c0  05 98 ee                                          |...|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedNotGiven b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedNotGiven
index b839c95879..7a06770a57 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedNotGiven
+++ b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedNotGiven
@@ -1,103 +1,105 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 4a ea 7e 77 82  |...........J.~w.|
-00000010  17 37 46 db 49 14 d2 41  e4 14 b0 46 20 9d 50 45  |.7F.I..A...F .PE|
-00000020  d1 75 08 82 2b 8d bc 9a  75 e3 71 20 ce 77 9a 79  |.u..+...u.q .w.y|
-00000030  98 24 bc 15 be ac 30 fe  66 35 ab 51 be bd b4 fa  |.$....0.f5.Q....|
-00000040  6f 53 1f e9 5f 54 58 75  ce 94 f9 47 00 04 13 01  |oS.._TXu...G....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 00 69 af 00 d0  |............i...|
+00000010  54 e8 0e 25 4c 62 db 87  e1 af 15 9e cf 14 ac b6  |T..%Lb..........|
+00000020  ce 8c 5a 65 99 f3 c0 48  2e b6 00 20 c4 bf 7a 0b  |..Ze...H... ..z.|
+00000030  d8 da 4f 37 b8 12 7c ff  2e 1e ac 80 d4 32 77 0f  |..O7..|......2w.|
+00000040  92 8c b4 76 53 57 ba 7d  bb 15 78 c8 00 04 13 01  |...vSW.}..x.....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 e0  |-.....3.&.$... .|
-000000b0  64 7e 58 b6 e7 32 fc c9  d6 3e f7 e0 f5 6a 9c 3a  |d~X..2...>...j.:|
-000000c0  e6 8f 83 d7 1c 27 62 72  71 06 71 de 49 96 05     |.....'brq.q.I..|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 30  |-.....3.&.$... 0|
+000000b0  a0 2a f8 e2 67 08 84 a8  c9 fc f8 de 0e fb 3c 0c  |.*..g.........<.|
+000000c0  59 10 2d 50 e9 cc d4 32  5c 86 e2 6e 0d ba 03     |Y.-P...2\..n...|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 ce 77 9a 79  |........... .w.y|
-00000030  98 24 bc 15 be ac 30 fe  66 35 ab 51 be bd b4 fa  |.$....0.f5.Q....|
-00000040  6f 53 1f e9 5f 54 58 75  ce 94 f9 47 13 01 00 00  |oS.._TXu...G....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 c4 bf 7a 0b  |........... ..z.|
+00000030  d8 da 4f 37 b8 12 7c ff  2e 1e ac 80 d4 32 77 0f  |..O7..|......2w.|
+00000040  92 8c b4 76 53 57 ba 7d  bb 15 78 c8 13 01 00 00  |...vSW.}..x.....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 d0 8f 0a 7e 6c 33  |.............~l3|
-00000090  0b be 2a 24 0e fc af df  6e 7d ad 22 28 82 77 60  |..*$....n}."(.w`|
-000000a0  3d 17 03 03 00 3e 8f 87  8f f1 5a f6 6f eb eb d9  |=....>....Z.o...|
-000000b0  da aa fc 3c 6d ac 73 94  a3 13 5f fe 01 bb 75 eb  |...<m.s..._...u.|
-000000c0  ce d5 75 68 39 3c 0b 3c  5d ab 3f dc eb 6d 30 79  |..uh9<.<].?..m0y|
-000000d0  25 35 a8 2b 72 57 e4 9f  6f 4a 1e 03 74 eb 04 f9  |%5.+rW..oJ..t...|
-000000e0  c4 4f c1 46 17 03 03 02  6d 50 d5 4a 67 1e a7 43  |.O.F....mP.Jg..C|
-000000f0  50 f5 b9 55 8d 57 a3 0e  e4 b0 ae 6c 5b ca f9 d7  |P..U.W.....l[...|
-00000100  f7 22 34 92 72 76 a4 5b  c4 c7 0a 75 cc 97 0c 03  |."4.rv.[...u....|
-00000110  37 25 04 65 a6 fc da a8  fb 8c ef f1 25 d6 4b f6  |7%.e........%.K.|
-00000120  ed d5 80 2b 10 b2 0b 31  f5 33 d7 df a7 9b c7 6e  |...+...1.3.....n|
-00000130  52 f6 ed ac e0 20 1e f2  93 11 b7 bd b0 0d 5e 41  |R.... ........^A|
-00000140  be e4 b5 e4 a1 6d 21 45  27 1d 5e 65 fe 2c e9 f4  |.....m!E'.^e.,..|
-00000150  97 5c 45 5b 23 5a 8c dc  29 64 61 28 48 cf ae 3f  |.\E[#Z..)da(H..?|
-00000160  2c 21 b1 68 9e 09 74 76  77 65 f4 85 07 dc f3 0e  |,!.h..tvwe......|
-00000170  27 97 4d 60 47 35 31 13  92 15 90 f4 ca 24 84 6e  |'.M`G51......$.n|
-00000180  da 91 13 a3 37 54 4e 52  d4 9c 2f 82 6e 76 fd d7  |....7TNR../.nv..|
-00000190  81 29 fa 76 ac be 32 04  0d 7e d0 09 b0 47 ff 6d  |.).v..2..~...G.m|
-000001a0  37 32 6d 2c 8e d3 06 94  da 3f 20 87 56 f8 4a 2f  |72m,.....? .V.J/|
-000001b0  d6 75 4d 90 5c c1 e5 f6  82 c4 3c d9 da a2 95 0a  |.uM.\.....<.....|
-000001c0  4c 36 59 a9 10 50 a0 0d  61 06 4f 65 6e 64 bb 29  |L6Y..P..a.Oend.)|
-000001d0  42 9f 62 81 65 54 22 cb  4c a5 95 1b 2a 49 18 2f  |B.b.eT".L...*I./|
-000001e0  fc 54 b4 38 27 3f cf ab  b0 97 3e 17 8b ae 98 a0  |.T.8'?....>.....|
-000001f0  50 76 d6 79 39 e8 25 bc  3b d9 5a a4 a8 5e 08 6a  |Pv.y9.%.;.Z..^.j|
-00000200  1c 48 b1 11 f0 d9 b9 48  39 e1 23 db 41 8c bf bd  |.H.....H9.#.A...|
-00000210  20 27 7b 0c 89 10 1f b0  ae 70 18 9a 7f f2 b4 1d  | '{......p......|
-00000220  20 cd 6d 80 38 00 a4 33  de 22 ef f6 42 52 c7 66  | .m.8..3."..BR.f|
-00000230  83 4a 67 18 6b a6 38 27  d3 40 cf a2 a9 3e 58 06  |.Jg.k.8'.@...>X.|
-00000240  91 a7 36 08 29 10 4d 8f  1b f9 7c 5a 17 05 81 b9  |..6.).M...|Z....|
-00000250  4b 60 48 40 49 73 63 8a  ef 9f f2 9e 80 85 57 fa  |K`H@Isc.......W.|
-00000260  0a b8 72 83 f3 26 fa 07  ae d2 47 99 b5 a6 5d c5  |..r..&....G...].|
-00000270  1e b5 fc ea 0f 17 f8 ba  e2 5c 7d 59 70 53 2e 23  |.........\}YpS.#|
-00000280  f7 55 75 cb de 82 dc ca  b1 bf 3f 5f 7d 7d 92 3c  |.Uu.......?_}}.<|
-00000290  29 29 64 30 74 0a 01 0b  c0 95 db 45 fe 20 be 38  |))d0t......E. .8|
-000002a0  c5 87 b7 e4 a9 93 63 67  6b 9a 2f 24 9e 62 8f 1d  |......cgk./$.b..|
-000002b0  bd 8c 4a d4 b0 0f 95 2f  56 b2 1c e8 5a 58 81 2e  |..J..../V...ZX..|
-000002c0  b5 b5 b5 f2 1b 7f 6c 39  58 75 51 dc 83 2a 59 0b  |......l9XuQ..*Y.|
-000002d0  78 5e 22 7e af ee 59 af  b9 8f dc 65 97 af a5 b5  |x^"~..Y....e....|
-000002e0  b8 50 af 35 51 30 e7 0a  75 e2 d0 33 e2 fb f4 b1  |.P.5Q0..u..3....|
-000002f0  99 cd 5f 72 6b a9 f8 85  a1 a5 19 7e 2b 91 01 19  |.._rk......~+...|
-00000300  09 dd 88 6e a7 d6 54 57  cd ef d0 97 6a 68 d9 6e  |...n..TW....jh.n|
-00000310  52 38 ef a5 fa 84 63 70  f0 6d 64 ec 66 1a c9 b5  |R8....cp.md.f...|
-00000320  78 ba 17 74 f4 b4 2b a2  fe 9a 7f 38 b8 5e 8b 56  |x..t..+....8.^.V|
-00000330  a6 7b 2c 92 7f db 58 c8  fa f9 2d 6b 00 25 dc 0a  |.{,...X...-k.%..|
-00000340  aa 13 e8 40 f3 fd 47 23  f6 bf 1c 30 fc 91 18 95  |...@..G#...0....|
-00000350  ac a8 82 3d f5 ef 17 03  03 00 99 7e 30 4f f1 00  |...=.......~0O..|
-00000360  1e dd eb c6 54 d2 f5 f7  21 aa 6b b0 83 0c fa 8b  |....T...!.k.....|
-00000370  12 af ac 15 3e 54 b6 1c  85 9b 0c 80 02 d8 e3 5f  |....>T........._|
-00000380  36 57 64 fe 7a b8 31 d0  aa 59 f1 e6 af e0 27 c5  |6Wd.z.1..Y....'.|
-00000390  b8 d8 2f ab e0 cc c3 02  18 73 30 36 b5 2a 0d 12  |../......s06.*..|
-000003a0  a4 45 e6 c3 79 9f 54 cb  51 61 1a b8 aa 87 45 43  |.E..y.T.Qa....EC|
-000003b0  8e 93 58 66 f2 97 cb 3b  44 df ae 93 17 de 22 99  |..Xf...;D.....".|
-000003c0  3c b4 9d 21 a6 db 03 ce  7b fb 67 b9 6e fb ab 50  |<..!....{.g.n..P|
-000003d0  f8 33 9f 20 a0 fb e9 54  bb 62 16 19 d6 df 8c fe  |.3. ...T.b......|
-000003e0  3d 63 42 7c b0 72 2b 0d  87 1e f7 7d bb 59 ba f5  |=cB|.r+....}.Y..|
-000003f0  d6 e8 f3 57 17 03 03 00  35 9e 6f 39 92 2e 32 10  |...W....5.o9..2.|
-00000400  03 cd f0 28 2c 1a 32 77  19 c8 39 38 60 0c 28 b7  |...(,.2w..98`.(.|
-00000410  8c 3a d8 50 a1 44 e4 d6  c5 64 59 88 2d a4 23 c9  |.:.P.D...dY.-.#.|
-00000420  26 d1 96 0c c9 5d da 84  3e 8a 7d fe 80 77        |&....]..>.}..w|
+00000080  03 03 00 01 01 17 03 03  00 17 47 a8 92 ce cd bb  |..........G.....|
+00000090  b5 b2 f6 47 50 c3 e7 c4  44 59 20 07 13 9a ca 98  |...GP...DY .....|
+000000a0  f5 17 03 03 00 52 b6 9d  37 b2 ed bf 53 10 e2 28  |.....R..7...S..(|
+000000b0  09 25 e5 f1 f8 6d 10 99  f8 b0 b8 1d cd 5c 82 ff  |.%...m.......\..|
+000000c0  de fd 9d 8e 89 94 2e 7a  7f ed 30 80 7e f0 e5 ef  |.......z..0.~...|
+000000d0  13 06 7b cf 8f 91 c9 38  e0 77 52 80 0d 74 a2 28  |..{....8.wR..t.(|
+000000e0  a7 73 cd 06 df c4 7e 04  ad 6e e3 44 04 86 98 95  |.s....~..n.D....|
+000000f0  b7 2d 76 99 3e 8b cd 7c  17 03 03 02 6d cb e5 77  |.-v.>..|....m..w|
+00000100  58 3e c2 74 44 db 85 f8  54 12 02 89 8d 2b 8d 24  |X>.tD...T....+.$|
+00000110  2a c0 db 71 25 b8 23 a1  86 1a 09 66 8e 60 b9 58  |*..q%.#....f.`.X|
+00000120  40 0f 72 34 95 e2 6b 7c  76 8a 85 e5 dd cd be 0a  |@.r4..k|v.......|
+00000130  1f a3 13 42 aa 58 d7 95  0a 69 fc 60 5a 4d 17 db  |...B.X...i.`ZM..|
+00000140  19 59 d3 86 04 3e c2 1b  93 76 68 27 53 ae 07 af  |.Y...>...vh'S...|
+00000150  47 4e e6 03 b8 fe 8e c5  06 f1 84 54 0c e5 24 be  |GN.........T..$.|
+00000160  83 43 1f da 1e 3e 7e a3  2f 2f 4d bc cd e5 a5 b5  |.C...>~.//M.....|
+00000170  5d 66 e1 2a 9b 1e 76 6c  be e7 9d f7 ed c5 1b e9  |]f.*..vl........|
+00000180  91 39 18 30 22 b5 d8 71  66 4d 62 b8 6f 94 7f 5f  |.9.0"..qfMb.o.._|
+00000190  84 77 a2 b5 79 02 a1 44  6a 5c d2 39 c2 95 d6 8e  |.w..y..Dj\.9....|
+000001a0  49 36 91 97 2e 02 59 47  e8 fa 78 b9 a7 0e 41 f2  |I6....YG..x...A.|
+000001b0  df 92 44 7b 59 8f 9c e9  c8 1b 0a 15 cf 1a fe 5a  |..D{Y..........Z|
+000001c0  b2 5a 9d 9c b2 0b 1e 48  03 a9 2b 73 df 9f dd b2  |.Z.....H..+s....|
+000001d0  30 d1 ba bd 46 e6 50 30  ed e3 c5 f7 d8 96 d5 cc  |0...F.P0........|
+000001e0  d2 3a 39 3b f0 a1 f2 8e  29 c4 be e9 ee af cb 7b  |.:9;....)......{|
+000001f0  f6 7d c3 be 4e 20 6e 63  21 50 d5 34 9a b4 9c 7f  |.}..N nc!P.4....|
+00000200  95 22 15 e3 ad 12 c8 6a  9c 68 a3 c1 35 c1 e1 fa  |.".....j.h..5...|
+00000210  ce 15 ef 12 b5 50 5b d3  56 8a 24 b0 61 ca 67 1d  |.....P[.V.$.a.g.|
+00000220  60 12 b3 4b 42 6a 3d ba  ef 80 b1 b9 74 cf ba e0  |`..KBj=.....t...|
+00000230  95 5f 1a b9 c6 24 d7 c5  ec 96 3f 6c e8 13 39 66  |._...$....?l..9f|
+00000240  da e6 49 39 dc ca bc 2a  50 10 cf 51 fe d0 eb 80  |..I9...*P..Q....|
+00000250  9c 21 dc 9d ae 10 31 d6  9c 9b ac 3e d6 84 36 e6  |.!....1....>..6.|
+00000260  76 a1 d2 86 2a a0 2b d8  91 ba c3 f0 17 f7 7a 69  |v...*.+.......zi|
+00000270  0d d3 14 6f ca ba 33 d2  d0 2e 85 a9 d7 dc d2 4a  |...o..3........J|
+00000280  dc bf 88 68 73 4f b1 35  e0 36 3b ed bd f6 37 0b  |...hsO.5.6;...7.|
+00000290  07 32 a1 96 81 29 63 e1  38 4d 52 7c 5a d0 4c 6c  |.2...)c.8MR|Z.Ll|
+000002a0  dd 65 83 75 1d 9e bc e4  c8 e7 75 13 5f 71 11 87  |.e.u......u._q..|
+000002b0  ea 4b f3 ee d2 fd 38 2a  88 a6 35 e4 a8 63 77 0e  |.K....8*..5..cw.|
+000002c0  5f 57 ac a6 a2 e7 43 3c  79 1a 2d c9 1d 5f 65 22  |_W....C<y.-.._e"|
+000002d0  f1 c3 a3 17 79 ca ce 0e  6f e8 15 fb 73 dc 31 f8  |....y...o...s.1.|
+000002e0  99 79 fe d4 b1 e2 0d f1  4c a2 c6 02 51 27 ee cc  |.y......L...Q'..|
+000002f0  3c 8e 6b cf 01 82 b1 d6  f9 6e aa 98 4b 83 07 84  |<.k......n..K...|
+00000300  ef 49 4f ff a2 06 63 43  e1 2d 9e 1b c0 9c d9 60  |.IO...cC.-.....`|
+00000310  ce 68 de ea 22 d4 20 7f  7f 62 3a 7c bf 6c 55 a5  |.h..". ..b:|.lU.|
+00000320  31 5a 86 c4 59 75 28 d7  20 9d d6 1d 3c e4 15 00  |1Z..Yu(. ...<...|
+00000330  74 ad fb 26 3b 9f af 2e  20 5c a5 40 e1 24 fa e6  |t..&;... \.@.$..|
+00000340  f2 7d d3 29 69 0b 70 8a  6c 16 58 52 bd 32 a3 00  |.}.)i.p.l.XR.2..|
+00000350  23 e4 b5 a2 eb b6 71 56  1a 65 d5 26 db 83 55 aa  |#.....qV.e.&..U.|
+00000360  a9 1b 91 99 34 44 f9 1a  5e 2a 17 03 03 00 99 67  |....4D..^*.....g|
+00000370  bf c9 76 ba cc e9 e4 6e  5f f8 45 6f d6 b5 02 e8  |..v....n_.Eo....|
+00000380  b9 e3 05 44 14 be 6d cb  2f 84 8c ff 54 02 3b 06  |...D..m./...T.;.|
+00000390  cd 31 f0 c3 14 9f 68 a6  7c 05 1b 21 35 af fb 3c  |.1....h.|..!5..<|
+000003a0  4e ec c9 66 e8 20 04 8b  50 0a bc b5 6d 9a 52 b9  |N..f. ..P...m.R.|
+000003b0  e8 38 78 6b dc 22 41 e5  a9 82 3e bb 4b e7 35 e6  |.8xk."A...>.K.5.|
+000003c0  29 1d 3e ba a0 91 22 0a  8a aa a3 f8 9b eb 77 fe  |).>...".......w.|
+000003d0  19 ac 2e a7 29 ab 8f 61  91 af 09 b1 3b b3 4b 69  |....)..a....;.Ki|
+000003e0  e6 96 a3 05 46 db 28 9b  1d d0 79 71 3d 93 4e 66  |....F.(...yq=.Nf|
+000003f0  5d f4 22 38 91 a1 30 c5  c3 b7 72 fa e6 91 d8 a4  |]."8..0...r.....|
+00000400  e9 a0 47 cc 5a 87 5e 60  17 03 03 00 35 ce b7 6e  |..G.Z.^`....5..n|
+00000410  2c 11 dc d4 b8 e1 a4 4b  d8 d6 09 1e fe e3 d3 d3  |,......K........|
+00000420  52 be fc cc af 5d 73 45  db 1e 05 b6 b1 38 59 65  |R....]sE.....8Ye|
+00000430  df 72 6d 7b af b5 7a 3d  e1 8a 27 44 6e 72 25 04  |.rm{..z=..'Dnr%.|
+00000440  7c 61                                             ||a|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 19 87 49 99 a6 d9  |............I...|
-00000010  ed cd f7 7a 75 14 e1 26  41 d2 6e 5c 79 a6 be 7c  |...zu..&A.n\y..||
-00000020  5d 9d 44 36 17 03 03 00  35 1b 51 a9 b1 ce 11 ed  |].D6....5.Q.....|
-00000030  95 47 34 b9 3d 2f 6e 27  b2 e5 31 54 7f e3 8a 11  |.G4.=/n'..1T....|
-00000040  fd 54 75 2c b6 8a 56 25  00 29 a7 5f 7a 1e 16 be  |.Tu,..V%.)._z...|
-00000050  16 e3 86 3a 72 84 0e bc  40 ef fd ad 18 33        |...:r...@....3|
+00000000  14 03 03 00 01 01 17 03  03 00 19 01 ab 91 41 25  |..............A%|
+00000010  d3 52 97 b2 f8 4e 57 9d  c5 d3 7d 34 c4 c3 44 93  |.R...NW...}4..D.|
+00000020  79 a5 0c fe 17 03 03 00  35 ba 56 09 d8 9d 73 5e  |y.......5.V...s^|
+00000030  f4 f4 03 4d bf f7 e4 ab  cc 83 26 28 cc 68 78 91  |...M......&(.hx.|
+00000040  9f 6f f6 dc d5 34 e5 a5  e6 86 11 b3 71 89 70 25  |.o...4......q.p%|
+00000050  8c 83 79 b7 c8 56 92 1d  98 c7 35 cd bb 56        |..y..V....5..V|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 8b 69 2e 81  c4 4d 43 a6 1f 96 b7 8e  |.....i...MC.....|
-00000010  87 4a 9b be 48 3c 31 18  98 f4 8c 04 24 b2 52 96  |.J..H<1.....$.R.|
-00000020  04 b5 12 7c 54 37 83 6d  51 42 c6 52 f4 a5 bc d3  |...|T7.mQB.R....|
-00000030  d1 c8 29 ab 4f e4 02 da  74 ec 8e 13 ad 03 f3 e0  |..).O...t.......|
-00000040  7f 44 58 6b c7 28 a5 6a  75 30 b8 b1 31 38 fe ba  |.DXk.(.ju0..18..|
-00000050  e7 27 ae b3 e7 cb 5e 78  24 82 03 61 ba ae dd 4c  |.'....^x$..a...L|
-00000060  c6 7b f3 45 cf 6f a8 dc  7d 5d 73 65 db ae dc 10  |.{.E.o..}]se....|
-00000070  ff 32 dc 4c b4 5e dc ce  4c 34 37 83 a0 0c d5 20  |.2.L.^..L47.... |
-00000080  f1 f6 81 42 bc 63 65 47  80 d0 d6 f3 08 aa e2 58  |...B.ceG.......X|
-00000090  17 03 03 00 1e 85 84 f3  e4 0f a8 24 c0 fe fa 2c  |...........$...,|
-000000a0  8b 60 52 32 73 2b 95 e9  37 3d 1c bd 2f ee ff e2  |.`R2s+..7=../...|
-000000b0  70 13 df 17 03 03 00 13  65 2b 11 5f 50 7c 11 eb  |p.......e+._P|..|
-000000c0  3b 06 75 23 28 13 ca 4a  b5 fb dc                 |;.u#(..J...|
+00000000  17 03 03 00 8b eb fd 9e  19 36 7f 54 7f 9f 5a 6b  |.........6.T..Zk|
+00000010  31 0e e8 ca f3 40 7d 74  0d 82 6f 97 41 fb 15 52  |1....@}t..o.A..R|
+00000020  36 00 50 c3 c5 36 ea e3  8f ca 02 b1 de ed 61 8e  |6.P..6........a.|
+00000030  60 0a d8 cf 0a 7c 47 60  87 3f fa 00 6f 74 a8 42  |`....|G`.?..ot.B|
+00000040  c1 8d df f7 4d 7c ac c0  52 7c c9 21 5c 45 32 3f  |....M|..R|.!\E2?|
+00000050  42 0d 75 64 76 93 18 29  a1 50 06 36 94 bb 1e 52  |B.udv..).P.6...R|
+00000060  31 5b b7 32 9a b1 9f 59  30 8a da ff 93 4f c1 b3  |1[.2...Y0....O..|
+00000070  e9 8d f2 ec 4a 7b 01 51  5e a2 9b ea 8d a8 53 bd  |....J{.Q^.....S.|
+00000080  db 94 88 73 3b 9f da 77  a8 de 11 55 7b 06 0f c6  |...s;..w...U{...|
+00000090  17 03 03 00 1e 1b 76 21  ea fd a4 47 6e ec 6e 26  |......v!...Gn.n&|
+000000a0  00 3e fc 2f 87 8f 4e ee  08 58 e7 cc 46 aa b7 8c  |.>./..N..X..F...|
+000000b0  c1 5d dd 17 03 03 00 13  dd ed 88 b0 f5 e8 17 f1  |.]..............|
+000000c0  66 85 c4 f5 6b 47 7d 5f  19 21 7f                 |f...kG}_.!.|
