commit 8741504888b8ca77736716926e472e90c0e1f765
Author: Adam Langley <agl@golang.org>
Date:   Wed Aug 17 16:45:47 2016 -0700

    crypto/tls: support AES-128-CBC cipher suites with SHA-256.
    
    These were new with TLS 1.2 and, reportedly, some servers require it.
    Since it's easy, this change adds suport for three flavours of
    AES-128-CBC with SHA-256 MACs.
    
    Other testdata/ files have to be updated because this changes the list
    of cipher suites offered by default by the client.
    
    Fixes #15487.
    
    Change-Id: I1b14330c31eeda20185409a37072343552c3464f
    Reviewed-on: https://go-review.googlesource.com/27315
    Run-TryBot: Adam Langley <agl@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Reviewed-by: Jonathan Rudenberg <jonathan@titanous.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
---
 src/crypto/tls/cipher_suites.go                    |  25 +-
 src/crypto/tls/handshake_client_test.go            |  26 +
 .../testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA  | 104 ++--
 .../testdata/Client-TLSv10-ClientCert-ECDSA-RSA    |  64 +-
 .../testdata/Client-TLSv10-ClientCert-RSA-ECDSA    | 104 ++--
 .../tls/testdata/Client-TLSv10-ClientCert-RSA-RSA  |  64 +-
 .../tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES     |  84 +--
 .../tls/testdata/Client-TLSv10-ECDHE-RSA-AES       |  82 +--
 src/crypto/tls/testdata/Client-TLSv10-RSA-RC4      |  46 +-
 .../tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES     |  84 +--
 .../tls/testdata/Client-TLSv11-ECDHE-RSA-AES       |  82 +--
 src/crypto/tls/testdata/Client-TLSv11-RSA-RC4      |  46 +-
 .../tls/testdata/Client-TLSv12-AES128-GCM-SHA256   |  50 +-
 .../tls/testdata/Client-TLSv12-AES128-SHA256       |  88 +++
 .../tls/testdata/Client-TLSv12-AES256-GCM-SHA384   |  50 +-
 src/crypto/tls/testdata/Client-TLSv12-ALPN         |  80 +--
 src/crypto/tls/testdata/Client-TLSv12-ALPN-NoMatch |  79 +--
 .../testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA  | 104 ++--
 .../testdata/Client-TLSv12-ClientCert-ECDSA-RSA    |  66 +-
 .../Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384 |  94 +--
 .../testdata/Client-TLSv12-ClientCert-RSA-ECDSA    | 102 ++--
 .../tls/testdata/Client-TLSv12-ClientCert-RSA-RSA  |  64 +-
 .../tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES     |  84 +--
 .../tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM |  80 +--
 .../Client-TLSv12-ECDHE-ECDSA-AES128-SHA256        |  94 +++
 .../Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384    |  80 +--
 .../tls/testdata/Client-TLSv12-ECDHE-RSA-AES       |  82 +--
 .../testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256 |  98 +++
 src/crypto/tls/testdata/Client-TLSv12-RSA-RC4      |  46 +-
 .../tls/testdata/Client-TLSv12-RenegotiateOnce     | 379 ++++++------
 .../tls/testdata/Client-TLSv12-RenegotiateTwice    | 680 +++++++++++----------
 .../Client-TLSv12-RenegotiateTwiceRejected         | 387 ++++++------
 .../testdata/Client-TLSv12-RenegotiationRejected   |  86 +--
 src/crypto/tls/testdata/Client-TLSv12-SCT          |  76 +--
 34 files changed, 2043 insertions(+), 1717 deletions(-)

diff --git a/src/crypto/tls/cipher_suites.go b/src/crypto/tls/cipher_suites.go
index e69f5f966e..dba512f488 100644
--- a/src/crypto/tls/cipher_suites.go
+++ b/src/crypto/tls/cipher_suites.go
@@ -11,6 +11,7 @@ import (
 	"crypto/hmac"
 	"crypto/rc4"
 	"crypto/sha1"
+	"crypto/sha256"
 	"crypto/x509"
 	"hash"
 )
@@ -73,25 +74,30 @@ type cipherSuite struct {
 }
 
 var cipherSuites = []*cipherSuite{
-	// Ciphersuite order is chosen so that ECDHE comes before plain RSA
-	// and RC4 comes before AES-CBC (because of the Lucky13 attack).
+	// Ciphersuite order is chosen so that ECDHE comes before plain RSA and
+	// GCM is top preference.
 	{TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256, 16, 0, 4, ecdheRSAKA, suiteECDHE | suiteTLS12, nil, nil, aeadAESGCM},
 	{TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256, 16, 0, 4, ecdheECDSAKA, suiteECDHE | suiteECDSA | suiteTLS12, nil, nil, aeadAESGCM},
 	{TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384, 32, 0, 4, ecdheRSAKA, suiteECDHE | suiteTLS12 | suiteSHA384, nil, nil, aeadAESGCM},
 	{TLS_ECDHE_ECDSA_WITH_AES_256_GCM_SHA384, 32, 0, 4, ecdheECDSAKA, suiteECDHE | suiteECDSA | suiteTLS12 | suiteSHA384, nil, nil, aeadAESGCM},
-	{TLS_ECDHE_RSA_WITH_RC4_128_SHA, 16, 20, 0, ecdheRSAKA, suiteECDHE | suiteDefaultOff, cipherRC4, macSHA1, nil},
-	{TLS_ECDHE_ECDSA_WITH_RC4_128_SHA, 16, 20, 0, ecdheECDSAKA, suiteECDHE | suiteECDSA | suiteDefaultOff, cipherRC4, macSHA1, nil},
+	{TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256, 16, 32, 16, ecdheRSAKA, suiteECDHE | suiteTLS12, cipherAES, macSHA256, nil},
 	{TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA, 16, 20, 16, ecdheRSAKA, suiteECDHE, cipherAES, macSHA1, nil},
+	{TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256, 16, 32, 16, ecdheECDSAKA, suiteECDHE | suiteECDSA | suiteTLS12, cipherAES, macSHA256, nil},
 	{TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA, 16, 20, 16, ecdheECDSAKA, suiteECDHE | suiteECDSA, cipherAES, macSHA1, nil},
 	{TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA, 32, 20, 16, ecdheRSAKA, suiteECDHE, cipherAES, macSHA1, nil},
 	{TLS_ECDHE_ECDSA_WITH_AES_256_CBC_SHA, 32, 20, 16, ecdheECDSAKA, suiteECDHE | suiteECDSA, cipherAES, macSHA1, nil},
 	{TLS_RSA_WITH_AES_128_GCM_SHA256, 16, 0, 4, rsaKA, suiteTLS12, nil, nil, aeadAESGCM},
 	{TLS_RSA_WITH_AES_256_GCM_SHA384, 32, 0, 4, rsaKA, suiteTLS12 | suiteSHA384, nil, nil, aeadAESGCM},
-	{TLS_RSA_WITH_RC4_128_SHA, 16, 20, 0, rsaKA, suiteDefaultOff, cipherRC4, macSHA1, nil},
+	{TLS_RSA_WITH_AES_128_CBC_SHA256, 16, 32, 16, rsaKA, suiteTLS12, cipherAES, macSHA256, nil},
 	{TLS_RSA_WITH_AES_128_CBC_SHA, 16, 20, 16, rsaKA, 0, cipherAES, macSHA1, nil},
 	{TLS_RSA_WITH_AES_256_CBC_SHA, 32, 20, 16, rsaKA, 0, cipherAES, macSHA1, nil},
 	{TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA, 24, 20, 8, ecdheRSAKA, suiteECDHE, cipher3DES, macSHA1, nil},
 	{TLS_RSA_WITH_3DES_EDE_CBC_SHA, 24, 20, 8, rsaKA, 0, cipher3DES, macSHA1, nil},
+
+	// RC4-based cipher suites are disabled by default.
+	{TLS_RSA_WITH_RC4_128_SHA, 16, 20, 0, rsaKA, suiteDefaultOff, cipherRC4, macSHA1, nil},
+	{TLS_ECDHE_RSA_WITH_RC4_128_SHA, 16, 20, 0, ecdheRSAKA, suiteECDHE | suiteDefaultOff, cipherRC4, macSHA1, nil},
+	{TLS_ECDHE_ECDSA_WITH_RC4_128_SHA, 16, 20, 0, ecdheECDSAKA, suiteECDHE | suiteECDSA | suiteDefaultOff, cipherRC4, macSHA1, nil},
 }
 
 func cipherRC4(key, iv []byte, isRead bool) interface{} {
@@ -128,6 +134,12 @@ func macSHA1(version uint16, key []byte) macFunction {
 	return tls10MAC{hmac.New(sha1.New, key)}
 }
 
+// macSHA1 returns a SHA-256 based MAC. These are only supported in TLS 1.2 so
+// the given version is ignored.
+func macSHA256(version uint16, key []byte) macFunction {
+	return tls10MAC{hmac.New(sha256.New, key)}
+}
+
 type macFunction interface {
 	Size() int
 	MAC(digestBuf, seq, header, data []byte) []byte
@@ -270,6 +282,7 @@ const (
 	TLS_RSA_WITH_3DES_EDE_CBC_SHA           uint16 = 0x000a
 	TLS_RSA_WITH_AES_128_CBC_SHA            uint16 = 0x002f
 	TLS_RSA_WITH_AES_256_CBC_SHA            uint16 = 0x0035
+	TLS_RSA_WITH_AES_128_CBC_SHA256         uint16 = 0x003c
 	TLS_RSA_WITH_AES_128_GCM_SHA256         uint16 = 0x009c
 	TLS_RSA_WITH_AES_256_GCM_SHA384         uint16 = 0x009d
 	TLS_ECDHE_ECDSA_WITH_RC4_128_SHA        uint16 = 0xc007
@@ -279,6 +292,8 @@ const (
 	TLS_ECDHE_RSA_WITH_3DES_EDE_CBC_SHA     uint16 = 0xc012
 	TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA      uint16 = 0xc013
 	TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA      uint16 = 0xc014
+	TLS_ECDHE_ECDSA_WITH_AES_128_CBC_SHA256 uint16 = 0xc023
+	TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256   uint16 = 0xc027
 	TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256   uint16 = 0xc02f
 	TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256 uint16 = 0xc02b
 	TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384   uint16 = 0xc030
diff --git a/src/crypto/tls/handshake_client_test.go b/src/crypto/tls/handshake_client_test.go
index ce987f11c4..62751b8b7c 100644
--- a/src/crypto/tls/handshake_client_test.go
+++ b/src/crypto/tls/handshake_client_test.go
@@ -508,6 +508,32 @@ func TestHandshakeClientAES256GCMSHA384(t *testing.T) {
 	runClientTestTLS12(t, test)
 }
 
+func TestHandshakeClientAES128CBCSHA256(t *testing.T) {
+	test := &clientTest{
+		name:    "AES128-SHA256",
+		command: []string{"openssl", "s_server", "-cipher", "AES128-SHA256"},
+	}
+	runClientTestTLS12(t, test)
+}
+
+func TestHandshakeClientECDHERSAAES128CBCSHA256(t *testing.T) {
+	test := &clientTest{
+		name:    "ECDHE-RSA-AES128-SHA256",
+		command: []string{"openssl", "s_server", "-cipher", "ECDHE-RSA-AES128-SHA256"},
+	}
+	runClientTestTLS12(t, test)
+}
+
+func TestHandshakeClientECDHEECDSAAES128CBCSHA256(t *testing.T) {
+	test := &clientTest{
+		name:    "ECDHE-ECDSA-AES128-SHA256",
+		command: []string{"openssl", "s_server", "-cipher", "ECDHE-ECDSA-AES128-SHA256"},
+		cert:    testECDSACertificate,
+		key:     testECDSAPrivateKey,
+	}
+	runClientTestTLS12(t, test)
+}
+
 func TestHandshakeClientCertRSA(t *testing.T) {
 	config := testConfig.clone()
 	cert, _ := X509KeyPair([]byte(clientCertificatePEM), []byte(clientKeyPEM))
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA
index 49cd109b45..3709744edf 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 36 00 05 00 05  01 00 00 00 00 00 0a 00  |...6............|
-00000060  08 00 06 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
-00000070  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
-00000080  03 ff 01 00 01 00 00 12  00 00                    |..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 59 02 00 00  55 03 01 75 a2 11 1e 9d  |....Y...U..u....|
-00000010  5c 45 79 41 ae d4 f0 0b  c8 45 86 2c e8 a0 a0 c9  |\EyA.....E.,....|
-00000020  37 a9 55 f4 f4 a8 f0 a5  f8 64 ad 20 96 c5 22 52  |7.U......d. .."R|
-00000030  3f 37 2f 7c 75 39 64 3c  4c 96 01 e1 bf 12 0a 9c  |?7/|u9d<L.......|
-00000040  57 36 5a 0b 7c e6 70 e3  28 64 82 f1 c0 09 00 00  |W6Z.|.p.(d......|
+00000000  16 03 01 00 59 02 00 00  55 03 01 e1 f3 09 aa 74  |....Y...U......t|
+00000010  61 78 98 9e 67 71 72 06  52 62 67 4d a3 ee 63 b3  |ax..gqr.RbgM..c.|
+00000020  5f a2 3b 5a 16 34 46 08  d6 5d 37 20 f2 1c 60 07  |_.;Z.4F..]7 ..`.|
+00000030  19 16 cf d8 c6 d2 f3 b1  67 79 2a 3b 3b 9c e3 c6  |........gy*;;...|
+00000040  d7 9d 15 32 14 9d 46 81  0a 73 86 44 c0 09 00 00  |...2..F..s.D....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  01 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,20 +48,20 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 01 00 d6 0c 00  00 d2 03 00 17 41 04 c3  |*............A..|
-00000280  9d 20 75 e6 2f 70 63 0c  3a f8 98 74 d4 df bb 9f  |. u./pc.:..t....|
-00000290  ff d2 95 fc 4f 3e 9b 0e  0e 49 b5 97 dc fe bc 7e  |....O>...I.....~|
-000002a0  62 2a 71 9f f5 72 4c 42  4f e5 14 d7 30 1a 06 fe  |b*q..rLBO...0...|
-000002b0  ca 12 89 e4 61 21 1e 2c  9f 2e 56 56 e9 54 a3 00  |....a!.,..VV.T..|
-000002c0  8b 30 81 88 02 42 01 29  8c cd 92 fe af fd 59 85  |.0...B.)......Y.|
-000002d0  ad 41 ba 23 f2 fc 38 c3  0e 34 73 9c 49 05 e1 7a  |.A.#..8..4s.I..z|
-000002e0  c6 8b cb 33 09 3c 48 66  8f 70 3c 9a 64 96 de fd  |...3.<Hf.p<.d...|
-000002f0  8a 17 e0 11 67 02 12 ef  bb c7 66 f3 d6 69 09 5c  |....g.....f..i.\|
-00000300  55 88 36 55 2e 5b dc 48  02 42 01 6f 80 dd 49 00  |U.6U.[.H.B.o..I.|
-00000310  21 f9 aa 1f 93 7e 6c 00  67 d8 ff 2a e4 9f 2d 1a  |!....~l.g..*..-.|
-00000320  9c 66 ee 5d 31 b6 0e 93  6a 7f 80 1f 72 cb 57 37  |.f.]1...j...r.W7|
-00000330  4d 37 af 9f 1b b7 ae 12  9f fa 2c 84 9b a8 0f 2a  |M7........,....*|
-00000340  d6 5e 27 00 ec 20 57 30  22 c4 ea 37 16 03 01 00  |.^'.. W0"..7....|
+00000270  2a 16 03 01 00 d6 0c 00  00 d2 03 00 17 41 04 52  |*............A.R|
+00000280  4c a0 cf a0 77 26 e4 f5  f5 15 04 8b d9 cc 11 dc  |L...w&..........|
+00000290  80 75 fb f3 bc 2b b4 8b  14 fc ca ea 54 88 ef 5b  |.u...+......T..[|
+000002a0  5c 33 9b 3c 20 41 ef c4  e0 34 4b 8b ab be d7 92  |\3.< A...4K.....|
+000002b0  fc 1b 86 fc e1 36 9a 6f  81 fc 1c b8 1f a7 99 00  |.....6.o........|
+000002c0  8b 30 81 88 02 42 00 b5  bf 87 11 17 2f bd 9a c0  |.0...B....../...|
+000002d0  16 67 27 8e e8 f4 c5 55  cf 37 c3 0f 91 3c c9 f5  |.g'....U.7...<..|
+000002e0  92 d0 89 e3 9c 05 cb 58  b2 a9 9b 7c cf 29 6e 68  |.......X...|.)nh|
+000002f0  38 70 f9 4b ba ac 96 0e  1e 41 f8 84 98 3e b8 df  |8p.K.....A...>..|
+00000300  f4 fe c7 15 cd 7d 96 2d  02 42 01 71 92 66 de 2a  |.....}.-.B.q.f.*|
+00000310  03 f7 a0 e5 d6 b8 3e a9  26 a0 77 7c ab 4c 9b 5d  |......>.&.w|.L.]|
+00000320  b1 88 0d c0 ce 33 02 95  9f 74 b9 a2 bb db 5e 59  |.....3...t....^Y|
+00000330  f4 61 f4 79 78 ef ca ba  08 68 6e 63 fc 06 0a 10  |.a.yx....hnc....|
+00000340  84 b3 a1 ea 98 86 c4 a5  d2 7d 9d b7 16 03 01 00  |.........}......|
 00000350  0e 0d 00 00 06 03 01 02  40 00 00 0e 00 00 00     |........@......|
 >>> Flow 3 (client to server)
 00000000  16 03 01 02 0a 0b 00 02  06 00 02 03 00 02 00 30  |...............0|
@@ -101,30 +101,30 @@
 00000220  51 88 35 75 71 b5 e5 54  5b 12 2e 8f 09 67 fd a7  |Q.5uq..T[....g..|
 00000230  24 20 3e b2 56 1c ce 97  28 5e f8 2b 2d 4f 9e f1  |$ >.V...(^.+-O..|
 00000240  07 9f 6c 4b 5b 83 56 e2  32 42 e9 58 b6 d7 49 a6  |..lK[.V.2B.X..I.|
-00000250  b5 68 1a 41 03 56 6b dc  5a 89 16 03 01 00 90 0f  |.h.A.Vk.Z.......|
-00000260  00 00 8c 00 8a 30 81 87  02 41 16 3b 14 a8 7e 9e  |.....0...A.;..~.|
-00000270  91 01 b5 56 4b 38 8a 74  46 ad c1 c3 d2 b3 2f ca  |...VK8.tF...../.|
-00000280  57 b8 de 43 4d bb c7 2f  62 3a 94 91 e3 72 60 7d  |W..CM../b:...r`}|
-00000290  cd 90 77 78 35 ef 21 9d  4e b5 79 98 18 e0 46 8b  |..wx5.!.N.y...F.|
-000002a0  e4 97 98 e2 d9 cf 6f c9  a2 ef 35 02 42 00 93 ec  |......o...5.B...|
-000002b0  45 d7 34 da 4f 86 81 67  bf 87 14 6b b8 69 ae 80  |E.4.O..g...k.i..|
-000002c0  2a b0 15 a8 cd 12 46 34  e7 30 d7 f2 84 9d 9e 81  |*.....F4.0......|
-000002d0  3d 3c 24 0e 18 58 0a 4e  66 62 5d ec ae 35 7c e4  |=<$..X.Nfb]..5|.|
-000002e0  66 d9 b3 0b 26 95 fb bc  af f3 02 67 fb da a3 14  |f...&......g....|
-000002f0  03 01 00 01 01 16 03 01  00 30 e0 9d a5 39 ec b2  |.........0...9..|
-00000300  29 40 32 b8 65 3c fb 59  f8 53 de 3c 36 41 2c 48  |)@2.e<.Y.S.<6A,H|
-00000310  08 cb 00 00 f1 64 aa 37  b1 ef 27 18 0d 6a f9 30  |.....d.7..'..j.0|
-00000320  13 6e 6e 9e ab 82 d8 ba  e2 51                    |.nn......Q|
+00000250  b5 68 1a 41 03 56 6b dc  5a 89 16 03 01 00 91 0f  |.h.A.Vk.Z.......|
+00000260  00 00 8d 00 8b 30 81 88  02 42 01 d7 78 09 ea ca  |.....0...B..x...|
+00000270  28 67 36 42 ba f4 eb c7  c7 b3 08 29 76 e4 b0 1a  |(g6B.......)v...|
+00000280  ad 25 12 8d 4a 8d 8f e5  ad b1 6b d3 7f 1a ff 48  |.%..J.....k....H|
+00000290  d3 1c 5e f4 ce ff 75 c2  46 df f0 30 b3 f8 b9 77  |..^...u.F..0...w|
+000002a0  6e eb f8 81 56 27 06 f3  30 15 c2 ca 02 42 00 8d  |n...V'..0....B..|
+000002b0  d3 0d a2 49 0b 47 6d 7a  64 8d 83 95 7b 60 23 d1  |...I.Gmzd...{`#.|
+000002c0  46 4d 23 6f a7 e0 35 2d  d4 95 49 7d e5 1e ed eb  |FM#o..5-..I}....|
+000002d0  b8 64 f4 9e 78 33 ae f5  e7 cb 72 88 7d e1 f3 47  |.d..x3....r.}..G|
+000002e0  5e f2 ed 33 23 5e b1 a2  c1 34 d2 59 c7 83 3e 20  |^..3#^...4.Y..> |
+000002f0  14 03 01 00 01 01 16 03  01 00 30 ae 61 41 6c b4  |..........0.aAl.|
+00000300  a6 b1 bb b8 d9 9c 3c 82  47 ab c4 bc 1a da 4f 0a  |......<.G.....O.|
+00000310  cc bd 7b 4d e1 16 0b 08  03 8c 54 d9 71 9d 58 cb  |..{M......T.q.X.|
+00000320  4d 90 74 e4 f3 6d 80 19  6b d6 a7                 |M.t..m..k..|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 ba 3e 11 94 20  |..........0.>.. |
-00000010  72 43 30 b3 5a eb db 4e  17 fa 83 aa 8f e4 17 92  |rC0.Z..N........|
-00000020  58 0c 56 ce b3 39 cc 40  34 91 55 96 4c 9e 02 5b  |X.V..9.@4.U.L..[|
-00000030  05 ec 4e 6b 95 52 17 ea  06 dc d7                 |..Nk.R.....|
+00000000  14 03 01 00 01 01 16 03  01 00 30 97 b9 5b fd 48  |..........0..[.H|
+00000010  b5 b8 12 a3 8b 6b 25 57  5b e4 03 6e c6 3e fd 32  |.....k%W[..n.>.2|
+00000020  18 50 a3 15 3f 56 f6 70  38 b6 4c 1f a5 d7 82 eb  |.P..?V.p8.L.....|
+00000030  b9 3e f6 44 66 12 5d 6a  38 1c f1                 |.>.Df.]j8..|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 30 65 6a  9b 39 98 ff ea 90 d9 a7  |.... 0ej.9......|
-00000010  52 88 ca 38 b2 71 b7 75  0f 9f 41 b0 bb 33 ff 83  |R..8.q.u..A..3..|
-00000020  6e 59 7e 81 a1 17 03 01  00 20 18 9a a6 df 69 9c  |nY~...... ....i.|
-00000030  56 f1 4e d4 9b 85 80 64  ee b8 d2 a7 ca 3a 54 5f  |V.N....d.....:T_|
-00000040  d4 e6 64 68 aa fd 28 22  06 3b 15 03 01 00 20 0f  |..dh..(".;.... .|
-00000050  4e 21 15 b2 b0 dd 7a 33  71 88 d9 45 25 05 92 ad  |N!....z3q..E%...|
-00000060  b1 35 dc fa 61 df 53 66  fc 80 89 49 bc 8f c4     |.5..a.Sf...I...|
+00000000  17 03 01 00 20 94 a2 0d  d2 54 24 8b 81 eb d3 e2  |.... ....T$.....|
+00000010  3c d5 a1 f6 97 c3 45 8e  6c 26 b8 e1 ae 22 e8 94  |<.....E.l&..."..|
+00000020  30 41 2c 1d 3f 17 03 01  00 20 95 76 96 d1 f2 6d  |0A,.?.... .v...m|
+00000030  64 39 c7 0e a6 7c 56 56  13 0d bb f9 24 ef 64 32  |d9...|VV....$.d2|
+00000040  1e 49 d7 97 c1 2e 23 5f  02 51 15 03 01 00 20 a0  |.I....#_.Q.... .|
+00000050  17 61 eb 8e e1 63 cf 80  4d a3 ee 6a 99 6c 3a 39  |.a...c..M..j.l:9|
+00000060  b0 a4 48 26 37 58 ab 3a  21 67 1a 48 2b 88 35     |..H&7X.:!g.H+.5|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA
index 901f8eac67..8c726e7eb9 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 36 00 05 00 05  01 00 00 00 00 00 0a 00  |...6............|
-00000060  08 00 06 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
-00000070  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
-00000080  03 ff 01 00 01 00 00 12  00 00                    |..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 51 02 00 00  4d 03 01 fc 37 e3 71 ee  |....Q...M...7.q.|
-00000010  db 12 3b 29 8e fa f5 54  fd ef 79 9e dd 36 17 0e  |..;)...T..y..6..|
-00000020  c2 f4 3a 0d 16 82 15 29  12 dd 5b 20 f1 47 9e d2  |..:....)..[ .G..|
-00000030  58 db 81 04 97 55 2e 4d  d1 e7 25 9f 2e 78 48 b7  |X....U.M..%..xH.|
-00000040  4e 29 ad 4a af a9 24 3e  34 0b 18 01 00 05 00 00  |N).J..$>4.......|
+00000000  16 03 01 00 51 02 00 00  4d 03 01 7b 56 22 f2 0d  |....Q...M..{V"..|
+00000010  53 16 b1 66 83 aa 0c 7c  4b ef 8f e3 58 82 4e ba  |S..f...|K...X.N.|
+00000020  5a 46 53 7f ca 1f 1d a8  b9 77 18 20 48 92 50 46  |ZFS......w. H.PF|
+00000030  51 e4 56 02 8c a4 92 c9  51 f2 85 75 91 99 86 fb  |Q.V.....Q..u....|
+00000040  c2 ab 5b 7c d0 bf 49 be  13 f3 91 3c 00 05 00 00  |..[|..I....<....|
 00000050  05 ff 01 00 01 00 16 03  01 02 59 0b 00 02 55 00  |..........Y...U.|
 00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -97,24 +97,24 @@
 00000270  70 0f 08 83 48 e9 48 ef  6e 50 8b 05 7e e5 84 25  |p...H.H.nP..~..%|
 00000280  fa 55 c7 ae 31 02 27 00  ef 3f 98 86 20 12 89 91  |.U..1.'..?.. ...|
 00000290  59 28 b4 f7 d7 af d2 69  61 35 16 03 01 00 91 0f  |Y(.....ia5......|
-000002a0  00 00 8d 00 8b 30 81 88  02 42 01 14 05 eb 50 03  |.....0...B....P.|
-000002b0  82 c9 05 9b e2 71 7e a0  e5 7b fe 81 90 8e e9 9a  |.....q~..{......|
-000002c0  34 56 f1 b2 77 6c 14 99  5f f4 26 a9 02 3a cc c1  |4V..wl.._.&..:..|
-000002d0  21 07 33 61 72 9a 6f 1f  d1 ec a2 55 a4 98 5c 4d  |!.3ar.o....U..\M|
-000002e0  4c 9e bd 44 2d be af a5  d3 85 cc 0f 02 42 00 b9  |L..D-........B..|
-000002f0  a5 93 92 ea 53 88 26 07  e9 26 d9 d9 25 ce e4 9f  |....S.&..&..%...|
-00000300  10 eb 20 a7 7b 2a 23 32  a9 ec 65 4b dc 6b 35 ff  |.. .{*#2..eK.k5.|
-00000310  23 c3 95 7a 67 79 6e 7d  80 39 b0 ad 2a 69 97 aa  |#..zgyn}.9..*i..|
-00000320  d7 27 ca c5 1d 5f 6f 3a  84 aa cd 2e 8b a3 af f5  |.'..._o:........|
-00000330  14 03 01 00 01 01 16 03  01 00 24 69 5a 4e 16 a0  |..........$iZN..|
-00000340  af 2d 94 58 0c bb c6 95  39 f7 0e 7e c5 01 9b b3  |.-.X....9..~....|
-00000350  d8 22 e6 82 a8 1d 05 89  97 fa 9e 97 21 3f d9     |."..........!?.|
+000002a0  00 00 8d 00 8b 30 81 88  02 42 00 97 2e 05 89 ff  |.....0...B......|
+000002b0  06 c2 8f d1 a9 e1 73 8e  b5 a7 81 58 b8 a1 b0 18  |......s....X....|
+000002c0  df 42 e2 2f 6a a1 d9 dc  b4 f4 63 d1 23 25 90 61  |.B./j.....c.#%.a|
+000002d0  98 58 3d 69 3c 06 ef f2  0c 13 b2 31 56 bd 0e 8f  |.X=i<......1V...|
+000002e0  d4 4b 64 ea 30 aa 19 c8  86 f3 fd 46 02 42 00 94  |.Kd.0......F.B..|
+000002f0  eb 60 57 6b 26 0d 53 18  c6 73 6e 60 73 98 ff 2f  |.`Wk&.S..sn`s../|
+00000300  f2 80 eb 73 02 26 e9 4f  a5 42 3a 60 70 3c 52 7e  |...s.&.O.B:`p<R~|
+00000310  3a 31 f1 a8 42 7b 44 36  31 94 1b bf 78 0f a8 6d  |:1..B{D61...x..m|
+00000320  a6 fb f0 49 13 c6 71 6d  8f 44 a2 e0 41 cb ab fb  |...I..qm.D..A...|
+00000330  14 03 01 00 01 01 16 03  01 00 24 09 60 3f a5 1d  |..........$.`?..|
+00000340  8e b7 56 86 9b 6f 35 40  e7 e8 d6 1a ab fc f5 0d  |..V..o5@........|
+00000350  c5 a6 d7 2c 44 4b 6b 6d  22 79 1e e8 a2 31 a3     |...,DKkm"y...1.|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 24 b1 bc 4d 8f 57  |..........$..M.W|
-00000010  7e 5b 37 91 e5 9e 31 35  de 1e ee 60 a5 b6 5b 91  |~[7...15...`..[.|
-00000020  bd 0f 65 ac e1 e5 4a 64  19 b4 f9 28 49 33 0f     |..e...Jd...(I3.|
+00000000  14 03 01 00 01 01 16 03  01 00 24 3c c9 8b e2 93  |..........$<....|
+00000010  84 9e 3c ad e3 b6 9b 5f  4a e6 15 2b af d4 6f fa  |..<...._J..+..o.|
+00000020  84 0d f6 77 25 03 62 08  60 f2 78 be 91 d3 d0     |...w%.b.`.x....|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 1a d5 db a0  bb d9 46 ac 46 76 91 a7  |..........F.Fv..|
-00000010  f6 d8 c9 6d 11 c8 3f 92  e1 a5 3d 19 9b 02 40 15  |...m..?...=...@.|
-00000020  03 01 00 16 65 ca 2b 25  c4 85 f8 82 a2 b3 3a 3a  |....e.+%......::|
-00000030  0c 2f 4a e7 3b d5 bf 9f  f9 61                    |./J.;....a|
+00000000  17 03 01 00 1a 18 d9 62  5f b8 cb 21 4b 75 d4 28  |.......b_..!Ku.(|
+00000010  48 37 46 98 aa ec 5f f3  6b 22 b3 92 1c 13 e3 15  |H7F..._.k"......|
+00000020  03 01 00 16 13 94 43 e8  cf f3 7c 4f 2a c3 ee a0  |......C...|O*...|
+00000030  80 fd 55 43 70 da 9d 88  21 f6                    |..UCp...!.|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA
index 077437b790..ea6de37c51 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 36 00 05 00 05  01 00 00 00 00 00 0a 00  |...6............|
-00000060  08 00 06 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
-00000070  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
-00000080  03 ff 01 00 01 00 00 12  00 00                    |..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 59 02 00 00  55 03 01 ea f6 24 aa 4e  |....Y...U....$.N|
-00000010  7f 41 27 a0 25 60 92 a3  2e d1 e7 70 22 98 69 ff  |.A'.%`.....p".i.|
-00000020  e6 69 1d 27 7e 77 57 0b  3c 2d d6 20 6d 48 7a 69  |.i.'~wW.<-. mHzi|
-00000030  e3 54 de d3 aa 99 c5 29  69 a0 aa 13 b9 e2 10 b8  |.T.....)i.......|
-00000040  ed ea 3b 67 1c 18 7f 79  4b 4c 4d 24 c0 09 00 00  |..;g...yKLM$....|
+00000000  16 03 01 00 59 02 00 00  55 03 01 96 29 16 36 60  |....Y...U...).6`|
+00000010  65 c0 59 5e 39 1b ad 11  d4 c2 d4 ee 60 ed 7c 0a  |e.Y^9.......`.|.|
+00000020  72 20 d8 ed da 53 e0 a3  64 43 5b 20 68 13 96 67  |r ...S..dC[ h..g|
+00000030  eb a5 c4 1f 31 48 d0 11  9d bc 63 64 1e b2 36 7c  |....1H....cd..6||
+00000040  48 f0 05 7e 81 2f 82 de  91 22 0d 74 c0 09 00 00  |H..~./...".t....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  01 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,21 +48,21 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 01 00 d5 0c 00  00 d1 03 00 17 41 04 47  |*............A.G|
-00000280  9d b1 4c 73 76 f6 36 6f  a7 4f 5b 22 2d 73 7b dc  |..Lsv.6o.O["-s{.|
-00000290  c7 7e 38 89 ec 37 ba a0  bc 63 86 c9 23 13 41 17  |.~8..7...c..#.A.|
-000002a0  a1 e3 ba 0b 01 73 fe 73  23 6d b2 ab fc 2f bc 1e  |.....s.s#m.../..|
-000002b0  69 88 53 32 66 93 fe 47  76 d2 d1 25 73 4c fb 00  |i.S2f..Gv..%sL..|
-000002c0  8a 30 81 87 02 42 01 54  88 ef 3c 8f ed 72 31 0d  |.0...B.T..<..r1.|
-000002d0  52 aa d7 2a be 26 d7 b9  35 57 e4 34 ae bb e9 87  |R..*.&..5W.4....|
-000002e0  83 b8 fb b4 e6 e8 6f 19  41 96 7a 3e 6d 20 f7 22  |......o.A.z>m ."|
-000002f0  ec 18 3b 27 82 07 8a d5  32 33 86 b7 a5 88 b8 e9  |..;'....23......|
-00000300  83 a2 0e 37 3d 00 ff dc  02 41 7a 1d cd 44 f3 84  |...7=....Az..D..|
-00000310  b9 53 f3 e2 18 0d ea c1  d9 07 87 e8 e3 94 90 1d  |.S..............|
-00000320  23 d7 b0 08 a9 e7 c1 0f  4c b9 41 4a 57 bb 23 51  |#.......L.AJW.#Q|
-00000330  09 a6 f5 59 20 59 74 80  20 3c 23 60 07 e8 be c2  |...Y Yt. <#`....|
-00000340  4c 4f fe dd 60 81 6e 4f  89 44 7f 16 03 01 00 0e  |LO..`.nO.D......|
-00000350  0d 00 00 06 03 01 02 40  00 00 0e 00 00 00        |.......@......|
+00000270  2a 16 03 01 00 d6 0c 00  00 d2 03 00 17 41 04 17  |*............A..|
+00000280  e7 29 66 88 e3 76 32 fb  5f 3d 44 5c 2e f3 9a f4  |.)f..v2._=D\....|
+00000290  8b 68 24 b7 5a fa e6 41  9d f9 57 32 72 89 94 e9  |.h$.Z..A..W2r...|
+000002a0  d4 0b ad ad c0 3c 08 ea  c0 61 8b bc fd f8 cd 36  |.....<...a.....6|
+000002b0  54 17 57 6f cb e7 8d 4c  35 49 35 27 3d b4 97 00  |T.Wo...L5I5'=...|
+000002c0  8b 30 81 88 02 42 00 9c  eb c1 18 55 df 1c ee e2  |.0...B.....U....|
+000002d0  13 00 cb aa 54 d2 bc ae  8a 1f 15 24 ca f2 99 e7  |....T......$....|
+000002e0  4d ec e0 74 a5 45 60 9f  ec af 4c a7 72 4a 14 0a  |M..t.E`...L.rJ..|
+000002f0  c2 33 5b b0 c7 82 6e 55  85 1d e2 57 ad 58 cc 06  |.3[...nU...W.X..|
+00000300  46 c5 5a f8 0a 6f ac bb  02 42 01 c6 5c 36 38 af  |F.Z..o...B..\68.|
+00000310  ed d2 2d c9 66 bf c3 ff  86 63 03 a4 57 d3 7b 91  |..-.f....c..W.{.|
+00000320  9b 02 3f 94 79 d9 38 5d  b5 46 80 ff 56 09 dc 91  |..?.y.8].F..V...|
+00000330  4a 72 4c 2a 8b 35 d8 a0  f1 82 bc 79 1f 4d 57 1d  |JrL*.5.....y.MW.|
+00000340  eb a0 a3 f8 5e dd 74 5d  c2 fc bc b4 16 03 01 00  |....^.t]........|
+00000350  0e 0d 00 00 06 03 01 02  40 00 00 0e 00 00 00     |........@......|
 >>> Flow 3 (client to server)
 00000000  16 03 01 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
 00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
@@ -101,29 +101,29 @@
 00000220  67 fd a7 24 20 3e b2 56  1c ce 97 28 5e f8 2b 2d  |g..$ >.V...(^.+-|
 00000230  4f 9e f1 07 9f 6c 4b 5b  83 56 e2 32 42 e9 58 b6  |O....lK[.V.2B.X.|
 00000240  d7 49 a6 b5 68 1a 41 03  56 6b dc 5a 89 16 03 01  |.I..h.A.Vk.Z....|
-00000250  00 86 0f 00 00 82 00 80  47 6e 9a a0 1e 03 07 8e  |........Gn......|
-00000260  50 cd ed f7 86 9d 52 43  1d d7 4b d8 9f d8 cc 04  |P.....RC..K.....|
-00000270  6d 88 32 9e 4a d7 d5 c9  d8 9b 81 4f 9a f9 8e 67  |m.2.J......O...g|
-00000280  9f 7a 47 ee 59 81 52 96  0b c2 bc a0 48 2a b8 a7  |.zG.Y.R.....H*..|
-00000290  5b ed cc d0 d1 16 53 d7  1b cb e3 62 46 64 92 55  |[.....S....bFd.U|
-000002a0  55 5a 40 88 f8 ed 2f 92  b6 db 2b e4 43 74 23 26  |UZ@.../...+.Ct#&|
-000002b0  58 4f 5c ca 2f 0a 2c f8  9b c5 c6 d1 7f 7b 47 ab  |XO\./.,......{G.|
-000002c0  2f f1 b0 19 1d 9a fb 47  3a 74 88 1a 03 03 41 74  |/......G:t....At|
-000002d0  ba 4b 53 64 d1 da a5 bf  14 03 01 00 01 01 16 03  |.KSd............|
-000002e0  01 00 30 52 27 a8 12 25  ed 15 3e 07 84 13 7c 04  |..0R'..%..>...|.|
-000002f0  4d 0d 33 17 2c c1 78 dc  1c e3 50 e5 95 be d0 c7  |M.3.,.x...P.....|
-00000300  ba 9a b8 bb ed 2a c9 69  d9 4d b2 e1 16 58 0f 92  |.....*.i.M...X..|
-00000310  ea dd b9                                          |...|
+00000250  00 86 0f 00 00 82 00 80  43 ee ac 48 f3 bb 26 40  |........C..H..&@|
+00000260  19 85 d5 05 63 44 5c 2c  c9 ab b1 6d ad c2 03 f5  |....cD\,...m....|
+00000270  f5 1d 16 08 fe 3a a9 90  97 8f d6 47 fa 20 80 bb  |.....:.....G. ..|
+00000280  07 6e 32 21 b5 95 de 89  43 ea a9 44 71 35 c7 84  |.n2!....C..Dq5..|
+00000290  d1 c7 d7 74 e0 29 bd 19  51 86 bc 77 24 27 fb a3  |...t.)..Q..w$'..|
+000002a0  f6 3f 85 dd ac d3 6d 84  3e bb 0c e2 8c 2e 1a db  |.?....m.>.......|
+000002b0  18 a2 4f c7 d2 5c 3a db  0c fa f3 3e 6e 1d 65 da  |..O..\:....>n.e.|
+000002c0  3b 1a df 35 00 d0 ee 1b  2e 59 fe 18 50 3d b1 56  |;..5.....Y..P=.V|
+000002d0  82 7c c9 5a 4b 8a e8 9a  14 03 01 00 01 01 16 03  |.|.ZK...........|
+000002e0  01 00 30 1b 1f 0e e0 90  f4 1f b1 cc 3e e5 cb 58  |..0.........>..X|
+000002f0  6a b2 f9 97 04 d2 17 33  2e b0 c9 34 4a 2e 27 0d  |j......3...4J.'.|
+00000300  e1 30 86 b4 bc e3 1f 35  2a 6f bc d7 72 5c b5 32  |.0.....5*o..r\.2|
+00000310  cf 19 19                                          |...|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 dc 0d a4 5d 9e  |..........0...].|
-00000010  ae 1d 16 97 1d d9 29 6a  3f 23 52 df 01 30 db 13  |......)j?#R..0..|
-00000020  aa 6e c9 90 1b 7a c6 97  b2 be a5 8e 37 2d a8 a9  |.n...z......7-..|
-00000030  a1 e4 29 4e 28 56 3d 91  b3 ca 0b                 |..)N(V=....|
+00000000  14 03 01 00 01 01 16 03  01 00 30 fb 0a 0c da b5  |..........0.....|
+00000010  4e fa e0 6b 34 d6 39 b6  33 17 c5 24 38 87 c9 2c  |N..k4.9.3..$8..,|
+00000020  59 b0 f6 46 92 41 7b 35  2f 51 b5 fc 0b ed c1 23  |Y..F.A{5/Q.....#|
+00000030  42 4d 0f 68 eb 7b ae 27  ee 70 4c                 |BM.h.{.'.pL|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 24 c7 5d  53 82 8c 21 50 6e 3f 77  |.... $.]S..!Pn?w|
-00000010  1e de 56 f8 a5 25 7b ae  98 34 c9 76 dc ba 1d 6a  |..V..%{..4.v...j|
-00000020  af 59 8b 4e 9c 17 03 01  00 20 9b f3 33 5e 9b f9  |.Y.N..... ..3^..|
-00000030  d2 05 df 72 64 bd e9 98  0d f9 03 c4 80 22 c5 41  |...rd........".A|
-00000040  46 1d 05 09 ef 99 32 80  ec 65 15 03 01 00 20 4c  |F.....2..e.... L|
-00000050  f0 81 72 b0 31 52 3c c1  3c b9 95 7d f0 ea e3 a2  |..r.1R<.<..}....|
-00000060  c1 a6 3a 8d 34 b4 cf 41  c8 2b f4 e7 c4 dc 47     |..:.4..A.+....G|
+00000000  17 03 01 00 20 f0 73 c9  22 ac 02 f3 d7 26 fe ba  |.... .s."....&..|
+00000010  fa de 6f a5 51 50 2f 4a  13 e8 36 c2 29 ff 68 4d  |..o.QP/J..6.).hM|
+00000020  6e 87 a0 e8 aa 17 03 01  00 20 60 bb 97 5f cb 4f  |n........ `.._.O|
+00000030  46 23 a9 03 49 8a 82 cb  22 b2 05 9d c4 4f 83 c1  |F#..I..."....O..|
+00000040  47 e3 b0 58 e2 cc 46 b7  49 18 15 03 01 00 20 54  |G..X..F.I..... T|
+00000050  ae d6 e1 bf 61 5c 9f b3  f8 dc dc e7 33 84 d3 aa  |....a\......3...|
+00000060  23 fa 02 ef dc d1 93 96  1d e3 a1 02 c5 30 9c     |#............0.|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA
index ec98b8bd37..c03c7ec084 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 36 00 05 00 05  01 00 00 00 00 00 0a 00  |...6............|
-00000060  08 00 06 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
-00000070  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
-00000080  03 ff 01 00 01 00 00 12  00 00                    |..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 51 02 00 00  4d 03 01 2f 4d 4a 9e cf  |....Q...M../MJ..|
-00000010  2d d2 c8 36 9d 72 aa 63  68 9d bf 56 41 bb a7 96  |-..6.r.ch..VA...|
-00000020  ad cd 57 dc 0d 7f f9 24  2f f8 b7 20 37 4e 42 0c  |..W....$/.. 7NB.|
-00000030  d8 11 19 c0 5d 13 37 b2  d0 b2 bf c2 54 9b 65 f6  |....].7.....T.e.|
-00000040  85 b1 db 48 70 a2 4b e1  f2 d7 78 f9 00 05 00 00  |...Hp.K...x.....|
+00000000  16 03 01 00 51 02 00 00  4d 03 01 aa fa 5b 3a 13  |....Q...M....[:.|
+00000010  a4 a6 b3 5a 2c 89 39 24  91 a6 a5 c2 e9 13 ff e3  |...Z,.9$........|
+00000020  fa 71 2d e4 f4 1f 22 e8  e8 27 f1 20 94 31 56 d6  |.q-..."..'. .1V.|
+00000030  c7 32 3e 78 a4 f7 16 ee  66 e6 6c 24 d0 80 d2 bb  |.2>x....f.l$....|
+00000040  3f 98 f7 2e d1 1a 12 5f  57 a6 76 f9 00 05 00 00  |?......_W.v.....|
 00000050  05 ff 01 00 01 00 16 03  01 02 59 0b 00 02 55 00  |..........Y...U.|
 00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -96,24 +96,24 @@
 00000260  f1 0f c5 70 0f 08 83 48  e9 48 ef 6e 50 8b 05 7e  |...p...H.H.nP..~|
 00000270  e5 84 25 fa 55 c7 ae 31  02 27 00 ef 3f 98 86 20  |..%.U..1.'..?.. |
 00000280  12 89 91 59 28 b4 f7 d7  af d2 69 61 35 16 03 01  |...Y(.....ia5...|
-00000290  00 86 0f 00 00 82 00 80  87 ad 0d 24 da de 91 6b  |...........$...k|
-000002a0  d2 fd a8 86 e4 c5 0c b9  c8 e1 96 17 ee e7 c9 82  |................|
-000002b0  5a 49 3b 1b 6a 38 6c db  a3 72 56 01 4b 6c 91 49  |ZI;.j8l..rV.Kl.I|
-000002c0  ab 35 f4 cf 13 29 4d 42  de f8 6f 7a e9 19 b1 14  |.5...)MB..oz....|
-000002d0  5e 22 99 a0 26 0c 25 21  e6 15 9e 60 ba a1 ef d8  |^"..&.%!...`....|
-000002e0  28 ab ec 66 65 09 d3 5b  62 44 f0 e6 95 09 6c 9b  |(..fe..[bD....l.|
-000002f0  bc 69 ce f2 1c 53 d6 b1  64 31 a8 db a9 3b 04 c4  |.i...S..d1...;..|
-00000300  0e e1 10 8c 8a 3a ea 6f  b4 91 28 a7 ea fa 57 ad  |.....:.o..(...W.|
-00000310  f3 5b d9 73 4d ce c2 c9  14 03 01 00 01 01 16 03  |.[.sM...........|
-00000320  01 00 24 fb e6 7a ed 2a  2d 84 81 37 5f 7d 30 52  |..$..z.*-..7_}0R|
-00000330  d9 08 31 e6 af d6 c7 56  32 84 52 65 a1 6d d8 d5  |..1....V2.Re.m..|
-00000340  35 1a 1d 4c 84 76 28                              |5..L.v(|
+00000290  00 86 0f 00 00 82 00 80  a0 09 75 c8 8c 15 61 df  |..........u...a.|
+000002a0  3e 23 b7 3e 1e 12 ec 2d  d9 9f f0 05 d1 f5 c1 ed  |>#.>...-........|
+000002b0  ac 05 a7 6a d4 67 b3 ed  6d ff 01 ab e2 5a 53 e6  |...j.g..m....ZS.|
+000002c0  e3 85 e6 c3 e2 2f 0b db  c6 fa 52 8b 2b 22 12 33  |...../....R.+".3|
+000002d0  b0 6d 51 05 02 59 3c 50  5e a8 17 fe 95 d3 12 17  |.mQ..Y<P^.......|
+000002e0  4e 27 5b b4 6f f5 10 e3  16 89 8c 54 73 2e cc 23  |N'[.o......Ts..#|
+000002f0  e0 3b 11 68 b4 a7 cf 64  b2 cf b8 62 b0 c0 ba 89  |.;.h...d...b....|
+00000300  88 b0 fe 13 f6 cb bc 09  a9 30 c4 bb b2 a7 7b d8  |.........0....{.|
+00000310  64 96 bc 9b a7 fb db 82  14 03 01 00 01 01 16 03  |d...............|
+00000320  01 00 24 c1 77 ee 22 d3  71 d7 9e dd 02 53 0c 4a  |..$.w.".q....S.J|
+00000330  38 eb 43 de da 99 e3 45  ff 06 a3 3e 00 0b 19 8c  |8.C....E...>....|
+00000340  13 ed a6 46 bb 01 d8                              |...F...|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 24 83 80 1a 2f ba  |..........$.../.|
-00000010  c0 f8 cc 1f ce d6 4a 67  0c 1b 16 50 f2 02 b3 ea  |......Jg...P....|
-00000020  5b f9 e6 da 4a d7 c0 6e  3a 87 cf 2a f2 44 08     |[...J..n:..*.D.|
+00000000  14 03 01 00 01 01 16 03  01 00 24 fb c0 07 ac 02  |..........$.....|
+00000010  29 d1 db f3 48 1a b7 41  0a db f2 14 04 a0 70 94  |)...H..A......p.|
+00000020  2a 25 2e 47 41 f5 e0 99  fa ad e5 85 4a 53 12     |*%.GA.......JS.|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 1a fc a2 b0  fe 84 86 75 b0 70 56 56  |...........u.pVV|
-00000010  8e 16 db 6d e6 46 23 df  50 08 94 5d ca 88 7c 15  |...m.F#.P..]..|.|
-00000020  03 01 00 16 94 6a 2c 2d  9d ad 13 fc 29 5f fa 71  |.....j,-....)_.q|
-00000030  af 3c ab e3 a0 43 bb e1  f0 55                    |.<...C...U|
+00000000  17 03 01 00 1a 93 7d e5  18 d9 43 8e b8 2f b0 d6  |......}...C../..|
+00000010  8b f8 d4 a5 c5 0d 71 41  da 91 a7 04 9c 6b 2f 15  |......qA.....k/.|
+00000020  03 01 00 16 58 c6 62 cd  1c 65 bc 0e c6 4d 29 ff  |....X.b..e...M).|
+00000030  d9 c5 dc 68 65 72 35 f9  de 02                    |...her5...|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES
index 0c7581cd1b..c549a1b96b 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 36 00 05 00 05  01 00 00 00 00 00 0a 00  |...6............|
-00000060  08 00 06 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
-00000070  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
-00000080  03 ff 01 00 01 00 00 12  00 00                    |..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 59 02 00 00  55 03 01 0d 2c a2 04 a6  |....Y...U...,...|
-00000010  3f 18 3f 0f 94 88 69 ac  e1 0b e0 45 22 3d 95 91  |?.?...i....E"=..|
-00000020  10 ac a7 9c 1f 48 d0 87  34 34 eb 20 dc ba 2e aa  |.....H..44. ....|
-00000030  65 d7 e5 c5 b8 91 49 e4  bd a0 5e d0 48 1f b8 0f  |e.....I...^.H...|
-00000040  88 d7 3f 7d c6 2d 0b 53  f1 72 96 aa c0 09 00 00  |..?}.-.S.r......|
+00000000  16 03 01 00 59 02 00 00  55 03 01 00 f4 3b 47 61  |....Y...U....;Ga|
+00000010  8b 4b 96 48 68 12 19 a6  00 d5 24 fa c3 26 24 27  |.K.Hh.....$..&$'|
+00000020  a8 13 09 81 d8 6b 80 92  f9 b6 b7 20 01 0a 26 a3  |.....k..... ..&.|
+00000030  d7 37 55 4a 96 23 90 9b  e1 23 95 d7 6e 01 cd 35  |.7UJ.#...#..n..5|
+00000040  41 d3 9f 0c ed 88 2c 6d  97 8f 35 0c c0 09 00 00  |A.....,m..5.....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  01 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,20 +48,20 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 01 00 d5 0c 00  00 d1 03 00 17 41 04 29  |*............A.)|
-00000280  63 6f da d7 00 92 13 1c  32 05 51 d9 26 de 0e 76  |co......2.Q.&..v|
-00000290  57 98 e6 73 3a 0b f3 d9  12 3c b6 6e 5f b6 fd 22  |W..s:....<.n_.."|
-000002a0  af 57 55 38 e4 3b 33 2f  2e b1 b8 d8 57 1d c8 d3  |.WU8.;3/....W...|
-000002b0  e0 cb d8 88 e0 7b 74 24  95 10 60 0b 37 de 4d 00  |.....{t$..`.7.M.|
-000002c0  8a 30 81 87 02 42 01 b2  ef 44 46 bb 9a e8 5a eb  |.0...B...DF...Z.|
-000002d0  10 1f 0d 18 28 ec 74 80  f5 f9 1f ef 0e 94 2b d0  |....(.t.......+.|
-000002e0  f0 69 2d ba 82 d6 bd a7  c5 8a 1e 79 9f 1d 06 cd  |.i-........y....|
-000002f0  48 ef 9a 8b 0a 97 e9 25  d5 8d f4 f2 6a a2 de 00  |H......%....j...|
-00000300  7e 8f c5 58 d7 54 4a b5  02 41 51 ee 8f f2 9e f3  |~..X.TJ..AQ.....|
-00000310  24 d9 b7 dd f1 d7 61 91  48 7f f3 bc e9 24 49 a3  |$.....a.H....$I.|
-00000320  bd 65 68 e8 06 ab e0 1b  93 43 db e6 e7 7b 04 2f  |.eh......C...{./|
-00000330  28 df a2 ab bf 77 26 c6  b8 20 1e 97 14 07 09 db  |(....w&.. ......|
-00000340  a1 9e 26 d2 b5 d9 de 29  4e 75 e3 16 03 01 00 04  |..&....)Nu......|
+00000270  2a 16 03 01 00 d5 0c 00  00 d1 03 00 17 41 04 47  |*............A.G|
+00000280  34 3e c3 7a 68 b2 bf 4c  11 e0 3a 28 c0 6f bb b8  |4>.zh..L..:(.o..|
+00000290  4d f1 27 6a 90 6a 81 22  93 26 8d 5c ec ad 7d e2  |M.'j.j.".&.\..}.|
+000002a0  71 41 c1 f8 48 5c c7 b0  95 80 b5 76 6d a8 4f 84  |qA..H\.....vm.O.|
+000002b0  29 94 0c c8 e2 d5 e4 c3  d3 a3 d7 fa 45 d4 8f 00  |)...........E...|
+000002c0  8a 30 81 87 02 41 2c 01  66 48 61 d8 8c e5 d9 74  |.0...A,.fHa....t|
+000002d0  5e 82 ad 79 67 af 19 aa  f4 a5 89 41 f8 78 a6 77  |^..yg......A.x.w|
+000002e0  9e 74 74 d3 eb b8 93 aa  6c 28 c9 44 58 2b c0 16  |.tt.....l(.DX+..|
+000002f0  9a b3 26 2d 13 5f 98 94  36 d5 ff 0e a9 2c d8 33  |..&-._..6....,.3|
+00000300  d6 0c dc 48 fe be de 02  42 00 97 e0 40 3d 53 6e  |...H....B...@=Sn|
+00000310  2b 96 f6 63 c7 a0 cb 28  64 45 c4 b7 85 34 8f a7  |+..c...(dE...4..|
+00000320  e4 fd 97 76 18 e2 88 4c  31 39 3f 31 6b 7f 69 1f  |...v...L19?1k.i.|
+00000330  7a 72 2f 8e 6c d2 1f fa  59 01 0c 41 ef 21 51 44  |zr/.l...Y..A.!QD|
+00000340  c3 e9 de d7 9c 2b 35 9c  34 52 c5 16 03 01 00 04  |.....+5.4R......|
 00000350  0e 00 00 00                                       |....|
 >>> Flow 3 (client to server)
 00000000  16 03 01 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
@@ -69,20 +69,20 @@
 00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 01 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 01 00 30 9d b9  d8 94 3f 7c 32 ba a9 cd  |.....0....?|2...|
-00000060  ef 98 3c 84 c9 8b ed fd  00 df fb 01 e1 f3 cb 4f  |..<............O|
-00000070  fd 97 65 75 42 14 44 7b  4b dc 05 d1 f5 77 ae 2e  |..euB.D{K....w..|
-00000080  b4 f7 28 79 4e ac                                 |..(yN.|
+00000050  01 16 03 01 00 30 43 0d  57 48 41 ac 59 86 b3 53  |.....0C.WHA.Y..S|
+00000060  58 d4 f7 b0 32 fa 0a 3f  5f 3e 22 ba 2f 04 86 06  |X...2..?_>"./...|
+00000070  ce 22 33 3f a2 89 ed 76  80 52 d1 6b fe bb 62 40  |."3?...v.R.k..b@|
+00000080  a9 68 d5 b3 ea fc                                 |.h....|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 35 97 99 3c c8  |..........05..<.|
-00000010  4e 25 dc 96 f6 1b ad b6  e8 69 78 bf 20 67 90 eb  |N%.......ix. g..|
-00000020  b3 af 9f 77 e6 33 eb f8  50 be ca 9b ef 69 0c 90  |...w.3..P....i..|
-00000030  43 36 39 07 39 65 72 4c  76 17 63                 |C69.9erLv.c|
+00000000  14 03 01 00 01 01 16 03  01 00 30 34 9b d5 0a 0d  |..........04....|
+00000010  1f 02 01 f7 92 e8 3e 83  03 23 28 b3 ab cc e9 f2  |......>..#(.....|
+00000020  98 08 1f 36 61 0f af 8d  d3 d3 fc 72 58 94 77 01  |...6a......rX.w.|
+00000030  82 d9 8c 70 b3 d3 d3 19  4d cf 08                 |...p....M..|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 31 e3 2f  a7 0c 76 46 7c 84 4a d3  |.... 1./..vF|.J.|
-00000010  d5 b7 01 49 6b 53 d6 61  09 26 4a b2 6f e7 00 08  |...IkS.a.&J.o...|
-00000020  25 84 69 cf d6 17 03 01  00 20 68 d7 d2 7b 6d 9a  |%.i...... h..{m.|
-00000030  8d 81 92 3b 32 62 73 b0  02 27 3e e0 5d 1f 08 4c  |...;2bs..'>.]..L|
-00000040  8d ae f7 b1 8e b9 5a c3  bb be 15 03 01 00 20 d0  |......Z....... .|
-00000050  23 1b ea d7 04 35 43 17  9c 94 85 b7 b8 3a 66 31  |#....5C......:f1|
-00000060  f0 7c 0f 09 02 8a 29 9e  98 3b df 9d 61 ac a1     |.|....)..;..a..|
+00000000  17 03 01 00 20 b8 a9 f8  57 92 06 f0 7d 03 e0 ba  |.... ...W...}...|
+00000010  c6 52 e0 9e 52 eb cf 7e  a2 98 5b 74 f2 ff dc 85  |.R..R..~..[t....|
+00000020  93 25 02 56 e1 17 03 01  00 20 a2 8c c8 c1 c5 eb  |.%.V..... ......|
+00000030  ce 3b d3 86 0d c0 bc bc  13 41 d5 5c d1 24 b9 be  |.;.......A.\.$..|
+00000040  f9 4c dd 03 25 88 30 64  01 1c 15 03 01 00 20 3e  |.L..%.0d...... >|
+00000050  45 2f 53 60 74 3f 48 66  0d 02 59 1c 1c fc f1 f7  |E/S`t?Hf..Y.....|
+00000060  34 dd 86 0a 33 be 42 e9  d0 bd f5 d9 84 bf 30     |4...3.B.......0|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES
index e6041c09c9..956d9ec84d 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 36 00 05 00 05  01 00 00 00 00 00 0a 00  |...6............|
-00000060  08 00 06 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
-00000070  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
-00000080  03 ff 01 00 01 00 00 12  00 00                    |..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 59 02 00 00  55 03 01 51 b8 cd 30 d0  |....Y...U..Q..0.|
-00000010  7b eb f1 0e 3e 17 0c 43  84 a0 3e 1d d8 b2 88 41  |{...>..C..>....A|
-00000020  6d 16 bf d7 de 8b 3d 51  4a 74 dd 20 6e 3a 62 a0  |m.....=QJt. n:b.|
-00000030  1e f2 11 c0 aa bd 9b 5f  0d 2a 73 1f 51 84 d0 00  |......._.*s.Q...|
-00000040  51 eb 3c 04 ae 05 cd 49  b6 41 92 37 c0 13 00 00  |Q.<....I.A.7....|
+00000000  16 03 01 00 59 02 00 00  55 03 01 72 0c 3b 9c 77  |....Y...U..r.;.w|
+00000010  8a 2b 1c 13 28 ad 08 30  aa ca 23 dc 54 7b 48 c7  |.+..(..0..#.T{H.|
+00000020  2e c2 81 23 6c 35 c9 a9  3f 42 ef 20 dd 0c 72 42  |...#l5..?B. ..rB|
+00000030  8f 8e d0 1a ed 47 ed 6f  94 68 a5 bc 47 42 2a ee  |.....G.o.h..GB*.|
+00000040  3b 3d 61 6a bd 88 3e 6e  e5 54 a3 cd c0 13 00 00  |;=aj..>n.T......|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  01 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,19 +53,19 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 01 00  |.=.`.\!.;.......|
-000002c0  cb 0c 00 00 c7 03 00 17  41 04 e6 ec 64 a9 ca 4a  |........A...d..J|
-000002d0  83 65 26 18 62 f2 54 a6  45 4b 9c 55 b4 3c 32 66  |.e&.b.T.EK.U.<2f|
-000002e0  43 da d8 2e 4e e5 8e 88  fc 30 1b 2f 26 23 96 d8  |C...N....0./&#..|
-000002f0  c5 3d 5f 79 dd 82 6e de  9e 9f 2c 1c 4a 91 bc 22  |.=_y..n...,.J.."|
-00000300  09 39 3b 6a 4a b9 53 d2  4d 21 00 80 9e 0e 8b 9d  |.9;jJ.S.M!......|
-00000310  2f 00 0c 4e 28 27 31 51  d6 8a 25 04 3d 5a e6 be  |/..N('1Q..%.=Z..|
-00000320  6f 45 6d f0 ec 5b 42 5d  f2 e1 22 38 d8 a6 b9 88  |oEm..[B].."8....|
-00000330  6f 09 5a 44 45 50 3c 88  83 0c ba 38 dd 0a e1 e7  |o.ZDEP<....8....|
-00000340  b7 ae 8c 75 6a b7 8d ee  04 a2 16 f9 52 50 a1 21  |...uj.......RP.!|
-00000350  c6 74 c2 79 1c b1 be 15  51 f0 0a 37 d7 5a c0 4f  |.t.y....Q..7.Z.O|
-00000360  16 dd 19 0b dd ee 18 f9  76 27 b2 00 f7 29 9d 23  |........v'...).#|
-00000370  7f 1a 25 4a 75 8d bb 11  1c c2 35 66 76 df b5 a0  |..%Ju.....5fv...|
-00000380  c0 4e 73 c9 fa b0 07 ee  2f 3f 3d d1 16 03 01 00  |.Ns...../?=.....|
+000002c0  cb 0c 00 00 c7 03 00 17  41 04 82 a5 dc 05 3f fb  |........A.....?.|
+000002d0  cb 6b d0 7f 6d 01 f9 be  df 3a a6 2e 52 fc 82 5d  |.k..m....:..R..]|
+000002e0  8a ab 45 bd 94 f8 04 da  2e 4b e1 33 06 11 8c c1  |..E......K.3....|
+000002f0  2f 35 94 7b ef 4e 05 cb  5f 7c 27 16 72 2c bb 96  |/5.{.N.._|'.r,..|
+00000300  3e 81 d3 01 f0 5e 8e 95  4a db 00 80 41 13 7a 1b  |>....^..J...A.z.|
+00000310  4d 4c ed ff ea 59 80 39  6f f9 72 33 23 32 17 42  |ML...Y.9o.r3#2.B|
+00000320  3d 78 80 c2 f6 02 f6 71  0c dc 1b 86 c7 11 9f 4e  |=x.....q.......N|
+00000330  f3 f9 e3 ab fa 6f a9 78  35 79 25 41 9f e3 57 42  |.....o.x5y%A..WB|
+00000340  83 c0 60 f8 d0 83 05 8d  b2 34 33 d5 7d 3a e3 a4  |..`......43.}:..|
+00000350  09 8b 49 dc 17 74 dd 5e  67 c9 10 ee c0 ba 89 b2  |..I..t.^g.......|
+00000360  91 2f a2 de 1b 39 9c 2c  c9 10 13 43 f1 e8 69 98  |./...9.,...C..i.|
+00000370  19 75 02 ee dc fb 85 28  cb bf 00 1e 50 bb 42 f9  |.u.....(....P.B.|
+00000380  f0 81 28 4a 9e c8 a1 aa  29 55 d8 34 16 03 01 00  |..(J....)U.4....|
 00000390  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
 00000000  16 03 01 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
@@ -73,20 +73,20 @@
 00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 01 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 01 00 30 37 ae  52 9b 23 a0 11 58 75 a2  |.....07.R.#..Xu.|
-00000060  49 5d bb 00 0d ea 1f ec  1b 56 77 b5 5a ab 01 34  |I].......Vw.Z..4|
-00000070  d5 f6 0c 77 69 90 dc f5  fc 90 d9 80 1b 7c 8c d4  |...wi........|..|
-00000080  22 bb 26 a6 22 f2                                 |".&.".|
+00000050  01 16 03 01 00 30 05 a0  da 78 00 e3 2f f7 76 45  |.....0...x../.vE|
+00000060  7d 37 48 65 01 63 27 76  4a 7f fe cd 2b 4b d6 49  |}7He.c'vJ...+K.I|
+00000070  93 79 e6 b1 23 a5 c6 ea  db 1f af be 6a 16 55 9f  |.y..#.......j.U.|
+00000080  3d 06 1f 4d 88 7a                                 |=..M.z|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 6a 8b c9 64 6f  |..........0j..do|
-00000010  41 bf 2d 65 b4 a5 7e 44  d2 39 38 e8 23 8f 39 e1  |A.-e..~D.98.#.9.|
-00000020  11 67 e8 93 e6 30 0f 49  d2 8d 40 c5 7a 7c 6c 0e  |.g...0.I..@.z|l.|
-00000030  d1 b8 eb 51 1d 56 a5 81  ad 59 d7                 |...Q.V...Y.|
+00000000  14 03 01 00 01 01 16 03  01 00 30 90 65 20 ff da  |..........0.e ..|
+00000010  ee fa 89 8b 75 09 e7 d8  90 a5 0f 12 16 0f 12 40  |....u..........@|
+00000020  34 78 ee 50 c4 f8 31 c6  55 5e ac 21 42 b8 aa a8  |4x.P..1.U^.!B...|
+00000030  d8 36 a9 f0 ab 7d e8 22  99 e1 3c                 |.6...}."..<|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 f0 8a 52  33 bc 36 2d c8 51 9f a3  |.... ..R3.6-.Q..|
-00000010  55 0a 83 c2 d3 53 28 8f  77 60 4d 84 b7 cb e2 e2  |U....S(.w`M.....|
-00000020  93 27 88 0a f3 17 03 01  00 20 8f 20 61 89 96 cb  |.'....... . a...|
-00000030  13 4e d8 84 dc 2e b4 75  23 a6 25 e2 98 ef aa c5  |.N.....u#.%.....|
-00000040  cc 3f 45 e9 3c 2d 37 44  c6 ad 15 03 01 00 20 1f  |.?E.<-7D...... .|
-00000050  70 88 da 4d a2 52 2b 02  8e a4 8a 4d f8 51 59 d4  |p..M.R+....M.QY.|
-00000060  5f a6 a6 83 e8 77 1c 82  4d 95 9c 40 87 e3 d3     |_....w..M..@...|
+00000000  17 03 01 00 20 67 4c 09  40 a9 00 c3 b0 2c dd e6  |.... gL.@....,..|
+00000010  7e 95 5d dc 22 ac 53 79  81 51 07 e4 20 41 79 16  |~.].".Sy.Q.. Ay.|
+00000020  e0 98 94 70 2b 17 03 01  00 20 68 7a 08 85 27 fa  |...p+.... hz..'.|
+00000030  7e ad 02 c3 83 26 42 52  36 59 1d f9 af 79 7f 24  |~....&BR6Y...y.$|
+00000040  c8 72 af dd f2 ec f6 16  0d 79 15 03 01 00 20 c6  |.r.......y.... .|
+00000050  ea 99 71 91 df 33 2f dc  17 1e 33 af 76 a5 c5 95  |..q..3/...3.v...|
+00000060  20 55 64 c4 13 71 ab 35  84 f9 44 9b f2 a5 d4     | Ud..q.5..D....|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4 b/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4
index 1aaeac6124..43f1de13d5 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4
+++ b/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 36 00 05 00 05  01 00 00 00 00 00 0a 00  |...6............|
-00000060  08 00 06 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
-00000070  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
-00000080  03 ff 01 00 01 00 00 12  00 00                    |..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 51 02 00 00  4d 03 01 30 89 39 31 3b  |....Q...M..0.91;|
-00000010  85 7c e2 2f 14 01 2c de  fa 87 be 7c 37 02 37 0b  |.|./..,....|7.7.|
-00000020  ae 5a 99 9c c7 31 71 70  0f 7f ea 20 3e 7c d5 54  |.Z...1qp... >|.T|
-00000030  87 73 17 13 83 c4 7d d4  2f e4 fc fd e7 27 1c c0  |.s....}./....'..|
-00000040  08 cd e5 22 33 1a 35 92  82 c6 dd 0e 00 05 00 00  |..."3.5.........|
+00000000  16 03 01 00 51 02 00 00  4d 03 01 7b ef ef 75 33  |....Q...M..{..u3|
+00000010  8e 02 f9 39 e6 74 76 60  f9 ac 45 c0 c0 73 56 7a  |...9.tv`..E..sVz|
+00000020  8d ce f2 4d 51 f4 d3 e2  cf 1b bc 20 40 8d 00 76  |...MQ...... @..v|
+00000030  f8 1e 78 78 05 d0 4b 99  6e 14 09 84 da 7e b6 75  |..xx..K.n....~.u|
+00000040  e5 08 29 78 84 08 09 d4  4a 85 bf ca 00 05 00 00  |..)x....J.......|
 00000050  05 ff 01 00 01 00 16 03  01 02 59 0b 00 02 55 00  |..........Y...U.|
 00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -63,15 +63,15 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 01 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 01 00 24 2e 0a  0a f2 8d 8c 6f 51 52 97  |.....$......oQR.|
-000000a0  e0 4f 8b 62 c2 33 5c 7e  e9 05 59 e0 42 94 3d 9a  |.O.b.3\~..Y.B.=.|
-000000b0  a8 ce d6 bb a6 2c 48 00  1e 57                    |.....,H..W|
+00000090  01 16 03 01 00 24 df ee  0a de 85 59 55 17 04 de  |.....$.....YU...|
+000000a0  8f 04 37 b0 67 b9 a6 d0  fc 34 50 47 5b f5 ab 46  |..7.g....4PG[..F|
+000000b0  6b 36 f1 76 b5 ca b2 59  58 c3                    |k6.v...YX.|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 24 dd 3c 8a 60 8d  |..........$.<.`.|
-00000010  49 1e 34 7e 88 34 0b e7  d1 e1 50 58 19 5f 97 77  |I.4~.4....PX._.w|
-00000020  bb 2f 23 7c f4 68 2d 70  ae 70 00 de 39 38 e1     |./#|.h-p.p..98.|
+00000000  14 03 01 00 01 01 16 03  01 00 24 2f ff ff fa b9  |..........$/....|
+00000010  67 45 3c 83 b2 52 02 35  2f 4f 08 14 56 22 d6 a0  |gE<..R.5/O..V"..|
+00000020  d0 6d f7 e5 f1 1a e7 f6  77 d0 e4 cc f4 b4 15     |.m......w......|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 1a 31 e0 71  f0 b6 0e 2d 0c b8 cf 29  |.....1.q...-...)|
-00000010  a2 72 fb 3b f4 37 cf a2  1a f3 0f 2d 9e 7b 41 15  |.r.;.7.....-.{A.|
-00000020  03 01 00 16 04 86 ae a9  fa e7 06 d9 81 38 80 7e  |.............8.~|
-00000030  6a 51 b0 47 77 27 8b 76  c9 3c                    |jQ.Gw'.v.<|
+00000000  17 03 01 00 1a 4b 71 a8  39 42 3c 45 84 29 b7 76  |.....Kq.9B<E.).v|
+00000010  fb c6 c9 54 46 b1 db 4c  17 c2 b9 e5 4e c0 41 15  |...TF..L....N.A.|
+00000020  03 01 00 16 9f 17 19 d4  e3 7c 1d 1b 72 a2 b7 9c  |.........|..r...|
+00000030  21 29 4e 89 da fe 07 a6  1a 81                    |!)N.......|
diff --git a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES
index 3e7a822cea..e660bc3ca4 100644
--- a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 36 00 05 00 05  01 00 00 00 00 00 0a 00  |...6............|
-00000060  08 00 06 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
-00000070  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
-00000080  03 ff 01 00 01 00 00 12  00 00                    |..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 02 00 59 02 00 00  55 03 02 5b 51 a3 17 6d  |....Y...U..[Q..m|
-00000010  99 5a 6c 35 69 44 17 80  89 12 f4 59 fe 19 cd cf  |.Zl5iD.....Y....|
-00000020  5b b4 ff ab d9 c3 d4 f2  62 e2 fe 20 bd 79 bb 35  |[.......b.. .y.5|
-00000030  69 5e 44 5a c4 fd 65 58  f9 80 bd cb e5 47 51 f1  |i^DZ..eX.....GQ.|
-00000040  cf ea e3 83 c4 11 b6 1a  9c c9 13 98 c0 09 00 00  |................|
+00000000  16 03 02 00 59 02 00 00  55 03 02 83 27 b2 f5 ac  |....Y...U...'...|
+00000010  67 fa 7c e5 80 6c 05 04  3c 26 e6 9d 17 48 ae 48  |g.|..l..<&...H.H|
+00000020  e7 b0 fc 80 0f 11 c8 63  91 48 72 20 c2 e3 dd 5e  |.......c.Hr ...^|
+00000030  da b7 8b 08 5f 9b a1 b6  dc 60 92 5e a8 fe 61 44  |...._....`.^..aD|
+00000040  0e 9b f1 cb 74 5f 08 a8  dd f9 2e 66 c0 09 00 00  |....t_.....f....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  02 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,20 +48,20 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 02 00 d6 0c 00  00 d2 03 00 17 41 04 5c  |*............A.\|
-00000280  fe c6 a2 92 d2 df 79 56  99 a1 bb 0e c5 3e 08 fa  |......yV.....>..|
-00000290  a5 65 46 6a bc 8d c9 64  3e 1f d5 ba ea 3b 47 71  |.eFj...d>....;Gq|
-000002a0  fb 58 8a ab c0 9d 6e 7c  cc c2 6e f6 ca 5b aa 27  |.X....n|..n..[.'|
-000002b0  97 44 67 ef 49 d5 63 fe  cf 1c 69 98 bf 9e 8a 00  |.Dg.I.c...i.....|
-000002c0  8b 30 81 88 02 42 01 7c  1e c7 f6 9a a4 48 f4 47  |.0...B.|.....H.G|
-000002d0  25 a9 9e f0 a7 39 e2 d1  95 09 c2 33 9e 2d cc a0  |%....9.....3.-..|
-000002e0  28 e4 6a ea da f4 fe 04  49 a8 92 ea 6d 00 c4 07  |(.j.....I...m...|
-000002f0  61 45 5d 1e 86 d2 d4 f7  fc bb fe 6e 54 c3 01 14  |aE]........nT...|
-00000300  86 87 40 ce 07 1e 39 17  02 42 01 40 a6 9e 2c 38  |..@...9..B.@..,8|
-00000310  4e c1 40 65 e8 bb 7d 90  1e a7 69 09 7d f1 5c b8  |N.@e..}...i.}.\.|
-00000320  67 33 a0 bf 03 32 7e 63  c2 d2 78 4e 8b 55 cd 46  |g3...2~c..xN.U.F|
-00000330  a9 5e 90 96 5c 33 ac 2d  22 ec 03 27 9d ca 02 ae  |.^..\3.-"..'....|
-00000340  0a 45 8c 98 22 87 2d de  41 3c 55 e3 16 03 02 00  |.E..".-.A<U.....|
+00000270  2a 16 03 02 00 d6 0c 00  00 d2 03 00 17 41 04 c4  |*............A..|
+00000280  2c 25 ee fd 2d 23 c8 4a  3b c5 06 e1 17 ea ab f2  |,%..-#.J;.......|
+00000290  fd fe 2a ca 99 c8 7f b3  f5 c2 f6 3a 2f de 15 46  |..*........:/..F|
+000002a0  c6 b4 fc d7 70 62 b7 2b  21 b5 1b 94 d1 89 42 93  |....pb.+!.....B.|
+000002b0  6a fa fc 58 bc 46 f8 29  2e 51 aa 12 d6 24 e6 00  |j..X.F.).Q...$..|
+000002c0  8b 30 81 88 02 42 01 7d  dc 16 b1 9c 9f 97 93 c5  |.0...B.}........|
+000002d0  a4 d6 c8 ba c6 a8 6c 05  f8 00 3b f0 4d 75 14 8b  |......l...;.Mu..|
+000002e0  f6 7e b0 a0 85 ef a6 f1  4f ba c4 9a eb 3f e1 0b  |.~......O....?..|
+000002f0  05 43 6f 63 5c 46 05 84  48 e5 62 4d b4 32 50 ec  |.Coc\F..H.bM.2P.|
+00000300  e1 15 bd 71 1a 64 b5 ad  02 42 01 dc 7d 9a 2d 98  |...q.d...B..}.-.|
+00000310  dc 9b 02 35 cf 49 69 79  e8 1d ea 87 59 28 0e 3d  |...5.Iiy....Y(.=|
+00000320  cf 1a e3 db e7 70 41 f8  24 6b c6 52 13 54 16 0d  |.....pA.$k.R.T..|
+00000330  85 88 6f 50 d5 4b 6f db  c8 5b 64 40 8b 68 0f 9e  |..oP.Ko..[d@.h..|
+00000340  3e df 9f cb 46 e4 26 7e  5c df 35 38 16 03 02 00  |>...F.&~\.58....|
 00000350  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
 00000000  16 03 02 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
@@ -70,21 +70,21 @@
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 02 00 01  |..h.A.Vk.Z......|
 00000050  01 16 03 02 00 40 00 00  00 00 00 00 00 00 00 00  |.....@..........|
-00000060  00 00 00 00 00 00 c6 ba  bf 63 87 97 ee 47 b3 2b  |.........c...G.+|
-00000070  4d 9c 53 01 4a 84 c3 8a  a7 0f 48 7d 31 55 28 1e  |M.S.J.....H}1U(.|
-00000080  91 65 b0 ce 15 86 5d f1  4b e6 5e 55 2c 5b 2d d1  |.e....].K.^U,[-.|
-00000090  e9 41 02 cc 34 d3                                 |.A..4.|
+00000060  00 00 00 00 00 00 19 3d  59 72 cf 1a 01 ee 28 a9  |.......=Yr....(.|
+00000070  67 a1 10 33 bb f6 3e 7e  28 f1 d0 2f 9e c4 b2 65  |g..3..>~(../...e|
+00000080  2b ee 70 e8 91 57 8f 10  7b 92 6f 29 b4 ab 62 14  |+.p..W..{.o)..b.|
+00000090  1e 16 05 ad 31 95                                 |....1.|
 >>> Flow 4 (server to client)
-00000000  14 03 02 00 01 01 16 03  02 00 40 93 fc b4 e7 cc  |..........@.....|
-00000010  32 cc 3a 3e 55 8f ca ef  ba 3a 1a 48 38 49 c0 d4  |2.:>U....:.H8I..|
-00000020  70 7e 22 81 cb 7b 9b b8  fc 72 c8 82 03 26 39 2f  |p~"..{...r...&9/|
-00000030  59 a1 2d b3 e5 eb 5e fc  d4 24 7e c2 72 1c f2 a5  |Y.-...^..$~.r...|
-00000040  eb 87 9e a1 48 c9 58 b0  c8 79 62                 |....H.X..yb|
+00000000  14 03 02 00 01 01 16 03  02 00 40 80 87 d5 a2 72  |..........@....r|
+00000010  bb 1a 80 24 4f 0f d2 d5  9c 3a 19 3f 1b 1f 82 93  |...$O....:.?....|
+00000020  18 f2 ab eb a0 12 bd 67  4b 28 5c cc 7f a2 72 00  |.......gK(\...r.|
+00000030  b3 89 6d 01 ae 36 74 f0  87 b0 1e ee e1 4e 08 10  |..m..6t......N..|
+00000040  67 81 17 37 02 35 e6 a0  44 1b f6                 |g..7.5..D..|
 >>> Flow 5 (client to server)
 00000000  17 03 02 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 2e bb 57  aa dd 16 83 1a f7 91 b8  |.......W........|
-00000020  48 0a 10 53 79 41 6e 4f  a8 4f f3 87 2b 9d 2f a2  |H..SyAnO.O..+./.|
-00000030  2d f7 a0 d4 0d 15 03 02  00 30 00 00 00 00 00 00  |-........0......|
-00000040  00 00 00 00 00 00 00 00  00 00 36 d7 41 d4 f0 53  |..........6.A..S|
-00000050  9d 4f 47 5c e9 41 b5 07  8e 0d 07 3c 84 c1 3a 3e  |.OG\.A.....<..:>|
-00000060  f0 ad 3a bd 0a 7a 1c 41  3f 3a                    |..:..z.A?:|
+00000010  00 00 00 00 00 51 69 5a  42 68 e5 b0 b2 49 b1 77  |.....QiZBh...I.w|
+00000020  07 77 2f 9b 99 6e e8 42  55 e5 00 2b 8d 09 aa 00  |.w/..n.BU..+....|
+00000030  63 ab aa e1 4b 15 03 02  00 30 00 00 00 00 00 00  |c...K....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 e1 1c 0e 27 7b 96  |.............'{.|
+00000050  79 a4 c6 8b 3c f8 92 b0  45 bb 5d 7f 86 10 a7 05  |y...<...E.].....|
+00000060  f7 99 7d 53 82 00 2c 04  ae ed                    |..}S..,...|
diff --git a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES
index a3fae9ce4c..b3af7fbb9d 100644
--- a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 36 00 05 00 05  01 00 00 00 00 00 0a 00  |...6............|
-00000060  08 00 06 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
-00000070  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
-00000080  03 ff 01 00 01 00 00 12  00 00                    |..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 02 00 59 02 00 00  55 03 02 7c 22 d2 e1 30  |....Y...U..|"..0|
-00000010  d9 60 6f 90 c1 dc a9 88  c4 7c 5d e2 71 17 47 72  |.`o......|].q.Gr|
-00000020  77 5a e0 2e 2b a7 44 69  94 ca f4 20 02 4c 9d 07  |wZ..+.Di... .L..|
-00000030  7c e7 79 b3 a7 21 1e 05  3b 9c e5 51 a7 0d 25 1a  ||.y..!..;..Q..%.|
-00000040  0c 60 e0 af 63 fa 83 e9  f5 cc a2 60 c0 13 00 00  |.`..c......`....|
+00000000  16 03 02 00 59 02 00 00  55 03 02 ce 3f 49 9b 78  |....Y...U...?I.x|
+00000010  4e dc fa 9e 4b 97 41 7d  19 0e 1b 4a 70 17 b9 17  |N...K.A}...Jp...|
+00000020  5f f2 52 bb 77 80 2d 15  d6 3c 58 20 b0 41 3d 79  |_.R.w.-..<X .A=y|
+00000030  8b 39 41 d5 e8 85 9a 9d  66 b8 8f 1c 04 3c 3b f1  |.9A.....f....<;.|
+00000040  68 41 b1 3c 3f 26 79 b8  e0 3d b8 ef c0 13 00 00  |hA.<?&y..=......|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  02 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,19 +53,19 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 02 00  |.=.`.\!.;.......|
-000002c0  cb 0c 00 00 c7 03 00 17  41 04 e3 23 66 31 62 77  |........A..#f1bw|
-000002d0  23 3f 0c 5e ad bc d7 88  d0 27 90 ee 20 aa 47 31  |#?.^.....'.. .G1|
-000002e0  4e 10 b0 69 d4 cb c9 64  18 84 bc 9b 6c 42 c8 e6  |N..i...d....lB..|
-000002f0  e4 62 bd 2a fd f8 93 f5  e4 82 95 d2 bc 82 c2 8a  |.b.*............|
-00000300  cd b4 fb 56 83 bd bb 5d  98 08 00 80 2f 17 ee 88  |...V...]..../...|
-00000310  78 db 31 25 76 98 e9 f9  8c 94 9c 89 1c 93 05 f5  |x.1%v...........|
-00000320  b3 d9 86 c7 c7 5c 31 02  67 87 f5 f1 ee 85 cc 35  |.....\1.g......5|
-00000330  21 c1 2e 19 c4 f4 28 15  9c 80 bb 8a f3 17 52 07  |!.....(.......R.|
-00000340  cb bd 5e de e6 3e 17 fe  5d 85 03 9c 08 41 53 42  |..^..>..]....ASB|
-00000350  9d c1 06 64 c6 9b 44 b3  47 39 00 eb 51 18 7b 9b  |...d..D.G9..Q.{.|
-00000360  2d 88 88 87 7f 27 24 37  ed 40 43 30 18 84 a7 e8  |-....'$7.@C0....|
-00000370  28 77 0a 2b 6d d8 c6 c2  da 02 da 9b fb df 05 47  |(w.+m..........G|
-00000380  3a 7f d9 9a d1 80 7c bc  89 fd 23 35 16 03 02 00  |:.....|...#5....|
+000002c0  cb 0c 00 00 c7 03 00 17  41 04 d4 a5 b1 4a 40 06  |........A....J@.|
+000002d0  d3 db cd c0 fc 51 64 61  83 49 79 ea ac 5f 9f 54  |.....Qda.Iy.._.T|
+000002e0  ac 09 89 03 b2 04 f3 5c  9d de 63 fa 0b a8 b2 0f  |.......\..c.....|
+000002f0  06 20 86 65 53 02 4b a5  72 79 8b 26 29 c8 57 78  |. .eS.K.ry.&).Wx|
+00000300  4e 4a 97 20 3b d2 ea e9  c5 55 00 80 56 68 33 90  |NJ. ;....U..Vh3.|
+00000310  88 f4 d3 ca e5 c0 69 62  ed 16 56 bf fa 13 12 ad  |......ib..V.....|
+00000320  ed 9e 34 88 02 6d 1b af  4b 0e 51 2f 80 42 01 c6  |..4..m..K.Q/.B..|
+00000330  9d 23 07 2a 0d 32 37 c0  60 83 10 d1 48 b9 bc 32  |.#.*.27.`...H..2|
+00000340  5a 6f f4 7b 96 db dc 16  47 3e f0 bd 9f 5d d3 6d  |Zo.{....G>...].m|
+00000350  a8 38 9b 46 e9 40 60 38  cd cc b6 ba 9b 1b a3 84  |.8.F.@`8........|
+00000360  c1 a4 51 7e 58 35 e6 6d  35 61 cc c7 65 23 cd fa  |..Q~X5.m5a..e#..|
+00000370  cc 3e 78 aa 7e a9 40 55  01 94 b5 69 6e ef ec bf  |.>x.~.@U...in...|
+00000380  3f f8 f8 78 81 20 c9 40  0d 4e 90 ef 16 03 02 00  |?..x. .@.N......|
 00000390  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
 00000000  16 03 02 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
@@ -74,21 +74,21 @@
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 02 00 01  |..h.A.Vk.Z......|
 00000050  01 16 03 02 00 40 00 00  00 00 00 00 00 00 00 00  |.....@..........|
-00000060  00 00 00 00 00 00 53 31  6f bc 77 77 bb 81 3a 23  |......S1o.ww..:#|
-00000070  d8 93 9c 40 d5 74 3f 20  a4 fb e7 85 96 29 10 0a  |...@.t? .....)..|
-00000080  14 9c 0b e9 00 58 2b 46  db 8d ed 56 7d 32 36 c6  |.....X+F...V}26.|
-00000090  7e c5 0f 88 10 a9                                 |~.....|
+00000060  00 00 00 00 00 00 e0 5c  f2 89 75 19 aa 82 30 03  |.......\..u...0.|
+00000070  ef f3 4b 52 d8 a7 43 19  0d 8b 44 c4 32 e1 c1 4e  |..KR..C...D.2..N|
+00000080  39 1c c4 03 3d b6 37 96  8d 91 6d 36 23 7c 07 13  |9...=.7...m6#|..|
+00000090  f5 00 68 69 6f e5                                 |..hio.|
 >>> Flow 4 (server to client)
-00000000  14 03 02 00 01 01 16 03  02 00 40 0f a3 18 fb 2d  |..........@....-|
-00000010  dd 04 92 51 df 85 d0 ca  b8 da 66 07 df dc 42 0a  |...Q......f...B.|
-00000020  b9 18 a4 4d b6 e9 4e 6b  da 52 61 ed a2 fe a1 47  |...M..Nk.Ra....G|
-00000030  30 9c d9 ab 29 39 68 e3  91 50 37 74 e0 6f b9 29  |0...)9h..P7t.o.)|
-00000040  c1 a0 8d f2 2b 42 85 d7  5d b1 24                 |....+B..].$|
+00000000  14 03 02 00 01 01 16 03  02 00 40 8e b6 a7 b6 3a  |..........@....:|
+00000010  d2 49 ac fe e7 70 3e 95  94 8d 03 f6 be a8 9d fe  |.I...p>.........|
+00000020  1b a9 0c 2a 79 ed dd 8d  6b f0 79 8c 2a 78 f3 14  |...*y...k.y.*x..|
+00000030  4b 1a 86 ec 64 e5 6d 33  93 fb 9d 6a 3b 99 95 28  |K...d.m3...j;..(|
+00000040  7d 39 cc cb ce 21 fc 55  c0 65 05                 |}9...!.U.e.|
 >>> Flow 5 (client to server)
 00000000  17 03 02 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 ee 1b 89  12 89 71 cc 35 0c 77 0e  |..........q.5.w.|
-00000020  81 bf 23 7e 70 91 7b f0  3c 60 ba a5 43 75 81 03  |..#~p.{.<`..Cu..|
-00000030  9d 0f bc e0 e9 15 03 02  00 30 00 00 00 00 00 00  |.........0......|
-00000040  00 00 00 00 00 00 00 00  00 00 03 8a a2 8c 8d bd  |................|
-00000050  93 a1 b5 f4 cc 99 51 4f  bd fe 16 cc 7f 00 fd 67  |......QO.......g|
-00000060  5d 86 fc 45 c6 b8 22 be  1a 86                    |]..E.."...|
+00000010  00 00 00 00 00 3a 66 f0  79 00 4d 4c 1e 66 e5 44  |.....:f.y.ML.f.D|
+00000020  16 08 fb 51 1e e7 e5 34  c6 f0 24 af ac 73 fb 4a  |...Q...4..$..s.J|
+00000030  76 ea 5c 3d 05 15 03 02  00 30 00 00 00 00 00 00  |v.\=.....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 64 15 58 c9 d4 88  |..........d.X...|
+00000050  e3 9f c2 d7 68 55 cf 50  e7 41 19 b2 0a d7 8c 0e  |....hU.P.A......|
+00000060  80 8d f8 68 45 c3 77 c6  05 c4                    |...hE.w...|
diff --git a/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4 b/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4
index 71ad4cdacb..30824c6206 100644
--- a/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4
+++ b/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 36 00 05 00 05  01 00 00 00 00 00 0a 00  |...6............|
-00000060  08 00 06 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
-00000070  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
-00000080  03 ff 01 00 01 00 00 12  00 00                    |..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 02 00 51 02 00 00  4d 03 02 ae 75 14 49 89  |....Q...M...u.I.|
-00000010  d8 40 5b 20 0a 72 b9 6f  f7 90 a7 84 cd 86 f8 03  |.@[ .r.o........|
-00000020  a3 9b 65 24 78 7a b0 b5  1f 8c 8f 20 00 13 31 5c  |..e$xz..... ..1\|
-00000030  a7 b6 46 db cf d0 6d 0b  25 17 93 1f 6c 51 de 8d  |..F...m.%...lQ..|
-00000040  f3 c1 86 c3 ad 81 a0 9a  22 8b bf b1 00 05 00 00  |........".......|
+00000000  16 03 02 00 51 02 00 00  4d 03 02 79 51 85 f7 61  |....Q...M..yQ..a|
+00000010  76 b1 6e a0 f4 f5 07 01  86 38 bd 08 f6 97 fe 36  |v.n......8.....6|
+00000020  80 f0 b0 a8 e5 d6 1b a9  30 56 82 20 1e 9f 1b 39  |........0V. ...9|
+00000030  8c b6 64 a9 94 6a 78 15  02 0d ce 83 57 7e 27 e1  |..d..jx.....W~'.|
+00000040  35 c6 3b 77 c6 21 88 e2  90 0b bc 07 00 05 00 00  |5.;w.!..........|
 00000050  05 ff 01 00 01 00 16 03  02 02 59 0b 00 02 55 00  |..........Y...U.|
 00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -63,15 +63,15 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 02 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 02 00 24 7f 34  df 4a 9e 2f f4 57 95 15  |.....$.4.J./.W..|
-000000a0  54 01 5d e4 78 e1 48 bb  d8 09 09 1b a4 eb a8 6a  |T.].x.H........j|
-000000b0  94 4c 7e 9d 5c 10 92 e3  81 54                    |.L~.\....T|
+00000090  01 16 03 02 00 24 72 27  a5 3c 05 94 3e 33 89 f3  |.....$r'.<..>3..|
+000000a0  8f 76 29 e6 18 b3 51 a9  72 e5 88 0c 6c 6f 81 08  |.v)...Q.r...lo..|
+000000b0  7b 80 4b 35 00 1d e2 57  2a cb                    |{.K5...W*.|
 >>> Flow 4 (server to client)
-00000000  14 03 02 00 01 01 16 03  02 00 24 56 7f 65 57 7a  |..........$V.eWz|
-00000010  44 51 c8 82 ec 49 9f c5  d9 f7 68 59 a6 85 7f 40  |DQ...I....hY...@|
-00000020  e1 17 21 bc 33 7e 2f b3  3c 92 0d fb 13 36 bf     |..!.3~/.<....6.|
+00000000  14 03 02 00 01 01 16 03  02 00 24 eb 2c 34 2f 7e  |..........$.,4/~|
+00000010  f1 6c 7a 74 a8 78 f3 f6  31 e6 e8 47 c4 a8 22 b7  |.lzt.x..1..G..".|
+00000020  45 54 12 35 fa 1c 49 c3  e4 98 68 57 3b f7 9e     |ET.5..I...hW;..|
 >>> Flow 5 (client to server)
-00000000  17 03 02 00 1a f8 15 d3  49 06 f4 2b d7 6f cb 39  |........I..+.o.9|
-00000010  ec 32 43 9e 94 5b 1c 21  9c 96 77 1b 4b cf 9c 15  |.2C..[.!..w.K...|
-00000020  03 02 00 16 62 09 0c 99  a4 ac 4c a4 0b 53 e6 d1  |....b.....L..S..|
-00000030  cf ad ca 9b 75 fd 3a 41  cb e7                    |....u.:A..|
+00000000  17 03 02 00 1a 0a 0c 4d  74 f8 72 f8 b5 c4 08 94  |.......Mt.r.....|
+00000010  5b 59 b3 c0 49 9d a6 2d  b0 d0 eb a2 b3 d9 ec 15  |[Y..I..-........|
+00000020  03 02 00 16 f5 1e d1 1f  cf 58 33 a6 78 48 5b c1  |.........X3.xH[.|
+00000030  15 4d e5 fb 20 d0 c5 75  fc c0                    |.M.. ..u..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256
index 58d4c24f14..4968b51416 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 36 00 05 00 05  01 00 00 00 00 00 0a 00  |...6............|
-00000060  08 00 06 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
-00000070  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
-00000080  03 ff 01 00 01 00 00 12  00 00                    |..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 51 02 00 00  4d 03 03 40 b4 e4 93 12  |....Q...M..@....|
-00000010  93 e8 72 80 9a 5b 49 8f  0a a4 b9 da 48 3c f8 3e  |..r..[I.....H<.>|
-00000020  61 8b 0d 63 e6 ca d1 28  9f 76 5b 20 e9 d2 9f 81  |a..c...(.v[ ....|
-00000030  11 5b b9 41 4e 93 d4 7b  8c fa fc 07 82 eb d2 a2  |.[.AN..{........|
-00000040  fc 35 59 c8 41 c2 b5 9f  e1 0d ad 82 00 9c 00 00  |.5Y.A...........|
+00000000  16 03 03 00 51 02 00 00  4d 03 03 a3 21 43 88 85  |....Q...M...!C..|
+00000010  1c 79 0b 73 68 bb 9d 21  9b 9e 1b 35 ba f0 b9 23  |.y.sh..!...5...#|
+00000020  98 cc 58 c9 91 d5 d4 0b  a3 34 f4 20 1f 0b 14 7f  |..X......4. ....|
+00000030  3e b0 95 a8 3e 55 80 d3  72 81 39 72 79 11 59 8e  |>...>U..r.9ry.Y.|
+00000040  9e 5d 57 14 00 fd 48 6a  a1 76 f5 83 00 9c 00 00  |.]W...Hj.v......|
 00000050  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
 00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -63,17 +63,17 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 fe 7f  |.....(..........|
-000000a0  ef 65 01 85 ef 6a de d3  81 dd 0a 05 25 bd bf db  |.e...j......%...|
-000000b0  6a 65 f0 c6 d4 cb 40 ec  8d 39 fa 08 60 89        |je....@..9..`.|
+00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 71 ea  |.....(........q.|
+000000a0  6e 5a 0e 2b bf 1e b6 c8  ca 92 04 e4 b3 cc f7 00  |nZ.+............|
+000000b0  79 a1 5f 96 a5 a5 a7 26  e6 0c a1 b0 7c 1f        |y._....&....|.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 3b ec 4d 30 2e  |..........(;.M0.|
-00000010  8e f1 51 6d 34 3c 08 64  d2 30 07 60 20 bd fd e2  |..Qm4<.d.0.` ...|
-00000020  0f 9f dd b0 79 22 ff db  de ed e6 e0 25 0b c1 86  |....y"......%...|
-00000030  a2 04 08                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 28 55 d1 d6 5c df  |..........(U..\.|
+00000010  83 67 63 7f 50 f9 d7 1b  f1 93 ee fa 98 60 ab 06  |.gc.P........`..|
+00000020  b4 7e e7 d3 44 8e 7d 90  2f b9 fb 2b 35 3b 20 76  |.~..D.}./..+5; v|
+00000030  38 4e ea                                          |8N.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 ea c5 33  |...............3|
-00000010  1b ba ad 0b 84 8f 76 f2  94 be a9 7f 1a 96 23 ff  |......v.......#.|
-00000020  a6 0a e0 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
-00000030  e0 07 5d 5a 71 54 ae 2a  2a 7c 1a 7c 62 d4 53 44  |..]ZqT.**|.|b.SD|
-00000040  aa 3e                                             |.>|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 26 42 83  |.............&B.|
+00000010  2e a6 ab c2 34 5e 8c 8e  11 bf 3c e6 86 ec 90 46  |....4^....<....F|
+00000020  b1 66 a1 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.f..............|
+00000030  8e f6 8a 98 ae 2d 7d 36  e4 cc 11 aa ea 41 21 7c  |.....-}6.....A!||
+00000040  fc fe                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-AES128-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-AES128-SHA256
new file mode 100644
index 0000000000..c157b2a996
--- /dev/null
+++ b/src/crypto/tls/testdata/Client-TLSv12-AES128-SHA256
@@ -0,0 +1,88 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+>>> Flow 2 (server to client)
+00000000  16 03 03 00 51 02 00 00  4d 03 03 98 81 93 d5 ae  |....Q...M.......|
+00000010  17 07 94 d2 88 9d 9b 34  17 3e f6 69 aa 0a f0 a7  |.......4.>.i....|
+00000020  44 56 e4 a0 9a 2a 5c 9c  1e b4 1d 20 d7 a5 96 26  |DV...*\.... ...&|
+00000030  31 60 01 01 61 50 d2 40  70 be 79 9c 78 11 9b 80  |1`..aP.@p.y.x...|
+00000040  c5 20 b5 7a 77 51 eb 6b  ca c6 d3 fa 00 3c 00 00  |. .zwQ.k.....<..|
+00000050  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
+00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
+00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
+00000080  09 2a 86 48 86 f7 0d 01  01 0b 05 00 30 1f 31 0b  |.*.H........0.1.|
+00000090  30 09 06 03 55 04 0a 13  02 47 6f 31 10 30 0e 06  |0...U....Go1.0..|
+000000a0  03 55 04 03 13 07 47 6f  20 52 6f 6f 74 30 1e 17  |.U....Go Root0..|
+000000b0  0d 31 36 30 31 30 31 30  30 30 30 30 30 5a 17 0d  |.160101000000Z..|
+000000c0  32 35 30 31 30 31 30 30  30 30 30 30 5a 30 1a 31  |250101000000Z0.1|
+000000d0  0b 30 09 06 03 55 04 0a  13 02 47 6f 31 0b 30 09  |.0...U....Go1.0.|
+000000e0  06 03 55 04 03 13 02 47  6f 30 81 9f 30 0d 06 09  |..U....Go0..0...|
+000000f0  2a 86 48 86 f7 0d 01 01  01 05 00 03 81 8d 00 30  |*.H............0|
+00000100  81 89 02 81 81 00 db 46  7d 93 2e 12 27 06 48 bc  |.......F}...'.H.|
+00000110  06 28 21 ab 7e c4 b6 a2  5d fe 1e 52 45 88 7a 36  |.(!.~...]..RE.z6|
+00000120  47 a5 08 0d 92 42 5b c2  81 c0 be 97 79 98 40 fb  |G....B[.....y.@.|
+00000130  4f 6d 14 fd 2b 13 8b c2  a5 2e 67 d8 d4 09 9e d6  |Om..+.....g.....|
+00000140  22 38 b7 4a 0b 74 73 2b  c2 34 f1 d1 93 e5 96 d9  |"8.J.ts+.4......|
+00000150  74 7b f3 58 9f 6c 61 3c  c0 b0 41 d4 d9 2b 2b 24  |t{.X.la<..A..++$|
+00000160  23 77 5b 1c 3b bd 75 5d  ce 20 54 cf a1 63 87 1d  |#w[.;.u]. T..c..|
+00000170  1e 24 c4 f3 1d 1a 50 8b  aa b6 14 43 ed 97 a7 75  |.$....P....C...u|
+00000180  62 f4 14 c8 52 d7 02 03  01 00 01 a3 81 93 30 81  |b...R.........0.|
+00000190  90 30 0e 06 03 55 1d 0f  01 01 ff 04 04 03 02 05  |.0...U..........|
+000001a0  a0 30 1d 06 03 55 1d 25  04 16 30 14 06 08 2b 06  |.0...U.%..0...+.|
+000001b0  01 05 05 07 03 01 06 08  2b 06 01 05 05 07 03 02  |........+.......|
+000001c0  30 0c 06 03 55 1d 13 01  01 ff 04 02 30 00 30 19  |0...U.......0.0.|
+000001d0  06 03 55 1d 0e 04 12 04  10 9f 91 16 1f 43 43 3e  |..U..........CC>|
+000001e0  49 a6 de 6d b6 80 d7 9f  60 30 1b 06 03 55 1d 23  |I..m....`0...U.#|
+000001f0  04 14 30 12 80 10 48 13  49 4d 13 7e 16 31 bb a3  |..0...H.IM.~.1..|
+00000200  01 d5 ac ab 6e 7b 30 19  06 03 55 1d 11 04 12 30  |....n{0...U....0|
+00000210  10 82 0e 65 78 61 6d 70  6c 65 2e 67 6f 6c 61 6e  |...example.golan|
+00000220  67 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |g0...*.H........|
+00000230  03 81 81 00 9d 30 cc 40  2b 5b 50 a0 61 cb ba e5  |.....0.@+[P.a...|
+00000240  53 58 e1 ed 83 28 a9 58  1a a9 38 a4 95 a1 ac 31  |SX...(.X..8....1|
+00000250  5a 1a 84 66 3d 43 d3 2d  d9 0b f2 97 df d3 20 64  |Z..f=C.-...... d|
+00000260  38 92 24 3a 00 bc cf 9c  7d b7 40 20 01 5f aa d3  |8.$:....}.@ ._..|
+00000270  16 61 09 a2 76 fd 13 c3  cc e1 0c 5c ee b1 87 82  |.a..v......\....|
+00000280  f1 6c 04 ed 73 bb b3 43  77 8d 0c 1c f1 0f a1 d8  |.l..s..Cw.......|
+00000290  40 83 61 c9 4c 72 2b 9d  ae db 46 06 06 4d f4 c1  |@.a.Lr+...F..M..|
+000002a0  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
+000002b0  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
+>>> Flow 3 (client to server)
+00000000  16 03 03 00 86 10 00 00  82 00 80 b9 65 8d bf a7  |............e...|
+00000010  c8 4b 79 ce 6f cb 8b 13  1c ac b9 7d 66 5e e9 ba  |.Ky.o......}f^..|
+00000020  1d 71 4e a9 e9 34 ae f6  64 65 90 3b d8 16 52 a2  |.qN..4..de.;..R.|
+00000030  6f f4 cb 8a 13 74 a2 ee  b7 27 69 b4 41 c0 90 68  |o....t...'i.A..h|
+00000040  bc 02 69 e1 c6 48 4f 39  36 30 25 ca 4c 17 ce 83  |..i..HO960%.L...|
+00000050  9e 08 56 e3 05 49 93 9e  2e c4 fb e6 c8 01 f1 0f  |..V..I..........|
+00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
+00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
+00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
+00000090  01 16 03 03 00 50 00 00  00 00 00 00 00 00 00 00  |.....P..........|
+000000a0  00 00 00 00 00 00 8c d5  df ad b6 03 cd aa 22 28  |.............."(|
+000000b0  c7 aa 35 6a ce 63 e0 6e  84 ed a0 7c 33 ea 0a 0e  |..5j.c.n...|3...|
+000000c0  65 9f 33 11 a9 9a 26 e8  e9 61 d5 3d 6c 75 b8 ad  |e.3...&..a.=lu..|
+000000d0  00 6e 4f 39 ef 63 7f e9  5d 4d 02 80 c9 f1 f3 5b  |.nO9.c..]M.....[|
+000000e0  37 82 57 27 5c 5a                                 |7.W'\Z|
+>>> Flow 4 (server to client)
+00000000  14 03 03 00 01 01 16 03  03 00 50 be 8e 07 a1 cd  |..........P.....|
+00000010  0d 32 45 c2 6c b8 2f 13  85 8a a6 dd 91 96 9d c6  |.2E.l./.........|
+00000020  6b 99 0d 6a 09 90 a1 09  b1 5e 93 40 02 66 b5 4e  |k..j.....^.@.f.N|
+00000030  2e 6a e4 61 21 30 ca 6e  dc 82 69 de a9 dc 91 c1  |.j.a!0.n..i.....|
+00000040  99 f7 be 83 54 78 b8 7c  ae c8 bc d5 5b 3c 8c 57  |....Tx.|....[<.W|
+00000050  22 9a f8 12 8f 20 25 7d  27 41 16                 |".... %}'A.|
+>>> Flow 5 (client to server)
+00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
+00000010  00 00 00 00 00 0d d7 40  0b f7 6b 93 ea f1 e8 62  |.......@..k....b|
+00000020  ff d3 4d 1a d8 06 43 32  7b 43 c2 27 61 13 a7 79  |..M...C2{C.'a..y|
+00000030  5d 69 ad 62 62 33 cb db  80 a7 1b 1b 46 a0 c4 f2  |]i.bb3......F...|
+00000040  ee dd 44 b9 5b 15 03 03  00 40 00 00 00 00 00 00  |..D.[....@......|
+00000050  00 00 00 00 00 00 00 00  00 00 b1 cd 45 e1 d5 a5  |............E...|
+00000060  83 68 34 51 2b e6 19 b1  0f 57 95 4a 0d c7 cd d1  |.h4Q+....W.J....|
+00000070  8b aa 32 f1 f7 a4 1f 46  4a 4b cb 5f 5f ce 46 49  |..2....FJK.__.FI|
+00000080  81 07 9d e0 c0 6c fa ae  68 5c                    |.....l..h\|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384 b/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384
index 0f4fa235c3..864e30bbeb 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384
+++ b/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 36 00 05 00 05  01 00 00 00 00 00 0a 00  |...6............|
-00000060  08 00 06 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
-00000070  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
-00000080  03 ff 01 00 01 00 00 12  00 00                    |..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 51 02 00 00  4d 03 03 f0 76 fa ff 76  |....Q...M...v..v|
-00000010  7a 93 70 41 28 a9 a9 55  4b 9f 53 74 71 84 5b 80  |z.pA(..UK.Stq.[.|
-00000020  21 91 3b d6 f6 28 98 94  01 61 df 20 fa 8d 33 9a  |!.;..(...a. ..3.|
-00000030  d8 eb 8d ed 77 95 46 ae  54 61 4b dd 46 69 55 76  |....w.F.TaK.FiUv|
-00000040  f2 f5 f3 59 87 e4 ea 28  20 06 a6 b1 00 9d 00 00  |...Y...( .......|
+00000000  16 03 03 00 51 02 00 00  4d 03 03 0f 84 66 da 4b  |....Q...M....f.K|
+00000010  db c1 8a a4 de 44 9f 7a  00 73 20 c7 30 fe 42 4f  |.....D.z.s .0.BO|
+00000020  5e 05 98 ec 32 0d 4c 35  59 de dd 20 63 e2 0b b0  |^...2.L5Y.. c...|
+00000030  e1 0a f3 4f 0c 92 68 56  46 ad ef 09 46 db ec 8f  |...O..hVF...F...|
+00000040  e3 b2 e9 6d 3b a7 7b 40  cf 8d 42 0e 00 9d 00 00  |...m;.{@..B.....|
 00000050  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
 00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -63,17 +63,17 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 c3 87  |.....(..........|
-000000a0  a3 38 2d 2b bd 69 6d 05  56 90 18 81 bc cf fd 47  |.8-+.im.V......G|
-000000b0  41 02 ee 58 e5 5c 51 7b  e5 47 03 81 9e 8e        |A..X.\Q{.G....|
+00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 3f eb  |.....(........?.|
+000000a0  b8 b8 eb 79 63 ce f1 b5  f6 d8 87 28 93 17 cb 35  |...yc......(...5|
+000000b0  88 6d 4e 09 9d 91 e9 f1  20 f6 50 34 89 8b        |.mN..... .P4..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 8f f1 d3 0d ec  |..........(.....|
-00000010  ed a0 c5 fe a0 a0 5b 16  da 9c c6 3e 8d be 0c 02  |......[....>....|
-00000020  c4 c3 91 a4 92 ec 13 35  a1 a4 38 d6 94 30 b8 b8  |.......5..8..0..|
-00000030  87 a9 2d                                          |..-|
+00000000  14 03 03 00 01 01 16 03  03 00 28 e6 95 78 b9 fb  |..........(..x..|
+00000010  7a 79 ad 3b 3d cd 42 80  c0 d3 81 ce 83 72 d1 b6  |zy.;=.B......r..|
+00000020  72 64 23 a8 ee 7f 35 88  53 5d 03 f2 a1 1d 4a e1  |rd#...5.S]....J.|
+00000030  f7 63 c4                                          |.c.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 db 5d 7b  |..............]{|
-00000010  b9 71 79 b2 ca 06 e2 50  32 6b 26 80 ca ac b9 20  |.qy....P2k&.... |
-00000020  0f 27 2c 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.',.............|
-00000030  38 4a 5c fb 52 4a 59 55  f8 ae 01 c2 a0 8d 10 4a  |8J\.RJYU.......J|
-00000040  d9 5d                                             |.]|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 94 30 a0  |..............0.|
+00000010  df 8a fd 3f 61 98 97 fa  b3 82 3c 65 1a 3c e4 b2  |...?a.....<e.<..|
+00000020  b7 df 3e 15 03 03 00 1a  00 00 00 00 00 00 00 02  |..>.............|
+00000030  99 e6 16 fd f2 11 bf 28  fc f9 fb 20 31 5b cb 41  |.......(... 1[.A|
+00000040  30 3a                                             |0:|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ALPN b/src/crypto/tls/testdata/Client-TLSv12-ALPN
index 2f694eaf59..506447dcef 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ALPN
+++ b/src/crypto/tls/testdata/Client-TLSv12-ALPN
@@ -1,21 +1,21 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 9d 01 00 00  99 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 a3 01 00 00  9f 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 4e 33 74 00 00  00 05 00 05 01 00 00 00  |...N3t..........|
-00000060  00 00 0a 00 08 00 06 00  17 00 18 00 19 00 0b 00  |................|
-00000070  02 01 00 00 0d 00 0e 00  0c 04 01 04 03 05 01 05  |................|
-00000080  03 02 01 02 03 ff 01 00  01 00 00 10 00 10 00 0e  |................|
-00000090  06 70 72 6f 74 6f 32 06  70 72 6f 74 6f 31 00 12  |.proto2.proto1..|
-000000a0  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 4e 33 74 00 00 00 05  |.........N3t....|
+00000060  00 05 01 00 00 00 00 00  0a 00 08 00 06 00 17 00  |................|
+00000070  18 00 19 00 0b 00 02 01  00 00 0d 00 0e 00 0c 04  |................|
+00000080  01 04 03 05 01 05 03 02  01 02 03 ff 01 00 01 00  |................|
+00000090  00 10 00 10 00 0e 06 70  72 6f 74 6f 32 06 70 72  |.......proto2.pr|
+000000a0  6f 74 6f 31 00 12 00 00                           |oto1....|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 66 02 00 00  62 03 03 5e e0 57 a5 74  |....f...b..^.W.t|
-00000010  90 8c 64 6e 3f e7 74 31  d8 51 38 b7 2e fa 63 8b  |..dn?.t1.Q8...c.|
-00000020  1c 48 28 4c 03 9d 39 38  83 2b 05 20 2f bc a2 91  |.H(L..98.+. /...|
-00000030  91 82 d3 f7 2a 3b 29 07  ce 1e f6 81 3a de 56 05  |....*;).....:.V.|
-00000040  4d 46 6b bb cd 6e 4b 57  da e3 37 45 c0 2f 00 00  |MFk..nKW..7E./..|
+00000000  16 03 03 00 66 02 00 00  62 03 03 0c a7 7a d3 5c  |....f...b....z.\|
+00000010  e0 a4 0b 86 4f ac b8 40  37 f3 5c 30 f2 a5 9d 7a  |....O..@7.\0...z|
+00000020  fe 9d 51 3e 03 62 7a 02  46 d2 f8 20 e9 4c a0 1a  |..Q>.bz.F.. .L..|
+00000030  fa 02 84 51 9f dc 01 88  73 4b 61 66 11 6f e4 58  |...Q....sKaf.o.X|
+00000040  31 ff 97 2d 26 38 56 db  cf 2c e0 72 c0 2f 00 00  |1..-&8V..,.r./..|
 00000050  1a ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 10  |................|
 00000060  00 09 00 07 06 70 72 6f  74 6f 31 16 03 03 02 59  |.....proto1....Y|
 00000070  0b 00 02 55 00 02 52 00  02 4f 30 82 02 4b 30 82  |...U..R..O0..K0.|
@@ -56,19 +56,19 @@
 000002a0  1c f1 0f a1 d8 40 83 61  c9 4c 72 2b 9d ae db 46  |.....@.a.Lr+...F|
 000002b0  06 06 4d f4 c1 b3 3e c0  d1 bd 42 d4 db fe 3d 13  |..M...>...B...=.|
 000002c0  60 84 5c 21 d3 3b e9 fa  e7 16 03 03 00 cd 0c 00  |`.\!.;..........|
-000002d0  00 c9 03 00 17 41 04 04  c9 59 3b 02 80 a0 a5 ec  |.....A...Y;.....|
-000002e0  67 e4 2f 94 87 0a a6 85  05 63 9d 3e ad c0 fd c2  |g./......c.>....|
-000002f0  26 e6 a4 e7 2b da 35 51  2d 17 75 b3 05 1d bb 50  |&...+.5Q-.u....P|
-00000300  88 e8 da 56 8d 2c 28 f3  2e 45 9d 47 37 1d a9 34  |...V.,(..E.G7..4|
-00000310  50 49 7a 6b ec 8c f8 04  01 00 80 39 b9 12 34 57  |PIzk.......9..4W|
-00000320  20 b8 2a cb ec b0 ba bc  de 71 6c 8c ff 82 d4 9e  | .*......ql.....|
-00000330  f8 6c 41 db 04 72 d0 c3  02 96 90 80 56 33 81 0a  |.lA..r......V3..|
-00000340  27 d8 01 38 12 cf e2 57  ca 77 d1 64 0e f1 67 60  |'..8...W.w.d..g`|
-00000350  8c 06 f7 ed 8b 07 9e db  af 65 ca 62 1b 98 66 29  |.........e.b..f)|
-00000360  0f 03 ec 23 3d 56 43 ea  fe d4 71 7f 3b fd 7a 83  |...#=VC...q.;.z.|
-00000370  df 2b f2 02 11 cb a3 0f  1b 68 0f ad dd f9 ce bb  |.+.......h......|
-00000380  e4 40 24 38 2a a8 b5 69  47 7e d7 be 0e 5e f8 1e  |.@$8*..iG~...^..|
-00000390  f7 25 99 9a cf 9c b1 1d  a2 51 0e 16 03 03 00 04  |.%.......Q......|
+000002d0  00 c9 03 00 17 41 04 21  8b 87 3e 55 73 ed 1f d6  |.....A.!..>Us...|
+000002e0  78 74 61 6c b5 02 90 2f  c3 0b 0c 69 11 3a 23 4e  |xtal.../...i.:#N|
+000002f0  5b 82 bd d4 a8 da 66 34  7f 73 99 d3 7f 92 16 44  |[.....f4.s.....D|
+00000300  1c 90 0e 2a 39 d0 e3 25  4b 00 7b 1a 04 5f 98 0f  |...*9..%K.{.._..|
+00000310  d4 ef c5 12 df 46 ef 04  01 00 80 ae 98 07 54 3d  |.....F........T=|
+00000320  c3 62 ef 34 96 02 54 cf  af 5e 5f b8 5e d3 6e 2c  |.b.4..T..^_.^.n,|
+00000330  35 59 90 f8 f8 02 c9 04  1a 8b cf 9d 59 12 4d be  |5Y..........Y.M.|
+00000340  3b 38 fe 09 83 3e 59 8c  61 a5 77 46 e8 68 c2 0d  |;8...>Y.a.wF.h..|
+00000350  f7 22 70 35 f8 1c 35 70  d5 f8 6a 1f 4d 0a 0c 25  |."p5..5p..j.M..%|
+00000360  26 7e 76 ce 4a 5d 6d 8c  36 68 89 8d 23 f3 90 09  |&~v.J]m.6h..#...|
+00000370  5a e1 bc b4 6e 96 22 65  1f 0b 9a 5b c5 67 9e 48  |Z...n."e...[.g.H|
+00000380  c4 d0 ab 1d 5f 9b 61 20  06 cd 6d 5b 5e 60 a8 c9  |...._.a ..m[^`..|
+00000390  dd 8f c2 33 69 ac 8f ef  ef 67 a2 16 03 03 00 04  |...3i....g......|
 000003a0  0e 00 00 00                                       |....|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
@@ -76,17 +76,17 @@
 00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 52 f3  |.....(........R.|
-00000060  ac 48 1c 2c 51 47 71 00  23 b3 c1 fa 6a c0 d7 89  |.H.,QGq.#...j...|
-00000070  43 dd d2 6d fb 93 04 fb  22 d0 05 5c 5a ed        |C..m...."..\Z.|
+00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 6b e3  |.....(........k.|
+00000060  b1 c3 b7 3f ab 57 eb eb  27 1f c0 77 05 13 37 9c  |...?.W..'..w..7.|
+00000070  2e d6 ea aa c0 de 93 22  3e e7 55 b3 45 07        |.......">.U.E.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 bc be 2a e2 a4  |..........(..*..|
-00000010  f1 31 fa 97 45 f9 4d 88  9d 36 c1 f3 c3 40 c6 6e  |.1..E.M..6...@.n|
-00000020  5d 3c 35 fb c5 33 97 0e  be 3e 30 67 25 14 11 d6  |]<5..3...>0g%...|
-00000030  6a 98 1a                                          |j..|
+00000000  14 03 03 00 01 01 16 03  03 00 28 cb 18 03 ae c5  |..........(.....|
+00000010  b3 96 3b df 2e de 69 b0  21 ff 73 ee 52 98 04 17  |..;...i.!.s.R...|
+00000020  b6 d6 73 e8 f1 bd da b7  cc 59 75 76 9e 91 f8 8b  |..s......Yuv....|
+00000030  b7 8a f6                                          |...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 90 6c a3  |..............l.|
-00000010  2e 56 6d be b7 01 4a f0  cf ab 1b 02 29 da 8b 84  |.Vm...J.....)...|
-00000020  1d 6d 8e 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.m..............|
-00000030  cc 27 3a 4b 67 36 a1 ba  ea 55 84 10 f9 92 97 f3  |.':Kg6...U......|
-00000040  ea 1b                                             |..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 9b 27 1f  |..............'.|
+00000010  a1 ad 76 5f 08 ba eb cb  48 30 b8 f2 76 ef a7 ba  |..v_....H0..v...|
+00000020  9a e9 96 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
+00000030  07 87 4d 76 93 bb f1 ed  5b e0 aa b7 9b 08 9f d0  |..Mv....[.......|
+00000040  6e 8d                                             |n.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ALPN-NoMatch b/src/crypto/tls/testdata/Client-TLSv12-ALPN-NoMatch
index 4bdc63f41b..62e7d11bb8 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ALPN-NoMatch
+++ b/src/crypto/tls/testdata/Client-TLSv12-ALPN-NoMatch
@@ -1,20 +1,21 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 96 01 00 00  92 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 9c 01 00 00  98 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 47 33 74 00 00  00 05 00 05 01 00 00 00  |...G3t..........|
-00000060  00 00 0a 00 08 00 06 00  17 00 18 00 19 00 0b 00  |................|
-00000070  02 01 00 00 0d 00 0e 00  0c 04 01 04 03 05 01 05  |................|
-00000080  03 02 01 02 03 ff 01 00  01 00 00 10 00 09 00 07  |................|
-00000090  06 70 72 6f 74 6f 33 00  12 00 00                 |.proto3....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 47 33 74 00 00 00 05  |.........G3t....|
+00000060  00 05 01 00 00 00 00 00  0a 00 08 00 06 00 17 00  |................|
+00000070  18 00 19 00 0b 00 02 01  00 00 0d 00 0e 00 0c 04  |................|
+00000080  01 04 03 05 01 05 03 02  01 02 03 ff 01 00 01 00  |................|
+00000090  00 10 00 09 00 07 06 70  72 6f 74 6f 33 00 12 00  |.......proto3...|
+000000a0  00                                                |.|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 d1 a8 e1 2f 4a  |....Y...U...../J|
-00000010  49 c9 a6 33 e9 58 8a 6a  29 12 77 fc b9 6e 15 3a  |I..3.X.j).w..n.:|
-00000020  b6 32 05 6d 32 ed c3 9b  9d 79 7b 20 fc 1d 11 da  |.2.m2....y{ ....|
-00000030  29 e7 2c b4 c2 00 77 55  59 21 00 c0 ed b5 55 d6  |).,...wUY!....U.|
-00000040  2a 14 e8 f5 3d f4 8a 06  36 58 a3 cf c0 2f 00 00  |*...=...6X.../..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 36 0e 9f 51 42  |....Y...U..6..QB|
+00000010  82 65 fa b5 17 7a 86 d6  40 33 a9 67 d3 3d aa 2f  |.e...z..@3.g.=./|
+00000020  89 a0 39 82 af 16 30 8e  64 80 d4 20 23 a6 d0 12  |..9...0.d.. #...|
+00000030  ff 8c fc b4 b5 47 ec 10  fe ba 73 fb 0f ab e8 1c  |.....G....s.....|
+00000040  15 c1 fb 11 c1 b2 e1 8a  f7 5d 5b ad c0 2f 00 00  |.........][../..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -54,19 +55,19 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  cd 0c 00 00 c9 03 00 17  41 04 a3 ee 20 63 b5 a9  |........A... c..|
-000002d0  f8 e4 7b 82 8d cd d2 1d  75 60 99 33 0d af ac 13  |..{.....u`.3....|
-000002e0  9f 82 5a 51 0c 07 65 77  eb 81 bd 08 4d de 80 a6  |..ZQ..ew....M...|
-000002f0  b5 e1 90 8d 2e 79 db 6b  d3 c4 f7 71 fe 11 48 28  |.....y.k...q..H(|
-00000300  1e d6 1d 44 8e e6 1f 65  9f b7 04 01 00 80 82 95  |...D...e........|
-00000310  d7 9e 87 18 f7 d1 d3 54  a6 62 1d 87 b6 80 b0 60  |.......T.b.....`|
-00000320  c0 fd 38 3c 0d f1 6a 7c  bd 0e 6b 38 72 fb 8e c9  |..8<..j|..k8r...|
-00000330  b2 df df c5 c7 96 17 8d  ab a3 52 4c b9 85 a4 5c  |..........RL...\|
-00000340  6e c2 2a d5 d6 68 39 e4  d8 01 87 00 24 0a 4d 3b  |n.*..h9.....$.M;|
-00000350  aa f4 3e 2e a4 06 4a eb  38 de a7 ce 29 bf 53 18  |..>...J.8...).S.|
-00000360  8d 06 3a af ce 15 38 80  0a 16 57 0e 1d 84 6c 8b  |..:...8...W...l.|
-00000370  5b 23 95 c9 13 21 f9 24  96 1c e2 ac 4c c3 59 40  |[#...!.$....L.Y@|
-00000380  cc 8b 5d f8 17 23 dd 89  1b 41 05 e0 dd a6 16 03  |..]..#...A......|
+000002c0  cd 0c 00 00 c9 03 00 17  41 04 11 b4 a9 10 7e 5c  |........A.....~\|
+000002d0  41 5e 39 12 15 a3 ed 5b  3e 5d 68 c8 ad 48 39 ef  |A^9....[>]h..H9.|
+000002e0  09 8b b1 a7 bf db 5f 54  49 cd d5 de 4d b3 47 4c  |......_TI...M.GL|
+000002f0  18 02 84 7c ec 75 4e d0  3e 8a d1 6c 80 83 98 64  |...|.uN.>..l...d|
+00000300  4a 81 bc 8f 84 c7 e5 b4  2d fa 04 01 00 80 72 ee  |J.......-.....r.|
+00000310  41 38 f2 b8 a1 56 81 d8  04 78 75 05 f4 78 5f f2  |A8...V...xu..x_.|
+00000320  2b 5d a2 46 23 9d 48 c8  63 a9 1d de a8 78 6e 99  |+].F#.H.c....xn.|
+00000330  cd 59 6b 19 20 f5 b1 11  e1 f8 1c 5b 40 c3 b8 cd  |.Yk. ......[@...|
+00000340  66 a3 98 37 c5 c2 5c b7  d6 cc 61 b4 5e 97 fa dd  |f..7..\...a.^...|
+00000350  b7 85 5d b6 34 8c 39 4a  60 5a 03 20 47 7f e3 65  |..].4.9J`Z. G..e|
+00000360  01 18 00 2c c3 eb be d4  aa 58 57 a9 5e 69 fb 3c  |...,.....XW.^i.<|
+00000370  fa c6 28 1a 5c f7 00 d5  21 e5 c1 30 db 84 38 c3  |..(.\...!..0..8.|
+00000380  08 aa 08 5f c9 fd a0 b7  8e d0 66 77 bf 13 16 03  |..._......fw....|
 00000390  03 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
@@ -74,17 +75,17 @@
 00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 18 63  |.....(.........c|
-00000060  d7 bc a6 9e 05 b5 92 e3  7c 11 76 ef 0f 3c fd c2  |........|.v..<..|
-00000070  bf d4 2a fc 53 8d 63 ff  a2 2c f3 25 ab a9        |..*.S.c..,.%..|
+00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 4f 7e  |.....(........O~|
+00000060  9a 3a cc 74 a4 91 77 01  0b 0e 28 0a c5 bd 55 b7  |.:.t..w...(...U.|
+00000070  9a 4c 40 4e e9 c9 46 d5  5f c5 e1 77 c3 f2        |.L@N..F._..w..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 74 25 4a 87 b5  |..........(t%J..|
-00000010  67 de 7c 80 db 61 35 07  2e 2f ed b4 2b 12 38 12  |g.|..a5../..+.8.|
-00000020  a9 4e 6c ac 59 64 bb df  af a1 48 41 0e b3 f7 12  |.Nl.Yd....HA....|
-00000030  c9 06 f7                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 28 62 4b 13 ef 22  |..........(bK.."|
+00000010  f9 a8 8d ec 42 3a 36 80  5d a8 5b e9 60 d1 ba 65  |....B:6.].[.`..e|
+00000020  2b d8 37 64 e5 12 b2 ef  84 75 87 0c 0f 3d 35 6e  |+.7d.....u...=5n|
+00000030  59 7c 51                                          |Y|Q|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 03 0a 32  |...............2|
-00000010  8f c6 b5 43 b4 16 22 0d  fb 6e 6c b7 02 36 2c d4  |...C.."..nl..6,.|
-00000020  8c a2 f4 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
-00000030  1f 1b 26 43 1b de 12 34  ea 5b bc c1 e0 f8 19 3f  |..&C...4.[.....?|
-00000040  00 52                                             |.R|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 5f cd 4d  |............._.M|
+00000010  7b a7 c0 f9 6c 1f 80 93  cf 55 3b 12 c7 21 12 86  |{...l....U;..!..|
+00000020  f6 b1 52 15 03 03 00 1a  00 00 00 00 00 00 00 02  |..R.............|
+00000030  fd 31 a4 4b d1 e9 f0 e0  18 b5 96 28 f7 b4 0c 29  |.1.K.......(...)|
+00000040  8c 0c                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA
index f3d7710e95..cfe9758b97 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 36 00 05 00 05  01 00 00 00 00 00 0a 00  |...6............|
-00000060  08 00 06 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
-00000070  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
-00000080  03 ff 01 00 01 00 00 12  00 00                    |..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 d6 dd 74 6d 2b  |....Y...U....tm+|
-00000010  d4 87 97 98 54 07 08 91  45 f5 45 65 63 e1 aa 44  |....T...E.Eec..D|
-00000020  1e 89 71 86 a4 11 24 4d  f7 9e 9f 20 62 fd 7b bd  |..q...$M... b.{.|
-00000030  49 07 35 bc 3e cb 28 5a  b0 34 a6 c1 6a 43 e8 97  |I.5.>.(Z.4..jC..|
-00000040  31 d9 b3 ac c9 08 ca a4  e7 a6 02 e7 c0 09 00 00  |1...............|
+00000000  16 03 03 00 59 02 00 00  55 03 03 a5 35 db 1b a2  |....Y...U...5...|
+00000010  5a 62 21 c3 01 04 be 89  b6 ed e9 aa 6d 6b 9e 66  |Zb!.........mk.f|
+00000020  cb 7d 11 cc 73 66 e4 34  a5 3c 04 20 f0 4d 98 26  |.}..sf.4.<. .M.&|
+00000030  bb 7d 45 18 eb ad 5f 44  f9 82 5c 23 19 a1 6b 94  |.}E..._D..\#..k.|
+00000040  fb 02 fe 7b d2 a9 90 d1  a0 5e 79 a1 c0 09 00 00  |...{.....^y.....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,20 +48,20 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 d7 0c 00  00 d3 03 00 17 41 04 3a  |*............A.:|
-00000280  c2 3a b5 49 45 bd c8 52  cd f4 25 65 e0 f0 56 20  |.:.IE..R..%e..V |
-00000290  6a 33 e1 23 31 b5 9c 81  fe 8f 87 9a 6b bd 90 9f  |j3.#1.......k...|
-000002a0  c0 65 68 b2 74 5e e3 b8  03 3e 84 e9 53 c8 0d f4  |.eh.t^...>..S...|
-000002b0  a8 5e 41 5a c8 e6 8d 8c  34 f1 c5 e9 5d 07 41 04  |.^AZ....4...].A.|
-000002c0  03 00 8a 30 81 87 02 41  70 d8 b9 4c 7f 49 95 83  |...0...Ap..L.I..|
-000002d0  f4 6b 42 19 d2 f3 a4 63  bd cb c9 a2 d4 98 5b b1  |.kB....c......[.|
-000002e0  24 18 7b fd d0 05 fb a2  46 f2 fa e0 a7 6e 1a a5  |$.{.....F....n..|
-000002f0  64 a3 35 a8 87 84 aa 52  80 37 9a b9 06 53 ee 91  |d.5....R.7...S..|
-00000300  d0 60 02 c1 b3 aa 86 05  6d 02 42 01 88 36 0a a9  |.`......m.B..6..|
-00000310  97 23 9b b9 85 76 a1 6b  c7 69 37 54 d8 4f 07 3a  |.#...v.k.i7T.O.:|
-00000320  6f c3 47 38 b2 0c a7 21  2f bd c1 1a c5 80 76 5b  |o.G8...!/.....v[|
-00000330  32 cb d1 5c 46 88 2e 7a  55 87 87 79 5c 1d 0c ba  |2..\F..zU..y\...|
-00000340  a7 56 86 ae 4a f5 e8 7b  81 23 7e d7 82 16 03 03  |.V..J..{.#~.....|
+00000270  2a 16 03 03 00 d7 0c 00  00 d3 03 00 17 41 04 5d  |*............A.]|
+00000280  75 5f 4d 4b c7 73 93 8a  be 43 dd 1e 70 a2 c7 c4  |u_MK.s...C..p...|
+00000290  7e f9 15 fe 8e d0 e0 f9  f7 37 fc 8a d7 3f 0d c4  |~........7...?..|
+000002a0  91 f0 f9 2e ca 09 0c d1  ff 0a 56 98 b1 3c 9a e9  |..........V..<..|
+000002b0  54 c4 34 5a 96 bd 4f 60  3d 67 85 13 4b c9 6d 04  |T.4Z..O`=g..K.m.|
+000002c0  03 00 8a 30 81 87 02 42  01 ae f0 63 00 b9 cc 88  |...0...B...c....|
+000002d0  d0 8d 9f 8f b1 1d bc f4  e5 3a 95 31 df 0a 83 d1  |.........:.1....|
+000002e0  e8 97 93 7a e8 e6 aa 47  a3 bd f3 cc 6c 8e 1d 09  |...z...G....l...|
+000002f0  92 99 f1 8f 0e 2b c8 96  fc 6c b3 d1 ea 1e 4c f0  |.....+...l....L.|
+00000300  af 8c 22 37 44 55 fd 43  90 6a 02 41 5c fa 17 52  |.."7DU.C.j.A\..R|
+00000310  c0 d3 1d 4d e0 59 c1 62  45 ed 07 05 84 d5 54 91  |...M.Y.bE.....T.|
+00000320  a6 e6 28 54 31 fa 66 03  de 70 35 42 b0 25 b1 43  |..(T1.f..p5B.%.C|
+00000330  bf 78 21 1f 29 ef a6 a1  7c 47 d8 00 07 ae 94 69  |.x!.)...|G.....i|
+00000340  71 e4 d2 c1 ee a8 e1 42  62 c0 00 ab 2b 16 03 03  |q......Bb...+...|
 00000350  00 2e 0d 00 00 26 03 01  02 40 00 1e 06 01 06 02  |.....&...@......|
 00000360  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
 00000370  03 02 03 03 02 01 02 02  02 03 00 00 0e 00 00 00  |................|
@@ -104,31 +104,31 @@
 00000230  24 20 3e b2 56 1c ce 97  28 5e f8 2b 2d 4f 9e f1  |$ >.V...(^.+-O..|
 00000240  07 9f 6c 4b 5b 83 56 e2  32 42 e9 58 b6 d7 49 a6  |..lK[.V.2B.X..I.|
 00000250  b5 68 1a 41 03 56 6b dc  5a 89 16 03 03 00 92 0f  |.h.A.Vk.Z.......|
-00000260  00 00 8e 05 03 00 8a 30  81 87 02 42 01 4a bf 96  |.......0...B.J..|
-00000270  4a 0b 87 81 26 f1 22 55  c3 8c d1 7d 6f 33 f5 21  |J...&."U...}o3.!|
-00000280  0b 2f 3a ae 08 8b b9 80  55 d4 3f 07 eb 78 6b 52  |./:.....U.?..xkR|
-00000290  f6 5d 63 e1 ac b9 3c fe  fc 37 e7 9a 6b 47 d3 33  |.]c...<..7..kG.3|
-000002a0  3b b1 a3 eb 83 7c 2c 0d  c3 f7 f0 b7 d4 10 02 41  |;....|,........A|
-000002b0  2a 25 f2 b1 da 57 18 24  39 9b 24 21 72 ec d7 ae  |*%...W.$9.$!r...|
-000002c0  cd 28 10 c8 2b e6 53 84  a6 ee 99 12 7c ab 20 6b  |.(..+.S.....|. k|
-000002d0  f2 9c aa d3 5a 74 d0 db  ac 0a e5 8a be 7f b8 bd  |....Zt..........|
-000002e0  ec 47 9e 73 9f ba 80 45  73 5d 43 64 3d b6 67 0a  |.G.s...Es]Cd=.g.|
-000002f0  a5 14 03 03 00 01 01 16  03 03 00 40 00 00 00 00  |...........@....|
-00000300  00 00 00 00 00 00 00 00  00 00 00 00 4c 68 36 55  |............Lh6U|
-00000310  79 e0 a1 ee 57 f3 2b 9c  3f b5 2f c9 3f 28 09 fa  |y...W.+.?./.?(..|
-00000320  e5 ad 4b a2 d2 3a 75 4b  dc e4 fe f8 ea 9d 92 99  |..K..:uK........|
-00000330  cc 3b 80 af fb 59 bc 5b  e1 7b 8c 1a              |.;...Y.[.{..|
+00000260  00 00 8e 05 03 00 8a 30  81 87 02 41 2c 37 42 21  |.......0...A,7B!|
+00000270  8e c8 ca f5 f4 87 03 10  d1 0f f1 f4 67 23 f0 6f  |............g#.o|
+00000280  84 88 fa f1 11 51 fe a3  6f 5b 01 93 e2 cc 75 6b  |.....Q..o[....uk|
+00000290  2d 15 a5 45 6c ec f2 67  36 d4 d9 f9 87 bd 80 2c  |-..El..g6......,|
+000002a0  3f d7 79 fa 23 b0 24 05  ab e7 ac a3 f5 02 42 01  |?.y.#.$.......B.|
+000002b0  f8 ae 55 d5 11 d7 6d 89  64 aa dd 78 e7 c1 37 79  |..U...m.d..x..7y|
+000002c0  3e 6f 21 b8 65 b1 5f 8b  2a ad a2 85 ff 33 47 cb  |>o!.e._.*....3G.|
+000002d0  74 50 97 fe 3f 9e fe 86  0c 4c b5 55 38 79 f2 cb  |tP..?....L.U8y..|
+000002e0  79 bc 8d 74 26 f6 c8 11  3b 09 2a ac df 85 6e a5  |y..t&...;.*...n.|
+000002f0  68 14 03 03 00 01 01 16  03 03 00 40 00 00 00 00  |h..........@....|
+00000300  00 00 00 00 00 00 00 00  00 00 00 00 26 59 df 86  |............&Y..|
+00000310  ac 11 55 5e 42 84 d1 18  f0 f0 90 56 dd 52 e9 05  |..U^B......V.R..|
+00000320  8d bc c2 54 bc c2 bb 5f  7f 5c 87 bf 61 e2 cb 84  |...T..._.\..a...|
+00000330  03 5b 3b f4 fd af 10 c8  9a e6 f6 07              |.[;.........|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 78 7d ac 36 4d  |..........@x}.6M|
-00000010  d3 6b fa c6 79 99 50 ee  e3 10 28 ce a7 0e 37 5f  |.k..y.P...(...7_|
-00000020  76 bb 2d 31 91 48 90 23  e2 5b 5d 62 d1 13 a4 1c  |v.-1.H.#.[]b....|
-00000030  92 15 a2 6c 87 9f 47 db  b0 f6 91 25 47 74 24 ef  |...l..G....%Gt$.|
-00000040  0b 42 3c d0 79 e6 50 10  45 b0 5b                 |.B<.y.P.E.[|
+00000000  14 03 03 00 01 01 16 03  03 00 40 b6 0b 80 19 e9  |..........@.....|
+00000010  95 a5 fe c1 f8 77 58 73  56 05 ce 3c d5 b9 69 9f  |.....wXsV..<..i.|
+00000020  10 de 6c de 0c 69 36 1d  d8 4e 77 a3 e8 4b d7 70  |..l..i6..Nw..K.p|
+00000030  8f a7 aa 98 7d 33 90 59  1f ef f4 f4 b0 3e 36 16  |....}3.Y.....>6.|
+00000040  b4 93 69 7c f5 96 c1 0c  cd 68 77                 |..i|.....hw|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 61 a5 a5  a5 58 ca 4b 7a 1e e8 cc  |.....a...X.Kz...|
-00000020  77 ac 01 95 d6 4f 8f 9c  83 cf cf 2a 67 3d 02 1e  |w....O.....*g=..|
-00000030  67 b5 81 db 23 15 03 03  00 30 00 00 00 00 00 00  |g...#....0......|
-00000040  00 00 00 00 00 00 00 00  00 00 ea 7b 51 4f ae cf  |...........{QO..|
-00000050  70 9d 62 db 5e 99 a2 31  1f 41 fa 0c a2 c6 87 0c  |p.b.^..1.A......|
-00000060  a7 ed e7 21 94 34 e1 66  fd b9                    |...!.4.f..|
+00000010  00 00 00 00 00 ec 69 a8  8d a5 6a 42 d0 fb d0 74  |......i...jB...t|
+00000020  0d 47 d5 ca 6a 31 50 bd  b4 59 94 9e b0 ef d5 65  |.G..j1P..Y.....e|
+00000030  84 b2 fc 5c fe 15 03 03  00 30 00 00 00 00 00 00  |...\.....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 37 de 04 77 46 60  |..........7..wF`|
+00000050  0a 04 6e d9 50 a9 d3 35  36 e5 77 9a fd 58 25 96  |..n.P..56.w..X%.|
+00000060  04 cc 99 88 7f ff c7 df  34 5d                    |........4]|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA
index ad3760f45b..3e39677018 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 36 00 05 00 05  01 00 00 00 00 00 0a 00  |...6............|
-00000060  08 00 06 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
-00000070  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
-00000080  03 ff 01 00 01 00 00 12  00 00                    |..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 51 02 00 00  4d 03 03 9c bd 81 7b 20  |....Q...M.....{ |
-00000010  24 33 0e 28 7c 02 ba db  93 c1 e8 f3 5f 1b 3e bf  |$3.(|......._.>.|
-00000020  41 83 eb e9 db a9 e2 4a  7b de 93 20 0d 11 f1 bb  |A......J{.. ....|
-00000030  0d 1b f2 2b c5 32 14 0e  54 c9 16 5f c9 96 d4 95  |...+.2..T.._....|
-00000040  f8 a7 12 37 57 29 bb b8  65 15 cd 7a 00 05 00 00  |...7W)..e..z....|
+00000000  16 03 03 00 51 02 00 00  4d 03 03 cd c3 57 e1 fc  |....Q...M....W..|
+00000010  74 7d c1 3e 26 f7 84 d1  47 10 b0 02 45 7a 79 bd  |t}.>&...G...Ezy.|
+00000020  7d 82 e4 70 39 94 1d 06  45 7a 22 20 9a 44 3c 7b  |}..p9...Ez" .D<{|
+00000030  fe 35 02 fb eb a2 14 2b  2e 26 14 04 e2 ea 8a d9  |.5.....+.&......|
+00000040  93 d3 50 be 29 45 13 05  39 54 ee ed 00 05 00 00  |..P.)E..9T......|
 00000050  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
 00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -99,25 +99,25 @@
 00000270  70 0f 08 83 48 e9 48 ef  6e 50 8b 05 7e e5 84 25  |p...H.H.nP..~..%|
 00000280  fa 55 c7 ae 31 02 27 00  ef 3f 98 86 20 12 89 91  |.U..1.'..?.. ...|
 00000290  59 28 b4 f7 d7 af d2 69  61 35 16 03 03 00 93 0f  |Y(.....ia5......|
-000002a0  00 00 8f 05 03 00 8b 30  81 88 02 42 01 81 f3 33  |.......0...B...3|
-000002b0  33 ca e1 04 e2 65 b9 26  79 86 d9 f6 16 25 ac a6  |3....e.&y....%..|
-000002c0  9d e8 4a bb 25 91 56 9e  57 6d 07 98 dd 1a fa b3  |..J.%.V.Wm......|
-000002d0  8f a9 46 dc 18 00 fc 1d  4f 38 36 18 77 b0 68 9e  |..F.....O86.w.h.|
-000002e0  a0 04 72 27 4e 75 95 0e  b8 94 4a 9f c0 06 02 42  |..r'Nu....J....B|
-000002f0  01 5b bc 75 9b 38 2f 5d  29 0c 5c fe bd 1c 98 a7  |.[.u.8/]).\.....|
-00000300  75 7a af 68 25 6b db ad  b9 9d d4 4f 49 00 1f cd  |uz.h%k.....OI...|
-00000310  4c 35 d9 c2 33 83 ba eb  7d f4 4a 7a f6 4d 9d 7c  |L5..3...}.Jz.M.||
-00000320  40 34 e9 8b 75 7f 83 0b  e6 ca c6 1f 3e af 58 9e  |@4..u.......>.X.|
-00000330  17 74 14 03 03 00 01 01  16 03 03 00 24 d2 bb 27  |.t..........$..'|
-00000340  fa a9 dd 14 f8 e2 5a 79  b6 9e 77 66 45 6a e5 d4  |......Zy..wfEj..|
-00000350  4d 59 e7 51 fa a4 25 09  ca 9a 89 72 38 6d 68 05  |MY.Q..%....r8mh.|
-00000360  34                                                |4|
+000002a0  00 00 8f 05 03 00 8b 30  81 88 02 42 01 82 0d cf  |.......0...B....|
+000002b0  87 7a 81 ab 4c 36 a9 3d  b0 5f 03 30 4f c8 7b 1c  |.z..L6.=._.0O.{.|
+000002c0  10 d3 8d 2b b0 62 f6 f8  4d b3 82 86 76 b9 51 3c  |...+.b..M...v.Q<|
+000002d0  d2 d4 de 5b 22 17 31 7a  52 b6 8a aa 44 47 cf 63  |...[".1zR...DG.c|
+000002e0  9c d0 38 57 81 9b 44 5c  97 5e bb 85 a6 4c 02 42  |..8W..D\.^...L.B|
+000002f0  01 ff 26 48 a8 37 85 a5  b7 97 8c c2 10 1e 09 cc  |..&H.7..........|
+00000300  0f 9b 93 8d ef dc b0 0d  87 fa 77 8d 72 9e 1e 24  |..........w.r..$|
+00000310  69 ea 85 4e 83 f1 3e 8f  c4 57 8d 10 b2 26 63 97  |i..N..>..W...&c.|
+00000320  63 10 ea ef fc e8 ef 38  27 a7 b2 a9 ac c0 bb 37  |c......8'......7|
+00000330  bc bd 14 03 03 00 01 01  16 03 03 00 24 78 d8 56  |............$x.V|
+00000340  f6 78 ea 0a 29 8c 48 7c  9b 3a 79 05 2f c1 70 0d  |.x..).H|.:y./.p.|
+00000350  c4 16 2f 70 7c 1a 08 f4  37 03 44 4f e4 6d 90 d6  |../p|...7.DO.m..|
+00000360  6c                                                |l|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 24 c7 4b ed 21 0c  |..........$.K.!.|
-00000010  60 57 15 a0 e3 67 ab 84  83 05 49 ac 56 36 1d c7  |`W...g....I.V6..|
-00000020  de 0c 78 77 1b f9 2d 47  91 43 c8 1e 82 25 90     |..xw..-G.C...%.|
+00000000  14 03 03 00 01 01 16 03  03 00 24 ef 41 03 0c ee  |..........$.A...|
+00000010  86 32 06 48 fa 45 ad 13  65 01 2c c2 91 7a d9 9b  |.2.H.E..e.,..z..|
+00000020  4b 00 8d f0 dd 28 e4 9b  38 47 89 c0 56 7f 07     |K....(..8G..V..|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1a f1 9c 2e  ba 22 8c 25 5b 5b 04 88  |.........".%[[..|
-00000010  0c 1a a2 70 62 ac bf 40  dd b1 89 15 25 5a 6b 15  |...pb..@....%Zk.|
-00000020  03 03 00 16 31 21 30 b3  c7 d3 c6 f7 88 14 74 12  |....1!0.......t.|
-00000030  b8 47 8b 71 74 39 ab c9  df 40                    |.G.qt9...@|
+00000000  17 03 03 00 1a 0e bf 71  d4 f1 32 2f b6 55 f8 2a  |.......q..2/.U.*|
+00000010  ab 41 57 7e 08 0e 13 f7  2b 13 87 61 61 59 3d 15  |.AW~....+..aaY=.|
+00000020  03 03 00 16 57 04 50 52  d9 41 4a 6b c6 e7 ec 4a  |....W.PR.AJk...J|
+00000030  57 13 07 e7 24 42 67 7a  d1 15                    |W...$Bgz..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384 b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384
index c6d1b07eb2..b0b4ce7343 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 36 00 05 00 05  01 00 00 00 00 00 0a 00  |...6............|
-00000060  08 00 06 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
-00000070  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
-00000080  03 ff 01 00 01 00 00 12  00 00                    |..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 cb de 9e ad d8  |....Y...U.......|
-00000010  34 22 04 47 9c 97 76 9e  b9 a5 1c c5 e1 04 6c 51  |4".G..v.......lQ|
-00000020  30 d2 fd 3a 44 38 63 f8  68 95 ab 20 cd f4 98 4e  |0..:D8c.h.. ...N|
-00000030  d4 6f ec 4a ac 8a af 08  c0 f0 d7 86 c0 d0 73 b8  |.o.J..........s.|
-00000040  71 9a 16 13 14 76 99 72  fd a3 79 e3 c0 30 00 00  |q....v.r..y..0..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 ba 20 14 8a 34  |....Y...U... ..4|
+00000010  98 f2 4d 9a 06 b2 35 92  b7 e9 d5 fb d1 8a 1d 8d  |..M...5.........|
+00000020  b7 91 ad 20 0f ca 9a 45  43 9a 38 20 2c fa 25 ba  |... ...EC.8 ,.%.|
+00000030  5c 8a fb 04 d2 cd 17 8b  ec 28 dc 03 fb aa 3b 68  |\........(....;h|
+00000040  47 7e 58 00 42 8f f7 cb  8a 59 b1 cd c0 30 00 00  |G~X.B....Y...0..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,19 +53,19 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  cd 0c 00 00 c9 03 00 17  41 04 43 05 d2 20 ca 1d  |........A.C.. ..|
-000002d0  7b 48 0d 20 0d 0a 47 82  cf 3c 64 d4 82 bb a4 90  |{H. ..G..<d.....|
-000002e0  4b 06 1c a1 40 3a 52 02  9f a8 b8 21 b4 a6 18 fe  |K...@:R....!....|
-000002f0  90 2a 51 bd 0b be e5 e9  9d f4 f5 17 e3 3f ca 42  |.*Q..........?.B|
-00000300  e8 83 95 4c 06 21 37 6a  c0 db 04 01 00 80 03 b4  |...L.!7j........|
-00000310  04 8a bd 88 f2 0f ed 88  23 52 1a 3b 53 62 4a a8  |........#R.;SbJ.|
-00000320  ec a0 4d 89 12 d5 b3 96  14 ce 2c a0 f6 c1 b2 13  |..M.......,.....|
-00000330  a4 b2 06 df 3d 7f 28 40  00 51 43 c0 a2 e8 db 4f  |....=.(@.QC....O|
-00000340  37 ba 00 25 e4 4f 6b 3a  95 bd 98 3e 7c 81 40 1d  |7..%.Ok:...>|.@.|
-00000350  39 9c 9f 9e 5c 0d 1b 5e  a5 86 98 11 2f db 0b e5  |9...\..^..../...|
-00000360  15 6a 47 eb e7 be cf d0  00 26 54 a8 c8 e0 2e 72  |.jG......&T....r|
-00000370  85 76 6a 67 d8 ab f1 ed  a1 72 31 d8 f9 82 02 86  |.vjg.....r1.....|
-00000380  46 a3 1b 47 05 d9 09 83  ca 91 8c bf 20 a6 16 03  |F..G........ ...|
+000002c0  cd 0c 00 00 c9 03 00 17  41 04 f7 51 f2 ad 65 4f  |........A..Q..eO|
+000002d0  d9 df 8a 05 85 e9 6c d9  f9 14 51 e1 9a e0 11 80  |......l...Q.....|
+000002e0  73 8a 3f 43 01 6b a1 c9  92 5c 12 12 32 a1 e9 75  |s.?C.k...\..2..u|
+000002f0  d3 4f 0b b6 f9 b8 5b 4e  cc 71 8e cd 9c cc 7a 6e  |.O....[N.q....zn|
+00000300  0e 46 32 2d 84 6f 58 47  2f 24 04 01 00 80 08 0e  |.F2-.oXG/$......|
+00000310  2e 23 03 fe 7e 0f e1 3c  9b 37 d8 6b 86 6a 02 42  |.#..~..<.7.k.j.B|
+00000320  e7 c2 85 90 4f f9 22 b5  5b 98 9a 05 8c 7f 8f 83  |....O.".[.......|
+00000330  db a7 a2 98 18 d0 17 6b  14 17 39 fd 49 16 a9 f4  |.......k..9.I...|
+00000340  e0 5a f2 a1 1f 5a 6c ae  2b 0d 01 40 03 e8 75 c1  |.Z...Zl.+..@..u.|
+00000350  c6 f6 1b b2 c6 d3 ea 2d  f7 bb 94 ec a0 8c d1 26  |.......-.......&|
+00000360  52 22 d2 06 72 08 51 67  17 a2 ef 6d 75 a5 35 68  |R"..r.Qg...mu.5h|
+00000370  ab 2d 27 b2 f1 77 e7 87  9f 40 64 26 e0 bd 8c d6  |.-'..w...@d&....|
+00000380  f3 2d 9f 07 cd d0 6f 42  9f d8 85 55 2c 45 16 03  |.-....oB...U,E..|
 00000390  03 00 2e 0d 00 00 26 03  01 02 40 00 1e 06 01 06  |......&...@.....|
 000003a0  02 06 03 05 01 05 02 05  03 04 01 04 02 04 03 03  |................|
 000003b0  01 03 02 03 03 02 01 02  02 02 03 00 00 0e 00 00  |................|
@@ -108,26 +108,26 @@
 00000220  67 fd a7 24 20 3e b2 56  1c ce 97 28 5e f8 2b 2d  |g..$ >.V...(^.+-|
 00000230  4f 9e f1 07 9f 6c 4b 5b  83 56 e2 32 42 e9 58 b6  |O....lK[.V.2B.X.|
 00000240  d7 49 a6 b5 68 1a 41 03  56 6b dc 5a 89 16 03 03  |.I..h.A.Vk.Z....|
-00000250  00 88 0f 00 00 84 05 01  00 80 55 11 4d e9 c6 34  |..........U.M..4|
-00000260  0f bb 7a 9c 72 91 52 56  fb 68 d3 31 10 a7 79 96  |..z.r.RV.h.1..y.|
-00000270  e3 78 6a d9 83 05 b6 65  b7 39 0b 4f b2 cf c0 ec  |.xj....e.9.O....|
-00000280  fb d8 d6 22 f9 7d 11 a6  be bd 05 69 99 6a f7 0b  |...".}.....i.j..|
-00000290  f6 29 1c 96 ff 3c e1 02  53 ab 88 06 d6 51 c4 11  |.)...<..S....Q..|
-000002a0  a8 36 37 71 79 16 8b 99  03 81 9c f7 c3 60 58 a7  |.67qy........`X.|
-000002b0  e1 89 65 0c a7 30 eb a5  33 a7 53 76 ec 71 96 9d  |..e..0..3.Sv.q..|
-000002c0  a5 0a 79 84 7f 36 1d e6  94 8e b1 e0 90 35 5f 90  |..y..6.......5_.|
-000002d0  9e 66 da df 69 18 56 67  34 d0 14 03 03 00 01 01  |.f..i.Vg4.......|
-000002e0  16 03 03 00 28 00 00 00  00 00 00 00 00 28 1b 73  |....(........(.s|
-000002f0  20 e4 d7 f4 73 98 9a 1c  e9 2c 6a 1a e4 2f 93 c9  | ...s....,j../..|
-00000300  99 f8 9f aa 93 91 23 07  74 fb 8d f6 d9           |......#.t....|
+00000250  00 88 0f 00 00 84 05 01  00 80 b5 63 8c 65 5c ff  |...........c.e\.|
+00000260  3a 36 74 2a d4 d4 4c 02  1a 11 9e e7 84 78 46 96  |:6t*..L......xF.|
+00000270  e9 b3 f8 ab 8a 27 ca 0c  de d4 83 a7 21 8f ab c2  |.....'......!...|
+00000280  ac bc c4 73 33 e6 b2 97  3f 35 02 93 ad a0 6d a1  |...s3...?5....m.|
+00000290  67 b3 ac aa a3 9d 24 29  01 af a9 e1 00 f6 66 c4  |g.....$)......f.|
+000002a0  8f 48 fc 68 d3 cd 18 63  9e f6 e1 e0 02 56 cc c5  |.H.h...c.....V..|
+000002b0  01 98 65 5d 41 f2 74 f7  00 42 af 26 45 2a 28 9f  |..e]A.t..B.&E*(.|
+000002c0  1c a6 49 66 d5 ea cb 2d  5b f7 e2 91 b6 f7 65 98  |..If...-[.....e.|
+000002d0  e2 2f 69 51 6b df 3d 45  b9 f1 14 03 03 00 01 01  |./iQk.=E........|
+000002e0  16 03 03 00 28 00 00 00  00 00 00 00 00 65 8f e7  |....(........e..|
+000002f0  e0 92 d7 90 38 81 fc 93  2d 8a 56 23 c9 90 cc f1  |....8...-.V#....|
+00000300  10 e7 e9 8e cc 59 64 a2  93 69 65 38 b1           |.....Yd..ie8.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 a6 b0 1a 9a d1  |..........(.....|
-00000010  bd 3c 2b d3 14 e5 5c 7c  7f 3e 80 c6 11 71 d8 86  |.<+...\|.>...q..|
-00000020  25 fc 59 61 b4 24 41 70  21 d6 2a 46 ea ea c1 2e  |%.Ya.$Ap!.*F....|
-00000030  28 0d 9c                                          |(..|
+00000000  14 03 03 00 01 01 16 03  03 00 28 f7 b7 8e 00 9e  |..........(.....|
+00000010  d6 c6 06 23 ad 91 c6 48  84 e6 ee ce 1e ec 2f e0  |...#...H....../.|
+00000020  b9 0b 8b 3c 4a 65 1a 9d  86 73 1c 2a ee a6 6e 09  |...<Je...s.*..n.|
+00000030  98 7f 1a                                          |...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 64 73 67  |.............dsg|
-00000010  09 f0 da 89 b0 af bc 41  84 6a a5 78 34 e8 82 d2  |.......A.j.x4...|
-00000020  94 61 78 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.ax.............|
-00000030  37 d6 41 90 45 09 e3 b3  51 cb 9e 98 98 f5 de f1  |7.A.E...Q.......|
-00000040  61 1a                                             |a.|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 ca f7 d5  |................|
+00000010  b0 c0 2d 8d 95 c6 9e 1c  ca 74 17 d5 47 16 53 16  |..-......t..G.S.|
+00000020  7d 19 85 15 03 03 00 1a  00 00 00 00 00 00 00 02  |}...............|
+00000030  cf f6 67 3a 65 15 d6 b0  e2 5a b9 71 cc 19 cd fa  |..g:e....Z.q....|
+00000040  3c af                                             |<.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA
index a99b44e86f..dc325fc927 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 36 00 05 00 05  01 00 00 00 00 00 0a 00  |...6............|
-00000060  08 00 06 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
-00000070  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
-00000080  03 ff 01 00 01 00 00 12  00 00                    |..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 99 c8 37 1a 6f  |....Y...U....7.o|
-00000010  c8 e2 cc a8 b5 1d 84 f5  93 58 ad 46 0a e6 60 f1  |.........X.F..`.|
-00000020  e4 e0 b4 b4 bb d1 30 58  ff 19 49 20 d7 42 c8 0e  |......0X..I .B..|
-00000030  fe 36 01 8e 0d 16 c2 ad  cb 6c cc 48 92 92 db 18  |.6.......l.H....|
-00000040  7b df 24 bc 39 ca 45 9a  05 ad 00 4b c0 09 00 00  |{.$.9.E....K....|
+00000000  16 03 03 00 59 02 00 00  55 03 03 1f be bf a9 e9  |....Y...U.......|
+00000010  1f 9e 3c 62 61 f4 0b b4  7e 08 85 e7 20 0a 1f c2  |..<ba...~... ...|
+00000020  50 e0 7d 3e 87 83 2e f6  b5 3b 01 20 a3 ae 72 07  |P.}>.....;. ..r.|
+00000030  49 15 58 81 fe d4 5c b9  df 88 68 d0 54 3c ae bd  |I.X...\...h.T<..|
+00000040  19 5b ae 30 d2 53 56 67  ef 05 71 69 c0 09 00 00  |.[.0.SVg..qi....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,20 +48,20 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 d7 0c 00  00 d3 03 00 17 41 04 72  |*............A.r|
-00000280  6c 04 6f 1c 07 08 23 a7  3b ca 68 46 9d f4 ac e1  |l.o...#.;.hF....|
-00000290  6d 76 62 04 45 d9 f7 f0  f4 9e 1c 76 51 98 a9 8d  |mvb.E......vQ...|
-000002a0  4f 54 bd 15 25 1e a9 07  76 c8 e3 31 1b 88 59 3b  |OT..%...v..1..Y;|
-000002b0  1f 36 7c cf 48 5d ba 9f  35 c8 92 a7 41 ed 89 04  |.6|.H]..5...A...|
-000002c0  03 00 8a 30 81 87 02 41  31 bc 40 4d 6c 1b 93 b2  |...0...A1.@Ml...|
-000002d0  d8 95 16 9c 3a 63 f0 5c  e4 20 7e fb d2 01 1b 23  |....:c.\. ~....#|
-000002e0  bc 8e bc 4b 6d a0 21 3a  62 e4 52 66 bf b4 94 45  |...Km.!:b.Rf...E|
-000002f0  a2 7f 21 31 f5 ef 50 13  2c 93 25 c4 61 ae 05 10  |..!1..P.,.%.a...|
-00000300  b7 5d e3 bf 7c 99 e3 39  41 02 42 01 b0 cf 42 cd  |.]..|..9A.B...B.|
-00000310  88 c7 55 93 2f 81 a4 05  bd 5d 0c c8 fd a5 20 18  |..U./....].... .|
-00000320  45 e2 f5 3f a6 5c 01 45  01 a2 21 14 5d 36 48 34  |E..?.\.E..!.]6H4|
-00000330  e1 20 da fc da a2 35 37  fc a7 6e f8 12 5e a2 ed  |. ....57..n..^..|
-00000340  6c c7 ac a7 48 bc 0e 51  0e e9 b7 7f 35 16 03 03  |l...H..Q....5...|
+00000270  2a 16 03 03 00 d7 0c 00  00 d3 03 00 17 41 04 85  |*............A..|
+00000280  5d 2e 2a 16 9e b3 a4 69  17 f5 13 ce 32 8f 67 37  |].*....i....2.g7|
+00000290  74 ab cf e2 69 80 fb 71  15 08 df f4 18 f3 76 36  |t...i..q......v6|
+000002a0  1a 06 aa 6e 3d de c0 71  05 65 6f 4b 05 86 93 fe  |...n=..q.eoK....|
+000002b0  34 82 59 77 2f 5b c6 4c  63 8b 6f 7f 60 d6 ba 04  |4.Yw/[.Lc.o.`...|
+000002c0  03 00 8a 30 81 87 02 42  01 37 25 e6 ad 0a 35 db  |...0...B.7%...5.|
+000002d0  e6 76 90 15 ed 10 66 7f  19 9d e5 59 31 89 d7 be  |.v....f....Y1...|
+000002e0  b2 e2 18 f2 42 30 98 86  2f ef 23 a4 70 79 51 97  |....B0../.#.pyQ.|
+000002f0  98 ac 6e 31 4e e8 e4 b3  d8 22 cc 32 46 1d e1 d2  |..n1N....".2F...|
+00000300  77 cb dd b5 c6 03 b6 52  ac 66 02 41 37 c2 d8 75  |w......R.f.A7..u|
+00000310  75 18 22 97 03 67 86 04  18 e4 29 96 ba 29 92 85  |u."..g....)..)..|
+00000320  a0 55 72 12 f4 bb 70 b5  3a 62 2d 0c f6 cf 92 15  |.Ur...p.:b-.....|
+00000330  4f 31 11 75 f9 81 b6 a3  ff dc 9c e3 be 26 8c 2f  |O1.u.........&./|
+00000340  fc 5d ef e2 b9 e5 0e 93  eb 95 f6 5f 22 16 03 03  |.]........._"...|
 00000350  00 2e 0d 00 00 26 03 01  02 40 00 1e 06 01 06 02  |.....&...@......|
 00000360  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
 00000370  03 02 03 03 02 01 02 02  02 03 00 00 0e 00 00 00  |................|
@@ -103,31 +103,31 @@
 00000220  67 fd a7 24 20 3e b2 56  1c ce 97 28 5e f8 2b 2d  |g..$ >.V...(^.+-|
 00000230  4f 9e f1 07 9f 6c 4b 5b  83 56 e2 32 42 e9 58 b6  |O....lK[.V.2B.X.|
 00000240  d7 49 a6 b5 68 1a 41 03  56 6b dc 5a 89 16 03 03  |.I..h.A.Vk.Z....|
-00000250  00 88 0f 00 00 84 05 01  00 80 6a 47 26 9b 8b 83  |..........jG&...|
-00000260  e9 ac 99 b7 59 5a c4 a3  28 97 ea 8b 40 dc 41 10  |....YZ..(...@.A.|
-00000270  e5 57 cb 1c 95 c4 86 96  8b db 3a 5e d6 6c 5d 80  |.W........:^.l].|
-00000280  eb 32 7b c3 53 17 de 75  60 39 dc 92 e5 8a d7 1b  |.2{.S..u`9......|
-00000290  7f 8e 07 d5 5f ee f6 43  0c f5 95 61 6c 58 55 f1  |...._..C...alXU.|
-000002a0  86 9d 91 91 af 81 28 7a  a3 9a ca 40 31 90 67 3b  |......(z...@1.g;|
-000002b0  0a 14 8a 1c e1 cd 15 6f  84 a6 7d 47 1e 61 8f 38  |.......o..}G.a.8|
-000002c0  3a c2 bc e7 af b8 50 87  c6 1b 78 aa 1b d6 e1 94  |:.....P...x.....|
-000002d0  ce ad 9f e3 03 4c ae e6  ac 29 14 03 03 00 01 01  |.....L...)......|
+00000250  00 88 0f 00 00 84 05 01  00 80 5e 85 82 65 fe 5d  |..........^..e.]|
+00000260  e7 61 47 f0 64 2e 7a 35  0d 7b 8b bd ce 39 56 ee  |.aG.d.z5.{...9V.|
+00000270  f0 1d 1c 0c 40 6c ed 06  69 b1 29 71 20 36 ca 79  |....@l..i.)q 6.y|
+00000280  ca b2 74 92 f3 fc c6 b7  f9 5f d0 22 dc 17 d1 25  |..t......_."...%|
+00000290  4a c2 9f 9d 62 92 1b e3  34 8c 1e f8 85 8a 3b 58  |J...b...4.....;X|
+000002a0  f0 0a a0 31 05 a0 a7 a1  44 a6 8b 9b d9 72 38 16  |...1....D....r8.|
+000002b0  33 c1 66 f2 6a 0c 9c 65  8b 1a 09 91 9b 72 ad 4d  |3.f.j..e.....r.M|
+000002c0  98 37 a7 54 54 f2 0c 7b  95 92 5d 11 94 59 6c 29  |.7.TT..{..]..Yl)|
+000002d0  e7 4e 5e 46 69 35 43 b8  16 02 14 03 03 00 01 01  |.N^Fi5C.........|
 000002e0  16 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-000002f0  00 00 00 00 00 df a6 96  c2 af 11 9b 19 aa 85 39  |...............9|
-00000300  d7 08 db 5a 04 79 21 8d  63 54 98 40 ac 0e 53 ce  |...Z.y!.cT.@..S.|
-00000310  fa 39 75 a7 05 f4 75 75  cd ef 01 46 94 a3 a0 5d  |.9u...uu...F...]|
-00000320  01 41 66 7c 12                                    |.Af|.|
+000002f0  00 00 00 00 00 a9 87 01  27 8d 4b 5b b9 13 17 50  |........'.K[...P|
+00000300  62 f3 16 e3 84 3e 38 3e  dc fe 7d 1d de a7 29 73  |b....>8>..}...)s|
+00000310  3e dc e8 03 65 c9 08 96  50 05 df 15 5f 1f bb f0  |>...e...P..._...|
+00000320  77 cf a2 9e e8                                    |w....|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 d0 d9 13 15 f1  |..........@.....|
-00000010  5a d0 64 d5 7b dd 0d f2  11 74 7e f2 c5 fa c8 45  |Z.d.{....t~....E|
-00000020  ca 2f 90 db ab a2 2b 9e  6f d2 6c ec eb d8 8c f2  |./....+.o.l.....|
-00000030  91 89 48 09 ae 8b d2 92  97 8b 75 df a1 2d 42 fb  |..H.......u..-B.|
-00000040  6b 97 5d bb 1a af f0 d3  6a 51 41                 |k.].....jQA|
+00000000  14 03 03 00 01 01 16 03  03 00 40 04 00 1e 59 5c  |..........@...Y\|
+00000010  df 15 6d 6a 44 99 3d b5  28 f2 86 7c 93 a3 20 ec  |..mjD.=.(..|.. .|
+00000020  fc 1c 7c 16 9c 33 fb a5  20 f7 2f 76 81 6d 75 e6  |..|..3.. ./v.mu.|
+00000030  4b 60 5b 9c 8b 6e a7 33  a6 7f ff c5 8b 2e c3 30  |K`[..n.3.......0|
+00000040  a6 60 91 f7 41 b2 5f de  14 b7 01                 |.`..A._....|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 0c a8 43  70 49 c0 a5 f9 c4 3e 21  |.......CpI....>!|
-00000020  7e 20 c8 68 68 52 9c 57  ff 4b fd 54 32 3f c3 41  |~ .hhR.W.K.T2?.A|
-00000030  31 cf 4d d4 4d 15 03 03  00 30 00 00 00 00 00 00  |1.M.M....0......|
-00000040  00 00 00 00 00 00 00 00  00 00 36 7b ec a1 91 77  |..........6{...w|
-00000050  16 aa f7 72 2a b9 61 1c  dd 96 83 db 3b ed 96 d6  |...r*.a.....;...|
-00000060  55 c1 a6 ad 39 3c 5b 63  3f da                    |U...9<[c?.|
+00000010  00 00 00 00 00 99 b2 5a  3e aa 44 e9 44 47 46 34  |.......Z>.D.DGF4|
+00000020  a4 b1 d3 48 9a 76 5f e8  d1 fc a4 08 37 d7 9e ab  |...H.v_.....7...|
+00000030  2b c9 a7 b5 db 15 03 03  00 30 00 00 00 00 00 00  |+........0......|
+00000040  00 00 00 00 00 00 00 00  00 00 db a8 98 c2 93 75  |...............u|
+00000050  1e 0c b0 2c b0 10 31 9b  cd 5a 4a f6 ad 65 64 a9  |...,..1..ZJ..ed.|
+00000060  fd 1d 7f ad 2e 57 d8 6d  4e 56                    |.....W.mNV|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA
index 55414d8b60..d49bd8d36e 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 36 00 05 00 05  01 00 00 00 00 00 0a 00  |...6............|
-00000060  08 00 06 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
-00000070  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
-00000080  03 ff 01 00 01 00 00 12  00 00                    |..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 51 02 00 00  4d 03 03 82 6c 4c a6 8d  |....Q...M...lL..|
-00000010  58 0a 99 13 9d fb 0a a9  a9 e8 25 65 b7 d1 75 63  |X.........%e..uc|
-00000020  29 57 e8 76 e4 9d a1 0a  1b 9a a0 20 3f 7b 1f 3c  |)W.v....... ?{.<|
-00000030  70 ab c5 87 81 ad 54 e2  fd 52 6f 95 64 f6 c6 5b  |p.....T..Ro.d..[|
-00000040  2f 25 2f 12 3b 40 97 43  48 cc f4 3c 00 05 00 00  |/%/.;@.CH..<....|
+00000000  16 03 03 00 51 02 00 00  4d 03 03 02 3f fc 95 c8  |....Q...M...?...|
+00000010  be 73 36 64 bd 28 09 c0  d2 f5 7f 1c a1 77 0d 88  |.s6d.(.......w..|
+00000020  04 2a 53 4c 1e ac 4b cc  f7 ad d1 20 e7 9e a6 08  |.*SL..K.... ....|
+00000030  de d5 9f 4c 02 73 f7 a2  2b b9 b7 64 6d 8a 9f 9d  |...L.s..+..dm...|
+00000040  e0 92 b8 9a dc b8 96 f8  aa 0d 63 23 00 05 00 00  |..........c#....|
 00000050  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
 00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -98,24 +98,24 @@
 00000260  f1 0f c5 70 0f 08 83 48  e9 48 ef 6e 50 8b 05 7e  |...p...H.H.nP..~|
 00000270  e5 84 25 fa 55 c7 ae 31  02 27 00 ef 3f 98 86 20  |..%.U..1.'..?.. |
 00000280  12 89 91 59 28 b4 f7 d7  af d2 69 61 35 16 03 03  |...Y(.....ia5...|
-00000290  00 88 0f 00 00 84 05 01  00 80 05 51 bf aa ea ad  |...........Q....|
-000002a0  8e a9 6f df 0b b7 0c 69  fc df f4 c3 59 4e 92 25  |..o....i....YN.%|
-000002b0  df 67 c9 81 d2 54 0a 6e  b4 da 6c c3 fa 4f 6e ab  |.g...T.n..l..On.|
-000002c0  5f 2a 70 28 51 9d 55 2b  c5 31 20 a8 90 b3 72 9d  |_*p(Q.U+.1 ...r.|
-000002d0  7f 97 70 36 3a 7e 52 e9  3c 47 a7 d0 84 37 53 a5  |..p6:~R.<G...7S.|
-000002e0  bd 05 c0 5a 10 58 f4 1b  3d 71 ae f4 b8 85 8c 9e  |...Z.X..=q......|
-000002f0  c3 86 28 3b b7 18 ad ae  d9 46 c7 d6 8e 03 44 ba  |..(;.....F....D.|
-00000300  6f e5 c7 15 50 21 d0 b0  7c 4b 46 0e 20 d4 55 6c  |o...P!..|KF. .Ul|
-00000310  41 93 8b 88 c1 a3 44 7a  a0 42 14 03 03 00 01 01  |A.....Dz.B......|
-00000320  16 03 03 00 24 74 1d 1f  99 0b 56 3f 16 83 db 8f  |....$t....V?....|
-00000330  e2 16 3b ae ba 62 c0 57  18 77 e3 56 48 b6 68 ff  |..;..b.W.w.VH.h.|
-00000340  37 43 a4 99 37 81 bc dc  b2                       |7C..7....|
+00000290  00 88 0f 00 00 84 05 01  00 80 86 56 71 68 09 a7  |...........Vqh..|
+000002a0  bc a6 f1 bd fa d5 e8 7d  f5 8f 4b 8a dd 19 9a 88  |.......}..K.....|
+000002b0  6f 4e 5d c1 a5 3c 03 b7  4d f4 30 74 ec b7 82 d9  |oN]..<..M.0t....|
+000002c0  b9 8a aa 2e b9 39 ab db  dc c9 c2 76 d7 fc 67 d8  |.....9.....v..g.|
+000002d0  3c 87 1c 53 f8 d0 28 b1  37 c4 49 c3 6d 73 b9 cc  |<..S..(.7.I.ms..|
+000002e0  81 2e 1b 22 05 5e 71 35  23 b9 94 c7 6a 80 a2 b6  |...".^q5#...j...|
+000002f0  8a eb f4 0e 51 e6 ff ac  ea eb 0c d8 e8 be 45 ab  |....Q.........E.|
+00000300  4f 0f 47 f1 d2 f4 70 ae  a3 16 79 26 82 32 af 7c  |O.G...p...y&.2.||
+00000310  8b 62 5e 15 b6 ab 07 74  6b 3d 14 03 03 00 01 01  |.b^....tk=......|
+00000320  16 03 03 00 24 6b 24 59  3c f0 3d 41 31 45 04 55  |....$k$Y<.=A1E.U|
+00000330  5f 26 14 dd a9 7a 29 02  c1 4a dd 65 84 4e a9 05  |_&...z)..J.e.N..|
+00000340  37 79 b1 ca 50 8e c6 df  6d                       |7y..P...m|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 24 05 24 3c 21 26  |..........$.$<!&|
-00000010  68 27 8e 93 6a d7 cb f6  a1 31 4c 4f 93 0f b4 7a  |h'..j....1LO...z|
-00000020  de 82 2d 80 ad d4 84 59  54 60 f4 70 3b 1d fb     |..-....YT`.p;..|
+00000000  14 03 03 00 01 01 16 03  03 00 24 ff c7 8f 75 44  |..........$...uD|
+00000010  f7 4c 9b 80 c1 c0 59 83  8c c8 fe 7b 21 86 83 d1  |.L....Y....{!...|
+00000020  09 08 48 b0 e9 f0 fe 2f  58 86 25 64 d3 3a a2     |..H..../X.%d.:.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1a c2 c1 b2  36 59 f8 c0 d7 38 e1 61  |........6Y...8.a|
-00000010  c4 96 c1 ea 87 a5 26 16  4d 21 fc 60 b8 c1 4d 15  |......&.M!.`..M.|
-00000020  03 03 00 16 da d4 fb b4  1e d3 3e e0 05 ea 11 c7  |..........>.....|
-00000030  53 34 5e e3 59 33 90 51  9d 9a                    |S4^.Y3.Q..|
+00000000  17 03 03 00 1a 31 4f 85  6d 9e 52 7d 90 67 4f 2c  |.....1O.m.R}.gO,|
+00000010  f1 dc 5e 6b 5d b9 f1 90  2b c1 61 38 5a 45 ed 15  |..^k]...+.a8ZE..|
+00000020  03 03 00 16 3b 54 3d ac  60 28 4b ca 09 f4 44 70  |....;T=.`(K...Dp|
+00000030  a9 0a 73 e4 c1 39 b6 77  57 17                    |..s..9.wW.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES
index 2f27885781..f07c99196e 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 36 00 05 00 05  01 00 00 00 00 00 0a 00  |...6............|
-00000060  08 00 06 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
-00000070  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
-00000080  03 ff 01 00 01 00 00 12  00 00                    |..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 5b 22 ee ec 51  |....Y...U..["..Q|
-00000010  c0 d3 6a 91 a2 0f 8f f4  80 f1 9c d0 77 88 7c 99  |..j.........w.|.|
-00000020  88 ea c9 dc 17 08 9c fb  3b 24 23 20 32 70 dd bd  |........;$# 2p..|
-00000030  39 5a aa 5d a8 52 7a 6f  c0 ea ec db ed 21 d3 f3  |9Z.].Rzo.....!..|
-00000040  c5 80 be 70 0d 02 cf 0c  5e ec ea c6 c0 09 00 00  |...p....^.......|
+00000000  16 03 03 00 59 02 00 00  55 03 03 41 1d e9 05 25  |....Y...U..A...%|
+00000010  04 59 e0 1d 29 92 e9 8c  b2 c1 ef 7c 07 54 ec e1  |.Y..)......|.T..|
+00000020  a0 03 e6 65 1d ca 7d 67  db 6a 92 20 06 fe fa 87  |...e..}g.j. ....|
+00000030  61 18 62 83 12 c5 f6 b8  7b a9 df 1d a9 e8 2c 74  |a.b.....{.....,t|
+00000040  36 6c f1 4b b6 b7 89 4c  43 e5 96 d6 c0 09 00 00  |6l.K...LC.......|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,20 +48,20 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 d8 0c 00  00 d4 03 00 17 41 04 6d  |*............A.m|
-00000280  3b 97 b1 5e 12 dd bb cc  94 c2 f3 3e 78 52 e1 c8  |;..^.......>xR..|
-00000290  35 b7 e3 2b 6b d9 b1 f2  6a 09 22 de 3d 09 a4 53  |5..+k...j.".=..S|
-000002a0  ee e6 38 af 11 4b 71 fb  f6 e4 fe 75 fc fc 32 eb  |..8..Kq....u..2.|
-000002b0  e3 83 5b 75 a5 fc 4a d3  4e 75 14 81 4a 9f d5 04  |..[u..J.Nu..J...|
-000002c0  03 00 8b 30 81 88 02 42  00 d1 48 44 bc 50 5b b7  |...0...B..HD.P[.|
-000002d0  f4 ed 83 d3 f9 65 1d 7c  4f 0d 0c 03 e6 fc 9a 15  |.....e.|O.......|
-000002e0  84 2d e7 3f 99 5f 26 23  59 5f 88 bd 33 69 1b cc  |.-.?._&#Y_..3i..|
-000002f0  f2 a7 1b 18 7f 9b 16 4f  22 16 90 7c cb cb 56 ac  |.......O"..|..V.|
-00000300  9d 93 6e e4 8e 08 42 05  ef 8f 02 42 01 02 2d 66  |..n...B....B..-f|
-00000310  6f 95 a3 0c 53 39 02 5b  ce bd f1 22 e8 b1 ac 02  |o...S9.[..."....|
-00000320  b0 89 5b 4d 46 5b ed a2  a9 c0 22 9b c0 c0 9a d5  |..[MF[....".....|
-00000330  0f 95 11 1f 30 bf e5 f1  1b bd 19 1c c2 a8 63 5b  |....0.........c[|
-00000340  86 20 99 60 c3 80 38 33  e2 32 96 ea 26 a4 16 03  |. .`..83.2..&...|
+00000270  2a 16 03 03 00 d8 0c 00  00 d4 03 00 17 41 04 9f  |*............A..|
+00000280  24 ca 28 33 09 dc 7a b0  f8 92 b4 aa a2 e6 1c 13  |$.(3..z.........|
+00000290  26 8f ee 24 a9 8f b1 52  b2 23 0f b8 a9 da d4 0c  |&..$...R.#......|
+000002a0  db c2 56 ce 5d 55 a2 79  fb a2 5a 4b db 55 ec 7b  |..V.]U.y..ZK.U.{|
+000002b0  ae 30 1d 60 29 c8 83 23  14 e0 20 26 58 3d 50 04  |.0.`)..#.. &X=P.|
+000002c0  03 00 8b 30 81 88 02 42  01 4e 56 50 b8 ce 9f c7  |...0...B.NVP....|
+000002d0  55 da ae 3e b9 80 57 41  e9 94 e2 69 92 cb 33 ba  |U..>..WA...i..3.|
+000002e0  53 95 92 6a 6b 30 94 f7  9c 4c 43 3e a6 35 c4 a0  |S..jk0...LC>.5..|
+000002f0  3d 7b 6b 0e f3 ce b5 d7  f9 b6 fe fe e7 d8 69 aa  |={k...........i.|
+00000300  b8 50 f7 76 ba 75 53 a2  d7 4c 02 42 01 06 0a bf  |.P.v.uS..L.B....|
+00000310  0c 02 ab 60 25 62 d5 27  95 69 16 b6 b5 6f b6 9b  |...`%b.'.i...o..|
+00000320  0f 88 81 e6 42 30 d3 0c  e9 68 05 ac 56 7c 36 0a  |....B0...h..V|6.|
+00000330  91 c6 a5 61 14 6e ad 64  28 90 08 a3 8e 52 21 b3  |...a.n.d(....R!.|
+00000340  90 e4 30 44 ca 91 f2 73  98 4c 41 5c 7b bf 16 03  |..0D...s.LA\{...|
 00000350  03 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
@@ -70,21 +70,21 @@
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
 00000050  01 16 03 03 00 40 00 00  00 00 00 00 00 00 00 00  |.....@..........|
-00000060  00 00 00 00 00 00 0b d9  15 a7 d8 15 3f dc a4 f1  |............?...|
-00000070  16 b7 c4 c2 72 bd e4 32  fd 4a 37 20 f2 8a 03 d4  |....r..2.J7 ....|
-00000080  30 fe f7 d1 a2 49 dc 70  b8 b2 71 12 b0 07 b0 e4  |0....I.p..q.....|
-00000090  f8 ec 84 6b 8b 19                                 |...k..|
+00000060  00 00 00 00 00 00 6c 78  6a 44 a0 10 37 89 5a a3  |......lxjD..7.Z.|
+00000070  12 e8 1f 26 75 da 3d 4f  d5 24 d7 4e 63 4e f3 c9  |...&u.=O.$.NcN..|
+00000080  76 d8 80 5f 95 3f 5f cc  29 11 6f f1 ce 32 71 21  |v.._.?_.).o..2q!|
+00000090  00 f0 54 cc da 58                                 |..T..X|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 af fc e3 71 69  |..........@...qi|
-00000010  53 92 6c db 65 5f b6 a0  1e 37 f3 f6 17 60 9c c8  |S.l.e_...7...`..|
-00000020  a4 02 ae ac bb 98 66 e5  15 fb 5b 0e 59 f9 29 36  |......f...[.Y.)6|
-00000030  c7 45 05 23 d0 3f fb f8  ee 7b 6a 3a 7f 77 ed d1  |.E.#.?...{j:.w..|
-00000040  02 f6 f5 c5 cd d8 15 a4  7a 24 cd                 |........z$.|
+00000000  14 03 03 00 01 01 16 03  03 00 40 80 be 96 3b cb  |..........@...;.|
+00000010  b0 20 6b b8 b3 31 da 13  76 22 a0 ba f2 33 8e 8a  |. k..1..v"...3..|
+00000020  25 52 9f 83 3b 49 8f e5  2b 4e bf c0 8a 62 50 c2  |%R..;I..+N...bP.|
+00000030  af e0 db 67 4e 26 2b bd  a3 4f ed ff ea 7b 16 ce  |...gN&+..O...{..|
+00000040  35 63 81 30 ac a5 9c e0  ec 01 6f                 |5c.0......o|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 d9 d2 27  be 26 cd 7b d5 11 5e 56  |.......'.&.{..^V|
-00000020  96 3e f6 07 8a 71 2d 78  ac 66 d3 55 72 3e 28 61  |.>...q-x.f.Ur>(a|
-00000030  9a 07 96 97 a3 15 03 03  00 30 00 00 00 00 00 00  |.........0......|
-00000040  00 00 00 00 00 00 00 00  00 00 4c 94 79 c1 09 13  |..........L.y...|
-00000050  19 a5 25 a8 97 84 b7 94  e6 f6 04 2f 5a cc 4b 4c  |..%......../Z.KL|
-00000060  98 44 c9 91 7d 11 6d 4d  92 47                    |.D..}.mM.G|
+00000010  00 00 00 00 00 92 85 85  8b f1 c7 07 32 b2 4c 5f  |............2.L_|
+00000020  c1 6b 7a fc 39 8a d3 65  cc f8 1a 42 4f b3 87 b9  |.kz.9..e...BO...|
+00000030  0a da 28 fc cc 15 03 03  00 30 00 00 00 00 00 00  |..(......0......|
+00000040  00 00 00 00 00 00 00 00  00 00 ca 4e b0 4d 6b 66  |...........N.Mkf|
+00000050  8d bf 9b 98 69 03 7b ec  c5 e2 74 71 90 34 51 2c  |....i.{...tq.4Q,|
+00000060  16 bf 67 0d 13 6b 2b be  ee 09                    |..g..k+...|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM
index afec210b0d..cd60846f93 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 36 00 05 00 05  01 00 00 00 00 00 0a 00  |...6............|
-00000060  08 00 06 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
-00000070  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
-00000080  03 ff 01 00 01 00 00 12  00 00                    |..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 b4 45 73 95 81  |....Y...U...Es..|
-00000010  89 ac ac 13 e5 72 ec ef  09 e0 34 5b 20 70 ea a8  |.....r....4[ p..|
-00000020  71 e7 4f 76 4c 0f 1e f5  a2 cb cb 20 81 75 d2 6a  |q.OvL...... .u.j|
-00000030  e2 b7 d2 22 22 2a 09 8b  01 53 d2 25 30 64 7e 02  |...""*...S.%0d~.|
-00000040  63 3c 77 f0 d9 42 4b 8e  dc 81 2a 3a c0 2b 00 00  |c<w..BK...*:.+..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 59 35 ef 8a 48  |....Y...U..Y5..H|
+00000010  01 4f 2a f1 c8 1d fc 9b  fa 1e 00 05 ef 89 1c 72  |.O*............r|
+00000020  26 b0 1b 99 41 66 7c cf  cc 25 d3 20 3d ec a7 3e  |&...Af|..%. =..>|
+00000030  40 a3 3d b4 a4 87 ef ff  6e 3a b4 c9 7e 35 38 2c  |@.=.....n:..~58,|
+00000040  e2 b8 4d e3 f7 68 98 7a  f9 bd 02 69 c0 2b 00 00  |..M..h.z...i.+..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,38 +48,38 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 d8 0c 00  00 d4 03 00 17 41 04 a4  |*............A..|
-00000280  2f 56 be b7 78 2d 75 19  98 58 b3 2f be 5c d5 db  |/V..x-u..X./.\..|
-00000290  60 ce b1 e8 fe 59 76 f2  ac ed 8e f8 9d a3 87 5a  |`....Yv........Z|
-000002a0  22 78 31 1e 90 ca 64 be  77 c7 c0 06 d2 a6 ed 08  |"x1...d.w.......|
-000002b0  2a 37 cd c1 fe ce 34 5d  23 1e 8d df e1 9d bc 04  |*7....4]#.......|
-000002c0  03 00 8b 30 81 88 02 42  01 cd cd 3b 33 72 6d 6a  |...0...B...;3rmj|
-000002d0  fc 20 28 18 ae a0 dd 25  9d 16 14 a3 87 45 63 d5  |. (....%.....Ec.|
-000002e0  48 d8 24 2b ea c7 51 c9  3b d1 68 df c6 dc c8 0b  |H.$+..Q.;.h.....|
-000002f0  cd 80 06 1e 06 68 f7 c9  a7 ad e4 44 0b 1a 1b 8d  |.....h.....D....|
-00000300  fe e2 e9 c1 65 f4 f5 fc  8d 5f 02 42 01 78 ac 1e  |....e...._.B.x..|
-00000310  2a cd 55 0d 48 8a ee 1b  96 0c 49 e0 41 76 22 6a  |*.U.H.....I.Av"j|
-00000320  df 98 48 b1 c9 e3 90 d6  9b 57 8b 74 0d 7a 9f 7b  |..H......W.t.z.{|
-00000330  55 8d bb ec 3d 5d 6b 96  6b e1 ee a1 fe dd 63 43  |U...=]k.k.....cC|
-00000340  a3 78 ed 2d af 98 55 d2  91 64 0b 75 83 f0 16 03  |.x.-..U..d.u....|
-00000350  03 00 04 0e 00 00 00                              |.......|
+00000270  2a 16 03 03 00 d7 0c 00  00 d3 03 00 17 41 04 20  |*............A. |
+00000280  47 59 b8 c8 24 46 f5 8f  e7 d3 97 cd 8a 38 e9 6c  |GY..$F.......8.l|
+00000290  b1 4e e9 61 af 8f ca bd  21 de e5 06 44 9d 92 6f  |.N.a....!...D..o|
+000002a0  62 54 c2 c4 68 53 44 66  3f af 68 62 3a 10 a8 69  |bT..hSDf?.hb:..i|
+000002b0  f2 17 c7 17 ad c9 28 a5  01 eb cc 75 51 57 93 04  |......(....uQW..|
+000002c0  03 00 8a 30 81 87 02 42  00 8f c8 a1 0d 7e 53 2a  |...0...B.....~S*|
+000002d0  15 1f 5e 3f 5d 45 9a 1a  ef b7 8f f8 b4 6c 77 07  |..^?]E.......lw.|
+000002e0  78 23 d3 06 e8 8b 8b 40  a9 c7 3d 5a 57 68 87 0a  |x#.....@..=ZWh..|
+000002f0  69 86 19 3f b1 ce 51 9b  b1 a9 be 30 52 77 0c 19  |i..?..Q....0Rw..|
+00000300  31 5f 62 01 f8 59 35 07  46 f3 02 41 75 d7 2c 76  |1_b..Y5.F..Au.,v|
+00000310  e4 d4 fa cb 1b eb ef 53  0f d0 60 19 a5 6e c0 f8  |.......S..`..n..|
+00000320  67 82 e9 03 c6 bf 7e 0e  0c b0 74 22 32 3b 68 45  |g.....~...t"2;hE|
+00000330  9e 91 a8 18 db b8 23 33  f3 44 3d 66 56 0f 73 91  |......#3.D=fV.s.|
+00000340  81 9d 73 b8 b7 02 23 ab  4c 28 39 00 e2 16 03 03  |..s...#.L(9.....|
+00000350  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
 00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
 00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 f7 ed  |.....(..........|
-00000060  e3 5d 52 8d 50 12 94 2b  08 aa 4c f0 1e 1f 96 ad  |.]R.P..+..L.....|
-00000070  d2 3f 44 68 40 01 c5 44  c6 51 b7 f3 2f 53        |.?Dh@..D.Q../S|
+00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 26 b4  |.....(........&.|
+00000060  7f ed 06 9c 4a 40 7f 35  56 d6 f3 b4 a8 cc 26 a8  |....J@.5V.....&.|
+00000070  bd 27 b4 6e c9 8d 5e 8a  64 a9 03 f4 b0 19        |.'.n..^.d.....|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 d9 6e d9 50 4e  |..........(.n.PN|
-00000010  89 ed 8c 78 ed 8d 09 29  5e 30 a8 d6 6e 7f 8f 0d  |...x...)^0..n...|
-00000020  da 57 b2 44 81 2c 86 f5  c2 8d 82 f7 8f 18 3a 19  |.W.D.,........:.|
-00000030  70 4e af                                          |pN.|
+00000000  14 03 03 00 01 01 16 03  03 00 28 4f 51 fc b5 13  |..........(OQ...|
+00000010  3e 76 c2 a1 63 43 ef d4  69 f1 6d a3 f3 76 96 8f  |>v..cC..i.m..v..|
+00000020  7c 41 a6 8c 33 67 f2 2b  4d 3a b6 08 d8 0e af 1d  ||A..3g.+M:......|
+00000030  30 d4 66                                          |0.f|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 7e b1 7c  |.............~.||
-00000010  00 de 79 e3 44 41 cd f1  39 76 cc 32 b4 9a 3a 1a  |..y.DA..9v.2..:.|
-00000020  16 1b 20 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.. .............|
-00000030  f1 11 46 a8 1e 1b df 5d  d9 ae 3e 81 5c fd 0c 60  |..F....]..>.\..`|
-00000040  c3 35                                             |.5|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 fe 94 6f  |...............o|
+00000010  0f be 72 0e 69 15 59 ef  1e 46 ec a1 ac e5 fd 6c  |..r.i.Y..F.....l|
+00000020  2f 63 33 15 03 03 00 1a  00 00 00 00 00 00 00 02  |/c3.............|
+00000030  3a 61 9f 5f f9 9c 85 38  0b ce 57 5e 67 e4 78 3a  |:a._...8..W^g.x:|
+00000040  bc c5                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES128-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES128-SHA256
new file mode 100644
index 0000000000..a1863add3b
--- /dev/null
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES128-SHA256
@@ -0,0 +1,94 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+>>> Flow 2 (server to client)
+00000000  16 03 03 00 59 02 00 00  55 03 03 dc 70 e2 2c 2a  |....Y...U...p.,*|
+00000010  b3 14 e6 05 f7 a7 45 61  81 2b b5 8a b4 b9 a2 c6  |......Ea.+......|
+00000020  0d b8 3a 5c 6b 3b ff de  db 48 d5 20 81 90 48 44  |..:\k;...H. ..HD|
+00000030  d1 94 4b 18 ef 56 65 6e  34 b6 79 06 c2 14 29 75  |..K..Ven4.y...)u|
+00000040  ae 4b d5 34 58 18 1e 9c  a5 7a a1 13 c0 23 00 00  |.K.4X....z...#..|
+00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
+00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
+00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
+00000080  30 09 06 07 2a 86 48 ce  3d 04 01 30 45 31 0b 30  |0...*.H.=..0E1.0|
+00000090  09 06 03 55 04 06 13 02  41 55 31 13 30 11 06 03  |...U....AU1.0...|
+000000a0  55 04 08 13 0a 53 6f 6d  65 2d 53 74 61 74 65 31  |U....Some-State1|
+000000b0  21 30 1f 06 03 55 04 0a  13 18 49 6e 74 65 72 6e  |!0...U....Intern|
+000000c0  65 74 20 57 69 64 67 69  74 73 20 50 74 79 20 4c  |et Widgits Pty L|
+000000d0  74 64 30 1e 17 0d 31 32  31 31 32 32 31 35 30 36  |td0...1211221506|
+000000e0  33 32 5a 17 0d 32 32 31  31 32 30 31 35 30 36 33  |32Z..22112015063|
+000000f0  32 5a 30 45 31 0b 30 09  06 03 55 04 06 13 02 41  |2Z0E1.0...U....A|
+00000100  55 31 13 30 11 06 03 55  04 08 13 0a 53 6f 6d 65  |U1.0...U....Some|
+00000110  2d 53 74 61 74 65 31 21  30 1f 06 03 55 04 0a 13  |-State1!0...U...|
+00000120  18 49 6e 74 65 72 6e 65  74 20 57 69 64 67 69 74  |.Internet Widgit|
+00000130  73 20 50 74 79 20 4c 74  64 30 81 9b 30 10 06 07  |s Pty Ltd0..0...|
+00000140  2a 86 48 ce 3d 02 01 06  05 2b 81 04 00 23 03 81  |*.H.=....+...#..|
+00000150  86 00 04 00 c4 a1 ed be  98 f9 0b 48 73 36 7e c3  |...........Hs6~.|
+00000160  16 56 11 22 f2 3d 53 c3  3b 4d 21 3d cd 6b 75 e6  |.V.".=S.;M!=.ku.|
+00000170  f6 b0 dc 9a df 26 c1 bc  b2 87 f0 72 32 7c b3 64  |.....&.....r2|.d|
+00000180  2f 1c 90 bc ea 68 23 10  7e fe e3 25 c0 48 3a 69  |/....h#.~..%.H:i|
+00000190  e0 28 6d d3 37 00 ef 04  62 dd 0d a0 9c 70 62 83  |.(m.7...b....pb.|
+000001a0  d8 81 d3 64 31 aa 9e 97  31 bd 96 b0 68 c0 9b 23  |...d1...1...h..#|
+000001b0  de 76 64 3f 1a 5c 7f e9  12 0e 58 58 b6 5f 70 dd  |.vd?.\....XX._p.|
+000001c0  9b d8 ea d5 d7 f5 d5 cc  b9 b6 9f 30 66 5b 66 9a  |...........0f[f.|
+000001d0  20 e2 27 e5 bf fe 3b 30  09 06 07 2a 86 48 ce 3d  | .'...;0...*.H.=|
+000001e0  04 01 03 81 8c 00 30 81  88 02 42 01 88 a2 4f eb  |......0...B...O.|
+000001f0  e2 45 c5 48 7d 1b ac f5  ed 98 9d ae 47 70 c0 5e  |.E.H}.......Gp.^|
+00000200  1b b6 2f bd f1 b6 4d b7  61 40 d3 11 a2 ce ee 0b  |../...M.a@......|
+00000210  7e 92 7e ff 76 9d c3 3b  7e a5 3f ce fa 10 e2 59  |~.~.v..;~.?....Y|
+00000220  ec 47 2d 7c ac da 4e 97  0e 15 a0 6f d0 02 42 01  |.G-|..N....o..B.|
+00000230  4d fc be 67 13 9c 2d 05  0e bd 3f a3 8c 25 c1 33  |M..g..-...?..%.3|
+00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
+00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
+00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
+00000270  2a 16 03 03 00 d8 0c 00  00 d4 03 00 17 41 04 81  |*............A..|
+00000280  3d d2 f3 36 ac 7a 42 7f  36 d9 d9 97 11 ca 54 bf  |=..6.zB.6.....T.|
+00000290  21 95 a5 32 e1 90 ab ee  d5 65 c9 d0 b1 92 cc 21  |!..2.....e.....!|
+000002a0  ab 15 81 bb 30 51 0f a2  5d 99 29 d2 46 cd f4 94  |....0Q..].).F...|
+000002b0  11 28 0e d2 eb 3d ca 05  9e a6 27 5d b0 80 c7 04  |.(...=....']....|
+000002c0  03 00 8b 30 81 88 02 42  00 ec e7 77 57 95 36 ad  |...0...B...wW.6.|
+000002d0  52 ae ed 4c fc 44 84 08  a9 28 66 f7 a6 1f c3 96  |R..L.D...(f.....|
+000002e0  5f 35 dc b1 ea 5e 7b 3d  be 8c 08 ef b1 06 74 b3  |_5...^{=......t.|
+000002f0  9f 36 17 30 3a 34 f3 7e  b9 39 cc fa c7 aa 33 7d  |.6.0:4.~.9....3}|
+00000300  5a d2 b6 44 f3 67 09 1b  6f 08 02 42 00 df cf 92  |Z..D.g..o..B....|
+00000310  b0 f1 e2 34 24 ec 78 12  12 07 66 3e d9 1c 7c fa  |...4$.x...f>..|.|
+00000320  13 f7 39 cd 01 11 ea f0  62 e9 1f 75 5f e4 17 cf  |..9.....b..u_...|
+00000330  e8 fd 03 4c 63 15 3e 4a  d1 2a 25 07 a1 bb f9 5d  |...Lc.>J.*%....]|
+00000340  32 62 41 23 09 a3 9d 92  78 51 09 82 25 d7 16 03  |2bA#....xQ..%...|
+00000350  03 00 04 0e 00 00 00                              |.......|
+>>> Flow 3 (client to server)
+00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
+00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
+00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
+00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
+00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
+00000050  01 16 03 03 00 50 00 00  00 00 00 00 00 00 00 00  |.....P..........|
+00000060  00 00 00 00 00 00 2a 78  1d 82 10 56 52 ee ec 22  |......*x...VR.."|
+00000070  d7 b5 63 91 b2 98 a2 01  59 d7 63 f6 ca 30 22 ac  |..c.....Y.c..0".|
+00000080  10 5e b3 60 d9 f6 37 a9  3d 15 7d 78 9c 99 be b7  |.^.`..7.=.}x....|
+00000090  3a f1 1a 99 22 8c 2b e5  ea 5a 57 0c 74 1a ea d6  |:...".+..ZW.t...|
+000000a0  52 b9 a0 fa f8 7b                                 |R....{|
+>>> Flow 4 (server to client)
+00000000  14 03 03 00 01 01 16 03  03 00 50 60 9d 1e 05 df  |..........P`....|
+00000010  a0 d5 1f 08 f1 cc 99 60  86 e3 1e e1 bc 59 08 2f  |.......`.....Y./|
+00000020  27 60 c1 a3 fc cf 0f 1b  6f 9e 5e 4c d4 3a 9a 19  |'`......o.^L.:..|
+00000030  2a 72 a7 82 12 26 ec 7e  74 0f b4 9a 2c b2 8e da  |*r...&.~t...,...|
+00000040  ac cb 26 29 a6 65 d5 7f  15 a1 52 07 35 44 68 77  |..&).e....R.5Dhw|
+00000050  61 6b ef 6b e9 93 db 9b  4f 72 65                 |ak.k....Ore|
+>>> Flow 5 (client to server)
+00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
+00000010  00 00 00 00 00 9a 50 34  bc 9d 00 0e 46 81 dc 03  |......P4....F...|
+00000020  f2 8f ea 57 93 a2 99 26  7e ae 70 70 d1 b7 ed b2  |...W...&~.pp....|
+00000030  d3 76 28 9d 19 14 13 e3  5c f7 58 aa 25 98 c4 82  |.v(.....\.X.%...|
+00000040  ee c3 e7 4a 51 15 03 03  00 40 00 00 00 00 00 00  |...JQ....@......|
+00000050  00 00 00 00 00 00 00 00  00 00 5d 80 c2 d5 ae 05  |..........].....|
+00000060  9a 31 e4 39 3f 4c f0 97  ed cb fd e3 3a de 19 b6  |.1.9?L......:...|
+00000070  0d 49 95 43 13 a1 c8 29  a0 dc b5 30 4b 66 a6 25  |.I.C...)...0Kf.%|
+00000080  e0 fd a8 02 c9 81 1d fa  f9 2e                    |..........|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384 b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384
index c7b6521c45..af7d19358f 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 36 00 05 00 05  01 00 00 00 00 00 0a 00  |...6............|
-00000060  08 00 06 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
-00000070  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
-00000080  03 ff 01 00 01 00 00 12  00 00                    |..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 34 4d a4 44 46  |....Y...U..4M.DF|
-00000010  4d 2b 28 42 74 7c 7c 25  d0 39 da 2d ec 1a 7a 6a  |M+(Bt||%.9.-..zj|
-00000020  03 e3 7a d5 69 63 e3 08  38 eb c7 20 a3 99 22 43  |..z.ic..8.. .."C|
-00000030  bf 58 19 9b 9b e6 84 19  f9 13 d5 c4 3b af cc c0  |.X..........;...|
-00000040  7e dc 6a c1 d3 2c 3a e6  3f 47 34 0f c0 2c 00 00  |~.j..,:.?G4..,..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 99 32 aa 20 58  |....Y...U...2. X|
+00000010  d0 30 4c 2f ad 16 ef b9  e9 7b ff 1d 08 6f 0e ef  |.0L/.....{...o..|
+00000020  5b 1f 75 6f 44 0c 88 33  8b 29 13 20 66 72 ac 2f  |[.uoD..3.). fr./|
+00000030  cc c8 02 f0 6f d3 b9 20  80 85 97 81 14 c5 10 18  |....o.. ........|
+00000040  f2 fe 96 e4 60 0b a0 92  b1 79 8b 58 c0 2c 00 00  |....`....y.X.,..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -48,38 +48,38 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 d7 0c 00  00 d3 03 00 17 41 04 fe  |*............A..|
-00000280  52 a5 95 63 3b 33 98 48  53 2f 94 af 57 3c f2 a1  |R..c;3.HS/..W<..|
-00000290  48 6c 6e e9 88 a3 05 bd  a9 da ae 7d 62 ea 6b a9  |Hln........}b.k.|
-000002a0  60 2a b6 b8 51 f5 32 ac  af 99 2b eb 5f b3 25 d8  |`*..Q.2...+._.%.|
-000002b0  d1 1e f5 f4 bd 17 f0 ab  ff 11 ea bd 50 af 03 04  |............P...|
-000002c0  03 00 8a 30 81 87 02 41  7c cb 5e 47 3f c0 61 92  |...0...A|.^G?.a.|
-000002d0  1c ac d2 9d 20 11 d4 37  d4 24 56 d0 46 16 32 73  |.... ..7.$V.F.2s|
-000002e0  4c 2d d6 b0 47 ab ea a3  c2 4e a5 0c 36 88 1b e7  |L-..G....N..6...|
-000002f0  a7 e5 52 ac 0a 9c f2 6a  df 08 ec 7a a2 14 ae de  |..R....j...z....|
-00000300  6e 10 d9 8f 4e ea c7 60  fe 02 42 01 a5 ee 92 6c  |n...N..`..B....l|
-00000310  64 f1 b0 0f 62 ff 9b 87  63 56 e6 fb f6 6d 14 8d  |d...b...cV...m..|
-00000320  7f a7 7e 9f 0c 19 16 38  00 5e 62 20 51 47 58 19  |..~....8.^b QGX.|
-00000330  d9 35 be 1f 83 68 c8 60  8a 92 7c 44 4e 20 93 83  |.5...h.`..|DN ..|
-00000340  0e 09 99 8d af 14 c7 d2  d5 0d 2b 86 ff 16 03 03  |..........+.....|
-00000350  00 04 0e 00 00 00                                 |......|
+00000270  2a 16 03 03 00 d8 0c 00  00 d4 03 00 17 41 04 8e  |*............A..|
+00000280  02 91 ed c4 ee 09 4e e3  98 d1 7f 4d 24 02 27 60  |......N....M$.'`|
+00000290  1c 77 c0 fd 79 e0 03 fb  9c 74 e8 85 a1 5f f5 ef  |.w..y....t..._..|
+000002a0  8d 01 8b cf 91 bc b2 f2  5b 41 cc 98 f2 54 7d a1  |........[A...T}.|
+000002b0  95 86 67 02 a3 97 9b 1c  54 37 07 ab 14 4c 5a 04  |..g.....T7...LZ.|
+000002c0  03 00 8b 30 81 88 02 42  01 85 fb c0 e3 70 31 8a  |...0...B.....p1.|
+000002d0  7d 14 e6 f4 5b 9c cc f8  05 f0 ca 9d 6c df 2a 5a  |}...[.......l.*Z|
+000002e0  e6 3b 40 00 ba a8 f6 38  90 a1 a7 00 74 cd ab 17  |.;@....8....t...|
+000002f0  d0 65 69 46 43 ec e2 11  d8 7e 90 a3 72 74 0f a9  |.eiFC....~..rt..|
+00000300  43 f2 0a d9 22 4d c7 5d  23 91 02 42 01 9f 42 1c  |C..."M.]#..B..B.|
+00000310  5a 23 83 c2 69 e4 42 5f  53 f8 6b ef 23 7c 22 27  |Z#..i.B_S.k.#|"'|
+00000320  a6 99 9c e1 df 48 6b e9  9d 1f 14 64 25 4d 78 63  |.....Hk....d%Mxc|
+00000330  c7 42 e2 26 af e4 70 34  29 d9 e8 fc e8 3b 43 8d  |.B.&..p4)....;C.|
+00000340  f6 1c 22 3e b1 8a 7b 16  d0 44 3f 3b 92 79 16 03  |..">..{..D?;.y..|
+00000350  03 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
 00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
 00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 72 ed  |.....(........r.|
-00000060  57 32 07 69 25 b8 12 93  10 17 43 f2 17 43 5a 2e  |W2.i%.....C..CZ.|
-00000070  61 95 8b c5 d2 0d db cf  46 9f 76 4d 2a e9        |a.......F.vM*.|
+00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 d4 6e  |.....(.........n|
+00000060  eb 01 cd ca 65 97 0f 2b  3f dc 27 bb ff eb 49 43  |....e..+?.'...IC|
+00000070  94 ff 5e 80 75 ac c9 c5  f4 57 10 0e 06 08        |..^.u....W....|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 14 1e de a9 ec  |..........(.....|
-00000010  11 c5 c8 7d be 31 9a 45  66 26 d4 c5 aa 6f 55 98  |...}.1.Ef&...oU.|
-00000020  83 ca 3e ed e6 e6 f4 88  8d b9 15 84 6a d4 91 e9  |..>.........j...|
-00000030  51 92 55                                          |Q.U|
+00000000  14 03 03 00 01 01 16 03  03 00 28 51 bb 38 d0 28  |..........(Q.8.(|
+00000010  d6 9e ea 9c 0d 90 bf 46  60 96 9b a4 81 d3 d8 db  |.......F`.......|
+00000020  f3 ba 91 e2 16 8e 63 02  24 4b ce 1a ec b4 ae ab  |......c.$K......|
+00000030  69 de 0f                                          |i..|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 d5 16 52  |...............R|
-00000010  c8 3a be 00 42 92 e9 c1  65 56 9d 3e 79 26 ff 67  |.:..B...eV.>y&.g|
-00000020  1a f2 97 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
-00000030  b4 ef 56 91 04 f6 9c 68  1c dd 9f f7 c0 6c 78 fc  |..V....h.....lx.|
-00000040  1c 6d                                             |.m|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 cd 00 a5  |................|
+00000010  c9 d1 05 c7 68 30 e4 d1  62 e1 b1 e0 1b bb 08 cf  |....h0..b.......|
+00000020  a2 2f 81 15 03 03 00 1a  00 00 00 00 00 00 00 02  |./..............|
+00000030  4a a2 5d 68 b7 82 ef ef  99 d2 77 d6 bf 59 96 bd  |J.]h......w..Y..|
+00000040  c9 04                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES
index 4ab3017b45..d793f38f7f 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 36 00 05 00 05  01 00 00 00 00 00 0a 00  |...6............|
-00000060  08 00 06 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
-00000070  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
-00000080  03 ff 01 00 01 00 00 12  00 00                    |..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 60 e0 ff c6 9b  |....Y...U..`....|
-00000010  6c 9a 9d 83 7c 4c 55 a9  58 71 45 13 4d 71 1a d2  |l...|LU.XqE.Mq..|
-00000020  4c eb b6 5f 8c aa 3a e2  27 fb 85 20 79 9f 4c 81  |L.._..:.'.. y.L.|
-00000030  6e 81 ec 38 85 ab 69 88  95 e9 44 63 6f 23 e4 85  |n..8..i...Dco#..|
-00000040  ef d2 85 63 6c df 03 06  e7 bb 95 13 c0 13 00 00  |...cl...........|
+00000000  16 03 03 00 59 02 00 00  55 03 03 0f 45 26 1e c1  |....Y...U...E&..|
+00000010  a8 81 43 80 a6 3b b8 78  8f 19 83 ca 10 62 90 55  |..C..;.x.....b.U|
+00000020  13 5b c3 78 55 23 32 ca  46 ab 1b 20 12 b9 b5 8b  |.[.xU#2.F.. ....|
+00000030  6a 21 25 9b e6 fc 12 78  0c 62 9f fe 2a dc cd 31  |j!%....x.b..*..1|
+00000040  53 a1 6e 3c 79 df 71 12  fd 83 4b 67 c0 13 00 00  |S.n<y.q...Kg....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,19 +53,19 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  cd 0c 00 00 c9 03 00 17  41 04 d5 40 82 ca e0 2a  |........A..@...*|
-000002d0  85 38 a6 3c d4 47 0a 86  d1 82 7a 32 b1 dc b3 c9  |.8.<.G....z2....|
-000002e0  c6 14 03 64 e2 71 ef 2a  0b 3e ff b6 24 65 a4 5d  |...d.q.*.>..$e.]|
-000002f0  40 0a 96 7c 75 15 47 ed  aa 7a e0 f4 3b 72 00 ed  |@..|u.G..z..;r..|
-00000300  f1 d9 60 12 9e dc 4e 28  b3 a8 04 01 00 80 0f e6  |..`...N(........|
-00000310  ce f4 69 49 e5 4f 7b 43  82 c6 4a 69 ea 57 fb b3  |..iI.O{C..Ji.W..|
-00000320  d0 ba ed 82 70 95 64 60  39 c7 77 45 e2 51 18 db  |....p.d`9.wE.Q..|
-00000330  6a c2 66 34 3a 39 44 52  b7 54 c8 4f e2 3b b2 71  |j.f4:9DR.T.O.;.q|
-00000340  ac b7 f5 7c cd d7 a7 3c  0a 6c 04 43 26 c8 75 22  |...|...<.l.C&.u"|
-00000350  a4 f3 20 10 ab 4c ff 59  43 79 98 f3 b8 05 ec a8  |.. ..L.YCy......|
-00000360  c7 63 90 71 c3 d7 d1 ad  43 b9 77 68 67 63 1f 9c  |.c.q....C.whgc..|
-00000370  da 6e b4 74 f9 c8 a4 21  c6 46 ba ab d6 a6 29 ea  |.n.t...!.F....).|
-00000380  c4 73 68 af 18 83 cf e0  d7 37 f0 2c c6 e7 16 03  |.sh......7.,....|
+000002c0  cd 0c 00 00 c9 03 00 17  41 04 7b be a6 f9 bd 67  |........A.{....g|
+000002d0  6f 05 21 b5 8e 20 e5 35  a7 51 f0 ce c0 76 21 78  |o.!.. .5.Q...v!x|
+000002e0  36 d2 39 ca 46 44 0a e0  e5 2a df 59 1e c4 8f c1  |6.9.FD...*.Y....|
+000002f0  fc 4a 65 ff e6 18 dc 60  47 6c 31 b0 68 65 02 92  |.Je....`Gl1.he..|
+00000300  75 ab 7c db 83 d6 d4 44  06 36 04 01 00 80 40 dd  |u.|....D.6....@.|
+00000310  9b dd 37 cb 16 bb c7 29  52 3a 02 64 6c a3 c4 06  |..7....)R:.dl...|
+00000320  fd 24 e1 d3 b3 83 6c 45  2c 76 17 ae f6 b4 af e7  |.$....lE,v......|
+00000330  b7 93 a6 69 e6 8c c8 6b  a0 9a 72 9c 80 4e 04 e6  |...i...k..r..N..|
+00000340  dd 7e 49 d4 d2 29 9e 2f  64 89 be 00 36 e9 8e 53  |.~I..)./d...6..S|
+00000350  0a 23 b2 b6 a1 6e 94 df  e1 b2 c1 35 17 85 7c 7a  |.#...n.....5..|z|
+00000360  5e d1 0f 03 b2 55 2f 52  48 af 66 17 ae 25 3d 0a  |^....U/RH.f..%=.|
+00000370  dc c7 c2 8e 40 b9 a2 5d  65 25 85 1c 88 d4 6c aa  |....@..]e%....l.|
+00000380  0b 5b c8 77 4c bd 88 60  eb f2 fc 9f 71 39 16 03  |.[.wL..`....q9..|
 00000390  03 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
@@ -74,21 +74,21 @@
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
 00000050  01 16 03 03 00 40 00 00  00 00 00 00 00 00 00 00  |.....@..........|
-00000060  00 00 00 00 00 00 0c 32  5c 4c 59 51 c2 48 39 b9  |.......2\LYQ.H9.|
-00000070  29 a9 72 fb e4 42 a1 55  08 a3 99 a2 06 ef 59 b7  |).r..B.U......Y.|
-00000080  41 d0 b3 e8 ea c2 5f fc  96 54 d5 a6 cf bc 1f 8e  |A....._..T......|
-00000090  a9 e1 84 ae 8c af                                 |......|
+00000060  00 00 00 00 00 00 d1 bb  84 d1 bb 91 17 18 dc 9f  |................|
+00000070  0a 6f df 19 6f cb 04 c4  0d 4a d1 d1 6c 0d 94 da  |.o..o....J..l...|
+00000080  54 7a 4d 21 52 99 00 8e  70 6b 15 1f 51 29 8f b6  |TzM!R...pk..Q)..|
+00000090  14 ed 8e 53 ea f3                                 |...S..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 79 cb ff 21 66  |..........@y..!f|
-00000010  17 d5 5e 5f 80 ef 2a 13  91 30 12 ec f1 37 c9 e3  |..^_..*..0...7..|
-00000020  f8 43 6a 36 b8 7a 08 da  46 c8 60 f7 0f 63 fa 43  |.Cj6.z..F.`..c.C|
-00000030  99 4e cb 8e bf 2c d8 de  16 b7 98 7e 12 78 e7 a0  |.N...,.....~.x..|
-00000040  29 51 34 93 9e bb 0c 2a  fb 1d ad                 |)Q4....*...|
+00000000  14 03 03 00 01 01 16 03  03 00 40 9c 15 03 96 11  |..........@.....|
+00000010  67 f8 cd 1e 60 b5 a4 12  d1 8e f1 85 63 bf 1d 9d  |g...`.......c...|
+00000020  3f 93 81 e3 bb 77 75 f3  18 01 d0 c6 c6 35 2b e0  |?....wu......5+.|
+00000030  82 03 0f a1 eb 98 09 52  5e b6 53 b5 54 d9 08 67  |.......R^.S.T..g|
+00000040  a7 cf bf f3 54 cf f1 26  4f 6e 5b                 |....T..&On[|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 7e 36 1c  bc fd 37 60 bd ec 7a a8  |.....~6...7`..z.|
-00000020  2e ff f7 1e a9 d9 1b 7c  42 35 d1 56 8a 6f 04 d8  |.......|B5.V.o..|
-00000030  1d 05 f7 2b d5 15 03 03  00 30 00 00 00 00 00 00  |...+.....0......|
-00000040  00 00 00 00 00 00 00 00  00 00 33 0c 03 55 99 f2  |..........3..U..|
-00000050  10 1a 91 74 ea c1 3c 4e  ee 58 f7 da 05 fa 15 44  |...t..<N.X.....D|
-00000060  81 8b 1a f6 63 b7 6f 9f  12 3b                    |....c.o..;|
+00000010  00 00 00 00 00 65 00 0c  8a 77 a2 48 d1 40 82 9f  |.....e...w.H.@..|
+00000020  f6 34 89 bf bb 42 d1 ea  6b 7f 61 8e 7b 9b f9 b5  |.4...B..k.a.{...|
+00000030  0b a5 d9 8c 0d 15 03 03  00 30 00 00 00 00 00 00  |.........0......|
+00000040  00 00 00 00 00 00 00 00  00 00 e5 5f 74 3d bd c6  |..........._t=..|
+00000050  5d 68 04 b2 4f 44 0d 43  6b a8 7a 38 81 23 27 10  |]h..OD.Ck.z8.#'.|
+00000060  3b 39 63 4c c7 8f 11 21  2e 86                    |;9cL...!..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256
new file mode 100644
index 0000000000..f47d206021
--- /dev/null
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256
@@ -0,0 +1,98 @@
+>>> Flow 1 (client to server)
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
+00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
+>>> Flow 2 (server to client)
+00000000  16 03 03 00 59 02 00 00  55 03 03 03 c2 c6 e3 f7  |....Y...U.......|
+00000010  81 dc 23 5e 5f df a9 e4  7f 4b 78 03 8f 6c e9 ab  |..#^_....Kx..l..|
+00000020  bf b8 e0 26 43 33 a6 f3  d0 e1 44 20 82 76 b7 11  |...&C3....D .v..|
+00000030  aa 07 30 6e 6d 47 c6 52  7f a0 ac 91 84 e6 91 d3  |..0nmG.R........|
+00000040  f5 f3 54 f3 37 96 9d 0b  c1 33 2e 01 c0 27 00 00  |..T.7....3...'..|
+00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
+00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
+00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
+00000080  3f e2 5b ea a6 30 0d 06  09 2a 86 48 86 f7 0d 01  |?.[..0...*.H....|
+00000090  01 0b 05 00 30 1f 31 0b  30 09 06 03 55 04 0a 13  |....0.1.0...U...|
+000000a0  02 47 6f 31 10 30 0e 06  03 55 04 03 13 07 47 6f  |.Go1.0...U....Go|
+000000b0  20 52 6f 6f 74 30 1e 17  0d 31 36 30 31 30 31 30  | Root0...1601010|
+000000c0  30 30 30 30 30 5a 17 0d  32 35 30 31 30 31 30 30  |00000Z..25010100|
+000000d0  30 30 30 30 5a 30 1a 31  0b 30 09 06 03 55 04 0a  |0000Z0.1.0...U..|
+000000e0  13 02 47 6f 31 0b 30 09  06 03 55 04 03 13 02 47  |..Go1.0...U....G|
+000000f0  6f 30 81 9f 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |o0..0...*.H.....|
+00000100  01 05 00 03 81 8d 00 30  81 89 02 81 81 00 db 46  |.......0.......F|
+00000110  7d 93 2e 12 27 06 48 bc  06 28 21 ab 7e c4 b6 a2  |}...'.H..(!.~...|
+00000120  5d fe 1e 52 45 88 7a 36  47 a5 08 0d 92 42 5b c2  |]..RE.z6G....B[.|
+00000130  81 c0 be 97 79 98 40 fb  4f 6d 14 fd 2b 13 8b c2  |....y.@.Om..+...|
+00000140  a5 2e 67 d8 d4 09 9e d6  22 38 b7 4a 0b 74 73 2b  |..g....."8.J.ts+|
+00000150  c2 34 f1 d1 93 e5 96 d9  74 7b f3 58 9f 6c 61 3c  |.4......t{.X.la<|
+00000160  c0 b0 41 d4 d9 2b 2b 24  23 77 5b 1c 3b bd 75 5d  |..A..++$#w[.;.u]|
+00000170  ce 20 54 cf a1 63 87 1d  1e 24 c4 f3 1d 1a 50 8b  |. T..c...$....P.|
+00000180  aa b6 14 43 ed 97 a7 75  62 f4 14 c8 52 d7 02 03  |...C...ub...R...|
+00000190  01 00 01 a3 81 93 30 81  90 30 0e 06 03 55 1d 0f  |......0..0...U..|
+000001a0  01 01 ff 04 04 03 02 05  a0 30 1d 06 03 55 1d 25  |.........0...U.%|
+000001b0  04 16 30 14 06 08 2b 06  01 05 05 07 03 01 06 08  |..0...+.........|
+000001c0  2b 06 01 05 05 07 03 02  30 0c 06 03 55 1d 13 01  |+.......0...U...|
+000001d0  01 ff 04 02 30 00 30 19  06 03 55 1d 0e 04 12 04  |....0.0...U.....|
+000001e0  10 9f 91 16 1f 43 43 3e  49 a6 de 6d b6 80 d7 9f  |.....CC>I..m....|
+000001f0  60 30 1b 06 03 55 1d 23  04 14 30 12 80 10 48 13  |`0...U.#..0...H.|
+00000200  49 4d 13 7e 16 31 bb a3  01 d5 ac ab 6e 7b 30 19  |IM.~.1......n{0.|
+00000210  06 03 55 1d 11 04 12 30  10 82 0e 65 78 61 6d 70  |..U....0...examp|
+00000220  6c 65 2e 67 6f 6c 61 6e  67 30 0d 06 09 2a 86 48  |le.golang0...*.H|
+00000230  86 f7 0d 01 01 0b 05 00  03 81 81 00 9d 30 cc 40  |.............0.@|
+00000240  2b 5b 50 a0 61 cb ba e5  53 58 e1 ed 83 28 a9 58  |+[P.a...SX...(.X|
+00000250  1a a9 38 a4 95 a1 ac 31  5a 1a 84 66 3d 43 d3 2d  |..8....1Z..f=C.-|
+00000260  d9 0b f2 97 df d3 20 64  38 92 24 3a 00 bc cf 9c  |...... d8.$:....|
+00000270  7d b7 40 20 01 5f aa d3  16 61 09 a2 76 fd 13 c3  |}.@ ._...a..v...|
+00000280  cc e1 0c 5c ee b1 87 82  f1 6c 04 ed 73 bb b3 43  |...\.....l..s..C|
+00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
+000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
+000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
+000002c0  cd 0c 00 00 c9 03 00 17  41 04 d2 0d 72 49 89 39  |........A...rI.9|
+000002d0  9e e3 8b c5 0f 47 53 60  a8 c9 c5 da c8 29 32 63  |.....GS`.....)2c|
+000002e0  1b 76 08 55 46 9b a2 75  b4 6c 2e 91 cb b5 ec df  |.v.UF..u.l......|
+000002f0  8c bc 99 28 ba 41 21 cf  f3 29 7f e9 bb a5 94 06  |...(.A!..)......|
+00000300  00 de e7 f0 82 62 dd 1e  eb 65 04 01 00 80 0d 84  |.....b...e......|
+00000310  ea bc c9 3f 81 d3 86 a7  a3 d1 7e 0b 13 b1 b8 c8  |...?......~.....|
+00000320  1c a1 10 ed 9c 9e 93 3f  85 8d 9a 66 62 62 dd 0e  |.......?...fbb..|
+00000330  65 0e bb f9 7e 29 58 1d  a8 27 03 66 58 49 bc d0  |e...~)X..'.fXI..|
+00000340  02 bb 89 ec 59 f8 0a 14  3c ea f0 00 68 1a 94 2b  |....Y...<...h..+|
+00000350  40 65 28 f3 e8 7d 80 0b  52 d8 4d b0 eb 5b 85 dd  |@e(..}..R.M..[..|
+00000360  19 62 a8 8e 22 d5 6a 4c  95 b4 dc 26 c9 dd 62 57  |.b..".jL...&..bW|
+00000370  d5 e4 f0 c7 92 b4 ee 9d  aa 82 50 a0 de 3d 23 37  |..........P..=#7|
+00000380  5c da 0a 4d ee 3b 5a 4c  39 f1 80 85 e6 50 16 03  |\..M.;ZL9....P..|
+00000390  03 00 04 0e 00 00 00                              |.......|
+>>> Flow 3 (client to server)
+00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
+00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
+00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
+00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
+00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
+00000050  01 16 03 03 00 50 00 00  00 00 00 00 00 00 00 00  |.....P..........|
+00000060  00 00 00 00 00 00 e2 26  a9 25 5d 21 a4 b3 b9 d0  |.......&.%]!....|
+00000070  10 0a f8 6a 49 13 ad 1d  b1 c1 f9 96 ac c5 1f ef  |...jI...........|
+00000080  56 21 94 fe 5b 02 52 5c  7c 3f cc 2e f1 07 f6 73  |V!..[.R\|?.....s|
+00000090  bc 8d 44 27 e4 d6 01 a0  91 a5 41 81 73 52 2a 1e  |..D'......A.sR*.|
+000000a0  34 20 56 fa 62 b9                                 |4 V.b.|
+>>> Flow 4 (server to client)
+00000000  14 03 03 00 01 01 16 03  03 00 50 8c 3f 01 38 bf  |..........P.?.8.|
+00000010  82 14 f9 93 22 bd 88 90  63 4d e2 76 6d c6 13 19  |...."...cM.vm...|
+00000020  ec 99 42 ba 09 7c f6 41  da 33 6d c4 c5 59 da f8  |..B..|.A.3m..Y..|
+00000030  91 ad f0 11 e0 5e cd 16  47 c0 7d d1 00 3a 35 ab  |.....^..G.}..:5.|
+00000040  a0 fb 2e 5a ca 24 2c e0  44 0f 13 4a 46 32 04 9b  |...Z.$,.D..JF2..|
+00000050  7c 5c 1e ee fd 10 f6 2e  61 25 54                 ||\......a%T|
+>>> Flow 5 (client to server)
+00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
+00000010  00 00 00 00 00 df 99 71  37 d7 54 28 64 8a 25 e4  |.......q7.T(d.%.|
+00000020  ca e3 96 1a 16 71 f3 f6  8d 66 e9 78 5d a9 29 b3  |.....q...f.x].).|
+00000030  6c 2f 78 89 63 bb 35 c6  7b e8 c8 13 19 bc af 55  |l/x.c.5.{......U|
+00000040  be 48 6c 61 95 15 03 03  00 40 00 00 00 00 00 00  |.Hla.....@......|
+00000050  00 00 00 00 00 00 00 00  00 00 2f f6 c9 d2 e7 7d  |........../....}|
+00000060  66 d8 ea 21 57 60 2a a5  df 23 3e 15 5c 3d e0 be  |f..!W`*..#>.\=..|
+00000070  01 3d 19 14 70 3b dd bc  3f bd 09 4d 03 45 07 7f  |.=..p;..?..M.E..|
+00000080  4e e9 6d 43 af 11 47 93  c2 e5                    |N.mC..G...|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4 b/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4
index 6aa31c64e4..200b5de1db 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4
+++ b/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 36 00 05 00 05  01 00 00 00 00 00 0a 00  |...6............|
-00000060  08 00 06 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
-00000070  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
-00000080  03 ff 01 00 01 00 00 12  00 00                    |..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 51 02 00 00  4d 03 03 e7 a3 c2 8c 40  |....Q...M......@|
-00000010  37 77 96 51 7c 82 e3 6e  d1 b3 89 d0 bc 24 0c 19  |7w.Q|..n.....$..|
-00000020  e3 75 2f e3 da b3 f3 ec  65 97 49 20 68 b9 bb bc  |.u/.....e.I h...|
-00000030  4c 86 ca dc 89 e3 ac a2  77 33 13 b7 e3 54 0d cd  |L.......w3...T..|
-00000040  7e b2 b7 3e 4b 80 21 e2  1f 68 23 dd 00 05 00 00  |~..>K.!..h#.....|
+00000000  16 03 03 00 51 02 00 00  4d 03 03 0f 39 64 1d 46  |....Q...M...9d.F|
+00000010  66 7a ef d0 1a e3 1d 32  4c 01 77 39 53 ff 18 97  |fz.....2L.w9S...|
+00000020  4d 4f 40 cd 92 08 96 b6  82 08 24 20 57 7c 6a a7  |MO@.......$ W|j.|
+00000030  31 ea 2d 63 23 f1 4b c7  47 31 2f 1c 38 24 a9 e1  |1.-c#.K.G1/.8$..|
+00000040  f1 95 c1 2c 07 8b b3 42  64 db 24 8a 00 05 00 00  |...,...Bd.$.....|
 00000050  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
 00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -63,15 +63,15 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 03 00 24 b2 14  08 1c 58 9c 97 cb d6 c9  |.....$....X.....|
-000000a0  df 73 e5 94 d0 5f 37 00  f4 bc d8 54 35 44 58 95  |.s..._7....T5DX.|
-000000b0  68 ac be 13 16 7a 91 44  7c 33                    |h....z.D|3|
+00000090  01 16 03 03 00 24 4c 3d  05 41 bc d3 29 7b d3 ac  |.....$L=.A..){..|
+000000a0  1a 92 0e 72 d3 eb ca 50  e4 15 e7 72 5f bc 6c f1  |...r...P...r_.l.|
+000000b0  d7 b4 64 33 2e b1 f3 59  53 93                    |..d3...YS.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 24 4a e4 c5 00 29  |..........$J...)|
-00000010  71 10 84 65 e0 bb 25 9b  da d6 58 94 b5 7b 3c a0  |q..e..%...X..{<.|
-00000020  47 a4 7c 38 a5 36 b7 95  ec d4 96 e9 c7 26 58     |G.|8.6.......&X|
+00000000  14 03 03 00 01 01 16 03  03 00 24 ef 0e 94 f8 06  |..........$.....|
+00000010  f8 ad 02 ac d9 11 e4 80  b0 28 17 78 39 a9 76 e1  |.........(.x9.v.|
+00000020  62 7d 3b b3 0a c5 cd 79  21 e7 f5 7b 79 d4 e7     |b};....y!..{y..|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1a 7c 37 38  d6 5e 58 3c e7 bf 50 ca  |.....|78.^X<..P.|
-00000010  67 72 92 1b 7b 8d b2 e0  2a 17 ba ca 3f 12 7f 15  |gr..{...*...?...|
-00000020  03 03 00 16 17 36 a1 a7  54 cd 4e 13 c3 7a a3 b8  |.....6..T.N..z..|
-00000030  69 89 8e 26 78 1c 18 64  f9 6b                    |i..&x..d.k|
+00000000  17 03 03 00 1a 5e a2 78  92 83 51 61 22 99 5f 67  |.....^.x..Qa"._g|
+00000010  b4 d7 8c 5d a5 32 bb 97  f9 62 f4 a9 18 53 df 15  |...].2...b...S..|
+00000020  03 03 00 16 a4 f2 17 9e  54 f2 b3 28 6a f9 c6 29  |........T..(j..)|
+00000030  47 4c 53 90 e8 7f 33 6e  b2 87                    |GLS...3n..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce
index a204342ca1..1b08053918 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 36 00 05 00 05  01 00 00 00 00 00 0a 00  |...6............|
-00000060  08 00 06 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
-00000070  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
-00000080  03 ff 01 00 01 00 00 12  00 00                    |..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 b1 2d bf 39 08  |....Y...U...-.9.|
-00000010  8f b0 b4 b1 11 41 7d 31  11 94 b1 11 39 8a b0 65  |.....A}1....9..e|
-00000020  8c 7f 15 5d 55 4f 17 09  72 73 3b 20 90 89 57 a3  |...]UO..rs; ..W.|
-00000030  ee 59 22 41 14 89 62 ff  9c 58 0a 28 ec f8 03 c6  |.Y"A..b..X.(....|
-00000040  ce 82 da 2f fb 09 e1 1a  85 86 3f b6 c0 2f 00 00  |.../......?../..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 24 2e 0a 13 97  |....Y...U..$....|
+00000010  5a ca f1 1f 61 58 9e ab  ab ab e2 02 c6 12 36 44  |Z...aX........6D|
+00000020  e5 0b a4 9d 87 95 71 9f  8d af e1 20 fa 6b 55 37  |......q.... .kU7|
+00000030  1f 17 a4 3b 24 9c 4f d8  f9 e1 0d 15 a0 2a d2 db  |...;$.O......*..|
+00000040  41 eb 9e 43 9d 59 61 24  27 28 df fc c0 2f 00 00  |A..C.Ya$'(.../..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,19 +53,19 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  cd 0c 00 00 c9 03 00 17  41 04 4d ee 13 e9 3f 0c  |........A.M...?.|
-000002d0  e8 d2 d7 73 ee 01 96 4b  18 b0 22 8b f3 ec a2 40  |...s...K.."....@|
-000002e0  6c 01 d1 64 a9 94 80 13  89 f8 12 54 63 ac 51 e2  |l..d.......Tc.Q.|
-000002f0  93 3a 1a 72 a0 17 1c c3  df a6 d0 ee 86 c9 b4 02  |.:.r............|
-00000300  ee f4 cc 8e f0 ca 6a 18  26 b2 04 01 00 80 3c 77  |......j.&.....<w|
-00000310  7f 22 0a 17 16 ad fa 41  ee af 44 be 2b b2 f5 c1  |.".....A..D.+...|
-00000320  2c 55 08 c4 48 30 e9 a2  c9 b7 39 a3 6f 91 6d bf  |,U..H0....9.o.m.|
-00000330  7e ff 1b be 6a 16 97 b5  57 12 cd 7f 6f c7 64 18  |~...j...W...o.d.|
-00000340  07 f9 66 81 d5 21 46 04  7b 0e 23 6c d8 48 25 da  |..f..!F.{.#l.H%.|
-00000350  64 e8 7b 4d db 75 41 97  b6 ae 6d d8 8c ad 43 38  |d.{M.uA...m...C8|
-00000360  6d fd df 09 7e 3a 91 67  e8 20 f0 fb cc 55 05 47  |m...~:.g. ...U.G|
-00000370  76 e9 ad 35 bd 1e a6 ac  8f 76 24 17 07 4a b3 46  |v..5.....v$..J.F|
-00000380  b9 06 51 ba c2 e1 19 f7  60 e8 a2 37 7f 38 16 03  |..Q.....`..7.8..|
+000002c0  cd 0c 00 00 c9 03 00 17  41 04 9d 0b 44 e7 57 91  |........A...D.W.|
+000002d0  5f 24 93 7d cb f4 5a 8c  66 1f 55 ba fb 7e 95 47  |_$.}..Z.f.U..~.G|
+000002e0  58 65 b6 df d5 67 11 fe  98 39 c1 5d 39 fd ab 48  |Xe...g...9.]9..H|
+000002f0  17 19 78 15 22 ee a9 41  b2 e7 3f 0c 08 23 8d b5  |..x."..A..?..#..|
+00000300  77 b8 b4 aa 94 e3 1e cb  6e 31 04 01 00 80 c2 6d  |w.......n1.....m|
+00000310  39 91 f4 54 ef c0 73 8c  d2 cd 37 c8 b6 74 8c 12  |9..T..s...7..t..|
+00000320  87 bb 68 fb ac f1 ae a2  01 ed 1f 55 90 1f fb 92  |..h........U....|
+00000330  d3 a8 c3 ac 19 7e bf b6  e9 2e 2f 1d bd 4a fa 17  |.....~..../..J..|
+00000340  1e dc dd 41 c6 8d d4 3f  2d c3 13 0d d0 86 6f 8e  |...A...?-.....o.|
+00000350  74 5a 51 47 6e f2 18 f8  e2 ba de 75 1a 81 1c 3b  |tZQGn......u...;|
+00000360  f0 dc ab d8 5d 7a da 6e  91 d3 e5 f0 82 c3 be c9  |....]z.n........|
+00000370  c8 f0 c9 60 84 6f c3 59  7f 6b 7a b2 58 72 6b 79  |...`.o.Y.kz.Xrky|
+00000380  44 cc 04 82 86 ad 93 de  d1 11 c1 a4 be cd 16 03  |D...............|
 00000390  03 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
@@ -73,174 +73,175 @@
 00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 5d 8e  |.....(........].|
-00000060  8b 30 57 0c 31 ba 2e 8c  64 08 cb c8 71 1f 54 5e  |.0W.1...d...q.T^|
-00000070  76 2c 2f 47 b7 c7 59 c3  6b 38 54 57 f5 94        |v,/G..Y.k8TW..|
+00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 37 ca  |.....(........7.|
+00000060  4e 62 c8 3d 33 b1 2c 57  fd 47 b0 78 5f e3 ac ee  |Nb.=3.,W.G.x_...|
+00000070  ae 3d ad 74 a8 2c ee b1  e8 b7 ff 6f 35 c7        |.=.t.,.....o5.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 9d 6f 70 fb 5a  |..........(.op.Z|
-00000010  30 03 85 32 65 6a 5c f6  31 ec ec b7 55 c3 ce ca  |0..2ej\.1...U...|
-00000020  5f de e8 88 41 8b b7 fe  70 5f a6 26 9c c8 05 3b  |_...A...p_.&...;|
-00000030  12 1c c9                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 28 6b be a8 12 9c  |..........(k....|
+00000010  7f 20 af 07 a8 dd e0 c7  bc 45 b1 ba 32 c1 df 3e  |. .......E..2..>|
+00000020  d5 a1 a8 56 1b 1a 69 d1  ac c7 bc 75 79 f7 6a ce  |...V..i....uy.j.|
+00000030  83 22 78                                          |."x|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 9f f3 ae  |................|
-00000010  52 28 f7 2d 97 66 99 5a  88 28 57 38 e8 cb fa 8a  |R(.-.f.Z.(W8....|
-00000020  10 a1 1d                                          |...|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 40 90 1f  |.............@..|
+00000010  c0 46 3a 8b af a2 54 69  9d 90 90 49 da ad ff 53  |.F:...Ti...I...S|
+00000020  91 e7 65                                          |..e|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 1c 9d 6f 70  fb 5a 30 03 86 91 c2 89  |......op.Z0.....|
-00000010  e1 83 c8 97 d1 78 3a 89  06 4e 84 72 19 37 6e f7  |.....x:..N.r.7n.|
-00000020  3d                                                |=|
+00000000  16 03 03 00 1c 6b be a8  12 9c 7f 20 b0 28 6b 34  |.....k..... .(k4|
+00000010  63 e8 5e 88 ef f0 79 bb  af 67 f6 f7 08 fe 7f d5  |c.^...y..g......|
+00000020  5c                                                |\|
 >>> Flow 7 (client to server)
-00000000  16 03 03 00 a9 00 00 00  00 00 00 00 02 3b 3a be  |.............;:.|
-00000010  88 d7 e7 0b d7 b4 7e c2  da 07 75 b9 0f 20 97 38  |......~...u.. .8|
-00000020  5d d1 d8 9a 33 25 4c 1a  10 f8 28 c4 d1 b0 bc f4  |]...3%L...(.....|
-00000030  b2 c4 4d d2 0e f6 8c ea  52 20 e0 09 10 59 a4 bc  |..M.....R ...Y..|
-00000040  f8 db a6 eb e5 bd 40 c0  b8 fb 52 b1 20 29 b1 06  |......@...R. )..|
-00000050  8f 2b 00 1f ef 29 33 c9  55 45 00 ec 24 37 d1 0e  |.+...)3.UE..$7..|
-00000060  da e9 32 8f b2 7a 2b 2a  a5 ec 2d c9 84 2a 8e fa  |..2..z+*..-..*..|
-00000070  ee 3b 84 3e c0 04 f9 f5  ea 64 17 ad 14 4d 40 1a  |.;.>.....d...M@.|
-00000080  df cf 02 bd f8 b1 d9 91  89 14 d7 12 3c b6 29 d1  |............<.).|
-00000090  9c 7a 5c 40 d0 b3 37 ab  0f ce 63 b6 c8 ef f3 51  |.z\@..7...c....Q|
-000000a0  0c 9b 42 3b 78 67 1e a8  f6 c6 ba 9f 0f af        |..B;xg........|
+00000000  16 03 03 00 af 00 00 00  00 00 00 00 02 01 a6 70  |...............p|
+00000010  01 49 e5 57 72 ad db 39  c6 d6 63 27 9a 8b d3 13  |.I.Wr..9..c'....|
+00000020  06 15 ef ea 59 6c eb e4  a4 e3 7d 98 84 b9 60 6f  |....Yl....}...`o|
+00000030  f9 ad 01 a1 20 e0 43 a4  58 c8 c6 da f4 1c 06 2c  |.... .C.X......,|
+00000040  51 1a 70 b7 d2 8b ed c3  f7 ce f4 17 e5 82 d2 3e  |Q.p............>|
+00000050  1e f0 23 62 60 2e 21 b3  5b 99 ac b8 f6 11 40 fb  |..#b`.!.[.....@.|
+00000060  b9 51 17 ac ab ac b4 ff  f9 b0 27 d3 a8 2e 41 4f  |.Q........'...AO|
+00000070  fe e3 64 3c bd 34 6a e1  18 64 bd 5f 24 b4 3b 57  |..d<.4j..d._$.;W|
+00000080  4e 4e 8e a0 b0 3d 50 e3  b0 d2 bc 45 d7 84 4f 11  |NN...=P....E..O.|
+00000090  fd 6a 52 0d a9 36 9f 0e  57 4f 43 24 50 12 b8 ba  |.jR..6..WOC$P...|
+000000a0  b4 30 4f 21 3d de 56 af  3d 6d 07 32 b9 4c 32 95  |.0O!=.V.=m.2.L2.|
+000000b0  c6 eb 6c a6                                       |..l.|
 >>> Flow 8 (server to client)
-00000000  16 03 03 00 89 9d 6f 70  fb 5a 30 03 87 a9 75 2a  |......op.Z0...u*|
-00000010  3d 50 4f 91 c7 13 b7 37  80 ce 5d f7 5d e6 aa ca  |=PO....7..].]...|
-00000020  fc f3 81 ef 96 0e 92 dc  07 37 92 c8 13 4d 74 5d  |.........7...Mt]|
-00000030  54 e5 c8 53 8e 06 75 03  71 fa 95 87 67 f7 29 a5  |T..S..u.q...g.).|
-00000040  58 69 b6 9f 9c b3 16 bf  89 a1 68 e9 36 e7 51 80  |Xi........h.6.Q.|
-00000050  8d 48 5d cd 00 7a 84 8e  ca 74 39 30 64 1b 46 41  |.H]..z...t90d.FA|
-00000060  a5 ae c7 e7 dd 64 46 8f  a9 4e 33 86 ea 8a 1c 88  |.....dF..N3.....|
-00000070  d3 98 38 01 c3 a2 8b 29  c8 44 f3 41 6a fd ff 5a  |..8....).D.Aj..Z|
-00000080  41 70 21 b0 c1 92 be be  e0 53 0f 82 10 20 16 03  |Ap!......S... ..|
-00000090  03 02 71 9d 6f 70 fb 5a  30 03 88 78 ad b5 80 aa  |..q.op.Z0..x....|
-000000a0  65 5d 33 f4 2c 82 16 ce  e2 12 13 b8 42 6c 9a fc  |e]3.,.......Bl..|
-000000b0  56 44 e7 d9 5e 15 04 7c  6b 03 a1 00 50 6b 4e e6  |VD..^..|k...PkN.|
-000000c0  e7 1a 68 5b 3d cc 2e d0  fc 41 3f ee 62 5c 30 6d  |..h[=....A?.b\0m|
-000000d0  92 db 24 f3 28 ed fe 59  11 2a 98 58 d7 5d b8 9c  |..$.(..Y.*.X.]..|
-000000e0  c7 14 ac 82 17 15 22 ff  5f 5e fb dc 66 00 8e 59  |......"._^..f..Y|
-000000f0  3e 40 32 f4 e2 e9 20 96  be 48 3e 5b e0 bf e0 d4  |>@2... ..H>[....|
-00000100  f2 bf d8 73 65 6b 2b a5  a7 cd 30 d8 76 ab f7 f7  |...sek+...0.v...|
-00000110  5d 4d 68 75 a3 db 2a 75  d2 8f 15 b1 d6 8b 63 d4  |]Mhu..*u......c.|
-00000120  ed d3 43 9f 1e 72 ff cb  14 e1 84 b2 a2 e0 6b 97  |..C..r........k.|
-00000130  5b 59 44 24 72 87 4f f6  3c d0 0a ca 5c 93 50 6b  |[YD$r.O.<...\.Pk|
-00000140  dd 30 42 c5 e6 f6 5f 23  5b 0f 56 16 c3 a5 a6 61  |.0B..._#[.V....a|
-00000150  72 f4 35 21 09 85 7b 52  51 81 ad aa cf 09 2a db  |r.5!..{RQ.....*.|
-00000160  aa 02 eb 86 49 79 7e da  02 96 4b 82 87 4b 84 54  |....Iy~...K..K.T|
-00000170  d2 6e a6 38 f3 2a e8 0e  e8 86 18 48 b9 ca 0f 40  |.n.8.*.....H...@|
-00000180  83 54 a4 e0 d7 63 27 21  e3 b3 f8 dc 19 18 7b 1c  |.T...c'!......{.|
-00000190  0a c0 76 f0 c9 fa 0f 85  e0 7e a9 81 a4 a8 72 70  |..v......~....rp|
-000001a0  31 8a 8e 7b 27 36 e6 9e  9a 1a 28 9e 21 d2 28 d4  |1..{'6....(.!.(.|
-000001b0  80 c2 cf ba 7d 02 e8 8b  c5 ce f5 68 21 d7 7a 88  |....}......h!.z.|
-000001c0  20 d3 be ea 90 82 cb c5  63 60 3d d7 75 30 48 a7  | .......c`=.u0H.|
-000001d0  dc 9b c6 39 78 48 b5 13  41 6d 7c 4a 87 06 1a 95  |...9xH..Am|J....|
-000001e0  3c e0 63 9c 9b 36 5c 5a  c0 8e af 74 11 81 ae cf  |<.c..6\Z...t....|
-000001f0  e5 8a 9a 2f 51 e3 70 fb  32 e2 6c 1b 5c 0c 25 e6  |.../Q.p.2.l.\.%.|
-00000200  87 50 6a 94 cc 16 53 a1  16 13 72 3d 8b ea 8d 34  |.Pj...S...r=...4|
-00000210  72 17 c2 16 cd d4 78 de  6c 03 06 4c b5 88 86 00  |r.....x.l..L....|
-00000220  85 f7 37 77 ff 8f 2e 11  12 87 b6 c0 86 c1 9c 7c  |..7w...........||
-00000230  a6 79 af a2 c7 9f e3 54  3d 62 c3 76 2b 8c 36 7a  |.y.....T=b.v+.6z|
-00000240  92 33 d7 ff d5 3e b0 5d  4d 75 a0 ac 73 f5 67 79  |.3...>.]Mu..s.gy|
-00000250  f1 86 06 cb 82 c3 e1 46  95 62 2b 5d 7c 9e b4 17  |.......F.b+]|...|
-00000260  92 7a a5 5b 49 f8 b4 26  e7 64 45 62 0c a6 a4 48  |.z.[I..&.dEb...H|
-00000270  6d 67 04 44 96 bd fa 23  96 8b 25 3c e7 cf 48 d7  |mg.D...#..%<..H.|
-00000280  c5 24 4e fe 3e 20 0e 72  dd a4 2c 6d 16 cb d2 47  |.$N.> .r..,m...G|
-00000290  be 54 6b 68 44 7b cd d4  74 b6 bc 4d e2 10 c0 2b  |.TkhD{..t..M...+|
-000002a0  30 69 84 c4 25 29 eb f9  4e cd 7b d7 72 ad d9 f2  |0i..%)..N.{.r...|
-000002b0  10 47 16 fe c8 0d 16 a1  08 93 d7 33 a6 24 bd cf  |.G.........3.$..|
-000002c0  80 cf 9f 50 68 fb c7 e9  88 8d 23 c6 b6 37 3b e7  |...Ph.....#..7;.|
-000002d0  a3 c3 92 43 5d 04 6c 2e  55 3c 99 53 b1 4c 1b d8  |...C].l.U<.S.L..|
-000002e0  18 ab 1f 19 b9 18 c6 59  b0 bd b7 b8 37 6d 8c 2c  |.......Y....7m.,|
-000002f0  0a 25 8a 32 99 84 03 ca  8c 77 a6 bb 39 28 3a c0  |.%.2.....w..9(:.|
-00000300  83 a8 73 42 16 03 03 00  e5 9d 6f 70 fb 5a 30 03  |..sB......op.Z0.|
-00000310  89 37 6f a7 81 31 d2 16  86 2b 48 dc 9c 21 0a 02  |.7o..1...+H..!..|
-00000320  29 47 ba 57 5f 22 fd 90  86 c1 f0 70 68 1a 37 3b  |)G.W_".....ph.7;|
-00000330  c0 70 28 b8 10 3d 78 e8  58 6f 09 ce aa bc 2a 51  |.p(..=x.Xo....*Q|
-00000340  d6 70 9b fe f4 18 4d bd  5f ed ff bd fc dd 9e 30  |.p....M._......0|
-00000350  21 8a 49 bf ea 16 8e 42  1e da b1 8a a3 86 30 14  |!.I....B......0.|
-00000360  14 f8 32 0e 5d dc f3 cf  25 cb 1b f1 a1 42 4b 96  |..2.]...%....BK.|
-00000370  ca 8f 91 3a 0a 85 14 5f  39 f4 8d 4d 8d 15 40 04  |...:..._9..M..@.|
-00000380  0a 9b 23 e3 be 40 8d 2c  a8 8a 29 49 ab be 4f 38  |..#..@.,..)I..O8|
-00000390  a3 8f bd bc 76 85 4e 5c  06 4c 5d 31 67 15 7d 7c  |....v.N\.L]1g.}||
-000003a0  66 c5 7c 90 97 90 fa a9  fe 4f fd 04 ba 10 f3 8e  |f.|......O......|
-000003b0  0b ff 22 fc 26 56 ac 49  79 e1 24 9a 62 59 d7 d8  |..".&V.Iy.$.bY..|
-000003c0  25 d7 74 7c 84 dd 4f 35  44 19 ba 2e ba 1f c1 db  |%.t|..O5D.......|
-000003d0  53 f2 d3 3a f6 d4 bb a4  96 9a 67 fd d6 bc 3b 2c  |S..:......g...;,|
-000003e0  19 40 fe 2e 15 20 16 69  da f4 e5 c9 f3 3c 16 03  |.@... .i.....<..|
-000003f0  03 00 46 9d 6f 70 fb 5a  30 03 8a 9e 8f 94 1e e4  |..F.op.Z0.......|
-00000400  80 58 f2 84 8b 45 38 41  ab 31 b1 1f b1 bc 4b 3c  |.X...E8A.1....K<|
-00000410  ec a1 ec f7 4b 7c 3c 0d  93 80 94 92 90 3a 11 e8  |....K|<......:..|
-00000420  7b e9 0f 3b c3 a4 2d c6  2e 09 71 9e 4c ea be 4b  |{..;..-...q.L..K|
-00000430  61 2f bd 55 58 47 f3 89  57                       |a/.UXG..W|
+00000000  16 03 03 00 89 6b be a8  12 9c 7f 20 b1 ac ca 6b  |.....k..... ...k|
+00000010  51 a3 1e 19 95 56 8f 88  ee 40 fa 47 7d f6 30 29  |Q....V...@.G}.0)|
+00000020  2f 26 4c 22 04 41 07 76  f1 3a 1b b0 98 46 93 36  |/&L".A.v.:...F.6|
+00000030  d8 02 bd b9 82 f4 34 4f  7e 45 10 4e 14 53 31 c7  |......4O~E.N.S1.|
+00000040  3e 1e 74 f3 29 5e cf 77  39 76 9e 00 fd 1f 2a 3c  |>.t.)^.w9v....*<|
+00000050  63 b1 fa c7 a6 31 a4 76  ea e8 95 af 5a 56 fc 23  |c....1.v....ZV.#|
+00000060  03 15 0a 79 14 fd 6c 83  0b 82 db 6a 1d a4 c1 19  |...y..l....j....|
+00000070  9d 3c 3d ea e2 f1 04 82  6c b3 27 00 3b 51 8d 74  |.<=.....l.'.;Q.t|
+00000080  86 b6 d0 d7 81 f3 da 0d  bf bf bd 57 c3 a9 16 03  |...........W....|
+00000090  03 02 71 6b be a8 12 9c  7f 20 b2 3d 86 e6 bb 0e  |..qk..... .=....|
+000000a0  35 57 79 c3 ea 0a 90 cf  0f ef 36 9f 3f 1f f8 de  |5Wy.......6.?...|
+000000b0  56 2e f5 b8 8c a7 ac 59  cb 59 dc ec c1 ae d4 22  |V......Y.Y....."|
+000000c0  25 2f 53 c9 d1 e0 fc 94  9f b6 ef a5 21 6e 90 11  |%/S.........!n..|
+000000d0  04 48 6a a6 ca 00 78 7d  ff 87 cd 04 0b 01 9a da  |.Hj...x}........|
+000000e0  c6 90 cd 24 fe cb 83 5a  9a 4d 3a 1d 90 a2 49 ca  |...$...Z.M:...I.|
+000000f0  3a 50 98 c1 68 36 d8 b9  4e 3e 2b c9 9e a9 1a a3  |:P..h6..N>+.....|
+00000100  95 b3 d7 cd b7 83 58 5f  a2 a1 1d ee e4 89 be ab  |......X_........|
+00000110  1f f0 36 13 1d 69 22 60  e1 1b d7 0b b7 3d 32 4a  |..6..i"`.....=2J|
+00000120  43 3e 77 16 42 ff 42 2c  55 7c 62 14 37 21 23 88  |C>w.B.B,U|b.7!#.|
+00000130  e1 e3 34 4a 6f 1e d9 b4  ca ca 95 10 4b 0b fc 4a  |..4Jo.......K..J|
+00000140  57 be e8 cf e1 2c c7 09  68 0b b3 a1 cf 6f f4 d6  |W....,..h....o..|
+00000150  ea bf d9 a4 95 40 e4 4b  54 59 02 8f 00 48 28 42  |.....@.KTY...H(B|
+00000160  3c 51 8e 6b 61 b8 2e 9a  8a ad c1 2e 0c 32 6a b1  |<Q.ka........2j.|
+00000170  bb de 29 3e 41 5f d9 c7  e3 ad 59 60 cb ae 63 95  |..)>A_....Y`..c.|
+00000180  82 c6 de 53 bd 90 a8 0b  f3 68 36 68 82 40 86 53  |...S.....h6h.@.S|
+00000190  a9 4c 7b f3 f4 ae 98 a4  4b fb fd a7 5b 81 f0 dc  |.L{.....K...[...|
+000001a0  ad dc a6 e2 90 8a 4e 8c  61 8d 6f cc 29 c4 5d 05  |......N.a.o.).].|
+000001b0  9b 99 0a df a1 e2 dd a0  f6 4e e1 54 4f 7f a7 73  |.........N.TO..s|
+000001c0  6c ec cc 31 f8 fe aa f3  e7 ce a0 7c 67 74 25 f5  |l..1.......|gt%.|
+000001d0  ba a4 33 92 2a c1 51 b2  0c 31 ea 6f 80 18 13 3c  |..3.*.Q..1.o...<|
+000001e0  0a b1 b2 8b bc 1b fd 6e  4c 84 2d 42 95 15 5c 73  |.......nL.-B..\s|
+000001f0  9b 06 c5 4a dd f5 59 f4  28 c0 d5 40 26 03 a1 d1  |...J..Y.(..@&...|
+00000200  13 03 67 23 78 c0 c5 02  8e 42 0d 98 60 3c c9 9e  |..g#x....B..`<..|
+00000210  49 86 1a a1 6e d1 3a 66  3a 13 15 37 d3 e8 ca d0  |I...n.:f:..7....|
+00000220  ee 2e 17 1b 37 6a dd 00  c3 b2 e8 9c 0d 91 d2 3e  |....7j.........>|
+00000230  3f cd 6d e3 f1 5c 45 30  94 be cf 65 54 c5 66 26  |?.m..\E0...eT.f&|
+00000240  e0 d3 46 9f f2 ba 67 30  90 c0 1b 58 05 1c 98 b1  |..F...g0...X....|
+00000250  8a a6 02 5c 5a f1 ec a0  d2 74 71 4c a3 15 f8 a7  |...\Z....tqL....|
+00000260  34 d6 9c dd 31 b1 5e 4e  97 7f 1d c5 31 7f c1 cb  |4...1.^N....1...|
+00000270  8b 3c 88 6a 96 71 a0 a3  8e d8 7a 0a ed 67 f5 04  |.<.j.q....z..g..|
+00000280  1d 47 ab db bf 3e f6 f6  c8 6e 55 6f e9 9a bf b4  |.G...>...nUo....|
+00000290  8f 8b ac 9c 56 3d e0 37  8d 85 02 06 1e 5b 52 d3  |....V=.7.....[R.|
+000002a0  ba 75 70 33 da c0 d9 77  a1 59 30 75 a1 6f 4e dc  |.up3...w.Y0u.oN.|
+000002b0  ba da 4d 7b bc b5 8d b5  74 6a bc 64 82 d5 cf 41  |..M{....tj.d...A|
+000002c0  88 dc 0a 6c 9b 36 46 5b  e9 2e 62 b7 1a 44 57 6f  |...l.6F[..b..DWo|
+000002d0  e7 28 bc 47 91 25 2e 56  d6 08 df c0 b5 9e ee fe  |.(.G.%.V........|
+000002e0  bd c5 cf f4 94 ab 03 30  8d a9 a7 d0 eb b8 a4 96  |.......0........|
+000002f0  dd 58 35 4f 4e fb 49 11  39 e3 a3 46 06 0b 2a f2  |.X5ON.I.9..F..*.|
+00000300  d9 29 08 1c 16 03 03 00  e5 6b be a8 12 9c 7f 20  |.).......k..... |
+00000310  b3 5a a8 60 49 b5 0f 3d  50 bf 81 17 ca 25 2d 91  |.Z.`I..=P....%-.|
+00000320  07 bd 01 ef bc 13 df 67  50 c4 7d aa 87 af b4 30  |.......gP.}....0|
+00000330  95 08 a9 1a 86 f2 60 d9  85 28 11 1c 3c 31 81 5d  |......`..(..<1.]|
+00000340  3c 83 b0 3c 0d 59 11 8b  3b d6 76 f4 64 98 d2 4c  |<..<.Y..;.v.d..L|
+00000350  09 f5 fc 4a 43 d6 e8 5c  c5 f7 ed c2 7f 35 df 96  |...JC..\.....5..|
+00000360  3d ca a8 59 58 e4 22 c7  58 99 40 ee c7 71 fb 8d  |=..YX.".X.@..q..|
+00000370  14 14 42 db 12 fa a8 0e  9f 45 d3 29 73 7f bf a0  |..B......E.)s...|
+00000380  20 30 8f 2f 93 f1 45 44  3a 30 28 4a fd 5b 49 49  | 0./..ED:0(J.[II|
+00000390  46 6d 71 ef b7 77 7d 83  0a 62 a0 82 d3 4d c1 69  |Fmq..w}..b...M.i|
+000003a0  7b 79 a6 92 79 4d 6b 6d  f3 e7 e3 75 c0 30 b3 83  |{y..yMkm...u.0..|
+000003b0  b9 d4 1d 0b 23 18 e6 79  87 c7 af 3e 18 23 2f 6e  |....#..y...>.#/n|
+000003c0  95 12 54 8a fb 9f 9f c0  df f9 9e 06 67 a0 d7 85  |..T.........g...|
+000003d0  71 56 8a 52 1c aa 3a 3f  9e 5e bb 25 16 7d ef 8e  |qV.R..:?.^.%.}..|
+000003e0  58 fd 83 7b be 8e e4 d5  26 53 3e 03 f7 67 16 03  |X..{....&S>..g..|
+000003f0  03 00 46 6b be a8 12 9c  7f 20 b4 6e d6 b0 9c 25  |..Fk..... .n...%|
+00000400  b0 f6 49 1e 44 5f 96 3d  72 8c c8 71 9b 0a 15 61  |..I.D_.=r..q...a|
+00000410  f2 0c df 14 1b 59 9b 88  5d f2 04 83 3e 42 56 15  |.....Y..]...>BV.|
+00000420  55 8b 47 13 be f5 7f 61  81 22 c1 32 b7 59 8c 59  |U.G....a.".2.Y.Y|
+00000430  68 a2 be ad e1 05 36 be  22                       |h.....6."|
 >>> Flow 9 (client to server)
-00000000  16 03 03 02 71 00 00 00  00 00 00 00 03 da 01 11  |....q...........|
-00000010  30 c8 d4 1d 30 60 0e cf  6d bc db cb 2b f1 c9 5c  |0...0`..m...+..\|
-00000020  9b 37 d3 f0 3c 50 4d d3  90 99 e1 6c 16 9f 52 07  |.7..<PM....l..R.|
-00000030  ed 0f fa f4 33 cb 5f 53  4f d7 32 36 45 c0 62 db  |....3._SO.26E.b.|
-00000040  d4 0b 49 c4 b9 5f 19 8c  81 d2 1b ee b0 ec 17 22  |..I.._........."|
-00000050  aa 96 ae 82 82 64 c1 77  5a 32 cf 93 04 ed 09 51  |.....d.wZ2.....Q|
-00000060  fe e4 0c 4b 1a 6d 3f ec  67 3b ff ec 3d 67 60 03  |...K.m?.g;..=g`.|
-00000070  91 81 87 f0 40 fd 6e d4  cc 28 1d a9 d8 29 fb 9d  |....@.n..(...)..|
-00000080  a5 f8 f4 fc 74 f4 c1 02  60 96 b6 f4 1c 7d b5 38  |....t...`....}.8|
-00000090  be de 9a 95 d0 c5 94 5c  80 c4 ed 3d b1 d9 06 50  |.......\...=...P|
-000000a0  d7 22 63 dd 2e dd ed 54  ca 87 23 20 83 a6 29 e0  |."c....T..# ..).|
-000000b0  c0 1a a3 5f f9 99 8f 22  4b 29 7d 7b 50 96 a9 1e  |..._..."K)}{P...|
-000000c0  27 f7 f2 64 b2 22 6a 3e  77 a8 92 1d f7 6b 90 9c  |'..d."j>w....k..|
-000000d0  bd bd ac 90 c6 a7 78 e4  0a 42 36 23 45 cb 70 04  |......x..B6#E.p.|
-000000e0  55 8c f7 83 cc fc 31 57  dd 46 a1 f3 08 d3 f1 6e  |U.....1W.F.....n|
-000000f0  e1 6a 8e 52 e4 ca ae 4c  3a 25 28 66 8b eb b6 c7  |.j.R...L:%(f....|
-00000100  ce 51 f9 bc f0 40 ac 86  b6 15 35 c3 2b 14 fd a7  |.Q...@....5.+...|
-00000110  94 9b 47 00 bb e1 90 63  b1 a9 84 b3 0e b8 e8 59  |..G....c.......Y|
-00000120  b2 9f 84 c9 cc 48 46 b0  1c e9 37 2b cd b4 4f 9d  |.....HF...7+..O.|
-00000130  17 0a 96 16 53 54 1d 88  22 81 e9 bd 38 5d d1 79  |....ST.."...8].y|
-00000140  a2 86 7d 95 cd 70 e4 07  d4 83 a5 5c 7d a0 fe 83  |..}..p.....\}...|
-00000150  93 02 50 17 f1 81 01 e0  a4 84 76 09 49 2d 56 fb  |..P.......v.I-V.|
-00000160  76 08 f0 61 da 34 77 d8  d2 7e ef 2f 1b c9 8c 9b  |v..a.4w..~./....|
-00000170  bb df 12 d4 5b b1 2a 59  81 bc 07 dd e9 46 a8 8b  |....[.*Y.....F..|
-00000180  0f fb 69 3d fd 39 db 8b  59 b7 c2 47 9f 51 67 a9  |..i=.9..Y..G.Qg.|
-00000190  d8 43 5c b0 5e 5b 10 12  09 09 f0 5b 50 eb 69 f5  |.C\.^[.....[P.i.|
-000001a0  71 c8 34 20 d5 83 17 a5  0f f7 e0 63 c0 c1 84 47  |q.4 .......c...G|
-000001b0  c1 20 4c 64 38 f4 60 aa  48 30 15 09 f4 b2 2e 94  |. Ld8.`.H0......|
-000001c0  e6 d4 a1 d8 fe 79 4e a7  6f b4 3f 33 0f a1 20 ed  |.....yN.o.?3.. .|
-000001d0  5d 01 35 b5 1f 85 1f 55  c8 10 15 67 b8 a9 03 4a  |].5....U...g...J|
-000001e0  ef 98 3f e3 dd 91 ed b8  89 61 28 26 f4 63 e0 b0  |..?......a(&.c..|
-000001f0  b6 ee 65 8a c9 c2 45 6e  4a 14 57 6f d5 2e 2c f9  |..e...EnJ.Wo..,.|
-00000200  7b 85 f4 da e6 8f c5 09  d3 bf 1d f2 a9 93 97 b8  |{...............|
-00000210  1c 65 5e 7e dc 4b 78 28  24 76 17 6a 6c fd dd 6c  |.e^~.Kx($v.jl..l|
-00000220  8c 36 6e 44 1f 59 cb da  68 89 2c 38 1a 2c b6 2f  |.6nD.Y..h.,8.,./|
-00000230  81 00 76 cf 98 20 00 b6  fa 47 ce f0 f9 1c d8 7a  |..v.. ...G.....z|
-00000240  62 81 79 0d db 7c 2c f6  ba 31 c9 88 b6 b7 f8 e7  |b.y..|,..1......|
-00000250  55 77 63 87 56 48 6f 68  af ed fc 0b f2 11 2f c6  |Uwc.VHoh....../.|
-00000260  d3 cc 6a c5 47 fc f8 c4  8c 54 db 72 93 1b 49 cd  |..j.G....T.r..I.|
-00000270  a5 cd 6f 10 e2 55 16 03  03 00 5e 00 00 00 00 00  |..o..U....^.....|
-00000280  00 00 04 d5 b2 77 db 72  da c0 84 fc 04 7a 8e 4e  |.....w.r.....z.N|
-00000290  2e 25 b0 b8 31 58 e3 dc  07 a6 ea dc 46 08 f9 15  |.%..1X......F...|
-000002a0  1d ab 0f fe 80 c7 3b 78  4b e5 fa 9a 16 c2 30 7c  |......;xK.....0||
-000002b0  74 75 54 93 96 55 e5 60  f8 bf 43 b4 3d 79 13 b1  |tuT..U.`..C.=y..|
-000002c0  bf 33 07 87 3f 3d aa 1e  e9 e5 3b 28 7e 15 84 20  |.3..?=....;(~.. |
-000002d0  08 dc ef df 8d 7d 68 97  8b 16 03 03 00 a0 00 00  |.....}h.........|
-000002e0  00 00 00 00 00 05 f7 40  01 b1 ab ef 0d 91 8d 03  |.......@........|
-000002f0  cb 8e 85 f0 2e 28 bc 63  98 7c 75 b2 08 16 d3 42  |.....(.c.|u....B|
-00000300  6b b4 53 90 77 45 7a e9  ad 6f cb ab 39 55 54 f6  |k.S.wEz..o..9UT.|
-00000310  f0 14 3a 42 a5 30 e0 5f  7e 7a 83 b6 ec 7d 40 a7  |..:B.0._~z...}@.|
-00000320  77 c2 68 de 9c 92 64 b7  03 3e 5e 74 72 cf e5 59  |w.h...d..>^tr..Y|
-00000330  17 5c 6c 43 b6 e8 12 cb  8a 1c e2 09 30 43 a0 c4  |.\lC........0C..|
-00000340  bf 4a 14 90 51 fb 2c c9  f7 9a 50 14 1c 61 7d 83  |.J..Q.,...P..a}.|
-00000350  6d 2e 61 8e ca 4a c3 92  e3 98 c1 57 b3 77 ab ab  |m.a..J.....W.w..|
-00000360  36 33 a2 2a bc eb 2b 04  45 92 b4 2f ff 19 68 6a  |63.*..+.E../..hj|
-00000370  13 a0 79 47 3c 8e db b0  dd 63 1b 80 39 a0 14 03  |..yG<....c..9...|
-00000380  03 00 19 00 00 00 00 00  00 00 06 41 5a 21 fa 4b  |...........AZ!.K|
-00000390  e3 b0 b8 55 3e 97 e6 70  8e 7e ea 05 16 03 03 00  |...U>..p.~......|
-000003a0  28 00 00 00 00 00 00 00  00 4d 4a 88 64 f5 5e 9e  |(........MJ.d.^.|
-000003b0  2f 8c 5a fe 95 b2 8f 8c  3f 7d b2 03 6a b1 39 72  |/.Z.....?}..j.9r|
-000003c0  f8 8f 6c 0a 07 c1 6c 47  f8                       |..l...lG.|
+00000000  16 03 03 02 71 00 00 00  00 00 00 00 03 d8 60 1e  |....q.........`.|
+00000010  b5 63 15 89 4b 48 76 a0  68 68 ff 3e eb 36 e8 05  |.c..KHv.hh.>.6..|
+00000020  e4 fb 3d 35 94 88 93 9f  aa f5 30 3f cf 6a 3f fc  |..=5......0?.j?.|
+00000030  1e c4 bd 71 d8 e9 de 64  92 d0 0f 49 70 f5 1b 3e  |...q...d...Ip..>|
+00000040  ac 8f 00 53 3b d7 65 b8  ef 95 80 29 9f 59 f4 3e  |...S;.e....).Y.>|
+00000050  a5 cc 35 00 b1 04 ef 0b  79 d2 22 39 0c 1e 07 96  |..5.....y."9....|
+00000060  a6 d1 01 18 2f 38 a7 96  c5 e6 5b 3d f4 04 f9 92  |..../8....[=....|
+00000070  b1 1d 4d 4c a6 50 5c dd  28 f9 41 25 9d 05 90 7d  |..ML.P\.(.A%...}|
+00000080  3f da 37 c8 92 45 ff 18  e6 79 da ee 32 e1 0c ff  |?.7..E...y..2...|
+00000090  36 d8 ee ea e8 04 0b ad  7e 9f e7 53 9d b9 10 91  |6.......~..S....|
+000000a0  02 69 71 b0 2d 9a 67 0c  75 27 48 16 db 0c 41 68  |.iq.-.g.u'H...Ah|
+000000b0  4d 50 5b 24 c4 2d 94 54  23 9b ff 8c fc 40 28 45  |MP[$.-.T#....@(E|
+000000c0  22 a6 75 1b d8 82 07 61  33 d7 69 4b 7b 97 c2 70  |".u....a3.iK{..p|
+000000d0  a2 30 93 7a 4f 66 13 03  d3 9a 5d ee f9 74 7e 26  |.0.zOf....]..t~&|
+000000e0  46 31 0f c6 27 42 ba f9  ea 4d 30 37 4e 22 3f 20  |F1..'B...M07N"? |
+000000f0  79 4d 0b a1 55 dd 72 45  2f af 17 d0 d7 19 22 93  |yM..U.rE/.....".|
+00000100  4e 15 50 01 df 69 79 82  c6 35 a4 30 4e ca 1f d8  |N.P..iy..5.0N...|
+00000110  06 c9 f2 03 3c a1 95 3e  18 e9 6c 46 2e fc 61 b4  |....<..>..lF..a.|
+00000120  90 6f 07 70 dc 9f eb a8  f1 a5 5e ed 07 26 24 e9  |.o.p......^..&$.|
+00000130  6f ee 34 39 03 e0 2d da  b2 bf e2 b7 8a 89 d4 49  |o.49..-........I|
+00000140  b6 40 56 81 59 b6 81 6a  a9 92 71 f7 f3 16 c8 cc  |.@V.Y..j..q.....|
+00000150  da bb 7f 54 fd 5f 6d 36  52 f6 da f5 2b fa 3d 1b  |...T._m6R...+.=.|
+00000160  05 4c a7 04 0d 0b 04 6c  73 8a 22 c2 3b 4b e6 12  |.L.....ls.".;K..|
+00000170  7e 0d 7c 4e c1 20 4d d8  fd e9 3b 8a 38 33 7d e2  |~.|N. M...;.83}.|
+00000180  10 9b 38 40 4c 50 c9 82  53 4d c3 da cf 6c 13 45  |..8@LP..SM...l.E|
+00000190  0e cc 89 bf 1f ae 83 06  2b 09 c0 69 7e 72 23 e3  |........+..i~r#.|
+000001a0  c9 8f 45 d4 fa 19 98 f3  c8 a1 d7 15 a4 e6 08 9b  |..E.............|
+000001b0  83 3f fd b5 7d 8f b1 b4  e4 5f 87 01 a0 e3 27 6a  |.?..}...._....'j|
+000001c0  e1 59 7c 46 0d eb 7c a3  ba e6 95 ad de f2 5b 72  |.Y|F..|.......[r|
+000001d0  61 c6 a6 14 31 f9 3b 03  d8 62 88 0e 44 78 b3 0f  |a...1.;..b..Dx..|
+000001e0  78 5e b7 63 58 3c c5 ae  2c 0c 3d 8e 38 84 dc 29  |x^.cX<..,.=.8..)|
+000001f0  c1 d0 1c 8d e7 97 8c 29  7a c3 82 02 6b 1f c0 0d  |.......)z...k...|
+00000200  c4 a0 fa 58 3a 2c e0 d4  7a 50 16 d6 ac d7 ef db  |...X:,..zP......|
+00000210  a6 56 7b eb 5b 82 c7 98  73 8d d6 64 ed 5b ae e7  |.V{.[...s..d.[..|
+00000220  c6 20 38 80 ca d1 39 36  d8 e9 4f 88 e1 ec f9 5c  |. 8...96..O....\|
+00000230  37 44 85 22 f2 ea fb 2e  e5 1c e3 e7 c7 7b 89 3f  |7D.".........{.?|
+00000240  b1 ce 79 cb f6 a6 9e e1  93 a2 00 d8 92 74 e9 b5  |..y..........t..|
+00000250  f8 42 a4 db e4 c8 20 66  aa 7c 07 c4 51 47 a1 93  |.B.... f.|..QG..|
+00000260  30 44 2d 76 31 96 57 c6  d8 56 0b 86 ec 60 04 12  |0D-v1.W..V...`..|
+00000270  df e1 bd 08 a3 12 16 03  03 00 5e 00 00 00 00 00  |..........^.....|
+00000280  00 00 04 07 11 86 09 09  10 67 9a 92 bc a2 c2 e0  |.........g......|
+00000290  61 ae 42 88 0f 6f b5 ac  ce 12 2f 50 c2 df 68 28  |a.B..o..../P..h(|
+000002a0  b6 cf 3b 96 8a 5e 24 e4  89 24 61 0e ed e7 7e 62  |..;..^$..$a...~b|
+000002b0  4c 0d 16 75 53 d1 aa 18  78 5b bd c6 86 3b cd 75  |L..uS...x[...;.u|
+000002c0  bb 79 d0 03 58 b6 88 db  5b 65 1c be 07 c3 e0 87  |.y..X...[e......|
+000002d0  82 3f 63 0f 69 7c 51 db  14 16 03 03 00 a0 00 00  |.?c.i|Q.........|
+000002e0  00 00 00 00 00 05 ce ef  43 c5 92 c0 7a 3a 52 58  |........C...z:RX|
+000002f0  b1 2d c5 1a 81 64 28 de  85 30 d2 ce c0 cc cd f5  |.-...d(..0......|
+00000300  63 ae 2c 0d 83 4b 4f 18  b3 bb 56 1a 2f fb 2a 9b  |c.,..KO...V./.*.|
+00000310  cd 95 2b 3d 97 76 61 41  00 30 90 8c 3c f0 ed 2d  |..+=.vaA.0..<..-|
+00000320  be 10 6e e9 4f df 0a ba  63 63 8d 57 8f 67 b5 d0  |..n.O...cc.W.g..|
+00000330  f7 18 34 5d c1 a1 c2 b2  6a aa c3 86 1e d0 e9 9b  |..4]....j.......|
+00000340  a6 52 81 09 3d 57 df f2  e7 ff a0 68 69 bc a0 2c  |.R..=W.....hi..,|
+00000350  64 c3 fe 19 5b 34 86 94  60 d2 ef 7e 7e 9b 80 2b  |d...[4..`..~~..+|
+00000360  09 65 58 02 7c a8 34 31  de 40 0c 56 12 34 5f 95  |.eX.|.41.@.V.4_.|
+00000370  42 77 06 fb fb 94 e5 15  7a 0c 09 17 47 d2 14 03  |Bw......z...G...|
+00000380  03 00 19 00 00 00 00 00  00 00 06 91 c8 31 cf f8  |.............1..|
+00000390  95 ed 07 68 c4 1c 39 2c  33 16 1f e8 16 03 03 00  |...h..9,3.......|
+000003a0  28 00 00 00 00 00 00 00  00 24 86 17 13 83 e0 8d  |(........$......|
+000003b0  cf d0 3a e7 66 18 f0 4c  53 16 a1 77 6d ab 65 b9  |..:.f..LS..wm.e.|
+000003c0  8d 12 cc 5b 4b f6 29 df  17                       |...[K.)..|
 >>> Flow 10 (server to client)
-00000000  14 03 03 00 19 9d 6f 70  fb 5a 30 03 8b 92 a9 3a  |......op.Z0....:|
-00000010  32 29 a8 40 23 2e 13 b3  11 24 eb 5d 9d 8b 16 03  |2).@#....$.]....|
-00000020  03 00 28 30 c2 c5 18 43  17 7f a8 ab ac f3 22 a9  |..(0...C......".|
-00000030  79 0d d1 b6 3d e7 c8 aa  c8 73 3e 31 0a 67 2a dd  |y...=....s>1.g*.|
-00000040  38 5a 8d 74 ae 21 6b a0  2d 2e 33 17 03 03 00 21  |8Z.t.!k.-.3....!|
-00000050  30 c2 c5 18 43 17 7f a9  03 fb e5 f0 52 1e 20 64  |0...C.......R. d|
-00000060  94 a0 89 af f1 77 3a fb  1a a0 6f c2 47 ea d9 0a  |.....w:...o.G...|
-00000070  08                                                |.|
+00000000  14 03 03 00 19 6b be a8  12 9c 7f 20 b5 ab b8 9e  |.....k..... ....|
+00000010  f3 24 cd 36 cf ac 42 6e  4b 5e 48 3a c7 68 16 03  |.$.6..BnK^H:.h..|
+00000020  03 00 28 48 74 d1 24 fc  16 53 84 41 00 a0 53 54  |..(Ht.$..S.A..ST|
+00000030  57 fe dd 26 0b 06 d9 21  1a 54 f8 6a c7 0b 7c c5  |W..&...!.T.j..|.|
+00000040  44 3d 7a c1 9a ec 01 3f  7d 85 d7 17 03 03 00 21  |D=z....?}......!|
+00000050  48 74 d1 24 fc 16 53 85  cb 06 31 e3 d4 a1 2f c7  |Ht.$..S...1.../.|
+00000060  98 cf 56 62 9f c0 a1 eb  06 76 ab 3b e9 e5 f1 55  |..Vb.....v.;...U|
+00000070  06                                                |.|
 >>> Flow 11 (client to server)
-00000000  15 03 03 00 1a 00 00 00  00 00 00 00 01 ce 9e d4  |................|
-00000010  2a a1 d3 bb d6 e6 59 9f  77 05 cc 3e 1f c9 91     |*.....Y.w..>...|
+00000000  15 03 03 00 1a 00 00 00  00 00 00 00 01 ab d8 53  |...............S|
+00000010  c0 34 01 ff f7 d8 20 95  c3 57 0e 03 6c 6e 9b     |.4.... ..W..ln.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice
index bde706589a..c30a91c311 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 36 00 05 00 05  01 00 00 00 00 00 0a 00  |...6............|
-00000060  08 00 06 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
-00000070  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
-00000080  03 ff 01 00 01 00 00 12  00 00                    |..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 eb 77 8c 59 ef  |....Y...U...w.Y.|
-00000010  e6 30 f5 97 f6 09 c3 1e  78 2b d8 35 24 ff 15 19  |.0......x+.5$...|
-00000020  00 44 31 29 6f 12 58 c6  21 65 75 20 16 f6 8e 14  |.D1)o.X.!eu ....|
-00000030  1b e4 8b c7 11 4d a8 c7  f4 4f 85 e8 3d 17 bd 6c  |.....M...O..=..l|
-00000040  f5 e2 d4 4b bf 98 10 81  16 09 9b a0 c0 2f 00 00  |...K........./..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 ff 8b b6 9f 03  |....Y...U.......|
+00000010  af 3f 1d 4a 2e f2 54 03  82 b5 df af dd 2e 45 ed  |.?.J..T.......E.|
+00000020  d4 85 da fd f4 49 e0 ea  6b f1 4d 20 45 35 4f a7  |.....I..k.M E5O.|
+00000030  35 e8 78 9b fc 90 d9 ad  ec 08 bb 62 ff 19 e8 11  |5.x........b....|
+00000040  90 10 6d ee 80 3f dd dc  f4 57 e8 49 c0 2f 00 00  |..m..?...W.I./..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,19 +53,19 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  cd 0c 00 00 c9 03 00 17  41 04 8b 0d b4 d1 34 ac  |........A.....4.|
-000002d0  85 9a fb 3e 2b c5 ff 59  32 d4 dc 51 b8 de dc 05  |...>+..Y2..Q....|
-000002e0  c6 48 4a c6 b8 cb 1f 8d  8c 1d dd ea 5b 84 e9 d9  |.HJ.........[...|
-000002f0  73 d7 85 0c 62 eb a8 2c  52 ba b5 f8 a2 d6 a6 f0  |s...b..,R.......|
-00000300  9f 90 20 df 7d 73 b6 9b  03 67 04 01 00 80 6d 38  |.. .}s...g....m8|
-00000310  df b8 fc ca ab ac bc 90  56 09 24 f5 a9 29 66 4c  |........V.$..)fL|
-00000320  ad 1a 7d cf 57 33 29 a3  01 21 59 c4 f9 f7 9f 0b  |..}.W3)..!Y.....|
-00000330  bb fa 56 bc 0b 2e 86 2f  74 ba d1 c2 3a 94 c6 9a  |..V..../t...:...|
-00000340  53 76 63 3c 92 0f 4d 70  3b 63 60 75 6e ef 10 ca  |Svc<..Mp;c`un...|
-00000350  77 42 81 9a fa da 58 8f  ba 82 56 02 39 32 4f 95  |wB....X...V.92O.|
-00000360  56 db b9 d7 42 34 78 5b  29 ba 26 6f 94 4b 7b a3  |V...B4x[).&o.K{.|
-00000370  6f ba 26 47 5e bb 58 b7  c7 14 e9 3a a5 a2 fb 74  |o.&G^.X....:...t|
-00000380  17 f4 47 fc 3c 42 5c 3d  dc a1 d4 3e 61 05 16 03  |..G.<B\=...>a...|
+000002c0  cd 0c 00 00 c9 03 00 17  41 04 01 2e 60 6b 09 ff  |........A...`k..|
+000002d0  e2 7d 81 6a 2c 8f 1f 3c  54 17 e7 2b 6d 20 c7 b8  |.}.j,..<T..+m ..|
+000002e0  71 23 b5 4c b6 68 57 fb  1b 3b 9e 37 52 f9 dc cc  |q#.L.hW..;.7R...|
+000002f0  f1 93 f2 c6 01 d2 62 ae  2c 42 79 0a 54 bb 4d c3  |......b.,By.T.M.|
+00000300  ab d0 71 c5 70 45 b3 d2  f6 d5 04 01 00 80 01 ac  |..q.pE..........|
+00000310  27 c8 14 11 7b 53 4d d0  b5 94 d4 cf 12 fd 89 e0  |'...{SM.........|
+00000320  b9 15 ff 26 95 98 47 68  c0 fd 1e ac d5 18 29 be  |...&..Gh......).|
+00000330  79 a2 f7 f2 74 bc fc 54  77 8f 37 2d bf 2d 8d de  |y...t..Tw.7-.-..|
+00000340  c5 64 e1 e5 e8 f2 a0 3e  c0 ba 5e 6d 0a c9 2c dc  |.d.....>..^m..,.|
+00000350  b9 dd 88 7a 0f 53 93 40  57 2d 63 32 18 04 64 a3  |...z.S.@W-c2..d.|
+00000360  30 28 37 55 f9 8f a6 7b  49 7f 89 1b 74 05 34 b4  |0(7U...{I...t.4.|
+00000370  44 2e 9f bc 54 79 9c 60  aa 46 8c 5e b3 f4 e1 c5  |D...Ty.`.F.^....|
+00000380  11 02 94 3b ad c1 17 0e  f5 91 2a d9 2f a4 16 03  |...;......*./...|
 00000390  03 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
@@ -73,328 +73,330 @@
 00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 0a 9c  |.....(..........|
-00000060  e0 c5 65 88 69 4a 84 28  78 85 d2 da 79 ab d4 09  |..e.iJ.(x...y...|
-00000070  e4 f2 79 fa 2f 61 b0 ab  43 a4 40 6e 4a 45        |..y./a..C.@nJE|
+00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 99 26  |.....(.........&|
+00000060  7a 42 8d 28 6d e8 96 9d  b3 d7 69 9b eb c6 4c 38  |zB.(m.....i...L8|
+00000070  6a 3c e4 e0 df de 6f f0  22 8a 78 4f e3 06        |j<....o.".xO..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 00 80 4c 9c ca  |..........(..L..|
-00000010  45 ce e6 f6 33 36 ba 7b  b1 32 36 9a 1f d9 dd da  |E...36.{.26.....|
-00000020  f7 2c b1 a1 b1 51 98 0b  82 b2 c8 15 77 5b 15 c4  |.,...Q......w[..|
-00000030  4e 10 75                                          |N.u|
+00000000  14 03 03 00 01 01 16 03  03 00 28 ad 26 44 4c 45  |..........(.&DLE|
+00000010  02 3d 8b 08 cb be 7c 41  78 c9 aa dc 0b a3 9a 17  |.=....|Ax.......|
+00000020  40 47 f2 16 8e ef 10 e1  f5 df 84 41 e6 0d 8c 3b  |@G.........A...;|
+00000030  72 67 cb                                          |rg.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 f7 99 e6  |................|
-00000010  46 84 73 17 66 0c 5f 2e  3d 7a 7e 0c d8 bd 8b 8b  |F.s.f._.=z~.....|
-00000020  1a 53 ab                                          |.S.|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 97 db 95  |................|
+00000010  91 d6 6e 6c e8 a4 16 52  d5 05 ba de 4c 4c 0b 2d  |..nl...R....LL.-|
+00000020  2c 50 18                                          |,P.|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 1c 00 80 4c  9c ca 45 ce e7 f6 c3 e4  |.......L..E.....|
-00000010  3c 0f 94 cc df e3 52 c7  93 d0 f4 6b dc 29 30 03  |<.....R....k.)0.|
-00000020  09                                                |.|
+00000000  16 03 03 00 1c ad 26 44  4c 45 02 3d 8c 2d f2 b6  |......&DLE.=.-..|
+00000010  fd 7a ff 59 68 d0 da 7b  23 c3 db 0b 41 7c 6c ea  |.z.Yh..{#...A|l.|
+00000020  78                                                |x|
 >>> Flow 7 (client to server)
-00000000  16 03 03 00 a9 00 00 00  00 00 00 00 02 37 72 af  |.............7r.|
-00000010  32 af d0 d0 9a d3 39 d1  9a 82 9c 0e c1 44 4e d1  |2.....9......DN.|
-00000020  31 22 8b 0e e9 e5 3f 03  a6 2a d6 95 c7 bb d4 2c  |1"....?..*.....,|
-00000030  f4 d1 40 d0 14 8d f4 45  57 29 18 bd 88 2a 90 fe  |..@....EW)...*..|
-00000040  21 a7 29 e7 d2 36 ff 8b  8f 77 32 f8 27 b8 01 da  |!.)..6...w2.'...|
-00000050  f0 87 5a e7 86 b2 c5 17  12 24 a0 69 87 71 1e 3d  |..Z......$.i.q.=|
-00000060  ad 7d ce 9d 7f 97 5d af  5a 13 ea cf 47 b1 d9 5c  |.}....].Z...G..\|
-00000070  16 2f 1c 43 cf c7 0a 69  d5 ae a7 ac ce 25 8d d4  |./.C...i.....%..|
-00000080  22 c6 1a 60 99 6e 8b 22  0d e7 28 69 db 03 c0 f1  |"..`.n."..(i....|
-00000090  c6 23 90 2f 4f 22 34 03  fa b7 8e 02 85 83 10 78  |.#./O"4........x|
-000000a0  b8 0e 7b 7a ea 2a 75 58  07 66 3e 87 ec 6d        |..{z.*uX.f>..m|
+00000000  16 03 03 00 af 00 00 00  00 00 00 00 02 9a cb f4  |................|
+00000010  b1 66 8d 51 81 9f 17 2e  f3 65 8d 12 e6 13 22 26  |.f.Q.....e...."&|
+00000020  16 90 4c e0 9c 5b fe 3b  90 53 be 58 b1 e8 ac dc  |..L..[.;.S.X....|
+00000030  5e b7 4c a6 c7 80 07 9a  bb 0d 88 aa 3f 14 88 fa  |^.L.........?...|
+00000040  07 04 89 2b 0a 8a d4 3d  62 90 1c d5 64 29 ef 3e  |...+...=b...d).>|
+00000050  e3 99 f0 10 1f f8 a4 15  91 3a c5 b0 5b 82 97 24  |.........:..[..$|
+00000060  96 58 43 a9 12 ef 33 cc  04 03 71 26 0a c9 2b 0b  |.XC...3...q&..+.|
+00000070  ca 97 6c 3a 6d 1d 07 43  6c b2 1d 26 ce 15 6c da  |..l:m..Cl..&..l.|
+00000080  c8 01 25 8c eb e5 c1 af  0f 08 14 6b f7 14 a6 7b  |..%........k...{|
+00000090  a6 64 e3 8c 15 28 07 27  ba 85 3f fa 23 72 1e e4  |.d...(.'..?.#r..|
+000000a0  9f e9 ec 92 1d ac 7b 65  27 7c bd 81 2d 83 24 f6  |......{e'|..-.$.|
+000000b0  ae 8b 9f 88                                       |....|
 >>> Flow 8 (server to client)
-00000000  16 03 03 00 89 00 80 4c  9c ca 45 ce e8 bf 9e ed  |.......L..E.....|
-00000010  77 ff a0 6a 73 25 a5 be  7e ed af cf e3 6f 30 a2  |w..js%..~....o0.|
-00000020  2d 18 84 52 5b af a2 1b  ad 72 af 75 4e 88 05 55  |-..R[....r.uN..U|
-00000030  31 99 b1 81 25 b4 2e 65  2e b8 df 70 22 11 3e 38  |1...%..e...p".>8|
-00000040  2c 12 66 9b 66 3e d3 e7  96 e3 01 23 a5 06 e9 89  |,.f.f>.....#....|
-00000050  ff 7b 90 a8 56 57 99 2d  ed c6 b0 fb 50 88 93 f8  |.{..VW.-....P...|
-00000060  29 f8 0c bf c4 2f 3f 6e  08 22 74 e8 6a 0f 4a c4  |)..../?n."t.j.J.|
-00000070  c4 0d ca ce d1 83 0f dc  16 15 86 f3 76 ed 6b 74  |............v.kt|
-00000080  19 4f fc bb 0a d9 bc a0  a8 d3 60 0b 05 6d 16 03  |.O........`..m..|
-00000090  03 02 71 00 80 4c 9c ca  45 ce e9 a5 db 63 b4 da  |..q..L..E....c..|
-000000a0  da b4 76 a0 8b d6 86 74  56 db 3f 77 ef 07 72 04  |..v....tV.?w..r.|
-000000b0  b6 37 47 4e 4c aa 92 45  ba 98 23 01 59 c6 f7 86  |.7GNL..E..#.Y...|
-000000c0  dc 4a 83 a9 b7 3f e8 e4  41 d5 44 24 1d cc 3d 4c  |.J...?..A.D$..=L|
-000000d0  91 36 6c de 77 2d 5a aa  82 15 d9 51 c1 46 07 29  |.6l.w-Z....Q.F.)|
-000000e0  e5 87 50 0d c3 c5 0d ab  0c f6 73 62 5a 92 5e ef  |..P.......sbZ.^.|
-000000f0  04 1e 24 d9 a4 f9 9d 9a  9a 44 6b 73 16 ce 34 9c  |..$......Dks..4.|
-00000100  82 45 17 3f 10 78 04 e0  5a 60 77 c3 97 81 a6 46  |.E.?.x..Z`w....F|
-00000110  1f 16 c7 b7 0a 0b ec b5  f3 33 03 f8 c6 f4 11 6e  |.........3.....n|
-00000120  74 07 83 bb 99 74 74 ab  cc bd 86 02 78 c5 ab e1  |t....tt.....x...|
-00000130  13 b2 cb 30 66 c9 7e ad  8c 4b e5 68 8f c7 78 77  |...0f.~..K.h..xw|
-00000140  53 d8 5d c3 24 69 d6 58  b2 23 43 e2 2e 10 ce 0e  |S.].$i.X.#C.....|
-00000150  70 04 8f 7f 1c bf 7b c4  bb 0c af 59 82 f5 ea e7  |p.....{....Y....|
-00000160  72 f0 6c a5 7a 76 99 d7  48 6f f4 da fd d4 13 db  |r.l.zv..Ho......|
-00000170  e5 d5 ca 13 e2 a4 4e a1  84 38 ee 27 3a 7b e3 54  |......N..8.':{.T|
-00000180  83 bc 4a 8c 1f c3 fa da  3b 70 9e aa 72 f7 29 8d  |..J.....;p..r.).|
-00000190  f8 ec 29 55 e3 b2 17 35  56 db 6a fc 3e 68 19 92  |..)U...5V.j.>h..|
-000001a0  a4 dc a0 ff 31 3b 1d ba  d7 6b cd 20 8d da 85 49  |....1;...k. ...I|
-000001b0  ba 15 fc e5 fd 12 e6 e8  f4 19 cd d6 6c 90 95 dd  |............l...|
-000001c0  52 d6 43 64 13 6e b1 86  0a 0b 89 6e 17 53 fc 88  |R.Cd.n.....n.S..|
-000001d0  6c 26 37 43 50 0e f9 f1  b8 17 9e 4d 14 0e fe dc  |l&7CP......M....|
-000001e0  52 b2 3b fe b2 ac c4 ad  e2 0e d6 05 e5 8c 00 7d  |R.;............}|
-000001f0  39 9e 0e 10 4f cc be bd  c9 3d dc b2 98 30 88 5d  |9...O....=...0.]|
-00000200  02 58 28 57 a5 5f 55 92  a5 60 33 73 27 eb 87 33  |.X(W._U..`3s'..3|
-00000210  9f d4 b3 09 37 05 21 8e  cc eb 19 29 67 ad 39 1b  |....7.!....)g.9.|
-00000220  31 c3 04 e4 d9 02 a7 5a  07 3e f0 7d 30 17 9d 0c  |1......Z.>.}0...|
-00000230  d6 51 b8 03 9b 78 15 bc  9b 91 4c 3e 6c f9 59 c9  |.Q...x....L>l.Y.|
-00000240  41 4b f9 ee 81 9e 02 23  7b 2a a2 94 24 b8 0d e8  |AK.....#{*..$...|
-00000250  6e c5 be c1 71 22 6f 0a  c4 18 44 47 24 25 5e 59  |n...q"o...DG$%^Y|
-00000260  5b c6 e0 a8 af 13 72 27  ee 24 9b 23 99 b7 60 09  |[.....r'.$.#..`.|
-00000270  e3 57 02 bf a3 8b c1 c7  75 51 81 6a b4 d5 df 03  |.W......uQ.j....|
-00000280  3a 5c 86 f1 9b ff 33 1f  ff c6 26 19 0a 30 65 fc  |:\....3...&..0e.|
-00000290  04 8f 2d 72 5d d3 b4 32  33 6c 32 ee a8 af 22 a8  |..-r]..23l2...".|
-000002a0  6a ef 68 46 2a a0 86 aa  ec c4 bf fc c5 39 23 21  |j.hF*........9#!|
-000002b0  ca a2 33 e1 2d fe 90 2c  11 47 38 1e 5c 2a 6b a5  |..3.-..,.G8.\*k.|
-000002c0  6e 51 11 db 67 cb d3 08  11 e5 02 91 bb 7a 22 5e  |nQ..g........z"^|
-000002d0  95 64 c0 45 0b a9 ef ae  d5 e5 c2 94 7b dc db 43  |.d.E........{..C|
-000002e0  d0 6e 67 74 86 e6 ba a7  27 6d c4 0b c1 1d e7 01  |.ngt....'m......|
-000002f0  55 97 8c 2e bb 87 7c 49  98 4a 4d ee c9 c0 83 12  |U.....|I.JM.....|
-00000300  74 8d 4b da 16 03 03 00  e5 00 80 4c 9c ca 45 ce  |t.K........L..E.|
-00000310  ea 55 ee bd 5d 57 d6 82  19 8d 33 85 03 4c 76 4e  |.U..]W....3..LvN|
-00000320  fa 54 7f a2 36 51 98 54  d0 04 18 07 07 2f 05 0a  |.T..6Q.T...../..|
-00000330  04 d1 4b 8d 58 fd 0f 52  61 34 12 19 b1 7e 45 b2  |..K.X..Ra4...~E.|
-00000340  24 73 ef 4a a7 04 8d f0  e0 f3 d0 34 a7 6d 8d 72  |$s.J.......4.m.r|
-00000350  c4 fc 97 db 26 5a 27 d4  fe 07 ee 91 7a 53 9e a3  |....&Z'.....zS..|
-00000360  32 80 08 c2 e6 11 13 4a  9c db 65 63 15 26 5c 5d  |2......J..ec.&\]|
-00000370  99 a8 42 93 51 58 65 c7  08 de 39 34 33 4d 83 2f  |..B.QXe...943M./|
-00000380  7d a7 61 47 e9 2a e5 45  b0 3a 89 3c b2 df 46 05  |}.aG.*.E.:.<..F.|
-00000390  6d a5 42 a6 d8 73 36 33  2f f6 46 b3 1a 22 67 a3  |m.B..s63/.F.."g.|
-000003a0  2d bd 35 33 70 a8 20 5f  7a d0 1e 83 2a 87 a6 76  |-.53p. _z...*..v|
-000003b0  3c ce 91 ef b0 b7 e3 67  a4 a2 1d 13 c5 14 4e 8d  |<......g......N.|
-000003c0  26 35 0f 52 99 d4 c2 f2  cc 8e 6d 94 93 75 5c 84  |&5.R......m..u\.|
-000003d0  37 16 a1 55 b2 19 1f 3e  e2 7b a8 cf 1d b3 c5 0e  |7..U...>.{......|
-000003e0  53 88 a7 3f c7 da b9 3f  7c 65 2b fb 02 5a 16 03  |S..?...?|e+..Z..|
-000003f0  03 00 46 00 80 4c 9c ca  45 ce eb f6 2d 2b 47 14  |..F..L..E...-+G.|
-00000400  14 f3 6f c4 8c 59 55 55  dd cc 10 08 ee e9 b9 81  |..o..YUU........|
-00000410  20 47 d2 8d 39 3e d0 e4  b1 ab 6e 45 b2 dc 19 4d  | G..9>....nE...M|
-00000420  1b 5d 45 14 38 aa 8f 6d  5e 4d 9c 6d ab 74 e8 69  |.]E.8..m^M.m.t.i|
-00000430  cf a1 b7 09 eb f8 9d 10  48                       |........H|
+00000000  16 03 03 00 89 ad 26 44  4c 45 02 3d 8d 73 36 ed  |......&DLE.=.s6.|
+00000010  e8 81 6f 8c ac 02 1e 03  b0 cd aa b1 d6 98 7e 23  |..o...........~#|
+00000020  6b da 43 57 2a f2 91 ad  06 12 3b ad 4a 67 7d 82  |k.CW*.....;.Jg}.|
+00000030  d8 47 bc ee 05 f6 bb b9  31 40 45 84 e9 df 2d 2d  |.G......1@E...--|
+00000040  d7 9e b1 cf c6 0e 4f b6  f3 ce 03 74 88 ef df 68  |......O....t...h|
+00000050  b8 02 59 0c 08 f6 4a de  32 d6 fe ba a5 63 97 c6  |..Y...J.2....c..|
+00000060  e9 4e d8 17 72 b5 00 c2  6b 8e a1 ba 08 59 f3 4f  |.N..r...k....Y.O|
+00000070  fc f2 a3 3f 9a 8d 1a de  1f d8 c0 e7 92 63 67 dd  |...?.........cg.|
+00000080  e1 34 b3 48 2d 06 aa 61  7e f3 7c 0f 94 b7 16 03  |.4.H-..a~.|.....|
+00000090  03 02 71 ad 26 44 4c 45  02 3d 8e ba 4a f2 9d c0  |..q.&DLE.=..J...|
+000000a0  12 78 d1 e5 d0 33 96 0c  a9 ff 90 ea c7 5f 9e c9  |.x...3......._..|
+000000b0  a5 9b 10 a9 af 3b 35 66  bd 8b 5d 7c 3e 26 7b c6  |.....;5f..]|>&{.|
+000000c0  90 c5 60 3e c6 c5 37 4a  4f 71 de 10 79 a2 25 e5  |..`>..7JOq..y.%.|
+000000d0  c3 b1 30 2f b2 83 ef 28  75 f9 3e 52 86 97 4e 63  |..0/...(u.>R..Nc|
+000000e0  da 60 70 7c fe 5f ab f0  9a 37 41 4c c3 83 77 5e  |.`p|._...7AL..w^|
+000000f0  f7 49 4e be 74 5a 1b a3  41 22 31 59 ec 28 90 f3  |.IN.tZ..A"1Y.(..|
+00000100  be a7 bf 50 0e 58 44 b9  3d 99 25 95 82 45 8a 88  |...P.XD.=.%..E..|
+00000110  80 c8 06 c7 94 56 1a 63  0c 3b 30 9f 7e 5f a1 e2  |.....V.c.;0.~_..|
+00000120  15 40 fa 8a 35 b7 87 85  42 5a dd f4 56 a7 b3 ca  |.@..5...BZ..V...|
+00000130  e6 5c 82 bd ea 7f 02 82  15 b1 4f 63 0c e5 cd d4  |.\........Oc....|
+00000140  19 ec d6 8c d1 b8 fa 54  8b 04 42 11 a8 95 55 9d  |.......T..B...U.|
+00000150  fc 3e a4 ad f0 51 ee ac  4b 8f 30 27 9e bb 74 15  |.>...Q..K.0'..t.|
+00000160  c8 9f 52 0c 83 fd 75 a2  64 f5 ce 3c 01 76 7c dc  |..R...u.d..<.v|.|
+00000170  ec 15 99 70 af a9 93 bb  eb f0 4a b1 58 19 de 2e  |...p......J.X...|
+00000180  9e 01 67 ab 08 73 b5 6c  7d f0 cd 67 f6 4a 64 76  |..g..s.l}..g.Jdv|
+00000190  3f 5d 2b 98 ea ef f6 43  1b 1a ed 6d e1 e4 5b 24  |?]+....C...m..[$|
+000001a0  dd 5d eb 69 7a 6d 81 94  d7 2f 5c c4 f2 01 34 33  |.].izm.../\...43|
+000001b0  e2 cf 78 00 87 16 98 4b  28 cd 1a 4b 3f f0 42 31  |..x....K(..K?.B1|
+000001c0  07 8a ec 77 65 66 08 5f  72 a3 39 82 56 5d 90 14  |...wef._r.9.V]..|
+000001d0  29 cf e0 4f e6 41 c9 b2  85 81 28 cb f8 8e b8 39  |)..O.A....(....9|
+000001e0  16 16 4b 85 91 96 0b 0f  7b 59 ac ec 39 cc 02 ea  |..K.....{Y..9...|
+000001f0  79 72 60 04 5c 57 29 df  b2 26 6f 1c 93 21 93 95  |yr`.\W)..&o..!..|
+00000200  cb b2 8e 02 91 9f 14 d9  dd 3b 58 0d 73 1e 39 7d  |.........;X.s.9}|
+00000210  b0 65 d9 fa 07 2d 12 02  c9 b3 fd 6b 81 0d 2e 8d  |.e...-.....k....|
+00000220  2d 31 82 9d 4d df fa 93  c3 dd 98 ea 49 e8 2e 3d  |-1..M.......I..=|
+00000230  6b 7a 4e 55 e6 8e 1d 18  07 2a 71 9b 64 bb d9 fa  |kzNU.....*q.d...|
+00000240  3c fe fb 29 e7 93 68 3b  5b f5 7a c3 c5 e8 76 66  |<..)..h;[.z...vf|
+00000250  54 1d 89 f0 fc d8 d7 f0  e0 c0 bf 86 de 8f 37 72  |T.............7r|
+00000260  53 f0 91 2e 7b 5c bc 61  cc 91 be 4d 29 4e 88 4e  |S...{\.a...M)N.N|
+00000270  ad 1a fe da 16 3b 89 e7  aa 28 77 a7 d2 4f 7e 68  |.....;...(w..O~h|
+00000280  8a 70 1e db ae 74 b6 78  57 13 47 4b 2d 28 f2 3c  |.p...t.xW.GK-(.<|
+00000290  d4 cc 0a 47 fe 9b 43 49  80 56 7d 46 12 3e 62 49  |...G..CI.V}F.>bI|
+000002a0  6c ae cc 4d 58 3c 37 5b  10 93 e0 6c 1f 51 1e 30  |l..MX<7[...l.Q.0|
+000002b0  06 85 07 1f 0d 20 b1 57  6f 5d 17 5c d1 66 f0 fe  |..... .Wo].\.f..|
+000002c0  d2 5f 7e 0e 66 f3 23 23  d1 c6 03 1c 7e 93 ab e5  |._~.f.##....~...|
+000002d0  d1 7e c7 06 09 18 96 fa  19 b8 e6 f7 35 d6 80 f4  |.~..........5...|
+000002e0  41 2a 59 80 5b 3a 3c 82  33 84 55 5d 3f 7b e8 1b  |A*Y.[:<.3.U]?{..|
+000002f0  ce 82 18 7d 66 a9 2a 12  03 97 49 66 d5 88 50 25  |...}f.*...If..P%|
+00000300  30 14 02 c6 16 03 03 00  e5 ad 26 44 4c 45 02 3d  |0.........&DLE.=|
+00000310  8f a6 47 86 99 f5 6c 24  20 3d 37 2b 76 ce f3 df  |..G...l$ =7+v...|
+00000320  c3 e0 98 90 10 04 64 af  08 01 94 84 0a 1c 40 22  |......d.......@"|
+00000330  7e de 5c 9c 39 8e 0b d0  d2 cb 87 ed 26 a5 71 bf  |~.\.9.......&.q.|
+00000340  1e 0a 32 7a 84 d1 b0 3d  7c 7e b0 00 f0 d1 1b e6  |..2z...=|~......|
+00000350  d2 dc 8a 5e e2 b6 16 2c  98 53 fc 95 ce 24 74 26  |...^...,.S...$t&|
+00000360  bb d3 7d b1 a7 68 73 98  81 a9 38 80 f1 ad c4 00  |..}..hs...8.....|
+00000370  57 79 65 0e b7 25 73 aa  f6 8f f1 70 51 d9 d4 73  |Wye..%s....pQ..s|
+00000380  8e bd 57 4a ee f9 eb 41  ed 52 bb 23 8d 10 ce 74  |..WJ...A.R.#...t|
+00000390  fa 0c 01 d6 e7 b6 71 bb  e0 e0 8a e7 3b 88 dc 3a  |......q.....;..:|
+000003a0  7c 18 ca 70 6d 39 5c 3f  b2 99 af 29 71 27 a1 2f  ||..pm9\?...)q'./|
+000003b0  a0 6e 11 47 dc a2 6f e0  ab ad 2f 26 8f b2 d6 7d  |.n.G..o.../&...}|
+000003c0  bb 5f 8c 22 1e b9 b2 82  45 e7 24 52 f6 5d e0 5a  |._."....E.$R.].Z|
+000003d0  6f cb a0 ef 14 ad 8a 18  8d 21 c9 04 01 f6 67 d6  |o........!....g.|
+000003e0  08 2d e6 73 73 5c 64 23  d5 30 04 a7 5f 57 16 03  |.-.ss\d#.0.._W..|
+000003f0  03 00 46 ad 26 44 4c 45  02 3d 90 9e 93 c2 4e 92  |..F.&DLE.=....N.|
+00000400  67 14 0c ec d6 5a 44 7f  bf 1d a7 0a 0d f3 bf 2a  |g....ZD........*|
+00000410  07 ed a4 89 89 58 1a 9e  f6 ac 2f 04 b9 bc 2f 40  |.....X..../.../@|
+00000420  50 39 18 3e dc 6b 10 6e  82 66 32 27 f6 29 46 96  |P9.>.k.n.f2'.)F.|
+00000430  b6 cc 04 d9 aa 73 4c 68  74                       |.....sLht|
 >>> Flow 9 (client to server)
-00000000  16 03 03 02 71 00 00 00  00 00 00 00 03 28 68 60  |....q........(h`|
-00000010  02 47 44 78 76 69 c2 90  c5 99 84 44 5a 69 ef 8f  |.GDxvi.....DZi..|
-00000020  d9 5a 65 5e da 65 10 71  94 48 b4 b1 ea 2e 49 d5  |.Ze^.e.q.H....I.|
-00000030  c6 a4 36 4e 81 19 9e 7e  1e 30 35 06 ea 75 68 09  |..6N...~.05..uh.|
-00000040  45 26 30 ca 19 5f 2a 59  15 27 f3 ef 34 71 14 e0  |E&0.._*Y.'..4q..|
-00000050  b3 25 15 36 68 ff 02 e8  b6 0c 29 bc c8 e7 01 86  |.%.6h.....).....|
-00000060  6b 3f ea 70 59 e6 fa 3e  82 99 20 74 02 16 9e f2  |k?.pY..>.. t....|
-00000070  74 0e 51 62 71 4b 58 fb  19 f8 e2 e1 97 d3 30 e1  |t.QbqKX.......0.|
-00000080  38 21 40 8b bf ab 32 f5  28 4f c9 29 82 d0 e5 07  |8!@...2.(O.)....|
-00000090  17 2c bd 49 6a e5 dc 87  c0 14 e3 cd 83 15 29 fc  |.,.Ij.........).|
-000000a0  14 68 c2 fc b3 d7 e1 d0  33 6b fb 3b 78 6a f5 61  |.h......3k.;xj.a|
-000000b0  84 6a bb c4 e6 14 25 ce  1a c6 75 9c cf 23 a4 3b  |.j....%...u..#.;|
-000000c0  5c 43 40 7a 29 70 e8 f7  19 38 c6 21 8b 66 8b 00  |\C@z)p...8.!.f..|
-000000d0  29 8d 1a 11 a4 9b 24 0a  0b d1 68 98 98 94 34 72  |).....$...h...4r|
-000000e0  61 d0 62 65 b8 1e 4b c9  c4 b5 7f 7c 0d c8 f3 71  |a.be..K....|...q|
-000000f0  1c ee 20 7d 11 83 de 36  4c 80 ba 30 39 47 6b 8d  |.. }...6L..09Gk.|
-00000100  7c d6 c8 96 4b f8 83 53  a3 75 d7 06 a7 fd ae b4  ||...K..S.u......|
-00000110  21 14 d2 19 2a 99 29 b5  01 09 d5 96 d4 c5 e1 58  |!...*.)........X|
-00000120  d0 7d 5e 56 5a d7 d9 4f  8a a6 2f e2 ed f1 0c 9e  |.}^VZ..O../.....|
-00000130  a0 42 fe 74 b3 5d 84 09  12 1c b1 25 25 d5 93 dc  |.B.t.].....%%...|
-00000140  6c 91 9d b9 65 6c 59 65  17 68 42 df f6 e7 6a bf  |l...elYe.hB...j.|
-00000150  6b f1 3e 27 4c 16 b7 af  5a a0 8a 3f 3a 00 8d 1c  |k.>'L...Z..?:...|
-00000160  26 43 61 74 82 6a c6 ba  6c 13 df 69 a2 5a 9c 12  |&Cat.j..l..i.Z..|
-00000170  44 a5 1b e3 a5 b9 e4 bb  ff 12 c9 07 f9 c3 c1 c8  |D...............|
-00000180  c7 5f b7 5e 76 b6 2d 4e  81 96 f3 2f 89 bd 99 c3  |._.^v.-N.../....|
-00000190  97 e2 74 4a 7e 6a fa 68  45 d6 2f 87 ab 7b 64 82  |..tJ~j.hE./..{d.|
-000001a0  f7 b9 19 f9 31 99 f3 e9  d0 4f e0 4c b7 ed 0c 46  |....1....O.L...F|
-000001b0  5a 8b 10 2e 98 48 10 1f  bb 73 1b 2a 78 33 b2 14  |Z....H...s.*x3..|
-000001c0  17 63 13 b4 90 4a d8 4a  90 06 de f3 7d 6e ab a5  |.c...J.J....}n..|
-000001d0  13 d0 8c f3 ab 6d 01 70  f1 ae 96 ba 10 37 d3 6b  |.....m.p.....7.k|
-000001e0  aa 23 ca 4f fe 3e 22 50  87 3f 85 63 b0 52 10 f1  |.#.O.>"P.?.c.R..|
-000001f0  7b ac 87 28 07 3d 93 6f  14 0f 3d 1f f6 13 19 31  |{..(.=.o..=....1|
-00000200  e3 79 11 6e d3 22 fd a5  9b c5 90 f7 54 0b 7e 43  |.y.n."......T.~C|
-00000210  db 4e c2 a4 7e f3 92 15  cb 81 e8 3d 79 5f 38 0b  |.N..~......=y_8.|
-00000220  47 0f b0 1a 5a a7 66 b1  85 48 d2 3c 08 be f5 90  |G...Z.f..H.<....|
-00000230  81 9a 64 0d 16 94 b1 af  0e 57 5a bc f5 31 c1 68  |..d......WZ..1.h|
-00000240  72 d9 a7 b4 fe 04 53 75  4f fb 66 80 d2 45 54 95  |r.....SuO.f..ET.|
-00000250  e9 b1 c0 3a be b8 0e 97  7f d9 e5 6d 54 83 ff 67  |...:.......mT..g|
-00000260  87 6f 1e 18 bc 44 ce 6a  84 f5 f7 9d 0a dd bf f3  |.o...D.j........|
-00000270  4b 70 af d4 be 0a 16 03  03 00 5e 00 00 00 00 00  |Kp........^.....|
-00000280  00 00 04 28 61 36 92 99  ca 20 b1 44 8f 32 6a b7  |...(a6... .D.2j.|
-00000290  f0 b4 0a 28 28 ec a0 a9  ae 82 00 62 24 9b ad b3  |...((......b$...|
-000002a0  2c 00 56 a5 3e 36 a5 b3  56 5b 26 67 81 a9 6d 29  |,.V.>6..V[&g..m)|
-000002b0  24 43 66 d4 2e b7 b3 91  5e 78 66 94 60 8f 6a 0f  |$Cf.....^xf.`.j.|
-000002c0  3f 49 9f 19 57 83 71 33  09 d1 96 47 66 80 08 c5  |?I..W.q3...Gf...|
-000002d0  90 d0 f5 88 39 e0 57 35  db 16 03 03 00 a0 00 00  |....9.W5........|
-000002e0  00 00 00 00 00 05 ac 79  3f ec f8 da 36 00 58 ac  |.......y?...6.X.|
-000002f0  19 0f 0b 88 a7 2d a2 e8  10 b0 75 32 54 f1 a8 4d  |.....-....u2T..M|
-00000300  ff 68 51 ac 9d 32 cd 86  8e 10 56 35 6e dc 43 cf  |.hQ..2....V5n.C.|
-00000310  24 fb 85 25 59 22 a6 8c  37 cc e6 bc e8 bb 74 3c  |$..%Y"..7.....t<|
-00000320  c9 9a 83 05 ba 0b b5 74  e0 e6 15 fb 04 27 25 ce  |.......t.....'%.|
-00000330  08 4e 6b 8e 53 bf ce d8  6e d0 70 7b 60 fa 06 fe  |.Nk.S...n.p{`...|
-00000340  76 d4 c8 a8 eb b3 3b e1  d2 dd 9d 98 a6 e1 d9 f6  |v.....;.........|
-00000350  70 24 31 31 db f8 42 3e  2a dd 22 02 5d 65 f1 dd  |p$11..B>*.".]e..|
-00000360  2c 69 ab 3f 45 48 7f 8d  26 36 16 da c0 cc 8d b4  |,i.?EH..&6......|
-00000370  70 be e7 dd c7 53 8e c5  3b ba ff 94 35 aa 14 03  |p....S..;...5...|
-00000380  03 00 19 00 00 00 00 00  00 00 06 b1 2d fb 59 39  |............-.Y9|
-00000390  a6 4f 7b f4 b4 e0 7e c3  d0 ca 93 33 16 03 03 00  |.O{...~....3....|
-000003a0  28 00 00 00 00 00 00 00  00 35 83 6a 16 4c 1c f0  |(........5.j.L..|
-000003b0  f1 49 d2 e0 b9 aa c3 0f  79 7a 04 b2 48 6f c7 79  |.I......yz..Ho.y|
-000003c0  f9 3f 79 d7 d6 f1 2f 94  28                       |.?y.../.(|
+00000000  16 03 03 02 71 00 00 00  00 00 00 00 03 5d 93 f4  |....q........]..|
+00000010  7a 32 5a b5 5b 4b 07 73  ae a6 e0 f1 39 7d 89 e4  |z2Z.[K.s....9}..|
+00000020  54 ce a3 7a 36 c1 95 6a  72 0a f4 7a a5 84 68 dd  |T..z6..jr..z..h.|
+00000030  d6 5f 43 52 a0 7a 28 d9  95 a2 35 35 89 09 00 fc  |._CR.z(...55....|
+00000040  a6 ab f2 3e 70 a8 3d 63  37 18 1d 11 2d 20 27 eb  |...>p.=c7...- '.|
+00000050  a6 ca 20 aa b5 fb 6d e6  ab f2 96 22 6c a9 14 8a  |.. ...m...."l...|
+00000060  55 c3 5c 44 0e 19 30 e1  57 ef 67 ea 4d 44 77 d9  |U.\D..0.W.g.MDw.|
+00000070  f9 8f d7 6c c3 77 55 af  b2 f0 22 c8 ba da 66 89  |...l.wU..."...f.|
+00000080  59 00 42 a6 b7 f6 3e 54  13 86 15 80 82 00 00 06  |Y.B...>T........|
+00000090  cc e5 c0 6d 3a 16 16 03  ea 91 db bc 38 e8 9d 35  |...m:.......8..5|
+000000a0  21 59 3e 26 b8 ac 08 19  aa 34 8e fc 48 6a 5b 0b  |!Y>&.....4..Hj[.|
+000000b0  4d eb 1c 48 4d cf 4c 44  af dc 74 2c c5 27 13 98  |M..HM.LD..t,.'..|
+000000c0  73 ca 71 8b 1f 76 e8 6e  42 2f a6 66 d4 84 2b 0f  |s.q..v.nB/.f..+.|
+000000d0  ec 5d 57 ec 61 e9 66 3a  b3 5a 14 e2 32 f9 97 0a  |.]W.a.f:.Z..2...|
+000000e0  55 e3 7f e6 5e cd 56 21  9f 6f 9d 59 cf 78 84 b2  |U...^.V!.o.Y.x..|
+000000f0  66 56 a2 50 f2 2a 13 ff  8d 93 35 9d 8e fc d4 4b  |fV.P.*....5....K|
+00000100  3c 7d 14 f4 d7 27 a3 00  fe ef 30 54 e5 fd c7 47  |<}...'....0T...G|
+00000110  7a a6 66 61 8a 92 24 fe  58 2a a6 96 f4 0e 15 ad  |z.fa..$.X*......|
+00000120  5b dc c5 a1 f7 81 16 30  ec ca 29 a8 3a b3 21 94  |[......0..).:.!.|
+00000130  5c 6c 24 b5 2a b7 48 2d  d3 27 04 8e 1e 93 b8 fc  |\l$.*.H-.'......|
+00000140  d7 e3 36 44 9e c7 5d c4  6f 04 c3 da 3d a3 3c a7  |..6D..].o...=.<.|
+00000150  54 82 aa 50 a2 17 3b af  f8 10 17 99 de 45 7f 79  |T..P..;......E.y|
+00000160  99 98 3e b6 2f b6 fc d8  96 3b 06 42 f8 4c 54 87  |..>./....;.B.LT.|
+00000170  41 44 3e 7c e2 f2 58 ab  f8 d9 f1 03 54 e4 3c 93  |AD>|..X.....T.<.|
+00000180  f6 a9 03 e5 f0 85 ac a3  5a 5d 99 2b cb 3c 4e 1a  |........Z].+.<N.|
+00000190  d2 b8 08 a1 81 a0 17 ba  92 c5 91 bb b3 df 34 b7  |..............4.|
+000001a0  0b 62 60 bb 68 68 d5 bb  85 ff d0 5f e0 7f 7a 5f  |.b`.hh....._..z_|
+000001b0  56 f2 e5 87 0e dd c0 a3  bd ad 99 16 23 77 34 77  |V...........#w4w|
+000001c0  40 f4 67 8c 87 b0 b3 f3  3b 68 28 e3 dc d6 e6 b3  |@.g.....;h(.....|
+000001d0  ac 00 0d 45 1e e0 7f e4  30 82 1b b9 89 a5 39 6c  |...E....0.....9l|
+000001e0  e3 57 3c 09 6a ee 2f ef  96 b9 b4 b0 6b bf ef 43  |.W<.j./.....k..C|
+000001f0  86 6a 24 01 43 a1 22 ec  9e 15 84 f5 e4 ac 1d e6  |.j$.C.".........|
+00000200  38 06 53 fe 4b f6 23 15  22 ee 02 e4 38 9c 3a 0a  |8.S.K.#."...8.:.|
+00000210  58 c5 01 6a 6e bb e7 d4  ef 15 e9 42 76 96 7b d1  |X..jn......Bv.{.|
+00000220  54 77 8c 39 9e 51 71 9d  d1 b8 06 a2 84 3c 12 ab  |Tw.9.Qq......<..|
+00000230  55 6f a0 8f 02 95 a9 7c  c5 99 fc 71 e0 83 e4 57  |Uo.....|...q...W|
+00000240  bf e3 a3 66 8a 41 9c 9d  00 6d f0 25 16 fd 91 4f  |...f.A...m.%...O|
+00000250  86 29 ce e7 77 89 fe 54  6d cf 96 cf 15 53 43 8d  |.)..w..Tm....SC.|
+00000260  b3 54 4e 4e 2c ad 60 e0  c2 ad dc a0 c8 70 c3 e8  |.TNN,.`......p..|
+00000270  dc 61 95 0f 15 4e 16 03  03 00 5e 00 00 00 00 00  |.a...N....^.....|
+00000280  00 00 04 12 0f 1c 13 73  45 13 64 2a e1 c4 ad a6  |.......sE.d*....|
+00000290  2f 8b 6e ad 30 7b 35 72  29 87 d6 cc 7a e5 7d 7a  |/.n.0{5r)...z.}z|
+000002a0  c6 71 b8 bb c2 58 4b d8  4e f1 e4 56 5d 96 e3 c7  |.q...XK.N..V]...|
+000002b0  ee 4a 20 64 83 ea 41 c8  03 10 7d 81 94 5e b0 c8  |.J d..A...}..^..|
+000002c0  c1 ed c0 67 24 0e 56 20  28 75 25 99 bb eb 56 8e  |...g$.V (u%...V.|
+000002d0  c2 bb de 77 67 80 b3 43  f7 16 03 03 00 a0 00 00  |...wg..C........|
+000002e0  00 00 00 00 00 05 f4 5f  a4 df 41 67 23 b0 b2 50  |......._..Ag#..P|
+000002f0  e5 d2 f1 55 ce f5 ef ad  64 c3 98 78 5d 03 25 ae  |...U....d..x].%.|
+00000300  6e 76 5e bb 9b 04 5e 2b  9e cd 16 7a 7c f7 fd 36  |nv^...^+...z|..6|
+00000310  9d e0 25 66 93 8b 85 73  2a 63 6a 68 c5 c4 31 0e  |..%f...s*cjh..1.|
+00000320  86 96 7c 33 c9 98 51 b2  c4 2f 2c 22 18 37 01 7d  |..|3..Q../,".7.}|
+00000330  81 46 74 a1 d0 a6 70 80  d0 91 94 f1 d8 03 b1 a4  |.Ft...p.........|
+00000340  1e 17 b9 0c 38 5d 12 55  66 79 93 c2 f9 cf 03 e0  |....8].Ufy......|
+00000350  8d 4c d4 93 1c 12 49 81  3b 33 31 62 b2 dd 29 a5  |.L....I.;31b..).|
+00000360  ac 7a 37 5a f0 85 c6 88  af c7 42 40 4b 29 fb 5b  |.z7Z......B@K).[|
+00000370  1b 56 9f 83 bf a6 b9 72  1e 7e 26 73 3a 8e 14 03  |.V.....r.~&s:...|
+00000380  03 00 19 00 00 00 00 00  00 00 06 e5 5f 53 1b 11  |............_S..|
+00000390  45 af 56 2f 80 1b 24 82  77 2c d5 78 16 03 03 00  |E.V/..$.w,.x....|
+000003a0  28 00 00 00 00 00 00 00  00 17 31 bc e9 6e 74 1c  |(.........1..nt.|
+000003b0  24 73 47 9d e0 e4 9e 42  9b 3f 3a ec 40 1e ca 37  |$sG....B.?:.@..7|
+000003c0  da ff 8d a2 7f a2 1f ea  95                       |.........|
 >>> Flow 10 (server to client)
-00000000  14 03 03 00 19 00 80 4c  9c ca 45 ce ec 50 e8 8d  |.......L..E..P..|
-00000010  45 e2 b9 77 ac f7 e0 cd  28 ed cb e0 49 93 16 03  |E..w....(...I...|
-00000020  03 00 28 c1 b4 e0 56 8e  ea 84 c7 00 4b 4b 3d 48  |..(...V.....KK=H|
-00000030  0a da 27 ea e6 e7 90 bd  93 80 2a 1a d1 08 f5 92  |..'.......*.....|
-00000040  78 f2 27 b5 ff e8 df 6a  9f b3 81 17 03 03 00 21  |x.'....j.......!|
-00000050  c1 b4 e0 56 8e ea 84 c8  c6 34 c1 20 46 d5 56 08  |...V.....4. F.V.|
-00000060  e1 34 4b 85 c7 5a 7b 10  87 90 b0 12 fa bd 8a b5  |.4K..Z{.........|
-00000070  78 16 03 03 00 1c c1 b4  e0 56 8e ea 84 c9 93 0a  |x........V......|
-00000080  8a fa f3 9b 95 d2 a0 42  89 81 62 f0 7c dd df f5  |.......B..b.|...|
-00000090  9b d3                                             |..|
+00000000  14 03 03 00 19 ad 26 44  4c 45 02 3d 91 63 98 5d  |......&DLE.=.c.]|
+00000010  6c 6a 57 58 26 41 35 6b  8e 06 6d e7 f7 89 16 03  |ljWX&A5k..m.....|
+00000020  03 00 28 4c d5 cd 3a c7  d7 e7 ee cb 56 3b 9c 33  |..(L..:.....V;.3|
+00000030  b0 dd de 8a d6 f8 e7 7a  cc 8b 4a 8a a8 da a0 2f  |.......z..J..../|
+00000040  c7 bb f1 9d 9e 5c fe f0  88 0a 2a 17 03 03 00 21  |.....\....*....!|
+00000050  4c d5 cd 3a c7 d7 e7 ef  78 30 73 80 7b 51 01 06  |L..:....x0s.{Q..|
+00000060  21 84 42 7c 8f f6 16 90  2b d6 f1 58 d3 5b 39 5c  |!.B|....+..X.[9\|
+00000070  5a 16 03 03 00 1c 4c d5  cd 3a c7 d7 e7 f0 e6 51  |Z.....L..:.....Q|
+00000080  88 bd ae 02 e2 ec 33 8d  91 18 03 3d de 8f 75 f5  |......3....=..u.|
+00000090  fe 59                                             |.Y|
 >>> Flow 11 (client to server)
-00000000  16 03 03 00 a9 00 00 00  00 00 00 00 01 ab bc 6c  |...............l|
-00000010  48 19 ab b4 9a 8a be d4  df 13 ed bc 7f 7f 56 d7  |H.............V.|
-00000020  63 52 19 16 08 87 d2 32  01 eb fd b2 51 d1 30 70  |cR.....2....Q.0p|
-00000030  d1 73 30 cf c5 7a 32 a6  e1 38 24 fb 53 8c d7 1b  |.s0..z2..8$.S...|
-00000040  f0 02 7b 50 fb 54 ef b0  a1 b1 67 92 73 4c d4 6c  |..{P.T....g.sL.l|
-00000050  b4 64 62 17 ce 36 0d 9e  78 a5 7f 66 a2 eb f8 42  |.db..6..x..f...B|
-00000060  8e ce 2b 99 51 7d e6 dd  bd f9 99 8d 7f f1 75 97  |..+.Q}........u.|
-00000070  7c 1e ea 08 f7 05 60 33  ff a0 f8 10 7b 2c 21 ca  ||.....`3....{,!.|
-00000080  d4 b8 7a f7 8c 7e f6 07  1c f7 79 38 7a db 58 53  |..z..~....y8z.XS|
-00000090  bf 2f 67 ff f1 15 cb 08  66 10 4b 42 de 67 c6 73  |./g.....f.KB.g.s|
-000000a0  62 80 88 d6 6c ad 37 c1  73 4a e5 17 ee 53        |b...l.7.sJ...S|
+00000000  16 03 03 00 af 00 00 00  00 00 00 00 01 24 33 e4  |.............$3.|
+00000010  20 a4 e9 30 31 db f3 2b  27 38 6a 38 1d 99 b3 92  | ..01..+'8j8....|
+00000020  33 2b 73 17 94 b1 a9 63  f5 4d f5 5c d8 e7 9b a0  |3+s....c.M.\....|
+00000030  14 37 6b 13 09 bf b8 c6  fb 5f d0 2d 9a 89 c6 a2  |.7k......_.-....|
+00000040  18 d4 31 56 92 2c 84 b3  43 7d 36 42 70 43 17 e4  |..1V.,..C}6BpC..|
+00000050  be f0 ea 72 6d a9 2d 0a  2a 05 08 2a 16 54 d7 2d  |...rm.-.*..*.T.-|
+00000060  c2 86 f9 0c 4d ce 35 05  bd f3 1c a5 63 73 de 39  |....M.5.....cs.9|
+00000070  34 8f 24 da 99 93 c2 19  1f 09 db 05 b0 b4 71 32  |4.$...........q2|
+00000080  b3 9e f5 da aa d1 b2 ed  2d 73 b7 b6 13 eb 08 d4  |........-s......|
+00000090  2f e8 7a 6a 0b 55 e9 ae  6f 9b b9 8e be 7a 23 60  |/.zj.U..o....z#`|
+000000a0  58 c2 2d 23 c9 19 22 38  cf 89 33 f3 e2 72 0c 91  |X.-#.."8..3..r..|
+000000b0  00 33 56 56                                       |.3VV|
 >>> Flow 12 (server to client)
-00000000  16 03 03 00 89 c1 b4 e0  56 8e ea 84 ca 4d a6 52  |........V....M.R|
-00000010  d1 74 68 5c e9 fa 3f 57  3e b3 27 d7 5e 2b 65 18  |.th\..?W>.'.^+e.|
-00000020  95 65 a8 cb 52 5c bd 36  bf af cc 3f a2 f3 af f1  |.e..R\.6...?....|
-00000030  81 91 46 4e e4 7f 34 67  2c 07 11 72 c3 7f 85 d7  |..FN..4g,..r....|
-00000040  28 14 b4 d8 80 38 40 fc  f5 a8 59 6c d6 ae e7 b8  |(....8@...Yl....|
-00000050  a2 b6 90 41 87 90 5d 59  4e 60 2a 9b 2a f5 d3 2c  |...A..]YN`*.*..,|
-00000060  92 23 7b 3e 46 a2 86 64  ca 83 db ab ba ad 2c 02  |.#{>F..d......,.|
-00000070  58 f4 e4 0e 52 72 f0 4d  23 5a d1 c0 8d 39 5b f7  |X...Rr.M#Z...9[.|
-00000080  02 d3 83 c1 8e 10 8d 34  98 e9 97 47 98 eb 16 03  |.......4...G....|
-00000090  03 02 71 c1 b4 e0 56 8e  ea 84 cb 72 89 65 13 ed  |..q...V....r.e..|
-000000a0  18 95 49 27 41 03 ab 33  a7 5f 8d 10 34 92 36 2d  |..I'A..3._..4.6-|
-000000b0  2f 1b 96 35 5b 8c e3 82  69 cf 94 46 de af bf da  |/..5[...i..F....|
-000000c0  c5 ff f1 49 eb 46 d3 56  9f 01 3c 19 f1 db c3 99  |...I.F.V..<.....|
-000000d0  6c 3a 7c 93 8c 09 74 70  85 e0 d9 23 98 cb ff 9c  |l:|...tp...#....|
-000000e0  b3 d2 32 b7 e0 bb d9 be  c1 26 3e bd 23 f8 f7 d5  |..2......&>.#...|
-000000f0  f4 7a 47 fd 93 16 f9 b3  2f f2 2d c7 52 77 e4 57  |.zG...../.-.Rw.W|
-00000100  7d 4f 75 23 26 16 fa b8  05 39 ed dd 5f 4a a3 92  |}Ou#&....9.._J..|
-00000110  47 18 e2 8a b6 ad 55 24  0a 8d 4d 13 2e 4f 91 1d  |G.....U$..M..O..|
-00000120  bb d2 49 8f 59 e7 e6 71  32 9f ff da d5 d7 93 4f  |..I.Y..q2......O|
-00000130  0e 47 61 28 41 62 14 f5  11 83 6c 6c 71 5a 2e 30  |.Ga(Ab....llqZ.0|
-00000140  c1 33 70 48 f9 27 cc 43  41 bc 5d 0d 73 75 8f fc  |.3pH.'.CA.].su..|
-00000150  0b dc 42 63 cd 98 bf e6  62 bd 02 fc 32 b3 18 64  |..Bc....b...2..d|
-00000160  83 30 82 0e 12 4a 79 7a  d6 31 d8 a4 29 89 85 70  |.0...Jyz.1..)..p|
-00000170  3a a6 b5 16 91 5e ca 13  e1 90 58 c1 60 5e af 82  |:....^....X.`^..|
-00000180  18 3b 5d 0b f8 8d 43 5f  82 54 c9 34 0b 3b 3f a7  |.;]...C_.T.4.;?.|
-00000190  e2 a5 04 db f2 01 b6 ef  4f f8 cb cb 7e c8 ec d2  |........O...~...|
-000001a0  3e b5 13 56 5f d5 96 2e  c5 d6 e6 22 79 1a 4e 80  |>..V_......"y.N.|
-000001b0  ef 67 07 0d 94 c3 a5 35  78 35 95 b4 17 87 f9 19  |.g.....5x5......|
-000001c0  ba 44 62 f7 9a 4c 4c 3d  2e 23 11 fa b2 74 36 29  |.Db..LL=.#...t6)|
-000001d0  27 2a 52 a6 46 51 67 8b  15 d7 36 d0 20 77 15 7a  |'*R.FQg...6. w.z|
-000001e0  11 1e ba 24 8c c9 42 bd  fe 29 7a 20 42 f4 b4 7e  |...$..B..)z B..~|
-000001f0  27 1e 28 93 ad 0a 0d d6  59 5c 8c 5a 94 10 a6 0f  |'.(.....Y\.Z....|
-00000200  20 92 28 7f a6 93 da a7  ed 93 79 67 6a 6b 56 1d  | .(.......ygjkV.|
-00000210  11 47 7e 00 4f e5 8c 8d  ad d8 63 2e e2 62 f8 eb  |.G~.O.....c..b..|
-00000220  ed 89 c8 80 5f fa 04 a4  6e f0 77 ea 74 6c 5b 77  |...._...n.w.tl[w|
-00000230  fd e4 b7 1d 4c 52 1b 98  53 60 5c 7f 0a 76 55 00  |....LR..S`\..vU.|
-00000240  47 44 3c 08 62 28 2f 17  99 6d 59 1c 29 bf 12 21  |GD<.b(/..mY.)..!|
-00000250  a6 cc 14 1e 8d a9 a1 a4  e7 2a cc d3 5d 30 fc 8c  |.........*..]0..|
-00000260  9a 22 65 0f 97 a9 bf 64  af f7 a7 36 68 1a f1 4a  |."e....d...6h..J|
-00000270  71 ab f1 04 e6 9a b4 3a  d3 50 33 a5 39 23 dc 9e  |q......:.P3.9#..|
-00000280  b1 87 65 5d d7 db b5 0b  a4 ee 9e 12 f6 7f 50 4b  |..e]..........PK|
-00000290  9a 0b 7f 1a 50 b1 35 5f  72 f1 93 10 5d 15 86 3e  |....P.5_r...]..>|
-000002a0  82 14 55 43 53 08 de 01  c4 48 d6 bf 72 9b 70 83  |..UCS....H..r.p.|
-000002b0  96 de 14 e0 d1 99 5c 3d  29 f0 63 2b 02 7b eb 49  |......\=).c+.{.I|
-000002c0  0f 4c c8 17 11 3d 96 43  d3 ee 36 b2 21 47 f2 ae  |.L...=.C..6.!G..|
-000002d0  6f c1 18 01 9f 03 69 6d  f1 33 c3 54 9a 6f b5 76  |o.....im.3.T.o.v|
-000002e0  2a ee a9 8e 9f be 11 b3  35 58 68 15 3a a2 12 64  |*.......5Xh.:..d|
-000002f0  ef 79 51 2f f7 69 8a 9e  f9 dc 8f 9d 63 4e fc 6e  |.yQ/.i......cN.n|
-00000300  cc fa b8 a2 16 03 03 00  e5 c1 b4 e0 56 8e ea 84  |............V...|
-00000310  cc 49 45 a7 db e1 92 7b  42 6d 30 93 1d c9 d7 2b  |.IE....{Bm0....+|
-00000320  20 3a eb b7 d8 f6 06 43  16 f9 75 3d b8 a4 6b 7f  | :.....C..u=..k.|
-00000330  d8 24 8d b8 c2 8c 1e 7b  b9 9e e2 f3 84 c1 1f 19  |.$.....{........|
-00000340  65 ff 85 cb e3 d4 7b c5  7e cd 1f a8 4e 06 ae 60  |e.....{.~...N..`|
-00000350  25 e5 b5 2d bb e7 33 b3  54 62 b3 8c 11 cf 9e 8c  |%..-..3.Tb......|
-00000360  b1 42 45 49 92 01 9f 28  80 b4 cd 73 31 56 28 79  |.BEI...(...s1V(y|
-00000370  65 f1 cf 66 4a 36 84 f4  27 03 a2 67 48 5e 99 ab  |e..fJ6..'..gH^..|
-00000380  db 45 95 a2 cd 35 d4 b2  2b cd 5a 5b 75 80 c2 3b  |.E...5..+.Z[u..;|
-00000390  96 c0 8b 68 19 62 08 fa  ed 76 c0 72 83 6d 97 9f  |...h.b...v.r.m..|
-000003a0  08 05 4a 65 9a 69 3e a6  10 a5 8c c0 b4 b2 d0 02  |..Je.i>.........|
-000003b0  d4 61 d1 ea 9f 4a f5 b6  07 41 0c dd 3c 62 f2 c1  |.a...J...A..<b..|
-000003c0  9e 82 8b be 26 b7 73 c8  1f 52 81 43 15 40 21 48  |....&.s..R.C.@!H|
-000003d0  7c 08 5d fa 41 f0 47 ee  88 41 ee 82 04 67 85 81  ||.].A.G..A...g..|
-000003e0  03 69 72 ba 84 fc b3 d3  24 34 67 41 3a 16 16 03  |.ir.....$4gA:...|
-000003f0  03 00 46 c1 b4 e0 56 8e  ea 84 cd f9 b0 ba c8 34  |..F...V........4|
-00000400  02 9f e8 78 8e 96 08 5d  12 14 82 22 e9 02 d5 db  |...x...]..."....|
-00000410  ef 00 a2 30 d1 28 93 5f  a5 c2 a8 14 bf 9a 17 88  |...0.(._........|
-00000420  c8 d8 09 86 9a 3b 79 68  ec ae 47 70 b9 4c d5 2b  |.....;yh..Gp.L.+|
-00000430  51 3c 08 82 1d 30 62 b0  55                       |Q<...0b.U|
+00000000  16 03 03 00 89 4c d5 cd  3a c7 d7 e7 f1 13 d8 b7  |.....L..:.......|
+00000010  c7 5b 06 d1 d9 51 dc ba  71 b2 07 d5 61 78 21 e6  |.[...Q..q...ax!.|
+00000020  21 68 3e 46 06 a6 ad a5  a9 5f 08 d7 1c 52 ec 6b  |!h>F....._...R.k|
+00000030  dc ba fd 9d dd c2 6a fb  4a 10 5a f4 5b 02 9d 65  |......j.J.Z.[..e|
+00000040  4b e0 a0 cc 0c 4e cc 5c  e6 f7 06 0b 0b a6 65 d0  |K....N.\......e.|
+00000050  50 84 6c c6 f5 a4 c2 7c  bc 61 27 f2 7c b8 50 89  |P.l....|.a'.|.P.|
+00000060  93 e2 6a 5e 8b 12 d8 28  d1 7f 48 31 8a a8 7b 62  |..j^...(..H1..{b|
+00000070  0e cc 5f 81 2c 8b 4c 14  e2 3f c5 90 7a 65 76 11  |.._.,.L..?..zev.|
+00000080  a8 ea f1 08 64 d5 71 68  b5 03 d7 52 22 5e 16 03  |....d.qh...R"^..|
+00000090  03 02 71 4c d5 cd 3a c7  d7 e7 f2 81 98 e6 33 99  |..qL..:.......3.|
+000000a0  85 cc ee 27 2b 5d be 7a  e0 91 a8 6b 35 df 9c 60  |...'+].z...k5..`|
+000000b0  db 38 61 d8 63 f0 7e b5  f1 76 6b a9 34 28 17 b9  |.8a.c.~..vk.4(..|
+000000c0  c8 4c 64 c9 95 54 8e 4e  6f 39 06 e7 d8 31 bc d5  |.Ld..T.No9...1..|
+000000d0  6c 7a bb c6 95 32 14 e7  f1 3d 8f 3d de 7c 00 79  |lz...2...=.=.|.y|
+000000e0  b2 c9 82 2b a6 4b 5e d0  43 76 1a ae 58 1e 1a 4c  |...+.K^.Cv..X..L|
+000000f0  de 09 ea 9b e1 ce fd 30  98 60 08 6e a3 2e f7 25  |.......0.`.n...%|
+00000100  c5 6a 89 fb fe 2a 02 6c  51 08 0d 9c 23 66 af c5  |.j...*.lQ...#f..|
+00000110  e6 f3 ed 6c 29 fb 34 f5  84 58 7b d2 e1 0a 21 46  |...l).4..X{...!F|
+00000120  cb 7a 1d ba 44 ba 84 3b  75 ae 9b 1b 3d 71 fe 5c  |.z..D..;u...=q.\|
+00000130  d5 55 04 3d d3 27 5f 5c  3a 16 4e 38 91 98 1e b5  |.U.=.'_\:.N8....|
+00000140  73 a5 0c 8c 76 8b 8f 31  09 ee 34 1f a8 1f 3e 84  |s...v..1..4...>.|
+00000150  28 bb c6 18 0f ce 10 9f  69 63 72 78 f1 14 51 2f  |(.......icrx..Q/|
+00000160  67 f2 2d f0 9b e6 3e 0a  f1 7e 3e ca a6 92 c0 f5  |g.-...>..~>.....|
+00000170  91 0f 35 00 ff de cf ac  33 d9 29 23 95 cd b2 6e  |..5.....3.)#...n|
+00000180  25 f8 34 ff 5b 36 6a 97  a7 5a ed 33 28 fe 45 2e  |%.4.[6j..Z.3(.E.|
+00000190  43 41 41 b7 a6 84 50 b6  cb 14 8c 8c c3 f0 53 17  |CAA...P.......S.|
+000001a0  54 e0 40 75 52 de c4 ef  58 ef 36 b4 d2 f6 f8 10  |T.@uR...X.6.....|
+000001b0  ba 77 b2 4a d1 b3 53 22  12 0d ef 5b 8d 87 70 7d  |.w.J..S"...[..p}|
+000001c0  56 64 5d d0 da d7 39 87  4c 0e 0a 9c 92 b5 1f 8b  |Vd]...9.L.......|
+000001d0  03 05 02 dc 12 d4 f9 94  9a 4b 2b 25 ec 3b 11 84  |.........K+%.;..|
+000001e0  a6 09 f9 5c 55 e7 8b 48  cc b4 bf af 3f a4 3e f1  |...\U..H....?.>.|
+000001f0  c7 77 1c e9 ce 35 28 98  7e ac 41 6f d1 c1 44 42  |.w...5(.~.Ao..DB|
+00000200  02 e8 90 bf 3a 94 28 e7  a5 28 61 6c 02 3b fe 78  |....:.(..(al.;.x|
+00000210  95 70 81 d3 b2 78 6e 8a  a9 db cf 5a 00 6f 00 0c  |.p...xn....Z.o..|
+00000220  bd 78 e0 c0 eb d7 e4 75  5a 1f 6a 36 7f 73 db be  |.x.....uZ.j6.s..|
+00000230  9c 03 cc e2 ef 8e fd ca  fe 07 d9 66 78 f3 e9 bc  |...........fx...|
+00000240  c4 3c 57 c5 24 93 0a 88  f4 1b 4a 14 5a 5f 34 4c  |.<W.$.....J.Z_4L|
+00000250  d4 44 6e 97 79 df bb f3  10 07 8d 49 6f 76 b6 28  |.Dn.y......Iov.(|
+00000260  96 a8 53 b0 8b fd 41 be  e7 7d 4d 31 7a f0 f0 bf  |..S...A..}M1z...|
+00000270  90 41 93 6f ca e7 15 8f  c0 42 ac cb c8 5d 5f fc  |.A.o.....B...]_.|
+00000280  d6 4a 13 9b 60 58 e2 45  9b 71 e4 8a 2f 63 17 8c  |.J..`X.E.q../c..|
+00000290  c8 4b 8e fc 94 3c 38 f8  fe b9 dd a2 21 c1 b1 3f  |.K...<8.....!..?|
+000002a0  d8 1c 99 5b 55 0b 25 61  3c b0 ec 95 d9 fb ab 1c  |...[U.%a<.......|
+000002b0  30 3c bd ba 5e 5b 17 82  e3 8a 8f 27 bd d5 1d 4d  |0<..^[.....'...M|
+000002c0  c9 0d c4 32 1d a1 59 86  aa 91 14 6c 06 34 8c d3  |...2..Y....l.4..|
+000002d0  d2 c5 23 7b 7d 3a ef 28  2a 07 e1 95 bd be eb ce  |..#{}:.(*.......|
+000002e0  60 a2 1c e1 5b 16 44 65  fb e0 8b f7 d7 c5 8d 6e  |`...[.De.......n|
+000002f0  5b 41 82 32 17 f7 1e df  46 8d af 46 4f 0c 3c f5  |[A.2....F..FO.<.|
+00000300  b7 29 3e c3 16 03 03 00  e5 4c d5 cd 3a c7 d7 e7  |.)>......L..:...|
+00000310  f3 a8 7b 0e e4 ba 06 bf  23 e4 f3 53 a1 81 17 c3  |..{.....#..S....|
+00000320  9a bd 23 37 14 d7 ab 18  d7 38 c5 b7 c0 7d 4b 04  |..#7.....8...}K.|
+00000330  70 ac 26 e2 eb 4a a7 a1  ee c2 d6 b4 8e 6f 43 4e  |p.&..J.......oCN|
+00000340  ba 27 3b d7 d0 63 21 0f  24 9b 28 cd b1 00 4e 5c  |.';..c!.$.(...N\|
+00000350  50 88 11 54 13 1c 16 13  1c 19 32 cc 8e bf 02 d7  |P..T......2.....|
+00000360  df e1 b0 0c 9d ce 73 a2  71 bc ef 2c 37 f4 43 99  |......s.q..,7.C.|
+00000370  5b 24 af e8 69 57 76 03  3c 80 17 4e db 57 41 7d  |[$..iWv.<..N.WA}|
+00000380  77 4e a5 88 aa 54 f7 bc  96 8c 6b 91 2e 96 6f 95  |wN...T....k...o.|
+00000390  f4 e9 c7 4c 67 67 78 4c  a1 b1 92 0b 99 a7 4f 4d  |...LggxL......OM|
+000003a0  99 c7 1e 10 8a 2a df 05  c1 32 2b b1 e3 96 6f 15  |.....*...2+...o.|
+000003b0  c7 5f 4d 6d 01 39 d5 5d  fc 32 e4 b6 74 fd 20 2f  |._Mm.9.].2..t. /|
+000003c0  8b c5 a8 10 56 d4 f9 92  d1 2f 94 a2 fe 02 20 62  |....V..../.... b|
+000003d0  0c af cc 43 47 0e a7 b4  61 de 6c 23 21 11 e1 37  |...CG...a.l#!..7|
+000003e0  34 20 1c c5 48 51 4a 5a  1a 6a fc bc 00 89 16 03  |4 ..HQJZ.j......|
+000003f0  03 00 46 4c d5 cd 3a c7  d7 e7 f4 97 0a 55 48 bd  |..FL..:......UH.|
+00000400  46 d5 9d 06 39 37 71 f5  73 2f 97 c4 7a 26 0b dc  |F...97q.s/..z&..|
+00000410  8d 46 79 8c 01 54 30 0f  a7 5b 0c d5 1d fd 44 5b  |.Fy..T0..[....D[|
+00000420  ec 03 ac d4 cc de 3a 75  c8 14 e3 d9 c5 92 0d a1  |......:u........|
+00000430  79 3a 86 58 ea a2 02 ee  31                       |y:.X....1|
 >>> Flow 13 (client to server)
-00000000  16 03 03 02 71 00 00 00  00 00 00 00 02 e6 e9 6d  |....q..........m|
-00000010  17 f7 8e a1 2f 1d 1c d0  77 6e ca 61 94 aa e3 bf  |..../...wn.a....|
-00000020  21 79 61 57 b4 2a 76 56  63 5e ec 3c 3d 0c 67 d8  |!yaW.*vVc^.<=.g.|
-00000030  d8 37 de 82 55 b3 3a 63  22 0a c8 e4 c8 70 38 07  |.7..U.:c"....p8.|
-00000040  3f e6 02 91 01 57 ed c6  da 20 6e c9 7b 6b f4 20  |?....W... n.{k. |
-00000050  10 66 19 57 c0 5c 06 55  de 79 5b 3a cc 76 28 09  |.f.W.\.U.y[:.v(.|
-00000060  f4 52 2c 7c 29 05 b8 a5  be 8f f5 c2 0d f6 81 b0  |.R,|)...........|
-00000070  2a 80 05 4d 3a 4e 7d e0  7e e2 36 5e d6 87 b2 43  |*..M:N}.~.6^...C|
-00000080  8a af 3b 4a 20 61 70 a6  28 a1 23 79 6b b6 25 75  |..;J ap.(.#yk.%u|
-00000090  46 67 06 f7 4f 00 d3 ff  eb d0 04 c5 72 0b dd 05  |Fg..O.......r...|
-000000a0  2c 7a d7 ef 7f 3b 07 51  c0 b7 c6 0e a0 a1 6f 5d  |,z...;.Q......o]|
-000000b0  33 f7 91 e1 14 7b f9 a4  87 15 1a 86 e8 2e 73 19  |3....{........s.|
-000000c0  d3 65 fc 31 89 46 09 92  76 3a 17 56 f2 89 8b 56  |.e.1.F..v:.V...V|
-000000d0  4b 5a 64 e1 83 fe 35 d3  78 3e 47 22 97 75 ff 9a  |KZd...5.x>G".u..|
-000000e0  30 67 ad 07 93 73 ab c6  74 41 96 9c 6a b5 4e be  |0g...s..tA..j.N.|
-000000f0  ae 87 b1 62 99 cd 75 34  ab 04 41 21 09 de e0 03  |...b..u4..A!....|
-00000100  88 52 df ee df 22 a0 7e  5e 51 25 88 56 04 da aa  |.R...".~^Q%.V...|
-00000110  e8 32 35 ca 65 5a 88 6c  2c e9 ee 65 9c b0 92 a2  |.25.eZ.l,..e....|
-00000120  58 8b c3 5f ab 0c 44 64  5d f4 3f 3d 76 5b 3a df  |X.._..Dd].?=v[:.|
-00000130  57 60 19 0f c8 5e fc 1b  9a a7 99 a3 3b fc 86 83  |W`...^......;...|
-00000140  3d f5 c5 e8 a3 99 c2 41  76 aa ad 87 2e da 09 4a  |=......Av......J|
-00000150  e1 6d cc 2e 6c 17 33 44  4e 63 4a 24 47 b6 1d 51  |.m..l.3DNcJ$G..Q|
-00000160  60 f9 ca 30 b4 17 00 9d  a5 59 ff 83 de fe 85 18  |`..0.....Y......|
-00000170  b0 ad ab 9f 2e 26 9d 71  51 75 ac f0 30 4e 08 96  |.....&.qQu..0N..|
-00000180  85 a1 45 d1 cc 8f 0e c7  79 60 c9 29 ba ed 6b 63  |..E.....y`.)..kc|
-00000190  00 ed b9 52 ee 39 72 be  51 56 b9 71 be 69 21 14  |...R.9r.QV.q.i!.|
-000001a0  fc 7d ff 7a 75 e0 72 da  bf e1 1e 1a 36 8c b3 94  |.}.zu.r.....6...|
-000001b0  f3 2c 24 ad 06 63 7e 2d  52 84 4b 3e 3d f0 bf 59  |.,$..c~-R.K>=..Y|
-000001c0  e5 92 b4 25 1b 74 0b e6  a8 29 28 ad 72 05 19 ea  |...%.t...)(.r...|
-000001d0  18 38 07 37 5c 8b 21 6b  09 65 f7 27 ac c6 4e 3e  |.8.7\.!k.e.'..N>|
-000001e0  b9 38 df 92 5a 1c 7a fa  8f 3a 1a 54 b2 05 3e 42  |.8..Z.z..:.T..>B|
-000001f0  5c 50 aa 88 6d fb ce 4b  7b f6 91 2d ff 0f cb 2e  |\P..m..K{..-....|
-00000200  80 16 e6 1f e6 96 5e 8a  c1 bc 81 e6 a7 81 19 3f  |......^........?|
-00000210  89 c6 35 1b b1 38 93 43  45 f9 29 c7 ab 63 af 61  |..5..8.CE.)..c.a|
-00000220  02 32 29 70 c1 ca 10 cc  f2 9f ce ac 0f 50 4b 71  |.2)p.........PKq|
-00000230  ee 09 2d 69 81 63 c5 40  19 ff 16 93 88 e9 ba 5b  |..-i.c.@.......[|
-00000240  2c 3c 6a ae c8 20 a3 72  bf c8 9e b1 d3 5e ef d3  |,<j.. .r.....^..|
-00000250  cf 21 58 9e 1e 29 1a 4a  60 53 0b 5d 68 d4 dd b0  |.!X..).J`S.]h...|
-00000260  cd 5f 50 66 78 7c 4f f6  d2 fa 7e ad 61 b2 00 53  |._Pfx|O...~.a..S|
-00000270  7e 3c 39 88 28 d5 16 03  03 00 5e 00 00 00 00 00  |~<9.(.....^.....|
-00000280  00 00 03 de 1c f1 51 f0  3f 55 e8 3d 61 d0 d1 b9  |......Q.?U.=a...|
-00000290  25 9b 4e e0 a1 8d a0 04  4d 52 69 b8 9d 44 9d c0  |%.N.....MRi..D..|
-000002a0  16 bd 1b dc 67 6f 59 0b  e9 b6 26 f7 5e 69 b8 51  |....goY...&.^i.Q|
-000002b0  af cd d9 ef ce d1 a7 90  5c a2 b6 0c b1 74 3f 77  |........\....t?w|
-000002c0  a5 78 17 3d 27 33 a9 4f  8c d1 10 4e 47 b2 82 62  |.x.='3.O...NG..b|
-000002d0  45 f7 dc 8a f9 ad f0 57  a9 16 03 03 00 a0 00 00  |E......W........|
-000002e0  00 00 00 00 00 04 7c d8  bc 7f e4 da 29 f3 83 eb  |......|.....)...|
-000002f0  aa 87 a1 c1 79 5b 92 10  cc 8b b1 b7 8a 68 ed 51  |....y[.......h.Q|
-00000300  7b 47 ae cf e2 a9 c3 49  27 96 c6 12 2a 7b ed 49  |{G.....I'...*{.I|
-00000310  af ad 6d fd 67 61 31 37  ce 34 76 54 3c 47 20 79  |..m.ga17.4vT<G y|
-00000320  be 6e ed ef b3 e7 98 e5  5a d4 e5 eb 4a fe 13 5a  |.n......Z...J..Z|
-00000330  aa f6 26 41 62 98 a7 63  c7 7f d5 d9 67 07 16 35  |..&Ab..c....g..5|
-00000340  0b 3a da 19 6e ac 58 37  2b c5 ad 71 93 2a 59 39  |.:..n.X7+..q.*Y9|
-00000350  ae 09 36 21 a8 24 27 ac  c7 8c 43 1f 94 8c ac fb  |..6!.$'...C.....|
-00000360  e3 91 2b e1 50 76 00 77  b6 46 5b 3d 58 09 4d e9  |..+.Pv.w.F[=X.M.|
-00000370  bc 72 8e 41 78 fd c7 3e  0f 4b d7 45 2a 58 14 03  |.r.Ax..>.K.E*X..|
-00000380  03 00 19 00 00 00 00 00  00 00 05 24 21 57 81 2a  |...........$!W.*|
-00000390  a2 cf 2d 0e 3e a1 71 62  ba 1a 75 51 16 03 03 00  |..-.>.qb..uQ....|
-000003a0  28 00 00 00 00 00 00 00  00 02 14 6a 96 4c 7b f5  |(..........j.L{.|
-000003b0  e9 0d b3 49 e2 a4 ff 8a  0f a3 93 85 1e db ac e2  |...I............|
-000003c0  63 f4 02 c7 3c f4 14 82  0e                       |c...<....|
+00000000  16 03 03 02 71 00 00 00  00 00 00 00 02 f5 32 7e  |....q.........2~|
+00000010  04 f3 fc 4d d0 b8 9e 56  42 3b 9a 13 42 ec 14 11  |...M...VB;..B...|
+00000020  3e ee 93 84 ba 0c ed 8a  b1 96 0f 0d 47 1e 79 6c  |>...........G.yl|
+00000030  b6 56 b6 4a 19 b8 5a 3d  59 a6 9e 74 2d 13 4b b5  |.V.J..Z=Y..t-.K.|
+00000040  0b 2d 0d fb 85 5a d1 c8  7c 43 a8 e2 38 01 02 da  |.-...Z..|C..8...|
+00000050  ee 8c e7 75 01 1d 66 a2  57 04 c7 9c cf c7 4c e5  |...u..f.W.....L.|
+00000060  bd 43 c8 23 24 a3 f9 ce  cf 0b eb 63 48 3d 25 52  |.C.#$......cH=%R|
+00000070  0d 7c 16 07 05 19 3b 10  ca f6 0b d4 68 05 09 dd  |.|....;.....h...|
+00000080  ef 59 b3 69 9d 64 5a de  76 f7 8b ed ed 93 36 7f  |.Y.i.dZ.v.....6.|
+00000090  fa f8 1c a8 df 2d d9 35  0f d8 a3 08 a7 8a c2 37  |.....-.5.......7|
+000000a0  37 db 92 ec 18 aa ae 51  85 d3 a6 15 b4 ba d5 66  |7......Q.......f|
+000000b0  39 08 63 eb 47 c7 91 90  47 fa a4 4a 3b 84 c5 27  |9.c.G...G..J;..'|
+000000c0  7d eb 06 81 56 a2 db 2e  dd 72 18 6c 6f 1a 83 a0  |}...V....r.lo...|
+000000d0  6c 5a e4 44 c1 56 18 d8  b1 bf 26 ce 4f 66 7b 4e  |lZ.D.V....&.Of{N|
+000000e0  b6 9a 02 97 d6 fd 7b fe  c9 8a 20 53 14 1f 78 45  |......{... S..xE|
+000000f0  b4 17 d6 8e 9e a1 92 be  b5 4d 2a 08 0d c2 b8 99  |.........M*.....|
+00000100  96 91 47 87 96 f2 7a d7  1c 86 96 c9 02 1c 09 92  |..G...z.........|
+00000110  6e 07 a4 47 ed 85 c9 c6  16 c5 12 b1 1f 20 2c d1  |n..G......... ,.|
+00000120  ee 47 07 a0 35 f0 b3 c1  19 9e 45 6e 7d 6c 17 b1  |.G..5.....En}l..|
+00000130  4e 29 5f 83 fe 6c 3b ce  94 a9 42 c5 ea 4b 4b 60  |N)_..l;...B..KK`|
+00000140  b1 b2 fd f8 65 ba d7 48  f3 a1 12 84 ae 38 60 4f  |....e..H.....8`O|
+00000150  9e 60 91 4f 75 34 e8 af  df ce 30 0f 15 37 f8 95  |.`.Ou4....0..7..|
+00000160  32 53 31 c8 10 f9 7b 0a  df c7 f3 bc 1b 47 d4 9c  |2S1...{......G..|
+00000170  e7 01 3d c7 c2 e8 01 50  f5 18 87 13 2c c9 d9 bb  |..=....P....,...|
+00000180  4e f4 78 ec ec 67 cd 41  84 9f 62 50 30 d9 34 ea  |N.x..g.A..bP0.4.|
+00000190  86 02 9b 79 b8 f3 f2 e7  47 b8 dd 2d a6 7d 83 e8  |...y....G..-.}..|
+000001a0  9c 5a ca be e7 eb 18 c7  3d cb ea 6f 63 de a8 95  |.Z......=..oc...|
+000001b0  5c cc d4 74 e8 9c 61 4c  e3 5b 83 90 b6 33 d0 9e  |\..t..aL.[...3..|
+000001c0  4e a3 ec cc 33 a0 2c cf  ec f3 6a fb 33 7a 31 fd  |N...3.,...j.3z1.|
+000001d0  a9 66 19 a7 aa 6d ad 7e  16 cc dd e5 21 e2 9f 43  |.f...m.~....!..C|
+000001e0  5f 79 82 7a 2f d8 b5 29  1c 39 ca bc c3 7d 27 2d  |_y.z/..).9...}'-|
+000001f0  1a 24 87 33 67 dc a1 94  da 6f 39 9d 70 14 2b f6  |.$.3g....o9.p.+.|
+00000200  17 2b 8b 9f 46 e0 66 e3  60 13 3b dc d0 f3 fc 12  |.+..F.f.`.;.....|
+00000210  8a c9 cf 5d 47 c3 df 5d  2b a8 ee ff f7 f4 91 44  |...]G..]+......D|
+00000220  10 3c 55 f4 39 43 65 04  af 06 4a 29 72 a4 a2 c2  |.<U.9Ce...J)r...|
+00000230  f9 16 10 2e 75 88 9d 16  ab ae 83 bc 8a b3 16 b0  |....u...........|
+00000240  c5 c0 8f a2 ef b1 f4 dc  16 54 a5 4b f0 ff 87 6b  |.........T.K...k|
+00000250  1e b6 7b fd 58 24 04 dc  e4 e3 49 da c1 b2 9e a9  |..{.X$....I.....|
+00000260  ec 28 ec 13 f3 70 88 7e  f7 ba cd 3f a8 62 87 ea  |.(...p.~...?.b..|
+00000270  0e 90 73 65 0a d0 16 03  03 00 5e 00 00 00 00 00  |..se......^.....|
+00000280  00 00 03 13 86 bf a1 c3  7d e1 3e 6d 38 e6 f7 7a  |........}.>m8..z|
+00000290  17 18 60 06 43 74 ac 36  6a 18 b4 eb 13 71 36 2b  |..`.Ct.6j....q6+|
+000002a0  38 e5 7b 73 16 10 94 82  25 a4 1e c7 da 37 63 73  |8.{s....%....7cs|
+000002b0  91 cc a3 72 61 27 40 e6  66 09 5e 55 e4 28 66 18  |...ra'@.f.^U.(f.|
+000002c0  10 cb 91 1f 2e 64 fd 33  6d 80 a6 7e ed 87 51 0a  |.....d.3m..~..Q.|
+000002d0  27 4c 79 9f 5d ae 1e 3f  1d 16 03 03 00 a0 00 00  |'Ly.]..?........|
+000002e0  00 00 00 00 00 04 13 a1  76 b4 2b af 98 95 67 da  |........v.+...g.|
+000002f0  d7 95 51 6b fb 07 36 56  43 a2 46 70 84 d4 bc cb  |..Qk..6VC.Fp....|
+00000300  c7 07 99 9b ef 98 0e 97  9c 98 86 2d 73 df a7 62  |...........-s..b|
+00000310  17 d4 c4 f4 22 36 aa 1a  54 6d 24 6c fe 4d 60 94  |...."6..Tm$l.M`.|
+00000320  55 cd 6b b8 0b 90 74 07  b1 25 de 91 54 94 6d b0  |U.k...t..%..T.m.|
+00000330  16 f6 46 db f6 81 a8 ea  0b fd 14 f9 69 41 11 e6  |..F.........iA..|
+00000340  6e 27 aa 13 ba 4a fd 02  f9 c7 25 98 5b 52 38 6a  |n'...J....%.[R8j|
+00000350  e5 37 52 16 b1 49 ed 64  2c 2f b5 9d 09 4f f9 52  |.7R..I.d,/...O.R|
+00000360  5b 59 14 5f 29 00 64 a6  9a 60 14 84 a4 fc e0 19  |[Y._).d..`......|
+00000370  98 62 60 c3 d1 ed b8 e4  7f 1a 8a 88 36 4f 14 03  |.b`.........6O..|
+00000380  03 00 19 00 00 00 00 00  00 00 05 5c 46 50 33 d0  |...........\FP3.|
+00000390  f9 d4 34 38 94 5b cf ec  fd b5 78 27 16 03 03 00  |..48.[....x'....|
+000003a0  28 00 00 00 00 00 00 00  00 64 b0 8f 5f 0b ee b9  |(........d.._...|
+000003b0  cf a3 8b 7f c8 f5 c0 15  b4 0b 2c d9 35 d3 10 4c  |..........,.5..L|
+000003c0  d7 a2 85 49 27 da ac 3e  83                       |...I'..>.|
 >>> Flow 14 (server to client)
-00000000  14 03 03 00 19 c1 b4 e0  56 8e ea 84 ce 15 74 59  |........V.....tY|
-00000010  09 db 45 fc 56 10 7b 9b  72 80 c7 43 50 ae 16 03  |..E.V.{.r..CP...|
-00000020  03 00 28 34 de 83 e9 7d  64 7d ac fe 8e 16 65 8e  |..(4...}d}....e.|
-00000030  69 b6 36 c6 7d ff fa 40  c5 29 75 64 3e 4f ce 29  |i.6.}..@.)ud>O.)|
-00000040  b8 cb 6b 8a d2 ad 6e 43  82 46 d8 17 03 03 00 21  |..k...nC.F.....!|
-00000050  34 de 83 e9 7d 64 7d ad  f2 b8 22 14 07 7c ba 69  |4...}d}..."..|.i|
-00000060  64 bf 07 a4 17 19 78 95  44 24 8e 0d 74 ee 76 a4  |d.....x.D$..t.v.|
-00000070  0c                                                |.|
+00000000  14 03 03 00 19 4c d5 cd  3a c7 d7 e7 f5 e7 2e 86  |.....L..:.......|
+00000010  51 c3 3b 33 40 35 de d9  3e f5 90 57 bd 27 16 03  |Q.;3@5..>..W.'..|
+00000020  03 00 28 29 25 c7 32 98  1a fb a1 59 6c 51 99 a6  |..()%.2....YlQ..|
+00000030  06 eb 61 34 58 3b 93 3a  60 32 e3 cd bd 01 53 e7  |..a4X;.:`2....S.|
+00000040  67 2e da 4e 7c 03 18 61  64 12 4f 17 03 03 00 21  |g..N|..ad.O....!|
+00000050  29 25 c7 32 98 1a fb a2  ec 62 50 50 3f b7 95 da  |)%.2.....bPP?...|
+00000060  79 23 b2 31 b4 e7 9b 85  38 24 c8 23 f4 85 88 45  |y#.1....8$.#...E|
+00000070  c2                                                |.|
 >>> Flow 15 (client to server)
-00000000  15 03 03 00 1a 00 00 00  00 00 00 00 01 7a a2 55  |.............z.U|
-00000010  87 f2 f5 e7 b5 74 74 29  e4 39 ec 33 6d bb 33     |.....tt).9.3m.3|
+00000000  15 03 03 00 1a 00 00 00  00 00 00 00 01 cd 69 8c  |..............i.|
+00000010  fc f8 75 55 b8 56 94 0b  ce 9f 7b f5 79 d2 8a     |..uU.V....{.y..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected
index 69ea5aee15..769e178e90 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 36 00 05 00 05  01 00 00 00 00 00 0a 00  |...6............|
-00000060  08 00 06 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
-00000070  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
-00000080  03 ff 01 00 01 00 00 12  00 00                    |..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 2e 76 f4 57 e4  |....Y...U...v.W.|
-00000010  86 08 9b 65 b1 4b ed e7  31 a6 f6 60 5a 80 21 a1  |...e.K..1..`Z.!.|
-00000020  05 a6 e1 62 e0 7a 66 06  37 2f 1c 20 ac ba 1b 52  |...b.zf.7/. ...R|
-00000030  dc af d0 f0 aa a4 8e dd  72 d5 79 79 d1 13 95 ae  |........r.yy....|
-00000040  4b 61 61 49 8d 9a 71 df  f7 d7 f4 40 c0 2f 00 00  |KaaI..q....@./..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 ba 6e a4 42 66  |....Y...U...n.Bf|
+00000010  66 03 9a fd 7d 88 99 9d  83 50 d1 0f a2 3c d0 f2  |f...}....P...<..|
+00000020  50 bc b2 28 55 de 77 9e  89 d9 db 20 54 0e f3 e7  |P..(U.w.... T...|
+00000030  ec e4 8f 8c ef cf ad 4a  c5 22 7c b9 09 cd ca 4a  |.......J."|....J|
+00000040  9a 3c 48 d5 23 2d d1 de  3d a8 66 40 c0 2f 00 00  |.<H.#-..=.f@./..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,19 +53,19 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  cd 0c 00 00 c9 03 00 17  41 04 f4 44 02 72 14 0c  |........A..D.r..|
-000002d0  e1 04 79 d4 0e 3c e5 8c  2a 50 44 32 d4 4c 7a d8  |..y..<..*PD2.Lz.|
-000002e0  d5 da 9c ca 61 1e 47 66  1c 75 26 60 71 1c c4 be  |....a.Gf.u&`q...|
-000002f0  be 31 82 46 53 d7 a9 b7  9b b0 80 1b 2a e1 86 66  |.1.FS.......*..f|
-00000300  55 6f 6f d1 6d 99 c7 e2  ca e1 04 01 00 80 6f 13  |Uoo.m.........o.|
-00000310  38 4b 10 7d f9 40 45 eb  9d bb 52 5b 3a c2 8b 0d  |8K.}.@E...R[:...|
-00000320  f1 af 75 fb 84 47 5c ee  d9 9c dc 85 cf da 40 ff  |..u..G\.......@.|
-00000330  5c 22 e4 cf c9 fb 15 ab  9f 67 0d a1 67 d5 7b 16  |\".......g..g.{.|
-00000340  2d e8 7d d2 61 94 47 e8  16 f2 02 52 e1 4c 8a 9a  |-.}.a.G....R.L..|
-00000350  93 57 9c 9e 66 5e 71 01  b5 56 05 92 1e 98 45 46  |.W..f^q..V....EF|
-00000360  bd 54 57 19 03 49 cf d2  bd 2a 29 34 f9 5b ef 01  |.TW..I...*)4.[..|
-00000370  fd aa 79 d4 4d ae f2 93  36 35 4b cb 9d f7 a0 61  |..y.M...65K....a|
-00000380  87 16 bb 2f 2b 13 4c aa  91 cb b5 87 7d 60 16 03  |.../+.L.....}`..|
+000002c0  cd 0c 00 00 c9 03 00 17  41 04 ae d5 bb e6 16 6e  |........A......n|
+000002d0  a7 1f 64 fe b4 af 97 f7  4d 19 46 27 43 ac 23 d2  |..d.....M.F'C.#.|
+000002e0  f8 6f 9b 46 cb 29 d7 68  4c 92 a1 56 12 81 98 54  |.o.F.).hL..V...T|
+000002f0  af fd 12 59 29 a4 dd fa  55 16 c9 54 64 97 a5 f2  |...Y)...U..Td...|
+00000300  ff 44 45 fe 58 3b 01 2b  8a db 04 01 00 80 71 87  |.DE.X;.+......q.|
+00000310  f6 4c f5 10 02 e6 f6 11  eb 02 11 1a 2e 73 85 90  |.L...........s..|
+00000320  ea 60 d1 63 cc eb 4c 65  b5 dc 47 55 51 52 42 d5  |.`.c..Le..GUQRB.|
+00000330  06 e6 0c 91 e1 92 e1 1e  46 53 0c 46 55 b8 50 c6  |........FS.FU.P.|
+00000340  79 cd 31 76 77 89 1c 4f  16 af c0 d5 93 ac c4 03  |y.1vw..O........|
+00000350  6b 13 ec 89 93 1a 65 e2  3a cb c5 58 22 41 99 29  |k.....e.:..X"A.)|
+00000360  25 0c af 53 fc 76 3e 34  1e fd 7c 64 ce 0b f9 04  |%..S.v>4..|d....|
+00000370  df 67 eb 25 b8 32 96 6b  95 fa 60 fe 1c 47 41 99  |.g.%.2.k..`..GA.|
+00000380  e6 eb 6d 73 5d 9c 2d e0  7f e0 0e bd 09 ce 16 03  |..ms].-.........|
 00000390  03 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
@@ -73,178 +73,179 @@
 00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 88 d2  |.....(..........|
-00000060  0e 91 f8 58 28 28 ab 65  b1 42 da b5 19 f0 6f 1a  |...X((.e.B....o.|
-00000070  e7 70 98 9b d9 d1 b4 b4  15 a2 7d fe 38 b3        |.p........}.8.|
+00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 4d 08  |.....(........M.|
+00000060  a0 d2 73 1b 90 01 0b a7  b2 27 57 18 d5 3e 62 fd  |..s......'W..>b.|
+00000070  e5 3c 66 1d 67 30 48 aa  ca 8a 37 9b ae 40        |.<f.g0H...7..@|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 dc 9f a0 b7 d1  |..........(.....|
-00000010  66 dd 1a e6 1a be de ef  64 ab 4f 8b 80 8a 60 e3  |f.......d.O...`.|
-00000020  94 d0 60 0a f6 ee 4b 5e  70 b8 6f b5 7f 56 70 9b  |..`...K^p.o..Vp.|
-00000030  d1 c3 5e                                          |..^|
+00000000  14 03 03 00 01 01 16 03  03 00 28 87 4f 0d 27 74  |..........(.O.'t|
+00000010  8d 74 48 06 3e da b1 83  fb c6 ea 8b 9b dc 62 6a  |.tH.>.........bj|
+00000020  4d 1d e3 bb 3a 60 96 31  78 5b 07 08 9b 0a a2 f0  |M...:`.1x[......|
+00000030  c1 08 1a                                          |...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 8d 00 7b  |...............{|
-00000010  39 59 55 36 8e 49 e0 5d  8d 35 a4 83 66 e8 88 2a  |9YU6.I.].5..f..*|
-00000020  5c 93 ba                                          |\..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 ed 2e c7  |................|
+00000010  81 e8 34 ad f4 1a 42 3b  ae 29 3c 8d 89 6d 73 b7  |..4...B;.)<..ms.|
+00000020  4c 54 33                                          |LT3|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 1c dc 9f a0  b7 d1 66 dd 1b 1a 73 da  |..........f...s.|
-00000010  b8 b3 d5 5b 0b 6a 14 f9  f5 30 36 8e a1 3a 82 cc  |...[.j...06..:..|
-00000020  11                                                |.|
+00000000  16 03 03 00 1c 87 4f 0d  27 74 8d 74 49 44 5e 78  |......O.'t.tID^x|
+00000010  ed a3 08 d8 53 1b 88 01  e2 a3 39 36 77 80 18 d8  |....S.....96w...|
+00000020  93                                                |.|
 >>> Flow 7 (client to server)
-00000000  16 03 03 00 a9 00 00 00  00 00 00 00 02 9f a9 43  |...............C|
-00000010  20 fc b7 22 07 ec 3f 38  81 b0 00 25 8b 98 8e 1a  | .."..?8...%....|
-00000020  ec aa db 0d a2 07 3a 76  ce 18 d0 5b b1 72 d7 aa  |......:v...[.r..|
-00000030  9e 97 b9 f2 0d e4 3a a0  8a aa b6 46 6e f7 d7 90  |......:....Fn...|
-00000040  ad e1 c2 23 2c c7 76 b3  87 28 c2 f2 ad c5 bb 00  |...#,.v..(......|
-00000050  d6 2f 3e 98 f0 9d 7d 0f  d2 21 4c 9a aa de 91 ef  |./>...}..!L.....|
-00000060  89 e1 23 5b aa 46 d5 58  4e 77 3f 5b 4d 5b 28 2f  |..#[.F.XNw?[M[(/|
-00000070  19 b6 17 e4 fd 23 18 07  da 6b 95 46 fc 31 39 55  |.....#...k.F.19U|
-00000080  3b 9d e3 be 6a 6a 25 0a  b2 d8 d8 c2 1a 7c 25 a8  |;...jj%......|%.|
-00000090  62 02 9a 4c 49 cb ba 45  d9 3b 55 ed a7 f9 c4 80  |b..LI..E.;U.....|
-000000a0  9e 18 74 8a a0 c5 1b af  4b 96 c9 de a6 14        |..t.....K.....|
+00000000  16 03 03 00 af 00 00 00  00 00 00 00 02 0e a0 bf  |................|
+00000010  81 6e 32 ab 30 25 62 0a  1d 70 8d 55 58 e2 df e0  |.n2.0%b..p.UX...|
+00000020  8a ff 21 1d 1c 23 be 25  19 d8 bc 8c 72 ec 72 46  |..!..#.%....r.rF|
+00000030  ca 08 97 c6 96 65 80 cc  1b f3 ef a3 77 99 07 ca  |.....e......w...|
+00000040  dd 3b 3b 22 4b f0 04 db  50 8b 9d 5a 05 1d 4c 38  |.;;"K...P..Z..L8|
+00000050  2d bd 29 d5 d7 35 5f 5d  af 00 98 da 3f f2 b8 58  |-.)..5_]....?..X|
+00000060  73 a3 fa 51 0f 32 33 1f  ed 60 1b 6b 23 de 77 17  |s..Q.23..`.k#.w.|
+00000070  5b 9a 8b 05 a9 5e 75 cb  41 c0 6d 42 f4 9a eb 8a  |[....^u.A.mB....|
+00000080  79 cb e6 42 3f 2a da 34  87 07 14 db 60 ee af 8e  |y..B?*.4....`...|
+00000090  db f0 92 eb 91 72 63 db  41 02 7d 52 58 c5 10 98  |.....rc.A.}RX...|
+000000a0  b7 d4 e4 d9 39 f7 46 50  74 e7 d5 8b fe 0b b9 47  |....9.FPt......G|
+000000b0  05 01 a2 51                                       |...Q|
 >>> Flow 8 (server to client)
-00000000  16 03 03 00 89 dc 9f a0  b7 d1 66 dd 1c 62 4b 92  |..........f..bK.|
-00000010  09 46 7d d1 b6 cc 65 81  32 f0 15 e1 9d 9e 77 81  |.F}...e.2.....w.|
-00000020  f3 f5 91 a3 17 eb 92 85  b9 c6 f2 68 60 5c e7 4d  |...........h`\.M|
-00000030  e9 68 58 2b e9 f9 53 3b  77 92 e6 59 4b d9 02 f4  |.hX+..S;w..YK...|
-00000040  f8 6b 0c e7 bf fb 23 3a  e2 8d 66 05 76 10 5d cc  |.k....#:..f.v.].|
-00000050  cb 26 0b e8 e7 ad b4 a9  4d ae 75 0e 85 4e eb 01  |.&......M.u..N..|
-00000060  8a 93 6a 54 03 23 7e 84  2c 0d f8 40 b0 e8 49 21  |..jT.#~.,..@..I!|
-00000070  97 db 08 81 a0 2e 16 4b  b0 dc 93 6b 45 a5 fe 77  |.......K...kE..w|
-00000080  d0 09 b2 b6 d8 79 84 34  f5 b7 22 84 62 5d 16 03  |.....y.4..".b]..|
-00000090  03 02 71 dc 9f a0 b7 d1  66 dd 1d 8b db b1 89 7d  |..q.....f......}|
-000000a0  2c b9 36 3b ac e8 83 a5  7a 47 54 07 49 5a 66 58  |,.6;....zGT.IZfX|
-000000b0  cb 18 f1 89 f8 99 5e 0c  ac ad 2c 69 ba 0c 8f 25  |......^...,i...%|
-000000c0  1e b7 1a eb 97 fc aa 81  ca 8d bc e9 08 37 51 79  |.............7Qy|
-000000d0  aa 09 68 36 81 3e f0 bc  35 35 cd 01 7d 06 de 80  |..h6.>..55..}...|
-000000e0  dd c8 ea db f2 d0 1e fc  6e 88 88 60 df 61 c3 e1  |........n..`.a..|
-000000f0  ac cf b4 b5 ed 87 7d 9a  8c a9 9c 11 c2 45 c8 44  |......}......E.D|
-00000100  31 4e 51 45 29 9a 6f 26  d8 34 b9 8a 96 48 a4 12  |1NQE).o&.4...H..|
-00000110  87 22 a3 6e fe 50 d9 1b  7c a8 1a 9e aa 5b 3d 7f  |.".n.P..|....[=.|
-00000120  80 55 af dd f3 d2 50 08  e3 e0 91 1e 53 b7 84 28  |.U....P.....S..(|
-00000130  08 b9 a7 eb df 39 03 98  e1 fc 51 e1 bc b1 a4 ab  |.....9....Q.....|
-00000140  f2 96 73 cc 61 3e 29 16  2f 7d 32 b3 98 88 8a bf  |..s.a>)./}2.....|
-00000150  e5 a4 f9 6a 05 80 49 bc  54 14 0d 20 ea 8a b1 c8  |...j..I.T.. ....|
-00000160  86 7d 28 93 cb 95 31 86  63 d5 49 03 8f 16 ee 38  |.}(...1.c.I....8|
-00000170  3b ce 15 ab bb 7e a7 7f  80 f8 88 88 12 ff 49 87  |;....~........I.|
-00000180  da b2 e8 f5 07 ba 5b 85  34 b0 72 28 ba 55 0a 76  |......[.4.r(.U.v|
-00000190  c6 9a 57 08 e7 67 cb f9  f3 79 f0 fe 60 b9 32 9b  |..W..g...y..`.2.|
-000001a0  ee 67 09 3f 29 33 f7 97  89 c7 e2 2d b3 67 70 56  |.g.?)3.....-.gpV|
-000001b0  12 3e e1 58 46 d2 22 db  61 db 7b 1a 5b 98 b4 91  |.>.XF.".a.{.[...|
-000001c0  d0 11 bd 21 be 8e f1 6e  7d 12 40 8b ca 7f bc b0  |...!...n}.@.....|
-000001d0  28 25 37 41 22 17 93 86  4d 66 69 c6 89 8e cb 05  |(%7A"...Mfi.....|
-000001e0  06 40 9b 13 3f a4 c5 86  e4 2d 45 b1 27 c8 be e3  |.@..?....-E.'...|
-000001f0  84 58 64 64 f3 8a 09 d7  3a bf 4e ac 77 1b 84 7e  |.Xdd....:.N.w..~|
-00000200  a5 85 94 b9 fd e6 da 56  76 32 27 9e 7c 80 43 00  |.......Vv2'.|.C.|
-00000210  8b 3a 4d a3 4d ae 6e 32  dc 62 b6 74 d1 3a b1 cd  |.:M.M.n2.b.t.:..|
-00000220  5c d0 5b 36 be 9b 6f d6  a0 bb 19 82 19 8d ea 4e  |\.[6..o........N|
-00000230  b2 57 99 6c 22 9d af 89  f4 e1 cf e6 80 05 9b cb  |.W.l"...........|
-00000240  ea 97 4b 39 44 9f b0 50  5b 4f ad 13 81 78 b7 04  |..K9D..P[O...x..|
-00000250  81 16 85 cf 9a d3 c0 48  29 a9 62 32 24 0e 64 b4  |.......H).b2$.d.|
-00000260  10 f7 85 7a 30 22 29 bc  0b f0 39 6b c4 10 ca 17  |...z0")...9k....|
-00000270  fb ff 7d b1 72 e0 5c 5e  4d 1d fa ba c8 fa c3 d6  |..}.r.\^M.......|
-00000280  8e 51 8e 83 b7 56 54 bc  35 57 f9 d0 dd 73 57 e2  |.Q...VT.5W...sW.|
-00000290  d5 aa 3e 09 9d 46 83 e5  84 3e 32 40 d6 c1 44 e7  |..>..F...>2@..D.|
-000002a0  55 8d 11 59 73 8b fa 2a  23 64 50 10 4f 48 7e ee  |U..Ys..*#dP.OH~.|
-000002b0  cb e6 59 7b 68 9f f0 c8  6e c5 3c 1e d7 8d 3b 2a  |..Y{h...n.<...;*|
-000002c0  49 d0 d8 25 b3 46 5e 3f  9f 68 fa d5 ff ce 5b a3  |I..%.F^?.h....[.|
-000002d0  d2 cf 80 3d 12 47 44 34  7c 71 0d 12 58 b5 16 65  |...=.GD4|q..X..e|
-000002e0  22 11 8c b6 47 2d 42 87  b6 28 4b a0 10 ae f7 61  |"...G-B..(K....a|
-000002f0  eb c6 80 89 b4 b4 7b c2  d7 fc 98 47 a7 cb ce 1b  |......{....G....|
-00000300  78 4a 62 ff 16 03 03 00  e5 dc 9f a0 b7 d1 66 dd  |xJb...........f.|
-00000310  1e 83 19 26 18 10 75 80  2b c6 2b 2a 2a 5e cb b3  |...&..u.+.+**^..|
-00000320  63 ac 70 a6 78 02 06 06  02 72 9f e9 30 47 e4 8f  |c.p.x....r..0G..|
-00000330  52 96 84 6f 72 76 64 23  93 d8 ff cc 1e ca a4 ce  |R..orvd#........|
-00000340  a1 08 75 24 91 62 b0 d8  7e d7 23 62 02 bd 5f 66  |..u$.b..~.#b.._f|
-00000350  5b 2d 91 8b 82 24 8d a2  02 7d 1d d4 cf a6 4f 88  |[-...$...}....O.|
-00000360  a2 47 a1 37 24 3f 24 5e  87 c8 a0 7d 6b b4 2a 75  |.G.7$?$^...}k.*u|
-00000370  ef 2b de 65 a6 4b 64 b6  4d e8 1f f1 db 39 5d c2  |.+.e.Kd.M....9].|
-00000380  a7 c5 e0 c8 24 18 85 9e  23 4a 40 d9 f3 d2 7b af  |....$...#J@...{.|
-00000390  a7 38 9c 8b 5a df ac bb  ca 11 2e 1c 65 60 82 57  |.8..Z.......e`.W|
-000003a0  9d e1 1a 4a 05 b0 e4 37  1a 2c b8 d7 38 e9 51 38  |...J...7.,..8.Q8|
-000003b0  6f b1 c7 c5 64 54 56 ec  f5 5f 60 2b ea aa ff 13  |o...dTV.._`+....|
-000003c0  12 bc d9 25 ee 82 54 7d  2a 66 8a d0 3b 0b ab d0  |...%..T}*f..;...|
-000003d0  af f9 45 88 04 99 c2 23  45 ba f5 50 e0 c0 d5 dd  |..E....#E..P....|
-000003e0  4e 49 3c 3a 0e 6f 67 63  79 e9 70 fc 1b 94 16 03  |NI<:.ogcy.p.....|
-000003f0  03 00 46 dc 9f a0 b7 d1  66 dd 1f 9e 9c 43 aa 55  |..F.....f....C.U|
-00000400  b3 c2 a1 04 52 2e c1 d8  c4 07 59 b7 02 02 21 d8  |....R.....Y...!.|
-00000410  45 70 8a 62 f1 4d 7d 40  6a ef ac 07 c0 ba b3 87  |Ep.b.M}@j.......|
-00000420  b1 89 4b 16 36 36 ee c9  47 9c 80 6c 44 fe f5 56  |..K.66..G..lD..V|
-00000430  9e 64 dd d4 74 2b df a8  fe                       |.d..t+...|
+00000000  16 03 03 00 89 87 4f 0d  27 74 8d 74 4a 8e 52 43  |......O.'t.tJ.RC|
+00000010  60 2e 40 7d 58 6c 91 c1  20 8e c5 28 54 26 b8 2c  |`.@}Xl.. ..(T&.,|
+00000020  21 ab 5c 31 9b fc a8 62  c9 62 34 d4 1a 9a 55 d4  |!.\1...b.b4...U.|
+00000030  a9 93 6e 09 44 e1 8d c3  cd e1 3c 1f b6 e5 88 d0  |..n.D.....<.....|
+00000040  e8 74 94 36 7d e6 8b 43  48 46 e5 e2 5d b6 36 f6  |.t.6}..CHF..].6.|
+00000050  cd 65 1c c6 b8 2e 98 f2  93 0d b4 b1 d6 58 92 33  |.e...........X.3|
+00000060  a9 ad 03 db bc 33 10 e6  2e 3c 1d c8 13 ec cd a1  |.....3...<......|
+00000070  3d 53 18 3d 01 7c d6 5f  c2 a0 c3 85 c6 2b 3c 86  |=S.=.|._.....+<.|
+00000080  53 09 72 65 3c d7 33 27  2c 94 4d 22 f5 12 16 03  |S.re<.3',.M"....|
+00000090  03 02 71 87 4f 0d 27 74  8d 74 4b ce 64 cb 8f 07  |..q.O.'t.tK.d...|
+000000a0  66 6b 4d 0c 60 66 5c 92  af 5a 23 08 a5 ad 23 35  |fkM.`f\..Z#...#5|
+000000b0  0e cb 1d ea d1 7e e4 2d  9e dd 50 79 53 9a 46 19  |.....~.-..PyS.F.|
+000000c0  3a 2b f1 c6 c3 cc 81 a3  60 88 00 74 62 c6 ac fd  |:+......`..tb...|
+000000d0  e0 f0 d5 3f da 5b c4 8e  ff dd 81 18 37 b6 19 ef  |...?.[......7...|
+000000e0  a4 95 51 b2 b0 78 3b c5  63 db 37 3e d7 f0 81 2b  |..Q..x;.c.7>...+|
+000000f0  82 32 72 21 c8 2c 0b 8a  c4 d9 d8 74 ae 31 e4 97  |.2r!.,.....t.1..|
+00000100  00 c0 f5 ea b9 07 1e 94  db 6e 71 54 98 22 4f 84  |.........nqT."O.|
+00000110  7a 00 47 df 91 28 39 d4  8e 7f 3b 45 16 49 84 5f  |z.G..(9...;E.I._|
+00000120  57 4f 04 a3 84 7c 4d 67  35 78 1e 17 81 35 60 6f  |WO...|Mg5x...5`o|
+00000130  fe 23 4a 7d fb c6 39 40  c8 43 46 21 c8 95 10 db  |.#J}..9@.CF!....|
+00000140  23 90 e0 b4 bb 5b 6e ef  61 ab 0b cb 18 9f 2c d0  |#....[n.a.....,.|
+00000150  b3 b8 15 11 d3 a2 88 9c  8d 85 5d 99 bd 65 ad 60  |..........]..e.`|
+00000160  a8 58 bd b4 88 d2 d4 c8  08 62 e5 7f 79 53 36 46  |.X.......b..yS6F|
+00000170  5f a1 8b 8c 0f 44 e8 2d  6f 37 e4 ff 00 65 46 09  |_....D.-o7...eF.|
+00000180  42 ce 05 e8 e7 96 5e 9c  06 db a6 eb 78 0f fb 30  |B.....^.....x..0|
+00000190  75 6b 08 65 72 f6 b4 d7  09 d8 3d 64 a3 23 de 27  |uk.er.....=d.#.'|
+000001a0  a6 e7 84 60 28 52 8e 5f  48 f2 cc dd 6e 1b 33 e1  |...`(R._H...n.3.|
+000001b0  e1 9e 71 af 2c e0 1c 44  8c df ca 5b 63 98 5e 70  |..q.,..D...[c.^p|
+000001c0  d0 48 c7 eb 87 4a d3 7a  78 e7 02 2f 75 76 cc 70  |.H...J.zx../uv.p|
+000001d0  19 9c 93 de e5 c0 af fc  ad 9e 43 6c cb 09 c0 95  |..........Cl....|
+000001e0  a5 8e dd e0 b8 61 8a c6  d5 89 95 cf 58 d7 93 9e  |.....a......X...|
+000001f0  4a 66 33 56 f2 d4 0a c6  23 d4 b7 e7 85 23 9b 57  |Jf3V....#....#.W|
+00000200  68 20 22 5c d8 96 d2 dd  90 57 d5 e3 51 22 5d 44  |h "\.....W..Q"]D|
+00000210  4f f3 9c 06 25 f9 b1 98  f5 d1 4d d1 79 c4 51 7f  |O...%.....M.y.Q.|
+00000220  8d 68 c0 44 28 12 86 68  d4 d6 16 11 5c 16 9f ea  |.h.D(..h....\...|
+00000230  82 e9 12 82 dc d5 c1 f7  bd 17 57 f7 bc ef 4a 38  |..........W...J8|
+00000240  f5 4b 36 3a b2 a3 e7 fa  ef b0 d2 02 1b 0d 27 bf  |.K6:..........'.|
+00000250  51 25 99 0d bc 7f 6c 53  71 81 30 e4 c5 1f 24 c8  |Q%....lSq.0...$.|
+00000260  b7 19 c5 d9 e0 c0 a5 52  cc 27 83 da 43 38 a6 98  |.......R.'..C8..|
+00000270  dc 1b ce ec 94 f1 a8 47  41 c6 8e 42 4b 6b 71 35  |.......GA..BKkq5|
+00000280  b4 32 88 87 0f 31 1a 39  73 93 7e 61 c7 46 75 62  |.2...1.9s.~a.Fub|
+00000290  ad db dc 9a b8 a1 33 c3  68 d3 0e 3e 26 f6 e5 51  |......3.h..>&..Q|
+000002a0  d0 d1 35 c7 62 b5 22 dc  e5 23 6a 08 64 12 56 ea  |..5.b."..#j.d.V.|
+000002b0  ae 21 aa 04 ac a0 70 a5  29 27 ff 67 96 63 71 82  |.!....p.)'.g.cq.|
+000002c0  92 7e 87 cc b9 c6 6c f5  20 c2 d2 50 0a 53 78 0f  |.~....l. ..P.Sx.|
+000002d0  6c 84 c2 39 ca 73 75 f0  d6 13 70 2f d7 47 f5 b1  |l..9.su...p/.G..|
+000002e0  6f a8 ac a8 75 34 a5 a2  69 1e b7 ae 59 90 f1 ed  |o...u4..i...Y...|
+000002f0  ce fa 13 66 99 9e d3 3c  7c ad ef 9f 16 b2 a1 9f  |...f...<|.......|
+00000300  42 32 d8 eb 16 03 03 00  e5 87 4f 0d 27 74 8d 74  |B2........O.'t.t|
+00000310  4c 2c ae eb 0c 3d ac 73  0a 49 35 4d 87 66 91 f8  |L,...=.s.I5M.f..|
+00000320  22 3c 47 b8 27 ee b9 7e  2d ac a7 de 12 aa 0e c7  |"<G.'..~-.......|
+00000330  45 a8 da c4 c9 0e 9d 0e  15 75 94 ab 3f f7 52 46  |E........u..?.RF|
+00000340  f8 e5 7f 97 c1 cf 69 eb  90 d3 31 f0 e2 c2 ea ff  |......i...1.....|
+00000350  f8 ed bb 43 61 d3 3c b8  bd 0a f4 81 98 5c 15 ef  |...Ca.<......\..|
+00000360  eb d9 08 86 9f 1a f2 16  e6 bc 05 51 7d 46 d2 79  |...........Q}F.y|
+00000370  18 fe 1f 1a 9f 3a 6f 4d  d7 2e b4 df cb f3 19 bf  |.....:oM........|
+00000380  69 70 d0 d5 51 8a a2 b2  ca 9c 44 a7 ef b1 ea 50  |ip..Q.....D....P|
+00000390  45 43 65 b1 68 9c c4 89  cc 66 4a 76 f5 f5 9b 3b  |ECe.h....fJv...;|
+000003a0  82 54 fe a9 5e aa 53 9d  e0 53 d8 e2 51 4b 55 67  |.T..^.S..S..QKUg|
+000003b0  a4 15 36 f4 0d 99 fe 95  98 bf 8c 9e ad b3 84 f7  |..6.............|
+000003c0  ff 06 92 22 7a a6 c0 8d  a0 61 af 92 d2 32 b6 54  |..."z....a...2.T|
+000003d0  d7 cc 29 59 76 7d 5b 5e  d5 49 ac 91 bd d4 c7 da  |..)Yv}[^.I......|
+000003e0  89 86 82 ac 7a 71 a2 47  6c a0 39 e2 d9 0f 16 03  |....zq.Gl.9.....|
+000003f0  03 00 46 87 4f 0d 27 74  8d 74 4d ab 8d b6 ef 87  |..F.O.'t.tM.....|
+00000400  d3 f4 08 61 5d 78 e1 8b  8e 89 b8 d3 15 d3 a7 88  |...a]x..........|
+00000410  63 9f 34 45 43 1f 26 cb  d3 bd 8f 20 3f 69 53 8d  |c.4EC.&.... ?iS.|
+00000420  a3 69 12 9c 19 54 88 1e  34 68 a9 16 18 92 36 22  |.i...T..4h....6"|
+00000430  c8 b7 48 d3 52 4e 82 21  ce                       |..H.RN.!.|
 >>> Flow 9 (client to server)
-00000000  16 03 03 02 71 00 00 00  00 00 00 00 03 e8 be 1d  |....q...........|
-00000010  f6 60 a3 df bc ba 34 58  33 af f8 b4 49 38 30 6c  |.`....4X3...I80l|
-00000020  74 9f 7c 4e ba 4c 41 e6  30 32 9c b2 13 ed 6a 52  |t.|N.LA.02....jR|
-00000030  fa 1d 85 ac b5 81 12 e6  b8 c0 54 2f 79 ac 4b ad  |..........T/y.K.|
-00000040  45 d8 f2 f2 a6 f2 3d c0  29 b2 47 15 d4 a6 21 56  |E.....=.).G...!V|
-00000050  38 e6 5c 37 ae fd 58 68  1a 6d 36 55 eb 93 26 a7  |8.\7..Xh.m6U..&.|
-00000060  a2 95 09 63 ad 19 8c 4f  b5 f8 0b b3 85 57 b0 46  |...c...O.....W.F|
-00000070  2f 30 1a 33 eb 37 5e 4d  55 a5 c1 c8 29 90 e8 1a  |/0.3.7^MU...)...|
-00000080  40 c8 83 0f b0 3e c4 58  a3 e3 c5 d4 b2 fc 4b 52  |@....>.X......KR|
-00000090  c6 de eb 54 d4 17 4a cb  b9 41 1a 3e a9 29 db b1  |...T..J..A.>.)..|
-000000a0  d1 71 d8 ad da 4b 2e 4c  97 19 c1 93 bc ee d2 3b  |.q...K.L.......;|
-000000b0  fe 34 0b cd 2e 71 40 f9  19 f1 8e 4c 41 cf 97 c0  |.4...q@....LA...|
-000000c0  8e c9 c2 5e b7 9c 5c 35  07 73 9a f3 23 f7 31 1c  |...^..\5.s..#.1.|
-000000d0  22 7b c0 cb 7b c5 a1 4e  6a 8b 6b 56 34 3b 6d 2d  |"{..{..Nj.kV4;m-|
-000000e0  42 62 00 29 c7 5d 0f 8f  54 2b 70 d4 02 c6 1f d9  |Bb.).]..T+p.....|
-000000f0  64 8f 81 3c d1 aa 92 6d  15 1b 95 18 86 7f 4d fc  |d..<...m......M.|
-00000100  22 d3 b5 03 1a bf 9f b7  1c 9e e2 05 4d 05 bb 24  |"...........M..$|
-00000110  8f eb 6f 47 45 09 d8 ff  92 a0 cd ac 1d 94 a9 3a  |..oGE..........:|
-00000120  e2 eb 87 31 f8 16 49 90  4a f4 dd 51 fa d5 5b 36  |...1..I.J..Q..[6|
-00000130  27 89 bd 5d 2c ed f0 0d  14 2d 94 9a ab 81 96 51  |'..],....-.....Q|
-00000140  52 3a 9c c4 17 61 53 44  7d de 41 df 29 ed df 61  |R:...aSD}.A.)..a|
-00000150  d5 d0 1f fe 4f 49 63 ae  bd cb 48 ff 2c 2d d9 a8  |....OIc...H.,-..|
-00000160  63 70 7b c9 dc f7 e6 4f  45 a4 6a 33 2b 53 42 a5  |cp{....OE.j3+SB.|
-00000170  c6 a3 cf cb 29 68 e9 6a  07 fc cb cf b5 a5 6c d5  |....)h.j......l.|
-00000180  9a 18 8d 11 95 40 75 ff  bd 60 77 6c f3 e2 6f 53  |.....@u..`wl..oS|
-00000190  da 53 ce ce b9 bf 8b 14  13 b3 df 72 f6 6e af 7e  |.S.........r.n.~|
-000001a0  1e 0f 5f 97 20 d9 91 e9  f9 04 14 d8 89 c8 6c 49  |.._. .........lI|
-000001b0  fa 5f da 5e ed 87 6f 67  6f 22 95 11 76 5a 51 22  |._.^..ogo"..vZQ"|
-000001c0  6d c6 33 86 3e 99 c2 f4  a5 1d 8b 0f 49 25 a9 9f  |m.3.>.......I%..|
-000001d0  59 32 93 80 57 4b 90 17  a2 62 59 c4 36 6e fb ed  |Y2..WK...bY.6n..|
-000001e0  e0 26 bc 48 46 fd 6f 57  7c ec e6 8d fe a5 f5 8f  |.&.HF.oW|.......|
-000001f0  1b 62 d0 a9 2b ec 2a 2b  3e 80 c9 0b 4f af ff e6  |.b..+.*+>...O...|
-00000200  24 9a d4 d4 fb 2e 73 38  f6 a7 f8 fa 39 ae e5 61  |$.....s8....9..a|
-00000210  82 d2 6d 19 82 d9 9c d1  76 0b da b2 fb c5 ce 73  |..m.....v......s|
-00000220  06 55 a3 7a fc 3a f8 b1  b9 4c de fd 53 f9 24 76  |.U.z.:...L..S.$v|
-00000230  fa 02 c7 92 1c b2 bc 2d  7a 34 14 51 5e c1 5b 34  |.......-z4.Q^.[4|
-00000240  19 52 ac c7 5e 0a b7 8b  d7 97 91 c9 ea 0d 27 d8  |.R..^.........'.|
-00000250  ab b6 5f 0e 15 c1 9b 87  49 4c a0 ee 6e a8 0b 56  |.._.....IL..n..V|
-00000260  a3 23 0b 34 aa f6 e2 09  ac 48 4f 93 4b d1 5a 04  |.#.4.....HO.K.Z.|
-00000270  de da d3 2d 3c e3 16 03  03 00 5e 00 00 00 00 00  |...-<.....^.....|
-00000280  00 00 04 37 bf 7d 31 20  86 dd 2c fe 9d e0 5f ce  |...7.}1 ..,..._.|
-00000290  7a 63 d7 36 d0 5e 65 3e  13 b6 d0 cd 74 db da 0c  |zc.6.^e>....t...|
-000002a0  6c 76 1a cb f3 28 e0 8d  46 b4 b0 9e c6 80 12 bd  |lv...(..F.......|
-000002b0  e8 15 64 48 78 42 74 7a  f0 f2 8e 7e af dc 2e 33  |..dHxBtz...~...3|
-000002c0  4f b3 ce e9 e8 49 9e a6  ee 8c 38 3e 8a d2 33 47  |O....I....8>..3G|
-000002d0  49 7e ca 2b 4b 11 d9 82  ec 16 03 03 00 a0 00 00  |I~.+K...........|
-000002e0  00 00 00 00 00 05 df 3f  8d 38 ec 4e 67 4e 20 0b  |.......?.8.NgN .|
-000002f0  92 53 c1 41 79 52 53 13  79 2b 5e 44 e8 02 2f d7  |.S.AyRS.y+^D../.|
-00000300  ae b9 4e cf d0 4d da 33  a3 3c 26 43 eb ec f6 77  |..N..M.3.<&C...w|
-00000310  4e 88 3d 5f b9 8e 61 1c  49 ba a7 f1 11 47 89 10  |N.=_..a.I....G..|
-00000320  ad 0b 8b 65 33 55 97 63  5d b4 f3 f1 ab 35 f8 1b  |...e3U.c]....5..|
-00000330  bd e2 41 cd e8 3e 5c 19  02 c0 2e be ea 9f 72 be  |..A..>\.......r.|
-00000340  96 d7 ba 2a 19 85 f8 77  11 6e cc 29 e1 63 16 6c  |...*...w.n.).c.l|
-00000350  85 18 84 d9 9b c4 0b 32  1d 2d 2c 11 b7 9f 11 63  |.......2.-,....c|
-00000360  29 e7 9a 57 fc cf 6d 95  c8 d6 81 45 b6 b8 8e 20  |)..W..m....E... |
-00000370  5e 0b e0 35 57 ad 0d 09  fe fe d6 85 ed 86 14 03  |^..5W...........|
-00000380  03 00 19 00 00 00 00 00  00 00 06 1d 3f 39 60 06  |............?9`.|
-00000390  fc 8c 3d 72 2a 49 84 98  e5 00 c7 f1 16 03 03 00  |..=r*I..........|
-000003a0  28 00 00 00 00 00 00 00  00 5f 82 6b 3f d2 44 fd  |(........_.k?.D.|
-000003b0  3f 51 36 ff cf 0e 25 53  40 73 5e a0 70 5b e2 10  |?Q6...%S@s^.p[..|
-000003c0  2b fc 89 89 f6 1e ca f4  f3                       |+........|
+00000000  16 03 03 02 71 00 00 00  00 00 00 00 03 00 b6 c3  |....q...........|
+00000010  7c 99 6e 21 9b e4 2b 53  e5 ce 3a f3 f5 89 66 c6  ||.n!..+S..:...f.|
+00000020  9a 86 44 cc 73 40 5b 10  79 a4 ec a8 69 78 61 4b  |..D.s@[.y...ixaK|
+00000030  e4 83 ac 19 06 11 9c d3  14 12 6d ad 81 6f 0d 86  |..........m..o..|
+00000040  54 7e 6d 1d 9b 9f 62 98  84 8d 3a 97 46 15 bc c3  |T~m...b...:.F...|
+00000050  d6 fe d6 0d cb ea 41 d9  f5 ac 5b f0 6e 42 bf 2c  |......A...[.nB.,|
+00000060  b3 2e 63 3f 36 e4 d4 13  b9 bf 50 3a f2 6e 41 c8  |..c?6.....P:.nA.|
+00000070  75 8d a1 34 42 1f a7 b2  51 e5 da 41 e0 54 52 24  |u..4B...Q..A.TR$|
+00000080  f6 db 2f 3b e2 39 03 c8  f7 91 07 aa ad 65 cc a7  |../;.9.......e..|
+00000090  bc c3 4e 2f c3 58 0c e4  e0 88 69 ef cb d3 e7 88  |..N/.X....i.....|
+000000a0  a2 fe 9f 4a 49 d1 ad df  6d 14 10 f5 7d c3 bb 2d  |...JI...m...}..-|
+000000b0  fe fe b6 f0 0f a7 cc 57  34 f0 db ff e0 d8 33 b4  |.......W4.....3.|
+000000c0  a5 26 49 b0 65 d5 5b fb  54 9d 86 51 73 bd ef 4c  |.&I.e.[.T..Qs..L|
+000000d0  41 b6 3d f3 3d 3f 2e 45  d5 9c 70 2b 76 ca 22 35  |A.=.=?.E..p+v."5|
+000000e0  2a a7 33 33 7f 6c f3 3a  3e 77 c1 b5 b5 5a d8 4b  |*.33.l.:>w...Z.K|
+000000f0  76 7e 00 d4 eb a5 b8 5e  79 26 0b d7 2b 47 26 7d  |v~.....^y&..+G&}|
+00000100  f6 0d 7d fb d5 e9 1a 9f  d0 08 61 c5 bc b8 6b 94  |..}.......a...k.|
+00000110  4b bb 1b 06 3c f2 ce 2c  f1 e9 d5 94 4e 24 7f ff  |K...<..,....N$..|
+00000120  85 d6 5d 20 d8 d4 09 06  4c 3c 44 26 43 b6 31 7c  |..] ....L<D&C.1||
+00000130  a3 1b bb d6 b6 47 58 61  52 85 f1 f1 10 ce ea ba  |.....GXaR.......|
+00000140  97 f3 85 ea 0e f6 65 40  fa 18 58 7c b4 70 c5 e6  |......e@..X|.p..|
+00000150  16 05 b7 b1 3a 35 7c 72  67 f2 12 68 25 1f 5c 47  |....:5|rg..h%.\G|
+00000160  57 15 ee bd 95 7f 6c 00  c9 36 7e 84 2a 3e 1b 7c  |W.....l..6~.*>.||
+00000170  bc e0 ee 59 06 f7 bb 44  dd d5 26 42 46 49 22 4c  |...Y...D..&BFI"L|
+00000180  2e 1f 82 fb eb 3d 3e 6a  9a fb b1 3e 6c d1 e1 71  |.....=>j...>l..q|
+00000190  99 32 4e 49 34 56 e4 b9  ac dd ad fe 9b db 38 ff  |.2NI4V........8.|
+000001a0  96 e8 9c f2 b5 79 16 29  6b 1e 59 59 d7 e6 6d 5d  |.....y.)k.YY..m]|
+000001b0  bb 29 a5 1e cf 9a 9b a0  40 09 37 9f 4b 19 77 16  |.)......@.7.K.w.|
+000001c0  2a 8f b6 c6 85 88 8a 3e  8a 0a 3d bd 08 92 9b d4  |*......>..=.....|
+000001d0  80 b7 ac 9f da e2 82 67  df cf b8 8b 09 24 f6 01  |.......g.....$..|
+000001e0  2d 6e 8b a3 b3 4b 1b c2  42 d6 ac 41 dc 1a da 1b  |-n...K..B..A....|
+000001f0  e7 8f 30 3f 26 e3 3c 16  34 56 ab f5 cc 57 68 54  |..0?&.<.4V...WhT|
+00000200  83 72 fc f4 61 d2 dd 81  34 f1 ff a6 3e fd 14 9f  |.r..a...4...>...|
+00000210  52 71 07 96 73 27 fe c9  5b 62 f6 80 1b 59 f9 be  |Rq..s'..[b...Y..|
+00000220  5a 8a 63 39 2a 00 e4 e9  9b 92 65 74 08 c5 c8 71  |Z.c9*.....et...q|
+00000230  74 0e bf 2a d7 4b 35 7d  ca 33 25 cb 20 6f f4 91  |t..*.K5}.3%. o..|
+00000240  d3 87 1b 40 47 1c 64 a3  0a 1e 0a c4 51 dc e5 0b  |...@G.d.....Q...|
+00000250  59 1b f6 7e 00 34 0c fb  01 5f b9 b2 df d0 7b 45  |Y..~.4..._....{E|
+00000260  c7 59 2b 6c a9 1a d9 85  7d 2f 50 d4 91 e8 f3 ca  |.Y+l....}/P.....|
+00000270  51 4b c9 d9 d9 dc 16 03  03 00 5e 00 00 00 00 00  |QK........^.....|
+00000280  00 00 04 6d cd 24 ed bc  9b 60 0f 3f 60 b8 5e bf  |...m.$...`.?`.^.|
+00000290  bd 5e 05 05 72 12 00 2e  4b d4 64 ae 07 44 7b 4d  |.^..r...K.d..D{M|
+000002a0  be c0 bc 54 7f 4a 04 1f  dc 0e 68 5d 40 d3 03 4b  |...T.J....h]@..K|
+000002b0  c4 47 d9 06 a5 64 8a b2  27 0b 2e 00 87 4c 22 10  |.G...d..'....L".|
+000002c0  c8 4f 4e 39 cc d5 59 25  c4 13 a0 4e 52 07 e4 0f  |.ON9..Y%...NR...|
+000002d0  63 d4 7a 94 1c 14 27 15  a3 16 03 03 00 a0 00 00  |c.z...'.........|
+000002e0  00 00 00 00 00 05 1a f2  d4 c3 e6 b8 08 78 58 15  |.............xX.|
+000002f0  50 7d 7b 8d 76 47 4e 25  3f 33 69 f0 64 af 1c 4e  |P}{.vGN%?3i.d..N|
+00000300  df a4 55 34 d7 a6 a7 93  0d d2 da e8 39 97 69 ce  |..U4........9.i.|
+00000310  91 9a b4 a9 4e 05 a3 e3  d3 1d 0b d6 1a 64 94 1f  |....N........d..|
+00000320  36 b6 b1 4d b7 a0 b1 85  cd 0b 94 86 c3 bc 60 c9  |6..M..........`.|
+00000330  e5 ec bd 63 8b a4 df 4d  9a bc e3 0c be a7 2b d1  |...c...M......+.|
+00000340  fb 7f 62 7f 6e 27 bf a4  cf 02 95 97 3a 39 90 6c  |..b.n'......:9.l|
+00000350  10 03 59 d7 66 d5 51 fa  6c 11 0d 8a f1 22 aa da  |..Y.f.Q.l...."..|
+00000360  0e d3 91 cc 5b 24 73 97  7e a2 1c 36 c4 3d 36 63  |....[$s.~..6.=6c|
+00000370  84 77 f9 32 73 40 a1 e5  33 c6 d1 cb e9 3d 14 03  |.w.2s@..3....=..|
+00000380  03 00 19 00 00 00 00 00  00 00 06 8b ac 4c 97 5c  |.............L.\|
+00000390  a4 6e 37 24 b4 86 55 61  dd a7 d3 30 16 03 03 00  |.n7$..Ua...0....|
+000003a0  28 00 00 00 00 00 00 00  00 94 a0 5d 37 dc 51 d3  |(..........]7.Q.|
+000003b0  1d 47 1c 65 f7 15 f9 2d  fd ff f8 8f 94 7b 31 7e  |.G.e...-.....{1~|
+000003c0  4e 4d 52 7d 2a 44 86 aa  08                       |NMR}*D...|
 >>> Flow 10 (server to client)
-00000000  14 03 03 00 19 dc 9f a0  b7 d1 66 dd 20 03 c0 3d  |..........f. ..=|
-00000010  a6 3c 3c f8 11 43 98 e4  ce 6f bb 38 4c bf 16 03  |.<<..C...o.8L...|
-00000020  03 00 28 07 29 e3 dc ae  1d 74 05 ff 1f b7 64 8c  |..(.)....t....d.|
-00000030  a1 18 1b 9d 29 e5 c0 c4  c7 53 55 94 91 5e 36 b9  |....)....SU..^6.|
-00000040  21 64 ce 49 93 73 d0 3c  15 7f a4 17 03 03 00 21  |!d.I.s.<.......!|
-00000050  07 29 e3 dc ae 1d 74 06  c2 2a 6d 89 ce e4 31 a1  |.)....t..*m...1.|
-00000060  6e ce 11 e3 04 a4 55 d5  2b e6 21 73 69 ab e1 b8  |n.....U.+.!si...|
-00000070  a8 16 03 03 00 1c 07 29  e3 dc ae 1d 74 07 c2 35  |.......)....t..5|
-00000080  e7 27 d8 72 fc dc 29 af  d9 49 4d 4c c4 a3 e6 39  |.'.r..)..IML...9|
-00000090  dd 3e                                             |.>|
+00000000  14 03 03 00 19 87 4f 0d  27 74 8d 74 4e 43 bf 50  |......O.'t.tNC.P|
+00000010  ce e3 80 e6 0d d9 86 45  52 b3 62 ff ce 3c 16 03  |.......ER.b..<..|
+00000020  03 00 28 98 56 2f b8 02  4d 74 4f d4 5e fc 4e b5  |..(.V/..MtO.^.N.|
+00000030  48 f8 c5 53 9c 7a dc 4e  ac 75 dc aa 19 c3 d9 ca  |H..S.z.N.u......|
+00000040  23 ae 9f 15 08 1f 2a a1  bb 0a 6f 17 03 03 00 21  |#.....*...o....!|
+00000050  98 56 2f b8 02 4d 74 50  63 4b 9f ac bd f5 73 57  |.V/..MtPcK....sW|
+00000060  6a 17 26 6b 24 3f 74 fc  58 a7 a1 b8 b2 87 86 8e  |j.&k$?t.X.......|
+00000070  b7 16 03 03 00 1c 98 56  2f b8 02 4d 74 51 41 48  |.......V/..MtQAH|
+00000080  a4 ab fb 77 41 24 8b 87  fd 41 f9 39 52 60 66 75  |...wA$...A.9R`fu|
+00000090  d9 ed                                             |..|
 >>> Flow 11 (client to server)
-00000000  15 03 03 00 1a 00 00 00  00 00 00 00 01 66 98 d8  |.............f..|
-00000010  2b 9d 70 db 1b 6a 7d 3e  cd 8e 92 b2 0c 66 b5 15  |+.p..j}>.....f..|
-00000020  03 03 00 1a 00 00 00 00  00 00 00 02 e5 04 26 f1  |..............&.|
-00000030  d4 43 c3 10 06 6f 41 1d  0b 9c 00 6d c0 68        |.C...oA....m.h|
+00000000  15 03 03 00 1a 00 00 00  00 00 00 00 01 68 2c 59  |.............h,Y|
+00000010  c3 45 29 6b 7e 0d 45 5e  4f 80 33 07 5d 8b 7e 15  |.E)k~.E^O.3.].~.|
+00000020  03 03 00 1a 00 00 00 00  00 00 00 02 78 77 81 c1  |............xw..|
+00000030  da 3d 67 44 50 ac b5 2b  1e d6 c0 59 1f 36        |.=gDP..+...Y.6|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected b/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected
index 7580335f85..b751f38329 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 36 00 05 00 05  01 00 00 00 00 00 0a 00  |...6............|
-00000060  08 00 06 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
-00000070  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
-00000080  03 ff 01 00 01 00 00 12  00 00                    |..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 ec 51 a4 79 dd  |....Y...U...Q.y.|
-00000010  3b 69 4a 16 5b 93 ed 46  28 04 ff 5c 85 75 bc f2  |;iJ.[..F(..\.u..|
-00000020  f5 c1 73 1f a2 21 cf 2e  26 41 8d 20 f7 fb 87 4f  |..s..!..&A. ...O|
-00000030  0b 16 9c a9 ca fb 9a a9  7c eb 7f 92 c1 54 e8 eb  |........|....T..|
-00000040  5b c2 f5 4d 35 48 e9 42  a0 b9 ee be c0 2f 00 00  |[..M5H.B...../..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 f6 20 3c 21 84  |....Y...U... <!.|
+00000010  6b 59 08 ad 80 03 17 90  65 e1 6a 69 63 46 4c 89  |kY......e.jicFL.|
+00000020  ad fb 22 5a f2 88 3e c8  a9 93 87 20 e0 48 ea ef  |.."Z..>.... .H..|
+00000030  e5 ad e4 59 00 31 39 25  e7 fd 3e 2f a2 2a 32 11  |...Y.19%..>/.*2.|
+00000040  2a ad 83 35 ea f8 e5 05  87 54 33 d2 c0 2f 00 00  |*..5.....T3../..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,19 +53,19 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  cd 0c 00 00 c9 03 00 17  41 04 fc eb 26 2a 1f 0d  |........A...&*..|
-000002d0  64 f0 4f 23 b3 82 ce 78  14 76 72 b2 45 c0 b0 d7  |d.O#...x.vr.E...|
-000002e0  36 dd 9c c4 bf b4 4b 40  69 ad d6 84 76 2b 8f d1  |6.....K@i...v+..|
-000002f0  d1 8d 4f 67 40 96 91 88  9c b0 20 46 0a e2 6e 62  |..Og@..... F..nb|
-00000300  8d 83 d4 8e 38 d4 b9 d1  aa e0 04 01 00 80 05 c6  |....8...........|
-00000310  e8 95 17 54 3e ee 0f 88  90 69 d8 d0 6f c4 f5 f0  |...T>....i..o...|
-00000320  8c 5d 73 6a 9d 53 83 1b  63 ae 96 70 ce d6 3e 04  |.]sj.S..c..p..>.|
-00000330  7d f6 4f 95 89 be 66 1c  3a e6 e0 79 45 b4 55 24  |}.O...f.:..yE.U$|
-00000340  d0 a7 a1 18 4b d5 b7 b6  39 93 7c bf b6 37 d9 44  |....K...9.|..7.D|
-00000350  ec 1a 0c b8 70 c5 7b ac  a4 b8 7b 3e b0 45 00 27  |....p.{...{>.E.'|
-00000360  8a 12 f1 e8 fe 07 ac 91  61 6b df 0c 36 19 ab 71  |........ak..6..q|
-00000370  b6 9f db 61 b9 c4 04 10  37 81 ef 74 e5 94 fb 89  |...a....7..t....|
-00000380  95 a4 44 84 5d d0 eb 3d  37 54 1e 63 da cb 16 03  |..D.]..=7T.c....|
+000002c0  cd 0c 00 00 c9 03 00 17  41 04 f3 61 70 23 72 6b  |........A..ap#rk|
+000002d0  0c 87 56 6d f0 0c e8 e8  8e 3c cb ad 1e 41 41 3b  |..Vm.....<...AA;|
+000002e0  ac 17 af 69 01 59 50 64  4b e1 55 11 89 0c 45 4d  |...i.YPdK.U...EM|
+000002f0  cb 2a 1f 8a 01 ef f4 cf  82 1c af ab a3 d9 ef 65  |.*.............e|
+00000300  30 08 d2 cd bc ad 1f 66  00 8e 04 01 00 80 0c 44  |0......f.......D|
+00000310  fa 5e 0a 5d f3 e6 9f d2  08 4e dd f5 02 22 37 1e  |.^.].....N..."7.|
+00000320  10 d5 fb 80 15 25 0a f1  c5 1f 97 66 fc 3e fb cd  |.....%.....f.>..|
+00000330  bb 0e 4d 63 e7 70 ad 1a  95 b6 9b e0 c5 15 c8 64  |..Mc.p.........d|
+00000340  6c c5 e1 ce f2 8a bf 01  33 41 31 1b e4 8e 4a d4  |l.......3A1...J.|
+00000350  82 73 4c c3 3a 16 15 27  55 1c 24 3f e6 b2 43 87  |.sL.:..'U.$?..C.|
+00000360  d4 3e bb 4d ac 8a bf bb  ee d5 0f 06 ac 3f c3 bc  |.>.M.........?..|
+00000370  2a 14 b9 80 f8 0d ff 7a  ae 91 08 69 17 e6 ee 2c  |*......z...i...,|
+00000380  f5 d8 80 b5 8a 70 da e4  b5 0d 3d 51 55 1a 16 03  |.....p....=QU...|
 00000390  03 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
@@ -73,24 +73,24 @@
 00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 52 89  |.....(........R.|
-00000060  96 4a 6a 3a 06 d7 39 7c  cf 9b 98 94 5a 9c 24 61  |.Jj:..9|....Z.$a|
-00000070  c4 a7 a6 2c bf a1 58 2c  7b ae a7 42 3f 75        |...,..X,{..B?u|
+00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 82 21  |.....(.........!|
+00000060  0f 0a 3c 57 97 77 80 ad  c5 a0 d9 c8 55 83 75 1b  |..<W.w......U.u.|
+00000070  7b 66 54 8f 74 77 dc 12  22 32 ba 94 f3 66        |{fT.tw.."2...f|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 92 8c 2a 95 70  |..........(..*.p|
-00000010  1c e9 5c 9a e3 38 40 36  06 2c 90 8b 60 71 fd 79  |..\..8@6.,..`q.y|
-00000020  11 3a 5a 6a 2d 48 a1 25  48 26 62 b3 b9 5e 20 2a  |.:Zj-H.%H&b..^ *|
-00000030  96 e4 36                                          |..6|
+00000000  14 03 03 00 01 01 16 03  03 00 28 9b b2 6a 5a 2e  |..........(..jZ.|
+00000010  76 9a f9 42 0b cb 16 30  8e 45 d6 61 e9 05 57 18  |v..B...0.E.a..W.|
+00000020  65 4d a8 ca 20 8a 1d 37  00 b1 e3 eb eb 66 20 dc  |eM.. ..7.....f .|
+00000030  3e ad 37                                          |>.7|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 ec 70 62  |..............pb|
-00000010  95 4c 48 dd e3 75 e7 05  bb 0a e0 cf d9 2e dd a0  |.LH..u..........|
-00000020  75 43 dd                                          |uC.|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 7a f6 16  |.............z..|
+00000010  3f 4d 4d f0 ce 77 91 77  ae 05 3c 6e 6d e3 7b 0c  |?MM..w.w..<nm.{.|
+00000020  5b 1e 82                                          |[..|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 1c 92 8c 2a  95 70 1c e9 5d f8 42 e3  |.......*.p..].B.|
-00000010  56 2d da 6a e6 65 bd d8  48 d7 60 80 67 9b 78 df  |V-.j.e..H.`.g.x.|
-00000020  40                                                |@|
+00000000  16 03 03 00 1c 9b b2 6a  5a 2e 76 9a fa ec 9f e5  |.......jZ.v.....|
+00000010  8a 90 6b 44 14 61 98 1f  31 ee 5c f3 ee c3 1c 74  |..kD.a..1.\....t|
+00000020  d4                                                |.|
 >>> Flow 7 (client to server)
-00000000  15 03 03 00 1a 00 00 00  00 00 00 00 02 b5 10 47  |...............G|
-00000010  3e c1 98 c1 ad e1 05 83  ca 46 83 91 1e 4b d1 15  |>........F...K..|
-00000020  03 03 00 1a 00 00 00 00  00 00 00 03 bb a7 ca fd  |................|
-00000030  d6 be d3 2e 30 7c d9 d7  8a d9 83 78 90 a3        |....0|.....x..|
+00000000  15 03 03 00 1a 00 00 00  00 00 00 00 02 ca e0 98  |................|
+00000010  02 b2 04 3d e9 e2 b1 e8  c5 a0 c6 92 e7 7a f0 15  |...=.........z..|
+00000020  03 03 00 1a 00 00 00 00  00 00 00 03 7a 34 47 57  |............z4GW|
+00000030  3f 3f d6 41 7a 98 ef 84  a8 18 9a f4 e7 9d        |??.Az.........|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-SCT b/src/crypto/tls/testdata/Client-TLSv12-SCT
index 0039a315c7..035101f213 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-SCT
+++ b/src/crypto/tls/testdata/Client-TLSv12-SCT
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 22 c0 2f  |............."./|
-00000030  c0 2b c0 30 c0 2c c0 11  c0 07 c0 13 c0 09 c0 14  |.+.0.,..........|
-00000040  c0 0a 00 9c 00 9d 00 05  00 2f 00 35 c0 12 00 0a  |........./.5....|
-00000050  01 00 00 36 00 05 00 05  01 00 00 00 00 00 0a 00  |...6............|
-00000060  08 00 06 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
-00000070  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
-00000080  03 ff 01 00 01 00 00 12  00 00                    |..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
+00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
+00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
+00000050  00 05 c0 11 c0 07 01 00  00 36 00 05 00 05 01 00  |.........6......|
+00000060  00 00 00 00 0a 00 08 00  06 00 17 00 18 00 19 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 01 c6 02 00 01  c2 03 03 48 40 5a f2 a9  |...........H@Z..|
-00000010  ae 2b a4 94 7f 54 db 1f  df 53 3e cf cc f3 f6 7f  |.+...T...S>.....|
-00000020  0f ad 49 1e 30 33 61 ab  97 ef 61 20 fa 20 0b 75  |..I.03a...a . .u|
-00000030  12 74 bb 86 e4 5d 1b 94  4b b4 96 8d 6e 2f 15 10  |.t...]..K...n/..|
-00000040  0b a6 5b ae 66 59 90 8f  83 a4 9e 6d c0 2f 00 01  |..[.fY.....m./..|
+00000000  16 03 03 01 c6 02 00 01  c2 03 03 95 bb 5e 4f e9  |.............^O.|
+00000010  b9 00 35 c4 8a 1b bf 94  f3 54 bc 42 fb 31 e1 fc  |..5......T.B.1..|
+00000020  bd 11 ca 2c 66 dd 95 51  63 5f 9b 20 ad b4 19 67  |...,f..Qc_. ...g|
+00000030  df 54 29 9c cb c2 a8 33  79 10 46 8b 21 99 ca c1  |.T)....3y.F.!...|
+00000040  c1 33 f0 f6 79 28 d8 a1  99 3e f5 3a c0 2f 00 01  |.3..y(...>.:./..|
 00000050  7a ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 12  |z...............|
 00000060  01 69 01 67 00 75 00 a4  b9 09 90 b4 18 58 14 87  |.i.g.u.......X..|
 00000070  bb 13 a2 cc 67 70 0a 3c  35 98 04 f9 1b df b8 e3  |....gp.<5.......|
@@ -76,19 +76,19 @@
 00000400  1c f1 0f a1 d8 40 83 61  c9 4c 72 2b 9d ae db 46  |.....@.a.Lr+...F|
 00000410  06 06 4d f4 c1 b3 3e c0  d1 bd 42 d4 db fe 3d 13  |..M...>...B...=.|
 00000420  60 84 5c 21 d3 3b e9 fa  e7 16 03 03 00 cd 0c 00  |`.\!.;..........|
-00000430  00 c9 03 00 17 41 04 fe  aa b3 5d f0 b2 46 c1 fc  |.....A....]..F..|
-00000440  44 ff 4d db 0f 24 c0 18  3d 14 60 21 5f 70 df 19  |D.M..$..=.`!_p..|
-00000450  a6 8d 26 c4 80 f0 f9 9e  dc bf e5 6b ef b5 0b 85  |..&........k....|
-00000460  2f 10 f1 79 da e4 57 da  be 4b d3 0f a3 f7 83 d8  |/..y..W..K......|
-00000470  e1 54 0a 74 35 2f 57 04  01 00 80 57 56 3b 1c 0d  |.T.t5/W....WV;..|
-00000480  9c c9 b3 7f a5 b1 5b 70  6a 66 d7 2d af ad 6e 37  |......[pjf.-..n7|
-00000490  8d c9 c7 26 02 a1 96 7c  0e 9f 8d 50 c8 64 c7 03  |...&...|...P.d..|
-000004a0  ac 04 b1 02 97 63 92 9a  34 6c 0d 44 a0 c4 ee 0c  |.....c..4l.D....|
-000004b0  ce 53 77 fb 4a dd 5d 9a  84 28 60 ff cd b8 ac 76  |.Sw.J.]..(`....v|
-000004c0  14 17 7b 37 e7 c6 7b 71  38 b2 ef 6f 8d c1 f4 ed  |..{7..{q8..o....|
-000004d0  6d 19 7f b8 13 5a c4 2d  ad 6d bf 62 84 f7 8e 85  |m....Z.-.m.b....|
-000004e0  b2 f6 b6 d3 cf bf 8b 65  7d 16 df 12 7d d1 35 9d  |.......e}...}.5.|
-000004f0  b8 88 64 6f 90 11 c0 fa  2d 82 30 16 03 03 00 04  |..do....-.0.....|
+00000430  00 c9 03 00 17 41 04 3c  22 11 f9 c1 e9 01 52 96  |.....A.<".....R.|
+00000440  0f fb 73 09 2a 25 df 1d  fd fa b6 59 76 3e de 3c  |..s.*%.....Yv>.<|
+00000450  99 0d 45 77 a2 2b 97 7d  9e 81 99 cd 7a ad 2c 0f  |..Ew.+.}....z.,.|
+00000460  94 4c 70 e2 c0 99 ce b4  b1 ca e7 2d 8d 8d e4 c3  |.Lp........-....|
+00000470  31 71 5b d8 56 f9 2c 04  01 00 80 db 38 72 4c 73  |1q[.V.,.....8rLs|
+00000480  fd 64 53 0c 4c 50 cb 8e  dd f4 c4 fa 3c 68 65 41  |.dS.LP......<heA|
+00000490  4f 12 7e 7c e4 2a 49 95  9a 8c 14 cd c6 4d a6 3a  |O.~|.*I......M.:|
+000004a0  20 1b 34 48 f6 ae 0c dd  12 89 9a ee 4a 67 d4 6c  | .4H........Jg.l|
+000004b0  b3 47 bb 29 a4 c9 61 83  4e 41 b6 a6 25 82 8d 54  |.G.)..a.NA..%..T|
+000004c0  2b a0 8b 74 2e 48 6c de  cd 48 a2 67 f5 48 55 1d  |+..t.Hl..H.g.HU.|
+000004d0  d7 fa 36 b5 f5 81 da 2a  1b f8 d0 ae ea b7 15 77  |..6....*.......w|
+000004e0  4a 91 a9 fc d3 9e 59 11  cc 67 80 8d bf 64 20 9b  |J.....Y..g...d .|
+000004f0  a2 f2 6c ba af 8f e9 2c  7f df 17 16 03 03 00 04  |..l....,........|
 00000500  0e 00 00 00                                       |....|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
@@ -96,17 +96,17 @@
 00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 df 9f  |.....(..........|
-00000060  ae ef de 0d 4d c5 5e 63  bc d3 22 04 40 bd 7f 91  |....M.^c..".@...|
-00000070  73 e0 31 06 b4 7e 8e e5  88 f7 67 52 8a e6        |s.1..~....gR..|
+00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 a3 7c  |.....(.........||
+00000060  c1 d7 84 84 5c 0d 7a 55  00 7a 66 a0 1f 29 62 4a  |....\.zU.zf..)bJ|
+00000070  81 c0 8e 3a 59 03 8d d4  6a 8f f0 3a 08 b1        |...:Y...j..:..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 62 58 45 e1 88  |..........(bXE..|
-00000010  f1 a0 c0 49 13 e9 56 1b  b8 0f 01 bc ac 4b 66 f5  |...I..V......Kf.|
-00000020  a2 ae 8b 5e 8d ee 10 3e  96 75 31 6e a9 43 c0 8f  |...^...>.u1n.C..|
-00000030  9a 73 5e                                          |.s^|
+00000000  14 03 03 00 01 01 16 03  03 00 28 b6 eb 51 e3 50  |..........(..Q.P|
+00000010  50 a1 50 df 74 59 60 fd  d4 64 59 20 52 3b d5 cd  |P.P.tY`..dY R;..|
+00000020  c4 3e 0e ff bb 37 03 28  99 1e 85 09 ab 9d 95 b3  |.>...7.(........|
+00000030  13 88 84                                          |...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 33 2f 92  |.............3/.|
-00000010  08 5a de 20 a9 14 15 06  dd 4e 85 b2 ab 7a fa 80  |.Z. .....N...z..|
-00000020  9f 87 49 15 03 03 00 1a  00 00 00 00 00 00 00 02  |..I.............|
-00000030  f6 f2 60 bc 9e 5a b4 9b  38 f6 a9 65 e9 c3 c8 e5  |..`..Z..8..e....|
-00000040  2c 39                                             |,9|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 64 c7 c3  |.............d..|
+00000010  c5 4a 5f 71 52 87 e8 98  40 4f be 89 17 4f 98 b0  |.J_qR...@O...O..|
+00000020  25 6f 77 15 03 03 00 1a  00 00 00 00 00 00 00 02  |%ow.............|
+00000030  3b 11 51 f1 69 19 7b 14  3c 67 f5 11 3a c9 38 0c  |;.Q.i.{.<g..:.8.|
+00000040  17 3b                                             |.;|
