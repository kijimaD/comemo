commit e1c294a56d5d03cdba1f059cdb6b1225477dc546
Author: Alejandro García Montoro <alejandro.garciamontoro@gmail.com>
Date:   Fri May 14 18:42:16 2021 +0200

    cmd/compile: eliminate successive swaps
    
    The code generated when storing eight bytes loaded from memory in big
    endian introduced two successive byte swaps that did not actually
    modified the data.
    
    The new rules match this specific pattern both for amd64 and for arm64,
    eliminating the double swap.
    
    Fixes #41684
    
    Change-Id: Icb6dc20b68e4393cef4fe6a07b33aba0d18c3ff3
    Reviewed-on: https://go-review.googlesource.com/c/go/+/320073
    Reviewed-by: Keith Randall <khr@golang.org>
    Run-TryBot: Keith Randall <khr@golang.org>
    TryBot-Result: Go Bot <gobot@golang.org>
    Trust: Daniel Martí <mvdan@mvdan.cc>
    Trust: Dmitri Shuralyov <dmitshur@golang.org>

 src/cmd/compile/internal/ssa/gen/AMD64.rules |  2 ++
 src/cmd/compile/internal/ssa/gen/ARM64.rules |  2 ++
 src/cmd/compile/internal/ssa/rewriteAMD64.go | 32 ++++++++++++++++++++++++++++
 src/cmd/compile/internal/ssa/rewriteARM64.go | 32 ++++++++++++++++++++++++++++
 test/codegen/memcombine.go                   | 12 +++++++++++
 5 files changed, 80 insertions(+)
