commit 60b12532932fe40a8d756619474a00f820faacc8
Author: Michael Matloob <matloob@golang.org>
Date:   Thu Oct 29 19:05:56 2020 -0400

    cmd/go: pass in overlaid file paths to C compiler
    
    This change moves the code in work.(*Builder).cgo that, when there is
    an overlay, copies non-Go files to objdir into work.(*Builder).Build,
    and creates an overlay structure mapping from the nominal file paths
    into the copies in objdir. That's propagated through to
    work.(*Builder).ccompile, which will use it to pass in the path to the
    overlaid contents in objdir when calling the compiler.
    
    This allows for overlays of C/C++/Fortran files.
    
    For #39958
    
    Change-Id: I9a2e3d3ba6afdf7ce19be1dbf4eee34805cdc05f
    Reviewed-on: https://go-review.googlesource.com/c/go/+/266376
    Trust: Michael Matloob <matloob@golang.org>
    Run-TryBot: Michael Matloob <matloob@golang.org>
    TryBot-Result: Go Bot <gobot@golang.org>
    Reviewed-by: Jay Conrod <jayconrod@google.com>
    Reviewed-by: Bryan C. Mills <bcmills@google.com>

 src/cmd/go/internal/work/action.go           | 11 ++---
 src/cmd/go/internal/work/exec.go             | 65 ++++++++++++++--------------
 src/cmd/go/testdata/script/build_overlay.txt | 15 +++++--
 3 files changed, 51 insertions(+), 40 deletions(-)
