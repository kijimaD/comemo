commit 9ec0c7abe14102b6a374a4d2920afac10d99e27e
Author: Joe Tsai <joetsai@digital-static.net>
Date:   Thu Nov 16 10:15:34 2017 -0800

    archive/tar: use placeholder name for global PAX records
    
    Several usages of tar (reasonably) just use the Header.FileInfo
    to determine the type of the header. However, the os.FileMode type
    is not expressive enough to represent "files" that are not files
    at all, but some form of metadata.
    
    Thus, Header{Typeflag: TypeXGlobalHeader}.FileInfo().Mode().IsRegular()
    reports true, even though the expected result may have been false.
    
    To reduce (not eliminate) the possibility of failure for such usages,
    use the placeholder filename from the global PAX headers.
    Thus, in the event the user did not handle special "meta" headers
    specifically, they will just be written to disk as a regular file.
    
    As an example use case, the "git archive --format=tgz" command produces
    an archive where the first "file" is a global PAX header with the
    name "global_pax_header". For users that do not explicitly check
    the Header.Typeflag field to ignore such headers, they may end up
    extracting a file named "global_pax_header". While it is a bogus file,
    it at least does not stop the extraction process.
    
    Updates #22748
    
    Change-Id: I28448b528dcfacb4e92311824c33c71b482f49c9
    Reviewed-on: https://go-review.googlesource.com/78355
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>

 src/archive/tar/common.go      | 5 +++--
 src/archive/tar/reader.go      | 1 +
 src/archive/tar/reader_test.go | 2 ++
 src/archive/tar/writer.go      | 5 ++++-
 4 files changed, 10 insertions(+), 3 deletions(-)
