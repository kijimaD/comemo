commit 561a5079057e3a660ab638e1ba957a96c4ff3fd1
Author: Bryan C. Mills <bcmills@google.com>
Date:   Fri Sep 15 10:37:08 2023 -0400

    net/http: avoid leaking goroutines when TestServerGracefulClose retries
    
    If the call to ReadString returns an error, the closure in
    testServerGracefulClose will return an error and retry the test with a
    longer timeout. If that happens, we need to wait for the conn.Write
    goroutine to complete so that we don't leak connections across tests.
    
    Updates #57084.
    Fixes #62643.
    
    Change-Id: Ia86c1bbd0a5e5d0aeccf4dfeb994c19d1fb10b00
    Reviewed-on: https://go-review.googlesource.com/c/go/+/528398
    Auto-Submit: Bryan Mills <bcmills@google.com>
    Reviewed-by: Than McIntosh <thanm@google.com>
    TryBot-Result: Gopher Robot <gobot@golang.org>
    Run-TryBot: Bryan Mills <bcmills@google.com>
    Reviewed-by: Damien Neil <dneil@google.com>

 src/net/http/serve_test.go | 13 ++++++++-----
 1 file changed, 8 insertions(+), 5 deletions(-)
