commit 53b7c18284a404de6ca814bc3313d980b8e5ecc3
Author: Cherry Zhang <cherryyz@google.com>
Date:   Wed Sep 11 16:17:01 2019 -0400

    [dev.link] cmd/compile, cmd/asm: assign index to symbols
    
    We are planning to use indices for symbol references, instead of
    symbol names. Here we assign indices to symbols defined in the
    package being compiled, and propagate the indices to the
    dependent packages in the export data.
    
    A symbol is referenced by a tuple, (package index, symbol index).
    Normally, for a given symbol, this index is unique, and the
    symbol index is globally consistent (but with exceptions, see
    below). The package index is local to a compilation. For example,
    when compiling the fmt package, fmt.Println gets assigned index
    25, then all packages that reference fmt.Println will refer it
    as (X, 25) with some X. X is the index for the fmt package, which
    may differ in different compilations.
    
    There are some symbols that do not have clear package affiliation,
    such as dupOK symbols and linknamed symbols. We cannot give them
    globally consistent indices. We categorize them as non-package
    symbols, assign them with package index 1 and a symbol index that
    is only meaningful locally.
    
    Currently nothing will consume the indices.
    
    All this is behind a flag, -newobj. The flag needs to be set for
    all builds (-gcflags=all=-newobj -asmflags=all=-newobj), or none.
    
    Change-Id: I18e489c531e9a9fbc668519af92c6116b7308cab
    Reviewed-on: https://go-review.googlesource.com/c/go/+/196029
    Reviewed-by: Than McIntosh <thanm@google.com>

 src/cmd/asm/internal/flags/flags.go    |   1 +
 src/cmd/asm/main.go                    |   2 +
 src/cmd/compile/internal/gc/iexport.go |  14 ++++
 src/cmd/compile/internal/gc/iimport.go |  17 +++++
 src/cmd/compile/internal/gc/main.go    |   5 +-
 src/cmd/compile/internal/types/sym.go  |  15 ++++-
 src/cmd/internal/obj/link.go           |  30 ++++++++-
 src/cmd/internal/obj/sizeof_test.go    |   2 +-
 src/cmd/internal/obj/sym.go            | 114 +++++++++++++++++++++++++++++++++
 9 files changed, 194 insertions(+), 6 deletions(-)
