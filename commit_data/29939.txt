commit 35e5fd0c4de88567aefa354ce6613b7d1ec3a4d9
Author: Adam Langley <agl@golang.org>
Date:   Wed Oct 12 10:53:35 2016 -0700

    crypto/tls: enable ChaCha20-Poly1305 cipher suites by default.
    
    This change enables the ChaCha20-Poly1305 cipher suites by default. This
    changes the default ClientHello and thus requires updating all the
    tests.
    
    Change-Id: I6683a2647caaff4a11f9e932babb6f07912cad94
    Reviewed-on: https://go-review.googlesource.com/30958
    Run-TryBot: Brad Fitzpatrick <bradfitz@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>
---
 src/crypto/tls/cipher_suites.go                    |   4 +-
 src/crypto/tls/handshake_server_test.go            |   6 -
 .../testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA  | 104 ++--
 .../testdata/Client-TLSv10-ClientCert-ECDSA-RSA    |  98 ++--
 .../testdata/Client-TLSv10-ClientCert-RSA-ECDSA    | 104 ++--
 .../tls/testdata/Client-TLSv10-ClientCert-RSA-RSA  |  98 ++--
 .../tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES     |  82 +--
 .../tls/testdata/Client-TLSv10-ECDHE-RSA-AES       |  80 +--
 src/crypto/tls/testdata/Client-TLSv10-RSA-RC4      |  48 +-
 .../tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES     |  84 +--
 .../tls/testdata/Client-TLSv11-ECDHE-RSA-AES       |  80 +--
 src/crypto/tls/testdata/Client-TLSv11-RSA-RC4      |  48 +-
 .../tls/testdata/Client-TLSv12-AES128-GCM-SHA256   |  52 +-
 .../tls/testdata/Client-TLSv12-AES128-SHA256       |  66 +--
 .../tls/testdata/Client-TLSv12-AES256-GCM-SHA384   |  52 +-
 src/crypto/tls/testdata/Client-TLSv12-ALPN         |  74 ++-
 .../testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA  | 102 ++--
 .../testdata/Client-TLSv12-ClientCert-ECDSA-RSA    |  96 +--
 .../Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384 |  92 +--
 .../testdata/Client-TLSv12-ClientCert-RSA-ECDSA    | 100 ++--
 .../tls/testdata/Client-TLSv12-ClientCert-RSA-RSA  |  92 +--
 .../tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES     |  84 +--
 .../tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM |  78 +--
 .../Client-TLSv12-ECDHE-ECDSA-AES128-SHA256        |  90 +--
 .../Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384    |  76 +--
 .../tls/testdata/Client-TLSv12-ECDHE-RSA-AES       |  80 +--
 .../testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256 |  88 +--
 src/crypto/tls/testdata/Client-TLSv12-RSA-RC4      |  48 +-
 .../tls/testdata/Client-TLSv12-RenegotiateOnce     | 363 ++++++------
 .../tls/testdata/Client-TLSv12-RenegotiateTwice    | 653 ++++++++++-----------
 .../Client-TLSv12-RenegotiateTwiceRejected         | 370 ++++++------
 .../testdata/Client-TLSv12-RenegotiationRejected   |  80 ++-
 src/crypto/tls/testdata/Client-TLSv12-SCT          |  72 ++-
 .../Client-TLSv12-X25519-ECDHE-RSA-AES-GCM         |  72 +--
 src/crypto/tls/testdata/Server-SSLv3-RSA-3DES      |  58 +-
 src/crypto/tls/testdata/Server-SSLv3-RSA-AES       |  60 +-
 src/crypto/tls/testdata/Server-SSLv3-RSA-RC4       |  50 +-
 .../tls/testdata/Server-TLSv10-ECDHE-ECDSA-AES     |  68 +--
 src/crypto/tls/testdata/Server-TLSv10-RSA-3DES     |  50 +-
 src/crypto/tls/testdata/Server-TLSv10-RSA-AES      |  56 +-
 src/crypto/tls/testdata/Server-TLSv10-RSA-RC4      |  44 +-
 src/crypto/tls/testdata/Server-TLSv11-FallbackSCSV |   6 +-
 src/crypto/tls/testdata/Server-TLSv11-RSA-RC4      |  44 +-
 src/crypto/tls/testdata/Server-TLSv12-ALPN         |  64 +-
 src/crypto/tls/testdata/Server-TLSv12-ALPN-NoMatch |  64 +-
 .../Server-TLSv12-CipherSuiteCertPreferenceECDSA   |  62 +-
 .../Server-TLSv12-CipherSuiteCertPreferenceRSA     |  60 +-
 .../Server-TLSv12-ClientAuthRequestedAndECDSAGiven |  72 +--
 .../Server-TLSv12-ClientAuthRequestedAndGiven      |  72 +--
 .../Server-TLSv12-ClientAuthRequestedNotGiven      |  54 +-
 .../tls/testdata/Server-TLSv12-ECDHE-ECDSA-AES     |  60 +-
 src/crypto/tls/testdata/Server-TLSv12-IssueTicket  |  68 +--
 .../testdata/Server-TLSv12-IssueTicketPreDisable   |  68 +--
 src/crypto/tls/testdata/Server-TLSv12-RSA-3DES     |  50 +-
 src/crypto/tls/testdata/Server-TLSv12-RSA-AES      |  54 +-
 src/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM  |  50 +-
 .../testdata/Server-TLSv12-RSA-AES256-GCM-SHA384   |  50 +-
 src/crypto/tls/testdata/Server-TLSv12-RSA-RC4      |  44 +-
 src/crypto/tls/testdata/Server-TLSv12-Resume       |  57 +-
 .../tls/testdata/Server-TLSv12-ResumeDisabled      |  70 +--
 src/crypto/tls/testdata/Server-TLSv12-SNI          |  54 +-
 .../tls/testdata/Server-TLSv12-SNI-GetCertificate  |  54 +-
 .../Server-TLSv12-SNI-GetCertificateNotFound       |  54 +-
 .../Server-TLSv12-X25519-ECDHE-RSA-AES-GCM         |  50 +-
 64 files changed, 2662 insertions(+), 2721 deletions(-)

diff --git a/src/crypto/tls/cipher_suites.go b/src/crypto/tls/cipher_suites.go
index a3334f3c5b..05146743ac 100644
--- a/src/crypto/tls/cipher_suites.go
+++ b/src/crypto/tls/cipher_suites.go
@@ -78,8 +78,8 @@ type cipherSuite struct {
 var cipherSuites = []*cipherSuite{
 	// Ciphersuite order is chosen so that ECDHE comes before plain RSA and
 	// AEADs are the top preference.
-	{TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305, 32, 0, 12, ecdheRSAKA, suiteECDHE | suiteTLS12 | suiteDefaultOff, nil, nil, aeadChaCha20Poly1305},
-	{TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305, 32, 0, 12, ecdheECDSAKA, suiteECDHE | suiteECDSA | suiteTLS12 | suiteDefaultOff, nil, nil, aeadChaCha20Poly1305},
+	{TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305, 32, 0, 12, ecdheRSAKA, suiteECDHE | suiteTLS12, nil, nil, aeadChaCha20Poly1305},
+	{TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305, 32, 0, 12, ecdheECDSAKA, suiteECDHE | suiteECDSA | suiteTLS12, nil, nil, aeadChaCha20Poly1305},
 	{TLS_ECDHE_RSA_WITH_AES_128_GCM_SHA256, 16, 0, 4, ecdheRSAKA, suiteECDHE | suiteTLS12, nil, nil, aeadAESGCM},
 	{TLS_ECDHE_ECDSA_WITH_AES_128_GCM_SHA256, 16, 0, 4, ecdheECDSAKA, suiteECDHE | suiteECDSA | suiteTLS12, nil, nil, aeadAESGCM},
 	{TLS_ECDHE_RSA_WITH_AES_256_GCM_SHA384, 32, 0, 4, ecdheRSAKA, suiteECDHE | suiteTLS12 | suiteSHA384, nil, nil, aeadAESGCM},
diff --git a/src/crypto/tls/handshake_server_test.go b/src/crypto/tls/handshake_server_test.go
index 94193bdac7..8d760ca10a 100644
--- a/src/crypto/tls/handshake_server_test.go
+++ b/src/crypto/tls/handshake_server_test.go
@@ -40,12 +40,6 @@ var testConfig *Config
 func allCipherSuites() []uint16 {
 	ids := make([]uint16, len(cipherSuites))
 	for i, suite := range cipherSuites {
-		// Skip ChaCha20-Poly1305 cipher suites until they are enabled
-		// by default.
-		switch suite.id {
-		case TLS_ECDHE_RSA_WITH_CHACHA20_POLY1305, TLS_ECDHE_ECDSA_WITH_CHACHA20_POLY1305:
-			continue
-		}
 		ids[i] = suite.id
 	}
 
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA
index fa17b3fcdf..099cef4ba9 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 59 02 00 00  55 03 01 06 7a 54 62 74  |....Y...U...zTbt|
-00000010  6f db 23 bf 1e fc 82 35  4d 57 c5 09 e1 63 fb 3a  |o.#....5MW...c.:|
-00000020  44 dd 3e 60 ec bc 3e 2f  2c 6f 52 20 0c 8e 2a 1e  |D.>`..>/,oR ..*.|
-00000030  02 bf 03 ef a4 b0 2a f9  3a 16 a7 97 01 cb 78 f0  |......*.:.....x.|
-00000040  4d e9 ea 81 f6 0f 9c fb  44 a8 f8 29 c0 09 00 00  |M.......D..)....|
+00000000  16 03 01 00 59 02 00 00  55 03 01 4f 5d 09 43 37  |....Y...U..O].C7|
+00000010  70 c6 d9 8b 07 ca 1a f0  fb a7 05 51 53 67 7a 7e  |p..........QSgz~|
+00000020  c9 c6 68 10 10 2a 69 bd  47 db 8e 20 f2 13 5b 26  |..h..*i.G.. ..[&|
+00000030  e6 8e 19 b0 bc b5 ee 1f  ca 44 5d 32 11 37 b0 78  |.........D]2.7.x|
+00000040  49 16 6e c2 44 86 52 3f  9f 05 15 aa c0 09 00 00  |I.n.D.R?........|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  01 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -49,20 +49,20 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 01 00 b4 0c 00  00 b0 03 00 1d 20 c6 bf  |*............ ..|
-00000280  da 7d da 0c 87 2f 71 3a  a4 7c 89 23 42 6a 5d d2  |.}.../q:.|.#Bj].|
-00000290  b7 85 5a 00 da bb 5e cf  ea 86 39 2a b4 20 00 8a  |..Z...^...9*. ..|
-000002a0  30 81 87 02 42 00 85 42  f6 bc c6 3c c5 9e e3 b3  |0...B..B...<....|
-000002b0  48 0f bc ed 4b 78 00 d3  30 69 29 cd 18 56 03 37  |H...Kx..0i)..V.7|
-000002c0  8c f5 da 20 33 86 cf ed  b8 d2 75 56 2f 85 7b 53  |... 3.....uV/.{S|
-000002d0  bc 06 e3 4f a1 7d 9c b6  a7 2a da 45 c8 34 29 89  |...O.}...*.E.4).|
-000002e0  3f 8d c9 39 6e b3 6d 02  41 51 02 48 28 c7 e9 75  |?..9n.m.AQ.H(..u|
-000002f0  5d b1 d2 d6 11 d1 3a b8  2f 65 af d8 5d 49 9a 42  |].....:./e..]I.B|
-00000300  7d ae 12 6a 97 9f 4e 51  9e ec 79 10 27 fd d5 19  |}..j..NQ..y.'...|
-00000310  ac 5a c8 cd 5a ac 84 8f  fa 05 e3 51 a3 4e 84 b9  |.Z..Z......Q.N..|
-00000320  08 85 41 fc e6 5b ba 4b  24 39 16 03 01 00 0a 0d  |..A..[.K$9......|
-00000330  00 00 06 03 01 02 40 00  00 16 03 01 00 04 0e 00  |......@.........|
-00000340  00 00                                             |..|
+00000270  2a 16 03 01 00 b5 0c 00  00 b1 03 00 1d 20 56 b4  |*............ V.|
+00000280  39 d4 8f 18 79 87 89 d0  04 ee 12 54 20 2b be c1  |9...y......T +..|
+00000290  94 99 40 a2 73 df 1e 92  66 0b d1 f1 d6 38 00 8b  |..@.s...f....8..|
+000002a0  30 81 88 02 42 01 38 12  59 bd ea 44 59 f4 6f a9  |0...B.8.Y..DY.o.|
+000002b0  8e 9e a0 85 b5 b3 55 3e  76 49 b7 75 98 6e 81 30  |......U>vI.u.n.0|
+000002c0  c4 73 bd 54 78 39 f7 e2  22 49 4c 93 0d c1 26 89  |.s.Tx9.."IL...&.|
+000002d0  08 b9 9c 8b 86 3e 81 2c  a5 50 7c e9 88 ec c0 ad  |.....>.,.P|.....|
+000002e0  9e e0 40 ac 4e 0a fd 02  42 01 2e 0d 37 73 6a 0d  |..@.N...B...7sj.|
+000002f0  a4 60 08 a0 2b 32 0f 87  8d f8 9b c7 68 cf 50 79  |.`..+2......h.Py|
+00000300  73 f7 cf 93 aa 75 57 20  58 3d 13 c0 f3 66 7d 59  |s....uW X=...f}Y|
+00000310  15 73 d4 29 03 34 df 33  00 c0 b5 71 bc 2a 90 ef  |.s.).4.3...q.*..|
+00000320  3c 02 5e ea 9d 29 93 1c  18 db 04 16 03 01 00 0a  |<.^..)..........|
+00000330  0d 00 00 06 03 01 02 40  00 00 16 03 01 00 04 0e  |.......@........|
+00000340  00 00 00                                          |...|
 >>> Flow 3 (client to server)
 00000000  16 03 01 02 0a 0b 00 02  06 00 02 03 00 02 00 30  |...............0|
 00000010  82 01 fc 30 82 01 5e 02  09 00 9a 30 84 6c 26 35  |...0..^....0.l&5|
@@ -100,29 +100,29 @@
 00000210  03 01 00 25 10 00 00 21  20 2f e5 7d a3 47 cd 62  |...%...! /.}.G.b|
 00000220  43 15 28 da ac 5f bb 29  07 30 ff f6 84 af c4 cf  |C.(.._.).0......|
 00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 01 00 91 0f 00  |...._X.;t.......|
-00000240  00 8d 00 8b 30 81 88 02  42 01 c5 d1 33 12 b8 59  |....0...B...3..Y|
-00000250  0d 75 98 b6 11 e5 06 9d  49 3d 77 37 2a 10 f9 a0  |.u......I=w7*...|
-00000260  4f 7e 72 13 5c 3d 7e bf  17 57 ab 16 3d b7 1b f7  |O~r.\=~..W..=...|
-00000270  9a 5c 92 99 72 be a2 c7  dc 0c a4 cc 4c ed f6 80  |.\..r.......L...|
-00000280  95 7f 59 3f d4 ed 3e 36  9f 82 d1 02 42 01 da 4c  |..Y?..>6....B..L|
-00000290  27 fc a9 7f c7 1a 8c 7d  29 fe 6b 2b 1a f1 db ee  |'......}).k+....|
-000002a0  8e 61 59 92 69 ef b5 d2  eb 4a 79 7d ff 17 cc c4  |.aY.i....Jy}....|
-000002b0  6f 3e a0 2b 86 0c dd 11  6c 3c 0d e8 a2 55 7d a3  |o>.+....l<...U}.|
-000002c0  58 46 cd f9 3d 9e fc 91  7f 07 90 5c 92 3d d8 14  |XF..=......\.=..|
-000002d0  03 01 00 01 01 16 03 01  00 30 73 e5 58 cc f4 da  |.........0s.X...|
-000002e0  e0 2b 1a 26 d7 38 a3 ff  76 ef a5 66 d8 7e c2 25  |.+.&.8..v..f.~.%|
-000002f0  b6 3b 4c 61 a4 e6 66 6c  ab 0b 76 be f9 bd c1 57  |.;La..fl..v....W|
-00000300  69 8b 7b 69 f4 aa 16 80  67 66                    |i.{i....gf|
+00000240  00 8d 00 8b 30 81 88 02  42 01 53 2c a8 59 57 d2  |....0...B.S,.YW.|
+00000250  fc 0b 12 27 6f 9a f7 4e  a0 dd 2c af 1b 4c 81 0b  |...'o..N..,..L..|
+00000260  97 79 7e 6f dd a1 cf cb  e2 14 4d af 76 99 d8 06  |.y~o......M.v...|
+00000270  4f 8d 4f 86 d3 25 04 ea  80 02 ae 25 10 9d 2d 59  |O.O..%.....%..-Y|
+00000280  11 39 65 6b 83 d0 16 7d  bf a8 a4 02 42 01 f2 16  |.9ek...}....B...|
+00000290  6c f1 e6 3b b1 af fb 3f  99 f0 8a e3 c8 62 ba 71  |l..;...?.....b.q|
+000002a0  12 a1 2c 1e 15 74 d5 98  b5 ae 9f 50 a2 15 9b 73  |..,..t.....P...s|
+000002b0  9a 5f 2c 90 d4 9d 20 6f  35 b6 32 3e f4 b7 dd 50  |._,... o5.2>...P|
+000002c0  64 42 e3 4e 51 f3 11 4b  b4 9e a3 92 a2 10 59 14  |dB.NQ..K......Y.|
+000002d0  03 01 00 01 01 16 03 01  00 30 78 8c 7c 31 ce 16  |.........0x.|1..|
+000002e0  8f 1f 2a b9 ee cb 72 7f  1e 59 5b ad c2 58 32 77  |..*...r..Y[..X2w|
+000002f0  fa 46 83 b9 67 0c 5f 41  25 6a 38 ec 20 d2 80 e6  |.F..g._A%j8. ...|
+00000300  be 85 ce 94 b1 89 5f 8d  17 9b                    |......_...|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 cd bc 57 18 7a  |..........0..W.z|
-00000010  a7 bb c8 5e 11 d0 c0 fb  97 ca 66 f9 7e 0d 87 12  |...^......f.~...|
-00000020  74 7a 16 3f eb a2 00 4e  87 38 f3 cf c5 70 c1 bd  |tz.?...N.8...p..|
-00000030  90 da f4 ac 8c de 01 89  55 6d f2                 |........Um.|
+00000000  14 03 01 00 01 01 16 03  01 00 30 95 d6 f2 a2 75  |..........0....u|
+00000010  0e f8 c7 7c f9 1d 65 b4  82 08 c9 62 aa 93 24 8f  |...|..e....b..$.|
+00000020  4d 11 c7 b0 17 04 f1 0a  8b be 64 06 f9 07 20 0b  |M.........d... .|
+00000030  f0 3b 92 db 62 ba 63 91  a1 58 fe                 |.;..b.c..X.|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 5e e2 92  23 e7 86 82 20 ff 35 ff  |.... ^..#... .5.|
-00000010  d2 d9 e0 b5 71 4b b4 f9  fb d4 01 e4 c3 52 32 ed  |....qK.......R2.|
-00000020  54 25 4e d1 30 17 03 01  00 20 39 bd 5d 9f 4b cd  |T%N.0.... 9.].K.|
-00000030  a8 92 5f e2 d6 ab 11 8d  ad 95 44 7d 24 e1 02 78  |.._.......D}$..x|
-00000040  ac 72 eb ed 01 28 a4 cc  68 d3 15 03 01 00 20 35  |.r...(..h..... 5|
-00000050  3d 90 bf 16 9a f4 27 9f  98 a7 7b 19 3f d9 2a 6c  |=.....'...{.?.*l|
-00000060  68 86 34 e0 1a f0 29 8c  22 9d 2a ca a1 52 42     |h.4...).".*..RB|
+00000000  17 03 01 00 20 3e a4 b5  b5 2f 4f c8 e0 08 cf 8a  |.... >.../O.....|
+00000010  9c f6 69 94 a9 91 0f 5d  c5 06 ee 71 e2 42 11 b4  |..i....]...q.B..|
+00000020  a8 17 54 19 3d 17 03 01  00 20 ce d2 8d 8a 78 e4  |..T.=.... ....x.|
+00000030  15 a4 ab 83 0d 9c fa 47  1c 8f 2d 87 a8 55 65 9d  |.......G..-..Ue.|
+00000040  7f 03 75 11 62 83 0b 44  0b f1 15 03 01 00 20 eb  |..u.b..D...... .|
+00000050  1a 46 95 1e 1b 10 b7 25  a8 c4 5b db 8b 3c 61 c9  |.F.....%..[..<a.|
+00000060  25 38 27 1e 69 11 18 16  0a 25 44 ad 9f 52 64     |%8'.i....%D..Rd|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA
index 1b099bf9fd..7e9c2724ab 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 59 02 00 00  55 03 01 08 ca d5 3f fe  |....Y...U.....?.|
-00000010  f1 63 e8 2e 30 e5 03 e8  9e 7e fa cb 96 bc 97 dd  |.c..0....~......|
-00000020  a4 47 97 09 cf e2 44 1c  1b e5 f1 20 19 7a c6 2f  |.G....D.... .z./|
-00000030  55 36 8d d9 ef d1 2b 08  49 b7 65 df 9b 76 75 46  |U6....+.I.e..vuF|
-00000040  35 bb c9 29 6c 66 76 a4  3b 35 3f 9a c0 13 00 00  |5..)lfv.;5?.....|
+00000000  16 03 01 00 59 02 00 00  55 03 01 32 7c 5c ac bd  |....Y...U..2|\..|
+00000010  77 70 c2 f8 f0 20 37 e4  e8 45 db be 97 22 e4 f3  |wp... 7..E..."..|
+00000020  24 1c c1 29 8f 02 e1 bc  ba 4a 1e 20 81 6f b5 12  |$..).....J. .o..|
+00000030  c0 9d 9e de 2f b6 04 b2  74 34 da 2b 04 55 2c 4f  |..../...t4.+.U,O|
+00000040  dd 01 8a 30 d9 67 45 9f  f1 31 f1 78 c0 13 00 00  |...0.gE..1.x....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  01 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -54,17 +54,17 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 01 00  |.=.`.\!.;.......|
-000002c0  aa 0c 00 00 a6 03 00 1d  20 b3 f2 56 35 8a ac c5  |........ ..V5...|
-000002d0  46 cb c0 4b 69 04 e8 36  f0 9b 29 c8 f4 b8 49 3b  |F..Ki..6..)...I;|
-000002e0  4f b0 f5 71 39 5e fd 45  14 00 80 44 b1 98 23 ab  |O..q9^.E...D..#.|
-000002f0  14 4c fb ca f5 af c9 2f  74 0b 05 17 f1 88 49 69  |.L...../t.....Ii|
-00000300  d8 7f aa 0d 9c 16 64 57  cc e9 62 5e ef c0 5f 37  |......dW..b^.._7|
-00000310  6f 2b 7b 40 b0 c6 a7 a9  e5 52 45 2b e3 4b f4 b4  |o+{@.....RE+.K..|
-00000320  12 2e 7f fc 49 81 64 1a  33 d9 09 c8 a9 0e 3a cc  |....I.d.3.....:.|
-00000330  43 7e 55 76 aa 34 fd 79  ca 22 8d 29 67 f9 53 b5  |C~Uv.4.y.".)g.S.|
-00000340  77 d8 52 ae b2 d5 00 18  ae ff da 28 22 2a bd 53  |w.R........("*.S|
-00000350  63 a0 9d da f3 af f4 d2  70 47 a9 44 79 13 e6 68  |c.......pG.Dy..h|
-00000360  d3 9e 89 2e 4e 5b fa 2d  15 60 d3 16 03 01 00 0a  |....N[.-.`......|
+000002c0  aa 0c 00 00 a6 03 00 1d  20 2f f7 3b 44 1a 47 85  |........ /.;D.G.|
+000002d0  d7 db 40 28 4e 6a f1 2f  1e b5 cc b0 58 0d 92 93  |..@(Nj./....X...|
+000002e0  30 41 65 08 05 f7 51 23  57 00 80 87 0d c3 22 ff  |0Ae...Q#W.....".|
+000002f0  aa d1 3f 55 09 cf 98 dc  91 f8 d0 63 58 da dc 52  |..?U.......cX..R|
+00000300  03 f0 06 a6 4e 7e 5b 96  a1 3b d7 8e 1e 68 50 ef  |....N~[..;...hP.|
+00000310  59 3f 78 06 eb 9a 33 c5  01 3c e0 fb c6 f1 b6 bc  |Y?x...3..<......|
+00000320  5a bc 95 e8 43 d9 ab 36  05 26 13 c5 a6 68 9b e2  |Z...C..6.&...h..|
+00000330  b1 42 6e 89 60 5c b3 91  02 c5 8b ab 53 d1 d9 79  |.Bn.`\......S..y|
+00000340  d0 37 b5 5e 2c 16 72 29  f8 9c d0 4a 46 87 46 f4  |.7.^,.r)...JF.F.|
+00000350  01 2b e8 6a 4f 59 d1 2d  3d de 4b 3b 0e c7 cd 42  |.+.jOY.-=.K;...B|
+00000360  ae d2 94 e9 a6 6b 65 ad  3f 77 57 16 03 01 00 0a  |.....ke.?wW.....|
 00000370  0d 00 00 06 03 01 02 40  00 00 16 03 01 00 04 0e  |.......@........|
 00000380  00 00 00                                          |...|
 >>> Flow 3 (client to server)
@@ -104,29 +104,29 @@
 00000210  03 01 00 25 10 00 00 21  20 2f e5 7d a3 47 cd 62  |...%...! /.}.G.b|
 00000220  43 15 28 da ac 5f bb 29  07 30 ff f6 84 af c4 cf  |C.(.._.).0......|
 00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 01 00 91 0f 00  |...._X.;t.......|
-00000240  00 8d 00 8b 30 81 88 02  42 00 ab b7 a8 9c 96 37  |....0...B......7|
-00000250  e7 dd 07 f5 8e 8f e4 a9  de 20 17 48 a2 e0 15 8c  |......... .H....|
-00000260  85 81 86 ff 7f 36 d4 a6  dd 66 33 f4 cf cd 15 20  |.....6...f3.... |
-00000270  2f 9e 52 36 2b ae ff 8d  21 59 1e a7 83 36 e6 5e  |/.R6+...!Y...6.^|
-00000280  89 77 2c b9 ea 47 b1 73  e3 e1 c2 02 42 01 5a e4  |.w,..G.s....B.Z.|
-00000290  73 4f b8 9d 35 47 88 ee  f8 ca 86 4c cd 00 f4 e3  |sO..5G.....L....|
-000002a0  f7 4a 17 20 51 bc 67 53  b7 e9 ca e2 fe ad 5d 88  |.J. Q.gS......].|
-000002b0  33 fe 5e 01 c4 e3 a1 7b  ae 06 69 cf d8 76 ba 6d  |3.^....{..i..v.m|
-000002c0  a2 3f 21 ee fa fd 58 53  49 d2 af 88 5e 5d 36 14  |.?!...XSI...^]6.|
-000002d0  03 01 00 01 01 16 03 01  00 30 37 93 45 ae 7e 87  |.........07.E.~.|
-000002e0  04 e8 1a 5e d9 24 d9 13  6c a2 e2 df 78 58 6a ea  |...^.$..l...xXj.|
-000002f0  93 f2 2d 4b 31 c2 7e ca  47 b5 8b 67 73 5d ac 33  |..-K1.~.G..gs].3|
-00000300  d6 e1 88 7b 45 7d b5 11  13 0a                    |...{E}....|
+00000240  00 8d 00 8b 30 81 88 02  42 01 b3 df 59 06 71 e6  |....0...B...Y.q.|
+00000250  74 c9 9d d5 2c b0 a7 f8  1e ac bc f3 5a e2 ed 0b  |t...,.......Z...|
+00000260  f2 e9 37 82 c6 fe 7c 23  b9 63 6e 88 1d 63 31 ad  |..7...|#.cn..c1.|
+00000270  d3 29 48 eb f3 5d 52 f5  76 ab fc 16 9e 09 4f 49  |.)H..]R.v.....OI|
+00000280  cf b4 03 6a ed db e5 13  ea 67 74 02 42 01 8e 2f  |...j.....gt.B../|
+00000290  b8 12 38 c9 a6 8c 77 40  85 89 ef d8 ac 08 00 c0  |..8...w@........|
+000002a0  ee 70 68 a6 88 1f d1 67  0d 1b 7b 1f be e0 a7 b9  |.ph....g..{.....|
+000002b0  c3 7d ff 6a 39 3c b9 aa  f6 78 ac 9a ca 67 55 0c  |.}.j9<...x...gU.|
+000002c0  38 23 cc ab 18 c0 b9 ea  9c 84 61 32 0a 0d f3 14  |8#........a2....|
+000002d0  03 01 00 01 01 16 03 01  00 30 73 12 76 94 30 37  |.........0s.v.07|
+000002e0  e5 e3 30 59 88 2f 5f e9  f2 7b 3d 02 88 65 09 14  |..0Y./_..{=..e..|
+000002f0  68 23 02 d0 ae e5 7f 7f  8d 95 3b 1c 75 f5 1f 24  |h#........;.u..$|
+00000300  43 60 29 bb 0e 69 88 36  a9 68                    |C`)..i.6.h|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 6a 8a f0 2b c4  |..........0j..+.|
-00000010  1d 07 2e f2 28 5a 26 6b  2f 2d d1 16 c1 19 4c ae  |....(Z&k/-....L.|
-00000020  6f 68 08 7f 63 b3 bd f6  14 b4 91 07 7a fb 89 29  |oh..c.......z..)|
-00000030  eb e7 ae 4e 19 5c 1a 4b  5d 7f 6f                 |...N.\.K].o|
+00000000  14 03 01 00 01 01 16 03  01 00 30 a0 5f 7f 59 e0  |..........0._.Y.|
+00000010  b1 7e ed ad de 6a 47 94  21 e5 1b 77 a7 d0 88 fd  |.~...jG.!..w....|
+00000020  9e 4e 48 87 1d cf 40 e4  b9 38 a3 2e e4 00 c3 94  |.NH...@..8......|
+00000030  95 20 1c 97 d2 a9 3a 11  86 30 5f                 |. ....:..0_|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 8b ad b0  ee 52 ec c5 ce f0 6a a4  |.... ....R....j.|
-00000010  29 26 e3 03 b2 05 d8 bb  39 c0 15 03 f3 a2 1a 1b  |)&......9.......|
-00000020  cc 65 fb 99 9c 17 03 01  00 20 a1 71 d0 02 ee 24  |.e....... .q...$|
-00000030  4b 7a d2 7b 90 1c 45 0a  ca 30 bb 64 96 a7 87 96  |Kz.{..E..0.d....|
-00000040  35 de 1b a7 cc ec 0a b0  a7 83 15 03 01 00 20 32  |5............. 2|
-00000050  29 da b1 59 61 89 98 b1  16 49 06 16 92 d4 16 ae  |)..Ya....I......|
-00000060  ba 6a 3b 70 62 f3 78 e7  d7 44 76 4d ee e8 a0     |.j;pb.x..DvM...|
+00000000  17 03 01 00 20 ca 4c f5  cb 81 66 2f 97 e3 5d 8b  |.... .L...f/..].|
+00000010  dd 7d dd fa fe 8c 98 45  3f 3d 16 17 98 4d b5 15  |.}.....E?=...M..|
+00000020  6c 91 8a 79 7a 17 03 01  00 20 96 ec 30 cb d3 78  |l..yz.... ..0..x|
+00000030  b9 0a a1 ab fd 12 25 d5  82 7b 7a 3c 17 56 7b b7  |......%..{z<.V{.|
+00000040  c4 6e ea a2 5b d7 6b b6  22 a9 15 03 01 00 20 ba  |.n..[.k."..... .|
+00000050  ff fe 2b 60 83 34 ad 45  75 15 d5 95 b3 27 92 46  |..+`.4.Eu....'.F|
+00000060  47 ae f1 d4 a4 9d 63 ef  db d9 b5 37 0f f1 74     |G.....c....7..t|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA
index 982bf9f209..67772e174a 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 59 02 00 00  55 03 01 f6 7e e1 10 92  |....Y...U...~...|
-00000010  38 3e b6 5d 16 20 81 f9  6e 39 c0 b1 a9 72 8d 71  |8>.]. ..n9...r.q|
-00000020  a7 74 d9 e1 49 71 4b 61  89 6c b2 20 47 cc 58 2d  |.t..IqKa.l. G.X-|
-00000030  96 27 ac ea 66 83 72 43  57 d1 e6 d5 0e 56 75 0b  |.'..f.rCW....Vu.|
-00000040  6f f2 1b 38 0f 53 7d 00  26 ec a7 5c c0 09 00 00  |o..8.S}.&..\....|
+00000000  16 03 01 00 59 02 00 00  55 03 01 ed 13 de 15 cc  |....Y...U.......|
+00000010  90 4f f3 72 5a d4 7a 01  26 fa 7a ae 38 92 a0 d6  |.O.rZ.z.&.z.8...|
+00000020  70 4a 20 f6 7e 11 f7 ac  e6 94 87 20 9f 37 0f 8f  |pJ .~...... .7..|
+00000030  55 a6 6a 97 b8 0f 56 aa  2d 69 c5 79 01 d5 c0 01  |U.j...V.-i.y....|
+00000040  2c 2b 0e 16 d8 79 a3 f3  44 99 7c 01 c0 09 00 00  |,+...y..D.|.....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  01 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -49,20 +49,20 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 01 00 b5 0c 00  00 b1 03 00 1d 20 b4 dc  |*............ ..|
-00000280  cb b5 05 eb c2 36 db 24  a5 d7 95 09 57 b4 b3 ad  |.....6.$....W...|
-00000290  5c c0 20 1b 08 b1 6a 15  ab 20 73 5b 23 3e 00 8b  |\. ...j.. s[#>..|
-000002a0  30 81 88 02 42 01 ee a8  99 dc 57 90 78 da c5 b5  |0...B.....W.x...|
-000002b0  ca 64 9b 53 57 fc 6c f8  ca b1 f1 e7 57 e4 bd 33  |.d.SW.l.....W..3|
-000002c0  f7 0c ae 5e 89 8e 65 e5  72 2d 5d b6 a6 b5 d7 ad  |...^..e.r-].....|
-000002d0  12 c8 34 bf 4d 72 53 db  ac ba dc ed 04 64 63 13  |..4.MrS......dc.|
-000002e0  a0 43 2b 0c 4a 26 82 02  42 01 a4 70 cc b8 b3 77  |.C+.J&..B..p...w|
-000002f0  31 14 bf 51 c6 e1 01 b1  93 47 b2 12 56 74 d1 b8  |1..Q.....G..Vt..|
-00000300  41 5a 04 c5 6c c6 36 02  cb 07 b6 48 08 1c 45 ac  |AZ..l.6....H..E.|
-00000310  23 14 68 e0 38 00 1c 2d  8a 3b 74 ac 51 ea b8 13  |#.h.8..-.;t.Q...|
-00000320  e8 37 a3 c1 41 e9 ef 2c  a4 7c 66 16 03 01 00 0a  |.7..A..,.|f.....|
-00000330  0d 00 00 06 03 01 02 40  00 00 16 03 01 00 04 0e  |.......@........|
-00000340  00 00 00                                          |...|
+00000270  2a 16 03 01 00 b4 0c 00  00 b0 03 00 1d 20 ca e8  |*............ ..|
+00000280  ef 79 56 cd aa eb 12 8f  e1 89 d1 3c 63 1f c8 54  |.yV........<c..T|
+00000290  5f 4e cf 6b 72 7d 1c bb  f6 80 ae 17 33 69 00 8a  |_N.kr}......3i..|
+000002a0  30 81 87 02 42 01 d1 45  df fc 46 21 5b 9b 49 f0  |0...B..E..F![.I.|
+000002b0  3c f2 16 65 1e 33 90 d8  be 1d 65 12 2f 46 93 5b  |<..e.3....e./F.[|
+000002c0  e2 14 67 b8 67 9b c1 10  31 a1 96 b8 86 c3 8b 26  |..g.g...1......&|
+000002d0  3f da 5e 86 e7 b1 f9 3f  f1 04 57 ed e6 6f a5 86  |?.^....?..W..o..|
+000002e0  f7 58 38 6e 0d ae 42 02  41 05 1b 07 9b 4c 4d 39  |.X8n..B.A....LM9|
+000002f0  2d 0c 4e d7 94 d6 86 c9  6c b9 4d 54 a2 56 87 12  |-.N.....l.MT.V..|
+00000300  08 ec 4e f1 a4 19 5e 52  69 ed 9f 6c 59 5f 31 0f  |..N...^Ri..lY_1.|
+00000310  8d 33 1f a7 42 e5 56 9d  54 f4 18 9b 33 31 97 b9  |.3..B.V.T...31..|
+00000320  57 55 c9 9f ea 7d f2 9e  24 e0 16 03 01 00 0a 0d  |WU...}..$.......|
+00000330  00 00 06 03 01 02 40 00  00 16 03 01 00 04 0e 00  |......@.........|
+00000340  00 00                                             |..|
 >>> Flow 3 (client to server)
 00000000  16 03 01 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
 00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
@@ -99,29 +99,29 @@
 00000200  e5 35 16 03 01 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
 00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 01 00  |......._X.;t....|
-00000230  86 0f 00 00 82 00 80 1c  4f 5d 53 3a 15 c0 51 44  |........O]S:..QD|
-00000240  ff fa 46 c5 01 51 0b e9  22 b8 2f 99 5b 55 5a 98  |..F..Q.."./.[UZ.|
-00000250  58 3c 0d a6 ca c6 85 39  0a c2 21 a0 68 78 a1 ab  |X<.....9..!.hx..|
-00000260  9c 1d 5c db 8c 87 86 72  3e a8 b7 38 e2 66 9f 4b  |..\....r>..8.f.K|
-00000270  d9 3d df f6 dd 64 f8 7c  03 4e a3 c1 88 9e 09 fd  |.=...d.|.N......|
-00000280  a1 20 54 6d 38 f3 14 27  11 37 01 6b c6 42 8c a2  |. Tm8..'.7.k.B..|
-00000290  c8 2b 14 0e 20 f0 66 91  4a de 02 fe f7 62 f2 5b  |.+.. .f.J....b.[|
-000002a0  74 45 e1 ed 32 1f f7 f8  10 99 8d db 2c 30 02 7a  |tE..2.......,0.z|
-000002b0  f2 6e ab 45 40 0f 50 14  03 01 00 01 01 16 03 01  |.n.E@.P.........|
-000002c0  00 30 84 fd 92 b9 4b 54  3b 1b e1 db 11 cc 3b 48  |.0....KT;.....;H|
-000002d0  c6 b3 f4 f6 8d 92 28 05  c2 c8 d7 75 7b 68 fb 06  |......(....u{h..|
-000002e0  63 a2 67 a0 77 21 a1 07  97 07 13 97 58 74 03 d5  |c.g.w!......Xt..|
-000002f0  8b ed                                             |..|
+00000230  86 0f 00 00 82 00 80 8f  6f 77 5d d5 99 28 0c 7a  |........ow]..(.z|
+00000240  36 f2 50 ec 9a e6 eb 88  ac 45 f7 9b 6f 98 84 ba  |6.P......E..o...|
+00000250  fb 3c b8 d6 54 61 b8 87  25 50 3c 31 5a d2 c1 54  |.<..Ta..%P<1Z..T|
+00000260  e8 ed c3 93 cc 98 b1 c3  d4 84 11 d8 a0 c7 ae 67  |...............g|
+00000270  67 35 6a 0f 93 18 bb 18  52 f8 25 88 1f d2 19 4d  |g5j.....R.%....M|
+00000280  3b 4c f2 0f f7 06 68 57  cf 45 20 e0 57 75 37 e9  |;L....hW.E .Wu7.|
+00000290  cd 86 1f e5 d2 90 1e cf  3a 18 fd 45 bc a1 84 63  |........:..E...c|
+000002a0  36 d8 ac 6b 09 41 da 0a  87 7f ab ce 8e 49 e6 c8  |6..k.A.......I..|
+000002b0  bf fb 2c 3b 7b e9 ae 14  03 01 00 01 01 16 03 01  |..,;{...........|
+000002c0  00 30 7d 65 9c c1 25 e4  85 d7 39 d4 67 cf eb f1  |.0}e..%...9.g...|
+000002d0  b7 c2 4d e6 5d bd 13 74  55 22 f0 8a 7e a6 a2 eb  |..M.]..tU"..~...|
+000002e0  93 cc b7 fa 86 b1 b5 e0  a3 ef ee 56 f0 cd f7 a5  |...........V....|
+000002f0  d8 9e                                             |..|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 a7 c0 55 91 23  |..........0..U.#|
-00000010  2f fb 65 17 ac 60 6a c6  d2 ed 2d 0a fe 4f 5b e8  |/.e..`j...-..O[.|
-00000020  93 01 88 f8 39 8d 06 97  11 85 9d d3 40 a9 75 c6  |....9.......@.u.|
-00000030  02 66 69 c2 cd b4 6d 49  00 e7 0d                 |.fi...mI...|
+00000000  14 03 01 00 01 01 16 03  01 00 30 ff 13 14 c5 ad  |..........0.....|
+00000010  88 ec a1 cf cc 0d 3f 7b  ec 50 4a 25 69 1f 18 dc  |......?{.PJ%i...|
+00000020  b1 99 1f 3b 78 60 e0 83  c0 cd 9a b3 0d 59 0b f8  |...;x`.......Y..|
+00000030  8a b7 7c 2c b4 2c e4 d0  49 82 82                 |..|,.,..I..|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 c8 5f 0f  28 8e 50 2c 3d 18 97 02  |.... ._.(.P,=...|
-00000010  f2 d0 25 86 01 10 4e 51  d3 9d 1a 60 35 50 52 c8  |..%...NQ...`5PR.|
-00000020  1b 24 aa 9d 3d 17 03 01  00 20 b5 97 88 98 99 7e  |.$..=.... .....~|
-00000030  d5 49 63 85 5e 80 ba f1  42 d1 58 3d df d0 25 5a  |.Ic.^...B.X=..%Z|
-00000040  c4 2a a7 fb 45 78 d7 02  2b d2 15 03 01 00 20 3b  |.*..Ex..+..... ;|
-00000050  5d 1c 4a 60 2f 7e 66 a5  5f 87 2f 3b 14 08 ad cb  |].J`/~f._./;....|
-00000060  e7 df 4d 7c 03 cc 03 ca  b5 c4 5b 1f d7 e3 f0     |..M|......[....|
+00000000  17 03 01 00 20 51 91 74  f6 31 07 15 6b 9e 0b 28  |.... Q.t.1..k..(|
+00000010  02 b8 ec 9d c6 e3 15 24  d3 ea 4b 27 d0 fa 9f c2  |.......$..K'....|
+00000020  c4 8d 37 b3 d9 17 03 01  00 20 7d 97 75 fe de 3f  |..7...... }.u..?|
+00000030  ae ab e6 a8 1d 76 1c 06  9c 02 61 cc f5 1d fe c8  |.....v....a.....|
+00000040  a2 dc ae 97 7f 1c 05 19  e5 14 15 03 01 00 20 4a  |.............. J|
+00000050  bc 45 97 6b 09 8e 47 5f  d5 a0 97 78 79 67 09 8d  |.E.k..G_...xyg..|
+00000060  d3 80 38 58 5c cc ae 8e  d4 67 1d 93 2b 20 79     |..8X\....g..+ y|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA
index cb956e9791..e585894db7 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 59 02 00 00  55 03 01 13 70 8b ce 13  |....Y...U...p...|
-00000010  6e e5 50 5a 92 bf 18 33  b3 5b 1a bb 52 a9 47 3e  |n.PZ...3.[..R.G>|
-00000020  d3 23 e0 fa a1 af 66 9b  f0 e4 79 20 47 dc 49 70  |.#....f...y G.Ip|
-00000030  99 9e 03 5c fb a2 a8 6a  af e8 75 ff a9 e0 c1 e5  |...\...j..u.....|
-00000040  5c 5a 5e a0 78 ae d1 73  3d 29 04 b7 c0 13 00 00  |\Z^.x..s=)......|
+00000000  16 03 01 00 59 02 00 00  55 03 01 61 6b 2e 41 7f  |....Y...U..ak.A.|
+00000010  af 26 6f a2 8b 63 ee e4  b1 76 19 3a 6d a3 c2 30  |.&o..c...v.:m..0|
+00000020  37 e8 47 c2 90 10 7e e8  c5 b2 eb 20 00 1c 8f 70  |7.G...~.... ...p|
+00000030  0d 15 4a c7 7d ab ca 79  a7 d8 c2 01 62 6e 6f aa  |..J.}..y....bno.|
+00000040  df a2 1c 8f 7c 27 d9 e6  fe e9 c8 ab c0 13 00 00  |....|'..........|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  01 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -54,17 +54,17 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 01 00  |.=.`.\!.;.......|
-000002c0  aa 0c 00 00 a6 03 00 1d  20 8f 09 63 f7 eb 09 5b  |........ ..c...[|
-000002d0  90 a8 cc 46 27 10 b9 ab  ac dc ff ee 98 27 8d a8  |...F'........'..|
-000002e0  25 5a d0 0c b8 2a 5f 25  00 00 80 a2 2d 18 6c 8d  |%Z...*_%....-.l.|
-000002f0  1d a1 62 35 fe 9a 97 a3  f7 59 56 7f a3 6b 26 7d  |..b5.....YV..k&}|
-00000300  b6 7c e7 f2 d2 30 4e 77  50 91 47 bb 48 e9 3a c1  |.|...0NwP.G.H.:.|
-00000310  c6 58 a4 96 3b 98 3f a8  15 90 51 25 af 50 fc bd  |.X..;.?...Q%.P..|
-00000320  3d fa c3 d4 32 19 fe 9b  bb e5 07 f5 26 56 3a d7  |=...2.......&V:.|
-00000330  e5 00 82 7d dd 26 d8 19  16 6b db 95 20 99 13 44  |...}.&...k.. ..D|
-00000340  8b a5 8b 75 48 de a7 87  cb c4 97 56 60 66 cd d8  |...uH......V`f..|
-00000350  c1 24 7b 21 4a b5 43 1d  37 a5 02 1d 49 33 c9 87  |.${!J.C.7...I3..|
-00000360  af b1 03 0d eb 33 95 ff  ef 8a f6 16 03 01 00 0a  |.....3..........|
+000002c0  aa 0c 00 00 a6 03 00 1d  20 29 0b ca 37 f3 a1 52  |........ )..7..R|
+000002d0  49 1c 84 9a e4 74 6b 4b  2d 1f e6 e9 83 1d 5d 59  |I....tkK-.....]Y|
+000002e0  5a 2f 09 9f bc a4 30 af  71 00 80 d9 bb 6d 09 a7  |Z/....0.q....m..|
+000002f0  ab 47 6f e8 a6 1a da fb  66 7d a5 f0 c9 c3 24 4c  |.Go.....f}....$L|
+00000300  99 56 c6 29 71 27 08 0b  c1 60 44 cc 6d 42 1b 5e  |.V.)q'...`D.mB.^|
+00000310  cd 9f 82 24 38 23 ec d9  fa 32 49 2f 16 5d d2 9d  |...$8#...2I/.]..|
+00000320  e9 13 4e 66 3d f8 bf 30  2e 8c eb 35 4c e8 81 86  |..Nf=..0...5L...|
+00000330  c0 de c7 0d a9 60 7e 7c  4a c4 1d a0 89 70 de 82  |.....`~|J....p..|
+00000340  1b 37 a0 ea 7f 20 a5 fe  d4 20 1d 6f 1a 84 dd a4  |.7... ... .o....|
+00000350  13 46 18 c6 31 14 81 4b  a4 bb 43 5c c4 49 1c 5a  |.F..1..K..C\.I.Z|
+00000360  8d 12 57 e0 1d 9a b6 cd  f1 39 ff 16 03 01 00 0a  |..W......9......|
 00000370  0d 00 00 06 03 01 02 40  00 00 16 03 01 00 04 0e  |.......@........|
 00000380  00 00 00                                          |...|
 >>> Flow 3 (client to server)
@@ -103,29 +103,29 @@
 00000200  e5 35 16 03 01 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
 00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 01 00  |......._X.;t....|
-00000230  86 0f 00 00 82 00 80 1c  2c 0b 87 f7 a9 33 09 7e  |........,....3.~|
-00000240  0b 19 c7 ef e4 bd e9 37  4e 3c 1e 36 5d 1f d0 51  |.......7N<.6]..Q|
-00000250  f7 87 40 66 c1 d2 54 c5  58 2f 03 32 1a 3b f3 4c  |..@f..T.X/.2.;.L|
-00000260  97 db 49 93 ba c5 c0 f4  d2 eb 43 58 25 80 f8 4d  |..I.......CX%..M|
-00000270  1c 6d 10 79 ea d6 b4 07  01 58 a2 a1 48 ae 06 a2  |.m.y.....X..H...|
-00000280  a7 2b 1e 36 a3 58 ab b6  a6 60 24 1d c1 7d 49 2e  |.+.6.X...`$..}I.|
-00000290  14 2d ca 7d 7f df 3f 79  51 43 75 06 86 0b 7d de  |.-.}..?yQCu...}.|
-000002a0  a4 76 18 8d 54 fa 41 b3  d9 06 f0 44 de c7 41 53  |.v..T.A....D..AS|
-000002b0  05 33 0f 5a 48 9e 76 14  03 01 00 01 01 16 03 01  |.3.ZH.v.........|
-000002c0  00 30 ec 96 c4 f6 af 71  4f b6 c9 e0 bf b6 15 51  |.0.....qO......Q|
-000002d0  5d 0a b6 6b 39 d9 9f 53  0f 7e 0c b7 8e 76 0c c4  |]..k9..S.~...v..|
-000002e0  15 36 07 27 51 f9 3e cb  0c 4e 5f 99 19 2d 3c dd  |.6.'Q.>..N_..-<.|
-000002f0  65 0d                                             |e.|
+00000230  86 0f 00 00 82 00 80 12  76 af 25 e4 e7 ff d6 e4  |........v.%.....|
+00000240  27 58 31 0f 6b 1e 84 13  2f d0 60 80 18 c3 f8 c1  |'X1.k.../.`.....|
+00000250  f8 04 39 d4 07 05 d3 96  e2 b2 10 de 1f 68 88 67  |..9..........h.g|
+00000260  1d dd 0a 11 52 9d 16 0e  af 07 de cb f1 7c f4 b4  |....R........|..|
+00000270  5d 0f 4f 43 5b 3c 25 07  32 13 f2 ab 9b 2d d0 a8  |].OC[<%.2....-..|
+00000280  28 90 cb 04 48 c3 43 bd  2b b4 ef b9 7b cd bd d5  |(...H.C.+...{...|
+00000290  bc d1 cc 00 17 46 fa 9b  1f 44 58 b7 6c de 1b 7a  |.....F...DX.l..z|
+000002a0  e0 d7 12 38 a3 09 f8 7a  9b 26 0b ee 37 bc 79 1b  |...8...z.&..7.y.|
+000002b0  51 9f 9a 1f f9 a9 51 14  03 01 00 01 01 16 03 01  |Q.....Q.........|
+000002c0  00 30 97 df fb 79 78 a8  27 fd 2b 68 6b ec 4d 29  |.0...yx.'.+hk.M)|
+000002d0  a1 02 59 ae 18 0b 46 62  af 61 53 2f 95 50 f2 ac  |..Y...Fb.aS/.P..|
+000002e0  c8 c3 5e 78 ca b0 e2 5d  ff d7 1b 9b 00 30 f6 da  |..^x...].....0..|
+000002f0  d7 91                                             |..|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 2f ff 36 c3 9e  |..........0/.6..|
-00000010  9e ac 31 15 84 6f c2 c0  fa ce d0 bd 02 9b 75 79  |..1..o........uy|
-00000020  31 d7 9d 38 ad d3 3f 3d  37 7b 2b 0c 9e 01 eb 48  |1..8..?=7{+....H|
-00000030  db fd e2 13 92 d6 75 27  67 f5 1c                 |......u'g..|
+00000000  14 03 01 00 01 01 16 03  01 00 30 f9 e9 d7 8c 4a  |..........0....J|
+00000010  6b f4 c9 88 d6 98 70 53  13 fc 51 9c 81 14 cf 71  |k.....pS..Q....q|
+00000020  d9 30 7a d9 2c 34 96 00  a4 a0 2b 1e 7d ff d0 f2  |.0z.,4....+.}...|
+00000030  b7 81 ed 86 c5 e1 09 16  82 47 20                 |.........G |
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 6e b9 45  11 17 34 fd 03 ec 49 11  |.... n.E..4...I.|
-00000010  b1 2c cb d8 53 20 21 8f  1a 0f 04 3e ef 73 0f a0  |.,..S !....>.s..|
-00000020  4c 1f df 63 08 17 03 01  00 20 ab 15 7e c9 84 36  |L..c..... ..~..6|
-00000030  06 f2 f3 fe a6 cf ad 04  16 26 49 a2 bd 32 b2 a1  |.........&I..2..|
-00000040  08 8c c6 98 2f 1f 01 8a  13 be 15 03 01 00 20 90  |..../......... .|
-00000050  6a b8 ab fc 99 e0 79 1e  fc 5d 7d f4 07 f8 ff c5  |j.....y..]}.....|
-00000060  e7 62 c6 31 1e 93 08 4c  78 50 b5 d2 db 7f 79     |.b.1...LxP....y|
+00000000  17 03 01 00 20 db b5 66  4e fb b1 47 8a 8e 6b a8  |.... ..fN..G..k.|
+00000010  03 53 1a 51 22 8e 47 a3  3a 74 ed a4 6a aa 79 fd  |.S.Q".G.:t..j.y.|
+00000020  55 0f ac 35 a9 17 03 01  00 20 3e 0b 39 f5 5a 03  |U..5..... >.9.Z.|
+00000030  43 d9 e2 7d 1c dc 3b 42  82 2a 2d d4 04 0a 76 97  |C..}..;B.*-...v.|
+00000040  70 ed ee 99 58 15 40 c1  3a d5 15 03 01 00 20 bf  |p...X.@.:..... .|
+00000050  ea e8 93 67 a4 91 1a b5  f5 03 a5 94 50 95 41 16  |...g........P.A.|
+00000060  b0 2a 74 d9 32 65 94 35  45 b9 0f 2e 80 87 fd     |.*t.2e.5E......|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES
index 97a3c75bd5..529b7cef48 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 59 02 00 00  55 03 01 7f 7a 72 0f 01  |....Y...U...zr..|
-00000010  51 e6 e1 84 7c c5 e8 70  bf 7f a9 19 17 76 24 90  |Q...|..p.....v$.|
-00000020  23 b9 ca 72 9c c1 53 d7  da 58 75 20 d6 44 9b 50  |#..r..S..Xu .D.P|
-00000030  2e 64 10 11 07 5e 33 cb  b2 13 72 74 a4 02 f7 46  |.d...^3...rt...F|
-00000040  fe 88 dc 32 3e 9b 04 fc  b1 cc 17 70 c0 09 00 00  |...2>......p....|
+00000000  16 03 01 00 59 02 00 00  55 03 01 b0 ec 4b 2e 9e  |....Y...U....K..|
+00000010  19 7d 7b 7e 7c 52 8a d2  2e 8a 97 05 8a c6 ae aa  |.}{~|R..........|
+00000020  c5 62 bd 6f bd 7e fe 6b  c6 9f d4 20 74 db 02 b1  |.b.o.~.k... t...|
+00000030  65 88 41 bb 9a 55 22 f3  01 c4 5c ca 39 86 b1 77  |e.A..U"...\.9..w|
+00000040  c4 b3 45 16 eb 55 d8 15  b8 4d ac 12 c0 09 00 00  |..E..U...M......|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  01 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -49,37 +49,37 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 01 00 b5 0c 00  00 b1 03 00 1d 20 9a 73  |*............ .s|
-00000280  13 72 2e de 36 07 b0 c7  05 90 f6 d7 83 06 85 0a  |.r..6...........|
-00000290  d5 d7 be 7a ed 5c 12 e2  57 95 8e fc 96 6b 00 8b  |...z.\..W....k..|
-000002a0  30 81 88 02 42 01 a7 30  a7 09 63 5c d3 1f 82 80  |0...B..0..c\....|
-000002b0  11 41 fe 84 53 7b 1c fa  a6 d6 f5 cd 21 f5 85 e2  |.A..S{......!...|
-000002c0  c3 29 4b e7 9c e1 6e 59  d8 89 4a ac dd 6a 28 60  |.)K...nY..J..j(`|
-000002d0  c2 74 36 92 86 9e 7d 03  90 54 41 d9 2e 95 1e 6e  |.t6...}..TA....n|
-000002e0  e6 02 e9 f6 99 e7 35 02  42 01 5f a8 f1 3f 05 2f  |......5.B._..?./|
-000002f0  ab a5 14 86 71 35 9a 41  f5 21 57 a4 8e 2f e6 d7  |....q5.A.!W../..|
-00000300  1b dc 35 65 10 11 92 47  59 8e 26 32 45 66 03 3b  |..5e...GY.&2Ef.;|
-00000310  98 31 d5 cc 39 d1 30 f9  40 75 3d ac 1b 4b 0d 03  |.1..9.0.@u=..K..|
-00000320  60 6a 0d 84 62 b8 30 f7  b4 4e 3c 16 03 01 00 04  |`j..b.0..N<.....|
+00000270  2a 16 03 01 00 b5 0c 00  00 b1 03 00 1d 20 7d 74  |*............ }t|
+00000280  bf aa a8 b6 c0 1f 78 0c  1a ee c5 b7 56 ff 5c aa  |......x.....V.\.|
+00000290  f4 e3 a5 0c f7 64 31 eb  85 8a c9 bd 05 1b 00 8b  |.....d1.........|
+000002a0  30 81 88 02 42 00 f8 5d  e5 bf 2e 70 79 f4 36 90  |0...B..]...py.6.|
+000002b0  fc 6e 9a cc f1 c4 01 50  8c b9 92 4e bd e0 82 2d  |.n.....P...N...-|
+000002c0  1b ab 30 71 d1 db 76 af  50 75 08 fb cb 50 5b 00  |..0q..v.Pu...P[.|
+000002d0  49 72 f5 d7 d9 44 48 94  ac 1d 8d 2e 50 90 ad a3  |Ir...DH.....P...|
+000002e0  42 2b 5f 57 48 5e 9e 02  42 00 bb 0b 9a d7 25 53  |B+_WH^..B.....%S|
+000002f0  04 5c 58 01 07 8e 3d ee  f5 4f 0b 80 bd 02 07 3e  |.\X...=..O.....>|
+00000300  ff b9 01 ac 7a 49 be 94  fa cf 58 5c 59 91 b5 5d  |....zI....X\Y..]|
+00000310  cc 61 b9 e3 2f 53 7d 3c  3f 41 c5 31 1a 90 fc fa  |.a../S}<?A.1....|
+00000320  f7 0b eb e9 01 17 ab 23  ab 28 63 16 03 01 00 04  |.......#.(c.....|
 00000330  0e 00 00 00                                       |....|
 >>> Flow 3 (client to server)
 00000000  16 03 01 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 01 00 01 01  |....._X.;t......|
-00000030  16 03 01 00 30 9f b5 ef  8e cb 94 f6 4a 6f 97 77  |....0.......Jo.w|
-00000040  36 bc ff a0 06 30 8e 22  54 95 63 64 b7 6e fc 89  |6....0."T.cd.n..|
-00000050  19 be 38 7b 66 11 a1 54  4e e7 27 f6 8e db e6 48  |..8{f..TN.'....H|
-00000060  74 68 34 d2 0f                                    |th4..|
+00000030  16 03 01 00 30 f5 d0 86  ef 96 7e b9 94 cc 19 62  |....0.....~....b|
+00000040  cc 3a 14 f1 74 a2 0d c8  b9 4c 5d 8a c5 80 60 23  |.:..t....L]...`#|
+00000050  d5 f5 04 06 16 e2 69 ca  4d 99 1b a0 b5 3b 7d 62  |......i.M....;}b|
+00000060  51 62 ee d9 60                                    |Qb..`|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 66 46 33 1e e1  |..........0fF3..|
-00000010  bd 36 f4 a0 f7 88 96 36  7c 4b a4 26 c8 e3 07 e6  |.6.....6|K.&....|
-00000020  ed 9e 65 dd bc 72 ca d0  c5 d1 b4 f0 0c f9 65 ff  |..e..r........e.|
-00000030  44 ef 92 cb 03 21 05 1f  00 d7 14                 |D....!.....|
+00000000  14 03 01 00 01 01 16 03  01 00 30 4d f9 c2 63 4f  |..........0M..cO|
+00000010  98 1b 02 ce df ca d1 15  a2 4f 6f 4c 2c b8 1a 88  |.........OoL,...|
+00000020  11 c9 b3 45 e6 1d cf e8  6b dd 8c 89 c6 1d 0b 66  |...E....k......f|
+00000030  82 d5 1d c6 55 14 1c 56  59 3e 69                 |....U..VY>i|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 38 08 92  32 d9 fe 2c 0b 82 11 d2  |.... 8..2..,....|
-00000010  d5 b5 02 42 19 87 15 03  8e ca 79 6b 6b b1 82 ba  |...B......ykk...|
-00000020  65 9d 53 67 6b 17 03 01  00 20 9d 95 f7 f3 d3 d5  |e.Sgk.... ......|
-00000030  98 47 3b 78 89 40 43 b2  3b 3c 32 1a 08 fc 02 00  |.G;x.@C.;<2.....|
-00000040  1b ad be a6 2a 65 6e 15  b7 8e 15 03 01 00 20 d7  |....*en....... .|
-00000050  4d d1 d1 58 bc 6e 19 3e  28 66 f0 a6 74 ba 02 78  |M..X.n.>(f..t..x|
-00000060  d2 aa 62 2b c1 91 05 3d  11 89 9e c3 6d 33 16     |..b+...=....m3.|
+00000000  17 03 01 00 20 12 be 42  b4 31 07 55 8e f9 a1 64  |.... ..B.1.U...d|
+00000010  96 70 46 68 3e fd 4e 4f  9c af b3 11 de fc 80 f1  |.pFh>.NO........|
+00000020  c8 11 84 ba ae 17 03 01  00 20 2f f9 ec dd 50 97  |......... /...P.|
+00000030  1e a4 f1 66 fe 28 e3 c1  51 8d c0 f6 c3 d8 b3 ad  |...f.(..Q.......|
+00000040  7d dc a5 98 87 90 34 71  b4 73 15 03 01 00 20 d1  |}.....4q.s.... .|
+00000050  6f 91 91 01 68 c4 11 6a  e5 a2 ed 20 3f 3a 3d b7  |o...h..j... ?:=.|
+00000060  d9 7f c3 b3 29 c3 df 3e  17 69 76 9f 04 f8 58     |....)..>.iv...X|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES
index 9e81c4dbe5..78947ace0e 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 59 02 00 00  55 03 01 12 98 43 77 a8  |....Y...U....Cw.|
-00000010  19 99 16 b4 38 09 9b b6  b7 29 66 0b 73 88 be 43  |....8....)f.s..C|
-00000020  ac 06 f1 d6 64 bd 79 3e  3b d8 38 20 b7 8b 0e 4f  |....d.y>;.8 ...O|
-00000030  89 ad 72 b3 23 84 36 25  d1 ab 64 f3 8f ab b4 a0  |..r.#.6%..d.....|
-00000040  d0 30 78 c0 9d f7 63 c1  d9 8e 92 ce c0 13 00 00  |.0x...c.........|
+00000000  16 03 01 00 59 02 00 00  55 03 01 45 04 14 a2 70  |....Y...U..E...p|
+00000010  3e 1e d9 2c d4 bd f3 e8  9c f3 e0 08 d8 0f 7f 82  |>..,............|
+00000020  2b 07 a0 bd 47 56 a0 e1  06 0d 36 20 fc 0f 5b 85  |+...GV....6 ..[.|
+00000030  8e 17 20 f1 f6 1e 80 c3  79 1a e1 86 c3 ed e9 24  |.. .....y......$|
+00000040  6d bb 24 3c 0c 8d 2c 79  f2 03 27 b0 c0 13 00 00  |m.$<..,y..'.....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  01 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -54,36 +54,36 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 01 00  |.=.`.\!.;.......|
-000002c0  aa 0c 00 00 a6 03 00 1d  20 b7 6f b1 79 f8 fb ab  |........ .o.y...|
-000002d0  c6 75 22 1e 08 cc e7 cd  69 0a 86 1c de 60 9d 0e  |.u".....i....`..|
-000002e0  90 5b 9f b5 7b 6d 20 56  5d 00 80 a4 c0 4c 9c 50  |.[..{m V]....L.P|
-000002f0  da bc d7 ae 93 14 57 a9  1c b2 e6 3c 06 f4 7c 78  |......W....<..|x|
-00000300  a9 e9 06 ae ce 95 89 f1  1c 38 8f 45 40 b5 a9 67  |.........8.E@..g|
-00000310  b4 7d f6 65 10 6f 9e a7  64 e6 fa 0a 02 1b bf ea  |.}.e.o..d.......|
-00000320  b5 3f 59 e2 73 c6 e0 02  3e eb 23 16 77 a7 6a aa  |.?Y.s...>.#.w.j.|
-00000330  60 08 71 4f 36 37 cb cf  6d 11 31 fd 45 42 4a 1c  |`.qO67..m.1.EBJ.|
-00000340  37 27 02 13 6d d5 34 7a  64 61 12 38 17 26 ea c4  |7'..m.4zda.8.&..|
-00000350  16 bc c5 9c 57 31 e3 05  2a ff 65 29 2a 03 af f2  |....W1..*.e)*...|
-00000360  8b 00 cd f1 8a dd d1 5e  49 a5 ec 16 03 01 00 04  |.......^I.......|
+000002c0  aa 0c 00 00 a6 03 00 1d  20 85 05 5f e3 a2 b2 12  |........ .._....|
+000002d0  c8 82 53 2b c2 38 e1 a8  08 87 a7 d5 b3 98 6f 81  |..S+.8........o.|
+000002e0  ce 81 6b 78 3e 3a b7 1d  71 00 80 43 81 fb 47 5e  |..kx>:..q..C..G^|
+000002f0  08 16 39 35 d3 c2 f3 ea  bb 2c 7d bc 01 9b 35 5d  |..95.....,}...5]|
+00000300  63 7e c3 38 f3 04 96 eb  d7 3f d1 df 71 97 ec 22  |c~.8.....?..q.."|
+00000310  1b 4a 89 14 4d e5 44 08  87 52 69 ea 28 f8 6a ea  |.J..M.D..Ri.(.j.|
+00000320  3e ff 17 de 4d 20 95 e3  6e 3f af 05 20 9b a3 ac  |>...M ..n?.. ...|
+00000330  70 1b 1c bf f9 52 d6 11  6d d9 85 90 08 4d 64 1f  |p....R..m....Md.|
+00000340  c5 35 34 37 11 b8 44 a3  ef 93 a6 b6 87 58 0b c4  |.547..D......X..|
+00000350  8e 94 d8 67 4d 09 7a 2a  aa 95 db e6 af 29 21 a2  |...gM.z*.....)!.|
+00000360  ee c3 90 ef c6 53 46 12  fb 87 06 16 03 01 00 04  |.....SF.........|
 00000370  0e 00 00 00                                       |....|
 >>> Flow 3 (client to server)
 00000000  16 03 01 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 01 00 01 01  |....._X.;t......|
-00000030  16 03 01 00 30 45 0b 24  ee b4 ec 5e 4b 00 50 9a  |....0E.$...^K.P.|
-00000040  7d c7 db 51 b4 c4 31 f8  dc 62 d5 44 d2 5a 02 ce  |}..Q..1..b.D.Z..|
-00000050  c9 fa 35 2a fd 89 7d 64  3f b5 42 03 b1 b2 08 ee  |..5*..}d?.B.....|
-00000060  9e da 12 26 37                                    |...&7|
+00000030  16 03 01 00 30 50 f5 a9  34 25 ed a2 fb c8 7f 35  |....0P..4%.....5|
+00000040  08 57 59 da 54 c1 8d 92  ec 23 73 af f3 92 8d 19  |.WY.T....#s.....|
+00000050  03 ce ab 5b eb dc 5b 81  3f 51 a1 20 31 3f 33 da  |...[..[.?Q. 1?3.|
+00000060  27 c5 c3 9c fd                                    |'....|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 6a 3c 82 03 56  |..........0j<..V|
-00000010  6d 7c f1 cd 57 54 73 a7  d2 91 f8 51 07 e4 f7 86  |m|..WTs....Q....|
-00000020  bc 61 e0 86 1a ff fa f8  c9 4a 74 14 3a fa c9 67  |.a.......Jt.:..g|
-00000030  10 78 3e 30 14 4d ee 2e  e6 0f 4b                 |.x>0.M....K|
+00000000  14 03 01 00 01 01 16 03  01 00 30 b1 61 9b 63 4e  |..........0.a.cN|
+00000010  43 96 80 49 ac 2d 93 7d  b9 f2 bb 81 79 5e 94 bf  |C..I.-.}....y^..|
+00000020  06 d0 a6 14 46 91 cd 90  b0 8a 85 ee fe 41 a7 4d  |....F........A.M|
+00000030  97 d7 4d 40 5e f4 5b bd  d3 0c db                 |..M@^.[....|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 b2 62 65  f3 1d ec ed 26 8e e0 a3  |.... .be....&...|
-00000010  18 63 88 0e 50 13 61 a5  eb eb 61 30 e7 f8 ea 55  |.c..P.a...a0...U|
-00000020  bd e8 0e d4 4d 17 03 01  00 20 ac 64 b0 07 83 d2  |....M.... .d....|
-00000030  53 bb 7e 2f a2 9a e4 c8  e0 51 30 bd b7 2e f9 bf  |S.~/.....Q0.....|
-00000040  6a 9c c7 68 eb 7a 97 a9  de 14 15 03 01 00 20 84  |j..h.z........ .|
-00000050  8f 8d 04 b0 40 88 93 66  d7 e2 ea 74 d7 34 b9 c4  |....@..f...t.4..|
-00000060  43 27 f8 f5 4b e5 04 f0  ba e3 c7 b0 7c 0e c1     |C'..K.......|..|
+00000000  17 03 01 00 20 49 21 bc  a5 4c 96 41 3f 22 87 0a  |.... I!..L.A?"..|
+00000010  c0 4e 0e 54 cb c2 27 8a  4f b0 37 fb b4 1f c1 4e  |.N.T..'.O.7....N|
+00000020  77 e1 09 57 23 17 03 01  00 20 f0 f0 3b 78 a8 ae  |w..W#.... ..;x..|
+00000030  ef b1 e0 f4 29 0f 90 4a  0f e5 48 34 84 5e 4f d8  |....)..J..H4.^O.|
+00000040  53 46 f8 29 64 2b 8e 87  79 0a 15 03 01 00 20 71  |SF.)d+..y..... q|
+00000050  32 6c 08 2a f7 18 c8 d5  48 a8 c7 d1 68 7a 65 ec  |2l.*....H...hze.|
+00000060  3e fa 4b fe ff 76 1a 57  64 22 61 27 a0 5d b6     |>.K..v.Wd"a'.].|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4 b/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4
index 6028d9f802..7ecfbde86a 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4
+++ b/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 51 02 00 00  4d 03 01 d8 50 e1 90 2e  |....Q...M...P...|
-00000010  c0 9d 17 02 7c a3 9a 9e  4c 4f 4a 80 32 49 b9 32  |....|...LOJ.2I.2|
-00000020  2d ef b2 31 b4 d4 22 27  e9 09 ba 20 f1 93 96 a2  |-..1.."'... ....|
-00000030  0c d1 b3 27 ac 67 f3 e7  fa e7 b4 fb a6 b6 b1 47  |...'.g.........G|
-00000040  f8 f5 f0 94 c0 97 0b 05  80 a9 b9 c2 00 05 00 00  |................|
+00000000  16 03 01 00 51 02 00 00  4d 03 01 4c 98 ce a5 80  |....Q...M..L....|
+00000010  84 dc d3 70 de 75 bf 26  5c 15 8b b7 2c 78 30 a7  |...p.u.&\...,x0.|
+00000020  65 1a 0c f7 1a e5 51 91  7c cb ca 20 83 2c 90 3b  |e.....Q.|.. .,.;|
+00000030  cf dd 4e 51 8b 27 98 95  aa d9 1d da 4d 3d e1 18  |..NQ.'......M=..|
+00000040  f5 58 fd 85 c5 ed c9 5f  12 2f 4b b3 00 05 00 00  |.X....._./K.....|
 00000050  05 ff 01 00 01 00 16 03  01 02 59 0b 00 02 55 00  |..........Y...U.|
 00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -64,15 +64,15 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 01 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 01 00 24 88 be  a9 b7 ed 3f 07 86 ec 30  |.....$.....?...0|
-000000a0  67 0c 26 37 3f dc 9b 79  10 13 9a bb 35 e4 a9 0f  |g.&7?..y....5...|
-000000b0  9c 45 47 38 48 10 1b a8  30 7b                    |.EG8H...0{|
+00000090  01 16 03 01 00 24 0e 4d  ff 2c 39 80 ba a5 96 18  |.....$.M.,9.....|
+000000a0  56 15 94 9f e2 1e 7d 13  62 51 d5 e1 05 f8 d8 b3  |V.....}.bQ......|
+000000b0  bd 77 58 38 95 b4 7d 37  66 8a                    |.wX8..}7f.|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 24 70 ec d0 14 62  |..........$p...b|
-00000010  2f a5 fb 33 c7 0d 26 63  9f 46 78 63 a3 9a e3 88  |/..3..&c.Fxc....|
-00000020  9c ce d0 4f 99 d5 eb b0  5a 2f 68 84 44 7a de     |...O....Z/h.Dz.|
+00000000  14 03 01 00 01 01 16 03  01 00 24 dc 6f da 57 0d  |..........$.o.W.|
+00000010  f8 b8 aa d5 e5 0a 2e 81  ed 2a b7 f8 0e 2a f1 05  |.........*...*..|
+00000020  76 8d 4f b0 0e db 16 c5  d7 c8 5e f9 fb 9e e0     |v.O.......^....|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 1a dd 13 a6  7b 27 eb e7 9d fe 4a 3a  |........{'....J:|
-00000010  e5 f7 80 4a 24 d6 53 74  94 91 06 4f 1e d7 8d 15  |...J$.St...O....|
-00000020  03 01 00 16 ca c6 19 10  63 5d a6 40 d2 c2 f9 8e  |........c].@....|
-00000030  f6 e9 16 2c c6 d3 7d 07  63 33                    |...,..}.c3|
+00000000  17 03 01 00 1a 47 97 4d  e6 59 d4 2f bb 60 56 69  |.....G.M.Y./.`Vi|
+00000010  d8 bc 8d 91 44 7c cd 85  7e c5 18 5f 57 8e 08 15  |....D|..~.._W...|
+00000020  03 01 00 16 f7 79 56 72  e6 77 8d af 94 55 d7 0e  |.....yVr.w...U..|
+00000030  96 c8 3b 35 52 ea f7 e7  b8 d6                    |..;5R.....|
diff --git a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES
index 5dda2335cc..5232ad57df 100644
--- a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 02 00 59 02 00 00  55 03 02 a7 3e a2 92 d9  |....Y...U...>...|
-00000010  36 4c 15 c8 71 41 b5 f1  05 ad f8 23 e5 85 d6 ca  |6L..qA.....#....|
-00000020  8d e8 c7 e6 f1 82 32 a8  0b 9f 60 20 90 89 d0 ea  |......2...` ....|
-00000030  a5 15 50 f0 56 6d e7 94  5a 2b 42 3c 8f b8 f9 42  |..P.Vm..Z+B<...B|
-00000040  1a 7c ee 4e b4 1e 0c 9a  83 7f 69 87 c0 09 00 00  |.|.N......i.....|
+00000000  16 03 02 00 59 02 00 00  55 03 02 30 f8 f6 b2 af  |....Y...U..0....|
+00000010  99 b0 e0 f6 9a eb 47 6f  2f ad 2f 45 18 56 b3 dd  |......Go/./E.V..|
+00000020  b6 b9 20 fb af 97 43 1f  0e 51 c0 20 fe 6c 12 64  |.. ...C..Q. .l.d|
+00000030  8e cc a4 24 d6 e6 80 cf  f2 9e 74 3f a7 1e 8b da  |...$......t?....|
+00000040  0e 3c 58 74 f4 8f be 1f  60 86 57 c6 c0 09 00 00  |.<Xt....`.W.....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  02 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -49,39 +49,39 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 02 00 b4 0c 00  00 b0 03 00 1d 20 1d 37  |*............ .7|
-00000280  90 ee f8 eb a1 2b 65 dc  a4 97 04 48 c6 0d 64 2b  |.....+e....H..d+|
-00000290  97 a9 c6 50 c7 b5 a8 06  4c 74 9e 7f f4 45 00 8a  |...P....Lt...E..|
-000002a0  30 81 87 02 41 4d 99 60  cb 80 0d 97 ea a8 57 cb  |0...AM.`......W.|
-000002b0  bb 5c c2 ad 14 60 80 3b  d9 e3 7a 93 bf 51 c0 45  |.\...`.;..z..Q.E|
-000002c0  98 65 e7 d8 c7 a0 36 8b  e2 ae 5f 84 cc 1a 1d 8b  |.e....6..._.....|
-000002d0  d3 a6 da 4d 53 0a ac aa  5d 69 7c 9c 0f c1 c8 0b  |...MS...]i|.....|
-000002e0  4f d6 c3 ba de 51 02 42  00 ab c8 7b c7 97 98 7c  |O....Q.B...{...||
-000002f0  84 39 55 7d f1 63 00 bf  9f 46 d1 6f 9a 69 0c cb  |.9U}.c...F.o.i..|
-00000300  bb db 53 bb 80 8e 80 8b  48 63 9f 0f 24 a3 dc 50  |..S.....Hc..$..P|
-00000310  d3 f9 52 0c 0a d9 3b 45  49 56 c8 38 97 70 ce 7f  |..R...;EIV.8.p..|
-00000320  83 c9 76 b6 ef cd b5 80  17 7b 16 03 02 00 04 0e  |..v......{......|
-00000330  00 00 00                                          |...|
+00000270  2a 16 03 02 00 b3 0c 00  00 af 03 00 1d 20 4b 2d  |*............ K-|
+00000280  60 48 54 b4 48 42 10 de  e1 98 f0 fb 73 d9 49 16  |`HT.HB......s.I.|
+00000290  3e a2 11 b3 84 50 de 26  00 09 d8 36 34 04 00 89  |>....P.&...64...|
+000002a0  30 81 86 02 41 24 90 6f  3e 1a 2c a5 7f 08 dc b2  |0...A$.o>.,.....|
+000002b0  d3 46 27 5e cb 1f 2a 6d  92 ba 1b fe e3 c5 64 79  |.F'^..*m......dy|
+000002c0  31 50 8c 43 4b b1 ee 0d  6f 53 ad 6f e9 db 86 e7  |1P.CK...oS.o....|
+000002d0  1f e3 77 f1 8d a8 ab 81  2a d6 fa e7 98 d5 bc 0d  |..w.....*.......|
+000002e0  ec af ea 84 c4 f8 02 41  6a d2 66 32 e1 d7 46 1a  |.......Aj.f2..F.|
+000002f0  95 5a 91 c3 76 82 20 c2  a3 a2 32 f5 fd eb a2 0e  |.Z..v. ...2.....|
+00000300  0f d8 a9 31 7a ef a8 05  6c 5d bf 27 d0 2d 94 ca  |...1z...l].'.-..|
+00000310  fb d6 62 7a 1c 6a 46 20  fe ed a6 60 a3 db b1 bd  |..bz.jF ...`....|
+00000320  11 82 05 c3 db 0c 4a 2d  6c 16 03 02 00 04 0e 00  |......J-l.......|
+00000330  00 00                                             |..|
 >>> Flow 3 (client to server)
 00000000  16 03 02 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 02 00 01 01  |....._X.;t......|
 00000030  16 03 02 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000040  00 00 00 00 00 a2 0b a0  d7 8a 85 1b 42 24 ff 1e  |............B$..|
-00000050  ea f6 a4 f6 40 94 f7 08  3b 12 4d f9 05 af fa 58  |....@...;.M....X|
-00000060  9d 46 5b 6c fe de b8 da  b0 4e 05 b1 ce 87 6a 35  |.F[l.....N....j5|
-00000070  bf 81 cb e6 90                                    |.....|
+00000040  00 00 00 00 00 22 71 28  3d 07 73 61 5e 84 72 36  |....."q(=.sa^.r6|
+00000050  c0 87 37 4a 5b c2 d9 40  96 a2 01 20 b2 04 23 2f  |..7J[..@... ..#/|
+00000060  c1 6f 1e 7c a1 77 20 0f  87 46 98 a2 5c aa 35 37  |.o.|.w ..F..\.57|
+00000070  37 87 5a 75 33                                    |7.Zu3|
 >>> Flow 4 (server to client)
-00000000  14 03 02 00 01 01 16 03  02 00 40 13 43 c7 e3 2d  |..........@.C..-|
-00000010  85 78 cd 81 14 ff 31 15  d9 42 c2 b1 b2 d2 54 37  |.x....1..B....T7|
-00000020  81 9a 2a e3 40 44 13 18  ed bd 4d fd 8e 81 fd 52  |..*.@D....M....R|
-00000030  23 bb ee 2e f6 d3 e4 b4  2b 54 e0 eb 11 90 fb 15  |#.......+T......|
-00000040  61 a6 db ea 7d 0b 67 96  ac de cc                 |a...}.g....|
+00000000  14 03 02 00 01 01 16 03  02 00 40 21 b5 1f 8d 4b  |..........@!...K|
+00000010  1c a7 28 4e 73 3e d7 c5  75 6e eb e4 b3 95 02 4e  |..(Ns>..un.....N|
+00000020  a3 47 03 44 97 69 c9 89  f5 ac e2 29 5e 22 e7 2c  |.G.D.i.....)^".,|
+00000030  a2 2d e3 ac 64 45 ae 9d  07 9e fe f8 c6 85 47 4d  |.-..dE........GM|
+00000040  59 be 72 8d e6 50 da c7  83 91 14                 |Y.r..P.....|
 >>> Flow 5 (client to server)
 00000000  17 03 02 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 55 2c 91  b9 62 d3 39 e0 76 fd 21  |.....U,..b.9.v.!|
-00000020  5a 61 68 2c d3 01 0e 40  df d8 2f 4b 06 ed 83 bd  |Zah,...@../K....|
-00000030  4f 68 00 d2 93 15 03 02  00 30 00 00 00 00 00 00  |Oh.......0......|
-00000040  00 00 00 00 00 00 00 00  00 00 a5 ba 0b eb 8b 86  |................|
-00000050  55 11 70 3e c3 bf 2b 36  bb 21 9c 51 ee e7 54 89  |U.p>..+6.!.Q..T.|
-00000060  50 94 54 23 85 91 d2 c7  e4 20                    |P.T#..... |
+00000010  00 00 00 00 00 57 45 25  4c 1b 90 d3 28 e1 69 43  |.....WE%L...(.iC|
+00000020  c5 28 d9 d5 15 35 cf 41  bb 38 f2 12 c6 18 a5 a2  |.(...5.A.8......|
+00000030  f5 e4 64 1d 59 15 03 02  00 30 00 00 00 00 00 00  |..d.Y....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 35 06 5f e3 ff e7  |..........5._...|
+00000050  f0 f1 0c d5 b1 59 42 80  19 8d 67 1b 18 18 5c 18  |.....YB...g...\.|
+00000060  42 38 67 85 c3 ab e2 dc  60 d4                    |B8g.....`.|
diff --git a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES
index 2dd5d2c73d..48ff7bce32 100644
--- a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 02 00 59 02 00 00  55 03 02 74 de 20 08 26  |....Y...U..t. .&|
-00000010  5d 65 19 a0 72 a2 44 44  b1 f6 78 1f 6e f4 d9 cb  |]e..r.DD..x.n...|
-00000020  2c 37 c1 89 a3 60 57 36  15 37 da 20 c5 e3 68 84  |,7...`W6.7. ..h.|
-00000030  71 08 ec 9b 2e 50 36 88  15 5e 8a b8 4d 01 de 99  |q....P6..^..M...|
-00000040  c3 20 5a 53 d6 c4 6c 08  dc d7 d6 b0 c0 13 00 00  |. ZS..l.........|
+00000000  16 03 02 00 59 02 00 00  55 03 02 10 ca d9 1b 83  |....Y...U.......|
+00000010  59 c8 a5 a5 6a 89 65 6e  1c 0a 49 98 69 05 49 27  |Y...j.en..I.i.I'|
+00000020  96 72 74 5f 6e 5b 66 26  3b fd f8 20 23 b5 d6 c5  |.rt_n[f&;.. #...|
+00000030  09 f1 66 02 27 5c 5a 15  17 83 c5 11 a4 32 cf d8  |..f.'\Z......2..|
+00000040  1e a0 e7 93 83 35 6e aa  61 ae 97 77 c0 13 00 00  |.....5n.a..w....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  02 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -54,38 +54,38 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 02 00  |.=.`.\!.;.......|
-000002c0  aa 0c 00 00 a6 03 00 1d  20 4f f4 9c cd f7 d4 5f  |........ O....._|
-000002d0  50 18 a3 99 05 c4 f8 87  27 dd fd 29 ee e3 df e8  |P.......'..)....|
-000002e0  02 7b 0c ee 35 b2 34 57  35 00 80 83 0a a7 f8 0b  |.{..5.4W5.......|
-000002f0  ab 54 e3 37 5e 75 db 34  fa 66 72 59 3d fe dc fd  |.T.7^u.4.frY=...|
-00000300  2c e3 50 7a 5f 31 c3 3f  41 80 34 c6 3f 32 3f 83  |,.Pz_1.?A.4.?2?.|
-00000310  f6 eb 30 46 e2 86 45 98  33 08 c7 a4 6f 46 30 f9  |..0F..E.3...oF0.|
-00000320  74 ca ab 16 84 f7 75 d9  2f 09 9e b7 b5 a9 a5 ec  |t.....u./.......|
-00000330  63 d2 b1 e8 d1 1e 0b 99  d9 c2 3e 75 80 8d 5a 67  |c.........>u..Zg|
-00000340  ee cd ee b8 03 cb 48 14  43 5e 78 0b 36 cd b3 6d  |......H.C^x.6..m|
-00000350  56 29 b6 c9 cb fc 1f 6a  d9 cc 50 ec 85 ac db ef  |V).....j..P.....|
-00000360  34 cd 14 6b 2f d4 81 51  0b 5a 93 16 03 02 00 04  |4..k/..Q.Z......|
+000002c0  aa 0c 00 00 a6 03 00 1d  20 97 a4 91 6b cd ca 44  |........ ...k..D|
+000002d0  7e ac fd a5 b1 c0 ce 88  07 f3 a2 d9 93 2b a8 d9  |~............+..|
+000002e0  0b 65 0b 47 c0 2e 4f 3b  26 00 80 00 18 01 a1 29  |.e.G..O;&......)|
+000002f0  0b 84 c9 09 5e 8c 58 5f  62 b6 22 8b 94 6e 72 26  |....^.X_b."..nr&|
+00000300  44 27 32 b9 22 12 67 58  34 a1 ce 6f 87 19 a0 5c  |D'2.".gX4..o...\|
+00000310  5d 58 dc 91 fb c7 e6 31  33 76 6d 1f 8e 4f 46 55  |]X.....13vm..OFU|
+00000320  f1 08 57 9b bb fe 8d c7  6c 0b cd 8b ad b7 51 28  |..W.....l.....Q(|
+00000330  f8 5b 75 97 fe a0 d4 a1  2e 9a d3 d5 45 62 f8 19  |.[u.........Eb..|
+00000340  f6 73 d0 f6 6d e8 43 49  a2 f5 71 66 c5 29 1a 99  |.s..m.CI..qf.)..|
+00000350  e6 c0 cc f9 a5 cd a5 b7  58 08 4d cc 17 46 91 4c  |........X.M..F.L|
+00000360  29 99 b4 05 78 af e7 b0  d1 2d 38 16 03 02 00 04  |)...x....-8.....|
 00000370  0e 00 00 00                                       |....|
 >>> Flow 3 (client to server)
 00000000  16 03 02 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 02 00 01 01  |....._X.;t......|
 00000030  16 03 02 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000040  00 00 00 00 00 7c 90 f4  5b 3d 6b 48 fe 58 f4 55  |.....|..[=kH.X.U|
-00000050  b2 f0 9a 62 c3 08 b6 a6  b5 df c8 7d 99 32 6b 99  |...b.......}.2k.|
-00000060  fb fb 51 54 19 10 77 b2  c8 59 fa ee f7 e7 90 19  |..QT..w..Y......|
-00000070  ed e4 04 3a 6b                                    |...:k|
+00000040  00 00 00 00 00 f2 fb 8f  ab ae 46 f2 6a 18 1b 77  |..........F.j..w|
+00000050  f3 ce 0c b6 83 9c d6 34  54 82 76 db 5c 79 5d cf  |.......4T.v.\y].|
+00000060  24 f3 26 6d 9d f0 af d3  fc e0 96 69 0a 04 f7 ba  |$.&m.......i....|
+00000070  78 54 af 37 a5                                    |xT.7.|
 >>> Flow 4 (server to client)
-00000000  14 03 02 00 01 01 16 03  02 00 40 a2 a4 67 d8 51  |..........@..g.Q|
-00000010  c7 44 1d 74 49 22 fe d4  56 f4 19 e4 52 57 3a 8c  |.D.tI"..V...RW:.|
-00000020  ad fc 3f ce 30 9d f5 cb  cc 79 cb d6 63 60 74 33  |..?.0....y..c`t3|
-00000030  86 6a ba dd e4 2f 42 03  16 85 f2 f5 93 0d 5e 00  |.j.../B.......^.|
-00000040  89 fa b8 5e 22 8c 44 78  cd 70 69                 |...^".Dx.pi|
+00000000  14 03 02 00 01 01 16 03  02 00 40 e7 d9 0e af 0c  |..........@.....|
+00000010  06 55 85 ab b0 0a 5e d9  11 81 7a 53 c0 f6 3f 84  |.U....^...zS..?.|
+00000020  06 7d 9c 20 05 e9 0d 1d  df 9b 48 11 d9 df 0c e6  |.}. ......H.....|
+00000030  6b c2 a8 8f f4 d9 e8 8e  f6 1a 3e db 7c e5 97 ac  |k.........>.|...|
+00000040  5d 63 08 b2 3a 54 91 62  fc 2e a5                 |]c..:T.b...|
 >>> Flow 5 (client to server)
 00000000  17 03 02 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 77 f6 75  ad 54 68 a4 ab 34 c1 42  |.....w.u.Th..4.B|
-00000020  48 b8 f8 f4 67 e9 61 0f  80 6e f9 f8 de 10 5d 28  |H...g.a..n....](|
-00000030  d1 8f f6 e6 91 15 03 02  00 30 00 00 00 00 00 00  |.........0......|
-00000040  00 00 00 00 00 00 00 00  00 00 28 df 02 7c 5a 06  |..........(..|Z.|
-00000050  f3 97 4f d7 4e 2e df bd  5e 8f df ac 24 b2 06 03  |..O.N...^...$...|
-00000060  9d 2e da a7 ba e0 27 f8  f9 79                    |......'..y|
+00000010  00 00 00 00 00 3f ef e9  bc 10 07 75 99 67 8f 99  |.....?.....u.g..|
+00000020  bb c0 15 94 86 a2 80 cc  15 97 54 f8 4e 1a d1 9a  |..........T.N...|
+00000030  33 80 aa da ec 15 03 02  00 30 00 00 00 00 00 00  |3........0......|
+00000040  00 00 00 00 00 00 00 00  00 00 6f 78 7b d2 80 62  |..........ox{..b|
+00000050  5c cf 34 d6 5a 72 d8 63  95 24 c6 ff 69 d0 6d 90  |\.4.Zr.c.$..i.m.|
+00000060  8d a2 9f 37 e8 7b b1 d4  68 04                    |...7.{..h.|
diff --git a/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4 b/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4
index d8a484fb70..2e9c49e27a 100644
--- a/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4
+++ b/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 02 00 51 02 00 00  4d 03 02 84 8a c8 f2 a5  |....Q...M.......|
-00000010  1c cd b7 c5 2a ee df 38  9a 03 31 81 84 5d 0a 11  |....*..8..1..]..|
-00000020  0a 3c b2 08 aa bc 32 ce  7b 90 01 20 4e 24 ed 86  |.<....2.{.. N$..|
-00000030  9f 7a eb 86 1d 75 de 36  6e 0a b3 f5 98 18 b3 8c  |.z...u.6n.......|
-00000040  d7 0f 0d 49 84 43 91 74  4d 02 64 13 00 05 00 00  |...I.C.tM.d.....|
+00000000  16 03 02 00 51 02 00 00  4d 03 02 36 8f 18 79 0f  |....Q...M..6..y.|
+00000010  99 6b 3d 1d f4 19 aa ff  79 7c 50 15 52 db 9d c5  |.k=.....y|P.R...|
+00000020  62 40 2d 5b de 45 0c 66  b1 cb be 20 9e 00 c3 00  |b@-[.E.f... ....|
+00000030  22 2f b5 c6 79 c1 f7 72  8f 4b 94 f4 ac fe a9 53  |"/..y..r.K.....S|
+00000040  97 4e fb 00 df 34 b6 24  8f ff 89 db 00 05 00 00  |.N...4.$........|
 00000050  05 ff 01 00 01 00 16 03  02 02 59 0b 00 02 55 00  |..........Y...U.|
 00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -64,15 +64,15 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 02 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 02 00 24 a1 e6  c7 78 c4 07 3c cb f7 81  |.....$...x..<...|
-000000a0  54 c8 32 76 29 24 31 a9  02 bc 19 a9 16 8e cf 9f  |T.2v)$1.........|
-000000b0  73 25 95 92 8a 80 97 35  e5 49                    |s%.....5.I|
+00000090  01 16 03 02 00 24 92 fa  9a bb 9b a3 39 3f 6b 0c  |.....$......9?k.|
+000000a0  70 b5 48 4a fc cf 79 86  c7 90 e8 db ca 6a ff 95  |p.HJ..y......j..|
+000000b0  11 9b 65 b2 07 61 00 a8  dc 14                    |..e..a....|
 >>> Flow 4 (server to client)
-00000000  14 03 02 00 01 01 16 03  02 00 24 73 e4 77 fd 6d  |..........$s.w.m|
-00000010  87 a8 3e 3a 05 d2 ba c1  fd 23 df 89 d4 a5 61 3a  |..>:.....#....a:|
-00000020  53 05 c0 54 9b df 5b d7  08 2f a2 6d d4 3f c2     |S..T..[../.m.?.|
+00000000  14 03 02 00 01 01 16 03  02 00 24 47 d5 78 31 32  |..........$G.x12|
+00000010  db db 2b f4 2f e6 a4 fa  fa 04 31 ba c0 bc 86 38  |..+./.....1....8|
+00000020  29 70 53 c6 8c 28 e5 75  90 ed 0f 4f 3e cb 06     |)pS..(.u...O>..|
 >>> Flow 5 (client to server)
-00000000  17 03 02 00 1a 2c 3e d4  b4 c3 61 d2 26 20 16 25  |.....,>...a.& .%|
-00000010  cc b3 e8 b4 aa 90 11 75  da 7f a1 bf a9 58 21 15  |.......u.....X!.|
-00000020  03 02 00 16 0e d5 9e ec  b5 7e 83 1a 5b f1 5a 7b  |.........~..[.Z{|
-00000030  ad ee 18 10 0e e1 ec 61  72 c9                    |.......ar.|
+00000000  17 03 02 00 1a f3 e7 6c  01 c5 70 c6 69 dd 4f 40  |.......l..p.i.O@|
+00000010  38 c1 b2 d2 28 69 2f 99  b1 bd 71 d0 c2 00 08 15  |8...(i/...q.....|
+00000020  03 02 00 16 4c 44 14 02  8e 46 f8 84 40 f1 3d 6d  |....LD...F..@.=m|
+00000030  f2 01 f6 9d 7a 0b 18 ee  9d 41                    |....z....A|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256
index c073badc11..c20dcc658f 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 51 02 00 00  4d 03 03 7a 32 08 d2 4a  |....Q...M..z2..J|
-00000010  af 6c 9f c8 46 15 1c 46  60 43 4c c9 6a 6c 43 12  |.l..F..F`CL.jlC.|
-00000020  c0 d8 56 97 b5 01 c2 96  9f d9 28 20 48 7e b0 97  |..V.......( H~..|
-00000030  10 ef a4 1b a7 f1 0e 15  f5 95 53 72 35 14 ed c9  |..........Sr5...|
-00000040  50 e2 1a 9f 7c c5 d2 f3  1e dd f8 4e 00 9c 00 00  |P...|......N....|
+00000000  16 03 03 00 51 02 00 00  4d 03 03 65 9c b1 7a 5c  |....Q...M..e..z\|
+00000010  84 e5 a5 12 ba 54 1f 4c  ec 95 0b 8f ea 5c cc 3b  |.....T.L.....\.;|
+00000020  de b8 18 23 8e c4 95 59  d7 7f 8f 20 36 fe ec 27  |...#...Y... 6..'|
+00000030  10 85 43 fb 9c 68 3f 69  d0 08 a6 57 10 a6 29 a4  |..C..h?i...W..).|
+00000040  f6 0c 2e 05 6e 0d e5 44  61 e1 2e 07 00 9c 00 00  |....n..Da.......|
 00000050  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
 00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -64,17 +64,17 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 0d fe  |.....(..........|
-000000a0  d9 28 21 4a bd 29 c8 a6  4c 37 b4 bd 32 35 c6 21  |.(!J.)..L7..25.!|
-000000b0  d5 29 3c c6 d3 18 d3 3e  38 0b 9e 51 1e c5        |.)<....>8..Q..|
+00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 97 f1  |.....(..........|
+000000a0  fe 34 f7 de 76 9b 56 27  e6 9f 36 48 30 a6 de 78  |.4..v.V'..6H0..x|
+000000b0  10 6a ef bf 92 8a 6e 99  21 2f 1b 7b 48 80        |.j....n.!/.{H.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 da f5 83 53 c6  |..........(...S.|
-00000010  97 4c c2 33 83 04 7d 35  c5 48 61 86 06 37 2e e8  |.L.3..}5.Ha..7..|
-00000020  18 4d de 6a 32 13 95 77  ac 03 3e 64 4f e0 fb 99  |.M.j2..w..>dO...|
-00000030  4c 6b 3d                                          |Lk=|
+00000000  14 03 03 00 01 01 16 03  03 00 28 23 9d a2 ae a1  |..........(#....|
+00000010  7d dd 92 1f 42 18 68 f6  fb 31 56 7b e4 58 a4 e9  |}...B.h..1V{.X..|
+00000020  c2 1c e7 67 1b 40 b1 b9  63 9d 05 fb c7 44 9e f6  |...g.@..c....D..|
+00000030  7a 14 bb                                          |z..|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 8e a9 14  |................|
-00000010  42 04 b1 b8 63 0d f1 4b  e9 5c 3c 54 7e 28 14 31  |B...c..K.\<T~(.1|
-00000020  a6 2e 90 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
-00000030  ff e2 9e a8 be 31 0b f6  87 a6 11 39 5f b9 71 ff  |.....1.....9_.q.|
-00000040  90 83                                             |..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 d7 31 70  |..............1p|
+00000010  c8 11 3f bd 83 fc 6e f8  3b e0 ee 45 c5 1a c8 41  |..?...n.;..E...A|
+00000020  80 22 d4 15 03 03 00 1a  00 00 00 00 00 00 00 02  |."..............|
+00000030  7a fe 3a 11 7c c0 26 30  55 24 85 0b 43 cb 7c ac  |z.:.|.&0U$..C.|.|
+00000040  ef 2c                                             |.,|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-AES128-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-AES128-SHA256
index ded7c7bd8d..774481e84a 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-AES128-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv12-AES128-SHA256
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 51 02 00 00  4d 03 03 8c 19 dc bf e8  |....Q...M.......|
-00000010  10 70 a2 51 1e d0 bd a8  c5 11 aa b7 e0 dd 29 f8  |.p.Q..........).|
-00000020  ab ad 4c e9 62 2f b5 54  5f 66 12 20 a4 90 11 92  |..L.b/.T_f. ....|
-00000030  c9 cc 4c 8e f4 e9 bf 32  da 7f 67 3b 40 7c b3 86  |..L....2..g;@|..|
-00000040  18 c6 23 d0 1c e1 f6 de  5c 0b ef aa 00 3c 00 00  |..#.....\....<..|
+00000000  16 03 03 00 51 02 00 00  4d 03 03 26 31 ba 4a 56  |....Q...M..&1.JV|
+00000010  16 83 15 47 b9 c4 7e 10  ca 92 31 4d 77 af cc cd  |...G..~...1Mw...|
+00000020  70 f4 cc 82 6e b9 ac 1b  0d 17 25 20 e9 08 ec 95  |p...n.....% ....|
+00000030  ea 84 a4 bd 8f 9d 8e d3  58 a7 5e 72 42 e4 19 8f  |........X.^rB...|
+00000040  46 c3 d9 be 16 3c d4 53  5a 02 8f a1 00 3c 00 00  |F....<.SZ....<..|
 00000050  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
 00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -65,25 +65,25 @@
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
 00000090  01 16 03 03 00 50 00 00  00 00 00 00 00 00 00 00  |.....P..........|
-000000a0  00 00 00 00 00 00 c9 1b  bf 6d f6 95 cc cf 9d 3b  |.........m.....;|
-000000b0  15 6a da 27 dc b9 d3 b2  98 9e 9f f4 fc 85 c8 cd  |.j.'............|
-000000c0  6a f6 6d 20 cf bf 0f 87  c9 b2 9e 16 12 69 1d f8  |j.m .........i..|
-000000d0  f2 52 12 23 58 a5 23 45  d0 3c f9 98 b5 1e 02 d0  |.R.#X.#E.<......|
-000000e0  d6 a1 7f bf 67 ed                                 |....g.|
+000000a0  00 00 00 00 00 00 46 91  40 e2 65 40 fe 42 c3 34  |......F.@.e@.B.4|
+000000b0  98 65 89 d0 96 7e 7b 67  8e c4 d5 e6 37 f5 96 04  |.e...~{g....7...|
+000000c0  b7 c8 63 83 76 5c ca 9d  89 18 d4 97 8b 3f f6 75  |..c.v\.......?.u|
+000000d0  1d 51 0b b9 90 1c 85 8f  83 20 9e 9a 21 d9 db 14  |.Q....... ..!...|
+000000e0  1e 02 d4 ab aa c4                                 |......|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 50 b5 19 8a 2a a2  |..........P...*.|
-00000010  33 73 ff 3f 94 c6 a6 16  b5 a0 5f 64 33 11 77 90  |3s.?......_d3.w.|
-00000020  26 96 97 32 1d b2 aa c5  7d 86 78 db 98 b4 d7 65  |&..2....}.x....e|
-00000030  e9 4b 11 42 1b c5 6f 28  fe 1c 9e 0f 35 9f 6f 76  |.K.B..o(....5.ov|
-00000040  e5 f6 f8 6e c0 6f 93 a6  ff 49 e0 46 65 8f 8b 8f  |...n.o...I.Fe...|
-00000050  c5 6f 69 5b 67 2f c1 ab  61 e1 8c                 |.oi[g/..a..|
+00000000  14 03 03 00 01 01 16 03  03 00 50 6d 34 72 de 79  |..........Pm4r.y|
+00000010  ad 96 d0 92 5f d7 01 de  90 f4 5d 0f de 02 ae 19  |...._.....].....|
+00000020  61 a3 ee 29 ab 18 f1 09  2e 5b bc e0 73 9a 68 19  |a..).....[..s.h.|
+00000030  17 dd c8 d9 63 b4 28 c8  da 1a 81 40 ca d3 5a 99  |....c.(....@..Z.|
+00000040  17 67 fe e9 dd 1a 52 c4  6e 70 0a 0e cf e8 c0 f8  |.g....R.np......|
+00000050  6c 1f ee d2 70 97 dc ee  b8 95 35                 |l...p.....5|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000010  00 00 00 00 00 88 f5 2a  f7 2d 8b d8 e0 8e e2 8f  |.......*.-......|
-00000020  38 20 33 46 45 0c 75 cc  d0 08 b0 e6 b8 dc 6f 6a  |8 3FE.u.......oj|
-00000030  7b 57 0d 27 a5 e3 82 ee  e7 e3 24 79 0c a9 4a 7c  |{W.'......$y..J||
-00000040  65 45 a8 04 3b 15 03 03  00 40 00 00 00 00 00 00  |eE..;....@......|
-00000050  00 00 00 00 00 00 00 00  00 00 43 52 7c 12 59 f5  |..........CR|.Y.|
-00000060  ec 15 56 f9 ff 9e 8b c7  3d 99 06 a3 5a 98 1d 4e  |..V.....=...Z..N|
-00000070  0f 34 bc 90 3e 61 64 cc  64 f4 23 8d e0 d5 cc 8a  |.4..>ad.d.#.....|
-00000080  9b 43 c2 2e 93 ed eb 91  3f 02                    |.C......?.|
+00000010  00 00 00 00 00 ee 03 cc  04 97 17 f0 04 85 02 b7  |................|
+00000020  5c 24 ca 9f c2 25 e0 76  f4 72 e5 71 2b ac f4 a5  |\$...%.v.r.q+...|
+00000030  c4 62 08 9a da b7 ab 30  2f 34 b0 70 20 a3 b9 b3  |.b.....0/4.p ...|
+00000040  df 90 9b 01 0b 15 03 03  00 40 00 00 00 00 00 00  |.........@......|
+00000050  00 00 00 00 00 00 00 00  00 00 3b ca fc 0e 08 f2  |..........;.....|
+00000060  c8 b7 22 61 43 24 b3 54  1b ca 58 c6 bd 27 f3 3d  |.."aC$.T..X..'.=|
+00000070  ac a0 d8 fe 0e b5 15 7c  1f 98 32 f0 6b 28 bc 61  |.......|..2.k(.a|
+00000080  6c c7 ba 66 54 19 92 a9  6f 43                    |l..fT...oC|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384 b/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384
index 794f0955ea..6d2674639a 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384
+++ b/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 51 02 00 00  4d 03 03 b4 42 95 ec 29  |....Q...M...B..)|
-00000010  a8 f3 4b db 10 02 3d fb  31 89 39 88 6d 13 44 ad  |..K...=.1.9.m.D.|
-00000020  bc e9 0b 66 de c2 48 b2  da 96 ba 20 04 63 b1 f5  |...f..H.... .c..|
-00000030  26 20 3a 2a ee 15 35 ad  c7 98 52 c1 bd d4 bf 7c  |& :*..5...R....||
-00000040  8e cd 9c d8 81 ee b2 60  93 e4 b0 f1 00 9d 00 00  |.......`........|
+00000000  16 03 03 00 51 02 00 00  4d 03 03 98 b0 4a 9a c8  |....Q...M....J..|
+00000010  8f f9 1f f9 70 03 d9 1a  ee 7c 29 30 6a 71 7c 6c  |....p....|)0jq|l|
+00000020  ea 2c de 84 f9 ee 4d 2c  d7 58 12 20 a4 e2 1b f3  |.,....M,.X. ....|
+00000030  42 b8 9a 0b 71 8c 27 57  61 98 c5 c5 1b 04 01 5b  |B...q.'Wa......[|
+00000040  a0 bc 88 64 d9 ce 5a a1  b2 7b 6c 4e 00 9d 00 00  |...d..Z..{lN....|
 00000050  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
 00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -64,17 +64,17 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 c7 5c  |.....(.........\|
-000000a0  ab a3 37 82 62 49 d3 df  82 9a 8f 14 4e 93 99 94  |..7.bI......N...|
-000000b0  b8 47 7b 52 f4 2c 47 4a  ce ef 97 30 92 51        |.G{R.,GJ...0.Q|
+00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 57 97  |.....(........W.|
+000000a0  64 ef 80 07 b0 31 02 c8  2a a2 b7 1f d6 a3 7c 7a  |d....1..*.....|z|
+000000b0  e9 c4 e1 55 9f 0a ef 0d  8f 0a 57 13 f5 a4        |...U......W...|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 10 d5 f7 84 5b  |..........(....[|
-00000010  55 20 9e ce c3 9e 8c 61  9f 1f 0e 25 df 8f b2 b8  |U .....a...%....|
-00000020  b3 ec 3d 39 43 d2 6c ac  2c 68 84 b8 85 df a8 ee  |..=9C.l.,h......|
-00000030  27 32 7d                                          |'2}|
+00000000  14 03 03 00 01 01 16 03  03 00 28 42 49 9c 67 4f  |..........(BI.gO|
+00000010  36 75 b8 34 0e ee 00 98  1a ba 52 d5 96 7b 91 d7  |6u.4......R..{..|
+00000020  ba ec e4 5e 2e 42 e3 72  a0 ea 60 24 31 30 3d a2  |...^.B.r..`$10=.|
+00000030  c5 6c 8f                                          |.l.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 20 19 28  |............. .(|
-00000010  34 11 61 7d 8e 25 9c 35  57 98 3c 6c 47 45 7d ab  |4.a}.%.5W.<lGE}.|
-00000020  7f 92 8a 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
-00000030  ae 7d 0c 55 c0 8c dc 9c  55 aa f5 6c 6c 7a d3 f9  |.}.U....U..llz..|
-00000040  68 ac                                             |h.|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 42 9f da  |.............B..|
+00000010  a1 e6 98 48 a8 6c 78 a0  f7 fd e7 0f bc df 97 ef  |...H.lx.........|
+00000020  b8 62 4c 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.bL.............|
+00000030  99 ac 35 a4 d9 1f 58 26  51 c6 6a b9 1f 53 ec 19  |..5...X&Q.j..S..|
+00000040  90 78                                             |.x|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ALPN b/src/crypto/tls/testdata/Client-TLSv12-ALPN
index 16c8dae440..9f90ff269a 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ALPN
+++ b/src/crypto/tls/testdata/Client-TLSv12-ALPN
@@ -1,21 +1,21 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 a5 01 00 00  a1 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 a9 01 00 00  a5 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 50 33 74 00 00 00 05  |.........P3t....|
-00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
-00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
-00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
-00000090  01 00 00 10 00 10 00 0e  06 70 72 6f 74 6f 32 06  |.........proto2.|
-000000a0  70 72 6f 74 6f 31 00 12  00 00                    |proto1....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 50 33 74  |.............P3t|
+00000060  00 00 00 05 00 05 01 00  00 00 00 00 0a 00 0a 00  |................|
+00000070  08 00 1d 00 17 00 18 00  19 00 0b 00 02 01 00 00  |................|
+00000080  0d 00 0e 00 0c 04 01 04  03 05 01 05 03 02 01 02  |................|
+00000090  03 ff 01 00 01 00 00 10  00 10 00 0e 06 70 72 6f  |.............pro|
+000000a0  74 6f 32 06 70 72 6f 74  6f 31 00 12 00 00        |to2.proto1....|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 66 02 00 00  62 03 03 ec fd fc 73 30  |....f...b.....s0|
-00000010  c2 72 d9 b3 1a 41 65 1c  59 8e c9 92 c5 00 3c 2d  |.r...Ae.Y.....<-|
-00000020  34 ba 48 74 0a c5 fa be  81 41 b7 20 9a b9 f5 01  |4.Ht.....A. ....|
-00000030  7b 21 77 0f a7 a4 51 d6  8d 11 17 19 ec 6a 52 ce  |{!w...Q......jR.|
-00000040  50 6e 95 fc 2e 8f 09 53  e5 ca 62 e8 c0 2f 00 00  |Pn.....S..b../..|
+00000000  16 03 03 00 66 02 00 00  62 03 03 8d 70 c6 03 ad  |....f...b...p...|
+00000010  2f 20 b3 c2 ab e0 fc 80  74 c4 23 9e 82 65 61 a1  |/ ......t.#..ea.|
+00000020  26 97 14 a0 9b 9c d5 e0  92 43 ee 20 ec 84 cf 78  |&........C. ...x|
+00000030  44 16 7d f3 ad 94 a9 f8  c3 e0 c6 e1 b6 c5 e3 3d  |D.}............=|
+00000040  77 ea 76 1d 58 cc 94 3a  ad 1a 1a 6c cc a8 00 00  |w.v.X..:...l....|
 00000050  1a ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 10  |................|
 00000060  00 09 00 07 06 70 72 6f  74 6f 31 16 03 03 02 59  |.....proto1....Y|
 00000070  0b 00 02 55 00 02 52 00  02 4f 30 82 02 4b 30 82  |...U..R..O0..K0.|
@@ -56,33 +56,31 @@
 000002a0  1c f1 0f a1 d8 40 83 61  c9 4c 72 2b 9d ae db 46  |.....@.a.Lr+...F|
 000002b0  06 06 4d f4 c1 b3 3e c0  d1 bd 42 d4 db fe 3d 13  |..M...>...B...=.|
 000002c0  60 84 5c 21 d3 3b e9 fa  e7 16 03 03 00 ac 0c 00  |`.\!.;..........|
-000002d0  00 a8 03 00 1d 20 ca b0  0d d6 56 b2 89 4d 97 56  |..... ....V..M.V|
-000002e0  20 1a 0f 23 22 83 41 8d  fb 40 7f e9 df 64 cf 2c  | ..#".A..@...d.,|
-000002f0  84 5c 64 ca 91 33 04 01  00 80 55 f4 c0 61 5a 5a  |.\d..3....U..aZZ|
-00000300  f8 05 d6 7f 43 e9 55 68  d4 e6 5b e3 63 27 f9 90  |....C.Uh..[.c'..|
-00000310  82 40 ee bb 85 ab 64 bd  fa 3f 16 9e 10 c7 b1 a5  |.@....d..?......|
-00000320  10 ef 8e 20 17 f9 fa 5b  8a 59 d2 c3 bb 24 33 6c  |... ...[.Y...$3l|
-00000330  01 ce 39 d2 58 47 6b 7b  0f 06 e2 7b c8 ca f7 6b  |..9.XGk{...{...k|
-00000340  ba e3 47 4c d9 b9 78 4a  19 e4 e7 38 19 9d d2 6d  |..GL..xJ...8...m|
-00000350  b2 74 ff 08 25 7b bd c9  30 f4 ec a6 f2 e0 d9 e9  |.t..%{..0.......|
-00000360  90 20 38 e3 4e 39 7c 30  13 72 63 e8 07 92 50 2e  |. 8.N9|0.rc...P.|
-00000370  f2 62 ee 16 42 c8 9c 44  b0 ab 16 03 03 00 04 0e  |.b..B..D........|
+000002d0  00 a8 03 00 1d 20 84 de  31 92 b6 a5 d8 a4 88 a2  |..... ..1.......|
+000002e0  54 67 e6 61 40 f2 5a 87  0f ce 15 b1 d6 af f3 5d  |Tg.a@.Z........]|
+000002f0  99 71 d6 04 f5 52 04 01  00 80 a8 1d 8b 8c e9 a3  |.q...R..........|
+00000300  af 2d 31 e4 0f f0 26 74  c2 e5 1b ae ac 47 9c 6e  |.-1...&t.....G.n|
+00000310  6c 5f 45 7d b1 b3 2a af  36 68 42 13 95 0d 33 1c  |l_E}..*.6hB...3.|
+00000320  8d 6c 72 48 4a 94 f0 fb  82 20 cc 76 21 7f 62 e7  |.lrHJ.... .v!.b.|
+00000330  23 a3 c8 4e 3a ce f1 5c  c3 60 73 26 59 4c 94 f3  |#..N:..\.`s&YL..|
+00000340  07 36 f6 a0 b3 60 03 d5  72 1e bf c8 d9 1d 61 01  |.6...`..r.....a.|
+00000350  9a 18 57 a3 b4 de 36 1f  e1 7d dc 69 c0 fb c0 71  |..W...6..}.i...q|
+00000360  45 1f 73 0d 50 69 d3 18  97 23 60 1c 5a 9a 93 b4  |E.s.Pi...#`.Z...|
+00000370  67 cc e5 80 3b 25 d0 6c  50 c8 16 03 03 00 04 0e  |g...;%.lP.......|
 00000380  00 00 00                                          |...|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 b0 62 c7  |....(.........b.|
-00000040  ca 6c 09 54 20 b6 eb 74  1d 10 94 80 28 59 42 13  |.l.T ..t....(YB.|
-00000050  12 72 3e 5b ed 36 ee df  17 fc 1a b3 15           |.r>[.6.......|
+00000030  16 03 03 00 20 5c c5 3e  7a 14 97 1b 55 88 25 08  |.... \.>z...U.%.|
+00000040  ad 86 48 ac f0 43 8c 17  5b 58 93 6c 7a 95 69 a8  |..H..C..[X.lz.i.|
+00000050  ad 0c b3 61 4d                                    |...aM|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 73 48 b3 32 5e  |..........(sH.2^|
-00000010  85 03 97 1b bb ca bc 98  95 b5 b7 1d 21 68 f2 2c  |............!h.,|
-00000020  ac 6c 7b 1c fd e1 02 46  70 b7 ba 1e f4 ec f8 44  |.l{....Fp......D|
-00000030  b7 6f f2                                          |.o.|
+00000000  14 03 03 00 01 01 16 03  03 00 20 dd 1b 80 da d9  |.......... .....|
+00000010  73 da 7d 15 9b 92 82 01  a7 8f fe 4a 75 97 8f f4  |s.}........Ju...|
+00000020  64 1b bf cf c3 40 78 f2  52 f5 7a                 |d....@x.R.z|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 8c 2c e6  |..............,.|
-00000010  31 e3 41 ef bb 3c 22 9a  3a 30 94 c1 0e 2e c0 6e  |1.A..<".:0.....n|
-00000020  51 7d ee 15 03 03 00 1a  00 00 00 00 00 00 00 02  |Q}..............|
-00000030  5f 63 44 89 67 6f 11 03  6b 79 6e 95 30 ea b0 b8  |_cD.go..kyn.0...|
-00000040  b0 d7                                             |..|
+00000000  17 03 03 00 16 4e fa 7c  37 80 48 19 a6 03 25 7c  |.....N.|7.H...%||
+00000010  65 56 43 af 9a e8 e2 aa  e5 79 98 15 03 03 00 12  |eVC......y......|
+00000020  f9 b7 01 e8 2e 85 33 89  60 44 84 93 26 4c ec ac  |......3.`D..&L..|
+00000030  2e 6f                                             |.o|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA
index 94e118f7fe..336e10da83 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 06 d8 a5 58 9e  |....Y...U.....X.|
-00000010  fd 74 7b 40 b9 db c7 55  80 57 55 1a 5a c1 e2 bb  |.t{@...U.WU.Z...|
-00000020  bc a4 8a d6 8c 0c 0a 6e  d2 30 66 20 7a 9d fa 67  |.......n.0f z..g|
-00000030  69 40 76 32 8f 62 42 ec  36 c1 f8 c8 99 5e 18 3b  |i@v2.bB.6....^.;|
-00000040  34 45 34 f9 19 1b 75 bb  d2 79 4d 2c c0 09 00 00  |4E4...u..yM,....|
+00000000  16 03 03 00 59 02 00 00  55 03 03 cf 28 2c 3e 4f  |....Y...U...(,>O|
+00000010  da 6b ae 24 74 a9 91 c3  c5 55 4b ab ec 07 f8 cd  |.k.$t....UK.....|
+00000020  65 f8 fe 08 f6 9a 23 da  99 6c 5d 20 af 4a 1e 32  |e.....#..l] .J.2|
+00000030  7b bd 3c 0b b1 14 66 a3  b7 2f a4 2a c3 43 c4 e0  |{.<...f../.*.C..|
+00000040  c2 ad 78 b1 28 ab 51 06  1b 87 d2 75 c0 09 00 00  |..x.(.Q....u....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -49,18 +49,18 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 b7 0c 00  00 b3 03 00 1d 20 aa 57  |*............ .W|
-00000280  9d bc 48 b3 81 25 b6 57  78 35 41 10 32 b4 96 e8  |..H..%.Wx5A.2...|
-00000290  b0 eb ab 71 be 87 bb 24  c3 05 fa fa b6 08 04 03  |...q...$........|
-000002a0  00 8b 30 81 88 02 42 01  61 87 5f 9a 58 37 f1 ff  |..0...B.a._.X7..|
-000002b0  b5 ff a7 89 fb c1 38 c9  99 00 89 6a 55 7d 2f d8  |......8....jU}/.|
-000002c0  e2 3f 55 b1 44 89 9d 30  7c 01 88 52 2b ef ba 90  |.?U.D..0|..R+...|
-000002d0  47 3f 9e 2e 22 83 1e 89  77 7a 81 c2 d0 fd 09 4b  |G?.."...wz.....K|
-000002e0  77 1e 9b 3b d1 95 b4 fb  ad 02 42 01 7c b4 80 5a  |w..;......B.|..Z|
-000002f0  13 e8 f7 00 42 93 f5 5b  be 61 fc 60 e5 3e 3c 04  |....B..[.a.`.><.|
-00000300  53 c9 5c 21 9c 43 0f 0c  a8 56 be 23 97 1f d7 cf  |S.\!.C...V.#....|
-00000310  e9 88 0f cf 8b 1d cf 45  d2 f2 e9 1d ab 64 af 72  |.......E.....d.r|
-00000320  e2 11 f9 d7 00 80 7a 9d  4d c3 ed fe 69 16 03 03  |......z.M...i...|
+00000270  2a 16 03 03 00 b7 0c 00  00 b3 03 00 1d 20 18 6f  |*............ .o|
+00000280  77 a5 2b 27 2c 52 fc 6c  8a 34 41 1c a8 c6 4f 90  |w.+',R.l.4A...O.|
+00000290  a9 4b b7 e0 39 8b b1 f5  a6 15 4b 94 e8 2c 04 03  |.K..9.....K..,..|
+000002a0  00 8b 30 81 88 02 42 00  dc 3a 14 a2 38 32 c1 40  |..0...B..:..82.@|
+000002b0  98 83 17 94 e9 2a 0d 95  c3 59 d6 76 94 c2 3e a0  |.....*...Y.v..>.|
+000002c0  f7 e0 5d 64 47 5a d1 d9  ed d2 1c 6b 13 3e e7 83  |..]dGZ.....k.>..|
+000002d0  6e bb 53 33 03 7d 69 c6  8f 9d 98 d7 96 9c 73 e3  |n.S3.}i.......s.|
+000002e0  12 bd 69 1f b1 d3 f4 25  d7 02 42 01 11 6d c8 53  |..i....%..B..m.S|
+000002f0  9b bf f4 db ff 8a 00 82  93 f7 b5 bf c9 bb cd ec  |................|
+00000300  64 f8 d9 6d 36 0d f8 db  ce 9d 65 a0 5e 5a e0 13  |d..m6.....e.^Z..|
+00000310  ec 08 73 2c 3f 8c c6 5b  08 cc 0f 4a 7d 6b 5e 89  |..s,?..[...J}k^.|
+00000320  bf 4a 4e db 51 5a 9f 51  3e 9d 9a c5 84 16 03 03  |.JN.QZ.Q>.......|
 00000330  00 2a 0d 00 00 26 03 01  02 40 00 1e 06 01 06 02  |.*...&...@......|
 00000340  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
 00000350  03 02 03 03 02 01 02 02  02 03 00 00 16 03 03 00  |................|
@@ -102,31 +102,31 @@
 00000210  03 03 00 25 10 00 00 21  20 2f e5 7d a3 47 cd 62  |...%...! /.}.G.b|
 00000220  43 15 28 da ac 5f bb 29  07 30 ff f6 84 af c4 cf  |C.(.._.).0......|
 00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 03 00 93 0f 00  |...._X.;t.......|
-00000240  00 8f 05 03 00 8b 30 81  88 02 42 01 af 55 e0 ee  |......0...B..U..|
-00000250  49 f4 29 a2 53 02 b0 7c  82 de 7d 0b 18 f9 be 28  |I.).S..|..}....(|
-00000260  63 8d d4 e5 a7 5f 3e 0c  e8 77 4d 67 5f 1b a1 55  |c...._>..wMg_..U|
-00000270  d1 f2 02 34 96 08 4c 06  40 9c 08 60 37 38 9b 90  |...4..L.@..`78..|
-00000280  a8 81 9d 70 b9 3d be 67  e8 25 51 07 52 02 42 00  |...p.=.g.%Q.R.B.|
-00000290  80 8b 8a 47 d2 7e df b8  2b fc 75 4c ce d7 8e 3c  |...G.~..+.uL...<|
-000002a0  fa a0 59 d2 b2 5a 89 69  25 24 81 ec c3 66 af 52  |..Y..Z.i%$...f.R|
-000002b0  83 76 f6 ee 18 9f 2e fa  78 76 b3 ef d0 fe 67 38  |.v......xv....g8|
-000002c0  f1 b2 3e 20 80 78 20 9e  3d ea fa 7a 92 f8 a8 ed  |..> .x .=..z....|
-000002d0  5e 14 03 03 00 01 01 16  03 03 00 40 00 00 00 00  |^..........@....|
-000002e0  00 00 00 00 00 00 00 00  00 00 00 00 b5 f1 10 d6  |................|
-000002f0  73 66 b5 f6 f3 ab 36 5b  f2 80 6a 1c 0b da 18 fc  |sf....6[..j.....|
-00000300  ac 20 c2 55 66 ae 25 f4  62 e1 16 2c 49 a0 e9 aa  |. .Uf.%.b..,I...|
-00000310  1f 08 06 f3 72 06 93 cd  64 46 06 aa              |....r...dF..|
+00000240  00 8f 05 03 00 8b 30 81  88 02 42 01 32 6d 32 38  |......0...B.2m28|
+00000250  d6 bd 1b b6 c5 80 f2 ea  60 b8 bf 3f b6 76 68 1b  |........`..?.vh.|
+00000260  66 fb 5d 69 0b 25 09 7f  2d 73 ad 7e cd 98 cb b5  |f.]i.%..-s.~....|
+00000270  93 4e 4f 1c 4e 3f a1 39  cf a0 70 a6 3d 29 36 27  |.NO.N?.9..p.=)6'|
+00000280  51 e0 55 95 11 df 00 88  6c 38 d6 de 36 02 42 01  |Q.U.....l8..6.B.|
+00000290  67 50 81 90 a7 ae b5 e2  34 75 81 41 c2 71 8d 0c  |gP......4u.A.q..|
+000002a0  9a 20 e7 33 af 0e 61 48  85 51 a1 f7 90 17 d1 ad  |. .3..aH.Q......|
+000002b0  b3 e1 cf 3e 12 fc ce 39  16 a8 78 3b 69 0d 79 76  |...>...9..x;i.yv|
+000002c0  03 17 75 c2 a0 63 5e dc  0a a7 c9 aa 15 2a 83 65  |..u..c^......*.e|
+000002d0  df 14 03 03 00 01 01 16  03 03 00 40 00 00 00 00  |...........@....|
+000002e0  00 00 00 00 00 00 00 00  00 00 00 00 27 da 48 f6  |............'.H.|
+000002f0  d3 00 98 b9 a6 b7 41 0b  eb e6 d1 d7 82 9a 0c 59  |......A........Y|
+00000300  8a 42 1c 99 59 af da a7  5b 88 ab b6 7d 01 bc 0f  |.B..Y...[...}...|
+00000310  45 08 c4 05 0d 2a 4a 83  bf eb b1 b6              |E....*J.....|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 9e 01 51 a4 a0  |..........@..Q..|
-00000010  37 31 94 d1 2f e3 0d c6  a4 99 bb 3e 70 9f e8 fe  |71../......>p...|
-00000020  38 73 ba c5 35 4e b9 5d  dd 5a ec e9 41 c1 f4 f6  |8s..5N.].Z..A...|
-00000030  5f 66 3d 27 d2 15 fc c9  0f 22 95 03 7b 1f a5 ff  |_f='....."..{...|
-00000040  43 f1 73 64 99 a2 eb fa  e6 e9 ee                 |C.sd.......|
+00000000  14 03 03 00 01 01 16 03  03 00 40 73 7c e6 43 b9  |..........@s|.C.|
+00000010  47 85 1c 50 f1 cb a1 29  79 02 dd 13 85 2a d9 a2  |G..P...)y....*..|
+00000020  07 50 e4 80 c4 7e 66 ee  f2 1a 21 1d cd e4 ff 4a  |.P...~f...!....J|
+00000030  a4 61 9d b4 a1 26 88 72  20 2b 06 77 c3 8b 3b 21  |.a...&.r +.w..;!|
+00000040  53 33 02 3d a2 06 77 3b  a5 a6 0b                 |S3.=..w;...|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 ca 47 da  6e 04 55 13 d0 01 13 e4  |......G.n.U.....|
-00000020  18 02 64 9c 1f 3c 3f 4f  5b ba e1 87 20 c5 a2 c4  |..d..<?O[... ...|
-00000030  f1 70 f6 84 6c 15 03 03  00 30 00 00 00 00 00 00  |.p..l....0......|
-00000040  00 00 00 00 00 00 00 00  00 00 2e 11 23 3c e2 a4  |............#<..|
-00000050  18 f3 91 73 57 5f 6c 10  3b cf 9e a2 17 1a 76 d5  |...sW_l.;.....v.|
-00000060  e6 4a 86 b1 42 d5 02 dc  5a 2d                    |.J..B...Z-|
+00000010  00 00 00 00 00 1a 45 68  03 9b f0 42 e4 21 5e d8  |......Eh...B.!^.|
+00000020  98 d6 46 67 2b 93 80 92  1f 91 60 a3 05 04 1c a0  |..Fg+.....`.....|
+00000030  1b a9 ce 45 03 15 03 03  00 30 00 00 00 00 00 00  |...E.....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 6b 23 42 c8 5c 29  |..........k#B.\)|
+00000050  f5 1f 7c d5 80 c4 9f 6f  12 77 95 71 8f 82 f9 63  |..|....o.w.q...c|
+00000060  07 2c 6d ed 6d c6 4f 90  50 a3                    |.,m.m.O.P.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA
index 89426a602d..fb6c940a5f 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 04 3b 69 ac b4  |....Y...U...;i..|
-00000010  14 b1 67 6d 1e 99 ab f5  57 c2 a9 99 33 8c 9d 31  |..gm....W...3..1|
-00000020  26 ec 17 43 1a b2 62 36  a0 c3 bd 20 52 d5 07 92  |&..C..b6... R...|
-00000030  e5 d8 a6 2f a5 8d e6 df  b1 90 69 7a 94 2d d7 73  |.../......iz.-.s|
-00000040  cb da 29 ee 6f 13 e5 2d  7f 3a 0e cd c0 2f 00 00  |..).o..-.:.../..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 2e d2 1c 3f f8  |....Y...U.....?.|
+00000010  3a dc be 78 0b fa 03 00  e0 9a b9 62 34 45 f8 34  |:..x.......b4E.4|
+00000020  54 21 4c c0 76 a6 e1 5a  a1 67 c2 20 1b 98 25 34  |T!L.v..Z.g. ..%4|
+00000030  79 ac 59 b5 39 c8 93 10  a9 ea 9d 25 3d 2c d8 69  |y.Y.9......%=,.i|
+00000040  da d8 33 75 ef 44 4c 76  92 2b 3b b4 c0 2f 00 00  |..3u.DLv.+;../..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -54,17 +54,17 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 d7 5f 84 86 e0 7c 20  |........ ._...| |
-000002d0  c5 97 78 c1 40 3f 64 2e  ae 06 51 c3 6f d3 86 a2  |..x.@?d...Q.o...|
-000002e0  03 d3 f8 75 ed 20 28 6b  26 04 01 00 80 c3 8b b6  |...u. (k&.......|
-000002f0  81 65 e3 d2 98 33 78 c8  d4 d4 6a 80 3b cc 26 ab  |.e...3x...j.;.&.|
-00000300  7a 2f d0 0e 02 57 0d 34  30 78 a1 7b d4 df e1 da  |z/...W.40x.{....|
-00000310  7f 8e 04 65 45 8d b9 ad  04 13 84 e2 81 da e0 b6  |...eE...........|
-00000320  20 07 02 f9 e5 78 5e d4  0d 74 f5 d2 98 a8 9b d8  | ....x^..t......|
-00000330  f4 f3 7b 2f 8f 58 58 77  b6 db 4d d0 94 53 df 5a  |..{/.XXw..M..S.Z|
-00000340  61 43 2d a7 64 ec b1 8f  48 80 b4 fd 6c 05 f6 84  |aC-.d...H...l...|
-00000350  b5 d2 0d 30 5d 2f 9d 9f  8f 14 d0 e1 70 64 0b 86  |...0]/......pd..|
-00000360  c3 26 7d b2 b2 f5 9f 9e  de 6e 92 47 76 16 03 03  |.&}......n.Gv...|
+000002c0  ac 0c 00 00 a8 03 00 1d  20 06 be 1b 0b d8 95 59  |........ ......Y|
+000002d0  b2 13 1c 4a 06 b8 36 3e  4f 98 3f 81 11 3e 7d 21  |...J..6>O.?..>}!|
+000002e0  fa d9 f0 db 1b 41 4a d0  14 04 01 00 80 ca 57 f5  |.....AJ.......W.|
+000002f0  e7 b6 72 7e 3f b0 67 f2  a2 d0 84 d5 7f 7d 83 ff  |..r~?.g......}..|
+00000300  92 73 4f 19 f7 94 b6 d7  95 f4 1b 56 2a fc fa 24  |.sO........V*..$|
+00000310  3e fe 00 65 52 76 c8 30  8a bf ae fe b5 c9 f2 47  |>..eRv.0.......G|
+00000320  0a 71 ad c1 6a 61 8c b5  ab 59 09 12 92 b2 b4 ad  |.q..ja...Y......|
+00000330  cb cc ac c4 30 e9 a4 8a  82 4e 2e d6 1d 16 46 dd  |....0....N....F.|
+00000340  60 37 50 b8 ae 83 c1 e6  1d ba 8c c7 18 f7 5e d7  |`7P...........^.|
+00000350  23 e5 8a 14 ba e4 8e a1  77 8a b6 41 03 61 8a 25  |#.......w..A.a.%|
+00000360  8a 27 f8 cb 2e 4a e0 07  aa bf 03 32 98 16 03 03  |.'...J.....2....|
 00000370  00 2a 0d 00 00 26 03 01  02 40 00 1e 06 01 06 02  |.*...&...@......|
 00000380  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
 00000390  03 02 03 03 02 01 02 02  02 03 00 00 16 03 03 00  |................|
@@ -105,28 +105,28 @@
 00000200  e4 fa cc b1 8a ce e2 23  a0 87 f0 e1 67 51 eb 16  |.......#....gQ..|
 00000210  03 03 00 25 10 00 00 21  20 2f e5 7d a3 47 cd 62  |...%...! /.}.G.b|
 00000220  43 15 28 da ac 5f bb 29  07 30 ff f6 84 af c4 cf  |C.(.._.).0......|
-00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 03 00 93 0f 00  |...._X.;t.......|
-00000240  00 8f 05 03 00 8b 30 81  88 02 42 01 6d 16 77 ad  |......0...B.m.w.|
-00000250  3f 82 a2 df 03 16 35 64  a0 19 e9 e1 dd 21 f3 dc  |?.....5d.....!..|
-00000260  a4 c8 98 ae 2c 28 02 cc  85 c3 f9 fe eb 60 6f ac  |....,(.......`o.|
-00000270  b8 03 25 2e 48 fb 7c 8b  4a 6e b3 5c 4d 83 77 a1  |..%.H.|.Jn.\M.w.|
-00000280  d6 ed c3 df 8b 16 09 81  3d 81 a7 e2 6d 02 42 01  |........=...m.B.|
-00000290  df a2 14 a8 e5 4b 02 63  1e 3a a6 70 18 75 78 d9  |.....K.c.:.p.ux.|
-000002a0  ae eb 89 35 09 7b 56 9c  1e 61 82 26 6e c1 f5 02  |...5.{V..a.&n...|
-000002b0  5e 7c 71 53 5b 3a a2 17  5f 58 38 86 f5 32 17 40  |^|qS[:.._X8..2.@|
-000002c0  e8 b6 04 61 ee 0a df c0  ee d1 e0 16 aa 88 34 f4  |...a..........4.|
-000002d0  ad 14 03 03 00 01 01 16  03 03 00 28 00 00 00 00  |...........(....|
-000002e0  00 00 00 00 4b b7 1d c9  55 aa 66 46 df 94 39 e9  |....K...U.fF..9.|
-000002f0  96 9e 89 e0 e6 f3 f2 11  0b f2 9a 71 25 e2 2f aa  |...........q%./.|
-00000300  8a 77 a8 7b                                       |.w.{|
+00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 03 00 92 0f 00  |...._X.;t.......|
+00000240  00 8e 05 03 00 8a 30 81  87 02 41 19 c6 1e f0 f4  |......0...A.....|
+00000250  ca 79 d7 8c 36 0f 56 9a  9d 07 55 31 fe 63 f1 ec  |.y..6.V...U1.c..|
+00000260  20 80 6f 12 ed 7f bb c0  87 0a 0d 68 81 89 bd 8b  | .o........h....|
+00000270  19 04 5e c0 19 8a d2 0f  6d 71 83 59 ee a7 be be  |..^.....mq.Y....|
+00000280  1d bb 2f 12 53 9b ca 58  0e a6 8d ae 02 42 00 d0  |../.S..X.....B..|
+00000290  4c 69 75 30 86 d1 da 73  1b 8e 3e e1 82 9b f3 58  |Liu0...s..>....X|
+000002a0  8f 6d 0a 10 86 72 5f 90  17 d1 ac 34 8a b5 60 d0  |.m...r_....4..`.|
+000002b0  b8 54 0f 05 7f cd 6a c0  62 b5 04 d9 3a 98 95 b6  |.T....j.b...:...|
+000002c0  b3 00 1d 94 6e 79 35 57  d2 78 a4 7a 4a 45 89 d1  |....ny5W.x.zJE..|
+000002d0  14 03 03 00 01 01 16 03  03 00 28 00 00 00 00 00  |..........(.....|
+000002e0  00 00 00 cf b5 3c cf 0a  b7 6b 51 cb fe 06 4c df  |.....<...kQ...L.|
+000002f0  2c 79 a6 5e a8 75 8b 4c  44 7b ae ff 64 d7 67 dc  |,y.^.u.LD{..d.g.|
+00000300  af ef 54                                          |..T|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 11 75 ff 06 73  |..........(.u..s|
-00000010  15 0d 08 4b e8 0b 91 56  b0 bb 28 2b 5d df 73 21  |...K...V..(+].s!|
-00000020  16 99 52 30 56 e9 fb a2  9f c6 8b 3b 38 be 32 96  |..R0V......;8.2.|
-00000030  3c 8d cb                                          |<..|
+00000000  14 03 03 00 01 01 16 03  03 00 28 1c 12 5e 29 ba  |..........(..^).|
+00000010  34 b3 d8 ae f7 2a 83 0d  3e 21 ec 91 c9 fa 7f d1  |4....*..>!......|
+00000020  42 7e 8d d9 e5 ed 4e f9  ae 95 66 27 85 cc 44 2d  |B~....N...f'..D-|
+00000030  cd a3 26                                          |..&|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 8d b0 1a  |................|
-00000010  28 53 1d 8f df ad 0c f4  29 b1 89 01 6d f4 f2 7f  |(S......)...m...|
-00000020  29 88 4c 15 03 03 00 1a  00 00 00 00 00 00 00 02  |).L.............|
-00000030  6b b0 6f ca 9a 62 19 e9  a1 37 27 dc 3c 00 b8 03  |k.o..b...7'.<...|
-00000040  4c b4                                             |L.|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 8b 4c 36  |..............L6|
+00000010  6f b8 69 16 0a 40 67 05  5e a8 e6 48 cc ad 7b 29  |o.i..@g.^..H..{)|
+00000020  95 3d 02 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.=..............|
+00000030  58 e3 b5 8e 30 e7 5d 02  cd e5 c0 11 95 3a ef a9  |X...0.]......:..|
+00000040  d7 86                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384 b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384
index 839334b8b5..17fc8f8e11 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 e2 04 c7 2b 8b  |....Y...U.....+.|
-00000010  3e 9b 44 e7 fa 11 ea 60  b5 e9 c1 94 53 8e 28 49  |>.D....`....S.(I|
-00000020  cc 2a 91 8b 81 3a c0 6b  e6 81 8c 20 6a ea 72 bb  |.*...:.k... j.r.|
-00000030  44 d3 54 e5 f7 96 02 69  85 8d 76 97 5c 14 df f6  |D.T....i..v.\...|
-00000040  64 42 49 fe f3 2a a6 d4  ef 65 e0 00 c0 30 00 00  |dBI..*...e...0..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 31 df 35 e4 36  |....Y...U..1.5.6|
+00000010  c5 f1 b4 9f e7 5d fa e1  e0 23 04 54 bd 2b fb ab  |.....]...#.T.+..|
+00000020  a2 37 8f 35 eb 79 47 e6  f8 2b cb 20 ba d8 db 26  |.7.5.yG..+. ...&|
+00000030  ce 6b 4a e9 1e 0c 46 9f  4d 85 cb d7 b0 e2 3d 20  |.kJ...F.M.....= |
+00000040  58 43 83 37 e1 53 ac 3b  d9 b3 fd 0a c0 30 00 00  |XC.7.S.;.....0..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -54,17 +54,17 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 92 df c1 68 51 1f 9a  |........ ...hQ..|
-000002d0  84 6d e0 69 15 15 53 fc  0d f4 cf 05 c6 b9 ad cb  |.m.i..S.........|
-000002e0  68 a8 7d f9 af 59 53 9e  1e 04 01 00 80 97 26 59  |h.}..YS.......&Y|
-000002f0  c6 ad f8 fd 9c 7c 6e 79  fc cc f5 3a 11 f1 ac aa  |.....|ny...:....|
-00000300  48 a8 92 25 f7 d7 e5 a0  0d e9 da e2 ff ea d8 a0  |H..%............|
-00000310  df 90 3f 53 4c a5 df 77  43 ff d7 95 80 f2 40 c1  |..?SL..wC.....@.|
-00000320  4d 12 09 f6 ea 0b c7 19  5d b2 b9 67 60 13 2f cc  |M.......]..g`./.|
-00000330  cb 16 ae e0 ae c5 b0 c7  8a 32 5c 31 e3 cf 85 22  |.........2\1..."|
-00000340  16 76 f3 0a 7d 84 98 f7  bc 63 56 a9 50 ae 55 a8  |.v..}....cV.P.U.|
-00000350  63 a5 93 a1 3a 7f bd 30  e4 90 d1 29 d2 0f a1 ad  |c...:..0...)....|
-00000360  c4 e8 11 05 da 47 3e 8f  16 80 cd 8b 9e 16 03 03  |.....G>.........|
+000002c0  ac 0c 00 00 a8 03 00 1d  20 9a 18 f9 2e 33 f7 bb  |........ ....3..|
+000002d0  ca 60 0b 51 ad 5c 01 e2  61 82 0b 3f 09 8f 78 9d  |.`.Q.\..a..?..x.|
+000002e0  3b 11 8b e0 4a 35 2e d5  54 04 01 00 80 90 94 0e  |;...J5..T.......|
+000002f0  bf 3a b7 95 d3 58 cc 65  c3 79 5e 1e bb d9 21 56  |.:...X.e.y^...!V|
+00000300  06 93 6c 2b 6e 26 55 ee  26 c3 02 44 7e db 35 9b  |..l+n&U.&..D~.5.|
+00000310  d4 d4 1a a0 65 35 41 a4  6c ce de 1f 94 ff b4 1b  |....e5A.l.......|
+00000320  1e 9c 28 0b 4c 8d 55 d0  d8 be f1 df e0 d1 1a b5  |..(.L.U.........|
+00000330  c8 be 2c 5a 2c c3 3f ea  4f e6 d5 b4 6b e1 ff eb  |..,Z,.?.O...k...|
+00000340  f3 f3 40 54 d5 62 1f a0  fc b2 34 66 ee c5 27 a6  |..@T.b....4f..'.|
+00000350  2b 2a b9 5d 3f 36 28 eb  39 99 25 e5 04 d2 18 13  |+*.]?6(.9.%.....|
+00000360  3c 23 93 d0 04 37 85 b0  4d 6e 9b 32 9a 16 03 03  |<#...7..Mn.2....|
 00000370  00 2a 0d 00 00 26 03 01  02 40 00 1e 06 01 06 02  |.*...&...@......|
 00000380  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
 00000390  03 02 03 03 02 01 02 02  02 03 00 00 16 03 03 00  |................|
@@ -105,26 +105,26 @@
 00000200  e5 35 16 03 03 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
 00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 03 00  |......._X.;t....|
-00000230  88 0f 00 00 84 05 01 00  80 2c f5 ed 80 3e 10 d8  |.........,...>..|
-00000240  1d 7f c4 1b 1a 16 36 0b  07 ec ad 68 4f dc b3 56  |......6....hO..V|
-00000250  67 c9 21 ba 71 a7 2f b0  2b 7b 45 69 30 88 ec 8c  |g.!.q./.+{Ei0...|
-00000260  aa 12 50 3b 07 ea 94 55  42 74 5e bf 6b 57 d0 7c  |..P;...UBt^.kW.||
-00000270  bb 44 6e e2 1c 7a 5f e1  dc 3a cc 38 d4 3d 0b 1e  |.Dn..z_..:.8.=..|
-00000280  9a ed 82 dc 26 45 48 a2  c1 2a 9e 66 da f2 0b b2  |....&EH..*.f....|
-00000290  eb b7 4d 1a 78 5b d4 0d  c1 fa 02 60 25 20 9b a4  |..M.x[.....`% ..|
-000002a0  34 03 5c b9 4c 7a 49 78  43 8b 0e d4 c1 bd 82 b3  |4.\.LzIxC.......|
-000002b0  12 5a bf 09 a3 c5 30 a2  f7 14 03 03 00 01 01 16  |.Z....0.........|
-000002c0  03 03 00 28 00 00 00 00  00 00 00 00 9f 75 ff e1  |...(.........u..|
-000002d0  e9 59 e8 7b b8 7f 4e 4f  9a a4 89 4d 75 3d bd a1  |.Y.{..NO...Mu=..|
-000002e0  92 df c8 71 fe c3 32 f5  96 9c 69 ef              |...q..2...i.|
+00000230  88 0f 00 00 84 05 01 00  80 ad f7 ff a0 cb d0 6e  |...............n|
+00000240  8f 19 0c 40 2a 1f bb dd  11 52 81 84 f1 7b 3f cf  |...@*....R...{?.|
+00000250  75 72 83 a4 4c 0a 9c 70  95 98 d5 51 a2 28 0c 8c  |ur..L..p...Q.(..|
+00000260  20 08 d7 2a a5 3e 0c cf  6c a2 1d 32 bd cc a1 b4  | ..*.>..l..2....|
+00000270  61 e0 6d 9a 61 16 03 5c  7a b8 fa 15 ea cd e4 de  |a.m.a..\z.......|
+00000280  d6 16 93 b2 e0 d2 55 b9  03 e0 67 04 27 64 8c e2  |......U...g.'d..|
+00000290  01 ee 8f f7 59 3e 12 16  51 f2 07 20 fe 03 e2 3e  |....Y>..Q.. ...>|
+000002a0  09 1f 96 24 c5 73 0e 69  ac 57 ff 43 2b 6a c6 20  |...$.s.i.W.C+j. |
+000002b0  2f e4 ef 7e bc b3 38 57  06 14 03 03 00 01 01 16  |/..~..8W........|
+000002c0  03 03 00 28 00 00 00 00  00 00 00 00 fd 71 f5 ca  |...(.........q..|
+000002d0  91 26 67 54 a5 e6 f3 06  c8 40 24 9d a9 bd b1 9a  |.&gT.....@$.....|
+000002e0  63 c4 c2 53 56 ba af c0  16 bc 06 5c              |c..SV......\|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 ef fc fe 76 da  |..........(...v.|
-00000010  6e 36 8d db 71 67 10 68  80 6c 6e 05 68 f1 0f e8  |n6..qg.h.ln.h...|
-00000020  74 47 ab 40 78 28 75 81  b3 92 70 ca 08 c7 3b c9  |tG.@x(u...p...;.|
-00000030  e7 b9 c1                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 28 92 8f bd c5 97  |..........(.....|
+00000010  94 76 70 f4 0a f9 9a 79  69 31 27 0e c0 c5 0b 3c  |.vp....yi1'....<|
+00000020  9f 4f c2 2f cb 6c 56 62  80 3b e5 72 6a 05 9e 4b  |.O./.lVb.;.rj..K|
+00000030  34 b9 66                                          |4.f|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 f3 2e 79  |...............y|
-00000010  00 81 81 2f 95 2c 3f 47  22 13 53 c1 fc 2a 7c 08  |.../.,?G".S..*|.|
-00000020  8a cc a8 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
-00000030  fa d6 18 b5 54 9d ea eb  d6 16 97 64 18 25 89 48  |....T......d.%.H|
-00000040  b8 8d                                             |..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 43 fb 43  |.............C.C|
+00000010  3d 96 63 dd 25 94 9d 7a  fb 9e 15 6f 62 5e ed 34  |=.c.%..z...ob^.4|
+00000020  19 89 b8 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
+00000030  53 c2 2d 6c b7 91 6c 62  84 09 a2 1c 9b 3d 9e 89  |S.-l..lb.....=..|
+00000040  6a 3d                                             |j=|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA
index a61dccc246..1ff91986d2 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 b5 1b a7 76 84  |....Y...U.....v.|
-00000010  6b 76 c7 d4 db 65 6e e7  f8 df 4e cb 27 33 77 e3  |kv...en...N.'3w.|
-00000020  15 b3 47 eb 35 c8 11 80  d9 33 6f 20 a4 6c b2 e6  |..G.5....3o .l..|
-00000030  95 77 72 69 11 59 10 8b  ee 75 a3 68 f8 87 36 31  |.wri.Y...u.h..61|
-00000040  19 09 80 27 e4 63 cf 93  4f 85 82 f5 c0 09 00 00  |...'.c..O.......|
+00000000  16 03 03 00 59 02 00 00  55 03 03 84 4b ff a4 2a  |....Y...U...K..*|
+00000010  a4 76 c0 26 f6 05 72 94  01 15 44 f2 c6 7d b0 4b  |.v.&..r...D..}.K|
+00000020  1b fa da 51 54 45 78 66  e6 0a dd 20 17 df d2 0c  |...QTExf... ....|
+00000030  2f d6 55 b9 ae 82 ce 2f  2f 07 67 54 5e 02 bd 2f  |/.U....//.gT^../|
+00000040  48 f6 fb 3d 9c fa 4f a8  66 15 08 da c0 09 00 00  |H..=..O.f.......|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -49,18 +49,18 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 b7 0c 00  00 b3 03 00 1d 20 20 fd  |*............  .|
-00000280  ab d5 d0 a5 9d bd ff 8f  03 f1 45 8d 64 04 50 1c  |..........E.d.P.|
-00000290  72 e7 29 36 af 91 39 d8  10 3d e8 6f 7d 17 04 03  |r.)6..9..=.o}...|
-000002a0  00 8b 30 81 88 02 42 00  ca bc 74 65 5b 16 c0 66  |..0...B...te[..f|
-000002b0  01 73 bb 25 6f 14 1b 91  06 b4 07 a9 b1 9e 89 77  |.s.%o..........w|
-000002c0  7f 9f 00 85 be 66 96 58  63 c5 8b c5 84 2c 16 04  |.....f.Xc....,..|
-000002d0  7f 78 0b 48 2b 4c 41 50  6f d3 e4 0d 0c e9 42 39  |.x.H+LAPo.....B9|
-000002e0  07 2f fc d4 53 43 9f 82  52 02 42 01 17 01 a4 8b  |./..SC..R.B.....|
-000002f0  bf af 45 8a 92 fe 88 f5  00 7e 29 d1 9d 8b d4 a9  |..E......~).....|
-00000300  7c 07 50 74 44 7d 6d 3a  ac ee ca 14 18 a7 dc 54  ||.PtD}m:.......T|
-00000310  38 58 be fd 00 75 53 26  cd 8c a9 cf a0 ce d7 97  |8X...uS&........|
-00000320  d9 20 1d cf 3c 27 0c 0d  20 62 33 d5 e8 16 03 03  |. ..<'.. b3.....|
+00000270  2a 16 03 03 00 b7 0c 00  00 b3 03 00 1d 20 5d 4e  |*............ ]N|
+00000280  0c 9e ad 7b f1 48 0c db  03 96 26 2e 16 87 2c e2  |...{.H....&...,.|
+00000290  ce a2 47 5a 57 30 e8 e1  7e b2 53 5b c6 7b 04 03  |..GZW0..~.S[.{..|
+000002a0  00 8b 30 81 88 02 42 00  e8 8e 68 a8 e3 b5 b4 fe  |..0...B...h.....|
+000002b0  b9 91 aa 4f 96 3d 97 8d  b2 ef 23 a4 3d 16 db 2b  |...O.=....#.=..+|
+000002c0  50 6d 52 cd a5 e7 79 ae  65 10 d6 36 e0 ba c3 6b  |PmR...y.e..6...k|
+000002d0  53 61 14 bb 05 47 5a df  26 2f cb 3a 95 c6 6b dc  |Sa...GZ.&/.:..k.|
+000002e0  88 fd 2e 22 b5 ef ff 31  0e 02 42 01 be ce 6e 53  |..."...1..B...nS|
+000002f0  42 43 1c 1c d8 83 7f 45  c4 16 ee d2 7b 66 a0 f4  |BC.....E....{f..|
+00000300  f3 14 da 5c 14 e8 fc bc  86 7d 18 43 b9 7b 90 8c  |...\.....}.C.{..|
+00000310  af f1 05 95 c6 53 0b 0b  0d 10 a1 e9 bb 89 35 c2  |.....S........5.|
+00000320  b2 e1 d7 dd 99 7c bf 85  19 3c 4e 8e 8f 16 03 03  |.....|...<N.....|
 00000330  00 2a 0d 00 00 26 03 01  02 40 00 1e 06 01 06 02  |.*...&...@......|
 00000340  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
 00000350  03 02 03 03 02 01 02 02  02 03 00 00 16 03 03 00  |................|
@@ -101,31 +101,31 @@
 00000200  e5 35 16 03 03 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
 00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 03 00  |......._X.;t....|
-00000230  88 0f 00 00 84 05 01 00  80 18 5b ff 66 70 07 cd  |..........[.fp..|
-00000240  9b 6d a3 a6 dc c6 5b 53  42 27 13 71 0c 0e aa 5e  |.m....[SB'.q...^|
-00000250  01 0c 84 34 20 1a af 48  8c 0c 28 07 68 1f 89 4d  |...4 ..H..(.h..M|
-00000260  1c 96 1e de cc 55 5a cd  59 cd 6d fd 8a 5d 09 f4  |.....UZ.Y.m..]..|
-00000270  a0 38 ec e5 c5 84 70 f8  3c c2 4d b7 9b 93 bb 22  |.8....p.<.M...."|
-00000280  e1 d9 4d d7 c1 54 73 55  99 63 fb 0e 1d 2a 41 51  |..M..TsU.c...*AQ|
-00000290  c7 9d 91 d1 1c 1c f2 ae  7e 8f b8 5a 71 20 3a 82  |........~..Zq :.|
-000002a0  99 ef 4c 8f 84 e4 3a 17  d8 a3 f0 06 e4 89 95 89  |..L...:.........|
-000002b0  c8 f3 39 c5 a0 52 00 16  c6 14 03 03 00 01 01 16  |..9..R..........|
+00000230  88 0f 00 00 84 05 01 00  80 98 58 a8 77 3d db 0b  |..........X.w=..|
+00000240  04 36 78 51 8b 23 48 fc  70 2b c9 94 1f ee 32 ae  |.6xQ.#H.p+....2.|
+00000250  41 c0 42 20 19 51 67 e7  fa c0 fd 15 a1 5f 55 4f  |A.B .Qg......_UO|
+00000260  aa be 29 77 f5 47 71 b9  6c 51 89 18 df 25 98 fd  |..)w.Gq.lQ...%..|
+00000270  c8 6e ae e3 fd 99 63 ca  2c d2 fb ca bc 57 b7 7f  |.n....c.,....W..|
+00000280  a2 90 a6 6f b7 2e b7 2a  52 29 e6 75 57 86 cc b1  |...o...*R).uW...|
+00000290  d8 6c f3 4e 49 ab 4b 66  0a 72 aa ec c2 f7 6e 57  |.l.NI.Kf.r....nW|
+000002a0  15 26 79 1a a4 24 c2 ba  76 9e dd b9 f9 d4 da 1b  |.&y..$..v.......|
+000002b0  c9 29 66 eb 64 1b 68 66  66 14 03 03 00 01 01 16  |.)f.d.hff.......|
 000002c0  03 03 00 40 00 00 00 00  00 00 00 00 00 00 00 00  |...@............|
-000002d0  00 00 00 00 6f 19 d0 de  11 e8 13 98 0e ba 3a fd  |....o.........:.|
-000002e0  ba 8d da 63 73 a8 2c 28  a8 b6 de bc 76 ee ec 43  |...cs.,(....v..C|
-000002f0  7b 4a d7 9c 70 4d 59 02  6a 87 5e 33 51 49 63 88  |{J..pMY.j.^3QIc.|
-00000300  cd 6a 4f 13                                       |.jO.|
+000002d0  00 00 00 00 70 2b 69 27  05 9a 96 e6 e8 52 ea 0f  |....p+i'.....R..|
+000002e0  3a d6 40 b5 e2 89 5b bf  aa 95 6c c1 7d 53 09 89  |:.@...[...l.}S..|
+000002f0  23 38 6b 83 85 84 fa f4  2e fb cd b3 57 4e 79 8a  |#8k.........WNy.|
+00000300  92 74 03 22                                       |.t."|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 59 c9 2e 02 4d  |..........@Y...M|
-00000010  ac c3 f4 a2 97 8f 92 12  fd 99 c4 80 59 96 f4 af  |............Y...|
-00000020  eb 1b 2d 70 55 8b 28 22  42 9a 61 cd 9c 64 54 d3  |..-pU.("B.a..dT.|
-00000030  f1 a2 25 98 ad 15 cf 7d  82 12 b0 b5 06 1d 5b 21  |..%....}......[!|
-00000040  1d b9 14 69 f8 1b 30 55  67 df 22                 |...i..0Ug."|
+00000000  14 03 03 00 01 01 16 03  03 00 40 8f 91 f1 f5 6b  |..........@....k|
+00000010  cc 52 9d db 35 1f db b4  64 fe 33 a5 83 08 24 2f  |.R..5...d.3...$/|
+00000020  57 18 0e 60 4e 18 54 bb  80 31 37 fe 26 14 b8 c8  |W..`N.T..17.&...|
+00000030  dd c4 8c 07 42 0b 80 0b  41 82 40 f6 9b b8 60 4f  |....B...A.@...`O|
+00000040  cb 7b 43 ea 1a 6e 31 8d  9f 82 f7                 |.{C..n1....|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 95 75 2b  6f 14 f6 25 db 2e 1a 98  |......u+o..%....|
-00000020  62 91 50 6d b8 88 ed c4  33 58 2b 33 5f 64 78 e8  |b.Pm....3X+3_dx.|
-00000030  cf 89 29 b5 69 15 03 03  00 30 00 00 00 00 00 00  |..).i....0......|
-00000040  00 00 00 00 00 00 00 00  00 00 d5 d3 10 25 68 c0  |.............%h.|
-00000050  65 67 23 fb cd ee 4c c1  7d ec 15 76 c9 1f cd d5  |eg#...L.}..v....|
-00000060  a5 6e 67 03 d9 27 0d 47  c0 90                    |.ng..'.G..|
+00000010  00 00 00 00 00 70 e7 c8  03 9c e2 58 73 68 ab 9b  |.....p.....Xsh..|
+00000020  5c bf 32 57 f8 f1 13 97  02 59 de 99 d3 3e 16 3d  |\.2W.....Y...>.=|
+00000030  87 11 d4 b4 63 15 03 03  00 30 00 00 00 00 00 00  |....c....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 9b 99 45 f3 0d f1  |............E...|
+00000050  c5 36 07 8c 81 94 b7 0a  dc 7c ee 0c 22 1b 36 fd  |.6.......|..".6.|
+00000060  d4 fc 7d f1 98 8b 87 be  5f c6                    |..}....._.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA
index 494bad391f..76f0c2511b 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 ec cc 8c b3 7b  |....Y...U......{|
-00000010  7a 62 0f 0c 6b a8 15 b8  cc 1f fd 10 bf e5 37 34  |zb..k.........74|
-00000020  ef 7e 62 15 14 59 11 91  6d 49 a1 20 91 fb 98 6d  |.~b..Y..mI. ...m|
-00000030  d2 7e 50 30 c5 c5 c2 bd  d2 b2 7d 02 82 1d 1e 80  |.~P0......}.....|
-00000040  01 b7 df f6 4b 30 cb ce  d0 d4 2e 92 c0 2f 00 00  |....K0......./..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 92 93 45 4c f9  |....Y...U....EL.|
+00000010  93 bf ee 78 58 e0 42 b6  df 32 c2 63 6d ec 89 66  |...xX.B..2.cm..f|
+00000020  5a 11 7c 0d 31 2f b5 90  22 ab 3d 20 65 f3 40 c4  |Z.|.1/..".= e.@.|
+00000030  f8 31 fa 80 f3 fb a7 f6  9e dc 0c 94 67 48 d9 2b  |.1..........gH.+|
+00000040  cb 94 82 5f 4e 8b 41 5e  c6 63 27 da c0 2f 00 00  |..._N.A^.c'../..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -54,17 +54,17 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 f0 12 33 b8 af 7f 1e  |........ ..3....|
-000002d0  11 b6 9a aa 42 0d 8e 1f  5d 3f a5 38 10 b6 6c cf  |....B...]?.8..l.|
-000002e0  36 14 6b 50 d6 73 78 38  63 04 01 00 80 cc 76 3b  |6.kP.sx8c.....v;|
-000002f0  f2 ee 84 7c 46 ed 0f ff  06 bd f7 ab 5c d2 68 b9  |...|F.......\.h.|
-00000300  fc 9e 8c 19 5b 6d 5c be  be 0f 09 e7 1c 1d 67 77  |....[m\.......gw|
-00000310  00 c2 22 02 2f 2d 86 c0  f3 48 fb 0e 4c 5c f0 b7  |.."./-...H..L\..|
-00000320  f9 e8 86 3a 94 0c b5 a0  56 8a 89 49 dd 5d 34 80  |...:....V..I.]4.|
-00000330  02 fe 23 fe 3e 2f 22 b5  09 9d 9a 03 66 d0 6e 3d  |..#.>/".....f.n=|
-00000340  a7 2f d3 2a b5 8c 6e eb  1e 9c fe 53 fb 94 a0 45  |./.*..n....S...E|
-00000350  1e 20 2b 96 1b 1f 9c ee  64 df 27 66 6e 5d ec 61  |. +.....d.'fn].a|
-00000360  e9 aa 76 31 8f 9d ce f7  2b 03 8b ac 05 16 03 03  |..v1....+.......|
+000002c0  ac 0c 00 00 a8 03 00 1d  20 66 49 44 2b 04 fe f5  |........ fID+...|
+000002d0  41 68 60 09 81 0e 24 c4  46 68 33 87 41 dd 48 69  |Ah`...$.Fh3.A.Hi|
+000002e0  4c be c8 22 2d 4e ff 80  20 04 01 00 80 30 85 40  |L.."-N.. ....0.@|
+000002f0  30 56 d5 1d 41 14 9d e8  27 39 a2 18 d5 eb 92 27  |0V..A...'9.....'|
+00000300  63 4b 05 85 1a 9e 5f 60  2c 80 a3 20 9f 9c 57 29  |cK...._`,.. ..W)|
+00000310  ba 5f ac 0a aa 89 98 fc  ca 8e 37 6b 44 bc 0f 33  |._........7kD..3|
+00000320  5d 47 91 46 55 d4 f9 4f  76 73 51 c4 f6 a9 90 e4  |]G.FU..OvsQ.....|
+00000330  95 10 92 94 f1 33 11 3d  83 0a eb 5d ff e6 9d 9c  |.....3.=...]....|
+00000340  19 ec e1 65 11 ad d7 7b  6a a4 f9 d8 b6 0c 53 8a  |...e...{j.....S.|
+00000350  16 d5 1f a7 0b 80 6f c5  d8 6a 57 11 2f b1 84 65  |......o..jW./..e|
+00000360  24 8a 02 de aa 10 40 bd  9b 68 a2 b7 b6 16 03 03  |$.....@..h......|
 00000370  00 2a 0d 00 00 26 03 01  02 40 00 1e 06 01 06 02  |.*...&...@......|
 00000380  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
 00000390  03 02 03 03 02 01 02 02  02 03 00 00 16 03 03 00  |................|
@@ -105,26 +105,26 @@
 00000200  e5 35 16 03 03 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
 00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 03 00  |......._X.;t....|
-00000230  88 0f 00 00 84 05 01 00  80 6a 76 53 cc dd 4d d8  |.........jvS..M.|
-00000240  33 94 d3 5d 48 ec b6 0a  de 44 58 fc 95 a9 87 a4  |3..]H....DX.....|
-00000250  e7 9d 60 0c 33 69 e7 bc  f6 83 2d 03 28 8e dc 20  |..`.3i....-.(.. |
-00000260  15 71 10 dc 8e b2 e0 a3  4e 68 0c 6d a9 34 f0 e3  |.q......Nh.m.4..|
-00000270  8a 24 e6 ba 6b 8c c1 23  ae 5d c4 2d cd 21 9e e1  |.$..k..#.].-.!..|
-00000280  13 84 a4 1b 10 df 43 f2  4d 04 93 46 51 c7 36 0b  |......C.M..FQ.6.|
-00000290  ca e2 dc 35 2a 80 18 e5  72 06 c0 51 81 21 2f 62  |...5*...r..Q.!/b|
-000002a0  60 a7 f9 f3 d3 85 5f 22  4b 78 62 76 70 db 8c f0  |`....._"Kxbvp...|
-000002b0  0a 29 d1 ab 64 c5 d5 45  dc 14 03 03 00 01 01 16  |.)..d..E........|
-000002c0  03 03 00 28 00 00 00 00  00 00 00 00 63 18 f4 94  |...(........c...|
-000002d0  17 00 8b 17 4e b6 3d e7  d5 24 e6 a8 a6 90 fa bd  |....N.=..$......|
-000002e0  3e e4 78 bf 4e 50 ae 92  1f bb 27 7b              |>.x.NP....'{|
+00000230  88 0f 00 00 84 05 01 00  80 05 9b 97 90 30 0b 21  |.............0.!|
+00000240  ed 52 16 19 e0 54 7d 59  42 17 94 81 9b 2c b6 5b  |.R...T}YB....,.[|
+00000250  7f 7c 8e a5 bf 27 a9 25  14 74 f0 37 fa 6e 2b 84  |.|...'.%.t.7.n+.|
+00000260  80 a4 cd ae a6 8a 1b 62  2d 5e 03 ff 70 55 d7 99  |.......b-^..pU..|
+00000270  68 3c b3 0e 03 41 ae af  c6 3e 09 d4 16 8e 06 71  |h<...A...>.....q|
+00000280  14 f8 90 97 cd f6 eb 7d  90 3c d1 f3 95 db 35 3c  |.......}.<....5<|
+00000290  c9 7d dc 30 55 e1 a0 66  8e 26 20 4f 43 89 08 6f  |.}.0U..f.& OC..o|
+000002a0  95 58 42 ae e8 6c b6 77  45 c6 8c c7 ad e5 ed ff  |.XB..l.wE.......|
+000002b0  09 6f 2e 7e b0 e4 5c f2  db 14 03 03 00 01 01 16  |.o.~..\.........|
+000002c0  03 03 00 28 00 00 00 00  00 00 00 00 c0 2c cc 32  |...(.........,.2|
+000002d0  78 5e 6c 3e e9 a3 83 65  b4 bb 4e 79 b2 04 08 30  |x^l>...e..Ny...0|
+000002e0  09 e9 04 99 70 48 44 95  26 b0 37 c9              |....pHD.&.7.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 bc 3c df ab 59  |..........(.<..Y|
-00000010  84 ac 66 96 2a 71 da 4c  6d 43 69 c9 62 44 e2 2a  |..f.*q.LmCi.bD.*|
-00000020  36 cc a7 c6 ef df 3f 95  8a 07 d4 95 fc 84 7d 88  |6.....?.......}.|
-00000030  98 70 c8                                          |.p.|
+00000000  14 03 03 00 01 01 16 03  03 00 28 5f 80 e2 f1 78  |..........(_...x|
+00000010  0f cb 58 5c 3c 50 4c 1e  33 8a 1f b7 89 92 37 11  |..X\<PL.3.....7.|
+00000020  a3 8a 76 39 4a 3d b0 1f  a3 e9 ba 52 f8 2b e5 a3  |..v9J=.....R.+..|
+00000030  59 7c ac                                          |Y|.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 d3 a5 de  |................|
-00000010  f4 95 bc eb 72 cc 58 ea  10 ed 66 20 29 4c a1 ff  |....r.X...f )L..|
-00000020  e5 28 56 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.(V.............|
-00000030  bf b4 94 6d 93 b1 be 47  dd 79 3f b4 b4 91 e8 8d  |...m...G.y?.....|
-00000040  65 d6                                             |e.|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 75 dc 54  |.............u.T|
+00000010  d9 c5 b1 c2 c9 64 9a ea  20 e5 76 61 6c 05 af 33  |.....d.. .val..3|
+00000020  6b bc d7 15 03 03 00 1a  00 00 00 00 00 00 00 02  |k...............|
+00000030  24 6b 03 76 d3 da d0 ee  a6 32 c3 58 a1 5e a5 21  |$k.v.....2.X.^.!|
+00000040  b8 3a                                             |.:|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES
index 571444adab..5d795e791f 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 cc ba 3b af 48  |....Y...U....;.H|
-00000010  3b 97 a2 49 16 17 cc 05  1b 5e 7d aa b1 5b d9 6a  |;..I.....^}..[.j|
-00000020  a8 58 3b f6 d0 bc 5a 25  17 4c 78 20 6f 77 88 e6  |.X;...Z%.Lx ow..|
-00000030  da 0d 64 f7 26 dd e5 33  3d 67 86 a5 93 38 54 68  |..d.&..3=g...8Th|
-00000040  f6 57 eb e7 ad eb 1e 6e  86 9e 5b 05 c0 09 00 00  |.W.....n..[.....|
+00000000  16 03 03 00 59 02 00 00  55 03 03 c3 2f 08 30 ba  |....Y...U.../.0.|
+00000010  5d 9e 55 ef 23 f9 8a 0d  2f b4 25 02 5f c0 d2 c2  |].U.#.../.%._...|
+00000020  50 7c da db a4 ee 7c 18  df af aa 20 f3 a5 02 de  |P|....|.... ....|
+00000030  54 9f ce b9 6d 69 66 5d  57 76 ff 18 91 d3 93 ab  |T...mif]Wv......|
+00000040  39 13 29 4c b9 a7 3c db  7f 4d 97 fc c0 09 00 00  |9.)L..<..M......|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -49,39 +49,39 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 b7 0c 00  00 b3 03 00 1d 20 90 28  |*............ .(|
-00000280  b7 79 32 a9 4a 79 c7 fc  d9 d6 e9 f6 2b b9 e0 38  |.y2.Jy......+..8|
-00000290  2b a8 90 54 f8 f4 4c bd  de ab ea cf 1f 08 04 03  |+..T..L.........|
-000002a0  00 8b 30 81 88 02 42 01  6f ee c9 73 6e 16 d8 36  |..0...B.o..sn..6|
-000002b0  70 c9 84 9c 65 6a d8 f1  b2 8b 9f 49 bc e1 2c 80  |p...ej.....I..,.|
-000002c0  fb ff 9d 5e 96 4b b3 5a  0e 99 70 bc f6 0c 47 35  |...^.K.Z..p...G5|
-000002d0  fc 04 80 f4 4c 31 5d a9  08 db 9c e5 82 59 0a 9a  |....L1]......Y..|
-000002e0  d0 23 ee f5 10 5e fb 07  c6 02 42 00 e2 f8 2a 1a  |.#...^....B...*.|
-000002f0  53 77 ae a1 f8 ca 16 90  5c 97 df 31 3b de 7b f4  |Sw......\..1;.{.|
-00000300  e0 87 de 2f d1 0e 1c e2  50 bb f6 53 51 79 97 02  |.../....P..SQy..|
-00000310  2e 12 0a 26 45 a4 4f 54  31 79 f6 ec d9 c1 3a 9d  |...&E.OT1y....:.|
-00000320  a0 24 f0 4c 91 d4 c3 25  ba 1f 76 f8 22 16 03 03  |.$.L...%..v."...|
-00000330  00 04 0e 00 00 00                                 |......|
+00000270  2a 16 03 03 00 b6 0c 00  00 b2 03 00 1d 20 46 07  |*............ F.|
+00000280  78 fd 3b 0c e0 2c 96 f8  44 b9 e9 06 e9 66 17 35  |x.;..,..D....f.5|
+00000290  c0 92 87 51 f6 e3 d7 f5  09 50 56 c6 e9 3b 04 03  |...Q.....PV..;..|
+000002a0  00 8a 30 81 87 02 41 5d  88 4b fe eb 45 ee 5e 9f  |..0...A].K..E.^.|
+000002b0  ec 20 90 1f 41 aa 47 87  f7 ae 46 71 dc 55 8b 2c  |. ..A.G...Fq.U.,|
+000002c0  ce 70 5f ad 3e fa 3c c3  cb 77 d2 69 67 25 27 08  |.p_.>.<..w.ig%'.|
+000002d0  23 de 52 3c 0e 6c ca 8f  86 8f 61 cd 5b cf d8 42  |#.R<.l....a.[..B|
+000002e0  aa 5a 95 aa 4b d4 d9 f3  02 42 01 81 78 53 9c bd  |.Z..K....B..xS..|
+000002f0  af 7e d9 be 26 07 24 11  ca 4b 1d dd 2b 49 ec 35  |.~..&.$..K..+I.5|
+00000300  25 8d 58 87 ad 80 4f 90  c7 f8 a4 b9 c2 75 b5 12  |%.X...O......u..|
+00000310  a7 2c 49 82 76 e8 ce c4  a7 23 68 75 fc 88 82 13  |.,I.v....#hu....|
+00000320  27 55 a7 50 3c d6 d0 ae  e3 88 94 b4 16 03 03 00  |'U.P<...........|
+00000330  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
 00000030  16 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000040  00 00 00 00 00 a6 6f ce  95 59 bb 73 cf f9 09 cf  |......o..Y.s....|
-00000050  46 e1 2d 5e 65 b3 05 98  5f 80 de 93 0d 8c 0c 5c  |F.-^e..._......\|
-00000060  ff 11 94 b8 ed e6 4c 1b  cf dd 93 9d b9 1d 54 9e  |......L.......T.|
-00000070  6c 02 17 68 d4                                    |l..h.|
+00000040  00 00 00 00 00 04 f4 cc  a8 9f 48 44 ca 19 e6 4c  |..........HD...L|
+00000050  3d 51 f2 29 40 0b 70 06  09 f0 69 5c 51 78 51 1e  |=Q.)@.p...i\QxQ.|
+00000060  2b d1 47 22 8d d6 fb f5  41 bd e4 fd 3d f4 1b 48  |+.G"....A...=..H|
+00000070  44 96 2d 97 b9                                    |D.-..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 24 e7 00 f7 28  |..........@$...(|
-00000010  db 79 5f 29 87 c4 8d 87  9c fc a7 a8 43 13 53 70  |.y_)........C.Sp|
-00000020  3b 67 bf 4b 06 76 e5 d0  88 82 79 c4 ea f0 3e c1  |;g.K.v....y...>.|
-00000030  39 5b 80 54 b9 7e 48 71  21 d5 58 de 4b 36 ff b6  |9[.T.~Hq!.X.K6..|
-00000040  5a 74 8d 76 77 1c ae 1e  e7 cb ea                 |Zt.vw......|
+00000000  14 03 03 00 01 01 16 03  03 00 40 f1 a2 70 ba 50  |..........@..p.P|
+00000010  9d 7a 9f 8f c6 fb 7e 83  75 bd 94 cf e6 c1 4a f0  |.z....~.u.....J.|
+00000020  e6 54 e9 2c 30 23 a2 5c  c2 09 32 d4 06 f7 54 e7  |.T.,0#.\..2...T.|
+00000030  ab 27 a6 66 ab 86 e6 2c  20 12 cf 61 4d ef 12 20  |.'.f..., ..aM.. |
+00000040  ba b6 42 39 b7 76 b9 1b  fc f4 44                 |..B9.v....D|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 74 3d bf  2b f1 04 fc f9 c0 df 76  |.....t=.+......v|
-00000020  d8 e3 42 b5 7a ad 59 8a  d2 62 d0 9e 8f ad f6 60  |..B.z.Y..b.....`|
-00000030  e3 4c 93 29 db 15 03 03  00 30 00 00 00 00 00 00  |.L.).....0......|
-00000040  00 00 00 00 00 00 00 00  00 00 e7 b6 9c 5c 9f 5f  |.............\._|
-00000050  d3 4c e5 9c 64 10 0b 85  df fd 5f 88 3d 23 cd 22  |.L..d....._.=#."|
-00000060  e4 43 c4 ce fd 4a c0 be  7d a3                    |.C...J..}.|
+00000010  00 00 00 00 00 0b 5b d0  ab 14 3f ae 1f 4b 12 25  |......[...?..K.%|
+00000020  05 2a 67 11 0c 17 42 1b  b6 d2 af 16 40 26 fd 7b  |.*g...B.....@&.{|
+00000030  d7 57 10 2a f8 15 03 03  00 30 00 00 00 00 00 00  |.W.*.....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 83 54 64 d6 31 32  |...........Td.12|
+00000050  55 62 32 49 b9 54 7b e3  34 02 1c 75 e3 1b 5a 41  |Ub2I.T{.4..u..ZA|
+00000060  a2 cd 47 26 f0 ed c2 d5  41 34                    |..G&....A4|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM
index 810c18c490..28a9ef7c65 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 a3 a9 01 44 b1  |....Y...U.....D.|
-00000010  c8 87 6e ff 14 27 1c e0  76 38 b5 0b 40 41 5e b1  |..n..'..v8..@A^.|
-00000020  d8 72 13 77 6c 43 fb 17  3c eb 01 20 0e 69 39 c1  |.r.wlC..<.. .i9.|
-00000030  69 15 71 5e 9a bc f5 86  5d f2 f9 c8 12 42 f8 a6  |i.q^....]....B..|
-00000040  29 42 30 76 bb c6 e5 de  66 da 3b 05 c0 2b 00 00  |)B0v....f.;..+..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 72 81 c3 91 37  |....Y...U..r...7|
+00000010  54 37 fb 0f 2b 16 3b 7b  bc a6 d9 2e e2 83 23 83  |T7..+.;{......#.|
+00000020  b3 67 cf 36 dc 65 8d a6  3d cb 72 20 ac b9 b9 48  |.g.6.e..=.r ...H|
+00000030  30 9d fe 67 09 39 f5 47  d2 9a c8 3e 22 02 50 5e  |0..g.9.G...>".P^|
+00000040  fd 02 c9 ff c1 84 2e 2e  ab 78 ef c6 c0 2b 00 00  |.........x...+..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -49,34 +49,34 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 b7 0c 00  00 b3 03 00 1d 20 4a a7  |*............ J.|
-00000280  d3 89 bd f0 46 ae 52 3b  3c 6c 92 77 ca fe 97 9f  |....F.R;<l.w....|
-00000290  1c ff 6e fc 1f 46 46 57  b4 75 a3 bc a6 53 04 03  |..n..FFW.u...S..|
-000002a0  00 8b 30 81 88 02 42 00  b2 6a ce c1 71 51 f4 e1  |..0...B..j..qQ..|
-000002b0  86 cb 55 40 00 e5 a0 62  f6 27 c2 23 d5 96 aa 66  |..U@...b.'.#...f|
-000002c0  14 36 eb 03 d9 be 01 9f  cb 7b 9e 91 44 81 5d 24  |.6.......{..D.]$|
-000002d0  8c b3 cb 29 47 c8 19 72  4e af 92 4e e1 04 4c 1b  |...)G..rN..N..L.|
-000002e0  12 1e ad 47 56 d9 7d 8a  94 02 42 01 95 dd 16 f5  |...GV.}...B.....|
-000002f0  fa b3 7a b8 d2 eb a0 e5  24 2e 8e fd 3d 5d 79 cb  |..z.....$...=]y.|
-00000300  7a 6f 48 40 f7 1e b8 6e  e6 0f 09 f4 1a ae 23 7b  |zoH@...n......#{|
-00000310  51 30 67 52 20 d7 03 85  43 a8 92 32 fa 83 8f f8  |Q0gR ...C..2....|
-00000320  b1 fb 71 6f b3 b8 34 e8  29 ba e3 26 e2 16 03 03  |..qo..4.)..&....|
-00000330  00 04 0e 00 00 00                                 |......|
+00000270  2a 16 03 03 00 b6 0c 00  00 b2 03 00 1d 20 b7 1c  |*............ ..|
+00000280  2f 05 5e c8 ae 68 6b 54  c5 88 19 cf 7c 04 b2 ed  |/.^..hkT....|...|
+00000290  8d 5a e9 7e 6b 50 8a ee  12 66 2d 6f e4 7a 04 03  |.Z.~kP...f-o.z..|
+000002a0  00 8a 30 81 87 02 42 01  8d 7e 23 bc d7 a7 ad 73  |..0...B..~#....s|
+000002b0  5f 45 9e 04 da 6e c0 34  a8 09 59 e3 bc ab 80 e1  |_E...n.4..Y.....|
+000002c0  d4 84 79 7d de 90 c1 f2  ea 95 ed fc 7e d3 f0 31  |..y}........~..1|
+000002d0  4c 9b da 82 a0 97 ed e6  c9 f2 b9 2a 0a 1e 0a 2c  |L..........*...,|
+000002e0  7f 1d 62 ea 11 a9 77 5e  2f 02 41 09 88 2b eb 84  |..b...w^/.A..+..|
+000002f0  4f 62 9a c9 8a 0b a2 c6  88 0e 3e d9 29 f0 2b ba  |Ob........>.).+.|
+00000300  08 40 b0 9c 17 70 d9 84  1e d3 39 ad 70 fc df 63  |.@...p....9.p..c|
+00000310  a0 f6 69 3c 19 ce 0b a5  95 d2 6a b1 46 b1 e5 ba  |..i<......j.F...|
+00000320  fd d2 67 4b 76 e3 eb b9  21 d0 7c 85 16 03 03 00  |..gKv...!.|.....|
+00000330  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 40 2f 97  |....(........@/.|
-00000040  9b c7 73 95 f0 c2 5d 70  bd 09 eb 6f cf ba 1c 42  |..s...]p...o...B|
-00000050  30 c4 6c 3d 9d fc d2 4e  dc 1e 5b 5c 2b           |0.l=...N..[\+|
+00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 32 49 7e  |....(........2I~|
+00000040  8f d6 2e 81 d7 03 a6 61  a3 04 98 81 95 84 58 d1  |.......a......X.|
+00000050  a2 33 fe 4a 5d cd 96 76  64 1e 1a 62 03           |.3.J]..vd..b.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 32 4f ac f9 b4  |..........(2O...|
-00000010  07 64 7f 6e 88 a6 c6 76  45 fc 63 ae 19 af a4 55  |.d.n...vE.c....U|
-00000020  1d d0 ab ad 81 0f 6e 20  c9 29 e1 1e 9e 19 2c ac  |......n .)....,.|
-00000030  68 5e f2                                          |h^.|
+00000000  14 03 03 00 01 01 16 03  03 00 28 28 14 2d ae 7c  |..........((.-.||
+00000010  b8 7d dc 27 b2 18 39 57  c8 be 5c 3d a3 ab fa 5a  |.}.'..9W..\=...Z|
+00000020  3d 55 1b 3d 31 77 95 af  42 86 af 2b e7 5a 98 40  |=U.=1w..B..+.Z.@|
+00000030  18 77 d1                                          |.w.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 31 b6 ad  |.............1..|
-00000010  67 67 4a 76 ce 08 e1 70  8e 76 7b 4d 8a a8 7f 9c  |ggJv...p.v{M....|
-00000020  05 3e 1f 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.>..............|
-00000030  60 fd 32 5b e3 f9 cf 4a  01 9e 5a 1d 97 33 9e 82  |`.2[...J..Z..3..|
-00000040  9e 10                                             |..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 30 50 2f  |.............0P/|
+00000010  36 4a 7c ee e6 f0 b9 b8  bf 4d e3 63 4d 5e 58 08  |6J|......M.cM^X.|
+00000020  ac ac 82 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
+00000030  80 e2 42 ca 91 65 04 4e  ca a8 6f 81 7c 30 c0 1f  |..B..e.N..o.|0..|
+00000040  aa 7b                                             |.{|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES128-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES128-SHA256
index 585afbaf79..831fa2101f 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES128-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES128-SHA256
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 00 49 d2 dd b7  |....Y...U...I...|
-00000010  58 8b 60 4b b7 df 87 44  1e c9 04 77 1b e5 95 dc  |X.`K...D...w....|
-00000020  44 f9 d1 7d e1 3a 00 bf  58 a6 52 20 a4 f6 7c 43  |D..}.:..X.R ..|C|
-00000030  ed c6 51 10 f9 4f ed c2  97 ca 06 a1 b2 80 b7 ad  |..Q..O..........|
-00000040  25 ae ca 90 f3 36 bf 6f  e9 f8 e7 ce c0 23 00 00  |%....6.o.....#..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 be c0 b6 d7 fe  |....Y...U.......|
+00000010  43 9d 21 1f 89 27 bd db  0a 9a 5a 44 dd 79 d1 f2  |C.!..'....ZD.y..|
+00000020  18 9a 2a 04 8c eb e6 a9  93 ef ee 20 35 48 44 08  |..*........ 5HD.|
+00000030  8c 7a 3e f6 0f d7 5f 33  54 60 0b c9 65 4e 17 8d  |.z>..._3T`..eN..|
+00000040  d2 69 b7 20 0b c5 ba 9a  d4 b7 40 39 c0 23 00 00  |.i. ......@9.#..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -49,43 +49,43 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 b7 0c 00  00 b3 03 00 1d 20 b1 5f  |*............ ._|
-00000280  40 ca dd 4d 6d 01 43 2b  15 33 20 d9 bb 48 b9 b9  |@..Mm.C+.3 ..H..|
-00000290  03 0a 59 16 fc 77 86 3d  0f 7d 90 4d 67 54 04 03  |..Y..w.=.}.MgT..|
-000002a0  00 8b 30 81 88 02 42 01  8e 02 19 76 bc bf 30 db  |..0...B....v..0.|
-000002b0  98 5a e0 07 79 bd d1 b6  13 b6 cd b0 fc d9 30 24  |.Z..y.........0$|
-000002c0  3e 22 bc e6 87 a5 6a d3  6c a1 cc ef 43 91 5d eb  |>"....j.l...C.].|
-000002d0  1f e8 09 90 b2 06 6d 2c  cb cc d4 68 27 2b 7a be  |......m,...h'+z.|
-000002e0  6d 7b 10 96 d0 70 a5 70  32 02 42 01 43 e2 f9 8e  |m{...p.p2.B.C...|
-000002f0  d9 ef ca 5c 6c 90 18 07  db 22 21 33 0a 1f 6f d1  |...\l...."!3..o.|
-00000300  6d 6d 3a 46 81 2b 2b ee  ee 58 94 7a cd 7a a5 59  |mm:F.++..X.z.z.Y|
-00000310  b1 c3 c3 15 ef 9d 68 a5  8f 9d df 23 11 9c f0 49  |......h....#...I|
-00000320  ce 70 fd 74 77 ba 0a cd  b3 73 97 89 ad 16 03 03  |.p.tw....s......|
+00000270  2a 16 03 03 00 b7 0c 00  00 b3 03 00 1d 20 0e 53  |*............ .S|
+00000280  82 54 1a ba f8 a4 52 1d  6d b8 70 18 41 e8 67 f9  |.T....R.m.p.A.g.|
+00000290  38 1e fb fa b8 89 2d d6  4d 1b ae 67 fe 75 04 03  |8.....-.M..g.u..|
+000002a0  00 8b 30 81 88 02 42 01  68 0e d4 92 a6 1a d9 66  |..0...B.h......f|
+000002b0  ff 0e ca 4c 32 b8 78 d3  52 d1 ad a2 32 83 f0 3c  |...L2.x.R...2..<|
+000002c0  43 e0 7e 92 94 e9 c6 99  00 d9 f7 06 c0 2c 72 c0  |C.~..........,r.|
+000002d0  9b f7 c0 ec 1f 23 8f b5  e5 74 9d ff 89 17 12 b4  |.....#...t......|
+000002e0  f1 f5 25 f7 2e 0d 78 f6  1c 02 42 01 fc da dd c8  |..%...x...B.....|
+000002f0  65 30 67 a3 ff 42 e3 37  19 ba 7c 04 6b a1 b3 97  |e0g..B.7..|.k...|
+00000300  b0 ca 8c 2d fc b0 40 1c  a1 d8 c9 64 fe df 48 3b  |...-..@....d..H;|
+00000310  07 57 1f 81 a2 3e a4 84  96 00 fb 55 29 1c 94 9d  |.W...>.....U)...|
+00000320  f9 0d a4 71 4f 5f fd c3  22 e2 88 07 21 16 03 03  |...qO_.."...!...|
 00000330  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
 00000030  16 03 03 00 50 00 00 00  00 00 00 00 00 00 00 00  |....P...........|
-00000040  00 00 00 00 00 9f b7 57  59 ea 5f 87 fe 2b b4 29  |.......WY._..+.)|
-00000050  a3 15 1a d2 c8 90 a1 46  f1 3d ce 43 40 ec 54 19  |.......F.=.C@.T.|
-00000060  80 12 61 b8 1f de 80 e1  14 94 9b e5 aa 9c e3 b3  |..a.............|
-00000070  fb 34 e1 ef 46 97 e7 7b  3f 47 15 84 86 a8 bb 8d  |.4..F..{?G......|
-00000080  8c 4d 5e 93 27                                    |.M^.'|
+00000040  00 00 00 00 00 7c e9 97  4b 98 8a 4c 59 95 3e 31  |.....|..K..LY.>1|
+00000050  c4 b6 e2 79 10 de bc 8e  aa 1e 52 07 b2 e1 52 bc  |...y......R...R.|
+00000060  3b da 8d 5f 12 6a 18 d1  0a 5d 93 1c ad bb f9 b7  |;.._.j...]......|
+00000070  6b 58 49 39 ea 3a 9e 20  47 69 43 b4 b4 d8 16 d0  |kXI9.:. GiC.....|
+00000080  f0 9d 36 74 04                                    |..6t.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 50 8d d4 d3 b9 3a  |..........P....:|
-00000010  e6 52 2f ca 1c 86 f6 ca  66 a1 27 51 0a b7 d0 8d  |.R/.....f.'Q....|
-00000020  bf bc df f3 af 7d e5 6e  33 a3 49 82 20 fd 70 80  |.....}.n3.I. .p.|
-00000030  1c 7b 6a a5 10 9a b8 51  b6 8f 2a 19 61 82 1f 47  |.{j....Q..*.a..G|
-00000040  65 87 0c dd 71 51 ab 2b  97 b9 d9 4d ca 09 84 de  |e...qQ.+...M....|
-00000050  ef a2 4a 15 41 fa d0 0d  8b c0 8c                 |..J.A......|
+00000000  14 03 03 00 01 01 16 03  03 00 50 60 d5 ac 39 b6  |..........P`..9.|
+00000010  58 50 03 90 9f c9 78 f1  45 43 b1 34 bd c8 29 65  |XP....x.EC.4..)e|
+00000020  54 38 7a 88 46 15 e8 a4  fb 9d 80 4e d6 45 e1 8d  |T8z.F......N.E..|
+00000030  27 d6 09 66 1d ee 46 6d  dd 8e 89 34 0f 4a fb fd  |'..f..Fm...4.J..|
+00000040  bc 85 08 07 f0 5b 1c 24  e2 11 1b e2 a4 94 f5 80  |.....[.$........|
+00000050  fa 47 f4 62 0e b9 1c 31  cb 7b bf                 |.G.b...1.{.|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000010  00 00 00 00 00 62 2c 4f  5b fa b8 8a ac ee 13 c3  |.....b,O[.......|
-00000020  e2 d7 de 8e 16 0f af fb  1f 65 a5 ba 5e b6 aa 11  |.........e..^...|
-00000030  0c 22 e1 7d 74 57 e4 0b  8c c9 cf fa 41 82 28 cc  |.".}tW......A.(.|
-00000040  91 32 96 c8 7d 15 03 03  00 40 00 00 00 00 00 00  |.2..}....@......|
-00000050  00 00 00 00 00 00 00 00  00 00 9d 9e f4 64 68 31  |.............dh1|
-00000060  86 ba eb f3 35 23 61 ff  25 d6 48 c6 7b 14 4f 07  |....5#a.%.H.{.O.|
-00000070  86 1a 47 48 75 37 f5 08  4c a2 64 cd 9e fa 0c 21  |..GHu7..L.d....!|
-00000080  6e 2a 66 b4 ba 61 d5 cc  a5 5b                    |n*f..a...[|
+00000010  00 00 00 00 00 37 b7 23  a2 06 97 f3 60 9a f0 7e  |.....7.#....`..~|
+00000020  b7 11 6d 0d 66 0e db 38  1a eb cd 72 80 c8 54 ef  |..m.f..8...r..T.|
+00000030  cf 90 6d 22 68 41 63 03  46 b9 28 4f 2f d6 fe fa  |..m"hAc.F.(O/...|
+00000040  b2 91 07 36 71 15 03 03  00 40 00 00 00 00 00 00  |...6q....@......|
+00000050  00 00 00 00 00 00 00 00  00 00 ca 17 d9 fd 1a 0e  |................|
+00000060  21 db a4 92 dc 92 e8 89  9d 14 6b 8a d3 ee a7 95  |!.........k.....|
+00000070  c0 91 8d 3c af 5a 48 d5  c6 2f 66 b8 b8 d4 ce f9  |...<.ZH../f.....|
+00000080  59 e5 e0 e2 df e5 7e ea  94 03                    |Y.....~...|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384 b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384
index c413dfde3b..c22edd05e0 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 25 53 12 07 e9  |....Y...U..%S...|
-00000010  0c 84 dd 43 23 7e 89 4d  de 4f d2 a6 86 1f be f1  |...C#~.M.O......|
-00000020  33 4c 11 b1 c7 ab 97 5a  ce a0 af 20 1d 1d 0d d6  |3L.....Z... ....|
-00000030  44 8e e8 14 aa c3 07 ac  26 f9 4b 62 2f ab 1d 83  |D.......&.Kb/...|
-00000040  0c 0e f4 99 c9 1b 63 83  6f 9b 0e 26 c0 2c 00 00  |......c.o..&.,..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 e6 0e 27 a7 58  |....Y...U....'.X|
+00000010  1d a3 1d 1d 21 64 31 f6  1e bc 28 b4 46 7e 26 be  |....!d1...(.F~&.|
+00000020  de 0a 65 eb f0 18 dc 7f  3e 1b 55 20 fe 66 50 20  |..e.....>.U .fP |
+00000030  f0 f0 48 a8 db 0a ff ee  60 ea 3d 7f 07 5e b9 65  |..H.....`.=..^.e|
+00000040  c3 e4 2a 19 9c bd 57 36  ca e3 a7 2d c0 2c 00 00  |..*...W6...-.,..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
 00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
@@ -49,34 +49,34 @@
 00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
 00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
 00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 b7 0c 00  00 b3 03 00 1d 20 0d ae  |*............ ..|
-00000280  d8 d1 97 30 6d b0 2f a9  d5 42 5d 36 7c 86 19 3d  |...0m./..B]6|..=|
-00000290  1c ad fe 32 a7 09 c7 b7  5c 13 3a 36 39 1a 04 03  |...2....\.:69...|
-000002a0  00 8b 30 81 88 02 42 01  61 83 4b 88 59 3b 1a 77  |..0...B.a.K.Y;.w|
-000002b0  b3 bf d9 dc f5 49 ba c8  9e 68 f2 df ed ab 19 f9  |.....I...h......|
-000002c0  b1 2d cb d9 35 b2 03 59  9f 11 dd 3f 48 a0 b6 15  |.-..5..Y...?H...|
-000002d0  3b df e6 3d bf 3e 51 ac  92 cc 55 32 81 11 95 85  |;..=.>Q...U2....|
-000002e0  50 7d b2 7e 81 3e 9a b2  2e 02 42 00 a3 24 28 c0  |P}.~.>....B..$(.|
-000002f0  56 f8 20 29 77 f4 3d ff  2d 09 36 58 31 cf 9d d5  |V. )w.=.-.6X1...|
-00000300  9c b6 df 95 b1 5f f7 88  2b 09 a3 58 17 41 79 ae  |....._..+..X.Ay.|
-00000310  9e 6a 80 6a a6 d2 64 77  1b 79 44 55 bc af 8f df  |.j.j..dw.yDU....|
-00000320  07 58 fe e7 97 4b d7 39  3f 8a 10 ae 0d 16 03 03  |.X...K.9?.......|
+00000270  2a 16 03 03 00 b7 0c 00  00 b3 03 00 1d 20 17 21  |*............ .!|
+00000280  a9 b8 65 8b aa 41 d2 d1  45 45 e5 ce 39 60 54 b6  |..e..A..EE..9`T.|
+00000290  43 9f c4 19 a4 aa ec 71  08 b0 d1 22 f7 46 04 03  |C......q...".F..|
+000002a0  00 8b 30 81 88 02 42 00  8b a5 d9 d3 8f a1 72 48  |..0...B.......rH|
+000002b0  06 42 25 c3 f6 c8 46 8d  88 30 36 7d d8 18 a9 cc  |.B%...F..06}....|
+000002c0  de e4 c8 3f e9 d2 f0 88  18 cc c6 fb 14 e0 05 b1  |...?............|
+000002d0  ec 50 3d 57 b4 e9 83 57  55 4b 0d 2c 89 69 ff b1  |.P=W...WUK.,.i..|
+000002e0  58 0b 01 89 48 97 ee 88  7e 02 42 01 e1 6f 9c 36  |X...H...~.B..o.6|
+000002f0  6a 6c 86 24 d6 b3 45 f1  6c 03 d8 fd da d8 cc 52  |jl.$..E.l......R|
+00000300  04 41 7a c5 f9 b5 91 a5  6c d8 5a 03 ad de e3 da  |.Az.....l.Z.....|
+00000310  de f8 db b0 bc 75 38 03  ab 84 ac 3f b2 c2 7e 6d  |.....u8....?..~m|
+00000320  a7 2e c0 d9 bd 85 e2 7b  36 11 2b 12 14 16 03 03  |.......{6.+.....|
 00000330  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 53 ce b7  |....(........S..|
-00000040  2e 05 87 4b dc da ee 78  8e b9 24 7c 79 a3 29 c2  |...K...x..$|y.).|
-00000050  03 35 d5 81 91 4a a7 b5  d4 86 a0 76 91           |.5...J.....v.|
+00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 4b a3 cc  |....(........K..|
+00000040  a1 5b 04 d4 1e 6c 2c 26  56 23 62 50 bc d6 90 0b  |.[...l,&V#bP....|
+00000050  67 41 d9 7c 79 a5 53 54  73 0a 93 e2 73           |gA.|y.STs...s|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 fc 0c 83 69 48  |..........(...iH|
-00000010  3c ef b2 24 08 0b 80 4f  37 48 a1 47 21 b1 99 d9  |<..$...O7H.G!...|
-00000020  06 1e db 1b 13 21 18 99  ad 2d a9 7e 66 1f 00 39  |.....!...-.~f..9|
-00000030  53 2f 36                                          |S/6|
+00000000  14 03 03 00 01 01 16 03  03 00 28 e3 19 7b 8c 8a  |..........(..{..|
+00000010  52 35 82 cc 70 50 83 22  88 8b 0a 54 bc eb ff 57  |R5..pP."...T...W|
+00000020  2c df 0d 50 d6 21 2f d2  d9 e8 15 27 b9 d7 01 a3  |,..P.!/....'....|
+00000030  f2 62 0b                                          |.b.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 c2 08 d0  |................|
-00000010  5a f6 bd a8 68 a9 91 91  be b8 d9 bb 71 96 c7 e0  |Z...h.......q...|
-00000020  0e 30 10 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.0..............|
-00000030  b9 c5 46 64 12 c1 bb 38  69 1b 59 59 f0 69 75 01  |..Fd...8i.YY.iu.|
-00000040  3f 8b                                             |?.|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 cc cf 92  |................|
+00000010  4d 25 58 96 1d dc df fb  d9 1f a5 49 87 45 dd 73  |M%X........I.E.s|
+00000020  1a 17 ae 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
+00000030  fb b5 c5 e4 aa ea e7 7e  ff dd f7 11 63 c0 e4 a3  |.......~....c...|
+00000040  86 fc                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES
index cf9d149bff..45728cfbe7 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 38 32 f1 94 2f  |....Y...U..82../|
-00000010  66 62 c3 36 54 d2 56 0d  0c 10 41 47 78 cb 38 0b  |fb.6T.V...AGx.8.|
-00000020  d5 09 34 55 e1 1c 00 d8  dc 60 cf 20 20 98 6e f8  |..4U.....`.  .n.|
-00000030  d4 01 2d 22 7c 9b 06 60  af 94 5b e7 d5 ce 1c eb  |..-"|..`..[.....|
-00000040  20 c2 7b ec c5 e9 09 d4  1f 63 4c 29 c0 13 00 00  | .{......cL)....|
+00000000  16 03 03 00 59 02 00 00  55 03 03 2f 51 e0 81 eb  |....Y...U../Q...|
+00000010  d2 db 4f 22 fa 11 d2 56  f3 06 d6 a0 97 d2 f3 74  |..O"...V.......t|
+00000020  fc a9 a7 73 ba a8 ee f2  05 89 15 20 0f 96 70 60  |...s....... ..p`|
+00000030  6f 78 aa 56 fa 92 5e e3  bc e7 f0 40 00 48 8b 84  |ox.V..^....@.H..|
+00000040  57 b8 49 e9 f9 00 99 ff  73 29 f6 e7 c0 13 00 00  |W.I.....s)......|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -54,38 +54,38 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 12 34 a3 04 5f 07 78  |........ .4.._.x|
-000002d0  27 c5 3f 34 a9 7e 50 01  66 a8 54 65 7b 12 93 61  |'.?4.~P.f.Te{..a|
-000002e0  40 d0 8d 22 55 ad f1 56  7f 04 01 00 80 58 2b 24  |@.."U..V.....X+$|
-000002f0  66 a3 b3 31 45 18 63 13  e1 7f 2d 45 b9 13 30 89  |f..1E.c...-E..0.|
-00000300  43 85 1d bc 0e f9 90 85  4d c5 db 78 81 02 78 0c  |C.......M..x..x.|
-00000310  ca fa 9d 61 46 04 7f 1b  29 81 7f 68 b1 11 12 63  |...aF...)..h...c|
-00000320  07 b9 c4 a2 1b 60 d9 88  ca 81 4a 9f 13 65 3b 85  |.....`....J..e;.|
-00000330  7f 2a 69 a4 23 d6 7d 2b  be 33 2d be e3 ae ab 57  |.*i.#.}+.3-....W|
-00000340  a1 b0 3f 32 40 c3 c6 8d  5f d2 a8 9b 7c 5a cf f7  |..?2@..._...|Z..|
-00000350  ea 26 bc ef 9d 01 71 4a  b3 c7 04 7d f7 90 f3 a9  |.&....qJ...}....|
-00000360  a9 18 fe ed c1 11 86 09  f8 3e 25 24 53 16 03 03  |.........>%$S...|
+000002c0  ac 0c 00 00 a8 03 00 1d  20 48 77 87 3e 04 c9 14  |........ Hw.>...|
+000002d0  56 9d 1b 41 4b d0 eb 65  8d 56 56 97 fd 73 97 cd  |V..AK..e.VV..s..|
+000002e0  c6 88 8f 8e 79 99 09 65  53 04 01 00 80 98 c2 ff  |....y..eS.......|
+000002f0  49 aa 41 ce 0e 7b 03 99  39 c0 b5 ac 72 16 1c 5e  |I.A..{..9...r..^|
+00000300  a0 92 f1 07 0c 93 dc f6  25 2b 5c be e3 65 41 a9  |........%+\..eA.|
+00000310  1e 57 6d 9f 28 50 ca 87  2f c7 b0 15 2e 15 d2 cc  |.Wm.(P../.......|
+00000320  4d 0e 42 4c 0a 01 4d 1b  9c d1 17 e7 22 9a 6a a9  |M.BL..M.....".j.|
+00000330  27 0b 7a a7 32 e3 c7 5a  d1 7f f2 1c 45 61 91 a8  |'.z.2..Z....Ea..|
+00000340  e0 e0 49 de b7 2f a6 89  63 94 ed 0e 63 15 6b 4f  |..I../..c...c.kO|
+00000350  fb 62 c4 35 cb 98 89 c2  d1 bc f6 e2 2d 8f 9f 72  |.b.5........-..r|
+00000360  56 79 50 5f cd 73 00 f1  65 bf a4 3f 87 16 03 03  |VyP_.s..e..?....|
 00000370  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
 00000030  16 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000040  00 00 00 00 00 ba e9 52  18 ee 63 97 4c 29 49 0f  |.......R..c.L)I.|
-00000050  bb 95 42 f0 4d cd 6e c4  cd 24 36 94 76 50 e7 67  |..B.M.n..$6.vP.g|
-00000060  cc 9f d1 3f d9 1c 2e 84  c7 bb 51 c5 13 32 84 1d  |...?......Q..2..|
-00000070  c5 c7 51 ef 69                                    |..Q.i|
+00000040  00 00 00 00 00 93 4b 37  8d 57 43 52 77 56 d2 af  |......K7.WCRwV..|
+00000050  7c 56 d0 bf 1e 7b 29 55  3e b7 d0 1c 02 2e 0d de  ||V...{)U>.......|
+00000060  09 66 f2 98 21 57 ab d2  d2 4a 73 c1 c5 fe f1 b8  |.f..!W...Js.....|
+00000070  95 d3 fc 70 ce                                    |...p.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 dd 38 41 53 63  |..........@.8ASc|
-00000010  d4 07 dd ce 6b 26 a2 86  9e ba 83 1d 56 ac e3 59  |....k&......V..Y|
-00000020  07 9c 27 0b 86 f7 51 66  fa 3c 5a 72 28 af 2e e9  |..'...Qf.<Zr(...|
-00000030  ca b8 ac 91 c1 89 49 d1  47 09 f4 0f 4b 9c 75 e2  |......I.G...K.u.|
-00000040  d1 c5 20 fe da c9 e8 ce  0e da 7b                 |.. .......{|
+00000000  14 03 03 00 01 01 16 03  03 00 40 b3 e1 81 3e 0a  |..........@...>.|
+00000010  f8 f3 c6 05 c1 09 f5 73  01 eb 18 1a 05 fa 2f 9b  |.......s....../.|
+00000020  b2 bc c7 44 23 38 ed b9  99 a0 56 7d 8b e4 a5 4b  |...D#8....V}...K|
+00000030  f1 89 45 bc 95 ea 06 a8  48 de 07 bf d5 cb 53 bc  |..E.....H.....S.|
+00000040  50 fa 25 fb d5 79 17 ec  4d be 3d                 |P.%..y..M.=|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 a2 50 3f  eb 7c 39 a1 21 87 f9 8a  |......P?.|9.!...|
-00000020  55 de 65 45 43 ae de 8c  a3 0f ef 56 dc 8c 0b 71  |U.eEC......V...q|
-00000030  07 ea 4f 52 8d 15 03 03  00 30 00 00 00 00 00 00  |..OR.....0......|
-00000040  00 00 00 00 00 00 00 00  00 00 e0 66 38 fb 98 f1  |...........f8...|
-00000050  44 af e2 f6 d2 1d 0d e9  47 23 57 89 00 26 02 51  |D.......G#W..&.Q|
-00000060  d7 0f d2 a3 06 dc 72 b6  7e 0e                    |......r.~.|
+00000010  00 00 00 00 00 3e 90 61  a4 f1 53 ac 7b b2 9f 4e  |.....>.a..S.{..N|
+00000020  2c 16 5a 77 8b da 5d 68  5c 8b a8 6d 44 52 f3 ad  |,.Zw..]h\..mDR..|
+00000030  8e ba c8 89 2f 15 03 03  00 30 00 00 00 00 00 00  |..../....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 e5 01 5d ef 4c 0c  |............].L.|
+00000050  07 8f 21 99 60 83 ee 36  13 8e 25 15 32 85 a5 96  |..!.`..6..%.2...|
+00000060  36 90 60 49 4f c7 54 99  dd 76                    |6.`IO.T..v|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256
index ba2983ff79..6b02249f3f 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 cd 1e 03 fa a9  |....Y...U.......|
-00000010  7c d2 a2 c1 2e f9 22 1d  58 0f 1b 40 c9 17 57 a2  ||.....".X..@..W.|
-00000020  cd 7f a8 ee 5e 5f 4a b3  30 49 14 20 6d ff 6a 17  |....^_J.0I. m.j.|
-00000030  a6 30 74 f5 bc de 0e 43  16 10 a1 4d f5 a9 90 b8  |.0t....C...M....|
-00000040  ab c9 b9 af 6a 9f a2 6b  70 2c c2 69 c0 27 00 00  |....j..kp,.i.'..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 ab d3 05 5e d0  |....Y...U.....^.|
+00000010  80 0b 87 e9 43 26 e2 c9  28 04 3f eb 68 05 54 3d  |....C&..(.?.h.T=|
+00000020  9b 28 d0 4e d4 d9 25 e5  b0 27 2b 20 89 27 da d5  |.(.N..%..'+ .'..|
+00000030  3d 19 38 63 01 34 f6 43  1b a9 f7 09 12 7d 27 e1  |=.8c.4.C.....}'.|
+00000040  f6 23 b8 39 24 8b 1e c7  a3 2f 07 16 c0 27 00 00  |.#.9$..../...'..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -54,42 +54,42 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 86 06 90 6a e1 df 61  |........ ...j..a|
-000002d0  43 2a 25 80 42 80 ab c7  99 59 40 e4 e5 43 66 e1  |C*%.B....Y@..Cf.|
-000002e0  b6 96 a1 12 60 9b bc 07  50 04 01 00 80 4f 3e 31  |....`...P....O>1|
-000002f0  0a dd 7b 73 5d 8d b7 ed  77 9f 65 06 6b 5d b3 a4  |..{s]...w.e.k]..|
-00000300  54 0c db 5a 20 bb e0 ae  d9 9f bc 58 47 aa 62 55  |T..Z ......XG.bU|
-00000310  f1 70 9b fd b0 1b 55 d3  aa 2f 3e 7d 63 b0 fd 40  |.p....U../>}c..@|
-00000320  15 f3 47 9f f1 99 46 cf  c5 34 d4 81 39 4d 9c 12  |..G...F..4..9M..|
-00000330  8e 16 93 85 7a 9c aa ae  f6 28 48 81 1d f6 34 82  |....z....(H...4.|
-00000340  b4 ec 85 8a d6 21 c7 a3  ac df ec 25 0d 12 d6 b8  |.....!.....%....|
-00000350  e8 4d e8 69 89 cc 1a e3  c3 77 81 0e a1 8d 54 eb  |.M.i.....w....T.|
-00000360  e5 5f 50 be a4 e8 79 f7  fb 99 98 4a 13 16 03 03  |._P...y....J....|
+000002c0  ac 0c 00 00 a8 03 00 1d  20 ec 71 cc fb 07 bd 0f  |........ .q.....|
+000002d0  6b e0 e1 27 7f 62 59 06  09 3c 09 bc b1 c9 09 93  |k..'.bY..<......|
+000002e0  e9 b0 a4 5b f3 be 14 d1  3c 04 01 00 80 a9 c7 98  |...[....<.......|
+000002f0  ea ac 6a 9b 49 7c 72 45  4d 5c c8 4c d6 56 64 1b  |..j.I|rEM\.L.Vd.|
+00000300  44 7f 13 4f 2a ed e9 6b  c7 c0 a2 25 3b 7a 99 f4  |D..O*..k...%;z..|
+00000310  93 84 35 78 72 21 ca f6  29 1b 60 d7 f6 bd 31 5b  |..5xr!..).`...1[|
+00000320  7a fb 57 20 30 cc e6 90  07 b2 0e 08 82 86 56 a7  |z.W 0.........V.|
+00000330  55 00 fd f4 ce f4 b1 74  27 e9 0a 28 1c bc 56 47  |U......t'..(..VG|
+00000340  f7 18 3e 9e 9c 45 2d 1d  82 a8 66 51 27 25 be ec  |..>..E-...fQ'%..|
+00000350  cd 9e 83 89 7e e0 e3 0f  3b 7b 32 f2 26 7b 30 c8  |....~...;{2.&{0.|
+00000360  c1 e3 7b 4c f4 14 d5 51  ea b7 45 7a 59 16 03 03  |..{L...Q..EzY...|
 00000370  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
 00000030  16 03 03 00 50 00 00 00  00 00 00 00 00 00 00 00  |....P...........|
-00000040  00 00 00 00 00 1b f5 41  8d 0a 5c 6f 2b de 74 41  |.......A..\o+.tA|
-00000050  25 99 e0 e0 24 bb 7e 3d  85 62 96 cb e4 27 bb cb  |%...$.~=.b...'..|
-00000060  82 49 a6 4a 2c 27 f3 47  43 b5 b4 cd 26 aa 35 c0  |.I.J,'.GC...&.5.|
-00000070  af 6e 9a ca e1 ea 54 86  c2 0a 08 3d 42 67 7f d6  |.n....T....=Bg..|
-00000080  03 a0 18 42 dd                                    |...B.|
+00000040  00 00 00 00 00 76 d8 c4  58 a1 94 11 ab 19 4c 7b  |.....v..X.....L{|
+00000050  7c 34 d1 b6 8b 7f a2 96  41 e6 e9 98 d8 55 62 2b  ||4......A....Ub+|
+00000060  56 54 2a 65 25 f0 fa 15  ac cb b7 cc 3b 59 8b 99  |VT*e%.......;Y..|
+00000070  e9 be 9e fe 56 97 07 ae  39 38 a7 f4 f0 d0 e9 f5  |....V...98......|
+00000080  33 de 20 a6 04                                    |3. ..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 50 55 90 23 a2 84  |..........PU.#..|
-00000010  93 dd 42 57 d7 2f 20 14  b5 71 64 6e a0 b5 29 31  |..BW./ ..qdn..)1|
-00000020  b7 5c 15 ec 30 e7 c7 82  c3 f7 a6 54 d8 80 dc e7  |.\..0......T....|
-00000030  32 8c 65 cd 9c 65 36 a8  5f 8f 71 0d f4 f3 f4 c0  |2.e..e6._.q.....|
-00000040  ea 78 44 62 84 27 bd 09  6a d9 6b c4 6d 40 75 02  |.xDb.'..j.k.m@u.|
-00000050  9e fe e2 8e e6 1a a0 18  f2 f3 8b                 |...........|
+00000000  14 03 03 00 01 01 16 03  03 00 50 8c 0f 2a be cd  |..........P..*..|
+00000010  30 f7 46 cf 58 5b 38 88  86 5e d1 33 b1 61 d6 95  |0.F.X[8..^.3.a..|
+00000020  13 c7 e7 f2 fb bc 37 e5  a3 db ac a7 74 49 00 89  |......7.....tI..|
+00000030  db 94 25 aa 00 b6 b2 34  0a dd 97 bf fa cf 33 6e  |..%....4......3n|
+00000040  6e f7 ab bf 70 a6 85 91  9b 4f f2 86 15 83 60 0d  |n...p....O....`.|
+00000050  79 9e 11 51 17 a6 6f 06  2f 98 bc                 |y..Q..o./..|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000010  00 00 00 00 00 ee b7 c3  ba 79 9b 0d 6c 9f 8f da  |.........y..l...|
-00000020  60 65 68 7b 86 c8 21 35  5a 08 ba 8f f9 ac 36 d6  |`eh{..!5Z.....6.|
-00000030  9d af 28 bc 01 1a 07 3f  9b 23 32 05 9a b8 d4 99  |..(....?.#2.....|
-00000040  5d b0 4b 2e d3 15 03 03  00 40 00 00 00 00 00 00  |].K......@......|
-00000050  00 00 00 00 00 00 00 00  00 00 25 72 95 d3 f0 92  |..........%r....|
-00000060  8a ac 7e 45 41 f0 1d 61  44 55 12 05 75 e8 30 19  |..~EA..aDU..u.0.|
-00000070  8a d5 d1 96 64 bb 2f 9a  eb 49 4d 87 ce 5e e3 b6  |....d./..IM..^..|
-00000080  90 52 8d 52 87 e6 bc d8  ac 5a                    |.R.R.....Z|
+00000010  00 00 00 00 00 c3 c9 23  7b bd 57 1a 29 5f ac f6  |.......#{.W.)_..|
+00000020  8d bb 90 bb 48 8a 9a 75  65 3b 5b 52 c0 ee 0e 24  |....H..ue;[R...$|
+00000030  43 f6 62 1f 1e 51 36 4e  3e a3 e4 96 d8 2b d8 a7  |C.b..Q6N>....+..|
+00000040  d0 18 97 d7 1e 15 03 03  00 40 00 00 00 00 00 00  |.........@......|
+00000050  00 00 00 00 00 00 00 00  00 00 c0 c8 9f 7d df b1  |.............}..|
+00000060  78 72 b5 3d 0d 3e d9 88  38 c2 42 eb 2b 4d e0 b3  |xr.=.>..8.B.+M..|
+00000070  d7 69 19 31 57 16 7c 0a  bb 24 5b 9c 9b c2 4b b9  |.i.1W.|..$[...K.|
+00000080  55 ef ad 2c c1 eb 9b 59  06 5a                    |U..,...Y.Z|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4 b/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4
index 90a06782f2..74282d4b1a 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4
+++ b/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 51 02 00 00  4d 03 03 12 53 68 12 43  |....Q...M...Sh.C|
-00000010  a3 91 bb e6 22 05 1c d6  87 ad 68 d7 45 ea 3b 90  |....".....h.E.;.|
-00000020  7f f5 07 cf 6d c4 49 19  6d 53 7d 20 7f 55 1f 51  |....m.I.mS} .U.Q|
-00000030  cd 69 69 cf a1 50 aa 9a  fc 45 7a 3f e5 70 dd 71  |.ii..P...Ez?.p.q|
-00000040  cd 78 79 28 e2 36 ef 75  87 7c 84 5f 00 05 00 00  |.xy(.6.u.|._....|
+00000000  16 03 03 00 51 02 00 00  4d 03 03 ac bf 85 b8 5f  |....Q...M......_|
+00000010  56 44 a0 c5 3b 20 77 71  af de 34 bc 79 a0 a4 a7  |VD..; wq..4.y...|
+00000020  fa 2e cf b5 ee c5 a7 a2  5e 11 48 20 05 89 5e a6  |........^.H ..^.|
+00000030  cd ad 91 e4 be c3 c3 6c  6a 0e 1d ab 27 03 5e 0f  |.......lj...'.^.|
+00000040  05 9d ef b0 63 8d 2d b6  29 08 66 e3 00 05 00 00  |....c.-.).f.....|
 00000050  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
 00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
 00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
@@ -64,15 +64,15 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 03 00 24 66 80  5a e0 f0 3a 90 d7 30 b9  |.....$f.Z..:..0.|
-000000a0  14 9d e5 34 27 c1 da 12  43 62 3d e2 11 ae 80 52  |...4'...Cb=....R|
-000000b0  97 07 7b 50 64 fc 8b 5f  82 b8                    |..{Pd.._..|
+00000090  01 16 03 03 00 24 e1 ef  77 60 cf 7a 44 79 74 59  |.....$..w`.zDytY|
+000000a0  ff 81 72 b9 b5 f5 97 af  60 59 78 f5 01 49 2d bb  |..r.....`Yx..I-.|
+000000b0  4a ec 98 1f f5 31 f4 00  a2 f3                    |J....1....|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 24 ff 23 b0 21 e6  |..........$.#.!.|
-00000010  01 06 83 ac 3b f0 82 74  67 12 f5 43 63 dd a8 c7  |....;..tg..Cc...|
-00000020  21 27 82 5c ef bf 1e 5b  78 94 9a bb e3 dd c9     |!'.\...[x......|
+00000000  14 03 03 00 01 01 16 03  03 00 24 52 fd a3 51 aa  |..........$R..Q.|
+00000010  ee 9d 4d be 8c 08 32 f6  f7 4a a5 26 26 6c b2 5a  |..M...2..J.&&l.Z|
+00000020  49 7f 31 7d 44 b1 83 67  19 4a e3 07 7d 59 34     |I.1}D..g.J..}Y4|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1a ef ae ef  88 45 4e eb 6c 80 9c 0f  |.........EN.l...|
-00000010  9f aa 1d 80 e6 eb ad 51  9b e7 f7 0e 36 17 6d 15  |.......Q....6.m.|
-00000020  03 03 00 16 dd c0 76 8b  cb 4f 4a 91 4b 62 9c a5  |......v..OJ.Kb..|
-00000030  5f 68 b6 63 8c 71 86 ba  c9 b4                    |_h.c.q....|
+00000000  17 03 03 00 1a 61 73 4d  86 b2 a1 36 b2 3e b0 1d  |.....asM...6.>..|
+00000010  6a b9 8a 8b 00 e0 3a d9  7e 23 c7 83 72 97 28 15  |j.....:.~#..r.(.|
+00000020  03 03 00 16 4a 8a 04 00  0a b2 75 80 20 ad 76 2a  |....J.....u. .v*|
+00000030  88 16 56 e6 4a a5 c0 ea  c7 0c                    |..V.J.....|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce
index 4daddebd26..8a9ac36058 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 77 3c a8 02 e5  |....Y...U..w<...|
-00000010  54 b6 41 12 c0 c1 81 1a  c0 07 ed 06 f9 9b d3 88  |T.A.............|
-00000020  c4 14 b1 c0 c8 a9 0d d2  75 52 ce 20 7e 62 c0 0c  |........uR. ~b..|
-00000030  f5 6a be b9 76 7c e7 1b  14 46 0a 0e 54 18 73 23  |.j..v|...F..T.s#|
-00000040  71 1d 80 86 2b cb 7a 12  1f 95 fc 29 c0 2f 00 00  |q...+.z....)./..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 16 d2 11 2e d6  |....Y...U.......|
+00000010  62 0c 5e 5c 9b 1f d2 31  87 b3 43 3e cd 47 4f f1  |b.^\...1..C>.GO.|
+00000020  0b a9 d1 4f f1 2a 42 5d  35 e0 ce 20 f2 f3 45 4b  |...O.*B]5.. ..EK|
+00000030  98 2f 80 06 49 9a c3 4f  3f 70 0d e5 9a 2a 2e ff  |./..I..O?p...*..|
+00000040  34 1b 0e 30 2c 85 52 e1  84 8c 3c dc cc a8 00 00  |4..0,.R...<.....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -54,189 +54,178 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 e0 d6 30 9f b3 12 5e  |........ ..0...^|
-000002d0  62 1c 67 7d 59 18 6b 74  db b3 44 d3 6d ab ec 16  |b.g}Y.kt..D.m...|
-000002e0  c0 ed 87 af 9d 4b 08 60  47 04 01 00 80 89 b3 66  |.....K.`G......f|
-000002f0  b7 4d a9 9c c5 27 12 51  34 66 e7 47 d9 cd ac 78  |.M...'.Q4f.G...x|
-00000300  29 c8 a9 f3 77 72 a4 b0  0b 9a ed 5b 27 2c 52 fb  |)...wr.....[',R.|
-00000310  1f d0 2b cc af c2 70 df  ad 4d a9 0f 1f 3d d8 2c  |..+...p..M...=.,|
-00000320  bf b4 e9 5d 0b 52 d8 9b  c0 28 0b 4a 78 54 a8 bf  |...].R...(.JxT..|
-00000330  4e 5e 13 dc 80 35 6a cb  e1 b4 77 ac 6e 65 b5 8a  |N^...5j...w.ne..|
-00000340  1a d5 c6 a5 a5 03 ee 9f  3d 16 4a 9c b0 78 a7 71  |........=.J..x.q|
-00000350  7f f7 3c cd da 03 c4 87  3b 22 16 a4 41 c9 a2 f3  |..<.....;"..A...|
-00000360  67 7e 66 b2 97 fe 4d fb  f3 71 b7 55 25 16 03 03  |g~f...M..q.U%...|
+000002c0  ac 0c 00 00 a8 03 00 1d  20 63 85 d4 43 2a d6 9f  |........ c..C*..|
+000002d0  2f 1f 0c 73 fe dc 96 1e  51 50 a5 0d 5e fd b0 5b  |/..s....QP..^..[|
+000002e0  a5 88 2a cd 1e bf c1 ec  4d 04 01 00 80 90 fc 48  |..*.....M......H|
+000002f0  53 eb 1b bc ec 39 be ae  60 4d c9 d1 49 eb 97 cf  |S....9..`M..I...|
+00000300  94 53 75 30 84 35 ff 0c  f6 ad 9f 24 98 70 2b d3  |.Su0.5.....$.p+.|
+00000310  45 0a 7f 25 ca a3 eb 37  5a a5 97 f1 78 8b b6 02  |E..%...7Z...x...|
+00000320  92 f9 12 9e 90 52 36 0e  40 15 76 de 37 02 c5 22  |.....R6.@.v.7.."|
+00000330  44 8f a4 fc f9 ac 88 88  ad 0c 9b f6 0e d6 9f f3  |D...............|
+00000340  68 cb f1 41 dd 2d c2 71  b6 43 36 12 d2 35 1c 9a  |h..A.-.q.C6..5..|
+00000350  a9 72 ea af a9 9e 77 19  16 86 be 3e ec 5f 5a 53  |.r....w....>._ZS|
+00000360  f8 38 27 7f 08 2a ae 68  e0 17 31 df 9b 16 03 03  |.8'..*.h..1.....|
 00000370  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 22 f2 81  |....(........"..|
-00000040  c1 9e 57 bf 35 e0 4e 46  77 c1 c1 68 0f c5 d6 96  |..W.5.NFw..h....|
-00000050  81 4b f6 ec 43 d9 1e 49  cc 66 a2 c5 ad           |.K..C..I.f...|
+00000030  16 03 03 00 20 b1 f2 9a  ca 02 d3 ac 26 f5 32 03  |.... .......&.2.|
+00000040  4c b6 de cb f2 a3 11 19  eb c3 e0 e9 3b 8e 99 7d  |L...........;..}|
+00000050  c2 f3 d0 6d 4d                                    |...mM|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 ac 76 22 b0 0b  |..........(.v"..|
-00000010  85 4e 17 d4 d8 1d 06 39  d6 f5 e5 e8 86 39 99 15  |.N.....9.....9..|
-00000020  3a 76 a4 79 2d b1 42 82  ca c6 e5 ad 47 43 69 c6  |:v.y-.B.....GCi.|
-00000030  da ef 3d                                          |..=|
+00000000  14 03 03 00 01 01 16 03  03 00 20 c5 d4 b1 e2 0f  |.......... .....|
+00000010  37 ad d5 c1 1a 6c 7f da  5f 25 e3 bd 20 1d 6e 58  |7....l.._%.. .nX|
+00000020  27 7a 07 55 76 11 76 72  1b 28 9e                 |'z.Uv.vr.(.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 fa e1 18  |................|
-00000010  17 c0 45 b7 78 c9 1e 1f  ae 5d 08 8e 4e a0 02 53  |..E.x....]..N..S|
-00000020  1b 13 6f                                          |..o|
+00000000  17 03 03 00 16 3d 89 e4  a6 38 75 31 c2 08 3d 86  |.....=...8u1..=.|
+00000010  45 ed 8d c4 49 c4 da 54  3b 8f e3                 |E...I..T;..|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 1c ac 76 22  b0 0b 85 4e 18 dd 2d ce  |......v"...N..-.|
-00000010  3d b7 de 08 16 f8 88 9e  ed 75 25 97 d8 a5 ca c6  |=........u%.....|
-00000020  d1                                                |.|
+00000000  16 03 03 00 14 aa 85 e4  64 46 2f 8e dc 89 3e ef  |........dF/...>.|
+00000010  6d 9e 1a af 53 3b a0 81  c2                       |m...S;...|
 >>> Flow 7 (client to server)
-00000000  16 03 03 00 b1 00 00 00  00 00 00 00 02 7d 29 8c  |.............}).|
-00000010  c6 53 bf 06 8d f4 e4 89  a1 be 0b d7 54 50 38 06  |.S..........TP8.|
-00000020  61 c6 38 bb 17 be 5d d3  cf 20 4a 1e 93 c6 ce 46  |a.8...].. J....F|
-00000030  e2 fb 7b 76 df 70 4f 9f  cb 19 65 c9 2e b7 97 fe  |..{v.pO...e.....|
-00000040  09 37 9c 41 69 a0 50 63  a9 17 46 71 11 64 47 1b  |.7.Ai.Pc..Fq.dG.|
-00000050  79 08 19 98 03 a9 a7 1a  8a 1a 50 b0 3e 95 28 8f  |y.........P.>.(.|
-00000060  51 51 56 06 c3 b6 0e db  a2 4e e2 0d 10 ab cb 6a  |QQV......N.....j|
-00000070  b5 5e 80 74 c6 c7 26 bd  58 80 13 09 c8 76 ef cb  |.^.t..&.X....v..|
-00000080  47 ac d3 a9 5f 72 dc 91  05 fa 2a b0 0e 0c 24 09  |G..._r....*...$.|
-00000090  79 27 cb d6 f4 60 29 7f  d7 1a 8e 16 a8 2e 53 ad  |y'...`).......S.|
-000000a0  af 6a d8 82 48 9f d8 97  1e f9 82 86 bc e1 8c 18  |.j..H...........|
-000000b0  fe 60 8f 7e 3d 82                                 |.`.~=.|
+00000000  16 03 03 00 ad c3 12 d1  1a b2 88 da c1 0b 5a 32  |..............Z2|
+00000010  cf 05 35 53 ce 5d d8 42  cd 99 7e e7 9f 62 b8 35  |..5S.].B..~..b.5|
+00000020  9e f5 b5 a6 15 fd 82 26  9b 6a fe 3b 8e c0 43 27  |.......&.j.;..C'|
+00000030  1c 56 37 d1 6f d9 2c a6  a8 e8 b4 50 64 80 ae 5c  |.V7.o.,....Pd..\|
+00000040  ed eb a6 58 58 52 cf 32  de 1d be 80 69 63 38 a6  |...XXR.2....ic8.|
+00000050  12 4e 11 9b 50 aa 4b 10  f7 ad 6f 5b 08 c6 cc bd  |.N..P.K...o[....|
+00000060  94 42 64 90 c7 33 58 65  18 c5 a7 66 ce dd 83 8b  |.Bd..3Xe...f....|
+00000070  b0 15 8a 61 26 c7 eb 15  4b 6c 0b 15 45 33 2a 01  |...a&...Kl..E3*.|
+00000080  ea 13 5a 20 52 16 15 a0  70 8f 86 dc 28 50 bb e4  |..Z R...p...(P..|
+00000090  9d 01 f4 c9 7f 27 5a 54  3f 42 34 c9 5c 04 3f a3  |.....'ZT?B4.\.?.|
+000000a0  6a 5c a1 3f 03 7c fc 57  94 9b 3e 76 65 bf 78 40  |j\.?.|.W..>ve.x@|
+000000b0  b1 4f                                             |.O|
 >>> Flow 8 (server to client)
-00000000  16 03 03 00 89 ac 76 22  b0 0b 85 4e 19 fd 36 f0  |......v"...N..6.|
-00000010  79 fd 03 a2 38 d4 84 9d  46 01 68 31 dc 70 68 14  |y...8...F.h1.ph.|
-00000020  cf 0b 63 f0 74 0c 0d 35  7c 5f 5c 32 bb b3 50 30  |..c.t..5|_\2..P0|
-00000030  91 77 a0 14 0e f1 24 26  1f 6f e3 72 46 72 f0 ef  |.w....$&.o.rFr..|
-00000040  65 47 cd a8 2e 5f 19 f6  df 54 50 9b ab ba 4f 52  |eG..._...TP...OR|
-00000050  88 0f 1c 93 ef b9 40 31  e6 a1 1f 2d 95 ae 4d 11  |......@1...-..M.|
-00000060  5c e3 8f 79 6c 78 ae 50  23 48 45 d0 8a 76 81 2f  |\..ylx.P#HE..v./|
-00000070  b1 72 9a 1b 40 41 a4 b9  a5 b4 97 d6 df b2 3e b6  |.r..@A........>.|
-00000080  d0 31 2f 50 aa 30 26 8b  b1 e8 f2 33 a8 e2 16 03  |.1/P.0&....3....|
-00000090  03 02 71 ac 76 22 b0 0b  85 4e 1a d9 dc 6b b4 5a  |..q.v"...N...k.Z|
-000000a0  87 40 43 fa cf 3f b9 f0  c1 79 99 f6 a8 5e 39 07  |.@C..?...y...^9.|
-000000b0  d9 f3 36 32 0e 99 72 e2  72 ca 2c e3 6a fc 6e 78  |..62..r.r.,.j.nx|
-000000c0  1f 3a 21 8e 79 fa 65 75  ae 2d 05 6d fc ef 07 f1  |.:!.y.eu.-.m....|
-000000d0  84 24 f6 d2 bb eb 69 38  3b 1d f5 b0 3d 1f bb 8f  |.$....i8;...=...|
-000000e0  9f 3f 10 9a 8c f8 c5 d8  bb b1 a9 2a 60 97 d6 fd  |.?.........*`...|
-000000f0  04 b5 86 1e 42 47 ec 52  b1 6c e9 53 eb 90 cf b8  |....BG.R.l.S....|
-00000100  d5 8f 6d 82 60 39 67 15  6b 29 3a 55 e6 d0 e1 11  |..m.`9g.k):U....|
-00000110  c3 f3 95 51 11 e6 2b d8  c8 50 81 ff 0f 97 9f 53  |...Q..+..P.....S|
-00000120  90 49 2d e1 bc 25 b2 3f  c7 5b 38 7f bf 16 ad 37  |.I-..%.?.[8....7|
-00000130  78 df 72 1d 58 a2 50 99  c8 37 2e 86 ab 30 7f ec  |x.r.X.P..7...0..|
-00000140  d3 3f 4d ea 7f 74 42 8b  bc 9e 01 e6 c3 50 e9 7c  |.?M..tB......P.||
-00000150  5a 40 5f e6 2a 23 02 d1  9b df ab 7c 8c c4 cc fc  |Z@_.*#.....|....|
-00000160  b8 74 1e a4 e5 8c 9e 5a  78 5a a4 64 4a 3f b4 63  |.t.....ZxZ.dJ?.c|
-00000170  4e e2 65 ae 5d 36 c7 19  5d b0 b6 66 21 79 d5 09  |N.e.]6..]..f!y..|
-00000180  53 be 87 8f 16 31 35 59  af 15 3b 36 c5 99 d8 c5  |S....15Y..;6....|
-00000190  35 59 de e0 22 86 d2 83  71 eb 7e eb c9 e0 92 4b  |5Y.."...q.~....K|
-000001a0  11 b5 42 40 83 22 73 65  5d be c5 47 7f e3 b2 15  |..B@."se]..G....|
-000001b0  a3 37 71 49 4a d8 04 ac  3e 82 63 3f 20 c0 dd d0  |.7qIJ...>.c? ...|
-000001c0  9f f3 08 dd 1c aa e3 82  c1 d5 64 c4 2e 52 8a 2b  |..........d..R.+|
-000001d0  8a 16 c0 67 f4 15 9c 20  ab 89 55 f5 7b bc 0c 9b  |...g... ..U.{...|
-000001e0  75 02 9f e5 b0 e3 6c 54  0c 44 45 69 23 4a cb b1  |u.....lT.DEi#J..|
-000001f0  e9 82 c9 54 c2 88 35 70  14 a5 40 c2 41 9e dc 92  |...T..5p..@.A...|
-00000200  b4 86 f9 a7 3f e3 db e9  ce f1 9d 50 93 85 f0 26  |....?......P...&|
-00000210  21 a6 ae ca 9e ea 16 53  09 8f ac 77 4d b6 70 db  |!......S...wM.p.|
-00000220  d7 67 3c 13 b3 ae a1 aa  82 c1 6b cd 1c a4 48 71  |.g<.......k...Hq|
-00000230  61 4b 80 3e 6a cf a7 4d  7a d5 48 40 74 e4 b5 65  |aK.>j..Mz.H@t..e|
-00000240  90 d3 4f 28 4a 64 3f 8b  5e 52 0f 36 b2 49 c2 29  |..O(Jd?.^R.6.I.)|
-00000250  8e 06 15 99 63 9a 81 90  6a 91 5c 18 71 5d 3f df  |....c...j.\.q]?.|
-00000260  90 0c 22 cd 76 d2 9d 65  d9 4e 28 da b3 84 d2 a0  |..".v..e.N(.....|
-00000270  9c e7 83 31 56 a9 62 65  28 02 7e c0 05 4f 4c 14  |...1V.be(.~..OL.|
-00000280  5a 9e 3d 89 15 75 13 20  68 fb a9 b2 c7 91 b2 8e  |Z.=..u. h.......|
-00000290  35 45 22 55 f8 76 e1 48  a2 cb 37 cd 05 a9 a8 92  |5E"U.v.H..7.....|
-000002a0  91 32 de 32 b7 7b 6a 55  88 0d d2 53 c3 7e 50 c3  |.2.2.{jU...S.~P.|
-000002b0  90 9c 97 53 e4 94 40 72  35 c2 a4 20 f8 9c 39 25  |...S..@r5.. ..9%|
-000002c0  a9 f6 a4 aa 3b 9a a8 11  30 b5 80 b3 21 4b 37 da  |....;...0...!K7.|
-000002d0  e6 50 14 ce 14 d0 81 c4  aa 05 86 f2 ac 53 b1 1a  |.P...........S..|
-000002e0  7c 8c 64 e7 36 d4 4a 5f  29 9a 43 0d 6d ef 61 ca  ||.d.6.J_).C.m.a.|
-000002f0  95 af 43 1c 29 80 e3 5b  c4 d4 8e 5d 23 80 7f 34  |..C.)..[...]#..4|
-00000300  2d f0 ab eb 16 03 03 00  c4 ac 76 22 b0 0b 85 4e  |-.........v"...N|
-00000310  1b a3 d4 e2 99 38 d2 37  38 51 5d ae 0d e1 25 53  |.....8.78Q]...%S|
-00000320  21 df 5b 96 d0 5c 9f 1c  01 4d b0 58 77 43 cb ac  |!.[..\...M.XwC..|
-00000330  14 dc b0 27 4c cf 01 4b  d8 1b d0 ba 1a 3c f2 ea  |...'L..K.....<..|
-00000340  9c ae 6f bb 28 bb d7 91  63 e4 17 3b 73 94 35 a8  |..o.(...c..;s.5.|
-00000350  0c a3 45 09 82 b6 31 bb  98 2e 77 98 4c 38 42 c9  |..E...1...w.L8B.|
-00000360  b7 c7 1c f6 7a f7 6a f4  79 37 da 6b 81 21 fc 51  |....z.j.y7.k.!.Q|
-00000370  46 0a 80 da 70 a9 00 1e  f9 b9 7d a8 9a 5f 54 7d  |F...p.....}.._T}|
-00000380  f0 0a 77 95 bd 99 01 88  81 0e 85 38 14 13 b9 14  |..w........8....|
-00000390  37 6b 32 70 63 6e 4b 51  70 ae 6f 11 20 9b 07 08  |7k2pcnKQp.o. ...|
-000003a0  e8 54 42 6f c7 65 58 2d  ad 50 fe a6 ba f8 0b ca  |.TBo.eX-.P......|
-000003b0  41 57 e1 0c fe 73 1e cd  e5 59 3b f0 6e 10 a7 63  |AW...s...Y;.n..c|
-000003c0  0d 12 d5 91 3d 59 be b6  bb 17 e6 19 c2 16 03 03  |....=Y..........|
-000003d0  00 42 ac 76 22 b0 0b 85  4e 1c 4c 28 e9 56 ec 92  |.B.v"...N.L(.V..|
-000003e0  c3 a4 ec 60 71 3d 86 20  6b 92 92 7d 0b 3d e0 d8  |...`q=. k..}.=..|
-000003f0  c8 ee fd a7 60 41 71 e3  5b 88 c1 7e 50 c5 4e 63  |....`Aq.[..~P.Nc|
-00000400  04 ab 64 ab 92 73 28 09  1c ee d6 30 69 67 f6 8b  |..d..s(....0ig..|
-00000410  a7 57 bb a0 16 03 03 00  1c ac 76 22 b0 0b 85 4e  |.W........v"...N|
-00000420  1d 20 75 d5 7c 7c 82 15  77 6f 4f 8c 97 eb a6 bd  |. u.||..woO.....|
-00000430  e6 35 27 0c e5                                    |.5'..|
+00000000  16 03 03 00 81 33 ef 78  c8 2d 94 4b e3 b8 ea eb  |.....3.x.-.K....|
+00000010  67 1e 6c 10 98 25 5f df  ce 46 4c 13 77 ec d1 b1  |g.l..%_..FL.w...|
+00000020  e9 e2 c9 b0 de 9c ce 40  d0 d9 6f a5 fb a6 69 1f  |.......@..o...i.|
+00000030  9f 53 68 6c ab f8 f0 10  4a c9 43 f0 ad 61 59 01  |.Shl....J.C..aY.|
+00000040  b2 90 97 9e cf 62 64 a5  46 b2 27 2f 1e b8 33 24  |.....bd.F.'/..3$|
+00000050  ed 7e 6b 5a dd 45 4d 00  61 a3 7e 22 5e bc 02 af  |.~kZ.EM.a.~"^...|
+00000060  5a a0 73 fb c5 1c 0f 11  f6 70 5f cc 9e 1c fa 3c  |Z.s......p_....<|
+00000070  13 0d 8b 03 4c 3b d5 5a  02 7b 95 64 ae cb 2f 50  |....L;.Z.{.d../P|
+00000080  e7 e1 32 13 72 96 16 03  03 02 69 f0 60 6a b8 fb  |..2.r.....i.`j..|
+00000090  50 6e f9 f2 65 d0 73 90  f7 55 0d bc 3a 66 72 32  |Pn..e.s..U..:fr2|
+000000a0  b7 32 ad 1d de 18 04 90  55 70 2d b8 c9 3f 4b 2f  |.2......Up-..?K/|
+000000b0  37 98 1c 4e c1 78 c1 ed  1f e2 bf 50 78 40 04 10  |7..N.x.....Px@..|
+000000c0  b8 55 48 29 26 b0 a4 4d  ea aa 45 65 b4 21 93 ed  |.UH)&..M..Ee.!..|
+000000d0  49 4c 1d d9 77 33 38 2e  14 92 b4 e3 06 ce fe 51  |IL..w38........Q|
+000000e0  6a 19 1c aa e9 a6 7d fa  45 86 66 1a 6e bb 01 01  |j.....}.E.f.n...|
+000000f0  82 86 89 86 81 ce 0a 93  1a b2 f1 90 71 7a 43 fa  |............qzC.|
+00000100  b1 03 24 75 a1 48 f8 ee  a0 b4 c0 18 ff 81 95 2a  |..$u.H.........*|
+00000110  aa 74 87 39 da 23 ba ab  33 6b 63 ee df 2b f1 d1  |.t.9.#..3kc..+..|
+00000120  1a 9a 4a 0d ef de 68 13  28 81 49 d5 c6 08 57 a9  |..J...h.(.I...W.|
+00000130  d7 5e 56 a4 ec 81 42 de  28 39 51 7d 3a 66 cf a7  |.^V...B.(9Q}:f..|
+00000140  f7 81 7a b2 a7 09 b3 24  a6 b0 a5 cc 96 24 30 b2  |..z....$.....$0.|
+00000150  5b 94 1b ef 70 dd 7f bc  63 2f 7b bc 80 70 9e 9f  |[...p...c/{..p..|
+00000160  01 c9 20 ab 35 53 7c 3b  d6 70 d9 1d 9a f6 e8 76  |.. .5S|;.p.....v|
+00000170  f5 46 f8 b1 10 46 a9 eb  da 7b 80 cc 74 18 f9 30  |.F...F...{..t..0|
+00000180  56 1a cb 4e 60 2a b3 9f  35 fe a9 b8 b8 76 02 a7  |V..N`*..5....v..|
+00000190  4e f9 43 c9 52 70 6a fd  9c 3e dd c4 3f 28 08 19  |N.C.Rpj..>..?(..|
+000001a0  28 ed f9 44 e3 d1 b9 53  7e b7 cd 1b e9 11 c8 9f  |(..D...S~.......|
+000001b0  35 ed ab e3 5e 26 e8 49  7a 13 5c 20 9a b7 a0 95  |5...^&.Iz.\ ....|
+000001c0  60 0f 54 68 5c a8 c9 1d  37 0b 9f f6 61 3b fe 4c  |`.Th\...7...a;.L|
+000001d0  dc 4f 11 98 0c 7a b7 32  0b 50 e2 cd a7 59 bf 05  |.O...z.2.P...Y..|
+000001e0  a2 8a 51 33 23 ab 99 49  23 97 42 3b 0f 1c 39 b1  |..Q3#..I#.B;..9.|
+000001f0  43 c4 01 aa f9 f8 54 d7  2c b4 ef 33 f3 05 13 d0  |C.....T.,..3....|
+00000200  8d 81 06 23 d3 38 cb 3a  6b 37 f0 4d 1f be ed 0c  |...#.8.:k7.M....|
+00000210  b7 58 00 3a bd 74 02 a4  f4 b4 fc fd b8 fa 89 15  |.X.:.t..........|
+00000220  01 46 49 52 47 f1 4c 94  ee de 00 a1 25 aa b4 9b  |.FIRG.L.....%...|
+00000230  f6 b4 23 a1 0d fd 00 5a  de 45 38 ee 69 17 6f c3  |..#....Z.E8.i.o.|
+00000240  0b ed c5 3b b1 7d b1 2c  a4 8f ed 30 44 9a 0b 51  |...;.}.,...0D..Q|
+00000250  34 12 cc 6a 09 e4 74 ec  11 94 4b ba ce 72 93 64  |4..j..t...K..r.d|
+00000260  07 c8 ff 78 6e 1a bd 5e  26 15 a7 e8 72 90 71 a9  |...xn..^&...r.q.|
+00000270  0a bb cf 25 40 1d 20 a7  d7 b3 46 4b 53 6c c2 50  |...%@. ...FKSl.P|
+00000280  c7 7b 58 e1 3c df 6d db  28 71 15 f9 84 b7 ad b0  |.{X.<.m.(q......|
+00000290  9f e9 7a 08 5d 85 7a dd  bc c0 62 2e 6a d0 63 6a  |..z.].z...b.j.cj|
+000002a0  e2 46 6b 80 68 cf e5 a7  9e 60 42 8a 17 54 9c ec  |.Fk.h....`B..T..|
+000002b0  80 9b 81 80 7e 6f 33 8c  d1 be 95 30 f2 a9 19 f8  |....~o3....0....|
+000002c0  36 2c 8e 89 c2 5a b4 04  2e 12 05 21 3b 4f 42 26  |6,...Z.....!;OB&|
+000002d0  d1 98 11 f4 17 c2 a3 06  54 37 31 8e ca 9b 07 62  |........T71....b|
+000002e0  79 95 b8 fd 49 aa 60 5b  03 7d 60 50 b6 2f 3b 0a  |y...I.`[.}`P./;.|
+000002f0  5d c2 9f 92 16 03 03 00  bc ba f6 73 85 34 20 c4  |]..........s.4 .|
+00000300  b3 a4 15 01 fe 37 b3 b4  57 a5 b5 26 0c 64 2b 3e  |.....7..W..&.d+>|
+00000310  07 d3 e4 59 a8 64 3f fd  15 24 24 70 61 77 9b 96  |...Y.d?..$$paw..|
+00000320  c6 4b 79 2e a8 a7 c4 ac  5e cd 6e 8f 30 e5 3f f8  |.Ky.....^.n.0.?.|
+00000330  08 22 cb de 5f 8c b8 dc  07 4b 79 ec 41 41 20 20  |.".._....Ky.AA  |
+00000340  02 f6 4e 98 a3 5e 38 e2  5a d9 4a 2d 2e 3b 29 13  |..N..^8.Z.J-.;).|
+00000350  26 dc 4e eb a5 5e a3 b6  6f 16 75 b3 9e 63 4e 8e  |&.N..^..o.u..cN.|
+00000360  00 c1 46 30 fc 25 f9 05  86 ed 00 87 f2 6b 5c 18  |..F0.%.......k\.|
+00000370  69 e5 5c 32 9e 15 d2 47  9e 0e d8 c1 7a 9d 45 7a  |i.\2...G....z.Ez|
+00000380  76 4a ef 8d b5 60 7d 4d  fa 99 8f c5 58 18 ad a2  |vJ...`}M....X...|
+00000390  93 c1 36 85 39 73 e1 7b  46 be 69 de 88 fa 68 8e  |..6.9s.{F.i...h.|
+000003a0  be d1 48 bc 7b 29 2a 21  ba 60 60 58 51 c2 03 66  |..H.{)*!.``XQ..f|
+000003b0  51 9a 4e 70 06 16 03 03  00 3a c5 ed 8d 5d b9 c0  |Q.Np.....:...]..|
+000003c0  a2 07 15 c3 ef 76 ff fb  ca f6 b6 4b ab a5 7a 80  |.....v.....K..z.|
+000003d0  a9 2e 43 d0 d2 f1 d9 96  61 ff 43 59 3d d1 82 57  |..C.....a.CY=..W|
+000003e0  68 d7 c8 3a 5f 86 4a 2e  00 8f 3d 0e 73 49 c6 4a  |h..:_.J...=.sI.J|
+000003f0  81 4e ec e2 16 03 03 00  14 d5 5f c3 d2 9c 13 36  |.N........_....6|
+00000400  cb 22 23 3d e4 03 5b b9  26 66 cf 79 7c           |."#=..[.&f.y||
 >>> Flow 9 (client to server)
-00000000  16 03 03 02 71 00 00 00  00 00 00 00 03 5e 4f 6b  |....q........^Ok|
-00000010  a3 20 3b f4 1e 15 a6 69  c0 b6 c0 e4 1f e6 89 d1  |. ;....i........|
-00000020  e2 05 c1 b9 39 1c f2 a9  91 c0 5c 42 e7 04 34 85  |....9.....\B..4.|
-00000030  78 f5 17 d8 df 6a 98 c4  b8 cf 06 8c 36 7d e3 3e  |x....j......6}.>|
-00000040  e0 0b dc de ed 0b f7 fd  52 90 e2 65 34 42 e9 6e  |........R..e4B.n|
-00000050  7d 47 eb 82 ba 62 bc 44  65 a4 2d 4b 3b 7e 94 7a  |}G...b.De.-K;~.z|
-00000060  8c 87 8d 41 a9 7f 9e d4  f8 21 39 6f 1b 0e 99 91  |...A.....!9o....|
-00000070  90 5d 14 bb b4 79 9d c7  32 8d 41 63 38 11 ed 10  |.]...y..2.Ac8...|
-00000080  30 f0 62 26 a5 89 97 dc  06 68 af 91 7b 21 73 4c  |0.b&.....h..{!sL|
-00000090  77 91 84 a3 f4 6e a9 7f  9c 3a 76 49 62 9b 79 e4  |w....n...:vIb.y.|
-000000a0  a7 18 fd f7 0a 8b 3a f8  cf 04 fd f9 72 ee cc f0  |......:.....r...|
-000000b0  98 9a 17 28 27 70 8c c6  83 d6 11 96 6e 6c 3f 79  |...('p......nl?y|
-000000c0  ca b8 52 51 18 e7 e1 e3  8c 63 dd 8a 98 8f 4e 01  |..RQ.....c....N.|
-000000d0  a0 6f a7 e1 8b d6 62 f0  24 c4 1a 6e 2e 88 ba 63  |.o....b.$..n...c|
-000000e0  88 62 1b a9 54 5f 06 9f  ee f0 20 63 23 68 89 18  |.b..T_.... c#h..|
-000000f0  78 76 9f 9b 7d 2b b8 79  8b d1 02 93 06 e5 93 9e  |xv..}+.y........|
-00000100  86 cc 84 a4 fe 30 20 ac  1e 20 3e d8 a4 56 b9 a5  |.....0 .. >..V..|
-00000110  ce 95 e0 6c fa 0d 9f 74  e1 2f 22 f4 ee 34 3d d7  |...l...t./"..4=.|
-00000120  88 4d 57 5e 25 6d 9c 8f  c3 bc 37 16 2e 52 01 ff  |.MW^%m....7..R..|
-00000130  e3 c2 13 6c b1 57 3a ce  eb 93 63 81 bd 40 1f 24  |...l.W:...c..@.$|
-00000140  f3 e6 31 e0 68 38 c1 8a  37 34 d4 7d 51 23 de a6  |..1.h8..74.}Q#..|
-00000150  1a c4 14 98 11 60 8b 14  00 b8 dc 97 39 c0 0b 05  |.....`......9...|
-00000160  65 c4 ae b7 db d9 ed 31  39 93 61 d1 22 08 aa e4  |e......19.a."...|
-00000170  eb 9a a3 71 46 0d b1 3b  a5 97 45 62 e4 a8 21 c2  |...qF..;..Eb..!.|
-00000180  09 f3 95 0b 43 d1 21 5c  5b 6b d8 db 0c 49 81 c7  |....C.!\[k...I..|
-00000190  67 89 97 ea b5 87 17 da  38 d2 c9 df 7a 47 3a af  |g.......8...zG:.|
-000001a0  c6 91 19 a2 09 2c 3f 07  69 c8 ca ec 31 94 96 d8  |.....,?.i...1...|
-000001b0  b8 3e c4 bd d3 f7 63 b5  f7 6a 50 93 85 f5 8b be  |.>....c..jP.....|
-000001c0  8d 56 39 b5 6e a7 1a ef  40 cd e1 90 f0 81 95 35  |.V9.n...@......5|
-000001d0  b3 35 46 09 33 93 35 20  ed a6 ad c7 7b 34 2a 58  |.5F.3.5 ....{4*X|
-000001e0  9f 57 63 f2 b7 22 ef 88  8a bd 00 b9 25 c1 bd 93  |.Wc.."......%...|
-000001f0  d6 f3 38 5d d1 e6 fd a2  04 94 cc 4b f7 c2 f7 a5  |..8].......K....|
-00000200  1e e8 60 ec 7d 23 7b 4d  38 b6 d8 a7 9b 56 7d d9  |..`.}#{M8....V}.|
-00000210  25 f0 1b fa 59 e4 01 b0  a7 af 61 67 5f ed 9d 76  |%...Y.....ag_..v|
-00000220  01 44 ca b9 df d8 dd 27  fb 04 de c0 45 f6 5b 2a  |.D.....'....E.[*|
-00000230  9c 6f 0b f7 b4 40 74 40  86 d1 2b 3f d3 7c 55 2f  |.o...@t@..+?.|U/|
-00000240  d7 21 85 84 04 e1 99 d7  27 a5 cf b8 5c 4f 39 12  |.!......'...\O9.|
-00000250  2f b5 e1 d2 b0 67 b1 fd  86 1c a6 4c 36 77 73 31  |/....g.....L6ws1|
-00000260  ec 6d 20 dc 96 e9 6e 17  58 fa 2b da 16 de 7c c9  |.m ...n.X.+...|.|
-00000270  5d 84 89 2d 41 f2 16 03  03 00 3d 00 00 00 00 00  |]..-A.....=.....|
-00000280  00 00 04 17 b0 b2 53 3e  b3 89 72 5c 19 b1 a3 5f  |......S>..r\..._|
-00000290  74 29 a3 d2 3d ff 7f fa  13 e4 f1 3d a2 ae 1e bf  |t)..=......=....|
-000002a0  b1 1d 1e 5f 23 7e 59 93  49 06 c8 be 4e 77 bc b3  |..._#~Y.I...Nw..|
-000002b0  f8 f5 86 eb f1 12 e6 f0  16 03 03 00 a0 00 00 00  |................|
-000002c0  00 00 00 00 05 34 71 88  83 c9 a7 00 bf e5 be b8  |.....4q.........|
-000002d0  63 f8 c7 d7 05 dc 55 e9  cc 41 ab 91 26 f8 e9 8c  |c.....U..A..&...|
-000002e0  16 1f 14 be b5 df e8 96  64 2a 6e c3 e0 28 10 7c  |........d*n..(.||
-000002f0  2b b0 7d bc 5d 5f 16 a8  64 a6 33 62 60 47 1b b8  |+.}.]_..d.3b`G..|
-00000300  bd 3d 79 d3 38 77 a5 2b  09 39 44 70 59 15 2b 54  |.=y.8w.+.9DpY.+T|
-00000310  38 58 35 06 fa 4e 09 09  d1 2c 02 fd cb 12 fe 63  |8X5..N...,.....c|
-00000320  70 db 67 d9 8a 83 75 73  0d f1 63 d0 83 a7 5c 21  |p.g...us..c...\!|
-00000330  28 7e 13 bc 75 5b ec 06  32 a4 6f 6b 91 1c e4 df  |(~..u[..2.ok....|
-00000340  30 d5 29 2d 18 b8 25 2a  46 65 04 80 d3 68 1e 15  |0.)-..%*Fe...h..|
-00000350  c7 7d 25 dd d6 18 11 ae  89 6c ee f8 d8 14 03 03  |.}%......l......|
-00000360  00 19 00 00 00 00 00 00  00 06 8b 2b cb ec 40 fd  |...........+..@.|
-00000370  00 53 6d 35 a1 e9 ff ff  94 84 2c 16 03 03 00 28  |.Sm5......,....(|
-00000380  00 00 00 00 00 00 00 00  5a 79 0e fc b6 e4 6a cb  |........Zy....j.|
-00000390  ff 00 ed 25 dd db 3a 57  1c f0 04 e6 cd 45 02 39  |...%..:W.....E.9|
-000003a0  f8 59 7e 98 67 e3 20 39                           |.Y~.g. 9|
+00000000  16 03 03 02 69 15 0b 29  0e 27 a9 4b 52 4d 0a 77  |....i..).'.KRM.w|
+00000010  b8 3a 40 95 84 a7 7a 8d  b1 6b 90 61 94 3a e4 06  |.:@...z..k.a.:..|
+00000020  20 6f 88 40 8a 8c c2 4e  dc 3a 01 39 c2 11 5a 9b  | o.@...N.:.9..Z.|
+00000030  28 92 bc 72 04 a3 60 c3  42 c0 b8 dd f3 41 40 be  |(..r..`.B....A@.|
+00000040  6d 51 5b b8 db 75 63 3d  4f 2a cf f5 04 3d 53 be  |mQ[..uc=O*...=S.|
+00000050  47 f1 ae be 0a 97 5d 2c  df 55 5d dd 9a f6 0e 40  |G.....],.U]....@|
+00000060  59 02 91 d8 55 c9 3b e6  84 9c 8d 40 af 29 77 59  |Y...U.;....@.)wY|
+00000070  15 0c 83 dd ec c7 e2 16  85 d8 6e e7 4e c5 a5 b1  |..........n.N...|
+00000080  8b 4b 46 3e 62 7c ff 27  1b 37 b7 5c 05 32 30 fb  |.KF>b|.'.7.\.20.|
+00000090  c1 cc 1d 13 1f 09 db 57  6a 70 2b 9f a7 25 9b 75  |.......Wjp+..%.u|
+000000a0  d3 62 20 45 d1 2f 28 c0  d7 84 d6 2e b3 6d 4a c3  |.b E./(......mJ.|
+000000b0  46 0d 92 32 87 65 dd b8  98 68 1a 52 0a df be b3  |F..2.e...h.R....|
+000000c0  09 bc 63 bb a3 da f7 52  5a 81 53 9a e0 ff bb 06  |..c....RZ.S.....|
+000000d0  7f 81 f8 ea 02 bb 3b 96  7b 0f 84 a5 4d 17 3a 2a  |......;.{...M.:*|
+000000e0  20 e9 21 70 b2 ab 8a 55  31 4b 1b 60 52 7f a8 39  | .!p...U1K.`R..9|
+000000f0  5a 0f 0b 00 4e eb 01 0c  a6 d8 f0 30 2b a3 6f 7b  |Z...N......0+.o{|
+00000100  99 82 90 9e 4c c8 03 1c  0e 85 55 bc 2d 42 28 66  |....L.....U.-B(f|
+00000110  35 c3 1e 08 70 d0 45 05  5b 2e 00 fc 9a f1 44 0e  |5...p.E.[.....D.|
+00000120  cb 91 ce b8 0f 2a 9f 5a  18 a8 ca 38 ff 2a ab 11  |.....*.Z...8.*..|
+00000130  57 a5 03 2f 3e 92 21 77  df dc 85 e7 fd d4 7e d0  |W../>.!w......~.|
+00000140  d9 6e ef 99 66 5d a8 f5  9a d3 c3 0f 0c 98 cd fe  |.n..f]..........|
+00000150  5a 46 79 77 c9 28 fb 5e  3e c0 d5 b3 db 98 79 9d  |ZFyw.(.^>.....y.|
+00000160  d4 20 a5 ad 25 d8 3b 39  35 60 fd 21 e0 eb 86 be  |. ..%.;95`.!....|
+00000170  8f 65 72 a2 d3 91 4c 25  70 31 b1 02 29 17 da e0  |.er...L%p1..)...|
+00000180  9f 7d 4e 5f 1a 7b 93 09  4c 84 5b 40 f8 3c 98 36  |.}N_.{..L.[@.<.6|
+00000190  9b 14 43 db 43 11 0a e2  9a 8b 73 96 a3 7b 4d 67  |..C.C.....s..{Mg|
+000001a0  d7 35 a6 85 40 6d 45 0e  9d 47 43 96 b8 64 d4 d7  |.5..@mE..GC..d..|
+000001b0  d1 28 c8 32 7e ab d5 11  ad b4 a7 9c c9 ab c5 96  |.(.2~...........|
+000001c0  72 69 1a db 42 06 8e 03  d0 70 f9 7a 75 56 53 49  |ri..B....p.zuVSI|
+000001d0  29 e1 60 16 86 99 da 9e  d6 c3 95 94 e3 e4 6c 9c  |).`...........l.|
+000001e0  4f d0 5d e7 a6 23 e1 49  a5 b8 3d 41 a4 e0 8c a2  |O.]..#.I..=A....|
+000001f0  f8 35 40 4d 12 f1 0b 70  06 f5 b5 29 f8 5d 74 73  |.5@M...p...).]ts|
+00000200  32 35 11 7f 50 a3 22 5b  d6 db a5 a8 9f ca db 47  |25..P."[.......G|
+00000210  b9 a8 c7 fc 16 40 ae 94  6e 6c 40 30 7a d6 9c 89  |.....@..nl@0z...|
+00000220  d7 e9 1b 6b 26 72 1f d7  c9 bc ce 6f 84 03 3d 65  |...k&r.....o..=e|
+00000230  34 f9 7b 32 54 e4 b4 72  8c e1 31 9e e5 13 50 2f  |4.{2T..r..1...P/|
+00000240  ea 16 27 15 cb ec 0f 1b  21 aa dd cb 25 74 b9 4d  |..'.....!...%t.M|
+00000250  36 c0 0d fe a4 99 2f 86  50 52 d0 83 e2 3f fa e7  |6...../.PR...?..|
+00000260  2d 24 b6 7a ca 7f 69 3e  7d 0b 61 df 29 3b 16 03  |-$.z..i>}.a.);..|
+00000270  03 00 35 8e 89 3d 7b 39  aa d2 21 01 6a 3d fe 4f  |..5..={9..!.j=.O|
+00000280  e2 d9 e6 6d 5d 1e d3 a5  1d 3f f8 8e fb 97 3d 06  |...m]....?....=.|
+00000290  9b 68 67 45 15 3b a1 e8  e8 39 77 1a 41 77 2b c5  |.hgE.;...9w.Aw+.|
+000002a0  8c fe bd 28 7a 85 eb 7a  16 03 03 00 98 f0 ed 3c  |...(z..z.......<|
+000002b0  37 3f 34 3b 35 e4 15 a8  f3 b4 b6 76 49 65 e8 26  |7?4;5......vIe.&|
+000002c0  93 4b cc b1 31 7a 4c e7  7d 80 63 60 65 9a ff 11  |.K..1zL.}.c`e...|
+000002d0  a8 c5 c4 4e c2 7a ca 95  cb 08 21 77 42 ce 70 1e  |...N.z....!wB.p.|
+000002e0  bf d9 b5 6d de dc 03 67  2e 11 b5 47 c1 c0 74 6b  |...m...g...G..tk|
+000002f0  b4 9d c4 de 8c d4 80 e4  99 92 31 68 09 85 00 34  |..........1h...4|
+00000300  43 cc 06 09 bc a8 6e 83  a0 fa df 6e a0 04 e9 37  |C.....n....n...7|
+00000310  b3 05 69 b9 f1 85 7f 48  27 73 d0 64 2c 33 48 1f  |..i....H's.d,3H.|
+00000320  f9 7c 0a 21 1f cb 0f 4c  c2 28 b0 3b 8c 9b 23 21  |.|.!...L.(.;..#!|
+00000330  f4 8c 69 b2 1d 55 35 20  b9 92 09 36 01 aa e1 e3  |..i..U5 ...6....|
+00000340  ee b7 3d 83 7b 14 03 03  00 11 40 bb bb 2e 3d 48  |..=.{.....@...=H|
+00000350  9f fa c6 0c d8 4f 45 cb  11 b3 a5 16 03 03 00 20  |.....OE........ |
+00000360  39 b7 46 30 00 68 12 c5  f5 d7 a0 85 7f ce 49 70  |9.F0.h........Ip|
+00000370  05 83 64 26 7a 0c 43 fb  a9 4d bb 61 3a c3 8a 91  |..d&z.C..M.a:...|
 >>> Flow 10 (server to client)
-00000000  14 03 03 00 19 ac 76 22  b0 0b 85 4e 1e a3 53 2c  |......v"...N..S,|
-00000010  c7 2a d7 41 8b f3 64 9a  3b 03 5c 93 ed 8c 16 03  |.*.A..d.;.\.....|
-00000020  03 00 28 fc db 23 05 58  b4 df 03 4c 03 35 fc 9b  |..(..#.X...L.5..|
-00000030  a0 58 ce b4 10 77 ed 56  4f 6b 7a 6c a7 4d 8b 1b  |.X...w.VOkzl.M..|
-00000040  a6 7c f3 cc 6c 32 f6 64  62 f7 20 17 03 03 00 21  |.|..l2.db. ....!|
-00000050  fc db 23 05 58 b4 df 04  4f 35 64 2c 33 0e 67 9e  |..#.X...O5d,3.g.|
-00000060  2d 0b 8e 4b 70 78 c6 41  ef 3f ed f6 75 85 74 81  |-..Kpx.A.?..u.t.|
-00000070  90                                                |.|
+00000000  14 03 03 00 11 d1 d7 7e  3c 5f 01 cb f8 eb af d5  |.......~<_......|
+00000010  ba 09 32 68 4b cf 16 03  03 00 20 02 f1 23 45 32  |..2hK..... ..#E2|
+00000020  60 9b 49 db 2f 3a cb 5c  e4 f3 64 b1 cb ca 09 b0  |`.I./:.\..d.....|
+00000030  b3 34 a3 75 7d a5 a0 80  44 fd b7 17 03 03 00 19  |.4.u}...D.......|
+00000040  d7 c3 c4 33 e6 f2 73 d2  2c 0b 7e 0e 40 d3 8b f6  |...3..s.,.~.@...|
+00000050  47 57 13 88 be 4b 12 43  57                       |GW...K.CW|
 >>> Flow 11 (client to server)
-00000000  15 03 03 00 1a 00 00 00  00 00 00 00 01 43 67 19  |.............Cg.|
-00000010  21 e1 a7 e3 3b 35 67 49  d8 cb 5c fc 43 0b 92     |!...;5gI..\.C..|
+00000000  15 03 03 00 12 3a 90 85  e8 ce 53 d1 2a 3b d6 9a  |.....:....S.*;..|
+00000010  f3 61 c1 72 81 c0 03                              |.a.r...|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice
index e6b3baa8bc..c2f4e4aca9 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 9d 09 7f 85 b3  |....Y...U.......|
-00000010  ad 89 88 42 6f 57 a0 c6  2e 98 22 d3 62 31 56 0f  |...BoW....".b1V.|
-00000020  b8 a6 b1 9c f9 4d 6a 55  bf a2 16 20 60 e7 ec 61  |.....MjU... `..a|
-00000030  a4 06 aa de 03 9e b0 ba  73 d2 49 f2 e8 b7 3c b9  |........s.I...<.|
-00000040  82 76 9a 4e cb bd 1d 4b  54 96 e1 34 c0 2f 00 00  |.v.N...KT..4./..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 30 5b 03 80 cf  |....Y...U..0[...|
+00000010  ad 5e 69 9b da 4a de 2f  07 f3 6c 42 d7 50 99 10  |.^i..J./..lB.P..|
+00000020  80 15 dc dd d2 ef 3d 20  b9 eb bd 20 51 63 fd 9d  |......= ... Qc..|
+00000030  3d b7 3e ea 4e 18 45 90  40 50 f2 f3 2b b8 00 42  |=.>.N.E.@P..+..B|
+00000040  bf 77 ae d1 ff 29 2d ca  d8 c2 4e c7 cc a8 00 00  |.w...)-...N.....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -54,342 +54,323 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 a4 dc 29 cd 8d a1 92  |........ ..)....|
-000002d0  f7 36 09 db 41 2c a4 86  28 64 ae 97 bf 72 1c f6  |.6..A,..(d...r..|
-000002e0  fa 14 d8 5f fb 90 1d a5  40 04 01 00 80 bf f1 c9  |..._....@.......|
-000002f0  e2 7a 76 1a 3b c8 9e c8  17 d7 58 c4 73 05 3b dc  |.zv.;.....X.s.;.|
-00000300  d2 6c 8c ba ff d9 ff 5e  14 9b 5a 00 66 68 c3 df  |.l.....^..Z.fh..|
-00000310  2e 37 b0 97 19 3c f4 ba  b3 44 65 30 30 62 81 58  |.7...<...De00b.X|
-00000320  61 b6 eb 19 fb 98 28 23  ab c1 f0 50 87 5e 4a bd  |a.....(#...P.^J.|
-00000330  c3 37 6f 69 1d e3 88 22  90 bb cc 08 f3 5f 4b 8f  |.7oi..."....._K.|
-00000340  71 fe 49 1e 47 e7 32 4f  f6 ee c2 5e 39 56 53 d9  |q.I.G.2O...^9VS.|
-00000350  32 36 78 0a 3e 12 24 19  65 f3 9c ed e1 24 ca 29  |26x.>.$.e....$.)|
-00000360  91 1c b5 99 5b 1e f3 0f  ab 54 18 e1 be 16 03 03  |....[....T......|
+000002c0  ac 0c 00 00 a8 03 00 1d  20 6b cd 37 6d a7 76 7a  |........ k.7m.vz|
+000002d0  04 0e 8c 93 db b0 62 67  14 65 26 5e 91 b3 8d 66  |......bg.e&^...f|
+000002e0  20 40 31 c1 84 3c ef d8  67 04 01 00 80 ce 3a f2  | @1..<..g.....:.|
+000002f0  16 01 b2 8a cd d6 1c b3  c4 46 a5 e8 1f 17 85 d9  |.........F......|
+00000300  5b 97 fb dd 43 65 52 82  e3 49 99 e8 49 d9 09 13  |[...CeR..I..I...|
+00000310  05 73 19 d0 d9 66 54 03  de 4b fa 43 2d f1 f8 98  |.s...fT..K.C-...|
+00000320  79 21 3b fa a9 ea 29 78  fa 87 59 8e 9b 2f f2 99  |y!;...)x..Y../..|
+00000330  14 85 21 9c 7e 59 5b 4b  2f e3 33 c4 7c 2c ac 35  |..!.~Y[K/.3.|,.5|
+00000340  4f 68 c8 a3 0b f5 43 7e  72 9a e6 4f 9c 10 4d 4a  |Oh....C~r..O..MJ|
+00000350  d4 b5 84 62 61 4e f4 0f  3f a5 b5 23 89 d9 33 e2  |...baN..?..#..3.|
+00000360  06 22 02 c5 fe db 27 fb  40 87 8c e7 6e 16 03 03  |."....'.@...n...|
 00000370  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 ad 88 72  |....(..........r|
-00000040  bd f8 bf df 18 6c d6 2b  d4 16 1a f7 71 a2 9c ea  |.....l.+....q...|
-00000050  ba ec 40 12 48 67 1c 05  b2 ff 1c 0a ad           |..@.Hg.......|
+00000030  16 03 03 00 20 5a b9 f7  81 81 7f 65 84 c9 87 40  |.... Z.....e...@|
+00000040  a4 66 07 85 38 3b 85 8d  ff c4 7e b7 f6 16 1d c1  |.f..8;....~.....|
+00000050  36 4f 53 1a bb                                    |6OS..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 98 d1 ca 15 41  |..........(....A|
-00000010  e6 74 f1 06 00 0a a4 a0  a6 f5 30 57 3e 2a dc d2  |.t........0W>*..|
-00000020  18 d0 f7 5c 1a 36 7d 48  4e 40 18 e5 37 63 54 9c  |...\.6}HN@..7cT.|
-00000030  c9 e3 19                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 20 ff b2 f4 3b af  |.......... ...;.|
+00000010  ba 44 66 0b f9 31 09 18  df 9d d0 04 82 38 11 dd  |.Df..1.......8..|
+00000020  a7 ee 83 ef 03 51 21 08  f9 c4 8a                 |.....Q!....|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 20 22 c4  |............. ".|
-00000010  04 54 71 8c b7 b8 40 6e  88 20 99 8b ab 7f 77 c3  |.Tq...@n. ....w.|
-00000020  db 5b 4a                                          |.[J|
+00000000  17 03 03 00 16 b6 45 4e  35 df 21 f4 c7 24 ba e6  |......EN5.!..$..|
+00000010  18 65 1c 75 ba 72 5d 5b  4a fd 78                 |.e.u.r][J.x|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 1c 98 d1 ca  15 41 e6 74 f2 ed f5 22  |.........A.t..."|
-00000010  24 30 61 20 d6 0d d6 52  74 77 8d 7c 4f 94 59 c0  |$0a ...Rtw.|O.Y.|
-00000020  ff                                                |.|
+00000000  16 03 03 00 14 1a ec 37  ab 36 23 80 76 1c 0b d0  |.......7.6#.v...|
+00000010  54 9a 8f 7e 7a c0 bd 09  9a                       |T..~z....|
 >>> Flow 7 (client to server)
-00000000  16 03 03 00 b1 00 00 00  00 00 00 00 02 47 13 39  |.............G.9|
-00000010  b8 9c a3 ec b6 be b3 d9  0c 73 98 14 cc 58 c4 06  |.........s...X..|
-00000020  4a ae ea 14 32 31 83 8f  73 33 56 bf f1 66 2f 48  |J...21..s3V..f/H|
-00000030  2d d3 6b 71 84 13 ae 13  05 26 71 08 47 dd 44 64  |-.kq.....&q.G.Dd|
-00000040  a9 81 d4 a2 19 9b 42 86  be 39 e1 ce 71 8b bf f0  |......B..9..q...|
-00000050  7c 81 e6 bd 53 3b 20 f8  8e 07 11 09 39 d0 6e 2c  ||...S; .....9.n,|
-00000060  9f 10 7b 2a b2 5b 53 5c  1b 20 13 91 8f bb 2f 55  |..{*.[S\. ..../U|
-00000070  51 16 42 e4 d4 d0 3c 87  d5 30 20 84 5c 81 b9 83  |Q.B...<..0 .\...|
-00000080  2f 25 1c ae 38 c2 f4 6b  f6 a7 e7 4f eb c8 de 26  |/%..8..k...O...&|
-00000090  9f 16 1e d0 60 e7 8f f7  1c 92 20 69 c0 2d b2 fa  |....`..... i.-..|
-000000a0  25 c2 b1 f0 e9 8d 44 e7  73 03 79 17 82 e7 dc db  |%.....D.s.y.....|
-000000b0  b6 85 a3 a3 3e b6                                 |....>.|
+00000000  16 03 03 00 ad 7a d4 bf  4d bf 48 0a 0f 2c d1 38  |.....z..M.H..,.8|
+00000010  9f 20 f7 c7 36 27 82 d9  5e f4 21 44 0e 75 46 ca  |. ..6'..^.!D.uF.|
+00000020  67 f8 87 6c 4f 1e c7 1e  5f 8d f2 88 58 1b 92 12  |g..lO..._...X...|
+00000030  e0 f6 d5 5c d7 4b 21 b9  8c 93 a8 bc a4 e6 e5 cb  |...\.K!.........|
+00000040  d0 33 eb d5 10 ad 53 50  58 e0 94 f0 b8 52 20 8c  |.3....SPX....R .|
+00000050  c2 69 7a c3 43 73 3f 2e  4a 42 2c c1 8d c1 ff 1e  |.iz.Cs?.JB,.....|
+00000060  57 ba 7d 99 9c a2 10 99  19 d6 72 38 96 ba 2b ff  |W.}.......r8..+.|
+00000070  7b a8 42 c0 c0 c4 d4 50  20 39 39 b8 18 23 a1 d3  |{.B....P 99..#..|
+00000080  38 d3 9d 41 81 c2 4b ba  4c 28 c0 14 22 71 df d9  |8..A..K.L(.."q..|
+00000090  e1 57 fc 9c 4f 0e 28 9a  13 c6 a1 e2 de f0 81 3b  |.W..O.(........;|
+000000a0  5f c1 7b 61 f5 fc 74 93  f1 06 7d 9b 67 56 45 a4  |_.{a..t...}.gVE.|
+000000b0  f8 83                                             |..|
 >>> Flow 8 (server to client)
-00000000  16 03 03 00 89 98 d1 ca  15 41 e6 74 f3 d7 25 44  |.........A.t..%D|
-00000010  8b c1 d3 1c 83 97 ee b8  b8 37 dc 86 dd 19 19 82  |.........7......|
-00000020  45 23 03 e0 d1 55 bf 62  17 c8 b1 fa 7d f1 8e 3b  |E#...U.b....}..;|
-00000030  5f 34 71 81 46 53 30 29  ee 3e 2d 53 38 fd 90 8a  |_4q.FS0).>-S8...|
-00000040  d4 85 b6 5c c3 80 35 7c  8e c0 f1 5b 8a 53 4b 06  |...\..5|...[.SK.|
-00000050  6e d8 41 84 b3 3a 87 da  04 fb 56 af fe 14 4a 6e  |n.A..:....V...Jn|
-00000060  7c ac 93 2b 0d 08 4f d7  50 63 b0 31 5d 91 a6 b0  ||..+..O.Pc.1]...|
-00000070  3f 46 db ba f2 ba 37 65  e6 23 87 37 84 47 3f e6  |?F....7e.#.7.G?.|
-00000080  b2 93 f3 19 d1 3e a6 cb  b1 c0 62 4f 33 2e 16 03  |.....>....bO3...|
-00000090  03 02 71 98 d1 ca 15 41  e6 74 f4 6c e2 59 a3 1e  |..q....A.t.l.Y..|
-000000a0  f8 fb 6d 47 5f 18 58 5c  c5 67 d5 fe df f7 1c fc  |..mG_.X\.g......|
-000000b0  5d f8 74 0e 88 d8 2e 2e  50 e2 c0 b3 9d 18 73 9c  |].t.....P.....s.|
-000000c0  2c ea cf cb 52 81 74 c6  f8 af d7 5f 5c 40 96 97  |,...R.t...._\@..|
-000000d0  64 ea c1 d8 88 2c 05 2c  59 0b 20 eb d6 c2 e0 b3  |d....,.,Y. .....|
-000000e0  f8 42 c4 4d c1 5a b3 9a  c7 22 e3 66 4f 29 59 f2  |.B.M.Z...".fO)Y.|
-000000f0  ba 0c 6b 61 c4 9b a6 52  12 42 8f 7c d7 f0 4a 09  |..ka...R.B.|..J.|
-00000100  76 e0 45 52 9b 4e da 0f  80 43 16 73 5c cf 3f b0  |v.ER.N...C.s\.?.|
-00000110  e8 7a 78 a1 09 e3 89 d5  1f ff 5e d9 25 5f dc f9  |.zx.......^.%_..|
-00000120  16 f4 07 ea a1 0f e3 39  eb fe 42 22 80 7a be 49  |.......9..B".z.I|
-00000130  93 86 ed 39 e6 b6 ec 35  88 ec 02 03 a7 3d cc 21  |...9...5.....=.!|
-00000140  cf 0c 51 66 68 a9 9e a5  99 5e 6e 08 f2 38 96 35  |..Qfh....^n..8.5|
-00000150  8e e8 6f 73 92 39 39 af  ce 29 13 ed a7 53 78 26  |..os.99..)...Sx&|
-00000160  03 ba c2 dc 01 54 16 3b  d2 c3 bd cc 96 31 94 d1  |.....T.;.....1..|
-00000170  2a 97 59 8c 27 e2 3f e3  c5 69 83 81 48 27 a1 6f  |*.Y.'.?..i..H'.o|
-00000180  e6 ef a2 0b 0a ba b9 11  ed fc 0f f8 63 b9 66 55  |............c.fU|
-00000190  f4 1c 62 2b ba 11 9f 26  3a 35 b0 df 64 6f 4c 1f  |..b+...&:5..doL.|
-000001a0  9f 91 61 81 1e 8b 2c 9b  d9 7a d7 9b 2b 0c 9a 6e  |..a...,..z..+..n|
-000001b0  82 4f 31 89 ff 53 19 71  a4 74 bd 8f e4 54 fd db  |.O1..S.q.t...T..|
-000001c0  23 33 f6 b4 db d8 2b 95  f9 47 50 6b 5e 43 3e dc  |#3....+..GPk^C>.|
-000001d0  25 4d 79 06 38 4c 55 13  4f a1 27 c5 4a 47 10 5a  |%My.8LU.O.'.JG.Z|
-000001e0  a0 0e 05 dd 0d ab a8 c5  d2 3b 1f 9a 32 19 4c 4b  |.........;..2.LK|
-000001f0  c0 40 33 e8 65 8c d7 8a  25 4f f7 7c 66 d7 d9 cd  |.@3.e...%O.|f...|
-00000200  60 bf bb 9f f7 2f 93 ba  bb b0 57 b3 3a 5d 17 61  |`..../....W.:].a|
-00000210  b8 a6 5e 01 da 1a f1 d7  99 eb 33 c2 b6 b0 1d fd  |..^.......3.....|
-00000220  2d ba 6c af 51 ba 40 25  dc 52 0e de d4 9a b7 03  |-.l.Q.@%.R......|
-00000230  e2 95 a0 da 1c 0c 05 d8  77 3e 0d 47 96 9d a1 cc  |........w>.G....|
-00000240  5b ce 3b 11 26 45 52 5a  40 cb 37 27 a5 1a b3 0f  |[.;.&ERZ@.7'....|
-00000250  cb c3 cf 13 1b 86 5c 78  84 09 de d9 34 18 f1 f0  |......\x....4...|
-00000260  94 70 46 01 04 21 c5 3a  7e c2 36 70 c5 c3 aa b5  |.pF..!.:~.6p....|
-00000270  7d 27 83 19 76 07 8b 33  cf 5d 4b 16 92 22 66 b4  |}'..v..3.]K.."f.|
-00000280  a3 55 86 15 80 21 0c 8e  18 fa c7 c3 47 82 b3 fa  |.U...!......G...|
-00000290  d7 2b 86 26 6d fb f1 ca  81 37 2e 0e e0 c5 f5 4d  |.+.&m....7.....M|
-000002a0  d5 40 15 df 63 de 9e 4d  52 6f ed b4 a3 62 72 c3  |.@..c..MRo...br.|
-000002b0  3e 04 9a 5f 1e a4 74 03  bf cc 41 c9 ca cf a5 08  |>.._..t...A.....|
-000002c0  57 af b6 43 5b 32 b8 74  03 20 c0 aa 90 be 0a fd  |W..C[2.t. ......|
-000002d0  50 69 b6 33 e2 b3 69 a8  b0 ab 72 bc 22 ea be 6a  |Pi.3..i...r."..j|
-000002e0  4f 6a 62 d8 29 e4 e1 09  76 5c bd 26 ff d6 9b 95  |Ojb.)...v\.&....|
-000002f0  50 f0 d1 4c e5 70 fc 97  a9 5f b9 c6 48 bc a4 e2  |P..L.p..._..H...|
-00000300  cc ab f9 e2 16 03 03 00  c4 98 d1 ca 15 41 e6 74  |.............A.t|
-00000310  f5 d6 42 53 94 36 97 0f  18 0f 9a a9 86 8b 8a 97  |..BS.6..........|
-00000320  8a 73 11 a5 9d f0 d0 a6  a0 4f de 52 dd a0 c3 be  |.s.......O.R....|
-00000330  82 33 a7 16 f1 57 58 59  e0 d4 41 5e da 3e fc 6e  |.3...WXY..A^.>.n|
-00000340  f7 90 57 10 6b 2f 04 ff  cb 2d fe 75 3a 79 62 2e  |..W.k/...-.u:yb.|
-00000350  ba 2b e1 2b c7 89 4e 26  8d bf 5b af e8 20 e7 fd  |.+.+..N&..[.. ..|
-00000360  ca 4e f1 6f 4b 12 9c 70  47 0e 7d c5 ab 53 fe 13  |.N.oK..pG.}..S..|
-00000370  4a e4 39 c1 4b 41 68 60  c8 19 ad 38 3d eb 4c 01  |J.9.KAh`...8=.L.|
-00000380  fc 60 e1 bb c4 34 dd 33  43 2e 6b 3c 00 23 8c ce  |.`...4.3C.k<.#..|
-00000390  a8 5c 9f 20 4f 62 2a c2  9c cd 33 a6 16 7b 9c 46  |.\. Ob*...3..{.F|
-000003a0  71 7d c6 22 6a 40 57 b4  4c 67 79 32 8c 6f 40 d5  |q}."j@W.Lgy2.o@.|
-000003b0  76 ba 6e a4 76 84 72 6c  e2 96 9d 88 d2 43 a5 03  |v.n.v.rl.....C..|
-000003c0  62 b4 4f 52 95 8c 27 85  d5 bc f7 de bb 16 03 03  |b.OR..'.........|
-000003d0  00 42 98 d1 ca 15 41 e6  74 f6 36 a4 20 03 5b 37  |.B....A.t.6. .[7|
-000003e0  ea 7f 6c eb 47 8e 79 f8  ed e0 8d de 34 65 ae 01  |..l.G.y.....4e..|
-000003f0  7f c7 24 41 dc d5 3d ee  95 6c f7 32 08 59 69 e7  |..$A..=..l.2.Yi.|
-00000400  7f 8c c6 e2 50 47 ae d7  85 b2 82 4b e5 43 06 97  |....PG.....K.C..|
-00000410  18 69 5c 95 16 03 03 00  1c 98 d1 ca 15 41 e6 74  |.i\..........A.t|
-00000420  f7 9c 19 d2 d1 dd 9e 24  52 ed 31 8a 49 42 20 56  |.......$R.1.IB V|
-00000430  1e f3 b5 a6 e6                                    |.....|
+00000000  16 03 03 00 81 ec 0e 7c  60 5b ed 0f 29 e6 cd 3a  |.......|`[..)..:|
+00000010  ca ff f7 68 3e 22 30 cf  43 b2 29 71 ca 3a 06 db  |...h>"0.C.)q.:..|
+00000020  e0 df bc 87 51 62 df 37  37 7a 9d b4 2d 35 ab bb  |....Qb.77z..-5..|
+00000030  d2 ed d1 50 e7 61 a4 27  18 43 23 74 4b 1d 14 46  |...P.a.'.C#tK..F|
+00000040  80 5c 10 99 10 47 b2 51  92 11 1f aa f1 5a c3 cf  |.\...G.Q.....Z..|
+00000050  f5 30 69 96 26 f6 0e 7c  e9 e1 7c 4b d5 2f 46 1c  |.0i.&..|..|K./F.|
+00000060  7d 18 a5 20 f1 ff 40 9e  c7 d5 d4 54 33 c4 99 9c  |}.. ..@....T3...|
+00000070  26 95 d9 ca 82 fc e7 27  37 fc 33 9f f8 c7 cb 0a  |&......'7.3.....|
+00000080  9d 4e bc 66 ca fc 16 03  03 02 69 ab be 55 39 99  |.N.f......i..U9.|
+00000090  ac 66 a6 86 03 51 70 d8  fa 7d e7 89 09 fc eb b5  |.f...Qp..}......|
+000000a0  25 f6 95 0c 40 3d b8 ea  b6 78 41 db a4 f3 92 83  |%...@=...xA.....|
+000000b0  00 c8 8d 1f 19 0c ec ec  e5 60 07 d9 31 2d 3b 91  |.........`..1-;.|
+000000c0  ba ad b3 c1 fb b5 57 52  73 37 43 89 22 e0 45 7c  |......WRs7C.".E||
+000000d0  b0 da 1f 69 76 d3 af fc  ba f0 98 ec d2 7f be f0  |...iv...........|
+000000e0  a4 76 f0 d9 30 1b 78 22  bb 43 fd 45 64 07 e4 64  |.v..0.x".C.Ed..d|
+000000f0  c5 74 2f ed ba 23 8d 3a  5a ff 7f 35 de 25 53 0d  |.t/..#.:Z..5.%S.|
+00000100  ac ae 5b da b1 7d 86 fe  da c8 9e 79 58 6c 4c 9c  |..[..}.....yXlL.|
+00000110  6d f9 e9 1d 31 ff aa fb  8e 2e 98 f4 3a 67 33 9b  |m...1.......:g3.|
+00000120  a3 63 5e fc 74 f5 c5 28  76 30 e6 22 8a 85 79 56  |.c^.t..(v0."..yV|
+00000130  4e cf 94 38 92 61 09 22  00 95 d4 16 b4 e0 80 05  |N..8.a."........|
+00000140  28 35 30 6f 56 7d f8 b9  ed 49 72 b0 9f 47 9f 07  |(50oV}...Ir..G..|
+00000150  7f 1d b9 3b 6d ce c9 09  72 2f 65 b0 88 b4 ec 24  |...;m...r/e....$|
+00000160  29 8d 57 93 a7 51 85 32  26 4c 31 21 24 b1 ab 97  |).W..Q.2&L1!$...|
+00000170  c6 3c 38 44 d4 8f d0 3b  ea 62 39 48 90 ca c4 5c  |.<8D...;.b9H...\|
+00000180  9c 72 08 a4 3f d0 1e 3e  9f 23 02 0e 94 b4 14 cc  |.r..?..>.#......|
+00000190  96 bc 23 22 2f af c5 ed  81 da 49 ca 26 f4 55 6a  |..#"/.....I.&.Uj|
+000001a0  b3 24 3f 13 a5 f7 d6 82  70 04 37 63 dc 92 63 0f  |.$?.....p.7c..c.|
+000001b0  3d f7 4e 42 7c 5a 42 df  53 17 48 25 cb da 31 e1  |=.NB|ZB.S.H%..1.|
+000001c0  67 a7 22 8c ca db 2d 33  49 86 62 b5 ba 38 53 4c  |g."...-3I.b..8SL|
+000001d0  12 f3 c3 f6 b6 01 53 b1  11 43 e1 e8 ba 3f 68 7a  |......S..C...?hz|
+000001e0  9c 10 09 82 d1 90 cd 9e  52 2e 29 15 0b 13 c3 e3  |........R.).....|
+000001f0  34 ef 76 8a 0d f9 f6 17  76 57 c2 55 cb 7d 45 e0  |4.v.....vW.U.}E.|
+00000200  d5 e6 53 93 75 57 c2 ab  26 5a 13 02 05 7a 60 2b  |..S.uW..&Z...z`+|
+00000210  b6 92 1a 88 0c 34 59 81  40 42 70 d5 4e 7b d3 14  |.....4Y.@Bp.N{..|
+00000220  3c e6 70 81 90 ff 53 79  c5 f3 7c d9 02 6f 35 6b  |<.p...Sy..|..o5k|
+00000230  d4 81 ff 32 a2 71 28 a0  4b 22 75 9f 3b 50 c8 03  |...2.q(.K"u.;P..|
+00000240  22 e7 4f 1f c5 c5 99 67  f3 2c 97 5e 43 89 84 39  |".O....g.,.^C..9|
+00000250  04 c9 4c 1e e0 da 39 8f  78 8f 95 3a 64 74 d3 63  |..L...9.x..:dt.c|
+00000260  13 d4 14 9d 98 6c bb 27  81 1e 12 88 8c d4 11 1c  |.....l.'........|
+00000270  4a 71 2f 10 dc 5b 9a 8e  70 e6 bf 0b a2 50 4c d1  |Jq/..[..p....PL.|
+00000280  c4 29 b7 85 9e 0f 86 33  7c 38 e4 ae d4 53 5e 81  |.).....3|8...S^.|
+00000290  95 cf 6c 1a 15 7d af 20  53 21 f4 84 5c 46 5f 10  |..l..}. S!..\F_.|
+000002a0  1f 68 7d 9a 20 0d a8 1f  90 2f ae b8 c0 57 e0 4b  |.h}. ..../...W.K|
+000002b0  ad ec 9d ae 51 52 78 5d  3f bb de 54 54 d4 18 ff  |....QRx]?..TT...|
+000002c0  e6 b4 c9 52 f8 66 63 e3  bf 7a f3 5e c6 3f d9 27  |...R.fc..z.^.?.'|
+000002d0  71 07 e7 69 6d cb 60 24  55 4e f9 34 e7 5f a3 37  |q..im.`$UN.4._.7|
+000002e0  76 90 ec b5 eb ff 49 38  15 71 23 fd 77 30 80 c8  |v.....I8.q#.w0..|
+000002f0  ca 0e 38 3c 16 03 03 00  bc 89 27 c8 13 dd 05 8b  |..8<......'.....|
+00000300  46 97 5f 19 76 db 29 8d  b1 24 52 fe 7a 2e 2c 4d  |F._.v.)..$R.z.,M|
+00000310  e2 f9 59 89 48 82 f5 d7  87 af 99 4b 98 c5 7c 1d  |..Y.H......K..|.|
+00000320  1a e1 4d fd 0c 37 d0 d3  d8 e2 f8 0f 04 d5 15 21  |..M..7.........!|
+00000330  60 09 47 0c d6 bf 09 bf  55 c1 ae 33 11 35 94 29  |`.G.....U..3.5.)|
+00000340  80 96 3a 53 ae a8 29 c4  84 37 e2 80 f9 da 79 18  |..:S..)..7....y.|
+00000350  77 50 26 32 bf f6 b2 6d  3a 73 25 e7 cd 34 6d ea  |wP&2...m:s%..4m.|
+00000360  a0 92 40 7e f8 eb d0 82  06 b3 a1 f5 1c 8e b2 ef  |..@~............|
+00000370  b2 4f 0c bb 04 1b c7 cf  bc dd 42 19 00 3e 45 93  |.O........B..>E.|
+00000380  e6 72 57 ed eb d9 1d b3  71 b7 fe 84 03 57 e4 9c  |.rW.....q....W..|
+00000390  71 78 35 39 63 b1 cf 36  b9 5a d6 95 13 ee 4d 2f  |qx59c..6.Z....M/|
+000003a0  22 ef ed 2e fc 69 7c 12  c2 0e 32 ed 05 17 42 5c  |"....i|...2...B\|
+000003b0  a7 62 ab 6b 46 16 03 03  00 3a b9 af 3d 25 e4 6a  |.b.kF....:..=%.j|
+000003c0  a9 b5 b4 00 79 21 aa 3c  f3 56 50 bd 32 a4 a8 ab  |....y!.<.VP.2...|
+000003d0  8a 60 77 5d b7 3e 89 d3  60 a2 b8 5c a8 99 27 bb  |.`w].>..`..\..'.|
+000003e0  0e dd 93 af 3e 2b 66 8e  56 19 03 29 44 6a 63 a1  |....>+f.V..)Djc.|
+000003f0  c7 17 f3 1e 16 03 03 00  14 1c bd e4 7b c3 88 d9  |............{...|
+00000400  be ba c3 c3 fb b7 07 9d  f1 58 3e b0 61           |.........X>.a|
 >>> Flow 9 (client to server)
-00000000  16 03 03 02 71 00 00 00  00 00 00 00 03 3c 02 ab  |....q........<..|
-00000010  79 07 da ce 77 c0 2f 8d  8e 8f 9d 3c 31 9d fc 91  |y...w./....<1...|
-00000020  92 bc 88 b1 e7 3a ad 80  f5 ea 4f 61 85 ff 51 e1  |.....:....Oa..Q.|
-00000030  0a 97 fe e5 cc bb 05 88  4d e3 01 88 30 03 2b 7c  |........M...0.+||
-00000040  3d ab 9a c4 bf da cc 60  38 cd c0 e0 9f 10 d0 38  |=......`8......8|
-00000050  ac b5 68 52 f2 31 b8 12  90 c3 9d 2d 81 7c 6d d8  |..hR.1.....-.|m.|
-00000060  3c 92 a8 a2 df 08 fe 59  fa 44 38 d5 5a f4 5f 10  |<......Y.D8.Z._.|
-00000070  d9 ba 93 a8 fc 25 64 18  52 8e 14 e7 e9 02 5f 6a  |.....%d.R....._j|
-00000080  ee a6 7f 9a 56 60 fc 38  a3 fa f3 58 6b e1 21 98  |....V`.8...Xk.!.|
-00000090  67 9b 21 81 bb 62 55 8a  6a 23 54 38 89 9a 56 2e  |g.!..bU.j#T8..V.|
-000000a0  4c 11 ed 62 33 36 1d 86  92 72 05 63 b1 1f 2d f4  |L..b36...r.c..-.|
-000000b0  59 57 9b 3b 5a cb ab 57  c9 8a 02 da 25 a9 41 97  |YW.;Z..W....%.A.|
-000000c0  26 1b b1 3e 80 ff b8 2c  17 28 46 22 f3 6d 73 f6  |&..>...,.(F".ms.|
-000000d0  d1 59 73 73 a9 4a e9 6b  60 7f 2d 02 4a b3 f9 27  |.Yss.J.k`.-.J..'|
-000000e0  97 40 50 be 4d 2c f8 b4  ef e7 ac 37 dd 09 c8 ef  |.@P.M,.....7....|
-000000f0  95 9b fd 7e ef 4d bc c0  98 f3 60 04 7a bf fc f4  |...~.M....`.z...|
-00000100  c8 48 cf 4a ab a0 7d 2f  97 09 0f 11 28 6d 97 d3  |.H.J..}/....(m..|
-00000110  4e b4 8f 89 16 f6 f4 6a  d4 cc bb b4 06 47 7d b9  |N......j.....G}.|
-00000120  b4 ae bf 82 02 d3 2c 7b  c0 cc 58 8c f8 88 a5 6f  |......,{..X....o|
-00000130  e3 2c 74 ad 29 a3 3e c5  5d d2 62 01 c6 a3 0c d2  |.,t.).>.].b.....|
-00000140  d1 fd cc c3 52 97 97 07  6f 87 a2 ae 8f 47 4e c6  |....R...o....GN.|
-00000150  5a ac 35 a2 d1 e0 bb de  fc c3 62 b6 e5 53 fb 09  |Z.5.......b..S..|
-00000160  1f a9 fb 41 d3 47 63 2b  f2 e6 a4 a8 47 f5 fb 41  |...A.Gc+....G..A|
-00000170  f1 f5 31 a3 04 ff 1f 5e  f0 e9 9e ad 13 34 de cc  |..1....^.....4..|
-00000180  97 28 e3 bd c4 2f d0 8b  05 50 34 14 82 05 5b ff  |.(.../...P4...[.|
-00000190  ac a2 08 08 9e 68 39 e8  9b 68 e4 f5 67 c0 15 7c  |.....h9..h..g..||
-000001a0  07 15 51 9e 99 bd fe e7  e6 77 a4 ef d9 61 a1 bf  |..Q......w...a..|
-000001b0  ac 66 79 7f e0 d2 e9 48  34 82 56 8f 17 e3 7b 11  |.fy....H4.V...{.|
-000001c0  47 9b b0 c9 14 73 2e d6  8c c2 9a f5 06 96 13 0f  |G....s..........|
-000001d0  9d 2e 10 06 e6 49 2a 73  14 8b 5c 92 83 a0 65 2a  |.....I*s..\...e*|
-000001e0  8a 44 83 cf d0 6a c1 09  42 fa f3 f4 cd d5 58 cf  |.D...j..B.....X.|
-000001f0  e2 aa 4e f5 01 56 2d 52  c5 84 96 af 2d af 79 41  |..N..V-R....-.yA|
-00000200  9f 39 96 54 27 64 93 e0  dd be 0a 08 dd 65 d6 38  |.9.T'd.......e.8|
-00000210  f1 c6 db 40 6b f5 b7 05  86 f6 f2 31 7e 87 ed 07  |...@k......1~...|
-00000220  58 55 9a 0a f9 a0 c1 32  18 f3 34 ad a5 f5 71 37  |XU.....2..4...q7|
-00000230  1b a2 f6 ed 9f 03 ad 68  4f 5d 43 5a a7 a9 46 8e  |.......hO]CZ..F.|
-00000240  2f d9 8c 9c d5 b9 04 57  4b b1 df 16 ec 6d 79 6e  |/......WK....myn|
-00000250  f2 6b ea 91 f8 ca 36 09  0e 1a ac e7 71 db 8c 26  |.k....6.....q..&|
-00000260  cd 6c 94 92 38 26 34 2d  87 b4 86 91 16 ff 4d a6  |.l..8&4-......M.|
-00000270  b1 a7 49 8d 45 8e 16 03  03 00 3d 00 00 00 00 00  |..I.E.....=.....|
-00000280  00 00 04 d2 19 0e 9e 8f  9a f8 e4 ff 12 43 94 ca  |.............C..|
-00000290  d0 f0 6e 04 ee a2 ce 85  10 82 d5 a9 eb 68 8f b4  |..n..........h..|
-000002a0  c5 b1 f6 3d 5b 2b f2 6b  2d c9 47 11 69 33 86 ef  |...=[+.k-.G.i3..|
-000002b0  5e 64 6c 47 1d 3b 0a 5e  16 03 03 00 a0 00 00 00  |^dlG.;.^........|
-000002c0  00 00 00 00 05 af 3b d3  9b dc eb 85 66 b9 5a 29  |......;.....f.Z)|
-000002d0  ca b9 ad a5 52 31 2e 11  21 b8 b9 93 5e 69 7a 65  |....R1..!...^ize|
-000002e0  b9 68 d2 b1 4e d9 28 ea  d6 70 0e 7d 02 f7 d7 fc  |.h..N.(..p.}....|
-000002f0  86 0b d3 fa 48 8f 84 2e  1a b9 94 59 43 27 39 e8  |....H......YC'9.|
-00000300  ed 53 22 57 5d 75 1a 8c  b5 71 01 83 08 a3 56 d8  |.S"W]u...q....V.|
-00000310  a0 b8 cd 58 95 ca 6a c2  44 73 f3 a2 67 83 a1 be  |...X..j.Ds..g...|
-00000320  ec 33 58 b9 fd 24 8a c2  b2 93 18 70 05 04 3c 70  |.3X..$.....p..<p|
-00000330  60 b3 6f e4 9f 31 01 82  be 86 5b b4 9a 57 84 6d  |`.o..1....[..W.m|
-00000340  08 4a a6 23 0d 73 48 15  34 32 f6 0f a2 a6 d6 24  |.J.#.sH.42.....$|
-00000350  95 fe b0 0d e7 f1 bf 2e  14 c8 af 59 5a 14 03 03  |...........YZ...|
-00000360  00 19 00 00 00 00 00 00  00 06 d7 0d 95 8b 51 4b  |..............QK|
-00000370  ee e9 14 c0 ca 96 29 cf  21 80 1c 16 03 03 00 28  |......).!......(|
-00000380  00 00 00 00 00 00 00 00  7c 2b d1 a3 a4 f7 6a a3  |........|+....j.|
-00000390  c1 da 0a 0f 8f 85 b0 01  1d 19 fc 90 c7 16 1d 8e  |................|
-000003a0  58 06 ed 0f f3 b5 3c fd                           |X.....<.|
+00000000  16 03 03 02 69 d3 b2 83  ca 08 61 36 6f fa 66 de  |....i.....a6o.f.|
+00000010  5c 42 5f 35 17 f4 4c b3  5e 17 94 07 c5 2a 89 90  |\B_5..L.^....*..|
+00000020  b8 31 50 af 55 91 b1 28  bc 00 00 da 57 85 cc d5  |.1P.U..(....W...|
+00000030  a5 a7 ec ba 52 d5 1f ab  b5 4f a3 53 9c af 59 20  |....R....O.S..Y |
+00000040  be 13 f6 c5 70 b0 cc f7  59 69 d1 db 80 7f 60 29  |....p...Yi....`)|
+00000050  e1 e8 7a 1e 97 a6 e1 a2  11 70 4f b4 7b 53 7c 9a  |..z......pO.{S|.|
+00000060  dd fa 58 5d 12 a4 fb 3e  46 dd d3 4d ac e3 b6 73  |..X]...>F..M...s|
+00000070  05 42 03 f3 37 79 a0 10  34 ef 01 6f c6 27 52 4b  |.B..7y..4..o.'RK|
+00000080  75 4c b2 86 1b d6 ca 13  b4 31 41 db 93 2f a3 35  |uL.......1A../.5|
+00000090  e1 e9 bc 65 85 c8 1a e2  7b 6e 36 49 e8 ed 04 a9  |...e....{n6I....|
+000000a0  cb a9 70 32 c0 4d e5 f5  94 d8 af 7d 41 b6 dc e5  |..p2.M.....}A...|
+000000b0  fc ff db 9f 91 50 df c6  b2 4a 0c bb 86 4e 50 a5  |.....P...J...NP.|
+000000c0  2a 3b 69 e2 3d fa 10 eb  cc 48 21 9d 98 78 02 0b  |*;i.=....H!..x..|
+000000d0  e7 4d 83 63 9e e5 ad 2c  7b 46 d1 09 28 35 07 6c  |.M.c...,{F..(5.l|
+000000e0  12 c9 ae f0 4c 7c 00 aa  54 ba 7b e8 42 be e0 18  |....L|..T.{.B...|
+000000f0  f4 df a0 9d eb 8f a2 3a  d0 00 b6 e0 eb 90 65 38  |.......:......e8|
+00000100  b2 cc 21 87 57 b7 50 07  41 e2 5a 9b c8 2b ae 64  |..!.W.P.A.Z..+.d|
+00000110  55 6a d7 b5 0d 5d f0 ac  da 0b f0 80 75 8d 6a 0a  |Uj...]......u.j.|
+00000120  5b c5 2a 20 f2 ab 75 76  a3 33 f1 43 24 06 45 75  |[.* ..uv.3.C$.Eu|
+00000130  63 58 60 57 ca 7f d2 8f  e8 a5 b8 e3 72 37 39 bd  |cX`W........r79.|
+00000140  9c dd 10 b0 f8 b5 e8 46  4a 39 ac 94 69 08 51 29  |.......FJ9..i.Q)|
+00000150  27 2d 28 0f 15 8a 91 00  3b cc 99 77 ea 82 0d e1  |'-(.....;..w....|
+00000160  66 ed 34 da 6e 88 47 e5  f4 1b 28 28 cd 38 9f e5  |f.4.n.G...((.8..|
+00000170  1c 26 67 3d 83 d0 b1 88  a3 08 9c 2e 08 a5 b7 af  |.&g=............|
+00000180  15 28 d5 1e aa c9 58 17  48 85 f7 13 17 6f 55 c3  |.(....X.H....oU.|
+00000190  dc 9d 2e 7e 67 45 7a cb  80 a7 e5 77 86 96 36 4d  |...~gEz....w..6M|
+000001a0  f7 df 27 7d f4 5d 53 9b  be e6 b2 b9 44 b9 86 e9  |..'}.]S.....D...|
+000001b0  8f 33 26 4e 20 97 e4 34  66 58 6d d5 28 be e8 84  |.3&N ..4fXm.(...|
+000001c0  de 2f 19 f2 46 52 80 84  e9 ef 0e 6c 55 5c 43 8c  |./..FR.....lU\C.|
+000001d0  51 19 8b 22 30 b7 b3 eb  9f ed 35 a1 fe 09 aa 6a  |Q.."0.....5....j|
+000001e0  f8 b6 37 7e 20 4c e5 76  ae 10 4c dd 67 7c 07 e2  |..7~ L.v..L.g|..|
+000001f0  0c dc 78 77 a1 8e c1 d1  aa fa d3 36 8b 9c 74 ed  |..xw.......6..t.|
+00000200  e2 fe 84 98 40 95 f2 1a  a6 fd 77 cf 47 d3 c3 d6  |....@.....w.G...|
+00000210  bc 38 45 a9 94 63 13 52  2d 7b 3f 3d 06 1e 0a 31  |.8E..c.R-{?=...1|
+00000220  cb 98 1d 18 fa a7 86 21  65 c7 58 dd 78 13 2d 4d  |.......!e.X.x.-M|
+00000230  76 57 9d 65 15 a3 2d be  7f c9 58 78 b7 89 3c d6  |vW.e..-...Xx..<.|
+00000240  dc 7e 5b c5 1b 93 78 04  7b ca ef 61 77 6c 27 6b  |.~[...x.{..awl'k|
+00000250  a5 30 67 43 64 a7 30 f0  dd 5c 63 92 76 9a e3 a2  |.0gCd.0..\c.v...|
+00000260  31 12 49 8e c4 7e 80 ce  1e ce 94 66 2f 6f 16 03  |1.I..~.....f/o..|
+00000270  03 00 35 39 86 a0 5a 88  07 66 5f 43 59 ed fb b5  |..59..Z..f_CY...|
+00000280  0c 0b ee ff 76 62 28 ea  62 7e 53 72 3d d9 26 9f  |....vb(.b~Sr=.&.|
+00000290  06 64 99 83 a5 3c 59 45  84 4d 79 86 1d b4 21 14  |.d...<YE.My...!.|
+000002a0  29 df f1 99 aa 6a 64 91  16 03 03 00 98 22 32 c2  |)....jd......"2.|
+000002b0  63 2c 82 b9 47 02 65 97  6b 14 fc 35 b8 20 ce 3c  |c,..G.e.k..5. .<|
+000002c0  1b 16 fd 51 55 e8 31 b5  58 e6 64 a8 2b b0 f2 ab  |...QU.1.X.d.+...|
+000002d0  31 7a cd 3e 32 43 64 eb  08 b0 52 d4 81 56 e3 04  |1z.>2Cd...R..V..|
+000002e0  4e d2 1a b8 f6 ae 64 d2  c0 05 9b 18 84 71 a7 ad  |N.....d......q..|
+000002f0  ea 49 f6 b5 ae 91 ad 66  6f cb fa 56 de 1e 40 22  |.I.....fo..V..@"|
+00000300  7f d3 44 c4 a7 bf b1 7b  61 e3 09 1f fe 3b 4b 7b  |..D....{a....;K{|
+00000310  5a 3f ae 4e c4 5c a8 ac  a4 c2 fc 0e 1f 12 4f 9b  |Z?.N.\........O.|
+00000320  f9 e0 a2 89 ab a0 bb e8  f9 97 5a 7c 8d e8 58 87  |..........Z|..X.|
+00000330  3f 4c 1c f3 ff 6e b9 a0  e6 f7 e4 c2 43 cc af 9e  |?L...n......C...|
+00000340  06 3a 1c ee ef 14 03 03  00 11 8b 6d c3 12 83 c4  |.:.........m....|
+00000350  2f e7 67 81 db 18 9a 33  e6 fa 82 16 03 03 00 20  |/.g....3....... |
+00000360  ef c9 6f 3f b7 9d 9d 2d  a0 05 b6 fd 74 8e ff de  |..o?...-....t...|
+00000370  cc 4b ca 4c 5b 4d 61 30  76 b5 f3 7a d1 46 d6 6a  |.K.L[Ma0v..z.F.j|
 >>> Flow 10 (server to client)
-00000000  14 03 03 00 19 98 d1 ca  15 41 e6 74 f8 13 8f 65  |.........A.t...e|
-00000010  bb f3 00 de 62 15 71 01  b1 bd df 37 f6 e4 16 03  |....b.q....7....|
-00000020  03 00 28 25 6e 41 dc 6a  a3 2a 95 39 fc 36 e6 70  |..(%nA.j.*.9.6.p|
-00000030  c6 e5 55 e5 ac 96 04 f1  a2 47 30 b6 10 98 aa 38  |..U......G0....8|
-00000040  79 1d 3f 29 b8 5c 1a b6  6e c8 0f 17 03 03 00 21  |y.?).\..n......!|
-00000050  25 6e 41 dc 6a a3 2a 96  3f e3 66 d8 ca 28 36 ff  |%nA.j.*.?.f..(6.|
-00000060  4a 95 5e a8 31 a3 2d 75  fd d1 80 a4 db 0b 25 ec  |J.^.1.-u......%.|
-00000070  73 16 03 03 00 1c 25 6e  41 dc 6a a3 2a 97 df f5  |s.....%nA.j.*...|
-00000080  9b 44 0e 0c f2 55 ec ed  1a 50 ba d4 70 96 cc fa  |.D...U...P..p...|
-00000090  5e a6                                             |^.|
+00000000  14 03 03 00 11 2e d9 0e  1b 6b 4b 9a 60 96 e9 38  |.........kK.`..8|
+00000010  35 a3 72 3d c4 5b 16 03  03 00 20 62 1f 2b 02 e8  |5.r=.[.... b.+..|
+00000020  22 0a 89 a2 f6 60 8a da  f2 09 52 5a 92 12 a8 f6  |"....`....RZ....|
+00000030  c3 ee 25 17 6b 91 25 3e  2b 75 ba 17 03 03 00 19  |..%.k.%>+u......|
+00000040  b9 4e 6b c3 74 30 39 f9  3f a2 aa af 80 49 6b 8a  |.Nk.t09.?....Ik.|
+00000050  f2 a1 9b f5 c7 34 f7 1b  2f 16 03 03 00 14 2d 25  |.....4../.....-%|
+00000060  74 c2 c7 80 a8 5f 65 ff  65 b0 c2 50 c8 bc fe 8c  |t...._e.e..P....|
+00000070  d4 9e                                             |..|
 >>> Flow 11 (client to server)
-00000000  16 03 03 00 b1 00 00 00  00 00 00 00 01 2e 2c 48  |..............,H|
-00000010  d4 db 08 b2 af c8 68 92  e4 17 d2 b7 cd 56 50 7e  |......h......VP~|
-00000020  ef 8d 7e 0d 14 15 3f e4  12 ec aa 9a ad dd 1c 81  |..~...?.........|
-00000030  5d 5e 79 75 82 0f f6 50  ad 81 33 c3 1d 3c c2 6c  |]^yu...P..3..<.l|
-00000040  6a 2a b7 29 0a e7 ee cf  02 12 39 80 96 47 5e 28  |j*.)......9..G^(|
-00000050  6f 38 e1 52 b9 bb 6b 9a  c9 fa df dc 0d a2 12 1b  |o8.R..k.........|
-00000060  20 f8 2f 94 1a 43 5b ec  b4 e6 0b ef 4d 4d 5e ef  | ./..C[.....MM^.|
-00000070  18 04 54 96 94 9f e6 77  90 30 13 0b 20 00 23 33  |..T....w.0.. .#3|
-00000080  d4 6b fe cb 4d dc 5c b9  e7 7c 43 14 03 f9 ce 11  |.k..M.\..|C.....|
-00000090  07 e2 fd f5 86 ba f4 1f  61 16 86 db c9 78 f8 2a  |........a....x.*|
-000000a0  90 11 56 1e d3 97 33 b0  3a e4 e3 bd 70 d1 89 58  |..V...3.:...p..X|
-000000b0  41 1b a2 d2 77 59                                 |A...wY|
+00000000  16 03 03 00 ad d0 25 9a  38 60 d3 94 8e b8 23 45  |......%.8`....#E|
+00000010  44 67 95 20 79 1a 27 5f  cf bb dc 72 8c 95 2a 02  |Dg. y.'_...r..*.|
+00000020  1d d9 80 c6 61 12 c2 5c  ae d5 62 a9 aa b0 4a d0  |....a..\..b...J.|
+00000030  13 ad 6d ae df c9 63 e2  6b 27 bb ca 88 c3 dc 8b  |..m...c.k'......|
+00000040  e9 bc 0b fb 32 d6 0f 99  b6 d1 03 7e c9 8d 72 ee  |....2......~..r.|
+00000050  09 7b 82 f1 79 11 a7 23  43 8b 77 b8 a9 bd 9e 67  |.{..y..#C.w....g|
+00000060  43 03 79 88 34 ab c2 6b  d1 2a cf c7 c9 b6 14 ee  |C.y.4..k.*......|
+00000070  ee 32 01 10 fb 85 dc 5a  04 cf 9a ea 8d 8c fc f8  |.2.....Z........|
+00000080  b3 b2 49 c0 93 37 93 09  24 1c 26 97 43 5f dd 09  |..I..7..$.&.C_..|
+00000090  7a 0d c0 6c bd 17 df 78  37 3d 23 6b 9d 27 d2 f7  |z..l...x7=#k.'..|
+000000a0  1c 2e 82 5c ba 95 1c 0f  b3 40 af 9f 2f 5e 42 40  |...\.....@../^B@|
+000000b0  cc b9                                             |..|
 >>> Flow 12 (server to client)
-00000000  16 03 03 00 89 25 6e 41  dc 6a a3 2a 98 ae d6 7c  |.....%nA.j.*...||
-00000010  58 19 84 e4 2d 04 bb 86  f2 9e e6 31 23 18 25 9f  |X...-......1#.%.|
-00000020  67 f7 13 ab 3b cb 50 a6  3f 55 fd 55 1f ea cd 49  |g...;.P.?U.U...I|
-00000030  5a ff 31 be 53 73 07 10  28 cd 22 29 3e 85 6c c7  |Z.1.Ss..(.")>.l.|
-00000040  c3 f8 c0 48 ce 97 17 33  4c 39 71 d9 f6 08 a2 9b  |...H...3L9q.....|
-00000050  a7 4b 4d d3 df a4 28 9d  47 a4 72 7c a1 dd 13 23  |.KM...(.G.r|...#|
-00000060  13 c5 46 5b cd 6f 9a 34  d9 0f ac 3d da 91 af 8a  |..F[.o.4...=....|
-00000070  c7 0a 7b de 25 ad aa 97  dc 7f 48 5a e2 0e f5 4a  |..{.%.....HZ...J|
-00000080  a7 75 8b 18 9e 2e a3 2e  95 b5 70 4a 47 e7 16 03  |.u........pJG...|
-00000090  03 02 71 25 6e 41 dc 6a  a3 2a 99 a7 b3 a9 44 0a  |..q%nA.j.*....D.|
-000000a0  b6 2b fa 58 6e 64 2a 55  5e 2c 37 ac de 8c 46 18  |.+.Xnd*U^,7...F.|
-000000b0  81 38 ec b6 d7 07 a7 82  a8 cc 02 8b 52 81 54 9c  |.8..........R.T.|
-000000c0  66 4d d8 0a a5 72 37 0d  53 a2 eb f6 c7 ed 2c da  |fM...r7.S.....,.|
-000000d0  d8 70 ab 8a 10 d5 e6 58  ea f8 0b 55 1d 4f f1 e5  |.p.....X...U.O..|
-000000e0  f9 00 f7 ee 81 a3 8e 8f  21 70 34 10 bc 98 72 de  |........!p4...r.|
-000000f0  8f aa 87 b6 02 75 1a 0f  5d b1 0e 98 1f 49 83 aa  |.....u..]....I..|
-00000100  4f 43 49 65 3f 2e f2 d0  d1 8f b2 ab e1 e4 2d 75  |OCIe?.........-u|
-00000110  2d 4f c7 75 fd 78 aa d7  31 97 b9 dc a6 62 c5 e6  |-O.u.x..1....b..|
-00000120  8d a9 73 f8 2c 14 4c a7  f3 ca ed 98 0e c7 99 51  |..s.,.L........Q|
-00000130  a5 e1 bf af f6 6f 25 fc  6e 71 f3 c9 a1 38 f7 bc  |.....o%.nq...8..|
-00000140  3f f5 29 61 60 26 f2 d4  32 30 6c 09 7d c0 f8 af  |?.)a`&..20l.}...|
-00000150  63 d9 d3 5b e6 c8 af fb  0a 56 ca 61 3f 0c f6 1f  |c..[.....V.a?...|
-00000160  9a 07 2b 8c b0 30 db 2e  e4 b4 82 ad 10 fa 13 88  |..+..0..........|
-00000170  13 06 d3 d6 68 0d 60 ab  d2 24 4b a7 70 ca bb f5  |....h.`..$K.p...|
-00000180  14 ab dc a2 c0 a3 27 98  c4 ba 16 76 4c fb ed 10  |......'....vL...|
-00000190  55 a8 2d 72 80 de d3 72  34 6c 40 46 00 d9 7f 37  |U.-r...r4l@F...7|
-000001a0  2b d7 33 cd e6 78 12 b9  68 56 b8 a9 e9 0c 17 7a  |+.3..x..hV.....z|
-000001b0  66 6a a7 06 d6 de b0 75  9e 9f bf ab 9a 59 b0 7c  |fj.....u.....Y.||
-000001c0  2a 5a d1 af f9 91 dc da  54 95 88 37 2d 05 9a a1  |*Z......T..7-...|
-000001d0  66 32 54 21 32 5f dc 7a  1e 34 36 46 db 46 00 68  |f2T!2_.z.46F.F.h|
-000001e0  11 38 38 13 cb f5 eb d1  57 ed f0 41 02 59 20 c9  |.88.....W..A.Y .|
-000001f0  75 2e bc 65 4c 38 d2 fc  c5 45 6f fa 15 39 44 cf  |u..eL8...Eo..9D.|
-00000200  63 25 c6 06 55 4b 34 af  4c af 0e da cd 1e 25 b5  |c%..UK4.L.....%.|
-00000210  ba 83 1b a4 5a 8d 53 81  3b 51 03 d4 ca 23 cb 03  |....Z.S.;Q...#..|
-00000220  31 97 40 67 98 4b 4c 01  af e2 76 34 b8 b7 3d 64  |1.@g.KL...v4..=d|
-00000230  79 f5 c9 6e bd 9c f2 85  fc 00 70 88 23 66 60 b9  |y..n......p.#f`.|
-00000240  76 fb 14 b6 f1 8d 17 bd  f2 60 97 72 79 85 a5 99  |v........`.ry...|
-00000250  f2 c9 e8 cc ae 41 e8 f4  4b ac b7 0b 41 bb 87 f9  |.....A..K...A...|
-00000260  4d 61 03 b4 b9 cd 5d fb  33 37 7a 5e 3b b3 05 cb  |Ma....].37z^;...|
-00000270  2d bb 71 31 ef 6c 34 93  cd f0 ce fa ce 28 82 c1  |-.q1.l4......(..|
-00000280  1f 9b ec 14 fa 72 77 1b  0b c1 7a 79 97 bd 2d e8  |.....rw...zy..-.|
-00000290  d0 91 02 fe 34 92 34 c4  6f 22 02 99 d6 0e 91 2f  |....4.4.o"...../|
-000002a0  36 2b 61 80 c1 27 c6 6f  71 a0 87 80 f4 8e 7c 65  |6+a..'.oq.....|e|
-000002b0  4e 21 f5 a4 50 5d e4 6a  e4 19 1b b9 0f 88 bb 3f  |N!..P].j.......?|
-000002c0  67 7e c5 b1 7f 99 a6 f2  d9 c6 9b de dd 62 b9 d3  |g~...........b..|
-000002d0  d7 40 05 4a 04 49 a8 3e  84 5b a0 bd d4 b6 2a 15  |.@.J.I.>.[....*.|
-000002e0  19 8f a9 37 9d d1 1f 18  be 46 51 1a 47 ac 89 63  |...7.....FQ.G..c|
-000002f0  5f af 59 ce 05 b3 97 11  b9 a9 c1 a4 89 03 06 ad  |_.Y.............|
-00000300  ff c9 ce 01 16 03 03 00  c4 25 6e 41 dc 6a a3 2a  |.........%nA.j.*|
-00000310  9a f9 98 ae dd 3e ac c5  c9 19 fe 6a 0e a4 4a 03  |.....>.....j..J.|
-00000320  16 e1 d3 fd c3 3a de e5  25 f3 b6 92 fe d4 00 c2  |.....:..%.......|
-00000330  21 25 15 fe a9 5f 74 92  6a 61 90 47 f5 cc ac 9a  |!%..._t.ja.G....|
-00000340  f1 a1 ae 47 77 66 b1 66  9d c4 9f 85 75 c7 7f 3a  |...Gwf.f....u..:|
-00000350  df 78 08 17 a0 a4 35 34  69 af c1 9e d6 f4 9b 1d  |.x....54i.......|
-00000360  54 e7 99 cf f0 d5 99 bd  ae 44 d3 3a 3a d2 b3 4d  |T........D.::..M|
-00000370  10 0e 3f 06 5b 31 c2 a5  23 b1 a2 df 7d 7b 8e fb  |..?.[1..#...}{..|
-00000380  d0 76 b5 5e 38 1e 3e 3a  61 4d 56 cb 43 48 d2 be  |.v.^8.>:aMV.CH..|
-00000390  ec 3b cf 05 52 24 5a cb  a5 3a d4 b6 33 e8 f1 25  |.;..R$Z..:..3..%|
-000003a0  89 72 68 ed 95 9e f9 f9  69 f2 fb 2b 93 35 8f 78  |.rh.....i..+.5.x|
-000003b0  42 13 29 33 9f 79 5c 22  e6 f5 d0 e3 61 da 0e a0  |B.)3.y\"....a...|
-000003c0  1a d4 c2 03 ad ed 11 d0  ec 40 c9 76 27 16 03 03  |.........@.v'...|
-000003d0  00 42 25 6e 41 dc 6a a3  2a 9b 57 3a 29 5f 04 91  |.B%nA.j.*.W:)_..|
-000003e0  df 00 15 50 55 f2 e5 93  58 e8 0a e2 41 3c 3f 34  |...PU...X...A<?4|
-000003f0  a0 95 b5 72 d6 a8 70 3b  f6 5b 1c 5f 1f b6 0e 04  |...r..p;.[._....|
-00000400  15 cf d2 e9 a1 40 ca 76  e4 1a 6e 80 0f 03 b9 f2  |.....@.v..n.....|
-00000410  7e c2 e6 d7 16 03 03 00  1c 25 6e 41 dc 6a a3 2a  |~........%nA.j.*|
-00000420  9c ec f9 ef 1c 18 dd 59  ee cb a1 fd ec da 67 b1  |.......Y......g.|
-00000430  27 02 27 49 d5                                    |'.'I.|
+00000000  16 03 03 00 81 39 20 22  4a e1 4e 21 2e 78 35 50  |.....9 "J.N!.x5P|
+00000010  8a d4 c4 c6 a9 20 74 8e  10 4b fd 31 4c ba c4 7f  |..... t..K.1L...|
+00000020  14 91 ab 4b 7a b2 7a 86  56 cc 61 ed 12 63 4a d5  |...Kz.z.V.a..cJ.|
+00000030  b5 c9 48 6e ae 10 71 fc  30 f5 e5 36 8b e2 7d 9d  |..Hn..q.0..6..}.|
+00000040  93 e2 34 cd 8e a0 72 c4  19 9b 62 eb 9b c4 5e c3  |..4...r...b...^.|
+00000050  df 22 d4 16 4d 88 b1 d5  e5 74 ac 9d 38 40 7d 1f  |."..M....t..8@}.|
+00000060  40 bd 86 e5 fc 19 88 bb  67 cf 3f 22 0f 39 1f 8f  |@.......g.?".9..|
+00000070  40 5c ee 29 48 00 c1 bf  6a f1 85 51 03 c0 e8 7a  |@\.)H...j..Q...z|
+00000080  2e f4 2a f9 b6 fb 16 03  03 02 69 59 b1 5a b9 98  |..*.......iY.Z..|
+00000090  86 77 af 76 a7 4c 69 0d  83 79 3c 9a b9 3c dd 49  |.w.v.Li..y<..<.I|
+000000a0  f2 0f ef d2 38 ac 31 b0  9b 5d 57 ed a7 ca f9 79  |....8.1..]W....y|
+000000b0  7c ef 58 f7 ca 7e 0c 60  1c 53 09 c5 06 dd b8 31  ||.X..~.`.S.....1|
+000000c0  09 88 af 50 9f c2 2a 2c  24 89 9e 57 ae c8 e6 49  |...P..*,$..W...I|
+000000d0  f4 6f 46 e9 dd 38 f1 52  e9 06 50 38 69 b3 e1 69  |.oF..8.R..P8i..i|
+000000e0  f5 33 28 54 39 43 05 b9  04 04 c2 d9 3d 34 da 48  |.3(T9C......=4.H|
+000000f0  99 7e 8a b2 59 d1 d3 20  da 34 c8 ab 91 f7 66 69  |.~..Y.. .4....fi|
+00000100  3a 4f fc 6d ee e6 ef f5  c0 b0 08 bf 59 c0 f8 e5  |:O.m........Y...|
+00000110  dc c6 dc c6 49 a7 d5 3c  22 0f e3 9f 39 0b 2a 09  |....I..<"...9.*.|
+00000120  7a 56 f8 90 33 05 06 09  21 6f 6a 53 0d 89 63 2a  |zV..3...!ojS..c*|
+00000130  76 28 19 33 73 e5 a0 2a  fa d2 82 bf 4c 43 84 f9  |v(.3s..*....LC..|
+00000140  e1 bb 7f 31 62 04 c5 26  ed 16 40 f5 6a 04 e0 c5  |...1b..&..@.j...|
+00000150  4e fe bd e3 4c 57 e2 61  41 2f 9a 95 7f 8a e1 34  |N...LW.aA/.....4|
+00000160  64 f4 fc ce 13 e5 0c 68  c1 e5 29 df e7 b1 56 0b  |d......h..)...V.|
+00000170  42 6b fc d6 5d 63 0b 3c  0c ca ce 38 11 50 f2 64  |Bk..]c.<...8.P.d|
+00000180  1a 6e 16 da 3e 69 cf 82  ba a0 03 0f 9d 72 ed 10  |.n..>i.......r..|
+00000190  78 b2 54 c0 be 9c 16 fa  15 4b 88 db dd 85 dd 08  |x.T......K......|
+000001a0  bd f4 50 a0 50 01 77 7a  cf 20 c1 3e 50 55 5f bd  |..P.P.wz. .>PU_.|
+000001b0  4a ba b4 d5 6d 51 38 b2  6d 4f fc b5 af b9 92 ff  |J...mQ8.mO......|
+000001c0  c4 44 f1 0e db 4d 71 09  15 b3 c3 37 47 57 03 35  |.D...Mq....7GW.5|
+000001d0  95 de da 33 31 8c 60 bc  8a 97 2d f8 27 9b 4e dc  |...31.`...-.'.N.|
+000001e0  2a 6d aa 3e 4d eb 8f 97  b8 fa d4 ef f6 27 d9 da  |*m.>M........'..|
+000001f0  a6 fe 38 91 4b 96 ff 75  4b 71 52 9f 37 e4 d9 85  |..8.K..uKqR.7...|
+00000200  a8 d8 ac 21 e9 b2 c0 4f  c0 c0 e3 3a 9f ab e0 93  |...!...O...:....|
+00000210  dc 03 18 30 92 55 33 67  58 f3 47 f3 0a 95 bc 33  |...0.U3gX.G....3|
+00000220  70 73 e1 5b 9d 63 cf f7  c7 9b da 9e 5d 2e 7a 66  |ps.[.c......].zf|
+00000230  03 b1 b8 5c fa b9 f4 fb  4e 0b 38 9a 97 f0 c9 e5  |...\....N.8.....|
+00000240  ce 18 33 ea 66 1c 59 cd  41 3e af 71 7c bf 00 a0  |..3.f.Y.A>.q|...|
+00000250  d9 ee 20 d7 80 a9 5d 55  b8 f8 92 7b 7e 4f bc 66  |.. ...]U...{~O.f|
+00000260  92 98 6a c6 15 5b e3 1d  59 14 d9 d0 5a 30 c0 4d  |..j..[..Y...Z0.M|
+00000270  37 f5 d9 40 a4 f9 f4 ad  b6 cf 55 98 03 1e e7 13  |7..@......U.....|
+00000280  5a 23 49 69 36 fa ae 9d  c2 cb 90 16 cc 36 f4 41  |Z#Ii6........6.A|
+00000290  3a c7 56 9f 05 23 be 1d  3f 8f 90 41 09 6b 88 9a  |:.V..#..?..A.k..|
+000002a0  70 91 76 e1 6d f0 5c 86  de 77 a4 83 c7 d5 3c c4  |p.v.m.\..w....<.|
+000002b0  67 ff b1 a2 e2 f5 61 4f  3b 4d 38 5d c9 c2 8c 97  |g.....aO;M8]....|
+000002c0  e2 a7 c0 72 3b 5e 4c d9  0f 18 a8 b9 77 8d 31 8f  |...r;^L.....w.1.|
+000002d0  d9 73 ac 33 a6 7a b5 bd  5e 58 b4 51 22 be d8 d4  |.s.3.z..^X.Q"...|
+000002e0  f5 e1 bc 37 80 d3 cf 3b  58 be 3e ce 33 83 1c 46  |...7...;X.>.3..F|
+000002f0  8b f3 f3 56 16 03 03 00  bc 30 f0 e1 0b eb 80 fe  |...V.....0......|
+00000300  5f fb 94 c9 5a 04 08 82  0f 0b b5 9b f7 f6 f6 d3  |_...Z...........|
+00000310  7e 68 e7 e5 2e cf a0 56  e6 b7 70 0a 63 5e 53 42  |~h.....V..p.c^SB|
+00000320  7f 27 ec 82 a0 5d e3 e8  77 27 40 3c 6d 47 ce dd  |.'...]..w'@<mG..|
+00000330  89 6e ac 0c 48 ab 25 d1  8e 4e 4e b8 99 69 a5 94  |.n..H.%..NN..i..|
+00000340  8d 19 ab f9 82 6b 28 e3  b8 5f f7 75 a8 dd 1f b5  |.....k(.._.u....|
+00000350  0a ff d1 72 4f 82 9b 9e  8e b3 3f f9 73 d6 cd ea  |...rO.....?.s...|
+00000360  c8 5b 51 4e 7f 16 a5 4b  81 5e 9a d7 a3 f2 64 35  |.[QN...K.^....d5|
+00000370  fd 2e dc 11 07 10 04 63  80 77 eb 0d d2 ba 9f 7c  |.......c.w.....||
+00000380  ad 66 eb 0a 2e f7 f2 3d  d3 a4 04 7b 83 8f 84 94  |.f.....=...{....|
+00000390  93 8e 8c 74 2a b0 3a 3e  e1 33 92 f9 59 e5 0a 56  |...t*.:>.3..Y..V|
+000003a0  95 3a 8b dc 1f 24 6c 08  07 c0 f1 20 6d 96 43 71  |.:...$l.... m.Cq|
+000003b0  bf c6 92 81 e3 16 03 03  00 3a 91 c1 13 a0 26 c9  |.........:....&.|
+000003c0  12 6a 09 23 5b 8b e8 da  10 cc 4d 00 ed 9e a6 09  |.j.#[.....M.....|
+000003d0  d8 d4 c0 b7 f0 cd 5f 7a  6e 4d 31 21 f6 6a 22 e7  |......_znM1!.j".|
+000003e0  6e 25 11 94 4a f2 b1 f1  b2 c9 30 4b e4 cd f3 f5  |n%..J.....0K....|
+000003f0  ce 86 e7 5d 16 03 03 00  14 20 c5 91 f0 6e 21 b8  |...]..... ...n!.|
+00000400  e8 a1 bb cf 62 ed 4b 5a  fa 19 40 ea 54           |....b.KZ..@.T|
 >>> Flow 13 (client to server)
-00000000  16 03 03 02 71 00 00 00  00 00 00 00 02 a7 99 f2  |....q...........|
-00000010  84 7b 66 b5 68 75 59 8b  2e 69 af bd 1d da 7a 72  |.{f.huY..i....zr|
-00000020  58 ad ba c4 9c 4b f2 80  96 ea e5 8a ba 67 75 f2  |X....K.......gu.|
-00000030  80 1f 4d b9 89 dd 4e 0e  60 5b 09 58 43 45 51 19  |..M...N.`[.XCEQ.|
-00000040  ae e7 92 49 85 09 2d 98  42 fc c5 4c ae 73 e8 1f  |...I..-.B..L.s..|
-00000050  93 b0 02 b6 cf 69 12 70  08 07 15 1d 46 3d 15 c9  |.....i.p....F=..|
-00000060  71 67 77 0b fc e9 14 5c  08 a6 7e 68 e7 ad 2b 22  |qgw....\..~h..+"|
-00000070  58 ba 95 28 82 2b 9f d4  3a 24 3a 82 08 1c 69 62  |X..(.+..:$:...ib|
-00000080  e3 cd 1d c6 06 d8 5f a0  c4 90 e7 22 89 69 de 13  |......_....".i..|
-00000090  9b 53 db c6 de d0 98 0e  e9 b3 6b 35 ba 5b 3f 9d  |.S........k5.[?.|
-000000a0  e6 d1 2b 0e e8 bd 83 a9  ed 7b 3a 8c 52 fb 74 17  |..+......{:.R.t.|
-000000b0  68 76 8b a7 00 0e 25 69  be 4d e9 90 2d 84 ff 6e  |hv....%i.M..-..n|
-000000c0  fb 3a 63 03 cd 4c 63 a8  99 db a9 4f e8 4f 03 66  |.:c..Lc....O.O.f|
-000000d0  b5 7c f0 06 b3 98 70 51  8c f1 ad cf 08 13 3c cb  |.|....pQ......<.|
-000000e0  87 69 7f 16 0e 9d b1 bc  eb 5f 28 df 44 c4 7c 36  |.i......._(.D.|6|
-000000f0  e9 78 85 08 6b 59 26 ed  9f ed e1 be f7 05 7e 21  |.x..kY&.......~!|
-00000100  cc 6a 14 17 86 a1 47 f5  90 20 49 84 16 e4 af 62  |.j....G.. I....b|
-00000110  00 e2 43 97 65 f6 17 c2  17 94 28 0f 86 c9 e6 6b  |..C.e.....(....k|
-00000120  f9 ac 9d 69 9c fe e3 c1  1a a3 11 0e ab 50 14 d3  |...i.........P..|
-00000130  9e 55 37 80 b3 bc 41 6d  dd 8f 3b 78 ff 37 da 65  |.U7...Am..;x.7.e|
-00000140  af 38 3a b2 50 67 79 46  d1 a5 d9 c3 42 ba 53 be  |.8:.PgyF....B.S.|
-00000150  4c 68 4e f7 33 5a 08 95  9c cc ca 9f ea 43 c4 20  |LhN.3Z.......C. |
-00000160  22 e4 34 1e 83 d2 db 0d  cb f9 c5 86 b0 73 88 a4  |".4..........s..|
-00000170  eb 23 2c e2 a5 9d de f9  54 57 29 40 10 49 5d 5b  |.#,.....TW)@.I][|
-00000180  81 52 42 89 b3 02 31 c1  6e 85 3b ad fb 69 7f cb  |.RB...1.n.;..i..|
-00000190  f2 29 59 43 3a 67 f5 61  d2 40 8c 21 22 41 2b fd  |.)YC:g.a.@.!"A+.|
-000001a0  bc 3f ac 68 66 55 7b 27  81 bf 3f 31 37 ac 4e 86  |.?.hfU{'..?17.N.|
-000001b0  0f e5 02 4c f1 00 ed a0  f9 0d aa a0 d1 0e f1 93  |...L............|
-000001c0  8e 34 4d 52 97 18 87 16  04 84 f0 5e 3a 2f 47 58  |.4MR.......^:/GX|
-000001d0  fb 91 cb b7 60 a9 50 30  44 cf 67 ae 9c b6 a0 65  |....`.P0D.g....e|
-000001e0  54 ef 6d 06 d3 02 ba 62  bf 16 ab b9 ff 89 19 c2  |T.m....b........|
-000001f0  77 20 13 ec 88 45 97 04  94 c6 7c 16 c2 83 df 34  |w ...E....|....4|
-00000200  5e 2e 5f d9 ee 96 ce e2  39 6f 4b 44 95 be 31 7b  |^._.....9oKD..1{|
-00000210  91 3b 1d c5 a7 e2 7a a4  b0 de 8a 1f bf e4 81 5d  |.;....z........]|
-00000220  99 72 ed f2 b0 a3 3a 87  ff 89 69 11 a8 13 de 37  |.r....:...i....7|
-00000230  ff af 84 e4 1a e3 c3 b5  e5 88 c6 0c d1 41 3e 2a  |.............A>*|
-00000240  52 4c 7c 2a 7d 3b ba 05  99 0c 53 18 04 ca 22 a2  |RL|*};....S...".|
-00000250  f8 27 7d e3 80 f7 fa 11  58 af 97 25 cd 64 e7 73  |.'}.....X..%.d.s|
-00000260  e1 b5 b6 43 8e 58 70 ea  ba c8 41 80 44 2f 8f 9a  |...C.Xp...A.D/..|
-00000270  ad 6e aa 94 46 2d 16 03  03 00 3d 00 00 00 00 00  |.n..F-....=.....|
-00000280  00 00 03 4e a3 b3 f0 40  ba e4 ec 9a 5f 74 01 67  |...N...@...._t.g|
-00000290  eb 84 7e f9 b9 e5 6c 26  3a 65 98 27 89 5b 09 c4  |..~...l&:e.'.[..|
-000002a0  f4 dd e1 c4 10 fe 89 09  83 57 3a c1 33 d4 85 12  |.........W:.3...|
-000002b0  1d 3e 18 0d 8f 51 b2 b5  16 03 03 00 a0 00 00 00  |.>...Q..........|
-000002c0  00 00 00 00 04 10 6f 74  0f 87 52 8b d6 9e 39 0e  |......ot..R...9.|
-000002d0  66 06 ac 12 71 6b 49 49  52 36 f9 f7 80 f1 0c e0  |f...qkIIR6......|
-000002e0  58 f0 6b 88 e4 ef 6b cf  83 d1 6c 85 fc 39 1d bd  |X.k...k...l..9..|
-000002f0  2a 9f ae 5b 27 6b e3 f0  d8 21 57 54 67 1c 35 d3  |*..['k...!WTg.5.|
-00000300  6a d3 c3 1b 2c c3 95 03  4b ef cc 03 76 ff 4a 2b  |j...,...K...v.J+|
-00000310  35 b7 86 09 2e 42 3c 59  43 92 4d 27 f7 3a f1 1d  |5....B<YC.M'.:..|
-00000320  8d 32 a5 0d bd ff 97 76  8d b9 21 13 4a 74 93 96  |.2.....v..!.Jt..|
-00000330  66 e8 d4 f9 5a 36 6c 6f  d3 89 08 1b bc f1 6e 80  |f...Z6lo......n.|
-00000340  2b 09 41 01 62 d6 51 60  1e a8 39 3d 05 94 7b 65  |+.A.b.Q`..9=..{e|
-00000350  a4 ea f3 7b 09 e8 09 b8  a6 6c 78 a0 c9 14 03 03  |...{.....lx.....|
-00000360  00 19 00 00 00 00 00 00  00 05 7f 9c 56 2b 82 35  |............V+.5|
-00000370  df 72 ee 34 8f 22 d7 d4  eb 1d 38 16 03 03 00 28  |.r.4."....8....(|
-00000380  00 00 00 00 00 00 00 00  fd 40 5f 2a 85 2c e9 5e  |.........@_*.,.^|
-00000390  2f eb aa ef c9 bf 22 31  b8 ea ee 1e 31 e1 07 60  |/....."1....1..`|
-000003a0  62 65 38 a9 93 f8 bd 1d                           |be8.....|
+00000000  16 03 03 02 69 1a b5 80  9c c6 42 be a6 d9 d1 c8  |....i.....B.....|
+00000010  0b 2c f7 f8 2a 1a 02 f6  db 48 8b 5c 45 fc 28 41  |.,..*....H.\E.(A|
+00000020  a4 db 35 fb a7 a9 72 07  19 86 9e e9 dc 53 48 fb  |..5...r......SH.|
+00000030  97 94 f3 a0 0d 8d 46 69  cf eb d9 ea de 21 a3 f4  |......Fi.....!..|
+00000040  b9 94 4f 8f 09 c3 de 66  fa 20 83 34 fc 50 ae c6  |..O....f. .4.P..|
+00000050  13 f6 7c c5 80 45 17 51  af a9 da bd 24 dd f6 15  |..|..E.Q....$...|
+00000060  8e c4 b4 e6 10 54 85 23  9d fe 72 b1 4c 2f ab ec  |.....T.#..r.L/..|
+00000070  78 9a 06 60 03 96 f7 d0  af dd 94 26 c9 67 1d e5  |x..`.......&.g..|
+00000080  9f 87 22 c4 11 82 f1 4c  f5 68 a7 fd d8 f3 dc ac  |.."....L.h......|
+00000090  35 90 6b c2 97 1c 78 54  d9 b2 3c d8 9d 13 66 42  |5.k...xT..<...fB|
+000000a0  6e 3b 1b 8f 32 4e 8f b5  a0 60 6e e4 35 fd d5 b4  |n;..2N...`n.5...|
+000000b0  f8 fb a6 a9 c7 b7 31 39  8e 90 0c 42 bc 1a 4f 67  |......19...B..Og|
+000000c0  fa b3 10 a8 45 01 88 8a  dd 41 43 c6 6c 41 9d 28  |....E....AC.lA.(|
+000000d0  bd 4c 43 85 4c 3b 7c 03  c4 55 70 f1 49 a0 d6 52  |.LC.L;|..Up.I..R|
+000000e0  5c 49 3e 2b d7 e8 a9 75  5e 92 bf f3 4c 1c c3 7e  |\I>+...u^...L..~|
+000000f0  69 ca 52 25 07 bb 54 e0  58 2d 28 ba 50 30 81 e8  |i.R%..T.X-(.P0..|
+00000100  93 0d 9d 78 3d c0 f1 c3  34 72 29 f1 da 60 de 84  |...x=...4r)..`..|
+00000110  aa fc d3 0f 2b 1e 1a 9c  7c af 6f 6a 4c cc 88 36  |....+...|.ojL..6|
+00000120  03 03 34 79 f9 89 6d 41  bb 19 61 6a 60 75 d7 0f  |..4y..mA..aj`u..|
+00000130  dc 22 7a e4 36 91 32 2b  99 24 36 19 4b 4c c4 ae  |."z.6.2+.$6.KL..|
+00000140  4f 98 6d f0 97 ce bc b4  ee 97 30 97 0b 54 8c 14  |O.m.......0..T..|
+00000150  8f d5 9d 44 ae 0a a6 07  9f 39 f6 66 80 cb fa 27  |...D.....9.f...'|
+00000160  bb 2f 26 bb c3 1a a4 9b  a0 d3 e8 75 13 49 da 0a  |./&........u.I..|
+00000170  8f cc e8 15 77 f8 05 c2  17 a0 ff e7 2a 59 bc c8  |....w.......*Y..|
+00000180  67 b5 7e b8 78 1e 32 81  22 3e 57 28 ee 51 96 b7  |g.~.x.2.">W(.Q..|
+00000190  0e dc 3f d1 00 16 a5 eb  01 cb c3 e3 5b 01 ad a9  |..?.........[...|
+000001a0  d5 1b ac 9b e2 0d 9a 6f  7a 2f f1 7d 05 57 6d 2d  |.......oz/.}.Wm-|
+000001b0  9d 35 68 88 e7 c5 e0 fb  9d 87 a7 ef 71 d8 47 b8  |.5h.........q.G.|
+000001c0  19 8e 87 d8 b1 36 0f 52  ab 98 8b 97 43 53 86 be  |.....6.R....CS..|
+000001d0  9d 86 2a cd 7c b0 46 c4  48 89 5b 6c 1e 93 9e a2  |..*.|.F.H.[l....|
+000001e0  15 af 60 8f 84 75 99 97  53 11 23 f9 0d ba 78 12  |..`..u..S.#...x.|
+000001f0  9b a9 04 91 d0 3a b3 4d  7b 67 a0 fa 78 5c 19 d6  |.....:.M{g..x\..|
+00000200  88 d2 21 f6 8d e4 91 d1  76 95 67 9d 4e 3b a1 d2  |..!.....v.g.N;..|
+00000210  61 c3 d2 a6 53 fd 82 93  20 7e f6 07 a0 49 3a ea  |a...S... ~...I:.|
+00000220  bc 73 03 0b f2 df 51 ac  35 d8 e4 35 9d 13 56 b5  |.s....Q.5..5..V.|
+00000230  be fc 7c 36 8b 37 a0 71  57 62 bd 89 38 18 90 1e  |..|6.7.qWb..8...|
+00000240  7a 1f b3 8f 73 55 32 94  5a 3a 31 91 b3 95 bd 61  |z...sU2.Z:1....a|
+00000250  ea 93 9d f0 38 33 fb 5b  28 3d a7 29 a4 91 de 85  |....83.[(=.)....|
+00000260  9c 16 63 10 81 c6 e0 11  92 3d 53 db 69 95 16 03  |..c......=S.i...|
+00000270  03 00 35 f7 3a b7 d1 20  aa f7 ed b1 c7 46 52 cb  |..5.:.. .....FR.|
+00000280  6e dd e2 f4 ae 83 20 cd  6c 59 b5 26 f9 81 7e 6c  |n..... .lY.&..~l|
+00000290  ed e9 0b 2a f1 3a dc f8  d6 ed e5 6d 89 14 3d 79  |...*.:.....m..=y|
+000002a0  e7 c8 af 89 30 eb 98 3d  16 03 03 00 98 a0 59 2f  |....0..=......Y/|
+000002b0  cd d9 f6 63 e3 53 47 77  e5 c4 fc 2e 12 d7 24 8a  |...c.SGw......$.|
+000002c0  4c c7 d8 c9 77 4f bc 3c  af 93 6f 57 3d 6f 5d 1c  |L...wO.<..oW=o].|
+000002d0  6a 5a 2c 42 1c e0 92 d5  5e 34 c8 a5 9e 11 21 16  |jZ,B....^4....!.|
+000002e0  01 1a 08 af 4e f6 a1 e3  19 a6 81 41 3d 7a f3 d1  |....N......A=z..|
+000002f0  e0 9e 55 90 42 4b d9 5c  46 b7 eb c8 fb 83 1c 97  |..U.BK.\F.......|
+00000300  9e d9 74 bb 7f 2f 4d 61  89 46 db 32 da 1a 76 95  |..t../Ma.F.2..v.|
+00000310  88 f8 ca 62 14 88 dc 97  b8 58 82 74 16 78 be c5  |...b.....X.t.x..|
+00000320  f9 78 a4 88 c1 d4 6b 36  6e 54 60 a5 21 30 47 07  |.x....k6nT`.!0G.|
+00000330  e8 2d 22 ce a5 17 fb 43  10 9d 74 c9 64 a3 db ac  |.-"....C..t.d...|
+00000340  d9 24 7a a7 5d 14 03 03  00 11 68 20 87 e9 9b 91  |.$z.].....h ....|
+00000350  81 67 2b 31 c4 47 e8 9b  2e 7c c4 16 03 03 00 20  |.g+1.G...|..... |
+00000360  ef 6f 3d 0f 23 fa 77 8c  a9 46 d9 0d b0 d9 f8 16  |.o=.#.w..F......|
+00000370  62 e2 07 21 ec b6 a7 78  ce a6 ea b3 68 c1 c7 af  |b..!...x....h...|
 >>> Flow 14 (server to client)
-00000000  14 03 03 00 19 25 6e 41  dc 6a a3 2a 9d e9 bc 46  |.....%nA.j.*...F|
-00000010  a3 41 4d c3 59 d7 93 dd  27 08 d0 f7 d9 03 16 03  |.AM.Y...'.......|
-00000020  03 00 28 be d9 c1 5c b1  b4 75 8a af 62 82 c0 09  |..(...\..u..b...|
-00000030  2c 06 b4 5e 65 17 ed 62  95 5b d0 9f 2c f1 37 3d  |,..^e..b.[..,.7=|
-00000040  5f 07 4c b0 08 0c de 4d  c1 3e b5 17 03 03 00 21  |_.L....M.>.....!|
-00000050  be d9 c1 5c b1 b4 75 8b  d3 5b c4 8f 86 fd 68 41  |...\..u..[....hA|
-00000060  9e 0b bb 83 9e 94 31 d1  fa 10 0b 1a e5 0e 50 ae  |......1.......P.|
-00000070  5d                                                |]|
+00000000  14 03 03 00 11 bb 45 96  9e 08 cb e4 24 c2 e3 71  |......E.....$..q|
+00000010  40 d1 ef a1 5e 2f 16 03  03 00 20 1b 3f 69 fb ae  |@...^/.... .?i..|
+00000020  cd 98 15 59 16 14 cf a5  16 af 36 6d 6d 3a 49 06  |...Y......6mm:I.|
+00000030  a6 f9 cf 53 ea 9a b7 3b  48 d2 e3 17 03 03 00 19  |...S...;H.......|
+00000040  72 2c 82 a0 8c 6c 8b c3  78 e4 41 1b ff ba 92 6d  |r,...l..x.A....m|
+00000050  3c 4d 9c c3 95 e3 27 b9  82                       |<M....'..|
 >>> Flow 15 (client to server)
-00000000  15 03 03 00 1a 00 00 00  00 00 00 00 01 89 01 4f  |...............O|
-00000010  91 3f 59 58 b0 05 a0 5e  9d 93 29 87 17 72 88     |.?YX...^..)..r.|
+00000000  15 03 03 00 12 3d f9 72  53 84 b5 a4 ec 27 39 cc  |.....=.rS....'9.|
+00000010  72 29 c0 e6 37 7b 0f                              |r)..7{.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected
index 74d6378074..737ccc61ba 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 aa b9 87 c0 6f  |....Y...U......o|
-00000010  84 98 c2 14 74 06 d5 a9  96 3f d1 30 d2 97 50 72  |....t....?.0..Pr|
-00000020  6a f1 82 ce 03 f1 32 49  16 4f 77 20 ee b2 8e df  |j.....2I.Ow ....|
-00000030  8f 78 92 36 4a 2d ea 99  1e 24 7f 3f ee 50 11 c3  |.x.6J-...$.?.P..|
-00000040  4d 40 92 2f 94 0b b4 6a  5f 72 b8 08 c0 2f 00 00  |M@./...j_r.../..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 75 f6 1b 17 2f  |....Y...U..u.../|
+00000010  e0 d4 19 06 0d 93 90 51  46 d9 c3 a0 cd 45 6c 85  |.......QF....El.|
+00000020  94 87 01 21 3e 92 62 1d  e7 d1 39 20 07 26 a1 5b  |...!>.b...9 .&.[|
+00000030  d2 4a 61 40 ba 58 c0 23  0c 3f c3 08 5d 28 04 94  |.Ja@.X.#.?..](..|
+00000040  a9 34 37 28 64 75 6f 9c  ae fa 1f 24 cc a8 00 00  |.47(duo....$....|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -54,193 +54,181 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 5f 7f 61 d4 5d de 8b  |........ _.a.]..|
-000002d0  8d d1 48 dc 96 d3 87 f1  64 92 fe 0f e8 ab 89 31  |..H.....d......1|
-000002e0  ae 5c 57 af 59 be 0b 29  6a 04 01 00 80 0d 88 71  |.\W.Y..)j......q|
-000002f0  58 d0 23 d9 81 81 a8 df  44 4d 9e 3b 66 90 f9 c3  |X.#.....DM.;f...|
-00000300  b4 98 ac 4e d6 0f 1f a6  92 44 2f 29 73 fb 18 79  |...N.....D/)s..y|
-00000310  51 63 cd 13 15 52 92 a0  c4 b0 45 1f fe 8f ac ba  |Qc...R....E.....|
-00000320  76 1e 2f 97 fc 7d bf 91  fa 0b aa 47 5e 18 80 20  |v./..}.....G^.. |
-00000330  0e 68 0d a3 ad 83 28 eb  6a 7d a0 45 d4 00 1b ed  |.h....(.j}.E....|
-00000340  65 e3 e1 83 92 35 d0 5a  fd cd cb ea 4e b7 76 15  |e....5.Z....N.v.|
-00000350  35 e2 12 7c e8 8d 78 50  2a eb 16 66 0c a3 38 35  |5..|..xP*..f..85|
-00000360  56 d5 62 e8 8d 7d 5e 3e  72 63 4c 9b 3a 16 03 03  |V.b..}^>rcL.:...|
+000002c0  ac 0c 00 00 a8 03 00 1d  20 84 74 e5 bc 24 39 39  |........ .t..$99|
+000002d0  e0 6e 35 fb 34 87 76 0d  78 89 35 5c 85 e7 92 da  |.n5.4.v.x.5\....|
+000002e0  e1 39 f4 b2 e7 ec d5 cd  58 04 01 00 80 cf 3a 57  |.9......X.....:W|
+000002f0  6a 8b b7 72 d8 a2 6b 47  87 77 8b 7a bf 63 6c e8  |j..r..kG.w.z.cl.|
+00000300  d4 20 6a 6a 9c 62 b6 ef  4b 9f a7 89 8c a6 fd 02  |. jj.b..K.......|
+00000310  92 2f 8d 07 44 09 f6 d9  03 99 39 49 1d 8d 1b 7f  |./..D.....9I....|
+00000320  eb eb 4b a6 fb 9f 83 3b  3d d3 61 3e e4 d3 22 24  |..K....;=.a>.."$|
+00000330  c1 44 76 e8 75 c7 aa 31  96 e3 50 bb 76 3e 87 02  |.Dv.u..1..P.v>..|
+00000340  b9 1d 82 dd 55 ee 05 b9  b5 1e 65 90 2c 50 c9 87  |....U.....e.,P..|
+00000350  49 dd 35 c8 84 67 6e 52  3a 3b ec 3c 63 f4 0f 95  |I.5..gnR:;.<c...|
+00000360  87 05 8e ec bd d7 97 9f  9a 14 78 d7 97 16 03 03  |..........x.....|
 00000370  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 f6 96 e2  |....(...........|
-00000040  7e fa ee c9 29 9b 3e 14  c8 a0 1c 7f 1f 58 47 a1  |~...).>......XG.|
-00000050  12 a0 07 52 c4 e7 77 51  16 9e 1b 8e d1           |...R..wQ.....|
+00000030  16 03 03 00 20 3e a2 12  3b a4 83 4a c2 0e 93 d5  |.... >..;..J....|
+00000040  98 d5 2e 11 9e 60 60 23  78 5a 63 49 f1 7a ee c4  |.....``#xZcI.z..|
+00000050  47 00 6c 4e fb                                    |G.lN.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 d5 b6 c4 29 29  |..........(...))|
-00000010  df 16 db bb c8 b8 6b 27  29 1f ce 55 8a 24 4c fa  |......k')..U.$L.|
-00000020  4d 94 e1 3c c8 49 a0 75  fa 86 21 58 f1 d4 f3 b5  |M..<.I.u..!X....|
-00000030  7c 9c 10                                          ||..|
+00000000  14 03 03 00 01 01 16 03  03 00 20 6d 78 5b 5f 1b  |.......... mx[_.|
+00000010  2c 05 ba 92 46 e2 f0 04  48 fa a1 da be 93 ed fd  |,...F...H.......|
+00000020  f5 f8 b8 dd 00 60 09 a6  36 3c c4                 |.....`..6<.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 54 43 2d  |.............TC-|
-00000010  2b 31 18 3a be d4 48 5a  a1 4a d7 d0 7a 9a f4 42  |+1.:..HZ.J..z..B|
-00000020  9e 0d d4                                          |...|
+00000000  17 03 03 00 16 a4 db 13  bc c1 6e 06 9e 6d 1a c9  |..........n..m..|
+00000010  85 a7 e9 28 b8 27 74 19  8f 1a bc                 |...(.'t....|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 1c d5 b6 c4  29 29 df 16 dc 50 d5 50  |........))...P.P|
-00000010  eb 32 df 33 ef b2 45 52  cc fa 9c 5e 24 2f 0d a0  |.2.3..ER...^$/..|
-00000020  ec                                                |.|
+00000000  16 03 03 00 14 fa a3 77  3c 76 11 5d be 12 4f 6a  |.......w<v.]..Oj|
+00000010  f7 0d 26 73 ab 7c bd 4b  19                       |..&s.|.K.|
 >>> Flow 7 (client to server)
-00000000  16 03 03 00 b1 00 00 00  00 00 00 00 02 cc 36 06  |..............6.|
-00000010  ab 2b 1e 50 26 39 44 e2  37 21 c5 f7 75 21 71 49  |.+.P&9D.7!..u!qI|
-00000020  b7 4d ea 13 a1 0a 98 b3  0f 06 d4 ca e5 72 7b 7c  |.M...........r{||
-00000030  23 4e ba ef 34 fa a5 90  a1 b2 e7 56 02 86 43 41  |#N..4......V..CA|
-00000040  ca 87 dd fb 83 1b f1 68  4f 12 63 97 67 91 48 4c  |.......hO.c.g.HL|
-00000050  92 fe d6 41 00 3b 40 c0  1e 93 18 d6 ba d5 a7 58  |...A.;@........X|
-00000060  f4 21 b4 87 28 59 94 46  9b c8 af e1 c5 d4 1d 2d  |.!..(Y.F.......-|
-00000070  5b 03 5d 8c 35 dc b3 63  8a e3 bb 74 8c b3 e7 49  |[.].5..c...t...I|
-00000080  bc 19 d7 d4 55 7c d4 09  08 55 da 68 5d 0b 1f 87  |....U|...U.h]...|
-00000090  8f bd 77 a1 32 b5 76 30  ef e0 21 b7 d5 b7 cc 80  |..w.2.v0..!.....|
-000000a0  a5 41 7c 69 7a e3 49 d9  35 18 76 61 d1 27 6d 96  |.A|iz.I.5.va.'m.|
-000000b0  1d 39 12 2d 98 3b                                 |.9.-.;|
+00000000  16 03 03 00 ad 59 80 a4  91 95 56 2a 01 ee 04 84  |.....Y....V*....|
+00000010  f9 d2 dd a5 2c a6 46 a8  69 a3 c7 47 7e eb 54 da  |....,.F.i..G~.T.|
+00000020  ec cc 9d aa e1 0a b1 7c  e9 cf 9f c9 c8 12 62 35  |.......|......b5|
+00000030  d2 4a eb 28 0d 9b aa a4  d5 79 66 f7 72 4c 26 10  |.J.(.....yf.rL&.|
+00000040  b6 71 db 4a 68 8b 47 f9  47 e3 6d a6 4e 99 d5 0b  |.q.Jh.G.G.m.N...|
+00000050  27 b2 2c 23 9b 58 60 8a  37 a1 8e 26 09 26 2a 46  |'.,#.X`.7..&.&*F|
+00000060  e6 24 7f 9b cb 6b d1 9d  b1 c0 48 c9 50 8b ab 06  |.$...k....H.P...|
+00000070  05 57 ef 1a e0 bd ce db  ca 3d e1 59 df 24 4c 02  |.W.......=.Y.$L.|
+00000080  bf 1b 9e 48 52 42 6c dd  8f fa 82 68 56 52 a6 be  |...HRBl....hVR..|
+00000090  d0 93 cb 43 74 e1 2f 86  cc e1 4c fa ba fc 1d f0  |...Ct./...L.....|
+000000a0  d5 20 3a 79 b3 b8 b7 24  b5 cf 4c dd a5 d0 4d 18  |. :y...$..L...M.|
+000000b0  15 55                                             |.U|
 >>> Flow 8 (server to client)
-00000000  16 03 03 00 89 d5 b6 c4  29 29 df 16 dd 91 28 de  |........))....(.|
-00000010  3a 91 8b 69 bf be fb 8b  e7 bb 2e 0a 9b fa fb f7  |:..i............|
-00000020  6c d1 18 b0 9e 8f 15 15  70 72 3b e6 f4 a8 90 f0  |l.......pr;.....|
-00000030  ec 59 9e 25 bd d5 ca 00  ce 7c e8 52 99 65 e4 f4  |.Y.%.....|.R.e..|
-00000040  9d 65 f7 84 d5 5c 9e 6f  3c 7b 67 82 07 6f 25 3b  |.e...\.o<{g..o%;|
-00000050  26 1c c4 b7 19 7a 9f bd  5a 59 15 56 55 09 46 0e  |&....z..ZY.VU.F.|
-00000060  80 3b 1c fb e6 d8 30 a2  94 96 37 5c 7c 0d 8c 8a  |.;....0...7\|...|
-00000070  ef e3 d2 19 bc e5 22 ae  ae 5f b2 04 13 24 dc 67  |......".._...$.g|
-00000080  9e b6 38 8c 9b cf 53 90  23 1c c8 a7 b7 1b 16 03  |..8...S.#.......|
-00000090  03 02 71 d5 b6 c4 29 29  df 16 de 2b fa 2d 83 6f  |..q...))...+.-.o|
-000000a0  56 ee 36 44 13 53 99 76  46 53 ca cf 61 72 9b 3b  |V.6D.S.vFS..ar.;|
-000000b0  a0 8f 0a d5 7a 01 ad d6  e9 fc 85 de e4 97 02 0d  |....z...........|
-000000c0  8b 27 a2 a5 4e 04 59 30  d4 ff fd b4 99 a4 8a ac  |.'..N.Y0........|
-000000d0  29 97 7e 10 47 e2 a8 eb  d9 8a b7 f7 1c 64 8d 24  |).~.G........d.$|
-000000e0  9b 7d c3 9b e7 42 72 e5  26 88 4a d4 40 89 bf a2  |.}...Br.&.J.@...|
-000000f0  44 b9 d8 cb 79 0d 35 37  6b 2d 04 49 f6 97 10 66  |D...y.57k-.I...f|
-00000100  e0 1d e8 66 43 f0 65 b7  35 8a cb 41 60 b3 ae 31  |...fC.e.5..A`..1|
-00000110  fb b4 2e 1e 0f 0f 2d a8  f8 b1 7d 36 af 8f a1 39  |......-...}6...9|
-00000120  0b 94 7a 4d 48 57 14 30  b2 c9 e4 bf 80 73 85 59  |..zMHW.0.....s.Y|
-00000130  73 4b d2 e8 2b 89 8e 45  b1 0f 47 1e 53 ad 7e 24  |sK..+..E..G.S.~$|
-00000140  b6 40 de 58 06 5f cb 1a  36 51 cd a1 d1 8a 66 a9  |.@.X._..6Q....f.|
-00000150  3a 83 a7 42 c5 5c 08 88  6d 21 7e 58 92 b6 a8 93  |:..B.\..m!~X....|
-00000160  5d 47 e2 7e bb 89 94 56  a1 47 69 a6 f8 3a 5d 1a  |]G.~...V.Gi..:].|
-00000170  f0 0f e9 a4 5a 5b d0 74  76 f6 0f e1 3f 00 00 53  |....Z[.tv...?..S|
-00000180  dd d7 32 c6 3d 52 a1 a6  98 0a 41 63 3f 67 74 dc  |..2.=R....Ac?gt.|
-00000190  78 5f 39 b0 27 1c d7 ad  b6 0d 6a 8f 71 65 e0 43  |x_9.'.....j.qe.C|
-000001a0  82 cd 01 45 b2 f2 93 de  aa fd 5b 53 d9 7a 47 36  |...E......[S.zG6|
-000001b0  54 55 30 63 b0 c3 bf fe  17 10 d7 85 b9 24 8f 8f  |TU0c.........$..|
-000001c0  30 61 a3 96 c6 03 96 cc  1f bc 76 31 e0 61 39 bb  |0a........v1.a9.|
-000001d0  1e 1c d5 d8 94 a8 bd a4  27 a0 ef a9 e3 87 21 79  |........'.....!y|
-000001e0  ac f0 3c 13 c8 71 ae 41  5f 25 25 14 38 3b 65 0b  |..<..q.A_%%.8;e.|
-000001f0  4f eb 93 22 93 d1 31 73  59 f6 5b 78 da 83 08 8b  |O.."..1sY.[x....|
-00000200  13 cb 93 d0 1f 57 85 67  46 ae 22 41 1c 4d c2 4e  |.....W.gF."A.M.N|
-00000210  91 a8 3b 92 6d 23 6e 6c  3a c3 da 0f e3 70 27 9b  |..;.m#nl:....p'.|
-00000220  df f0 5a 83 9f 21 ba 63  3b 55 4d 53 0b a2 7e 99  |..Z..!.c;UMS..~.|
-00000230  b9 7a ba 78 ba e6 ce ee  71 d1 cf 8b c8 79 8d f9  |.z.x....q....y..|
-00000240  75 c6 3c f3 16 99 ea d4  94 cc e3 7d 7e 84 b9 69  |u.<........}~..i|
-00000250  7a d2 10 de 17 7c 98 2a  d2 5e c0 0f ce a5 65 21  |z....|.*.^....e!|
-00000260  40 fa 31 82 7b 86 10 ac  fe b3 24 8b 83 6e 7f bc  |@.1.{.....$..n..|
-00000270  f6 2c 3d ef 6f 82 b3 01  da 3a e8 a6 07 dd 2a c8  |.,=.o....:....*.|
-00000280  56 ba 62 83 20 0b 68 bc  15 cb 53 f0 61 e7 bd 56  |V.b. .h...S.a..V|
-00000290  d6 79 5a b2 af f9 18 d3  7b 91 ce be 27 0d ef f8  |.yZ.....{...'...|
-000002a0  90 62 45 39 39 2f 89 ff  36 ad 56 f2 1a 58 13 dc  |.bE99/..6.V..X..|
-000002b0  09 9c 2a a8 a2 b2 6c 8b  04 7b aa 24 e6 1c 01 22  |..*...l..{.$..."|
-000002c0  5f 0c ac a3 c3 6e 5c f5  5d a7 56 5e 7d 1f f8 43  |_....n\.].V^}..C|
-000002d0  ec b4 83 26 7e 65 67 55  c9 af 82 8d 7e ac f7 ad  |...&~egU....~...|
-000002e0  cf d1 e9 f8 70 be 50 38  f0 eb 3e 2e 9e 79 74 26  |....p.P8..>..yt&|
-000002f0  bd da 05 9e bf b8 22 cb  33 9b 28 4e c9 1f 12 ce  |......".3.(N....|
-00000300  c5 df 1e f7 16 03 03 00  c4 d5 b6 c4 29 29 df 16  |............))..|
-00000310  df b5 a6 17 34 4d 63 d7  7f 48 e1 ab 14 76 59 d1  |....4Mc..H...vY.|
-00000320  86 93 6a 7e e4 a7 9e be  ce e9 df 02 e3 47 94 b6  |..j~.........G..|
-00000330  64 63 fd d8 b0 17 29 54  67 a6 b4 d4 04 07 0a 21  |dc....)Tg......!|
-00000340  1d 55 90 c2 d0 b9 ed 85  cb 0a 78 19 a5 0f 8a 2d  |.U........x....-|
-00000350  f0 43 b9 6a 80 d1 7a 4d  35 84 ef 30 5f f5 00 20  |.C.j..zM5..0_.. |
-00000360  81 7a bc 4b c3 eb 08 49  83 10 77 0d 3d e2 6e d2  |.z.K...I..w.=.n.|
-00000370  16 fd 52 b5 53 11 f1 d2  d8 72 fd f7 0c f8 42 44  |..R.S....r....BD|
-00000380  00 e2 b9 60 68 34 3a f2  3a d1 c6 8e 11 10 15 8f  |...`h4:.:.......|
-00000390  bf 2c 36 a1 fb 89 55 a4  bf 52 97 64 c1 1d ad 20  |.,6...U..R.d... |
-000003a0  f2 b0 10 82 00 af da aa  76 51 2e 4c 0a 54 97 0d  |........vQ.L.T..|
-000003b0  6c d0 17 7d 6e f9 87 90  52 9c 32 d4 f3 ba be eb  |l..}n...R.2.....|
-000003c0  34 13 33 fc b9 c4 d3 8a  ca e0 28 26 c9 16 03 03  |4.3.......(&....|
-000003d0  00 42 d5 b6 c4 29 29 df  16 e0 0e e2 f7 7f 26 ef  |.B...)).......&.|
-000003e0  10 f0 f9 38 ad 39 bf aa  3d 50 c7 e1 52 47 1d 3c  |...8.9..=P..RG.<|
-000003f0  c3 a2 09 d0 c5 e1 f3 ad  c7 86 54 aa ff 74 d5 8e  |..........T..t..|
-00000400  46 88 aa 00 95 3c f5 80  87 a7 1f 74 ec a9 b4 23  |F....<.....t...#|
-00000410  f5 28 5e 99 16 03 03 00  1c d5 b6 c4 29 29 df 16  |.(^.........))..|
-00000420  e1 d0 9f 65 f1 3c 76 53  ca e7 93 0c 0e 9e 56 29  |...e.<vS......V)|
-00000430  56 90 bc 92 92                                    |V....|
+00000000  16 03 03 00 81 10 b8 d9  9a 82 21 14 86 6d ef e4  |..........!..m..|
+00000010  b6 bc 10 84 80 a6 72 7b  dc 24 ba e1 e5 d2 bb d2  |......r{.$......|
+00000020  9f 09 d3 d7 37 20 ec 7d  bd 13 e0 bd 40 44 8a 6e  |....7 .}....@D.n|
+00000030  7f f6 d5 42 03 4b 00 b5  87 99 ac 6d 11 03 38 46  |...B.K.....m..8F|
+00000040  33 71 c4 10 ce da 36 d6  c1 41 9f 96 8e eb 4b 99  |3q....6..A....K.|
+00000050  24 07 8c 6b 88 2c f1 dd  31 35 ba 43 0f 60 bf b0  |$..k.,..15.C.`..|
+00000060  74 77 a9 d4 a7 65 f6 68  e2 70 4a 7e fe db ab 13  |tw...e.h.pJ~....|
+00000070  7f 51 c3 0f b4 93 42 12  d6 29 5d 44 5c df 17 6e  |.Q....B..)]D\..n|
+00000080  73 1d b8 95 fc 8b 16 03  03 02 69 64 5d 4f b4 3a  |s.........id]O.:|
+00000090  23 98 07 51 63 18 09 07  9a 8c dd 8e 51 a8 ca 23  |#..Qc.......Q..#|
+000000a0  37 21 f4 d5 e0 8f 03 1c  6f 6d c4 60 dd 99 8f 4b  |7!......om.`...K|
+000000b0  4c 11 f7 78 f8 aa f6 29  87 cf 4d ba 89 87 2a c9  |L..x...)..M...*.|
+000000c0  48 66 48 d3 a6 19 8a 84  f6 db 17 b4 59 5b e4 8e  |HfH.........Y[..|
+000000d0  8e ef fc 32 10 aa 0d 57  47 68 82 07 72 95 03 f6  |...2...WGh..r...|
+000000e0  e5 c1 c3 01 00 f9 85 4f  0f 85 37 73 f7 c5 af a2  |.......O..7s....|
+000000f0  37 96 ba 06 49 6a 2d a2  23 39 2e 9b f1 fc 01 de  |7...Ij-.#9......|
+00000100  53 75 ee 34 ae 27 ea 49  6a d8 d0 cd 9b e8 60 b7  |Su.4.'.Ij.....`.|
+00000110  f6 b1 8e 26 ec 6c 36 87  d6 70 49 07 e0 96 2a bd  |...&.l6..pI...*.|
+00000120  45 a3 b1 f5 dc b0 a3 4f  dc d8 c3 fd 4f fb 98 13  |E......O....O...|
+00000130  67 55 99 39 b5 16 19 72  9d f1 5a cf 6e 53 d9 03  |gU.9...r..Z.nS..|
+00000140  05 f5 81 07 a1 38 a1 e5  4c 76 51 1a ae f6 4b f6  |.....8..LvQ...K.|
+00000150  b2 a7 84 1e 2a 31 b0 b8  9f 41 e8 e5 32 18 44 4c  |....*1...A..2.DL|
+00000160  0b fb e3 d9 4c dd 45 c5  c4 c4 57 bf f7 5a dc f6  |....L.E...W..Z..|
+00000170  73 98 d4 ea 2f c0 cb 35  97 c1 45 94 37 87 d3 8c  |s.../..5..E.7...|
+00000180  65 3f ee a8 67 a6 00 80  92 02 76 e8 0a 04 ce 7a  |e?..g.....v....z|
+00000190  79 4f cd 70 1a 31 5a 03  83 01 de 1f 4a 46 39 4e  |yO.p.1Z.....JF9N|
+000001a0  d0 80 6e 67 d7 e6 fc ba  74 4b 57 d2 3c 19 7b 03  |..ng....tKW.<.{.|
+000001b0  ab 9a e2 f7 db 58 c2 b7  58 96 55 88 e6 e2 e2 f8  |.....X..X.U.....|
+000001c0  ab e9 b0 12 ef ff e6 53  7b 4e 01 2f 65 0d 05 f0  |.......S{N./e...|
+000001d0  95 9f 46 d2 ae e7 33 5c  37 56 ab 67 95 87 81 59  |..F...3\7V.g...Y|
+000001e0  f2 35 76 78 ed 13 63 a3  58 52 af 46 e6 aa c3 99  |.5vx..c.XR.F....|
+000001f0  37 9d 10 25 cc 7f 7e 63  e1 96 6d 7a 8e ac 9e 00  |7..%..~c..mz....|
+00000200  d1 0e 7a 48 b6 82 77 6a  a0 17 d1 77 70 f8 40 4a  |..zH..wj...wp.@J|
+00000210  c4 90 da b0 3f 25 68 f5  9f dd 5e ec 95 02 19 53  |....?%h...^....S|
+00000220  08 6a 13 11 88 9e 2b 25  b8 28 cd 58 36 d7 d3 95  |.j....+%.(.X6...|
+00000230  f5 91 63 92 ff 3b d2 4f  75 ae 47 6c 64 8a a4 76  |..c..;.Ou.Gld..v|
+00000240  48 96 a7 35 d6 35 22 96  4d 4f ee 45 fb 88 52 68  |H..5.5".MO.E..Rh|
+00000250  4e 38 93 e8 08 6a e6 f3  00 a7 f7 b0 0b 68 41 ab  |N8...j.......hA.|
+00000260  9b 3a 92 2b fd b2 71 14  77 91 48 e7 70 62 b5 b0  |.:.+..q.w.H.pb..|
+00000270  45 90 35 d2 b3 22 f5 70  6c 62 7f 55 6b 56 42 f8  |E.5..".plb.UkVB.|
+00000280  6c 87 a7 60 45 37 f0 41  41 ec 73 f5 f1 d9 d2 84  |l..`E7.AA.s.....|
+00000290  bd 88 bc 9b 43 ec 8b b3  c4 3a 59 2c 30 61 30 98  |....C....:Y,0a0.|
+000002a0  78 d3 e7 85 dd 7e 80 b8  fb b3 bf 7e 11 79 e8 20  |x....~.....~.y. |
+000002b0  aa b8 81 94 10 5c f8 ba  70 4c 1e 7c 35 8f 48 30  |.....\..pL.|5.H0|
+000002c0  17 38 d6 1c 91 ed 00 2c  f7 af 29 d3 cb 9b ab 6b  |.8.....,..)....k|
+000002d0  b3 fa 6e 1a 9b a8 cf 08  8e 03 a5 f7 76 17 74 3a  |..n.........v.t:|
+000002e0  9e 36 ae 19 fd 2c 44 14  f3 2b 1d 01 db e1 96 22  |.6...,D..+....."|
+000002f0  25 14 5b d8 16 03 03 00  bc bb 8c bb cf f9 d7 76  |%.[............v|
+00000300  7a a7 d6 e0 29 cb 45 21  8d 57 0b 81 0c e0 96 05  |z...).E!.W......|
+00000310  c7 96 67 43 0f 41 11 e9  c2 07 2d 62 17 b4 64 01  |..gC.A....-b..d.|
+00000320  c5 75 79 dc 9c 36 3f ea  42 ea 09 a7 bc 0f 6b b1  |.uy..6?.B.....k.|
+00000330  b4 4d ae 38 0a ca 51 d0  97 46 b6 55 12 7c 24 28  |.M.8..Q..F.U.|$(|
+00000340  77 16 64 42 53 70 c4 52  ed e5 aa 20 3a 00 7e d0  |w.dBSp.R... :.~.|
+00000350  9e 99 e4 56 5f ef 30 56  00 8b e7 31 6d 66 6d dc  |...V_.0V...1mfm.|
+00000360  58 8a b0 60 6f 16 a7 b0  14 a5 9d 3d 38 94 6e 16  |X..`o......=8.n.|
+00000370  a3 22 76 e9 59 d8 90 cd  32 83 bb 8c c5 23 cb c2  |."v.Y...2....#..|
+00000380  c5 03 02 de 13 97 ac 4e  99 9f 4d 6d aa ed 72 b7  |.......N..Mm..r.|
+00000390  76 db 8b c9 31 17 b9 1c  4a fa 87 2c 6b dc 07 82  |v...1...J..,k...|
+000003a0  a2 39 e0 09 32 a2 8e 1c  6e 68 e1 14 ba ab 3a d4  |.9..2...nh....:.|
+000003b0  1e 4f f4 39 c7 16 03 03  00 3a cf b2 61 5f 7e ef  |.O.9.....:..a_~.|
+000003c0  04 51 64 f6 3d b3 54 44  bd 8a d0 87 48 64 76 a6  |.Qd.=.TD....Hdv.|
+000003d0  0d bc 7f b7 99 d4 67 8b  cd e3 c4 5d df c5 c8 fc  |......g....]....|
+000003e0  be d1 c4 03 6d 61 2d 10  58 b1 7a 7c 9e 1c 6b 16  |....ma-.X.z|..k.|
+000003f0  ff 31 a8 87 16 03 03 00  14 85 99 57 4b a1 19 33  |.1.........WK..3|
+00000400  bd 9a 86 ed be 5d 24 f0  02 9d ca 1e 26           |.....]$.....&|
 >>> Flow 9 (client to server)
-00000000  16 03 03 02 71 00 00 00  00 00 00 00 03 6d b0 55  |....q........m.U|
-00000010  6c 78 64 b3 f3 37 eb 16  e0 59 c9 c5 63 f7 57 8c  |lxd..7...Y..c.W.|
-00000020  0a 96 bc 53 31 73 e4 4a  ff ad 54 8d 9e a9 da 19  |...S1s.J..T.....|
-00000030  1b 84 21 c1 75 49 05 ca  ef 69 91 ad 32 25 34 77  |..!.uI...i..2%4w|
-00000040  35 74 ef d3 8d 3d 1b 4d  22 32 ef c1 b5 50 52 75  |5t...=.M"2...PRu|
-00000050  23 29 27 98 e0 a1 e9 c1  9f e2 ee 25 f5 18 45 ca  |#)'........%..E.|
-00000060  bf 97 73 44 bb 1e ea 7d  c5 ee 1c cc e7 bb 5d e8  |..sD...}......].|
-00000070  a3 e8 85 2d 94 6c de 25  f0 70 a8 51 5a 18 c0 49  |...-.l.%.p.QZ..I|
-00000080  ab d6 ff 30 64 39 63 fd  87 80 f7 df 56 5c c9 17  |...0d9c.....V\..|
-00000090  65 b1 fa 00 d1 6c 05 b0  08 68 4d 78 15 2a 8a d1  |e....l...hMx.*..|
-000000a0  e6 f9 3a 08 48 43 36 08  f0 bb 75 29 a5 81 1e 28  |..:.HC6...u)...(|
-000000b0  70 0f 23 47 0d bf 63 f2  fb f0 c4 64 39 c2 1c 35  |p.#G..c....d9..5|
-000000c0  ed 3c c3 06 ed b8 db e0  e8 4f 5c ab 37 fe 7c df  |.<.......O\.7.|.|
-000000d0  eb 62 9c d0 9a 9a 93 b1  a6 47 5a 18 11 15 eb db  |.b.......GZ.....|
-000000e0  37 99 d9 2b 60 31 96 1f  63 1f a9 4d 0b 8a 4c 68  |7..+`1..c..M..Lh|
-000000f0  19 01 b6 11 90 7c fb b8  b2 83 24 12 14 d0 fd 4c  |.....|....$....L|
-00000100  56 12 2b 82 05 2b a2 5a  af 88 f0 f7 cb 7c 06 64  |V.+..+.Z.....|.d|
-00000110  11 d6 05 65 16 8b 3f b4  49 22 4f 3e 05 2d 62 e5  |...e..?.I"O>.-b.|
-00000120  06 12 0f e3 81 c6 34 8b  08 3e 56 6a 0f 09 69 68  |......4..>Vj..ih|
-00000130  45 5c 7d 4f d2 a6 cb 50  e5 c6 22 52 22 f2 8f 68  |E\}O...P.."R"..h|
-00000140  07 8b f7 e6 64 16 2f 53  01 55 05 f5 67 ad 03 28  |....d./S.U..g..(|
-00000150  9e 57 6b 57 1a c5 41 46  1c 76 64 37 02 b6 0d c8  |.WkW..AF.vd7....|
-00000160  32 1a 50 25 4d b8 16 66  6c ec 88 5a 4a 91 f9 5d  |2.P%M..fl..ZJ..]|
-00000170  af 00 f0 43 97 c3 b8 b5  3f b7 ca bf 1e ad fb c7  |...C....?.......|
-00000180  eb a7 47 75 8c ba 92 89  e2 e5 dc 46 6c 5a bf bf  |..Gu.......FlZ..|
-00000190  3d a5 f2 69 a2 ca 38 66  8b 40 68 db 5f 47 70 a5  |=..i..8f.@h._Gp.|
-000001a0  c4 cc 4e b0 3c 60 c6 56  18 b6 b5 21 94 38 e3 bf  |..N.<`.V...!.8..|
-000001b0  98 94 4b 4e bc 0c 71 5a  5b a7 ba 4b 5b 1d 31 aa  |..KN..qZ[..K[.1.|
-000001c0  48 68 f9 3a 76 1d b2 6e  2d 92 13 17 ed b6 1f 9f  |Hh.:v..n-.......|
-000001d0  81 63 83 c4 49 8d 0c f1  7e a7 d9 10 32 3f 82 43  |.c..I...~...2?.C|
-000001e0  14 b5 a6 d3 56 cb f9 7a  96 5a 5f 78 8c 04 17 d0  |....V..z.Z_x....|
-000001f0  7d 87 78 a0 1d 8d b5 7c  a5 76 df cb 46 4a 84 03  |}.x....|.v..FJ..|
-00000200  b6 b4 ee 71 7d 2e 64 5c  82 82 18 ec c3 db 9e 0f  |...q}.d\........|
-00000210  fe 15 c5 0c 7e 2c 19 15  be 35 4e 1f 04 9f b3 a4  |....~,...5N.....|
-00000220  b5 55 ed 86 1c b1 a4 9a  34 7e 26 0e dc 3d c8 5d  |.U......4~&..=.]|
-00000230  75 9e c7 60 76 dc ab de  e0 9f 44 1c 08 99 8d c8  |u..`v.....D.....|
-00000240  90 8a f7 bc 25 54 f1 3b  e1 d4 fc 40 b1 c3 b6 c4  |....%T.;...@....|
-00000250  de d4 0f 2c ad 16 26 1d  4b e1 70 2b 5c 71 0a fd  |...,..&.K.p+\q..|
-00000260  e8 b9 91 a7 2a 63 62 00  b7 c2 e4 2f 7d cc 4b fd  |....*cb..../}.K.|
-00000270  64 cb 22 8a ff 50 16 03  03 00 3d 00 00 00 00 00  |d."..P....=.....|
-00000280  00 00 04 e8 59 f7 44 61  0c 43 cd f8 7f ad 5a a4  |....Y.Da.C....Z.|
-00000290  98 e8 01 ae 9f 7f 3c b3  3b 27 51 e6 a3 1a b8 83  |......<.;'Q.....|
-000002a0  14 aa a7 4c 2e 9d 26 c1  6e bc bb 9c e4 f7 71 7a  |...L..&.n.....qz|
-000002b0  c6 6a 31 68 8d a5 bd a4  16 03 03 00 a0 00 00 00  |.j1h............|
-000002c0  00 00 00 00 05 17 e6 f8  67 74 57 c0 06 b4 7f d7  |........gtW.....|
-000002d0  a8 52 96 20 fc a8 2b 2b  c4 a1 b2 04 73 ae db bc  |.R. ..++....s...|
-000002e0  40 e5 41 fe 7d 5f 2c ba  1e b5 0c e1 8e 03 02 25  |@.A.}_,........%|
-000002f0  11 8c 78 f0 50 06 59 6d  d0 98 d7 20 64 c5 79 ba  |..x.P.Ym... d.y.|
-00000300  0f 3a 60 5d cc f9 03 7f  a7 10 22 38 78 e7 82 0f  |.:`]......"8x...|
-00000310  b3 d8 38 89 46 bb 75 42  59 8e e2 53 3f 0c 14 5e  |..8.F.uBY..S?..^|
-00000320  6e dd b1 c7 3e 0d ba bf  02 0a 64 d8 33 2f 1d 10  |n...>.....d.3/..|
-00000330  30 03 fc be f3 af 1b 0b  a9 05 31 e7 32 c3 41 9d  |0.........1.2.A.|
-00000340  2e 00 02 a0 71 42 f9 49  df eb 48 63 71 df 09 63  |....qB.I..Hcq..c|
-00000350  5f 9c 34 18 43 32 30 75  c3 6d de 8e a2 14 03 03  |_.4.C20u.m......|
-00000360  00 19 00 00 00 00 00 00  00 06 da 28 dc 12 7b 5d  |...........(..{]|
-00000370  41 c4 ea b9 e1 a1 d4 ab  05 c3 1b 16 03 03 00 28  |A..............(|
-00000380  00 00 00 00 00 00 00 00  ce 17 3c 16 85 79 e9 b8  |..........<..y..|
-00000390  93 ee df 0f 87 ab 3a 5f  bb 64 0f f3 59 0d 35 87  |......:_.d..Y.5.|
-000003a0  2b 06 4d 43 9e 3a f7 72                           |+.MC.:.r|
+00000000  16 03 03 02 69 8c c7 01  da 38 a5 36 3d 2c 21 1c  |....i....8.6=,!.|
+00000010  64 1b b8 e7 c2 cd 17 06  b6 51 0e e6 d9 d9 18 c5  |d........Q......|
+00000020  a9 c9 ac 5d 2d 23 f8 15  92 b2 e1 62 6e d7 8d 58  |...]-#.....bn..X|
+00000030  5b d9 b8 26 e5 ec 0f 61  15 3e 12 70 89 0d 3f 4e  |[..&...a.>.p..?N|
+00000040  e3 2e 18 42 7c c7 59 7b  e1 48 d9 a8 cf b1 cd 38  |...B|.Y{.H.....8|
+00000050  17 90 97 89 2e 4f 4b df  58 b0 9f 4e 95 d2 e9 70  |.....OK.X..N...p|
+00000060  6d 0b 82 af b7 05 be 11  26 d8 f9 89 e6 d6 44 f5  |m.......&.....D.|
+00000070  db 7c 8c 91 61 78 dc 68  98 9b 10 17 5b 85 42 93  |.|..ax.h....[.B.|
+00000080  31 a2 16 97 72 c5 f2 d0  81 76 a6 9b b7 9c 14 ab  |1...r....v......|
+00000090  a7 bf 19 f7 34 e3 8f 3f  a5 aa 23 c8 49 07 1b 6f  |....4..?..#.I..o|
+000000a0  e5 5d 65 66 a1 dc d2 e7  bb c2 4b 9e a7 9a dc d6  |.]ef......K.....|
+000000b0  72 42 d3 71 d3 51 a4 3a  82 f7 cd 2a 15 34 da 6d  |rB.q.Q.:...*.4.m|
+000000c0  44 3a a9 7d 6e 4c ce a5  ba 6b 5b 3b 88 8c e1 29  |D:.}nL...k[;...)|
+000000d0  ee a8 17 1b 02 36 8f 68  c9 9e e6 f1 bf e3 e3 e0  |.....6.h........|
+000000e0  cd 6d 7f ff c2 4d 3f 88  c7 9b 75 20 e5 cd fa fa  |.m...M?...u ....|
+000000f0  a0 d7 10 6a c1 00 73 f9  df bd 22 60 8c 82 71 e6  |...j..s..."`..q.|
+00000100  56 aa 90 bf c7 a8 82 51  e7 23 42 ec 99 f5 b9 aa  |V......Q.#B.....|
+00000110  3c cc c6 32 11 29 1f a6  ae 89 03 04 e8 de 9f f4  |<..2.)..........|
+00000120  bd 87 ae af 91 ee a2 f3  e2 6d 7b 87 ad 67 16 2d  |.........m{..g.-|
+00000130  ad 92 34 38 52 ed 7c 38  92 45 16 26 9f 65 d2 67  |..48R.|8.E.&.e.g|
+00000140  3e 33 a1 bd b2 f6 d3 c8  76 96 52 11 0d 8d ac a6  |>3......v.R.....|
+00000150  27 10 6a 43 63 5f 82 41  e7 fe 91 24 68 70 bd 2c  |'.jCc_.A...$hp.,|
+00000160  35 fd 0e 49 ec 3a dd f3  c0 af 5c f4 61 9a 2a 00  |5..I.:....\.a.*.|
+00000170  59 b5 28 24 f0 cf d3 25  bc 77 65 74 04 ee 4b 5e  |Y.($...%.wet..K^|
+00000180  2b 9f 1d 27 e2 dd 1a ed  ab e5 ff d6 1a 55 d7 4d  |+..'.........U.M|
+00000190  5c da 14 96 21 43 f6 c3  2d 78 e5 75 60 69 26 ce  |\...!C..-x.u`i&.|
+000001a0  7a 66 5e 42 91 0e ef 41  c2 c4 e6 15 8a 9a 17 a1  |zf^B...A........|
+000001b0  d9 23 2c cc c7 81 00 71  b0 52 ec 4e ea eb f9 75  |.#,....q.R.N...u|
+000001c0  2e 87 16 b4 ba 25 8c 09  f1 23 f9 ee ea db 0e b5  |.....%...#......|
+000001d0  d0 dd 47 9b b6 06 a3 f3  5e 0d 34 5a ba 76 cd 0a  |..G.....^.4Z.v..|
+000001e0  b1 9f 8a 99 aa d3 02 2e  b6 04 7b c5 d3 2f dc d7  |..........{../..|
+000001f0  68 af 6b 88 90 0a 94 a4  29 65 0b ba b3 da f2 cd  |h.k.....)e......|
+00000200  51 93 4f ea b4 f8 54 c7  28 e3 2d 63 d0 62 54 d9  |Q.O...T.(.-c.bT.|
+00000210  27 a0 85 57 7b a2 f2 f5  a5 25 83 1b e2 36 15 06  |'..W{....%...6..|
+00000220  41 ae e1 f9 ca a5 c6 59  2d da 4a ed 10 7b 80 01  |A......Y-.J..{..|
+00000230  06 39 f2 a8 4b 22 37 4d  aa 84 79 85 71 29 1b 4e  |.9..K"7M..y.q).N|
+00000240  c3 79 af 13 f5 4e 3c 6d  fa 8c d7 55 13 2b 48 3d  |.y...N<m...U.+H=|
+00000250  9a 79 e2 b4 3f 59 f8 f9  6c d2 39 51 e0 6e c2 c3  |.y..?Y..l.9Q.n..|
+00000260  09 06 d4 e0 4f 76 a6 54  b8 9d ef 30 ba 80 16 03  |....Ov.T...0....|
+00000270  03 00 35 df a1 cc 0f 77  42 24 fe 38 ac ec 25 cf  |..5....wB$.8..%.|
+00000280  13 85 03 87 73 b4 c0 d9  97 d0 a8 8e 12 f4 13 61  |....s..........a|
+00000290  42 40 03 a6 b6 6c d3 dd  d9 92 f0 e9 bc bc a7 22  |B@...l........."|
+000002a0  64 cf 4b 00 97 71 ac 3b  16 03 03 00 98 f7 61 85  |d.K..q.;......a.|
+000002b0  47 fc 23 b5 34 4b 1f 10  c7 12 51 07 a2 40 40 48  |G.#.4K....Q..@@H|
+000002c0  1c 79 52 3a a7 9d ca 45  62 a2 53 71 bd 23 0a 77  |.yR:...Eb.Sq.#.w|
+000002d0  0b 7f 8c ff f2 51 da 91  07 d7 67 71 bb ec 02 8d  |.....Q....gq....|
+000002e0  3f 79 dc d9 af f4 4c 78  3e ac 8d 30 ed eb c9 19  |?y....Lx>..0....|
+000002f0  96 89 a7 0f 7c fb 96 18  84 86 e7 bd e2 35 31 0c  |....|........51.|
+00000300  7a 51 d7 94 6b 61 62 7a  6a d8 56 62 e6 cf bf 60  |zQ..kabzj.Vb...`|
+00000310  df 7a c5 ce d3 87 ea 2f  5a ad 90 d4 39 f7 47 8e  |.z...../Z...9.G.|
+00000320  8b d3 6b 8e e0 3f 2f 59  71 e4 e6 bf 3f 4a 29 a8  |..k..?/Yq...?J).|
+00000330  60 df 1b 5c 2d 21 ab 0a  a5 9f 5a a2 a3 d6 08 3c  |`..\-!....Z....<|
+00000340  4a 4b f9 d6 a0 14 03 03  00 11 44 a4 62 7e c1 4a  |JK........D.b~.J|
+00000350  4e 56 dd 08 65 b2 ab 12  cd fa 8d 16 03 03 00 20  |NV..e.......... |
+00000360  b4 52 5a e8 33 b6 23 b1  b4 e6 59 da b0 84 52 94  |.RZ.3.#...Y...R.|
+00000370  70 de dc 02 f6 41 e3 27  7c 27 56 6a 7c 92 e3 48  |p....A.'|'Vj|..H|
 >>> Flow 10 (server to client)
-00000000  14 03 03 00 19 d5 b6 c4  29 29 df 16 e2 4a a4 51  |........))...J.Q|
-00000010  c8 7b 79 11 78 29 f0 64  44 70 52 fa 52 8d 16 03  |.{y.x).dDpR.R...|
-00000020  03 00 28 ce 2a 17 67 6b  54 f1 47 d5 70 2f c6 a9  |..(.*.gkT.G.p/..|
-00000030  05 08 32 a0 fd 6a 3f cd  a6 3f c6 82 a7 52 e2 bb  |..2..j?..?...R..|
-00000040  bf 20 39 f4 9c fe 09 a0  43 1b 67 17 03 03 00 21  |. 9.....C.g....!|
-00000050  ce 2a 17 67 6b 54 f1 48  b0 87 d9 2e f5 cc 2a de  |.*.gkT.H......*.|
-00000060  72 76 57 41 18 3d 5b 13  73 c3 0c 81 b8 a2 59 b6  |rvWA.=[.s.....Y.|
-00000070  84 16 03 03 00 1c ce 2a  17 67 6b 54 f1 49 11 da  |.......*.gkT.I..|
-00000080  63 9e 68 53 c5 e2 f1 b8  94 68 b6 e7 42 80 24 9f  |c.hS.....h..B.$.|
-00000090  fd ff                                             |..|
+00000000  14 03 03 00 11 c7 92 b3  aa a0 91 21 4f 42 96 0c  |...........!OB..|
+00000010  3a 92 c3 53 55 d1 16 03  03 00 20 4b da e5 1c 08  |:..SU..... K....|
+00000020  ce a7 33 f1 a6 c7 47 52  19 68 b4 f5 1d 66 a7 38  |..3...GR.h...f.8|
+00000030  97 45 43 9f ca b5 db 2c  14 fc f4 17 03 03 00 19  |.EC....,........|
+00000040  28 f4 bb bf c1 5a 2d 1e  b8 fc c7 fc 55 16 e9 cc  |(....Z-.....U...|
+00000050  43 a3 63 58 7e 2c 60 77  23 16 03 03 00 14 2c e6  |C.cX~,`w#.....,.|
+00000060  25 0a b7 26 7b 13 55 62  f1 fe 6e fe 0e 57 53 57  |%..&{.Ub..n..WSW|
+00000070  19 1b                                             |..|
 >>> Flow 11 (client to server)
-00000000  15 03 03 00 1a 00 00 00  00 00 00 00 01 dd 54 03  |..............T.|
-00000010  74 9c e9 bd 9a 25 c3 dd  2d 92 76 e6 a3 8c f8 15  |t....%..-.v.....|
-00000020  03 03 00 1a 00 00 00 00  00 00 00 02 44 99 ff f4  |............D...|
-00000030  f2 45 00 b3 0b 1c 14 90  38 e2 4e 80 71 ce        |.E......8.N.q.|
+00000000  15 03 03 00 12 dd 2b 00  09 fd 8c 7d 21 3d 7c 06  |......+....}!=|.|
+00000010  93 ca c9 21 b2 3e 20 15  03 03 00 12 90 32 4b 3b  |...!.> ......2K;|
+00000020  33 4d fd 69 55 81 aa 42  16 ae 47 b9 4c 06        |3M.iU..B..G.L.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected b/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected
index a824099ccb..cb964324fd 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 bf 1a 08 27 45  |....Y...U.....'E|
-00000010  0a 77 6e 2a 2e 86 6d 5f  90 13 84 99 ff d5 3e 7a  |.wn*..m_......>z|
-00000020  39 87 cf d5 6f 68 8e 68  7d 47 59 20 79 cd 8b 6a  |9...oh.h}GY y..j|
-00000030  70 88 0b 0d f3 d4 08 f3  99 2f c2 4a b3 f3 a7 89  |p......../.J....|
-00000040  ab f6 0c 91 9a f0 b1 aa  2f 27 3e 92 c0 2f 00 00  |......../'>../..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 91 a6 bc 02 ab  |....Y...U.......|
+00000010  19 62 2c de 45 57 ba 71  c0 b0 4d 78 5e f4 c2 b9  |.b,.EW.q..Mx^...|
+00000020  81 ba 8b d6 b1 9b c8 fb  0c 7c 40 20 dc 66 80 5b  |.........|@ .f.[|
+00000030  20 3c 60 65 7f 9e 0c 67  a8 f3 22 c9 c5 48 80 fa  | <`e...g.."..H..|
+00000040  02 a1 1a 48 6d 1c 46 07  db 6c 8e 85 cc a8 00 00  |...Hm.F..l......|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -54,40 +54,36 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 e3 0e 3b be 13 b7 01  |........ ..;....|
-000002d0  32 0e bf ab ee 5d ea e1  79 f4 16 34 b3 ce 5d e4  |2....]..y..4..].|
-000002e0  8b 4d a2 ef 83 78 b2 ab  60 04 01 00 80 31 3f da  |.M...x..`....1?.|
-000002f0  24 88 42 84 73 4e 0b 80  7c d8 a1 c0 c2 c8 b6 27  |$.B.sN..|......'|
-00000300  df 41 23 0a 30 91 3f 01  cc d2 8b 66 03 4b 63 c1  |.A#.0.?....f.Kc.|
-00000310  02 18 b5 44 77 ae 7e 7d  eb b5 5c 76 fc c9 c5 ec  |...Dw.~}..\v....|
-00000320  27 71 a1 09 c1 34 6f 48  10 4d da e0 21 4b 30 32  |'q...4oH.M..!K02|
-00000330  9b 71 34 6b 6e 79 a3 80  2c 2b 85 5d 3c 44 4f 64  |.q4kny..,+.]<DOd|
-00000340  f3 d1 85 ad 03 41 8c 84  ff ab 95 0e d2 8d d0 8b  |.....A..........|
-00000350  31 78 f7 78 06 56 97 28  49 6c 01 0f 1e a7 b4 be  |1x.x.V.(Il......|
-00000360  b0 88 7a 44 68 f3 fc a2  1d 36 a6 e0 cc 16 03 03  |..zDh....6......|
+000002c0  ac 0c 00 00 a8 03 00 1d  20 f5 fd 54 ea 3e bb 70  |........ ..T.>.p|
+000002d0  fb 8e fb e4 8a 25 1f 9d  3d 9a fb fb 9d ff d1 52  |.....%..=......R|
+000002e0  81 9d b0 ea a1 e6 b0 87  2f 04 01 00 80 77 54 16  |......../....wT.|
+000002f0  98 5d 22 c4 7f 9b 2a 44  dd e4 0d 78 c2 60 6a ad  |.]"...*D...x.`j.|
+00000300  91 9d d9 ed 93 0b 4e b4  c6 26 f1 94 6d e0 cc f4  |......N..&..m...|
+00000310  8d fa 9c ec 70 f5 5b ac  80 d7 5e 4f 49 04 bc 24  |....p.[...^OI..$|
+00000320  8e 0a 7d 44 e1 7e 47 1e  a8 68 d1 fe 6f 41 0d 4a  |..}D.~G..h..oA.J|
+00000330  e5 5b f6 f6 a3 af 76 21  56 1a 25 d2 03 3c f4 dd  |.[....v!V.%..<..|
+00000340  0c 13 ce 56 8a 61 6f 5b  8c a1 04 43 82 87 64 20  |...V.ao[...C..d |
+00000350  4a 3b ec 90 d7 59 aa ca  08 3a 39 57 f1 56 57 6a  |J;...Y...:9W.VWj|
+00000360  18 c9 14 7f e3 8d 83 0f  e2 0b 4d 24 01 16 03 03  |..........M$....|
 00000370  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 8d 66 75  |....(.........fu|
-00000040  38 f8 b0 d3 0d 81 49 01  73 1e eb 1d 00 71 08 d9  |8.....I.s....q..|
-00000050  87 20 83 14 4c 54 f1 60  61 4d 19 53 42           |. ..LT.`aM.SB|
+00000030  16 03 03 00 20 6b ce 5c  2f df 85 e7 5e fa 51 48  |.... k.\/...^.QH|
+00000040  f9 31 a5 02 64 c7 1e b1  2e f2 6b 86 30 43 23 91  |.1..d.....k.0C#.|
+00000050  76 6b 40 74 2b                                    |vk@t+|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 23 7e 00 58 a6  |..........(#~.X.|
-00000010  9c 0b ad 95 ad 99 7e d0  ff e3 ef 7c 14 c8 49 39  |......~....|..I9|
-00000020  0e 46 24 16 22 a7 94 51  9c c6 8d 8a cb f1 66 14  |.F$."..Q......f.|
-00000030  99 fd 15                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 20 e7 1e 88 10 2d  |.......... ....-|
+00000010  dc 35 6d 2b 4a 91 39 5d  5c 46 ed 2e 45 6f 41 38  |.5m+J.9]\F..EoA8|
+00000020  66 0f 15 58 f8 af d8 a6  6c 99 61                 |f..X....l.a|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 94 e4 ff  |................|
-00000010  cd 27 dd 2b c7 3d ee c1  95 b9 85 e9 46 68 2e 68  |.'.+.=......Fh.h|
-00000020  f2 4e 10                                          |.N.|
+00000000  17 03 03 00 16 ab 2a df  2f 3c 07 6a 24 98 55 0b  |......*./<.j$.U.|
+00000010  67 20 2d 92 cd 9a 44 74  da fd 6a                 |g -...Dt..j|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 1c 23 7e 00  58 a6 9c 0b ae 3b 83 b7  |.....#~.X....;..|
-00000010  9d 40 bc d7 47 ea a8 f4  4e 37 50 e3 d7 21 92 8d  |.@..G...N7P..!..|
-00000020  b7                                                |.|
+00000000  16 03 03 00 14 d6 fb e7  9a 76 2a 6f e1 e9 33 1a  |.........v*o..3.|
+00000010  77 07 fd 7f 98 af 1e 04  43                       |w.......C|
 >>> Flow 7 (client to server)
-00000000  15 03 03 00 1a 00 00 00  00 00 00 00 02 98 b4 1c  |................|
-00000010  2c c3 7c a1 9c 8c 09 b0  0a d1 d5 f4 99 ed 64 15  |,.|...........d.|
-00000020  03 03 00 1a 00 00 00 00  00 00 00 03 16 2a 34 39  |.............*49|
-00000030  17 2a 3b 3a e9 88 99 e8  b1 d9 d2 47 41 d8        |.*;:.......GA.|
+00000000  15 03 03 00 12 7e e3 20  96 03 31 8c 6a 31 f8 62  |.....~. ..1.j1.b|
+00000010  02 a7 a4 ce 77 83 c1 15  03 03 00 12 b9 91 75 45  |....w.........uE|
+00000020  a5 4a f9 c6 6d b2 5c c3  0a 1a 26 63 00 04        |.J..m.\...&c..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-SCT b/src/crypto/tls/testdata/Client-TLSv12-SCT
index dcc706c702..a0f6a090af 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-SCT
+++ b/src/crypto/tls/testdata/Client-TLSv12-SCT
@@ -1,20 +1,20 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8d 01 00 00  89 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 91 01 00 00  8d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 38 00 05 00 05 01 00  |.........8......|
-00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
-00000070  19 00 0b 00 02 01 00 00  0d 00 0e 00 0c 04 01 04  |................|
-00000080  03 05 01 05 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-00000090  00 00                                             |..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 38 00 05  |.............8..|
+00000060  00 05 01 00 00 00 00 00  0a 00 0a 00 08 00 1d 00  |................|
+00000070  17 00 18 00 19 00 0b 00  02 01 00 00 0d 00 0e 00  |................|
+00000080  0c 04 01 04 03 05 01 05  03 02 01 02 03 ff 01 00  |................|
+00000090  01 00 00 12 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 03 01 c6 02 00 01  c2 03 03 c5 2c ed 73 81  |............,.s.|
-00000010  42 44 d2 72 10 7e 8d d4  91 c3 5e 47 54 34 c8 3a  |BD.r.~....^GT4.:|
-00000020  90 1c 28 1d 02 b7 45 a8  5d db dc 20 35 81 26 bc  |..(...E.].. 5.&.|
-00000030  db 5d f3 47 e4 85 24 f6  7c 84 47 b9 5f fa 24 0c  |.].G..$.|.G._.$.|
-00000040  a5 61 35 50 fd e7 61 cb  f0 44 3d 77 c0 2f 00 01  |.a5P..a..D=w./..|
+00000000  16 03 03 01 c6 02 00 01  c2 03 03 08 db 5c c4 da  |.............\..|
+00000010  fe 2c a2 21 0d c4 9e c4  14 b9 e3 15 d7 c5 2c 84  |.,.!..........,.|
+00000020  f2 b8 0e 32 67 9e 72 08  9c 17 6b 20 86 09 60 52  |...2g.r...k ..`R|
+00000030  9d 53 ba c8 8a c3 1a 11  c0 e5 c6 a0 59 49 ed cb  |.S..........YI..|
+00000040  e0 6f 0a 56 e9 4f bf 02  2f 23 10 b8 cc a8 00 01  |.o.V.O../#......|
 00000050  7a ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 12  |z...............|
 00000060  01 69 01 67 00 75 00 a4  b9 09 90 b4 18 58 14 87  |.i.g.u.......X..|
 00000070  bb 13 a2 cc 67 70 0a 3c  35 98 04 f9 1b df b8 e3  |....gp.<5.......|
@@ -77,33 +77,31 @@
 00000400  1c f1 0f a1 d8 40 83 61  c9 4c 72 2b 9d ae db 46  |.....@.a.Lr+...F|
 00000410  06 06 4d f4 c1 b3 3e c0  d1 bd 42 d4 db fe 3d 13  |..M...>...B...=.|
 00000420  60 84 5c 21 d3 3b e9 fa  e7 16 03 03 00 ac 0c 00  |`.\!.;..........|
-00000430  00 a8 03 00 1d 20 36 fb  e2 0e 7c d0 a4 e6 6a 11  |..... 6...|...j.|
-00000440  b0 da 6f b9 d5 d5 27 73  3d 24 4e 06 0d 50 85 81  |..o...'s=$N..P..|
-00000450  13 94 25 dc 2c 6a 04 01  00 80 54 9b 72 01 e9 91  |..%.,j....T.r...|
-00000460  f3 71 62 c2 4e 8b 2f fa  d4 1f 8b 7f 87 0e c4 70  |.qb.N./........p|
-00000470  22 aa 93 05 2f ae 77 75  e4 16 c0 7a 0b 95 e2 60  |".../.wu...z...`|
-00000480  95 b6 a3 52 77 9a 0e cd  ab f6 af 29 28 df f1 97  |...Rw......)(...|
-00000490  56 50 54 c6 c8 ac a6 cd  a8 c1 ba 56 e1 a7 37 7f  |VPT........V..7.|
-000004a0  a6 20 ae b7 74 5b a8 66  7a c0 ef 41 02 2d ab e4  |. ..t[.fz..A.-..|
-000004b0  9e f4 44 30 49 50 8d 83  5b 0d 8c d7 31 04 f2 bc  |..D0IP..[...1...|
-000004c0  63 bf 23 8e b8 59 2b cd  0c 69 10 02 66 06 d9 74  |c.#..Y+..i..f..t|
-000004d0  33 db 7f 66 15 9f 99 f0  f7 ef 16 03 03 00 04 0e  |3..f............|
+00000430  00 a8 03 00 1d 20 27 94  d8 62 00 f3 3f 21 e6 e1  |..... '..b..?!..|
+00000440  0f 1f 2d 9b 37 4d cf 72  34 48 72 2e 85 46 dd b6  |..-.7M.r4Hr..F..|
+00000450  32 23 64 b3 4b 63 04 01  00 80 82 34 e5 7f 70 51  |2#d.Kc.....4..pQ|
+00000460  42 3b ab 51 61 73 1f 2c  64 04 1d 66 96 ff f9 95  |B;.Qas.,d..f....|
+00000470  86 09 a8 75 11 16 34 05  17 fb 96 9c fb 78 40 4c  |...u..4......x@L|
+00000480  10 5b ee 0d 31 a0 77 32  a8 0f 19 ef a4 30 cd 08  |.[..1.w2.....0..|
+00000490  cb f5 ec 36 fa 24 0a ca  0b d8 16 02 d1 34 86 a7  |...6.$.......4..|
+000004a0  f8 e3 cb e6 62 1c cd 40  d6 4f 0c 2f 5b 66 12 6f  |....b..@.O./[f.o|
+000004b0  8a 2f c4 ef ac 46 86 44  90 e0 65 38 94 4d 5e df  |./...F.D..e8.M^.|
+000004c0  51 a3 40 6e 64 b6 00 6b  88 97 7b 43 78 d9 df 70  |Q.@nd..k..{Cx..p|
+000004d0  fe 66 66 56 82 14 ed ab  08 cd 16 03 03 00 04 0e  |.ffV............|
 000004e0  00 00 00                                          |...|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 50 1c 01  |....(........P..|
-00000040  e1 8a 32 e7 59 c3 0c b2  f0 28 e3 8c 9c 46 3e 3a  |..2.Y....(...F>:|
-00000050  fd 3e 4d 36 f7 5d c8 ed  09 94 8f f8 94           |.>M6.].......|
+00000030  16 03 03 00 20 7a 58 e1  33 d4 ce ca 57 ef ea b9  |.... zX.3...W...|
+00000040  9d f2 4d ec ce 86 4b e9  c2 b5 64 dd 0f 32 f0 66  |..M...K...d..2.f|
+00000050  65 42 74 d8 59                                    |eBt.Y|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 96 72 dd fb 38  |..........(.r..8|
-00000010  e1 ac d5 ad c2 8c 0b 04  f4 6c 3a 1d f2 66 c2 d8  |.........l:..f..|
-00000020  ae 35 c3 4c a0 9c f7 7e  ac 62 63 db 3e f2 cb a5  |.5.L...~.bc.>...|
-00000030  8a 07 ef                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 20 27 df 9b 14 a1  |.......... '....|
+00000010  cd a5 83 5b 6b 30 60 a3  ae 8d 64 56 fe 8e 87 a2  |...[k0`...dV....|
+00000020  ff 1b 54 72 c8 7c b2 85  9d 8a de                 |..Tr.|.....|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 96 4c d3  |..............L.|
-00000010  8f ea 8e d0 ba 3d b4 a7  58 ea 8a 00 ea ee 2b 5e  |.....=..X.....+^|
-00000020  03 00 00 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
-00000030  77 9d 24 94 fa 8d ce 41  84 02 13 1e 62 63 1f 14  |w.$....A....bc..|
-00000040  69 c2                                             |i.|
+00000000  17 03 03 00 16 c7 bf a9  7a 72 07 27 88 9a ec 1b  |........zr.'....|
+00000010  d3 44 f2 20 88 e4 c2 8b  61 86 5c 15 03 03 00 12  |.D. ....a.\.....|
+00000020  35 ab f5 f6 92 f9 db 23  bf f1 8e e8 65 62 cf 48  |5......#....eb.H|
+00000030  91 9d                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-X25519-ECDHE-RSA-AES-GCM b/src/crypto/tls/testdata/Client-TLSv12-X25519-ECDHE-RSA-AES-GCM
index 6ebbd893ec..90541fd16e 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-X25519-ECDHE-RSA-AES-GCM
+++ b/src/crypto/tls/testdata/Client-TLSv12-X25519-ECDHE-RSA-AES-GCM
@@ -1,19 +1,19 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 87 01 00 00  83 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 8b 01 00 00  87 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 28 c0 2f  |.............(./|
-00000030  c0 2b c0 30 c0 2c c0 27  c0 13 c0 23 c0 09 c0 14  |.+.0.,.'...#....|
-00000040  c0 0a 00 9c 00 9d 00 3c  00 2f 00 35 c0 12 00 0a  |.......<./.5....|
-00000050  00 05 c0 11 c0 07 01 00  00 32 00 05 00 05 01 00  |.........2......|
-00000060  00 00 00 00 0a 00 04 00  02 00 1d 00 0b 00 02 01  |................|
-00000070  00 00 0d 00 0e 00 0c 04  01 04 03 05 01 05 03 02  |................|
-00000080  01 02 03 ff 01 00 01 00  00 12 00 00              |............|
+00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 2c cc a8  |.............,..|
+00000030  cc a9 c0 2f c0 2b c0 30  c0 2c c0 27 c0 13 c0 23  |.../.+.0.,.'...#|
+00000040  c0 09 c0 14 c0 0a 00 9c  00 9d 00 3c 00 2f 00 35  |...........<./.5|
+00000050  c0 12 00 0a 00 05 c0 11  c0 07 01 00 00 32 00 05  |.............2..|
+00000060  00 05 01 00 00 00 00 00  0a 00 04 00 02 00 1d 00  |................|
+00000070  0b 00 02 01 00 00 0d 00  0e 00 0c 04 01 04 03 05  |................|
+00000080  01 05 03 02 01 02 03 ff  01 00 01 00 00 12 00 00  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 d3 18 c0 74 b0  |....Y...U.....t.|
-00000010  98 31 6a 21 53 a8 c8 52  07 21 ae 0d 91 2d 8f 5b  |.1j!S..R.!...-.[|
-00000020  fe 84 eb 54 73 1b 3e 83  7c e1 31 20 61 c8 ef 67  |...Ts.>.|.1 a..g|
-00000030  6a f3 0c 82 86 10 f7 12  08 23 ae 25 0f 41 b4 6e  |j........#.%.A.n|
-00000040  3e 66 8b 1d f4 44 8e 81  cc ab e6 4c c0 2f 00 00  |>f...D.....L./..|
+00000000  16 03 03 00 59 02 00 00  55 03 03 07 42 b0 44 05  |....Y...U...B.D.|
+00000010  b1 6d 3c f0 60 fe 6a f2  1f 8f 1d 88 de 4b 6a 1b  |.m<.`.j......Kj.|
+00000020  4f 72 60 4d 42 a5 f7 77  eb 86 c2 20 99 35 47 07  |Or`MB..w... .5G.|
+00000030  64 60 32 52 2e 1d 54 d5  b7 e2 26 85 72 c1 ec 8d  |d`2R..T...&.r...|
+00000040  fb 59 86 91 46 7d ad 16  bd b7 38 94 c0 2f 00 00  |.Y..F}....8../..|
 00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
 00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
 00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
@@ -53,33 +53,33 @@
 00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
 000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
 000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 a8 2b 29 68 72 39 78  |........ .+)hr9x|
-000002d0  8f 28 f5 3a fb f9 79 db  cc 52 87 67 2e f9 ee fc  |.(.:..y..R.g....|
-000002e0  bb 40 b7 f5 e4 5f 65 6d  08 04 01 00 80 3b 83 43  |.@..._em.....;.C|
-000002f0  0f 0f 05 1b 50 c7 07 eb  73 23 30 68 ce eb 02 49  |....P...s#0h...I|
-00000300  08 4b 06 b9 05 1f ba 3f  fd 51 a5 55 10 d4 8d fa  |.K.....?.Q.U....|
-00000310  b1 6b 4b b7 46 e4 e5 59  d9 3d fc 50 4c 86 d0 0d  |.kK.F..Y.=.PL...|
-00000320  cd dd c9 cf 86 f8 38 ef  3f 70 27 ea fc 82 ba b9  |......8.?p'.....|
-00000330  c1 36 82 0c ec a8 a5 32  97 f3 64 b5 04 01 36 21  |.6.....2..d...6!|
-00000340  69 4b a4 26 5e 28 e2 06  40 84 48 08 38 a5 0d 87  |iK.&^(..@.H.8...|
-00000350  c2 a5 7b a1 f7 bc 5a 0e  f8 50 9a a5 c5 d9 57 f2  |..{...Z..P....W.|
-00000360  71 71 d6 ec 3f 48 fe 90  ff 88 91 9b 24 16 03 03  |qq..?H......$...|
+000002c0  ac 0c 00 00 a8 03 00 1d  20 cc f6 2e 98 6c e0 8b  |........ ....l..|
+000002d0  15 17 63 6f 97 5e 37 6a  a7 3c 4b f2 d4 91 e0 87  |..co.^7j.<K.....|
+000002e0  53 1d d3 9e f3 43 a9 21  40 04 01 00 80 3c 35 db  |S....C.!@....<5.|
+000002f0  b1 ef 58 96 b4 3f eb 6b  d5 0d b7 ab cd 51 8d 57  |..X..?.k.....Q.W|
+00000300  2b fe 3a 7f 72 42 a0 a7  7d 1d db c1 6c cd df de  |+.:.rB..}...l...|
+00000310  7f 98 69 b0 0b c1 56 07  34 51 79 dc 1a 52 d1 11  |..i...V.4Qy..R..|
+00000320  ea b4 dd 0f 9d 9a 8c a3  4f 23 da 0e aa dc 2a e1  |........O#....*.|
+00000330  16 51 a4 33 e2 4f f8 34  2d b0 ba f5 f5 ed 3e 24  |.Q.3.O.4-.....>$|
+00000340  04 f0 b9 ab 81 b8 4e 39  88 8f b7 46 2c 60 b8 5c  |......N9...F,`.\|
+00000350  6f 4d d4 5d 7a 04 f7 1d  82 98 a2 b1 f9 7e f0 1f  |oM.]z........~..|
+00000360  cf a5 e5 28 25 d4 3d b0  32 ea eb 21 c6 16 03 03  |...(%.=.2..!....|
 00000370  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 13 06 e2  |....(...........|
-00000040  11 1b 5b d1 a9 96 26 eb  3e db 2f c4 ed d7 55 fc  |..[...&.>./...U.|
-00000050  c3 51 16 be 82 ec d9 97  74 8f c6 bd 74           |.Q......t...t|
+00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 75 70 c8  |....(........up.|
+00000040  c5 ef ae 60 b5 8d ba 98  1a 7d 8d c3 e4 32 fc 33  |...`.....}...2.3|
+00000050  5e 15 cc e2 d7 5d d5 76  52 1a fe ac 1e           |^....].vR....|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 e5 77 89 4c b3  |..........(.w.L.|
-00000010  94 20 9b e8 49 07 a6 6d  b1 e9 8f 5e 3c d9 7a db  |. ..I..m...^<.z.|
-00000020  f1 8b 1a f1 92 25 3f 3d  87 db 89 37 37 c0 9c 8d  |.....%?=...77...|
-00000030  29 ee 2a                                          |).*|
+00000000  14 03 03 00 01 01 16 03  03 00 28 7f 2b fe 0d 9f  |..........(.+...|
+00000010  93 07 fd ee 48 76 09 fb  8d 4c dd 7b b5 b5 26 36  |....Hv...L.{..&6|
+00000020  3e 05 e1 1b a7 dc 0b 4a  c0 69 a8 22 33 0b 17 fc  |>......J.i."3...|
+00000030  6f ab b8                                          |o..|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 39 86 ce  |.............9..|
-00000010  b1 3e a5 42 81 e0 73 0f  bc 95 eb 8b 35 58 ca f7  |.>.B..s.....5X..|
-00000020  4c 1e 87 15 03 03 00 1a  00 00 00 00 00 00 00 02  |L...............|
-00000030  0f 02 2a 17 15 2a 53 27  7d 7a d1 29 25 b0 8d 61  |..*..*S'}z.)%..a|
-00000040  9f 68                                             |.h|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 49 61 5c  |.............Ia\|
+00000010  db f2 e5 63 23 3a f1 dd  12 3e 61 ed d9 4b 5f b5  |...c#:...>a..K_.|
+00000020  d3 f7 38 15 03 03 00 1a  00 00 00 00 00 00 00 02  |..8.............|
+00000030  af 09 a7 f1 e1 d9 1f 54  d1 35 19 16 b7 23 ce 4e  |.......T.5...#.N|
+00000040  3a b1                                             |:.|
diff --git a/src/crypto/tls/testdata/Server-SSLv3-RSA-3DES b/src/crypto/tls/testdata/Server-SSLv3-RSA-3DES
index ec9162b3a9..11a8a1c8cb 100644
--- a/src/crypto/tls/testdata/Server-SSLv3-RSA-3DES
+++ b/src/crypto/tls/testdata/Server-SSLv3-RSA-3DES
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 00 00 2f 01 00 00  2b 03 00 07 be 0a 0c 3a  |..../...+......:|
-00000010  70 ad 1a 60 e2 e4 63 91  1b 93 c8 ef 10 95 24 5e  |p..`..c.......$^|
-00000020  95 e9 f7 82 2c 42 4f 74  44 90 3b 00 00 04 00 0a  |....,BOtD.;.....|
+00000000  16 03 00 00 2f 01 00 00  2b 03 00 47 b4 bd 36 64  |..../...+..G..6d|
+00000010  0a 7d 37 1d 99 ac fd 1c  7a 3f d5 0f 9d 90 e3 59  |.}7.....z?.....Y|
+00000020  64 e4 fb 59 3a 4a 5f 53  d2 af 88 00 00 04 00 0a  |d..Y:J_S........|
 00000030  00 ff 01 00                                       |....|
 >>> Flow 2 (server to client)
 00000000  16 03 00 00 31 02 00 00  2d 03 00 00 00 00 00 00  |....1...-.......|
@@ -47,30 +47,30 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 00 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 00 00 84 10 00 00  80 0b 53 ae 4b 24 12 d9  |..........S.K$..|
-00000010  66 2e f6 3f 3b f4 4f 75  0d 0f a2 40 3f db 8c 04  |f..?;.Ou...@?...|
-00000020  db 31 d4 12 3b 72 26 1e  70 4a bc ec 40 97 40 9c  |.1..;r&.pJ..@.@.|
-00000030  44 2d 11 ac ae 47 47 bb  46 bb 0a 47 bc e5 d7 3b  |D-...GG.F..G...;|
-00000040  b4 a3 df c7 cf 60 46 94  e7 5d 7d 00 49 b8 1e 5a  |.....`F..]}.I..Z|
-00000050  e9 71 e0 80 ff d8 d6 bb  22 8a 1a f8 1c a8 83 06  |.q......".......|
-00000060  12 bc e1 1e 2d fa 14 6f  7b 0f fb 85 ad b7 3d 5c  |....-..o{.....=\|
-00000070  b3 9e 83 05 05 d8 e9 ae  bc 82 29 ab 95 78 72 5a  |..........)..xrZ|
-00000080  a3 12 71 ff a4 ba e0 c5  56 14 03 00 00 01 01 16  |..q.....V.......|
-00000090  03 00 00 40 f0 85 00 68  b5 a7 cb d1 2f 52 c4 a2  |...@...h..../R..|
-000000a0  ab a1 41 64 21 b8 d3 e4  97 fb 08 a4 86 8e 59 94  |..Ad!.........Y.|
-000000b0  3e 24 e6 b9 4d 4f 3a ac  e6 91 dd 82 59 e8 7d ca  |>$..MO:.....Y.}.|
-000000c0  bc d0 e8 85 08 14 f9 05  2e fc e5 a3 bc 9c 88 65  |...............e|
-000000d0  93 b8 be 25                                       |...%|
+00000000  16 03 00 00 84 10 00 00  80 43 4d 76 6b 7f b3 e6  |.........CMvk...|
+00000010  82 18 f9 8a a5 cd 45 ab  8f 1a 1d d4 9a 0a 1d 50  |......E........P|
+00000020  96 f2 08 14 a7 6b e3 ef  d1 31 6b 18 d2 f5 ee e3  |.....k...1k.....|
+00000030  cd df 67 23 3d ec 70 09  07 df 32 c2 cd 60 6c 2b  |..g#=.p...2..`l+|
+00000040  7f 04 cd b3 77 87 78 e5  90 60 41 0c fc 22 1a 3a  |....w.x..`A..".:|
+00000050  82 29 28 92 9c f8 33 3a  72 ee 08 58 55 d5 ea 9c  |.)(...3:r..XU...|
+00000060  37 96 a4 92 75 e0 29 8a  18 ad 5a c1 1f 4c aa c7  |7...u.)...Z..L..|
+00000070  49 89 6e ff 29 32 a3 c8  51 e8 50 3f 41 10 36 27  |I.n.)2..Q.P?A.6'|
+00000080  0b 60 a2 96 4b 82 a9 c6  52 14 03 00 00 01 01 16  |.`..K...R.......|
+00000090  03 00 00 40 b3 59 d0 de  d1 47 8e 9e 1a 27 16 41  |...@.Y...G...'.A|
+000000a0  f7 38 4e 91 12 a0 71 89  1c 68 29 dc 60 7e 2c 39  |.8N...q..h).`~,9|
+000000b0  45 cb e6 98 8d 43 5e 76  34 ca 5b 86 24 9d 77 0a  |E....C^v4.[.$.w.|
+000000c0  90 60 19 75 67 74 3d 95  1d e7 82 ee a8 9f 3a 60  |.`.ugt=.......:`|
+000000d0  8e ac 28 74                                       |..(t|
 >>> Flow 4 (server to client)
-00000000  14 03 00 00 01 01 16 03  00 00 40 46 58 3a 0e 47  |..........@FX:.G|
-00000010  b9 be 1e af b5 3d 61 34  d0 8d 0b 41 b7 de 3c 04  |.....=a4...A..<.|
-00000020  24 4f 50 c0 ba 64 1f c8  b0 3e 4e cb e7 56 bb fc  |$OP..d...>N..V..|
-00000030  d9 ff 18 88 85 1e 40 cd  d0 c9 ed d2 49 af 16 14  |......@.....I...|
-00000040  35 d5 0b b2 ce 68 bf b0  52 2c 70 17 03 00 00 18  |5....h..R,p.....|
-00000050  14 44 b1 72 b9 f4 cc eb  4f 53 88 c8 89 26 d3 02  |.D.r....OS...&..|
-00000060  65 66 6e e5 d2 0c 67 98  17 03 00 00 28 fb d9 98  |efn...g.....(...|
-00000070  8d 59 96 5e 1b 4c 28 88  42 83 f3 58 ed 5a fe 05  |.Y.^.L(.B..X.Z..|
-00000080  77 6d 64 49 54 c8 1a 57  ac f9 14 15 61 ea d2 29  |wmdIT..W....a..)|
-00000090  e4 1c 91 46 f7 15 03 00  00 18 a4 f2 67 43 7b e9  |...F........gC{.|
-000000a0  99 35 05 f4 5e 6f a1 36  c3 06 2b 0b d0 75 dc 98  |.5..^o.6..+..u..|
-000000b0  59 ad                                             |Y.|
+00000000  14 03 00 00 01 01 16 03  00 00 40 e8 3e 89 b5 10  |..........@.>...|
+00000010  e4 c9 eb f7 3f 83 e5 6a  7c 04 fd e6 96 69 25 fb  |....?..j|....i%.|
+00000020  0b 0b 0e f7 13 4e 99 45  d2 0e 13 22 6b d1 0e 32  |.....N.E..."k..2|
+00000030  30 b5 c4 a2 03 cf 22 59  68 5c cc 63 96 f5 01 f3  |0....."Yh\.c....|
+00000040  2c b3 b5 13 e1 9d 19 45  c0 4f 28 17 03 00 00 18  |,......E.O(.....|
+00000050  2e cb 8c b3 d4 d5 c2 18  fd 6e dc 72 7b b3 4b b8  |.........n.r{.K.|
+00000060  10 56 0a 01 af 55 e8 5a  17 03 00 00 28 3f df 74  |.V...U.Z....(?.t|
+00000070  2f b9 5b a4 43 ec 24 68  ad ff 6c 52 b5 6a 91 0c  |/.[.C.$h..lR.j..|
+00000080  be 3b 25 c9 e4 40 59 66  17 cb f0 e7 6b 6e cd 43  |.;%..@Yf....kn.C|
+00000090  ac be b7 62 d0 15 03 00  00 18 43 4d 3c fd 83 6e  |...b......CM<..n|
+000000a0  e0 3f ae 40 0c 8a a1 08  d2 74 e2 60 7b d0 97 d5  |.?.@.....t.`{...|
+000000b0  e8 a5                                             |..|
diff --git a/src/crypto/tls/testdata/Server-SSLv3-RSA-AES b/src/crypto/tls/testdata/Server-SSLv3-RSA-AES
index 6bdd75e900..771373c27f 100644
--- a/src/crypto/tls/testdata/Server-SSLv3-RSA-AES
+++ b/src/crypto/tls/testdata/Server-SSLv3-RSA-AES
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 00 00 2f 01 00 00  2b 03 00 86 5f 7b c1 4d  |..../...+..._{.M|
-00000010  b6 d6 fb 10 1e bd 5c 89  a3 d8 f3 e4 e3 ad 49 86  |......\.......I.|
-00000020  be a8 f1 5a fc 48 7d b7  43 89 0d 00 00 04 00 2f  |...Z.H}.C....../|
+00000000  16 03 00 00 2f 01 00 00  2b 03 00 26 1e 06 cd 27  |..../...+..&...'|
+00000010  f5 2a b4 8d 00 07 47 16  02 23 aa 5e 92 02 95 4a  |.*....G..#.^...J|
+00000020  1a 0b a8 51 8a 6f 4a 31  3c e9 a2 00 00 04 00 2f  |...Q.oJ1<....../|
 00000030  00 ff 01 00                                       |....|
 >>> Flow 2 (server to client)
 00000000  16 03 00 00 31 02 00 00  2d 03 00 00 00 00 00 00  |....1...-.......|
@@ -47,31 +47,31 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 00 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 00 00 84 10 00 00  80 62 b2 02 df a7 af 20  |.........b..... |
-00000010  cb 59 b7 1b 70 26 00 18  2c c8 14 25 fb 3d f2 ec  |.Y..p&..,..%.=..|
-00000020  b0 52 83 c6 7c 1f dd 60  64 32 98 aa 5a 4f 48 df  |.R..|..`d2..ZOH.|
-00000030  14 f5 c3 6c dd 50 ac 14  27 f4 c9 08 e2 c7 e4 0d  |...l.P..'.......|
-00000040  ae 31 61 dd 39 03 f5 b4  92 d1 c7 67 a9 cf d0 d5  |.1a.9......g....|
-00000050  1a 00 9a 6a aa 16 d5 c3  16 1d 38 20 67 93 41 92  |...j......8 g.A.|
-00000060  14 41 26 6d 7f 2e 25 92  4d ac bd 1a e6 d3 91 33  |.A&m..%.M......3|
-00000070  c9 9b d2 0c 1f d2 2c 36  0f 2b b0 e8 15 1f 1a 5b  |......,6.+.....[|
-00000080  f4 00 7f db e9 01 e0 85  c9 14 03 00 00 01 01 16  |................|
-00000090  03 00 00 40 7b ac 74 d9  51 7c db 62 e0 60 31 89  |...@{.t.Q|.b.`1.|
-000000a0  52 cd c2 77 e7 fe fd 8e  23 43 9f 7d e4 36 5c c7  |R..w....#C.}.6\.|
-000000b0  2c 41 27 09 59 48 1e 93  7b 8b 03 18 6c ce 6c 72  |,A'.YH..{...l.lr|
-000000c0  9a 0e 5b 87 7b 97 76 b6  ce b8 2e 98 19 e7 04 a9  |..[.{.v.........|
-000000d0  cd 8e 9a f9                                       |....|
+00000000  16 03 00 00 84 10 00 00  80 66 67 59 2f 21 b9 e3  |.........fgY/!..|
+00000010  0d a9 78 0c 6b fc dc 6f  69 4e f9 00 8b 40 a2 0f  |..x.k..oiN...@..|
+00000020  5a d8 8c d2 59 ab 33 78  f6 42 2f fa cf d6 48 7a  |Z...Y.3x.B/...Hz|
+00000030  59 30 94 1c 10 49 30 69  4a 6c a2 e5 ce 59 6d e3  |Y0...I0iJl...Ym.|
+00000040  49 0c a7 0a ab 17 8b c6  48 82 71 44 d5 7d 80 e5  |I.......H.qD.}..|
+00000050  6d 45 6c 10 12 01 85 71  ee dc c5 e3 19 41 ed 22  |mEl....q.....A."|
+00000060  11 5c c4 25 c6 90 ad c8  4c 48 45 8d ad 6c f4 ef  |.\.%....LHE..l..|
+00000070  fb b4 2b 53 90 cc 78 b0  9e 22 e7 2c 1a 64 0e 8b  |..+S..x..".,.d..|
+00000080  d8 57 54 74 c5 33 20 3f  42 14 03 00 00 01 01 16  |.WTt.3 ?B.......|
+00000090  03 00 00 40 18 b6 0a d4  9e 4d fa 8a 67 ce 8e d5  |...@.....M..g...|
+000000a0  51 31 75 65 f1 ff 54 a2  1b 80 c5 c3 a0 fc d2 78  |Q1ue..T........x|
+000000b0  0b 99 3b 65 6c 1d 52 6d  a9 9f 64 13 97 d5 2e b1  |..;el.Rm..d.....|
+000000c0  76 0b a0 fb f6 16 f7 72  28 a5 8a 11 a7 46 d5 59  |v......r(....F.Y|
+000000d0  e1 f4 f3 6f                                       |...o|
 >>> Flow 4 (server to client)
-00000000  14 03 00 00 01 01 16 03  00 00 40 3b 7c 65 fa a4  |..........@;|e..|
-00000010  dc 7a 8d ba 59 23 b7 44  e8 c8 01 95 60 19 9a a1  |.z..Y#.D....`...|
-00000020  6e 33 c8 0a 06 f2 9c ae  d7 f4 f7 99 2e 33 92 de  |n3...........3..|
-00000030  0d 81 13 8f 82 f3 2b 71  fa c5 97 9d 64 a0 b3 f5  |......+q....d...|
-00000040  c6 f2 4b dd 1a 8c c6 49  61 e0 cf 17 03 00 00 20  |..K....Ia...... |
-00000050  e6 0e 8a 0d 1d 87 bb 07  5e dc ed 48 c8 99 c3 87  |........^..H....|
-00000060  55 d4 51 c9 c7 a8 47 57  e5 0c 8b 93 01 8a 46 46  |U.Q...GW......FF|
-00000070  17 03 00 00 30 55 56 66  a2 9e e1 43 91 06 38 fa  |....0UVf...C..8.|
-00000080  81 bf 0a d1 68 8d 0d 80  a9 ee 7d 90 f4 15 2f e6  |....h.....}.../.|
-00000090  cb 11 3b 63 91 54 b6 7d  62 5d 79 57 1d 3b b7 d1  |..;c.T.}b]yW.;..|
-000000a0  71 75 63 5c f8 15 03 00  00 20 fc 44 3a bc 00 d9  |quc\..... .D:...|
-000000b0  7e ed c6 ad 77 27 98 af  4b 1a 84 d5 90 6c 7e 2e  |~...w'..K....l~.|
-000000c0  c3 d8 b9 a4 74 77 65 08  72 b0                    |....twe.r.|
+00000000  14 03 00 00 01 01 16 03  00 00 40 6c 5b 64 b5 f9  |..........@l[d..|
+00000010  76 cc 7e 51 72 46 ab 21  17 b3 fb 2b 48 c5 5a 9f  |v.~QrF.!...+H.Z.|
+00000020  e6 35 14 ff df c7 a7 4b  5e 5a 9b 82 57 b5 bf 4d  |.5.....K^Z..W..M|
+00000030  5f 7c a5 be 67 96 71 3a  63 ad 76 86 66 06 e9 a2  |_|..g.q:c.v.f...|
+00000040  35 39 6f 79 13 21 4b 19  c1 83 0e 17 03 00 00 20  |59oy.!K........ |
+00000050  1a 80 c5 d1 8b 33 79 89  39 fc 11 44 80 33 1a f7  |.....3y.9..D.3..|
+00000060  9f 63 96 5d c9 1a d4 56  2a ee 68 24 68 83 5d ca  |.c.]...V*.h$h.].|
+00000070  17 03 00 00 30 7c d4 88  17 d0 10 66 6a b3 61 ed  |....0|.....fj.a.|
+00000080  0a b5 72 55 ca fb c4 ec  e2 f2 e2 bf 67 dd 3d c9  |..rU........g.=.|
+00000090  01 3b 50 5c 35 ce 28 2d  e6 9c 1f 5c 70 14 46 2a  |.;P\5.(-...\p.F*|
+000000a0  d8 9e ef 6a 66 15 03 00  00 20 c7 af e1 86 10 30  |...jf.... .....0|
+000000b0  41 73 88 b2 86 02 a8 60  38 61 92 32 11 22 2d 47  |As.....`8a.2."-G|
+000000c0  76 fe 22 9c 76 c2 00 ee  e9 03                    |v.".v.....|
diff --git a/src/crypto/tls/testdata/Server-SSLv3-RSA-RC4 b/src/crypto/tls/testdata/Server-SSLv3-RSA-RC4
index 7da1078c3d..f5674ccd67 100644
--- a/src/crypto/tls/testdata/Server-SSLv3-RSA-RC4
+++ b/src/crypto/tls/testdata/Server-SSLv3-RSA-RC4
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 00 00 2f 01 00 00  2b 03 00 8d 0b 00 b4 a0  |..../...+.......|
-00000010  73 70 84 0e b0 5c 82 9f  5c 36 ed 55 c4 a7 cd 4b  |sp...\..\6.U...K|
-00000020  93 cc 06 59 9a fb 2a 6e  4d 7f 17 00 00 04 00 05  |...Y..*nM.......|
+00000000  16 03 00 00 2f 01 00 00  2b 03 00 3f cc 8d 3f f0  |..../...+..?..?.|
+00000010  c9 36 6f 43 43 c1 46 45  cd bf e5 ba 02 e6 55 2c  |.6oCC.FE......U,|
+00000020  3a 24 4a db cb a8 f2 1d  26 3e ef 00 00 04 00 05  |:$J.....&>......|
 00000030  00 ff 01 00                                       |....|
 >>> Flow 2 (server to client)
 00000000  16 03 00 00 31 02 00 00  2d 03 00 00 00 00 00 00  |....1...-.......|
@@ -47,26 +47,26 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 00 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 00 00 84 10 00 00  80 a0 a5 4c 14 f2 56 43  |...........L..VC|
-00000010  59 5b c2 80 ef 64 48 99  ba 56 85 c1 63 70 a4 01  |Y[...dH..V..cp..|
-00000020  cc 23 b6 86 b6 1a 70 1d  1a 04 24 8b 7e 6c a9 23  |.#....p...$.~l.#|
-00000030  ac 9e f4 a7 ab 2e bc 25  0c f7 e0 98 c2 e9 d2 31  |.......%.......1|
-00000040  6a b0 cd bd c4 c7 da b3  7c b7 0f 8c d7 e6 08 b3  |j.......|.......|
-00000050  76 c9 cc 3b 19 dc 07 23  2c 2b 0d 2c bc 09 cc 3a  |v..;...#,+.,...:|
-00000060  c4 eb 12 55 69 fd b9 8f  de 5a f5 a1 4b bc 20 c5  |...Ui....Z..K. .|
-00000070  cc 42 93 e9 59 f3 9c a6  cd b4 20 78 3a f3 96 83  |.B..Y..... x:...|
-00000080  73 4a 55 38 0f d4 92 ae  a1 14 03 00 00 01 01 16  |sJU8............|
-00000090  03 00 00 3c 7a 24 99 d4  14 cd df c2 f3 ad 09 59  |...<z$.........Y|
-000000a0  79 bf d7 dd 2b 59 97 24  61 79 02 0f d9 21 65 1c  |y...+Y.$ay...!e.|
-000000b0  f0 b3 8c 24 ba 05 42 56  9b 54 45 5a a9 b4 d5 a4  |...$..BV.TEZ....|
-000000c0  ab 9e 69 73 90 ed 39 99  35 c5 97 20 5f 1d 29 82  |..is..9.5.. _.).|
+00000000  16 03 00 00 84 10 00 00  80 13 5d 75 f0 6d 24 54  |..........]u.m$T|
+00000010  f5 a1 f0 13 86 61 ce ea  66 86 06 eb c8 27 78 9f  |.....a..f....'x.|
+00000020  10 0d ef 94 3f 1b fb 8c  11 14 67 2a 0e 2a 1b cf  |....?.....g*.*..|
+00000030  ae 5a cb ac b8 b2 ea a8  70 85 ee fd 88 a9 61 a4  |.Z......p.....a.|
+00000040  75 66 86 a5 88 96 a0 0d  6f 77 fe 63 5e 88 60 4d  |uf......ow.c^.`M|
+00000050  f6 b7 93 28 99 72 e8 60  ed 64 9a 3f e6 12 ea ee  |...(.r.`.d.?....|
+00000060  83 58 d4 0c 19 e0 2b ce  b0 b4 fa 73 9f 78 d9 09  |.X....+....s.x..|
+00000070  8c 17 b8 f5 04 e1 de c4  fe a9 1a aa ba 0d be f3  |................|
+00000080  c8 e1 e4 e8 cc 39 4c f0  b9 14 03 00 00 01 01 16  |.....9L.........|
+00000090  03 00 00 3c 1b 70 07 7f  ad 8f a7 78 fd e8 eb b2  |...<.p.....x....|
+000000a0  9a 54 86 a2 dd bc fa b6  0a 52 48 24 79 6a 04 f6  |.T.......RH$yj..|
+000000b0  28 80 1f b7 b1 c6 4e 07  a3 52 60 5a 5a 81 14 11  |(.....N..R`ZZ...|
+000000c0  d2 ee 33 71 e7 d3 ba 3e  4b 31 81 f2 f0 49 ee e4  |..3q...>K1...I..|
 >>> Flow 4 (server to client)
-00000000  14 03 00 00 01 01 16 03  00 00 3c 72 f5 ba 83 22  |..........<r..."|
-00000010  28 2a 24 93 43 ee 18 a5  8c 5f c6 a9 c0 01 2d 30  |(*$.C...._....-0|
-00000020  95 6f 37 5f 5d df 59 b1  da 6f 0f e0 d8 64 3b 65  |.o7_].Y..o...d;e|
-00000030  91 2e 08 06 1b de ff bc  b3 d5 d1 2c 6c 30 7c d4  |...........,l0|.|
-00000040  4b 4e e7 e5 d6 d8 43 17  03 00 00 21 ad 6d a8 a9  |KN....C....!.m..|
-00000050  4b b7 2e 7a 51 84 2d 07  b3 a5 de 5d 7f 7b ac 97  |K..zQ.-....].{..|
-00000060  81 8f 54 35 78 f8 09 fa  2e 90 fa b3 5f 15 03 00  |..T5x......._...|
-00000070  00 16 0c f0 98 1c c0 0b  84 86 74 e3 73 a0 7d 0e  |..........t.s.}.|
-00000080  6e 8a 36 b1 3b 31 12 34                           |n.6.;1.4|
+00000000  14 03 00 00 01 01 16 03  00 00 3c 47 20 7c b9 0d  |..........<G |..|
+00000010  f8 59 c0 79 25 ae 8a f3  f5 7d 0c f5 62 d4 a5 5b  |.Y.y%....}..b..[|
+00000020  f6 08 36 cc 99 21 ac 80  04 48 49 2c 04 7c 87 08  |..6..!...HI,.|..|
+00000030  d3 10 43 a9 6a ec 99 96  99 0a fa cb db 95 6f fe  |..C.j.........o.|
+00000040  b1 75 77 1e b7 a9 9d 17  03 00 00 21 1a 2f bc 70  |.uw........!./.p|
+00000050  2c 00 6b 55 e1 e5 81 17  1c b7 a1 11 d7 21 c1 2f  |,.kU.........!./|
+00000060  3e 95 f8 48 74 a4 97 0a  9d a2 0b bc d4 15 03 00  |>..Ht...........|
+00000070  00 16 67 0d 6d 69 53 87  92 23 21 51 72 f6 31 73  |..g.miS..#!Qr.1s|
+00000080  db bd 3c e6 f4 12 4c 69                           |..<...Li|
diff --git a/src/crypto/tls/testdata/Server-TLSv10-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Server-TLSv10-ECDHE-ECDSA-AES
index fc00682a6c..3e170818a0 100644
--- a/src/crypto/tls/testdata/Server-TLSv10-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Server-TLSv10-ECDHE-ECDSA-AES
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 4f 01 00 00  4b 03 01 fe 61 b4 5d ae  |....O...K...a.].|
-00000010  19 2f b0 b6 45 79 41 a6  87 85 18 21 7f 67 91 4f  |./..EyA....!.g.O|
-00000020  1c 5a 8f 96 18 88 e6 15  63 8e 19 00 00 04 c0 0a  |.Z......c.......|
+00000000  16 03 01 00 4f 01 00 00  4b 03 01 f1 86 d0 c8 69  |....O...K......i|
+00000010  46 0b 0b 89 08 c0 82 c0  f7 f1 9a b6 d2 2b e1 46  |F............+.F|
+00000020  e6 e1 44 65 de 39 0a 68  a8 d5 1c 00 00 04 c0 0a  |..De.9.h........|
 00000030  00 ff 01 00 00 1e 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000040  00 0a 00 08 00 1d 00 17  00 19 00 18 00 16 00 00  |................|
 00000050  00 17 00 00                                       |....|
@@ -42,37 +42,37 @@
 00000210  0e bd 3f a3 8c 25 c1 33  13 83 0d 94 06 bb d4 37  |..?..%.3.......7|
 00000220  7a f6 ec 7a c9 86 2e dd  d7 11 69 7f 85 7c 56 de  |z..z......i..|V.|
 00000230  fb 31 78 2b e4 c7 78 0d  ae cb be 9e 4e 36 24 31  |.1x+..x.....N6$1|
-00000240  7b 6a 0f 39 95 12 07 8f  2a 16 03 01 00 b4 0c 00  |{j.9....*.......|
-00000250  00 b0 03 00 1d 20 2f e5  7d a3 47 cd 62 43 15 28  |..... /.}.G.bC.(|
+00000240  7b 6a 0f 39 95 12 07 8f  2a 16 03 01 00 b5 0c 00  |{j.9....*.......|
+00000250  00 b1 03 00 1d 20 2f e5  7d a3 47 cd 62 43 15 28  |..... /.}.G.bC.(|
 00000260  da ac 5f bb 29 07 30 ff  f6 84 af c4 cf c2 ed 90  |.._.).0.........|
-00000270  99 5f 58 cb 3b 74 00 8a  30 81 87 02 42 00 9b 23  |._X.;t..0...B..#|
-00000280  b7 7f 16 df 0f 3e c0 51  b0 97 7f 75 54 e7 3f a8  |.....>.Q...uT.?.|
-00000290  f6 c4 64 ca 69 ad 3b 56  7f 58 c2 94 b3 b2 5c ee  |..d.i.;V.X....\.|
-000002a0  66 ea f7 bc f6 0d 06 02  94 08 e0 d6 99 03 3c da  |f.............<.|
-000002b0  80 80 34 46 52 8b 9a c6  31 61 6f 4e a0 1c a6 02  |..4FR...1aoN....|
-000002c0  41 79 ba 2e d2 48 85 b5  bc b4 08 bd be 11 d8 62  |Ay...H.........b|
-000002d0  cd 06 22 f2 a6 49 e7 14  9b 79 56 c1 29 26 de 7e  |.."..I...yV.)&.~|
-000002e0  1f 41 a3 a3 1d 0f 67 90  0b da 20 dc e6 04 18 f2  |.A....g... .....|
-000002f0  fb f0 4f 30 ed e5 97 90  37 01 f4 8a 86 ed 5f 40  |..O0....7....._@|
-00000300  fe ba 16 03 01 00 04 0e  00 00 00                 |...........|
+00000270  99 5f 58 cb 3b 74 00 8b  30 81 88 02 42 00 ad 93  |._X.;t..0...B...|
+00000280  e2 c2 3d 7e 95 63 17 5d  45 cf cd 27 af d2 db b3  |..=~.c.]E..'....|
+00000290  d0 bc 13 1e 6f 0a 61 3a  fb 3c b3 03 61 2c 36 ae  |....o.a:.<..a,6.|
+000002a0  4f be 27 e9 43 3c cf 57  9b 82 5e 7d 54 36 ed 7e  |O.'.C<.W..^}T6.~|
+000002b0  0b 34 68 26 90 00 20 02  0f c1 18 bc 79 1b 90 02  |.4h&.. .....y...|
+000002c0  42 01 6b 66 9d 56 48 8e  5e 38 93 48 03 6b b9 d7  |B.kf.VH.^8.H.k..|
+000002d0  bd 14 a0 3e 8a 27 81 7f  fe 4d e5 8a 12 4d 95 16  |...>.'...M...M..|
+000002e0  ef c7 8d 60 07 1d 22 f8  5d 72 0d cc be c3 51 69  |...`..".]r....Qi|
+000002f0  7a 04 e3 84 e5 ba dd 04  1d d4 4c 6f 9f 6b 12 e0  |z.........Lo.k..|
+00000300  2f 83 3c 16 03 01 00 04  0e 00 00 00              |/.<.........|
 >>> Flow 3 (client to server)
-00000000  16 03 01 00 25 10 00 00  21 20 74 53 a0 24 31 0e  |....%...! tS.$1.|
-00000010  24 0f be da 29 8c 2c a2  50 c4 f1 bc 96 36 4c b2  |$...).,.P....6L.|
-00000020  be 4e f3 71 e2 9f 00 e5  d1 2d 14 03 01 00 01 01  |.N.q.....-......|
-00000030  16 03 01 00 30 cc 38 0f  1e 21 0e e7 19 f0 6f 45  |....0.8..!....oE|
-00000040  44 c3 d4 3c 18 16 c5 b3  0f 30 71 c2 92 db 0e 29  |D..<.....0q....)|
-00000050  e5 07 0c 59 7a c6 94 da  8d 83 47 5b af 57 7f 20  |...Yz.....G[.W. |
-00000060  bb 74 cc 67 03                                    |.t.g.|
+00000000  16 03 01 00 25 10 00 00  21 20 18 40 ea d1 e1 17  |....%...! .@....|
+00000010  b6 a2 a5 db 20 13 70 81  90 fc ac e8 96 7c b1 e1  |.... .p......|..|
+00000020  ff 6f 57 1f c1 64 72 94  f7 05 14 03 01 00 01 01  |.oW..dr.........|
+00000030  16 03 01 00 30 05 33 48  f0 2a 3a df df 1d c4 3d  |....0.3H.*:....=|
+00000040  87 ea 9d 04 04 eb 84 bf  a0 ed bc 56 2f ab 36 52  |...........V/.6R|
+00000050  d5 b2 2c 6f 8c 58 49 51  33 d5 fc df 5d 09 df e9  |..,o.XIQ3...]...|
+00000060  be 20 30 9a 37                                    |. 0.7|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 03 83 0b c1 bb  |..........0.....|
-00000010  69 43 63 46 48 8d 18 e2  d7 8d 0d 8b 69 d7 98 a8  |iCcFH.......i...|
-00000020  eb 11 94 5a 37 70 ef 4c  74 28 1d d0 9e 19 b7 4f  |...Z7p.Lt(.....O|
-00000030  2e 01 7d a4 e2 22 12 89  26 64 3a 17 03 01 00 20  |..}.."..&d:.... |
-00000040  d3 a1 47 e6 96 87 67 f0  44 a9 0b 6b 58 c8 00 6a  |..G...g.D..kX..j|
-00000050  74 76 58 82 3a 70 b9 37  b1 ce 6a 0a 19 8c 22 64  |tvX.:p.7..j..."d|
-00000060  17 03 01 00 30 c4 c9 e2  83 68 ac f3 a6 4e a4 38  |....0....h...N.8|
-00000070  bb 52 3f be a7 19 89 ea  73 36 79 04 f3 d2 e0 b4  |.R?.....s6y.....|
-00000080  a6 fb 9c d8 40 a4 5a af  17 c1 c9 61 af a8 90 e5  |....@.Z....a....|
-00000090  e0 06 c4 40 4f 15 03 01  00 20 e2 08 3c 9a e3 c5  |...@O.... ..<...|
-000000a0  44 ad 0e fc 07 4d 64 80  e2 9d 82 67 8a 62 10 34  |D....Md....g.b.4|
-000000b0  7a 68 6c 15 79 76 eb a0  5f 30                    |zhl.yv.._0|
+00000000  14 03 01 00 01 01 16 03  01 00 30 8c b6 5b 83 03  |..........0..[..|
+00000010  c0 d8 83 f7 1d 24 2e ec  39 68 00 91 73 d2 5a 15  |.....$..9h..s.Z.|
+00000020  3f 83 aa e3 6d fd cc 31  58 90 e9 a9 e3 e4 78 5d  |?...m..1X.....x]|
+00000030  ce 8e b3 ba cd 71 aa a2  fd f4 7c 17 03 01 00 20  |.....q....|.... |
+00000040  62 98 34 9d 01 13 13 2d  1b 27 3a 4f 10 28 48 d6  |b.4....-.':O.(H.|
+00000050  32 8c 99 2a c8 64 14 6e  dc f5 7c 6d 16 59 45 8e  |2..*.d.n..|m.YE.|
+00000060  17 03 01 00 30 1e ed f9  40 ad 5c 5d f6 94 c9 fd  |....0...@.\]....|
+00000070  a1 ac fc 00 7b 48 9a 59  6d f5 b7 06 a4 66 25 04  |....{H.Ym....f%.|
+00000080  61 33 08 f3 66 86 21 00  fb f3 03 78 83 4c b6 c8  |a3..f.!....x.L..|
+00000090  9d 5e ea f5 7e 15 03 01  00 20 98 d8 f6 2a 79 60  |.^..~.... ...*y`|
+000000a0  8d fb c9 45 2f 27 59 17  a9 79 eb e7 b9 46 f1 57  |...E/'Y..y...F.W|
+000000b0  a6 fa ea e1 d0 23 8c 03  4f 72                    |.....#..Or|
diff --git a/src/crypto/tls/testdata/Server-TLSv10-RSA-3DES b/src/crypto/tls/testdata/Server-TLSv10-RSA-3DES
index 6001c07536..9590b0daa1 100644
--- a/src/crypto/tls/testdata/Server-TLSv10-RSA-3DES
+++ b/src/crypto/tls/testdata/Server-TLSv10-RSA-3DES
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 39 01 00 00  35 03 01 3e a7 9d c2 8e  |....9...5..>....|
-00000010  ec 45 f8 00 79 94 62 4e  3a 12 92 c1 78 c8 9e bc  |.E..y.bN:...x...|
-00000020  af a4 ff 81 1f 92 d7 74  a8 a2 34 00 00 04 00 0a  |.......t..4.....|
+00000000  16 03 01 00 39 01 00 00  35 03 01 58 71 a3 0c c4  |....9...5..Xq...|
+00000010  b6 b0 33 0a 66 3c eb c6  f4 d9 0e 99 75 d4 9e b6  |..3.f<......u...|
+00000020  03 b4 ae ae ad bc a8 ab  64 a0 27 00 00 04 00 0a  |........d.'.....|
 00000030  00 ff 01 00 00 08 00 16  00 00 00 17 00 00        |..............|
 >>> Flow 2 (server to client)
 00000000  16 03 01 00 31 02 00 00  2d 03 01 00 00 00 00 00  |....1...-.......|
@@ -47,26 +47,26 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 01 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 01 00 86 10 00 00  82 00 80 d8 ed ab 33 83  |..............3.|
-00000010  d3 ee fe 42 f2 8d 87 18  06 cd b4 b0 d0 01 b7 7d  |...B...........}|
-00000020  77 c3 86 21 6a a4 25 f6  97 9a 66 61 4f ec 9e 88  |w..!j.%...faO...|
-00000030  f1 f5 c9 7b a7 23 29 72  9e 9d 51 0f 40 08 ad b6  |...{.#)r..Q.@...|
-00000040  43 80 3a 9a 6f 83 8b 40  df 8c 38 ff b4 9b 2a 32  |C.:.o..@..8...*2|
-00000050  f6 b7 01 20 2b 2e db ed  f2 37 15 50 e0 3d 1d 89  |... +....7.P.=..|
-00000060  b9 94 d9 a8 30 2d e4 95  e1 6d 1f e7 17 cd ee 03  |....0-...m......|
-00000070  54 bb 23 d0 ce 80 66 5b  0f 85 13 ac 9b 0a 34 76  |T.#...f[......4v|
-00000080  8f 1f a1 7f ba 09 56 42  cb 26 72 14 03 01 00 01  |......VB.&r.....|
-00000090  01 16 03 01 00 28 86 ac  2e 12 8f ee b9 c8 2a c7  |.....(........*.|
-000000a0  49 2f 2b c0 15 bf d8 81  87 82 bd 24 36 54 65 c8  |I/+........$6Te.|
-000000b0  52 e7 2d 9e 78 cb a0 ab  5c 53 f0 48 61 f4        |R.-.x...\S.Ha.|
+00000000  16 03 01 00 86 10 00 00  82 00 80 ab 50 cd 04 9e  |............P...|
+00000010  db 19 e4 18 26 ff 59 41  20 02 a5 a2 20 a3 1c 44  |....&.YA ... ..D|
+00000020  02 bc 9a 1c d9 d7 5d 5b  55 fc 2a 4d 2b 03 22 b1  |......][U.*M+.".|
+00000030  de 96 10 84 6f e3 f2 22  2d 6f cb 29 07 43 a6 6e  |....o.."-o.).C.n|
+00000040  ce 23 64 f7 72 2b dc 9b  c0 6f 7f bd 8e cf e2 7f  |.#d.r+...o......|
+00000050  75 12 24 72 23 6b 26 08  69 76 17 c0 21 91 c0 7d  |u.$r#k&.iv..!..}|
+00000060  8c 8f 20 83 08 02 0d 73  27 23 91 35 5f 3f e6 56  |.. ....s'#.5_?.V|
+00000070  1d 69 d3 1d 3b 0e fa 60  86 8b 40 ad c0 48 59 60  |.i..;..`..@..HY`|
+00000080  45 eb b0 77 2c 91 94 75  fd 6a d3 14 03 01 00 01  |E..w,..u.j......|
+00000090  01 16 03 01 00 28 8b 25  c1 8f 25 32 b5 cb 74 6d  |.....(.%..%2..tm|
+000000a0  08 67 59 a3 ae ae 16 f9  fa 03 f6 54 42 f4 56 3f  |.gY........TB.V?|
+000000b0  c4 12 66 f3 1a b0 48 95  24 79 fe 41 a5 d1        |..f...H.$y.A..|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 28 56 86 55 d2 a0  |..........(V.U..|
-00000010  a9 8f 3f ad ca 38 48 66  86 86 05 64 66 17 fd 0c  |..?..8Hf...df...|
-00000020  07 99 c9 58 da 05 88 84  71 f3 c0 3d 6a 46 fb 79  |...X....q..=jF.y|
-00000030  15 7e b4 17 03 01 00 18  96 47 ec e1 0f 85 c8 5d  |.~.......G.....]|
-00000040  b2 9e cf 8a 78 41 e2 bd  95 c8 e3 eb 83 9c 10 05  |....xA..........|
-00000050  17 03 01 00 28 ee ca 01  96 ee ed 75 39 39 82 7a  |....(......u99.z|
-00000060  8d 2f 2a c4 ef a7 d7 2f  ac 03 65 e7 c8 6e 66 b2  |./*..../..e..nf.|
-00000070  13 8c a8 08 e5 f8 59 8b  54 01 96 7b 17 15 03 01  |......Y.T..{....|
-00000080  00 18 d3 37 d1 a8 e3 0d  6b fa b6 bb a5 ef fe 5e  |...7....k......^|
-00000090  3a 44 2e af 4f 02 59 49  10 97                    |:D..O.YI..|
+00000000  14 03 01 00 01 01 16 03  01 00 28 ff 69 ed 0f 20  |..........(.i.. |
+00000010  ff e1 42 78 b9 bc a8 61  48 82 08 a0 01 a5 98 91  |..Bx...aH.......|
+00000020  3e 39 d4 6d 17 38 a2 04  18 ed 90 3c f0 cf 6a 9a  |>9.m.8.....<..j.|
+00000030  ea c5 45 17 03 01 00 18  b5 76 2c 0e f1 34 51 e5  |..E......v,..4Q.|
+00000040  f5 38 d3 9f c9 c5 d5 19  35 c3 2e ec 18 df 8e c8  |.8......5.......|
+00000050  17 03 01 00 28 47 6f e9  c0 fa b3 21 ec 6c 16 e7  |....(Go....!.l..|
+00000060  71 a8 09 15 17 86 68 1c  cf fa ea 37 68 d3 33 ef  |q.....h....7h.3.|
+00000070  4a b1 95 46 5b 16 d7 95  f8 13 65 2f 93 15 03 01  |J..F[.....e/....|
+00000080  00 18 1b 0c 09 81 ff fc  6d 82 84 ab 83 98 fc 72  |........m......r|
+00000090  f5 4a a0 eb 08 96 79 01  76 26                    |.J....y.v&|
diff --git a/src/crypto/tls/testdata/Server-TLSv10-RSA-AES b/src/crypto/tls/testdata/Server-TLSv10-RSA-AES
index 3fef9e7b1b..c1750292d7 100644
--- a/src/crypto/tls/testdata/Server-TLSv10-RSA-AES
+++ b/src/crypto/tls/testdata/Server-TLSv10-RSA-AES
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 39 01 00 00  35 03 01 f1 24 4a eb 06  |....9...5...$J..|
-00000010  63 7d f7 29 75 f6 eb c7  4c 75 95 9e 7f b7 48 1a  |c}.)u...Lu....H.|
-00000020  2e 15 dd 5b 0d 5a a8 10  bd 79 21 00 00 04 00 2f  |...[.Z...y!..../|
+00000000  16 03 01 00 39 01 00 00  35 03 01 82 f3 04 d5 71  |....9...5......q|
+00000010  d8 65 69 36 46 cb 45 77  b2 ef 00 75 98 e4 16 d2  |.ei6F.Ew...u....|
+00000020  70 f7 3c 97 84 49 ef da  5d cd 64 00 00 04 00 2f  |p.<..I..].d..../|
 00000030  00 ff 01 00 00 08 00 16  00 00 00 17 00 00        |..............|
 >>> Flow 2 (server to client)
 00000000  16 03 01 00 31 02 00 00  2d 03 01 00 00 00 00 00  |....1...-.......|
@@ -47,29 +47,29 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 01 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 01 00 86 10 00 00  82 00 80 32 35 8d 1a 4c  |...........25..L|
-00000010  5e 87 88 94 63 a4 5d 44  12 b2 22 0e f0 d0 ac 99  |^...c.]D..".....|
-00000020  cb 3b 83 62 29 50 9c 4a  22 2a 14 10 d4 36 25 8c  |.;.b)P.J"*...6%.|
-00000030  ca ba ec dc c1 73 6b a0  ae c4 eb 21 42 ab 4a ee  |.....sk....!B.J.|
-00000040  6e 6d 06 32 d1 ed 97 a4  ef 8d a5 d9 10 e6 fe d0  |nm.2............|
-00000050  ed 6c b1 a4 b3 c1 26 f5  be 91 e9 97 13 46 a2 c9  |.l....&......F..|
-00000060  d0 da d7 1c f0 d3 68 d7  45 85 9f 64 ed d5 d2 71  |......h.E..d...q|
-00000070  d6 42 8a 40 db da 7b 2b  82 c5 7b 9c 26 53 fe e0  |.B.@..{+..{.&S..|
-00000080  20 6e 0c 0d d1 3c cb 28  56 6f c0 14 03 01 00 01  | n...<.(Vo......|
-00000090  01 16 03 01 00 30 44 4f  5c d8 1d ec c2 05 cd 60  |.....0DO\......`|
-000000a0  88 d6 c5 4a 67 ef 84 40  06 cc b7 42 68 73 6b 46  |...Jg..@...BhskF|
-000000b0  f9 55 29 30 b9 95 d0 cf  43 40 8f 6d ca e5 f9 6e  |.U)0....C@.m...n|
-000000c0  9b 44 44 70 dd 18                                 |.DDp..|
+00000000  16 03 01 00 86 10 00 00  82 00 80 9c a1 18 77 22  |..............w"|
+00000010  f5 a1 cf 4d cc df 27 7c  c5 7e 98 24 24 be 2f b2  |...M..'|.~.$$./.|
+00000020  1d d7 b8 2f fe 90 73 d0  fc f6 88 3c 91 a4 bc dc  |.../..s....<....|
+00000030  b9 0b 48 0d 55 e5 9f c1  8a 6c 1c 7d 4d a9 12 d5  |..H.U....l.}M...|
+00000040  87 4b 9a 77 74 3d 33 8c  c7 17 fb 32 09 df 86 f1  |.K.wt=3....2....|
+00000050  93 cc 17 f9 08 bd bc 0e  38 df 9d 82 ad cc 70 0c  |........8.....p.|
+00000060  f5 8b 8d 99 e8 5f 3e e5  a6 c7 c2 6a 67 02 90 82  |....._>....jg...|
+00000070  28 9a 72 e1 3e 77 51 10  84 29 21 09 56 36 f2 6a  |(.r.>wQ..)!.V6.j|
+00000080  1d 15 08 7b 44 41 43 59  55 8d 52 14 03 01 00 01  |...{DACYU.R.....|
+00000090  01 16 03 01 00 30 06 5b  20 42 7e 7b 1f 4b 7c 36  |.....0.[ B~{.K|6|
+000000a0  99 bb c6 b4 ea a1 19 3e  02 0c 3b 3a 38 be 80 11  |.......>..;:8...|
+000000b0  29 72 a8 12 92 ad 24 9d  bf 01 3e ef 9a f1 db 33  |)r....$...>....3|
+000000c0  3e c1 dc d2 51 b1                                 |>...Q.|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 ec 7f ed 3c 99  |..........0...<.|
-00000010  48 25 e1 0f 53 7b ef ee  41 14 7b 77 e5 c7 e9 2f  |H%..S{..A.{w.../|
-00000020  1f 2e 60 ef 30 4e 07 05  37 bb 2d 4d 46 d0 8a ed  |..`.0N..7.-MF...|
-00000030  78 1e 6e 2d ca 2e 1d 9a  50 e7 18 17 03 01 00 20  |x.n-....P...... |
-00000040  06 fd b0 35 0a a9 af be  11 92 de aa 90 64 45 fc  |...5.........dE.|
-00000050  29 ff 28 8c 4c 05 33 83  c8 0c f0 dc 6e e0 85 b3  |).(.L.3.....n...|
-00000060  17 03 01 00 30 c8 08 87  81 5c ec 60 b9 05 ca b2  |....0....\.`....|
-00000070  66 02 43 d3 f0 64 8d 07  bf 66 ac 53 ed b8 10 08  |f.C..d...f.S....|
-00000080  8a 11 92 c8 51 ab 59 e3  c4 51 ed b8 76 b5 b0 68  |....Q.Y..Q..v..h|
-00000090  e0 24 1f 3f 8a 15 03 01  00 20 6a 30 6a c0 bc 1a  |.$.?..... j0j...|
-000000a0  1a ff ef fe 40 b6 53 a4  ab b4 76 c1 c0 2b de 35  |....@.S...v..+.5|
-000000b0  04 e7 fa 8d 47 23 0c b1  d1 f4                    |....G#....|
+00000000  14 03 01 00 01 01 16 03  01 00 30 2e d5 04 91 6d  |..........0....m|
+00000010  32 12 8b 41 4a 46 2c f3  7f d4 16 0a 21 c2 ac 88  |2..AJF,.....!...|
+00000020  09 a0 b5 0d 65 4e 44 e1  92 5a ae b8 3f 61 1f 35  |....eND..Z..?a.5|
+00000030  ab 3a fe bd f8 3c 2c 42  dd 68 0f 17 03 01 00 20  |.:...<,B.h..... |
+00000040  6e d4 08 98 bf b7 18 84  ee 68 f8 17 88 c5 13 7a  |n........h.....z|
+00000050  73 e0 c6 ca 0d 21 4d 6b  44 dc 94 36 6c e4 a0 2f  |s....!MkD..6l../|
+00000060  17 03 01 00 30 a0 45 d0  88 5d 96 48 26 46 37 33  |....0.E..].H&F73|
+00000070  f6 48 f3 38 2e 38 d7 b6  ef d5 25 bf f3 1b b6 78  |.H.8.8....%....x|
+00000080  32 a7 9c fe be 55 35 f2  07 5b b7 14 87 89 80 f2  |2....U5..[......|
+00000090  cc d5 cb c8 57 15 03 01  00 20 80 2a 8e 6c b8 5a  |....W.... .*.l.Z|
+000000a0  41 b4 ae 56 ca 3f 8b a2  e1 ea a0 55 64 b5 60 44  |A..V.?.....Ud.`D|
+000000b0  8f de 33 c6 37 f7 df b5  d9 c3                    |..3.7.....|
diff --git a/src/crypto/tls/testdata/Server-TLSv10-RSA-RC4 b/src/crypto/tls/testdata/Server-TLSv10-RSA-RC4
index e381d57615..3d788c35d2 100644
--- a/src/crypto/tls/testdata/Server-TLSv10-RSA-RC4
+++ b/src/crypto/tls/testdata/Server-TLSv10-RSA-RC4
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 39 01 00 00  35 03 01 76 2e dd 69 ea  |....9...5..v..i.|
-00000010  11 7e 3f 79 af ee 09 52  ba 1e ee e4 13 bb 18 1c  |.~?y...R........|
-00000020  8e cf ae 7e c3 bf d2 c4  29 3e a4 00 00 04 00 05  |...~....)>......|
+00000000  16 03 01 00 39 01 00 00  35 03 01 71 34 00 f7 c4  |....9...5..q4...|
+00000010  e6 94 b4 ca f2 af d5 0a  82 ce d4 f6 b7 4a a7 d1  |.............J..|
+00000020  1a 88 65 b2 3c b2 6c ec  f7 eb 4a 00 00 04 00 05  |..e.<.l...J.....|
 00000030  00 ff 01 00 00 08 00 16  00 00 00 17 00 00        |..............|
 >>> Flow 2 (server to client)
 00000000  16 03 01 00 31 02 00 00  2d 03 01 00 00 00 00 00  |....1...-.......|
@@ -47,23 +47,23 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 01 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 01 00 86 10 00 00  82 00 80 64 0b 64 c6 55  |...........d.d.U|
-00000010  d3 ca 6e 45 18 52 e7 cf  60 ab b2 9f b4 3c dd 1b  |..nE.R..`....<..|
-00000020  dd 59 3d 7a 59 03 b2 7c  d5 91 a7 18 83 97 ec d9  |.Y=zY..|........|
-00000030  4e 3c db 39 f1 5d 55 ea  13 aa cb 36 5d 47 0c b7  |N<.9.]U....6]G..|
-00000040  e3 1f b7 cd ef db 51 ba  2e cb 54 47 69 f0 11 29  |......Q...TGi..)|
-00000050  90 1d d2 84 39 f7 54 62  53 1d 6b 53 43 74 62 cc  |....9.TbS.kSCtb.|
-00000060  6c 6c 4a a0 e8 da 62 9f  c3 83 fc db 6e 42 b3 cd  |llJ...b.....nB..|
-00000070  d7 0b 93 76 22 a3 ba 80  43 b4 41 ed cf 15 27 39  |...v"...C.A...'9|
-00000080  be 80 0a 6e b6 32 d8 c3  a5 a6 8c 14 03 01 00 01  |...n.2..........|
-00000090  01 16 03 01 00 24 b4 91  95 93 9c c7 dd 7b 4a 84  |.....$.......{J.|
-000000a0  9e ad aa 40 c0 c6 49 8d  0f e8 9b 44 40 4f 89 1f  |...@..I....D@O..|
-000000b0  47 bd e1 60 1a f4 83 51  1f 62                    |G..`...Q.b|
+00000000  16 03 01 00 86 10 00 00  82 00 80 a5 75 5a 20 2c  |............uZ ,|
+00000010  31 f7 61 dc 73 c7 f6 4c  06 d2 b9 c0 e8 5f cc 0c  |1.a.s..L....._..|
+00000020  51 70 0a 30 b2 8a bb 3b  4c 37 f6 d3 38 da 13 48  |Qp.0...;L7..8..H|
+00000030  90 4f fe 41 ec 53 3c fb  07 26 77 68 07 a0 fb 71  |.O.A.S<..&wh...q|
+00000040  b6 cc 3c cd b4 64 03 08  3a 76 97 6e 6c f1 b4 a9  |..<..d..:v.nl...|
+00000050  af f4 e0 ce bf 36 b9 8e  37 12 de 5b ac 24 06 63  |.....6..7..[.$.c|
+00000060  e2 fb 13 33 be 3b 8d 93  e3 10 95 29 21 b2 22 77  |...3.;.....)!."w|
+00000070  cb 95 b2 13 b3 76 47 98  13 1b a8 cc 50 47 ed 50  |.....vG.....PG.P|
+00000080  f0 cc ca 5a c6 a0 1e c9  9c 97 58 14 03 01 00 01  |...Z......X.....|
+00000090  01 16 03 01 00 24 e7 fd  a2 7e fd 6f 53 da 29 68  |.....$...~.oS.)h|
+000000a0  c3 49 2e e9 69 a1 94 b9  e4 a0 cb a2 94 14 a6 42  |.I..i..........B|
+000000b0  df 75 1e da 95 e5 60 e3  35 f1                    |.u....`.5.|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 24 e0 00 f9 63 16  |..........$...c.|
-00000010  a2 85 2e c9 6b 98 8b 84  39 42 68 1a 80 f8 ea 6f  |....k...9Bh....o|
-00000020  40 c0 bf 02 81 4a 50 cd  8f af 4a a6 6d d2 56 17  |@....JP...J.m.V.|
-00000030  03 01 00 21 61 35 98 a6  e9 61 70 2c 0f a6 61 71  |...!a5...ap,..aq|
-00000040  1c b4 29 87 e0 ee c8 26  38 b9 7b 5b 6a b2 e9 e4  |..)....&8.{[j...|
-00000050  db 77 2d 64 c8 15 03 01  00 16 59 41 cf 6f a9 0c  |.w-d......YA.o..|
-00000060  17 9d f0 d8 a5 1d 60 90  74 3e e2 c6 f7 ff fc dc  |......`.t>......|
+00000000  14 03 01 00 01 01 16 03  01 00 24 44 a6 c8 7b 5f  |..........$D..{_|
+00000010  b9 4e c2 62 2d e0 c3 9f  76 0f b3 e5 f5 07 b7 c0  |.N.b-...v.......|
+00000020  93 cd 1f 32 3c 0a 7a 83  57 4a 24 59 ac 95 f9 17  |...2<.z.WJ$Y....|
+00000030  03 01 00 21 6f 02 76 2e  70 82 a0 6c 11 ce 3c b8  |...!o.v.p..l..<.|
+00000040  dd d3 9e 2a ee ce d7 7f  63 1a 5b 35 d0 46 68 7d  |...*....c.[5.Fh}|
+00000050  21 6e 5b 64 fc 15 03 01  00 16 81 56 32 7d 51 e4  |!n[d.......V2}Q.|
+00000060  08 53 85 45 65 c3 87 ac  b0 58 70 4f 6f f7 64 4e  |.S.Ee....XpOo.dN|
diff --git a/src/crypto/tls/testdata/Server-TLSv11-FallbackSCSV b/src/crypto/tls/testdata/Server-TLSv11-FallbackSCSV
index 9130ec4cfb..209e6216cf 100644
--- a/src/crypto/tls/testdata/Server-TLSv11-FallbackSCSV
+++ b/src/crypto/tls/testdata/Server-TLSv11-FallbackSCSV
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 63 01 00 00  5f 03 02 ad a6 80 eb e2  |....c..._.......|
-00000010  84 2f 8d e0 c8 02 51 53  4a c7 3f 37 91 32 52 5e  |./....QSJ.?7.2R^|
-00000020  0d dc 13 21 6f 97 70 cb  a2 a4 4c 00 00 14 c0 0a  |...!o.p...L.....|
+00000000  16 03 01 00 63 01 00 00  5f 03 02 6e 78 cc 6a ea  |....c..._..nx.j.|
+00000010  13 aa a8 20 76 7d 32 ca  c7 3f be 88 36 ae fb c3  |... v}2..?..6...|
+00000020  ca 95 35 70 54 20 3b 18  3b ba 82 00 00 14 c0 0a  |..5pT ;.;.......|
 00000030  c0 14 00 39 c0 09 c0 13  00 33 00 35 00 2f 00 ff  |...9.....3.5./..|
 00000040  56 00 01 00 00 22 00 0b  00 04 03 00 01 02 00 0a  |V...."..........|
 00000050  00 0a 00 08 00 1d 00 17  00 19 00 18 00 23 00 00  |.............#..|
diff --git a/src/crypto/tls/testdata/Server-TLSv11-RSA-RC4 b/src/crypto/tls/testdata/Server-TLSv11-RSA-RC4
index 03551924d4..18debc470c 100644
--- a/src/crypto/tls/testdata/Server-TLSv11-RSA-RC4
+++ b/src/crypto/tls/testdata/Server-TLSv11-RSA-RC4
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 39 01 00 00  35 03 02 b3 b4 1f 1a fe  |....9...5.......|
-00000010  f1 01 25 aa 2c 22 0d 6f  be 5d 46 a1 81 21 46 ad  |..%.,".o.]F..!F.|
-00000020  20 59 17 b9 81 f8 f6 1d  51 a5 86 00 00 04 00 05  | Y......Q.......|
+00000000  16 03 01 00 39 01 00 00  35 03 02 15 67 73 bf 3f  |....9...5...gs.?|
+00000010  6f 15 30 c2 34 2e c6 1b  23 3a 42 45 4d d9 87 a2  |o.0.4...#:BEM...|
+00000020  e7 b8 de 1c b8 2b cc 21  7a 0b a1 00 00 04 00 05  |.....+.!z.......|
 00000030  00 ff 01 00 00 08 00 16  00 00 00 17 00 00        |..............|
 >>> Flow 2 (server to client)
 00000000  16 03 02 00 31 02 00 00  2d 03 02 00 00 00 00 00  |....1...-.......|
@@ -47,23 +47,23 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 02 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 02 00 86 10 00 00  82 00 80 bc 7a 1c d7 e5  |............z...|
-00000010  b1 c8 4d 94 b6 92 d5 e4  4a 46 f5 ae 54 a8 c5 09  |..M.....JF..T...|
-00000020  bb 4b aa 27 73 31 fe c7  ee 98 69 ec 34 8c 29 1e  |.K.'s1....i.4.).|
-00000030  41 97 af db 17 c1 27 df  6f 1f 96 31 d0 f1 92 94  |A.....'.o..1....|
-00000040  32 b4 ce 79 79 55 1c 07  99 21 60 af dd 66 31 03  |2..yyU...!`..f1.|
-00000050  2b ac b6 83 09 77 7b 44  50 21 9c d3 c6 f7 9f 47  |+....w{DP!.....G|
-00000060  f0 88 91 16 6e 75 a9 f9  67 9a f3 a1 82 64 eb 61  |....nu..g....d.a|
-00000070  1a 01 03 e5 f8 18 12 ef  ac 51 e1 5f 2c 6d 39 dd  |.........Q._,m9.|
-00000080  97 a5 c5 0d a9 65 b3 9d  47 98 84 14 03 02 00 01  |.....e..G.......|
-00000090  01 16 03 02 00 24 eb b8  87 0c 82 ab 86 d3 83 5c  |.....$.........\|
-000000a0  e0 b6 c2 f8 44 10 2f 31  30 b3 0a b2 a7 5a c3 dd  |....D./10....Z..|
-000000b0  1d c9 92 3a cf 62 5f af  fd cb                    |...:.b_...|
+00000000  16 03 02 00 86 10 00 00  82 00 80 75 8e 85 93 be  |...........u....|
+00000010  53 df e0 4f 65 92 ed 3d  58 34 f8 06 fd 36 e4 5a  |S..Oe..=X4...6.Z|
+00000020  f7 7a 59 88 f6 ac bd de  21 ed c4 04 0d 35 19 cd  |.zY.....!....5..|
+00000030  ff 3b 9f c4 bc 93 4f 21  2a 36 a3 99 a4 6f eb 1e  |.;....O!*6...o..|
+00000040  7b b4 a8 a7 6d 69 a5 93  b6 e3 d2 2d be 7a c8 f3  |{...mi.....-.z..|
+00000050  9f 25 9e f9 51 75 d9 4f  05 41 0e 17 56 31 4e 3f  |.%..Qu.O.A..V1N?|
+00000060  c0 15 d8 c4 29 4d e5 92  f9 ed 50 b6 88 f1 41 ea  |....)M....P...A.|
+00000070  cb 5a 8c 50 12 78 16 e7  21 b6 11 ca 2c 49 cf b6  |.Z.P.x..!...,I..|
+00000080  d2 1a 16 28 f7 08 b5 c9  61 e0 18 14 03 02 00 01  |...(....a.......|
+00000090  01 16 03 02 00 24 a1 cf  1b 5d dc 4c 9c 2c d7 39  |.....$...].L.,.9|
+000000a0  af 13 e9 04 48 c0 2a aa  6f 3a 9c fb 9e 0a 25 55  |....H.*.o:....%U|
+000000b0  7e 82 3d 1b 78 d1 e3 e0  f5 30                    |~.=.x....0|
 >>> Flow 4 (server to client)
-00000000  14 03 02 00 01 01 16 03  02 00 24 e3 de 71 0b 6a  |..........$..q.j|
-00000010  77 28 4a 44 6e da 3e 94  94 e8 f3 30 a0 2d a5 16  |w(JDn.>....0.-..|
-00000020  84 02 2c 8e 8b 4f 3c 44  5d ec f0 fd de 5c b8 17  |..,..O<D]....\..|
-00000030  03 02 00 21 94 f2 b2 63  cb 04 cd 70 96 ba b9 cd  |...!...c...p....|
-00000040  84 f2 d7 48 0e a1 bf df  fc ab b1 20 f7 fb 78 a7  |...H....... ..x.|
-00000050  16 59 b1 27 8c 15 03 02  00 16 4f 4c 97 9d 52 05  |.Y.'......OL..R.|
-00000060  b8 cf 90 8a 32 ba 47 96  f6 3a 01 54 ac e6 1c 14  |....2.G..:.T....|
+00000000  14 03 02 00 01 01 16 03  02 00 24 7b 68 71 56 0f  |..........${hqV.|
+00000010  a5 46 1c 13 34 81 b5 b6  ba 29 fb 41 46 dc fe 78  |.F..4....).AF..x|
+00000020  cc 0b 2d 75 bd fe c1 55  45 b1 fc 04 28 5e b1 17  |..-u...UE...(^..|
+00000030  03 02 00 21 0b fa a9 2f  9e 82 5b 77 30 c2 27 88  |...!.../..[w0.'.|
+00000040  f5 f3 50 47 7b 62 4c 7a  d4 07 71 74 46 da 24 de  |..PG{bLz..qtF.$.|
+00000050  bf 3f 56 a7 9b 15 03 02  00 16 85 26 8a 89 33 21  |.?V........&..3!|
+00000060  36 ce 69 83 84 50 fc 8f  99 b3 43 ad 6b 14 1e b2  |6.i..P....C.k...|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ALPN b/src/crypto/tls/testdata/Server-TLSv12-ALPN
index 0c5ebc8105..3e90ebd90f 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ALPN
+++ b/src/crypto/tls/testdata/Server-TLSv12-ALPN
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 bf 01 00 00  bb 03 03 fb b9 9e 20 13  |.............. .|
-00000010  7f 9d 92 9e 7b 42 b7 ab  c6 70 c6 3b 44 00 00 e9  |....{B...p.;D...|
-00000020  32 98 5a c3 e2 be c2 a5  af 4d 96 00 00 38 c0 2c  |2.Z......M...8.,|
+00000000  16 03 01 00 bf 01 00 00  bb 03 03 18 c9 32 10 f3  |.............2..|
+00000010  be ff a8 60 c5 2a 03 cb  25 8a b3 54 8d 70 27 90  |...`.*..%..T.p'.|
+00000020  74 1e 15 3e 61 48 9b be  f0 77 1f 00 00 38 c0 2c  |t..>aH...w...8.,|
 00000030  c0 30 00 9f cc a9 cc a8  cc aa c0 2b c0 2f 00 9e  |.0.........+./..|
 00000040  c0 24 c0 28 00 6b c0 23  c0 27 00 67 c0 0a c0 14  |.$.(.k.#.'.g....|
 00000050  00 39 c0 09 c0 13 00 33  00 9d 00 9c 00 3d 00 3c  |.9.....3.....=.<|
@@ -58,37 +58,37 @@
 000002a0  d3 3b e9 fa e7 16 03 03  00 ac 0c 00 00 a8 03 00  |.;..............|
 000002b0  1d 20 2f e5 7d a3 47 cd  62 43 15 28 da ac 5f bb  |. /.}.G.bC.(.._.|
 000002c0  29 07 30 ff f6 84 af c4  cf c2 ed 90 99 5f 58 cb  |).0.........._X.|
-000002d0  3b 74 05 01 00 80 ac 76  dc d2 23 3e 4b 9c b7 8e  |;t.....v..#>K...|
-000002e0  a8 07 ea 92 f2 99 11 f9  c9 2b fb 52 e3 f7 d4 56  |.........+.R...V|
-000002f0  c1 30 8d 04 16 d5 ee a2  81 48 21 53 51 03 19 bf  |.0.......H!SQ...|
-00000300  4d 68 7e 28 40 7c 71 cf  5e 36 3d 2d 14 3e 38 26  |Mh~(@|q.^6=-.>8&|
-00000310  db ca db 07 5d 6a 42 bb  5c e2 f1 dc fb c8 46 07  |....]jB.\.....F.|
-00000320  5a b6 5f c5 32 ea 7e ca  85 08 97 97 44 cb 05 3e  |Z._.2.~.....D..>|
-00000330  61 ca 7d f0 96 6e f8 59  14 e4 42 50 52 a2 a1 10  |a.}..n.Y..BPR...|
-00000340  62 3f 56 15 f6 4e 11 c7  c9 ad 42 4e 76 37 14 d7  |b?V..N....BNv7..|
-00000350  5f fc 29 6e c4 bf 16 03  03 00 04 0e 00 00 00     |_.)n...........|
+000002d0  3b 74 05 01 00 80 2e c1  51 a1 e8 92 a6 bb ad 1e  |;t......Q.......|
+000002e0  4d f1 22 c5 e7 10 e6 31  1d 78 61 8a 22 a3 93 84  |M."....1.xa."...|
+000002f0  58 d6 5a c6 94 d0 da 6c  6a 35 d1 31 ea 1b 7e 55  |X.Z....lj5.1..~U|
+00000300  d6 35 a3 b7 42 e4 04 f8  31 15 15 88 5f 91 a8 7e  |.5..B...1..._..~|
+00000310  3e 73 52 8f 32 50 2e ad  95 44 83 b6 88 d6 18 99  |>sR.2P...D......|
+00000320  cf 86 57 97 c0 b2 a0 91  ee a7 ac f8 38 4b 1c 8e  |..W.........8K..|
+00000330  a4 58 59 4a f6 fc 88 a4  02 ed c8 04 1a 8b 7b 9e  |.XYJ..........{.|
+00000340  83 91 72 ca 1e 1c e0 76  58 73 89 3a 7d 12 c5 ef  |..r....vXs.:}...|
+00000350  f8 f7 45 dc ca c4 16 03  03 00 04 0e 00 00 00     |..E............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 5a 6f 39 fe 8e 70  |....%...! Zo9..p|
-00000010  43 68 a5 08 af ec 37 0e  5c 6f aa 63 c5 9c 3f 63  |Ch....7.\o.c..?c|
-00000020  61 f0 c5 fa 61 7f 81 1c  94 25 14 03 03 00 01 01  |a...a....%......|
-00000030  16 03 03 00 28 a5 f4 4c  fe ba ca 6b 9d 47 ba 7f  |....(..L...k.G..|
-00000040  b3 6d e1 24 25 a3 35 cb  58 7d fa 70 6e 04 07 a4  |.m.$%.5.X}.pn...|
-00000050  e4 0b 8c 98 fe e4 43 4a  f7 aa 1a 47 71           |......CJ...Gq|
+00000000  16 03 03 00 25 10 00 00  21 20 be 4e 0d d5 31 aa  |....%...! .N..1.|
+00000010  27 13 df 73 d3 8d 17 8c  b3 5f 44 61 7b 01 b6 99  |'..s....._Da{...|
+00000020  7b ba b3 5d bf d4 be 3c  87 26 14 03 03 00 01 01  |{..]...<.&......|
+00000030  16 03 03 00 28 9c 86 e0  30 d4 a5 ec 0c 9e a6 08  |....(...0.......|
+00000040  ce 8a 7a ff ef be 52 0c  56 86 62 de 49 09 a1 18  |..z...R.V.b.I...|
+00000050  aa 62 e5 e3 d3 2e 4a 24  c9 ef 44 c9 67           |.b....J$..D.g|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 82 04 00 00  7e 00 00 00 00 00 78 50  |........~.....xP|
 00000010  46 ad c1 db a8 38 86 7b  2b bb fd d0 c3 42 3e 00  |F....8.{+....B>.|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000030  6f ec 80 83 61 fd 51 ae  21 14 ec 44 ae 68 36 16  |o...a.Q.!..D.h6.|
-00000040  83 86 87 5a f7 2c f9 52  9e bd 28 87 e8 55 1c ec  |...Z.,.R..(..U..|
-00000050  f5 36 2b c2 96 88 ce 94  ae fc 5a 10 bc 3c 77 66  |.6+.......Z..<wf|
-00000060  f6 f8 d3 e9 40 33 94 30  73 2a c4 31 91 7d fe eb  |....@3.0s*.1.}..|
-00000070  7a ae 50 f1 e1 af 08 78  d5 3c fb 05 85 66 74 aa  |z.P....x.<...ft.|
-00000080  7a 35 29 07 be 08 b6 14  03 03 00 01 01 16 03 03  |z5).............|
-00000090  00 28 00 00 00 00 00 00  00 00 a1 d3 10 34 ec 89  |.(...........4..|
-000000a0  67 57 f1 f4 28 e5 9b b8  6b e1 3f 45 88 45 ca 32  |gW..(...k.?E.E.2|
-000000b0  da 79 76 48 73 c9 08 e3  2d 1e 17 03 03 00 25 00  |.yvHs...-.....%.|
-000000c0  00 00 00 00 00 00 01 1a  35 76 f5 78 3a c4 53 26  |........5v.x:.S&|
-000000d0  fc 88 a7 14 6d e8 f3 65  6b fd 91 2d 02 10 9c 58  |....m..ek..-...X|
-000000e0  0b d0 82 31 15 03 03 00  1a 00 00 00 00 00 00 00  |...1............|
-000000f0  02 10 75 b1 bb 71 c3 4e  12 d4 3f 9d 7f 15 15 c8  |..u..q.N..?.....|
-00000100  c2 25 51                                          |.%Q|
+00000030  6f ec 80 83 61 da 3d a1  df 0d 11 25 4b 66 55 09  |o...a.=....%KfU.|
+00000040  af 7a c1 82 b9 ea 2f 9f  5c f4 0a 62 15 62 c2 32  |.z..../.\..b.b.2|
+00000050  c6 37 51 5b bb 19 14 f8  73 f8 fb 82 00 ef 19 21  |.7Q[....s......!|
+00000060  e2 52 7d ab 0a 33 94 df  78 54 ba 6c 5e 94 eb 16  |.R}..3..xT.l^...|
+00000070  ad 85 01 ca d5 98 8f 8e  b7 04 7e 9a 3c 35 c0 e5  |..........~.<5..|
+00000080  8f cf 27 6d b4 12 c2 14  03 03 00 01 01 16 03 03  |..'m............|
+00000090  00 28 00 00 00 00 00 00  00 00 75 da b5 10 2e 7c  |.(........u....||
+000000a0  39 ec 3d 98 12 fb 5d 15  81 79 f3 c7 b1 e4 e0 54  |9.=...]..y.....T|
+000000b0  ed 27 6e bc c3 81 a0 74  7e 38 17 03 03 00 25 00  |.'n....t~8....%.|
+000000c0  00 00 00 00 00 00 01 bf  81 cc 93 49 4f b2 59 8b  |...........IO.Y.|
+000000d0  53 4a 61 96 04 00 4b ac  34 d5 bd 5a 94 44 18 5b  |SJa...K.4..Z.D.[|
+000000e0  7d 81 dc 05 15 03 03 00  1a 00 00 00 00 00 00 00  |}...............|
+000000f0  02 bd 32 d5 cf 4d 13 61  6a 77 8b 3e 51 b3 13 84  |..2..M.ajw.>Q...|
+00000100  e6 1a 23                                          |..#|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ALPN-NoMatch b/src/crypto/tls/testdata/Server-TLSv12-ALPN-NoMatch
index bc79effe52..d40300e839 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ALPN-NoMatch
+++ b/src/crypto/tls/testdata/Server-TLSv12-ALPN-NoMatch
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 bf 01 00 00  bb 03 03 98 e1 7f 2e 26  |...............&|
-00000010  b2 9d d5 8e 2e 48 40 fd  ec 48 ea ea 1e d6 b5 97  |.....H@..H......|
-00000020  45 30 1d 04 4b d7 08 15  38 98 69 00 00 38 c0 2c  |E0..K...8.i..8.,|
+00000000  16 03 01 00 bf 01 00 00  bb 03 03 82 57 14 fc ab  |............W...|
+00000010  56 21 ff 72 39 72 3f fe  f1 9b 0f 22 00 ff ef 44  |V!.r9r?...."...D|
+00000020  da db e0 83 d2 c0 a7 1c  fb f0 6c 00 00 38 c0 2c  |..........l..8.,|
 00000030  c0 30 00 9f cc a9 cc a8  cc aa c0 2b c0 2f 00 9e  |.0.........+./..|
 00000040  c0 24 c0 28 00 6b c0 23  c0 27 00 67 c0 0a c0 14  |.$.(.k.#.'.g....|
 00000050  00 39 c0 09 c0 13 00 33  00 9d 00 9c 00 3d 00 3c  |.9.....3.....=.<|
@@ -57,38 +57,38 @@
 00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 ac 0c 00 00  |.\!.;...........|
 000002a0  a8 03 00 1d 20 2f e5 7d  a3 47 cd 62 43 15 28 da  |.... /.}.G.bC.(.|
 000002b0  ac 5f bb 29 07 30 ff f6  84 af c4 cf c2 ed 90 99  |._.).0..........|
-000002c0  5f 58 cb 3b 74 05 01 00  80 8c af fb 3a 4e 21 31  |_X.;t.......:N!1|
-000002d0  7f 11 bb fe a1 fc b6 49  0b 62 cc c5 6b 38 9e 37  |.......I.b..k8.7|
-000002e0  a7 8f 2a 3c 55 fe 37 c6  9c d9 d9 cb ae 0d e5 78  |..*<U.7........x|
-000002f0  59 91 71 d9 e6 99 3a 9f  d1 67 5e 38 07 8c 00 04  |Y.q...:..g^8....|
-00000300  bb 28 6e 6f 94 67 39 eb  58 0a f5 d5 62 5a d2 7d  |.(no.g9.X...bZ.}|
-00000310  b7 9e 6a 18 dc a3 1c e7  ea bf 18 f2 51 7b 69 96  |..j.........Q{i.|
-00000320  fa 9a 36 92 c7 6b 18 37  b0 9f 89 93 cb e7 1e a1  |..6..k.7........|
-00000330  6c df 77 d9 b2 a9 8a ee  c9 10 eb cf 6f 1d a8 c0  |l.w.........o...|
-00000340  51 e8 2a 4a 06 b2 dd 06  65 16 03 03 00 04 0e 00  |Q.*J....e.......|
+000002c0  5f 58 cb 3b 74 05 01 00  80 bf 6d 57 f5 0c 78 c4  |_X.;t.....mW..x.|
+000002d0  77 48 0e 60 67 7a 3a 1b  3e 9e d2 88 a4 89 07 ef  |wH.`gz:.>.......|
+000002e0  d1 45 1a 66 7e 8c ec cb  da 71 ea ec ba ed 81 9e  |.E.f~....q......|
+000002f0  21 4d 2e ba d4 8f c2 0a  67 ea 3a a1 d1 67 09 66  |!M......g.:..g.f|
+00000300  dc a8 ad 16 a2 23 2a db  4f 31 65 b1 54 13 73 d1  |.....#*.O1e.T.s.|
+00000310  f6 7b 75 d9 f1 07 19 b8  67 21 87 d2 3b cf a5 6c  |.{u.....g!..;..l|
+00000320  61 8e af ed 60 7f f2 56  9f 0d 0f 19 88 98 30 3a  |a...`..V......0:|
+00000330  61 8c 21 e7 8b 5d ab 6f  cf 93 73 33 63 cd 50 bb  |a.!..].o..s3c.P.|
+00000340  dd 0e ab 4f 6a fb a3 f9  68 16 03 03 00 04 0e 00  |...Oj...h.......|
 00000350  00 00                                             |..|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 60 e5 8f 49 20 e7  |....%...! `..I .|
-00000010  a0 88 47 cd 43 d9 b8 2e  6f e5 5e c5 8a 1c be 95  |..G.C...o.^.....|
-00000020  0e 02 f4 0b e1 c1 4a fe  97 08 14 03 03 00 01 01  |......J.........|
-00000030  16 03 03 00 28 b2 c2 69  3a b6 b5 f1 c2 b0 e8 d2  |....(..i:.......|
-00000040  e1 31 26 2d a5 a7 4d 9f  d5 66 53 b7 0b 05 b7 a5  |.1&-..M..fS.....|
-00000050  16 c5 1c 93 e8 e7 4b 62  c6 0f 28 84 aa           |......Kb..(..|
+00000000  16 03 03 00 25 10 00 00  21 20 05 0c 3b 8b 22 36  |....%...! ..;."6|
+00000010  61 79 58 28 b0 82 65 44  39 67 93 c5 2c 3b d1 40  |ayX(..eD9g..,;.@|
+00000020  88 af 9f 38 c1 fa e0 81  a0 19 14 03 03 00 01 01  |...8............|
+00000030  16 03 03 00 28 87 2e d2  c2 ce 65 6d e8 d9 da a0  |....(.....em....|
+00000040  9d dc f5 51 b0 84 88 8d  c6 a3 0a 5d 08 10 ca c6  |...Q.......]....|
+00000050  e3 83 0c 0a cb 6d ec 09  b8 9f a5 45 99           |.....m.....E.|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 82 04 00 00  7e 00 00 00 00 00 78 50  |........~.....xP|
 00000010  46 ad c1 db a8 38 86 7b  2b bb fd d0 c3 42 3e 00  |F....8.{+....B>.|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000030  6f ec 80 83 61 92 c1 74  0b f2 b3 d6 e0 f0 a6 b2  |o...a..t........|
-00000040  3d bd aa d0 86 b4 cc 3f  38 38 43 d8 a2 e6 20 0d  |=......?88C... .|
-00000050  76 9b fc e2 98 e7 68 13  77 17 d3 f2 a7 9f c0 47  |v.....h.w......G|
-00000060  39 0d 90 12 cb 33 94 d0  76 b9 ee 13 62 f8 3f 8d  |9....3..v...b.?.|
-00000070  3f 37 60 68 e7 19 e0 5c  1e 43 67 ba 00 14 86 1b  |?7`h...\.Cg.....|
-00000080  29 49 d6 c5 85 18 16 14  03 03 00 01 01 16 03 03  |)I..............|
-00000090  00 28 00 00 00 00 00 00  00 00 e1 8e a9 ec 25 a7  |.(............%.|
-000000a0  ba 5c 63 37 a8 cd 8c d2  51 32 f8 de 46 85 0a 64  |.\c7....Q2..F..d|
-000000b0  7c a3 f8 2c b0 f5 75 4a  af 03 17 03 03 00 25 00  ||..,..uJ......%.|
-000000c0  00 00 00 00 00 00 01 45  06 45 ae 60 76 ac 41 8a  |.......E.E.`v.A.|
-000000d0  d7 96 0a 98 56 a8 1b 27  20 5e c6 99 ef 26 c4 b8  |....V..' ^...&..|
-000000e0  de 14 f3 70 15 03 03 00  1a 00 00 00 00 00 00 00  |...p............|
-000000f0  02 dd 30 a5 8c f5 3a 88  4a 68 14 a7 ef 37 ce ad  |..0...:.Jh...7..|
-00000100  a7 1d 67                                          |..g|
+00000030  6f ec 80 83 61 34 53 e2  a4 e2 ff 73 4f 1b 15 8f  |o...a4S....sO...|
+00000040  3b 43 47 ac 20 c6 2d 5e  52 7a 61 6f af 40 c3 5a  |;CG. .-^Rzao.@.Z|
+00000050  cb 3f 7d 10 a9 90 ca cf  8d c4 c4 d4 a3 b8 1d 62  |.?}............b|
+00000060  7d a9 68 32 01 33 94 65  8b 67 73 aa 51 d4 08 1d  |}.h2.3.e.gs.Q...|
+00000070  ce 76 6b ef 3d e6 ce d3  42 fe 24 cf f3 82 5b 17  |.vk.=...B.$...[.|
+00000080  5c 03 e9 50 94 8e 8b 14  03 03 00 01 01 16 03 03  |\..P............|
+00000090  00 28 00 00 00 00 00 00  00 00 c2 7c e6 69 c9 ec  |.(.........|.i..|
+000000a0  b5 55 57 34 8e 86 38 e6  28 85 b0 c8 2e c8 0f a6  |.UW4..8.(.......|
+000000b0  a9 07 f4 91 47 46 dd fe  c8 57 17 03 03 00 25 00  |....GF...W....%.|
+000000c0  00 00 00 00 00 00 01 39  9a a2 da d8 3d 7f 25 0e  |.......9....=.%.|
+000000d0  83 a8 cd 57 d8 a4 7e 9f  e1 e2 fe 3f 5a ed b9 99  |...W..~....?Z...|
+000000e0  b6 4d 97 3a 15 03 03 00  1a 00 00 00 00 00 00 00  |.M.:............|
+000000f0  02 d5 2a aa 1e 7a 60 b8  79 56 c6 56 75 11 b7 4c  |..*..z`.yV.Vu..L|
+00000100  83 19 9c                                          |...|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceECDSA b/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceECDSA
index beb917f6a0..e2864070a4 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceECDSA
+++ b/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceECDSA
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 a7 01 00 00  a3 03 03 58 3e 61 87 99  |...........X>a..|
-00000010  e5 1f ec 7f 33 d0 56 2a  80 ae 0f 01 e1 51 1e 31  |....3.V*.....Q.1|
-00000020  20 be 50 b3 63 f8 de 85  6c ff 85 00 00 38 c0 2c  | .P.c...l....8.,|
+00000000  16 03 01 00 a7 01 00 00  a3 03 03 27 01 f3 21 98  |...........'..!.|
+00000010  ff 55 7f 78 32 44 b7 9d  88 6b 82 43 26 52 00 74  |.U.x2D...k.C&R.t|
+00000020  fb 05 ca be 23 1f d0 18  1f 74 c2 00 00 38 c0 2c  |....#....t...8.,|
 00000030  c0 30 00 9f cc a9 cc a8  cc aa c0 2b c0 2f 00 9e  |.0.........+./..|
 00000040  c0 24 c0 28 00 6b c0 23  c0 27 00 67 c0 0a c0 14  |.$.(.k.#.'.g....|
 00000050  00 39 c0 09 c0 13 00 33  00 9d 00 9c 00 3d 00 3c  |.9.....3.....=.<|
@@ -50,36 +50,36 @@
 00000240  7b 6a 0f 39 95 12 07 8f  2a 16 03 03 00 b7 0c 00  |{j.9....*.......|
 00000250  00 b3 03 00 1d 20 2f e5  7d a3 47 cd 62 43 15 28  |..... /.}.G.bC.(|
 00000260  da ac 5f bb 29 07 30 ff  f6 84 af c4 cf c2 ed 90  |.._.).0.........|
-00000270  99 5f 58 cb 3b 74 05 03  00 8b 30 81 88 02 42 00  |._X.;t....0...B.|
-00000280  ab 8e 88 16 6d 70 4d 1f  80 08 6f 65 38 03 d0 f1  |....mpM...oe8...|
-00000290  bb 90 17 cb e1 43 c2 8f  eb e0 0f bc 76 82 a2 a3  |.....C......v...|
-000002a0  cf 7b c7 53 96 64 a1 ef  47 e5 09 b7 de 38 03 9a  |.{.S.d..G....8..|
-000002b0  23 15 12 ea ea 16 c6 ba  00 03 a6 69 f7 4b 3e b3  |#..........i.K>.|
-000002c0  e0 02 42 01 8c 8a fa 30  9b f0 79 b8 4f c4 bd 37  |..B....0..y.O..7|
-000002d0  d4 98 5e e7 b3 a7 a4 d6  97 46 d8 3a 7e 48 cf 84  |..^......F.:~H..|
-000002e0  a6 ca aa e2 bd 09 d2 bf  ec 1a 63 8f c6 82 90 4c  |..........c....L|
-000002f0  97 ae 6b 58 62 f5 08 61  de a5 e6 0b 6a 20 5a 0f  |..kXb..a....j Z.|
-00000300  4a 62 94 f4 3b 16 03 03  00 04 0e 00 00 00        |Jb..;.........|
+00000270  99 5f 58 cb 3b 74 05 03  00 8b 30 81 88 02 42 01  |._X.;t....0...B.|
+00000280  4f 30 aa d0 4d e5 61 db  ba fc 95 15 52 ef 2a 41  |O0..M.a.....R.*A|
+00000290  b4 d6 59 ac 39 61 b6 38  08 1e 87 b3 ca 9b 49 d3  |..Y.9a.8......I.|
+000002a0  95 5a c5 29 84 cd 10 73  4a cc 09 df 1a b0 54 6d  |.Z.)...sJ.....Tm|
+000002b0  b8 61 28 80 2e ec cf 95  9d 6f c3 d9 ed 80 53 63  |.a(......o....Sc|
+000002c0  d9 02 42 00 af 71 2f 91  80 ff a1 79 82 c7 d9 79  |..B..q/....y...y|
+000002d0  fa 12 a9 88 7b 93 47 be  6a dc 80 42 17 9d 85 7a  |....{.G.j..B...z|
+000002e0  b8 1b fe 85 7f 5c 10 9c  9e 0e e1 71 a7 b0 12 02  |.....\.....q....|
+000002f0  e2 a4 79 c4 8d d8 02 09  01 9c 6f 7a 27 7c 1f f4  |..y.......oz'|..|
+00000300  38 46 59 46 94 16 03 03  00 04 0e 00 00 00        |8FYF..........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 17 87 df 7b b5 9d  |....%...! ...{..|
-00000010  bf 65 b8 f9 15 f9 aa e6  cc 1f 84 9d 62 da 04 05  |.e..........b...|
-00000020  19 d8 dc ec 99 4f 93 92  8e 63 14 03 03 00 01 01  |.....O...c......|
-00000030  16 03 03 00 40 6b 25 cd  48 fb 07 e4 cb ce 34 d2  |....@k%.H.....4.|
-00000040  b2 ea 74 03 f3 ec 96 e7  11 f5 88 b2 73 12 b5 19  |..t.........s...|
-00000050  70 b4 0b 67 c4 4e 9a b2  ad e7 fe 75 00 a3 74 1b  |p..g.N.....u..t.|
-00000060  60 50 fe 25 d7 e8 69 c0  ae 34 90 3a 6d 45 19 10  |`P.%..i..4.:mE..|
-00000070  9b 78 66 d6 f1                                    |.xf..|
+00000000  16 03 03 00 25 10 00 00  21 20 8c 80 e4 c7 bd d7  |....%...! ......|
+00000010  ea ea 42 f7 53 24 50 28  6a e9 f3 ff 4f 4a 28 22  |..B.S$P(j...OJ("|
+00000020  a2 95 09 fc f0 d9 3e fc  cc 6e 14 03 03 00 01 01  |......>..n......|
+00000030  16 03 03 00 40 79 56 60  f5 45 e7 48 9e 97 1d 49  |....@yV`.E.H...I|
+00000040  de 59 dd b0 f0 0a d2 cc  10 f0 98 3c c2 d5 67 d6  |.Y.........<..g.|
+00000050  2c 18 2b 21 ae a3 2f ea  2d 0b ff fd e6 c2 73 25  |,.+!../.-.....s%|
+00000060  1c 01 3e 94 3a cc 1d 58  6b fb 7f 85 e4 50 ec 10  |..>.:..Xk....P..|
+00000070  b9 d7 71 cb be                                    |..q..|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 1f be 2f 53 d8  |............./S.|
-00000020  61 79 10 70 69 11 04 2e  77 f5 93 e4 64 94 86 fe  |ay.pi...w...d...|
-00000030  c1 aa 33 ce 45 be 6a 73  d6 5e 55 2d 24 66 3f e0  |..3.E.js.^U-$f?.|
-00000040  5b 87 eb ff 51 f3 97 f8  5f 92 97 17 03 03 00 40  |[...Q..._......@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 83 5c 5c e3 c0  |............\\..|
+00000020  20 56 8c 92 4b 75 f0 30  bd 67 74 52 f1 af 9c 14  | V..Ku.0.gtR....|
+00000030  29 1e e4 b2 5b c0 2c e6  48 6f 94 42 7b 21 92 96  |)...[.,.Ho.B{!..|
+00000040  0a 83 ce 1c 91 36 95 8c  14 38 57 17 03 03 00 40  |.....6...8W....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  e1 b7 e7 08 53 75 8b 29  8f f0 92 35 b8 13 e1 42  |....Su.)...5...B|
-00000070  eb 19 6f 51 62 7b 1d 87  50 0b df 6b c8 cc b0 7a  |..oQb{..P..k...z|
-00000080  41 3a da 00 71 a3 d3 9f  45 a7 ff 9d ca b6 37 0e  |A:..q...E.....7.|
+00000060  73 a4 40 cf ad 86 cc 05  9e 47 5f 83 50 ae 68 d5  |s.@......G_.P.h.|
+00000070  d1 6a a9 8c ba 74 fe c0  cc 4a 1a e3 b0 14 0d 31  |.j...t...J.....1|
+00000080  9f 06 54 e3 95 3a 89 6d  34 54 0c e4 b4 34 38 21  |..T..:.m4T...48!|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 00 8e 25  7b c3 46 04 f8 80 7b c0  |.......%{.F...{.|
-000000b0  ee 1a 8c 03 6f 24 81 2f  ff 26 d5 d3 72 9d e6 c5  |....o$./.&..r...|
-000000c0  78 b0 30 c4 9a                                    |x.0..|
+000000a0  00 00 00 00 00 e6 dd b2  11 ab a7 34 61 00 d4 09  |...........4a...|
+000000b0  bc ea c1 5f c4 e2 52 60  63 96 f0 fd 44 4e f9 0e  |..._..R`c...DN..|
+000000c0  af 32 99 e4 12                                    |.2...|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceRSA b/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceRSA
index ce64b55a35..1f9fbc1abb 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceRSA
+++ b/src/crypto/tls/testdata/Server-TLSv12-CipherSuiteCertPreferenceRSA
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 a7 01 00 00  a3 03 03 1a 3d c8 bf 28  |............=..(|
-00000010  26 dd dc a9 bc 97 31 d4  9c fb 79 e6 77 82 a7 7e  |&.....1...y.w..~|
-00000020  d7 87 71 5e fb 7f fe c8  12 01 23 00 00 38 c0 2c  |..q^......#..8.,|
+00000000  16 03 01 00 a7 01 00 00  a3 03 03 1d 39 c9 33 73  |............9.3s|
+00000010  c2 b9 71 d8 66 23 63 a7  5c 9e 50 b6 3e a5 f9 bb  |..q.f#c.\.P.>...|
+00000020  34 1b 71 e1 09 4f ae d5  53 8a e8 00 00 38 c0 2c  |4.q..O..S....8.,|
 00000030  c0 30 00 9f cc a9 cc a8  cc aa c0 2b c0 2f 00 9e  |.0.........+./..|
 00000040  c0 24 c0 28 00 6b c0 23  c0 27 00 67 c0 0a c0 14  |.$.(.k.#.'.g....|
 00000050  00 39 c0 09 c0 13 00 33  00 9d 00 9c 00 3d 00 3c  |.9.....3.....=.<|
@@ -55,35 +55,35 @@
 00000290  3b e9 fa e7 16 03 03 00  ac 0c 00 00 a8 03 00 1d  |;...............|
 000002a0  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
 000002b0  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-000002c0  74 05 01 00 80 ce 89 0e  f4 4b ca f2 d0 0a ed 13  |t........K......|
-000002d0  a8 3b 0c 59 26 c2 70 65  1d ec fd 35 d3 0d 06 a1  |.;.Y&.pe...5....|
-000002e0  23 3e 8c a1 11 8b c8 87  5c 6b f9 f0 75 f6 14 61  |#>......\k..u..a|
-000002f0  16 42 77 f2 25 3f d6 67  89 06 9d 2d b0 99 b6 5e  |.Bw.%?.g...-...^|
-00000300  ad 96 03 c2 df e9 1b cf  df f3 5b 36 eb 88 48 86  |..........[6..H.|
-00000310  cc ee 31 dd 9e 9e 6d 3b  06 f4 66 26 9e 1f 32 b2  |..1...m;..f&..2.|
-00000320  10 37 43 0f 5c c2 21 e9  a9 40 3c 25 b0 81 3a 2a  |.7C.\.!..@<%..:*|
-00000330  24 b5 55 61 cb eb d8 c9  80 5b ac 19 94 79 ab 3d  |$.Ua.....[...y.=|
-00000340  f0 98 84 01 f2 16 03 03  00 04 0e 00 00 00        |..............|
+000002c0  74 05 01 00 80 06 d4 bd  e4 7b 10 77 89 d7 d4 d6  |t........{.w....|
+000002d0  4e f6 3e 46 49 db ee 5c  4e bc ee fe cb 8b a6 9b  |N.>FI..\N.......|
+000002e0  5c f6 99 fb 31 96 60 a8  23 09 f6 31 65 53 f0 6e  |\...1.`.#..1eS.n|
+000002f0  07 5c 32 f9 59 5d 8b c0  b4 74 c8 01 85 8a b7 19  |.\2.Y]...t......|
+00000300  ab 19 08 68 6a e8 2f 81  bd 04 9b 38 ab d9 27 66  |...hj./....8..'f|
+00000310  d7 a5 3f 75 9c 4f 81 5b  9e 69 10 20 2b f2 1d a2  |..?u.O.[.i. +...|
+00000320  8f fc 7f ba ee 5b 76 8b  19 3f 46 60 01 25 99 72  |.....[v..?F`.%.r|
+00000330  78 24 02 8e 28 d5 24 f1  2e 6b 70 53 75 ec e2 8d  |x$..(.$..kpSu...|
+00000340  76 ab e0 8e e8 16 03 03  00 04 0e 00 00 00        |v.............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 1c b3 c7 8a 87 21  |....%...! .....!|
-00000010  44 31 74 33 0b 51 ca 9a  7a c8 91 b4 53 23 34 39  |D1t3.Q..z...S#49|
-00000020  f0 8c 43 52 79 90 38 51  74 6c 14 03 03 00 01 01  |..CRy.8Qtl......|
-00000030  16 03 03 00 40 02 b6 4c  52 fb 2c dc 5e 5b b7 12  |....@..LR.,.^[..|
-00000040  79 e0 10 e4 11 c5 eb 19  dc 36 fd 70 17 9a 3b 24  |y........6.p..;$|
-00000050  52 38 68 3e 06 47 4f 52  1d 46 5b 4d aa 89 e5 5f  |R8h>.GOR.F[M..._|
-00000060  0f 9a b4 a4 a6 ca 5d 52  9f 4d 29 05 43 c0 68 e1  |......]R.M).C.h.|
-00000070  32 dc 67 7c 0e                                    |2.g|.|
+00000000  16 03 03 00 25 10 00 00  21 20 21 75 22 84 bc b7  |....%...! !u"...|
+00000010  82 b3 03 d2 42 ff b6 ce  76 26 88 bf 8f 72 fc dd  |....B...v&...r..|
+00000020  63 9b f1 4c 22 6d 12 cc  d3 57 14 03 03 00 01 01  |c..L"m...W......|
+00000030  16 03 03 00 40 20 2b 26  bd 60 1b 27 a1 32 cb ab  |....@ +&.`.'.2..|
+00000040  30 83 9c 47 59 7d f5 bb  d9 45 8a d9 3e 29 86 4d  |0..GY}...E..>).M|
+00000050  54 86 48 38 25 d9 b9 af  36 7c 7a f0 ae f6 b6 4e  |T.H8%...6|z....N|
+00000060  a1 76 93 91 26 f3 c9 49  b5 6d 49 cf 22 97 bf c7  |.v..&..I.mI."...|
+00000070  db 44 c8 7a e3                                    |.D.z.|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 8a 7e 9c ce 95  |............~...|
-00000020  63 33 ff 0f 64 cb ea 9a  da 0a 46 e4 84 be 78 ed  |c3..d.....F...x.|
-00000030  7a cb 2d be 49 fb 5d 37  50 02 95 7c ca 40 f7 b9  |z.-.I.]7P..|.@..|
-00000040  4d fb e7 33 96 d3 e5 f5  fe 2c 80 17 03 03 00 40  |M..3.....,.....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 43 7c 61 f2 30  |...........C|a.0|
+00000020  c6 4a c2 76 da 7d 84 c6  ed 5d ee 2e 9c 33 e4 3b  |.J.v.}...]...3.;|
+00000030  e3 a1 ea ee 44 02 4b f7  90 f6 0c 8b 45 d7 26 2e  |....D.K.....E.&.|
+00000040  4a 37 43 1d 93 44 79 e6  5d c5 8c 17 03 03 00 40  |J7C..Dy.]......@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  71 8c 9b 72 d1 a7 57 77  ec 4b bd 4c 77 b7 38 18  |q..r..Ww.K.Lw.8.|
-00000070  1f 48 9a 29 a7 bd 5a 4e  90 24 8d 9a 51 72 b4 d4  |.H.)..ZN.$..Qr..|
-00000080  40 01 df cf b8 d1 bf e0  69 de 39 ca 89 2c 0e e8  |@.......i.9..,..|
+00000060  b2 e4 62 17 e2 d4 d8 73  2b ea 77 39 78 51 1a 86  |..b....s+.w9xQ..|
+00000070  64 54 1f 36 9a cc a1 c0  d2 6d df b7 8a 2e 68 b0  |dT.6.....m....h.|
+00000080  79 9a 9f a1 15 b1 78 fa  db 2e 5a 43 0d fe 45 71  |y.....x...ZC..Eq|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 88 c0 bf  4d 33 2f 6d 34 13 15 8c  |........M3/m4...|
-000000b0  10 d4 40 6c f6 f2 3e a2  d2 d9 e9 95 53 64 4d a0  |..@l..>.....SdM.|
-000000c0  72 a6 bf 8f b1                                    |r....|
+000000a0  00 00 00 00 00 04 8c d0  bf 15 9f b4 55 22 b8 8e  |............U"..|
+000000b0  a5 a7 df ed bd b2 ab 88  71 38 bd b2 5d b4 5e 8e  |........q8..].^.|
+000000c0  54 fc e4 63 5a                                    |T..cZ|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndECDSAGiven b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndECDSAGiven
index b20f9342fb..7a950db0ac 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndECDSAGiven
+++ b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndECDSAGiven
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 5d 01 00 00  59 03 03 6e 8f fe 9e 99  |....]...Y..n....|
-00000010  2c 27 44 3b b6 f0 f9 d9  dc 9a 5c 2a 73 24 54 85  |,'D;......\*s$T.|
-00000020  71 9b 2a be 33 0c a5 64  4f 4b d4 00 00 04 00 2f  |q.*.3..dOK...../|
+00000000  16 03 01 00 5d 01 00 00  59 03 03 8e 50 ff 02 c4  |....]...Y...P...|
+00000010  3b 5e dd ee 59 d1 3a e1  db f1 30 f4 bb a7 8a 8c  |;^..Y.:...0.....|
+00000020  b2 d2 1a fd f8 a4 c9 e4  5f 41 e1 00 00 04 00 2f  |........_A...../|
 00000030  00 ff 01 00 00 2c 00 0d  00 20 00 1e 06 01 06 02  |.....,... ......|
 00000040  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
 00000050  03 02 03 03 02 01 02 02  02 03 00 16 00 00 00 17  |................|
@@ -85,40 +85,40 @@
 000001e0  be e8 91 b3 da 1a f5 5d  a3 23 f5 26 8b 45 70 8d  |.......].#.&.Ep.|
 000001f0  65 62 9b 7e 01 99 3d 18  f6 10 9a 38 61 9b 2e 57  |eb.~..=....8a..W|
 00000200  e4 fa cc b1 8a ce e2 23  a0 87 f0 e1 67 51 eb 16  |.......#....gQ..|
-00000210  03 03 00 86 10 00 00 82  00 80 01 5a 87 e9 2e 55  |...........Z...U|
-00000220  20 98 fa f9 aa 05 bb 1a  91 dc 48 df f6 df 89 c7  | .........H.....|
-00000230  a5 8e 5b 8b 22 b1 ea 7c  b3 7e 1a 17 4c 85 33 26  |..[."..|.~..L.3&|
-00000240  e3 f5 23 f7 1f 68 8c 07  92 13 c1 57 6c bc 54 b0  |..#..h.....Wl.T.|
-00000250  a5 d5 bc 98 d3 c2 1e 05  c8 e4 76 3e fc 99 bd 64  |..........v>...d|
-00000260  b6 92 86 bb c5 00 38 2e  1e 31 d2 ae ac 35 23 fa  |......8..1...5#.|
-00000270  91 0e 37 75 61 7b 95 a6  27 12 3c b2 92 9a db 36  |..7ua{..'.<....6|
-00000280  c1 74 f7 60 f9 ad 15 27  62 e2 8b 8a 98 b8 d5 80  |.t.`...'b.......|
-00000290  72 23 6d 7c f2 50 50 bd  4b 18 16 03 03 00 93 0f  |r#m|.PP.K.......|
-000002a0  00 00 8f 04 03 00 8b 30  81 88 02 42 01 54 cf 40  |.......0...B.T.@|
-000002b0  89 32 38 70 58 26 f8 fa  7c 7b 19 22 d8 17 49 73  |.28pX&..|{."..Is|
-000002c0  d3 8d 7b 33 67 cc 70 5b  62 03 6e 8f 46 6f 67 c9  |..{3g.p[b.n.Fog.|
-000002d0  be a2 ef 13 46 97 e0 7c  5b 92 2e 44 7a 13 1f bc  |....F..|[..Dz...|
-000002e0  87 e0 f3 fd 20 d7 f1 d5  a3 5e df 6a bc 9b 02 42  |.... ....^.j...B|
-000002f0  00 83 a6 28 27 3e 0c a4  1e 4e 8e 10 a0 66 8d f8  |...('>...N...f..|
-00000300  fc 5a d9 02 23 6a 27 cc  0c 71 50 0d 3e 82 8d 82  |.Z..#j'..qP.>...|
-00000310  4d e4 02 0b b0 b7 46 b6  08 9e a3 79 96 6e 5e 5a  |M.....F....y.n^Z|
-00000320  d3 8a 79 d5 6f 0f a7 31  5c 3f d5 a1 a0 88 b8 41  |..y.o..1\?.....A|
-00000330  d7 70 14 03 03 00 01 01  16 03 03 00 40 ef 8f 04  |.p..........@...|
-00000340  5a 8a 16 32 69 4c 41 de  87 4f 08 01 c1 61 2a 0c  |Z..2iLA..O...a*.|
-00000350  c4 c6 4c 52 41 71 14 d2  b4 4f 3d 70 d7 55 f2 9f  |..LRAq...O=p.U..|
-00000360  28 8b 37 7a f4 f7 de 9f  57 c5 44 b1 91 43 a3 9c  |(.7z....W.D..C..|
-00000370  5f 19 d6 6b c6 71 5f 61  a2 4d 45 c5 ff           |_..k.q_a.ME..|
+00000210  03 03 00 86 10 00 00 82  00 80 2b 80 6e 49 b8 ec  |..........+.nI..|
+00000220  12 7a 7c f3 2a d3 7e 16  a0 39 e5 77 61 7a 56 15  |.z|.*.~..9.wazV.|
+00000230  97 c6 64 63 13 cf 09 d0  1b f5 b6 78 1d cb 86 4f  |..dc.......x...O|
+00000240  14 84 c9 e6 5d 3c 6b 61  5e 46 83 7e ef 1d 74 d4  |....]<ka^F.~..t.|
+00000250  3b 8c 78 be 26 92 24 04  b4 6f 21 88 03 8d 92 a8  |;.x.&.$..o!.....|
+00000260  60 c6 08 b5 75 5d 2f 2c  71 60 5f 54 27 a0 fa 83  |`...u]/,q`_T'...|
+00000270  4d 39 1e 22 1e 1e 60 92  51 ac 2d 35 c7 cf fc 5e  |M9."..`.Q.-5...^|
+00000280  db e3 60 37 6b 4e 7c d8  04 f3 09 54 de 38 af 57  |..`7kN|....T.8.W|
+00000290  20 d0 f5 08 5a a8 6f 65  03 55 16 03 03 00 93 0f  | ...Z.oe.U......|
+000002a0  00 00 8f 04 03 00 8b 30  81 88 02 42 00 97 84 ac  |.......0...B....|
+000002b0  cf 9b df b0 3a c8 9d a6  da 8c 11 87 35 2a d7 d0  |....:.......5*..|
+000002c0  15 df e1 02 ca 85 3f 1c  a5 21 17 8c 8a 73 1b 76  |......?..!...s.v|
+000002d0  8d 0f af 26 ea b5 7f 87  a6 b6 c8 61 32 27 fc f4  |...&.......a2'..|
+000002e0  b7 c5 c3 2c 53 61 59 5a  5d 12 c6 dd 9e 54 02 42  |...,SaYZ]....T.B|
+000002f0  01 04 3f 82 bb a4 5c ea  ea c9 9c 2a 75 96 c2 88  |..?...\....*u...|
+00000300  5a ae f8 2e 29 01 cf 7b  a4 20 83 df ec c8 9d 37  |Z...)..{. .....7|
+00000310  0c 33 fb 20 73 51 47 6d  81 d0 75 b1 19 ed 02 00  |.3. sQGm..u.....|
+00000320  b8 40 67 75 b9 72 63 9c  1e e1 c9 44 93 d6 ec e7  |.@gu.rc....D....|
+00000330  16 5c 14 03 03 00 01 01  16 03 03 00 40 43 51 cf  |.\..........@CQ.|
+00000340  07 b2 de 6e 40 10 eb dd  3f 84 6a 54 a3 7f b2 48  |...n@...?.jT...H|
+00000350  b3 aa 3c d4 e7 69 32 7c  77 ba e9 0b 99 b3 c9 e8  |..<..i2|w.......|
+00000360  c5 53 29 9a 6b 82 ee 7d  5e a9 ae 63 fa a9 af 21  |.S).k..}^..c...!|
+00000370  f2 04 b1 a1 bf f1 10 4c  65 6c 49 34 a0           |.......LelI4.|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 d1 52 a9 0b 1c  |............R...|
-00000020  ba 60 c1 93 59 a0 d7 1e  95 bb 84 fe bc 76 15 1e  |.`..Y........v..|
-00000030  72 1f c0 a2 7a be a4 8c  60 f3 f3 78 81 16 26 8c  |r...z...`..x..&.|
-00000040  d7 83 e4 4f 06 ba 6c 72  7d a7 fa 17 03 03 00 40  |...O..lr}......@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 93 a2 18 a9 e2  |................|
+00000020  51 be f7 bd c0 05 64 51  0a 17 9d 58 11 d1 a6 b9  |Q.....dQ...X....|
+00000030  6d 1e 42 16 e4 bc bf 09  f2 b9 29 20 74 8a cd 8a  |m.B.......) t...|
+00000040  b6 31 04 64 fb 5b 1f 83  c3 19 78 17 03 03 00 40  |.1.d.[....x....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  7e 9c b9 e4 f1 a6 87 0c  ce d8 f0 eb 37 fc aa 57  |~...........7..W|
-00000070  5f 98 d6 b5 5e 9a 82 6c  19 80 ba 36 93 c0 67 42  |_...^..l...6..gB|
-00000080  57 88 d7 3f 66 f1 15 09  3c 40 16 bc 9f c4 8c 54  |W..?f...<@.....T|
+00000060  ee c4 d0 5d 69 37 2b fc  dc 9c f1 77 df 44 6f da  |...]i7+....w.Do.|
+00000070  4e 22 05 05 3a 6c 32 a8  6c c2 fb ce ca a7 1b 54  |N"..:l2.l......T|
+00000080  2a 25 ae cf 77 e4 47 21  33 b6 29 54 62 00 dd 30  |*%..w.G!3.)Tb..0|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 b1 fc ed  bd 8b d8 f7 1c a6 65 6a  |..............ej|
-000000b0  85 03 6b ab ee d6 df 8d  e7 69 9f a1 ac fc 4d 2e  |..k......i....M.|
-000000c0  07 a4 ec fc ec                                    |.....|
+000000a0  00 00 00 00 00 cf e1 fd  e3 5f d3 19 cd 05 70 79  |........._....py|
+000000b0  be 16 a5 26 18 f1 92 bc  73 bd 6f 4d 33 3d 6f 8a  |...&....s.oM3=o.|
+000000c0  13 51 7c 57 c7                                    |.Q|W.|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndGiven b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndGiven
index a6a7676b4b..c81acc8992 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndGiven
+++ b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndGiven
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 5d 01 00 00  59 03 03 94 e5 c5 27 21  |....]...Y.....'!|
-00000010  3f de 6d 5e 20 2f a9 54  9b db db fd 60 38 22 1e  |?.m^ /.T....`8".|
-00000020  df 4a ba e7 40 4e e5 f1  64 58 fa 00 00 04 00 2f  |.J..@N..dX...../|
+00000000  16 03 01 00 5d 01 00 00  59 03 03 f3 3a db 98 ff  |....]...Y...:...|
+00000010  29 a2 30 75 53 87 b3 5f  00 b5 9f 77 4d 88 38 ea  |).0uS.._...wM.8.|
+00000020  e9 87 f4 a4 e4 da dd 73  00 47 d1 00 00 04 00 2f  |.......s.G...../|
 00000030  00 ff 01 00 00 2c 00 0d  00 20 00 1e 06 01 06 02  |.....,... ......|
 00000040  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
 00000050  03 02 03 03 02 01 02 02  02 03 00 16 00 00 00 17  |................|
@@ -84,40 +84,40 @@
 000001d0  ac 11 b1 28 56 be 1d cd  61 62 84 09 bf d6 80 c6  |...(V...ab......|
 000001e0  45 8d 82 2c b4 d8 83 9b  db c9 22 b7 2a 12 11 7b  |E..,......".*..{|
 000001f0  fa 02 3b c1 c9 ff ea c9  9d a8 49 d3 95 d7 d5 0e  |..;.......I.....|
-00000200  e5 35 16 03 03 00 86 10  00 00 82 00 80 07 40 a1  |.5............@.|
-00000210  a4 df e2 86 a1 2b 63 f9  2b 60 e2 ee 53 2c 31 19  |.....+c.+`..S,1.|
-00000220  30 f6 ca 42 4d 16 c8 f6  7a 93 7c c9 49 b5 46 f5  |0..BM...z.|.I.F.|
-00000230  f8 fc 24 91 83 06 51 b4  96 a3 c4 29 a0 3c c4 64  |..$...Q....).<.d|
-00000240  a9 e3 28 79 88 0a b2 98  26 c7 e3 bf 36 74 cd b7  |..(y....&...6t..|
-00000250  b6 90 6c 6b 52 41 1d 0b  34 3f 28 24 fd 0a fd 53  |..lkRA..4?($...S|
-00000260  e1 ba f8 54 0f a0 01 d1  41 4b ab 2e c6 8a 6e d7  |...T....AK....n.|
-00000270  6b b5 f8 e0 8b 24 b9 d2  ce 67 58 77 95 ad c9 84  |k....$...gXw....|
-00000280  7f a3 6f bc 3c 25 aa 5d  ae b0 d8 9e ac 16 03 03  |..o.<%.]........|
-00000290  00 88 0f 00 00 84 04 01  00 80 54 6c d7 6f 08 34  |..........Tl.o.4|
-000002a0  30 5d 62 1c d2 47 c2 03  1d f3 74 36 f0 41 be 1c  |0]b..G....t6.A..|
-000002b0  b6 d6 e2 69 52 4d 05 19  1e 29 03 fa 84 69 c6 f0  |...iRM...)...i..|
-000002c0  83 2c e1 05 8f 6c 3b 6d  85 a2 5b 17 d1 65 5a 5d  |.,...l;m..[..eZ]|
-000002d0  7a 17 d1 4d b5 10 f7 a5  6d a6 22 5e 34 5c c9 eb  |z..M....m."^4\..|
-000002e0  fc 6e 82 7b fb bc aa 13  56 3e 42 d5 ea 81 25 a8  |.n.{....V>B...%.|
-000002f0  5e 1d cc f8 b3 db 88 68  1b 9d f2 b1 e8 31 07 b4  |^......h.....1..|
-00000300  4e 8f 51 ac a3 7b a8 91  20 30 21 41 c9 b6 db 91  |N.Q..{.. 0!A....|
-00000310  6c 55 e5 95 1a 59 14 82  0f 79 14 03 03 00 01 01  |lU...Y...y......|
-00000320  16 03 03 00 40 5d 23 b8  61 24 07 ff 4c 52 c5 41  |....@]#.a$..LR.A|
-00000330  f2 5c 67 c1 bc 98 82 15  d2 f0 9c fb c8 bc ad df  |.\g.............|
-00000340  20 c0 3f dd 14 68 ec b9  e3 b4 1b 75 8b 90 90 75  | .?..h.....u...u|
-00000350  e6 46 5b 53 76 d4 53 98  d2 e5 13 fa a8 74 18 74  |.F[Sv.S......t.t|
-00000360  ef dd a5 02 2d                                    |....-|
+00000200  e5 35 16 03 03 00 86 10  00 00 82 00 80 47 31 82  |.5...........G1.|
+00000210  ae c1 d2 74 3f a4 74 5a  57 16 ae e2 d0 46 72 53  |...t?.tZW....FrS|
+00000220  e1 5e 6a e8 e4 d5 8c 84  2b d9 82 c1 4a da 9e 1d  |.^j.....+...J...|
+00000230  a0 da 60 08 0d 35 0c 55  6d 6a 68 04 09 ee 94 39  |..`..5.Umjh....9|
+00000240  c7 a3 49 7f 2c ee 6a cf  09 01 bd 08 d3 59 0a bd  |..I.,.j......Y..|
+00000250  7f 6c d3 26 eb be 7b fd  9b 17 fd e2 6e 82 d1 c7  |.l.&..{.....n...|
+00000260  dd c3 64 8c 87 f0 41 f2  71 75 f1 0a 01 26 5b 97  |..d...A.qu...&[.|
+00000270  94 ba ac 50 df 19 32 39  80 ae 14 ea 4a d2 e5 9f  |...P..29....J...|
+00000280  5d 07 9f 2d 89 ac 83 33  40 aa 8e cc 2c 16 03 03  |]..-...3@...,...|
+00000290  00 88 0f 00 00 84 04 01  00 80 7d 37 8b 6f be e9  |..........}7.o..|
+000002a0  e7 fa 4c 28 cf 16 0d 28  40 e9 f2 9a 11 22 fc 8a  |..L(...(@...."..|
+000002b0  2c 52 f7 36 af 1a cf d7  8a f8 17 19 9f ed 9d 1d  |,R.6............|
+000002c0  43 f9 e2 fb 0f dd ca d6  1d 4c 03 4e 25 8d 5c 4c  |C........L.N%.\L|
+000002d0  95 98 02 db cf ea 44 2a  ad 36 74 e3 08 07 e3 9a  |......D*.6t.....|
+000002e0  50 6c dc 46 a1 f5 84 9b  65 7f 48 94 b5 de cc a9  |Pl.F....e.H.....|
+000002f0  cf ee 0e 31 f2 f8 6f 8f  19 4b 29 14 b4 32 1d 21  |...1..o..K)..2.!|
+00000300  02 d2 da 64 68 e8 a1 72  cc ee 64 48 d8 74 e5 64  |...dh..r..dH.t.d|
+00000310  90 b3 50 cc 3e 25 0e b1  88 53 14 03 03 00 01 01  |..P.>%...S......|
+00000320  16 03 03 00 40 6a 61 6b  3e ea 63 2c b8 26 95 e2  |....@jak>.c,.&..|
+00000330  5f 83 e3 c3 cd c3 b7 a8  0b 76 81 8a 5b 46 ff 41  |_........v..[F.A|
+00000340  c2 02 eb 21 85 31 b9 ba  2e 30 e7 6e 8d 1c 49 15  |...!.1...0.n..I.|
+00000350  af a0 a7 67 62 b7 42 8c  fa a8 04 8c 23 7a 3d 39  |...gb.B.....#z=9|
+00000360  74 18 70 2b 99                                    |t.p+.|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 8b ed 4b 14 13  |.............K..|
-00000020  c8 be 9e d4 63 ab 7e 4e  b5 61 43 a2 aa 64 a4 00  |....c.~N.aC..d..|
-00000030  b7 85 b5 67 c5 0c 85 09  c3 d5 b9 2e 70 60 59 d1  |...g........p`Y.|
-00000040  32 68 55 6a 4f 19 e8 5d  c0 06 c5 17 03 03 00 40  |2hUjO..].......@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 a6 5b 7c b0 91  |............[|..|
+00000020  53 f6 d5 e4 34 71 4f 64  2a 03 9d 75 62 d9 8d a8  |S...4qOd*..ub...|
+00000030  39 7b e1 d8 31 80 26 db  14 f3 3a 52 66 7d 12 31  |9{..1.&...:Rf}.1|
+00000040  29 14 7f a1 39 b6 1c e0  c9 55 6e 17 03 03 00 40  |)...9....Un....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  cd ae 88 cd bb 85 80 23  ac ca d5 3e 67 f7 c1 2d  |.......#...>g..-|
-00000070  0c 08 3f c6 b4 32 c8 ac  ce e8 04 4f 80 41 30 bc  |..?..2.....O.A0.|
-00000080  c2 58 7a 7e 20 e3 4a 63  96 23 70 3e 83 b2 ec 90  |.Xz~ .Jc.#p>....|
+00000060  5e 00 64 9b 25 cd 74 94  b7 65 6e 83 8e 5b 68 e8  |^.d.%.t..en..[h.|
+00000070  59 4c f0 31 8b f2 0c 59  2a ff 11 8e 43 d4 73 fd  |YL.1...Y*...C.s.|
+00000080  b3 2a 76 59 25 52 32 76  bd 2e 1d 4d 0a 53 d7 c2  |.*vY%R2v...M.S..|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 9f 18 6b  e8 4b 70 8c e6 f7 d4 bc  |.......k.Kp.....|
-000000b0  3e 65 77 94 7a 51 a0 fb  81 e1 58 94 2f 9a cf 72  |>ew.zQ....X./..r|
-000000c0  1c 22 93 c1 af                                    |."...|
+000000a0  00 00 00 00 00 23 96 6e  7d 41 bb 51 4f 40 52 07  |.....#.n}A.QO@R.|
+000000b0  90 cc 6c bd c0 bb 99 d4  8a 91 7b 8a f3 24 ef 71  |..l.......{..$.q|
+000000c0  20 d4 98 b0 14                                    | ....|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedNotGiven b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedNotGiven
index b89a57577e..091de9081e 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedNotGiven
+++ b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedNotGiven
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 5d 01 00 00  59 03 03 e9 74 a4 35 e3  |....]...Y...t.5.|
-00000010  a6 49 5f b8 ec 02 22 c1  4f de d9 a7 f9 da c4 50  |.I_...".O......P|
-00000020  00 c6 9b 77 ab 06 6d 15  2b f0 dd 00 00 04 00 2f  |...w..m.+....../|
+00000000  16 03 01 00 5d 01 00 00  59 03 03 41 24 db 27 37  |....]...Y..A$.'7|
+00000010  2e 1e a8 61 b7 7f 08 f1  83 84 fb d5 a2 96 e0 53  |...a...........S|
+00000020  1a 2b cd 8e 50 38 7b a5  64 d8 92 00 00 04 00 2f  |.+..P8{.d....../|
 00000030  00 ff 01 00 00 2c 00 0d  00 20 00 1e 06 01 06 02  |.....,... ......|
 00000040  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
 00000050  03 02 03 03 02 01 02 02  02 03 00 16 00 00 00 17  |................|
@@ -53,31 +53,31 @@
 000002b0  16 03 03 00 04 0e 00 00  00                       |.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 07 0b 00 00  03 00 00 00 16 03 03 00  |................|
-00000010  86 10 00 00 82 00 80 53  39 b1 0b b6 ea 9a 09 ca  |.......S9.......|
-00000020  9d a9 f8 c3 4a 3b 1c a1  6a ee 75 30 ce df ce 5f  |....J;..j.u0..._|
-00000030  ba 1c c6 12 c6 8d 43 5a  b1 e5 50 20 53 a3 cd db  |......CZ..P S...|
-00000040  8b d9 76 89 8f d5 62 5f  97 d6 27 26 bb f1 b8 db  |..v...b_..'&....|
-00000050  1b a0 6b 9d 2c 2c 47 d5  8e f5 1c db 7c 87 c9 0c  |..k.,,G.....|...|
-00000060  7e 15 de 73 98 93 f8 73  00 1b 0e 15 7a 0a 50 66  |~..s...s....z.Pf|
-00000070  d9 8d f9 47 19 a6 3b 7e  d9 2f 03 09 c8 c2 30 e2  |...G..;~./....0.|
-00000080  61 66 55 0b 4e 99 65 3b  ab 68 90 9c d8 7b 80 0f  |afU.N.e;.h...{..|
-00000090  24 02 f2 c6 8a 3e 90 14  03 03 00 01 01 16 03 03  |$....>..........|
-000000a0  00 40 2b a7 23 ee f4 6f  46 81 ac a2 01 8b 0f 8e  |.@+.#..oF.......|
-000000b0  5c 96 2c 9e 49 89 17 96  43 18 dc 01 f3 cd e7 d9  |\.,.I...C.......|
-000000c0  81 b4 77 b3 85 a8 ba 4d  20 e5 bd 0e 51 1e 2a 53  |..w....M ...Q.*S|
-000000d0  ea 11 61 61 52 3d 81 c8  dd e9 7c bb 4b 17 72 a2  |..aaR=....|.K.r.|
-000000e0  1b a0                                             |..|
+00000010  86 10 00 00 82 00 80 61  2e 6b ad 77 48 8d 2f 0e  |.......a.k.wH./.|
+00000020  e6 27 64 fd 95 22 72 68  80 8e 2b 0e b2 0f cc be  |.'d.."rh..+.....|
+00000030  19 31 93 1d d3 0a fb 00  da 50 26 66 17 59 6b e9  |.1.......P&f.Yk.|
+00000040  7e 16 4e 24 ba 68 0a 0c  69 2f 03 74 34 50 12 85  |~.N$.h..i/.t4P..|
+00000050  4a f0 6c 52 d4 dd 13 18  c7 a4 9d ea f0 c6 94 d9  |J.lR............|
+00000060  ae fe 19 6c 83 dd ed 38  e3 d2 21 18 e6 76 11 e7  |...l...8..!..v..|
+00000070  62 13 8b 56 65 e0 f6 61  d9 db 7c 7b 5b 57 13 3d  |b..Ve..a..|{[W.=|
+00000080  58 64 67 8d 9f 3f 6a a0  70 c5 c6 d0 db eb 17 3f  |Xdg..?j.p......?|
+00000090  6c 58 d7 c3 ba ec 4c 14  03 03 00 01 01 16 03 03  |lX....L.........|
+000000a0  00 40 6e 24 1b a4 b3 e7  d4 c2 7e cb bd 82 2d 4c  |.@n$......~...-L|
+000000b0  a8 f1 5e 81 c8 61 a6 2c  6a e3 6d 30 7f fa c7 f3  |..^..a.,j.m0....|
+000000c0  f6 b1 b1 4f 0b 23 9a fd  66 81 48 97 4b 0f 88 07  |...O.#..f.H.K...|
+000000d0  37 7b 97 b0 62 6c 2a e1  47 65 e9 f9 cd c1 79 99  |7{..bl*.Ge....y.|
+000000e0  6d 84                                             |m.|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 64 dc 26 49 ef  |...........d.&I.|
-00000020  f1 2e cc aa e4 3c 6b 23  48 f5 88 20 b3 8b 68 c5  |.....<k#H.. ..h.|
-00000030  95 6d 5a 35 36 05 88 c3  db 6a 04 92 27 c1 92 7d  |.mZ56....j..'..}|
-00000040  99 99 ff 88 90 a0 78 f2  7d 2b e9 17 03 03 00 40  |......x.}+.....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 40 c6 62 4e 26  |...........@.bN&|
+00000020  e7 32 09 ba d6 3b 71 79  8e 75 ee fb af 09 db c5  |.2...;qy.u......|
+00000030  a5 8b cd 1f 90 f3 65 86  4a b4 b1 9a e8 1e 80 f6  |......e.J.......|
+00000040  ad db bd c2 9f ec 98 42  0b 37 30 17 03 03 00 40  |.......B.70....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  1b 00 0d bd 13 a5 fb d0  52 55 c5 45 ea 3c e2 1e  |........RU.E.<..|
-00000070  9c 15 89 12 27 a1 da 13  3d 3f 8c 97 ae 62 90 cf  |....'...=?...b..|
-00000080  60 e9 5b d9 11 38 26 9d  15 7d f8 d8 20 ec a0 0b  |`.[..8&..}.. ...|
+00000060  a9 74 3c 13 87 f4 cf 77  be 07 c2 a1 e0 47 4e 52  |.t<....w.....GNR|
+00000070  c2 86 da 08 c2 93 21 80  4c 19 51 cc 0d 76 49 75  |......!.L.Q..vIu|
+00000080  0b 48 3d e0 e2 01 93 4b  f1 73 91 17 aa 00 b5 71  |.H=....K.s.....q|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 c8 e0 56  c2 b5 ed fb 73 88 d0 3c  |.......V....s..<|
-000000b0  1e 5c 36 00 74 86 0d e7  ea be fc 3d d0 51 bb 05  |.\6.t......=.Q..|
-000000c0  a5 b2 05 86 11                                    |.....|
+000000a0  00 00 00 00 00 1f 2f 2d  d7 39 06 c4 59 49 80 66  |....../-.9..YI.f|
+000000b0  6c 35 2e a7 45 ee 0a 05  4b 1e 7f 78 5d cd 24 2c  |l5..E...K..x].$,|
+000000c0  0a 3e 55 1c 7d                                    |.>U.}|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Server-TLSv12-ECDHE-ECDSA-AES
index fd2961800f..b412980e2a 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Server-TLSv12-ECDHE-ECDSA-AES
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 73 01 00 00  6f 03 03 10 0f a5 0c d4  |....s...o.......|
-00000010  33 47 41 2c 03 89 9d 67  48 36 c2 b0 16 9f fc eb  |3GA,...gH6......|
-00000020  1d e8 98 ee 77 7f c6 f3  65 ee ff 00 00 04 c0 0a  |....w...e.......|
+00000000  16 03 01 00 73 01 00 00  6f 03 03 f0 4f 82 cc 2a  |....s...o...O..*|
+00000010  27 0b 7f 2e e4 af 6d ba  4e fe 61 99 fc 0a 44 ee  |'.....m.N.a...D.|
+00000020  c0 4e 7b 3a 7c f0 6d 12  b7 7d 9e 00 00 04 c0 0a  |.N{:|.m..}......|
 00000030  00 ff 01 00 00 42 00 0b  00 04 03 00 01 02 00 0a  |.....B..........|
 00000040  00 0a 00 08 00 1d 00 17  00 19 00 18 00 0d 00 20  |............... |
 00000050  00 1e 06 01 06 02 06 03  05 01 05 02 05 03 04 01  |................|
@@ -48,35 +48,35 @@
 00000250  00 b3 03 00 1d 20 2f e5  7d a3 47 cd 62 43 15 28  |..... /.}.G.bC.(|
 00000260  da ac 5f bb 29 07 30 ff  f6 84 af c4 cf c2 ed 90  |.._.).0.........|
 00000270  99 5f 58 cb 3b 74 05 03  00 8b 30 81 88 02 42 01  |._X.;t....0...B.|
-00000280  75 a2 d9 c3 52 e6 73 3c  a4 28 1d 89 7f a3 e0 96  |u...R.s<.(......|
-00000290  b8 19 da 01 b4 3a c3 ac  13 38 58 00 00 e0 a3 13  |.....:...8X.....|
-000002a0  10 b2 d9 20 01 45 25 00  1c be ee c4 71 72 e2 b7  |... .E%.....qr..|
-000002b0  ed 00 c6 9f 59 d7 ad 4f  7b ea 15 94 93 a2 fa 16  |....Y..O{.......|
-000002c0  a2 02 42 01 c5 09 c2 bc  8a 86 9c 20 12 5e 8a 91  |..B........ .^..|
-000002d0  d6 58 45 8a 06 37 e1 99  5a 34 65 9e 59 94 a7 50  |.XE..7..Z4e.Y..P|
-000002e0  2f 38 8c 02 54 1b 29 3c  94 f3 62 4e 17 cc 8c bf  |/8..T.)<..bN....|
-000002f0  d8 dc 22 b0 a1 83 dc 5a  5d a3 16 08 83 cd ad 77  |.."....Z]......w|
-00000300  1c 4f 49 ff f2 16 03 03  00 04 0e 00 00 00        |.OI...........|
+00000280  2d d4 82 80 01 6b e6 8c  6a 2a b3 09 1b 0d 86 e6  |-....k..j*......|
+00000290  62 92 85 46 d9 e3 b2 e9  f1 5e 77 c2 27 fd 2b 68  |b..F.....^w.'.+h|
+000002a0  6a e1 3d e2 42 d2 86 96  42 b1 3b 50 7b e2 2c 34  |j.=.B...B.;P{.,4|
+000002b0  d3 e7 f6 14 89 48 eb 5c  9a 98 98 ab f3 db 85 06  |.....H.\........|
+000002c0  cb 02 42 00 df 42 94 63  a5 ff 43 a5 20 5d 83 09  |..B..B.c..C. ]..|
+000002d0  88 7d 10 ff ec 32 33 28  1d 43 b2 d2 bf 39 0c 63  |.}...23(.C...9.c|
+000002e0  9a c0 f8 0e 9f 71 a7 9a  5d 27 1a 5c f2 36 80 b3  |.....q..]'.\.6..|
+000002f0  71 0f d3 c0 fd 0d 5d 02  90 c4 9d 90 db 74 ad f6  |q.....]......t..|
+00000300  22 8f 6b 9d 55 16 03 03  00 04 0e 00 00 00        |".k.U.........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 11 07 b7 a1 ff d3  |....%...! ......|
-00000010  7c 94 4a 05 18 29 55 84  b1 c6 e0 f4 c7 9c 65 54  ||.J..)U.......eT|
-00000020  88 30 20 ac 42 b8 df 42  87 54 14 03 03 00 01 01  |.0 .B..B.T......|
-00000030  16 03 03 00 40 80 ed 21  31 50 41 aa 8d 54 33 4e  |....@..!1PA..T3N|
-00000040  3f 6b de 0e aa 9d a3 d5  76 1f ec 61 f3 58 e6 17  |?k......v..a.X..|
-00000050  fd 57 ba 66 9e e0 ca 3b  e6 a2 0b 56 15 f8 5d 79  |.W.f...;...V..]y|
-00000060  9a d2 bf 71 49 15 07 67  eb b9 bc 48 2e 57 71 fb  |...qI..g...H.Wq.|
-00000070  9f f3 9e 45 15                                    |...E.|
+00000000  16 03 03 00 25 10 00 00  21 20 af 52 73 d4 46 4d  |....%...! .Rs.FM|
+00000010  bc 0e dd 56 1f 7f 72 ce  6c 99 b9 64 53 7d 53 8d  |...V..r.l..dS}S.|
+00000020  0c a4 75 8c 83 3b 4b 76  2d 4f 14 03 03 00 01 01  |..u..;Kv-O......|
+00000030  16 03 03 00 40 a0 ef 9f  54 a8 ab 7c 5b 4a a1 b2  |....@...T..|[J..|
+00000040  5d 5b 6a d7 a7 32 35 46  58 d0 ba 38 6f 94 6e 9a  |][j..25FX..8o.n.|
+00000050  41 16 82 ed 4d 39 c4 ff  06 bf 2c 67 47 70 56 4e  |A...M9....,gGpVN|
+00000060  c5 ac 7f a0 5d d9 89 82  7a d9 36 07 55 b3 20 f4  |....]...z.6.U. .|
+00000070  b2 73 cf c3 7d                                    |.s..}|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 58 53 cf 30 2c  |...........XS.0,|
-00000020  81 b6 7f 48 49 0f 6d ae  48 db c0 6c 7e c8 63 c8  |...HI.m.H..l~.c.|
-00000030  1e 2d 6e f2 73 56 b2 74  6c 2f 44 e3 db 18 cb f4  |.-n.sV.tl/D.....|
-00000040  e8 ba 0a 33 15 f9 32 94  ec f2 61 17 03 03 00 40  |...3..2...a....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 73 5f db 9e 08  |...........s_...|
+00000020  10 38 3b c0 95 6b dd fc  16 b2 d1 db 63 13 ca d5  |.8;..k......c...|
+00000030  b5 be 5a 1d 74 b5 75 f3  a2 63 59 be a7 d0 ab 0d  |..Z.t.u..cY.....|
+00000040  d3 43 83 8a 1d 59 ed fd  ea f0 b9 17 03 03 00 40  |.C...Y.........@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  ed 19 a6 04 9c 4d 32 7e  0e 89 10 6f 3d ab 37 5d  |.....M2~...o=.7]|
-00000070  2f fc 26 fe e8 a0 e9 3a  4e 38 e4 75 82 2c 5c ea  |/.&....:N8.u.,\.|
-00000080  ae b3 a4 93 5b 52 af 68  2c 86 26 d3 2a b2 6f 88  |....[R.h,.&.*.o.|
+00000060  cf 20 4f 4f bf c4 00 05  1e ca 7f 6f 69 77 e9 52  |. OO.......oiw.R|
+00000070  14 61 02 6d f1 c0 ad 7c  1a 34 cf b2 7a 58 4a 70  |.a.m...|.4..zXJp|
+00000080  11 36 5f e9 21 62 cb eb  8f e7 11 04 bf 66 03 69  |.6_.!b.......f.i|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 59 eb 95  fa 51 b5 26 7a cd 88 ba  |.....Y...Q.&z...|
-000000b0  36 8e a2 49 08 80 6e f6  3f cd aa a0 97 c0 de 2e  |6..I..n.?.......|
-000000c0  ae 66 55 48 25                                    |.fUH%|
+000000a0  00 00 00 00 00 f5 35 92  09 6c 45 c0 27 95 98 a9  |......5..lE.'...|
+000000b0  86 56 53 1f a8 01 d5 0b  79 0e 91 15 3b 9a 07 21  |.VS.....y...;..!|
+000000c0  cb ce f0 2b 6a                                    |...+j|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-IssueTicket b/src/crypto/tls/testdata/Server-TLSv12-IssueTicket
index ecd538f40f..feced4bb8f 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-IssueTicket
+++ b/src/crypto/tls/testdata/Server-TLSv12-IssueTicket
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 61 01 00 00  5d 03 03 23 70 bb 15 df  |....a...]..#p...|
-00000010  ba a2 24 4c 6a 3f 34 0c  75 40 a6 ee 11 1c 7e 74  |..$Lj?4.u@....~t|
-00000020  7e 7f 01 51 97 c3 de 3e  d4 e0 c1 00 00 04 00 2f  |~..Q...>......./|
+00000000  16 03 01 00 61 01 00 00  5d 03 03 b1 be 1f 18 b6  |....a...].......|
+00000010  a2 5d 4f 2f a0 e5 3b c4  4a 2d 76 bd 98 92 32 85  |.]O/..;.J-v...2.|
+00000020  9d 6b 9e 10 4b fc 03 7b  fb bc e4 00 00 04 00 2f  |.k..K..{......./|
 00000030  00 ff 01 00 00 30 00 23  00 00 00 0d 00 20 00 1e  |.....0.#..... ..|
 00000040  06 01 06 02 06 03 05 01  05 02 05 03 04 01 04 02  |................|
 00000050  04 03 03 01 03 02 03 03  02 01 02 02 02 03 00 16  |................|
@@ -51,39 +51,39 @@
 00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 04 0e 00 00  |.\!.;...........|
 000002a0  00                                                |.|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 ce 22 39 8f e2  |............"9..|
-00000010  00 3a 42 d3 2c 0f 60 59  3d 7c 51 02 88 ae dd 49  |.:B.,.`Y=|Q....I|
-00000020  b2 c3 6b c4 9a 1d 97 b1  07 bc 84 70 32 95 6d 8a  |..k........p2.m.|
-00000030  2f 01 48 29 96 d1 a4 c9  e9 12 9e 31 11 d5 22 21  |/.H).......1.."!|
-00000040  86 b6 8d a1 7e 8f ad be  9e a9 7f 64 f6 b4 07 be  |....~......d....|
-00000050  f3 a0 34 af 7f 9f 73 70  16 24 2f ae f2 8a bb 51  |..4...sp.$/....Q|
-00000060  34 4a ed 1e 53 32 cb b3  b8 84 b1 0e 79 c1 5b 9e  |4J..S2......y.[.|
-00000070  6c 61 08 6f 9b dd a5 c7  b1 fb 8f ce e2 37 79 39  |la.o.........7y9|
-00000080  1c 6a 57 60 91 89 53 25  b5 9b 41 14 03 03 00 01  |.jW`..S%..A.....|
-00000090  01 16 03 03 00 40 b0 f3  19 1f 2b 96 7f 05 72 a9  |.....@....+...r.|
-000000a0  21 48 d8 77 7f d3 e0 39  e6 58 8f 8d 06 b1 bd 9e  |!H.w...9.X......|
-000000b0  53 6a cd 5b 52 a8 2f a5  7c fb 6a b4 88 f7 b2 c4  |Sj.[R./.|.j.....|
-000000c0  a7 a8 69 fe a9 ae 07 4e  4f 11 6d 51 55 0c 10 7c  |..i....NO.mQU..||
-000000d0  9c 31 a7 45 3c 0f                                 |.1.E<.|
+00000000  16 03 03 00 86 10 00 00  82 00 80 8f f0 5a 2f 01  |.............Z/.|
+00000010  99 79 e6 f2 a0 31 a4 02  d8 c0 1e 70 e8 67 58 bd  |.y...1.....p.gX.|
+00000020  a0 2a 37 3a 3c 2d 45 53  e7 d2 7d 94 16 ea 10 5c  |.*7:<-ES..}....\|
+00000030  07 91 36 87 ab f6 d1 7a  c7 40 a7 7f 23 1b ef 33  |..6....z.@..#..3|
+00000040  80 ea 7d 75 d3 62 de 7d  d2 6b cf 90 54 0f e7 02  |..}u.b.}.k..T...|
+00000050  03 85 ef 38 f4 e9 88 8f  e4 7c 8c ac 95 e6 88 f4  |...8.....|......|
+00000060  05 f7 c7 89 4a 64 de 34  5f 09 c2 84 19 36 c1 42  |....Jd.4_....6.B|
+00000070  ea 03 69 38 7e 32 10 8a  b5 cf c7 2f 8e c6 5f 29  |..i8~2...../.._)|
+00000080  4e 8a 8e d4 17 6c 9c 18  7b ea df 14 03 03 00 01  |N....l..{.......|
+00000090  01 16 03 03 00 40 5f 50  47 5a 97 52 9d 11 b5 db  |.....@_PGZ.R....|
+000000a0  ab 7b b9 e3 74 52 c5 cd  f4 73 18 cf 12 c4 fe 07  |.{..tR...s......|
+000000b0  88 5f a9 18 7a 12 23 67  ec 72 07 9f 19 b5 bf 52  |._..z.#g.r.....R|
+000000c0  2f dd 26 66 25 98 8c 5a  07 0f 26 c1 b0 38 6c 01  |/.&f%..Z..&..8l.|
+000000d0  e4 f4 ee dd b3 72                                 |.....r|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 82 04 00 00  7e 00 00 00 00 00 78 50  |........~.....xP|
 00000010  46 ad c1 db a8 38 86 7b  2b bb fd d0 c3 42 3e 00  |F....8.{+....B>.|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000030  6f 2c 9f 83 61 f0 a9 9a  d5 65 c7 25 32 9d 86 4e  |o,..a....e.%2..N|
-00000040  fb 8e 2a dd 84 8d 32 6d  6b f0 a9 de 59 fa 15 20  |..*...2mk...Y.. |
-00000050  7a 85 cd 2e 42 e1 f3 44  62 6c 24 24 e7 1f b6 fa  |z...B..Dbl$$....|
-00000060  4d 8a cd 30 83 33 94 65  b6 e2 01 d8 fb a0 37 ca  |M..0.3.e......7.|
-00000070  87 59 a4 29 cf d9 85 7c  54 2f 2d 5d 73 69 9a ae  |.Y.)...|T/-]si..|
-00000080  6f 85 29 8b c3 eb 97 14  03 03 00 01 01 16 03 03  |o.).............|
+00000030  6f 2c 9f 83 61 0b b1 b7  9e 10 2d 0c 56 e8 70 66  |o,..a.....-.V.pf|
+00000040  ad de b1 15 74 2f 8b 08  8c 96 bb 4b 1b 4e dd 81  |....t/.....K.N..|
+00000050  0e bf 84 4d 43 8f c0 7e  a0 7f be c0 59 bf 83 26  |...MC..~....Y..&|
+00000060  0f a2 22 52 2c 33 94 5a  77 54 f3 b5 f2 22 51 d5  |.."R,3.ZwT..."Q.|
+00000070  24 c2 60 c3 2e 0f 9c 5e  33 3b e8 7c 52 2a 76 08  |$.`....^3;.|R*v.|
+00000080  58 ac 47 98 bc 36 b6 14  03 03 00 01 01 16 03 03  |X.G..6..........|
 00000090  00 40 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |.@..............|
-000000a0  00 00 28 59 a1 a9 c9 27  e0 1d ff c1 18 37 83 6f  |..(Y...'.....7.o|
-000000b0  5d 48 af a3 6b 5e b0 d7  54 46 49 e8 6d be 73 74  |]H..k^..TFI.m.st|
-000000c0  fa a3 80 df 41 ce 6a 43  ee b9 ec a4 cc 24 e8 a9  |....A.jC.....$..|
-000000d0  1f 3a 17 03 03 00 40 00  00 00 00 00 00 00 00 00  |.:....@.........|
-000000e0  00 00 00 00 00 00 00 e8  7d 83 df d2 6e 2b 00 cc  |........}...n+..|
-000000f0  4b fd 3c 20 4e 84 b3 b6  31 e5 47 ab 3f 45 81 f8  |K.< N...1.G.?E..|
-00000100  d3 a9 2f 07 9a 45 5a c5  cb 8a 68 ee d9 20 78 72  |../..EZ...h.. xr|
-00000110  8c a0 be 3d 3b 46 56 15  03 03 00 30 00 00 00 00  |...=;FV....0....|
-00000120  00 00 00 00 00 00 00 00  00 00 00 00 d7 b5 17 2a  |...............*|
-00000130  14 69 7e f7 c7 9a 0c 66  56 19 d1 e3 d4 6b ef 27  |.i~....fV....k.'|
-00000140  d3 a7 ce 96 d8 2a 20 38  8a b5 50 f8              |.....* 8..P.|
+000000a0  00 00 31 fa c3 6c 95 c0  86 a5 55 30 41 c3 2d 6b  |..1..l....U0A.-k|
+000000b0  a5 00 0b af 33 63 de 80  01 3d 7a 38 8e a7 f4 b1  |....3c...=z8....|
+000000c0  2d bb e3 1d 1a b4 61 18  b5 d9 d1 7f d1 9a e7 e8  |-.....a.........|
+000000d0  49 ee 17 03 03 00 40 00  00 00 00 00 00 00 00 00  |I.....@.........|
+000000e0  00 00 00 00 00 00 00 a6  d5 e4 a8 9b d3 7d 72 1c  |.............}r.|
+000000f0  ff 14 03 68 34 c9 ca 0d  2e 80 a1 09 f7 92 f6 86  |...h4...........|
+00000100  44 22 e8 1c ea e9 dd cc  a7 92 9a 72 ec 22 5b 82  |D".........r."[.|
+00000110  7b 43 02 f7 fa 59 7b 15  03 03 00 30 00 00 00 00  |{C...Y{....0....|
+00000120  00 00 00 00 00 00 00 00  00 00 00 00 5f ab 03 1d  |............_...|
+00000130  08 72 07 6d 78 66 5b 18  ec 3a b7 ea 75 96 ce 95  |.r.mxf[..:..u...|
+00000140  0c c9 6f 86 91 14 30 d6  2e 5d b1 b4              |..o...0..]..|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable b/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable
index 0552907c21..467e332489 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable
+++ b/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 61 01 00 00  5d 03 03 f3 a0 a9 e8 90  |....a...].......|
-00000010  a2 0e bd 78 fa c2 ad 27  d4 bd 3e 07 62 de 29 a0  |...x...'..>.b.).|
-00000020  0a c3 ca f0 7a f5 1f fb  e8 8d 37 00 00 04 00 2f  |....z.....7..../|
+00000000  16 03 01 00 61 01 00 00  5d 03 03 91 2f b7 db 1e  |....a...].../...|
+00000010  41 ac c6 17 1d 0f 0c 8e  86 15 e0 de e9 c8 6b f5  |A.............k.|
+00000020  69 c7 bf ad ff 63 58 2b  b1 79 a6 00 00 04 00 2f  |i....cX+.y...../|
 00000030  00 ff 01 00 00 30 00 23  00 00 00 0d 00 20 00 1e  |.....0.#..... ..|
 00000040  06 01 06 02 06 03 05 01  05 02 05 03 04 01 04 02  |................|
 00000050  04 03 03 01 03 02 03 03  02 01 02 02 02 03 00 16  |................|
@@ -51,39 +51,39 @@
 00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 04 0e 00 00  |.\!.;...........|
 000002a0  00                                                |.|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 57 a4 71 b3 2a  |...........W.q.*|
-00000010  1a 97 ab 54 0f 92 de 70  97 6d fa e4 ac 5f eb 29  |...T...p.m..._.)|
-00000020  7a 4d 22 16 c1 29 a5 d0  13 dd 05 87 e9 b2 21 4d  |zM"..)........!M|
-00000030  50 6d d9 39 ba ff 7d 41  a7 6b 80 dd af 6d 6f 9f  |Pm.9..}A.k...mo.|
-00000040  cf a9 e7 4f 64 ab 9b 5a  44 39 ce 8d 6e a4 0b 42  |...Od..ZD9..n..B|
-00000050  61 15 28 7d 0b 53 a6 8e  15 0c e6 1c 13 09 fb 5d  |a.(}.S.........]|
-00000060  cb 62 31 d3 ca 8d e4 74  6e 47 90 8a 76 60 7a 24  |.b1....tnG..v`z$|
-00000070  28 d2 1f 74 b4 cf 18 05  44 7a 87 28 76 c0 57 5a  |(..t....Dz.(v.WZ|
-00000080  94 3f d5 af e8 86 ce 45  7a ea 22 14 03 03 00 01  |.?.....Ez.".....|
-00000090  01 16 03 03 00 40 33 1e  6b 67 3d 57 5c 82 39 58  |.....@3.kg=W\.9X|
-000000a0  d0 e9 54 cb 41 03 0c 4d  db d0 a7 af a0 fd 56 a7  |..T.A..M......V.|
-000000b0  d0 88 27 e5 39 81 a8 ae  b3 9b 0e 08 54 16 0a 1b  |..'.9.......T...|
-000000c0  8e d5 52 80 4d 07 96 1a  64 d1 ac 93 71 43 5b 88  |..R.M...d...qC[.|
-000000d0  95 cc 32 ee fc b4                                 |..2...|
+00000000  16 03 03 00 86 10 00 00  82 00 80 c5 0c 17 b1 b2  |................|
+00000010  65 0b b7 7b 45 6f cb 7d  b4 9c 5c 82 3a 1a 75 11  |e..{Eo.}..\.:.u.|
+00000020  22 6f 41 3a 81 e2 81 2e  74 f8 70 61 fd e1 7c ce  |"oA:....t.pa..|.|
+00000030  bf 06 d7 29 77 07 b3 9d  cc 33 25 53 17 12 43 ae  |...)w....3%S..C.|
+00000040  4f df ad a4 3e 49 6e 97  50 b6 23 d0 fa 3d a6 bc  |O...>In.P.#..=..|
+00000050  38 d8 5f 2b 45 a7 d0 aa  cd b1 39 03 8f 62 9e 46  |8._+E.....9..b.F|
+00000060  50 d4 83 1d b8 76 41 29  d4 40 9a 65 41 8d 1c f0  |P....vA).@.eA...|
+00000070  d4 4d 88 d2 5e 42 ec c8  86 d6 fd df 65 d8 f1 82  |.M..^B......e...|
+00000080  8f 6a 80 31 1a 0e fc 13  2b 90 a8 14 03 03 00 01  |.j.1....+.......|
+00000090  01 16 03 03 00 40 50 ad  ed 91 c4 6a ed f8 aa 06  |.....@P....j....|
+000000a0  9e 13 03 38 bf 83 ef 4b  8e d5 89 d4 a3 f8 d9 8d  |...8...K........|
+000000b0  bb 88 72 a6 16 f6 5d d5  ca 55 bb e4 76 47 08 35  |..r...]..U..vG.5|
+000000c0  b9 fb 92 a4 0a b9 36 d7  62 44 81 e8 cf db ad 9a  |......6.bD......|
+000000d0  6d 72 c0 af 70 bd                                 |mr..p.|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 82 04 00 00  7e 00 00 00 00 00 78 50  |........~.....xP|
 00000010  46 ad c1 db a8 38 86 7b  2b bb fd d0 c3 42 3e 00  |F....8.{+....B>.|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000030  6f 2c 9f 83 61 60 24 85  1b 46 9d 93 96 8f 27 6f  |o,..a`$..F....'o|
-00000040  bf 17 0e 2d 0d f1 3c 3d  ce 85 b5 9c 8f 3a 6a c8  |...-..<=.....:j.|
-00000050  b4 e2 a1 03 c9 9c 34 72  d5 7e 60 d3 f3 f6 20 d6  |......4r.~`... .|
-00000060  0f 1b b9 18 0c 33 94 71  92 ec 74 0e eb a0 f7 ec  |.....3.q..t.....|
-00000070  81 b3 d2 63 90 b8 0f d9  9e d2 12 aa b5 78 06 7f  |...c.........x..|
-00000080  1b d3 33 fc d0 9c 73 14  03 03 00 01 01 16 03 03  |..3...s.........|
+00000030  6f 2c 9f 83 61 2e fe 48  fe f6 bb 98 a0 6f b0 be  |o,..a..H.....o..|
+00000040  9e 86 d7 b2 f2 67 c7 44  c7 3d e4 2b de d0 f4 d2  |.....g.D.=.+....|
+00000050  17 51 84 8e 7a a7 80 c4  65 14 f7 49 09 68 15 56  |.Q..z...e..I.h.V|
+00000060  68 32 41 d1 6f 33 94 a1  3a c9 37 20 5d e6 b0 6f  |h2A.o3..:.7 ]..o|
+00000070  37 0a 10 e3 28 e1 34 b6  6d e6 7a 44 24 7f 2f cf  |7...(.4.m.zD$./.|
+00000080  1b ae dd 4c d0 11 75 14  03 03 00 01 01 16 03 03  |...L..u.........|
 00000090  00 40 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |.@..............|
-000000a0  00 00 0e 56 25 a5 d8 15  57 44 da da f4 9f 40 c9  |...V%...WD....@.|
-000000b0  e2 a4 73 7c 3c 14 61 b7  aa 25 cb a1 4a d8 da b3  |..s|<.a..%..J...|
-000000c0  07 68 d0 8b 01 30 51 ad  f9 eb f6 0f a3 8c 59 97  |.h...0Q.......Y.|
-000000d0  33 81 17 03 03 00 40 00  00 00 00 00 00 00 00 00  |3.....@.........|
-000000e0  00 00 00 00 00 00 00 86  da 95 d0 e5 86 ff 3c e2  |..............<.|
-000000f0  26 90 2b 55 28 1c 9f 4f  77 f8 dc e9 f7 90 a6 5d  |&.+U(..Ow......]|
-00000100  e3 12 b2 16 36 bc d0 6e  cc 96 99 06 56 81 d3 77  |....6..n....V..w|
-00000110  26 6d ce 48 74 87 61 15  03 03 00 30 00 00 00 00  |&m.Ht.a....0....|
-00000120  00 00 00 00 00 00 00 00  00 00 00 00 fb 58 84 41  |.............X.A|
-00000130  a0 c3 57 82 4b a2 bd 70  6f 63 a0 5e c9 6b 02 ea  |..W.K..poc.^.k..|
-00000140  ce 64 b9 09 d3 50 d6 d6  df 2c 9a 4b              |.d...P...,.K|
+000000a0  00 00 7e 4a 31 e8 7d c6  eb 34 56 3b 62 0c 11 a2  |..~J1.}..4V;b...|
+000000b0  f0 bd 9b 9a 4c c9 39 2d  ed 21 dd 0c 72 3a 92 e1  |....L.9-.!..r:..|
+000000c0  0f b3 7f 71 c5 cf 2a 6f  68 bc 8e 84 7e d5 10 2e  |...q..*oh...~...|
+000000d0  c3 d4 17 03 03 00 40 00  00 00 00 00 00 00 00 00  |......@.........|
+000000e0  00 00 00 00 00 00 00 43  76 cc 74 b3 1c 89 c0 6b  |.......Cv.t....k|
+000000f0  96 f7 2c 84 c1 0a 6e d6  7f b4 76 76 2c 2f 74 6a  |..,...n...vv,/tj|
+00000100  c7 4e 18 69 1c 97 cd ca  f2 7a 33 01 3e 6f bb 54  |.N.i.....z3.>o.T|
+00000110  49 4e 8e 1d f4 13 74 15  03 03 00 30 00 00 00 00  |IN....t....0....|
+00000120  00 00 00 00 00 00 00 00  00 00 00 00 2d 70 b1 13  |............-p..|
+00000130  a9 e3 72 ca 05 8e 8d b7  f4 97 de 58 46 aa 2a 9c  |..r........XF.*.|
+00000140  2f 8c 3e 59 7b 64 e5 51  61 7f a6 39              |/.>Y{d.Qa..9|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-3DES b/src/crypto/tls/testdata/Server-TLSv12-RSA-3DES
index e84a02230f..af50381abc 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-3DES
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-3DES
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 5d 01 00 00  59 03 03 00 30 28 24 eb  |....]...Y...0($.|
-00000010  07 45 88 ea 2f a1 74 48  c0 02 60 0d 4f 1e e5 6f  |.E../.tH..`.O..o|
-00000020  05 1e 71 cc 95 19 f4 b7  00 7e cc 00 00 04 00 0a  |..q......~......|
+00000000  16 03 01 00 5d 01 00 00  59 03 03 0c fb 72 82 e5  |....]...Y....r..|
+00000010  9a 04 90 c8 0d 73 25 9a  3f 88 e3 48 71 a2 33 3e  |.....s%.?..Hq.3>|
+00000020  90 32 74 bc 12 38 d6 3a  d3 11 1d 00 00 04 00 0a  |.2t..8.:........|
 00000030  00 ff 01 00 00 2c 00 0d  00 20 00 1e 06 01 06 02  |.....,... ......|
 00000040  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
 00000050  03 02 03 03 02 01 02 02  02 03 00 16 00 00 00 17  |................|
@@ -50,27 +50,27 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 29 fc c5 28 19  |...........)..(.|
-00000010  32 c7 79 f9 16 4c d9 be  cb 43 e3 04 d2 6d 7f 38  |2.y..L...C...m.8|
-00000020  a5 da 32 97 eb bb 7f 9c  eb 78 16 2a e8 5a ea 49  |..2......x.*.Z.I|
-00000030  2e 3d 60 48 68 42 94 60  e3 cb da fa 3d cf 7f fb  |.=`HhB.`....=...|
-00000040  9f c3 4c ec 22 23 ff 0c  16 5c c5 c3 5e fa 1c c7  |..L."#...\..^...|
-00000050  60 eb f5 23 2f be 54 e0  10 a3 25 19 a3 39 49 ad  |`..#/.T...%..9I.|
-00000060  53 8e cd 65 af e7 d0 94  55 a6 64 6f 1f 59 dd b1  |S..e....U.do.Y..|
-00000070  d5 7e 98 c1 ad af 8e 72  88 b8 a3 68 fb 0c 2c 58  |.~.....r...h..,X|
-00000080  6c 0c a7 53 ad a1 bc bf  7c 6a d9 14 03 03 00 01  |l..S....|j......|
-00000090  01 16 03 03 00 30 d4 e1  2c f5 56 5e 14 75 62 02  |.....0..,.V^.ub.|
-000000a0  41 a3 f0 cb fd 52 00 b9  c0 88 db 58 7a 4c 7b 49  |A....R.....XzL{I|
-000000b0  02 02 34 33 1d a1 70 bf  ad 1a 92 86 9e 30 d6 01  |..43..p......0..|
-000000c0  9d dd ae 9b 52 43                                 |....RC|
+00000000  16 03 03 00 86 10 00 00  82 00 80 04 90 54 41 b9  |.............TA.|
+00000010  22 12 39 d9 1d 0b b8 6c  d4 b3 8a ec 78 42 80 a5  |".9....l....xB..|
+00000020  03 c9 2a 9e 95 6f a0 28  3a 5c e9 59 28 ba 49 9b  |..*..o.(:\.Y(.I.|
+00000030  37 63 61 3f c4 ac ba 55  6b 85 a5 27 ed 37 b9 25  |7ca?...Uk..'.7.%|
+00000040  04 cf 84 ad 43 6b ab 13  fa 72 29 b8 01 d9 aa 0c  |....Ck...r).....|
+00000050  be b1 9a c4 5a 05 3d 2d  71 b4 72 f5 3a 77 fb 6b  |....Z.=-q.r.:w.k|
+00000060  45 b0 5b 00 f8 1e f9 70  7f a4 64 c9 1e 35 56 0b  |E.[....p..d..5V.|
+00000070  68 07 4c 04 95 f4 ca b1  0a b3 25 2b 93 2d be 80  |h.L.......%+.-..|
+00000080  76 15 75 07 23 ee 25 f3  1b a8 2f 14 03 03 00 01  |v.u.#.%.../.....|
+00000090  01 16 03 03 00 30 e5 cd  56 75 e6 a4 58 e5 33 cc  |.....0..Vu..X.3.|
+000000a0  95 23 e0 7f 01 f2 45 21  bb 7d 7c 17 1f 59 7c f9  |.#....E!.}|..Y|.|
+000000b0  38 05 a3 95 4d 9b f2 3f  9d 84 2c 31 15 8b 4d d4  |8...M..?..,1..M.|
+000000c0  17 3c 62 2b f6 71                                 |.<b+.q|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 30 00 00 00 00 00  |..........0.....|
-00000010  00 00 00 c0 8f cc 51 1d  09 6f e2 aa 29 a3 36 8c  |......Q..o..).6.|
-00000020  6b 15 72 2a 54 d3 47 c2  2d f2 54 21 35 12 bd 89  |k.r*T.G.-.T!5...|
-00000030  7e b6 3f cc 61 f4 80 1f  e8 f5 32 17 03 03 00 30  |~.?.a.....2....0|
-00000040  00 00 00 00 00 00 00 00  85 74 6a 10 4f 55 b4 5c  |.........tj.OU.\|
-00000050  50 e5 76 d1 b0 77 97 a7  35 35 fd 2a 24 95 f4 96  |P.v..w..55.*$...|
-00000060  6d 02 6a 36 cc 79 08 03  fc 06 67 0a 90 3d 19 c7  |m.j6.y....g..=..|
-00000070  15 03 03 00 20 00 00 00  00 00 00 00 00 5c 3a 48  |.... ........\:H|
-00000080  26 6c 49 13 58 35 1e c6  22 07 6a 67 6a 58 1d e5  |&lI.X5..".jgjX..|
-00000090  77 6d d7 62 4f                                    |wm.bO|
+00000010  00 00 00 b3 85 c2 1b ac  9e c2 01 f7 0f 76 6d 09  |.............vm.|
+00000020  5c 4f 9f a6 89 1b 56 e3  05 0b 7e 0d 9d 6b 36 35  |\O....V...~..k65|
+00000030  49 99 aa 4c 14 3b 69 2a  87 71 7d 17 03 03 00 30  |I..L.;i*.q}....0|
+00000040  00 00 00 00 00 00 00 00  15 65 d4 be e5 1b c9 29  |.........e.....)|
+00000050  e9 3a c4 22 72 f8 0c 40  c7 f5 45 a1 a3 c8 a8 64  |.:."r..@..E....d|
+00000060  22 4c 6c 79 3f 32 66 d4  05 09 a8 d4 d8 a8 f3 c7  |"Lly?2f.........|
+00000070  15 03 03 00 20 00 00 00  00 00 00 00 00 fc 8d c6  |.... ...........|
+00000080  3d b1 c4 9f 30 26 e3 b9  46 8f ce 9f 7e 5b 1e a3  |=...0&..F...~[..|
+00000090  d0 98 64 3c 0d                                    |..d<.|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES
index 678f9a1963..813f7489c8 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 5d 01 00 00  59 03 03 50 0b 78 b2 4c  |....]...Y..P.x.L|
-00000010  1e 56 23 02 c5 62 24 b5  a1 59 9d 2e fc 74 81 cc  |.V#..b$..Y...t..|
-00000020  48 25 bb 7f 14 0d aa 77  c4 17 4e 00 00 04 00 2f  |H%.....w..N..../|
+00000000  16 03 01 00 5d 01 00 00  59 03 03 7a e5 86 e2 0a  |....]...Y..z....|
+00000010  53 e7 ba 32 d1 57 47 ed  45 29 1b 33 2c 58 33 8f  |S..2.WG.E).3,X3.|
+00000020  36 2c 50 6f f9 c7 3b 12  40 23 e2 00 00 04 00 2f  |6,Po..;.@#...../|
 00000030  00 ff 01 00 00 2c 00 0d  00 20 00 1e 06 01 06 02  |.....,... ......|
 00000040  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
 00000050  03 02 03 03 02 01 02 02  02 03 00 16 00 00 00 17  |................|
@@ -50,31 +50,31 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 5b ee e9 53 45  |...........[..SE|
-00000010  1b 58 be 12 94 b2 42 8d  50 22 f8 7c af 2b 56 dd  |.X....B.P".|.+V.|
-00000020  0d 67 25 5d 26 b4 f8 3e  6a 1b de a1 05 17 25 e7  |.g%]&..>j.....%.|
-00000030  50 5e fa c3 57 7e d6 5a  66 4c d8 9e e1 ec 7a 58  |P^..W~.ZfL....zX|
-00000040  13 8b 88 77 3e 36 49 6f  25 aa 9f 31 75 95 48 78  |...w>6Io%..1u.Hx|
-00000050  54 48 e5 dd 37 1f a3 5a  f8 93 ce b4 14 c5 16 be  |TH..7..Z........|
-00000060  30 54 d6 f5 26 08 0e b9  80 5a 70 c6 92 2b 89 50  |0T..&....Zp..+.P|
-00000070  3e 44 3c b8 2b 0a 37 d9  ff 81 81 ff 5c f9 73 75  |>D<.+.7.....\.su|
-00000080  a3 24 6f 3f 36 4e f6 26  ed 8c 67 14 03 03 00 01  |.$o?6N.&..g.....|
-00000090  01 16 03 03 00 40 eb 95  ee 33 f8 ed d0 38 47 1e  |.....@...3...8G.|
-000000a0  bf 62 95 87 2b d7 96 0d  17 af ec 89 2d e7 33 83  |.b..+.......-.3.|
-000000b0  2e c3 18 67 22 06 31 f2  47 3b 10 28 98 e6 e7 b3  |...g".1.G;.(....|
-000000c0  f6 19 52 92 ad 77 74 89  4f 92 66 e7 00 a9 60 12  |..R..wt.O.f...`.|
-000000d0  30 c8 d6 d9 b3 fd                                 |0.....|
+00000000  16 03 03 00 86 10 00 00  82 00 80 8f 13 d1 23 1b  |..............#.|
+00000010  8d 28 c7 a3 97 66 9f 8a  c1 13 a1 c9 3b 25 93 7a  |.(...f......;%.z|
+00000020  ea 54 58 fc 57 41 ca 92  77 99 13 01 61 e4 73 90  |.TX.WA..w...a.s.|
+00000030  c7 f1 2b 5e 5e 79 cf 69  7d 6b 3f 6e 5f 2e b0 f5  |..+^^y.i}k?n_...|
+00000040  f7 53 2b 46 15 92 6c 20  95 6b 44 6a 0a 3d 0b 56  |.S+F..l .kDj.=.V|
+00000050  66 53 ff 55 ec 38 10 cf  76 2c 0e ab 45 7a 02 6a  |fS.U.8..v,..Ez.j|
+00000060  75 07 11 80 6c d0 57 79  ed d6 4b b8 a0 04 91 a0  |u...l.Wy..K.....|
+00000070  d4 4b 76 38 9c b3 a6 2e  0c 3e 63 a8 18 15 c9 ab  |.Kv8.....>c.....|
+00000080  54 69 cd e5 6f 3c 56 a6  5f a7 e0 14 03 03 00 01  |Ti..o<V._.......|
+00000090  01 16 03 03 00 40 06 07  16 b4 7f fa 1a 8f 9b 1a  |.....@..........|
+000000a0  a3 23 ba 5f ce ff 0a 70  b1 11 2b 84 77 7a 78 1a  |.#._...p..+.wzx.|
+000000b0  6c 32 93 6c 31 e8 e5 26  12 97 14 33 a9 77 71 19  |l2.l1..&...3.wq.|
+000000c0  0b 20 5d 8f 3c 71 0d a4  b9 94 aa ff 42 8e d3 2d  |. ].<q......B..-|
+000000d0  7e 57 3b 35 41 cc                                 |~W;5A.|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 2c 6f 4a 71 23  |...........,oJq#|
-00000020  84 5a 5c f9 93 8c c6 91  17 8a fb f5 cd d6 72 9a  |.Z\...........r.|
-00000030  f8 01 9b 54 cc 82 fd d5  51 62 a3 88 1b ce 42 b9  |...T....Qb....B.|
-00000040  f6 f6 a3 f9 35 2b 24 93  d0 ba c0 17 03 03 00 40  |....5+$........@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 51 27 cd 07 6e  |...........Q'..n|
+00000020  72 c8 17 ba e7 62 7c d0  49 55 e7 e6 c5 2c 93 39  |r....b|.IU...,.9|
+00000030  55 02 f5 fa 9a 7a 6f c5  79 6f ff 0f 4b b9 3d ad  |U....zo.yo..K.=.|
+00000040  23 c7 53 ad 13 2d d6 da  83 d0 67 17 03 03 00 40  |#.S..-....g....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  84 ad d5 dd 56 ce ec 6f  91 4f cc 02 6e ab 88 4b  |....V..o.O..n..K|
-00000070  04 46 9e 84 8f d5 56 5d  8d 7a e3 e4 f1 32 1c e9  |.F....V].z...2..|
-00000080  b7 cc 44 aa bc 00 80 8d  39 c0 36 42 d2 f5 8e bf  |..D.....9.6B....|
+00000060  f5 09 3b 69 c2 1f f8 03  78 1b 13 57 ca 92 96 eb  |..;i....x..W....|
+00000070  f8 71 30 09 5a 68 01 47  96 b1 5b 7d b7 57 5e 70  |.q0.Zh.G..[}.W^p|
+00000080  00 77 bb 55 32 7b d9 a5  f7 e2 a8 6d 4b d6 be c6  |.w.U2{.....mK...|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 c6 5b b6  1d 1e 53 03 95 3d fc 1c  |......[...S..=..|
-000000b0  1c 22 67 dc 2c c3 46 1d  d7 23 69 7e 3d c6 a0 10  |."g.,.F..#i~=...|
-000000c0  a5 e0 ce 54 d4                                    |...T.|
+000000a0  00 00 00 00 00 58 1e a0  14 82 8d e4 c5 92 35 79  |.....X........5y|
+000000b0  3b 5e 3a fe 97 18 db 27  19 7e b5 14 8c 01 fb 6a  |;^:....'.~.....j|
+000000c0  e4 26 96 e6 de                                    |.&...|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM
index 2fd755e50c..4e52915ac5 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 73 01 00 00  6f 03 03 e0 a2 fa ce e1  |....s...o.......|
-00000010  09 f4 dc 29 05 6d 58 a3  76 ee 23 bc eb e3 11 b0  |...).mX.v.#.....|
-00000020  93 43 91 69 27 8a e1 fb  0b a2 60 00 00 04 c0 2f  |.C.i'.....`..../|
+00000000  16 03 01 00 73 01 00 00  6f 03 03 4e 1a d7 67 e4  |....s...o..N..g.|
+00000010  d1 11 85 bc 62 59 da 8f  ea d0 a0 2b 9b d3 47 aa  |....bY.....+..G.|
+00000020  d0 39 6f 3f 42 dc 7c 16  bb 25 ef 00 00 04 c0 2f  |.9o?B.|..%...../|
 00000030  00 ff 01 00 00 42 00 0b  00 04 03 00 01 02 00 0a  |.....B..........|
 00000040  00 0a 00 08 00 1d 00 17  00 19 00 18 00 0d 00 20  |............... |
 00000050  00 1e 06 01 06 02 06 03  05 01 05 02 05 03 04 01  |................|
@@ -52,28 +52,28 @@
 00000290  3b e9 fa e7 16 03 03 00  ac 0c 00 00 a8 03 00 1d  |;...............|
 000002a0  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
 000002b0  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-000002c0  74 05 01 00 80 48 99 55  da 4d dc cb 40 a5 ae 4f  |t....H.U.M..@..O|
-000002d0  d7 01 11 60 a8 70 c3 4e  0b 46 55 59 8c 7c 24 2d  |...`.p.N.FUY.|$-|
-000002e0  15 93 f9 a4 6e 74 00 f5  2f f3 35 69 58 b6 f1 5c  |....nt../.5iX..\|
-000002f0  0e 2f ba 55 28 fb 7a 34  6f e1 a1 dc 91 f1 6f 9e  |./.U(.z4o.....o.|
-00000300  84 3a e6 12 9a 4d 49 45  8b 14 59 ca 18 aa a5 33  |.:...MIE..Y....3|
-00000310  4f b3 1a 88 97 d5 c2 fa  cb 24 bc 5b cb 2a d6 46  |O........$.[.*.F|
-00000320  54 68 42 7c c8 eb 8b 93  68 2f 4b e2 cf 81 43 af  |ThB|....h/K...C.|
-00000330  d1 d2 50 9f d7 d6 1c 41  62 c1 36 75 d2 b1 e6 0e  |..P....Ab.6u....|
-00000340  4d 17 18 0a 5d 16 03 03  00 04 0e 00 00 00        |M...].........|
+000002c0  74 05 01 00 80 b2 49 30  60 b7 0c 48 cb 9f 1c 75  |t.....I0`..H...u|
+000002d0  a6 b0 b0 7b 5e e6 f9 bc  5a 49 d4 51 e2 76 4c 01  |...{^...ZI.Q.vL.|
+000002e0  55 bd 37 cf 86 75 4f 33  9b fd 3c fc bb da 81 a9  |U.7..uO3..<.....|
+000002f0  26 7b 82 31 c5 51 0f d4  e8 fa a3 16 45 19 c8 40  |&{.1.Q......E..@|
+00000300  23 fa 32 bc 05 36 fb a7  a2 d9 6f e7 bc b8 27 0b  |#.2..6....o...'.|
+00000310  2a 9e 7b 95 fd b4 c0 2e  f0 73 fe fb a2 ea 20 a2  |*.{......s.... .|
+00000320  73 73 96 c8 bc 82 58 09  84 fc f4 09 2a c8 68 cb  |ss....X.....*.h.|
+00000330  66 b0 de 2c 78 7a d4 ec  06 f1 1c 52 03 5a 69 24  |f..,xz.....R.Zi$|
+00000340  c4 e6 bb 68 f4 16 03 03  00 04 0e 00 00 00        |...h..........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 c6 88 23 46 a5 6c  |....%...! ..#F.l|
-00000010  ba 69 bb 5e 23 b1 27 01  5e 9d 7f 45 72 93 63 31  |.i.^#.'.^..Er.c1|
-00000020  e8 f2 87 08 9d 01 75 32  82 56 14 03 03 00 01 01  |......u2.V......|
-00000030  16 03 03 00 28 1e f0 f4  f5 2d b5 37 5b e1 59 60  |....(....-.7[.Y`|
-00000040  70 eb 63 31 ca 3b 41 7c  39 52 fd 33 1b 40 61 22  |p.c1.;A|9R.3.@a"|
-00000050  8f 24 69 dd 91 62 f8 d3  a2 2a a4 31 a9           |.$i..b...*.1.|
+00000000  16 03 03 00 25 10 00 00  21 20 41 d4 8d 53 2e 47  |....%...! A..S.G|
+00000010  b8 35 ba 86 3c 41 07 2e  c1 a0 9d c2 e9 11 d8 20  |.5..<A......... |
+00000020  a1 fa 0a ff 28 64 5b af  c3 67 14 03 03 00 01 01  |....(d[..g......|
+00000030  16 03 03 00 28 78 fd 19  36 4d a7 ca ab ba 06 6b  |....(x..6M.....k|
+00000040  3f a5 79 17 2f 2b ec f6  19 db 17 1a 52 ea 72 0b  |?.y./+......R.r.|
+00000050  01 af 56 8b 14 8f 8a 04  f3 ff ea fe 33           |..V.........3|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 28 00 00 00 00 00  |..........(.....|
-00000010  00 00 00 4e d7 27 fc b0  64 d8 64 a2 4b d3 a7 52  |...N.'..d.d.K..R|
-00000020  2a 30 7a 97 d2 61 6f 4b  2f d3 81 5c 99 b3 69 3e  |*0z..aoK/..\..i>|
-00000030  29 aa 7b 17 03 03 00 25  00 00 00 00 00 00 00 01  |).{....%........|
-00000040  0a e3 da e2 13 b5 b8 d5  01 e9 54 ba ad 43 3c 11  |..........T..C<.|
-00000050  12 70 23 b6 c4 6c 5c 5a  c5 14 3c ef cd 15 03 03  |.p#..l\Z..<.....|
-00000060  00 1a 00 00 00 00 00 00  00 02 37 f7 d8 64 bb 4b  |..........7..d.K|
-00000070  ff b9 8d 5a aa 47 0a 33  12 37 29 f8              |...Z.G.3.7).|
+00000010  00 00 00 ec 99 e0 9a 83  28 94 e6 72 4f be 28 24  |........(..rO.($|
+00000020  64 bd 9d 86 79 cc ab 05  15 39 06 6e da 0c b8 4e  |d...y....9.n...N|
+00000030  6c a9 f3 17 03 03 00 25  00 00 00 00 00 00 00 01  |l......%........|
+00000040  9a d7 b0 54 dd 3c ae 8e  3f 1f 41 68 a5 01 a0 da  |...T.<..?.Ah....|
+00000050  e8 8e 90 55 1a 11 f0 70  8d a3 af a4 29 15 03 03  |...U...p....)...|
+00000060  00 1a 00 00 00 00 00 00  00 02 a8 96 cb 16 d7 b1  |................|
+00000070  41 7e bc 0e 01 8f cc 47  40 e5 c7 2a              |A~.....G@..*|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES256-GCM-SHA384 b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES256-GCM-SHA384
index 88c52371c1..36be9da0d0 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES256-GCM-SHA384
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES256-GCM-SHA384
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 73 01 00 00  6f 03 03 bc e7 1a ca 08  |....s...o.......|
-00000010  96 da c8 af ca 82 23 6b  38 66 bf ae ce e1 1e 9a  |......#k8f......|
-00000020  b8 3f 89 85 4e a8 3c 97  a4 89 b8 00 00 04 c0 30  |.?..N.<........0|
+00000000  16 03 01 00 73 01 00 00  6f 03 03 b7 d2 dc fe 53  |....s...o......S|
+00000010  d6 13 08 19 be 30 22 17  db a7 06 9b 62 82 14 38  |.....0".....b..8|
+00000020  2e 68 70 08 02 7d 22 64  13 75 f5 00 00 04 c0 30  |.hp..}"d.u.....0|
 00000030  00 ff 01 00 00 42 00 0b  00 04 03 00 01 02 00 0a  |.....B..........|
 00000040  00 0a 00 08 00 1d 00 17  00 19 00 18 00 0d 00 20  |............... |
 00000050  00 1e 06 01 06 02 06 03  05 01 05 02 05 03 04 01  |................|
@@ -52,28 +52,28 @@
 00000290  3b e9 fa e7 16 03 03 00  ac 0c 00 00 a8 03 00 1d  |;...............|
 000002a0  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
 000002b0  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-000002c0  74 05 01 00 80 89 eb fc  69 bd e7 5a 8d 4a 9c 7e  |t.......i..Z.J.~|
-000002d0  2a b8 8c 5e 9e 37 62 89  7b 95 0c aa 78 c8 87 d5  |*..^.7b.{...x...|
-000002e0  50 38 25 9e 42 52 51 c5  85 de 76 48 78 44 3a 96  |P8%.BRQ...vHxD:.|
-000002f0  87 dd b8 83 c7 89 d2 39  88 c0 e1 77 c5 eb 92 21  |.......9...w...!|
-00000300  cb 5e 40 5a 82 13 cb d6  86 ce 26 17 b0 7c d7 56  |.^@Z......&..|.V|
-00000310  8a 49 9c a2 70 a3 cb 61  12 f5 0e b9 dd f2 ec c4  |.I..p..a........|
-00000320  74 b6 bf a1 83 9a 94 3b  ff b1 82 2e 14 da 3f 86  |t......;......?.|
-00000330  31 86 c5 92 ee e4 f1 41  06 57 06 de 5d 36 58 31  |1......A.W..]6X1|
-00000340  2b ac e0 47 04 16 03 03  00 04 0e 00 00 00        |+..G..........|
+000002c0  74 05 01 00 80 b8 c4 6a  be 2a dd 47 03 7b 84 72  |t......j.*.G.{.r|
+000002d0  0b a4 c0 a7 2e b5 a4 be  c7 6a 2a 8b d0 23 6f b5  |.........j*..#o.|
+000002e0  bc 0e ba 3c f5 9d a3 90  b0 af 80 11 bd 22 b5 7b  |...<.........".{|
+000002f0  3c 53 f8 54 d0 b4 b0 53  28 75 0d 15 58 88 c2 90  |<S.T...S(u..X...|
+00000300  69 ea e0 08 aa 07 93 15  ae ed e5 a8 3d 2d 9c 62  |i...........=-.b|
+00000310  1d 40 26 7d 0e d3 23 52  71 71 ff ea 18 f9 0a eb  |.@&}..#Rqq......|
+00000320  78 8a 8f 9e 12 8c 0b 33  a8 ee 42 76 16 29 58 ec  |x......3..Bv.)X.|
+00000330  ea 6d 22 48 0d d0 68 c3  97 8d e9 ec cd 10 f6 47  |.m"H..h........G|
+00000340  c9 9d 42 12 54 16 03 03  00 04 0e 00 00 00        |..B.T.........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 54 93 b9 c3 5d 0f  |....%...! T...].|
-00000010  9f 34 0a a0 0c bd df 96  12 a6 35 ed c3 ab ae d0  |.4........5.....|
-00000020  41 3c 7d 7e b4 f4 0b a6  4c 1a 14 03 03 00 01 01  |A<}~....L.......|
-00000030  16 03 03 00 28 5d a3 8e  f4 82 cd 79 ff a1 4a f6  |....(].....y..J.|
-00000040  8b f5 fd 79 b1 db 00 33  a8 e0 65 fa 6a 66 77 92  |...y...3..e.jfw.|
-00000050  f1 9a 03 f6 c3 04 8d e9  fd 77 23 41 ed           |.........w#A.|
+00000000  16 03 03 00 25 10 00 00  21 20 20 df 4a b8 02 4f  |....%...!  .J..O|
+00000010  31 db 22 90 59 57 20 23  e1 72 8d 28 60 b3 f2 77  |1.".YW #.r.(`..w|
+00000020  db 3a ce 64 5a a5 63 94  be 09 14 03 03 00 01 01  |.:.dZ.c.........|
+00000030  16 03 03 00 28 de 72 f3  c3 b2 aa b4 9b b7 fe 35  |....(.r........5|
+00000040  3b 25 af 74 47 d3 49 39  07 d9 70 37 30 d0 b7 47  |;%.tG.I9..p70..G|
+00000050  bf ad 97 08 44 59 a7 3c  12 f2 4a 2d 7c           |....DY.<..J-||
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 28 00 00 00 00 00  |..........(.....|
-00000010  00 00 00 48 6d dc 6d 66  cd 9f e1 f7 9c fa 39 d0  |...Hm.mf......9.|
-00000020  f9 25 1d 03 43 1f b8 78  1c e5 1e 46 1f ee fe 05  |.%..C..x...F....|
-00000030  1d 4b 3c 17 03 03 00 25  00 00 00 00 00 00 00 01  |.K<....%........|
-00000040  f3 ee a6 01 db 34 54 f0  9a ee 15 da ff d7 7a a2  |.....4T.......z.|
-00000050  55 c5 55 3f df 8a f7 70  f6 62 67 10 05 15 03 03  |U.U?...p.bg.....|
-00000060  00 1a 00 00 00 00 00 00  00 02 64 17 7b 79 a6 0d  |..........d.{y..|
-00000070  a2 3e 5a 11 60 72 ba 4d  5e 03 de 49              |.>Z.`r.M^..I|
+00000010  00 00 00 16 18 e1 e8 d4  c0 d1 19 3a 50 10 85 fc  |...........:P...|
+00000020  fc 3e 27 54 e4 57 b6 e7  c4 25 d5 4e 10 ad 0f ff  |.>'T.W...%.N....|
+00000030  ad 45 8c 17 03 03 00 25  00 00 00 00 00 00 00 01  |.E.....%........|
+00000040  50 b8 af 5f a2 3e 0f f7  f0 81 1f 32 69 39 2f f2  |P.._.>.....2i9/.|
+00000050  47 28 80 fb d0 46 d4 b7  a2 ba e3 71 ea 15 03 03  |G(...F.....q....|
+00000060  00 1a 00 00 00 00 00 00  00 02 c4 64 7a 81 b3 3a  |...........dz..:|
+00000070  2c 71 35 ec f7 0c 52 36  20 2c eb fe              |,q5...R6 ,..|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-RC4 b/src/crypto/tls/testdata/Server-TLSv12-RSA-RC4
index 8a5924e168..e49d1bcbbc 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-RC4
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-RC4
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 5d 01 00 00  59 03 03 3f 8c 20 8d f7  |....]...Y..?. ..|
-00000010  a8 0e 9d 16 b3 9b d9 b6  68 5e 3b bd f4 44 37 5b  |........h^;..D7[|
-00000020  07 c7 dc 89 b4 5b 0f 0e  d9 a2 fd 00 00 04 00 05  |.....[..........|
+00000000  16 03 01 00 5d 01 00 00  59 03 03 55 3e 1a 3f cc  |....]...Y..U>.?.|
+00000010  14 18 07 db 5e 97 15 33  62 9d de 56 7b ea 52 bf  |....^..3b..V{.R.|
+00000020  a3 ce c2 75 3f 52 0a 2f  3e 99 07 00 00 04 00 05  |...u?R./>.......|
 00000030  00 ff 01 00 00 2c 00 0d  00 20 00 1e 06 01 06 02  |.....,... ......|
 00000040  06 03 05 01 05 02 05 03  04 01 04 02 04 03 03 01  |................|
 00000050  03 02 03 03 02 01 02 02  02 03 00 16 00 00 00 17  |................|
@@ -50,23 +50,23 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 47 b2 00 f9 96  |...........G....|
-00000010  fc 53 53 1a 05 b1 89 5f  39 0d 5e 86 e7 fe 69 e5  |.SS...._9.^...i.|
-00000020  7c 2f b7 70 f3 eb 11 95  f2 45 0f 09 36 ae 85 4f  ||/.p.....E..6..O|
-00000030  cf 9e 92 ea 5a 79 90 1e  d6 dd 43 f3 50 40 82 d7  |....Zy....C.P@..|
-00000040  36 53 3b 7f 17 71 0f 83  58 4d 2d 35 b0 70 d1 68  |6S;..q..XM-5.p.h|
-00000050  63 97 00 de 77 8f 0d 89  bb d2 a9 01 4b 6c e7 3f  |c...w.......Kl.?|
-00000060  1d 64 a0 c5 38 99 a5 70  f7 66 df ac c5 08 cd 48  |.d..8..p.f.....H|
-00000070  a4 e7 c0 8b a6 5a dd 2e  d3 24 2d b4 3a c5 09 98  |.....Z...$-.:...|
-00000080  4f 49 cb 23 ea fb 73 ed  92 3e 76 14 03 03 00 01  |OI.#..s..>v.....|
-00000090  01 16 03 03 00 24 b9 43  a4 09 06 d2 f4 ab e8 15  |.....$.C........|
-000000a0  5c 23 09 60 7c cf 1f 77  af 39 11 b8 5e e5 28 87  |\#.`|..w.9..^.(.|
-000000b0  03 83 6b bd 98 a9 cb dd  c7 37                    |..k......7|
+00000000  16 03 03 00 86 10 00 00  82 00 80 a7 55 0a e7 33  |............U..3|
+00000010  8e be 5a 3a b4 f4 06 6e  fc 0e 42 6e f3 0c 01 5a  |..Z:...n..Bn...Z|
+00000020  65 73 36 bd cd be 0f 65  2f d2 88 1a f0 5e f8 07  |es6....e/....^..|
+00000030  c1 fe 5f 5f d6 f5 fa 79  24 44 0d 33 4f e6 74 88  |..__...y$D.3O.t.|
+00000040  86 f1 76 84 29 b4 f2 ae  eb 9b 00 a2 6a e4 97 58  |..v.).......j..X|
+00000050  8b 2e 04 8f 8f 5e fe b4  9d 38 1d 8d 40 a4 9b a2  |.....^...8..@...|
+00000060  17 50 8a e5 39 c9 e9 41  3e 0d 9c 42 2c 7a 88 bf  |.P..9..A>..B,z..|
+00000070  f7 09 4e 27 0b fe cc 53  13 07 d5 7e 0e e6 02 3c  |..N'...S...~...<|
+00000080  8a 3f f9 03 df b6 65 a0  77 ee 50 14 03 03 00 01  |.?....e.w.P.....|
+00000090  01 16 03 03 00 24 5f 41  3e 38 05 08 74 62 5b 4e  |.....$_A>8..tb[N|
+000000a0  94 55 98 74 5c 65 1a 4c  49 08 1d 77 d7 f0 12 47  |.U.t\e.LI..w...G|
+000000b0  d2 ef a6 31 5c 36 03 b5  b5 9d                    |...1\6....|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 24 ac 96 d0 45 b1  |..........$...E.|
-00000010  78 80 cc 3a dc d2 28 06  99 8b 1a 25 c0 2d f3 80  |x..:..(....%.-..|
-00000020  54 25 5e 6c 63 87 e4 9f  9f a3 c9 ef e9 8f 87 17  |T%^lc...........|
-00000030  03 03 00 21 95 00 3a 52  a8 11 64 d3 f4 bc 8c f3  |...!..:R..d.....|
-00000040  90 cf 26 3b 41 62 c8 2c  ee 78 60 a2 85 7b 5d 5c  |..&;Ab.,.x`..{]\|
-00000050  3e 4a 6e c9 c2 15 03 03  00 16 76 d8 e0 a9 f6 f9  |>Jn.......v.....|
-00000060  2c aa d6 68 ab 27 9c ee  c6 ba 50 e0 1e 17 fa 79  |,..h.'....P....y|
+00000000  14 03 03 00 01 01 16 03  03 00 24 6f 68 a2 c0 4d  |..........$oh..M|
+00000010  f4 cb c0 e5 8b 19 f9 2e  46 c3 3b 92 eb a9 42 8b  |........F.;...B.|
+00000020  03 4a e2 62 9d f1 c0 39  b1 63 61 08 15 b0 ca 17  |.J.b...9.ca.....|
+00000030  03 03 00 21 50 9e 16 ce  7e af 8f 43 d1 1c 30 37  |...!P...~..C..07|
+00000040  85 e9 68 3a 9c 7e 26 90  dc 14 b1 ec 91 20 2b 4a  |..h:.~&...... +J|
+00000050  24 b4 fa b1 50 15 03 03  00 16 59 74 08 41 73 01  |$...P.....Yt.As.|
+00000060  22 19 0b 35 6b 4d ee d2  15 50 42 de cc cf cc 09  |"..5kM...PB.....|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-Resume b/src/crypto/tls/testdata/Server-TLSv12-Resume
index 51c5cd285a..366ca8f75d 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-Resume
+++ b/src/crypto/tls/testdata/Server-TLSv12-Resume
@@ -1,44 +1,41 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 f9 01 00 00  f5 03 03 a5 54 3e b4 52  |............T>.R|
-00000010  e5 0f 00 26 8b b6 97 99  3d 32 64 42 6c 97 f8 0c  |...&....=2dBl...|
-00000020  46 10 42 83 bb d1 d3 a0  70 58 4e 20 0b ef 27 4e  |F.B.....pXN ..'N|
-00000030  90 45 03 73 c9 18 0f 5b  25 77 c9 5d ca 77 2c fb  |.E.s...[%w.].w,.|
-00000040  4f 0e d1 a3 dc 76 4d d6  97 70 ab a6 00 04 00 2f  |O....vM..p...../|
+00000000  16 03 01 00 f9 01 00 00  f5 03 03 23 77 58 99 0e  |...........#wX..|
+00000010  44 ed 63 44 e4 e4 eb d1  83 c3 9c d0 24 12 a3 b9  |D.cD........$...|
+00000020  55 6b 4d da bf 84 9d 35  de 43 a0 20 7b 93 cb d3  |UkM....5.C. {...|
+00000030  c5 ce 5e d5 aa 48 91 a4  b2 c2 d7 72 09 0d 21 78  |..^..H.....r..!x|
+00000040  f0 ac 7a ed 9a a9 ad dd  51 8b b2 1c 00 04 00 2f  |..z.....Q....../|
 00000050  00 ff 01 00 00 a8 00 23  00 78 50 46 ad c1 db a8  |.......#.xPF....|
 00000060  38 86 7b 2b bb fd d0 c3  42 3e 00 00 00 00 00 00  |8.{+....B>......|
 00000070  00 00 00 00 00 00 00 00  00 00 94 6f 2c 9f 83 61  |...........o,..a|
-00000080  f0 a9 9a d5 65 c7 25 32  9d 86 4e fb 8e 2a dd 84  |....e.%2..N..*..|
-00000090  8d 32 6d 6b f0 a9 de 59  fa 15 20 7a 85 cd 2e 42  |.2mk...Y.. z...B|
-000000a0  e1 f3 44 62 6c 24 24 e7  1f b6 fa 4d 8a cd 30 83  |..Dbl$$....M..0.|
-000000b0  33 94 65 b6 e2 01 d8 fb  a0 37 ca 87 59 a4 29 cf  |3.e......7..Y.).|
-000000c0  d9 85 7c 54 2f 2d 5d 73  69 9a ae 6f 85 29 8b c3  |..|T/-]si..o.)..|
-000000d0  eb 97 00 0d 00 20 00 1e  06 01 06 02 06 03 05 01  |..... ..........|
+00000080  0b b1 b7 9e 10 2d 0c 56  e8 70 66 ad de b1 15 74  |.....-.V.pf....t|
+00000090  2f 8b 08 8c 96 bb 4b 1b  4e dd 81 0e bf 84 4d 43  |/.....K.N.....MC|
+000000a0  8f c0 7e a0 7f be c0 59  bf 83 26 0f a2 22 52 2c  |..~....Y..&.."R,|
+000000b0  33 94 5a 77 54 f3 b5 f2  22 51 d5 24 c2 60 c3 2e  |3.ZwT..."Q.$.`..|
+000000c0  0f 9c 5e 33 3b e8 7c 52  2a 76 08 58 ac 47 98 bc  |..^3;.|R*v.X.G..|
+000000d0  36 b6 00 0d 00 20 00 1e  06 01 06 02 06 03 05 01  |6.... ..........|
 000000e0  05 02 05 03 04 01 04 02  04 03 03 01 03 02 03 03  |................|
 000000f0  02 01 02 02 02 03 00 16  00 00 00 17 00 00        |..............|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 51 02 00 00  4d 03 03 00 00 00 00 00  |....Q...M.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 0b ef 27 4e  |........... ..'N|
-00000030  90 45 03 73 c9 18 0f 5b  25 77 c9 5d ca 77 2c fb  |.E.s...[%w.].w,.|
-00000040  4f 0e d1 a3 dc 76 4d d6  97 70 ab a6 00 2f 00 00  |O....vM..p.../..|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 7b 93 cb d3  |........... {...|
+00000030  c5 ce 5e d5 aa 48 91 a4  b2 c2 d7 72 09 0d 21 78  |..^..H.....r..!x|
+00000040  f0 ac 7a ed 9a a9 ad dd  51 8b b2 1c 00 2f 00 00  |..z.....Q..../..|
 00000050  05 ff 01 00 01 00 14 03  03 00 01 01 16 03 03 00  |................|
 00000060  40 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |@...............|
-00000070  00 a1 cc 3b 14 4e 15 da  e3 6f 67 2a 4b 28 1e 4f  |...;.N...og*K(.O|
-00000080  a6 e3 bc fd ae 38 e3 31  6f 65 78 2b 3d c5 c7 bf  |.....8.1oex+=...|
-00000090  1a ff 10 a1 b1 cd 1e 0e  54 a8 9c 89 86 ab 76 46  |........T.....vF|
-000000a0  3e                                                |>|
+00000070  00 ac d9 95 88 c6 37 e8  3c 24 d8 d9 15 46 25 c6  |......7.<$...F%.|
+00000080  32 0c 75 80 11 3d 89 53  1c 7a b1 78 6a c1 1a d7  |2.u..=.S.z.xj...|
+00000090  91 6e c2 55 99 84 11 43  cd 62 99 3b 28 1b 2e 08  |.n.U...C.b.;(...|
+000000a0  a8                                                |.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 16 03  03 00 40 9b 58 5e e3 6d  |..........@.X^.m|
-00000010  aa 65 b6 82 e4 60 bd 74  92 11 99 88 03 14 bf b4  |.e...`.t........|
-00000020  24 e8 2f 89 ff 9b e4 b5  ca 2e b5 cf a0 56 b0 23  |$./..........V.#|
-00000030  96 d7 92 40 83 f8 fa fd  7a 11 6d 8d 1a 29 59 75  |...@....z.m..)Yu|
-00000040  88 b8 54 23 d0 01 ef 67  40 c0 41                 |..T#...g@.A|
+00000000  14 03 03 00 01 01 16 03  03 00 40 67 fd 43 2a 0b  |..........@g.C*.|
+00000010  14 6b 89 53 84 a8 04 62  d6 30 af 68 eb 8e 2a de  |.k.S...b.0.h..*.|
+00000020  67 c9 40 af 8b ac dd 29  a4 20 e4 da b0 dd c3 05  |g.@....). ......|
+00000030  82 83 8f 75 77 db 6c fe  e7 20 54 e3 eb 51 31 68  |...uw.l.. T..Q1h|
+00000040  da 11 a3 6d a1 34 d9 f5  d1 ef c9                 |...m.4.....|
 >>> Flow 4 (server to client)
 00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000010  00 00 00 00 00 a2 64 88  a2 a3 a9 ca 7a ba 88 8d  |......d.....z...|
-00000020  19 b2 8a 34 5b 72 9e 4e  69 81 e6 65 00 04 49 ac  |...4[r.Ni..e..I.|
-00000030  9f 64 8b 97 32 1c c2 cb  b6 29 be b9 4b e0 b6 0b  |.d..2....)..K...|
-00000040  4e 54 ad 2a c5 15 03 03  00 30 00 00 00 00 00 00  |NT.*.....0......|
-00000050  00 00 00 00 00 00 00 00  00 00 1d 78 fa 81 56 36  |...........x..V6|
-00000060  98 ec b2 f8 3c b8 60 8b  1a c7 92 86 02 c3 bd b6  |....<.`.........|
-00000070  0b 01 78 c9 41 2a 16 a2  fe 0d                    |..x.A*....|
+00000010  00 00 00 00 00 ee e2 75  6f 78 b0 88 1a 8b 9b 91  |.......uox......|
+00000020  c9 8c 3b ae a5 93 71 12  55 66 f8 09 a5 1f 4b 1b  |..;...q.Uf....K.|
+00000030  c2 fe 65 8b 3d d9 dc fa  af dc 29 1b 83 da e0 6a  |..e.=.....)....j|
+00000040  4b cd d0 dc 27                                    |K...'|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ResumeDisabled b/src/crypto/tls/testdata/Server-TLSv12-ResumeDisabled
index cda60afee8..34748371cf 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ResumeDisabled
+++ b/src/crypto/tls/testdata/Server-TLSv12-ResumeDisabled
@@ -1,18 +1,18 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 f9 01 00 00  f5 03 03 d6 dc 77 de b6  |.............w..|
-00000010  db d8 b9 19 e5 8a 59 88  8f ca f7 76 08 1e 41 1f  |......Y....v..A.|
-00000020  ed 8b 3e 54 9c 8c c4 1d  30 fa d6 20 5d 5a dc 87  |..>T....0.. ]Z..|
-00000030  c6 ca 58 3c f2 df 11 66  38 25 03 a7 90 2f 30 ef  |..X<...f8%.../0.|
-00000040  cd 98 f5 48 70 10 ba 94  fb a3 25 58 00 04 00 2f  |...Hp.....%X.../|
+00000000  16 03 01 00 f9 01 00 00  f5 03 03 e8 59 b4 a7 b2  |............Y...|
+00000010  77 86 57 47 0d d7 7b 2b  c1 a2 04 fd 8d 4d e4 f5  |w.WG..{+.....M..|
+00000020  be e2 65 8e 28 9a fe c3  19 fc 43 20 40 38 fb 60  |..e.(.....C @8.`|
+00000030  f8 2f 36 f4 85 1d ee f1  53 f2 90 cf 3c 58 36 cd  |./6.....S...<X6.|
+00000040  bd 22 b4 0c 92 a9 17 56  f9 b4 dd 9b 00 04 00 2f  |.".....V......./|
 00000050  00 ff 01 00 00 a8 00 23  00 78 50 46 ad c1 db a8  |.......#.xPF....|
 00000060  38 86 7b 2b bb fd d0 c3  42 3e 00 00 00 00 00 00  |8.{+....B>......|
 00000070  00 00 00 00 00 00 00 00  00 00 94 6f 2c 9f 83 61  |...........o,..a|
-00000080  60 24 85 1b 46 9d 93 96  8f 27 6f bf 17 0e 2d 0d  |`$..F....'o...-.|
-00000090  f1 3c 3d ce 85 b5 9c 8f  3a 6a c8 b4 e2 a1 03 c9  |.<=.....:j......|
-000000a0  9c 34 72 d5 7e 60 d3 f3  f6 20 d6 0f 1b b9 18 0c  |.4r.~`... ......|
-000000b0  33 94 71 92 ec 74 0e eb  a0 f7 ec 81 b3 d2 63 90  |3.q..t........c.|
-000000c0  b8 0f d9 9e d2 12 aa b5  78 06 7f 1b d3 33 fc d0  |........x....3..|
-000000d0  9c 73 00 0d 00 20 00 1e  06 01 06 02 06 03 05 01  |.s... ..........|
+00000080  2e fe 48 fe f6 bb 98 a0  6f b0 be 9e 86 d7 b2 f2  |..H.....o.......|
+00000090  67 c7 44 c7 3d e4 2b de  d0 f4 d2 17 51 84 8e 7a  |g.D.=.+.....Q..z|
+000000a0  a7 80 c4 65 14 f7 49 09  68 15 56 68 32 41 d1 6f  |...e..I.h.Vh2A.o|
+000000b0  33 94 a1 3a c9 37 20 5d  e6 b0 6f 37 0a 10 e3 28  |3..:.7 ]..o7...(|
+000000c0  e1 34 b6 6d e6 7a 44 24  7f 2f cf 1b ae dd 4c d0  |.4.m.zD$./....L.|
+000000d0  11 75 00 0d 00 20 00 1e  06 01 06 02 06 03 05 01  |.u... ..........|
 000000e0  05 02 05 03 04 01 04 02  04 03 03 01 03 02 03 03  |................|
 000000f0  02 01 02 02 02 03 00 16  00 00 00 17 00 00        |..............|
 >>> Flow 2 (server to client)
@@ -59,31 +59,31 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 4f e7 7f 83 54  |...........O...T|
-00000010  80 1b 49 a5 7c b0 eb 3f  3b 24 74 9a 90 65 ed 2c  |..I.|..?;$t..e.,|
-00000020  30 13 3d 5d 26 91 b6 09  d2 22 f6 5d ed 96 c0 80  |0.=]&....".]....|
-00000030  15 f5 07 87 c3 ee bf 83  19 a4 2f 09 1f dd 05 02  |........../.....|
-00000040  9e 15 de 36 c4 0c ab ff  2e 6b f2 f3 dd 86 18 ea  |...6.....k......|
-00000050  15 8d 96 9f f9 93 26 1d  45 d4 12 c6 40 ab 09 b6  |......&.E...@...|
-00000060  11 dc 74 86 49 58 ce 90  3f 84 ff 47 77 5d 20 22  |..t.IX..?..Gw] "|
-00000070  90 1c d8 cc 18 83 e2 cb  58 20 54 4c 81 c2 0d 3b  |........X TL...;|
-00000080  2c 9a 4b 53 f0 87 61 c2  5e 61 d6 14 03 03 00 01  |,.KS..a.^a......|
-00000090  01 16 03 03 00 40 c2 2e  e7 31 9c 22 4b bf 84 69  |.....@...1."K..i|
-000000a0  fb b9 c1 03 a9 29 93 94  86 2a 57 48 9b 1d 54 99  |.....)...*WH..T.|
-000000b0  d8 89 f4 88 db 93 72 66  8f a2 03 a0 50 9f e0 a4  |......rf....P...|
-000000c0  12 38 83 7d c3 89 20 e4  04 18 82 5a bf 96 19 2d  |.8.}.. ....Z...-|
-000000d0  dc 6a 81 12 e4 cf                                 |.j....|
+00000000  16 03 03 00 86 10 00 00  82 00 80 5e 04 66 f2 27  |...........^.f.'|
+00000010  99 3b f8 15 9f b8 4a ab  8c 32 10 0d 5b c9 5b 0b  |.;....J..2..[.[.|
+00000020  04 69 dc 2b 9e bb 28 38  b6 a0 0f 32 ae 8c 96 64  |.i.+..(8...2...d|
+00000030  63 97 6b b6 63 94 45 84  03 28 d1 d8 85 2f a7 bb  |c.k.c.E..(.../..|
+00000040  be ca 3e f5 30 27 e1 fd  e5 cc bc b5 61 3d 26 8d  |..>.0'......a=&.|
+00000050  0e 93 dd 78 07 5c fe 1b  a9 57 c7 ce e6 df eb 28  |...x.\...W.....(|
+00000060  74 ce 12 f3 df 3f c0 9e  54 b6 e0 b0 ea f7 08 c6  |t....?..T.......|
+00000070  e1 9b cb e7 e9 41 b0 b4  68 2f f2 9b 1a 0a e3 17  |.....A..h/......|
+00000080  df d7 18 ff 95 ca 36 07  32 ff f9 14 03 03 00 01  |......6.2.......|
+00000090  01 16 03 03 00 40 cb c3  74 05 82 ab 93 07 a2 8b  |.....@..t.......|
+000000a0  24 27 c0 21 3e d1 15 12  9a 85 20 5b f5 7e 7e 0a  |$'.!>..... [.~~.|
+000000b0  a0 8e b2 de aa 25 2a b3  3d 12 1b 01 45 ec 36 53  |.....%*.=...E.6S|
+000000c0  32 1d 81 c7 1d a6 96 c2  a9 2e af fa 90 6e 76 bb  |2............nv.|
+000000d0  a2 bc 43 91 c9 ca                                 |..C...|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 8f 66 fd 10 60  |............f..`|
-00000020  f0 28 41 5b 3a 14 9c d6  ba d9 a1 9d 94 20 11 85  |.(A[:........ ..|
-00000030  db 8d 87 00 bb 90 2a 42  68 3d 14 ba b2 ae 25 ca  |......*Bh=....%.|
-00000040  1a 68 3d e8 45 95 52 0f  c1 5c cd 17 03 03 00 40  |.h=.E.R..\.....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 7f 39 4c 83 d4  |............9L..|
+00000020  ca a2 7a a8 eb 3e 45 18  6e 33 3d 6f eb 2d 4f 72  |..z..>E.n3=o.-Or|
+00000030  35 ee c3 f8 22 fd 39 28  47 23 55 16 6c 47 80 b7  |5...".9(G#U.lG..|
+00000040  65 31 15 f6 89 79 96 bd  6a df 1d 17 03 03 00 40  |e1...y..j......@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  62 6a 19 3d 6e b6 c5 fc  9a a2 e9 f8 b2 23 6c ce  |bj.=n........#l.|
-00000070  66 4b e2 c0 b1 72 d7 16  43 19 05 a4 b4 75 01 15  |fK...r..C....u..|
-00000080  93 54 20 37 8e 62 02 5a  0c 68 bc 3c c3 0b d7 37  |.T 7.b.Z.h.<...7|
+00000060  0c ea 0d 87 9a 24 d5 cc  26 9a a2 32 df 04 24 7d  |.....$..&..2..$}|
+00000070  45 ed 35 4e 5b a0 57 c1  c7 f1 0f 8b b0 f9 49 85  |E.5N[.W.......I.|
+00000080  d6 e6 36 26 d5 f3 e4 00  76 d0 d6 20 be b3 31 e5  |..6&....v.. ..1.|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 a2 33 5f  d7 0a 20 20 f6 d1 59 6a  |......3_..  ..Yj|
-000000b0  3e 40 15 da 8f 9f b3 98  63 85 18 46 24 45 40 94  |>@......c..F$E@.|
-000000c0  c8 c6 5e d5 fc                                    |..^..|
+000000a0  00 00 00 00 00 6c 51 e9  c2 e8 4f 43 e2 ce 01 9d  |.....lQ...OC....|
+000000b0  d9 6f d7 c7 bf 16 d9 28  ca 8a ea 5e d5 84 ba 55  |.o.....(...^...U|
+000000c0  b7 23 9d 79 28                                    |.#.y(|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-SNI b/src/crypto/tls/testdata/Server-TLSv12-SNI
index 65bdfa951d..852cc63d03 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-SNI
+++ b/src/crypto/tls/testdata/Server-TLSv12-SNI
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 71 01 00 00  6d 03 03 e8 20 88 32 3c  |....q...m... .2<|
-00000010  30 7c b0 e8 86 e7 08 16  e0 47 4e 4a a9 b8 c6 5e  |0|.......GNJ...^|
-00000020  21 4e 80 31 cf 25 6f 8f  f7 e4 3e 00 00 04 00 2f  |!N.1.%o...>..../|
+00000000  16 03 01 00 71 01 00 00  6d 03 03 35 8f 03 0b f4  |....q...m..5....|
+00000010  81 dd d7 ec 8b cc 85 bd  07 5b 83 16 cc 6e b2 67  |.........[...n.g|
+00000020  fd 33 69 81 14 9a 14 9d  37 43 5a 00 00 04 00 2f  |.3i.....7CZ..../|
 00000030  00 ff 01 00 00 40 00 00  00 10 00 0e 00 00 0b 73  |.....@.........s|
 00000040  6e 69 74 65 73 74 2e 63  6f 6d 00 0d 00 20 00 1e  |nitest.com... ..|
 00000050  06 01 06 02 06 03 05 01  05 02 05 03 04 01 04 02  |................|
@@ -51,31 +51,31 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 4f 68 55 f9 ae  |...........OhU..|
-00000010  17 7b ff 2c c9 d2 87 cb  12 30 3a 4a 55 30 c6 31  |.{.,.....0:JU0.1|
-00000020  9e 3d 1d fd 19 43 cd 07  89 a1 6b ad ac 65 df 9d  |.=...C....k..e..|
-00000030  e7 ff f5 85 8a 5f e3 4e  1a ab 1a 48 65 ee f1 3b  |....._.N...He..;|
-00000040  63 b3 db ab cb 69 13 31  25 dd 7d 31 78 3f 80 48  |c....i.1%.}1x?.H|
-00000050  f4 2f b1 f9 c8 a1 02 bd  10 53 d9 46 90 c4 c2 87  |./.......S.F....|
-00000060  99 44 ad 89 0a b2 9c b2  8e 59 2a 1e 87 9b 79 2d  |.D.......Y*...y-|
-00000070  e0 20 72 95 43 64 b3 6a  c9 25 ec 26 76 ad b2 ff  |. r.Cd.j.%.&v...|
-00000080  24 31 c0 b6 b2 75 8f c7  51 2f 53 14 03 03 00 01  |$1...u..Q/S.....|
-00000090  01 16 03 03 00 40 4c 1c  1d 4c cb b2 dc 2c 37 b4  |.....@L..L...,7.|
-000000a0  c7 dd ab 06 99 b7 4c 81  33 9e ef 07 4a 9a eb 88  |......L.3...J...|
-000000b0  39 c6 bf a6 df 0e 07 62  de 32 80 7f 9b a4 b6 6d  |9......b.2.....m|
-000000c0  77 24 9f 5d 4d 1c 53 68  4f f4 7a da 60 5f b4 e5  |w$.]M.ShO.z.`_..|
-000000d0  61 06 e6 bd 52 15                                 |a...R.|
+00000000  16 03 03 00 86 10 00 00  82 00 80 4c 15 46 23 91  |...........L.F#.|
+00000010  a0 d8 6c 45 f0 49 7e 70  84 9f bf 53 3d 68 2c cc  |..lE.I~p...S=h,.|
+00000020  20 3f 28 bd cf e6 6e fd  e6 90 ff 87 14 82 65 00  | ?(...n.......e.|
+00000030  d6 b6 ef 5a 0c d6 30 76  88 d2 37 33 39 de 00 b4  |...Z..0v..739...|
+00000040  ec dd 30 3b f6 88 ff 4c  b2 98 75 77 fd c3 61 38  |..0;...L..uw..a8|
+00000050  2d 00 f7 14 d8 a4 37 22  c0 db 8a bd 12 0b b8 cc  |-.....7"........|
+00000060  37 82 78 d3 0e f2 0b 9b  51 c5 26 c5 e2 ce 3e 0e  |7.x.....Q.&...>.|
+00000070  04 34 39 83 a8 f5 65 ff  40 d9 9b 4a 11 6b b3 d2  |.49...e.@..J.k..|
+00000080  f7 02 78 a9 7c f4 69 56  3a a4 98 14 03 03 00 01  |..x.|.iV:.......|
+00000090  01 16 03 03 00 40 d6 90  b3 07 d1 a1 c1 12 35 07  |.....@........5.|
+000000a0  4e c0 df 4b 17 cc fa 49  47 c9 22 c3 6f 70 fa ee  |N..K...IG.".op..|
+000000b0  cf b3 61 d6 06 54 cd ce  c2 15 17 8a a0 f6 5c 43  |..a..T........\C|
+000000c0  7c 92 ce 89 d4 96 53 d0  c7 e6 9a 24 bc 5a 83 e5  ||.....S....$.Z..|
+000000d0  9c 65 72 e7 80 a4                                 |.er...|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 2d 65 c0 13 cf  |...........-e...|
-00000020  c5 4e 83 5b c3 6a d9 65  e8 b1 38 16 47 94 61 06  |.N.[.j.e..8.G.a.|
-00000030  28 da 6e 60 c0 0c d8 31  f5 61 58 55 b2 24 61 9a  |(.n`...1.aXU.$a.|
-00000040  21 cb 64 31 3a 08 bb 29  1b 98 f8 17 03 03 00 40  |!.d1:..).......@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 a0 61 69 4c 9d  |............aiL.|
+00000020  68 f3 f8 f6 a0 ef 1b f4  a2 f5 83 fa 03 87 ad 67  |h..............g|
+00000030  7e 9f df c6 ce 9f 69 ce  22 fc de 91 0d 18 00 fb  |~.....i.".......|
+00000040  c1 5d a1 2d bb 89 29 4f  f6 de 57 17 03 03 00 40  |.].-..)O..W....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  71 cd f8 e4 7d dd 2c 03  a5 c9 11 ff 11 d2 19 fd  |q...}.,.........|
-00000070  69 fa 88 a6 f2 cb 64 43  56 e0 d5 a6 eb d4 17 50  |i.....dCV......P|
-00000080  89 dd 34 3c 5d 1e 80 35  06 e9 c3 a0 11 83 41 cc  |..4<]..5......A.|
+00000060  bb 54 f4 80 69 1d 3b 9c  e7 9c 1a fb 4e 3d c1 02  |.T..i.;.....N=..|
+00000070  d3 05 86 35 47 61 59 aa  45 54 ae a2 59 4c 75 8c  |...5GaY.ET..YLu.|
+00000080  8d a9 7d 7f a0 4b d9 65  7a 53 ef 7e ed a3 fa 9e  |..}..K.ezS.~....|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 a1 31 41  88 62 af e7 df b9 9a 3b  |......1A.b.....;|
-000000b0  d7 8a f0 11 0c 2f 9b 6d  c5 91 cf 9f 51 a0 c1 06  |...../.m....Q...|
-000000c0  e4 3f da 7b 7a                                    |.?.{z|
+000000a0  00 00 00 00 00 cc fd 0f  cb 74 a5 36 ce c1 cd 54  |.........t.6...T|
+000000b0  6f 66 81 c0 ab ff 72 ea  f3 1f a6 b7 ef 46 45 68  |of....r......FEh|
+000000c0  9b 0b 7f 4f 46                                    |...OF|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificate b/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificate
index 50b6840e60..b35cd8de26 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificate
+++ b/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificate
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 71 01 00 00  6d 03 03 79 aa a3 4c 5e  |....q...m..y..L^|
-00000010  d3 2a f5 2a 49 d4 18 09  b0 60 b3 8b 5f 36 6e 55  |.*.*I....`.._6nU|
-00000020  9c 96 95 b5 d1 63 02 38  06 c2 21 00 00 04 00 2f  |.....c.8..!..../|
+00000000  16 03 01 00 71 01 00 00  6d 03 03 31 c7 3f 2b 99  |....q...m..1.?+.|
+00000010  95 d8 d5 b7 91 ab 95 c6  09 35 0c 2b bd b6 94 1e  |.........5.+....|
+00000020  64 4a 2d b6 43 23 a0 01  e7 93 22 00 00 04 00 2f  |dJ-.C#...."..../|
 00000030  00 ff 01 00 00 40 00 00  00 10 00 0e 00 00 0b 73  |.....@.........s|
 00000040  6e 69 74 65 73 74 2e 63  6f 6d 00 0d 00 20 00 1e  |nitest.com... ..|
 00000050  06 01 06 02 06 03 05 01  05 02 05 03 04 01 04 02  |................|
@@ -51,31 +51,31 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 06 73 7f 8c 53  |............s..S|
-00000010  81 65 a2 7d 94 f3 dd 38  37 ed 17 8d e5 c4 c0 62  |.e.}...87......b|
-00000020  b8 73 49 e3 91 19 72 af  e3 bf 64 20 40 65 fb 0e  |.sI...r...d @e..|
-00000030  83 72 54 c9 73 ad 2b c9  86 0e d3 7c 8d 82 13 fb  |.rT.s.+....|....|
-00000040  5c 61 61 c5 04 2d 8b c9  55 2f 3e 64 c1 af ba 22  |\aa..-..U/>d..."|
-00000050  1b 6b 26 42 62 f9 e9 e0  3b 91 c7 62 77 ee bf ec  |.k&Bb...;..bw...|
-00000060  03 2f 94 74 42 c2 48 e9  08 89 a9 b4 9f aa f6 d4  |./.tB.H.........|
-00000070  00 fe d9 a4 b2 38 88 b9  8d 60 26 f6 c3 d7 6e ed  |.....8...`&...n.|
-00000080  13 17 46 bf 53 5a 0b 9c  29 4b 1a 14 03 03 00 01  |..F.SZ..)K......|
-00000090  01 16 03 03 00 40 97 ce  83 9d 12 fe 16 f4 26 9c  |.....@........&.|
-000000a0  ac a7 02 0a a9 e6 71 b6  8a 6f 8c 2c d2 5b e7 72  |......q..o.,.[.r|
-000000b0  45 8f e3 56 21 f0 a8 c9  2c ae db 17 88 3b 33 82  |E..V!...,....;3.|
-000000c0  2c 8f 5f ca 33 be 5a ca  13 13 0a 7b a9 72 cc 72  |,._.3.Z....{.r.r|
-000000d0  07 ff c0 c3 7a ef                                 |....z.|
+00000000  16 03 03 00 86 10 00 00  82 00 80 c9 3a 9d ea e3  |............:...|
+00000010  19 f1 07 77 61 ef 5a aa  ed 0f 26 b4 7a 45 db 05  |...wa.Z...&.zE..|
+00000020  bd 51 77 f5 ee 7b c1 83  9c 95 49 7b 70 5e 5b fe  |.Qw..{....I{p^[.|
+00000030  25 d2 3d 64 74 b8 a4 97  fd cb b9 75 7b 8f b0 59  |%.=dt......u{..Y|
+00000040  30 bf b3 41 ce 54 83 0a  ca 29 49 5a fe 29 4c 53  |0..A.T...)IZ.)LS|
+00000050  fb d6 6e 46 d9 f7 31 17  d6 ee f9 ac 41 82 22 11  |..nF..1.....A.".|
+00000060  a7 34 07 41 50 43 2f 83  f6 1f c6 c0 9d 4a 67 5a  |.4.APC/......JgZ|
+00000070  af 44 59 c0 00 33 be 24  f7 0a a4 fe 76 6b 03 05  |.DY..3.$....vk..|
+00000080  2e ec 4d 49 db 6e e5 0a  5f af 09 14 03 03 00 01  |..MI.n.._.......|
+00000090  01 16 03 03 00 40 ad 89  4d 25 a2 ce 98 8c cf b6  |.....@..M%......|
+000000a0  f5 f4 76 6b e7 71 66 4a  f9 a7 67 fb 1d 6c a7 83  |..vk.qfJ..g..l..|
+000000b0  3b 1d 6a af 65 f2 c1 1d  97 03 5b c2 34 ee 3b 8e  |;.j.e.....[.4.;.|
+000000c0  cc bd 8f 3a b8 9b 4f 90  3f de 1e 97 1e 8e 61 37  |...:..O.?.....a7|
+000000d0  2d 30 35 84 3b 26                                 |-05.;&|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 d6 0c 58 67 cc  |.............Xg.|
-00000020  1d d7 70 79 a9 fc 71 23  7f 3f 02 83 64 1c 30 62  |..py..q#.?..d.0b|
-00000030  c8 23 1f f8 30 9d 1a 5e  ad 96 39 2d d3 b0 7d 17  |.#..0..^..9-..}.|
-00000040  7c 8f 10 ee a3 a1 88 0e  66 37 03 17 03 03 00 40  ||.......f7.....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 fe 23 de 33 4b  |............#.3K|
+00000020  55 f2 8e 73 09 ba ae f1  12 bd f7 15 75 90 8f 19  |U..s........u...|
+00000030  1b 19 b6 3f 2c 19 47 87  a9 43 d5 1e 85 fb 0c 90  |...?,.G..C......|
+00000040  c8 18 72 8f 08 6f 48 43  3c 5c 5a 17 03 03 00 40  |..r..oHC<\Z....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  5f da fe 30 21 c9 a4 85  4b a4 0a a6 93 74 ae 92  |_..0!...K....t..|
-00000070  d5 88 9b 39 1a 7e fe 9f  00 19 ad fb ba 7e bd c1  |...9.~.......~..|
-00000080  0a ea 4f 40 3b 76 a0 83  8f f7 77 1f 4d b9 ec c6  |..O@;v....w.M...|
+00000060  4d 44 d7 eb a3 94 00 74  90 9d c0 bd 8e 11 eb b6  |MD.....t........|
+00000070  93 43 c6 14 0d ba c2 aa  f0 f5 2d 85 9a 7c 27 44  |.C........-..|'D|
+00000080  fc d8 46 76 b2 21 4f 70  1a 9a df 9e 3a 8f a3 58  |..Fv.!Op....:..X|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 e6 81 5b  64 4f 8b bc 47 0b 5d 24  |.......[dO..G.]$|
-000000b0  a8 f9 39 82 25 84 4d 57  9d ac 90 d0 3b 6c 4f f0  |..9.%.MW....;lO.|
-000000c0  e1 1c 2c 5a 3e                                    |..,Z>|
+000000a0  00 00 00 00 00 91 0f c3  2a 98 79 57 39 3c 68 98  |........*.yW9<h.|
+000000b0  df 36 12 de e5 15 ee cb  80 ce 33 d9 20 95 33 38  |.6........3. .38|
+000000c0  8b d8 ed 8f 9b                                    |.....|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificateNotFound b/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificateNotFound
index d3ef005bc8..8ba207b253 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificateNotFound
+++ b/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificateNotFound
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 71 01 00 00  6d 03 03 4b 5c 12 23 9d  |....q...m..K\.#.|
-00000010  76 5b 5b 5a 1d dd 71 96  49 fb 11 a8 94 24 7e 0e  |v[[Z..q.I....$~.|
-00000020  39 a4 ba 09 eb 56 1e 04  d7 11 0b 00 00 04 00 2f  |9....V........./|
+00000000  16 03 01 00 71 01 00 00  6d 03 03 f8 16 6b 20 c3  |....q...m....k .|
+00000010  a4 cf fc ca 04 47 7a f9  cc d9 cf 4a 15 ff 6e 82  |.....Gz....J..n.|
+00000020  14 6a 91 91 7f f1 f4 42  e6 7c d4 00 00 04 00 2f  |.j.....B.|...../|
 00000030  00 ff 01 00 00 40 00 00  00 10 00 0e 00 00 0b 73  |.....@.........s|
 00000040  6e 69 74 65 73 74 2e 63  6f 6d 00 0d 00 20 00 1e  |nitest.com... ..|
 00000050  06 01 06 02 06 03 05 01  05 02 05 03 04 01 04 02  |................|
@@ -51,31 +51,31 @@
 00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
 00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 1c fa 6e 9f 45  |.............n.E|
-00000010  74 2e 9b 55 71 0c ba d2  4f 16 62 54 ad 9e 75 77  |t..Uq...O.bT..uw|
-00000020  7e 76 72 0d c5 4d d0 f8  05 0a e9 07 be d7 f3 62  |~vr..M.........b|
-00000030  82 10 14 49 0e 06 38 ff  01 db ac 11 5f 59 b2 ea  |...I..8....._Y..|
-00000040  37 35 3e ae f7 9b 0d bd  8a 16 f5 e2 2b a2 77 b2  |75>.........+.w.|
-00000050  3e cc 75 f6 29 90 d9 c3  4b 3a 1a 75 49 dc c1 30  |>.u.)...K:.uI..0|
-00000060  5e 24 df f5 0f 54 52 33  1b 05 ea df 05 cc fa 0d  |^$...TR3........|
-00000070  f7 42 00 89 1a 6c ea a3  da 63 ef 32 e1 15 b9 c3  |.B...l...c.2....|
-00000080  d2 c5 94 96 fc fd f3 1c  97 0b 1c 14 03 03 00 01  |................|
-00000090  01 16 03 03 00 40 e8 66  12 ca f5 37 2f db c9 03  |.....@.f...7/...|
-000000a0  f1 ef 3e 9c 01 b0 ae a3  11 a2 78 41 63 31 12 38  |..>.......xAc1.8|
-000000b0  6c 8a 59 81 9e a4 a8 da  f0 fb 5f 6f d0 14 ae 18  |l.Y......._o....|
-000000c0  68 f7 8a 0a c7 a1 2e 63  42 b7 9f bd 03 cb c5 6d  |h......cB......m|
-000000d0  f9 39 f9 95 a8 16                                 |.9....|
+00000000  16 03 03 00 86 10 00 00  82 00 80 80 e8 00 cc 09  |................|
+00000010  fc 87 20 9f 2a 38 33 6f  cb 61 71 86 6d 55 6a 87  |.. .*83o.aq.mUj.|
+00000020  e0 22 78 62 4e 3b 98 5c  87 fd 3b 1c 73 d3 77 7e  |."xbN;.\..;.s.w~|
+00000030  a4 c3 6f d4 6d 82 65 40  0e 70 2f 24 e9 7d ff 49  |..o.m.e@.p/$.}.I|
+00000040  c7 bd 45 44 af ae a5 7a  06 06 5e 1e ce 31 73 4b  |..ED...z..^..1sK|
+00000050  4a 38 f0 11 ba 32 58 ab  a5 94 12 13 30 83 95 85  |J8...2X.....0...|
+00000060  f5 7e 8d a7 cc 6d 19 14  f9 b0 dc 64 e5 4d b1 7d  |.~...m.....d.M.}|
+00000070  e6 95 d4 4a 7f 85 11 5b  a7 c9 32 84 c2 ec 2e c3  |...J...[..2.....|
+00000080  40 fe 5c e2 cf 5b 96 8a  72 9f 9f 14 03 03 00 01  |@.\..[..r.......|
+00000090  01 16 03 03 00 40 a8 d2  5b 24 28 2b 86 1e c1 2e  |.....@..[$(+....|
+000000a0  6f da 7a ac 6b bf 02 ea  10 5d 9c 71 fb 19 eb 17  |o.z.k....].q....|
+000000b0  19 b2 07 7c b9 df d0 6d  9f 80 cf 37 a0 2a 18 c9  |...|...m...7.*..|
+000000c0  e9 b5 9f 94 42 6a 6b 33  55 fb 6d 94 3b 79 ed 26  |....Bjk3U.m.;y.&|
+000000d0  5c 5a 7f 68 2c d8                                 |\Z.h,.|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 3a 4c df 03 f5  |...........:L...|
-00000020  8d 52 86 04 3a e2 e4 93  ab 53 24 c6 ba 35 67 8d  |.R..:....S$..5g.|
-00000030  dd f8 f3 23 0a e9 77 ee  91 ff 55 08 55 de 85 ab  |...#..w...U.U...|
-00000040  82 37 8f 25 50 b9 10 e9  0a ec 74 17 03 03 00 40  |.7.%P.....t....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 18 e9 b5 96 14  |................|
+00000020  38 98 d4 23 cd e5 32 0e  09 ae b3 3b 90 a4 4d c2  |8..#..2....;..M.|
+00000030  e5 a8 df 72 e8 97 0b 67  cb 87 f4 d0 3e 52 ca d1  |...r...g....>R..|
+00000040  28 94 ed 88 6c cb 62 53  b2 a1 04 17 03 03 00 40  |(...l.bS.......@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  d9 16 96 1d 60 ac 73 7b  06 1d 8b 53 05 4b eb 4b  |....`.s{...S.K.K|
-00000070  fe 6d fd 6f a7 08 57 68  a6 23 63 b4 dc 32 f4 e3  |.m.o..Wh.#c..2..|
-00000080  10 85 cf 3d 8b e7 dc 7d  3a bc f8 3b 2f 27 60 03  |...=...}:..;/'`.|
+00000060  0e e3 b0 da 4b 19 ca 29  7b 1d c8 e3 0d d7 f2 97  |....K..){.......|
+00000070  b0 0b 6e f0 d2 4b f0 c4  ca 87 75 3c ae 66 e1 b3  |..n..K....u<.f..|
+00000080  06 e3 e6 90 54 fd 31 f7  5d 3b 6f de 0f d5 e4 09  |....T.1.];o.....|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 96 c0 82  ff 64 89 19 76 7e f5 e7  |.........d..v~..|
-000000b0  95 31 76 76 f2 2b a7 c3  f0 4b 5f ec 9b e4 06 73  |.1vv.+...K_....s|
-000000c0  15 7b 7f d3 35                                    |.{..5|
+000000a0  00 00 00 00 00 ee a1 b0  94 b5 86 71 73 66 14 ac  |...........qsf..|
+000000b0  5c 4e 1b 67 27 af db b6  e3 44 15 38 b1 f5 e0 13  |\N.g'....D.8....|
+000000c0  a5 e1 82 c0 6a                                    |....j|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-X25519-ECDHE-RSA-AES-GCM b/src/crypto/tls/testdata/Server-TLSv12-X25519-ECDHE-RSA-AES-GCM
index e84bd94946..89587e9b8d 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-X25519-ECDHE-RSA-AES-GCM
+++ b/src/crypto/tls/testdata/Server-TLSv12-X25519-ECDHE-RSA-AES-GCM
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 73 01 00 00  6f 03 03 56 96 0f 18 d8  |....s...o..V....|
-00000010  69 34 8a 58 8b 70 1e aa  b1 0d 73 72 5a 18 3b 2c  |i4.X.p....srZ.;,|
-00000020  ef 9a f6 ee c9 83 af af  1f e1 04 00 00 04 c0 2f  |.............../|
+00000000  16 03 01 00 73 01 00 00  6f 03 03 33 6d f4 4a 4b  |....s...o..3m.JK|
+00000010  48 35 ef 62 e9 bd 66 90  7e 73 62 bf 93 51 3d 90  |H5.b..f.~sb..Q=.|
+00000020  9e f1 17 ae bd 24 28 54  44 50 8e 00 00 04 c0 2f  |.....$(TDP...../|
 00000030  00 ff 01 00 00 42 00 0b  00 04 03 00 01 02 00 0a  |.....B..........|
 00000040  00 0a 00 08 00 1d 00 17  00 19 00 18 00 0d 00 20  |............... |
 00000050  00 1e 06 01 06 02 06 03  05 01 05 02 05 03 04 01  |................|
@@ -52,28 +52,28 @@
 00000290  3b e9 fa e7 16 03 03 00  ac 0c 00 00 a8 03 00 1d  |;...............|
 000002a0  20 2f e5 7d a3 47 cd 62  43 15 28 da ac 5f bb 29  | /.}.G.bC.(.._.)|
 000002b0  07 30 ff f6 84 af c4 cf  c2 ed 90 99 5f 58 cb 3b  |.0.........._X.;|
-000002c0  74 05 01 00 80 d7 92 17  d2 86 e1 9c 49 01 f6 55  |t...........I..U|
-000002d0  c1 8e 5d a6 71 84 1e 3a  ab 39 0f 6a 08 32 22 c9  |..].q..:.9.j.2".|
-000002e0  4a 42 73 cc a3 1f 1f 40  61 05 a8 5d a5 2e 0a 11  |JBs....@a..]....|
-000002f0  70 be f3 13 f7 d4 3d e3  ea 8c cf 1d cc 14 cd 97  |p.....=.........|
-00000300  00 95 bd 83 f6 38 65 94  b2 bb 87 61 ce 7c 3b da  |.....8e....a.|;.|
-00000310  b3 dc c6 4c c5 9d ca f3  3e dc 08 39 16 ac aa c7  |...L....>..9....|
-00000320  5c a9 d4 94 f1 f0 ca a6  e3 cb 6e e7 9a 85 8b 7f  |\.........n.....|
-00000330  15 cb 7e 0d b8 f8 ab 7f  e4 ed 6b 21 de 64 f7 e3  |..~.......k!.d..|
-00000340  69 9f 8c 4d a4 16 03 03  00 04 0e 00 00 00        |i..M..........|
+000002c0  74 05 01 00 80 61 aa 96  74 97 9f 2a 81 df 73 4d  |t....a..t..*..sM|
+000002d0  58 fb 8b 34 d9 51 02 1d  30 45 98 11 fa 20 cc 48  |X..4.Q..0E... .H|
+000002e0  18 8d 92 4a bc bf 34 c2  52 cc 7b 7d 93 32 f9 98  |...J..4.R.{}.2..|
+000002f0  eb d0 6d 58 4c 24 71 f1  78 cc ee 4d f8 26 26 d3  |..mXL$q.x..M.&&.|
+00000300  b0 1c 46 67 ff 75 fc b5  b3 75 31 f3 9d d6 51 07  |..Fg.u...u1...Q.|
+00000310  7a c1 2f 52 3f 88 23 f2  90 74 d0 77 6d 2b c7 31  |z./R?.#..t.wm+.1|
+00000320  3d 81 a8 b9 84 a6 8f 96  25 91 e8 31 3b e9 20 b8  |=.......%..1;. .|
+00000330  c4 11 68 da 58 0a ee 79  de fe 32 29 d6 24 b0 56  |..h.X..y..2).$.V|
+00000340  ab e8 b5 57 fc 16 03 03  00 04 0e 00 00 00        |...W..........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 91 0e 49 63 be 46  |....%...! ..Ic.F|
-00000010  31 e4 49 bb 7d c2 07 80  84 44 57 96 09 58 63 8f  |1.I.}....DW..Xc.|
-00000020  de f2 ab bc d9 d3 06 26  56 5c 14 03 03 00 01 01  |.......&V\......|
-00000030  16 03 03 00 28 98 e0 60  00 e5 4a 41 c2 e2 61 c9  |....(..`..JA..a.|
-00000040  ff 8f 84 6f e4 3d bb a5  65 6d c9 12 2b 48 26 11  |...o.=..em..+H&.|
-00000050  9d 3a 81 cc 03 e1 7e 90  1a ba fe 89 50           |.:....~.....P|
+00000000  16 03 03 00 25 10 00 00  21 20 eb 0e 38 40 3f 32  |....%...! ..8@?2|
+00000010  a4 95 fb c4 de e5 82 9a  4b 46 37 de 29 e5 6b e6  |........KF7.).k.|
+00000020  44 bf f0 af 0c 62 19 bd  5c 0e 14 03 03 00 01 01  |D....b..\.......|
+00000030  16 03 03 00 28 67 ad 91  f6 8d 8a 39 f7 f2 a6 42  |....(g.....9...B|
+00000040  f2 8c 2f 1d b3 1d dd f1  88 65 7e 66 d2 d9 70 09  |../......e~f..p.|
+00000050  4e 12 90 0d 0b d5 a5 a6  20 bc 32 63 05           |N....... .2c.|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 28 00 00 00 00 00  |..........(.....|
-00000010  00 00 00 17 a9 94 2f 0e  87 92 82 dd 73 8d 52 07  |....../.....s.R.|
-00000020  f7 6f 24 b6 cb a0 2e 3c  63 ec a2 e0 d4 bc 49 9d  |.o$....<c.....I.|
-00000030  08 08 3d 17 03 03 00 25  00 00 00 00 00 00 00 01  |..=....%........|
-00000040  57 5d ae ed 89 fd b1 a8  8c 9c cc ab 42 92 8e 1b  |W]..........B...|
-00000050  83 03 29 be ad e3 25 77  58 ef 15 80 36 15 03 03  |..)...%wX...6...|
-00000060  00 1a 00 00 00 00 00 00  00 02 34 75 6b 24 45 18  |..........4uk$E.|
-00000070  14 11 8a 38 be 71 f7 bf  84 c6 58 41              |...8.q....XA|
+00000010  00 00 00 56 b1 b8 16 9a  27 c6 ee d4 7f b7 68 83  |...V....'.....h.|
+00000020  43 3b 04 92 ec cc c7 db  82 f8 7d 04 64 1d 55 cf  |C;........}.d.U.|
+00000030  02 69 ac 17 03 03 00 25  00 00 00 00 00 00 00 01  |.i.....%........|
+00000040  d6 69 51 5d 3b 00 93 c2  a6 19 97 7d bf a9 d9 96  |.iQ];......}....|
+00000050  43 1d ae 32 c3 52 1a f0  18 ba 10 4c e0 15 03 03  |C..2.R.....L....|
+00000060  00 1a 00 00 00 00 00 00  00 02 1e 8a 5e 37 c0 b1  |............^7..|
+00000070  0d 1e c9 6a 90 23 d6 4c  5c 47 5b bf              |...j.#.L\G[.|
