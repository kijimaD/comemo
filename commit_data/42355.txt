commit e3ccf406231ece59975d999f18f37d1615112aaf
Author: Bryan C. Mills <bcmills@google.com>
Date:   Tue May 12 23:06:14 2020 -0400

    cmd/go: terminate TestScript commands more aggressively when the test times out
    
    - Avoid starting subprocesses when the test is already very close to
      timing out. The overhead of starting and stopping processes may
      cause the test to exceed its deadline even if each individual
      process is signaled soon after it is started.
    
    - If a command does not shut down quickly enough after receiving
      os.Interrupt, send it os.Kill using the same style of grace period
      as in CL 228438.
    
    - Fail the test if a background command whose exit status is not
      ignored is left running at the end of the test. We have no reliable
      way to distinguish a failure due to the termination signal from an
      unexpected failure, and the termination signal varies across
      platforms (so may cause failure on one platform but success on
      another).
    
    For #38797
    
    Change-Id: I767898cf551dca45579bf01a9d1bb312e12d6193
    Reviewed-on: https://go-review.googlesource.com/c/go/+/233526
    Run-TryBot: Bryan C. Mills <bcmills@google.com>
    Reviewed-by: Jay Conrod <jayconrod@google.com>

 src/cmd/go/go_test.go                      |  20 --
 src/cmd/go/script_test.go                  | 283 ++++++++++++++++++++---------
 src/cmd/go/testdata/script/README          |   5 +-
 src/cmd/go/testdata/script/script_wait.txt |   7 +-
 4 files changed, 202 insertions(+), 113 deletions(-)
