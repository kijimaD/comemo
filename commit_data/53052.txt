commit 3635b07d16c9fe3f344b3271fb3bf7029d8b4001
Author: Matthew Dempsky <mdempsky@google.com>
Date:   Tue Jun 28 16:31:29 2022 -0700

    [dev.unified] cmd/compile/internal/noder: implicit conversions for multi-valued expressions
    
    This CL changes GOEXPERIMENT=unified to insert implicit conversions
    for multi-valued expressions.
    
    Unfortunately, IR doesn't have strong, first-class support for
    multi-valued expressions, so this CL takes the approach of spilling
    them to temporary variables, which can then be implicitly converted.
    This is the same approach taken by walk, but doing it this early does
    introduce some minor complications:
    
    1. For select case clauses with comma-ok assignments (e.g., `case x,
    ok := <-ch:`), the compiler middle end wants to see the OAS2RECV
    assignment is the CommClause.Comm statement. So when constructing
    select statements, we need to massage this around a little.
    
    2. The extra temporary variables and assignments skew the existing
    inlining heuristics. As mentioned, the temporaries/assignments will
    eventually be added (and often optimized away again) anyway, but now
    they're visible to the inliner. So this CL also kludges the inlining
    heuristics in this case to keep things comparable.
    
    Change-Id: I3e3ea756ad92472ebe28bae3963be61ed7684a75
    Reviewed-on: https://go-review.googlesource.com/c/go/+/415244
    Reviewed-by: Cuong Manh Le <cuong.manhle.vn@gmail.com>
    Run-TryBot: Matthew Dempsky <mdempsky@google.com>
    Reviewed-by: David Chase <drchase@google.com>
    TryBot-Result: Gopher Robot <gobot@golang.org>

 src/cmd/compile/internal/inline/inl.go   | 30 +++++++++++++++++++++
 src/cmd/compile/internal/noder/reader.go | 45 ++++++++++++++++++++++++++++++--
 src/cmd/compile/internal/noder/writer.go | 26 +++++++++++++++---
 test/escape_iface_unified.go             |  5 ++--
 4 files changed, 97 insertions(+), 9 deletions(-)
