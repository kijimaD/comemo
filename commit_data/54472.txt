commit 09300d89e94da7b1f32742e80768acc711b5c590
Author: Bryan C. Mills <bcmills@google.com>
Date:   Thu Sep 14 09:03:37 2023 -0400

    net/http: synchronize tests that use reqNum counters
    
    This suppresses the race reported in #62638.
    
    I am not 100% certain how that race happens, but here is my theory.
    The increment of reqNum happens before the server writes the response
    headers, and the server necessarily writes the headers before the
    client receives them. However, that write/read pair occurs through I/O
    syscalls rather than Go synchronization primitives, so it doesn't
    necessarily create a “happens before” relationship as defined by the
    Go memory model: although we can establish a sequence of events, that
    sequence is not visible to the race detector, nor to the compiler.
    
    Fixes #62638.
    
    Change-Id: I90d66ec3fc32b9b8e1f9bbf0bc2eb289b964b99b
    Reviewed-on: https://go-review.googlesource.com/c/go/+/528475
    LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
    Reviewed-by: Damien Neil <dneil@google.com>
    Auto-Submit: Bryan Mills <bcmills@google.com>

 src/net/http/serve_test.go | 29 ++++++++++++++++-------------
 1 file changed, 16 insertions(+), 13 deletions(-)
