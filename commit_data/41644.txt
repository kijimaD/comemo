commit e8ecda8a38a1705d2ead985743f287acad34b542
Author: Bryan C. Mills <bcmills@google.com>
Date:   Wed Mar 11 15:14:38 2020 -0400

    context: deflake time-sensitive tests
    
    Many of tests in this package assumed reasonable scheduling latency.
    Unfortunately, scheduling latency on builders and CI systems is not
    always reasonable.
    
    Rather than expecting that a timeout is detected within a fixed short
    interval, we can use (*testing.T).Deadline to portably scale the time
    we're willing to wait to something appropriate to the builder.
    
    Some of the tests also included arbitrary-duration sleeps, which are
    no longer needed after CL 196521; we can remove those instead of
    extending them.
    
    Promptness of timeouts is also an important property, but testing that
    property is better suited to benchmarks than to tests proper: unlike
    tests, we generally expect benchmarks to be run in a quiet,
    low-contention environment.
    
    Fixes #13956
    
    Change-Id: I0797e2267fb778c8ad94add56d797de9e2c885e5
    Reviewed-on: https://go-review.googlesource.com/c/go/+/223019
    Run-TryBot: Bryan C. Mills <bcmills@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Ian Lance Taylor <iant@golang.org>

 src/context/context_test.go | 117 ++++++++++++++++++++++++++++----------------
 1 file changed, 75 insertions(+), 42 deletions(-)
