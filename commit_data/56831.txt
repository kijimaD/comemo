commit 4406ed6d4ea90fe9489bd68c61d330a6d2378498
Author: Filippo Valsorda <filippo@golang.org>
Date:   Wed May 24 01:55:45 2023 +0200

    crypto/tls: implement Extended Master Secret
    
    All OpenSSL tests now test operation with EMS. To test a handshake
    *without* EMS we need to pass -Options=-ExtendedMasterSecret which is
    only available in OpenSSL 3.1, which breaks a number of other tests.
    
    Updates #43922
    
    Change-Id: Ib9ac79a1d03fab6bfba5fe9cd66689cff661cda7
    Reviewed-on: https://go-review.googlesource.com/c/go/+/497376
    Run-TryBot: Filippo Valsorda <filippo@golang.org>
    TryBot-Result: Gopher Robot <gobot@golang.org>
    Reviewed-by: Roland Shoemaker <roland@golang.org>
    Auto-Submit: Filippo Valsorda <filippo@golang.org>
    Reviewed-by: Ian Lance Taylor <iant@google.com>
    Reviewed-by: Damien Neil <dneil@google.com>
---
 api/except.txt                                     |   1 +
 src/crypto/tls/common.go                           |  13 +-
 src/crypto/tls/conn.go                             |   3 +-
 src/crypto/tls/handshake_client.go                 |  27 +-
 src/crypto/tls/handshake_client_tls13.go           |   1 +
 src/crypto/tls/handshake_messages.go               |  16 +
 src/crypto/tls/handshake_messages_test.go          |   9 +
 src/crypto/tls/handshake_server.go                 |  21 +-
 src/crypto/tls/prf.go                              |   9 +
 .../testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA  | 167 +++---
 .../testdata/Client-TLSv10-ClientCert-ECDSA-RSA    | 175 +++---
 .../testdata/Client-TLSv10-ClientCert-RSA-ECDSA    | 167 +++---
 .../tls/testdata/Client-TLSv10-ClientCert-RSA-RSA  | 175 +++---
 .../tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES     | 147 ++---
 .../tls/testdata/Client-TLSv10-ECDHE-RSA-AES       | 155 ++---
 .../testdata/Client-TLSv10-ExportKeyingMaterial    | 155 ++---
 src/crypto/tls/testdata/Client-TLSv10-RSA-RC4      | 122 ++--
 .../tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES     | 147 ++---
 .../tls/testdata/Client-TLSv11-ECDHE-RSA-AES       | 155 ++---
 src/crypto/tls/testdata/Client-TLSv11-RSA-RC4      | 122 ++--
 .../tls/testdata/Client-TLSv12-AES128-GCM-SHA256   | 126 ++--
 .../tls/testdata/Client-TLSv12-AES128-SHA256       | 140 ++---
 .../tls/testdata/Client-TLSv12-AES256-GCM-SHA384   | 126 ++--
 src/crypto/tls/testdata/Client-TLSv12-ALPN         | 150 ++---
 .../testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA  | 177 +++---
 .../testdata/Client-TLSv12-ClientCert-ECDSA-RSA    | 177 +++---
 .../tls/testdata/Client-TLSv12-ClientCert-Ed25519  | 163 +++---
 .../Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384 | 175 +++---
 .../testdata/Client-TLSv12-ClientCert-RSA-ECDSA    | 173 +++---
 .../tls/testdata/Client-TLSv12-ClientCert-RSA-RSA  | 175 +++---
 .../Client-TLSv12-ClientCert-RSA-RSAPKCS1v15       | 169 +++---
 .../testdata/Client-TLSv12-ClientCert-RSA-RSAPSS   | 171 +++---
 .../tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES     | 147 ++---
 .../tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM | 141 ++---
 .../Client-TLSv12-ECDHE-ECDSA-AES128-SHA256        | 155 ++---
 .../Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384    | 141 ++---
 .../Client-TLSv12-ECDHE-ECDSA-CHACHA20-POLY1305    | 138 ++---
 .../tls/testdata/Client-TLSv12-ECDHE-RSA-AES       | 155 ++---
 .../testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256 | 163 +++---
 .../Client-TLSv12-ECDHE-RSA-CHACHA20-POLY1305      | 146 ++---
 src/crypto/tls/testdata/Client-TLSv12-Ed25519      | 101 ++--
 .../testdata/Client-TLSv12-ExportKeyingMaterial    | 145 ++---
 src/crypto/tls/testdata/Client-TLSv12-P256-ECDHE   | 158 ++---
 src/crypto/tls/testdata/Client-TLSv12-RSA-RC4      | 122 ++--
 .../tls/testdata/Client-TLSv12-RenegotiateOnce     | 442 +++++++-------
 .../tls/testdata/Client-TLSv12-RenegotiateTwice    | 633 +++++++++++----------
 .../Client-TLSv12-RenegotiateTwiceRejected         | 448 +++++++--------
 .../testdata/Client-TLSv12-RenegotiationRejected   | 151 ++---
 src/crypto/tls/testdata/Client-TLSv12-SCT          | 147 ++---
 src/crypto/tls/testdata/Client-TLSv12-X25519-ECDHE | 150 ++---
 .../tls/testdata/Client-TLSv13-AES128-SHA256       | 151 ++---
 .../tls/testdata/Client-TLSv13-AES256-SHA384       | 155 ++---
 src/crypto/tls/testdata/Client-TLSv13-ALPN         | 156 ++---
 .../tls/testdata/Client-TLSv13-CHACHA20-SHA256     | 151 ++---
 .../testdata/Client-TLSv13-ClientCert-ECDSA-RSA    | 249 ++++----
 .../tls/testdata/Client-TLSv13-ClientCert-Ed25519  | 215 +++----
 .../testdata/Client-TLSv13-ClientCert-RSA-ECDSA    | 239 ++++----
 .../testdata/Client-TLSv13-ClientCert-RSA-RSAPSS   | 257 ++++-----
 src/crypto/tls/testdata/Client-TLSv13-ECDSA        | 143 ++---
 src/crypto/tls/testdata/Client-TLSv13-Ed25519      | 107 ++--
 .../testdata/Client-TLSv13-ExportKeyingMaterial    | 151 ++---
 .../tls/testdata/Client-TLSv13-HelloRetryRequest   | 168 +++---
 src/crypto/tls/testdata/Client-TLSv13-KeyUpdate    | 167 +++---
 src/crypto/tls/testdata/Client-TLSv13-P256-ECDHE   | 158 ++---
 src/crypto/tls/testdata/Client-TLSv13-X25519-ECDHE | 152 ++---
 .../tls/testdata/Server-TLSv10-ECDHE-ECDSA-AES     | 140 ++---
 .../testdata/Server-TLSv10-ExportKeyingMaterial    | 162 +++---
 src/crypto/tls/testdata/Server-TLSv10-RSA-3DES     | 137 +++--
 src/crypto/tls/testdata/Server-TLSv10-RSA-AES      | 143 +++--
 src/crypto/tls/testdata/Server-TLSv10-RSA-RC4      | 131 +++--
 src/crypto/tls/testdata/Server-TLSv11-RSA-RC4      | 131 +++--
 src/crypto/tls/testdata/Server-TLSv12-ALPN         | 152 ++---
 .../tls/testdata/Server-TLSv12-ALPN-Fallback       | 150 ++---
 .../tls/testdata/Server-TLSv12-ALPN-NotConfigured  | 150 ++---
 .../Server-TLSv12-ClientAuthRequestedAndECDSAGiven | 158 ++---
 ...erver-TLSv12-ClientAuthRequestedAndEd25519Given | 150 ++---
 .../Server-TLSv12-ClientAuthRequestedAndGiven      | 158 ++---
 ...rver-TLSv12-ClientAuthRequestedAndPKCS1v15Given | 158 ++---
 .../Server-TLSv12-ClientAuthRequestedNotGiven      | 140 ++---
 .../tls/testdata/Server-TLSv12-ECDHE-ECDSA-AES     | 138 ++---
 src/crypto/tls/testdata/Server-TLSv12-Ed25519      |  92 +--
 .../testdata/Server-TLSv12-ExportKeyingMaterial    | 166 +++---
 src/crypto/tls/testdata/Server-TLSv12-IssueTicket  | 156 ++---
 .../testdata/Server-TLSv12-IssueTicketPreDisable   | 156 ++---
 src/crypto/tls/testdata/Server-TLSv12-P256         | 160 +++---
 src/crypto/tls/testdata/Server-TLSv12-RSA-3DES     | 144 +++--
 src/crypto/tls/testdata/Server-TLSv12-RSA-AES      | 148 +++--
 src/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM  | 149 +++--
 .../testdata/Server-TLSv12-RSA-AES256-GCM-SHA384   | 149 +++--
 src/crypto/tls/testdata/Server-TLSv12-RSA-RC4      | 138 +++--
 .../tls/testdata/Server-TLSv12-RSA-RSAPKCS1v15     | 136 ++---
 src/crypto/tls/testdata/Server-TLSv12-RSA-RSAPSS   | 136 ++---
 src/crypto/tls/testdata/Server-TLSv12-Resume       |  92 +--
 .../tls/testdata/Server-TLSv12-ResumeDisabled      | 164 +++---
 src/crypto/tls/testdata/Server-TLSv12-SNI          | 149 +++--
 .../tls/testdata/Server-TLSv12-SNI-GetCertificate  | 149 +++--
 .../Server-TLSv12-SNI-GetCertificateNotFound       | 149 +++--
 src/crypto/tls/testdata/Server-TLSv12-X25519       | 152 +++--
 .../tls/testdata/Server-TLSv13-AES128-SHA256       | 166 +++---
 .../tls/testdata/Server-TLSv13-AES256-SHA384       | 172 +++---
 src/crypto/tls/testdata/Server-TLSv13-ALPN         | 168 +++---
 .../tls/testdata/Server-TLSv13-ALPN-Fallback       | 164 +++---
 .../tls/testdata/Server-TLSv13-ALPN-NotConfigured  | 166 +++---
 .../tls/testdata/Server-TLSv13-CHACHA20-SHA256     | 166 +++---
 .../Server-TLSv13-ClientAuthRequestedAndECDSAGiven | 332 +++++------
 ...erver-TLSv13-ClientAuthRequestedAndEd25519Given | 268 ++++-----
 .../Server-TLSv13-ClientAuthRequestedAndGiven      | 325 ++++++-----
 .../Server-TLSv13-ClientAuthRequestedNotGiven      | 178 +++---
 .../tls/testdata/Server-TLSv13-ECDHE-ECDSA-AES     | 158 ++---
 src/crypto/tls/testdata/Server-TLSv13-Ed25519      | 122 ++--
 .../testdata/Server-TLSv13-ExportKeyingMaterial    | 166 +++---
 .../tls/testdata/Server-TLSv13-HelloRetryRequest   | 190 +++----
 src/crypto/tls/testdata/Server-TLSv13-IssueTicket  | 166 +++---
 .../testdata/Server-TLSv13-IssueTicketPreDisable   | 166 +++---
 src/crypto/tls/testdata/Server-TLSv13-P256         | 170 +++---
 src/crypto/tls/testdata/Server-TLSv13-RSA-RSAPSS   | 166 +++---
 src/crypto/tls/testdata/Server-TLSv13-Resume       |  84 +--
 .../Server-TLSv13-Resume-HelloRetryRequest         | 132 ++---
 src/crypto/tls/testdata/Server-TLSv13-X25519       | 166 +++---
 src/crypto/tls/ticket.go                           |  19 +-
 src/crypto/tls/tls_test.go                         |   6 +
 121 files changed, 9367 insertions(+), 9243 deletions(-)

diff --git a/api/except.txt b/api/except.txt
index 5f0178d68a..5acc4d79c7 100644
--- a/api/except.txt
+++ b/api/except.txt
@@ -1,3 +1,4 @@
+pkg crypto/tls, type ConnectionState struct, TLSUnique //deprecated
 pkg debug/elf, const R_PPC64_SECTOFF_LO_DS = 61
 pkg encoding/json, method (*RawMessage) MarshalJSON() ([]uint8, error)
 pkg math, const MaxFloat64 = 1.79769e+308  // 179769313486231570814527423731704356798100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
diff --git a/src/crypto/tls/common.go b/src/crypto/tls/common.go
index 8da3cc50ca..f49cc01760 100644
--- a/src/crypto/tls/common.go
+++ b/src/crypto/tls/common.go
@@ -90,6 +90,7 @@ const (
 	extensionSignatureAlgorithms     uint16 = 13
 	extensionALPN                    uint16 = 16
 	extensionSCT                     uint16 = 18
+	extensionExtendedMasterSecret    uint16 = 23
 	extensionSessionTicket           uint16 = 35
 	extensionPreSharedKey            uint16 = 41
 	extensionEarlyData               uint16 = 42
@@ -271,12 +272,8 @@ type ConnectionState struct {
 	OCSPResponse []byte
 
 	// TLSUnique contains the "tls-unique" channel binding value (see RFC 5929,
-	// Section 3). This value will be nil for TLS 1.3 connections and for all
-	// resumed connections.
-	//
-	// Deprecated: there are conditions in which this value might not be unique
-	// to a connection. See the Security Considerations sections of RFC 5705 and
-	// RFC 7627, and https://mitls.org/pages/attacks/3SHAKE#channelbindings.
+	// Section 3). This value will be nil for TLS 1.3 connections and for
+	// resumed connections that don't support Extended Master Secret (RFC 7627).
 	TLSUnique []byte
 
 	// ekm is a closure exposed via ExportKeyingMaterial.
@@ -287,6 +284,10 @@ type ConnectionState struct {
 // slice as defined in RFC 5705. If context is nil, it is not used as part of
 // the seed. If the connection was set to allow renegotiation via
 // Config.Renegotiation, this function will return an error.
+//
+// There are conditions in which the returned values might not be unique to a
+// connection. See the Security Considerations sections of RFC 5705 and RFC 7627,
+// and https://mitls.org/pages/attacks/3SHAKE#channelbindings.
 func (cs *ConnectionState) ExportKeyingMaterial(label string, context []byte, length int) ([]byte, error) {
 	return cs.ekm(label, context, length)
 }
diff --git a/src/crypto/tls/conn.go b/src/crypto/tls/conn.go
index 1b696183da..8b62dd5bff 100644
--- a/src/crypto/tls/conn.go
+++ b/src/crypto/tls/conn.go
@@ -45,6 +45,7 @@ type Conn struct {
 	// connection so far. If renegotiation is disabled then this is either
 	// zero or one.
 	handshakes       int
+	extMasterSecret  bool
 	didResume        bool // whether this connection was a session resumption
 	cipherSuite      uint16
 	ocspResponse     []byte   // stapled OCSP response
@@ -1606,7 +1607,7 @@ func (c *Conn) connectionStateLocked() ConnectionState {
 	state.VerifiedChains = c.verifiedChains
 	state.SignedCertificateTimestamps = c.scts
 	state.OCSPResponse = c.ocspResponse
-	if !c.didResume && c.vers != VersionTLS13 {
+	if (!c.didResume || c.extMasterSecret) && c.vers != VersionTLS13 {
 		if c.clientFinishedIsFirst {
 			state.TLSUnique = c.clientFinished[:]
 		} else {
diff --git a/src/crypto/tls/handshake_client.go b/src/crypto/tls/handshake_client.go
index dd9f206067..80949f22e2 100644
--- a/src/crypto/tls/handshake_client.go
+++ b/src/crypto/tls/handshake_client.go
@@ -72,6 +72,7 @@ func (c *Conn) makeClientHello() (*clientHelloMsg, *ecdh.PrivateKey, error) {
 		vers:                         clientHelloVersion,
 		compressionMethods:           []uint8{compressionNone},
 		random:                       make([]byte, 32),
+		extendedMasterSecret:         true,
 		ocspStapling:                 true,
 		scts:                         true,
 		serverName:                   hostnameInSNI(config.ServerName),
@@ -645,6 +646,19 @@ func (hs *clientHandshakeState) doFullHandshake() error {
 		}
 	}
 
+	if hs.serverHello.extendedMasterSecret {
+		c.extMasterSecret = true
+		hs.masterSecret = extMasterFromPreMasterSecret(c.vers, hs.suite, preMasterSecret,
+			hs.finishedHash.Sum())
+	} else {
+		hs.masterSecret = masterFromPreMasterSecret(c.vers, hs.suite, preMasterSecret,
+			hs.hello.random, hs.serverHello.random)
+	}
+	if err := c.config.writeKeyLog(keyLogLabelTLS12, hs.hello.random, hs.masterSecret); err != nil {
+		c.sendAlert(alertInternalError)
+		return errors.New("tls: failed to write to key log: " + err.Error())
+	}
+
 	if chainToSend != nil && len(chainToSend.Certificate) > 0 {
 		certVerify := &certificateVerifyMsg{}
 
@@ -692,12 +706,6 @@ func (hs *clientHandshakeState) doFullHandshake() error {
 		}
 	}
 
-	hs.masterSecret = masterFromPreMasterSecret(c.vers, hs.suite, preMasterSecret, hs.hello.random, hs.serverHello.random)
-	if err := c.config.writeKeyLog(keyLogLabelTLS12, hs.hello.random, hs.masterSecret); err != nil {
-		c.sendAlert(alertInternalError)
-		return errors.New("tls: failed to write to key log: " + err.Error())
-	}
-
 	hs.finishedHash.discardHandshakeBuffer()
 
 	return nil
@@ -784,8 +792,15 @@ func (hs *clientHandshakeState) processServerHello() (bool, error) {
 		return false, errors.New("tls: server resumed a session with a different cipher suite")
 	}
 
+	// RFC 7627, Section 5.3
+	if hs.session.extMasterSecret != hs.serverHello.extendedMasterSecret {
+		c.sendAlert(alertHandshakeFailure)
+		return false, errors.New("tls: server resumed a session with a different EMS extension")
+	}
+
 	// Restore master secret and certificates from previous state
 	hs.masterSecret = hs.session.secret
+	c.extMasterSecret = hs.session.extMasterSecret
 	c.peerCertificates = hs.session.peerCertificates
 	c.activeCertHandles = hs.c.activeCertHandles
 	c.verifiedChains = hs.session.verifiedChains
diff --git a/src/crypto/tls/handshake_client_tls13.go b/src/crypto/tls/handshake_client_tls13.go
index 06530ae559..2f59f6888c 100644
--- a/src/crypto/tls/handshake_client_tls13.go
+++ b/src/crypto/tls/handshake_client_tls13.go
@@ -136,6 +136,7 @@ func (hs *clientHandshakeStateTLS13) checkServerHelloOrHRR() error {
 
 	if hs.serverHello.ocspStapling ||
 		hs.serverHello.ticketSupported ||
+		hs.serverHello.extendedMasterSecret ||
 		hs.serverHello.secureRenegotiationSupported ||
 		len(hs.serverHello.secureRenegotiation) != 0 ||
 		len(hs.serverHello.alpnProtocol) != 0 ||
diff --git a/src/crypto/tls/handshake_messages.go b/src/crypto/tls/handshake_messages.go
index 70871b9a90..a86055a060 100644
--- a/src/crypto/tls/handshake_messages.go
+++ b/src/crypto/tls/handshake_messages.go
@@ -84,6 +84,7 @@ type clientHelloMsg struct {
 	supportedSignatureAlgorithmsCert []SignatureScheme
 	secureRenegotiationSupported     bool
 	secureRenegotiation              []byte
+	extendedMasterSecret             bool
 	alpnProtocols                    []string
 	scts                             bool
 	supportedVersions                []uint16
@@ -181,6 +182,11 @@ func (m *clientHelloMsg) marshal() ([]byte, error) {
 			})
 		})
 	}
+	if m.extendedMasterSecret {
+		// RFC 7627
+		exts.AddUint16(extensionExtendedMasterSecret)
+		exts.AddUint16(0) // empty extension_data
+	}
 	if len(m.alpnProtocols) > 0 {
 		// RFC 7301, Section 3.1
 		exts.AddUint16(extensionALPN)
@@ -510,6 +516,9 @@ func (m *clientHelloMsg) unmarshal(data []byte) bool {
 				return false
 			}
 			m.secureRenegotiationSupported = true
+		case extensionExtendedMasterSecret:
+			// RFC 7627
+			m.extendedMasterSecret = true
 		case extensionALPN:
 			// RFC 7301, Section 3.1
 			var protoList cryptobyte.String
@@ -627,6 +636,7 @@ type serverHelloMsg struct {
 	ticketSupported              bool
 	secureRenegotiationSupported bool
 	secureRenegotiation          []byte
+	extendedMasterSecret         bool
 	alpnProtocol                 string
 	scts                         [][]byte
 	supportedVersion             uint16
@@ -662,6 +672,10 @@ func (m *serverHelloMsg) marshal() ([]byte, error) {
 			})
 		})
 	}
+	if m.extendedMasterSecret {
+		exts.AddUint16(extensionExtendedMasterSecret)
+		exts.AddUint16(0) // empty extension_data
+	}
 	if len(m.alpnProtocol) > 0 {
 		exts.AddUint16(extensionALPN)
 		exts.AddUint16LengthPrefixed(func(exts *cryptobyte.Builder) {
@@ -802,6 +816,8 @@ func (m *serverHelloMsg) unmarshal(data []byte) bool {
 				return false
 			}
 			m.secureRenegotiationSupported = true
+		case extensionExtendedMasterSecret:
+			m.extendedMasterSecret = true
 		case extensionALPN:
 			var protoList cryptobyte.String
 			if !extData.ReadUint16LengthPrefixed(&protoList) || protoList.Empty() {
diff --git a/src/crypto/tls/handshake_messages_test.go b/src/crypto/tls/handshake_messages_test.go
index 2785116935..a39cb14301 100644
--- a/src/crypto/tls/handshake_messages_test.go
+++ b/src/crypto/tls/handshake_messages_test.go
@@ -174,6 +174,9 @@ func (*clientHelloMsg) Generate(rand *rand.Rand, size int) reflect.Value {
 		m.secureRenegotiationSupported = true
 		m.secureRenegotiation = randomBytes(rand.Intn(50)+1, rand)
 	}
+	if rand.Intn(10) > 5 {
+		m.extendedMasterSecret = true
+	}
 	for i := 0; i < rand.Intn(5); i++ {
 		m.supportedVersions = append(m.supportedVersions, uint16(rand.Intn(0xffff)+1))
 	}
@@ -236,6 +239,9 @@ func (*serverHelloMsg) Generate(rand *rand.Rand, size int) reflect.Value {
 		m.secureRenegotiationSupported = true
 		m.secureRenegotiation = randomBytes(rand.Intn(50)+1, rand)
 	}
+	if rand.Intn(10) > 5 {
+		m.extendedMasterSecret = true
+	}
 	if rand.Intn(10) > 5 {
 		m.supportedVersion = uint16(rand.Intn(0xffff) + 1)
 	}
@@ -353,6 +359,9 @@ func (*SessionState) Generate(rand *rand.Rand, size int) reflect.Value {
 	if rand.Intn(10) > 5 {
 		s.EarlyData = true
 	}
+	if rand.Intn(10) > 5 {
+		s.extMasterSecret = true
+	}
 	if s.isClient || rand.Intn(10) > 5 {
 		if rand.Intn(10) > 5 {
 			s.peerCertificates = sessionTestCerts
diff --git a/src/crypto/tls/handshake_server.go b/src/crypto/tls/handshake_server.go
index ef33ab8d84..a81ecb7f44 100644
--- a/src/crypto/tls/handshake_server.go
+++ b/src/crypto/tls/handshake_server.go
@@ -214,6 +214,7 @@ func (hs *serverHandshakeState) processClientHello() error {
 		return errors.New("tls: initial handshake had non-empty renegotiation extension")
 	}
 
+	hs.hello.extendedMasterSecret = hs.clientHello.extendedMasterSecret
 	hs.hello.secureRenegotiationSupported = hs.clientHello.secureRenegotiationSupported
 	hs.hello.compressionMethod = compressionNone
 	if len(hs.clientHello.serverName) > 0 {
@@ -471,6 +472,17 @@ func (hs *serverHandshakeState) checkForResumption() error {
 		return nil
 	}
 
+	// RFC 7627, Section 5.3
+	if !sessionState.extMasterSecret && hs.clientHello.extendedMasterSecret {
+		return nil
+	}
+	if sessionState.extMasterSecret && !hs.clientHello.extendedMasterSecret {
+		// Aborting is somewhat harsh, but it's a MUST and it would indicate a
+		// weird downgrade in client capabilities.
+		return errors.New("tls: session supported extended_master_secret but client does not")
+	}
+
+	c.extMasterSecret = sessionState.extMasterSecret
 	hs.sessionState = sessionState
 	hs.suite = suite
 	c.didResume = true
@@ -647,7 +659,14 @@ func (hs *serverHandshakeState) doFullHandshake() error {
 		c.sendAlert(alertHandshakeFailure)
 		return err
 	}
-	hs.masterSecret = masterFromPreMasterSecret(c.vers, hs.suite, preMasterSecret, hs.clientHello.random, hs.hello.random)
+	if hs.hello.extendedMasterSecret {
+		c.extMasterSecret = true
+		hs.masterSecret = extMasterFromPreMasterSecret(c.vers, hs.suite, preMasterSecret,
+			hs.finishedHash.Sum())
+	} else {
+		hs.masterSecret = masterFromPreMasterSecret(c.vers, hs.suite, preMasterSecret,
+			hs.clientHello.random, hs.hello.random)
+	}
 	if err := c.config.writeKeyLog(keyLogLabelTLS12, hs.clientHello.random, hs.masterSecret); err != nil {
 		c.sendAlert(alertInternalError)
 		return err
diff --git a/src/crypto/tls/prf.go b/src/crypto/tls/prf.go
index b60166dee3..20bac96e86 100644
--- a/src/crypto/tls/prf.go
+++ b/src/crypto/tls/prf.go
@@ -80,6 +80,7 @@ const (
 )
 
 var masterSecretLabel = []byte("master secret")
+var extendedMasterSecretLabel = []byte("extended master secret")
 var keyExpansionLabel = []byte("key expansion")
 var clientFinishedLabel = []byte("client finished")
 var serverFinishedLabel = []byte("server finished")
@@ -115,6 +116,14 @@ func masterFromPreMasterSecret(version uint16, suite *cipherSuite, preMasterSecr
 	return masterSecret
 }
 
+// extMasterFromPreMasterSecret generates the extended master secret from the
+// pre-master secret. See RFC 7627.
+func extMasterFromPreMasterSecret(version uint16, suite *cipherSuite, preMasterSecret, transcript []byte) []byte {
+	masterSecret := make([]byte, masterSecretLength)
+	prfForVersion(version, suite)(masterSecret, preMasterSecret, extendedMasterSecretLabel, transcript)
+	return masterSecret
+}
+
 // keysFromMasterSecret generates the connection keys from the master
 // secret, given the lengths of the MAC key, cipher key and IV, as defined in
 // RFC 2246, Section 6.3.
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA
index d93f679d6b..e018e87b0a 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,68 +7,69 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 59 02 00 00  55 03 01 f1 70 ef e1 e5  |....Y...U...p...|
-00000010  96 73 83 d3 e2 b9 53 7e  81 ae 1d 40 24 5a ca f2  |.s....S~...@$Z..|
-00000020  06 b3 b6 01 e4 02 fb 81  bc d9 3d 20 1f 1a f0 b5  |..........= ....|
-00000030  b2 93 42 da 00 4d bf f6  dc 99 54 8d 3b 17 a4 74  |..B..M....T.;..t|
-00000040  ca 93 e1 5c a9 c4 d1 35  af f2 d8 f9 c0 09 00 00  |...\...5........|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  01 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
-00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
-00000080  30 09 06 07 2a 86 48 ce  3d 04 01 30 45 31 0b 30  |0...*.H.=..0E1.0|
-00000090  09 06 03 55 04 06 13 02  41 55 31 13 30 11 06 03  |...U....AU1.0...|
-000000a0  55 04 08 13 0a 53 6f 6d  65 2d 53 74 61 74 65 31  |U....Some-State1|
-000000b0  21 30 1f 06 03 55 04 0a  13 18 49 6e 74 65 72 6e  |!0...U....Intern|
-000000c0  65 74 20 57 69 64 67 69  74 73 20 50 74 79 20 4c  |et Widgits Pty L|
-000000d0  74 64 30 1e 17 0d 31 32  31 31 32 32 31 35 30 36  |td0...1211221506|
-000000e0  33 32 5a 17 0d 32 32 31  31 32 30 31 35 30 36 33  |32Z..22112015063|
-000000f0  32 5a 30 45 31 0b 30 09  06 03 55 04 06 13 02 41  |2Z0E1.0...U....A|
-00000100  55 31 13 30 11 06 03 55  04 08 13 0a 53 6f 6d 65  |U1.0...U....Some|
-00000110  2d 53 74 61 74 65 31 21  30 1f 06 03 55 04 0a 13  |-State1!0...U...|
-00000120  18 49 6e 74 65 72 6e 65  74 20 57 69 64 67 69 74  |.Internet Widgit|
-00000130  73 20 50 74 79 20 4c 74  64 30 81 9b 30 10 06 07  |s Pty Ltd0..0...|
-00000140  2a 86 48 ce 3d 02 01 06  05 2b 81 04 00 23 03 81  |*.H.=....+...#..|
-00000150  86 00 04 00 c4 a1 ed be  98 f9 0b 48 73 36 7e c3  |...........Hs6~.|
-00000160  16 56 11 22 f2 3d 53 c3  3b 4d 21 3d cd 6b 75 e6  |.V.".=S.;M!=.ku.|
-00000170  f6 b0 dc 9a df 26 c1 bc  b2 87 f0 72 32 7c b3 64  |.....&.....r2|.d|
-00000180  2f 1c 90 bc ea 68 23 10  7e fe e3 25 c0 48 3a 69  |/....h#.~..%.H:i|
-00000190  e0 28 6d d3 37 00 ef 04  62 dd 0d a0 9c 70 62 83  |.(m.7...b....pb.|
-000001a0  d8 81 d3 64 31 aa 9e 97  31 bd 96 b0 68 c0 9b 23  |...d1...1...h..#|
-000001b0  de 76 64 3f 1a 5c 7f e9  12 0e 58 58 b6 5f 70 dd  |.vd?.\....XX._p.|
-000001c0  9b d8 ea d5 d7 f5 d5 cc  b9 b6 9f 30 66 5b 66 9a  |...........0f[f.|
-000001d0  20 e2 27 e5 bf fe 3b 30  09 06 07 2a 86 48 ce 3d  | .'...;0...*.H.=|
-000001e0  04 01 03 81 8c 00 30 81  88 02 42 01 88 a2 4f eb  |......0...B...O.|
-000001f0  e2 45 c5 48 7d 1b ac f5  ed 98 9d ae 47 70 c0 5e  |.E.H}.......Gp.^|
-00000200  1b b6 2f bd f1 b6 4d b7  61 40 d3 11 a2 ce ee 0b  |../...M.a@......|
-00000210  7e 92 7e ff 76 9d c3 3b  7e a5 3f ce fa 10 e2 59  |~.~.v..;~.?....Y|
-00000220  ec 47 2d 7c ac da 4e 97  0e 15 a0 6f d0 02 42 01  |.G-|..N....o..B.|
-00000230  4d fc be 67 13 9c 2d 05  0e bd 3f a3 8c 25 c1 33  |M..g..-...?..%.3|
-00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
-00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
-00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 01 00 b5 0c 00  00 b1 03 00 1d 20 f0 8c  |*............ ..|
-00000280  cd 6a c2 7a ea f0 2b 4a  34 6d a9 3b 7a 29 5d 04  |.j.z..+J4m.;z)].|
-00000290  65 70 97 30 e7 10 6e c2  7e 50 c5 89 4a 3f 00 8b  |ep.0..n.~P..J?..|
-000002a0  30 81 88 02 42 00 be e2  67 30 f0 8a cb 63 6c 13  |0...B...g0...cl.|
-000002b0  e0 4e 88 52 6e bc e4 83  53 f4 18 75 b7 46 a5 46  |.N.Rn...S..u.F.F|
-000002c0  11 f1 4b f9 bd 58 4e 62  5c fb a8 f2 93 99 3c 94  |..K..XNb\.....<.|
-000002d0  18 1d 7a f1 74 bf 9d c6  fe 65 b1 bc 54 2b c7 ba  |..z.t....e..T+..|
-000002e0  f7 45 a8 0a 21 ad 23 02  42 01 c8 fd 48 62 e2 5e  |.E..!.#.B...Hb.^|
-000002f0  f1 9c 95 c0 28 c4 c5 04  31 e5 ba a5 3c 09 d9 d7  |....(...1...<...|
-00000300  43 aa 8c 35 26 ed 47 57  6d c6 15 86 50 3c 72 e1  |C..5&.GWm...P<r.|
-00000310  6f 2b 85 63 97 5e 20 58  fc cf 0c f9 37 27 42 fb  |o+.c.^ X....7'B.|
-00000320  cd ed c3 40 ac 5f d9 06  5c a3 27 16 03 01 00 0a  |...@._..\.'.....|
-00000330  0d 00 00 06 03 01 02 40  00 00 16 03 01 00 04 0e  |.......@........|
-00000340  00 00 00                                          |...|
+00000000  16 03 01 00 5d 02 00 00  59 03 01 8d 16 c0 c7 69  |....]...Y......i|
+00000010  4a 19 df eb e0 a2 f1 43  43 d6 4a ac 8c cd ee 58  |J......CC.J....X|
+00000020  2e f9 f2 7d d2 61 df 54  0c e8 4e 20 2e 1c 65 31  |...}.a.T..N ..e1|
+00000030  60 6d 7f f9 10 9b fd d1  31 fa 0c 45 01 ca 06 e3  |`m......1..E....|
+00000040  30 9a ab b4 b7 96 b3 99  de 8c 10 84 c0 09 00 00  |0...............|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 01 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
+00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
+00000080  a0 d2 eb f4 30 09 06 07  2a 86 48 ce 3d 04 01 30  |....0...*.H.=..0|
+00000090  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+000000a0  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+000000b0  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+000000c0  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+000000d0  74 79 20 4c 74 64 30 1e  17 0d 31 32 31 31 32 32  |ty Ltd0...121122|
+000000e0  31 35 30 36 33 32 5a 17  0d 32 32 31 31 32 30 31  |150632Z..2211201|
+000000f0  35 30 36 33 32 5a 30 45  31 0b 30 09 06 03 55 04  |50632Z0E1.0...U.|
+00000100  06 13 02 41 55 31 13 30  11 06 03 55 04 08 13 0a  |...AU1.0...U....|
+00000110  53 6f 6d 65 2d 53 74 61  74 65 31 21 30 1f 06 03  |Some-State1!0...|
+00000120  55 04 0a 13 18 49 6e 74  65 72 6e 65 74 20 57 69  |U....Internet Wi|
+00000130  64 67 69 74 73 20 50 74  79 20 4c 74 64 30 81 9b  |dgits Pty Ltd0..|
+00000140  30 10 06 07 2a 86 48 ce  3d 02 01 06 05 2b 81 04  |0...*.H.=....+..|
+00000150  00 23 03 81 86 00 04 00  c4 a1 ed be 98 f9 0b 48  |.#.............H|
+00000160  73 36 7e c3 16 56 11 22  f2 3d 53 c3 3b 4d 21 3d  |s6~..V.".=S.;M!=|
+00000170  cd 6b 75 e6 f6 b0 dc 9a  df 26 c1 bc b2 87 f0 72  |.ku......&.....r|
+00000180  32 7c b3 64 2f 1c 90 bc  ea 68 23 10 7e fe e3 25  |2|.d/....h#.~..%|
+00000190  c0 48 3a 69 e0 28 6d d3  37 00 ef 04 62 dd 0d a0  |.H:i.(m.7...b...|
+000001a0  9c 70 62 83 d8 81 d3 64  31 aa 9e 97 31 bd 96 b0  |.pb....d1...1...|
+000001b0  68 c0 9b 23 de 76 64 3f  1a 5c 7f e9 12 0e 58 58  |h..#.vd?.\....XX|
+000001c0  b6 5f 70 dd 9b d8 ea d5  d7 f5 d5 cc b9 b6 9f 30  |._p............0|
+000001d0  66 5b 66 9a 20 e2 27 e5  bf fe 3b 30 09 06 07 2a  |f[f. .'...;0...*|
+000001e0  86 48 ce 3d 04 01 03 81  8c 00 30 81 88 02 42 01  |.H.=......0...B.|
+000001f0  88 a2 4f eb e2 45 c5 48  7d 1b ac f5 ed 98 9d ae  |..O..E.H}.......|
+00000200  47 70 c0 5e 1b b6 2f bd  f1 b6 4d b7 61 40 d3 11  |Gp.^../...M.a@..|
+00000210  a2 ce ee 0b 7e 92 7e ff  76 9d c3 3b 7e a5 3f ce  |....~.~.v..;~.?.|
+00000220  fa 10 e2 59 ec 47 2d 7c  ac da 4e 97 0e 15 a0 6f  |...Y.G-|..N....o|
+00000230  d0 02 42 01 4d fc be 67  13 9c 2d 05 0e bd 3f a3  |..B.M..g..-...?.|
+00000240  8c 25 c1 33 13 83 0d 94  06 bb d4 37 7a f6 ec 7a  |.%.3.......7z..z|
+00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
+00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
+00000270  95 12 07 8f 2a 16 03 01  00 b5 0c 00 00 b1 03 00  |....*...........|
+00000280  1d 20 2a 39 4c 47 2f 16  34 c1 2b 55 8b 1f 26 bb  |. *9LG/.4.+U..&.|
+00000290  f7 27 e1 e1 6c 62 e3 76  16 ed ff 23 bf 07 09 3c  |.'..lb.v...#...<|
+000002a0  24 1c 00 8b 30 81 88 02  42 01 34 ea 39 ef 28 c1  |$...0...B.4.9.(.|
+000002b0  f9 00 fc a9 37 0e a8 ce  4e 17 0e 8d c3 3d 27 9b  |....7...N....='.|
+000002c0  87 ce b2 d1 31 e3 82 9b  7b e6 40 19 c9 da ba 7f  |....1...{.@.....|
+000002d0  03 f9 57 01 c9 f0 28 66  64 1a f6 f7 6a 67 09 b4  |..W...(fd...jg..|
+000002e0  b9 c7 ef 1f 37 fd 7c 04  ba 4e ef 02 42 00 e1 15  |....7.|..N..B...|
+000002f0  c9 22 ae 13 8d bc 24 26  ce 62 09 9e c4 95 80 65  |."....$&.b.....e|
+00000300  b3 dc a4 df 98 c8 cd 95  8c 55 c7 af 27 b1 31 2c  |.........U..'.1,|
+00000310  df 62 72 47 b4 e8 df 76  43 16 60 7f 42 60 b0 eb  |.brG...vC.`.B`..|
+00000320  b8 f7 75 75 ef d6 7e aa  d9 c5 9c 9d f0 0d d8 16  |..uu..~.........|
+00000330  03 01 00 0a 0d 00 00 06  03 01 02 40 00 00 16 03  |...........@....|
+00000340  01 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 01 02 0a 0b 00 02  06 00 02 03 00 02 00 30  |...............0|
 00000010  82 01 fc 30 82 01 5e 02  09 00 9a 30 84 6c 26 35  |...0..^....0.l&5|
@@ -106,29 +107,29 @@
 00000210  03 01 00 25 10 00 00 21  20 2f e5 7d a3 47 cd 62  |...%...! /.}.G.b|
 00000220  43 15 28 da ac 5f bb 29  07 30 ff f6 84 af c4 cf  |C.(.._.).0......|
 00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 01 00 91 0f 00  |...._X.;t.......|
-00000240  00 8d 00 8b 30 81 88 02  42 01 4c 44 9a a6 7e 6e  |....0...B.LD..~n|
-00000250  8a f0 40 c0 63 cf 50 4d  1c 36 55 c2 ae 89 19 5a  |..@.c.PM.6U....Z|
-00000260  3f ef 2b 2e 0d 66 4f fe  c2 cb 17 86 7c a1 2c e9  |?.+..fO.....|.,.|
-00000270  d8 44 b6 45 36 cc 3a 29  74 19 3c 98 c1 f6 8f 9c  |.D.E6.:)t.<.....|
-00000280  bb 29 fa ae d5 73 de c8  b3 27 7f 02 42 01 86 c9  |.)...s...'..B...|
-00000290  9d e6 1d 45 8b 35 7d ee  7d de ce 4b 15 40 1e 26  |...E.5}.}..K.@.&|
-000002a0  95 eb 8e b2 6d ac a3 52  b3 fe bc 9d 2b 61 1a 41  |....m..R....+a.A|
-000002b0  5c b5 e5 c0 df 3f 5b 84  4b d6 b2 c5 3a 15 05 0d  |\....?[.K...:...|
-000002c0  3f 0a 6e d7 8d 49 35 50  67 3e 6e c5 a7 ba 84 14  |?.n..I5Pg>n.....|
-000002d0  03 01 00 01 01 16 03 01  00 30 91 e2 f5 b4 fc 0d  |.........0......|
-000002e0  43 92 f1 18 99 68 d8 4d  94 ab e0 87 60 e5 46 e3  |C....h.M....`.F.|
-000002f0  dd b8 0c b5 c6 5b 73 ba  ae e7 7f 0c 6d 6d 94 e7  |.....[s.....mm..|
-00000300  e2 21 c5 5c 0e b9 e6 c7  88 92                    |.!.\......|
+00000240  00 8d 00 8b 30 81 88 02  42 01 9a ce de b0 79 2f  |....0...B.....y/|
+00000250  8b f3 6a ab 71 75 38 58  6a 85 d5 eb 60 ee de d0  |..j.qu8Xj...`...|
+00000260  c8 61 46 fc 41 2a d7 dd  b5 db cd d8 74 4e a2 62  |.aF.A*......tN.b|
+00000270  c8 a5 1c f6 62 7a 04 ea  0b 70 39 cd 68 75 d2 b6  |....bz...p9.hu..|
+00000280  cc f9 71 ee f2 cc 9a a2  12 78 bc 02 42 01 4d 03  |..q......x..B.M.|
+00000290  1a 75 bb 13 64 ab 08 c5  fb f3 ff 18 74 c5 25 dd  |.u..d.......t.%.|
+000002a0  27 99 5b ad 76 7a a7 e2  4d a7 1d d7 ba 6e e4 e7  |'.[.vz..M....n..|
+000002b0  32 00 70 4a 35 6c c4 bb  03 5b 83 d5 e5 fc 53 e4  |2.pJ5l...[....S.|
+000002c0  7e 1b f3 e7 18 79 b3 d4  76 ac 0f 74 6e 8f f7 14  |~....y..v..tn...|
+000002d0  03 01 00 01 01 16 03 01  00 30 1a 3f 4b ba 4c e4  |.........0.?K.L.|
+000002e0  6d 21 25 4d 90 2b 94 01  2b 82 f6 0a 0f a9 f9 95  |m!%M.+..+.......|
+000002f0  03 1f 13 ee cf 27 d2 84  8a 59 cd ca 8d a8 c1 07  |.....'...Y......|
+00000300  3f f6 c3 2b d5 91 21 2a  84 23                    |?..+..!*.#|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 24 93 c5 b1 d0  |..........0$....|
-00000010  bf 5e 5c 79 18 91 d4 c2  5d 82 bd b9 77 44 a8 75  |.^\y....]...wD.u|
-00000020  2a aa 22 c1 71 79 4c ad  7f 95 1f 94 b7 2b 5d cb  |*.".qyL......+].|
-00000030  85 57 0a 7e 55 f1 56 4b  98 da b8                 |.W.~U.VK...|
+00000000  14 03 01 00 01 01 16 03  01 00 30 ac 6a 3b cf 6b  |..........0.j;.k|
+00000010  fc d7 25 1d ee d1 c0 61  65 73 be df 21 65 07 b8  |..%....aes..!e..|
+00000020  9d 88 13 b9 b2 23 9c 90  a5 b4 71 31 75 b9 2e 97  |.....#....q1u...|
+00000030  73 a1 c0 85 cc 6c f5 ac  49 2e 5f                 |s....l..I._|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 21 19 00  1b 74 03 79 83 6a cf 87  |.... !...t.y.j..|
-00000010  c5 1f c6 e6 ff 1c 8d 9e  a9 2b 3c 7e e5 e0 d5 b5  |.........+<~....|
-00000020  c0 d5 1a 84 45 17 03 01  00 20 77 40 7e ac d0 9e  |....E.... w@~...|
-00000030  d1 86 73 26 d2 c6 a0 a4  94 9e d7 7e 28 59 5c b2  |..s&.......~(Y\.|
-00000040  9f 4d fa c5 c9 b7 a2 b2  b1 7b 15 03 01 00 20 59  |.M.......{.... Y|
-00000050  aa 2f 3f 2c 20 f1 15 ef  24 95 29 66 c0 48 78 00  |./?, ...$.)f.Hx.|
-00000060  19 d6 1e 95 af 83 03 6e  d8 c7 8e bb c3 54 02     |.......n.....T.|
+00000000  17 03 01 00 20 46 71 8d  32 ba c1 05 5c 59 bc 82  |.... Fq.2...\Y..|
+00000010  e1 bc 6f eb de 23 26 8d  9c b2 b4 e8 c8 69 f3 46  |..o..#&......i.F|
+00000020  0b 07 61 69 ae 17 03 01  00 20 e5 a5 ea 4c 59 7d  |..ai..... ...LY}|
+00000030  74 cd b8 0a 66 b6 ec 95  b0 8a 86 3a 9c e3 f5 11  |t...f......:....|
+00000040  5b 05 62 9a ce 2e 87 8e  41 f4 15 03 01 00 20 be  |[.b.....A..... .|
+00000050  0a 29 47 93 e8 ef ad d4  5d f9 e1 a4 46 1a 51 98  |.)G.....]...F.Q.|
+00000060  f0 8c be 3b fc cc a0 ed  7c 18 ac bf 94 35 93     |...;....|....5.|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA
index afe6e10906..364d33d869 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-ECDSA-RSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,72 +7,73 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 59 02 00 00  55 03 01 b5 1a 96 ea d5  |....Y...U.......|
-00000010  01 ef fb 42 1d 49 e1 1b  7c e4 15 ec cc 7f b9 fc  |...B.I..|.......|
-00000020  22 e0 0b 1d 66 0e c8 d6  9b cd ec 20 d5 2b fe 9a  |"...f...... .+..|
-00000030  f7 e7 10 1c c4 15 10 f1  24 8d 8f f6 25 90 aa 1c  |........$...%...|
-00000040  10 c4 87 c6 36 23 5b 6a  c1 ae 20 5e c0 13 00 00  |....6#[j.. ^....|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  01 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
-00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
-00000080  3f e2 5b ea a6 30 0d 06  09 2a 86 48 86 f7 0d 01  |?.[..0...*.H....|
-00000090  01 0b 05 00 30 1f 31 0b  30 09 06 03 55 04 0a 13  |....0.1.0...U...|
-000000a0  02 47 6f 31 10 30 0e 06  03 55 04 03 13 07 47 6f  |.Go1.0...U....Go|
-000000b0  20 52 6f 6f 74 30 1e 17  0d 31 36 30 31 30 31 30  | Root0...1601010|
-000000c0  30 30 30 30 30 5a 17 0d  32 35 30 31 30 31 30 30  |00000Z..25010100|
-000000d0  30 30 30 30 5a 30 1a 31  0b 30 09 06 03 55 04 0a  |0000Z0.1.0...U..|
-000000e0  13 02 47 6f 31 0b 30 09  06 03 55 04 03 13 02 47  |..Go1.0...U....G|
-000000f0  6f 30 81 9f 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |o0..0...*.H.....|
-00000100  01 05 00 03 81 8d 00 30  81 89 02 81 81 00 db 46  |.......0.......F|
-00000110  7d 93 2e 12 27 06 48 bc  06 28 21 ab 7e c4 b6 a2  |}...'.H..(!.~...|
-00000120  5d fe 1e 52 45 88 7a 36  47 a5 08 0d 92 42 5b c2  |]..RE.z6G....B[.|
-00000130  81 c0 be 97 79 98 40 fb  4f 6d 14 fd 2b 13 8b c2  |....y.@.Om..+...|
-00000140  a5 2e 67 d8 d4 09 9e d6  22 38 b7 4a 0b 74 73 2b  |..g....."8.J.ts+|
-00000150  c2 34 f1 d1 93 e5 96 d9  74 7b f3 58 9f 6c 61 3c  |.4......t{.X.la<|
-00000160  c0 b0 41 d4 d9 2b 2b 24  23 77 5b 1c 3b bd 75 5d  |..A..++$#w[.;.u]|
-00000170  ce 20 54 cf a1 63 87 1d  1e 24 c4 f3 1d 1a 50 8b  |. T..c...$....P.|
-00000180  aa b6 14 43 ed 97 a7 75  62 f4 14 c8 52 d7 02 03  |...C...ub...R...|
-00000190  01 00 01 a3 81 93 30 81  90 30 0e 06 03 55 1d 0f  |......0..0...U..|
-000001a0  01 01 ff 04 04 03 02 05  a0 30 1d 06 03 55 1d 25  |.........0...U.%|
-000001b0  04 16 30 14 06 08 2b 06  01 05 05 07 03 01 06 08  |..0...+.........|
-000001c0  2b 06 01 05 05 07 03 02  30 0c 06 03 55 1d 13 01  |+.......0...U...|
-000001d0  01 ff 04 02 30 00 30 19  06 03 55 1d 0e 04 12 04  |....0.0...U.....|
-000001e0  10 9f 91 16 1f 43 43 3e  49 a6 de 6d b6 80 d7 9f  |.....CC>I..m....|
-000001f0  60 30 1b 06 03 55 1d 23  04 14 30 12 80 10 48 13  |`0...U.#..0...H.|
-00000200  49 4d 13 7e 16 31 bb a3  01 d5 ac ab 6e 7b 30 19  |IM.~.1......n{0.|
-00000210  06 03 55 1d 11 04 12 30  10 82 0e 65 78 61 6d 70  |..U....0...examp|
-00000220  6c 65 2e 67 6f 6c 61 6e  67 30 0d 06 09 2a 86 48  |le.golang0...*.H|
-00000230  86 f7 0d 01 01 0b 05 00  03 81 81 00 9d 30 cc 40  |.............0.@|
-00000240  2b 5b 50 a0 61 cb ba e5  53 58 e1 ed 83 28 a9 58  |+[P.a...SX...(.X|
-00000250  1a a9 38 a4 95 a1 ac 31  5a 1a 84 66 3d 43 d3 2d  |..8....1Z..f=C.-|
-00000260  d9 0b f2 97 df d3 20 64  38 92 24 3a 00 bc cf 9c  |...... d8.$:....|
-00000270  7d b7 40 20 01 5f aa d3  16 61 09 a2 76 fd 13 c3  |}.@ ._...a..v...|
-00000280  cc e1 0c 5c ee b1 87 82  f1 6c 04 ed 73 bb b3 43  |...\.....l..s..C|
-00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
-000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
-000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 01 00  |.=.`.\!.;.......|
-000002c0  aa 0c 00 00 a6 03 00 1d  20 87 d5 d1 27 70 92 d9  |........ ...'p..|
-000002d0  15 56 e4 fd a8 52 a9 a5  f6 db ab f5 e2 61 fa 5d  |.V...R.......a.]|
-000002e0  64 ba c2 ee 37 0b 53 cf  3c 00 80 71 cd eb 4b 1c  |d...7.S.<..q..K.|
-000002f0  f7 84 85 6a 20 5c c8 40  59 1c b0 8e 1b b6 b6 19  |...j \.@Y.......|
-00000300  f1 66 ad 7d 1d d5 58 da  c3 c4 dd 12 57 04 05 0d  |.f.}..X.....W...|
-00000310  79 46 20 0b 8c a3 49 95  e0 96 22 75 56 44 21 6b  |yF ...I..."uVD!k|
-00000320  42 17 ed 32 eb 9c f3 fd  b0 b3 08 da 61 7e f3 9b  |B..2........a~..|
-00000330  43 51 c0 09 e3 53 17 5d  84 3f c4 52 db 73 f9 d1  |CQ...S.].?.R.s..|
-00000340  21 0e 55 a4 bc a1 1b b6  3a 5a d1 cb 15 7e 8b a4  |!.U.....:Z...~..|
-00000350  fb 0f e7 7e 36 a7 1b a4  c0 1f 79 37 49 17 84 d3  |...~6.....y7I...|
-00000360  97 39 78 1f 55 77 e8 aa  37 2a 36 16 03 01 00 0a  |.9x.Uw..7*6.....|
-00000370  0d 00 00 06 03 01 02 40  00 00 16 03 01 00 04 0e  |.......@........|
-00000380  00 00 00                                          |...|
+00000000  16 03 01 00 5d 02 00 00  59 03 01 a1 07 34 d5 08  |....]...Y....4..|
+00000010  09 17 79 08 6e 26 2b b3  2f e5 35 08 54 b4 5b 0e  |..y.n&+./.5.T.[.|
+00000020  c8 58 57 2b 5a 75 8d e8  d2 9e 35 20 ae bf 94 16  |.XW+Zu....5 ....|
+00000030  e5 a9 f6 05 18 1f 7f a4  1e e9 cd 4a c0 7d a6 4d  |...........J.}.M|
+00000040  75 4f 06 de e0 6c 79 b3  39 5c a7 ed c0 13 00 00  |uO...ly.9\......|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 01 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
+00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
+00000080  00 e8 f0 9d 3f e2 5b ea  a6 30 0d 06 09 2a 86 48  |....?.[..0...*.H|
+00000090  86 f7 0d 01 01 0b 05 00  30 1f 31 0b 30 09 06 03  |........0.1.0...|
+000000a0  55 04 0a 13 02 47 6f 31  10 30 0e 06 03 55 04 03  |U....Go1.0...U..|
+000000b0  13 07 47 6f 20 52 6f 6f  74 30 1e 17 0d 31 36 30  |..Go Root0...160|
+000000c0  31 30 31 30 30 30 30 30  30 5a 17 0d 32 35 30 31  |101000000Z..2501|
+000000d0  30 31 30 30 30 30 30 30  5a 30 1a 31 0b 30 09 06  |01000000Z0.1.0..|
+000000e0  03 55 04 0a 13 02 47 6f  31 0b 30 09 06 03 55 04  |.U....Go1.0...U.|
+000000f0  03 13 02 47 6f 30 81 9f  30 0d 06 09 2a 86 48 86  |...Go0..0...*.H.|
+00000100  f7 0d 01 01 01 05 00 03  81 8d 00 30 81 89 02 81  |...........0....|
+00000110  81 00 db 46 7d 93 2e 12  27 06 48 bc 06 28 21 ab  |...F}...'.H..(!.|
+00000120  7e c4 b6 a2 5d fe 1e 52  45 88 7a 36 47 a5 08 0d  |~...]..RE.z6G...|
+00000130  92 42 5b c2 81 c0 be 97  79 98 40 fb 4f 6d 14 fd  |.B[.....y.@.Om..|
+00000140  2b 13 8b c2 a5 2e 67 d8  d4 09 9e d6 22 38 b7 4a  |+.....g....."8.J|
+00000150  0b 74 73 2b c2 34 f1 d1  93 e5 96 d9 74 7b f3 58  |.ts+.4......t{.X|
+00000160  9f 6c 61 3c c0 b0 41 d4  d9 2b 2b 24 23 77 5b 1c  |.la<..A..++$#w[.|
+00000170  3b bd 75 5d ce 20 54 cf  a1 63 87 1d 1e 24 c4 f3  |;.u]. T..c...$..|
+00000180  1d 1a 50 8b aa b6 14 43  ed 97 a7 75 62 f4 14 c8  |..P....C...ub...|
+00000190  52 d7 02 03 01 00 01 a3  81 93 30 81 90 30 0e 06  |R.........0..0..|
+000001a0  03 55 1d 0f 01 01 ff 04  04 03 02 05 a0 30 1d 06  |.U...........0..|
+000001b0  03 55 1d 25 04 16 30 14  06 08 2b 06 01 05 05 07  |.U.%..0...+.....|
+000001c0  03 01 06 08 2b 06 01 05  05 07 03 02 30 0c 06 03  |....+.......0...|
+000001d0  55 1d 13 01 01 ff 04 02  30 00 30 19 06 03 55 1d  |U.......0.0...U.|
+000001e0  0e 04 12 04 10 9f 91 16  1f 43 43 3e 49 a6 de 6d  |.........CC>I..m|
+000001f0  b6 80 d7 9f 60 30 1b 06  03 55 1d 23 04 14 30 12  |....`0...U.#..0.|
+00000200  80 10 48 13 49 4d 13 7e  16 31 bb a3 01 d5 ac ab  |..H.IM.~.1......|
+00000210  6e 7b 30 19 06 03 55 1d  11 04 12 30 10 82 0e 65  |n{0...U....0...e|
+00000220  78 61 6d 70 6c 65 2e 67  6f 6c 61 6e 67 30 0d 06  |xample.golang0..|
+00000230  09 2a 86 48 86 f7 0d 01  01 0b 05 00 03 81 81 00  |.*.H............|
+00000240  9d 30 cc 40 2b 5b 50 a0  61 cb ba e5 53 58 e1 ed  |.0.@+[P.a...SX..|
+00000250  83 28 a9 58 1a a9 38 a4  95 a1 ac 31 5a 1a 84 66  |.(.X..8....1Z..f|
+00000260  3d 43 d3 2d d9 0b f2 97  df d3 20 64 38 92 24 3a  |=C.-...... d8.$:|
+00000270  00 bc cf 9c 7d b7 40 20  01 5f aa d3 16 61 09 a2  |....}.@ ._...a..|
+00000280  76 fd 13 c3 cc e1 0c 5c  ee b1 87 82 f1 6c 04 ed  |v......\.....l..|
+00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
+000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
+000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
+000002c0  16 03 01 00 aa 0c 00 00  a6 03 00 1d 20 6d 79 f8  |............ my.|
+000002d0  b3 f9 f8 39 10 ea 9a f0  d7 40 a7 94 b4 5b 87 fc  |...9.....@...[..|
+000002e0  63 e1 7f 82 f8 cd e9 02  f7 0c 83 e0 48 00 80 cc  |c...........H...|
+000002f0  23 b7 af c6 3b 6a ed cd  07 be 81 cd 81 f9 85 f1  |#...;j..........|
+00000300  a2 32 82 3b 1c 02 3e 02  20 da 71 e0 3a cc 4b 49  |.2.;..>. .q.:.KI|
+00000310  09 36 af 1e 9e b5 14 6e  4c d1 4d df 87 38 92 52  |.6.....nL.M..8.R|
+00000320  47 0c e7 e8 2b 2e 65 38  e3 c4 d7 24 db bb fb 2c  |G...+.e8...$...,|
+00000330  04 2c 9e e5 a7 9d 4b 03  b8 cb 71 c6 62 e0 42 f7  |.,....K...q.b.B.|
+00000340  d7 1e 62 7e 21 e0 4d 37  e2 67 46 fa 82 df 49 62  |..b~!.M7.gF...Ib|
+00000350  33 fe e1 44 fd 62 31 46  b7 66 27 ce 85 99 00 b2  |3..D.b1F.f'.....|
+00000360  2c 94 1b c1 66 7b 95 a9  2c d2 33 5c 57 50 f1 16  |,...f{..,.3\WP..|
+00000370  03 01 00 0a 0d 00 00 06  03 01 02 40 00 00 16 03  |...........@....|
+00000380  01 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 01 02 0a 0b 00 02  06 00 02 03 00 02 00 30  |...............0|
 00000010  82 01 fc 30 82 01 5e 02  09 00 9a 30 84 6c 26 35  |...0..^....0.l&5|
@@ -110,29 +111,29 @@
 00000210  03 01 00 25 10 00 00 21  20 2f e5 7d a3 47 cd 62  |...%...! /.}.G.b|
 00000220  43 15 28 da ac 5f bb 29  07 30 ff f6 84 af c4 cf  |C.(.._.).0......|
 00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 01 00 91 0f 00  |...._X.;t.......|
-00000240  00 8d 00 8b 30 81 88 02  42 01 e7 32 ab 5d d7 f8  |....0...B..2.]..|
-00000250  b6 25 f9 b6 e6 19 eb 20  75 99 90 bc 41 06 74 ce  |.%..... u...A.t.|
-00000260  92 31 fc 9e cd f3 b4 b1  b1 f7 1e d3 3c 5e 01 92  |.1..........<^..|
-00000270  a0 c6 24 05 6e 3b ba 6c  51 61 6c 11 fd fe d7 9f  |..$.n;.lQal.....|
-00000280  0b 16 b3 1a f7 20 fa b2  3d 92 c9 02 42 01 d7 dc  |..... ..=...B...|
-00000290  20 50 f6 91 a3 63 2a 79  37 d4 8b 71 0a 1e 73 f8  | P...c*y7..q..s.|
-000002a0  1e 1c 04 c5 c8 66 bc 5e  67 5e bb 94 76 87 23 12  |.....f.^g^..v.#.|
-000002b0  64 18 cb 09 66 58 f1 06  17 93 1e b9 83 67 9d 3d  |d...fX.......g.=|
-000002c0  39 0a fb 37 7b a9 bf d2  59 1a 49 0f 4c 10 df 14  |9..7{...Y.I.L...|
-000002d0  03 01 00 01 01 16 03 01  00 30 4f 0e ba fc 20 81  |.........0O... .|
-000002e0  73 58 e0 47 33 b9 5e c4  6a 10 c2 1a 42 c3 85 2b  |sX.G3.^.j...B..+|
-000002f0  20 38 80 5d 40 81 4a 78  40 d9 13 ac af b3 45 e7  | 8.]@.Jx@.....E.|
-00000300  1e 19 c6 b5 63 6e 9c 5c  8a 8d                    |....cn.\..|
+00000240  00 8d 00 8b 30 81 88 02  42 00 f7 1a 73 32 b1 a7  |....0...B...s2..|
+00000250  04 a2 26 85 14 53 5a 70  76 c4 44 4c 0d f8 5a a6  |..&..SZpv.DL..Z.|
+00000260  bc 64 44 88 3f 01 80 a4  0d 17 ce 30 ca 92 4c 29  |.dD.?......0..L)|
+00000270  b2 f3 a4 65 1e 28 55 bc  b8 47 64 39 b7 49 20 05  |...e.(U..Gd9.I .|
+00000280  9d a4 84 6b 1b 8b df eb  b6 f6 b9 02 42 01 68 c8  |...k........B.h.|
+00000290  fd 3c ad 36 ad 15 28 4f  f2 ac b3 7f 63 28 30 5c  |.<.6..(O....c(0\|
+000002a0  68 59 f5 84 b2 cf 23 d6  dd 3b f5 7b 2b 1a ac 32  |hY....#..;.{+..2|
+000002b0  20 da 76 af 63 2a 68 6e  18 cd 07 82 41 6f 50 91  | .v.c*hn....AoP.|
+000002c0  d0 51 3b 9b ab 71 84 d4  be 15 dd 4b 8c 57 b7 14  |.Q;..q.....K.W..|
+000002d0  03 01 00 01 01 16 03 01  00 30 e3 e6 b9 cb 0b 0f  |.........0......|
+000002e0  71 55 4e 15 53 85 5c 2a  55 ac 83 cc e9 71 69 eb  |qUN.S.\*U....qi.|
+000002f0  dd 64 cb 2f 9f 74 b4 e6  80 52 9e a0 08 e3 7e 14  |.d./.t...R....~.|
+00000300  2c 5e 15 e4 81 38 11 aa  fb ab                    |,^...8....|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 c6 bb 74 56 db  |..........0..tV.|
-00000010  fd f7 a7 dd 3b a3 50 10  11 44 83 a1 c6 b1 6e 70  |....;.P..D....np|
-00000020  37 6e 68 b2 5a 45 6b fb  e9 9d 4e 68 cf ba ea af  |7nh.ZEk...Nh....|
-00000030  7d f6 65 ee 22 14 9e 5a  a7 85 65                 |}.e."..Z..e|
+00000000  14 03 01 00 01 01 16 03  01 00 30 bb 2d 20 48 7a  |..........0.- Hz|
+00000010  53 bf 3a ee c3 91 ec 1b  be cf 4a 18 57 5a c4 a7  |S.:.......J.WZ..|
+00000020  57 d7 51 fa 4a 69 8a bf  cd ff 2e 64 e7 76 a7 49  |W.Q.Ji.....d.v.I|
+00000030  1e 19 34 8d 4f c3 40 14  5d 68 8c                 |..4.O.@.]h.|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 c7 78 67  68 03 48 2e a5 c3 7a 0a  |.... .xgh.H...z.|
-00000010  56 73 14 02 12 f7 26 ac  48 19 3e e6 4b 0f ac d0  |Vs....&.H.>.K...|
-00000020  4e 74 dc 66 68 17 03 01  00 20 bf db fb e7 85 35  |Nt.fh.... .....5|
-00000030  50 4d 39 3f ab 25 95 30  4c 7a 20 d8 89 db 74 ff  |PM9?.%.0Lz ...t.|
-00000040  e6 e1 05 30 98 17 f3 93  8a 0d 15 03 01 00 20 f9  |...0.......... .|
-00000050  33 18 32 46 d3 28 46 a4  06 8c e1 9b 9b 1d d1 d8  |3.2F.(F.........|
-00000060  7b 9f 6c ad 5d 2a 36 10  2c dd f8 30 23 54 ac     |{.l.]*6.,..0#T.|
+00000000  17 03 01 00 20 c6 82 9a  ee a3 de fe 3f cd 56 92  |.... .......?.V.|
+00000010  20 b3 27 ae 5d db 4c 6c  a3 a9 01 ba ce 98 c5 d7  | .'.].Ll........|
+00000020  af be 49 92 50 17 03 01  00 20 35 a5 2d 8e 5a 4f  |..I.P.... 5.-.ZO|
+00000030  0d a8 ea 08 f8 dd 6c 01  04 d9 a7 2b 71 b1 c9 84  |......l....+q...|
+00000040  9d de d3 ce 69 4c 7a 3e  3c 7b 15 03 01 00 20 5c  |....iLz><{.... \|
+00000050  00 f6 57 56 dc f9 fc 36  15 85 71 01 7b 18 ae 11  |..WV...6..q.{...|
+00000060  51 0b f7 a3 e4 f8 d9 d8  ae 1d 0b 68 0f 4c 87     |Q..........h.L.|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA
index 3ee661ecec..d150babc22 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-ECDSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,68 +7,69 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 59 02 00 00  55 03 01 b4 ff c0 49 36  |....Y...U.....I6|
-00000010  1d 31 9a a7 f6 33 f5 16  78 d7 10 9e 19 eb 1d 67  |.1...3..x......g|
-00000020  20 39 f8 73 7e 27 e2 dc  d1 ab 03 20 79 64 67 f7  | 9.s~'..... ydg.|
-00000030  8b c8 97 f0 b4 87 0e 2d  4b 22 6c ed 92 48 85 52  |.......-K"l..H.R|
-00000040  eb 57 56 a8 cf 19 9f 4d  e3 38 5e a0 c0 09 00 00  |.WV....M.8^.....|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  01 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
-00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
-00000080  30 09 06 07 2a 86 48 ce  3d 04 01 30 45 31 0b 30  |0...*.H.=..0E1.0|
-00000090  09 06 03 55 04 06 13 02  41 55 31 13 30 11 06 03  |...U....AU1.0...|
-000000a0  55 04 08 13 0a 53 6f 6d  65 2d 53 74 61 74 65 31  |U....Some-State1|
-000000b0  21 30 1f 06 03 55 04 0a  13 18 49 6e 74 65 72 6e  |!0...U....Intern|
-000000c0  65 74 20 57 69 64 67 69  74 73 20 50 74 79 20 4c  |et Widgits Pty L|
-000000d0  74 64 30 1e 17 0d 31 32  31 31 32 32 31 35 30 36  |td0...1211221506|
-000000e0  33 32 5a 17 0d 32 32 31  31 32 30 31 35 30 36 33  |32Z..22112015063|
-000000f0  32 5a 30 45 31 0b 30 09  06 03 55 04 06 13 02 41  |2Z0E1.0...U....A|
-00000100  55 31 13 30 11 06 03 55  04 08 13 0a 53 6f 6d 65  |U1.0...U....Some|
-00000110  2d 53 74 61 74 65 31 21  30 1f 06 03 55 04 0a 13  |-State1!0...U...|
-00000120  18 49 6e 74 65 72 6e 65  74 20 57 69 64 67 69 74  |.Internet Widgit|
-00000130  73 20 50 74 79 20 4c 74  64 30 81 9b 30 10 06 07  |s Pty Ltd0..0...|
-00000140  2a 86 48 ce 3d 02 01 06  05 2b 81 04 00 23 03 81  |*.H.=....+...#..|
-00000150  86 00 04 00 c4 a1 ed be  98 f9 0b 48 73 36 7e c3  |...........Hs6~.|
-00000160  16 56 11 22 f2 3d 53 c3  3b 4d 21 3d cd 6b 75 e6  |.V.".=S.;M!=.ku.|
-00000170  f6 b0 dc 9a df 26 c1 bc  b2 87 f0 72 32 7c b3 64  |.....&.....r2|.d|
-00000180  2f 1c 90 bc ea 68 23 10  7e fe e3 25 c0 48 3a 69  |/....h#.~..%.H:i|
-00000190  e0 28 6d d3 37 00 ef 04  62 dd 0d a0 9c 70 62 83  |.(m.7...b....pb.|
-000001a0  d8 81 d3 64 31 aa 9e 97  31 bd 96 b0 68 c0 9b 23  |...d1...1...h..#|
-000001b0  de 76 64 3f 1a 5c 7f e9  12 0e 58 58 b6 5f 70 dd  |.vd?.\....XX._p.|
-000001c0  9b d8 ea d5 d7 f5 d5 cc  b9 b6 9f 30 66 5b 66 9a  |...........0f[f.|
-000001d0  20 e2 27 e5 bf fe 3b 30  09 06 07 2a 86 48 ce 3d  | .'...;0...*.H.=|
-000001e0  04 01 03 81 8c 00 30 81  88 02 42 01 88 a2 4f eb  |......0...B...O.|
-000001f0  e2 45 c5 48 7d 1b ac f5  ed 98 9d ae 47 70 c0 5e  |.E.H}.......Gp.^|
-00000200  1b b6 2f bd f1 b6 4d b7  61 40 d3 11 a2 ce ee 0b  |../...M.a@......|
-00000210  7e 92 7e ff 76 9d c3 3b  7e a5 3f ce fa 10 e2 59  |~.~.v..;~.?....Y|
-00000220  ec 47 2d 7c ac da 4e 97  0e 15 a0 6f d0 02 42 01  |.G-|..N....o..B.|
-00000230  4d fc be 67 13 9c 2d 05  0e bd 3f a3 8c 25 c1 33  |M..g..-...?..%.3|
-00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
-00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
-00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 01 00 b4 0c 00  00 b0 03 00 1d 20 ec 38  |*............ .8|
-00000280  f7 41 d0 f3 f4 6a ca 47  18 74 f1 22 2c 47 ee 39  |.A...j.G.t.",G.9|
-00000290  c9 a2 db 64 05 01 ae 5d  08 65 53 7f 24 78 00 8a  |...d...].eS.$x..|
-000002a0  30 81 87 02 41 64 39 65  56 fa d4 69 e7 c5 a5 32  |0...Ad9eV..i...2|
-000002b0  4c 52 55 96 fe 01 cd 41  3c 18 ed df fd 09 c3 89  |LRU....A<.......|
-000002c0  80 bd 88 9e d7 a1 85 16  d1 a4 5a f0 9a 76 e9 2f  |..........Z..v./|
-000002d0  d2 a4 42 a4 89 98 6c 87  64 b1 49 4e 6a 68 d2 43  |..B...l.d.INjh.C|
-000002e0  41 a2 c7 a6 2f f7 02 42  01 6c bb 32 c0 47 7e 08  |A.../..B.l.2.G~.|
-000002f0  6b 7a 44 18 b7 5d 4c 4d  6d 80 92 bb e5 65 98 1b  |kzD..]LMm....e..|
-00000300  d7 a6 a3 1b b5 f3 46 1a  e7 e0 89 04 40 b0 29 aa  |......F.....@.).|
-00000310  fe 85 6a 9a 4b 18 75 ab  00 52 71 54 41 8d eb 31  |..j.K.u..RqTA..1|
-00000320  47 69 9b 9d dc 3b 1b 3e  76 27 16 03 01 00 0a 0d  |Gi...;.>v'......|
-00000330  00 00 06 03 01 02 40 00  00 16 03 01 00 04 0e 00  |......@.........|
-00000340  00 00                                             |..|
+00000000  16 03 01 00 5d 02 00 00  59 03 01 53 6b 9f 42 b4  |....]...Y..Sk.B.|
+00000010  38 d0 d3 ef 17 52 44 10  a5 70 61 35 8c ae a9 52  |8....RD..pa5...R|
+00000020  6c d6 e2 c3 bd c4 3c b9  3c 09 83 20 aa 22 81 b5  |l.....<.<.. ."..|
+00000030  02 b5 aa e6 24 88 e6 75  70 1c 32 9a 3b 2c 2f 05  |....$..up.2.;,/.|
+00000040  e0 eb 59 65 4c 9e 45 82  fd d7 37 5e c0 09 00 00  |..YeL.E...7^....|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 01 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
+00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
+00000080  a0 d2 eb f4 30 09 06 07  2a 86 48 ce 3d 04 01 30  |....0...*.H.=..0|
+00000090  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+000000a0  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+000000b0  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+000000c0  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+000000d0  74 79 20 4c 74 64 30 1e  17 0d 31 32 31 31 32 32  |ty Ltd0...121122|
+000000e0  31 35 30 36 33 32 5a 17  0d 32 32 31 31 32 30 31  |150632Z..2211201|
+000000f0  35 30 36 33 32 5a 30 45  31 0b 30 09 06 03 55 04  |50632Z0E1.0...U.|
+00000100  06 13 02 41 55 31 13 30  11 06 03 55 04 08 13 0a  |...AU1.0...U....|
+00000110  53 6f 6d 65 2d 53 74 61  74 65 31 21 30 1f 06 03  |Some-State1!0...|
+00000120  55 04 0a 13 18 49 6e 74  65 72 6e 65 74 20 57 69  |U....Internet Wi|
+00000130  64 67 69 74 73 20 50 74  79 20 4c 74 64 30 81 9b  |dgits Pty Ltd0..|
+00000140  30 10 06 07 2a 86 48 ce  3d 02 01 06 05 2b 81 04  |0...*.H.=....+..|
+00000150  00 23 03 81 86 00 04 00  c4 a1 ed be 98 f9 0b 48  |.#.............H|
+00000160  73 36 7e c3 16 56 11 22  f2 3d 53 c3 3b 4d 21 3d  |s6~..V.".=S.;M!=|
+00000170  cd 6b 75 e6 f6 b0 dc 9a  df 26 c1 bc b2 87 f0 72  |.ku......&.....r|
+00000180  32 7c b3 64 2f 1c 90 bc  ea 68 23 10 7e fe e3 25  |2|.d/....h#.~..%|
+00000190  c0 48 3a 69 e0 28 6d d3  37 00 ef 04 62 dd 0d a0  |.H:i.(m.7...b...|
+000001a0  9c 70 62 83 d8 81 d3 64  31 aa 9e 97 31 bd 96 b0  |.pb....d1...1...|
+000001b0  68 c0 9b 23 de 76 64 3f  1a 5c 7f e9 12 0e 58 58  |h..#.vd?.\....XX|
+000001c0  b6 5f 70 dd 9b d8 ea d5  d7 f5 d5 cc b9 b6 9f 30  |._p............0|
+000001d0  66 5b 66 9a 20 e2 27 e5  bf fe 3b 30 09 06 07 2a  |f[f. .'...;0...*|
+000001e0  86 48 ce 3d 04 01 03 81  8c 00 30 81 88 02 42 01  |.H.=......0...B.|
+000001f0  88 a2 4f eb e2 45 c5 48  7d 1b ac f5 ed 98 9d ae  |..O..E.H}.......|
+00000200  47 70 c0 5e 1b b6 2f bd  f1 b6 4d b7 61 40 d3 11  |Gp.^../...M.a@..|
+00000210  a2 ce ee 0b 7e 92 7e ff  76 9d c3 3b 7e a5 3f ce  |....~.~.v..;~.?.|
+00000220  fa 10 e2 59 ec 47 2d 7c  ac da 4e 97 0e 15 a0 6f  |...Y.G-|..N....o|
+00000230  d0 02 42 01 4d fc be 67  13 9c 2d 05 0e bd 3f a3  |..B.M..g..-...?.|
+00000240  8c 25 c1 33 13 83 0d 94  06 bb d4 37 7a f6 ec 7a  |.%.3.......7z..z|
+00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
+00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
+00000270  95 12 07 8f 2a 16 03 01  00 b5 0c 00 00 b1 03 00  |....*...........|
+00000280  1d 20 fc 74 81 8e 09 19  14 86 d3 4d 8d cf 7d 00  |. .t.......M..}.|
+00000290  c1 83 83 b5 9a 32 f1 38  01 ae a9 9b a1 d9 26 54  |.....2.8......&T|
+000002a0  a4 08 00 8b 30 81 88 02  42 00 a1 56 29 a7 ba 25  |....0...B..V)..%|
+000002b0  bb 6a 12 51 77 c1 28 35  1e 4b 3e a8 01 63 e6 f6  |.j.Qw.(5.K>..c..|
+000002c0  f3 99 05 7b 0f 1f 21 dd  9e de c9 c1 08 c6 bc 23  |...{..!........#|
+000002d0  71 87 1e a1 30 07 0c 5d  f6 9f bf 45 7d 60 3c c2  |q...0..]...E}`<.|
+000002e0  48 65 3d 3f a3 b4 67 89  90 1d 12 02 42 00 93 43  |He=?..g.....B..C|
+000002f0  12 c1 46 b5 6d 2e cc 60  50 11 95 86 bd 36 53 fc  |..F.m..`P....6S.|
+00000300  92 01 6a 11 92 97 69 c2  cf c9 b0 a0 4a 42 0b d2  |..j...i.....JB..|
+00000310  c4 0c 84 e5 9e f6 2c a3  91 70 45 25 1f 78 17 b0  |......,..pE%.x..|
+00000320  1f 0e f7 a2 d5 4d 1c 77  ec f9 04 ca ab 68 26 16  |.....M.w.....h&.|
+00000330  03 01 00 0a 0d 00 00 06  03 01 02 40 00 00 16 03  |...........@....|
+00000340  01 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 01 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
 00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
@@ -105,29 +106,29 @@
 00000200  e5 35 16 03 01 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
 00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 01 00  |......._X.;t....|
-00000230  86 0f 00 00 82 00 80 05  7e 70 eb cb ef e3 d9 6f  |........~p.....o|
-00000240  59 29 b5 da f2 07 f5 42  62 4e 74 9b cf 00 e1 5c  |Y).....BbNt....\|
-00000250  69 a5 67 3a b0 b2 ca f2  10 ed 1c b4 81 5d 7d 9e  |i.g:.........]}.|
-00000260  1a 45 69 42 13 c5 b0 86  dc 3d 60 e5 cf fd ae 0f  |.EiB.....=`.....|
-00000270  17 bb 4a ed d7 06 eb f1  6d 47 98 b7 e8 87 eb 3c  |..J.....mG.....<|
-00000280  12 55 2c 06 de 55 48 c7  59 85 cb 62 d6 e7 1d 05  |.U,..UH.Y..b....|
-00000290  1e 6d 69 84 cd 16 8e dd  ed 5b 5a 2f f2 97 b7 78  |.mi......[Z/...x|
-000002a0  93 c1 fb 75 26 c8 b5 58  43 17 c7 52 54 20 4f 7d  |...u&..XC..RT O}|
-000002b0  7c 46 89 65 fe 51 29 14  03 01 00 01 01 16 03 01  ||F.e.Q).........|
-000002c0  00 30 d9 59 e6 7e c0 a6  2a af 36 0c 2e cf 0f 42  |.0.Y.~..*.6....B|
-000002d0  54 d4 41 c6 3c f8 84 d9  2a a6 82 94 22 2d ac ae  |T.A.<...*..."-..|
-000002e0  d9 f7 68 22 f6 f0 2e 56  c1 97 80 73 0d b3 f0 70  |..h"...V...s...p|
-000002f0  49 78                                             |Ix|
+00000230  86 0f 00 00 82 00 80 3b  af ba ad 44 f1 06 e4 79  |.......;...D...y|
+00000240  d7 fa 41 42 2a 7e 45 3d  fc 9d f7 5d a9 13 b9 35  |..AB*~E=...]...5|
+00000250  49 ea 28 6a 03 48 0b 14  c9 43 69 16 32 b7 6b b5  |I.(j.H...Ci.2.k.|
+00000260  a7 11 44 15 26 61 04 ea  f8 1e a0 32 3d 6b 26 be  |..D.&a.....2=k&.|
+00000270  37 44 34 0e 06 62 ee cf  b9 41 4c 84 ba 3f aa 5f  |7D4..b...AL..?._|
+00000280  d7 ea 31 c8 77 07 13 38  66 ba ec b4 b0 6c 44 ee  |..1.w..8f....lD.|
+00000290  8e d4 49 1d 9e 7b 2d b2  48 23 a0 06 04 22 9b 3a  |..I..{-.H#...".:|
+000002a0  3f 71 13 13 ce 67 3f e8  84 0f a4 8d ff 2c de f5  |?q...g?......,..|
+000002b0  ce 8d 15 8d 64 bc 5e 14  03 01 00 01 01 16 03 01  |....d.^.........|
+000002c0  00 30 f6 42 8a 63 15 7b  24 63 62 dc f7 6a ab 38  |.0.B.c.{$cb..j.8|
+000002d0  33 32 6d c6 44 5e 10 8a  7a f8 f0 77 e7 5c 2a 6e  |32m.D^..z..w.\*n|
+000002e0  8f 18 72 c6 e2 42 66 c0  f7 7a 45 fb 68 01 30 8a  |..r..Bf..zE.h.0.|
+000002f0  59 1a                                             |Y.|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 06 19 79 49 41  |..........0..yIA|
-00000010  f9 9c 75 84 73 95 96 bd  1e 25 56 a9 49 ed 8e 38  |..u.s....%V.I..8|
-00000020  34 40 60 dc f0 2d f3 6c  cf 5b 80 84 2b 81 db 5f  |4@`..-.l.[..+.._|
-00000030  f4 27 03 ad b8 8d 80 0c  99 69 6f                 |.'.......io|
+00000000  14 03 01 00 01 01 16 03  01 00 30 1f a1 61 8d 3e  |..........0..a.>|
+00000010  6e 5d 29 bd d0 14 80 ec  55 fc 7d b2 02 bd 6d c5  |n]).....U.}...m.|
+00000020  93 50 67 30 4f ce d5 8a  8b 80 3c 9a a6 0f ac be  |.Pg0O.....<.....|
+00000030  dd b0 1b 22 0d 89 dc cd  73 ba 99                 |..."....s..|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 20 67 bd  ff 84 9b 0e 58 f3 45 1e  |....  g.....X.E.|
-00000010  7a 25 d5 ae f0 26 4b 42  c7 f3 a5 77 7b 2f 42 21  |z%...&KB...w{/B!|
-00000020  2e c6 c9 81 23 17 03 01  00 20 69 1c 2a b9 05 16  |....#.... i.*...|
-00000030  8b 71 3a c2 18 76 bd 25  1f de 83 e9 14 e2 a3 5c  |.q:..v.%.......\|
-00000040  9b 33 ee 14 39 da e2 e7  a3 a7 15 03 01 00 20 e9  |.3..9......... .|
-00000050  dc 16 0c 13 56 7a e5 fd  ce b9 4f d1 c7 20 3f ca  |....Vz....O.. ?.|
-00000060  72 20 15 f7 11 81 fe 88  ab 90 4c dc 0b a5 11     |r ........L....|
+00000000  17 03 01 00 20 23 4b ba  47 65 fb 41 fb ad c6 06  |.... #K.Ge.A....|
+00000010  c2 c7 ed 6e b4 d0 42 48  6b 68 60 69 7c f0 91 85  |...n..BHkh`i|...|
+00000020  f3 a2 ea b1 5b 17 03 01  00 20 d2 fa 3c a5 d2 ea  |....[.... ..<...|
+00000030  b8 81 7a fb 31 95 bc e5  e3 4d 1a 15 e7 e3 96 8e  |..z.1....M......|
+00000040  bc 77 26 b1 5c b5 61 14  99 7c 15 03 01 00 20 b2  |.w&.\.a..|.... .|
+00000050  0c 6a 3d 02 6b 32 2f 43  9e 5e ac f1 c3 97 e2 27  |.j=.k2/C.^.....'|
+00000060  c1 a1 b9 b6 b7 11 36 17  27 0a 7a 8d 53 18 d6     |......6.'.z.S..|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA
index 980f93328f..b3157bb183 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv10-ClientCert-RSA-RSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,72 +7,73 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 59 02 00 00  55 03 01 4d 6d 71 59 6b  |....Y...U..MmqYk|
-00000010  cd 8c 6e b0 11 bf 4a 9e  25 90 12 cc ac b4 3f be  |..n...J.%.....?.|
-00000020  86 1b 13 47 a6 be 3d a0  8f 0b 77 20 6b b5 57 6d  |...G..=...w k.Wm|
-00000030  39 74 b0 9d b4 ae 2e 72  7e 90 d2 ab ed 32 fa 65  |9t.....r~....2.e|
-00000040  ed 85 63 d2 16 ef 47 af  a6 37 17 88 c0 13 00 00  |..c...G..7......|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  01 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
-00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
-00000080  3f e2 5b ea a6 30 0d 06  09 2a 86 48 86 f7 0d 01  |?.[..0...*.H....|
-00000090  01 0b 05 00 30 1f 31 0b  30 09 06 03 55 04 0a 13  |....0.1.0...U...|
-000000a0  02 47 6f 31 10 30 0e 06  03 55 04 03 13 07 47 6f  |.Go1.0...U....Go|
-000000b0  20 52 6f 6f 74 30 1e 17  0d 31 36 30 31 30 31 30  | Root0...1601010|
-000000c0  30 30 30 30 30 5a 17 0d  32 35 30 31 30 31 30 30  |00000Z..25010100|
-000000d0  30 30 30 30 5a 30 1a 31  0b 30 09 06 03 55 04 0a  |0000Z0.1.0...U..|
-000000e0  13 02 47 6f 31 0b 30 09  06 03 55 04 03 13 02 47  |..Go1.0...U....G|
-000000f0  6f 30 81 9f 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |o0..0...*.H.....|
-00000100  01 05 00 03 81 8d 00 30  81 89 02 81 81 00 db 46  |.......0.......F|
-00000110  7d 93 2e 12 27 06 48 bc  06 28 21 ab 7e c4 b6 a2  |}...'.H..(!.~...|
-00000120  5d fe 1e 52 45 88 7a 36  47 a5 08 0d 92 42 5b c2  |]..RE.z6G....B[.|
-00000130  81 c0 be 97 79 98 40 fb  4f 6d 14 fd 2b 13 8b c2  |....y.@.Om..+...|
-00000140  a5 2e 67 d8 d4 09 9e d6  22 38 b7 4a 0b 74 73 2b  |..g....."8.J.ts+|
-00000150  c2 34 f1 d1 93 e5 96 d9  74 7b f3 58 9f 6c 61 3c  |.4......t{.X.la<|
-00000160  c0 b0 41 d4 d9 2b 2b 24  23 77 5b 1c 3b bd 75 5d  |..A..++$#w[.;.u]|
-00000170  ce 20 54 cf a1 63 87 1d  1e 24 c4 f3 1d 1a 50 8b  |. T..c...$....P.|
-00000180  aa b6 14 43 ed 97 a7 75  62 f4 14 c8 52 d7 02 03  |...C...ub...R...|
-00000190  01 00 01 a3 81 93 30 81  90 30 0e 06 03 55 1d 0f  |......0..0...U..|
-000001a0  01 01 ff 04 04 03 02 05  a0 30 1d 06 03 55 1d 25  |.........0...U.%|
-000001b0  04 16 30 14 06 08 2b 06  01 05 05 07 03 01 06 08  |..0...+.........|
-000001c0  2b 06 01 05 05 07 03 02  30 0c 06 03 55 1d 13 01  |+.......0...U...|
-000001d0  01 ff 04 02 30 00 30 19  06 03 55 1d 0e 04 12 04  |....0.0...U.....|
-000001e0  10 9f 91 16 1f 43 43 3e  49 a6 de 6d b6 80 d7 9f  |.....CC>I..m....|
-000001f0  60 30 1b 06 03 55 1d 23  04 14 30 12 80 10 48 13  |`0...U.#..0...H.|
-00000200  49 4d 13 7e 16 31 bb a3  01 d5 ac ab 6e 7b 30 19  |IM.~.1......n{0.|
-00000210  06 03 55 1d 11 04 12 30  10 82 0e 65 78 61 6d 70  |..U....0...examp|
-00000220  6c 65 2e 67 6f 6c 61 6e  67 30 0d 06 09 2a 86 48  |le.golang0...*.H|
-00000230  86 f7 0d 01 01 0b 05 00  03 81 81 00 9d 30 cc 40  |.............0.@|
-00000240  2b 5b 50 a0 61 cb ba e5  53 58 e1 ed 83 28 a9 58  |+[P.a...SX...(.X|
-00000250  1a a9 38 a4 95 a1 ac 31  5a 1a 84 66 3d 43 d3 2d  |..8....1Z..f=C.-|
-00000260  d9 0b f2 97 df d3 20 64  38 92 24 3a 00 bc cf 9c  |...... d8.$:....|
-00000270  7d b7 40 20 01 5f aa d3  16 61 09 a2 76 fd 13 c3  |}.@ ._...a..v...|
-00000280  cc e1 0c 5c ee b1 87 82  f1 6c 04 ed 73 bb b3 43  |...\.....l..s..C|
-00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
-000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
-000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 01 00  |.=.`.\!.;.......|
-000002c0  aa 0c 00 00 a6 03 00 1d  20 96 0b 2f 57 e1 1e 07  |........ ../W...|
-000002d0  e0 7f a4 91 67 97 d0 a0  19 d3 9a b2 49 79 f9 5f  |....g.......Iy._|
-000002e0  7f b5 65 d4 3a 89 92 8f  11 00 80 08 29 72 0b f7  |..e.:.......)r..|
-000002f0  7b 68 38 5e 47 15 89 f1  ee be f3 a9 26 a4 9c 6d  |{h8^G.......&..m|
-00000300  2c 2a ff f0 d6 2d 25 a5  b0 93 66 7d 8c fb fe a5  |,*...-%...f}....|
-00000310  3b cc b6 71 f4 1b 55 c4  ef 08 73 b1 49 47 2c e6  |;..q..U...s.IG,.|
-00000320  a1 ef 53 ca bb 15 e3 25  ea e7 48 44 18 88 e1 d2  |..S....%..HD....|
-00000330  3b e9 f6 92 61 5e 5c 06  44 83 37 6c e6 b6 26 32  |;...a^\.D.7l..&2|
-00000340  fd d6 00 fc 87 a2 37 e3  84 d2 ad 2d 99 0d e1 ba  |......7....-....|
-00000350  bb 2f 3b 0b dd 56 5c c2  14 af 86 58 2c 8b f8 64  |./;..V\....X,..d|
-00000360  75 ab d3 35 41 59 fa fe  a5 48 26 16 03 01 00 0a  |u..5AY...H&.....|
-00000370  0d 00 00 06 03 01 02 40  00 00 16 03 01 00 04 0e  |.......@........|
-00000380  00 00 00                                          |...|
+00000000  16 03 01 00 5d 02 00 00  59 03 01 a1 43 a5 02 b9  |....]...Y...C...|
+00000010  48 81 74 51 b7 89 df 36  43 1c a3 5e f3 11 7e 81  |H.tQ...6C..^..~.|
+00000020  2d 43 b5 86 e8 4a f4 fe  5e 5e 92 20 10 31 08 7a  |-C...J..^^. .1.z|
+00000030  cc 0e 5a 90 0e 07 aa 2f  c7 17 b8 c9 d5 93 36 e3  |..Z..../......6.|
+00000040  ca 34 ed a2 e2 3d 6c 0c  fd 56 d9 64 c0 13 00 00  |.4...=l..V.d....|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 01 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
+00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
+00000080  00 e8 f0 9d 3f e2 5b ea  a6 30 0d 06 09 2a 86 48  |....?.[..0...*.H|
+00000090  86 f7 0d 01 01 0b 05 00  30 1f 31 0b 30 09 06 03  |........0.1.0...|
+000000a0  55 04 0a 13 02 47 6f 31  10 30 0e 06 03 55 04 03  |U....Go1.0...U..|
+000000b0  13 07 47 6f 20 52 6f 6f  74 30 1e 17 0d 31 36 30  |..Go Root0...160|
+000000c0  31 30 31 30 30 30 30 30  30 5a 17 0d 32 35 30 31  |101000000Z..2501|
+000000d0  30 31 30 30 30 30 30 30  5a 30 1a 31 0b 30 09 06  |01000000Z0.1.0..|
+000000e0  03 55 04 0a 13 02 47 6f  31 0b 30 09 06 03 55 04  |.U....Go1.0...U.|
+000000f0  03 13 02 47 6f 30 81 9f  30 0d 06 09 2a 86 48 86  |...Go0..0...*.H.|
+00000100  f7 0d 01 01 01 05 00 03  81 8d 00 30 81 89 02 81  |...........0....|
+00000110  81 00 db 46 7d 93 2e 12  27 06 48 bc 06 28 21 ab  |...F}...'.H..(!.|
+00000120  7e c4 b6 a2 5d fe 1e 52  45 88 7a 36 47 a5 08 0d  |~...]..RE.z6G...|
+00000130  92 42 5b c2 81 c0 be 97  79 98 40 fb 4f 6d 14 fd  |.B[.....y.@.Om..|
+00000140  2b 13 8b c2 a5 2e 67 d8  d4 09 9e d6 22 38 b7 4a  |+.....g....."8.J|
+00000150  0b 74 73 2b c2 34 f1 d1  93 e5 96 d9 74 7b f3 58  |.ts+.4......t{.X|
+00000160  9f 6c 61 3c c0 b0 41 d4  d9 2b 2b 24 23 77 5b 1c  |.la<..A..++$#w[.|
+00000170  3b bd 75 5d ce 20 54 cf  a1 63 87 1d 1e 24 c4 f3  |;.u]. T..c...$..|
+00000180  1d 1a 50 8b aa b6 14 43  ed 97 a7 75 62 f4 14 c8  |..P....C...ub...|
+00000190  52 d7 02 03 01 00 01 a3  81 93 30 81 90 30 0e 06  |R.........0..0..|
+000001a0  03 55 1d 0f 01 01 ff 04  04 03 02 05 a0 30 1d 06  |.U...........0..|
+000001b0  03 55 1d 25 04 16 30 14  06 08 2b 06 01 05 05 07  |.U.%..0...+.....|
+000001c0  03 01 06 08 2b 06 01 05  05 07 03 02 30 0c 06 03  |....+.......0...|
+000001d0  55 1d 13 01 01 ff 04 02  30 00 30 19 06 03 55 1d  |U.......0.0...U.|
+000001e0  0e 04 12 04 10 9f 91 16  1f 43 43 3e 49 a6 de 6d  |.........CC>I..m|
+000001f0  b6 80 d7 9f 60 30 1b 06  03 55 1d 23 04 14 30 12  |....`0...U.#..0.|
+00000200  80 10 48 13 49 4d 13 7e  16 31 bb a3 01 d5 ac ab  |..H.IM.~.1......|
+00000210  6e 7b 30 19 06 03 55 1d  11 04 12 30 10 82 0e 65  |n{0...U....0...e|
+00000220  78 61 6d 70 6c 65 2e 67  6f 6c 61 6e 67 30 0d 06  |xample.golang0..|
+00000230  09 2a 86 48 86 f7 0d 01  01 0b 05 00 03 81 81 00  |.*.H............|
+00000240  9d 30 cc 40 2b 5b 50 a0  61 cb ba e5 53 58 e1 ed  |.0.@+[P.a...SX..|
+00000250  83 28 a9 58 1a a9 38 a4  95 a1 ac 31 5a 1a 84 66  |.(.X..8....1Z..f|
+00000260  3d 43 d3 2d d9 0b f2 97  df d3 20 64 38 92 24 3a  |=C.-...... d8.$:|
+00000270  00 bc cf 9c 7d b7 40 20  01 5f aa d3 16 61 09 a2  |....}.@ ._...a..|
+00000280  76 fd 13 c3 cc e1 0c 5c  ee b1 87 82 f1 6c 04 ed  |v......\.....l..|
+00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
+000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
+000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
+000002c0  16 03 01 00 aa 0c 00 00  a6 03 00 1d 20 62 23 e4  |............ b#.|
+000002d0  5c 02 03 2d 62 41 93 e8  99 9d 01 cb 55 2c 7d 8d  |\..-bA......U,}.|
+000002e0  fd db d6 ac c6 99 d0 78  0f 27 27 37 70 00 80 6a  |.......x.''7p..j|
+000002f0  58 5e 29 6b 93 82 42 fa  a2 b7 5c 06 d8 ac ae 85  |X^)k..B...\.....|
+00000300  48 37 98 35 cf 31 09 8e  d6 a3 37 26 d1 e5 b3 3b  |H7.5.1....7&...;|
+00000310  98 53 dc b5 d2 9d 73 80  89 04 35 20 e6 e7 ac 48  |.S....s...5 ...H|
+00000320  88 6f 42 ac 1b 46 d3 78  6a f0 5d a0 68 e1 83 db  |.oB..F.xj.].h...|
+00000330  8a f3 bc f0 d2 35 b7 ae  8d 38 75 9f d6 76 01 ce  |.....5...8u..v..|
+00000340  d7 a9 0f 69 11 09 75 4a  20 b4 3b ec 14 fd 2b 7b  |...i..uJ .;...+{|
+00000350  e1 cf 12 89 d2 a2 94 3d  76 d5 b8 65 b4 17 24 43  |.......=v..e..$C|
+00000360  96 68 c4 c9 cc a2 08 e7  ca bc 2d 14 90 fa 53 16  |.h........-...S.|
+00000370  03 01 00 0a 0d 00 00 06  03 01 02 40 00 00 16 03  |...........@....|
+00000380  01 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 01 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
 00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
@@ -109,29 +110,29 @@
 00000200  e5 35 16 03 01 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
 00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 01 00  |......._X.;t....|
-00000230  86 0f 00 00 82 00 80 8f  5d a5 27 13 09 5e 49 5f  |........].'..^I_|
-00000240  ff fd d6 88 75 83 cc 74  f3 e1 af 44 76 6a 35 16  |....u..t...Dvj5.|
-00000250  e8 36 5f b7 dc 21 69 77  61 12 c5 69 f7 0d 98 1f  |.6_..!iwa..i....|
-00000260  d5 15 f1 e8 88 c5 30 e8  b5 c3 2a e5 26 93 cc a4  |......0...*.&...|
-00000270  eb 31 c6 d7 f5 f4 7c d5  f7 a2 3f 1f 75 cd b2 b2  |.1....|...?.u...|
-00000280  82 3a 03 8c 5e 15 0a d2  98 b8 65 cb 5f d5 db d0  |.:..^.....e._...|
-00000290  b6 36 8c 89 7e 48 fa 3a  9f 9a bd c1 48 e7 d6 20  |.6..~H.:....H.. |
-000002a0  ef 45 5b 24 32 04 58 82  b3 7b 42 fd fe ba 78 32  |.E[$2.X..{B...x2|
-000002b0  2a f5 b7 81 33 da db 14  03 01 00 01 01 16 03 01  |*...3...........|
-000002c0  00 30 5f 96 98 94 17 6d  ff 84 72 d3 63 fd 14 59  |.0_....m..r.c..Y|
-000002d0  eb bf 5f 3e 8f dc f1 c1  dc 77 8a 33 f6 2e a2 4a  |.._>.....w.3...J|
-000002e0  15 d1 2e a4 ec 0d 3c 0b  18 07 09 6c 0d 09 34 2e  |......<....l..4.|
-000002f0  a4 6f                                             |.o|
+00000230  86 0f 00 00 82 00 80 3d  7f 32 50 ff aa 3d ff 0f  |.......=.2P..=..|
+00000240  f8 68 64 fb 2d 34 b8 5b  5e 4b 49 04 b8 eb f7 07  |.hd.-4.[^KI.....|
+00000250  b7 bf 55 17 e5 11 66 87  23 16 3e ba 87 2f 58 23  |..U...f.#.>../X#|
+00000260  28 d4 df 15 75 eb 7b f6  38 94 a8 73 8a d2 1f 51  |(...u.{.8..s...Q|
+00000270  0f b5 90 16 0f db f9 23  a0 bc a5 96 48 ac a6 fa  |.......#....H...|
+00000280  fd e7 b4 94 5e c6 d4 a6  69 61 97 1a c3 ed 1e 5a  |....^...ia.....Z|
+00000290  db d9 c5 8f 58 97 6c 2a  88 f8 fb 52 14 10 a6 5a  |....X.l*...R...Z|
+000002a0  62 7a f8 37 40 e7 fd 27  c6 27 32 12 10 75 83 e3  |bz.7@..'.'2..u..|
+000002b0  66 c1 77 78 90 38 5d 14  03 01 00 01 01 16 03 01  |f.wx.8].........|
+000002c0  00 30 47 b5 75 6f 94 df  88 65 2d fc 45 33 29 d0  |.0G.uo...e-.E3).|
+000002d0  be 8d c0 72 59 be 7e 57  aa d8 42 d5 61 95 24 53  |...rY.~W..B.a.$S|
+000002e0  19 94 06 5b 48 34 22 44  6e 6e bf 2a 3d 0d 83 f6  |...[H4"Dnn.*=...|
+000002f0  a7 3b                                             |.;|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 b7 4a 5c 0c e6  |..........0.J\..|
-00000010  7c d9 43 7c e7 b4 2f d7  b5 c6 5e 36 c7 87 dd 82  ||.C|../...^6....|
-00000020  da d3 b2 4e 05 ae f5 8c  b0 4d db c2 53 62 55 73  |...N.....M..SbUs|
-00000030  8c 2a 1b d5 df e4 7c a4  cf db 8b                 |.*....|....|
+00000000  14 03 01 00 01 01 16 03  01 00 30 c1 88 7e 9e de  |..........0..~..|
+00000010  d3 2d 1d 27 bf d5 49 c5  a7 67 cc 0b fc ca a6 9b  |.-.'..I..g......|
+00000020  1b c7 96 59 ff 4f b9 7d  a0 7a 5e ed eb 77 04 5f  |...Y.O.}.z^..w._|
+00000030  ba b6 ea 33 80 b0 28 ef  96 ba 6a                 |...3..(...j|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 b9 26 60  87 38 9c d9 c4 65 17 8e  |.... .&`.8...e..|
-00000010  3c 7f 1a b4 23 cd 27 fd  4e 92 ee 0e f2 11 dc e2  |<...#.'.N.......|
-00000020  23 e4 26 f3 55 17 03 01  00 20 5e 89 33 21 f0 dc  |#.&.U.... ^.3!..|
-00000030  e8 4f 33 1c 66 56 99 38  a5 4c 0e 0e 93 41 b7 48  |.O3.fV.8.L...A.H|
-00000040  5d ce 49 d0 d2 8a 56 a6  2d 68 15 03 01 00 20 05  |].I...V.-h.... .|
-00000050  e0 ed f9 c2 56 ec 64 e5  e7 0b f4 8a e2 41 96 9e  |....V.d......A..|
-00000060  ed 94 c8 95 69 d7 ce 2d  0e bb 5b 18 5f 30 52     |....i..-..[._0R|
+00000000  17 03 01 00 20 55 4a e0  a0 68 5f 32 17 9a a3 fd  |.... UJ..h_2....|
+00000010  01 e9 2c fa 19 12 56 6f  c6 d7 a7 8d b7 8b 74 8a  |..,...Vo......t.|
+00000020  3a ae 72 9f 1e 17 03 01  00 20 b2 07 ca 31 62 b7  |:.r...... ...1b.|
+00000030  cb 46 d4 33 61 6c 81 11  d8 8b f3 cf 6a ac a8 c7  |.F.3al......j...|
+00000040  06 9c dc d9 49 ad 39 2a  6a ea 15 03 01 00 20 ee  |....I.9*j..... .|
+00000050  53 44 2e a0 bc 8d 74 8c  12 6b 3d a8 3e a5 98 00  |SD....t..k=.>...|
+00000060  03 e8 bb 34 f5 a9 29 81  0a 6f e6 d3 0e ad 9d     |...4..)..o.....|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES
index 6fc506f099..d146d7994a 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,85 +7,86 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 59 02 00 00  55 03 01 a3 4e 79 27 af  |....Y...U...Ny'.|
-00000010  c8 a3 15 a4 c2 7a 54 58  54 0e 0d 93 c2 ff e1 f9  |.....zTXT.......|
-00000020  55 ab 2c ea 32 cf d2 47  2e d7 8e 20 49 08 d1 66  |U.,.2..G... I..f|
-00000030  9b 9e aa af c9 90 95 ec  cb 64 2e 3d f6 27 d5 f6  |.........d.=.'..|
-00000040  23 10 d5 6e 50 5f bc 89  fe c7 d7 de c0 09 00 00  |#..nP_..........|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  01 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
-00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
-00000080  30 09 06 07 2a 86 48 ce  3d 04 01 30 45 31 0b 30  |0...*.H.=..0E1.0|
-00000090  09 06 03 55 04 06 13 02  41 55 31 13 30 11 06 03  |...U....AU1.0...|
-000000a0  55 04 08 13 0a 53 6f 6d  65 2d 53 74 61 74 65 31  |U....Some-State1|
-000000b0  21 30 1f 06 03 55 04 0a  13 18 49 6e 74 65 72 6e  |!0...U....Intern|
-000000c0  65 74 20 57 69 64 67 69  74 73 20 50 74 79 20 4c  |et Widgits Pty L|
-000000d0  74 64 30 1e 17 0d 31 32  31 31 32 32 31 35 30 36  |td0...1211221506|
-000000e0  33 32 5a 17 0d 32 32 31  31 32 30 31 35 30 36 33  |32Z..22112015063|
-000000f0  32 5a 30 45 31 0b 30 09  06 03 55 04 06 13 02 41  |2Z0E1.0...U....A|
-00000100  55 31 13 30 11 06 03 55  04 08 13 0a 53 6f 6d 65  |U1.0...U....Some|
-00000110  2d 53 74 61 74 65 31 21  30 1f 06 03 55 04 0a 13  |-State1!0...U...|
-00000120  18 49 6e 74 65 72 6e 65  74 20 57 69 64 67 69 74  |.Internet Widgit|
-00000130  73 20 50 74 79 20 4c 74  64 30 81 9b 30 10 06 07  |s Pty Ltd0..0...|
-00000140  2a 86 48 ce 3d 02 01 06  05 2b 81 04 00 23 03 81  |*.H.=....+...#..|
-00000150  86 00 04 00 c4 a1 ed be  98 f9 0b 48 73 36 7e c3  |...........Hs6~.|
-00000160  16 56 11 22 f2 3d 53 c3  3b 4d 21 3d cd 6b 75 e6  |.V.".=S.;M!=.ku.|
-00000170  f6 b0 dc 9a df 26 c1 bc  b2 87 f0 72 32 7c b3 64  |.....&.....r2|.d|
-00000180  2f 1c 90 bc ea 68 23 10  7e fe e3 25 c0 48 3a 69  |/....h#.~..%.H:i|
-00000190  e0 28 6d d3 37 00 ef 04  62 dd 0d a0 9c 70 62 83  |.(m.7...b....pb.|
-000001a0  d8 81 d3 64 31 aa 9e 97  31 bd 96 b0 68 c0 9b 23  |...d1...1...h..#|
-000001b0  de 76 64 3f 1a 5c 7f e9  12 0e 58 58 b6 5f 70 dd  |.vd?.\....XX._p.|
-000001c0  9b d8 ea d5 d7 f5 d5 cc  b9 b6 9f 30 66 5b 66 9a  |...........0f[f.|
-000001d0  20 e2 27 e5 bf fe 3b 30  09 06 07 2a 86 48 ce 3d  | .'...;0...*.H.=|
-000001e0  04 01 03 81 8c 00 30 81  88 02 42 01 88 a2 4f eb  |......0...B...O.|
-000001f0  e2 45 c5 48 7d 1b ac f5  ed 98 9d ae 47 70 c0 5e  |.E.H}.......Gp.^|
-00000200  1b b6 2f bd f1 b6 4d b7  61 40 d3 11 a2 ce ee 0b  |../...M.a@......|
-00000210  7e 92 7e ff 76 9d c3 3b  7e a5 3f ce fa 10 e2 59  |~.~.v..;~.?....Y|
-00000220  ec 47 2d 7c ac da 4e 97  0e 15 a0 6f d0 02 42 01  |.G-|..N....o..B.|
-00000230  4d fc be 67 13 9c 2d 05  0e bd 3f a3 8c 25 c1 33  |M..g..-...?..%.3|
-00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
-00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
-00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 01 00 b5 0c 00  00 b1 03 00 1d 20 4a 7c  |*............ J||
-00000280  0a 86 8a 81 f2 60 4a 3c  ac d7 7d 3b fc 00 a5 b4  |.....`J<..};....|
-00000290  85 45 45 45 fb 09 53 d7  4a cf 24 9d c8 1a 00 8b  |.EEE..S.J.$.....|
-000002a0  30 81 88 02 42 01 7a c9  c0 76 8c 26 98 63 4e a3  |0...B.z..v.&.cN.|
-000002b0  ad 4f 4e a3 d7 c7 d6 4a  69 28 cf d2 7b 0b 36 fb  |.ON....Ji(..{.6.|
-000002c0  a3 ae 2f e1 83 ea ea 4a  b7 2d ef a8 2d 13 96 e4  |../....J.-..-...|
-000002d0  73 83 66 70 5e 5c d9 5a  d1 1c d1 33 18 0b b3 30  |s.fp^\.Z...3...0|
-000002e0  2a 21 d7 78 d8 70 18 02  42 00 c4 ab 80 33 8f f1  |*!.x.p..B....3..|
-000002f0  c2 74 1b 58 2f 59 d4 27  a1 19 42 bf 14 ea a8 a2  |.t.X/Y.'..B.....|
-00000300  cb bf 96 2d 60 7b 84 40  cc 31 f5 c4 e8 51 87 b8  |...-`{.@.1...Q..|
-00000310  7b 47 ec c4 c0 4a 9b 09  59 1e f8 b5 9a e1 45 a4  |{G...J..Y.....E.|
-00000320  a1 9b ee 78 55 f8 f5 fa  1a fb c5 16 03 01 00 04  |...xU...........|
-00000330  0e 00 00 00                                       |....|
+00000000  16 03 01 00 5d 02 00 00  59 03 01 1c a5 a3 a1 49  |....]...Y......I|
+00000010  4e 93 54 cf 5a a2 8b 57  e7 f9 7b ce 53 48 fb 5b  |N.T.Z..W..{.SH.[|
+00000020  82 51 d6 0d aa c7 8b 40  44 5f 18 20 e3 b4 ca 5c  |.Q.....@D_. ...\|
+00000030  fd 20 e3 ae d2 a4 df e6  af db 4f 8b e9 95 41 1e  |. ........O...A.|
+00000040  8f 6f 1e 0a 33 e4 0b 0b  1b aa 54 a7 c0 09 00 00  |.o..3.....T.....|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 01 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
+00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
+00000080  a0 d2 eb f4 30 09 06 07  2a 86 48 ce 3d 04 01 30  |....0...*.H.=..0|
+00000090  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+000000a0  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+000000b0  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+000000c0  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+000000d0  74 79 20 4c 74 64 30 1e  17 0d 31 32 31 31 32 32  |ty Ltd0...121122|
+000000e0  31 35 30 36 33 32 5a 17  0d 32 32 31 31 32 30 31  |150632Z..2211201|
+000000f0  35 30 36 33 32 5a 30 45  31 0b 30 09 06 03 55 04  |50632Z0E1.0...U.|
+00000100  06 13 02 41 55 31 13 30  11 06 03 55 04 08 13 0a  |...AU1.0...U....|
+00000110  53 6f 6d 65 2d 53 74 61  74 65 31 21 30 1f 06 03  |Some-State1!0...|
+00000120  55 04 0a 13 18 49 6e 74  65 72 6e 65 74 20 57 69  |U....Internet Wi|
+00000130  64 67 69 74 73 20 50 74  79 20 4c 74 64 30 81 9b  |dgits Pty Ltd0..|
+00000140  30 10 06 07 2a 86 48 ce  3d 02 01 06 05 2b 81 04  |0...*.H.=....+..|
+00000150  00 23 03 81 86 00 04 00  c4 a1 ed be 98 f9 0b 48  |.#.............H|
+00000160  73 36 7e c3 16 56 11 22  f2 3d 53 c3 3b 4d 21 3d  |s6~..V.".=S.;M!=|
+00000170  cd 6b 75 e6 f6 b0 dc 9a  df 26 c1 bc b2 87 f0 72  |.ku......&.....r|
+00000180  32 7c b3 64 2f 1c 90 bc  ea 68 23 10 7e fe e3 25  |2|.d/....h#.~..%|
+00000190  c0 48 3a 69 e0 28 6d d3  37 00 ef 04 62 dd 0d a0  |.H:i.(m.7...b...|
+000001a0  9c 70 62 83 d8 81 d3 64  31 aa 9e 97 31 bd 96 b0  |.pb....d1...1...|
+000001b0  68 c0 9b 23 de 76 64 3f  1a 5c 7f e9 12 0e 58 58  |h..#.vd?.\....XX|
+000001c0  b6 5f 70 dd 9b d8 ea d5  d7 f5 d5 cc b9 b6 9f 30  |._p............0|
+000001d0  66 5b 66 9a 20 e2 27 e5  bf fe 3b 30 09 06 07 2a  |f[f. .'...;0...*|
+000001e0  86 48 ce 3d 04 01 03 81  8c 00 30 81 88 02 42 01  |.H.=......0...B.|
+000001f0  88 a2 4f eb e2 45 c5 48  7d 1b ac f5 ed 98 9d ae  |..O..E.H}.......|
+00000200  47 70 c0 5e 1b b6 2f bd  f1 b6 4d b7 61 40 d3 11  |Gp.^../...M.a@..|
+00000210  a2 ce ee 0b 7e 92 7e ff  76 9d c3 3b 7e a5 3f ce  |....~.~.v..;~.?.|
+00000220  fa 10 e2 59 ec 47 2d 7c  ac da 4e 97 0e 15 a0 6f  |...Y.G-|..N....o|
+00000230  d0 02 42 01 4d fc be 67  13 9c 2d 05 0e bd 3f a3  |..B.M..g..-...?.|
+00000240  8c 25 c1 33 13 83 0d 94  06 bb d4 37 7a f6 ec 7a  |.%.3.......7z..z|
+00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
+00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
+00000270  95 12 07 8f 2a 16 03 01  00 b5 0c 00 00 b1 03 00  |....*...........|
+00000280  1d 20 d8 71 32 54 18 4e  03 b2 c7 dd 0d 04 2f c5  |. .q2T.N....../.|
+00000290  c4 da f0 c8 72 b5 c0 b8  c1 a9 f7 e3 8d 1f 0d 3b  |....r..........;|
+000002a0  2a 08 00 8b 30 81 88 02  42 01 b6 59 64 4b 72 d6  |*...0...B..YdKr.|
+000002b0  ef 9e 3e 18 1d d4 da 89  e1 59 91 96 47 55 09 cd  |..>......Y..GU..|
+000002c0  ee a1 e9 0c db c9 6c bc  09 82 e1 4e 03 e7 c9 c5  |......l....N....|
+000002d0  78 bd 2f 28 dc fc 6a 8c  ed e7 43 74 4e e0 06 f6  |x./(..j...CtN...|
+000002e0  ee 85 f5 0f f9 c4 92 96  7d 69 4e 02 42 01 3f cc  |........}iN.B.?.|
+000002f0  89 ce 81 42 00 4f 89 28  3d 6d 6a 70 5a 6c d9 87  |...B.O.(=mjpZl..|
+00000300  a3 80 36 7f fa c1 a1 50  57 4b 93 bf a3 16 01 f5  |..6....PWK......|
+00000310  d4 07 4d fd 33 4a 2f 50  36 83 82 40 ef 8d aa 10  |..M.3J/P6..@....|
+00000320  6d d0 e0 24 bd d6 33 d0  96 87 ce 43 28 44 86 16  |m..$..3....C(D..|
+00000330  03 01 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
 00000000  16 03 01 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 01 00 01 01  |....._X.;t......|
-00000030  16 03 01 00 30 b0 5e 4a  8a 07 e3 86 43 05 16 68  |....0.^J....C..h|
-00000040  0e d1 58 a6 05 49 e9 a6  42 89 2c 3f 33 68 8b 26  |..X..I..B.,?3h.&|
-00000050  23 21 3b 62 ab 7a 21 74  d8 49 15 03 b3 1e c6 53  |#!;b.z!t.I.....S|
-00000060  74 1e 1c 4e 0f                                    |t..N.|
+00000030  16 03 01 00 30 56 e4 5e  74 7d 22 11 ce 6a 97 42  |....0V.^t}"..j.B|
+00000040  9f 6f 71 26 d4 a3 0f e4  03 1d 96 e1 ed a5 bd e4  |.oq&............|
+00000050  a5 96 7c b0 49 d4 bf fe  b2 3e d4 ed b0 52 f0 1b  |..|.I....>...R..|
+00000060  72 f4 45 ab a3                                    |r.E..|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 64 4b 3c 1a e3  |..........0dK<..|
-00000010  7d bb bb bb 64 d8 51 c3  eb 92 65 65 58 35 dd 7b  |}...d.Q...eeX5.{|
-00000020  d2 fd f0 0c c1 10 71 a5  a8 f7 14 84 69 b4 81 18  |......q.....i...|
-00000030  1e 0d d3 19 b6 23 72 1a  a7 43 0e                 |.....#r..C.|
+00000000  14 03 01 00 01 01 16 03  01 00 30 85 b6 39 e7 4e  |..........0..9.N|
+00000010  2d d9 aa 9c a7 a7 e9 13  a7 05 cb a4 c0 11 62 67  |-.............bg|
+00000020  34 6f b1 33 05 1e d0 a6  d1 20 f3 cc 47 7d ea 63  |4o.3..... ..G}.c|
+00000030  99 dc 34 46 8e 47 eb 5f  2c 1b b5                 |..4F.G._,..|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 c3 e6 70  2c 44 4f 04 0c fb 0b 7f  |.... ..p,DO.....|
-00000010  1d 2c ef 4d cc c3 21 ba  a2 db 74 76 46 ea 00 40  |.,.M..!...tvF..@|
-00000020  54 2d 4a fe 59 17 03 01  00 20 0c 6b 39 0d b5 f3  |T-J.Y.... .k9...|
-00000030  ed 7e d0 de 01 18 0c 32  4e 59 93 46 d3 c5 4f c0  |.~.....2NY.F..O.|
-00000040  f5 fd f1 d2 79 07 7d 07  b0 24 15 03 01 00 20 1d  |....y.}..$.... .|
-00000050  f7 53 a2 e7 3f 88 87 35  01 6e a5 b1 d6 81 37 5b  |.S..?..5.n....7[|
-00000060  a7 64 4c 29 f4 71 59 a1  36 c1 1a 24 93 31 7d     |.dL).qY.6..$.1}|
+00000000  17 03 01 00 20 35 6d 66  48 4a a0 ee 5a b7 2a 15  |.... 5mfHJ..Z.*.|
+00000010  c8 0c f7 86 16 f1 6a 96  51 28 9b 81 14 fd ac 92  |......j.Q(......|
+00000020  7b d0 9d be 24 17 03 01  00 20 08 f2 38 45 8e a3  |{...$.... ..8E..|
+00000030  89 50 5d 7f c8 5e 4f 71  7e 23 17 da 9b 99 a9 9d  |.P]..^Oq~#......|
+00000040  ed 51 8b 1a c8 67 fe 6c  c8 2a 15 03 01 00 20 e1  |.Q...g.l.*.... .|
+00000050  ef 54 d4 d3 e3 1e 5a db  c0 e9 92 8c 27 e5 86 dd  |.T....Z.....'...|
+00000060  29 78 cc 90 6b a7 9c 7b  b4 9b 1b 5d 1a 65 18     |)x..k..{...].e.|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES
index 24da556b25..e66b88a5c3 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv10-ECDHE-RSA-AES
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,89 +7,90 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 59 02 00 00  55 03 01 63 68 ea 52 0b  |....Y...U..ch.R.|
-00000010  dc 68 c7 d0 75 3e 7d 6f  0b 8c cb 25 48 b0 bb df  |.h..u>}o...%H...|
-00000020  7a 56 93 a9 d5 4f 0c 3a  e2 37 ab 20 1f 0f a4 d3  |zV...O.:.7. ....|
-00000030  b4 f6 66 6f 39 6f 62 fb  6a 1f 41 09 4b 02 5c 15  |..fo9ob.j.A.K.\.|
-00000040  a0 ba cb a6 f9 bd 3b ec  cb 76 6e ea c0 13 00 00  |......;..vn.....|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  01 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
-00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
-00000080  3f e2 5b ea a6 30 0d 06  09 2a 86 48 86 f7 0d 01  |?.[..0...*.H....|
-00000090  01 0b 05 00 30 1f 31 0b  30 09 06 03 55 04 0a 13  |....0.1.0...U...|
-000000a0  02 47 6f 31 10 30 0e 06  03 55 04 03 13 07 47 6f  |.Go1.0...U....Go|
-000000b0  20 52 6f 6f 74 30 1e 17  0d 31 36 30 31 30 31 30  | Root0...1601010|
-000000c0  30 30 30 30 30 5a 17 0d  32 35 30 31 30 31 30 30  |00000Z..25010100|
-000000d0  30 30 30 30 5a 30 1a 31  0b 30 09 06 03 55 04 0a  |0000Z0.1.0...U..|
-000000e0  13 02 47 6f 31 0b 30 09  06 03 55 04 03 13 02 47  |..Go1.0...U....G|
-000000f0  6f 30 81 9f 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |o0..0...*.H.....|
-00000100  01 05 00 03 81 8d 00 30  81 89 02 81 81 00 db 46  |.......0.......F|
-00000110  7d 93 2e 12 27 06 48 bc  06 28 21 ab 7e c4 b6 a2  |}...'.H..(!.~...|
-00000120  5d fe 1e 52 45 88 7a 36  47 a5 08 0d 92 42 5b c2  |]..RE.z6G....B[.|
-00000130  81 c0 be 97 79 98 40 fb  4f 6d 14 fd 2b 13 8b c2  |....y.@.Om..+...|
-00000140  a5 2e 67 d8 d4 09 9e d6  22 38 b7 4a 0b 74 73 2b  |..g....."8.J.ts+|
-00000150  c2 34 f1 d1 93 e5 96 d9  74 7b f3 58 9f 6c 61 3c  |.4......t{.X.la<|
-00000160  c0 b0 41 d4 d9 2b 2b 24  23 77 5b 1c 3b bd 75 5d  |..A..++$#w[.;.u]|
-00000170  ce 20 54 cf a1 63 87 1d  1e 24 c4 f3 1d 1a 50 8b  |. T..c...$....P.|
-00000180  aa b6 14 43 ed 97 a7 75  62 f4 14 c8 52 d7 02 03  |...C...ub...R...|
-00000190  01 00 01 a3 81 93 30 81  90 30 0e 06 03 55 1d 0f  |......0..0...U..|
-000001a0  01 01 ff 04 04 03 02 05  a0 30 1d 06 03 55 1d 25  |.........0...U.%|
-000001b0  04 16 30 14 06 08 2b 06  01 05 05 07 03 01 06 08  |..0...+.........|
-000001c0  2b 06 01 05 05 07 03 02  30 0c 06 03 55 1d 13 01  |+.......0...U...|
-000001d0  01 ff 04 02 30 00 30 19  06 03 55 1d 0e 04 12 04  |....0.0...U.....|
-000001e0  10 9f 91 16 1f 43 43 3e  49 a6 de 6d b6 80 d7 9f  |.....CC>I..m....|
-000001f0  60 30 1b 06 03 55 1d 23  04 14 30 12 80 10 48 13  |`0...U.#..0...H.|
-00000200  49 4d 13 7e 16 31 bb a3  01 d5 ac ab 6e 7b 30 19  |IM.~.1......n{0.|
-00000210  06 03 55 1d 11 04 12 30  10 82 0e 65 78 61 6d 70  |..U....0...examp|
-00000220  6c 65 2e 67 6f 6c 61 6e  67 30 0d 06 09 2a 86 48  |le.golang0...*.H|
-00000230  86 f7 0d 01 01 0b 05 00  03 81 81 00 9d 30 cc 40  |.............0.@|
-00000240  2b 5b 50 a0 61 cb ba e5  53 58 e1 ed 83 28 a9 58  |+[P.a...SX...(.X|
-00000250  1a a9 38 a4 95 a1 ac 31  5a 1a 84 66 3d 43 d3 2d  |..8....1Z..f=C.-|
-00000260  d9 0b f2 97 df d3 20 64  38 92 24 3a 00 bc cf 9c  |...... d8.$:....|
-00000270  7d b7 40 20 01 5f aa d3  16 61 09 a2 76 fd 13 c3  |}.@ ._...a..v...|
-00000280  cc e1 0c 5c ee b1 87 82  f1 6c 04 ed 73 bb b3 43  |...\.....l..s..C|
-00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
-000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
-000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 01 00  |.=.`.\!.;.......|
-000002c0  aa 0c 00 00 a6 03 00 1d  20 04 9f 8b 4f 13 83 26  |........ ...O..&|
-000002d0  a3 cf 08 6e 59 bf b5 49  b8 ff 95 94 21 8d 2a 56  |...nY..I....!.*V|
-000002e0  2e 4b be ad ac 89 6e 52  4d 00 80 5f 63 93 43 a2  |.K....nRM.._c.C.|
-000002f0  a6 fb 53 b0 ac 93 3f 55  1d c1 0f 71 1e 96 ba 9f  |..S...?U...q....|
-00000300  86 19 f3 83 7d 90 ce 06  24 9a 60 69 f0 35 24 5d  |....}...$.`i.5$]|
-00000310  9d ce 49 0d 6f ba 31 59  3c f2 64 27 66 76 0e f1  |..I.o.1Y<.d'fv..|
-00000320  33 eb b8 70 61 d3 0c 93  a3 62 c7 5e c2 06 9d 48  |3..pa....b.^...H|
-00000330  16 2e a6 62 50 18 f6 c0  79 c2 09 f3 d5 74 bf db  |...bP...y....t..|
-00000340  b8 d4 25 06 a7 be 4a b0  62 82 86 d0 00 86 5e a2  |..%...J.b.....^.|
-00000350  34 49 9b 37 37 9a b6 eb  cc b9 8b 17 1f 29 4b a3  |4I.77........)K.|
-00000360  51 e3 c3 e8 3e 6e df c4  1d e5 48 16 03 01 00 04  |Q...>n....H.....|
-00000370  0e 00 00 00                                       |....|
+00000000  16 03 01 00 5d 02 00 00  59 03 01 4c dc 79 d9 cc  |....]...Y..L.y..|
+00000010  4d 3e e9 7d b2 7c 46 0d  2d 2f ff 27 47 b1 e3 52  |M>.}.|F.-/.'G..R|
+00000020  b1 b4 34 80 6e 60 d5 b6  2d ab bd 20 d4 59 df e1  |..4.n`..-.. .Y..|
+00000030  99 75 36 f3 ac 26 40 99  74 f3 78 43 20 e0 da 18  |.u6..&@.t.xC ...|
+00000040  ae 5c bb bc b5 cc 3f c5  32 7e 3c ba c0 13 00 00  |.\....?.2~<.....|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 01 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
+00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
+00000080  00 e8 f0 9d 3f e2 5b ea  a6 30 0d 06 09 2a 86 48  |....?.[..0...*.H|
+00000090  86 f7 0d 01 01 0b 05 00  30 1f 31 0b 30 09 06 03  |........0.1.0...|
+000000a0  55 04 0a 13 02 47 6f 31  10 30 0e 06 03 55 04 03  |U....Go1.0...U..|
+000000b0  13 07 47 6f 20 52 6f 6f  74 30 1e 17 0d 31 36 30  |..Go Root0...160|
+000000c0  31 30 31 30 30 30 30 30  30 5a 17 0d 32 35 30 31  |101000000Z..2501|
+000000d0  30 31 30 30 30 30 30 30  5a 30 1a 31 0b 30 09 06  |01000000Z0.1.0..|
+000000e0  03 55 04 0a 13 02 47 6f  31 0b 30 09 06 03 55 04  |.U....Go1.0...U.|
+000000f0  03 13 02 47 6f 30 81 9f  30 0d 06 09 2a 86 48 86  |...Go0..0...*.H.|
+00000100  f7 0d 01 01 01 05 00 03  81 8d 00 30 81 89 02 81  |...........0....|
+00000110  81 00 db 46 7d 93 2e 12  27 06 48 bc 06 28 21 ab  |...F}...'.H..(!.|
+00000120  7e c4 b6 a2 5d fe 1e 52  45 88 7a 36 47 a5 08 0d  |~...]..RE.z6G...|
+00000130  92 42 5b c2 81 c0 be 97  79 98 40 fb 4f 6d 14 fd  |.B[.....y.@.Om..|
+00000140  2b 13 8b c2 a5 2e 67 d8  d4 09 9e d6 22 38 b7 4a  |+.....g....."8.J|
+00000150  0b 74 73 2b c2 34 f1 d1  93 e5 96 d9 74 7b f3 58  |.ts+.4......t{.X|
+00000160  9f 6c 61 3c c0 b0 41 d4  d9 2b 2b 24 23 77 5b 1c  |.la<..A..++$#w[.|
+00000170  3b bd 75 5d ce 20 54 cf  a1 63 87 1d 1e 24 c4 f3  |;.u]. T..c...$..|
+00000180  1d 1a 50 8b aa b6 14 43  ed 97 a7 75 62 f4 14 c8  |..P....C...ub...|
+00000190  52 d7 02 03 01 00 01 a3  81 93 30 81 90 30 0e 06  |R.........0..0..|
+000001a0  03 55 1d 0f 01 01 ff 04  04 03 02 05 a0 30 1d 06  |.U...........0..|
+000001b0  03 55 1d 25 04 16 30 14  06 08 2b 06 01 05 05 07  |.U.%..0...+.....|
+000001c0  03 01 06 08 2b 06 01 05  05 07 03 02 30 0c 06 03  |....+.......0...|
+000001d0  55 1d 13 01 01 ff 04 02  30 00 30 19 06 03 55 1d  |U.......0.0...U.|
+000001e0  0e 04 12 04 10 9f 91 16  1f 43 43 3e 49 a6 de 6d  |.........CC>I..m|
+000001f0  b6 80 d7 9f 60 30 1b 06  03 55 1d 23 04 14 30 12  |....`0...U.#..0.|
+00000200  80 10 48 13 49 4d 13 7e  16 31 bb a3 01 d5 ac ab  |..H.IM.~.1......|
+00000210  6e 7b 30 19 06 03 55 1d  11 04 12 30 10 82 0e 65  |n{0...U....0...e|
+00000220  78 61 6d 70 6c 65 2e 67  6f 6c 61 6e 67 30 0d 06  |xample.golang0..|
+00000230  09 2a 86 48 86 f7 0d 01  01 0b 05 00 03 81 81 00  |.*.H............|
+00000240  9d 30 cc 40 2b 5b 50 a0  61 cb ba e5 53 58 e1 ed  |.0.@+[P.a...SX..|
+00000250  83 28 a9 58 1a a9 38 a4  95 a1 ac 31 5a 1a 84 66  |.(.X..8....1Z..f|
+00000260  3d 43 d3 2d d9 0b f2 97  df d3 20 64 38 92 24 3a  |=C.-...... d8.$:|
+00000270  00 bc cf 9c 7d b7 40 20  01 5f aa d3 16 61 09 a2  |....}.@ ._...a..|
+00000280  76 fd 13 c3 cc e1 0c 5c  ee b1 87 82 f1 6c 04 ed  |v......\.....l..|
+00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
+000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
+000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
+000002c0  16 03 01 00 aa 0c 00 00  a6 03 00 1d 20 ee 7b 17  |............ .{.|
+000002d0  15 a8 03 82 b4 bc ec 9a  6f 77 a8 29 29 2f ed 2e  |........ow.))/..|
+000002e0  65 91 4f 38 b4 e3 a8 f6  48 be c9 c4 26 00 80 ae  |e.O8....H...&...|
+000002f0  ef 11 b3 78 c2 8b 4d 86  38 c6 4e 86 1c 26 57 24  |...x..M.8.N..&W$|
+00000300  cf 21 12 b1 74 13 eb 12  c4 90 5a a2 eb 2c 9b 97  |.!..t.....Z..,..|
+00000310  23 f6 8f 4f 25 b8 70 fe  b1 dc 95 b5 0c 8f 0b 0d  |#..O%.p.........|
+00000320  d9 23 40 a9 48 c3 52 08  0f 4b d4 7d 9f f3 e3 4e  |.#@.H.R..K.}...N|
+00000330  8e 14 98 7c ac e9 ee a3  53 0c 25 bf 8e 06 a5 cb  |...|....S.%.....|
+00000340  6e 96 76 37 be 8a c8 2e  c3 72 cc 8d 12 78 bc 20  |n.v7.....r...x. |
+00000350  8c 53 0e e7 72 59 4d 46  34 72 27 37 6d 2c 88 d6  |.S..rYMF4r'7m,..|
+00000360  cd 0f ab 6d e1 2d a0 3c  df 04 35 d9 d2 2d f5 16  |...m.-.<..5..-..|
+00000370  03 01 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
 00000000  16 03 01 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 01 00 01 01  |....._X.;t......|
-00000030  16 03 01 00 30 a6 3a 66  02 e6 09 6a dd 68 56 bc  |....0.:f...j.hV.|
-00000040  aa ec 82 c4 69 9b b9 45  44 ec e2 c2 5b 49 5d 9b  |....i..ED...[I].|
-00000050  f8 0e 81 1e 23 9e 13 72  d1 d2 0c 24 01 4f 35 aa  |....#..r...$.O5.|
-00000060  27 fc b3 cc 08                                    |'....|
+00000030  16 03 01 00 30 af af 7d  17 17 49 08 86 ba 49 c7  |....0..}..I...I.|
+00000040  01 e9 f2 85 f4 70 2d 37  38 b3 38 4d c3 23 0f f5  |.....p-78.8M.#..|
+00000050  fe f3 22 58 6a ec cd ee  17 92 d0 fe aa d8 68 ff  |.."Xj.........h.|
+00000060  1d b1 7a 5b 6a                                    |..z[j|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 0e 25 d7 a9 c0  |..........0.%...|
-00000010  18 3b bf 55 c0 47 3a 95  2d cb 6f c2 2c de e3 94  |.;.U.G:.-.o.,...|
-00000020  32 d3 eb e2 b6 6b 5f 42  9c 1e 47 d6 76 0c eb 95  |2....k_B..G.v...|
-00000030  fd 2d c3 9a ee ee 83 87  e8 8d 83                 |.-.........|
+00000000  14 03 01 00 01 01 16 03  01 00 30 30 b9 1b da 00  |..........00....|
+00000010  85 eb 23 f3 69 6a 96 34  f1 03 b8 51 c4 0c 09 a7  |..#.ij.4...Q....|
+00000020  62 4c 14 c6 fb ee b0 2b  f0 fc e6 9b b6 97 47 83  |bL.....+......G.|
+00000030  20 3d fe c4 42 43 6f c1  2f 09 6a                 | =..BCo./.j|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 ba b0 c4  22 ee 52 81 ca 55 97 4d  |.... ...".R..U.M|
-00000010  39 16 b9 37 bf df 7b d1  ae 4b 47 ac 10 12 a9 77  |9..7..{..KG....w|
-00000020  69 50 f3 60 13 17 03 01  00 20 90 d5 17 e4 96 38  |iP.`..... .....8|
-00000030  cd f7 30 6e 19 45 4e 32  ad 5f 1b 00 bf 22 9d c2  |..0n.EN2._..."..|
-00000040  16 30 fe 92 c7 fc 91 38  29 30 15 03 01 00 20 c0  |.0.....8)0.... .|
-00000050  02 ff 81 82 c9 25 c6 b0  06 ee 18 61 19 c8 d2 20  |.....%.....a... |
-00000060  d8 4e 7b a4 a5 57 17 64  4d ad 1e 1e 16 1e 52     |.N{..W.dM.....R|
+00000000  17 03 01 00 20 42 e3 37  32 c0 b5 bb fb 9b 26 9e  |.... B.72.....&.|
+00000010  1b b1 28 ee c7 44 c3 7c  c8 51 88 3a e9 5a c7 2f  |..(..D.|.Q.:.Z./|
+00000020  b6 0d 73 ee 3e 17 03 01  00 20 20 33 1e 5f 0f 81  |..s.>....  3._..|
+00000030  aa 06 15 f1 e6 24 f3 12  07 ad 78 a6 0f 18 ad 33  |.....$....x....3|
+00000040  67 d4 1c ec 28 15 65 de  e2 6e 15 03 01 00 20 b0  |g...(.e..n.... .|
+00000050  93 62 04 fe 6e 3f 41 a5  c8 e8 6c 9d a7 96 59 ba  |.b..n?A...l...Y.|
+00000060  aa 81 c8 ff ef 66 91 89  5f 9c ba d1 aa e7 ef     |.....f.._......|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-ExportKeyingMaterial b/src/crypto/tls/testdata/Client-TLSv10-ExportKeyingMaterial
index 6a40d83279..8225f78eb7 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-ExportKeyingMaterial
+++ b/src/crypto/tls/testdata/Client-TLSv10-ExportKeyingMaterial
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,89 +7,90 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 59 02 00 00  55 03 01 05 31 9d 41 04  |....Y...U...1.A.|
-00000010  c0 d4 34 1a fc 0f 63 26  47 d6 13 7f a0 d8 aa bf  |..4...c&G.......|
-00000020  28 92 04 80 02 75 58 e6  01 e1 30 20 3c fc b0 02  |(....uX...0 <...|
-00000030  8b a4 9e 9e b2 5c 17 3c  48 0b 96 6f 15 80 d5 38  |.....\.<H..o...8|
-00000040  25 a2 f8 fb 6b fd 47 27  c2 53 6c 60 c0 13 00 00  |%...k.G'.Sl`....|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  01 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
-00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
-00000080  3f e2 5b ea a6 30 0d 06  09 2a 86 48 86 f7 0d 01  |?.[..0...*.H....|
-00000090  01 0b 05 00 30 1f 31 0b  30 09 06 03 55 04 0a 13  |....0.1.0...U...|
-000000a0  02 47 6f 31 10 30 0e 06  03 55 04 03 13 07 47 6f  |.Go1.0...U....Go|
-000000b0  20 52 6f 6f 74 30 1e 17  0d 31 36 30 31 30 31 30  | Root0...1601010|
-000000c0  30 30 30 30 30 5a 17 0d  32 35 30 31 30 31 30 30  |00000Z..25010100|
-000000d0  30 30 30 30 5a 30 1a 31  0b 30 09 06 03 55 04 0a  |0000Z0.1.0...U..|
-000000e0  13 02 47 6f 31 0b 30 09  06 03 55 04 03 13 02 47  |..Go1.0...U....G|
-000000f0  6f 30 81 9f 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |o0..0...*.H.....|
-00000100  01 05 00 03 81 8d 00 30  81 89 02 81 81 00 db 46  |.......0.......F|
-00000110  7d 93 2e 12 27 06 48 bc  06 28 21 ab 7e c4 b6 a2  |}...'.H..(!.~...|
-00000120  5d fe 1e 52 45 88 7a 36  47 a5 08 0d 92 42 5b c2  |]..RE.z6G....B[.|
-00000130  81 c0 be 97 79 98 40 fb  4f 6d 14 fd 2b 13 8b c2  |....y.@.Om..+...|
-00000140  a5 2e 67 d8 d4 09 9e d6  22 38 b7 4a 0b 74 73 2b  |..g....."8.J.ts+|
-00000150  c2 34 f1 d1 93 e5 96 d9  74 7b f3 58 9f 6c 61 3c  |.4......t{.X.la<|
-00000160  c0 b0 41 d4 d9 2b 2b 24  23 77 5b 1c 3b bd 75 5d  |..A..++$#w[.;.u]|
-00000170  ce 20 54 cf a1 63 87 1d  1e 24 c4 f3 1d 1a 50 8b  |. T..c...$....P.|
-00000180  aa b6 14 43 ed 97 a7 75  62 f4 14 c8 52 d7 02 03  |...C...ub...R...|
-00000190  01 00 01 a3 81 93 30 81  90 30 0e 06 03 55 1d 0f  |......0..0...U..|
-000001a0  01 01 ff 04 04 03 02 05  a0 30 1d 06 03 55 1d 25  |.........0...U.%|
-000001b0  04 16 30 14 06 08 2b 06  01 05 05 07 03 01 06 08  |..0...+.........|
-000001c0  2b 06 01 05 05 07 03 02  30 0c 06 03 55 1d 13 01  |+.......0...U...|
-000001d0  01 ff 04 02 30 00 30 19  06 03 55 1d 0e 04 12 04  |....0.0...U.....|
-000001e0  10 9f 91 16 1f 43 43 3e  49 a6 de 6d b6 80 d7 9f  |.....CC>I..m....|
-000001f0  60 30 1b 06 03 55 1d 23  04 14 30 12 80 10 48 13  |`0...U.#..0...H.|
-00000200  49 4d 13 7e 16 31 bb a3  01 d5 ac ab 6e 7b 30 19  |IM.~.1......n{0.|
-00000210  06 03 55 1d 11 04 12 30  10 82 0e 65 78 61 6d 70  |..U....0...examp|
-00000220  6c 65 2e 67 6f 6c 61 6e  67 30 0d 06 09 2a 86 48  |le.golang0...*.H|
-00000230  86 f7 0d 01 01 0b 05 00  03 81 81 00 9d 30 cc 40  |.............0.@|
-00000240  2b 5b 50 a0 61 cb ba e5  53 58 e1 ed 83 28 a9 58  |+[P.a...SX...(.X|
-00000250  1a a9 38 a4 95 a1 ac 31  5a 1a 84 66 3d 43 d3 2d  |..8....1Z..f=C.-|
-00000260  d9 0b f2 97 df d3 20 64  38 92 24 3a 00 bc cf 9c  |...... d8.$:....|
-00000270  7d b7 40 20 01 5f aa d3  16 61 09 a2 76 fd 13 c3  |}.@ ._...a..v...|
-00000280  cc e1 0c 5c ee b1 87 82  f1 6c 04 ed 73 bb b3 43  |...\.....l..s..C|
-00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
-000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
-000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 01 00  |.=.`.\!.;.......|
-000002c0  aa 0c 00 00 a6 03 00 1d  20 a4 50 9a 0d c7 2a 1b  |........ .P...*.|
-000002d0  f6 d4 78 49 68 ac 5f 8b  e7 78 68 05 4b f8 c6 b3  |..xIh._..xh.K...|
-000002e0  eb 28 79 96 d5 e6 aa c1  54 00 80 22 66 ec fd 14  |.(y.....T.."f...|
-000002f0  83 7b 03 86 14 75 84 a4  a6 d0 ee d3 d0 f7 95 d8  |.{...u..........|
-00000300  43 48 a4 eb 83 af 96 ac  cf e8 65 20 05 c3 18 9a  |CH........e ....|
-00000310  54 63 f5 2f b7 17 06 e0  2a b3 65 6a 2f cc cd 93  |Tc./....*.ej/...|
-00000320  1e b3 5a 4d 09 da 70 b0  12 46 60 11 e4 9f ee 9f  |..ZM..p..F`.....|
-00000330  3b 6f ef df bc db 69 22  5e e8 4c 41 d6 b7 7b 06  |;o....i"^.LA..{.|
-00000340  b6 99 1c 6d 01 5a 61 7c  4e 3a af 3e 01 7e 46 bd  |...m.Za|N:.>.~F.|
-00000350  c8 15 28 ba 7f b3 d6 9d  95 74 04 36 6c 38 16 86  |..(......t.6l8..|
-00000360  d2 1d 8a 85 d1 21 5c 33  17 50 a1 16 03 01 00 04  |.....!\3.P......|
-00000370  0e 00 00 00                                       |....|
+00000000  16 03 01 00 5d 02 00 00  59 03 01 b7 20 c3 67 7b  |....]...Y... .g{|
+00000010  94 6e d7 da ea e0 77 4e  05 ad e0 9b a2 97 59 e3  |.n....wN......Y.|
+00000020  de 61 a2 49 d0 2f 27 7d  fc 7c 4e 20 9a 18 52 f9  |.a.I./'}.|N ..R.|
+00000030  bf ec 13 7d 28 1a 44 14  ea 77 25 7a 30 81 36 1e  |...}(.D..w%z0.6.|
+00000040  18 b3 23 37 79 dc 10 e8  f2 18 90 c7 c0 13 00 00  |..#7y...........|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 01 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
+00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
+00000080  00 e8 f0 9d 3f e2 5b ea  a6 30 0d 06 09 2a 86 48  |....?.[..0...*.H|
+00000090  86 f7 0d 01 01 0b 05 00  30 1f 31 0b 30 09 06 03  |........0.1.0...|
+000000a0  55 04 0a 13 02 47 6f 31  10 30 0e 06 03 55 04 03  |U....Go1.0...U..|
+000000b0  13 07 47 6f 20 52 6f 6f  74 30 1e 17 0d 31 36 30  |..Go Root0...160|
+000000c0  31 30 31 30 30 30 30 30  30 5a 17 0d 32 35 30 31  |101000000Z..2501|
+000000d0  30 31 30 30 30 30 30 30  5a 30 1a 31 0b 30 09 06  |01000000Z0.1.0..|
+000000e0  03 55 04 0a 13 02 47 6f  31 0b 30 09 06 03 55 04  |.U....Go1.0...U.|
+000000f0  03 13 02 47 6f 30 81 9f  30 0d 06 09 2a 86 48 86  |...Go0..0...*.H.|
+00000100  f7 0d 01 01 01 05 00 03  81 8d 00 30 81 89 02 81  |...........0....|
+00000110  81 00 db 46 7d 93 2e 12  27 06 48 bc 06 28 21 ab  |...F}...'.H..(!.|
+00000120  7e c4 b6 a2 5d fe 1e 52  45 88 7a 36 47 a5 08 0d  |~...]..RE.z6G...|
+00000130  92 42 5b c2 81 c0 be 97  79 98 40 fb 4f 6d 14 fd  |.B[.....y.@.Om..|
+00000140  2b 13 8b c2 a5 2e 67 d8  d4 09 9e d6 22 38 b7 4a  |+.....g....."8.J|
+00000150  0b 74 73 2b c2 34 f1 d1  93 e5 96 d9 74 7b f3 58  |.ts+.4......t{.X|
+00000160  9f 6c 61 3c c0 b0 41 d4  d9 2b 2b 24 23 77 5b 1c  |.la<..A..++$#w[.|
+00000170  3b bd 75 5d ce 20 54 cf  a1 63 87 1d 1e 24 c4 f3  |;.u]. T..c...$..|
+00000180  1d 1a 50 8b aa b6 14 43  ed 97 a7 75 62 f4 14 c8  |..P....C...ub...|
+00000190  52 d7 02 03 01 00 01 a3  81 93 30 81 90 30 0e 06  |R.........0..0..|
+000001a0  03 55 1d 0f 01 01 ff 04  04 03 02 05 a0 30 1d 06  |.U...........0..|
+000001b0  03 55 1d 25 04 16 30 14  06 08 2b 06 01 05 05 07  |.U.%..0...+.....|
+000001c0  03 01 06 08 2b 06 01 05  05 07 03 02 30 0c 06 03  |....+.......0...|
+000001d0  55 1d 13 01 01 ff 04 02  30 00 30 19 06 03 55 1d  |U.......0.0...U.|
+000001e0  0e 04 12 04 10 9f 91 16  1f 43 43 3e 49 a6 de 6d  |.........CC>I..m|
+000001f0  b6 80 d7 9f 60 30 1b 06  03 55 1d 23 04 14 30 12  |....`0...U.#..0.|
+00000200  80 10 48 13 49 4d 13 7e  16 31 bb a3 01 d5 ac ab  |..H.IM.~.1......|
+00000210  6e 7b 30 19 06 03 55 1d  11 04 12 30 10 82 0e 65  |n{0...U....0...e|
+00000220  78 61 6d 70 6c 65 2e 67  6f 6c 61 6e 67 30 0d 06  |xample.golang0..|
+00000230  09 2a 86 48 86 f7 0d 01  01 0b 05 00 03 81 81 00  |.*.H............|
+00000240  9d 30 cc 40 2b 5b 50 a0  61 cb ba e5 53 58 e1 ed  |.0.@+[P.a...SX..|
+00000250  83 28 a9 58 1a a9 38 a4  95 a1 ac 31 5a 1a 84 66  |.(.X..8....1Z..f|
+00000260  3d 43 d3 2d d9 0b f2 97  df d3 20 64 38 92 24 3a  |=C.-...... d8.$:|
+00000270  00 bc cf 9c 7d b7 40 20  01 5f aa d3 16 61 09 a2  |....}.@ ._...a..|
+00000280  76 fd 13 c3 cc e1 0c 5c  ee b1 87 82 f1 6c 04 ed  |v......\.....l..|
+00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
+000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
+000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
+000002c0  16 03 01 00 aa 0c 00 00  a6 03 00 1d 20 99 c4 bc  |............ ...|
+000002d0  cb 82 39 73 e7 54 86 b6  36 ae 7a 82 4e 4a fc 6a  |..9s.T..6.z.NJ.j|
+000002e0  19 ed 81 7b 53 03 2f 90  92 de 2a 84 65 00 80 01  |...{S./...*.e...|
+000002f0  4d 05 a7 5b ac 30 c4 47  68 1b 27 ce f9 9b bd 31  |M..[.0.Gh.'....1|
+00000300  08 90 21 16 c9 20 3c 72  da e4 8b ce 6b d5 d6 47  |..!.. <r....k..G|
+00000310  6d 8f 11 f1 36 7e 25 b0  5f 21 59 0c 1d 3b ec ae  |m...6~%._!Y..;..|
+00000320  30 46 c4 4d 27 c5 31 cf  b3 b2 44 88 2f 6f 89 1d  |0F.M'.1...D./o..|
+00000330  09 44 1b 5e da 54 6c 3f  ab cf 3b 72 e8 46 63 2e  |.D.^.Tl?..;r.Fc.|
+00000340  2a 8f d6 a2 d8 83 75 17  08 0e 50 95 18 77 cb c1  |*.....u...P..w..|
+00000350  62 d3 2c b8 6c 26 ec 36  bb 48 54 72 b9 2f de 65  |b.,.l&.6.HTr./.e|
+00000360  e7 c9 c1 49 d7 5c 1f 41  bc f0 1e 14 a1 40 1b 16  |...I.\.A.....@..|
+00000370  03 01 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
 00000000  16 03 01 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 01 00 01 01  |....._X.;t......|
-00000030  16 03 01 00 30 f0 15 ea  81 0f a6 22 0a cd a5 a1  |....0......"....|
-00000040  38 4a da 1b 6c 81 19 d5  35 b7 af e9 ec 16 4d 98  |8J..l...5.....M.|
-00000050  21 c2 0e f7 0b fb ff d8  1e 2d 8b 04 56 82 48 c4  |!........-..V.H.|
-00000060  e5 f9 38 8c d2                                    |..8..|
+00000030  16 03 01 00 30 43 fc 64  73 ed 5b eb ac 0e 09 cf  |....0C.ds.[.....|
+00000040  ae 3e 3c 8c 0a ab b5 a9  c0 32 ed 8d ea 71 ed 87  |.><......2...q..|
+00000050  e5 ee d7 0c 9d a4 09 c6  9b 1d b2 86 2f a3 2e 77  |............/..w|
+00000060  aa b2 5c 6f b0                                    |..\o.|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 f0 b5 a3 bb bb  |..........0.....|
-00000010  9d 85 7d 6f e7 a9 17 31  65 74 82 69 56 a9 33 21  |..}o...1et.iV.3!|
-00000020  16 9d 75 3a 28 88 a5 c2  a9 e1 a7 43 6e 03 26 96  |..u:(......Cn.&.|
-00000030  37 4b de 63 be 49 cb c8  d4 a2 b6                 |7K.c.I.....|
+00000000  14 03 01 00 01 01 16 03  01 00 30 c5 aa 36 4d 9a  |..........0..6M.|
+00000010  7a e6 ea 66 2e 63 2d 69  9b b4 91 fa fc f1 f7 a5  |z..f.c-i........|
+00000020  19 17 eb da d6 95 d9 95  42 09 4c 54 30 60 c9 00  |........B.LT0`..|
+00000030  d4 a1 9e 25 dd 62 f0 33  29 43 9c                 |...%.b.3)C.|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 20 a9 9c 8f  74 ce f9 77 bc b3 86 2e  |.... ...t..w....|
-00000010  a5 8e 94 3d 08 a6 96 bf  25 0b 10 c4 66 c2 59 9a  |...=....%...f.Y.|
-00000020  4a 1a b4 77 12 17 03 01  00 20 03 72 60 38 58 88  |J..w..... .r`8X.|
-00000030  86 20 20 3f 18 52 c5 ca  55 3c 04 04 c7 e1 74 6f  |.  ?.R..U<....to|
-00000040  ca 1f cd 27 64 f2 51 12  9c ee 15 03 01 00 20 30  |...'d.Q....... 0|
-00000050  71 2a 78 bf 8b d5 11 7c  63 11 c7 25 0e 56 25 ce  |q*x....|c..%.V%.|
-00000060  24 d5 d7 de a0 ba c7 ba  e6 dc db 8e e3 93 a6     |$..............|
+00000000  17 03 01 00 20 44 84 33  58 99 c7 71 39 e6 fa 89  |.... D.3X..q9...|
+00000010  f9 a2 bd 15 9a 41 2f e7  27 1a 33 e9 89 ce 24 4c  |.....A/.'.3...$L|
+00000020  db cf c6 11 15 17 03 01  00 20 e5 5a 7b 6b ea 19  |......... .Z{k..|
+00000030  f1 55 77 54 b6 a0 c0 c6  02 d6 ce 49 b6 93 91 d3  |.UwT.......I....|
+00000040  7f 8a 93 d1 73 8d d6 f6  56 b6 15 03 01 00 20 71  |....s...V..... q|
+00000050  26 23 0c 06 c6 08 13 2d  f3 b2 c0 91 f3 11 c4 23  |&#.....-.......#|
+00000060  c3 57 79 eb ff 8b e1 81  12 fb 13 02 26 b1 5b     |.Wy.........&.[|
diff --git a/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4 b/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4
index dcc18ad01d..219462a31a 100644
--- a/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4
+++ b/src/crypto/tls/testdata/Client-TLSv10-RSA-RC4
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,59 +7,61 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 51 02 00 00  4d 03 01 2a 09 26 d2 61  |....Q...M..*.&.a|
-00000010  ac 38 91 3d 18 3f f7 a9  3c 34 91 b0 b1 e1 29 68  |.8.=.?..<4....)h|
-00000020  dd cb b9 a9 d8 39 0b 64  c6 93 7d 20 ea 51 ff 63  |.....9.d..} .Q.c|
-00000030  97 03 b2 6f a3 d6 55 0d  64 65 2a 5d 3a fe e9 3e  |...o..U.de*]:..>|
-00000040  47 c1 7d c5 d8 03 c6 22  19 2f 6c 5a 00 05 00 00  |G.}...."./lZ....|
-00000050  05 ff 01 00 01 00 16 03  01 02 59 0b 00 02 55 00  |..........Y...U.|
-00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
-00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
-00000080  09 2a 86 48 86 f7 0d 01  01 0b 05 00 30 1f 31 0b  |.*.H........0.1.|
-00000090  30 09 06 03 55 04 0a 13  02 47 6f 31 10 30 0e 06  |0...U....Go1.0..|
-000000a0  03 55 04 03 13 07 47 6f  20 52 6f 6f 74 30 1e 17  |.U....Go Root0..|
-000000b0  0d 31 36 30 31 30 31 30  30 30 30 30 30 5a 17 0d  |.160101000000Z..|
-000000c0  32 35 30 31 30 31 30 30  30 30 30 30 5a 30 1a 31  |250101000000Z0.1|
-000000d0  0b 30 09 06 03 55 04 0a  13 02 47 6f 31 0b 30 09  |.0...U....Go1.0.|
-000000e0  06 03 55 04 03 13 02 47  6f 30 81 9f 30 0d 06 09  |..U....Go0..0...|
-000000f0  2a 86 48 86 f7 0d 01 01  01 05 00 03 81 8d 00 30  |*.H............0|
-00000100  81 89 02 81 81 00 db 46  7d 93 2e 12 27 06 48 bc  |.......F}...'.H.|
-00000110  06 28 21 ab 7e c4 b6 a2  5d fe 1e 52 45 88 7a 36  |.(!.~...]..RE.z6|
-00000120  47 a5 08 0d 92 42 5b c2  81 c0 be 97 79 98 40 fb  |G....B[.....y.@.|
-00000130  4f 6d 14 fd 2b 13 8b c2  a5 2e 67 d8 d4 09 9e d6  |Om..+.....g.....|
-00000140  22 38 b7 4a 0b 74 73 2b  c2 34 f1 d1 93 e5 96 d9  |"8.J.ts+.4......|
-00000150  74 7b f3 58 9f 6c 61 3c  c0 b0 41 d4 d9 2b 2b 24  |t{.X.la<..A..++$|
-00000160  23 77 5b 1c 3b bd 75 5d  ce 20 54 cf a1 63 87 1d  |#w[.;.u]. T..c..|
-00000170  1e 24 c4 f3 1d 1a 50 8b  aa b6 14 43 ed 97 a7 75  |.$....P....C...u|
-00000180  62 f4 14 c8 52 d7 02 03  01 00 01 a3 81 93 30 81  |b...R.........0.|
-00000190  90 30 0e 06 03 55 1d 0f  01 01 ff 04 04 03 02 05  |.0...U..........|
-000001a0  a0 30 1d 06 03 55 1d 25  04 16 30 14 06 08 2b 06  |.0...U.%..0...+.|
-000001b0  01 05 05 07 03 01 06 08  2b 06 01 05 05 07 03 02  |........+.......|
-000001c0  30 0c 06 03 55 1d 13 01  01 ff 04 02 30 00 30 19  |0...U.......0.0.|
-000001d0  06 03 55 1d 0e 04 12 04  10 9f 91 16 1f 43 43 3e  |..U..........CC>|
-000001e0  49 a6 de 6d b6 80 d7 9f  60 30 1b 06 03 55 1d 23  |I..m....`0...U.#|
-000001f0  04 14 30 12 80 10 48 13  49 4d 13 7e 16 31 bb a3  |..0...H.IM.~.1..|
-00000200  01 d5 ac ab 6e 7b 30 19  06 03 55 1d 11 04 12 30  |....n{0...U....0|
-00000210  10 82 0e 65 78 61 6d 70  6c 65 2e 67 6f 6c 61 6e  |...example.golan|
-00000220  67 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |g0...*.H........|
-00000230  03 81 81 00 9d 30 cc 40  2b 5b 50 a0 61 cb ba e5  |.....0.@+[P.a...|
-00000240  53 58 e1 ed 83 28 a9 58  1a a9 38 a4 95 a1 ac 31  |SX...(.X..8....1|
-00000250  5a 1a 84 66 3d 43 d3 2d  d9 0b f2 97 df d3 20 64  |Z..f=C.-...... d|
-00000260  38 92 24 3a 00 bc cf 9c  7d b7 40 20 01 5f aa d3  |8.$:....}.@ ._..|
-00000270  16 61 09 a2 76 fd 13 c3  cc e1 0c 5c ee b1 87 82  |.a..v......\....|
-00000280  f1 6c 04 ed 73 bb b3 43  77 8d 0c 1c f1 0f a1 d8  |.l..s..Cw.......|
-00000290  40 83 61 c9 4c 72 2b 9d  ae db 46 06 06 4d f4 c1  |@.a.Lr+...F..M..|
-000002a0  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
-000002b0  3b e9 fa e7 16 03 01 00  04 0e 00 00 00           |;............|
+00000000  16 03 01 00 55 02 00 00  51 03 01 73 52 96 88 0a  |....U...Q..sR...|
+00000010  35 f9 ca 22 44 32 ec 69  08 b1 4d b3 6b 70 18 92  |5.."D2.i..M.kp..|
+00000020  af 91 bf 82 00 be 1d bf  b4 2f 00 20 f3 e2 c8 e0  |........./. ....|
+00000030  5f 1a 7f 0c 69 f4 6b 74  44 39 b1 2a b9 33 8f 32  |_...i.ktD9.*.3.2|
+00000040  50 37 63 15 69 bc 45 d3  db a7 28 09 00 05 00 00  |P7c.i.E...(.....|
+00000050  09 ff 01 00 01 00 00 17  00 00 16 03 01 02 59 0b  |..............Y.|
+00000060  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
+00000070  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
+00000080  a6 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |.0...*.H........|
+00000090  30 1f 31 0b 30 09 06 03  55 04 0a 13 02 47 6f 31  |0.1.0...U....Go1|
+000000a0  10 30 0e 06 03 55 04 03  13 07 47 6f 20 52 6f 6f  |.0...U....Go Roo|
+000000b0  74 30 1e 17 0d 31 36 30  31 30 31 30 30 30 30 30  |t0...16010100000|
+000000c0  30 5a 17 0d 32 35 30 31  30 31 30 30 30 30 30 30  |0Z..250101000000|
+000000d0  5a 30 1a 31 0b 30 09 06  03 55 04 0a 13 02 47 6f  |Z0.1.0...U....Go|
+000000e0  31 0b 30 09 06 03 55 04  03 13 02 47 6f 30 81 9f  |1.0...U....Go0..|
+000000f0  30 0d 06 09 2a 86 48 86  f7 0d 01 01 01 05 00 03  |0...*.H.........|
+00000100  81 8d 00 30 81 89 02 81  81 00 db 46 7d 93 2e 12  |...0.......F}...|
+00000110  27 06 48 bc 06 28 21 ab  7e c4 b6 a2 5d fe 1e 52  |'.H..(!.~...]..R|
+00000120  45 88 7a 36 47 a5 08 0d  92 42 5b c2 81 c0 be 97  |E.z6G....B[.....|
+00000130  79 98 40 fb 4f 6d 14 fd  2b 13 8b c2 a5 2e 67 d8  |y.@.Om..+.....g.|
+00000140  d4 09 9e d6 22 38 b7 4a  0b 74 73 2b c2 34 f1 d1  |...."8.J.ts+.4..|
+00000150  93 e5 96 d9 74 7b f3 58  9f 6c 61 3c c0 b0 41 d4  |....t{.X.la<..A.|
+00000160  d9 2b 2b 24 23 77 5b 1c  3b bd 75 5d ce 20 54 cf  |.++$#w[.;.u]. T.|
+00000170  a1 63 87 1d 1e 24 c4 f3  1d 1a 50 8b aa b6 14 43  |.c...$....P....C|
+00000180  ed 97 a7 75 62 f4 14 c8  52 d7 02 03 01 00 01 a3  |...ub...R.......|
+00000190  81 93 30 81 90 30 0e 06  03 55 1d 0f 01 01 ff 04  |..0..0...U......|
+000001a0  04 03 02 05 a0 30 1d 06  03 55 1d 25 04 16 30 14  |.....0...U.%..0.|
+000001b0  06 08 2b 06 01 05 05 07  03 01 06 08 2b 06 01 05  |..+.........+...|
+000001c0  05 07 03 02 30 0c 06 03  55 1d 13 01 01 ff 04 02  |....0...U.......|
+000001d0  30 00 30 19 06 03 55 1d  0e 04 12 04 10 9f 91 16  |0.0...U.........|
+000001e0  1f 43 43 3e 49 a6 de 6d  b6 80 d7 9f 60 30 1b 06  |.CC>I..m....`0..|
+000001f0  03 55 1d 23 04 14 30 12  80 10 48 13 49 4d 13 7e  |.U.#..0...H.IM.~|
+00000200  16 31 bb a3 01 d5 ac ab  6e 7b 30 19 06 03 55 1d  |.1......n{0...U.|
+00000210  11 04 12 30 10 82 0e 65  78 61 6d 70 6c 65 2e 67  |...0...example.g|
+00000220  6f 6c 61 6e 67 30 0d 06  09 2a 86 48 86 f7 0d 01  |olang0...*.H....|
+00000230  01 0b 05 00 03 81 81 00  9d 30 cc 40 2b 5b 50 a0  |.........0.@+[P.|
+00000240  61 cb ba e5 53 58 e1 ed  83 28 a9 58 1a a9 38 a4  |a...SX...(.X..8.|
+00000250  95 a1 ac 31 5a 1a 84 66  3d 43 d3 2d d9 0b f2 97  |...1Z..f=C.-....|
+00000260  df d3 20 64 38 92 24 3a  00 bc cf 9c 7d b7 40 20  |.. d8.$:....}.@ |
+00000270  01 5f aa d3 16 61 09 a2  76 fd 13 c3 cc e1 0c 5c  |._...a..v......\|
+00000280  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
+00000290  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
+000002a0  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
+000002b0  84 5c 21 d3 3b e9 fa e7  16 03 01 00 04 0e 00 00  |.\!.;...........|
+000002c0  00                                                |.|
 >>> Flow 3 (client to server)
 00000000  16 03 01 00 86 10 00 00  82 00 80 b9 65 8d bf a7  |............e...|
 00000010  c8 4b 79 ce 6f cb 8b 13  1c ac b9 7d 66 5e e9 ba  |.Ky.o......}f^..|
@@ -70,15 +72,15 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 01 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 01 00 24 29 ee  6c 54 d6 21 5e 31 30 9e  |.....$).lT.!^10.|
-000000a0  fd 02 69 bb 32 c2 9e ad  28 b1 2d 94 49 0a 12 0c  |..i.2...(.-.I...|
-000000b0  a1 12 b0 98 a6 33 eb 63  2b e4                    |.....3.c+.|
+00000090  01 16 03 01 00 24 bd d6  29 83 bf 42 06 cf 06 86  |.....$..)..B....|
+000000a0  09 8a 2f 4c 72 d3 98 45  6b 24 2f 58 da 45 a3 9d  |../Lr..Ek$/X.E..|
+000000b0  86 7b e0 5e 8f 52 6c ee  97 1a                    |.{.^.Rl...|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 24 32 3e 45 f2 3a  |..........$2>E.:|
-00000010  01 05 50 db 37 25 f6 b5  67 8e 38 3d f5 ba b7 90  |..P.7%..g.8=....|
-00000020  e0 05 a8 cb e0 33 1a 79  ab 44 86 d5 0c fd 86     |.....3.y.D.....|
+00000000  14 03 01 00 01 01 16 03  01 00 24 b2 c6 b8 54 c9  |..........$...T.|
+00000010  8b 16 cb d4 40 54 08 a4  39 f9 88 37 2e d7 e2 f4  |....@T..9..7....|
+00000020  17 26 ec 00 0b d3 36 42  2f 7b 6d 3f 10 e0 6d     |.&....6B/{m?..m|
 >>> Flow 5 (client to server)
-00000000  17 03 01 00 1a ac 0c 1f  12 4e d4 31 10 dd c1 04  |.........N.1....|
-00000010  8b 55 a2 2e a5 f4 e4 80  aa 23 7e bd 79 b0 ee 15  |.U.......#~.y...|
-00000020  03 01 00 16 fa d9 ff 50  7d 41 01 2a d2 13 ee 33  |.......P}A.*...3|
-00000030  52 ab 20 c5 e7 73 81 5d  81 60                    |R. ..s.].`|
+00000000  17 03 01 00 1a 75 40 46  0c 9d 5a 40 b9 b8 7c fa  |.....u@F..Z@..|.|
+00000010  a3 bf ff 37 2b 30 72 cc  a6 5c 8d c9 8a d6 64 15  |...7+0r..\....d.|
+00000020  03 01 00 16 f4 f1 6d 64  0a 21 35 dc c9 de b5 c4  |......md.!5.....|
+00000030  d7 2c 0a 6e 2a e5 90 21  20 cf                    |.,.n*..! .|
diff --git a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES
index 92cdc4c024..cc9dd829aa 100644
--- a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,87 +7,88 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 02 00 59 02 00 00  55 03 02 bf ac 6b 91 53  |....Y...U....k.S|
-00000010  dc 1f d6 ee 0e 71 d6 a4  f5 a2 7c f0 10 69 41 dd  |.....q....|..iA.|
-00000020  4a b7 30 53 e6 28 07 31  34 8f e5 20 59 d1 bd e1  |J.0S.(.14.. Y...|
-00000030  20 44 c4 05 07 e9 07 90  5d de 08 73 72 55 04 a6  | D......]..srU..|
-00000040  11 20 bf 32 e0 dd 46 d4  1d ed 45 62 c0 09 00 00  |. .2..F...Eb....|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  02 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
-00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
-00000080  30 09 06 07 2a 86 48 ce  3d 04 01 30 45 31 0b 30  |0...*.H.=..0E1.0|
-00000090  09 06 03 55 04 06 13 02  41 55 31 13 30 11 06 03  |...U....AU1.0...|
-000000a0  55 04 08 13 0a 53 6f 6d  65 2d 53 74 61 74 65 31  |U....Some-State1|
-000000b0  21 30 1f 06 03 55 04 0a  13 18 49 6e 74 65 72 6e  |!0...U....Intern|
-000000c0  65 74 20 57 69 64 67 69  74 73 20 50 74 79 20 4c  |et Widgits Pty L|
-000000d0  74 64 30 1e 17 0d 31 32  31 31 32 32 31 35 30 36  |td0...1211221506|
-000000e0  33 32 5a 17 0d 32 32 31  31 32 30 31 35 30 36 33  |32Z..22112015063|
-000000f0  32 5a 30 45 31 0b 30 09  06 03 55 04 06 13 02 41  |2Z0E1.0...U....A|
-00000100  55 31 13 30 11 06 03 55  04 08 13 0a 53 6f 6d 65  |U1.0...U....Some|
-00000110  2d 53 74 61 74 65 31 21  30 1f 06 03 55 04 0a 13  |-State1!0...U...|
-00000120  18 49 6e 74 65 72 6e 65  74 20 57 69 64 67 69 74  |.Internet Widgit|
-00000130  73 20 50 74 79 20 4c 74  64 30 81 9b 30 10 06 07  |s Pty Ltd0..0...|
-00000140  2a 86 48 ce 3d 02 01 06  05 2b 81 04 00 23 03 81  |*.H.=....+...#..|
-00000150  86 00 04 00 c4 a1 ed be  98 f9 0b 48 73 36 7e c3  |...........Hs6~.|
-00000160  16 56 11 22 f2 3d 53 c3  3b 4d 21 3d cd 6b 75 e6  |.V.".=S.;M!=.ku.|
-00000170  f6 b0 dc 9a df 26 c1 bc  b2 87 f0 72 32 7c b3 64  |.....&.....r2|.d|
-00000180  2f 1c 90 bc ea 68 23 10  7e fe e3 25 c0 48 3a 69  |/....h#.~..%.H:i|
-00000190  e0 28 6d d3 37 00 ef 04  62 dd 0d a0 9c 70 62 83  |.(m.7...b....pb.|
-000001a0  d8 81 d3 64 31 aa 9e 97  31 bd 96 b0 68 c0 9b 23  |...d1...1...h..#|
-000001b0  de 76 64 3f 1a 5c 7f e9  12 0e 58 58 b6 5f 70 dd  |.vd?.\....XX._p.|
-000001c0  9b d8 ea d5 d7 f5 d5 cc  b9 b6 9f 30 66 5b 66 9a  |...........0f[f.|
-000001d0  20 e2 27 e5 bf fe 3b 30  09 06 07 2a 86 48 ce 3d  | .'...;0...*.H.=|
-000001e0  04 01 03 81 8c 00 30 81  88 02 42 01 88 a2 4f eb  |......0...B...O.|
-000001f0  e2 45 c5 48 7d 1b ac f5  ed 98 9d ae 47 70 c0 5e  |.E.H}.......Gp.^|
-00000200  1b b6 2f bd f1 b6 4d b7  61 40 d3 11 a2 ce ee 0b  |../...M.a@......|
-00000210  7e 92 7e ff 76 9d c3 3b  7e a5 3f ce fa 10 e2 59  |~.~.v..;~.?....Y|
-00000220  ec 47 2d 7c ac da 4e 97  0e 15 a0 6f d0 02 42 01  |.G-|..N....o..B.|
-00000230  4d fc be 67 13 9c 2d 05  0e bd 3f a3 8c 25 c1 33  |M..g..-...?..%.3|
-00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
-00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
-00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 02 00 b5 0c 00  00 b1 03 00 1d 20 ab ea  |*............ ..|
-00000280  ff 17 1e b1 ef f6 22 03  40 8b e1 1a fa ab 01 cf  |......".@.......|
-00000290  0f f0 b0 6d 43 3c 1f 03  a1 d6 4a 9d 79 43 00 8b  |...mC<....J.yC..|
-000002a0  30 81 88 02 42 00 a1 b4  50 4b 9b a3 a5 ec ef dc  |0...B...PK......|
-000002b0  bf c1 a2 65 24 2a 6c aa  ab 26 01 ed d1 ad 2e 37  |...e$*l..&.....7|
-000002c0  4f f5 8b ff 98 ac ef 15  3e d9 46 07 a3 d2 35 de  |O.......>.F...5.|
-000002d0  91 bc 3d a0 1f f1 68 55  28 ef 60 ad 13 05 ac 65  |..=...hU(.`....e|
-000002e0  e5 67 02 3f 85 8b 1b 02  42 01 26 3f fc 62 e3 93  |.g.?....B.&?.b..|
-000002f0  8e fa fb 93 0f 0b ff 68  25 46 ea 71 16 ae 6e d4  |.......h%F.q..n.|
-00000300  36 9e 48 2c 77 2b d8 f5  f6 1d 69 68 ed 28 8f e7  |6.H,w+....ih.(..|
-00000310  79 7e 78 56 52 ff e8 62  fc e2 bd 2e c7 e8 9f 3f  |y~xVR..b.......?|
-00000320  93 47 d2 62 6c f6 5c 0e  a2 b8 fe 16 03 02 00 04  |.G.bl.\.........|
-00000330  0e 00 00 00                                       |....|
+00000000  16 03 02 00 5d 02 00 00  59 03 02 7f 08 c0 d7 77  |....]...Y......w|
+00000010  20 72 4a f2 a2 2c 41 99  b0 3e 9f c8 9d ff 9b b5  | rJ..,A..>......|
+00000020  ea 99 73 91 7b 81 51 e2  1a 7e 9b 20 5d 47 a5 63  |..s.{.Q..~. ]G.c|
+00000030  86 cb fe bf 40 8e f9 f8  1c cf 4b cf 8b f2 af 56  |....@.....K....V|
+00000040  94 a3 71 ad 53 ab 30 71  2a 07 f3 a0 c0 09 00 00  |..q.S.0q*.......|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 02 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
+00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
+00000080  a0 d2 eb f4 30 09 06 07  2a 86 48 ce 3d 04 01 30  |....0...*.H.=..0|
+00000090  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+000000a0  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+000000b0  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+000000c0  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+000000d0  74 79 20 4c 74 64 30 1e  17 0d 31 32 31 31 32 32  |ty Ltd0...121122|
+000000e0  31 35 30 36 33 32 5a 17  0d 32 32 31 31 32 30 31  |150632Z..2211201|
+000000f0  35 30 36 33 32 5a 30 45  31 0b 30 09 06 03 55 04  |50632Z0E1.0...U.|
+00000100  06 13 02 41 55 31 13 30  11 06 03 55 04 08 13 0a  |...AU1.0...U....|
+00000110  53 6f 6d 65 2d 53 74 61  74 65 31 21 30 1f 06 03  |Some-State1!0...|
+00000120  55 04 0a 13 18 49 6e 74  65 72 6e 65 74 20 57 69  |U....Internet Wi|
+00000130  64 67 69 74 73 20 50 74  79 20 4c 74 64 30 81 9b  |dgits Pty Ltd0..|
+00000140  30 10 06 07 2a 86 48 ce  3d 02 01 06 05 2b 81 04  |0...*.H.=....+..|
+00000150  00 23 03 81 86 00 04 00  c4 a1 ed be 98 f9 0b 48  |.#.............H|
+00000160  73 36 7e c3 16 56 11 22  f2 3d 53 c3 3b 4d 21 3d  |s6~..V.".=S.;M!=|
+00000170  cd 6b 75 e6 f6 b0 dc 9a  df 26 c1 bc b2 87 f0 72  |.ku......&.....r|
+00000180  32 7c b3 64 2f 1c 90 bc  ea 68 23 10 7e fe e3 25  |2|.d/....h#.~..%|
+00000190  c0 48 3a 69 e0 28 6d d3  37 00 ef 04 62 dd 0d a0  |.H:i.(m.7...b...|
+000001a0  9c 70 62 83 d8 81 d3 64  31 aa 9e 97 31 bd 96 b0  |.pb....d1...1...|
+000001b0  68 c0 9b 23 de 76 64 3f  1a 5c 7f e9 12 0e 58 58  |h..#.vd?.\....XX|
+000001c0  b6 5f 70 dd 9b d8 ea d5  d7 f5 d5 cc b9 b6 9f 30  |._p............0|
+000001d0  66 5b 66 9a 20 e2 27 e5  bf fe 3b 30 09 06 07 2a  |f[f. .'...;0...*|
+000001e0  86 48 ce 3d 04 01 03 81  8c 00 30 81 88 02 42 01  |.H.=......0...B.|
+000001f0  88 a2 4f eb e2 45 c5 48  7d 1b ac f5 ed 98 9d ae  |..O..E.H}.......|
+00000200  47 70 c0 5e 1b b6 2f bd  f1 b6 4d b7 61 40 d3 11  |Gp.^../...M.a@..|
+00000210  a2 ce ee 0b 7e 92 7e ff  76 9d c3 3b 7e a5 3f ce  |....~.~.v..;~.?.|
+00000220  fa 10 e2 59 ec 47 2d 7c  ac da 4e 97 0e 15 a0 6f  |...Y.G-|..N....o|
+00000230  d0 02 42 01 4d fc be 67  13 9c 2d 05 0e bd 3f a3  |..B.M..g..-...?.|
+00000240  8c 25 c1 33 13 83 0d 94  06 bb d4 37 7a f6 ec 7a  |.%.3.......7z..z|
+00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
+00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
+00000270  95 12 07 8f 2a 16 03 02  00 b5 0c 00 00 b1 03 00  |....*...........|
+00000280  1d 20 23 be e0 2b 65 34  a4 91 3c 4e 3c 84 51 98  |. #..+e4..<N<.Q.|
+00000290  07 07 26 42 48 eb ff fd  dc d3 e7 dd 1c 2d d0 aa  |..&BH........-..|
+000002a0  98 18 00 8b 30 81 88 02  42 01 34 ed 12 83 dd a8  |....0...B.4.....|
+000002b0  dc 4c 6a bd 2c e0 fe ce  af 92 b7 86 96 b3 19 92  |.Lj.,...........|
+000002c0  cc 28 56 12 bb 74 b5 9a  3a 07 0a b0 ef f1 3b 42  |.(V..t..:.....;B|
+000002d0  b2 c4 4a 44 d5 4b f2 5b  5a eb 43 21 23 4c 39 da  |..JD.K.[Z.C!#L9.|
+000002e0  99 3f c0 0f 23 b3 4f 58  43 0a c7 02 42 01 2b a8  |.?..#.OXC...B.+.|
+000002f0  96 0f 04 3e c0 55 db eb  73 4d 7e 75 4b 73 fa 4d  |...>.U..sM~uKs.M|
+00000300  62 de 29 b8 0e 59 68 0a  14 a5 75 31 4f 9d db 64  |b.)..Yh...u1O..d|
+00000310  d0 b4 f4 78 ae 30 99 2f  fb 33 ea 1a 21 46 33 57  |...x.0./.3..!F3W|
+00000320  59 00 5d 84 4b b3 fe a1  60 3d ae 71 af b9 ea 16  |Y.].K...`=.q....|
+00000330  03 02 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
 00000000  16 03 02 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 02 00 01 01  |....._X.;t......|
 00000030  16 03 02 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000040  00 00 00 00 00 0f 55 37  4b 93 d5 ce b1 1c 6f a3  |......U7K.....o.|
-00000050  6d 56 32 f5 de 19 f6 a3  15 b0 6a 90 06 92 60 ca  |mV2.......j...`.|
-00000060  ec 0e 2b d4 24 16 0a 26  f3 bd 3d ca c5 9f d2 9b  |..+.$..&..=.....|
-00000070  79 2f af b6 b0                                    |y/...|
+00000040  00 00 00 00 00 ef 00 72  e6 a4 f6 8b 7f 98 ef e0  |.......r........|
+00000050  15 01 2c fc 31 7a e7 ba  fa 07 ec 0e c1 4b 69 39  |..,.1z.......Ki9|
+00000060  89 97 fa a8 8b bf 3b 7f  1a 00 32 26 72 64 19 1c  |......;...2&rd..|
+00000070  0c 2f 4b ba 78                                    |./K.x|
 >>> Flow 4 (server to client)
-00000000  14 03 02 00 01 01 16 03  02 00 40 4d e3 a9 af 51  |..........@M...Q|
-00000010  f5 d1 cd 04 f1 cf c5 48  0f 2e 0b 6e 57 4c 11 28  |.......H...nWL.(|
-00000020  dd 89 19 14 98 8e 2e 92  db 3c a4 0f 85 32 90 7e  |.........<...2.~|
-00000030  49 13 17 a0 85 fa c6 25  79 24 13 90 86 dc ec 45  |I......%y$.....E|
-00000040  7c 74 35 92 e4 89 04 c2  51 27 66                 ||t5.....Q'f|
+00000000  14 03 02 00 01 01 16 03  02 00 40 d7 89 58 0a f0  |..........@..X..|
+00000010  bd c1 a0 bb b5 f0 b4 1a  0b 08 25 e8 5a 73 04 04  |..........%.Zs..|
+00000020  01 99 65 e1 9c 80 24 e5  80 a8 a8 a1 29 bd af 99  |..e...$.....)...|
+00000030  06 4d 9a 48 59 95 0a 0e  bc 72 7d 90 cb 62 5a 2d  |.M.HY....r}..bZ-|
+00000040  7b 19 53 83 10 47 55 8b  c3 e0 84                 |{.S..GU....|
 >>> Flow 5 (client to server)
 00000000  17 03 02 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 f9 ac 17  1f 08 b7 80 fb 70 87 e2  |.............p..|
-00000020  53 00 27 60 78 6c 80 5b  57 e7 70 72 8a e3 1b 32  |S.'`xl.[W.pr...2|
-00000030  8c f0 67 82 82 15 03 02  00 30 00 00 00 00 00 00  |..g......0......|
-00000040  00 00 00 00 00 00 00 00  00 00 01 e1 86 47 7f 65  |.............G.e|
-00000050  a9 d2 1c 22 7d 99 7c 41  dc 17 f5 16 40 5b b3 7f  |..."}.|A....@[..|
-00000060  cc 0b 97 41 0c ae 1f 0c  39 e0                    |...A....9.|
+00000010  00 00 00 00 00 5d d8 f2  5e 83 a1 39 cb 57 a9 7f  |.....]..^..9.W..|
+00000020  93 35 72 a3 ce 15 f6 4c  5c 06 8f d1 f5 77 7c ca  |.5r....L\....w|.|
+00000030  a9 59 5f e9 ce 15 03 02  00 30 00 00 00 00 00 00  |.Y_......0......|
+00000040  00 00 00 00 00 00 00 00  00 00 2b 0a 90 aa 87 8f  |..........+.....|
+00000050  ff 26 85 22 26 26 bd 0e  a3 40 88 e1 72 21 76 69  |.&."&&...@..r!vi|
+00000060  4c 69 22 2c 6c 72 a3 64  6e 61                    |Li",lr.dna|
diff --git a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES
index b2b7ecb165..5bde683b72 100644
--- a/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv11-ECDHE-RSA-AES
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,91 +7,92 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 02 00 59 02 00 00  55 03 02 95 6e 24 5a ab  |....Y...U...n$Z.|
-00000010  ae 3c 73 52 9d 31 63 50  cf f9 50 99 3c e4 94 22  |.<sR.1cP..P.<.."|
-00000020  5b 6f 0e f8 e3 a8 64 4c  d2 8c 00 20 8b 2d 25 47  |[o....dL... .-%G|
-00000030  f9 74 41 93 b1 82 b5 c5  fc 3e 42 c9 35 fc 68 27  |.tA......>B.5.h'|
-00000040  c4 2b 35 0f f8 1c e3 28  e6 8a 59 dc c0 13 00 00  |.+5....(..Y.....|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  02 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
-00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
-00000080  3f e2 5b ea a6 30 0d 06  09 2a 86 48 86 f7 0d 01  |?.[..0...*.H....|
-00000090  01 0b 05 00 30 1f 31 0b  30 09 06 03 55 04 0a 13  |....0.1.0...U...|
-000000a0  02 47 6f 31 10 30 0e 06  03 55 04 03 13 07 47 6f  |.Go1.0...U....Go|
-000000b0  20 52 6f 6f 74 30 1e 17  0d 31 36 30 31 30 31 30  | Root0...1601010|
-000000c0  30 30 30 30 30 5a 17 0d  32 35 30 31 30 31 30 30  |00000Z..25010100|
-000000d0  30 30 30 30 5a 30 1a 31  0b 30 09 06 03 55 04 0a  |0000Z0.1.0...U..|
-000000e0  13 02 47 6f 31 0b 30 09  06 03 55 04 03 13 02 47  |..Go1.0...U....G|
-000000f0  6f 30 81 9f 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |o0..0...*.H.....|
-00000100  01 05 00 03 81 8d 00 30  81 89 02 81 81 00 db 46  |.......0.......F|
-00000110  7d 93 2e 12 27 06 48 bc  06 28 21 ab 7e c4 b6 a2  |}...'.H..(!.~...|
-00000120  5d fe 1e 52 45 88 7a 36  47 a5 08 0d 92 42 5b c2  |]..RE.z6G....B[.|
-00000130  81 c0 be 97 79 98 40 fb  4f 6d 14 fd 2b 13 8b c2  |....y.@.Om..+...|
-00000140  a5 2e 67 d8 d4 09 9e d6  22 38 b7 4a 0b 74 73 2b  |..g....."8.J.ts+|
-00000150  c2 34 f1 d1 93 e5 96 d9  74 7b f3 58 9f 6c 61 3c  |.4......t{.X.la<|
-00000160  c0 b0 41 d4 d9 2b 2b 24  23 77 5b 1c 3b bd 75 5d  |..A..++$#w[.;.u]|
-00000170  ce 20 54 cf a1 63 87 1d  1e 24 c4 f3 1d 1a 50 8b  |. T..c...$....P.|
-00000180  aa b6 14 43 ed 97 a7 75  62 f4 14 c8 52 d7 02 03  |...C...ub...R...|
-00000190  01 00 01 a3 81 93 30 81  90 30 0e 06 03 55 1d 0f  |......0..0...U..|
-000001a0  01 01 ff 04 04 03 02 05  a0 30 1d 06 03 55 1d 25  |.........0...U.%|
-000001b0  04 16 30 14 06 08 2b 06  01 05 05 07 03 01 06 08  |..0...+.........|
-000001c0  2b 06 01 05 05 07 03 02  30 0c 06 03 55 1d 13 01  |+.......0...U...|
-000001d0  01 ff 04 02 30 00 30 19  06 03 55 1d 0e 04 12 04  |....0.0...U.....|
-000001e0  10 9f 91 16 1f 43 43 3e  49 a6 de 6d b6 80 d7 9f  |.....CC>I..m....|
-000001f0  60 30 1b 06 03 55 1d 23  04 14 30 12 80 10 48 13  |`0...U.#..0...H.|
-00000200  49 4d 13 7e 16 31 bb a3  01 d5 ac ab 6e 7b 30 19  |IM.~.1......n{0.|
-00000210  06 03 55 1d 11 04 12 30  10 82 0e 65 78 61 6d 70  |..U....0...examp|
-00000220  6c 65 2e 67 6f 6c 61 6e  67 30 0d 06 09 2a 86 48  |le.golang0...*.H|
-00000230  86 f7 0d 01 01 0b 05 00  03 81 81 00 9d 30 cc 40  |.............0.@|
-00000240  2b 5b 50 a0 61 cb ba e5  53 58 e1 ed 83 28 a9 58  |+[P.a...SX...(.X|
-00000250  1a a9 38 a4 95 a1 ac 31  5a 1a 84 66 3d 43 d3 2d  |..8....1Z..f=C.-|
-00000260  d9 0b f2 97 df d3 20 64  38 92 24 3a 00 bc cf 9c  |...... d8.$:....|
-00000270  7d b7 40 20 01 5f aa d3  16 61 09 a2 76 fd 13 c3  |}.@ ._...a..v...|
-00000280  cc e1 0c 5c ee b1 87 82  f1 6c 04 ed 73 bb b3 43  |...\.....l..s..C|
-00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
-000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
-000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 02 00  |.=.`.\!.;.......|
-000002c0  aa 0c 00 00 a6 03 00 1d  20 b5 75 ee e5 26 6b c0  |........ .u..&k.|
-000002d0  af 34 8a 24 f7 c5 25 58  29 38 4c 08 d3 a2 0c 48  |.4.$..%X)8L....H|
-000002e0  18 eb a0 5b e8 64 62 62  78 00 80 d0 1c 9c 11 1a  |...[.dbbx.......|
-000002f0  58 4c 46 5f 18 03 d7 d7  76 47 d5 56 7a bb bd 95  |XLF_....vG.Vz...|
-00000300  16 46 e8 0b 28 6e df 15  65 1a f6 95 fb 4a 6c 42  |.F..(n..e....JlB|
-00000310  1b 4c 5c 30 c5 de d0 83  08 d3 2e 4d 59 7e 7b 1b  |.L\0.......MY~{.|
-00000320  20 9e b5 19 76 fe a3 dd  87 04 f4 9a 3e 3c c0 4a  | ...v.......><.J|
-00000330  16 7f e3 4e 9a 1f 0a 36  1d f5 09 b4 88 09 b1 1b  |...N...6........|
-00000340  9b 60 97 dc d7 ea 97 f4  d6 06 16 45 98 ee 5c 39  |.`.........E..\9|
-00000350  62 3f 7c 82 7b c3 52 59  01 d4 89 8c a6 e2 d5 eb  |b?|.{.RY........|
-00000360  e8 30 a6 78 49 1e ec a5  92 ad 24 16 03 02 00 04  |.0.xI.....$.....|
-00000370  0e 00 00 00                                       |....|
+00000000  16 03 02 00 5d 02 00 00  59 03 02 a4 97 26 eb 45  |....]...Y....&.E|
+00000010  35 28 1a 9a 6b 3e b3 e6  c0 9f 4a c7 6f 57 70 9a  |5(..k>....J.oWp.|
+00000020  fe 3a 1a a5 c3 05 d3 50  45 43 ee 20 3e 34 5b ef  |.:.....PEC. >4[.|
+00000030  64 f3 f8 40 e4 69 7d 3a  46 db 4e 83 6c ff 68 2a  |d..@.i}:F.N.l.h*|
+00000040  f9 f4 45 5e 7c 25 5f a0  d5 89 7e 83 c0 13 00 00  |..E^|%_...~.....|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 02 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
+00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
+00000080  00 e8 f0 9d 3f e2 5b ea  a6 30 0d 06 09 2a 86 48  |....?.[..0...*.H|
+00000090  86 f7 0d 01 01 0b 05 00  30 1f 31 0b 30 09 06 03  |........0.1.0...|
+000000a0  55 04 0a 13 02 47 6f 31  10 30 0e 06 03 55 04 03  |U....Go1.0...U..|
+000000b0  13 07 47 6f 20 52 6f 6f  74 30 1e 17 0d 31 36 30  |..Go Root0...160|
+000000c0  31 30 31 30 30 30 30 30  30 5a 17 0d 32 35 30 31  |101000000Z..2501|
+000000d0  30 31 30 30 30 30 30 30  5a 30 1a 31 0b 30 09 06  |01000000Z0.1.0..|
+000000e0  03 55 04 0a 13 02 47 6f  31 0b 30 09 06 03 55 04  |.U....Go1.0...U.|
+000000f0  03 13 02 47 6f 30 81 9f  30 0d 06 09 2a 86 48 86  |...Go0..0...*.H.|
+00000100  f7 0d 01 01 01 05 00 03  81 8d 00 30 81 89 02 81  |...........0....|
+00000110  81 00 db 46 7d 93 2e 12  27 06 48 bc 06 28 21 ab  |...F}...'.H..(!.|
+00000120  7e c4 b6 a2 5d fe 1e 52  45 88 7a 36 47 a5 08 0d  |~...]..RE.z6G...|
+00000130  92 42 5b c2 81 c0 be 97  79 98 40 fb 4f 6d 14 fd  |.B[.....y.@.Om..|
+00000140  2b 13 8b c2 a5 2e 67 d8  d4 09 9e d6 22 38 b7 4a  |+.....g....."8.J|
+00000150  0b 74 73 2b c2 34 f1 d1  93 e5 96 d9 74 7b f3 58  |.ts+.4......t{.X|
+00000160  9f 6c 61 3c c0 b0 41 d4  d9 2b 2b 24 23 77 5b 1c  |.la<..A..++$#w[.|
+00000170  3b bd 75 5d ce 20 54 cf  a1 63 87 1d 1e 24 c4 f3  |;.u]. T..c...$..|
+00000180  1d 1a 50 8b aa b6 14 43  ed 97 a7 75 62 f4 14 c8  |..P....C...ub...|
+00000190  52 d7 02 03 01 00 01 a3  81 93 30 81 90 30 0e 06  |R.........0..0..|
+000001a0  03 55 1d 0f 01 01 ff 04  04 03 02 05 a0 30 1d 06  |.U...........0..|
+000001b0  03 55 1d 25 04 16 30 14  06 08 2b 06 01 05 05 07  |.U.%..0...+.....|
+000001c0  03 01 06 08 2b 06 01 05  05 07 03 02 30 0c 06 03  |....+.......0...|
+000001d0  55 1d 13 01 01 ff 04 02  30 00 30 19 06 03 55 1d  |U.......0.0...U.|
+000001e0  0e 04 12 04 10 9f 91 16  1f 43 43 3e 49 a6 de 6d  |.........CC>I..m|
+000001f0  b6 80 d7 9f 60 30 1b 06  03 55 1d 23 04 14 30 12  |....`0...U.#..0.|
+00000200  80 10 48 13 49 4d 13 7e  16 31 bb a3 01 d5 ac ab  |..H.IM.~.1......|
+00000210  6e 7b 30 19 06 03 55 1d  11 04 12 30 10 82 0e 65  |n{0...U....0...e|
+00000220  78 61 6d 70 6c 65 2e 67  6f 6c 61 6e 67 30 0d 06  |xample.golang0..|
+00000230  09 2a 86 48 86 f7 0d 01  01 0b 05 00 03 81 81 00  |.*.H............|
+00000240  9d 30 cc 40 2b 5b 50 a0  61 cb ba e5 53 58 e1 ed  |.0.@+[P.a...SX..|
+00000250  83 28 a9 58 1a a9 38 a4  95 a1 ac 31 5a 1a 84 66  |.(.X..8....1Z..f|
+00000260  3d 43 d3 2d d9 0b f2 97  df d3 20 64 38 92 24 3a  |=C.-...... d8.$:|
+00000270  00 bc cf 9c 7d b7 40 20  01 5f aa d3 16 61 09 a2  |....}.@ ._...a..|
+00000280  76 fd 13 c3 cc e1 0c 5c  ee b1 87 82 f1 6c 04 ed  |v......\.....l..|
+00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
+000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
+000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
+000002c0  16 03 02 00 aa 0c 00 00  a6 03 00 1d 20 46 15 e3  |............ F..|
+000002d0  8f f8 ab 26 88 9c 0f 28  30 d6 58 96 77 55 77 62  |...&...(0.X.wUwb|
+000002e0  26 a1 64 98 df b3 cc 15  48 fc 90 2b 30 00 80 7d  |&.d.....H..+0..}|
+000002f0  e3 98 42 4a 27 c1 08 29  93 22 0e 7e 53 4e b7 03  |..BJ'..).".~SN..|
+00000300  ca c1 67 34 0e 8d c0 94  cb dd 38 34 f4 d8 0e 10  |..g4......84....|
+00000310  68 bb e7 01 3e 4b 22 27  bb 43 e2 cf da e2 6c 49  |h...>K"'.C....lI|
+00000320  d7 31 2f 31 04 b2 7a 8f  86 35 5e f8 16 3f 80 b7  |.1/1..z..5^..?..|
+00000330  1e 06 e1 3e 57 89 24 d7  25 65 8b 13 84 27 b6 eb  |...>W.$.%e...'..|
+00000340  e9 64 bd 69 22 17 bc 53  57 2c 78 b3 1d 01 97 65  |.d.i"..SW,x....e|
+00000350  d9 0e b7 a7 bf d3 86 d3  a4 24 07 0f 16 0f fb 3a  |.........$.....:|
+00000360  e8 35 ce 80 79 93 2f 26  75 36 fa ad 99 d3 88 16  |.5..y./&u6......|
+00000370  03 02 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
 00000000  16 03 02 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 02 00 01 01  |....._X.;t......|
 00000030  16 03 02 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000040  00 00 00 00 00 28 ab ed  77 d3 56 29 a8 4a 38 c8  |.....(..w.V).J8.|
-00000050  64 1c a5 d9 4e f9 6b 0e  fa 82 42 ad 0d be 15 69  |d...N.k...B....i|
-00000060  9a ff 79 64 db 8f 3e 16  b3 86 93 82 6f 78 c4 2e  |..yd..>.....ox..|
-00000070  7c 54 6c 4f 90                                    ||TlO.|
+00000040  00 00 00 00 00 89 35 3f  26 26 9c d0 87 70 65 56  |......5?&&...peV|
+00000050  b4 32 f9 9e 3f 1f 20 6f  8d 71 eb 6c 45 15 a0 f4  |.2..?. o.q.lE...|
+00000060  ff 02 60 8c 01 1a b7 2b  0d 1e 56 e7 be 06 ac 16  |..`....+..V.....|
+00000070  74 73 be 0a 95                                    |ts...|
 >>> Flow 4 (server to client)
-00000000  14 03 02 00 01 01 16 03  02 00 40 15 e9 c5 15 59  |..........@....Y|
-00000010  b3 0d 46 22 0c ae a6 41  02 b4 f3 da 11 dc 85 79  |..F"...A.......y|
-00000020  bb d9 3f 23 38 51 24 1a  08 b5 a0 63 dc 4b 86 50  |..?#8Q$....c.K.P|
-00000030  ef b2 32 07 fd b5 e1 01  06 19 42 ce ba 69 ab 1a  |..2.......B..i..|
-00000040  c9 bb db 7d d0 9f f9 7c  f2 6c 18                 |...}...|.l.|
+00000000  14 03 02 00 01 01 16 03  02 00 40 04 35 19 05 8e  |..........@.5...|
+00000010  c6 68 3e 37 75 5f 5d bb  41 58 8b a7 b3 cf 97 28  |.h>7u_].AX.....(|
+00000020  60 ad b7 be db b1 31 b9  9c f5 d2 57 49 17 7c f6  |`.....1....WI.|.|
+00000030  de 60 24 87 cb c5 51 2d  7a 8d f1 4b e5 7f 2d c7  |.`$...Q-z..K..-.|
+00000040  7f f4 e1 94 d9 6f 5c 2a  68 f0 24                 |.....o\*h.$|
 >>> Flow 5 (client to server)
 00000000  17 03 02 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 67 ef de  df a4 91 69 58 b8 3f 06  |.....g.....iX.?.|
-00000020  c4 05 4e ad 88 9b c5 12  35 cf 63 39 3a 61 e9 4c  |..N.....5.c9:a.L|
-00000030  49 22 93 f4 10 15 03 02  00 30 00 00 00 00 00 00  |I".......0......|
-00000040  00 00 00 00 00 00 00 00  00 00 00 2a 5a ba 39 7e  |...........*Z.9~|
-00000050  a8 be 2e 72 f3 ba 7e 0a  32 b5 8c d8 f5 1b 93 6c  |...r..~.2......l|
-00000060  3e 35 d8 ba cc f3 9f f4  19 74                    |>5.......t|
+00000010  00 00 00 00 00 a2 ba 70  25 b0 a9 b0 ea 87 7e 6b  |.......p%.....~k|
+00000020  ef 89 e3 10 f4 98 da 12  cf bc 20 f6 18 76 c7 ad  |.......... ..v..|
+00000030  b7 12 1e 7b 12 15 03 02  00 30 00 00 00 00 00 00  |...{.....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 91 33 9b b8 76 89  |...........3..v.|
+00000050  39 ef 4b 3f d1 09 40 e4  68 6f 30 35 d9 a9 82 c1  |9.K?..@.ho05....|
+00000060  9d c6 c2 a5 dc cb 1d 43  83 0a                    |.......C..|
diff --git a/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4 b/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4
index aeba311f51..addd48064a 100644
--- a/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4
+++ b/src/crypto/tls/testdata/Client-TLSv11-RSA-RC4
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,59 +7,61 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 02 00 51 02 00 00  4d 03 02 82 5b 12 ac 33  |....Q...M...[..3|
-00000010  08 d4 28 8c 91 6e 52 c4  c6 09 13 24 bf 42 d2 37  |..(..nR....$.B.7|
-00000020  6d 78 60 b0 ea bd 9e b3  08 99 43 20 05 5a 93 f9  |mx`.......C .Z..|
-00000030  a4 39 43 4f c4 e3 27 20  7d 4c fa 7a 28 c1 c7 33  |.9CO..' }L.z(..3|
-00000040  72 fa 14 b8 ba c3 89 b0  a5 54 a3 7c 00 05 00 00  |r........T.|....|
-00000050  05 ff 01 00 01 00 16 03  02 02 59 0b 00 02 55 00  |..........Y...U.|
-00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
-00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
-00000080  09 2a 86 48 86 f7 0d 01  01 0b 05 00 30 1f 31 0b  |.*.H........0.1.|
-00000090  30 09 06 03 55 04 0a 13  02 47 6f 31 10 30 0e 06  |0...U....Go1.0..|
-000000a0  03 55 04 03 13 07 47 6f  20 52 6f 6f 74 30 1e 17  |.U....Go Root0..|
-000000b0  0d 31 36 30 31 30 31 30  30 30 30 30 30 5a 17 0d  |.160101000000Z..|
-000000c0  32 35 30 31 30 31 30 30  30 30 30 30 5a 30 1a 31  |250101000000Z0.1|
-000000d0  0b 30 09 06 03 55 04 0a  13 02 47 6f 31 0b 30 09  |.0...U....Go1.0.|
-000000e0  06 03 55 04 03 13 02 47  6f 30 81 9f 30 0d 06 09  |..U....Go0..0...|
-000000f0  2a 86 48 86 f7 0d 01 01  01 05 00 03 81 8d 00 30  |*.H............0|
-00000100  81 89 02 81 81 00 db 46  7d 93 2e 12 27 06 48 bc  |.......F}...'.H.|
-00000110  06 28 21 ab 7e c4 b6 a2  5d fe 1e 52 45 88 7a 36  |.(!.~...]..RE.z6|
-00000120  47 a5 08 0d 92 42 5b c2  81 c0 be 97 79 98 40 fb  |G....B[.....y.@.|
-00000130  4f 6d 14 fd 2b 13 8b c2  a5 2e 67 d8 d4 09 9e d6  |Om..+.....g.....|
-00000140  22 38 b7 4a 0b 74 73 2b  c2 34 f1 d1 93 e5 96 d9  |"8.J.ts+.4......|
-00000150  74 7b f3 58 9f 6c 61 3c  c0 b0 41 d4 d9 2b 2b 24  |t{.X.la<..A..++$|
-00000160  23 77 5b 1c 3b bd 75 5d  ce 20 54 cf a1 63 87 1d  |#w[.;.u]. T..c..|
-00000170  1e 24 c4 f3 1d 1a 50 8b  aa b6 14 43 ed 97 a7 75  |.$....P....C...u|
-00000180  62 f4 14 c8 52 d7 02 03  01 00 01 a3 81 93 30 81  |b...R.........0.|
-00000190  90 30 0e 06 03 55 1d 0f  01 01 ff 04 04 03 02 05  |.0...U..........|
-000001a0  a0 30 1d 06 03 55 1d 25  04 16 30 14 06 08 2b 06  |.0...U.%..0...+.|
-000001b0  01 05 05 07 03 01 06 08  2b 06 01 05 05 07 03 02  |........+.......|
-000001c0  30 0c 06 03 55 1d 13 01  01 ff 04 02 30 00 30 19  |0...U.......0.0.|
-000001d0  06 03 55 1d 0e 04 12 04  10 9f 91 16 1f 43 43 3e  |..U..........CC>|
-000001e0  49 a6 de 6d b6 80 d7 9f  60 30 1b 06 03 55 1d 23  |I..m....`0...U.#|
-000001f0  04 14 30 12 80 10 48 13  49 4d 13 7e 16 31 bb a3  |..0...H.IM.~.1..|
-00000200  01 d5 ac ab 6e 7b 30 19  06 03 55 1d 11 04 12 30  |....n{0...U....0|
-00000210  10 82 0e 65 78 61 6d 70  6c 65 2e 67 6f 6c 61 6e  |...example.golan|
-00000220  67 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |g0...*.H........|
-00000230  03 81 81 00 9d 30 cc 40  2b 5b 50 a0 61 cb ba e5  |.....0.@+[P.a...|
-00000240  53 58 e1 ed 83 28 a9 58  1a a9 38 a4 95 a1 ac 31  |SX...(.X..8....1|
-00000250  5a 1a 84 66 3d 43 d3 2d  d9 0b f2 97 df d3 20 64  |Z..f=C.-...... d|
-00000260  38 92 24 3a 00 bc cf 9c  7d b7 40 20 01 5f aa d3  |8.$:....}.@ ._..|
-00000270  16 61 09 a2 76 fd 13 c3  cc e1 0c 5c ee b1 87 82  |.a..v......\....|
-00000280  f1 6c 04 ed 73 bb b3 43  77 8d 0c 1c f1 0f a1 d8  |.l..s..Cw.......|
-00000290  40 83 61 c9 4c 72 2b 9d  ae db 46 06 06 4d f4 c1  |@.a.Lr+...F..M..|
-000002a0  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
-000002b0  3b e9 fa e7 16 03 02 00  04 0e 00 00 00           |;............|
+00000000  16 03 02 00 55 02 00 00  51 03 02 66 66 1b 2f 55  |....U...Q..ff./U|
+00000010  a4 db ad db 42 88 e0 12  12 36 60 41 32 ca 27 0f  |....B....6`A2.'.|
+00000020  36 22 d1 0b 4e 0e ba df  44 71 9f 20 7a fa f5 a7  |6"..N...Dq. z...|
+00000030  ba ca 0a 9a be c5 b7 a8  98 a7 d9 0f d8 24 d4 cf  |.............$..|
+00000040  ab f5 13 84 03 45 57 ab  89 6d 43 42 00 05 00 00  |.....EW..mCB....|
+00000050  09 ff 01 00 01 00 00 17  00 00 16 03 02 02 59 0b  |..............Y.|
+00000060  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
+00000070  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
+00000080  a6 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |.0...*.H........|
+00000090  30 1f 31 0b 30 09 06 03  55 04 0a 13 02 47 6f 31  |0.1.0...U....Go1|
+000000a0  10 30 0e 06 03 55 04 03  13 07 47 6f 20 52 6f 6f  |.0...U....Go Roo|
+000000b0  74 30 1e 17 0d 31 36 30  31 30 31 30 30 30 30 30  |t0...16010100000|
+000000c0  30 5a 17 0d 32 35 30 31  30 31 30 30 30 30 30 30  |0Z..250101000000|
+000000d0  5a 30 1a 31 0b 30 09 06  03 55 04 0a 13 02 47 6f  |Z0.1.0...U....Go|
+000000e0  31 0b 30 09 06 03 55 04  03 13 02 47 6f 30 81 9f  |1.0...U....Go0..|
+000000f0  30 0d 06 09 2a 86 48 86  f7 0d 01 01 01 05 00 03  |0...*.H.........|
+00000100  81 8d 00 30 81 89 02 81  81 00 db 46 7d 93 2e 12  |...0.......F}...|
+00000110  27 06 48 bc 06 28 21 ab  7e c4 b6 a2 5d fe 1e 52  |'.H..(!.~...]..R|
+00000120  45 88 7a 36 47 a5 08 0d  92 42 5b c2 81 c0 be 97  |E.z6G....B[.....|
+00000130  79 98 40 fb 4f 6d 14 fd  2b 13 8b c2 a5 2e 67 d8  |y.@.Om..+.....g.|
+00000140  d4 09 9e d6 22 38 b7 4a  0b 74 73 2b c2 34 f1 d1  |...."8.J.ts+.4..|
+00000150  93 e5 96 d9 74 7b f3 58  9f 6c 61 3c c0 b0 41 d4  |....t{.X.la<..A.|
+00000160  d9 2b 2b 24 23 77 5b 1c  3b bd 75 5d ce 20 54 cf  |.++$#w[.;.u]. T.|
+00000170  a1 63 87 1d 1e 24 c4 f3  1d 1a 50 8b aa b6 14 43  |.c...$....P....C|
+00000180  ed 97 a7 75 62 f4 14 c8  52 d7 02 03 01 00 01 a3  |...ub...R.......|
+00000190  81 93 30 81 90 30 0e 06  03 55 1d 0f 01 01 ff 04  |..0..0...U......|
+000001a0  04 03 02 05 a0 30 1d 06  03 55 1d 25 04 16 30 14  |.....0...U.%..0.|
+000001b0  06 08 2b 06 01 05 05 07  03 01 06 08 2b 06 01 05  |..+.........+...|
+000001c0  05 07 03 02 30 0c 06 03  55 1d 13 01 01 ff 04 02  |....0...U.......|
+000001d0  30 00 30 19 06 03 55 1d  0e 04 12 04 10 9f 91 16  |0.0...U.........|
+000001e0  1f 43 43 3e 49 a6 de 6d  b6 80 d7 9f 60 30 1b 06  |.CC>I..m....`0..|
+000001f0  03 55 1d 23 04 14 30 12  80 10 48 13 49 4d 13 7e  |.U.#..0...H.IM.~|
+00000200  16 31 bb a3 01 d5 ac ab  6e 7b 30 19 06 03 55 1d  |.1......n{0...U.|
+00000210  11 04 12 30 10 82 0e 65  78 61 6d 70 6c 65 2e 67  |...0...example.g|
+00000220  6f 6c 61 6e 67 30 0d 06  09 2a 86 48 86 f7 0d 01  |olang0...*.H....|
+00000230  01 0b 05 00 03 81 81 00  9d 30 cc 40 2b 5b 50 a0  |.........0.@+[P.|
+00000240  61 cb ba e5 53 58 e1 ed  83 28 a9 58 1a a9 38 a4  |a...SX...(.X..8.|
+00000250  95 a1 ac 31 5a 1a 84 66  3d 43 d3 2d d9 0b f2 97  |...1Z..f=C.-....|
+00000260  df d3 20 64 38 92 24 3a  00 bc cf 9c 7d b7 40 20  |.. d8.$:....}.@ |
+00000270  01 5f aa d3 16 61 09 a2  76 fd 13 c3 cc e1 0c 5c  |._...a..v......\|
+00000280  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
+00000290  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
+000002a0  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
+000002b0  84 5c 21 d3 3b e9 fa e7  16 03 02 00 04 0e 00 00  |.\!.;...........|
+000002c0  00                                                |.|
 >>> Flow 3 (client to server)
 00000000  16 03 02 00 86 10 00 00  82 00 80 b9 65 8d bf a7  |............e...|
 00000010  c8 4b 79 ce 6f cb 8b 13  1c ac b9 7d 66 5e e9 ba  |.Ky.o......}f^..|
@@ -70,15 +72,15 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 02 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 02 00 24 e1 1a  bf e9 fd 4c fb 56 41 82  |.....$.....L.VA.|
-000000a0  c2 48 fc ca d9 d5 ec 2a  0a ee 63 25 e0 5f 53 cf  |.H.....*..c%._S.|
-000000b0  24 ff fe da 6f f5 8b 61  b7 b9                    |$...o..a..|
+00000090  01 16 03 02 00 24 a9 03  2f 22 ef b7 e8 78 38 a9  |.....$../"...x8.|
+000000a0  12 07 27 e3 bf 3b a9 50  5a 83 9c 6b 83 06 07 4d  |..'..;.PZ..k...M|
+000000b0  38 33 12 dc 21 aa 95 3c  f0 cc                    |83..!..<..|
 >>> Flow 4 (server to client)
-00000000  14 03 02 00 01 01 16 03  02 00 24 99 2c e7 fa d0  |..........$.,...|
-00000010  29 d9 92 07 39 56 b0 0c  ad 23 30 c8 d7 0b 38 da  |)...9V...#0...8.|
-00000020  6f d3 c7 f9 66 d2 ec 8c  52 85 cb db a6 22 50     |o...f...R...."P|
+00000000  14 03 02 00 01 01 16 03  02 00 24 df db 82 41 b6  |..........$...A.|
+00000010  3f 2d d5 0f d1 7e ca 3c  73 e0 31 58 ae f5 08 fd  |?-...~.<s.1X....|
+00000020  08 ef 3b cc 45 7b 21 74  ac c9 fc 07 22 6a 5e     |..;.E{!t...."j^|
 >>> Flow 5 (client to server)
-00000000  17 03 02 00 1a 9f 70 c4  77 f3 0a a8 e0 1a 75 87  |......p.w.....u.|
-00000010  ab 2a f1 23 52 79 9f 5c  8e af 5d ba 27 45 f9 15  |.*.#Ry.\..].'E..|
-00000020  03 02 00 16 f0 28 f3 71  a0 97 6b ba 7e 97 81 85  |.....(.q..k.~...|
-00000030  11 59 1b c9 fa a0 48 32  e9 65                    |.Y....H2.e|
+00000000  17 03 02 00 1a b6 12 91  b4 74 7f 92 b5 fd 7e 8c  |.........t....~.|
+00000010  15 1d 51 f9 e1 a3 d6 74  6e b2 07 c2 f0 a8 11 15  |..Q....tn.......|
+00000020  03 02 00 16 ca 4b cb cf  88 2d 48 a7 27 29 19 ef  |.....K...-H.')..|
+00000030  eb 4e 58 ac 57 e2 ed af  e2 a0                    |.NX.W.....|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256
index ce928728b4..22cff4534e 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv12-AES128-GCM-SHA256
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,59 +7,61 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 51 02 00 00  4d 03 03 a4 26 bb e9 70  |....Q...M...&..p|
-00000010  57 4e ec f8 ea 23 01 75  c3 f3 a9 d4 d6 e8 71 2b  |WN...#.u......q+|
-00000020  01 5e c0 73 19 2b b9 d8  8e 3e d1 20 c8 c3 0a 22  |.^.s.+...>. ..."|
-00000030  7b ee cd 2e c9 e8 95 db  90 db 70 f5 59 e6 90 65  |{.........p.Y..e|
-00000040  35 87 a6 d4 bb dd 85 34  43 e8 66 49 00 9c 00 00  |5......4C.fI....|
-00000050  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
-00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
-00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
-00000080  09 2a 86 48 86 f7 0d 01  01 0b 05 00 30 1f 31 0b  |.*.H........0.1.|
-00000090  30 09 06 03 55 04 0a 13  02 47 6f 31 10 30 0e 06  |0...U....Go1.0..|
-000000a0  03 55 04 03 13 07 47 6f  20 52 6f 6f 74 30 1e 17  |.U....Go Root0..|
-000000b0  0d 31 36 30 31 30 31 30  30 30 30 30 30 5a 17 0d  |.160101000000Z..|
-000000c0  32 35 30 31 30 31 30 30  30 30 30 30 5a 30 1a 31  |250101000000Z0.1|
-000000d0  0b 30 09 06 03 55 04 0a  13 02 47 6f 31 0b 30 09  |.0...U....Go1.0.|
-000000e0  06 03 55 04 03 13 02 47  6f 30 81 9f 30 0d 06 09  |..U....Go0..0...|
-000000f0  2a 86 48 86 f7 0d 01 01  01 05 00 03 81 8d 00 30  |*.H............0|
-00000100  81 89 02 81 81 00 db 46  7d 93 2e 12 27 06 48 bc  |.......F}...'.H.|
-00000110  06 28 21 ab 7e c4 b6 a2  5d fe 1e 52 45 88 7a 36  |.(!.~...]..RE.z6|
-00000120  47 a5 08 0d 92 42 5b c2  81 c0 be 97 79 98 40 fb  |G....B[.....y.@.|
-00000130  4f 6d 14 fd 2b 13 8b c2  a5 2e 67 d8 d4 09 9e d6  |Om..+.....g.....|
-00000140  22 38 b7 4a 0b 74 73 2b  c2 34 f1 d1 93 e5 96 d9  |"8.J.ts+.4......|
-00000150  74 7b f3 58 9f 6c 61 3c  c0 b0 41 d4 d9 2b 2b 24  |t{.X.la<..A..++$|
-00000160  23 77 5b 1c 3b bd 75 5d  ce 20 54 cf a1 63 87 1d  |#w[.;.u]. T..c..|
-00000170  1e 24 c4 f3 1d 1a 50 8b  aa b6 14 43 ed 97 a7 75  |.$....P....C...u|
-00000180  62 f4 14 c8 52 d7 02 03  01 00 01 a3 81 93 30 81  |b...R.........0.|
-00000190  90 30 0e 06 03 55 1d 0f  01 01 ff 04 04 03 02 05  |.0...U..........|
-000001a0  a0 30 1d 06 03 55 1d 25  04 16 30 14 06 08 2b 06  |.0...U.%..0...+.|
-000001b0  01 05 05 07 03 01 06 08  2b 06 01 05 05 07 03 02  |........+.......|
-000001c0  30 0c 06 03 55 1d 13 01  01 ff 04 02 30 00 30 19  |0...U.......0.0.|
-000001d0  06 03 55 1d 0e 04 12 04  10 9f 91 16 1f 43 43 3e  |..U..........CC>|
-000001e0  49 a6 de 6d b6 80 d7 9f  60 30 1b 06 03 55 1d 23  |I..m....`0...U.#|
-000001f0  04 14 30 12 80 10 48 13  49 4d 13 7e 16 31 bb a3  |..0...H.IM.~.1..|
-00000200  01 d5 ac ab 6e 7b 30 19  06 03 55 1d 11 04 12 30  |....n{0...U....0|
-00000210  10 82 0e 65 78 61 6d 70  6c 65 2e 67 6f 6c 61 6e  |...example.golan|
-00000220  67 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |g0...*.H........|
-00000230  03 81 81 00 9d 30 cc 40  2b 5b 50 a0 61 cb ba e5  |.....0.@+[P.a...|
-00000240  53 58 e1 ed 83 28 a9 58  1a a9 38 a4 95 a1 ac 31  |SX...(.X..8....1|
-00000250  5a 1a 84 66 3d 43 d3 2d  d9 0b f2 97 df d3 20 64  |Z..f=C.-...... d|
-00000260  38 92 24 3a 00 bc cf 9c  7d b7 40 20 01 5f aa d3  |8.$:....}.@ ._..|
-00000270  16 61 09 a2 76 fd 13 c3  cc e1 0c 5c ee b1 87 82  |.a..v......\....|
-00000280  f1 6c 04 ed 73 bb b3 43  77 8d 0c 1c f1 0f a1 d8  |.l..s..Cw.......|
-00000290  40 83 61 c9 4c 72 2b 9d  ae db 46 06 06 4d f4 c1  |@.a.Lr+...F..M..|
-000002a0  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
-000002b0  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
+00000000  16 03 03 00 55 02 00 00  51 03 03 9f d7 f5 00 f6  |....U...Q.......|
+00000010  a1 c5 37 e8 2b 2e 66 42  54 c6 67 29 b6 ad bb 5f  |..7.+.fBT.g)..._|
+00000020  23 b7 bb 56 2e 8a 15 a9  7a ce a2 20 47 be 36 13  |#..V....z.. G.6.|
+00000030  31 d7 51 a6 ec d1 67 e7  e3 8c fb e2 f5 d2 61 e6  |1.Q...g.......a.|
+00000040  4e 11 0c 03 b0 5e b1 ae  e7 8c 61 c8 00 9c 00 00  |N....^....a.....|
+00000050  09 ff 01 00 01 00 00 17  00 00 16 03 03 02 59 0b  |..............Y.|
+00000060  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
+00000070  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
+00000080  a6 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |.0...*.H........|
+00000090  30 1f 31 0b 30 09 06 03  55 04 0a 13 02 47 6f 31  |0.1.0...U....Go1|
+000000a0  10 30 0e 06 03 55 04 03  13 07 47 6f 20 52 6f 6f  |.0...U....Go Roo|
+000000b0  74 30 1e 17 0d 31 36 30  31 30 31 30 30 30 30 30  |t0...16010100000|
+000000c0  30 5a 17 0d 32 35 30 31  30 31 30 30 30 30 30 30  |0Z..250101000000|
+000000d0  5a 30 1a 31 0b 30 09 06  03 55 04 0a 13 02 47 6f  |Z0.1.0...U....Go|
+000000e0  31 0b 30 09 06 03 55 04  03 13 02 47 6f 30 81 9f  |1.0...U....Go0..|
+000000f0  30 0d 06 09 2a 86 48 86  f7 0d 01 01 01 05 00 03  |0...*.H.........|
+00000100  81 8d 00 30 81 89 02 81  81 00 db 46 7d 93 2e 12  |...0.......F}...|
+00000110  27 06 48 bc 06 28 21 ab  7e c4 b6 a2 5d fe 1e 52  |'.H..(!.~...]..R|
+00000120  45 88 7a 36 47 a5 08 0d  92 42 5b c2 81 c0 be 97  |E.z6G....B[.....|
+00000130  79 98 40 fb 4f 6d 14 fd  2b 13 8b c2 a5 2e 67 d8  |y.@.Om..+.....g.|
+00000140  d4 09 9e d6 22 38 b7 4a  0b 74 73 2b c2 34 f1 d1  |...."8.J.ts+.4..|
+00000150  93 e5 96 d9 74 7b f3 58  9f 6c 61 3c c0 b0 41 d4  |....t{.X.la<..A.|
+00000160  d9 2b 2b 24 23 77 5b 1c  3b bd 75 5d ce 20 54 cf  |.++$#w[.;.u]. T.|
+00000170  a1 63 87 1d 1e 24 c4 f3  1d 1a 50 8b aa b6 14 43  |.c...$....P....C|
+00000180  ed 97 a7 75 62 f4 14 c8  52 d7 02 03 01 00 01 a3  |...ub...R.......|
+00000190  81 93 30 81 90 30 0e 06  03 55 1d 0f 01 01 ff 04  |..0..0...U......|
+000001a0  04 03 02 05 a0 30 1d 06  03 55 1d 25 04 16 30 14  |.....0...U.%..0.|
+000001b0  06 08 2b 06 01 05 05 07  03 01 06 08 2b 06 01 05  |..+.........+...|
+000001c0  05 07 03 02 30 0c 06 03  55 1d 13 01 01 ff 04 02  |....0...U.......|
+000001d0  30 00 30 19 06 03 55 1d  0e 04 12 04 10 9f 91 16  |0.0...U.........|
+000001e0  1f 43 43 3e 49 a6 de 6d  b6 80 d7 9f 60 30 1b 06  |.CC>I..m....`0..|
+000001f0  03 55 1d 23 04 14 30 12  80 10 48 13 49 4d 13 7e  |.U.#..0...H.IM.~|
+00000200  16 31 bb a3 01 d5 ac ab  6e 7b 30 19 06 03 55 1d  |.1......n{0...U.|
+00000210  11 04 12 30 10 82 0e 65  78 61 6d 70 6c 65 2e 67  |...0...example.g|
+00000220  6f 6c 61 6e 67 30 0d 06  09 2a 86 48 86 f7 0d 01  |olang0...*.H....|
+00000230  01 0b 05 00 03 81 81 00  9d 30 cc 40 2b 5b 50 a0  |.........0.@+[P.|
+00000240  61 cb ba e5 53 58 e1 ed  83 28 a9 58 1a a9 38 a4  |a...SX...(.X..8.|
+00000250  95 a1 ac 31 5a 1a 84 66  3d 43 d3 2d d9 0b f2 97  |...1Z..f=C.-....|
+00000260  df d3 20 64 38 92 24 3a  00 bc cf 9c 7d b7 40 20  |.. d8.$:....}.@ |
+00000270  01 5f aa d3 16 61 09 a2  76 fd 13 c3 cc e1 0c 5c  |._...a..v......\|
+00000280  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
+00000290  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
+000002a0  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
+000002b0  84 5c 21 d3 3b e9 fa e7  16 03 03 00 04 0e 00 00  |.\!.;...........|
+000002c0  00                                                |.|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 86 10 00 00  82 00 80 b9 65 8d bf a7  |............e...|
 00000010  c8 4b 79 ce 6f cb 8b 13  1c ac b9 7d 66 5e e9 ba  |.Ky.o......}f^..|
@@ -70,17 +72,17 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 64 6c  |.....(........dl|
-000000a0  08 78 1d 03 0c ed dd 01  30 d4 fb 7c 3f 24 45 cc  |.x......0..|?$E.|
-000000b0  f6 b2 e3 42 07 93 8f 34  a8 21 d1 b0 08 e3        |...B...4.!....|
+00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 10 d7  |.....(..........|
+000000a0  17 1b 75 0d 79 ed 8d bc  fb 1c c4 d6 35 44 f0 ed  |..u.y.......5D..|
+000000b0  ed 03 24 02 df 44 9b 70  df 4b 51 19 e6 72        |..$..D.p.KQ..r|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 75 9b 91 cd 7d  |..........(u...}|
-00000010  8d f7 3c a0 d6 5e d4 f2  24 1a 0a f3 04 b1 d9 0b  |..<..^..$.......|
-00000020  1d 31 ca 1c 8b e7 38 c0  8e 7d 12 19 89 33 28 4d  |.1....8..}...3(M|
-00000030  83 28 b6                                          |.(.|
+00000000  14 03 03 00 01 01 16 03  03 00 28 68 9f 7c f3 ac  |..........(h.|..|
+00000010  31 93 86 d0 b7 0a 68 55  7a 93 00 4e c3 d6 dc 60  |1.....hUz..N...`|
+00000020  d1 c5 4a 04 53 da 27 ed  c1 0e 14 41 a5 27 f1 d5  |..J.S.'....A.'..|
+00000030  2e 4a 43                                          |.JC|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 7d fe 53  |.............}.S|
-00000010  73 aa ca 3d f3 27 b7 01  56 9e e7 c9 6d 79 2a 97  |s..=.'..V...my*.|
-00000020  b2 21 42 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.!B.............|
-00000030  de bd 3e 9e 8f c0 98 ec  bd b4 9b 89 90 a2 26 a8  |..>...........&.|
-00000040  28 97                                             |(.|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 e7 e6 3e  |...............>|
+00000010  e9 04 96 38 0c d4 e1 46  c6 d2 2a 1b b0 b3 11 9b  |...8...F..*.....|
+00000020  6d f4 81 15 03 03 00 1a  00 00 00 00 00 00 00 02  |m...............|
+00000030  a3 60 58 f2 f6 60 95 f3  c4 e1 95 23 22 52 55 63  |.`X..`.....#"RUc|
+00000040  b9 75                                             |.u|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-AES128-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-AES128-SHA256
index 15394c7e34..ee6ab629e0 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-AES128-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv12-AES128-SHA256
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,59 +7,61 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 51 02 00 00  4d 03 03 8a a8 2c 00 d8  |....Q...M....,..|
-00000010  d8 87 53 14 1e 7b ff ca  19 a2 6d bc 47 6f 73 12  |..S..{....m.Gos.|
-00000020  0d 54 6e 33 21 80 01 86  f8 81 9f 20 46 f6 8c e8  |.Tn3!...... F...|
-00000030  8b 90 02 b2 da e2 83 3a  2a 0f b3 f7 96 2b f8 96  |.......:*....+..|
-00000040  56 77 39 52 9e a1 bd 74  1e 2e b1 b0 00 3c 00 00  |Vw9R...t.....<..|
-00000050  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
-00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
-00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
-00000080  09 2a 86 48 86 f7 0d 01  01 0b 05 00 30 1f 31 0b  |.*.H........0.1.|
-00000090  30 09 06 03 55 04 0a 13  02 47 6f 31 10 30 0e 06  |0...U....Go1.0..|
-000000a0  03 55 04 03 13 07 47 6f  20 52 6f 6f 74 30 1e 17  |.U....Go Root0..|
-000000b0  0d 31 36 30 31 30 31 30  30 30 30 30 30 5a 17 0d  |.160101000000Z..|
-000000c0  32 35 30 31 30 31 30 30  30 30 30 30 5a 30 1a 31  |250101000000Z0.1|
-000000d0  0b 30 09 06 03 55 04 0a  13 02 47 6f 31 0b 30 09  |.0...U....Go1.0.|
-000000e0  06 03 55 04 03 13 02 47  6f 30 81 9f 30 0d 06 09  |..U....Go0..0...|
-000000f0  2a 86 48 86 f7 0d 01 01  01 05 00 03 81 8d 00 30  |*.H............0|
-00000100  81 89 02 81 81 00 db 46  7d 93 2e 12 27 06 48 bc  |.......F}...'.H.|
-00000110  06 28 21 ab 7e c4 b6 a2  5d fe 1e 52 45 88 7a 36  |.(!.~...]..RE.z6|
-00000120  47 a5 08 0d 92 42 5b c2  81 c0 be 97 79 98 40 fb  |G....B[.....y.@.|
-00000130  4f 6d 14 fd 2b 13 8b c2  a5 2e 67 d8 d4 09 9e d6  |Om..+.....g.....|
-00000140  22 38 b7 4a 0b 74 73 2b  c2 34 f1 d1 93 e5 96 d9  |"8.J.ts+.4......|
-00000150  74 7b f3 58 9f 6c 61 3c  c0 b0 41 d4 d9 2b 2b 24  |t{.X.la<..A..++$|
-00000160  23 77 5b 1c 3b bd 75 5d  ce 20 54 cf a1 63 87 1d  |#w[.;.u]. T..c..|
-00000170  1e 24 c4 f3 1d 1a 50 8b  aa b6 14 43 ed 97 a7 75  |.$....P....C...u|
-00000180  62 f4 14 c8 52 d7 02 03  01 00 01 a3 81 93 30 81  |b...R.........0.|
-00000190  90 30 0e 06 03 55 1d 0f  01 01 ff 04 04 03 02 05  |.0...U..........|
-000001a0  a0 30 1d 06 03 55 1d 25  04 16 30 14 06 08 2b 06  |.0...U.%..0...+.|
-000001b0  01 05 05 07 03 01 06 08  2b 06 01 05 05 07 03 02  |........+.......|
-000001c0  30 0c 06 03 55 1d 13 01  01 ff 04 02 30 00 30 19  |0...U.......0.0.|
-000001d0  06 03 55 1d 0e 04 12 04  10 9f 91 16 1f 43 43 3e  |..U..........CC>|
-000001e0  49 a6 de 6d b6 80 d7 9f  60 30 1b 06 03 55 1d 23  |I..m....`0...U.#|
-000001f0  04 14 30 12 80 10 48 13  49 4d 13 7e 16 31 bb a3  |..0...H.IM.~.1..|
-00000200  01 d5 ac ab 6e 7b 30 19  06 03 55 1d 11 04 12 30  |....n{0...U....0|
-00000210  10 82 0e 65 78 61 6d 70  6c 65 2e 67 6f 6c 61 6e  |...example.golan|
-00000220  67 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |g0...*.H........|
-00000230  03 81 81 00 9d 30 cc 40  2b 5b 50 a0 61 cb ba e5  |.....0.@+[P.a...|
-00000240  53 58 e1 ed 83 28 a9 58  1a a9 38 a4 95 a1 ac 31  |SX...(.X..8....1|
-00000250  5a 1a 84 66 3d 43 d3 2d  d9 0b f2 97 df d3 20 64  |Z..f=C.-...... d|
-00000260  38 92 24 3a 00 bc cf 9c  7d b7 40 20 01 5f aa d3  |8.$:....}.@ ._..|
-00000270  16 61 09 a2 76 fd 13 c3  cc e1 0c 5c ee b1 87 82  |.a..v......\....|
-00000280  f1 6c 04 ed 73 bb b3 43  77 8d 0c 1c f1 0f a1 d8  |.l..s..Cw.......|
-00000290  40 83 61 c9 4c 72 2b 9d  ae db 46 06 06 4d f4 c1  |@.a.Lr+...F..M..|
-000002a0  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
-000002b0  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
+00000000  16 03 03 00 55 02 00 00  51 03 03 b3 4d 83 66 45  |....U...Q...M.fE|
+00000010  e7 32 1f e5 99 ea a0 90  c7 12 91 2b 25 82 ba ca  |.2.........+%...|
+00000020  01 c1 a9 22 1f 1d 06 62  e1 37 6a 20 a4 87 9b c0  |..."...b.7j ....|
+00000030  7f 86 ff c1 0f 49 56 fe  c4 49 f7 fb e5 97 23 dc  |.....IV..I....#.|
+00000040  fc 51 80 75 f7 03 52 5e  86 80 97 0f 00 3c 00 00  |.Q.u..R^.....<..|
+00000050  09 ff 01 00 01 00 00 17  00 00 16 03 03 02 59 0b  |..............Y.|
+00000060  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
+00000070  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
+00000080  a6 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |.0...*.H........|
+00000090  30 1f 31 0b 30 09 06 03  55 04 0a 13 02 47 6f 31  |0.1.0...U....Go1|
+000000a0  10 30 0e 06 03 55 04 03  13 07 47 6f 20 52 6f 6f  |.0...U....Go Roo|
+000000b0  74 30 1e 17 0d 31 36 30  31 30 31 30 30 30 30 30  |t0...16010100000|
+000000c0  30 5a 17 0d 32 35 30 31  30 31 30 30 30 30 30 30  |0Z..250101000000|
+000000d0  5a 30 1a 31 0b 30 09 06  03 55 04 0a 13 02 47 6f  |Z0.1.0...U....Go|
+000000e0  31 0b 30 09 06 03 55 04  03 13 02 47 6f 30 81 9f  |1.0...U....Go0..|
+000000f0  30 0d 06 09 2a 86 48 86  f7 0d 01 01 01 05 00 03  |0...*.H.........|
+00000100  81 8d 00 30 81 89 02 81  81 00 db 46 7d 93 2e 12  |...0.......F}...|
+00000110  27 06 48 bc 06 28 21 ab  7e c4 b6 a2 5d fe 1e 52  |'.H..(!.~...]..R|
+00000120  45 88 7a 36 47 a5 08 0d  92 42 5b c2 81 c0 be 97  |E.z6G....B[.....|
+00000130  79 98 40 fb 4f 6d 14 fd  2b 13 8b c2 a5 2e 67 d8  |y.@.Om..+.....g.|
+00000140  d4 09 9e d6 22 38 b7 4a  0b 74 73 2b c2 34 f1 d1  |...."8.J.ts+.4..|
+00000150  93 e5 96 d9 74 7b f3 58  9f 6c 61 3c c0 b0 41 d4  |....t{.X.la<..A.|
+00000160  d9 2b 2b 24 23 77 5b 1c  3b bd 75 5d ce 20 54 cf  |.++$#w[.;.u]. T.|
+00000170  a1 63 87 1d 1e 24 c4 f3  1d 1a 50 8b aa b6 14 43  |.c...$....P....C|
+00000180  ed 97 a7 75 62 f4 14 c8  52 d7 02 03 01 00 01 a3  |...ub...R.......|
+00000190  81 93 30 81 90 30 0e 06  03 55 1d 0f 01 01 ff 04  |..0..0...U......|
+000001a0  04 03 02 05 a0 30 1d 06  03 55 1d 25 04 16 30 14  |.....0...U.%..0.|
+000001b0  06 08 2b 06 01 05 05 07  03 01 06 08 2b 06 01 05  |..+.........+...|
+000001c0  05 07 03 02 30 0c 06 03  55 1d 13 01 01 ff 04 02  |....0...U.......|
+000001d0  30 00 30 19 06 03 55 1d  0e 04 12 04 10 9f 91 16  |0.0...U.........|
+000001e0  1f 43 43 3e 49 a6 de 6d  b6 80 d7 9f 60 30 1b 06  |.CC>I..m....`0..|
+000001f0  03 55 1d 23 04 14 30 12  80 10 48 13 49 4d 13 7e  |.U.#..0...H.IM.~|
+00000200  16 31 bb a3 01 d5 ac ab  6e 7b 30 19 06 03 55 1d  |.1......n{0...U.|
+00000210  11 04 12 30 10 82 0e 65  78 61 6d 70 6c 65 2e 67  |...0...example.g|
+00000220  6f 6c 61 6e 67 30 0d 06  09 2a 86 48 86 f7 0d 01  |olang0...*.H....|
+00000230  01 0b 05 00 03 81 81 00  9d 30 cc 40 2b 5b 50 a0  |.........0.@+[P.|
+00000240  61 cb ba e5 53 58 e1 ed  83 28 a9 58 1a a9 38 a4  |a...SX...(.X..8.|
+00000250  95 a1 ac 31 5a 1a 84 66  3d 43 d3 2d d9 0b f2 97  |...1Z..f=C.-....|
+00000260  df d3 20 64 38 92 24 3a  00 bc cf 9c 7d b7 40 20  |.. d8.$:....}.@ |
+00000270  01 5f aa d3 16 61 09 a2  76 fd 13 c3 cc e1 0c 5c  |._...a..v......\|
+00000280  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
+00000290  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
+000002a0  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
+000002b0  84 5c 21 d3 3b e9 fa e7  16 03 03 00 04 0e 00 00  |.\!.;...........|
+000002c0  00                                                |.|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 86 10 00 00  82 00 80 b9 65 8d bf a7  |............e...|
 00000010  c8 4b 79 ce 6f cb 8b 13  1c ac b9 7d 66 5e e9 ba  |.Ky.o......}f^..|
@@ -71,25 +73,25 @@
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
 00000090  01 16 03 03 00 50 00 00  00 00 00 00 00 00 00 00  |.....P..........|
-000000a0  00 00 00 00 00 00 8f d8  ac 7f ec 16 9e d8 e9 f2  |................|
-000000b0  ce 30 51 dc 87 e0 f9 80  57 66 d9 87 20 77 3a b1  |.0Q.....Wf.. w:.|
-000000c0  43 db fc 36 f5 64 6e 96  e9 b8 e2 ab bb 00 48 36  |C..6.dn.......H6|
-000000d0  60 9c 5a 7c 38 3f 13 e1  9c ef d9 15 96 91 56 e2  |`.Z|8?........V.|
-000000e0  87 2e 23 1a 98 40                                 |..#..@|
+000000a0  00 00 00 00 00 00 ad 28  77 9e 77 a8 54 2d df fe  |.......(w.w.T-..|
+000000b0  b3 d1 3a 88 49 e8 ee 86  a1 46 d8 46 26 98 88 f3  |..:.I....F.F&...|
+000000c0  eb e1 bd 26 38 26 78 53  90 47 bf 76 4b 29 a6 db  |...&8&xS.G.vK)..|
+000000d0  e5 c5 5d aa e7 cc d1 ad  ee 3f 27 72 a3 a7 06 8b  |..]......?'r....|
+000000e0  1a da 35 1a 57 4a                                 |..5.WJ|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 50 80 01 08 cc d8  |..........P.....|
-00000010  08 a8 81 20 b2 bb 5b 50  79 74 4a b5 10 c4 7a 30  |... ..[PytJ...z0|
-00000020  6c 46 d6 e5 36 6e 4d cc  e5 0c 2c ab 3b de 92 45  |lF..6nM...,.;..E|
-00000030  ee 20 58 a9 0f 03 26 3e  6c 05 a7 ef f2 7c a7 9b  |. X...&>l....|..|
-00000040  57 c0 20 8d d0 69 0e b0  5a cc e6 26 5f e2 c3 24  |W. ..i..Z..&_..$|
-00000050  c4 db df 20 03 08 e1 aa  59 2b d2                 |... ....Y+.|
+00000000  14 03 03 00 01 01 16 03  03 00 50 b6 40 f7 ea 59  |..........P.@..Y|
+00000010  29 60 1f b0 00 78 db 1b  29 4e 4f 7d 02 12 a9 f9  |)`...x..)NO}....|
+00000020  98 fb 89 9e 08 8d 55 91  f3 d1 b3 58 73 ba 58 12  |......U....Xs.X.|
+00000030  2e b3 3a da 3a 96 76 63  5c 89 7b d5 64 9a 41 3f  |..:.:.vc\.{.d.A?|
+00000040  f9 55 4c 19 d7 08 a1 b2  c4 cc f0 6a e3 7d ab 6b  |.UL........j.}.k|
+00000050  26 cf 80 10 a9 c6 1a d6  2d 0e 77                 |&.......-.w|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000010  00 00 00 00 00 a2 dd a6  ff 57 60 80 dd 97 cf 20  |.........W`.... |
-00000020  10 04 60 80 53 17 37 ce  ce 39 b6 21 f4 06 61 aa  |..`.S.7..9.!..a.|
-00000030  49 7b f0 d5 e0 72 4c 6f  38 d2 ab af 1c 94 bd 5b  |I{...rLo8......[|
-00000040  1b ee 8a 9b e3 15 03 03  00 40 00 00 00 00 00 00  |.........@......|
-00000050  00 00 00 00 00 00 00 00  00 00 ba 18 32 e7 6d f5  |............2.m.|
-00000060  fa 2e 61 55 cc fe 3c 4d  19 fd 84 6d c4 2a 46 92  |..aU..<M...m.*F.|
-00000070  ae b7 f3 67 c8 3c ce cd  b0 66 de ee 5d 3f 07 3b  |...g.<...f..]?.;|
-00000080  a9 85 a1 93 1f 98 f7 95  c9 ac                    |..........|
+00000010  00 00 00 00 00 04 1d bb  53 4a 08 73 26 c2 33 d5  |........SJ.s&.3.|
+00000020  95 2c cf aa 74 1b 58 27  11 99 f9 67 e7 93 56 72  |.,..t.X'...g..Vr|
+00000030  a5 0b 96 9e ea 32 b2 c8  c3 2e 47 b4 91 81 47 86  |.....2....G...G.|
+00000040  f2 31 fd 7a f8 15 03 03  00 40 00 00 00 00 00 00  |.1.z.....@......|
+00000050  00 00 00 00 00 00 00 00  00 00 55 3a e3 6d aa 75  |..........U:.m.u|
+00000060  31 f5 92 6c ae f8 8d fc  f4 6e 20 de a6 66 7c 97  |1..l.....n ..f|.|
+00000070  51 e5 c7 8b 4a 1d 0e e8  38 f5 9f 0a 6b b6 63 c1  |Q...J...8...k.c.|
+00000080  85 97 c6 3c d2 79 b5 a3  42 1d                    |...<.y..B.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384 b/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384
index 766bf95067..0166f1ab35 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384
+++ b/src/crypto/tls/testdata/Client-TLSv12-AES256-GCM-SHA384
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,59 +7,61 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 51 02 00 00  4d 03 03 de 7a 77 5b eb  |....Q...M...zw[.|
-00000010  fa 84 a0 ac ba 3b ca 25  dc b3 c0 06 44 da 31 5c  |.....;.%....D.1\|
-00000020  27 e0 4e af be 47 07 5a  a5 ab 20 20 72 b2 67 0c  |'.N..G.Z..  r.g.|
-00000030  7e 71 5d e3 55 89 91 27  7f 65 ac 71 c6 e8 a5 4a  |~q].U..'.e.q...J|
-00000040  ae e1 a2 0d 3f a6 62 08  17 7e 26 fd 00 9d 00 00  |....?.b..~&.....|
-00000050  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
-00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
-00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
-00000080  09 2a 86 48 86 f7 0d 01  01 0b 05 00 30 1f 31 0b  |.*.H........0.1.|
-00000090  30 09 06 03 55 04 0a 13  02 47 6f 31 10 30 0e 06  |0...U....Go1.0..|
-000000a0  03 55 04 03 13 07 47 6f  20 52 6f 6f 74 30 1e 17  |.U....Go Root0..|
-000000b0  0d 31 36 30 31 30 31 30  30 30 30 30 30 5a 17 0d  |.160101000000Z..|
-000000c0  32 35 30 31 30 31 30 30  30 30 30 30 5a 30 1a 31  |250101000000Z0.1|
-000000d0  0b 30 09 06 03 55 04 0a  13 02 47 6f 31 0b 30 09  |.0...U....Go1.0.|
-000000e0  06 03 55 04 03 13 02 47  6f 30 81 9f 30 0d 06 09  |..U....Go0..0...|
-000000f0  2a 86 48 86 f7 0d 01 01  01 05 00 03 81 8d 00 30  |*.H............0|
-00000100  81 89 02 81 81 00 db 46  7d 93 2e 12 27 06 48 bc  |.......F}...'.H.|
-00000110  06 28 21 ab 7e c4 b6 a2  5d fe 1e 52 45 88 7a 36  |.(!.~...]..RE.z6|
-00000120  47 a5 08 0d 92 42 5b c2  81 c0 be 97 79 98 40 fb  |G....B[.....y.@.|
-00000130  4f 6d 14 fd 2b 13 8b c2  a5 2e 67 d8 d4 09 9e d6  |Om..+.....g.....|
-00000140  22 38 b7 4a 0b 74 73 2b  c2 34 f1 d1 93 e5 96 d9  |"8.J.ts+.4......|
-00000150  74 7b f3 58 9f 6c 61 3c  c0 b0 41 d4 d9 2b 2b 24  |t{.X.la<..A..++$|
-00000160  23 77 5b 1c 3b bd 75 5d  ce 20 54 cf a1 63 87 1d  |#w[.;.u]. T..c..|
-00000170  1e 24 c4 f3 1d 1a 50 8b  aa b6 14 43 ed 97 a7 75  |.$....P....C...u|
-00000180  62 f4 14 c8 52 d7 02 03  01 00 01 a3 81 93 30 81  |b...R.........0.|
-00000190  90 30 0e 06 03 55 1d 0f  01 01 ff 04 04 03 02 05  |.0...U..........|
-000001a0  a0 30 1d 06 03 55 1d 25  04 16 30 14 06 08 2b 06  |.0...U.%..0...+.|
-000001b0  01 05 05 07 03 01 06 08  2b 06 01 05 05 07 03 02  |........+.......|
-000001c0  30 0c 06 03 55 1d 13 01  01 ff 04 02 30 00 30 19  |0...U.......0.0.|
-000001d0  06 03 55 1d 0e 04 12 04  10 9f 91 16 1f 43 43 3e  |..U..........CC>|
-000001e0  49 a6 de 6d b6 80 d7 9f  60 30 1b 06 03 55 1d 23  |I..m....`0...U.#|
-000001f0  04 14 30 12 80 10 48 13  49 4d 13 7e 16 31 bb a3  |..0...H.IM.~.1..|
-00000200  01 d5 ac ab 6e 7b 30 19  06 03 55 1d 11 04 12 30  |....n{0...U....0|
-00000210  10 82 0e 65 78 61 6d 70  6c 65 2e 67 6f 6c 61 6e  |...example.golan|
-00000220  67 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |g0...*.H........|
-00000230  03 81 81 00 9d 30 cc 40  2b 5b 50 a0 61 cb ba e5  |.....0.@+[P.a...|
-00000240  53 58 e1 ed 83 28 a9 58  1a a9 38 a4 95 a1 ac 31  |SX...(.X..8....1|
-00000250  5a 1a 84 66 3d 43 d3 2d  d9 0b f2 97 df d3 20 64  |Z..f=C.-...... d|
-00000260  38 92 24 3a 00 bc cf 9c  7d b7 40 20 01 5f aa d3  |8.$:....}.@ ._..|
-00000270  16 61 09 a2 76 fd 13 c3  cc e1 0c 5c ee b1 87 82  |.a..v......\....|
-00000280  f1 6c 04 ed 73 bb b3 43  77 8d 0c 1c f1 0f a1 d8  |.l..s..Cw.......|
-00000290  40 83 61 c9 4c 72 2b 9d  ae db 46 06 06 4d f4 c1  |@.a.Lr+...F..M..|
-000002a0  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
-000002b0  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
+00000000  16 03 03 00 55 02 00 00  51 03 03 38 33 33 fb 62  |....U...Q..833.b|
+00000010  ff ce 69 f1 cd 8c fe 50  05 bd 1e ce f9 ad a5 e6  |..i....P........|
+00000020  ee d7 71 82 97 25 04 2a  cd aa c5 20 13 68 7a d0  |..q..%.*... .hz.|
+00000030  0f cc 61 05 63 31 cc 47  24 1c 52 81 8d cc d3 d1  |..a.c1.G$.R.....|
+00000040  d1 53 97 70 e9 f1 98 3b  00 2d df ab 00 9d 00 00  |.S.p...;.-......|
+00000050  09 ff 01 00 01 00 00 17  00 00 16 03 03 02 59 0b  |..............Y.|
+00000060  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
+00000070  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
+00000080  a6 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |.0...*.H........|
+00000090  30 1f 31 0b 30 09 06 03  55 04 0a 13 02 47 6f 31  |0.1.0...U....Go1|
+000000a0  10 30 0e 06 03 55 04 03  13 07 47 6f 20 52 6f 6f  |.0...U....Go Roo|
+000000b0  74 30 1e 17 0d 31 36 30  31 30 31 30 30 30 30 30  |t0...16010100000|
+000000c0  30 5a 17 0d 32 35 30 31  30 31 30 30 30 30 30 30  |0Z..250101000000|
+000000d0  5a 30 1a 31 0b 30 09 06  03 55 04 0a 13 02 47 6f  |Z0.1.0...U....Go|
+000000e0  31 0b 30 09 06 03 55 04  03 13 02 47 6f 30 81 9f  |1.0...U....Go0..|
+000000f0  30 0d 06 09 2a 86 48 86  f7 0d 01 01 01 05 00 03  |0...*.H.........|
+00000100  81 8d 00 30 81 89 02 81  81 00 db 46 7d 93 2e 12  |...0.......F}...|
+00000110  27 06 48 bc 06 28 21 ab  7e c4 b6 a2 5d fe 1e 52  |'.H..(!.~...]..R|
+00000120  45 88 7a 36 47 a5 08 0d  92 42 5b c2 81 c0 be 97  |E.z6G....B[.....|
+00000130  79 98 40 fb 4f 6d 14 fd  2b 13 8b c2 a5 2e 67 d8  |y.@.Om..+.....g.|
+00000140  d4 09 9e d6 22 38 b7 4a  0b 74 73 2b c2 34 f1 d1  |...."8.J.ts+.4..|
+00000150  93 e5 96 d9 74 7b f3 58  9f 6c 61 3c c0 b0 41 d4  |....t{.X.la<..A.|
+00000160  d9 2b 2b 24 23 77 5b 1c  3b bd 75 5d ce 20 54 cf  |.++$#w[.;.u]. T.|
+00000170  a1 63 87 1d 1e 24 c4 f3  1d 1a 50 8b aa b6 14 43  |.c...$....P....C|
+00000180  ed 97 a7 75 62 f4 14 c8  52 d7 02 03 01 00 01 a3  |...ub...R.......|
+00000190  81 93 30 81 90 30 0e 06  03 55 1d 0f 01 01 ff 04  |..0..0...U......|
+000001a0  04 03 02 05 a0 30 1d 06  03 55 1d 25 04 16 30 14  |.....0...U.%..0.|
+000001b0  06 08 2b 06 01 05 05 07  03 01 06 08 2b 06 01 05  |..+.........+...|
+000001c0  05 07 03 02 30 0c 06 03  55 1d 13 01 01 ff 04 02  |....0...U.......|
+000001d0  30 00 30 19 06 03 55 1d  0e 04 12 04 10 9f 91 16  |0.0...U.........|
+000001e0  1f 43 43 3e 49 a6 de 6d  b6 80 d7 9f 60 30 1b 06  |.CC>I..m....`0..|
+000001f0  03 55 1d 23 04 14 30 12  80 10 48 13 49 4d 13 7e  |.U.#..0...H.IM.~|
+00000200  16 31 bb a3 01 d5 ac ab  6e 7b 30 19 06 03 55 1d  |.1......n{0...U.|
+00000210  11 04 12 30 10 82 0e 65  78 61 6d 70 6c 65 2e 67  |...0...example.g|
+00000220  6f 6c 61 6e 67 30 0d 06  09 2a 86 48 86 f7 0d 01  |olang0...*.H....|
+00000230  01 0b 05 00 03 81 81 00  9d 30 cc 40 2b 5b 50 a0  |.........0.@+[P.|
+00000240  61 cb ba e5 53 58 e1 ed  83 28 a9 58 1a a9 38 a4  |a...SX...(.X..8.|
+00000250  95 a1 ac 31 5a 1a 84 66  3d 43 d3 2d d9 0b f2 97  |...1Z..f=C.-....|
+00000260  df d3 20 64 38 92 24 3a  00 bc cf 9c 7d b7 40 20  |.. d8.$:....}.@ |
+00000270  01 5f aa d3 16 61 09 a2  76 fd 13 c3 cc e1 0c 5c  |._...a..v......\|
+00000280  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
+00000290  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
+000002a0  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
+000002b0  84 5c 21 d3 3b e9 fa e7  16 03 03 00 04 0e 00 00  |.\!.;...........|
+000002c0  00                                                |.|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 86 10 00 00  82 00 80 b9 65 8d bf a7  |............e...|
 00000010  c8 4b 79 ce 6f cb 8b 13  1c ac b9 7d 66 5e e9 ba  |.Ky.o......}f^..|
@@ -70,17 +72,17 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 0b 7d  |.....(.........}|
-000000a0  83 0f 79 e2 4b ef d3 0e  ff 57 d2 55 cd ea e9 be  |..y.K....W.U....|
-000000b0  8b 38 1e 33 b0 6a eb e3  aa 51 52 82 e6 15        |.8.3.j...QR...|
+00000090  01 16 03 03 00 28 00 00  00 00 00 00 00 00 2b 4c  |.....(........+L|
+000000a0  62 77 65 ac 19 53 aa 52  8e 3d 92 5b e1 45 c6 90  |bwe..S.R.=.[.E..|
+000000b0  bf 01 bb e3 9c d2 6a ed  bf e6 8c 53 3d 58        |......j....S=X|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 1a a3 bb d4 c4  |..........(.....|
-00000010  53 c7 5c 09 8c fb e7 51  41 73 d5 76 ef e6 40 9a  |S.\....QAs.v..@.|
-00000020  06 27 c6 e8 9f 1b 25 f5  d1 7b 39 b7 74 ab e8 83  |.'....%..{9.t...|
-00000030  26 f6 40                                          |&.@|
+00000000  14 03 03 00 01 01 16 03  03 00 28 77 7f 9b a4 ea  |..........(w....|
+00000010  30 03 8f fd 22 37 60 78  db b1 1a 37 bc 2d 50 ad  |0..."7`x...7.-P.|
+00000020  40 b4 a6 8f f8 0c e8 ab  24 54 82 12 75 be 0b 8c  |@.......$T..u...|
+00000030  9f 35 e2                                          |.5.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 1c 0d 06  |................|
-00000010  d2 25 8a 06 d9 b4 d6 76  89 1c c6 b7 22 9f 44 63  |.%.....v....".Dc|
-00000020  a3 f9 89 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
-00000030  cb 34 e8 4b f7 b1 ab 1a  74 60 2c 2d cf a4 7d 9f  |.4.K....t`,-..}.|
-00000040  f4 b4                                             |..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 01 66 69  |..............fi|
+00000010  ac a4 9d 4f d2 59 01 4e  d6 04 98 e5 c8 83 b3 cb  |...O.Y.N........|
+00000020  36 4d cf 15 03 03 00 1a  00 00 00 00 00 00 00 02  |6M..............|
+00000030  17 80 89 ac 0b d6 00 8c  1d ae b2 c2 46 42 69 82  |............FBi.|
+00000040  da ac                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ALPN b/src/crypto/tls/testdata/Client-TLSv12-ALPN
index 8b9a510c4c..4ae1fe9f38 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ALPN
+++ b/src/crypto/tls/testdata/Client-TLSv12-ALPN
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 0e 01 00 01  0a 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 12 01 00 01  0e 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,87 +7,87 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 8f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
+00000080  01 00 00 93 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 10 00 10  00 0e 06 70 72 6f 74 6f  |...........proto|
-000000d0  32 06 70 72 6f 74 6f 31  00 12 00 00 00 2b 00 09  |2.proto1.....+..|
-000000e0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000f0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-00000100  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000110  cb 3b 74                                          |.;t|
+000000c0  01 00 01 00 00 17 00 00  00 10 00 10 00 0e 06 70  |...............p|
+000000d0  72 6f 74 6f 32 06 70 72  6f 74 6f 31 00 12 00 00  |roto2.proto1....|
+000000e0  00 2b 00 09 08 03 04 03  03 03 02 03 01 00 33 00  |.+............3.|
+000000f0  26 00 24 00 1d 00 20 2f  e5 7d a3 47 cd 62 43 15  |&.$... /.}.G.bC.|
+00000100  28 da ac 5f bb 29 07 30  ff f6 84 af c4 cf c2 ed  |(.._.).0........|
+00000110  90 99 5f 58 cb 3b 74                              |.._X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 66 02 00 00  62 03 03 2d b3 e1 a8 44  |....f...b..-...D|
-00000010  c6 3e 20 b9 50 49 ab b8  48 c3 bf d6 f3 7b 2e 0a  |.> .PI..H....{..|
-00000020  8c 49 ba e5 8e 54 5e 02  59 01 75 20 f0 a0 60 c2  |.I...T^.Y.u ..`.|
-00000030  81 df 62 f9 f8 7d 3c 3c  ee 1e 0c 1d c2 11 58 7f  |..b..}<<......X.|
-00000040  e0 dc b1 6c 17 9e 19 60  ca c2 40 84 cc a8 00 00  |...l...`..@.....|
-00000050  1a ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 10  |................|
-00000060  00 09 00 07 06 70 72 6f  74 6f 31 16 03 03 02 59  |.....proto1....Y|
-00000070  0b 00 02 55 00 02 52 00  02 4f 30 82 02 4b 30 82  |...U..R..O0..K0.|
-00000080  01 b4 a0 03 02 01 02 02  09 00 e8 f0 9d 3f e2 5b  |.............?.[|
-00000090  ea a6 30 0d 06 09 2a 86  48 86 f7 0d 01 01 0b 05  |..0...*.H.......|
-000000a0  00 30 1f 31 0b 30 09 06  03 55 04 0a 13 02 47 6f  |.0.1.0...U....Go|
-000000b0  31 10 30 0e 06 03 55 04  03 13 07 47 6f 20 52 6f  |1.0...U....Go Ro|
-000000c0  6f 74 30 1e 17 0d 31 36  30 31 30 31 30 30 30 30  |ot0...1601010000|
-000000d0  30 30 5a 17 0d 32 35 30  31 30 31 30 30 30 30 30  |00Z..25010100000|
-000000e0  30 5a 30 1a 31 0b 30 09  06 03 55 04 0a 13 02 47  |0Z0.1.0...U....G|
-000000f0  6f 31 0b 30 09 06 03 55  04 03 13 02 47 6f 30 81  |o1.0...U....Go0.|
-00000100  9f 30 0d 06 09 2a 86 48  86 f7 0d 01 01 01 05 00  |.0...*.H........|
-00000110  03 81 8d 00 30 81 89 02  81 81 00 db 46 7d 93 2e  |....0.......F}..|
-00000120  12 27 06 48 bc 06 28 21  ab 7e c4 b6 a2 5d fe 1e  |.'.H..(!.~...]..|
-00000130  52 45 88 7a 36 47 a5 08  0d 92 42 5b c2 81 c0 be  |RE.z6G....B[....|
-00000140  97 79 98 40 fb 4f 6d 14  fd 2b 13 8b c2 a5 2e 67  |.y.@.Om..+.....g|
-00000150  d8 d4 09 9e d6 22 38 b7  4a 0b 74 73 2b c2 34 f1  |....."8.J.ts+.4.|
-00000160  d1 93 e5 96 d9 74 7b f3  58 9f 6c 61 3c c0 b0 41  |.....t{.X.la<..A|
-00000170  d4 d9 2b 2b 24 23 77 5b  1c 3b bd 75 5d ce 20 54  |..++$#w[.;.u]. T|
-00000180  cf a1 63 87 1d 1e 24 c4  f3 1d 1a 50 8b aa b6 14  |..c...$....P....|
-00000190  43 ed 97 a7 75 62 f4 14  c8 52 d7 02 03 01 00 01  |C...ub...R......|
-000001a0  a3 81 93 30 81 90 30 0e  06 03 55 1d 0f 01 01 ff  |...0..0...U.....|
-000001b0  04 04 03 02 05 a0 30 1d  06 03 55 1d 25 04 16 30  |......0...U.%..0|
-000001c0  14 06 08 2b 06 01 05 05  07 03 01 06 08 2b 06 01  |...+.........+..|
-000001d0  05 05 07 03 02 30 0c 06  03 55 1d 13 01 01 ff 04  |.....0...U......|
-000001e0  02 30 00 30 19 06 03 55  1d 0e 04 12 04 10 9f 91  |.0.0...U........|
-000001f0  16 1f 43 43 3e 49 a6 de  6d b6 80 d7 9f 60 30 1b  |..CC>I..m....`0.|
-00000200  06 03 55 1d 23 04 14 30  12 80 10 48 13 49 4d 13  |..U.#..0...H.IM.|
-00000210  7e 16 31 bb a3 01 d5 ac  ab 6e 7b 30 19 06 03 55  |~.1......n{0...U|
-00000220  1d 11 04 12 30 10 82 0e  65 78 61 6d 70 6c 65 2e  |....0...example.|
-00000230  67 6f 6c 61 6e 67 30 0d  06 09 2a 86 48 86 f7 0d  |golang0...*.H...|
-00000240  01 01 0b 05 00 03 81 81  00 9d 30 cc 40 2b 5b 50  |..........0.@+[P|
-00000250  a0 61 cb ba e5 53 58 e1  ed 83 28 a9 58 1a a9 38  |.a...SX...(.X..8|
-00000260  a4 95 a1 ac 31 5a 1a 84  66 3d 43 d3 2d d9 0b f2  |....1Z..f=C.-...|
-00000270  97 df d3 20 64 38 92 24  3a 00 bc cf 9c 7d b7 40  |... d8.$:....}.@|
-00000280  20 01 5f aa d3 16 61 09  a2 76 fd 13 c3 cc e1 0c  | ._...a..v......|
-00000290  5c ee b1 87 82 f1 6c 04  ed 73 bb b3 43 77 8d 0c  |\.....l..s..Cw..|
-000002a0  1c f1 0f a1 d8 40 83 61  c9 4c 72 2b 9d ae db 46  |.....@.a.Lr+...F|
-000002b0  06 06 4d f4 c1 b3 3e c0  d1 bd 42 d4 db fe 3d 13  |..M...>...B...=.|
-000002c0  60 84 5c 21 d3 3b e9 fa  e7 16 03 03 00 ac 0c 00  |`.\!.;..........|
-000002d0  00 a8 03 00 1d 20 7b 47  ec ef 4d 39 ec 65 b9 7c  |..... {G..M9.e.||
-000002e0  08 da b5 41 0d 62 0b 52  29 24 25 3d 39 21 ed d3  |...A.b.R)$%=9!..|
-000002f0  30 37 0c 15 66 49 08 04  00 80 4b 01 8e 80 78 ed  |07..fI....K...x.|
-00000300  d1 44 e5 98 a4 43 9a 73  b7 dc 67 72 83 29 f3 e3  |.D...C.s..gr.)..|
-00000310  5b 72 ee d6 36 12 db bf  ab d6 86 fd a8 54 a5 a0  |[r..6........T..|
-00000320  0e 76 ca ea a7 f5 f2 e1  87 94 a7 c5 d8 69 b7 58  |.v...........i.X|
-00000330  d2 f0 10 08 8c 08 ac bd  aa 60 f5 45 20 15 77 71  |.........`.E .wq|
-00000340  5a bb 2a 8b 0a 4b a3 08  71 88 82 01 3c bc 54 ba  |Z.*..K..q...<.T.|
-00000350  f4 42 7a 08 64 d7 57 5b  dc ea 6a 72 e1 7d ca 96  |.Bz.d.W[..jr.}..|
-00000360  d9 89 eb 60 9e d2 a4 f5  cb d5 45 d1 4d 09 4e 18  |...`......E.M.N.|
-00000370  a2 4f 0f 59 97 a1 5f 7f  65 4f 16 03 03 00 04 0e  |.O.Y.._.eO......|
-00000380  00 00 00                                          |...|
+00000000  16 03 03 00 6a 02 00 00  66 03 03 a8 8a 7d 2c f6  |....j...f....},.|
+00000010  d0 44 0a 7b 16 26 e5 aa  6e 4b 78 7c ff 7f 07 86  |.D.{.&..nKx|....|
+00000020  48 cc 3a dd 73 95 94 d2  75 d8 87 20 6d 0b 3a a3  |H.:.s...u.. m.:.|
+00000030  71 b9 50 4e c7 ad 33 04  8a 9c d8 71 48 93 ec ae  |q.PN..3....qH...|
+00000040  db ad 5f 79 d5 7c 65 33  37 06 73 0e cc a8 00 00  |.._y.|e37.s.....|
+00000050  1e ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 10  |................|
+00000060  00 09 00 07 06 70 72 6f  74 6f 31 00 17 00 00 16  |.....proto1.....|
+00000070  03 03 02 59 0b 00 02 55  00 02 52 00 02 4f 30 82  |...Y...U..R..O0.|
+00000080  02 4b 30 82 01 b4 a0 03  02 01 02 02 09 00 e8 f0  |.K0.............|
+00000090  9d 3f e2 5b ea a6 30 0d  06 09 2a 86 48 86 f7 0d  |.?.[..0...*.H...|
+000000a0  01 01 0b 05 00 30 1f 31  0b 30 09 06 03 55 04 0a  |.....0.1.0...U..|
+000000b0  13 02 47 6f 31 10 30 0e  06 03 55 04 03 13 07 47  |..Go1.0...U....G|
+000000c0  6f 20 52 6f 6f 74 30 1e  17 0d 31 36 30 31 30 31  |o Root0...160101|
+000000d0  30 30 30 30 30 30 5a 17  0d 32 35 30 31 30 31 30  |000000Z..2501010|
+000000e0  30 30 30 30 30 5a 30 1a  31 0b 30 09 06 03 55 04  |00000Z0.1.0...U.|
+000000f0  0a 13 02 47 6f 31 0b 30  09 06 03 55 04 03 13 02  |...Go1.0...U....|
+00000100  47 6f 30 81 9f 30 0d 06  09 2a 86 48 86 f7 0d 01  |Go0..0...*.H....|
+00000110  01 01 05 00 03 81 8d 00  30 81 89 02 81 81 00 db  |........0.......|
+00000120  46 7d 93 2e 12 27 06 48  bc 06 28 21 ab 7e c4 b6  |F}...'.H..(!.~..|
+00000130  a2 5d fe 1e 52 45 88 7a  36 47 a5 08 0d 92 42 5b  |.]..RE.z6G....B[|
+00000140  c2 81 c0 be 97 79 98 40  fb 4f 6d 14 fd 2b 13 8b  |.....y.@.Om..+..|
+00000150  c2 a5 2e 67 d8 d4 09 9e  d6 22 38 b7 4a 0b 74 73  |...g....."8.J.ts|
+00000160  2b c2 34 f1 d1 93 e5 96  d9 74 7b f3 58 9f 6c 61  |+.4......t{.X.la|
+00000170  3c c0 b0 41 d4 d9 2b 2b  24 23 77 5b 1c 3b bd 75  |<..A..++$#w[.;.u|
+00000180  5d ce 20 54 cf a1 63 87  1d 1e 24 c4 f3 1d 1a 50  |]. T..c...$....P|
+00000190  8b aa b6 14 43 ed 97 a7  75 62 f4 14 c8 52 d7 02  |....C...ub...R..|
+000001a0  03 01 00 01 a3 81 93 30  81 90 30 0e 06 03 55 1d  |.......0..0...U.|
+000001b0  0f 01 01 ff 04 04 03 02  05 a0 30 1d 06 03 55 1d  |..........0...U.|
+000001c0  25 04 16 30 14 06 08 2b  06 01 05 05 07 03 01 06  |%..0...+........|
+000001d0  08 2b 06 01 05 05 07 03  02 30 0c 06 03 55 1d 13  |.+.......0...U..|
+000001e0  01 01 ff 04 02 30 00 30  19 06 03 55 1d 0e 04 12  |.....0.0...U....|
+000001f0  04 10 9f 91 16 1f 43 43  3e 49 a6 de 6d b6 80 d7  |......CC>I..m...|
+00000200  9f 60 30 1b 06 03 55 1d  23 04 14 30 12 80 10 48  |.`0...U.#..0...H|
+00000210  13 49 4d 13 7e 16 31 bb  a3 01 d5 ac ab 6e 7b 30  |.IM.~.1......n{0|
+00000220  19 06 03 55 1d 11 04 12  30 10 82 0e 65 78 61 6d  |...U....0...exam|
+00000230  70 6c 65 2e 67 6f 6c 61  6e 67 30 0d 06 09 2a 86  |ple.golang0...*.|
+00000240  48 86 f7 0d 01 01 0b 05  00 03 81 81 00 9d 30 cc  |H.............0.|
+00000250  40 2b 5b 50 a0 61 cb ba  e5 53 58 e1 ed 83 28 a9  |@+[P.a...SX...(.|
+00000260  58 1a a9 38 a4 95 a1 ac  31 5a 1a 84 66 3d 43 d3  |X..8....1Z..f=C.|
+00000270  2d d9 0b f2 97 df d3 20  64 38 92 24 3a 00 bc cf  |-...... d8.$:...|
+00000280  9c 7d b7 40 20 01 5f aa  d3 16 61 09 a2 76 fd 13  |.}.@ ._...a..v..|
+00000290  c3 cc e1 0c 5c ee b1 87  82 f1 6c 04 ed 73 bb b3  |....\.....l..s..|
+000002a0  43 77 8d 0c 1c f1 0f a1  d8 40 83 61 c9 4c 72 2b  |Cw.......@.a.Lr+|
+000002b0  9d ae db 46 06 06 4d f4  c1 b3 3e c0 d1 bd 42 d4  |...F..M...>...B.|
+000002c0  db fe 3d 13 60 84 5c 21  d3 3b e9 fa e7 16 03 03  |..=.`.\!.;......|
+000002d0  00 ac 0c 00 00 a8 03 00  1d 20 fe 7c 30 da b3 7e  |......... .|0..~|
+000002e0  b9 f5 74 9f c2 5a 3b 2e  a4 c4 fe 98 50 1d 14 ea  |..t..Z;.....P...|
+000002f0  31 f0 ff d9 90 88 42 77  f6 18 08 04 00 80 70 97  |1.....Bw......p.|
+00000300  1d e4 fb 40 de b5 9a cc  6a 63 63 86 b4 91 55 c4  |...@....jcc...U.|
+00000310  ad b7 2f a2 8f 4f 28 22  86 df ec 2f 7c d2 83 b7  |../..O(".../|...|
+00000320  28 9c 22 e7 73 74 51 f0  1e 20 50 d5 f1 3c 15 65  |(.".stQ.. P..<.e|
+00000330  d9 cb 7f 4e 82 11 41 f8  c6 2a 23 ed b5 b4 cf 2d  |...N..A..*#....-|
+00000340  02 e2 8e 8b e8 88 bb 8c  63 1e 9c 37 44 c3 89 cf  |........c..7D...|
+00000350  ea 68 4b 81 73 0e 57 82  c9 dc ab f3 0c 63 ce f6  |.hK.s.W......c..|
+00000360  c3 3a a3 da df be a7 10  4a 27 e1 bd b3 88 47 a2  |.:......J'....G.|
+00000370  0d 02 03 17 3c 6c 7f 6e  04 26 75 1c a0 3e 16 03  |....<l.n.&u..>..|
+00000380  03 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 b9 f7 58  6f d3 29 b8 41 35 06 b7  |.... ..Xo.).A5..|
-00000040  55 85 c1 f0 63 fe 4f 5f  87 01 cc 67 0b f1 4c b4  |U...c.O_...g..L.|
-00000050  ca 92 bd c0 6d                                    |....m|
+00000030  16 03 03 00 20 a0 68 d5  5a 22 13 42 16 b2 13 f4  |.... .h.Z".B....|
+00000040  99 a1 5c f7 38 22 a1 8b  e0 6b c2 7e f9 e5 a0 ef  |..\.8"...k.~....|
+00000050  79 ce 5a 74 d1                                    |y.Zt.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 68 92 93 84 bd  |.......... h....|
-00000010  0e de 33 1b db ca 54 b8  a0 2f 53 c5 76 de d2 c5  |..3...T../S.v...|
-00000020  7a 54 bb db 0c 08 86 79  d2 6c 58                 |zT.....y.lX|
+00000000  14 03 03 00 01 01 16 03  03 00 20 dd a3 ff 04 65  |.......... ....e|
+00000010  4b 49 77 b6 88 ab f3 31  07 3d 2e 30 ec b3 e1 1f  |KIw....1.=.0....|
+00000020  18 0f ef a9 2d 32 1f e6  b9 71 3f                 |....-2...q?|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 79 38 07  9b be 83 44 9a 3e 11 1a  |.....y8....D.>..|
-00000010  99 2f f2 4e 33 84 0b c7  8e ed c3 15 03 03 00 12  |./.N3...........|
-00000020  ca bd 7e 59 04 8c e0 52  80 1e 56 1e af c1 5f 61  |..~Y...R..V..._a|
-00000030  6c 6a                                             |lj|
+00000000  17 03 03 00 16 54 7a 06  57 6b 66 e0 93 f8 f5 7a  |.....Tz.Wkf....z|
+00000010  ab 1a d1 f4 53 91 47 e8  5c 11 15 15 03 03 00 12  |....S.G.\.......|
+00000020  42 b6 c5 6f 63 b6 72 8b  85 c3 ba c5 e3 38 8f e2  |B..oc.r......8..|
+00000030  42 dd                                             |B.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA
index 4b5a4ca22e..4b40e44a5e 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,71 +7,72 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 8f fe 05 df f3  |....Y...U.......|
-00000010  02 70 ec 72 c4 3d 1e 52  c3 63 b8 1d dc e0 36 72  |.p.r.=.R.c....6r|
-00000020  8b 04 94 a5 45 fb 97 a5  0b e1 a7 20 9d fb e5 2b  |....E...... ...+|
-00000030  77 d7 1b da e8 d7 3e fe  c5 8f 4e b6 5a 40 29 02  |w.....>...N.Z@).|
-00000040  fd 08 46 4e 27 24 53 e1  de 88 8a 77 c0 09 00 00  |..FN'$S....w....|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
-00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
-00000080  30 09 06 07 2a 86 48 ce  3d 04 01 30 45 31 0b 30  |0...*.H.=..0E1.0|
-00000090  09 06 03 55 04 06 13 02  41 55 31 13 30 11 06 03  |...U....AU1.0...|
-000000a0  55 04 08 13 0a 53 6f 6d  65 2d 53 74 61 74 65 31  |U....Some-State1|
-000000b0  21 30 1f 06 03 55 04 0a  13 18 49 6e 74 65 72 6e  |!0...U....Intern|
-000000c0  65 74 20 57 69 64 67 69  74 73 20 50 74 79 20 4c  |et Widgits Pty L|
-000000d0  74 64 30 1e 17 0d 31 32  31 31 32 32 31 35 30 36  |td0...1211221506|
-000000e0  33 32 5a 17 0d 32 32 31  31 32 30 31 35 30 36 33  |32Z..22112015063|
-000000f0  32 5a 30 45 31 0b 30 09  06 03 55 04 06 13 02 41  |2Z0E1.0...U....A|
-00000100  55 31 13 30 11 06 03 55  04 08 13 0a 53 6f 6d 65  |U1.0...U....Some|
-00000110  2d 53 74 61 74 65 31 21  30 1f 06 03 55 04 0a 13  |-State1!0...U...|
-00000120  18 49 6e 74 65 72 6e 65  74 20 57 69 64 67 69 74  |.Internet Widgit|
-00000130  73 20 50 74 79 20 4c 74  64 30 81 9b 30 10 06 07  |s Pty Ltd0..0...|
-00000140  2a 86 48 ce 3d 02 01 06  05 2b 81 04 00 23 03 81  |*.H.=....+...#..|
-00000150  86 00 04 00 c4 a1 ed be  98 f9 0b 48 73 36 7e c3  |...........Hs6~.|
-00000160  16 56 11 22 f2 3d 53 c3  3b 4d 21 3d cd 6b 75 e6  |.V.".=S.;M!=.ku.|
-00000170  f6 b0 dc 9a df 26 c1 bc  b2 87 f0 72 32 7c b3 64  |.....&.....r2|.d|
-00000180  2f 1c 90 bc ea 68 23 10  7e fe e3 25 c0 48 3a 69  |/....h#.~..%.H:i|
-00000190  e0 28 6d d3 37 00 ef 04  62 dd 0d a0 9c 70 62 83  |.(m.7...b....pb.|
-000001a0  d8 81 d3 64 31 aa 9e 97  31 bd 96 b0 68 c0 9b 23  |...d1...1...h..#|
-000001b0  de 76 64 3f 1a 5c 7f e9  12 0e 58 58 b6 5f 70 dd  |.vd?.\....XX._p.|
-000001c0  9b d8 ea d5 d7 f5 d5 cc  b9 b6 9f 30 66 5b 66 9a  |...........0f[f.|
-000001d0  20 e2 27 e5 bf fe 3b 30  09 06 07 2a 86 48 ce 3d  | .'...;0...*.H.=|
-000001e0  04 01 03 81 8c 00 30 81  88 02 42 01 88 a2 4f eb  |......0...B...O.|
-000001f0  e2 45 c5 48 7d 1b ac f5  ed 98 9d ae 47 70 c0 5e  |.E.H}.......Gp.^|
-00000200  1b b6 2f bd f1 b6 4d b7  61 40 d3 11 a2 ce ee 0b  |../...M.a@......|
-00000210  7e 92 7e ff 76 9d c3 3b  7e a5 3f ce fa 10 e2 59  |~.~.v..;~.?....Y|
-00000220  ec 47 2d 7c ac da 4e 97  0e 15 a0 6f d0 02 42 01  |.G-|..N....o..B.|
-00000230  4d fc be 67 13 9c 2d 05  0e bd 3f a3 8c 25 c1 33  |M..g..-...?..%.3|
-00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
-00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
-00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 b7 0c 00  00 b3 03 00 1d 20 82 a8  |*............ ..|
-00000280  4b 0e 10 e1 2b a2 f6 9d  11 0a 4d 0b c0 2f 12 85  |K...+.....M../..|
-00000290  bc f3 e9 9f b4 50 50 fa  b1 a9 fd 35 d1 39 04 03  |.....PP....5.9..|
-000002a0  00 8b 30 81 88 02 42 01  b1 cb c7 7a 83 6a 95 5b  |..0...B....z.j.[|
-000002b0  09 4c 59 d6 9a 6b 9d 0c  e9 f5 22 1c 46 76 5b 4e  |.LY..k....".Fv[N|
-000002c0  3c 4a ac 81 b7 96 29 7c  e2 e8 08 e7 5f be 9d dc  |<J....)|...._...|
-000002d0  8d 9e 1d a1 84 4c 18 1a  8a 2d bd 97 de 26 70 14  |.....L...-...&p.|
-000002e0  11 74 49 4b e9 2e 59 30  9c 02 42 00 b5 9e 89 32  |.tIK..Y0..B....2|
-000002f0  45 02 71 19 6e 83 fc 26  26 b4 28 08 6a 7d d3 72  |E.q.n..&&.(.j}.r|
-00000300  4e ed 82 68 2f ad ff 39  5a ce 34 b8 e4 39 f2 f1  |N..h/..9Z.4..9..|
-00000310  60 5d 84 c4 da 4d 5a 33  f8 20 5a f2 7f aa 7e 18  |`]...MZ3. Z...~.|
-00000320  14 14 2a 68 a8 9d dd d0  ec e3 00 87 49 16 03 03  |..*h........I...|
-00000330  00 3a 0d 00 00 36 03 01  02 40 00 2e 04 03 05 03  |.:...6...@......|
-00000340  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
-00000350  08 06 04 01 05 01 06 01  03 03 02 03 03 01 02 01  |................|
-00000360  03 02 02 02 04 02 05 02  06 02 00 00 16 03 03 00  |................|
-00000370  04 0e 00 00 00                                    |.....|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 7c 3c 83 43 cf  |....]...Y..|<.C.|
+00000010  60 91 0b 04 73 55 30 be  25 6b 41 c9 4c 67 5b 91  |`...sU0.%kA.Lg[.|
+00000020  af 04 b5 34 c7 61 c7 d3  62 2e ca 20 88 47 3a 15  |...4.a..b.. .G:.|
+00000030  b4 8d 3f eb a6 b3 fd ae  a4 e9 d9 db 5b 59 3b 1c  |..?.........[Y;.|
+00000040  e6 47 e3 98 74 da 32 04  32 b0 57 81 c0 09 00 00  |.G..t.2.2.W.....|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 03 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
+00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
+00000080  a0 d2 eb f4 30 09 06 07  2a 86 48 ce 3d 04 01 30  |....0...*.H.=..0|
+00000090  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+000000a0  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+000000b0  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+000000c0  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+000000d0  74 79 20 4c 74 64 30 1e  17 0d 31 32 31 31 32 32  |ty Ltd0...121122|
+000000e0  31 35 30 36 33 32 5a 17  0d 32 32 31 31 32 30 31  |150632Z..2211201|
+000000f0  35 30 36 33 32 5a 30 45  31 0b 30 09 06 03 55 04  |50632Z0E1.0...U.|
+00000100  06 13 02 41 55 31 13 30  11 06 03 55 04 08 13 0a  |...AU1.0...U....|
+00000110  53 6f 6d 65 2d 53 74 61  74 65 31 21 30 1f 06 03  |Some-State1!0...|
+00000120  55 04 0a 13 18 49 6e 74  65 72 6e 65 74 20 57 69  |U....Internet Wi|
+00000130  64 67 69 74 73 20 50 74  79 20 4c 74 64 30 81 9b  |dgits Pty Ltd0..|
+00000140  30 10 06 07 2a 86 48 ce  3d 02 01 06 05 2b 81 04  |0...*.H.=....+..|
+00000150  00 23 03 81 86 00 04 00  c4 a1 ed be 98 f9 0b 48  |.#.............H|
+00000160  73 36 7e c3 16 56 11 22  f2 3d 53 c3 3b 4d 21 3d  |s6~..V.".=S.;M!=|
+00000170  cd 6b 75 e6 f6 b0 dc 9a  df 26 c1 bc b2 87 f0 72  |.ku......&.....r|
+00000180  32 7c b3 64 2f 1c 90 bc  ea 68 23 10 7e fe e3 25  |2|.d/....h#.~..%|
+00000190  c0 48 3a 69 e0 28 6d d3  37 00 ef 04 62 dd 0d a0  |.H:i.(m.7...b...|
+000001a0  9c 70 62 83 d8 81 d3 64  31 aa 9e 97 31 bd 96 b0  |.pb....d1...1...|
+000001b0  68 c0 9b 23 de 76 64 3f  1a 5c 7f e9 12 0e 58 58  |h..#.vd?.\....XX|
+000001c0  b6 5f 70 dd 9b d8 ea d5  d7 f5 d5 cc b9 b6 9f 30  |._p............0|
+000001d0  66 5b 66 9a 20 e2 27 e5  bf fe 3b 30 09 06 07 2a  |f[f. .'...;0...*|
+000001e0  86 48 ce 3d 04 01 03 81  8c 00 30 81 88 02 42 01  |.H.=......0...B.|
+000001f0  88 a2 4f eb e2 45 c5 48  7d 1b ac f5 ed 98 9d ae  |..O..E.H}.......|
+00000200  47 70 c0 5e 1b b6 2f bd  f1 b6 4d b7 61 40 d3 11  |Gp.^../...M.a@..|
+00000210  a2 ce ee 0b 7e 92 7e ff  76 9d c3 3b 7e a5 3f ce  |....~.~.v..;~.?.|
+00000220  fa 10 e2 59 ec 47 2d 7c  ac da 4e 97 0e 15 a0 6f  |...Y.G-|..N....o|
+00000230  d0 02 42 01 4d fc be 67  13 9c 2d 05 0e bd 3f a3  |..B.M..g..-...?.|
+00000240  8c 25 c1 33 13 83 0d 94  06 bb d4 37 7a f6 ec 7a  |.%.3.......7z..z|
+00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
+00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
+00000270  95 12 07 8f 2a 16 03 03  00 b6 0c 00 00 b2 03 00  |....*...........|
+00000280  1d 20 b5 f3 76 c4 a9 33  34 2a 38 16 b1 38 f5 a1  |. ..v..34*8..8..|
+00000290  dc f7 60 67 32 cf 6b aa  82 0c b5 db 31 c4 b4 36  |..`g2.k.....1..6|
+000002a0  3e 16 04 03 00 8a 30 81  87 02 41 34 fc 19 0c 94  |>.....0...A4....|
+000002b0  d7 c3 9d ed ae 75 7a 20  b5 b0 93 69 85 8e 4b 20  |.....uz ...i..K |
+000002c0  27 03 83 12 12 8d d5 e4  cc 06 95 a7 dc 7c b2 dc  |'............|..|
+000002d0  71 6e 8c 18 89 4b fe 14  41 59 f7 af c8 1f d4 b8  |qn...K..AY......|
+000002e0  7b c4 1f cb 75 53 04 29  87 df 92 37 02 42 01 e7  |{...uS.)...7.B..|
+000002f0  c3 86 70 fa 8e 5e 21 16  52 0e 87 65 4a 69 aa ae  |..p..^!.R..eJi..|
+00000300  4c 4f 1e b5 91 17 24 b9  7d 18 7e 0f d0 db a5 33  |LO....$.}.~....3|
+00000310  19 7d 98 7b 5e 15 23 d2  8c 52 8d 17 56 08 60 d6  |.}.{^.#..R..V.`.|
+00000320  7c 2c 19 11 e1 d7 37 a7  b0 68 7b df 8c ae 3d 3e  ||,....7..h{...=>|
+00000330  16 03 03 00 3a 0d 00 00  36 03 01 02 40 00 2e 04  |....:...6...@...|
+00000340  03 05 03 06 03 08 07 08  08 08 09 08 0a 08 0b 08  |................|
+00000350  04 08 05 08 06 04 01 05  01 06 01 03 03 02 03 03  |................|
+00000360  01 02 01 03 02 02 02 04  02 05 02 06 02 00 00 16  |................|
+00000370  03 03 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 02 0a 0b 00 02  06 00 02 03 00 02 00 30  |...............0|
 00000010  82 01 fc 30 82 01 5e 02  09 00 9a 30 84 6c 26 35  |...0..^....0.l&5|
@@ -108,32 +109,32 @@
 00000200  e4 fa cc b1 8a ce e2 23  a0 87 f0 e1 67 51 eb 16  |.......#....gQ..|
 00000210  03 03 00 25 10 00 00 21  20 2f e5 7d a3 47 cd 62  |...%...! /.}.G.b|
 00000220  43 15 28 da ac 5f bb 29  07 30 ff f6 84 af c4 cf  |C.(.._.).0......|
-00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 03 00 93 0f 00  |...._X.;t.......|
-00000240  00 8f 04 03 00 8b 30 81  88 02 42 01 cd 6b 44 a0  |......0...B..kD.|
-00000250  80 3b f5 5d f0 99 24 dd  89 94 b9 96 34 e7 04 e7  |.;.]..$.....4...|
-00000260  38 72 64 36 5a e9 ac bc  e3 54 1b 75 69 e2 de 03  |8rd6Z....T.ui...|
-00000270  ce a9 2c 76 92 dd 6b 31  0a 93 10 57 69 8b e0 cf  |..,v..k1...Wi...|
-00000280  7d 75 e4 e1 a9 d2 d3 29  b6 a7 ff 86 d4 02 42 01  |}u.....)......B.|
-00000290  e4 d9 31 56 23 62 e6 c2  2d 57 8a 6f d3 3f 1f 4d  |..1V#b..-W.o.?.M|
-000002a0  ca 0e c0 60 53 55 1f fb  56 24 22 82 c0 fe d9 0b  |...`SU..V$".....|
-000002b0  9b de fb f2 d4 a6 e4 98  9f 2c 07 07 01 83 ab 93  |.........,......|
-000002c0  3e c6 02 41 e9 8b 8d 95  eb cf b9 0f b5 fb 2c 9f  |>..A..........,.|
-000002d0  90 14 03 03 00 01 01 16  03 03 00 40 00 00 00 00  |...........@....|
-000002e0  00 00 00 00 00 00 00 00  00 00 00 00 aa 12 12 09  |................|
-000002f0  c5 08 94 28 8d 59 f3 68  cc 02 69 47 fa cf 9c 81  |...(.Y.h..iG....|
-00000300  a6 a5 b5 c7 e7 26 45 4a  59 67 ca 0a ed 6c 58 38  |.....&EJYg...lX8|
-00000310  23 12 48 a9 3c 0c 26 00  78 58 db 21              |#.H.<.&.xX.!|
+00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 03 00 92 0f 00  |...._X.;t.......|
+00000240  00 8e 04 03 00 8a 30 81  87 02 42 00 92 a9 5e 4b  |......0...B...^K|
+00000250  9d ee cc 03 2e 34 e8 5b  bd 7b 11 5a 25 00 80 a6  |.....4.[.{.Z%...|
+00000260  83 44 79 07 06 0d ba 0f  76 4d e9 40 50 52 9a c3  |.Dy.....vM.@PR..|
+00000270  24 43 e4 2a 2c 29 d8 da  78 af a4 ad b1 db 0f e6  |$C.*,)..x.......|
+00000280  29 a8 be ec d5 c9 79 4e  dc e6 6b 39 77 02 41 45  |).....yN..k9w.AE|
+00000290  be 07 99 32 88 da 0b 8c  33 48 91 78 2e 23 03 9a  |...2....3H.x.#..|
+000002a0  6a 92 b3 4c 82 c0 fd cf  0f 08 b5 19 f6 6d 21 95  |j..L.........m!.|
+000002b0  32 7a bc 6f 4b a8 01 b2  e2 a3 48 6c d0 ec 77 1c  |2z.oK.....Hl..w.|
+000002c0  30 83 f4 6c 12 a7 50 ea  de a3 6e 47 59 cc 0d 35  |0..l..P...nGY..5|
+000002d0  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
+000002e0  00 00 00 00 00 00 00 00  00 00 00 65 d3 93 a7 5f  |...........e..._|
+000002f0  ff 8c 1e 8f e5 9b 61 fe  df ac b6 9d e3 68 31 f8  |......a......h1.|
+00000300  2b d0 70 32 2a 07 13 fe  34 5d a2 ab 35 f1 4c 81  |+.p2*...4]..5.L.|
+00000310  28 34 50 0d 21 bc 4a a9  2d 90 c4                 |(4P.!.J.-..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 5a 63 b1 0f 47  |..........@Zc..G|
-00000010  76 ac c4 69 62 82 63 77  8b 26 7b a9 8a 7d 3d fe  |v..ib.cw.&{..}=.|
-00000020  4a 04 b4 80 17 cc be 5e  9e b2 5d a3 2d 48 85 44  |J......^..].-H.D|
-00000030  7d db 62 77 31 27 18 b1  55 61 b3 64 6c d6 39 f7  |}.bw1'..Ua.dl.9.|
-00000040  f2 fe 7c 73 c8 3f 31 c9  78 83 8c                 |..|s.?1.x..|
+00000000  14 03 03 00 01 01 16 03  03 00 40 49 93 f4 1d 25  |..........@I...%|
+00000010  62 e3 5d 46 a2 ae 3d d2  4c 35 a9 06 f0 e1 ca d7  |b.]F..=.L5......|
+00000020  43 c1 96 27 96 ce d1 f6  d5 07 cc ec 6a 4a 96 c6  |C..'........jJ..|
+00000030  1f 89 14 ff 15 6f 79 bc  90 3e fd 63 ed 21 69 95  |.....oy..>.c.!i.|
+00000040  91 a1 08 4a 7e e6 f0 5d  e6 ae b6                 |...J~..]...|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 b9 a3 b6  37 76 c9 69 20 8d 97 e3  |........7v.i ...|
-00000020  0d f1 6e d4 6d 79 0b 64  4f a5 0d 30 ff 1c cd 56  |..n.my.dO..0...V|
-00000030  e7 ce 69 a6 48 15 03 03  00 30 00 00 00 00 00 00  |..i.H....0......|
-00000040  00 00 00 00 00 00 00 00  00 00 c6 3c 3b f2 09 05  |...........<;...|
-00000050  2c 4d 07 4f 95 34 29 ec  ef 3b b5 31 c6 a4 91 5e  |,M.O.4)..;.1...^|
-00000060  14 20 5b c5 34 19 f9 1d  22 63                    |. [.4..."c|
+00000010  00 00 00 00 00 88 36 f6  a8 b4 e5 b6 58 ec 9b 08  |......6.....X...|
+00000020  6f bf 5a 7c f1 b5 81 b2  6b 93 f2 35 40 34 89 61  |o.Z|....k..5@4.a|
+00000030  a9 ef 6d fe 2c 15 03 03  00 30 00 00 00 00 00 00  |..m.,....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 97 6d 99 d3 e5 8b  |...........m....|
+00000050  54 93 b6 fd 3f ec 6e 03  03 4e 04 39 35 2c bb 10  |T...?.n..N.95,..|
+00000060  02 d0 8d 48 4e 56 1a e5  98 97                    |...HNV....|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA
index 36bddc2a93..b7323e548e 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-ECDSA-RSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,75 +7,76 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 b8 f6 b1 71 c5  |....Y...U.....q.|
-00000010  d0 3f 36 fb 8a b9 15 35  ae c5 08 8e eb c6 d5 ad  |.?6....5........|
-00000020  a1 8a ff 65 2e 78 f5 2a  2b cb f7 20 26 1e c1 94  |...e.x.*+.. &...|
-00000030  85 a9 b1 ca 8d 5f 3f 00  6a 44 c9 ed 28 36 97 f2  |....._?.jD..(6..|
-00000040  7d 38 0a 56 75 a2 12 ac  34 ed 7e 14 c0 2f 00 00  |}8.Vu...4.~../..|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
-00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
-00000080  3f e2 5b ea a6 30 0d 06  09 2a 86 48 86 f7 0d 01  |?.[..0...*.H....|
-00000090  01 0b 05 00 30 1f 31 0b  30 09 06 03 55 04 0a 13  |....0.1.0...U...|
-000000a0  02 47 6f 31 10 30 0e 06  03 55 04 03 13 07 47 6f  |.Go1.0...U....Go|
-000000b0  20 52 6f 6f 74 30 1e 17  0d 31 36 30 31 30 31 30  | Root0...1601010|
-000000c0  30 30 30 30 30 5a 17 0d  32 35 30 31 30 31 30 30  |00000Z..25010100|
-000000d0  30 30 30 30 5a 30 1a 31  0b 30 09 06 03 55 04 0a  |0000Z0.1.0...U..|
-000000e0  13 02 47 6f 31 0b 30 09  06 03 55 04 03 13 02 47  |..Go1.0...U....G|
-000000f0  6f 30 81 9f 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |o0..0...*.H.....|
-00000100  01 05 00 03 81 8d 00 30  81 89 02 81 81 00 db 46  |.......0.......F|
-00000110  7d 93 2e 12 27 06 48 bc  06 28 21 ab 7e c4 b6 a2  |}...'.H..(!.~...|
-00000120  5d fe 1e 52 45 88 7a 36  47 a5 08 0d 92 42 5b c2  |]..RE.z6G....B[.|
-00000130  81 c0 be 97 79 98 40 fb  4f 6d 14 fd 2b 13 8b c2  |....y.@.Om..+...|
-00000140  a5 2e 67 d8 d4 09 9e d6  22 38 b7 4a 0b 74 73 2b  |..g....."8.J.ts+|
-00000150  c2 34 f1 d1 93 e5 96 d9  74 7b f3 58 9f 6c 61 3c  |.4......t{.X.la<|
-00000160  c0 b0 41 d4 d9 2b 2b 24  23 77 5b 1c 3b bd 75 5d  |..A..++$#w[.;.u]|
-00000170  ce 20 54 cf a1 63 87 1d  1e 24 c4 f3 1d 1a 50 8b  |. T..c...$....P.|
-00000180  aa b6 14 43 ed 97 a7 75  62 f4 14 c8 52 d7 02 03  |...C...ub...R...|
-00000190  01 00 01 a3 81 93 30 81  90 30 0e 06 03 55 1d 0f  |......0..0...U..|
-000001a0  01 01 ff 04 04 03 02 05  a0 30 1d 06 03 55 1d 25  |.........0...U.%|
-000001b0  04 16 30 14 06 08 2b 06  01 05 05 07 03 01 06 08  |..0...+.........|
-000001c0  2b 06 01 05 05 07 03 02  30 0c 06 03 55 1d 13 01  |+.......0...U...|
-000001d0  01 ff 04 02 30 00 30 19  06 03 55 1d 0e 04 12 04  |....0.0...U.....|
-000001e0  10 9f 91 16 1f 43 43 3e  49 a6 de 6d b6 80 d7 9f  |.....CC>I..m....|
-000001f0  60 30 1b 06 03 55 1d 23  04 14 30 12 80 10 48 13  |`0...U.#..0...H.|
-00000200  49 4d 13 7e 16 31 bb a3  01 d5 ac ab 6e 7b 30 19  |IM.~.1......n{0.|
-00000210  06 03 55 1d 11 04 12 30  10 82 0e 65 78 61 6d 70  |..U....0...examp|
-00000220  6c 65 2e 67 6f 6c 61 6e  67 30 0d 06 09 2a 86 48  |le.golang0...*.H|
-00000230  86 f7 0d 01 01 0b 05 00  03 81 81 00 9d 30 cc 40  |.............0.@|
-00000240  2b 5b 50 a0 61 cb ba e5  53 58 e1 ed 83 28 a9 58  |+[P.a...SX...(.X|
-00000250  1a a9 38 a4 95 a1 ac 31  5a 1a 84 66 3d 43 d3 2d  |..8....1Z..f=C.-|
-00000260  d9 0b f2 97 df d3 20 64  38 92 24 3a 00 bc cf 9c  |...... d8.$:....|
-00000270  7d b7 40 20 01 5f aa d3  16 61 09 a2 76 fd 13 c3  |}.@ ._...a..v...|
-00000280  cc e1 0c 5c ee b1 87 82  f1 6c 04 ed 73 bb b3 43  |...\.....l..s..C|
-00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
-000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
-000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 9d 82 84 ba 8e 4b 7e  |........ .....K~|
-000002d0  bc f4 8e ab c1 31 68 42  cb 36 1d 64 60 55 74 11  |.....1hB.6.d`Ut.|
-000002e0  cf 63 d2 f4 c9 e7 a9 bf  7b 08 04 00 80 ce b2 06  |.c......{.......|
-000002f0  a3 54 1e fd f7 c4 a6 54  40 ea 74 8c e0 de ec aa  |.T.....T@.t.....|
-00000300  30 66 c3 e4 a9 7f 86 cc  f7 34 6b 55 a4 97 fd 6e  |0f.......4kU...n|
-00000310  3b 1f c4 e9 17 3c 6d 94  66 78 e0 1a ab 41 64 9b  |;....<m.fx...Ad.|
-00000320  2b 2e 14 99 96 68 aa ef  97 65 ea e7 72 28 9c 0f  |+....h...e..r(..|
-00000330  f9 11 57 b7 1f 31 54 87  1a 36 45 ec c1 0f 72 53  |..W..1T..6E...rS|
-00000340  56 a1 8d e4 d0 93 3e bb  77 8a 32 bd fb 07 0b ce  |V.....>.w.2.....|
-00000350  82 d3 a1 ab 6f 80 ac ac  4e da b7 7f 84 fe 3f 26  |....o...N.....?&|
-00000360  f4 d9 b9 b6 2b 68 1a cc  ef 31 97 22 bf 16 03 03  |....+h...1."....|
-00000370  00 3a 0d 00 00 36 03 01  02 40 00 2e 04 03 05 03  |.:...6...@......|
-00000380  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
-00000390  08 06 04 01 05 01 06 01  03 03 02 03 03 01 02 01  |................|
-000003a0  03 02 02 02 04 02 05 02  06 02 00 00 16 03 03 00  |................|
-000003b0  04 0e 00 00 00                                    |.....|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 75 bb 71 f8 35  |....]...Y..u.q.5|
+00000010  6c a2 b1 c8 b1 a1 dc 40  01 bc e7 0c 8c 22 90 2c  |l......@.....".,|
+00000020  aa 34 d3 d2 c8 b1 96 3b  bf 4a bf 20 b3 2a f7 96  |.4.....;.J. .*..|
+00000030  9d 79 53 4b 64 b2 80 4d  0e ab f8 3d cd 82 2d 78  |.ySKd..M...=..-x|
+00000040  47 8e cd 9b 14 8c 1e 6d  0e 52 7b db c0 2f 00 00  |G......m.R{../..|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
+00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
+00000080  00 e8 f0 9d 3f e2 5b ea  a6 30 0d 06 09 2a 86 48  |....?.[..0...*.H|
+00000090  86 f7 0d 01 01 0b 05 00  30 1f 31 0b 30 09 06 03  |........0.1.0...|
+000000a0  55 04 0a 13 02 47 6f 31  10 30 0e 06 03 55 04 03  |U....Go1.0...U..|
+000000b0  13 07 47 6f 20 52 6f 6f  74 30 1e 17 0d 31 36 30  |..Go Root0...160|
+000000c0  31 30 31 30 30 30 30 30  30 5a 17 0d 32 35 30 31  |101000000Z..2501|
+000000d0  30 31 30 30 30 30 30 30  5a 30 1a 31 0b 30 09 06  |01000000Z0.1.0..|
+000000e0  03 55 04 0a 13 02 47 6f  31 0b 30 09 06 03 55 04  |.U....Go1.0...U.|
+000000f0  03 13 02 47 6f 30 81 9f  30 0d 06 09 2a 86 48 86  |...Go0..0...*.H.|
+00000100  f7 0d 01 01 01 05 00 03  81 8d 00 30 81 89 02 81  |...........0....|
+00000110  81 00 db 46 7d 93 2e 12  27 06 48 bc 06 28 21 ab  |...F}...'.H..(!.|
+00000120  7e c4 b6 a2 5d fe 1e 52  45 88 7a 36 47 a5 08 0d  |~...]..RE.z6G...|
+00000130  92 42 5b c2 81 c0 be 97  79 98 40 fb 4f 6d 14 fd  |.B[.....y.@.Om..|
+00000140  2b 13 8b c2 a5 2e 67 d8  d4 09 9e d6 22 38 b7 4a  |+.....g....."8.J|
+00000150  0b 74 73 2b c2 34 f1 d1  93 e5 96 d9 74 7b f3 58  |.ts+.4......t{.X|
+00000160  9f 6c 61 3c c0 b0 41 d4  d9 2b 2b 24 23 77 5b 1c  |.la<..A..++$#w[.|
+00000170  3b bd 75 5d ce 20 54 cf  a1 63 87 1d 1e 24 c4 f3  |;.u]. T..c...$..|
+00000180  1d 1a 50 8b aa b6 14 43  ed 97 a7 75 62 f4 14 c8  |..P....C...ub...|
+00000190  52 d7 02 03 01 00 01 a3  81 93 30 81 90 30 0e 06  |R.........0..0..|
+000001a0  03 55 1d 0f 01 01 ff 04  04 03 02 05 a0 30 1d 06  |.U...........0..|
+000001b0  03 55 1d 25 04 16 30 14  06 08 2b 06 01 05 05 07  |.U.%..0...+.....|
+000001c0  03 01 06 08 2b 06 01 05  05 07 03 02 30 0c 06 03  |....+.......0...|
+000001d0  55 1d 13 01 01 ff 04 02  30 00 30 19 06 03 55 1d  |U.......0.0...U.|
+000001e0  0e 04 12 04 10 9f 91 16  1f 43 43 3e 49 a6 de 6d  |.........CC>I..m|
+000001f0  b6 80 d7 9f 60 30 1b 06  03 55 1d 23 04 14 30 12  |....`0...U.#..0.|
+00000200  80 10 48 13 49 4d 13 7e  16 31 bb a3 01 d5 ac ab  |..H.IM.~.1......|
+00000210  6e 7b 30 19 06 03 55 1d  11 04 12 30 10 82 0e 65  |n{0...U....0...e|
+00000220  78 61 6d 70 6c 65 2e 67  6f 6c 61 6e 67 30 0d 06  |xample.golang0..|
+00000230  09 2a 86 48 86 f7 0d 01  01 0b 05 00 03 81 81 00  |.*.H............|
+00000240  9d 30 cc 40 2b 5b 50 a0  61 cb ba e5 53 58 e1 ed  |.0.@+[P.a...SX..|
+00000250  83 28 a9 58 1a a9 38 a4  95 a1 ac 31 5a 1a 84 66  |.(.X..8....1Z..f|
+00000260  3d 43 d3 2d d9 0b f2 97  df d3 20 64 38 92 24 3a  |=C.-...... d8.$:|
+00000270  00 bc cf 9c 7d b7 40 20  01 5f aa d3 16 61 09 a2  |....}.@ ._...a..|
+00000280  76 fd 13 c3 cc e1 0c 5c  ee b1 87 82 f1 6c 04 ed  |v......\.....l..|
+00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
+000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
+000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 f1 7e d0  |............ .~.|
+000002d0  74 5c 5a ab 67 9d 3e ad  b5 4a 07 22 4a b7 3c e5  |t\Z.g.>..J."J.<.|
+000002e0  dd 4a 1f ba 33 b5 73 91  87 2a ef 5d 2b 08 04 00  |.J..3.s..*.]+...|
+000002f0  80 d7 78 82 c0 ee 54 02  e8 69 66 94 4b 92 74 0b  |..x...T..if.K.t.|
+00000300  be 72 05 ef 78 e2 60 c0  72 3a 09 42 4b d3 0d a0  |.r..x.`.r:.BK...|
+00000310  8b 50 b2 48 33 e4 d2 9f  64 4b 81 8c 5a c4 ad 8d  |.P.H3...dK..Z...|
+00000320  52 7c c4 79 10 1c df a8  80 bc 91 bc a7 5e b9 87  |R|.y.........^..|
+00000330  8c 68 63 41 dc 95 b0 b7  65 c4 e8 54 39 ce 2b f8  |.hcA....e..T9.+.|
+00000340  36 76 7f d1 1f ec 84 2b  08 63 10 d0 3c c0 4a 61  |6v.....+.c..<.Ja|
+00000350  5f 74 6a e2 94 93 82 e9  4f 81 bf 93 65 e8 09 06  |_tj.....O...e...|
+00000360  b6 61 14 ed 1a e0 52 f7  4f 08 2d 93 1e 1a 83 e2  |.a....R.O.-.....|
+00000370  17 16 03 03 00 3a 0d 00  00 36 03 01 02 40 00 2e  |.....:...6...@..|
+00000380  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
+00000390  08 04 08 05 08 06 04 01  05 01 06 01 03 03 02 03  |................|
+000003a0  03 01 02 01 03 02 02 02  04 02 05 02 06 02 00 00  |................|
+000003b0  16 03 03 00 04 0e 00 00  00                       |.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 02 0a 0b 00 02  06 00 02 03 00 02 00 30  |...............0|
 00000010  82 01 fc 30 82 01 5e 02  09 00 9a 30 84 6c 26 35  |...0..^....0.l&5|
@@ -113,27 +114,27 @@
 00000210  03 03 00 25 10 00 00 21  20 2f e5 7d a3 47 cd 62  |...%...! /.}.G.b|
 00000220  43 15 28 da ac 5f bb 29  07 30 ff f6 84 af c4 cf  |C.(.._.).0......|
 00000230  c2 ed 90 99 5f 58 cb 3b  74 16 03 03 00 93 0f 00  |...._X.;t.......|
-00000240  00 8f 04 03 00 8b 30 81  88 02 42 01 d0 ef 2f 75  |......0...B.../u|
-00000250  25 6e 4b 2a 16 21 c4 73  59 80 a8 c9 27 45 1b 06  |%nK*.!.sY...'E..|
-00000260  75 20 61 01 db aa c4 90  25 16 1b fb ec 92 54 f7  |u a.....%.....T.|
-00000270  16 9b 8c e0 34 48 3e 62  57 92 99 42 7f d1 35 09  |....4H>bW..B..5.|
-00000280  e1 55 4c 32 cc ed 9d 3e  18 25 1d 31 b8 02 42 01  |.UL2...>.%.1..B.|
-00000290  dd d8 20 b1 12 a2 7d 3b  6b 40 f3 db 59 2b 33 db  |.. ...};k@..Y+3.|
-000002a0  5f 85 4d b4 5f 6f 23 ae  d2 a2 74 2b 22 94 60 51  |_.M._o#...t+".`Q|
-000002b0  75 aa 66 88 2f 5a db f5  91 b2 7c f4 c4 e9 25 fa  |u.f./Z....|...%.|
-000002c0  f7 74 20 00 c3 08 22 8e  88 28 1c 72 4b 36 cd 03  |.t ..."..(.rK6..|
-000002d0  46 14 03 03 00 01 01 16  03 03 00 28 00 00 00 00  |F..........(....|
-000002e0  00 00 00 00 2c 30 d5 ee  d2 79 8c 68 62 7a c7 36  |....,0...y.hbz.6|
-000002f0  ce c9 39 25 4b 6d 3e 59  7d 42 21 72 65 00 41 45  |..9%Km>Y}B!re.AE|
-00000300  ba 47 88 64                                       |.G.d|
+00000240  00 8f 04 03 00 8b 30 81  88 02 42 01 8a 49 56 8a  |......0...B..IV.|
+00000250  3d 09 db 5b ae 29 2f 93  04 b1 7a 80 95 5c 30 4b  |=..[.)/...z..\0K|
+00000260  9a 90 5a 64 3d 12 72 03  7a 8f 4d 40 a8 b0 fd d3  |..Zd=.r.z.M@....|
+00000270  2d e5 3f a4 ce 97 34 e6  e4 23 4f 0b 00 7c 89 8e  |-.?...4..#O..|..|
+00000280  f2 37 14 a8 50 d3 d6 ec  99 f2 ff c6 8e 02 42 01  |.7..P.........B.|
+00000290  75 ba 90 7c 16 88 9f 93  73 2a ec e8 e0 53 82 6c  |u..|....s*...S.l|
+000002a0  85 a9 1f 42 7e a2 db 55  e9 cd a7 b0 b2 c6 a2 38  |...B~..U.......8|
+000002b0  14 75 ea 91 2f 10 c7 0a  f4 98 14 c7 a4 71 72 af  |.u../........qr.|
+000002c0  d1 b3 2b 86 a7 25 97 5f  de 5a c3 79 fe 44 42 b1  |..+..%._.Z.y.DB.|
+000002d0  dd 14 03 03 00 01 01 16  03 03 00 28 00 00 00 00  |...........(....|
+000002e0  00 00 00 00 a8 a3 81 5b  57 fb 9e 15 5a aa 77 1c  |.......[W...Z.w.|
+000002f0  39 cb 84 05 dc 58 2e 65  3c 25 b2 46 9a b3 17 a4  |9....X.e<%.F....|
+00000300  2f 6c ae fb                                       |/l..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 9c e9 30 06 da  |..........(..0..|
-00000010  ef 89 4a 77 db 17 d4 51  79 36 c1 97 45 8a b0 c9  |..Jw...Qy6..E...|
-00000020  b7 d4 69 8d fc f2 5e 1a  c8 e3 43 6c 7a b4 0a 40  |..i...^...Clz..@|
-00000030  ec 35 c9                                          |.5.|
+00000000  14 03 03 00 01 01 16 03  03 00 28 fd 91 33 fe 0c  |..........(..3..|
+00000010  f3 cf d7 9d b0 d1 e7 63  ea 06 f7 93 d3 f5 cd 33  |.......c.......3|
+00000020  32 ac 94 78 8e 15 ac 57  c9 b4 44 36 97 96 8d f1  |2..x...W..D6....|
+00000030  c3 20 0d                                          |. .|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 f2 3b 7e  |..............;~|
-00000010  59 d0 c1 2f 93 f8 8a 48  8d e6 f4 54 70 63 4a 2d  |Y../...H...TpcJ-|
-00000020  90 5d 9b 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.]..............|
-00000030  42 1f 5c b2 d3 14 4d 6e  30 85 59 89 5a 34 80 00  |B.\...Mn0.Y.Z4..|
-00000040  fe ab                                             |..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 99 85 0f  |................|
+00000010  d6 6c 5e b9 55 12 d5 b5  93 a8 b8 85 cb 0b 8f cd  |.l^.U...........|
+00000020  f5 fc a1 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
+00000030  e3 c0 5e 6a 72 6c 2d 5a  4c 94 0d 1e 77 85 ef 4a  |..^jrl-ZL...w..J|
+00000040  90 a5                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-Ed25519 b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-Ed25519
index 9ecd8e3ac3..c683f6d4c7 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-Ed25519
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-Ed25519
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,75 +7,76 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 5c 37 b1 d2 6c  |....Y...U..\7..l|
-00000010  bc dd 26 8c 4e f7 04 80  09 3c fd 76 23 d4 52 16  |..&.N....<.v#.R.|
-00000020  df 0e 79 ab f4 cf 8c f3  61 31 c6 20 7d 7a 1d 8f  |..y.....a1. }z..|
-00000030  09 3e 2b 25 04 7f 0f 0a  a7 0c 03 fd 9c 09 f3 5d  |.>+%...........]|
-00000040  96 75 f8 da 5b 6b 1b fb  ca d7 ec 7a cc a8 00 00  |.u..[k.....z....|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
-00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
-00000080  3f e2 5b ea a6 30 0d 06  09 2a 86 48 86 f7 0d 01  |?.[..0...*.H....|
-00000090  01 0b 05 00 30 1f 31 0b  30 09 06 03 55 04 0a 13  |....0.1.0...U...|
-000000a0  02 47 6f 31 10 30 0e 06  03 55 04 03 13 07 47 6f  |.Go1.0...U....Go|
-000000b0  20 52 6f 6f 74 30 1e 17  0d 31 36 30 31 30 31 30  | Root0...1601010|
-000000c0  30 30 30 30 30 5a 17 0d  32 35 30 31 30 31 30 30  |00000Z..25010100|
-000000d0  30 30 30 30 5a 30 1a 31  0b 30 09 06 03 55 04 0a  |0000Z0.1.0...U..|
-000000e0  13 02 47 6f 31 0b 30 09  06 03 55 04 03 13 02 47  |..Go1.0...U....G|
-000000f0  6f 30 81 9f 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |o0..0...*.H.....|
-00000100  01 05 00 03 81 8d 00 30  81 89 02 81 81 00 db 46  |.......0.......F|
-00000110  7d 93 2e 12 27 06 48 bc  06 28 21 ab 7e c4 b6 a2  |}...'.H..(!.~...|
-00000120  5d fe 1e 52 45 88 7a 36  47 a5 08 0d 92 42 5b c2  |]..RE.z6G....B[.|
-00000130  81 c0 be 97 79 98 40 fb  4f 6d 14 fd 2b 13 8b c2  |....y.@.Om..+...|
-00000140  a5 2e 67 d8 d4 09 9e d6  22 38 b7 4a 0b 74 73 2b  |..g....."8.J.ts+|
-00000150  c2 34 f1 d1 93 e5 96 d9  74 7b f3 58 9f 6c 61 3c  |.4......t{.X.la<|
-00000160  c0 b0 41 d4 d9 2b 2b 24  23 77 5b 1c 3b bd 75 5d  |..A..++$#w[.;.u]|
-00000170  ce 20 54 cf a1 63 87 1d  1e 24 c4 f3 1d 1a 50 8b  |. T..c...$....P.|
-00000180  aa b6 14 43 ed 97 a7 75  62 f4 14 c8 52 d7 02 03  |...C...ub...R...|
-00000190  01 00 01 a3 81 93 30 81  90 30 0e 06 03 55 1d 0f  |......0..0...U..|
-000001a0  01 01 ff 04 04 03 02 05  a0 30 1d 06 03 55 1d 25  |.........0...U.%|
-000001b0  04 16 30 14 06 08 2b 06  01 05 05 07 03 01 06 08  |..0...+.........|
-000001c0  2b 06 01 05 05 07 03 02  30 0c 06 03 55 1d 13 01  |+.......0...U...|
-000001d0  01 ff 04 02 30 00 30 19  06 03 55 1d 0e 04 12 04  |....0.0...U.....|
-000001e0  10 9f 91 16 1f 43 43 3e  49 a6 de 6d b6 80 d7 9f  |.....CC>I..m....|
-000001f0  60 30 1b 06 03 55 1d 23  04 14 30 12 80 10 48 13  |`0...U.#..0...H.|
-00000200  49 4d 13 7e 16 31 bb a3  01 d5 ac ab 6e 7b 30 19  |IM.~.1......n{0.|
-00000210  06 03 55 1d 11 04 12 30  10 82 0e 65 78 61 6d 70  |..U....0...examp|
-00000220  6c 65 2e 67 6f 6c 61 6e  67 30 0d 06 09 2a 86 48  |le.golang0...*.H|
-00000230  86 f7 0d 01 01 0b 05 00  03 81 81 00 9d 30 cc 40  |.............0.@|
-00000240  2b 5b 50 a0 61 cb ba e5  53 58 e1 ed 83 28 a9 58  |+[P.a...SX...(.X|
-00000250  1a a9 38 a4 95 a1 ac 31  5a 1a 84 66 3d 43 d3 2d  |..8....1Z..f=C.-|
-00000260  d9 0b f2 97 df d3 20 64  38 92 24 3a 00 bc cf 9c  |...... d8.$:....|
-00000270  7d b7 40 20 01 5f aa d3  16 61 09 a2 76 fd 13 c3  |}.@ ._...a..v...|
-00000280  cc e1 0c 5c ee b1 87 82  f1 6c 04 ed 73 bb b3 43  |...\.....l..s..C|
-00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
-000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
-000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 aa c7 43 e7 1e 3b 2b  |........ ..C..;+|
-000002d0  28 c2 68 aa 83 cc 85 63  68 c4 b8 4d fb 18 fa b9  |(.h....ch..M....|
-000002e0  3e 9a f2 7c 04 33 7f 48  6b 08 04 00 80 28 28 c7  |>..|.3.Hk....((.|
-000002f0  84 79 65 11 07 43 7a ce  f1 d6 cb 0e fe 6a 24 2c  |.ye..Cz......j$,|
-00000300  f3 f0 e5 9c 80 a6 c7 41  c7 51 f2 84 be 6e 58 df  |.......A.Q...nX.|
-00000310  f2 d2 d4 d9 62 08 c8 35  75 b9 8e 49 c2 98 b0 9d  |....b..5u..I....|
-00000320  32 aa db bf 03 c1 61 83  f7 20 d7 ec 07 27 5e 45  |2.....a.. ...'^E|
-00000330  dc d6 92 4c a1 4f 4e 7c  53 c5 ca 42 48 40 0f 83  |...L.ON|S..BH@..|
-00000340  fc 9d 60 a1 7c 43 d1 f5  f8 3f fe 50 3f d0 03 bc  |..`.|C...?.P?...|
-00000350  3e 8b ac 69 8f ae b6 9a  c8 d4 98 84 30 f1 79 9b  |>..i........0.y.|
-00000360  af 5d 4e 41 2a 7c 46 22  df 46 42 74 f6 16 03 03  |.]NA*|F".FBt....|
-00000370  00 3a 0d 00 00 36 03 01  02 40 00 2e 04 03 05 03  |.:...6...@......|
-00000380  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
-00000390  08 06 04 01 05 01 06 01  03 03 02 03 03 01 02 01  |................|
-000003a0  03 02 02 02 04 02 05 02  06 02 00 00 16 03 03 00  |................|
-000003b0  04 0e 00 00 00                                    |.....|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 6c b5 d2 af 6d  |....]...Y..l...m|
+00000010  6d 09 3b 84 5c 76 fc 25  81 84 b9 07 01 e9 54 cc  |m.;.\v.%......T.|
+00000020  4f 3f ab da ef 02 e7 59  8a e6 10 20 f9 72 db 0c  |O?.....Y... .r..|
+00000030  a4 c6 29 f6 ce 25 04 5d  af 3c 0f fa 97 28 ee 43  |..)..%.].<...(.C|
+00000040  b1 e5 5f 0a 42 36 2b 63  06 7d d0 de cc a8 00 00  |.._.B6+c.}......|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
+00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
+00000080  00 e8 f0 9d 3f e2 5b ea  a6 30 0d 06 09 2a 86 48  |....?.[..0...*.H|
+00000090  86 f7 0d 01 01 0b 05 00  30 1f 31 0b 30 09 06 03  |........0.1.0...|
+000000a0  55 04 0a 13 02 47 6f 31  10 30 0e 06 03 55 04 03  |U....Go1.0...U..|
+000000b0  13 07 47 6f 20 52 6f 6f  74 30 1e 17 0d 31 36 30  |..Go Root0...160|
+000000c0  31 30 31 30 30 30 30 30  30 5a 17 0d 32 35 30 31  |101000000Z..2501|
+000000d0  30 31 30 30 30 30 30 30  5a 30 1a 31 0b 30 09 06  |01000000Z0.1.0..|
+000000e0  03 55 04 0a 13 02 47 6f  31 0b 30 09 06 03 55 04  |.U....Go1.0...U.|
+000000f0  03 13 02 47 6f 30 81 9f  30 0d 06 09 2a 86 48 86  |...Go0..0...*.H.|
+00000100  f7 0d 01 01 01 05 00 03  81 8d 00 30 81 89 02 81  |...........0....|
+00000110  81 00 db 46 7d 93 2e 12  27 06 48 bc 06 28 21 ab  |...F}...'.H..(!.|
+00000120  7e c4 b6 a2 5d fe 1e 52  45 88 7a 36 47 a5 08 0d  |~...]..RE.z6G...|
+00000130  92 42 5b c2 81 c0 be 97  79 98 40 fb 4f 6d 14 fd  |.B[.....y.@.Om..|
+00000140  2b 13 8b c2 a5 2e 67 d8  d4 09 9e d6 22 38 b7 4a  |+.....g....."8.J|
+00000150  0b 74 73 2b c2 34 f1 d1  93 e5 96 d9 74 7b f3 58  |.ts+.4......t{.X|
+00000160  9f 6c 61 3c c0 b0 41 d4  d9 2b 2b 24 23 77 5b 1c  |.la<..A..++$#w[.|
+00000170  3b bd 75 5d ce 20 54 cf  a1 63 87 1d 1e 24 c4 f3  |;.u]. T..c...$..|
+00000180  1d 1a 50 8b aa b6 14 43  ed 97 a7 75 62 f4 14 c8  |..P....C...ub...|
+00000190  52 d7 02 03 01 00 01 a3  81 93 30 81 90 30 0e 06  |R.........0..0..|
+000001a0  03 55 1d 0f 01 01 ff 04  04 03 02 05 a0 30 1d 06  |.U...........0..|
+000001b0  03 55 1d 25 04 16 30 14  06 08 2b 06 01 05 05 07  |.U.%..0...+.....|
+000001c0  03 01 06 08 2b 06 01 05  05 07 03 02 30 0c 06 03  |....+.......0...|
+000001d0  55 1d 13 01 01 ff 04 02  30 00 30 19 06 03 55 1d  |U.......0.0...U.|
+000001e0  0e 04 12 04 10 9f 91 16  1f 43 43 3e 49 a6 de 6d  |.........CC>I..m|
+000001f0  b6 80 d7 9f 60 30 1b 06  03 55 1d 23 04 14 30 12  |....`0...U.#..0.|
+00000200  80 10 48 13 49 4d 13 7e  16 31 bb a3 01 d5 ac ab  |..H.IM.~.1......|
+00000210  6e 7b 30 19 06 03 55 1d  11 04 12 30 10 82 0e 65  |n{0...U....0...e|
+00000220  78 61 6d 70 6c 65 2e 67  6f 6c 61 6e 67 30 0d 06  |xample.golang0..|
+00000230  09 2a 86 48 86 f7 0d 01  01 0b 05 00 03 81 81 00  |.*.H............|
+00000240  9d 30 cc 40 2b 5b 50 a0  61 cb ba e5 53 58 e1 ed  |.0.@+[P.a...SX..|
+00000250  83 28 a9 58 1a a9 38 a4  95 a1 ac 31 5a 1a 84 66  |.(.X..8....1Z..f|
+00000260  3d 43 d3 2d d9 0b f2 97  df d3 20 64 38 92 24 3a  |=C.-...... d8.$:|
+00000270  00 bc cf 9c 7d b7 40 20  01 5f aa d3 16 61 09 a2  |....}.@ ._...a..|
+00000280  76 fd 13 c3 cc e1 0c 5c  ee b1 87 82 f1 6c 04 ed  |v......\.....l..|
+00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
+000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
+000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 05 e2 67  |............ ..g|
+000002d0  4b 7b e7 b3 0f 62 ff 90  4d 73 b1 c6 b7 ef 9c 33  |K{...b..Ms.....3|
+000002e0  30 83 7d 09 66 b6 d8 10  51 c6 95 b3 64 08 04 00  |0.}.f...Q...d...|
+000002f0  80 71 0d e7 a9 1b d7 2e  08 90 5b aa 30 cf c1 e0  |.q........[.0...|
+00000300  26 df 57 2d b2 95 4a 69  51 e4 b1 26 ad 91 1a 3e  |&.W-..JiQ..&...>|
+00000310  38 9f 4e 9e e3 72 7a a7  a8 57 79 3d e5 94 ab c2  |8.N..rz..Wy=....|
+00000320  e3 0f e9 07 aa 31 c9 d6  d8 3d 9c 00 2e c3 8b 3f  |.....1...=.....?|
+00000330  23 5a a9 af f0 6b f0 8f  55 b5 5d b3 67 7a cf b5  |#Z...k..U.].gz..|
+00000340  b4 c7 52 29 e9 3a 05 d2  cd d9 a9 99 13 49 15 8a  |..R).:.......I..|
+00000350  85 92 60 9a ed 72 c7 75  34 0f b5 26 70 ba 67 0b  |..`..r.u4..&p.g.|
+00000360  6e fb 52 97 01 bd 32 59  5b 56 bc e5 d9 68 cd 88  |n.R...2Y[V...h..|
+00000370  7c 16 03 03 00 3a 0d 00  00 36 03 01 02 40 00 2e  ||....:...6...@..|
+00000380  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
+00000390  08 04 08 05 08 06 04 01  05 01 06 01 03 03 02 03  |................|
+000003a0  03 01 02 01 03 02 02 02  04 02 05 02 06 02 00 00  |................|
+000003b0  16 03 03 00 04 0e 00 00  00                       |.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 01 3c 0b 00 01  38 00 01 35 00 01 32 30  |....<...8..5..20|
 00000010  82 01 2e 30 81 e1 a0 03  02 01 02 02 10 17 d1 81  |...0............|
@@ -100,20 +101,20 @@
 00000140  08 16 03 03 00 25 10 00  00 21 20 2f e5 7d a3 47  |.....%...! /.}.G|
 00000150  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
 00000160  c4 cf c2 ed 90 99 5f 58  cb 3b 74 16 03 03 00 48  |......_X.;t....H|
-00000170  0f 00 00 44 08 07 00 40  07 e0 a5 14 ca cf 31 d7  |...D...@......1.|
-00000180  99 96 c7 c7 d8 d8 a7 f7  82 e7 c6 c0 12 5d 91 5a  |.............].Z|
-00000190  bc eb 4a c0 59 c6 5b 7b  03 df 2a ff 48 ca 55 d8  |..J.Y.[{..*.H.U.|
-000001a0  3e 10 c1 94 2c 03 b2 e7  16 83 4d e5 5a 3d 8a 48  |>...,.....M.Z=.H|
-000001b0  2f e5 c4 59 de 6f 47 05  14 03 03 00 01 01 16 03  |/..Y.oG.........|
-000001c0  03 00 20 ae 35 81 df 88  0e a3 2e 67 3f 33 02 3d  |.. .5......g?3.=|
-000001d0  b8 7e 47 db cb be 05 c7  ba 43 dc 5b 52 3b 4b ca  |.~G......C.[R;K.|
-000001e0  c0 dc 78                                          |..x|
+00000170  0f 00 00 44 08 07 00 40  2f cb 89 2f a3 4e ee bb  |...D...@/../.N..|
+00000180  1a b0 77 a1 9f e3 0e 21  60 58 8d 62 86 2c 23 74  |..w....!`X.b.,#t|
+00000190  bd b9 2c 48 7f d3 fa 98  85 01 3a 49 7c a3 f6 c9  |..,H......:I|...|
+000001a0  b7 89 83 39 03 21 ed 6b  4a 31 76 b1 20 49 10 1c  |...9.!.kJ1v. I..|
+000001b0  55 ee bc 1c fb c3 ad 0c  14 03 03 00 01 01 16 03  |U...............|
+000001c0  03 00 20 7d f4 a6 96 ba  b1 c3 87 f7 1b 61 ca 88  |.. }.........a..|
+000001d0  b2 7b 18 f6 92 27 e3 47  fb 46 7b aa 5f ed a1 4c  |.{...'.G.F{._..L|
+000001e0  00 64 d7                                          |.d.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 63 23 49 7c 83  |.......... c#I|.|
-00000010  1a 8b cd 48 02 e7 86 4d  ab 8b 3c 4f 40 27 a6 48  |...H...M..<O@'.H|
-00000020  95 d5 80 8a 7a e0 56 0b  e6 34 70                 |....z.V..4p|
+00000000  14 03 03 00 01 01 16 03  03 00 20 97 ae 75 77 58  |.......... ..uwX|
+00000010  02 f2 b3 fe ef cf 61 fe  e8 d9 b3 49 02 49 64 c2  |......a....I.Id.|
+00000020  4b 94 fe 05 8d c1 46 ef  5b 53 8c                 |K.....F.[S.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 aa b4 5b  75 04 96 c5 4a e3 2a fb  |.......[u...J.*.|
-00000010  be 29 32 9e c5 e4 15 bd  38 df 69 15 03 03 00 12  |.)2.....8.i.....|
-00000020  50 4d b6 c0 95 e6 5a db  f2 b7 ea 02 cb 3e 01 ea  |PM....Z......>..|
-00000030  35 0d                                             |5.|
+00000000  17 03 03 00 16 16 ea 3f  e3 7d 1f 53 af a2 74 82  |.......?.}.S..t.|
+00000010  6e 8a 01 6a ea 75 8b a8  4e 76 74 15 03 03 00 12  |n..j.u..Nvt.....|
+00000020  e3 d8 78 82 9f db 28 60  01 c6 03 f0 e7 86 52 ba  |..x...(`......R.|
+00000030  2c 45                                             |,E|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384 b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384
index 35ec3471e6..9631c0c0b7 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,75 +7,76 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 16 f7 21 0a 97  |....Y...U....!..|
-00000010  89 11 ec c3 c4 05 41 79  72 60 40 6d ec 78 90 26  |......Ayr`@m.x.&|
-00000020  0c a4 f8 5d d5 27 e9 70  bb 40 21 20 b0 bb 98 5d  |...].'.p.@! ...]|
-00000030  a2 27 08 1e 4a fe f9 e1  cf a5 79 d3 eb c6 40 f7  |.'..J.....y...@.|
-00000040  ee 4f 0b fa a1 bb 09 62  07 24 30 b7 c0 30 00 00  |.O.....b.$0..0..|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
-00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
-00000080  3f e2 5b ea a6 30 0d 06  09 2a 86 48 86 f7 0d 01  |?.[..0...*.H....|
-00000090  01 0b 05 00 30 1f 31 0b  30 09 06 03 55 04 0a 13  |....0.1.0...U...|
-000000a0  02 47 6f 31 10 30 0e 06  03 55 04 03 13 07 47 6f  |.Go1.0...U....Go|
-000000b0  20 52 6f 6f 74 30 1e 17  0d 31 36 30 31 30 31 30  | Root0...1601010|
-000000c0  30 30 30 30 30 5a 17 0d  32 35 30 31 30 31 30 30  |00000Z..25010100|
-000000d0  30 30 30 30 5a 30 1a 31  0b 30 09 06 03 55 04 0a  |0000Z0.1.0...U..|
-000000e0  13 02 47 6f 31 0b 30 09  06 03 55 04 03 13 02 47  |..Go1.0...U....G|
-000000f0  6f 30 81 9f 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |o0..0...*.H.....|
-00000100  01 05 00 03 81 8d 00 30  81 89 02 81 81 00 db 46  |.......0.......F|
-00000110  7d 93 2e 12 27 06 48 bc  06 28 21 ab 7e c4 b6 a2  |}...'.H..(!.~...|
-00000120  5d fe 1e 52 45 88 7a 36  47 a5 08 0d 92 42 5b c2  |]..RE.z6G....B[.|
-00000130  81 c0 be 97 79 98 40 fb  4f 6d 14 fd 2b 13 8b c2  |....y.@.Om..+...|
-00000140  a5 2e 67 d8 d4 09 9e d6  22 38 b7 4a 0b 74 73 2b  |..g....."8.J.ts+|
-00000150  c2 34 f1 d1 93 e5 96 d9  74 7b f3 58 9f 6c 61 3c  |.4......t{.X.la<|
-00000160  c0 b0 41 d4 d9 2b 2b 24  23 77 5b 1c 3b bd 75 5d  |..A..++$#w[.;.u]|
-00000170  ce 20 54 cf a1 63 87 1d  1e 24 c4 f3 1d 1a 50 8b  |. T..c...$....P.|
-00000180  aa b6 14 43 ed 97 a7 75  62 f4 14 c8 52 d7 02 03  |...C...ub...R...|
-00000190  01 00 01 a3 81 93 30 81  90 30 0e 06 03 55 1d 0f  |......0..0...U..|
-000001a0  01 01 ff 04 04 03 02 05  a0 30 1d 06 03 55 1d 25  |.........0...U.%|
-000001b0  04 16 30 14 06 08 2b 06  01 05 05 07 03 01 06 08  |..0...+.........|
-000001c0  2b 06 01 05 05 07 03 02  30 0c 06 03 55 1d 13 01  |+.......0...U...|
-000001d0  01 ff 04 02 30 00 30 19  06 03 55 1d 0e 04 12 04  |....0.0...U.....|
-000001e0  10 9f 91 16 1f 43 43 3e  49 a6 de 6d b6 80 d7 9f  |.....CC>I..m....|
-000001f0  60 30 1b 06 03 55 1d 23  04 14 30 12 80 10 48 13  |`0...U.#..0...H.|
-00000200  49 4d 13 7e 16 31 bb a3  01 d5 ac ab 6e 7b 30 19  |IM.~.1......n{0.|
-00000210  06 03 55 1d 11 04 12 30  10 82 0e 65 78 61 6d 70  |..U....0...examp|
-00000220  6c 65 2e 67 6f 6c 61 6e  67 30 0d 06 09 2a 86 48  |le.golang0...*.H|
-00000230  86 f7 0d 01 01 0b 05 00  03 81 81 00 9d 30 cc 40  |.............0.@|
-00000240  2b 5b 50 a0 61 cb ba e5  53 58 e1 ed 83 28 a9 58  |+[P.a...SX...(.X|
-00000250  1a a9 38 a4 95 a1 ac 31  5a 1a 84 66 3d 43 d3 2d  |..8....1Z..f=C.-|
-00000260  d9 0b f2 97 df d3 20 64  38 92 24 3a 00 bc cf 9c  |...... d8.$:....|
-00000270  7d b7 40 20 01 5f aa d3  16 61 09 a2 76 fd 13 c3  |}.@ ._...a..v...|
-00000280  cc e1 0c 5c ee b1 87 82  f1 6c 04 ed 73 bb b3 43  |...\.....l..s..C|
-00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
-000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
-000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 39 1f 7e 66 c8 20 24  |........ 9.~f. $|
-000002d0  cf 8e 51 f6 bf 2a 01 a9  3b 51 19 f1 9d 32 b6 fa  |..Q..*..;Q...2..|
-000002e0  05 3b 90 c9 a3 8b 49 92  2a 08 04 00 80 da 65 ad  |.;....I.*.....e.|
-000002f0  fa f9 d5 f6 d7 13 34 d2  ab ac ea 57 37 69 c6 b1  |......4....W7i..|
-00000300  91 ee 89 b7 04 6b 17 fb  80 23 df df ef a1 62 9b  |.....k...#....b.|
-00000310  e4 0a 4e ca b0 35 b2 d3  2a cf 4f c1 e3 d9 37 78  |..N..5..*.O...7x|
-00000320  aa c8 59 f8 25 c7 43 51  19 6c c7 50 90 a4 2c 92  |..Y.%.CQ.l.P..,.|
-00000330  01 0e 8d ff f0 88 4b af  1d 03 ee 51 8b 18 e4 ee  |......K....Q....|
-00000340  35 48 16 e7 4c 26 1d d8  af 91 b1 75 38 b5 65 42  |5H..L&.....u8.eB|
-00000350  8e 60 c7 f9 25 a7 85 35  72 41 6f f6 c4 61 1d c0  |.`..%..5rAo..a..|
-00000360  c8 cf da ae 31 5e 2e d6  9c ca f1 d6 31 16 03 03  |....1^......1...|
-00000370  00 3a 0d 00 00 36 03 01  02 40 00 2e 04 03 05 03  |.:...6...@......|
-00000380  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
-00000390  08 06 04 01 05 01 06 01  03 03 02 03 03 01 02 01  |................|
-000003a0  03 02 02 02 04 02 05 02  06 02 00 00 16 03 03 00  |................|
-000003b0  04 0e 00 00 00                                    |.....|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 b7 f3 10 78 e0  |....]...Y.....x.|
+00000010  58 51 c7 7c 5c 88 27 e1  ce e4 df 24 45 36 7c fe  |XQ.|\.'....$E6|.|
+00000020  9b 5c a1 89 0a 6e af 2a  73 b9 93 20 40 64 4c 4d  |.\...n.*s.. @dLM|
+00000030  9d 10 58 ef 28 30 5d 81  2b 91 3b 5d 2b 67 b4 61  |..X.(0].+.;]+g.a|
+00000040  ef 24 f1 23 e2 32 46 4c  3e 96 7a a2 c0 30 00 00  |.$.#.2FL>.z..0..|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
+00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
+00000080  00 e8 f0 9d 3f e2 5b ea  a6 30 0d 06 09 2a 86 48  |....?.[..0...*.H|
+00000090  86 f7 0d 01 01 0b 05 00  30 1f 31 0b 30 09 06 03  |........0.1.0...|
+000000a0  55 04 0a 13 02 47 6f 31  10 30 0e 06 03 55 04 03  |U....Go1.0...U..|
+000000b0  13 07 47 6f 20 52 6f 6f  74 30 1e 17 0d 31 36 30  |..Go Root0...160|
+000000c0  31 30 31 30 30 30 30 30  30 5a 17 0d 32 35 30 31  |101000000Z..2501|
+000000d0  30 31 30 30 30 30 30 30  5a 30 1a 31 0b 30 09 06  |01000000Z0.1.0..|
+000000e0  03 55 04 0a 13 02 47 6f  31 0b 30 09 06 03 55 04  |.U....Go1.0...U.|
+000000f0  03 13 02 47 6f 30 81 9f  30 0d 06 09 2a 86 48 86  |...Go0..0...*.H.|
+00000100  f7 0d 01 01 01 05 00 03  81 8d 00 30 81 89 02 81  |...........0....|
+00000110  81 00 db 46 7d 93 2e 12  27 06 48 bc 06 28 21 ab  |...F}...'.H..(!.|
+00000120  7e c4 b6 a2 5d fe 1e 52  45 88 7a 36 47 a5 08 0d  |~...]..RE.z6G...|
+00000130  92 42 5b c2 81 c0 be 97  79 98 40 fb 4f 6d 14 fd  |.B[.....y.@.Om..|
+00000140  2b 13 8b c2 a5 2e 67 d8  d4 09 9e d6 22 38 b7 4a  |+.....g....."8.J|
+00000150  0b 74 73 2b c2 34 f1 d1  93 e5 96 d9 74 7b f3 58  |.ts+.4......t{.X|
+00000160  9f 6c 61 3c c0 b0 41 d4  d9 2b 2b 24 23 77 5b 1c  |.la<..A..++$#w[.|
+00000170  3b bd 75 5d ce 20 54 cf  a1 63 87 1d 1e 24 c4 f3  |;.u]. T..c...$..|
+00000180  1d 1a 50 8b aa b6 14 43  ed 97 a7 75 62 f4 14 c8  |..P....C...ub...|
+00000190  52 d7 02 03 01 00 01 a3  81 93 30 81 90 30 0e 06  |R.........0..0..|
+000001a0  03 55 1d 0f 01 01 ff 04  04 03 02 05 a0 30 1d 06  |.U...........0..|
+000001b0  03 55 1d 25 04 16 30 14  06 08 2b 06 01 05 05 07  |.U.%..0...+.....|
+000001c0  03 01 06 08 2b 06 01 05  05 07 03 02 30 0c 06 03  |....+.......0...|
+000001d0  55 1d 13 01 01 ff 04 02  30 00 30 19 06 03 55 1d  |U.......0.0...U.|
+000001e0  0e 04 12 04 10 9f 91 16  1f 43 43 3e 49 a6 de 6d  |.........CC>I..m|
+000001f0  b6 80 d7 9f 60 30 1b 06  03 55 1d 23 04 14 30 12  |....`0...U.#..0.|
+00000200  80 10 48 13 49 4d 13 7e  16 31 bb a3 01 d5 ac ab  |..H.IM.~.1......|
+00000210  6e 7b 30 19 06 03 55 1d  11 04 12 30 10 82 0e 65  |n{0...U....0...e|
+00000220  78 61 6d 70 6c 65 2e 67  6f 6c 61 6e 67 30 0d 06  |xample.golang0..|
+00000230  09 2a 86 48 86 f7 0d 01  01 0b 05 00 03 81 81 00  |.*.H............|
+00000240  9d 30 cc 40 2b 5b 50 a0  61 cb ba e5 53 58 e1 ed  |.0.@+[P.a...SX..|
+00000250  83 28 a9 58 1a a9 38 a4  95 a1 ac 31 5a 1a 84 66  |.(.X..8....1Z..f|
+00000260  3d 43 d3 2d d9 0b f2 97  df d3 20 64 38 92 24 3a  |=C.-...... d8.$:|
+00000270  00 bc cf 9c 7d b7 40 20  01 5f aa d3 16 61 09 a2  |....}.@ ._...a..|
+00000280  76 fd 13 c3 cc e1 0c 5c  ee b1 87 82 f1 6c 04 ed  |v......\.....l..|
+00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
+000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
+000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 e4 a0 4d  |............ ..M|
+000002d0  a8 b2 65 c0 a7 f8 46 a3  79 1c c6 32 7d 1e c4 7b  |..e...F.y..2}..{|
+000002e0  09 4a cd 92 5d a6 64 20  b7 c2 0e 5e 50 08 04 00  |.J..].d ...^P...|
+000002f0  80 32 80 e3 3b 30 c3 d9  67 9a ef ea 95 f1 c3 50  |.2..;0..g......P|
+00000300  cb 98 82 3e 92 fd 4c 1b  76 53 4e 31 41 f4 30 9a  |...>..L.vSN1A.0.|
+00000310  0a c0 8b 50 5c d6 5c ce  9f ee d9 c6 02 79 48 58  |...P\.\......yHX|
+00000320  97 04 9f 7f 86 f2 7b 61  87 f8 5a d1 92 c3 57 d4  |......{a..Z...W.|
+00000330  c8 86 a2 be 75 3c 13 75  71 13 e2 20 e7 03 b6 6e  |....u<.uq.. ...n|
+00000340  97 d5 32 f5 af ce d5 4f  e6 7d a6 b3 36 11 f5 ae  |..2....O.}..6...|
+00000350  4a 0a fb 43 fa 2c c5 29  e6 fa 59 5f 20 e4 41 f1  |J..C.,.)..Y_ .A.|
+00000360  3b be e1 1e 80 92 74 1c  8e fe 3a f8 c3 ef ed 93  |;.....t...:.....|
+00000370  02 16 03 03 00 3a 0d 00  00 36 03 01 02 40 00 2e  |.....:...6...@..|
+00000380  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
+00000390  08 04 08 05 08 06 04 01  05 01 06 01 03 03 02 03  |................|
+000003a0  03 01 02 01 03 02 02 02  04 02 05 02 06 02 00 00  |................|
+000003b0  16 03 03 00 04 0e 00 00  00                       |.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
 00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
@@ -112,26 +113,26 @@
 00000200  e5 35 16 03 03 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
 00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 03 00  |......._X.;t....|
-00000230  88 0f 00 00 84 08 04 00  80 56 1c 58 51 d8 51 bc  |.........V.XQ.Q.|
-00000240  8e 4b b8 24 64 85 81 d2  26 9b 38 bf 13 19 e7 0a  |.K.$d...&.8.....|
-00000250  f7 94 e8 b5 94 bf 6f ae  f2 07 1a 46 24 38 7b 8b  |......o....F$8{.|
-00000260  2f a6 da 91 1a 5f 7d 3f  cf c4 1b 14 9c 44 8e 6a  |/...._}?.....D.j|
-00000270  6b c8 c4 60 c6 15 e6 f2  c0 45 e7 46 c4 32 06 b1  |k..`.....E.F.2..|
-00000280  46 5e 25 1d ba f7 d8 81  b0 6b 50 40 81 b1 93 89  |F^%......kP@....|
-00000290  cb 90 ae 10 b1 db 08 99  e6 0e 8f 17 0f 4d a7 a7  |.............M..|
-000002a0  f5 42 8a be ca d6 75 c4  32 44 22 ab df cf 22 f7  |.B....u.2D"...".|
-000002b0  58 d9 9f 52 c2 04 c0 81  59 14 03 03 00 01 01 16  |X..R....Y.......|
-000002c0  03 03 00 28 00 00 00 00  00 00 00 00 eb 5a 97 41  |...(.........Z.A|
-000002d0  1d da 2b 81 da 7a b7 9a  f8 5e fe 50 75 e5 a4 6a  |..+..z...^.Pu..j|
-000002e0  21 90 b7 3d 4e bc 44 cf  86 8f cd c3              |!..=N.D.....|
+00000230  88 0f 00 00 84 08 04 00  80 57 04 14 cf f4 73 9e  |.........W....s.|
+00000240  5d 94 16 54 3a 06 6b 37  03 b2 15 52 f1 27 86 2e  |]..T:.k7...R.'..|
+00000250  66 e3 0b 4c da f9 71 1b  6a 5b 65 d8 7c 43 80 6a  |f..L..q.j[e.|C.j|
+00000260  d1 5c 5c 3b ff 44 dc c7  a9 74 01 51 76 69 79 24  |.\\;.D...t.Qviy$|
+00000270  c5 91 79 65 73 7e b7 1b  15 80 34 b4 31 89 c4 e9  |..yes~....4.1...|
+00000280  f8 e3 18 fd 68 65 b9 65  d7 31 cc d0 8d 00 4e 55  |....he.e.1....NU|
+00000290  3f dc 17 58 b3 b8 aa 98  4e 73 c5 05 bb 54 81 e3  |?..X....Ns...T..|
+000002a0  42 5d b3 1b 6e b0 f8 a0  2c 00 52 e0 e1 16 18 d3  |B]..n...,.R.....|
+000002b0  d1 df 2b b9 15 20 69 d6  1a 14 03 03 00 01 01 16  |..+.. i.........|
+000002c0  03 03 00 28 00 00 00 00  00 00 00 00 b7 cd 13 34  |...(...........4|
+000002d0  56 65 49 f9 1c 23 7f 7d  45 18 91 0f 23 27 c8 78  |VeI..#.}E...#'.x|
+000002e0  cb 34 f8 7c 90 58 5f 29  ff ac f8 1c              |.4.|.X_)....|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 93 a5 d4 a8 16  |..........(.....|
-00000010  4e a2 b2 c3 b9 ce dd 0e  57 49 7c eb 92 e4 e7 e3  |N.......WI|.....|
-00000020  a8 55 3a 56 54 53 92 b8  ce 15 e3 c3 c2 da 52 01  |.U:VTS........R.|
-00000030  6f 35 fd                                          |o5.|
+00000000  14 03 03 00 01 01 16 03  03 00 28 c0 cc d9 54 39  |..........(...T9|
+00000010  73 0a 5f d9 33 a2 00 cc  18 f6 73 c9 b1 c6 35 b7  |s._.3.....s...5.|
+00000020  49 85 5c 0d 46 21 84 4e  3d b8 ca b8 66 04 e7 96  |I.\.F!.N=...f...|
+00000030  e6 55 26                                          |.U&|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 5b 20 4f  |.............[ O|
-00000010  e9 3f 09 28 6e 88 5d 1d  57 90 2c 35 74 37 d1 df  |.?.(n.].W.,5t7..|
-00000020  aa 39 9b 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.9..............|
-00000030  bb e3 77 62 e5 c9 78 f4  a5 09 93 b0 20 9a 1b a4  |..wb..x..... ...|
-00000040  48 44                                             |HD|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 61 6d a3  |.............am.|
+00000010  bd c6 12 0d b3 42 56 a3  e3 c9 e6 4d 38 bf 1d 4c  |.....BV....M8..L|
+00000020  59 82 c8 15 03 03 00 1a  00 00 00 00 00 00 00 02  |Y...............|
+00000030  ea 55 21 35 64 fd c6 7c  0e f3 2d 67 d6 53 03 20  |.U!5d..|..-g.S. |
+00000040  64 06                                             |d.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA
index 110f689f8e..ccb5998dfb 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-ECDSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,71 +7,72 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 68 dc 2e 5e 8e  |....Y...U..h..^.|
-00000010  80 38 0e 65 a3 b0 f6 a0  c0 8f 1e 62 ef 1d 5a 54  |.8.e.......b..ZT|
-00000020  82 dc 9c 68 77 88 57 dd  f3 9d c2 20 4e 56 dd 44  |...hw.W.... NV.D|
-00000030  a0 46 67 4c 09 2b d5 e6  fe 15 fb b3 8e 19 ef a3  |.FgL.+..........|
-00000040  8e 5c a9 70 00 cf 96 d7  3b 8b c9 64 c0 09 00 00  |.\.p....;..d....|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
-00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
-00000080  30 09 06 07 2a 86 48 ce  3d 04 01 30 45 31 0b 30  |0...*.H.=..0E1.0|
-00000090  09 06 03 55 04 06 13 02  41 55 31 13 30 11 06 03  |...U....AU1.0...|
-000000a0  55 04 08 13 0a 53 6f 6d  65 2d 53 74 61 74 65 31  |U....Some-State1|
-000000b0  21 30 1f 06 03 55 04 0a  13 18 49 6e 74 65 72 6e  |!0...U....Intern|
-000000c0  65 74 20 57 69 64 67 69  74 73 20 50 74 79 20 4c  |et Widgits Pty L|
-000000d0  74 64 30 1e 17 0d 31 32  31 31 32 32 31 35 30 36  |td0...1211221506|
-000000e0  33 32 5a 17 0d 32 32 31  31 32 30 31 35 30 36 33  |32Z..22112015063|
-000000f0  32 5a 30 45 31 0b 30 09  06 03 55 04 06 13 02 41  |2Z0E1.0...U....A|
-00000100  55 31 13 30 11 06 03 55  04 08 13 0a 53 6f 6d 65  |U1.0...U....Some|
-00000110  2d 53 74 61 74 65 31 21  30 1f 06 03 55 04 0a 13  |-State1!0...U...|
-00000120  18 49 6e 74 65 72 6e 65  74 20 57 69 64 67 69 74  |.Internet Widgit|
-00000130  73 20 50 74 79 20 4c 74  64 30 81 9b 30 10 06 07  |s Pty Ltd0..0...|
-00000140  2a 86 48 ce 3d 02 01 06  05 2b 81 04 00 23 03 81  |*.H.=....+...#..|
-00000150  86 00 04 00 c4 a1 ed be  98 f9 0b 48 73 36 7e c3  |...........Hs6~.|
-00000160  16 56 11 22 f2 3d 53 c3  3b 4d 21 3d cd 6b 75 e6  |.V.".=S.;M!=.ku.|
-00000170  f6 b0 dc 9a df 26 c1 bc  b2 87 f0 72 32 7c b3 64  |.....&.....r2|.d|
-00000180  2f 1c 90 bc ea 68 23 10  7e fe e3 25 c0 48 3a 69  |/....h#.~..%.H:i|
-00000190  e0 28 6d d3 37 00 ef 04  62 dd 0d a0 9c 70 62 83  |.(m.7...b....pb.|
-000001a0  d8 81 d3 64 31 aa 9e 97  31 bd 96 b0 68 c0 9b 23  |...d1...1...h..#|
-000001b0  de 76 64 3f 1a 5c 7f e9  12 0e 58 58 b6 5f 70 dd  |.vd?.\....XX._p.|
-000001c0  9b d8 ea d5 d7 f5 d5 cc  b9 b6 9f 30 66 5b 66 9a  |...........0f[f.|
-000001d0  20 e2 27 e5 bf fe 3b 30  09 06 07 2a 86 48 ce 3d  | .'...;0...*.H.=|
-000001e0  04 01 03 81 8c 00 30 81  88 02 42 01 88 a2 4f eb  |......0...B...O.|
-000001f0  e2 45 c5 48 7d 1b ac f5  ed 98 9d ae 47 70 c0 5e  |.E.H}.......Gp.^|
-00000200  1b b6 2f bd f1 b6 4d b7  61 40 d3 11 a2 ce ee 0b  |../...M.a@......|
-00000210  7e 92 7e ff 76 9d c3 3b  7e a5 3f ce fa 10 e2 59  |~.~.v..;~.?....Y|
-00000220  ec 47 2d 7c ac da 4e 97  0e 15 a0 6f d0 02 42 01  |.G-|..N....o..B.|
-00000230  4d fc be 67 13 9c 2d 05  0e bd 3f a3 8c 25 c1 33  |M..g..-...?..%.3|
-00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
-00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
-00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 b6 0c 00  00 b2 03 00 1d 20 24 d0  |*............ $.|
-00000280  e5 11 4c 95 2c 96 58 62  01 df 20 c8 24 ce 29 a2  |..L.,.Xb.. .$.).|
-00000290  1a 3e 97 e2 df 29 49 e6  3a e8 c2 d3 72 49 04 03  |.>...)I.:...rI..|
-000002a0  00 8a 30 81 87 02 41 71  15 8d 50 f6 69 40 d7 cd  |..0...Aq..P.i@..|
-000002b0  da c9 c3 ee 37 c2 5f c3  89 62 23 e0 ef 37 f9 9e  |....7._..b#..7..|
-000002c0  2a 26 85 10 56 28 08 de  49 3b fa 03 f3 14 4b 3a  |*&..V(..I;....K:|
-000002d0  b2 3d de 84 d2 08 8d 4e  59 3e 80 8f 6a 44 af 6f  |.=.....NY>..jD.o|
-000002e0  be ee 08 ae 35 40 42 bc  02 42 00 f3 e9 89 a5 7f  |....5@B..B......|
-000002f0  9c 50 7c 07 34 e4 cf f0  2b 0f cf f7 68 57 fa fd  |.P|.4...+...hW..|
-00000300  2f 52 04 f8 90 7b 97 eb  c3 e0 cc 68 f7 bf 22 21  |/R...{.....h.."!|
-00000310  62 b3 51 c8 a4 30 38 c5  88 46 df 55 21 21 d0 4f  |b.Q..08..F.U!!.O|
-00000320  6f 95 7b 5f 5a c6 98 dd  2d d1 0a 95 16 03 03 00  |o.{_Z...-.......|
-00000330  3a 0d 00 00 36 03 01 02  40 00 2e 04 03 05 03 06  |:...6...@.......|
-00000340  03 08 07 08 08 08 09 08  0a 08 0b 08 04 08 05 08  |................|
-00000350  06 04 01 05 01 06 01 03  03 02 03 03 01 02 01 03  |................|
-00000360  02 02 02 04 02 05 02 06  02 00 00 16 03 03 00 04  |................|
-00000370  0e 00 00 00                                       |....|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 62 ba 01 96 bd  |....]...Y..b....|
+00000010  12 c5 9d 43 86 5e fe 8d  9e 77 a2 17 dc f3 a2 d6  |...C.^...w......|
+00000020  ca 8f d4 49 ff 9b cb a5  bc 86 29 20 58 57 f3 d7  |...I......) XW..|
+00000030  5e d8 b9 d7 95 54 f9 50  5c b6 78 44 29 bb 83 21  |^....T.P\.xD)..!|
+00000040  77 b2 95 23 5d 4f bb 6a  15 60 e6 86 c0 09 00 00  |w..#]O.j.`......|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 03 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
+00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
+00000080  a0 d2 eb f4 30 09 06 07  2a 86 48 ce 3d 04 01 30  |....0...*.H.=..0|
+00000090  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+000000a0  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+000000b0  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+000000c0  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+000000d0  74 79 20 4c 74 64 30 1e  17 0d 31 32 31 31 32 32  |ty Ltd0...121122|
+000000e0  31 35 30 36 33 32 5a 17  0d 32 32 31 31 32 30 31  |150632Z..2211201|
+000000f0  35 30 36 33 32 5a 30 45  31 0b 30 09 06 03 55 04  |50632Z0E1.0...U.|
+00000100  06 13 02 41 55 31 13 30  11 06 03 55 04 08 13 0a  |...AU1.0...U....|
+00000110  53 6f 6d 65 2d 53 74 61  74 65 31 21 30 1f 06 03  |Some-State1!0...|
+00000120  55 04 0a 13 18 49 6e 74  65 72 6e 65 74 20 57 69  |U....Internet Wi|
+00000130  64 67 69 74 73 20 50 74  79 20 4c 74 64 30 81 9b  |dgits Pty Ltd0..|
+00000140  30 10 06 07 2a 86 48 ce  3d 02 01 06 05 2b 81 04  |0...*.H.=....+..|
+00000150  00 23 03 81 86 00 04 00  c4 a1 ed be 98 f9 0b 48  |.#.............H|
+00000160  73 36 7e c3 16 56 11 22  f2 3d 53 c3 3b 4d 21 3d  |s6~..V.".=S.;M!=|
+00000170  cd 6b 75 e6 f6 b0 dc 9a  df 26 c1 bc b2 87 f0 72  |.ku......&.....r|
+00000180  32 7c b3 64 2f 1c 90 bc  ea 68 23 10 7e fe e3 25  |2|.d/....h#.~..%|
+00000190  c0 48 3a 69 e0 28 6d d3  37 00 ef 04 62 dd 0d a0  |.H:i.(m.7...b...|
+000001a0  9c 70 62 83 d8 81 d3 64  31 aa 9e 97 31 bd 96 b0  |.pb....d1...1...|
+000001b0  68 c0 9b 23 de 76 64 3f  1a 5c 7f e9 12 0e 58 58  |h..#.vd?.\....XX|
+000001c0  b6 5f 70 dd 9b d8 ea d5  d7 f5 d5 cc b9 b6 9f 30  |._p............0|
+000001d0  66 5b 66 9a 20 e2 27 e5  bf fe 3b 30 09 06 07 2a  |f[f. .'...;0...*|
+000001e0  86 48 ce 3d 04 01 03 81  8c 00 30 81 88 02 42 01  |.H.=......0...B.|
+000001f0  88 a2 4f eb e2 45 c5 48  7d 1b ac f5 ed 98 9d ae  |..O..E.H}.......|
+00000200  47 70 c0 5e 1b b6 2f bd  f1 b6 4d b7 61 40 d3 11  |Gp.^../...M.a@..|
+00000210  a2 ce ee 0b 7e 92 7e ff  76 9d c3 3b 7e a5 3f ce  |....~.~.v..;~.?.|
+00000220  fa 10 e2 59 ec 47 2d 7c  ac da 4e 97 0e 15 a0 6f  |...Y.G-|..N....o|
+00000230  d0 02 42 01 4d fc be 67  13 9c 2d 05 0e bd 3f a3  |..B.M..g..-...?.|
+00000240  8c 25 c1 33 13 83 0d 94  06 bb d4 37 7a f6 ec 7a  |.%.3.......7z..z|
+00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
+00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
+00000270  95 12 07 8f 2a 16 03 03  00 b7 0c 00 00 b3 03 00  |....*...........|
+00000280  1d 20 e7 43 a8 15 b3 d3  ea fd b4 dd 02 83 09 c8  |. .C............|
+00000290  76 8f 9b 0e d8 f1 9c e7  99 d5 80 0e fb b8 a1 5c  |v..............\|
+000002a0  f2 1e 04 03 00 8b 30 81  88 02 42 01 22 7d 76 28  |......0...B."}v(|
+000002b0  67 0b 8c 78 65 0b d8 11  3e 29 70 02 49 d1 d7 c4  |g..xe...>)p.I...|
+000002c0  50 7b fb 07 2e 8d 91 f6  c4 f8 56 be 75 c6 61 05  |P{........V.u.a.|
+000002d0  43 42 2f f9 46 25 09 a6  a8 29 1d 95 6a 5c 65 fd  |CB/.F%...)..j\e.|
+000002e0  07 c1 88 1b f3 fd 52 7a  e4 17 01 fe ad 02 42 01  |......Rz......B.|
+000002f0  4f 77 cd d5 34 45 7d 3f  8f 70 ad 80 70 b9 77 9a  |Ow..4E}?.p..p.w.|
+00000300  08 c6 96 1c 95 14 76 17  90 05 fd 9a 38 be aa ff  |......v.....8...|
+00000310  64 76 35 ae 91 85 14 e5  e8 37 f7 0a b1 50 16 69  |dv5......7...P.i|
+00000320  ab 80 14 77 ee c0 56 77  e5 17 ea d4 57 3c 04 23  |...w..Vw....W<.#|
+00000330  d7 16 03 03 00 3a 0d 00  00 36 03 01 02 40 00 2e  |.....:...6...@..|
+00000340  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
+00000350  08 04 08 05 08 06 04 01  05 01 06 01 03 03 02 03  |................|
+00000360  03 01 02 01 03 02 02 02  04 02 05 02 06 02 00 00  |................|
+00000370  16 03 03 00 04 0e 00 00  00                       |.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
 00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
@@ -108,31 +109,31 @@
 00000200  e5 35 16 03 03 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
 00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 03 00  |......._X.;t....|
-00000230  88 0f 00 00 84 08 04 00  80 84 38 78 4d dd 9f 84  |..........8xM...|
-00000240  ae cb b8 2f e9 f3 76 66  41 56 f6 ed a5 fb 8b f2  |.../..vfAV......|
-00000250  43 0f 27 56 9e 7d a8 06  3e 8f ad b0 17 d5 d6 52  |C.'V.}..>......R|
-00000260  f4 88 e5 af 55 5b 55 fc  26 c1 a9 d5 a9 34 2b 50  |....U[U.&....4+P|
-00000270  96 09 db 59 cc f4 e8 cf  84 6f 9d b1 fd 3b a4 66  |...Y.....o...;.f|
-00000280  66 43 74 6d 4f e5 52 2c  22 2d c9 4c 67 3d ff 3d  |fCtmO.R,"-.Lg=.=|
-00000290  c2 79 b3 b1 85 56 08 cc  02 7c 53 a7 be 39 04 21  |.y...V...|S..9.!|
-000002a0  fb db fe ff 1b a6 c7 7a  e9 4c 11 c3 34 a6 7c 4f  |.......z.L..4.|O|
-000002b0  23 61 d9 47 b0 6c ae cb  72 14 03 03 00 01 01 16  |#a.G.l..r.......|
+00000230  88 0f 00 00 84 08 04 00  80 47 44 b3 b1 39 6e 07  |.........GD..9n.|
+00000240  14 9c 0d 2f bd 5e 39 06  7a af b2 d0 52 9c 6b b8  |.../.^9.z...R.k.|
+00000250  6e 07 59 e7 a2 c2 33 83  31 d6 42 79 25 ed 37 b0  |n.Y...3.1.By%.7.|
+00000260  97 25 d5 cc a7 7b 54 36  a3 a2 7c 67 38 c2 92 e9  |.%...{T6..|g8...|
+00000270  ab 58 59 4f 22 89 57 2b  27 2c d4 e8 7b 1d 5f 0b  |.XYO".W+',..{._.|
+00000280  1f 94 15 b0 38 67 0d a7  ff 66 2d fd 02 65 d6 8b  |....8g...f-..e..|
+00000290  ce e2 2a 3c 83 70 56 26  00 e6 1b 47 69 9e 9d 3b  |..*<.pV&...Gi..;|
+000002a0  81 88 49 58 a6 3a a1 5f  27 dc 7e 79 86 40 af 8c  |..IX.:._'.~y.@..|
+000002b0  35 17 83 92 da 81 7c 41  0d 14 03 03 00 01 01 16  |5.....|A........|
 000002c0  03 03 00 40 00 00 00 00  00 00 00 00 00 00 00 00  |...@............|
-000002d0  00 00 00 00 d3 95 4a 65  d9 8e 3d 9c 2b 18 67 aa  |......Je..=.+.g.|
-000002e0  e0 d7 a6 dd fb af 42 06  0d 56 cc 3d 12 3e 7e 95  |......B..V.=.>~.|
-000002f0  18 6e 97 d6 cc 84 eb 90  a1 c3 b6 6e 3c 42 d1 2e  |.n.........n<B..|
-00000300  7a dc 41 81                                       |z.A.|
+000002d0  00 00 00 00 09 20 b3 66  7d 40 5d 62 f0 21 0c 02  |..... .f}@]b.!..|
+000002e0  66 75 9e 32 f7 28 e4 8e  ad 90 18 7d 6a 2b f0 1c  |fu.2.(.....}j+..|
+000002f0  3e d4 6d 55 c7 a6 74 88  58 25 c3 69 df 0f 86 10  |>.mU..t.X%.i....|
+00000300  3c 51 88 26                                       |<Q.&|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 71 ee 1d 4f 55  |..........@q..OU|
-00000010  b4 47 3d 26 52 5a 00 a5  ce 0e 31 6c 2d 09 95 df  |.G=&RZ....1l-...|
-00000020  fb 74 30 89 32 3d 47 29  58 ee 61 70 74 18 8c 01  |.t0.2=G)X.apt...|
-00000030  e3 16 d7 6e 3d a1 30 75  61 b8 99 e4 c5 82 82 d5  |...n=.0ua.......|
-00000040  75 f6 e1 b4 f8 97 77 92  00 64 06                 |u.....w..d.|
+00000000  14 03 03 00 01 01 16 03  03 00 40 80 4c 52 cc b6  |..........@.LR..|
+00000010  b3 e1 4d 8c a7 26 70 f3  47 21 ed ff 01 45 41 91  |..M..&p.G!...EA.|
+00000020  b7 ce 09 87 4d 5b d8 48  c5 9e b1 5d 42 e4 43 1c  |....M[.H...]B.C.|
+00000030  e0 90 c6 e2 20 64 80 30  6a e7 25 0f 7b 40 fe 8c  |.... d.0j.%.{@..|
+00000040  5f 80 b3 92 25 96 2b e9  38 f2 e3                 |_...%.+.8..|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 e2 68 77  75 6a f8 3c 3d 2c 96 52  |......hwuj.<=,.R|
-00000020  2d fc d5 3b d3 17 c0 29  df 99 f1 09 23 13 9f 89  |-..;...)....#...|
-00000030  dd 21 15 23 36 15 03 03  00 30 00 00 00 00 00 00  |.!.#6....0......|
-00000040  00 00 00 00 00 00 00 00  00 00 37 4e ac 91 80 02  |..........7N....|
-00000050  4f 4a 9f b4 3c 0e 24 87  c8 d0 41 24 ce 01 e2 bb  |OJ..<.$...A$....|
-00000060  18 af bc ce 09 4b 41 f6  db 08                    |.....KA...|
+00000010  00 00 00 00 00 6c d5 26  50 49 6f 1a 46 3a d2 3a  |.....l.&PIo.F:.:|
+00000020  ff b2 0b 17 65 ed 7f a4  b8 e8 82 f6 89 af 07 04  |....e...........|
+00000030  bc 77 d6 74 34 15 03 03  00 30 00 00 00 00 00 00  |.w.t4....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 ca b6 5b 91 20 9d  |............[. .|
+00000050  91 42 33 eb f4 49 b6 38  24 fc 3c 8b f7 6c 6b fd  |.B3..I.8$.<..lk.|
+00000060  df e8 aa 07 18 29 cd 04  85 70                    |.....)...p|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA
index cbc4bcc311..c36f2825f6 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,75 +7,76 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 b6 96 f2 bc ed  |....Y...U.......|
-00000010  1b 14 73 de 12 10 cc e9  4d f2 c7 8b 46 d8 63 55  |..s.....M...F.cU|
-00000020  8f 04 33 ec 89 b5 70 93  01 1c f2 20 72 82 e1 16  |..3...p.... r...|
-00000030  9c 0e 70 25 84 2c 09 a6  4f 19 c0 ed 44 d6 98 13  |..p%.,..O...D...|
-00000040  97 f6 19 08 d4 b6 d3 ad  82 96 ef db c0 2f 00 00  |............./..|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
-00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
-00000080  3f e2 5b ea a6 30 0d 06  09 2a 86 48 86 f7 0d 01  |?.[..0...*.H....|
-00000090  01 0b 05 00 30 1f 31 0b  30 09 06 03 55 04 0a 13  |....0.1.0...U...|
-000000a0  02 47 6f 31 10 30 0e 06  03 55 04 03 13 07 47 6f  |.Go1.0...U....Go|
-000000b0  20 52 6f 6f 74 30 1e 17  0d 31 36 30 31 30 31 30  | Root0...1601010|
-000000c0  30 30 30 30 30 5a 17 0d  32 35 30 31 30 31 30 30  |00000Z..25010100|
-000000d0  30 30 30 30 5a 30 1a 31  0b 30 09 06 03 55 04 0a  |0000Z0.1.0...U..|
-000000e0  13 02 47 6f 31 0b 30 09  06 03 55 04 03 13 02 47  |..Go1.0...U....G|
-000000f0  6f 30 81 9f 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |o0..0...*.H.....|
-00000100  01 05 00 03 81 8d 00 30  81 89 02 81 81 00 db 46  |.......0.......F|
-00000110  7d 93 2e 12 27 06 48 bc  06 28 21 ab 7e c4 b6 a2  |}...'.H..(!.~...|
-00000120  5d fe 1e 52 45 88 7a 36  47 a5 08 0d 92 42 5b c2  |]..RE.z6G....B[.|
-00000130  81 c0 be 97 79 98 40 fb  4f 6d 14 fd 2b 13 8b c2  |....y.@.Om..+...|
-00000140  a5 2e 67 d8 d4 09 9e d6  22 38 b7 4a 0b 74 73 2b  |..g....."8.J.ts+|
-00000150  c2 34 f1 d1 93 e5 96 d9  74 7b f3 58 9f 6c 61 3c  |.4......t{.X.la<|
-00000160  c0 b0 41 d4 d9 2b 2b 24  23 77 5b 1c 3b bd 75 5d  |..A..++$#w[.;.u]|
-00000170  ce 20 54 cf a1 63 87 1d  1e 24 c4 f3 1d 1a 50 8b  |. T..c...$....P.|
-00000180  aa b6 14 43 ed 97 a7 75  62 f4 14 c8 52 d7 02 03  |...C...ub...R...|
-00000190  01 00 01 a3 81 93 30 81  90 30 0e 06 03 55 1d 0f  |......0..0...U..|
-000001a0  01 01 ff 04 04 03 02 05  a0 30 1d 06 03 55 1d 25  |.........0...U.%|
-000001b0  04 16 30 14 06 08 2b 06  01 05 05 07 03 01 06 08  |..0...+.........|
-000001c0  2b 06 01 05 05 07 03 02  30 0c 06 03 55 1d 13 01  |+.......0...U...|
-000001d0  01 ff 04 02 30 00 30 19  06 03 55 1d 0e 04 12 04  |....0.0...U.....|
-000001e0  10 9f 91 16 1f 43 43 3e  49 a6 de 6d b6 80 d7 9f  |.....CC>I..m....|
-000001f0  60 30 1b 06 03 55 1d 23  04 14 30 12 80 10 48 13  |`0...U.#..0...H.|
-00000200  49 4d 13 7e 16 31 bb a3  01 d5 ac ab 6e 7b 30 19  |IM.~.1......n{0.|
-00000210  06 03 55 1d 11 04 12 30  10 82 0e 65 78 61 6d 70  |..U....0...examp|
-00000220  6c 65 2e 67 6f 6c 61 6e  67 30 0d 06 09 2a 86 48  |le.golang0...*.H|
-00000230  86 f7 0d 01 01 0b 05 00  03 81 81 00 9d 30 cc 40  |.............0.@|
-00000240  2b 5b 50 a0 61 cb ba e5  53 58 e1 ed 83 28 a9 58  |+[P.a...SX...(.X|
-00000250  1a a9 38 a4 95 a1 ac 31  5a 1a 84 66 3d 43 d3 2d  |..8....1Z..f=C.-|
-00000260  d9 0b f2 97 df d3 20 64  38 92 24 3a 00 bc cf 9c  |...... d8.$:....|
-00000270  7d b7 40 20 01 5f aa d3  16 61 09 a2 76 fd 13 c3  |}.@ ._...a..v...|
-00000280  cc e1 0c 5c ee b1 87 82  f1 6c 04 ed 73 bb b3 43  |...\.....l..s..C|
-00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
-000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
-000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 21 1b d1 91 16 9c c1  |........ !......|
-000002d0  51 52 39 07 6b 6d ab 07  28 f7 d0 ae 02 13 5e 73  |QR9.km..(.....^s|
-000002e0  5b 51 30 96 27 57 56 e5  37 08 04 00 80 6a 13 82  |[Q0.'WV.7....j..|
-000002f0  97 81 ea 32 51 cb cb 8e  3b ee e5 dd 4f 80 20 50  |...2Q...;...O. P|
-00000300  c9 f0 19 9b d5 1b ae 21  f7 e6 24 4e a3 22 ec b9  |.......!..$N."..|
-00000310  25 6e 77 19 12 08 16 8a  c7 c1 db 29 e9 be 05 55  |%nw........)...U|
-00000320  09 c1 6e 44 c3 d7 bd 18  80 c8 1f 42 53 3b e6 09  |..nD.......BS;..|
-00000330  00 29 20 c4 94 04 97 6f  f7 e6 f4 3b 66 77 2f e5  |.) ....o...;fw/.|
-00000340  de 96 6f c3 67 c5 ce 4b  5e 4b 0e 90 02 fc 32 7f  |..o.g..K^K....2.|
-00000350  71 f4 63 76 37 57 75 30  fb 1b f5 99 98 5f c3 b1  |q.cv7Wu0....._..|
-00000360  fb e3 76 ad 8e 2f 7a 72  86 ed 34 18 98 16 03 03  |..v../zr..4.....|
-00000370  00 3a 0d 00 00 36 03 01  02 40 00 2e 04 03 05 03  |.:...6...@......|
-00000380  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
-00000390  08 06 04 01 05 01 06 01  03 03 02 03 03 01 02 01  |................|
-000003a0  03 02 02 02 04 02 05 02  06 02 00 00 16 03 03 00  |................|
-000003b0  04 0e 00 00 00                                    |.....|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 04 e5 45 68 3b  |....]...Y....Eh;|
+00000010  73 6e 96 92 17 2a e1 5e  f8 6a 16 a1 5e a9 55 d0  |sn...*.^.j..^.U.|
+00000020  f5 2a 30 1d 94 96 5b 76  d4 c3 d5 20 2b 8a eb 6d  |.*0...[v... +..m|
+00000030  9c 5a 72 4e a9 df e0 5b  91 7e eb c7 e4 12 6d 1d  |.ZrN...[.~....m.|
+00000040  a5 3f 54 e2 27 dd 07 4f  df be b2 e7 c0 2f 00 00  |.?T.'..O...../..|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
+00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
+00000080  00 e8 f0 9d 3f e2 5b ea  a6 30 0d 06 09 2a 86 48  |....?.[..0...*.H|
+00000090  86 f7 0d 01 01 0b 05 00  30 1f 31 0b 30 09 06 03  |........0.1.0...|
+000000a0  55 04 0a 13 02 47 6f 31  10 30 0e 06 03 55 04 03  |U....Go1.0...U..|
+000000b0  13 07 47 6f 20 52 6f 6f  74 30 1e 17 0d 31 36 30  |..Go Root0...160|
+000000c0  31 30 31 30 30 30 30 30  30 5a 17 0d 32 35 30 31  |101000000Z..2501|
+000000d0  30 31 30 30 30 30 30 30  5a 30 1a 31 0b 30 09 06  |01000000Z0.1.0..|
+000000e0  03 55 04 0a 13 02 47 6f  31 0b 30 09 06 03 55 04  |.U....Go1.0...U.|
+000000f0  03 13 02 47 6f 30 81 9f  30 0d 06 09 2a 86 48 86  |...Go0..0...*.H.|
+00000100  f7 0d 01 01 01 05 00 03  81 8d 00 30 81 89 02 81  |...........0....|
+00000110  81 00 db 46 7d 93 2e 12  27 06 48 bc 06 28 21 ab  |...F}...'.H..(!.|
+00000120  7e c4 b6 a2 5d fe 1e 52  45 88 7a 36 47 a5 08 0d  |~...]..RE.z6G...|
+00000130  92 42 5b c2 81 c0 be 97  79 98 40 fb 4f 6d 14 fd  |.B[.....y.@.Om..|
+00000140  2b 13 8b c2 a5 2e 67 d8  d4 09 9e d6 22 38 b7 4a  |+.....g....."8.J|
+00000150  0b 74 73 2b c2 34 f1 d1  93 e5 96 d9 74 7b f3 58  |.ts+.4......t{.X|
+00000160  9f 6c 61 3c c0 b0 41 d4  d9 2b 2b 24 23 77 5b 1c  |.la<..A..++$#w[.|
+00000170  3b bd 75 5d ce 20 54 cf  a1 63 87 1d 1e 24 c4 f3  |;.u]. T..c...$..|
+00000180  1d 1a 50 8b aa b6 14 43  ed 97 a7 75 62 f4 14 c8  |..P....C...ub...|
+00000190  52 d7 02 03 01 00 01 a3  81 93 30 81 90 30 0e 06  |R.........0..0..|
+000001a0  03 55 1d 0f 01 01 ff 04  04 03 02 05 a0 30 1d 06  |.U...........0..|
+000001b0  03 55 1d 25 04 16 30 14  06 08 2b 06 01 05 05 07  |.U.%..0...+.....|
+000001c0  03 01 06 08 2b 06 01 05  05 07 03 02 30 0c 06 03  |....+.......0...|
+000001d0  55 1d 13 01 01 ff 04 02  30 00 30 19 06 03 55 1d  |U.......0.0...U.|
+000001e0  0e 04 12 04 10 9f 91 16  1f 43 43 3e 49 a6 de 6d  |.........CC>I..m|
+000001f0  b6 80 d7 9f 60 30 1b 06  03 55 1d 23 04 14 30 12  |....`0...U.#..0.|
+00000200  80 10 48 13 49 4d 13 7e  16 31 bb a3 01 d5 ac ab  |..H.IM.~.1......|
+00000210  6e 7b 30 19 06 03 55 1d  11 04 12 30 10 82 0e 65  |n{0...U....0...e|
+00000220  78 61 6d 70 6c 65 2e 67  6f 6c 61 6e 67 30 0d 06  |xample.golang0..|
+00000230  09 2a 86 48 86 f7 0d 01  01 0b 05 00 03 81 81 00  |.*.H............|
+00000240  9d 30 cc 40 2b 5b 50 a0  61 cb ba e5 53 58 e1 ed  |.0.@+[P.a...SX..|
+00000250  83 28 a9 58 1a a9 38 a4  95 a1 ac 31 5a 1a 84 66  |.(.X..8....1Z..f|
+00000260  3d 43 d3 2d d9 0b f2 97  df d3 20 64 38 92 24 3a  |=C.-...... d8.$:|
+00000270  00 bc cf 9c 7d b7 40 20  01 5f aa d3 16 61 09 a2  |....}.@ ._...a..|
+00000280  76 fd 13 c3 cc e1 0c 5c  ee b1 87 82 f1 6c 04 ed  |v......\.....l..|
+00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
+000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
+000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 77 dc b7  |............ w..|
+000002d0  44 64 c9 3b e9 e2 bf b5  01 47 c9 64 f8 ef ee 33  |Dd.;.....G.d...3|
+000002e0  e2 81 a1 af 05 c0 31 37  1f 8d 3c 55 45 08 04 00  |......17..<UE...|
+000002f0  80 5f fe b0 72 52 a4 24  39 0b ef c5 c0 30 c8 21  |._..rR.$9....0.!|
+00000300  89 14 a0 08 0a 78 13 5f  68 ab 4b 73 6b cd 82 9b  |.....x._h.Ksk...|
+00000310  d0 4e 4f 3e fb bf 0f a4  6b 32 d0 a6 44 dc be 0d  |.NO>....k2..D...|
+00000320  54 7e 57 74 92 a3 4e f9  cf 70 52 b1 50 9a 60 4f  |T~Wt..N..pR.P.`O|
+00000330  79 72 5d c4 53 ba 19 ff  05 56 1d 41 be 18 77 71  |yr].S....V.A..wq|
+00000340  5c 00 84 5e 70 fa cf 9e  8e d2 62 7d 48 6a fe 75  |\..^p.....b}Hj.u|
+00000350  6a 67 5b 82 52 76 d4 fc  96 a4 ad fa a9 ea fc e5  |jg[.Rv..........|
+00000360  97 dd 53 a0 ef 53 00 27  72 ae 5b c9 06 f6 43 c8  |..S..S.'r.[...C.|
+00000370  d5 16 03 03 00 3a 0d 00  00 36 03 01 02 40 00 2e  |.....:...6...@..|
+00000380  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
+00000390  08 04 08 05 08 06 04 01  05 01 06 01 03 03 02 03  |................|
+000003a0  03 01 02 01 03 02 02 02  04 02 05 02 06 02 00 00  |................|
+000003b0  16 03 03 00 04 0e 00 00  00                       |.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
 00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
@@ -112,26 +113,26 @@
 00000200  e5 35 16 03 03 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
 00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 03 00  |......._X.;t....|
-00000230  88 0f 00 00 84 08 04 00  80 90 53 1e fc 7c 63 b0  |..........S..|c.|
-00000240  98 c5 19 40 fb 4f cf c3  53 51 81 68 54 c7 49 38  |...@.O..SQ.hT.I8|
-00000250  0c 41 f0 12 7d a6 e4 8a  4e 77 97 49 5a 07 7d 30  |.A..}...Nw.IZ.}0|
-00000260  fa df 77 2f 51 cf 37 65  07 0b 2c 91 15 43 1d c9  |..w/Q.7e..,..C..|
-00000270  69 46 e2 26 66 72 98 ec  62 1a 22 ae e8 3e 3a 28  |iF.&fr..b."..>:(|
-00000280  17 83 b9 74 57 59 a2 ec  31 95 17 1f c3 ec 9a 01  |...tWY..1.......|
-00000290  f2 d4 07 d5 ee d5 0e f2  f4 75 3b d6 b8 df aa ad  |.........u;.....|
-000002a0  0b 87 37 30 43 7e c1 b1  e1 0d 7e 90 3d 87 9d 93  |..70C~....~.=...|
-000002b0  d7 06 57 18 5c 12 c2 32  0d 14 03 03 00 01 01 16  |..W.\..2........|
-000002c0  03 03 00 28 00 00 00 00  00 00 00 00 ff 2a ae f8  |...(.........*..|
-000002d0  c9 1c bd 3f 62 0e 68 42  e7 96 ec ee c0 fa 71 34  |...?b.hB......q4|
-000002e0  f1 e2 67 76 82 cf c3 2a  fb b2 5a c1              |..gv...*..Z.|
+00000230  88 0f 00 00 84 08 04 00  80 56 b9 1d 6a ed f4 b2  |.........V..j...|
+00000240  e9 2b 9c 6b a3 18 78 1c  76 18 57 7d a3 05 6f 7e  |.+.k..x.v.W}..o~|
+00000250  36 52 e2 d7 35 f9 c2 2d  81 db ca ee 85 f9 45 d8  |6R..5..-......E.|
+00000260  d7 ec 76 9c 1d 85 b7 38  9d 12 f6 64 dc fe ca 16  |..v....8...d....|
+00000270  2f ad 91 ae b5 a1 18 bf  85 df 07 bc 7b 42 5b 6d  |/...........{B[m|
+00000280  ad 54 c7 ae 42 b0 3b e7  b7 70 b9 80 ef a1 65 e7  |.T..B.;..p....e.|
+00000290  46 aa e4 9a 22 d9 ce 1f  7d 33 b9 62 4d 3d 77 8a  |F..."...}3.bM=w.|
+000002a0  b8 ac 38 64 f0 aa 95 be  be 78 bc ad 94 b8 90 29  |..8d.....x.....)|
+000002b0  72 7f d1 ed f0 bf 79 13  00 14 03 03 00 01 01 16  |r.....y.........|
+000002c0  03 03 00 28 00 00 00 00  00 00 00 00 b6 3d 7b 87  |...(.........={.|
+000002d0  c8 a0 18 96 ec f8 36 f4  4c 18 7e 13 6b 56 1e de  |......6.L.~.kV..|
+000002e0  80 8a 37 1b 4e 84 85 3f  60 e8 50 55              |..7.N..?`.PU|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 da 70 e7 aa 1b  |..........(.p...|
-00000010  6c 66 cb 9b 07 d9 4e 87  6f 87 60 fb 46 f5 e9 33  |lf....N.o.`.F..3|
-00000020  48 59 ff 3e b5 bf 0b 0c  b2 39 79 64 f6 3c 2e 95  |HY.>.....9yd.<..|
-00000030  04 51 87                                          |.Q.|
+00000000  14 03 03 00 01 01 16 03  03 00 28 38 5d b5 b3 a8  |..........(8]...|
+00000010  94 65 de ee 2e e9 4f f3  13 9e ff 0a f4 d2 b0 9e  |.e....O.........|
+00000020  e7 ec 8c 7c 03 8f c3 fc  c6 97 75 5b 96 1d 64 ad  |...|......u[..d.|
+00000030  4f ee dd                                          |O..|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 21 29 d2  |.............!).|
-00000010  27 05 2d b4 a2 bf ea f2  96 8a 61 c9 91 75 9f 0f  |'.-.......a..u..|
-00000020  50 4a 76 15 03 03 00 1a  00 00 00 00 00 00 00 02  |PJv.............|
-00000030  a9 40 eb 86 b2 f0 85 a2  75 bc 4e 09 8c c9 ca 31  |.@......u.N....1|
-00000040  e5 49                                             |.I|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 a5 03 23  |...............#|
+00000010  3a 39 6b b5 e5 71 c8 87  07 b4 c9 79 2b 84 d9 9d  |:9k..q.....y+...|
+00000020  1b 21 26 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.!&.............|
+00000030  f5 e9 fb d2 c8 57 34 45  e1 27 8e 35 6d 36 95 10  |.....W4E.'.5m6..|
+00000040  76 0d                                             |v.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPKCS1v15 b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPKCS1v15
index b8ecfffb91..bf2f5c4e22 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPKCS1v15
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPKCS1v15
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,72 +7,73 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 ad e1 a7 5e 0b  |....Y...U.....^.|
-00000010  b8 bd 9d 05 c2 8e 6c f2  ea 7d a1 c8 32 cc d1 74  |......l..}..2..t|
-00000020  ba 86 75 98 33 27 39 c3  0a 6f 49 20 2b 37 9a 0f  |..u.3'9..oI +7..|
-00000030  9b de 1f 1d 5f 2b 45 29  6c 9b 33 c6 bc c1 15 a4  |...._+E)l.3.....|
-00000040  19 9b 70 6c 15 eb 4a 92  92 5f b7 6b c0 2f 00 00  |..pl..J.._.k./..|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
-00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
-00000080  3f e2 5b ea a6 30 0d 06  09 2a 86 48 86 f7 0d 01  |?.[..0...*.H....|
-00000090  01 0b 05 00 30 1f 31 0b  30 09 06 03 55 04 0a 13  |....0.1.0...U...|
-000000a0  02 47 6f 31 10 30 0e 06  03 55 04 03 13 07 47 6f  |.Go1.0...U....Go|
-000000b0  20 52 6f 6f 74 30 1e 17  0d 31 36 30 31 30 31 30  | Root0...1601010|
-000000c0  30 30 30 30 30 5a 17 0d  32 35 30 31 30 31 30 30  |00000Z..25010100|
-000000d0  30 30 30 30 5a 30 1a 31  0b 30 09 06 03 55 04 0a  |0000Z0.1.0...U..|
-000000e0  13 02 47 6f 31 0b 30 09  06 03 55 04 03 13 02 47  |..Go1.0...U....G|
-000000f0  6f 30 81 9f 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |o0..0...*.H.....|
-00000100  01 05 00 03 81 8d 00 30  81 89 02 81 81 00 db 46  |.......0.......F|
-00000110  7d 93 2e 12 27 06 48 bc  06 28 21 ab 7e c4 b6 a2  |}...'.H..(!.~...|
-00000120  5d fe 1e 52 45 88 7a 36  47 a5 08 0d 92 42 5b c2  |]..RE.z6G....B[.|
-00000130  81 c0 be 97 79 98 40 fb  4f 6d 14 fd 2b 13 8b c2  |....y.@.Om..+...|
-00000140  a5 2e 67 d8 d4 09 9e d6  22 38 b7 4a 0b 74 73 2b  |..g....."8.J.ts+|
-00000150  c2 34 f1 d1 93 e5 96 d9  74 7b f3 58 9f 6c 61 3c  |.4......t{.X.la<|
-00000160  c0 b0 41 d4 d9 2b 2b 24  23 77 5b 1c 3b bd 75 5d  |..A..++$#w[.;.u]|
-00000170  ce 20 54 cf a1 63 87 1d  1e 24 c4 f3 1d 1a 50 8b  |. T..c...$....P.|
-00000180  aa b6 14 43 ed 97 a7 75  62 f4 14 c8 52 d7 02 03  |...C...ub...R...|
-00000190  01 00 01 a3 81 93 30 81  90 30 0e 06 03 55 1d 0f  |......0..0...U..|
-000001a0  01 01 ff 04 04 03 02 05  a0 30 1d 06 03 55 1d 25  |.........0...U.%|
-000001b0  04 16 30 14 06 08 2b 06  01 05 05 07 03 01 06 08  |..0...+.........|
-000001c0  2b 06 01 05 05 07 03 02  30 0c 06 03 55 1d 13 01  |+.......0...U...|
-000001d0  01 ff 04 02 30 00 30 19  06 03 55 1d 0e 04 12 04  |....0.0...U.....|
-000001e0  10 9f 91 16 1f 43 43 3e  49 a6 de 6d b6 80 d7 9f  |.....CC>I..m....|
-000001f0  60 30 1b 06 03 55 1d 23  04 14 30 12 80 10 48 13  |`0...U.#..0...H.|
-00000200  49 4d 13 7e 16 31 bb a3  01 d5 ac ab 6e 7b 30 19  |IM.~.1......n{0.|
-00000210  06 03 55 1d 11 04 12 30  10 82 0e 65 78 61 6d 70  |..U....0...examp|
-00000220  6c 65 2e 67 6f 6c 61 6e  67 30 0d 06 09 2a 86 48  |le.golang0...*.H|
-00000230  86 f7 0d 01 01 0b 05 00  03 81 81 00 9d 30 cc 40  |.............0.@|
-00000240  2b 5b 50 a0 61 cb ba e5  53 58 e1 ed 83 28 a9 58  |+[P.a...SX...(.X|
-00000250  1a a9 38 a4 95 a1 ac 31  5a 1a 84 66 3d 43 d3 2d  |..8....1Z..f=C.-|
-00000260  d9 0b f2 97 df d3 20 64  38 92 24 3a 00 bc cf 9c  |...... d8.$:....|
-00000270  7d b7 40 20 01 5f aa d3  16 61 09 a2 76 fd 13 c3  |}.@ ._...a..v...|
-00000280  cc e1 0c 5c ee b1 87 82  f1 6c 04 ed 73 bb b3 43  |...\.....l..s..C|
-00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
-000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
-000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 ba ad fb 1e 28 95 96  |........ ....(..|
-000002d0  f3 62 9d 97 87 0f fd fc  a9 91 a2 4b 8d 69 ec 8f  |.b.........K.i..|
-000002e0  7d 49 08 6e fe 7d b3 5b  03 04 01 00 80 86 57 23  |}I.n.}.[......W#|
-000002f0  58 bb 9a 50 d8 bb 99 d9  f5 cc 66 43 38 f0 14 8a  |X..P......fC8...|
-00000300  cb 6d 8b c0 83 52 f8 53  75 94 07 e3 12 2c 10 bb  |.m...R.Su....,..|
-00000310  f3 9b 74 84 1f 11 f3 06  c3 f4 df db f0 1e 0a cd  |..t.............|
-00000320  1b 45 18 44 88 67 79 ca  3e 6e 2b 73 c2 10 84 d8  |.E.D.gy.>n+s....|
-00000330  7b c5 2e 81 7d 53 19 46  09 35 35 8b 66 8a a8 cc  |{...}S.F.55.f...|
-00000340  20 ba 20 15 9f d1 27 9c  6b 3c bb 48 79 4a 7e 11  | . ...'.k<.HyJ~.|
-00000350  da e3 26 5b 3a 95 da 4d  bd 86 3e 8c 97 55 7c 22  |..&[:..M..>..U|"|
-00000360  a1 d3 88 61 ae e1 3b 51  25 c6 01 7e 10 16 03 03  |...a..;Q%..~....|
-00000370  00 0c 0d 00 00 08 01 01  00 02 04 01 00 00 16 03  |................|
-00000380  03 00 04 0e 00 00 00                              |.......|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 0d ab 4e 27 0a  |....]...Y....N'.|
+00000010  9c 1b 91 00 41 33 eb a7  d6 84 45 e0 dd f7 8a a1  |....A3....E.....|
+00000020  62 c4 e0 2d 2f 51 4f 33  21 2a 6d 20 24 2d d0 3f  |b..-/QO3!*m $-.?|
+00000030  cc 5a 9c 5f b7 53 54 fc  c7 bf a9 2c 8e 39 16 e4  |.Z._.ST....,.9..|
+00000040  7d 80 72 6b 95 93 51 41  8a da 67 29 c0 2f 00 00  |}.rk..QA..g)./..|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
+00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
+00000080  00 e8 f0 9d 3f e2 5b ea  a6 30 0d 06 09 2a 86 48  |....?.[..0...*.H|
+00000090  86 f7 0d 01 01 0b 05 00  30 1f 31 0b 30 09 06 03  |........0.1.0...|
+000000a0  55 04 0a 13 02 47 6f 31  10 30 0e 06 03 55 04 03  |U....Go1.0...U..|
+000000b0  13 07 47 6f 20 52 6f 6f  74 30 1e 17 0d 31 36 30  |..Go Root0...160|
+000000c0  31 30 31 30 30 30 30 30  30 5a 17 0d 32 35 30 31  |101000000Z..2501|
+000000d0  30 31 30 30 30 30 30 30  5a 30 1a 31 0b 30 09 06  |01000000Z0.1.0..|
+000000e0  03 55 04 0a 13 02 47 6f  31 0b 30 09 06 03 55 04  |.U....Go1.0...U.|
+000000f0  03 13 02 47 6f 30 81 9f  30 0d 06 09 2a 86 48 86  |...Go0..0...*.H.|
+00000100  f7 0d 01 01 01 05 00 03  81 8d 00 30 81 89 02 81  |...........0....|
+00000110  81 00 db 46 7d 93 2e 12  27 06 48 bc 06 28 21 ab  |...F}...'.H..(!.|
+00000120  7e c4 b6 a2 5d fe 1e 52  45 88 7a 36 47 a5 08 0d  |~...]..RE.z6G...|
+00000130  92 42 5b c2 81 c0 be 97  79 98 40 fb 4f 6d 14 fd  |.B[.....y.@.Om..|
+00000140  2b 13 8b c2 a5 2e 67 d8  d4 09 9e d6 22 38 b7 4a  |+.....g....."8.J|
+00000150  0b 74 73 2b c2 34 f1 d1  93 e5 96 d9 74 7b f3 58  |.ts+.4......t{.X|
+00000160  9f 6c 61 3c c0 b0 41 d4  d9 2b 2b 24 23 77 5b 1c  |.la<..A..++$#w[.|
+00000170  3b bd 75 5d ce 20 54 cf  a1 63 87 1d 1e 24 c4 f3  |;.u]. T..c...$..|
+00000180  1d 1a 50 8b aa b6 14 43  ed 97 a7 75 62 f4 14 c8  |..P....C...ub...|
+00000190  52 d7 02 03 01 00 01 a3  81 93 30 81 90 30 0e 06  |R.........0..0..|
+000001a0  03 55 1d 0f 01 01 ff 04  04 03 02 05 a0 30 1d 06  |.U...........0..|
+000001b0  03 55 1d 25 04 16 30 14  06 08 2b 06 01 05 05 07  |.U.%..0...+.....|
+000001c0  03 01 06 08 2b 06 01 05  05 07 03 02 30 0c 06 03  |....+.......0...|
+000001d0  55 1d 13 01 01 ff 04 02  30 00 30 19 06 03 55 1d  |U.......0.0...U.|
+000001e0  0e 04 12 04 10 9f 91 16  1f 43 43 3e 49 a6 de 6d  |.........CC>I..m|
+000001f0  b6 80 d7 9f 60 30 1b 06  03 55 1d 23 04 14 30 12  |....`0...U.#..0.|
+00000200  80 10 48 13 49 4d 13 7e  16 31 bb a3 01 d5 ac ab  |..H.IM.~.1......|
+00000210  6e 7b 30 19 06 03 55 1d  11 04 12 30 10 82 0e 65  |n{0...U....0...e|
+00000220  78 61 6d 70 6c 65 2e 67  6f 6c 61 6e 67 30 0d 06  |xample.golang0..|
+00000230  09 2a 86 48 86 f7 0d 01  01 0b 05 00 03 81 81 00  |.*.H............|
+00000240  9d 30 cc 40 2b 5b 50 a0  61 cb ba e5 53 58 e1 ed  |.0.@+[P.a...SX..|
+00000250  83 28 a9 58 1a a9 38 a4  95 a1 ac 31 5a 1a 84 66  |.(.X..8....1Z..f|
+00000260  3d 43 d3 2d d9 0b f2 97  df d3 20 64 38 92 24 3a  |=C.-...... d8.$:|
+00000270  00 bc cf 9c 7d b7 40 20  01 5f aa d3 16 61 09 a2  |....}.@ ._...a..|
+00000280  76 fd 13 c3 cc e1 0c 5c  ee b1 87 82 f1 6c 04 ed  |v......\.....l..|
+00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
+000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
+000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 94 9e e3  |............ ...|
+000002d0  41 3b c6 0c cc 05 92 ac  ea 8c 9e 2d e5 bc 42 30  |A;.........-..B0|
+000002e0  47 87 d6 b3 6e d5 73 9f  ca 2a 48 9a 04 04 01 00  |G...n.s..*H.....|
+000002f0  80 d6 f2 ef 4a 3f ca 47  9a 13 e4 38 3b d8 23 77  |....J?.G...8;.#w|
+00000300  b4 84 fa 89 c4 e6 e2 84  e2 a7 50 81 e4 b2 b8 1f  |..........P.....|
+00000310  04 15 0d 50 5f 4a 95 e3  0d 27 c3 2f 96 9b 92 c0  |...P_J...'./....|
+00000320  fb 6a 52 c1 a4 39 39 7e  8f da 53 5e 34 db 62 01  |.jR..99~..S^4.b.|
+00000330  6d 0a 14 bd b5 0a 24 b5  df b2 99 56 cd 68 a6 75  |m.....$....V.h.u|
+00000340  9f 70 1a f6 d3 6b f6 68  ef bc 75 09 69 c4 18 4a  |.p...k.h..u.i..J|
+00000350  dc 51 c2 65 01 36 f1 c0  d9 34 66 d1 c2 dc d9 0d  |.Q.e.6...4f.....|
+00000360  f5 74 4f 84 df b0 c2 d2  0a d6 51 fc 6e 3c d8 74  |.tO.......Q.n<.t|
+00000370  35 16 03 03 00 0c 0d 00  00 08 01 01 00 02 04 01  |5...............|
+00000380  00 00 16 03 03 00 04 0e  00 00 00                 |...........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
 00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
@@ -109,26 +110,26 @@
 00000200  e5 35 16 03 03 00 25 10  00 00 21 20 2f e5 7d a3  |.5....%...! /.}.|
 00000210  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 00000220  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 16 03 03 00  |......._X.;t....|
-00000230  88 0f 00 00 84 04 01 00  80 12 a4 42 13 85 6f 92  |...........B..o.|
-00000240  6d 26 5d 05 3c b7 80 ab  a9 e0 74 3d 89 67 79 a0  |m&].<.....t=.gy.|
-00000250  9f e1 a9 20 d8 82 e2 22  99 38 03 fe 32 d9 1f c7  |... ...".8..2...|
-00000260  39 1e 27 31 59 05 eb aa  bc 2c 10 eb f0 82 65 65  |9.'1Y....,....ee|
-00000270  ce b2 e9 83 67 21 43 03  19 2d 14 9f c3 db bc dc  |....g!C..-......|
-00000280  59 66 95 d7 4e 09 3c f0  f2 4a 39 f7 db c4 0c 4e  |Yf..N.<..J9....N|
-00000290  73 e2 d6 59 f1 bc 06 d8  75 df 32 b7 f1 b4 01 98  |s..Y....u.2.....|
-000002a0  4f 93 43 a3 a6 09 da cd  1c ee 26 65 ab d1 2a 56  |O.C.......&e..*V|
-000002b0  74 32 24 46 27 f3 d9 6a  df 14 03 03 00 01 01 16  |t2$F'..j........|
-000002c0  03 03 00 28 00 00 00 00  00 00 00 00 68 27 5e 44  |...(........h'^D|
-000002d0  d7 73 26 f6 51 86 01 f5  f3 5d 61 a0 05 cd c3 00  |.s&.Q....]a.....|
-000002e0  85 6f ea 56 85 1e 7a c3  4c d3 6d 64              |.o.V..z.L.md|
+00000230  88 0f 00 00 84 04 01 00  80 81 fe 69 7d 68 10 74  |...........i}h.t|
+00000240  e4 9a d0 11 7a c4 e4 11  4c 7c 8a 13 f1 cf 0e 33  |....z...L|.....3|
+00000250  a5 3d d2 1f a2 73 c4 8e  2d 9e 87 45 b6 d2 dc 98  |.=...s..-..E....|
+00000260  fe 4d 86 8d ad 87 a8 2c  e3 9f 08 a0 4f 78 4d 9c  |.M.....,....OxM.|
+00000270  de c2 92 7e dc 48 6b a9  e7 cc 58 a9 45 41 04 fb  |...~.Hk...X.EA..|
+00000280  48 fa d1 e4 5c 71 92 d5  bf e4 92 a1 66 07 b8 73  |H...\q......f..s|
+00000290  b0 45 98 12 8e d8 2d e8  3e 85 05 e5 d3 38 ea 3a  |.E....-.>....8.:|
+000002a0  5d 33 4a 32 f9 ff 8b 18  ae 55 b7 f3 d2 0e e7 b8  |]3J2.....U......|
+000002b0  4e e8 bc 4f c6 a3 65 c1  a1 14 03 03 00 01 01 16  |N..O..e.........|
+000002c0  03 03 00 28 00 00 00 00  00 00 00 00 da 49 06 a7  |...(.........I..|
+000002d0  0e a4 7a df 94 f1 57 43  21 ef 85 ee 9f 52 f2 03  |..z...WC!....R..|
+000002e0  5a 79 58 7a a0 b2 1f 9e  1d f9 5a d3              |ZyXz......Z.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 81 f3 33 d8 2a  |..........(..3.*|
-00000010  57 45 53 2c ee 68 8b 79  ed 07 dc 90 c3 a7 84 38  |WES,.h.y.......8|
-00000020  8c 33 03 e9 c6 51 04 b2  73 8a 8b 81 12 eb 6c 5f  |.3...Q..s.....l_|
-00000030  a3 8f 5e                                          |..^|
+00000000  14 03 03 00 01 01 16 03  03 00 28 22 7a 58 97 ef  |..........("zX..|
+00000010  f2 e6 4a c1 10 ca 63 52  e0 82 87 b4 9d d5 2f c4  |..J...cR....../.|
+00000020  68 f1 4a d5 e8 ae 3a 22  9e f7 b3 07 8f a4 8c 18  |h.J...:"........|
+00000030  2c 44 65                                          |,De|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 e5 c6 d7  |................|
-00000010  4d e0 d1 0c ff a0 66 c4  71 53 af 7e 16 01 3d 2e  |M.....f.qS.~..=.|
-00000020  6c ab 90 15 03 03 00 1a  00 00 00 00 00 00 00 02  |l...............|
-00000030  92 12 87 24 c8 7e 74 23  df f7 23 49 01 9a dd 3b  |...$.~t#..#I...;|
-00000040  2c 68                                             |,h|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 2c ee 44  |.............,.D|
+00000010  2d 89 8f 1f bd c2 de ac  8b 3c f2 35 d1 bd 17 4e  |-........<.5...N|
+00000020  65 3c 47 15 03 03 00 1a  00 00 00 00 00 00 00 02  |e<G.............|
+00000030  d3 45 69 d3 9e 36 be 2c  0e ac c8 d6 00 30 4f 96  |.Ei..6.,.....0O.|
+00000040  40 50                                             |@P|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPSS b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPSS
index de05fec53e..8f71f9502b 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPSS
+++ b/src/crypto/tls/testdata/Client-TLSv12-ClientCert-RSA-RSAPSS
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,73 +7,74 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 61 fe 1e 35 33  |....Y...U..a..53|
-00000010  4b b4 dd 9b 0f 55 58 f4  0c c5 b2 73 51 7b 84 e7  |K....UX....sQ{..|
-00000020  25 f7 8f 12 5a 12 11 e1  7b e6 52 20 ad 86 a9 f9  |%...Z...{.R ....|
-00000030  7f 6a 30 da 79 23 c3 c4  dc 88 f6 19 1d cc 16 8b  |.j0.y#..........|
-00000040  96 74 84 ce 53 56 65 e2  cb 94 61 0c c0 2f 00 00  |.t..SVe...a../..|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  03 02 66 0b 00 02 62 00  02 5f 00 02 5c 30 82 02  |..f...b.._..\0..|
-00000070  58 30 82 01 8d a0 03 02  01 02 02 11 00 f2 99 26  |X0.............&|
-00000080  eb 87 ea 8a 0d b9 fc c2  47 34 7c 11 b0 30 41 06  |........G4|..0A.|
-00000090  09 2a 86 48 86 f7 0d 01  01 0a 30 34 a0 0f 30 0d  |.*.H......04..0.|
-000000a0  06 09 60 86 48 01 65 03  04 02 01 05 00 a1 1c 30  |..`.H.e........0|
-000000b0  1a 06 09 2a 86 48 86 f7  0d 01 01 08 30 0d 06 09  |...*.H......0...|
-000000c0  60 86 48 01 65 03 04 02  01 05 00 a2 03 02 01 20  |`.H.e.......... |
-000000d0  30 12 31 10 30 0e 06 03  55 04 0a 13 07 41 63 6d  |0.1.0...U....Acm|
-000000e0  65 20 43 6f 30 1e 17 0d  31 37 31 31 32 33 31 36  |e Co0...17112316|
-000000f0  31 36 31 30 5a 17 0d 31  38 31 31 32 33 31 36 31  |1610Z..181123161|
-00000100  36 31 30 5a 30 12 31 10  30 0e 06 03 55 04 0a 13  |610Z0.1.0...U...|
-00000110  07 41 63 6d 65 20 43 6f  30 81 9f 30 0d 06 09 2a  |.Acme Co0..0...*|
-00000120  86 48 86 f7 0d 01 01 01  05 00 03 81 8d 00 30 81  |.H............0.|
-00000130  89 02 81 81 00 db 46 7d  93 2e 12 27 06 48 bc 06  |......F}...'.H..|
-00000140  28 21 ab 7e c4 b6 a2 5d  fe 1e 52 45 88 7a 36 47  |(!.~...]..RE.z6G|
-00000150  a5 08 0d 92 42 5b c2 81  c0 be 97 79 98 40 fb 4f  |....B[.....y.@.O|
-00000160  6d 14 fd 2b 13 8b c2 a5  2e 67 d8 d4 09 9e d6 22  |m..+.....g....."|
-00000170  38 b7 4a 0b 74 73 2b c2  34 f1 d1 93 e5 96 d9 74  |8.J.ts+.4......t|
-00000180  7b f3 58 9f 6c 61 3c c0  b0 41 d4 d9 2b 2b 24 23  |{.X.la<..A..++$#|
-00000190  77 5b 1c 3b bd 75 5d ce  20 54 cf a1 63 87 1d 1e  |w[.;.u]. T..c...|
-000001a0  24 c4 f3 1d 1a 50 8b aa  b6 14 43 ed 97 a7 75 62  |$....P....C...ub|
-000001b0  f4 14 c8 52 d7 02 03 01  00 01 a3 46 30 44 30 0e  |...R.......F0D0.|
-000001c0  06 03 55 1d 0f 01 01 ff  04 04 03 02 05 a0 30 13  |..U...........0.|
-000001d0  06 03 55 1d 25 04 0c 30  0a 06 08 2b 06 01 05 05  |..U.%..0...+....|
-000001e0  07 03 01 30 0c 06 03 55  1d 13 01 01 ff 04 02 30  |...0...U.......0|
-000001f0  00 30 0f 06 03 55 1d 11  04 08 30 06 87 04 7f 00  |.0...U....0.....|
-00000200  00 01 30 41 06 09 2a 86  48 86 f7 0d 01 01 0a 30  |..0A..*.H......0|
-00000210  34 a0 0f 30 0d 06 09 60  86 48 01 65 03 04 02 01  |4..0...`.H.e....|
-00000220  05 00 a1 1c 30 1a 06 09  2a 86 48 86 f7 0d 01 01  |....0...*.H.....|
-00000230  08 30 0d 06 09 60 86 48  01 65 03 04 02 01 05 00  |.0...`.H.e......|
-00000240  a2 03 02 01 20 03 81 81  00 cd ac 4e f2 ce 5f 8d  |.... ......N.._.|
-00000250  79 88 10 42 70 7f 7c bf  1b 5a 8a 00 ef 19 15 4b  |y..Bp.|..Z.....K|
-00000260  40 15 17 71 00 6c d4 16  26 e5 49 6d 56 da 0c 1a  |@..q.l..&.ImV...|
-00000270  13 9f d8 46 95 59 3c b6  7f 87 76 5e 18 aa 03 ea  |...F.Y<...v^....|
-00000280  06 75 22 dd 78 d2 a5 89  b8 c9 23 64 e1 28 38 ce  |.u".x.....#d.(8.|
-00000290  34 6c 6e 06 7b 51 f1 a7  e6 f4 b3 7f fa b1 3f 14  |4ln.{Q........?.|
-000002a0  11 89 66 79 d1 8e 88 0e  0b a0 9e 30 2a c0 67 ef  |..fy.......0*.g.|
-000002b0  ca 46 02 88 e9 53 81 22  69 22 97 ad 80 93 d4 f7  |.F...S."i"......|
-000002c0  dd 70 14 24 d7 70 0a 46  a1 16 03 03 00 ac 0c 00  |.p.$.p.F........|
-000002d0  00 a8 03 00 1d 20 e0 90  02 58 37 69 79 d6 78 e5  |..... ...X7iy.x.|
-000002e0  1d c6 7e a0 c6 38 1b ff  47 72 d6 c2 52 cb 6c 52  |..~..8..Gr..R.lR|
-000002f0  36 7e 03 c3 35 1d 08 04  00 80 79 5f 23 fd b1 ee  |6~..5.....y_#...|
-00000300  ac 62 c8 72 09 52 1f 9a  0f ac 95 3e 4e e4 97 d2  |.b.r.R.....>N...|
-00000310  a3 04 ae 19 3f 25 ad 3e  b7 78 1f d9 79 5f c8 26  |....?%.>.x..y_.&|
-00000320  f0 26 e5 ee 54 46 4a 05  84 15 01 4f 7a 7e 60 bd  |.&..TFJ....Oz~`.|
-00000330  86 74 78 d7 7c 86 91 2b  4f 76 b6 aa 78 27 c8 21  |.tx.|..+Ov..x'.!|
-00000340  7e df 88 2f 26 f0 9d 3c  a2 e8 95 f6 9f 5a a4 5e  |~../&..<.....Z.^|
-00000350  18 dc cd 0d 70 e8 85 b7  e5 57 f6 c2 f4 33 28 1c  |....p....W...3(.|
-00000360  58 7b 94 b0 9e ee d8 b3  42 b5 f3 63 78 a1 30 f3  |X{......B..cx.0.|
-00000370  f7 e4 5e 72 64 6f 80 32  70 4e 16 03 03 00 0c 0d  |..^rdo.2pN......|
-00000380  00 00 08 01 01 00 02 08  04 00 00 16 03 03 00 04  |................|
-00000390  0e 00 00 00                                       |....|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 87 97 ae 0d d7  |....]...Y.......|
+00000010  e4 be cd c5 ca 90 a8 85  23 c8 e3 32 15 f4 29 d8  |........#..2..).|
+00000020  47 d7 ae e7 d8 7b 71 f5  c4 ea 07 20 e4 fd d6 48  |G....{q.... ...H|
+00000030  10 13 e0 9b 06 e1 d7 b1  93 94 38 16 b7 a0 ef 80  |..........8.....|
+00000040  2e b7 67 d6 ff 73 99 bf  67 cc 62 a1 c0 2f 00 00  |..g..s..g.b../..|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 03 02 66 0b  00 02 62 00 02 5f 00 02  |......f...b.._..|
+00000070  5c 30 82 02 58 30 82 01  8d a0 03 02 01 02 02 11  |\0..X0..........|
+00000080  00 f2 99 26 eb 87 ea 8a  0d b9 fc c2 47 34 7c 11  |...&........G4|.|
+00000090  b0 30 41 06 09 2a 86 48  86 f7 0d 01 01 0a 30 34  |.0A..*.H......04|
+000000a0  a0 0f 30 0d 06 09 60 86  48 01 65 03 04 02 01 05  |..0...`.H.e.....|
+000000b0  00 a1 1c 30 1a 06 09 2a  86 48 86 f7 0d 01 01 08  |...0...*.H......|
+000000c0  30 0d 06 09 60 86 48 01  65 03 04 02 01 05 00 a2  |0...`.H.e.......|
+000000d0  03 02 01 20 30 12 31 10  30 0e 06 03 55 04 0a 13  |... 0.1.0...U...|
+000000e0  07 41 63 6d 65 20 43 6f  30 1e 17 0d 31 37 31 31  |.Acme Co0...1711|
+000000f0  32 33 31 36 31 36 31 30  5a 17 0d 31 38 31 31 32  |23161610Z..18112|
+00000100  33 31 36 31 36 31 30 5a  30 12 31 10 30 0e 06 03  |3161610Z0.1.0...|
+00000110  55 04 0a 13 07 41 63 6d  65 20 43 6f 30 81 9f 30  |U....Acme Co0..0|
+00000120  0d 06 09 2a 86 48 86 f7  0d 01 01 01 05 00 03 81  |...*.H..........|
+00000130  8d 00 30 81 89 02 81 81  00 db 46 7d 93 2e 12 27  |..0.......F}...'|
+00000140  06 48 bc 06 28 21 ab 7e  c4 b6 a2 5d fe 1e 52 45  |.H..(!.~...]..RE|
+00000150  88 7a 36 47 a5 08 0d 92  42 5b c2 81 c0 be 97 79  |.z6G....B[.....y|
+00000160  98 40 fb 4f 6d 14 fd 2b  13 8b c2 a5 2e 67 d8 d4  |.@.Om..+.....g..|
+00000170  09 9e d6 22 38 b7 4a 0b  74 73 2b c2 34 f1 d1 93  |..."8.J.ts+.4...|
+00000180  e5 96 d9 74 7b f3 58 9f  6c 61 3c c0 b0 41 d4 d9  |...t{.X.la<..A..|
+00000190  2b 2b 24 23 77 5b 1c 3b  bd 75 5d ce 20 54 cf a1  |++$#w[.;.u]. T..|
+000001a0  63 87 1d 1e 24 c4 f3 1d  1a 50 8b aa b6 14 43 ed  |c...$....P....C.|
+000001b0  97 a7 75 62 f4 14 c8 52  d7 02 03 01 00 01 a3 46  |..ub...R.......F|
+000001c0  30 44 30 0e 06 03 55 1d  0f 01 01 ff 04 04 03 02  |0D0...U.........|
+000001d0  05 a0 30 13 06 03 55 1d  25 04 0c 30 0a 06 08 2b  |..0...U.%..0...+|
+000001e0  06 01 05 05 07 03 01 30  0c 06 03 55 1d 13 01 01  |.......0...U....|
+000001f0  ff 04 02 30 00 30 0f 06  03 55 1d 11 04 08 30 06  |...0.0...U....0.|
+00000200  87 04 7f 00 00 01 30 41  06 09 2a 86 48 86 f7 0d  |......0A..*.H...|
+00000210  01 01 0a 30 34 a0 0f 30  0d 06 09 60 86 48 01 65  |...04..0...`.H.e|
+00000220  03 04 02 01 05 00 a1 1c  30 1a 06 09 2a 86 48 86  |........0...*.H.|
+00000230  f7 0d 01 01 08 30 0d 06  09 60 86 48 01 65 03 04  |.....0...`.H.e..|
+00000240  02 01 05 00 a2 03 02 01  20 03 81 81 00 cd ac 4e  |........ ......N|
+00000250  f2 ce 5f 8d 79 88 10 42  70 7f 7c bf 1b 5a 8a 00  |.._.y..Bp.|..Z..|
+00000260  ef 19 15 4b 40 15 17 71  00 6c d4 16 26 e5 49 6d  |...K@..q.l..&.Im|
+00000270  56 da 0c 1a 13 9f d8 46  95 59 3c b6 7f 87 76 5e  |V......F.Y<...v^|
+00000280  18 aa 03 ea 06 75 22 dd  78 d2 a5 89 b8 c9 23 64  |.....u".x.....#d|
+00000290  e1 28 38 ce 34 6c 6e 06  7b 51 f1 a7 e6 f4 b3 7f  |.(8.4ln.{Q......|
+000002a0  fa b1 3f 14 11 89 66 79  d1 8e 88 0e 0b a0 9e 30  |..?...fy.......0|
+000002b0  2a c0 67 ef ca 46 02 88  e9 53 81 22 69 22 97 ad  |*.g..F...S."i"..|
+000002c0  80 93 d4 f7 dd 70 14 24  d7 70 0a 46 a1 16 03 03  |.....p.$.p.F....|
+000002d0  00 ac 0c 00 00 a8 03 00  1d 20 19 11 2f cc 8b d4  |......... ../...|
+000002e0  74 7c 77 34 b0 c7 4f 49  85 d1 f3 b0 2c 0e 83 26  |t|w4..OI....,..&|
+000002f0  ee c1 2c 32 c1 82 43 3c  cd 1b 08 04 00 80 68 33  |..,2..C<......h3|
+00000300  a3 71 38 a8 70 34 04 91  e0 7b b3 44 46 45 54 a9  |.q8.p4...{.DFET.|
+00000310  af ad 50 0d b6 91 7c 87  c7 4c 99 2d 02 9d 57 57  |..P...|..L.-..WW|
+00000320  ae 2a 25 63 82 32 f0 4a  14 cd d3 b4 ca b8 bc d9  |.*%c.2.J........|
+00000330  ff 1e 01 93 20 6e 27 97  04 31 c4 d8 e9 a6 84 1e  |.... n'..1......|
+00000340  96 6c a6 25 cc 93 e7 2d  15 32 e1 ad 01 7d fb 2c  |.l.%...-.2...}.,|
+00000350  12 04 5d 59 f6 bc 90 e8  cc d7 48 6d 46 c4 ed 64  |..]Y......HmF..d|
+00000360  6b 41 5b 9d 9a 3b c8 11  57 bb b8 b1 cb c6 54 d6  |kA[..;..W.....T.|
+00000370  08 34 7e ad e3 59 7b f7  90 77 e6 50 95 aa 16 03  |.4~..Y{..w.P....|
+00000380  03 00 0c 0d 00 00 08 01  01 00 02 08 04 00 00 16  |................|
+00000390  03 03 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 02 66 0b 00 02  62 00 02 5f 00 02 5c 30  |....f...b.._..\0|
 00000010  82 02 58 30 82 01 8d a0  03 02 01 02 02 11 00 f2  |..X0............|
@@ -117,26 +118,26 @@
 00000270  10 00 00 21 20 2f e5 7d  a3 47 cd 62 43 15 28 da  |...! /.}.G.bC.(.|
 00000280  ac 5f bb 29 07 30 ff f6  84 af c4 cf c2 ed 90 99  |._.).0..........|
 00000290  5f 58 cb 3b 74 16 03 03  00 88 0f 00 00 84 08 04  |_X.;t...........|
-000002a0  00 80 b2 c4 60 82 75 ca  be 40 dc 28 ec 6d 14 6f  |....`.u..@.(.m.o|
-000002b0  6c 88 ca 9a d7 ae ce 94  26 a7 10 ad d8 c3 b9 a6  |l.......&.......|
-000002c0  48 4e 01 7d ee 6e f8 e0  15 d9 72 c4 79 8d ac 25  |HN.}.n....r.y..%|
-000002d0  37 29 83 fc e6 f1 2e 4f  76 49 6a 36 b9 1e b4 58  |7).....OvIj6...X|
-000002e0  a2 3e f7 ff 96 5e d9 17  f2 40 05 1f ec bb 5b f5  |.>...^...@....[.|
-000002f0  28 86 d2 fc 0e 7e 70 3a  3d 90 4c 46 a5 3e bc 57  |(....~p:=.LF.>.W|
-00000300  24 4c ee 35 23 99 6f 21  12 db ba d8 3a 5f 37 1f  |$L.5#.o!....:_7.|
-00000310  da 3d c2 c9 bf b6 11 8b  b9 b9 43 0b 52 ff 6d 2a  |.=........C.R.m*|
-00000320  74 a7 14 03 03 00 01 01  16 03 03 00 28 00 00 00  |t...........(...|
-00000330  00 00 00 00 00 34 bd 90  a0 3f 1c 0c 11 5c 8a e4  |.....4...?...\..|
-00000340  28 82 c4 57 59 73 fd a4  dc a9 91 4b df 2a c6 b5  |(..WYs.....K.*..|
-00000350  f0 6e cf 41 70                                    |.n.Ap|
+000002a0  00 80 a2 37 90 1d d9 05  16 91 e6 5d 93 ec d0 4c  |...7.......]...L|
+000002b0  c9 eb ed d3 66 fc 36 55  ee cb e0 bc aa 41 11 fb  |....f.6U.....A..|
+000002c0  91 d5 2c 81 d4 08 ee ce  f8 96 cd 73 20 73 5b 8c  |..,........s s[.|
+000002d0  85 45 17 fa 6d 06 db a6  68 49 5e a8 2b 86 83 0f  |.E..m...hI^.+...|
+000002e0  e2 52 04 96 8c c9 a0 f8  ed 64 51 e3 6e b4 b1 48  |.R.......dQ.n..H|
+000002f0  c7 f6 21 c9 aa c0 8d 01  00 43 14 d3 16 ed 9a 3c  |..!......C.....<|
+00000300  d2 14 57 90 22 f6 52 bc  44 64 88 40 03 93 56 8a  |..W.".R.Dd.@..V.|
+00000310  4f 50 ad 73 ff bc b4 72  cd e2 01 01 50 88 f9 1c  |OP.s...r....P...|
+00000320  4f 4d 14 03 03 00 01 01  16 03 03 00 28 00 00 00  |OM..........(...|
+00000330  00 00 00 00 00 07 15 02  d9 a8 bd 4b c4 61 57 e0  |...........K.aW.|
+00000340  a6 c0 11 05 bc 25 0b 4d  fb 36 c4 19 80 e2 59 3e  |.....%.M.6....Y>|
+00000350  00 a0 7b 87 42                                    |..{.B|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 e2 44 81 59 e4  |..........(.D.Y.|
-00000010  6c cf e2 e7 04 78 61 02  36 29 2c 5c c4 6f 13 0b  |l....xa.6),\.o..|
-00000020  29 ba 74 b0 13 e8 8f 67  39 b5 ea d1 9d 99 d2 f6  |).t....g9.......|
-00000030  f7 32 be                                          |.2.|
+00000000  14 03 03 00 01 01 16 03  03 00 28 8b ae 36 31 a0  |..........(..61.|
+00000010  0a ba f4 e8 45 6d e2 55  8d 9d 61 e4 80 b6 4e bb  |....Em.U..a...N.|
+00000020  8c 7f e0 2b ea fc 4d e7  4c 60 c1 c6 91 92 ef 46  |...+..M.L`.....F|
+00000030  00 19 b9                                          |...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 5c 7b 38  |.............\{8|
-00000010  46 af 57 57 05 5a c5 cb  83 f3 fd 17 d4 c3 2e 93  |F.WW.Z..........|
-00000020  d7 70 52 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.pR.............|
-00000030  df 2b d8 62 ec 97 c6 ab  be d4 7f c9 91 f4 fe 55  |.+.b...........U|
-00000040  ac bd                                             |..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 61 0d 4c  |.............a.L|
+00000010  bf 57 34 f8 b3 f7 33 d6  49 46 66 14 e8 b2 e4 e0  |.W4...3.IFf.....|
+00000020  de 82 d1 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
+00000030  76 2e 52 63 53 26 93 e3  32 59 de d9 62 e8 f4 93  |v.RcS&..2Y..b...|
+00000040  65 bc                                             |e.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES
index d21e9b3704..dd7dfab1c0 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,87 +7,88 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 ec 4a 6a f8 c5  |....Y...U...Jj..|
-00000010  42 65 f9 d3 4f 65 6f 14  6b bd ae a9 82 5d 06 9b  |Be..Oeo.k....]..|
-00000020  9d 03 bb 67 eb ba 52 70  74 c3 01 20 f2 ef 69 54  |...g..Rpt.. ..iT|
-00000030  1f 4b 79 f7 5b d5 08 b4  18 4c af 8e 55 58 45 22  |.Ky.[....L..UXE"|
-00000040  c1 c9 6f cf 36 67 45 20  c7 c5 3a af c0 09 00 00  |..o.6gE ..:.....|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
-00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
-00000080  30 09 06 07 2a 86 48 ce  3d 04 01 30 45 31 0b 30  |0...*.H.=..0E1.0|
-00000090  09 06 03 55 04 06 13 02  41 55 31 13 30 11 06 03  |...U....AU1.0...|
-000000a0  55 04 08 13 0a 53 6f 6d  65 2d 53 74 61 74 65 31  |U....Some-State1|
-000000b0  21 30 1f 06 03 55 04 0a  13 18 49 6e 74 65 72 6e  |!0...U....Intern|
-000000c0  65 74 20 57 69 64 67 69  74 73 20 50 74 79 20 4c  |et Widgits Pty L|
-000000d0  74 64 30 1e 17 0d 31 32  31 31 32 32 31 35 30 36  |td0...1211221506|
-000000e0  33 32 5a 17 0d 32 32 31  31 32 30 31 35 30 36 33  |32Z..22112015063|
-000000f0  32 5a 30 45 31 0b 30 09  06 03 55 04 06 13 02 41  |2Z0E1.0...U....A|
-00000100  55 31 13 30 11 06 03 55  04 08 13 0a 53 6f 6d 65  |U1.0...U....Some|
-00000110  2d 53 74 61 74 65 31 21  30 1f 06 03 55 04 0a 13  |-State1!0...U...|
-00000120  18 49 6e 74 65 72 6e 65  74 20 57 69 64 67 69 74  |.Internet Widgit|
-00000130  73 20 50 74 79 20 4c 74  64 30 81 9b 30 10 06 07  |s Pty Ltd0..0...|
-00000140  2a 86 48 ce 3d 02 01 06  05 2b 81 04 00 23 03 81  |*.H.=....+...#..|
-00000150  86 00 04 00 c4 a1 ed be  98 f9 0b 48 73 36 7e c3  |...........Hs6~.|
-00000160  16 56 11 22 f2 3d 53 c3  3b 4d 21 3d cd 6b 75 e6  |.V.".=S.;M!=.ku.|
-00000170  f6 b0 dc 9a df 26 c1 bc  b2 87 f0 72 32 7c b3 64  |.....&.....r2|.d|
-00000180  2f 1c 90 bc ea 68 23 10  7e fe e3 25 c0 48 3a 69  |/....h#.~..%.H:i|
-00000190  e0 28 6d d3 37 00 ef 04  62 dd 0d a0 9c 70 62 83  |.(m.7...b....pb.|
-000001a0  d8 81 d3 64 31 aa 9e 97  31 bd 96 b0 68 c0 9b 23  |...d1...1...h..#|
-000001b0  de 76 64 3f 1a 5c 7f e9  12 0e 58 58 b6 5f 70 dd  |.vd?.\....XX._p.|
-000001c0  9b d8 ea d5 d7 f5 d5 cc  b9 b6 9f 30 66 5b 66 9a  |...........0f[f.|
-000001d0  20 e2 27 e5 bf fe 3b 30  09 06 07 2a 86 48 ce 3d  | .'...;0...*.H.=|
-000001e0  04 01 03 81 8c 00 30 81  88 02 42 01 88 a2 4f eb  |......0...B...O.|
-000001f0  e2 45 c5 48 7d 1b ac f5  ed 98 9d ae 47 70 c0 5e  |.E.H}.......Gp.^|
-00000200  1b b6 2f bd f1 b6 4d b7  61 40 d3 11 a2 ce ee 0b  |../...M.a@......|
-00000210  7e 92 7e ff 76 9d c3 3b  7e a5 3f ce fa 10 e2 59  |~.~.v..;~.?....Y|
-00000220  ec 47 2d 7c ac da 4e 97  0e 15 a0 6f d0 02 42 01  |.G-|..N....o..B.|
-00000230  4d fc be 67 13 9c 2d 05  0e bd 3f a3 8c 25 c1 33  |M..g..-...?..%.3|
-00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
-00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
-00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 b7 0c 00  00 b3 03 00 1d 20 7f e5  |*............ ..|
-00000280  3b 03 9e 6a 77 11 1b 0f  bc 4a db 44 7c 3b 81 1c  |;..jw....J.D|;..|
-00000290  03 8b 15 a6 f3 16 a0 58  5b 13 c5 1e d2 2c 04 03  |.......X[....,..|
-000002a0  00 8b 30 81 88 02 42 00  cc 7c 76 94 81 89 8f 25  |..0...B..|v....%|
-000002b0  16 e2 a0 0d 80 4f 7a 8f  8c 83 23 53 23 45 9c c1  |.....Oz...#S#E..|
-000002c0  39 e3 0c c2 1b 4d f3 78  cd ea b9 c8 d4 b6 30 bb  |9....M.x......0.|
-000002d0  ff d7 ad 6c b2 fd 62 4d  8a 05 19 cf 58 ec 81 17  |...l..bM....X...|
-000002e0  21 7c 71 a1 d7 ad 87 11  8d 02 42 01 a2 9e c8 e4  |!|q.......B.....|
-000002f0  04 7c 75 22 df 14 97 94  8a 1b a1 34 95 95 dd 4c  |.|u".......4...L|
-00000300  9f 1a c7 c7 96 db ef 87  82 27 9a 27 3a 3d 75 26  |.........'.':=u&|
-00000310  04 47 66 eb 55 60 9f 93  4e b2 09 14 fa 71 5b 3f  |.Gf.U`..N....q[?|
-00000320  33 37 3f 0c f2 5c 4f 1e  cc fa b1 6f 70 16 03 03  |37?..\O....op...|
-00000330  00 04 0e 00 00 00                                 |......|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 53 0a a8 7d 57  |....]...Y..S..}W|
+00000010  28 ed 64 43 b5 dd b2 15  a8 6f 88 09 6a 90 4c 23  |(.dC.....o..j.L#|
+00000020  06 49 b6 1a 56 b5 a0 a2  68 af 7d 20 5a 4a d6 c3  |.I..V...h.} ZJ..|
+00000030  ed 18 12 98 b4 4e f8 f2  df d7 ee 6f e9 c6 c7 82  |.....N.....o....|
+00000040  5c bb 79 70 a5 59 51 c7  7f 41 7e 8e c0 09 00 00  |\.yp.YQ..A~.....|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 03 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
+00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
+00000080  a0 d2 eb f4 30 09 06 07  2a 86 48 ce 3d 04 01 30  |....0...*.H.=..0|
+00000090  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+000000a0  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+000000b0  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+000000c0  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+000000d0  74 79 20 4c 74 64 30 1e  17 0d 31 32 31 31 32 32  |ty Ltd0...121122|
+000000e0  31 35 30 36 33 32 5a 17  0d 32 32 31 31 32 30 31  |150632Z..2211201|
+000000f0  35 30 36 33 32 5a 30 45  31 0b 30 09 06 03 55 04  |50632Z0E1.0...U.|
+00000100  06 13 02 41 55 31 13 30  11 06 03 55 04 08 13 0a  |...AU1.0...U....|
+00000110  53 6f 6d 65 2d 53 74 61  74 65 31 21 30 1f 06 03  |Some-State1!0...|
+00000120  55 04 0a 13 18 49 6e 74  65 72 6e 65 74 20 57 69  |U....Internet Wi|
+00000130  64 67 69 74 73 20 50 74  79 20 4c 74 64 30 81 9b  |dgits Pty Ltd0..|
+00000140  30 10 06 07 2a 86 48 ce  3d 02 01 06 05 2b 81 04  |0...*.H.=....+..|
+00000150  00 23 03 81 86 00 04 00  c4 a1 ed be 98 f9 0b 48  |.#.............H|
+00000160  73 36 7e c3 16 56 11 22  f2 3d 53 c3 3b 4d 21 3d  |s6~..V.".=S.;M!=|
+00000170  cd 6b 75 e6 f6 b0 dc 9a  df 26 c1 bc b2 87 f0 72  |.ku......&.....r|
+00000180  32 7c b3 64 2f 1c 90 bc  ea 68 23 10 7e fe e3 25  |2|.d/....h#.~..%|
+00000190  c0 48 3a 69 e0 28 6d d3  37 00 ef 04 62 dd 0d a0  |.H:i.(m.7...b...|
+000001a0  9c 70 62 83 d8 81 d3 64  31 aa 9e 97 31 bd 96 b0  |.pb....d1...1...|
+000001b0  68 c0 9b 23 de 76 64 3f  1a 5c 7f e9 12 0e 58 58  |h..#.vd?.\....XX|
+000001c0  b6 5f 70 dd 9b d8 ea d5  d7 f5 d5 cc b9 b6 9f 30  |._p............0|
+000001d0  66 5b 66 9a 20 e2 27 e5  bf fe 3b 30 09 06 07 2a  |f[f. .'...;0...*|
+000001e0  86 48 ce 3d 04 01 03 81  8c 00 30 81 88 02 42 01  |.H.=......0...B.|
+000001f0  88 a2 4f eb e2 45 c5 48  7d 1b ac f5 ed 98 9d ae  |..O..E.H}.......|
+00000200  47 70 c0 5e 1b b6 2f bd  f1 b6 4d b7 61 40 d3 11  |Gp.^../...M.a@..|
+00000210  a2 ce ee 0b 7e 92 7e ff  76 9d c3 3b 7e a5 3f ce  |....~.~.v..;~.?.|
+00000220  fa 10 e2 59 ec 47 2d 7c  ac da 4e 97 0e 15 a0 6f  |...Y.G-|..N....o|
+00000230  d0 02 42 01 4d fc be 67  13 9c 2d 05 0e bd 3f a3  |..B.M..g..-...?.|
+00000240  8c 25 c1 33 13 83 0d 94  06 bb d4 37 7a f6 ec 7a  |.%.3.......7z..z|
+00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
+00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
+00000270  95 12 07 8f 2a 16 03 03  00 b7 0c 00 00 b3 03 00  |....*...........|
+00000280  1d 20 f5 a1 40 c1 31 8d  23 ee 2a 95 de 6f 22 a4  |. ..@.1.#.*..o".|
+00000290  98 03 77 82 92 67 0e cd  75 5a ac 95 90 07 70 77  |..w..g..uZ....pw|
+000002a0  c0 5b 04 03 00 8b 30 81  88 02 42 00 92 88 e3 97  |.[....0...B.....|
+000002b0  42 e5 0a ca b7 48 db 4a  f0 a2 1d c7 b8 1b bb 4b  |B....H.J.......K|
+000002c0  ea 5e 6c 40 b7 f7 de e1  b7 e5 b0 5e 8f fd 99 5b  |.^l@.......^...[|
+000002d0  14 e4 4d 55 4b cb cd f7  9a 3a 77 a7 41 cf 15 26  |..MUK....:w.A..&|
+000002e0  79 a5 75 d8 c5 29 64 17  b7 16 7e e4 38 02 42 01  |y.u..)d...~.8.B.|
+000002f0  b2 74 0c 2f 4d 18 e3 88  6e fe 90 59 12 5d 2e ef  |.t./M...n..Y.]..|
+00000300  36 c6 12 04 d5 aa 60 06  83 00 72 93 8c 5c f5 08  |6.....`...r..\..|
+00000310  26 38 f7 f6 64 b1 66 2f  e4 35 cb 56 0c 67 61 1a  |&8..d.f/.5.V.ga.|
+00000320  4d 16 8a ba 28 ba b5 ec  0b 61 38 79 db a3 65 c7  |M...(....a8y..e.|
+00000330  3e 16 03 03 00 04 0e 00  00 00                    |>.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
 00000030  16 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000040  00 00 00 00 00 d6 67 cb  d5 7c 95 9b 16 e2 3b 86  |......g..|....;.|
-00000050  22 bd 8c c7 40 36 9b b6  7e 0a 77 78 38 14 37 3c  |"...@6..~.wx8.7<|
-00000060  48 42 37 a7 07 31 bb 57  c4 e9 f5 e5 a7 58 71 f8  |HB7..1.W.....Xq.|
-00000070  82 f7 12 97 72                                    |....r|
+00000040  00 00 00 00 00 7a 74 f0  c3 20 b7 87 3b 1b a6 86  |.....zt.. ..;...|
+00000050  0a cf c3 b9 0f 3e 40 39  ed 4e e0 db c0 77 69 b6  |.....>@9.N...wi.|
+00000060  79 cb 28 84 1f 88 72 5d  85 df 92 d2 05 ad bd 1b  |y.(...r]........|
+00000070  34 ba 21 ee 46                                    |4.!.F|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 56 45 5c a3 b3  |..........@VE\..|
-00000010  64 43 54 7f b5 90 1a 34  ab 2b 68 25 49 41 bf 78  |dCT....4.+h%IA.x|
-00000020  50 b0 66 35 20 76 e1 d0  5c 8a 82 2e 03 83 cf c6  |P.f5 v..\.......|
-00000030  b7 48 3d 2c c4 cf f5 31  c1 ab 9a 3b 09 3a 75 e3  |.H=,...1...;.:u.|
-00000040  b2 05 fa d9 79 cc 1b 0e  30 44 e1                 |....y...0D.|
+00000000  14 03 03 00 01 01 16 03  03 00 40 f3 23 7b 1c 0b  |..........@.#{..|
+00000010  b3 07 a9 28 3f 33 84 7b  91 9c 7a b2 c2 df 89 6e  |...(?3.{..z....n|
+00000020  aa 54 35 d7 09 ae 61 cf  90 3a 86 cd 7a 00 6b b1  |.T5...a..:..z.k.|
+00000030  1e 7f 55 4c f2 9e e5 4e  69 87 4f a1 eb bb d5 16  |..UL...Ni.O.....|
+00000040  03 11 08 24 1d bc 83 29  4d 48 41                 |...$...)MHA|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 76 5f 1f  ec 55 ec f4 87 06 91 b4  |.....v_..U......|
-00000020  ba 71 4f 7f 9c ce e1 c7  e6 3d 75 05 fd ba 98 c4  |.qO......=u.....|
-00000030  d0 39 24 b8 d4 15 03 03  00 30 00 00 00 00 00 00  |.9$......0......|
-00000040  00 00 00 00 00 00 00 00  00 00 e8 4e 09 a1 5f db  |...........N.._.|
-00000050  91 d5 5b e8 6a 86 7a 6c  7d 4a e1 94 8a 7d 99 52  |..[.j.zl}J...}.R|
-00000060  e6 5d d8 35 7c a0 68 8f  09 f9                    |.].5|.h...|
+00000010  00 00 00 00 00 f7 2c 65  61 5d 89 5d de 8d 42 92  |......,ea].]..B.|
+00000020  91 1e f4 71 39 42 a3 92  91 98 96 9f 95 04 86 99  |...q9B..........|
+00000030  c6 f3 e8 e1 e7 15 03 03  00 30 00 00 00 00 00 00  |.........0......|
+00000040  00 00 00 00 00 00 00 00  00 00 81 23 13 80 00 d8  |...........#....|
+00000050  1a 93 58 38 4d f0 6f 87  43 05 6d 63 6c e8 b9 80  |..X8M.o.C.mcl...|
+00000060  1c 52 12 59 ae ca a6 c8  3c e3                    |.R.Y....<.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM
index 02bad39f16..1b3e1e5690 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,82 +7,83 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 d4 97 12 a8 e7  |....Y...U.......|
-00000010  be a9 2d 80 f0 db 01 49  07 04 f4 d1 02 db 3d 4a  |..-....I......=J|
-00000020  f0 af 31 38 39 d7 4c 1a  d3 74 71 20 0f a3 76 14  |..189.L..tq ..v.|
-00000030  73 ff 25 1b ef 29 b3 5e  0b 8f fe ee a6 19 d3 31  |s.%..).^.......1|
-00000040  5d 2e 71 ab 74 58 e9 d6  c5 9b f4 93 c0 2b 00 00  |].q.tX.......+..|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
-00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
-00000080  30 09 06 07 2a 86 48 ce  3d 04 01 30 45 31 0b 30  |0...*.H.=..0E1.0|
-00000090  09 06 03 55 04 06 13 02  41 55 31 13 30 11 06 03  |...U....AU1.0...|
-000000a0  55 04 08 13 0a 53 6f 6d  65 2d 53 74 61 74 65 31  |U....Some-State1|
-000000b0  21 30 1f 06 03 55 04 0a  13 18 49 6e 74 65 72 6e  |!0...U....Intern|
-000000c0  65 74 20 57 69 64 67 69  74 73 20 50 74 79 20 4c  |et Widgits Pty L|
-000000d0  74 64 30 1e 17 0d 31 32  31 31 32 32 31 35 30 36  |td0...1211221506|
-000000e0  33 32 5a 17 0d 32 32 31  31 32 30 31 35 30 36 33  |32Z..22112015063|
-000000f0  32 5a 30 45 31 0b 30 09  06 03 55 04 06 13 02 41  |2Z0E1.0...U....A|
-00000100  55 31 13 30 11 06 03 55  04 08 13 0a 53 6f 6d 65  |U1.0...U....Some|
-00000110  2d 53 74 61 74 65 31 21  30 1f 06 03 55 04 0a 13  |-State1!0...U...|
-00000120  18 49 6e 74 65 72 6e 65  74 20 57 69 64 67 69 74  |.Internet Widgit|
-00000130  73 20 50 74 79 20 4c 74  64 30 81 9b 30 10 06 07  |s Pty Ltd0..0...|
-00000140  2a 86 48 ce 3d 02 01 06  05 2b 81 04 00 23 03 81  |*.H.=....+...#..|
-00000150  86 00 04 00 c4 a1 ed be  98 f9 0b 48 73 36 7e c3  |...........Hs6~.|
-00000160  16 56 11 22 f2 3d 53 c3  3b 4d 21 3d cd 6b 75 e6  |.V.".=S.;M!=.ku.|
-00000170  f6 b0 dc 9a df 26 c1 bc  b2 87 f0 72 32 7c b3 64  |.....&.....r2|.d|
-00000180  2f 1c 90 bc ea 68 23 10  7e fe e3 25 c0 48 3a 69  |/....h#.~..%.H:i|
-00000190  e0 28 6d d3 37 00 ef 04  62 dd 0d a0 9c 70 62 83  |.(m.7...b....pb.|
-000001a0  d8 81 d3 64 31 aa 9e 97  31 bd 96 b0 68 c0 9b 23  |...d1...1...h..#|
-000001b0  de 76 64 3f 1a 5c 7f e9  12 0e 58 58 b6 5f 70 dd  |.vd?.\....XX._p.|
-000001c0  9b d8 ea d5 d7 f5 d5 cc  b9 b6 9f 30 66 5b 66 9a  |...........0f[f.|
-000001d0  20 e2 27 e5 bf fe 3b 30  09 06 07 2a 86 48 ce 3d  | .'...;0...*.H.=|
-000001e0  04 01 03 81 8c 00 30 81  88 02 42 01 88 a2 4f eb  |......0...B...O.|
-000001f0  e2 45 c5 48 7d 1b ac f5  ed 98 9d ae 47 70 c0 5e  |.E.H}.......Gp.^|
-00000200  1b b6 2f bd f1 b6 4d b7  61 40 d3 11 a2 ce ee 0b  |../...M.a@......|
-00000210  7e 92 7e ff 76 9d c3 3b  7e a5 3f ce fa 10 e2 59  |~.~.v..;~.?....Y|
-00000220  ec 47 2d 7c ac da 4e 97  0e 15 a0 6f d0 02 42 01  |.G-|..N....o..B.|
-00000230  4d fc be 67 13 9c 2d 05  0e bd 3f a3 8c 25 c1 33  |M..g..-...?..%.3|
-00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
-00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
-00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 b7 0c 00  00 b3 03 00 1d 20 a8 15  |*............ ..|
-00000280  13 40 df f8 dc 39 f0 af  90 53 a8 34 a9 61 68 c8  |.@...9...S.4.ah.|
-00000290  ad be 4f 02 0e d2 83 fd  2e 35 bf 8c 8e 13 04 03  |..O......5......|
-000002a0  00 8b 30 81 88 02 42 00  bc 69 df 5b ec 9f 17 ff  |..0...B..i.[....|
-000002b0  e6 e5 24 71 f6 2b a5 88  40 78 12 ef f3 dc 25 a9  |..$q.+..@x....%.|
-000002c0  7c 89 24 0d c7 46 b2 db  ae 72 b4 2a 87 87 fe 7e  ||.$..F...r.*...~|
-000002d0  22 8f e6 d4 c4 7b 61 14  c3 04 39 98 87 6f 1f 54  |"....{a...9..o.T|
-000002e0  e0 50 16 0b 52 8e d6 1e  0a 02 42 00 b7 40 26 a8  |.P..R.....B..@&.|
-000002f0  11 09 77 ec 36 e5 88 26  6d 83 6f e7 c3 b1 98 c3  |..w.6..&m.o.....|
-00000300  4b 83 92 48 65 31 87 68  ee 49 25 ec 95 59 82 b5  |K..He1.h.I%..Y..|
-00000310  93 92 c8 17 d6 d9 1c 99  60 48 1b 18 50 b4 e7 df  |........`H..P...|
-00000320  ed 75 1a f2 08 e8 3d 93  99 27 ef 4d e3 16 03 03  |.u....=..'.M....|
-00000330  00 04 0e 00 00 00                                 |......|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 d8 ac 8a ae 13  |....]...Y.......|
+00000010  8a e4 2d ac c0 a1 a3 d5  32 5b ca 18 5a 73 22 83  |..-.....2[..Zs".|
+00000020  d0 76 39 5c 48 40 b0 3a  75 87 5d 20 fd a3 fd b4  |.v9\H@.:u.] ....|
+00000030  32 cc 05 54 aa 59 cc 76  81 7b 29 c3 bc c6 32 c0  |2..T.Y.v.{)...2.|
+00000040  a9 52 fc ea 08 51 20 13  e3 e4 8e 68 c0 2b 00 00  |.R...Q ....h.+..|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 03 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
+00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
+00000080  a0 d2 eb f4 30 09 06 07  2a 86 48 ce 3d 04 01 30  |....0...*.H.=..0|
+00000090  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+000000a0  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+000000b0  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+000000c0  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+000000d0  74 79 20 4c 74 64 30 1e  17 0d 31 32 31 31 32 32  |ty Ltd0...121122|
+000000e0  31 35 30 36 33 32 5a 17  0d 32 32 31 31 32 30 31  |150632Z..2211201|
+000000f0  35 30 36 33 32 5a 30 45  31 0b 30 09 06 03 55 04  |50632Z0E1.0...U.|
+00000100  06 13 02 41 55 31 13 30  11 06 03 55 04 08 13 0a  |...AU1.0...U....|
+00000110  53 6f 6d 65 2d 53 74 61  74 65 31 21 30 1f 06 03  |Some-State1!0...|
+00000120  55 04 0a 13 18 49 6e 74  65 72 6e 65 74 20 57 69  |U....Internet Wi|
+00000130  64 67 69 74 73 20 50 74  79 20 4c 74 64 30 81 9b  |dgits Pty Ltd0..|
+00000140  30 10 06 07 2a 86 48 ce  3d 02 01 06 05 2b 81 04  |0...*.H.=....+..|
+00000150  00 23 03 81 86 00 04 00  c4 a1 ed be 98 f9 0b 48  |.#.............H|
+00000160  73 36 7e c3 16 56 11 22  f2 3d 53 c3 3b 4d 21 3d  |s6~..V.".=S.;M!=|
+00000170  cd 6b 75 e6 f6 b0 dc 9a  df 26 c1 bc b2 87 f0 72  |.ku......&.....r|
+00000180  32 7c b3 64 2f 1c 90 bc  ea 68 23 10 7e fe e3 25  |2|.d/....h#.~..%|
+00000190  c0 48 3a 69 e0 28 6d d3  37 00 ef 04 62 dd 0d a0  |.H:i.(m.7...b...|
+000001a0  9c 70 62 83 d8 81 d3 64  31 aa 9e 97 31 bd 96 b0  |.pb....d1...1...|
+000001b0  68 c0 9b 23 de 76 64 3f  1a 5c 7f e9 12 0e 58 58  |h..#.vd?.\....XX|
+000001c0  b6 5f 70 dd 9b d8 ea d5  d7 f5 d5 cc b9 b6 9f 30  |._p............0|
+000001d0  66 5b 66 9a 20 e2 27 e5  bf fe 3b 30 09 06 07 2a  |f[f. .'...;0...*|
+000001e0  86 48 ce 3d 04 01 03 81  8c 00 30 81 88 02 42 01  |.H.=......0...B.|
+000001f0  88 a2 4f eb e2 45 c5 48  7d 1b ac f5 ed 98 9d ae  |..O..E.H}.......|
+00000200  47 70 c0 5e 1b b6 2f bd  f1 b6 4d b7 61 40 d3 11  |Gp.^../...M.a@..|
+00000210  a2 ce ee 0b 7e 92 7e ff  76 9d c3 3b 7e a5 3f ce  |....~.~.v..;~.?.|
+00000220  fa 10 e2 59 ec 47 2d 7c  ac da 4e 97 0e 15 a0 6f  |...Y.G-|..N....o|
+00000230  d0 02 42 01 4d fc be 67  13 9c 2d 05 0e bd 3f a3  |..B.M..g..-...?.|
+00000240  8c 25 c1 33 13 83 0d 94  06 bb d4 37 7a f6 ec 7a  |.%.3.......7z..z|
+00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
+00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
+00000270  95 12 07 8f 2a 16 03 03  00 b7 0c 00 00 b3 03 00  |....*...........|
+00000280  1d 20 1b e5 74 f7 2a 8e  86 7d 32 5b 99 f7 e0 2d  |. ..t.*..}2[...-|
+00000290  0d 96 a7 38 59 6c d9 50  7c 8a a2 2a 06 76 85 1f  |...8Yl.P|..*.v..|
+000002a0  77 7b 04 03 00 8b 30 81  88 02 42 01 9e 35 d1 fc  |w{....0...B..5..|
+000002b0  b8 16 97 b6 7b c4 6e 16  a9 de 5c 90 78 a6 d8 78  |....{.n...\.x..x|
+000002c0  be 38 98 ba 50 bc 88 bb  f0 15 30 62 29 96 43 15  |.8..P.....0b).C.|
+000002d0  a7 7e 93 d4 3a 8c 2c 24  a5 7b e3 51 eb ef d4 16  |.~..:.,$.{.Q....|
+000002e0  9b d7 c2 c3 b1 10 54 fe  26 55 05 a7 79 02 42 01  |......T.&U..y.B.|
+000002f0  ca 62 10 6d b0 be 85 cf  3d ef a1 2f 9a 04 b9 6b  |.b.m....=../...k|
+00000300  1d ec bf fc 4e 77 81 b2  70 50 98 26 b4 89 5f a9  |....Nw..pP.&.._.|
+00000310  d8 63 1a 54 79 f2 39 83  88 57 a0 25 cc a6 36 fa  |.c.Ty.9..W.%..6.|
+00000320  31 c1 45 c5 8d 04 83 42  89 a4 15 c3 3e 61 71 1c  |1.E....B....>aq.|
+00000330  53 16 03 03 00 04 0e 00  00 00                    |S.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 30 f1 a9  |....(........0..|
-00000040  4a 7e 86 a1 5d b7 db 2f  c6 e2 ec 36 41 83 66 75  |J~..]../...6A.fu|
-00000050  a3 6c 7d e7 61 36 ac f7  76 f8 8e d8 81           |.l}.a6..v....|
+00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 4f 28 16  |....(........O(.|
+00000040  51 9e e7 01 d2 5c 25 d7  bb 42 4c fc d9 dc d7 7f  |Q....\%..BL.....|
+00000050  2b 6c 5e 03 63 ce 19 ae  92 b8 c1 46 20           |+l^.c......F |
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 2c 78 86 13 dc  |..........(,x...|
-00000010  a4 b9 bf ad 50 45 a3 d9  b3 df 33 a2 79 b1 1b 25  |....PE....3.y..%|
-00000020  12 94 97 99 07 6b 52 c4  52 64 ab 89 40 8c 93 4a  |.....kR.Rd..@..J|
-00000030  e3 cc d9                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 28 31 c5 7a e8 49  |..........(1.z.I|
+00000010  52 3d 85 b0 c4 7d 82 fa  08 a3 84 a9 58 8a 05 8c  |R=...}......X...|
+00000020  9a 7c 6c 4e 29 fd 46 53  06 27 09 d2 38 f5 7c 5c  |.|lN).FS.'..8.|\|
+00000030  fb ba 6b                                          |..k|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 fa 9e 8b  |................|
-00000010  92 8c f5 32 e6 d4 11 46  b4 73 62 56 f6 83 15 6f  |...2...F.sbV...o|
-00000020  ce de 2d 15 03 03 00 1a  00 00 00 00 00 00 00 02  |..-.............|
-00000030  93 24 68 83 67 b6 f9 27  b5 26 52 78 5d f3 c9 d2  |.$h.g..'.&Rx]...|
-00000040  26 a0                                             |&.|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 df 67 c1  |..............g.|
+00000010  b4 dd 34 b2 32 ea b4 00  1b b9 67 60 03 91 bf 17  |..4.2.....g`....|
+00000020  0d dd dc 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
+00000030  7c a9 51 36 43 33 ab e4  35 15 cf 6f ef c5 ed c7  ||.Q6C3..5..o....|
+00000040  2f 4d                                             |/M|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES128-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES128-SHA256
index 4946fe4ec5..1e871a468e 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES128-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES128-SHA256
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,91 +7,92 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 d1 af 88 61 b7  |....Y...U.....a.|
-00000010  b3 01 16 1a 44 26 1c a1  4f 2d 8a f6 9c f2 7e 1a  |....D&..O-....~.|
-00000020  1f ce cb dd 5b f0 c6 2f  16 5e 4a 20 b3 c7 ae 3f  |....[../.^J ...?|
-00000030  de d0 d8 9e 48 3e 87 23  f0 9d 43 10 50 3c 66 8b  |....H>.#..C.P<f.|
-00000040  7f d2 9b 4f f5 e4 b3 53  db d6 65 d0 c0 23 00 00  |...O...S..e..#..|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
-00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
-00000080  30 09 06 07 2a 86 48 ce  3d 04 01 30 45 31 0b 30  |0...*.H.=..0E1.0|
-00000090  09 06 03 55 04 06 13 02  41 55 31 13 30 11 06 03  |...U....AU1.0...|
-000000a0  55 04 08 13 0a 53 6f 6d  65 2d 53 74 61 74 65 31  |U....Some-State1|
-000000b0  21 30 1f 06 03 55 04 0a  13 18 49 6e 74 65 72 6e  |!0...U....Intern|
-000000c0  65 74 20 57 69 64 67 69  74 73 20 50 74 79 20 4c  |et Widgits Pty L|
-000000d0  74 64 30 1e 17 0d 31 32  31 31 32 32 31 35 30 36  |td0...1211221506|
-000000e0  33 32 5a 17 0d 32 32 31  31 32 30 31 35 30 36 33  |32Z..22112015063|
-000000f0  32 5a 30 45 31 0b 30 09  06 03 55 04 06 13 02 41  |2Z0E1.0...U....A|
-00000100  55 31 13 30 11 06 03 55  04 08 13 0a 53 6f 6d 65  |U1.0...U....Some|
-00000110  2d 53 74 61 74 65 31 21  30 1f 06 03 55 04 0a 13  |-State1!0...U...|
-00000120  18 49 6e 74 65 72 6e 65  74 20 57 69 64 67 69 74  |.Internet Widgit|
-00000130  73 20 50 74 79 20 4c 74  64 30 81 9b 30 10 06 07  |s Pty Ltd0..0...|
-00000140  2a 86 48 ce 3d 02 01 06  05 2b 81 04 00 23 03 81  |*.H.=....+...#..|
-00000150  86 00 04 00 c4 a1 ed be  98 f9 0b 48 73 36 7e c3  |...........Hs6~.|
-00000160  16 56 11 22 f2 3d 53 c3  3b 4d 21 3d cd 6b 75 e6  |.V.".=S.;M!=.ku.|
-00000170  f6 b0 dc 9a df 26 c1 bc  b2 87 f0 72 32 7c b3 64  |.....&.....r2|.d|
-00000180  2f 1c 90 bc ea 68 23 10  7e fe e3 25 c0 48 3a 69  |/....h#.~..%.H:i|
-00000190  e0 28 6d d3 37 00 ef 04  62 dd 0d a0 9c 70 62 83  |.(m.7...b....pb.|
-000001a0  d8 81 d3 64 31 aa 9e 97  31 bd 96 b0 68 c0 9b 23  |...d1...1...h..#|
-000001b0  de 76 64 3f 1a 5c 7f e9  12 0e 58 58 b6 5f 70 dd  |.vd?.\....XX._p.|
-000001c0  9b d8 ea d5 d7 f5 d5 cc  b9 b6 9f 30 66 5b 66 9a  |...........0f[f.|
-000001d0  20 e2 27 e5 bf fe 3b 30  09 06 07 2a 86 48 ce 3d  | .'...;0...*.H.=|
-000001e0  04 01 03 81 8c 00 30 81  88 02 42 01 88 a2 4f eb  |......0...B...O.|
-000001f0  e2 45 c5 48 7d 1b ac f5  ed 98 9d ae 47 70 c0 5e  |.E.H}.......Gp.^|
-00000200  1b b6 2f bd f1 b6 4d b7  61 40 d3 11 a2 ce ee 0b  |../...M.a@......|
-00000210  7e 92 7e ff 76 9d c3 3b  7e a5 3f ce fa 10 e2 59  |~.~.v..;~.?....Y|
-00000220  ec 47 2d 7c ac da 4e 97  0e 15 a0 6f d0 02 42 01  |.G-|..N....o..B.|
-00000230  4d fc be 67 13 9c 2d 05  0e bd 3f a3 8c 25 c1 33  |M..g..-...?..%.3|
-00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
-00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
-00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 b6 0c 00  00 b2 03 00 1d 20 dc 43  |*............ .C|
-00000280  15 b7 95 81 41 bf e2 bd  56 82 23 46 05 29 05 95  |....A...V.#F.)..|
-00000290  ae 67 08 38 9f 10 70 25  21 92 b4 a0 82 4e 04 03  |.g.8..p%!....N..|
-000002a0  00 8a 30 81 87 02 41 5d  ca d6 a2 fd e3 e2 be 2f  |..0...A]......./|
-000002b0  69 b5 7d 5c a3 2b 36 4c  8b 81 05 89 12 e1 30 26  |i.}\.+6L......0&|
-000002c0  fa ae 82 b9 4f 8e ba ac  ee 7b 62 d5 60 f8 df a4  |....O....{b.`...|
-000002d0  c1 a1 15 73 f8 fb 0b 47  64 b3 34 4a 44 02 a6 32  |...s...Gd.4JD..2|
-000002e0  bc 0d 7b a5 c1 84 cf 77  02 42 01 f3 e5 7f d1 47  |..{....w.B.....G|
-000002f0  bc be 0a ec cd d6 4f 2c  26 5a 95 d3 0f 9b c3 c6  |......O,&Z......|
-00000300  05 b5 5e d7 f6 ca 64 17  94 aa a5 e6 b1 88 57 21  |..^...d.......W!|
-00000310  f8 da 02 de 32 8c ea 5b  7c 36 c9 93 e1 96 38 93  |....2..[|6....8.|
-00000320  9b f9 e5 44 47 a6 74 fa  0e 5f 8f 22 16 03 03 00  |...DG.t.._."....|
-00000330  04 0e 00 00 00                                    |.....|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 32 b8 00 e5 21  |....]...Y..2...!|
+00000010  98 b0 8b 40 56 f2 af 06  fa 7d 1c 23 6a 01 c6 95  |...@V....}.#j...|
+00000020  41 9d 08 ac 5d de 0e 7e  39 57 07 20 b5 df a0 9a  |A...]..~9W. ....|
+00000030  13 3f b4 ae 1f 54 eb 47  6a 5a d5 f1 07 22 8f 29  |.?...T.GjZ...".)|
+00000040  00 e8 9e e9 f6 76 80 ab  7d a8 23 4a c0 23 00 00  |.....v..}.#J.#..|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 03 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
+00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
+00000080  a0 d2 eb f4 30 09 06 07  2a 86 48 ce 3d 04 01 30  |....0...*.H.=..0|
+00000090  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+000000a0  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+000000b0  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+000000c0  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+000000d0  74 79 20 4c 74 64 30 1e  17 0d 31 32 31 31 32 32  |ty Ltd0...121122|
+000000e0  31 35 30 36 33 32 5a 17  0d 32 32 31 31 32 30 31  |150632Z..2211201|
+000000f0  35 30 36 33 32 5a 30 45  31 0b 30 09 06 03 55 04  |50632Z0E1.0...U.|
+00000100  06 13 02 41 55 31 13 30  11 06 03 55 04 08 13 0a  |...AU1.0...U....|
+00000110  53 6f 6d 65 2d 53 74 61  74 65 31 21 30 1f 06 03  |Some-State1!0...|
+00000120  55 04 0a 13 18 49 6e 74  65 72 6e 65 74 20 57 69  |U....Internet Wi|
+00000130  64 67 69 74 73 20 50 74  79 20 4c 74 64 30 81 9b  |dgits Pty Ltd0..|
+00000140  30 10 06 07 2a 86 48 ce  3d 02 01 06 05 2b 81 04  |0...*.H.=....+..|
+00000150  00 23 03 81 86 00 04 00  c4 a1 ed be 98 f9 0b 48  |.#.............H|
+00000160  73 36 7e c3 16 56 11 22  f2 3d 53 c3 3b 4d 21 3d  |s6~..V.".=S.;M!=|
+00000170  cd 6b 75 e6 f6 b0 dc 9a  df 26 c1 bc b2 87 f0 72  |.ku......&.....r|
+00000180  32 7c b3 64 2f 1c 90 bc  ea 68 23 10 7e fe e3 25  |2|.d/....h#.~..%|
+00000190  c0 48 3a 69 e0 28 6d d3  37 00 ef 04 62 dd 0d a0  |.H:i.(m.7...b...|
+000001a0  9c 70 62 83 d8 81 d3 64  31 aa 9e 97 31 bd 96 b0  |.pb....d1...1...|
+000001b0  68 c0 9b 23 de 76 64 3f  1a 5c 7f e9 12 0e 58 58  |h..#.vd?.\....XX|
+000001c0  b6 5f 70 dd 9b d8 ea d5  d7 f5 d5 cc b9 b6 9f 30  |._p............0|
+000001d0  66 5b 66 9a 20 e2 27 e5  bf fe 3b 30 09 06 07 2a  |f[f. .'...;0...*|
+000001e0  86 48 ce 3d 04 01 03 81  8c 00 30 81 88 02 42 01  |.H.=......0...B.|
+000001f0  88 a2 4f eb e2 45 c5 48  7d 1b ac f5 ed 98 9d ae  |..O..E.H}.......|
+00000200  47 70 c0 5e 1b b6 2f bd  f1 b6 4d b7 61 40 d3 11  |Gp.^../...M.a@..|
+00000210  a2 ce ee 0b 7e 92 7e ff  76 9d c3 3b 7e a5 3f ce  |....~.~.v..;~.?.|
+00000220  fa 10 e2 59 ec 47 2d 7c  ac da 4e 97 0e 15 a0 6f  |...Y.G-|..N....o|
+00000230  d0 02 42 01 4d fc be 67  13 9c 2d 05 0e bd 3f a3  |..B.M..g..-...?.|
+00000240  8c 25 c1 33 13 83 0d 94  06 bb d4 37 7a f6 ec 7a  |.%.3.......7z..z|
+00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
+00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
+00000270  95 12 07 8f 2a 16 03 03  00 b6 0c 00 00 b2 03 00  |....*...........|
+00000280  1d 20 f1 d6 ed a5 69 28  d2 bd 97 e3 00 e0 81 74  |. ....i(.......t|
+00000290  8d 36 6e 77 73 40 10 a1  73 b3 4d 8e 04 41 b1 0e  |.6nws@..s.M..A..|
+000002a0  08 28 04 03 00 8a 30 81  87 02 42 01 4b b4 14 32  |.(....0...B.K..2|
+000002b0  13 88 f1 8d 3a 66 e2 a2  d6 d4 de 26 50 7d 74 22  |....:f.....&P}t"|
+000002c0  f9 56 83 00 0a b7 34 b3  96 99 0e c4 1d 8d 86 df  |.V....4.........|
+000002d0  22 2b 1c d7 75 f5 c9 45  2a c7 8a 74 40 ae 04 ac  |"+..u..E*..t@...|
+000002e0  b3 b4 5e c1 c5 e6 9c c3  01 ad 10 37 2b 02 41 4f  |..^........7+.AO|
+000002f0  74 33 31 aa c0 f8 8e ac  cf 5a 90 a5 b8 d1 52 76  |t31......Z....Rv|
+00000300  c3 a3 4f 0d 7d d7 8a 50  d3 bb 49 ce 22 ec d0 d3  |..O.}..P..I."...|
+00000310  b5 e3 5c c2 a9 54 2e 6f  9c d1 24 3d 70 7f 2b a3  |..\..T.o..$=p.+.|
+00000320  fe 24 fc 48 14 d3 8a f0  70 f3 1f af fe ae e3 fe  |.$.H....p.......|
+00000330  16 03 03 00 04 0e 00 00  00                       |.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
 00000030  16 03 03 00 50 00 00 00  00 00 00 00 00 00 00 00  |....P...........|
-00000040  00 00 00 00 00 85 db ae  c1 37 85 25 3d ee 5f f5  |.........7.%=._.|
-00000050  12 95 df ee 29 4a f7 3a  80 ca bd c2 b3 d8 f3 8c  |....)J.:........|
-00000060  56 62 d2 68 13 1d 73 51  09 93 a3 b9 43 4a 2c 0f  |Vb.h..sQ....CJ,.|
-00000070  bf 3c 96 76 08 a9 17 68  e2 9a 3f 39 e7 04 76 f8  |.<.v...h..?9..v.|
-00000080  8f fe e8 f5 ce                                    |.....|
+00000040  00 00 00 00 00 ea c6 10  80 cf 85 ad 7c 5f 6b 98  |............|_k.|
+00000050  7b 5a d6 47 84 dc 95 c9  ed 6e e6 c3 56 d5 91 93  |{Z.G.....n..V...|
+00000060  0e 3f b5 6c 2f 73 d9 72  9b f7 64 47 29 9e 75 4f  |.?.l/s.r..dG).uO|
+00000070  97 2e 6d 94 52 f7 8f c9  24 5b d0 fe 05 aa e6 93  |..m.R...$[......|
+00000080  79 ea 37 0f 9e                                    |y.7..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 50 fa 85 cc bc dd  |..........P.....|
-00000010  0e 16 86 b1 5c 51 8a b9  cc 78 cd cd 64 5d 23 ca  |....\Q...x..d]#.|
-00000020  59 84 b3 42 dd ae a7 98  43 05 21 4f 35 43 75 5c  |Y..B....C.!O5Cu\|
-00000030  13 c8 e0 b6 66 0f 55 32  69 7a 8b 8f cd c2 37 38  |....f.U2iz....78|
-00000040  f6 fa 0b 66 cf 46 91 3e  9f f5 43 44 f5 c7 2b e1  |...f.F.>..CD..+.|
-00000050  39 3a f7 3c f2 03 c4 85  dc 58 66                 |9:.<.....Xf|
+00000000  14 03 03 00 01 01 16 03  03 00 50 ed 02 93 7e 89  |..........P...~.|
+00000010  d5 d7 e9 0b 21 71 a9 cd  b6 ac 65 6f 83 b2 0f 35  |....!q....eo...5|
+00000020  d6 1c bb df c5 c2 d6 6c  b6 32 37 14 a0 0c fd ae  |.......l.27.....|
+00000030  18 75 9e 82 df 00 ec 6c  99 e2 31 a3 35 e0 82 6d  |.u.....l..1.5..m|
+00000040  57 5b 60 82 ec 69 8a 79  30 96 4f 96 bb 99 66 75  |W[`..i.y0.O...fu|
+00000050  5d 41 f9 04 fc f2 c6 bb  92 1c cb                 |]A.........|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000010  00 00 00 00 00 44 e6 99  40 ae 12 bc d9 92 c5 ae  |.....D..@.......|
-00000020  fb 4d 5f 64 7a 77 0f 80  8e a4 be d0 ba ba 41 b1  |.M_dzw........A.|
-00000030  0d 40 e9 0e 50 32 dc 35  2d 5e 5c 8a ef 20 75 80  |.@..P2.5-^\.. u.|
-00000040  a0 e5 9c 61 49 15 03 03  00 40 00 00 00 00 00 00  |...aI....@......|
-00000050  00 00 00 00 00 00 00 00  00 00 57 91 40 2a a5 f7  |..........W.@*..|
-00000060  9f 29 0f 02 8e 50 ac 4b  2e 55 9a 78 72 f0 d7 c5  |.)...P.K.U.xr...|
-00000070  3b f2 cd 28 4d 8b 49 d8  50 a6 22 96 de df 16 d6  |;..(M.I.P.".....|
-00000080  61 4b 23 5c 5d de a1 0a  5b 16                    |aK#\]...[.|
+00000010  00 00 00 00 00 23 62 3f  ed a2 99 3b ac 03 f5 8c  |.....#b?...;....|
+00000020  3c 9f 71 25 b5 5c ec 2c  79 d5 70 ae 23 cf 2f 65  |<.q%.\.,y.p.#./e|
+00000030  3d 28 5f dd fb d6 6a 12  b5 5f eb 9f 2a 8e 79 80  |=(_...j.._..*.y.|
+00000040  eb 77 6e 7e b0 15 03 03  00 40 00 00 00 00 00 00  |.wn~.....@......|
+00000050  00 00 00 00 00 00 00 00  00 00 13 e1 0c 7b 01 90  |.............{..|
+00000060  e8 0d 2d 41 b5 c3 67 0a  37 c4 28 fa b6 88 cc 99  |..-A..g.7.(.....|
+00000070  f7 0a d9 25 09 24 88 f7  38 78 c4 1c 37 b4 3c a8  |...%.$..8x..7.<.|
+00000080  3d 2d ac a7 0d 45 62 9c  61 53                    |=-...Eb.aS|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384 b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384
index 14af5ae75f..6477993b27 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,82 +7,83 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 bb 8a 66 ee 44  |....Y...U....f.D|
-00000010  42 dc 59 c7 a7 7b a8 57  8e 63 21 f0 4e 31 f4 5c  |B.Y..{.W.c!.N1.\|
-00000020  1d d3 42 e5 de eb 8c 78  3a 01 01 20 9b 89 05 d6  |..B....x:.. ....|
-00000030  d2 07 38 8b 4c 5f 6d 62  9f 43 a0 cd d3 40 0f 77  |..8.L_mb.C...@.w|
-00000040  17 ff 43 4a 5c b3 8c 83  b7 4b c7 e7 c0 2c 00 00  |..CJ\....K...,..|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
-00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
-00000080  30 09 06 07 2a 86 48 ce  3d 04 01 30 45 31 0b 30  |0...*.H.=..0E1.0|
-00000090  09 06 03 55 04 06 13 02  41 55 31 13 30 11 06 03  |...U....AU1.0...|
-000000a0  55 04 08 13 0a 53 6f 6d  65 2d 53 74 61 74 65 31  |U....Some-State1|
-000000b0  21 30 1f 06 03 55 04 0a  13 18 49 6e 74 65 72 6e  |!0...U....Intern|
-000000c0  65 74 20 57 69 64 67 69  74 73 20 50 74 79 20 4c  |et Widgits Pty L|
-000000d0  74 64 30 1e 17 0d 31 32  31 31 32 32 31 35 30 36  |td0...1211221506|
-000000e0  33 32 5a 17 0d 32 32 31  31 32 30 31 35 30 36 33  |32Z..22112015063|
-000000f0  32 5a 30 45 31 0b 30 09  06 03 55 04 06 13 02 41  |2Z0E1.0...U....A|
-00000100  55 31 13 30 11 06 03 55  04 08 13 0a 53 6f 6d 65  |U1.0...U....Some|
-00000110  2d 53 74 61 74 65 31 21  30 1f 06 03 55 04 0a 13  |-State1!0...U...|
-00000120  18 49 6e 74 65 72 6e 65  74 20 57 69 64 67 69 74  |.Internet Widgit|
-00000130  73 20 50 74 79 20 4c 74  64 30 81 9b 30 10 06 07  |s Pty Ltd0..0...|
-00000140  2a 86 48 ce 3d 02 01 06  05 2b 81 04 00 23 03 81  |*.H.=....+...#..|
-00000150  86 00 04 00 c4 a1 ed be  98 f9 0b 48 73 36 7e c3  |...........Hs6~.|
-00000160  16 56 11 22 f2 3d 53 c3  3b 4d 21 3d cd 6b 75 e6  |.V.".=S.;M!=.ku.|
-00000170  f6 b0 dc 9a df 26 c1 bc  b2 87 f0 72 32 7c b3 64  |.....&.....r2|.d|
-00000180  2f 1c 90 bc ea 68 23 10  7e fe e3 25 c0 48 3a 69  |/....h#.~..%.H:i|
-00000190  e0 28 6d d3 37 00 ef 04  62 dd 0d a0 9c 70 62 83  |.(m.7...b....pb.|
-000001a0  d8 81 d3 64 31 aa 9e 97  31 bd 96 b0 68 c0 9b 23  |...d1...1...h..#|
-000001b0  de 76 64 3f 1a 5c 7f e9  12 0e 58 58 b6 5f 70 dd  |.vd?.\....XX._p.|
-000001c0  9b d8 ea d5 d7 f5 d5 cc  b9 b6 9f 30 66 5b 66 9a  |...........0f[f.|
-000001d0  20 e2 27 e5 bf fe 3b 30  09 06 07 2a 86 48 ce 3d  | .'...;0...*.H.=|
-000001e0  04 01 03 81 8c 00 30 81  88 02 42 01 88 a2 4f eb  |......0...B...O.|
-000001f0  e2 45 c5 48 7d 1b ac f5  ed 98 9d ae 47 70 c0 5e  |.E.H}.......Gp.^|
-00000200  1b b6 2f bd f1 b6 4d b7  61 40 d3 11 a2 ce ee 0b  |../...M.a@......|
-00000210  7e 92 7e ff 76 9d c3 3b  7e a5 3f ce fa 10 e2 59  |~.~.v..;~.?....Y|
-00000220  ec 47 2d 7c ac da 4e 97  0e 15 a0 6f d0 02 42 01  |.G-|..N....o..B.|
-00000230  4d fc be 67 13 9c 2d 05  0e bd 3f a3 8c 25 c1 33  |M..g..-...?..%.3|
-00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
-00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
-00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 b7 0c 00  00 b3 03 00 1d 20 fd 71  |*............ .q|
-00000280  c1 3a 6a a3 69 6a 34 f3  02 c5 1d e5 db 63 f4 eb  |.:j.ij4......c..|
-00000290  97 4c 70 bc b3 4e 9d 2c  2f b2 b9 9d ac 3f 04 03  |.Lp..N.,/....?..|
-000002a0  00 8b 30 81 88 02 42 01  bd 9d ad 24 37 b9 60 55  |..0...B....$7.`U|
-000002b0  e4 cc bc 49 c3 88 3b ed  ac e4 42 8e fa 81 01 d9  |...I..;...B.....|
-000002c0  39 4c f0 1c 7d 39 a2 81  8a e1 17 0e 8d 37 76 96  |9L..}9.......7v.|
-000002d0  37 13 3a 1e 2e fd 0d 0a  3c 90 9d 43 3d 06 c0 b1  |7.:.....<..C=...|
-000002e0  4e 07 3e c3 9f f2 43 40  0b 02 42 01 d6 d0 20 ad  |N.>...C@..B... .|
-000002f0  48 09 c0 9b 5d c8 84 46  3b 98 37 9b 5a 91 4a 07  |H...]..F;.7.Z.J.|
-00000300  79 68 71 92 76 dc 70 0f  5c 44 7e 81 c3 c6 3f 19  |yhq.v.p.\D~...?.|
-00000310  f4 0f 6a 0b aa cc bb 65  e7 34 b5 e9 67 2d 32 98  |..j....e.4..g-2.|
-00000320  1c f6 76 4c 96 73 df 21  d6 e1 ea 34 86 16 03 03  |..vL.s.!...4....|
-00000330  00 04 0e 00 00 00                                 |......|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 99 43 3d 42 93  |....]...Y...C=B.|
+00000010  5a 7a 04 30 74 51 61 36  15 df ef a7 26 ef b8 76  |Zz.0tQa6....&..v|
+00000020  87 35 7a 88 75 83 9e 0d  2c d4 3d 20 1f 29 99 ea  |.5z.u...,.= .)..|
+00000030  71 f7 c3 c4 68 3e 7f 58  7a 07 c7 2d a3 38 47 8d  |q...h>.Xz..-.8G.|
+00000040  c9 ed 05 b4 8e e7 b6 85  5d a1 62 6b c0 2c 00 00  |........].bk.,..|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 03 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
+00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
+00000080  a0 d2 eb f4 30 09 06 07  2a 86 48 ce 3d 04 01 30  |....0...*.H.=..0|
+00000090  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+000000a0  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+000000b0  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+000000c0  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+000000d0  74 79 20 4c 74 64 30 1e  17 0d 31 32 31 31 32 32  |ty Ltd0...121122|
+000000e0  31 35 30 36 33 32 5a 17  0d 32 32 31 31 32 30 31  |150632Z..2211201|
+000000f0  35 30 36 33 32 5a 30 45  31 0b 30 09 06 03 55 04  |50632Z0E1.0...U.|
+00000100  06 13 02 41 55 31 13 30  11 06 03 55 04 08 13 0a  |...AU1.0...U....|
+00000110  53 6f 6d 65 2d 53 74 61  74 65 31 21 30 1f 06 03  |Some-State1!0...|
+00000120  55 04 0a 13 18 49 6e 74  65 72 6e 65 74 20 57 69  |U....Internet Wi|
+00000130  64 67 69 74 73 20 50 74  79 20 4c 74 64 30 81 9b  |dgits Pty Ltd0..|
+00000140  30 10 06 07 2a 86 48 ce  3d 02 01 06 05 2b 81 04  |0...*.H.=....+..|
+00000150  00 23 03 81 86 00 04 00  c4 a1 ed be 98 f9 0b 48  |.#.............H|
+00000160  73 36 7e c3 16 56 11 22  f2 3d 53 c3 3b 4d 21 3d  |s6~..V.".=S.;M!=|
+00000170  cd 6b 75 e6 f6 b0 dc 9a  df 26 c1 bc b2 87 f0 72  |.ku......&.....r|
+00000180  32 7c b3 64 2f 1c 90 bc  ea 68 23 10 7e fe e3 25  |2|.d/....h#.~..%|
+00000190  c0 48 3a 69 e0 28 6d d3  37 00 ef 04 62 dd 0d a0  |.H:i.(m.7...b...|
+000001a0  9c 70 62 83 d8 81 d3 64  31 aa 9e 97 31 bd 96 b0  |.pb....d1...1...|
+000001b0  68 c0 9b 23 de 76 64 3f  1a 5c 7f e9 12 0e 58 58  |h..#.vd?.\....XX|
+000001c0  b6 5f 70 dd 9b d8 ea d5  d7 f5 d5 cc b9 b6 9f 30  |._p............0|
+000001d0  66 5b 66 9a 20 e2 27 e5  bf fe 3b 30 09 06 07 2a  |f[f. .'...;0...*|
+000001e0  86 48 ce 3d 04 01 03 81  8c 00 30 81 88 02 42 01  |.H.=......0...B.|
+000001f0  88 a2 4f eb e2 45 c5 48  7d 1b ac f5 ed 98 9d ae  |..O..E.H}.......|
+00000200  47 70 c0 5e 1b b6 2f bd  f1 b6 4d b7 61 40 d3 11  |Gp.^../...M.a@..|
+00000210  a2 ce ee 0b 7e 92 7e ff  76 9d c3 3b 7e a5 3f ce  |....~.~.v..;~.?.|
+00000220  fa 10 e2 59 ec 47 2d 7c  ac da 4e 97 0e 15 a0 6f  |...Y.G-|..N....o|
+00000230  d0 02 42 01 4d fc be 67  13 9c 2d 05 0e bd 3f a3  |..B.M..g..-...?.|
+00000240  8c 25 c1 33 13 83 0d 94  06 bb d4 37 7a f6 ec 7a  |.%.3.......7z..z|
+00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
+00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
+00000270  95 12 07 8f 2a 16 03 03  00 b5 0c 00 00 b1 03 00  |....*...........|
+00000280  1d 20 fb 11 a5 85 16 55  f9 09 56 4a 4c f7 c8 a1  |. .....U..VJL...|
+00000290  fd 57 e3 4d 1e b5 78 df  7a b1 02 0c 42 60 80 f9  |.W.M..x.z...B`..|
+000002a0  4b 6e 04 03 00 89 30 81  86 02 41 4d 4a 3c 11 e1  |Kn....0...AMJ<..|
+000002b0  72 33 71 38 77 52 4d d8  78 ee 23 f9 f3 00 20 76  |r3q8wRM.x.#... v|
+000002c0  04 19 b2 4c 28 34 9d 22  b7 3e 1d 35 8f 93 ab 66  |...L(4.".>.5...f|
+000002d0  09 c4 7a 8e 8c 5a fc ae  1d c7 ba 2e 36 ea e7 0b  |..z..Z......6...|
+000002e0  43 ae 03 e3 ec 6b f7 81  2e 22 e5 f0 02 41 39 95  |C....k..."...A9.|
+000002f0  22 5f b0 1a 5c 13 a0 c5  08 47 a7 51 9c fa 15 32  |"_..\....G.Q...2|
+00000300  95 84 95 8f 2f ed 38 19  bb b5 2b ac 39 90 a1 4c  |..../.8...+.9..L|
+00000310  b5 20 49 cd 87 17 9d ef  b4 c3 22 05 56 23 7d bc  |. I.......".V#}.|
+00000320  6a d6 ae d9 e5 50 65 6c  8b df 4b 2e 6d e9 e3 16  |j....Pel..K.m...|
+00000330  03 03 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 27 fd 98  |....(........'..|
-00000040  47 79 56 f9 e8 0e fd 18  c2 8f 2d 32 51 f7 19 b5  |GyV.......-2Q...|
-00000050  ab 2f 81 ed b6 cf 6f b5  65 81 81 f1 44           |./....o.e...D|
+00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 ef cc 31  |....(..........1|
+00000040  f9 de 58 68 c9 6a c7 c4  3e 60 1f 4e f9 bf 27 87  |..Xh.j..>`.N..'.|
+00000050  b0 17 ed 83 17 a0 45 b7  a9 d8 95 b6 51           |......E.....Q|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 a9 b7 63 61 57  |..........(..caW|
-00000010  54 57 f0 b2 60 58 e3 dc  6e e1 40 3e 67 b4 99 8f  |TW..`X..n.@>g...|
-00000020  e9 6b 11 f1 1a 54 bd c1  d3 b9 5b 01 12 27 a4 0b  |.k...T....[..'..|
-00000030  e9 ec 01                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 28 61 eb 42 a7 10  |..........(a.B..|
+00000010  6f 1a ef 4d e5 4d df 75  cb 8e 59 f8 06 e0 f9 ee  |o..M.M.u..Y.....|
+00000020  d1 a9 11 7b 89 97 62 b9  76 d1 8e eb ee 30 dd 0f  |...{..b.v....0..|
+00000030  60 b1 e1                                          |`..|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 e0 8a 6e  |...............n|
-00000010  62 5d e3 db 99 10 d2 53  b6 21 2e 79 31 cf 71 1d  |b].....S.!.y1.q.|
-00000020  34 71 2a 15 03 03 00 1a  00 00 00 00 00 00 00 02  |4q*.............|
-00000030  e7 4a 8d b9 2f 1b b1 70  72 da 7f d8 fa 4f 9f d6  |.J../..pr....O..|
-00000040  ca f3                                             |..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 fb 32 66  |..............2f|
+00000010  d6 d5 e1 52 31 8d 63 4f  5c a0 ac b5 f3 64 dc 40  |...R1.cO\....d.@|
+00000020  f5 93 5a 15 03 03 00 1a  00 00 00 00 00 00 00 02  |..Z.............|
+00000030  6b 66 c3 db e8 33 66 14  9b 4b 1c 59 bf 9e 6c 7e  |kf...3f..K.Y..l~|
+00000040  2d 1e                                             |-.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-CHACHA20-POLY1305 b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-CHACHA20-POLY1305
index 3113b3c6e5..e1b45cb7bd 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-CHACHA20-POLY1305
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-ECDSA-CHACHA20-POLY1305
@@ -1,84 +1,84 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 d0 01 00 00  cc 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 d4 01 00 00  d0 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 00 08 cc a9  |................|
-00000050  13 03 13 01 13 02 01 00  00 7b 00 05 00 05 01 00  |.........{......|
+00000050  13 03 13 01 13 02 01 00  00 7f 00 05 00 05 01 00  |................|
 00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
 00000070  19 00 0b 00 02 01 00 00  0d 00 1a 00 18 08 04 04  |................|
 00000080  03 08 07 08 05 08 06 04  01 05 01 06 01 05 03 06  |................|
-00000090  03 02 01 02 03 ff 01 00  01 00 00 12 00 00 00 2b  |...............+|
-000000a0  00 09 08 03 04 03 03 03  02 03 01 00 33 00 26 00  |............3.&.|
-000000b0  24 00 1d 00 20 2f e5 7d  a3 47 cd 62 43 15 28 da  |$... /.}.G.bC.(.|
-000000c0  ac 5f bb 29 07 30 ff f6  84 af c4 cf c2 ed 90 99  |._.).0..........|
-000000d0  5f 58 cb 3b 74                                    |_X.;t|
+00000090  03 02 01 02 03 ff 01 00  01 00 00 17 00 00 00 12  |................|
+000000a0  00 00 00 2b 00 09 08 03  04 03 03 03 02 03 01 00  |...+............|
+000000b0  33 00 26 00 24 00 1d 00  20 2f e5 7d a3 47 cd 62  |3.&.$... /.}.G.b|
+000000c0  43 15 28 da ac 5f bb 29  07 30 ff f6 84 af c4 cf  |C.(.._.).0......|
+000000d0  c2 ed 90 99 5f 58 cb 3b  74                       |...._X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 e1 cc 3c 49 04  |....Y...U....<I.|
-00000010  bb 5b 18 c7 44 8f 52 62  d9 74 84 94 fa 61 3f 12  |.[..D.Rb.t...a?.|
-00000020  c8 23 50 0b 8a 5c 81 23  c2 9d 3d 20 1f b2 67 b0  |.#P..\.#..= ..g.|
-00000030  e9 2d a9 ed 35 4e ab b9  73 59 32 2f 49 ed 1e 60  |.-..5N..sY2/I..`|
-00000040  4c 31 11 6e 27 79 e0 62  e0 e4 ca 16 cc a9 00 00  |L1.n'y.b........|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  03 02 0e 0b 00 02 0a 00  02 07 00 02 04 30 82 02  |.............0..|
-00000070  00 30 82 01 62 02 09 00  b8 bf 2d 47 a0 d2 eb f4  |.0..b.....-G....|
-00000080  30 09 06 07 2a 86 48 ce  3d 04 01 30 45 31 0b 30  |0...*.H.=..0E1.0|
-00000090  09 06 03 55 04 06 13 02  41 55 31 13 30 11 06 03  |...U....AU1.0...|
-000000a0  55 04 08 13 0a 53 6f 6d  65 2d 53 74 61 74 65 31  |U....Some-State1|
-000000b0  21 30 1f 06 03 55 04 0a  13 18 49 6e 74 65 72 6e  |!0...U....Intern|
-000000c0  65 74 20 57 69 64 67 69  74 73 20 50 74 79 20 4c  |et Widgits Pty L|
-000000d0  74 64 30 1e 17 0d 31 32  31 31 32 32 31 35 30 36  |td0...1211221506|
-000000e0  33 32 5a 17 0d 32 32 31  31 32 30 31 35 30 36 33  |32Z..22112015063|
-000000f0  32 5a 30 45 31 0b 30 09  06 03 55 04 06 13 02 41  |2Z0E1.0...U....A|
-00000100  55 31 13 30 11 06 03 55  04 08 13 0a 53 6f 6d 65  |U1.0...U....Some|
-00000110  2d 53 74 61 74 65 31 21  30 1f 06 03 55 04 0a 13  |-State1!0...U...|
-00000120  18 49 6e 74 65 72 6e 65  74 20 57 69 64 67 69 74  |.Internet Widgit|
-00000130  73 20 50 74 79 20 4c 74  64 30 81 9b 30 10 06 07  |s Pty Ltd0..0...|
-00000140  2a 86 48 ce 3d 02 01 06  05 2b 81 04 00 23 03 81  |*.H.=....+...#..|
-00000150  86 00 04 00 c4 a1 ed be  98 f9 0b 48 73 36 7e c3  |...........Hs6~.|
-00000160  16 56 11 22 f2 3d 53 c3  3b 4d 21 3d cd 6b 75 e6  |.V.".=S.;M!=.ku.|
-00000170  f6 b0 dc 9a df 26 c1 bc  b2 87 f0 72 32 7c b3 64  |.....&.....r2|.d|
-00000180  2f 1c 90 bc ea 68 23 10  7e fe e3 25 c0 48 3a 69  |/....h#.~..%.H:i|
-00000190  e0 28 6d d3 37 00 ef 04  62 dd 0d a0 9c 70 62 83  |.(m.7...b....pb.|
-000001a0  d8 81 d3 64 31 aa 9e 97  31 bd 96 b0 68 c0 9b 23  |...d1...1...h..#|
-000001b0  de 76 64 3f 1a 5c 7f e9  12 0e 58 58 b6 5f 70 dd  |.vd?.\....XX._p.|
-000001c0  9b d8 ea d5 d7 f5 d5 cc  b9 b6 9f 30 66 5b 66 9a  |...........0f[f.|
-000001d0  20 e2 27 e5 bf fe 3b 30  09 06 07 2a 86 48 ce 3d  | .'...;0...*.H.=|
-000001e0  04 01 03 81 8c 00 30 81  88 02 42 01 88 a2 4f eb  |......0...B...O.|
-000001f0  e2 45 c5 48 7d 1b ac f5  ed 98 9d ae 47 70 c0 5e  |.E.H}.......Gp.^|
-00000200  1b b6 2f bd f1 b6 4d b7  61 40 d3 11 a2 ce ee 0b  |../...M.a@......|
-00000210  7e 92 7e ff 76 9d c3 3b  7e a5 3f ce fa 10 e2 59  |~.~.v..;~.?....Y|
-00000220  ec 47 2d 7c ac da 4e 97  0e 15 a0 6f d0 02 42 01  |.G-|..N....o..B.|
-00000230  4d fc be 67 13 9c 2d 05  0e bd 3f a3 8c 25 c1 33  |M..g..-...?..%.3|
-00000240  13 83 0d 94 06 bb d4 37  7a f6 ec 7a c9 86 2e dd  |.......7z..z....|
-00000250  d7 11 69 7f 85 7c 56 de  fb 31 78 2b e4 c7 78 0d  |..i..|V..1x+..x.|
-00000260  ae cb be 9e 4e 36 24 31  7b 6a 0f 39 95 12 07 8f  |....N6$1{j.9....|
-00000270  2a 16 03 03 00 b6 0c 00  00 b2 03 00 1d 20 cc a1  |*............ ..|
-00000280  4d a4 b1 22 86 e5 91 9b  e2 1a 28 c6 66 06 1a 89  |M.."......(.f...|
-00000290  a9 62 23 93 09 54 ae 67  a8 ab 18 ac 67 37 04 03  |.b#..T.g....g7..|
-000002a0  00 8a 30 81 87 02 42 01  f0 46 f3 3f 13 a7 1d 84  |..0...B..F.?....|
-000002b0  73 65 9e 91 16 6c 3d 8f  21 ab 17 db 24 34 21 8c  |se...l=.!...$4!.|
-000002c0  a9 e1 9b a6 17 c8 0d 7a  b4 8e f0 46 cd c5 b9 b2  |.......z...F....|
-000002d0  5e 64 7f 9f 9d 03 14 7a  23 5d 55 70 ae d1 ff 08  |^d.....z#]Up....|
-000002e0  e8 70 f5 5d 55 90 74 04  0d 02 41 09 ca 7d 60 ea  |.p.]U.t...A..}`.|
-000002f0  13 17 42 e8 53 e7 c5 31  15 4a 58 14 d6 54 f5 40  |..B.S..1.JX..T.@|
-00000300  a1 aa fe 4b 13 f5 29 04  05 cc 12 26 e2 b7 e5 a6  |...K..)....&....|
-00000310  90 7c 5e 66 2f ed 41 7c  97 a1 72 87 5e 46 5a 5b  |.|^f/.A|..r.^FZ[|
-00000320  1b d1 7b 3c 34 ba 3f 47  7d a9 84 33 16 03 03 00  |..{<4.?G}..3....|
-00000330  04 0e 00 00 00                                    |.....|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 f0 39 6d 08 4c  |....]...Y...9m.L|
+00000010  1e c8 06 4d 9e 1e 2a 27  d9 17 6f 39 19 38 ba 49  |...M..*'..o9.8.I|
+00000020  a5 fa b2 6d a2 70 e8 9d  b2 03 92 20 09 ef 68 cb  |...m.p..... ..h.|
+00000030  58 2a fd 4b 60 9a 1e af  f4 02 c0 cb 10 b2 dd 73  |X*.K`..........s|
+00000040  0c e0 6a da 3f cd 3a a3  a3 55 58 00 cc a9 00 00  |..j.?.:..UX.....|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 03 02 0e 0b  00 02 0a 00 02 07 00 02  |................|
+00000070  04 30 82 02 00 30 82 01  62 02 09 00 b8 bf 2d 47  |.0...0..b.....-G|
+00000080  a0 d2 eb f4 30 09 06 07  2a 86 48 ce 3d 04 01 30  |....0...*.H.=..0|
+00000090  45 31 0b 30 09 06 03 55  04 06 13 02 41 55 31 13  |E1.0...U....AU1.|
+000000a0  30 11 06 03 55 04 08 13  0a 53 6f 6d 65 2d 53 74  |0...U....Some-St|
+000000b0  61 74 65 31 21 30 1f 06  03 55 04 0a 13 18 49 6e  |ate1!0...U....In|
+000000c0  74 65 72 6e 65 74 20 57  69 64 67 69 74 73 20 50  |ternet Widgits P|
+000000d0  74 79 20 4c 74 64 30 1e  17 0d 31 32 31 31 32 32  |ty Ltd0...121122|
+000000e0  31 35 30 36 33 32 5a 17  0d 32 32 31 31 32 30 31  |150632Z..2211201|
+000000f0  35 30 36 33 32 5a 30 45  31 0b 30 09 06 03 55 04  |50632Z0E1.0...U.|
+00000100  06 13 02 41 55 31 13 30  11 06 03 55 04 08 13 0a  |...AU1.0...U....|
+00000110  53 6f 6d 65 2d 53 74 61  74 65 31 21 30 1f 06 03  |Some-State1!0...|
+00000120  55 04 0a 13 18 49 6e 74  65 72 6e 65 74 20 57 69  |U....Internet Wi|
+00000130  64 67 69 74 73 20 50 74  79 20 4c 74 64 30 81 9b  |dgits Pty Ltd0..|
+00000140  30 10 06 07 2a 86 48 ce  3d 02 01 06 05 2b 81 04  |0...*.H.=....+..|
+00000150  00 23 03 81 86 00 04 00  c4 a1 ed be 98 f9 0b 48  |.#.............H|
+00000160  73 36 7e c3 16 56 11 22  f2 3d 53 c3 3b 4d 21 3d  |s6~..V.".=S.;M!=|
+00000170  cd 6b 75 e6 f6 b0 dc 9a  df 26 c1 bc b2 87 f0 72  |.ku......&.....r|
+00000180  32 7c b3 64 2f 1c 90 bc  ea 68 23 10 7e fe e3 25  |2|.d/....h#.~..%|
+00000190  c0 48 3a 69 e0 28 6d d3  37 00 ef 04 62 dd 0d a0  |.H:i.(m.7...b...|
+000001a0  9c 70 62 83 d8 81 d3 64  31 aa 9e 97 31 bd 96 b0  |.pb....d1...1...|
+000001b0  68 c0 9b 23 de 76 64 3f  1a 5c 7f e9 12 0e 58 58  |h..#.vd?.\....XX|
+000001c0  b6 5f 70 dd 9b d8 ea d5  d7 f5 d5 cc b9 b6 9f 30  |._p............0|
+000001d0  66 5b 66 9a 20 e2 27 e5  bf fe 3b 30 09 06 07 2a  |f[f. .'...;0...*|
+000001e0  86 48 ce 3d 04 01 03 81  8c 00 30 81 88 02 42 01  |.H.=......0...B.|
+000001f0  88 a2 4f eb e2 45 c5 48  7d 1b ac f5 ed 98 9d ae  |..O..E.H}.......|
+00000200  47 70 c0 5e 1b b6 2f bd  f1 b6 4d b7 61 40 d3 11  |Gp.^../...M.a@..|
+00000210  a2 ce ee 0b 7e 92 7e ff  76 9d c3 3b 7e a5 3f ce  |....~.~.v..;~.?.|
+00000220  fa 10 e2 59 ec 47 2d 7c  ac da 4e 97 0e 15 a0 6f  |...Y.G-|..N....o|
+00000230  d0 02 42 01 4d fc be 67  13 9c 2d 05 0e bd 3f a3  |..B.M..g..-...?.|
+00000240  8c 25 c1 33 13 83 0d 94  06 bb d4 37 7a f6 ec 7a  |.%.3.......7z..z|
+00000250  c9 86 2e dd d7 11 69 7f  85 7c 56 de fb 31 78 2b  |......i..|V..1x+|
+00000260  e4 c7 78 0d ae cb be 9e  4e 36 24 31 7b 6a 0f 39  |..x.....N6$1{j.9|
+00000270  95 12 07 8f 2a 16 03 03  00 b7 0c 00 00 b3 03 00  |....*...........|
+00000280  1d 20 f0 e0 d6 3e 40 a0  97 de 26 8a 52 25 2c a7  |. ...>@...&.R%,.|
+00000290  78 c5 ed 73 5c 59 ca 02  a8 9e 0d 69 bd cc bb 4b  |x..s\Y.....i...K|
+000002a0  11 3d 04 03 00 8b 30 81  88 02 42 00 ed 4d bc dc  |.=....0...B..M..|
+000002b0  d7 5e 95 b4 13 b3 fb 40  38 1a 53 09 71 a4 14 2a  |.^.....@8.S.q..*|
+000002c0  45 6f e3 fe db 0a c8 32  05 e6 98 17 bb f8 e9 72  |Eo.....2.......r|
+000002d0  db 5d e8 f5 b2 ad df 1b  62 dd b2 98 f8 6b 38 13  |.]......b....k8.|
+000002e0  a9 2f 13 1b ea db 58 24  4b e2 3a b9 5a 02 42 00  |./....X$K.:.Z.B.|
+000002f0  ea cd 03 cb b9 67 5c f3  99 35 cc 57 2a 58 12 45  |.....g\..5.W*X.E|
+00000300  c9 f1 e4 27 1a 42 2c ce  9c ba 10 f8 6f 15 41 67  |...'.B,.....o.Ag|
+00000310  07 33 38 94 dd 34 57 90  41 cf 16 04 b7 fc af ae  |.38..4W.A.......|
+00000320  6b ac 16 87 75 6d 60 52  e7 b9 1e 85 a3 45 92 a4  |k...um`R.....E..|
+00000330  cf 16 03 03 00 04 0e 00  00 00                    |..........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 7f ab 78  f0 a6 b6 57 bd c3 b9 32  |.... ..x...W...2|
-00000040  96 3f 7c 9d a0 4d dc 74  c9 e8 1a 88 c4 b2 10 27  |.?|..M.t.......'|
-00000050  e3 9c 1e 9b e1                                    |.....|
+00000030  16 03 03 00 20 24 01 e0  f7 26 b8 69 62 f7 98 45  |.... $...&.ib..E|
+00000040  6f 6d fc eb 37 c9 69 f1  21 eb 13 70 57 a9 5b de  |om..7.i.!..pW.[.|
+00000050  37 30 64 cc c1                                    |70d..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 0c b7 0c 47 8e  |.......... ...G.|
-00000010  40 6b 9f 9c d2 cd 24 25  db 12 e8 0c 50 be f3 98  |@k....$%....P...|
-00000020  4a 6f f9 42 58 07 b9 64  d0 00 91                 |Jo.BX..d...|
+00000000  14 03 03 00 01 01 16 03  03 00 20 8d fd f9 fd 18  |.......... .....|
+00000010  08 fa c1 5b 1c d1 03 bc  ba 36 6b 69 30 72 9c 92  |...[.....6ki0r..|
+00000020  f9 56 0c 5e ed 7b 91 e8  42 6c 26                 |.V.^.{..Bl&|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 1d 32 1c  ef 0b 1f a4 ba 39 a3 63  |......2......9.c|
-00000010  04 29 e5 67 1e bb 5a 6e  c7 3c c1 15 03 03 00 12  |.).g..Zn.<......|
-00000020  0e 0b 0f 49 30 fe d4 c3  35 85 e3 db 6e 65 e3 2d  |...I0...5...ne.-|
-00000030  d1 1d                                             |..|
+00000000  17 03 03 00 16 94 1f 97  8b 5b 66 15 63 a5 1e 78  |.........[f.c..x|
+00000010  c2 e3 4e 96 ae 08 16 d6  33 b8 60 15 03 03 00 12  |..N.....3.`.....|
+00000020  f9 71 c8 e5 93 b4 0d 17  97 0f 6d cb 58 0f 59 64  |.q........m.X.Yd|
+00000030  12 0f                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES
index ea6c7872ec..d5665daa2f 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,91 +7,92 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 1e 2f 6f fa 02  |....Y...U.../o..|
-00000010  44 3e 0d d0 3e b5 e6 0c  a2 d6 aa 04 5b ba 93 39  |D>..>.......[..9|
-00000020  29 dd e7 7e b8 11 f9 85  97 a5 e4 20 9c 64 e9 47  |)..~....... .d.G|
-00000030  cb 7c 0c 77 9d 83 5a c4  e8 05 62 40 95 8e 8e aa  |.|.w..Z...b@....|
-00000040  39 bb 24 8f b7 29 75 77  18 66 60 29 c0 13 00 00  |9.$..)uw.f`)....|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
-00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
-00000080  3f e2 5b ea a6 30 0d 06  09 2a 86 48 86 f7 0d 01  |?.[..0...*.H....|
-00000090  01 0b 05 00 30 1f 31 0b  30 09 06 03 55 04 0a 13  |....0.1.0...U...|
-000000a0  02 47 6f 31 10 30 0e 06  03 55 04 03 13 07 47 6f  |.Go1.0...U....Go|
-000000b0  20 52 6f 6f 74 30 1e 17  0d 31 36 30 31 30 31 30  | Root0...1601010|
-000000c0  30 30 30 30 30 5a 17 0d  32 35 30 31 30 31 30 30  |00000Z..25010100|
-000000d0  30 30 30 30 5a 30 1a 31  0b 30 09 06 03 55 04 0a  |0000Z0.1.0...U..|
-000000e0  13 02 47 6f 31 0b 30 09  06 03 55 04 03 13 02 47  |..Go1.0...U....G|
-000000f0  6f 30 81 9f 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |o0..0...*.H.....|
-00000100  01 05 00 03 81 8d 00 30  81 89 02 81 81 00 db 46  |.......0.......F|
-00000110  7d 93 2e 12 27 06 48 bc  06 28 21 ab 7e c4 b6 a2  |}...'.H..(!.~...|
-00000120  5d fe 1e 52 45 88 7a 36  47 a5 08 0d 92 42 5b c2  |]..RE.z6G....B[.|
-00000130  81 c0 be 97 79 98 40 fb  4f 6d 14 fd 2b 13 8b c2  |....y.@.Om..+...|
-00000140  a5 2e 67 d8 d4 09 9e d6  22 38 b7 4a 0b 74 73 2b  |..g....."8.J.ts+|
-00000150  c2 34 f1 d1 93 e5 96 d9  74 7b f3 58 9f 6c 61 3c  |.4......t{.X.la<|
-00000160  c0 b0 41 d4 d9 2b 2b 24  23 77 5b 1c 3b bd 75 5d  |..A..++$#w[.;.u]|
-00000170  ce 20 54 cf a1 63 87 1d  1e 24 c4 f3 1d 1a 50 8b  |. T..c...$....P.|
-00000180  aa b6 14 43 ed 97 a7 75  62 f4 14 c8 52 d7 02 03  |...C...ub...R...|
-00000190  01 00 01 a3 81 93 30 81  90 30 0e 06 03 55 1d 0f  |......0..0...U..|
-000001a0  01 01 ff 04 04 03 02 05  a0 30 1d 06 03 55 1d 25  |.........0...U.%|
-000001b0  04 16 30 14 06 08 2b 06  01 05 05 07 03 01 06 08  |..0...+.........|
-000001c0  2b 06 01 05 05 07 03 02  30 0c 06 03 55 1d 13 01  |+.......0...U...|
-000001d0  01 ff 04 02 30 00 30 19  06 03 55 1d 0e 04 12 04  |....0.0...U.....|
-000001e0  10 9f 91 16 1f 43 43 3e  49 a6 de 6d b6 80 d7 9f  |.....CC>I..m....|
-000001f0  60 30 1b 06 03 55 1d 23  04 14 30 12 80 10 48 13  |`0...U.#..0...H.|
-00000200  49 4d 13 7e 16 31 bb a3  01 d5 ac ab 6e 7b 30 19  |IM.~.1......n{0.|
-00000210  06 03 55 1d 11 04 12 30  10 82 0e 65 78 61 6d 70  |..U....0...examp|
-00000220  6c 65 2e 67 6f 6c 61 6e  67 30 0d 06 09 2a 86 48  |le.golang0...*.H|
-00000230  86 f7 0d 01 01 0b 05 00  03 81 81 00 9d 30 cc 40  |.............0.@|
-00000240  2b 5b 50 a0 61 cb ba e5  53 58 e1 ed 83 28 a9 58  |+[P.a...SX...(.X|
-00000250  1a a9 38 a4 95 a1 ac 31  5a 1a 84 66 3d 43 d3 2d  |..8....1Z..f=C.-|
-00000260  d9 0b f2 97 df d3 20 64  38 92 24 3a 00 bc cf 9c  |...... d8.$:....|
-00000270  7d b7 40 20 01 5f aa d3  16 61 09 a2 76 fd 13 c3  |}.@ ._...a..v...|
-00000280  cc e1 0c 5c ee b1 87 82  f1 6c 04 ed 73 bb b3 43  |...\.....l..s..C|
-00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
-000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
-000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 92 ed 81 60 d9 51 c2  |........ ...`.Q.|
-000002d0  00 3d 99 84 82 c5 83 67  60 b3 11 59 0c c5 5d ff  |.=.....g`..Y..].|
-000002e0  d6 28 79 68 2d 73 7f 84  40 08 04 00 80 b6 a0 4b  |.(yh-s..@......K|
-000002f0  3d fb e1 e6 76 cc ae e3  59 d0 1c 50 5c 09 5d 80  |=...v...Y..P\.].|
-00000300  c2 58 0d 36 d7 1a 78 e3  c2 66 73 3a 14 06 37 6f  |.X.6..x..fs:..7o|
-00000310  3a 95 2e 2a eb cc e5 e3  f7 30 eb 0d 33 04 51 6e  |:..*.....0..3.Qn|
-00000320  06 86 8f 53 6d fd 97 75  b3 13 2e 4e ee 8f 03 68  |...Sm..u...N...h|
-00000330  23 32 83 96 af 01 ed b0  21 a7 13 06 47 f4 08 b9  |#2......!...G...|
-00000340  8a 47 cc 12 99 20 c6 31  77 28 2c 2e d6 a0 20 8c  |.G... .1w(,... .|
-00000350  e6 67 c7 70 23 ed 98 9c  c9 47 1c e0 37 95 42 aa  |.g.p#....G..7.B.|
-00000360  c2 19 1b 55 09 5c 58 fb  ef 67 a9 b5 65 16 03 03  |...U.\X..g..e...|
-00000370  00 04 0e 00 00 00                                 |......|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 1e 8b e8 b6 ab  |....]...Y.......|
+00000010  28 56 58 92 6d 03 e6 46  aa 94 dc 6d a0 7b 6f db  |(VX.m..F...m.{o.|
+00000020  09 22 9f 48 14 de 37 bf  54 68 42 20 f8 0f 31 09  |.".H..7.ThB ..1.|
+00000030  56 de 8f ad db d7 ab 38  66 8b cf 86 1c 84 0d 9c  |V......8f.......|
+00000040  ad 24 c8 35 a8 28 8d 06  10 23 5e 34 c0 13 00 00  |.$.5.(...#^4....|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
+00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
+00000080  00 e8 f0 9d 3f e2 5b ea  a6 30 0d 06 09 2a 86 48  |....?.[..0...*.H|
+00000090  86 f7 0d 01 01 0b 05 00  30 1f 31 0b 30 09 06 03  |........0.1.0...|
+000000a0  55 04 0a 13 02 47 6f 31  10 30 0e 06 03 55 04 03  |U....Go1.0...U..|
+000000b0  13 07 47 6f 20 52 6f 6f  74 30 1e 17 0d 31 36 30  |..Go Root0...160|
+000000c0  31 30 31 30 30 30 30 30  30 5a 17 0d 32 35 30 31  |101000000Z..2501|
+000000d0  30 31 30 30 30 30 30 30  5a 30 1a 31 0b 30 09 06  |01000000Z0.1.0..|
+000000e0  03 55 04 0a 13 02 47 6f  31 0b 30 09 06 03 55 04  |.U....Go1.0...U.|
+000000f0  03 13 02 47 6f 30 81 9f  30 0d 06 09 2a 86 48 86  |...Go0..0...*.H.|
+00000100  f7 0d 01 01 01 05 00 03  81 8d 00 30 81 89 02 81  |...........0....|
+00000110  81 00 db 46 7d 93 2e 12  27 06 48 bc 06 28 21 ab  |...F}...'.H..(!.|
+00000120  7e c4 b6 a2 5d fe 1e 52  45 88 7a 36 47 a5 08 0d  |~...]..RE.z6G...|
+00000130  92 42 5b c2 81 c0 be 97  79 98 40 fb 4f 6d 14 fd  |.B[.....y.@.Om..|
+00000140  2b 13 8b c2 a5 2e 67 d8  d4 09 9e d6 22 38 b7 4a  |+.....g....."8.J|
+00000150  0b 74 73 2b c2 34 f1 d1  93 e5 96 d9 74 7b f3 58  |.ts+.4......t{.X|
+00000160  9f 6c 61 3c c0 b0 41 d4  d9 2b 2b 24 23 77 5b 1c  |.la<..A..++$#w[.|
+00000170  3b bd 75 5d ce 20 54 cf  a1 63 87 1d 1e 24 c4 f3  |;.u]. T..c...$..|
+00000180  1d 1a 50 8b aa b6 14 43  ed 97 a7 75 62 f4 14 c8  |..P....C...ub...|
+00000190  52 d7 02 03 01 00 01 a3  81 93 30 81 90 30 0e 06  |R.........0..0..|
+000001a0  03 55 1d 0f 01 01 ff 04  04 03 02 05 a0 30 1d 06  |.U...........0..|
+000001b0  03 55 1d 25 04 16 30 14  06 08 2b 06 01 05 05 07  |.U.%..0...+.....|
+000001c0  03 01 06 08 2b 06 01 05  05 07 03 02 30 0c 06 03  |....+.......0...|
+000001d0  55 1d 13 01 01 ff 04 02  30 00 30 19 06 03 55 1d  |U.......0.0...U.|
+000001e0  0e 04 12 04 10 9f 91 16  1f 43 43 3e 49 a6 de 6d  |.........CC>I..m|
+000001f0  b6 80 d7 9f 60 30 1b 06  03 55 1d 23 04 14 30 12  |....`0...U.#..0.|
+00000200  80 10 48 13 49 4d 13 7e  16 31 bb a3 01 d5 ac ab  |..H.IM.~.1......|
+00000210  6e 7b 30 19 06 03 55 1d  11 04 12 30 10 82 0e 65  |n{0...U....0...e|
+00000220  78 61 6d 70 6c 65 2e 67  6f 6c 61 6e 67 30 0d 06  |xample.golang0..|
+00000230  09 2a 86 48 86 f7 0d 01  01 0b 05 00 03 81 81 00  |.*.H............|
+00000240  9d 30 cc 40 2b 5b 50 a0  61 cb ba e5 53 58 e1 ed  |.0.@+[P.a...SX..|
+00000250  83 28 a9 58 1a a9 38 a4  95 a1 ac 31 5a 1a 84 66  |.(.X..8....1Z..f|
+00000260  3d 43 d3 2d d9 0b f2 97  df d3 20 64 38 92 24 3a  |=C.-...... d8.$:|
+00000270  00 bc cf 9c 7d b7 40 20  01 5f aa d3 16 61 09 a2  |....}.@ ._...a..|
+00000280  76 fd 13 c3 cc e1 0c 5c  ee b1 87 82 f1 6c 04 ed  |v......\.....l..|
+00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
+000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
+000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 e6 56 06  |............ .V.|
+000002d0  58 6f 5d 7a 59 32 f5 3e  7b 07 17 de 27 62 9e e8  |Xo]zY2.>{...'b..|
+000002e0  d0 42 f1 97 56 66 d0 d5  c1 06 b9 48 2f 08 04 00  |.B..Vf.....H/...|
+000002f0  80 1d 63 88 8e ed 58 f2  0e d3 b3 17 46 f3 9c 49  |..c...X.....F..I|
+00000300  bb 22 22 eb e2 77 13 6c  a5 aa 77 fe ad 16 06 23  |.""..w.l..w....#|
+00000310  c3 2a ec b9 76 43 4a 7f  41 72 5f 53 ae de 70 3a  |.*..vCJ.Ar_S..p:|
+00000320  f2 e9 60 92 30 2e f3 df  a1 3d 4a c1 1f 26 fa 42  |..`.0....=J..&.B|
+00000330  c8 31 cb 97 c0 5c 6b 8e  d9 18 28 be 99 7c d1 75  |.1...\k...(..|.u|
+00000340  05 ad 22 91 4f 55 ae 50  2c fa 37 ee 28 e9 64 1c  |..".OU.P,.7.(.d.|
+00000350  2b 2a c5 95 f5 90 ae ae  d4 a3 50 f3 fe 26 71 4f  |+*........P..&qO|
+00000360  55 db 32 03 1f 5c 3f 91  20 85 d5 e1 73 45 43 59  |U.2..\?. ...sECY|
+00000370  e5 16 03 03 00 04 0e 00  00 00                    |..........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
 00000030  16 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000040  00 00 00 00 00 dd 81 23  e0 a3 01 33 bb 87 0d 93  |.......#...3....|
-00000050  b2 61 16 01 e3 87 e0 05  cc b0 ec 15 56 df ff 9c  |.a..........V...|
-00000060  e6 9c 6a 57 79 8a 0b 86  f9 fb 60 3f ca 0d ef f2  |..jWy.....`?....|
-00000070  81 c0 5e 22 bf                                    |..^".|
+00000040  00 00 00 00 00 f9 b1 38  55 39 80 ba c1 07 e1 40  |.......8U9.....@|
+00000050  b9 ac 39 da bc 66 ad c3  6d dc 1b f0 bd 2a 92 ce  |..9..f..m....*..|
+00000060  4b b5 97 33 5b 3b 21 6d  91 f4 dd 09 07 73 5d a2  |K..3[;!m.....s].|
+00000070  b4 a3 a0 6d 43                                    |...mC|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 40 d4 d3 ba 7f 4c  |..........@....L|
-00000010  1a ee d9 ca 66 a0 5b d7  08 78 5d 5c fd 17 32 71  |....f.[..x]\..2q|
-00000020  7f 8c 2e eb 80 bc 82 0f  0c ed 71 ac 34 59 71 d1  |..........q.4Yq.|
-00000030  aa d3 fd 0c 50 7d 4b 1b  01 5d 4c 03 9f 6c 16 8f  |....P}K..]L..l..|
-00000040  5d f7 8d c0 4b 3f 01 96  23 40 22                 |]...K?..#@"|
+00000000  14 03 03 00 01 01 16 03  03 00 40 82 12 f1 e0 35  |..........@....5|
+00000010  74 0c e5 68 7c 6b b6 fb  e9 36 b3 5e 95 13 6b 04  |t..h|k...6.^..k.|
+00000020  00 59 18 f0 51 50 93 2e  e9 1b c6 e9 11 62 7c 01  |.Y..QP.......b|.|
+00000030  43 e8 68 7b 87 a9 d5 17  3f 73 de f2 06 12 9f c7  |C.h{....?s......|
+00000040  a4 81 45 52 dd 9f 6f fa  ab 82 86                 |..ER..o....|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-00000010  00 00 00 00 00 36 49 0e  f6 26 13 f7 69 15 54 27  |.....6I..&..i.T'|
-00000020  5a e6 f2 fb 7d ad e0 30  d3 cd ed 08 24 74 5f 77  |Z...}..0....$t_w|
-00000030  f7 8b 3f bf 94 15 03 03  00 30 00 00 00 00 00 00  |..?......0......|
-00000040  00 00 00 00 00 00 00 00  00 00 28 09 ed 2f d8 6f  |..........(../.o|
-00000050  95 fc db 9e ec d8 81 7e  a4 d4 8e c5 ec d3 24 bc  |.......~......$.|
-00000060  ab 52 e6 01 75 98 b9 e5  9f d9                    |.R..u.....|
+00000010  00 00 00 00 00 21 96 5b  74 b3 c1 96 e9 4f 6d 97  |.....!.[t....Om.|
+00000020  70 1c 5d c2 60 32 a1 98  12 2b 0d 4c 11 03 fe 17  |p.].`2...+.L....|
+00000030  28 92 06 2f 84 15 03 03  00 30 00 00 00 00 00 00  |(../.....0......|
+00000040  00 00 00 00 00 00 00 00  00 00 78 bf 75 9e 08 8d  |..........x.u...|
+00000050  57 5a 22 17 e9 d3 bd 3c  e4 ac e6 58 7a e8 5e 45  |WZ"....<...Xz.^E|
+00000060  63 10 b6 b8 df 78 c5 10  48 c0                    |c....x..H.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256 b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256
index 88d0d01483..03679a4fc1 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,95 +7,96 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 e6 04 5e a9 bb  |....Y...U....^..|
-00000010  23 56 bd cc e7 72 9f 10  b1 fc 23 48 22 19 cb 27  |#V...r....#H"..'|
-00000020  3e c4 22 ec b9 7a 9c 81  60 c5 55 20 b9 7f 8a 0e  |>."..z..`.U ....|
-00000030  6b d6 cf cb 35 85 52 f3  9f 28 00 87 22 88 6d 7c  |k...5.R..(..".m||
-00000040  35 0e f6 af 7c 28 b4 71  cc 46 c1 b5 c0 27 00 00  |5...|(.q.F...'..|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
-00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
-00000080  3f e2 5b ea a6 30 0d 06  09 2a 86 48 86 f7 0d 01  |?.[..0...*.H....|
-00000090  01 0b 05 00 30 1f 31 0b  30 09 06 03 55 04 0a 13  |....0.1.0...U...|
-000000a0  02 47 6f 31 10 30 0e 06  03 55 04 03 13 07 47 6f  |.Go1.0...U....Go|
-000000b0  20 52 6f 6f 74 30 1e 17  0d 31 36 30 31 30 31 30  | Root0...1601010|
-000000c0  30 30 30 30 30 5a 17 0d  32 35 30 31 30 31 30 30  |00000Z..25010100|
-000000d0  30 30 30 30 5a 30 1a 31  0b 30 09 06 03 55 04 0a  |0000Z0.1.0...U..|
-000000e0  13 02 47 6f 31 0b 30 09  06 03 55 04 03 13 02 47  |..Go1.0...U....G|
-000000f0  6f 30 81 9f 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |o0..0...*.H.....|
-00000100  01 05 00 03 81 8d 00 30  81 89 02 81 81 00 db 46  |.......0.......F|
-00000110  7d 93 2e 12 27 06 48 bc  06 28 21 ab 7e c4 b6 a2  |}...'.H..(!.~...|
-00000120  5d fe 1e 52 45 88 7a 36  47 a5 08 0d 92 42 5b c2  |]..RE.z6G....B[.|
-00000130  81 c0 be 97 79 98 40 fb  4f 6d 14 fd 2b 13 8b c2  |....y.@.Om..+...|
-00000140  a5 2e 67 d8 d4 09 9e d6  22 38 b7 4a 0b 74 73 2b  |..g....."8.J.ts+|
-00000150  c2 34 f1 d1 93 e5 96 d9  74 7b f3 58 9f 6c 61 3c  |.4......t{.X.la<|
-00000160  c0 b0 41 d4 d9 2b 2b 24  23 77 5b 1c 3b bd 75 5d  |..A..++$#w[.;.u]|
-00000170  ce 20 54 cf a1 63 87 1d  1e 24 c4 f3 1d 1a 50 8b  |. T..c...$....P.|
-00000180  aa b6 14 43 ed 97 a7 75  62 f4 14 c8 52 d7 02 03  |...C...ub...R...|
-00000190  01 00 01 a3 81 93 30 81  90 30 0e 06 03 55 1d 0f  |......0..0...U..|
-000001a0  01 01 ff 04 04 03 02 05  a0 30 1d 06 03 55 1d 25  |.........0...U.%|
-000001b0  04 16 30 14 06 08 2b 06  01 05 05 07 03 01 06 08  |..0...+.........|
-000001c0  2b 06 01 05 05 07 03 02  30 0c 06 03 55 1d 13 01  |+.......0...U...|
-000001d0  01 ff 04 02 30 00 30 19  06 03 55 1d 0e 04 12 04  |....0.0...U.....|
-000001e0  10 9f 91 16 1f 43 43 3e  49 a6 de 6d b6 80 d7 9f  |.....CC>I..m....|
-000001f0  60 30 1b 06 03 55 1d 23  04 14 30 12 80 10 48 13  |`0...U.#..0...H.|
-00000200  49 4d 13 7e 16 31 bb a3  01 d5 ac ab 6e 7b 30 19  |IM.~.1......n{0.|
-00000210  06 03 55 1d 11 04 12 30  10 82 0e 65 78 61 6d 70  |..U....0...examp|
-00000220  6c 65 2e 67 6f 6c 61 6e  67 30 0d 06 09 2a 86 48  |le.golang0...*.H|
-00000230  86 f7 0d 01 01 0b 05 00  03 81 81 00 9d 30 cc 40  |.............0.@|
-00000240  2b 5b 50 a0 61 cb ba e5  53 58 e1 ed 83 28 a9 58  |+[P.a...SX...(.X|
-00000250  1a a9 38 a4 95 a1 ac 31  5a 1a 84 66 3d 43 d3 2d  |..8....1Z..f=C.-|
-00000260  d9 0b f2 97 df d3 20 64  38 92 24 3a 00 bc cf 9c  |...... d8.$:....|
-00000270  7d b7 40 20 01 5f aa d3  16 61 09 a2 76 fd 13 c3  |}.@ ._...a..v...|
-00000280  cc e1 0c 5c ee b1 87 82  f1 6c 04 ed 73 bb b3 43  |...\.....l..s..C|
-00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
-000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
-000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 55 af 53 a0 54 77 df  |........ U.S.Tw.|
-000002d0  ca 8f 49 1a 4d d0 9b 24  a6 a9 2b b2 2a 33 46 b8  |..I.M..$..+.*3F.|
-000002e0  01 d6 4e fd fb c1 e4 e6  64 08 04 00 80 5c da 2f  |..N.....d....\./|
-000002f0  01 2b 10 b9 e9 35 f2 b1  2a 28 4f 78 58 7b 3d 9a  |.+...5..*(OxX{=.|
-00000300  13 e4 7c 77 41 95 fa 7a  90 1f eb f5 20 55 7c 76  |..|wA..z.... U|v|
-00000310  dd c5 66 08 88 eb ba 17  f0 de f3 0c a5 a6 3c 21  |..f...........<!|
-00000320  52 89 25 b1 4d 86 e3 0b  8a 14 dc 8b a6 76 41 25  |R.%.M........vA%|
-00000330  9e d3 20 b6 61 8a 26 8b  0d b7 cb 98 ac 45 e0 3b  |.. .a.&......E.;|
-00000340  6f d6 b2 52 8b a2 31 63  c8 44 1d 2a 3a c1 35 87  |o..R..1c.D.*:.5.|
-00000350  7a 7b 2a fa dd ab d3 48  9b e2 fa e1 93 7c 09 f7  |z{*....H.....|..|
-00000360  e1 72 83 f8 23 07 30 3a  4a 4f 56 97 1b 16 03 03  |.r..#.0:JOV.....|
-00000370  00 04 0e 00 00 00                                 |......|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 3d 4c 61 a3 1e  |....]...Y..=La..|
+00000010  dd 9a c3 52 42 9d ee 2b  7b f6 24 a4 38 d7 93 e9  |...RB..+{.$.8...|
+00000020  f5 f4 09 a2 0f 2b 45 ae  7d fd 97 20 3b b6 27 a6  |.....+E.}.. ;.'.|
+00000030  88 dd af 75 8d 27 1c c6  ef 8f 4b 33 c6 30 be 08  |...u.'....K3.0..|
+00000040  7d bd 8d cd 2e d8 37 0b  67 e3 39 30 c0 27 00 00  |}.....7.g.90.'..|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
+00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
+00000080  00 e8 f0 9d 3f e2 5b ea  a6 30 0d 06 09 2a 86 48  |....?.[..0...*.H|
+00000090  86 f7 0d 01 01 0b 05 00  30 1f 31 0b 30 09 06 03  |........0.1.0...|
+000000a0  55 04 0a 13 02 47 6f 31  10 30 0e 06 03 55 04 03  |U....Go1.0...U..|
+000000b0  13 07 47 6f 20 52 6f 6f  74 30 1e 17 0d 31 36 30  |..Go Root0...160|
+000000c0  31 30 31 30 30 30 30 30  30 5a 17 0d 32 35 30 31  |101000000Z..2501|
+000000d0  30 31 30 30 30 30 30 30  5a 30 1a 31 0b 30 09 06  |01000000Z0.1.0..|
+000000e0  03 55 04 0a 13 02 47 6f  31 0b 30 09 06 03 55 04  |.U....Go1.0...U.|
+000000f0  03 13 02 47 6f 30 81 9f  30 0d 06 09 2a 86 48 86  |...Go0..0...*.H.|
+00000100  f7 0d 01 01 01 05 00 03  81 8d 00 30 81 89 02 81  |...........0....|
+00000110  81 00 db 46 7d 93 2e 12  27 06 48 bc 06 28 21 ab  |...F}...'.H..(!.|
+00000120  7e c4 b6 a2 5d fe 1e 52  45 88 7a 36 47 a5 08 0d  |~...]..RE.z6G...|
+00000130  92 42 5b c2 81 c0 be 97  79 98 40 fb 4f 6d 14 fd  |.B[.....y.@.Om..|
+00000140  2b 13 8b c2 a5 2e 67 d8  d4 09 9e d6 22 38 b7 4a  |+.....g....."8.J|
+00000150  0b 74 73 2b c2 34 f1 d1  93 e5 96 d9 74 7b f3 58  |.ts+.4......t{.X|
+00000160  9f 6c 61 3c c0 b0 41 d4  d9 2b 2b 24 23 77 5b 1c  |.la<..A..++$#w[.|
+00000170  3b bd 75 5d ce 20 54 cf  a1 63 87 1d 1e 24 c4 f3  |;.u]. T..c...$..|
+00000180  1d 1a 50 8b aa b6 14 43  ed 97 a7 75 62 f4 14 c8  |..P....C...ub...|
+00000190  52 d7 02 03 01 00 01 a3  81 93 30 81 90 30 0e 06  |R.........0..0..|
+000001a0  03 55 1d 0f 01 01 ff 04  04 03 02 05 a0 30 1d 06  |.U...........0..|
+000001b0  03 55 1d 25 04 16 30 14  06 08 2b 06 01 05 05 07  |.U.%..0...+.....|
+000001c0  03 01 06 08 2b 06 01 05  05 07 03 02 30 0c 06 03  |....+.......0...|
+000001d0  55 1d 13 01 01 ff 04 02  30 00 30 19 06 03 55 1d  |U.......0.0...U.|
+000001e0  0e 04 12 04 10 9f 91 16  1f 43 43 3e 49 a6 de 6d  |.........CC>I..m|
+000001f0  b6 80 d7 9f 60 30 1b 06  03 55 1d 23 04 14 30 12  |....`0...U.#..0.|
+00000200  80 10 48 13 49 4d 13 7e  16 31 bb a3 01 d5 ac ab  |..H.IM.~.1......|
+00000210  6e 7b 30 19 06 03 55 1d  11 04 12 30 10 82 0e 65  |n{0...U....0...e|
+00000220  78 61 6d 70 6c 65 2e 67  6f 6c 61 6e 67 30 0d 06  |xample.golang0..|
+00000230  09 2a 86 48 86 f7 0d 01  01 0b 05 00 03 81 81 00  |.*.H............|
+00000240  9d 30 cc 40 2b 5b 50 a0  61 cb ba e5 53 58 e1 ed  |.0.@+[P.a...SX..|
+00000250  83 28 a9 58 1a a9 38 a4  95 a1 ac 31 5a 1a 84 66  |.(.X..8....1Z..f|
+00000260  3d 43 d3 2d d9 0b f2 97  df d3 20 64 38 92 24 3a  |=C.-...... d8.$:|
+00000270  00 bc cf 9c 7d b7 40 20  01 5f aa d3 16 61 09 a2  |....}.@ ._...a..|
+00000280  76 fd 13 c3 cc e1 0c 5c  ee b1 87 82 f1 6c 04 ed  |v......\.....l..|
+00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
+000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
+000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 a4 26 51  |............ .&Q|
+000002d0  47 58 cf 92 87 27 f0 c1  c0 39 55 dd 20 16 39 de  |GX...'...9U. .9.|
+000002e0  ed 79 66 3a 97 54 75 35  27 20 7b 99 76 08 04 00  |.yf:.Tu5' {.v...|
+000002f0  80 34 32 55 55 c1 56 69  b8 4a f7 a6 d1 9d ae f6  |.42UU.Vi.J......|
+00000300  0d de 13 e2 bd b8 9a 5c  42 f2 b5 42 d9 25 69 fe  |.......\B..B.%i.|
+00000310  ef b3 c3 0f 1b b7 a0 61  1d 1d 59 31 1c 4c 61 17  |.......a..Y1.La.|
+00000320  6e 2d bc b4 08 76 ee d2  46 d4 81 c1 cc e9 96 22  |n-...v..F......"|
+00000330  10 07 a5 c0 c6 26 42 c6  37 42 56 e5 47 f2 44 d1  |.....&B.7BV.G.D.|
+00000340  57 1d c8 8d c1 2c 28 be  e9 7a 82 2e f1 8e 1a bf  |W....,(..z......|
+00000350  4a f0 f2 22 de 78 00 c2  d3 f4 99 ba e9 d3 7e fc  |J..".x........~.|
+00000360  83 bf ef 7c 64 c6 c4 dd  fb 30 e2 f9 43 43 91 60  |...|d....0..CC.`|
+00000370  83 16 03 03 00 04 0e 00  00 00                    |..........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
 00000030  16 03 03 00 50 00 00 00  00 00 00 00 00 00 00 00  |....P...........|
-00000040  00 00 00 00 00 91 c1 82  23 f0 03 79 83 38 ef d0  |........#..y.8..|
-00000050  73 71 9b 7d 55 5e 53 3b  d3 cf 86 48 60 2f 42 97  |sq.}U^S;...H`/B.|
-00000060  63 e8 4b 20 4c 92 3e 2f  aa b3 32 46 8a 96 69 42  |c.K L.>/..2F..iB|
-00000070  96 9a 4b bd 04 f2 3d b6  5f f9 37 4f a4 3d f1 cb  |..K...=._.7O.=..|
-00000080  d5 57 fc 5e 8e                                    |.W.^.|
+00000040  00 00 00 00 00 06 06 f1  9b b7 1f f1 0d 24 fe 76  |.............$.v|
+00000050  8a 72 84 58 8c 56 bd c3  73 4e c8 99 3c 5b 21 79  |.r.X.V..sN..<[!y|
+00000060  17 23 21 bd 72 0d fb f7  22 36 99 78 1f 88 d1 87  |.#!.r..."6.x....|
+00000070  73 c3 62 aa a5 22 a6 63  68 41 bb 61 34 50 b9 e7  |s.b..".chA.a4P..|
+00000080  ce 6d 0b 18 f0                                    |.m...|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 50 e1 91 69 dc 7b  |..........P..i.{|
-00000010  5f a4 c7 7a 8f ba bb 8d  98 c3 0e 3f 10 f1 3e 3f  |_..z.......?..>?|
-00000020  37 6f 11 81 3f c5 7c 22  6f 22 a3 94 ae 3a 77 17  |7o..?.|"o"...:w.|
-00000030  a2 7b cc 8e 5e 6e 9b 4b  98 fd 16 f8 46 9e 78 19  |.{..^n.K....F.x.|
-00000040  43 e6 da e3 05 9a 0a 49  b0 09 c7 e5 4b 41 dc b4  |C......I....KA..|
-00000050  c0 81 9b 46 7e dd c3 64  2e f8 6e                 |...F~..d..n|
+00000000  14 03 03 00 01 01 16 03  03 00 50 f4 00 f2 81 78  |..........P....x|
+00000010  0f 4b d9 3a 2d 62 34 77  74 6e b6 d5 e8 62 55 88  |.K.:-b4wtn...bU.|
+00000020  7e 60 e4 e7 b7 35 9d dc  50 02 d2 10 ae 36 7a 5d  |~`...5..P....6z]|
+00000030  36 c5 89 2c 4e db 9c 83  9e d0 ec de 6e 63 1c 94  |6..,N.......nc..|
+00000040  4c ed 12 ca ef 62 a1 26  a7 f9 fd 52 ad b9 1a 2b  |L....b.&...R...+|
+00000050  cc bc 01 bb cc 86 b5 1b  74 60 80                 |........t`.|
 >>> Flow 5 (client to server)
 00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000010  00 00 00 00 00 65 4c 71  31 d4 47 4d 0b 81 1f 75  |.....eLq1.GM...u|
-00000020  b6 71 64 4a e6 a8 80 a1  f1 e2 0a 14 77 af a4 c6  |.qdJ........w...|
-00000030  1d 6a 7d 79 6a 15 a1 0e  86 6c 8e e1 32 64 0b 5d  |.j}yj....l..2d.]|
-00000040  af e0 f5 05 91 15 03 03  00 40 00 00 00 00 00 00  |.........@......|
-00000050  00 00 00 00 00 00 00 00  00 00 ca 46 1b 95 2a 41  |...........F..*A|
-00000060  ce dc 30 d6 e0 cf 2f 2b  1f 61 81 33 a4 58 e7 af  |..0.../+.a.3.X..|
-00000070  90 9c 15 42 9b ab 26 64  d1 39 46 45 6b 74 b9 c4  |...B..&d.9FEkt..|
-00000080  21 d9 ef 2d 69 51 dc e7  8a 6b                    |!..-iQ...k|
+00000010  00 00 00 00 00 67 6b 64  7b 02 ce ad 5c df 4d 26  |.....gkd{...\.M&|
+00000020  f9 ef d5 94 ec 34 28 de  52 1a d9 1b e3 af 89 11  |.....4(.R.......|
+00000030  7b aa f6 46 8a 27 e7 15  c0 81 89 78 20 09 ca 37  |{..F.'.....x ..7|
+00000040  dc a3 c2 5c 4f 15 03 03  00 40 00 00 00 00 00 00  |...\O....@......|
+00000050  00 00 00 00 00 00 00 00  00 00 61 45 e8 a0 f8 70  |..........aE...p|
+00000060  7b a3 75 09 42 b2 41 54  79 b3 75 48 47 f1 36 1b  |{.u.B.ATy.uHG.6.|
+00000070  4c cd 29 57 fe 9f 41 a7  7f 5c a9 12 7a ec c6 1d  |L.)W..A..\..z...|
+00000080  9c fb ff 1e e5 58 04 ae  16 50                    |.....X...P|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-CHACHA20-POLY1305 b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-CHACHA20-POLY1305
index 2c2cb455d1..3c5779c4ed 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-CHACHA20-POLY1305
+++ b/src/crypto/tls/testdata/Client-TLSv12-ECDHE-RSA-CHACHA20-POLY1305
@@ -1,88 +1,88 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 d0 01 00 00  cc 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 d4 01 00 00  d0 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 00 08 cc a8  |................|
-00000050  13 03 13 01 13 02 01 00  00 7b 00 05 00 05 01 00  |.........{......|
+00000050  13 03 13 01 13 02 01 00  00 7f 00 05 00 05 01 00  |................|
 00000060  00 00 00 00 0a 00 0a 00  08 00 1d 00 17 00 18 00  |................|
 00000070  19 00 0b 00 02 01 00 00  0d 00 1a 00 18 08 04 04  |................|
 00000080  03 08 07 08 05 08 06 04  01 05 01 06 01 05 03 06  |................|
-00000090  03 02 01 02 03 ff 01 00  01 00 00 12 00 00 00 2b  |...............+|
-000000a0  00 09 08 03 04 03 03 03  02 03 01 00 33 00 26 00  |............3.&.|
-000000b0  24 00 1d 00 20 2f e5 7d  a3 47 cd 62 43 15 28 da  |$... /.}.G.bC.(.|
-000000c0  ac 5f bb 29 07 30 ff f6  84 af c4 cf c2 ed 90 99  |._.).0..........|
-000000d0  5f 58 cb 3b 74                                    |_X.;t|
+00000090  03 02 01 02 03 ff 01 00  01 00 00 17 00 00 00 12  |................|
+000000a0  00 00 00 2b 00 09 08 03  04 03 03 03 02 03 01 00  |...+............|
+000000b0  33 00 26 00 24 00 1d 00  20 2f e5 7d a3 47 cd 62  |3.&.$... /.}.G.b|
+000000c0  43 15 28 da ac 5f bb 29  07 30 ff f6 84 af c4 cf  |C.(.._.).0......|
+000000d0  c2 ed 90 99 5f 58 cb 3b  74                       |...._X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 2a 76 db 4b d5  |....Y...U..*v.K.|
-00000010  10 f3 21 f2 4b 29 a2 2e  7a 7d 0b 86 c4 af 60 95  |..!.K)..z}....`.|
-00000020  5b 11 84 27 8a 59 7f af  a0 27 de 20 02 f7 dc 9b  |[..'.Y...'. ....|
-00000030  63 8e 2e da 48 b5 73 81  8e 76 13 da dd 2e 17 2b  |c...H.s..v.....+|
-00000040  ff 18 ad d7 9d f3 44 ed  b6 60 0e 42 cc a8 00 00  |......D..`.B....|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
-00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
-00000080  3f e2 5b ea a6 30 0d 06  09 2a 86 48 86 f7 0d 01  |?.[..0...*.H....|
-00000090  01 0b 05 00 30 1f 31 0b  30 09 06 03 55 04 0a 13  |....0.1.0...U...|
-000000a0  02 47 6f 31 10 30 0e 06  03 55 04 03 13 07 47 6f  |.Go1.0...U....Go|
-000000b0  20 52 6f 6f 74 30 1e 17  0d 31 36 30 31 30 31 30  | Root0...1601010|
-000000c0  30 30 30 30 30 5a 17 0d  32 35 30 31 30 31 30 30  |00000Z..25010100|
-000000d0  30 30 30 30 5a 30 1a 31  0b 30 09 06 03 55 04 0a  |0000Z0.1.0...U..|
-000000e0  13 02 47 6f 31 0b 30 09  06 03 55 04 03 13 02 47  |..Go1.0...U....G|
-000000f0  6f 30 81 9f 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |o0..0...*.H.....|
-00000100  01 05 00 03 81 8d 00 30  81 89 02 81 81 00 db 46  |.......0.......F|
-00000110  7d 93 2e 12 27 06 48 bc  06 28 21 ab 7e c4 b6 a2  |}...'.H..(!.~...|
-00000120  5d fe 1e 52 45 88 7a 36  47 a5 08 0d 92 42 5b c2  |]..RE.z6G....B[.|
-00000130  81 c0 be 97 79 98 40 fb  4f 6d 14 fd 2b 13 8b c2  |....y.@.Om..+...|
-00000140  a5 2e 67 d8 d4 09 9e d6  22 38 b7 4a 0b 74 73 2b  |..g....."8.J.ts+|
-00000150  c2 34 f1 d1 93 e5 96 d9  74 7b f3 58 9f 6c 61 3c  |.4......t{.X.la<|
-00000160  c0 b0 41 d4 d9 2b 2b 24  23 77 5b 1c 3b bd 75 5d  |..A..++$#w[.;.u]|
-00000170  ce 20 54 cf a1 63 87 1d  1e 24 c4 f3 1d 1a 50 8b  |. T..c...$....P.|
-00000180  aa b6 14 43 ed 97 a7 75  62 f4 14 c8 52 d7 02 03  |...C...ub...R...|
-00000190  01 00 01 a3 81 93 30 81  90 30 0e 06 03 55 1d 0f  |......0..0...U..|
-000001a0  01 01 ff 04 04 03 02 05  a0 30 1d 06 03 55 1d 25  |.........0...U.%|
-000001b0  04 16 30 14 06 08 2b 06  01 05 05 07 03 01 06 08  |..0...+.........|
-000001c0  2b 06 01 05 05 07 03 02  30 0c 06 03 55 1d 13 01  |+.......0...U...|
-000001d0  01 ff 04 02 30 00 30 19  06 03 55 1d 0e 04 12 04  |....0.0...U.....|
-000001e0  10 9f 91 16 1f 43 43 3e  49 a6 de 6d b6 80 d7 9f  |.....CC>I..m....|
-000001f0  60 30 1b 06 03 55 1d 23  04 14 30 12 80 10 48 13  |`0...U.#..0...H.|
-00000200  49 4d 13 7e 16 31 bb a3  01 d5 ac ab 6e 7b 30 19  |IM.~.1......n{0.|
-00000210  06 03 55 1d 11 04 12 30  10 82 0e 65 78 61 6d 70  |..U....0...examp|
-00000220  6c 65 2e 67 6f 6c 61 6e  67 30 0d 06 09 2a 86 48  |le.golang0...*.H|
-00000230  86 f7 0d 01 01 0b 05 00  03 81 81 00 9d 30 cc 40  |.............0.@|
-00000240  2b 5b 50 a0 61 cb ba e5  53 58 e1 ed 83 28 a9 58  |+[P.a...SX...(.X|
-00000250  1a a9 38 a4 95 a1 ac 31  5a 1a 84 66 3d 43 d3 2d  |..8....1Z..f=C.-|
-00000260  d9 0b f2 97 df d3 20 64  38 92 24 3a 00 bc cf 9c  |...... d8.$:....|
-00000270  7d b7 40 20 01 5f aa d3  16 61 09 a2 76 fd 13 c3  |}.@ ._...a..v...|
-00000280  cc e1 0c 5c ee b1 87 82  f1 6c 04 ed 73 bb b3 43  |...\.....l..s..C|
-00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
-000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
-000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 0d c3 c2 b5 73 da 39  |........ ....s.9|
-000002d0  82 e5 8c 18 0d 8d 16 c2  a5 e7 3e 39 fd 25 00 18  |..........>9.%..|
-000002e0  25 16 c0 a7 6e c6 dd bb  01 08 04 00 80 b3 bd 01  |%...n...........|
-000002f0  ae dd b1 c8 2a 5d 0e 66  6d 1e b3 92 f4 01 63 59  |....*].fm.....cY|
-00000300  0c c1 62 df 75 8f 4f 19  5a cf 2f 63 79 d0 06 31  |..b.u.O.Z./cy..1|
-00000310  c0 60 6a 4f db 70 18 bd  80 8b 30 94 40 dd 13 39  |.`jO.p....0.@..9|
-00000320  4f db 2b 54 a4 97 f7 ef  a5 a3 ff f5 14 3d e2 2d  |O.+T.........=.-|
-00000330  0c 0e 71 4a bd a8 59 48  ab 06 55 53 45 2a ee 3e  |..qJ..YH..USE*.>|
-00000340  65 1f 47 ee 8d e3 f6 4e  2e b1 4c d0 af 50 15 02  |e.G....N..L..P..|
-00000350  5e 84 fe 76 d5 f3 c5 fb  2a 91 44 f0 92 32 ee ea  |^..v....*.D..2..|
-00000360  a0 26 77 5c 94 88 24 e3  2f 75 e3 fd b7 16 03 03  |.&w\..$./u......|
-00000370  00 04 0e 00 00 00                                 |......|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 fa 07 a1 2e 81  |....]...Y.......|
+00000010  44 c8 72 44 5b 86 21 61  2f 3e 37 92 0f d5 7f d3  |D.rD[.!a/>7.....|
+00000020  0b 11 9a 5f d9 40 db 25  e4 2d da 20 11 0f ba 98  |..._.@.%.-. ....|
+00000030  8b fd 6f 93 c7 05 08 69  d6 c5 bc ef 3e 2b b8 98  |..o....i....>+..|
+00000040  10 f6 bc 57 72 81 a9 c0  96 1e a4 d2 cc a8 00 00  |...Wr...........|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
+00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
+00000080  00 e8 f0 9d 3f e2 5b ea  a6 30 0d 06 09 2a 86 48  |....?.[..0...*.H|
+00000090  86 f7 0d 01 01 0b 05 00  30 1f 31 0b 30 09 06 03  |........0.1.0...|
+000000a0  55 04 0a 13 02 47 6f 31  10 30 0e 06 03 55 04 03  |U....Go1.0...U..|
+000000b0  13 07 47 6f 20 52 6f 6f  74 30 1e 17 0d 31 36 30  |..Go Root0...160|
+000000c0  31 30 31 30 30 30 30 30  30 5a 17 0d 32 35 30 31  |101000000Z..2501|
+000000d0  30 31 30 30 30 30 30 30  5a 30 1a 31 0b 30 09 06  |01000000Z0.1.0..|
+000000e0  03 55 04 0a 13 02 47 6f  31 0b 30 09 06 03 55 04  |.U....Go1.0...U.|
+000000f0  03 13 02 47 6f 30 81 9f  30 0d 06 09 2a 86 48 86  |...Go0..0...*.H.|
+00000100  f7 0d 01 01 01 05 00 03  81 8d 00 30 81 89 02 81  |...........0....|
+00000110  81 00 db 46 7d 93 2e 12  27 06 48 bc 06 28 21 ab  |...F}...'.H..(!.|
+00000120  7e c4 b6 a2 5d fe 1e 52  45 88 7a 36 47 a5 08 0d  |~...]..RE.z6G...|
+00000130  92 42 5b c2 81 c0 be 97  79 98 40 fb 4f 6d 14 fd  |.B[.....y.@.Om..|
+00000140  2b 13 8b c2 a5 2e 67 d8  d4 09 9e d6 22 38 b7 4a  |+.....g....."8.J|
+00000150  0b 74 73 2b c2 34 f1 d1  93 e5 96 d9 74 7b f3 58  |.ts+.4......t{.X|
+00000160  9f 6c 61 3c c0 b0 41 d4  d9 2b 2b 24 23 77 5b 1c  |.la<..A..++$#w[.|
+00000170  3b bd 75 5d ce 20 54 cf  a1 63 87 1d 1e 24 c4 f3  |;.u]. T..c...$..|
+00000180  1d 1a 50 8b aa b6 14 43  ed 97 a7 75 62 f4 14 c8  |..P....C...ub...|
+00000190  52 d7 02 03 01 00 01 a3  81 93 30 81 90 30 0e 06  |R.........0..0..|
+000001a0  03 55 1d 0f 01 01 ff 04  04 03 02 05 a0 30 1d 06  |.U...........0..|
+000001b0  03 55 1d 25 04 16 30 14  06 08 2b 06 01 05 05 07  |.U.%..0...+.....|
+000001c0  03 01 06 08 2b 06 01 05  05 07 03 02 30 0c 06 03  |....+.......0...|
+000001d0  55 1d 13 01 01 ff 04 02  30 00 30 19 06 03 55 1d  |U.......0.0...U.|
+000001e0  0e 04 12 04 10 9f 91 16  1f 43 43 3e 49 a6 de 6d  |.........CC>I..m|
+000001f0  b6 80 d7 9f 60 30 1b 06  03 55 1d 23 04 14 30 12  |....`0...U.#..0.|
+00000200  80 10 48 13 49 4d 13 7e  16 31 bb a3 01 d5 ac ab  |..H.IM.~.1......|
+00000210  6e 7b 30 19 06 03 55 1d  11 04 12 30 10 82 0e 65  |n{0...U....0...e|
+00000220  78 61 6d 70 6c 65 2e 67  6f 6c 61 6e 67 30 0d 06  |xample.golang0..|
+00000230  09 2a 86 48 86 f7 0d 01  01 0b 05 00 03 81 81 00  |.*.H............|
+00000240  9d 30 cc 40 2b 5b 50 a0  61 cb ba e5 53 58 e1 ed  |.0.@+[P.a...SX..|
+00000250  83 28 a9 58 1a a9 38 a4  95 a1 ac 31 5a 1a 84 66  |.(.X..8....1Z..f|
+00000260  3d 43 d3 2d d9 0b f2 97  df d3 20 64 38 92 24 3a  |=C.-...... d8.$:|
+00000270  00 bc cf 9c 7d b7 40 20  01 5f aa d3 16 61 09 a2  |....}.@ ._...a..|
+00000280  76 fd 13 c3 cc e1 0c 5c  ee b1 87 82 f1 6c 04 ed  |v......\.....l..|
+00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
+000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
+000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 c7 4c 84  |............ .L.|
+000002d0  aa 9d be 0a bb 72 d2 bc  76 73 59 9b 07 e1 6f 94  |.....r..vsY...o.|
+000002e0  25 e7 13 7a 4c a5 8d f9  ab 9d 30 d0 4c 08 04 00  |%..zL.....0.L...|
+000002f0  80 88 4d ea e2 83 d7 b6  50 fb 22 e0 a9 32 87 8e  |..M.....P."..2..|
+00000300  cf e3 3d 94 bc 07 99 c3  b7 53 9d f6 0c 80 77 f7  |..=......S....w.|
+00000310  96 50 39 eb 85 33 9e 17  72 14 f7 3f e6 c2 9b 94  |.P9..3..r..?....|
+00000320  bb bc 26 b9 c6 68 1f 2a  19 d6 40 f5 8b 85 a4 8d  |..&..h.*..@.....|
+00000330  c8 29 96 bf d1 e1 15 f7  f8 75 66 42 00 45 d3 ff  |.).......ufB.E..|
+00000340  4d ef f7 ad 7b b5 00 3e  9f 08 b8 ce 87 df d9 fa  |M...{..>........|
+00000350  79 b9 d1 a4 a3 a7 ad 0b  2b fc 65 c2 51 dc 8c 29  |y.......+.e.Q..)|
+00000360  85 31 92 f9 b3 dd 1a a1  f1 f0 9c 21 9d a0 6e 49  |.1.........!..nI|
+00000370  ff 16 03 03 00 04 0e 00  00 00                    |..........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 0b 58 fe  b5 63 ac 28 f8 34 d6 72  |.... .X..c.(.4.r|
-00000040  1a a3 ec 26 91 70 07 8d  6a 3a 3b 3a 94 5e a3 fa  |...&.p..j:;:.^..|
-00000050  6e 92 3a 15 65                                    |n.:.e|
+00000030  16 03 03 00 20 61 fc dc  e1 f7 bf 7b 90 e4 af 71  |.... a.....{...q|
+00000040  03 22 10 79 6d d9 e9 aa  1d 60 8e 40 d1 1e 3a 94  |.".ym....`.@..:.|
+00000050  ca 78 86 ad e6                                    |.x...|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 01 fa e1 2f 29  |.......... .../)|
-00000010  ee f6 d4 e8 22 b6 e0 8f  82 37 81 83 1b 03 4d 5f  |...."....7....M_|
-00000020  00 80 cb eb 9a 3a 01 c7  aa e9 9a                 |.....:.....|
+00000000  14 03 03 00 01 01 16 03  03 00 20 39 ee c6 1c d9  |.......... 9....|
+00000010  83 3e d3 bf 8a c3 3d bb  0a 27 7a 95 84 ef 82 e1  |.>....=..'z.....|
+00000020  80 6b 25 bf 68 dc 58 63  21 80 7d                 |.k%.h.Xc!.}|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 43 6a e8  f2 ca f9 4f 3c 6d ff 5e  |.....Cj....O<m.^|
-00000010  f3 19 eb ee 96 1c d8 68  c5 53 86 15 03 03 00 12  |.......h.S......|
-00000020  c2 72 4e 3c 33 93 fa f3  21 32 bb fd e3 c4 ef 1a  |.rN<3...!2......|
-00000030  46 df                                             |F.|
+00000000  17 03 03 00 16 e6 75 bb  fe 46 1a 4c 75 41 36 eb  |......u..F.LuA6.|
+00000010  a9 31 d9 59 74 9d 75 76  db 00 94 15 03 03 00 12  |.1.Yt.uv........|
+00000020  f0 a9 56 8e bd a5 bb c8  2d ea be d7 7f 9e 39 7a  |..V.....-.....9z|
+00000030  4f de                                             |O.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-Ed25519 b/src/crypto/tls/testdata/Client-TLSv12-Ed25519
index 72d564f44a..b2380ed6ef 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-Ed25519
+++ b/src/crypto/tls/testdata/Client-TLSv12-Ed25519
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,62 +7,63 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 6c 5f 04 9e a6  |....Y...U..l_...|
-00000010  c6 41 0c ee a2 2c af 45  f0 bc de 67 2d 20 1c 9c  |.A...,.E...g- ..|
-00000020  82 33 fd 86 86 b3 50 04  77 ec da 20 f3 09 fb 8c  |.3....P.w.. ....|
-00000030  79 83 f9 82 58 b9 76 bb  d3 58 44 3d 52 0c 37 ae  |y...X.v..XD=R.7.|
-00000040  18 98 84 9a 56 af 5d 2b  68 68 c7 30 cc a9 00 00  |....V.]+hh.0....|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  03 01 3c 0b 00 01 38 00  01 35 00 01 32 30 82 01  |..<...8..5..20..|
-00000070  2e 30 81 e1 a0 03 02 01  02 02 10 0f 43 1c 42 57  |.0..........C.BW|
-00000080  93 94 1d e9 87 e4 f1 ad  15 00 5d 30 05 06 03 2b  |..........]0...+|
-00000090  65 70 30 12 31 10 30 0e  06 03 55 04 0a 13 07 41  |ep0.1.0...U....A|
-000000a0  63 6d 65 20 43 6f 30 1e  17 0d 31 39 30 35 31 36  |cme Co0...190516|
-000000b0  32 31 33 38 30 31 5a 17  0d 32 30 30 35 31 35 32  |213801Z..2005152|
-000000c0  31 33 38 30 31 5a 30 12  31 10 30 0e 06 03 55 04  |13801Z0.1.0...U.|
-000000d0  0a 13 07 41 63 6d 65 20  43 6f 30 2a 30 05 06 03  |...Acme Co0*0...|
-000000e0  2b 65 70 03 21 00 3f e2  15 2e e6 e3 ef 3f 4e 85  |+ep.!.?......?N.|
-000000f0  4a 75 77 a3 64 9e ed e0  bf 84 2c cc 92 26 8f fa  |Juw.d.....,..&..|
-00000100  6f 34 83 aa ec 8f a3 4d  30 4b 30 0e 06 03 55 1d  |o4.....M0K0...U.|
-00000110  0f 01 01 ff 04 04 03 02  05 a0 30 13 06 03 55 1d  |..........0...U.|
-00000120  25 04 0c 30 0a 06 08 2b  06 01 05 05 07 03 01 30  |%..0...+.......0|
-00000130  0c 06 03 55 1d 13 01 01  ff 04 02 30 00 30 16 06  |...U.......0.0..|
-00000140  03 55 1d 11 04 0f 30 0d  82 0b 65 78 61 6d 70 6c  |.U....0...exampl|
-00000150  65 2e 63 6f 6d 30 05 06  03 2b 65 70 03 41 00 63  |e.com0...+ep.A.c|
-00000160  44 ed 9c c4 be 53 24 53  9f d2 10 8d 9f e8 21 08  |D....S$S......!.|
-00000170  90 95 39 e5 0d c1 55 ff  2c 16 b7 1d fc ab 7d 4d  |..9...U.,.....}M|
-00000180  d4 e0 93 13 d0 a9 42 e0  b6 6b fe 5d 67 48 d7 9f  |......B..k.]gH..|
-00000190  50 bc 6c cd 4b 03 83 7c  f2 08 58 cd ac cf 0c 16  |P.l.K..|..X.....|
-000001a0  03 03 00 6c 0c 00 00 68  03 00 1d 20 a7 28 ef 3e  |...l...h... .(.>|
-000001b0  1c 65 9f 8e 9a 80 0b 7d  ac 9c ce d6 1e 97 54 30  |.e.....}......T0|
-000001c0  53 9b e6 0c 61 e0 ea 9c  ae 70 f2 78 08 07 00 40  |S...a....p.x...@|
-000001d0  0c 49 38 23 a0 75 28 fb  ec 71 a4 89 79 45 d1 ca  |.I8#.u(..q..yE..|
-000001e0  83 6f 5d dd 01 d4 c6 63  53 5d 6e 8f 06 09 80 a1  |.o]....cS]n.....|
-000001f0  f7 ef af 2d 29 af aa 10  86 1c 18 19 3f be bb 90  |...-).......?...|
-00000200  0e c3 9d 1e 6e 60 49 7f  fc c8 42 61 89 c2 e3 04  |....n`I...Ba....|
-00000210  16 03 03 00 04 0e 00 00  00                       |.........|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 17 80 d3 0b 73  |....]...Y......s|
+00000010  6d e4 3e 2d 7a 35 ab ab  65 ad a0 03 14 cb e8 98  |m.>-z5..e.......|
+00000020  3a d3 c6 41 39 b2 78 c2  1b 06 da 20 ec 80 a9 c4  |:..A9.x.... ....|
+00000030  7c b8 9b cc b3 98 7a cd  97 40 41 39 b7 75 13 7a  ||.....z..@A9.u.z|
+00000040  40 33 ec 9d 69 97 32 5b  f5 6e 4f bc cc a9 00 00  |@3..i.2[.nO.....|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 03 01 3c 0b  00 01 38 00 01 35 00 01  |......<...8..5..|
+00000070  32 30 82 01 2e 30 81 e1  a0 03 02 01 02 02 10 0f  |20...0..........|
+00000080  43 1c 42 57 93 94 1d e9  87 e4 f1 ad 15 00 5d 30  |C.BW..........]0|
+00000090  05 06 03 2b 65 70 30 12  31 10 30 0e 06 03 55 04  |...+ep0.1.0...U.|
+000000a0  0a 13 07 41 63 6d 65 20  43 6f 30 1e 17 0d 31 39  |...Acme Co0...19|
+000000b0  30 35 31 36 32 31 33 38  30 31 5a 17 0d 32 30 30  |0516213801Z..200|
+000000c0  35 31 35 32 31 33 38 30  31 5a 30 12 31 10 30 0e  |515213801Z0.1.0.|
+000000d0  06 03 55 04 0a 13 07 41  63 6d 65 20 43 6f 30 2a  |..U....Acme Co0*|
+000000e0  30 05 06 03 2b 65 70 03  21 00 3f e2 15 2e e6 e3  |0...+ep.!.?.....|
+000000f0  ef 3f 4e 85 4a 75 77 a3  64 9e ed e0 bf 84 2c cc  |.?N.Juw.d.....,.|
+00000100  92 26 8f fa 6f 34 83 aa  ec 8f a3 4d 30 4b 30 0e  |.&..o4.....M0K0.|
+00000110  06 03 55 1d 0f 01 01 ff  04 04 03 02 05 a0 30 13  |..U...........0.|
+00000120  06 03 55 1d 25 04 0c 30  0a 06 08 2b 06 01 05 05  |..U.%..0...+....|
+00000130  07 03 01 30 0c 06 03 55  1d 13 01 01 ff 04 02 30  |...0...U.......0|
+00000140  00 30 16 06 03 55 1d 11  04 0f 30 0d 82 0b 65 78  |.0...U....0...ex|
+00000150  61 6d 70 6c 65 2e 63 6f  6d 30 05 06 03 2b 65 70  |ample.com0...+ep|
+00000160  03 41 00 63 44 ed 9c c4  be 53 24 53 9f d2 10 8d  |.A.cD....S$S....|
+00000170  9f e8 21 08 90 95 39 e5  0d c1 55 ff 2c 16 b7 1d  |..!...9...U.,...|
+00000180  fc ab 7d 4d d4 e0 93 13  d0 a9 42 e0 b6 6b fe 5d  |..}M......B..k.]|
+00000190  67 48 d7 9f 50 bc 6c cd  4b 03 83 7c f2 08 58 cd  |gH..P.l.K..|..X.|
+000001a0  ac cf 0c 16 03 03 00 6c  0c 00 00 68 03 00 1d 20  |.......l...h... |
+000001b0  6b 23 39 84 eb 4d db d0  0c f4 5a 9f ce bf 3a a8  |k#9..M....Z...:.|
+000001c0  52 df 00 9b 14 10 31 95  21 35 07 f1 7f 22 bf 14  |R.....1.!5..."..|
+000001d0  08 07 00 40 f6 b8 53 ed  97 7f 5a 28 88 84 f4 aa  |...@..S...Z(....|
+000001e0  64 30 dc 4c 80 1f 8f 62  9d 52 aa bb e7 98 e1 7f  |d0.L...b.R......|
+000001f0  12 19 b5 84 d2 4b 92 b1  38 a9 4e c2 09 1a 91 bf  |.....K..8.N.....|
+00000200  4a 83 5e a4 82 a0 36 84  85 0d bd b5 a9 4f 2f 60  |J.^...6......O/`|
+00000210  a4 2f 33 0d 16 03 03 00  04 0e 00 00 00           |./3..........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 b2 7f b6  1b 9c ec bf 2e ae a5 70  |.... ..........p|
-00000040  d5 33 9b 63 02 66 77 7d  00 ec 86 e4 bb d4 57 68  |.3.c.fw}......Wh|
-00000050  49 2a d3 be e7                                    |I*...|
+00000030  16 03 03 00 20 a2 a9 10  50 bb d9 12 ee 74 a1 79  |.... ...P....t.y|
+00000040  cb fa 36 73 26 89 4e a4  2d 14 c0 ac f3 7b 82 c6  |..6s&.N.-....{..|
+00000050  cf fb 00 88 9e                                    |.....|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 4c 7d ef ed ea  |.......... L}...|
-00000010  ab 8d 4f 38 46 6e 8f 56  b4 1d f2 1f 2c df 57 c0  |..O8Fn.V....,.W.|
-00000020  f9 8a c2 71 f8 6d df b7  c7 1e 23                 |...q.m....#|
+00000000  14 03 03 00 01 01 16 03  03 00 20 22 85 b9 b0 e7  |.......... "....|
+00000010  14 c0 a6 a9 91 4e 08 80  83 75 92 b5 45 9d 13 e9  |.....N...u..E...|
+00000020  0f 45 e7 55 ac b7 68 93  b4 bb 00                 |.E.U..h....|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 26 f1 7c  ee c8 3a 61 b0 f7 5a bd  |.....&.|..:a..Z.|
-00000010  b7 61 61 60 69 db cd ea  10 ee 63 15 03 03 00 12  |.aa`i.....c.....|
-00000020  22 c0 65 a4 5d 0e 48 9c  56 f8 54 17 82 5f 29 97  |".e.].H.V.T.._).|
-00000030  be 6b                                             |.k|
+00000000  17 03 03 00 16 0a c8 36  60 97 80 1c d5 d5 3c 3d  |.......6`.....<=|
+00000010  07 4f 9b 2c 75 6c a0 b1  9a 2c b8 15 03 03 00 12  |.O.,ul...,......|
+00000020  fc a4 95 ae ee fe e2 4f  ad b2 13 e0 c9 a7 2a 5a  |.......O......*Z|
+00000030  54 2c                                             |T,|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-ExportKeyingMaterial b/src/crypto/tls/testdata/Client-TLSv12-ExportKeyingMaterial
index adf1f72daf..cbd1fbd038 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-ExportKeyingMaterial
+++ b/src/crypto/tls/testdata/Client-TLSv12-ExportKeyingMaterial
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,84 +7,85 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 79 92 2e 86 bc  |....Y...U..y....|
-00000010  c0 b7 56 2a 25 58 75 b3  25 ac 58 1d 8d 8e d5 87  |..V*%Xu.%.X.....|
-00000020  2d 67 8e 6e d4 d4 b6 67  b1 42 96 20 91 75 0b fa  |-g.n...g.B. .u..|
-00000030  d0 6f ab 91 4a c3 15 07  1d 6c 8e e5 55 f2 26 aa  |.o..J....l..U.&.|
-00000040  4d 5c 57 3b 93 a6 fc 46  c9 f6 80 1e cc a8 00 00  |M\W;...F........|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
-00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
-00000080  3f e2 5b ea a6 30 0d 06  09 2a 86 48 86 f7 0d 01  |?.[..0...*.H....|
-00000090  01 0b 05 00 30 1f 31 0b  30 09 06 03 55 04 0a 13  |....0.1.0...U...|
-000000a0  02 47 6f 31 10 30 0e 06  03 55 04 03 13 07 47 6f  |.Go1.0...U....Go|
-000000b0  20 52 6f 6f 74 30 1e 17  0d 31 36 30 31 30 31 30  | Root0...1601010|
-000000c0  30 30 30 30 30 5a 17 0d  32 35 30 31 30 31 30 30  |00000Z..25010100|
-000000d0  30 30 30 30 5a 30 1a 31  0b 30 09 06 03 55 04 0a  |0000Z0.1.0...U..|
-000000e0  13 02 47 6f 31 0b 30 09  06 03 55 04 03 13 02 47  |..Go1.0...U....G|
-000000f0  6f 30 81 9f 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |o0..0...*.H.....|
-00000100  01 05 00 03 81 8d 00 30  81 89 02 81 81 00 db 46  |.......0.......F|
-00000110  7d 93 2e 12 27 06 48 bc  06 28 21 ab 7e c4 b6 a2  |}...'.H..(!.~...|
-00000120  5d fe 1e 52 45 88 7a 36  47 a5 08 0d 92 42 5b c2  |]..RE.z6G....B[.|
-00000130  81 c0 be 97 79 98 40 fb  4f 6d 14 fd 2b 13 8b c2  |....y.@.Om..+...|
-00000140  a5 2e 67 d8 d4 09 9e d6  22 38 b7 4a 0b 74 73 2b  |..g....."8.J.ts+|
-00000150  c2 34 f1 d1 93 e5 96 d9  74 7b f3 58 9f 6c 61 3c  |.4......t{.X.la<|
-00000160  c0 b0 41 d4 d9 2b 2b 24  23 77 5b 1c 3b bd 75 5d  |..A..++$#w[.;.u]|
-00000170  ce 20 54 cf a1 63 87 1d  1e 24 c4 f3 1d 1a 50 8b  |. T..c...$....P.|
-00000180  aa b6 14 43 ed 97 a7 75  62 f4 14 c8 52 d7 02 03  |...C...ub...R...|
-00000190  01 00 01 a3 81 93 30 81  90 30 0e 06 03 55 1d 0f  |......0..0...U..|
-000001a0  01 01 ff 04 04 03 02 05  a0 30 1d 06 03 55 1d 25  |.........0...U.%|
-000001b0  04 16 30 14 06 08 2b 06  01 05 05 07 03 01 06 08  |..0...+.........|
-000001c0  2b 06 01 05 05 07 03 02  30 0c 06 03 55 1d 13 01  |+.......0...U...|
-000001d0  01 ff 04 02 30 00 30 19  06 03 55 1d 0e 04 12 04  |....0.0...U.....|
-000001e0  10 9f 91 16 1f 43 43 3e  49 a6 de 6d b6 80 d7 9f  |.....CC>I..m....|
-000001f0  60 30 1b 06 03 55 1d 23  04 14 30 12 80 10 48 13  |`0...U.#..0...H.|
-00000200  49 4d 13 7e 16 31 bb a3  01 d5 ac ab 6e 7b 30 19  |IM.~.1......n{0.|
-00000210  06 03 55 1d 11 04 12 30  10 82 0e 65 78 61 6d 70  |..U....0...examp|
-00000220  6c 65 2e 67 6f 6c 61 6e  67 30 0d 06 09 2a 86 48  |le.golang0...*.H|
-00000230  86 f7 0d 01 01 0b 05 00  03 81 81 00 9d 30 cc 40  |.............0.@|
-00000240  2b 5b 50 a0 61 cb ba e5  53 58 e1 ed 83 28 a9 58  |+[P.a...SX...(.X|
-00000250  1a a9 38 a4 95 a1 ac 31  5a 1a 84 66 3d 43 d3 2d  |..8....1Z..f=C.-|
-00000260  d9 0b f2 97 df d3 20 64  38 92 24 3a 00 bc cf 9c  |...... d8.$:....|
-00000270  7d b7 40 20 01 5f aa d3  16 61 09 a2 76 fd 13 c3  |}.@ ._...a..v...|
-00000280  cc e1 0c 5c ee b1 87 82  f1 6c 04 ed 73 bb b3 43  |...\.....l..s..C|
-00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
-000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
-000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 5f 3c a6 bb 4e 32 85  |........ _<..N2.|
-000002d0  69 4b 23 df 18 9c 07 ac  0b a8 dd 9b 59 33 00 02  |iK#.........Y3..|
-000002e0  99 de 4e 66 1e 04 3b ce  4b 08 04 00 80 82 41 7c  |..Nf..;.K.....A||
-000002f0  7b b8 ee d4 23 08 c3 23  8d b1 ea 27 43 e7 8e f1  |{...#..#...'C...|
-00000300  7b 87 b0 88 ab f7 b1 15  2e 45 c5 50 e7 cd 05 31  |{........E.P...1|
-00000310  bf 99 30 c8 ff 6a 23 ec  9d e5 c8 09 fa ec 50 a8  |..0..j#.......P.|
-00000320  fa b3 54 b7 c5 61 99 f6  94 12 e6 34 4a 59 e3 dd  |..T..a.....4JY..|
-00000330  e5 7f f4 88 c9 2a 4c 09  65 d9 75 a6 ce 12 96 82  |.....*L.e.u.....|
-00000340  a2 36 f2 5e 93 f2 4e 1c  05 91 a7 5a 67 36 e9 3d  |.6.^..N....Zg6.=|
-00000350  33 cd 6a 77 9c 8d 14 95  80 41 61 bd 80 ed 7b 51  |3.jw.....Aa...{Q|
-00000360  cf 76 87 4d ac dc 5f c1  5d 52 a7 f9 51 16 03 03  |.v.M.._.]R..Q...|
-00000370  00 04 0e 00 00 00                                 |......|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 86 45 94 b6 f3  |....]...Y...E...|
+00000010  30 74 36 25 50 09 38 f6  3e 4a 5a b6 bf 06 fd 01  |0t6%P.8.>JZ.....|
+00000020  4b 35 b0 bc ef 77 bf f6  e9 a2 84 20 97 96 9b ba  |K5...w..... ....|
+00000030  24 5f 28 cd 16 3f d3 f4  2b 92 da 09 a5 18 2f 21  |$_(..?..+...../!|
+00000040  d8 23 85 9a c9 4a 69 36  93 ab c2 5a cc a8 00 00  |.#...Ji6...Z....|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
+00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
+00000080  00 e8 f0 9d 3f e2 5b ea  a6 30 0d 06 09 2a 86 48  |....?.[..0...*.H|
+00000090  86 f7 0d 01 01 0b 05 00  30 1f 31 0b 30 09 06 03  |........0.1.0...|
+000000a0  55 04 0a 13 02 47 6f 31  10 30 0e 06 03 55 04 03  |U....Go1.0...U..|
+000000b0  13 07 47 6f 20 52 6f 6f  74 30 1e 17 0d 31 36 30  |..Go Root0...160|
+000000c0  31 30 31 30 30 30 30 30  30 5a 17 0d 32 35 30 31  |101000000Z..2501|
+000000d0  30 31 30 30 30 30 30 30  5a 30 1a 31 0b 30 09 06  |01000000Z0.1.0..|
+000000e0  03 55 04 0a 13 02 47 6f  31 0b 30 09 06 03 55 04  |.U....Go1.0...U.|
+000000f0  03 13 02 47 6f 30 81 9f  30 0d 06 09 2a 86 48 86  |...Go0..0...*.H.|
+00000100  f7 0d 01 01 01 05 00 03  81 8d 00 30 81 89 02 81  |...........0....|
+00000110  81 00 db 46 7d 93 2e 12  27 06 48 bc 06 28 21 ab  |...F}...'.H..(!.|
+00000120  7e c4 b6 a2 5d fe 1e 52  45 88 7a 36 47 a5 08 0d  |~...]..RE.z6G...|
+00000130  92 42 5b c2 81 c0 be 97  79 98 40 fb 4f 6d 14 fd  |.B[.....y.@.Om..|
+00000140  2b 13 8b c2 a5 2e 67 d8  d4 09 9e d6 22 38 b7 4a  |+.....g....."8.J|
+00000150  0b 74 73 2b c2 34 f1 d1  93 e5 96 d9 74 7b f3 58  |.ts+.4......t{.X|
+00000160  9f 6c 61 3c c0 b0 41 d4  d9 2b 2b 24 23 77 5b 1c  |.la<..A..++$#w[.|
+00000170  3b bd 75 5d ce 20 54 cf  a1 63 87 1d 1e 24 c4 f3  |;.u]. T..c...$..|
+00000180  1d 1a 50 8b aa b6 14 43  ed 97 a7 75 62 f4 14 c8  |..P....C...ub...|
+00000190  52 d7 02 03 01 00 01 a3  81 93 30 81 90 30 0e 06  |R.........0..0..|
+000001a0  03 55 1d 0f 01 01 ff 04  04 03 02 05 a0 30 1d 06  |.U...........0..|
+000001b0  03 55 1d 25 04 16 30 14  06 08 2b 06 01 05 05 07  |.U.%..0...+.....|
+000001c0  03 01 06 08 2b 06 01 05  05 07 03 02 30 0c 06 03  |....+.......0...|
+000001d0  55 1d 13 01 01 ff 04 02  30 00 30 19 06 03 55 1d  |U.......0.0...U.|
+000001e0  0e 04 12 04 10 9f 91 16  1f 43 43 3e 49 a6 de 6d  |.........CC>I..m|
+000001f0  b6 80 d7 9f 60 30 1b 06  03 55 1d 23 04 14 30 12  |....`0...U.#..0.|
+00000200  80 10 48 13 49 4d 13 7e  16 31 bb a3 01 d5 ac ab  |..H.IM.~.1......|
+00000210  6e 7b 30 19 06 03 55 1d  11 04 12 30 10 82 0e 65  |n{0...U....0...e|
+00000220  78 61 6d 70 6c 65 2e 67  6f 6c 61 6e 67 30 0d 06  |xample.golang0..|
+00000230  09 2a 86 48 86 f7 0d 01  01 0b 05 00 03 81 81 00  |.*.H............|
+00000240  9d 30 cc 40 2b 5b 50 a0  61 cb ba e5 53 58 e1 ed  |.0.@+[P.a...SX..|
+00000250  83 28 a9 58 1a a9 38 a4  95 a1 ac 31 5a 1a 84 66  |.(.X..8....1Z..f|
+00000260  3d 43 d3 2d d9 0b f2 97  df d3 20 64 38 92 24 3a  |=C.-...... d8.$:|
+00000270  00 bc cf 9c 7d b7 40 20  01 5f aa d3 16 61 09 a2  |....}.@ ._...a..|
+00000280  76 fd 13 c3 cc e1 0c 5c  ee b1 87 82 f1 6c 04 ed  |v......\.....l..|
+00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
+000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
+000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 34 09 94  |............ 4..|
+000002d0  56 6a c3 3b 88 60 42 3d  1d f2 99 a1 8e 56 72 e3  |Vj.;.`B=.....Vr.|
+000002e0  09 83 17 04 60 08 ad db  70 c6 f6 77 2a 08 04 00  |....`...p..w*...|
+000002f0  80 80 1c d5 53 c0 5b 1f  86 e9 d7 16 18 0d 50 3c  |....S.[.......P<|
+00000300  b6 40 1f 58 ea 79 e6 af  cf a1 cf 55 3f e1 fe 04  |.@.X.y.....U?...|
+00000310  bc e5 1c 4a ae 36 e9 7b  64 a1 76 ea 43 bc 8f a7  |...J.6.{d.v.C...|
+00000320  0a 8a 8b d1 af 54 57 21  9b 55 10 90 91 07 f7 96  |.....TW!.U......|
+00000330  68 68 33 ec 4b c4 70 08  88 92 59 2d 4d 86 47 d9  |hh3.K.p...Y-M.G.|
+00000340  8a a7 d2 22 b4 ab 83 0e  3b 29 79 fd 1b f7 5b c8  |..."....;)y...[.|
+00000350  b2 d5 3a be 74 e7 b5 c8  6e 4e c4 8d c5 70 6c 98  |..:.t...nN...pl.|
+00000360  fe 57 f9 2e c0 8c d3 38  39 e9 0e c1 17 c9 8d 36  |.W.....89......6|
+00000370  47 16 03 03 00 04 0e 00  00 00                    |G.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 bc c3 7c  c2 cc a4 4e 8f d0 79 7a  |.... ..|...N..yz|
-00000040  a4 7d 4c 3d 17 8c 19 93  4f 49 03 50 f6 71 4d 16  |.}L=....OI.P.qM.|
-00000050  97 bb 18 88 67                                    |....g|
+00000030  16 03 03 00 20 35 b3 34  ef 69 93 b1 31 f1 da 9c  |.... 5.4.i..1...|
+00000040  3f 49 e5 99 8f af 4f 3b  48 52 b9 a3 fa 42 e7 3e  |?I....O;HR...B.>|
+00000050  29 4c 22 b7 0a                                    |)L"..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 00 c4 8a f9 1e  |.......... .....|
-00000010  c0 66 ab ef 39 ae 41 7a  05 9c e3 06 e4 4d 00 bb  |.f..9.Az.....M..|
-00000020  d4 ef 21 71 a3 54 23 fe  db 4a 86                 |..!q.T#..J.|
+00000000  14 03 03 00 01 01 16 03  03 00 20 cd 8f ee d3 57  |.......... ....W|
+00000010  a5 e4 c0 4c 83 91 37 e2  5b 30 aa a1 52 ed 6c 42  |...L..7.[0..R.lB|
+00000020  5b d6 59 1c 9f f7 c6 69  c9 2a 5d                 |[.Y....i.*]|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 0c d3 9a  f5 1d f4 5f b2 45 c7 7c  |..........._.E.||
-00000010  38 59 6e df 6e 59 d5 94  8b a9 bb 15 03 03 00 12  |8Yn.nY..........|
-00000020  9e 74 a5 0e c1 7f 33 52  be 17 f6 f5 4d 9f 3d d1  |.t....3R....M.=.|
-00000030  b5 65                                             |.e|
+00000000  17 03 03 00 16 c9 3b 66  6a 59 3a b6 be 39 a0 db  |......;fjY:..9..|
+00000010  e9 b4 d8 e1 f5 a6 15 70  4a fc e7 15 03 03 00 12  |.......pJ.......|
+00000020  1b c5 fe f3 89 a3 0d d6  1e 23 2d 54 d6 01 62 3c  |.........#-T..b<|
+00000030  af 0c                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-P256-ECDHE b/src/crypto/tls/testdata/Client-TLSv12-P256-ECDHE
index 3331435315..9b6c750086 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-P256-ECDHE
+++ b/src/crypto/tls/testdata/Client-TLSv12-P256-ECDHE
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 15 01 00 01  11 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 19 01 00 01  15 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,92 +7,92 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 96 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
+00000080  01 00 00 9a 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  04 00 02 00 17 00 0b 00  02 01 00 00 0d 00 1a 00  |................|
 000000a0  18 08 04 04 03 08 07 08  05 08 06 04 01 05 01 06  |................|
-000000b0  01 05 03 06 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-000000c0  00 00 00 2b 00 09 08 03  04 03 03 03 02 03 01 00  |...+............|
-000000d0  33 00 47 00 45 00 17 00  41 04 1e 18 37 ef 0d 19  |3.G.E...A...7...|
-000000e0  51 88 35 75 71 b5 e5 54  5b 12 2e 8f 09 67 fd a7  |Q.5uq..T[....g..|
-000000f0  24 20 3e b2 56 1c ce 97  28 5e f8 2b 2d 4f 9e f1  |$ >.V...(^.+-O..|
-00000100  07 9f 6c 4b 5b 83 56 e2  32 42 e9 58 b6 d7 49 a6  |..lK[.V.2B.X..I.|
-00000110  b5 68 1a 41 03 56 6b dc  5a 89                    |.h.A.Vk.Z.|
+000000b0  01 05 03 06 03 02 01 02  03 ff 01 00 01 00 00 17  |................|
+000000c0  00 00 00 12 00 00 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000d0  02 03 01 00 33 00 47 00  45 00 17 00 41 04 1e 18  |....3.G.E...A...|
+000000e0  37 ef 0d 19 51 88 35 75  71 b5 e5 54 5b 12 2e 8f  |7...Q.5uq..T[...|
+000000f0  09 67 fd a7 24 20 3e b2  56 1c ce 97 28 5e f8 2b  |.g..$ >.V...(^.+|
+00000100  2d 4f 9e f1 07 9f 6c 4b  5b 83 56 e2 32 42 e9 58  |-O....lK[.V.2B.X|
+00000110  b6 d7 49 a6 b5 68 1a 41  03 56 6b dc 5a 89        |..I..h.A.Vk.Z.|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 0b f0 3e a1 66  |....Y...U....>.f|
-00000010  13 35 53 83 59 3c 9e 2a  0f 0b b0 9a 42 de e4 f1  |.5S.Y<.*....B...|
-00000020  8a 2d 34 ef 15 fe 28 55  42 d8 bf 20 aa 27 5c 5f  |.-4...(UB.. .'\_|
-00000030  24 59 17 ef 43 f3 18 f8  40 97 8f 1a 6a f4 e4 4a  |$Y..C...@...j..J|
-00000040  a3 b7 11 39 01 bd 98 8c  61 08 d9 50 c0 2f 00 00  |...9....a..P./..|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
-00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
-00000080  3f e2 5b ea a6 30 0d 06  09 2a 86 48 86 f7 0d 01  |?.[..0...*.H....|
-00000090  01 0b 05 00 30 1f 31 0b  30 09 06 03 55 04 0a 13  |....0.1.0...U...|
-000000a0  02 47 6f 31 10 30 0e 06  03 55 04 03 13 07 47 6f  |.Go1.0...U....Go|
-000000b0  20 52 6f 6f 74 30 1e 17  0d 31 36 30 31 30 31 30  | Root0...1601010|
-000000c0  30 30 30 30 30 5a 17 0d  32 35 30 31 30 31 30 30  |00000Z..25010100|
-000000d0  30 30 30 30 5a 30 1a 31  0b 30 09 06 03 55 04 0a  |0000Z0.1.0...U..|
-000000e0  13 02 47 6f 31 0b 30 09  06 03 55 04 03 13 02 47  |..Go1.0...U....G|
-000000f0  6f 30 81 9f 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |o0..0...*.H.....|
-00000100  01 05 00 03 81 8d 00 30  81 89 02 81 81 00 db 46  |.......0.......F|
-00000110  7d 93 2e 12 27 06 48 bc  06 28 21 ab 7e c4 b6 a2  |}...'.H..(!.~...|
-00000120  5d fe 1e 52 45 88 7a 36  47 a5 08 0d 92 42 5b c2  |]..RE.z6G....B[.|
-00000130  81 c0 be 97 79 98 40 fb  4f 6d 14 fd 2b 13 8b c2  |....y.@.Om..+...|
-00000140  a5 2e 67 d8 d4 09 9e d6  22 38 b7 4a 0b 74 73 2b  |..g....."8.J.ts+|
-00000150  c2 34 f1 d1 93 e5 96 d9  74 7b f3 58 9f 6c 61 3c  |.4......t{.X.la<|
-00000160  c0 b0 41 d4 d9 2b 2b 24  23 77 5b 1c 3b bd 75 5d  |..A..++$#w[.;.u]|
-00000170  ce 20 54 cf a1 63 87 1d  1e 24 c4 f3 1d 1a 50 8b  |. T..c...$....P.|
-00000180  aa b6 14 43 ed 97 a7 75  62 f4 14 c8 52 d7 02 03  |...C...ub...R...|
-00000190  01 00 01 a3 81 93 30 81  90 30 0e 06 03 55 1d 0f  |......0..0...U..|
-000001a0  01 01 ff 04 04 03 02 05  a0 30 1d 06 03 55 1d 25  |.........0...U.%|
-000001b0  04 16 30 14 06 08 2b 06  01 05 05 07 03 01 06 08  |..0...+.........|
-000001c0  2b 06 01 05 05 07 03 02  30 0c 06 03 55 1d 13 01  |+.......0...U...|
-000001d0  01 ff 04 02 30 00 30 19  06 03 55 1d 0e 04 12 04  |....0.0...U.....|
-000001e0  10 9f 91 16 1f 43 43 3e  49 a6 de 6d b6 80 d7 9f  |.....CC>I..m....|
-000001f0  60 30 1b 06 03 55 1d 23  04 14 30 12 80 10 48 13  |`0...U.#..0...H.|
-00000200  49 4d 13 7e 16 31 bb a3  01 d5 ac ab 6e 7b 30 19  |IM.~.1......n{0.|
-00000210  06 03 55 1d 11 04 12 30  10 82 0e 65 78 61 6d 70  |..U....0...examp|
-00000220  6c 65 2e 67 6f 6c 61 6e  67 30 0d 06 09 2a 86 48  |le.golang0...*.H|
-00000230  86 f7 0d 01 01 0b 05 00  03 81 81 00 9d 30 cc 40  |.............0.@|
-00000240  2b 5b 50 a0 61 cb ba e5  53 58 e1 ed 83 28 a9 58  |+[P.a...SX...(.X|
-00000250  1a a9 38 a4 95 a1 ac 31  5a 1a 84 66 3d 43 d3 2d  |..8....1Z..f=C.-|
-00000260  d9 0b f2 97 df d3 20 64  38 92 24 3a 00 bc cf 9c  |...... d8.$:....|
-00000270  7d b7 40 20 01 5f aa d3  16 61 09 a2 76 fd 13 c3  |}.@ ._...a..v...|
-00000280  cc e1 0c 5c ee b1 87 82  f1 6c 04 ed 73 bb b3 43  |...\.....l..s..C|
-00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
-000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
-000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  cd 0c 00 00 c9 03 00 17  41 04 79 6a df 70 26 49  |........A.yj.p&I|
-000002d0  c0 5a 39 fc 7c 80 d1 2c  cd 76 d0 4c 6f a7 7d bc  |.Z9.|..,.v.Lo.}.|
-000002e0  32 c6 54 c6 76 58 e2 0f  3f 33 ad 92 61 33 11 16  |2.T.vX..?3..a3..|
-000002f0  d7 42 a8 ba 2a 8f 22 2a  eb 88 3e 74 78 2a 67 de  |.B..*."*..>tx*g.|
-00000300  39 75 63 2c 1d 2e da 33  77 a5 08 04 00 80 61 f5  |9uc,...3w.....a.|
-00000310  ed 56 5b f1 dd 78 a0 c4  8a 9b ac 28 c5 91 0c bd  |.V[..x.....(....|
-00000320  f1 d5 c1 f6 31 2e 8c c3  d5 84 3a 15 e8 6d f1 bc  |....1.....:..m..|
-00000330  9e a6 04 fd 95 2f 51 60  2f c6 ff 99 cf 38 24 bf  |...../Q`/....8$.|
-00000340  a4 32 a2 1f a1 6b bd 27  98 00 14 23 0d 12 66 67  |.2...k.'...#..fg|
-00000350  48 33 92 51 e7 e7 3c f5  ef 13 ca 46 3c 39 53 70  |H3.Q..<....F<9Sp|
-00000360  41 78 4a 02 70 87 48 ce  b0 31 02 33 0b 06 78 b9  |AxJ.p.H..1.3..x.|
-00000370  87 0b 07 e0 f7 15 c8 3e  27 a1 a3 20 24 9e 20 93  |.......>'.. $. .|
-00000380  7f b5 53 7b 18 88 96 87  2b df 02 ba 0c d8 16 03  |..S{....+.......|
-00000390  03 00 04 0e 00 00 00                              |.......|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 a4 cd 94 7e 17  |....]...Y.....~.|
+00000010  86 6e 81 dc 58 f5 86 34  fc 66 25 77 df 05 e5 85  |.n..X..4.f%w....|
+00000020  98 2e b4 38 e3 54 98 93  f5 ef 9e 20 db e9 53 1a  |...8.T..... ..S.|
+00000030  67 e3 18 c1 64 66 4f 92  7f d6 44 42 a0 b3 04 d9  |g...dfO...DB....|
+00000040  c3 5f f2 6a 89 e6 fd e9  6d bf 2c a6 c0 2f 00 00  |._.j....m.,../..|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
+00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
+00000080  00 e8 f0 9d 3f e2 5b ea  a6 30 0d 06 09 2a 86 48  |....?.[..0...*.H|
+00000090  86 f7 0d 01 01 0b 05 00  30 1f 31 0b 30 09 06 03  |........0.1.0...|
+000000a0  55 04 0a 13 02 47 6f 31  10 30 0e 06 03 55 04 03  |U....Go1.0...U..|
+000000b0  13 07 47 6f 20 52 6f 6f  74 30 1e 17 0d 31 36 30  |..Go Root0...160|
+000000c0  31 30 31 30 30 30 30 30  30 5a 17 0d 32 35 30 31  |101000000Z..2501|
+000000d0  30 31 30 30 30 30 30 30  5a 30 1a 31 0b 30 09 06  |01000000Z0.1.0..|
+000000e0  03 55 04 0a 13 02 47 6f  31 0b 30 09 06 03 55 04  |.U....Go1.0...U.|
+000000f0  03 13 02 47 6f 30 81 9f  30 0d 06 09 2a 86 48 86  |...Go0..0...*.H.|
+00000100  f7 0d 01 01 01 05 00 03  81 8d 00 30 81 89 02 81  |...........0....|
+00000110  81 00 db 46 7d 93 2e 12  27 06 48 bc 06 28 21 ab  |...F}...'.H..(!.|
+00000120  7e c4 b6 a2 5d fe 1e 52  45 88 7a 36 47 a5 08 0d  |~...]..RE.z6G...|
+00000130  92 42 5b c2 81 c0 be 97  79 98 40 fb 4f 6d 14 fd  |.B[.....y.@.Om..|
+00000140  2b 13 8b c2 a5 2e 67 d8  d4 09 9e d6 22 38 b7 4a  |+.....g....."8.J|
+00000150  0b 74 73 2b c2 34 f1 d1  93 e5 96 d9 74 7b f3 58  |.ts+.4......t{.X|
+00000160  9f 6c 61 3c c0 b0 41 d4  d9 2b 2b 24 23 77 5b 1c  |.la<..A..++$#w[.|
+00000170  3b bd 75 5d ce 20 54 cf  a1 63 87 1d 1e 24 c4 f3  |;.u]. T..c...$..|
+00000180  1d 1a 50 8b aa b6 14 43  ed 97 a7 75 62 f4 14 c8  |..P....C...ub...|
+00000190  52 d7 02 03 01 00 01 a3  81 93 30 81 90 30 0e 06  |R.........0..0..|
+000001a0  03 55 1d 0f 01 01 ff 04  04 03 02 05 a0 30 1d 06  |.U...........0..|
+000001b0  03 55 1d 25 04 16 30 14  06 08 2b 06 01 05 05 07  |.U.%..0...+.....|
+000001c0  03 01 06 08 2b 06 01 05  05 07 03 02 30 0c 06 03  |....+.......0...|
+000001d0  55 1d 13 01 01 ff 04 02  30 00 30 19 06 03 55 1d  |U.......0.0...U.|
+000001e0  0e 04 12 04 10 9f 91 16  1f 43 43 3e 49 a6 de 6d  |.........CC>I..m|
+000001f0  b6 80 d7 9f 60 30 1b 06  03 55 1d 23 04 14 30 12  |....`0...U.#..0.|
+00000200  80 10 48 13 49 4d 13 7e  16 31 bb a3 01 d5 ac ab  |..H.IM.~.1......|
+00000210  6e 7b 30 19 06 03 55 1d  11 04 12 30 10 82 0e 65  |n{0...U....0...e|
+00000220  78 61 6d 70 6c 65 2e 67  6f 6c 61 6e 67 30 0d 06  |xample.golang0..|
+00000230  09 2a 86 48 86 f7 0d 01  01 0b 05 00 03 81 81 00  |.*.H............|
+00000240  9d 30 cc 40 2b 5b 50 a0  61 cb ba e5 53 58 e1 ed  |.0.@+[P.a...SX..|
+00000250  83 28 a9 58 1a a9 38 a4  95 a1 ac 31 5a 1a 84 66  |.(.X..8....1Z..f|
+00000260  3d 43 d3 2d d9 0b f2 97  df d3 20 64 38 92 24 3a  |=C.-...... d8.$:|
+00000270  00 bc cf 9c 7d b7 40 20  01 5f aa d3 16 61 09 a2  |....}.@ ._...a..|
+00000280  76 fd 13 c3 cc e1 0c 5c  ee b1 87 82 f1 6c 04 ed  |v......\.....l..|
+00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
+000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
+000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
+000002c0  16 03 03 00 cd 0c 00 00  c9 03 00 17 41 04 28 4d  |............A.(M|
+000002d0  03 04 41 d2 e5 04 f6 34  90 21 2e bc da 53 95 9d  |..A....4.!...S..|
+000002e0  2b 10 d8 b5 e2 e1 47 06  08 b7 7a 4a d4 13 3a f9  |+.....G...zJ..:.|
+000002f0  50 22 c0 fb 4e 13 b9 1f  b9 43 20 71 be b8 e1 9b  |P"..N....C q....|
+00000300  c8 6b 48 fb 80 22 87 8a  61 54 fb c1 7a 7e 08 04  |.kH.."..aT..z~..|
+00000310  00 80 86 09 16 06 8e 1c  c9 02 ec 9d d9 4d c0 d1  |.............M..|
+00000320  d1 d0 48 96 f6 31 4a 69  02 9e 27 26 ca ff bb 1e  |..H..1Ji..'&....|
+00000330  94 3b fb 41 fa 11 a5 cd  ec a7 a0 6f 4c 35 dc 7a  |.;.A.......oL5.z|
+00000340  fb fd c4 41 ab 5b ee 21  96 16 9d 42 8f ce b6 50  |...A.[.!...B...P|
+00000350  6a 48 9f 92 d2 00 70 53  30 c3 3d 5e a9 cb e3 f1  |jH....pS0.=^....|
+00000360  52 19 c8 1a 58 f5 19 9a  11 a2 ea 9d a2 29 5e b2  |R...X........)^.|
+00000370  ef bb c1 a6 c5 2c e4 33  2f 6d 60 ac 34 42 dc 42  |.....,.3/m`.4B.B|
+00000380  85 69 e3 c6 b8 2d af c4  37 8e b8 b6 39 4e 07 ff  |.i...-..7...9N..|
+00000390  88 d0 16 03 03 00 04 0e  00 00 00                 |...........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 46 10 00 00  42 41 04 1e 18 37 ef 0d  |....F...BA...7..|
 00000010  19 51 88 35 75 71 b5 e5  54 5b 12 2e 8f 09 67 fd  |.Q.5uq..T[....g.|
 00000020  a7 24 20 3e b2 56 1c ce  97 28 5e f8 2b 2d 4f 9e  |.$ >.V...(^.+-O.|
 00000030  f1 07 9f 6c 4b 5b 83 56  e2 32 42 e9 58 b6 d7 49  |...lK[.V.2B.X..I|
 00000040  a6 b5 68 1a 41 03 56 6b  dc 5a 89 14 03 03 00 01  |..h.A.Vk.Z......|
-00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 c1 90  |.....(..........|
-00000060  a0 8b 53 87 a8 e3 56 4c  5c ad 5f dc 00 af 29 5f  |..S...VL\._...)_|
-00000070  11 53 7d 49 25 f8 74 16  dc 84 5f 3b c6 24        |.S}I%.t..._;.$|
+00000050  01 16 03 03 00 28 00 00  00 00 00 00 00 00 e3 ce  |.....(..........|
+00000060  26 ff 24 7b cf 1a 6e 65  68 3d 56 ca 11 6c 7c a6  |&.${..neh=V..l|.|
+00000070  de 97 f1 f3 cd 04 4e 38  bd 0c 5b 08 1b dd        |......N8..[...|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 00 f9 b2 51 85  |..........(...Q.|
-00000010  72 7e ec 79 72 59 90 ae  69 51 79 61 10 3b 4e 4b  |r~.yrY..iQya.;NK|
-00000020  45 d6 a5 9a c0 1a 69 c9  9f 1c ee cd ad 6a e8 ea  |E.....i......j..|
-00000030  c4 9e f1                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 28 38 ac 96 e8 6f  |..........(8...o|
+00000010  bc 22 ba 46 a9 64 f6 dc  19 79 5e 01 cd 50 db 9e  |.".F.d...y^..P..|
+00000020  98 23 19 2a f2 25 49 b9  f1 cb 63 c5 5e 32 85 c4  |.#.*.%I...c.^2..|
+00000030  e0 e5 16                                          |...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 86 5a 45  |..............ZE|
-00000010  24 60 90 dc bc b3 f6 61  6f db 60 02 99 f9 e2 93  |$`.....ao.`.....|
-00000020  07 85 0d 15 03 03 00 1a  00 00 00 00 00 00 00 02  |................|
-00000030  36 86 b0 60 b5 5d dd 28  64 c6 5b c7 ed 01 07 b1  |6..`.].(d.[.....|
-00000040  12 39                                             |.9|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 b7 b1 9c  |................|
+00000010  5d 9f f1 b7 21 b3 30 00  9d 39 26 5f 6e 99 67 e8  |]...!.0..9&_n.g.|
+00000020  47 01 62 15 03 03 00 1a  00 00 00 00 00 00 00 02  |G.b.............|
+00000030  2a 2f 3f 76 2a 10 9b ee  c0 86 41 8a fe cf c5 70  |*/?v*.....A....p|
+00000040  c7 ac                                             |..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4 b/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4
index 12fb594c04..f995680c38 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4
+++ b/src/crypto/tls/testdata/Client-TLSv12-RSA-RC4
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,59 +7,61 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 51 02 00 00  4d 03 03 b0 e7 ee 09 45  |....Q...M......E|
-00000010  36 f1 7a 92 be 9e d8 9d  ae cd c1 4e b2 12 94 3e  |6.z........N...>|
-00000020  6c 34 71 ed 5f e0 97 7f  25 e4 dd 20 f4 43 01 03  |l4q._...%.. .C..|
-00000030  88 33 26 7f 48 c1 f2 d1  4d d3 f8 1a bd 86 4c 50  |.3&.H...M.....LP|
-00000040  18 89 dc 08 99 f1 51 c5  84 be b9 fd 00 05 00 00  |......Q.........|
-00000050  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
-00000060  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
-00000070  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
-00000080  09 2a 86 48 86 f7 0d 01  01 0b 05 00 30 1f 31 0b  |.*.H........0.1.|
-00000090  30 09 06 03 55 04 0a 13  02 47 6f 31 10 30 0e 06  |0...U....Go1.0..|
-000000a0  03 55 04 03 13 07 47 6f  20 52 6f 6f 74 30 1e 17  |.U....Go Root0..|
-000000b0  0d 31 36 30 31 30 31 30  30 30 30 30 30 5a 17 0d  |.160101000000Z..|
-000000c0  32 35 30 31 30 31 30 30  30 30 30 30 5a 30 1a 31  |250101000000Z0.1|
-000000d0  0b 30 09 06 03 55 04 0a  13 02 47 6f 31 0b 30 09  |.0...U....Go1.0.|
-000000e0  06 03 55 04 03 13 02 47  6f 30 81 9f 30 0d 06 09  |..U....Go0..0...|
-000000f0  2a 86 48 86 f7 0d 01 01  01 05 00 03 81 8d 00 30  |*.H............0|
-00000100  81 89 02 81 81 00 db 46  7d 93 2e 12 27 06 48 bc  |.......F}...'.H.|
-00000110  06 28 21 ab 7e c4 b6 a2  5d fe 1e 52 45 88 7a 36  |.(!.~...]..RE.z6|
-00000120  47 a5 08 0d 92 42 5b c2  81 c0 be 97 79 98 40 fb  |G....B[.....y.@.|
-00000130  4f 6d 14 fd 2b 13 8b c2  a5 2e 67 d8 d4 09 9e d6  |Om..+.....g.....|
-00000140  22 38 b7 4a 0b 74 73 2b  c2 34 f1 d1 93 e5 96 d9  |"8.J.ts+.4......|
-00000150  74 7b f3 58 9f 6c 61 3c  c0 b0 41 d4 d9 2b 2b 24  |t{.X.la<..A..++$|
-00000160  23 77 5b 1c 3b bd 75 5d  ce 20 54 cf a1 63 87 1d  |#w[.;.u]. T..c..|
-00000170  1e 24 c4 f3 1d 1a 50 8b  aa b6 14 43 ed 97 a7 75  |.$....P....C...u|
-00000180  62 f4 14 c8 52 d7 02 03  01 00 01 a3 81 93 30 81  |b...R.........0.|
-00000190  90 30 0e 06 03 55 1d 0f  01 01 ff 04 04 03 02 05  |.0...U..........|
-000001a0  a0 30 1d 06 03 55 1d 25  04 16 30 14 06 08 2b 06  |.0...U.%..0...+.|
-000001b0  01 05 05 07 03 01 06 08  2b 06 01 05 05 07 03 02  |........+.......|
-000001c0  30 0c 06 03 55 1d 13 01  01 ff 04 02 30 00 30 19  |0...U.......0.0.|
-000001d0  06 03 55 1d 0e 04 12 04  10 9f 91 16 1f 43 43 3e  |..U..........CC>|
-000001e0  49 a6 de 6d b6 80 d7 9f  60 30 1b 06 03 55 1d 23  |I..m....`0...U.#|
-000001f0  04 14 30 12 80 10 48 13  49 4d 13 7e 16 31 bb a3  |..0...H.IM.~.1..|
-00000200  01 d5 ac ab 6e 7b 30 19  06 03 55 1d 11 04 12 30  |....n{0...U....0|
-00000210  10 82 0e 65 78 61 6d 70  6c 65 2e 67 6f 6c 61 6e  |...example.golan|
-00000220  67 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |g0...*.H........|
-00000230  03 81 81 00 9d 30 cc 40  2b 5b 50 a0 61 cb ba e5  |.....0.@+[P.a...|
-00000240  53 58 e1 ed 83 28 a9 58  1a a9 38 a4 95 a1 ac 31  |SX...(.X..8....1|
-00000250  5a 1a 84 66 3d 43 d3 2d  d9 0b f2 97 df d3 20 64  |Z..f=C.-...... d|
-00000260  38 92 24 3a 00 bc cf 9c  7d b7 40 20 01 5f aa d3  |8.$:....}.@ ._..|
-00000270  16 61 09 a2 76 fd 13 c3  cc e1 0c 5c ee b1 87 82  |.a..v......\....|
-00000280  f1 6c 04 ed 73 bb b3 43  77 8d 0c 1c f1 0f a1 d8  |.l..s..Cw.......|
-00000290  40 83 61 c9 4c 72 2b 9d  ae db 46 06 06 4d f4 c1  |@.a.Lr+...F..M..|
-000002a0  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
-000002b0  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
+00000000  16 03 03 00 55 02 00 00  51 03 03 d4 a4 5a fb c9  |....U...Q....Z..|
+00000010  93 ee 7e 5a c4 04 8e bb  72 da ad a4 0f 9c 0f 6e  |..~Z....r......n|
+00000020  2b 28 9a ef 28 be d4 49  9b 50 56 20 f8 5a e3 7b  |+(..(..I.PV .Z.{|
+00000030  c7 96 74 ff 52 4f 68 32  08 15 2b 46 ad 47 3e 49  |..t.ROh2..+F.G>I|
+00000040  f9 a7 f8 65 78 fe 01 c0  8f ab 8e 14 00 05 00 00  |...ex...........|
+00000050  09 ff 01 00 01 00 00 17  00 00 16 03 03 02 59 0b  |..............Y.|
+00000060  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
+00000070  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
+00000080  a6 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |.0...*.H........|
+00000090  30 1f 31 0b 30 09 06 03  55 04 0a 13 02 47 6f 31  |0.1.0...U....Go1|
+000000a0  10 30 0e 06 03 55 04 03  13 07 47 6f 20 52 6f 6f  |.0...U....Go Roo|
+000000b0  74 30 1e 17 0d 31 36 30  31 30 31 30 30 30 30 30  |t0...16010100000|
+000000c0  30 5a 17 0d 32 35 30 31  30 31 30 30 30 30 30 30  |0Z..250101000000|
+000000d0  5a 30 1a 31 0b 30 09 06  03 55 04 0a 13 02 47 6f  |Z0.1.0...U....Go|
+000000e0  31 0b 30 09 06 03 55 04  03 13 02 47 6f 30 81 9f  |1.0...U....Go0..|
+000000f0  30 0d 06 09 2a 86 48 86  f7 0d 01 01 01 05 00 03  |0...*.H.........|
+00000100  81 8d 00 30 81 89 02 81  81 00 db 46 7d 93 2e 12  |...0.......F}...|
+00000110  27 06 48 bc 06 28 21 ab  7e c4 b6 a2 5d fe 1e 52  |'.H..(!.~...]..R|
+00000120  45 88 7a 36 47 a5 08 0d  92 42 5b c2 81 c0 be 97  |E.z6G....B[.....|
+00000130  79 98 40 fb 4f 6d 14 fd  2b 13 8b c2 a5 2e 67 d8  |y.@.Om..+.....g.|
+00000140  d4 09 9e d6 22 38 b7 4a  0b 74 73 2b c2 34 f1 d1  |...."8.J.ts+.4..|
+00000150  93 e5 96 d9 74 7b f3 58  9f 6c 61 3c c0 b0 41 d4  |....t{.X.la<..A.|
+00000160  d9 2b 2b 24 23 77 5b 1c  3b bd 75 5d ce 20 54 cf  |.++$#w[.;.u]. T.|
+00000170  a1 63 87 1d 1e 24 c4 f3  1d 1a 50 8b aa b6 14 43  |.c...$....P....C|
+00000180  ed 97 a7 75 62 f4 14 c8  52 d7 02 03 01 00 01 a3  |...ub...R.......|
+00000190  81 93 30 81 90 30 0e 06  03 55 1d 0f 01 01 ff 04  |..0..0...U......|
+000001a0  04 03 02 05 a0 30 1d 06  03 55 1d 25 04 16 30 14  |.....0...U.%..0.|
+000001b0  06 08 2b 06 01 05 05 07  03 01 06 08 2b 06 01 05  |..+.........+...|
+000001c0  05 07 03 02 30 0c 06 03  55 1d 13 01 01 ff 04 02  |....0...U.......|
+000001d0  30 00 30 19 06 03 55 1d  0e 04 12 04 10 9f 91 16  |0.0...U.........|
+000001e0  1f 43 43 3e 49 a6 de 6d  b6 80 d7 9f 60 30 1b 06  |.CC>I..m....`0..|
+000001f0  03 55 1d 23 04 14 30 12  80 10 48 13 49 4d 13 7e  |.U.#..0...H.IM.~|
+00000200  16 31 bb a3 01 d5 ac ab  6e 7b 30 19 06 03 55 1d  |.1......n{0...U.|
+00000210  11 04 12 30 10 82 0e 65  78 61 6d 70 6c 65 2e 67  |...0...example.g|
+00000220  6f 6c 61 6e 67 30 0d 06  09 2a 86 48 86 f7 0d 01  |olang0...*.H....|
+00000230  01 0b 05 00 03 81 81 00  9d 30 cc 40 2b 5b 50 a0  |.........0.@+[P.|
+00000240  61 cb ba e5 53 58 e1 ed  83 28 a9 58 1a a9 38 a4  |a...SX...(.X..8.|
+00000250  95 a1 ac 31 5a 1a 84 66  3d 43 d3 2d d9 0b f2 97  |...1Z..f=C.-....|
+00000260  df d3 20 64 38 92 24 3a  00 bc cf 9c 7d b7 40 20  |.. d8.$:....}.@ |
+00000270  01 5f aa d3 16 61 09 a2  76 fd 13 c3 cc e1 0c 5c  |._...a..v......\|
+00000280  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
+00000290  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
+000002a0  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
+000002b0  84 5c 21 d3 3b e9 fa e7  16 03 03 00 04 0e 00 00  |.\!.;...........|
+000002c0  00                                                |.|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 86 10 00 00  82 00 80 b9 65 8d bf a7  |............e...|
 00000010  c8 4b 79 ce 6f cb 8b 13  1c ac b9 7d 66 5e e9 ba  |.Ky.o......}f^..|
@@ -70,15 +72,15 @@
 00000060  c5 70 0f 08 83 48 e9 48  ef 6e 50 8b 05 7e e5 84  |.p...H.H.nP..~..|
 00000070  25 fa 55 c7 ae 31 02 27  00 ef 3f 98 86 20 12 89  |%.U..1.'..?.. ..|
 00000080  91 59 28 b4 f7 d7 af d2  69 61 35 14 03 03 00 01  |.Y(.....ia5.....|
-00000090  01 16 03 03 00 24 08 65  01 80 0d 59 b8 ac 0f 09  |.....$.e...Y....|
-000000a0  bf 61 31 32 e0 74 e9 f4  72 e3 2c 79 11 4d b2 a2  |.a12.t..r.,y.M..|
-000000b0  55 65 94 c8 cd 0a 61 99  07 b8                    |Ue....a...|
+00000090  01 16 03 03 00 24 f7 3b  92 e7 9f 80 de 5b d4 9e  |.....$.;.....[..|
+000000a0  d3 02 d3 d9 2c e1 74 2e  98 90 fe d9 ee 08 57 28  |....,.t.......W(|
+000000b0  47 99 86 84 f5 95 c5 a6  7f 82                    |G.........|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 24 04 20 46 cd fb  |..........$. F..|
-00000010  6c 46 9c 47 21 03 fe 9b  a4 c6 da 2c 71 2f db 92  |lF.G!......,q/..|
-00000020  40 da 7d 46 2e e4 9c 81  86 89 7f 53 46 91 28     |@.}F.......SF.(|
+00000000  14 03 03 00 01 01 16 03  03 00 24 c9 09 6c e8 0b  |..........$..l..|
+00000010  44 56 62 ed 1f f1 ef 9d  a9 cd a4 49 01 0d 2b e3  |DVb........I..+.|
+00000020  8f 3d 31 6d bf c5 63 af  d4 59 30 47 c6 cd 20     |.=1m..c..Y0G.. |
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1a 89 2b 2e  49 21 19 b7 d0 df 85 da  |......+.I!......|
-00000010  b8 a7 f3 73 5f fe 44 e5  0c a1 af 16 74 93 bc 15  |...s_.D.....t...|
-00000020  03 03 00 16 5f 9e 64 d0  91 50 34 44 cf f6 1f e0  |...._.d..P4D....|
-00000030  e0 13 b9 67 da 5c 99 16  f1 b3                    |...g.\....|
+00000000  17 03 03 00 1a 65 05 a9  14 f7 fd 4e e1 68 20 7e  |.....e.....N.h ~|
+00000010  32 79 ca e6 e7 79 a3 d6  ce fd 28 37 c7 e2 c5 15  |2y...y....(7....|
+00000020  03 03 00 16 87 82 bc 62  e3 c0 4d 2e 75 86 21 05  |.......b..M.u.!.|
+00000030  c0 3d 40 d4 1d fc 1b 42  ef 55                    |.=@....B.U|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce
index 06752dea01..30db28992f 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateOnce
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,238 +7,240 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 5b 4b bb c4 39  |....Y...U..[K..9|
-00000010  fb 45 5c 54 03 30 0f 71  c3 2e 48 25 33 fd 6d 40  |.E\T.0.q..H%3.m@|
-00000020  18 6e 75 43 66 9e 08 fb  6a a1 f8 20 34 3c c4 2a  |.nuCf...j.. 4<.*|
-00000030  b5 9b 65 b0 cd b9 fc ce  cf 51 f8 cc a1 5d 00 ed  |..e......Q...]..|
-00000040  49 5b 43 9a ff c4 cf 6b  d8 2a ea e5 cc a8 00 00  |I[C....k.*......|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
-00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
-00000080  3f e2 5b ea a6 30 0d 06  09 2a 86 48 86 f7 0d 01  |?.[..0...*.H....|
-00000090  01 0b 05 00 30 1f 31 0b  30 09 06 03 55 04 0a 13  |....0.1.0...U...|
-000000a0  02 47 6f 31 10 30 0e 06  03 55 04 03 13 07 47 6f  |.Go1.0...U....Go|
-000000b0  20 52 6f 6f 74 30 1e 17  0d 31 36 30 31 30 31 30  | Root0...1601010|
-000000c0  30 30 30 30 30 5a 17 0d  32 35 30 31 30 31 30 30  |00000Z..25010100|
-000000d0  30 30 30 30 5a 30 1a 31  0b 30 09 06 03 55 04 0a  |0000Z0.1.0...U..|
-000000e0  13 02 47 6f 31 0b 30 09  06 03 55 04 03 13 02 47  |..Go1.0...U....G|
-000000f0  6f 30 81 9f 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |o0..0...*.H.....|
-00000100  01 05 00 03 81 8d 00 30  81 89 02 81 81 00 db 46  |.......0.......F|
-00000110  7d 93 2e 12 27 06 48 bc  06 28 21 ab 7e c4 b6 a2  |}...'.H..(!.~...|
-00000120  5d fe 1e 52 45 88 7a 36  47 a5 08 0d 92 42 5b c2  |]..RE.z6G....B[.|
-00000130  81 c0 be 97 79 98 40 fb  4f 6d 14 fd 2b 13 8b c2  |....y.@.Om..+...|
-00000140  a5 2e 67 d8 d4 09 9e d6  22 38 b7 4a 0b 74 73 2b  |..g....."8.J.ts+|
-00000150  c2 34 f1 d1 93 e5 96 d9  74 7b f3 58 9f 6c 61 3c  |.4......t{.X.la<|
-00000160  c0 b0 41 d4 d9 2b 2b 24  23 77 5b 1c 3b bd 75 5d  |..A..++$#w[.;.u]|
-00000170  ce 20 54 cf a1 63 87 1d  1e 24 c4 f3 1d 1a 50 8b  |. T..c...$....P.|
-00000180  aa b6 14 43 ed 97 a7 75  62 f4 14 c8 52 d7 02 03  |...C...ub...R...|
-00000190  01 00 01 a3 81 93 30 81  90 30 0e 06 03 55 1d 0f  |......0..0...U..|
-000001a0  01 01 ff 04 04 03 02 05  a0 30 1d 06 03 55 1d 25  |.........0...U.%|
-000001b0  04 16 30 14 06 08 2b 06  01 05 05 07 03 01 06 08  |..0...+.........|
-000001c0  2b 06 01 05 05 07 03 02  30 0c 06 03 55 1d 13 01  |+.......0...U...|
-000001d0  01 ff 04 02 30 00 30 19  06 03 55 1d 0e 04 12 04  |....0.0...U.....|
-000001e0  10 9f 91 16 1f 43 43 3e  49 a6 de 6d b6 80 d7 9f  |.....CC>I..m....|
-000001f0  60 30 1b 06 03 55 1d 23  04 14 30 12 80 10 48 13  |`0...U.#..0...H.|
-00000200  49 4d 13 7e 16 31 bb a3  01 d5 ac ab 6e 7b 30 19  |IM.~.1......n{0.|
-00000210  06 03 55 1d 11 04 12 30  10 82 0e 65 78 61 6d 70  |..U....0...examp|
-00000220  6c 65 2e 67 6f 6c 61 6e  67 30 0d 06 09 2a 86 48  |le.golang0...*.H|
-00000230  86 f7 0d 01 01 0b 05 00  03 81 81 00 9d 30 cc 40  |.............0.@|
-00000240  2b 5b 50 a0 61 cb ba e5  53 58 e1 ed 83 28 a9 58  |+[P.a...SX...(.X|
-00000250  1a a9 38 a4 95 a1 ac 31  5a 1a 84 66 3d 43 d3 2d  |..8....1Z..f=C.-|
-00000260  d9 0b f2 97 df d3 20 64  38 92 24 3a 00 bc cf 9c  |...... d8.$:....|
-00000270  7d b7 40 20 01 5f aa d3  16 61 09 a2 76 fd 13 c3  |}.@ ._...a..v...|
-00000280  cc e1 0c 5c ee b1 87 82  f1 6c 04 ed 73 bb b3 43  |...\.....l..s..C|
-00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
-000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
-000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 76 c4 f4 ec a2 d6 c1  |........ v......|
-000002d0  b1 d8 b0 41 71 8a ee e9  8a 17 06 90 6b 0c 05 66  |...Aq.......k..f|
-000002e0  54 d8 a6 ad 50 95 11 f0  03 08 04 00 80 46 0b da  |T...P........F..|
-000002f0  0b 0c 6c 1a 2e a2 7e 28  40 1b 40 9a b4 5c 36 88  |..l...~(@.@..\6.|
-00000300  c1 ad cd 45 be 23 17 a6  98 e5 11 fe a8 78 c6 21  |...E.#.......x.!|
-00000310  17 a6 a8 7d ce 28 c4 ef  51 76 f8 b1 b1 75 31 04  |...}.(..Qv...u1.|
-00000320  b9 14 bc 3b bf 59 50 b8  e1 ad c6 86 45 3c e1 70  |...;.YP.....E<.p|
-00000330  fb cd 69 8c 0a 5f f6 2d  bd 10 95 30 ed 4c 9a 47  |..i.._.-...0.L.G|
-00000340  73 8b 39 72 00 0a 7e 8f  a9 42 27 01 6f 3d 37 f9  |s.9r..~..B'.o=7.|
-00000350  7d d4 1b a2 6a 07 37 dc  5e 6c 8b b1 d5 75 3a 9b  |}...j.7.^l...u:.|
-00000360  d1 45 c5 d8 e0 90 f0 62  3d d5 01 00 9e 16 03 03  |.E.....b=.......|
-00000370  00 04 0e 00 00 00                                 |......|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 6d a7 e6 c4 60  |....]...Y..m...`|
+00000010  8e dd 95 85 14 dc 69 2b  d5 16 35 dd 4f a1 43 d4  |......i+..5.O.C.|
+00000020  3c 8f 0f 55 4b f1 86 68  51 5b 17 20 d8 44 06 84  |<..UK..hQ[. .D..|
+00000030  d5 1d 9b ed 45 25 d0 e8  a2 73 fd 44 01 fa 38 63  |....E%...s.D..8c|
+00000040  c3 18 35 1c b8 54 ec 78  ab 5f 3d f3 cc a8 00 00  |..5..T.x._=.....|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
+00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
+00000080  00 e8 f0 9d 3f e2 5b ea  a6 30 0d 06 09 2a 86 48  |....?.[..0...*.H|
+00000090  86 f7 0d 01 01 0b 05 00  30 1f 31 0b 30 09 06 03  |........0.1.0...|
+000000a0  55 04 0a 13 02 47 6f 31  10 30 0e 06 03 55 04 03  |U....Go1.0...U..|
+000000b0  13 07 47 6f 20 52 6f 6f  74 30 1e 17 0d 31 36 30  |..Go Root0...160|
+000000c0  31 30 31 30 30 30 30 30  30 5a 17 0d 32 35 30 31  |101000000Z..2501|
+000000d0  30 31 30 30 30 30 30 30  5a 30 1a 31 0b 30 09 06  |01000000Z0.1.0..|
+000000e0  03 55 04 0a 13 02 47 6f  31 0b 30 09 06 03 55 04  |.U....Go1.0...U.|
+000000f0  03 13 02 47 6f 30 81 9f  30 0d 06 09 2a 86 48 86  |...Go0..0...*.H.|
+00000100  f7 0d 01 01 01 05 00 03  81 8d 00 30 81 89 02 81  |...........0....|
+00000110  81 00 db 46 7d 93 2e 12  27 06 48 bc 06 28 21 ab  |...F}...'.H..(!.|
+00000120  7e c4 b6 a2 5d fe 1e 52  45 88 7a 36 47 a5 08 0d  |~...]..RE.z6G...|
+00000130  92 42 5b c2 81 c0 be 97  79 98 40 fb 4f 6d 14 fd  |.B[.....y.@.Om..|
+00000140  2b 13 8b c2 a5 2e 67 d8  d4 09 9e d6 22 38 b7 4a  |+.....g....."8.J|
+00000150  0b 74 73 2b c2 34 f1 d1  93 e5 96 d9 74 7b f3 58  |.ts+.4......t{.X|
+00000160  9f 6c 61 3c c0 b0 41 d4  d9 2b 2b 24 23 77 5b 1c  |.la<..A..++$#w[.|
+00000170  3b bd 75 5d ce 20 54 cf  a1 63 87 1d 1e 24 c4 f3  |;.u]. T..c...$..|
+00000180  1d 1a 50 8b aa b6 14 43  ed 97 a7 75 62 f4 14 c8  |..P....C...ub...|
+00000190  52 d7 02 03 01 00 01 a3  81 93 30 81 90 30 0e 06  |R.........0..0..|
+000001a0  03 55 1d 0f 01 01 ff 04  04 03 02 05 a0 30 1d 06  |.U...........0..|
+000001b0  03 55 1d 25 04 16 30 14  06 08 2b 06 01 05 05 07  |.U.%..0...+.....|
+000001c0  03 01 06 08 2b 06 01 05  05 07 03 02 30 0c 06 03  |....+.......0...|
+000001d0  55 1d 13 01 01 ff 04 02  30 00 30 19 06 03 55 1d  |U.......0.0...U.|
+000001e0  0e 04 12 04 10 9f 91 16  1f 43 43 3e 49 a6 de 6d  |.........CC>I..m|
+000001f0  b6 80 d7 9f 60 30 1b 06  03 55 1d 23 04 14 30 12  |....`0...U.#..0.|
+00000200  80 10 48 13 49 4d 13 7e  16 31 bb a3 01 d5 ac ab  |..H.IM.~.1......|
+00000210  6e 7b 30 19 06 03 55 1d  11 04 12 30 10 82 0e 65  |n{0...U....0...e|
+00000220  78 61 6d 70 6c 65 2e 67  6f 6c 61 6e 67 30 0d 06  |xample.golang0..|
+00000230  09 2a 86 48 86 f7 0d 01  01 0b 05 00 03 81 81 00  |.*.H............|
+00000240  9d 30 cc 40 2b 5b 50 a0  61 cb ba e5 53 58 e1 ed  |.0.@+[P.a...SX..|
+00000250  83 28 a9 58 1a a9 38 a4  95 a1 ac 31 5a 1a 84 66  |.(.X..8....1Z..f|
+00000260  3d 43 d3 2d d9 0b f2 97  df d3 20 64 38 92 24 3a  |=C.-...... d8.$:|
+00000270  00 bc cf 9c 7d b7 40 20  01 5f aa d3 16 61 09 a2  |....}.@ ._...a..|
+00000280  76 fd 13 c3 cc e1 0c 5c  ee b1 87 82 f1 6c 04 ed  |v......\.....l..|
+00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
+000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
+000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 f1 ac a3  |............ ...|
+000002d0  08 ba 9d 89 8e 71 c3 db  b1 46 f0 ac 2f 32 13 ad  |.....q...F../2..|
+000002e0  f7 42 ee b5 9f e5 5c 52  46 0a 9a 53 75 08 04 00  |.B....\RF..Su...|
+000002f0  80 89 8c 5b cd e9 fe 7f  6b 15 36 bc d7 43 ed f3  |...[....k.6..C..|
+00000300  96 df 69 7c 65 26 f8 68  4f 5b fb 53 75 2c 5a 65  |..i|e&.hO[.Su,Ze|
+00000310  4d b4 7b c5 bd 36 71 ea  43 bb 84 ec f3 8f 6b 49  |M.{..6q.C.....kI|
+00000320  26 cb fa c1 4c 8b 92 e1  91 ed 09 61 7d 85 44 ea  |&...L......a}.D.|
+00000330  a7 1c a4 47 02 d2 b4 c0  bf 44 14 e8 03 64 8d 86  |...G.....D...d..|
+00000340  80 5c 63 eb ab a0 66 ca  30 2e d7 04 54 d8 91 94  |.\c...f.0...T...|
+00000350  37 e8 6c b8 00 a0 06 98  5c 67 c2 46 a2 e9 5c b8  |7.l.....\g.F..\.|
+00000360  66 46 b8 82 65 22 29 80  b8 af 50 37 5c 00 96 a5  |fF..e")...P7\...|
+00000370  85 16 03 03 00 04 0e 00  00 00                    |..........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 bb f4 78  64 23 f7 31 50 42 3d 97  |.... ..xd#.1PB=.|
-00000040  8f 73 89 b9 90 8f 74 b6  e4 7d 58 27 65 25 59 8a  |.s....t..}X'e%Y.|
-00000050  5a 8d 8f fa bd                                    |Z....|
+00000030  16 03 03 00 20 ca 08 57  0f 80 64 62 ad 11 01 27  |.... ..W..db...'|
+00000040  39 d8 80 6c a6 05 f6 75  a1 b6 0d 72 c0 25 f7 bc  |9..l...u...r.%..|
+00000050  f0 de 76 ee 29                                    |..v.)|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 0a 43 74 53 47  |.......... .CtSG|
-00000010  41 4b 0a f1 f7 75 51 a9  22 c9 e0 5c 53 90 6b d7  |AK...uQ."..\S.k.|
-00000020  97 18 c6 ef c3 85 32 f5  7c 26 97                 |......2.|&.|
+00000000  14 03 03 00 01 01 16 03  03 00 20 27 45 9d b0 c3  |.......... 'E...|
+00000010  18 c6 34 cb 1a 38 33 ac  91 4f f1 e5 d5 02 ed 62  |..4..83..O.....b|
+00000020  c0 46 1e a0 4a b3 46 35  2e e1 a2                 |.F..J.F5...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 8e 83 1a  32 53 02 1c fa 84 89 4f  |........2S.....O|
-00000010  25 fb 5f 85 4f bd ee ae  9f 0f ea                 |%._.O......|
+00000000  17 03 03 00 16 50 48 06  41 d8 9d 1b e9 8b 55 9b  |.....PH.A.....U.|
+00000010  3c ba ea 58 93 5b 56 17  6e 94 18                 |<..X.[V.n..|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 14 96 76 32  c4 6d e6 23 bf 21 a8 09  |......v2.m.#.!..|
-00000010  a3 8b 69 98 cd c3 c9 ce  73                       |..i.....s|
+00000000  16 03 03 00 14 4c 65 ba  49 aa 53 4c 73 0a 51 ac  |.....Le.I.SLs.Q.|
+00000010  43 0d 4c 1f 83 6b d9 b1  06                       |C.L..k...|
 >>> Flow 7 (client to server)
-00000000  16 03 03 01 16 72 5b d9  30 b2 b0 91 e2 3d 2b 12  |.....r[.0....=+.|
-00000010  2c c9 43 f1 67 ae 54 ee  ce a1 15 12 12 9a 27 46  |,.C.g.T.......'F|
-00000020  7e 47 90 d4 f2 7d b9 98  ec f8 61 b8 84 52 9f 21  |~G...}....a..R.!|
-00000030  c1 83 6a ce 1a 68 fc 5b  25 42 f3 8f 55 ee 92 45  |..j..h.[%B..U..E|
-00000040  af a4 d1 c4 a6 b5 0e 58  3d 70 76 98 ec 47 af 6f  |.......X=pv..G.o|
-00000050  e3 4f 9f ef 52 a3 aa 33  75 83 f6 57 33 a8 dc f5  |.O..R..3u..W3...|
-00000060  36 49 09 1c 72 31 c1 43  52 64 4a b5 ca ce 06 f5  |6I..r1.CRdJ.....|
-00000070  91 18 90 85 f0 c9 96 4f  bf 4c de 9e 50 a2 1c de  |.......O.L..P...|
-00000080  86 51 1f 0b 73 e1 df 1d  2d 90 6d 7f a2 f1 28 e8  |.Q..s...-.m...(.|
-00000090  5f 2a 78 2d 8e ab f2 05  19 85 4e 92 a8 cf cd 16  |_*x-......N.....|
-000000a0  1e df 1d 51 ee 8b ba 72  cd ac d2 01 4b 84 46 62  |...Q...r....K.Fb|
-000000b0  1c 28 4d 3f 44 c1 62 12  13 4f f8 73 f4 da c0 98  |.(M?D.b..O.s....|
-000000c0  14 da 31 6a 48 0d 1d bb  24 6c ef 0f 98 c0 3c 86  |..1jH...$l....<.|
-000000d0  c6 d6 8e ab bd 20 bd 06  e9 ba aa ce 3a 88 25 95  |..... ......:.%.|
-000000e0  54 15 fb c6 49 c7 98 ff  27 92 c0 60 6a 3c f8 26  |T...I...'..`j<.&|
-000000f0  fd 28 ac c4 8f 5c 4f 15  24 10 45 3c 07 3d 3f 50  |.(...\O.$.E<.=?P|
-00000100  e5 db cf 78 bd b0 d2 24  a2 4b 3e a6 9c 2d 3b 0d  |...x...$.K>..-;.|
-00000110  d8 1b 86 88 dc 0c 3c 9c  16 cf ea                 |......<....|
+00000000  16 03 03 01 1a fd 7a 4e  2b 7b 8a 07 cc cb 5b 82  |......zN+{....[.|
+00000010  df d1 00 69 f8 6f 89 28  4b 91 87 c8 18 20 ec 41  |...i.o.(K.... .A|
+00000020  ec c7 bd 04 3d 02 a5 42  fe e1 23 cc 20 aa 22 e8  |....=..B..#. .".|
+00000030  31 2e 09 a3 ac c1 3d 04  29 2e 82 1c 31 27 8e e2  |1.....=.)...1'..|
+00000040  50 de ca 3d 4d ad 7e 01  74 94 40 3d 7c 2d 08 56  |P..=M.~.t.@=|-.V|
+00000050  d2 89 7b 3a b8 2a b1 34  22 65 25 48 bb 24 1b 4b  |..{:.*.4"e%H.$.K|
+00000060  a2 96 a8 7f ac f2 46 84  4f e2 c8 1c 25 41 eb df  |......F.O...%A..|
+00000070  52 ec 9b bd 89 b8 a8 c3  62 f2 75 16 de 61 63 b0  |R.......b.u..ac.|
+00000080  70 9c d2 c5 b0 86 6b 2a  17 64 9a d1 6d 5c e9 48  |p.....k*.d..m\.H|
+00000090  f5 02 e3 0f 16 df f9 6e  99 56 93 85 2b 10 bc da  |.......n.V..+...|
+000000a0  6e 02 8b 94 ac d2 dc 56  93 ad 8b 1d d6 ff e3 d9  |n......V........|
+000000b0  f8 ee 11 15 c7 e4 ae 4d  fe 88 0c c9 7f 30 1a 2a  |.......M.....0.*|
+000000c0  99 ab f8 0d a2 a9 57 87  35 a4 a9 87 b0 4f 46 8a  |......W.5....OF.|
+000000d0  ec 47 39 32 a7 94 3a 15  08 80 e5 1e 81 4b cd 2e  |.G92..:......K..|
+000000e0  76 9d 99 5b 86 89 37 09  a0 08 86 6e bb 67 ad 3f  |v..[..7....n.g.?|
+000000f0  a2 e9 1f 37 75 4b 0f 07  8c f3 e7 34 05 74 33 a9  |...7uK.....4.t3.|
+00000100  5a e3 5b 0e 68 d0 54 e4  24 c9 6c 42 2d 81 8f 29  |Z.[.h.T.$.lB-..)|
+00000110  17 97 3d a8 00 00 27 50  ae 5d 97 6d fa 7e c0     |..=...'P.].m.~.|
 >>> Flow 8 (server to client)
-00000000  16 03 03 00 81 2e c9 cd  ad df 75 cf b6 8d 7f 8c  |..........u.....|
-00000010  c6 bb 5b e6 2b 40 a0 36  45 13 ae 93 f1 04 bf f3  |..[.+@.6E.......|
-00000020  62 bd c8 62 d9 cf 05 a3  4c e9 37 af 35 a6 83 8e  |b..b....L.7.5...|
-00000030  71 46 b8 2a 5b 02 3b 81  d5 15 b8 17 72 c4 1e 00  |qF.*[.;.....r...|
-00000040  78 d9 4a 04 a7 b3 5b 80  bd 1f 88 ba fa 22 b5 0e  |x.J...[......"..|
-00000050  ca 44 55 27 c0 67 ce 37  4c 9a 9a d7 77 da 58 35  |.DU'.g.7L...w.X5|
-00000060  83 b3 39 90 8d e2 7f 08  2e cc 5a 8e 5e a8 c3 bb  |..9.......Z.^...|
-00000070  db e5 a2 56 56 04 37 13  f3 b1 71 2d ea 0a 56 00  |...VV.7...q-..V.|
-00000080  6e 8d 8b 20 79 30 16 03  03 02 69 76 4b a4 c6 5e  |n.. y0....ivK..^|
-00000090  0a a2 3c 89 24 f6 93 94  25 4e 0b 8a d2 33 2f 03  |..<.$...%N...3/.|
-000000a0  ab 20 22 33 ad 84 6d aa  31 6b 5a 10 0e 42 1b dd  |. "3..m.1kZ..B..|
-000000b0  35 9b a0 dc 31 f8 65 91  c4 14 78 2e 74 2e 1d 46  |5...1.e...x.t..F|
-000000c0  3a 66 41 f0 a3 9a 4e ae  bc 9b 55 f9 d1 9c c5 6e  |:fA...N...U....n|
-000000d0  38 24 19 15 fb e6 c3 85  de ef f0 97 a2 a1 db ed  |8$..............|
-000000e0  b8 d0 05 ae 93 77 d7 45  50 a5 4e 8a 83 84 07 fb  |.....w.EP.N.....|
-000000f0  3a 80 c6 69 3c 6e b2 e3  e0 97 f7 03 93 76 dd 32  |:..i<n.......v.2|
-00000100  0c 5d a2 e6 1f 82 90 8b  dd 93 06 ef eb b7 e0 74  |.].............t|
-00000110  1a 7d 8f 37 c2 c1 41 9c  30 74 ca 37 17 5e 71 a0  |.}.7..A.0t.7.^q.|
-00000120  cb d6 00 47 9d 14 93 aa  fe 57 56 10 ae 88 13 65  |...G.....WV....e|
-00000130  f4 6c 20 4e f9 14 87 73  36 5e d5 20 93 34 db 87  |.l N...s6^. .4..|
-00000140  e7 f8 84 6e 36 9d 60 20  b5 8f 47 33 84 94 22 e1  |...n6.` ..G3..".|
-00000150  5d c6 1c 35 39 61 71 47  90 a9 b4 c6 5e 31 58 d1  |]..59aqG....^1X.|
-00000160  40 d8 22 22 23 c2 53 e3  75 1f 98 1c cc 7f 2d 11  |@.""#.S.u.....-.|
-00000170  31 5e 49 a1 2c d9 c8 db  6e 4e 9d da 57 e1 c9 32  |1^I.,...nN..W..2|
-00000180  03 6c f0 9b df c2 03 d5  b7 e2 04 77 e8 87 bc 14  |.l.........w....|
-00000190  73 66 b0 fb d1 d6 26 0c  36 90 2c 20 43 16 c6 68  |sf....&.6., C..h|
-000001a0  6c c0 ee be 2c da 6f 4f  95 1e cf a0 31 e8 40 48  |l...,.oO....1.@H|
-000001b0  88 61 26 7b 53 5b 42 14  2a 89 a3 1e 03 01 16 9d  |.a&{S[B.*.......|
-000001c0  41 6d de 60 75 1d 36 12  cd 16 8b 1c 93 da 17 79  |Am.`u.6........y|
-000001d0  4b d2 1d 78 64 da 6c cc  5c 7c e3 f9 4d 70 a2 07  |K..xd.l.\|..Mp..|
-000001e0  b4 24 33 de 19 bc d2 1a  43 42 f4 26 8b c0 81 e4  |.$3.....CB.&....|
-000001f0  a3 32 97 09 ec 6f 39 d7  ca c9 c5 ee 38 fd 91 dd  |.2...o9.....8...|
-00000200  c4 dc 3c 53 38 60 c7 b6  60 c6 a9 ff ae 81 e9 8c  |..<S8`..`.......|
-00000210  ea 49 19 3f fe 0e 8e b8  e6 7c ec 4b 63 66 d8 7a  |.I.?.....|.Kcf.z|
-00000220  82 51 7f 24 51 ae ad 91  5d 0e 2c aa ee fa 9f d3  |.Q.$Q...].,.....|
-00000230  22 1a 8b 8d 12 48 bb 3a  7c ea f0 09 af 1a 7e 7e  |"....H.:|.....~~|
-00000240  47 74 b9 b9 1f 97 8e 64  62 52 ae 08 d5 f1 13 cb  |Gt.....dbR......|
-00000250  51 64 b0 6a 33 1f 48 78  c1 91 91 91 a7 75 29 cb  |Qd.j3.Hx.....u).|
-00000260  32 60 96 d4 27 3f a4 8f  12 e9 5d 79 4d fd f9 19  |2`..'?....]yM...|
-00000270  b8 f7 39 d8 53 e5 45 96  0f c6 4f f2 27 c6 e6 07  |..9.S.E...O.'...|
-00000280  40 47 29 94 b9 6a 38 9e  24 bf 9e 92 f6 67 3f e3  |@G)..j8.$....g?.|
-00000290  48 0f 3b 3a d7 7b 14 4e  34 a3 8a 25 b4 a2 d6 15  |H.;:.{.N4..%....|
-000002a0  3f 38 9e ba fa 7e 33 fd  a4 4c ed e7 58 93 65 7d  |?8...~3..L..X.e}|
-000002b0  90 48 fc 70 7e 10 a5 d0  0a ec 96 c4 cf 26 ae 94  |.H.p~........&..|
-000002c0  d7 3f 92 40 2f ad ed c8  bb 69 b1 3e 0b ab 4f 4e  |.?.@/....i.>..ON|
-000002d0  73 91 a6 05 2b a7 89 e8  63 28 39 51 53 8d 2c 5e  |s...+...c(9QS.,^|
-000002e0  c8 64 90 c3 b7 2d ee 00  aa 7f 38 ca 57 ab b8 aa  |.d...-....8.W...|
-000002f0  93 12 af c5 16 03 03 00  bc 0e 58 31 64 e6 68 e6  |..........X1d.h.|
-00000300  10 81 2f 79 e3 49 3a d9  cc 70 09 7e b6 b5 61 c4  |../y.I:..p.~..a.|
-00000310  92 16 22 d0 e5 af b8 b8  91 2e 72 7c cf 95 cb ef  |..".......r|....|
-00000320  14 81 73 33 34 98 65 1b  69 db 2c 9d eb 1c ce be  |..s34.e.i.,.....|
-00000330  1f ce 48 b4 22 8d f0 6e  48 21 8e aa af 83 43 d2  |..H."..nH!....C.|
-00000340  65 54 0f 57 6b ce b1 24  ef 09 bf 7f 23 92 35 07  |eT.Wk..$....#.5.|
-00000350  55 2f 2f e7 b7 d7 72 d2  7c 5f 71 d6 20 9a 68 e8  |U//...r.|_q. .h.|
-00000360  1b 90 0b 13 f7 37 e2 35  0d fc 04 ea 32 50 2d 04  |.....7.5....2P-.|
-00000370  72 1a db d9 71 e1 4e d1  76 7c c3 f5 22 97 92 c5  |r...q.N.v|.."...|
-00000380  61 19 e0 40 b1 14 de 37  9d 8e e7 fd fe 2b 28 97  |a..@...7.....+(.|
-00000390  91 77 8f a7 d4 b1 db bc  a2 78 65 5c a8 8d 41 21  |.w.......xe\..A!|
-000003a0  0e 56 6b ac 0b da a9 dd  b1 51 84 19 20 ab e5 eb  |.Vk......Q.. ...|
-000003b0  f2 52 8d 48 a2 16 03 03  00 4a 69 44 32 65 c2 09  |.R.H.....JiD2e..|
-000003c0  9c c1 d6 66 06 29 c3 a6  c3 10 2e d9 9e d6 0a d3  |...f.)..........|
-000003d0  06 a3 d2 d2 67 52 bd 19  26 a8 ef 08 ed 9f 2b e8  |....gR..&.....+.|
-000003e0  96 ea 08 b7 46 a2 36 e3  c1 84 4b c2 a2 b5 34 9c  |....F.6...K...4.|
-000003f0  83 ea 94 51 e6 ca 9c 0b  e1 e3 86 13 b7 1b 1f 4e  |...Q...........N|
-00000400  ee a1 10 70 16 03 03 00  14 5a 1c c1 14 fd d9 ff  |...p.....Z......|
-00000410  e3 46 ac 89 3b b3 e1 8e  6b 90 41 44 1f           |.F..;...k.AD.|
+00000000  16 03 03 00 85 74 29 5c  40 48 b9 9c 76 e4 eb a1  |.....t)\@H..v...|
+00000010  44 7e f1 72 cd 7b fe 11  47 4d 48 fe bc 75 4e e1  |D~.r.{..GMH..uN.|
+00000020  b4 8d cb d1 0e d7 16 cc  4b d4 61 f9 47 69 cd aa  |........K.a.Gi..|
+00000030  c4 ad bf fd 01 6b 5c a6  63 d4 73 a4 21 f8 fe 72  |.....k\.c.s.!..r|
+00000040  00 48 55 4e 40 6b 85 e5  1c f2 36 c1 91 2e e2 70  |.HUN@k....6....p|
+00000050  38 95 5a aa 0c c7 32 c9  a5 ac 94 dc 6c 50 f5 e9  |8.Z...2.....lP..|
+00000060  9f 14 48 f0 b3 d1 45 99  d3 aa 68 28 22 4a ae 66  |..H...E...h("J.f|
+00000070  3a 2f 06 c1 86 fb 0c f2  b0 ca 6f e2 93 fe 47 e6  |:/........o...G.|
+00000080  2f 33 2d 60 38 42 2f 56  f7 52 16 03 03 02 69 46  |/3-`8B/V.R....iF|
+00000090  86 2d bb 38 d9 57 1c 29  bd 28 17 a8 ef 4e 26 68  |.-.8.W.).(...N&h|
+000000a0  16 73 f7 2c 52 fb 54 f8  4d 6d 1e c2 57 0d 44 16  |.s.,R.T.Mm..W.D.|
+000000b0  24 3d 5d b5 22 8c 13 b0  09 10 45 65 48 ec 5c 3f  |$=].".....EeH.\?|
+000000c0  c4 9f c1 ee ff 2b 6e 36  76 bc 01 5d f4 96 44 43  |.....+n6v..]..DC|
+000000d0  bb 90 04 ec 18 d6 0b 29  2d 1f 08 0b 02 0d cf 43  |.......)-......C|
+000000e0  7c a0 76 40 6d f0 eb 14  42 5a 9d df 29 35 1c 4f  ||.v@m...BZ..)5.O|
+000000f0  35 ef ad 60 18 16 51 97  2c 73 40 e5 74 1c 48 a7  |5..`..Q.,s@.t.H.|
+00000100  e5 4d 35 2c 1a 4c 35 f6  9a eb 0d d7 49 5f 04 06  |.M5,.L5.....I_..|
+00000110  da 56 8d f4 3b 3f 20 09  91 fd d3 51 31 65 05 f5  |.V..;? ....Q1e..|
+00000120  fa 85 4b 1b 3a 00 33 b0  96 28 d7 3b d7 92 d0 5c  |..K.:.3..(.;...\|
+00000130  04 13 4d d9 a5 02 19 19  13 1d 8a 9d f4 68 c0 98  |..M..........h..|
+00000140  2f f0 86 b2 6b 05 af af  65 a5 0d ab 8e af 74 dc  |/...k...e.....t.|
+00000150  a6 fa 41 0a 23 4b e6 1a  13 8d 96 01 9a 40 5b 09  |..A.#K.......@[.|
+00000160  3b 8f 70 ab 1f d6 8c 27  f6 3d bf 85 b0 f5 66 f7  |;.p....'.=....f.|
+00000170  ae 94 df ee 5f 75 47 19  e4 a1 a6 58 bf f2 8b 0e  |...._uG....X....|
+00000180  05 8a 3a 40 13 35 05 f1  7d 89 f6 6d 14 1c 5f 1c  |..:@.5..}..m.._.|
+00000190  e7 86 cc b5 83 52 55 9f  28 bf 56 54 96 91 92 7e  |.....RU.(.VT...~|
+000001a0  18 a6 21 8f e0 98 ee 6d  6b 19 53 0e f1 25 86 ec  |..!....mk.S..%..|
+000001b0  0e 5d 97 34 36 55 e3 a7  a8 5a 9f 43 8a ed ad c6  |.].46U...Z.C....|
+000001c0  cb 81 96 6f 9f 3b 2c db  24 4c 32 05 c0 8e d8 5a  |...o.;,.$L2....Z|
+000001d0  b3 87 33 b8 5c d8 57 6b  d0 94 7f 22 62 7c 15 d8  |..3.\.Wk..."b|..|
+000001e0  0f 05 b0 e7 04 85 94 5f  7b b2 25 e2 a2 46 c1 43  |......._{.%..F.C|
+000001f0  ac ef f7 c3 89 06 11 d6  c5 a9 0f 3d e0 7a fa 66  |...........=.z.f|
+00000200  31 44 1b a8 ff 2c 11 a7  1e 43 73 1d dd c4 a8 36  |1D...,...Cs....6|
+00000210  85 45 9e 34 46 78 ba 9a  9c 6a da 58 82 9a b0 2b  |.E.4Fx...j.X...+|
+00000220  6b 74 98 bb 6a 9d 2d 54  1b 80 09 01 13 85 60 8a  |kt..j.-T......`.|
+00000230  75 96 df 35 33 72 a4 d6  d3 6e 1a 0a 11 0a 0b b3  |u..53r...n......|
+00000240  5c 87 82 69 09 9d 22 a9  8b e4 b2 fb af 5c fd 82  |\..i.."......\..|
+00000250  32 30 f4 a8 ca a1 83 3e  8b 4d 3b 00 a6 63 7f c2  |20.....>.M;..c..|
+00000260  36 60 80 f2 b5 40 76 98  a6 f9 e8 49 04 62 c0 31  |6`...@v....I.b.1|
+00000270  06 da 4c a7 ff 6b 52 e2  7e af 22 b2 2c 84 df 8c  |..L..kR.~.".,...|
+00000280  d1 5e 7d 19 7b c7 9e da  14 e0 7e 9f 78 4a 0c bb  |.^}.{.....~.xJ..|
+00000290  77 28 3e 12 03 c3 59 91  2a b1 6c 7e 78 ce d6 ac  |w(>...Y.*.l~x...|
+000002a0  a0 57 06 20 d1 2b 74 59  20 e0 7f 4d 35 31 1a 3d  |.W. .+tY ..M51.=|
+000002b0  67 e9 1b 84 92 17 81 04  10 a4 5e 4d c2 00 ea 64  |g.........^M...d|
+000002c0  b9 fb 82 41 2e c0 66 68  2a 9e 1d 86 ee df f4 f9  |...A..fh*.......|
+000002d0  c5 6b d0 f6 07 61 93 22  31 a7 31 ee bc f3 c8 a7  |.k...a."1.1.....|
+000002e0  dc 21 ea eb 61 94 aa 6f  9a a2 0a 74 d9 db 39 48  |.!..a..o...t..9H|
+000002f0  21 8a f4 0a 6d f0 e7 07  16 03 03 00 bc 03 03 f8  |!...m...........|
+00000300  01 78 b0 ea 48 3d 57 b3  c7 69 62 74 ee 0e 92 a4  |.x..H=W..ibt....|
+00000310  d0 96 ed fe 94 2b 11 cd  d1 13 f7 e8 cc 61 0c 6e  |.....+.......a.n|
+00000320  8a 28 70 e1 c2 01 fe 19  66 eb 47 b3 e8 7b ff fc  |.(p.....f.G..{..|
+00000330  e6 c0 4e 5e 15 ae b6 14  04 64 33 d3 77 bc ce ea  |..N^.....d3.w...|
+00000340  47 4a 85 ef ff 16 79 33  1b 2e db 42 ab ee 7c 7f  |GJ....y3...B..|.|
+00000350  37 65 b5 ee 70 71 f1 7b  99 9b 63 c5 23 dd 7b 0c  |7e..pq.{..c.#.{.|
+00000360  ed 48 07 a4 d5 a2 63 5b  fd 99 01 f4 df b6 a7 95  |.H....c[........|
+00000370  23 a5 c0 00 e9 b4 2b f4  f8 3e 9b ca b3 34 ff e6  |#.....+..>...4..|
+00000380  5a 2f 0a 7a 55 81 77 3b  7a c5 66 e8 2c 4a 01 50  |Z/.zU.w;z.f.,J.P|
+00000390  13 13 79 8a b3 9f 9b 49  e9 e7 0a a7 d4 c9 7f 10  |..y....I........|
+000003a0  29 89 70 d9 83 5d 21 a9  40 7a 17 1f 6e 3d 4e 2a  |).p..]!.@z..n=N*|
+000003b0  48 e7 1c fa 07 2f 3f 5d  32 16 03 03 00 4a f9 74  |H..../?]2....J.t|
+000003c0  d5 eb 38 ef d8 bf 7a 69  2f b0 d3 e0 e1 57 d7 fc  |..8...zi/....W..|
+000003d0  01 57 2e e6 99 ba 0c 23  07 59 f3 75 28 1d 77 26  |.W.....#.Y.u(.w&|
+000003e0  2f 4d f4 f3 16 0a d6 2e  38 50 48 e3 a2 90 e1 0b  |/M......8PH.....|
+000003f0  78 99 35 81 d1 d9 4a 7b  47 a2 e1 95 39 f6 02 87  |x.5...J{G...9...|
+00000400  1f fe 4f 7e 2e ee 9a 17  16 03 03 00 14 98 8e a2  |..O~............|
+00000410  b6 b6 79 35 d1 fe b2 cb  90 ea 7c 91 5a 37 53 e4  |..y5......|.Z7S.|
+00000420  73                                                |s|
 >>> Flow 9 (client to server)
-00000000  16 03 03 02 69 c8 db 54  92 d3 ea 2f 24 47 f9 24  |....i..T.../$G.$|
-00000010  53 c1 d4 6a e8 dd 1d 71  d6 fb 2c 7e 3a 41 75 f6  |S..j...q..,~:Au.|
-00000020  0c 08 70 b6 f9 0a 12 4b  0d 3d 34 03 a9 36 9e f1  |..p....K.=4..6..|
-00000030  c7 93 dc 51 e4 15 3d fd  a7 67 28 24 32 fe ff d3  |...Q..=..g($2...|
-00000040  cd 69 d6 4a 5d 11 78 3b  aa 07 8d 1e c4 97 22 34  |.i.J].x;......"4|
-00000050  df 03 f2 37 fd 4f 76 c3  04 a6 a6 0f 35 1c 0f 13  |...7.Ov.....5...|
-00000060  7e 0a b9 5e 47 d2 9a 8c  d8 a3 f4 7a e4 92 5f 12  |~..^G......z.._.|
-00000070  a6 20 fb 51 16 af eb 55  d0 23 4e b5 f9 e8 cc 33  |. .Q...U.#N....3|
-00000080  bd d1 52 27 21 96 06 05  67 fa 68 0e ab 2c 84 05  |..R'!...g.h..,..|
-00000090  c9 97 6a db 69 57 a8 5c  55 a9 e1 cf 33 01 28 9a  |..j.iW.\U...3.(.|
-000000a0  76 09 64 a4 a3 31 36 13  72 27 0c 85 e9 59 47 27  |v.d..16.r'...YG'|
-000000b0  89 07 ee e2 e0 68 a6 f0  fa d5 c3 8b 2f 75 68 d0  |.....h....../uh.|
-000000c0  8e d8 fe ae 1d 0d af 0b  40 3d 9f ec 85 03 24 20  |........@=....$ |
-000000d0  c5 11 30 aa 25 ee 2c 86  42 ae 4f 0d 6b 18 70 1d  |..0.%.,.B.O.k.p.|
-000000e0  5f ae 1e cf 99 a7 0e c8  9b b3 63 58 cd b6 7d be  |_.........cX..}.|
-000000f0  01 43 96 37 87 45 5f 2f  aa 9c 12 48 ef 3b c8 d9  |.C.7.E_/...H.;..|
-00000100  60 20 26 69 68 56 48 aa  64 59 9e 41 ed 7e 8d c3  |` &ihVH.dY.A.~..|
-00000110  0f cd 0e 19 7a 76 89 95  f8 20 68 cd f9 81 e9 a0  |....zv... h.....|
-00000120  21 ff 60 e5 0f 6d dd 73  d2 19 1e 2a 76 f7 9a 46  |!.`..m.s...*v..F|
-00000130  5d d5 6b b2 19 28 c2 ac  9c e0 35 c8 d2 2a 53 fa  |].k..(....5..*S.|
-00000140  3e 58 9e f2 05 7e 6b ce  51 6d 3d 2a ce 2e 9b 59  |>X...~k.Qm=*...Y|
-00000150  aa d4 8d cc ad 1f 82 e7  ca 5a ef a6 87 d5 41 0b  |.........Z....A.|
-00000160  8d 27 6d 09 4d 40 c3 26  a3 a9 91 dd 1b 37 5d ff  |.'m.M@.&.....7].|
-00000170  8f c3 c7 b1 bf be f5 d1  19 4d 93 86 a7 5f 5e 8f  |.........M..._^.|
-00000180  14 34 82 50 76 25 42 04  b8 4b d3 da 15 ee 60 d1  |.4.Pv%B..K....`.|
-00000190  35 56 4c 63 0d ba 64 13  4f 3d 12 87 84 5a 45 41  |5VLc..d.O=...ZEA|
-000001a0  14 b6 6f 91 c4 b9 4f 97  c1 10 d6 3e b3 99 21 18  |..o...O....>..!.|
-000001b0  c3 91 82 e4 b6 91 3e bb  01 89 9a f0 60 ac 8e 7d  |......>.....`..}|
-000001c0  cf c2 f9 b4 4f da 40 e3  5e 83 a1 8f b4 fa 28 aa  |....O.@.^.....(.|
-000001d0  c9 ae 7b 8f 7d c9 d1 f8  7b b2 b5 3f 0a 9b 00 9e  |..{.}...{..?....|
-000001e0  1d fa 59 ff 39 b7 85 4d  2a b9 b8 67 03 df a0 f9  |..Y.9..M*..g....|
-000001f0  f1 7e 9d 27 1c 55 a9 76  44 9e f1 13 78 7d 34 4d  |.~.'.U.vD...x}4M|
-00000200  c9 23 07 e6 db 93 d7 70  3c 1b 5d 89 ed 8d 3d 43  |.#.....p<.]...=C|
-00000210  2e 89 f6 14 83 ff 87 db  26 a5 9a cd 98 5d 32 24  |........&....]2$|
-00000220  70 d2 e0 72 a7 6f a4 b4  2b 37 db 7e 39 4f d7 37  |p..r.o..+7.~9O.7|
-00000230  ea 68 b5 98 33 0e 23 21  3f 43 b3 ff 18 8e df 85  |.h..3.#!?C......|
-00000240  ba 15 48 3a fe 09 9b b6  27 40 d4 60 a8 3e 55 a3  |..H:....'@.`.>U.|
-00000250  75 c9 32 38 b5 21 46 ab  41 99 24 e6 09 3f 64 e6  |u.28.!F.A.$..?d.|
-00000260  09 40 cb 93 25 ab 1a 90  c7 d5 a6 40 36 a0 16 03  |.@..%......@6...|
-00000270  03 00 35 0f c7 e4 c3 16  c0 4f 7f 25 04 06 63 e7  |..5......O.%..c.|
-00000280  79 79 f9 4f c9 66 ca cd  ba e3 af 4a 50 a3 3d c3  |yy.O.f.....JP.=.|
-00000290  79 0c 71 d9 2f df 93 79  30 8f 6b 0f 54 f9 be 07  |y.q./..y0.k.T...|
-000002a0  f3 d6 9b c0 2a 3a 0a a1  16 03 03 00 98 b8 f1 fc  |....*:..........|
-000002b0  87 62 e9 6b 40 fd 50 ac  b7 fa 52 69 51 66 ae 9b  |.b.k@.P...RiQf..|
-000002c0  05 7e f2 38 73 27 d8 0c  2a 53 37 30 62 76 5d e9  |.~.8s'..*S70bv].|
-000002d0  fd 95 c6 14 d2 9d 34 13  e9 4c a5 7c c0 b6 e0 c4  |......4..L.|....|
-000002e0  97 ef 01 c0 f9 38 39 ee  17 c0 20 01 76 4f a7 10  |.....89... .vO..|
-000002f0  b0 45 9d c7 c3 cd a9 47  14 4a ed 00 1f 06 70 5b  |.E.....G.J....p[|
-00000300  f5 04 8b 77 ad af 1e 77  7a 9d cc fc a4 1f d2 8d  |...w...wz.......|
-00000310  8f e3 31 d3 3c de e6 85  f3 3d c0 ae 78 f7 22 c6  |..1.<....=..x.".|
-00000320  ec 2e a2 f0 5f ed 95 33  54 8c 89 35 c9 e4 25 4b  |...._..3T..5..%K|
-00000330  84 5e 31 83 04 d0 f1 67  69 73 8b 7f 24 ae e0 87  |.^1....gis..$...|
-00000340  6b f7 ba f0 23 14 03 03  00 11 7a c7 6a 32 2b 9b  |k...#.....z.j2+.|
-00000350  25 c2 d2 ee 37 b2 8d 7b  f2 90 6d 16 03 03 00 20  |%...7..{..m.... |
-00000360  c1 1c 9d 18 a9 41 92 fc  05 19 93 7c 7e 2f b2 39  |.....A.....|~/.9|
-00000370  8c 76 4b 29 5a 67 cc f5  55 9f c0 e3 8f ad ee 3c  |.vK)Zg..U......<|
+00000000  16 03 03 02 69 ad fd 5e  51 7c 1a 62 01 a3 c7 84  |....i..^Q|.b....|
+00000010  d6 d8 2d 47 2b 00 d5 d4  7c e6 16 94 7e 32 74 85  |..-G+...|...~2t.|
+00000020  ce 13 d9 af d7 27 77 86  43 77 1b ca 68 f5 1f da  |.....'w.Cw..h...|
+00000030  20 d8 61 29 b0 11 3d 40  66 62 a0 82 ff 38 85 07  | .a)..=@fb...8..|
+00000040  52 fc 59 92 44 c4 ea 12  70 62 cd 05 66 0a b4 cb  |R.Y.D...pb..f...|
+00000050  38 23 f4 35 58 a0 4c 1e  bc 1a 5a 6a be ad 81 c9  |8#.5X.L...Zj....|
+00000060  22 97 dc 7d 77 76 da e8  b5 30 be d3 28 be b2 30  |"..}wv...0..(..0|
+00000070  05 52 8f 41 d3 a1 78 68  9b 76 ad 29 42 ec 90 c5  |.R.A..xh.v.)B...|
+00000080  61 f2 aa f2 f0 fb dd 08  42 f3 5a a8 3c 8d f9 98  |a.......B.Z.<...|
+00000090  90 00 2e e1 aa 7c ac 3f  cf 34 9d ed 56 09 30 d3  |.....|.?.4..V.0.|
+000000a0  1b 03 9e fb 0c 16 4c 99  0f 86 a9 03 44 ce 8b 66  |......L.....D..f|
+000000b0  a6 42 bb 0b dc a4 82 47  7d fc 09 48 1d 47 85 da  |.B.....G}..H.G..|
+000000c0  3f 30 d1 94 36 a0 ac 44  72 2f a4 cc 5a fd 6c 96  |?0..6..Dr/..Z.l.|
+000000d0  05 14 0c 25 5c 19 44 1e  c2 40 12 57 be 30 1d bb  |...%\.D..@.W.0..|
+000000e0  62 f4 2c c2 f1 46 83 1b  ad bd f4 e0 ff b2 de 62  |b.,..F.........b|
+000000f0  85 04 61 3d 61 67 aa d1  f7 ba db 6f 80 75 1e 9c  |..a=ag.....o.u..|
+00000100  70 42 ff 6f 35 83 32 34  fc 12 08 e5 44 92 cb 99  |pB.o5.24....D...|
+00000110  a5 d0 ef c3 f2 9e b2 86  ff c1 e5 87 01 bf d1 7a  |...............z|
+00000120  d9 57 ef 21 cf c9 fd 5f  30 6c 54 7c ac 95 54 72  |.W.!..._0lT|..Tr|
+00000130  3d 46 88 4d 9f 8e a8 75  81 a0 81 50 11 1e f7 92  |=F.M...u...P....|
+00000140  f5 a2 5d 49 5a f8 c1 b8  06 f3 6f 99 64 77 ee fe  |..]IZ.....o.dw..|
+00000150  40 fe 94 51 67 db e1 a0  d7 a4 09 cc 52 9c 1b 27  |@..Qg.......R..'|
+00000160  5b 45 4a 71 ff 60 aa 52  56 07 f6 4e ad 23 b8 2c  |[EJq.`.RV..N.#.,|
+00000170  87 d3 2b 04 56 21 ed 51  ce 81 59 ae 3d a7 1b f5  |..+.V!.Q..Y.=...|
+00000180  75 3f 8a 83 c3 ee e9 76  94 dd 48 c4 d1 69 2f af  |u?.....v..H..i/.|
+00000190  b1 f9 2f db 72 ef da 33  6b 87 78 64 24 3a 42 46  |../.r..3k.xd$:BF|
+000001a0  e0 ed 91 60 89 dd 5a 9e  9b 93 4a 0e a3 30 32 4d  |...`..Z...J..02M|
+000001b0  0e 5f c6 49 26 49 18 73  8d 2d 73 d5 4c 49 3f df  |._.I&I.s.-s.LI?.|
+000001c0  d9 55 b7 11 7e 24 1b d6  cb 71 68 ba 6c c7 72 b2  |.U..~$...qh.l.r.|
+000001d0  2e aa 39 89 ac 1b 96 a3  78 11 4d 37 ba 25 88 43  |..9.....x.M7.%.C|
+000001e0  d2 8a 55 28 99 b3 f0 59  d5 92 cc 94 51 e2 f2 18  |..U(...Y....Q...|
+000001f0  3b d1 1a 9b a6 ee f1 b1  91 62 6b a0 da 75 f6 69  |;........bk..u.i|
+00000200  23 56 22 29 dd d0 63 05  be a9 f7 38 fc 0d a2 64  |#V")..c....8...d|
+00000210  e4 09 2c d5 5f ca ee 91  81 91 d1 ee 62 04 e9 ce  |..,._.......b...|
+00000220  5f 49 8e 70 cf fd 5a b5  cf c1 e5 ae 53 3e 16 d0  |_I.p..Z.....S>..|
+00000230  f0 49 9b 61 32 14 38 27  b5 c9 93 13 be e4 5a f0  |.I.a2.8'......Z.|
+00000240  10 5f 7c 14 11 68 70 4d  6d 02 9f 51 51 94 e0 0e  |._|..hpMm..QQ...|
+00000250  04 a2 ae 6c 3c f0 94 11  9c 66 58 b3 a2 e8 04 f1  |...l<....fX.....|
+00000260  01 b7 88 0d 74 cf 8a 63  f8 e6 c4 bb 10 bb 16 03  |....t..c........|
+00000270  03 00 35 7b 36 f4 cf b3  8a 4a 7c 7e fc 7a 6d ae  |..5{6....J|~.zm.|
+00000280  5e fe 3b c5 e1 16 44 ab  72 0a 07 10 69 e1 11 db  |^.;...D.r...i...|
+00000290  6d 86 f9 43 d0 87 82 3a  28 83 b4 15 76 76 2a f9  |m..C...:(...vv*.|
+000002a0  52 80 7f 2f c2 52 e1 2c  16 03 03 00 98 e8 a2 d5  |R../.R.,........|
+000002b0  d6 57 15 7c 33 27 e2 29  d4 82 7b fd 2d c3 00 db  |.W.|3'.)..{.-...|
+000002c0  83 90 44 4b 3a be 01 4d  d7 76 a5 03 cf ec 60 b5  |..DK:..M.v....`.|
+000002d0  93 ba 4d 4d 74 30 a3 bb  47 3b a2 94 98 1e e9 b8  |..MMt0..G;......|
+000002e0  d2 99 55 05 c7 59 cb e4  55 3e c0 c9 8c 90 40 91  |..U..Y..U>....@.|
+000002f0  2e c0 64 f2 6e 09 96 7c  b6 0a e0 ad fd a2 7a c4  |..d.n..|......z.|
+00000300  b0 e6 0f 40 2a e5 37 fa  72 f3 89 1c 78 47 ca c7  |...@*.7.r...xG..|
+00000310  e5 83 7b 1f a6 e5 39 32  c6 94 1e e4 7a 51 d9 36  |..{...92....zQ.6|
+00000320  67 d9 b3 78 58 f9 ae 65  60 ee 41 c8 81 8a 04 49  |g..xX..e`.A....I|
+00000330  35 2a d8 22 b3 8b 64 49  13 a0 36 e0 37 68 ea b7  |5*."..dI..6.7h..|
+00000340  99 9e 1f e1 ea 14 03 03  00 11 b9 18 a2 5e 19 5f  |.............^._|
+00000350  77 58 6c a3 e9 97 4b 34  5e ff ff 16 03 03 00 20  |wXl...K4^...... |
+00000360  71 d4 9f 5a 6f fa e4 28  bb f1 9d e5 0b c3 da 4b  |q..Zo..(.......K|
+00000370  ef a3 78 28 c5 e3 43 ff  f7 5c a1 94 57 0d ee 41  |..x(..C..\..W..A|
 >>> Flow 10 (server to client)
-00000000  14 03 03 00 11 49 66 13  ec 09 83 0d 47 82 45 61  |.....If.....G.Ea|
-00000010  06 14 cc f5 da 41 16 03  03 00 20 34 d4 0c bd 86  |.....A.... 4....|
-00000020  6d ef a9 b6 97 68 e6 88  84 ed 1c 9d a1 8d 2b c9  |m....h........+.|
-00000030  2f 45 75 5b e5 6a 08 72  71 a9 c6 17 03 03 00 19  |/Eu[.j.rq.......|
-00000040  e8 83 4c f5 19 ea d1 ef  e3 27 25 f9 af d2 f0 a6  |..L......'%.....|
-00000050  b3 62 15 66 ec 72 ce 4e  e2                       |.b.f.r.N.|
+00000000  14 03 03 00 11 ed 11 8d  d8 09 71 3a d8 53 25 f9  |..........q:.S%.|
+00000010  a9 2f 70 b9 21 fb 16 03  03 00 20 14 a7 ba 54 0e  |./p.!..... ...T.|
+00000020  5c a9 53 ab d4 d6 c0 3f  10 6b 2d 84 8d 66 e5 04  |\.S....?.k-..f..|
+00000030  96 f9 a9 18 1d f8 c1 76  49 18 35 17 03 03 00 19  |.......vI.5.....|
+00000040  5e b0 d2 83 83 7d 35 ac  e5 74 9a 68 b5 d8 4d 32  |^....}5..t.h..M2|
+00000050  a1 d0 bf 8d 8f 1a 2f f7  33                       |....../.3|
 >>> Flow 11 (client to server)
-00000000  15 03 03 00 12 2e 39 ba  ca ad 7c a9 ae 3f 6a 78  |......9...|..?jx|
-00000010  b6 31 d2 d0 4e 1f dc                              |.1..N..|
+00000000  15 03 03 00 12 3d 6c 11  84 f3 af 5e 9b ee c3 56  |.....=l....^...V|
+00000010  96 c1 78 a9 12 31 ba                              |..x..1.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice
index 20aa6c9fcf..ff6da0aeb2 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwice
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,337 +7,340 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 68 39 1d 0e 5a  |....Y...U..h9..Z|
-00000010  22 ba 13 5f b6 c1 52 5d  13 e5 07 18 aa ec 24 0f  |".._..R]......$.|
-00000020  c9 56 3a 83 a1 32 a1 7f  02 e8 7b 20 31 e2 f8 c4  |.V:..2....{ 1...|
-00000030  5b c2 57 9a 1d a4 6f a7  9c 1c 93 b1 9f 19 c3 cb  |[.W...o.........|
-00000040  e1 73 87 1b a8 88 d9 4c  67 2f 44 aa cc a8 00 00  |.s.....Lg/D.....|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
-00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
-00000080  3f e2 5b ea a6 30 0d 06  09 2a 86 48 86 f7 0d 01  |?.[..0...*.H....|
-00000090  01 0b 05 00 30 1f 31 0b  30 09 06 03 55 04 0a 13  |....0.1.0...U...|
-000000a0  02 47 6f 31 10 30 0e 06  03 55 04 03 13 07 47 6f  |.Go1.0...U....Go|
-000000b0  20 52 6f 6f 74 30 1e 17  0d 31 36 30 31 30 31 30  | Root0...1601010|
-000000c0  30 30 30 30 30 5a 17 0d  32 35 30 31 30 31 30 30  |00000Z..25010100|
-000000d0  30 30 30 30 5a 30 1a 31  0b 30 09 06 03 55 04 0a  |0000Z0.1.0...U..|
-000000e0  13 02 47 6f 31 0b 30 09  06 03 55 04 03 13 02 47  |..Go1.0...U....G|
-000000f0  6f 30 81 9f 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |o0..0...*.H.....|
-00000100  01 05 00 03 81 8d 00 30  81 89 02 81 81 00 db 46  |.......0.......F|
-00000110  7d 93 2e 12 27 06 48 bc  06 28 21 ab 7e c4 b6 a2  |}...'.H..(!.~...|
-00000120  5d fe 1e 52 45 88 7a 36  47 a5 08 0d 92 42 5b c2  |]..RE.z6G....B[.|
-00000130  81 c0 be 97 79 98 40 fb  4f 6d 14 fd 2b 13 8b c2  |....y.@.Om..+...|
-00000140  a5 2e 67 d8 d4 09 9e d6  22 38 b7 4a 0b 74 73 2b  |..g....."8.J.ts+|
-00000150  c2 34 f1 d1 93 e5 96 d9  74 7b f3 58 9f 6c 61 3c  |.4......t{.X.la<|
-00000160  c0 b0 41 d4 d9 2b 2b 24  23 77 5b 1c 3b bd 75 5d  |..A..++$#w[.;.u]|
-00000170  ce 20 54 cf a1 63 87 1d  1e 24 c4 f3 1d 1a 50 8b  |. T..c...$....P.|
-00000180  aa b6 14 43 ed 97 a7 75  62 f4 14 c8 52 d7 02 03  |...C...ub...R...|
-00000190  01 00 01 a3 81 93 30 81  90 30 0e 06 03 55 1d 0f  |......0..0...U..|
-000001a0  01 01 ff 04 04 03 02 05  a0 30 1d 06 03 55 1d 25  |.........0...U.%|
-000001b0  04 16 30 14 06 08 2b 06  01 05 05 07 03 01 06 08  |..0...+.........|
-000001c0  2b 06 01 05 05 07 03 02  30 0c 06 03 55 1d 13 01  |+.......0...U...|
-000001d0  01 ff 04 02 30 00 30 19  06 03 55 1d 0e 04 12 04  |....0.0...U.....|
-000001e0  10 9f 91 16 1f 43 43 3e  49 a6 de 6d b6 80 d7 9f  |.....CC>I..m....|
-000001f0  60 30 1b 06 03 55 1d 23  04 14 30 12 80 10 48 13  |`0...U.#..0...H.|
-00000200  49 4d 13 7e 16 31 bb a3  01 d5 ac ab 6e 7b 30 19  |IM.~.1......n{0.|
-00000210  06 03 55 1d 11 04 12 30  10 82 0e 65 78 61 6d 70  |..U....0...examp|
-00000220  6c 65 2e 67 6f 6c 61 6e  67 30 0d 06 09 2a 86 48  |le.golang0...*.H|
-00000230  86 f7 0d 01 01 0b 05 00  03 81 81 00 9d 30 cc 40  |.............0.@|
-00000240  2b 5b 50 a0 61 cb ba e5  53 58 e1 ed 83 28 a9 58  |+[P.a...SX...(.X|
-00000250  1a a9 38 a4 95 a1 ac 31  5a 1a 84 66 3d 43 d3 2d  |..8....1Z..f=C.-|
-00000260  d9 0b f2 97 df d3 20 64  38 92 24 3a 00 bc cf 9c  |...... d8.$:....|
-00000270  7d b7 40 20 01 5f aa d3  16 61 09 a2 76 fd 13 c3  |}.@ ._...a..v...|
-00000280  cc e1 0c 5c ee b1 87 82  f1 6c 04 ed 73 bb b3 43  |...\.....l..s..C|
-00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
-000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
-000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 57 22 18 98 ed 7f 12  |........ W".....|
-000002d0  e7 e3 83 6b 42 82 ff 49  54 f8 0b 7d 93 3d 11 42  |...kB..IT..}.=.B|
-000002e0  67 cf 89 47 77 31 c5 59  4a 08 04 00 80 69 d4 13  |g..Gw1.YJ....i..|
-000002f0  f8 1c 68 9d 40 10 c8 aa  e6 44 0e 14 b9 38 6e ca  |..h.@....D...8n.|
-00000300  a9 50 05 4a ce a0 03 ea  02 92 e4 5a ed 42 6f 70  |.P.J.......Z.Bop|
-00000310  e1 c1 99 49 a4 34 20 6b  5e 14 e8 a1 d3 27 ff 0d  |...I.4 k^....'..|
-00000320  0c d7 47 49 1e 8f 8a 3a  62 1d c9 81 3c 5f a3 16  |..GI...:b...<_..|
-00000330  16 34 a0 53 a7 01 1d 09  f7 d9 d4 62 b2 0a 1c 1f  |.4.S.......b....|
-00000340  b2 e5 24 1b 7e 78 35 43  ed 47 f8 62 53 2d 04 ec  |..$.~x5C.G.bS-..|
-00000350  81 b5 68 11 3a 2d ee 88  ef 86 eb 71 d0 5e 31 42  |..h.:-.....q.^1B|
-00000360  57 6d b6 f2 be 32 4c 38  f8 2a 93 2f db 16 03 03  |Wm...2L8.*./....|
-00000370  00 04 0e 00 00 00                                 |......|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 bc 20 d6 8b 64  |....]...Y... ..d|
+00000010  c1 9f de ba 8e c1 6f 37  b8 5c 82 c3 1b 5e 11 3d  |......o7.\...^.=|
+00000020  ac 5d 16 4b 40 96 d6 ae  29 74 91 20 65 7d d0 51  |.].K@...)t. e}.Q|
+00000030  d8 a2 2d c6 db 53 f6 04  16 dd 70 4a bd 44 a4 b6  |..-..S....pJ.D..|
+00000040  ef e0 f0 d3 ec 6a 31 18  91 df 09 90 cc a8 00 00  |.....j1.........|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
+00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
+00000080  00 e8 f0 9d 3f e2 5b ea  a6 30 0d 06 09 2a 86 48  |....?.[..0...*.H|
+00000090  86 f7 0d 01 01 0b 05 00  30 1f 31 0b 30 09 06 03  |........0.1.0...|
+000000a0  55 04 0a 13 02 47 6f 31  10 30 0e 06 03 55 04 03  |U....Go1.0...U..|
+000000b0  13 07 47 6f 20 52 6f 6f  74 30 1e 17 0d 31 36 30  |..Go Root0...160|
+000000c0  31 30 31 30 30 30 30 30  30 5a 17 0d 32 35 30 31  |101000000Z..2501|
+000000d0  30 31 30 30 30 30 30 30  5a 30 1a 31 0b 30 09 06  |01000000Z0.1.0..|
+000000e0  03 55 04 0a 13 02 47 6f  31 0b 30 09 06 03 55 04  |.U....Go1.0...U.|
+000000f0  03 13 02 47 6f 30 81 9f  30 0d 06 09 2a 86 48 86  |...Go0..0...*.H.|
+00000100  f7 0d 01 01 01 05 00 03  81 8d 00 30 81 89 02 81  |...........0....|
+00000110  81 00 db 46 7d 93 2e 12  27 06 48 bc 06 28 21 ab  |...F}...'.H..(!.|
+00000120  7e c4 b6 a2 5d fe 1e 52  45 88 7a 36 47 a5 08 0d  |~...]..RE.z6G...|
+00000130  92 42 5b c2 81 c0 be 97  79 98 40 fb 4f 6d 14 fd  |.B[.....y.@.Om..|
+00000140  2b 13 8b c2 a5 2e 67 d8  d4 09 9e d6 22 38 b7 4a  |+.....g....."8.J|
+00000150  0b 74 73 2b c2 34 f1 d1  93 e5 96 d9 74 7b f3 58  |.ts+.4......t{.X|
+00000160  9f 6c 61 3c c0 b0 41 d4  d9 2b 2b 24 23 77 5b 1c  |.la<..A..++$#w[.|
+00000170  3b bd 75 5d ce 20 54 cf  a1 63 87 1d 1e 24 c4 f3  |;.u]. T..c...$..|
+00000180  1d 1a 50 8b aa b6 14 43  ed 97 a7 75 62 f4 14 c8  |..P....C...ub...|
+00000190  52 d7 02 03 01 00 01 a3  81 93 30 81 90 30 0e 06  |R.........0..0..|
+000001a0  03 55 1d 0f 01 01 ff 04  04 03 02 05 a0 30 1d 06  |.U...........0..|
+000001b0  03 55 1d 25 04 16 30 14  06 08 2b 06 01 05 05 07  |.U.%..0...+.....|
+000001c0  03 01 06 08 2b 06 01 05  05 07 03 02 30 0c 06 03  |....+.......0...|
+000001d0  55 1d 13 01 01 ff 04 02  30 00 30 19 06 03 55 1d  |U.......0.0...U.|
+000001e0  0e 04 12 04 10 9f 91 16  1f 43 43 3e 49 a6 de 6d  |.........CC>I..m|
+000001f0  b6 80 d7 9f 60 30 1b 06  03 55 1d 23 04 14 30 12  |....`0...U.#..0.|
+00000200  80 10 48 13 49 4d 13 7e  16 31 bb a3 01 d5 ac ab  |..H.IM.~.1......|
+00000210  6e 7b 30 19 06 03 55 1d  11 04 12 30 10 82 0e 65  |n{0...U....0...e|
+00000220  78 61 6d 70 6c 65 2e 67  6f 6c 61 6e 67 30 0d 06  |xample.golang0..|
+00000230  09 2a 86 48 86 f7 0d 01  01 0b 05 00 03 81 81 00  |.*.H............|
+00000240  9d 30 cc 40 2b 5b 50 a0  61 cb ba e5 53 58 e1 ed  |.0.@+[P.a...SX..|
+00000250  83 28 a9 58 1a a9 38 a4  95 a1 ac 31 5a 1a 84 66  |.(.X..8....1Z..f|
+00000260  3d 43 d3 2d d9 0b f2 97  df d3 20 64 38 92 24 3a  |=C.-...... d8.$:|
+00000270  00 bc cf 9c 7d b7 40 20  01 5f aa d3 16 61 09 a2  |....}.@ ._...a..|
+00000280  76 fd 13 c3 cc e1 0c 5c  ee b1 87 82 f1 6c 04 ed  |v......\.....l..|
+00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
+000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
+000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 71 9d 55  |............ q.U|
+000002d0  00 99 f1 f9 90 c2 8f 82  27 d7 5c 0e 96 97 a9 f7  |........'.\.....|
+000002e0  be ab c4 76 41 9b 86 86  43 d7 43 78 0c 08 04 00  |...vA...C.Cx....|
+000002f0  80 96 cb 93 b2 0c 1e e3  92 b1 4e 28 30 48 85 09  |..........N(0H..|
+00000300  c1 cf 73 66 7b 3b 3d 7d  83 c2 a3 2a 93 14 58 c0  |..sf{;=}...*..X.|
+00000310  1c 6c 7c 92 9c 3f 8b 80  d1 c4 54 d8 2b 65 38 35  |.l|..?....T.+e85|
+00000320  08 a6 d2 ec 4e 84 e7 49  78 13 3f 2a 41 60 1d ea  |....N..Ix.?*A`..|
+00000330  09 c8 30 37 35 88 b3 eb  5c ad 16 46 19 5f f1 62  |..075...\..F._.b|
+00000340  8b 49 8a 9a 47 87 a4 14  d3 17 e1 d5 79 0e 9f c4  |.I..G.......y...|
+00000350  4e db 6f 38 8e 77 ec 37  74 e8 20 01 54 75 e1 8e  |N.o8.w.7t. .Tu..|
+00000360  5c d1 19 51 d8 c8 89 6c  27 01 54 ca 18 dd d9 2e  |\..Q...l'.T.....|
+00000370  8f 16 03 03 00 04 0e 00  00 00                    |..........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 2a 03 0a  58 36 31 ec 26 df e5 7c  |.... *..X61.&..||
-00000040  88 b5 d1 f7 6d fc 4b 0a  91 54 4a e7 8c 83 a3 54  |....m.K..TJ....T|
-00000050  0a 10 5b ff 69                                    |..[.i|
+00000030  16 03 03 00 20 46 e6 c1  9e c0 cc 46 24 6e 0c 6c  |.... F.....F$n.l|
+00000040  1b c5 7d b4 dc a1 b5 d4  bf db 32 69 12 8a 89 ea  |..}.......2i....|
+00000050  c1 bf 26 b8 ee                                    |..&..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 27 b0 69 0c 67  |.......... '.i.g|
-00000010  c7 3a ec c1 aa 02 20 cf  f9 e8 22 86 3b d3 e1 4f  |.:.... ...".;..O|
-00000020  bc fd 04 40 19 77 bf bd  38 28 56                 |...@.w..8(V|
+00000000  14 03 03 00 01 01 16 03  03 00 20 08 9b ed a2 75  |.......... ....u|
+00000010  a9 2d 92 f7 dc e1 93 7a  3d c3 75 33 a8 43 17 2b  |.-.....z=.u3.C.+|
+00000020  50 71 58 d7 40 2a ea 1b  0a 3b 0b                 |PqX.@*...;.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 8a 2c 24  1b b8 53 01 54 c8 bd f3  |......,$..S.T...|
-00000010  e1 ec a9 ab 83 a0 66 a9  29 1c 4e                 |......f.).N|
+00000000  17 03 03 00 16 7e a3 48  7f 20 07 19 31 8b d2 18  |.....~.H. ..1...|
+00000010  81 1d 4a a1 db 72 4a 88  2d ee 18                 |..J..rJ.-..|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 14 c5 e3 03  06 89 d8 47 1a 66 18 0e  |...........G.f..|
-00000010  8d 36 c5 f4 30 80 7e 72  a2                       |.6..0.~r.|
+00000000  16 03 03 00 14 b4 c3 67  a8 fc 66 ad 48 f9 3f 6b  |.......g..f.H.?k|
+00000010  97 4b 55 f8 4d 92 a1 2e  d8                       |.KU.M....|
 >>> Flow 7 (client to server)
-00000000  16 03 03 01 16 7e eb a3  b5 ea 58 e3 4a 26 35 7d  |.....~....X.J&5}|
-00000010  54 15 93 74 e8 e4 63 34  38 d9 e0 02 3d 28 f8 98  |T..t..c48...=(..|
-00000020  0f 24 6b ca 08 7f b6 77  68 ec 85 c3 4a 6b 69 c3  |.$k....wh...Jki.|
-00000030  8d 8e 1b 8b 41 11 9b 0d  d1 c8 99 2b c9 d2 4c f1  |....A......+..L.|
-00000040  fd 82 e5 35 ba a3 3b f3  6d 47 82 45 08 e7 02 bb  |...5..;.mG.E....|
-00000050  10 a6 7b 76 83 78 e0 aa  5a 78 24 59 1c db ae a3  |..{v.x..Zx$Y....|
-00000060  37 20 b3 12 98 48 68 d3  b3 72 9f 4f d4 de 50 b4  |7 ...Hh..r.O..P.|
-00000070  4a c1 37 93 e0 55 ae e8  37 2a 40 de ac 30 e1 1d  |J.7..U..7*@..0..|
-00000080  f0 03 19 8c af 77 f5 26  98 af a8 a8 d2 72 6c 68  |.....w.&.....rlh|
-00000090  75 00 32 10 e6 3f 91 a8  24 a7 d8 05 23 04 52 23  |u.2..?..$...#.R#|
-000000a0  e7 e6 83 ac 37 1b 36 a7  ca d4 7e d5 21 4c ab 38  |....7.6...~.!L.8|
-000000b0  23 cb 7c a9 f4 66 26 5e  7f 3e d6 ab 7a ac 34 38  |#.|..f&^.>..z.48|
-000000c0  95 16 df e2 e4 cf 3a 62  82 78 cb 71 32 06 6d 07  |......:b.x.q2.m.|
-000000d0  84 91 0c e9 d0 63 88 9e  d1 b5 f0 fb 43 2b 07 0b  |.....c......C+..|
-000000e0  32 d7 20 af b8 76 17 da  ee cc e6 03 bb 7a 0b f2  |2. ..v.......z..|
-000000f0  61 4f db 7f a3 66 b0 05  a8 88 b8 0b b3 6e 9c df  |aO...f.......n..|
-00000100  48 8b 7e eb 42 cd ea eb  1d bb 63 a0 e4 ee df 21  |H.~.B.....c....!|
-00000110  20 67 11 26 dd f1 47 1b  15 2b a0                 | g.&..G..+.|
+00000000  16 03 03 01 1a 57 92 7f  92 07 a2 88 ca ea e3 5d  |.....W.........]|
+00000010  38 79 fd 42 41 5b 73 e5  52 34 c3 f5 10 67 3d 0b  |8y.BA[s.R4...g=.|
+00000020  42 58 50 d7 f1 da 6b a6  4f 6a 89 2b f7 3c 4d a0  |BXP...k.Oj.+.<M.|
+00000030  db 8c c0 1e 30 08 15 fe  9e 9f 97 80 df 7c a4 ce  |....0........|..|
+00000040  3f ab 9d 9c 05 12 e6 75  2a 3e c4 d8 f4 01 06 c9  |?......u*>......|
+00000050  48 06 3b 1e df 97 26 e9  59 34 59 c8 e3 05 0b 22  |H.;...&.Y4Y...."|
+00000060  d1 66 0e 42 ac e0 4a e1  89 c3 80 ae ee 32 65 93  |.f.B..J......2e.|
+00000070  09 6b 1f bc 03 4d 0d 85  bc e8 46 12 09 0b 0c 44  |.k...M....F....D|
+00000080  20 a0 26 12 70 80 45 9c  ba c2 9d 6a 7a ec bb 92  | .&.p.E....jz...|
+00000090  c5 b3 49 2e 18 99 e8 19  a8 37 9d e2 28 c8 69 19  |..I......7..(.i.|
+000000a0  ed 12 a6 f2 e7 84 a3 7f  7e 49 74 34 67 66 1f fc  |........~It4gf..|
+000000b0  02 58 0d 8e 6c ec 1c 14  8c 2a 74 b8 f2 b1 8e 6a  |.X..l....*t....j|
+000000c0  5f 4d 76 13 d6 7f cf c3  2d 85 18 9b 04 87 d9 9a  |_Mv.....-.......|
+000000d0  db 8f 09 ce 3f 47 55 fc  e9 bf 6c cb 42 bf d4 c4  |....?GU...l.B...|
+000000e0  76 91 3e d6 d8 32 4e fe  24 39 1b 66 38 83 32 7f  |v.>..2N.$9.f8.2.|
+000000f0  ee 84 d3 13 39 73 bb 41  a2 d4 ef a7 1c aa cb e3  |....9s.A........|
+00000100  c2 25 6a a3 f2 fb 6f 94  eb 9d 08 1b 4e 6b 09 8a  |.%j...o.....Nk..|
+00000110  00 0a e3 1b e1 57 7b 58  14 d1 0a 1d 11 7a e0     |.....W{X.....z.|
 >>> Flow 8 (server to client)
-00000000  16 03 03 00 81 60 70 d6  32 5a 0a 8f df ed cd f2  |.....`p.2Z......|
-00000010  d7 bf d0 da fd 53 63 65  bf f5 26 83 0c f5 6e e9  |.....Sce..&...n.|
-00000020  78 9b 03 7b 17 5f f4 d2  af 2a a3 85 13 92 be 00  |x..{._...*......|
-00000030  93 3f b3 f1 cb 04 aa 55  f8 ed c8 e6 9c 32 08 79  |.?.....U.....2.y|
-00000040  86 84 ef ac 72 bd 93 07  9c ca d2 e7 74 dd 51 a0  |....r.......t.Q.|
-00000050  6d 0e d3 32 3c 33 9d 58  aa 46 a9 ff 22 08 bc 2c  |m..2<3.X.F.."..,|
-00000060  de 81 aa a8 5a 3c f8 36  93 d3 12 06 79 61 1f 71  |....Z<.6....ya.q|
-00000070  5f 45 d7 99 b2 55 10 22  db 56 d9 39 64 57 ad c3  |_E...U.".V.9dW..|
-00000080  59 a9 bd cb f2 22 16 03  03 02 69 34 e7 f2 7a bc  |Y...."....i4..z.|
-00000090  0b 90 72 a3 3b 6b 38 a3  f8 7a 19 39 ff b4 d6 8c  |..r.;k8..z.9....|
-000000a0  c9 92 4f a3 23 1a f0 89  bb 01 e4 b2 24 f7 db 3d  |..O.#.......$..=|
-000000b0  f4 4b 02 75 d0 ca 3c ed  e8 d9 13 61 c5 61 4e 7c  |.K.u..<....a.aN||
-000000c0  fe b9 49 69 63 cc 23 5f  9b 23 85 ec 86 e5 17 28  |..Iic.#_.#.....(|
-000000d0  8a 1e 0c 45 e5 4d c2 be  66 92 47 88 28 ec 52 eb  |...E.M..f.G.(.R.|
-000000e0  72 e5 30 89 58 8d 15 2b  98 eb cd e2 18 7c 53 f2  |r.0.X..+.....|S.|
-000000f0  89 ba 71 a5 91 20 64 17  7c 56 f1 01 8a 52 17 66  |..q.. d.|V...R.f|
-00000100  ef d7 bc 5b ff 54 53 13  2e 80 53 4c 84 6d a2 20  |...[.TS...SL.m. |
-00000110  0f e6 3d 33 90 7a 5b 1a  50 29 ce 1e af 74 a5 b3  |..=3.z[.P)...t..|
-00000120  0e 29 c8 e5 c1 50 b6 5d  c8 bb e4 b5 f5 6b 04 a8  |.)...P.].....k..|
-00000130  24 a6 a8 cc 77 7c 72 d5  b1 f3 6a 1c 2e d7 7e e0  |$...w|r...j...~.|
-00000140  4c 46 3f 26 61 2e 54 7d  ab d8 d6 ec 1e b0 0d d1  |LF?&a.T}........|
-00000150  02 57 00 7f 29 aa d3 1d  a4 40 73 d7 21 12 76 58  |.W..)....@s.!.vX|
-00000160  7d 79 a5 c1 d2 57 63 48  0e 63 5f 24 49 8a 57 ba  |}y...WcH.c_$I.W.|
-00000170  26 1c 39 4a f8 b3 89 79  e2 be 4e 8e 37 ae 16 75  |&.9J...y..N.7..u|
-00000180  42 5e 2e 9b 14 d5 b3 06  5f b9 c8 f7 16 8f eb 1c  |B^......_.......|
-00000190  48 0a da 1e b3 4a 78 f7  f8 b4 35 bf 7d 3f c5 8d  |H....Jx...5.}?..|
-000001a0  fa 7d c0 b7 52 af d3 13  de 96 39 76 fd 49 80 55  |.}..R.....9v.I.U|
-000001b0  bb b3 0f 5b 0c 84 4d 8b  da 62 8a 20 4b a1 28 28  |...[..M..b. K.((|
-000001c0  3d 74 cc 34 9d 95 8e af  c0 05 a2 5c 73 9d 73 d8  |=t.4.......\s.s.|
-000001d0  6c 4e 77 25 c5 8c 22 07  c6 b9 55 47 0c b2 12 73  |lNw%.."...UG...s|
-000001e0  2e f5 95 f7 28 c3 e4 24  2c fd 05 ac e2 3e df 93  |....(..$,....>..|
-000001f0  5a 28 66 aa d4 86 8a 48  e2 c8 69 01 18 90 54 10  |Z(f....H..i...T.|
-00000200  67 80 a1 be a8 9a 7f f3  17 ee dc 83 06 7a 70 6c  |g............zpl|
-00000210  59 c2 2d 8f ff 79 a7 e5  e2 f2 f3 f3 5b 44 42 25  |Y.-..y......[DB%|
-00000220  a3 8c a0 83 07 5c f6 73  e9 bd f5 6b 86 89 b4 11  |.....\.s...k....|
-00000230  7b 9a 28 52 4f 55 70 4a  75 00 73 cc 84 fa 4a ef  |{.(ROUpJu.s...J.|
-00000240  f8 8a 8d f9 18 e2 bc 13  48 cb 80 4d 6f fc d7 23  |........H..Mo..#|
-00000250  3a 9c 6c fd 46 27 94 8a  3d 9d fb 17 f5 06 4d a1  |:.l.F'..=.....M.|
-00000260  18 75 a7 9b 08 f8 47 b5  52 b4 19 4b b7 0f a4 e0  |.u....G.R..K....|
-00000270  78 f8 8b a4 cc eb d3 85  e1 ad 21 29 0f c7 09 28  |x.........!)...(|
-00000280  3f 21 12 6c fd 76 05 13  10 a0 c1 ce ba 7c e8 6f  |?!.l.v.......|.o|
-00000290  e9 99 67 0a 9d 3a 7f f1  a6 8a 53 56 f1 09 22 21  |..g..:....SV.."!|
-000002a0  24 23 6e bc 77 fc 56 3b  31 15 58 1b e9 03 a1 bf  |$#n.w.V;1.X.....|
-000002b0  0a 06 a0 fb 47 77 b7 ad  01 db ee 6a bc a4 a1 77  |....Gw.....j...w|
-000002c0  6f 3e 70 84 4c a6 21 ec  ff fa f0 f0 68 ee 7d b1  |o>p.L.!.....h.}.|
-000002d0  e6 37 f1 1c aa 43 c7 b9  0e c4 52 7d 54 d8 f7 c5  |.7...C....R}T...|
-000002e0  16 21 99 89 cb 02 d0 54  b8 0e 91 2e 58 25 32 6e  |.!.....T....X%2n|
-000002f0  fa ae 62 c9 16 03 03 00  bc 0c 2f 7e 22 d8 7f 21  |..b......./~"..!|
-00000300  0c 1a ec e1 37 72 3f 03  1d cc 73 f9 63 95 cd 47  |....7r?...s.c..G|
-00000310  66 17 60 8c da b4 35 a2  44 b1 d8 d1 1c 98 5b 8b  |f.`...5.D.....[.|
-00000320  c8 9b c8 cb c4 15 0d 8d  08 1e 7c 3a 6b 20 3a f1  |..........|:k :.|
-00000330  d1 86 ae 08 bb fd 74 c5  62 9a 50 74 07 96 10 0e  |......t.b.Pt....|
-00000340  e0 e4 a4 da c4 9d d1 f4  15 97 7d 21 0f 6f cb 39  |..........}!.o.9|
-00000350  8e 4e 40 1a 2a 7f 15 88  94 52 bc fd 61 b8 37 d1  |.N@.*....R..a.7.|
-00000360  48 62 bc 53 a3 a6 62 ec  0e c3 1f 82 67 19 71 fa  |Hb.S..b.....g.q.|
-00000370  99 16 c3 cf d6 82 44 36  9e 0b f0 41 12 ca 7b 67  |......D6...A..{g|
-00000380  c3 a6 2d f7 13 14 0f d1  16 f9 2a 5a dd 43 45 c6  |..-.......*Z.CE.|
-00000390  c0 f4 17 36 64 11 fc ed  e6 66 b6 0c e2 3d fb 72  |...6d....f...=.r|
-000003a0  93 27 46 20 db 1b 24 f9  69 a0 c7 71 e2 27 6a 93  |.'F ..$.i..q.'j.|
-000003b0  36 73 71 10 bd 16 03 03  00 4a cb 15 91 9c 22 96  |6sq......J....".|
-000003c0  f0 c8 b9 4d 9a 6c b0 eb  1a c5 d4 06 12 89 44 1b  |...M.l........D.|
-000003d0  52 cd fb 32 3f 2c 25 f4  d3 88 0f e4 9c 18 91 59  |R..2?,%........Y|
-000003e0  42 98 a8 65 35 62 f7 ce  fa a3 56 46 c5 b1 da ac  |B..e5b....VF....|
-000003f0  9e 4e de 8d 14 fc 3c f3  94 74 50 99 1d 65 6b a6  |.N....<..tP..ek.|
-00000400  a9 38 93 9f 16 03 03 00  14 d7 5b 68 ca 4c 80 92  |.8........[h.L..|
-00000410  f8 13 5d fe 14 22 6f 9a  42 3a 27 de c8           |..].."o.B:'..|
+00000000  16 03 03 00 85 f1 26 e0  cc 3f 3d a3 e6 57 21 a0  |......&..?=..W!.|
+00000010  25 c6 fd 11 f5 92 2e 73  21 32 2b 07 76 73 2b e3  |%......s!2+.vs+.|
+00000020  0a 45 1e 01 c8 28 01 1b  ba 23 d8 4e 7c 9f 2b 2e  |.E...(...#.N|.+.|
+00000030  5a ef df 4f 0d 77 76 27  8b 1e df 94 a4 90 1e cb  |Z..O.wv'........|
+00000040  5a 19 6b f0 c6 85 71 7b  6b cd 59 e1 32 a5 a5 18  |Z.k...q{k.Y.2...|
+00000050  01 25 13 84 09 e5 30 6a  d3 f2 80 07 1d 48 9b 72  |.%....0j.....H.r|
+00000060  d2 6e 76 e3 de 85 0b 9d  ec 5f e3 48 02 61 6c b1  |.nv......_.H.al.|
+00000070  1a 1b 89 7e 44 f8 af fd  a9 42 63 3e f6 3c f6 22  |...~D....Bc>.<."|
+00000080  ff 45 b4 f2 ec 31 65 58  8c 06 16 03 03 02 69 50  |.E...1eX......iP|
+00000090  e3 4b 21 fd f3 73 28 b1  b2 dc f4 46 d3 37 c1 c9  |.K!..s(....F.7..|
+000000a0  15 9c 83 a0 4d b5 6e c1  8c 97 26 05 20 4d cf 92  |....M.n...&. M..|
+000000b0  9a e4 e6 ff c2 d1 d4 c9  28 ca 08 00 ed ba 2a e1  |........(.....*.|
+000000c0  d2 71 62 4a 1a ca 7d db  19 86 81 a1 4b c4 f7 19  |.qbJ..}.....K...|
+000000d0  d2 b1 99 4a 82 39 e5 d2  90 59 ca 19 a5 1c 07 1c  |...J.9...Y......|
+000000e0  c1 44 d5 f3 a4 e5 33 ce  98 fc 24 e9 65 04 b9 08  |.D....3...$.e...|
+000000f0  2f f7 d6 87 91 33 64 8c  9e e9 50 35 28 76 3d 77  |/....3d...P5(v=w|
+00000100  b2 84 16 23 a1 6f d1 92  da 37 28 88 63 51 db 55  |...#.o...7(.cQ.U|
+00000110  5d d4 29 ab 64 e8 dd 1f  ef 06 31 78 ab f1 11 82  |].).d.....1x....|
+00000120  76 35 17 66 87 62 bc 9e  18 be 35 96 4d 5c 2d c6  |v5.f.b....5.M\-.|
+00000130  84 13 08 00 ec f9 bd b8  24 88 f5 2a 2b 11 0b ec  |........$..*+...|
+00000140  55 a2 f3 c7 b4 7d cf 56  90 1f d9 c0 4a 0e 8c 8c  |U....}.V....J...|
+00000150  d4 72 60 18 f6 eb 6a ae  83 35 bf d2 4f 0e f3 06  |.r`...j..5..O...|
+00000160  73 3f e1 3a 03 1f 51 02  2f dc e1 f8 87 95 8a 13  |s?.:..Q./.......|
+00000170  d3 89 ac af 36 c8 1d 19  08 61 97 c9 e3 0a b9 1a  |....6....a......|
+00000180  12 6e f1 fd d5 e3 78 bc  34 b7 6b 1d b4 48 3e d5  |.n....x.4.k..H>.|
+00000190  61 99 04 e5 74 ca 53 66  65 21 c2 2c fb e6 12 3d  |a...t.Sfe!.,...=|
+000001a0  5e 48 ac b9 ef d8 a3 75  32 85 eb 6f 88 84 b6 2f  |^H.....u2..o.../|
+000001b0  d4 67 e7 25 26 80 c0 39  73 97 fb e5 8d ed 65 7e  |.g.%&..9s.....e~|
+000001c0  a4 35 4e b7 e3 92 72 23  80 c2 f5 db b4 02 26 33  |.5N...r#......&3|
+000001d0  ff 46 3e 0d e6 e0 02 b1  65 e0 3f 8e 7d fd 12 73  |.F>.....e.?.}..s|
+000001e0  62 20 6a fc 00 2b 19 cb  17 c7 de 14 05 4b b5 f6  |b j..+.......K..|
+000001f0  49 78 92 f4 84 1d 94 1b  b1 23 67 5e b2 ae 75 4e  |Ix.......#g^..uN|
+00000200  f3 52 72 af fb 2e 12 7c  cc 6b b6 f3 3a 8a e4 ae  |.Rr....|.k..:...|
+00000210  03 db ed 20 b1 e5 a9 7b  0d df ae 75 c9 71 42 c4  |... ...{...u.qB.|
+00000220  e5 c9 a7 ac c8 f4 a5 e6  84 05 a0 be ca d8 d0 d1  |................|
+00000230  30 a0 84 42 82 df ba ba  d7 11 a5 f9 93 fd 8e 91  |0..B............|
+00000240  89 2e 2f b2 98 05 06 dc  2c a4 2a 6f f4 0f 9d 1d  |../.....,.*o....|
+00000250  16 2f d8 b9 06 02 43 92  cc 96 bc 6a a4 93 86 ef  |./....C....j....|
+00000260  43 11 ec b7 4e 39 9f 1f  75 71 76 1a 7b 1d 2e 68  |C...N9..uqv.{..h|
+00000270  ad 36 c7 ae 3a 7a 70 10  46 4e 76 9b f5 8c 1d b7  |.6..:zp.FNv.....|
+00000280  5d 62 86 70 1c 27 84 ae  8a 05 65 a2 01 bf 3b 0f  |]b.p.'....e...;.|
+00000290  d3 43 74 9d a0 ed 7f e4  63 dc b9 e6 7b d6 c1 2d  |.Ct.....c...{..-|
+000002a0  96 ae 51 6e 07 47 8b f8  f7 e2 71 19 3a df 7d cb  |..Qn.G....q.:.}.|
+000002b0  ef 82 2a 11 fd 9c e9 24  9d b0 9e e4 1f f2 4e 8b  |..*....$......N.|
+000002c0  17 02 4a 27 33 85 61 d3  55 6d 82 77 ce 55 d3 be  |..J'3.a.Um.w.U..|
+000002d0  94 9f 6d 1d f0 16 1d 19  bd 1f ac 77 e7 13 32 94  |..m........w..2.|
+000002e0  86 8c c8 c9 33 f0 b0 47  cf 9c 7c ef 97 c3 37 25  |....3..G..|...7%|
+000002f0  bf a7 09 82 35 ff 9f 79  16 03 03 00 bc 8c 34 16  |....5..y......4.|
+00000300  37 9c cb db aa dc 23 ba  07 28 88 be 6f f0 cc 42  |7.....#..(..o..B|
+00000310  22 31 2c fc a4 ce d8 bf  58 54 a7 62 6b 54 8b b1  |"1,.....XT.bkT..|
+00000320  0b 44 29 a9 64 2f af ee  f1 7b 79 1c 26 02 a3 bd  |.D).d/...{y.&...|
+00000330  e5 dd 60 89 ef e9 31 bc  5d 17 fc a9 05 77 38 00  |..`...1.]....w8.|
+00000340  e8 d9 8c b3 c6 7d fb a0  f8 d1 87 2a c6 74 d6 2c  |.....}.....*.t.,|
+00000350  39 c8 3c d8 0d 0d a6 e2  ea 6b 88 9d 7d ee cc 4e  |9.<......k..}..N|
+00000360  69 2a ac 41 7e ac b8 fe  b4 8f 43 ef 2d a7 45 78  |i*.A~.....C.-.Ex|
+00000370  bf 29 72 b5 4b cf bb aa  1a 64 3c dd 38 07 ab 60  |.)r.K....d<.8..`|
+00000380  b3 ee e3 0b 40 a1 72 4d  61 1a ba d8 24 a7 46 3f  |....@.rMa...$.F?|
+00000390  77 c9 bd 11 37 d7 ae c9  92 d8 78 a5 13 f8 2c 2f  |w...7.....x...,/|
+000003a0  10 50 7c e5 16 2c 56 e7  a6 10 cb fc 62 a2 6f 83  |.P|..,V.....b.o.|
+000003b0  30 74 d3 94 23 78 c8 6d  28 16 03 03 00 4a 76 dc  |0t..#x.m(....Jv.|
+000003c0  db 13 a2 52 07 65 62 35  36 56 42 95 1d 34 8f 2a  |...R.eb56VB..4.*|
+000003d0  cd 5e 63 aa 56 70 ac 16  76 7b 7d b6 3f a4 57 6b  |.^c.Vp..v{}.?.Wk|
+000003e0  f1 9e 6a a7 ca e5 cb b0  44 5e 8b 6a ea 78 45 ad  |..j.....D^.j.xE.|
+000003f0  0c 9d 44 8c 1f 03 27 9b  90 2e 9e fc 50 44 1f 4d  |..D...'.....PD.M|
+00000400  f3 ac 1f 2f 6d ed 49 29  16 03 03 00 14 ba 05 de  |.../m.I)........|
+00000410  4f 96 62 af d1 e0 a6 64  0d f3 ee 50 ca 1f d1 50  |O.b....d...P...P|
+00000420  bb                                                |.|
 >>> Flow 9 (client to server)
-00000000  16 03 03 02 69 aa 39 9e  c8 e7 89 97 7f 22 3c 28  |....i.9......"<(|
-00000010  76 ac d9 48 51 e0 cd 22  53 a1 6d e7 b4 00 27 7d  |v..HQ.."S.m...'}|
-00000020  89 4b f0 54 d8 39 d0 a3  fc 35 a6 36 4b 3c eb 3a  |.K.T.9...5.6K<.:|
-00000030  00 b0 c1 17 9d c8 13 a5  58 ba 16 9e cb 21 50 dd  |........X....!P.|
-00000040  8a e0 2d 57 dd a6 bf 4d  6e b3 21 3b 46 f4 c3 77  |..-W...Mn.!;F..w|
-00000050  a1 86 07 c7 db e9 0a cb  2d 0f ff b5 1b ad 6b c4  |........-.....k.|
-00000060  c4 a4 4e 14 cf cb b2 6c  07 65 17 d2 db 30 e9 ec  |..N....l.e...0..|
-00000070  41 4e 78 26 12 27 08 a6  a7 84 39 c0 4b e7 4b 23  |ANx&.'....9.K.K#|
-00000080  2f ca ff 1e 41 9a e8 44  fc 5d a0 34 4e ca a8 6d  |/...A..D.].4N..m|
-00000090  31 51 57 c9 7e d1 0a 42  22 f2 b4 f9 a7 f9 28 d8  |1QW.~..B".....(.|
-000000a0  2a dd 19 0d 90 8b e1 78  b1 1c da 3a bb 5e 05 54  |*......x...:.^.T|
-000000b0  0d 0e f8 73 ed 01 e2 e4  d4 c1 f8 fa c3 d6 6f 42  |...s..........oB|
-000000c0  cc cb 99 99 97 18 b0 fb  ab 51 42 66 45 67 b6 29  |.........QBfEg.)|
-000000d0  02 60 ab 74 30 db f6 16  8a 8f 8e 9c cc d5 47 fa  |.`.t0.........G.|
-000000e0  f5 af 94 4f b1 94 40 57  ab 85 59 e4 3e cc c5 a0  |...O..@W..Y.>...|
-000000f0  61 b7 64 f9 dc 96 40 ae  fb 4c 57 39 9e 9a 23 8e  |a.d...@..LW9..#.|
-00000100  c9 36 6c 75 11 c7 6e 54  c3 1c e9 25 6a a0 f8 bb  |.6lu..nT...%j...|
-00000110  6b 5c ca 5c 06 6c 03 88  01 27 4c 89 02 e6 b6 1a  |k\.\.l...'L.....|
-00000120  92 99 4d 15 c1 1a aa 58  20 49 d7 4a f9 09 34 1e  |..M....X I.J..4.|
-00000130  d7 d8 31 79 9f d8 b3 a0  76 ba 96 77 77 77 5b 80  |..1y....v..www[.|
-00000140  88 ab a0 90 c7 5f 3d 82  e1 23 29 6e 3a 4d 9b f0  |....._=..#)n:M..|
-00000150  7b 6a b1 9d 78 ba 4c 7e  02 1f a0 73 3e 91 cf 75  |{j..x.L~...s>..u|
-00000160  c6 52 2d c6 79 be 85 65  0e e4 73 39 fe 53 6d e0  |.R-.y..e..s9.Sm.|
-00000170  a3 18 d5 69 80 ca f1 c8  ad f5 f4 fb b5 40 2e f8  |...i.........@..|
-00000180  30 82 ca 2c 46 6a ab a6  b2 83 9f a8 95 95 30 e3  |0..,Fj........0.|
-00000190  e3 30 6d f5 7c 83 96 af  12 d8 d6 d6 f9 6a ad bd  |.0m.|........j..|
-000001a0  bb 96 83 99 99 d8 6d 20  0e e1 be da 58 05 44 88  |......m ....X.D.|
-000001b0  a6 07 47 84 d4 77 fc 9b  fb d7 ac 60 70 0b e7 76  |..G..w.....`p..v|
-000001c0  13 c7 38 d9 3d 60 eb a6  9f a5 6d fc 5c d5 f6 2f  |..8.=`....m.\../|
-000001d0  31 02 38 65 8d be 04 06  84 95 86 b1 84 d9 ce c7  |1.8e............|
-000001e0  30 b9 d3 85 9f 1b 12 0f  5c 0e d6 8d e3 a0 15 04  |0.......\.......|
-000001f0  03 62 9d 52 7b e7 f4 13  aa 02 64 d9 d4 4b fd 6f  |.b.R{.....d..K.o|
-00000200  de ea 4a aa 91 60 e7 78  af 84 b5 9d c3 d2 c6 3a  |..J..`.x.......:|
-00000210  2a 9f 9b c6 8d 9e 5e 2c  90 6c d3 9d c1 be 96 5a  |*.....^,.l.....Z|
-00000220  60 d8 73 6c 49 50 c8 03  ec 58 73 bc b3 8c 30 c1  |`.slIP...Xs...0.|
-00000230  f4 a2 7d 74 3d 8d 7e 64  c1 a7 b6 24 13 06 72 1b  |..}t=.~d...$..r.|
-00000240  d0 87 22 af df 2a e7 fe  57 fa db e7 00 ba 74 35  |.."..*..W.....t5|
-00000250  16 34 20 3f 75 69 35 5f  64 7e 26 56 7c 93 05 4e  |.4 ?ui5_d~&V|..N|
-00000260  42 65 b8 bf 59 8e 82 13  f1 d0 05 95 c2 3d 16 03  |Be..Y........=..|
-00000270  03 00 35 99 1d 52 84 73  d6 e7 90 f6 41 9e 69 07  |..5..R.s....A.i.|
-00000280  39 0b bc b6 c7 f4 f2 a0  93 80 b9 c7 bb b4 a6 06  |9...............|
-00000290  50 5b 5d 75 97 cf c5 dc  2d 07 3d 8f 9e ae fa bf  |P[]u....-.=.....|
-000002a0  5b 6b 3e 98 02 fd e4 7d  16 03 03 00 98 80 ac e9  |[k>....}........|
-000002b0  4e e0 f8 b5 8c c2 2e 84  ec e0 3b eb b7 a0 14 2d  |N.........;....-|
-000002c0  ff d2 bf 35 14 20 06 00  2e 48 c7 f8 a3 fd 4f 50  |...5. ...H....OP|
-000002d0  4a 04 3e c7 07 50 90 72  29 f0 5c ac e1 fd 9d 3f  |J.>..P.r).\....?|
-000002e0  42 99 77 32 a9 79 24 7f  9e cc 84 1c d0 db 87 1c  |B.w2.y$.........|
-000002f0  3c 9a ae e3 45 e5 67 83  5f 75 e9 27 f3 ef 8a 15  |<...E.g._u.'....|
-00000300  88 2b 3f cc 6f 6f a4 78  d5 b2 96 3e 72 d4 c8 43  |.+?.oo.x...>r..C|
-00000310  98 a7 60 ae 38 8e fe 21  49 5b c2 80 d6 ef 6f 9b  |..`.8..!I[....o.|
-00000320  08 18 07 c2 64 00 a1 a0  09 8b b4 b7 eb 0c 68 30  |....d.........h0|
-00000330  26 87 f9 99 85 63 35 81  5a e4 31 19 9e f8 b8 7b  |&....c5.Z.1....{|
-00000340  81 aa 24 ff cd 14 03 03  00 11 84 c7 e1 8f 74 66  |..$...........tf|
-00000350  e6 bd 14 55 a8 d3 67 30  2d c4 fb 16 03 03 00 20  |...U..g0-...... |
-00000360  3a 63 a5 86 f3 78 f1 62  18 77 f7 25 71 52 56 17  |:c...x.b.w.%qRV.|
-00000370  d2 a5 e4 fa bc bb 44 07  85 37 cb 36 84 c7 6a 97  |......D..7.6..j.|
+00000000  16 03 03 02 69 54 06 eb  58 fb 0c cd 83 50 78 6d  |....iT..X....Pxm|
+00000010  e1 63 b0 24 eb 11 2b b3  76 77 c9 7b e4 ad c8 a9  |.c.$..+.vw.{....|
+00000020  71 73 68 a2 89 ba bc fd  0d d4 cc 7b 33 0a 11 c6  |qsh........{3...|
+00000030  a0 56 0f b4 86 e6 e5 31  85 2d 98 1b f0 28 67 2b  |.V.....1.-...(g+|
+00000040  d2 c8 9a 32 83 c1 50 10  16 08 70 72 fb 80 c7 a4  |...2..P...pr....|
+00000050  fa 95 88 bc 7c 45 67 1d  43 24 7b 56 9a 09 b6 38  |....|Eg.C${V...8|
+00000060  e2 4c 25 93 7a 02 f8 c4  f2 52 7e e4 8e 99 ad 9c  |.L%.z....R~.....|
+00000070  1d 8f 54 a5 67 d1 27 5d  c7 d0 76 47 a8 7f 54 79  |..T.g.']..vG..Ty|
+00000080  4c f2 98 bc 8c 3c 78 9b  6e c1 8b 2c 09 40 77 a9  |L....<x.n..,.@w.|
+00000090  69 3b 80 2f b7 a3 d0 54  66 4d 39 ec 30 ad 31 a4  |i;./...TfM9.0.1.|
+000000a0  a7 e2 3a 37 96 0e f8 e3  e5 b2 03 fc ce 72 d0 f0  |..:7.........r..|
+000000b0  84 08 c4 ff 95 9c 6c dc  e7 03 1f 45 d8 8a ec 92  |......l....E....|
+000000c0  98 87 eb 61 16 a9 b5 10  81 d1 ea 03 a5 62 d5 25  |...a.........b.%|
+000000d0  62 71 e8 56 4c a4 47 5f  6b cb 8c 50 c3 4c 17 8f  |bq.VL.G_k..P.L..|
+000000e0  64 f9 ab 22 9a 94 c7 68  7d c0 79 f2 5c 36 54 8c  |d.."...h}.y.\6T.|
+000000f0  53 31 d4 0a 52 5c 7f 11  87 e4 a8 83 b0 77 3e 73  |S1..R\.......w>s|
+00000100  d5 cd e8 4e 1b a2 4a 52  38 43 6a b1 fc 85 98 7e  |...N..JR8Cj....~|
+00000110  db 7d 0a 9c d9 bc 6e 7b  19 ce 3c 49 2f 8a d1 6d  |.}....n{..<I/..m|
+00000120  93 39 7f b2 3b ab 6b 19  4c cd 53 d7 6b ff ff 89  |.9..;.k.L.S.k...|
+00000130  fc bc cf cc 22 c9 aa 46  08 c4 7a e0 d1 44 c4 c5  |...."..F..z..D..|
+00000140  8b 2d 93 b5 70 d7 19 4f  2c 4b c6 52 16 7b a8 bd  |.-..p..O,K.R.{..|
+00000150  0c 46 a9 c2 b0 8f 3f 99  ef b4 13 c9 ad 26 a1 9e  |.F....?......&..|
+00000160  4a 64 ce 22 a7 de 98 f9  d4 1c 73 c7 e8 59 cf 8c  |Jd."......s..Y..|
+00000170  28 b4 39 f7 a6 08 76 d7  6d 7d b3 63 9b d1 64 e1  |(.9...v.m}.c..d.|
+00000180  10 ad b8 ff b5 93 5f 91  87 e2 72 93 47 b9 fc 8c  |......_...r.G...|
+00000190  5e e4 c6 28 72 90 5c 66  25 23 74 f9 e6 fc 0e da  |^..(r.\f%#t.....|
+000001a0  65 83 18 85 49 c6 d3 25  fe e2 90 02 0b 06 78 b0  |e...I..%......x.|
+000001b0  0d 2e fc 44 f6 5a 65 9f  55 e8 78 c2 a7 05 97 b6  |...D.Ze.U.x.....|
+000001c0  52 a5 18 51 61 eb 58 46  65 c1 51 8e 1f a0 3e 96  |R..Qa.XFe.Q...>.|
+000001d0  3a 52 24 2f 0a 33 c1 3b  34 74 ef 06 c5 5e 14 fb  |:R$/.3.;4t...^..|
+000001e0  b8 30 a3 80 2e c4 11 f3  a2 4c 03 65 60 c0 b0 0c  |.0.......L.e`...|
+000001f0  aa cd e8 2e f1 d8 f2 5a  4b 48 c0 5b 47 57 1d 9a  |.......ZKH.[GW..|
+00000200  a0 cc 9e dd 6f 22 7c 8b  f8 e3 21 2c fc 87 6e b0  |....o"|...!,..n.|
+00000210  cd bf 90 e4 05 f7 93 af  4a f0 73 73 4e af 70 ce  |........J.ssN.p.|
+00000220  8d 96 e3 b0 bc e8 3e e2  92 09 a4 74 52 1c 7c 55  |......>....tR.|U|
+00000230  5c 5c 64 07 05 9d f5 54  0f ff 1b 02 0c c4 22 94  |\\d....T......".|
+00000240  aa 7b 43 e0 9d 67 25 23  da 8b 03 26 02 1b 22 92  |.{C..g%#...&..".|
+00000250  ff f8 f6 be 40 54 c2 9b  18 af 53 63 70 76 7c ce  |....@T....Scpv|.|
+00000260  d4 e7 b6 f6 89 43 ec 11  af b3 05 ee de ad 16 03  |.....C..........|
+00000270  03 00 35 72 0c 52 b0 32  0a 1f fc 27 13 34 67 25  |..5r.R.2...'.4g%|
+00000280  a8 39 89 9e 6c ea 6f 25  72 f7 40 63 b2 c9 e2 e0  |.9..l.o%r.@c....|
+00000290  d4 eb 44 ad ae d0 58 1e  54 9c db 31 ba 03 44 9d  |..D...X.T..1..D.|
+000002a0  95 f5 f3 bb ef d6 4d f5  16 03 03 00 98 d6 86 68  |......M........h|
+000002b0  3d 68 f6 6d 2d cf 30 e8  32 2d 8e 1e b9 67 a1 8d  |=h.m-.0.2-...g..|
+000002c0  91 ae 10 8a d6 ce 3c f0  98 01 6a 96 c1 41 cc d4  |......<...j..A..|
+000002d0  b1 dc 49 25 be 0f 5b 59  6d f2 12 4d 49 92 e7 2d  |..I%..[Ym..MI..-|
+000002e0  3d 59 53 38 ff ca 2c 52  ea 30 1c 55 9d 7c 7c 3b  |=YS8..,R.0.U.||;|
+000002f0  2b 4f 53 0d d7 0f 50 1e  ac f9 97 de cb 46 f9 74  |+OS...P......F.t|
+00000300  78 ac 4b 82 e4 25 10 63  04 5c 64 c1 d6 e3 4b c1  |x.K..%.c.\d...K.|
+00000310  5a 41 02 79 06 bd 75 6f  54 8e a4 a8 6d 7d 30 98  |ZA.y..uoT...m}0.|
+00000320  3f 65 fb 6c dd 59 39 e5  8e a4 08 96 62 70 12 2f  |?e.l.Y9.....bp./|
+00000330  c5 94 3a 1b 2a 99 cc da  fb d3 85 19 5b 10 3c d9  |..:.*.......[.<.|
+00000340  b4 f9 e8 df c8 14 03 03  00 11 c3 3f 56 55 75 1b  |...........?VUu.|
+00000350  90 77 ff 04 f4 24 0d 0b  04 ac 2b 16 03 03 00 20  |.w...$....+.... |
+00000360  63 1a 0b 3e 2b 0b f0 d7  11 11 03 b0 0d f8 0c ce  |c..>+...........|
+00000370  25 c6 b4 0d ee 5c 95 40  9a 86 29 1d ee 06 29 88  |%....\.@..)...).|
 >>> Flow 10 (server to client)
-00000000  14 03 03 00 11 9e 99 89  2d 10 21 a1 38 04 77 1a  |........-.!.8.w.|
-00000010  f8 1d b4 01 d1 9f 16 03  03 00 20 2a cb 67 8b 1b  |.......... *.g..|
-00000020  44 26 41 7b c4 6d a1 f4  cb ee 15 87 01 65 18 5a  |D&A{.m.......e.Z|
-00000030  c7 2d 10 e4 91 01 cb 22  e8 92 1a 17 03 03 00 19  |.-....."........|
-00000040  1a 46 a0 9a c5 1a 27 0c  e2 f9 03 55 3a e8 43 a7  |.F....'....U:.C.|
-00000050  d7 47 a5 95 6a e7 a1 12  69 16 03 03 00 14 d6 e0  |.G..j...i.......|
-00000060  1d 89 e0 c2 9a 52 d5 bc  d4 08 3e f6 81 dd 57 a2  |.....R....>...W.|
-00000070  25 f6                                             |%.|
+00000000  14 03 03 00 11 5e 2d 5e  29 92 98 7e cd a8 00 b6  |.....^-^)..~....|
+00000010  08 53 39 b6 a2 d1 16 03  03 00 20 6e 0e 3e 92 3a  |.S9....... n.>.:|
+00000020  b5 a6 ec 3e f2 38 3e 78  86 77 3e 50 9d 29 de bc  |...>.8>x.w>P.)..|
+00000030  07 e7 d3 eb 20 ee a7 e9  5e 4c f6 17 03 03 00 19  |.... ...^L......|
+00000040  06 47 a1 60 72 a7 0d 81  84 86 5e 80 a7 73 7e d9  |.G.`r.....^..s~.|
+00000050  db f7 d6 97 f7 9c 12 66  b3 16 03 03 00 14 2b 6d  |.......f......+m|
+00000060  1a cb 48 9f a3 84 45 a6  d7 c9 ed 4f 15 44 ec c8  |..H...E....O.D..|
+00000070  9b a5                                             |..|
 >>> Flow 11 (client to server)
-00000000  16 03 03 01 16 27 50 ce  c0 8e 5a e2 54 55 cb c0  |.....'P...Z.TU..|
-00000010  08 c7 20 87 7e 78 c6 da  a6 7a 62 fd 7f f5 87 b3  |.. .~x...zb.....|
-00000020  83 a0 c8 70 ab 57 9b ca  bf 4c 07 06 f1 89 b9 b6  |...p.W...L......|
-00000030  24 f0 ae 72 e1 36 31 9f  74 ed 06 ad 44 3b 51 2c  |$..r.61.t...D;Q,|
-00000040  ed f0 c2 d8 9b 27 d2 9a  ec 44 88 80 7c 5a d0 66  |.....'...D..|Z.f|
-00000050  3d 84 e3 7c 24 89 b9 dd  8c eb 86 cd ce 69 0d e3  |=..|$........i..|
-00000060  97 ee ad 74 53 7f 9c f0  05 31 43 2a 8c 09 c4 11  |...tS....1C*....|
-00000070  46 3e 82 2c 3c 69 91 d1  eb 4b 8a ab a9 cb 24 00  |F>.,<i...K....$.|
-00000080  00 25 bd 26 d3 85 19 ff  3b 2b 92 3f 43 b0 9f 24  |.%.&....;+.?C..$|
-00000090  59 4f 3d a6 ce 65 27 5c  75 47 92 7b 4a d3 ca 55  |YO=..e'\uG.{J..U|
-000000a0  38 00 ac 37 0c 6e 2d 04  bc 6e fe 3a 9a 43 b6 7f  |8..7.n-..n.:.C..|
-000000b0  18 c1 a6 ce 49 b4 61 d3  97 8d a2 c9 fb fb cd 23  |....I.a........#|
-000000c0  f6 2f 0c 0b 2a b8 31 9e  fd ff 9f 44 1e 33 c3 23  |./..*.1....D.3.#|
-000000d0  bf 09 d2 de 90 b6 61 9c  33 33 33 46 bc 00 7e 16  |......a.333F..~.|
-000000e0  3c bd 82 2d 31 51 5b 11  87 ec 7f 25 d8 95 f9 9c  |<..-1Q[....%....|
-000000f0  df 00 54 40 f3 c1 08 fa  ef ba bc 5d b1 96 ae 8f  |..T@.......]....|
-00000100  35 0e 43 b2 50 c7 7e c4  b2 71 2e 40 3a b7 90 2b  |5.C.P.~..q.@:..+|
-00000110  81 ac 00 14 9d da d8 ca  5e 25 62                 |........^%b|
+00000000  16 03 03 01 1a 57 f6 a3  85 62 29 d9 5d b5 40 f7  |.....W...b).].@.|
+00000010  71 ce d5 59 fa a4 5f a7  b7 a0 37 4a 5c 6c 9c 85  |q..Y.._...7J\l..|
+00000020  e5 df be 22 14 a5 75 e5  79 0f 0f f9 91 00 74 f3  |..."..u.y.....t.|
+00000030  5f b9 2f a8 1b e4 4a d4  7b 7d 79 e1 81 e4 7e 6c  |_./...J.{}y...~l|
+00000040  7b b8 d4 c9 69 85 2a e7  4e 33 75 47 84 e6 7a 1c  |{...i.*.N3uG..z.|
+00000050  9f 14 76 07 2c 53 e0 ab  ba 5a c6 e3 a4 08 12 9e  |..v.,S...Z......|
+00000060  99 15 ed ce 17 e1 6e 20  a8 f2 24 84 53 da c6 0f  |......n ..$.S...|
+00000070  2f d5 c7 bf 23 00 90 1f  9f af 0f f7 d6 ad f6 4a  |/...#..........J|
+00000080  3f 88 ec c2 a7 04 08 0f  97 e4 b5 6b a5 19 a4 98  |?..........k....|
+00000090  f7 ab a3 e1 44 56 39 b0  1d 2d c4 59 a7 3c d6 b4  |....DV9..-.Y.<..|
+000000a0  44 8d ae 56 0e d5 6b ab  a4 33 da d1 c3 38 4b fe  |D..V..k..3...8K.|
+000000b0  cc 40 3b 78 67 26 50 dd  75 3e a5 23 37 05 32 cf  |.@;xg&P.u>.#7.2.|
+000000c0  b4 6d a3 c1 a3 83 f8 1d  a4 80 7c e9 69 84 5c 55  |.m........|.i.\U|
+000000d0  92 7a 99 d7 86 27 dc be  54 27 d3 1d 1e ad 01 6d  |.z...'..T'.....m|
+000000e0  58 27 e2 82 a1 e4 55 03  67 b9 ee 51 b1 2d f9 25  |X'....U.g..Q.-.%|
+000000f0  28 a3 c7 44 08 b0 3b 60  46 23 2c 17 76 f2 78 1e  |(..D..;`F#,.v.x.|
+00000100  3c f2 b5 5c b0 1e 5d a7  9c e6 4f c3 ba 34 40 30  |<..\..]...O..4@0|
+00000110  d6 e3 68 2a d6 d2 75 04  d5 44 2d 41 87 c8 96     |..h*..u..D-A...|
 >>> Flow 12 (server to client)
-00000000  16 03 03 00 81 37 3a f4  1b 6a 43 d2 6a 02 02 33  |.....7:..jC.j..3|
-00000010  b9 d5 9a 5c d1 3b 52 73  f2 27 a6 c0 f0 9b dd f3  |...\.;Rs.'......|
-00000020  d7 cd 89 ec 21 e0 d3 2f  4d 6c b0 cf 50 a7 39 43  |....!../Ml..P.9C|
-00000030  c2 56 d2 f8 45 d7 3c a6  b6 b9 06 3f ca a7 f8 37  |.V..E.<....?...7|
-00000040  4c 89 01 49 82 5f 27 15  3c bf f0 86 7c 1a 84 03  |L..I._'.<...|...|
-00000050  5a 90 77 03 01 fd b8 60  2a be cc 60 c6 54 b5 ec  |Z.w....`*..`.T..|
-00000060  c1 5d 6b e6 f0 2c 8c e6  7e e3 b6 c3 8b 63 3c 69  |.]k..,..~....c<i|
-00000070  ac 2c 9a 24 a7 77 5f 0c  36 08 68 6c 8b 76 f1 80  |.,.$.w_.6.hl.v..|
-00000080  4a bf f7 e6 15 5b 16 03  03 02 69 a1 ce a6 de 44  |J....[....i....D|
-00000090  cf d6 f7 88 f4 da 01 06  2b e5 cf 54 8d f6 78 ab  |........+..T..x.|
-000000a0  53 c5 ea d9 97 4b 94 22  24 9b 98 ba ba ee 42 9d  |S....K."$.....B.|
-000000b0  c3 e4 12 e3 be 35 24 86  3d 38 a0 6e b7 e6 cf dc  |.....5$.=8.n....|
-000000c0  e7 5c e1 0d 7c 05 bb 63  7c 8b c4 a4 db 9a 85 a4  |.\..|..c|.......|
-000000d0  ba d6 d4 79 38 79 01 52  2d cf c1 c7 6e 09 64 ff  |...y8y.R-...n.d.|
-000000e0  e9 b6 3e f2 a0 2b 4c 91  3f e2 fe 1a 40 4b 14 ea  |..>..+L.?...@K..|
-000000f0  77 8f 40 1c a2 96 7c d3  ce 34 5e d8 13 5a 82 33  |w.@...|..4^..Z.3|
-00000100  41 59 fa d9 81 1c 85 41  9c 61 b9 ca d5 46 e2 77  |AY.....A.a...F.w|
-00000110  3d a9 50 4f 11 b1 34 aa  ae fd e5 ec fe 12 e6 10  |=.PO..4.........|
-00000120  36 84 fb 25 f8 a4 6f 44  e3 ac 89 67 e4 9a 02 c4  |6..%..oD...g....|
-00000130  8f a9 4a d0 f4 64 e2 de  da 80 02 60 cb a9 2d e0  |..J..d.....`..-.|
-00000140  fa d9 b9 ee 43 e1 3e ed  79 79 6b 21 62 3d 6f b0  |....C.>.yyk!b=o.|
-00000150  77 53 db 26 60 e1 d6 ff  a7 01 2b b7 f0 49 df b8  |wS.&`.....+..I..|
-00000160  bc d9 ac 77 80 f8 53 66  16 8d 3a 8d 63 fa 12 e1  |...w..Sf..:.c...|
-00000170  ed f7 8b c0 40 46 16 70  e3 db f3 38 87 9f 11 eb  |....@F.p...8....|
-00000180  0b f5 b3 44 e4 16 e1 ed  85 e6 67 d5 35 60 20 99  |...D......g.5` .|
-00000190  7d bd 9f 65 b9 52 68 6c  6b 83 f9 06 e3 a7 3e 0f  |}..e.Rhlk.....>.|
-000001a0  9e 7c a5 ac 87 7a 45 53  a5 3f 27 5b 99 a9 34 c2  |.|...zES.?'[..4.|
-000001b0  5a 44 9a 30 08 30 c6 ff  60 8a a5 72 f7 49 d3 7c  |ZD.0.0..`..r.I.||
-000001c0  1f f9 8b 74 a0 b1 c8 65  84 6d 91 86 ab 1e 82 3b  |...t...e.m.....;|
-000001d0  d5 c4 bb 06 b3 31 61 bb  0e 65 3e 18 4d 0c c1 c1  |.....1a..e>.M...|
-000001e0  9d 7f ea ad cf 53 2e 9c  1c 7e aa c8 84 9e 0d ce  |.....S...~......|
-000001f0  91 53 3c d4 05 7e 57 d1  8b 55 ea e4 6e 57 90 4c  |.S<..~W..U..nW.L|
-00000200  bb 74 9c 87 1c 6a 89 cf  2c 50 8d 04 04 e6 18 c8  |.t...j..,P......|
-00000210  0c 9f 38 84 f4 f4 94 8d  33 2b a1 27 0b 5c 6a 2a  |..8.....3+.'.\j*|
-00000220  0c 13 b7 07 b7 a0 c9 e5  3c 9d 5a 7e 96 c9 53 fc  |........<.Z~..S.|
-00000230  ff c4 3a 8f 16 1f 2d 64  50 1d 13 c3 55 fb af d2  |..:...-dP...U...|
-00000240  0e f9 e6 18 e3 62 ce 6a  8f 96 ff 00 0e fe 27 53  |.....b.j......'S|
-00000250  70 57 53 2d fd f3 02 c7  fe b3 19 49 88 27 7e a2  |pWS-.......I.'~.|
-00000260  42 7b 22 d0 77 4e e5 04  aa 0d b6 9d b9 48 97 ab  |B{".wN.......H..|
-00000270  33 e7 14 97 65 82 f9 2c  dc 71 9e 4b eb ed 42 73  |3...e..,.q.K..Bs|
-00000280  c6 c8 93 8a 3a 24 bd f9  b4 6a 95 c1 1b 22 1d f5  |....:$...j..."..|
-00000290  c8 33 c5 38 1e a7 2e 91  68 35 4c 0a 37 57 ac e2  |.3.8....h5L.7W..|
-000002a0  c9 37 9e d9 1c b8 76 73  c2 d2 0c d0 c4 a1 c0 d5  |.7....vs........|
-000002b0  72 39 bf 03 f7 8d db e0  8f fe e2 d6 d0 d4 cc bb  |r9..............|
-000002c0  7d 78 c6 c5 13 a8 4e 45  1e 66 60 77 fe 26 4d 18  |}x....NE.f`w.&M.|
-000002d0  90 e8 e1 0c 5b 2b 25 9b  ee 6d 76 3f f6 23 a2 26  |....[+%..mv?.#.&|
-000002e0  52 8d a9 4e 7f ed 8e e2  6d 7c b4 eb 25 46 54 27  |R..N....m|..%FT'|
-000002f0  e2 2d 2c 59 16 03 03 00  bc 6e c1 fb 66 55 ca ea  |.-,Y.....n..fU..|
-00000300  56 62 78 2f fd c4 ff da  78 dd e7 4d 34 59 a5 8f  |Vbx/....x..M4Y..|
-00000310  05 ab ac 7f 80 35 f6 de  9d 3f fe 4b d4 79 07 3b  |.....5...?.K.y.;|
-00000320  c0 8d 02 b8 1a 28 b5 eb  9b 55 6c 26 12 8d 38 01  |.....(...Ul&..8.|
-00000330  55 ed 28 68 aa 48 13 61  d3 fe 29 f0 fe 18 4e ae  |U.(h.H.a..)...N.|
-00000340  6e f9 47 7c 65 91 f9 5e  17 80 68 fd 19 4d ed 17  |n.G|e..^..h..M..|
-00000350  7f 11 c4 15 5d 4b fc ea  a7 5c df 76 a0 08 2e 15  |....]K...\.v....|
-00000360  d1 c6 ae 7b 0d 1f 79 d7  0c 59 6b 53 46 b6 c0 2b  |...{..y..YkSF..+|
-00000370  ce 09 39 12 7a df f6 7d  a2 4b 86 2a df ab b8 7c  |..9.z..}.K.*...||
-00000380  07 10 3c 34 cd 15 4c ac  68 a4 28 8a f8 fc 30 a4  |..<4..L.h.(...0.|
-00000390  4f 15 77 b4 91 ca 02 ee  bb 64 36 90 1b 4b 9d 2b  |O.w......d6..K.+|
-000003a0  72 e7 dc 10 bd 83 97 18  3c 56 68 58 c9 e3 22 df  |r.......<VhX..".|
-000003b0  33 43 81 7d 5f 16 03 03  00 14 a8 eb 40 73 19 19  |3C.}_.......@s..|
-000003c0  22 10 63 ed f0 6d 73 8c  f4 bd f9 ba ad 2e        |".c..ms.......|
+00000000  16 03 03 00 85 77 11 78  f7 3a 59 c7 f1 a4 e6 6c  |.....w.x.:Y....l|
+00000010  3d e2 e0 1e 96 f7 2c d6  ce ef 27 3b 7f 37 cb bc  |=.....,...';.7..|
+00000020  8e ca c0 57 ab 03 1e cc  d1 fb 6c 49 e2 89 48 a1  |...W......lI..H.|
+00000030  84 00 a2 9b cb ae 2a ec  7c 60 9c 0c bf ff 07 ae  |......*.|`......|
+00000040  13 16 7b 7b a2 80 35 d3  5d 17 18 5a fb d8 87 46  |..{{..5.]..Z...F|
+00000050  43 6e e7 e9 35 5f bb 5c  87 03 0d 3c 93 6d f9 9b  |Cn..5_.\...<.m..|
+00000060  28 b9 42 c3 ea f0 11 60  a1 f4 72 c0 f9 4c e9 36  |(.B....`..r..L.6|
+00000070  77 c7 d0 e4 4b 7e d8 b4  68 d9 7f 97 bc 07 c5 4b  |w...K~..h......K|
+00000080  5e 11 1d ab 6e a4 24 41  2c d3 16 03 03 02 69 e7  |^...n.$A,.....i.|
+00000090  68 ab 42 56 cb b5 70 a0  3b 63 c4 a6 10 49 1d d5  |h.BV..p.;c...I..|
+000000a0  15 33 29 54 8f 36 a8 3c  b7 8e 79 5a e7 45 6d cc  |.3)T.6.<..yZ.Em.|
+000000b0  c0 5f da 0a c1 13 56 b5  2d 8e 56 16 b4 ca 48 1d  |._....V.-.V...H.|
+000000c0  30 3f 58 c6 79 06 a2 c0  3f 6f 59 4a dc f0 09 5d  |0?X.y...?oYJ...]|
+000000d0  45 2a 23 4f ab 72 f4 4c  4d e0 05 44 7f 4c ab 25  |E*#O.r.LM..D.L.%|
+000000e0  6f 9c 6a c4 cf c0 bd 86  03 c1 b2 b2 12 4e c2 0b  |o.j..........N..|
+000000f0  3e 8d 06 89 bb 46 70 79  51 33 eb 0d be ed 6e 0e  |>....FpyQ3....n.|
+00000100  33 08 48 53 2a 2a fb da  13 61 da 21 df 8b 74 85  |3.HS**...a.!..t.|
+00000110  42 25 1f cf 7f 00 4c ca  80 9a 3d 25 07 da 22 bd  |B%....L...=%..".|
+00000120  17 47 75 e5 da 60 88 67  65 19 55 b6 05 fc 6d fa  |.Gu..`.ge.U...m.|
+00000130  9c 3d 19 fd 61 87 92 87  c5 95 80 06 d0 1a 71 7f  |.=..a.........q.|
+00000140  05 67 f3 f6 af da 35 1f  d1 49 63 49 89 28 d1 21  |.g....5..IcI.(.!|
+00000150  14 e0 06 14 14 83 a9 d9  86 21 68 0f 66 86 62 4d  |.........!h.f.bM|
+00000160  cc 7f 9e dc 79 fd eb 14  59 e7 cc bd 5c 29 86 4a  |....y...Y...\).J|
+00000170  5f 64 d2 7b 37 d1 72 4b  ae 5b 12 c3 0c b0 a6 8a  |_d.{7.rK.[......|
+00000180  99 e5 89 e7 9e 76 1e 85  fc b6 ae 4b fd 20 8b 6a  |.....v.....K. .j|
+00000190  7d 7d 2b ff 11 d4 82 f0  2a d7 d6 9e e7 48 6e 1c  |}}+.....*....Hn.|
+000001a0  1d 33 2b 31 af aa 67 a7  66 b0 47 10 b8 f7 b8 0e  |.3+1..g.f.G.....|
+000001b0  0c ef 09 93 0a 42 2b 68  c8 30 cf d6 d4 8c 23 71  |.....B+h.0....#q|
+000001c0  ef c3 bd f6 eb 74 b5 4e  1a 94 44 43 98 c8 ec b3  |.....t.N..DC....|
+000001d0  51 10 44 2c f3 ae 27 c7  f3 5c 63 74 a8 1c f8 ff  |Q.D,..'..\ct....|
+000001e0  a9 38 c2 7f b4 66 fd 3b  9d a7 9c 7a 93 fd a3 09  |.8...f.;...z....|
+000001f0  a6 51 c5 fd 6f 82 cc fb  d2 58 bf 6e be 0d f2 4e  |.Q..o....X.n...N|
+00000200  2c 8c 08 6f 25 ae 82 bf  b6 bf b7 71 44 b6 4f 90  |,..o%......qD.O.|
+00000210  2e 1d 4e 1d 62 19 ee c7  4b 47 08 af 14 e3 cd 43  |..N.b...KG.....C|
+00000220  fb 37 e0 d2 58 d7 03 7e  f6 81 74 e9 a8 33 a2 7f  |.7..X..~..t..3..|
+00000230  06 94 5a 74 63 15 e1 f9  95 d3 b5 d6 52 e4 a4 5f  |..Ztc.......R.._|
+00000240  7d 16 3d 6e c6 53 3c 45  f5 f3 bc 91 7d 48 55 58  |}.=n.S<E....}HUX|
+00000250  51 a2 8e fc e4 aa e0 24  0f 9c 0c fb d9 2f d9 5a  |Q......$...../.Z|
+00000260  b8 02 df e6 71 30 64 e7  27 f9 b4 bc 3b 3a 5d a0  |....q0d.'...;:].|
+00000270  dd 7a fe 15 81 1d c2 41  02 65 a8 68 1e 29 ea 3a  |.z.....A.e.h.).:|
+00000280  0e 6a 0e 3f bf 61 4f 5f  b9 ce 5d 60 8e 55 0e ef  |.j.?.aO_..]`.U..|
+00000290  26 b5 5a d2 c8 f2 94 fd  b4 5e da e8 14 47 64 d8  |&.Z......^...Gd.|
+000002a0  3e 5c 2d 70 5b 9e 3a 74  eb 80 63 fe 7a 2f ac bd  |>\-p[.:t..c.z/..|
+000002b0  4b 53 31 72 3d 20 89 60  8c 6e ce c7 07 d4 a9 6d  |KS1r= .`.n.....m|
+000002c0  28 76 a3 78 e0 ae 11 3f  31 e5 64 fe 35 39 d8 88  |(v.x...?1.d.59..|
+000002d0  40 eb d0 f2 df db 1b 16  3a 11 33 ce 7c 63 cd 34  |@.......:.3.|c.4|
+000002e0  17 8c a3 d5 d1 8f 34 21  a7 fa b3 8f f1 84 b0 06  |......4!........|
+000002f0  d1 83 15 ac 26 1b 68 74  16 03 03 00 bc d2 f0 3d  |....&.ht.......=|
+00000300  2b a9 8c 75 e9 24 7a e8  0a ec 11 d7 cf 08 8e 5d  |+..u.$z........]|
+00000310  00 13 51 7f 2e 7a 6c 4b  e2 35 c2 e0 9d c3 cb 79  |..Q..zlK.5.....y|
+00000320  8f ec 2b 21 8f 96 4d b8  b8 0c b7 d8 d1 7f dc 5b  |..+!..M........[|
+00000330  85 8b b9 54 ba f6 65 76  5f b4 99 20 47 52 d8 96  |...T..ev_.. GR..|
+00000340  ac 12 b0 84 77 9b 42 09  fe c4 cf b4 22 e3 e8 3c  |....w.B....."..<|
+00000350  a0 a0 e8 8e ab 61 0b 16  98 f3 bd ae 60 36 55 5a  |.....a......`6UZ|
+00000360  6b 85 8b 79 03 4f 65 15  83 06 45 eb c7 d9 de 41  |k..y.Oe...E....A|
+00000370  53 0f 1f 12 ef 13 33 cc  a6 fc 91 e4 7e a7 a3 31  |S.....3.....~..1|
+00000380  6f 40 f4 d3 0e 2c 22 de  72 64 0d cd e0 e8 ee 21  |o@...,".rd.....!|
+00000390  4b bd ef 53 78 9e 41 ce  04 96 3a 2f bc e7 41 6b  |K..Sx.A...:/..Ak|
+000003a0  e0 a8 9e 40 02 1b 09 ab  8b 37 4c 2b b4 bc e1 72  |...@.....7L+...r|
+000003b0  06 af 88 24 75 6d 10 3a  d5 16 03 03 00 14 8d 09  |...$um.:........|
+000003c0  7b 2e 7a 58 f8 1c 63 44  0a a9 c4 5d 9f 5c cc 73  |{.zX..cD...].\.s|
+000003d0  47 1a                                             |G.|
 >>> Flow 13 (client to server)
-00000000  16 03 03 00 35 67 14 4b  ca 21 7f d2 82 1d 2e b3  |....5g.K.!......|
-00000010  1a 82 ae 2d d9 d6 7c 76  94 78 d4 ec 0e 4d fe 5c  |...-..|v.x...M.\|
-00000020  d5 56 5e 6d 32 f4 a0 64  50 1e f6 e4 32 28 92 80  |.V^m2..dP...2(..|
-00000030  d4 15 1c d5 f6 52 fc ca  c0 e7 14 03 03 00 11 df  |.....R..........|
-00000040  9d f3 d1 64 92 92 7e 11  77 64 e5 67 01 33 49 17  |...d..~.wd.g.3I.|
-00000050  16 03 03 00 20 c8 0f d9  d2 c8 b7 d6 a5 ac 2c 33  |.... .........,3|
-00000060  f8 77 8f b1 df db 16 de  43 6c e6 5a eb a0 6e ff  |.w......Cl.Z..n.|
-00000070  be 1d 69 ab 30                                    |..i.0|
+00000000  16 03 03 00 35 e1 bc fd  92 30 16 7d 71 c5 fc 15  |....5....0.}q...|
+00000010  6f eb 98 2b 8c bb b6 d3  0b 6d 71 12 54 7d 08 a6  |o..+.....mq.T}..|
+00000020  f1 a0 5b 37 6b 8b b7 f9  d6 11 53 c9 2c a4 b2 d3  |..[7k.....S.,...|
+00000030  52 db 73 f4 75 3d 45 78  68 e5 14 03 03 00 11 51  |R.s.u=Exh......Q|
+00000040  52 83 7e bd 5f 63 51 a4  1e 78 06 3b f1 f9 f8 a3  |R.~._cQ..x.;....|
+00000050  16 03 03 00 20 44 02 6e  8f fe 3a 25 40 e5 63 29  |.... D.n..:%@.c)|
+00000060  51 ce 94 55 cb 16 5a 9e  0d ec a8 73 f9 e8 46 06  |Q..U..Z....s..F.|
+00000070  b5 98 7f c2 98                                    |.....|
 >>> Flow 14 (server to client)
-00000000  14 03 03 00 11 6e 2c 51  c5 dd fa 70 2a 34 e0 cc  |.....n,Q...p*4..|
-00000010  3c 9f b8 66 15 e6 16 03  03 00 20 78 02 96 c6 24  |<..f...... x...$|
-00000020  57 ca 4a 60 47 68 f6 5a  13 8b 3b ce 90 60 d2 e3  |W.J`Gh.Z..;..`..|
-00000030  1b d8 ab 1c df d4 5e c2  8d 5c 5b 17 03 03 00 19  |......^..\[.....|
-00000040  b7 15 fb 91 10 48 ae 25  0c cd 4f 06 fa 2a 59 49  |.....H.%..O..*YI|
-00000050  2f 18 5e 7e 36 1b 2e cb  3a                       |/.^~6...:|
+00000000  14 03 03 00 11 da c7 c6  7f 04 1e 65 7a cb 53 02  |...........ez.S.|
+00000010  57 f7 6c f5 3b ca 16 03  03 00 20 9e 0e 55 81 35  |W.l.;..... ..U.5|
+00000020  15 c9 22 94 be 1e f4 5e  1e 95 99 e5 ba 4a b6 1a  |.."....^.....J..|
+00000030  38 b5 31 25 85 4c a9 a8  39 fc 10 17 03 03 00 19  |8.1%.L..9.......|
+00000040  61 c9 ca 41 f7 9d 66 08  bd 30 42 b2 7f 56 a7 46  |a..A..f..0B..V.F|
+00000050  f4 23 18 30 c3 ec 96 cf  7f                       |.#.0.....|
 >>> Flow 15 (client to server)
-00000000  15 03 03 00 12 c3 ff f7  b3 dc d4 b3 f5 d4 7c a3  |..............|.|
-00000010  18 db 08 a2 50 ad 75                              |....P.u|
+00000000  15 03 03 00 12 3a 24 58  49 ca a4 b1 6e 58 f2 e1  |.....:$XI...nX..|
+00000010  df 3c c2 63 3d 59 e4                              |.<.c=Y.|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected
index 784bcef92e..898f5f2b9d 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiateTwiceRejected
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,241 +7,243 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 96 8a 79 30 8b  |....Y...U....y0.|
-00000010  13 f5 d3 1c 09 45 76 83  d7 2e e5 ad e3 ee e1 c4  |.....Ev.........|
-00000020  d4 b4 4c 37 93 cb 90 e1  9a 5e 52 20 fb 25 91 ea  |..L7.....^R .%..|
-00000030  1a 96 b6 fb 1f 0c a8 62  06 a0 fe 51 68 c0 fb a5  |.......b...Qh...|
-00000040  f1 05 28 02 be dc 87 31  e6 ff 90 1a cc a8 00 00  |..(....1........|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
-00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
-00000080  3f e2 5b ea a6 30 0d 06  09 2a 86 48 86 f7 0d 01  |?.[..0...*.H....|
-00000090  01 0b 05 00 30 1f 31 0b  30 09 06 03 55 04 0a 13  |....0.1.0...U...|
-000000a0  02 47 6f 31 10 30 0e 06  03 55 04 03 13 07 47 6f  |.Go1.0...U....Go|
-000000b0  20 52 6f 6f 74 30 1e 17  0d 31 36 30 31 30 31 30  | Root0...1601010|
-000000c0  30 30 30 30 30 5a 17 0d  32 35 30 31 30 31 30 30  |00000Z..25010100|
-000000d0  30 30 30 30 5a 30 1a 31  0b 30 09 06 03 55 04 0a  |0000Z0.1.0...U..|
-000000e0  13 02 47 6f 31 0b 30 09  06 03 55 04 03 13 02 47  |..Go1.0...U....G|
-000000f0  6f 30 81 9f 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |o0..0...*.H.....|
-00000100  01 05 00 03 81 8d 00 30  81 89 02 81 81 00 db 46  |.......0.......F|
-00000110  7d 93 2e 12 27 06 48 bc  06 28 21 ab 7e c4 b6 a2  |}...'.H..(!.~...|
-00000120  5d fe 1e 52 45 88 7a 36  47 a5 08 0d 92 42 5b c2  |]..RE.z6G....B[.|
-00000130  81 c0 be 97 79 98 40 fb  4f 6d 14 fd 2b 13 8b c2  |....y.@.Om..+...|
-00000140  a5 2e 67 d8 d4 09 9e d6  22 38 b7 4a 0b 74 73 2b  |..g....."8.J.ts+|
-00000150  c2 34 f1 d1 93 e5 96 d9  74 7b f3 58 9f 6c 61 3c  |.4......t{.X.la<|
-00000160  c0 b0 41 d4 d9 2b 2b 24  23 77 5b 1c 3b bd 75 5d  |..A..++$#w[.;.u]|
-00000170  ce 20 54 cf a1 63 87 1d  1e 24 c4 f3 1d 1a 50 8b  |. T..c...$....P.|
-00000180  aa b6 14 43 ed 97 a7 75  62 f4 14 c8 52 d7 02 03  |...C...ub...R...|
-00000190  01 00 01 a3 81 93 30 81  90 30 0e 06 03 55 1d 0f  |......0..0...U..|
-000001a0  01 01 ff 04 04 03 02 05  a0 30 1d 06 03 55 1d 25  |.........0...U.%|
-000001b0  04 16 30 14 06 08 2b 06  01 05 05 07 03 01 06 08  |..0...+.........|
-000001c0  2b 06 01 05 05 07 03 02  30 0c 06 03 55 1d 13 01  |+.......0...U...|
-000001d0  01 ff 04 02 30 00 30 19  06 03 55 1d 0e 04 12 04  |....0.0...U.....|
-000001e0  10 9f 91 16 1f 43 43 3e  49 a6 de 6d b6 80 d7 9f  |.....CC>I..m....|
-000001f0  60 30 1b 06 03 55 1d 23  04 14 30 12 80 10 48 13  |`0...U.#..0...H.|
-00000200  49 4d 13 7e 16 31 bb a3  01 d5 ac ab 6e 7b 30 19  |IM.~.1......n{0.|
-00000210  06 03 55 1d 11 04 12 30  10 82 0e 65 78 61 6d 70  |..U....0...examp|
-00000220  6c 65 2e 67 6f 6c 61 6e  67 30 0d 06 09 2a 86 48  |le.golang0...*.H|
-00000230  86 f7 0d 01 01 0b 05 00  03 81 81 00 9d 30 cc 40  |.............0.@|
-00000240  2b 5b 50 a0 61 cb ba e5  53 58 e1 ed 83 28 a9 58  |+[P.a...SX...(.X|
-00000250  1a a9 38 a4 95 a1 ac 31  5a 1a 84 66 3d 43 d3 2d  |..8....1Z..f=C.-|
-00000260  d9 0b f2 97 df d3 20 64  38 92 24 3a 00 bc cf 9c  |...... d8.$:....|
-00000270  7d b7 40 20 01 5f aa d3  16 61 09 a2 76 fd 13 c3  |}.@ ._...a..v...|
-00000280  cc e1 0c 5c ee b1 87 82  f1 6c 04 ed 73 bb b3 43  |...\.....l..s..C|
-00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
-000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
-000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 ad 8e 56 2a c0 d0 7c  |........ ..V*..||
-000002d0  e1 cb 6b 20 0b 3e 53 33  28 25 37 42 5b 13 3c d5  |..k .>S3(%7B[.<.|
-000002e0  26 98 9e 0f df 45 6d 27  67 08 04 00 80 72 49 21  |&....Em'g....rI!|
-000002f0  f0 02 02 a3 7c e1 2a 18  d0 d0 21 8e 50 17 ad 0c  |....|.*...!.P...|
-00000300  3c a2 6d 65 b5 cb bc 7f  9e 7d 7f e2 36 3d b6 c8  |<.me.....}..6=..|
-00000310  df 7e b9 28 ab 01 99 2a  68 a4 be 46 11 94 9f 8c  |.~.(...*h..F....|
-00000320  67 02 92 1e 3c 51 78 f3  7a 35 ed f4 bb 8b fe b3  |g...<Qx.z5......|
-00000330  8c 32 aa c1 05 4f 99 68  b0 8a 75 65 1d e6 d6 6a  |.2...O.h..ue...j|
-00000340  61 65 aa 00 01 6b 29 06  99 d4 5b c7 c3 d2 0c 17  |ae...k)...[.....|
-00000350  74 59 d4 ee 99 b8 ef 5b  53 ff 33 df 9e 05 49 4f  |tY.....[S.3...IO|
-00000360  31 c6 95 81 67 c2 52 8a  0c e9 6a 46 22 16 03 03  |1...g.R...jF"...|
-00000370  00 04 0e 00 00 00                                 |......|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 cc a3 9c c7 68  |....]...Y......h|
+00000010  f8 de 98 95 45 68 9f 10  2e ba 1f cf 81 a9 51 52  |....Eh........QR|
+00000020  14 b7 ed a8 36 5a 40 43  e8 e8 bb 20 9a 57 99 f3  |....6Z@C... .W..|
+00000030  a8 be d3 2a 86 8d b5 9b  af 91 83 13 00 33 5e 4e  |...*.........3^N|
+00000040  f3 1c 42 67 08 65 54 40  dc 88 fb 90 cc a8 00 00  |..Bg.eT@........|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
+00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
+00000080  00 e8 f0 9d 3f e2 5b ea  a6 30 0d 06 09 2a 86 48  |....?.[..0...*.H|
+00000090  86 f7 0d 01 01 0b 05 00  30 1f 31 0b 30 09 06 03  |........0.1.0...|
+000000a0  55 04 0a 13 02 47 6f 31  10 30 0e 06 03 55 04 03  |U....Go1.0...U..|
+000000b0  13 07 47 6f 20 52 6f 6f  74 30 1e 17 0d 31 36 30  |..Go Root0...160|
+000000c0  31 30 31 30 30 30 30 30  30 5a 17 0d 32 35 30 31  |101000000Z..2501|
+000000d0  30 31 30 30 30 30 30 30  5a 30 1a 31 0b 30 09 06  |01000000Z0.1.0..|
+000000e0  03 55 04 0a 13 02 47 6f  31 0b 30 09 06 03 55 04  |.U....Go1.0...U.|
+000000f0  03 13 02 47 6f 30 81 9f  30 0d 06 09 2a 86 48 86  |...Go0..0...*.H.|
+00000100  f7 0d 01 01 01 05 00 03  81 8d 00 30 81 89 02 81  |...........0....|
+00000110  81 00 db 46 7d 93 2e 12  27 06 48 bc 06 28 21 ab  |...F}...'.H..(!.|
+00000120  7e c4 b6 a2 5d fe 1e 52  45 88 7a 36 47 a5 08 0d  |~...]..RE.z6G...|
+00000130  92 42 5b c2 81 c0 be 97  79 98 40 fb 4f 6d 14 fd  |.B[.....y.@.Om..|
+00000140  2b 13 8b c2 a5 2e 67 d8  d4 09 9e d6 22 38 b7 4a  |+.....g....."8.J|
+00000150  0b 74 73 2b c2 34 f1 d1  93 e5 96 d9 74 7b f3 58  |.ts+.4......t{.X|
+00000160  9f 6c 61 3c c0 b0 41 d4  d9 2b 2b 24 23 77 5b 1c  |.la<..A..++$#w[.|
+00000170  3b bd 75 5d ce 20 54 cf  a1 63 87 1d 1e 24 c4 f3  |;.u]. T..c...$..|
+00000180  1d 1a 50 8b aa b6 14 43  ed 97 a7 75 62 f4 14 c8  |..P....C...ub...|
+00000190  52 d7 02 03 01 00 01 a3  81 93 30 81 90 30 0e 06  |R.........0..0..|
+000001a0  03 55 1d 0f 01 01 ff 04  04 03 02 05 a0 30 1d 06  |.U...........0..|
+000001b0  03 55 1d 25 04 16 30 14  06 08 2b 06 01 05 05 07  |.U.%..0...+.....|
+000001c0  03 01 06 08 2b 06 01 05  05 07 03 02 30 0c 06 03  |....+.......0...|
+000001d0  55 1d 13 01 01 ff 04 02  30 00 30 19 06 03 55 1d  |U.......0.0...U.|
+000001e0  0e 04 12 04 10 9f 91 16  1f 43 43 3e 49 a6 de 6d  |.........CC>I..m|
+000001f0  b6 80 d7 9f 60 30 1b 06  03 55 1d 23 04 14 30 12  |....`0...U.#..0.|
+00000200  80 10 48 13 49 4d 13 7e  16 31 bb a3 01 d5 ac ab  |..H.IM.~.1......|
+00000210  6e 7b 30 19 06 03 55 1d  11 04 12 30 10 82 0e 65  |n{0...U....0...e|
+00000220  78 61 6d 70 6c 65 2e 67  6f 6c 61 6e 67 30 0d 06  |xample.golang0..|
+00000230  09 2a 86 48 86 f7 0d 01  01 0b 05 00 03 81 81 00  |.*.H............|
+00000240  9d 30 cc 40 2b 5b 50 a0  61 cb ba e5 53 58 e1 ed  |.0.@+[P.a...SX..|
+00000250  83 28 a9 58 1a a9 38 a4  95 a1 ac 31 5a 1a 84 66  |.(.X..8....1Z..f|
+00000260  3d 43 d3 2d d9 0b f2 97  df d3 20 64 38 92 24 3a  |=C.-...... d8.$:|
+00000270  00 bc cf 9c 7d b7 40 20  01 5f aa d3 16 61 09 a2  |....}.@ ._...a..|
+00000280  76 fd 13 c3 cc e1 0c 5c  ee b1 87 82 f1 6c 04 ed  |v......\.....l..|
+00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
+000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
+000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 1e f7 67  |............ ..g|
+000002d0  0a a6 d0 af 27 2d 0d 36  24 23 a5 97 90 ef 75 4a  |....'-.6$#....uJ|
+000002e0  fc 0b 12 91 5d 92 bd bf  2d 7c 0c a2 06 08 04 00  |....]...-|......|
+000002f0  80 71 f3 c0 ff 7a 01 b2  15 21 06 ae a1 f8 fa b5  |.q...z...!......|
+00000300  19 f2 d0 f6 25 b2 7e 9f  f1 8a 1c a1 a8 5d 2a 0a  |....%.~......]*.|
+00000310  ec 42 5c f8 6e 8e 8d c9  38 53 d0 c2 f3 7d f3 c8  |.B\.n...8S...}..|
+00000320  12 f1 30 4b 7f 9a 9e 7c  f8 78 56 9c ff 11 fd 36  |..0K...|.xV....6|
+00000330  60 c9 3d b5 f7 6e 0f 7a  22 aa 3d a1 30 98 93 1d  |`.=..n.z".=.0...|
+00000340  7c 48 1f 79 24 cd a6 c2  d2 e8 f6 90 fe 19 6f 0d  ||H.y$.........o.|
+00000350  3a a6 65 35 8d 19 e4 3c  cb 3a 07 5e 62 57 3d 67  |:.e5...<.:.^bW=g|
+00000360  37 fa 23 26 0a 92 db 30  16 a8 37 3d d2 16 9d e4  |7.#&...0..7=....|
+00000370  a7 16 03 03 00 04 0e 00  00 00                    |..........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 b8 c8 5d  3d b8 b8 2b c7 06 94 ec  |.... ..]=..+....|
-00000040  cc 92 01 22 3d cd 38 d8  aa 9f 1f 18 ef a0 ee 59  |..."=.8........Y|
-00000050  c0 3b 04 56 49                                    |.;.VI|
+00000030  16 03 03 00 20 22 30 b4  cc f8 e7 83 e4 72 5a 41  |.... "0......rZA|
+00000040  39 fa 92 4e ef c5 bb 6b  6e ec d5 55 9d 2f 53 99  |9..N...kn..U./S.|
+00000050  72 b6 99 55 a6                                    |r..U.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 be 6c dd f4 ef  |.......... .l...|
-00000010  71 1d 9c a7 24 ef 74 81  c4 01 1e e0 ef ac 78 90  |q...$.t.......x.|
-00000020  4e 51 fd 8a ca 83 e7 57  95 07 fa                 |NQ.....W...|
+00000000  14 03 03 00 01 01 16 03  03 00 20 b7 be 6c 7a 7f  |.......... ..lz.|
+00000010  00 e7 aa 12 ca 2d 29 6f  eb f0 f1 5c 97 e5 d4 a2  |.....-)o...\....|
+00000020  08 ab e3 04 ba e4 4d 15  08 ef 86                 |......M....|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 35 96 43  38 06 49 b1 3f 01 ae 85  |.....5.C8.I.?...|
-00000010  1a ee 4b 2b fe c0 75 76  b6 4a b0                 |..K+..uv.J.|
+00000000  17 03 03 00 16 5f 25 54  0e dd 48 23 b4 d9 00 3f  |....._%T..H#...?|
+00000010  1f 43 46 8e 32 64 3b 6a  42 70 ec                 |.CF.2d;jBp.|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 14 df 6c d7  78 02 f5 a7 cb d8 2f fb  |......l.x...../.|
-00000010  04 dc 30 bc 28 51 f9 ec  b8                       |..0.(Q...|
+00000000  16 03 03 00 14 f7 db b2  a3 97 fd 00 16 52 c6 bf  |.............R..|
+00000010  57 78 21 37 02 02 ed 25  32                       |Wx!7...%2|
 >>> Flow 7 (client to server)
-00000000  16 03 03 01 16 8c 2a 91  5b 60 aa 44 e7 b7 7e b8  |......*.[`.D..~.|
-00000010  ee c2 3e f3 c4 2f 6a 75  8e 25 07 5a 5c 42 81 fd  |..>../ju.%.Z\B..|
-00000020  65 4c 2a fb a9 80 f0 ba  33 1b 06 a8 79 a8 15 8e  |eL*.....3...y...|
-00000030  3a c4 08 95 a5 23 f0 ba  fb 43 58 26 84 b5 9d 17  |:....#...CX&....|
-00000040  03 e5 e7 08 ce 8b 79 9c  5e fb c6 6e a6 b8 12 cf  |......y.^..n....|
-00000050  b9 6e 4a 2a 90 d0 6b 65  93 bf 41 31 25 7f 3a 7c  |.nJ*..ke..A1%.:||
-00000060  75 1f d6 4e 22 d3 90 7b  71 14 57 c6 b6 89 ef 79  |u..N"..{q.W....y|
-00000070  74 7e 63 79 b9 63 d6 ef  02 b7 54 4b 53 0e 7f 70  |t~cy.c....TKS..p|
-00000080  8a 34 b1 85 98 ae a7 05  b8 41 9d 49 a3 ca eb 7d  |.4.......A.I...}|
-00000090  8b 64 e7 5d ca 11 71 93  e0 ff 6e 43 37 b4 e9 ec  |.d.]..q...nC7...|
-000000a0  23 6f d6 c6 bc cb ef a2  0b d0 4b ba 4f 40 b0 4b  |#o........K.O@.K|
-000000b0  ec 57 cb 8a 10 ae fe cd  14 70 42 a0 b9 1c 81 f6  |.W.......pB.....|
-000000c0  d2 79 47 31 4a b8 aa ac  89 98 cf ae 4e 8f 3d 36  |.yG1J.......N.=6|
-000000d0  c5 41 0e d8 e6 f3 88 2a  19 e5 e7 71 e2 2f 32 93  |.A.....*...q./2.|
-000000e0  ae 05 95 25 8f ec 4e 10  25 7e 53 60 6e c2 f2 72  |...%..N.%~S`n..r|
-000000f0  fc 7a 69 c1 93 e9 b8 2e  94 f3 19 31 5b 23 7c fd  |.zi........1[#|.|
-00000100  04 5d 59 ca 00 cc 37 0b  05 0d 50 10 50 3f b0 86  |.]Y...7...P.P?..|
-00000110  84 d4 fc 6a 0a 94 dc ba  88 fe ad                 |...j.......|
+00000000  16 03 03 01 1a 9e a2 a0  cc d3 e9 25 e7 3c 11 9b  |...........%.<..|
+00000010  ab c4 a1 eb 5a 4a 5d c1  38 74 7e dc 8b 4c 1d 41  |....ZJ].8t~..L.A|
+00000020  69 18 a6 b8 4c 67 3f 5b  90 50 ed f4 ab 34 ad 77  |i...Lg?[.P...4.w|
+00000030  f6 28 f3 5b c9 db 16 ca  89 19 7c 90 f3 27 9e 0b  |.(.[......|..'..|
+00000040  8c ca 7e 9e a4 9e 2c ba  22 9e 85 be 8e ba 58 c7  |..~...,.".....X.|
+00000050  c2 a3 da a2 55 ca 64 04  53 a5 92 43 8f 52 c0 63  |....U.d.S..C.R.c|
+00000060  b5 9b 6d eb 0e 09 2e 0f  42 a7 c5 72 87 34 c2 d2  |..m.....B..r.4..|
+00000070  9f 32 ce 25 58 be 94 21  4b d3 3b d8 9b 42 68 e3  |.2.%X..!K.;..Bh.|
+00000080  27 75 a3 15 57 8b cf e0  a8 ac 23 94 8e 4a b0 92  |'u..W.....#..J..|
+00000090  96 6f e4 a1 62 7d 24 67  92 b9 8a ec 76 1e bd ed  |.o..b}$g....v...|
+000000a0  1e 05 d9 c1 03 6c 6a 43  f6 22 8d bb c6 c0 58 7e  |.....ljC."....X~|
+000000b0  8e 49 f8 ef 9a 72 7c 3f  1b ff 98 fa 88 f4 ec b5  |.I...r|?........|
+000000c0  47 b1 29 19 c8 85 98 86  bd 75 9a bc ad 02 30 41  |G.)......u....0A|
+000000d0  21 e8 8f c1 69 d9 e0 b9  c2 b8 d7 91 8a 13 5b b5  |!...i.........[.|
+000000e0  7f 9a df 12 2e 61 4c 54  b1 ca 12 dd bf 83 0b e7  |.....aLT........|
+000000f0  68 fe 90 d9 2c 9c 86 9f  0e 57 19 e1 ba e5 2e c4  |h...,....W......|
+00000100  f0 c4 b4 dd e5 0f 36 98  0f 94 26 cb 92 32 03 57  |......6...&..2.W|
+00000110  78 15 19 3d bc 1e dd d1  46 28 24 06 c5 3d ed     |x..=....F($..=.|
 >>> Flow 8 (server to client)
-00000000  16 03 03 00 81 41 25 27  5b 76 24 a0 4f f0 bf ca  |.....A%'[v$.O...|
-00000010  c4 4f f8 7c c6 e8 2a d4  d1 ed f1 b8 34 84 d6 d5  |.O.|..*.....4...|
-00000020  93 20 70 7d 8e 75 c5 16  a8 ff 5c e6 de 16 ea 96  |. p}.u....\.....|
-00000030  3f 86 3b bd 6d fa 96 3d  27 18 34 b8 18 86 ee 65  |?.;.m..='.4....e|
-00000040  7f f2 cc 7a b9 f8 2e 5a  32 f3 16 e2 a2 27 fd 4b  |...z...Z2....'.K|
-00000050  31 19 e6 81 d9 ef 02 10  ac b6 55 d3 0b e2 b0 09  |1.........U.....|
-00000060  56 ea 50 5a 96 b3 ff 07  78 48 df 77 3f 15 c9 ff  |V.PZ....xH.w?...|
-00000070  a7 24 af 28 ec 99 1a c9  36 09 16 9c 7c 5a c0 85  |.$.(....6...|Z..|
-00000080  7c 93 e4 61 2e 5b 16 03  03 02 69 ef 17 31 d5 9c  ||..a.[....i..1..|
-00000090  bc 09 f9 b7 75 e2 c8 ea  93 6f b7 49 e3 0e af bb  |....u....o.I....|
-000000a0  84 d6 3b 20 e2 89 13 6f  7a d1 73 a7 cb d5 03 b2  |..; ...oz.s.....|
-000000b0  20 40 40 76 d9 5d 3b 23  cb 48 ba 3c 1b e7 5d de  | @@v.];#.H.<..].|
-000000c0  16 be 82 91 39 d0 b4 83  3e 4c b8 a0 66 56 47 6c  |....9...>L..fVGl|
-000000d0  08 03 b1 0f be 3f d3 5e  7e b4 40 db db 5b ce 61  |.....?.^~.@..[.a|
-000000e0  d9 dc 02 7d ea df ea 43  08 2c b0 1c af 76 8f d3  |...}...C.,...v..|
-000000f0  cd af 51 cd 17 df 70 58  90 bd 83 aa 4b e5 fe cd  |..Q...pX....K...|
-00000100  90 30 e0 b5 d0 95 49 c2  10 06 8c 5a dd a2 37 ad  |.0....I....Z..7.|
-00000110  d5 d1 0e 73 c7 92 a9 ab  67 51 da 9d a4 62 6d a6  |...s....gQ...bm.|
-00000120  d7 89 22 2b 97 59 ad 02  65 e9 1d 48 44 07 c9 c0  |.."+.Y..e..HD...|
-00000130  c4 1f 7f da 64 0c 35 19  16 b3 70 41 d8 61 c3 47  |....d.5...pA.a.G|
-00000140  59 4d c2 e6 07 86 55 92  b9 98 8e 5c 86 d2 d5 51  |YM....U....\...Q|
-00000150  6a 50 19 99 75 0a cf 6e  49 cc 8a 76 b5 2b 20 48  |jP..u..nI..v.+ H|
-00000160  2b 11 d4 54 a2 ea 98 ce  d8 56 22 c8 f8 eb e5 25  |+..T.....V"....%|
-00000170  c8 cf ec 86 95 09 51 7e  18 89 bb 8f d4 66 b8 44  |......Q~.....f.D|
-00000180  c2 78 f4 4d ad eb 2d 79  f8 f6 02 4f d2 35 d4 71  |.x.M..-y...O.5.q|
-00000190  b3 ae e6 7d f6 45 6c 99  07 57 3c 01 bb c1 fb f1  |...}.El..W<.....|
-000001a0  1a ac ba 92 b6 60 52 63  8b 21 eb bf 77 02 c6 29  |.....`Rc.!..w..)|
-000001b0  7f 10 f7 11 ac a2 90 a9  8b 47 da c1 2c 41 c9 da  |.........G..,A..|
-000001c0  3f 18 ab be f0 eb 20 98  80 c6 d2 14 9e 8e d3 41  |?..... ........A|
-000001d0  c3 37 ab 12 5b cc d0 25  bd af 16 49 4e 89 a1 92  |.7..[..%...IN...|
-000001e0  d1 09 49 59 dc cf f8 6c  73 02 cb 72 6d 28 6e 28  |..IY...ls..rm(n(|
-000001f0  c5 a8 84 20 e6 f8 1b ad  c1 6c 8f b0 30 b2 49 84  |... .....l..0.I.|
-00000200  22 42 7d ec e1 c7 ab 29  de 1c 84 1f cf 59 c6 80  |"B}....).....Y..|
-00000210  7e 13 13 d7 c5 e5 f2 e0  3b 9d 81 c9 3f 86 21 27  |~.......;...?.!'|
-00000220  d7 c8 45 c1 25 f6 19 8d  0a f6 e9 5a 9b d5 64 a1  |..E.%......Z..d.|
-00000230  e4 6d fe 6a cf d1 c3 1b  d4 ea d9 1f 6b dc f9 a7  |.m.j........k...|
-00000240  e9 d2 6c 31 19 db e1 f4  f8 82 6e 8b da fd b1 fd  |..l1......n.....|
-00000250  0a 56 84 73 db 25 5f bb  12 61 70 de 67 34 28 1c  |.V.s.%_..ap.g4(.|
-00000260  c3 e6 eb 81 c8 94 55 ca  52 25 e8 72 bf a1 c5 88  |......U.R%.r....|
-00000270  b8 ce 72 8d 64 6c 38 d9  19 07 f3 51 51 91 84 f2  |..r.dl8....QQ...|
-00000280  c4 76 7f 8b 57 09 71 94  38 aa f1 64 51 6f 62 50  |.v..W.q.8..dQobP|
-00000290  c8 50 68 82 b9 54 b1 28  54 99 21 26 7d 75 c7 c7  |.Ph..T.(T.!&}u..|
-000002a0  79 e7 65 93 72 a4 39 2d  4c ec ba b2 4c 92 ae ee  |y.e.r.9-L...L...|
-000002b0  34 a2 22 2f f9 b9 75 a9  27 77 63 2d ac 27 87 ce  |4."/..u.'wc-.'..|
-000002c0  ee 37 c0 c7 c1 b6 4c 13  d7 78 97 64 dc af ea 0d  |.7....L..x.d....|
-000002d0  7c 12 0e 7b 0b 26 77 01  e4 1c 24 e8 9f fc 19 2f  ||..{.&w...$..../|
-000002e0  46 a2 81 3d 0d c7 16 7e  49 25 b4 c1 0f 0a 71 05  |F..=...~I%....q.|
-000002f0  25 eb 53 e4 16 03 03 00  bc 0b 79 2d c6 0a 63 68  |%.S.......y-..ch|
-00000300  f0 21 37 d0 42 4a 0f 2f  7d 2f a0 7d 3d c3 94 c4  |.!7.BJ./}/.}=...|
-00000310  36 f5 a6 db e1 ad 0f 94  07 67 57 54 d4 57 86 50  |6........gWT.W.P|
-00000320  a2 e1 78 09 f2 e3 7b bc  6d 1b c0 fe 16 eb d3 ef  |..x...{.m.......|
-00000330  fb ec 22 44 ee 2f 78 99  84 e2 c1 4c f7 0d 4f bc  |.."D./x....L..O.|
-00000340  ca 57 be de 5f 52 08 33  b0 e1 1d 7b 45 9e 5d 17  |.W.._R.3...{E.].|
-00000350  41 2c 10 43 44 18 84 38  f3 0b 6a a1 76 bf 75 c9  |A,.CD..8..j.v.u.|
-00000360  56 b2 53 4c 98 39 c0 6f  30 13 96 8a 27 59 12 03  |V.SL.9.o0...'Y..|
-00000370  60 64 ce 28 54 c0 03 f4  c4 d1 df 94 e3 6e 43 61  |`d.(T........nCa|
-00000380  fa 43 40 e5 05 3b 26 dc  c4 41 bd 73 c3 9e a0 db  |.C@..;&..A.s....|
-00000390  fb c9 50 b4 4a d9 2d 71  cf e8 ff 3d 17 9e 29 35  |..P.J.-q...=..)5|
-000003a0  61 6c ab 11 ac 21 fa 90  6b 75 1f 0a 9d 30 3f 13  |al...!..ku...0?.|
-000003b0  fa c3 97 7a 74 16 03 03  00 4a 3d ca 3b 3d c8 6f  |...zt....J=.;=.o|
-000003c0  44 4e 53 3d 05 27 97 aa  bd 58 33 d6 ad 4a 34 71  |DNS=.'...X3..J4q|
-000003d0  22 d9 36 96 17 a5 ba 6b  b3 20 2e da 64 65 14 c7  |".6....k. ..de..|
-000003e0  6a c7 07 39 55 db bb ad  e2 49 84 09 5e 78 88 b5  |j..9U....I..^x..|
-000003f0  4b d5 23 fa 17 c5 f2 b8  2a c6 e5 1e 15 47 01 36  |K.#.....*....G.6|
-00000400  ef 7f 0a 14 16 03 03 00  14 28 e3 58 7e b9 36 d6  |.........(.X~.6.|
-00000410  ef 65 c8 bc fb 10 57 3d  48 70 7f 68 7d           |.e....W=Hp.h}|
+00000000  16 03 03 00 85 90 29 5c  91 ed 28 4f 54 29 f4 e7  |......)\..(OT)..|
+00000010  b2 41 c9 38 5d ec 4a 38  22 0d a9 13 e9 65 fe 8c  |.A.8].J8"....e..|
+00000020  a4 e8 1a a0 6e 07 d2 4d  35 55 a7 65 92 cd da 75  |....n..M5U.e...u|
+00000030  ca 0e 61 e3 6a 83 a0 30  bb 03 2a 6a e8 f0 69 3f  |..a.j..0..*j..i?|
+00000040  95 8d 97 c3 1b ef 74 58  68 f0 88 82 16 96 62 0a  |......tXh.....b.|
+00000050  49 7f 5b ec ee a1 6b 14  f6 5b 17 88 80 f6 70 e2  |I.[...k..[....p.|
+00000060  d9 a3 3a dc 46 65 63 ec  37 aa b6 53 a8 13 f3 44  |..:.Fec.7..S...D|
+00000070  5b 16 bd 4b ce 03 da 6f  ba 2c 6a 5d 71 45 db 49  |[..K...o.,j]qE.I|
+00000080  1c 00 17 d5 d8 40 0a 14  bb e8 16 03 03 02 69 d3  |.....@........i.|
+00000090  cf e0 f6 ea fa 19 64 e9  af c4 47 2e 0d a5 14 20  |......d...G.... |
+000000a0  cd 7e 97 0d 45 16 85 34  e7 f0 ed c1 fe 3c 12 f2  |.~..E..4.....<..|
+000000b0  3f 2e f5 93 b0 95 f5 2c  cd b1 ab 4b 8b e7 0d af  |?......,...K....|
+000000c0  7d 99 41 1e 9e 9e 18 90  6c e3 35 15 0b 89 fe 0f  |}.A.....l.5.....|
+000000d0  2f a2 e5 5c 67 bd 07 54  af 23 f2 ab 59 de 71 a2  |/..\g..T.#..Y.q.|
+000000e0  5e 04 21 2c d9 da bf 3a  41 53 18 c8 c9 d5 82 ac  |^.!,...:AS......|
+000000f0  ba 31 25 fe e8 0f 94 c8  41 42 a0 43 d3 3f fb ea  |.1%.....AB.C.?..|
+00000100  0a b5 3f 66 ff da 49 a9  1b 20 f6 26 b3 48 4a 75  |..?f..I.. .&.HJu|
+00000110  3f 88 74 d9 54 71 af d1  05 e3 9d 32 41 08 b8 8f  |?.t.Tq.....2A...|
+00000120  a9 fb f9 dd 5a c0 10 23  0d 8c 60 33 c1 2e b5 57  |....Z..#..`3...W|
+00000130  dc 4c e2 95 82 be d0 39  10 f9 8c 48 62 df 11 f5  |.L.....9...Hb...|
+00000140  d8 be 5e 46 26 3b 44 3a  36 31 8c 53 4e c6 6e 65  |..^F&;D:61.SN.ne|
+00000150  28 e1 db 36 07 73 38 00  64 d6 ae fb 4e 35 a1 89  |(..6.s8.d...N5..|
+00000160  03 f7 f3 22 5e 7a 69 0b  6c fa c2 5a d3 b1 ba ad  |..."^zi.l..Z....|
+00000170  e8 af 1f 21 31 c6 9d be  24 5d 4a f4 c3 69 61 36  |...!1...$]J..ia6|
+00000180  8f ce 81 10 d4 99 82 94  66 53 f7 50 dd e3 d0 5a  |........fS.P...Z|
+00000190  ce 79 d8 0f 43 09 2a 2b  67 da 31 b5 0c ff c6 32  |.y..C.*+g.1....2|
+000001a0  13 a4 cd 26 1d 16 49 24  45 f8 24 40 12 ea 7a f1  |...&..I$E.$@..z.|
+000001b0  33 47 2d b7 1f 09 b4 fc  7e 00 dc 0d 3f a8 52 11  |3G-.....~...?.R.|
+000001c0  f6 03 b0 c0 87 e4 be f7  0c 2b 6a c9 e5 ef 00 62  |.........+j....b|
+000001d0  6d b6 b3 93 5f 60 08 f0  4f 3f be b7 8e 02 a8 c8  |m..._`..O?......|
+000001e0  5f 38 0a 6d c1 f3 4d df  49 b5 6d 31 80 d9 5b 81  |_8.m..M.I.m1..[.|
+000001f0  99 45 5d 43 cb 58 4e 28  5f 4f 6f e8 49 de cf ab  |.E]C.XN(_Oo.I...|
+00000200  2a ab 85 7a ef 9f 10 77  00 9e 38 99 57 25 14 40  |*..z...w..8.W%.@|
+00000210  47 46 4a 30 4e 6a 75 f0  51 de 37 a0 6f 9a e6 17  |GFJ0Nju.Q.7.o...|
+00000220  f5 6b 48 16 62 0d 38 2d  3f 99 ff 94 b3 e7 6e 5b  |.kH.b.8-?.....n[|
+00000230  3d 6f 15 5a e2 df c3 45  66 d6 52 1d a3 79 eb 01  |=o.Z...Ef.R..y..|
+00000240  94 3a 4f 30 2e 6b 30 82  8e 58 3b 9a fe c8 a1 a2  |.:O0.k0..X;.....|
+00000250  84 8b cd 0b 71 16 9e ea  81 23 b7 78 29 ba 5a 59  |....q....#.x).ZY|
+00000260  8c 89 60 8c f8 d4 a9 80  02 b9 fb 41 fc 21 3f 4a  |..`........A.!?J|
+00000270  0f b3 c1 13 eb 07 f9 a0  13 d1 aa 3d c3 83 1e 53  |...........=...S|
+00000280  b3 b6 f9 61 51 28 60 ab  1f 5e f0 f5 e4 94 43 c2  |...aQ(`..^....C.|
+00000290  fc 53 aa d7 a3 47 f0 2e  a0 e2 12 ee 21 c0 f6 81  |.S...G......!...|
+000002a0  cc 60 51 66 1b fc e9 f2  64 78 d3 b3 0c 96 6b b5  |.`Qf....dx....k.|
+000002b0  dc 22 7f d1 90 e9 ec ae  2f 50 81 b8 16 e7 07 83  |."....../P......|
+000002c0  db 75 8c b0 fd 63 a5 c9  b1 bc 01 08 e6 53 86 3c  |.u...c.......S.<|
+000002d0  fe 98 67 ef 7a 7a 0a 33  2c 0b d7 57 25 8f 9d d2  |..g.zz.3,..W%...|
+000002e0  ce ba 62 2c 81 f9 f9 87  6c a3 64 ba 32 34 23 02  |..b,....l.d.24#.|
+000002f0  97 d7 42 cf f2 04 a9 08  16 03 03 00 bc c2 93 00  |..B.............|
+00000300  26 dc ce 86 67 d7 7d 15  52 0e de 5c 2c 87 da 62  |&...g.}.R..\,..b|
+00000310  4a 4f f5 cf 95 b0 c0 df  09 4a 4f 59 01 04 4b 3b  |JO.......JOY..K;|
+00000320  db 90 f7 ec 64 5a 71 1a  34 6c 67 ff e6 88 b1 39  |....dZq.4lg....9|
+00000330  67 11 84 fc 30 26 16 00  2c 8e 0e e5 bd 3f d9 24  |g...0&..,....?.$|
+00000340  46 ad c9 71 bc 2a c0 09  11 32 36 38 38 91 8d 96  |F..q.*...2688...|
+00000350  73 e5 8b a4 b7 6e fb 80  fc 68 d5 a8 c7 ff 04 00  |s....n...h......|
+00000360  b8 31 e8 30 17 97 db 43  ba b3 d8 4e 9f 48 c6 4b  |.1.0...C...N.H.K|
+00000370  23 7a a0 cb 2f 68 db 02  f2 f0 df 38 8f 4c d8 a8  |#z../h.....8.L..|
+00000380  f5 27 e5 fe ca 10 2c 26  51 3c 37 07 14 66 93 9b  |.'....,&Q<7..f..|
+00000390  15 b0 c9 e2 f2 78 74 4d  c6 e4 42 79 ff f1 cf 9d  |.....xtM..By....|
+000003a0  a1 c6 a5 5b 7f 4d 85 b3  fb 2b 46 96 c9 49 99 b6  |...[.M...+F..I..|
+000003b0  08 58 8e 6f 95 1e 2e 6d  93 16 03 03 00 4a 55 ef  |.X.o...m.....JU.|
+000003c0  94 9b f2 d3 38 44 2c 39  17 07 2f 2c 76 0b c0 81  |....8D,9../,v...|
+000003d0  d4 0b 5c df cf c3 07 62  c8 dc 82 bb 92 04 84 76  |..\....b.......v|
+000003e0  e2 74 57 21 f6 7f ee 8f  5f c8 57 bd 97 c8 35 e7  |.tW!...._.W...5.|
+000003f0  25 12 00 4b 72 c0 de c4  9e 82 5a 4d bf 05 f9 ab  |%..Kr.....ZM....|
+00000400  b1 5c 2e 64 66 38 95 0a  16 03 03 00 14 35 f4 4d  |.\.df8.......5.M|
+00000410  20 b9 38 cb 40 3e 46 83  28 b0 c7 19 ba 83 6a cd  | .8.@>F.(.....j.|
+00000420  e4                                                |.|
 >>> Flow 9 (client to server)
-00000000  16 03 03 02 69 d8 c1 81  7e a9 d7 70 97 62 c7 68  |....i...~..p.b.h|
-00000010  df 02 01 9d cc dc 38 d0  d6 bb 48 03 1d 0b be 73  |......8...H....s|
-00000020  b3 1a 88 91 a0 1b 55 91  51 a5 d7 54 58 c4 ea 50  |......U.Q..TX..P|
-00000030  e5 67 b1 60 78 b6 e2 7f  d7 6c b4 76 d7 24 fd af  |.g.`x....l.v.$..|
-00000040  f6 68 90 8c de 71 cd 15  4f d0 c8 f6 ba 89 ce 05  |.h...q..O.......|
-00000050  be 35 e8 9e 7a 8b 8d 0d  23 d4 5a bd 3a 9e d0 bf  |.5..z...#.Z.:...|
-00000060  80 08 f5 ad 7d 84 f1 8a  16 de 97 6b b2 75 8e 49  |....}......k.u.I|
-00000070  0f d7 8b 10 57 f7 21 1f  c0 87 de 06 c5 ae ae dd  |....W.!.........|
-00000080  9c 22 92 a1 6c c7 46 8d  e2 be 43 32 9c be 47 6b  |."..l.F...C2..Gk|
-00000090  4d 2a 60 f0 b6 3a 09 16  d6 16 a1 92 4a 2d 2d 72  |M*`..:......J--r|
-000000a0  00 8f 40 7c 3e a9 61 be  35 c8 f8 48 b4 1c 90 61  |..@|>.a.5..H...a|
-000000b0  90 c5 aa f8 ae aa d4 8a  15 74 b2 5d aa 24 cf 45  |.........t.].$.E|
-000000c0  ef 02 bd 29 b9 50 b4 fe  83 05 fa 4a a5 82 10 28  |...).P.....J...(|
-000000d0  b7 ab c3 ca c3 65 bb 51  a4 7c ac 57 03 78 28 e3  |.....e.Q.|.W.x(.|
-000000e0  91 9f c1 ce 02 08 70 84  8c 11 1f ae 35 a5 06 12  |......p.....5...|
-000000f0  f8 78 5b 38 0a 11 c8 1c  2d 1b 0c 21 66 d9 41 b2  |.x[8....-..!f.A.|
-00000100  ed 66 3c 47 f2 dc ab c1  59 7d 65 df bb 80 37 1c  |.f<G....Y}e...7.|
-00000110  5e 9b 41 e1 1d 5f b5 24  e4 77 61 3b e8 36 93 03  |^.A.._.$.wa;.6..|
-00000120  6d 87 17 e9 d7 77 35 b1  83 a3 b9 80 4d 40 20 82  |m....w5.....M@ .|
-00000130  94 36 53 94 ad 6b b3 ad  0a 70 fd 11 ce 81 56 ca  |.6S..k...p....V.|
-00000140  c2 5d 16 69 e3 59 7e 37  3b cd f3 54 1e b8 5e 1a  |.].i.Y~7;..T..^.|
-00000150  64 3f bf c6 ba ff fa b5  bf 4b c2 8e 5a 4d 43 1f  |d?.......K..ZMC.|
-00000160  8e 50 bc 7a 82 13 c7 25  aa b4 a8 97 45 49 12 25  |.P.z...%....EI.%|
-00000170  f5 4d 52 df 90 e5 74 0f  a0 d2 fd c3 6f bd 41 ed  |.MR...t.....o.A.|
-00000180  ff 78 e8 97 f2 e2 d1 5b  7c e6 27 01 16 27 1d b6  |.x.....[|.'..'..|
-00000190  8a cf c6 5b 8d b3 d8 8e  0c ee 2a d5 21 f6 4b d3  |...[......*.!.K.|
-000001a0  5a 74 7e 3d c6 fb 0e 35  97 de e7 52 c0 b2 c3 37  |Zt~=...5...R...7|
-000001b0  94 28 41 e0 3b 65 56 f1  4f 60 03 48 88 1d db fc  |.(A.;eV.O`.H....|
-000001c0  60 9f 33 e1 4d 37 eb 22  36 b2 76 ae 1c 3d 1c 5e  |`.3.M7."6.v..=.^|
-000001d0  3a c5 5b 00 eb 72 8b 54  ba 76 d1 71 77 5f 76 54  |:.[..r.T.v.qw_vT|
-000001e0  5f fd 0e d1 3a 50 ad b1  55 4a db 6d bf 2f 33 90  |_...:P..UJ.m./3.|
-000001f0  fc 42 de cd e4 a9 dd 11  25 d1 9f 56 1e 8a 2b 5c  |.B......%..V..+\|
-00000200  6c ed e7 51 84 42 6b ab  7d 77 b4 95 c3 75 b3 24  |l..Q.Bk.}w...u.$|
-00000210  ce 70 b0 e1 63 7f ec b0  ea 6a a4 a1 d5 e8 3e 96  |.p..c....j....>.|
-00000220  65 99 40 46 73 c8 e1 6e  86 65 92 bf 3d 92 a3 4f  |e.@Fs..n.e..=..O|
-00000230  37 6d bb 80 33 a5 7d aa  d3 a9 37 77 a6 4e 5b d6  |7m..3.}...7w.N[.|
-00000240  f3 f9 b2 42 75 18 1f 5a  58 f3 08 35 bc f4 2b 93  |...Bu..ZX..5..+.|
-00000250  62 0b 8a 83 f9 44 d0 e1  1a 44 b2 66 45 6f de b3  |b....D...D.fEo..|
-00000260  d2 ec 34 ac 15 89 76 b4  da dd 95 ca 44 5b 16 03  |..4...v.....D[..|
-00000270  03 00 35 39 e8 06 21 47  85 b5 53 96 03 0b 08 3b  |..59..!G..S....;|
-00000280  d2 9d 55 1f 23 4f 3a c0  be 4f e0 e0 0a f1 65 6f  |..U.#O:..O....eo|
-00000290  78 22 c4 10 6b d0 96 dc  04 78 e8 d3 95 f6 9a 78  |x"..k....x.....x|
-000002a0  09 f2 42 d3 79 57 99 c4  16 03 03 00 98 37 6b 75  |..B.yW.......7ku|
-000002b0  79 17 fa 67 7f 94 2e aa  88 61 91 97 dc 10 1e e6  |y..g.....a......|
-000002c0  6d 6d fa d5 64 17 f4 ec  ba 01 43 99 88 e2 a7 13  |mm..d.....C.....|
-000002d0  e0 9e 6a e9 97 c7 b3 ec  b9 c9 72 51 3d 01 eb c0  |..j.......rQ=...|
-000002e0  03 0f 08 48 90 27 36 6b  bd e7 0d 4e 41 6a ef 11  |...H.'6k...NAj..|
-000002f0  42 5b ae d1 16 ec 8f b7  47 a2 f5 b4 6a d4 32 bb  |B[......G...j.2.|
-00000300  0c cc 4f 2a e0 be 44 47  c8 77 09 f5 78 4b d6 ec  |..O*..DG.w..xK..|
-00000310  87 95 dc e1 74 75 54 af  45 bb 7a f5 2e f7 ac 3d  |....tuT.E.z....=|
-00000320  d1 b2 31 5a c0 24 c7 7c  25 36 62 a7 48 73 66 44  |..1Z.$.|%6b.HsfD|
-00000330  c1 78 47 f3 48 c5 a0 f7  66 3e 78 27 2c 3c dc 83  |.xG.H...f>x',<..|
-00000340  f5 6c e1 09 31 14 03 03  00 11 79 32 99 fd 2d 8d  |.l..1.....y2..-.|
-00000350  14 33 fd 1b 1b a8 3d 99  4b 0a b7 16 03 03 00 20  |.3....=.K...... |
-00000360  76 25 53 83 f2 c5 bf a6  fa 2e d3 5a 62 67 5b 1d  |v%S........Zbg[.|
-00000370  23 9a 9c b3 16 01 3f 6a  e9 4c ea e1 d4 d1 09 42  |#.....?j.L.....B|
+00000000  16 03 03 02 69 6d 51 fa  86 0f dd 19 19 7a e9 f5  |....imQ......z..|
+00000010  40 f7 4f 7a 10 c0 33 01  b8 14 32 92 7b 92 e0 c0  |@.Oz..3...2.{...|
+00000020  04 84 cf 1c d8 15 2a be  12 0b 65 15 f2 bc 96 cf  |......*...e.....|
+00000030  9e d7 eb 5a f6 06 ee b0  8e e4 fc b9 c6 d6 81 52  |...Z...........R|
+00000040  c1 4c a9 d7 33 a1 f8 b6  cd 79 eb 7d 44 5a 99 c0  |.L..3....y.}DZ..|
+00000050  5b 8b 9d 8c 93 53 b6 27  f2 a0 e2 7a a2 66 de 3f  |[....S.'...z.f.?|
+00000060  65 0d 13 14 09 8b 1c 2a  85 7d 24 26 9a 64 b2 d1  |e......*.}$&.d..|
+00000070  7c 10 ce b2 1e 86 df f1  a8 2c 2a 47 ae fe fe 1c  ||........,*G....|
+00000080  23 14 eb 78 40 bf 88 25  db 1a 7e 60 4d 3e b8 cb  |#..x@..%..~`M>..|
+00000090  7d 3c 2f d1 a7 6b 22 ee  99 21 88 50 d7 2d 06 2d  |}</..k"..!.P.-.-|
+000000a0  08 2e c3 c1 56 44 9f 3f  aa 29 f8 1c aa c6 2c e2  |....VD.?.)....,.|
+000000b0  ad 61 b2 7f 4f 3a 14 e7  cc 0f 0e e9 b1 5a 0b af  |.a..O:.......Z..|
+000000c0  28 60 18 50 4d 98 07 5e  69 04 af c1 5b fa b5 ab  |(`.PM..^i...[...|
+000000d0  16 24 68 b0 48 8b 34 b0  25 bd 8f 92 76 b2 44 06  |.$h.H.4.%...v.D.|
+000000e0  02 53 de 34 82 ff c6 bc  ea f5 c6 41 e4 24 08 82  |.S.4.......A.$..|
+000000f0  b7 3a 02 97 11 c4 07 6b  51 9b 70 d1 7c 77 d4 23  |.:.....kQ.p.|w.#|
+00000100  80 6b 6e c7 68 60 f8 4c  6d bc 11 1e d2 40 38 c3  |.kn.h`.Lm....@8.|
+00000110  ff db d1 2e bf 9b 30 86  45 5a 23 8c 01 9f 05 68  |......0.EZ#....h|
+00000120  2e 54 4e 2d c3 f0 5c 8c  94 27 6a 9e 3a df 35 0a  |.TN-..\..'j.:.5.|
+00000130  f9 20 8a cc ef 0f cc b8  ca d0 8e 1e 8d 24 a4 12  |. ...........$..|
+00000140  d1 e6 12 80 b9 3d c5 fc  3a 08 41 ef ff 0b 0a c7  |.....=..:.A.....|
+00000150  3c 7d a7 4a 8c c2 39 33  f1 3f b9 b9 55 ae f2 c0  |<}.J..93.?..U...|
+00000160  7a 26 80 c5 a8 00 6a 53  de 0f 7b e1 62 05 26 7b  |z&....jS..{.b.&{|
+00000170  f5 bd dc 4c ec 6e b3 01  66 6b bd c6 f3 12 72 39  |...L.n..fk....r9|
+00000180  03 6c ac ac b4 26 82 b3  4b 7b e2 9d c3 ea 27 c1  |.l...&..K{....'.|
+00000190  e9 98 9d 21 c6 50 1a f0  a2 2d 8b cb 24 3d 68 ce  |...!.P...-..$=h.|
+000001a0  3e 9c 74 03 9c 4e 17 25  c2 af d8 e3 04 37 56 d5  |>.t..N.%.....7V.|
+000001b0  fc 69 fe ad 75 67 34 7b  ac e4 4f d5 82 b9 36 3e  |.i..ug4{..O...6>|
+000001c0  74 51 a5 32 3b 77 27 15  22 d8 8b c9 ad a6 98 5b  |tQ.2;w'."......[|
+000001d0  c5 4e 8d 62 bf ef 2d 41  b8 6d 5b 09 13 b3 40 ea  |.N.b..-A.m[...@.|
+000001e0  19 c4 08 78 e3 c1 a1 5e  05 a3 79 6a 27 d5 41 3e  |...x...^..yj'.A>|
+000001f0  c5 a6 f4 20 4c 93 92 77  c5 4a e8 1f f5 4b 83 87  |... L..w.J...K..|
+00000200  66 40 c2 c1 aa 89 69 00  5b fb 54 94 1f b7 39 cd  |f@....i.[.T...9.|
+00000210  cd 9b 53 ad 08 63 30 05  e4 72 33 f0 ba b9 9d d9  |..S..c0..r3.....|
+00000220  d1 fe c3 fc de 07 a2 a3  b2 85 0b 33 4a bd 54 77  |...........3J.Tw|
+00000230  53 7c 8e 70 ed 9f ae 9d  2f 56 19 ce d6 1b 7a 64  |S|.p..../V....zd|
+00000240  80 72 bc 86 b7 1a d6 5b  ac a2 0c b2 c4 fa 79 f2  |.r.....[......y.|
+00000250  16 7f 06 01 47 d3 f3 9b  4b 24 e2 f7 6b 33 45 4e  |....G...K$..k3EN|
+00000260  b0 84 f8 f6 4d b4 4a 3f  37 20 49 77 ff 6f 16 03  |....M.J?7 Iw.o..|
+00000270  03 00 35 3b d6 d8 46 3a  93 f9 f4 29 b3 b7 9c cf  |..5;..F:...)....|
+00000280  b9 2d 90 58 78 91 ee d5  30 bd 59 e2 5a 1f 30 8c  |.-.Xx...0.Y.Z.0.|
+00000290  6e f9 1e d8 64 85 aa 1c  8b 41 10 07 d5 b2 7d 55  |n...d....A....}U|
+000002a0  13 73 ad 0e 2d e0 d4 ff  16 03 03 00 98 75 4a 72  |.s..-........uJr|
+000002b0  0f 07 ff 07 e3 80 96 7d  c6 1b ab b8 c4 fc 38 0f  |.......}......8.|
+000002c0  f6 f8 f9 06 95 d4 7b 93  85 0f b3 34 11 cd 70 6f  |......{....4..po|
+000002d0  9b 3b a3 33 e5 fe e7 6a  df 4b 02 e1 91 18 f3 e2  |.;.3...j.K......|
+000002e0  3e d0 7c e4 95 c2 e7 ef  dc 20 c3 6b b7 9e 1d 9a  |>.|...... .k....|
+000002f0  8c 23 c7 22 91 e7 7d 17  e4 5e 02 39 c3 6a b3 46  |.#."..}..^.9.j.F|
+00000300  31 32 4a 8b 7b 0a 4a f4  51 ba a7 01 58 a9 bc 52  |12J.{.J.Q...X..R|
+00000310  64 a9 e2 93 ad 34 c8 16  ad 66 67 e3 e7 3c 2c 66  |d....4...fg..<,f|
+00000320  59 e8 df f7 cf 96 00 57  85 63 f1 4b 45 c6 8a e7  |Y......W.c.KE...|
+00000330  54 9f 22 0c 74 2e 0c 1a  cb df d0 98 55 bc d1 fd  |T.".t.......U...|
+00000340  2a e2 73 eb 1b 14 03 03  00 11 02 c8 fe cd 2a 0d  |*.s...........*.|
+00000350  c2 35 3c ff dd 23 e7 15  bf fe a0 16 03 03 00 20  |.5<..#......... |
+00000360  7b ea 15 d3 2d 51 57 39  76 4b ef 16 0d 19 5d e0  |{...-QW9vK....].|
+00000370  22 5e 68 19 c9 94 7e e9  67 41 12 85 2c e2 7c b8  |"^h...~.gA..,.|.|
 >>> Flow 10 (server to client)
-00000000  14 03 03 00 11 a7 38 2a  4e 04 a5 b7 df d6 05 bb  |......8*N.......|
-00000010  b5 93 38 bc 9e 62 16 03  03 00 20 f3 d3 e1 7d 80  |..8..b.... ...}.|
-00000020  41 ce 05 99 92 c7 47 fe  b5 08 3b 78 9d ae b0 5f  |A.....G...;x..._|
-00000030  2c ed bd 0b 90 e0 94 9e  0b b0 a5 17 03 03 00 19  |,...............|
-00000040  27 f0 6a 55 af 3f c1 82  85 1a 6b 28 e1 cd dc 59  |'.jU.?....k(...Y|
-00000050  43 be c7 18 16 30 08 b2  9e 16 03 03 00 14 c1 c5  |C....0..........|
-00000060  64 ef 72 4f 6c 96 f1 f6  5b 70 29 e4 59 36 0a cd  |d.rOl...[p).Y6..|
-00000070  d2 a3                                             |..|
+00000000  14 03 03 00 11 6b a1 f5  7f f5 64 ff 54 2a 67 95  |.....k....d.T*g.|
+00000010  f5 25 5b fe 38 39 16 03  03 00 20 be 49 c4 6c 7a  |.%[.89.... .I.lz|
+00000020  12 cf 16 5b 1c b3 14 53  79 3e 8d 01 85 75 91 1a  |...[...Sy>...u..|
+00000030  3a fe bc a9 c5 11 3f d5  88 4b 3e 17 03 03 00 19  |:.....?..K>.....|
+00000040  89 9c 38 5f 11 ba 1e 81  8a 09 ae 95 03 28 47 6c  |..8_.........(Gl|
+00000050  db 9b 38 9d e7 37 75 01  af 16 03 03 00 14 c3 86  |..8..7u.........|
+00000060  cd a6 a3 dd 62 c9 4b be  e5 2d 3f 31 a0 cc 87 f8  |....b.K..-?1....|
+00000070  78 61                                             |xa|
 >>> Flow 11 (client to server)
-00000000  15 03 03 00 12 af 73 0e  40 39 dd 1e 04 99 3e 10  |......s.@9....>.|
-00000010  c9 62 b3 78 77 9b 56 15  03 03 00 12 25 8b 87 29  |.b.xw.V.....%..)|
-00000020  82 d0 9f 5e 9a 27 bd c1  bf b7 a2 f0 92 ac        |...^.'........|
+00000000  15 03 03 00 12 35 45 94  25 9c 40 dd df 00 a9 13  |.....5E.%.@.....|
+00000010  f2 7c 47 63 98 22 c5 15  03 03 00 12 60 26 66 bb  |.|Gc."......`&f.|
+00000020  8b 92 9d da 32 e3 97 92  ae 89 a9 2a d0 9a        |....2......*..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected b/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected
index f7a7668a8f..8307ee39db 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected
+++ b/src/crypto/tls/testdata/Client-TLSv12-RenegotiationRejected
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,89 +7,90 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 a3 55 d2 e2 bd  |....Y...U...U...|
-00000010  94 8f 04 51 26 1c a6 61  b1 ed 05 e2 39 44 33 05  |...Q&..a....9D3.|
-00000020  79 14 b7 1f 89 1e bb ba  53 0d 12 20 09 29 6d 26  |y.......S.. .)m&|
-00000030  04 70 4a 5d 01 90 f2 c6  28 df 11 6a 64 23 ec 9e  |.pJ]....(..jd#..|
-00000040  9f 2b 15 33 dc 88 26 35  3a b0 86 92 cc a8 00 00  |.+.3..&5:.......|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
-00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
-00000080  3f e2 5b ea a6 30 0d 06  09 2a 86 48 86 f7 0d 01  |?.[..0...*.H....|
-00000090  01 0b 05 00 30 1f 31 0b  30 09 06 03 55 04 0a 13  |....0.1.0...U...|
-000000a0  02 47 6f 31 10 30 0e 06  03 55 04 03 13 07 47 6f  |.Go1.0...U....Go|
-000000b0  20 52 6f 6f 74 30 1e 17  0d 31 36 30 31 30 31 30  | Root0...1601010|
-000000c0  30 30 30 30 30 5a 17 0d  32 35 30 31 30 31 30 30  |00000Z..25010100|
-000000d0  30 30 30 30 5a 30 1a 31  0b 30 09 06 03 55 04 0a  |0000Z0.1.0...U..|
-000000e0  13 02 47 6f 31 0b 30 09  06 03 55 04 03 13 02 47  |..Go1.0...U....G|
-000000f0  6f 30 81 9f 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |o0..0...*.H.....|
-00000100  01 05 00 03 81 8d 00 30  81 89 02 81 81 00 db 46  |.......0.......F|
-00000110  7d 93 2e 12 27 06 48 bc  06 28 21 ab 7e c4 b6 a2  |}...'.H..(!.~...|
-00000120  5d fe 1e 52 45 88 7a 36  47 a5 08 0d 92 42 5b c2  |]..RE.z6G....B[.|
-00000130  81 c0 be 97 79 98 40 fb  4f 6d 14 fd 2b 13 8b c2  |....y.@.Om..+...|
-00000140  a5 2e 67 d8 d4 09 9e d6  22 38 b7 4a 0b 74 73 2b  |..g....."8.J.ts+|
-00000150  c2 34 f1 d1 93 e5 96 d9  74 7b f3 58 9f 6c 61 3c  |.4......t{.X.la<|
-00000160  c0 b0 41 d4 d9 2b 2b 24  23 77 5b 1c 3b bd 75 5d  |..A..++$#w[.;.u]|
-00000170  ce 20 54 cf a1 63 87 1d  1e 24 c4 f3 1d 1a 50 8b  |. T..c...$....P.|
-00000180  aa b6 14 43 ed 97 a7 75  62 f4 14 c8 52 d7 02 03  |...C...ub...R...|
-00000190  01 00 01 a3 81 93 30 81  90 30 0e 06 03 55 1d 0f  |......0..0...U..|
-000001a0  01 01 ff 04 04 03 02 05  a0 30 1d 06 03 55 1d 25  |.........0...U.%|
-000001b0  04 16 30 14 06 08 2b 06  01 05 05 07 03 01 06 08  |..0...+.........|
-000001c0  2b 06 01 05 05 07 03 02  30 0c 06 03 55 1d 13 01  |+.......0...U...|
-000001d0  01 ff 04 02 30 00 30 19  06 03 55 1d 0e 04 12 04  |....0.0...U.....|
-000001e0  10 9f 91 16 1f 43 43 3e  49 a6 de 6d b6 80 d7 9f  |.....CC>I..m....|
-000001f0  60 30 1b 06 03 55 1d 23  04 14 30 12 80 10 48 13  |`0...U.#..0...H.|
-00000200  49 4d 13 7e 16 31 bb a3  01 d5 ac ab 6e 7b 30 19  |IM.~.1......n{0.|
-00000210  06 03 55 1d 11 04 12 30  10 82 0e 65 78 61 6d 70  |..U....0...examp|
-00000220  6c 65 2e 67 6f 6c 61 6e  67 30 0d 06 09 2a 86 48  |le.golang0...*.H|
-00000230  86 f7 0d 01 01 0b 05 00  03 81 81 00 9d 30 cc 40  |.............0.@|
-00000240  2b 5b 50 a0 61 cb ba e5  53 58 e1 ed 83 28 a9 58  |+[P.a...SX...(.X|
-00000250  1a a9 38 a4 95 a1 ac 31  5a 1a 84 66 3d 43 d3 2d  |..8....1Z..f=C.-|
-00000260  d9 0b f2 97 df d3 20 64  38 92 24 3a 00 bc cf 9c  |...... d8.$:....|
-00000270  7d b7 40 20 01 5f aa d3  16 61 09 a2 76 fd 13 c3  |}.@ ._...a..v...|
-00000280  cc e1 0c 5c ee b1 87 82  f1 6c 04 ed 73 bb b3 43  |...\.....l..s..C|
-00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
-000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
-000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 43 6b 44 5b 79 c9 38  |........ CkD[y.8|
-000002d0  dc e4 ab fa 88 fa e6 06  89 b1 4e ff ab 8d d6 f7  |..........N.....|
-000002e0  21 b4 ff 9d a0 c8 54 cc  63 08 04 00 80 cd f4 d6  |!.....T.c.......|
-000002f0  c8 ad 03 e7 f0 e8 f4 c9  f0 e6 28 db cd 3b 7c bf  |..........(..;|.|
-00000300  05 af 3d fe c1 f9 f1 7a  ec 41 bf 1f a8 95 6d ee  |..=....z.A....m.|
-00000310  e6 92 cb c0 ff fd c1 ed  86 b0 59 45 3e 2d 1d 66  |..........YE>-.f|
-00000320  56 d1 9f e2 b7 79 ac aa  81 6d b0 42 36 96 80 4d  |V....y...m.B6..M|
-00000330  ca 36 29 1b 65 03 73 3f  85 ec 59 cb b4 a5 a0 c0  |.6).e.s?..Y.....|
-00000340  0c 16 ad e2 6b 35 3c ab  1e da 69 19 7d a2 63 a7  |....k5<...i.}.c.|
-00000350  69 2a d2 3f 12 17 bf 4c  ed 8a f7 75 fe ce d4 2b  |i*.?...L...u...+|
-00000360  4d 35 bf 65 d6 9e 01 69  a8 0a 73 26 34 16 03 03  |M5.e...i..s&4...|
-00000370  00 04 0e 00 00 00                                 |......|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 8a 1d c8 bd c6  |....]...Y.......|
+00000010  43 4c 78 5c 99 f4 8f e3  72 4b 73 a3 20 10 5b 8b  |CLx\....rKs. .[.|
+00000020  3e 04 7f 4c 5c 58 fb d5  ed c6 d9 20 ff 23 98 81  |>..L\X..... .#..|
+00000030  0a 7f d2 f4 ed ae 87 2e  ad e7 a9 60 31 b1 36 ab  |...........`1.6.|
+00000040  f4 b6 cc 98 a0 8b 62 ca  57 ed 58 87 cc a8 00 00  |......b.W.X.....|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
+00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
+00000080  00 e8 f0 9d 3f e2 5b ea  a6 30 0d 06 09 2a 86 48  |....?.[..0...*.H|
+00000090  86 f7 0d 01 01 0b 05 00  30 1f 31 0b 30 09 06 03  |........0.1.0...|
+000000a0  55 04 0a 13 02 47 6f 31  10 30 0e 06 03 55 04 03  |U....Go1.0...U..|
+000000b0  13 07 47 6f 20 52 6f 6f  74 30 1e 17 0d 31 36 30  |..Go Root0...160|
+000000c0  31 30 31 30 30 30 30 30  30 5a 17 0d 32 35 30 31  |101000000Z..2501|
+000000d0  30 31 30 30 30 30 30 30  5a 30 1a 31 0b 30 09 06  |01000000Z0.1.0..|
+000000e0  03 55 04 0a 13 02 47 6f  31 0b 30 09 06 03 55 04  |.U....Go1.0...U.|
+000000f0  03 13 02 47 6f 30 81 9f  30 0d 06 09 2a 86 48 86  |...Go0..0...*.H.|
+00000100  f7 0d 01 01 01 05 00 03  81 8d 00 30 81 89 02 81  |...........0....|
+00000110  81 00 db 46 7d 93 2e 12  27 06 48 bc 06 28 21 ab  |...F}...'.H..(!.|
+00000120  7e c4 b6 a2 5d fe 1e 52  45 88 7a 36 47 a5 08 0d  |~...]..RE.z6G...|
+00000130  92 42 5b c2 81 c0 be 97  79 98 40 fb 4f 6d 14 fd  |.B[.....y.@.Om..|
+00000140  2b 13 8b c2 a5 2e 67 d8  d4 09 9e d6 22 38 b7 4a  |+.....g....."8.J|
+00000150  0b 74 73 2b c2 34 f1 d1  93 e5 96 d9 74 7b f3 58  |.ts+.4......t{.X|
+00000160  9f 6c 61 3c c0 b0 41 d4  d9 2b 2b 24 23 77 5b 1c  |.la<..A..++$#w[.|
+00000170  3b bd 75 5d ce 20 54 cf  a1 63 87 1d 1e 24 c4 f3  |;.u]. T..c...$..|
+00000180  1d 1a 50 8b aa b6 14 43  ed 97 a7 75 62 f4 14 c8  |..P....C...ub...|
+00000190  52 d7 02 03 01 00 01 a3  81 93 30 81 90 30 0e 06  |R.........0..0..|
+000001a0  03 55 1d 0f 01 01 ff 04  04 03 02 05 a0 30 1d 06  |.U...........0..|
+000001b0  03 55 1d 25 04 16 30 14  06 08 2b 06 01 05 05 07  |.U.%..0...+.....|
+000001c0  03 01 06 08 2b 06 01 05  05 07 03 02 30 0c 06 03  |....+.......0...|
+000001d0  55 1d 13 01 01 ff 04 02  30 00 30 19 06 03 55 1d  |U.......0.0...U.|
+000001e0  0e 04 12 04 10 9f 91 16  1f 43 43 3e 49 a6 de 6d  |.........CC>I..m|
+000001f0  b6 80 d7 9f 60 30 1b 06  03 55 1d 23 04 14 30 12  |....`0...U.#..0.|
+00000200  80 10 48 13 49 4d 13 7e  16 31 bb a3 01 d5 ac ab  |..H.IM.~.1......|
+00000210  6e 7b 30 19 06 03 55 1d  11 04 12 30 10 82 0e 65  |n{0...U....0...e|
+00000220  78 61 6d 70 6c 65 2e 67  6f 6c 61 6e 67 30 0d 06  |xample.golang0..|
+00000230  09 2a 86 48 86 f7 0d 01  01 0b 05 00 03 81 81 00  |.*.H............|
+00000240  9d 30 cc 40 2b 5b 50 a0  61 cb ba e5 53 58 e1 ed  |.0.@+[P.a...SX..|
+00000250  83 28 a9 58 1a a9 38 a4  95 a1 ac 31 5a 1a 84 66  |.(.X..8....1Z..f|
+00000260  3d 43 d3 2d d9 0b f2 97  df d3 20 64 38 92 24 3a  |=C.-...... d8.$:|
+00000270  00 bc cf 9c 7d b7 40 20  01 5f aa d3 16 61 09 a2  |....}.@ ._...a..|
+00000280  76 fd 13 c3 cc e1 0c 5c  ee b1 87 82 f1 6c 04 ed  |v......\.....l..|
+00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
+000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
+000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 ba 3a 8d  |............ .:.|
+000002d0  07 bd 2e fa bd 85 70 45  e9 b6 eb 1f 2c 15 a2 15  |......pE....,...|
+000002e0  d7 29 2c a9 a8 ec 46 b0  77 0a 49 c2 49 08 04 00  |.),...F.w.I.I...|
+000002f0  80 5c a8 eb 85 8d 5f 01  9f 19 b8 6b 9a 66 ed 07  |.\...._....k.f..|
+00000300  ad e9 2e 85 c1 b8 94 56  17 84 0d d4 14 7b e2 c1  |.......V.....{..|
+00000310  89 80 f5 92 31 a0 90 6f  59 fb e7 af a9 e9 6d f3  |....1..oY.....m.|
+00000320  72 aa aa e5 d9 4c d9 ac  bb 05 ac 51 e2 3f 64 05  |r....L.....Q.?d.|
+00000330  e8 e4 fd 80 b3 b9 6f 54  91 13 72 8d 45 ea 0f 13  |......oT..r.E...|
+00000340  f7 22 19 92 ce 66 fc d0  be af d3 8e 01 ef a5 7a  |."...f.........z|
+00000350  08 6e f3 f7 28 55 33 bf  e9 2a b6 60 d5 32 3f df  |.n..(U3..*.`.2?.|
+00000360  e7 df 11 21 e4 c5 6e 13  bb f7 ad c7 ca 2e 11 2e  |...!..n.........|
+00000370  22 16 03 03 00 04 0e 00  00 00                    |".........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 b8 d8 22  20 8d 69 23 05 34 eb 69  |.... .." .i#.4.i|
-00000040  92 a0 a9 6c cd 94 3b 72  49 91 72 8e 65 79 ca 62  |...l..;rI.r.ey.b|
-00000050  14 cf da 2e b6                                    |.....|
+00000030  16 03 03 00 20 46 20 45  1d b3 e5 62 1d 89 b7 67  |.... F E...b...g|
+00000040  23 76 0b f4 fb c3 fd 57  80 09 ee 69 e3 ad bb 42  |#v.....W...i...B|
+00000050  56 55 b6 6b 73                                    |VU.ks|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 31 25 d4 c7 92  |.......... 1%...|
-00000010  16 0b 92 2d a2 20 8b b2  c7 96 a6 b7 b6 b3 82 3a  |...-. .........:|
-00000020  4d a1 a8 96 29 fb 99 e9  ea 04 6c                 |M...).....l|
+00000000  14 03 03 00 01 01 16 03  03 00 20 69 d6 1d dd 67  |.......... i...g|
+00000010  bb 02 a5 41 a5 11 6d e2  54 9a e8 c7 e5 b5 60 b5  |...A..m.T.....`.|
+00000020  77 fb e6 61 22 c7 0d 2f  bb bf d4                 |w..a"../...|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 8b 92 f3  f8 99 bf a3 7c c4 03 d8  |............|...|
-00000010  4d e7 1b ad 50 e1 99 17  33 68 e2                 |M...P...3h.|
+00000000  17 03 03 00 16 bb a9 4d  d8 15 fc 1f 99 96 03 80  |.......M........|
+00000010  5e fc b5 f8 ac 14 10 82  f5 08 c6                 |^..........|
 >>> Flow 6 (server to client)
-00000000  16 03 03 00 14 91 99 15  68 ae 92 52 bd 13 75 45  |........h..R..uE|
-00000010  6d a9 f0 2d ee f5 c3 9b  e7                       |m..-.....|
+00000000  16 03 03 00 14 0f 7d 98  6c 60 b3 cc cf c5 f3 0a  |......}.l`......|
+00000010  8f d2 40 6a 5b e5 45 1b  8b                       |..@j[.E..|
 >>> Flow 7 (client to server)
-00000000  15 03 03 00 12 be 8b 4b  a6 a7 7a 62 45 32 ff db  |.......K..zbE2..|
-00000010  07 ad a0 1b 46 9d c9 15  03 03 00 12 16 da d4 86  |....F...........|
-00000020  4f c8 26 5a d0 34 82 fe  47 34 ae 31 db a7        |O.&Z.4..G4.1..|
+00000000  15 03 03 00 12 f4 9f 10  dc f2 69 4c 21 0c a0 8f  |..........iL!...|
+00000010  6b fd aa a1 93 9a 3a 15  03 03 00 12 be 68 f2 b8  |k.....:......h..|
+00000020  8b 0d a5 1f 98 f0 c2 dd  d4 0a 8c 46 b8 f5        |...........F..|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-SCT b/src/crypto/tls/testdata/Client-TLSv12-SCT
index 8492ee94c4..01fa299268 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-SCT
+++ b/src/crypto/tls/testdata/Client-TLSv12-SCT
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,21 +7,22 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 01 c6 02 00 01  c2 03 03 b0 59 eb bc ae  |............Y...|
-00000010  f3 42 03 d1 fe 2c 7d 6f  0e ff e4 0c 9e 13 00 b9  |.B...,}o........|
-00000020  46 99 e2 84 49 64 a9 05  05 8a fb 20 16 12 dc b7  |F...Id..... ....|
-00000030  e0 09 a2 a6 56 83 43 54  de 40 53 47 43 f0 2f c9  |....V.CT.@SGC./.|
-00000040  2d 92 5e a0 9d a3 6a c4  55 17 01 cb cc a8 00 01  |-.^...j.U.......|
-00000050  7a 00 12 01 69 01 67 00  75 00 a4 b9 09 90 b4 18  |z...i.g.u.......|
+00000000  16 03 03 01 ca 02 00 01  c6 03 03 37 df c1 4d 8a  |...........7..M.|
+00000010  eb 27 a3 6c ec 70 05 9f  f0 86 80 01 6e ad 88 55  |.'.l.p......n..U|
+00000020  f2 1a 44 fb 42 d6 03 5d  f8 74 18 20 0a f5 d0 22  |..D.B..].t. ..."|
+00000030  aa f2 9f e3 9a 0c 86 27  2e 66 be d5 3a c2 4d 77  |.......'.f..:.Mw|
+00000040  f8 5e 78 2b 71 ab 5e 0a  09 bc e1 d6 cc a8 00 01  |.^x+q.^.........|
+00000050  7e 00 12 01 69 01 67 00  75 00 a4 b9 09 90 b4 18  |~...i.g.u.......|
 00000060  58 14 87 bb 13 a2 cc 67  70 0a 3c 35 98 04 f9 1b  |X......gp.<5....|
 00000070  df b8 e3 77 cd 0e c8 0d  dc 10 00 00 01 47 97 99  |...w.........G..|
 00000080  ee 16 00 00 04 03 00 46  30 44 02 20 1c 4b 82 5d  |.......F0D. .K.]|
@@ -44,70 +45,70 @@
 00000190  ed 8f 9b 02 e9 fa c2 4c  ba a2 be 02 21 00 af 43  |.......L....!..C|
 000001a0  64 52 71 15 29 58 40 91  c7 08 16 96 03 a8 73 a5  |dRq.)X@.......s.|
 000001b0  65 a0 6c b8 48 56 5a b6  29 83 64 6d 2a 9d ff 01  |e.l.HVZ.).dm*...|
-000001c0  00 01 00 00 0b 00 04 03  00 01 02 16 03 03 02 59  |...............Y|
-000001d0  0b 00 02 55 00 02 52 00  02 4f 30 82 02 4b 30 82  |...U..R..O0..K0.|
-000001e0  01 b4 a0 03 02 01 02 02  09 00 e8 f0 9d 3f e2 5b  |.............?.[|
-000001f0  ea a6 30 0d 06 09 2a 86  48 86 f7 0d 01 01 0b 05  |..0...*.H.......|
-00000200  00 30 1f 31 0b 30 09 06  03 55 04 0a 13 02 47 6f  |.0.1.0...U....Go|
-00000210  31 10 30 0e 06 03 55 04  03 13 07 47 6f 20 52 6f  |1.0...U....Go Ro|
-00000220  6f 74 30 1e 17 0d 31 36  30 31 30 31 30 30 30 30  |ot0...1601010000|
-00000230  30 30 5a 17 0d 32 35 30  31 30 31 30 30 30 30 30  |00Z..25010100000|
-00000240  30 5a 30 1a 31 0b 30 09  06 03 55 04 0a 13 02 47  |0Z0.1.0...U....G|
-00000250  6f 31 0b 30 09 06 03 55  04 03 13 02 47 6f 30 81  |o1.0...U....Go0.|
-00000260  9f 30 0d 06 09 2a 86 48  86 f7 0d 01 01 01 05 00  |.0...*.H........|
-00000270  03 81 8d 00 30 81 89 02  81 81 00 db 46 7d 93 2e  |....0.......F}..|
-00000280  12 27 06 48 bc 06 28 21  ab 7e c4 b6 a2 5d fe 1e  |.'.H..(!.~...]..|
-00000290  52 45 88 7a 36 47 a5 08  0d 92 42 5b c2 81 c0 be  |RE.z6G....B[....|
-000002a0  97 79 98 40 fb 4f 6d 14  fd 2b 13 8b c2 a5 2e 67  |.y.@.Om..+.....g|
-000002b0  d8 d4 09 9e d6 22 38 b7  4a 0b 74 73 2b c2 34 f1  |....."8.J.ts+.4.|
-000002c0  d1 93 e5 96 d9 74 7b f3  58 9f 6c 61 3c c0 b0 41  |.....t{.X.la<..A|
-000002d0  d4 d9 2b 2b 24 23 77 5b  1c 3b bd 75 5d ce 20 54  |..++$#w[.;.u]. T|
-000002e0  cf a1 63 87 1d 1e 24 c4  f3 1d 1a 50 8b aa b6 14  |..c...$....P....|
-000002f0  43 ed 97 a7 75 62 f4 14  c8 52 d7 02 03 01 00 01  |C...ub...R......|
-00000300  a3 81 93 30 81 90 30 0e  06 03 55 1d 0f 01 01 ff  |...0..0...U.....|
-00000310  04 04 03 02 05 a0 30 1d  06 03 55 1d 25 04 16 30  |......0...U.%..0|
-00000320  14 06 08 2b 06 01 05 05  07 03 01 06 08 2b 06 01  |...+.........+..|
-00000330  05 05 07 03 02 30 0c 06  03 55 1d 13 01 01 ff 04  |.....0...U......|
-00000340  02 30 00 30 19 06 03 55  1d 0e 04 12 04 10 9f 91  |.0.0...U........|
-00000350  16 1f 43 43 3e 49 a6 de  6d b6 80 d7 9f 60 30 1b  |..CC>I..m....`0.|
-00000360  06 03 55 1d 23 04 14 30  12 80 10 48 13 49 4d 13  |..U.#..0...H.IM.|
-00000370  7e 16 31 bb a3 01 d5 ac  ab 6e 7b 30 19 06 03 55  |~.1......n{0...U|
-00000380  1d 11 04 12 30 10 82 0e  65 78 61 6d 70 6c 65 2e  |....0...example.|
-00000390  67 6f 6c 61 6e 67 30 0d  06 09 2a 86 48 86 f7 0d  |golang0...*.H...|
-000003a0  01 01 0b 05 00 03 81 81  00 9d 30 cc 40 2b 5b 50  |..........0.@+[P|
-000003b0  a0 61 cb ba e5 53 58 e1  ed 83 28 a9 58 1a a9 38  |.a...SX...(.X..8|
-000003c0  a4 95 a1 ac 31 5a 1a 84  66 3d 43 d3 2d d9 0b f2  |....1Z..f=C.-...|
-000003d0  97 df d3 20 64 38 92 24  3a 00 bc cf 9c 7d b7 40  |... d8.$:....}.@|
-000003e0  20 01 5f aa d3 16 61 09  a2 76 fd 13 c3 cc e1 0c  | ._...a..v......|
-000003f0  5c ee b1 87 82 f1 6c 04  ed 73 bb b3 43 77 8d 0c  |\.....l..s..Cw..|
-00000400  1c f1 0f a1 d8 40 83 61  c9 4c 72 2b 9d ae db 46  |.....@.a.Lr+...F|
-00000410  06 06 4d f4 c1 b3 3e c0  d1 bd 42 d4 db fe 3d 13  |..M...>...B...=.|
-00000420  60 84 5c 21 d3 3b e9 fa  e7 16 03 03 00 ac 0c 00  |`.\!.;..........|
-00000430  00 a8 03 00 1d 20 4c 46  c9 9f ed 2e 81 0f 8c 4b  |..... LF.......K|
-00000440  bc 05 53 74 c6 c8 76 99  21 94 1b 8f 93 c6 64 ce  |..St..v.!.....d.|
-00000450  e9 9d 6b 1d 66 51 08 04  00 80 09 9e c2 21 89 93  |..k.fQ.......!..|
-00000460  1f c5 2e 2c fa 67 7b 42  23 e1 e0 67 5c 6d e9 1e  |...,.g{B#..g\m..|
-00000470  e8 a2 ac d7 cf f4 12 98  f6 e6 3d 51 0c 2c 29 ad  |..........=Q.,).|
-00000480  f8 8e 24 2a a3 99 2e f3  b2 a7 fe a9 6c e9 00 d8  |..$*........l...|
-00000490  6a 7f 41 12 84 a0 d6 19  38 b1 5a 13 b6 71 cf bd  |j.A.....8.Z..q..|
-000004a0  e2 6e 04 01 c8 cd 83 12  71 85 ae bc 94 b1 e4 4d  |.n......q......M|
-000004b0  a5 5f 9e a5 5d 95 76 fe  f5 d6 a9 f0 4c 07 c9 6e  |._..].v.....L..n|
-000004c0  fc 4a 56 2b 56 4e 9c ec  2c fe bc 9c 9e 57 f3 90  |.JV+VN..,....W..|
-000004d0  c6 6e 77 5a cf 8c 1a 15  cd 90 16 03 03 00 04 0e  |.nwZ............|
-000004e0  00 00 00                                          |...|
+000001c0  00 01 00 00 0b 00 04 03  00 01 02 00 17 00 00 16  |................|
+000001d0  03 03 02 59 0b 00 02 55  00 02 52 00 02 4f 30 82  |...Y...U..R..O0.|
+000001e0  02 4b 30 82 01 b4 a0 03  02 01 02 02 09 00 e8 f0  |.K0.............|
+000001f0  9d 3f e2 5b ea a6 30 0d  06 09 2a 86 48 86 f7 0d  |.?.[..0...*.H...|
+00000200  01 01 0b 05 00 30 1f 31  0b 30 09 06 03 55 04 0a  |.....0.1.0...U..|
+00000210  13 02 47 6f 31 10 30 0e  06 03 55 04 03 13 07 47  |..Go1.0...U....G|
+00000220  6f 20 52 6f 6f 74 30 1e  17 0d 31 36 30 31 30 31  |o Root0...160101|
+00000230  30 30 30 30 30 30 5a 17  0d 32 35 30 31 30 31 30  |000000Z..2501010|
+00000240  30 30 30 30 30 5a 30 1a  31 0b 30 09 06 03 55 04  |00000Z0.1.0...U.|
+00000250  0a 13 02 47 6f 31 0b 30  09 06 03 55 04 03 13 02  |...Go1.0...U....|
+00000260  47 6f 30 81 9f 30 0d 06  09 2a 86 48 86 f7 0d 01  |Go0..0...*.H....|
+00000270  01 01 05 00 03 81 8d 00  30 81 89 02 81 81 00 db  |........0.......|
+00000280  46 7d 93 2e 12 27 06 48  bc 06 28 21 ab 7e c4 b6  |F}...'.H..(!.~..|
+00000290  a2 5d fe 1e 52 45 88 7a  36 47 a5 08 0d 92 42 5b  |.]..RE.z6G....B[|
+000002a0  c2 81 c0 be 97 79 98 40  fb 4f 6d 14 fd 2b 13 8b  |.....y.@.Om..+..|
+000002b0  c2 a5 2e 67 d8 d4 09 9e  d6 22 38 b7 4a 0b 74 73  |...g....."8.J.ts|
+000002c0  2b c2 34 f1 d1 93 e5 96  d9 74 7b f3 58 9f 6c 61  |+.4......t{.X.la|
+000002d0  3c c0 b0 41 d4 d9 2b 2b  24 23 77 5b 1c 3b bd 75  |<..A..++$#w[.;.u|
+000002e0  5d ce 20 54 cf a1 63 87  1d 1e 24 c4 f3 1d 1a 50  |]. T..c...$....P|
+000002f0  8b aa b6 14 43 ed 97 a7  75 62 f4 14 c8 52 d7 02  |....C...ub...R..|
+00000300  03 01 00 01 a3 81 93 30  81 90 30 0e 06 03 55 1d  |.......0..0...U.|
+00000310  0f 01 01 ff 04 04 03 02  05 a0 30 1d 06 03 55 1d  |..........0...U.|
+00000320  25 04 16 30 14 06 08 2b  06 01 05 05 07 03 01 06  |%..0...+........|
+00000330  08 2b 06 01 05 05 07 03  02 30 0c 06 03 55 1d 13  |.+.......0...U..|
+00000340  01 01 ff 04 02 30 00 30  19 06 03 55 1d 0e 04 12  |.....0.0...U....|
+00000350  04 10 9f 91 16 1f 43 43  3e 49 a6 de 6d b6 80 d7  |......CC>I..m...|
+00000360  9f 60 30 1b 06 03 55 1d  23 04 14 30 12 80 10 48  |.`0...U.#..0...H|
+00000370  13 49 4d 13 7e 16 31 bb  a3 01 d5 ac ab 6e 7b 30  |.IM.~.1......n{0|
+00000380  19 06 03 55 1d 11 04 12  30 10 82 0e 65 78 61 6d  |...U....0...exam|
+00000390  70 6c 65 2e 67 6f 6c 61  6e 67 30 0d 06 09 2a 86  |ple.golang0...*.|
+000003a0  48 86 f7 0d 01 01 0b 05  00 03 81 81 00 9d 30 cc  |H.............0.|
+000003b0  40 2b 5b 50 a0 61 cb ba  e5 53 58 e1 ed 83 28 a9  |@+[P.a...SX...(.|
+000003c0  58 1a a9 38 a4 95 a1 ac  31 5a 1a 84 66 3d 43 d3  |X..8....1Z..f=C.|
+000003d0  2d d9 0b f2 97 df d3 20  64 38 92 24 3a 00 bc cf  |-...... d8.$:...|
+000003e0  9c 7d b7 40 20 01 5f aa  d3 16 61 09 a2 76 fd 13  |.}.@ ._...a..v..|
+000003f0  c3 cc e1 0c 5c ee b1 87  82 f1 6c 04 ed 73 bb b3  |....\.....l..s..|
+00000400  43 77 8d 0c 1c f1 0f a1  d8 40 83 61 c9 4c 72 2b  |Cw.......@.a.Lr+|
+00000410  9d ae db 46 06 06 4d f4  c1 b3 3e c0 d1 bd 42 d4  |...F..M...>...B.|
+00000420  db fe 3d 13 60 84 5c 21  d3 3b e9 fa e7 16 03 03  |..=.`.\!.;......|
+00000430  00 ac 0c 00 00 a8 03 00  1d 20 63 41 30 1c 95 79  |......... cA0..y|
+00000440  1b a6 85 f4 e1 b6 d7 f5  82 e2 4f 2b ae cd 7b 4b  |..........O+..{K|
+00000450  20 e2 7e 43 f1 59 e5 83  92 55 08 04 00 80 5c aa  | .~C.Y...U....\.|
+00000460  39 6d 57 d3 b6 15 4d 9e  c8 e1 dc 50 b3 89 69 99  |9mW...M....P..i.|
+00000470  da 07 64 74 c4 ab d3 83  f0 9b fc 3a da 26 9f ce  |..dt.......:.&..|
+00000480  37 e9 7a 50 e5 70 d1 71  0b 0d 73 03 9c c1 3f 81  |7.zP.p.q..s...?.|
+00000490  f9 1d 57 32 6b 48 50 1d  5d 7d 64 56 f0 c9 8c 69  |..W2kHP.]}dV...i|
+000004a0  d6 91 15 85 95 9a 0c 76  f0 9c d2 fe d4 df 65 00  |.......v......e.|
+000004b0  a1 cc 65 4a a2 8e 06 fc  50 77 ff 00 44 b5 cc f5  |..eJ....Pw..D...|
+000004c0  9f 39 2f 95 72 4f 51 af  21 09 6a 6a 21 60 24 65  |.9/.rOQ.!.jj!`$e|
+000004d0  78 20 9b 06 0e 24 1b 79  f2 8d 15 35 49 44 16 03  |x ...$.y...5ID..|
+000004e0  03 00 04 0e 00 00 00                              |.......|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 20 19 bf ac  05 d4 bb 8a 6d 11 f4 98  |.... .......m...|
-00000040  0d af 78 57 49 74 5c 44  45 9e 2c 92 26 b9 10 b5  |..xWIt\DE.,.&...|
-00000050  6d 5f 24 bc a6                                    |m_$..|
+00000030  16 03 03 00 20 d0 2b f9  13 8b 71 de 1b 1d 63 2e  |.... .+...q...c.|
+00000040  66 05 12 ee 11 d5 9b 75  ee 51 fa 42 fa 5d 86 eb  |f......u.Q.B.]..|
+00000050  f0 c5 c5 cb 5b                                    |....[|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 69 3a c4 9c ee  |.......... i:...|
-00000010  91 6b bc 33 39 82 64 c2  0a f0 a4 dd 85 16 3c ce  |.k.39.d.......<.|
-00000020  39 c4 98 37 77 47 1e c2  c6 d8 f6                 |9..7wG.....|
+00000000  14 03 03 00 01 01 16 03  03 00 20 71 ac 7b 2e ba  |.......... q.{..|
+00000010  d5 7e 70 6c 7c 94 0e 55  0f 65 8c 1d ff 5e 79 d6  |.~pl|..U.e...^y.|
+00000020  21 9b 8a f4 82 35 69 b8  5a d9 1a                 |!....5i.Z..|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 92 25 9b  97 11 08 71 63 b2 c1 35  |......%....qc..5|
-00000010  14 3b e7 15 f6 05 67 51  46 db ba 15 03 03 00 12  |.;....gQF.......|
-00000020  b2 53 a1 ec a8 cf 79 7d  f8 86 70 05 e5 81 a1 6c  |.S....y}..p....l|
-00000030  41 ab                                             |A.|
+00000000  17 03 03 00 16 82 6e 37  1a 95 19 06 bf da ca 8c  |......n7........|
+00000010  f4 07 3a 63 69 c7 00 ce  5c b9 bf 15 03 03 00 12  |..:ci...\.......|
+00000020  eb 05 f5 6f 8c 59 16 ed  26 1b f9 1f 2e 4e b8 89  |...o.Y..&....N..|
+00000030  80 77                                             |.w|
diff --git a/src/crypto/tls/testdata/Client-TLSv12-X25519-ECDHE b/src/crypto/tls/testdata/Client-TLSv12-X25519-ECDHE
index 3d3de611d0..372abea6db 100644
--- a/src/crypto/tls/testdata/Client-TLSv12-X25519-ECDHE
+++ b/src/crypto/tls/testdata/Client-TLSv12-X25519-ECDHE
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 f4 01 00 00  f0 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 f8 01 00 00  f4 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,86 +7,86 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 75 00 05 00 05  01 00 00 00 00 00 0a 00  |...u............|
+00000080  01 00 00 79 00 05 00 05  01 00 00 00 00 00 0a 00  |...y............|
 00000090  04 00 02 00 1d 00 0b 00  02 01 00 00 0d 00 1a 00  |................|
 000000a0  18 08 04 04 03 08 07 08  05 08 06 04 01 05 01 06  |................|
-000000b0  01 05 03 06 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-000000c0  00 00 00 2b 00 09 08 03  04 03 03 03 02 03 01 00  |...+............|
-000000d0  33 00 26 00 24 00 1d 00  20 2f e5 7d a3 47 cd 62  |3.&.$... /.}.G.b|
-000000e0  43 15 28 da ac 5f bb 29  07 30 ff f6 84 af c4 cf  |C.(.._.).0......|
-000000f0  c2 ed 90 99 5f 58 cb 3b  74                       |...._X.;t|
+000000b0  01 05 03 06 03 02 01 02  03 ff 01 00 01 00 00 17  |................|
+000000c0  00 00 00 12 00 00 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000d0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+000000e0  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+000000f0  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 59 02 00 00  55 03 03 f7 79 97 18 3c  |....Y...U...y..<|
-00000010  fa 52 c6 d2 6b 1e de a5  60 da d5 e2 0b f6 23 a8  |.R..k...`.....#.|
-00000020  48 94 e8 1f fb b9 76 43  94 e8 98 20 31 a5 85 d5  |H.....vC... 1...|
-00000030  2f c4 93 b1 ae aa 50 bc  14 9e 57 79 18 85 cd ef  |/.....P...Wy....|
-00000040  b4 f0 42 c9 6c b1 86 c1  03 27 ca df c0 2f 00 00  |..B.l....'.../..|
-00000050  0d ff 01 00 01 00 00 0b  00 04 03 00 01 02 16 03  |................|
-00000060  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
-00000070  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
-00000080  3f e2 5b ea a6 30 0d 06  09 2a 86 48 86 f7 0d 01  |?.[..0...*.H....|
-00000090  01 0b 05 00 30 1f 31 0b  30 09 06 03 55 04 0a 13  |....0.1.0...U...|
-000000a0  02 47 6f 31 10 30 0e 06  03 55 04 03 13 07 47 6f  |.Go1.0...U....Go|
-000000b0  20 52 6f 6f 74 30 1e 17  0d 31 36 30 31 30 31 30  | Root0...1601010|
-000000c0  30 30 30 30 30 5a 17 0d  32 35 30 31 30 31 30 30  |00000Z..25010100|
-000000d0  30 30 30 30 5a 30 1a 31  0b 30 09 06 03 55 04 0a  |0000Z0.1.0...U..|
-000000e0  13 02 47 6f 31 0b 30 09  06 03 55 04 03 13 02 47  |..Go1.0...U....G|
-000000f0  6f 30 81 9f 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |o0..0...*.H.....|
-00000100  01 05 00 03 81 8d 00 30  81 89 02 81 81 00 db 46  |.......0.......F|
-00000110  7d 93 2e 12 27 06 48 bc  06 28 21 ab 7e c4 b6 a2  |}...'.H..(!.~...|
-00000120  5d fe 1e 52 45 88 7a 36  47 a5 08 0d 92 42 5b c2  |]..RE.z6G....B[.|
-00000130  81 c0 be 97 79 98 40 fb  4f 6d 14 fd 2b 13 8b c2  |....y.@.Om..+...|
-00000140  a5 2e 67 d8 d4 09 9e d6  22 38 b7 4a 0b 74 73 2b  |..g....."8.J.ts+|
-00000150  c2 34 f1 d1 93 e5 96 d9  74 7b f3 58 9f 6c 61 3c  |.4......t{.X.la<|
-00000160  c0 b0 41 d4 d9 2b 2b 24  23 77 5b 1c 3b bd 75 5d  |..A..++$#w[.;.u]|
-00000170  ce 20 54 cf a1 63 87 1d  1e 24 c4 f3 1d 1a 50 8b  |. T..c...$....P.|
-00000180  aa b6 14 43 ed 97 a7 75  62 f4 14 c8 52 d7 02 03  |...C...ub...R...|
-00000190  01 00 01 a3 81 93 30 81  90 30 0e 06 03 55 1d 0f  |......0..0...U..|
-000001a0  01 01 ff 04 04 03 02 05  a0 30 1d 06 03 55 1d 25  |.........0...U.%|
-000001b0  04 16 30 14 06 08 2b 06  01 05 05 07 03 01 06 08  |..0...+.........|
-000001c0  2b 06 01 05 05 07 03 02  30 0c 06 03 55 1d 13 01  |+.......0...U...|
-000001d0  01 ff 04 02 30 00 30 19  06 03 55 1d 0e 04 12 04  |....0.0...U.....|
-000001e0  10 9f 91 16 1f 43 43 3e  49 a6 de 6d b6 80 d7 9f  |.....CC>I..m....|
-000001f0  60 30 1b 06 03 55 1d 23  04 14 30 12 80 10 48 13  |`0...U.#..0...H.|
-00000200  49 4d 13 7e 16 31 bb a3  01 d5 ac ab 6e 7b 30 19  |IM.~.1......n{0.|
-00000210  06 03 55 1d 11 04 12 30  10 82 0e 65 78 61 6d 70  |..U....0...examp|
-00000220  6c 65 2e 67 6f 6c 61 6e  67 30 0d 06 09 2a 86 48  |le.golang0...*.H|
-00000230  86 f7 0d 01 01 0b 05 00  03 81 81 00 9d 30 cc 40  |.............0.@|
-00000240  2b 5b 50 a0 61 cb ba e5  53 58 e1 ed 83 28 a9 58  |+[P.a...SX...(.X|
-00000250  1a a9 38 a4 95 a1 ac 31  5a 1a 84 66 3d 43 d3 2d  |..8....1Z..f=C.-|
-00000260  d9 0b f2 97 df d3 20 64  38 92 24 3a 00 bc cf 9c  |...... d8.$:....|
-00000270  7d b7 40 20 01 5f aa d3  16 61 09 a2 76 fd 13 c3  |}.@ ._...a..v...|
-00000280  cc e1 0c 5c ee b1 87 82  f1 6c 04 ed 73 bb b3 43  |...\.....l..s..C|
-00000290  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
-000002a0  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
-000002b0  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
-000002c0  ac 0c 00 00 a8 03 00 1d  20 90 95 bd 82 cf 8a cc  |........ .......|
-000002d0  08 b4 09 09 8d 59 2d 03  7a bb 92 4a c4 5c 08 4d  |.....Y-.z..J.\.M|
-000002e0  42 a3 ba cb 9a 43 ae f0  22 08 04 00 80 a0 97 ac  |B....C..".......|
-000002f0  01 a5 c8 7b 4c 73 7e 70  7a 9a fc 9d 71 2f fe 67  |...{Ls~pz...q/.g|
-00000300  ca dd 6b 43 db 64 0f 64  52 e7 d3 5d 6d b2 7c 50  |..kC.d.dR..]m.|P|
-00000310  74 7e 80 d5 22 77 3f fb  c2 e8 dc 92 37 4f 1e 1e  |t~.."w?.....7O..|
-00000320  e7 13 f2 01 33 80 32 66  4f c2 17 8e ec 4f ed 4a  |....3.2fO....O.J|
-00000330  15 6c e8 86 ec df d5 46  6c a5 43 0d 40 fe a0 c8  |.l.....Fl.C.@...|
-00000340  65 b4 76 46 b8 36 2c da  87 7c 60 87 db 39 4c 2e  |e.vF.6,..|`..9L.|
-00000350  0f e4 72 32 11 26 99 7e  c8 7a c0 bc 9c a7 29 57  |..r2.&.~.z....)W|
-00000360  9d 27 37 4e ec c5 bb fd  a1 3c f3 66 63 16 03 03  |.'7N.....<.fc...|
-00000370  00 04 0e 00 00 00                                 |......|
+00000000  16 03 03 00 5d 02 00 00  59 03 03 19 05 85 f6 4a  |....]...Y......J|
+00000010  53 c9 c6 4f ac 38 b7 cc  d8 5d 00 dc 3b 97 9c 0d  |S..O.8...]..;...|
+00000020  d0 e0 9f d8 71 28 a1 ab  e8 b7 cc 20 a6 a4 8c 69  |....q(..... ...i|
+00000030  6e 9c ee ae 75 14 b8 0f  93 b3 c2 82 ff 01 9b d7  |n...u...........|
+00000040  25 90 d7 53 02 6d 3b ec  e9 1a 21 e5 c0 2f 00 00  |%..S.m;...!../..|
+00000050  11 ff 01 00 01 00 00 0b  00 04 03 00 01 02 00 17  |................|
+00000060  00 00 16 03 03 02 59 0b  00 02 55 00 02 52 00 02  |......Y...U..R..|
+00000070  4f 30 82 02 4b 30 82 01  b4 a0 03 02 01 02 02 09  |O0..K0..........|
+00000080  00 e8 f0 9d 3f e2 5b ea  a6 30 0d 06 09 2a 86 48  |....?.[..0...*.H|
+00000090  86 f7 0d 01 01 0b 05 00  30 1f 31 0b 30 09 06 03  |........0.1.0...|
+000000a0  55 04 0a 13 02 47 6f 31  10 30 0e 06 03 55 04 03  |U....Go1.0...U..|
+000000b0  13 07 47 6f 20 52 6f 6f  74 30 1e 17 0d 31 36 30  |..Go Root0...160|
+000000c0  31 30 31 30 30 30 30 30  30 5a 17 0d 32 35 30 31  |101000000Z..2501|
+000000d0  30 31 30 30 30 30 30 30  5a 30 1a 31 0b 30 09 06  |01000000Z0.1.0..|
+000000e0  03 55 04 0a 13 02 47 6f  31 0b 30 09 06 03 55 04  |.U....Go1.0...U.|
+000000f0  03 13 02 47 6f 30 81 9f  30 0d 06 09 2a 86 48 86  |...Go0..0...*.H.|
+00000100  f7 0d 01 01 01 05 00 03  81 8d 00 30 81 89 02 81  |...........0....|
+00000110  81 00 db 46 7d 93 2e 12  27 06 48 bc 06 28 21 ab  |...F}...'.H..(!.|
+00000120  7e c4 b6 a2 5d fe 1e 52  45 88 7a 36 47 a5 08 0d  |~...]..RE.z6G...|
+00000130  92 42 5b c2 81 c0 be 97  79 98 40 fb 4f 6d 14 fd  |.B[.....y.@.Om..|
+00000140  2b 13 8b c2 a5 2e 67 d8  d4 09 9e d6 22 38 b7 4a  |+.....g....."8.J|
+00000150  0b 74 73 2b c2 34 f1 d1  93 e5 96 d9 74 7b f3 58  |.ts+.4......t{.X|
+00000160  9f 6c 61 3c c0 b0 41 d4  d9 2b 2b 24 23 77 5b 1c  |.la<..A..++$#w[.|
+00000170  3b bd 75 5d ce 20 54 cf  a1 63 87 1d 1e 24 c4 f3  |;.u]. T..c...$..|
+00000180  1d 1a 50 8b aa b6 14 43  ed 97 a7 75 62 f4 14 c8  |..P....C...ub...|
+00000190  52 d7 02 03 01 00 01 a3  81 93 30 81 90 30 0e 06  |R.........0..0..|
+000001a0  03 55 1d 0f 01 01 ff 04  04 03 02 05 a0 30 1d 06  |.U...........0..|
+000001b0  03 55 1d 25 04 16 30 14  06 08 2b 06 01 05 05 07  |.U.%..0...+.....|
+000001c0  03 01 06 08 2b 06 01 05  05 07 03 02 30 0c 06 03  |....+.......0...|
+000001d0  55 1d 13 01 01 ff 04 02  30 00 30 19 06 03 55 1d  |U.......0.0...U.|
+000001e0  0e 04 12 04 10 9f 91 16  1f 43 43 3e 49 a6 de 6d  |.........CC>I..m|
+000001f0  b6 80 d7 9f 60 30 1b 06  03 55 1d 23 04 14 30 12  |....`0...U.#..0.|
+00000200  80 10 48 13 49 4d 13 7e  16 31 bb a3 01 d5 ac ab  |..H.IM.~.1......|
+00000210  6e 7b 30 19 06 03 55 1d  11 04 12 30 10 82 0e 65  |n{0...U....0...e|
+00000220  78 61 6d 70 6c 65 2e 67  6f 6c 61 6e 67 30 0d 06  |xample.golang0..|
+00000230  09 2a 86 48 86 f7 0d 01  01 0b 05 00 03 81 81 00  |.*.H............|
+00000240  9d 30 cc 40 2b 5b 50 a0  61 cb ba e5 53 58 e1 ed  |.0.@+[P.a...SX..|
+00000250  83 28 a9 58 1a a9 38 a4  95 a1 ac 31 5a 1a 84 66  |.(.X..8....1Z..f|
+00000260  3d 43 d3 2d d9 0b f2 97  df d3 20 64 38 92 24 3a  |=C.-...... d8.$:|
+00000270  00 bc cf 9c 7d b7 40 20  01 5f aa d3 16 61 09 a2  |....}.@ ._...a..|
+00000280  76 fd 13 c3 cc e1 0c 5c  ee b1 87 82 f1 6c 04 ed  |v......\.....l..|
+00000290  73 bb b3 43 77 8d 0c 1c  f1 0f a1 d8 40 83 61 c9  |s..Cw.......@.a.|
+000002a0  4c 72 2b 9d ae db 46 06  06 4d f4 c1 b3 3e c0 d1  |Lr+...F..M...>..|
+000002b0  bd 42 d4 db fe 3d 13 60  84 5c 21 d3 3b e9 fa e7  |.B...=.`.\!.;...|
+000002c0  16 03 03 00 ac 0c 00 00  a8 03 00 1d 20 3d 1d f3  |............ =..|
+000002d0  d4 cb 57 6a d8 c4 23 34  84 30 2a 80 02 0c 86 de  |..Wj..#4.0*.....|
+000002e0  94 ae c8 78 07 f5 0c eb  61 f2 2f a6 2d 08 04 00  |...x....a./.-...|
+000002f0  80 08 5e b0 4b ed 7b e1  48 45 80 6a 63 5c 1e 9a  |..^.K.{.HE.jc\..|
+00000300  01 4e f1 c3 92 b2 a4 83  18 ee 55 01 36 55 57 59  |.N........U.6UWY|
+00000310  84 46 70 60 43 32 05 25  18 de 05 76 24 57 69 a3  |.Fp`C2.%...v$Wi.|
+00000320  34 a6 bd 4c b5 45 2c 6e  63 81 a3 82 a7 4a a5 5f  |4..L.E,nc....J._|
+00000330  27 c2 a2 58 2b 77 9f cf  cb 63 e0 2b da 75 eb 9c  |'..X+w...c.+.u..|
+00000340  6e 6b cd d5 ae 59 8d c8  0f c6 34 30 68 42 67 d5  |nk...Y....40hBg.|
+00000350  1f e7 b1 22 60 b5 ca 4b  a5 bd ce a0 44 50 df 45  |..."`..K....DP.E|
+00000360  8b d8 e4 04 53 8a f8 fa  91 b2 09 fb 42 92 5f dd  |....S.......B._.|
+00000370  05 16 03 03 00 04 0e 00  00 00                    |..........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 25 10 00 00  21 20 2f e5 7d a3 47 cd  |....%...! /.}.G.|
 00000010  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
 00000020  cf c2 ed 90 99 5f 58 cb  3b 74 14 03 03 00 01 01  |....._X.;t......|
-00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 81 b1 2c  |....(..........,|
-00000040  a2 3b 38 34 a6 66 57 02  e3 67 1b ee 73 95 50 de  |.;84.fW..g..s.P.|
-00000050  dd 5a fd 4e 0d ee b7 a6  46 1a 34 61 73           |.Z.N....F.4as|
+00000030  16 03 03 00 28 00 00 00  00 00 00 00 00 bb 7a 8d  |....(.........z.|
+00000040  2b 4d 9e e9 b6 b7 bf 30  e3 fd 4b e6 2e 6c ba 61  |+M.....0..K..l.a|
+00000050  2b 15 58 52 d0 70 36 e5  da 64 21 28 06           |+.XR.p6..d!(.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 2f a9 80 36 d8  |..........(/..6.|
-00000010  d0 74 e4 39 46 04 88 8e  91 ea fd 96 ed 1f 89 9f  |.t.9F...........|
-00000020  a4 e9 24 0e ca 48 2b 5c  5d f1 cc 57 ce 92 1a ad  |..$..H+\]..W....|
-00000030  b9 10 11                                          |...|
+00000000  14 03 03 00 01 01 16 03  03 00 28 11 6b 33 c7 32  |..........(.k3.2|
+00000010  9b 34 14 98 1d 90 97 cc  3a fe c1 98 f7 9d e3 dc  |.4......:.......|
+00000020  dc f2 e2 34 c9 5d aa 5b  02 e3 9f 33 88 5b 21 65  |...4.].[...3.[!e|
+00000030  b0 f1 36                                          |..6|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 da be 68  |...............h|
-00000010  97 b4 a4 72 d0 ed 75 66  6a a9 6f 39 8a 08 a9 db  |...r..ufj.o9....|
-00000020  de 4d e1 15 03 03 00 1a  00 00 00 00 00 00 00 02  |.M..............|
-00000030  14 90 0e 1d 26 5c 18 c6  5c 93 66 c4 90 78 a8 91  |....&\..\.f..x..|
-00000040  cb fd                                             |..|
+00000000  17 03 03 00 1e 00 00 00  00 00 00 00 01 4b 49 39  |.............KI9|
+00000010  01 d1 34 c1 b9 72 f6 25  39 c9 e6 77 5c f3 7a 4f  |..4..r.%9..w\.zO|
+00000020  fa f7 43 15 03 03 00 1a  00 00 00 00 00 00 00 02  |..C.............|
+00000030  99 cf 0c 0e 51 f8 37 22  50 2e 98 30 bc 13 e9 f5  |....Q.7"P..0....|
+00000040  d3 75                                             |.u|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-AES128-SHA256 b/src/crypto/tls/testdata/Client-TLSv13-AES128-SHA256
index f8a733e3c2..1097116b76 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-AES128-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv13-AES128-SHA256
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,84 +7,85 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 f1 4c f4 16 24  |....z...v...L..$|
-00000010  e5 c6 b5 ce 72 08 3b 33  9f 1f 1f 80 2c 10 0b 34  |....r.;3....,..4|
-00000020  01 99 85 ba b0 3c 85 50  3d bf 73 20 00 00 00 00  |.....<.P=.s ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 0e f8 bf 2d c5  |....z...v.....-.|
+00000010  14 c9 b0 54 dd 64 27 22  ce 6e e1 cb 24 46 76 5c  |...T.d'".n..$Fv\|
+00000020  3c 6b cf 3a 1a bb ca d9  55 18 d2 20 00 00 00 00  |<k.:....U.. ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 01 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 69  |..+.....3.$... i|
-00000060  94 3b 83 cd 1f 93 53 53  82 de 14 cb 76 2a 19 62  |.;....SS....v*.b|
-00000070  0f f8 9e d1 e3 e0 a9 d5  23 ac 07 64 53 27 4b 14  |........#..dS'K.|
-00000080  03 03 00 01 01 17 03 03  00 17 ef 24 2c ea 6f 05  |...........$,.o.|
-00000090  c2 07 7a d2 12 30 ce 01  f4 96 b8 dc e6 c2 27 02  |..z..0........'.|
-000000a0  bd 17 03 03 02 6d 99 2b  cb 79 43 01 66 24 eb f1  |.....m.+.yC.f$..|
-000000b0  14 d2 ea 1e 57 67 81 e3  a0 9c 99 1b 1f d5 f0 c7  |....Wg..........|
-000000c0  78 48 61 01 42 25 85 0b  cd a1 b1 75 3c 50 01 cc  |xHa.B%.....u<P..|
-000000d0  69 09 22 a5 fb db 43 76  2f 4e 34 4e 14 a3 e4 89  |i."...Cv/N4N....|
-000000e0  f7 d7 cd 66 da b3 1d fd  f0 98 60 18 41 09 a5 22  |...f......`.A.."|
-000000f0  6d c9 21 bc c3 cd 53 ca  c3 a5 d7 24 57 b4 f5 bc  |m.!...S....$W...|
-00000100  ec b1 48 70 12 55 a5 a6  01 10 68 0f c4 e5 de 89  |..Hp.U....h.....|
-00000110  f9 0d ab 48 92 d4 12 d7  75 77 c3 2f ae 2f 6f 58  |...H....uw././oX|
-00000120  2d 6e ad 72 43 dc ce 4b  c9 74 3d eb db da 37 2c  |-n.rC..K.t=...7,|
-00000130  1e a2 86 c4 b3 64 69 f6  84 ce 52 b5 32 c6 b9 c2  |.....di...R.2...|
-00000140  49 2d 08 f9 d4 9a 29 09  5b 71 09 81 a3 19 c2 4d  |I-....).[q.....M|
-00000150  8c 48 2c e3 c6 cb 81 d4  7f 10 b3 c8 2b 21 ad 83  |.H,.........+!..|
-00000160  97 d2 bd 11 90 39 1e f4  de 65 e2 e8 e8 c7 ce f9  |.....9...e......|
-00000170  6d ad b0 60 5c 4b 59 c4  96 ce b3 a1 83 b2 7c 71  |m..`\KY.......|q|
-00000180  74 e6 a9 a7 89 bf 8d 0d  6c 8d b5 04 33 38 ff 68  |t.......l...38.h|
-00000190  42 0e 84 da d2 b2 16 29  83 66 82 a9 2a d2 67 1b  |B......).f..*.g.|
-000001a0  18 a6 7d e3 f1 d3 f1 b4  cc 6c 14 e2 cd 2d 96 7b  |..}......l...-.{|
-000001b0  76 dd b0 1d 24 7f ea c0  14 24 d7 37 00 7c cd e3  |v...$....$.7.|..|
-000001c0  20 33 a4 3a 22 2a be 3e  e8 f8 7c 0d 3e 51 f7 6b  | 3.:"*.>..|.>Q.k|
-000001d0  ce f3 51 cf 7e ae 55 40  bb ab 0e 40 6b d9 8a 3b  |..Q.~.U@...@k..;|
-000001e0  d5 f2 1f 76 6a 05 9b 87  e2 3b db fa cc e8 93 8a  |...vj....;......|
-000001f0  d9 ba 2b 63 77 77 62 f1  22 ce 11 a9 26 b5 e8 a2  |..+cwwb."...&...|
-00000200  ec 3f 98 44 01 27 d7 e1  39 26 33 e3 86 00 60 f7  |.?.D.'..9&3...`.|
-00000210  a7 91 07 45 f8 3f 78 dc  88 71 30 26 0c f9 0d 51  |...E.?x..q0&...Q|
-00000220  2a c5 ce 33 ac b7 91 a9  74 2e 46 68 80 6e 62 cd  |*..3....t.Fh.nb.|
-00000230  2d 5e 43 fe bd d1 37 07  71 85 5d c7 38 17 50 3a  |-^C...7.q.].8.P:|
-00000240  1c 5e 9f cf 1e 3c 96 d0  26 5d 4c 82 78 a8 69 e7  |.^...<..&]L.x.i.|
-00000250  d3 9a 81 e5 85 66 c3 d9  74 a1 82 9d fb 24 81 13  |.....f..t....$..|
-00000260  0d ce cb 43 61 3c 3a a7  d1 80 7f 1d 41 d8 62 43  |...Ca<:.....A.bC|
-00000270  c6 08 5d 91 05 ed 2c 50  04 42 8c db 2a 11 61 96  |..]...,P.B..*.a.|
-00000280  9b d2 1d 40 af 83 ed 93  06 ba 65 22 0a a5 e8 a6  |...@......e"....|
-00000290  b9 4a 63 6f c0 ac da 72  10 24 c6 ed 08 86 c8 a1  |.Jco...r.$......|
-000002a0  92 5e d0 d8 8b 04 b7 43  50 0b 03 41 3f f9 96 16  |.^.....CP..A?...|
-000002b0  a3 c8 09 e8 ac 91 b2 45  d5 58 5f 41 05 7c b3 88  |.......E.X_A.|..|
-000002c0  7a 59 cd 1a 00 86 29 72  77 a5 19 43 32 79 fc d6  |zY....)rw..C2y..|
-000002d0  d7 e9 81 08 e3 d9 d9 56  39 59 7c 1e d3 10 3e a4  |.......V9Y|...>.|
-000002e0  c6 80 d3 8b 9b 36 51 c5  d3 14 64 a6 65 e2 1a 26  |.....6Q...d.e..&|
-000002f0  c4 a8 31 07 bb 58 8c 9b  d8 7d 86 fd 54 6c c9 ae  |..1..X...}..Tl..|
-00000300  7d 88 4b 13 0f 52 10 41  d6 be 01 32 f2 42 47 0f  |}.K..R.A...2.BG.|
-00000310  7a 8c 7e 17 03 03 00 99  8b ce c4 db 9c 9c 88 e3  |z.~.............|
-00000320  88 58 de 8f 10 e9 fb 4a  c7 26 96 60 48 84 2c b1  |.X.....J.&.`H.,.|
-00000330  2b 6c 35 70 8a d7 39 91  51 d7 3f db 81 f0 41 07  |+l5p..9.Q.?...A.|
-00000340  a2 c9 c1 74 76 62 58 f1  cb e2 50 48 57 bb 6e 3d  |...tvbX...PHW.n=|
-00000350  ee ee 4a 53 e7 3c 66 aa  e3 d9 c1 f1 74 1a 93 b9  |..JS.<f.....t...|
-00000360  44 90 f6 a5 a4 da f5 6b  75 01 38 52 8f 9c ab 01  |D......ku.8R....|
-00000370  78 88 a6 cc 65 15 61 a8  8c cc 14 59 07 ea 6f 25  |x...e.a....Y..o%|
-00000380  5c 86 89 16 eb e7 da 20  82 d7 96 e4 78 7a c3 36  |\...... ....xz.6|
-00000390  b3 5c e7 17 1b 07 30 a2  72 ca a2 f3 dc 7e 45 c9  |.\....0.r....~E.|
-000003a0  7f 94 f8 a1 7b bb 2a 30  d7 bc 51 03 fb e6 2a fa  |....{.*0..Q...*.|
-000003b0  17 17 03 03 00 35 c1 a0  76 b6 35 4b 5c 26 94 c6  |.....5..v.5K\&..|
-000003c0  ba b1 7b b1 13 00 f2 2c  17 ed ac ab 47 9a a1 8d  |..{....,....G...|
-000003d0  3a 1c 78 44 14 a1 04 31  3d eb 9a 8d bb 2f 73 46  |:.xD...1=..../sF|
-000003e0  cb 5c f6 86 81 fa 56 fb  39 8c 55                 |.\....V.9.U|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 f0  |..+.....3.$... .|
+00000060  f3 c3 c9 89 b9 92 ce df  d1 bd f1 11 25 4d 73 3b  |............%Ms;|
+00000070  da 10 b8 4c c8 22 00 6a  24 6b b8 73 4e de 42 14  |...L.".j$k.sN.B.|
+00000080  03 03 00 01 01 17 03 03  00 17 0d c6 b2 56 f3 da  |.............V..|
+00000090  2d 18 93 c6 59 8c be b9  7f 1d 48 bd 7a a2 85 d3  |-...Y.....H.z...|
+000000a0  74 17 03 03 02 6d d5 8a  aa 3c ca d2 98 eb 0c bb  |t....m...<......|
+000000b0  54 00 49 eb 94 48 be 31  a5 c6 13 a6 98 1a df 43  |T.I..H.1.......C|
+000000c0  b8 5d 11 6e c2 80 18 88  a0 84 f2 4b 67 58 64 ae  |.].n.......KgXd.|
+000000d0  e9 7d 97 6a ec af 1f 80  c9 1b 5e ce d5 88 7d c3  |.}.j......^...}.|
+000000e0  05 36 7c 8d ac 70 8d 36  84 d6 12 ed a7 86 87 0c  |.6|..p.6........|
+000000f0  a0 b3 8c c4 20 0c c3 01  04 ef 27 1b cc bd 27 72  |.... .....'...'r|
+00000100  4f 92 61 6f 1c 21 1e 6a  27 22 3f a9 3c a7 b9 b3  |O.ao.!.j'"?.<...|
+00000110  d4 3c 1f 7b 78 97 f1 52  ca b9 cc a8 2b 2b be a2  |.<.{x..R....++..|
+00000120  fb 9b 47 f1 d4 c0 8e eb  3b c2 5b 4d 74 18 c3 ce  |..G.....;.[Mt...|
+00000130  0c a7 8d 3e 1c f8 13 5e  8e 20 68 a8 1c 75 bd f4  |...>...^. h..u..|
+00000140  5a ba 16 71 8c 97 db 6d  90 7c 64 56 0d 29 99 16  |Z..q...m.|dV.)..|
+00000150  9b f2 85 4c 84 11 b0 c4  76 f2 d8 bd 7f 19 cb 80  |...L....v.......|
+00000160  ec ad 18 e0 d5 c7 a7 f7  70 08 36 c6 0c 8a 88 ef  |........p.6.....|
+00000170  d9 20 7e e2 b8 a7 c9 18  26 d3 8e c6 d6 48 02 1c  |. ~.....&....H..|
+00000180  cb 02 7b 52 93 dc 4b da  82 9d 07 b9 65 0d 2a 7a  |..{R..K.....e.*z|
+00000190  3a 8b 3a 3d 58 79 e2 a8  14 83 25 06 64 e0 48 71  |:.:=Xy....%.d.Hq|
+000001a0  ef 2f 28 74 3f 46 04 f5  60 01 fb 53 d5 ff ca 7f  |./(t?F..`..S....|
+000001b0  89 4c 80 e6 e7 44 cb ad  93 d0 6a 8a 14 13 cc 09  |.L...D....j.....|
+000001c0  bf 54 12 56 94 17 1e f3  c5 7a 06 d3 28 3d 61 0d  |.T.V.....z..(=a.|
+000001d0  1e ad d3 55 28 1e e7 f6  6a e6 da 31 3d 99 61 df  |...U(...j..1=.a.|
+000001e0  94 d1 1a 58 f6 06 55 0a  43 20 23 dc 58 2b d4 db  |...X..U.C #.X+..|
+000001f0  35 91 16 e1 29 62 e7 fd  aa fe 65 d7 ef b2 a6 2b  |5...)b....e....+|
+00000200  6b c8 29 4b c0 94 ca bc  32 c4 d8 7a 2a 66 ea 25  |k.)K....2..z*f.%|
+00000210  ee 8f fc 85 28 5f b6 1a  11 0b cb dc 57 0b 70 7e  |....(_......W.p~|
+00000220  58 fc f5 09 41 88 0d a0  fc 03 58 a6 e3 48 29 ed  |X...A.....X..H).|
+00000230  4e e4 ff cc 4b 42 fd 53  e7 e5 2d 57 0e 6a 88 96  |N...KB.S..-W.j..|
+00000240  12 03 54 c3 de 8f 9a 46  98 2c ef ac cd 72 bc 7f  |..T....F.,...r..|
+00000250  f6 1b cb 98 d4 0c 46 32  1e 18 51 39 d1 ee bf 83  |......F2..Q9....|
+00000260  71 e1 df 3a 31 82 22 2f  ba 0e 69 a3 93 9d 0c 5c  |q..:1."/..i....\|
+00000270  8f e5 ea e8 25 26 b1 40  8e 19 0c f4 55 ff 7b cb  |....%&.@....U.{.|
+00000280  96 d2 0f 07 a0 da 99 38  df 63 9b 9e 33 5b 87 f2  |.......8.c..3[..|
+00000290  1b f7 3f 36 e4 65 ae 95  69 0f ec fc 34 fb 1e e5  |..?6.e..i...4...|
+000002a0  f7 ce 78 b0 c5 d6 94 e8  e5 ee 37 56 20 ac 58 c4  |..x.......7V .X.|
+000002b0  3a 5e cd e2 7f ac 23 c6  5e 2e 45 aa 8a d5 ea 0e  |:^....#.^.E.....|
+000002c0  0b 1d 13 19 72 0f 8d 48  6b 2f aa 8d d3 74 bb d2  |....r..Hk/...t..|
+000002d0  ff fb 46 f7 7f 7d 03 50  9e 3b a8 2d 73 c4 e5 db  |..F..}.P.;.-s...|
+000002e0  82 8a 48 5f b4 4e 49 35  4b 04 ca 70 35 30 c4 c9  |..H_.NI5K..p50..|
+000002f0  d5 94 cb 58 e3 40 e4 8f  3f 17 f5 dd c8 80 d9 41  |...X.@..?......A|
+00000300  e2 2a 7b 63 e7 87 84 9a  aa 54 3c 1f 4b 64 7b 32  |.*{c.....T<.Kd{2|
+00000310  17 d4 f3 17 03 03 00 99  47 1a 1f d9 17 60 17 4a  |........G....`.J|
+00000320  7a 68 c2 69 4f 59 6e b5  72 2f e9 a8 42 db 9c 49  |zh.iOYn.r/..B..I|
+00000330  62 3c db 0c fd 49 2f 0b  4f fa de db ef 7d 5e 60  |b<...I/.O....}^`|
+00000340  6b 99 39 ab b3 44 ac bc  68 2b 86 fd db 91 63 6c  |k.9..D..h+....cl|
+00000350  da 2f 6b 32 c4 99 b4 51  84 5c a8 0d 1d 31 05 f3  |./k2...Q.\...1..|
+00000360  45 e3 b4 83 3d c8 17 2e  f9 4e f7 61 6c 4b e5 d4  |E...=....N.alK..|
+00000370  24 04 2e 3f c9 f4 c9 8a  2d 8f 50 d0 c2 f8 35 56  |$..?....-.P...5V|
+00000380  1a 59 08 99 3d 0e 47 ea  54 44 75 d1 2b 31 28 71  |.Y..=.G.TDu.+1(q|
+00000390  fb 88 69 0a d2 50 30 77  41 ab ed 29 51 58 75 87  |..i..P0wA..)QXu.|
+000003a0  5a 59 bc 66 6b f3 d5 5f  ad c4 26 9d e6 a8 7e 70  |ZY.fk.._..&...~p|
+000003b0  b3 17 03 03 00 35 fe f7  08 e7 c6 3e 00 c3 5e a3  |.....5.....>..^.|
+000003c0  87 23 df 10 46 4f bb 17  ee bf 93 df b7 6d f0 45  |.#..FO.......m.E|
+000003d0  77 bf 60 6d f9 bb ce 58  f2 59 4a 40 5e d6 dd 0b  |w.`m...X.YJ@^...|
+000003e0  19 9a 41 8e 6b 03 16 e3  ce cd b6                 |..A.k......|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 97 2c 39 3a a5  |..........5.,9:.|
-00000010  32 33 e5 74 43 97 98 ef  ef 30 de 27 8b f7 b5 ab  |23.tC....0.'....|
-00000020  dd af 87 7c a5 5e 76 cf  50 2a 03 f8 94 a4 7a df  |...|.^v.P*....z.|
-00000030  14 0a 2d 39 57 3b 02 97  c5 d7 63 85 21 3f 55 27  |..-9W;....c.!?U'|
-00000040  17 03 03 00 17 7c b4 8b  82 f0 0a ec 6f fa 60 ef  |.....|......o.`.|
-00000050  4c 0a 1c 0b ad 99 c3 89  fb a4 40 2c 17 03 03 00  |L.........@,....|
-00000060  13 f2 d5 58 ba 6b ca e8  f4 14 4c 66 23 38 f2 e8  |...X.k....Lf#8..|
-00000070  ea a9 ba c1                                       |....|
+00000000  14 03 03 00 01 01 17 03  03 00 35 3c 85 dc 33 0a  |..........5<..3.|
+00000010  bd 78 f0 fc 0a 07 3a 9e  a5 31 ca b8 f6 23 d5 26  |.x....:..1...#.&|
+00000020  2a 60 ce d9 d2 da 37 e5  e8 27 bb 99 a3 43 ad 66  |*`....7..'...C.f|
+00000030  e2 07 33 de ca dc 2f d4  73 f4 71 50 d0 99 3b 7d  |..3.../.s.qP..;}|
+00000040  17 03 03 00 17 de 7a 55  7a 1d e3 1e 51 10 df 9e  |......zUz...Q...|
+00000050  30 a6 b9 15 79 b4 20 82  01 e5 b2 34 17 03 03 00  |0...y. ....4....|
+00000060  13 85 50 af bc 99 0b eb  84 58 b9 6c 46 88 22 b0  |..P......X.lF.".|
+00000070  7e 42 79 01                                       |~By.|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-AES256-SHA384 b/src/crypto/tls/testdata/Client-TLSv13-AES256-SHA384
index 8ea3ed6788..39b2e0982a 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-AES256-SHA384
+++ b/src/crypto/tls/testdata/Client-TLSv13-AES256-SHA384
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,86 +7,87 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 71 00 90 30 07  |....z...v..q..0.|
-00000010  24 01 ae 33 b2 e8 4f 1f  9a 2c 83 e5 7b 30 1e a2  |$..3..O..,..{0..|
-00000020  8e 4a d0 df d1 ec 23 b5  ba aa 75 20 00 00 00 00  |.J....#...u ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 fc b2 8e 30 c0  |....z...v.....0.|
+00000010  a2 bd d8 1c 4b 68 bc e0  a1 56 5f 5b 05 54 b7 7a  |....Kh...V_[.T.z|
+00000020  60 9a 49 68 f5 f4 f0 b1  49 27 79 20 00 00 00 00  |`.Ih....I'y ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 02 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 06  |..+.....3.$... .|
-00000060  2a 26 bd 81 c2 90 9b 17  6e d0 b5 ab 72 e6 93 ce  |*&......n...r...|
-00000070  53 6d 8c 54 b5 a4 50 91  93 32 6e 88 e6 b2 69 14  |Sm.T..P..2n...i.|
-00000080  03 03 00 01 01 17 03 03  00 17 7d 11 37 f0 18 b1  |..........}.7...|
-00000090  53 55 38 bb 12 7c e8 b3  89 bc 35 fb 2a 36 d1 0f  |SU8..|....5.*6..|
-000000a0  3a 17 03 03 02 6d a0 fa  dc 8e ac a6 90 5a 20 0e  |:....m.......Z .|
-000000b0  ee 22 89 7b 69 5b c9 1a  a1 c6 43 b9 40 f6 85 78  |.".{i[....C.@..x|
-000000c0  61 0b 14 c6 e6 3b a9 ac  4c 7a 96 9b 7b 87 d0 ce  |a....;..Lz..{...|
-000000d0  42 cc 75 9d fc 06 44 3e  e8 12 3a 94 b7 de 86 c4  |B.u...D>..:.....|
-000000e0  b5 66 e1 f5 48 21 f7 f1  58 7f 23 6c 3f 76 a0 cb  |.f..H!..X.#l?v..|
-000000f0  a7 f6 72 34 07 fa c1 55  3e 61 cf 72 c4 6c f1 ca  |..r4...U>a.r.l..|
-00000100  dd dc ec 66 3d 7b f6 cf  53 3b 28 bd 27 1b aa a6  |...f={..S;(.'...|
-00000110  28 2a ab fa 48 a5 08 67  b5 49 c7 c7 5d f8 2c ec  |(*..H..g.I..].,.|
-00000120  83 af 58 33 42 6c c1 4c  94 17 7e 36 1c a9 48 34  |..X3Bl.L..~6..H4|
-00000130  5f 26 78 f6 69 88 3a a5  1b d1 76 ad 88 63 25 33  |_&x.i.:...v..c%3|
-00000140  0d e3 d0 34 6b 7f fc 96  2b 8d 22 6f 3f 21 8a 14  |...4k...+."o?!..|
-00000150  01 e0 5c 54 6c c3 b8 12  f9 17 f5 4c ce e0 bd 10  |..\Tl......L....|
-00000160  e7 e1 29 24 73 94 c2 5e  b0 ad d3 91 9e 87 ea 23  |..)$s..^.......#|
-00000170  4d fd 8f 12 ca 87 ff 2e  93 9f 16 a8 18 e1 66 8f  |M.............f.|
-00000180  50 76 15 cd 70 5c a2 1d  91 51 e5 54 13 5f 73 d3  |Pv..p\...Q.T._s.|
-00000190  b2 6e b1 27 80 0b 3d 64  d5 fa f3 a4 fb 77 33 cb  |.n.'..=d.....w3.|
-000001a0  ac 93 54 36 2d 71 c3 9e  dd 37 02 a9 9d b0 9b ac  |..T6-q...7......|
-000001b0  f8 c5 dc 43 9b d8 db c7  d0 fb cf 69 fa 62 e4 9d  |...C.......i.b..|
-000001c0  b7 04 f8 49 d3 a7 8d bd  cf 8a e3 4a 62 cb bb 29  |...I.......Jb..)|
-000001d0  b5 db 21 80 76 eb 28 67  34 1e 40 0b 83 83 19 10  |..!.v.(g4.@.....|
-000001e0  46 8f bd 78 d6 7c 05 c2  19 82 1c e8 7d 84 f2 79  |F..x.|......}..y|
-000001f0  c4 a6 e0 f7 7e df 70 7f  42 48 9f e4 99 03 7f 9e  |....~.p.BH......|
-00000200  e8 fd 75 c3 8a 55 55 8e  08 2e 62 28 a5 16 b7 11  |..u..UU...b(....|
-00000210  d8 9a 11 48 46 ad d3 ba  4f 91 c8 fd 72 d9 df 98  |...HF...O...r...|
-00000220  1a 59 51 55 af ab 73 b9  f3 bf fe 7d 55 7d 44 54  |.YQU..s....}U}DT|
-00000230  cd bb f3 eb 6e ff 5a 09  e9 b9 c1 66 97 8e a5 7c  |....n.Z....f...||
-00000240  89 4a 51 1d 8b e4 40 fb  97 ce ef 9d 7c 02 e4 db  |.JQ...@.....|...|
-00000250  f1 ca 01 d9 05 b4 de 10  23 33 92 ff 26 3b 09 8f  |........#3..&;..|
-00000260  11 7c 37 ad fb 58 ed 7a  10 08 fd df 98 dd d6 c5  |.|7..X.z........|
-00000270  b8 fd 59 37 21 1d 6e 27  8a 56 24 45 e7 64 61 0b  |..Y7!.n'.V$E.da.|
-00000280  20 2d bc 79 89 fa 6d 7a  06 77 61 0c 60 25 e2 79  | -.y..mz.wa.`%.y|
-00000290  6a 54 9e 5b 4b 33 68 17  da 63 ba a7 f9 ad 2c 84  |jT.[K3h..c....,.|
-000002a0  52 e9 27 85 71 74 d2 5f  c9 f8 8e 67 f7 47 58 f5  |R.'.qt._...g.GX.|
-000002b0  e4 72 a7 bd 1c 94 4b 4d  13 5a 62 69 d9 6f 3a 51  |.r....KM.Zbi.o:Q|
-000002c0  f0 18 90 e5 b6 21 23 97  70 74 93 ba 9b bc dc e4  |.....!#.pt......|
-000002d0  3d 9c 52 3f 93 f0 48 05  e8 50 d0 b4 98 92 7a 18  |=.R?..H..P....z.|
-000002e0  3f 39 ba f8 f7 ee 19 b0  ce ac d0 ab 9e 83 ee 0e  |?9..............|
-000002f0  5d 2a 72 74 a8 8b 4d de  6b a9 91 ad b4 a4 26 99  |]*rt..M.k.....&.|
-00000300  4e aa 6d 48 77 83 78 78  be 96 f1 17 d6 96 74 4a  |N.mHw.xx......tJ|
-00000310  80 d1 5b 17 03 03 00 99  d9 40 96 5c fb 5d 65 69  |..[......@.\.]ei|
-00000320  db 54 a8 f6 8c b7 d3 25  8d 2d c5 f1 40 5b f2 26  |.T.....%.-..@[.&|
-00000330  f3 86 9e 61 6a a5 b9 66  b1 27 b1 20 6b 2c 64 84  |...aj..f.'. k,d.|
-00000340  3f 48 24 5d d9 90 4b d1  ed 1b 0e 05 84 7f ad 0e  |?H$]..K.........|
-00000350  e6 75 f6 f9 33 90 73 7c  88 10 d7 e9 74 41 4b c3  |.u..3.s|....tAK.|
-00000360  19 8e e1 a8 a6 7c 3c 9a  bc 69 a7 e7 bb d6 af 98  |.....|<..i......|
-00000370  f1 49 53 14 95 80 d6 95  81 5a 5e 88 2c 29 70 df  |.IS......Z^.,)p.|
-00000380  b2 df fe f3 17 03 e7 de  af 12 57 c5 7a ef 70 eb  |..........W.z.p.|
-00000390  8a c6 c3 05 de 5b 15 af  5f 54 8c 7b 23 b7 e1 f1  |.....[.._T.{#...|
-000003a0  30 b1 ed 34 4c 59 f5 68  c2 50 e8 c3 83 78 1d 1f  |0..4LY.h.P...x..|
-000003b0  eb 17 03 03 00 45 1a d4  61 ba 4a a5 1e 02 80 04  |.....E..a.J.....|
-000003c0  2a 19 11 af 8c e9 bd ab  22 6b 75 41 a8 40 de 57  |*......."kuA.@.W|
-000003d0  54 8c dc 09 cc 57 76 82  27 5e 59 0c 30 f7 9d c4  |T....Wv.'^Y.0...|
-000003e0  fe 1c 09 f2 f4 5f e0 79  ac 02 06 80 f3 60 c4 92  |....._.y.....`..|
-000003f0  cd 6a df b6 46 7c de 90  8d bb 94                 |.j..F|.....|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 d3  |..+.....3.$... .|
+00000060  d7 9e 72 ae 5f f9 92 24  6b 76 e5 a1 00 71 78 cf  |..r._..$kv...qx.|
+00000070  e9 55 29 5b fe a8 71 14  e9 02 b0 65 12 e8 04 14  |.U)[..q....e....|
+00000080  03 03 00 01 01 17 03 03  00 17 24 a0 73 a6 7b ab  |..........$.s.{.|
+00000090  9c d8 69 e7 15 68 4b 26  0a 15 0c ff c4 40 7d b8  |..i..hK&.....@}.|
+000000a0  ad 17 03 03 02 6d 05 b2  f9 6e 05 48 18 92 2b 87  |.....m...n.H..+.|
+000000b0  29 1c 5b 8c a8 ae 0e 4b  fc 3b 1e b9 2c c2 0c 33  |).[....K.;..,..3|
+000000c0  f8 5d 16 37 39 b3 b2 4e  12 a4 02 4c fb 3b 16 4e  |.].79..N...L.;.N|
+000000d0  63 92 72 56 49 d6 5b 63  34 20 67 c8 07 a2 b6 0d  |c.rVI.[c4 g.....|
+000000e0  f1 06 b4 bd 88 54 4d 33  66 1a d4 fc 42 9c 4e 00  |.....TM3f...B.N.|
+000000f0  40 34 5d cf c4 5d f1 ba  14 de 34 50 f5 2f 3d b7  |@4]..]....4P./=.|
+00000100  1c 17 33 6e 9a 2b 39 1b  f1 a6 0d fb b7 0c c3 b3  |..3n.+9.........|
+00000110  02 f8 0c 30 e8 31 d7 ee  bf a1 a0 64 28 67 64 50  |...0.1.....d(gdP|
+00000120  24 ce 37 fd 15 2e c7 13  1b 8b f0 22 19 e4 ec c8  |$.7........"....|
+00000130  8c b0 76 b8 d0 2d 87 99  86 8b ec ca e9 9d 8f 23  |..v..-.........#|
+00000140  bf 3d bf b8 ed 85 34 85  31 15 dd 7a 36 f7 3e 0e  |.=....4.1..z6.>.|
+00000150  df e7 4c e8 ae 5a 98 05  f8 34 76 33 c3 4c 81 fb  |..L..Z...4v3.L..|
+00000160  d8 29 14 b3 47 32 eb 5f  73 5a 95 4a c7 3d 89 2a  |.)..G2._sZ.J.=.*|
+00000170  21 22 bd 97 b2 9d 4b dd  2c eb a5 e3 37 d6 a9 84  |!"....K.,...7...|
+00000180  0c b6 02 2f 1f 5c 18 1b  be 92 be 58 a7 e1 a0 49  |.../.\.....X...I|
+00000190  95 dc d7 07 70 b1 5b 15  86 3f 55 fc ad 32 39 5d  |....p.[..?U..29]|
+000001a0  95 63 fd d4 85 55 b2 e9  c2 68 d0 09 f9 53 f9 4f  |.c...U...h...S.O|
+000001b0  0e 89 1c a0 85 74 7f 10  97 e7 86 8a 18 28 83 e6  |.....t.......(..|
+000001c0  66 3c 2a f5 8f 14 1d 90  58 ef ad 1f d3 7f 42 0a  |f<*.....X.....B.|
+000001d0  08 d5 b4 96 b0 9d 3f 72  49 5a 06 13 7c 4b bc 79  |......?rIZ..|K.y|
+000001e0  8c db 1f 1f 5e 3d c2 fe  ad 57 e6 d9 14 bb d0 72  |....^=...W.....r|
+000001f0  d7 90 14 35 ec 34 31 f6  fd b1 fd 3d 46 6e 4f a7  |...5.41....=FnO.|
+00000200  1e 7d 14 40 17 0c ef c0  c8 70 fe dc 6a f1 78 6a  |.}.@.....p..j.xj|
+00000210  c6 df 70 2e ac 07 d9 6d  f7 90 0e 4a 92 08 cf 88  |..p....m...J....|
+00000220  26 c0 11 4a 7d e4 34 ba  86 43 cb 94 f8 d7 61 5a  |&..J}.4..C....aZ|
+00000230  05 f5 f9 49 b4 04 f1 c8  43 b6 12 52 ae cf 7c b9  |...I....C..R..|.|
+00000240  39 d1 90 91 6e 80 43 cf  4c 23 3d 7c c0 c8 88 46  |9...n.C.L#=|...F|
+00000250  e2 91 86 e4 41 cb ed f2  3a 92 01 9f 04 7c d2 81  |....A...:....|..|
+00000260  42 18 6c 04 91 25 8a 29  0e d9 23 aa 58 e5 e8 ee  |B.l..%.)..#.X...|
+00000270  39 79 a5 a7 3a 4d e3 cc  15 79 3f 7b f9 e4 21 76  |9y..:M...y?{..!v|
+00000280  5c 9a d8 de d3 9a f3 9e  69 44 c0 2a 56 04 b4 d2  |\.......iD.*V...|
+00000290  c3 c1 4c d6 ad b8 d8 ad  c8 c2 0d fa ea e1 bc 11  |..L.............|
+000002a0  67 15 80 ef c6 01 48 7f  de f1 c2 36 a7 dd a9 38  |g.....H....6...8|
+000002b0  31 8b 14 ed 5c 2a 66 55  3b 25 e3 85 cb d9 a9 82  |1...\*fU;%......|
+000002c0  7a 95 99 b3 c8 aa ac 66  30 b0 c5 3d d1 2a ab b9  |z......f0..=.*..|
+000002d0  56 b3 5e 9d e0 d7 81 ac  6f 2e ae 62 a2 ef ca ef  |V.^.....o..b....|
+000002e0  7b cf 0f af f6 0b 29 97  2d 27 33 58 ad b6 1b d2  |{.....).-'3X....|
+000002f0  0a c7 11 ec 89 b0 0d 2e  ff 27 64 c2 bf 8e 85 a4  |.........'d.....|
+00000300  ea 14 52 71 55 1a ec ef  0d ff 14 00 ce 3d 9d 3d  |..RqU........=.=|
+00000310  a9 d3 17 17 03 03 00 99  5e ba 1f f3 93 71 7a 88  |........^....qz.|
+00000320  bc 14 71 7e 85 15 c9 da  fe ee c1 b1 3d f6 ff 67  |..q~........=..g|
+00000330  fd 28 96 f3 44 44 6f 8f  32 b4 22 be 69 29 e6 dd  |.(..DDo.2.".i)..|
+00000340  60 07 1d 98 0b 0c 0f ec  df fa 46 c0 67 66 f2 18  |`.........F.gf..|
+00000350  bf 5e 36 56 b2 b2 25 ef  aa 76 51 ea f7 47 1d ee  |.^6V..%..vQ..G..|
+00000360  7b 25 e5 97 89 4a 04 07  f8 ff 05 73 25 71 e4 28  |{%...J.....s%q.(|
+00000370  9e 91 45 ff 4c df 82 dc  85 16 02 ba 15 9b 37 91  |..E.L.........7.|
+00000380  eb 65 12 66 38 59 8a 85  a2 2e af 2f d7 74 75 c1  |.e.f8Y...../.tu.|
+00000390  7e f6 64 87 7e 4c 86 c8  25 bb 59 8d f8 9c e3 e5  |~.d.~L..%.Y.....|
+000003a0  a4 53 a5 c6 00 bd 78 d8  07 0e f5 42 92 e3 42 11  |.S....x....B..B.|
+000003b0  57 17 03 03 00 45 77 98  db b2 e4 66 e3 dc 3e 4f  |W....Ew....f..>O|
+000003c0  49 92 b3 ac 74 cd 1c 3b  e2 81 3c 64 0b a5 c9 8c  |I...t..;..<d....|
+000003d0  7e 9a 22 9f df 7e e8 68  99 56 93 49 d5 81 3f c1  |~."..~.h.V.I..?.|
+000003e0  de 00 07 bd 6e ba 25 00  63 f0 82 41 46 ba 04 b7  |....n.%.c..AF...|
+000003f0  1f 37 aa 1c f6 49 8f e6  83 e8 23                 |.7...I....#|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 45 8c 37 d5 7e 3e  |..........E.7.~>|
-00000010  c4 24 64 8b fa fc 8d 03  a7 92 34 35 c3 2c f2 54  |.$d.......45.,.T|
-00000020  43 06 5d 8a c9 c0 e8 7d  22 d3 99 58 01 0e 44 aa  |C.]....}"..X..D.|
-00000030  3c 26 eb 68 45 14 cd bf  6c 61 bb 31 91 9d b4 57  |<&.hE...la.1...W|
-00000040  42 79 14 8c 67 c6 65 52  15 07 c8 f3 c3 9f 23 ef  |By..g.eR......#.|
-00000050  17 03 03 00 17 21 51 dd  67 e4 be f8 7c 7b 84 0d  |.....!Q.g...|{..|
-00000060  78 3c 7f ac 50 f8 34 7b  fb 38 09 d0 17 03 03 00  |x<..P.4{.8......|
-00000070  13 35 1a 52 9d de 4a 74  1f 01 70 de 05 c5 c3 b9  |.5.R..Jt..p.....|
-00000080  e6 de 9c 0f                                       |....|
+00000000  14 03 03 00 01 01 17 03  03 00 45 75 66 f7 1c cc  |..........Euf...|
+00000010  a5 d2 e0 60 37 ff ab 89  16 88 c1 27 ba 57 0c 0d  |...`7......'.W..|
+00000020  28 c9 c3 8a 53 57 05 1c  2a 47 52 b6 98 f9 26 4f  |(...SW..*GR...&O|
+00000030  34 7c 7a 71 00 87 47 c3  a5 b8 0c 8c 03 87 5e de  |4|zq..G.......^.|
+00000040  a1 40 33 9b e1 7f ad 36  71 10 9a e7 28 45 e1 e2  |.@3....6q...(E..|
+00000050  17 03 03 00 17 a3 83 88  cd fa fc f4 60 12 e7 be  |............`...|
+00000060  8d 11 31 74 3f 25 3e 32  6f 7f 73 57 17 03 03 00  |..1t?%>2o.sW....|
+00000070  13 7f ab 29 bc f6 7e ea  f7 17 ee 7a ef 38 ff bc  |...)..~....z.8..|
+00000080  82 68 f5 07                                       |.h..|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ALPN b/src/crypto/tls/testdata/Client-TLSv13-ALPN
index 1d8da269de..b291259027 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ALPN
+++ b/src/crypto/tls/testdata/Client-TLSv13-ALPN
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 0e 01 00 01  0a 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 12 01 00 01  0e 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,87 +7,87 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 8f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
+00000080  01 00 00 93 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 10 00 10  00 0e 06 70 72 6f 74 6f  |...........proto|
-000000d0  32 06 70 72 6f 74 6f 31  00 12 00 00 00 2b 00 09  |2.proto1.....+..|
-000000e0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
-000000f0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
-00000100  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
-00000110  cb 3b 74                                          |.;t|
+000000c0  01 00 01 00 00 17 00 00  00 10 00 10 00 0e 06 70  |...............p|
+000000d0  72 6f 74 6f 32 06 70 72  6f 74 6f 31 00 12 00 00  |roto2.proto1....|
+000000e0  00 2b 00 09 08 03 04 03  03 03 02 03 01 00 33 00  |.+............3.|
+000000f0  26 00 24 00 1d 00 20 2f  e5 7d a3 47 cd 62 43 15  |&.$... /.}.G.bC.|
+00000100  28 da ac 5f bb 29 07 30  ff f6 84 af c4 cf c2 ed  |(.._.).0........|
+00000110  90 99 5f 58 cb 3b 74                              |.._X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 c2 91 70 7a 7a  |....z...v....pzz|
-00000010  d4 c9 46 7a e9 44 d1 c0  92 a6 0a 43 34 08 b2 ce  |..Fz.D.....C4...|
-00000020  14 99 8f 6c f7 37 fb a1  28 00 ae 20 00 00 00 00  |...l.7..(.. ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 90 3b d5 53 eb  |....z...v...;.S.|
+00000010  af 38 68 af fc 8f 47 f5  3f 13 5c c5 46 9d 97 b7  |.8h...G.?.\.F...|
+00000020  e2 c4 0c 93 d4 91 2b 45  77 11 1b 20 00 00 00 00  |......+Ew.. ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 60  |..+.....3.$... `|
-00000060  96 62 c2 30 4e ae b6 89  f2 06 e0 4e 8e 32 27 04  |.b.0N......N.2'.|
-00000070  b5 74 80 d8 c3 f5 76 7d  0e 0e e1 8d bc 2c 2c 14  |.t....v}.....,,.|
-00000080  03 03 00 01 01 17 03 03  00 24 45 c7 50 3e a9 63  |.........$E.P>.c|
-00000090  24 0b e9 80 3f 59 bb be  23 8a 5d 46 eb ee 17 9c  |$...?Y..#.]F....|
-000000a0  70 6f 52 1f 18 f3 9f 72  d6 35 44 55 91 d2 17 03  |poR....r.5DU....|
-000000b0  03 02 6d c2 c0 1f 53 2a  0c 3c 7f 08 c3 cb 53 4e  |..m...S*.<....SN|
-000000c0  b2 f5 b3 2d a5 10 e1 97  00 89 67 db 4e df ad 75  |...-......g.N..u|
-000000d0  94 b4 56 c4 8a a3 49 41  43 a1 3f aa 9b 8e e1 8d  |..V...IAC.?.....|
-000000e0  4c 9c 36 f6 80 da 4e 7f  00 10 c0 81 3e 45 1b a0  |L.6...N.....>E..|
-000000f0  b7 7f 2c bd eb 2a 8b c4  e6 fa c8 b3 59 28 f6 b8  |..,..*......Y(..|
-00000100  0a 93 cb b3 bf 28 e7 1a  ae a0 f5 ff 3a 42 f5 64  |.....(......:B.d|
-00000110  92 2c dd c2 24 77 2f a6  7e 23 63 3f 24 16 b3 d5  |.,..$w/.~#c?$...|
-00000120  b7 df 3f 30 23 a4 aa c9  14 78 6c f2 82 45 52 df  |..?0#....xl..ER.|
-00000130  cf a1 1d 35 fd 2a 30 89  14 38 5a 23 b1 63 2c c1  |...5.*0..8Z#.c,.|
-00000140  6d 6b 07 d0 41 38 4f 4c  87 d3 bd f1 ec ed 29 52  |mk..A8OL......)R|
-00000150  3d c7 74 3d e9 d3 ce 47  1c 24 d5 78 19 c9 5e 01  |=.t=...G.$.x..^.|
-00000160  66 a0 f1 8f ea a6 c1 e4  b4 e0 c2 2e d7 d6 64 36  |f.............d6|
-00000170  c9 bc d1 27 33 6f 26 a8  c6 aa 0d bc ae f9 2e bc  |...'3o&.........|
-00000180  f1 a7 82 42 09 83 62 88  c0 9f 20 95 a9 38 50 b4  |...B..b... ..8P.|
-00000190  55 d6 e9 f4 c6 a1 e6 67  a9 5f e4 15 97 44 13 ef  |U......g._...D..|
-000001a0  d3 50 8b 61 38 5e 89 75  b1 cf 6a 6f 0c c5 26 13  |.P.a8^.u..jo..&.|
-000001b0  2c 5a 26 c9 81 98 88 cd  ec 8c 2c 99 a0 ff 55 8f  |,Z&.......,...U.|
-000001c0  3f 9b c3 3b 52 d0 a3 3a  f9 b8 f0 17 81 53 00 f3  |?..;R..:.....S..|
-000001d0  ef 72 b3 4e b9 65 28 8f  a2 48 dc dd 6b 16 61 c3  |.r.N.e(..H..k.a.|
-000001e0  4e 0e c0 1c ac 8c 40 28  27 63 66 c7 74 40 8d 93  |N.....@('cf.t@..|
-000001f0  71 e9 f6 3f d8 8d 5d c6  28 11 4f ac 55 6f 80 1b  |q..?..].(.O.Uo..|
-00000200  2e 84 05 94 e0 4f e7 63  62 65 c7 52 99 49 2f 5d  |.....O.cbe.R.I/]|
-00000210  b4 99 d3 c3 fa b9 f5 83  aa 28 2e 9d ce af 72 7f  |.........(....r.|
-00000220  57 ea 81 f3 bf b5 d7 93  3a 1f a0 83 4d 8a 91 85  |W.......:...M...|
-00000230  fe b7 a1 b3 cb 1d b1 85  9b bb 36 1b 12 9f ed 13  |..........6.....|
-00000240  09 55 31 bd ee 61 06 57  b4 07 4d c6 1e fa b9 7f  |.U1..a.W..M.....|
-00000250  c7 b6 60 70 92 b7 9a ff  80 7d da 7f 2a 62 89 be  |..`p.....}..*b..|
-00000260  79 43 d3 ae 9c f1 00 6d  68 6c a3 f6 48 6e e0 48  |yC.....mhl..Hn.H|
-00000270  97 0f 5c 44 43 9f a8 88  27 96 fc 53 a0 e1 f2 7a  |..\DC...'..S...z|
-00000280  a6 a7 d9 96 2e 3d c4 e0  d9 18 79 ec 83 c2 9b da  |.....=....y.....|
-00000290  0b d4 8b 87 c5 98 f5 8b  e7 e3 d1 bd 2b 2b 42 e2  |............++B.|
-000002a0  4b 3e 64 88 4b 72 d0 35  cc c3 e6 68 c6 f6 4f 23  |K>d.Kr.5...h..O#|
-000002b0  39 a7 94 8d f3 e6 bd cd  d5 e9 8c 53 83 a7 87 09  |9..........S....|
-000002c0  15 fe ea eb 2e 56 da 6b  d9 5b b7 b1 c5 c4 ba 65  |.....V.k.[.....e|
-000002d0  39 89 16 f5 f6 4e e6 3a  63 34 1b 5d f5 fa 6b 8d  |9....N.:c4.]..k.|
-000002e0  c3 49 07 88 12 ca 18 c5  50 da 74 44 c0 c0 33 bd  |.I......P.tD..3.|
-000002f0  2e 45 94 af e1 40 90 00  11 2d 08 7b fc e4 3b f0  |.E...@...-.{..;.|
-00000300  94 fd 5a 0c 3a f9 76 df  3b 5e a3 0d 0f e7 2d df  |..Z.:.v.;^....-.|
-00000310  fd e9 ce 45 5a 13 36 a6  18 ae 46 30 00 fc d5 e3  |...EZ.6...F0....|
-00000320  17 03 03 00 99 0e 35 b6  91 ad cd a6 62 6e 79 12  |......5.....bny.|
-00000330  53 d5 f0 78 72 c5 dd 94  00 e3 75 2c 11 a3 72 f6  |S..xr.....u,..r.|
-00000340  b7 b3 5e d9 51 79 d5 a9  1e 21 2f df 0d 53 9a c8  |..^.Qy...!/..S..|
-00000350  43 a9 58 e2 a9 3d 9a b4  b4 72 bb 62 65 4b 83 f8  |C.X..=...r.beK..|
-00000360  cd 1b 58 e0 69 d9 87 3b  8d 05 42 e1 22 23 e9 5b  |..X.i..;..B."#.[|
-00000370  3a 5a 38 17 17 fb 3a 56  de fc 56 f8 77 12 31 4a  |:Z8...:V..V.w.1J|
-00000380  c5 38 ec 69 72 54 e5 63  2a a0 1e b4 7d 86 43 29  |.8.irT.c*...}.C)|
-00000390  21 ba 56 c2 d9 1b 9f a4  c1 02 f3 83 c1 9a 56 69  |!.V...........Vi|
-000003a0  5c 9e 5f ae 94 9d 6f 03  ec 75 7a 19 98 cd a9 dd  |\._...o..uz.....|
-000003b0  4a 01 41 72 2e 60 9f ca  4c d2 27 d9 0f 4f 17 03  |J.Ar.`..L.'..O..|
-000003c0  03 00 35 5d 61 3c 07 70  2f 35 ba d0 93 44 16 bd  |..5]a<.p/5...D..|
-000003d0  73 4b a0 fb 05 52 6a cc  5a 2e f2 94 d6 77 98 03  |sK...Rj.Z....w..|
-000003e0  c3 2e 8e a9 d1 38 14 d2  cd e6 e3 b6 ad ec d6 a0  |.....8..........|
-000003f0  cf b0 58 5f 8f d3 43 4b                           |..X_..CK|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 a6  |..+.....3.$... .|
+00000060  5a 75 77 6c 3a 65 d9 7d  c4 72 ef 66 3e 15 80 e4  |Zuwl:e.}.r.f>...|
+00000070  b6 c5 55 2e fb cf 3a 17  9e 28 de de b1 ce 06 14  |..U...:..(......|
+00000080  03 03 00 01 01 17 03 03  00 24 45 28 86 50 9e 48  |.........$E(.P.H|
+00000090  66 13 75 a6 43 19 b2 ce  79 2b 5c 06 d0 f7 ff 4c  |f.u.C...y+\....L|
+000000a0  d5 bb 39 67 50 aa 78 97  1b 5a 58 a7 95 44 17 03  |..9gP.x..ZX..D..|
+000000b0  03 02 6d 10 9e 3c f4 7e  c6 2d e4 2a 04 10 95 dd  |..m..<.~.-.*....|
+000000c0  47 56 02 08 91 5e 60 c5  5c eb a1 65 f0 9d a6 2a  |GV...^`.\..e...*|
+000000d0  55 bc fe 58 1a b0 3e f9  d6 f0 1c 7c 70 c5 bf 14  |U..X..>....|p...|
+000000e0  3c c7 bf a4 ac f8 c5 77  1c 7b f2 bb 15 01 f8 c6  |<......w.{......|
+000000f0  2c 19 dd 22 29 3b 32 09  33 b7 c5 be 2e 9b 43 7c  |,..");2.3.....C||
+00000100  1f b7 a2 99 09 e6 42 c3  13 b0 10 2b 15 e8 8a 89  |......B....+....|
+00000110  62 ac 27 b1 09 cc e3 78  67 07 8e c9 21 d4 17 df  |b.'....xg...!...|
+00000120  dc db 30 9b 8e a4 6f 8e  fb 1b 5a d9 22 b0 5d 9b  |..0...o...Z.".].|
+00000130  f1 d0 c7 d6 5e 64 00 23  36 96 8e 22 39 ab 52 3a  |....^d.#6.."9.R:|
+00000140  10 02 c3 6b 02 c7 87 8f  cd 45 40 18 26 41 ca 06  |...k.....E@.&A..|
+00000150  36 09 59 fc 0c d8 fc fe  35 b6 fb 9e 2a e3 db 29  |6.Y.....5...*..)|
+00000160  dc 1b 89 08 f2 e5 06 a1  2a 62 cb 89 39 be 30 47  |........*b..9.0G|
+00000170  81 5d 12 5d e5 f2 38 ae  f9 6a 0a bc b6 7d 1a fc  |.].]..8..j...}..|
+00000180  62 24 1f ab 25 1a 81 4e  29 c1 32 89 9e 75 3d e9  |b$..%..N).2..u=.|
+00000190  aa a7 ab 15 0f eb f6 e6  a4 1c c2 c6 48 8b 88 a9  |............H...|
+000001a0  24 34 92 49 f9 85 4e 2c  b5 eb 69 d7 55 db e5 b6  |$4.I..N,..i.U...|
+000001b0  ec 09 5d 08 b0 d3 8f 0c  01 47 46 3f f8 ae eb ef  |..]......GF?....|
+000001c0  72 37 2e 48 03 5a 03 ed  1c 5e 6e be 59 f1 16 98  |r7.H.Z...^n.Y...|
+000001d0  f9 0e 3e 04 6d 9f 53 72  29 62 5b b3 f1 b9 1a 72  |..>.m.Sr)b[....r|
+000001e0  61 06 ad 97 e1 e1 31 d4  ae a0 92 02 27 94 66 ca  |a.....1.....'.f.|
+000001f0  21 37 dd 2e a4 b4 4b 8f  7d 47 1c 3c 3d 14 ca 92  |!7....K.}G.<=...|
+00000200  e3 fc 9f 73 4f 17 3e 2a  62 9b 45 bd 5d 6b d2 90  |...sO.>*b.E.]k..|
+00000210  b4 77 5b 61 81 52 10 b6  d4 0e 48 f4 d1 b4 a5 eb  |.w[a.R....H.....|
+00000220  4c c2 29 dd e0 74 b0 2b  d0 28 09 65 bc f2 f4 12  |L.)..t.+.(.e....|
+00000230  6d 25 c7 7d 84 39 4a 2a  36 4e 4c 94 bb 02 66 2e  |m%.}.9J*6NL...f.|
+00000240  58 17 0c 3d 1f aa 6b 25  92 d5 a3 39 9c 50 28 43  |X..=..k%...9.P(C|
+00000250  5c 39 17 34 4a 59 f9 6c  65 a3 4d 35 74 65 11 04  |\9.4JY.le.M5te..|
+00000260  25 99 d1 42 93 70 95 28  6f 59 a0 13 95 2c bb 79  |%..B.p.(oY...,.y|
+00000270  05 dd 8c 82 e1 08 57 6d  c4 8e fc c4 f5 49 17 1f  |......Wm.....I..|
+00000280  94 4c cc ea 6f cd ab a9  33 ed 4b fa 47 02 1a f2  |.L..o...3.K.G...|
+00000290  5b 64 8d 3f e4 65 ea 78  82 78 f0 0d eb 74 c1 cc  |[d.?.e.x.x...t..|
+000002a0  25 f7 d4 7c 74 fc 8d 53  76 f6 fb 31 62 8d d6 83  |%..|t..Sv..1b...|
+000002b0  57 56 43 dc 40 51 94 b0  44 db d2 7f f3 fe 58 ff  |WVC.@Q..D.....X.|
+000002c0  c5 13 22 aa bf 77 ea 16  93 85 b0 89 cf b2 1d 0b  |.."..w..........|
+000002d0  8c 89 9f 4c 68 43 98 53  c0 97 ba aa 82 d0 e5 e4  |...LhC.S........|
+000002e0  ce 8d 16 91 46 c0 ff 38  1f 2d 3d cd 9e 65 c9 7d  |....F..8.-=..e.}|
+000002f0  a2 b6 21 b3 55 9d 2c ff  b5 c7 aa cb 5a 51 ce e6  |..!.U.,.....ZQ..|
+00000300  5c 6f 72 58 fc 8d 49 68  13 b3 a9 14 03 8a 89 ff  |\orX..Ih........|
+00000310  1e 05 91 a3 30 64 3a 10  06 c8 1f b0 b8 b6 4d 95  |....0d:.......M.|
+00000320  17 03 03 00 99 2f cd 21  80 f7 39 77 c5 ed 5f b8  |...../.!..9w.._.|
+00000330  75 fb bd 82 f1 84 09 d3  bc 2f 21 f6 d3 a2 4b b1  |u......../!...K.|
+00000340  e4 67 59 7d db 64 47 20  19 9b 9d 68 33 4a 9d e1  |.gY}.dG ...h3J..|
+00000350  c5 ec cc ab 66 25 a2 1b  89 6c a6 03 b6 20 3d c6  |....f%...l... =.|
+00000360  03 fd 12 80 70 b9 e5 2e  27 c8 25 d2 00 00 4e e9  |....p...'.%...N.|
+00000370  1a 65 4a 52 31 a0 3f e6  7c fc 77 48 83 76 11 34  |.eJR1.?.|.wH.v.4|
+00000380  c1 71 36 0d 56 13 7f a2  3c 4a ac 5c 73 82 b1 f5  |.q6.V...<J.\s...|
+00000390  a9 ab 84 ec ac 79 de ea  ae 46 a0 41 53 33 e9 be  |.....y...F.AS3..|
+000003a0  09 7f d5 f6 a4 93 6c 93  0f 98 c6 49 26 68 f9 6a  |......l....I&h.j|
+000003b0  66 d7 04 15 ae e0 5e f6  2e 78 cf e3 a5 d2 17 03  |f.....^..x......|
+000003c0  03 00 35 35 ac 0b 2c c1  a1 90 3a 67 58 a8 3c 6c  |..55..,...:gX.<l|
+000003d0  9c af e9 f5 e7 c2 e3 cd  fd 56 a9 de 8f 33 c5 97  |.........V...3..|
+000003e0  a5 06 70 53 3b fb 3d 17  5a 05 f4 2b 72 b1 6b c5  |..pS;.=.Z..+r.k.|
+000003f0  92 25 8a c2 2d 18 20 5c                           |.%..-. \|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 3d 0a fd 33 39  |..........5=..39|
-00000010  b6 94 43 53 ae ee 3f 4e  c6 2d a2 3a f0 ef 94 7d  |..CS..?N.-.:...}|
-00000020  32 0a b6 90 cd a1 6f 29  88 ff 3c 91 c1 e5 e5 ae  |2.....o)..<.....|
-00000030  b7 a0 0b b3 c0 e6 37 9d  06 8b d8 ae 06 c0 0e 7b  |......7........{|
-00000040  17 03 03 00 17 c2 a1 82  db df fa 54 28 79 a0 0c  |...........T(y..|
-00000050  97 8c 82 ee 22 c9 b9 35  32 7a 21 4b 17 03 03 00  |...."..52z!K....|
-00000060  13 87 2b f8 38 81 df fa  e5 2e ff e2 d2 51 3e bc  |..+.8........Q>.|
-00000070  dd d3 e8 62                                       |...b|
+00000000  14 03 03 00 01 01 17 03  03 00 35 fc ac 12 d4 36  |..........5....6|
+00000010  13 c6 fe 02 f8 ea 05 0b  5c cb 31 d4 8d ee ba 6f  |........\.1....o|
+00000020  36 ac aa 89 b9 10 f3 b3  a1 89 03 0e d2 5a 92 c7  |6............Z..|
+00000030  62 4c 56 0c 42 69 68 a5  d7 79 cc b5 24 25 7b 80  |bLV.Bih..y..$%{.|
+00000040  17 03 03 00 17 a3 f6 4f  1d 36 bb 5f 0b 59 12 ef  |.......O.6._.Y..|
+00000050  72 d4 c6 1d c8 82 94 1d  f2 9c 46 d5 17 03 03 00  |r.........F.....|
+00000060  13 3c 66 6b 59 a1 b2 e9  47 e8 06 fe 15 3f 0c 39  |.<fkY...G....?.9|
+00000070  ab f9 20 57                                       |.. W|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-CHACHA20-SHA256 b/src/crypto/tls/testdata/Client-TLSv13-CHACHA20-SHA256
index 69749f05d3..e029f00dbb 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-CHACHA20-SHA256
+++ b/src/crypto/tls/testdata/Client-TLSv13-CHACHA20-SHA256
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,84 +7,85 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 39 b2 74 80 d8  |....z...v..9.t..|
-00000010  49 72 79 63 9b 7b da d7  cf b4 29 20 f8 80 ed d9  |Iryc.{....) ....|
-00000020  66 09 65 22 b6 27 16 c5  a7 6f 8b 20 00 00 00 00  |f.e".'...o. ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 ce bd 20 50 3d  |....z...v.... P=|
+00000010  7e 80 5d e3 c4 d1 f4 d7  9b 28 0d ad c7 2c c9 b0  |~.]......(...,..|
+00000020  bb 25 e4 98 56 77 9a dd  7c 2e e7 20 00 00 00 00  |.%..Vw..|.. ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 42  |..+.....3.$... B|
-00000060  80 fb 4a d3 49 53 a5 9f  f6 da ca 64 f8 5d 2c f5  |..J.IS.....d.],.|
-00000070  45 4d f1 a5 ec c3 c6 fc  d2 ff 56 b1 63 53 1a 14  |EM........V.cS..|
-00000080  03 03 00 01 01 17 03 03  00 17 f8 d8 e1 1a e0 c8  |................|
-00000090  75 f9 40 90 da 16 a0 41  4f 8c 23 e7 47 43 89 cf  |u.@....AO.#.GC..|
-000000a0  d4 17 03 03 02 6d d6 23  1d c6 c0 d4 5e a3 fe 2b  |.....m.#....^..+|
-000000b0  03 04 6c 88 d1 4a ac 9b  dd 90 e5 18 c5 35 9c 4a  |..l..J.......5.J|
-000000c0  f3 c4 64 e2 c2 40 62 fb  68 b3 22 37 9f f4 eb ae  |..d..@b.h."7....|
-000000d0  45 d9 a8 be f4 1e 89 16  88 b5 10 e3 5c 2e 42 15  |E...........\.B.|
-000000e0  34 24 f3 bd dd 73 6d 6b  d1 db 3e 69 b0 0a 54 e6  |4$...smk..>i..T.|
-000000f0  b7 2c b7 80 86 93 91 d5  26 02 77 bf 10 38 ee 40  |.,......&.w..8.@|
-00000100  22 4d 3f 67 02 6b f8 1c  4a ad 2b c7 f6 19 d4 36  |"M?g.k..J.+....6|
-00000110  9b ff c4 08 73 e1 48 0a  a6 e8 80 3b 88 8a c2 e8  |....s.H....;....|
-00000120  c6 4a ae da a1 4f 3b 9e  fb 80 3b 78 ca 80 42 00  |.J...O;...;x..B.|
-00000130  a4 5c 9d a0 6c 63 a7 66  e6 26 b7 14 d8 8b ba 1a  |.\..lc.f.&......|
-00000140  4b 13 81 3c e4 76 4e ac  6c 2f b4 71 e9 dc c4 c8  |K..<.vN.l/.q....|
-00000150  ef f0 61 22 f4 6b 83 ae  d8 d0 a7 c6 d9 ea 95 85  |..a".k..........|
-00000160  77 90 0f 22 a0 50 cb ff  50 a5 98 ee de e4 89 f3  |w..".P..P.......|
-00000170  20 f2 63 a2 45 3a 48 33  d5 b9 ff 5e f8 7d c5 2d  | .c.E:H3...^.}.-|
-00000180  b9 9c b2 65 bf d5 13 36  46 a5 96 9f f4 de 7c 1c  |...e...6F.....|.|
-00000190  78 3f 1a 0a 62 14 13 8e  55 7e cd 47 87 1b 7e a8  |x?..b...U~.G..~.|
-000001a0  7f 03 ec 1c d3 72 eb e5  94 d9 9d 95 d6 f5 ad 2c  |.....r.........,|
-000001b0  e9 7d 0f 2c ea 7b 1e 8e  d7 b4 f1 5d 12 be d7 cf  |.}.,.{.....]....|
-000001c0  b7 43 89 65 e9 04 0e f8  b4 b4 4d 9c 9c 42 3c 50  |.C.e......M..B<P|
-000001d0  a7 91 d0 7f c0 de fb 99  08 ce 5c fd 67 3a cb 1a  |..........\.g:..|
-000001e0  d3 1a 4c a2 2e 7d 73 01  2b 5f bb a2 86 7d 0e e0  |..L..}s.+_...}..|
-000001f0  a1 c9 06 c0 4a 0a f6 c6  c4 b5 53 51 3e 2f f4 60  |....J.....SQ>/.`|
-00000200  1d 41 55 9d c4 88 f3 76  4f 92 b5 03 98 23 6b c4  |.AU....vO....#k.|
-00000210  c3 62 bd 12 dd 3a bc 37  d0 18 64 c6 e1 2c cb 62  |.b...:.7..d..,.b|
-00000220  f6 d3 24 35 47 e7 cf 15  d3 53 9d ac 3f 97 48 c1  |..$5G....S..?.H.|
-00000230  b8 d3 a3 2c 9f cd 2b 72  bc bd a6 8a b1 54 48 7b  |...,..+r.....TH{|
-00000240  e0 b7 a2 2e 46 04 cc e5  29 1d 73 c7 67 f8 f0 d8  |....F...).s.g...|
-00000250  e0 88 f0 7b 11 ff e1 1d  95 6c 85 c4 08 72 3e 94  |...{.....l...r>.|
-00000260  92 4b 8a 58 62 04 10 83  7c 5e 65 20 a7 5d 6d 16  |.K.Xb...|^e .]m.|
-00000270  30 64 fc aa 7f 8f 06 ed  4e 3c 86 c8 10 92 fb 0d  |0d......N<......|
-00000280  7b 81 10 07 cf 30 7f 6b  11 63 60 2a 61 92 cb 74  |{....0.k.c`*a..t|
-00000290  82 a4 04 cf 23 43 21 55  45 2a 29 93 42 0f 0c f6  |....#C!UE*).B...|
-000002a0  9b 14 b5 96 09 25 1b bc  b0 7b 72 e2 6f b8 55 74  |.....%...{r.o.Ut|
-000002b0  00 bb 1c 7c b1 9b 58 63  97 bb 6d c5 fb a4 da 24  |...|..Xc..m....$|
-000002c0  1e b2 97 18 75 ab 8b a2  77 50 38 4d f8 a0 39 58  |....u...wP8M..9X|
-000002d0  8c 2d 3e ba 27 03 e9 51  87 0a 95 e0 08 40 5d e6  |.->.'..Q.....@].|
-000002e0  6a dd 10 1d 6d 8c 32 88  a8 32 ee dd 44 9c 9b b0  |j...m.2..2..D...|
-000002f0  6f f5 4b 08 60 9d 83 1e  ab 83 c0 92 10 c7 aa 90  |o.K.`...........|
-00000300  d2 b2 61 5e 12 b5 e8 ea  a7 68 59 17 a4 f4 15 f7  |..a^.....hY.....|
-00000310  dc 10 81 17 03 03 00 99  8a 61 79 8f 33 51 7b a9  |.........ay.3Q{.|
-00000320  ce 3f 82 2b bb da 40 2e  73 c8 d9 6e 7d 72 ba 94  |.?.+..@.s..n}r..|
-00000330  7d ad fb b7 ba 9c 74 00  0b c9 1d b6 8d 54 b9 48  |}.....t......T.H|
-00000340  eb 49 78 c3 1a 75 b8 16  22 5d 50 f5 4a 81 59 d3  |.Ix..u.."]P.J.Y.|
-00000350  38 79 38 c1 35 11 55 69  6b d2 86 3c 0f 12 26 57  |8y8.5.Uik..<..&W|
-00000360  f5 84 d7 dd 74 61 6f b8  08 66 e9 3c f7 43 29 a5  |....tao..f.<.C).|
-00000370  94 9e ab af 68 04 c1 6a  ae 9d 12 2d 57 e9 ff 30  |....h..j...-W..0|
-00000380  7d 80 35 65 cc df c8 65  0b a1 f9 6d 6b a5 0b df  |}.5e...e...mk...|
-00000390  0c 1a 04 0a 00 8f ac 2b  29 60 92 4e 91 d3 42 25  |.......+)`.N..B%|
-000003a0  b4 a5 0a 1a 5f 83 ec 9a  f0 0a 2c 6d 65 00 24 d3  |...._.....,me.$.|
-000003b0  e1 17 03 03 00 35 e4 72  aa 9e 6c a8 93 7b e4 49  |.....5.r..l..{.I|
-000003c0  1e 23 7c 50 18 59 00 08  3b f1 c1 5f 20 ba 51 56  |.#|P.Y..;.._ .QV|
-000003d0  fe bb 93 99 52 e6 5e 6d  26 cc 60 11 c2 a1 c8 18  |....R.^m&.`.....|
-000003e0  2e 72 bd ee 36 ca 41 25  73 f2 30                 |.r..6.A%s.0|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 75  |..+.....3.$... u|
+00000060  35 5d ce ae 93 0b e6 2c  c7 aa 67 6d 9d bd b2 8d  |5].....,..gm....|
+00000070  83 ac 17 7c 21 21 b2 c1  dc a1 4d 54 72 66 05 14  |...|!!....MTrf..|
+00000080  03 03 00 01 01 17 03 03  00 17 88 68 f2 3c 98 b5  |...........h.<..|
+00000090  ef 6e 2b ba aa d3 d4 0c  28 aa 3a 6f 51 a7 dc 89  |.n+.....(.:oQ...|
+000000a0  fb 17 03 03 02 6d ae f6  44 17 0d 3b ee 41 5b a9  |.....m..D..;.A[.|
+000000b0  d2 63 7c 98 25 e7 ca 46  29 05 9e 75 9f 71 58 99  |.c|.%..F)..u.qX.|
+000000c0  57 a3 c3 88 08 54 88 ea  8f ea ca 87 88 c0 53 d7  |W....T........S.|
+000000d0  de b6 3d 14 98 64 1a 6b  8f 90 e7 6a 10 e2 4b 42  |..=..d.k...j..KB|
+000000e0  13 59 f0 bc a0 74 3b 5b  a8 15 74 3a 30 9f 28 ed  |.Y...t;[..t:0.(.|
+000000f0  b2 a0 48 15 5a 3b 0c 61  26 4e 3f 5a 33 3d d9 88  |..H.Z;.a&N?Z3=..|
+00000100  97 9f fe 2a d5 df f7 01  40 84 75 90 89 7d 34 23  |...*....@.u..}4#|
+00000110  3e 70 85 82 94 b7 21 94  e6 0c d1 f1 88 06 ff 34  |>p....!........4|
+00000120  64 2f e5 e6 80 10 2b 0c  fe 18 f5 2c cc b0 27 37  |d/....+....,..'7|
+00000130  2b 5a 4b 43 e8 b7 ad 97  a0 8c d1 49 bb f9 4a 65  |+ZKC.......I..Je|
+00000140  99 bf cd 7f 77 ef 0f b6  d7 91 ce 4d 53 79 d0 5e  |....w......MSy.^|
+00000150  b7 51 5e 8d 0f 13 85 53  7d 81 27 b2 e1 5a e0 d0  |.Q^....S}.'..Z..|
+00000160  d9 b0 3b c6 30 15 ac 3e  60 7f 01 90 da b1 c5 8c  |..;.0..>`.......|
+00000170  06 7c 8f 31 86 7e 53 5b  1a 4b 8f d0 ff 2c f9 9e  |.|.1.~S[.K...,..|
+00000180  c4 08 02 12 e4 97 af 3f  07 d0 25 0d 50 90 21 1f  |.......?..%.P.!.|
+00000190  fa 8d ea 02 16 a4 56 2e  2b e1 3f c2 e2 f5 53 d0  |......V.+.?...S.|
+000001a0  6e a2 d4 b9 b6 ae 69 12  74 d4 2f 8f 55 1e 5f b8  |n.....i.t./.U._.|
+000001b0  1f b6 29 ee 11 21 81 9f  37 6e 40 b1 27 22 15 7b  |..)..!..7n@.'".{|
+000001c0  ba bb bd ee 7a 7e 1f e4  7e 63 a1 60 53 a1 c7 0f  |....z~..~c.`S...|
+000001d0  f8 2e c3 07 cd 60 ec 83  0f 18 55 50 5c 11 ec 93  |.....`....UP\...|
+000001e0  85 dd 38 5c 7e 4a 0a af  4b c9 22 8d 43 ce 76 62  |..8\~J..K.".C.vb|
+000001f0  d7 73 3f ef 67 2d 6a 02  bd b5 8f c4 8b 64 b1 a3  |.s?.g-j......d..|
+00000200  c4 40 c1 ea 7e 57 b9 25  45 61 96 97 69 69 9f 2b  |.@..~W.%Ea..ii.+|
+00000210  a7 56 b5 8b 80 25 3e 3c  73 14 b2 21 10 ee 47 cd  |.V...%><s..!..G.|
+00000220  5f 6f 6f fa 71 bf 88 47  39 21 05 b9 e3 0b f2 ad  |_oo.q..G9!......|
+00000230  68 52 8a fe 9d 90 60 49  bb ea 73 02 a6 2d 55 93  |hR....`I..s..-U.|
+00000240  d5 cd e1 f6 2b 40 8c 9a  22 e8 65 3f fb 5e 8e 88  |....+@..".e?.^..|
+00000250  d2 38 10 00 c6 25 26 77  78 a9 f9 fe 27 29 c7 5a  |.8...%&wx...').Z|
+00000260  e1 24 97 a7 6b ea 3f 57  4f 1c b9 cf 0a 75 3b c7  |.$..k.?WO....u;.|
+00000270  81 df 4b 9c 37 80 15 01  22 a0 ac f7 a8 cc 72 f7  |..K.7...".....r.|
+00000280  63 df 49 31 8d 70 1c a6  c5 3c c5 4e 22 cf b7 b3  |c.I1.p...<.N"...|
+00000290  a5 27 ce 9f d5 34 1b d7  de 67 a9 af b2 d9 04 0c  |.'...4...g......|
+000002a0  f6 bd 33 b8 91 c8 66 02  90 a8 82 76 9e 4b 86 7f  |..3...f....v.K..|
+000002b0  d9 8a d1 ea fc 2a 9a 8e  2b 61 10 c9 5e 62 86 78  |.....*..+a..^b.x|
+000002c0  df 7d 09 14 0b ec ac 76  dc 62 7f 00 a3 16 9b 30  |.}.....v.b.....0|
+000002d0  f7 17 92 79 c1 03 af cd  ef 4d 09 c3 a1 13 cd 83  |...y.....M......|
+000002e0  05 47 9b 61 80 54 56 de  b9 9c 78 43 e9 70 af db  |.G.a.TV...xC.p..|
+000002f0  bb f6 4f 17 6b c4 61 57  5f 57 91 3e e7 f4 dc 0c  |..O.k.aW_W.>....|
+00000300  e2 01 51 80 b3 de cb ac  67 41 cb e9 92 4b ba 18  |..Q.....gA...K..|
+00000310  c5 58 f4 17 03 03 00 99  9c bf 47 cb 60 c1 51 50  |.X........G.`.QP|
+00000320  73 87 10 02 5b e7 b4 f5  4f 60 65 de 44 ae 5c 15  |s...[...O`e.D.\.|
+00000330  0e df 8b fa 47 0f 51 0a  a1 05 70 a6 8f a0 2a 27  |....G.Q...p...*'|
+00000340  84 e9 a1 38 43 3d 2a e5  10 45 22 01 0a b2 8e 6d  |...8C=*..E"....m|
+00000350  27 53 b9 ea b5 5d 6d a7  50 69 c2 4c 50 cf 3d d9  |'S...]m.Pi.LP.=.|
+00000360  47 82 62 4b 0b 42 6a 3f  e5 4f a8 04 9b 7d f2 26  |G.bK.Bj?.O...}.&|
+00000370  15 ce 88 74 40 59 87 2b  11 a5 ac 9a e5 3f 03 db  |...t@Y.+.....?..|
+00000380  33 cb 27 be d9 2a 69 1d  1e 68 6b 0e 54 0a f4 1c  |3.'..*i..hk.T...|
+00000390  63 b3 bb 55 63 e7 b6 b7  0e 2c ad 9e b5 1d 51 b4  |c..Uc....,....Q.|
+000003a0  41 77 4b 80 17 47 c9 8f  9e 02 cd 87 2e 20 72 e4  |AwK..G....... r.|
+000003b0  44 17 03 03 00 35 0e 4f  8b e7 ae ca 38 35 85 d8  |D....5.O....85..|
+000003c0  fb 23 c3 39 d4 80 25 15  d3 39 4e 19 34 93 21 13  |.#.9..%..9N.4.!.|
+000003d0  a2 84 2c 0f 3e 5e c3 62  95 41 c7 4d a7 81 2d 60  |..,.>^.b.A.M..-`|
+000003e0  99 56 db d5 0e 2e 42 b3  16 72 22                 |.V....B..r"|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 b6 c3 b9 b1 52  |..........5....R|
-00000010  88 d2 78 2b ec 1c 63 e8  d5 08 0e 4e d6 51 b9 02  |..x+..c....N.Q..|
-00000020  ba cc a8 ca b6 da 45 a9  7c 1a 18 39 47 84 db 34  |......E.|..9G..4|
-00000030  d6 05 6f e5 16 19 57 6f  65 0b 7a e7 37 b5 d3 28  |..o...Woe.z.7..(|
-00000040  17 03 03 00 17 dc b8 e2  1c aa b8 f5 cb b6 fd ba  |................|
-00000050  29 34 73 bb c6 e0 3a fc  3e fb d3 01 17 03 03 00  |)4s...:.>.......|
-00000060  13 eb 66 ab 47 38 1b 01  96 6c 59 46 c2 ad bf 2d  |..f.G8...lYF...-|
-00000070  36 22 97 19                                       |6"..|
+00000000  14 03 03 00 01 01 17 03  03 00 35 db e3 68 0f 7c  |..........5..h.||
+00000010  36 8e c4 5b 10 11 89 61  b7 f1 a9 f3 43 a5 28 e6  |6..[...a....C.(.|
+00000020  86 8c f0 c3 3b 54 5b 86  3c b6 42 6e 3d 56 93 0a  |....;T[.<.Bn=V..|
+00000030  2c ca 2e 39 27 1c 12 e2  d7 e7 b5 57 a6 29 5c 4a  |,..9'......W.)\J|
+00000040  17 03 03 00 17 02 0d 23  ca 06 5e 1c 0f a8 a2 39  |.......#..^....9|
+00000050  32 00 01 b5 ba e7 52 82  fa 2c e3 27 17 03 03 00  |2.....R..,.'....|
+00000060  13 ea 39 b7 18 2d 01 1a  c3 9c b5 51 cc d2 f3 40  |..9..-.....Q...@|
+00000070  55 69 87 65                                       |Ui.e|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-ECDSA-RSA b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-ECDSA-RSA
index bd8f6cd4f1..8e87aa50e0 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-ECDSA-RSA
+++ b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-ECDSA-RSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,133 +7,134 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 85 46 7d 9f 55  |....z...v...F}.U|
-00000010  82 34 10 06 5e 8d 60 5d  00 9d 28 cd 18 c2 18 ee  |.4..^.`]..(.....|
-00000020  cb 9a 63 ee 9a 30 7d 5d  87 3d 24 20 00 00 00 00  |..c..0}].=$ ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 98 a2 b1 a3 c2  |....z...v.......|
+00000010  3a ad 0c cb df b0 4b 9d  37 a9 57 5f f0 c5 3f dd  |:.....K.7.W_..?.|
+00000020  73 c1 e6 7f 1e 45 7d ef  17 e8 61 20 00 00 00 00  |s....E}...a ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 15  |..+.....3.$... .|
-00000060  b8 ae de 9d dc 14 58 fe  01 5d 08 ed 41 ac c6 c7  |......X..]..A...|
-00000070  85 fe b1 a3 ae b6 8c 47  f3 e1 4e c5 f8 8b 48 14  |.......G..N...H.|
-00000080  03 03 00 01 01 17 03 03  00 17 d6 72 35 0b 81 34  |...........r5..4|
-00000090  42 89 f1 9b 31 94 72 af  0c 3c 45 36 96 26 71 e8  |B...1.r..<E6.&q.|
-000000a0  86 17 03 03 00 42 47 ed  30 6f 20 53 07 4f b2 c1  |.....BG.0o S.O..|
-000000b0  35 49 fa 5b d9 af 6c 0b  c3 71 7a f3 a8 5b 24 ba  |5I.[..l..qz..[$.|
-000000c0  59 dd 34 b7 02 07 63 5d  a1 ad ac 4c a2 58 e7 cd  |Y.4...c]...L.X..|
-000000d0  6d f7 23 4e e1 a9 af 75  23 93 37 25 59 7e fb 52  |m.#N...u#.7%Y~.R|
-000000e0  65 a4 e7 ea 0a df a7 ce  17 03 03 02 6d e5 aa db  |e...........m...|
-000000f0  1d 7e 55 0f b4 79 96 de  15 74 52 95 52 c8 ce d6  |.~U..y...tR.R...|
-00000100  85 a9 a8 6f 79 63 cf d7  3a 9e 38 d2 9d 0a 73 a0  |...oyc..:.8...s.|
-00000110  0b c3 f3 85 77 d3 63 16  9b 13 79 e6 61 96 08 57  |....w.c...y.a..W|
-00000120  ba 4a 64 b6 af 1a 98 22  a6 d9 20 82 2c 40 28 57  |.Jd....".. .,@(W|
-00000130  b8 95 d6 b4 94 46 8f 67  2d eb ee 02 74 d3 94 e7  |.....F.g-...t...|
-00000140  6e 5b 2f a9 7d a2 c2 aa  89 0c 43 c3 9d 92 6f 16  |n[/.}.....C...o.|
-00000150  27 84 d7 79 dd 4b 6a ed  9b fc cd d7 c0 c4 59 09  |'..y.Kj.......Y.|
-00000160  21 1f 83 67 e7 76 c8 ee  bf f5 79 87 a0 bd 14 6d  |!..g.v....y....m|
-00000170  db ac 06 04 c4 3b 3a a7  1e cb 22 d1 97 21 9d c2  |.....;:..."..!..|
-00000180  ee ed a8 41 f7 a0 6a a0  64 2f b0 0a 6f b7 78 b8  |...A..j.d/..o.x.|
-00000190  20 36 ed 7a e9 3c 26 cb  36 7d 3c ee 73 27 32 e7  | 6.z.<&.6}<.s'2.|
-000001a0  e7 fd 6e 27 d9 da ad 48  67 29 94 50 f5 0e 56 af  |..n'...Hg).P..V.|
-000001b0  e4 c5 1d d3 59 a4 de 59  d7 79 7a f3 10 36 fb ed  |....Y..Y.yz..6..|
-000001c0  b1 97 00 a4 dd 6e c2 65  19 0a 73 fe 2c 49 dc c5  |.....n.e..s.,I..|
-000001d0  df 19 53 c2 7e de 0b 2b  55 3d ca 0b 39 a4 77 c4  |..S.~..+U=..9.w.|
-000001e0  21 53 93 12 f0 9a 3a 3b  97 0c 93 80 50 23 80 9e  |!S....:;....P#..|
-000001f0  84 2e ef 22 2b c1 b3 dd  b1 55 38 76 9a d6 a6 f1  |..."+....U8v....|
-00000200  67 11 df d9 a0 8a 18 c6  68 ef d8 7b d7 36 4b 57  |g.......h..{.6KW|
-00000210  a7 bf 4e 77 a5 f6 4f 1e  be 6e 14 40 67 73 1c 20  |..Nw..O..n.@gs. |
-00000220  9f 17 30 b6 76 00 87 56  8c 2b 76 5f 04 46 5a a1  |..0.v..V.+v_.FZ.|
-00000230  0f fa 64 b3 fa da 4e 72  eb a7 95 c3 93 de 97 20  |..d...Nr....... |
-00000240  2d ea 06 84 aa f0 b6 5a  ac ea 64 06 2a 8c b0 eb  |-......Z..d.*...|
-00000250  58 0a e8 51 e1 34 c4 03  38 9f f7 fb ec 98 78 07  |X..Q.4..8.....x.|
-00000260  71 73 ad a5 d7 d5 d1 2d  95 b6 4f 7c 5a ee d9 f1  |qs.....-..O|Z...|
-00000270  fa e3 7d ae bd 31 98 27  31 07 f2 86 cf e5 8d 2c  |..}..1.'1......,|
-00000280  e8 55 40 69 b0 26 a3 51  e8 60 59 6f 66 bb 36 4f  |.U@i.&.Q.`Yof.6O|
-00000290  85 fc 36 d1 72 99 9d e1  83 ad ec 3f e8 90 a8 48  |..6.r......?...H|
-000002a0  f5 d1 41 30 59 4e 44 79  e4 de 6f 0d 37 61 01 bb  |..A0YNDy..o.7a..|
-000002b0  b8 7f ee c7 a2 35 c7 12  dc d3 ca 49 8d d9 3e d8  |.....5.....I..>.|
-000002c0  24 69 34 a4 8f 92 f2 77  61 cb b7 04 f8 02 25 9c  |$i4....wa.....%.|
-000002d0  88 ea c7 f0 13 3e 17 bc  ac 5a 80 c4 80 c6 b0 19  |.....>...Z......|
-000002e0  d3 73 b5 94 5a 27 df 08  05 23 6e 03 64 67 ab c8  |.s..Z'...#n.dg..|
-000002f0  63 7c 76 b3 92 39 ef 29  77 28 ec 6f 05 70 a6 2f  |c|v..9.)w(.o.p./|
-00000300  a0 d2 73 fd f9 cc 4f d7  6f 86 db 9a 02 84 8c 6c  |..s...O.o......l|
-00000310  39 3a 54 28 38 43 ca 0d  da 34 b5 d4 03 0c f8 c1  |9:T(8C...4......|
-00000320  8d 48 d0 63 c7 41 da 4c  db 0a 45 56 cf 6b 0b ca  |.H.c.A.L..EV.k..|
-00000330  2f a3 82 6e 8e 90 6f 8a  f2 41 33 c5 56 c5 15 bd  |/..n..o..A3.V...|
-00000340  c2 02 45 41 7a e7 2b 0d  15 82 a7 37 34 ea 19 c2  |..EAz.+....74...|
-00000350  8b 1d d4 17 9c 2d d4 c0  9d f3 17 03 03 00 99 37  |.....-.........7|
-00000360  6a b2 6e 07 32 19 45 80  7b 80 ef 93 b3 6e c3 19  |j.n.2.E.{....n..|
-00000370  4d fe 3e e9 7f e4 b9 37  d2 b0 83 56 f7 2f 9b 61  |M.>....7...V./.a|
-00000380  67 a1 65 b4 38 4b a1 06  c5 4a 20 44 37 26 d0 2a  |g.e.8K...J D7&.*|
-00000390  b7 96 1e 72 ef a8 5d fb  5a b8 ea 26 0e 4b 38 e0  |...r..].Z..&.K8.|
-000003a0  6a 3a ab 4a e3 b4 db 00  f8 30 e6 db 02 e4 cf 89  |j:.J.....0......|
-000003b0  5b 57 b8 b8 3e 0a 97 b4  61 9e 89 7d 76 b3 9f 51  |[W..>...a..}v..Q|
-000003c0  a0 b8 46 95 8b 2b b9 25  8e 39 29 f5 97 41 e6 f1  |..F..+.%.9)..A..|
-000003d0  f0 0c 8b 70 bc 63 a0 56  24 c0 fb 0d 44 7f d8 78  |...p.c.V$...D..x|
-000003e0  c0 d5 a2 b7 53 67 c5 6d  0f 37 25 3e dc 08 e2 50  |....Sg.m.7%>...P|
-000003f0  ca 28 c3 1b ec 28 26 0c  17 03 03 00 35 ef 63 88  |.(...(&.....5.c.|
-00000400  13 79 07 a1 28 af 88 6e  8c e4 ad b3 0a 28 2a ce  |.y..(..n.....(*.|
-00000410  db 0f 63 8a 16 95 ab 0a  01 51 4f 28 79 15 78 00  |..c......QO(y.x.|
-00000420  f9 7a a6 40 1b 39 98 d8  8d df 1b b9 ab 82 b9 59  |.z.@.9.........Y|
-00000430  67 b9                                             |g.|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 9b  |..+.....3.$... .|
+00000060  8a e8 f7 9b f3 9a 73 54  81 4c aa 41 06 e8 fd 21  |......sT.L.A...!|
+00000070  f7 e6 62 2e 7a 1f 29 0e  1c 48 21 dc 82 3b 1b 14  |..b.z.)..H!..;..|
+00000080  03 03 00 01 01 17 03 03  00 17 07 dc 9b 84 a2 d4  |................|
+00000090  b9 80 93 7f 29 3e 7c 97  9e 46 e0 6d 0c 3d 24 4b  |....)>|..F.m.=$K|
+000000a0  1c 17 03 03 00 42 2c 3c  9c 8d 63 93 a7 02 57 8b  |.....B,<..c...W.|
+000000b0  3d e6 d1 f0 05 03 ff 91  77 55 01 6c 65 57 8f 67  |=.......wU.leW.g|
+000000c0  44 f8 c1 8f c5 ee 00 9f  45 66 b0 c5 f0 61 20 b7  |D.......Ef...a .|
+000000d0  4f f0 14 05 1d 47 10 af  f9 11 ed 62 5e 78 12 60  |O....G.....b^x.`|
+000000e0  65 b7 65 33 a9 b3 38 61  17 03 03 02 6d 9e c3 b9  |e.e3..8a....m...|
+000000f0  0e 43 aa bd 17 a2 51 a8  9b a0 62 73 73 58 84 21  |.C....Q...bssX.!|
+00000100  d2 fa 4f ad fe c3 56 b6  7f 93 e9 4d 4b 83 59 0c  |..O...V....MK.Y.|
+00000110  be 47 fd c5 f7 01 b2 03  18 77 9c ae 41 dd 26 44  |.G.......w..A.&D|
+00000120  a2 8a 45 56 6d 61 bc 16  ff 52 d0 1a 48 37 c5 e8  |..EVma...R..H7..|
+00000130  07 71 d1 3d c9 e2 75 3b  6f 16 43 9d a2 56 9c d6  |.q.=..u;o.C..V..|
+00000140  90 d1 d4 fd 23 5e 32 84  bc 97 9e 33 4e cd 54 b6  |....#^2....3N.T.|
+00000150  66 5c 52 be b0 b7 10 70  5c 3a 61 ec 4a e2 d4 43  |f\R....p\:a.J..C|
+00000160  b0 87 8a 48 bd f5 81 cb  ee 5a 72 de 26 13 49 31  |...H.....Zr.&.I1|
+00000170  e7 02 53 54 b3 fc 86 b4  70 25 a6 f8 83 24 31 f3  |..ST....p%...$1.|
+00000180  22 dd b1 ca 96 7e f3 9e  dc 3b ce 7c 1f 7e 44 37  |"....~...;.|.~D7|
+00000190  ba be 42 e3 14 29 14 8f  ad 79 e6 d7 64 a9 11 ac  |..B..)...y..d...|
+000001a0  78 f5 fc 3c af e7 0a 55  26 07 a1 7e 81 1f 16 b5  |x..<...U&..~....|
+000001b0  ad 4b cf 46 cf 7a ba d3  3b 2d 97 55 31 bb 20 68  |.K.F.z..;-.U1. h|
+000001c0  c6 f6 19 99 af 98 25 cd  6e 76 39 03 32 14 08 fd  |......%.nv9.2...|
+000001d0  77 43 7d d0 f4 d4 8b 58  42 d6 6c 45 a5 b6 af 04  |wC}....XB.lE....|
+000001e0  14 28 47 9f 45 bb af e8  8d e0 d6 54 55 e5 d2 ae  |.(G.E......TU...|
+000001f0  84 a1 0c 0b 42 5f 9a 9c  93 fb b9 cd e6 43 5f a3  |....B_.......C_.|
+00000200  cc 6a 6a da 85 7d c1 37  af 04 1a 8b e7 4a 40 82  |.jj..}.7.....J@.|
+00000210  82 88 0f dc 78 51 74 f7  2c c8 e0 01 eb f7 f9 ca  |....xQt.,.......|
+00000220  28 0a 79 c9 f9 fb 35 c1  e7 8e 65 9e 8b 40 75 29  |(.y...5...e..@u)|
+00000230  f1 56 79 33 41 39 96 c4  ab 15 28 7c cc 5a cd 81  |.Vy3A9....(|.Z..|
+00000240  c4 57 d2 d9 86 f7 7f 63  30 2d 89 71 29 3c 99 cc  |.W.....c0-.q)<..|
+00000250  d8 fb 01 03 f3 de 3d 57  5d f3 85 b5 7a a8 f1 5c  |......=W]...z..\|
+00000260  05 39 d7 ac 15 03 be 88  fb e8 4c d2 8f 0f 3f 68  |.9........L...?h|
+00000270  c2 e0 e8 44 c0 97 83 f4  3f f2 4a ba 9e 4c b7 c1  |...D....?.J..L..|
+00000280  ea 55 e4 f4 ce 55 69 83  5b 6e 02 07 06 c4 f3 70  |.U...Ui.[n.....p|
+00000290  13 3e ed 76 f0 ec 7b 5d  1e 9b 5e 73 5f ef 5b 33  |.>.v..{]..^s_.[3|
+000002a0  41 e9 38 45 80 c8 f2 3e  17 ec 30 8b ce 35 87 00  |A.8E...>..0..5..|
+000002b0  a8 02 66 b4 fc d4 69 ae  12 df c6 a4 68 06 2d 8b  |..f...i.....h.-.|
+000002c0  9c b6 e3 0e 2c 2a d9 05  cc ac f1 32 e9 57 6d e4  |....,*.....2.Wm.|
+000002d0  0e f5 ed d0 05 a4 4a 10  02 87 5b 90 f9 89 88 30  |......J...[....0|
+000002e0  3a 65 9d 2d 41 07 7a d7  8b 16 cb 57 01 9d ad bb  |:e.-A.z....W....|
+000002f0  76 4a 6a 3f 77 ae 29 55  61 b5 04 6b 9f eb 6e 34  |vJj?w.)Ua..k..n4|
+00000300  a7 c6 97 92 6f d3 29 0e  65 1e 83 74 e9 2c 5a 8a  |....o.).e..t.,Z.|
+00000310  a8 a7 7a b1 55 76 b9 6a  98 b9 09 d5 01 48 ae 06  |..z.Uv.j.....H..|
+00000320  ff 88 cb 59 f4 64 f2 ad  3b 4c 8c 39 85 b1 5f ae  |...Y.d..;L.9.._.|
+00000330  07 c1 a9 0f f5 0e 02 27  28 74 0d 9f c5 b2 8e 18  |.......'(t......|
+00000340  6a 66 b9 86 ca 41 1f 6f  4a 05 d1 0d 69 ad f0 b6  |jf...A.oJ...i...|
+00000350  2d 6a 24 df 6f 9b 5c 07  b1 04 17 03 03 00 99 11  |-j$.o.\.........|
+00000360  46 8d 44 89 36 f4 ff dc  5a 8e 1e 68 f3 63 03 b6  |F.D.6...Z..h.c..|
+00000370  40 40 26 1b 28 41 d9 78  f5 5e 51 c6 21 b8 fa c5  |@@&.(A.x.^Q.!...|
+00000380  a7 c4 20 d3 b0 c0 f0 ec  9a 0e 1a 5b 1c 8d 57 58  |.. ........[..WX|
+00000390  32 f9 75 69 9a 5e 1d 96  0b fa 77 d8 c7 d1 a0 8b  |2.ui.^....w.....|
+000003a0  e6 f8 33 3a f9 90 22 a7  19 37 50 d8 f0 90 34 4f  |..3:.."..7P...4O|
+000003b0  c3 bb 1c a2 c3 b8 3e d3  6b ee a0 39 40 98 e5 93  |......>.k..9@...|
+000003c0  f8 16 29 6a 1e 12 20 4d  5c bd fd 11 f6 c5 cc d6  |..)j.. M\.......|
+000003d0  08 d9 bc f5 ce 95 70 2c  dd 9f 70 08 7c c4 55 59  |......p,..p.|.UY|
+000003e0  8f 57 25 16 36 53 b4 3c  14 df af 1c 5f ec 2a 5a  |.W%.6S.<...._.*Z|
+000003f0  61 7c c4 1e 96 9c aa 9b  17 03 03 00 35 ef b8 e8  |a|..........5...|
+00000400  5d ef 00 77 46 05 77 37  7b f6 3e b4 e9 b4 67 a8  |]..wF.w7{.>...g.|
+00000410  88 49 6d d8 2f 3a 88 db  48 47 e1 cb a5 f9 38 17  |.Im./:..HG....8.|
+00000420  09 c8 a7 0b 92 7c d9 17  9f 2d 34 9c 9a d0 da 02  |.....|...-4.....|
+00000430  a8 d0                                             |..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 02 1e ad ee 84 48 28  |..............H(|
-00000010  bb dc e6 01 81 4c b3 55  85 2a 73 3a 34 d6 6b 3a  |.....L.U.*s:4.k:|
-00000020  c6 e7 6b da e8 97 dc 13  72 9c d4 03 e2 fc ec e0  |..k.....r.......|
-00000030  0b 00 09 a9 3c 85 19 79  80 a3 fc da 39 b1 13 90  |....<..y....9...|
-00000040  3e 0c be 19 5a be a9 ac  a5 46 a0 07 79 74 be 59  |>...Z....F..yt.Y|
-00000050  18 23 55 79 c0 29 3f 8c  37 d6 21 0c 64 57 4c f0  |.#Uy.)?.7.!.dWL.|
-00000060  a1 34 e0 52 f7 e5 3c af  48 b4 82 78 bd be 7c 90  |.4.R..<.H..x..|.|
-00000070  df 0e f3 46 84 6a e2 bb  88 aa 9a a0 ce 04 de 2b  |...F.j.........+|
-00000080  b3 17 78 e1 a0 bb 65 7f  c5 b3 a6 45 13 c6 11 e1  |..x...e....E....|
-00000090  e2 b4 ec 80 43 80 b6 a5  12 58 ac 5e 30 d3 a0 61  |....C....X.^0..a|
-000000a0  60 c2 90 36 aa 82 f7 ff  55 aa 4e 25 b3 29 5d 41  |`..6....U.N%.)]A|
-000000b0  67 4e 9c d4 f1 1d 55 f1  29 54 13 25 3c 04 41 8f  |gN....U.)T.%<.A.|
-000000c0  6b 9d 95 06 3f 04 84 55  dd 43 7a fb 9f 73 ff df  |k...?..U.Cz..s..|
-000000d0  3b da 12 3b 97 36 fa 51  0b ca c7 0b fb 6a 09 dd  |;..;.6.Q.....j..|
-000000e0  61 2a df 79 b3 66 90 45  76 3c 2b c6 98 42 5a 82  |a*.y.f.Ev<+..BZ.|
-000000f0  0e 93 cf 6f 2b 60 e4 66  67 ad 43 66 73 d2 8c 94  |...o+`.fg.Cfs...|
-00000100  7f 7a 97 d5 a1 8b 07 63  44 cb 51 18 ac 2a af 19  |.z.....cD.Q..*..|
-00000110  66 df ab 18 6f 2a bf fc  7a fa 64 52 c4 1e 91 71  |f...o*..z.dR...q|
-00000120  f1 f7 7f 79 e1 ed 07 3a  e1 08 07 d3 db 4d 74 76  |...y...:.....Mtv|
-00000130  db fa b9 b4 68 e3 d8 e7  8d ad 49 a7 1d 6d 7e 4e  |....h.....I..m~N|
-00000140  3a 6a d2 9a c3 b0 72 61  bb 72 b8 8d 98 58 6e 2e  |:j....ra.r...Xn.|
-00000150  20 f8 ab 4a df 96 c7 6c  fe 33 5b 76 b0 80 26 34  | ..J...l.3[v..&4|
-00000160  b9 5c 9a 79 50 d7 6a 29  25 11 20 4e 3c b6 a7 73  |.\.yP.j)%. N<..s|
-00000170  64 55 a6 8e 57 22 4a 98  5e 14 95 21 ff 8d 3f 05  |dU..W"J.^..!..?.|
-00000180  eb d9 30 8e f1 a3 56 3a  d8 6d 6e 07 de a2 62 ec  |..0...V:.mn...b.|
-00000190  e4 06 bb 96 ae a3 23 d0  bd fd c7 f3 ee 2f 21 3f  |......#....../!?|
-000001a0  8f 25 7a 4a fb 47 cf 78  db 74 35 c8 67 e6 f0 99  |.%zJ.G.x.t5.g...|
-000001b0  39 4e 1f 50 1a bc 64 2e  ae 8e b5 38 63 06 86 5a  |9N.P..d....8c..Z|
-000001c0  2b 1b b5 b9 a1 18 58 24  32 ce c9 de 66 ba 21 b3  |+.....X$2...f.!.|
-000001d0  d8 0f fa 3a 88 ac 6e 66  57 2c 45 5b 59 85 d4 b0  |...:..nfW,E[Y...|
-000001e0  ad 32 8c ef 0c 2a 51 1a  cc ca 6a 82 3e 70 41 cc  |.2...*Q...j.>pA.|
-000001f0  b8 80 db a0 48 22 47 49  a1 a5 d2 9a 80 dc 09 bc  |....H"GI........|
-00000200  c8 c7 dd 53 4b 44 2f 9a  75 06 b7 31 5e fd 74 f5  |...SKD/.u..1^.t.|
-00000210  d4 53 e2 90 dc b7 9a 13  ca 00 96 56 a1 1b dd 71  |.S.........V...q|
-00000220  54 25 77 fa 42 31 95 dd  ba 17 03 03 00 a3 9e 23  |T%w.B1.........#|
-00000230  96 bb c9 d5 30 f7 f4 a3  4c 33 a4 bd 2b 09 93 f5  |....0...L3..+...|
-00000240  04 02 a7 d7 9d 2e 00 5e  18 bc 18 de 1b 94 28 51  |.......^......(Q|
-00000250  4b cd 2c 15 0e 75 b1 59  12 96 8f eb cb b5 a4 4a  |K.,..u.Y.......J|
-00000260  ea c2 e0 1d 28 72 4b 8f  62 d3 7d f0 2f f1 c4 de  |....(rK.b.}./...|
-00000270  6a 6e dc 9c 43 80 c8 ae  99 86 97 de 67 58 d6 4c  |jn..C.......gX.L|
-00000280  91 74 dc c3 23 a5 32 9b  df f5 1e 64 15 04 7d df  |.t..#.2....d..}.|
-00000290  12 e4 40 52 77 5c a3 26  de 20 b6 92 a5 d8 18 cf  |..@Rw\.&. ......|
-000002a0  63 7e 9e 47 b8 ed db ee  b7 9d b6 1c e5 c0 ad 7f  |c~.G............|
-000002b0  d6 07 89 d8 b3 a0 2e 87  b9 81 0d 44 37 c2 c5 13  |...........D7...|
-000002c0  cc cb 70 87 e3 49 6e eb  66 79 76 37 4a f1 c4 4e  |..p..In.fyv7J..N|
-000002d0  82 17 03 03 00 35 52 42  2a a8 a5 7a eb 5f 32 d5  |.....5RB*..z._2.|
-000002e0  68 71 42 8b ce 62 f0 48  43 0b 0f b8 8c ed 16 f4  |hqB..b.HC.......|
-000002f0  64 7e d3 74 57 9d 83 00  ad bc 9b f8 ed bb 23 35  |d~.tW.........#5|
-00000300  07 e9 7c b2 a1 d6 76 d0  f5 ba 15 17 03 03 00 17  |..|...v.........|
-00000310  e2 3f a0 cb 23 fe 4c f1  aa cb 21 70 74 46 4f 10  |.?..#.L...!ptFO.|
-00000320  30 76 0a 72 49 09 65 17  03 03 00 13 ee 7b 9d 32  |0v.rI.e......{.2|
-00000330  ac d4 8a 40 99 1b 0a 23  f7 a4 c6 a6 ef 33 77     |...@...#.....3w|
+00000000  14 03 03 00 01 01 17 03  03 02 1e 57 f6 58 1b c5  |...........W.X..|
+00000010  ad 34 85 01 b8 a0 3f a6  b4 b8 e1 b1 7b fa 10 f8  |.4....?.....{...|
+00000020  05 c3 07 ba ef a7 08 ed  d0 0e f4 4a e0 1e 49 d8  |...........J..I.|
+00000030  d8 a6 82 3c ca cd 4c b8  c3 27 40 28 49 69 47 a2  |...<..L..'@(IiG.|
+00000040  ab 4b 14 e2 b5 ac 02 aa  7c 92 17 c0 6e cc 42 dc  |.K......|...n.B.|
+00000050  ce 10 d1 cb 25 9e fe 4f  21 a3 76 1b b4 d4 62 5b  |....%..O!.v...b[|
+00000060  51 8a 64 4a 6c 4c 7b e8  87 79 50 51 4a b3 39 f3  |Q.dJlL{..yPQJ.9.|
+00000070  37 9f 30 23 eb 6a 26 bc  49 3f 41 76 d2 c9 06 63  |7.0#.j&.I?Av...c|
+00000080  41 11 58 02 0b ae ac 52  4b e6 4e 03 88 ef e6 8d  |A.X....RK.N.....|
+00000090  51 7b 02 e2 a5 a3 70 79  d1 16 5f 8b b9 2e d6 48  |Q{....py.._....H|
+000000a0  87 2b c9 49 7f 1a 33 65  55 61 80 bd e5 cb dc 74  |.+.I..3eUa.....t|
+000000b0  84 4d dd c8 9a 6b 84 c2  b5 68 de 5e 9b 42 cf 99  |.M...k...h.^.B..|
+000000c0  a5 69 93 89 63 a7 94 60  0c 97 7c ab ec 18 61 a8  |.i..c..`..|...a.|
+000000d0  68 e3 c8 66 ab 08 2c 96  49 76 b2 3e 40 22 5e 95  |h..f..,.Iv.>@"^.|
+000000e0  7e 79 f0 53 43 2f 0d a0  c2 ec eb 6f ec 41 da ef  |~y.SC/.....o.A..|
+000000f0  a0 6f cb 22 bb 55 19 2d  6d 6e 04 cc 77 fb 00 a2  |.o.".U.-mn..w...|
+00000100  99 53 cf b6 30 95 f4 04  83 9e ab a9 c4 cd 21 a4  |.S..0.........!.|
+00000110  4a d9 e4 f9 a6 96 5e ef  8d b7 c0 62 2a 25 68 a4  |J.....^....b*%h.|
+00000120  53 50 7c cf d5 9d b9 3d  78 2b 76 65 63 95 b4 8d  |SP|....=x+vec...|
+00000130  87 41 68 3d dc 80 be 40  24 33 b5 c3 90 ee 8f fa  |.Ah=...@$3......|
+00000140  f8 25 0d 48 6a c7 b5 e6  b5 ab b5 10 4b ad b3 95  |.%.Hj.......K...|
+00000150  62 6b 76 9b 21 b2 96 86  0d f6 c1 a8 d3 5a 9f 3e  |bkv.!........Z.>|
+00000160  e8 50 2f 72 49 1c 0a fa  47 90 87 75 f8 a4 7e 95  |.P/rI...G..u..~.|
+00000170  d2 74 ca 78 c5 fa f8 8d  ca 83 81 ec 93 89 e0 50  |.t.x...........P|
+00000180  62 49 15 87 5e 16 4c 17  aa f3 a1 1b 0c 4b 9a 68  |bI..^.L......K.h|
+00000190  1b d5 48 a5 da fe c8 84  fe e6 fc 24 3d 9d 14 e8  |..H........$=...|
+000001a0  e5 38 45 20 bd cb 22 2a  95 3e de 84 4f 85 6b e2  |.8E .."*.>..O.k.|
+000001b0  be dc e1 1a 55 78 68 dc  fd c7 c8 e2 d6 90 a7 14  |....Uxh.........|
+000001c0  44 b6 6a a0 4e 01 0f 73  9b 97 ac ef 17 91 90 16  |D.j.N..s........|
+000001d0  14 e5 f7 88 df 08 8b d6  48 49 c5 9b 72 81 0b b8  |........HI..r...|
+000001e0  67 e4 5a b0 a6 a8 37 ef  d3 96 28 dd f9 cc 24 c0  |g.Z...7...(...$.|
+000001f0  6f fc 7e 68 f5 25 df 38  73 1a ea b1 3d 8d 88 90  |o.~h.%.8s...=...|
+00000200  90 51 f3 f5 02 df 5a b2  5a 29 81 3c b6 aa 60 f2  |.Q....Z.Z).<..`.|
+00000210  79 ea 11 54 9d 6e ad e4  9b 48 35 6a 7b 95 ac 75  |y..T.n...H5j{..u|
+00000220  5e a5 dd 55 c7 97 10 aa  22 17 03 03 00 a2 12 24  |^..U...."......$|
+00000230  cd 8b fc be 73 28 ab a6  1e e6 f9 c2 d3 5e 98 db  |....s(.......^..|
+00000240  a9 30 02 c7 87 20 c9 34  d3 11 ea 3e 9f 3e 12 c7  |.0... .4...>.>..|
+00000250  55 16 8d 3a 33 8f 71 08  b0 10 e4 0a 43 6d 1e 59  |U..:3.q.....Cm.Y|
+00000260  79 e4 f0 86 6a bb 4a 4e  bf 03 7a 5a 7d 76 a1 be  |y...j.JN..zZ}v..|
+00000270  26 95 87 e4 8c 14 85 f3  a6 ec 9c 44 e2 80 04 96  |&..........D....|
+00000280  12 6a c5 97 c0 0c 4e 94  49 ef f9 78 38 09 c7 65  |.j....N.I..x8..e|
+00000290  6c 51 2b 2a a3 da 9c 95  37 1a da 37 f6 da c2 79  |lQ+*....7..7...y|
+000002a0  be 5a 1f 0a 59 5b d8 31  b8 c5 b1 12 ef 57 1b fc  |.Z..Y[.1.....W..|
+000002b0  62 8f de 94 3d 02 3c 96  cf 76 02 46 b7 64 0a 41  |b...=.<..v.F.d.A|
+000002c0  87 94 d6 98 61 82 8c ff  9f 42 dc f0 8e 6a 59 a5  |....a....B...jY.|
+000002d0  17 03 03 00 35 ec 44 9e  59 91 95 ae 8d f5 90 13  |....5.D.Y.......|
+000002e0  6e cf e5 4c a3 89 a0 65  54 f8 6c c0 b7 12 2b 26  |n..L...eT.l...+&|
+000002f0  fb d6 16 33 1e cd 5f dc  c1 06 f3 6e 9a 5a 30 c8  |...3.._....n.Z0.|
+00000300  87 6a ee 13 06 b8 30 c6  33 3b 17 03 03 00 17 a4  |.j....0.3;......|
+00000310  d8 51 e6 cd d0 30 f3 2b  5d 17 fa d4 c8 96 d1 8c  |.Q...0.+].......|
+00000320  2d b6 58 68 c7 93 17 03  03 00 13 1b a1 ec 18 a4  |-.Xh............|
+00000330  6f c6 5a 27 a3 1c a3 75  6d bd 68 61 28 cd        |o.Z'...um.ha(.|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-Ed25519 b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-Ed25519
index 689c28750b..94abf0667e 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-Ed25519
+++ b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-Ed25519
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,116 +7,117 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 4e 4c 01 f1 4e  |....z...v..NL..N|
-00000010  49 97 ec eb df ce 50 4d  1c 9c d0 35 92 10 97 0a  |I.....PM...5....|
-00000020  dd fb a8 4f 39 c6 14 21  d6 42 ac 20 00 00 00 00  |...O9..!.B. ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 63 7c fe 18 f1  |....z...v..c|...|
+00000010  82 47 f8 e9 56 0a ef 41  1c da 7b ef 4e 37 f7 37  |.G..V..A..{.N7.7|
+00000020  9c 70 58 73 97 a4 2b df  93 24 98 20 00 00 00 00  |.pXs..+..$. ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 c1  |..+.....3.$... .|
-00000060  c2 ca 32 aa 48 d8 52 bc  c8 23 6d 98 18 3e 15 b6  |..2.H.R..#m..>..|
-00000070  0b 25 db f9 6f a7 e1 75  95 a1 46 d3 47 4a 0e 14  |.%..o..u..F.GJ..|
-00000080  03 03 00 01 01 17 03 03  00 17 87 10 92 da b4 9a  |................|
-00000090  03 a5 0f 73 e6 93 cb 71  1d 58 6e 5d 27 eb ee b6  |...s...q.Xn]'...|
-000000a0  c7 17 03 03 00 42 89 8d  57 16 95 5b f0 98 ad c7  |.....B..W..[....|
-000000b0  d7 94 ba 4d 7e 88 b9 8d  13 26 a6 6c 81 90 a6 1e  |...M~....&.l....|
-000000c0  2b 4e 91 70 e2 da 9d a2  0d 6f 9b 5b ee 69 58 a1  |+N.p.....o.[.iX.|
-000000d0  4c c3 59 57 28 62 b3 ed  26 15 79 db 01 8c 88 e3  |L.YW(b..&.y.....|
-000000e0  63 1f bc b0 01 c9 82 ca  17 03 03 02 6d e5 d6 77  |c...........m..w|
-000000f0  4e d3 af c3 5e 01 e9 1b  31 63 a4 84 d3 cc 2d f8  |N...^...1c....-.|
-00000100  5d 73 f9 3e 83 03 c5 c5  cd 95 00 7b f2 b5 79 fa  |]s.>.......{..y.|
-00000110  47 e5 07 89 a9 22 49 7a  7e 7e 6e d2 3b 68 e8 9c  |G...."Iz~~n.;h..|
-00000120  40 1c 86 2a 48 ee 59 8e  1c 04 8b 91 20 68 65 31  |@..*H.Y..... he1|
-00000130  e7 76 dc 6c 5a ce cb 32  d3 e8 71 7f 93 08 b5 01  |.v.lZ..2..q.....|
-00000140  84 0a b4 ec 80 68 69 9b  b3 4a 4a 4d 56 16 eb 42  |.....hi..JJMV..B|
-00000150  29 93 4d b4 76 f6 e0 15  fe 25 b1 cb 5a da 22 4b  |).M.v....%..Z."K|
-00000160  88 4c ec 66 48 09 e1 d1  0f 3e 3a ad 65 d7 d7 85  |.L.fH....>:.e...|
-00000170  1d cb 35 2c 84 60 ec a1  6d f1 60 cf c6 c7 82 1a  |..5,.`..m.`.....|
-00000180  7c 91 40 2e 3e 88 1f ff  79 2e 6e 97 c5 45 9f e1  ||.@.>...y.n..E..|
-00000190  bf 33 ad 65 df f3 ce 1a  d7 57 7e db f2 28 79 a9  |.3.e.....W~..(y.|
-000001a0  9e 4f 9e 8a ce 02 5a 18  bb f1 ac 72 5b 3f 4c 6b  |.O....Z....r[?Lk|
-000001b0  97 14 14 f9 82 8a 4f 99  21 98 db af 3e 08 ab 4f  |......O.!...>..O|
-000001c0  d8 3f f6 cc da 76 77 eb  02 39 0a 00 23 a5 e0 92  |.?...vw..9..#...|
-000001d0  01 10 3f 76 ab 1a 38 8e  f9 a1 d0 25 c3 9d 50 a4  |..?v..8....%..P.|
-000001e0  ef a5 8c f8 5d bc d9 fd  dd 25 cd 42 38 52 d1 cd  |....]....%.B8R..|
-000001f0  d2 1b fc ba 7d 8b bd 82  05 23 c3 9d 02 ff 1b 4e  |....}....#.....N|
-00000200  08 e1 f3 7c 35 15 0f e8  0e b7 8a e5 4a 2b da 45  |...|5.......J+.E|
-00000210  4a 72 9a 32 7e 55 52 65  d2 a8 32 90 53 bf 25 29  |Jr.2~URe..2.S.%)|
-00000220  1e 8d d7 a3 22 d6 40 19  95 58 a8 37 af a8 52 e7  |....".@..X.7..R.|
-00000230  79 b9 4e 61 d8 f0 7d d2  69 25 99 28 3f 31 f6 b2  |y.Na..}.i%.(?1..|
-00000240  44 65 1f 9c 41 08 17 c9  01 5d 20 ea ab fe 06 64  |De..A....] ....d|
-00000250  9a f4 d0 24 e0 b5 88 0a  2b 96 e9 71 11 a8 49 b4  |...$....+..q..I.|
-00000260  40 62 1b 45 15 47 cb a5  fc 4f 07 58 2b ef d4 5d  |@b.E.G...O.X+..]|
-00000270  df 40 38 6c 6e ca 63 c5  95 2d 79 26 86 ff 33 02  |.@8ln.c..-y&..3.|
-00000280  da 5a 85 0c 8f 7f 58 ba  ea 88 cf bc 51 92 12 86  |.Z....X.....Q...|
-00000290  f1 c1 f9 0a d0 6e cc b4  2b 16 98 ad f8 11 ad 63  |.....n..+......c|
-000002a0  82 d7 4e ea a5 ee 78 a2  9a 35 b6 b3 d9 24 cf 66  |..N...x..5...$.f|
-000002b0  03 d2 25 1f 15 37 c7 b5  8e bb 0a 40 0f 28 c2 16  |..%..7.....@.(..|
-000002c0  90 a4 61 9e dd fd b5 ad  97 39 0d 66 e7 fa 5b e2  |..a......9.f..[.|
-000002d0  c2 ef 44 5d 44 07 d6 c3  ed e2 89 6e 4c ed 79 42  |..D]D......nL.yB|
-000002e0  86 3b f4 94 0c 82 5e 52  ce 00 ab 5c 20 b4 18 db  |.;....^R...\ ...|
-000002f0  c9 fe 8b be 8d da e9 86  13 62 6b 8d 0d 57 c8 fe  |.........bk..W..|
-00000300  a6 4b 82 52 d5 d8 05 18  2f a0 43 d6 c8 89 fb e7  |.K.R..../.C.....|
-00000310  72 17 61 89 36 5b e0 aa  4d 6c 20 ee 68 db 32 e4  |r.a.6[..Ml .h.2.|
-00000320  97 9f 18 26 7c 1a cd e8  b9 05 ae fd 86 bf 0e 47  |...&|..........G|
-00000330  09 06 bd de 2d b9 50 6a  0c a6 27 04 5e aa e0 ce  |....-.Pj..'.^...|
-00000340  e7 cf 98 f9 7e 7d b9 4d  77 9a 88 3a d4 41 07 cc  |....~}.Mw..:.A..|
-00000350  87 b6 41 53 8b 8c 79 8e  07 b9 17 03 03 00 99 0b  |..AS..y.........|
-00000360  63 4e d8 79 d7 11 f2 46  00 6c 5d d2 9e 49 df 7e  |cN.y...F.l]..I.~|
-00000370  f2 96 1a 68 9d 6a 05 dc  61 45 47 a4 18 5c 65 04  |...h.j..aEG..\e.|
-00000380  00 38 d1 25 0c ff a3 a2  c0 c2 82 7f b1 1b a1 c6  |.8.%............|
-00000390  7b ac fb 71 48 b6 e4 e2  7b c4 d0 44 8e 22 d6 91  |{..qH...{..D."..|
-000003a0  99 87 a2 88 3d bb b4 80  13 57 2a 6a b0 2d 52 16  |....=....W*j.-R.|
-000003b0  d3 f2 e4 cd d0 79 9a 31  ce 68 65 b3 61 67 a0 b9  |.....y.1.he.ag..|
-000003c0  1e 6b 9f 73 dc 46 be 5e  df d7 c2 30 d5 60 b5 e5  |.k.s.F.^...0.`..|
-000003d0  60 cc 10 ae 9a f9 b6 9a  fd 14 b9 1e b7 3c 1d 3e  |`............<.>|
-000003e0  34 a6 49 d2 48 f7 24 56  29 c9 98 f1 33 b1 e5 5e  |4.I.H.$V)...3..^|
-000003f0  2c 7b bb 5f b6 53 6a c8  17 03 03 00 35 d9 af 32  |,{._.Sj.....5..2|
-00000400  1f a5 09 3f 8a 10 df a7  34 9b f8 ec 07 81 80 73  |...?....4......s|
-00000410  dc ba 09 fc 40 e4 1e df  f6 de 02 54 3c 7d ea 49  |....@......T<}.I|
-00000420  91 16 72 70 8e 1a 21 76  c6 00 0e 03 9f 0a 82 fe  |..rp..!v........|
-00000430  4c 18                                             |L.|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 fe  |..+.....3.$... .|
+00000060  8e 92 58 47 f1 85 83 58  b6 18 1a 05 fb 40 99 25  |..XG...X.....@.%|
+00000070  10 d0 6d 4c c0 43 8b b5  a9 18 51 8f 84 73 56 14  |..mL.C....Q..sV.|
+00000080  03 03 00 01 01 17 03 03  00 17 3e f9 39 72 d3 bd  |..........>.9r..|
+00000090  1f 3f ff 30 cb 7e f8 3d  a7 7d 8c 09 94 d3 79 24  |.?.0.~.=.}....y$|
+000000a0  10 17 03 03 00 42 28 16  54 10 dd db 62 c6 08 c9  |.....B(.T...b...|
+000000b0  56 43 8d 0e 04 bc d1 78  54 21 1f 08 c0 80 e2 76  |VC.....xT!.....v|
+000000c0  8b 64 e2 63 97 a8 73 8a  14 16 2f 92 39 9c 59 e9  |.d.c..s.../.9.Y.|
+000000d0  59 a0 88 4b 9d 19 49 cf  34 98 c5 2a 48 eb d2 0f  |Y..K..I.4..*H...|
+000000e0  95 7a 25 f2 23 b3 88 61  17 03 03 02 6d 98 62 0c  |.z%.#..a....m.b.|
+000000f0  ed 07 3e a7 5b 8e 69 20  90 cb ff 25 06 fb 80 dc  |..>.[.i ...%....|
+00000100  b6 e6 bc 95 9c 6b 1e b4  11 a7 2f 72 17 c7 b5 67  |.....k..../r...g|
+00000110  93 a9 5c b8 ef aa e1 cb  6b f4 2d db e3 a4 c9 cf  |..\.....k.-.....|
+00000120  66 45 d9 1d 02 1d 9c b7  84 4f 83 5b 7f f3 16 0a  |fE.......O.[....|
+00000130  f7 37 86 19 c0 29 95 5a  aa 46 62 10 c9 22 62 f0  |.7...).Z.Fb.."b.|
+00000140  4f a9 a3 75 ea 46 af 75  54 9e 69 87 ce a9 d9 b9  |O..u.F.uT.i.....|
+00000150  35 d6 c0 4a f0 22 0b d1  e5 4b 48 99 70 fa bc ed  |5..J."...KH.p...|
+00000160  8a 8b 7d a2 f0 52 3d e0  bc d3 7e ca 1b 89 b6 78  |..}..R=...~....x|
+00000170  24 8d 13 0d 7d f2 3f d7  71 c9 d6 5a 00 8e 8c 7f  |$...}.?.q..Z....|
+00000180  ed 5b 39 f3 67 76 c3 7a  75 1e 4a 4b 63 36 e7 d4  |.[9.gv.zu.JKc6..|
+00000190  04 46 e0 17 f4 d0 41 9d  cf 01 f4 f7 b4 7e 11 73  |.F....A......~.s|
+000001a0  c4 46 ac d3 78 54 17 83  10 12 48 d1 36 ee 37 90  |.F..xT....H.6.7.|
+000001b0  f1 5f 7d f9 bc ac 95 ae  01 0e ca 0d 93 07 6e 87  |._}...........n.|
+000001c0  c9 27 79 46 0f 27 a1 31  f8 92 9e 73 3d 2e 29 f5  |.'yF.'.1...s=.).|
+000001d0  88 d1 67 a6 6a fb d5 59  39 65 46 b0 92 11 55 de  |..g.j..Y9eF...U.|
+000001e0  6f 9f 1d ea a0 71 65 4c  c8 03 b7 f1 25 ff f1 c9  |o....qeL....%...|
+000001f0  fa a7 1e 36 f3 91 bd d7  91 00 b5 3e 6f b1 67 5b  |...6.......>o.g[|
+00000200  fc 64 1d 76 0e a7 36 15  93 a1 ea 53 06 15 2b cf  |.d.v..6....S..+.|
+00000210  29 ea c6 5b 58 bb 08 a0  b8 9c e1 70 8d 2d 55 81  |)..[X......p.-U.|
+00000220  ac d9 0d 45 ec f9 c3 56  31 00 db 46 81 68 98 db  |...E...V1..F.h..|
+00000230  8d 97 ce d1 b9 83 af 5f  6a a2 1a 22 2f 52 a0 d1  |......._j.."/R..|
+00000240  8c 40 35 68 a2 ee 30 ef  d4 bf 08 46 76 7c dd 57  |.@5h..0....Fv|.W|
+00000250  c3 fb 7d fd af 01 37 cc  c2 44 f6 cf 80 f4 ab c2  |..}...7..D......|
+00000260  2e 82 18 5e c4 91 a8 b7  ad 29 e7 54 4f 02 47 5e  |...^.....).TO.G^|
+00000270  82 26 25 c6 b5 8e c9 a7  19 00 32 1b 3b e8 8c 35  |.&%.......2.;..5|
+00000280  25 01 ed e4 b2 29 e2 f4  d7 0f c8 39 f8 5d 7b 1e  |%....).....9.]{.|
+00000290  db 7b 39 f4 e2 cd 1a 57  07 48 2b 15 e4 39 03 54  |.{9....W.H+..9.T|
+000002a0  cf 39 fe 3d 15 47 bb 87  cf a5 f4 17 cc ad dd fa  |.9.=.G..........|
+000002b0  58 b6 e8 23 9c 1d 92 6b  32 36 12 ba 87 56 a4 2f  |X..#...k26...V./|
+000002c0  fe cc 93 98 62 84 5c e6  f9 fd d4 86 df ce 42 32  |....b.\.......B2|
+000002d0  08 da a4 13 40 a0 33 c2  2a 54 2b da 50 5b 27 d9  |....@.3.*T+.P['.|
+000002e0  3a 76 16 6c 89 bf 31 48  a3 ad c3 a6 ee 17 7d 86  |:v.l..1H......}.|
+000002f0  88 52 57 77 01 94 ba dc  f0 a6 c3 d3 30 ae be aa  |.RWw........0...|
+00000300  11 0a e8 54 8c b2 cb 7f  e6 b6 d3 17 f4 2e 54 94  |...T..........T.|
+00000310  31 43 33 07 5d 51 96 11  21 91 f9 7e 93 79 70 85  |1C3.]Q..!..~.yp.|
+00000320  d3 0b ee fd 0e eb db ad  71 fe ba fc fe fa ef 0e  |........q.......|
+00000330  a1 a4 c5 99 e2 fa 3c df  8b 52 33 89 fd 15 45 1b  |......<..R3...E.|
+00000340  4e 5f 0e ca e9 c5 6e 11  06 ae 37 2a db 4c 9f 2c  |N_....n...7*.L.,|
+00000350  21 67 af e7 ae 09 e8 96  2f f0 17 03 03 00 99 ed  |!g....../.......|
+00000360  df 2c ff 14 ed 8e 5e 83  63 5d 82 99 19 ef 4c b1  |.,....^.c]....L.|
+00000370  4b f6 88 29 27 72 b4 47  41 ab 61 58 67 7f 1c d0  |K..)'r.GA.aXg...|
+00000380  a5 6d 83 3a 4e be 98 7d  55 e3 cc a5 24 41 28 91  |.m.:N..}U...$A(.|
+00000390  33 b8 94 a8 e3 54 88 2b  22 89 c2 b8 86 96 d0 24  |3....T.+"......$|
+000003a0  99 6c 4c 26 ee 39 67 b6  8b 30 49 b9 d4 cd c0 b3  |.lL&.9g..0I.....|
+000003b0  bd f0 1d 2c 96 c7 9c 10  a7 4b 0e 2b 51 92 96 2f  |...,.....K.+Q../|
+000003c0  70 40 12 f3 91 53 eb 25  34 e6 ae ef df d4 3e f5  |p@...S.%4.....>.|
+000003d0  fa 9f c2 85 71 5d 21 fd  ee e0 3b 5a 23 db 19 e6  |....q]!...;Z#...|
+000003e0  ce 04 6c e6 37 2c 43 df  4c 1f 0a 84 36 5e 26 82  |..l.7,C.L...6^&.|
+000003f0  fa f4 38 ea 49 bb d2 65  17 03 03 00 35 a7 a0 78  |..8.I..e....5..x|
+00000400  91 74 da 83 6f bd 49 ae  52 e2 c2 a7 d9 b4 a1 bc  |.t..o.I.R.......|
+00000410  b8 59 ab 56 25 60 05 39  db 3b 5e 95 6f a6 43 b9  |.Y.V%`.9.;^.o.C.|
+00000420  1b 7a 84 ac ea 8a 62 f2  7c 50 68 43 0a c8 71 25  |.z....b.|PhC..q%|
+00000430  44 a0                                             |D.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 01 50 1d 6e 16 0d 4e  |..........P.n..N|
-00000010  c0 a2 41 c3 a2 84 c9 80  c0 f0 ef c0 5d 3a 3b f2  |..A.........]:;.|
-00000020  bf 1c 9e 79 d7 d3 94 0b  41 2d bc 50 eb 0f 60 f4  |...y....A-.P..`.|
-00000030  bd cd f6 03 22 7b 68 68  44 34 c9 0f 23 ca 76 6f  |...."{hhD4..#.vo|
-00000040  f2 97 38 07 43 56 7e b7  ce 67 68 67 37 34 d0 f7  |..8.CV~..ghg74..|
-00000050  c5 92 fd 65 98 b8 7e 5f  48 a8 a3 aa a8 96 65 b5  |...e..~_H.....e.|
-00000060  48 be 91 99 67 0a 37 c7  31 b4 43 ba 26 bb 87 98  |H...g.7.1.C.&...|
-00000070  3c 55 e4 63 b0 33 ca ee  0a a5 fe 36 88 ef cf f0  |<U.c.3.....6....|
-00000080  ab 6b 7d e8 f6 1f 14 12  49 f7 14 b7 12 bb d8 1e  |.k}.....I.......|
-00000090  e0 be ed 56 75 b9 ab 8a  20 75 d9 6f 45 2d 71 b3  |...Vu... u.oE-q.|
-000000a0  2f b7 cd 9c c5 16 ed 37  0e 08 15 a5 49 18 7c 13  |/......7....I.|.|
-000000b0  8e 0b 66 01 b1 8c 1d 89  d4 91 9e 5a 6b 94 f6 fa  |..f........Zk...|
-000000c0  7b a8 14 1c a7 20 55 c5  e4 0e 9d e0 5b d6 d4 b7  |{.... U.....[...|
-000000d0  1d 93 2b 7c 25 46 28 11  06 57 a3 cb 2f 4b 39 cf  |..+|%F(..W../K9.|
-000000e0  61 be 60 9a fd f1 6e e1  a2 a7 20 f2 fd 50 a2 d2  |a.`...n... ..P..|
-000000f0  17 db 16 4f 3f 8c 20 e4  4d 56 37 3b c2 42 17 cc  |...O?. .MV7;.B..|
-00000100  5d 99 06 fc 18 0d 1a 88  e8 f9 6f cf 7d 2e 57 73  |].........o.}.Ws|
-00000110  85 47 ed d0 2d b3 9a 05  cf 0c 7d e6 ed 29 95 f4  |.G..-.....}..)..|
-00000120  d5 e0 96 6a 1d 67 3e 5f  43 9f b5 f6 66 f5 84 63  |...j.g>_C...f..c|
-00000130  bd 42 a6 f8 ef 38 42 8a  d8 28 dc 55 e5 88 03 76  |.B...8B..(.U...v|
-00000140  96 ba 89 35 63 7e 6c da  39 d8 9a 27 04 ab d5 0e  |...5c~l.9..'....|
-00000150  48 89 cc 81 25 44 61 16  2c b2 69 17 03 03 00 59  |H...%Da.,.i....Y|
-00000160  81 8f 94 30 8d fc 47 13  7e 84 06 9b 4a 85 2c bb  |...0..G.~...J.,.|
-00000170  b3 a0 0d 4f 50 6a cb 0b  9b 40 ef cc 84 70 1f 69  |...OPj...@...p.i|
-00000180  b9 3e a6 c4 ba 66 eb a9  6f 78 83 7f d4 1f d8 c4  |.>...f..ox......|
-00000190  b0 f6 9b 03 29 7f b1 f8  60 40 0b 28 91 32 2c 03  |....)...`@.(.2,.|
-000001a0  aa 9e 7b fb 99 c2 11 51  1f a7 81 69 16 39 f4 52  |..{....Q...i.9.R|
-000001b0  ca d8 d0 f3 87 6f 58 ab  9a 17 03 03 00 35 de 03  |.....oX......5..|
-000001c0  88 61 50 5c 08 88 77 28  6a 1d 28 44 3d 49 8b 79  |.aP\..w(j.(D=I.y|
-000001d0  d1 a2 13 67 95 0f 7c 18  fe e2 e0 07 f1 ce b9 be  |...g..|.........|
-000001e0  79 aa 40 d6 cf 66 53 ac  15 ae 2a 14 a9 63 98 55  |y.@..fS...*..c.U|
-000001f0  96 16 6f 17 03 03 00 17  a8 ac 17 c5 eb d9 8e 77  |..o............w|
-00000200  9e 4b e0 20 c6 0c 34 b6  c3 ab c4 b6 8b b2 77 17  |.K. ..4.......w.|
-00000210  03 03 00 13 58 d4 7b 8f  ca 20 41 e3 3f d1 ae cf  |....X.{.. A.?...|
-00000220  3d e1 86 91 c0 a1 08                              |=......|
+00000000  14 03 03 00 01 01 17 03  03 01 50 e5 d5 ff 01 ac  |..........P.....|
+00000010  29 be dc aa 07 05 88 f6  e6 ae aa 3f 10 c6 72 1e  |)..........?..r.|
+00000020  31 1a dc e5 64 ab 1f 82  60 0a a3 24 59 4a 91 86  |1...d...`..$YJ..|
+00000030  d0 90 e5 5a ca ad 5b c4  18 a6 c3 d8 56 7b 86 7c  |...Z..[.....V{.||
+00000040  53 b4 59 7e 91 5d 9c 32  11 44 66 7c 75 43 d1 d9  |S.Y~.].2.Df|uC..|
+00000050  dc bd 99 7d 37 37 c1 be  ef 61 bf fb b4 f4 2e 2e  |...}77...a......|
+00000060  c5 66 fa d2 a1 86 4e 42  03 ed 7b 78 2b 82 f8 6d  |.f....NB..{x+..m|
+00000070  f5 12 6f 60 c7 93 03 12  43 5a 4b 21 25 88 8b 54  |..o`....CZK!%..T|
+00000080  37 2e 9b 1d bb 86 4a 85  80 e2 cb b1 0b 38 05 b1  |7.....J......8..|
+00000090  d2 a7 04 c6 a3 db df cb  18 90 db 17 dd f1 04 44  |...............D|
+000000a0  c0 5a ce ed 39 4e 89 91  8c 00 a2 8e 5f c4 64 8d  |.Z..9N......_.d.|
+000000b0  22 e5 53 7c ea 2d 09 65  0f 76 31 ef 50 b6 b7 6f  |".S|.-.e.v1.P..o|
+000000c0  a4 63 83 c2 90 07 67 28  37 c2 56 cb 56 71 92 3c  |.c....g(7.V.Vq.<|
+000000d0  ea 34 3b 54 58 78 b1 c0  ef 1c fc 4e c4 c5 f7 89  |.4;TXx.....N....|
+000000e0  55 f4 95 c0 bc af 1f 9e  0d f3 b8 35 54 64 c2 4b  |U..........5Td.K|
+000000f0  cc 4b 30 6f e0 5c 7b 51  1c 05 51 b3 6a f2 60 1f  |.K0o.\{Q..Q.j.`.|
+00000100  a5 26 ec ad 5f 93 1a 45  f9 88 73 5a 9a 51 fe c8  |.&.._..E..sZ.Q..|
+00000110  1a e7 9b 8c 9d a6 55 68  57 80 a5 81 8e bd 1a 5f  |......UhW......_|
+00000120  9d 56 89 8f 32 9a 5b 4c  60 e0 b2 73 e5 5c 04 62  |.V..2.[L`..s.\.b|
+00000130  62 1c ee 89 6d 00 4a bb  e0 b9 5f 6f f3 a7 5e bc  |b...m.J..._o..^.|
+00000140  95 a1 a8 a7 94 c2 06 19  97 0f 2f ff b0 95 c6 39  |........../....9|
+00000150  8d 96 59 71 87 90 34 76  b2 3b 7d 17 03 03 00 59  |..Yq..4v.;}....Y|
+00000160  7d ba 65 99 35 1b 2b 93  b1 76 99 9a 5a 90 4c 2a  |}.e.5.+..v..Z.L*|
+00000170  2a 14 1e 99 dd 23 10 95  fb 5b 9f 28 47 4d 41 3e  |*....#...[.(GMA>|
+00000180  71 d4 93 20 ee 69 32 85  b5 59 2a d0 1c 19 53 84  |q.. .i2..Y*...S.|
+00000190  46 0d cc 6a 9b a3 83 68  22 79 e5 e3 f4 56 a9 76  |F..j...h"y...V.v|
+000001a0  a0 9f d9 3c 27 3f 28 cb  ab eb f3 55 41 2b ce 6f  |...<'?(....UA+.o|
+000001b0  5a e5 22 c1 c9 0f 44 fc  8f 17 03 03 00 35 f6 80  |Z."...D......5..|
+000001c0  8e d2 cc 5b 6d 94 18 83  d2 70 87 e5 2c f2 0a 7a  |...[m....p..,..z|
+000001d0  44 a4 e9 6d f3 74 02 61  1b 87 6c b7 bf 8a ba 41  |D..m.t.a..l....A|
+000001e0  3b d8 18 2f 1d ad c3 9c  c8 6c c9 a0 82 7c bf 2b  |;../.....l...|.+|
+000001f0  f8 c2 09 17 03 03 00 17  79 0a 43 29 1d d6 b5 fc  |........y.C)....|
+00000200  fe 27 55 b8 5a 69 f1 b9  ed 31 63 2f 51 76 e1 17  |.'U.Zi...1c/Qv..|
+00000210  03 03 00 13 72 86 7e a3  6c af 2b e3 85 4c 16 74  |....r.~.l.+..L.t|
+00000220  97 73 48 96 ba 46 bd                              |.sH..F.|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-ECDSA b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-ECDSA
index 8e361eaf4f..e0acf89843 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-ECDSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,128 +7,129 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 30 0a c5 df b0  |....z...v..0....|
-00000010  90 3a 48 4b 20 f1 89 62  be 1f 1b 64 c2 7e 69 25  |.:HK ..b...d.~i%|
-00000020  9f b7 f9 2c 86 e7 40 e7  e8 10 fa 20 00 00 00 00  |...,..@.... ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 17 5d 17 94 35  |....z...v...]..5|
+00000010  cc 45 ba fc 44 dd 02 57  2c 67 67 c1 f9 7d bb 52  |.E..D..W,gg..}.R|
+00000020  fb 5e dd a2 29 43 14 95  be a7 98 20 00 00 00 00  |.^..)C..... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 94  |..+.....3.$... .|
-00000060  e8 ab 87 65 c8 dd 6f ee  b4 d6 0b bb fd 18 9a 2d  |...e..o........-|
-00000070  e4 bc c6 20 98 09 71 65  7d 54 35 73 22 99 1b 14  |... ..qe}T5s"...|
-00000080  03 03 00 01 01 17 03 03  00 17 37 b7 eb eb a2 9f  |..........7.....|
-00000090  7f 00 8c 9d a9 50 7c 0c  15 31 63 71 45 7a 3d ee  |.....P|..1cqEz=.|
-000000a0  5e 17 03 03 00 42 9f 23  07 cf d0 bc e8 bb 95 01  |^....B.#........|
-000000b0  37 94 18 2e 05 02 8a eb  0a 37 10 79 51 a9 d4 43  |7........7.yQ..C|
-000000c0  18 18 e6 00 9d 68 ff 74  f3 9c 19 bf 5e 51 0c 47  |.....h.t....^Q.G|
-000000d0  61 35 8c b2 58 5f 32 bc  88 c4 fb 5a 22 61 14 98  |a5..X_2....Z"a..|
-000000e0  28 26 8c 75 9d 1d 19 05  17 03 03 02 22 d2 2c 1a  |(&.u........".,.|
-000000f0  e5 58 0d d7 0b c4 66 b2  06 90 bc 92 0f 05 34 5d  |.X....f.......4]|
-00000100  2b 20 26 02 cc ac 90 40  a0 f1 5f 0e b9 99 7c 0f  |+ &....@.._...|.|
-00000110  c9 3e 60 0b 39 ec 6c 94  3a d4 f7 b7 49 5e c7 6e  |.>`.9.l.:...I^.n|
-00000120  df 3b cc 33 cb 32 41 53  dd 09 8e 91 97 d2 e0 06  |.;.3.2AS........|
-00000130  5e 0c 4c 49 46 18 83 fc  ac b4 f8 76 2d 18 ee 0b  |^.LIF......v-...|
-00000140  b6 4a b9 aa eb ee db 7a  aa 6d 04 84 ed 8e 15 bc  |.J.....z.m......|
-00000150  bf 6f a1 29 bc 0b 9f ba  05 a5 42 82 fd 1c 30 c9  |.o.)......B...0.|
-00000160  20 df 8e ba 28 ab 0b a2  42 09 5e e8 c1 61 d2 25  | ...(...B.^..a.%|
-00000170  fc 05 53 62 91 45 29 54  60 31 b8 4f 01 9c 7b 6a  |..Sb.E)T`1.O..{j|
-00000180  04 27 df bc e0 a0 3d b3  80 73 22 ca 9b 41 be b6  |.'....=..s"..A..|
-00000190  09 22 67 1e 54 52 ce 14  b5 56 7a ca 3f a8 3e 01  |."g.TR...Vz.?.>.|
-000001a0  d2 e4 36 18 87 f6 08 19  55 d2 ba 3c a3 c5 11 84  |..6.....U..<....|
-000001b0  62 2a 09 c6 67 de cd ab  66 12 dd 0a 23 77 18 b7  |b*..g...f...#w..|
-000001c0  73 c1 29 61 52 32 95 eb  a0 db 72 ae b7 ff 2a b2  |s.)aR2....r...*.|
-000001d0  08 f6 d7 69 32 c2 f8 8b  e1 40 a9 d0 fe 11 64 a2  |...i2....@....d.|
-000001e0  a2 dd a7 e6 a6 dd 5d 79  49 df bb c0 83 da 56 7a  |......]yI.....Vz|
-000001f0  a5 22 8e 60 df 89 48 e0  e2 e9 5f d5 fe dd ba 34  |.".`..H..._....4|
-00000200  ad 91 52 d8 2f 7e a4 73  50 e8 b7 83 e2 d9 5e 05  |..R./~.sP.....^.|
-00000210  96 08 e4 d4 bb 01 39 99  aa 1d fd 74 1b dc ca c2  |......9....t....|
-00000220  8f bb b8 bf c4 eb 00 6f  cc 70 eb 7c c7 29 e4 64  |.......o.p.|.).d|
-00000230  8c 76 a7 b5 79 ea b6 96  fe eb 8f e7 81 9b d1 d0  |.v..y...........|
-00000240  41 16 db ef 9e 55 2a 77  6c 34 54 22 48 6a ca 78  |A....U*wl4T"Hj.x|
-00000250  31 6e d2 00 7f 54 93 65  ec 28 42 66 7b 74 4d 58  |1n...T.e.(Bf{tMX|
-00000260  fe 25 74 bd 9f a4 ff f2  45 06 c6 63 1f 11 68 a4  |.%t.....E..c..h.|
-00000270  fb fe 62 2b f8 19 e3 32  2c cc 5d 71 37 21 05 82  |..b+...2,.]q7!..|
-00000280  c9 c7 30 c7 74 64 d9 f9  6b c2 ae d8 15 2b 2a 79  |..0.td..k....+*y|
-00000290  a0 2d a3 18 1f d7 20 99  96 86 52 32 cf 84 bd 73  |.-.... ...R2...s|
-000002a0  63 85 82 a3 64 fb e3 ea  1b 31 f5 df 1c 74 06 48  |c...d....1...t.H|
-000002b0  69 8a e3 f0 72 8c 59 8b  de 0b 06 02 47 54 4c 2d  |i...r.Y.....GTL-|
-000002c0  46 ac d4 f5 4d 5c fe 0d  bf af d0 37 58 82 3e d2  |F...M\.....7X.>.|
-000002d0  4e c1 7e 0f b0 21 f7 8e  2c 88 db 83 43 ed ad 5b  |N.~..!..,...C..[|
-000002e0  0f a2 ce 47 e4 3f dd 1b  71 fe f0 a7 a1 8d 8c dc  |...G.?..q.......|
-000002f0  75 e0 7a 89 f7 14 5b 37  9d 35 f6 23 91 a8 d2 1a  |u.z...[7.5.#....|
-00000300  96 07 1b 5b 9c 35 27 b8  b9 0c 92 1e cf 1b 3c 17  |...[.5'.......<.|
-00000310  03 03 00 a4 f0 59 e1 1d  62 39 69 c5 53 ae 66 85  |.....Y..b9i.S.f.|
-00000320  df ea 32 73 ca 94 e2 b5  14 d4 30 07 dd fd 2f 9a  |..2s......0.../.|
-00000330  16 fc e9 71 4a 20 b8 d2  7e 17 26 ff a9 55 56 24  |...qJ ..~.&..UV$|
-00000340  31 85 bc ea 19 1c 37 b7  fe 8b 47 5f a3 99 0f 5d  |1.....7...G_...]|
-00000350  17 92 4b 2a 4c b5 6c db  8f bb 46 ee 89 31 53 79  |..K*L.l...F..1Sy|
-00000360  aa 34 9d 9b e8 9b e7 82  55 a3 92 f6 53 53 d3 72  |.4......U...SS.r|
-00000370  17 23 33 01 e8 75 7e 8d  63 91 a0 67 8f a5 f0 15  |.#3..u~.c..g....|
-00000380  8c f5 81 e2 c4 08 ff 14  1d 96 cf ef 4e 09 18 a1  |............N...|
-00000390  2c 38 0a f7 33 f0 1d ef  9d 12 4d 8c 25 f0 80 a2  |,8..3.....M.%...|
-000003a0  aa a7 cf e4 7c e6 44 58  6d 30 70 48 55 3b b5 79  |....|.DXm0pHU;.y|
-000003b0  55 aa 03 ed 14 ea e5 ee  17 03 03 00 35 72 1a ca  |U...........5r..|
-000003c0  5c 3d 3b 75 29 cc a9 09  85 67 89 37 18 91 c0 af  |\=;u)....g.7....|
-000003d0  28 d2 0c c9 8b 05 94 04  3a 68 38 f0 c3 db 95 89  |(.......:h8.....|
-000003e0  c8 28 fc 07 4b 49 7d b6  25 36 05 53 96 e0 d9 35  |.(..KI}.%6.S...5|
-000003f0  e5 7c                                             |.||
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 8f  |..+.....3.$... .|
+00000060  cd f2 33 7c ee 70 18 fa  98 64 43 1b 24 e2 80 80  |..3|.p...dC.$...|
+00000070  a9 e3 3c 49 f3 a2 68 b6  ba 09 3b ef f4 4e 20 14  |..<I..h...;..N .|
+00000080  03 03 00 01 01 17 03 03  00 17 cc f4 79 1c f5 ef  |............y...|
+00000090  db b2 3b 82 f6 02 31 e7  2f 26 9a 6d 3b 8c 3d f1  |..;...1./&.m;.=.|
+000000a0  b5 17 03 03 00 42 74 b6  78 89 0f ce a8 80 4c 07  |.....Bt.x.....L.|
+000000b0  f5 3b 4d ce da 18 ee 39  c0 d9 9d c7 75 97 cc 50  |.;M....9....u..P|
+000000c0  8d de 0d a0 33 fc ab be  71 52 7c 7e fb 09 90 a3  |....3...qR|~....|
+000000d0  94 79 b7 16 04 4d db 57  29 dd 09 f1 94 b6 d4 ba  |.y...M.W).......|
+000000e0  b9 79 c2 76 49 81 d6 06  17 03 03 02 22 d2 06 bc  |.y.vI......."...|
+000000f0  ce f7 c8 18 26 55 74 75  6a 9d ff d7 0a 5b 19 a8  |....&Utuj....[..|
+00000100  c4 c7 66 2c 5b 94 09 0a  f7 f4 3b 2b 22 e0 89 6b  |..f,[.....;+"..k|
+00000110  2f 98 fa 03 55 3e 2d 08  ba 40 94 15 37 53 8a 0e  |/...U>-..@..7S..|
+00000120  8a da 06 d7 26 a9 ae e0  f4 b3 d2 33 37 06 8d 76  |....&......37..v|
+00000130  24 63 42 33 65 ad dd 23  c3 cb b3 6f 8c 0c ee be  |$cB3e..#...o....|
+00000140  63 1a 61 13 29 2a af 74  67 6a 19 d7 22 12 8a dc  |c.a.)*.tgj.."...|
+00000150  ce 77 81 26 b1 1a 2b 5d  77 0c 9a 65 6d 75 f0 90  |.w.&..+]w..emu..|
+00000160  95 66 84 3d d6 fd 95 c5  dd fd 80 5b 8e ab 1b 0b  |.f.=.......[....|
+00000170  f1 f0 b9 8c fc e2 3b ce  05 03 ef dc 4b 08 69 af  |......;.....K.i.|
+00000180  22 58 7b ab 6b cf 8e 63  40 e4 8d c3 5c f4 29 cc  |"X{.k..c@...\.).|
+00000190  d7 d2 17 94 af a3 ff 31  e4 75 78 c5 17 fb 84 f5  |.......1.ux.....|
+000001a0  e0 4b f8 70 3d 57 e0 dc  70 c5 5e 44 5a ea 2a 33  |.K.p=W..p.^DZ.*3|
+000001b0  22 47 a3 e4 7a 95 d6 10  7e 6f 87 b4 bc 5a 9a ba  |"G..z...~o...Z..|
+000001c0  99 af 7c 0d 6f 4d cc c7  0d 12 c9 99 e1 d7 90 2d  |..|.oM.........-|
+000001d0  8c 7b 24 11 c6 3e d0 16  fb a5 87 06 8f b5 e3 a5  |.{$..>..........|
+000001e0  f2 e5 d4 76 09 9e 9f ec  ef 58 b0 34 9c ff 21 aa  |...v.....X.4..!.|
+000001f0  48 a0 c8 2e ca 2d 8a cc  ad aa 9a 07 bd cc e4 12  |H....-..........|
+00000200  cd 33 5d b2 a7 95 a2 8c  e0 74 5b 6f e3 dd ce af  |.3]......t[o....|
+00000210  05 8a fe 52 d8 23 b8 70  bd 45 90 38 05 bf d5 89  |...R.#.p.E.8....|
+00000220  0f 4b 08 83 03 07 f0 24  bc 9d a9 d7 f4 0a 2b 94  |.K.....$......+.|
+00000230  82 f1 7a 3b 49 85 06 0e  d9 e6 c8 7c 69 f9 f6 61  |..z;I......|i..a|
+00000240  34 0e 6e 8c c5 76 18 f0  88 22 a0 3d b5 9a 92 55  |4.n..v...".=...U|
+00000250  88 37 ff 06 53 a9 64 4c  7d 12 c8 ac 72 de 74 d6  |.7..S.dL}...r.t.|
+00000260  62 ea 27 f5 e8 d1 09 a2  b1 df 1d 32 d3 15 b0 52  |b.'........2...R|
+00000270  98 fd 24 0b dd 33 0a 88  92 d1 cf c5 1a ef 27 8a  |..$..3........'.|
+00000280  7d b2 59 74 97 24 9c c3  cc 0e 1c a5 26 c7 5a 10  |}.Yt.$......&.Z.|
+00000290  0d be 10 b2 bc 79 76 21  b5 b7 48 24 59 08 41 4d  |.....yv!..H$Y.AM|
+000002a0  3c 31 ad cf 02 4b ed a5  fb 0d d7 55 60 fa cf 04  |<1...K.....U`...|
+000002b0  dd 84 0c 0b e9 eb ea 6d  e2 33 9d 04 1d 0b fe b1  |.......m.3......|
+000002c0  e2 cd 2d c8 84 2d be fd  ae 9e 1a 61 70 b9 d4 6e  |..-..-.....ap..n|
+000002d0  74 9f 68 b3 60 aa 42 bc  98 8d d7 45 f4 3b 00 2b  |t.h.`.B....E.;.+|
+000002e0  0d 55 f4 14 5d 9a ab f9  d1 af 9c b3 18 e3 8d f9  |.U..]...........|
+000002f0  8d 11 89 3e e7 6a f2 b8  52 fd 67 71 37 b4 ec c1  |...>.j..R.gq7...|
+00000300  6f d9 d6 57 67 4d 05 48  22 3a 4b 79 3b 2c 70 17  |o..WgM.H":Ky;,p.|
+00000310  03 03 00 a3 c6 8b 11 15  2c 6f 55 2f 96 01 24 f1  |........,oU/..$.|
+00000320  bd c2 79 09 2f d3 ff 9a  bb a4 b8 f5 f3 fe 85 d7  |..y./...........|
+00000330  7a 21 b9 92 e6 b5 89 c9  fb fb e2 4a 8f 5a 5c 63  |z!.........J.Z\c|
+00000340  7d 8c 4e 9a 27 1b 4a bb  e4 bb f0 cf 3f 5c c6 db  |}.N.'.J.....?\..|
+00000350  d8 83 bf 57 be ac ed 5f  1a 2c 10 77 7c b7 70 0f  |...W..._.,.w|.p.|
+00000360  4b 2d 93 e5 46 d1 75 fa  e4 da 73 c2 72 d6 48 6f  |K-..F.u...s.r.Ho|
+00000370  0d 21 eb 9d 2b d3 12 d9  d1 3c 9b 56 c3 90 2d 1b  |.!..+....<.V..-.|
+00000380  79 9a ab e8 2c 55 0e 67  0b 58 f8 ac 24 3a 6c a5  |y...,U.g.X..$:l.|
+00000390  34 29 30 6a b3 84 5a bc  59 f8 9c 07 75 b1 e8 ed  |4)0j..Z.Y...u...|
+000003a0  80 96 11 ad da 74 3b d8  9c 5c 71 8f a6 30 ad 77  |.....t;..\q..0.w|
+000003b0  e7 64 13 50 5e 76 ef 17  03 03 00 35 b3 db 05 94  |.d.P^v.....5....|
+000003c0  08 9b e0 1d 45 12 11 c7  b0 5e 61 ac a0 e7 8e 80  |....E....^a.....|
+000003d0  30 7f 20 19 69 da 73 06  a5 dd 7c 85 4e fa cc 37  |0. .i.s...|.N..7|
+000003e0  2c f8 4e fd ce 2b 4b f4  fd 68 de 23 15 36 00 8c  |,.N..+K..h.#.6..|
+000003f0  e7                                                |.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 02 11 6a 55 c4 ff 7a  |...........jU..z|
-00000010  5b c4 b7 cb 8d ad ae 53  53 3d 41 3a fc 16 44 fd  |[......SS=A:..D.|
-00000020  c8 5f 39 c3 5e 6b ee 7d  ea 88 9c a9 78 f9 dc 51  |._9.^k.}....x..Q|
-00000030  b2 90 68 7d ae 2c b7 90  6e 79 cf f4 97 50 95 87  |..h}.,..ny...P..|
-00000040  f1 f6 2c 14 bc 2b a3 68  0d e6 c8 66 2f 3b 89 72  |..,..+.h...f/;.r|
-00000050  67 4d d8 e9 8d 6a 89 2a  f9 e4 c1 b5 c0 92 16 25  |gM...j.*.......%|
-00000060  61 a6 98 ec b6 6b 52 8b  a5 80 5a 9e 6d 03 ad 42  |a....kR...Z.m..B|
-00000070  a9 46 2f d8 e5 67 c9 8d  89 f7 34 93 82 7c a3 bb  |.F/..g....4..|..|
-00000080  48 62 06 90 5c 5a aa fd  7c 71 88 24 22 f9 6a 2c  |Hb..\Z..|q.$".j,|
-00000090  d1 d9 7e 0a 4c 39 11 e8  c0 17 1d 83 64 f2 2b c6  |..~.L9......d.+.|
-000000a0  c0 81 8c 6a 39 a9 09 aa  1e 58 eb 30 88 59 4d f2  |...j9....X.0.YM.|
-000000b0  d2 64 9f 4c 90 29 c0 66  94 e3 df 12 9c 75 33 24  |.d.L.).f.....u3$|
-000000c0  fb 14 bc 70 e1 b5 de 54  28 b0 3f 01 2c 2e 5f 35  |...p...T(.?.,._5|
-000000d0  e3 01 59 2a 3f ce ca 11  bb 29 97 03 f6 f4 30 b9  |..Y*?....)....0.|
-000000e0  66 db 3c f7 06 41 7b e8  f8 af 3e 03 65 2f 5f 88  |f.<..A{...>.e/_.|
-000000f0  fd 30 45 7a c9 b4 9f bf  03 eb c9 dd 06 ac 82 06  |.0Ez............|
-00000100  e8 81 8e ea 29 45 78 5c  0f 8e 21 8a fb 0b 95 c1  |....)Ex\..!.....|
-00000110  63 e9 18 c1 9a a4 c6 7d  56 4b 9a de 96 dd 37 54  |c......}VK....7T|
-00000120  92 ef 71 42 a8 66 e7 df  e7 ea ec 4e 3c b3 8e 7d  |..qB.f.....N<..}|
-00000130  ed 92 da 86 e5 fa 51 f8  e4 b0 09 f3 06 4d 38 f1  |......Q......M8.|
-00000140  d5 5f d2 72 1e 5f c3 1e  1d fd 96 70 e7 9c ae ea  |._.r._.....p....|
-00000150  62 ce e4 a9 31 34 47 bc  f0 9f 1c c7 b6 66 f0 70  |b...14G......f.p|
-00000160  7a e1 c5 a9 76 64 d4 25  0f 56 cd 36 17 67 bd 4d  |z...vd.%.V.6.g.M|
-00000170  c7 78 d8 23 46 4b ac 46  34 1a d2 2d c5 e6 67 55  |.x.#FK.F4..-..gU|
-00000180  11 ec 8c f0 67 84 bf 89  ce 3c 71 4e 3a ab ff 22  |....g....<qN:.."|
-00000190  59 23 00 54 4b b6 9e c4  01 a1 9f e1 46 a6 a6 f3  |Y#.TK.......F...|
-000001a0  24 58 0c b4 6e 85 4c c1  8a d6 f8 02 c9 54 fb 85  |$X..n.L......T..|
-000001b0  c7 63 9b 47 28 10 a0 2d  b6 c2 83 16 71 ae a7 c2  |.c.G(..-....q...|
-000001c0  e0 dc 8b 6d 57 e0 4b a2  a8 5d 4d 8b ed 72 31 d6  |...mW.K..]M..r1.|
-000001d0  54 33 78 df bb 4a f9 58  9f 8c 2b 11 36 29 a0 f0  |T3x..J.X..+.6)..|
-000001e0  8a 95 20 d8 f1 8c 08 e1  54 0a 81 79 33 20 23 de  |.. .....T..y3 #.|
-000001f0  34 c8 2b 45 3a 59 c5 78  39 65 ea 70 e2 fe 59 4c  |4.+E:Y.x9e.p..YL|
-00000200  ed 7f 07 07 25 a7 ff fa  c9 c3 1f 33 55 c4 16 bb  |....%......3U...|
-00000210  c9 b9 e0 2e ff 94 7c de  84 30 60 d6 17 03 03 00  |......|..0`.....|
-00000220  99 53 44 d2 12 38 c4 a7  7e f5 f5 67 b3 79 cf 8a  |.SD..8..~..g.y..|
-00000230  34 0f 5d 49 0f bb 5f 30  c8 36 13 61 8d b5 b1 b0  |4.]I.._0.6.a....|
-00000240  dc 73 2f 1a 51 2f d4 8e  25 71 e1 46 af 11 96 19  |.s/.Q/..%q.F....|
-00000250  f7 fe 09 d9 6e 70 d5 fc  b9 5b 1c ae ed 06 37 af  |....np...[....7.|
-00000260  a1 bf 35 c6 6b 30 33 a2  c4 f6 c8 d4 73 34 73 8e  |..5.k03.....s4s.|
-00000270  69 08 be 91 2c 8d 01 52  30 14 b3 d3 a0 7d 8a 9d  |i...,..R0....}..|
-00000280  e9 af b2 77 64 eb 16 c1  8e 19 72 ad 4a fd d4 c9  |...wd.....r.J...|
-00000290  08 d0 54 6c f1 06 8c 70  2f e6 ef 23 23 67 96 db  |..Tl...p/..##g..|
-000002a0  5f aa 81 6c 41 17 6b f4  30 ce 00 d6 a2 d8 28 f8  |_..lA.k.0.....(.|
-000002b0  be 9f 04 94 fa e3 fa 76  d0 30 17 03 03 00 35 9b  |.......v.0....5.|
-000002c0  43 c4 8f dc b7 a1 44 4e  00 66 0a 95 a6 d7 46 79  |C.....DN.f....Fy|
-000002d0  30 2d 57 51 4e 21 a7 ed  43 e7 22 2d eb 07 9b 7d  |0-WQN!..C."-...}|
-000002e0  ea a4 ff 14 5d 97 1f d5  e8 f1 3d 8d e3 13 b6 79  |....].....=....y|
-000002f0  36 ce 83 e8 17 03 03 00  17 d5 98 a6 a3 b7 40 2b  |6.............@+|
-00000300  26 87 2f 4f 64 95 f1 2d  e0 7b e3 98 c2 81 dc 7b  |&./Od..-.{.....{|
-00000310  17 03 03 00 13 5b ab 65  e4 b1 d0 bd e9 c6 b2 3a  |.....[.e.......:|
-00000320  4b 66 ce eb 25 0c bc 7d                           |Kf..%..}|
+00000000  14 03 03 00 01 01 17 03  03 02 11 ee 00 8e e7 34  |...............4|
+00000010  b5 6f 32 2e e9 11 e3 7f  24 ff 64 6a 47 04 6d f7  |.o2.....$.djG.m.|
+00000020  3a 92 d5 45 12 92 c7 67  ea 91 31 9e 6e 61 a1 52  |:..E...g..1.na.R|
+00000030  9c e6 16 17 d3 8e 9e 41  85 1f a5 6a 69 97 53 f8  |.......A...ji.S.|
+00000040  35 b8 81 43 af 59 25 fc  78 42 b4 6f c1 4b 54 e2  |5..C.Y%.xB.o.KT.|
+00000050  e1 c1 97 b5 74 ea c8 b7  42 20 b2 42 27 68 7d f7  |....t...B .B'h}.|
+00000060  8c e0 18 53 46 e1 fc 86  55 bc 28 8a e1 95 94 24  |...SF...U.(....$|
+00000070  d4 38 80 a7 7e 85 2c a9  81 c2 4b c7 51 d5 0f 1f  |.8..~.,...K.Q...|
+00000080  88 8a 93 7d 74 53 1e f3  2b b6 b3 4a b5 a8 0c ea  |...}tS..+..J....|
+00000090  c4 6e 10 c3 8f ac 96 2f  c5 6b 63 f0 11 b0 38 81  |.n...../.kc...8.|
+000000a0  16 3c 96 fb d0 e9 18 5a  08 a0 f4 5e f0 6d 01 ff  |.<.....Z...^.m..|
+000000b0  13 04 c3 f7 e8 23 2a 06  32 6d 2b f1 d4 cc 60 ab  |.....#*.2m+...`.|
+000000c0  c9 9e c8 08 1d 8a 06 ff  7f 26 e1 db 13 d5 cd 3e  |.........&.....>|
+000000d0  5f 61 11 9b 43 cc 1e 19  32 6e 01 f0 79 3e cb 02  |_a..C...2n..y>..|
+000000e0  7d 4c 27 ee b0 4a 24 44  c7 ff 16 e5 59 c0 b1 2f  |}L'..J$D....Y../|
+000000f0  9a f6 c5 39 1f f2 f3 f0  70 89 e3 cb a4 43 81 16  |...9....p....C..|
+00000100  40 dd e2 3a e1 12 be 29  64 cb f3 f9 20 2c c9 62  |@..:...)d... ,.b|
+00000110  84 9c 31 fb 9b 95 a4 ac  3e 1d f4 19 bb 0a ce 89  |..1.....>.......|
+00000120  3a 33 9e 40 2b da 42 5c  71 59 54 bb 65 de eb 9e  |:3.@+.B\qYT.e...|
+00000130  71 46 40 9f 3d 6d 88 3a  0d b9 08 63 7d 4f a3 5b  |qF@.=m.:...c}O.[|
+00000140  9a 67 03 a0 d9 c6 47 4b  3b 11 d0 7b 13 fb 93 d1  |.g....GK;..{....|
+00000150  fc 63 dc 45 f2 b4 8b 22  12 31 20 48 6e 9a 4e 7d  |.c.E...".1 Hn.N}|
+00000160  3f 7e cd 09 6a ea 5f a1  0a e5 d8 80 c0 ed 6a cb  |?~..j._.......j.|
+00000170  0a af 1e 8f 88 63 63 13  49 02 d9 01 87 03 4f 9f  |.....cc.I.....O.|
+00000180  cc a2 5f 2f a8 3d 2b 9f  a2 f0 81 b5 b0 d2 92 6c  |.._/.=+........l|
+00000190  8f 3b f6 5c 66 27 d4 98  6e 86 e5 a5 ab 3c 1b b8  |.;.\f'..n....<..|
+000001a0  eb cb 72 d9 6c d8 49 9a  33 db 75 e6 3f ff 2a b0  |..r.l.I.3.u.?.*.|
+000001b0  77 c6 02 f1 c0 a5 74 99  42 42 e8 97 b5 27 a9 11  |w.....t.BB...'..|
+000001c0  af b7 65 b3 a8 51 dd 44  35 6e 0c 34 d5 b2 38 75  |..e..Q.D5n.4..8u|
+000001d0  f0 cf 10 ff 5a 7a 16 ca  bd 44 e8 99 91 50 9f db  |....Zz...D...P..|
+000001e0  8c ff 54 3a 24 73 de d1  29 5a 49 fc b3 d0 31 80  |..T:$s..)ZI...1.|
+000001f0  6f 16 84 c1 83 cf 9d 75  d4 b5 a5 a0 a0 15 bc 03  |o......u........|
+00000200  38 61 89 f5 16 98 25 f0  e8 72 28 3e d4 d6 64 66  |8a....%..r(>..df|
+00000210  de ff be 71 34 7c b1 63  38 38 81 03 17 03 03 00  |...q4|.c88......|
+00000220  99 3d e0 6d 2f 4c 22 62  d8 5f 0b 53 8a 99 c4 b2  |.=.m/L"b._.S....|
+00000230  66 88 d0 71 0c 90 b3 2e  9c 24 d1 89 4d f0 4d 29  |f..q.....$..M.M)|
+00000240  a7 11 87 db 08 cd 04 6c  1f 60 54 12 47 83 c7 82  |.......l.`T.G...|
+00000250  be 1b d8 ed 2f 43 c1 cf  63 21 bc 21 80 ad 7b ed  |..../C..c!.!..{.|
+00000260  5c 0b 41 0d 5e 63 eb 82  15 69 d7 11 c4 3f 0d fb  |\.A.^c...i...?..|
+00000270  07 96 34 a9 2c 9f 7f d7  fa 2c 24 c8 52 59 c3 07  |..4.,....,$.RY..|
+00000280  03 c7 88 65 8a 20 f2 1a  23 f8 18 2e 94 c6 be 77  |...e. ..#......w|
+00000290  bc 6e ff 7e 83 3e 9f 1f  77 b5 2b 67 e9 3d 03 c7  |.n.~.>..w.+g.=..|
+000002a0  b4 be 58 d1 12 69 39 3c  2d b3 dd 2e fb 41 b3 0b  |..X..i9<-....A..|
+000002b0  b2 74 d0 80 8a 90 40 ab  59 30 17 03 03 00 35 ef  |.t....@.Y0....5.|
+000002c0  7c c8 f8 01 6b 69 36 b2  26 9f 65 d8 a8 04 8a 41  ||...ki6.&.e....A|
+000002d0  58 e3 7a 6d 55 94 ec 09  df 6a a8 0d 86 54 c3 00  |X.zmU....j...T..|
+000002e0  a8 c2 46 e1 c0 83 fd 16  40 98 b3 5d c6 cc dc 3f  |..F.....@..]...?|
+000002f0  c2 4f 95 61 17 03 03 00  17 39 cc 91 bc 98 39 0c  |.O.a.....9....9.|
+00000300  1c 43 3c b5 cb 3b c0 99  68 9c 31 b5 1a d0 41 f9  |.C<..;..h.1...A.|
+00000310  17 03 03 00 13 65 9c ec  ea 6e ac de 8c aa 1d 5e  |.....e...n.....^|
+00000320  ff 7f 0d 3e 84 7a 90 6a                           |...>.z.j|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-RSAPSS b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-RSAPSS
index 2367a39717..ec18187517 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-RSAPSS
+++ b/src/crypto/tls/testdata/Client-TLSv13-ClientCert-RSA-RSAPSS
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,137 +7,138 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 a9 f1 13 c3 3c  |....z...v......<|
-00000010  1c dd c9 3a a1 ad 92 92  f1 f4 16 39 be 14 64 9c  |...:.......9..d.|
-00000020  66 d8 28 cd b7 bb 40 43  ec f4 67 20 00 00 00 00  |f.(...@C..g ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 60 e7 99 c9 b0  |....z...v..`....|
+00000010  be be 74 84 1e 55 cd 83  d6 0d ba 9c a0 44 fb b4  |..t..U.......D..|
+00000020  a8 f6 3c 93 12 de 47 4a  7f 32 a6 20 00 00 00 00  |..<...GJ.2. ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 ff  |..+.....3.$... .|
-00000060  53 ac b3 b0 48 47 d0 1e  b1 70 eb dd 02 e5 e8 07  |S...HG...p......|
-00000070  ce c7 e0 af d7 e0 46 c7  ff f5 97 30 e5 80 5b 14  |......F....0..[.|
-00000080  03 03 00 01 01 17 03 03  00 17 0b 12 ef 6d ea 5e  |.............m.^|
-00000090  71 41 83 d6 35 9f 39 2c  f0 ab 01 e9 03 54 c6 9e  |qA..5.9,.....T..|
-000000a0  37 17 03 03 00 20 15 7a  35 f4 a6 6e 65 89 10 ae  |7.... .z5..ne...|
-000000b0  18 31 c0 0c 15 1c b8 c5  5d f3 54 0c 98 32 a4 5e  |.1......].T..2.^|
-000000c0  91 f7 03 8a 80 b9 17 03  03 02 7a fa 93 7f c6 d1  |..........z.....|
-000000d0  2f 7e 2d d6 1b b7 ff fd  96 6e a1 f7 0e 98 dc 77  |/~-......n.....w|
-000000e0  cc 6a 4e 91 3d c1 ad 4b  5c 28 ee ea a7 0a ce 8f  |.jN.=..K\(......|
-000000f0  51 dd 89 fd 5a 81 6d 21  d6 0d 35 70 84 73 8c fa  |Q...Z.m!..5p.s..|
-00000100  2e 7a e0 af ab 79 79 aa  67 2b 80 a8 b3 a8 fb 0d  |.z...yy.g+......|
-00000110  eb 87 66 d5 be 33 0b f0  80 b8 5e 21 84 be 25 fe  |..f..3....^!..%.|
-00000120  47 98 5a 26 5d c3 96 2e  c5 b8 da 9f a6 d4 ca bb  |G.Z&]...........|
-00000130  de 7f 2c 0a 28 a8 f3 41  bc a2 2e 70 f2 b3 6f a3  |..,.(..A...p..o.|
-00000140  10 0e 1f 11 af 11 50 2b  22 84 97 d7 80 f5 62 77  |......P+".....bw|
-00000150  a6 94 47 22 ef 24 c6 0e  dc 5c f5 40 08 f7 21 78  |..G".$...\.@..!x|
-00000160  ae 11 f3 d8 a5 d8 20 ac  90 73 d7 a2 e3 f0 08 57  |...... ..s.....W|
-00000170  fc 74 70 66 fd 3d 49 c7  99 37 98 5e b1 1c c4 38  |.tpf.=I..7.^...8|
-00000180  64 09 e6 70 b6 8b 00 72  2d 5b b4 70 39 d6 e9 d5  |d..p...r-[.p9...|
-00000190  dc cd 8e 01 eb 5f 34 61  d0 97 62 0b 4f 81 ed 30  |....._4a..b.O..0|
-000001a0  64 56 f2 6e 31 5e 24 e8  56 2b d6 31 54 c4 48 47  |dV.n1^$.V+.1T.HG|
-000001b0  16 00 a7 65 c1 fa ea 12  30 78 41 e7 30 2d 71 cf  |...e....0xA.0-q.|
-000001c0  b0 e9 be e4 a2 33 38 87  2d 37 14 2d 03 cf ae 87  |.....38.-7.-....|
-000001d0  9a 09 f2 ed f3 44 66 c3  8a 56 8e e4 c4 aa e9 f7  |.....Df..V......|
-000001e0  cd 75 52 1b d9 ed 66 04  13 dd dd cf 0f 44 cd 18  |.uR...f......D..|
-000001f0  68 c5 2c 4c f9 e3 d3 02  12 78 38 5c f6 96 d7 80  |h.,L.....x8\....|
-00000200  f0 83 03 fe 7a e0 35 7e  a3 ad 99 52 ec fc ee 74  |....z.5~...R...t|
-00000210  f5 09 0f ca 69 f0 fb d0  40 90 1b 46 9e 2d 62 c9  |....i...@..F.-b.|
-00000220  0f 59 b2 cc a0 4a 9b 84  14 3a 1b 51 fc e7 e8 a1  |.Y...J...:.Q....|
-00000230  26 fd 20 8c 88 6f 87 11  ae 97 76 f8 4b cc 67 1a  |&. ..o....v.K.g.|
-00000240  3e 58 65 77 77 82 06 c0  d4 41 4e 66 d2 5a 83 b1  |>Xeww....ANf.Z..|
-00000250  ee 19 5d 7b 99 34 d3 2f  6c bd 30 a3 8c 75 89 ec  |..]{.4./l.0..u..|
-00000260  cb 90 8b 89 05 b8 e4 6e  3b 60 5d 0e 19 8f d6 c7  |.......n;`].....|
-00000270  86 f0 a9 2b c7 12 4a 4c  d8 a5 e8 64 49 1d 49 99  |...+..JL...dI.I.|
-00000280  a7 80 01 f0 77 57 4a 78  3c ac 38 40 bb d2 10 24  |....wWJx<.8@...$|
-00000290  9d e2 29 b2 1e 4b 50 66  64 07 79 80 c7 81 9d e2  |..)..KPfd.y.....|
-000002a0  f5 a9 10 9a 8d 3b de 0e  21 85 13 ac 26 30 f9 e4  |.....;..!...&0..|
-000002b0  a6 f9 8f e0 3c c1 69 7e  11 4c d1 a8 4e 88 30 fc  |....<.i~.L..N.0.|
-000002c0  52 6e b0 4f b6 7e 15 9e  a5 8a 46 ca 1f ac 8e 2a  |Rn.O.~....F....*|
-000002d0  07 34 d7 c2 14 c6 c1 ed  a1 f9 1e 59 b4 b4 86 3e  |.4.........Y...>|
-000002e0  d3 d0 78 a6 07 62 d3 88  80 54 a8 2a e9 38 2e 58  |..x..b...T.*.8.X|
-000002f0  43 94 cc ed f0 46 f6 cc  4b 7a b8 f5 a2 d6 a8 36  |C....F..Kz.....6|
-00000300  e2 8e 11 fb e7 21 19 c5  fa c9 90 98 72 43 88 ac  |.....!......rC..|
-00000310  c0 56 84 9e cd b7 e5 26  d6 49 19 88 a5 12 ac 49  |.V.....&.I.....I|
-00000320  5d 77 37 2a ff 38 5a 7a  5b c8 74 5d 74 fc 22 7f  |]w7*.8Zz[.t]t.".|
-00000330  46 97 2b 34 32 fb 83 65  75 b6 8b 5c 8a b1 d4 a2  |F.+42..eu..\....|
-00000340  14 7f 46 0d 63 17 03 03  00 99 c7 79 bb 4f 88 a0  |..F.c......y.O..|
-00000350  78 be 04 ca 39 1f 1f a8  82 59 b5 dd 96 93 0d c4  |x...9....Y......|
-00000360  30 f4 22 4c e2 52 51 d4  33 b8 35 7b ed 01 19 25  |0."L.RQ.3.5{...%|
-00000370  b5 31 36 25 23 a2 51 d9  7a a9 00 72 05 34 81 62  |.16%#.Q.z..r.4.b|
-00000380  d0 df 8b 3a 65 98 4e 87  e2 29 9b 44 77 8c dd c9  |...:e.N..).Dw...|
-00000390  4c a5 de 14 97 e0 f1 2c  e8 5d 0e 8f d0 fd f6 77  |L......,.].....w|
-000003a0  c1 1f ac 79 4d 32 19 09  98 a8 f0 2f 3e d5 7e f7  |...yM2...../>.~.|
-000003b0  aa c1 f0 36 b1 8e c7 0b  ce 09 00 ac 28 64 c0 33  |...6........(d.3|
-000003c0  58 cc 48 3a 15 a4 77 24  50 67 f2 39 53 4d 63 23  |X.H:..w$Pg.9SMc#|
-000003d0  48 74 bd 0a c8 02 17 be  e4 64 af 6e 02 a9 22 92  |Ht.......d.n..".|
-000003e0  65 04 c6 17 03 03 00 35  e0 4e 15 4b 9d 53 57 c6  |e......5.N.K.SW.|
-000003f0  97 b4 9d 1a 03 39 26 b9  ca 5b 04 50 af db 52 99  |.....9&..[.P..R.|
-00000400  d9 13 40 6a 89 23 99 42  9a 91 1d d1 6c 07 a0 aa  |..@j.#.B....l...|
-00000410  05 6e 60 0b fd e7 de 32  c3 97 18 0d 9b           |.n`....2.....|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 1d  |..+.....3.$... .|
+00000060  6d 42 7d 8f 02 04 a1 81  8a eb 36 fd 64 4b d1 6c  |mB}.......6.dK.l|
+00000070  98 e8 69 82 2e 92 7a 27  53 4f 74 bb 68 f2 7d 14  |..i...z'SOt.h.}.|
+00000080  03 03 00 01 01 17 03 03  00 17 2d 08 0f 31 27 58  |..........-..1'X|
+00000090  7b 40 eb cc 81 b9 7b 78  b4 c1 60 1e 10 74 3e f7  |{@....{x..`..t>.|
+000000a0  dc 17 03 03 00 20 af 35  53 ab e6 10 47 24 e5 79  |..... .5S...G$.y|
+000000b0  70 53 da 8e a2 bf 9a 81  ab 4d ba 80 09 40 e4 02  |pS.......M...@..|
+000000c0  8c cb cc 78 1c d4 17 03  03 02 7a 9a eb 2c 4f f5  |...x......z..,O.|
+000000d0  1a b9 d5 bc 47 d1 bc 35  47 07 66 bf 6d c9 35 b2  |....G..5G.f.m.5.|
+000000e0  b2 78 ef 18 22 9a e4 fa  b4 f8 12 0e fd aa a4 f7  |.x.."...........|
+000000f0  9f f6 5b 2a 7b 05 c1 52  f8 2e 53 84 6c ef 51 e7  |..[*{..R..S.l.Q.|
+00000100  4f e2 f5 e9 4b 20 da 94  5d 97 bb c2 66 fb 74 38  |O...K ..]...f.t8|
+00000110  d6 15 0c c9 6e c6 67 ac  ad 6f 4d d2 bf a2 13 29  |....n.g..oM....)|
+00000120  87 69 9b 4d cd 2e 83 60  db 5f ee f3 80 64 02 93  |.i.M...`._...d..|
+00000130  4f 1e 35 0b 01 25 1f cd  27 24 7a 82 8d 00 94 3a  |O.5..%..'$z....:|
+00000140  34 b0 f2 53 36 0b f6 04  d3 25 2a 4e 2a 7e 26 98  |4..S6....%*N*~&.|
+00000150  41 ce 68 64 17 c9 65 9e  f7 f9 bb df ee fb cb 74  |A.hd..e........t|
+00000160  db 7d 8a 43 d2 49 03 f6  e5 be e1 5e 45 df 77 c4  |.}.C.I.....^E.w.|
+00000170  1d 6e 9c ec 29 51 2b 7f  5e 75 46 05 50 39 5f fa  |.n..)Q+.^uF.P9_.|
+00000180  5f 53 04 56 25 87 09 26  36 8d 55 ac 03 87 35 28  |_S.V%..&6.U...5(|
+00000190  52 05 c0 23 ff d5 57 58  7a 63 09 9d 87 15 b4 35  |R..#..WXzc.....5|
+000001a0  d9 40 19 4e 67 ce cd be  5b a0 14 e2 a8 4a ad 44  |.@.Ng...[....J.D|
+000001b0  ea a9 1b 14 e7 30 05 c9  23 48 4a 7a 7a 3f cc 9a  |.....0..#HJzz?..|
+000001c0  ce ca 0e 5f a0 79 17 e0  e7 5b 30 79 38 2d 5b 1e  |..._.y...[0y8-[.|
+000001d0  5c ae 4e 1f 00 ed fb 9f  b6 e7 92 42 7d f0 30 82  |\.N........B}.0.|
+000001e0  70 18 dc 07 c1 64 ec 09  7e d7 8f eb 68 31 75 cb  |p....d..~...h1u.|
+000001f0  69 24 30 89 8b 69 df 69  86 23 77 d2 61 4b 66 7e  |i$0..i.i.#w.aKf~|
+00000200  6d 34 50 a5 da 86 12 22  e3 51 ac 6a 23 55 d4 d5  |m4P....".Q.j#U..|
+00000210  51 73 ac 85 c9 3a 57 c2  4b 55 96 4b c6 cc 62 15  |Qs...:W.KU.K..b.|
+00000220  c9 10 09 ac ec 75 1a a6  3e e8 da aa 4d fe 7d 51  |.....u..>...M.}Q|
+00000230  80 c3 a7 98 5d 29 cf c6  a0 8c 37 6e a8 f0 ad 41  |....])....7n...A|
+00000240  34 60 44 98 57 3a 97 1f  29 08 f4 fc 4e 76 2e 0b  |4`D.W:..)...Nv..|
+00000250  26 8d fa 6c 38 0e 17 8a  2c de 51 94 f5 37 63 a0  |&..l8...,.Q..7c.|
+00000260  40 71 51 c0 b9 d4 04 b2  ef 88 80 8f 34 74 35 5a  |@qQ.........4t5Z|
+00000270  c4 96 68 4f 27 0c 53 db  f4 3c d1 88 86 b2 24 4f  |..hO'.S..<....$O|
+00000280  c7 a7 d9 b4 56 22 e5 9d  3f ec eb 1a af 77 9a 47  |....V"..?....w.G|
+00000290  26 bb d5 3d 90 1d 6d fb  d9 29 7e b4 b2 b2 ec 10  |&..=..m..)~.....|
+000002a0  67 de d2 02 74 b3 91 a0  c4 b3 7c ba bb 90 b5 da  |g...t.....|.....|
+000002b0  97 fb 84 cd 4b 5e 33 c0  0a 56 73 98 8c 81 5b 9d  |....K^3..Vs...[.|
+000002c0  8d 83 df c3 8d 3d 3c 58  55 a3 e7 bd ef d0 37 0b  |.....=<XU.....7.|
+000002d0  1d 0d 6d 59 81 d7 5d 34  b3 c9 bd ea 96 9a 33 02  |..mY..]4......3.|
+000002e0  50 6d 81 1f 58 36 95 0c  c0 6d b6 3e 2e e0 0a b7  |Pm..X6...m.>....|
+000002f0  c8 ae d8 84 06 2c 64 3c  35 a7 39 e4 a6 9e 0c 59  |.....,d<5.9....Y|
+00000300  89 59 9a dd c3 fb 6c ae  34 ec 66 c5 d5 1f 7b 13  |.Y....l.4.f...{.|
+00000310  66 23 8d 22 93 da 53 6c  3f 85 bb 5c 52 75 ba 81  |f#."..Sl?..\Ru..|
+00000320  e8 bf 57 ce a8 45 68 ad  57 2f 4e 51 d3 65 f3 d0  |..W..Eh.W/NQ.e..|
+00000330  1f 09 1e 3f 5e a1 9e 56  61 ca 88 e7 44 f6 f6 93  |...?^..Va...D...|
+00000340  cb ae 28 2b 74 17 03 03  00 99 de 30 0f 41 8e d8  |..(+t......0.A..|
+00000350  37 a0 c4 f3 af c3 f8 39  b7 44 83 6a c4 11 9e a4  |7......9.D.j....|
+00000360  a9 f0 08 22 77 ce 09 a3  2d 94 99 2a c7 1b 9c 25  |..."w...-..*...%|
+00000370  b6 79 ec 7b 2f 70 6a bd  2f f0 0f e0 6d 6e c0 69  |.y.{/pj./...mn.i|
+00000380  0c 52 13 1f f9 99 97 04  2f fc fb f8 0a 4b ab bc  |.R....../....K..|
+00000390  a3 00 02 7f 0f 30 e2 66  c2 df 63 69 ad 08 76 ec  |.....0.f..ci..v.|
+000003a0  58 99 42 6a 11 e6 7a 27  57 98 71 c9 4d 78 c8 4a  |X.Bj..z'W.q.Mx.J|
+000003b0  3a 62 59 62 fb 2b 6f 15  79 22 50 40 bf db 29 d5  |:bYb.+o.y"P@..).|
+000003c0  32 e5 e7 1e 76 50 05 e4  26 24 97 79 2a 9a a5 ec  |2...vP..&$.y*...|
+000003d0  c7 8c 68 e3 71 97 0c 85  51 74 db 5b 86 fb fb 23  |..h.q...Qt.[...#|
+000003e0  e6 ef 57 17 03 03 00 35  5c 96 e3 26 e5 49 d8 02  |..W....5\..&.I..|
+000003f0  b0 d0 4d 20 15 72 76 49  48 ee 2b 0a 19 44 05 cd  |..M .rvIH.+..D..|
+00000400  b1 0a 76 4e a9 21 45 5e  de 00 6b c3 53 7c c9 8d  |..vN.!E^..k.S|..|
+00000410  43 72 06 78 0c ce 78 0f  01 ca d1 92 e5           |Cr.x..x......|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 02 7a 94 78 2d 5d 5a  |..........z.x-]Z|
-00000010  3e 96 7f 19 29 51 99 f3  6e d3 a4 d5 3c 9a 3d d5  |>...)Q..n...<.=.|
-00000020  37 bc 3b 71 b3 54 83 d9  5e 9d 64 76 f9 74 7a 24  |7.;q.T..^.dv.tz$|
-00000030  e3 cb ea aa 17 f4 44 41  73 71 39 d6 9b d5 a6 a2  |......DAsq9.....|
-00000040  6a 1e 1c 02 a1 d5 e3 e8  f5 f7 07 9d 3b ea f8 6d  |j...........;..m|
-00000050  80 cf 6b 14 71 b8 bd c4  8a 07 49 31 e7 bd d5 91  |..k.q.....I1....|
-00000060  ac 80 70 25 5e f4 db 07  ed 36 c2 3a 1d ad 86 6e  |..p%^....6.:...n|
-00000070  68 1a ca 4f a1 ba c3 2f  de 49 01 fa a9 39 a6 51  |h..O.../.I...9.Q|
-00000080  3a e6 9f cf 6b 02 4e 1e  70 dd f2 10 c2 62 9b 1f  |:...k.N.p....b..|
-00000090  83 10 fa 85 52 a8 a7 08  37 9c 92 b0 9c fe 00 78  |....R...7......x|
-000000a0  0b a4 7b b5 f9 9f 87 d2  d3 07 72 b2 ab 96 9e 73  |..{.......r....s|
-000000b0  55 3c 1e 65 99 89 36 78  7e 42 8f 05 de b6 fb fc  |U<.e..6x~B......|
-000000c0  1b 34 18 e6 4d 15 6c d1  2f 2c b0 ef 00 e9 07 89  |.4..M.l./,......|
-000000d0  ca 91 d9 c1 73 bf 8f a5  a4 7d 7e cc f5 85 fb af  |....s....}~.....|
-000000e0  57 70 35 63 71 d6 78 57  13 48 27 ba a4 42 22 c2  |Wp5cq.xW.H'..B".|
-000000f0  56 f4 ae 38 39 a0 1f 57  44 57 c4 8a 70 90 30 70  |V..89..WDW..p.0p|
-00000100  ba 4a 98 29 0f aa e2 33  27 24 ee d9 e9 02 80 68  |.J.)...3'$.....h|
-00000110  4c 55 08 fb 3d 25 d6 d4  9d 83 ea 14 99 c2 77 94  |LU..=%........w.|
-00000120  f9 70 34 a8 ed 35 e6 4f  c2 75 50 63 d5 9d 9a 89  |.p4..5.O.uPc....|
-00000130  8f 2e 5b ca 6b b3 ad e7  a2 c6 f7 0c 45 08 b7 f4  |..[.k.......E...|
-00000140  58 d3 d5 54 c2 67 f3 76  fb fc 9d fe 42 43 ea 90  |X..T.g.v....BC..|
-00000150  2b 29 e7 10 2f d7 9c 04  c4 cc 89 8f a9 36 14 f6  |+)../........6..|
-00000160  fc f1 25 6c 90 12 bf c6  cd ad 46 ce 17 3b 26 fb  |..%l......F..;&.|
-00000170  c6 98 cb 6c f2 2c fd b9  2f 52 3e 56 42 78 0b 92  |...l.,../R>VBx..|
-00000180  a5 27 56 18 3d d6 26 3f  e4 a1 6f ce c8 f1 f1 7a  |.'V.=.&?..o....z|
-00000190  1f 84 66 c9 d9 8a 5c 0e  34 80 ba 58 b3 8b 7f f3  |..f...\.4..X....|
-000001a0  8a c9 6b c4 99 94 2c b7  e8 e8 9a a5 43 75 f8 e0  |..k...,.....Cu..|
-000001b0  29 1f 70 77 c7 4a 9f de  ca 92 88 7c 37 12 d9 ef  |).pw.J.....|7...|
-000001c0  2f 94 de ea d1 d9 69 6a  93 06 36 e0 68 02 53 ae  |/.....ij..6.h.S.|
-000001d0  0e 00 cd ad d3 10 a7 89  2c 53 a7 03 d9 07 3c e9  |........,S....<.|
-000001e0  0b b0 18 2e 03 88 03 5c  f4 b2 7e 59 f4 22 8c f7  |.......\..~Y."..|
-000001f0  5e d7 c7 ea ac 0f bc f7  3e 3f 75 fd 6d 9c 4c 3c  |^.......>?u.m.L<|
-00000200  41 8d f5 30 17 20 83 c3  27 83 ce 84 6a e3 75 2b  |A..0. ..'...j.u+|
-00000210  9d 7d de 2a bf 5a fb e1  2f 80 74 74 f6 09 bc 1f  |.}.*.Z../.tt....|
-00000220  be f0 59 9e ce a1 62 46  54 a4 9a 25 97 b7 cd 1a  |..Y...bFT..%....|
-00000230  0a d0 44 f6 ea a4 ed 63  e7 49 9a 4b f4 1a 39 91  |..D....c.I.K..9.|
-00000240  e6 34 e1 7b dd e7 53 ab  83 56 57 b2 89 3f 90 1f  |.4.{..S..VW..?..|
-00000250  98 c4 64 27 b5 f5 f6 57  16 ca d9 0a 33 de 24 c3  |..d'...W....3.$.|
-00000260  f3 7c 23 37 94 93 c5 1a  42 da 18 6b 24 dd 37 54  |.|#7....B..k$.7T|
-00000270  ae f3 8a 3e 10 42 20 6e  49 23 1a 0f bd 65 7e 45  |...>.B nI#...e~E|
-00000280  12 7a 64 9a 30 17 03 03  00 99 af 41 cf 95 21 1f  |.zd.0......A..!.|
-00000290  34 df 1c c7 a8 b6 ee 31  8d b3 9e 5a 59 8e c4 37  |4......1...ZY..7|
-000002a0  79 a4 d8 75 22 da 12 21  e5 de d4 ad 98 17 e2 ae  |y..u"..!........|
-000002b0  ae 9f f6 e8 29 66 d0 ac  b4 08 16 24 40 67 9d d5  |....)f.....$@g..|
-000002c0  bf a4 64 91 a1 17 82 c0  e7 77 b6 20 26 4a 70 1d  |..d......w. &Jp.|
-000002d0  c8 f8 ec 18 b7 c6 3c 81  b9 c6 04 9c 0d 37 a6 39  |......<......7.9|
-000002e0  fd 2d 99 d7 ba 41 a4 91  60 f1 1f d2 76 76 aa 47  |.-...A..`...vv.G|
-000002f0  89 0a d1 97 0b 91 20 a9  43 c9 ce 2c 84 ba 81 7a  |...... .C..,...z|
-00000300  39 91 7d 12 75 05 8e 87  b1 3f 80 8d 12 ca 8f 91  |9.}.u....?......|
-00000310  23 84 28 11 c3 81 ed 09  05 16 6e 50 57 76 ad 5c  |#.(.......nPWv.\|
-00000320  c5 92 77 17 03 03 00 35  5a d9 15 29 1f a3 f0 cf  |..w....5Z..)....|
-00000330  74 c4 1d 0c c3 fa 54 59  1e 54 06 0d 1b ce 07 00  |t.....TY.T......|
-00000340  f9 66 3d e1 75 10 cf de  cb 7d 0d d6 d1 4d 87 81  |.f=.u....}...M..|
-00000350  13 ec 2c 28 13 a5 b3 01  c7 86 3a 84 65 17 03 03  |..,(......:.e...|
-00000360  00 17 b4 e4 18 61 62 04  b3 ca 98 36 93 42 a2 be  |.....ab....6.B..|
-00000370  2c f5 18 11 bd 7d 64 70  bc 17 03 03 00 13 32 65  |,....}dp......2e|
-00000380  fa 07 3e 3c ed 9d 85 31  ba 8e 92 ea de 17 59 cd  |..><...1......Y.|
-00000390  db                                                |.|
+00000000  14 03 03 00 01 01 17 03  03 02 7a 98 e7 1d af de  |..........z.....|
+00000010  f0 97 05 09 b8 cc a4 5e  e2 ba 26 13 bd dd a4 de  |.......^..&.....|
+00000020  c6 fd 81 dc 0c 55 68 d8  90 32 36 e2 1d 05 15 c4  |.....Uh..26.....|
+00000030  d2 c6 2b 99 b3 22 fd 4a  15 82 34 93 f8 39 04 6c  |..+..".J..4..9.l|
+00000040  e0 d1 c3 d3 16 77 dc 51  65 f9 ac 04 1d 38 8e e7  |.....w.Qe....8..|
+00000050  10 ee 22 c6 25 6b 20 e7  1d e7 89 c1 88 ee d9 80  |..".%k .........|
+00000060  29 45 83 64 12 a6 50 18  42 04 1f 34 15 35 24 f9  |)E.d..P.B..4.5$.|
+00000070  86 0b a0 be c6 4b 9b ab  7f 07 7f 74 09 78 56 77  |.....K.....t.xVw|
+00000080  72 ef 57 52 22 14 38 ee  70 e8 93 38 b0 cc cc 13  |r.WR".8.p..8....|
+00000090  fe 3f 04 a2 af 20 f4 cf  f4 bc 22 76 54 9e 43 63  |.?... ...."vT.Cc|
+000000a0  e6 2d 77 c3 b8 b2 79 79  b8 89 86 9e 3c 01 c2 4b  |.-w...yy....<..K|
+000000b0  a7 48 3c 7b 5d 74 6e 79  88 e1 3b 73 e0 04 57 20  |.H<{]tny..;s..W |
+000000c0  f7 36 c8 1a 9a 09 b2 77  20 6d 1b 7c 01 d2 6a 66  |.6.....w m.|..jf|
+000000d0  8e 9a 14 02 ef 7d 26 52  eb 50 93 56 77 d7 04 3b  |.....}&R.P.Vw..;|
+000000e0  62 6f 9e 64 f4 f5 d6 83  f6 27 d8 37 05 cb dc 86  |bo.d.....'.7....|
+000000f0  df 7f 0a 7e bc 23 bf 5a  b4 72 b9 5e 1c 8b b5 e8  |...~.#.Z.r.^....|
+00000100  b8 d7 3e a8 72 0a 2b c0  cc b0 6b a2 f9 5a db 1d  |..>.r.+...k..Z..|
+00000110  ea 5a b1 28 d0 ad 0c db  91 45 b9 b7 cd 25 51 1b  |.Z.(.....E...%Q.|
+00000120  47 e8 9e bf 25 6b 65 a9  c7 ed 39 a1 68 49 83 55  |G...%ke...9.hI.U|
+00000130  3c 74 36 dc 71 f6 38 72  20 94 53 bf fb 0a 1c b4  |<t6.q.8r .S.....|
+00000140  80 d0 18 94 08 0f f5 a1  22 ee 4c d8 c3 b5 fa c6  |........".L.....|
+00000150  2c 53 bd 48 35 77 d9 68  9f a7 96 6d 6a fa 8e 8b  |,S.H5w.h...mj...|
+00000160  3e 13 1e 72 10 e0 0c cb  76 f9 0b 5a 2f a7 f1 63  |>..r....v..Z/..c|
+00000170  70 06 40 a8 57 46 c5 02  e1 74 71 2b e3 16 9e 6e  |p.@.WF...tq+...n|
+00000180  54 00 cc f1 9b ab e5 89  88 f8 84 47 c4 8a da 4a  |T..........G...J|
+00000190  62 d2 8d 64 8d 38 58 23  29 fa e9 41 c3 72 7b 3a  |b..d.8X#)..A.r{:|
+000001a0  5c fa b4 f5 12 be 1f cc  35 92 ec 24 8b c4 78 ef  |\.......5..$..x.|
+000001b0  3e db 36 a1 78 6c e6 51  a7 c4 1b fd bd 4d 6f b9  |>.6.xl.Q.....Mo.|
+000001c0  7d 51 c3 a5 e7 cb 2a 20  99 74 4e 1d 1a 4f 6d ce  |}Q....* .tN..Om.|
+000001d0  fb 11 77 1c e5 20 f1 0e  38 8b 5e 6c af f4 98 63  |..w.. ..8.^l...c|
+000001e0  e7 38 1c 31 62 12 0e e7  13 4b b9 ec c0 8d 84 aa  |.8.1b....K......|
+000001f0  1c 18 6e 4d 90 13 dc 01  a2 87 0e d8 b2 36 c1 d6  |..nM.........6..|
+00000200  03 f6 a0 4c 83 de 88 b2  4e 97 be 4f 75 7b fb 42  |...L....N..Ou{.B|
+00000210  84 e2 94 28 68 b0 37 4f  bc 86 5d d4 74 84 15 53  |...(h.7O..].t..S|
+00000220  a8 c8 47 86 0e fc d0 54  59 81 cb a6 c1 37 3b 1a  |..G....TY....7;.|
+00000230  2d a3 d7 2c 8c 23 f6 1f  0e 31 98 09 57 00 45 dc  |-..,.#...1..W.E.|
+00000240  35 e7 8f a7 24 74 e6 b0  3a 40 8c be e3 ff 0b 08  |5...$t..:@......|
+00000250  3d c8 3d 84 ce 2c 1c 05  81 0c b5 83 8a de 2f 9f  |=.=..,......../.|
+00000260  6a 83 88 a0 c2 9d 26 2d  0f 9e 40 33 48 b7 59 c3  |j.....&-..@3H.Y.|
+00000270  98 9c aa 3c 95 4b 86 35  02 91 dd 62 e0 2c 67 b6  |...<.K.5...b.,g.|
+00000280  65 33 09 dc b4 17 03 03  00 99 94 6d 12 c3 3d 58  |e3.........m..=X|
+00000290  0d 5d 8b 94 ba 26 20 97  12 a8 65 02 d1 d2 8c 8d  |.]...& ...e.....|
+000002a0  82 cb eb fa b3 e8 72 8b  f2 4f 17 c8 52 53 9e 83  |......r..O..RS..|
+000002b0  54 dc 84 37 be 3b 79 81  59 61 6f 67 ff cb c3 ae  |T..7.;y.Yaog....|
+000002c0  a1 9f d9 b0 a9 9d d0 8a  55 1f 58 48 a8 c6 2e c9  |........U.XH....|
+000002d0  8e 79 6d 16 1b 68 db 45  40 84 a5 6a b1 fe a6 76  |.ym..h.E@..j...v|
+000002e0  de 22 c9 a9 9a 95 a2 1d  96 86 9e 79 8f ed 0f fb  |.".........y....|
+000002f0  63 10 a0 d5 38 d5 78 e2  a6 6d 97 09 6e 17 1a 85  |c...8.x..m..n...|
+00000300  2b 51 a4 a8 59 a1 06 6b  89 37 1e 5a 99 a3 66 89  |+Q..Y..k.7.Z..f.|
+00000310  50 bc f7 49 e7 a9 82 da  ec cf eb 33 76 af 65 76  |P..I.......3v.ev|
+00000320  a5 84 93 17 03 03 00 35  5d 1d 31 e0 3b 1f 3f d6  |.......5].1.;.?.|
+00000330  6c f9 55 6e 8f 86 1f 4f  85 a1 b5 3f c3 1e 3e ff  |l.Un...O...?..>.|
+00000340  29 9c a7 1d 06 e9 de d2  98 d5 fb 37 2e e6 2e ba  |)..........7....|
+00000350  b3 77 d0 d0 e6 ef 84 4e  05 14 47 2c 5e 17 03 03  |.w.....N..G,^...|
+00000360  00 17 80 d7 97 10 67 71  db aa 0f 6f 76 86 20 37  |......gq...ov. 7|
+00000370  0e a7 f1 53 71 c1 fe f7  09 17 03 03 00 13 79 a8  |...Sq.........y.|
+00000380  bd 36 37 a9 5b b0 57 de  c7 ea 2e 71 25 62 81 ea  |.67.[.W....q%b..|
+00000390  b5                                                |.|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ECDSA b/src/crypto/tls/testdata/Client-TLSv13-ECDSA
index dac9ef70c8..b1d1e6aac9 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ECDSA
+++ b/src/crypto/tls/testdata/Client-TLSv13-ECDSA
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,80 +7,81 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 e3 21 e8 24 fb  |....z...v...!.$.|
-00000010  e8 fe 46 e2 54 a7 db 98  ae a4 b2 fc f8 17 99 b4  |..F.T...........|
-00000020  ed 6a aa 9c f9 ce e2 0f  f8 88 05 20 00 00 00 00  |.j......... ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 be 96 55 22 ae  |....z...v....U".|
+00000010  2e be 57 a1 0a 48 2e e3  ac 8e a7 d0 d5 a6 47 a9  |..W..H........G.|
+00000020  c4 11 bb e1 37 73 19 6b  de 6b 2e 20 00 00 00 00  |....7s.k.k. ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 a9  |..+.....3.$... .|
-00000060  5a 5c e9 b1 71 e8 a8 64  97 65 02 6b 3d 25 6f 6f  |Z\..q..d.e.k=%oo|
-00000070  9a 47 cb 4a 81 ac 89 23  22 c1 f4 3d db 77 1e 14  |.G.J...#"..=.w..|
-00000080  03 03 00 01 01 17 03 03  00 17 12 15 75 15 9f 10  |............u...|
-00000090  90 07 34 9c eb 05 d0 a1  4b 36 5b 4c 7b 26 2a 00  |..4.....K6[L{&*.|
-000000a0  29 17 03 03 02 22 85 a0  67 d7 72 57 83 19 79 12  |)...."..g.rW..y.|
-000000b0  b7 bd 37 ed ab 49 5d 15  49 2b 4f a1 b2 25 08 22  |..7..I].I+O..%."|
-000000c0  88 83 70 07 bc 8f 69 45  1b 21 36 99 f4 99 40 f8  |..p...iE.!6...@.|
-000000d0  0d 30 13 87 70 68 f6 9d  ce c7 9e 25 2c 1e 7a b5  |.0..ph.....%,.z.|
-000000e0  52 ed f8 0f f7 d9 e5 15  fc a3 47 83 0d 18 c4 de  |R.........G.....|
-000000f0  a1 a6 24 35 aa 56 d1 8b  95 07 5f 0f ba 1f 96 c3  |..$5.V...._.....|
-00000100  5b 36 cc d2 15 e6 b4 88  8f e3 7f 79 c2 24 d5 f3  |[6.........y.$..|
-00000110  a7 35 69 4e d2 2a f7 5c  08 8a c0 26 dd b9 77 5b  |.5iN.*.\...&..w[|
-00000120  96 1b 5f 03 89 07 a0 6a  b1 14 1d 02 46 08 eb 80  |.._....j....F...|
-00000130  d5 4c dc 69 63 8f 14 a1  e5 02 95 05 8a 8b c8 68  |.L.ic..........h|
-00000140  c3 d8 75 56 47 94 32 ba  67 71 ed 4b b4 62 ba 6a  |..uVG.2.gq.K.b.j|
-00000150  31 20 a7 d6 f8 8c a0 e9  e8 d2 1a 6b 85 6b b7 ee  |1 .........k.k..|
-00000160  78 e1 2e 4c 14 f0 b3 3e  b8 dc 7d af f0 9d 29 f3  |x..L...>..}...).|
-00000170  54 1d 9d dc 9e a3 9f 29  5b 33 1d f7 00 98 85 bd  |T......)[3......|
-00000180  42 39 85 75 cf fa dc f3  7e 80 14 4e a5 90 80 b6  |B9.u....~..N....|
-00000190  e3 37 d3 27 c6 7b b9 ee  32 61 a5 72 e5 2f a6 ab  |.7.'.{..2a.r./..|
-000001a0  cb 8e ac 53 4b 86 24 92  4b 77 d6 8d aa b4 37 d5  |...SK.$.Kw....7.|
-000001b0  2b b2 2f 07 23 37 4a d9  1f cc 6c 72 c6 21 5b 38  |+./.#7J...lr.![8|
-000001c0  a3 33 5c 86 50 69 34 8f  5a b8 cc 5e 82 7d 5b b2  |.3\.Pi4.Z..^.}[.|
-000001d0  5b f5 58 7f 2c 61 08 4b  3d 8b 67 09 19 01 d2 4f  |[.X.,a.K=.g....O|
-000001e0  06 62 17 4e d4 bf 88 89  bb c4 6e 14 2b 3a 50 c9  |.b.N......n.+:P.|
-000001f0  56 8a c1 0a 45 e6 67 32  f3 96 37 4b ba c2 2a 2b  |V...E.g2..7K..*+|
-00000200  84 e1 ff bb e0 ea 68 9b  98 fc 78 26 25 f6 50 25  |......h...x&%.P%|
-00000210  52 57 83 94 39 b9 a7 8d  38 43 70 a8 b7 61 a6 cf  |RW..9...8Cp..a..|
-00000220  09 77 db 3d 64 94 63 73  5b a1 6d f4 06 c1 b3 fb  |.w.=d.cs[.m.....|
-00000230  c6 9a 0b ea 9f 8e 6d 58  53 0e 13 e0 a6 21 69 7a  |......mXS....!iz|
-00000240  d3 57 32 d4 c6 32 ef 02  8e 54 1d 72 2d d6 a7 dc  |.W2..2...T.r-...|
-00000250  59 54 be 69 3f 5c 53 23  a9 f7 3e a9 e6 e7 e0 98  |YT.i?\S#..>.....|
-00000260  65 f6 74 f4 49 1c 77 0f  92 34 87 81 29 85 d1 e0  |e.t.I.w..4..)...|
-00000270  1e 4d b4 eb c2 44 43 a7  10 51 7c 5e 8e a4 b6 37  |.M...DC..Q|^...7|
-00000280  78 e8 35 02 07 3d 60 a5  01 75 01 25 f3 ff 32 ff  |x.5..=`..u.%..2.|
-00000290  34 ab a4 c3 4c ad 21 b8  91 0a d6 54 4b 7d cf c5  |4...L.!....TK}..|
-000002a0  ec 0f e5 4a 4d 75 4c ec  fc 37 2b 26 5a 73 93 70  |...JMuL..7+&Zs.p|
-000002b0  88 c7 9c cf 32 f9 ee a7  27 6e 1d 9e 36 a2 31 9e  |....2...'n..6.1.|
-000002c0  cd 0e c2 89 ef 2b 40 1a  17 03 03 00 a4 ad 19 05  |.....+@.........|
-000002d0  e6 40 5e b1 ec 69 6b 47  ef 5d d3 ee a6 94 51 85  |.@^..ikG.]....Q.|
-000002e0  d8 28 d9 df 8b d0 df 23  7e bd 98 6c 33 26 45 fa  |.(.....#~..l3&E.|
-000002f0  60 71 8b f5 71 5c 22 4e  b3 a7 01 fe 17 39 89 67  |`q..q\"N.....9.g|
-00000300  0b 70 ff 52 b9 10 9c e9  02 c0 1c 56 9d c8 45 51  |.p.R.......V..EQ|
-00000310  5a dd 86 79 6d a7 7d eb  16 c2 1a 5f 6a 3b 93 42  |Z..ym.}...._j;.B|
-00000320  13 f3 3d 8a 39 21 5f a9  7f cf 4b 1e 22 f1 a3 f8  |..=.9!_...K."...|
-00000330  5c 35 41 2a e2 91 72 4f  59 61 1c 15 be 27 6a bd  |\5A*..rOYa...'j.|
-00000340  b7 16 1f 63 97 51 d6 96  dd 81 f9 e7 fd 97 33 6e  |...c.Q........3n|
-00000350  da 5a 61 77 57 6e 3b 65  24 db b3 3a 18 7b dc f4  |.ZawWn;e$..:.{..|
-00000360  7c ff ab 43 7f 1b ae ae  b8 73 71 9e be 91 d6 56  ||..C.....sq....V|
-00000370  13 17 03 03 00 35 39 61  a3 b7 e5 1d 3d 87 92 84  |.....59a....=...|
-00000380  11 39 7d f4 ce 29 b9 4b  fd 3c 0c 5a b6 3a fa e2  |.9}..).K.<.Z.:..|
-00000390  a8 5b e6 d2 e5 7e e3 a6  33 59 e4 a8 59 95 5d b9  |.[...~..3Y..Y.].|
-000003a0  31 6d 51 90 22 be c0 3f  6e 43 f2                 |1mQ."..?nC.|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 0f  |..+.....3.$... .|
+00000060  ae 71 f3 56 39 91 5f 75  18 40 73 b7 82 b9 67 05  |.q.V9._u.@s...g.|
+00000070  09 d6 be 04 1f 66 b4 c4  18 1a 19 1d e7 bb 15 14  |.....f..........|
+00000080  03 03 00 01 01 17 03 03  00 17 7d 5b c9 52 40 79  |..........}[.R@y|
+00000090  4b 2b 2e b9 cb 7c 16 1b  2e df 3c e9 69 24 ea 47  |K+...|....<.i$.G|
+000000a0  7f 17 03 03 02 22 a0 a0  bf fa 2c 0c 99 08 ad 4d  |....."....,....M|
+000000b0  03 05 54 93 67 8f 95 31  61 16 cb ef 2f 30 7f b8  |..T.g..1a.../0..|
+000000c0  f8 97 c9 7a a8 71 e8 f2  ab 73 51 c4 1c a5 f4 6c  |...z.q...sQ....l|
+000000d0  54 6e f0 42 ae 58 25 84  de 9b e1 08 2a df ba 1e  |Tn.B.X%.....*...|
+000000e0  e5 c7 8e 57 b8 a6 e4 6a  c8 02 0d 77 e7 79 f7 a2  |...W...j...w.y..|
+000000f0  3a 18 f2 c5 f5 74 71 83  26 49 a6 2f 5c ac a4 a7  |:....tq.&I./\...|
+00000100  0d f3 65 5a a9 ed a0 f5  f1 ce c9 80 bc 75 f2 e7  |..eZ.........u..|
+00000110  68 11 b5 fb aa a8 e0 85  b9 37 b6 04 f6 f3 6d 8a  |h........7....m.|
+00000120  ed 5c 0e 9a 25 52 f2 84  ca 2c 19 54 c1 0c 5e 24  |.\..%R...,.T..^$|
+00000130  e2 32 3e 99 18 84 17 84  8c 03 55 06 4f a0 ff 16  |.2>.......U.O...|
+00000140  89 9e 1e d4 75 1e 3f a5  4d 0b 24 41 bc ca 6e 48  |....u.?.M.$A..nH|
+00000150  77 53 e3 12 ee 00 69 11  19 c8 9b 43 b0 49 d3 a7  |wS....i....C.I..|
+00000160  48 69 08 d0 14 fa d1 2b  d5 66 a3 40 b4 51 4b e3  |Hi.....+.f.@.QK.|
+00000170  f0 d3 c2 97 de 19 e8 02  66 9a ba 9f 59 7a 77 a4  |........f...Yzw.|
+00000180  d1 29 71 5f 60 04 f6 f2  f5 d6 ce df 6a 19 6d 6a  |.)q_`.......j.mj|
+00000190  ae a5 df 25 d3 fb da 4c  54 d1 1e d8 68 59 d0 a8  |...%...LT...hY..|
+000001a0  3d 6a ce 84 57 0e 01 8f  d6 f1 7f cd 9f 4c 26 ae  |=j..W........L&.|
+000001b0  88 b5 af 31 b4 15 c0 bc  70 86 d4 7e 3f 7c 69 39  |...1....p..~?|i9|
+000001c0  ff db 74 5b 18 54 dc 55  ec 7f 60 c8 38 03 1f e8  |..t[.T.U..`.8...|
+000001d0  a0 9f 3b 79 12 ca c4 3f  41 d3 3d 80 88 a2 7e fa  |..;y...?A.=...~.|
+000001e0  a1 5c f0 df 1b 61 73 e0  2a d3 d8 88 0e 22 20 09  |.\...as.*...." .|
+000001f0  62 42 3a 09 77 e5 39 c1  f2 a1 e5 29 f8 ab 4b de  |bB:.w.9....)..K.|
+00000200  0c 3c 39 e8 13 34 73 d0  e3 25 39 bf f7 23 c4 1b  |.<9..4s..%9..#..|
+00000210  06 c0 c4 16 80 14 15 a0  09 ac f0 fb 77 40 30 14  |............w@0.|
+00000220  07 5d 1c 34 58 90 27 53  3f da c5 2a 7d 0f b7 4c  |.].4X.'S?..*}..L|
+00000230  15 09 ea cf f1 51 6c 84  3a f1 f7 d0 66 b8 fb 0c  |.....Ql.:...f...|
+00000240  82 1e 86 2d 23 84 b8 d2  df d7 db a6 f2 7c da d8  |...-#........|..|
+00000250  e3 f8 a9 2c 0a fb 65 e8  2a 16 f6 c8 b7 dc b5 03  |...,..e.*.......|
+00000260  fd bc 76 67 c5 0a 9e 8a  c6 89 04 b4 e1 5b 23 89  |..vg.........[#.|
+00000270  ca 03 73 4c e2 49 3e a8  ce c9 4c 0a 98 8c 78 b9  |..sL.I>...L...x.|
+00000280  12 d4 32 94 84 66 5a d3  07 78 df 74 00 d7 ca df  |..2..fZ..x.t....|
+00000290  40 e6 b6 37 08 bc a8 fa  9a 28 e7 77 e2 78 39 d8  |@..7.....(.w.x9.|
+000002a0  e3 71 e5 2b f6 dc 9b 20  3e 38 77 80 f7 c9 e2 81  |.q.+... >8w.....|
+000002b0  07 4c 06 43 b7 b1 ff 1d  f9 b4 24 ca ad db d3 f5  |.L.C......$.....|
+000002c0  3b 05 d8 0f 1e 6d 1a 6d  17 03 03 00 a4 fd 5d 1f  |;....m.m......].|
+000002d0  1c 88 af a8 df 19 44 bd  80 81 78 fd 2d 84 ff a4  |......D...x.-...|
+000002e0  51 45 9a 98 7c 45 cb 84  2c fb 54 d1 33 06 67 e4  |QE..|E..,.T.3.g.|
+000002f0  95 f2 c5 5e 1b 49 41 b3  73 6c 5e 4d 2c 2d 77 1f  |...^.IA.sl^M,-w.|
+00000300  59 cb 39 e9 87 3a 10 83  72 ab b3 ce f8 28 94 8f  |Y.9..:..r....(..|
+00000310  47 8f 3d 2e 65 0a 42 b0  a5 13 61 bb 3b c7 a9 52  |G.=.e.B...a.;..R|
+00000320  cd 26 f6 ab c1 d3 3a a4  51 a6 7a 74 3b 76 19 ee  |.&....:.Q.zt;v..|
+00000330  71 09 b6 b8 e6 3d 3e a3  df db a9 69 52 fe 66 3a  |q....=>....iR.f:|
+00000340  dc 19 f6 56 ea 81 10 ab  43 2e e2 17 20 08 92 62  |...V....C... ..b|
+00000350  62 98 73 cb 16 9a 13 7d  b3 b4 6a fd 18 28 25 05  |b.s....}..j..(%.|
+00000360  b2 3f e7 14 94 cf 9d 67  74 11 83 21 da d8 36 da  |.?.....gt..!..6.|
+00000370  8e 17 03 03 00 35 89 67  70 a6 1c 3b 7c 59 59 23  |.....5.gp..;|YY#|
+00000380  92 33 ee 35 11 5d 8c fb  bd f0 21 a4 8d 09 e3 e7  |.3.5.]....!.....|
+00000390  dd 96 8c ad cc 57 97 6a  4d 33 49 cc f6 c6 a9 4d  |.....W.jM3I....M|
+000003a0  9b 3f 22 88 f5 06 b3 c2  a3 34 46                 |.?"......4F|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 50 4f ce ae a5  |..........5PO...|
-00000010  f7 b0 7e 2b 91 86 72 da  90 65 fd 1b a5 46 c6 98  |..~+..r..e...F..|
-00000020  47 90 5a f2 b8 5a 1f 18  44 19 bd ca dd 2a 15 e7  |G.Z..Z..D....*..|
-00000030  53 f5 17 e8 7d 9b f1 9a  63 ac b0 b0 df c3 0e 4c  |S...}...c......L|
-00000040  17 03 03 00 17 8b bd fb  bc fd f7 af 53 9b 8b 1a  |............S...|
-00000050  a3 e5 f6 e9 87 bd 4a 8a  1b 0e c9 d9 17 03 03 00  |......J.........|
-00000060  13 8e c6 d3 6e 04 8f 3b  d4 76 a4 c7 c8 63 a8 a8  |....n..;.v...c..|
-00000070  9e ba e7 fd                                       |....|
+00000000  14 03 03 00 01 01 17 03  03 00 35 f4 b7 bd 05 e3  |..........5.....|
+00000010  04 c1 da 80 2f 16 6c 14  fe 7e bd 74 65 ab 76 e8  |..../.l..~.te.v.|
+00000020  7a 62 dc 89 11 10 ee 58  93 fc 30 0e 30 fa b6 a0  |zb.....X..0.0...|
+00000030  48 11 5d 78 9a fc 6b 44  1c 67 52 21 b4 b8 69 18  |H.]x..kD.gR!..i.|
+00000040  17 03 03 00 17 12 f2 ed  80 d2 91 8a bc 19 25 1d  |..............%.|
+00000050  54 d6 56 04 b4 4d 1a 01  9f ea 7f 0c 17 03 03 00  |T.V..M..........|
+00000060  13 aa bb f9 4e 8f 2e 49  9c 07 65 31 8a 14 05 d8  |....N..I..e1....|
+00000070  d5 3a 83 23                                       |.:.#|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-Ed25519 b/src/crypto/tls/testdata/Client-TLSv13-Ed25519
index d28474011b..e509e8adf4 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-Ed25519
+++ b/src/crypto/tls/testdata/Client-TLSv13-Ed25519
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,62 +7,63 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 6f b6 d3 79 9b  |....z...v..o..y.|
-00000010  00 17 a8 46 3f e4 bc fc  08 1e 56 6c d8 63 86 f3  |...F?.....Vl.c..|
-00000020  83 1b d8 26 6d 86 d6 4c  f3 4f e1 20 00 00 00 00  |...&m..L.O. ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 41 71 01 fb 3b  |....z...v..Aq..;|
+00000010  86 8b 75 5d 8d 98 1d 98  e7 19 0c 87 87 d0 a6 b5  |..u]............|
+00000020  5f 51 70 32 37 bc 58 b6  93 fb b1 20 00 00 00 00  |_Qp27.X.... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 5b  |..+.....3.$... [|
-00000060  8f 4f 5a a9 95 6b 04 07  31 d3 ed 91 8b 25 b4 7b  |.OZ..k..1....%.{|
-00000070  5c a1 0a a6 26 09 92 9b  b0 72 26 f9 0d 09 60 14  |\...&....r&...`.|
-00000080  03 03 00 01 01 17 03 03  00 17 a8 99 d3 76 1f 12  |.............v..|
-00000090  19 18 15 8e 4c 59 43 92  11 4a aa 50 98 7e 4c d9  |....LYC..J.P.~L.|
-000000a0  63 17 03 03 01 50 66 f5  d6 ce 35 0f 10 e5 ab 34  |c....Pf...5....4|
-000000b0  78 17 c6 b6 60 40 eb 53  34 9f ce 02 c4 36 51 18  |x...`@.S4....6Q.|
-000000c0  c2 b3 fb f3 98 92 d0 f2  b7 be 28 f5 c7 2d fa 1f  |..........(..-..|
-000000d0  9b 8b aa e5 45 54 6b 0e  ed 6b 44 cb d4 4d 62 b2  |....ETk..kD..Mb.|
-000000e0  30 c9 df ac cf a3 7e 43  58 1e bf 6e 5b 69 4e 48  |0.....~CX..n[iNH|
-000000f0  1c 39 49 eb 8a 0c 22 f3  70 4a 80 50 39 d6 68 29  |.9I...".pJ.P9.h)|
-00000100  d0 6d 08 20 26 39 6d 37  5a 9f 79 e9 16 e3 7e 94  |.m. &9m7Z.y...~.|
-00000110  8f 5f 9b 97 2d e1 b1 48  e4 a3 36 63 40 5a 80 93  |._..-..H..6c@Z..|
-00000120  06 27 3b 93 d9 ed 2d b1  3e 74 ed bc 38 a1 cb 17  |.';...-.>t..8...|
-00000130  06 4a 9b c1 c1 d7 7a 1c  ca ff 4d ee 91 6d d0 3c  |.J....z...M..m.<|
-00000140  c2 4b cc 33 c6 7c 76 8e  db a2 e0 fe 15 e2 ec db  |.K.3.|v.........|
-00000150  1f 5d 05 c8 5e 0e 7f 2c  7a 95 08 34 68 a2 2c 7c  |.]..^..,z..4h.,||
-00000160  04 16 92 7a c8 ec 52 2d  1a c4 7a ea 12 cd 0f b9  |...z..R-..z.....|
-00000170  7c 00 51 55 02 5b 02 7d  ec 89 af f5 6d 76 89 0e  ||.QU.[.}....mv..|
-00000180  67 42 f0 e4 67 4d 3f 70  ff 2c 64 81 1c 4a 92 1f  |gB..gM?p.,d..J..|
-00000190  26 8b a4 4f 15 18 b5 11  4a 61 df 45 53 74 fd 8d  |&..O....Ja.ESt..|
-000001a0  ff 22 32 91 af c7 7f a4  7b 62 c3 3b 30 51 b6 34  |."2.....{b.;0Q.4|
-000001b0  b6 01 21 f9 86 74 be 62  27 1a 41 1f f0 0d 8b 5c  |..!..t.b'.A....\|
-000001c0  4b 82 ea 76 23 9c 36 af  25 1f f6 2d 5f 9c 28 bd  |K..v#.6.%..-_.(.|
-000001d0  b6 d5 1e 26 8b c1 dc ac  ed 6d 10 ff 13 ed fc 08  |...&.....m......|
-000001e0  08 0a 74 1c b1 5b f8 45  e4 83 44 f2 be ce 8d ac  |..t..[.E..D.....|
-000001f0  ee ae e6 21 da c7 17 03  03 00 59 d9 b3 95 0a f7  |...!......Y.....|
-00000200  1a 1a 54 fa ab 09 38 6d  6d 53 0a ef 11 73 bc a2  |..T...8mmS...s..|
-00000210  20 03 31 48 e2 0a d1 af  56 6c ca dd 88 ba 72 3a  | .1H....Vl....r:|
-00000220  c1 e0 c5 60 44 74 d6 c9  18 23 96 2c e7 88 c8 3e  |...`Dt...#.,...>|
-00000230  02 73 c0 38 d4 bd 85 a4  bb 78 a0 ba d3 fd f1 c4  |.s.8.....x......|
-00000240  27 08 05 fb 2c 26 20 b7  1a 41 87 a6 b7 97 19 26  |'...,& ..A.....&|
-00000250  50 ed 9a e4 17 03 03 00  35 68 36 c7 78 c3 5e ff  |P.......5h6.x.^.|
-00000260  b3 92 a7 25 31 2a a2 fa  24 d9 da 69 16 03 8b db  |...%1*..$..i....|
-00000270  fe b2 3f 63 88 49 f1 14  63 7a 58 a9 6f c5 64 92  |..?c.I..czX.o.d.|
-00000280  21 84 82 d8 49 98 fb f3  f1 fd 52 83 32 97        |!...I.....R.2.|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 17  |..+.....3.$... .|
+00000060  4e 27 d2 df c9 6d 88 15  a2 02 f2 fc 4d 87 65 92  |N'...m......M.e.|
+00000070  67 92 90 6c 8b e0 fb 27  2b d6 e8 e1 0e b2 7b 14  |g..l...'+.....{.|
+00000080  03 03 00 01 01 17 03 03  00 17 ef ca 93 ae 3b 4b  |..............;K|
+00000090  ef ba c7 f1 44 89 61 b5  6c 05 c5 d9 59 4d 50 ab  |....D.a.l...YMP.|
+000000a0  ff 17 03 03 01 50 71 7e  a6 0b 61 c5 f1 b0 9b ab  |.....Pq~..a.....|
+000000b0  3e 15 7a 0c ac 01 d7 cb  3e 04 85 e1 7a 59 95 92  |>.z.....>...zY..|
+000000c0  cb 91 5f 91 a4 e2 1b 6a  d7 72 d5 ee 70 ae 51 ed  |.._....j.r..p.Q.|
+000000d0  c7 78 ea 69 e5 a6 0b cc  72 43 6f 2e da c3 74 4c  |.x.i....rCo...tL|
+000000e0  00 53 79 38 3b 10 7e 98  25 32 ad 7f e4 0b 9b ad  |.Sy8;.~.%2......|
+000000f0  4a 5d f4 d9 a1 fe d6 ce  32 ff 2d 2e 26 49 78 3f  |J]......2.-.&Ix?|
+00000100  4e 37 e9 c7 d3 af b7 4d  75 f2 71 f2 20 b8 28 64  |N7.....Mu.q. .(d|
+00000110  7c 0c 7a 3c f0 35 4e c6  ba 2d fc 76 53 a5 76 f9  ||.z<.5N..-.vS.v.|
+00000120  3e e3 4e 41 b9 52 e1 dc  62 9f 13 bf b7 ef c2 c1  |>.NA.R..b.......|
+00000130  ef 9c 04 4d 4c d0 20 e8  7e 62 bc 23 8a c0 02 62  |...ML. .~b.#...b|
+00000140  1d 8e c1 6f e0 23 70 0e  08 5c a0 47 92 40 5c 31  |...o.#p..\.G.@\1|
+00000150  d9 03 5b a5 9a dd 2f b9  4f 8a 4a 8d d9 c3 63 cb  |..[.../.O.J...c.|
+00000160  61 16 3c be 9e dc 9d 11  bf c8 b9 5b 2d 69 5d 94  |a.<........[-i].|
+00000170  ef 6b 87 2d 59 42 05 51  88 9d 5a 8d bc ae 7c 65  |.k.-YB.Q..Z...|e|
+00000180  e2 a1 b5 eb c6 23 30 3c  ab 52 f1 a3 90 77 1c a2  |.....#0<.R...w..|
+00000190  65 e0 ef 9c c7 1f b3 ad  7a 63 01 d9 b6 5c de c5  |e.......zc...\..|
+000001a0  3e ec b0 0c 1c 34 ea e1  8e d9 68 67 d8 1b 0c 94  |>....4....hg....|
+000001b0  4d 0a e1 e7 c7 4f 6e 03  c2 0f d6 4e 87 b9 e4 5c  |M....On....N...\|
+000001c0  d6 d7 4a f0 90 fb 8c 56  ce 20 d3 09 db a2 3a 8f  |..J....V. ....:.|
+000001d0  56 bc 1f 5d d8 0f ab 05  9c 2e 96 7e 09 bf 0f 45  |V..].......~...E|
+000001e0  81 83 81 63 d5 0e ef fb  bd db 1d c8 17 4a ef d1  |...c.........J..|
+000001f0  ce 9d 76 c5 1c 3a 17 03  03 00 59 f8 6e 9b 48 45  |..v..:....Y.n.HE|
+00000200  96 86 f0 87 4f 95 75 72  90 16 ee 40 e6 a5 da d6  |....O.ur...@....|
+00000210  9a 93 5a f2 e1 14 c7 ef  99 5e 55 80 9c 2b a5 f0  |..Z......^U..+..|
+00000220  24 d0 0c b3 5c cd 7e 9f  a7 8d 80 6d 24 0f 55 44  |$...\.~....m$.UD|
+00000230  25 23 04 30 0a b8 4b 87  81 7d f6 46 af a0 e9 6c  |%#.0..K..}.F...l|
+00000240  ce cc 3b 8f 93 75 2b d3  65 84 0d fc 11 b3 49 93  |..;..u+.e.....I.|
+00000250  21 8c 12 28 17 03 03 00  35 11 5a 66 4d 6e f2 a1  |!..(....5.ZfMn..|
+00000260  d5 c7 e0 0d fb c0 23 72  61 40 56 c9 2b cf 19 91  |......#ra@V.+...|
+00000270  1e 9a 0b 20 65 dd f2 ec  54 f8 6a 6f a0 7f bf d2  |... e...T.jo....|
+00000280  92 e0 41 ae 8c a0 4e 33  be a0 f8 8e b3 c7        |..A...N3......|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 07 7b a2 7a 4f  |..........5.{.zO|
-00000010  40 e9 a2 94 9f b7 2d 91  87 1e 37 b0 ca b7 ea 91  |@.....-...7.....|
-00000020  53 f1 bf 7d 56 6a 0c 6a  9d 07 ac 93 9c db ca ac  |S..}Vj.j........|
-00000030  43 7b eb 56 9d 6c 79 f2  72 f8 0b 8d 15 08 84 d5  |C{.V.ly.r.......|
-00000040  17 03 03 00 17 07 b3 7d  a9 56 c4 76 e5 12 97 29  |.......}.V.v...)|
-00000050  b7 99 e6 3e 08 79 2d fb  1a 5b eb 7a 17 03 03 00  |...>.y-..[.z....|
-00000060  13 66 b7 65 57 0d 54 7b  6a 34 98 a1 4e 29 d5 92  |.f.eW.T{j4..N)..|
-00000070  1e b6 52 bc                                       |..R.|
+00000000  14 03 03 00 01 01 17 03  03 00 35 a6 8b c2 c6 31  |..........5....1|
+00000010  c1 73 78 0f f6 09 bb 09  d5 bc da 6b e6 21 e7 3e  |.sx........k.!.>|
+00000020  19 ba 60 74 d4 32 71 37  a0 13 d8 ae e0 85 f7 71  |..`t.2q7.......q|
+00000030  d0 4e 2f 29 81 bb 8b 86  24 67 5b c9 b7 6e 6a 11  |.N/)....$g[..nj.|
+00000040  17 03 03 00 17 43 59 8a  71 7c f9 e8 b9 36 56 bc  |.....CY.q|...6V.|
+00000050  07 67 34 1c f9 47 b0 fa  3a a0 15 9a 17 03 03 00  |.g4..G..:.......|
+00000060  13 dc 3e d0 92 97 41 13  06 65 b2 af e5 fa 16 d5  |..>...A..e......|
+00000070  9b 82 57 91                                       |..W.|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-ExportKeyingMaterial b/src/crypto/tls/testdata/Client-TLSv13-ExportKeyingMaterial
index a0ede61c70..13ac4fcf8c 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-ExportKeyingMaterial
+++ b/src/crypto/tls/testdata/Client-TLSv13-ExportKeyingMaterial
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,84 +7,85 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 d6 7f ef 2d f6  |....z...v.....-.|
-00000010  82 d9 be 6d 33 80 73 c0  d4 d8 63 e9 95 a6 5b 1f  |...m3.s...c...[.|
-00000020  ce c0 ec 13 07 f4 68 7d  cc 79 18 20 00 00 00 00  |......h}.y. ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 5a a0 51 7e b3  |....z...v..Z.Q~.|
+00000010  75 e4 ba 57 52 a0 56 68  55 2b 40 16 e3 d4 b1 4f  |u..WR.VhU+@....O|
+00000020  5e 2c a0 ab 31 76 e8 c5  ab ca 60 20 00 00 00 00  |^,..1v....` ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 00  |..+.....3.$... .|
-00000060  e9 40 7a 65 78 98 47 43  aa e1 63 fd 6b c4 21 1d  |.@zex.GC..c.k.!.|
-00000070  58 45 5f 64 a0 18 55 a0  c3 14 7d 4e 12 93 7c 14  |XE_d..U...}N..|.|
-00000080  03 03 00 01 01 17 03 03  00 17 4c 01 0b f7 e7 1b  |..........L.....|
-00000090  a9 47 84 10 3b 50 85 6e  3d 8e 52 bc 99 bf d4 35  |.G..;P.n=.R....5|
-000000a0  45 17 03 03 02 6d 8c b3  22 04 de 8b 09 e5 e7 9f  |E....m..".......|
-000000b0  d5 1f fb 8a 57 ad a7 93  4c 5f 29 46 df c3 e5 86  |....W...L_)F....|
-000000c0  66 f1 c7 6b 14 79 cf 9d  cc e1 f5 3f 31 2c dc ff  |f..k.y.....?1,..|
-000000d0  77 99 14 9e 56 12 4e a4  cb 56 5c d6 c0 5b 57 dc  |w...V.N..V\..[W.|
-000000e0  22 72 12 2d d6 a0 8a c7  90 e6 41 66 78 1a d7 a6  |"r.-......Afx...|
-000000f0  87 db f1 e3 9b 86 8c cf  94 22 cf 81 99 20 bc 19  |........."... ..|
-00000100  50 f9 fe 6c ab ea d4 a2  ee f8 17 1d ae 37 86 2a  |P..l.........7.*|
-00000110  f9 83 3c 59 d0 aa 63 22  18 d5 12 40 be f7 02 f1  |..<Y..c"...@....|
-00000120  9a bf 07 39 23 73 23 a1  66 70 b7 be 9a 24 de 30  |...9#s#.fp...$.0|
-00000130  2f 62 6e f8 d5 ee 69 a7  87 3c 73 10 4c 7c 97 42  |/bn...i..<s.L|.B|
-00000140  62 b9 d5 74 40 f0 d7 b3  74 42 73 d7 41 bc 35 43  |b..t@...tBs.A.5C|
-00000150  87 2e c5 1b e9 15 e8 5e  18 b9 6b 57 2a ee 59 7a  |.......^..kW*.Yz|
-00000160  1c a6 2b cb b4 db e8 bb  99 87 74 4a ee 57 3a 87  |..+.......tJ.W:.|
-00000170  3c 2d b9 76 41 4a 7a a5  6a fa 92 e9 80 24 08 dc  |<-.vAJz.j....$..|
-00000180  18 44 4b 59 7c 81 99 29  f2 c4 55 b6 58 71 0d 68  |.DKY|..)..U.Xq.h|
-00000190  6b 06 bd 13 2c a0 04 15  2e 49 cc 99 7f a6 b4 5d  |k...,....I.....]|
-000001a0  d3 49 a5 21 15 d7 66 2d  a2 e8 cd a7 7e 46 c4 ac  |.I.!..f-....~F..|
-000001b0  89 ae cb 58 73 42 9f dc  c3 c9 5a 13 2f 6f f7 ab  |...XsB....Z./o..|
-000001c0  04 4b 9f f1 6c c4 ac 0f  f5 eb 8d 7a ef cf 01 00  |.K..l......z....|
-000001d0  8a 02 ec 16 09 c1 e9 27  81 32 70 b1 24 d4 db 4e  |.......'.2p.$..N|
-000001e0  9e 22 65 21 a7 8f 19 d5  c6 57 78 8a fa a6 41 87  |."e!.....Wx...A.|
-000001f0  52 eb 5d ef f8 7e 3b 34  a5 31 ff 33 33 fd 85 03  |R.]..~;4.1.33...|
-00000200  e4 94 56 ef 11 c0 fe 84  f6 87 94 26 de 7c bd d1  |..V........&.|..|
-00000210  1b ea 15 34 62 e5 da bd  e6 c4 b0 74 b5 27 ad 21  |...4b......t.'.!|
-00000220  39 16 c8 be e8 41 50 7b  de fb 71 10 4c b1 f4 5a  |9....AP{..q.L..Z|
-00000230  bf ea fd 9b 86 a5 c6 e7  2f c2 13 e4 d2 cd 32 7a  |......../.....2z|
-00000240  6b ad ab 43 12 3b 45 b9  5c e4 cf 2c f9 f3 44 2c  |k..C.;E.\..,..D,|
-00000250  11 31 ce c5 65 dd ea e6  52 bd 8a 35 d0 31 d4 4f  |.1..e...R..5.1.O|
-00000260  01 24 54 e4 d2 bf 6e 79  b2 bf a8 f0 5d 9d 72 44  |.$T...ny....].rD|
-00000270  6e df 29 8a d2 cc a8 d2  ee 0c 51 50 cd 71 a6 2a  |n.).......QP.q.*|
-00000280  fe 53 2e f7 ae fa 4c 34  d0 68 31 d5 69 be 64 a5  |.S....L4.h1.i.d.|
-00000290  03 54 31 1a dc f0 9e c7  82 1f 15 d1 64 ff 79 07  |.T1.........d.y.|
-000002a0  5e 71 3a 98 3c 21 a7 8e  1e bf 2d f3 86 4b 3f 30  |^q:.<!....-..K?0|
-000002b0  73 0d 7c 5d 57 1b a9 89  2b 52 70 84 8e e6 bb fe  |s.|]W...+Rp.....|
-000002c0  b7 1f 65 6a 08 63 58 16  81 51 09 b2 79 7d 84 c0  |..ej.cX..Q..y}..|
-000002d0  6f e1 ab 92 35 16 2e 8f  5c 17 2d 5e 68 7f d4 94  |o...5...\.-^h...|
-000002e0  5a 1b 1d 6c 5f e0 36 a0  ae 54 5b e9 39 1f bc 73  |Z..l_.6..T[.9..s|
-000002f0  f9 04 80 e9 36 d2 2c de  64 ca 08 95 d0 98 4b da  |....6.,.d.....K.|
-00000300  7b 0d 7f 79 1b a0 56 6c  dd 3c 40 52 3e 7a 8f 52  |{..y..Vl.<@R>z.R|
-00000310  3c c9 2f 17 03 03 00 99  07 91 f0 6b e0 bb 6f 0b  |<./........k..o.|
-00000320  ff 08 69 bc d2 1d f1 40  d2 d7 c7 f6 c2 b3 57 d7  |..i....@......W.|
-00000330  90 00 c9 9e ef 40 b6 96  86 0d 27 8b 6f ac 54 2f  |.....@....'.o.T/|
-00000340  73 b3 b4 82 1b d3 f5 e9  41 a7 fd d5 b1 67 f7 6e  |s.......A....g.n|
-00000350  2e c1 06 34 ef a3 b9 97  4d a8 64 4f f8 48 24 5c  |...4....M.dO.H$\|
-00000360  66 f4 d7 d4 e3 ad 45 fb  4a 42 0d 19 bb a1 cc b3  |f.....E.JB......|
-00000370  88 d2 2a d7 c3 53 c4 7b  08 a5 68 dc c4 1a f6 f3  |..*..S.{..h.....|
-00000380  a1 42 48 1c c9 2b 1f fb  5d fc 49 ed ce 16 14 34  |.BH..+..].I....4|
-00000390  34 01 c9 ef e6 29 9c 81  1a 7d 7b bd 95 eb ad 5f  |4....)...}{...._|
-000003a0  ce 19 30 9c e6 ae 09 15  3c 2b 38 8b e6 97 76 4e  |..0.....<+8...vN|
-000003b0  dd 17 03 03 00 35 d2 a1  3f 22 e9 2b b6 7a d1 d8  |.....5..?".+.z..|
-000003c0  7b 87 bf d1 bf 56 0b 55  52 d0 a9 cf ae 57 6e 6f  |{....V.UR....Wno|
-000003d0  29 0c c3 f7 f3 d4 bf ff  a4 6b 49 1a 57 57 27 89  |)........kI.WW'.|
-000003e0  e0 f5 bb d2 16 85 39 40  fd 77 a3                 |......9@.w.|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 1e  |..+.....3.$... .|
+00000060  8e a4 e9 85 bd af 87 81  48 56 10 3d 4d d2 07 42  |........HV.=M..B|
+00000070  7f a2 db 93 42 98 df 67  6d 79 b3 fb 4f bb 67 14  |....B..gmy..O.g.|
+00000080  03 03 00 01 01 17 03 03  00 17 db c6 9e 4c ff 07  |.............L..|
+00000090  33 5a d9 47 e2 08 d5 10  bf 70 c5 5b 22 48 a7 fd  |3Z.G.....p.["H..|
+000000a0  8d 17 03 03 02 6d cd a7  97 1c 26 3c a9 70 93 c5  |.....m....&<.p..|
+000000b0  98 ac 09 11 75 24 a1 97  4a a7 65 a0 d7 40 08 c9  |....u$..J.e..@..|
+000000c0  fd 31 5f 47 c3 95 38 cf  cd e0 77 52 db c1 fe 3a  |.1_G..8...wR...:|
+000000d0  2e 5f ae 5a 9a cf 96 5f  83 f5 7e 6b b0 d7 bf 27  |._.Z..._..~k...'|
+000000e0  bd 22 af a1 05 79 48 c7  56 e9 56 a9 4f 34 82 9c  |."...yH.V.V.O4..|
+000000f0  41 c5 cf 72 d1 56 18 d4  fb d7 94 e1 72 9f 2a c0  |A..r.V......r.*.|
+00000100  2f 3b fe de 46 36 4f 0d  15 12 4d e2 2a fb 42 20  |/;..F6O...M.*.B |
+00000110  1e 7f 0f 50 be 56 10 2d  83 9f c0 c4 9e 0a 29 c4  |...P.V.-......).|
+00000120  07 a1 ba c0 70 d4 93 8a  27 a1 e2 00 98 11 3e 4e  |....p...'.....>N|
+00000130  07 46 54 68 5a d2 e3 85  ca 6d 66 b1 28 d7 a3 c9  |.FThZ....mf.(...|
+00000140  cb 9b 5b 4c 94 4a 56 69  dc 6e ba 84 08 7e 31 14  |..[L.JVi.n...~1.|
+00000150  5d a0 e0 00 b2 23 63 fe  67 8c ae 75 56 44 9c 9c  |]....#c.g..uVD..|
+00000160  c4 4c 31 a9 d7 df 3b ec  59 1e 2e 85 fd 08 8d ba  |.L1...;.Y.......|
+00000170  b2 09 f6 3e 19 7b 29 ab  6a b3 5a 00 be 76 fb 39  |...>.{).j.Z..v.9|
+00000180  98 c4 3e 4b a6 ae 68 ba  6c 9a a6 5d 20 33 96 55  |..>K..h.l..] 3.U|
+00000190  27 66 aa c2 c0 6d f0 80  cc c7 64 5f 7b 42 56 b4  |'f...m....d_{BV.|
+000001a0  a2 6b a3 29 9a 49 d2 fc  74 53 21 fe e3 87 ab d9  |.k.).I..tS!.....|
+000001b0  e4 3e e7 8a a0 c6 49 08  d1 45 14 53 fb 28 39 cb  |.>....I..E.S.(9.|
+000001c0  99 86 c2 3f dc b3 f6 86  a7 87 b2 88 d9 4f 62 d6  |...?.........Ob.|
+000001d0  d4 bb 84 93 56 5a 99 8e  8a 5b 1b 9a 1c ef 4a f1  |....VZ...[....J.|
+000001e0  85 62 08 1f 27 c2 20 a1  9c 73 91 05 d8 9b 32 90  |.b..'. ..s....2.|
+000001f0  74 80 08 dd 52 87 9f 6e  c3 89 14 f3 23 0e 1f d0  |t...R..n....#...|
+00000200  3c e0 51 48 a4 b2 f2 43  05 bd a3 95 35 70 37 cc  |<.QH...C....5p7.|
+00000210  89 f3 23 b7 70 5f 36 24  78 ea 21 ec 7c 06 3a d6  |..#.p_6$x.!.|.:.|
+00000220  b5 fd d1 c4 bb 32 39 78  6a f6 ed 91 83 c8 d4 bd  |.....29xj.......|
+00000230  33 55 cf a8 5a b9 46 ec  fa 87 5a c0 35 d1 f6 5e  |3U..Z.F...Z.5..^|
+00000240  1f 7a 8e 82 e1 97 38 f9  ad 6e 00 ba d1 4b 82 dd  |.z....8..n...K..|
+00000250  b0 87 0e 18 70 27 6c cd  dd 0d d7 4b 46 e9 a3 dc  |....p'l....KF...|
+00000260  5d 60 e7 eb a9 b4 99 f2  bc 9f a4 ed dc c6 63 24  |]`............c$|
+00000270  f8 91 f3 ee 7f 47 40 03  95 34 53 8c 38 90 3f 0f  |.....G@..4S.8.?.|
+00000280  a6 d8 a1 a7 39 64 45 7e  9e 94 aa 3e 19 df 28 f1  |....9dE~...>..(.|
+00000290  ab 14 22 ce e8 80 a6 73  59 f7 92 85 13 20 6c cf  |.."....sY.... l.|
+000002a0  d8 ff ce f4 5d 79 f8 37  38 b6 9f 81 97 9f 72 31  |....]y.78.....r1|
+000002b0  e0 fe ca d2 03 cd 3b 00  9f cb 55 a7 de 79 80 d8  |......;...U..y..|
+000002c0  0b ae 5a e6 a7 ba a5 35  da d3 03 95 56 c0 ac c9  |..Z....5....V...|
+000002d0  2a 36 cf 53 d0 44 48 b3  19 6c 44 ab 6b a1 7f a2  |*6.S.DH..lD.k...|
+000002e0  f6 18 90 4f 16 a9 d5 77  ef 01 81 e1 ef a7 b9 3f  |...O...w.......?|
+000002f0  35 82 66 c7 9c 82 cc 00  fa 74 71 ed 99 ab fc d5  |5.f......tq.....|
+00000300  ce 0a 05 80 56 5f 54 79  a9 b2 82 38 af 52 94 d1  |....V_Ty...8.R..|
+00000310  7e 15 1e 17 03 03 00 99  94 6e e7 f3 9a a6 90 24  |~........n.....$|
+00000320  c8 59 16 e6 58 d1 a2 55  ab 90 d6 59 00 06 0f 22  |.Y..X..U...Y..."|
+00000330  2d 7e 1a 13 ce 64 05 a0  e2 a2 22 36 d4 51 69 ce  |-~...d...."6.Qi.|
+00000340  8c 13 85 2e ad a3 9d c9  cf 50 be 06 db 75 41 1e  |.........P...uA.|
+00000350  01 64 8e 55 13 31 42 a0  b9 90 30 75 a3 b5 a1 36  |.d.U.1B...0u...6|
+00000360  e8 1d 5f 32 f4 8f 68 f3  ca d9 f2 36 cf 77 2a ae  |.._2..h....6.w*.|
+00000370  03 db 01 bb 51 25 bb 65  76 0a 81 bf db 6a 0a 85  |....Q%.ev....j..|
+00000380  3d 2a ee 71 ff a5 91 75  3f 44 23 31 70 1f b4 4c  |=*.q...u?D#1p..L|
+00000390  a1 f2 ec cb ac bb de 36  3a 46 a6 3d a8 c5 57 92  |.......6:F.=..W.|
+000003a0  a4 7c d4 54 fa de b6 77  62 95 24 aa 63 70 4a 04  |.|.T...wb.$.cpJ.|
+000003b0  cb 17 03 03 00 35 07 18  23 d6 3d 11 1c 50 e1 22  |.....5..#.=..P."|
+000003c0  c7 83 33 84 c3 e1 30 b0  43 68 19 2b c4 43 95 25  |..3...0.Ch.+.C.%|
+000003d0  8c b7 37 c1 d0 3c ef f4  4f 29 b7 18 34 25 d2 8a  |..7..<..O)..4%..|
+000003e0  44 52 37 4e ff f9 aa 2b  33 61 4a                 |DR7N...+3aJ|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 b3 39 ad 6b 24  |..........5.9.k$|
-00000010  47 e3 9f 11 f9 7e 9a cf  41 db c8 43 ce 86 ae ce  |G....~..A..C....|
-00000020  0c af 17 42 d7 24 57 13  e6 ba a7 44 7c 72 38 aa  |...B.$W....D|r8.|
-00000030  8f fa a2 a2 9f b0 ba 43  47 20 e8 03 3c 00 ee ad  |.......CG ..<...|
-00000040  17 03 03 00 17 ff 5b 79  f8 c8 0c 7a 52 6d b0 b2  |......[y...zRm..|
-00000050  22 17 3b 5d f9 75 23 bb  27 38 35 a6 17 03 03 00  |".;].u#.'85.....|
-00000060  13 d3 94 d9 b5 8b fa dc  b6 fe 26 ca b0 52 5c ef  |..........&..R\.|
-00000070  84 e3 3c f9                                       |..<.|
+00000000  14 03 03 00 01 01 17 03  03 00 35 7d e0 1b 46 05  |..........5}..F.|
+00000010  4a e2 11 2c a4 22 62 cb  bc e7 f4 11 d2 05 ca c6  |J..,."b.........|
+00000020  17 98 10 88 03 12 d1 1e  6a dc e8 bb 91 df 65 47  |........j.....eG|
+00000030  78 f0 32 d1 7d c0 56 92  78 56 6b 75 cc 2d eb 2d  |x.2.}.V.xVku.-.-|
+00000040  17 03 03 00 17 ad cc 95  e5 1c 77 7c de 6f e8 8d  |..........w|.o..|
+00000050  06 8e b6 8e d0 95 3f 71  0b 15 6e 0e 17 03 03 00  |......?q..n.....|
+00000060  13 8e 23 c7 75 9d f7 e1  b9 b5 ed 79 86 e0 64 68  |..#.u......y..dh|
+00000070  01 ef 70 e1                                       |..p.|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-HelloRetryRequest b/src/crypto/tls/testdata/Client-TLSv13-HelloRetryRequest
index 48403391bb..d6b570f246 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-HelloRetryRequest
+++ b/src/crypto/tls/testdata/Client-TLSv13-HelloRetryRequest
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 f6 01 00 00  f2 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,14 +7,14 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 77 00 05 00 05  01 00 00 00 00 00 0a 00  |...w............|
+00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
 00000090  06 00 04 00 1d 00 17 00  0b 00 02 01 00 00 0d 00  |................|
 000000a0  1a 00 18 08 04 04 03 08  07 08 05 08 06 04 01 05  |................|
 000000b0  01 06 01 05 03 06 03 02  01 02 03 ff 01 00 01 00  |................|
-000000c0  00 12 00 00 00 2b 00 09  08 03 04 03 03 03 02 03  |.....+..........|
-000000d0  01 00 33 00 26 00 24 00  1d 00 20 2f e5 7d a3 47  |..3.&.$... /.}.G|
-000000e0  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
-000000f0  c4 cf c2 ed 90 99 5f 58  cb 3b 74                 |......_X.;t|
+000000c0  00 17 00 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
+000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
+000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
+000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 58 02 00 00  54 03 03 cf 21 ad 74 e5  |....X...T...!.t.|
 00000010  9a 61 11 be 1d 8c 02 1e  65 b8 91 c2 a2 11 16 7a  |.a......e......z|
@@ -24,7 +24,7 @@
 00000050  0c 00 2b 00 02 03 04 00  33 00 02 00 17 14 03 03  |..+.....3.......|
 00000060  00 01 01                                          |...|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 16 03  03 01 17 01 00 01 13 03  |................|
+00000000  14 03 03 00 01 01 16 03  03 01 1b 01 00 01 17 03  |................|
 00000010  03 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000030  00 20 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |. ..............|
@@ -32,88 +32,88 @@
 00000050  00 00 00 32 cc a9 cc a8  c0 2b c0 2f c0 2c c0 30  |...2.....+./.,.0|
 00000060  c0 09 c0 13 c0 0a c0 14  00 9c 00 9d 00 2f 00 35  |............./.5|
 00000070  c0 12 00 0a c0 23 c0 27  00 3c c0 07 c0 11 00 05  |.....#.'.<......|
-00000080  13 03 13 01 13 02 01 00  00 98 00 05 00 05 01 00  |................|
+00000080  13 03 13 01 13 02 01 00  00 9c 00 05 00 05 01 00  |................|
 00000090  00 00 00 00 0a 00 06 00  04 00 1d 00 17 00 0b 00  |................|
 000000a0  02 01 00 00 0d 00 1a 00  18 08 04 04 03 08 07 08  |................|
 000000b0  05 08 06 04 01 05 01 06  01 05 03 06 03 02 01 02  |................|
-000000c0  03 ff 01 00 01 00 00 12  00 00 00 2b 00 09 08 03  |...........+....|
-000000d0  04 03 03 03 02 03 01 00  33 00 47 00 45 00 17 00  |........3.G.E...|
-000000e0  41 04 1e 18 37 ef 0d 19  51 88 35 75 71 b5 e5 54  |A...7...Q.5uq..T|
-000000f0  5b 12 2e 8f 09 67 fd a7  24 20 3e b2 56 1c ce 97  |[....g..$ >.V...|
-00000100  28 5e f8 2b 2d 4f 9e f1  07 9f 6c 4b 5b 83 56 e2  |(^.+-O....lK[.V.|
-00000110  32 42 e9 58 b6 d7 49 a6  b5 68 1a 41 03 56 6b dc  |2B.X..I..h.A.Vk.|
-00000120  5a 89                                             |Z.|
+000000c0  03 ff 01 00 01 00 00 17  00 00 00 12 00 00 00 2b  |...............+|
+000000d0  00 09 08 03 04 03 03 03  02 03 01 00 33 00 47 00  |............3.G.|
+000000e0  45 00 17 00 41 04 1e 18  37 ef 0d 19 51 88 35 75  |E...A...7...Q.5u|
+000000f0  71 b5 e5 54 5b 12 2e 8f  09 67 fd a7 24 20 3e b2  |q..T[....g..$ >.|
+00000100  56 1c ce 97 28 5e f8 2b  2d 4f 9e f1 07 9f 6c 4b  |V...(^.+-O....lK|
+00000110  5b 83 56 e2 32 42 e9 58  b6 d7 49 a6 b5 68 1a 41  |[.V.2B.X..I..h.A|
+00000120  03 56 6b dc 5a 89                                 |.Vk.Z.|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 9b 02 00 00  97 03 03 1d 65 62 8f 58  |............eb.X|
-00000010  2b 99 04 1d fd cc e3 0b  46 5c 55 a9 3a 80 76 60  |+.......F\U.:.v`|
-00000020  8f 52 09 6e 48 5d 5a e3  92 da a3 20 00 00 00 00  |.R.nH]Z.... ....|
+00000000  16 03 03 00 9b 02 00 00  97 03 03 4f 5c 5c 6c f2  |...........O\\l.|
+00000010  79 f3 d8 d4 be 78 c3 a4  b6 82 a5 ee 37 c3 a1 f7  |y....x......7...|
+00000020  87 83 ac 75 62 29 48 80  55 64 9b 20 00 00 00 00  |...ub)H.Ud. ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
 00000050  4f 00 2b 00 02 03 04 00  33 00 45 00 17 00 41 04  |O.+.....3.E...A.|
-00000060  1c 01 c6 9e c8 49 43 49  6f 0f 17 f3 ce 87 1a 0f  |.....ICIo.......|
-00000070  1f 2c 70 18 e4 29 f2 16  a2 e0 02 b7 9d 52 bc b9  |.,p..).......R..|
-00000080  d4 b0 1d 19 da 3a 38 f6  93 04 0b ae 5f 60 45 87  |.....:8....._`E.|
-00000090  57 80 20 27 c6 9c d4 eb  ec c0 85 df f5 aa be de  |W. '............|
-000000a0  17 03 03 00 17 d4 a9 5f  09 d3 e6 47 ad a7 7b 38  |......._...G..{8|
-000000b0  a3 b8 02 37 16 ec 03 56  df d5 8d ec 17 03 03 02  |...7...V........|
-000000c0  6d be 1b 2a 60 52 3c 01  2e 6e 7f e3 68 fa de 09  |m..*`R<..n..h...|
-000000d0  ed 5e 8f 0f a0 34 d5 0a  8b 2f 30 8f 6c 56 9e fe  |.^...4.../0.lV..|
-000000e0  e6 9a a9 f1 6e 7c 63 a7  d8 88 e2 95 fa 17 ad 0c  |....n|c.........|
-000000f0  49 20 93 18 3c ba db fc  a1 14 60 2c 77 d4 44 5f  |I ..<.....`,w.D_|
-00000100  69 9c c7 a3 b9 d0 ee e8  c5 ec 45 d3 79 d0 ee 04  |i.........E.y...|
-00000110  fd c3 6d 12 1a f2 6e 62  9f eb ff 32 88 17 4c df  |..m...nb...2..L.|
-00000120  20 4f cc f9 fd d5 7c 8b  8c c2 da 7d 8a c9 f9 27  | O....|....}...'|
-00000130  32 06 75 fe 75 e2 bb bd  6c 31 5d 32 af 36 95 39  |2.u.u...l1]2.6.9|
-00000140  92 6c 32 e5 4f b5 f7 07  9f b3 1b b8 10 a8 d9 db  |.l2.O...........|
-00000150  d3 b0 40 2f 1e e6 54 f5  35 73 7d 22 b3 6b b8 3c  |..@/..T.5s}".k.<|
-00000160  83 82 8a 75 f4 ec 18 94  57 0c de 98 41 73 61 63  |...u....W...Asac|
-00000170  5b 95 3e 4e d4 02 c3 b7  f9 4c 6f 01 c9 52 3c b9  |[.>N.....Lo..R<.|
-00000180  ad 61 83 2c 89 6d 63 40  fd d4 67 83 36 8b 9a 1c  |.a.,.mc@..g.6...|
-00000190  ca 93 16 d8 e3 91 08 d1  3f ba af cb d9 69 09 10  |........?....i..|
-000001a0  07 a7 54 9c ee a2 7d 97  ce b6 1f 31 9b 85 b0 82  |..T...}....1....|
-000001b0  fc 22 87 70 93 59 9c c9  e3 07 9b d0 c0 a4 1d d4  |.".p.Y..........|
-000001c0  2e 36 c0 72 b6 d5 2a f5  b3 fa ab fb 1a 90 05 51  |.6.r..*........Q|
-000001d0  b7 19 15 af d9 b2 5f 32  ef e6 5a 2d 4a 2c 7f a9  |......_2..Z-J,..|
-000001e0  43 cf b8 ac e4 8a f0 bf  68 90 b9 7c 1c 7e fa f0  |C.......h..|.~..|
-000001f0  bc e3 a9 4f a7 2d 3a f3  12 eb b1 93 b4 b9 1b d7  |...O.-:.........|
-00000200  81 31 db 58 c4 8e 9f 46  44 39 74 a1 a8 b0 78 0c  |.1.X...FD9t...x.|
-00000210  b9 23 6d 90 bb a8 b0 7c  e2 a3 a3 c4 e6 83 32 5d  |.#m....|......2]|
-00000220  ea 5a a4 3d 94 ca 51 3c  71 28 cf 43 27 9f 66 9b  |.Z.=..Q<q(.C'.f.|
-00000230  ec 49 0f a4 12 f5 a3 96  cd 3e 05 5b 9c d0 07 6f  |.I.......>.[...o|
-00000240  8a 11 df 2f be a7 1d 0d  9f a8 04 41 3d 5e 1b f6  |.../.......A=^..|
-00000250  b0 10 9b 6a 49 da 6c f9  6c 6e 2e 6c 9b cf f1 fe  |...jI.l.ln.l....|
-00000260  49 92 2b 16 3f 63 ef 87  71 9c da 0d 49 63 2a 4c  |I.+.?c..q...Ic*L|
-00000270  b5 82 c8 b0 75 5b 7b 89  39 cd 9a da dc 42 d1 1f  |....u[{.9....B..|
-00000280  92 61 e1 71 b9 b5 d2 40  3c 7a 4a 8d 91 1f e6 9d  |.a.q...@<zJ.....|
-00000290  79 37 71 3c dc a3 98 0b  b3 64 39 74 f1 8f 84 35  |y7q<.....d9t...5|
-000002a0  1d 6b b7 0a f9 aa 26 55  a8 39 7f 11 26 18 98 fe  |.k....&U.9..&...|
-000002b0  94 fb 5d e4 a1 2f 0f 3b  f0 b6 78 d5 87 32 73 6e  |..]../.;..x..2sn|
-000002c0  3e b1 3e 3c 19 31 7a ae  d8 73 67 96 56 9c 38 a6  |>.><.1z..sg.V.8.|
-000002d0  bc 39 1f 11 74 ad 69 c6  d2 40 0f 65 d8 ee aa 87  |.9..t.i..@.e....|
-000002e0  b3 4c 6c 1a 1d 62 4a 7a  d9 15 05 54 0d 8a 22 68  |.Ll..bJz...T.."h|
-000002f0  8e 41 22 b0 ee 41 b3 94  5d 1a 62 d8 bb ac f2 87  |.A"..A..].b.....|
-00000300  ad 91 19 e7 e1 bc 29 3b  96 8c d1 76 99 e5 82 48  |......);...v...H|
-00000310  0b 87 6a 93 3b 2c b7 c1  73 07 53 7c 1f 9f 48 dd  |..j.;,..s.S|..H.|
-00000320  71 da 55 e1 4a a3 86 d2  ff 23 b2 1d ea b0 17 03  |q.U.J....#......|
-00000330  03 00 99 75 af 84 36 54  8e 17 09 c7 2e 72 de 7d  |...u..6T.....r.}|
-00000340  29 5c 94 a9 e3 d3 d0 9b  3e a0 84 e6 cf b4 48 d8  |)\......>.....H.|
-00000350  dd 7c 8a 82 96 15 aa cb  95 38 88 9e 48 c4 bf 75  |.|.......8..H..u|
-00000360  9c f4 07 ed 5d 4d 36 8b  58 7f 9c 32 0b f9 d2 44  |....]M6.X..2...D|
-00000370  3d d6 ab 3b 3d 38 1f 8d  7e e8 b6 26 57 c9 c6 98  |=..;=8..~..&W...|
-00000380  49 4f 1e ad 5d fa 8b ca  bc ce 99 f2 d9 5b 14 54  |IO..]........[.T|
-00000390  56 0c 59 c8 22 9f 77 f1  db 92 43 c3 dd a5 29 ec  |V.Y.".w...C...).|
-000003a0  0d 79 0d b3 04 3f 4b 6b  d6 a8 da 99 64 94 78 a5  |.y...?Kk....d.x.|
-000003b0  e9 cd 7e f8 0c fb 72 d6  03 89 dd 00 13 f3 14 18  |..~...r.........|
-000003c0  ba 59 3c 04 7f 6a b5 62  37 56 2e 2d 17 03 03 00  |.Y<..j.b7V.-....|
-000003d0  35 af eb 05 4e ec ee 4b  d6 6b 03 35 d8 ba a3 cf  |5...N..K.k.5....|
-000003e0  50 c6 80 07 90 92 1c ed  1f d2 d5 12 e3 7f 74 1a  |P.............t.|
-000003f0  2c 3b 4b 6c f4 58 af 9a  1a cd 90 f4 d8 78 97 09  |,;Kl.X.......x..|
-00000400  2f f6 35 c1 29 b8                                 |/.5.).|
+00000060  be 02 77 b3 71 8c 25 30  15 18 cd 54 f8 99 b7 a4  |..w.q.%0...T....|
+00000070  1b 43 6e a5 bf 94 d3 7e  8f 07 4e 78 15 af 48 fe  |.Cn....~..Nx..H.|
+00000080  14 60 0d f1 1b 31 f5 30  5b 37 34 da d2 b8 a9 43  |.`...1.0[74....C|
+00000090  5e 5e 9e 32 9c 7c 94 21  fc 1e db 0a b3 e1 f5 7a  |^^.2.|.!.......z|
+000000a0  17 03 03 00 17 fc 15 53  2f 26 26 78 e5 5e 22 74  |.......S/&&x.^"t|
+000000b0  8a cb 74 2c f8 4c 04 5d  0b 53 d9 93 17 03 03 02  |..t,.L.].S......|
+000000c0  6d 58 f2 20 bc 2e 2b c7  67 79 b1 19 09 d8 73 9c  |mX. ..+.gy....s.|
+000000d0  74 b4 55 b4 24 5e a3 66  f1 a3 81 55 cb 77 5e c1  |t.U.$^.f...U.w^.|
+000000e0  5e b1 ba 4e ff 29 6e 10  a3 9c 20 68 fb c1 35 a8  |^..N.)n... h..5.|
+000000f0  02 10 0e b6 b1 a1 84 d1  e4 41 92 15 93 ea 9c c1  |.........A......|
+00000100  93 4b 54 28 da 49 f5 eb  a5 a5 92 3b 91 37 48 8a  |.KT(.I.....;.7H.|
+00000110  4a 0a 3c 3a b9 10 2b 1b  e8 33 4f e2 1b a4 e1 0e  |J.<:..+..3O.....|
+00000120  4c 81 38 13 36 f2 87 e9  58 be e4 16 d9 eb 17 9d  |L.8.6...X.......|
+00000130  61 69 7b 41 c9 29 99 bd  b1 5b 66 49 3d f1 e5 6f  |ai{A.)...[fI=..o|
+00000140  e4 91 a1 48 a3 89 91 00  8c 33 2c 0b 07 82 10 26  |...H.....3,....&|
+00000150  fb 7b c6 b0 64 56 1b 2b  1f 21 3a be 72 6d 9b fe  |.{..dV.+.!:.rm..|
+00000160  ad bd 1c 59 05 38 9b 27  88 55 76 88 45 cf 03 be  |...Y.8.'.Uv.E...|
+00000170  2a 8d 5f a6 39 1f 5e b7  1c 68 28 60 f5 cb e4 5e  |*._.9.^..h(`...^|
+00000180  08 6c 3c 85 72 6f 31 26  30 0c 25 94 0e 4d 5b 5b  |.l<.ro1&0.%..M[[|
+00000190  46 ba 0e 27 e1 17 3d 68  95 7e 2f a4 a0 16 54 e2  |F..'..=h.~/...T.|
+000001a0  35 3b a5 79 c8 45 2d e0  57 33 02 4e 81 bd dc 6a  |5;.y.E-.W3.N...j|
+000001b0  9b b7 1e a8 9e ff 75 7f  11 47 9c ac 60 05 bd 9d  |......u..G..`...|
+000001c0  59 2b 92 5a 94 f4 ca 8f  3e 53 b3 8a a5 ab 28 e2  |Y+.Z....>S....(.|
+000001d0  9f ed 29 f2 8b c7 82 92  86 d8 12 71 b1 97 24 26  |..)........q..$&|
+000001e0  f5 96 fc 16 a8 ff 39 1c  87 62 ec 4a b4 c3 03 13  |......9..b.J....|
+000001f0  e8 17 57 6b 48 6c 08 08  b0 6d 1f 1a 8c 1f 48 66  |..WkHl...m....Hf|
+00000200  aa 51 38 59 ac 1e 58 e7  ff 85 e1 60 e0 e5 42 65  |.Q8Y..X....`..Be|
+00000210  9e ff ab 65 bb 06 b2 8b  c6 f2 95 ad 3c eb c7 1c  |...e........<...|
+00000220  d6 2a 60 d3 e4 5f cb 65  ee 3d 45 75 93 53 eb 70  |.*`.._.e.=Eu.S.p|
+00000230  5c f4 ae 5c 6b e0 f1 6d  2c fe 88 cb 32 b4 53 90  |\..\k..m,...2.S.|
+00000240  c5 5b 9e 8c de 08 ff 49  86 2a a5 ef 59 50 f8 68  |.[.....I.*..YP.h|
+00000250  2a 3b e5 44 2a e8 7d c9  6e 5c c1 4f 99 d7 2b 67  |*;.D*.}.n\.O..+g|
+00000260  98 72 38 64 b3 e9 64 95  c1 1c 9d 5c 82 d9 e7 1e  |.r8d..d....\....|
+00000270  ac cf 12 05 d8 da eb 75  69 e3 fb 08 c3 c7 d2 2d  |.......ui......-|
+00000280  aa 3f 9d cc b7 31 b5 03  59 67 03 32 6f ed bc 87  |.?...1..Yg.2o...|
+00000290  47 c6 69 79 23 98 94 b7  4a 58 5f 68 5c 14 77 b5  |G.iy#...JX_h\.w.|
+000002a0  4b db 6e d9 c2 74 d0 8a  94 a6 3f 61 7a 1d b8 53  |K.n..t....?az..S|
+000002b0  c7 fb 1c d7 b7 ae 2b f2  c7 fc ed c3 77 47 8a be  |......+.....wG..|
+000002c0  c4 0a e2 3a da f6 f0 06  15 df 32 06 5e 81 17 aa  |...:......2.^...|
+000002d0  25 5c b0 56 56 ce 93 11  42 4d b1 b5 b5 d4 c9 47  |%\.VV...BM.....G|
+000002e0  df 7c 44 ac 23 bc 49 f6  aa f8 9a e3 fc 4e 7e 11  |.|D.#.I......N~.|
+000002f0  e5 da cc 0e c3 4e 57 5e  0d 7c 5a 98 e8 25 65 2e  |.....NW^.|Z..%e.|
+00000300  d0 9e 73 f1 eb 16 3b c4  bc 87 97 37 38 45 a0 77  |..s...;....78E.w|
+00000310  79 37 30 aa 05 0a 42 04  e2 e3 09 ce 5b d7 04 c1  |y70...B.....[...|
+00000320  b1 c4 89 bc 5d 92 eb 9a  a2 b4 12 87 98 05 17 03  |....]...........|
+00000330  03 00 99 0d 23 22 ba 58  d1 0a 8d 15 c6 ab 47 92  |....#".X......G.|
+00000340  4b ab 8b 31 d3 cd f6 c9  17 31 62 e2 4f 78 3d 87  |K..1.....1b.Ox=.|
+00000350  9f f9 54 10 4b db 86 99  dd eb e7 75 9d d1 dc 1c  |..T.K......u....|
+00000360  03 e2 b2 ae 61 69 66 33  e0 0f 95 4a 41 4f 36 6d  |....aif3...JAO6m|
+00000370  ed bd 80 51 8b 6c 92 dc  29 af 8d 17 12 b8 3d d7  |...Q.l..).....=.|
+00000380  db 05 63 4f ad e5 6e 32  5b 02 27 f6 8f e3 7c 02  |..cO..n2[.'...|.|
+00000390  15 c8 5e c8 f3 14 45 7c  2f 2d 81 aa ec 01 4f 12  |..^...E|/-....O.|
+000003a0  f3 aa c8 e5 ca 52 62 41  7d ca f2 9e 40 c3 36 d3  |.....RbA}...@.6.|
+000003b0  d8 40 be 59 0c 6a 67 aa  75 03 1c b7 b7 4b 21 3f  |.@.Y.jg.u....K!?|
+000003c0  13 28 10 e7 3f a1 25 1a  5d e4 a0 b9 17 03 03 00  |.(..?.%.].......|
+000003d0  35 93 e3 71 c4 3b b0 4a  37 6d 1a 97 a5 c4 17 c4  |5..q.;.J7m......|
+000003e0  cd 0c a0 f5 bb 06 1d 0c  f6 0f c4 c3 de b9 0a b7  |................|
+000003f0  37 9c d6 d4 43 a6 37 78  76 69 31 33 ed d8 db b4  |7...C.7xvi13....|
+00000400  3a ac cc 0d db 1b                                 |:.....|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 35 8d 07 5a  33 f5 d1 e7 6d 71 48 45  |....5..Z3...mqHE|
-00000010  3e 2a c0 7e 66 03 77 b5  69 b1 e5 13 04 0e 0d ea  |>*.~f.w.i.......|
-00000020  6f 80 46 a1 9a 54 09 6f  a7 be b7 a3 a1 0c d4 ba  |o.F..T.o........|
-00000030  0e 7d 00 8f 1b 01 0b d4  6b 4c 17 03 03 00 17 b9  |.}......kL......|
-00000040  fd 5a 5c a1 c2 33 71 63  99 25 bd 03 a3 24 a7 b6  |.Z\..3qc.%...$..|
-00000050  e7 42 04 6a 81 c5 17 03  03 00 13 b6 4a f1 0a 26  |.B.j........J..&|
-00000060  95 e8 fb 4b d1 db 24 95  8f 65 1f 3c 5d b9        |...K..$..e.<].|
+00000000  17 03 03 00 35 ee c2 44  be 17 16 64 cc e6 68 9b  |....5..D...d..h.|
+00000010  4d 75 86 c5 b5 9b f3 1c  7c b5 98 3f 9c 7b 07 65  |Mu......|..?.{.e|
+00000020  53 f1 6c d9 cd 17 54 3f  64 d3 ca 47 9c 1e 2d 13  |S.l...T?d..G..-.|
+00000030  fa 29 5e d8 91 5a 05 e8  03 21 17 03 03 00 17 41  |.)^..Z...!.....A|
+00000040  a1 aa 11 80 44 b8 26 a8  06 62 46 65 59 35 0b 06  |....D.&..bFeY5..|
+00000050  8e bf 6c 02 9d 5f 17 03  03 00 13 40 6d 8b 65 c6  |..l.._.....@m.e.|
+00000060  9c 9d b1 ec 29 f3 3d 23  56 28 f6 5a 5b e3        |....).=#V(.Z[.|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-KeyUpdate b/src/crypto/tls/testdata/Client-TLSv13-KeyUpdate
index ea10f66ff0..02c0a1ae70 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-KeyUpdate
+++ b/src/crypto/tls/testdata/Client-TLSv13-KeyUpdate
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 fa 01 00 00  f6 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 fe 01 00 00  fa 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,96 +7,97 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 7b 00 05 00 05  01 00 00 00 00 00 0a 00  |...{............|
+00000080  01 00 00 7f 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  0a 00 08 00 1d 00 17 00  18 00 19 00 0b 00 02 01  |................|
 000000a0  00 00 0d 00 1a 00 18 08  04 04 03 08 07 08 05 08  |................|
 000000b0  06 04 01 05 01 06 01 05  03 06 03 02 01 02 03 ff  |................|
-000000c0  01 00 01 00 00 12 00 00  00 2b 00 09 08 03 04 03  |.........+......|
-000000d0  03 03 02 03 01 00 33 00  26 00 24 00 1d 00 20 2f  |......3.&.$... /|
-000000e0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
-000000f0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74     |.........._X.;t|
+000000c0  01 00 01 00 00 17 00 00  00 12 00 00 00 2b 00 09  |.............+..|
+000000d0  08 03 04 03 03 03 02 03  01 00 33 00 26 00 24 00  |..........3.&.$.|
+000000e0  1d 00 20 2f e5 7d a3 47  cd 62 43 15 28 da ac 5f  |.. /.}.G.bC.(.._|
+000000f0  bb 29 07 30 ff f6 84 af  c4 cf c2 ed 90 99 5f 58  |.).0.........._X|
+00000100  cb 3b 74                                          |.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 86 ed 46 3d 38  |....z...v....F=8|
-00000010  c5 47 10 b5 4e ac e5 b7  d7 ba cc 23 db f5 0a f4  |.G..N......#....|
-00000020  5e d3 62 af 47 8a 23 34  59 5c db 20 00 00 00 00  |^.b.G.#4Y\. ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 70 a7 d4 99 55  |....z...v..p...U|
+00000010  7d 12 fd ca 3a 43 97 78  16 66 c2 bd 22 8b 6c 91  |}...:C.x.f..".l.|
+00000020  85 92 99 76 c8 4c 0f 4c  dc 94 0b 20 00 00 00 00  |...v.L.L... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 e3  |..+.....3.$... .|
-00000060  ff 35 33 31 c9 d8 5c 68  2a e5 73 98 4d 11 5b d7  |.531..\h*.s.M.[.|
-00000070  06 18 a9 dd 0e 4a 21 92  5b 15 8f bb 91 a9 6c 14  |.....J!.[.....l.|
-00000080  03 03 00 01 01 17 03 03  00 17 ea ac f8 a0 41 47  |..............AG|
-00000090  af 01 fb 51 2e ec 3b 79  f1 8a 54 2b 93 45 33 c3  |...Q..;y..T+.E3.|
-000000a0  79 17 03 03 02 6d 0e c9  a4 55 8e 8c 09 55 cd a6  |y....m...U...U..|
-000000b0  d4 dc 1e 5a de ee 56 c8  c2 ac 12 77 77 76 82 fc  |...Z..V....wwv..|
-000000c0  a6 44 cb c8 c3 16 c4 5e  bc 3f f3 3b 6c 33 f3 35  |.D.....^.?.;l3.5|
-000000d0  ed bd 8e 37 1a 25 de 7e  b3 88 71 ce f9 e5 9b a6  |...7.%.~..q.....|
-000000e0  99 11 0f 71 6b 36 11 04  66 a2 5f 74 1c c6 6a 99  |...qk6..f._t..j.|
-000000f0  49 84 d1 36 96 df 6d 2c  c5 a3 cf 5a c9 37 22 8a  |I..6..m,...Z.7".|
-00000100  72 e4 d4 25 ed 4a b1 c4  85 5a 9a f7 de 0b dd 41  |r..%.J...Z.....A|
-00000110  7d 14 63 35 2e 1c 77 6c  9e 6f 41 d1 cb 29 ca 6d  |}.c5..wl.oA..).m|
-00000120  88 1c 35 53 1b 14 24 79  84 ec 85 0d de e3 0f 2c  |..5S..$y.......,|
-00000130  23 ae 41 72 85 fb 43 36  82 ba 8f 78 79 a2 c3 95  |#.Ar..C6...xy...|
-00000140  72 19 ea 1d 2f 29 0e d5  11 85 e4 cc 8c a5 f4 8e  |r.../)..........|
-00000150  39 ba 88 8f e1 5a 54 7c  53 8b a3 1a 44 9c ae 5b  |9....ZT|S...D..[|
-00000160  1f 0e ea 06 f1 8e 5f 22  d1 ef ee e1 4c b6 1a 26  |......_"....L..&|
-00000170  db 53 96 e6 bc 0b 2f ee  b7 fa 47 af 1e 9c f6 7b  |.S..../...G....{|
-00000180  81 97 0f c3 08 9b 2c a3  de bd f7 8a 1e 13 ad de  |......,.........|
-00000190  a5 fc 5f c7 7a 53 72 e5  17 dc 0a eb 90 91 29 2e  |.._.zSr.......).|
-000001a0  7a a5 09 fd be 31 ff 81  ec a3 fc 91 41 4f cb c7  |z....1......AO..|
-000001b0  27 c3 39 8f cd 77 62 72  9a e9 e9 16 da 90 b6 6b  |'.9..wbr.......k|
-000001c0  05 70 c8 aa f5 cd 88 13  4d ff a5 a9 0f e7 d2 d3  |.p......M.......|
-000001d0  97 2b eb e1 d7 fe 74 da  fb 1e af 94 e6 52 18 48  |.+....t......R.H|
-000001e0  5b e8 c3 10 9d 76 de 17  86 67 83 4a e9 fa 30 e8  |[....v...g.J..0.|
-000001f0  46 95 f5 81 b1 a5 76 38  57 37 3a 8d df ad e7 30  |F.....v8W7:....0|
-00000200  41 b2 94 31 da 0d d6 5c  df 76 01 cd 4d c2 1b fe  |A..1...\.v..M...|
-00000210  bc 69 41 ac dd d7 dd 0a  7c 5b 31 5c c8 1e b3 14  |.iA.....|[1\....|
-00000220  39 20 51 26 6d e5 55 27  a4 9a bb fc 3d 4b 6a b0  |9 Q&m.U'....=Kj.|
-00000230  54 92 ee 33 1b 9b d5 41  fd ef 21 c6 f0 f8 90 a0  |T..3...A..!.....|
-00000240  c4 f5 86 d4 d9 c7 89 6f  67 23 37 31 44 2f 8f 55  |.......og#71D/.U|
-00000250  0a aa e1 9a ec 32 26 e2  ce 96 90 c6 f5 cc 95 79  |.....2&........y|
-00000260  da 0c b4 c1 62 d3 0a 8d  7b 83 33 8e af ff 57 c0  |....b...{.3...W.|
-00000270  5b ca 0f b5 64 10 81 43  12 86 67 cf b2 0a 53 f2  |[...d..C..g...S.|
-00000280  04 46 4f 99 ee e2 cd ce  3e 82 1f 34 43 26 f9 4c  |.FO.....>..4C&.L|
-00000290  57 b0 10 c0 37 40 9c 4f  fb 14 fa 4e 1e 4b 40 da  |W...7@.O...N.K@.|
-000002a0  cc c3 d0 d7 ee 63 18 2e  97 06 a6 49 69 07 7a 3e  |.....c.....Ii.z>|
-000002b0  da 47 68 70 b0 10 bf 8d  18 d2 14 c0 18 18 b2 61  |.Ghp...........a|
-000002c0  45 54 e8 20 34 f8 a3 74  5a 8d aa c2 63 af e8 ff  |ET. 4..tZ...c...|
-000002d0  f9 1b 33 d6 34 c2 f2 c2  3d d8 0e 32 7a 10 cc 21  |..3.4...=..2z..!|
-000002e0  02 22 a6 aa 7d 15 c3 7b  3f a2 50 5a 4e 53 ec f5  |."..}..{?.PZNS..|
-000002f0  11 dd 48 6e 7e e9 c5 94  2c c4 9a 6e 10 a6 c6 a5  |..Hn~...,..n....|
-00000300  9d e1 c5 43 e6 69 a1 91  65 50 eb e6 76 db f0 09  |...C.i..eP..v...|
-00000310  14 45 ef 17 03 03 00 99  e4 82 99 6b d8 57 ca 1b  |.E.........k.W..|
-00000320  78 98 88 ad c7 04 b7 d2  b2 d5 00 3b a9 bf 86 66  |x..........;...f|
-00000330  a7 30 72 95 29 2a 27 9f  9a 3d bd 0b e6 a0 04 22  |.0r.)*'..=....."|
-00000340  56 3d d8 08 84 a7 e7 c5  67 74 34 7d 57 1f c9 df  |V=......gt4}W...|
-00000350  71 0c 97 55 5a d9 8d 99  df 49 b5 a9 57 6d b0 c7  |q..UZ....I..Wm..|
-00000360  2d 4b 70 9d e7 e3 70 31  f0 2f 32 15 7b 67 b4 4c  |-Kp...p1./2.{g.L|
-00000370  f0 f0 4a 16 a5 37 b2 ae  9b 2a 72 7c 2e d8 22 a1  |..J..7...*r|..".|
-00000380  2b 91 f2 14 fc f9 27 fd  ca ad 27 dd 15 11 df b1  |+.....'...'.....|
-00000390  cc 4c 3a 45 3f b6 7c 53  c5 d0 82 49 1a f2 28 63  |.L:E?.|S...I..(c|
-000003a0  a2 be 6f 2f db d8 d3 76  0a 12 fa 87 14 00 11 e7  |..o/...v........|
-000003b0  1f 17 03 03 00 35 0c af  49 a1 ba 14 d4 e5 5c cf  |.....5..I.....\.|
-000003c0  c8 f7 fb 93 e3 d5 45 ac  59 ed 56 3c 1c e6 53 6a  |......E.Y.V<..Sj|
-000003d0  77 62 a3 1a 8c 55 14 b0  d8 6f dd 1c fb a4 6f 25  |wb...U...o....o%|
-000003e0  18 28 ab 9e a5 ad 6d 97  63 f4 9c                 |.(....m.c..|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 df  |..+.....3.$... .|
+00000060  af ca 9c 12 9b 83 69 24  89 3e 44 fe 1c 31 dd 0d  |......i$.>D..1..|
+00000070  3b 52 fd 8e b6 c6 7b 05  9e d4 cc 62 a5 f0 27 14  |;R....{....b..'.|
+00000080  03 03 00 01 01 17 03 03  00 17 a8 47 c6 45 41 bc  |...........G.EA.|
+00000090  7e e3 fb 85 43 5d 6a 69  07 7f 62 05 9d 9e 5f 1f  |~...C]ji..b..._.|
+000000a0  9a 17 03 03 02 6d 7d 46  ba ff 8a 8a 3d a2 d0 29  |.....m}F....=..)|
+000000b0  1e 0d 18 03 84 13 03 de  cf 64 15 28 71 9a bb 80  |.........d.(q...|
+000000c0  d0 4f de 07 d8 f4 47 d5  78 1c 93 e1 50 27 70 81  |.O....G.x...P'p.|
+000000d0  34 c2 0d 63 ee 76 20 dd  c7 34 71 e5 c7 04 91 62  |4..c.v ..4q....b|
+000000e0  06 73 5c 71 e9 ce 13 f9  1c 5b 29 b5 16 64 0f 5b  |.s\q.....[)..d.[|
+000000f0  35 53 0d ba a6 26 1c 98  fa 20 41 a0 08 b1 d1 74  |5S...&... A....t|
+00000100  cd 00 92 7e b4 ce 0e b8  2a 6d e0 25 57 2f e1 af  |...~....*m.%W/..|
+00000110  2c 23 03 03 1d b6 98 70  ec 7d 57 a9 6c 8f 25 3d  |,#.....p.}W.l.%=|
+00000120  63 a3 0e 53 b2 15 8d 1d  62 14 04 50 a9 bc ab 7d  |c..S....b..P...}|
+00000130  ac fa 6a 68 ed f0 72 fd  9a 04 ac bd 44 10 a6 f0  |..jh..r.....D...|
+00000140  df 55 30 54 eb a1 c8 27  4d 6d 97 a1 c0 fc ca a5  |.U0T...'Mm......|
+00000150  c0 9c b8 29 53 13 f2 c8  81 f1 3d f8 35 e5 8d b0  |...)S.....=.5...|
+00000160  d9 c1 68 31 80 4f fb 3a  7a fc 20 ce 75 22 dc f6  |..h1.O.:z. .u"..|
+00000170  94 e9 ff c4 5a c2 1d e9  a2 55 11 df 5d 29 92 17  |....Z....U..])..|
+00000180  5e 9d df 16 97 e3 f0 d0  b6 bd 88 cf 5f 53 e5 da  |^..........._S..|
+00000190  08 98 37 ec d5 1d 8b 4b  59 33 6e 67 d7 e5 eb 9e  |..7....KY3ng....|
+000001a0  31 90 6b 75 c7 41 7c 1d  84 c3 78 03 0e 2b ce 5c  |1.ku.A|...x..+.\|
+000001b0  9a c2 e8 20 7c 8e bc 4a  6e e6 b9 30 ff b3 c0 33  |... |..Jn..0...3|
+000001c0  73 91 f7 b6 13 bc 2c 85  97 ed a6 23 ed c1 e0 ce  |s.....,....#....|
+000001d0  8a 67 9a a3 b2 80 bb 06  ea 9c ec cd 27 f6 1f ae  |.g..........'...|
+000001e0  22 6e e4 c6 ec 5d e3 d9  99 8d 5e 15 5c d0 f1 83  |"n...]....^.\...|
+000001f0  f2 dc 20 a0 67 ee e0 94  05 e3 d7 e9 a2 65 ae d8  |.. .g........e..|
+00000200  da 12 2a db cd 2b 31 c3  ec 12 5b e0 5e 48 66 00  |..*..+1...[.^Hf.|
+00000210  d9 f5 b8 28 1f ef 90 e8  8f a7 78 d7 1c 49 1d 10  |...(......x..I..|
+00000220  d0 79 08 23 12 e1 30 91  7f 26 43 e2 0d dd 0f 6b  |.y.#..0..&C....k|
+00000230  ca ac 25 5f 18 86 40 fd  04 50 f6 dc fb 25 e4 67  |..%_..@..P...%.g|
+00000240  d5 94 fe 3a 55 7f 0e 63  31 f2 96 40 cd 61 c4 e1  |...:U..c1..@.a..|
+00000250  06 bc 5f 80 e9 1d 69 7c  70 7e e6 7f 25 00 75 ce  |.._...i|p~..%.u.|
+00000260  49 e4 bc 4c f4 79 8a d7  67 f3 50 a3 85 d2 96 cb  |I..L.y..g.P.....|
+00000270  51 f4 99 93 d6 20 cf 0d  5f 2d 87 83 df 7b d2 76  |Q.... .._-...{.v|
+00000280  da 9c 47 fb 08 80 43 8e  1f c7 db 8e a9 a7 d5 bb  |..G...C.........|
+00000290  a3 af 0a 3e a3 a3 8c eb  eb e0 93 45 56 a3 eb f0  |...>.......EV...|
+000002a0  6e cd be 8f 42 4c aa 39  36 0e f2 d6 cc 37 ce a4  |n...BL.96....7..|
+000002b0  31 c0 e0 24 3e 52 8c 3f  dc 6e 73 e0 0e ef 54 b7  |1..$>R.?.ns...T.|
+000002c0  27 2f 80 f8 16 0b 27 ea  73 66 c1 59 0b 91 a6 ae  |'/....'.sf.Y....|
+000002d0  f9 d7 d3 60 c0 b0 da 0f  83 19 c2 e0 6e e0 d0 a6  |...`........n...|
+000002e0  87 74 91 f8 6c 46 e3 cd  3a 4c e5 ee 48 94 5b bc  |.t..lF..:L..H.[.|
+000002f0  e4 b5 ed 35 ba 11 c7 0d  76 e9 0a 52 11 a1 35 c2  |...5....v..R..5.|
+00000300  e3 c3 9d fa 9d 9b 45 59  6a de 5b 9c c8 7e c3 00  |......EYj.[..~..|
+00000310  16 06 d9 17 03 03 00 99  63 23 47 37 41 24 5e b5  |........c#G7A$^.|
+00000320  7a 9d 0c 74 c7 f8 c8 62  9e c1 8a 44 29 22 d0 96  |z..t...b...D)"..|
+00000330  c7 94 a1 c5 f6 80 1f 23  70 d5 61 cf b5 87 41 26  |.......#p.a...A&|
+00000340  74 74 9b f4 1c 9d eb b3  da 39 0f 93 74 6a 2d 44  |tt.......9..tj-D|
+00000350  b2 04 31 c0 b0 e8 27 1e  eb 6e 1d 76 aa a7 15 11  |..1...'..n.v....|
+00000360  fd 5a 46 68 e2 76 ec 92  fe 25 41 10 0f 99 da cf  |.ZFh.v...%A.....|
+00000370  1a 04 a2 09 8e a1 73 ca  74 7e f7 d2 0e f1 cf 74  |......s.t~.....t|
+00000380  14 c4 bc 66 6e 28 58 24  09 cb bc da 4d da 4f af  |...fn(X$....M.O.|
+00000390  b8 c5 18 37 34 02 e2 60  b9 cc e9 4b 93 08 0a 22  |...74..`...K..."|
+000003a0  b6 a1 85 b2 ab cd 9c b6  1b 1d 18 46 63 4c 11 c5  |...........FcL..|
+000003b0  67 17 03 03 00 35 10 30  1b 3e 00 ea 4a 8a ab f7  |g....5.0.>..J...|
+000003c0  19 f8 3b 99 5f 56 a6 a3  ed dd 43 33 d9 8f 17 30  |..;._V....C3...0|
+000003d0  f5 a9 fb cd df 5e 95 e8  ff 35 1d 8d de d2 48 5a  |.....^...5....HZ|
+000003e0  af a1 b5 60 4f 75 98 58  1c 24 a1                 |...`Ou.X.$.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 12 2a a7 31 42  |..........5.*.1B|
-00000010  e9 65 d6 88 9c 49 85 53  16 6c 85 bc d1 70 65 3a  |.e...I.S.l...pe:|
-00000020  aa cd d3 12 ce 69 e3 3a  63 7a 8d ed 54 df 9c 97  |.....i.:cz..T...|
-00000030  4e ef 7c 20 ce 41 ac 33  a9 3b fc 5e 35 34 65 00  |N.| .A.3.;.^54e.|
-00000040  17 03 03 00 17 11 5f 88  3b 45 0e 4e 8a 26 43 a3  |......_.;E.N.&C.|
-00000050  9e 77 10 76 8c e1 ed d3  19 f4 27 5f              |.w.v......'_|
+00000000  14 03 03 00 01 01 17 03  03 00 35 a5 8d 0a 81 b7  |..........5.....|
+00000010  76 39 48 24 74 8a a8 f0  91 9b b7 10 14 e3 1f fe  |v9H$t...........|
+00000020  a5 2f 96 6a 7a c3 9d 90  66 99 46 78 c8 d0 1d ba  |./.jz...f.Fx....|
+00000030  34 be 04 c1 a9 4d 17 60  06 a8 04 18 f3 53 9b 33  |4....M.`.....S.3|
+00000040  17 03 03 00 17 14 2c cf  98 1c b3 44 d5 cb 9a 8a  |......,....D....|
+00000050  46 84 e8 d2 7d 81 bf 74  e6 08 4b 1c              |F...}..t..K.|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 16 7d 92 67  60 95 ba fa a0 5f 03 e9  |.....}.g`...._..|
-00000010  2b e6 53 ed fb 6b 4f b9  e9 09 10                 |+.S..kO....|
+00000000  17 03 03 00 16 3e c3 0e  81 bd 7c e9 21 c8 d1 3f  |.....>....|.!..?|
+00000010  94 a9 37 43 21 42 3b 81  ba 65 53                 |..7C!B;..eS|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 16 06 17 fb  4b 33 c7 06 d5 a9 40 e8  |........K3....@.|
-00000010  c7 09 65 b2 5c 2d 45 2f  bf 45 a8                 |..e.\-E/.E.|
+00000000  17 03 03 00 16 63 a6 48  59 77 ae a9 a7 40 e2 57  |.....c.HYw...@.W|
+00000010  9b 41 bb e8 14 06 01 46  71 46 77                 |.A.....FqFw|
 >>> Flow 6 (server to client)
-00000000  17 03 03 00 1a 04 5e c0  bb ad 6c 2f 65 61 5c 39  |......^...l/ea\9|
-00000010  a9 e2 c4 9e 0e 4c 68 d2  a9 97 8a bf 95 39 3f     |.....Lh......9?|
+00000000  17 03 03 00 1a 20 8a 20  30 bc 48 17 8f ed 57 bb  |..... . 0.H...W.|
+00000010  e8 2a da 2a 21 5b 4d 11  74 13 32 6f 1c d6 7c     |.*.*![M.t.2o..||
 >>> Flow 7 (client to server)
-00000000  17 03 03 00 1d 1f 74 d0  fb ed fa 59 81 21 7e f0  |......t....Y.!~.|
-00000010  41 c8 6e 6b 9f b6 1a 86  ad 2e ac 9e 3d 3b 66 c9  |A.nk........=;f.|
-00000020  4a 87 17 03 03 00 13 7b  76 c4 85 c1 41 47 6d 35  |J......{v...AGm5|
-00000030  98 86 02 d5 3b e4 6b 4c  3e 7a                    |....;.kL>z|
+00000000  17 03 03 00 1d fb 5b 0c  dc f1 6b 02 a7 f6 68 21  |......[...k...h!|
+00000010  a4 5c 29 7e 52 08 5f 4d  fb cb e4 a6 ae c9 e0 09  |.\)~R._M........|
+00000020  01 02 17 03 03 00 13 4e  79 eb 2d 97 87 45 9d 73  |.......Ny.-..E.s|
+00000030  6f 13 be c5 68 50 ef 03  4c 18                    |o...hP..L.|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-P256-ECDHE b/src/crypto/tls/testdata/Client-TLSv13-P256-ECDHE
index db87bef8a1..7280dafde4 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-P256-ECDHE
+++ b/src/crypto/tls/testdata/Client-TLSv13-P256-ECDHE
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 15 01 00 01  11 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 01 19 01 00 01  15 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,88 +7,88 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 96 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
+00000080  01 00 00 9a 00 05 00 05  01 00 00 00 00 00 0a 00  |................|
 00000090  04 00 02 00 17 00 0b 00  02 01 00 00 0d 00 1a 00  |................|
 000000a0  18 08 04 04 03 08 07 08  05 08 06 04 01 05 01 06  |................|
-000000b0  01 05 03 06 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-000000c0  00 00 00 2b 00 09 08 03  04 03 03 03 02 03 01 00  |...+............|
-000000d0  33 00 47 00 45 00 17 00  41 04 1e 18 37 ef 0d 19  |3.G.E...A...7...|
-000000e0  51 88 35 75 71 b5 e5 54  5b 12 2e 8f 09 67 fd a7  |Q.5uq..T[....g..|
-000000f0  24 20 3e b2 56 1c ce 97  28 5e f8 2b 2d 4f 9e f1  |$ >.V...(^.+-O..|
-00000100  07 9f 6c 4b 5b 83 56 e2  32 42 e9 58 b6 d7 49 a6  |..lK[.V.2B.X..I.|
-00000110  b5 68 1a 41 03 56 6b dc  5a 89                    |.h.A.Vk.Z.|
+000000b0  01 05 03 06 03 02 01 02  03 ff 01 00 01 00 00 17  |................|
+000000c0  00 00 00 12 00 00 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000d0  02 03 01 00 33 00 47 00  45 00 17 00 41 04 1e 18  |....3.G.E...A...|
+000000e0  37 ef 0d 19 51 88 35 75  71 b5 e5 54 5b 12 2e 8f  |7...Q.5uq..T[...|
+000000f0  09 67 fd a7 24 20 3e b2  56 1c ce 97 28 5e f8 2b  |.g..$ >.V...(^.+|
+00000100  2d 4f 9e f1 07 9f 6c 4b  5b 83 56 e2 32 42 e9 58  |-O....lK[.V.2B.X|
+00000110  b6 d7 49 a6 b5 68 1a 41  03 56 6b dc 5a 89        |..I..h.A.Vk.Z.|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 9b 02 00 00  97 03 03 bb 03 f1 4e 88  |..............N.|
-00000010  23 9e 85 ee 32 13 db 0d  69 11 48 47 c6 c9 e5 b2  |#...2...i.HG....|
-00000020  25 9d 0c 27 87 05 3f 58  42 60 2d 20 00 00 00 00  |%..'..?XB`- ....|
+00000000  16 03 03 00 9b 02 00 00  97 03 03 fe 3a 17 76 b0  |............:.v.|
+00000010  7f a1 ed 8e fa 88 7a c6  d0 78 62 83 db b8 a3 72  |......z..xb....r|
+00000020  77 c7 18 54 f3 07 3b 08  f0 fb be 20 00 00 00 00  |w..T..;.... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
 00000050  4f 00 2b 00 02 03 04 00  33 00 45 00 17 00 41 04  |O.+.....3.E...A.|
-00000060  85 3c 83 1b e5 02 e9 0d  89 cc c0 f7 af 1e ba af  |.<..............|
-00000070  de ad cb 8f 4d 58 04 40  c2 60 e9 41 8b 94 26 76  |....MX.@.`.A..&v|
-00000080  73 64 c3 27 e3 51 9d 5f  21 97 59 a3 02 cc 20 61  |sd.'.Q._!.Y... a|
-00000090  b7 ef cb bb d9 31 b6 b7  b1 77 ea 8d 69 13 13 48  |.....1...w..i..H|
-000000a0  14 03 03 00 01 01 17 03  03 00 17 ab ac 2e 62 de  |..............b.|
-000000b0  b6 f4 c7 35 cf b4 75 fc  a4 a5 2c 40 68 f5 48 80  |...5..u...,@h.H.|
-000000c0  d2 8b 17 03 03 02 6d a9  36 b5 10 78 1f af 79 65  |......m.6..x..ye|
-000000d0  dd ee 36 08 b9 96 e2 bf  09 53 c7 ee 12 19 1b de  |..6......S......|
-000000e0  96 25 cb a7 55 71 28 22  16 3f 4b 3e 15 a2 2e 57  |.%..Uq(".?K>...W|
-000000f0  99 85 28 b2 01 16 3a 75  ff 5e 21 39 6c be fc bd  |..(...:u.^!9l...|
-00000100  24 33 ec c7 50 83 49 91  8a ed 43 38 b5 48 cd 92  |$3..P.I...C8.H..|
-00000110  dd 9a f1 b7 90 61 3b 8f  ff b9 cf 97 3d 8e 23 8e  |.....a;.....=.#.|
-00000120  d1 78 52 b4 ba a1 75 97  32 52 e3 1f c8 43 ca b7  |.xR...u.2R...C..|
-00000130  89 46 e6 30 c2 c5 32 b3  5f a8 ea ea e2 31 d2 41  |.F.0..2._....1.A|
-00000140  23 5e 64 a2 b9 23 27 73  b2 df 77 cd 04 8b dd 37  |#^d..#'s..w....7|
-00000150  a5 77 df 0e 4f 9d 01 22  7b be 7a 0c 18 5c 8b 62  |.w..O.."{.z..\.b|
-00000160  7c 6b 7e a7 54 8c 69 97  50 d7 cf a0 a4 cb 3a 3b  ||k~.T.i.P.....:;|
-00000170  76 7b 0a de 80 d1 40 c3  05 5e b3 4e 71 cd 03 82  |v{....@..^.Nq...|
-00000180  d5 95 d0 38 ab 65 83 24  66 d2 31 2d 9e 58 16 87  |...8.e.$f.1-.X..|
-00000190  b8 ab 4c 4e 75 40 7e 3d  33 2f f4 ed 0b a8 11 1c  |..LNu@~=3/......|
-000001a0  7a a4 b0 e3 6a 73 d0 6e  e6 82 39 c1 cf 57 a4 9a  |z...js.n..9..W..|
-000001b0  8b fc bc 8e e8 6a c3 e1  b0 64 18 55 6d 19 30 25  |.....j...d.Um.0%|
-000001c0  34 f8 b1 ef cf 3c 04 08  69 10 ad 08 67 5b 8d 64  |4....<..i...g[.d|
-000001d0  eb 83 72 39 2e 56 e4 d2  e9 f2 da 40 3e 85 29 ab  |..r9.V.....@>.).|
-000001e0  5b 83 e5 b0 d2 9b eb c3  99 6e 2a f3 78 95 d4 7a  |[........n*.x..z|
-000001f0  7f bf 9c 16 55 77 43 4d  67 f7 4a 6f 40 27 a2 82  |....UwCMg.Jo@'..|
-00000200  b9 86 05 5d 90 e2 52 a2  d4 7c 7b 3e da 30 c1 aa  |...]..R..|{>.0..|
-00000210  30 2e 9a 34 c5 59 dd db  e9 25 67 da 22 47 f2 be  |0..4.Y...%g."G..|
-00000220  cc c8 5a 4e da cf ad 86  8d bd b0 68 26 69 ea 3a  |..ZN.......h&i.:|
-00000230  1c 1e 29 ae e1 09 63 88  f0 81 31 f9 70 a7 92 27  |..)...c...1.p..'|
-00000240  32 9e 3b 6f 09 5e 42 20  53 88 bf 09 8b a8 17 5c  |2.;o.^B S......\|
-00000250  24 7c 18 1f 9c 99 9b db  6d 11 26 8e 92 2c a1 b4  |$|......m.&..,..|
-00000260  5c 9f d9 0a a8 af 25 f7  84 f5 65 d1 b1 6c d8 aa  |\.....%...e..l..|
-00000270  49 c7 a6 13 47 2e 55 f4  2e de 3d 43 c1 15 8d 60  |I...G.U...=C...`|
-00000280  c1 27 59 7e 7b 14 ee 54  09 fc 99 79 c9 bf fb 45  |.'Y~{..T...y...E|
-00000290  2d 32 ed 1a 2c 84 bc f4  a2 b5 5f 4e cf 60 29 91  |-2..,....._N.`).|
-000002a0  90 b6 ab 06 8f 2d 43 a5  a5 54 0d 67 52 c2 1c fb  |.....-C..T.gR...|
-000002b0  f3 41 b7 67 b4 50 05 86  19 75 93 8b 6c c3 bf 08  |.A.g.P...u..l...|
-000002c0  64 f2 df ff 37 6d 2f 1e  3a 28 f4 ba 27 8d 61 d5  |d...7m/.:(..'.a.|
-000002d0  79 70 19 82 99 7a e5 68  f3 c1 23 da 5d e1 98 b2  |yp...z.h..#.]...|
-000002e0  69 ca 42 83 61 29 3f d9  20 51 f2 a9 ea 1c 0b 5a  |i.B.a)?. Q.....Z|
-000002f0  20 b0 af 70 cc c5 ad 72  6b 09 85 56 8a 26 86 cf  | ..p...rk..V.&..|
-00000300  4e 9a 56 97 5d 63 8d 1d  46 04 48 16 c9 1e 91 47  |N.V.]c..F.H....G|
-00000310  74 53 28 51 7e 3c 84 a1  50 d6 f3 ac 31 ce 04 18  |tS(Q~<..P...1...|
-00000320  81 38 0d c5 3d f5 d5 04  2f f0 96 9b 73 49 4c d6  |.8..=.../...sIL.|
-00000330  89 d9 b9 be 17 03 03 00  99 3a 37 ed 2d 98 80 f9  |.........:7.-...|
-00000340  d0 04 14 12 8c 63 45 cc  8d cb 29 5f 0e f0 86 ef  |.....cE...)_....|
-00000350  8d 6c d6 0f ef 66 99 91  e8 8c d7 7b 21 07 7e 96  |.l...f.....{!.~.|
-00000360  84 f8 f9 5b 1b 39 8b 4f  16 ec 5c 69 7b 18 09 5d  |...[.9.O..\i{..]|
-00000370  95 f1 f3 73 4b 8f 84 66  ee 61 85 dd fe ea 36 df  |...sK..f.a....6.|
-00000380  e5 2a 71 ec 2d 7e 47 1c  b7 79 2d 87 f8 dc 44 27  |.*q.-~G..y-...D'|
-00000390  8a f1 13 6e df ca 59 79  9b 18 01 7e 31 bd 44 f7  |...n..Yy...~1.D.|
-000003a0  8d ad 1c 97 e7 e1 b9 a6  17 d1 25 d1 b8 0d 04 bb  |..........%.....|
-000003b0  21 a4 08 db a2 08 87 5c  04 9a 11 fa c6 24 db 20  |!......\.....$. |
-000003c0  42 79 9c 97 dd 6c d2 e7  24 b4 79 47 be f3 43 87  |By...l..$.yG..C.|
-000003d0  0f 95 17 03 03 00 35 9e  7d 12 0e d6 0a e6 af a3  |......5.}.......|
-000003e0  83 dd eb 08 73 2d 43 7e  81 85 51 4c d1 ad d0 77  |....s-C~..QL...w|
-000003f0  8d 28 62 44 41 9c b0 e9  93 d7 3d 07 e4 e1 6e 4c  |.(bDA.....=...nL|
-00000400  a8 5b 4a 3f 58 3f 97 07  73 d7 5a 62              |.[J?X?..s.Zb|
+00000060  e2 a0 62 23 50 9d 82 7d  bc f4 f4 e7 ed d0 6c 6e  |..b#P..}......ln|
+00000070  f2 46 f4 e6 11 5f e0 f3  02 e3 13 67 e3 92 da 39  |.F..._.....g...9|
+00000080  15 a2 3a c7 80 16 e6 25  fd 86 59 56 08 ee 78 eb  |..:....%..YV..x.|
+00000090  d9 ba 36 69 d3 fe bc fc  92 a1 1b 48 a1 a5 6c 09  |..6i.......H..l.|
+000000a0  14 03 03 00 01 01 17 03  03 00 17 0f 26 b2 e7 86  |............&...|
+000000b0  1a 6f e5 19 28 d1 0c 5f  4d 45 7e e6 9f f8 16 03  |.o..(.._ME~.....|
+000000c0  d2 71 17 03 03 02 6d 2e  bc 2a 2c eb e1 97 06 37  |.q....m..*,....7|
+000000d0  87 39 bf f1 79 3a ba 23  51 26 37 a1 ba 2c 30 d9  |.9..y:.#Q&7..,0.|
+000000e0  65 f8 8e 54 b7 1a 8a ff  e8 eb 50 ab f4 e5 0f 07  |e..T......P.....|
+000000f0  94 6b 3d 40 2f bc f7 1c  51 b7 6a 22 78 da 4c ab  |.k=@/...Q.j"x.L.|
+00000100  74 2b b5 f9 c5 2f f5 b8  8a c0 3b c3 56 d8 79 94  |t+.../....;.V.y.|
+00000110  d7 2c bc 7e 2d a8 aa 7d  93 1e 24 49 34 a2 c8 83  |.,.~-..}..$I4...|
+00000120  fc 0e b2 c7 f8 15 9c fd  6f 67 d8 32 e4 ce e6 c2  |........og.2....|
+00000130  a5 ae c2 8b 40 dd b5 46  dc b9 40 e1 21 47 0e 55  |....@..F..@.!G.U|
+00000140  7b f5 87 35 6d 10 22 04  a3 4f f8 95 54 0c 41 a6  |{..5m."..O..T.A.|
+00000150  95 7b 0e 96 4b 73 c2 75  c9 87 ce a9 89 06 a9 7a  |.{..Ks.u.......z|
+00000160  26 ec 81 70 48 4d 24 f4  09 00 aa 92 ac a2 77 9d  |&..pHM$.......w.|
+00000170  ad aa 18 0f e0 f7 91 c9  80 46 c2 db e7 87 fd 3d  |.........F.....=|
+00000180  f2 8f ee cb 26 7d ae 1f  17 6e d0 d4 cd 11 80 a2  |....&}...n......|
+00000190  57 57 88 78 2e 32 ac 2f  1c ad 5b 86 d2 94 55 9f  |WW.x.2./..[...U.|
+000001a0  cd 41 b7 cf 6d bb 45 6a  0b 72 79 91 81 1a 79 b3  |.A..m.Ej.ry...y.|
+000001b0  6e 7f f4 8a 7b c0 b0 a6  00 0e c0 fe 67 4e e3 96  |n...{.......gN..|
+000001c0  5b 0f 1b 47 b5 43 94 91  e9 c4 5f 0b 04 46 bd 53  |[..G.C...._..F.S|
+000001d0  f0 44 a9 0c 46 39 d0 e0  9c 25 76 4e 26 f4 49 12  |.D..F9...%vN&.I.|
+000001e0  42 7a a7 19 98 f0 93 1f  42 78 c7 1c 87 f0 92 ab  |Bz......Bx......|
+000001f0  ec 8b f9 4f e3 60 ea fd  88 b5 9d 68 18 59 60 ee  |...O.`.....h.Y`.|
+00000200  66 a9 0a 24 33 4a 9f c1  c0 e1 70 a0 c3 b1 8d f5  |f..$3J....p.....|
+00000210  4a eb 5e f6 8f a9 2f c7  df 88 40 41 61 b3 3e 18  |J.^.../...@Aa.>.|
+00000220  66 f7 e1 b7 a6 a9 3a 10  73 ab a4 ce 39 40 8a 78  |f.....:.s...9@.x|
+00000230  47 7f bc c9 08 c3 f0 0e  1e 09 87 bf fc e0 46 38  |G.............F8|
+00000240  e7 79 4e 9e 50 94 e7 94  ab 54 47 a7 07 7f 9d 7c  |.yN.P....TG....||
+00000250  9e 83 9b ba dd 33 5d de  db 80 9f a0 7d 9f c3 57  |.....3].....}..W|
+00000260  83 45 0d a6 82 61 75 b7  14 54 0c 7e 94 8a fb 4a  |.E...au..T.~...J|
+00000270  9b 62 bf 8f ae 37 76 23  a0 e0 c0 e0 c1 2c 53 28  |.b...7v#.....,S(|
+00000280  4c 5b b7 b3 c1 4e bb e5  cd e8 b0 7b 8e 38 b0 bb  |L[...N.....{.8..|
+00000290  74 d2 00 63 b4 7b 97 a3  48 52 0f f2 60 0c 0b e4  |t..c.{..HR..`...|
+000002a0  b4 0f 1c 9c 97 e1 fa ff  26 61 f8 3c ee 41 66 f8  |........&a.<.Af.|
+000002b0  b3 91 cd 30 bd ef 81 cf  23 3a ea fd b8 96 b6 e3  |...0....#:......|
+000002c0  bd 32 f2 0f 7a 3d 08 2c  50 a4 16 4e a6 2b 6b 2e  |.2..z=.,P..N.+k.|
+000002d0  3e 7e a0 bc 10 c2 3c 30  65 fc 26 cd 2b 51 54 27  |>~....<0e.&.+QT'|
+000002e0  29 62 eb 99 bb 0b f8 29  ce 8a 21 87 c1 8e f8 6c  |)b.....)..!....l|
+000002f0  17 fe 96 08 db 03 ef 22  ab 2a 55 8e 11 15 19 97  |.......".*U.....|
+00000300  66 9b f3 16 b4 ce 7c 29  f7 e0 ba 1a 14 46 42 20  |f.....|).....FB |
+00000310  38 8b 26 8a 53 13 83 a0  a5 76 2d 4c 3c 88 6e a0  |8.&.S....v-L<.n.|
+00000320  38 23 69 20 d1 3e c9 40  9b 46 4c 09 d9 50 80 49  |8#i .>.@.FL..P.I|
+00000330  bd 59 d9 ec 17 03 03 00  99 a2 f2 c7 ce c6 45 c8  |.Y............E.|
+00000340  45 9a 9d a8 83 d9 81 ff  2d ef 81 f9 b7 3d 0e 79  |E.......-....=.y|
+00000350  54 5f f4 ca f0 41 20 91  f7 5c 53 49 09 ee b6 27  |T_...A ..\SI...'|
+00000360  82 61 0f 1e b9 2d 0f 4e  dd e7 3f 05 3c eb bc 2c  |.a...-.N..?.<..,|
+00000370  81 ca 5d 2f e5 56 f8 ec  e5 cb 69 da e9 16 79 ba  |..]/.V....i...y.|
+00000380  61 8d a9 09 31 2f d3 4c  87 bf 6c 1a 50 df 81 cd  |a...1/.L..l.P...|
+00000390  ba 4c 28 a1 47 05 13 65  f5 6d a0 fb 04 f6 5f 78  |.L(.G..e.m...._x|
+000003a0  d9 28 67 99 ee b9 a1 07  85 3c 5b 17 48 f3 87 43  |.(g......<[.H..C|
+000003b0  ca 40 12 59 85 34 da 67  8a 26 3e 0c 11 9f 42 82  |.@.Y.4.g.&>...B.|
+000003c0  81 80 56 5b a9 6f c2 73  9d 9a 5e ab 97 a2 a4 49  |..V[.o.s..^....I|
+000003d0  9f 73 17 03 03 00 35 7c  74 eb 0d 2b 2f b3 92 2e  |.s....5|t..+/...|
+000003e0  54 12 f9 cb ae fb d4 8d  6f 7f 93 c5 bd 54 1d d5  |T.......o....T..|
+000003f0  06 71 bf 3f 43 71 7b ce  20 9d a9 12 bf dd 2c 3c  |.q.?Cq{. .....,<|
+00000400  b5 7e 9d 3a 56 e3 8b d1  15 0e 69 35              |.~.:V.....i5|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 df 31 1a 84 e2  |..........5.1...|
-00000010  93 54 01 f2 d1 e8 32 6c  32 91 e5 64 86 68 ad 5f  |.T....2l2..d.h._|
-00000020  aa 24 54 86 b2 39 92 24  06 65 5c 06 67 43 7d 09  |.$T..9.$.e\.gC}.|
-00000030  79 78 c6 f3 cf 6c a9 ec  38 e3 ec 81 c4 9b c5 33  |yx...l..8......3|
-00000040  17 03 03 00 17 25 ed 98  67 8f ad e8 60 ce 5b ad  |.....%..g...`.[.|
-00000050  ab 3e 67 64 e3 8d bf 98  96 a2 3d 99 17 03 03 00  |.>gd......=.....|
-00000060  13 9d 28 f2 24 fe d6 11  b0 64 d6 8a 8d c1 81 e0  |..(.$....d......|
-00000070  17 d5 a0 f3                                       |....|
+00000000  14 03 03 00 01 01 17 03  03 00 35 07 f8 0f 71 b3  |..........5...q.|
+00000010  74 36 f9 e0 2c a4 ac bc  9f 19 fc a7 aa 3d 8e cb  |t6..,........=..|
+00000020  22 4b 8f 54 f3 4f b2 a5  85 8a c9 ab b0 b7 62 61  |"K.T.O........ba|
+00000030  58 dc 64 88 bb 43 6e 61  af 02 88 ca d8 15 b3 02  |X.d..Cna........|
+00000040  17 03 03 00 17 25 37 e4  43 40 29 dd 4b fd a6 22  |.....%7.C@).K.."|
+00000050  00 75 02 49 c6 64 a1 ed  de ed 96 cb 17 03 03 00  |.u.I.d..........|
+00000060  13 d6 49 0b ba 13 f3 5b  80 63 79 c8 6a f6 2d df  |..I....[.cy.j.-.|
+00000070  3f d3 2c 8b                                       |?.,.|
diff --git a/src/crypto/tls/testdata/Client-TLSv13-X25519-ECDHE b/src/crypto/tls/testdata/Client-TLSv13-X25519-ECDHE
index 4a43382da5..b430ce03fd 100644
--- a/src/crypto/tls/testdata/Client-TLSv13-X25519-ECDHE
+++ b/src/crypto/tls/testdata/Client-TLSv13-X25519-ECDHE
@@ -1,5 +1,5 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 f4 01 00 00  f0 03 03 00 00 00 00 00  |................|
+00000000  16 03 01 00 f8 01 00 00  f4 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 00 00 00 00 00  00 00 00 20 00 00 00 00  |........... ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
@@ -7,84 +7,84 @@
 00000050  cc a8 c0 2b c0 2f c0 2c  c0 30 c0 09 c0 13 c0 0a  |...+./.,.0......|
 00000060  c0 14 00 9c 00 9d 00 2f  00 35 c0 12 00 0a c0 23  |......./.5.....#|
 00000070  c0 27 00 3c c0 07 c0 11  00 05 13 03 13 01 13 02  |.'.<............|
-00000080  01 00 00 75 00 05 00 05  01 00 00 00 00 00 0a 00  |...u............|
+00000080  01 00 00 79 00 05 00 05  01 00 00 00 00 00 0a 00  |...y............|
 00000090  04 00 02 00 1d 00 0b 00  02 01 00 00 0d 00 1a 00  |................|
 000000a0  18 08 04 04 03 08 07 08  05 08 06 04 01 05 01 06  |................|
-000000b0  01 05 03 06 03 02 01 02  03 ff 01 00 01 00 00 12  |................|
-000000c0  00 00 00 2b 00 09 08 03  04 03 03 03 02 03 01 00  |...+............|
-000000d0  33 00 26 00 24 00 1d 00  20 2f e5 7d a3 47 cd 62  |3.&.$... /.}.G.b|
-000000e0  43 15 28 da ac 5f bb 29  07 30 ff f6 84 af c4 cf  |C.(.._.).0......|
-000000f0  c2 ed 90 99 5f 58 cb 3b  74                       |...._X.;t|
+000000b0  01 05 03 06 03 02 01 02  03 ff 01 00 01 00 00 17  |................|
+000000c0  00 00 00 12 00 00 00 2b  00 09 08 03 04 03 03 03  |.......+........|
+000000d0  02 03 01 00 33 00 26 00  24 00 1d 00 20 2f e5 7d  |....3.&.$... /.}|
+000000e0  a3 47 cd 62 43 15 28 da  ac 5f bb 29 07 30 ff f6  |.G.bC.(.._.).0..|
+000000f0  84 af c4 cf c2 ed 90 99  5f 58 cb 3b 74           |........_X.;t|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 7a 02 00 00  76 03 03 eb 1b 4e e5 65  |....z...v....N.e|
-00000010  54 ab 07 68 1c d9 32 0f  0e c2 ae a3 2a 89 37 50  |T..h..2.....*.7P|
-00000020  23 51 61 7d 68 60 34 0d  40 2f b8 20 00 00 00 00  |#Qa}h`4.@/. ....|
+00000000  16 03 03 00 7a 02 00 00  76 03 03 94 fd 21 44 52  |....z...v....!DR|
+00000010  54 21 7e 4a 1c 83 6a ce  c7 21 df b2 f3 1e 4c 73  |T!~J..j..!....Ls|
+00000020  d3 f0 8b cc 24 58 17 5c  9c 0c 28 20 00 00 00 00  |....$X.\..( ....|
 00000030  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000040  00 00 00 00 00 00 00 00  00 00 00 00 13 03 00 00  |................|
-00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 17  |..+.....3.$... .|
-00000060  7d df 14 8a ad 43 51 c3  c2 08 3a ea f7 e3 96 6a  |}....CQ...:....j|
-00000070  b7 8b 61 66 d9 82 c5 7b  b9 77 bc 62 6a 19 04 14  |..af...{.w.bj...|
-00000080  03 03 00 01 01 17 03 03  00 17 4e 7b b6 d1 b1 19  |..........N{....|
-00000090  0d 0c d0 d3 5a 66 44 5c  81 49 74 f3 71 3b 97 5e  |....ZfD\.It.q;.^|
-000000a0  ee 17 03 03 02 6d 00 17  b1 4d b9 f5 fc ea 48 72  |.....m...M....Hr|
-000000b0  aa a5 1c 8b fe 97 08 54  ab 2d 0a 0e f7 51 41 bf  |.......T.-...QA.|
-000000c0  7b 14 ba b7 d9 0a 30 44  db b9 06 e7 6b a9 0a 94  |{.....0D....k...|
-000000d0  49 a2 29 50 f2 7f 7e 68  91 41 ad a9 cb ee e2 bd  |I.)P..~h.A......|
-000000e0  03 fd 95 79 ea c3 77 ee  88 3b 7a 81 15 9f 17 96  |...y..w..;z.....|
-000000f0  b2 db b9 f3 26 dd 75 69  ef 12 c0 63 b0 04 63 ae  |....&.ui...c..c.|
-00000100  aa b3 67 f8 7f a5 17 cf  56 5f ee 34 2d d7 83 23  |..g.....V_.4-..#|
-00000110  84 00 4b 94 1a 76 2a 01  ce 49 0a 57 7d c8 65 7a  |..K..v*..I.W}.ez|
-00000120  d7 16 34 1c a8 37 fd 71  d4 79 08 b1 44 9f 9e a7  |..4..7.q.y..D...|
-00000130  78 ab 9d 0d c4 80 0e 81  35 75 23 59 89 1b 2c d3  |x.......5u#Y..,.|
-00000140  bc c9 86 b9 7b 22 19 30  dd cc 68 93 ab d2 98 dd  |....{".0..h.....|
-00000150  c2 9f 20 af c9 1a 87 b3  28 73 84 83 ca 98 1d 60  |.. .....(s.....`|
-00000160  df 12 19 70 80 f2 ff 20  64 b5 8c ef e2 e8 6a 5a  |...p... d.....jZ|
-00000170  df 8e ba 95 d8 2c c4 b6  4f a1 33 8c 8d a3 fc d3  |.....,..O.3.....|
-00000180  c4 4b ba b2 6d 3a f7 da  38 23 5f 03 a7 92 13 76  |.K..m:..8#_....v|
-00000190  12 73 26 17 30 e0 21 f1  16 8f a1 e5 6d f0 21 a8  |.s&.0.!.....m.!.|
-000001a0  c6 25 64 86 95 5e 6f 4d  21 f0 f3 a3 27 23 2b 4b  |.%d..^oM!...'#+K|
-000001b0  90 03 ba 6c ce 9c 20 ed  69 15 76 cb 39 bc fd 44  |...l.. .i.v.9..D|
-000001c0  10 b4 72 d5 44 9d f7 eb  a4 b0 d5 07 20 a1 6b 71  |..r.D....... .kq|
-000001d0  16 e4 f7 8f a0 d8 fa 86  db e6 ef eb 63 41 a0 17  |............cA..|
-000001e0  83 71 0d 1c 4b ec 58 c3  90 9c ea 34 79 a7 91 43  |.q..K.X....4y..C|
-000001f0  ad 3d ff 28 c8 b4 3e 7a  b6 83 53 f4 99 0b 86 bc  |.=.(..>z..S.....|
-00000200  f2 cf ae 1d a7 5c 7f 57  d9 85 95 25 33 bb 4d 79  |.....\.W...%3.My|
-00000210  25 2e 54 6d 5d 14 32 68  7d 6e 45 bd b1 e1 24 30  |%.Tm].2h}nE...$0|
-00000220  c2 1c 45 b9 a2 42 ae b5  c6 6a 56 f9 8a 12 51 f9  |..E..B...jV...Q.|
-00000230  61 a2 9d 56 98 09 8d ea  70 17 48 d8 23 48 ca 18  |a..V....p.H.#H..|
-00000240  43 1e a2 bc 88 69 3d 45  95 89 cc f0 74 8d 88 36  |C....i=E....t..6|
-00000250  5e a8 1b be 88 41 35 8d  de a9 20 23 f3 5e ab c9  |^....A5... #.^..|
-00000260  61 22 2e 86 54 2f c4 4a  60 04 c2 e3 b8 cf 1a 41  |a"..T/.J`......A|
-00000270  a6 31 ab 7a b5 07 dc 54  82 89 b1 1f 9f 62 98 bc  |.1.z...T.....b..|
-00000280  bd 39 be 23 ed d5 bc 0d  8e a6 69 14 26 39 fe ed  |.9.#......i.&9..|
-00000290  98 c8 48 36 6c 8e 9f 93  57 7a ba 33 03 35 c6 de  |..H6l...Wz.3.5..|
-000002a0  55 03 63 e8 a4 53 08 0a  b0 a7 3e a3 cb f2 df 3d  |U.c..S....>....=|
-000002b0  cd 59 df ee f6 45 2d 77  39 32 4a 1f 08 21 e7 db  |.Y...E-w92J..!..|
-000002c0  52 2a 06 86 e6 00 98 ca  9f a3 ad 0f 7f d3 25 6d  |R*............%m|
-000002d0  56 58 21 e2 39 59 56 15  74 4d 18 37 f5 40 29 db  |VX!.9YV.tM.7.@).|
-000002e0  de be 49 77 e0 2c 5c 6b  ee b1 bd 4a ea 2a 07 94  |..Iw.,\k...J.*..|
-000002f0  0f 21 7c bb 1f bd 3e ad  9e b6 95 7d 16 e8 f0 4e  |.!|...>....}...N|
-00000300  de e2 ca 9c 34 9f b8 e5  57 d5 b7 b5 8d 60 dd c2  |....4...W....`..|
-00000310  ce 47 2c 17 03 03 00 99  37 37 20 49 98 44 f6 b4  |.G,.....77 I.D..|
-00000320  58 54 ff 5e b0 05 22 8e  c6 68 9a ae 49 51 e9 f1  |XT.^.."..h..IQ..|
-00000330  71 75 cf 1a 79 da 33 f1  5f 7e a1 02 81 05 12 8b  |qu..y.3._~......|
-00000340  a3 a8 ad 87 ee f0 87 da  f1 16 80 9d 2e fa 5a 22  |..............Z"|
-00000350  a5 f5 b9 14 f5 8f 9b 35  87 ba 1a f7 c4 17 c8 f6  |.......5........|
-00000360  a1 1e 28 cd fe 03 90 9f  f0 81 d3 80 bb 4c 1a b1  |..(..........L..|
-00000370  c6 11 de 19 a1 5a 3c 73  77 f0 70 b8 d1 38 16 f3  |.....Z<sw.p..8..|
-00000380  64 d0 8e 9c fe 4d 83 48  dc 20 78 db 6a 65 3f f4  |d....M.H. x.je?.|
-00000390  0f a0 70 cc 30 bb cd 86  51 0c 20 ea 59 a5 ed e8  |..p.0...Q. .Y...|
-000003a0  72 d9 5e f3 c3 41 0b 19  f3 97 0f fc 77 42 6d 15  |r.^..A......wBm.|
-000003b0  92 17 03 03 00 35 ac 97  30 a0 8a d8 d2 e6 4a 5b  |.....5..0.....J[|
-000003c0  f5 58 32 22 63 8e 36 2e  21 a2 30 33 ae 49 55 76  |.X2"c.6.!.03.IUv|
-000003d0  cf c8 b3 3f 82 8d c3 0e  ea 22 ec 8f 65 c8 c4 0d  |...?....."..e...|
-000003e0  bf cc 6a 86 e9 32 50 db  02 93 ec                 |..j..2P....|
+00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 a0  |..+.....3.$... .|
+00000060  72 12 62 31 e2 99 77 93  96 75 a3 64 33 87 33 ab  |r.b1..w..u.d3.3.|
+00000070  be 61 78 45 34 c4 e7 14  d0 c1 3b cc bb cc 78 14  |.axE4.....;...x.|
+00000080  03 03 00 01 01 17 03 03  00 17 13 0e ae 6e fd 8b  |.............n..|
+00000090  f0 27 06 82 41 f5 68 63  1c 58 38 ad 3a 9e 59 4d  |.'..A.hc.X8.:.YM|
+000000a0  49 17 03 03 02 6d d8 a3  1c 91 84 93 3d 8d 27 4e  |I....m......=.'N|
+000000b0  70 a7 fd ac be cb 87 bc  20 19 ef c3 1a be ad b2  |p....... .......|
+000000c0  b2 9d 4a e8 00 31 81 e0  43 09 4a b4 90 cc 1a d5  |..J..1..C.J.....|
+000000d0  e9 47 56 64 cc e6 cc 3e  fa a6 a9 8f 79 0c ea 47  |.GVd...>....y..G|
+000000e0  55 5c 29 1a 3c ce 32 ea  45 30 66 01 07 30 22 60  |U\).<.2.E0f..0"`|
+000000f0  a0 2b 63 40 29 18 a2 7f  81 bd af 6a dd a9 44 8f  |.+c@)......j..D.|
+00000100  d3 e8 58 8d 63 11 00 e2  31 9f 98 3c 15 a0 8b 9e  |..X.c...1..<....|
+00000110  61 12 df a8 87 b5 2e 81  41 ed 3b a6 12 77 05 69  |a.......A.;..w.i|
+00000120  09 d1 9d cb 56 ee 86 24  cc ac 4c ff 17 b6 99 a2  |....V..$..L.....|
+00000130  c9 22 8a 9c 07 b3 a6 72  aa 33 30 8e 42 18 1d af  |.".....r.30.B...|
+00000140  73 a5 28 99 12 05 bd 5e  34 cc 72 9a e4 51 2d 46  |s.(....^4.r..Q-F|
+00000150  35 55 8d 7b f3 ce f5 50  43 70 f1 4a ea 92 eb bd  |5U.{...PCp.J....|
+00000160  18 72 b4 e9 90 fe e2 18  64 61 20 02 18 78 e8 75  |.r......da ..x.u|
+00000170  33 00 ff cc 72 f2 89 0e  fe 7d 7a 07 f8 64 95 6f  |3...r....}z..d.o|
+00000180  0b 3b 76 96 8f c1 d9 9f  6b 1a 10 28 d7 94 36 dc  |.;v.....k..(..6.|
+00000190  87 de f2 95 a3 f6 15 44  13 2e 0d 88 aa 86 10 38  |.......D.......8|
+000001a0  ff 5f 58 a9 b8 e0 b9 4c  fb a6 bb 1f f5 f6 25 4c  |._X....L......%L|
+000001b0  d5 ab bb 62 70 82 7f 47  5e 05 99 aa 1c d4 12 be  |...bp..G^.......|
+000001c0  77 2c 67 a3 5f 6c 9f 93  37 36 5f 96 34 8e 22 9d  |w,g._l..76_.4.".|
+000001d0  a4 5e 4f 8c ce 54 e7 ea  7c 40 f5 9b 20 84 2e 96  |.^O..T..|@.. ...|
+000001e0  32 37 6b 65 cf e8 0d cb  3b 54 67 32 ed f6 49 b9  |27ke....;Tg2..I.|
+000001f0  d0 4f 36 e6 8a 1c df 35  ee 8a be 3f 8f 5a c9 35  |.O6....5...?.Z.5|
+00000200  3d 1b 7e 78 e4 0a d6 f4  6d 3e 48 dc 0d 4e 03 47  |=.~x....m>H..N.G|
+00000210  81 db 60 a9 fb 17 8c 39  5e 7d 77 07 21 13 3b 53  |..`....9^}w.!.;S|
+00000220  f2 50 bb c3 16 37 24 b8  ef 4a 45 ad 3e ce 05 6a  |.P...7$..JE.>..j|
+00000230  25 fa 27 05 c8 f9 c5 d5  c3 b0 82 a8 0c ca ef 66  |%.'............f|
+00000240  58 a4 51 85 ee 94 2a 07  d9 a4 e5 1a b9 b8 9d a1  |X.Q...*.........|
+00000250  42 ae 3c 01 dc c2 96 84  a6 bd e4 e2 e6 37 f4 16  |B.<..........7..|
+00000260  51 62 9c ce 26 d5 fe ce  69 7a f5 dd f2 b9 7c d5  |Qb..&...iz....|.|
+00000270  9f 9d f6 ca d2 a3 3b 9d  73 99 72 38 3b be 3e 93  |......;.s.r8;.>.|
+00000280  d1 81 19 76 10 25 5b f7  3b b9 c3 21 b5 ef 1b 09  |...v.%[.;..!....|
+00000290  a5 97 76 a2 b6 4e a7 9e  9c b5 0a 9a a4 99 ec 5c  |..v..N.........\|
+000002a0  02 fc 1a 83 b8 a2 f1 a5  16 0f 09 7a 21 2b 75 cd  |...........z!+u.|
+000002b0  23 b5 cc 29 d5 09 3a 5e  88 9b 6b 4f 41 30 2a 42  |#..)..:^..kOA0*B|
+000002c0  03 98 56 2b 19 da e0 6f  5b f0 ee b9 a0 3d 98 12  |..V+...o[....=..|
+000002d0  41 af 96 ee 1c ae 55 84  b4 c5 98 f7 50 a7 62 cd  |A.....U.....P.b.|
+000002e0  d7 99 4f be c8 65 fa 64  a3 2b bd b2 cc 9a 96 89  |..O..e.d.+......|
+000002f0  bb 9a 78 8f 60 5f 37 12  96 28 21 3d b5 0f 9c 3e  |..x.`_7..(!=...>|
+00000300  ce 74 8b 9a 66 f0 ef af  38 1e 07 8e ca 6f 5a 35  |.t..f...8....oZ5|
+00000310  c9 87 71 17 03 03 00 99  c1 76 e9 d2 52 3f 6d 1b  |..q......v..R?m.|
+00000320  ca eb 7d 24 2e c9 12 1b  44 f0 9c 06 95 26 d0 a3  |..}$....D....&..|
+00000330  04 e1 f1 8f e4 c0 83 91  e2 cf da 6c a1 b3 87 05  |...........l....|
+00000340  18 ae f1 7f 8d d3 43 9a  f9 a8 9e 73 89 1a 61 2d  |......C....s..a-|
+00000350  4f 2b 33 0b fd c0 12 0e  d2 32 06 52 26 99 1d ce  |O+3......2.R&...|
+00000360  49 11 a2 ec 23 ad 7f 22  1f 6e c6 12 21 f3 56 1c  |I...#..".n..!.V.|
+00000370  fe d1 32 dd 1f b5 36 5d  e3 78 fb 9c 3e 74 00 aa  |..2...6].x..>t..|
+00000380  9d fd 92 f8 45 f9 1f e8  c3 4d 89 a8 91 d0 6c 2c  |....E....M....l,|
+00000390  4f 82 52 f4 43 b0 1b fa  16 75 a4 78 f9 24 d1 3a  |O.R.C....u.x.$.:|
+000003a0  1e 6b 97 6f 0e 3d bb 34  b3 0a 83 2f 56 88 b8 0e  |.k.o.=.4.../V...|
+000003b0  90 17 03 03 00 35 cd f0  e5 f9 3f 62 e7 67 25 5f  |.....5....?b.g%_|
+000003c0  4f 11 d9 d9 d0 e3 3b 9a  a9 c0 27 1d d3 a4 06 1f  |O.....;...'.....|
+000003d0  8d 61 b4 38 aa fe fd f8  6c 10 57 b6 7d 9c 92 96  |.a.8....l.W.}...|
+000003e0  c9 70 c2 67 a7 76 7d bb  ab 0e 2d                 |.p.g.v}...-|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 e5 27 80 72 fd  |..........5.'.r.|
-00000010  6c 0d b5 a7 14 23 08 0b  f5 54 70 8c 29 61 d0 2a  |l....#...Tp.)a.*|
-00000020  81 2d 05 83 2a 21 1e 16  94 5b 65 0d 6a ca b6 81  |.-..*!...[e.j...|
-00000030  d9 9d 3c 5c 9c fe 2b 01  a8 3b 23 fb 9e eb 2c 56  |..<\..+..;#...,V|
-00000040  17 03 03 00 17 79 fd 43  29 72 96 e0 ad fd 7e 60  |.....y.C)r....~`|
-00000050  94 51 8d 8a 6e 6a 5d 6c  f3 0d 4b 74 17 03 03 00  |.Q..nj]l..Kt....|
-00000060  13 a4 7c e1 31 71 61 82  e7 7d 28 0f 63 d7 ae 76  |..|.1qa..}(.c..v|
-00000070  9c 71 37 cd                                       |.q7.|
+00000000  14 03 03 00 01 01 17 03  03 00 35 7d 7c fa 64 ea  |..........5}|.d.|
+00000010  ba 90 be e8 a7 0c 0c 48  10 fc 2d ac 5e dd 1c cf  |.......H..-.^...|
+00000020  e8 d3 d9 98 3b c2 2b 80  93 44 22 85 bf cb ec c6  |....;.+..D".....|
+00000030  4a 13 6d 68 80 22 8b af  aa f4 7c de 6b 28 fe ef  |J.mh."....|.k(..|
+00000040  17 03 03 00 17 4e bd e5  fe 5c 6b 9c bb 48 b8 23  |.....N...\k..H.#|
+00000050  55 0f f7 21 25 cb 4c ae  74 b7 54 a2 17 03 03 00  |U..!%.L.t.T.....|
+00000060  13 c8 35 e9 be f6 74 09  23 55 ec 78 05 83 89 38  |..5...t.#U.x...8|
+00000070  ee 1c b3 3e                                       |...>|
diff --git a/src/crypto/tls/testdata/Server-TLSv10-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Server-TLSv10-ECDHE-ECDSA-AES
index c8f11ea609..c5d947c2ce 100644
--- a/src/crypto/tls/testdata/Server-TLSv10-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Server-TLSv10-ECDHE-ECDSA-AES
@@ -1,79 +1,79 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 51 01 00 00  4d 03 01 8a c0 af 21 2c  |....Q...M.....!,|
-00000010  ff 48 d6 fd 10 92 4a 8c  84 c7 9e c3 90 3a f5 bf  |.H....J......:..|
-00000020  cd 36 1b 2f 96 8b 13 86  f1 ff 5e 00 00 04 c0 0a  |.6./......^.....|
+00000000  16 03 01 00 51 01 00 00  4d 03 01 5e bf ff e7 c2  |....Q...M..^....|
+00000010  c1 98 4a a3 cf 5a e8 8d  8f 19 9e 85 48 5b 92 cc  |..J..Z......H[..|
+00000020  7d 0c 14 1e 2e 50 5b d7  dd fe ef 00 00 04 c0 0a  |}....P[.........|
 00000030  00 ff 01 00 00 20 00 0b  00 04 03 00 01 02 00 0a  |..... ..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000050  00 00 00 17 00 00                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 37 02 00 00  33 03 01 00 00 00 00 00  |....7...3.......|
+00000000  16 03 01 00 3b 02 00 00  37 03 01 00 00 00 00 00  |....;...7.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 00 00 c0 0a 00 00  |...DOWNGRD......|
-00000030  0b ff 01 00 01 00 00 0b  00 02 01 00 16 03 01 02  |................|
-00000040  0e 0b 00 02 0a 00 02 07  00 02 04 30 82 02 00 30  |...........0...0|
-00000050  82 01 62 02 09 00 b8 bf  2d 47 a0 d2 eb f4 30 09  |..b.....-G....0.|
-00000060  06 07 2a 86 48 ce 3d 04  01 30 45 31 0b 30 09 06  |..*.H.=..0E1.0..|
-00000070  03 55 04 06 13 02 41 55  31 13 30 11 06 03 55 04  |.U....AU1.0...U.|
-00000080  08 13 0a 53 6f 6d 65 2d  53 74 61 74 65 31 21 30  |...Some-State1!0|
-00000090  1f 06 03 55 04 0a 13 18  49 6e 74 65 72 6e 65 74  |...U....Internet|
-000000a0  20 57 69 64 67 69 74 73  20 50 74 79 20 4c 74 64  | Widgits Pty Ltd|
-000000b0  30 1e 17 0d 31 32 31 31  32 32 31 35 30 36 33 32  |0...121122150632|
-000000c0  5a 17 0d 32 32 31 31 32  30 31 35 30 36 33 32 5a  |Z..221120150632Z|
-000000d0  30 45 31 0b 30 09 06 03  55 04 06 13 02 41 55 31  |0E1.0...U....AU1|
-000000e0  13 30 11 06 03 55 04 08  13 0a 53 6f 6d 65 2d 53  |.0...U....Some-S|
-000000f0  74 61 74 65 31 21 30 1f  06 03 55 04 0a 13 18 49  |tate1!0...U....I|
-00000100  6e 74 65 72 6e 65 74 20  57 69 64 67 69 74 73 20  |nternet Widgits |
-00000110  50 74 79 20 4c 74 64 30  81 9b 30 10 06 07 2a 86  |Pty Ltd0..0...*.|
-00000120  48 ce 3d 02 01 06 05 2b  81 04 00 23 03 81 86 00  |H.=....+...#....|
-00000130  04 00 c4 a1 ed be 98 f9  0b 48 73 36 7e c3 16 56  |.........Hs6~..V|
-00000140  11 22 f2 3d 53 c3 3b 4d  21 3d cd 6b 75 e6 f6 b0  |.".=S.;M!=.ku...|
-00000150  dc 9a df 26 c1 bc b2 87  f0 72 32 7c b3 64 2f 1c  |...&.....r2|.d/.|
-00000160  90 bc ea 68 23 10 7e fe  e3 25 c0 48 3a 69 e0 28  |...h#.~..%.H:i.(|
-00000170  6d d3 37 00 ef 04 62 dd  0d a0 9c 70 62 83 d8 81  |m.7...b....pb...|
-00000180  d3 64 31 aa 9e 97 31 bd  96 b0 68 c0 9b 23 de 76  |.d1...1...h..#.v|
-00000190  64 3f 1a 5c 7f e9 12 0e  58 58 b6 5f 70 dd 9b d8  |d?.\....XX._p...|
-000001a0  ea d5 d7 f5 d5 cc b9 b6  9f 30 66 5b 66 9a 20 e2  |.........0f[f. .|
-000001b0  27 e5 bf fe 3b 30 09 06  07 2a 86 48 ce 3d 04 01  |'...;0...*.H.=..|
-000001c0  03 81 8c 00 30 81 88 02  42 01 88 a2 4f eb e2 45  |....0...B...O..E|
-000001d0  c5 48 7d 1b ac f5 ed 98  9d ae 47 70 c0 5e 1b b6  |.H}.......Gp.^..|
-000001e0  2f bd f1 b6 4d b7 61 40  d3 11 a2 ce ee 0b 7e 92  |/...M.a@......~.|
-000001f0  7e ff 76 9d c3 3b 7e a5  3f ce fa 10 e2 59 ec 47  |~.v..;~.?....Y.G|
-00000200  2d 7c ac da 4e 97 0e 15  a0 6f d0 02 42 01 4d fc  |-|..N....o..B.M.|
-00000210  be 67 13 9c 2d 05 0e bd  3f a3 8c 25 c1 33 13 83  |.g..-...?..%.3..|
-00000220  0d 94 06 bb d4 37 7a f6  ec 7a c9 86 2e dd d7 11  |.....7z..z......|
-00000230  69 7f 85 7c 56 de fb 31  78 2b e4 c7 78 0d ae cb  |i..|V..1x+..x...|
-00000240  be 9e 4e 36 24 31 7b 6a  0f 39 95 12 07 8f 2a 16  |..N6$1{j.9....*.|
-00000250  03 01 00 b4 0c 00 00 b0  03 00 1d 20 2f e5 7d a3  |........... /.}.|
-00000260  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
-00000270  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 00 8a 30 81  |......._X.;t..0.|
-00000280  87 02 42 01 ea 1b 6f 67  3e cd 57 50 12 78 5a db  |..B...og>.WP.xZ.|
-00000290  06 12 77 04 9d df 0c b0  98 4b a7 e8 23 fb ad 46  |..w......K..#..F|
-000002a0  ef 9b 99 d3 02 4b 46 51  c4 49 2a ae 29 b4 a7 e5  |.....KFQ.I*.)...|
-000002b0  08 d0 db ce 28 af 21 43  37 d4 29 03 00 e3 5f 50  |....(.!C7.)..._P|
-000002c0  35 cd 0a 3f 9d 02 41 35  05 7c a0 ed 81 23 98 38  |5..?..A5.|...#.8|
-000002d0  af 2c 12 8f 59 94 77 c7  56 ef 0b db 60 d0 5b 72  |.,..Y.w.V...`.[r|
-000002e0  9e fd 2a 6c ea 1d af cb  ce 5b df 34 52 2a 4b 38  |..*l.....[.4R*K8|
-000002f0  48 81 2c 39 76 61 58 19  80 1b e0 eb fb 53 35 94  |H.,9vaX......S5.|
-00000300  55 ba a6 2b a2 b3 50 b4  16 03 01 00 04 0e 00 00  |U..+..P.........|
-00000310  00                                                |.|
+00000030  0f ff 01 00 01 00 00 17  00 00 00 0b 00 02 01 00  |................|
+00000040  16 03 01 02 0e 0b 00 02  0a 00 02 07 00 02 04 30  |...............0|
+00000050  82 02 00 30 82 01 62 02  09 00 b8 bf 2d 47 a0 d2  |...0..b.....-G..|
+00000060  eb f4 30 09 06 07 2a 86  48 ce 3d 04 01 30 45 31  |..0...*.H.=..0E1|
+00000070  0b 30 09 06 03 55 04 06  13 02 41 55 31 13 30 11  |.0...U....AU1.0.|
+00000080  06 03 55 04 08 13 0a 53  6f 6d 65 2d 53 74 61 74  |..U....Some-Stat|
+00000090  65 31 21 30 1f 06 03 55  04 0a 13 18 49 6e 74 65  |e1!0...U....Inte|
+000000a0  72 6e 65 74 20 57 69 64  67 69 74 73 20 50 74 79  |rnet Widgits Pty|
+000000b0  20 4c 74 64 30 1e 17 0d  31 32 31 31 32 32 31 35  | Ltd0...12112215|
+000000c0  30 36 33 32 5a 17 0d 32  32 31 31 32 30 31 35 30  |0632Z..221120150|
+000000d0  36 33 32 5a 30 45 31 0b  30 09 06 03 55 04 06 13  |632Z0E1.0...U...|
+000000e0  02 41 55 31 13 30 11 06  03 55 04 08 13 0a 53 6f  |.AU1.0...U....So|
+000000f0  6d 65 2d 53 74 61 74 65  31 21 30 1f 06 03 55 04  |me-State1!0...U.|
+00000100  0a 13 18 49 6e 74 65 72  6e 65 74 20 57 69 64 67  |...Internet Widg|
+00000110  69 74 73 20 50 74 79 20  4c 74 64 30 81 9b 30 10  |its Pty Ltd0..0.|
+00000120  06 07 2a 86 48 ce 3d 02  01 06 05 2b 81 04 00 23  |..*.H.=....+...#|
+00000130  03 81 86 00 04 00 c4 a1  ed be 98 f9 0b 48 73 36  |.............Hs6|
+00000140  7e c3 16 56 11 22 f2 3d  53 c3 3b 4d 21 3d cd 6b  |~..V.".=S.;M!=.k|
+00000150  75 e6 f6 b0 dc 9a df 26  c1 bc b2 87 f0 72 32 7c  |u......&.....r2||
+00000160  b3 64 2f 1c 90 bc ea 68  23 10 7e fe e3 25 c0 48  |.d/....h#.~..%.H|
+00000170  3a 69 e0 28 6d d3 37 00  ef 04 62 dd 0d a0 9c 70  |:i.(m.7...b....p|
+00000180  62 83 d8 81 d3 64 31 aa  9e 97 31 bd 96 b0 68 c0  |b....d1...1...h.|
+00000190  9b 23 de 76 64 3f 1a 5c  7f e9 12 0e 58 58 b6 5f  |.#.vd?.\....XX._|
+000001a0  70 dd 9b d8 ea d5 d7 f5  d5 cc b9 b6 9f 30 66 5b  |p............0f[|
+000001b0  66 9a 20 e2 27 e5 bf fe  3b 30 09 06 07 2a 86 48  |f. .'...;0...*.H|
+000001c0  ce 3d 04 01 03 81 8c 00  30 81 88 02 42 01 88 a2  |.=......0...B...|
+000001d0  4f eb e2 45 c5 48 7d 1b  ac f5 ed 98 9d ae 47 70  |O..E.H}.......Gp|
+000001e0  c0 5e 1b b6 2f bd f1 b6  4d b7 61 40 d3 11 a2 ce  |.^../...M.a@....|
+000001f0  ee 0b 7e 92 7e ff 76 9d  c3 3b 7e a5 3f ce fa 10  |..~.~.v..;~.?...|
+00000200  e2 59 ec 47 2d 7c ac da  4e 97 0e 15 a0 6f d0 02  |.Y.G-|..N....o..|
+00000210  42 01 4d fc be 67 13 9c  2d 05 0e bd 3f a3 8c 25  |B.M..g..-...?..%|
+00000220  c1 33 13 83 0d 94 06 bb  d4 37 7a f6 ec 7a c9 86  |.3.......7z..z..|
+00000230  2e dd d7 11 69 7f 85 7c  56 de fb 31 78 2b e4 c7  |....i..|V..1x+..|
+00000240  78 0d ae cb be 9e 4e 36  24 31 7b 6a 0f 39 95 12  |x.....N6$1{j.9..|
+00000250  07 8f 2a 16 03 01 00 b5  0c 00 00 b1 03 00 1d 20  |..*............ |
+00000260  2f e5 7d a3 47 cd 62 43  15 28 da ac 5f bb 29 07  |/.}.G.bC.(.._.).|
+00000270  30 ff f6 84 af c4 cf c2  ed 90 99 5f 58 cb 3b 74  |0.........._X.;t|
+00000280  00 8b 30 81 88 02 42 00  c3 eb 60 b8 d3 af cb 2d  |..0...B...`....-|
+00000290  4f ca 46 6d e4 fe 47 41  82 1e d4 14 0f 08 ab b6  |O.Fm..GA........|
+000002a0  b8 41 8b 46 f5 28 bb 87  28 73 a0 5c e9 ce f5 56  |.A.F.(..(s.\...V|
+000002b0  11 02 17 2c 39 b6 28 6c  ec de 12 bf 22 91 3d 06  |...,9.(l....".=.|
+000002c0  ac 8e 0a 92 b1 46 69 86  44 02 42 01 fd 70 6e 63  |.....Fi.D.B..pnc|
+000002d0  1b 2a 21 47 9b 42 9c d4  4a 38 20 dd 94 05 c4 0f  |.*!G.B..J8 .....|
+000002e0  5d b2 48 c8 17 90 01 4d  4f 7e 7a ef bb b2 5b 26  |].H....MO~z...[&|
+000002f0  7e e1 24 f5 80 93 69 72  3f cf bb 5d 52 ee ec b4  |~.$...ir?..]R...|
+00000300  cc 0c 96 1f 93 4c d6 a8  c7 b2 91 f5 6d 16 03 01  |.....L......m...|
+00000310  00 04 0e 00 00 00                                 |......|
 >>> Flow 3 (client to server)
-00000000  16 03 01 00 25 10 00 00  21 20 29 f2 f2 54 f4 ff  |....%...! )..T..|
-00000010  59 de df ab 55 18 04 cd  8c 27 28 7e 11 11 09 84  |Y...U....'(~....|
-00000020  18 e1 0f 09 70 f8 d7 13  a1 38 14 03 01 00 01 01  |....p....8......|
-00000030  16 03 01 00 30 d8 40 dc  30 cb d6 25 de 23 01 84  |....0.@.0..%.#..|
-00000040  30 75 1c 17 bd f3 fe 7e  b4 cd 61 f3 55 c4 30 55  |0u.....~..a.U.0U|
-00000050  ee 43 6f f0 6b a7 0a ed  88 d9 d4 72 7c c7 c6 c7  |.Co.k......r|...|
-00000060  4d 2f 7b 9f 9b                                    |M/{..|
+00000000  16 03 01 00 25 10 00 00  21 20 ec f2 2d ca 02 ce  |....%...! ..-...|
+00000010  11 2d eb 26 d7 d9 fc b2  a7 2d 34 5b a9 3a 0b 2f  |.-.&.....-4[.:./|
+00000020  5c 49 a9 69 1a 3a 83 90  ec 5f 14 03 01 00 01 01  |\I.i.:..._......|
+00000030  16 03 01 00 30 9f 06 c7  a7 a0 c3 a5 3d 60 6e fb  |....0.......=`n.|
+00000040  c6 18 a4 d2 80 2e ad 8f  cf 92 84 94 36 f8 81 28  |............6..(|
+00000050  c5 3f 37 e8 d6 e7 6d a3  f5 32 63 a0 ab 7a db 12  |.?7...m..2c..z..|
+00000060  17 e1 e4 33 d6                                    |...3.|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 60 b7 c0 a3 ba  |..........0`....|
-00000010  ad dd 52 99 15 7a f2 9e  10 21 02 7c 91 6d cf c9  |..R..z...!.|.m..|
-00000020  09 ab fe 9c b3 46 46 60  1c 24 66 3f b6 14 b1 51  |.....FF`.$f?...Q|
-00000030  ac 05 75 48 03 c1 e0 3a  c2 6d 5e 17 03 01 00 20  |..uH...:.m^.... |
-00000040  82 87 18 81 c3 24 55 8f  9c a3 49 fc 8a 8a 7a fe  |.....$U...I...z.|
-00000050  93 05 c9 7e 90 73 a4 b1  0a d7 3b 7d 72 1f fc 6c  |...~.s....;}r..l|
-00000060  17 03 01 00 30 1f 51 a5  44 2e 7a 40 12 43 28 c6  |....0.Q.D.z@.C(.|
-00000070  99 05 6d 92 d9 ed 0d f2  fb a7 48 a3 03 e9 34 b1  |..m.......H...4.|
-00000080  52 32 e1 be a9 7e bf b1  0e 1f b4 1c 3e 0a 9d d9  |R2...~......>...|
-00000090  90 10 4f 79 dd 15 03 01  00 20 57 98 fd dd 09 f9  |..Oy..... W.....|
-000000a0  c5 d9 33 24 1a b2 ed 56  ad 91 c9 25 2f ff ff 09  |..3$...V...%/...|
-000000b0  dc b0 2c 38 cc 70 1f cc  6f f4                    |..,8.p..o.|
+00000000  14 03 01 00 01 01 16 03  01 00 30 18 29 35 d7 c5  |..........0.)5..|
+00000010  a2 31 3b 26 85 de 50 26  39 4d 16 22 58 a2 17 bd  |.1;&..P&9M."X...|
+00000020  4b 73 33 8d dc 3f 92 20  f2 ca 22 00 f5 31 db a7  |Ks3..?. .."..1..|
+00000030  18 79 fc 71 87 68 a5 1d  a6 db 33 17 03 01 00 20  |.y.q.h....3.... |
+00000040  0d be 57 e4 12 6d 2d 3a  33 24 a0 0c c4 9b 27 09  |..W..m-:3$....'.|
+00000050  85 e0 0e 42 04 79 21 9a  bf 47 fa 0b 38 1a ce 8f  |...B.y!..G..8...|
+00000060  17 03 01 00 30 6d 27 f1  9b cf 55 4d 65 48 38 1b  |....0m'...UMeH8.|
+00000070  d9 dd 1d 5b 81 2f 10 a5  65 28 83 93 b3 b1 3a 72  |...[./..e(....:r|
+00000080  f0 15 9a e5 9f 21 80 f1  59 a5 0e f1 0c 2b d1 0c  |.....!..Y....+..|
+00000090  d4 27 73 f3 7e 15 03 01  00 20 6f 08 27 3a d2 60  |.'s.~.... o.':.`|
+000000a0  c3 27 bc 73 55 bb 43 53  e2 e0 87 16 ca 8f 49 f0  |.'.sU.CS......I.|
+000000b0  88 a8 20 30 9d 42 86 d9  c3 36                    |.. 0.B...6|
diff --git a/src/crypto/tls/testdata/Server-TLSv10-ExportKeyingMaterial b/src/crypto/tls/testdata/Server-TLSv10-ExportKeyingMaterial
index d16e1d6970..f7ed87e11d 100644
--- a/src/crypto/tls/testdata/Server-TLSv10-ExportKeyingMaterial
+++ b/src/crypto/tls/testdata/Server-TLSv10-ExportKeyingMaterial
@@ -1,91 +1,91 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 55 01 00 00  51 03 01 4a 04 66 d2 7b  |....U...Q..J.f.{|
-00000010  6f 41 ef b3 5f b2 ba af  1f 0e c8 26 93 2b 2b 83  |oA.._......&.++.|
-00000020  75 69 94 8f 6d c7 bf c6  c9 37 2d 00 00 04 c0 14  |ui..m....7-.....|
+00000000  16 03 01 00 55 01 00 00  51 03 01 54 7a 09 27 8a  |....U...Q..Tz.'.|
+00000010  6a c8 54 3b 44 9b c7 56  8b 5c 7d 93 28 f9 06 f2  |j.T;D..V.\}.(...|
+00000020  73 7a a8 0b cd 80 1f 84  2c 3d 60 00 00 04 c0 14  |sz......,=`.....|
 00000030  00 ff 01 00 00 24 00 0b  00 04 03 00 01 02 00 0a  |.....$..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000050  00 00 00 16 00 00 00 17  00 00                    |..........|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 3b 02 00 00  37 03 01 00 00 00 00 00  |....;...7.......|
+00000000  16 03 01 00 3f 02 00 00  3b 03 01 00 00 00 00 00  |....?...;.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 00 00 c0 14 00 00  |...DOWNGRD......|
-00000030  0f 00 23 00 00 ff 01 00  01 00 00 0b 00 02 01 00  |..#.............|
-00000040  16 03 01 02 59 0b 00 02  55 00 02 52 00 02 4f 30  |....Y...U..R..O0|
-00000050  82 02 4b 30 82 01 b4 a0  03 02 01 02 02 09 00 e8  |..K0............|
-00000060  f0 9d 3f e2 5b ea a6 30  0d 06 09 2a 86 48 86 f7  |..?.[..0...*.H..|
-00000070  0d 01 01 0b 05 00 30 1f  31 0b 30 09 06 03 55 04  |......0.1.0...U.|
-00000080  0a 13 02 47 6f 31 10 30  0e 06 03 55 04 03 13 07  |...Go1.0...U....|
-00000090  47 6f 20 52 6f 6f 74 30  1e 17 0d 31 36 30 31 30  |Go Root0...16010|
-000000a0  31 30 30 30 30 30 30 5a  17 0d 32 35 30 31 30 31  |1000000Z..250101|
-000000b0  30 30 30 30 30 30 5a 30  1a 31 0b 30 09 06 03 55  |000000Z0.1.0...U|
-000000c0  04 0a 13 02 47 6f 31 0b  30 09 06 03 55 04 03 13  |....Go1.0...U...|
-000000d0  02 47 6f 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |.Go0..0...*.H...|
-000000e0  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
-000000f0  db 46 7d 93 2e 12 27 06  48 bc 06 28 21 ab 7e c4  |.F}...'.H..(!.~.|
-00000100  b6 a2 5d fe 1e 52 45 88  7a 36 47 a5 08 0d 92 42  |..]..RE.z6G....B|
-00000110  5b c2 81 c0 be 97 79 98  40 fb 4f 6d 14 fd 2b 13  |[.....y.@.Om..+.|
-00000120  8b c2 a5 2e 67 d8 d4 09  9e d6 22 38 b7 4a 0b 74  |....g....."8.J.t|
-00000130  73 2b c2 34 f1 d1 93 e5  96 d9 74 7b f3 58 9f 6c  |s+.4......t{.X.l|
-00000140  61 3c c0 b0 41 d4 d9 2b  2b 24 23 77 5b 1c 3b bd  |a<..A..++$#w[.;.|
-00000150  75 5d ce 20 54 cf a1 63  87 1d 1e 24 c4 f3 1d 1a  |u]. T..c...$....|
-00000160  50 8b aa b6 14 43 ed 97  a7 75 62 f4 14 c8 52 d7  |P....C...ub...R.|
-00000170  02 03 01 00 01 a3 81 93  30 81 90 30 0e 06 03 55  |........0..0...U|
-00000180  1d 0f 01 01 ff 04 04 03  02 05 a0 30 1d 06 03 55  |...........0...U|
-00000190  1d 25 04 16 30 14 06 08  2b 06 01 05 05 07 03 01  |.%..0...+.......|
-000001a0  06 08 2b 06 01 05 05 07  03 02 30 0c 06 03 55 1d  |..+.......0...U.|
-000001b0  13 01 01 ff 04 02 30 00  30 19 06 03 55 1d 0e 04  |......0.0...U...|
-000001c0  12 04 10 9f 91 16 1f 43  43 3e 49 a6 de 6d b6 80  |.......CC>I..m..|
-000001d0  d7 9f 60 30 1b 06 03 55  1d 23 04 14 30 12 80 10  |..`0...U.#..0...|
-000001e0  48 13 49 4d 13 7e 16 31  bb a3 01 d5 ac ab 6e 7b  |H.IM.~.1......n{|
-000001f0  30 19 06 03 55 1d 11 04  12 30 10 82 0e 65 78 61  |0...U....0...exa|
-00000200  6d 70 6c 65 2e 67 6f 6c  61 6e 67 30 0d 06 09 2a  |mple.golang0...*|
-00000210  86 48 86 f7 0d 01 01 0b  05 00 03 81 81 00 9d 30  |.H.............0|
-00000220  cc 40 2b 5b 50 a0 61 cb  ba e5 53 58 e1 ed 83 28  |.@+[P.a...SX...(|
-00000230  a9 58 1a a9 38 a4 95 a1  ac 31 5a 1a 84 66 3d 43  |.X..8....1Z..f=C|
-00000240  d3 2d d9 0b f2 97 df d3  20 64 38 92 24 3a 00 bc  |.-...... d8.$:..|
-00000250  cf 9c 7d b7 40 20 01 5f  aa d3 16 61 09 a2 76 fd  |..}.@ ._...a..v.|
-00000260  13 c3 cc e1 0c 5c ee b1  87 82 f1 6c 04 ed 73 bb  |.....\.....l..s.|
-00000270  b3 43 77 8d 0c 1c f1 0f  a1 d8 40 83 61 c9 4c 72  |.Cw.......@.a.Lr|
-00000280  2b 9d ae db 46 06 06 4d  f4 c1 b3 3e c0 d1 bd 42  |+...F..M...>...B|
-00000290  d4 db fe 3d 13 60 84 5c  21 d3 3b e9 fa e7 16 03  |...=.`.\!.;.....|
-000002a0  01 00 aa 0c 00 00 a6 03  00 1d 20 2f e5 7d a3 47  |.......... /.}.G|
-000002b0  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
-000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 00 80 3b 7c 08  |......_X.;t..;|.|
-000002d0  03 13 a9 f1 f3 35 23 03  23 59 6a c7 1b e8 d8 39  |.....5#.#Yj....9|
-000002e0  ad 14 28 33 b8 ab 9f e8  fa 78 d6 9d d4 71 54 dc  |..(3.....x...qT.|
-000002f0  93 31 12 d3 c3 f6 f1 18  ea e1 9a d9 55 14 e3 8d  |.1..........U...|
-00000300  d1 cb b5 40 98 ef c6 bb  3d 6d ea 39 db f9 26 83  |...@....=m.9..&.|
-00000310  88 7c 71 1c f9 f2 47 f1  fc d1 b9 ae 1c d8 7b 2b  |.|q...G.......{+|
-00000320  79 8d 43 76 3d 15 17 3f  90 94 8e c7 45 ae 01 d2  |y.Cv=..?....E...|
-00000330  22 da 9d 03 f7 62 64 a5  0e 33 8b 5c d7 22 65 dd  |"....bd..3.\."e.|
-00000340  34 29 6f 20 d6 66 27 d4  27 e9 2d 5f e6 16 03 01  |4)o .f'.'.-_....|
-00000350  00 04 0e 00 00 00                                 |......|
+00000030  13 00 23 00 00 ff 01 00  01 00 00 17 00 00 00 0b  |..#.............|
+00000040  00 02 01 00 16 03 01 02  59 0b 00 02 55 00 02 52  |........Y...U..R|
+00000050  00 02 4f 30 82 02 4b 30  82 01 b4 a0 03 02 01 02  |..O0..K0........|
+00000060  02 09 00 e8 f0 9d 3f e2  5b ea a6 30 0d 06 09 2a  |......?.[..0...*|
+00000070  86 48 86 f7 0d 01 01 0b  05 00 30 1f 31 0b 30 09  |.H........0.1.0.|
+00000080  06 03 55 04 0a 13 02 47  6f 31 10 30 0e 06 03 55  |..U....Go1.0...U|
+00000090  04 03 13 07 47 6f 20 52  6f 6f 74 30 1e 17 0d 31  |....Go Root0...1|
+000000a0  36 30 31 30 31 30 30 30  30 30 30 5a 17 0d 32 35  |60101000000Z..25|
+000000b0  30 31 30 31 30 30 30 30  30 30 5a 30 1a 31 0b 30  |0101000000Z0.1.0|
+000000c0  09 06 03 55 04 0a 13 02  47 6f 31 0b 30 09 06 03  |...U....Go1.0...|
+000000d0  55 04 03 13 02 47 6f 30  81 9f 30 0d 06 09 2a 86  |U....Go0..0...*.|
+000000e0  48 86 f7 0d 01 01 01 05  00 03 81 8d 00 30 81 89  |H............0..|
+000000f0  02 81 81 00 db 46 7d 93  2e 12 27 06 48 bc 06 28  |.....F}...'.H..(|
+00000100  21 ab 7e c4 b6 a2 5d fe  1e 52 45 88 7a 36 47 a5  |!.~...]..RE.z6G.|
+00000110  08 0d 92 42 5b c2 81 c0  be 97 79 98 40 fb 4f 6d  |...B[.....y.@.Om|
+00000120  14 fd 2b 13 8b c2 a5 2e  67 d8 d4 09 9e d6 22 38  |..+.....g....."8|
+00000130  b7 4a 0b 74 73 2b c2 34  f1 d1 93 e5 96 d9 74 7b  |.J.ts+.4......t{|
+00000140  f3 58 9f 6c 61 3c c0 b0  41 d4 d9 2b 2b 24 23 77  |.X.la<..A..++$#w|
+00000150  5b 1c 3b bd 75 5d ce 20  54 cf a1 63 87 1d 1e 24  |[.;.u]. T..c...$|
+00000160  c4 f3 1d 1a 50 8b aa b6  14 43 ed 97 a7 75 62 f4  |....P....C...ub.|
+00000170  14 c8 52 d7 02 03 01 00  01 a3 81 93 30 81 90 30  |..R.........0..0|
+00000180  0e 06 03 55 1d 0f 01 01  ff 04 04 03 02 05 a0 30  |...U...........0|
+00000190  1d 06 03 55 1d 25 04 16  30 14 06 08 2b 06 01 05  |...U.%..0...+...|
+000001a0  05 07 03 01 06 08 2b 06  01 05 05 07 03 02 30 0c  |......+.......0.|
+000001b0  06 03 55 1d 13 01 01 ff  04 02 30 00 30 19 06 03  |..U.......0.0...|
+000001c0  55 1d 0e 04 12 04 10 9f  91 16 1f 43 43 3e 49 a6  |U..........CC>I.|
+000001d0  de 6d b6 80 d7 9f 60 30  1b 06 03 55 1d 23 04 14  |.m....`0...U.#..|
+000001e0  30 12 80 10 48 13 49 4d  13 7e 16 31 bb a3 01 d5  |0...H.IM.~.1....|
+000001f0  ac ab 6e 7b 30 19 06 03  55 1d 11 04 12 30 10 82  |..n{0...U....0..|
+00000200  0e 65 78 61 6d 70 6c 65  2e 67 6f 6c 61 6e 67 30  |.example.golang0|
+00000210  0d 06 09 2a 86 48 86 f7  0d 01 01 0b 05 00 03 81  |...*.H..........|
+00000220  81 00 9d 30 cc 40 2b 5b  50 a0 61 cb ba e5 53 58  |...0.@+[P.a...SX|
+00000230  e1 ed 83 28 a9 58 1a a9  38 a4 95 a1 ac 31 5a 1a  |...(.X..8....1Z.|
+00000240  84 66 3d 43 d3 2d d9 0b  f2 97 df d3 20 64 38 92  |.f=C.-...... d8.|
+00000250  24 3a 00 bc cf 9c 7d b7  40 20 01 5f aa d3 16 61  |$:....}.@ ._...a|
+00000260  09 a2 76 fd 13 c3 cc e1  0c 5c ee b1 87 82 f1 6c  |..v......\.....l|
+00000270  04 ed 73 bb b3 43 77 8d  0c 1c f1 0f a1 d8 40 83  |..s..Cw.......@.|
+00000280  61 c9 4c 72 2b 9d ae db  46 06 06 4d f4 c1 b3 3e  |a.Lr+...F..M...>|
+00000290  c0 d1 bd 42 d4 db fe 3d  13 60 84 5c 21 d3 3b e9  |...B...=.`.\!.;.|
+000002a0  fa e7 16 03 01 00 aa 0c  00 00 a6 03 00 1d 20 2f  |.............. /|
+000002b0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
+000002c0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 00  |.........._X.;t.|
+000002d0  80 1c 79 dd 1e c2 4d 33  43 41 71 93 aa 0b 1b 64  |..y...M3CAq....d|
+000002e0  b7 77 7a 10 f4 84 11 c6  be 76 31 9f 21 77 d7 96  |.wz......v1.!w..|
+000002f0  c4 f5 8a 9d 33 88 16 12  1c 76 0b e5 a6 d5 78 f5  |....3....v....x.|
+00000300  71 a0 2d bc 42 48 eb 2f  ae e2 04 6b 9f 99 fe fb  |q.-.BH./...k....|
+00000310  76 a7 a2 ae 0e d3 c8 44  16 6a bd 64 1e 3f 5d a5  |v......D.j.d.?].|
+00000320  14 8a 3a 48 55 d5 f7 3e  17 63 bc 03 60 81 3c 7c  |..:HU..>.c..`.<||
+00000330  a4 20 0d ad 6d 0e 5b 36  b7 56 66 16 d4 45 16 8e  |. ..m.[6.Vf..E..|
+00000340  21 e5 b2 9a 90 3c a6 00  ed 06 55 51 a6 d4 e4 19  |!....<....UQ....|
+00000350  b2 16 03 01 00 04 0e 00  00 00                    |..........|
 >>> Flow 3 (client to server)
-00000000  16 03 01 00 25 10 00 00  21 20 99 c5 6e 2d 41 d5  |....%...! ..n-A.|
-00000010  41 d2 c6 96 4c ff 14 10  32 46 b6 8d e8 ea 2a 89  |A...L...2F....*.|
-00000020  f1 7b 9c 59 46 c9 e1 44  0a 7f 14 03 01 00 01 01  |.{.YF..D........|
-00000030  16 03 01 00 30 ff 29 a0  25 25 53 bc fb 94 cb 4e  |....0.).%%S....N|
-00000040  9f 53 29 b5 71 46 12 9a  fb 29 b2 d8 a8 8a 13 17  |.S).qF...)......|
-00000050  dc 88 88 24 8b 16 be c4  19 11 0c 1c 9a 27 fb f7  |...$.........'..|
-00000060  da 91 98 7c c7                                    |...|.|
+00000000  16 03 01 00 25 10 00 00  21 20 4e 3c 5d a0 70 52  |....%...! N<].pR|
+00000010  39 c7 cf 06 d5 18 38 ea  ce fc 7e 07 51 29 35 d8  |9.....8...~.Q)5.|
+00000020  02 86 f0 b9 5f e8 f3 e1  69 42 14 03 01 00 01 01  |...._...iB......|
+00000030  16 03 01 00 30 92 c0 29  1c 92 81 52 96 d9 aa 71  |....0..)...R...q|
+00000040  21 0a 3b 12 f3 48 8f 7b  50 2d c2 6c 3d ac 34 bc  |!.;..H.{P-.l=.4.|
+00000050  1b fb 66 72 75 90 4a bb  d1 26 b8 e8 73 c4 b1 e1  |..fru.J..&..s...|
+00000060  93 84 4f bc 2e                                    |..O..|
 >>> Flow 4 (server to client)
-00000000  16 03 01 00 7f 04 00 00  7b 00 00 00 00 00 75 00  |........{.....u.|
+00000000  16 03 01 00 80 04 00 00  7c 00 00 00 00 00 76 00  |........|.....v.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6d 2d 70 97 51 ed 14 ef  68 ca 42 c5 4c a2 c9 88  |m-p.Q...h.B.L...|
-00000030  e5 0f 86 1e 3c 6b ae 30  31 14 f0 45 e8 6b d5 9a  |....<k.01..E.k..|
-00000040  ec d5 95 b3 53 58 ec 99  b0 a8 99 3e 6f 99 1e d7  |....SX.....>o...|
-00000050  7a 9c 81 67 e3 33 22 75  60 ce 31 21 f6 49 38 16  |z..g.3"u`.1!.I8.|
-00000060  7f 51 5c e5 ab f1 d6 72  14 6d 02 24 ed 8d 42 63  |.Q\....r.m.$..Bc|
-00000070  74 3e c3 2f f4 75 61 0d  d6 07 bd a3 5c f3 4b ea  |t>./.ua.....\.K.|
-00000080  ce f4 6d 80 14 03 01 00  01 01 16 03 01 00 30 71  |..m...........0q|
-00000090  84 71 e0 23 7e c6 19 76  ad 7d 7f b2 ad f4 2f e2  |.q.#~..v.}..../.|
-000000a0  57 6d 78 73 49 86 67 a0  c6 8c d2 a0 08 9c ba 8c  |WmxsI.g.........|
-000000b0  09 47 03 69 5f 97 cc d2  66 c6 ce f0 e5 9c 88 17  |.G.i_...f.......|
-000000c0  03 01 00 20 8f e4 c8 2a  1b 66 ff 6d 56 e6 8f fb  |... ...*.f.mV...|
-000000d0  9a 08 f4 b3 4d 91 35 c6  6d fc b0 5f c9 ad 7e a3  |....M.5.m.._..~.|
-000000e0  c4 8c fc 47 17 03 01 00  30 1b 33 c8 40 3e 33 ed  |...G....0.3.@>3.|
-000000f0  73 f3 24 32 38 1d e6 72  e1 58 ef 43 54 0f 6d a9  |s.$28..r.X.CT.m.|
-00000100  68 21 10 eb fe 1d 51 d7  56 0f da 11 7c b5 3c ff  |h!....Q.V...|.<.|
-00000110  89 74 28 12 88 14 a7 fb  f2 15 03 01 00 20 ce 95  |.t(.......... ..|
-00000120  1c a0 ae 96 f9 58 0a 0b  26 a2 19 e5 86 80 d2 f4  |.....X..&.......|
-00000130  69 c8 ee bd 6f e1 db c0  67 11 dd a5 c8 f0        |i...o...g.....|
+00000020  6d 2d 70 97 51 ed 14 ef  68 ca 42 c5 4c 29 fc 12  |m-p.Q...h.B.L)..|
+00000030  2f 4c f2 55 c2 71 1b 97  63 9c 43 02 8c a7 b6 ee  |/L.U.q..c.C.....|
+00000040  78 36 ad 58 6d bf 70 41  00 c3 1c ed cb 0f 5d 6a  |x6.Xm.pA......]j|
+00000050  48 3a 50 d3 a3 78 a3 7f  eb d2 31 9e 08 49 38 16  |H:P..x....1..I8.|
+00000060  7e 51 5c e5 15 5f 64 51  2e a8 c5 82 f2 ef 4b 84  |~Q\.._dQ......K.|
+00000070  3a a8 15 aa 2b dd 36 09  8d 69 8b b3 c7 93 d5 5e  |:...+.6..i.....^|
+00000080  d7 da ce 01 82 14 03 01  00 01 01 16 03 01 00 30  |...............0|
+00000090  06 b8 28 f7 0d f0 f1 42  26 da fb ab 14 e7 98 e8  |..(....B&.......|
+000000a0  57 5a 96 30 bd 2c 78 ec  e6 97 92 48 88 9c 72 37  |WZ.0.,x....H..r7|
+000000b0  07 0a 6a d4 b1 15 3d ad  00 85 a6 f5 e4 c0 af 3d  |..j...=........=|
+000000c0  17 03 01 00 20 c0 fd af  d3 7f aa ad 98 8c 5f 97  |.... ........._.|
+000000d0  2e bc 5d b3 03 9e a7 e0  be 34 b9 00 16 c3 ac cd  |..]......4......|
+000000e0  f8 96 13 e3 32 17 03 01  00 30 00 a0 d4 64 67 56  |....2....0...dgV|
+000000f0  6f 88 35 a8 d7 13 18 43  1c 59 a7 45 70 99 64 01  |o.5....C.Y.Ep.d.|
+00000100  4f c5 df af 6d ff b8 7d  31 0c df 78 e8 bd 97 50  |O...m..}1..x...P|
+00000110  bd f9 b9 37 e4 09 0a 7e  36 b5 15 03 01 00 20 42  |...7...~6..... B|
+00000120  a0 51 1b ea ea 31 3c 2c  b3 4a 47 9f 4a a0 29 8d  |.Q...1<,.JG.J.).|
+00000130  b7 2c 50 7b 5e a4 ee 12  33 9c 6f 67 aa 24 80     |.,P{^...3.og.$.|
diff --git a/src/crypto/tls/testdata/Server-TLSv10-RSA-3DES b/src/crypto/tls/testdata/Server-TLSv10-RSA-3DES
index 502fd284a0..e4853a4cc7 100644
--- a/src/crypto/tls/testdata/Server-TLSv10-RSA-3DES
+++ b/src/crypto/tls/testdata/Server-TLSv10-RSA-3DES
@@ -1,76 +1,73 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 63 01 00 00  5f 03 01 25 03 63 bf 34  |....c..._..%.c.4|
-00000010  89 c8 9e f6 e0 46 f8 30  5c e8 62 0a f7 db 68 c9  |.....F.0\.b...h.|
-00000020  50 54 0e c2 15 f1 cb 07  66 06 3d 00 00 04 00 0a  |PT......f.=.....|
-00000030  00 ff 01 00 00 32 00 00  00 0e 00 0c 00 00 09 31  |.....2.........1|
-00000040  32 37 2e 30 2e 30 2e 31  00 0b 00 04 03 00 01 02  |27.0.0.1........|
-00000050  00 0a 00 0c 00 0a 00 1d  00 17 00 1e 00 19 00 18  |................|
-00000060  00 16 00 00 00 17 00 00                           |........|
+00000000  16 03 01 00 39 01 00 00  35 03 01 51 7a 48 8d de  |....9...5..QzH..|
+00000010  0b 30 0f 9a 91 56 30 20  30 dd bd 74 3b e2 d7 db  |.0...V0 0..t;...|
+00000020  46 3d bf 6f b6 ae 53 8a  7d 18 50 00 00 04 00 0a  |F=.o..S.}.P.....|
+00000030  00 ff 01 00 00 08 00 16  00 00 00 17 00 00        |..............|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 37 02 00 00  33 03 01 00 00 00 00 00  |....7...3.......|
+00000000  16 03 01 00 35 02 00 00  31 03 01 00 00 00 00 00  |....5...1.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 00 00 00 0a 00 00  |...DOWNGRD......|
-00000030  0b ff 01 00 01 00 00 0b  00 02 01 00 16 03 01 02  |................|
-00000040  59 0b 00 02 55 00 02 52  00 02 4f 30 82 02 4b 30  |Y...U..R..O0..K0|
-00000050  82 01 b4 a0 03 02 01 02  02 09 00 e8 f0 9d 3f e2  |..............?.|
-00000060  5b ea a6 30 0d 06 09 2a  86 48 86 f7 0d 01 01 0b  |[..0...*.H......|
-00000070  05 00 30 1f 31 0b 30 09  06 03 55 04 0a 13 02 47  |..0.1.0...U....G|
-00000080  6f 31 10 30 0e 06 03 55  04 03 13 07 47 6f 20 52  |o1.0...U....Go R|
-00000090  6f 6f 74 30 1e 17 0d 31  36 30 31 30 31 30 30 30  |oot0...160101000|
-000000a0  30 30 30 5a 17 0d 32 35  30 31 30 31 30 30 30 30  |000Z..2501010000|
-000000b0  30 30 5a 30 1a 31 0b 30  09 06 03 55 04 0a 13 02  |00Z0.1.0...U....|
-000000c0  47 6f 31 0b 30 09 06 03  55 04 03 13 02 47 6f 30  |Go1.0...U....Go0|
-000000d0  81 9f 30 0d 06 09 2a 86  48 86 f7 0d 01 01 01 05  |..0...*.H.......|
-000000e0  00 03 81 8d 00 30 81 89  02 81 81 00 db 46 7d 93  |.....0.......F}.|
-000000f0  2e 12 27 06 48 bc 06 28  21 ab 7e c4 b6 a2 5d fe  |..'.H..(!.~...].|
-00000100  1e 52 45 88 7a 36 47 a5  08 0d 92 42 5b c2 81 c0  |.RE.z6G....B[...|
-00000110  be 97 79 98 40 fb 4f 6d  14 fd 2b 13 8b c2 a5 2e  |..y.@.Om..+.....|
-00000120  67 d8 d4 09 9e d6 22 38  b7 4a 0b 74 73 2b c2 34  |g....."8.J.ts+.4|
-00000130  f1 d1 93 e5 96 d9 74 7b  f3 58 9f 6c 61 3c c0 b0  |......t{.X.la<..|
-00000140  41 d4 d9 2b 2b 24 23 77  5b 1c 3b bd 75 5d ce 20  |A..++$#w[.;.u]. |
-00000150  54 cf a1 63 87 1d 1e 24  c4 f3 1d 1a 50 8b aa b6  |T..c...$....P...|
-00000160  14 43 ed 97 a7 75 62 f4  14 c8 52 d7 02 03 01 00  |.C...ub...R.....|
-00000170  01 a3 81 93 30 81 90 30  0e 06 03 55 1d 0f 01 01  |....0..0...U....|
-00000180  ff 04 04 03 02 05 a0 30  1d 06 03 55 1d 25 04 16  |.......0...U.%..|
-00000190  30 14 06 08 2b 06 01 05  05 07 03 01 06 08 2b 06  |0...+.........+.|
-000001a0  01 05 05 07 03 02 30 0c  06 03 55 1d 13 01 01 ff  |......0...U.....|
-000001b0  04 02 30 00 30 19 06 03  55 1d 0e 04 12 04 10 9f  |..0.0...U.......|
-000001c0  91 16 1f 43 43 3e 49 a6  de 6d b6 80 d7 9f 60 30  |...CC>I..m....`0|
-000001d0  1b 06 03 55 1d 23 04 14  30 12 80 10 48 13 49 4d  |...U.#..0...H.IM|
-000001e0  13 7e 16 31 bb a3 01 d5  ac ab 6e 7b 30 19 06 03  |.~.1......n{0...|
-000001f0  55 1d 11 04 12 30 10 82  0e 65 78 61 6d 70 6c 65  |U....0...example|
-00000200  2e 67 6f 6c 61 6e 67 30  0d 06 09 2a 86 48 86 f7  |.golang0...*.H..|
-00000210  0d 01 01 0b 05 00 03 81  81 00 9d 30 cc 40 2b 5b  |...........0.@+[|
-00000220  50 a0 61 cb ba e5 53 58  e1 ed 83 28 a9 58 1a a9  |P.a...SX...(.X..|
-00000230  38 a4 95 a1 ac 31 5a 1a  84 66 3d 43 d3 2d d9 0b  |8....1Z..f=C.-..|
-00000240  f2 97 df d3 20 64 38 92  24 3a 00 bc cf 9c 7d b7  |.... d8.$:....}.|
-00000250  40 20 01 5f aa d3 16 61  09 a2 76 fd 13 c3 cc e1  |@ ._...a..v.....|
-00000260  0c 5c ee b1 87 82 f1 6c  04 ed 73 bb b3 43 77 8d  |.\.....l..s..Cw.|
-00000270  0c 1c f1 0f a1 d8 40 83  61 c9 4c 72 2b 9d ae db  |......@.a.Lr+...|
-00000280  46 06 06 4d f4 c1 b3 3e  c0 d1 bd 42 d4 db fe 3d  |F..M...>...B...=|
-00000290  13 60 84 5c 21 d3 3b e9  fa e7 16 03 01 00 04 0e  |.`.\!.;.........|
-000002a0  00 00 00                                          |...|
+00000030  09 ff 01 00 01 00 00 17  00 00 16 03 01 02 59 0b  |..............Y.|
+00000040  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
+00000050  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
+00000060  a6 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |.0...*.H........|
+00000070  30 1f 31 0b 30 09 06 03  55 04 0a 13 02 47 6f 31  |0.1.0...U....Go1|
+00000080  10 30 0e 06 03 55 04 03  13 07 47 6f 20 52 6f 6f  |.0...U....Go Roo|
+00000090  74 30 1e 17 0d 31 36 30  31 30 31 30 30 30 30 30  |t0...16010100000|
+000000a0  30 5a 17 0d 32 35 30 31  30 31 30 30 30 30 30 30  |0Z..250101000000|
+000000b0  5a 30 1a 31 0b 30 09 06  03 55 04 0a 13 02 47 6f  |Z0.1.0...U....Go|
+000000c0  31 0b 30 09 06 03 55 04  03 13 02 47 6f 30 81 9f  |1.0...U....Go0..|
+000000d0  30 0d 06 09 2a 86 48 86  f7 0d 01 01 01 05 00 03  |0...*.H.........|
+000000e0  81 8d 00 30 81 89 02 81  81 00 db 46 7d 93 2e 12  |...0.......F}...|
+000000f0  27 06 48 bc 06 28 21 ab  7e c4 b6 a2 5d fe 1e 52  |'.H..(!.~...]..R|
+00000100  45 88 7a 36 47 a5 08 0d  92 42 5b c2 81 c0 be 97  |E.z6G....B[.....|
+00000110  79 98 40 fb 4f 6d 14 fd  2b 13 8b c2 a5 2e 67 d8  |y.@.Om..+.....g.|
+00000120  d4 09 9e d6 22 38 b7 4a  0b 74 73 2b c2 34 f1 d1  |...."8.J.ts+.4..|
+00000130  93 e5 96 d9 74 7b f3 58  9f 6c 61 3c c0 b0 41 d4  |....t{.X.la<..A.|
+00000140  d9 2b 2b 24 23 77 5b 1c  3b bd 75 5d ce 20 54 cf  |.++$#w[.;.u]. T.|
+00000150  a1 63 87 1d 1e 24 c4 f3  1d 1a 50 8b aa b6 14 43  |.c...$....P....C|
+00000160  ed 97 a7 75 62 f4 14 c8  52 d7 02 03 01 00 01 a3  |...ub...R.......|
+00000170  81 93 30 81 90 30 0e 06  03 55 1d 0f 01 01 ff 04  |..0..0...U......|
+00000180  04 03 02 05 a0 30 1d 06  03 55 1d 25 04 16 30 14  |.....0...U.%..0.|
+00000190  06 08 2b 06 01 05 05 07  03 01 06 08 2b 06 01 05  |..+.........+...|
+000001a0  05 07 03 02 30 0c 06 03  55 1d 13 01 01 ff 04 02  |....0...U.......|
+000001b0  30 00 30 19 06 03 55 1d  0e 04 12 04 10 9f 91 16  |0.0...U.........|
+000001c0  1f 43 43 3e 49 a6 de 6d  b6 80 d7 9f 60 30 1b 06  |.CC>I..m....`0..|
+000001d0  03 55 1d 23 04 14 30 12  80 10 48 13 49 4d 13 7e  |.U.#..0...H.IM.~|
+000001e0  16 31 bb a3 01 d5 ac ab  6e 7b 30 19 06 03 55 1d  |.1......n{0...U.|
+000001f0  11 04 12 30 10 82 0e 65  78 61 6d 70 6c 65 2e 67  |...0...example.g|
+00000200  6f 6c 61 6e 67 30 0d 06  09 2a 86 48 86 f7 0d 01  |olang0...*.H....|
+00000210  01 0b 05 00 03 81 81 00  9d 30 cc 40 2b 5b 50 a0  |.........0.@+[P.|
+00000220  61 cb ba e5 53 58 e1 ed  83 28 a9 58 1a a9 38 a4  |a...SX...(.X..8.|
+00000230  95 a1 ac 31 5a 1a 84 66  3d 43 d3 2d d9 0b f2 97  |...1Z..f=C.-....|
+00000240  df d3 20 64 38 92 24 3a  00 bc cf 9c 7d b7 40 20  |.. d8.$:....}.@ |
+00000250  01 5f aa d3 16 61 09 a2  76 fd 13 c3 cc e1 0c 5c  |._...a..v......\|
+00000260  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
+00000270  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
+00000280  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
+00000290  84 5c 21 d3 3b e9 fa e7  16 03 01 00 04 0e 00 00  |.\!.;...........|
+000002a0  00                                                |.|
 >>> Flow 3 (client to server)
-00000000  16 03 01 00 86 10 00 00  82 00 80 0f e9 83 ca 77  |...............w|
-00000010  c8 26 16 24 00 b7 09 d2  73 aa c1 d9 77 f3 fc 38  |.&.$....s...w..8|
-00000020  1c 2e c0 26 b4 a6 40 e1  1b 93 39 8f a2 1f f2 f9  |...&..@...9.....|
-00000030  18 2a 7b 0e cd 9b 9b 9c  49 86 43 3d 48 fd 40 d7  |.*{.....I.C=H.@.|
-00000040  af f9 2b 5e c6 cc c6 2d  8d 36 fe b1 75 c1 b5 a0  |..+^...-.6..u...|
-00000050  57 97 0f 01 ee b4 6a af  0c fe f0 68 78 04 6a 3e  |W.....j....hx.j>|
-00000060  83 d0 72 34 80 d8 7d cd  8b 83 06 5b 36 50 10 8e  |..r4..}....[6P..|
-00000070  b4 27 3d 6a ae b7 7f 8b  2a b1 0b 51 49 05 b5 01  |.'=j....*..QI...|
-00000080  3c 27 9a 59 e3 41 18 38  d6 8f 7a 14 03 01 00 01  |<'.Y.A.8..z.....|
-00000090  01 16 03 01 00 28 c0 46  65 9f 7f d8 c3 c4 a7 33  |.....(.Fe......3|
-000000a0  50 f9 07 41 95 12 a6 f3  ca 53 b9 96 f8 a8 a6 5f  |P..A.....S....._|
-000000b0  1e c8 20 e5 8b 87 4e 12  73 13 e0 e4 c6 89        |.. ...N.s.....|
+00000000  16 03 01 00 86 10 00 00  82 00 80 54 53 e6 48 5d  |...........TS.H]|
+00000010  bb 47 19 7e ab 31 3b 4a  c8 fb da 69 9d 74 b3 e1  |.G.~.1;J...i.t..|
+00000020  dc 8c ea 36 f7 a1 06 68  52 79 c3 08 be b9 5c 1a  |...6...hRy....\.|
+00000030  80 cc 13 b8 7b b8 02 98  5e f8 50 47 a5 0d 37 dd  |....{...^.PG..7.|
+00000040  86 c5 69 9c 1c 1c 91 39  ea 80 dc d1 87 d3 f8 f6  |..i....9........|
+00000050  84 c6 65 72 af 71 dc 98  56 9e bc e7 a9 9d 9b 31  |..er.q..V......1|
+00000060  d0 c3 54 28 05 86 91 e4  03 40 f7 2a cb 07 13 41  |..T(.....@.*...A|
+00000070  1e 30 0b b1 2d 52 ae 1f  a1 6b a9 db c2 76 1d 4a  |.0..-R...k...v.J|
+00000080  a6 81 ba 3c cb e9 3a 6b  f3 70 ed 14 03 01 00 01  |...<..:k.p......|
+00000090  01 16 03 01 00 28 01 84  d8 e4 7a b1 11 3e 27 fb  |.....(....z..>'.|
+000000a0  66 10 1a db 20 fb 9e e3  f1 a5 a7 86 2f fd c9 d2  |f... ......./...|
+000000b0  1c b8 a4 2b af 2b 66 fc  ad 31 72 28 d7 1a        |...+.+f..1r(..|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 28 e2 47 2b 57 fe  |..........(.G+W.|
-00000010  74 71 95 6a ee 68 2b f3  48 40 13 52 35 46 58 d4  |tq.j.h+.H@.R5FX.|
-00000020  ee aa 4c a8 53 0f 3a 19  ed 18 37 2d e4 b9 1e e6  |..L.S.:...7-....|
-00000030  28 42 a1 17 03 01 00 18  d8 7c 20 f2 03 6d a9 ed  |(B.......| ..m..|
-00000040  c9 73 50 d7 56 4f 0b d8  4b 44 f6 80 e4 c1 a9 f5  |.sP.VO..KD......|
-00000050  17 03 01 00 28 f5 b2 11  6b a6 4b 22 30 42 3c cc  |....(...k.K"0B<.|
-00000060  07 0d ed 10 d0 c7 7b ec  b3 60 0b 2b 3c fb ec 3a  |......{..`.+<..:|
-00000070  c0 be 44 e7 76 b6 9e db  17 36 92 df 88 15 03 01  |..D.v....6......|
-00000080  00 18 7a d9 2f 46 2e 0f  ec c5 ee 7b ef bd fb e5  |..z./F.....{....|
-00000090  26 40 0a a2 4e eb 56 0e  ca 03                    |&@..N.V...|
+00000000  14 03 01 00 01 01 16 03  01 00 28 67 3d c4 e9 a6  |..........(g=...|
+00000010  bb 99 57 90 eb fa 86 ee  ab 00 08 61 2d c8 50 5b  |..W........a-.P[|
+00000020  83 9c ce 83 60 7a 89 33  90 b7 f9 31 e9 37 04 3d  |....`z.3...1.7.=|
+00000030  d6 01 44 17 03 01 00 18  0a 1c 6c 75 23 bc b2 e7  |..D.......lu#...|
+00000040  30 2d 61 57 d3 a6 a2 72  6a 7a 2d 8a 7b fd 45 67  |0-aW...rjz-.{.Eg|
+00000050  17 03 01 00 28 23 8b 77  dd a3 f2 b6 0e 59 40 3b  |....(#.w.....Y@;|
+00000060  4e 3a 1b 0c 11 2f 99 00  b9 e1 2c 11 89 53 fb 23  |N:.../....,..S.#|
+00000070  fb 6c 60 71 db a8 43 a4  92 ad 68 24 e9 15 03 01  |.l`q..C...h$....|
+00000080  00 18 24 19 84 35 13 29  ed 3a f0 57 a9 e1 b6 e9  |..$..5.).:.W....|
+00000090  05 64 fe 46 c0 ca b1 88  12 a7                    |.d.F......|
diff --git a/src/crypto/tls/testdata/Server-TLSv10-RSA-AES b/src/crypto/tls/testdata/Server-TLSv10-RSA-AES
index 7425376545..f362a7a611 100644
--- a/src/crypto/tls/testdata/Server-TLSv10-RSA-AES
+++ b/src/crypto/tls/testdata/Server-TLSv10-RSA-AES
@@ -1,79 +1,76 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 63 01 00 00  5f 03 01 78 91 f6 ad 9e  |....c..._..x....|
-00000010  79 23 92 10 d9 c5 43 52  8f f6 f4 3f f4 eb ac 6b  |y#....CR...?...k|
-00000020  f3 ce a9 76 a2 bf c3 5b  9d bc 52 00 00 04 00 2f  |...v...[..R..../|
-00000030  00 ff 01 00 00 32 00 00  00 0e 00 0c 00 00 09 31  |.....2.........1|
-00000040  32 37 2e 30 2e 30 2e 31  00 0b 00 04 03 00 01 02  |27.0.0.1........|
-00000050  00 0a 00 0c 00 0a 00 1d  00 17 00 1e 00 19 00 18  |................|
-00000060  00 16 00 00 00 17 00 00                           |........|
+00000000  16 03 01 00 39 01 00 00  35 03 01 96 f7 15 21 fc  |....9...5.....!.|
+00000010  31 f5 cf cf e9 82 0f 84  db 34 a8 e4 3c e9 39 b4  |1........4..<.9.|
+00000020  90 af d7 47 2b b5 71 8a  bb 26 b5 00 00 04 00 2f  |...G+.q..&...../|
+00000030  00 ff 01 00 00 08 00 16  00 00 00 17 00 00        |..............|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 37 02 00 00  33 03 01 00 00 00 00 00  |....7...3.......|
+00000000  16 03 01 00 35 02 00 00  31 03 01 00 00 00 00 00  |....5...1.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 00 00 00 2f 00 00  |...DOWNGRD.../..|
-00000030  0b ff 01 00 01 00 00 0b  00 02 01 00 16 03 01 02  |................|
-00000040  59 0b 00 02 55 00 02 52  00 02 4f 30 82 02 4b 30  |Y...U..R..O0..K0|
-00000050  82 01 b4 a0 03 02 01 02  02 09 00 e8 f0 9d 3f e2  |..............?.|
-00000060  5b ea a6 30 0d 06 09 2a  86 48 86 f7 0d 01 01 0b  |[..0...*.H......|
-00000070  05 00 30 1f 31 0b 30 09  06 03 55 04 0a 13 02 47  |..0.1.0...U....G|
-00000080  6f 31 10 30 0e 06 03 55  04 03 13 07 47 6f 20 52  |o1.0...U....Go R|
-00000090  6f 6f 74 30 1e 17 0d 31  36 30 31 30 31 30 30 30  |oot0...160101000|
-000000a0  30 30 30 5a 17 0d 32 35  30 31 30 31 30 30 30 30  |000Z..2501010000|
-000000b0  30 30 5a 30 1a 31 0b 30  09 06 03 55 04 0a 13 02  |00Z0.1.0...U....|
-000000c0  47 6f 31 0b 30 09 06 03  55 04 03 13 02 47 6f 30  |Go1.0...U....Go0|
-000000d0  81 9f 30 0d 06 09 2a 86  48 86 f7 0d 01 01 01 05  |..0...*.H.......|
-000000e0  00 03 81 8d 00 30 81 89  02 81 81 00 db 46 7d 93  |.....0.......F}.|
-000000f0  2e 12 27 06 48 bc 06 28  21 ab 7e c4 b6 a2 5d fe  |..'.H..(!.~...].|
-00000100  1e 52 45 88 7a 36 47 a5  08 0d 92 42 5b c2 81 c0  |.RE.z6G....B[...|
-00000110  be 97 79 98 40 fb 4f 6d  14 fd 2b 13 8b c2 a5 2e  |..y.@.Om..+.....|
-00000120  67 d8 d4 09 9e d6 22 38  b7 4a 0b 74 73 2b c2 34  |g....."8.J.ts+.4|
-00000130  f1 d1 93 e5 96 d9 74 7b  f3 58 9f 6c 61 3c c0 b0  |......t{.X.la<..|
-00000140  41 d4 d9 2b 2b 24 23 77  5b 1c 3b bd 75 5d ce 20  |A..++$#w[.;.u]. |
-00000150  54 cf a1 63 87 1d 1e 24  c4 f3 1d 1a 50 8b aa b6  |T..c...$....P...|
-00000160  14 43 ed 97 a7 75 62 f4  14 c8 52 d7 02 03 01 00  |.C...ub...R.....|
-00000170  01 a3 81 93 30 81 90 30  0e 06 03 55 1d 0f 01 01  |....0..0...U....|
-00000180  ff 04 04 03 02 05 a0 30  1d 06 03 55 1d 25 04 16  |.......0...U.%..|
-00000190  30 14 06 08 2b 06 01 05  05 07 03 01 06 08 2b 06  |0...+.........+.|
-000001a0  01 05 05 07 03 02 30 0c  06 03 55 1d 13 01 01 ff  |......0...U.....|
-000001b0  04 02 30 00 30 19 06 03  55 1d 0e 04 12 04 10 9f  |..0.0...U.......|
-000001c0  91 16 1f 43 43 3e 49 a6  de 6d b6 80 d7 9f 60 30  |...CC>I..m....`0|
-000001d0  1b 06 03 55 1d 23 04 14  30 12 80 10 48 13 49 4d  |...U.#..0...H.IM|
-000001e0  13 7e 16 31 bb a3 01 d5  ac ab 6e 7b 30 19 06 03  |.~.1......n{0...|
-000001f0  55 1d 11 04 12 30 10 82  0e 65 78 61 6d 70 6c 65  |U....0...example|
-00000200  2e 67 6f 6c 61 6e 67 30  0d 06 09 2a 86 48 86 f7  |.golang0...*.H..|
-00000210  0d 01 01 0b 05 00 03 81  81 00 9d 30 cc 40 2b 5b  |...........0.@+[|
-00000220  50 a0 61 cb ba e5 53 58  e1 ed 83 28 a9 58 1a a9  |P.a...SX...(.X..|
-00000230  38 a4 95 a1 ac 31 5a 1a  84 66 3d 43 d3 2d d9 0b  |8....1Z..f=C.-..|
-00000240  f2 97 df d3 20 64 38 92  24 3a 00 bc cf 9c 7d b7  |.... d8.$:....}.|
-00000250  40 20 01 5f aa d3 16 61  09 a2 76 fd 13 c3 cc e1  |@ ._...a..v.....|
-00000260  0c 5c ee b1 87 82 f1 6c  04 ed 73 bb b3 43 77 8d  |.\.....l..s..Cw.|
-00000270  0c 1c f1 0f a1 d8 40 83  61 c9 4c 72 2b 9d ae db  |......@.a.Lr+...|
-00000280  46 06 06 4d f4 c1 b3 3e  c0 d1 bd 42 d4 db fe 3d  |F..M...>...B...=|
-00000290  13 60 84 5c 21 d3 3b e9  fa e7 16 03 01 00 04 0e  |.`.\!.;.........|
-000002a0  00 00 00                                          |...|
+00000030  09 ff 01 00 01 00 00 17  00 00 16 03 01 02 59 0b  |..............Y.|
+00000040  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
+00000050  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
+00000060  a6 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |.0...*.H........|
+00000070  30 1f 31 0b 30 09 06 03  55 04 0a 13 02 47 6f 31  |0.1.0...U....Go1|
+00000080  10 30 0e 06 03 55 04 03  13 07 47 6f 20 52 6f 6f  |.0...U....Go Roo|
+00000090  74 30 1e 17 0d 31 36 30  31 30 31 30 30 30 30 30  |t0...16010100000|
+000000a0  30 5a 17 0d 32 35 30 31  30 31 30 30 30 30 30 30  |0Z..250101000000|
+000000b0  5a 30 1a 31 0b 30 09 06  03 55 04 0a 13 02 47 6f  |Z0.1.0...U....Go|
+000000c0  31 0b 30 09 06 03 55 04  03 13 02 47 6f 30 81 9f  |1.0...U....Go0..|
+000000d0  30 0d 06 09 2a 86 48 86  f7 0d 01 01 01 05 00 03  |0...*.H.........|
+000000e0  81 8d 00 30 81 89 02 81  81 00 db 46 7d 93 2e 12  |...0.......F}...|
+000000f0  27 06 48 bc 06 28 21 ab  7e c4 b6 a2 5d fe 1e 52  |'.H..(!.~...]..R|
+00000100  45 88 7a 36 47 a5 08 0d  92 42 5b c2 81 c0 be 97  |E.z6G....B[.....|
+00000110  79 98 40 fb 4f 6d 14 fd  2b 13 8b c2 a5 2e 67 d8  |y.@.Om..+.....g.|
+00000120  d4 09 9e d6 22 38 b7 4a  0b 74 73 2b c2 34 f1 d1  |...."8.J.ts+.4..|
+00000130  93 e5 96 d9 74 7b f3 58  9f 6c 61 3c c0 b0 41 d4  |....t{.X.la<..A.|
+00000140  d9 2b 2b 24 23 77 5b 1c  3b bd 75 5d ce 20 54 cf  |.++$#w[.;.u]. T.|
+00000150  a1 63 87 1d 1e 24 c4 f3  1d 1a 50 8b aa b6 14 43  |.c...$....P....C|
+00000160  ed 97 a7 75 62 f4 14 c8  52 d7 02 03 01 00 01 a3  |...ub...R.......|
+00000170  81 93 30 81 90 30 0e 06  03 55 1d 0f 01 01 ff 04  |..0..0...U......|
+00000180  04 03 02 05 a0 30 1d 06  03 55 1d 25 04 16 30 14  |.....0...U.%..0.|
+00000190  06 08 2b 06 01 05 05 07  03 01 06 08 2b 06 01 05  |..+.........+...|
+000001a0  05 07 03 02 30 0c 06 03  55 1d 13 01 01 ff 04 02  |....0...U.......|
+000001b0  30 00 30 19 06 03 55 1d  0e 04 12 04 10 9f 91 16  |0.0...U.........|
+000001c0  1f 43 43 3e 49 a6 de 6d  b6 80 d7 9f 60 30 1b 06  |.CC>I..m....`0..|
+000001d0  03 55 1d 23 04 14 30 12  80 10 48 13 49 4d 13 7e  |.U.#..0...H.IM.~|
+000001e0  16 31 bb a3 01 d5 ac ab  6e 7b 30 19 06 03 55 1d  |.1......n{0...U.|
+000001f0  11 04 12 30 10 82 0e 65  78 61 6d 70 6c 65 2e 67  |...0...example.g|
+00000200  6f 6c 61 6e 67 30 0d 06  09 2a 86 48 86 f7 0d 01  |olang0...*.H....|
+00000210  01 0b 05 00 03 81 81 00  9d 30 cc 40 2b 5b 50 a0  |.........0.@+[P.|
+00000220  61 cb ba e5 53 58 e1 ed  83 28 a9 58 1a a9 38 a4  |a...SX...(.X..8.|
+00000230  95 a1 ac 31 5a 1a 84 66  3d 43 d3 2d d9 0b f2 97  |...1Z..f=C.-....|
+00000240  df d3 20 64 38 92 24 3a  00 bc cf 9c 7d b7 40 20  |.. d8.$:....}.@ |
+00000250  01 5f aa d3 16 61 09 a2  76 fd 13 c3 cc e1 0c 5c  |._...a..v......\|
+00000260  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
+00000270  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
+00000280  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
+00000290  84 5c 21 d3 3b e9 fa e7  16 03 01 00 04 0e 00 00  |.\!.;...........|
+000002a0  00                                                |.|
 >>> Flow 3 (client to server)
-00000000  16 03 01 00 86 10 00 00  82 00 80 73 aa be d1 21  |...........s...!|
-00000010  67 e9 9c 20 40 cf 0a 47  31 61 e9 2b ba 06 4f aa  |g.. @..G1a.+..O.|
-00000020  ce 15 6a b7 df 0d 0e b0  fe b5 f2 c0 26 81 39 6e  |..j.........&.9n|
-00000030  5b 96 3c 2f 42 4f 08 92  48 a3 95 c8 ad 0d 0e 8f  |[.</BO..H.......|
-00000040  9c 9e fc bf d7 25 2e c7  d1 e2 e6 66 9b bf 20 94  |.....%.....f.. .|
-00000050  6f d3 62 77 38 0f f6 96  ae 54 f1 8c 6a c2 17 bd  |o.bw8....T..j...|
-00000060  c6 7c 99 f0 e5 6d 1b f2  81 c6 49 29 c2 24 db a7  |.|...m....I).$..|
-00000070  0f c0 53 15 6f 3e 9b d8  c2 32 f1 3e 16 b7 d3 b2  |..S.o>...2.>....|
-00000080  36 99 9f b7 53 ef 34 e8  d6 13 3b 14 03 01 00 01  |6...S.4...;.....|
-00000090  01 16 03 01 00 30 c6 d2  a6 85 cf 2a e4 9e 9e e1  |.....0.....*....|
-000000a0  d0 82 d0 2a f8 e5 bd f6  9a 67 0b c6 47 07 9c 14  |...*.....g..G...|
-000000b0  7e 73 9e 4c 8b d2 55 4f  b2 32 9a 16 16 a5 e8 25  |~s.L..UO.2.....%|
-000000c0  62 e2 e9 88 b6 44                                 |b....D|
+00000000  16 03 01 00 86 10 00 00  82 00 80 47 20 04 47 3e  |...........G .G>|
+00000010  d0 67 d1 d9 5d 17 eb 85  2c 3f 1c 4b 93 f9 ff 51  |.g..]...,?.K...Q|
+00000020  ca 61 eb 04 54 6d 49 97  02 67 fe 28 79 be 4d 37  |.a..TmI..g.(y.M7|
+00000030  f7 ba e8 e0 2b 90 31 fe  66 d8 04 ad bf fb 2c 05  |....+.1.f.....,.|
+00000040  7e 41 a0 5d 00 47 20 84  83 2c 39 7f 29 aa 72 72  |~A.].G ..,9.).rr|
+00000050  89 e3 c7 bb ea 07 d2 29  94 de 54 23 eb 9f ae fa  |.......)..T#....|
+00000060  3b 9a 23 bd a8 43 11 ab  b5 6c 8a ae c6 71 2c c4  |;.#..C...l...q,.|
+00000070  f6 4d 0d 19 8e f6 7e 44  d2 04 58 68 a7 bd 84 34  |.M....~D..Xh...4|
+00000080  5f e5 98 56 a5 1e 61 57  f2 f4 ea 14 03 01 00 01  |_..V..aW........|
+00000090  01 16 03 01 00 30 eb 07  c2 ed 41 24 ab 50 74 82  |.....0....A$.Pt.|
+000000a0  c4 83 28 2c b3 33 88 a1  c7 61 89 61 29 58 78 fc  |..(,.3...a.a)Xx.|
+000000b0  b5 99 54 d2 c2 2b 14 e4  6b a9 9b b8 69 17 6c 53  |..T..+..k...i.lS|
+000000c0  dd dd d7 7b a5 a7                                 |...{..|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 30 21 7a ee 62 6a  |..........0!z.bj|
-00000010  20 39 2a 39 d1 d3 f7 bd  53 05 4f 1a 36 71 3b b6  | 9*9....S.O.6q;.|
-00000020  c5 5a b7 3b c3 0b 3f b9  2f ac 62 1c c2 2f fa 29  |.Z.;..?./.b../.)|
-00000030  dd f3 bc ff 35 28 7f 86  b8 0f 33 17 03 01 00 20  |....5(....3.... |
-00000040  3a 6c 47 23 37 5a 15 bd  03 c6 64 c5 59 2f 91 e8  |:lG#7Z....d.Y/..|
-00000050  a6 1b d5 04 c2 a7 80 0e  94 6c 3c e4 70 2c ea 81  |.........l<.p,..|
-00000060  17 03 01 00 30 60 14 bc  6b 84 16 9f 53 b6 ee c9  |....0`..k...S...|
-00000070  43 cf f3 46 97 45 e1 2f  86 96 26 cc ef ea 09 72  |C..F.E./..&....r|
-00000080  36 92 4e 9e 2a 8e a2 d7  9a cd 5f 38 a8 07 c4 54  |6.N.*....._8...T|
-00000090  a1 4d 6e 7a 36 15 03 01  00 20 1e c2 df a3 3e 8e  |.Mnz6.... ....>.|
-000000a0  15 c4 c0 90 8f 7c 5a e0  68 d7 ea 86 76 8d d1 27  |.....|Z.h...v..'|
-000000b0  c1 d9 32 55 f9 ce f5 92  e6 51                    |..2U.....Q|
+00000000  14 03 01 00 01 01 16 03  01 00 30 17 39 24 df 39  |..........0.9$.9|
+00000010  2f b4 09 7b d8 76 fa c2  0a e2 68 f9 23 0c be 1b  |/..{.v....h.#...|
+00000020  9d ba 91 16 2c f3 5b 6a  3d d3 63 12 35 76 91 38  |....,.[j=.c.5v.8|
+00000030  f3 a5 37 4a bc 65 f4 85  cb b8 65 17 03 01 00 20  |..7J.e....e.... |
+00000040  0c 59 ac 4f 44 97 46 bd  d5 ae 98 74 9f 86 3e ef  |.Y.OD.F....t..>.|
+00000050  b3 09 3c c4 0c 45 58 10  4f fd e0 be 86 ac 3e c8  |..<..EX.O.....>.|
+00000060  17 03 01 00 30 8c 76 1f  5a 4a 3b 98 4d 5c 0d c7  |....0.v.ZJ;.M\..|
+00000070  dc 55 df 70 ed 75 22 d2  a5 28 a7 4e 9f ed 83 3b  |.U.p.u"..(.N...;|
+00000080  88 85 7d 1a 7e f9 6f e7  f3 26 e1 b1 7b 4e 52 a5  |..}.~.o..&..{NR.|
+00000090  29 55 a4 04 df 15 03 01  00 20 8b 10 5c 79 5e f8  |)U....... ..\y^.|
+000000a0  1d 41 1c b2 05 fd 58 5a  80 69 e5 ce db c3 ac a4  |.A....XZ.i......|
+000000b0  e6 95 1d 9d 32 e2 66 4b  af 43                    |....2.fK.C|
diff --git a/src/crypto/tls/testdata/Server-TLSv10-RSA-RC4 b/src/crypto/tls/testdata/Server-TLSv10-RSA-RC4
index 8b1de03b0c..e07b8d855f 100644
--- a/src/crypto/tls/testdata/Server-TLSv10-RSA-RC4
+++ b/src/crypto/tls/testdata/Server-TLSv10-RSA-RC4
@@ -1,73 +1,70 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 63 01 00 00  5f 03 01 55 31 1a ed 02  |....c..._..U1...|
-00000010  35 fe 3c ea 62 08 52 96  93 bc 2a 1b 82 fe b9 8f  |5.<.b.R...*.....|
-00000020  7a 47 0e 6a 9b e8 86 ca  89 a0 e6 00 00 04 00 05  |zG.j............|
-00000030  00 ff 01 00 00 32 00 00  00 0e 00 0c 00 00 09 31  |.....2.........1|
-00000040  32 37 2e 30 2e 30 2e 31  00 0b 00 04 03 00 01 02  |27.0.0.1........|
-00000050  00 0a 00 0c 00 0a 00 1d  00 17 00 1e 00 19 00 18  |................|
-00000060  00 16 00 00 00 17 00 00                           |........|
+00000000  16 03 01 00 39 01 00 00  35 03 01 eb 78 34 78 f6  |....9...5...x4x.|
+00000010  8f 87 2f ee 5e da ee 37  5d 0a d5 79 d5 0e db b1  |../.^..7]..y....|
+00000020  b7 03 37 1f 2d ce 04 b9  2d 65 d7 00 00 04 00 05  |..7.-...-e......|
+00000030  00 ff 01 00 00 08 00 16  00 00 00 17 00 00        |..............|
 >>> Flow 2 (server to client)
-00000000  16 03 01 00 37 02 00 00  33 03 01 00 00 00 00 00  |....7...3.......|
+00000000  16 03 01 00 35 02 00 00  31 03 01 00 00 00 00 00  |....5...1.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 00 00 00 05 00 00  |...DOWNGRD......|
-00000030  0b ff 01 00 01 00 00 0b  00 02 01 00 16 03 01 02  |................|
-00000040  59 0b 00 02 55 00 02 52  00 02 4f 30 82 02 4b 30  |Y...U..R..O0..K0|
-00000050  82 01 b4 a0 03 02 01 02  02 09 00 e8 f0 9d 3f e2  |..............?.|
-00000060  5b ea a6 30 0d 06 09 2a  86 48 86 f7 0d 01 01 0b  |[..0...*.H......|
-00000070  05 00 30 1f 31 0b 30 09  06 03 55 04 0a 13 02 47  |..0.1.0...U....G|
-00000080  6f 31 10 30 0e 06 03 55  04 03 13 07 47 6f 20 52  |o1.0...U....Go R|
-00000090  6f 6f 74 30 1e 17 0d 31  36 30 31 30 31 30 30 30  |oot0...160101000|
-000000a0  30 30 30 5a 17 0d 32 35  30 31 30 31 30 30 30 30  |000Z..2501010000|
-000000b0  30 30 5a 30 1a 31 0b 30  09 06 03 55 04 0a 13 02  |00Z0.1.0...U....|
-000000c0  47 6f 31 0b 30 09 06 03  55 04 03 13 02 47 6f 30  |Go1.0...U....Go0|
-000000d0  81 9f 30 0d 06 09 2a 86  48 86 f7 0d 01 01 01 05  |..0...*.H.......|
-000000e0  00 03 81 8d 00 30 81 89  02 81 81 00 db 46 7d 93  |.....0.......F}.|
-000000f0  2e 12 27 06 48 bc 06 28  21 ab 7e c4 b6 a2 5d fe  |..'.H..(!.~...].|
-00000100  1e 52 45 88 7a 36 47 a5  08 0d 92 42 5b c2 81 c0  |.RE.z6G....B[...|
-00000110  be 97 79 98 40 fb 4f 6d  14 fd 2b 13 8b c2 a5 2e  |..y.@.Om..+.....|
-00000120  67 d8 d4 09 9e d6 22 38  b7 4a 0b 74 73 2b c2 34  |g....."8.J.ts+.4|
-00000130  f1 d1 93 e5 96 d9 74 7b  f3 58 9f 6c 61 3c c0 b0  |......t{.X.la<..|
-00000140  41 d4 d9 2b 2b 24 23 77  5b 1c 3b bd 75 5d ce 20  |A..++$#w[.;.u]. |
-00000150  54 cf a1 63 87 1d 1e 24  c4 f3 1d 1a 50 8b aa b6  |T..c...$....P...|
-00000160  14 43 ed 97 a7 75 62 f4  14 c8 52 d7 02 03 01 00  |.C...ub...R.....|
-00000170  01 a3 81 93 30 81 90 30  0e 06 03 55 1d 0f 01 01  |....0..0...U....|
-00000180  ff 04 04 03 02 05 a0 30  1d 06 03 55 1d 25 04 16  |.......0...U.%..|
-00000190  30 14 06 08 2b 06 01 05  05 07 03 01 06 08 2b 06  |0...+.........+.|
-000001a0  01 05 05 07 03 02 30 0c  06 03 55 1d 13 01 01 ff  |......0...U.....|
-000001b0  04 02 30 00 30 19 06 03  55 1d 0e 04 12 04 10 9f  |..0.0...U.......|
-000001c0  91 16 1f 43 43 3e 49 a6  de 6d b6 80 d7 9f 60 30  |...CC>I..m....`0|
-000001d0  1b 06 03 55 1d 23 04 14  30 12 80 10 48 13 49 4d  |...U.#..0...H.IM|
-000001e0  13 7e 16 31 bb a3 01 d5  ac ab 6e 7b 30 19 06 03  |.~.1......n{0...|
-000001f0  55 1d 11 04 12 30 10 82  0e 65 78 61 6d 70 6c 65  |U....0...example|
-00000200  2e 67 6f 6c 61 6e 67 30  0d 06 09 2a 86 48 86 f7  |.golang0...*.H..|
-00000210  0d 01 01 0b 05 00 03 81  81 00 9d 30 cc 40 2b 5b  |...........0.@+[|
-00000220  50 a0 61 cb ba e5 53 58  e1 ed 83 28 a9 58 1a a9  |P.a...SX...(.X..|
-00000230  38 a4 95 a1 ac 31 5a 1a  84 66 3d 43 d3 2d d9 0b  |8....1Z..f=C.-..|
-00000240  f2 97 df d3 20 64 38 92  24 3a 00 bc cf 9c 7d b7  |.... d8.$:....}.|
-00000250  40 20 01 5f aa d3 16 61  09 a2 76 fd 13 c3 cc e1  |@ ._...a..v.....|
-00000260  0c 5c ee b1 87 82 f1 6c  04 ed 73 bb b3 43 77 8d  |.\.....l..s..Cw.|
-00000270  0c 1c f1 0f a1 d8 40 83  61 c9 4c 72 2b 9d ae db  |......@.a.Lr+...|
-00000280  46 06 06 4d f4 c1 b3 3e  c0 d1 bd 42 d4 db fe 3d  |F..M...>...B...=|
-00000290  13 60 84 5c 21 d3 3b e9  fa e7 16 03 01 00 04 0e  |.`.\!.;.........|
-000002a0  00 00 00                                          |...|
+00000030  09 ff 01 00 01 00 00 17  00 00 16 03 01 02 59 0b  |..............Y.|
+00000040  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
+00000050  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
+00000060  a6 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |.0...*.H........|
+00000070  30 1f 31 0b 30 09 06 03  55 04 0a 13 02 47 6f 31  |0.1.0...U....Go1|
+00000080  10 30 0e 06 03 55 04 03  13 07 47 6f 20 52 6f 6f  |.0...U....Go Roo|
+00000090  74 30 1e 17 0d 31 36 30  31 30 31 30 30 30 30 30  |t0...16010100000|
+000000a0  30 5a 17 0d 32 35 30 31  30 31 30 30 30 30 30 30  |0Z..250101000000|
+000000b0  5a 30 1a 31 0b 30 09 06  03 55 04 0a 13 02 47 6f  |Z0.1.0...U....Go|
+000000c0  31 0b 30 09 06 03 55 04  03 13 02 47 6f 30 81 9f  |1.0...U....Go0..|
+000000d0  30 0d 06 09 2a 86 48 86  f7 0d 01 01 01 05 00 03  |0...*.H.........|
+000000e0  81 8d 00 30 81 89 02 81  81 00 db 46 7d 93 2e 12  |...0.......F}...|
+000000f0  27 06 48 bc 06 28 21 ab  7e c4 b6 a2 5d fe 1e 52  |'.H..(!.~...]..R|
+00000100  45 88 7a 36 47 a5 08 0d  92 42 5b c2 81 c0 be 97  |E.z6G....B[.....|
+00000110  79 98 40 fb 4f 6d 14 fd  2b 13 8b c2 a5 2e 67 d8  |y.@.Om..+.....g.|
+00000120  d4 09 9e d6 22 38 b7 4a  0b 74 73 2b c2 34 f1 d1  |...."8.J.ts+.4..|
+00000130  93 e5 96 d9 74 7b f3 58  9f 6c 61 3c c0 b0 41 d4  |....t{.X.la<..A.|
+00000140  d9 2b 2b 24 23 77 5b 1c  3b bd 75 5d ce 20 54 cf  |.++$#w[.;.u]. T.|
+00000150  a1 63 87 1d 1e 24 c4 f3  1d 1a 50 8b aa b6 14 43  |.c...$....P....C|
+00000160  ed 97 a7 75 62 f4 14 c8  52 d7 02 03 01 00 01 a3  |...ub...R.......|
+00000170  81 93 30 81 90 30 0e 06  03 55 1d 0f 01 01 ff 04  |..0..0...U......|
+00000180  04 03 02 05 a0 30 1d 06  03 55 1d 25 04 16 30 14  |.....0...U.%..0.|
+00000190  06 08 2b 06 01 05 05 07  03 01 06 08 2b 06 01 05  |..+.........+...|
+000001a0  05 07 03 02 30 0c 06 03  55 1d 13 01 01 ff 04 02  |....0...U.......|
+000001b0  30 00 30 19 06 03 55 1d  0e 04 12 04 10 9f 91 16  |0.0...U.........|
+000001c0  1f 43 43 3e 49 a6 de 6d  b6 80 d7 9f 60 30 1b 06  |.CC>I..m....`0..|
+000001d0  03 55 1d 23 04 14 30 12  80 10 48 13 49 4d 13 7e  |.U.#..0...H.IM.~|
+000001e0  16 31 bb a3 01 d5 ac ab  6e 7b 30 19 06 03 55 1d  |.1......n{0...U.|
+000001f0  11 04 12 30 10 82 0e 65  78 61 6d 70 6c 65 2e 67  |...0...example.g|
+00000200  6f 6c 61 6e 67 30 0d 06  09 2a 86 48 86 f7 0d 01  |olang0...*.H....|
+00000210  01 0b 05 00 03 81 81 00  9d 30 cc 40 2b 5b 50 a0  |.........0.@+[P.|
+00000220  61 cb ba e5 53 58 e1 ed  83 28 a9 58 1a a9 38 a4  |a...SX...(.X..8.|
+00000230  95 a1 ac 31 5a 1a 84 66  3d 43 d3 2d d9 0b f2 97  |...1Z..f=C.-....|
+00000240  df d3 20 64 38 92 24 3a  00 bc cf 9c 7d b7 40 20  |.. d8.$:....}.@ |
+00000250  01 5f aa d3 16 61 09 a2  76 fd 13 c3 cc e1 0c 5c  |._...a..v......\|
+00000260  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
+00000270  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
+00000280  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
+00000290  84 5c 21 d3 3b e9 fa e7  16 03 01 00 04 0e 00 00  |.\!.;...........|
+000002a0  00                                                |.|
 >>> Flow 3 (client to server)
-00000000  16 03 01 00 86 10 00 00  82 00 80 75 7d be e3 5b  |...........u}..[|
-00000010  66 4b 58 09 f7 86 6a ca  93 8e ba 3c 18 11 47 5e  |fKX...j....<..G^|
-00000020  7e c2 b1 0c 5e a4 c1 07  ef 25 00 d7 bf c7 b0 03  |~...^....%......|
-00000030  0d f6 ff a9 c2 73 a2 c0  dc 8d db f9 5a a9 18 7d  |.....s......Z..}|
-00000040  1f 8e 0b 9c 24 6c c8 49  99 e1 42 e0 86 d5 e1 e1  |....$l.I..B.....|
-00000050  d1 ae fd d2 c4 ef 07 8c  28 95 b7 54 25 57 40 1c  |........(..T%W@.|
-00000060  c6 af 85 46 a0 31 d4 39  b8 47 43 88 a0 a6 5d d7  |...F.1.9.GC...].|
-00000070  95 fb 88 64 ce 36 2b c5  56 85 56 40 f8 d4 d3 90  |...d.6+.V.V@....|
-00000080  d1 25 53 06 d8 ab a0 f2  21 8f 88 14 03 01 00 01  |.%S.....!.......|
-00000090  01 16 03 01 00 24 26 50  7a 2c ab 3f db 41 06 cf  |.....$&Pz,.?.A..|
-000000a0  8b 7b f8 46 ad a4 77 b6  06 f0 44 23 04 34 88 9d  |.{.F..w...D#.4..|
-000000b0  48 d7 5e cc 9e e6 46 a3  04 69                    |H.^...F..i|
+00000000  16 03 01 00 86 10 00 00  82 00 80 d4 db 61 0b 26  |.............a.&|
+00000010  06 af 94 37 9d fc 50 3f  50 4f 58 37 b9 b1 c2 d2  |...7..P?POX7....|
+00000020  92 2b f5 c9 fe 7f 3d f4  32 e3 ee ba 46 ea e5 36  |.+....=.2...F..6|
+00000030  9b fd c5 89 c9 14 45 e7  f7 ea 1a a9 63 c5 62 fb  |......E.....c.b.|
+00000040  34 c4 80 1e 59 60 39 d9  ca 68 3f 3f 1a f9 6a 14  |4...Y`9..h??..j.|
+00000050  f7 c8 91 3b 7d eb cc b9  8c 42 f1 ef d8 0f cd 17  |...;}....B......|
+00000060  64 f3 b8 30 6e 50 d4 23  bb 26 78 c3 fe f0 c4 42  |d..0nP.#.&x....B|
+00000070  0a 89 90 fb 43 fe 7f 0f  06 82 e8 7f fb 42 dd 46  |....C........B.F|
+00000080  fc 38 6e d0 14 05 41 b8  05 6b e7 14 03 01 00 01  |.8n...A..k......|
+00000090  01 16 03 01 00 24 b4 bb  3e 8f 6b 91 43 c2 b9 16  |.....$..>.k.C...|
+000000a0  59 ba 7d f9 89 a4 89 ce  12 c8 76 b0 e3 8f 36 03  |Y.}.......v...6.|
+000000b0  f7 48 03 7e 4a fe e5 8e  88 91                    |.H.~J.....|
 >>> Flow 4 (server to client)
-00000000  14 03 01 00 01 01 16 03  01 00 24 57 fc eb dd 40  |..........$W...@|
-00000010  83 1d 9a 9a 80 a3 62 a0  08 23 c3 97 fd d5 fb d7  |......b..#......|
-00000020  98 f8 14 ae 61 c7 21 fb  8a 18 1e c8 15 05 e7 17  |....a.!.........|
-00000030  03 01 00 21 7c 2b 2d 72  2f 63 56 3a 09 51 4e ab  |...!|+-r/cV:.QN.|
-00000040  31 25 c8 7e 34 5b a4 ab  30 87 50 07 ed 32 3f 79  |1%.~4[..0.P..2?y|
-00000050  f1 db c0 17 f3 15 03 01  00 16 fc ce c9 0c b6 0c  |................|
-00000060  c5 2d d9 3f 2a 9e 9a 83  40 e1 a3 b9 5f 89 aa 75  |.-.?*...@..._..u|
+00000000  14 03 01 00 01 01 16 03  01 00 24 06 5d 9f 70 98  |..........$.].p.|
+00000010  8b 42 79 f1 ba 73 40 8e  b3 f6 ff a1 45 57 c4 f3  |.By..s@.....EW..|
+00000020  6d 00 4e b5 52 f5 3d 08  b4 57 33 74 ab 6f 62 17  |m.N.R.=..W3t.ob.|
+00000030  03 01 00 21 6e 3a c7 a5  63 fb 81 78 10 9c 85 ab  |...!n:..c..x....|
+00000040  3d 3b 50 3a 12 0b c2 0f  f5 7e a2 d3 f7 82 3c 7f  |=;P:.....~....<.|
+00000050  45 29 2c 1e eb 15 03 01  00 16 66 a4 bb 6d d1 fc  |E),.......f..m..|
+00000060  36 b2 a9 e7 e5 7a da a1  37 f1 cf fa 8f 0c 73 f5  |6....z..7.....s.|
diff --git a/src/crypto/tls/testdata/Server-TLSv11-RSA-RC4 b/src/crypto/tls/testdata/Server-TLSv11-RSA-RC4
index dc70edf94b..27062da0d2 100644
--- a/src/crypto/tls/testdata/Server-TLSv11-RSA-RC4
+++ b/src/crypto/tls/testdata/Server-TLSv11-RSA-RC4
@@ -1,73 +1,70 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 63 01 00 00  5f 03 02 2b b6 22 28 e3  |....c..._..+."(.|
-00000010  1f 42 f4 2e d0 43 4b 9a  ea 2b 36 44 ca 93 6c 71  |.B...CK..+6D..lq|
-00000020  b9 4d 52 44 64 57 b2 05  9b 41 da 00 00 04 00 05  |.MRDdW...A......|
-00000030  00 ff 01 00 00 32 00 00  00 0e 00 0c 00 00 09 31  |.....2.........1|
-00000040  32 37 2e 30 2e 30 2e 31  00 0b 00 04 03 00 01 02  |27.0.0.1........|
-00000050  00 0a 00 0c 00 0a 00 1d  00 17 00 1e 00 19 00 18  |................|
-00000060  00 16 00 00 00 17 00 00                           |........|
+00000000  16 03 01 00 39 01 00 00  35 03 02 ac 4f 36 f3 4c  |....9...5...O6.L|
+00000010  64 ae 8d fc 50 a3 e1 e4  70 5d ba 8c de de c8 07  |d...P...p]......|
+00000020  70 24 8d bd c1 69 a3 0e  ad 16 38 00 00 04 00 05  |p$...i....8.....|
+00000030  00 ff 01 00 00 08 00 16  00 00 00 17 00 00        |..............|
 >>> Flow 2 (server to client)
-00000000  16 03 02 00 37 02 00 00  33 03 02 00 00 00 00 00  |....7...3.......|
+00000000  16 03 02 00 35 02 00 00  31 03 02 00 00 00 00 00  |....5...1.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 00 00 00 05 00 00  |...DOWNGRD......|
-00000030  0b ff 01 00 01 00 00 0b  00 02 01 00 16 03 02 02  |................|
-00000040  59 0b 00 02 55 00 02 52  00 02 4f 30 82 02 4b 30  |Y...U..R..O0..K0|
-00000050  82 01 b4 a0 03 02 01 02  02 09 00 e8 f0 9d 3f e2  |..............?.|
-00000060  5b ea a6 30 0d 06 09 2a  86 48 86 f7 0d 01 01 0b  |[..0...*.H......|
-00000070  05 00 30 1f 31 0b 30 09  06 03 55 04 0a 13 02 47  |..0.1.0...U....G|
-00000080  6f 31 10 30 0e 06 03 55  04 03 13 07 47 6f 20 52  |o1.0...U....Go R|
-00000090  6f 6f 74 30 1e 17 0d 31  36 30 31 30 31 30 30 30  |oot0...160101000|
-000000a0  30 30 30 5a 17 0d 32 35  30 31 30 31 30 30 30 30  |000Z..2501010000|
-000000b0  30 30 5a 30 1a 31 0b 30  09 06 03 55 04 0a 13 02  |00Z0.1.0...U....|
-000000c0  47 6f 31 0b 30 09 06 03  55 04 03 13 02 47 6f 30  |Go1.0...U....Go0|
-000000d0  81 9f 30 0d 06 09 2a 86  48 86 f7 0d 01 01 01 05  |..0...*.H.......|
-000000e0  00 03 81 8d 00 30 81 89  02 81 81 00 db 46 7d 93  |.....0.......F}.|
-000000f0  2e 12 27 06 48 bc 06 28  21 ab 7e c4 b6 a2 5d fe  |..'.H..(!.~...].|
-00000100  1e 52 45 88 7a 36 47 a5  08 0d 92 42 5b c2 81 c0  |.RE.z6G....B[...|
-00000110  be 97 79 98 40 fb 4f 6d  14 fd 2b 13 8b c2 a5 2e  |..y.@.Om..+.....|
-00000120  67 d8 d4 09 9e d6 22 38  b7 4a 0b 74 73 2b c2 34  |g....."8.J.ts+.4|
-00000130  f1 d1 93 e5 96 d9 74 7b  f3 58 9f 6c 61 3c c0 b0  |......t{.X.la<..|
-00000140  41 d4 d9 2b 2b 24 23 77  5b 1c 3b bd 75 5d ce 20  |A..++$#w[.;.u]. |
-00000150  54 cf a1 63 87 1d 1e 24  c4 f3 1d 1a 50 8b aa b6  |T..c...$....P...|
-00000160  14 43 ed 97 a7 75 62 f4  14 c8 52 d7 02 03 01 00  |.C...ub...R.....|
-00000170  01 a3 81 93 30 81 90 30  0e 06 03 55 1d 0f 01 01  |....0..0...U....|
-00000180  ff 04 04 03 02 05 a0 30  1d 06 03 55 1d 25 04 16  |.......0...U.%..|
-00000190  30 14 06 08 2b 06 01 05  05 07 03 01 06 08 2b 06  |0...+.........+.|
-000001a0  01 05 05 07 03 02 30 0c  06 03 55 1d 13 01 01 ff  |......0...U.....|
-000001b0  04 02 30 00 30 19 06 03  55 1d 0e 04 12 04 10 9f  |..0.0...U.......|
-000001c0  91 16 1f 43 43 3e 49 a6  de 6d b6 80 d7 9f 60 30  |...CC>I..m....`0|
-000001d0  1b 06 03 55 1d 23 04 14  30 12 80 10 48 13 49 4d  |...U.#..0...H.IM|
-000001e0  13 7e 16 31 bb a3 01 d5  ac ab 6e 7b 30 19 06 03  |.~.1......n{0...|
-000001f0  55 1d 11 04 12 30 10 82  0e 65 78 61 6d 70 6c 65  |U....0...example|
-00000200  2e 67 6f 6c 61 6e 67 30  0d 06 09 2a 86 48 86 f7  |.golang0...*.H..|
-00000210  0d 01 01 0b 05 00 03 81  81 00 9d 30 cc 40 2b 5b  |...........0.@+[|
-00000220  50 a0 61 cb ba e5 53 58  e1 ed 83 28 a9 58 1a a9  |P.a...SX...(.X..|
-00000230  38 a4 95 a1 ac 31 5a 1a  84 66 3d 43 d3 2d d9 0b  |8....1Z..f=C.-..|
-00000240  f2 97 df d3 20 64 38 92  24 3a 00 bc cf 9c 7d b7  |.... d8.$:....}.|
-00000250  40 20 01 5f aa d3 16 61  09 a2 76 fd 13 c3 cc e1  |@ ._...a..v.....|
-00000260  0c 5c ee b1 87 82 f1 6c  04 ed 73 bb b3 43 77 8d  |.\.....l..s..Cw.|
-00000270  0c 1c f1 0f a1 d8 40 83  61 c9 4c 72 2b 9d ae db  |......@.a.Lr+...|
-00000280  46 06 06 4d f4 c1 b3 3e  c0 d1 bd 42 d4 db fe 3d  |F..M...>...B...=|
-00000290  13 60 84 5c 21 d3 3b e9  fa e7 16 03 02 00 04 0e  |.`.\!.;.........|
-000002a0  00 00 00                                          |...|
+00000030  09 ff 01 00 01 00 00 17  00 00 16 03 02 02 59 0b  |..............Y.|
+00000040  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
+00000050  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
+00000060  a6 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |.0...*.H........|
+00000070  30 1f 31 0b 30 09 06 03  55 04 0a 13 02 47 6f 31  |0.1.0...U....Go1|
+00000080  10 30 0e 06 03 55 04 03  13 07 47 6f 20 52 6f 6f  |.0...U....Go Roo|
+00000090  74 30 1e 17 0d 31 36 30  31 30 31 30 30 30 30 30  |t0...16010100000|
+000000a0  30 5a 17 0d 32 35 30 31  30 31 30 30 30 30 30 30  |0Z..250101000000|
+000000b0  5a 30 1a 31 0b 30 09 06  03 55 04 0a 13 02 47 6f  |Z0.1.0...U....Go|
+000000c0  31 0b 30 09 06 03 55 04  03 13 02 47 6f 30 81 9f  |1.0...U....Go0..|
+000000d0  30 0d 06 09 2a 86 48 86  f7 0d 01 01 01 05 00 03  |0...*.H.........|
+000000e0  81 8d 00 30 81 89 02 81  81 00 db 46 7d 93 2e 12  |...0.......F}...|
+000000f0  27 06 48 bc 06 28 21 ab  7e c4 b6 a2 5d fe 1e 52  |'.H..(!.~...]..R|
+00000100  45 88 7a 36 47 a5 08 0d  92 42 5b c2 81 c0 be 97  |E.z6G....B[.....|
+00000110  79 98 40 fb 4f 6d 14 fd  2b 13 8b c2 a5 2e 67 d8  |y.@.Om..+.....g.|
+00000120  d4 09 9e d6 22 38 b7 4a  0b 74 73 2b c2 34 f1 d1  |...."8.J.ts+.4..|
+00000130  93 e5 96 d9 74 7b f3 58  9f 6c 61 3c c0 b0 41 d4  |....t{.X.la<..A.|
+00000140  d9 2b 2b 24 23 77 5b 1c  3b bd 75 5d ce 20 54 cf  |.++$#w[.;.u]. T.|
+00000150  a1 63 87 1d 1e 24 c4 f3  1d 1a 50 8b aa b6 14 43  |.c...$....P....C|
+00000160  ed 97 a7 75 62 f4 14 c8  52 d7 02 03 01 00 01 a3  |...ub...R.......|
+00000170  81 93 30 81 90 30 0e 06  03 55 1d 0f 01 01 ff 04  |..0..0...U......|
+00000180  04 03 02 05 a0 30 1d 06  03 55 1d 25 04 16 30 14  |.....0...U.%..0.|
+00000190  06 08 2b 06 01 05 05 07  03 01 06 08 2b 06 01 05  |..+.........+...|
+000001a0  05 07 03 02 30 0c 06 03  55 1d 13 01 01 ff 04 02  |....0...U.......|
+000001b0  30 00 30 19 06 03 55 1d  0e 04 12 04 10 9f 91 16  |0.0...U.........|
+000001c0  1f 43 43 3e 49 a6 de 6d  b6 80 d7 9f 60 30 1b 06  |.CC>I..m....`0..|
+000001d0  03 55 1d 23 04 14 30 12  80 10 48 13 49 4d 13 7e  |.U.#..0...H.IM.~|
+000001e0  16 31 bb a3 01 d5 ac ab  6e 7b 30 19 06 03 55 1d  |.1......n{0...U.|
+000001f0  11 04 12 30 10 82 0e 65  78 61 6d 70 6c 65 2e 67  |...0...example.g|
+00000200  6f 6c 61 6e 67 30 0d 06  09 2a 86 48 86 f7 0d 01  |olang0...*.H....|
+00000210  01 0b 05 00 03 81 81 00  9d 30 cc 40 2b 5b 50 a0  |.........0.@+[P.|
+00000220  61 cb ba e5 53 58 e1 ed  83 28 a9 58 1a a9 38 a4  |a...SX...(.X..8.|
+00000230  95 a1 ac 31 5a 1a 84 66  3d 43 d3 2d d9 0b f2 97  |...1Z..f=C.-....|
+00000240  df d3 20 64 38 92 24 3a  00 bc cf 9c 7d b7 40 20  |.. d8.$:....}.@ |
+00000250  01 5f aa d3 16 61 09 a2  76 fd 13 c3 cc e1 0c 5c  |._...a..v......\|
+00000260  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
+00000270  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
+00000280  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
+00000290  84 5c 21 d3 3b e9 fa e7  16 03 02 00 04 0e 00 00  |.\!.;...........|
+000002a0  00                                                |.|
 >>> Flow 3 (client to server)
-00000000  16 03 02 00 86 10 00 00  82 00 80 3d 47 85 0a ef  |...........=G...|
-00000010  47 7c c5 93 bb 6f 7c 57  dc 2b 3f f4 e7 da 4e fc  |G|...o|W.+?...N.|
-00000020  04 52 36 71 c5 63 1f 6f  e6 43 91 06 bc 5c 14 b0  |.R6q.c.o.C...\..|
-00000030  ee 83 ed 3d 7a d2 4e 2c  d2 2c bb f0 0c b5 82 d5  |...=z.N,.,......|
-00000040  9d c2 5a 03 12 b6 70 20  3c 89 84 af 1b 2c 2f b7  |..Z...p <....,/.|
-00000050  9b fe dd 71 06 ac 46 30  a7 b5 9f 0b aa 6e 58 50  |...q..F0.....nXP|
-00000060  9d da 6b ba 00 51 e9 2a  e9 d2 e9 0f 83 62 73 19  |..k..Q.*.....bs.|
-00000070  91 a4 46 bd 53 42 f7 15  ab ab 6b 8f f3 6f d1 07  |..F.SB....k..o..|
-00000080  44 41 97 4c 7d 89 4b 33  55 30 30 14 03 02 00 01  |DA.L}.K3U00.....|
-00000090  01 16 03 02 00 24 54 fe  a0 7c 16 47 de 0b 8f 7d  |.....$T..|.G...}|
-000000a0  51 68 05 da 1e 6d 96 c9  e1 94 68 fa 79 46 02 db  |Qh...m....h.yF..|
-000000b0  03 4e 2e 70 9f 7e 14 85  fd 1d                    |.N.p.~....|
+00000000  16 03 02 00 86 10 00 00  82 00 80 49 c4 5f 04 e0  |...........I._..|
+00000010  63 96 72 bd c9 00 af 17  b1 59 b4 c7 40 a5 b7 b5  |c.r......Y..@...|
+00000020  68 79 d2 7b b0 2a e7 06  7e 97 ad da d8 3f cb f8  |hy.{.*..~....?..|
+00000030  7c b9 f1 9d be 49 7c 09  6a b0 25 49 9c 06 2a c3  ||....I|.j.%I..*.|
+00000040  d5 0a ae cc cc 08 31 5d  14 82 06 a7 57 fc 66 9c  |......1]....W.f.|
+00000050  90 b7 be aa 15 46 2b aa  ae fc 3a ce 3d 64 4e 80  |.....F+...:.=dN.|
+00000060  90 3f 77 c6 60 cd 6b dc  69 c1 92 a9 1e 8e 30 6a  |.?w.`.k.i.....0j|
+00000070  34 a3 db 1a f5 a3 f9 ac  1c 07 4f be 38 d1 a5 61  |4.........O.8..a|
+00000080  e5 5f 84 99 f0 87 40 dc  b2 cc 05 14 03 02 00 01  |._....@.........|
+00000090  01 16 03 02 00 24 eb d9  48 20 7b db 97 48 f2 c7  |.....$..H {..H..|
+000000a0  bb c1 ef fa 74 44 d8 a1  55 63 f3 d0 90 ef f2 0b  |....tD..Uc......|
+000000b0  67 10 98 27 76 8a 70 78  0b df                    |g..'v.px..|
 >>> Flow 4 (server to client)
-00000000  14 03 02 00 01 01 16 03  02 00 24 4b c5 cf 20 3f  |..........$K.. ?|
-00000010  0a 13 1f 55 25 26 9b 33  fd 14 61 0f 44 32 26 b3  |...U%&.3..a.D2&.|
-00000020  ab 01 ee c2 1f d3 38 08  f0 af 76 6a 0d e1 b7 17  |......8...vj....|
-00000030  03 02 00 21 97 16 df 99  06 81 f2 00 d3 fd b4 03  |...!............|
-00000040  be 16 b6 aa 74 d4 c7 25  67 94 14 34 25 ec 0d 12  |....t..%g..4%...|
-00000050  c7 43 2d a2 1d 15 03 02  00 16 94 58 af 6b 55 5f  |.C-........X.kU_|
-00000060  25 0c 80 28 99 2d 75 1a  ce 24 cd 75 0d 7f b9 71  |%..(.-u..$.u...q|
+00000000  14 03 02 00 01 01 16 03  02 00 24 41 50 b9 88 0e  |..........$AP...|
+00000010  3f 27 36 f0 27 70 ca b8  bc 38 df e9 68 3e 29 cf  |?'6.'p...8..h>).|
+00000020  80 b5 e8 59 bd 52 45 b7  0d fa a7 6d 77 a0 9e 17  |...Y.RE....mw...|
+00000030  03 02 00 21 94 2a 6a ca  f0 b3 7e 1c d6 58 3f 64  |...!.*j...~..X?d|
+00000040  ef 62 35 72 aa c6 84 7b  19 c6 07 0e 04 63 c4 14  |.b5r...{.....c..|
+00000050  43 d8 73 ff 2f 15 03 02  00 16 5a 45 ba 51 95 c9  |C.s./.....ZE.Q..|
+00000060  53 2a a6 b1 61 35 db 0a  7b f9 8e a9 fb 18 87 b1  |S*..a5..{.......|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ALPN b/src/crypto/tls/testdata/Server-TLSv12-ALPN
index 0dc338e2c2..0f4d5ce2c5 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ALPN
+++ b/src/crypto/tls/testdata/Server-TLSv12-ALPN
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 9d 01 00 00  99 03 03 a8 f7 f4 62 fd  |..............b.|
-00000010  2b d9 41 3a 08 1f a3 b9  94 bf 2f fc 54 fc bf 65  |+.A:....../.T..e|
-00000020  c6 5a e9 8d fc cd 72 b8  55 37 85 00 00 04 cc a8  |.Z....r.U7......|
+00000000  16 03 01 00 9d 01 00 00  99 03 03 a6 c5 fc 08 ce  |................|
+00000010  f9 05 f6 4b 12 1e 20 ca  fc b6 02 b7 67 bb 79 28  |...K.. .....g.y(|
+00000020  05 83 47 61 c3 6a f6 de  ad 77 fa 00 00 04 cc a8  |..Ga.j...w......|
 00000030  00 ff 01 00 00 6c 00 0b  00 04 03 00 01 02 00 0a  |.....l..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000050  00 00 00 10 00 10 00 0e  06 70 72 6f 74 6f 32 06  |.........proto2.|
@@ -11,81 +11,81 @@
 00000090  03 03 02 03 03 01 02 01  03 02 02 02 04 02 05 02  |................|
 000000a0  06 02                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 48 02 00 00  44 03 03 00 00 00 00 00  |....H...D.......|
+00000000  16 03 03 00 4c 02 00 00  48 03 03 00 00 00 00 00  |....L...H.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 cc a8 00 00  |...DOWNGRD......|
-00000030  1c 00 23 00 00 ff 01 00  01 00 00 10 00 09 00 07  |..#.............|
-00000040  06 70 72 6f 74 6f 31 00  0b 00 02 01 00 16 03 03  |.proto1.........|
-00000050  02 59 0b 00 02 55 00 02  52 00 02 4f 30 82 02 4b  |.Y...U..R..O0..K|
-00000060  30 82 01 b4 a0 03 02 01  02 02 09 00 e8 f0 9d 3f  |0..............?|
-00000070  e2 5b ea a6 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |.[..0...*.H.....|
-00000080  0b 05 00 30 1f 31 0b 30  09 06 03 55 04 0a 13 02  |...0.1.0...U....|
-00000090  47 6f 31 10 30 0e 06 03  55 04 03 13 07 47 6f 20  |Go1.0...U....Go |
-000000a0  52 6f 6f 74 30 1e 17 0d  31 36 30 31 30 31 30 30  |Root0...16010100|
-000000b0  30 30 30 30 5a 17 0d 32  35 30 31 30 31 30 30 30  |0000Z..250101000|
-000000c0  30 30 30 5a 30 1a 31 0b  30 09 06 03 55 04 0a 13  |000Z0.1.0...U...|
-000000d0  02 47 6f 31 0b 30 09 06  03 55 04 03 13 02 47 6f  |.Go1.0...U....Go|
-000000e0  30 81 9f 30 0d 06 09 2a  86 48 86 f7 0d 01 01 01  |0..0...*.H......|
-000000f0  05 00 03 81 8d 00 30 81  89 02 81 81 00 db 46 7d  |......0.......F}|
-00000100  93 2e 12 27 06 48 bc 06  28 21 ab 7e c4 b6 a2 5d  |...'.H..(!.~...]|
-00000110  fe 1e 52 45 88 7a 36 47  a5 08 0d 92 42 5b c2 81  |..RE.z6G....B[..|
-00000120  c0 be 97 79 98 40 fb 4f  6d 14 fd 2b 13 8b c2 a5  |...y.@.Om..+....|
-00000130  2e 67 d8 d4 09 9e d6 22  38 b7 4a 0b 74 73 2b c2  |.g....."8.J.ts+.|
-00000140  34 f1 d1 93 e5 96 d9 74  7b f3 58 9f 6c 61 3c c0  |4......t{.X.la<.|
-00000150  b0 41 d4 d9 2b 2b 24 23  77 5b 1c 3b bd 75 5d ce  |.A..++$#w[.;.u].|
-00000160  20 54 cf a1 63 87 1d 1e  24 c4 f3 1d 1a 50 8b aa  | T..c...$....P..|
-00000170  b6 14 43 ed 97 a7 75 62  f4 14 c8 52 d7 02 03 01  |..C...ub...R....|
-00000180  00 01 a3 81 93 30 81 90  30 0e 06 03 55 1d 0f 01  |.....0..0...U...|
-00000190  01 ff 04 04 03 02 05 a0  30 1d 06 03 55 1d 25 04  |........0...U.%.|
-000001a0  16 30 14 06 08 2b 06 01  05 05 07 03 01 06 08 2b  |.0...+.........+|
-000001b0  06 01 05 05 07 03 02 30  0c 06 03 55 1d 13 01 01  |.......0...U....|
-000001c0  ff 04 02 30 00 30 19 06  03 55 1d 0e 04 12 04 10  |...0.0...U......|
-000001d0  9f 91 16 1f 43 43 3e 49  a6 de 6d b6 80 d7 9f 60  |....CC>I..m....`|
-000001e0  30 1b 06 03 55 1d 23 04  14 30 12 80 10 48 13 49  |0...U.#..0...H.I|
-000001f0  4d 13 7e 16 31 bb a3 01  d5 ac ab 6e 7b 30 19 06  |M.~.1......n{0..|
-00000200  03 55 1d 11 04 12 30 10  82 0e 65 78 61 6d 70 6c  |.U....0...exampl|
-00000210  65 2e 67 6f 6c 61 6e 67  30 0d 06 09 2a 86 48 86  |e.golang0...*.H.|
-00000220  f7 0d 01 01 0b 05 00 03  81 81 00 9d 30 cc 40 2b  |............0.@+|
-00000230  5b 50 a0 61 cb ba e5 53  58 e1 ed 83 28 a9 58 1a  |[P.a...SX...(.X.|
-00000240  a9 38 a4 95 a1 ac 31 5a  1a 84 66 3d 43 d3 2d d9  |.8....1Z..f=C.-.|
-00000250  0b f2 97 df d3 20 64 38  92 24 3a 00 bc cf 9c 7d  |..... d8.$:....}|
-00000260  b7 40 20 01 5f aa d3 16  61 09 a2 76 fd 13 c3 cc  |.@ ._...a..v....|
-00000270  e1 0c 5c ee b1 87 82 f1  6c 04 ed 73 bb b3 43 77  |..\.....l..s..Cw|
-00000280  8d 0c 1c f1 0f a1 d8 40  83 61 c9 4c 72 2b 9d ae  |.......@.a.Lr+..|
-00000290  db 46 06 06 4d f4 c1 b3  3e c0 d1 bd 42 d4 db fe  |.F..M...>...B...|
-000002a0  3d 13 60 84 5c 21 d3 3b  e9 fa e7 16 03 03 00 ac  |=.`.\!.;........|
-000002b0  0c 00 00 a8 03 00 1d 20  2f e5 7d a3 47 cd 62 43  |....... /.}.G.bC|
-000002c0  15 28 da ac 5f bb 29 07  30 ff f6 84 af c4 cf c2  |.(.._.).0.......|
-000002d0  ed 90 99 5f 58 cb 3b 74  08 04 00 80 4f 05 7c c3  |..._X.;t....O.|.|
-000002e0  96 ca f9 10 21 59 a9 2a  63 fc be b5 cf 4d 0c 01  |....!Y.*c....M..|
-000002f0  a2 4a 6a 3d 29 aa b1 bf  eb 7a aa 22 a3 4e b4 db  |.Jj=)....z.".N..|
-00000300  c8 e5 4c d2 3f b1 3a 04  90 11 3b aa 2d be c9 20  |..L.?.:...;.-.. |
-00000310  42 f0 2a 43 d4 33 3d d3  5e bb e6 59 87 5d 04 c7  |B.*C.3=.^..Y.]..|
-00000320  a5 32 75 51 b6 55 18 4d  29 72 2d cc 17 12 08 f4  |.2uQ.U.M)r-.....|
-00000330  bf cf 61 2a 67 59 e0 8f  9f c9 57 8a a0 7e 1e bd  |..a*gY....W..~..|
-00000340  2e 06 3d 0c 1f b2 83 50  08 8f 88 40 5d 9d a8 3d  |..=....P...@]..=|
-00000350  93 e9 cc 70 8a 05 ab a5  af cd 75 81 16 03 03 00  |...p......u.....|
-00000360  04 0e 00 00 00                                    |.....|
+00000030  20 00 23 00 00 ff 01 00  01 00 00 17 00 00 00 10  | .#.............|
+00000040  00 09 00 07 06 70 72 6f  74 6f 31 00 0b 00 02 01  |.....proto1.....|
+00000050  00 16 03 03 02 59 0b 00  02 55 00 02 52 00 02 4f  |.....Y...U..R..O|
+00000060  30 82 02 4b 30 82 01 b4  a0 03 02 01 02 02 09 00  |0..K0...........|
+00000070  e8 f0 9d 3f e2 5b ea a6  30 0d 06 09 2a 86 48 86  |...?.[..0...*.H.|
+00000080  f7 0d 01 01 0b 05 00 30  1f 31 0b 30 09 06 03 55  |.......0.1.0...U|
+00000090  04 0a 13 02 47 6f 31 10  30 0e 06 03 55 04 03 13  |....Go1.0...U...|
+000000a0  07 47 6f 20 52 6f 6f 74  30 1e 17 0d 31 36 30 31  |.Go Root0...1601|
+000000b0  30 31 30 30 30 30 30 30  5a 17 0d 32 35 30 31 30  |01000000Z..25010|
+000000c0  31 30 30 30 30 30 30 5a  30 1a 31 0b 30 09 06 03  |1000000Z0.1.0...|
+000000d0  55 04 0a 13 02 47 6f 31  0b 30 09 06 03 55 04 03  |U....Go1.0...U..|
+000000e0  13 02 47 6f 30 81 9f 30  0d 06 09 2a 86 48 86 f7  |..Go0..0...*.H..|
+000000f0  0d 01 01 01 05 00 03 81  8d 00 30 81 89 02 81 81  |..........0.....|
+00000100  00 db 46 7d 93 2e 12 27  06 48 bc 06 28 21 ab 7e  |..F}...'.H..(!.~|
+00000110  c4 b6 a2 5d fe 1e 52 45  88 7a 36 47 a5 08 0d 92  |...]..RE.z6G....|
+00000120  42 5b c2 81 c0 be 97 79  98 40 fb 4f 6d 14 fd 2b  |B[.....y.@.Om..+|
+00000130  13 8b c2 a5 2e 67 d8 d4  09 9e d6 22 38 b7 4a 0b  |.....g....."8.J.|
+00000140  74 73 2b c2 34 f1 d1 93  e5 96 d9 74 7b f3 58 9f  |ts+.4......t{.X.|
+00000150  6c 61 3c c0 b0 41 d4 d9  2b 2b 24 23 77 5b 1c 3b  |la<..A..++$#w[.;|
+00000160  bd 75 5d ce 20 54 cf a1  63 87 1d 1e 24 c4 f3 1d  |.u]. T..c...$...|
+00000170  1a 50 8b aa b6 14 43 ed  97 a7 75 62 f4 14 c8 52  |.P....C...ub...R|
+00000180  d7 02 03 01 00 01 a3 81  93 30 81 90 30 0e 06 03  |.........0..0...|
+00000190  55 1d 0f 01 01 ff 04 04  03 02 05 a0 30 1d 06 03  |U...........0...|
+000001a0  55 1d 25 04 16 30 14 06  08 2b 06 01 05 05 07 03  |U.%..0...+......|
+000001b0  01 06 08 2b 06 01 05 05  07 03 02 30 0c 06 03 55  |...+.......0...U|
+000001c0  1d 13 01 01 ff 04 02 30  00 30 19 06 03 55 1d 0e  |.......0.0...U..|
+000001d0  04 12 04 10 9f 91 16 1f  43 43 3e 49 a6 de 6d b6  |........CC>I..m.|
+000001e0  80 d7 9f 60 30 1b 06 03  55 1d 23 04 14 30 12 80  |...`0...U.#..0..|
+000001f0  10 48 13 49 4d 13 7e 16  31 bb a3 01 d5 ac ab 6e  |.H.IM.~.1......n|
+00000200  7b 30 19 06 03 55 1d 11  04 12 30 10 82 0e 65 78  |{0...U....0...ex|
+00000210  61 6d 70 6c 65 2e 67 6f  6c 61 6e 67 30 0d 06 09  |ample.golang0...|
+00000220  2a 86 48 86 f7 0d 01 01  0b 05 00 03 81 81 00 9d  |*.H.............|
+00000230  30 cc 40 2b 5b 50 a0 61  cb ba e5 53 58 e1 ed 83  |0.@+[P.a...SX...|
+00000240  28 a9 58 1a a9 38 a4 95  a1 ac 31 5a 1a 84 66 3d  |(.X..8....1Z..f=|
+00000250  43 d3 2d d9 0b f2 97 df  d3 20 64 38 92 24 3a 00  |C.-...... d8.$:.|
+00000260  bc cf 9c 7d b7 40 20 01  5f aa d3 16 61 09 a2 76  |...}.@ ._...a..v|
+00000270  fd 13 c3 cc e1 0c 5c ee  b1 87 82 f1 6c 04 ed 73  |......\.....l..s|
+00000280  bb b3 43 77 8d 0c 1c f1  0f a1 d8 40 83 61 c9 4c  |..Cw.......@.a.L|
+00000290  72 2b 9d ae db 46 06 06  4d f4 c1 b3 3e c0 d1 bd  |r+...F..M...>...|
+000002a0  42 d4 db fe 3d 13 60 84  5c 21 d3 3b e9 fa e7 16  |B...=.`.\!.;....|
+000002b0  03 03 00 ac 0c 00 00 a8  03 00 1d 20 2f e5 7d a3  |........... /.}.|
+000002c0  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
+000002d0  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 08 04 00 80  |......._X.;t....|
+000002e0  c9 8f 67 ae 81 28 f7 3e  16 8b ad 1c a9 2a 88 e8  |..g..(.>.....*..|
+000002f0  1d ab 73 44 7f cf 6f 79  9c 31 d6 74 35 cf 01 3c  |..sD..oy.1.t5..<|
+00000300  c6 72 5f 2c e3 f8 83 13  f0 49 28 82 12 2d b4 f3  |.r_,.....I(..-..|
+00000310  1a 38 e2 cf 6f 78 5e 4c  22 29 ca e3 3a 72 74 80  |.8..ox^L")..:rt.|
+00000320  18 41 59 b7 99 6c 0a 2e  32 75 9a d0 a5 88 48 ff  |.AY..l..2u....H.|
+00000330  5c 85 bc c7 ea ad 0b db  81 f0 86 56 fb e9 3a fd  |\..........V..:.|
+00000340  7e 6a 7e 09 b0 b6 bf 28  14 40 e6 93 50 56 96 41  |~j~....(.@..PV.A|
+00000350  27 ae 72 f6 5e 67 a6 f3  73 f7 0a 13 f1 a3 72 07  |'.r.^g..s.....r.|
+00000360  16 03 03 00 04 0e 00 00  00                       |.........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 8a e9 9e c4 7f 94  |....%...! ......|
-00000010  a6 2b ed 7d de 1f 3d e1  dc b9 36 b9 1a 90 57 17  |.+.}..=...6...W.|
-00000020  fc 06 0f 74 9c 04 4e 2e  6e 5f 14 03 03 00 01 01  |...t..N.n_......|
-00000030  16 03 03 00 20 71 01 29  a9 89 d3 ce ba 8d 91 96  |.... q.)........|
-00000040  10 e8 90 5b 9b 5c 4d 17  40 6e b7 69 25 ce 15 1d  |...[.\M.@n.i%...|
-00000050  0f ec ff 86 fe                                    |.....|
+00000000  16 03 03 00 25 10 00 00  21 20 ee 14 87 73 f6 c2  |....%...! ...s..|
+00000010  57 7e ba c4 1e 06 fc 75  c6 2b 1a 45 96 58 90 95  |W~.....u.+.E.X..|
+00000020  1e f6 53 ac 10 ff 1c 0b  b2 4d 14 03 03 00 01 01  |..S......M......|
+00000030  16 03 03 00 20 87 9a d0  7f 4c 68 fc cd 3e b8 20  |.... ....Lh..>. |
+00000040  d3 b8 a0 ec 05 ad 95 62  81 b3 12 2a 8b 44 7b 87  |.......b...*.D{.|
+00000050  02 10 38 5d 69                                    |..8]i|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 7f 04 00 00  7b 00 00 00 00 00 75 00  |........{.....u.|
+00000000  16 03 03 00 80 04 00 00  7c 00 00 00 00 00 76 00  |........|.....v.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6f 2d 7c 2b 51 ed 14 ef  68 ca 42 c5 4c ed 10 ee  |o-|+Q...h.B.L...|
-00000030  2e 3f 7c c5 f4 bd af 04  18 a4 76 3d 61 1c 7c c4  |.?|.......v=a.|.|
-00000040  00 93 f6 69 ba 5f 90 14  57 55 05 89 27 80 57 df  |...i._..WU..'.W.|
-00000050  d5 d5 fb 4c e0 45 64 8b  67 28 58 7b 18 49 38 16  |...L.Ed.g(X{.I8.|
-00000060  7f 51 5c e5 28 cf 13 b4  e5 60 f7 5e 60 4c 44 84  |.Q\.(....`.^`LD.|
-00000070  c3 2e 8a c1 db e4 7f e2  13 35 84 47 ef 1a db 4d  |.........5.G...M|
-00000080  e8 34 53 56 14 03 03 00  01 01 16 03 03 00 20 47  |.4SV.......... G|
-00000090  fa 88 ff 79 40 30 ab 4d  9c 2b c1 e0 10 60 eb 4a  |...y@0.M.+...`.J|
-000000a0  5d 9f 6d 74 01 f0 f8 15  1d 13 79 cd fb 30 88 17  |].mt......y..0..|
-000000b0  03 03 00 1d 48 00 42 d7  1c 5f 8d 04 bd 78 3f e6  |....H.B.._...x?.|
-000000c0  6c c8 79 ba e1 5e 87 82  49 3d 55 37 6e 3f 04 be  |l.y..^..I=U7n?..|
-000000d0  5a 15 03 03 00 12 75 d9  4c 34 ae c9 7b 3c 1e 6c  |Z.....u.L4..{<.l|
-000000e0  cf 34 95 d6 8d ca 5f 0c                           |.4...._.|
+00000020  6f 2d 7c 2b 51 ed 14 ef  68 ca 42 c5 4c b7 9e 73  |o-|+Q...h.B.L..s|
+00000030  16 d7 10 08 ee 88 f3 cb  b4 9b 8b 3e 0e 11 25 cd  |...........>..%.|
+00000040  d4 79 4e 37 40 c0 79 b5  c3 e7 9e 6c 8e 99 82 5c  |.yN7@.y....l...\|
+00000050  37 24 63 9d 51 31 a6 81  df 1a ac c4 b8 49 38 16  |7$c.Q1.......I8.|
+00000060  7e 51 5c e5 15 b7 7c 06  f0 8a b8 23 a8 9d 31 cb  |~Q\...|....#..1.|
+00000070  8c 75 6b 29 1a 0d 32 7c  0e 83 b9 7c c2 3d d3 21  |.uk)..2|...|.=.!|
+00000080  8d c5 39 13 65 14 03 03  00 01 01 16 03 03 00 20  |..9.e.......... |
+00000090  7f 38 81 32 20 9d 0e 82  26 08 c4 88 f5 37 74 4b  |.8.2 ...&....7tK|
+000000a0  88 4a 5d d1 b6 53 c7 bd  55 52 98 fe 6e 6b 33 43  |.J]..S..UR..nk3C|
+000000b0  17 03 03 00 1d ab 3c 7c  04 f4 0c d0 fa 7e 95 ca  |......<|.....~..|
+000000c0  19 d6 e8 ed 23 e9 9d 51  fd 9f d7 46 8d a9 88 4e  |....#..Q...F...N|
+000000d0  3c 9c 15 03 03 00 12 bc  63 86 67 57 a5 a2 48 f5  |<.......c.gW..H.|
+000000e0  1c 57 b6 b2 13 45 cd de  ce                       |.W...E...|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ALPN-Fallback b/src/crypto/tls/testdata/Server-TLSv12-ALPN-Fallback
index f23432e87c..9244c64020 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ALPN-Fallback
+++ b/src/crypto/tls/testdata/Server-TLSv12-ALPN-Fallback
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 a6 01 00 00  a2 03 03 5d 7d ed 76 f3  |...........]}.v.|
-00000010  d2 de b6 b7 c4 71 b0 75  6b 7f 49 e9 7f bb 5e b3  |.....q.uk.I...^.|
-00000020  df 8b 25 a1 af 9f 8a c5  23 e5 22 00 00 04 cc a8  |..%.....#.".....|
+00000000  16 03 01 00 a6 01 00 00  a2 03 03 40 f1 55 72 dd  |...........@.Ur.|
+00000010  4a 11 8b ff 4f cd ec 75  a9 28 03 29 66 e5 8b 6d  |J...O..u.(.)f..m|
+00000020  a0 15 6c 01 4d d3 ff aa  40 09 45 00 00 04 cc a8  |..l.M...@.E.....|
 00000030  00 ff 01 00 00 75 00 0b  00 04 03 00 01 02 00 0a  |.....u..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000050  00 00 00 10 00 19 00 17  06 70 72 6f 74 6f 33 08  |.........proto3.|
@@ -11,80 +11,80 @@
 00000090  05 08 06 04 01 05 01 06  01 03 03 02 03 03 01 02  |................|
 000000a0  01 03 02 02 02 04 02 05  02 06 02                 |...........|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 3b 02 00 00  37 03 03 00 00 00 00 00  |....;...7.......|
+00000000  16 03 03 00 3f 02 00 00  3b 03 03 00 00 00 00 00  |....?...;.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 cc a8 00 00  |...DOWNGRD......|
-00000030  0f 00 23 00 00 ff 01 00  01 00 00 0b 00 02 01 00  |..#.............|
-00000040  16 03 03 02 59 0b 00 02  55 00 02 52 00 02 4f 30  |....Y...U..R..O0|
-00000050  82 02 4b 30 82 01 b4 a0  03 02 01 02 02 09 00 e8  |..K0............|
-00000060  f0 9d 3f e2 5b ea a6 30  0d 06 09 2a 86 48 86 f7  |..?.[..0...*.H..|
-00000070  0d 01 01 0b 05 00 30 1f  31 0b 30 09 06 03 55 04  |......0.1.0...U.|
-00000080  0a 13 02 47 6f 31 10 30  0e 06 03 55 04 03 13 07  |...Go1.0...U....|
-00000090  47 6f 20 52 6f 6f 74 30  1e 17 0d 31 36 30 31 30  |Go Root0...16010|
-000000a0  31 30 30 30 30 30 30 5a  17 0d 32 35 30 31 30 31  |1000000Z..250101|
-000000b0  30 30 30 30 30 30 5a 30  1a 31 0b 30 09 06 03 55  |000000Z0.1.0...U|
-000000c0  04 0a 13 02 47 6f 31 0b  30 09 06 03 55 04 03 13  |....Go1.0...U...|
-000000d0  02 47 6f 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |.Go0..0...*.H...|
-000000e0  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
-000000f0  db 46 7d 93 2e 12 27 06  48 bc 06 28 21 ab 7e c4  |.F}...'.H..(!.~.|
-00000100  b6 a2 5d fe 1e 52 45 88  7a 36 47 a5 08 0d 92 42  |..]..RE.z6G....B|
-00000110  5b c2 81 c0 be 97 79 98  40 fb 4f 6d 14 fd 2b 13  |[.....y.@.Om..+.|
-00000120  8b c2 a5 2e 67 d8 d4 09  9e d6 22 38 b7 4a 0b 74  |....g....."8.J.t|
-00000130  73 2b c2 34 f1 d1 93 e5  96 d9 74 7b f3 58 9f 6c  |s+.4......t{.X.l|
-00000140  61 3c c0 b0 41 d4 d9 2b  2b 24 23 77 5b 1c 3b bd  |a<..A..++$#w[.;.|
-00000150  75 5d ce 20 54 cf a1 63  87 1d 1e 24 c4 f3 1d 1a  |u]. T..c...$....|
-00000160  50 8b aa b6 14 43 ed 97  a7 75 62 f4 14 c8 52 d7  |P....C...ub...R.|
-00000170  02 03 01 00 01 a3 81 93  30 81 90 30 0e 06 03 55  |........0..0...U|
-00000180  1d 0f 01 01 ff 04 04 03  02 05 a0 30 1d 06 03 55  |...........0...U|
-00000190  1d 25 04 16 30 14 06 08  2b 06 01 05 05 07 03 01  |.%..0...+.......|
-000001a0  06 08 2b 06 01 05 05 07  03 02 30 0c 06 03 55 1d  |..+.......0...U.|
-000001b0  13 01 01 ff 04 02 30 00  30 19 06 03 55 1d 0e 04  |......0.0...U...|
-000001c0  12 04 10 9f 91 16 1f 43  43 3e 49 a6 de 6d b6 80  |.......CC>I..m..|
-000001d0  d7 9f 60 30 1b 06 03 55  1d 23 04 14 30 12 80 10  |..`0...U.#..0...|
-000001e0  48 13 49 4d 13 7e 16 31  bb a3 01 d5 ac ab 6e 7b  |H.IM.~.1......n{|
-000001f0  30 19 06 03 55 1d 11 04  12 30 10 82 0e 65 78 61  |0...U....0...exa|
-00000200  6d 70 6c 65 2e 67 6f 6c  61 6e 67 30 0d 06 09 2a  |mple.golang0...*|
-00000210  86 48 86 f7 0d 01 01 0b  05 00 03 81 81 00 9d 30  |.H.............0|
-00000220  cc 40 2b 5b 50 a0 61 cb  ba e5 53 58 e1 ed 83 28  |.@+[P.a...SX...(|
-00000230  a9 58 1a a9 38 a4 95 a1  ac 31 5a 1a 84 66 3d 43  |.X..8....1Z..f=C|
-00000240  d3 2d d9 0b f2 97 df d3  20 64 38 92 24 3a 00 bc  |.-...... d8.$:..|
-00000250  cf 9c 7d b7 40 20 01 5f  aa d3 16 61 09 a2 76 fd  |..}.@ ._...a..v.|
-00000260  13 c3 cc e1 0c 5c ee b1  87 82 f1 6c 04 ed 73 bb  |.....\.....l..s.|
-00000270  b3 43 77 8d 0c 1c f1 0f  a1 d8 40 83 61 c9 4c 72  |.Cw.......@.a.Lr|
-00000280  2b 9d ae db 46 06 06 4d  f4 c1 b3 3e c0 d1 bd 42  |+...F..M...>...B|
-00000290  d4 db fe 3d 13 60 84 5c  21 d3 3b e9 fa e7 16 03  |...=.`.\!.;.....|
-000002a0  03 00 ac 0c 00 00 a8 03  00 1d 20 2f e5 7d a3 47  |.......... /.}.G|
-000002b0  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
-000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 08 04 00 80 d6  |......_X.;t.....|
-000002d0  d1 b7 44 aa 4b 34 94 1e  40 0b 50 d3 03 c2 b4 65  |..D.K4..@.P....e|
-000002e0  87 e4 cc 58 95 25 34 dc  c4 a6 fa 0a 5e 8a 02 5d  |...X.%4.....^..]|
-000002f0  ab 55 62 d7 32 49 f7 31  33 80 48 9f c5 8d 0f ad  |.Ub.2I.13.H.....|
-00000300  cc 0b 26 c7 ff 57 14 f1  b8 c6 b2 7d 68 b3 01 a8  |..&..W.....}h...|
-00000310  a3 56 d6 6c 65 ca 7b b0  08 97 c2 66 d0 06 b8 e0  |.V.le.{....f....|
-00000320  bb bd 97 fc 3e 80 45 3c  73 8f 59 8b 76 5d 30 e0  |....>.E<s.Y.v]0.|
-00000330  d1 eb 5d 27 7a ed 52 2f  fb 2a 54 51 f9 92 46 ed  |..]'z.R/.*TQ..F.|
-00000340  7f c5 df 2a 59 fe 58 10  69 86 cd 50 3f 27 e5 16  |...*Y.X.i..P?'..|
-00000350  03 03 00 04 0e 00 00 00                           |........|
+00000030  13 00 23 00 00 ff 01 00  01 00 00 17 00 00 00 0b  |..#.............|
+00000040  00 02 01 00 16 03 03 02  59 0b 00 02 55 00 02 52  |........Y...U..R|
+00000050  00 02 4f 30 82 02 4b 30  82 01 b4 a0 03 02 01 02  |..O0..K0........|
+00000060  02 09 00 e8 f0 9d 3f e2  5b ea a6 30 0d 06 09 2a  |......?.[..0...*|
+00000070  86 48 86 f7 0d 01 01 0b  05 00 30 1f 31 0b 30 09  |.H........0.1.0.|
+00000080  06 03 55 04 0a 13 02 47  6f 31 10 30 0e 06 03 55  |..U....Go1.0...U|
+00000090  04 03 13 07 47 6f 20 52  6f 6f 74 30 1e 17 0d 31  |....Go Root0...1|
+000000a0  36 30 31 30 31 30 30 30  30 30 30 5a 17 0d 32 35  |60101000000Z..25|
+000000b0  30 31 30 31 30 30 30 30  30 30 5a 30 1a 31 0b 30  |0101000000Z0.1.0|
+000000c0  09 06 03 55 04 0a 13 02  47 6f 31 0b 30 09 06 03  |...U....Go1.0...|
+000000d0  55 04 03 13 02 47 6f 30  81 9f 30 0d 06 09 2a 86  |U....Go0..0...*.|
+000000e0  48 86 f7 0d 01 01 01 05  00 03 81 8d 00 30 81 89  |H............0..|
+000000f0  02 81 81 00 db 46 7d 93  2e 12 27 06 48 bc 06 28  |.....F}...'.H..(|
+00000100  21 ab 7e c4 b6 a2 5d fe  1e 52 45 88 7a 36 47 a5  |!.~...]..RE.z6G.|
+00000110  08 0d 92 42 5b c2 81 c0  be 97 79 98 40 fb 4f 6d  |...B[.....y.@.Om|
+00000120  14 fd 2b 13 8b c2 a5 2e  67 d8 d4 09 9e d6 22 38  |..+.....g....."8|
+00000130  b7 4a 0b 74 73 2b c2 34  f1 d1 93 e5 96 d9 74 7b  |.J.ts+.4......t{|
+00000140  f3 58 9f 6c 61 3c c0 b0  41 d4 d9 2b 2b 24 23 77  |.X.la<..A..++$#w|
+00000150  5b 1c 3b bd 75 5d ce 20  54 cf a1 63 87 1d 1e 24  |[.;.u]. T..c...$|
+00000160  c4 f3 1d 1a 50 8b aa b6  14 43 ed 97 a7 75 62 f4  |....P....C...ub.|
+00000170  14 c8 52 d7 02 03 01 00  01 a3 81 93 30 81 90 30  |..R.........0..0|
+00000180  0e 06 03 55 1d 0f 01 01  ff 04 04 03 02 05 a0 30  |...U...........0|
+00000190  1d 06 03 55 1d 25 04 16  30 14 06 08 2b 06 01 05  |...U.%..0...+...|
+000001a0  05 07 03 01 06 08 2b 06  01 05 05 07 03 02 30 0c  |......+.......0.|
+000001b0  06 03 55 1d 13 01 01 ff  04 02 30 00 30 19 06 03  |..U.......0.0...|
+000001c0  55 1d 0e 04 12 04 10 9f  91 16 1f 43 43 3e 49 a6  |U..........CC>I.|
+000001d0  de 6d b6 80 d7 9f 60 30  1b 06 03 55 1d 23 04 14  |.m....`0...U.#..|
+000001e0  30 12 80 10 48 13 49 4d  13 7e 16 31 bb a3 01 d5  |0...H.IM.~.1....|
+000001f0  ac ab 6e 7b 30 19 06 03  55 1d 11 04 12 30 10 82  |..n{0...U....0..|
+00000200  0e 65 78 61 6d 70 6c 65  2e 67 6f 6c 61 6e 67 30  |.example.golang0|
+00000210  0d 06 09 2a 86 48 86 f7  0d 01 01 0b 05 00 03 81  |...*.H..........|
+00000220  81 00 9d 30 cc 40 2b 5b  50 a0 61 cb ba e5 53 58  |...0.@+[P.a...SX|
+00000230  e1 ed 83 28 a9 58 1a a9  38 a4 95 a1 ac 31 5a 1a  |...(.X..8....1Z.|
+00000240  84 66 3d 43 d3 2d d9 0b  f2 97 df d3 20 64 38 92  |.f=C.-...... d8.|
+00000250  24 3a 00 bc cf 9c 7d b7  40 20 01 5f aa d3 16 61  |$:....}.@ ._...a|
+00000260  09 a2 76 fd 13 c3 cc e1  0c 5c ee b1 87 82 f1 6c  |..v......\.....l|
+00000270  04 ed 73 bb b3 43 77 8d  0c 1c f1 0f a1 d8 40 83  |..s..Cw.......@.|
+00000280  61 c9 4c 72 2b 9d ae db  46 06 06 4d f4 c1 b3 3e  |a.Lr+...F..M...>|
+00000290  c0 d1 bd 42 d4 db fe 3d  13 60 84 5c 21 d3 3b e9  |...B...=.`.\!.;.|
+000002a0  fa e7 16 03 03 00 ac 0c  00 00 a8 03 00 1d 20 2f  |.............. /|
+000002b0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
+000002c0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 08  |.........._X.;t.|
+000002d0  04 00 80 4b b5 2e d8 fe  df e8 2f 59 a5 b6 f8 67  |...K....../Y...g|
+000002e0  6d ee 2c 23 cf 0e 57 02  2e 60 a2 a7 db 35 ea 1b  |m.,#..W..`...5..|
+000002f0  e2 e9 33 d5 d0 4e 34 82  e1 d2 96 7b a6 df ae 06  |..3..N4....{....|
+00000300  19 d4 4f f5 f1 92 6b 7e  54 44 45 5b 67 7d 45 a9  |..O...k~TDE[g}E.|
+00000310  7d 22 03 79 5c 59 63 47  4c dc 0b b2 c8 fb dc 40  |}".y\YcGL......@|
+00000320  6c 26 01 1e 15 96 e7 af  65 59 8b f3 18 70 02 d0  |l&......eY...p..|
+00000330  22 6c c3 7c 0e 10 3d 7d  e1 40 9e 6b 40 ba 53 14  |"l.|..=}.@.k@.S.|
+00000340  e7 18 99 e2 02 80 82 fe  f3 58 47 fc 18 f7 b6 f9  |.........XG.....|
+00000350  e2 ee 8f 16 03 03 00 04  0e 00 00 00              |............|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 13 c8 d8 37 18 ec  |....%...! ...7..|
-00000010  37 61 44 eb 0b 4d ca 43  89 92 65 74 fc 38 16 03  |7aD..M.C..et.8..|
-00000020  11 77 5f cf 4c a0 d3 06  b4 12 14 03 03 00 01 01  |.w_.L...........|
-00000030  16 03 03 00 20 b8 08 12  b6 17 66 b9 73 a3 30 21  |.... .....f.s.0!|
-00000040  7c 97 2f fe 8b d7 91 ae  24 65 04 76 3d f0 71 f2  ||./.....$e.v=.q.|
-00000050  88 48 bc bc 1b                                    |.H...|
+00000000  16 03 03 00 25 10 00 00  21 20 e0 2a c3 46 00 e5  |....%...! .*.F..|
+00000010  28 34 4d 1c 76 94 ed 60  59 7e 26 bc 21 79 3b 5b  |(4M.v..`Y~&.!y;[|
+00000020  5e 7f 7a a1 4d d0 2f 84  54 43 14 03 03 00 01 01  |^.z.M./.TC......|
+00000030  16 03 03 00 20 27 f7 34  df 13 09 d2 f3 a8 58 81  |.... '.4......X.|
+00000040  8e 76 a3 2c bc de 9e 63  35 23 e8 f2 4f b9 fe 87  |.v.,...c5#..O...|
+00000050  03 a9 ea a0 d2                                    |.....|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 7f 04 00 00  7b 00 00 00 00 00 75 00  |........{.....u.|
+00000000  16 03 03 00 80 04 00 00  7c 00 00 00 00 00 76 00  |........|.....v.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6f 2d 7c 2b 51 ed 14 ef  68 ca 42 c5 4c 61 30 a6  |o-|+Q...h.B.La0.|
-00000030  99 04 8a 0d aa af 2c 0d  d6 05 50 cf a2 ba a5 da  |......,...P.....|
-00000040  81 ed ee 22 c9 39 14 3d  7e 5e 39 e4 58 05 65 27  |...".9.=~^9.X.e'|
-00000050  88 ac 7a e4 75 64 2d 02  d7 6c 6b 9f 7f 49 38 16  |..z.ud-..lk..I8.|
-00000060  7f 51 5c e5 09 42 7b a4  77 e1 9c b2 df 97 e2 c1  |.Q\..B{.w.......|
-00000070  3a de bb 9c 1d 7b bd 51  f7 de 83 2e 02 bf 86 4f  |:....{.Q.......O|
-00000080  cf fa f4 51 14 03 03 00  01 01 16 03 03 00 20 85  |...Q.......... .|
-00000090  b1 8b bf bc c7 44 af b8  dc d7 ca 93 79 0e 03 43  |.....D......y..C|
-000000a0  d7 4c fd 4e 1f 29 c6 cd  85 68 65 3e 7e 3b 1e 17  |.L.N.)...he>~;..|
-000000b0  03 03 00 1d c1 66 d8 51  98 dc c0 d6 95 c0 c6 5c  |.....f.Q.......\|
-000000c0  dc d7 df 66 60 ea 45 4a  58 47 d0 02 58 34 80 61  |...f`.EJXG..X4.a|
-000000d0  e9 15 03 03 00 12 53 74  d3 60 f8 95 e4 cf a3 64  |......St.`.....d|
-000000e0  a3 19 0a 0c e0 c5 7e e5                           |......~.|
+00000020  6f 2d 7c 2b 51 ed 14 ef  68 ca 42 c5 4c 7c 43 02  |o-|+Q...h.B.L|C.|
+00000030  c6 f9 9f 1a c5 53 30 68  99 91 40 78 8a f6 18 b8  |.....S0h..@x....|
+00000040  fb 1c 67 68 95 4a 5b a1  a0 33 c4 7b 36 4f 0d ce  |..gh.J[..3.{6O..|
+00000050  a7 4c 14 89 e6 95 91 c7  3e 72 bb 28 c4 49 38 16  |.L......>r.(.I8.|
+00000060  7e 51 5c e5 15 83 cc 8c  63 6a 1b 6a 9f b3 7b 0d  |~Q\.....cj.j..{.|
+00000070  e3 9e 11 c5 96 5f fa 49  c8 a1 9d 35 9c 04 e5 9c  |....._.I...5....|
+00000080  11 0f 1c 24 f3 14 03 03  00 01 01 16 03 03 00 20  |...$........... |
+00000090  20 03 ef d8 1a 87 3b ef  d1 75 7c c9 9e 21 b6 3b  | .....;..u|..!.;|
+000000a0  21 ba 1d 1b 64 b5 bd d1  9d e2 22 a0 5a ab d8 25  |!...d.....".Z..%|
+000000b0  17 03 03 00 1d 2b d3 28  04 97 7d 77 3a e6 9b 5e  |.....+.(..}w:..^|
+000000c0  e4 d2 6c 5c 7c 94 6f ef  c3 59 c7 51 60 d7 2c 9e  |..l\|.o..Y.Q`.,.|
+000000d0  e6 a7 15 03 03 00 12 31  7e 0c f2 2f 2e 1f e9 60  |.......1~../...`|
+000000e0  49 1a cd 8c 40 13 ce 16  47                       |I...@...G|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ALPN-NotConfigured b/src/crypto/tls/testdata/Server-TLSv12-ALPN-NotConfigured
index 0f36ba036c..6e33c8413b 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ALPN-NotConfigured
+++ b/src/crypto/tls/testdata/Server-TLSv12-ALPN-NotConfigured
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 9d 01 00 00  99 03 03 35 f2 2c 2d b2  |...........5.,-.|
-00000010  fa c9 5e 17 3b 13 3b 12  25 98 a2 2c dd 7b 95 17  |..^.;.;.%..,.{..|
-00000020  7b c1 79 76 58 3e 1c 7a  f3 b9 5b 00 00 04 cc a8  |{.yvX>.z..[.....|
+00000000  16 03 01 00 9d 01 00 00  99 03 03 bb e1 68 3f af  |.............h?.|
+00000010  af fa ac f8 b0 88 0d 9f  2f a0 8b fe fd 50 a7 b4  |......../....P..|
+00000020  63 b7 05 84 8a 57 f0 cf  9d 26 79 00 00 04 cc a8  |c....W...&y.....|
 00000030  00 ff 01 00 00 6c 00 0b  00 04 03 00 01 02 00 0a  |.....l..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000050  00 00 00 10 00 10 00 0e  06 70 72 6f 74 6f 32 06  |.........proto2.|
@@ -11,80 +11,80 @@
 00000090  03 03 02 03 03 01 02 01  03 02 02 02 04 02 05 02  |................|
 000000a0  06 02                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 3b 02 00 00  37 03 03 00 00 00 00 00  |....;...7.......|
+00000000  16 03 03 00 3f 02 00 00  3b 03 03 00 00 00 00 00  |....?...;.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 cc a8 00 00  |...DOWNGRD......|
-00000030  0f 00 23 00 00 ff 01 00  01 00 00 0b 00 02 01 00  |..#.............|
-00000040  16 03 03 02 59 0b 00 02  55 00 02 52 00 02 4f 30  |....Y...U..R..O0|
-00000050  82 02 4b 30 82 01 b4 a0  03 02 01 02 02 09 00 e8  |..K0............|
-00000060  f0 9d 3f e2 5b ea a6 30  0d 06 09 2a 86 48 86 f7  |..?.[..0...*.H..|
-00000070  0d 01 01 0b 05 00 30 1f  31 0b 30 09 06 03 55 04  |......0.1.0...U.|
-00000080  0a 13 02 47 6f 31 10 30  0e 06 03 55 04 03 13 07  |...Go1.0...U....|
-00000090  47 6f 20 52 6f 6f 74 30  1e 17 0d 31 36 30 31 30  |Go Root0...16010|
-000000a0  31 30 30 30 30 30 30 5a  17 0d 32 35 30 31 30 31  |1000000Z..250101|
-000000b0  30 30 30 30 30 30 5a 30  1a 31 0b 30 09 06 03 55  |000000Z0.1.0...U|
-000000c0  04 0a 13 02 47 6f 31 0b  30 09 06 03 55 04 03 13  |....Go1.0...U...|
-000000d0  02 47 6f 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |.Go0..0...*.H...|
-000000e0  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
-000000f0  db 46 7d 93 2e 12 27 06  48 bc 06 28 21 ab 7e c4  |.F}...'.H..(!.~.|
-00000100  b6 a2 5d fe 1e 52 45 88  7a 36 47 a5 08 0d 92 42  |..]..RE.z6G....B|
-00000110  5b c2 81 c0 be 97 79 98  40 fb 4f 6d 14 fd 2b 13  |[.....y.@.Om..+.|
-00000120  8b c2 a5 2e 67 d8 d4 09  9e d6 22 38 b7 4a 0b 74  |....g....."8.J.t|
-00000130  73 2b c2 34 f1 d1 93 e5  96 d9 74 7b f3 58 9f 6c  |s+.4......t{.X.l|
-00000140  61 3c c0 b0 41 d4 d9 2b  2b 24 23 77 5b 1c 3b bd  |a<..A..++$#w[.;.|
-00000150  75 5d ce 20 54 cf a1 63  87 1d 1e 24 c4 f3 1d 1a  |u]. T..c...$....|
-00000160  50 8b aa b6 14 43 ed 97  a7 75 62 f4 14 c8 52 d7  |P....C...ub...R.|
-00000170  02 03 01 00 01 a3 81 93  30 81 90 30 0e 06 03 55  |........0..0...U|
-00000180  1d 0f 01 01 ff 04 04 03  02 05 a0 30 1d 06 03 55  |...........0...U|
-00000190  1d 25 04 16 30 14 06 08  2b 06 01 05 05 07 03 01  |.%..0...+.......|
-000001a0  06 08 2b 06 01 05 05 07  03 02 30 0c 06 03 55 1d  |..+.......0...U.|
-000001b0  13 01 01 ff 04 02 30 00  30 19 06 03 55 1d 0e 04  |......0.0...U...|
-000001c0  12 04 10 9f 91 16 1f 43  43 3e 49 a6 de 6d b6 80  |.......CC>I..m..|
-000001d0  d7 9f 60 30 1b 06 03 55  1d 23 04 14 30 12 80 10  |..`0...U.#..0...|
-000001e0  48 13 49 4d 13 7e 16 31  bb a3 01 d5 ac ab 6e 7b  |H.IM.~.1......n{|
-000001f0  30 19 06 03 55 1d 11 04  12 30 10 82 0e 65 78 61  |0...U....0...exa|
-00000200  6d 70 6c 65 2e 67 6f 6c  61 6e 67 30 0d 06 09 2a  |mple.golang0...*|
-00000210  86 48 86 f7 0d 01 01 0b  05 00 03 81 81 00 9d 30  |.H.............0|
-00000220  cc 40 2b 5b 50 a0 61 cb  ba e5 53 58 e1 ed 83 28  |.@+[P.a...SX...(|
-00000230  a9 58 1a a9 38 a4 95 a1  ac 31 5a 1a 84 66 3d 43  |.X..8....1Z..f=C|
-00000240  d3 2d d9 0b f2 97 df d3  20 64 38 92 24 3a 00 bc  |.-...... d8.$:..|
-00000250  cf 9c 7d b7 40 20 01 5f  aa d3 16 61 09 a2 76 fd  |..}.@ ._...a..v.|
-00000260  13 c3 cc e1 0c 5c ee b1  87 82 f1 6c 04 ed 73 bb  |.....\.....l..s.|
-00000270  b3 43 77 8d 0c 1c f1 0f  a1 d8 40 83 61 c9 4c 72  |.Cw.......@.a.Lr|
-00000280  2b 9d ae db 46 06 06 4d  f4 c1 b3 3e c0 d1 bd 42  |+...F..M...>...B|
-00000290  d4 db fe 3d 13 60 84 5c  21 d3 3b e9 fa e7 16 03  |...=.`.\!.;.....|
-000002a0  03 00 ac 0c 00 00 a8 03  00 1d 20 2f e5 7d a3 47  |.......... /.}.G|
-000002b0  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
-000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 08 04 00 80 c1  |......_X.;t.....|
-000002d0  0e 3d 12 2b ba 02 54 c3  73 58 20 d2 af d4 0c a4  |.=.+..T.sX .....|
-000002e0  df 78 7a aa d8 09 5a e8  84 b2 71 4f 89 85 f8 ae  |.xz...Z...qO....|
-000002f0  d1 f7 8b d0 53 00 47 34  ef 54 5a 76 64 8b ab 39  |....S.G4.TZvd..9|
-00000300  0a 1f 5b cb d6 46 4c 36  3a 12 ea 8b f4 ef 53 79  |..[..FL6:.....Sy|
-00000310  4b e7 2a 9a de 9a 80 f2  fa 77 0d 3e 36 3a 01 d5  |K.*......w.>6:..|
-00000320  c9 3b df 6c eb d3 70 8a  96 1f bf 8f 23 e0 00 e0  |.;.l..p.....#...|
-00000330  4a b3 83 5c 22 9a 11 b6  b3 6f c7 cd 41 f1 ae c2  |J..\"....o..A...|
-00000340  3b 53 bd f2 58 a3 77 c2  ba ca 65 e4 c8 dc 0e 16  |;S..X.w...e.....|
-00000350  03 03 00 04 0e 00 00 00                           |........|
+00000030  13 00 23 00 00 ff 01 00  01 00 00 17 00 00 00 0b  |..#.............|
+00000040  00 02 01 00 16 03 03 02  59 0b 00 02 55 00 02 52  |........Y...U..R|
+00000050  00 02 4f 30 82 02 4b 30  82 01 b4 a0 03 02 01 02  |..O0..K0........|
+00000060  02 09 00 e8 f0 9d 3f e2  5b ea a6 30 0d 06 09 2a  |......?.[..0...*|
+00000070  86 48 86 f7 0d 01 01 0b  05 00 30 1f 31 0b 30 09  |.H........0.1.0.|
+00000080  06 03 55 04 0a 13 02 47  6f 31 10 30 0e 06 03 55  |..U....Go1.0...U|
+00000090  04 03 13 07 47 6f 20 52  6f 6f 74 30 1e 17 0d 31  |....Go Root0...1|
+000000a0  36 30 31 30 31 30 30 30  30 30 30 5a 17 0d 32 35  |60101000000Z..25|
+000000b0  30 31 30 31 30 30 30 30  30 30 5a 30 1a 31 0b 30  |0101000000Z0.1.0|
+000000c0  09 06 03 55 04 0a 13 02  47 6f 31 0b 30 09 06 03  |...U....Go1.0...|
+000000d0  55 04 03 13 02 47 6f 30  81 9f 30 0d 06 09 2a 86  |U....Go0..0...*.|
+000000e0  48 86 f7 0d 01 01 01 05  00 03 81 8d 00 30 81 89  |H............0..|
+000000f0  02 81 81 00 db 46 7d 93  2e 12 27 06 48 bc 06 28  |.....F}...'.H..(|
+00000100  21 ab 7e c4 b6 a2 5d fe  1e 52 45 88 7a 36 47 a5  |!.~...]..RE.z6G.|
+00000110  08 0d 92 42 5b c2 81 c0  be 97 79 98 40 fb 4f 6d  |...B[.....y.@.Om|
+00000120  14 fd 2b 13 8b c2 a5 2e  67 d8 d4 09 9e d6 22 38  |..+.....g....."8|
+00000130  b7 4a 0b 74 73 2b c2 34  f1 d1 93 e5 96 d9 74 7b  |.J.ts+.4......t{|
+00000140  f3 58 9f 6c 61 3c c0 b0  41 d4 d9 2b 2b 24 23 77  |.X.la<..A..++$#w|
+00000150  5b 1c 3b bd 75 5d ce 20  54 cf a1 63 87 1d 1e 24  |[.;.u]. T..c...$|
+00000160  c4 f3 1d 1a 50 8b aa b6  14 43 ed 97 a7 75 62 f4  |....P....C...ub.|
+00000170  14 c8 52 d7 02 03 01 00  01 a3 81 93 30 81 90 30  |..R.........0..0|
+00000180  0e 06 03 55 1d 0f 01 01  ff 04 04 03 02 05 a0 30  |...U...........0|
+00000190  1d 06 03 55 1d 25 04 16  30 14 06 08 2b 06 01 05  |...U.%..0...+...|
+000001a0  05 07 03 01 06 08 2b 06  01 05 05 07 03 02 30 0c  |......+.......0.|
+000001b0  06 03 55 1d 13 01 01 ff  04 02 30 00 30 19 06 03  |..U.......0.0...|
+000001c0  55 1d 0e 04 12 04 10 9f  91 16 1f 43 43 3e 49 a6  |U..........CC>I.|
+000001d0  de 6d b6 80 d7 9f 60 30  1b 06 03 55 1d 23 04 14  |.m....`0...U.#..|
+000001e0  30 12 80 10 48 13 49 4d  13 7e 16 31 bb a3 01 d5  |0...H.IM.~.1....|
+000001f0  ac ab 6e 7b 30 19 06 03  55 1d 11 04 12 30 10 82  |..n{0...U....0..|
+00000200  0e 65 78 61 6d 70 6c 65  2e 67 6f 6c 61 6e 67 30  |.example.golang0|
+00000210  0d 06 09 2a 86 48 86 f7  0d 01 01 0b 05 00 03 81  |...*.H..........|
+00000220  81 00 9d 30 cc 40 2b 5b  50 a0 61 cb ba e5 53 58  |...0.@+[P.a...SX|
+00000230  e1 ed 83 28 a9 58 1a a9  38 a4 95 a1 ac 31 5a 1a  |...(.X..8....1Z.|
+00000240  84 66 3d 43 d3 2d d9 0b  f2 97 df d3 20 64 38 92  |.f=C.-...... d8.|
+00000250  24 3a 00 bc cf 9c 7d b7  40 20 01 5f aa d3 16 61  |$:....}.@ ._...a|
+00000260  09 a2 76 fd 13 c3 cc e1  0c 5c ee b1 87 82 f1 6c  |..v......\.....l|
+00000270  04 ed 73 bb b3 43 77 8d  0c 1c f1 0f a1 d8 40 83  |..s..Cw.......@.|
+00000280  61 c9 4c 72 2b 9d ae db  46 06 06 4d f4 c1 b3 3e  |a.Lr+...F..M...>|
+00000290  c0 d1 bd 42 d4 db fe 3d  13 60 84 5c 21 d3 3b e9  |...B...=.`.\!.;.|
+000002a0  fa e7 16 03 03 00 ac 0c  00 00 a8 03 00 1d 20 2f  |.............. /|
+000002b0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
+000002c0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 08  |.........._X.;t.|
+000002d0  04 00 80 88 15 8c 7d 2f  f5 a0 bf c4 75 b1 10 75  |......}/....u..u|
+000002e0  2c d7 0a 24 c5 49 dd bc  05 6f d7 ea d0 8f 7f af  |,..$.I...o......|
+000002f0  d3 5e f7 ba 3f 75 90 24  e0 9a 7d 4b 90 ba c6 3d  |.^..?u.$..}K...=|
+00000300  34 68 1c 0f 26 50 d9 96  a4 23 18 61 e9 80 a5 b4  |4h..&P...#.a....|
+00000310  a1 3f 48 ad 57 e3 e2 2c  d8 7d 81 b0 5b 6b 05 61  |.?H.W..,.}..[k.a|
+00000320  3f b4 82 9b b5 ca 74 f6  8c ad f9 67 05 c9 2d d2  |?.....t....g..-.|
+00000330  50 cc 5a dc c1 d6 10 30  08 20 a8 42 84 58 76 7d  |P.Z....0. .B.Xv}|
+00000340  2b b8 47 bd 48 ef a6 4b  bc 3d d5 fc e9 c3 6c b5  |+.G.H..K.=....l.|
+00000350  e0 dc 37 16 03 03 00 04  0e 00 00 00              |..7.........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 15 2b c4 cc 7a b3  |....%...! .+..z.|
-00000010  d9 82 a3 9a bd a5 3d 6a  1d 82 b6 b8 0c 63 2c 1c  |......=j.....c,.|
-00000020  50 47 28 c9 75 aa 9e 62  26 7e 14 03 03 00 01 01  |PG(.u..b&~......|
-00000030  16 03 03 00 20 f5 a1 df  ec ed 87 95 af eb 0b 4a  |.... ..........J|
-00000040  eb 5c 5e b9 36 ec 9e 24  e9 a5 34 bb 1c ac f5 4f  |.\^.6..$..4....O|
-00000050  3a 2d 8b 21 26                                    |:-.!&|
+00000000  16 03 03 00 25 10 00 00  21 20 7d 65 94 48 54 1f  |....%...! }e.HT.|
+00000010  8c 45 6a 7f ce f3 07 72  72 db 07 6e 23 0d 03 d0  |.Ej....rr..n#...|
+00000020  73 e5 2c af 04 5e ca 1d  61 6e 14 03 03 00 01 01  |s.,..^..an......|
+00000030  16 03 03 00 20 18 18 32  97 0c 0c 6a fd 2f f6 68  |.... ..2...j./.h|
+00000040  20 6c 32 b1 8c ff a0 cb  32 3b c3 65 85 15 92 93  | l2.....2;.e....|
+00000050  a5 94 64 93 23                                    |..d.#|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 7f 04 00 00  7b 00 00 00 00 00 75 00  |........{.....u.|
+00000000  16 03 03 00 80 04 00 00  7c 00 00 00 00 00 76 00  |........|.....v.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6f 2d 7c 2b 51 ed 14 ef  68 ca 42 c5 4c 72 9e 40  |o-|+Q...h.B.Lr.@|
-00000030  d3 e0 46 f1 a8 b9 11 11  3c bd 49 e9 ef a6 31 25  |..F.....<.I...1%|
-00000040  a0 09 e7 8d aa d3 30 82  e1 de 0d 98 a5 5f 34 70  |......0......_4p|
-00000050  f6 05 04 90 7a 45 c4 68  51 17 da cd b3 49 38 16  |....zE.hQ....I8.|
-00000060  7f 51 5c e5 9c 44 6c 3e  83 b4 22 a9 b2 d4 83 1f  |.Q\..Dl>..".....|
-00000070  81 92 12 23 6e 57 78 0d  26 92 9e 95 27 8f 44 73  |...#nWx.&...'.Ds|
-00000080  6b 1a ec 88 14 03 03 00  01 01 16 03 03 00 20 8a  |k............. .|
-00000090  c9 7a bb 7a 8b 97 39 a4  fb 25 2e 28 a9 80 a4 81  |.z.z..9..%.(....|
-000000a0  a5 c6 5a 54 59 16 8b 7c  fa 16 72 01 fa bb ec 17  |..ZTY..|..r.....|
-000000b0  03 03 00 1d 94 86 ae 94  a7 31 fe d8 a5 7b 4f d1  |.........1...{O.|
-000000c0  9e 20 7a a3 b2 43 ca 6b  50 c9 a0 cf f7 4f 9c c9  |. z..C.kP....O..|
-000000d0  99 15 03 03 00 12 19 d8  ab 36 79 8f 0e 43 28 89  |.........6y..C(.|
-000000e0  9a 79 c6 74 52 5f 14 38                           |.y.tR_.8|
+00000020  6f 2d 7c 2b 51 ed 14 ef  68 ca 42 c5 4c 0e 59 08  |o-|+Q...h.B.L.Y.|
+00000030  69 66 16 50 2d 6e 49 11  fa 71 df 62 61 83 bc 7b  |if.P-nI..q.ba..{|
+00000040  03 f7 96 d1 a4 3d 92 cf  b5 34 22 4b 5d 1f 6c ba  |.....=...4"K].l.|
+00000050  8d 0f db 43 a9 03 31 ac  73 d7 82 6c d9 49 38 16  |...C..1.s..l.I8.|
+00000060  7e 51 5c e5 15 d0 0d 1b  56 38 37 be 4e a1 71 5f  |~Q\.....V87.N.q_|
+00000070  3f 0c 29 04 21 3c 1d 66  d8 cd 39 ef ac 52 f6 18  |?.).!<.f..9..R..|
+00000080  5b fe 00 f0 52 14 03 03  00 01 01 16 03 03 00 20  |[...R.......... |
+00000090  ec bb ff 46 35 98 ea ac  58 8b d3 56 b5 dc 64 c0  |...F5...X..V..d.|
+000000a0  e1 7f 7f f7 7b 4f c3 98  49 50 98 b6 7c b7 99 6f  |....{O..IP..|..o|
+000000b0  17 03 03 00 1d b0 12 26  23 64 99 2f c3 e3 91 e1  |.......&#d./....|
+000000c0  1f 76 af 23 d9 4e d3 d7  8c 0c 5d 3a 17 72 d3 90  |.v.#.N....]:.r..|
+000000d0  2a 63 15 03 03 00 12 f3  cd 6b 69 a3 a7 36 ee 66  |*c.......ki..6.f|
+000000e0  af 8a f0 fe ce 4d 87 f1  98                       |.....M...|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndECDSAGiven b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndECDSAGiven
index 3d1ceaf903..41ed6c4e1b 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndECDSAGiven
+++ b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndECDSAGiven
@@ -1,58 +1,58 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 6d 01 00 00  69 03 03 b0 00 44 aa 86  |....m...i....D..|
-00000010  30 87 8e 3f f1 89 9a 4a  f6 4c 3b 11 f3 4f e9 9f  |0..?...J.L;..O..|
-00000020  00 22 47 82 26 57 c7 d0  f9 59 6f 00 00 04 00 2f  |."G.&W...Yo..../|
+00000000  16 03 01 00 6d 01 00 00  69 03 03 5e 92 9d 30 27  |....m...i..^..0'|
+00000010  23 da fa a0 07 30 03 c8  bd 60 f2 db e9 5e b3 fc  |#....0...`...^..|
+00000020  65 d3 c5 e1 49 35 63 86  53 ec 87 00 00 04 00 2f  |e...I5c.S....../|
 00000030  00 ff 01 00 00 3c 00 16  00 00 00 17 00 00 00 0d  |.....<..........|
 00000040  00 30 00 2e 04 03 05 03  06 03 08 07 08 08 08 09  |.0..............|
 00000050  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
 00000060  03 03 02 03 03 01 02 01  03 02 02 02 04 02 05 02  |................|
 00000070  06 02                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 31 02 00 00  2d 03 03 00 00 00 00 00  |....1...-.......|
+00000000  16 03 03 00 35 02 00 00  31 03 03 00 00 00 00 00  |....5...1.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 00 2f 00 00  |...DOWNGRD.../..|
-00000030  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
-00000040  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
-00000050  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
-00000060  09 2a 86 48 86 f7 0d 01  01 0b 05 00 30 1f 31 0b  |.*.H........0.1.|
-00000070  30 09 06 03 55 04 0a 13  02 47 6f 31 10 30 0e 06  |0...U....Go1.0..|
-00000080  03 55 04 03 13 07 47 6f  20 52 6f 6f 74 30 1e 17  |.U....Go Root0..|
-00000090  0d 31 36 30 31 30 31 30  30 30 30 30 30 5a 17 0d  |.160101000000Z..|
-000000a0  32 35 30 31 30 31 30 30  30 30 30 30 5a 30 1a 31  |250101000000Z0.1|
-000000b0  0b 30 09 06 03 55 04 0a  13 02 47 6f 31 0b 30 09  |.0...U....Go1.0.|
-000000c0  06 03 55 04 03 13 02 47  6f 30 81 9f 30 0d 06 09  |..U....Go0..0...|
-000000d0  2a 86 48 86 f7 0d 01 01  01 05 00 03 81 8d 00 30  |*.H............0|
-000000e0  81 89 02 81 81 00 db 46  7d 93 2e 12 27 06 48 bc  |.......F}...'.H.|
-000000f0  06 28 21 ab 7e c4 b6 a2  5d fe 1e 52 45 88 7a 36  |.(!.~...]..RE.z6|
-00000100  47 a5 08 0d 92 42 5b c2  81 c0 be 97 79 98 40 fb  |G....B[.....y.@.|
-00000110  4f 6d 14 fd 2b 13 8b c2  a5 2e 67 d8 d4 09 9e d6  |Om..+.....g.....|
-00000120  22 38 b7 4a 0b 74 73 2b  c2 34 f1 d1 93 e5 96 d9  |"8.J.ts+.4......|
-00000130  74 7b f3 58 9f 6c 61 3c  c0 b0 41 d4 d9 2b 2b 24  |t{.X.la<..A..++$|
-00000140  23 77 5b 1c 3b bd 75 5d  ce 20 54 cf a1 63 87 1d  |#w[.;.u]. T..c..|
-00000150  1e 24 c4 f3 1d 1a 50 8b  aa b6 14 43 ed 97 a7 75  |.$....P....C...u|
-00000160  62 f4 14 c8 52 d7 02 03  01 00 01 a3 81 93 30 81  |b...R.........0.|
-00000170  90 30 0e 06 03 55 1d 0f  01 01 ff 04 04 03 02 05  |.0...U..........|
-00000180  a0 30 1d 06 03 55 1d 25  04 16 30 14 06 08 2b 06  |.0...U.%..0...+.|
-00000190  01 05 05 07 03 01 06 08  2b 06 01 05 05 07 03 02  |........+.......|
-000001a0  30 0c 06 03 55 1d 13 01  01 ff 04 02 30 00 30 19  |0...U.......0.0.|
-000001b0  06 03 55 1d 0e 04 12 04  10 9f 91 16 1f 43 43 3e  |..U..........CC>|
-000001c0  49 a6 de 6d b6 80 d7 9f  60 30 1b 06 03 55 1d 23  |I..m....`0...U.#|
-000001d0  04 14 30 12 80 10 48 13  49 4d 13 7e 16 31 bb a3  |..0...H.IM.~.1..|
-000001e0  01 d5 ac ab 6e 7b 30 19  06 03 55 1d 11 04 12 30  |....n{0...U....0|
-000001f0  10 82 0e 65 78 61 6d 70  6c 65 2e 67 6f 6c 61 6e  |...example.golan|
-00000200  67 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |g0...*.H........|
-00000210  03 81 81 00 9d 30 cc 40  2b 5b 50 a0 61 cb ba e5  |.....0.@+[P.a...|
-00000220  53 58 e1 ed 83 28 a9 58  1a a9 38 a4 95 a1 ac 31  |SX...(.X..8....1|
-00000230  5a 1a 84 66 3d 43 d3 2d  d9 0b f2 97 df d3 20 64  |Z..f=C.-...... d|
-00000240  38 92 24 3a 00 bc cf 9c  7d b7 40 20 01 5f aa d3  |8.$:....}.@ ._..|
-00000250  16 61 09 a2 76 fd 13 c3  cc e1 0c 5c ee b1 87 82  |.a..v......\....|
-00000260  f1 6c 04 ed 73 bb b3 43  77 8d 0c 1c f1 0f a1 d8  |.l..s..Cw.......|
-00000270  40 83 61 c9 4c 72 2b 9d  ae db 46 06 06 4d f4 c1  |@.a.Lr+...F..M..|
-00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
-00000290  3b e9 fa e7 16 03 03 00  23 0d 00 00 1f 02 01 40  |;.......#......@|
-000002a0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000002b0  06 01 05 03 06 03 02 01  02 03 00 00 16 03 03 00  |................|
-000002c0  04 0e 00 00 00                                    |.....|
+00000030  09 ff 01 00 01 00 00 17  00 00 16 03 03 02 59 0b  |..............Y.|
+00000040  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
+00000050  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
+00000060  a6 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |.0...*.H........|
+00000070  30 1f 31 0b 30 09 06 03  55 04 0a 13 02 47 6f 31  |0.1.0...U....Go1|
+00000080  10 30 0e 06 03 55 04 03  13 07 47 6f 20 52 6f 6f  |.0...U....Go Roo|
+00000090  74 30 1e 17 0d 31 36 30  31 30 31 30 30 30 30 30  |t0...16010100000|
+000000a0  30 5a 17 0d 32 35 30 31  30 31 30 30 30 30 30 30  |0Z..250101000000|
+000000b0  5a 30 1a 31 0b 30 09 06  03 55 04 0a 13 02 47 6f  |Z0.1.0...U....Go|
+000000c0  31 0b 30 09 06 03 55 04  03 13 02 47 6f 30 81 9f  |1.0...U....Go0..|
+000000d0  30 0d 06 09 2a 86 48 86  f7 0d 01 01 01 05 00 03  |0...*.H.........|
+000000e0  81 8d 00 30 81 89 02 81  81 00 db 46 7d 93 2e 12  |...0.......F}...|
+000000f0  27 06 48 bc 06 28 21 ab  7e c4 b6 a2 5d fe 1e 52  |'.H..(!.~...]..R|
+00000100  45 88 7a 36 47 a5 08 0d  92 42 5b c2 81 c0 be 97  |E.z6G....B[.....|
+00000110  79 98 40 fb 4f 6d 14 fd  2b 13 8b c2 a5 2e 67 d8  |y.@.Om..+.....g.|
+00000120  d4 09 9e d6 22 38 b7 4a  0b 74 73 2b c2 34 f1 d1  |...."8.J.ts+.4..|
+00000130  93 e5 96 d9 74 7b f3 58  9f 6c 61 3c c0 b0 41 d4  |....t{.X.la<..A.|
+00000140  d9 2b 2b 24 23 77 5b 1c  3b bd 75 5d ce 20 54 cf  |.++$#w[.;.u]. T.|
+00000150  a1 63 87 1d 1e 24 c4 f3  1d 1a 50 8b aa b6 14 43  |.c...$....P....C|
+00000160  ed 97 a7 75 62 f4 14 c8  52 d7 02 03 01 00 01 a3  |...ub...R.......|
+00000170  81 93 30 81 90 30 0e 06  03 55 1d 0f 01 01 ff 04  |..0..0...U......|
+00000180  04 03 02 05 a0 30 1d 06  03 55 1d 25 04 16 30 14  |.....0...U.%..0.|
+00000190  06 08 2b 06 01 05 05 07  03 01 06 08 2b 06 01 05  |..+.........+...|
+000001a0  05 07 03 02 30 0c 06 03  55 1d 13 01 01 ff 04 02  |....0...U.......|
+000001b0  30 00 30 19 06 03 55 1d  0e 04 12 04 10 9f 91 16  |0.0...U.........|
+000001c0  1f 43 43 3e 49 a6 de 6d  b6 80 d7 9f 60 30 1b 06  |.CC>I..m....`0..|
+000001d0  03 55 1d 23 04 14 30 12  80 10 48 13 49 4d 13 7e  |.U.#..0...H.IM.~|
+000001e0  16 31 bb a3 01 d5 ac ab  6e 7b 30 19 06 03 55 1d  |.1......n{0...U.|
+000001f0  11 04 12 30 10 82 0e 65  78 61 6d 70 6c 65 2e 67  |...0...example.g|
+00000200  6f 6c 61 6e 67 30 0d 06  09 2a 86 48 86 f7 0d 01  |olang0...*.H....|
+00000210  01 0b 05 00 03 81 81 00  9d 30 cc 40 2b 5b 50 a0  |.........0.@+[P.|
+00000220  61 cb ba e5 53 58 e1 ed  83 28 a9 58 1a a9 38 a4  |a...SX...(.X..8.|
+00000230  95 a1 ac 31 5a 1a 84 66  3d 43 d3 2d d9 0b f2 97  |...1Z..f=C.-....|
+00000240  df d3 20 64 38 92 24 3a  00 bc cf 9c 7d b7 40 20  |.. d8.$:....}.@ |
+00000250  01 5f aa d3 16 61 09 a2  76 fd 13 c3 cc e1 0c 5c  |._...a..v......\|
+00000260  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
+00000270  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
+00000280  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
+00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 23 0d 00 00  |.\!.;.......#...|
+000002a0  1f 02 01 40 00 18 08 04  04 03 08 07 08 05 08 06  |...@............|
+000002b0  04 01 05 01 06 01 05 03  06 03 02 01 02 03 00 00  |................|
+000002c0  16 03 03 00 04 0e 00 00  00                       |.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 02 0a 0b 00 02  06 00 02 03 00 02 00 30  |...............0|
 00000010  82 01 fc 30 82 01 5e 02  09 00 9a 30 84 6c 26 35  |...0..^....0.l&5|
@@ -87,40 +87,40 @@
 000001e0  be e8 91 b3 da 1a f5 5d  a3 23 f5 26 8b 45 70 8d  |.......].#.&.Ep.|
 000001f0  65 62 9b 7e 01 99 3d 18  f6 10 9a 38 61 9b 2e 57  |eb.~..=....8a..W|
 00000200  e4 fa cc b1 8a ce e2 23  a0 87 f0 e1 67 51 eb 16  |.......#....gQ..|
-00000210  03 03 00 86 10 00 00 82  00 80 10 ab 2f 0f b9 29  |............/..)|
-00000220  9f 26 36 09 00 96 9a 3d  2a 01 50 03 f3 d6 ac fc  |.&6....=*.P.....|
-00000230  40 76 96 d0 e6 a6 67 89  24 b0 56 80 58 5e 6d 03  |@v....g.$.V.X^m.|
-00000240  e3 0f dc 61 d1 de 25 95  8a 54 9f 5b 3e f2 31 dd  |...a..%..T.[>.1.|
-00000250  14 2a e2 de 7b 70 66 b5  ed 95 d9 cc 6f c0 b3 a1  |.*..{pf.....o...|
-00000260  bb 41 b2 0f 7d e8 ce b5  11 eb 99 e2 ce c0 33 bc  |.A..}.........3.|
-00000270  6a 67 10 84 d2 dd ac 15  8f 8e aa 2b 1a 7b ca d3  |jg.........+.{..|
-00000280  bb 4b 92 c4 b9 2b 08 c1  0d b2 cf 96 63 64 9d 12  |.K...+......cd..|
-00000290  a6 93 cd 21 3b bc 8e 94  72 76 16 03 03 00 93 0f  |...!;...rv......|
-000002a0  00 00 8f 04 03 00 8b 30  81 88 02 42 00 d5 05 54  |.......0...B...T|
-000002b0  b2 68 a5 04 d6 3c 7b 7d  c1 be e3 d1 b4 25 42 d6  |.h...<{}.....%B.|
-000002c0  2a 3a 2e ea 73 0d 57 ba  0f 96 78 66 c2 c5 d7 57  |*:..s.W...xf...W|
-000002d0  79 9c 22 8b 76 e9 45 ff  ef 92 e9 43 3e b8 8b b4  |y.".v.E....C>...|
-000002e0  cf 3f 67 aa 70 d1 e8 a2  1c a8 3d 24 a2 78 02 42  |.?g.p.....=$.x.B|
-000002f0  01 b2 17 64 66 2f 2e 0d  2d b9 1d 67 45 de 48 9e  |...df/..-..gE.H.|
-00000300  32 f2 1f 79 38 39 b8 bb  8b 7f 82 e9 46 fd 9b 1b  |2..y89......F...|
-00000310  b3 dd a4 9c 15 b2 a2 88  4c f7 42 a2 62 92 c0 d0  |........L.B.b...|
-00000320  a1 78 aa 8b 2d 78 4f 02  5a f7 eb ca c7 34 fc b6  |.x..-xO.Z....4..|
-00000330  6c 6e 14 03 03 00 01 01  16 03 03 00 40 bd 47 9b  |ln..........@.G.|
-00000340  ce 31 2c 09 d3 a8 2c bb  28 0c e8 bd 01 a9 54 34  |.1,...,.(.....T4|
-00000350  a5 74 af e0 d2 38 f3 1b  fa d0 2b a6 39 24 ae de  |.t...8....+.9$..|
-00000360  0a cf 4b c0 a2 3b bf 80  23 71 0a 60 ca 94 b7 23  |..K..;..#q.`...#|
-00000370  80 e3 89 89 42 74 0b a1  c6 f6 d2 c0 79           |....Bt......y|
+00000210  03 03 00 86 10 00 00 82  00 80 02 50 e4 cc a3 ad  |...........P....|
+00000220  fb 33 24 a1 b3 0a 7c 0f  00 e6 1a 06 2b 9f 1e 1f  |.3$...|.....+...|
+00000230  cc b8 b2 80 90 e7 86 20  32 40 06 ac 1b b0 41 b7  |....... 2@....A.|
+00000240  0d 9c 4c 41 90 01 0b 7a  7e b2 b2 46 39 dc 51 25  |..LA...z~..F9.Q%|
+00000250  98 e0 b9 ec 36 fc 08 64  f0 51 2a 41 e1 e5 61 3d  |....6..d.Q*A..a=|
+00000260  fc 07 c1 9b 1f 6f 48 d4  1f 46 bf 14 e6 92 61 1a  |.....oH..F....a.|
+00000270  bd 5f 25 1f 5e b1 3c ac  c7 58 63 02 0d 3a e0 d6  |._%.^.<..Xc..:..|
+00000280  e9 39 fc ec 59 66 2e 91  b2 65 37 eb a8 b5 60 d9  |.9..Yf...e7...`.|
+00000290  49 05 9f 6f cc 71 79 bb  f7 68 16 03 03 00 93 0f  |I..o.qy..h......|
+000002a0  00 00 8f 04 03 00 8b 30  81 88 02 42 00 bd 6a 29  |.......0...B..j)|
+000002b0  21 06 1a e2 67 a1 7f 10  ab ca 3f 74 5a bc 2f 5d  |!...g.....?tZ./]|
+000002c0  53 d0 59 90 f2 d0 b4 2d  75 47 67 0b 67 55 b6 4f  |S.Y....-uGg.gU.O|
+000002d0  75 7d 32 d8 a7 25 c8 4c  90 0b 56 65 be 60 5d ee  |u}2..%.L..Ve.`].|
+000002e0  f7 b3 80 79 26 e5 25 1d  17 cc d8 36 fc 39 02 42  |...y&.%....6.9.B|
+000002f0  01 c3 32 d6 f2 59 9e 10  c8 bf 7f 74 27 a1 00 df  |..2..Y.....t'...|
+00000300  55 05 f0 b3 81 a1 6e 10  a6 fb 0b e4 1c 3f 62 02  |U.....n......?b.|
+00000310  c9 cc c2 4b 97 ad 0c 88  98 07 6c 98 6d db 9d 9f  |...K......l.m...|
+00000320  68 a0 56 ab 5f f9 a2 21  33 86 64 53 de 37 ff 68  |h.V._..!3.dS.7.h|
+00000330  04 9d 14 03 03 00 01 01  16 03 03 00 40 85 14 34  |............@..4|
+00000340  d6 74 a9 d0 0b e9 1f 34  a9 e9 6c cf 5a ac 88 22  |.t.....4..l.Z.."|
+00000350  51 4d ae 16 05 dd 9e c1  36 5e e3 cf b1 5a b5 48  |QM......6^...Z.H|
+00000360  6c 24 b1 d6 fb 7f 03 6a  98 41 90 de 6d c7 b2 49  |l$.....j.A..m..I|
+00000370  d9 a3 c7 45 ff 18 7c f7  a4 cf 05 59 87           |...E..|....Y.|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 54 52 4a 33 9e  |...........TRJ3.|
-00000020  bb 59 7e 21 03 a6 23 bd  68 18 43 b5 c5 c5 37 a2  |.Y~!..#.h.C...7.|
-00000030  6f ac 8c 78 c5 cf 8f e6  01 df 17 53 45 6f 1a e0  |o..x.......SEo..|
-00000040  9c 4a 3d 2c cb 0d 55 7d  32 81 ec 17 03 03 00 40  |.J=,..U}2......@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 63 1a 77 66 2a  |...........c.wf*|
+00000020  49 3a b2 17 83 74 e1 d9  70 96 de 01 84 09 f4 88  |I:...t..p.......|
+00000030  c3 e7 3b 65 11 6f 13 32  b8 b4 f4 41 ca 6a d6 d7  |..;e.o.2...A.j..|
+00000040  51 a3 a1 f0 2d 5b b4 55  29 f9 d3 17 03 03 00 40  |Q...-[.U)......@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  ba 75 93 00 86 1c bc 66  9e 27 2f 2b 5a 68 0e 44  |.u.....f.'/+Zh.D|
-00000070  81 15 0d 67 e6 ee 7a 43  08 78 93 71 91 00 56 0e  |...g..zC.x.q..V.|
-00000080  c6 e1 73 4b af 2f e6 e0  92 4d e5 35 ea 53 7c 45  |..sK./...M.5.S|E|
+00000060  d7 30 0f 03 89 22 4c 19  5f 06 a7 4b 95 59 91 52  |.0..."L._..K.Y.R|
+00000070  2a 65 ab 99 cb 71 99 8b  13 82 44 92 6b ff 59 07  |*e...q....D.k.Y.|
+00000080  28 ca 01 68 ab ad ba ee  6c 6a 19 0b e5 6d 82 24  |(..h....lj...m.$|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 8d 7e 99  bb 93 bd 5d ba 31 b0 0d  |......~....].1..|
-000000b0  1f 76 95 50 7c 1e 24 62  9d 05 65 3f ee b7 c2 24  |.v.P|.$b..e?...$|
-000000c0  13 60 43 69 3a                                    |.`Ci:|
+000000a0  00 00 00 00 00 fc 07 f4  d4 bb 24 a3 f1 cf dc 3c  |..........$....<|
+000000b0  ac 14 63 50 32 34 fd 73  c0 eb f2 78 7b 3b ea 58  |..cP24.s...x{;.X|
+000000c0  cc 3e ff 7f e5                                    |.>...|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndEd25519Given b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndEd25519Given
index 1c3b08f06f..f8cc96058d 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndEd25519Given
+++ b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndEd25519Given
@@ -1,58 +1,58 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 6d 01 00 00  69 03 03 aa ad c9 dc 56  |....m...i......V|
-00000010  79 2e da 42 a6 b2 9e 0a  85 a6 1b e0 5e cd 4e f5  |y..B........^.N.|
-00000020  93 93 0c d5 62 a8 53 17  10 f7 e6 00 00 04 00 2f  |....b.S......../|
+00000000  16 03 01 00 6d 01 00 00  69 03 03 8a fe ad ad 75  |....m...i......u|
+00000010  e4 8c bf bf b7 b6 66 14  92 eb 84 85 9c c8 a7 66  |......f........f|
+00000020  04 2a d0 63 5e a6 bf 85  e9 4f 49 00 00 04 00 2f  |.*.c^....OI..../|
 00000030  00 ff 01 00 00 3c 00 16  00 00 00 17 00 00 00 0d  |.....<..........|
 00000040  00 30 00 2e 04 03 05 03  06 03 08 07 08 08 08 09  |.0..............|
 00000050  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
 00000060  03 03 02 03 03 01 02 01  03 02 02 02 04 02 05 02  |................|
 00000070  06 02                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 31 02 00 00  2d 03 03 00 00 00 00 00  |....1...-.......|
+00000000  16 03 03 00 35 02 00 00  31 03 03 00 00 00 00 00  |....5...1.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 00 2f 00 00  |...DOWNGRD.../..|
-00000030  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
-00000040  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
-00000050  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
-00000060  09 2a 86 48 86 f7 0d 01  01 0b 05 00 30 1f 31 0b  |.*.H........0.1.|
-00000070  30 09 06 03 55 04 0a 13  02 47 6f 31 10 30 0e 06  |0...U....Go1.0..|
-00000080  03 55 04 03 13 07 47 6f  20 52 6f 6f 74 30 1e 17  |.U....Go Root0..|
-00000090  0d 31 36 30 31 30 31 30  30 30 30 30 30 5a 17 0d  |.160101000000Z..|
-000000a0  32 35 30 31 30 31 30 30  30 30 30 30 5a 30 1a 31  |250101000000Z0.1|
-000000b0  0b 30 09 06 03 55 04 0a  13 02 47 6f 31 0b 30 09  |.0...U....Go1.0.|
-000000c0  06 03 55 04 03 13 02 47  6f 30 81 9f 30 0d 06 09  |..U....Go0..0...|
-000000d0  2a 86 48 86 f7 0d 01 01  01 05 00 03 81 8d 00 30  |*.H............0|
-000000e0  81 89 02 81 81 00 db 46  7d 93 2e 12 27 06 48 bc  |.......F}...'.H.|
-000000f0  06 28 21 ab 7e c4 b6 a2  5d fe 1e 52 45 88 7a 36  |.(!.~...]..RE.z6|
-00000100  47 a5 08 0d 92 42 5b c2  81 c0 be 97 79 98 40 fb  |G....B[.....y.@.|
-00000110  4f 6d 14 fd 2b 13 8b c2  a5 2e 67 d8 d4 09 9e d6  |Om..+.....g.....|
-00000120  22 38 b7 4a 0b 74 73 2b  c2 34 f1 d1 93 e5 96 d9  |"8.J.ts+.4......|
-00000130  74 7b f3 58 9f 6c 61 3c  c0 b0 41 d4 d9 2b 2b 24  |t{.X.la<..A..++$|
-00000140  23 77 5b 1c 3b bd 75 5d  ce 20 54 cf a1 63 87 1d  |#w[.;.u]. T..c..|
-00000150  1e 24 c4 f3 1d 1a 50 8b  aa b6 14 43 ed 97 a7 75  |.$....P....C...u|
-00000160  62 f4 14 c8 52 d7 02 03  01 00 01 a3 81 93 30 81  |b...R.........0.|
-00000170  90 30 0e 06 03 55 1d 0f  01 01 ff 04 04 03 02 05  |.0...U..........|
-00000180  a0 30 1d 06 03 55 1d 25  04 16 30 14 06 08 2b 06  |.0...U.%..0...+.|
-00000190  01 05 05 07 03 01 06 08  2b 06 01 05 05 07 03 02  |........+.......|
-000001a0  30 0c 06 03 55 1d 13 01  01 ff 04 02 30 00 30 19  |0...U.......0.0.|
-000001b0  06 03 55 1d 0e 04 12 04  10 9f 91 16 1f 43 43 3e  |..U..........CC>|
-000001c0  49 a6 de 6d b6 80 d7 9f  60 30 1b 06 03 55 1d 23  |I..m....`0...U.#|
-000001d0  04 14 30 12 80 10 48 13  49 4d 13 7e 16 31 bb a3  |..0...H.IM.~.1..|
-000001e0  01 d5 ac ab 6e 7b 30 19  06 03 55 1d 11 04 12 30  |....n{0...U....0|
-000001f0  10 82 0e 65 78 61 6d 70  6c 65 2e 67 6f 6c 61 6e  |...example.golan|
-00000200  67 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |g0...*.H........|
-00000210  03 81 81 00 9d 30 cc 40  2b 5b 50 a0 61 cb ba e5  |.....0.@+[P.a...|
-00000220  53 58 e1 ed 83 28 a9 58  1a a9 38 a4 95 a1 ac 31  |SX...(.X..8....1|
-00000230  5a 1a 84 66 3d 43 d3 2d  d9 0b f2 97 df d3 20 64  |Z..f=C.-...... d|
-00000240  38 92 24 3a 00 bc cf 9c  7d b7 40 20 01 5f aa d3  |8.$:....}.@ ._..|
-00000250  16 61 09 a2 76 fd 13 c3  cc e1 0c 5c ee b1 87 82  |.a..v......\....|
-00000260  f1 6c 04 ed 73 bb b3 43  77 8d 0c 1c f1 0f a1 d8  |.l..s..Cw.......|
-00000270  40 83 61 c9 4c 72 2b 9d  ae db 46 06 06 4d f4 c1  |@.a.Lr+...F..M..|
-00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
-00000290  3b e9 fa e7 16 03 03 00  23 0d 00 00 1f 02 01 40  |;.......#......@|
-000002a0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000002b0  06 01 05 03 06 03 02 01  02 03 00 00 16 03 03 00  |................|
-000002c0  04 0e 00 00 00                                    |.....|
+00000030  09 ff 01 00 01 00 00 17  00 00 16 03 03 02 59 0b  |..............Y.|
+00000040  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
+00000050  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
+00000060  a6 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |.0...*.H........|
+00000070  30 1f 31 0b 30 09 06 03  55 04 0a 13 02 47 6f 31  |0.1.0...U....Go1|
+00000080  10 30 0e 06 03 55 04 03  13 07 47 6f 20 52 6f 6f  |.0...U....Go Roo|
+00000090  74 30 1e 17 0d 31 36 30  31 30 31 30 30 30 30 30  |t0...16010100000|
+000000a0  30 5a 17 0d 32 35 30 31  30 31 30 30 30 30 30 30  |0Z..250101000000|
+000000b0  5a 30 1a 31 0b 30 09 06  03 55 04 0a 13 02 47 6f  |Z0.1.0...U....Go|
+000000c0  31 0b 30 09 06 03 55 04  03 13 02 47 6f 30 81 9f  |1.0...U....Go0..|
+000000d0  30 0d 06 09 2a 86 48 86  f7 0d 01 01 01 05 00 03  |0...*.H.........|
+000000e0  81 8d 00 30 81 89 02 81  81 00 db 46 7d 93 2e 12  |...0.......F}...|
+000000f0  27 06 48 bc 06 28 21 ab  7e c4 b6 a2 5d fe 1e 52  |'.H..(!.~...]..R|
+00000100  45 88 7a 36 47 a5 08 0d  92 42 5b c2 81 c0 be 97  |E.z6G....B[.....|
+00000110  79 98 40 fb 4f 6d 14 fd  2b 13 8b c2 a5 2e 67 d8  |y.@.Om..+.....g.|
+00000120  d4 09 9e d6 22 38 b7 4a  0b 74 73 2b c2 34 f1 d1  |...."8.J.ts+.4..|
+00000130  93 e5 96 d9 74 7b f3 58  9f 6c 61 3c c0 b0 41 d4  |....t{.X.la<..A.|
+00000140  d9 2b 2b 24 23 77 5b 1c  3b bd 75 5d ce 20 54 cf  |.++$#w[.;.u]. T.|
+00000150  a1 63 87 1d 1e 24 c4 f3  1d 1a 50 8b aa b6 14 43  |.c...$....P....C|
+00000160  ed 97 a7 75 62 f4 14 c8  52 d7 02 03 01 00 01 a3  |...ub...R.......|
+00000170  81 93 30 81 90 30 0e 06  03 55 1d 0f 01 01 ff 04  |..0..0...U......|
+00000180  04 03 02 05 a0 30 1d 06  03 55 1d 25 04 16 30 14  |.....0...U.%..0.|
+00000190  06 08 2b 06 01 05 05 07  03 01 06 08 2b 06 01 05  |..+.........+...|
+000001a0  05 07 03 02 30 0c 06 03  55 1d 13 01 01 ff 04 02  |....0...U.......|
+000001b0  30 00 30 19 06 03 55 1d  0e 04 12 04 10 9f 91 16  |0.0...U.........|
+000001c0  1f 43 43 3e 49 a6 de 6d  b6 80 d7 9f 60 30 1b 06  |.CC>I..m....`0..|
+000001d0  03 55 1d 23 04 14 30 12  80 10 48 13 49 4d 13 7e  |.U.#..0...H.IM.~|
+000001e0  16 31 bb a3 01 d5 ac ab  6e 7b 30 19 06 03 55 1d  |.1......n{0...U.|
+000001f0  11 04 12 30 10 82 0e 65  78 61 6d 70 6c 65 2e 67  |...0...example.g|
+00000200  6f 6c 61 6e 67 30 0d 06  09 2a 86 48 86 f7 0d 01  |olang0...*.H....|
+00000210  01 0b 05 00 03 81 81 00  9d 30 cc 40 2b 5b 50 a0  |.........0.@+[P.|
+00000220  61 cb ba e5 53 58 e1 ed  83 28 a9 58 1a a9 38 a4  |a...SX...(.X..8.|
+00000230  95 a1 ac 31 5a 1a 84 66  3d 43 d3 2d d9 0b f2 97  |...1Z..f=C.-....|
+00000240  df d3 20 64 38 92 24 3a  00 bc cf 9c 7d b7 40 20  |.. d8.$:....}.@ |
+00000250  01 5f aa d3 16 61 09 a2  76 fd 13 c3 cc e1 0c 5c  |._...a..v......\|
+00000260  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
+00000270  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
+00000280  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
+00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 23 0d 00 00  |.\!.;.......#...|
+000002a0  1f 02 01 40 00 18 08 04  04 03 08 07 08 05 08 06  |...@............|
+000002b0  04 01 05 01 06 01 05 03  06 03 02 01 02 03 00 00  |................|
+000002c0  16 03 03 00 04 0e 00 00  00                       |.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 01 3c 0b 00 01  38 00 01 35 00 01 32 30  |....<...8..5..20|
 00000010  82 01 2e 30 81 e1 a0 03  02 01 02 02 10 17 d1 81  |...0............|
@@ -74,36 +74,36 @@
 00000110  8a 4e 34 40 39 d6 b3 10  dc 19 fe a0 22 71 b3 f5  |.N4@9......."q..|
 00000120  8f a1 58 0d cd f4 f1 85  24 bf e6 3d 14 df df ed  |..X.....$..=....|
 00000130  0e e1 17 d8 11 a2 60 d0  8a 37 23 2a c2 46 aa 3a  |......`..7#*.F.:|
-00000140  08 16 03 03 00 86 10 00  00 82 00 80 14 f2 ac 22  |..............."|
-00000150  fb 0b f8 03 a7 cf 23 d5  ea 9f b0 f2 64 ae 41 fe  |......#.....d.A.|
-00000160  33 f7 54 69 f5 41 b7 c1  91 6d 2b 3e 14 2a f6 c8  |3.Ti.A...m+>.*..|
-00000170  96 45 00 28 13 f5 2f de  35 f9 64 89 5c 99 3e 89  |.E.(../.5.d.\.>.|
-00000180  06 ff 59 56 69 db 5f 6e  02 84 dd 1c 44 7b 86 e8  |..YVi._n....D{..|
-00000190  e3 d9 03 f1 16 9e 06 23  00 43 91 ec a9 dd da a4  |.......#.C......|
-000001a0  ac fe 5b f8 62 f9 76 19  38 83 54 b4 8c 0b 02 f0  |..[.b.v.8.T.....|
-000001b0  fa 7a 8e 2e da 9d e1 4a  c6 51 92 9b f6 4b a1 31  |.z.....J.Q...K.1|
-000001c0  c9 64 b2 a6 9a 01 52 86  b3 7a 43 17 16 03 03 00  |.d....R..zC.....|
-000001d0  48 0f 00 00 44 08 07 00  40 29 35 71 34 aa b1 f1  |H...D...@)5q4...|
-000001e0  64 08 4e 06 43 db 00 f7  f5 98 8e b6 51 d7 c4 b5  |d.N.C.......Q...|
-000001f0  2b fa 56 8b bd 7b 18 f2  81 e9 2f 81 82 d8 90 e7  |+.V..{..../.....|
-00000200  5b bc 72 7e f7 97 43 df  cd 07 bf 7b ae 60 08 8b  |[.r~..C....{.`..|
-00000210  0a 71 c5 bf f0 7a 3e cc  0b 14 03 03 00 01 01 16  |.q...z>.........|
-00000220  03 03 00 40 85 4f e0 c0  f3 3e a4 51 68 d6 ec 1b  |...@.O...>.Qh...|
-00000230  f1 4b 3e 0e 13 84 87 e3  3c 9a 5f 67 75 3a ad 08  |.K>.....<._gu:..|
-00000240  be 29 15 b0 1f 62 27 fd  d8 dd 58 b1 65 e7 e2 db  |.)...b'...X.e...|
-00000250  fe 55 a5 2d 2e 71 59 07  ad 12 12 80 12 bb 26 36  |.U.-.qY.......&6|
-00000260  93 fb ea b1                                       |....|
+00000140  08 16 03 03 00 86 10 00  00 82 00 80 77 8b 9f 34  |............w..4|
+00000150  b4 db a7 0d 5b ed 1b 2f  4a 41 64 f5 ce 4a 00 7c  |....[../JAd..J.||
+00000160  91 32 b3 cf 61 18 41 04  ae fa 3b 14 de 19 0e 64  |.2..a.A...;....d|
+00000170  f9 ec 75 a6 48 7e 28 57  26 f5 1c 75 1d 42 73 fc  |..u.H~(W&..u.Bs.|
+00000180  11 51 2b ef e5 08 83 ac  17 ec 78 b8 5b 14 84 c9  |.Q+.......x.[...|
+00000190  bc 7f 22 fd 54 69 7a 82  36 c7 21 bc d6 04 c4 e7  |..".Tiz.6.!.....|
+000001a0  bc 48 c8 72 56 5d 1e 65  41 21 0a 26 85 a0 d8 c3  |.H.rV].eA!.&....|
+000001b0  50 f0 b6 07 25 ee 79 b8  f5 e6 17 85 d4 09 e7 d7  |P...%.y.........|
+000001c0  ab 8f 17 cb c2 13 a0 5a  50 cb e4 a7 16 03 03 00  |.......ZP.......|
+000001d0  48 0f 00 00 44 08 07 00  40 b7 24 50 46 db d4 8c  |H...D...@.$PF...|
+000001e0  68 17 f5 5e 79 a9 80 8c  40 23 92 33 4e 1e cc ee  |h..^y...@#.3N...|
+000001f0  d5 35 4d b8 2a 52 f0 7f  50 8e c6 d5 5f bc 08 35  |.5M.*R..P..._..5|
+00000200  a2 6d db cb 96 52 ec 92  c7 62 c7 59 ab d8 6f 9d  |.m...R...b.Y..o.|
+00000210  d7 46 35 71 28 41 89 59  02 14 03 03 00 01 01 16  |.F5q(A.Y........|
+00000220  03 03 00 40 3e 12 44 bc  c6 3d 88 71 ba d3 0c 26  |...@>.D..=.q...&|
+00000230  20 72 b0 7f 25 83 9f fd  77 c1 f5 1e 47 28 2e 60  | r..%...w...G(.`|
+00000240  53 e0 ac 52 e8 94 e4 87  90 3f af f3 a4 c0 d3 ba  |S..R.....?......|
+00000250  fe b7 06 54 f7 13 33 36  47 8f 5e 45 22 84 18 3a  |...T..36G.^E"..:|
+00000260  1f 14 21 85                                       |..!.|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 f4 ed 23 ce da  |.............#..|
-00000020  73 5f ef 6b a2 82 3d a5  c6 f1 fd 8f a0 47 4e 34  |s_.k..=......GN4|
-00000030  f9 7c d0 67 49 00 11 c3  76 83 23 3f 99 41 d5 5c  |.|.gI...v.#?.A.\|
-00000040  aa 9f 97 66 b7 0a 59 ba  f3 40 83 17 03 03 00 40  |...f..Y..@.....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 d4 e6 b8 6f 53  |..............oS|
+00000020  6a d9 37 2b a4 95 9f 04  e5 99 2f f9 9a 16 fd a7  |j.7+....../.....|
+00000030  2d 39 d9 aa 7c 26 9e 44  4b 7f 8f d5 c6 24 4d ac  |-9..|&.DK....$M.|
+00000040  13 ca 8a 45 1e 66 dc 9a  bf 76 22 17 03 03 00 40  |...E.f...v"....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  82 66 85 d7 47 a6 5a 19  4f 89 5c 56 43 cb 6a bd  |.f..G.Z.O.\VC.j.|
-00000070  1b ae 46 40 7d e8 a9 7b  57 04 91 8b d5 de 24 f1  |..F@}..{W.....$.|
-00000080  c0 df 37 45 e9 af d7 c5  1c e7 ee 80 0d 61 2a 7f  |..7E.........a*.|
+00000060  3f 5c 60 f8 22 7b aa 82  38 c4 4a 2e 07 50 cb 6c  |?\`."{..8.J..P.l|
+00000070  3f 6f a9 39 bf 21 ce 7a  30 72 03 90 ec bc 9c 18  |?o.9.!.z0r......|
+00000080  1f a9 7f 82 3a d9 46 d9  d8 b8 77 65 e8 b3 e7 f5  |....:.F...we....|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 5a 97 f3  38 e5 3a f1 07 79 b7 eb  |.....Z..8.:..y..|
-000000b0  ed 85 57 3a 96 16 51 38  85 86 ec 1b 9b 48 82 9c  |..W:..Q8.....H..|
-000000c0  05 bf 4d e5 fb                                    |..M..|
+000000a0  00 00 00 00 00 6d 29 d4  87 0a b4 1d b4 9d f4 12  |.....m).........|
+000000b0  bc 3d a3 1b 79 21 85 0d  e7 10 64 92 40 39 05 99  |.=..y!....d.@9..|
+000000c0  c8 a7 dd ef 0e                                    |.....|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndGiven b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndGiven
index 3dec0deeb1..cc6450a4ce 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndGiven
+++ b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndGiven
@@ -1,58 +1,58 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 6d 01 00 00  69 03 03 e7 7e 1f 56 df  |....m...i...~.V.|
-00000010  f1 1b e5 92 47 3b fb 25  a6 57 7d 13 47 08 f0 0f  |....G;.%.W}.G...|
-00000020  5b 64 64 00 d3 25 33 e5  a5 5b e3 00 00 04 00 2f  |[dd..%3..[...../|
+00000000  16 03 01 00 6d 01 00 00  69 03 03 e9 31 0f d0 25  |....m...i...1..%|
+00000010  ef 25 a7 1a 9b 8c 4b a3  ca 2b a6 54 89 1c e1 68  |.%....K..+.T...h|
+00000020  6f b2 b2 60 6f 8a dc 87  24 8c 7b 00 00 04 00 2f  |o..`o...$.{..../|
 00000030  00 ff 01 00 00 3c 00 16  00 00 00 17 00 00 00 0d  |.....<..........|
 00000040  00 30 00 2e 04 03 05 03  06 03 08 07 08 08 08 09  |.0..............|
 00000050  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
 00000060  03 03 02 03 03 01 02 01  03 02 02 02 04 02 05 02  |................|
 00000070  06 02                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 31 02 00 00  2d 03 03 00 00 00 00 00  |....1...-.......|
+00000000  16 03 03 00 35 02 00 00  31 03 03 00 00 00 00 00  |....5...1.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 00 2f 00 00  |...DOWNGRD.../..|
-00000030  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
-00000040  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
-00000050  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
-00000060  09 2a 86 48 86 f7 0d 01  01 0b 05 00 30 1f 31 0b  |.*.H........0.1.|
-00000070  30 09 06 03 55 04 0a 13  02 47 6f 31 10 30 0e 06  |0...U....Go1.0..|
-00000080  03 55 04 03 13 07 47 6f  20 52 6f 6f 74 30 1e 17  |.U....Go Root0..|
-00000090  0d 31 36 30 31 30 31 30  30 30 30 30 30 5a 17 0d  |.160101000000Z..|
-000000a0  32 35 30 31 30 31 30 30  30 30 30 30 5a 30 1a 31  |250101000000Z0.1|
-000000b0  0b 30 09 06 03 55 04 0a  13 02 47 6f 31 0b 30 09  |.0...U....Go1.0.|
-000000c0  06 03 55 04 03 13 02 47  6f 30 81 9f 30 0d 06 09  |..U....Go0..0...|
-000000d0  2a 86 48 86 f7 0d 01 01  01 05 00 03 81 8d 00 30  |*.H............0|
-000000e0  81 89 02 81 81 00 db 46  7d 93 2e 12 27 06 48 bc  |.......F}...'.H.|
-000000f0  06 28 21 ab 7e c4 b6 a2  5d fe 1e 52 45 88 7a 36  |.(!.~...]..RE.z6|
-00000100  47 a5 08 0d 92 42 5b c2  81 c0 be 97 79 98 40 fb  |G....B[.....y.@.|
-00000110  4f 6d 14 fd 2b 13 8b c2  a5 2e 67 d8 d4 09 9e d6  |Om..+.....g.....|
-00000120  22 38 b7 4a 0b 74 73 2b  c2 34 f1 d1 93 e5 96 d9  |"8.J.ts+.4......|
-00000130  74 7b f3 58 9f 6c 61 3c  c0 b0 41 d4 d9 2b 2b 24  |t{.X.la<..A..++$|
-00000140  23 77 5b 1c 3b bd 75 5d  ce 20 54 cf a1 63 87 1d  |#w[.;.u]. T..c..|
-00000150  1e 24 c4 f3 1d 1a 50 8b  aa b6 14 43 ed 97 a7 75  |.$....P....C...u|
-00000160  62 f4 14 c8 52 d7 02 03  01 00 01 a3 81 93 30 81  |b...R.........0.|
-00000170  90 30 0e 06 03 55 1d 0f  01 01 ff 04 04 03 02 05  |.0...U..........|
-00000180  a0 30 1d 06 03 55 1d 25  04 16 30 14 06 08 2b 06  |.0...U.%..0...+.|
-00000190  01 05 05 07 03 01 06 08  2b 06 01 05 05 07 03 02  |........+.......|
-000001a0  30 0c 06 03 55 1d 13 01  01 ff 04 02 30 00 30 19  |0...U.......0.0.|
-000001b0  06 03 55 1d 0e 04 12 04  10 9f 91 16 1f 43 43 3e  |..U..........CC>|
-000001c0  49 a6 de 6d b6 80 d7 9f  60 30 1b 06 03 55 1d 23  |I..m....`0...U.#|
-000001d0  04 14 30 12 80 10 48 13  49 4d 13 7e 16 31 bb a3  |..0...H.IM.~.1..|
-000001e0  01 d5 ac ab 6e 7b 30 19  06 03 55 1d 11 04 12 30  |....n{0...U....0|
-000001f0  10 82 0e 65 78 61 6d 70  6c 65 2e 67 6f 6c 61 6e  |...example.golan|
-00000200  67 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |g0...*.H........|
-00000210  03 81 81 00 9d 30 cc 40  2b 5b 50 a0 61 cb ba e5  |.....0.@+[P.a...|
-00000220  53 58 e1 ed 83 28 a9 58  1a a9 38 a4 95 a1 ac 31  |SX...(.X..8....1|
-00000230  5a 1a 84 66 3d 43 d3 2d  d9 0b f2 97 df d3 20 64  |Z..f=C.-...... d|
-00000240  38 92 24 3a 00 bc cf 9c  7d b7 40 20 01 5f aa d3  |8.$:....}.@ ._..|
-00000250  16 61 09 a2 76 fd 13 c3  cc e1 0c 5c ee b1 87 82  |.a..v......\....|
-00000260  f1 6c 04 ed 73 bb b3 43  77 8d 0c 1c f1 0f a1 d8  |.l..s..Cw.......|
-00000270  40 83 61 c9 4c 72 2b 9d  ae db 46 06 06 4d f4 c1  |@.a.Lr+...F..M..|
-00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
-00000290  3b e9 fa e7 16 03 03 00  23 0d 00 00 1f 02 01 40  |;.......#......@|
-000002a0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000002b0  06 01 05 03 06 03 02 01  02 03 00 00 16 03 03 00  |................|
-000002c0  04 0e 00 00 00                                    |.....|
+00000030  09 ff 01 00 01 00 00 17  00 00 16 03 03 02 59 0b  |..............Y.|
+00000040  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
+00000050  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
+00000060  a6 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |.0...*.H........|
+00000070  30 1f 31 0b 30 09 06 03  55 04 0a 13 02 47 6f 31  |0.1.0...U....Go1|
+00000080  10 30 0e 06 03 55 04 03  13 07 47 6f 20 52 6f 6f  |.0...U....Go Roo|
+00000090  74 30 1e 17 0d 31 36 30  31 30 31 30 30 30 30 30  |t0...16010100000|
+000000a0  30 5a 17 0d 32 35 30 31  30 31 30 30 30 30 30 30  |0Z..250101000000|
+000000b0  5a 30 1a 31 0b 30 09 06  03 55 04 0a 13 02 47 6f  |Z0.1.0...U....Go|
+000000c0  31 0b 30 09 06 03 55 04  03 13 02 47 6f 30 81 9f  |1.0...U....Go0..|
+000000d0  30 0d 06 09 2a 86 48 86  f7 0d 01 01 01 05 00 03  |0...*.H.........|
+000000e0  81 8d 00 30 81 89 02 81  81 00 db 46 7d 93 2e 12  |...0.......F}...|
+000000f0  27 06 48 bc 06 28 21 ab  7e c4 b6 a2 5d fe 1e 52  |'.H..(!.~...]..R|
+00000100  45 88 7a 36 47 a5 08 0d  92 42 5b c2 81 c0 be 97  |E.z6G....B[.....|
+00000110  79 98 40 fb 4f 6d 14 fd  2b 13 8b c2 a5 2e 67 d8  |y.@.Om..+.....g.|
+00000120  d4 09 9e d6 22 38 b7 4a  0b 74 73 2b c2 34 f1 d1  |...."8.J.ts+.4..|
+00000130  93 e5 96 d9 74 7b f3 58  9f 6c 61 3c c0 b0 41 d4  |....t{.X.la<..A.|
+00000140  d9 2b 2b 24 23 77 5b 1c  3b bd 75 5d ce 20 54 cf  |.++$#w[.;.u]. T.|
+00000150  a1 63 87 1d 1e 24 c4 f3  1d 1a 50 8b aa b6 14 43  |.c...$....P....C|
+00000160  ed 97 a7 75 62 f4 14 c8  52 d7 02 03 01 00 01 a3  |...ub...R.......|
+00000170  81 93 30 81 90 30 0e 06  03 55 1d 0f 01 01 ff 04  |..0..0...U......|
+00000180  04 03 02 05 a0 30 1d 06  03 55 1d 25 04 16 30 14  |.....0...U.%..0.|
+00000190  06 08 2b 06 01 05 05 07  03 01 06 08 2b 06 01 05  |..+.........+...|
+000001a0  05 07 03 02 30 0c 06 03  55 1d 13 01 01 ff 04 02  |....0...U.......|
+000001b0  30 00 30 19 06 03 55 1d  0e 04 12 04 10 9f 91 16  |0.0...U.........|
+000001c0  1f 43 43 3e 49 a6 de 6d  b6 80 d7 9f 60 30 1b 06  |.CC>I..m....`0..|
+000001d0  03 55 1d 23 04 14 30 12  80 10 48 13 49 4d 13 7e  |.U.#..0...H.IM.~|
+000001e0  16 31 bb a3 01 d5 ac ab  6e 7b 30 19 06 03 55 1d  |.1......n{0...U.|
+000001f0  11 04 12 30 10 82 0e 65  78 61 6d 70 6c 65 2e 67  |...0...example.g|
+00000200  6f 6c 61 6e 67 30 0d 06  09 2a 86 48 86 f7 0d 01  |olang0...*.H....|
+00000210  01 0b 05 00 03 81 81 00  9d 30 cc 40 2b 5b 50 a0  |.........0.@+[P.|
+00000220  61 cb ba e5 53 58 e1 ed  83 28 a9 58 1a a9 38 a4  |a...SX...(.X..8.|
+00000230  95 a1 ac 31 5a 1a 84 66  3d 43 d3 2d d9 0b f2 97  |...1Z..f=C.-....|
+00000240  df d3 20 64 38 92 24 3a  00 bc cf 9c 7d b7 40 20  |.. d8.$:....}.@ |
+00000250  01 5f aa d3 16 61 09 a2  76 fd 13 c3 cc e1 0c 5c  |._...a..v......\|
+00000260  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
+00000270  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
+00000280  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
+00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 23 0d 00 00  |.\!.;.......#...|
+000002a0  1f 02 01 40 00 18 08 04  04 03 08 07 08 05 08 06  |...@............|
+000002b0  04 01 05 01 06 01 05 03  06 03 02 01 02 03 00 00  |................|
+000002c0  16 03 03 00 04 0e 00 00  00                       |.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
 00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
@@ -86,40 +86,40 @@
 000001d0  ac 11 b1 28 56 be 1d cd  61 62 84 09 bf d6 80 c6  |...(V...ab......|
 000001e0  45 8d 82 2c b4 d8 83 9b  db c9 22 b7 2a 12 11 7b  |E..,......".*..{|
 000001f0  fa 02 3b c1 c9 ff ea c9  9d a8 49 d3 95 d7 d5 0e  |..;.......I.....|
-00000200  e5 35 16 03 03 00 86 10  00 00 82 00 80 7f 38 c9  |.5............8.|
-00000210  56 ed de 7d a6 2c dc cc  24 61 ea d3 8a fc b8 18  |V..}.,..$a......|
-00000220  b8 e5 50 3e c3 d1 ca cf  f7 0c d9 9b 22 d8 6d 0f  |..P>........".m.|
-00000230  71 e7 dd 7c 24 84 c6 f1  6a ac a0 3d ea d7 65 24  |q..|$...j..=..e$|
-00000240  d7 3a 17 d5 b7 ec f7 03  bc 58 3a 01 d5 08 27 25  |.:.......X:...'%|
-00000250  b9 2f 3b 96 cb d5 7c 12  20 f4 f1 91 58 13 fb 50  |./;...|. ...X..P|
-00000260  f8 d5 5c e4 43 85 e8 41  37 3e ff fa a6 64 92 4d  |..\.C..A7>...d.M|
-00000270  bd d4 96 59 bd 94 f1 95  21 ad 75 1e 0d a2 8d 30  |...Y....!.u....0|
-00000280  a3 82 f4 56 0f ba 5d 40  32 7f 0c 5f 5a 16 03 03  |...V..]@2.._Z...|
-00000290  00 88 0f 00 00 84 08 04  00 80 39 b4 f4 68 e9 96  |..........9..h..|
-000002a0  01 53 95 31 26 fa 3c 70  46 9f ba 62 b4 37 ea a6  |.S.1&.<pF..b.7..|
-000002b0  e4 81 d1 21 f4 1f 21 d4  6d c0 98 20 40 56 52 79  |...!..!.m.. @VRy|
-000002c0  99 18 c7 f1 6f 01 25 e1  65 71 33 9e 4b 81 11 a0  |....o.%.eq3.K...|
-000002d0  68 e2 be 39 05 86 81 44  a5 64 3d 07 e3 3b 48 70  |h..9...D.d=..;Hp|
-000002e0  14 fd 1f 75 05 23 44 57  3e dd 47 79 17 c3 5e 70  |...u.#DW>.Gy..^p|
-000002f0  30 8c 11 3f 27 43 4f 5d  81 89 83 39 9d fe 0c c3  |0..?'CO]...9....|
-00000300  af 40 8d 2a 41 bf 57 67  7a df b4 89 29 10 9a 84  |.@.*A.Wgz...)...|
-00000310  ff 8c 2f 58 1a 0a b9 62  4e 8e 14 03 03 00 01 01  |../X...bN.......|
-00000320  16 03 03 00 40 7c 7a 79  ae 84 60 b8 95 83 30 78  |....@|zy..`...0x|
-00000330  e9 6e 02 36 52 85 5a 6a  a7 b5 f5 6d 4d a9 09 9d  |.n.6R.Zj...mM...|
-00000340  43 9d 46 da d0 cf 75 25  49 e1 79 0b 23 2d 85 c2  |C.F...u%I.y.#-..|
-00000350  fd 5d 90 08 f5 75 81 ab  01 a0 f4 93 12 87 fb e3  |.]...u..........|
-00000360  9b 99 4d fa c5                                    |..M..|
+00000200  e5 35 16 03 03 00 86 10  00 00 82 00 80 29 51 da  |.5...........)Q.|
+00000210  8e 5c 3e fb 44 8a 0f 97  42 23 8b e2 73 cc e2 90  |.\>.D...B#..s...|
+00000220  11 c4 98 01 e9 60 96 9e  a9 96 30 c5 95 f8 56 0e  |.....`....0...V.|
+00000230  4a 2e 77 e7 7e 23 b7 49  31 c4 87 c5 69 c6 ca 6f  |J.w.~#.I1...i..o|
+00000240  ea 53 41 b4 2e 1e f6 0b  33 f5 e1 40 69 c0 91 6f  |.SA.....3..@i..o|
+00000250  88 c1 68 c8 18 99 6e fe  b3 5f 9b ee f1 4a 76 41  |..h...n.._...JvA|
+00000260  1f d1 05 f5 39 76 61 e6  a6 ea 75 0e 50 32 a1 19  |....9va...u.P2..|
+00000270  20 6a 4c 5d 62 6e 2a 6e  af f9 9c 38 b6 3a bc 86  | jL]bn*n...8.:..|
+00000280  eb ac 6d d3 b5 48 30 11  4d 98 2e 61 34 16 03 03  |..m..H0.M..a4...|
+00000290  00 88 0f 00 00 84 08 04  00 80 82 ed 3f da b5 50  |............?..P|
+000002a0  d2 50 51 14 cf ee f7 b9  7b a9 0c 77 2f 88 42 0a  |.PQ.....{..w/.B.|
+000002b0  34 a9 5d e7 32 26 3a 28  87 49 fb c4 83 31 68 c6  |4.].2&:(.I...1h.|
+000002c0  0d 32 d4 31 0a d1 d6 1e  6f 7f 89 93 bf b7 7c c7  |.2.1....o.....|.|
+000002d0  95 f8 c3 69 d8 58 4e e4  76 07 36 84 b7 c3 e7 22  |...i.XN.v.6...."|
+000002e0  01 4c 59 ae 89 95 bb e0  07 e0 31 6a e2 95 4c d4  |.LY.......1j..L.|
+000002f0  01 54 9d 27 82 60 31 13  39 07 47 c2 0c 08 5c d4  |.T.'.`1.9.G...\.|
+00000300  03 5a 6f d7 89 a0 67 5e  2d a0 11 03 bf 0e 35 d8  |.Zo...g^-.....5.|
+00000310  d0 78 2f 1e d8 15 47 ce  c9 d3 14 03 03 00 01 01  |.x/...G.........|
+00000320  16 03 03 00 40 d0 0a 0e  93 dd 9a 51 4f a9 7f 5f  |....@......QO.._|
+00000330  93 a6 60 a6 f2 10 f1 bd  bd ae 13 5d 11 b7 0d 1a  |..`........]....|
+00000340  3d 1e f3 0c b7 53 7c 10  ed fa 8c d7 3f 20 ec f2  |=....S|.....? ..|
+00000350  7d e9 15 87 3d d3 05 21  3a bc a5 54 fa 40 3b 53  |}...=..!:..T.@;S|
+00000360  41 7c ea c6 28                                    |A|..(|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 48 61 67 c0 1e  |...........Hag..|
-00000020  09 79 82 cc 55 60 fa e5  bd 1a 1d 14 d3 25 e6 4b  |.y..U`.......%.K|
-00000030  b7 a6 47 64 01 65 12 b3  37 42 1a 13 d9 90 12 7e  |..Gd.e..7B.....~|
-00000040  ea d8 30 39 e2 25 5e 9a  05 61 11 17 03 03 00 40  |..09.%^..a.....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 a8 8e 30 08 f0  |.............0..|
+00000020  87 7b 13 31 99 6d 7e 9a  9b 03 d3 6f 84 d8 d9 31  |.{.1.m~....o...1|
+00000030  2b d2 aa d4 0e ae 6e 72  03 ac e7 7e 5c 22 cc ac  |+.....nr...~\"..|
+00000040  33 b5 df 04 b2 4a 2b 6f  bb a1 6f 17 03 03 00 40  |3....J+o..o....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  cf c5 73 08 e9 15 25 b6  d8 e3 fa 0c a1 25 33 75  |..s...%......%3u|
-00000070  8a 2e 66 03 c2 2d 50 c7  e1 10 b4 2a 0c 88 87 90  |..f..-P....*....|
-00000080  04 4a 80 26 85 4b fd 9a  4f 0e b1 2c f0 18 57 f5  |.J.&.K..O..,..W.|
+00000060  50 9c 81 04 9b 1d 61 8a  30 9c 18 68 c7 e1 c9 f3  |P.....a.0..h....|
+00000070  70 f0 1b b6 4a dd fc c7  e3 e3 20 e2 4d 6f 9f bf  |p...J..... .Mo..|
+00000080  17 b0 5e 5b 45 73 29 1e  d4 30 b4 03 ca 8e 69 63  |..^[Es)..0....ic|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 ce e0 a1  71 be 3d 1e b0 bd 06 4c  |........q.=....L|
-000000b0  1f 5b 10 8d 77 18 e0 c5  81 c9 4e 1b 3b 96 f6 6d  |.[..w.....N.;..m|
-000000c0  88 03 53 54 30                                    |..ST0|
+000000a0  00 00 00 00 00 28 ca 6a  4c 1b 3c 11 61 ce b2 58  |.....(.jL.<.a..X|
+000000b0  94 e7 e4 7d c5 ce 51 03  c4 ae b5 4c 33 0b 3c 95  |...}..Q....L3.<.|
+000000c0  ec b1 65 ea da                                    |..e..|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndPKCS1v15Given b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndPKCS1v15Given
index 8efbc912d9..875fe1becb 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndPKCS1v15Given
+++ b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedAndPKCS1v15Given
@@ -1,58 +1,58 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 6d 01 00 00  69 03 03 4c 65 99 ab e0  |....m...i..Le...|
-00000010  4b 0a 08 f5 06 20 f9 3d  96 4f 05 e3 58 6f 41 50  |K.... .=.O..XoAP|
-00000020  c1 5f e8 a8 0a 5f 8f f2  de 7f 16 00 00 04 00 2f  |._..._........./|
+00000000  16 03 01 00 6d 01 00 00  69 03 03 dc f3 c6 52 a4  |....m...i.....R.|
+00000010  9a 9c 53 e0 5a 3c cc 4c  4f 09 32 7f f1 7c 86 6b  |..S.Z<.LO.2..|.k|
+00000020  75 59 68 a5 81 72 45 46  fb 94 a8 00 00 04 00 2f  |uYh..rEF......./|
 00000030  00 ff 01 00 00 3c 00 16  00 00 00 17 00 00 00 0d  |.....<..........|
 00000040  00 30 00 2e 04 03 05 03  06 03 08 07 08 08 08 09  |.0..............|
 00000050  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
 00000060  03 03 02 03 03 01 02 01  03 02 02 02 04 02 05 02  |................|
 00000070  06 02                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 31 02 00 00  2d 03 03 00 00 00 00 00  |....1...-.......|
+00000000  16 03 03 00 35 02 00 00  31 03 03 00 00 00 00 00  |....5...1.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 00 2f 00 00  |...DOWNGRD.../..|
-00000030  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
-00000040  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
-00000050  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
-00000060  09 2a 86 48 86 f7 0d 01  01 0b 05 00 30 1f 31 0b  |.*.H........0.1.|
-00000070  30 09 06 03 55 04 0a 13  02 47 6f 31 10 30 0e 06  |0...U....Go1.0..|
-00000080  03 55 04 03 13 07 47 6f  20 52 6f 6f 74 30 1e 17  |.U....Go Root0..|
-00000090  0d 31 36 30 31 30 31 30  30 30 30 30 30 5a 17 0d  |.160101000000Z..|
-000000a0  32 35 30 31 30 31 30 30  30 30 30 30 5a 30 1a 31  |250101000000Z0.1|
-000000b0  0b 30 09 06 03 55 04 0a  13 02 47 6f 31 0b 30 09  |.0...U....Go1.0.|
-000000c0  06 03 55 04 03 13 02 47  6f 30 81 9f 30 0d 06 09  |..U....Go0..0...|
-000000d0  2a 86 48 86 f7 0d 01 01  01 05 00 03 81 8d 00 30  |*.H............0|
-000000e0  81 89 02 81 81 00 db 46  7d 93 2e 12 27 06 48 bc  |.......F}...'.H.|
-000000f0  06 28 21 ab 7e c4 b6 a2  5d fe 1e 52 45 88 7a 36  |.(!.~...]..RE.z6|
-00000100  47 a5 08 0d 92 42 5b c2  81 c0 be 97 79 98 40 fb  |G....B[.....y.@.|
-00000110  4f 6d 14 fd 2b 13 8b c2  a5 2e 67 d8 d4 09 9e d6  |Om..+.....g.....|
-00000120  22 38 b7 4a 0b 74 73 2b  c2 34 f1 d1 93 e5 96 d9  |"8.J.ts+.4......|
-00000130  74 7b f3 58 9f 6c 61 3c  c0 b0 41 d4 d9 2b 2b 24  |t{.X.la<..A..++$|
-00000140  23 77 5b 1c 3b bd 75 5d  ce 20 54 cf a1 63 87 1d  |#w[.;.u]. T..c..|
-00000150  1e 24 c4 f3 1d 1a 50 8b  aa b6 14 43 ed 97 a7 75  |.$....P....C...u|
-00000160  62 f4 14 c8 52 d7 02 03  01 00 01 a3 81 93 30 81  |b...R.........0.|
-00000170  90 30 0e 06 03 55 1d 0f  01 01 ff 04 04 03 02 05  |.0...U..........|
-00000180  a0 30 1d 06 03 55 1d 25  04 16 30 14 06 08 2b 06  |.0...U.%..0...+.|
-00000190  01 05 05 07 03 01 06 08  2b 06 01 05 05 07 03 02  |........+.......|
-000001a0  30 0c 06 03 55 1d 13 01  01 ff 04 02 30 00 30 19  |0...U.......0.0.|
-000001b0  06 03 55 1d 0e 04 12 04  10 9f 91 16 1f 43 43 3e  |..U..........CC>|
-000001c0  49 a6 de 6d b6 80 d7 9f  60 30 1b 06 03 55 1d 23  |I..m....`0...U.#|
-000001d0  04 14 30 12 80 10 48 13  49 4d 13 7e 16 31 bb a3  |..0...H.IM.~.1..|
-000001e0  01 d5 ac ab 6e 7b 30 19  06 03 55 1d 11 04 12 30  |....n{0...U....0|
-000001f0  10 82 0e 65 78 61 6d 70  6c 65 2e 67 6f 6c 61 6e  |...example.golan|
-00000200  67 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |g0...*.H........|
-00000210  03 81 81 00 9d 30 cc 40  2b 5b 50 a0 61 cb ba e5  |.....0.@+[P.a...|
-00000220  53 58 e1 ed 83 28 a9 58  1a a9 38 a4 95 a1 ac 31  |SX...(.X..8....1|
-00000230  5a 1a 84 66 3d 43 d3 2d  d9 0b f2 97 df d3 20 64  |Z..f=C.-...... d|
-00000240  38 92 24 3a 00 bc cf 9c  7d b7 40 20 01 5f aa d3  |8.$:....}.@ ._..|
-00000250  16 61 09 a2 76 fd 13 c3  cc e1 0c 5c ee b1 87 82  |.a..v......\....|
-00000260  f1 6c 04 ed 73 bb b3 43  77 8d 0c 1c f1 0f a1 d8  |.l..s..Cw.......|
-00000270  40 83 61 c9 4c 72 2b 9d  ae db 46 06 06 4d f4 c1  |@.a.Lr+...F..M..|
-00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
-00000290  3b e9 fa e7 16 03 03 00  23 0d 00 00 1f 02 01 40  |;.......#......@|
-000002a0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000002b0  06 01 05 03 06 03 02 01  02 03 00 00 16 03 03 00  |................|
-000002c0  04 0e 00 00 00                                    |.....|
+00000030  09 ff 01 00 01 00 00 17  00 00 16 03 03 02 59 0b  |..............Y.|
+00000040  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
+00000050  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
+00000060  a6 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |.0...*.H........|
+00000070  30 1f 31 0b 30 09 06 03  55 04 0a 13 02 47 6f 31  |0.1.0...U....Go1|
+00000080  10 30 0e 06 03 55 04 03  13 07 47 6f 20 52 6f 6f  |.0...U....Go Roo|
+00000090  74 30 1e 17 0d 31 36 30  31 30 31 30 30 30 30 30  |t0...16010100000|
+000000a0  30 5a 17 0d 32 35 30 31  30 31 30 30 30 30 30 30  |0Z..250101000000|
+000000b0  5a 30 1a 31 0b 30 09 06  03 55 04 0a 13 02 47 6f  |Z0.1.0...U....Go|
+000000c0  31 0b 30 09 06 03 55 04  03 13 02 47 6f 30 81 9f  |1.0...U....Go0..|
+000000d0  30 0d 06 09 2a 86 48 86  f7 0d 01 01 01 05 00 03  |0...*.H.........|
+000000e0  81 8d 00 30 81 89 02 81  81 00 db 46 7d 93 2e 12  |...0.......F}...|
+000000f0  27 06 48 bc 06 28 21 ab  7e c4 b6 a2 5d fe 1e 52  |'.H..(!.~...]..R|
+00000100  45 88 7a 36 47 a5 08 0d  92 42 5b c2 81 c0 be 97  |E.z6G....B[.....|
+00000110  79 98 40 fb 4f 6d 14 fd  2b 13 8b c2 a5 2e 67 d8  |y.@.Om..+.....g.|
+00000120  d4 09 9e d6 22 38 b7 4a  0b 74 73 2b c2 34 f1 d1  |...."8.J.ts+.4..|
+00000130  93 e5 96 d9 74 7b f3 58  9f 6c 61 3c c0 b0 41 d4  |....t{.X.la<..A.|
+00000140  d9 2b 2b 24 23 77 5b 1c  3b bd 75 5d ce 20 54 cf  |.++$#w[.;.u]. T.|
+00000150  a1 63 87 1d 1e 24 c4 f3  1d 1a 50 8b aa b6 14 43  |.c...$....P....C|
+00000160  ed 97 a7 75 62 f4 14 c8  52 d7 02 03 01 00 01 a3  |...ub...R.......|
+00000170  81 93 30 81 90 30 0e 06  03 55 1d 0f 01 01 ff 04  |..0..0...U......|
+00000180  04 03 02 05 a0 30 1d 06  03 55 1d 25 04 16 30 14  |.....0...U.%..0.|
+00000190  06 08 2b 06 01 05 05 07  03 01 06 08 2b 06 01 05  |..+.........+...|
+000001a0  05 07 03 02 30 0c 06 03  55 1d 13 01 01 ff 04 02  |....0...U.......|
+000001b0  30 00 30 19 06 03 55 1d  0e 04 12 04 10 9f 91 16  |0.0...U.........|
+000001c0  1f 43 43 3e 49 a6 de 6d  b6 80 d7 9f 60 30 1b 06  |.CC>I..m....`0..|
+000001d0  03 55 1d 23 04 14 30 12  80 10 48 13 49 4d 13 7e  |.U.#..0...H.IM.~|
+000001e0  16 31 bb a3 01 d5 ac ab  6e 7b 30 19 06 03 55 1d  |.1......n{0...U.|
+000001f0  11 04 12 30 10 82 0e 65  78 61 6d 70 6c 65 2e 67  |...0...example.g|
+00000200  6f 6c 61 6e 67 30 0d 06  09 2a 86 48 86 f7 0d 01  |olang0...*.H....|
+00000210  01 0b 05 00 03 81 81 00  9d 30 cc 40 2b 5b 50 a0  |.........0.@+[P.|
+00000220  61 cb ba e5 53 58 e1 ed  83 28 a9 58 1a a9 38 a4  |a...SX...(.X..8.|
+00000230  95 a1 ac 31 5a 1a 84 66  3d 43 d3 2d d9 0b f2 97  |...1Z..f=C.-....|
+00000240  df d3 20 64 38 92 24 3a  00 bc cf 9c 7d b7 40 20  |.. d8.$:....}.@ |
+00000250  01 5f aa d3 16 61 09 a2  76 fd 13 c3 cc e1 0c 5c  |._...a..v......\|
+00000260  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
+00000270  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
+00000280  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
+00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 23 0d 00 00  |.\!.;.......#...|
+000002a0  1f 02 01 40 00 18 08 04  04 03 08 07 08 05 08 06  |...@............|
+000002b0  04 01 05 01 06 01 05 03  06 03 02 01 02 03 00 00  |................|
+000002c0  16 03 03 00 04 0e 00 00  00                       |.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 01 fd 0b 00 01  f9 00 01 f6 00 01 f3 30  |...............0|
 00000010  82 01 ef 30 82 01 58 a0  03 02 01 02 02 10 5c 19  |...0..X.......\.|
@@ -86,40 +86,40 @@
 000001d0  ac 11 b1 28 56 be 1d cd  61 62 84 09 bf d6 80 c6  |...(V...ab......|
 000001e0  45 8d 82 2c b4 d8 83 9b  db c9 22 b7 2a 12 11 7b  |E..,......".*..{|
 000001f0  fa 02 3b c1 c9 ff ea c9  9d a8 49 d3 95 d7 d5 0e  |..;.......I.....|
-00000200  e5 35 16 03 03 00 86 10  00 00 82 00 80 41 62 b4  |.5...........Ab.|
-00000210  fb 81 80 58 e3 0d c7 b2  c0 55 ee 5b 1a ba 2d 8f  |...X.....U.[..-.|
-00000220  9f 79 24 0a d5 be c7 2b  55 ec 51 6d b9 78 63 85  |.y$....+U.Qm.xc.|
-00000230  82 d2 ea 02 0c 06 fe 05  fd ed 08 be 71 99 5f 53  |............q._S|
-00000240  94 85 01 ff ba 2a ee 14  cb 99 0a df 1e 67 0d 95  |.....*.......g..|
-00000250  63 8d 1f 96 41 75 f9 5d  1a 21 03 6c e3 eb 4f 5e  |c...Au.].!.l..O^|
-00000260  28 c3 4d bb 6d 29 33 bc  24 75 8c 3b f2 c4 6b f5  |(.M.m)3.$u.;..k.|
-00000270  86 db 40 59 34 43 fb a9  1e ea 6f 3f 0e b4 35 39  |..@Y4C....o?..59|
-00000280  52 d8 0f 85 ed 3b 52 b6  5b 7f b0 bf c3 16 03 03  |R....;R.[.......|
-00000290  00 88 0f 00 00 84 04 01  00 80 52 85 ca 08 7d 07  |..........R...}.|
-000002a0  bc d8 0c a4 b8 36 01 c0  b8 8a 18 ba d8 d4 a3 fa  |.....6..........|
-000002b0  fd 32 e2 00 72 e5 d2 c8  5a 59 6b 5e 6e df 35 da  |.2..r...ZYk^n.5.|
-000002c0  c7 1e ee af 87 4b d6 30  7e 27 1c 76 70 28 79 ac  |.....K.0~'.vp(y.|
-000002d0  7f 31 bc 44 55 3c 15 61  d2 0d 24 9c 48 43 9f 12  |.1.DU<.a..$.HC..|
-000002e0  a6 74 5c 2f 5b 4e 96 4a  47 b4 6b 7c fa da 37 96  |.t\/[N.JG.k|..7.|
-000002f0  ec 46 7d 05 be 24 8f cf  11 31 ab 4c 5b c7 3e 94  |.F}..$...1.L[.>.|
-00000300  9a 2a 39 e8 fe aa aa ee  e3 00 a3 a8 1e 75 4a 21  |.*9..........uJ!|
-00000310  b4 ad 24 8f ee e8 30 85  b1 28 14 03 03 00 01 01  |..$...0..(......|
-00000320  16 03 03 00 40 71 47 13  68 49 74 9c 2a 81 35 94  |....@qG.hIt.*.5.|
-00000330  52 f6 44 44 67 3b 62 e1  ef 34 18 e7 8a 56 71 88  |R.DDg;b..4...Vq.|
-00000340  83 7e 67 28 20 18 b1 c5  8a c8 8b 6a fe ee bf da  |.~g( ......j....|
-00000350  5f 6e cd fa a8 5c af 5c  3c 83 80 78 f3 fe 1b dc  |_n...\.\<..x....|
-00000360  95 fe 22 16 82                                    |.."..|
+00000200  e5 35 16 03 03 00 86 10  00 00 82 00 80 b5 77 6b  |.5............wk|
+00000210  fa 10 fb df 48 8f e7 51  b4 cb 14 c5 48 bd 63 d6  |....H..Q....H.c.|
+00000220  0e 19 d0 81 a8 5a d7 b5  43 84 35 85 37 b7 8d 2e  |.....Z..C.5.7...|
+00000230  c7 c8 70 4c f4 45 bf be  17 86 e7 40 1d 6f 88 2a  |..pL.E.....@.o.*|
+00000240  91 b5 aa aa 34 f7 9a f3  96 e4 dd 51 15 88 be f1  |....4......Q....|
+00000250  80 a9 6f 94 ed c7 5d 28  66 b4 37 e8 22 4f 42 c3  |..o...](f.7."OB.|
+00000260  b5 f0 2f dd 57 dc 8d e5  5a c0 9d fa ce 3c 7a 2d  |../.W...Z....<z-|
+00000270  1d 45 9b fc 7b ba e7 11  eb 16 ae 68 bd b4 94 14  |.E..{......h....|
+00000280  3a a2 4d 0d e0 cd 53 a9  f1 07 d6 4a 41 16 03 03  |:.M...S....JA...|
+00000290  00 88 0f 00 00 84 04 01  00 80 78 60 7e 91 f5 47  |..........x`~..G|
+000002a0  15 61 85 70 cf b3 16 6e  45 4c 8b 42 2a 66 7e b6  |.a.p...nEL.B*f~.|
+000002b0  76 4f 26 6b b5 d7 e1 68  c2 2e bf b9 71 f2 30 7f  |vO&k...h....q.0.|
+000002c0  e4 50 56 1e 0e 64 cf 05  5c 57 be 84 ce ac 8e 04  |.PV..d..\W......|
+000002d0  44 f8 c5 2a 55 ab c5 50  84 c4 b0 73 c7 73 46 80  |D..*U..P...s.sF.|
+000002e0  bd 33 0f bc 90 2f af 50  5a 21 a7 ec 01 6b f2 ae  |.3.../.PZ!...k..|
+000002f0  84 bf 08 cb 7b 3a ca cb  76 bb e3 d7 e1 8e ee e2  |....{:..v.......|
+00000300  88 25 b0 9b 68 74 ff 48  5f 48 e0 8e bd 04 d0 85  |.%..ht.H_H......|
+00000310  ea 58 93 0c c4 27 01 38  5b c5 14 03 03 00 01 01  |.X...'.8[.......|
+00000320  16 03 03 00 40 9a 93 f3  2f 40 10 df 03 f1 90 8f  |....@.../@......|
+00000330  41 4a 76 77 44 7c 00 13  c0 2b a2 86 b3 4e 09 93  |AJvwD|...+...N..|
+00000340  01 e4 3a d4 53 ae a1 4c  07 56 18 3c ec 7f 98 a6  |..:.S..L.V.<....|
+00000350  04 7b 15 23 e4 e1 75 15  ec 33 1d 09 04 e8 04 1a  |.{.#..u..3......|
+00000360  e1 51 0c 78 99                                    |.Q.x.|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 20 f7 51 8f 23  |........... .Q.#|
-00000020  08 8d 67 5d 12 06 b0 48  81 2d 0c ba 88 03 88 31  |..g]...H.-.....1|
-00000030  d0 ab 63 0d 9f 28 60 21  0a a3 58 47 c2 04 cc f1  |..c..(`!..XG....|
-00000040  50 0d 88 b2 e5 54 50 26  e6 6e ed 17 03 03 00 40  |P....TP&.n.....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 a2 b0 ad 7e 71  |..............~q|
+00000020  0c 2c db df 4c b1 4f 19  e6 00 4f 11 ff 5e 4a c5  |.,..L.O...O..^J.|
+00000030  c2 9d 8c 6c 03 50 12 3d  81 ec 44 5a 75 ba 2d 48  |...l.P.=..DZu.-H|
+00000040  7a 74 c3 a3 68 5a 26 ee  7e f5 a2 17 03 03 00 40  |zt..hZ&.~......@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  fa 4d e5 00 14 2c 65 82  5d 1b bf 99 6a 54 16 98  |.M...,e.]...jT..|
-00000070  ef 55 15 00 f9 c4 3e 61  88 83 63 fd 60 66 f1 87  |.U....>a..c.`f..|
-00000080  fa c4 45 ae de b8 0a 36  75 f5 b2 b6 f5 d8 9b df  |..E....6u.......|
+00000060  ad 1b 16 8e 39 99 64 7c  c5 49 24 83 c4 4e f6 86  |....9.d|.I$..N..|
+00000070  6b 5d 68 ae f4 0b 58 23  83 eb ab 01 52 4d 07 a1  |k]h...X#....RM..|
+00000080  59 00 e8 dc a5 a1 6f 76  e2 e9 f2 e1 21 58 6b a0  |Y.....ov....!Xk.|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 54 cc c0  15 e5 6d 62 4d 13 54 e8  |.....T....mbM.T.|
-000000b0  fa cf 76 a6 de d6 48 f8  0d ef 30 b7 12 05 cf 75  |..v...H...0....u|
-000000c0  8b 00 9e d5 63                                    |....c|
+000000a0  00 00 00 00 00 3c 6e a7  81 36 d0 8c 99 d8 f3 55  |.....<n..6.....U|
+000000b0  02 2e 1a 48 2d 5c 46 6e  ff f2 17 f2 d4 60 b5 9e  |...H-\Fn.....`..|
+000000c0  33 54 50 0d 6d                                    |3TP.m|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedNotGiven b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedNotGiven
index a81c173153..7c2c59d3f9 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedNotGiven
+++ b/src/crypto/tls/testdata/Server-TLSv12-ClientAuthRequestedNotGiven
@@ -1,85 +1,85 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 6d 01 00 00  69 03 03 be a7 a4 6c f7  |....m...i.....l.|
-00000010  f6 b4 f2 64 5d 0e 36 b6  05 f5 f1 c9 fe 3c c2 8e  |...d].6......<..|
-00000020  c4 b7 18 68 b9 0c 1d 51  50 2f 1e 00 00 04 00 2f  |...h...QP/...../|
+00000000  16 03 01 00 6d 01 00 00  69 03 03 ac ea d9 49 98  |....m...i.....I.|
+00000010  9a 0c 7c 86 64 7c 73 72  6d 79 3f 7b e9 11 8b 1d  |..|.d|srmy?{....|
+00000020  79 95 f5 f5 23 9f b2 f1  9c f4 b5 00 00 04 00 2f  |y...#........../|
 00000030  00 ff 01 00 00 3c 00 16  00 00 00 17 00 00 00 0d  |.....<..........|
 00000040  00 30 00 2e 04 03 05 03  06 03 08 07 08 08 08 09  |.0..............|
 00000050  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
 00000060  03 03 02 03 03 01 02 01  03 02 02 02 04 02 05 02  |................|
 00000070  06 02                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 31 02 00 00  2d 03 03 00 00 00 00 00  |....1...-.......|
+00000000  16 03 03 00 35 02 00 00  31 03 03 00 00 00 00 00  |....5...1.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 00 2f 00 00  |...DOWNGRD.../..|
-00000030  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
-00000040  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
-00000050  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
-00000060  09 2a 86 48 86 f7 0d 01  01 0b 05 00 30 1f 31 0b  |.*.H........0.1.|
-00000070  30 09 06 03 55 04 0a 13  02 47 6f 31 10 30 0e 06  |0...U....Go1.0..|
-00000080  03 55 04 03 13 07 47 6f  20 52 6f 6f 74 30 1e 17  |.U....Go Root0..|
-00000090  0d 31 36 30 31 30 31 30  30 30 30 30 30 5a 17 0d  |.160101000000Z..|
-000000a0  32 35 30 31 30 31 30 30  30 30 30 30 5a 30 1a 31  |250101000000Z0.1|
-000000b0  0b 30 09 06 03 55 04 0a  13 02 47 6f 31 0b 30 09  |.0...U....Go1.0.|
-000000c0  06 03 55 04 03 13 02 47  6f 30 81 9f 30 0d 06 09  |..U....Go0..0...|
-000000d0  2a 86 48 86 f7 0d 01 01  01 05 00 03 81 8d 00 30  |*.H............0|
-000000e0  81 89 02 81 81 00 db 46  7d 93 2e 12 27 06 48 bc  |.......F}...'.H.|
-000000f0  06 28 21 ab 7e c4 b6 a2  5d fe 1e 52 45 88 7a 36  |.(!.~...]..RE.z6|
-00000100  47 a5 08 0d 92 42 5b c2  81 c0 be 97 79 98 40 fb  |G....B[.....y.@.|
-00000110  4f 6d 14 fd 2b 13 8b c2  a5 2e 67 d8 d4 09 9e d6  |Om..+.....g.....|
-00000120  22 38 b7 4a 0b 74 73 2b  c2 34 f1 d1 93 e5 96 d9  |"8.J.ts+.4......|
-00000130  74 7b f3 58 9f 6c 61 3c  c0 b0 41 d4 d9 2b 2b 24  |t{.X.la<..A..++$|
-00000140  23 77 5b 1c 3b bd 75 5d  ce 20 54 cf a1 63 87 1d  |#w[.;.u]. T..c..|
-00000150  1e 24 c4 f3 1d 1a 50 8b  aa b6 14 43 ed 97 a7 75  |.$....P....C...u|
-00000160  62 f4 14 c8 52 d7 02 03  01 00 01 a3 81 93 30 81  |b...R.........0.|
-00000170  90 30 0e 06 03 55 1d 0f  01 01 ff 04 04 03 02 05  |.0...U..........|
-00000180  a0 30 1d 06 03 55 1d 25  04 16 30 14 06 08 2b 06  |.0...U.%..0...+.|
-00000190  01 05 05 07 03 01 06 08  2b 06 01 05 05 07 03 02  |........+.......|
-000001a0  30 0c 06 03 55 1d 13 01  01 ff 04 02 30 00 30 19  |0...U.......0.0.|
-000001b0  06 03 55 1d 0e 04 12 04  10 9f 91 16 1f 43 43 3e  |..U..........CC>|
-000001c0  49 a6 de 6d b6 80 d7 9f  60 30 1b 06 03 55 1d 23  |I..m....`0...U.#|
-000001d0  04 14 30 12 80 10 48 13  49 4d 13 7e 16 31 bb a3  |..0...H.IM.~.1..|
-000001e0  01 d5 ac ab 6e 7b 30 19  06 03 55 1d 11 04 12 30  |....n{0...U....0|
-000001f0  10 82 0e 65 78 61 6d 70  6c 65 2e 67 6f 6c 61 6e  |...example.golan|
-00000200  67 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |g0...*.H........|
-00000210  03 81 81 00 9d 30 cc 40  2b 5b 50 a0 61 cb ba e5  |.....0.@+[P.a...|
-00000220  53 58 e1 ed 83 28 a9 58  1a a9 38 a4 95 a1 ac 31  |SX...(.X..8....1|
-00000230  5a 1a 84 66 3d 43 d3 2d  d9 0b f2 97 df d3 20 64  |Z..f=C.-...... d|
-00000240  38 92 24 3a 00 bc cf 9c  7d b7 40 20 01 5f aa d3  |8.$:....}.@ ._..|
-00000250  16 61 09 a2 76 fd 13 c3  cc e1 0c 5c ee b1 87 82  |.a..v......\....|
-00000260  f1 6c 04 ed 73 bb b3 43  77 8d 0c 1c f1 0f a1 d8  |.l..s..Cw.......|
-00000270  40 83 61 c9 4c 72 2b 9d  ae db 46 06 06 4d f4 c1  |@.a.Lr+...F..M..|
-00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
-00000290  3b e9 fa e7 16 03 03 00  23 0d 00 00 1f 02 01 40  |;.......#......@|
-000002a0  00 18 08 04 04 03 08 07  08 05 08 06 04 01 05 01  |................|
-000002b0  06 01 05 03 06 03 02 01  02 03 00 00 16 03 03 00  |................|
-000002c0  04 0e 00 00 00                                    |.....|
+00000030  09 ff 01 00 01 00 00 17  00 00 16 03 03 02 59 0b  |..............Y.|
+00000040  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
+00000050  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
+00000060  a6 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |.0...*.H........|
+00000070  30 1f 31 0b 30 09 06 03  55 04 0a 13 02 47 6f 31  |0.1.0...U....Go1|
+00000080  10 30 0e 06 03 55 04 03  13 07 47 6f 20 52 6f 6f  |.0...U....Go Roo|
+00000090  74 30 1e 17 0d 31 36 30  31 30 31 30 30 30 30 30  |t0...16010100000|
+000000a0  30 5a 17 0d 32 35 30 31  30 31 30 30 30 30 30 30  |0Z..250101000000|
+000000b0  5a 30 1a 31 0b 30 09 06  03 55 04 0a 13 02 47 6f  |Z0.1.0...U....Go|
+000000c0  31 0b 30 09 06 03 55 04  03 13 02 47 6f 30 81 9f  |1.0...U....Go0..|
+000000d0  30 0d 06 09 2a 86 48 86  f7 0d 01 01 01 05 00 03  |0...*.H.........|
+000000e0  81 8d 00 30 81 89 02 81  81 00 db 46 7d 93 2e 12  |...0.......F}...|
+000000f0  27 06 48 bc 06 28 21 ab  7e c4 b6 a2 5d fe 1e 52  |'.H..(!.~...]..R|
+00000100  45 88 7a 36 47 a5 08 0d  92 42 5b c2 81 c0 be 97  |E.z6G....B[.....|
+00000110  79 98 40 fb 4f 6d 14 fd  2b 13 8b c2 a5 2e 67 d8  |y.@.Om..+.....g.|
+00000120  d4 09 9e d6 22 38 b7 4a  0b 74 73 2b c2 34 f1 d1  |...."8.J.ts+.4..|
+00000130  93 e5 96 d9 74 7b f3 58  9f 6c 61 3c c0 b0 41 d4  |....t{.X.la<..A.|
+00000140  d9 2b 2b 24 23 77 5b 1c  3b bd 75 5d ce 20 54 cf  |.++$#w[.;.u]. T.|
+00000150  a1 63 87 1d 1e 24 c4 f3  1d 1a 50 8b aa b6 14 43  |.c...$....P....C|
+00000160  ed 97 a7 75 62 f4 14 c8  52 d7 02 03 01 00 01 a3  |...ub...R.......|
+00000170  81 93 30 81 90 30 0e 06  03 55 1d 0f 01 01 ff 04  |..0..0...U......|
+00000180  04 03 02 05 a0 30 1d 06  03 55 1d 25 04 16 30 14  |.....0...U.%..0.|
+00000190  06 08 2b 06 01 05 05 07  03 01 06 08 2b 06 01 05  |..+.........+...|
+000001a0  05 07 03 02 30 0c 06 03  55 1d 13 01 01 ff 04 02  |....0...U.......|
+000001b0  30 00 30 19 06 03 55 1d  0e 04 12 04 10 9f 91 16  |0.0...U.........|
+000001c0  1f 43 43 3e 49 a6 de 6d  b6 80 d7 9f 60 30 1b 06  |.CC>I..m....`0..|
+000001d0  03 55 1d 23 04 14 30 12  80 10 48 13 49 4d 13 7e  |.U.#..0...H.IM.~|
+000001e0  16 31 bb a3 01 d5 ac ab  6e 7b 30 19 06 03 55 1d  |.1......n{0...U.|
+000001f0  11 04 12 30 10 82 0e 65  78 61 6d 70 6c 65 2e 67  |...0...example.g|
+00000200  6f 6c 61 6e 67 30 0d 06  09 2a 86 48 86 f7 0d 01  |olang0...*.H....|
+00000210  01 0b 05 00 03 81 81 00  9d 30 cc 40 2b 5b 50 a0  |.........0.@+[P.|
+00000220  61 cb ba e5 53 58 e1 ed  83 28 a9 58 1a a9 38 a4  |a...SX...(.X..8.|
+00000230  95 a1 ac 31 5a 1a 84 66  3d 43 d3 2d d9 0b f2 97  |...1Z..f=C.-....|
+00000240  df d3 20 64 38 92 24 3a  00 bc cf 9c 7d b7 40 20  |.. d8.$:....}.@ |
+00000250  01 5f aa d3 16 61 09 a2  76 fd 13 c3 cc e1 0c 5c  |._...a..v......\|
+00000260  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
+00000270  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
+00000280  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
+00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 23 0d 00 00  |.\!.;.......#...|
+000002a0  1f 02 01 40 00 18 08 04  04 03 08 07 08 05 08 06  |...@............|
+000002b0  04 01 05 01 06 01 05 03  06 03 02 01 02 03 00 00  |................|
+000002c0  16 03 03 00 04 0e 00 00  00                       |.........|
 >>> Flow 3 (client to server)
 00000000  16 03 03 00 07 0b 00 00  03 00 00 00 16 03 03 00  |................|
-00000010  86 10 00 00 82 00 80 a9  b6 12 e2 84 71 62 7a 20  |............qbz |
-00000020  63 80 99 c6 ee f7 61 f9  74 d6 0b ab 31 74 69 ca  |c.....a.t...1ti.|
-00000030  94 20 9e 1b 0e 52 45 c4  f4 b3 cb fb a4 07 61 6f  |. ...RE.......ao|
-00000040  a1 5a 84 4c 4f f6 4a e4  bc c5 c2 b0 ee 8a 30 5b  |.Z.LO.J.......0[|
-00000050  10 e0 ed d3 4c b7 32 8c  ed 3f 89 a7 a7 95 60 86  |....L.2..?....`.|
-00000060  97 1a ae ab 2f 5c e6 6d  1b c3 35 bd f5 c1 f0 1a  |..../\.m..5.....|
-00000070  d4 70 e5 00 f2 d4 d1 20  6a 82 db e7 52 ca 88 e5  |.p..... j...R...|
-00000080  2d cc 79 0c f6 09 84 65  f0 30 41 67 10 0a 48 d1  |-.y....e.0Ag..H.|
-00000090  09 3e 56 7a aa 57 bc 14  03 03 00 01 01 16 03 03  |.>Vz.W..........|
-000000a0  00 40 e6 0a 91 5f 30 f8  52 75 94 8e ab 82 ec 1d  |.@..._0.Ru......|
-000000b0  b7 a1 1c 18 1a aa 1c f8  73 93 0e 20 ad 68 a7 65  |........s.. .h.e|
-000000c0  86 c9 f5 90 f9 b2 fd d1  32 94 52 6e 82 9b b9 45  |........2.Rn...E|
-000000d0  97 52 4b 1e c2 31 a6 2e  c8 b3 1a 62 22 83 8f df  |.RK..1.....b"...|
-000000e0  d7 06                                             |..|
+00000010  86 10 00 00 82 00 80 2e  37 44 fb d7 1d 2f 3d a5  |........7D.../=.|
+00000020  1b 43 cf f4 1c cf 9d 95  fa be 9f 9d 96 8a 27 5d  |.C............']|
+00000030  7b be 19 10 bd 5e 9a 3e  49 49 d2 af 85 07 70 f8  |{....^.>II....p.|
+00000040  c8 4f 69 02 ff 4e 9d ee  f4 0d 4d 54 a1 aa 61 a3  |.Oi..N....MT..a.|
+00000050  e0 cc db a7 2c 46 80 6e  eb 10 fb cd 2e 3b c5 50  |....,F.n.....;.P|
+00000060  2b a5 d9 a0 bf 01 d2 f8  d8 51 2b ad 40 6f c6 6f  |+........Q+.@o.o|
+00000070  0e 30 53 27 73 89 b7 1b  c1 28 ff ff 18 4c fa 6f  |.0S's....(...L.o|
+00000080  fa 5f 16 b3 38 36 9f f4  07 74 ca bb bb c2 3f aa  |._..86...t....?.|
+00000090  0d e7 42 24 fb f8 4c 14  03 03 00 01 01 16 03 03  |..B$..L.........|
+000000a0  00 40 19 02 9e 3a ce b9  38 40 ce d6 3b 87 b2 f6  |.@...:..8@..;...|
+000000b0  1b 7d ee 76 62 f8 6e 04  80 8f cb 1b f7 1e 1d a6  |.}.vb.n.........|
+000000c0  50 8a 59 b1 ad 7d c5 9d  2f 2d 14 56 2e e5 3b b3  |P.Y..}../-.V..;.|
+000000d0  db da 7e 37 10 97 71 91  d3 7b 93 f6 64 a4 d7 8b  |..~7..q..{..d...|
+000000e0  d2 f0                                             |..|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 b0 2c 61 79 87  |............,ay.|
-00000020  59 d4 9e 4d e7 56 4a 34  ba 78 d5 06 98 a2 92 35  |Y..M.VJ4.x.....5|
-00000030  a1 fc 57 5a 6e d3 0f 44  08 1c a1 7b 3c d3 f1 86  |..WZn..D...{<...|
-00000040  a2 04 04 5e 1b 7c 00 4f  51 71 73 17 03 03 00 40  |...^.|.OQqs....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 46 c8 31 06 11  |...........F.1..|
+00000020  01 8e df b0 e7 cc 16 d3  97 2e a2 68 e7 a4 d1 0f  |...........h....|
+00000030  91 71 dd ba db 97 20 45  60 c2 47 c7 ee 56 c4 68  |.q.... E`.G..V.h|
+00000040  a4 b1 05 09 e2 68 4d 54  fa ff 01 17 03 03 00 40  |.....hMT.......@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  aa 5c 1a 9a 70 bc b3 fb  70 07 0b 24 cb 95 84 61  |.\..p...p..$...a|
-00000070  96 ed d8 97 2f d6 79 51  ed cd 67 44 e5 d4 a3 57  |..../.yQ..gD...W|
-00000080  95 f6 c8 31 a8 95 c2 07  a4 ce 1c fc 4a dc 93 d9  |...1........J...|
+00000060  79 bf ad 63 e3 11 2b d0  41 0e 24 85 92 c4 9b b5  |y..c..+.A.$.....|
+00000070  b2 d3 2e fc aa 46 84 85  a7 37 90 fc f0 2b 5a 7e  |.....F...7...+Z~|
+00000080  28 9f 2e 57 1d 8f c3 ca  eb 40 32 79 af 4b b8 28  |(..W.....@2y.K.(|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 ae dd c4  f4 04 d3 b1 1a 8a 56 f7  |..............V.|
-000000b0  73 c9 d5 aa 6c 59 d7 66  77 34 64 2d 19 79 13 80  |s...lY.fw4d-.y..|
-000000c0  98 60 6d f4 d9                                    |.`m..|
+000000a0  00 00 00 00 00 8b 6c 27  b8 ff f9 ea ca 68 75 54  |......l'.....huT|
+000000b0  bf bf a7 f4 b1 58 a5 b3  31 01 4d c7 85 58 31 d4  |.....X..1.M..X1.|
+000000c0  e7 da 7e 77 68                                    |..~wh|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Server-TLSv12-ECDHE-ECDSA-AES
index 62f4311d57..697b8102dd 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Server-TLSv12-ECDHE-ECDSA-AES
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 20 34 f0 4b 7a  |........... 4.Kz|
-00000010  4f ed 31 de 38 ef 33 2e  69 7d 74 35 e5 02 b9 bb  |O.1.8.3.i}t5....|
-00000020  bd 1a 5c 3a f2 57 f1 23  62 66 52 00 00 04 c0 0a  |..\:.W.#bfR.....|
+00000000  16 03 01 00 85 01 00 00  81 03 03 83 21 a6 e4 ea  |............!...|
+00000010  e9 7b 3a 7c 72 28 ee 68  c5 c7 fa f1 98 ed 4a be  |.{:|r(.h......J.|
+00000020  b8 42 13 fb d3 ab 63 16  d2 74 c8 00 00 04 c0 0a  |.B....c..t......|
 00000030  00 ff 01 00 00 54 00 0b  00 04 03 00 01 02 00 0a  |.....T..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000050  00 00 00 17 00 00 00 0d  00 30 00 2e 04 03 05 03  |.........0......|
@@ -9,76 +9,76 @@
 00000070  08 06 04 01 05 01 06 01  03 03 02 03 03 01 02 01  |................|
 00000080  03 02 02 02 04 02 05 02  06 02                    |..........|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 37 02 00 00  33 03 03 00 00 00 00 00  |....7...3.......|
+00000000  16 03 03 00 3b 02 00 00  37 03 03 00 00 00 00 00  |....;...7.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 c0 0a 00 00  |...DOWNGRD......|
-00000030  0b ff 01 00 01 00 00 0b  00 02 01 00 16 03 03 02  |................|
-00000040  0e 0b 00 02 0a 00 02 07  00 02 04 30 82 02 00 30  |...........0...0|
-00000050  82 01 62 02 09 00 b8 bf  2d 47 a0 d2 eb f4 30 09  |..b.....-G....0.|
-00000060  06 07 2a 86 48 ce 3d 04  01 30 45 31 0b 30 09 06  |..*.H.=..0E1.0..|
-00000070  03 55 04 06 13 02 41 55  31 13 30 11 06 03 55 04  |.U....AU1.0...U.|
-00000080  08 13 0a 53 6f 6d 65 2d  53 74 61 74 65 31 21 30  |...Some-State1!0|
-00000090  1f 06 03 55 04 0a 13 18  49 6e 74 65 72 6e 65 74  |...U....Internet|
-000000a0  20 57 69 64 67 69 74 73  20 50 74 79 20 4c 74 64  | Widgits Pty Ltd|
-000000b0  30 1e 17 0d 31 32 31 31  32 32 31 35 30 36 33 32  |0...121122150632|
-000000c0  5a 17 0d 32 32 31 31 32  30 31 35 30 36 33 32 5a  |Z..221120150632Z|
-000000d0  30 45 31 0b 30 09 06 03  55 04 06 13 02 41 55 31  |0E1.0...U....AU1|
-000000e0  13 30 11 06 03 55 04 08  13 0a 53 6f 6d 65 2d 53  |.0...U....Some-S|
-000000f0  74 61 74 65 31 21 30 1f  06 03 55 04 0a 13 18 49  |tate1!0...U....I|
-00000100  6e 74 65 72 6e 65 74 20  57 69 64 67 69 74 73 20  |nternet Widgits |
-00000110  50 74 79 20 4c 74 64 30  81 9b 30 10 06 07 2a 86  |Pty Ltd0..0...*.|
-00000120  48 ce 3d 02 01 06 05 2b  81 04 00 23 03 81 86 00  |H.=....+...#....|
-00000130  04 00 c4 a1 ed be 98 f9  0b 48 73 36 7e c3 16 56  |.........Hs6~..V|
-00000140  11 22 f2 3d 53 c3 3b 4d  21 3d cd 6b 75 e6 f6 b0  |.".=S.;M!=.ku...|
-00000150  dc 9a df 26 c1 bc b2 87  f0 72 32 7c b3 64 2f 1c  |...&.....r2|.d/.|
-00000160  90 bc ea 68 23 10 7e fe  e3 25 c0 48 3a 69 e0 28  |...h#.~..%.H:i.(|
-00000170  6d d3 37 00 ef 04 62 dd  0d a0 9c 70 62 83 d8 81  |m.7...b....pb...|
-00000180  d3 64 31 aa 9e 97 31 bd  96 b0 68 c0 9b 23 de 76  |.d1...1...h..#.v|
-00000190  64 3f 1a 5c 7f e9 12 0e  58 58 b6 5f 70 dd 9b d8  |d?.\....XX._p...|
-000001a0  ea d5 d7 f5 d5 cc b9 b6  9f 30 66 5b 66 9a 20 e2  |.........0f[f. .|
-000001b0  27 e5 bf fe 3b 30 09 06  07 2a 86 48 ce 3d 04 01  |'...;0...*.H.=..|
-000001c0  03 81 8c 00 30 81 88 02  42 01 88 a2 4f eb e2 45  |....0...B...O..E|
-000001d0  c5 48 7d 1b ac f5 ed 98  9d ae 47 70 c0 5e 1b b6  |.H}.......Gp.^..|
-000001e0  2f bd f1 b6 4d b7 61 40  d3 11 a2 ce ee 0b 7e 92  |/...M.a@......~.|
-000001f0  7e ff 76 9d c3 3b 7e a5  3f ce fa 10 e2 59 ec 47  |~.v..;~.?....Y.G|
-00000200  2d 7c ac da 4e 97 0e 15  a0 6f d0 02 42 01 4d fc  |-|..N....o..B.M.|
-00000210  be 67 13 9c 2d 05 0e bd  3f a3 8c 25 c1 33 13 83  |.g..-...?..%.3..|
-00000220  0d 94 06 bb d4 37 7a f6  ec 7a c9 86 2e dd d7 11  |.....7z..z......|
-00000230  69 7f 85 7c 56 de fb 31  78 2b e4 c7 78 0d ae cb  |i..|V..1x+..x...|
-00000240  be 9e 4e 36 24 31 7b 6a  0f 39 95 12 07 8f 2a 16  |..N6$1{j.9....*.|
-00000250  03 03 00 b6 0c 00 00 b2  03 00 1d 20 2f e5 7d a3  |........... /.}.|
-00000260  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
-00000270  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 04 03 00 8a  |......._X.;t....|
-00000280  30 81 87 02 41 21 2b cf  6b fc 8a 13 b6 21 8a 46  |0...A!+.k....!.F|
-00000290  fc 7c 56 7e 28 22 4d b2  c2 c8 45 92 cc 99 6a 3c  |.|V~("M...E...j<|
-000002a0  48 0f 16 95 6c 43 3d ea  bd ac 25 88 a3 35 0c 14  |H...lC=...%..5..|
-000002b0  c6 43 46 16 ec b5 57 76  86 1c 5a d1 52 44 3b 8c  |.CF...Wv..Z.RD;.|
-000002c0  e5 b3 46 3b 47 d8 02 42  01 ad a2 c3 4c 69 35 13  |..F;G..B....Li5.|
-000002d0  d7 66 37 63 c9 43 50 68  f6 ff 7f 7d be 7e 8d 89  |.f7c.CPh...}.~..|
-000002e0  db 57 3e 0f 51 c8 49 9b  3a e2 87 65 dd 28 21 9a  |.W>.Q.I.:..e.(!.|
-000002f0  c3 36 28 a4 e8 25 7b ae  8e 45 35 22 8f 2d 97 27  |.6(..%{..E5".-.'|
-00000300  fe b8 99 a9 c1 5f d8 8b  70 d3 16 03 03 00 04 0e  |....._..p.......|
-00000310  00 00 00                                          |...|
+00000030  0f ff 01 00 01 00 00 17  00 00 00 0b 00 02 01 00  |................|
+00000040  16 03 03 02 0e 0b 00 02  0a 00 02 07 00 02 04 30  |...............0|
+00000050  82 02 00 30 82 01 62 02  09 00 b8 bf 2d 47 a0 d2  |...0..b.....-G..|
+00000060  eb f4 30 09 06 07 2a 86  48 ce 3d 04 01 30 45 31  |..0...*.H.=..0E1|
+00000070  0b 30 09 06 03 55 04 06  13 02 41 55 31 13 30 11  |.0...U....AU1.0.|
+00000080  06 03 55 04 08 13 0a 53  6f 6d 65 2d 53 74 61 74  |..U....Some-Stat|
+00000090  65 31 21 30 1f 06 03 55  04 0a 13 18 49 6e 74 65  |e1!0...U....Inte|
+000000a0  72 6e 65 74 20 57 69 64  67 69 74 73 20 50 74 79  |rnet Widgits Pty|
+000000b0  20 4c 74 64 30 1e 17 0d  31 32 31 31 32 32 31 35  | Ltd0...12112215|
+000000c0  30 36 33 32 5a 17 0d 32  32 31 31 32 30 31 35 30  |0632Z..221120150|
+000000d0  36 33 32 5a 30 45 31 0b  30 09 06 03 55 04 06 13  |632Z0E1.0...U...|
+000000e0  02 41 55 31 13 30 11 06  03 55 04 08 13 0a 53 6f  |.AU1.0...U....So|
+000000f0  6d 65 2d 53 74 61 74 65  31 21 30 1f 06 03 55 04  |me-State1!0...U.|
+00000100  0a 13 18 49 6e 74 65 72  6e 65 74 20 57 69 64 67  |...Internet Widg|
+00000110  69 74 73 20 50 74 79 20  4c 74 64 30 81 9b 30 10  |its Pty Ltd0..0.|
+00000120  06 07 2a 86 48 ce 3d 02  01 06 05 2b 81 04 00 23  |..*.H.=....+...#|
+00000130  03 81 86 00 04 00 c4 a1  ed be 98 f9 0b 48 73 36  |.............Hs6|
+00000140  7e c3 16 56 11 22 f2 3d  53 c3 3b 4d 21 3d cd 6b  |~..V.".=S.;M!=.k|
+00000150  75 e6 f6 b0 dc 9a df 26  c1 bc b2 87 f0 72 32 7c  |u......&.....r2||
+00000160  b3 64 2f 1c 90 bc ea 68  23 10 7e fe e3 25 c0 48  |.d/....h#.~..%.H|
+00000170  3a 69 e0 28 6d d3 37 00  ef 04 62 dd 0d a0 9c 70  |:i.(m.7...b....p|
+00000180  62 83 d8 81 d3 64 31 aa  9e 97 31 bd 96 b0 68 c0  |b....d1...1...h.|
+00000190  9b 23 de 76 64 3f 1a 5c  7f e9 12 0e 58 58 b6 5f  |.#.vd?.\....XX._|
+000001a0  70 dd 9b d8 ea d5 d7 f5  d5 cc b9 b6 9f 30 66 5b  |p............0f[|
+000001b0  66 9a 20 e2 27 e5 bf fe  3b 30 09 06 07 2a 86 48  |f. .'...;0...*.H|
+000001c0  ce 3d 04 01 03 81 8c 00  30 81 88 02 42 01 88 a2  |.=......0...B...|
+000001d0  4f eb e2 45 c5 48 7d 1b  ac f5 ed 98 9d ae 47 70  |O..E.H}.......Gp|
+000001e0  c0 5e 1b b6 2f bd f1 b6  4d b7 61 40 d3 11 a2 ce  |.^../...M.a@....|
+000001f0  ee 0b 7e 92 7e ff 76 9d  c3 3b 7e a5 3f ce fa 10  |..~.~.v..;~.?...|
+00000200  e2 59 ec 47 2d 7c ac da  4e 97 0e 15 a0 6f d0 02  |.Y.G-|..N....o..|
+00000210  42 01 4d fc be 67 13 9c  2d 05 0e bd 3f a3 8c 25  |B.M..g..-...?..%|
+00000220  c1 33 13 83 0d 94 06 bb  d4 37 7a f6 ec 7a c9 86  |.3.......7z..z..|
+00000230  2e dd d7 11 69 7f 85 7c  56 de fb 31 78 2b e4 c7  |....i..|V..1x+..|
+00000240  78 0d ae cb be 9e 4e 36  24 31 7b 6a 0f 39 95 12  |x.....N6$1{j.9..|
+00000250  07 8f 2a 16 03 03 00 b7  0c 00 00 b3 03 00 1d 20  |..*............ |
+00000260  2f e5 7d a3 47 cd 62 43  15 28 da ac 5f bb 29 07  |/.}.G.bC.(.._.).|
+00000270  30 ff f6 84 af c4 cf c2  ed 90 99 5f 58 cb 3b 74  |0.........._X.;t|
+00000280  04 03 00 8b 30 81 88 02  42 00 b9 39 44 59 12 77  |....0...B..9DY.w|
+00000290  8d e2 79 25 01 d1 6a 05  3d 53 ea f3 91 d6 c5 09  |..y%..j.=S......|
+000002a0  24 bd 0c ad 24 cc 1c a7  fb 03 eb 0a 0d f4 30 96  |$...$.........0.|
+000002b0  8d 28 a1 b3 64 ba 30 27  95 29 23 22 91 62 c3 1f  |.(..d.0'.)#".b..|
+000002c0  51 aa c8 be 17 85 31 8e  f5 40 3e 02 42 00 ee a1  |Q.....1..@>.B...|
+000002d0  64 14 a1 52 b3 e5 54 c9  24 53 94 5a 43 d8 4f 79  |d..R..T.$S.ZC.Oy|
+000002e0  69 4b a8 51 ee de b3 b0  f7 1a 57 a3 28 72 d2 13  |iK.Q......W.(r..|
+000002f0  a6 d3 17 0b c4 45 34 7f  10 3b 81 cb 0c 8d 51 b6  |.....E4..;....Q.|
+00000300  0b 86 21 d0 ee 1d 7e 73  6b ea 77 8c 66 dc 65 16  |..!...~sk.w.f.e.|
+00000310  03 03 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 c4 25 45 6f 39 18  |....%...! .%Eo9.|
-00000010  b1 f6 0a b3 f7 3e 98 ed  63 ae bd 74 12 91 0d 81  |.....>..c..t....|
-00000020  84 71 13 3c a7 cf a5 d2  24 5f 14 03 03 00 01 01  |.q.<....$_......|
-00000030  16 03 03 00 40 27 8d 44  74 7a ae 8a 4e 1c f9 1b  |....@'.Dtz..N...|
-00000040  05 23 c4 89 57 27 4c dc  db 4a ae aa 08 74 00 55  |.#..W'L..J...t.U|
-00000050  f9 4e 63 02 75 24 ca fb  30 78 cc 82 8a 69 be ab  |.Nc.u$..0x...i..|
-00000060  10 9d 25 2d a8 b6 bb 64  6e 32 68 4b 0a 32 06 74  |..%-...dn2hK.2.t|
-00000070  26 5e bc 68 25                                    |&^.h%|
+00000000  16 03 03 00 25 10 00 00  21 20 ed 3e ba a7 43 53  |....%...! .>..CS|
+00000010  5e e4 60 aa 31 3f e1 69  60 32 25 3d fd 8b 32 da  |^.`.1?.i`2%=..2.|
+00000020  f2 c5 db c7 02 e6 4d d0  de 15 14 03 03 00 01 01  |......M.........|
+00000030  16 03 03 00 40 ee 28 f2  27 82 24 9d 17 d1 48 7a  |....@.(.'.$...Hz|
+00000040  74 2d dd 16 18 b7 70 97  2f 2b 91 47 eb c2 1d ae  |t-....p./+.G....|
+00000050  3f 48 52 cd ff e7 9e 0b  35 ad 1f 60 5e 07 b1 5e  |?HR.....5..`^..^|
+00000060  1c ba 6a 85 bb 6b 30 94  41 8a 59 81 cf 37 5f 26  |..j..k0.A.Y..7_&|
+00000070  b1 52 36 5f df                                    |.R6_.|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 b0 cf 70 b3 00  |.............p..|
-00000020  89 e2 77 af 87 08 f5 2f  2c c8 75 ce 8a ed 30 d8  |..w..../,.u...0.|
-00000030  f7 44 f3 9d 8b 4c 42 7a  52 d0 c8 37 9b 45 46 1c  |.D...LBzR..7.EF.|
-00000040  56 3b ee 52 5d c4 72 04  13 49 aa 17 03 03 00 40  |V;.R].r..I.....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 f5 05 5a a6 22  |.............Z."|
+00000020  90 4e 8d d9 f1 55 c4 78  f2 ec 9d 97 cd fe af ae  |.N...U.x........|
+00000030  b7 62 00 67 2e b2 d9 1e  0c a3 c8 6a bf d2 3c 42  |.b.g.......j..<B|
+00000040  c4 0a d1 08 36 64 8e bd  0a 2f a2 17 03 03 00 40  |....6d.../.....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  ce c4 34 c2 d8 4e f5 db  d1 ff 6d 64 ae 39 6d 78  |..4..N....md.9mx|
-00000070  3c c4 57 32 d1 af 35 d3  b4 79 3c b4 bd a1 21 7b  |<.W2..5..y<...!{|
-00000080  1f ef b8 3c 97 37 18 e5  10 62 e8 3d 7d 12 f5 db  |...<.7...b.=}...|
+00000060  ef 16 5e cb e7 c4 2d a8  76 77 da 18 91 bd cb 78  |..^...-.vw.....x|
+00000070  76 c5 5d 70 e5 ba 57 2a  1f 2b 11 3f 18 18 e6 1b  |v.]p..W*.+.?....|
+00000080  36 78 c9 f1 5e 71 f1 71  f1 01 31 e6 37 fa 76 92  |6x..^q.q..1.7.v.|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 81 75 ae  71 18 61 61 ae 35 ce c8  |......u.q.aa.5..|
-000000b0  43 57 52 c9 68 5e 0d 63  c4 0e 7d 36 90 b2 f6 f6  |CWR.h^.c..}6....|
-000000c0  ea 72 3c d9 41                                    |.r<.A|
+000000a0  00 00 00 00 00 13 3e 42  a5 61 84 ae 49 8b b9 91  |......>B.a..I...|
+000000b0  c2 a3 76 74 1e 4f 53 0a  fc 71 de 0d d2 44 c8 ac  |..vt.OS..q...D..|
+000000c0  2e 09 27 e6 ad                                    |..'..|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-Ed25519 b/src/crypto/tls/testdata/Server-TLSv12-Ed25519
index dd34592811..42bb15412c 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-Ed25519
+++ b/src/crypto/tls/testdata/Server-TLSv12-Ed25519
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 85 01 00 00  81 03 03 f0 8d 1b 90 67  |...............g|
-00000010  3b 23 46 ac f7 79 f2 f9  e8 90 98 b3 52 b2 55 2a  |;#F..y......R.U*|
-00000020  fb 0f 1e dd 4f b3 75 4b  9b 88 0e 00 00 04 cc a9  |....O.uK........|
+00000000  16 03 01 00 85 01 00 00  81 03 03 f3 04 e3 e7 a2  |................|
+00000010  39 79 b2 9e 94 35 cf c3  a8 54 77 ab 96 72 b6 40  |9y...5...Tw..r.@|
+00000020  de 59 6b cf d4 f5 f4 2c  fd 7d f6 00 00 04 cc a9  |.Yk....,.}......|
 00000030  00 ff 01 00 00 54 00 0b  00 04 03 00 01 02 00 0a  |.....T..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000050  00 00 00 17 00 00 00 0d  00 30 00 2e 04 03 05 03  |.........0......|
@@ -9,50 +9,50 @@
 00000070  08 06 04 01 05 01 06 01  03 03 02 03 03 01 02 01  |................|
 00000080  03 02 02 02 04 02 05 02  06 02                    |..........|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 37 02 00 00  33 03 03 00 00 00 00 00  |....7...3.......|
+00000000  16 03 03 00 3b 02 00 00  37 03 03 00 00 00 00 00  |....;...7.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 cc a9 00 00  |...DOWNGRD......|
-00000030  0b ff 01 00 01 00 00 0b  00 02 01 00 16 03 03 01  |................|
-00000040  3c 0b 00 01 38 00 01 35  00 01 32 30 82 01 2e 30  |<...8..5..20...0|
-00000050  81 e1 a0 03 02 01 02 02  10 0f 43 1c 42 57 93 94  |..........C.BW..|
-00000060  1d e9 87 e4 f1 ad 15 00  5d 30 05 06 03 2b 65 70  |........]0...+ep|
-00000070  30 12 31 10 30 0e 06 03  55 04 0a 13 07 41 63 6d  |0.1.0...U....Acm|
-00000080  65 20 43 6f 30 1e 17 0d  31 39 30 35 31 36 32 31  |e Co0...19051621|
-00000090  33 38 30 31 5a 17 0d 32  30 30 35 31 35 32 31 33  |3801Z..200515213|
-000000a0  38 30 31 5a 30 12 31 10  30 0e 06 03 55 04 0a 13  |801Z0.1.0...U...|
-000000b0  07 41 63 6d 65 20 43 6f  30 2a 30 05 06 03 2b 65  |.Acme Co0*0...+e|
-000000c0  70 03 21 00 3f e2 15 2e  e6 e3 ef 3f 4e 85 4a 75  |p.!.?......?N.Ju|
-000000d0  77 a3 64 9e ed e0 bf 84  2c cc 92 26 8f fa 6f 34  |w.d.....,..&..o4|
-000000e0  83 aa ec 8f a3 4d 30 4b  30 0e 06 03 55 1d 0f 01  |.....M0K0...U...|
-000000f0  01 ff 04 04 03 02 05 a0  30 13 06 03 55 1d 25 04  |........0...U.%.|
-00000100  0c 30 0a 06 08 2b 06 01  05 05 07 03 01 30 0c 06  |.0...+.......0..|
-00000110  03 55 1d 13 01 01 ff 04  02 30 00 30 16 06 03 55  |.U.......0.0...U|
-00000120  1d 11 04 0f 30 0d 82 0b  65 78 61 6d 70 6c 65 2e  |....0...example.|
-00000130  63 6f 6d 30 05 06 03 2b  65 70 03 41 00 63 44 ed  |com0...+ep.A.cD.|
-00000140  9c c4 be 53 24 53 9f d2  10 8d 9f e8 21 08 90 95  |...S$S......!...|
-00000150  39 e5 0d c1 55 ff 2c 16  b7 1d fc ab 7d 4d d4 e0  |9...U.,.....}M..|
-00000160  93 13 d0 a9 42 e0 b6 6b  fe 5d 67 48 d7 9f 50 bc  |....B..k.]gH..P.|
-00000170  6c cd 4b 03 83 7c f2 08  58 cd ac cf 0c 16 03 03  |l.K..|..X.......|
-00000180  00 6c 0c 00 00 68 03 00  1d 20 2f e5 7d a3 47 cd  |.l...h... /.}.G.|
-00000190  62 43 15 28 da ac 5f bb  29 07 30 ff f6 84 af c4  |bC.(.._.).0.....|
-000001a0  cf c2 ed 90 99 5f 58 cb  3b 74 08 07 00 40 1f 56  |....._X.;t...@.V|
-000001b0  21 8a 44 04 69 65 ee f8  93 52 4c f0 49 42 57 4c  |!.D.ie...RL.IBWL|
-000001c0  5b f5 1a ef 43 ad 39 93  03 a3 64 84 da e5 82 32  |[...C.9...d....2|
-000001d0  fc 77 12 61 f3 f4 2c d8  61 9e 86 01 1f c0 a0 98  |.w.a..,.a.......|
-000001e0  94 a3 7f 15 75 c8 e6 2f  20 bd af 7c be 0e 16 03  |....u../ ..|....|
-000001f0  03 00 04 0e 00 00 00                              |.......|
+00000030  0f ff 01 00 01 00 00 17  00 00 00 0b 00 02 01 00  |................|
+00000040  16 03 03 01 3c 0b 00 01  38 00 01 35 00 01 32 30  |....<...8..5..20|
+00000050  82 01 2e 30 81 e1 a0 03  02 01 02 02 10 0f 43 1c  |...0..........C.|
+00000060  42 57 93 94 1d e9 87 e4  f1 ad 15 00 5d 30 05 06  |BW..........]0..|
+00000070  03 2b 65 70 30 12 31 10  30 0e 06 03 55 04 0a 13  |.+ep0.1.0...U...|
+00000080  07 41 63 6d 65 20 43 6f  30 1e 17 0d 31 39 30 35  |.Acme Co0...1905|
+00000090  31 36 32 31 33 38 30 31  5a 17 0d 32 30 30 35 31  |16213801Z..20051|
+000000a0  35 32 31 33 38 30 31 5a  30 12 31 10 30 0e 06 03  |5213801Z0.1.0...|
+000000b0  55 04 0a 13 07 41 63 6d  65 20 43 6f 30 2a 30 05  |U....Acme Co0*0.|
+000000c0  06 03 2b 65 70 03 21 00  3f e2 15 2e e6 e3 ef 3f  |..+ep.!.?......?|
+000000d0  4e 85 4a 75 77 a3 64 9e  ed e0 bf 84 2c cc 92 26  |N.Juw.d.....,..&|
+000000e0  8f fa 6f 34 83 aa ec 8f  a3 4d 30 4b 30 0e 06 03  |..o4.....M0K0...|
+000000f0  55 1d 0f 01 01 ff 04 04  03 02 05 a0 30 13 06 03  |U...........0...|
+00000100  55 1d 25 04 0c 30 0a 06  08 2b 06 01 05 05 07 03  |U.%..0...+......|
+00000110  01 30 0c 06 03 55 1d 13  01 01 ff 04 02 30 00 30  |.0...U.......0.0|
+00000120  16 06 03 55 1d 11 04 0f  30 0d 82 0b 65 78 61 6d  |...U....0...exam|
+00000130  70 6c 65 2e 63 6f 6d 30  05 06 03 2b 65 70 03 41  |ple.com0...+ep.A|
+00000140  00 63 44 ed 9c c4 be 53  24 53 9f d2 10 8d 9f e8  |.cD....S$S......|
+00000150  21 08 90 95 39 e5 0d c1  55 ff 2c 16 b7 1d fc ab  |!...9...U.,.....|
+00000160  7d 4d d4 e0 93 13 d0 a9  42 e0 b6 6b fe 5d 67 48  |}M......B..k.]gH|
+00000170  d7 9f 50 bc 6c cd 4b 03  83 7c f2 08 58 cd ac cf  |..P.l.K..|..X...|
+00000180  0c 16 03 03 00 6c 0c 00  00 68 03 00 1d 20 2f e5  |.....l...h... /.|
+00000190  7d a3 47 cd 62 43 15 28  da ac 5f bb 29 07 30 ff  |}.G.bC.(.._.).0.|
+000001a0  f6 84 af c4 cf c2 ed 90  99 5f 58 cb 3b 74 08 07  |........._X.;t..|
+000001b0  00 40 a2 12 66 be 81 b1  24 93 f2 e1 60 9f c4 13  |.@..f...$...`...|
+000001c0  04 3f 39 77 8f fe e4 33  5b f7 9d 84 f5 0f 96 aa  |.?9w...3[.......|
+000001d0  a0 d6 9d da ae b2 eb 76  64 02 82 58 d4 bc 5a 44  |.......vd..X..ZD|
+000001e0  b9 5a f5 33 57 fa a6 9c  d5 05 84 9a 19 0b 65 37  |.Z.3W.........e7|
+000001f0  bc 05 16 03 03 00 04 0e  00 00 00                 |...........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 26 b0 6c 90 e7 71  |....%...! &.l..q|
-00000010  23 78 4b a1 a1 32 7c 28  e9 df 7e 98 e9 78 be 8d  |#xK..2|(..~..x..|
-00000020  0d ec fc 30 82 99 16 f0  9f 20 14 03 03 00 01 01  |...0..... ......|
-00000030  16 03 03 00 20 e9 81 b0  ea b3 f3 21 40 9a 3b 3e  |.... ......!@.;>|
-00000040  71 a7 13 f5 3a 8a cd 86  34 8b 7e 41 b5 2a 1b 03  |q...:...4.~A.*..|
-00000050  29 77 b3 b2 da                                    |)w...|
+00000000  16 03 03 00 25 10 00 00  21 20 95 58 05 04 03 27  |....%...! .X...'|
+00000010  5e 14 d4 41 5a 3b eb d3  13 ad d4 16 fb 43 bf d6  |^..AZ;.......C..|
+00000020  7c 0a 1e a9 6c f9 72 84  47 1a 14 03 03 00 01 01  ||...l.r.G.......|
+00000030  16 03 03 00 20 06 f8 af  f4 38 35 de 88 74 d6 cc  |.... ....85..t..|
+00000040  a8 fa 2c ee a4 88 42 5c  4a aa 62 49 dc 32 da 15  |..,...B\J.bI.2..|
+00000050  1d 9c 5a b8 59                                    |..Z.Y|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 54 5a ff 09 7d  |.......... TZ..}|
-00000010  46 04 40 62 c5 63 71 85  c7 b4 6c 09 ee 15 71 6b  |F.@b.cq...l...qk|
-00000020  60 3b 00 3d 46 47 13 a5  f7 15 16 17 03 03 00 1d  |`;.=FG..........|
-00000030  13 8d 00 50 58 d0 2a 47  a8 d8 de 87 d4 3e ff ee  |...PX.*G.....>..|
-00000040  f1 4d 6b 25 94 6f 01 7b  70 ee 53 d9 be 15 03 03  |.Mk%.o.{p.S.....|
-00000050  00 12 13 ea 17 69 00 0e  2b ae 21 a9 5e 0a 41 2d  |.....i..+.!.^.A-|
-00000060  1b 73 f0 2d                                       |.s.-|
+00000000  14 03 03 00 01 01 16 03  03 00 20 3a 16 00 b6 c5  |.......... :....|
+00000010  76 1f 39 6b 17 2d 2f 34  83 c2 fd 1b 57 c4 0c 02  |v.9k.-/4....W...|
+00000020  18 16 6c d2 92 69 63 9b  32 33 e0 17 03 03 00 1d  |..l..ic.23......|
+00000030  04 97 df f0 2c 4b 3d 69  99 36 eb 0b 11 56 97 ab  |....,K=i.6...V..|
+00000040  98 5d d9 d4 6f 93 92 5c  cc f6 7e 77 40 15 03 03  |.]..o..\..~w@...|
+00000050  00 12 58 cf 6e 90 04 6b  ae 4f cf 6b 71 15 80 22  |..X.n..k.O.kq.."|
+00000060  f5 80 fa df                                       |....|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ExportKeyingMaterial b/src/crypto/tls/testdata/Server-TLSv12-ExportKeyingMaterial
index db88c0305c..82287bd796 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ExportKeyingMaterial
+++ b/src/crypto/tls/testdata/Server-TLSv12-ExportKeyingMaterial
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 89 01 00 00  85 03 03 04 7b 4a a9 93  |............{J..|
-00000010  39 1c 16 6b ab 54 e1 e1  39 6d ef 18 83 4b 73 a6  |9..k.T..9m...Ks.|
-00000020  0b ff a8 6c ba e7 e3 81  84 33 f5 00 00 04 c0 14  |...l.....3......|
+00000000  16 03 01 00 89 01 00 00  85 03 03 65 b1 b6 4f f9  |...........e..O.|
+00000010  88 37 84 e0 26 ed 5d 51  73 d0 ba 3e d9 bc e2 0c  |.7..&.]Qs..>....|
+00000020  58 70 75 a7 9f 1a 1d 40  84 0f 52 00 00 04 c0 14  |Xpu....@..R.....|
 00000030  00 ff 01 00 00 58 00 0b  00 04 03 00 01 02 00 0a  |.....X..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000050  00 00 00 16 00 00 00 17  00 00 00 0d 00 30 00 2e  |.............0..|
@@ -9,88 +9,88 @@
 00000070  08 04 08 05 08 06 04 01  05 01 06 01 03 03 02 03  |................|
 00000080  03 01 02 01 03 02 02 02  04 02 05 02 06 02        |..............|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 3b 02 00 00  37 03 03 00 00 00 00 00  |....;...7.......|
+00000000  16 03 03 00 3f 02 00 00  3b 03 03 00 00 00 00 00  |....?...;.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 c0 14 00 00  |...DOWNGRD......|
-00000030  0f 00 23 00 00 ff 01 00  01 00 00 0b 00 02 01 00  |..#.............|
-00000040  16 03 03 02 59 0b 00 02  55 00 02 52 00 02 4f 30  |....Y...U..R..O0|
-00000050  82 02 4b 30 82 01 b4 a0  03 02 01 02 02 09 00 e8  |..K0............|
-00000060  f0 9d 3f e2 5b ea a6 30  0d 06 09 2a 86 48 86 f7  |..?.[..0...*.H..|
-00000070  0d 01 01 0b 05 00 30 1f  31 0b 30 09 06 03 55 04  |......0.1.0...U.|
-00000080  0a 13 02 47 6f 31 10 30  0e 06 03 55 04 03 13 07  |...Go1.0...U....|
-00000090  47 6f 20 52 6f 6f 74 30  1e 17 0d 31 36 30 31 30  |Go Root0...16010|
-000000a0  31 30 30 30 30 30 30 5a  17 0d 32 35 30 31 30 31  |1000000Z..250101|
-000000b0  30 30 30 30 30 30 5a 30  1a 31 0b 30 09 06 03 55  |000000Z0.1.0...U|
-000000c0  04 0a 13 02 47 6f 31 0b  30 09 06 03 55 04 03 13  |....Go1.0...U...|
-000000d0  02 47 6f 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |.Go0..0...*.H...|
-000000e0  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
-000000f0  db 46 7d 93 2e 12 27 06  48 bc 06 28 21 ab 7e c4  |.F}...'.H..(!.~.|
-00000100  b6 a2 5d fe 1e 52 45 88  7a 36 47 a5 08 0d 92 42  |..]..RE.z6G....B|
-00000110  5b c2 81 c0 be 97 79 98  40 fb 4f 6d 14 fd 2b 13  |[.....y.@.Om..+.|
-00000120  8b c2 a5 2e 67 d8 d4 09  9e d6 22 38 b7 4a 0b 74  |....g....."8.J.t|
-00000130  73 2b c2 34 f1 d1 93 e5  96 d9 74 7b f3 58 9f 6c  |s+.4......t{.X.l|
-00000140  61 3c c0 b0 41 d4 d9 2b  2b 24 23 77 5b 1c 3b bd  |a<..A..++$#w[.;.|
-00000150  75 5d ce 20 54 cf a1 63  87 1d 1e 24 c4 f3 1d 1a  |u]. T..c...$....|
-00000160  50 8b aa b6 14 43 ed 97  a7 75 62 f4 14 c8 52 d7  |P....C...ub...R.|
-00000170  02 03 01 00 01 a3 81 93  30 81 90 30 0e 06 03 55  |........0..0...U|
-00000180  1d 0f 01 01 ff 04 04 03  02 05 a0 30 1d 06 03 55  |...........0...U|
-00000190  1d 25 04 16 30 14 06 08  2b 06 01 05 05 07 03 01  |.%..0...+.......|
-000001a0  06 08 2b 06 01 05 05 07  03 02 30 0c 06 03 55 1d  |..+.......0...U.|
-000001b0  13 01 01 ff 04 02 30 00  30 19 06 03 55 1d 0e 04  |......0.0...U...|
-000001c0  12 04 10 9f 91 16 1f 43  43 3e 49 a6 de 6d b6 80  |.......CC>I..m..|
-000001d0  d7 9f 60 30 1b 06 03 55  1d 23 04 14 30 12 80 10  |..`0...U.#..0...|
-000001e0  48 13 49 4d 13 7e 16 31  bb a3 01 d5 ac ab 6e 7b  |H.IM.~.1......n{|
-000001f0  30 19 06 03 55 1d 11 04  12 30 10 82 0e 65 78 61  |0...U....0...exa|
-00000200  6d 70 6c 65 2e 67 6f 6c  61 6e 67 30 0d 06 09 2a  |mple.golang0...*|
-00000210  86 48 86 f7 0d 01 01 0b  05 00 03 81 81 00 9d 30  |.H.............0|
-00000220  cc 40 2b 5b 50 a0 61 cb  ba e5 53 58 e1 ed 83 28  |.@+[P.a...SX...(|
-00000230  a9 58 1a a9 38 a4 95 a1  ac 31 5a 1a 84 66 3d 43  |.X..8....1Z..f=C|
-00000240  d3 2d d9 0b f2 97 df d3  20 64 38 92 24 3a 00 bc  |.-...... d8.$:..|
-00000250  cf 9c 7d b7 40 20 01 5f  aa d3 16 61 09 a2 76 fd  |..}.@ ._...a..v.|
-00000260  13 c3 cc e1 0c 5c ee b1  87 82 f1 6c 04 ed 73 bb  |.....\.....l..s.|
-00000270  b3 43 77 8d 0c 1c f1 0f  a1 d8 40 83 61 c9 4c 72  |.Cw.......@.a.Lr|
-00000280  2b 9d ae db 46 06 06 4d  f4 c1 b3 3e c0 d1 bd 42  |+...F..M...>...B|
-00000290  d4 db fe 3d 13 60 84 5c  21 d3 3b e9 fa e7 16 03  |...=.`.\!.;.....|
-000002a0  03 00 ac 0c 00 00 a8 03  00 1d 20 2f e5 7d a3 47  |.......... /.}.G|
-000002b0  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
-000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 08 04 00 80 77  |......_X.;t....w|
-000002d0  06 34 da cb a5 23 a2 c7  c4 c2 f2 91 ce 79 51 c7  |.4...#.......yQ.|
-000002e0  da d9 b8 15 4f b9 37 dc  fb fe 76 76 a2 13 b4 3e  |....O.7...vv...>|
-000002f0  8c 1f 6a f9 00 b0 19 4a  78 d2 f5 16 8a 21 19 58  |..j....Jx....!.X|
-00000300  da 7e b3 eb 6d d0 86 08  3b 98 d8 a0 f4 8f d6 ad  |.~..m...;.......|
-00000310  16 42 f9 67 e1 81 61 fc  6a 0b 21 0f 32 f3 0b 88  |.B.g..a.j.!.2...|
-00000320  24 e4 82 cd c2 a5 42 07  87 97 47 3b 3e a0 a8 77  |$.....B...G;>..w|
-00000330  8b 4d 3d 78 7e 99 48 c0  94 c5 97 30 32 6f c4 77  |.M=x~.H....02o.w|
-00000340  71 b8 0c dc c5 ad 9b 9a  6d 53 95 97 fd d8 5b 16  |q.......mS....[.|
-00000350  03 03 00 04 0e 00 00 00                           |........|
+00000030  13 00 23 00 00 ff 01 00  01 00 00 17 00 00 00 0b  |..#.............|
+00000040  00 02 01 00 16 03 03 02  59 0b 00 02 55 00 02 52  |........Y...U..R|
+00000050  00 02 4f 30 82 02 4b 30  82 01 b4 a0 03 02 01 02  |..O0..K0........|
+00000060  02 09 00 e8 f0 9d 3f e2  5b ea a6 30 0d 06 09 2a  |......?.[..0...*|
+00000070  86 48 86 f7 0d 01 01 0b  05 00 30 1f 31 0b 30 09  |.H........0.1.0.|
+00000080  06 03 55 04 0a 13 02 47  6f 31 10 30 0e 06 03 55  |..U....Go1.0...U|
+00000090  04 03 13 07 47 6f 20 52  6f 6f 74 30 1e 17 0d 31  |....Go Root0...1|
+000000a0  36 30 31 30 31 30 30 30  30 30 30 5a 17 0d 32 35  |60101000000Z..25|
+000000b0  30 31 30 31 30 30 30 30  30 30 5a 30 1a 31 0b 30  |0101000000Z0.1.0|
+000000c0  09 06 03 55 04 0a 13 02  47 6f 31 0b 30 09 06 03  |...U....Go1.0...|
+000000d0  55 04 03 13 02 47 6f 30  81 9f 30 0d 06 09 2a 86  |U....Go0..0...*.|
+000000e0  48 86 f7 0d 01 01 01 05  00 03 81 8d 00 30 81 89  |H............0..|
+000000f0  02 81 81 00 db 46 7d 93  2e 12 27 06 48 bc 06 28  |.....F}...'.H..(|
+00000100  21 ab 7e c4 b6 a2 5d fe  1e 52 45 88 7a 36 47 a5  |!.~...]..RE.z6G.|
+00000110  08 0d 92 42 5b c2 81 c0  be 97 79 98 40 fb 4f 6d  |...B[.....y.@.Om|
+00000120  14 fd 2b 13 8b c2 a5 2e  67 d8 d4 09 9e d6 22 38  |..+.....g....."8|
+00000130  b7 4a 0b 74 73 2b c2 34  f1 d1 93 e5 96 d9 74 7b  |.J.ts+.4......t{|
+00000140  f3 58 9f 6c 61 3c c0 b0  41 d4 d9 2b 2b 24 23 77  |.X.la<..A..++$#w|
+00000150  5b 1c 3b bd 75 5d ce 20  54 cf a1 63 87 1d 1e 24  |[.;.u]. T..c...$|
+00000160  c4 f3 1d 1a 50 8b aa b6  14 43 ed 97 a7 75 62 f4  |....P....C...ub.|
+00000170  14 c8 52 d7 02 03 01 00  01 a3 81 93 30 81 90 30  |..R.........0..0|
+00000180  0e 06 03 55 1d 0f 01 01  ff 04 04 03 02 05 a0 30  |...U...........0|
+00000190  1d 06 03 55 1d 25 04 16  30 14 06 08 2b 06 01 05  |...U.%..0...+...|
+000001a0  05 07 03 01 06 08 2b 06  01 05 05 07 03 02 30 0c  |......+.......0.|
+000001b0  06 03 55 1d 13 01 01 ff  04 02 30 00 30 19 06 03  |..U.......0.0...|
+000001c0  55 1d 0e 04 12 04 10 9f  91 16 1f 43 43 3e 49 a6  |U..........CC>I.|
+000001d0  de 6d b6 80 d7 9f 60 30  1b 06 03 55 1d 23 04 14  |.m....`0...U.#..|
+000001e0  30 12 80 10 48 13 49 4d  13 7e 16 31 bb a3 01 d5  |0...H.IM.~.1....|
+000001f0  ac ab 6e 7b 30 19 06 03  55 1d 11 04 12 30 10 82  |..n{0...U....0..|
+00000200  0e 65 78 61 6d 70 6c 65  2e 67 6f 6c 61 6e 67 30  |.example.golang0|
+00000210  0d 06 09 2a 86 48 86 f7  0d 01 01 0b 05 00 03 81  |...*.H..........|
+00000220  81 00 9d 30 cc 40 2b 5b  50 a0 61 cb ba e5 53 58  |...0.@+[P.a...SX|
+00000230  e1 ed 83 28 a9 58 1a a9  38 a4 95 a1 ac 31 5a 1a  |...(.X..8....1Z.|
+00000240  84 66 3d 43 d3 2d d9 0b  f2 97 df d3 20 64 38 92  |.f=C.-...... d8.|
+00000250  24 3a 00 bc cf 9c 7d b7  40 20 01 5f aa d3 16 61  |$:....}.@ ._...a|
+00000260  09 a2 76 fd 13 c3 cc e1  0c 5c ee b1 87 82 f1 6c  |..v......\.....l|
+00000270  04 ed 73 bb b3 43 77 8d  0c 1c f1 0f a1 d8 40 83  |..s..Cw.......@.|
+00000280  61 c9 4c 72 2b 9d ae db  46 06 06 4d f4 c1 b3 3e  |a.Lr+...F..M...>|
+00000290  c0 d1 bd 42 d4 db fe 3d  13 60 84 5c 21 d3 3b e9  |...B...=.`.\!.;.|
+000002a0  fa e7 16 03 03 00 ac 0c  00 00 a8 03 00 1d 20 2f  |.............. /|
+000002b0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
+000002c0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 08  |.........._X.;t.|
+000002d0  04 00 80 51 da 2f 0f fa  db 51 8e 06 0d 04 7e 41  |...Q./...Q....~A|
+000002e0  36 82 13 f0 2b b6 66 fc  7c dd ba 70 e1 bf 9f 9e  |6...+.f.|..p....|
+000002f0  37 2e 10 a5 d1 4c 35 f2  9f 53 83 21 bb db b6 23  |7....L5..S.!...#|
+00000300  11 0d ad f2 84 93 fc b9  34 3e 87 35 ee 01 9b 4d  |........4>.5...M|
+00000310  75 bf f2 7b 84 68 0d b8  89 5e 90 dc 0f 2d 98 85  |u..{.h...^...-..|
+00000320  7f e9 d6 9e 6b 11 74 19  1d bb 1f b4 22 e8 32 b1  |....k.t.....".2.|
+00000330  38 45 c6 d1 b4 8c 8d f2  74 47 46 81 75 f5 e3 65  |8E......tGF.u..e|
+00000340  49 db 72 bd 1f 7a c6 f6  72 e2 a3 2f df b6 4b e9  |I.r..z..r../..K.|
+00000350  49 9f f2 16 03 03 00 04  0e 00 00 00              |I...........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 1b a4 34 56 cd d9  |....%...! ..4V..|
-00000010  6b 18 c2 e5 c0 3f 27 28  23 2a 6f 1d 13 4a 84 e7  |k....?'(#*o..J..|
-00000020  af a6 46 cf 52 a6 a9 2b  98 4a 14 03 03 00 01 01  |..F.R..+.J......|
-00000030  16 03 03 00 40 28 73 6f  2a d2 6c 4a 60 60 57 fc  |....@(so*.lJ``W.|
-00000040  85 5e d0 b9 95 9c 72 4a  7d a5 40 89 3c 22 b0 31  |.^....rJ}.@.<".1|
-00000050  a4 ed cd ba 4a 05 04 d2  e0 d7 be ee 6a 41 45 5d  |....J.......jAE]|
-00000060  db bd 1a bf a1 59 ba 1f  f3 82 68 c4 f5 7c 61 8f  |.....Y....h..|a.|
-00000070  b0 4b 43 3f 7b                                    |.KC?{|
+00000000  16 03 03 00 25 10 00 00  21 20 a5 84 be 07 bc ce  |....%...! ......|
+00000010  f0 e6 4b cd fa 3a f5 af  2c 70 20 e8 52 ec d8 7a  |..K..:..,p .R..z|
+00000020  3f 18 ad d5 b5 8d cd 2d  fb 58 14 03 03 00 01 01  |?......-.X......|
+00000030  16 03 03 00 40 f6 35 fe  5d 83 df fe b1 74 04 e1  |....@.5.]....t..|
+00000040  04 2c 1b 29 9d de 73 1c  9e 8b 54 0b 71 29 ab 2f  |.,.)..s...T.q)./|
+00000050  4a 78 25 da 59 bb a4 41  c9 4e 41 15 07 f0 49 d7  |Jx%.Y..A.NA...I.|
+00000060  a5 37 34 0b 11 e9 77 bd  9a cc f1 15 dd dd 67 ff  |.74...w.......g.|
+00000070  8d 05 ad 53 3f                                    |...S?|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 7f 04 00 00  7b 00 00 00 00 00 75 00  |........{.....u.|
+00000000  16 03 03 00 80 04 00 00  7c 00 00 00 00 00 76 00  |........|.....v.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6f 2d 70 97 51 ed 14 ef  68 ca 42 c5 4c e3 e3 2a  |o-p.Q...h.B.L..*|
-00000030  ac 0e a1 46 90 cc 35 e9  6d 08 a3 48 76 f7 b0 3b  |...F..5.m..Hv..;|
-00000040  7a 25 c1 fb 1f db 71 e7  9b 21 03 42 0e 03 7d 80  |z%....q..!.B..}.|
-00000050  5e 6f 94 85 f9 1d 17 38  22 01 84 43 bb 49 38 16  |^o.....8"..C.I8.|
-00000060  7f 51 5c e5 90 2f b3 81  05 4f af 51 9c 9a 7e 88  |.Q\../...O.Q..~.|
-00000070  cb 7f 5d 42 33 eb 80 22  54 d0 45 ac e4 3d d0 3e  |..]B3.."T.E..=.>|
-00000080  3b 45 8e 79 14 03 03 00  01 01 16 03 03 00 40 00  |;E.y..........@.|
-00000090  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 c5  |................|
-000000a0  28 84 30 0e f4 f4 87 7f  2e 39 e6 8d 35 38 d5 1d  |(.0......9..58..|
-000000b0  e1 ea 93 77 52 bc 4e 42  43 65 0b 70 6e c0 52 3f  |...wR.NBCe.pn.R?|
-000000c0  38 b1 aa 3b 7b a4 4c da  7d ff db 2f ac f6 d8 17  |8..;{.L.}../....|
-000000d0  03 03 00 40 00 00 00 00  00 00 00 00 00 00 00 00  |...@............|
-000000e0  00 00 00 00 03 0b 19 1c  76 4e d6 8d b6 25 bb 3e  |........vN...%.>|
-000000f0  21 72 37 9b 2e 22 41 c8  72 f0 3a d7 79 cd a7 13  |!r7.."A.r.:.y...|
-00000100  4f 62 e6 5d b7 f2 eb f6  72 1b 0a f9 ea e3 3a 23  |Ob.]....r.....:#|
-00000110  19 a1 e8 2a 15 03 03 00  30 00 00 00 00 00 00 00  |...*....0.......|
-00000120  00 00 00 00 00 00 00 00  00 1c bd a5 d9 71 01 32  |.............q.2|
-00000130  82 f5 99 3f 90 88 83 7e  24 5f a5 a2 64 15 7a d3  |...?...~$_..d.z.|
-00000140  2c d2 c7 2c aa 21 be 4f  41                       |,..,.!.OA|
+00000020  6f 2d 70 97 51 ed 14 ef  68 ca 42 c5 4c bf 2b 6e  |o-p.Q...h.B.L.+n|
+00000030  9f eb 23 76 35 91 bb 57  fb 9d 45 26 f6 ab 36 3f  |..#v5..W..E&..6?|
+00000040  5d 3a c6 69 69 7a 8b 84  66 9e d8 36 23 6b 17 d2  |]:.iiz..f..6#k..|
+00000050  8f 34 e0 17 3d cb 14 d2  d4 23 3a 59 a4 49 38 16  |.4..=....#:Y.I8.|
+00000060  7e 51 5c e5 15 6d 7e 9f  8a 99 9f 82 ea 45 8c 80  |~Q\..m~......E..|
+00000070  20 61 03 35 d5 35 92 5e  b2 40 3b 1f fb 06 b5 e0  | a.5.5.^.@;.....|
+00000080  47 fd 7a e4 ee 14 03 03  00 01 01 16 03 03 00 40  |G.z............@|
+00000090  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+000000a0  e7 b4 76 94 09 74 72 3e  a3 93 a8 86 2d a3 38 7a  |..v..tr>....-.8z|
+000000b0  a1 6a c5 f8 84 bd ff 22  35 1c 79 60 de 24 d7 7e  |.j....."5.y`.$.~|
+000000c0  2f ba ab d4 8b 39 c9 0a  c3 eb d0 d7 3e bd 33 ca  |/....9......>.3.|
+000000d0  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
+000000e0  00 00 00 00 00 36 81 be  8a dd 72 2d f4 51 12 26  |.....6....r-.Q.&|
+000000f0  00 b8 75 fb 3e b5 9c 3d  07 5c be ff 10 fb 0a 63  |..u.>..=.\.....c|
+00000100  c6 c2 ce 98 99 58 a1 f4  35 8d 8a 7e 34 36 dc a2  |.....X..5..~46..|
+00000110  89 cb a8 f4 8f 15 03 03  00 30 00 00 00 00 00 00  |.........0......|
+00000120  00 00 00 00 00 00 00 00  00 00 df bf 96 32 59 e5  |.............2Y.|
+00000130  bb e1 bd c8 8a 51 7e 34  b0 44 62 32 16 bd 9b 45  |.....Q~4.Db2...E|
+00000140  4c 17 a5 35 f9 5e 00 db  da 4c                    |L..5.^...L|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-IssueTicket b/src/crypto/tls/testdata/Server-TLSv12-IssueTicket
index 7f0a6270cd..399461ae92 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-IssueTicket
+++ b/src/crypto/tls/testdata/Server-TLSv12-IssueTicket
@@ -1,90 +1,90 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 71 01 00 00  6d 03 03 1c 26 44 a7 cf  |....q...m...&D..|
-00000010  05 36 75 57 76 87 4d 35  40 59 a7 97 7e 7a d6 6b  |.6uWv.M5@Y..~z.k|
-00000020  d5 f9 18 d8 a5 e9 1e 3d  ea ef e1 00 00 04 00 2f  |.......=......./|
+00000000  16 03 01 00 71 01 00 00  6d 03 03 4a 17 2a 03 b4  |....q...m..J.*..|
+00000010  ca 6e 66 72 f3 30 8d c2  37 5e 68 40 92 bc 38 d1  |.nfr.0..7^h@..8.|
+00000020  9f f9 22 a2 4c 6c 30 e2  52 db 81 00 00 04 00 2f  |..".Ll0.R....../|
 00000030  00 ff 01 00 00 40 00 23  00 00 00 16 00 00 00 17  |.....@.#........|
 00000040  00 00 00 0d 00 30 00 2e  04 03 05 03 06 03 08 07  |.....0..........|
 00000050  08 08 08 09 08 0a 08 0b  08 04 08 05 08 06 04 01  |................|
 00000060  05 01 06 01 03 03 02 03  03 01 02 01 03 02 02 02  |................|
 00000070  04 02 05 02 06 02                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 35 02 00 00  31 03 03 00 00 00 00 00  |....5...1.......|
+00000000  16 03 03 00 39 02 00 00  35 03 03 00 00 00 00 00  |....9...5.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 00 2f 00 00  |...DOWNGRD.../..|
-00000030  09 00 23 00 00 ff 01 00  01 00 16 03 03 02 59 0b  |..#...........Y.|
-00000040  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
-00000050  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
-00000060  a6 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |.0...*.H........|
-00000070  30 1f 31 0b 30 09 06 03  55 04 0a 13 02 47 6f 31  |0.1.0...U....Go1|
-00000080  10 30 0e 06 03 55 04 03  13 07 47 6f 20 52 6f 6f  |.0...U....Go Roo|
-00000090  74 30 1e 17 0d 31 36 30  31 30 31 30 30 30 30 30  |t0...16010100000|
-000000a0  30 5a 17 0d 32 35 30 31  30 31 30 30 30 30 30 30  |0Z..250101000000|
-000000b0  5a 30 1a 31 0b 30 09 06  03 55 04 0a 13 02 47 6f  |Z0.1.0...U....Go|
-000000c0  31 0b 30 09 06 03 55 04  03 13 02 47 6f 30 81 9f  |1.0...U....Go0..|
-000000d0  30 0d 06 09 2a 86 48 86  f7 0d 01 01 01 05 00 03  |0...*.H.........|
-000000e0  81 8d 00 30 81 89 02 81  81 00 db 46 7d 93 2e 12  |...0.......F}...|
-000000f0  27 06 48 bc 06 28 21 ab  7e c4 b6 a2 5d fe 1e 52  |'.H..(!.~...]..R|
-00000100  45 88 7a 36 47 a5 08 0d  92 42 5b c2 81 c0 be 97  |E.z6G....B[.....|
-00000110  79 98 40 fb 4f 6d 14 fd  2b 13 8b c2 a5 2e 67 d8  |y.@.Om..+.....g.|
-00000120  d4 09 9e d6 22 38 b7 4a  0b 74 73 2b c2 34 f1 d1  |...."8.J.ts+.4..|
-00000130  93 e5 96 d9 74 7b f3 58  9f 6c 61 3c c0 b0 41 d4  |....t{.X.la<..A.|
-00000140  d9 2b 2b 24 23 77 5b 1c  3b bd 75 5d ce 20 54 cf  |.++$#w[.;.u]. T.|
-00000150  a1 63 87 1d 1e 24 c4 f3  1d 1a 50 8b aa b6 14 43  |.c...$....P....C|
-00000160  ed 97 a7 75 62 f4 14 c8  52 d7 02 03 01 00 01 a3  |...ub...R.......|
-00000170  81 93 30 81 90 30 0e 06  03 55 1d 0f 01 01 ff 04  |..0..0...U......|
-00000180  04 03 02 05 a0 30 1d 06  03 55 1d 25 04 16 30 14  |.....0...U.%..0.|
-00000190  06 08 2b 06 01 05 05 07  03 01 06 08 2b 06 01 05  |..+.........+...|
-000001a0  05 07 03 02 30 0c 06 03  55 1d 13 01 01 ff 04 02  |....0...U.......|
-000001b0  30 00 30 19 06 03 55 1d  0e 04 12 04 10 9f 91 16  |0.0...U.........|
-000001c0  1f 43 43 3e 49 a6 de 6d  b6 80 d7 9f 60 30 1b 06  |.CC>I..m....`0..|
-000001d0  03 55 1d 23 04 14 30 12  80 10 48 13 49 4d 13 7e  |.U.#..0...H.IM.~|
-000001e0  16 31 bb a3 01 d5 ac ab  6e 7b 30 19 06 03 55 1d  |.1......n{0...U.|
-000001f0  11 04 12 30 10 82 0e 65  78 61 6d 70 6c 65 2e 67  |...0...example.g|
-00000200  6f 6c 61 6e 67 30 0d 06  09 2a 86 48 86 f7 0d 01  |olang0...*.H....|
-00000210  01 0b 05 00 03 81 81 00  9d 30 cc 40 2b 5b 50 a0  |.........0.@+[P.|
-00000220  61 cb ba e5 53 58 e1 ed  83 28 a9 58 1a a9 38 a4  |a...SX...(.X..8.|
-00000230  95 a1 ac 31 5a 1a 84 66  3d 43 d3 2d d9 0b f2 97  |...1Z..f=C.-....|
-00000240  df d3 20 64 38 92 24 3a  00 bc cf 9c 7d b7 40 20  |.. d8.$:....}.@ |
-00000250  01 5f aa d3 16 61 09 a2  76 fd 13 c3 cc e1 0c 5c  |._...a..v......\|
-00000260  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
-00000270  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
-00000280  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
-00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 04 0e 00 00  |.\!.;...........|
-000002a0  00                                                |.|
+00000030  0d 00 23 00 00 ff 01 00  01 00 00 17 00 00 16 03  |..#.............|
+00000040  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
+00000050  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
+00000060  3f e2 5b ea a6 30 0d 06  09 2a 86 48 86 f7 0d 01  |?.[..0...*.H....|
+00000070  01 0b 05 00 30 1f 31 0b  30 09 06 03 55 04 0a 13  |....0.1.0...U...|
+00000080  02 47 6f 31 10 30 0e 06  03 55 04 03 13 07 47 6f  |.Go1.0...U....Go|
+00000090  20 52 6f 6f 74 30 1e 17  0d 31 36 30 31 30 31 30  | Root0...1601010|
+000000a0  30 30 30 30 30 5a 17 0d  32 35 30 31 30 31 30 30  |00000Z..25010100|
+000000b0  30 30 30 30 5a 30 1a 31  0b 30 09 06 03 55 04 0a  |0000Z0.1.0...U..|
+000000c0  13 02 47 6f 31 0b 30 09  06 03 55 04 03 13 02 47  |..Go1.0...U....G|
+000000d0  6f 30 81 9f 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |o0..0...*.H.....|
+000000e0  01 05 00 03 81 8d 00 30  81 89 02 81 81 00 db 46  |.......0.......F|
+000000f0  7d 93 2e 12 27 06 48 bc  06 28 21 ab 7e c4 b6 a2  |}...'.H..(!.~...|
+00000100  5d fe 1e 52 45 88 7a 36  47 a5 08 0d 92 42 5b c2  |]..RE.z6G....B[.|
+00000110  81 c0 be 97 79 98 40 fb  4f 6d 14 fd 2b 13 8b c2  |....y.@.Om..+...|
+00000120  a5 2e 67 d8 d4 09 9e d6  22 38 b7 4a 0b 74 73 2b  |..g....."8.J.ts+|
+00000130  c2 34 f1 d1 93 e5 96 d9  74 7b f3 58 9f 6c 61 3c  |.4......t{.X.la<|
+00000140  c0 b0 41 d4 d9 2b 2b 24  23 77 5b 1c 3b bd 75 5d  |..A..++$#w[.;.u]|
+00000150  ce 20 54 cf a1 63 87 1d  1e 24 c4 f3 1d 1a 50 8b  |. T..c...$....P.|
+00000160  aa b6 14 43 ed 97 a7 75  62 f4 14 c8 52 d7 02 03  |...C...ub...R...|
+00000170  01 00 01 a3 81 93 30 81  90 30 0e 06 03 55 1d 0f  |......0..0...U..|
+00000180  01 01 ff 04 04 03 02 05  a0 30 1d 06 03 55 1d 25  |.........0...U.%|
+00000190  04 16 30 14 06 08 2b 06  01 05 05 07 03 01 06 08  |..0...+.........|
+000001a0  2b 06 01 05 05 07 03 02  30 0c 06 03 55 1d 13 01  |+.......0...U...|
+000001b0  01 ff 04 02 30 00 30 19  06 03 55 1d 0e 04 12 04  |....0.0...U.....|
+000001c0  10 9f 91 16 1f 43 43 3e  49 a6 de 6d b6 80 d7 9f  |.....CC>I..m....|
+000001d0  60 30 1b 06 03 55 1d 23  04 14 30 12 80 10 48 13  |`0...U.#..0...H.|
+000001e0  49 4d 13 7e 16 31 bb a3  01 d5 ac ab 6e 7b 30 19  |IM.~.1......n{0.|
+000001f0  06 03 55 1d 11 04 12 30  10 82 0e 65 78 61 6d 70  |..U....0...examp|
+00000200  6c 65 2e 67 6f 6c 61 6e  67 30 0d 06 09 2a 86 48  |le.golang0...*.H|
+00000210  86 f7 0d 01 01 0b 05 00  03 81 81 00 9d 30 cc 40  |.............0.@|
+00000220  2b 5b 50 a0 61 cb ba e5  53 58 e1 ed 83 28 a9 58  |+[P.a...SX...(.X|
+00000230  1a a9 38 a4 95 a1 ac 31  5a 1a 84 66 3d 43 d3 2d  |..8....1Z..f=C.-|
+00000240  d9 0b f2 97 df d3 20 64  38 92 24 3a 00 bc cf 9c  |...... d8.$:....|
+00000250  7d b7 40 20 01 5f aa d3  16 61 09 a2 76 fd 13 c3  |}.@ ._...a..v...|
+00000260  cc e1 0c 5c ee b1 87 82  f1 6c 04 ed 73 bb b3 43  |...\.....l..s..C|
+00000270  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
+00000280  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
+00000290  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
+000002a0  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 01 1d 8d e1 c8  |................|
-00000010  9a ef 1d a1 e7 2d 19 42  86 b7 8c 70 95 7d a8 86  |.....-.B...p.}..|
-00000020  61 8f c7 6e c6 77 10 6b  b8 1e a9 35 ae f1 05 d2  |a..n.w.k...5....|
-00000030  ba 95 64 5b f5 83 d2 4c  80 81 3a b9 82 09 a7 2e  |..d[...L..:.....|
-00000040  ae 0a 43 65 66 4e 7e f8  f8 c5 00 21 bd 78 65 ab  |..CefN~....!.xe.|
-00000050  d2 a6 04 3f 9c 69 50 87  2c d9 ce cd fc f4 22 e3  |...?.iP.,.....".|
-00000060  06 84 20 06 e9 60 91 e3  2f f6 10 eb 18 a6 c3 e8  |.. ..`../.......|
-00000070  8f bf 27 66 f1 46 fa a1  61 96 31 63 62 bb 2f d9  |..'f.F..a.1cb./.|
-00000080  7c 32 7a 33 34 54 c3 a0  47 11 7e 14 03 03 00 01  ||2z34T..G.~.....|
-00000090  01 16 03 03 00 40 58 67  9d 57 43 1e 4e 83 f3 ca  |.....@Xg.WC.N...|
-000000a0  56 e8 8c 27 e0 9b b8 2c  13 95 ac a6 26 c4 28 29  |V..'...,....&.()|
-000000b0  49 e5 9f 77 74 ea 79 01  e5 69 b7 92 19 d4 db ce  |I..wt.y..i......|
-000000c0  5e fd 95 e0 01 eb 57 b6  36 03 47 b1 5e 01 c9 8d  |^.....W.6.G.^...|
-000000d0  d2 c8 cf 0b b1 aa                                 |......|
+00000000  16 03 03 00 86 10 00 00  82 00 80 bb 38 02 3e 1d  |............8.>.|
+00000010  b3 9e d2 5f 35 33 cb 24  68 c5 13 29 a9 8a fe 24  |..._53.$h..)...$|
+00000020  85 20 6a 09 7a 19 af 7f  1f f5 ce 0c b1 e5 00 92  |. j.z...........|
+00000030  e2 d0 3d 74 b2 68 94 62  f2 44 15 c3 ba 44 c6 cb  |..=t.h.b.D...D..|
+00000040  15 06 2d 6c 53 41 7e 3d  e2 57 ef a6 3d 68 81 ce  |..-lSA~=.W..=h..|
+00000050  0a 0e 03 8c 2d 0c 64 2d  10 ae 0e af 9e fc a7 08  |....-.d-........|
+00000060  26 52 47 43 c7 66 a8 ff  ff b9 a4 11 36 c3 6a 0e  |&RGC.f......6.j.|
+00000070  2c 73 a4 31 7c b9 f9 a9  f4 6e 9f 5c db 5f e4 41  |,s.1|....n.\._.A|
+00000080  ee 8c 8c 4f 0e cc 10 32  11 24 9d 14 03 03 00 01  |...O...2.$......|
+00000090  01 16 03 03 00 40 8b 8f  79 d8 0c 4a e8 33 73 a1  |.....@..y..J.3s.|
+000000a0  b0 78 d4 7e 09 3e c1 96  6f 23 a6 5a 93 ec 2b e9  |.x.~.>..o#.Z..+.|
+000000b0  8b 5f 84 ad ae 0d 4c 6a  a8 bc c5 db a2 a5 c2 19  |._....Lj........|
+000000c0  8f b0 06 b6 10 52 90 06  cb 46 6f c8 43 95 da 1b  |.....R...Fo.C...|
+000000d0  20 fb ab 5b 26 1a                                 | ..[&.|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 7f 04 00 00  7b 00 00 00 00 00 75 00  |........{.....u.|
+00000000  16 03 03 00 80 04 00 00  7c 00 00 00 00 00 76 00  |........|.....v.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6f 2d b0 ac 51 ed 14 ef  68 ca 42 c5 4c 67 af 2c  |o-..Q...h.B.Lg.,|
-00000030  17 93 9b 23 75 eb 14 42  1b 7a 25 cb 05 f0 c1 bd  |...#u..B.z%.....|
-00000040  c8 e7 60 6b 0e 1c 45 8d  51 32 a6 7c 6d 01 20 34  |..`k..E.Q2.|m. 4|
-00000050  54 8e dd d5 41 df fe a1  02 4e b5 d1 0b 49 38 16  |T...A....N...I8.|
-00000060  7f 51 5c e5 6a 1a 49 22  f3 54 3e f9 69 5c 2a b3  |.Q\.j.I".T>.i\*.|
-00000070  e6 f7 d8 eb d2 f3 76 65  fa 45 39 d0 15 85 19 40  |......ve.E9....@|
-00000080  bd 38 81 50 14 03 03 00  01 01 16 03 03 00 40 00  |.8.P..........@.|
-00000090  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 1a  |................|
-000000a0  ae 04 aa c1 7a 3a 27 ac  ca 1c 45 5d bd bb bb 59  |....z:'...E]...Y|
-000000b0  b3 ea da 09 fc 8e af 8a  2c d9 56 8a fd 1b 3c e1  |........,.V...<.|
-000000c0  38 de ce 83 87 79 3c 9a  86 cf 88 4b da 39 20 17  |8....y<....K.9 .|
-000000d0  03 03 00 40 00 00 00 00  00 00 00 00 00 00 00 00  |...@............|
-000000e0  00 00 00 00 6f 28 41 26  6e 1e 67 25 43 fc 84 91  |....o(A&n.g%C...|
-000000f0  96 19 28 d0 91 3a dc 8f  8b 63 06 d6 94 73 e9 75  |..(..:...c...s.u|
-00000100  ab 6f ce 39 18 84 c0 0e  04 ca 13 75 db f8 f3 0c  |.o.9.......u....|
-00000110  57 46 9e 59 15 03 03 00  30 00 00 00 00 00 00 00  |WF.Y....0.......|
-00000120  00 00 00 00 00 00 00 00  00 00 01 b3 55 6c 58 f0  |............UlX.|
-00000130  ee f9 bb 5f eb 97 9b a7  95 a6 82 95 bf 06 29 1b  |..._..........).|
-00000140  ff 2c 5f d8 01 5e 2d 93  cf                       |.,_..^-..|
+00000020  6f 2d b0 ac 51 ed 14 ef  68 ca 42 c5 4c 1b 7a 85  |o-..Q...h.B.L.z.|
+00000030  17 60 8e 95 68 ae ba d1  10 71 7c 2c ad 1e bb 60  |.`..h....q|,...`|
+00000040  4d ef 70 e7 f0 ed 39 8b  9c 99 f6 8c cb e4 41 28  |M.p...9.......A(|
+00000050  94 bc f0 91 d9 8f 1b cb  7d e8 4c 4c 49 49 38 16  |........}.LLII8.|
+00000060  7e 51 5c e5 15 ff 0f 34  c4 f2 42 d0 c6 48 7c 0b  |~Q\....4..B..H|.|
+00000070  f1 5d 4b f3 54 87 8e 2d  d1 dd 1c 56 95 9d 57 bd  |.]K.T..-...V..W.|
+00000080  28 ed cf 80 06 14 03 03  00 01 01 16 03 03 00 40  |(..............@|
+00000090  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+000000a0  eb fe be 2e 90 0b 5e 33  ce 76 8a dd 00 8a 25 c7  |......^3.v....%.|
+000000b0  14 c4 06 b2 7d 8f 4e 38  7d 1f f9 b4 21 cb b7 8e  |....}.N8}...!...|
+000000c0  1b 4b b6 b9 17 04 bd 98  d3 aa a1 a2 49 59 4e c7  |.K..........IYN.|
+000000d0  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
+000000e0  00 00 00 00 00 95 59 f7  79 bd 57 9b 07 6b b5 18  |......Y.y.W..k..|
+000000f0  0b b6 17 99 7f c1 40 e1  b9 df f5 45 6b 57 06 1c  |......@....EkW..|
+00000100  b7 a9 4c 71 99 8b 35 17  c8 0e 78 2c 49 35 48 e8  |..Lq..5...x,I5H.|
+00000110  4d 1f d4 3d 58 15 03 03  00 30 00 00 00 00 00 00  |M..=X....0......|
+00000120  00 00 00 00 00 00 00 00  00 00 47 76 9f b0 43 ee  |..........Gv..C.|
+00000130  e1 ee 99 10 93 94 cc 8f  0c 54 fc ff d0 3b 93 8c  |.........T...;..|
+00000140  21 30 70 53 c7 b8 54 14  ca 67                    |!0pS..T..g|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable b/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable
index 4a5a468530..ca1b91c818 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable
+++ b/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable
@@ -1,90 +1,90 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 71 01 00 00  6d 03 03 5f 50 63 b3 9f  |....q...m.._Pc..|
-00000010  b9 30 07 c9 0e 79 4f 1e  0b 61 0c 04 36 77 19 c8  |.0...yO..a..6w..|
-00000020  b1 36 a4 34 e7 ba be e4  f2 6c b3 00 00 04 00 2f  |.6.4.....l...../|
+00000000  16 03 01 00 71 01 00 00  6d 03 03 4b e2 b8 af c9  |....q...m..K....|
+00000010  70 49 22 d0 7c 4d c0 45  11 aa cd 80 f4 95 5c fd  |pI".|M.E......\.|
+00000020  ed 04 d6 45 09 4b b0 31  1d f5 d7 00 00 04 00 2f  |...E.K.1......./|
 00000030  00 ff 01 00 00 40 00 23  00 00 00 16 00 00 00 17  |.....@.#........|
 00000040  00 00 00 0d 00 30 00 2e  04 03 05 03 06 03 08 07  |.....0..........|
 00000050  08 08 08 09 08 0a 08 0b  08 04 08 05 08 06 04 01  |................|
 00000060  05 01 06 01 03 03 02 03  03 01 02 01 03 02 02 02  |................|
 00000070  04 02 05 02 06 02                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 35 02 00 00  31 03 03 00 00 00 00 00  |....5...1.......|
+00000000  16 03 03 00 39 02 00 00  35 03 03 00 00 00 00 00  |....9...5.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 00 2f 00 00  |...DOWNGRD.../..|
-00000030  09 00 23 00 00 ff 01 00  01 00 16 03 03 02 59 0b  |..#...........Y.|
-00000040  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
-00000050  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
-00000060  a6 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |.0...*.H........|
-00000070  30 1f 31 0b 30 09 06 03  55 04 0a 13 02 47 6f 31  |0.1.0...U....Go1|
-00000080  10 30 0e 06 03 55 04 03  13 07 47 6f 20 52 6f 6f  |.0...U....Go Roo|
-00000090  74 30 1e 17 0d 31 36 30  31 30 31 30 30 30 30 30  |t0...16010100000|
-000000a0  30 5a 17 0d 32 35 30 31  30 31 30 30 30 30 30 30  |0Z..250101000000|
-000000b0  5a 30 1a 31 0b 30 09 06  03 55 04 0a 13 02 47 6f  |Z0.1.0...U....Go|
-000000c0  31 0b 30 09 06 03 55 04  03 13 02 47 6f 30 81 9f  |1.0...U....Go0..|
-000000d0  30 0d 06 09 2a 86 48 86  f7 0d 01 01 01 05 00 03  |0...*.H.........|
-000000e0  81 8d 00 30 81 89 02 81  81 00 db 46 7d 93 2e 12  |...0.......F}...|
-000000f0  27 06 48 bc 06 28 21 ab  7e c4 b6 a2 5d fe 1e 52  |'.H..(!.~...]..R|
-00000100  45 88 7a 36 47 a5 08 0d  92 42 5b c2 81 c0 be 97  |E.z6G....B[.....|
-00000110  79 98 40 fb 4f 6d 14 fd  2b 13 8b c2 a5 2e 67 d8  |y.@.Om..+.....g.|
-00000120  d4 09 9e d6 22 38 b7 4a  0b 74 73 2b c2 34 f1 d1  |...."8.J.ts+.4..|
-00000130  93 e5 96 d9 74 7b f3 58  9f 6c 61 3c c0 b0 41 d4  |....t{.X.la<..A.|
-00000140  d9 2b 2b 24 23 77 5b 1c  3b bd 75 5d ce 20 54 cf  |.++$#w[.;.u]. T.|
-00000150  a1 63 87 1d 1e 24 c4 f3  1d 1a 50 8b aa b6 14 43  |.c...$....P....C|
-00000160  ed 97 a7 75 62 f4 14 c8  52 d7 02 03 01 00 01 a3  |...ub...R.......|
-00000170  81 93 30 81 90 30 0e 06  03 55 1d 0f 01 01 ff 04  |..0..0...U......|
-00000180  04 03 02 05 a0 30 1d 06  03 55 1d 25 04 16 30 14  |.....0...U.%..0.|
-00000190  06 08 2b 06 01 05 05 07  03 01 06 08 2b 06 01 05  |..+.........+...|
-000001a0  05 07 03 02 30 0c 06 03  55 1d 13 01 01 ff 04 02  |....0...U.......|
-000001b0  30 00 30 19 06 03 55 1d  0e 04 12 04 10 9f 91 16  |0.0...U.........|
-000001c0  1f 43 43 3e 49 a6 de 6d  b6 80 d7 9f 60 30 1b 06  |.CC>I..m....`0..|
-000001d0  03 55 1d 23 04 14 30 12  80 10 48 13 49 4d 13 7e  |.U.#..0...H.IM.~|
-000001e0  16 31 bb a3 01 d5 ac ab  6e 7b 30 19 06 03 55 1d  |.1......n{0...U.|
-000001f0  11 04 12 30 10 82 0e 65  78 61 6d 70 6c 65 2e 67  |...0...example.g|
-00000200  6f 6c 61 6e 67 30 0d 06  09 2a 86 48 86 f7 0d 01  |olang0...*.H....|
-00000210  01 0b 05 00 03 81 81 00  9d 30 cc 40 2b 5b 50 a0  |.........0.@+[P.|
-00000220  61 cb ba e5 53 58 e1 ed  83 28 a9 58 1a a9 38 a4  |a...SX...(.X..8.|
-00000230  95 a1 ac 31 5a 1a 84 66  3d 43 d3 2d d9 0b f2 97  |...1Z..f=C.-....|
-00000240  df d3 20 64 38 92 24 3a  00 bc cf 9c 7d b7 40 20  |.. d8.$:....}.@ |
-00000250  01 5f aa d3 16 61 09 a2  76 fd 13 c3 cc e1 0c 5c  |._...a..v......\|
-00000260  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
-00000270  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
-00000280  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
-00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 04 0e 00 00  |.\!.;...........|
-000002a0  00                                                |.|
+00000030  0d 00 23 00 00 ff 01 00  01 00 00 17 00 00 16 03  |..#.............|
+00000040  03 02 59 0b 00 02 55 00  02 52 00 02 4f 30 82 02  |..Y...U..R..O0..|
+00000050  4b 30 82 01 b4 a0 03 02  01 02 02 09 00 e8 f0 9d  |K0..............|
+00000060  3f e2 5b ea a6 30 0d 06  09 2a 86 48 86 f7 0d 01  |?.[..0...*.H....|
+00000070  01 0b 05 00 30 1f 31 0b  30 09 06 03 55 04 0a 13  |....0.1.0...U...|
+00000080  02 47 6f 31 10 30 0e 06  03 55 04 03 13 07 47 6f  |.Go1.0...U....Go|
+00000090  20 52 6f 6f 74 30 1e 17  0d 31 36 30 31 30 31 30  | Root0...1601010|
+000000a0  30 30 30 30 30 5a 17 0d  32 35 30 31 30 31 30 30  |00000Z..25010100|
+000000b0  30 30 30 30 5a 30 1a 31  0b 30 09 06 03 55 04 0a  |0000Z0.1.0...U..|
+000000c0  13 02 47 6f 31 0b 30 09  06 03 55 04 03 13 02 47  |..Go1.0...U....G|
+000000d0  6f 30 81 9f 30 0d 06 09  2a 86 48 86 f7 0d 01 01  |o0..0...*.H.....|
+000000e0  01 05 00 03 81 8d 00 30  81 89 02 81 81 00 db 46  |.......0.......F|
+000000f0  7d 93 2e 12 27 06 48 bc  06 28 21 ab 7e c4 b6 a2  |}...'.H..(!.~...|
+00000100  5d fe 1e 52 45 88 7a 36  47 a5 08 0d 92 42 5b c2  |]..RE.z6G....B[.|
+00000110  81 c0 be 97 79 98 40 fb  4f 6d 14 fd 2b 13 8b c2  |....y.@.Om..+...|
+00000120  a5 2e 67 d8 d4 09 9e d6  22 38 b7 4a 0b 74 73 2b  |..g....."8.J.ts+|
+00000130  c2 34 f1 d1 93 e5 96 d9  74 7b f3 58 9f 6c 61 3c  |.4......t{.X.la<|
+00000140  c0 b0 41 d4 d9 2b 2b 24  23 77 5b 1c 3b bd 75 5d  |..A..++$#w[.;.u]|
+00000150  ce 20 54 cf a1 63 87 1d  1e 24 c4 f3 1d 1a 50 8b  |. T..c...$....P.|
+00000160  aa b6 14 43 ed 97 a7 75  62 f4 14 c8 52 d7 02 03  |...C...ub...R...|
+00000170  01 00 01 a3 81 93 30 81  90 30 0e 06 03 55 1d 0f  |......0..0...U..|
+00000180  01 01 ff 04 04 03 02 05  a0 30 1d 06 03 55 1d 25  |.........0...U.%|
+00000190  04 16 30 14 06 08 2b 06  01 05 05 07 03 01 06 08  |..0...+.........|
+000001a0  2b 06 01 05 05 07 03 02  30 0c 06 03 55 1d 13 01  |+.......0...U...|
+000001b0  01 ff 04 02 30 00 30 19  06 03 55 1d 0e 04 12 04  |....0.0...U.....|
+000001c0  10 9f 91 16 1f 43 43 3e  49 a6 de 6d b6 80 d7 9f  |.....CC>I..m....|
+000001d0  60 30 1b 06 03 55 1d 23  04 14 30 12 80 10 48 13  |`0...U.#..0...H.|
+000001e0  49 4d 13 7e 16 31 bb a3  01 d5 ac ab 6e 7b 30 19  |IM.~.1......n{0.|
+000001f0  06 03 55 1d 11 04 12 30  10 82 0e 65 78 61 6d 70  |..U....0...examp|
+00000200  6c 65 2e 67 6f 6c 61 6e  67 30 0d 06 09 2a 86 48  |le.golang0...*.H|
+00000210  86 f7 0d 01 01 0b 05 00  03 81 81 00 9d 30 cc 40  |.............0.@|
+00000220  2b 5b 50 a0 61 cb ba e5  53 58 e1 ed 83 28 a9 58  |+[P.a...SX...(.X|
+00000230  1a a9 38 a4 95 a1 ac 31  5a 1a 84 66 3d 43 d3 2d  |..8....1Z..f=C.-|
+00000240  d9 0b f2 97 df d3 20 64  38 92 24 3a 00 bc cf 9c  |...... d8.$:....|
+00000250  7d b7 40 20 01 5f aa d3  16 61 09 a2 76 fd 13 c3  |}.@ ._...a..v...|
+00000260  cc e1 0c 5c ee b1 87 82  f1 6c 04 ed 73 bb b3 43  |...\.....l..s..C|
+00000270  77 8d 0c 1c f1 0f a1 d8  40 83 61 c9 4c 72 2b 9d  |w.......@.a.Lr+.|
+00000280  ae db 46 06 06 4d f4 c1  b3 3e c0 d1 bd 42 d4 db  |..F..M...>...B..|
+00000290  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
+000002a0  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 0d 51 76 ac f8  |............Qv..|
-00000010  bb 03 34 db 0a fe c9 3b  8a 03 6e 33 5d 77 36 74  |..4....;..n3]w6t|
-00000020  c0 10 fa d6 61 d7 33 09  8f 09 fa 1a d3 52 96 27  |....a.3......R.'|
-00000030  c0 9e 54 47 0d 91 ff 39  11 8c 16 c1 4e 1b 6b 1e  |..TG...9....N.k.|
-00000040  ee 40 25 12 6c 96 fa 0e  45 f4 01 84 1e cd e7 79  |.@%.l...E......y|
-00000050  84 d0 c3 ed 83 ba e6 a6  9f 8d 7e 74 19 0a bc 5f  |..........~t..._|
-00000060  6d 34 a9 3f 4d 80 dc 24  1c a0 7e 5a 3a 0d 30 23  |m4.?M..$..~Z:.0#|
-00000070  65 49 16 32 89 9a 62 0f  77 7d c5 e5 e9 37 b5 f7  |eI.2..b.w}...7..|
-00000080  62 7e 42 57 87 5c d4 01  b1 2c 59 14 03 03 00 01  |b~BW.\...,Y.....|
-00000090  01 16 03 03 00 40 99 b2  ff f0 2b 92 3a b1 5f 7d  |.....@....+.:._}|
-000000a0  d8 fa 25 b4 89 75 0a fa  c2 b6 e8 f9 c2 0c af 6c  |..%..u.........l|
-000000b0  e6 ad 41 7b 08 ef 51 1d  25 71 ef 4e 2b 05 62 87  |..A{..Q.%q.N+.b.|
-000000c0  dd c4 3d bd ac 2f 26 3b  6c 84 bd ba 77 0b f5 19  |..=../&;l...w...|
-000000d0  8b b6 50 46 20 c0                                 |..PF .|
+00000000  16 03 03 00 86 10 00 00  82 00 80 87 64 93 5c 78  |............d.\x|
+00000010  c4 33 ec 05 ea da 29 f4  16 4a ca 2e bc 93 f4 37  |.3....)..J.....7|
+00000020  a4 b5 76 54 97 7f 91 3a  11 79 8f b4 d3 35 af fb  |..vT...:.y...5..|
+00000030  6a 9a 9e 2e 0a 1a e0 fd  99 72 2e d1 7e a6 62 0c  |j........r..~.b.|
+00000040  ca d5 c6 03 00 8e 18 7d  2b 8e 94 74 c1 5b fb c3  |.......}+..t.[..|
+00000050  85 94 1c 92 33 0a a8 03  2b 60 02 dd 3b e8 26 d1  |....3...+`..;.&.|
+00000060  e2 e3 cf 86 7f a9 59 9d  e0 0a 62 b0 3f 98 c2 41  |......Y...b.?..A|
+00000070  e3 88 dd 0b 87 56 d0 23  b9 44 c8 0a 18 29 36 d9  |.....V.#.D...)6.|
+00000080  e3 28 bd 26 b7 90 f1 ac  13 d7 44 14 03 03 00 01  |.(.&......D.....|
+00000090  01 16 03 03 00 40 4d 02  0c 64 a6 e7 14 2d a1 ef  |.....@M..d...-..|
+000000a0  0e 46 26 d9 40 7e c6 e9  f7 87 e1 19 b6 0f 77 ed  |.F&.@~........w.|
+000000b0  90 59 db c1 59 f9 25 a9  ed c3 c3 d1 5b fd 52 0b  |.Y..Y.%.....[.R.|
+000000c0  a7 a4 64 ef d4 6b 80 14  e4 32 13 c4 7a 77 31 cc  |..d..k...2..zw1.|
+000000d0  2f cb c6 1b 73 a5                                 |/...s.|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 7f 04 00 00  7b 00 00 00 00 00 75 00  |........{.....u.|
+00000000  16 03 03 00 80 04 00 00  7c 00 00 00 00 00 76 00  |........|.....v.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6f 2d b0 ac 51 ed 14 ef  68 ca 42 c5 4c 70 b7 ba  |o-..Q...h.B.Lp..|
-00000030  31 5b 35 fd 69 77 46 6b  65 45 a4 33 54 ac 51 ea  |1[5.iwFkeE.3T.Q.|
-00000040  95 d9 10 78 5d 9a 64 3e  45 62 ac f3 02 97 15 b7  |...x].d>Eb......|
-00000050  a0 30 21 2f 35 fd fa 24  af 05 0e e7 32 49 38 16  |.0!/5..$....2I8.|
-00000060  7f 51 5c e5 41 73 f0 28  93 1c ec 01 25 f6 8a d4  |.Q\.As.(....%...|
-00000070  50 c8 71 30 08 29 35 bf  67 34 37 a0 4d e8 9b 69  |P.q0.)5.g47.M..i|
-00000080  9e 96 99 20 14 03 03 00  01 01 16 03 03 00 40 00  |... ..........@.|
-00000090  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 ef  |................|
-000000a0  f7 d7 8f 1f fd fa e3 3f  73 96 8c 91 0c 45 c9 e7  |.......?s....E..|
-000000b0  b3 7d 6b 46 d8 cd 6b 57  34 41 c0 82 16 c5 54 d5  |.}kF..kW4A....T.|
-000000c0  6d 6e 28 4f 34 b3 5b 38  a9 16 65 c5 0e 82 62 17  |mn(O4.[8..e...b.|
-000000d0  03 03 00 40 00 00 00 00  00 00 00 00 00 00 00 00  |...@............|
-000000e0  00 00 00 00 66 82 40 65  1f e8 a5 e9 19 20 87 c6  |....f.@e..... ..|
-000000f0  72 4e 15 19 ea ca cd 6e  6d 74 23 b5 1c ac eb 16  |rN.....nmt#.....|
-00000100  d2 88 a1 db 90 72 a0 85  ec 06 9e 3d ae e1 19 e1  |.....r.....=....|
-00000110  ba 3d 4b ec 15 03 03 00  30 00 00 00 00 00 00 00  |.=K.....0.......|
-00000120  00 00 00 00 00 00 00 00  00 48 50 fd 3c de 1e 5f  |.........HP.<.._|
-00000130  94 2b 1f e9 97 d9 e2 22  66 0c 27 78 d0 69 87 dc  |.+....."f.'x.i..|
-00000140  06 1d c6 3c 33 47 3c 04  db                       |...<3G<..|
+00000020  6f 2d b0 ac 51 ed 14 ef  68 ca 42 c5 4c 78 cb 47  |o-..Q...h.B.Lx.G|
+00000030  2f 89 ed 83 1b c1 0a fa  14 8f ad cb 55 da 3b 0e  |/...........U.;.|
+00000040  41 cb 5e d4 16 04 a2 6f  fb 8e 18 cc de c5 e9 ff  |A.^....o........|
+00000050  eb 7a 4c 87 89 f9 61 d5  24 02 15 96 31 49 38 16  |.zL...a.$...1I8.|
+00000060  7e 51 5c e5 15 67 a1 6f  53 38 e0 bb 43 eb 92 7a  |~Q\..g.oS8..C..z|
+00000070  c4 8a 33 bc d3 57 cd 7d  b0 b5 62 17 4b ea a9 9f  |..3..W.}..b.K...|
+00000080  13 f3 c9 04 ae 14 03 03  00 01 01 16 03 03 00 40  |...............@|
+00000090  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
+000000a0  c6 23 28 2c c8 33 2d a6  7b a4 32 16 0e 66 2a 58  |.#(,.3-.{.2..f*X|
+000000b0  2d f8 85 8b f3 7d 5f 82  57 fc 7b 4d 81 13 73 d0  |-....}_.W.{M..s.|
+000000c0  c6 6d 9c 87 a1 09 c2 67  ab cc d3 2d c7 4d 52 4a  |.m.....g...-.MRJ|
+000000d0  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
+000000e0  00 00 00 00 00 b3 74 97  6d ae 2e 32 53 60 8d 12  |......t.m..2S`..|
+000000f0  b1 d1 0d 24 eb bf 9a 5b  5d e1 7c 75 d7 17 24 3c  |...$...[].|u..$<|
+00000100  5b 82 86 24 41 89 ac ad  f9 86 db 7c 20 8c 18 7a  |[..$A......| ..z|
+00000110  dc 3a b9 41 e0 15 03 03  00 30 00 00 00 00 00 00  |.:.A.....0......|
+00000120  00 00 00 00 00 00 00 00  00 00 ea a1 95 df 7f 3c  |...............<|
+00000130  c2 d2 df de d4 21 d8 7d  8c 67 3a c5 f9 c2 f8 fe  |.....!.}.g:.....|
+00000140  9d ea 08 d5 35 d9 ed 6f  d2 29                    |....5..o.)|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-P256 b/src/crypto/tls/testdata/Server-TLSv12-P256
index 58b9bedc71..349857e94d 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-P256
+++ b/src/crypto/tls/testdata/Server-TLSv12-P256
@@ -1,86 +1,84 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8f 01 00 00  8b 03 03 49 de 51 77 8e  |...........I.Qw.|
-00000010  58 03 e9 25 0b 9a 88 ef  35 2d 35 a8 30 29 22 61  |X..%....5-5.0)"a|
-00000020  ae b4 af 8a a1 2c 45 59  40 5f aa 00 00 04 c0 2f  |.....,EY@_...../|
-00000030  00 ff 01 00 00 5e 00 00  00 0e 00 0c 00 00 09 31  |.....^.........1|
-00000040  32 37 2e 30 2e 30 2e 31  00 0b 00 04 03 00 01 02  |27.0.0.1........|
-00000050  00 0a 00 04 00 02 00 17  00 16 00 00 00 17 00 00  |................|
-00000060  00 0d 00 30 00 2e 04 03  05 03 06 03 08 07 08 08  |...0............|
-00000070  08 09 08 0a 08 0b 08 04  08 05 08 06 04 01 05 01  |................|
-00000080  06 01 03 03 02 03 03 01  02 01 03 02 02 02 04 02  |................|
-00000090  05 02 06 02                                       |....|
+00000000  16 03 01 00 7d 01 00 00  79 03 03 26 b5 ad b7 ec  |....}...y..&....|
+00000010  e9 2f d5 cc 9e c2 f6 6f  dd ab c5 4b 2c 74 48 a5  |./.....o...K,tH.|
+00000020  9c c5 21 41 fd 32 91 04  8f 1b 6c 00 00 04 cc a8  |..!A.2....l.....|
+00000030  00 ff 01 00 00 4c 00 0b  00 04 03 00 01 02 00 0a  |.....L..........|
+00000040  00 04 00 02 00 17 00 16  00 00 00 17 00 00 00 0d  |................|
+00000050  00 30 00 2e 04 03 05 03  06 03 08 07 08 08 08 09  |.0..............|
+00000060  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
+00000070  03 03 02 03 03 01 02 01  03 02 02 02 04 02 05 02  |................|
+00000080  06 02                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 37 02 00 00  33 03 03 00 00 00 00 00  |....7...3.......|
+00000000  16 03 03 00 3b 02 00 00  37 03 03 00 00 00 00 00  |....;...7.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 c0 2f 00 00  |...DOWNGRD.../..|
-00000030  0b ff 01 00 01 00 00 0b  00 02 01 00 16 03 03 02  |................|
-00000040  59 0b 00 02 55 00 02 52  00 02 4f 30 82 02 4b 30  |Y...U..R..O0..K0|
-00000050  82 01 b4 a0 03 02 01 02  02 09 00 e8 f0 9d 3f e2  |..............?.|
-00000060  5b ea a6 30 0d 06 09 2a  86 48 86 f7 0d 01 01 0b  |[..0...*.H......|
-00000070  05 00 30 1f 31 0b 30 09  06 03 55 04 0a 13 02 47  |..0.1.0...U....G|
-00000080  6f 31 10 30 0e 06 03 55  04 03 13 07 47 6f 20 52  |o1.0...U....Go R|
-00000090  6f 6f 74 30 1e 17 0d 31  36 30 31 30 31 30 30 30  |oot0...160101000|
-000000a0  30 30 30 5a 17 0d 32 35  30 31 30 31 30 30 30 30  |000Z..2501010000|
-000000b0  30 30 5a 30 1a 31 0b 30  09 06 03 55 04 0a 13 02  |00Z0.1.0...U....|
-000000c0  47 6f 31 0b 30 09 06 03  55 04 03 13 02 47 6f 30  |Go1.0...U....Go0|
-000000d0  81 9f 30 0d 06 09 2a 86  48 86 f7 0d 01 01 01 05  |..0...*.H.......|
-000000e0  00 03 81 8d 00 30 81 89  02 81 81 00 db 46 7d 93  |.....0.......F}.|
-000000f0  2e 12 27 06 48 bc 06 28  21 ab 7e c4 b6 a2 5d fe  |..'.H..(!.~...].|
-00000100  1e 52 45 88 7a 36 47 a5  08 0d 92 42 5b c2 81 c0  |.RE.z6G....B[...|
-00000110  be 97 79 98 40 fb 4f 6d  14 fd 2b 13 8b c2 a5 2e  |..y.@.Om..+.....|
-00000120  67 d8 d4 09 9e d6 22 38  b7 4a 0b 74 73 2b c2 34  |g....."8.J.ts+.4|
-00000130  f1 d1 93 e5 96 d9 74 7b  f3 58 9f 6c 61 3c c0 b0  |......t{.X.la<..|
-00000140  41 d4 d9 2b 2b 24 23 77  5b 1c 3b bd 75 5d ce 20  |A..++$#w[.;.u]. |
-00000150  54 cf a1 63 87 1d 1e 24  c4 f3 1d 1a 50 8b aa b6  |T..c...$....P...|
-00000160  14 43 ed 97 a7 75 62 f4  14 c8 52 d7 02 03 01 00  |.C...ub...R.....|
-00000170  01 a3 81 93 30 81 90 30  0e 06 03 55 1d 0f 01 01  |....0..0...U....|
-00000180  ff 04 04 03 02 05 a0 30  1d 06 03 55 1d 25 04 16  |.......0...U.%..|
-00000190  30 14 06 08 2b 06 01 05  05 07 03 01 06 08 2b 06  |0...+.........+.|
-000001a0  01 05 05 07 03 02 30 0c  06 03 55 1d 13 01 01 ff  |......0...U.....|
-000001b0  04 02 30 00 30 19 06 03  55 1d 0e 04 12 04 10 9f  |..0.0...U.......|
-000001c0  91 16 1f 43 43 3e 49 a6  de 6d b6 80 d7 9f 60 30  |...CC>I..m....`0|
-000001d0  1b 06 03 55 1d 23 04 14  30 12 80 10 48 13 49 4d  |...U.#..0...H.IM|
-000001e0  13 7e 16 31 bb a3 01 d5  ac ab 6e 7b 30 19 06 03  |.~.1......n{0...|
-000001f0  55 1d 11 04 12 30 10 82  0e 65 78 61 6d 70 6c 65  |U....0...example|
-00000200  2e 67 6f 6c 61 6e 67 30  0d 06 09 2a 86 48 86 f7  |.golang0...*.H..|
-00000210  0d 01 01 0b 05 00 03 81  81 00 9d 30 cc 40 2b 5b  |...........0.@+[|
-00000220  50 a0 61 cb ba e5 53 58  e1 ed 83 28 a9 58 1a a9  |P.a...SX...(.X..|
-00000230  38 a4 95 a1 ac 31 5a 1a  84 66 3d 43 d3 2d d9 0b  |8....1Z..f=C.-..|
-00000240  f2 97 df d3 20 64 38 92  24 3a 00 bc cf 9c 7d b7  |.... d8.$:....}.|
-00000250  40 20 01 5f aa d3 16 61  09 a2 76 fd 13 c3 cc e1  |@ ._...a..v.....|
-00000260  0c 5c ee b1 87 82 f1 6c  04 ed 73 bb b3 43 77 8d  |.\.....l..s..Cw.|
-00000270  0c 1c f1 0f a1 d8 40 83  61 c9 4c 72 2b 9d ae db  |......@.a.Lr+...|
-00000280  46 06 06 4d f4 c1 b3 3e  c0 d1 bd 42 d4 db fe 3d  |F..M...>...B...=|
-00000290  13 60 84 5c 21 d3 3b e9  fa e7 16 03 03 00 cd 0c  |.`.\!.;.........|
-000002a0  00 00 c9 03 00 17 41 04  1e 18 37 ef 0d 19 51 88  |......A...7...Q.|
-000002b0  35 75 71 b5 e5 54 5b 12  2e 8f 09 67 fd a7 24 20  |5uq..T[....g..$ |
-000002c0  3e b2 56 1c ce 97 28 5e  f8 2b 2d 4f 9e f1 07 9f  |>.V...(^.+-O....|
-000002d0  6c 4b 5b 83 56 e2 32 42  e9 58 b6 d7 49 a6 b5 68  |lK[.V.2B.X..I..h|
-000002e0  1a 41 03 56 6b dc 5a 89  08 04 00 80 7b bd 89 a1  |.A.Vk.Z.....{...|
-000002f0  d8 9d cf e4 75 ac 15 60  a9 49 0c c7 68 61 4e e4  |....u..`.I..haN.|
-00000300  2b 51 37 5a 65 38 a4 52  6a d0 4f 8b 76 93 a4 7c  |+Q7Ze8.Rj.O.v..||
-00000310  ac 30 6b 89 f1 c7 88 8f  f3 5c c7 e9 d6 7c 33 94  |.0k......\...|3.|
-00000320  f7 fc f8 69 35 f3 f7 e0  ea fc 51 5c b2 e2 dc 9e  |...i5.....Q\....|
-00000330  57 03 af e6 19 0d 0d e4  25 b6 52 19 12 ad 35 fc  |W.......%.R...5.|
-00000340  7f c3 6a 1f ed 06 82 34  81 13 d7 c1 67 a9 18 88  |..j....4....g...|
-00000350  2f bb 00 54 5d d9 01 16  29 dd 03 3c 69 f7 46 52  |/..T]...)..<i.FR|
-00000360  6a 95 51 81 75 68 fa 15  09 11 38 94 16 03 03 00  |j.Q.uh....8.....|
-00000370  04 0e 00 00 00                                    |.....|
+00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 cc a8 00 00  |...DOWNGRD......|
+00000030  0f ff 01 00 01 00 00 17  00 00 00 0b 00 02 01 00  |................|
+00000040  16 03 03 02 59 0b 00 02  55 00 02 52 00 02 4f 30  |....Y...U..R..O0|
+00000050  82 02 4b 30 82 01 b4 a0  03 02 01 02 02 09 00 e8  |..K0............|
+00000060  f0 9d 3f e2 5b ea a6 30  0d 06 09 2a 86 48 86 f7  |..?.[..0...*.H..|
+00000070  0d 01 01 0b 05 00 30 1f  31 0b 30 09 06 03 55 04  |......0.1.0...U.|
+00000080  0a 13 02 47 6f 31 10 30  0e 06 03 55 04 03 13 07  |...Go1.0...U....|
+00000090  47 6f 20 52 6f 6f 74 30  1e 17 0d 31 36 30 31 30  |Go Root0...16010|
+000000a0  31 30 30 30 30 30 30 5a  17 0d 32 35 30 31 30 31  |1000000Z..250101|
+000000b0  30 30 30 30 30 30 5a 30  1a 31 0b 30 09 06 03 55  |000000Z0.1.0...U|
+000000c0  04 0a 13 02 47 6f 31 0b  30 09 06 03 55 04 03 13  |....Go1.0...U...|
+000000d0  02 47 6f 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |.Go0..0...*.H...|
+000000e0  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+000000f0  db 46 7d 93 2e 12 27 06  48 bc 06 28 21 ab 7e c4  |.F}...'.H..(!.~.|
+00000100  b6 a2 5d fe 1e 52 45 88  7a 36 47 a5 08 0d 92 42  |..]..RE.z6G....B|
+00000110  5b c2 81 c0 be 97 79 98  40 fb 4f 6d 14 fd 2b 13  |[.....y.@.Om..+.|
+00000120  8b c2 a5 2e 67 d8 d4 09  9e d6 22 38 b7 4a 0b 74  |....g....."8.J.t|
+00000130  73 2b c2 34 f1 d1 93 e5  96 d9 74 7b f3 58 9f 6c  |s+.4......t{.X.l|
+00000140  61 3c c0 b0 41 d4 d9 2b  2b 24 23 77 5b 1c 3b bd  |a<..A..++$#w[.;.|
+00000150  75 5d ce 20 54 cf a1 63  87 1d 1e 24 c4 f3 1d 1a  |u]. T..c...$....|
+00000160  50 8b aa b6 14 43 ed 97  a7 75 62 f4 14 c8 52 d7  |P....C...ub...R.|
+00000170  02 03 01 00 01 a3 81 93  30 81 90 30 0e 06 03 55  |........0..0...U|
+00000180  1d 0f 01 01 ff 04 04 03  02 05 a0 30 1d 06 03 55  |...........0...U|
+00000190  1d 25 04 16 30 14 06 08  2b 06 01 05 05 07 03 01  |.%..0...+.......|
+000001a0  06 08 2b 06 01 05 05 07  03 02 30 0c 06 03 55 1d  |..+.......0...U.|
+000001b0  13 01 01 ff 04 02 30 00  30 19 06 03 55 1d 0e 04  |......0.0...U...|
+000001c0  12 04 10 9f 91 16 1f 43  43 3e 49 a6 de 6d b6 80  |.......CC>I..m..|
+000001d0  d7 9f 60 30 1b 06 03 55  1d 23 04 14 30 12 80 10  |..`0...U.#..0...|
+000001e0  48 13 49 4d 13 7e 16 31  bb a3 01 d5 ac ab 6e 7b  |H.IM.~.1......n{|
+000001f0  30 19 06 03 55 1d 11 04  12 30 10 82 0e 65 78 61  |0...U....0...exa|
+00000200  6d 70 6c 65 2e 67 6f 6c  61 6e 67 30 0d 06 09 2a  |mple.golang0...*|
+00000210  86 48 86 f7 0d 01 01 0b  05 00 03 81 81 00 9d 30  |.H.............0|
+00000220  cc 40 2b 5b 50 a0 61 cb  ba e5 53 58 e1 ed 83 28  |.@+[P.a...SX...(|
+00000230  a9 58 1a a9 38 a4 95 a1  ac 31 5a 1a 84 66 3d 43  |.X..8....1Z..f=C|
+00000240  d3 2d d9 0b f2 97 df d3  20 64 38 92 24 3a 00 bc  |.-...... d8.$:..|
+00000250  cf 9c 7d b7 40 20 01 5f  aa d3 16 61 09 a2 76 fd  |..}.@ ._...a..v.|
+00000260  13 c3 cc e1 0c 5c ee b1  87 82 f1 6c 04 ed 73 bb  |.....\.....l..s.|
+00000270  b3 43 77 8d 0c 1c f1 0f  a1 d8 40 83 61 c9 4c 72  |.Cw.......@.a.Lr|
+00000280  2b 9d ae db 46 06 06 4d  f4 c1 b3 3e c0 d1 bd 42  |+...F..M...>...B|
+00000290  d4 db fe 3d 13 60 84 5c  21 d3 3b e9 fa e7 16 03  |...=.`.\!.;.....|
+000002a0  03 00 cd 0c 00 00 c9 03  00 17 41 04 1e 18 37 ef  |..........A...7.|
+000002b0  0d 19 51 88 35 75 71 b5  e5 54 5b 12 2e 8f 09 67  |..Q.5uq..T[....g|
+000002c0  fd a7 24 20 3e b2 56 1c  ce 97 28 5e f8 2b 2d 4f  |..$ >.V...(^.+-O|
+000002d0  9e f1 07 9f 6c 4b 5b 83  56 e2 32 42 e9 58 b6 d7  |....lK[.V.2B.X..|
+000002e0  49 a6 b5 68 1a 41 03 56  6b dc 5a 89 08 04 00 80  |I..h.A.Vk.Z.....|
+000002f0  ca 2e 5d 9c 99 56 e6 7a  60 e2 b6 65 09 2e 4f ee  |..]..V.z`..e..O.|
+00000300  5d 7f d0 c0 f6 01 fe 62  13 12 14 dd 4d c9 eb e5  |]......b....M...|
+00000310  ee 27 ab 56 77 d1 0b 65  83 96 e5 72 ea 9a 78 85  |.'.Vw..e...r..x.|
+00000320  07 e6 86 bf 58 84 a8 4d  08 4a 56 14 a6 7f 0c 5a  |....X..M.JV....Z|
+00000330  68 3c 6a 9e 0e 2a 70 6a  4f 58 96 45 f2 14 11 45  |h<j..*pjOX.E...E|
+00000340  49 fc b1 0b 13 ff e8 f9  40 71 fb b6 05 ef 88 32  |I.......@q.....2|
+00000350  06 19 e0 e9 9d 97 20 e2  78 0b 4b 4c 71 4a 08 ee  |...... .x.KLqJ..|
+00000360  31 27 ef dd d0 5b d9 32  88 76 51 38 03 00 ba 67  |1'...[.2.vQ8...g|
+00000370  16 03 03 00 04 0e 00 00  00                       |.........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 46 10 00 00  42 41 04 a6 c3 8d d1 32  |....F...BA.....2|
-00000010  8e b4 ac 27 75 4a 57 26  7f 6a 52 a7 82 ee c2 b1  |...'uJW&.jR.....|
-00000020  a3 68 0a 8d 09 ff 82 61  57 f3 32 5e ec 1a 2f 20  |.h.....aW.2^../ |
-00000030  8c c1 d4 cf 27 7b f0 1d  f9 5d f6 24 80 6a 45 d2  |....'{...].$.jE.|
-00000040  97 cf f1 5d a2 e3 b0 15  7d e6 a4 14 03 03 00 01  |...]....}.......|
-00000050  01 16 03 03 00 28 21 36  fe 82 d2 4a b4 da f8 14  |.....(!6...J....|
-00000060  d6 d6 8c be 56 1f ca 82  7f 20 bb 01 be fb 2a 0d  |....V.... ....*.|
-00000070  a8 31 ee 79 f7 8a 8b 4a  1b a7 66 3a 89 67        |.1.y...J..f:.g|
+00000000  16 03 03 00 46 10 00 00  42 41 04 1c 05 a2 39 1b  |....F...BA....9.|
+00000010  b9 e6 ef 38 6d 6f fe 95  0e ef 8d 8a 1b 70 10 b6  |...8mo.......p..|
+00000020  fc 0e 5f ee 0f 6e 08 b6  2d 4f 26 b1 5a af be f8  |.._..n..-O&.Z...|
+00000030  77 72 e4 19 5d a3 91 c6  0c 72 a3 19 9f 20 4f 6e  |wr..]....r... On|
+00000040  75 91 ef 62 4f 1a aa 29  b2 75 6f 14 03 03 00 01  |u..bO..).uo.....|
+00000050  01 16 03 03 00 20 44 af  52 7b ff ca cf 30 ce 71  |..... D.R{...0.q|
+00000060  94 6d 90 2b 6d f3 0e a6  5d 60 15 29 b2 03 81 59  |.m.+m...]`.)...Y|
+00000070  ec 37 a1 cf a5 79                                 |.7...y|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 00 00 00 00 00  |..........(.....|
-00000010  00 00 00 00 0a 97 89 c3  74 09 63 25 2a fc e1 29  |........t.c%*..)|
-00000020  18 b1 bc d6 75 2e 3b 2a  fb 90 17 b9 b8 ea e2 c4  |....u.;*........|
-00000030  29 94 16 17 03 03 00 25  00 00 00 00 00 00 00 01  |)......%........|
-00000040  8c 30 76 b7 fd b1 96 0b  2a 8f f3 e1 b3 38 16 15  |.0v.....*....8..|
-00000050  10 3d 32 ee 29 b5 12 cb  cb cf 98 a3 c5 15 03 03  |.=2.)...........|
-00000060  00 1a 00 00 00 00 00 00  00 02 9e 4a 55 8e 91 ff  |...........JU...|
-00000070  13 0b 56 be 3c 5d b8 26  42 f1 c8 28              |..V.<].&B..(|
+00000000  14 03 03 00 01 01 16 03  03 00 20 af 15 24 30 06  |.......... ..$0.|
+00000010  dd 4c 8b 8a 87 e1 f5 24  ac 36 bc 43 8d 89 20 19  |.L.....$.6.C.. .|
+00000020  04 d2 9c 14 c4 af 24 30  bf ef 1e 17 03 03 00 1d  |......$0........|
+00000030  82 3b 55 e7 67 fe 89 bf  5b c1 7e d6 98 94 36 1f  |.;U.g...[.~...6.|
+00000040  74 f3 34 2b cb 95 48 ed  4d 33 64 b9 ce 15 03 03  |t.4+..H.M3d.....|
+00000050  00 12 ca bf 01 54 b4 c3  b4 f8 04 87 6d 75 ef 8c  |.....T......mu..|
+00000060  c7 9d 1b 1c                                       |....|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-3DES b/src/crypto/tls/testdata/Server-TLSv12-RSA-3DES
index 17a5ad0a98..0298d49ca4 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-3DES
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-3DES
@@ -1,80 +1,78 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 97 01 00 00  93 03 03 e2 8f 43 82 4c  |.............C.L|
-00000010  13 33 88 d2 53 5d b6 02  d2 b6 b2 a1 11 f0 30 14  |.3..S]........0.|
-00000020  41 1e 8c 79 85 38 75 cd  e8 a6 a7 00 00 04 00 0a  |A..y.8u.........|
-00000030  00 ff 01 00 00 66 00 00  00 0e 00 0c 00 00 09 31  |.....f.........1|
-00000040  32 37 2e 30 2e 30 2e 31  00 0b 00 04 03 00 01 02  |27.0.0.1........|
-00000050  00 0a 00 0c 00 0a 00 1d  00 17 00 1e 00 19 00 18  |................|
-00000060  00 16 00 00 00 17 00 00  00 0d 00 30 00 2e 04 03  |...........0....|
-00000070  05 03 06 03 08 07 08 08  08 09 08 0a 08 0b 08 04  |................|
-00000080  08 05 08 06 04 01 05 01  06 01 03 03 02 03 03 01  |................|
-00000090  02 01 03 02 02 02 04 02  05 02 06 02              |............|
+00000000  16 03 01 00 6d 01 00 00  69 03 03 6c 16 54 e2 20  |....m...i..l.T. |
+00000010  da ff dc 37 ae f5 5d e2  77 32 fe 7b 7a cc 31 1f  |...7..].w2.{z.1.|
+00000020  f5 49 6e 75 89 27 b0 aa  67 e7 99 00 00 04 00 0a  |.Inu.'..g.......|
+00000030  00 ff 01 00 00 3c 00 16  00 00 00 17 00 00 00 0d  |.....<..........|
+00000040  00 30 00 2e 04 03 05 03  06 03 08 07 08 08 08 09  |.0..............|
+00000050  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
+00000060  03 03 02 03 03 01 02 01  03 02 02 02 04 02 05 02  |................|
+00000070  06 02                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 37 02 00 00  33 03 03 00 00 00 00 00  |....7...3.......|
+00000000  16 03 03 00 35 02 00 00  31 03 03 00 00 00 00 00  |....5...1.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 00 0a 00 00  |...DOWNGRD......|
-00000030  0b ff 01 00 01 00 00 0b  00 02 01 00 16 03 03 02  |................|
-00000040  59 0b 00 02 55 00 02 52  00 02 4f 30 82 02 4b 30  |Y...U..R..O0..K0|
-00000050  82 01 b4 a0 03 02 01 02  02 09 00 e8 f0 9d 3f e2  |..............?.|
-00000060  5b ea a6 30 0d 06 09 2a  86 48 86 f7 0d 01 01 0b  |[..0...*.H......|
-00000070  05 00 30 1f 31 0b 30 09  06 03 55 04 0a 13 02 47  |..0.1.0...U....G|
-00000080  6f 31 10 30 0e 06 03 55  04 03 13 07 47 6f 20 52  |o1.0...U....Go R|
-00000090  6f 6f 74 30 1e 17 0d 31  36 30 31 30 31 30 30 30  |oot0...160101000|
-000000a0  30 30 30 5a 17 0d 32 35  30 31 30 31 30 30 30 30  |000Z..2501010000|
-000000b0  30 30 5a 30 1a 31 0b 30  09 06 03 55 04 0a 13 02  |00Z0.1.0...U....|
-000000c0  47 6f 31 0b 30 09 06 03  55 04 03 13 02 47 6f 30  |Go1.0...U....Go0|
-000000d0  81 9f 30 0d 06 09 2a 86  48 86 f7 0d 01 01 01 05  |..0...*.H.......|
-000000e0  00 03 81 8d 00 30 81 89  02 81 81 00 db 46 7d 93  |.....0.......F}.|
-000000f0  2e 12 27 06 48 bc 06 28  21 ab 7e c4 b6 a2 5d fe  |..'.H..(!.~...].|
-00000100  1e 52 45 88 7a 36 47 a5  08 0d 92 42 5b c2 81 c0  |.RE.z6G....B[...|
-00000110  be 97 79 98 40 fb 4f 6d  14 fd 2b 13 8b c2 a5 2e  |..y.@.Om..+.....|
-00000120  67 d8 d4 09 9e d6 22 38  b7 4a 0b 74 73 2b c2 34  |g....."8.J.ts+.4|
-00000130  f1 d1 93 e5 96 d9 74 7b  f3 58 9f 6c 61 3c c0 b0  |......t{.X.la<..|
-00000140  41 d4 d9 2b 2b 24 23 77  5b 1c 3b bd 75 5d ce 20  |A..++$#w[.;.u]. |
-00000150  54 cf a1 63 87 1d 1e 24  c4 f3 1d 1a 50 8b aa b6  |T..c...$....P...|
-00000160  14 43 ed 97 a7 75 62 f4  14 c8 52 d7 02 03 01 00  |.C...ub...R.....|
-00000170  01 a3 81 93 30 81 90 30  0e 06 03 55 1d 0f 01 01  |....0..0...U....|
-00000180  ff 04 04 03 02 05 a0 30  1d 06 03 55 1d 25 04 16  |.......0...U.%..|
-00000190  30 14 06 08 2b 06 01 05  05 07 03 01 06 08 2b 06  |0...+.........+.|
-000001a0  01 05 05 07 03 02 30 0c  06 03 55 1d 13 01 01 ff  |......0...U.....|
-000001b0  04 02 30 00 30 19 06 03  55 1d 0e 04 12 04 10 9f  |..0.0...U.......|
-000001c0  91 16 1f 43 43 3e 49 a6  de 6d b6 80 d7 9f 60 30  |...CC>I..m....`0|
-000001d0  1b 06 03 55 1d 23 04 14  30 12 80 10 48 13 49 4d  |...U.#..0...H.IM|
-000001e0  13 7e 16 31 bb a3 01 d5  ac ab 6e 7b 30 19 06 03  |.~.1......n{0...|
-000001f0  55 1d 11 04 12 30 10 82  0e 65 78 61 6d 70 6c 65  |U....0...example|
-00000200  2e 67 6f 6c 61 6e 67 30  0d 06 09 2a 86 48 86 f7  |.golang0...*.H..|
-00000210  0d 01 01 0b 05 00 03 81  81 00 9d 30 cc 40 2b 5b  |...........0.@+[|
-00000220  50 a0 61 cb ba e5 53 58  e1 ed 83 28 a9 58 1a a9  |P.a...SX...(.X..|
-00000230  38 a4 95 a1 ac 31 5a 1a  84 66 3d 43 d3 2d d9 0b  |8....1Z..f=C.-..|
-00000240  f2 97 df d3 20 64 38 92  24 3a 00 bc cf 9c 7d b7  |.... d8.$:....}.|
-00000250  40 20 01 5f aa d3 16 61  09 a2 76 fd 13 c3 cc e1  |@ ._...a..v.....|
-00000260  0c 5c ee b1 87 82 f1 6c  04 ed 73 bb b3 43 77 8d  |.\.....l..s..Cw.|
-00000270  0c 1c f1 0f a1 d8 40 83  61 c9 4c 72 2b 9d ae db  |......@.a.Lr+...|
-00000280  46 06 06 4d f4 c1 b3 3e  c0 d1 bd 42 d4 db fe 3d  |F..M...>...B...=|
-00000290  13 60 84 5c 21 d3 3b e9  fa e7 16 03 03 00 04 0e  |.`.\!.;.........|
-000002a0  00 00 00                                          |...|
+00000030  09 ff 01 00 01 00 00 17  00 00 16 03 03 02 59 0b  |..............Y.|
+00000040  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
+00000050  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
+00000060  a6 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |.0...*.H........|
+00000070  30 1f 31 0b 30 09 06 03  55 04 0a 13 02 47 6f 31  |0.1.0...U....Go1|
+00000080  10 30 0e 06 03 55 04 03  13 07 47 6f 20 52 6f 6f  |.0...U....Go Roo|
+00000090  74 30 1e 17 0d 31 36 30  31 30 31 30 30 30 30 30  |t0...16010100000|
+000000a0  30 5a 17 0d 32 35 30 31  30 31 30 30 30 30 30 30  |0Z..250101000000|
+000000b0  5a 30 1a 31 0b 30 09 06  03 55 04 0a 13 02 47 6f  |Z0.1.0...U....Go|
+000000c0  31 0b 30 09 06 03 55 04  03 13 02 47 6f 30 81 9f  |1.0...U....Go0..|
+000000d0  30 0d 06 09 2a 86 48 86  f7 0d 01 01 01 05 00 03  |0...*.H.........|
+000000e0  81 8d 00 30 81 89 02 81  81 00 db 46 7d 93 2e 12  |...0.......F}...|
+000000f0  27 06 48 bc 06 28 21 ab  7e c4 b6 a2 5d fe 1e 52  |'.H..(!.~...]..R|
+00000100  45 88 7a 36 47 a5 08 0d  92 42 5b c2 81 c0 be 97  |E.z6G....B[.....|
+00000110  79 98 40 fb 4f 6d 14 fd  2b 13 8b c2 a5 2e 67 d8  |y.@.Om..+.....g.|
+00000120  d4 09 9e d6 22 38 b7 4a  0b 74 73 2b c2 34 f1 d1  |...."8.J.ts+.4..|
+00000130  93 e5 96 d9 74 7b f3 58  9f 6c 61 3c c0 b0 41 d4  |....t{.X.la<..A.|
+00000140  d9 2b 2b 24 23 77 5b 1c  3b bd 75 5d ce 20 54 cf  |.++$#w[.;.u]. T.|
+00000150  a1 63 87 1d 1e 24 c4 f3  1d 1a 50 8b aa b6 14 43  |.c...$....P....C|
+00000160  ed 97 a7 75 62 f4 14 c8  52 d7 02 03 01 00 01 a3  |...ub...R.......|
+00000170  81 93 30 81 90 30 0e 06  03 55 1d 0f 01 01 ff 04  |..0..0...U......|
+00000180  04 03 02 05 a0 30 1d 06  03 55 1d 25 04 16 30 14  |.....0...U.%..0.|
+00000190  06 08 2b 06 01 05 05 07  03 01 06 08 2b 06 01 05  |..+.........+...|
+000001a0  05 07 03 02 30 0c 06 03  55 1d 13 01 01 ff 04 02  |....0...U.......|
+000001b0  30 00 30 19 06 03 55 1d  0e 04 12 04 10 9f 91 16  |0.0...U.........|
+000001c0  1f 43 43 3e 49 a6 de 6d  b6 80 d7 9f 60 30 1b 06  |.CC>I..m....`0..|
+000001d0  03 55 1d 23 04 14 30 12  80 10 48 13 49 4d 13 7e  |.U.#..0...H.IM.~|
+000001e0  16 31 bb a3 01 d5 ac ab  6e 7b 30 19 06 03 55 1d  |.1......n{0...U.|
+000001f0  11 04 12 30 10 82 0e 65  78 61 6d 70 6c 65 2e 67  |...0...example.g|
+00000200  6f 6c 61 6e 67 30 0d 06  09 2a 86 48 86 f7 0d 01  |olang0...*.H....|
+00000210  01 0b 05 00 03 81 81 00  9d 30 cc 40 2b 5b 50 a0  |.........0.@+[P.|
+00000220  61 cb ba e5 53 58 e1 ed  83 28 a9 58 1a a9 38 a4  |a...SX...(.X..8.|
+00000230  95 a1 ac 31 5a 1a 84 66  3d 43 d3 2d d9 0b f2 97  |...1Z..f=C.-....|
+00000240  df d3 20 64 38 92 24 3a  00 bc cf 9c 7d b7 40 20  |.. d8.$:....}.@ |
+00000250  01 5f aa d3 16 61 09 a2  76 fd 13 c3 cc e1 0c 5c  |._...a..v......\|
+00000260  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
+00000270  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
+00000280  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
+00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 04 0e 00 00  |.\!.;...........|
+000002a0  00                                                |.|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 57 ce 41 c0 4d  |...........W.A.M|
-00000010  b1 69 27 6e cb 92 a5 71  52 85 e7 a8 69 b0 31 d1  |.i'n...qR...i.1.|
-00000020  0a b0 3d a6 9d ab 04 e8  a2 4c d8 67 95 97 da 63  |..=......L.g...c|
-00000030  f7 0b 6e 62 29 5b 8b cf  77 f1 80 a5 1f 67 08 71  |..nb)[..w....g.q|
-00000040  50 c3 a9 90 ea b8 11 3d  5d c9 f5 1c 37 fa 67 b1  |P......=]...7.g.|
-00000050  64 b0 04 3e c1 0d db 77  fe b9 a0 ea f2 0f 1d af  |d..>...w........|
-00000060  9a 77 b3 96 4f 3f 3c 52  a7 ed c4 3f 48 ef ff f8  |.w..O?<R...?H...|
-00000070  38 f6 34 60 5a 29 12 37  85 23 1c 39 8e 1a a7 2f  |8.4`Z).7.#.9.../|
-00000080  68 39 1f 37 ed 08 a8 a5  b2 c1 f0 14 03 03 00 01  |h9.7............|
-00000090  01 16 03 03 00 30 8d 64  b1 cb 97 76 8a 78 08 d1  |.....0.d...v.x..|
-000000a0  c0 af 60 9c 0d f0 ae 41  93 f4 97 2b 46 f7 65 52  |..`....A...+F.eR|
-000000b0  55 a7 90 4a 83 47 cc e4  51 29 0d 6e 0b 42 52 c2  |U..J.G..Q).n.BR.|
-000000c0  bf 13 b8 01 72 d3                                 |....r.|
+00000000  16 03 03 00 86 10 00 00  82 00 80 bc bb c4 2a df  |..............*.|
+00000010  56 75 8b 3e e1 cd 12 f8  58 29 4d 4d ab f0 12 0c  |Vu.>....X)MM....|
+00000020  d7 20 3b cb d5 68 5e c1  a4 03 89 f7 d4 f4 ee c9  |. ;..h^.........|
+00000030  38 8e bb 42 de e4 fb c6  9f df db 7f af 6c ae b5  |8..B.........l..|
+00000040  6a 99 70 3c 1e 88 38 22  aa 1e 81 51 1e 7d 36 31  |j.p<..8"...Q.}61|
+00000050  4e d2 a9 08 c0 bc 11 d8  27 41 26 75 f3 35 74 74  |N.......'A&u.5tt|
+00000060  ef 50 0e 2b bd da 41 ed  81 56 b9 e4 13 74 e9 80  |.P.+..A..V...t..|
+00000070  9f a2 90 d1 fd 85 26 02  f3 aa 75 53 d9 58 bc 2f  |......&...uS.X./|
+00000080  3b e5 60 cb f8 ac e6 32  6e 5f 80 14 03 03 00 01  |;.`....2n_......|
+00000090  01 16 03 03 00 30 8c e6  a6 6a 76 aa 84 32 0c 6b  |.....0...jv..2.k|
+000000a0  17 41 9d 56 46 46 5c 34  a1 37 d5 7f e6 ab 55 de  |.A.VFF\4.7....U.|
+000000b0  70 54 69 0a 6d 18 1c 14  87 ee 73 8b f9 57 37 2f  |pTi.m.....s..W7/|
+000000c0  2e bb 07 4c f1 a9                                 |...L..|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 30 00 00 00 00 00  |..........0.....|
-00000010  00 00 00 0d 0f 3c 6a 28  f0 97 90 1a c3 7e c8 63  |.....<j(.....~.c|
-00000020  15 75 1b 71 c8 bb 7d 83  b0 9b a6 73 3d 3d 51 7a  |.u.q..}....s==Qz|
-00000030  52 5b e4 33 16 93 40 23  43 7c a2 17 03 03 00 30  |R[.3..@#C|.....0|
-00000040  00 00 00 00 00 00 00 00  be db 1d 03 aa 15 53 49  |..............SI|
-00000050  a3 57 00 24 75 3a b1 48  71 ec d9 7d e1 40 5c dc  |.W.$u:.Hq..}.@\.|
-00000060  fd f5 33 6f 6b c7 3e 9e  2e 05 af 1b 12 73 75 8c  |..3ok.>......su.|
-00000070  15 03 03 00 20 00 00 00  00 00 00 00 00 5c 30 63  |.... ........\0c|
-00000080  23 55 26 ee 8d 81 9a 2e  b4 e7 38 6b 04 e7 42 43  |#U&.......8k..BC|
-00000090  50 de 1e 40 2d                                    |P..@-|
+00000010  00 00 00 49 b9 2a 89 cb  6e 15 d4 a6 f7 24 a5 3a  |...I.*..n....$.:|
+00000020  da f3 5b ac ff 43 a2 a6  5b 27 36 9c 6d 55 ba c8  |..[..C..['6.mU..|
+00000030  f4 77 f7 44 8c bc a7 5e  3f c6 59 17 03 03 00 30  |.w.D...^?.Y....0|
+00000040  00 00 00 00 00 00 00 00  44 44 d7 76 36 88 a6 84  |........DD.v6...|
+00000050  02 27 40 d6 d1 bb a5 20  41 d5 06 66 3a 56 05 94  |.'@.... A..f:V..|
+00000060  41 97 fc 85 95 70 28 85  7a 7a ce 43 71 5d ad a8  |A....p(.zz.Cq]..|
+00000070  15 03 03 00 20 00 00 00  00 00 00 00 00 8e 63 57  |.... .........cW|
+00000080  61 6d c1 0b ca ea 89 9e  b4 9e 6d fb 9f 3b 2a fc  |am........m..;*.|
+00000090  a0 56 d1 21 5d                                    |.V.!]|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES
index 0196e21637..68a1cb1bc3 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES
@@ -1,84 +1,82 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 97 01 00 00  93 03 03 dd 28 eb 68 4a  |............(.hJ|
-00000010  8a 71 d2 98 d0 2d 21 c7  e9 19 19 de c8 13 0b 67  |.q...-!........g|
-00000020  f4 ff 4c d0 37 f5 72 9f  2d fb b3 00 00 04 00 2f  |..L.7.r.-....../|
-00000030  00 ff 01 00 00 66 00 00  00 0e 00 0c 00 00 09 31  |.....f.........1|
-00000040  32 37 2e 30 2e 30 2e 31  00 0b 00 04 03 00 01 02  |27.0.0.1........|
-00000050  00 0a 00 0c 00 0a 00 1d  00 17 00 1e 00 19 00 18  |................|
-00000060  00 16 00 00 00 17 00 00  00 0d 00 30 00 2e 04 03  |...........0....|
-00000070  05 03 06 03 08 07 08 08  08 09 08 0a 08 0b 08 04  |................|
-00000080  08 05 08 06 04 01 05 01  06 01 03 03 02 03 03 01  |................|
-00000090  02 01 03 02 02 02 04 02  05 02 06 02              |............|
+00000000  16 03 01 00 6d 01 00 00  69 03 03 0a b6 18 8a 8f  |....m...i.......|
+00000010  90 e2 fb ee cd e3 d5 62  53 17 45 bd b3 7f 53 4d  |.......bS.E...SM|
+00000020  4e 06 62 66 25 60 b1 3f  96 b0 21 00 00 04 00 2f  |N.bf%`.?..!..../|
+00000030  00 ff 01 00 00 3c 00 16  00 00 00 17 00 00 00 0d  |.....<..........|
+00000040  00 30 00 2e 04 03 05 03  06 03 08 07 08 08 08 09  |.0..............|
+00000050  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
+00000060  03 03 02 03 03 01 02 01  03 02 02 02 04 02 05 02  |................|
+00000070  06 02                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 37 02 00 00  33 03 03 00 00 00 00 00  |....7...3.......|
+00000000  16 03 03 00 35 02 00 00  31 03 03 00 00 00 00 00  |....5...1.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 00 2f 00 00  |...DOWNGRD.../..|
-00000030  0b ff 01 00 01 00 00 0b  00 02 01 00 16 03 03 02  |................|
-00000040  59 0b 00 02 55 00 02 52  00 02 4f 30 82 02 4b 30  |Y...U..R..O0..K0|
-00000050  82 01 b4 a0 03 02 01 02  02 09 00 e8 f0 9d 3f e2  |..............?.|
-00000060  5b ea a6 30 0d 06 09 2a  86 48 86 f7 0d 01 01 0b  |[..0...*.H......|
-00000070  05 00 30 1f 31 0b 30 09  06 03 55 04 0a 13 02 47  |..0.1.0...U....G|
-00000080  6f 31 10 30 0e 06 03 55  04 03 13 07 47 6f 20 52  |o1.0...U....Go R|
-00000090  6f 6f 74 30 1e 17 0d 31  36 30 31 30 31 30 30 30  |oot0...160101000|
-000000a0  30 30 30 5a 17 0d 32 35  30 31 30 31 30 30 30 30  |000Z..2501010000|
-000000b0  30 30 5a 30 1a 31 0b 30  09 06 03 55 04 0a 13 02  |00Z0.1.0...U....|
-000000c0  47 6f 31 0b 30 09 06 03  55 04 03 13 02 47 6f 30  |Go1.0...U....Go0|
-000000d0  81 9f 30 0d 06 09 2a 86  48 86 f7 0d 01 01 01 05  |..0...*.H.......|
-000000e0  00 03 81 8d 00 30 81 89  02 81 81 00 db 46 7d 93  |.....0.......F}.|
-000000f0  2e 12 27 06 48 bc 06 28  21 ab 7e c4 b6 a2 5d fe  |..'.H..(!.~...].|
-00000100  1e 52 45 88 7a 36 47 a5  08 0d 92 42 5b c2 81 c0  |.RE.z6G....B[...|
-00000110  be 97 79 98 40 fb 4f 6d  14 fd 2b 13 8b c2 a5 2e  |..y.@.Om..+.....|
-00000120  67 d8 d4 09 9e d6 22 38  b7 4a 0b 74 73 2b c2 34  |g....."8.J.ts+.4|
-00000130  f1 d1 93 e5 96 d9 74 7b  f3 58 9f 6c 61 3c c0 b0  |......t{.X.la<..|
-00000140  41 d4 d9 2b 2b 24 23 77  5b 1c 3b bd 75 5d ce 20  |A..++$#w[.;.u]. |
-00000150  54 cf a1 63 87 1d 1e 24  c4 f3 1d 1a 50 8b aa b6  |T..c...$....P...|
-00000160  14 43 ed 97 a7 75 62 f4  14 c8 52 d7 02 03 01 00  |.C...ub...R.....|
-00000170  01 a3 81 93 30 81 90 30  0e 06 03 55 1d 0f 01 01  |....0..0...U....|
-00000180  ff 04 04 03 02 05 a0 30  1d 06 03 55 1d 25 04 16  |.......0...U.%..|
-00000190  30 14 06 08 2b 06 01 05  05 07 03 01 06 08 2b 06  |0...+.........+.|
-000001a0  01 05 05 07 03 02 30 0c  06 03 55 1d 13 01 01 ff  |......0...U.....|
-000001b0  04 02 30 00 30 19 06 03  55 1d 0e 04 12 04 10 9f  |..0.0...U.......|
-000001c0  91 16 1f 43 43 3e 49 a6  de 6d b6 80 d7 9f 60 30  |...CC>I..m....`0|
-000001d0  1b 06 03 55 1d 23 04 14  30 12 80 10 48 13 49 4d  |...U.#..0...H.IM|
-000001e0  13 7e 16 31 bb a3 01 d5  ac ab 6e 7b 30 19 06 03  |.~.1......n{0...|
-000001f0  55 1d 11 04 12 30 10 82  0e 65 78 61 6d 70 6c 65  |U....0...example|
-00000200  2e 67 6f 6c 61 6e 67 30  0d 06 09 2a 86 48 86 f7  |.golang0...*.H..|
-00000210  0d 01 01 0b 05 00 03 81  81 00 9d 30 cc 40 2b 5b  |...........0.@+[|
-00000220  50 a0 61 cb ba e5 53 58  e1 ed 83 28 a9 58 1a a9  |P.a...SX...(.X..|
-00000230  38 a4 95 a1 ac 31 5a 1a  84 66 3d 43 d3 2d d9 0b  |8....1Z..f=C.-..|
-00000240  f2 97 df d3 20 64 38 92  24 3a 00 bc cf 9c 7d b7  |.... d8.$:....}.|
-00000250  40 20 01 5f aa d3 16 61  09 a2 76 fd 13 c3 cc e1  |@ ._...a..v.....|
-00000260  0c 5c ee b1 87 82 f1 6c  04 ed 73 bb b3 43 77 8d  |.\.....l..s..Cw.|
-00000270  0c 1c f1 0f a1 d8 40 83  61 c9 4c 72 2b 9d ae db  |......@.a.Lr+...|
-00000280  46 06 06 4d f4 c1 b3 3e  c0 d1 bd 42 d4 db fe 3d  |F..M...>...B...=|
-00000290  13 60 84 5c 21 d3 3b e9  fa e7 16 03 03 00 04 0e  |.`.\!.;.........|
-000002a0  00 00 00                                          |...|
+00000030  09 ff 01 00 01 00 00 17  00 00 16 03 03 02 59 0b  |..............Y.|
+00000040  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
+00000050  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
+00000060  a6 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |.0...*.H........|
+00000070  30 1f 31 0b 30 09 06 03  55 04 0a 13 02 47 6f 31  |0.1.0...U....Go1|
+00000080  10 30 0e 06 03 55 04 03  13 07 47 6f 20 52 6f 6f  |.0...U....Go Roo|
+00000090  74 30 1e 17 0d 31 36 30  31 30 31 30 30 30 30 30  |t0...16010100000|
+000000a0  30 5a 17 0d 32 35 30 31  30 31 30 30 30 30 30 30  |0Z..250101000000|
+000000b0  5a 30 1a 31 0b 30 09 06  03 55 04 0a 13 02 47 6f  |Z0.1.0...U....Go|
+000000c0  31 0b 30 09 06 03 55 04  03 13 02 47 6f 30 81 9f  |1.0...U....Go0..|
+000000d0  30 0d 06 09 2a 86 48 86  f7 0d 01 01 01 05 00 03  |0...*.H.........|
+000000e0  81 8d 00 30 81 89 02 81  81 00 db 46 7d 93 2e 12  |...0.......F}...|
+000000f0  27 06 48 bc 06 28 21 ab  7e c4 b6 a2 5d fe 1e 52  |'.H..(!.~...]..R|
+00000100  45 88 7a 36 47 a5 08 0d  92 42 5b c2 81 c0 be 97  |E.z6G....B[.....|
+00000110  79 98 40 fb 4f 6d 14 fd  2b 13 8b c2 a5 2e 67 d8  |y.@.Om..+.....g.|
+00000120  d4 09 9e d6 22 38 b7 4a  0b 74 73 2b c2 34 f1 d1  |...."8.J.ts+.4..|
+00000130  93 e5 96 d9 74 7b f3 58  9f 6c 61 3c c0 b0 41 d4  |....t{.X.la<..A.|
+00000140  d9 2b 2b 24 23 77 5b 1c  3b bd 75 5d ce 20 54 cf  |.++$#w[.;.u]. T.|
+00000150  a1 63 87 1d 1e 24 c4 f3  1d 1a 50 8b aa b6 14 43  |.c...$....P....C|
+00000160  ed 97 a7 75 62 f4 14 c8  52 d7 02 03 01 00 01 a3  |...ub...R.......|
+00000170  81 93 30 81 90 30 0e 06  03 55 1d 0f 01 01 ff 04  |..0..0...U......|
+00000180  04 03 02 05 a0 30 1d 06  03 55 1d 25 04 16 30 14  |.....0...U.%..0.|
+00000190  06 08 2b 06 01 05 05 07  03 01 06 08 2b 06 01 05  |..+.........+...|
+000001a0  05 07 03 02 30 0c 06 03  55 1d 13 01 01 ff 04 02  |....0...U.......|
+000001b0  30 00 30 19 06 03 55 1d  0e 04 12 04 10 9f 91 16  |0.0...U.........|
+000001c0  1f 43 43 3e 49 a6 de 6d  b6 80 d7 9f 60 30 1b 06  |.CC>I..m....`0..|
+000001d0  03 55 1d 23 04 14 30 12  80 10 48 13 49 4d 13 7e  |.U.#..0...H.IM.~|
+000001e0  16 31 bb a3 01 d5 ac ab  6e 7b 30 19 06 03 55 1d  |.1......n{0...U.|
+000001f0  11 04 12 30 10 82 0e 65  78 61 6d 70 6c 65 2e 67  |...0...example.g|
+00000200  6f 6c 61 6e 67 30 0d 06  09 2a 86 48 86 f7 0d 01  |olang0...*.H....|
+00000210  01 0b 05 00 03 81 81 00  9d 30 cc 40 2b 5b 50 a0  |.........0.@+[P.|
+00000220  61 cb ba e5 53 58 e1 ed  83 28 a9 58 1a a9 38 a4  |a...SX...(.X..8.|
+00000230  95 a1 ac 31 5a 1a 84 66  3d 43 d3 2d d9 0b f2 97  |...1Z..f=C.-....|
+00000240  df d3 20 64 38 92 24 3a  00 bc cf 9c 7d b7 40 20  |.. d8.$:....}.@ |
+00000250  01 5f aa d3 16 61 09 a2  76 fd 13 c3 cc e1 0c 5c  |._...a..v......\|
+00000260  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
+00000270  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
+00000280  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
+00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 04 0e 00 00  |.\!.;...........|
+000002a0  00                                                |.|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 c0 37 ef f3 d9  |............7...|
-00000010  6b 7b 3f c4 9f 46 d2 6b  8f 7f 8d ce 89 cf 8e 2b  |k{?..F.k.......+|
-00000020  1f 0d 86 f9 90 5a 23 28  6c d3 14 ce 2a 0b f1 0e  |.....Z#(l...*...|
-00000030  96 1c 11 7d c0 b8 fb 4b  2e cb 07 1c fe b9 e1 62  |...}...K.......b|
-00000040  2c 38 1c 46 21 74 23 a9  f2 0b 15 36 ef 88 32 e8  |,8.F!t#....6..2.|
-00000050  28 66 8e ab 14 be e9 02  04 9d 92 99 cc 6e 28 d0  |(f...........n(.|
-00000060  f9 3d dc 61 7f f7 17 59  ab 1c 86 94 9a 28 7b 46  |.=.a...Y.....({F|
-00000070  3c 36 ff d3 26 3c ad 2d  33 ef 99 83 09 a5 a8 2f  |<6..&<.-3....../|
-00000080  b3 a3 74 7f 49 a3 f1 47  7d 8c 12 14 03 03 00 01  |..t.I..G}.......|
-00000090  01 16 03 03 00 40 32 68  cb ea 32 cb f2 7a 0e 4b  |.....@2h..2..z.K|
-000000a0  63 72 96 93 e8 2d 5b 22  a6 3a 05 9d 60 50 e5 d0  |cr...-[".:..`P..|
-000000b0  f3 f8 14 ed 81 fe 17 a0  ee 3f 7b aa ca dc 06 bc  |.........?{.....|
-000000c0  28 90 73 33 84 0c 92 39  b7 cb da 06 08 05 0b 03  |(.s3...9........|
-000000d0  86 be cc 70 0e c2                                 |...p..|
+00000000  16 03 03 00 86 10 00 00  82 00 80 19 dc d4 4c b0  |..............L.|
+00000010  5c 30 24 b8 fd e1 cd 4e  af bc c3 f5 78 12 8c 51  |\0$....N....x..Q|
+00000020  a9 a9 ab fd 87 72 a4 bc  0c fc 87 5e 1d af 67 02  |.....r.....^..g.|
+00000030  13 c5 c2 8c 00 5f 33 d1  86 43 50 b3 3a 1d b8 69  |....._3..CP.:..i|
+00000040  b1 2f ce 82 cd 8d 31 0d  15 c1 fb af b3 47 64 57  |./....1......GdW|
+00000050  38 24 33 46 03 d5 ba 33  36 a0 eb de 21 2b ae 64  |8$3F...36...!+.d|
+00000060  cc 0c 43 fe a3 7b 34 a1  d2 de d5 85 ec ac c7 0d  |..C..{4.........|
+00000070  04 ec 63 62 ab fe 86 ba  e9 ee 31 2c 09 84 13 6a  |..cb......1,...j|
+00000080  10 bc 0f 71 93 9d e8 c4  e3 f6 a9 14 03 03 00 01  |...q............|
+00000090  01 16 03 03 00 40 b7 75  28 6e 6b 9a 60 8f fc 5b  |.....@.u(nk.`..[|
+000000a0  91 0a 16 54 ec b1 4b 55  b8 b2 5c 53 48 92 aa dc  |...T..KU..\SH...|
+000000b0  55 64 2c b0 dc 77 b4 6f  7a a9 23 9c 44 8b 74 64  |Ud,..w.oz.#.D.td|
+000000c0  c5 28 ea c7 8d 97 9b c8  a3 ec 11 d7 93 81 08 20  |.(............. |
+000000d0  9c 2f 79 32 92 45                                 |./y2.E|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 10 a0 48 48 86  |.............HH.|
-00000020  ac 1f f4 05 4d 12 9d 90  54 26 ec c8 1f 6d e7 d5  |....M...T&...m..|
-00000030  0c 92 61 88 2f 43 77 75  0c 08 0f 33 ac c3 d3 b0  |..a./Cwu...3....|
-00000040  94 68 e3 3f 9f c9 43 a5  8b ee ed 17 03 03 00 40  |.h.?..C........@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 92 50 e8 02 a0  |............P...|
+00000020  14 d6 03 5d db bb 29 21  09 a3 71 08 54 f3 5e 7c  |...]..)!..q.T.^||
+00000030  9a 64 18 f3 4f 64 84 4d  b7 e9 82 a8 2c 3b 46 70  |.d..Od.M....,;Fp|
+00000040  cb cb de b5 e3 c3 12 d5  7b 6f 08 17 03 03 00 40  |........{o.....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  fd 7d d3 d6 3f a5 10 37  a1 93 20 ca c8 8c 9d c3  |.}..?..7.. .....|
-00000070  90 df 2f 40 e6 83 af b6  be e4 3d 07 ff 0d 24 97  |../@......=...$.|
-00000080  c2 ff af 81 eb b5 91 72  6b 6d 70 8c af 3f 9f 76  |.......rkmp..?.v|
+00000060  4f 4f fe dd e5 b1 38 6b  b1 2f 5d 23 8b b2 34 b1  |OO....8k./]#..4.|
+00000070  c6 9f 8d 32 83 5f b5 36  0b df a6 aa 3f 90 30 b7  |...2._.6....?.0.|
+00000080  1d 66 26 89 29 ab 71 dc  00 14 d6 8e 7e 47 bd ee  |.f&.).q.....~G..|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 6b 80 aa  88 45 8c 39 a8 4c ca 33  |.....k...E.9.L.3|
-000000b0  f2 33 85 a0 74 6a 64 a3  43 17 4c 5c 9b 50 e5 8d  |.3..tjd.C.L\.P..|
-000000c0  ff 26 03 e1 07                                    |.&...|
+000000a0  00 00 00 00 00 e3 72 e5  7c 8c c6 f5 72 ba 37 52  |......r.|...r.7R|
+000000b0  be 38 a0 a2 62 71 d9 f6  a2 9e b5 4a af 0f 13 3e  |.8..bq.....J...>|
+000000c0  3c 85 ab ea eb                                    |<....|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM
index fa4b47b576..8d8c3b4022 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM
@@ -1,82 +1,81 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 97 01 00 00  93 03 03 8a ca f1 8f ad  |................|
-00000010  fe 0b a3 e1 b8 08 10 1a  40 57 b6 f7 f7 e3 72 c4  |........@W....r.|
-00000020  57 4a 71 f8 30 cd 62 62  c7 0f 2d 00 00 04 c0 2f  |WJq.0.bb..-..../|
-00000030  00 ff 01 00 00 66 00 00  00 0e 00 0c 00 00 09 31  |.....f.........1|
-00000040  32 37 2e 30 2e 30 2e 31  00 0b 00 04 03 00 01 02  |27.0.0.1........|
-00000050  00 0a 00 0c 00 0a 00 1d  00 17 00 1e 00 19 00 18  |................|
-00000060  00 16 00 00 00 17 00 00  00 0d 00 30 00 2e 04 03  |...........0....|
-00000070  05 03 06 03 08 07 08 08  08 09 08 0a 08 0b 08 04  |................|
-00000080  08 05 08 06 04 01 05 01  06 01 03 03 02 03 03 01  |................|
-00000090  02 01 03 02 02 02 04 02  05 02 06 02              |............|
+00000000  16 03 01 00 85 01 00 00  81 03 03 6e 70 d5 90 98  |...........np...|
+00000010  0a 70 40 22 4f 31 e8 7d  a0 81 bd 22 e8 4e 97 8b  |.p@"O1.}...".N..|
+00000020  4d bb 3d d1 d6 2f 09 b9  bd 2f 43 00 00 04 c0 2f  |M.=../.../C..../|
+00000030  00 ff 01 00 00 54 00 0b  00 04 03 00 01 02 00 0a  |.....T..........|
+00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
+00000050  00 00 00 17 00 00 00 0d  00 30 00 2e 04 03 05 03  |.........0......|
+00000060  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
+00000070  08 06 04 01 05 01 06 01  03 03 02 03 03 01 02 01  |................|
+00000080  03 02 02 02 04 02 05 02  06 02                    |..........|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 37 02 00 00  33 03 03 00 00 00 00 00  |....7...3.......|
+00000000  16 03 03 00 3b 02 00 00  37 03 03 00 00 00 00 00  |....;...7.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 c0 2f 00 00  |...DOWNGRD.../..|
-00000030  0b ff 01 00 01 00 00 0b  00 02 01 00 16 03 03 02  |................|
-00000040  59 0b 00 02 55 00 02 52  00 02 4f 30 82 02 4b 30  |Y...U..R..O0..K0|
-00000050  82 01 b4 a0 03 02 01 02  02 09 00 e8 f0 9d 3f e2  |..............?.|
-00000060  5b ea a6 30 0d 06 09 2a  86 48 86 f7 0d 01 01 0b  |[..0...*.H......|
-00000070  05 00 30 1f 31 0b 30 09  06 03 55 04 0a 13 02 47  |..0.1.0...U....G|
-00000080  6f 31 10 30 0e 06 03 55  04 03 13 07 47 6f 20 52  |o1.0...U....Go R|
-00000090  6f 6f 74 30 1e 17 0d 31  36 30 31 30 31 30 30 30  |oot0...160101000|
-000000a0  30 30 30 5a 17 0d 32 35  30 31 30 31 30 30 30 30  |000Z..2501010000|
-000000b0  30 30 5a 30 1a 31 0b 30  09 06 03 55 04 0a 13 02  |00Z0.1.0...U....|
-000000c0  47 6f 31 0b 30 09 06 03  55 04 03 13 02 47 6f 30  |Go1.0...U....Go0|
-000000d0  81 9f 30 0d 06 09 2a 86  48 86 f7 0d 01 01 01 05  |..0...*.H.......|
-000000e0  00 03 81 8d 00 30 81 89  02 81 81 00 db 46 7d 93  |.....0.......F}.|
-000000f0  2e 12 27 06 48 bc 06 28  21 ab 7e c4 b6 a2 5d fe  |..'.H..(!.~...].|
-00000100  1e 52 45 88 7a 36 47 a5  08 0d 92 42 5b c2 81 c0  |.RE.z6G....B[...|
-00000110  be 97 79 98 40 fb 4f 6d  14 fd 2b 13 8b c2 a5 2e  |..y.@.Om..+.....|
-00000120  67 d8 d4 09 9e d6 22 38  b7 4a 0b 74 73 2b c2 34  |g....."8.J.ts+.4|
-00000130  f1 d1 93 e5 96 d9 74 7b  f3 58 9f 6c 61 3c c0 b0  |......t{.X.la<..|
-00000140  41 d4 d9 2b 2b 24 23 77  5b 1c 3b bd 75 5d ce 20  |A..++$#w[.;.u]. |
-00000150  54 cf a1 63 87 1d 1e 24  c4 f3 1d 1a 50 8b aa b6  |T..c...$....P...|
-00000160  14 43 ed 97 a7 75 62 f4  14 c8 52 d7 02 03 01 00  |.C...ub...R.....|
-00000170  01 a3 81 93 30 81 90 30  0e 06 03 55 1d 0f 01 01  |....0..0...U....|
-00000180  ff 04 04 03 02 05 a0 30  1d 06 03 55 1d 25 04 16  |.......0...U.%..|
-00000190  30 14 06 08 2b 06 01 05  05 07 03 01 06 08 2b 06  |0...+.........+.|
-000001a0  01 05 05 07 03 02 30 0c  06 03 55 1d 13 01 01 ff  |......0...U.....|
-000001b0  04 02 30 00 30 19 06 03  55 1d 0e 04 12 04 10 9f  |..0.0...U.......|
-000001c0  91 16 1f 43 43 3e 49 a6  de 6d b6 80 d7 9f 60 30  |...CC>I..m....`0|
-000001d0  1b 06 03 55 1d 23 04 14  30 12 80 10 48 13 49 4d  |...U.#..0...H.IM|
-000001e0  13 7e 16 31 bb a3 01 d5  ac ab 6e 7b 30 19 06 03  |.~.1......n{0...|
-000001f0  55 1d 11 04 12 30 10 82  0e 65 78 61 6d 70 6c 65  |U....0...example|
-00000200  2e 67 6f 6c 61 6e 67 30  0d 06 09 2a 86 48 86 f7  |.golang0...*.H..|
-00000210  0d 01 01 0b 05 00 03 81  81 00 9d 30 cc 40 2b 5b  |...........0.@+[|
-00000220  50 a0 61 cb ba e5 53 58  e1 ed 83 28 a9 58 1a a9  |P.a...SX...(.X..|
-00000230  38 a4 95 a1 ac 31 5a 1a  84 66 3d 43 d3 2d d9 0b  |8....1Z..f=C.-..|
-00000240  f2 97 df d3 20 64 38 92  24 3a 00 bc cf 9c 7d b7  |.... d8.$:....}.|
-00000250  40 20 01 5f aa d3 16 61  09 a2 76 fd 13 c3 cc e1  |@ ._...a..v.....|
-00000260  0c 5c ee b1 87 82 f1 6c  04 ed 73 bb b3 43 77 8d  |.\.....l..s..Cw.|
-00000270  0c 1c f1 0f a1 d8 40 83  61 c9 4c 72 2b 9d ae db  |......@.a.Lr+...|
-00000280  46 06 06 4d f4 c1 b3 3e  c0 d1 bd 42 d4 db fe 3d  |F..M...>...B...=|
-00000290  13 60 84 5c 21 d3 3b e9  fa e7 16 03 03 00 ac 0c  |.`.\!.;.........|
-000002a0  00 00 a8 03 00 1d 20 2f  e5 7d a3 47 cd 62 43 15  |...... /.}.G.bC.|
-000002b0  28 da ac 5f bb 29 07 30  ff f6 84 af c4 cf c2 ed  |(.._.).0........|
-000002c0  90 99 5f 58 cb 3b 74 08  04 00 80 50 0b d9 1c 03  |.._X.;t....P....|
-000002d0  6f 08 05 a6 39 cc 9f 7e  3d f1 fb af 8e 0b 9a ef  |o...9..~=.......|
-000002e0  39 d3 b6 e3 71 9c 5a 37  a1 86 f2 f0 59 01 fc b2  |9...q.Z7....Y...|
-000002f0  51 1c 0e 22 42 24 3e c6  db fb a1 39 9d 75 f4 79  |Q.."B$>....9.u.y|
-00000300  55 dd e5 99 0b 22 5b ed  c7 19 ac db ed d3 ee 23  |U...."[........#|
-00000310  b9 37 2b 51 ea 7f 39 4d  8b 0a bc a2 2e f2 ef 9e  |.7+Q..9M........|
-00000320  a5 8c 99 77 ff d2 fb 46  e4 10 4e a9 b2 a9 ce b6  |...w...F..N.....|
-00000330  50 d4 0a 28 a5 3f 0e 2c  60 cd 0f 07 9c 7e 60 c3  |P..(.?.,`....~`.|
-00000340  79 a5 cf f3 cd 77 5a 16  8d fc 14 16 03 03 00 04  |y....wZ.........|
-00000350  0e 00 00 00                                       |....|
+00000030  0f ff 01 00 01 00 00 17  00 00 00 0b 00 02 01 00  |................|
+00000040  16 03 03 02 59 0b 00 02  55 00 02 52 00 02 4f 30  |....Y...U..R..O0|
+00000050  82 02 4b 30 82 01 b4 a0  03 02 01 02 02 09 00 e8  |..K0............|
+00000060  f0 9d 3f e2 5b ea a6 30  0d 06 09 2a 86 48 86 f7  |..?.[..0...*.H..|
+00000070  0d 01 01 0b 05 00 30 1f  31 0b 30 09 06 03 55 04  |......0.1.0...U.|
+00000080  0a 13 02 47 6f 31 10 30  0e 06 03 55 04 03 13 07  |...Go1.0...U....|
+00000090  47 6f 20 52 6f 6f 74 30  1e 17 0d 31 36 30 31 30  |Go Root0...16010|
+000000a0  31 30 30 30 30 30 30 5a  17 0d 32 35 30 31 30 31  |1000000Z..250101|
+000000b0  30 30 30 30 30 30 5a 30  1a 31 0b 30 09 06 03 55  |000000Z0.1.0...U|
+000000c0  04 0a 13 02 47 6f 31 0b  30 09 06 03 55 04 03 13  |....Go1.0...U...|
+000000d0  02 47 6f 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |.Go0..0...*.H...|
+000000e0  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+000000f0  db 46 7d 93 2e 12 27 06  48 bc 06 28 21 ab 7e c4  |.F}...'.H..(!.~.|
+00000100  b6 a2 5d fe 1e 52 45 88  7a 36 47 a5 08 0d 92 42  |..]..RE.z6G....B|
+00000110  5b c2 81 c0 be 97 79 98  40 fb 4f 6d 14 fd 2b 13  |[.....y.@.Om..+.|
+00000120  8b c2 a5 2e 67 d8 d4 09  9e d6 22 38 b7 4a 0b 74  |....g....."8.J.t|
+00000130  73 2b c2 34 f1 d1 93 e5  96 d9 74 7b f3 58 9f 6c  |s+.4......t{.X.l|
+00000140  61 3c c0 b0 41 d4 d9 2b  2b 24 23 77 5b 1c 3b bd  |a<..A..++$#w[.;.|
+00000150  75 5d ce 20 54 cf a1 63  87 1d 1e 24 c4 f3 1d 1a  |u]. T..c...$....|
+00000160  50 8b aa b6 14 43 ed 97  a7 75 62 f4 14 c8 52 d7  |P....C...ub...R.|
+00000170  02 03 01 00 01 a3 81 93  30 81 90 30 0e 06 03 55  |........0..0...U|
+00000180  1d 0f 01 01 ff 04 04 03  02 05 a0 30 1d 06 03 55  |...........0...U|
+00000190  1d 25 04 16 30 14 06 08  2b 06 01 05 05 07 03 01  |.%..0...+.......|
+000001a0  06 08 2b 06 01 05 05 07  03 02 30 0c 06 03 55 1d  |..+.......0...U.|
+000001b0  13 01 01 ff 04 02 30 00  30 19 06 03 55 1d 0e 04  |......0.0...U...|
+000001c0  12 04 10 9f 91 16 1f 43  43 3e 49 a6 de 6d b6 80  |.......CC>I..m..|
+000001d0  d7 9f 60 30 1b 06 03 55  1d 23 04 14 30 12 80 10  |..`0...U.#..0...|
+000001e0  48 13 49 4d 13 7e 16 31  bb a3 01 d5 ac ab 6e 7b  |H.IM.~.1......n{|
+000001f0  30 19 06 03 55 1d 11 04  12 30 10 82 0e 65 78 61  |0...U....0...exa|
+00000200  6d 70 6c 65 2e 67 6f 6c  61 6e 67 30 0d 06 09 2a  |mple.golang0...*|
+00000210  86 48 86 f7 0d 01 01 0b  05 00 03 81 81 00 9d 30  |.H.............0|
+00000220  cc 40 2b 5b 50 a0 61 cb  ba e5 53 58 e1 ed 83 28  |.@+[P.a...SX...(|
+00000230  a9 58 1a a9 38 a4 95 a1  ac 31 5a 1a 84 66 3d 43  |.X..8....1Z..f=C|
+00000240  d3 2d d9 0b f2 97 df d3  20 64 38 92 24 3a 00 bc  |.-...... d8.$:..|
+00000250  cf 9c 7d b7 40 20 01 5f  aa d3 16 61 09 a2 76 fd  |..}.@ ._...a..v.|
+00000260  13 c3 cc e1 0c 5c ee b1  87 82 f1 6c 04 ed 73 bb  |.....\.....l..s.|
+00000270  b3 43 77 8d 0c 1c f1 0f  a1 d8 40 83 61 c9 4c 72  |.Cw.......@.a.Lr|
+00000280  2b 9d ae db 46 06 06 4d  f4 c1 b3 3e c0 d1 bd 42  |+...F..M...>...B|
+00000290  d4 db fe 3d 13 60 84 5c  21 d3 3b e9 fa e7 16 03  |...=.`.\!.;.....|
+000002a0  03 00 ac 0c 00 00 a8 03  00 1d 20 2f e5 7d a3 47  |.......... /.}.G|
+000002b0  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
+000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 08 04 00 80 49  |......_X.;t....I|
+000002d0  51 c7 81 cd e1 9f 67 83  76 7e 51 19 83 2a 34 47  |Q.....g.v~Q..*4G|
+000002e0  5a e8 6d 13 dd e5 44 eb  1a 20 42 ac d3 65 e8 2e  |Z.m...D.. B..e..|
+000002f0  8d c5 79 56 e6 5e 26 00  9b 2a 80 16 d8 2e af 42  |..yV.^&..*.....B|
+00000300  35 b7 0f f8 6a 41 87 b6  c5 6a 37 6e bc 17 5e a4  |5...jA...j7n..^.|
+00000310  1f ba 93 33 98 92 92 2e  76 7b 49 55 8d 37 c2 c3  |...3....v{IU.7..|
+00000320  d5 65 4a 73 84 28 6c 0a  4b 26 62 61 fa 46 0f 47  |.eJs.(l.K&ba.F.G|
+00000330  d5 e5 99 05 57 23 76 6d  c9 7b 0d 8d ff 91 98 eb  |....W#vm.{......|
+00000340  17 96 c0 00 a6 88 3c be  03 5b db e7 a5 84 ae 16  |......<..[......|
+00000350  03 03 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 ef 3b b1 d2 a3 f6  |....%...! .;....|
-00000010  be f2 fc 2e b5 ed d3 ec  6a fb 2f 0d 5a 04 98 61  |........j./.Z..a|
-00000020  92 26 59 ba 17 26 1b 60  27 2b 14 03 03 00 01 01  |.&Y..&.`'+......|
-00000030  16 03 03 00 28 e2 94 22  bb 71 70 c8 a6 63 e5 6f  |....(..".qp..c.o|
-00000040  2e 00 0f b9 bf 6b 54 34  dc ce b0 12 0b 16 e5 ac  |.....kT4........|
-00000050  8f 6b 1e 96 a1 e3 86 b7  6f 8c 76 09 da           |.k......o.v..|
+00000000  16 03 03 00 25 10 00 00  21 20 7d 0c 38 84 cd 0b  |....%...! }.8...|
+00000010  d1 65 02 f7 ab 8b 8b 4e  8f 05 a5 ea 7a 32 db 1b  |.e.....N....z2..|
+00000020  e7 42 5b 2b 83 95 2b e1  aa 30 14 03 03 00 01 01  |.B[+..+..0......|
+00000030  16 03 03 00 28 7d f6 5b  8f 2e 17 84 50 23 db ad  |....(}.[....P#..|
+00000040  47 84 59 ba e8 d7 ab c5  28 dc 06 51 aa 9c 7a d0  |G.Y.....(..Q..z.|
+00000050  6e ae 27 90 e9 aa 92 9e  83 6f 4e eb 6a           |n.'......oN.j|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 28 00 00 00 00 00  |..........(.....|
-00000010  00 00 00 f5 dc 00 28 06  03 50 9b b2 db 4d 89 25  |......(..P...M.%|
-00000020  3a 94 04 85 5b 7a 3f 16  fb 55 8f e0 c3 a3 33 21  |:...[z?..U....3!|
-00000030  65 84 c5 17 03 03 00 25  00 00 00 00 00 00 00 01  |e......%........|
-00000040  a9 35 62 24 4b 63 6e 62  1c 8f 99 e4 e0 3e f0 a2  |.5b$Kcnb.....>..|
-00000050  e3 02 34 6f 10 71 9c 6b  b3 4a 2d 7f 71 15 03 03  |..4o.q.k.J-.q...|
-00000060  00 1a 00 00 00 00 00 00  00 02 91 43 07 98 b1 ba  |...........C....|
-00000070  06 1b dd 21 46 82 63 67  8b bb 1f b5              |...!F.cg....|
+00000010  00 00 00 a5 ec 31 bb 01  5d a3 15 01 22 88 0e f1  |.....1..]..."...|
+00000020  2a 21 18 47 10 64 3d f0  d0 fb f8 fd 27 ed 34 88  |*!.G.d=.....'.4.|
+00000030  c1 b5 b3 17 03 03 00 25  00 00 00 00 00 00 00 01  |.......%........|
+00000040  e4 3c 6a db 2b a9 59 64  d1 3f 4b a0 98 37 52 03  |.<j.+.Yd.?K..7R.|
+00000050  b7 b1 6e 98 ed c0 da e4  75 63 27 64 c4 15 03 03  |..n.....uc'd....|
+00000060  00 1a 00 00 00 00 00 00  00 02 84 a5 21 7b b0 77  |............!{.w|
+00000070  83 03 52 57 79 1f 5c ec  75 da 49 89              |..RWy.\.u.I.|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES256-GCM-SHA384 b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES256-GCM-SHA384
index 2cc2c28f6a..e1b8f7e0a1 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-AES256-GCM-SHA384
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-AES256-GCM-SHA384
@@ -1,82 +1,81 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 97 01 00 00  93 03 03 0f 13 d8 49 94  |..............I.|
-00000010  b9 cc 41 1d d4 3d bb d2  c9 a3 2c 74 11 ca 01 e8  |..A..=....,t....|
-00000020  5b b0 2e 57 60 b5 30 37  2d b9 f0 00 00 04 c0 30  |[..W`.07-......0|
-00000030  00 ff 01 00 00 66 00 00  00 0e 00 0c 00 00 09 31  |.....f.........1|
-00000040  32 37 2e 30 2e 30 2e 31  00 0b 00 04 03 00 01 02  |27.0.0.1........|
-00000050  00 0a 00 0c 00 0a 00 1d  00 17 00 1e 00 19 00 18  |................|
-00000060  00 16 00 00 00 17 00 00  00 0d 00 30 00 2e 04 03  |...........0....|
-00000070  05 03 06 03 08 07 08 08  08 09 08 0a 08 0b 08 04  |................|
-00000080  08 05 08 06 04 01 05 01  06 01 03 03 02 03 03 01  |................|
-00000090  02 01 03 02 02 02 04 02  05 02 06 02              |............|
+00000000  16 03 01 00 85 01 00 00  81 03 03 0f 5a 3f b1 98  |............Z?..|
+00000010  d1 40 d3 93 3a cf 86 50  56 51 7a b4 1d f5 c8 53  |.@..:..PVQz....S|
+00000020  74 9e 5b c3 27 a3 7d fe  a3 4a 73 00 00 04 c0 30  |t.[.'.}..Js....0|
+00000030  00 ff 01 00 00 54 00 0b  00 04 03 00 01 02 00 0a  |.....T..........|
+00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
+00000050  00 00 00 17 00 00 00 0d  00 30 00 2e 04 03 05 03  |.........0......|
+00000060  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
+00000070  08 06 04 01 05 01 06 01  03 03 02 03 03 01 02 01  |................|
+00000080  03 02 02 02 04 02 05 02  06 02                    |..........|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 37 02 00 00  33 03 03 00 00 00 00 00  |....7...3.......|
+00000000  16 03 03 00 3b 02 00 00  37 03 03 00 00 00 00 00  |....;...7.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 c0 30 00 00  |...DOWNGRD...0..|
-00000030  0b ff 01 00 01 00 00 0b  00 02 01 00 16 03 03 02  |................|
-00000040  59 0b 00 02 55 00 02 52  00 02 4f 30 82 02 4b 30  |Y...U..R..O0..K0|
-00000050  82 01 b4 a0 03 02 01 02  02 09 00 e8 f0 9d 3f e2  |..............?.|
-00000060  5b ea a6 30 0d 06 09 2a  86 48 86 f7 0d 01 01 0b  |[..0...*.H......|
-00000070  05 00 30 1f 31 0b 30 09  06 03 55 04 0a 13 02 47  |..0.1.0...U....G|
-00000080  6f 31 10 30 0e 06 03 55  04 03 13 07 47 6f 20 52  |o1.0...U....Go R|
-00000090  6f 6f 74 30 1e 17 0d 31  36 30 31 30 31 30 30 30  |oot0...160101000|
-000000a0  30 30 30 5a 17 0d 32 35  30 31 30 31 30 30 30 30  |000Z..2501010000|
-000000b0  30 30 5a 30 1a 31 0b 30  09 06 03 55 04 0a 13 02  |00Z0.1.0...U....|
-000000c0  47 6f 31 0b 30 09 06 03  55 04 03 13 02 47 6f 30  |Go1.0...U....Go0|
-000000d0  81 9f 30 0d 06 09 2a 86  48 86 f7 0d 01 01 01 05  |..0...*.H.......|
-000000e0  00 03 81 8d 00 30 81 89  02 81 81 00 db 46 7d 93  |.....0.......F}.|
-000000f0  2e 12 27 06 48 bc 06 28  21 ab 7e c4 b6 a2 5d fe  |..'.H..(!.~...].|
-00000100  1e 52 45 88 7a 36 47 a5  08 0d 92 42 5b c2 81 c0  |.RE.z6G....B[...|
-00000110  be 97 79 98 40 fb 4f 6d  14 fd 2b 13 8b c2 a5 2e  |..y.@.Om..+.....|
-00000120  67 d8 d4 09 9e d6 22 38  b7 4a 0b 74 73 2b c2 34  |g....."8.J.ts+.4|
-00000130  f1 d1 93 e5 96 d9 74 7b  f3 58 9f 6c 61 3c c0 b0  |......t{.X.la<..|
-00000140  41 d4 d9 2b 2b 24 23 77  5b 1c 3b bd 75 5d ce 20  |A..++$#w[.;.u]. |
-00000150  54 cf a1 63 87 1d 1e 24  c4 f3 1d 1a 50 8b aa b6  |T..c...$....P...|
-00000160  14 43 ed 97 a7 75 62 f4  14 c8 52 d7 02 03 01 00  |.C...ub...R.....|
-00000170  01 a3 81 93 30 81 90 30  0e 06 03 55 1d 0f 01 01  |....0..0...U....|
-00000180  ff 04 04 03 02 05 a0 30  1d 06 03 55 1d 25 04 16  |.......0...U.%..|
-00000190  30 14 06 08 2b 06 01 05  05 07 03 01 06 08 2b 06  |0...+.........+.|
-000001a0  01 05 05 07 03 02 30 0c  06 03 55 1d 13 01 01 ff  |......0...U.....|
-000001b0  04 02 30 00 30 19 06 03  55 1d 0e 04 12 04 10 9f  |..0.0...U.......|
-000001c0  91 16 1f 43 43 3e 49 a6  de 6d b6 80 d7 9f 60 30  |...CC>I..m....`0|
-000001d0  1b 06 03 55 1d 23 04 14  30 12 80 10 48 13 49 4d  |...U.#..0...H.IM|
-000001e0  13 7e 16 31 bb a3 01 d5  ac ab 6e 7b 30 19 06 03  |.~.1......n{0...|
-000001f0  55 1d 11 04 12 30 10 82  0e 65 78 61 6d 70 6c 65  |U....0...example|
-00000200  2e 67 6f 6c 61 6e 67 30  0d 06 09 2a 86 48 86 f7  |.golang0...*.H..|
-00000210  0d 01 01 0b 05 00 03 81  81 00 9d 30 cc 40 2b 5b  |...........0.@+[|
-00000220  50 a0 61 cb ba e5 53 58  e1 ed 83 28 a9 58 1a a9  |P.a...SX...(.X..|
-00000230  38 a4 95 a1 ac 31 5a 1a  84 66 3d 43 d3 2d d9 0b  |8....1Z..f=C.-..|
-00000240  f2 97 df d3 20 64 38 92  24 3a 00 bc cf 9c 7d b7  |.... d8.$:....}.|
-00000250  40 20 01 5f aa d3 16 61  09 a2 76 fd 13 c3 cc e1  |@ ._...a..v.....|
-00000260  0c 5c ee b1 87 82 f1 6c  04 ed 73 bb b3 43 77 8d  |.\.....l..s..Cw.|
-00000270  0c 1c f1 0f a1 d8 40 83  61 c9 4c 72 2b 9d ae db  |......@.a.Lr+...|
-00000280  46 06 06 4d f4 c1 b3 3e  c0 d1 bd 42 d4 db fe 3d  |F..M...>...B...=|
-00000290  13 60 84 5c 21 d3 3b e9  fa e7 16 03 03 00 ac 0c  |.`.\!.;.........|
-000002a0  00 00 a8 03 00 1d 20 2f  e5 7d a3 47 cd 62 43 15  |...... /.}.G.bC.|
-000002b0  28 da ac 5f bb 29 07 30  ff f6 84 af c4 cf c2 ed  |(.._.).0........|
-000002c0  90 99 5f 58 cb 3b 74 08  04 00 80 40 f3 67 86 41  |.._X.;t....@.g.A|
-000002d0  93 17 f7 db b2 80 ca 73  f9 f8 45 24 cc 46 57 47  |.......s..E$.FWG|
-000002e0  28 83 19 df e8 63 e7 19  c4 a2 04 85 25 7d ec 55  |(....c......%}.U|
-000002f0  91 d4 df eb 77 53 c2 3b  d5 71 1a f7 39 d2 ee b4  |....wS.;.q..9...|
-00000300  06 4b e4 07 b7 fa 8a 8e  fa 64 22 83 dd 22 8b b8  |.K.......d".."..|
-00000310  4d a5 1a f5 e3 81 01 81  6a a1 6e 62 54 3a 3a 09  |M.......j.nbT::.|
-00000320  ed 76 f2 5a d3 4e 4b 74  be 46 50 0d 51 77 34 f6  |.v.Z.NKt.FP.Qw4.|
-00000330  02 ef 57 39 29 bf d9 64  ad 65 06 ae a6 8d 94 86  |..W9)..d.e......|
-00000340  84 76 cf 2c 36 98 04 5b  a1 59 6c 16 03 03 00 04  |.v.,6..[.Yl.....|
-00000350  0e 00 00 00                                       |....|
+00000030  0f ff 01 00 01 00 00 17  00 00 00 0b 00 02 01 00  |................|
+00000040  16 03 03 02 59 0b 00 02  55 00 02 52 00 02 4f 30  |....Y...U..R..O0|
+00000050  82 02 4b 30 82 01 b4 a0  03 02 01 02 02 09 00 e8  |..K0............|
+00000060  f0 9d 3f e2 5b ea a6 30  0d 06 09 2a 86 48 86 f7  |..?.[..0...*.H..|
+00000070  0d 01 01 0b 05 00 30 1f  31 0b 30 09 06 03 55 04  |......0.1.0...U.|
+00000080  0a 13 02 47 6f 31 10 30  0e 06 03 55 04 03 13 07  |...Go1.0...U....|
+00000090  47 6f 20 52 6f 6f 74 30  1e 17 0d 31 36 30 31 30  |Go Root0...16010|
+000000a0  31 30 30 30 30 30 30 5a  17 0d 32 35 30 31 30 31  |1000000Z..250101|
+000000b0  30 30 30 30 30 30 5a 30  1a 31 0b 30 09 06 03 55  |000000Z0.1.0...U|
+000000c0  04 0a 13 02 47 6f 31 0b  30 09 06 03 55 04 03 13  |....Go1.0...U...|
+000000d0  02 47 6f 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |.Go0..0...*.H...|
+000000e0  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+000000f0  db 46 7d 93 2e 12 27 06  48 bc 06 28 21 ab 7e c4  |.F}...'.H..(!.~.|
+00000100  b6 a2 5d fe 1e 52 45 88  7a 36 47 a5 08 0d 92 42  |..]..RE.z6G....B|
+00000110  5b c2 81 c0 be 97 79 98  40 fb 4f 6d 14 fd 2b 13  |[.....y.@.Om..+.|
+00000120  8b c2 a5 2e 67 d8 d4 09  9e d6 22 38 b7 4a 0b 74  |....g....."8.J.t|
+00000130  73 2b c2 34 f1 d1 93 e5  96 d9 74 7b f3 58 9f 6c  |s+.4......t{.X.l|
+00000140  61 3c c0 b0 41 d4 d9 2b  2b 24 23 77 5b 1c 3b bd  |a<..A..++$#w[.;.|
+00000150  75 5d ce 20 54 cf a1 63  87 1d 1e 24 c4 f3 1d 1a  |u]. T..c...$....|
+00000160  50 8b aa b6 14 43 ed 97  a7 75 62 f4 14 c8 52 d7  |P....C...ub...R.|
+00000170  02 03 01 00 01 a3 81 93  30 81 90 30 0e 06 03 55  |........0..0...U|
+00000180  1d 0f 01 01 ff 04 04 03  02 05 a0 30 1d 06 03 55  |...........0...U|
+00000190  1d 25 04 16 30 14 06 08  2b 06 01 05 05 07 03 01  |.%..0...+.......|
+000001a0  06 08 2b 06 01 05 05 07  03 02 30 0c 06 03 55 1d  |..+.......0...U.|
+000001b0  13 01 01 ff 04 02 30 00  30 19 06 03 55 1d 0e 04  |......0.0...U...|
+000001c0  12 04 10 9f 91 16 1f 43  43 3e 49 a6 de 6d b6 80  |.......CC>I..m..|
+000001d0  d7 9f 60 30 1b 06 03 55  1d 23 04 14 30 12 80 10  |..`0...U.#..0...|
+000001e0  48 13 49 4d 13 7e 16 31  bb a3 01 d5 ac ab 6e 7b  |H.IM.~.1......n{|
+000001f0  30 19 06 03 55 1d 11 04  12 30 10 82 0e 65 78 61  |0...U....0...exa|
+00000200  6d 70 6c 65 2e 67 6f 6c  61 6e 67 30 0d 06 09 2a  |mple.golang0...*|
+00000210  86 48 86 f7 0d 01 01 0b  05 00 03 81 81 00 9d 30  |.H.............0|
+00000220  cc 40 2b 5b 50 a0 61 cb  ba e5 53 58 e1 ed 83 28  |.@+[P.a...SX...(|
+00000230  a9 58 1a a9 38 a4 95 a1  ac 31 5a 1a 84 66 3d 43  |.X..8....1Z..f=C|
+00000240  d3 2d d9 0b f2 97 df d3  20 64 38 92 24 3a 00 bc  |.-...... d8.$:..|
+00000250  cf 9c 7d b7 40 20 01 5f  aa d3 16 61 09 a2 76 fd  |..}.@ ._...a..v.|
+00000260  13 c3 cc e1 0c 5c ee b1  87 82 f1 6c 04 ed 73 bb  |.....\.....l..s.|
+00000270  b3 43 77 8d 0c 1c f1 0f  a1 d8 40 83 61 c9 4c 72  |.Cw.......@.a.Lr|
+00000280  2b 9d ae db 46 06 06 4d  f4 c1 b3 3e c0 d1 bd 42  |+...F..M...>...B|
+00000290  d4 db fe 3d 13 60 84 5c  21 d3 3b e9 fa e7 16 03  |...=.`.\!.;.....|
+000002a0  03 00 ac 0c 00 00 a8 03  00 1d 20 2f e5 7d a3 47  |.......... /.}.G|
+000002b0  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
+000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 08 04 00 80 da  |......_X.;t.....|
+000002d0  4d 5e f1 10 1f ed 70 d1  88 7a 22 79 6e 5c c9 4c  |M^....p..z"yn\.L|
+000002e0  e3 e7 a2 bd f4 3d f4 75  dc a3 85 5e f1 af 55 6f  |.....=.u...^..Uo|
+000002f0  e3 36 21 c6 8a 44 e9 58  29 89 32 4d 14 90 9d 1b  |.6!..D.X).2M....|
+00000300  bd 0e fa c3 eb 40 5d 05  5d ba 58 55 3e f9 30 b8  |.....@].].XU>.0.|
+00000310  8f 56 35 71 12 33 92 0e  14 f9 90 2c ee 36 03 50  |.V5q.3.....,.6.P|
+00000320  1c f6 76 a7 99 3e fd bb  5f 21 96 c5 56 1e ed 28  |..v..>.._!..V..(|
+00000330  00 0b cd ac cd 70 1a 7e  2d 2d 7d 1d 76 7d e6 89  |.....p.~--}.v}..|
+00000340  ba 35 dc e1 9f 48 39 ff  9e a9 48 77 8e d3 71 16  |.5...H9...Hw..q.|
+00000350  03 03 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 d5 2b 0e 3c e9 3e  |....%...! .+.<.>|
-00000010  e9 b0 3d 86 a9 85 b5 68  af cf 27 cf 4b d4 49 2e  |..=....h..'.K.I.|
-00000020  68 f2 9e 3c 32 7c cb fb  dc 57 14 03 03 00 01 01  |h..<2|...W......|
-00000030  16 03 03 00 28 5a cc f4  77 38 94 46 7b 39 5d 81  |....(Z..w8.F{9].|
-00000040  be 77 a5 4a 76 c9 46 62  17 0b 2b ea 89 c2 29 bd  |.w.Jv.Fb..+...).|
-00000050  4b b0 dd 51 1e b8 7b a9  55 f5 fb b3 6a           |K..Q..{.U...j|
+00000000  16 03 03 00 25 10 00 00  21 20 80 4d 7d 95 1c e0  |....%...! .M}...|
+00000010  d5 c1 f6 6d 43 92 08 23  82 cb 30 e0 d7 15 d8 51  |...mC..#..0....Q|
+00000020  14 2f 8a 1c 3a 07 be d9  96 54 14 03 03 00 01 01  |./..:....T......|
+00000030  16 03 03 00 28 00 a6 4e  03 ff 76 94 d4 b8 c6 c5  |....(..N..v.....|
+00000040  7d 4d 2b 7e 5d 4f 5c b8  5a 78 46 c9 0f ce 57 7f  |}M+~]O\.ZxF...W.|
+00000050  02 a0 1a 83 b1 92 3f 96  ce 8a 00 8f 30           |......?.....0|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 28 00 00 00 00 00  |..........(.....|
-00000010  00 00 00 b9 9b c0 b1 2b  71 af 0b 44 4e 4a cd e8  |.......+q..DNJ..|
-00000020  c6 68 b8 2a d9 67 6f 7f  18 12 22 5c 4b 5c ca 43  |.h.*.go..."\K\.C|
-00000030  ff c1 9d 17 03 03 00 25  00 00 00 00 00 00 00 01  |.......%........|
-00000040  3c ae 33 dd 69 6c 01 a0  d2 a7 91 52 43 f3 78 38  |<.3.il.....RC.x8|
-00000050  94 f4 24 0b 3d c9 bb 5f  02 27 89 bb 9b 15 03 03  |..$.=.._.'......|
-00000060  00 1a 00 00 00 00 00 00  00 02 68 8d d7 d8 2f 95  |..........h.../.|
-00000070  61 09 59 52 0d b8 12 fc  6a 07 28 37              |a.YR....j.(7|
+00000010  00 00 00 2f ec 4b c3 a6  99 1f ab 91 62 01 d5 e6  |.../.K......b...|
+00000020  93 23 20 7e b8 61 be 90  a0 10 e3 f1 8a 82 f9 bc  |.# ~.a..........|
+00000030  27 fe 65 17 03 03 00 25  00 00 00 00 00 00 00 01  |'.e....%........|
+00000040  54 bd d1 e8 02 9a ab fa  2f d1 19 e9 45 81 05 d1  |T......./...E...|
+00000050  ba d2 d7 77 54 88 cc fe  14 b3 3b d1 28 15 03 03  |...wT.....;.(...|
+00000060  00 1a 00 00 00 00 00 00  00 02 de 3f 93 32 6e f5  |...........?.2n.|
+00000070  07 60 ed 65 6f 81 62 90  52 f6 4a a2              |.`.eo.b.R.J.|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-RC4 b/src/crypto/tls/testdata/Server-TLSv12-RSA-RC4
index 47a4ef2dc0..30b00f6532 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-RC4
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-RC4
@@ -1,76 +1,74 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 97 01 00 00  93 03 03 2c 3c 18 04 94  |...........,<...|
-00000010  e0 bb 10 99 7c 0c cd 0e  e7 72 bc 83 4d f0 cf d7  |....|....r..M...|
-00000020  4b 8e 2c 8b 52 bf ed 86  65 d2 a3 00 00 04 00 05  |K.,.R...e.......|
-00000030  00 ff 01 00 00 66 00 00  00 0e 00 0c 00 00 09 31  |.....f.........1|
-00000040  32 37 2e 30 2e 30 2e 31  00 0b 00 04 03 00 01 02  |27.0.0.1........|
-00000050  00 0a 00 0c 00 0a 00 1d  00 17 00 1e 00 19 00 18  |................|
-00000060  00 16 00 00 00 17 00 00  00 0d 00 30 00 2e 04 03  |...........0....|
-00000070  05 03 06 03 08 07 08 08  08 09 08 0a 08 0b 08 04  |................|
-00000080  08 05 08 06 04 01 05 01  06 01 03 03 02 03 03 01  |................|
-00000090  02 01 03 02 02 02 04 02  05 02 06 02              |............|
+00000000  16 03 01 00 6d 01 00 00  69 03 03 dd 92 e1 75 15  |....m...i.....u.|
+00000010  1d 9f 00 c5 2b 8a 14 86  aa 93 7c c0 32 2a 29 14  |....+.....|.2*).|
+00000020  38 75 ce 62 a7 df c1 4a  eb 1e 0c 00 00 04 00 05  |8u.b...J........|
+00000030  00 ff 01 00 00 3c 00 16  00 00 00 17 00 00 00 0d  |.....<..........|
+00000040  00 30 00 2e 04 03 05 03  06 03 08 07 08 08 08 09  |.0..............|
+00000050  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
+00000060  03 03 02 03 03 01 02 01  03 02 02 02 04 02 05 02  |................|
+00000070  06 02                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 37 02 00 00  33 03 03 00 00 00 00 00  |....7...3.......|
+00000000  16 03 03 00 35 02 00 00  31 03 03 00 00 00 00 00  |....5...1.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 00 05 00 00  |...DOWNGRD......|
-00000030  0b ff 01 00 01 00 00 0b  00 02 01 00 16 03 03 02  |................|
-00000040  59 0b 00 02 55 00 02 52  00 02 4f 30 82 02 4b 30  |Y...U..R..O0..K0|
-00000050  82 01 b4 a0 03 02 01 02  02 09 00 e8 f0 9d 3f e2  |..............?.|
-00000060  5b ea a6 30 0d 06 09 2a  86 48 86 f7 0d 01 01 0b  |[..0...*.H......|
-00000070  05 00 30 1f 31 0b 30 09  06 03 55 04 0a 13 02 47  |..0.1.0...U....G|
-00000080  6f 31 10 30 0e 06 03 55  04 03 13 07 47 6f 20 52  |o1.0...U....Go R|
-00000090  6f 6f 74 30 1e 17 0d 31  36 30 31 30 31 30 30 30  |oot0...160101000|
-000000a0  30 30 30 5a 17 0d 32 35  30 31 30 31 30 30 30 30  |000Z..2501010000|
-000000b0  30 30 5a 30 1a 31 0b 30  09 06 03 55 04 0a 13 02  |00Z0.1.0...U....|
-000000c0  47 6f 31 0b 30 09 06 03  55 04 03 13 02 47 6f 30  |Go1.0...U....Go0|
-000000d0  81 9f 30 0d 06 09 2a 86  48 86 f7 0d 01 01 01 05  |..0...*.H.......|
-000000e0  00 03 81 8d 00 30 81 89  02 81 81 00 db 46 7d 93  |.....0.......F}.|
-000000f0  2e 12 27 06 48 bc 06 28  21 ab 7e c4 b6 a2 5d fe  |..'.H..(!.~...].|
-00000100  1e 52 45 88 7a 36 47 a5  08 0d 92 42 5b c2 81 c0  |.RE.z6G....B[...|
-00000110  be 97 79 98 40 fb 4f 6d  14 fd 2b 13 8b c2 a5 2e  |..y.@.Om..+.....|
-00000120  67 d8 d4 09 9e d6 22 38  b7 4a 0b 74 73 2b c2 34  |g....."8.J.ts+.4|
-00000130  f1 d1 93 e5 96 d9 74 7b  f3 58 9f 6c 61 3c c0 b0  |......t{.X.la<..|
-00000140  41 d4 d9 2b 2b 24 23 77  5b 1c 3b bd 75 5d ce 20  |A..++$#w[.;.u]. |
-00000150  54 cf a1 63 87 1d 1e 24  c4 f3 1d 1a 50 8b aa b6  |T..c...$....P...|
-00000160  14 43 ed 97 a7 75 62 f4  14 c8 52 d7 02 03 01 00  |.C...ub...R.....|
-00000170  01 a3 81 93 30 81 90 30  0e 06 03 55 1d 0f 01 01  |....0..0...U....|
-00000180  ff 04 04 03 02 05 a0 30  1d 06 03 55 1d 25 04 16  |.......0...U.%..|
-00000190  30 14 06 08 2b 06 01 05  05 07 03 01 06 08 2b 06  |0...+.........+.|
-000001a0  01 05 05 07 03 02 30 0c  06 03 55 1d 13 01 01 ff  |......0...U.....|
-000001b0  04 02 30 00 30 19 06 03  55 1d 0e 04 12 04 10 9f  |..0.0...U.......|
-000001c0  91 16 1f 43 43 3e 49 a6  de 6d b6 80 d7 9f 60 30  |...CC>I..m....`0|
-000001d0  1b 06 03 55 1d 23 04 14  30 12 80 10 48 13 49 4d  |...U.#..0...H.IM|
-000001e0  13 7e 16 31 bb a3 01 d5  ac ab 6e 7b 30 19 06 03  |.~.1......n{0...|
-000001f0  55 1d 11 04 12 30 10 82  0e 65 78 61 6d 70 6c 65  |U....0...example|
-00000200  2e 67 6f 6c 61 6e 67 30  0d 06 09 2a 86 48 86 f7  |.golang0...*.H..|
-00000210  0d 01 01 0b 05 00 03 81  81 00 9d 30 cc 40 2b 5b  |...........0.@+[|
-00000220  50 a0 61 cb ba e5 53 58  e1 ed 83 28 a9 58 1a a9  |P.a...SX...(.X..|
-00000230  38 a4 95 a1 ac 31 5a 1a  84 66 3d 43 d3 2d d9 0b  |8....1Z..f=C.-..|
-00000240  f2 97 df d3 20 64 38 92  24 3a 00 bc cf 9c 7d b7  |.... d8.$:....}.|
-00000250  40 20 01 5f aa d3 16 61  09 a2 76 fd 13 c3 cc e1  |@ ._...a..v.....|
-00000260  0c 5c ee b1 87 82 f1 6c  04 ed 73 bb b3 43 77 8d  |.\.....l..s..Cw.|
-00000270  0c 1c f1 0f a1 d8 40 83  61 c9 4c 72 2b 9d ae db  |......@.a.Lr+...|
-00000280  46 06 06 4d f4 c1 b3 3e  c0 d1 bd 42 d4 db fe 3d  |F..M...>...B...=|
-00000290  13 60 84 5c 21 d3 3b e9  fa e7 16 03 03 00 04 0e  |.`.\!.;.........|
-000002a0  00 00 00                                          |...|
+00000030  09 ff 01 00 01 00 00 17  00 00 16 03 03 02 59 0b  |..............Y.|
+00000040  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
+00000050  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
+00000060  a6 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |.0...*.H........|
+00000070  30 1f 31 0b 30 09 06 03  55 04 0a 13 02 47 6f 31  |0.1.0...U....Go1|
+00000080  10 30 0e 06 03 55 04 03  13 07 47 6f 20 52 6f 6f  |.0...U....Go Roo|
+00000090  74 30 1e 17 0d 31 36 30  31 30 31 30 30 30 30 30  |t0...16010100000|
+000000a0  30 5a 17 0d 32 35 30 31  30 31 30 30 30 30 30 30  |0Z..250101000000|
+000000b0  5a 30 1a 31 0b 30 09 06  03 55 04 0a 13 02 47 6f  |Z0.1.0...U....Go|
+000000c0  31 0b 30 09 06 03 55 04  03 13 02 47 6f 30 81 9f  |1.0...U....Go0..|
+000000d0  30 0d 06 09 2a 86 48 86  f7 0d 01 01 01 05 00 03  |0...*.H.........|
+000000e0  81 8d 00 30 81 89 02 81  81 00 db 46 7d 93 2e 12  |...0.......F}...|
+000000f0  27 06 48 bc 06 28 21 ab  7e c4 b6 a2 5d fe 1e 52  |'.H..(!.~...]..R|
+00000100  45 88 7a 36 47 a5 08 0d  92 42 5b c2 81 c0 be 97  |E.z6G....B[.....|
+00000110  79 98 40 fb 4f 6d 14 fd  2b 13 8b c2 a5 2e 67 d8  |y.@.Om..+.....g.|
+00000120  d4 09 9e d6 22 38 b7 4a  0b 74 73 2b c2 34 f1 d1  |...."8.J.ts+.4..|
+00000130  93 e5 96 d9 74 7b f3 58  9f 6c 61 3c c0 b0 41 d4  |....t{.X.la<..A.|
+00000140  d9 2b 2b 24 23 77 5b 1c  3b bd 75 5d ce 20 54 cf  |.++$#w[.;.u]. T.|
+00000150  a1 63 87 1d 1e 24 c4 f3  1d 1a 50 8b aa b6 14 43  |.c...$....P....C|
+00000160  ed 97 a7 75 62 f4 14 c8  52 d7 02 03 01 00 01 a3  |...ub...R.......|
+00000170  81 93 30 81 90 30 0e 06  03 55 1d 0f 01 01 ff 04  |..0..0...U......|
+00000180  04 03 02 05 a0 30 1d 06  03 55 1d 25 04 16 30 14  |.....0...U.%..0.|
+00000190  06 08 2b 06 01 05 05 07  03 01 06 08 2b 06 01 05  |..+.........+...|
+000001a0  05 07 03 02 30 0c 06 03  55 1d 13 01 01 ff 04 02  |....0...U.......|
+000001b0  30 00 30 19 06 03 55 1d  0e 04 12 04 10 9f 91 16  |0.0...U.........|
+000001c0  1f 43 43 3e 49 a6 de 6d  b6 80 d7 9f 60 30 1b 06  |.CC>I..m....`0..|
+000001d0  03 55 1d 23 04 14 30 12  80 10 48 13 49 4d 13 7e  |.U.#..0...H.IM.~|
+000001e0  16 31 bb a3 01 d5 ac ab  6e 7b 30 19 06 03 55 1d  |.1......n{0...U.|
+000001f0  11 04 12 30 10 82 0e 65  78 61 6d 70 6c 65 2e 67  |...0...example.g|
+00000200  6f 6c 61 6e 67 30 0d 06  09 2a 86 48 86 f7 0d 01  |olang0...*.H....|
+00000210  01 0b 05 00 03 81 81 00  9d 30 cc 40 2b 5b 50 a0  |.........0.@+[P.|
+00000220  61 cb ba e5 53 58 e1 ed  83 28 a9 58 1a a9 38 a4  |a...SX...(.X..8.|
+00000230  95 a1 ac 31 5a 1a 84 66  3d 43 d3 2d d9 0b f2 97  |...1Z..f=C.-....|
+00000240  df d3 20 64 38 92 24 3a  00 bc cf 9c 7d b7 40 20  |.. d8.$:....}.@ |
+00000250  01 5f aa d3 16 61 09 a2  76 fd 13 c3 cc e1 0c 5c  |._...a..v......\|
+00000260  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
+00000270  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
+00000280  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
+00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 04 0e 00 00  |.\!.;...........|
+000002a0  00                                                |.|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 a2 43 45 e6 1e  |............CE..|
-00000010  08 d3 29 62 0b 40 75 98  a3 f6 68 d7 78 31 b0 c9  |..)b.@u...h.x1..|
-00000020  f4 f8 a6 98 dc d8 72 c1  2a 68 80 26 54 1c 16 af  |......r.*h.&T...|
-00000030  9f 67 cf ee 74 de 9e 29  b6 cd 0d eb df aa ea 44  |.g..t..).......D|
-00000040  72 c9 aa fc ff c9 2d 9d  bf bc f0 9b c1 7b 0d 5c  |r.....-......{.\|
-00000050  69 0c 75 d8 23 09 29 97  f6 38 9c f9 4f 1b 4a d5  |i.u.#.)..8..O.J.|
-00000060  bd 04 d4 15 b3 a6 80 02  a4 11 32 d7 c0 cf 89 1f  |..........2.....|
-00000070  93 80 2b 48 49 51 44 b7  77 3c bf b1 a6 87 a3 ff  |..+HIQD.w<......|
-00000080  39 37 4a 42 49 92 93 25  0a 51 9a 14 03 03 00 01  |97JBI..%.Q......|
-00000090  01 16 03 03 00 24 b5 c9  d6 9c ec 77 38 d2 30 79  |.....$.....w8.0y|
-000000a0  f1 00 77 31 78 9b e6 ab  ed 46 7c c6 e5 26 0b 44  |..w1x....F|..&.D|
-000000b0  fd 30 b0 fe 0c 84 6f 9a  cf 57                    |.0....o..W|
+00000000  16 03 03 00 86 10 00 00  82 00 80 8d bb 5a 48 87  |.............ZH.|
+00000010  95 ca 2d eb a8 47 de 35  4d 70 3e 89 a1 ce c5 8d  |..-..G.5Mp>.....|
+00000020  02 95 f6 ac e6 2f 1f ae  c5 4a 82 08 22 d5 89 0b  |...../...J.."...|
+00000030  c1 0e be 18 39 d0 e9 e5  ed 87 92 6e 61 3f 68 e5  |....9......na?h.|
+00000040  ed 1d a5 cc 43 d1 42 28  be 4d 31 11 27 f7 dd 25  |....C.B(.M1.'..%|
+00000050  58 b7 fc 76 bb 7c 06 d8  c2 69 0a 87 2b 54 bf 4e  |X..v.|...i..+T.N|
+00000060  8a fa 54 db 78 d4 98 51  21 e4 32 28 49 31 51 c0  |..T.x..Q!.2(I1Q.|
+00000070  a8 7e f0 97 d9 f3 f7 18  d7 a9 74 79 4d 2f 3f df  |.~........tyM/?.|
+00000080  b1 25 88 9e 15 cf 94 42  15 68 65 14 03 03 00 01  |.%.....B.he.....|
+00000090  01 16 03 03 00 24 cb ac  7c 7c 16 02 a9 08 c3 53  |.....$..||.....S|
+000000a0  b8 0e ee 24 fa 51 e0 ce  37 40 e7 f2 ab 93 3d 81  |...$.Q..7@....=.|
+000000b0  58 49 96 0e e7 54 43 67  42 1b                    |XI...TCgB.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 24 58 cc 9f 3f ac  |..........$X..?.|
-00000010  2e 20 73 c9 5e 13 d3 12  3a 63 1e a9 ee 13 3d 0d  |. s.^...:c....=.|
-00000020  51 e9 15 5b 7b 33 92 85  6c fa d6 8a 15 16 dc 17  |Q..[{3..l.......|
-00000030  03 03 00 21 bc af 01 72  48 0c 16 c9 7a c0 3c 27  |...!...rH...z.<'|
-00000040  63 0a f8 34 e4 54 6a 39  39 61 02 bc c2 a0 07 03  |c..4.Tj99a......|
-00000050  fb 2c d0 1b 6a 15 03 03  00 16 98 71 13 a6 5d f5  |.,..j......q..].|
-00000060  7d aa 6d 05 2d a2 dc c0  7b 41 88 36 a2 49 a4 8b  |}.m.-...{A.6.I..|
+00000000  14 03 03 00 01 01 16 03  03 00 24 e4 2f 5e 7f 6f  |..........$./^.o|
+00000010  46 22 85 a0 2d 5a fd 36  0b 9f eb 26 80 89 1d 7e  |F"..-Z.6...&...~|
+00000020  ca 57 a7 f5 5d 54 1c e4  85 77 f5 28 54 a5 15 17  |.W..]T...w.(T...|
+00000030  03 03 00 21 84 a2 f5 c9  e4 df b4 31 8a cf 04 77  |...!.......1...w|
+00000040  22 ab 93 9a ae d2 45 d0  d1 7d 42 11 92 b6 b5 1c  |".....E..}B.....|
+00000050  ac 60 0b d1 9e 15 03 03  00 16 ed f3 12 75 df bc  |.`...........u..|
+00000060  32 e6 c3 fa 74 7a 32 c6  d7 21 67 0a df be b1 15  |2...tz2..!g.....|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-RSAPKCS1v15 b/src/crypto/tls/testdata/Server-TLSv12-RSA-RSAPKCS1v15
index b193771e4e..1c7bceae06 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-RSAPKCS1v15
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-RSAPKCS1v15
@@ -1,77 +1,77 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 59 01 00 00  55 03 03 60 c3 e9 6a 99  |....Y...U..`..j.|
-00000010  72 7a 1c b9 1e 10 4b 9a  82 d5 ea b9 b0 6f 1e 05  |rz....K......o..|
-00000020  74 a4 35 bb 71 c7 d2 56  87 b8 69 00 00 04 cc a8  |t.5.q..V..i.....|
+00000000  16 03 01 00 59 01 00 00  55 03 03 01 3d 46 ff b5  |....Y...U...=F..|
+00000010  47 eb 03 bd 9b 27 66 92  92 db 11 f9 58 1d 21 ba  |G....'f.....X.!.|
+00000020  b9 51 90 81 d0 8f 7e 3c  cd 7b b8 00 00 04 cc a8  |.Q....~<.{......|
 00000030  00 ff 01 00 00 28 00 0b  00 04 03 00 01 02 00 0a  |.....(..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000050  00 00 00 17 00 00 00 0d  00 04 00 02 04 01        |..............|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 37 02 00 00  33 03 03 00 00 00 00 00  |....7...3.......|
+00000000  16 03 03 00 3b 02 00 00  37 03 03 00 00 00 00 00  |....;...7.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 cc a8 00 00  |...DOWNGRD......|
-00000030  0b ff 01 00 01 00 00 0b  00 02 01 00 16 03 03 02  |................|
-00000040  59 0b 00 02 55 00 02 52  00 02 4f 30 82 02 4b 30  |Y...U..R..O0..K0|
-00000050  82 01 b4 a0 03 02 01 02  02 09 00 e8 f0 9d 3f e2  |..............?.|
-00000060  5b ea a6 30 0d 06 09 2a  86 48 86 f7 0d 01 01 0b  |[..0...*.H......|
-00000070  05 00 30 1f 31 0b 30 09  06 03 55 04 0a 13 02 47  |..0.1.0...U....G|
-00000080  6f 31 10 30 0e 06 03 55  04 03 13 07 47 6f 20 52  |o1.0...U....Go R|
-00000090  6f 6f 74 30 1e 17 0d 31  36 30 31 30 31 30 30 30  |oot0...160101000|
-000000a0  30 30 30 5a 17 0d 32 35  30 31 30 31 30 30 30 30  |000Z..2501010000|
-000000b0  30 30 5a 30 1a 31 0b 30  09 06 03 55 04 0a 13 02  |00Z0.1.0...U....|
-000000c0  47 6f 31 0b 30 09 06 03  55 04 03 13 02 47 6f 30  |Go1.0...U....Go0|
-000000d0  81 9f 30 0d 06 09 2a 86  48 86 f7 0d 01 01 01 05  |..0...*.H.......|
-000000e0  00 03 81 8d 00 30 81 89  02 81 81 00 db 46 7d 93  |.....0.......F}.|
-000000f0  2e 12 27 06 48 bc 06 28  21 ab 7e c4 b6 a2 5d fe  |..'.H..(!.~...].|
-00000100  1e 52 45 88 7a 36 47 a5  08 0d 92 42 5b c2 81 c0  |.RE.z6G....B[...|
-00000110  be 97 79 98 40 fb 4f 6d  14 fd 2b 13 8b c2 a5 2e  |..y.@.Om..+.....|
-00000120  67 d8 d4 09 9e d6 22 38  b7 4a 0b 74 73 2b c2 34  |g....."8.J.ts+.4|
-00000130  f1 d1 93 e5 96 d9 74 7b  f3 58 9f 6c 61 3c c0 b0  |......t{.X.la<..|
-00000140  41 d4 d9 2b 2b 24 23 77  5b 1c 3b bd 75 5d ce 20  |A..++$#w[.;.u]. |
-00000150  54 cf a1 63 87 1d 1e 24  c4 f3 1d 1a 50 8b aa b6  |T..c...$....P...|
-00000160  14 43 ed 97 a7 75 62 f4  14 c8 52 d7 02 03 01 00  |.C...ub...R.....|
-00000170  01 a3 81 93 30 81 90 30  0e 06 03 55 1d 0f 01 01  |....0..0...U....|
-00000180  ff 04 04 03 02 05 a0 30  1d 06 03 55 1d 25 04 16  |.......0...U.%..|
-00000190  30 14 06 08 2b 06 01 05  05 07 03 01 06 08 2b 06  |0...+.........+.|
-000001a0  01 05 05 07 03 02 30 0c  06 03 55 1d 13 01 01 ff  |......0...U.....|
-000001b0  04 02 30 00 30 19 06 03  55 1d 0e 04 12 04 10 9f  |..0.0...U.......|
-000001c0  91 16 1f 43 43 3e 49 a6  de 6d b6 80 d7 9f 60 30  |...CC>I..m....`0|
-000001d0  1b 06 03 55 1d 23 04 14  30 12 80 10 48 13 49 4d  |...U.#..0...H.IM|
-000001e0  13 7e 16 31 bb a3 01 d5  ac ab 6e 7b 30 19 06 03  |.~.1......n{0...|
-000001f0  55 1d 11 04 12 30 10 82  0e 65 78 61 6d 70 6c 65  |U....0...example|
-00000200  2e 67 6f 6c 61 6e 67 30  0d 06 09 2a 86 48 86 f7  |.golang0...*.H..|
-00000210  0d 01 01 0b 05 00 03 81  81 00 9d 30 cc 40 2b 5b  |...........0.@+[|
-00000220  50 a0 61 cb ba e5 53 58  e1 ed 83 28 a9 58 1a a9  |P.a...SX...(.X..|
-00000230  38 a4 95 a1 ac 31 5a 1a  84 66 3d 43 d3 2d d9 0b  |8....1Z..f=C.-..|
-00000240  f2 97 df d3 20 64 38 92  24 3a 00 bc cf 9c 7d b7  |.... d8.$:....}.|
-00000250  40 20 01 5f aa d3 16 61  09 a2 76 fd 13 c3 cc e1  |@ ._...a..v.....|
-00000260  0c 5c ee b1 87 82 f1 6c  04 ed 73 bb b3 43 77 8d  |.\.....l..s..Cw.|
-00000270  0c 1c f1 0f a1 d8 40 83  61 c9 4c 72 2b 9d ae db  |......@.a.Lr+...|
-00000280  46 06 06 4d f4 c1 b3 3e  c0 d1 bd 42 d4 db fe 3d  |F..M...>...B...=|
-00000290  13 60 84 5c 21 d3 3b e9  fa e7 16 03 03 00 ac 0c  |.`.\!.;.........|
-000002a0  00 00 a8 03 00 1d 20 2f  e5 7d a3 47 cd 62 43 15  |...... /.}.G.bC.|
-000002b0  28 da ac 5f bb 29 07 30  ff f6 84 af c4 cf c2 ed  |(.._.).0........|
-000002c0  90 99 5f 58 cb 3b 74 04  01 00 80 4e c9 fd 39 89  |.._X.;t....N..9.|
-000002d0  52 c1 6b ba 3b c9 02 35  89 e8 e3 f8 41 15 ee 6d  |R.k.;..5....A..m|
-000002e0  f6 08 6d 1a 47 aa 3b 5c  1d 9b 42 9b 50 85 af 56  |..m.G.;\..B.P..V|
-000002f0  a3 99 78 84 7f 06 91 97  e9 33 0d 1d 9b 17 ce 3b  |..x......3.....;|
-00000300  30 f2 d0 10 1c b6 e2 7d  fd b3 e1 bc 14 7a 1a 96  |0......}.....z..|
-00000310  be b9 dc 0d 29 33 84 5f  d1 77 91 0a a1 f2 2b cc  |....)3._.w....+.|
-00000320  dc 5e 9b f9 8b e3 34 d2  bd f3 46 b4 0d 97 de 44  |.^....4...F....D|
-00000330  aa 83 10 82 bd ca 83 27  d0 40 a7 b1 64 15 dd 84  |.......'.@..d...|
-00000340  5f 3c d9 62 42 0d 8f a6  19 0f b1 16 03 03 00 04  |_<.bB...........|
-00000350  0e 00 00 00                                       |....|
+00000030  0f ff 01 00 01 00 00 17  00 00 00 0b 00 02 01 00  |................|
+00000040  16 03 03 02 59 0b 00 02  55 00 02 52 00 02 4f 30  |....Y...U..R..O0|
+00000050  82 02 4b 30 82 01 b4 a0  03 02 01 02 02 09 00 e8  |..K0............|
+00000060  f0 9d 3f e2 5b ea a6 30  0d 06 09 2a 86 48 86 f7  |..?.[..0...*.H..|
+00000070  0d 01 01 0b 05 00 30 1f  31 0b 30 09 06 03 55 04  |......0.1.0...U.|
+00000080  0a 13 02 47 6f 31 10 30  0e 06 03 55 04 03 13 07  |...Go1.0...U....|
+00000090  47 6f 20 52 6f 6f 74 30  1e 17 0d 31 36 30 31 30  |Go Root0...16010|
+000000a0  31 30 30 30 30 30 30 5a  17 0d 32 35 30 31 30 31  |1000000Z..250101|
+000000b0  30 30 30 30 30 30 5a 30  1a 31 0b 30 09 06 03 55  |000000Z0.1.0...U|
+000000c0  04 0a 13 02 47 6f 31 0b  30 09 06 03 55 04 03 13  |....Go1.0...U...|
+000000d0  02 47 6f 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |.Go0..0...*.H...|
+000000e0  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+000000f0  db 46 7d 93 2e 12 27 06  48 bc 06 28 21 ab 7e c4  |.F}...'.H..(!.~.|
+00000100  b6 a2 5d fe 1e 52 45 88  7a 36 47 a5 08 0d 92 42  |..]..RE.z6G....B|
+00000110  5b c2 81 c0 be 97 79 98  40 fb 4f 6d 14 fd 2b 13  |[.....y.@.Om..+.|
+00000120  8b c2 a5 2e 67 d8 d4 09  9e d6 22 38 b7 4a 0b 74  |....g....."8.J.t|
+00000130  73 2b c2 34 f1 d1 93 e5  96 d9 74 7b f3 58 9f 6c  |s+.4......t{.X.l|
+00000140  61 3c c0 b0 41 d4 d9 2b  2b 24 23 77 5b 1c 3b bd  |a<..A..++$#w[.;.|
+00000150  75 5d ce 20 54 cf a1 63  87 1d 1e 24 c4 f3 1d 1a  |u]. T..c...$....|
+00000160  50 8b aa b6 14 43 ed 97  a7 75 62 f4 14 c8 52 d7  |P....C...ub...R.|
+00000170  02 03 01 00 01 a3 81 93  30 81 90 30 0e 06 03 55  |........0..0...U|
+00000180  1d 0f 01 01 ff 04 04 03  02 05 a0 30 1d 06 03 55  |...........0...U|
+00000190  1d 25 04 16 30 14 06 08  2b 06 01 05 05 07 03 01  |.%..0...+.......|
+000001a0  06 08 2b 06 01 05 05 07  03 02 30 0c 06 03 55 1d  |..+.......0...U.|
+000001b0  13 01 01 ff 04 02 30 00  30 19 06 03 55 1d 0e 04  |......0.0...U...|
+000001c0  12 04 10 9f 91 16 1f 43  43 3e 49 a6 de 6d b6 80  |.......CC>I..m..|
+000001d0  d7 9f 60 30 1b 06 03 55  1d 23 04 14 30 12 80 10  |..`0...U.#..0...|
+000001e0  48 13 49 4d 13 7e 16 31  bb a3 01 d5 ac ab 6e 7b  |H.IM.~.1......n{|
+000001f0  30 19 06 03 55 1d 11 04  12 30 10 82 0e 65 78 61  |0...U....0...exa|
+00000200  6d 70 6c 65 2e 67 6f 6c  61 6e 67 30 0d 06 09 2a  |mple.golang0...*|
+00000210  86 48 86 f7 0d 01 01 0b  05 00 03 81 81 00 9d 30  |.H.............0|
+00000220  cc 40 2b 5b 50 a0 61 cb  ba e5 53 58 e1 ed 83 28  |.@+[P.a...SX...(|
+00000230  a9 58 1a a9 38 a4 95 a1  ac 31 5a 1a 84 66 3d 43  |.X..8....1Z..f=C|
+00000240  d3 2d d9 0b f2 97 df d3  20 64 38 92 24 3a 00 bc  |.-...... d8.$:..|
+00000250  cf 9c 7d b7 40 20 01 5f  aa d3 16 61 09 a2 76 fd  |..}.@ ._...a..v.|
+00000260  13 c3 cc e1 0c 5c ee b1  87 82 f1 6c 04 ed 73 bb  |.....\.....l..s.|
+00000270  b3 43 77 8d 0c 1c f1 0f  a1 d8 40 83 61 c9 4c 72  |.Cw.......@.a.Lr|
+00000280  2b 9d ae db 46 06 06 4d  f4 c1 b3 3e c0 d1 bd 42  |+...F..M...>...B|
+00000290  d4 db fe 3d 13 60 84 5c  21 d3 3b e9 fa e7 16 03  |...=.`.\!.;.....|
+000002a0  03 00 ac 0c 00 00 a8 03  00 1d 20 2f e5 7d a3 47  |.......... /.}.G|
+000002b0  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
+000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 04 01 00 80 21  |......_X.;t....!|
+000002d0  b5 82 7e 5a 7d 93 55 15  db e1 eb cc 62 8d f8 45  |..~Z}.U.....b..E|
+000002e0  2f e0 5d 57 51 08 80 86  b6 43 85 0f be f7 49 ca  |/.]WQ....C....I.|
+000002f0  97 f2 f1 20 51 e6 29 8d  c6 88 91 e3 60 8c 88 69  |... Q.).....`..i|
+00000300  73 9b 38 70 ad 2f 5b 44  62 05 05 20 28 92 57 f9  |s.8p./[Db.. (.W.|
+00000310  51 6e 6b 8c b7 3f c3 6e  a3 53 b9 bd 02 bd 69 ae  |Qnk..?.n.S....i.|
+00000320  ee 5f 96 57 7b a2 02 86  70 33 6b e7 ad 03 25 13  |._.W{...p3k...%.|
+00000330  10 f8 d7 cb 2e 33 b2 1f  53 64 77 d1 e5 8a 32 bc  |.....3..Sdw...2.|
+00000340  e0 bc 65 9d 94 de fb 9a  d5 66 00 7a 79 dc da 16  |..e......f.zy...|
+00000350  03 03 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 82 3a 50 41 f7 b1  |....%...! .:PA..|
-00000010  0f 97 ba 38 04 db f3 a6  ec 8b d1 db 06 c1 84 89  |...8............|
-00000020  a0 53 84 92 27 a2 53 e8  5d 21 14 03 03 00 01 01  |.S..'.S.]!......|
-00000030  16 03 03 00 20 7d 80 6d  7f a9 28 d6 0d 50 d6 b4  |.... }.m..(..P..|
-00000040  24 d3 92 f8 0b 8e 6b d8  7c 64 9e 6c 87 a9 8e 37  |$.....k.|d.l...7|
-00000050  9e 1b 0b 2d a5                                    |...-.|
+00000000  16 03 03 00 25 10 00 00  21 20 6d d3 b6 6a f0 ac  |....%...! m..j..|
+00000010  40 6e e8 73 db a2 04 41  6a 7f c1 cc ae 13 44 e1  |@n.s...Aj.....D.|
+00000020  1c f4 5a 59 1b 88 4b a8  89 61 14 03 03 00 01 01  |..ZY..K..a......|
+00000030  16 03 03 00 20 5f 09 a4  44 8e a8 6d 09 14 32 05  |.... _..D..m..2.|
+00000040  ce ae f9 ad ad a2 d9 45  77 be e2 2c bd 97 22 1a  |.......Ew..,..".|
+00000050  7d 3b 54 db 82                                    |};T..|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 e4 58 cf fb 81  |.......... .X...|
-00000010  be dd 5b 98 97 bd bd 6a  f0 76 92 b6 bb 2c 8f a3  |..[....j.v...,..|
-00000020  e5 52 5b 1d f4 17 7b 2a  a8 40 26 17 03 03 00 1d  |.R[...{*.@&.....|
-00000030  58 ef 4f 1d 98 0f 3d 59  88 df 6e ac c9 37 43 d5  |X.O...=Y..n..7C.|
-00000040  f5 58 b3 7a 62 a3 7d 26  a2 a2 80 23 ef 15 03 03  |.X.zb.}&...#....|
-00000050  00 12 05 b8 57 6a 80 71  b6 a4 58 94 15 f4 2f 0c  |....Wj.q..X.../.|
-00000060  8e 76 b2 aa                                       |.v..|
+00000000  14 03 03 00 01 01 16 03  03 00 20 54 52 24 a8 3a  |.......... TR$.:|
+00000010  e3 45 a2 49 1c c5 10 62  6e d1 32 fe 70 0f 32 e0  |.E.I...bn.2.p.2.|
+00000020  fc 95 22 81 32 38 ab f2  0a ba 6c 17 03 03 00 1d  |..".28....l.....|
+00000030  b7 a9 2a a5 ad e5 9e 39  cc a9 bc 81 ef a1 67 e1  |..*....9......g.|
+00000040  85 08 9f f4 e7 04 c8 0b  0d fd 5c ec 94 15 03 03  |..........\.....|
+00000050  00 12 d7 18 99 08 6c 98  dc 05 20 19 cd dd f2 29  |......l... ....)|
+00000060  14 3c cf 31                                       |.<.1|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-RSA-RSAPSS b/src/crypto/tls/testdata/Server-TLSv12-RSA-RSAPSS
index af4c069fad..46ee1aae45 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-RSA-RSAPSS
+++ b/src/crypto/tls/testdata/Server-TLSv12-RSA-RSAPSS
@@ -1,77 +1,77 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 5b 01 00 00  57 03 03 e0 83 fd ef f8  |....[...W.......|
-00000010  cb 41 23 14 36 21 07 eb  4e 01 7d 80 63 e4 b9 45  |.A#.6!..N.}.c..E|
-00000020  f0 84 72 71 9b ac 60 49  6c 70 74 00 00 04 cc a8  |..rq..`Ilpt.....|
+00000000  16 03 01 00 5b 01 00 00  57 03 03 ee 47 d0 cd 83  |....[...W...G...|
+00000010  ff 1e f3 45 81 2e 59 6a  84 da c9 29 bd b0 8b f5  |...E..Yj...)....|
+00000020  3c 47 58 b0 94 59 33 9a  f6 00 2d 00 00 04 cc a8  |<GX..Y3...-.....|
 00000030  00 ff 01 00 00 2a 00 0b  00 04 03 00 01 02 00 0a  |.....*..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000050  00 00 00 17 00 00 00 0d  00 06 00 04 08 06 08 04  |................|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 37 02 00 00  33 03 03 00 00 00 00 00  |....7...3.......|
+00000000  16 03 03 00 3b 02 00 00  37 03 03 00 00 00 00 00  |....;...7.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 cc a8 00 00  |...DOWNGRD......|
-00000030  0b ff 01 00 01 00 00 0b  00 02 01 00 16 03 03 02  |................|
-00000040  59 0b 00 02 55 00 02 52  00 02 4f 30 82 02 4b 30  |Y...U..R..O0..K0|
-00000050  82 01 b4 a0 03 02 01 02  02 09 00 e8 f0 9d 3f e2  |..............?.|
-00000060  5b ea a6 30 0d 06 09 2a  86 48 86 f7 0d 01 01 0b  |[..0...*.H......|
-00000070  05 00 30 1f 31 0b 30 09  06 03 55 04 0a 13 02 47  |..0.1.0...U....G|
-00000080  6f 31 10 30 0e 06 03 55  04 03 13 07 47 6f 20 52  |o1.0...U....Go R|
-00000090  6f 6f 74 30 1e 17 0d 31  36 30 31 30 31 30 30 30  |oot0...160101000|
-000000a0  30 30 30 5a 17 0d 32 35  30 31 30 31 30 30 30 30  |000Z..2501010000|
-000000b0  30 30 5a 30 1a 31 0b 30  09 06 03 55 04 0a 13 02  |00Z0.1.0...U....|
-000000c0  47 6f 31 0b 30 09 06 03  55 04 03 13 02 47 6f 30  |Go1.0...U....Go0|
-000000d0  81 9f 30 0d 06 09 2a 86  48 86 f7 0d 01 01 01 05  |..0...*.H.......|
-000000e0  00 03 81 8d 00 30 81 89  02 81 81 00 db 46 7d 93  |.....0.......F}.|
-000000f0  2e 12 27 06 48 bc 06 28  21 ab 7e c4 b6 a2 5d fe  |..'.H..(!.~...].|
-00000100  1e 52 45 88 7a 36 47 a5  08 0d 92 42 5b c2 81 c0  |.RE.z6G....B[...|
-00000110  be 97 79 98 40 fb 4f 6d  14 fd 2b 13 8b c2 a5 2e  |..y.@.Om..+.....|
-00000120  67 d8 d4 09 9e d6 22 38  b7 4a 0b 74 73 2b c2 34  |g....."8.J.ts+.4|
-00000130  f1 d1 93 e5 96 d9 74 7b  f3 58 9f 6c 61 3c c0 b0  |......t{.X.la<..|
-00000140  41 d4 d9 2b 2b 24 23 77  5b 1c 3b bd 75 5d ce 20  |A..++$#w[.;.u]. |
-00000150  54 cf a1 63 87 1d 1e 24  c4 f3 1d 1a 50 8b aa b6  |T..c...$....P...|
-00000160  14 43 ed 97 a7 75 62 f4  14 c8 52 d7 02 03 01 00  |.C...ub...R.....|
-00000170  01 a3 81 93 30 81 90 30  0e 06 03 55 1d 0f 01 01  |....0..0...U....|
-00000180  ff 04 04 03 02 05 a0 30  1d 06 03 55 1d 25 04 16  |.......0...U.%..|
-00000190  30 14 06 08 2b 06 01 05  05 07 03 01 06 08 2b 06  |0...+.........+.|
-000001a0  01 05 05 07 03 02 30 0c  06 03 55 1d 13 01 01 ff  |......0...U.....|
-000001b0  04 02 30 00 30 19 06 03  55 1d 0e 04 12 04 10 9f  |..0.0...U.......|
-000001c0  91 16 1f 43 43 3e 49 a6  de 6d b6 80 d7 9f 60 30  |...CC>I..m....`0|
-000001d0  1b 06 03 55 1d 23 04 14  30 12 80 10 48 13 49 4d  |...U.#..0...H.IM|
-000001e0  13 7e 16 31 bb a3 01 d5  ac ab 6e 7b 30 19 06 03  |.~.1......n{0...|
-000001f0  55 1d 11 04 12 30 10 82  0e 65 78 61 6d 70 6c 65  |U....0...example|
-00000200  2e 67 6f 6c 61 6e 67 30  0d 06 09 2a 86 48 86 f7  |.golang0...*.H..|
-00000210  0d 01 01 0b 05 00 03 81  81 00 9d 30 cc 40 2b 5b  |...........0.@+[|
-00000220  50 a0 61 cb ba e5 53 58  e1 ed 83 28 a9 58 1a a9  |P.a...SX...(.X..|
-00000230  38 a4 95 a1 ac 31 5a 1a  84 66 3d 43 d3 2d d9 0b  |8....1Z..f=C.-..|
-00000240  f2 97 df d3 20 64 38 92  24 3a 00 bc cf 9c 7d b7  |.... d8.$:....}.|
-00000250  40 20 01 5f aa d3 16 61  09 a2 76 fd 13 c3 cc e1  |@ ._...a..v.....|
-00000260  0c 5c ee b1 87 82 f1 6c  04 ed 73 bb b3 43 77 8d  |.\.....l..s..Cw.|
-00000270  0c 1c f1 0f a1 d8 40 83  61 c9 4c 72 2b 9d ae db  |......@.a.Lr+...|
-00000280  46 06 06 4d f4 c1 b3 3e  c0 d1 bd 42 d4 db fe 3d  |F..M...>...B...=|
-00000290  13 60 84 5c 21 d3 3b e9  fa e7 16 03 03 00 ac 0c  |.`.\!.;.........|
-000002a0  00 00 a8 03 00 1d 20 2f  e5 7d a3 47 cd 62 43 15  |...... /.}.G.bC.|
-000002b0  28 da ac 5f bb 29 07 30  ff f6 84 af c4 cf c2 ed  |(.._.).0........|
-000002c0  90 99 5f 58 cb 3b 74 08  04 00 80 58 d3 5f 28 bc  |.._X.;t....X._(.|
-000002d0  50 79 b9 3d f1 ac a1 af  52 cd d3 fd e7 75 47 c3  |Py.=....R....uG.|
-000002e0  65 3a 6f 62 22 c2 b5 cc  2b 22 f3 5d 3f b5 b6 9e  |e:ob"...+".]?...|
-000002f0  57 bf c7 4e 08 bd fb 5a  17 13 09 1a e9 6c b6 ce  |W..N...Z.....l..|
-00000300  b2 0e 88 ae ba a3 a0 b5  2c ff 51 b5 87 95 14 09  |........,.Q.....|
-00000310  6d 9c 73 3f f0 c7 40 6b  4c ca 40 96 d6 44 96 d0  |m.s?..@kL.@..D..|
-00000320  6f b1 a0 1c 4f 66 cc 9b  4f 85 98 3c 03 68 e3 a8  |o...Of..O..<.h..|
-00000330  5b 28 04 fb 1e be 9e 2a  66 c1 6e f1 2e a4 20 08  |[(.....*f.n... .|
-00000340  7e 11 78 7b fc c4 43 af  2a b4 8b 16 03 03 00 04  |~.x{..C.*.......|
-00000350  0e 00 00 00                                       |....|
+00000030  0f ff 01 00 01 00 00 17  00 00 00 0b 00 02 01 00  |................|
+00000040  16 03 03 02 59 0b 00 02  55 00 02 52 00 02 4f 30  |....Y...U..R..O0|
+00000050  82 02 4b 30 82 01 b4 a0  03 02 01 02 02 09 00 e8  |..K0............|
+00000060  f0 9d 3f e2 5b ea a6 30  0d 06 09 2a 86 48 86 f7  |..?.[..0...*.H..|
+00000070  0d 01 01 0b 05 00 30 1f  31 0b 30 09 06 03 55 04  |......0.1.0...U.|
+00000080  0a 13 02 47 6f 31 10 30  0e 06 03 55 04 03 13 07  |...Go1.0...U....|
+00000090  47 6f 20 52 6f 6f 74 30  1e 17 0d 31 36 30 31 30  |Go Root0...16010|
+000000a0  31 30 30 30 30 30 30 5a  17 0d 32 35 30 31 30 31  |1000000Z..250101|
+000000b0  30 30 30 30 30 30 5a 30  1a 31 0b 30 09 06 03 55  |000000Z0.1.0...U|
+000000c0  04 0a 13 02 47 6f 31 0b  30 09 06 03 55 04 03 13  |....Go1.0...U...|
+000000d0  02 47 6f 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |.Go0..0...*.H...|
+000000e0  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+000000f0  db 46 7d 93 2e 12 27 06  48 bc 06 28 21 ab 7e c4  |.F}...'.H..(!.~.|
+00000100  b6 a2 5d fe 1e 52 45 88  7a 36 47 a5 08 0d 92 42  |..]..RE.z6G....B|
+00000110  5b c2 81 c0 be 97 79 98  40 fb 4f 6d 14 fd 2b 13  |[.....y.@.Om..+.|
+00000120  8b c2 a5 2e 67 d8 d4 09  9e d6 22 38 b7 4a 0b 74  |....g....."8.J.t|
+00000130  73 2b c2 34 f1 d1 93 e5  96 d9 74 7b f3 58 9f 6c  |s+.4......t{.X.l|
+00000140  61 3c c0 b0 41 d4 d9 2b  2b 24 23 77 5b 1c 3b bd  |a<..A..++$#w[.;.|
+00000150  75 5d ce 20 54 cf a1 63  87 1d 1e 24 c4 f3 1d 1a  |u]. T..c...$....|
+00000160  50 8b aa b6 14 43 ed 97  a7 75 62 f4 14 c8 52 d7  |P....C...ub...R.|
+00000170  02 03 01 00 01 a3 81 93  30 81 90 30 0e 06 03 55  |........0..0...U|
+00000180  1d 0f 01 01 ff 04 04 03  02 05 a0 30 1d 06 03 55  |...........0...U|
+00000190  1d 25 04 16 30 14 06 08  2b 06 01 05 05 07 03 01  |.%..0...+.......|
+000001a0  06 08 2b 06 01 05 05 07  03 02 30 0c 06 03 55 1d  |..+.......0...U.|
+000001b0  13 01 01 ff 04 02 30 00  30 19 06 03 55 1d 0e 04  |......0.0...U...|
+000001c0  12 04 10 9f 91 16 1f 43  43 3e 49 a6 de 6d b6 80  |.......CC>I..m..|
+000001d0  d7 9f 60 30 1b 06 03 55  1d 23 04 14 30 12 80 10  |..`0...U.#..0...|
+000001e0  48 13 49 4d 13 7e 16 31  bb a3 01 d5 ac ab 6e 7b  |H.IM.~.1......n{|
+000001f0  30 19 06 03 55 1d 11 04  12 30 10 82 0e 65 78 61  |0...U....0...exa|
+00000200  6d 70 6c 65 2e 67 6f 6c  61 6e 67 30 0d 06 09 2a  |mple.golang0...*|
+00000210  86 48 86 f7 0d 01 01 0b  05 00 03 81 81 00 9d 30  |.H.............0|
+00000220  cc 40 2b 5b 50 a0 61 cb  ba e5 53 58 e1 ed 83 28  |.@+[P.a...SX...(|
+00000230  a9 58 1a a9 38 a4 95 a1  ac 31 5a 1a 84 66 3d 43  |.X..8....1Z..f=C|
+00000240  d3 2d d9 0b f2 97 df d3  20 64 38 92 24 3a 00 bc  |.-...... d8.$:..|
+00000250  cf 9c 7d b7 40 20 01 5f  aa d3 16 61 09 a2 76 fd  |..}.@ ._...a..v.|
+00000260  13 c3 cc e1 0c 5c ee b1  87 82 f1 6c 04 ed 73 bb  |.....\.....l..s.|
+00000270  b3 43 77 8d 0c 1c f1 0f  a1 d8 40 83 61 c9 4c 72  |.Cw.......@.a.Lr|
+00000280  2b 9d ae db 46 06 06 4d  f4 c1 b3 3e c0 d1 bd 42  |+...F..M...>...B|
+00000290  d4 db fe 3d 13 60 84 5c  21 d3 3b e9 fa e7 16 03  |...=.`.\!.;.....|
+000002a0  03 00 ac 0c 00 00 a8 03  00 1d 20 2f e5 7d a3 47  |.......... /.}.G|
+000002b0  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
+000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 08 04 00 80 95  |......_X.;t.....|
+000002d0  e0 3f 63 8b d7 e0 51 5a  eb ea 5e de ce da 62 02  |.?c...QZ..^...b.|
+000002e0  7d 7d 42 7f 9f db 53 a2  a9 e5 be b4 32 47 65 9a  |}}B...S.....2Ge.|
+000002f0  cc d6 9f ee 4c bc 28 7d  27 00 69 e2 fa fd fa 65  |....L.(}'.i....e|
+00000300  a0 3d c1 00 85 a9 28 8c  d1 9b 6d 49 2f 84 17 b0  |.=....(...mI/...|
+00000310  59 cd ac 79 a8 6d cc 8a  a0 05 e9 ca e8 df 14 2d  |Y..y.m.........-|
+00000320  a0 59 a3 75 a6 c6 ec 91  37 e1 e6 dc 6d d8 74 96  |.Y.u....7...m.t.|
+00000330  95 bc ff 11 ca fe 91 4a  d6 9e d7 73 5f bd 28 6a  |.......J...s_.(j|
+00000340  23 6d c5 2b ee 25 17 6c  e1 50 c1 f9 42 7e 3c 16  |#m.+.%.l.P..B~<.|
+00000350  03 03 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 e2 54 7d 82 d2 8d  |....%...! .T}...|
-00000010  b8 d6 87 17 ec 2a 64 4e  15 6b b0 b3 01 66 b0 7d  |.....*dN.k...f.}|
-00000020  73 20 9f cb 30 9d 3c 27  ac 13 14 03 03 00 01 01  |s ..0.<'........|
-00000030  16 03 03 00 20 fa a0 b7  eb ef 49 97 d5 da f0 9d  |.... .....I.....|
-00000040  85 a6 e6 67 f3 30 e8 f0  82 3a 7a c4 3f 76 f6 c5  |...g.0...:z.?v..|
-00000050  8f d3 a5 65 f3                                    |...e.|
+00000000  16 03 03 00 25 10 00 00  21 20 51 de e0 c4 a5 8f  |....%...! Q.....|
+00000010  ee 05 c5 d5 a2 ce 9c 4a  19 6d 14 cb 61 88 a6 fe  |.......J.m..a...|
+00000020  38 24 b6 4e d7 f0 c5 27  97 32 14 03 03 00 01 01  |8$.N...'.2......|
+00000030  16 03 03 00 20 0e 14 d4  f5 c2 10 a1 80 b3 b4 90  |.... ...........|
+00000040  17 43 1f 22 69 78 00 bb  87 c3 78 23 8e 03 8f c4  |.C."ix....x#....|
+00000050  28 1c f8 42 e6                                    |(..B.|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 20 6b cf 58 e1 52  |.......... k.X.R|
-00000010  e3 2c 05 e6 a3 05 c1 36  02 f0 90 63 bb 86 0f 54  |.,.....6...c...T|
-00000020  61 d7 1a 31 7d bd 08 00  22 71 09 17 03 03 00 1d  |a..1}..."q......|
-00000030  4a 8e 05 28 e3 77 31 43  be ac 32 c6 af f2 7b 1c  |J..(.w1C..2...{.|
-00000040  ab 11 7f 32 5a 6a eb 76  ac c6 eb f1 dc 15 03 03  |...2Zj.v........|
-00000050  00 12 3a f1 ee a3 6f bf  9b 9e 5e b8 20 76 84 bc  |..:...o...^. v..|
-00000060  1e 2e a0 87                                       |....|
+00000000  14 03 03 00 01 01 16 03  03 00 20 6f a9 ff 13 fb  |.......... o....|
+00000010  85 fa e4 fc cd ca 74 59  21 cd 3c fd 73 43 a2 48  |......tY!.<.sC.H|
+00000020  f5 cf cd f7 9b 24 1d db  8a 52 a6 17 03 03 00 1d  |.....$...R......|
+00000030  63 25 92 b2 0c f7 d1 92  83 95 3c 13 ee 78 4c c1  |c%........<..xL.|
+00000040  60 66 60 ed 8e 86 5b 1d  2d 1b a5 ab 38 15 03 03  |`f`...[.-...8...|
+00000050  00 12 d5 3c b4 59 87 f5  45 fc 68 9b 03 7e 5b 97  |...<.Y..E.h..~[.|
+00000060  c1 83 13 33                                       |...3|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-Resume b/src/crypto/tls/testdata/Server-TLSv12-Resume
index d4ba75fe7a..b59314a976 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-Resume
+++ b/src/crypto/tls/testdata/Server-TLSv12-Resume
@@ -1,53 +1,53 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 06 01 00 01  02 03 03 da ae e2 11 62  |...............b|
-00000010  9d 53 a1 e1 cc 53 d2 04  b6 70 1a fb c4 c0 a2 10  |.S...S...p......|
-00000020  22 a2 ab b2 f6 fb 4e e9  95 6d 38 20 c1 4f 3e 5a  |".....N..m8 .O>Z|
-00000030  2c 67 93 3a 59 ad fe 52  d6 66 b1 d9 85 ad 71 2c  |,g.:Y..R.f....q,|
-00000040  0a 02 89 73 e3 39 08 bc  3e 91 d4 f3 00 04 00 2f  |...s.9..>....../|
-00000050  00 ff 01 00 00 b5 00 23  00 75 00 00 00 00 00 00  |.......#.u......|
+00000000  16 03 01 01 07 01 00 01  03 03 03 4b 54 81 19 48  |...........KT..H|
+00000010  bc e2 39 6e ff 67 de 39  f2 05 5a c4 55 80 5f 88  |..9n.g.9..Z.U._.|
+00000020  70 9f e6 ea d4 04 dd 45  bd ba de 20 38 80 17 a6  |p......E... 8...|
+00000030  12 ef 06 3b c4 51 b1 f7  30 4b f4 ae 24 18 92 cb  |...;.Q..0K..$...|
+00000040  56 41 3c bc fe 73 df 1a  88 0e 54 55 00 04 00 2f  |VA<..s....TU.../|
+00000050  00 ff 01 00 00 b6 00 23  00 76 00 00 00 00 00 00  |.......#.v......|
 00000060  00 00 00 00 00 00 00 00  00 00 94 6f 2d b0 ac 51  |...........o-..Q|
-00000070  ed 14 ef 68 ca 42 c5 4c  67 af 2c 17 93 9b 23 75  |...h.B.Lg.,...#u|
-00000080  eb 14 42 1b 7a 25 cb 05  f0 c1 bd c8 e7 60 6b 0e  |..B.z%.......`k.|
-00000090  1c 45 8d 51 32 a6 7c 6d  01 20 34 54 8e dd d5 41  |.E.Q2.|m. 4T...A|
-000000a0  df fe a1 02 4e b5 d1 0b  49 38 16 7f 51 5c e5 6a  |....N...I8..Q\.j|
-000000b0  1a 49 22 f3 54 3e f9 69  5c 2a b3 e6 f7 d8 eb d2  |.I".T>.i\*......|
-000000c0  f3 76 65 fa 45 39 d0 15  85 19 40 bd 38 81 50 00  |.ve.E9....@.8.P.|
-000000d0  16 00 00 00 17 00 00 00  0d 00 30 00 2e 04 03 05  |..........0.....|
-000000e0  03 06 03 08 07 08 08 08  09 08 0a 08 0b 08 04 08  |................|
-000000f0  05 08 06 04 01 05 01 06  01 03 03 02 03 03 01 02  |................|
-00000100  01 03 02 02 02 04 02 05  02 06 02                 |...........|
+00000070  ed 14 ef 68 ca 42 c5 4c  1b 7a 85 17 60 8e 95 68  |...h.B.L.z..`..h|
+00000080  ae ba d1 10 71 7c 2c ad  1e bb 60 4d ef 70 e7 f0  |....q|,...`M.p..|
+00000090  ed 39 8b 9c 99 f6 8c cb  e4 41 28 94 bc f0 91 d9  |.9.......A(.....|
+000000a0  8f 1b cb 7d e8 4c 4c 49  49 38 16 7e 51 5c e5 15  |...}.LLII8.~Q\..|
+000000b0  ff 0f 34 c4 f2 42 d0 c6  48 7c 0b f1 5d 4b f3 54  |..4..B..H|..]K.T|
+000000c0  87 8e 2d d1 dd 1c 56 95  9d 57 bd 28 ed cf 80 06  |..-...V..W.(....|
+000000d0  00 16 00 00 00 17 00 00  00 0d 00 30 00 2e 04 03  |...........0....|
+000000e0  05 03 06 03 08 07 08 08  08 09 08 0a 08 0b 08 04  |................|
+000000f0  08 05 08 06 04 01 05 01  06 01 03 03 02 03 03 01  |................|
+00000100  02 01 03 02 02 02 04 02  05 02 06 02              |............|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 55 02 00 00  51 03 03 00 00 00 00 00  |....U...Q.......|
+00000000  16 03 03 00 59 02 00 00  55 03 03 00 00 00 00 00  |....Y...U.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 44 4f 57 4e 47  52 44 01 20 c1 4f 3e 5a  |...DOWNGRD. .O>Z|
-00000030  2c 67 93 3a 59 ad fe 52  d6 66 b1 d9 85 ad 71 2c  |,g.:Y..R.f....q,|
-00000040  0a 02 89 73 e3 39 08 bc  3e 91 d4 f3 00 2f 00 00  |...s.9..>..../..|
-00000050  09 00 23 00 00 ff 01 00  01 00 16 03 03 00 7f 04  |..#.............|
-00000060  00 00 7b 00 00 00 00 00  75 00 00 00 00 00 00 00  |..{.....u.......|
-00000070  00 00 00 00 00 00 00 00  00 94 6f 2d b0 ac 51 ed  |..........o-..Q.|
-00000080  14 ef 68 ca 42 c5 4c 67  af 2c 17 93 9b 23 75 eb  |..h.B.Lg.,...#u.|
-00000090  14 42 1b 7a 25 cb 05 f0  c1 bd c8 e7 60 6b 0e 1c  |.B.z%.......`k..|
-000000a0  45 8d 51 32 a6 7c 6d 01  20 34 54 8e dd d5 41 df  |E.Q2.|m. 4T...A.|
-000000b0  fe a1 02 4e b5 d1 0b 49  38 16 7f 51 5c e5 6a 1a  |...N...I8..Q\.j.|
-000000c0  49 22 f3 54 3e f9 69 5c  2a b3 e6 f7 d8 eb d2 f3  |I".T>.i\*.......|
-000000d0  76 65 fa 45 39 d0 15 85  19 40 bd 38 81 50 14 03  |ve.E9....@.8.P..|
-000000e0  03 00 01 01 16 03 03 00  40 00 00 00 00 00 00 00  |........@.......|
-000000f0  00 00 00 00 00 00 00 00  00 d2 17 9f 6a 4e bc aa  |............jN..|
-00000100  fe 5f cf 69 89 42 9a 9b  80 e5 6d 8a dd 0e 70 e1  |._.i.B....m...p.|
-00000110  13 6b d8 ac a2 39 8b 71  e6 f2 f7 57 d2 eb 75 dd  |.k...9.q...W..u.|
-00000120  d8 5f 82 02 96 2f 08 f0  68                       |._.../..h|
+00000020  00 00 00 44 4f 57 4e 47  52 44 01 20 38 80 17 a6  |...DOWNGRD. 8...|
+00000030  12 ef 06 3b c4 51 b1 f7  30 4b f4 ae 24 18 92 cb  |...;.Q..0K..$...|
+00000040  56 41 3c bc fe 73 df 1a  88 0e 54 55 00 2f 00 00  |VA<..s....TU./..|
+00000050  0d 00 23 00 00 ff 01 00  01 00 00 17 00 00 16 03  |..#.............|
+00000060  03 00 80 04 00 00 7c 00  00 00 00 00 76 00 00 00  |......|.....v...|
+00000070  00 00 00 00 00 00 00 00  00 00 00 00 00 94 6f 2d  |..............o-|
+00000080  b0 ac 51 ed 14 ef 68 ca  42 c5 4c 1b 7a 85 17 60  |..Q...h.B.L.z..`|
+00000090  8e 95 68 ae ba d1 10 71  7c 2c ad 1e bb 60 4d ef  |..h....q|,...`M.|
+000000a0  70 e7 f0 ed 39 8b 9c 99  f6 8c cb e4 41 28 94 bc  |p...9.......A(..|
+000000b0  f0 91 d9 8f 1b cb 7d e8  4c 4c 49 49 38 16 7e 51  |......}.LLII8.~Q|
+000000c0  5c e5 15 ff 0f 34 c4 f2  42 d0 c6 48 7c 0b f1 5d  |\....4..B..H|..]|
+000000d0  4b f3 54 87 8e 2d d1 dd  1c 56 95 9d 57 bd 28 ed  |K.T..-...V..W.(.|
+000000e0  cf 80 06 14 03 03 00 01  01 16 03 03 00 40 00 00  |.............@..|
+000000f0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 fc 00  |................|
+00000100  41 6f 98 7c 46 97 e3 7c  29 d4 1a d7 7a b4 21 8f  |Ao.|F..|)...z.!.|
+00000110  5a db 3a fc e9 97 56 f3  f9 c6 de 34 0e 23 a7 62  |Z.:...V....4.#.b|
+00000120  bb 11 54 2d ce 3d 7a f1  6f 37 98 e7 29 0f        |..T-.=z.o7..).|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 16 03  03 00 40 3f f0 78 82 66  |..........@?.x.f|
-00000010  1c 1c 9b cf a0 13 30 13  02 ba 01 1f e6 ee e3 51  |......0........Q|
-00000020  66 b6 2d 0b 39 b5 6b 5f  d3 e3 51 e5 b0 03 cd 5e  |f.-.9.k_..Q....^|
-00000030  5b 16 28 cf dc f2 9b c9  fa cd b7 3d 30 e9 79 50  |[.(........=0.yP|
-00000040  1d 73 b2 0a 66 b1 d3 c3  a4 f3 af                 |.s..f......|
+00000000  14 03 03 00 01 01 16 03  03 00 40 eb ea a1 34 71  |..........@...4q|
+00000010  ef 62 a4 f7 2b ad 63 3a  8b 6f f7 b3 a4 fe 08 60  |.b..+.c:.o.....`|
+00000020  c4 6c 5f 01 df d8 be 9b  17 24 2a 0a d0 27 ec 96  |.l_......$*..'..|
+00000030  6c 7f bc a1 95 c9 ce 8d  03 86 3c e3 b5 bc 0d 37  |l.........<....7|
+00000040  17 22 21 c7 d4 e5 c5 20  33 f7 fd                 |."!.... 3..|
 >>> Flow 4 (server to client)
 00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000010  00 00 00 00 00 3a 2b 11  b9 79 12 43 3d 22 ac 93  |.....:+..y.C="..|
-00000020  b6 31 4a 21 61 0a f2 bf  c4 e3 9a c7 8f de 13 eb  |.1J!a...........|
-00000030  d4 0f 42 55 b5 89 1f 64  61 2b c6 c6 79 fe d1 70  |..BU...da+..y..p|
-00000040  3c 70 e2 ad cc 15 03 03  00 30 00 00 00 00 00 00  |<p.......0......|
-00000050  00 00 00 00 00 00 00 00  00 00 00 59 94 cc f6 ad  |...........Y....|
-00000060  c2 70 88 42 55 91 c6 a3  f5 67 52 36 24 ef dc da  |.p.BU....gR6$...|
-00000070  0c fb 0d a2 7f 77 8a 24  e2 f7                    |.....w.$..|
+00000010  00 00 00 00 00 87 f6 ae  c9 fc b6 e8 fa f5 9d 72  |...............r|
+00000020  a4 f0 55 1f 12 1d 4b 50  37 44 79 5e 0e 8d 96 f8  |..U...KP7Dy^....|
+00000030  d4 e0 b0 43 dd 6e 40 d4  39 b4 a6 e1 b7 07 3c 91  |...C.n@.9.....<.|
+00000040  72 11 5a 80 9e 15 03 03  00 30 00 00 00 00 00 00  |r.Z......0......|
+00000050  00 00 00 00 00 00 00 00  00 00 4d a1 31 bd 5a a9  |..........M.1.Z.|
+00000060  0a 44 66 53 68 a4 20 ef  ac 8e d3 25 2f 73 45 d3  |.DfSh. ....%/sE.|
+00000070  4f 5a dd 0f 5b a6 7f 47  ab cd                    |OZ..[..G..|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ResumeDisabled b/src/crypto/tls/testdata/Server-TLSv12-ResumeDisabled
index 339fd9a0f2..9110f54350 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ResumeDisabled
+++ b/src/crypto/tls/testdata/Server-TLSv12-ResumeDisabled
@@ -1,91 +1,91 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 12 01 00 01  0e 03 03 b8 aa 9b e6 98  |................|
-00000010  be 93 d6 03 f2 cd 62 23  76 dd 74 6c 48 ac 9a f6  |......b#v.tlH...|
-00000020  f3 27 62 93 6e 99 b2 0d  54 af b7 20 2d 20 97 9a  |.'b.n...T.. - ..|
-00000030  c8 88 50 65 95 2a 02 8f  7b 47 77 6d 3c 49 ba a9  |..Pe.*..{Gwm<I..|
-00000040  0c 8a 68 0d b9 30 64 c9  c1 f0 d4 61 00 04 00 2f  |..h..0d....a.../|
-00000050  00 ff 01 00 00 c1 00 23  00 81 50 46 ad c1 db a8  |.......#..PF....|
-00000060  38 86 7b 2b bb fd d0 c3  42 3e 00 00 00 00 00 00  |8.{+....B>......|
-00000070  00 00 00 00 00 00 00 00  00 00 94 6f 2c 9f 83 51  |...........o,..Q|
-00000080  ed 14 ef 68 ca 42 c5 4c  20 33 6c 01 97 a5 69 44  |...h.B.L 3l...iD|
-00000090  bf 8f ea db 83 05 fb ef  cc 51 1f 0b 4d 44 77 89  |.........Q..MDw.|
-000000a0  11 cf c8 38 16 67 ea a2  3e 8b 2a 18 f2 f7 25 ce  |...8.g..>.*...%.|
-000000b0  e0 d8 4c 93 31 b0 59 23  49 38 16 3a f9 63 9e 61  |..L.1.Y#I8.:.c.a|
-000000c0  21 1b ab 67 09 6a 23 07  8e d0 4a 19 78 9c 1e 60  |!..g.j#...J.x..`|
-000000d0  40 a7 83 c5 9a 48 41 35  c4 e9 63 00 16 00 00 00  |@....HA5..c.....|
-000000e0  17 00 00 00 0d 00 30 00  2e 04 03 05 03 06 03 08  |......0.........|
-000000f0  07 08 08 08 09 08 0a 08  0b 08 04 08 05 08 06 04  |................|
-00000100  01 05 01 06 01 03 03 02  03 03 01 02 01 03 02 02  |................|
-00000110  02 04 02 05 02 06 02                              |.......|
+00000000  16 03 01 01 06 01 00 01  02 03 03 dc 6d 25 a7 37  |............m%.7|
+00000010  5a 18 ef e8 ba a7 4b cb  25 8b 5a 61 bd fd 99 56  |Z.....K.%.Za...V|
+00000020  a8 7f 10 26 f7 f4 e9 3e  16 89 ce 20 ac c3 35 13  |...&...>... ..5.|
+00000030  d1 28 31 15 15 2d 6b e9  50 20 07 2c c5 48 6c 21  |.(1..-k.P .,.Hl!|
+00000040  78 bf c9 7c c4 39 e7 2e  0a ed 71 21 00 04 00 2f  |x..|.9....q!.../|
+00000050  00 ff 01 00 00 b5 00 23  00 75 00 00 00 00 00 00  |.......#.u......|
+00000060  00 00 00 00 00 00 00 00  00 00 94 6f 2d b0 ac 51  |...........o-..Q|
+00000070  ed 14 ef 68 ca 42 c5 4c  22 21 0e 9f b0 e7 07 47  |...h.B.L"!.....G|
+00000080  1d 09 01 ee 9b 67 49 2f  06 cb 51 1b d9 33 b3 ff  |.....gI/..Q..3..|
+00000090  30 6c d4 a3 d6 6b 49 aa  f8 2e 20 35 79 5a 76 91  |0l...kI... 5yZv.|
+000000a0  46 71 26 91 22 4f 32 50  49 38 16 7f 51 5c e5 47  |Fq&."O2PI8..Q\.G|
+000000b0  26 64 f4 0c dd 12 66 59  0d 8f 92 07 ab ff 68 01  |&d....fY......h.|
+000000c0  0d d5 54 06 2d 08 b1 09  a1 3c ff f9 bc 78 03 00  |..T.-....<...x..|
+000000d0  16 00 00 00 17 00 00 00  0d 00 30 00 2e 04 03 05  |..........0.....|
+000000e0  03 06 03 08 07 08 08 08  09 08 0a 08 0b 08 04 08  |................|
+000000f0  05 08 06 04 01 05 01 06  01 03 03 02 03 03 01 02  |................|
+00000100  01 03 02 02 02 04 02 05  02 06 02                 |...........|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 31 02 00 00  2d 03 03 00 00 00 00 00  |....1...-.......|
+00000000  16 03 03 00 35 02 00 00  31 03 03 00 00 00 00 00  |....5...1.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 00 2f 00 00  |...DOWNGRD.../..|
-00000030  05 ff 01 00 01 00 16 03  03 02 59 0b 00 02 55 00  |..........Y...U.|
-00000040  02 52 00 02 4f 30 82 02  4b 30 82 01 b4 a0 03 02  |.R..O0..K0......|
-00000050  01 02 02 09 00 e8 f0 9d  3f e2 5b ea a6 30 0d 06  |........?.[..0..|
-00000060  09 2a 86 48 86 f7 0d 01  01 0b 05 00 30 1f 31 0b  |.*.H........0.1.|
-00000070  30 09 06 03 55 04 0a 13  02 47 6f 31 10 30 0e 06  |0...U....Go1.0..|
-00000080  03 55 04 03 13 07 47 6f  20 52 6f 6f 74 30 1e 17  |.U....Go Root0..|
-00000090  0d 31 36 30 31 30 31 30  30 30 30 30 30 5a 17 0d  |.160101000000Z..|
-000000a0  32 35 30 31 30 31 30 30  30 30 30 30 5a 30 1a 31  |250101000000Z0.1|
-000000b0  0b 30 09 06 03 55 04 0a  13 02 47 6f 31 0b 30 09  |.0...U....Go1.0.|
-000000c0  06 03 55 04 03 13 02 47  6f 30 81 9f 30 0d 06 09  |..U....Go0..0...|
-000000d0  2a 86 48 86 f7 0d 01 01  01 05 00 03 81 8d 00 30  |*.H............0|
-000000e0  81 89 02 81 81 00 db 46  7d 93 2e 12 27 06 48 bc  |.......F}...'.H.|
-000000f0  06 28 21 ab 7e c4 b6 a2  5d fe 1e 52 45 88 7a 36  |.(!.~...]..RE.z6|
-00000100  47 a5 08 0d 92 42 5b c2  81 c0 be 97 79 98 40 fb  |G....B[.....y.@.|
-00000110  4f 6d 14 fd 2b 13 8b c2  a5 2e 67 d8 d4 09 9e d6  |Om..+.....g.....|
-00000120  22 38 b7 4a 0b 74 73 2b  c2 34 f1 d1 93 e5 96 d9  |"8.J.ts+.4......|
-00000130  74 7b f3 58 9f 6c 61 3c  c0 b0 41 d4 d9 2b 2b 24  |t{.X.la<..A..++$|
-00000140  23 77 5b 1c 3b bd 75 5d  ce 20 54 cf a1 63 87 1d  |#w[.;.u]. T..c..|
-00000150  1e 24 c4 f3 1d 1a 50 8b  aa b6 14 43 ed 97 a7 75  |.$....P....C...u|
-00000160  62 f4 14 c8 52 d7 02 03  01 00 01 a3 81 93 30 81  |b...R.........0.|
-00000170  90 30 0e 06 03 55 1d 0f  01 01 ff 04 04 03 02 05  |.0...U..........|
-00000180  a0 30 1d 06 03 55 1d 25  04 16 30 14 06 08 2b 06  |.0...U.%..0...+.|
-00000190  01 05 05 07 03 01 06 08  2b 06 01 05 05 07 03 02  |........+.......|
-000001a0  30 0c 06 03 55 1d 13 01  01 ff 04 02 30 00 30 19  |0...U.......0.0.|
-000001b0  06 03 55 1d 0e 04 12 04  10 9f 91 16 1f 43 43 3e  |..U..........CC>|
-000001c0  49 a6 de 6d b6 80 d7 9f  60 30 1b 06 03 55 1d 23  |I..m....`0...U.#|
-000001d0  04 14 30 12 80 10 48 13  49 4d 13 7e 16 31 bb a3  |..0...H.IM.~.1..|
-000001e0  01 d5 ac ab 6e 7b 30 19  06 03 55 1d 11 04 12 30  |....n{0...U....0|
-000001f0  10 82 0e 65 78 61 6d 70  6c 65 2e 67 6f 6c 61 6e  |...example.golan|
-00000200  67 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |g0...*.H........|
-00000210  03 81 81 00 9d 30 cc 40  2b 5b 50 a0 61 cb ba e5  |.....0.@+[P.a...|
-00000220  53 58 e1 ed 83 28 a9 58  1a a9 38 a4 95 a1 ac 31  |SX...(.X..8....1|
-00000230  5a 1a 84 66 3d 43 d3 2d  d9 0b f2 97 df d3 20 64  |Z..f=C.-...... d|
-00000240  38 92 24 3a 00 bc cf 9c  7d b7 40 20 01 5f aa d3  |8.$:....}.@ ._..|
-00000250  16 61 09 a2 76 fd 13 c3  cc e1 0c 5c ee b1 87 82  |.a..v......\....|
-00000260  f1 6c 04 ed 73 bb b3 43  77 8d 0c 1c f1 0f a1 d8  |.l..s..Cw.......|
-00000270  40 83 61 c9 4c 72 2b 9d  ae db 46 06 06 4d f4 c1  |@.a.Lr+...F..M..|
-00000280  b3 3e c0 d1 bd 42 d4 db  fe 3d 13 60 84 5c 21 d3  |.>...B...=.`.\!.|
-00000290  3b e9 fa e7 16 03 03 00  04 0e 00 00 00           |;............|
+00000030  09 ff 01 00 01 00 00 17  00 00 16 03 03 02 59 0b  |..............Y.|
+00000040  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
+00000050  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
+00000060  a6 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |.0...*.H........|
+00000070  30 1f 31 0b 30 09 06 03  55 04 0a 13 02 47 6f 31  |0.1.0...U....Go1|
+00000080  10 30 0e 06 03 55 04 03  13 07 47 6f 20 52 6f 6f  |.0...U....Go Roo|
+00000090  74 30 1e 17 0d 31 36 30  31 30 31 30 30 30 30 30  |t0...16010100000|
+000000a0  30 5a 17 0d 32 35 30 31  30 31 30 30 30 30 30 30  |0Z..250101000000|
+000000b0  5a 30 1a 31 0b 30 09 06  03 55 04 0a 13 02 47 6f  |Z0.1.0...U....Go|
+000000c0  31 0b 30 09 06 03 55 04  03 13 02 47 6f 30 81 9f  |1.0...U....Go0..|
+000000d0  30 0d 06 09 2a 86 48 86  f7 0d 01 01 01 05 00 03  |0...*.H.........|
+000000e0  81 8d 00 30 81 89 02 81  81 00 db 46 7d 93 2e 12  |...0.......F}...|
+000000f0  27 06 48 bc 06 28 21 ab  7e c4 b6 a2 5d fe 1e 52  |'.H..(!.~...]..R|
+00000100  45 88 7a 36 47 a5 08 0d  92 42 5b c2 81 c0 be 97  |E.z6G....B[.....|
+00000110  79 98 40 fb 4f 6d 14 fd  2b 13 8b c2 a5 2e 67 d8  |y.@.Om..+.....g.|
+00000120  d4 09 9e d6 22 38 b7 4a  0b 74 73 2b c2 34 f1 d1  |...."8.J.ts+.4..|
+00000130  93 e5 96 d9 74 7b f3 58  9f 6c 61 3c c0 b0 41 d4  |....t{.X.la<..A.|
+00000140  d9 2b 2b 24 23 77 5b 1c  3b bd 75 5d ce 20 54 cf  |.++$#w[.;.u]. T.|
+00000150  a1 63 87 1d 1e 24 c4 f3  1d 1a 50 8b aa b6 14 43  |.c...$....P....C|
+00000160  ed 97 a7 75 62 f4 14 c8  52 d7 02 03 01 00 01 a3  |...ub...R.......|
+00000170  81 93 30 81 90 30 0e 06  03 55 1d 0f 01 01 ff 04  |..0..0...U......|
+00000180  04 03 02 05 a0 30 1d 06  03 55 1d 25 04 16 30 14  |.....0...U.%..0.|
+00000190  06 08 2b 06 01 05 05 07  03 01 06 08 2b 06 01 05  |..+.........+...|
+000001a0  05 07 03 02 30 0c 06 03  55 1d 13 01 01 ff 04 02  |....0...U.......|
+000001b0  30 00 30 19 06 03 55 1d  0e 04 12 04 10 9f 91 16  |0.0...U.........|
+000001c0  1f 43 43 3e 49 a6 de 6d  b6 80 d7 9f 60 30 1b 06  |.CC>I..m....`0..|
+000001d0  03 55 1d 23 04 14 30 12  80 10 48 13 49 4d 13 7e  |.U.#..0...H.IM.~|
+000001e0  16 31 bb a3 01 d5 ac ab  6e 7b 30 19 06 03 55 1d  |.1......n{0...U.|
+000001f0  11 04 12 30 10 82 0e 65  78 61 6d 70 6c 65 2e 67  |...0...example.g|
+00000200  6f 6c 61 6e 67 30 0d 06  09 2a 86 48 86 f7 0d 01  |olang0...*.H....|
+00000210  01 0b 05 00 03 81 81 00  9d 30 cc 40 2b 5b 50 a0  |.........0.@+[P.|
+00000220  61 cb ba e5 53 58 e1 ed  83 28 a9 58 1a a9 38 a4  |a...SX...(.X..8.|
+00000230  95 a1 ac 31 5a 1a 84 66  3d 43 d3 2d d9 0b f2 97  |...1Z..f=C.-....|
+00000240  df d3 20 64 38 92 24 3a  00 bc cf 9c 7d b7 40 20  |.. d8.$:....}.@ |
+00000250  01 5f aa d3 16 61 09 a2  76 fd 13 c3 cc e1 0c 5c  |._...a..v......\|
+00000260  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
+00000270  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
+00000280  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
+00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 04 0e 00 00  |.\!.;...........|
+000002a0  00                                                |.|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 1f e2 43 ee 88  |.............C..|
-00000010  22 0d a0 66 18 ce 8a 04  d1 00 fc 2b 6b 93 d5 b6  |"..f.......+k...|
-00000020  fd 13 48 fd ea 19 d8 5d  02 bf 8c d9 fb 64 e8 17  |..H....].....d..|
-00000030  a3 49 dc 1d 4d b7 8c eb  7d 8b 1d 13 20 78 4e 02  |.I..M...}... xN.|
-00000040  49 7e a5 bd dd 57 ac 45  47 e6 ea 2e 87 6f d2 ca  |I~...W.EG....o..|
-00000050  e6 ef a4 9e 2d 3a 02 22  2e 67 6f ff 2d 78 6c 7d  |....-:.".go.-xl}|
-00000060  33 a1 4c 5b ec d5 ae cb  4f db c0 7d 75 01 61 fa  |3.L[....O..}u.a.|
-00000070  c2 8a dc 75 77 51 60 90  5d 35 45 ca 13 bb 1a c4  |...uwQ`.]5E.....|
-00000080  eb f3 74 ef 77 ec 23 ec  98 30 3c 14 03 03 00 01  |..t.w.#..0<.....|
-00000090  01 16 03 03 00 40 7a 07  bc 74 d3 6f ef 93 22 69  |.....@z..t.o.."i|
-000000a0  a8 05 df df db 5e 58 1e  4b 84 4f 20 7c f5 2c c3  |.....^X.K.O |.,.|
-000000b0  0d 51 0a a8 d0 a8 f0 07  02 d5 ca ec f2 4b 3f ef  |.Q...........K?.|
-000000c0  c9 57 cb 9b 26 2e 62 e7  f2 84 6e ed b9 6e 1d 15  |.W..&.b...n..n..|
-000000d0  32 8c d6 b8 0d 8a                                 |2.....|
+00000000  16 03 03 00 86 10 00 00  82 00 80 c0 3f 68 b7 3f  |............?h.?|
+00000010  6c 1f de 6b 2d 67 9e 1b  13 13 ad 67 d8 0f b2 b1  |l..k-g.....g....|
+00000020  95 17 e7 0b e1 ba 6f 93  20 43 aa c7 a4 02 8e 38  |......o. C.....8|
+00000030  01 6b 53 55 33 6e 82 ea  70 d7 e2 a6 bd be 57 2d  |.kSU3n..p.....W-|
+00000040  85 1c 4a 28 30 42 34 e6  f9 38 9c 59 ed 1c fc ff  |..J(0B4..8.Y....|
+00000050  19 0f 1d 71 f1 4b 2a 7a  b1 c6 d9 11 a5 5e ca 1c  |...q.K*z.....^..|
+00000060  14 70 71 4c 3a c8 8d ca  d9 4b 57 f8 76 2c 8f 89  |.pqL:....KW.v,..|
+00000070  84 41 96 fb 37 2d 17 a9  28 c8 c6 47 1b fb 3d 42  |.A..7-..(..G..=B|
+00000080  64 12 8f c7 e7 36 35 bf  ce df d7 14 03 03 00 01  |d....65.........|
+00000090  01 16 03 03 00 40 47 f9  4a d1 3b af 27 48 8a 15  |.....@G.J.;.'H..|
+000000a0  c1 61 61 41 cc c3 4f 1d  9c 86 42 a9 17 1d e3 68  |.aaA..O...B....h|
+000000b0  84 1f ae b7 9f 4b 70 be  72 0b 2c 48 88 ea ff 43  |.....Kp.r.,H...C|
+000000c0  37 01 cc 37 c0 2d e9 da  8b 94 ef ed f9 02 95 a9  |7..7.-..........|
+000000d0  bf 63 0f 6a 7c c0                                 |.c.j|.|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 67 e1 22 17 24  |...........g.".$|
-00000020  95 b4 e5 62 59 15 56 4a  af e4 82 76 ad b7 48 81  |...bY.VJ...v..H.|
-00000030  cf 55 d1 75 cd 36 86 0d  9d 15 24 4b 84 23 bc 98  |.U.u.6....$K.#..|
-00000040  8e c4 62 57 ab 96 0c 27  5d 1c 07 17 03 03 00 40  |..bW...']......@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 4a bf f1 2b 6a  |...........J..+j|
+00000020  af e5 b9 51 69 38 3e a3  47 bf 0b 67 83 15 e0 91  |...Qi8>.G..g....|
+00000030  c6 b3 cb fc 24 05 31 b7  51 3d fa bb 08 9a f9 f8  |....$.1.Q=......|
+00000040  89 2a f1 5a b1 a8 1a ed  aa 63 00 17 03 03 00 40  |.*.Z.....c.....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  c9 b2 0e 04 40 43 26 92  91 45 e3 63 d7 49 09 3e  |....@C&..E.c.I.>|
-00000070  03 45 e3 d6 af a2 d8 d9  61 36 e5 95 83 75 66 fa  |.E......a6...uf.|
-00000080  90 c2 80 53 a2 d5 31 aa  b1 2a da 45 a9 b3 aa 1f  |...S..1..*.E....|
+00000060  80 37 dc f6 b1 a2 80 91  0e c9 71 c6 1c 1e 45 14  |.7........q...E.|
+00000070  50 cd 39 85 73 8a f5 90  75 28 05 ab 69 ae 1a bd  |P.9.s...u(..i...|
+00000080  b9 ee 39 e8 3f 2d 73 4d  21 fa 2e 05 b4 a1 02 64  |..9.?-sM!......d|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 c4 52 cf  b9 f6 0f e2 30 ba 90 18  |......R.....0...|
-000000b0  0c 76 c2 ee 4c 78 fb c2  cb 34 7f cb 35 15 5e b0  |.v..Lx...4..5.^.|
-000000c0  17 70 cb 76 8a                                    |.p.v.|
+000000a0  00 00 00 00 00 14 1e f7  64 d8 47 a6 93 aa 03 aa  |........d.G.....|
+000000b0  7c f3 a2 fb b8 6f cf f2  0d e4 2d d1 d6 67 f3 6b  ||....o....-..g.k|
+000000c0  ef e3 5d dc 5b                                    |..].[|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-SNI b/src/crypto/tls/testdata/Server-TLSv12-SNI
index 0ea8375fc5..c3dc1b6e52 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-SNI
+++ b/src/crypto/tls/testdata/Server-TLSv12-SNI
@@ -1,84 +1,83 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 99 01 00 00  95 03 03 fb d6 71 b2 32  |.............q.2|
-00000010  74 6c e1 56 19 42 e6 46  a2 0e 37 1f ad 96 4b af  |tl.V.B.F..7...K.|
-00000020  8b 4c aa 71 2a 53 d8 df  74 7d 39 00 00 04 00 2f  |.L.q*S..t}9..../|
-00000030  00 ff 01 00 00 68 00 00  00 10 00 0e 00 00 0b 73  |.....h.........s|
-00000040  6e 69 74 65 73 74 2e 63  6f 6d 00 0b 00 04 03 00  |nitest.com......|
-00000050  01 02 00 0a 00 0c 00 0a  00 1d 00 17 00 1e 00 19  |................|
-00000060  00 18 00 16 00 00 00 17  00 00 00 0d 00 30 00 2e  |.............0..|
-00000070  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
-00000080  08 04 08 05 08 06 04 01  05 01 06 01 03 03 02 03  |................|
-00000090  03 01 02 01 03 02 02 02  04 02 05 02 06 02        |..............|
+00000000  16 03 01 00 81 01 00 00  7d 03 03 cc a1 7b c4 56  |........}....{.V|
+00000010  9f 65 31 01 b0 23 09 18  10 50 7c 1e 14 7b b5 dd  |.e1..#...P|..{..|
+00000020  d4 70 07 3e 0b 19 19 31  6b f7 4d 00 00 04 00 2f  |.p.>...1k.M..../|
+00000030  00 ff 01 00 00 50 00 00  00 10 00 0e 00 00 0b 73  |.....P.........s|
+00000040  6e 69 74 65 73 74 2e 63  6f 6d 00 16 00 00 00 17  |nitest.com......|
+00000050  00 00 00 0d 00 30 00 2e  04 03 05 03 06 03 08 07  |.....0..........|
+00000060  08 08 08 09 08 0a 08 0b  08 04 08 05 08 06 04 01  |................|
+00000070  05 01 06 01 03 03 02 03  03 01 02 01 03 02 02 02  |................|
+00000080  04 02 05 02 06 02                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 37 02 00 00  33 03 03 00 00 00 00 00  |....7...3.......|
+00000000  16 03 03 00 35 02 00 00  31 03 03 00 00 00 00 00  |....5...1.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 00 2f 00 00  |...DOWNGRD.../..|
-00000030  0b ff 01 00 01 00 00 0b  00 02 01 00 16 03 03 02  |................|
-00000040  59 0b 00 02 55 00 02 52  00 02 4f 30 82 02 4b 30  |Y...U..R..O0..K0|
-00000050  82 01 b4 a0 03 02 01 02  02 09 00 e8 f0 9d 3f e2  |..............?.|
-00000060  5b ea a6 30 0d 06 09 2a  86 48 86 f7 0d 01 01 0b  |[..0...*.H......|
-00000070  05 00 30 1f 31 0b 30 09  06 03 55 04 0a 13 02 47  |..0.1.0...U....G|
-00000080  6f 31 10 30 0e 06 03 55  04 03 13 07 47 6f 20 52  |o1.0...U....Go R|
-00000090  6f 6f 74 30 1e 17 0d 31  36 30 31 30 31 30 30 30  |oot0...160101000|
-000000a0  30 30 30 5a 17 0d 32 35  30 31 30 31 30 30 30 30  |000Z..2501010000|
-000000b0  30 30 5a 30 1a 31 0b 30  09 06 03 55 04 0a 13 02  |00Z0.1.0...U....|
-000000c0  47 6f 31 0b 30 09 06 03  55 04 03 13 02 47 6f 30  |Go1.0...U....Go0|
-000000d0  81 9f 30 0d 06 09 2a 86  48 86 f7 0d 01 01 01 05  |..0...*.H.......|
-000000e0  00 03 81 8d 00 30 81 89  02 81 81 00 db 46 7d 93  |.....0.......F}.|
-000000f0  2e 12 27 06 48 bc 06 28  21 ab 7e c4 b6 a2 5d fe  |..'.H..(!.~...].|
-00000100  1e 52 45 88 7a 36 47 a5  08 0d 92 42 5b c2 81 c0  |.RE.z6G....B[...|
-00000110  be 97 79 98 40 fb 4f 6d  14 fd 2b 13 8b c2 a5 2e  |..y.@.Om..+.....|
-00000120  67 d8 d4 09 9e d6 22 38  b7 4a 0b 74 73 2b c2 34  |g....."8.J.ts+.4|
-00000130  f1 d1 93 e5 96 d9 74 7b  f3 58 9f 6c 61 3c c0 b0  |......t{.X.la<..|
-00000140  41 d4 d9 2b 2b 24 23 77  5b 1c 3b bd 75 5d ce 20  |A..++$#w[.;.u]. |
-00000150  54 cf a1 63 87 1d 1e 24  c4 f3 1d 1a 50 8b aa b6  |T..c...$....P...|
-00000160  14 43 ed 97 a7 75 62 f4  14 c8 52 d7 02 03 01 00  |.C...ub...R.....|
-00000170  01 a3 81 93 30 81 90 30  0e 06 03 55 1d 0f 01 01  |....0..0...U....|
-00000180  ff 04 04 03 02 05 a0 30  1d 06 03 55 1d 25 04 16  |.......0...U.%..|
-00000190  30 14 06 08 2b 06 01 05  05 07 03 01 06 08 2b 06  |0...+.........+.|
-000001a0  01 05 05 07 03 02 30 0c  06 03 55 1d 13 01 01 ff  |......0...U.....|
-000001b0  04 02 30 00 30 19 06 03  55 1d 0e 04 12 04 10 9f  |..0.0...U.......|
-000001c0  91 16 1f 43 43 3e 49 a6  de 6d b6 80 d7 9f 60 30  |...CC>I..m....`0|
-000001d0  1b 06 03 55 1d 23 04 14  30 12 80 10 48 13 49 4d  |...U.#..0...H.IM|
-000001e0  13 7e 16 31 bb a3 01 d5  ac ab 6e 7b 30 19 06 03  |.~.1......n{0...|
-000001f0  55 1d 11 04 12 30 10 82  0e 65 78 61 6d 70 6c 65  |U....0...example|
-00000200  2e 67 6f 6c 61 6e 67 30  0d 06 09 2a 86 48 86 f7  |.golang0...*.H..|
-00000210  0d 01 01 0b 05 00 03 81  81 00 9d 30 cc 40 2b 5b  |...........0.@+[|
-00000220  50 a0 61 cb ba e5 53 58  e1 ed 83 28 a9 58 1a a9  |P.a...SX...(.X..|
-00000230  38 a4 95 a1 ac 31 5a 1a  84 66 3d 43 d3 2d d9 0b  |8....1Z..f=C.-..|
-00000240  f2 97 df d3 20 64 38 92  24 3a 00 bc cf 9c 7d b7  |.... d8.$:....}.|
-00000250  40 20 01 5f aa d3 16 61  09 a2 76 fd 13 c3 cc e1  |@ ._...a..v.....|
-00000260  0c 5c ee b1 87 82 f1 6c  04 ed 73 bb b3 43 77 8d  |.\.....l..s..Cw.|
-00000270  0c 1c f1 0f a1 d8 40 83  61 c9 4c 72 2b 9d ae db  |......@.a.Lr+...|
-00000280  46 06 06 4d f4 c1 b3 3e  c0 d1 bd 42 d4 db fe 3d  |F..M...>...B...=|
-00000290  13 60 84 5c 21 d3 3b e9  fa e7 16 03 03 00 04 0e  |.`.\!.;.........|
-000002a0  00 00 00                                          |...|
+00000030  09 ff 01 00 01 00 00 17  00 00 16 03 03 02 59 0b  |..............Y.|
+00000040  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
+00000050  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
+00000060  a6 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |.0...*.H........|
+00000070  30 1f 31 0b 30 09 06 03  55 04 0a 13 02 47 6f 31  |0.1.0...U....Go1|
+00000080  10 30 0e 06 03 55 04 03  13 07 47 6f 20 52 6f 6f  |.0...U....Go Roo|
+00000090  74 30 1e 17 0d 31 36 30  31 30 31 30 30 30 30 30  |t0...16010100000|
+000000a0  30 5a 17 0d 32 35 30 31  30 31 30 30 30 30 30 30  |0Z..250101000000|
+000000b0  5a 30 1a 31 0b 30 09 06  03 55 04 0a 13 02 47 6f  |Z0.1.0...U....Go|
+000000c0  31 0b 30 09 06 03 55 04  03 13 02 47 6f 30 81 9f  |1.0...U....Go0..|
+000000d0  30 0d 06 09 2a 86 48 86  f7 0d 01 01 01 05 00 03  |0...*.H.........|
+000000e0  81 8d 00 30 81 89 02 81  81 00 db 46 7d 93 2e 12  |...0.......F}...|
+000000f0  27 06 48 bc 06 28 21 ab  7e c4 b6 a2 5d fe 1e 52  |'.H..(!.~...]..R|
+00000100  45 88 7a 36 47 a5 08 0d  92 42 5b c2 81 c0 be 97  |E.z6G....B[.....|
+00000110  79 98 40 fb 4f 6d 14 fd  2b 13 8b c2 a5 2e 67 d8  |y.@.Om..+.....g.|
+00000120  d4 09 9e d6 22 38 b7 4a  0b 74 73 2b c2 34 f1 d1  |...."8.J.ts+.4..|
+00000130  93 e5 96 d9 74 7b f3 58  9f 6c 61 3c c0 b0 41 d4  |....t{.X.la<..A.|
+00000140  d9 2b 2b 24 23 77 5b 1c  3b bd 75 5d ce 20 54 cf  |.++$#w[.;.u]. T.|
+00000150  a1 63 87 1d 1e 24 c4 f3  1d 1a 50 8b aa b6 14 43  |.c...$....P....C|
+00000160  ed 97 a7 75 62 f4 14 c8  52 d7 02 03 01 00 01 a3  |...ub...R.......|
+00000170  81 93 30 81 90 30 0e 06  03 55 1d 0f 01 01 ff 04  |..0..0...U......|
+00000180  04 03 02 05 a0 30 1d 06  03 55 1d 25 04 16 30 14  |.....0...U.%..0.|
+00000190  06 08 2b 06 01 05 05 07  03 01 06 08 2b 06 01 05  |..+.........+...|
+000001a0  05 07 03 02 30 0c 06 03  55 1d 13 01 01 ff 04 02  |....0...U.......|
+000001b0  30 00 30 19 06 03 55 1d  0e 04 12 04 10 9f 91 16  |0.0...U.........|
+000001c0  1f 43 43 3e 49 a6 de 6d  b6 80 d7 9f 60 30 1b 06  |.CC>I..m....`0..|
+000001d0  03 55 1d 23 04 14 30 12  80 10 48 13 49 4d 13 7e  |.U.#..0...H.IM.~|
+000001e0  16 31 bb a3 01 d5 ac ab  6e 7b 30 19 06 03 55 1d  |.1......n{0...U.|
+000001f0  11 04 12 30 10 82 0e 65  78 61 6d 70 6c 65 2e 67  |...0...example.g|
+00000200  6f 6c 61 6e 67 30 0d 06  09 2a 86 48 86 f7 0d 01  |olang0...*.H....|
+00000210  01 0b 05 00 03 81 81 00  9d 30 cc 40 2b 5b 50 a0  |.........0.@+[P.|
+00000220  61 cb ba e5 53 58 e1 ed  83 28 a9 58 1a a9 38 a4  |a...SX...(.X..8.|
+00000230  95 a1 ac 31 5a 1a 84 66  3d 43 d3 2d d9 0b f2 97  |...1Z..f=C.-....|
+00000240  df d3 20 64 38 92 24 3a  00 bc cf 9c 7d b7 40 20  |.. d8.$:....}.@ |
+00000250  01 5f aa d3 16 61 09 a2  76 fd 13 c3 cc e1 0c 5c  |._...a..v......\|
+00000260  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
+00000270  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
+00000280  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
+00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 04 0e 00 00  |.\!.;...........|
+000002a0  00                                                |.|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 a4 48 88 75 7b  |............H.u{|
-00000010  a2 04 19 14 69 30 12 d6  14 00 0c 44 e4 68 06 c6  |....i0.....D.h..|
-00000020  11 56 53 0c e5 52 fb 84  e2 6e b7 c6 eb 0d 79 25  |.VS..R...n....y%|
-00000030  19 f0 bf e4 51 73 85 d5  82 5a 07 53 b2 65 97 6a  |....Qs...Z.S.e.j|
-00000040  a1 1b 56 bb 23 35 15 83  0f 60 ee de 16 a2 ea 61  |..V.#5...`.....a|
-00000050  23 10 e1 5e cf 73 fe 5d  5a 53 16 42 0c 29 a5 ff  |#..^.s.]ZS.B.)..|
-00000060  06 e5 c4 87 11 d6 24 91  25 e5 58 81 40 80 9e 71  |......$.%.X.@..q|
-00000070  49 40 47 50 37 28 7b ed  76 cc 5a fb 04 ba 9c f8  |I@GP7({.v.Z.....|
-00000080  be ce 87 07 75 d2 30 88  09 cf bc 14 03 03 00 01  |....u.0.........|
-00000090  01 16 03 03 00 40 60 1c  31 95 7d c2 a9 9b 29 c2  |.....@`.1.}...).|
-000000a0  ef 59 58 dd fb 26 34 81  60 dc 17 19 c1 23 8d 8f  |.YX..&4.`....#..|
-000000b0  a8 d2 62 31 96 3d d2 61  b9 c8 7e bf 47 4c 04 fd  |..b1.=.a..~.GL..|
-000000c0  7c 30 05 37 8e 03 df 13  a1 4d f1 81 05 d7 4c 49  ||0.7.....M....LI|
-000000d0  88 d6 c0 21 52 e3                                 |...!R.|
+00000000  16 03 03 00 86 10 00 00  82 00 80 04 36 4c 25 96  |............6L%.|
+00000010  b0 1a 33 80 88 98 4f 2a  c8 93 24 81 0a 78 6c 85  |..3...O*..$..xl.|
+00000020  06 4d f1 cf 25 18 e0 f0  61 50 c5 45 c1 24 1b b3  |.M..%...aP.E.$..|
+00000030  d6 3c d3 49 a6 40 81 2c  bb ef 49 76 c0 10 4c ad  |.<.I.@.,..Iv..L.|
+00000040  2e 7d 4d f4 0b 96 bc 1c  eb 3d 1d 7d 18 25 34 14  |.}M......=.}.%4.|
+00000050  ed 76 f2 a1 17 aa 87 1b  ef ff 11 93 a7 44 0c 33  |.v...........D.3|
+00000060  86 27 38 3d 5d 3f bb f1  8d a9 f5 44 28 d1 28 41  |.'8=]?.....D(.(A|
+00000070  bb b7 9a fb 83 81 91 92  4e 7d 71 55 43 ed 42 12  |........N}qUC.B.|
+00000080  86 5f de 02 13 1f c4 63  08 87 db 14 03 03 00 01  |._.....c........|
+00000090  01 16 03 03 00 40 32 01  5f a2 e1 08 cf 6b ce 11  |.....@2._....k..|
+000000a0  db 82 94 c5 f1 12 9a ac  68 dc f9 c8 2c 00 a5 dd  |........h...,...|
+000000b0  6b 49 c8 8b b7 9f e3 90  27 a5 c2 45 fc 75 e5 ac  |kI......'..E.u..|
+000000c0  77 0c 80 bd 43 41 d4 00  c0 fb 8d 08 a6 f4 f7 63  |w...CA.........c|
+000000d0  07 01 09 06 e5 fc                                 |......|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 73 15 54 76 ad  |...........s.Tv.|
-00000020  c4 38 b0 40 45 32 a8 ca  05 19 bd ce 6e 39 77 6b  |.8.@E2......n9wk|
-00000030  46 a7 f8 45 a8 cd cd 98  8c aa cf 46 83 f0 20 93  |F..E.......F.. .|
-00000040  0d 18 99 d4 2a f9 15 4a  2b f6 bf 17 03 03 00 40  |....*..J+......@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 6d 31 fe 01 3d  |...........m1..=|
+00000020  2a c3 97 67 9f 08 f8 c9  ce 57 5c 4a e6 da 17 f2  |*..g.....W\J....|
+00000030  f8 47 2b d9 9d 7e af 59  b8 a9 23 9d 7e d5 ed 77  |.G+..~.Y..#.~..w|
+00000040  3b cd d4 b7 76 5b 6f 6d  09 bd 0c 17 03 03 00 40  |;...v[om.......@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  79 8d 24 ef 72 b3 2c e2  10 a5 6d 3d 61 6c df c1  |y.$.r.,...m=al..|
-00000070  26 bf 7e b5 cd b2 8e 87  b9 54 bf ee 35 07 bc 55  |&.~......T..5..U|
-00000080  6c cd a2 d3 b4 bb 8c 63  fd ef b1 f0 2f 6d aa d9  |l......c..../m..|
+00000060  d2 8c 47 46 36 47 fa d8  f8 1c b4 fc f6 fd fb 4b  |..GF6G.........K|
+00000070  79 e1 a3 39 df ac 6c 94  61 dd 20 1a e7 c0 4c 9c  |y..9..l.a. ...L.|
+00000080  45 69 69 cf 73 cb b1 6c  fc 71 49 de 41 ca 4d 4f  |Eii.s..l.qI.A.MO|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 7b f7 81  e6 5c f2 5c 9d 45 ec 1f  |.....{...\.\.E..|
-000000b0  7b 0d f8 62 19 d4 83 a8  e5 90 71 03 6e 6a 72 4b  |{..b......q.njrK|
-000000c0  7e 64 c4 c4 1a                                    |~d...|
+000000a0  00 00 00 00 00 d1 66 64  ce 59 eb 23 13 e9 92 28  |......fd.Y.#...(|
+000000b0  a4 2a 7a b0 e1 79 ce 92  34 77 6e b3 8d d3 bb e6  |.*z..y..4wn.....|
+000000c0  ad 90 e8 a2 1a                                    |.....|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificate b/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificate
index 199253f073..474ab1ab10 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificate
+++ b/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificate
@@ -1,84 +1,83 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 99 01 00 00  95 03 03 cf 09 e7 0d ce  |................|
-00000010  ce d4 72 66 9d 30 e8 ee  39 b3 95 4c 3b 59 25 66  |..rf.0..9..L;Y%f|
-00000020  d2 f5 d3 82 68 7d e7 26  2e 38 97 00 00 04 00 2f  |....h}.&.8...../|
-00000030  00 ff 01 00 00 68 00 00  00 10 00 0e 00 00 0b 73  |.....h.........s|
-00000040  6e 69 74 65 73 74 2e 63  6f 6d 00 0b 00 04 03 00  |nitest.com......|
-00000050  01 02 00 0a 00 0c 00 0a  00 1d 00 17 00 1e 00 19  |................|
-00000060  00 18 00 16 00 00 00 17  00 00 00 0d 00 30 00 2e  |.............0..|
-00000070  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
-00000080  08 04 08 05 08 06 04 01  05 01 06 01 03 03 02 03  |................|
-00000090  03 01 02 01 03 02 02 02  04 02 05 02 06 02        |..............|
+00000000  16 03 01 00 81 01 00 00  7d 03 03 02 34 82 a7 1a  |........}...4...|
+00000010  fe 81 b0 1c 2e df cc 04  2d f7 22 39 34 95 c7 c1  |........-."94...|
+00000020  b2 92 a2 d2 aa ca 57 0f  9c be b4 00 00 04 00 2f  |......W......../|
+00000030  00 ff 01 00 00 50 00 00  00 10 00 0e 00 00 0b 73  |.....P.........s|
+00000040  6e 69 74 65 73 74 2e 63  6f 6d 00 16 00 00 00 17  |nitest.com......|
+00000050  00 00 00 0d 00 30 00 2e  04 03 05 03 06 03 08 07  |.....0..........|
+00000060  08 08 08 09 08 0a 08 0b  08 04 08 05 08 06 04 01  |................|
+00000070  05 01 06 01 03 03 02 03  03 01 02 01 03 02 02 02  |................|
+00000080  04 02 05 02 06 02                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 37 02 00 00  33 03 03 00 00 00 00 00  |....7...3.......|
+00000000  16 03 03 00 35 02 00 00  31 03 03 00 00 00 00 00  |....5...1.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 00 2f 00 00  |...DOWNGRD.../..|
-00000030  0b ff 01 00 01 00 00 0b  00 02 01 00 16 03 03 02  |................|
-00000040  59 0b 00 02 55 00 02 52  00 02 4f 30 82 02 4b 30  |Y...U..R..O0..K0|
-00000050  82 01 b4 a0 03 02 01 02  02 09 00 e8 f0 9d 3f e2  |..............?.|
-00000060  5b ea a6 30 0d 06 09 2a  86 48 86 f7 0d 01 01 0b  |[..0...*.H......|
-00000070  05 00 30 1f 31 0b 30 09  06 03 55 04 0a 13 02 47  |..0.1.0...U....G|
-00000080  6f 31 10 30 0e 06 03 55  04 03 13 07 47 6f 20 52  |o1.0...U....Go R|
-00000090  6f 6f 74 30 1e 17 0d 31  36 30 31 30 31 30 30 30  |oot0...160101000|
-000000a0  30 30 30 5a 17 0d 32 35  30 31 30 31 30 30 30 30  |000Z..2501010000|
-000000b0  30 30 5a 30 1a 31 0b 30  09 06 03 55 04 0a 13 02  |00Z0.1.0...U....|
-000000c0  47 6f 31 0b 30 09 06 03  55 04 03 13 02 47 6f 30  |Go1.0...U....Go0|
-000000d0  81 9f 30 0d 06 09 2a 86  48 86 f7 0d 01 01 01 05  |..0...*.H.......|
-000000e0  00 03 81 8d 00 30 81 89  02 81 81 00 db 46 7d 93  |.....0.......F}.|
-000000f0  2e 12 27 06 48 bc 06 28  21 ab 7e c4 b6 a2 5d fe  |..'.H..(!.~...].|
-00000100  1e 52 45 88 7a 36 47 a5  08 0d 92 42 5b c2 81 c0  |.RE.z6G....B[...|
-00000110  be 97 79 98 40 fb 4f 6d  14 fd 2b 13 8b c2 a5 2e  |..y.@.Om..+.....|
-00000120  67 d8 d4 09 9e d6 22 38  b7 4a 0b 74 73 2b c2 34  |g....."8.J.ts+.4|
-00000130  f1 d1 93 e5 96 d9 74 7b  f3 58 9f 6c 61 3c c0 b0  |......t{.X.la<..|
-00000140  41 d4 d9 2b 2b 24 23 77  5b 1c 3b bd 75 5d ce 20  |A..++$#w[.;.u]. |
-00000150  54 cf a1 63 87 1d 1e 24  c4 f3 1d 1a 50 8b aa b6  |T..c...$....P...|
-00000160  14 43 ed 97 a7 75 62 f4  14 c8 52 d7 02 03 01 00  |.C...ub...R.....|
-00000170  01 a3 81 93 30 81 90 30  0e 06 03 55 1d 0f 01 01  |....0..0...U....|
-00000180  ff 04 04 03 02 05 a0 30  1d 06 03 55 1d 25 04 16  |.......0...U.%..|
-00000190  30 14 06 08 2b 06 01 05  05 07 03 01 06 08 2b 06  |0...+.........+.|
-000001a0  01 05 05 07 03 02 30 0c  06 03 55 1d 13 01 01 ff  |......0...U.....|
-000001b0  04 02 30 00 30 19 06 03  55 1d 0e 04 12 04 10 9f  |..0.0...U.......|
-000001c0  91 16 1f 43 43 3e 49 a6  de 6d b6 80 d7 9f 60 30  |...CC>I..m....`0|
-000001d0  1b 06 03 55 1d 23 04 14  30 12 80 10 48 13 49 4d  |...U.#..0...H.IM|
-000001e0  13 7e 16 31 bb a3 01 d5  ac ab 6e 7b 30 19 06 03  |.~.1......n{0...|
-000001f0  55 1d 11 04 12 30 10 82  0e 65 78 61 6d 70 6c 65  |U....0...example|
-00000200  2e 67 6f 6c 61 6e 67 30  0d 06 09 2a 86 48 86 f7  |.golang0...*.H..|
-00000210  0d 01 01 0b 05 00 03 81  81 00 9d 30 cc 40 2b 5b  |...........0.@+[|
-00000220  50 a0 61 cb ba e5 53 58  e1 ed 83 28 a9 58 1a a9  |P.a...SX...(.X..|
-00000230  38 a4 95 a1 ac 31 5a 1a  84 66 3d 43 d3 2d d9 0b  |8....1Z..f=C.-..|
-00000240  f2 97 df d3 20 64 38 92  24 3a 00 bc cf 9c 7d b7  |.... d8.$:....}.|
-00000250  40 20 01 5f aa d3 16 61  09 a2 76 fd 13 c3 cc e1  |@ ._...a..v.....|
-00000260  0c 5c ee b1 87 82 f1 6c  04 ed 73 bb b3 43 77 8d  |.\.....l..s..Cw.|
-00000270  0c 1c f1 0f a1 d8 40 83  61 c9 4c 72 2b 9d ae db  |......@.a.Lr+...|
-00000280  46 06 06 4d f4 c1 b3 3e  c0 d1 bd 42 d4 db fe 3d  |F..M...>...B...=|
-00000290  13 60 84 5c 21 d3 3b e9  fa e7 16 03 03 00 04 0e  |.`.\!.;.........|
-000002a0  00 00 00                                          |...|
+00000030  09 ff 01 00 01 00 00 17  00 00 16 03 03 02 59 0b  |..............Y.|
+00000040  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
+00000050  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
+00000060  a6 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |.0...*.H........|
+00000070  30 1f 31 0b 30 09 06 03  55 04 0a 13 02 47 6f 31  |0.1.0...U....Go1|
+00000080  10 30 0e 06 03 55 04 03  13 07 47 6f 20 52 6f 6f  |.0...U....Go Roo|
+00000090  74 30 1e 17 0d 31 36 30  31 30 31 30 30 30 30 30  |t0...16010100000|
+000000a0  30 5a 17 0d 32 35 30 31  30 31 30 30 30 30 30 30  |0Z..250101000000|
+000000b0  5a 30 1a 31 0b 30 09 06  03 55 04 0a 13 02 47 6f  |Z0.1.0...U....Go|
+000000c0  31 0b 30 09 06 03 55 04  03 13 02 47 6f 30 81 9f  |1.0...U....Go0..|
+000000d0  30 0d 06 09 2a 86 48 86  f7 0d 01 01 01 05 00 03  |0...*.H.........|
+000000e0  81 8d 00 30 81 89 02 81  81 00 db 46 7d 93 2e 12  |...0.......F}...|
+000000f0  27 06 48 bc 06 28 21 ab  7e c4 b6 a2 5d fe 1e 52  |'.H..(!.~...]..R|
+00000100  45 88 7a 36 47 a5 08 0d  92 42 5b c2 81 c0 be 97  |E.z6G....B[.....|
+00000110  79 98 40 fb 4f 6d 14 fd  2b 13 8b c2 a5 2e 67 d8  |y.@.Om..+.....g.|
+00000120  d4 09 9e d6 22 38 b7 4a  0b 74 73 2b c2 34 f1 d1  |...."8.J.ts+.4..|
+00000130  93 e5 96 d9 74 7b f3 58  9f 6c 61 3c c0 b0 41 d4  |....t{.X.la<..A.|
+00000140  d9 2b 2b 24 23 77 5b 1c  3b bd 75 5d ce 20 54 cf  |.++$#w[.;.u]. T.|
+00000150  a1 63 87 1d 1e 24 c4 f3  1d 1a 50 8b aa b6 14 43  |.c...$....P....C|
+00000160  ed 97 a7 75 62 f4 14 c8  52 d7 02 03 01 00 01 a3  |...ub...R.......|
+00000170  81 93 30 81 90 30 0e 06  03 55 1d 0f 01 01 ff 04  |..0..0...U......|
+00000180  04 03 02 05 a0 30 1d 06  03 55 1d 25 04 16 30 14  |.....0...U.%..0.|
+00000190  06 08 2b 06 01 05 05 07  03 01 06 08 2b 06 01 05  |..+.........+...|
+000001a0  05 07 03 02 30 0c 06 03  55 1d 13 01 01 ff 04 02  |....0...U.......|
+000001b0  30 00 30 19 06 03 55 1d  0e 04 12 04 10 9f 91 16  |0.0...U.........|
+000001c0  1f 43 43 3e 49 a6 de 6d  b6 80 d7 9f 60 30 1b 06  |.CC>I..m....`0..|
+000001d0  03 55 1d 23 04 14 30 12  80 10 48 13 49 4d 13 7e  |.U.#..0...H.IM.~|
+000001e0  16 31 bb a3 01 d5 ac ab  6e 7b 30 19 06 03 55 1d  |.1......n{0...U.|
+000001f0  11 04 12 30 10 82 0e 65  78 61 6d 70 6c 65 2e 67  |...0...example.g|
+00000200  6f 6c 61 6e 67 30 0d 06  09 2a 86 48 86 f7 0d 01  |olang0...*.H....|
+00000210  01 0b 05 00 03 81 81 00  9d 30 cc 40 2b 5b 50 a0  |.........0.@+[P.|
+00000220  61 cb ba e5 53 58 e1 ed  83 28 a9 58 1a a9 38 a4  |a...SX...(.X..8.|
+00000230  95 a1 ac 31 5a 1a 84 66  3d 43 d3 2d d9 0b f2 97  |...1Z..f=C.-....|
+00000240  df d3 20 64 38 92 24 3a  00 bc cf 9c 7d b7 40 20  |.. d8.$:....}.@ |
+00000250  01 5f aa d3 16 61 09 a2  76 fd 13 c3 cc e1 0c 5c  |._...a..v......\|
+00000260  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
+00000270  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
+00000280  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
+00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 04 0e 00 00  |.\!.;...........|
+000002a0  00                                                |.|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 04 57 b2 56 f0  |............W.V.|
-00000010  a5 fb c3 4d 4e 7d ba 29  18 04 ea 6e 66 d3 97 68  |...MN}.)...nf..h|
-00000020  58 4e c1 47 fe 30 42 4d  bf 5b 10 38 6a 01 83 98  |XN.G.0BM.[.8j...|
-00000030  2b e3 3a ac c8 67 e5 41  0c 5c 3f 88 d5 15 a2 ab  |+.:..g.A.\?.....|
-00000040  6a 2b 70 24 d8 40 78 c1  d9 58 78 04 4d 90 03 eb  |j+p$.@x..Xx.M...|
-00000050  3c b1 61 da 26 62 db b3  41 ab dc 94 22 44 66 b8  |<.a.&b..A..."Df.|
-00000060  49 2c fa 59 de c0 69 3c  20 f8 2f a5 e0 47 1d ec  |I,.Y..i< ./..G..|
-00000070  3c 49 2d 39 f6 41 09 06  79 5f 26 c4 12 3d 9c 8d  |<I-9.A..y_&..=..|
-00000080  16 7b 45 25 65 01 69 9c  a8 f7 90 14 03 03 00 01  |.{E%e.i.........|
-00000090  01 16 03 03 00 40 96 71  33 e6 7e 26 2c 52 9b a5  |.....@.q3.~&,R..|
-000000a0  b3 d2 4e a3 6a 8f 9f 2a  ec c6 23 51 6c 92 5d dd  |..N.j..*..#Ql.].|
-000000b0  6e dd f2 5f 28 5e 8d e4  1f 80 35 16 84 59 0f 36  |n.._(^....5..Y.6|
-000000c0  ce a4 36 16 18 09 a8 30  8b 73 f6 22 0a 8f 22 28  |..6....0.s.".."(|
-000000d0  00 62 d2 8e 19 82                                 |.b....|
+00000000  16 03 03 00 86 10 00 00  82 00 80 d9 90 3c 11 be  |.............<..|
+00000010  f3 48 de f0 8f 9e 12 ca  e0 ab 86 e0 7e e7 8b ea  |.H..........~...|
+00000020  1a 76 3e 65 8d 7a d6 1c  72 2a f7 1e aa 0a 12 8f  |.v>e.z..r*......|
+00000030  54 ac 33 95 9d 00 a9 a6  94 54 7b 6a d9 e3 f4 67  |T.3......T{j...g|
+00000040  a6 d3 b1 c1 5d 86 51 aa  63 67 6b 6e cb 3b 5e 59  |....].Q.cgkn.;^Y|
+00000050  02 c2 57 fd 37 39 1b 73  9a 61 b0 78 de e8 cc f8  |..W.79.s.a.x....|
+00000060  b3 01 11 e5 e9 31 85 4d  fe 60 d4 12 70 71 64 45  |.....1.M.`..pqdE|
+00000070  e8 7d fb be 5b 82 c0 c4  e1 57 09 2c f2 d7 a3 79  |.}..[....W.,...y|
+00000080  1c 40 08 e1 e6 cd e2 3e  e7 55 da 14 03 03 00 01  |.@.....>.U......|
+00000090  01 16 03 03 00 40 29 9e  b7 cf 5e 7c e9 40 91 5f  |.....@)...^|.@._|
+000000a0  b6 12 d4 42 ec 6a bc 03  d9 fa e4 d8 bf c7 2c c5  |...B.j........,.|
+000000b0  52 74 17 77 b1 aa 13 87  f0 81 da 0d ca 7f d9 ca  |Rt.w............|
+000000c0  18 46 55 62 3f 90 21 60  fa 85 8c 80 6b 23 45 e7  |.FUb?.!`....k#E.|
+000000d0  0b 6e 8c e2 c3 f6                                 |.n....|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 5e ea d1 03 d7  |...........^....|
-00000020  de 82 9a b4 07 52 46 16  fd 28 86 fe 17 2e 77 52  |.....RF..(....wR|
-00000030  67 8f ec 64 93 1e 8e c9  fc fb 69 61 47 78 1a 1b  |g..d......iaGx..|
-00000040  97 8d fc 56 76 f6 53 8b  62 53 4f 17 03 03 00 40  |...Vv.S.bSO....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 ee 8d 0f cd 15  |................|
+00000020  db b4 cd 25 27 b6 7e 9b  82 91 2f 01 e1 4f f9 0c  |...%'.~.../..O..|
+00000030  68 4c bf 26 2b 4b 49 f5  0a 67 8a 4f 12 35 37 75  |hL.&+KI..g.O.57u|
+00000040  16 fe cc 26 35 66 60 8c  ed 42 40 17 03 03 00 40  |...&5f`..B@....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  f8 17 e8 ba c4 fb 0b 76  f5 a8 2d 3c 48 44 73 da  |.......v..-<HDs.|
-00000070  dc 34 5d fe e4 23 85 28  38 df 1d fe c6 a6 32 35  |.4]..#.(8.....25|
-00000080  c6 bb 71 4a 6e ec e7 c4  4f e6 28 2b fc 06 5e ac  |..qJn...O.(+..^.|
+00000060  f5 7a ee 53 aa 85 bb 81  c4 57 68 12 f1 40 4c 20  |.z.S.....Wh..@L |
+00000070  2a ff fc 6c dd 73 65 fc  41 e6 5b 96 6b 35 2f 8a  |*..l.se.A.[.k5/.|
+00000080  62 49 4a da f4 df 93 a0  ab e1 12 4d 8d 34 2c 6a  |bIJ........M.4,j|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 b0 5a ef  20 24 de e4 16 ad 7e 54  |......Z. $....~T|
-000000b0  43 d1 22 a8 fb a6 a4 98  54 74 58 2d 5c af 34 24  |C.".....TtX-\.4$|
-000000c0  89 d1 ab 32 8b                                    |...2.|
+000000a0  00 00 00 00 00 1c 08 e5  52 29 79 d6 15 07 10 44  |........R)y....D|
+000000b0  95 07 07 cb 3b 2b 37 2f  e3 dc 17 f9 27 b6 5d 44  |....;+7/....'.]D|
+000000c0  d0 30 4b 2e 21                                    |.0K.!|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificateNotFound b/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificateNotFound
index 870e8fab82..0c06ce98d7 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificateNotFound
+++ b/src/crypto/tls/testdata/Server-TLSv12-SNI-GetCertificateNotFound
@@ -1,84 +1,83 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 99 01 00 00  95 03 03 34 7d 89 eb 2a  |...........4}..*|
-00000010  19 64 32 17 5d 37 0e dd  51 2c 7e 08 56 47 f3 2c  |.d2.]7..Q,~.VG.,|
-00000020  ca d0 08 51 86 a6 a3 10  85 5a 41 00 00 04 00 2f  |...Q.....ZA..../|
-00000030  00 ff 01 00 00 68 00 00  00 10 00 0e 00 00 0b 73  |.....h.........s|
-00000040  6e 69 74 65 73 74 2e 63  6f 6d 00 0b 00 04 03 00  |nitest.com......|
-00000050  01 02 00 0a 00 0c 00 0a  00 1d 00 17 00 1e 00 19  |................|
-00000060  00 18 00 16 00 00 00 17  00 00 00 0d 00 30 00 2e  |.............0..|
-00000070  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
-00000080  08 04 08 05 08 06 04 01  05 01 06 01 03 03 02 03  |................|
-00000090  03 01 02 01 03 02 02 02  04 02 05 02 06 02        |..............|
+00000000  16 03 01 00 81 01 00 00  7d 03 03 77 e7 c3 97 fa  |........}..w....|
+00000010  59 80 de d1 f5 9f ce e5  a5 38 60 2c 30 b2 64 5b  |Y........8`,0.d[|
+00000020  6c 0a 56 49 1d 6f 19 57  5a ac 05 00 00 04 00 2f  |l.VI.o.WZ....../|
+00000030  00 ff 01 00 00 50 00 00  00 10 00 0e 00 00 0b 73  |.....P.........s|
+00000040  6e 69 74 65 73 74 2e 63  6f 6d 00 16 00 00 00 17  |nitest.com......|
+00000050  00 00 00 0d 00 30 00 2e  04 03 05 03 06 03 08 07  |.....0..........|
+00000060  08 08 08 09 08 0a 08 0b  08 04 08 05 08 06 04 01  |................|
+00000070  05 01 06 01 03 03 02 03  03 01 02 01 03 02 02 02  |................|
+00000080  04 02 05 02 06 02                                 |......|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 37 02 00 00  33 03 03 00 00 00 00 00  |....7...3.......|
+00000000  16 03 03 00 35 02 00 00  31 03 03 00 00 00 00 00  |....5...1.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
 00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 00 2f 00 00  |...DOWNGRD.../..|
-00000030  0b ff 01 00 01 00 00 0b  00 02 01 00 16 03 03 02  |................|
-00000040  59 0b 00 02 55 00 02 52  00 02 4f 30 82 02 4b 30  |Y...U..R..O0..K0|
-00000050  82 01 b4 a0 03 02 01 02  02 09 00 e8 f0 9d 3f e2  |..............?.|
-00000060  5b ea a6 30 0d 06 09 2a  86 48 86 f7 0d 01 01 0b  |[..0...*.H......|
-00000070  05 00 30 1f 31 0b 30 09  06 03 55 04 0a 13 02 47  |..0.1.0...U....G|
-00000080  6f 31 10 30 0e 06 03 55  04 03 13 07 47 6f 20 52  |o1.0...U....Go R|
-00000090  6f 6f 74 30 1e 17 0d 31  36 30 31 30 31 30 30 30  |oot0...160101000|
-000000a0  30 30 30 5a 17 0d 32 35  30 31 30 31 30 30 30 30  |000Z..2501010000|
-000000b0  30 30 5a 30 1a 31 0b 30  09 06 03 55 04 0a 13 02  |00Z0.1.0...U....|
-000000c0  47 6f 31 0b 30 09 06 03  55 04 03 13 02 47 6f 30  |Go1.0...U....Go0|
-000000d0  81 9f 30 0d 06 09 2a 86  48 86 f7 0d 01 01 01 05  |..0...*.H.......|
-000000e0  00 03 81 8d 00 30 81 89  02 81 81 00 db 46 7d 93  |.....0.......F}.|
-000000f0  2e 12 27 06 48 bc 06 28  21 ab 7e c4 b6 a2 5d fe  |..'.H..(!.~...].|
-00000100  1e 52 45 88 7a 36 47 a5  08 0d 92 42 5b c2 81 c0  |.RE.z6G....B[...|
-00000110  be 97 79 98 40 fb 4f 6d  14 fd 2b 13 8b c2 a5 2e  |..y.@.Om..+.....|
-00000120  67 d8 d4 09 9e d6 22 38  b7 4a 0b 74 73 2b c2 34  |g....."8.J.ts+.4|
-00000130  f1 d1 93 e5 96 d9 74 7b  f3 58 9f 6c 61 3c c0 b0  |......t{.X.la<..|
-00000140  41 d4 d9 2b 2b 24 23 77  5b 1c 3b bd 75 5d ce 20  |A..++$#w[.;.u]. |
-00000150  54 cf a1 63 87 1d 1e 24  c4 f3 1d 1a 50 8b aa b6  |T..c...$....P...|
-00000160  14 43 ed 97 a7 75 62 f4  14 c8 52 d7 02 03 01 00  |.C...ub...R.....|
-00000170  01 a3 81 93 30 81 90 30  0e 06 03 55 1d 0f 01 01  |....0..0...U....|
-00000180  ff 04 04 03 02 05 a0 30  1d 06 03 55 1d 25 04 16  |.......0...U.%..|
-00000190  30 14 06 08 2b 06 01 05  05 07 03 01 06 08 2b 06  |0...+.........+.|
-000001a0  01 05 05 07 03 02 30 0c  06 03 55 1d 13 01 01 ff  |......0...U.....|
-000001b0  04 02 30 00 30 19 06 03  55 1d 0e 04 12 04 10 9f  |..0.0...U.......|
-000001c0  91 16 1f 43 43 3e 49 a6  de 6d b6 80 d7 9f 60 30  |...CC>I..m....`0|
-000001d0  1b 06 03 55 1d 23 04 14  30 12 80 10 48 13 49 4d  |...U.#..0...H.IM|
-000001e0  13 7e 16 31 bb a3 01 d5  ac ab 6e 7b 30 19 06 03  |.~.1......n{0...|
-000001f0  55 1d 11 04 12 30 10 82  0e 65 78 61 6d 70 6c 65  |U....0...example|
-00000200  2e 67 6f 6c 61 6e 67 30  0d 06 09 2a 86 48 86 f7  |.golang0...*.H..|
-00000210  0d 01 01 0b 05 00 03 81  81 00 9d 30 cc 40 2b 5b  |...........0.@+[|
-00000220  50 a0 61 cb ba e5 53 58  e1 ed 83 28 a9 58 1a a9  |P.a...SX...(.X..|
-00000230  38 a4 95 a1 ac 31 5a 1a  84 66 3d 43 d3 2d d9 0b  |8....1Z..f=C.-..|
-00000240  f2 97 df d3 20 64 38 92  24 3a 00 bc cf 9c 7d b7  |.... d8.$:....}.|
-00000250  40 20 01 5f aa d3 16 61  09 a2 76 fd 13 c3 cc e1  |@ ._...a..v.....|
-00000260  0c 5c ee b1 87 82 f1 6c  04 ed 73 bb b3 43 77 8d  |.\.....l..s..Cw.|
-00000270  0c 1c f1 0f a1 d8 40 83  61 c9 4c 72 2b 9d ae db  |......@.a.Lr+...|
-00000280  46 06 06 4d f4 c1 b3 3e  c0 d1 bd 42 d4 db fe 3d  |F..M...>...B...=|
-00000290  13 60 84 5c 21 d3 3b e9  fa e7 16 03 03 00 04 0e  |.`.\!.;.........|
-000002a0  00 00 00                                          |...|
+00000030  09 ff 01 00 01 00 00 17  00 00 16 03 03 02 59 0b  |..............Y.|
+00000040  00 02 55 00 02 52 00 02  4f 30 82 02 4b 30 82 01  |..U..R..O0..K0..|
+00000050  b4 a0 03 02 01 02 02 09  00 e8 f0 9d 3f e2 5b ea  |............?.[.|
+00000060  a6 30 0d 06 09 2a 86 48  86 f7 0d 01 01 0b 05 00  |.0...*.H........|
+00000070  30 1f 31 0b 30 09 06 03  55 04 0a 13 02 47 6f 31  |0.1.0...U....Go1|
+00000080  10 30 0e 06 03 55 04 03  13 07 47 6f 20 52 6f 6f  |.0...U....Go Roo|
+00000090  74 30 1e 17 0d 31 36 30  31 30 31 30 30 30 30 30  |t0...16010100000|
+000000a0  30 5a 17 0d 32 35 30 31  30 31 30 30 30 30 30 30  |0Z..250101000000|
+000000b0  5a 30 1a 31 0b 30 09 06  03 55 04 0a 13 02 47 6f  |Z0.1.0...U....Go|
+000000c0  31 0b 30 09 06 03 55 04  03 13 02 47 6f 30 81 9f  |1.0...U....Go0..|
+000000d0  30 0d 06 09 2a 86 48 86  f7 0d 01 01 01 05 00 03  |0...*.H.........|
+000000e0  81 8d 00 30 81 89 02 81  81 00 db 46 7d 93 2e 12  |...0.......F}...|
+000000f0  27 06 48 bc 06 28 21 ab  7e c4 b6 a2 5d fe 1e 52  |'.H..(!.~...]..R|
+00000100  45 88 7a 36 47 a5 08 0d  92 42 5b c2 81 c0 be 97  |E.z6G....B[.....|
+00000110  79 98 40 fb 4f 6d 14 fd  2b 13 8b c2 a5 2e 67 d8  |y.@.Om..+.....g.|
+00000120  d4 09 9e d6 22 38 b7 4a  0b 74 73 2b c2 34 f1 d1  |...."8.J.ts+.4..|
+00000130  93 e5 96 d9 74 7b f3 58  9f 6c 61 3c c0 b0 41 d4  |....t{.X.la<..A.|
+00000140  d9 2b 2b 24 23 77 5b 1c  3b bd 75 5d ce 20 54 cf  |.++$#w[.;.u]. T.|
+00000150  a1 63 87 1d 1e 24 c4 f3  1d 1a 50 8b aa b6 14 43  |.c...$....P....C|
+00000160  ed 97 a7 75 62 f4 14 c8  52 d7 02 03 01 00 01 a3  |...ub...R.......|
+00000170  81 93 30 81 90 30 0e 06  03 55 1d 0f 01 01 ff 04  |..0..0...U......|
+00000180  04 03 02 05 a0 30 1d 06  03 55 1d 25 04 16 30 14  |.....0...U.%..0.|
+00000190  06 08 2b 06 01 05 05 07  03 01 06 08 2b 06 01 05  |..+.........+...|
+000001a0  05 07 03 02 30 0c 06 03  55 1d 13 01 01 ff 04 02  |....0...U.......|
+000001b0  30 00 30 19 06 03 55 1d  0e 04 12 04 10 9f 91 16  |0.0...U.........|
+000001c0  1f 43 43 3e 49 a6 de 6d  b6 80 d7 9f 60 30 1b 06  |.CC>I..m....`0..|
+000001d0  03 55 1d 23 04 14 30 12  80 10 48 13 49 4d 13 7e  |.U.#..0...H.IM.~|
+000001e0  16 31 bb a3 01 d5 ac ab  6e 7b 30 19 06 03 55 1d  |.1......n{0...U.|
+000001f0  11 04 12 30 10 82 0e 65  78 61 6d 70 6c 65 2e 67  |...0...example.g|
+00000200  6f 6c 61 6e 67 30 0d 06  09 2a 86 48 86 f7 0d 01  |olang0...*.H....|
+00000210  01 0b 05 00 03 81 81 00  9d 30 cc 40 2b 5b 50 a0  |.........0.@+[P.|
+00000220  61 cb ba e5 53 58 e1 ed  83 28 a9 58 1a a9 38 a4  |a...SX...(.X..8.|
+00000230  95 a1 ac 31 5a 1a 84 66  3d 43 d3 2d d9 0b f2 97  |...1Z..f=C.-....|
+00000240  df d3 20 64 38 92 24 3a  00 bc cf 9c 7d b7 40 20  |.. d8.$:....}.@ |
+00000250  01 5f aa d3 16 61 09 a2  76 fd 13 c3 cc e1 0c 5c  |._...a..v......\|
+00000260  ee b1 87 82 f1 6c 04 ed  73 bb b3 43 77 8d 0c 1c  |.....l..s..Cw...|
+00000270  f1 0f a1 d8 40 83 61 c9  4c 72 2b 9d ae db 46 06  |....@.a.Lr+...F.|
+00000280  06 4d f4 c1 b3 3e c0 d1  bd 42 d4 db fe 3d 13 60  |.M...>...B...=.`|
+00000290  84 5c 21 d3 3b e9 fa e7  16 03 03 00 04 0e 00 00  |.\!.;...........|
+000002a0  00                                                |.|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 38 86 92 3e 9a  |...........8..>.|
-00000010  54 2d 44 46 76 d1 7c 07  04 83 2f 19 6d 89 c6 95  |T-DFv.|.../.m...|
-00000020  07 63 17 7d ac e5 f7 95  7f f7 f2 3a f6 eb 38 26  |.c.}.......:..8&|
-00000030  e5 c9 32 b1 27 88 46 85  f8 f6 eb 27 a8 9e de 5b  |..2.'.F....'...[|
-00000040  92 f7 3f 03 be 73 f0 de  2e b4 44 a8 89 4a 5a 6f  |..?..s....D..JZo|
-00000050  dc e7 16 9c dc f7 9f ca  40 9e 34 4b c2 45 58 7a  |........@.4K.EXz|
-00000060  6d 5c 4c 58 6a 45 10 21  fb b5 2a 58 17 7d d9 c4  |m\LXjE.!..*X.}..|
-00000070  c9 7d d1 3b df 39 1b 59  6a 49 18 e1 fd 02 a2 1d  |.}.;.9.YjI......|
-00000080  5a 2d 3d c5 ab e7 f6 60  0d aa 38 14 03 03 00 01  |Z-=....`..8.....|
-00000090  01 16 03 03 00 40 0e 2a  fd e7 cd d0 72 ce 06 5c  |.....@.*....r..\|
-000000a0  40 c1 81 ef eb 27 e9 77  a8 d4 cc 5c 1e 15 7c 62  |@....'.w...\..|b|
-000000b0  87 bd c5 8e b4 e6 6a 3f  be 37 9d c0 fe f7 65 8b  |......j?.7....e.|
-000000c0  b1 3a b8 b4 76 67 ca 58  1c f5 3f f1 10 7c 5b 57  |.:..vg.X..?..|[W|
-000000d0  90 e6 43 de d6 25                                 |..C..%|
+00000000  16 03 03 00 86 10 00 00  82 00 80 67 0c a0 f8 da  |...........g....|
+00000010  2e d9 9e 9d ef c8 9b 77  f5 fe 25 32 74 49 1d a7  |.......w..%2tI..|
+00000020  7d 69 37 2a 94 07 5a 15  e8 f1 1d 36 25 ae 32 e4  |}i7*..Z....6%.2.|
+00000030  9c f5 35 fb 54 81 f2 19  4f 8d 6b 64 1a b2 a2 2e  |..5.T...O.kd....|
+00000040  c4 cb 5b 73 9d 46 97 01  33 d3 b8 a9 18 39 2c ad  |..[s.F..3....9,.|
+00000050  f2 eb 6b 02 38 44 f8 cf  ae ac a6 e6 54 92 29 ae  |..k.8D......T.).|
+00000060  a6 8a 4e 82 99 f3 77 8c  b6 3a a1 5c 4f 25 3b 7f  |..N...w..:.\O%;.|
+00000070  39 2f cd 51 dc e3 fc 7c  5a 5a 33 e4 af 43 d0 d3  |9/.Q...|ZZ3..C..|
+00000080  eb 3b 86 71 af 92 53 6e  02 b9 59 14 03 03 00 01  |.;.q..Sn..Y.....|
+00000090  01 16 03 03 00 40 8b e4  6f d3 88 e7 6a e9 aa f2  |.....@..o...j...|
+000000a0  4f 67 69 80 bc f1 78 ca  a9 f9 29 ce 44 93 81 46  |Ogi...x...).D..F|
+000000b0  0e 18 d1 2a 14 8b 3b b5  15 e4 b5 2a bb 88 d4 80  |...*..;....*....|
+000000c0  7b 2f 03 c7 83 7c 61 24  29 fe dd bc 49 8a b1 88  |{/...|a$)...I...|
+000000d0  41 ac 8a 12 f8 d6                                 |A.....|
 >>> Flow 4 (server to client)
 00000000  14 03 03 00 01 01 16 03  03 00 40 00 00 00 00 00  |..........@.....|
-00000010  00 00 00 00 00 00 00 00  00 00 00 8b 11 9a 67 af  |..............g.|
-00000020  5b 0e c9 01 dc 76 e8 48  2f 40 5c 76 13 ca 28 63  |[....v.H/@\v..(c|
-00000030  a9 6d 3c 6b c1 d4 79 4d  39 17 55 a5 b9 0e b6 fd  |.m<k..yM9.U.....|
-00000040  9b 1a 8c 62 98 34 3c 85  b9 2b 40 17 03 03 00 40  |...b.4<..+@....@|
+00000010  00 00 00 00 00 00 00 00  00 00 00 e7 d3 34 46 88  |.............4F.|
+00000020  0e 7f ae 5b d6 e5 70 d2  7d 99 25 1b 27 89 8a a4  |...[..p.}.%.'...|
+00000030  02 03 01 a4 e1 d6 72 af  c3 5a 55 f7 56 69 60 91  |......r..ZU.Vi`.|
+00000040  49 29 68 36 99 e5 09 ac  7a e3 4f 17 03 03 00 40  |I)h6....z.O....@|
 00000050  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000060  5e 82 20 cb bc 9a fd 36  13 3d aa 1b d6 72 df cb  |^. ....6.=...r..|
-00000070  09 e1 2f 85 6c 99 12 36  73 f3 c7 44 47 d7 60 19  |../.l..6s..DG.`.|
-00000080  2e 59 23 7d fa 16 b9 64  40 ed 96 79 66 b7 97 4c  |.Y#}...d@..yf..L|
+00000060  71 d0 36 7d 2c 3b 40 e3  a9 3f c1 d0 5e 3a ee d2  |q.6},;@..?..^:..|
+00000070  4d 0d b7 f4 83 3e 75 e0  ed 8a fc b2 9b ed 98 a8  |M....>u.........|
+00000080  ec 49 65 83 53 e0 79 52  03 2b 78 8a 64 3e 4c 5e  |.Ie.S.yR.+x.d>L^|
 00000090  15 03 03 00 30 00 00 00  00 00 00 00 00 00 00 00  |....0...........|
-000000a0  00 00 00 00 00 88 a2 85  5b 80 7d ee 4a 63 be da  |........[.}.Jc..|
-000000b0  e4 8f cd 6f 1d f4 03 da  ee 7c 29 2b d0 2d 3e 1c  |...o.....|)+.->.|
-000000c0  b2 ea 47 71 1f                                    |..Gq.|
+000000a0  00 00 00 00 00 76 38 c3  3d 86 d8 58 f2 16 48 94  |.....v8.=..X..H.|
+000000b0  46 65 ea 80 46 74 fe 66  7c 72 99 30 b3 05 08 14  |Fe..Ft.f|r.0....|
+000000c0  19 e3 ee 6f cf                                    |...o.|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-X25519 b/src/crypto/tls/testdata/Server-TLSv12-X25519
index c196336ddd..09f321e3e6 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-X25519
+++ b/src/crypto/tls/testdata/Server-TLSv12-X25519
@@ -1,82 +1,80 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 8f 01 00 00  8b 03 03 5d ff d6 27 db  |...........]..'.|
-00000010  3b e5 2b 79 3a a6 cf 75  3d f7 c9 d9 0a d4 8c b2  |;.+y:..u=.......|
-00000020  af 3c 29 84 65 a2 d6 98  52 e2 eb 00 00 04 c0 2f  |.<).e...R....../|
-00000030  00 ff 01 00 00 5e 00 00  00 0e 00 0c 00 00 09 31  |.....^.........1|
-00000040  32 37 2e 30 2e 30 2e 31  00 0b 00 04 03 00 01 02  |27.0.0.1........|
-00000050  00 0a 00 04 00 02 00 1d  00 16 00 00 00 17 00 00  |................|
-00000060  00 0d 00 30 00 2e 04 03  05 03 06 03 08 07 08 08  |...0............|
-00000070  08 09 08 0a 08 0b 08 04  08 05 08 06 04 01 05 01  |................|
-00000080  06 01 03 03 02 03 03 01  02 01 03 02 02 02 04 02  |................|
-00000090  05 02 06 02                                       |....|
+00000000  16 03 01 00 7d 01 00 00  79 03 03 dc 04 e9 5b d1  |....}...y.....[.|
+00000010  6b d9 b9 5e f7 4c 01 7e  58 4a 99 d9 90 c8 a2 7b  |k..^.L.~XJ.....{|
+00000020  f4 55 08 68 9b 42 34 6a  14 6c 01 00 00 04 cc a8  |.U.h.B4j.l......|
+00000030  00 ff 01 00 00 4c 00 0b  00 04 03 00 01 02 00 0a  |.....L..........|
+00000040  00 04 00 02 00 1d 00 16  00 00 00 17 00 00 00 0d  |................|
+00000050  00 30 00 2e 04 03 05 03  06 03 08 07 08 08 08 09  |.0..............|
+00000060  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
+00000070  03 03 02 03 03 01 02 01  03 02 02 02 04 02 05 02  |................|
+00000080  06 02                                             |..|
 >>> Flow 2 (server to client)
-00000000  16 03 03 00 37 02 00 00  33 03 03 00 00 00 00 00  |....7...3.......|
+00000000  16 03 03 00 3b 02 00 00  37 03 03 00 00 00 00 00  |....;...7.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 c0 2f 00 00  |...DOWNGRD.../..|
-00000030  0b ff 01 00 01 00 00 0b  00 02 01 00 16 03 03 02  |................|
-00000040  59 0b 00 02 55 00 02 52  00 02 4f 30 82 02 4b 30  |Y...U..R..O0..K0|
-00000050  82 01 b4 a0 03 02 01 02  02 09 00 e8 f0 9d 3f e2  |..............?.|
-00000060  5b ea a6 30 0d 06 09 2a  86 48 86 f7 0d 01 01 0b  |[..0...*.H......|
-00000070  05 00 30 1f 31 0b 30 09  06 03 55 04 0a 13 02 47  |..0.1.0...U....G|
-00000080  6f 31 10 30 0e 06 03 55  04 03 13 07 47 6f 20 52  |o1.0...U....Go R|
-00000090  6f 6f 74 30 1e 17 0d 31  36 30 31 30 31 30 30 30  |oot0...160101000|
-000000a0  30 30 30 5a 17 0d 32 35  30 31 30 31 30 30 30 30  |000Z..2501010000|
-000000b0  30 30 5a 30 1a 31 0b 30  09 06 03 55 04 0a 13 02  |00Z0.1.0...U....|
-000000c0  47 6f 31 0b 30 09 06 03  55 04 03 13 02 47 6f 30  |Go1.0...U....Go0|
-000000d0  81 9f 30 0d 06 09 2a 86  48 86 f7 0d 01 01 01 05  |..0...*.H.......|
-000000e0  00 03 81 8d 00 30 81 89  02 81 81 00 db 46 7d 93  |.....0.......F}.|
-000000f0  2e 12 27 06 48 bc 06 28  21 ab 7e c4 b6 a2 5d fe  |..'.H..(!.~...].|
-00000100  1e 52 45 88 7a 36 47 a5  08 0d 92 42 5b c2 81 c0  |.RE.z6G....B[...|
-00000110  be 97 79 98 40 fb 4f 6d  14 fd 2b 13 8b c2 a5 2e  |..y.@.Om..+.....|
-00000120  67 d8 d4 09 9e d6 22 38  b7 4a 0b 74 73 2b c2 34  |g....."8.J.ts+.4|
-00000130  f1 d1 93 e5 96 d9 74 7b  f3 58 9f 6c 61 3c c0 b0  |......t{.X.la<..|
-00000140  41 d4 d9 2b 2b 24 23 77  5b 1c 3b bd 75 5d ce 20  |A..++$#w[.;.u]. |
-00000150  54 cf a1 63 87 1d 1e 24  c4 f3 1d 1a 50 8b aa b6  |T..c...$....P...|
-00000160  14 43 ed 97 a7 75 62 f4  14 c8 52 d7 02 03 01 00  |.C...ub...R.....|
-00000170  01 a3 81 93 30 81 90 30  0e 06 03 55 1d 0f 01 01  |....0..0...U....|
-00000180  ff 04 04 03 02 05 a0 30  1d 06 03 55 1d 25 04 16  |.......0...U.%..|
-00000190  30 14 06 08 2b 06 01 05  05 07 03 01 06 08 2b 06  |0...+.........+.|
-000001a0  01 05 05 07 03 02 30 0c  06 03 55 1d 13 01 01 ff  |......0...U.....|
-000001b0  04 02 30 00 30 19 06 03  55 1d 0e 04 12 04 10 9f  |..0.0...U.......|
-000001c0  91 16 1f 43 43 3e 49 a6  de 6d b6 80 d7 9f 60 30  |...CC>I..m....`0|
-000001d0  1b 06 03 55 1d 23 04 14  30 12 80 10 48 13 49 4d  |...U.#..0...H.IM|
-000001e0  13 7e 16 31 bb a3 01 d5  ac ab 6e 7b 30 19 06 03  |.~.1......n{0...|
-000001f0  55 1d 11 04 12 30 10 82  0e 65 78 61 6d 70 6c 65  |U....0...example|
-00000200  2e 67 6f 6c 61 6e 67 30  0d 06 09 2a 86 48 86 f7  |.golang0...*.H..|
-00000210  0d 01 01 0b 05 00 03 81  81 00 9d 30 cc 40 2b 5b  |...........0.@+[|
-00000220  50 a0 61 cb ba e5 53 58  e1 ed 83 28 a9 58 1a a9  |P.a...SX...(.X..|
-00000230  38 a4 95 a1 ac 31 5a 1a  84 66 3d 43 d3 2d d9 0b  |8....1Z..f=C.-..|
-00000240  f2 97 df d3 20 64 38 92  24 3a 00 bc cf 9c 7d b7  |.... d8.$:....}.|
-00000250  40 20 01 5f aa d3 16 61  09 a2 76 fd 13 c3 cc e1  |@ ._...a..v.....|
-00000260  0c 5c ee b1 87 82 f1 6c  04 ed 73 bb b3 43 77 8d  |.\.....l..s..Cw.|
-00000270  0c 1c f1 0f a1 d8 40 83  61 c9 4c 72 2b 9d ae db  |......@.a.Lr+...|
-00000280  46 06 06 4d f4 c1 b3 3e  c0 d1 bd 42 d4 db fe 3d  |F..M...>...B...=|
-00000290  13 60 84 5c 21 d3 3b e9  fa e7 16 03 03 00 ac 0c  |.`.\!.;.........|
-000002a0  00 00 a8 03 00 1d 20 2f  e5 7d a3 47 cd 62 43 15  |...... /.}.G.bC.|
-000002b0  28 da ac 5f bb 29 07 30  ff f6 84 af c4 cf c2 ed  |(.._.).0........|
-000002c0  90 99 5f 58 cb 3b 74 08  04 00 80 73 d6 a4 35 5f  |.._X.;t....s..5_|
-000002d0  3f 46 ad de 81 13 a8 d9  21 17 25 37 61 cb 62 0d  |?F......!.%7a.b.|
-000002e0  e2 bf 95 51 0e 9e e7 b1  ab bc be f6 ec 80 b1 f4  |...Q............|
-000002f0  3e 9c 69 3f c8 1e a4 02  82 fd 57 01 e7 0c 18 be  |>.i?......W.....|
-00000300  c6 1b 01 68 cb ef dc d8  16 92 fb 1b 07 fd 98 f8  |...h............|
-00000310  00 77 a9 8e 71 2a e0 6c  68 d5 83 f9 36 c3 3b 99  |.w..q*.lh...6.;.|
-00000320  44 98 a0 96 00 1a 02 95  c5 7c ea ae 51 81 89 94  |D........|..Q...|
-00000330  57 b6 37 c5 88 56 9f 49  bf 36 26 48 08 36 a1 69  |W.7..V.I.6&H.6.i|
-00000340  48 a2 c4 b2 6f 0f 43 70  91 1e 8a 16 03 03 00 04  |H...o.Cp........|
-00000350  0e 00 00 00                                       |....|
+00000020  00 00 00 44 4f 57 4e 47  52 44 01 00 cc a8 00 00  |...DOWNGRD......|
+00000030  0f ff 01 00 01 00 00 17  00 00 00 0b 00 02 01 00  |................|
+00000040  16 03 03 02 59 0b 00 02  55 00 02 52 00 02 4f 30  |....Y...U..R..O0|
+00000050  82 02 4b 30 82 01 b4 a0  03 02 01 02 02 09 00 e8  |..K0............|
+00000060  f0 9d 3f e2 5b ea a6 30  0d 06 09 2a 86 48 86 f7  |..?.[..0...*.H..|
+00000070  0d 01 01 0b 05 00 30 1f  31 0b 30 09 06 03 55 04  |......0.1.0...U.|
+00000080  0a 13 02 47 6f 31 10 30  0e 06 03 55 04 03 13 07  |...Go1.0...U....|
+00000090  47 6f 20 52 6f 6f 74 30  1e 17 0d 31 36 30 31 30  |Go Root0...16010|
+000000a0  31 30 30 30 30 30 30 5a  17 0d 32 35 30 31 30 31  |1000000Z..250101|
+000000b0  30 30 30 30 30 30 5a 30  1a 31 0b 30 09 06 03 55  |000000Z0.1.0...U|
+000000c0  04 0a 13 02 47 6f 31 0b  30 09 06 03 55 04 03 13  |....Go1.0...U...|
+000000d0  02 47 6f 30 81 9f 30 0d  06 09 2a 86 48 86 f7 0d  |.Go0..0...*.H...|
+000000e0  01 01 01 05 00 03 81 8d  00 30 81 89 02 81 81 00  |.........0......|
+000000f0  db 46 7d 93 2e 12 27 06  48 bc 06 28 21 ab 7e c4  |.F}...'.H..(!.~.|
+00000100  b6 a2 5d fe 1e 52 45 88  7a 36 47 a5 08 0d 92 42  |..]..RE.z6G....B|
+00000110  5b c2 81 c0 be 97 79 98  40 fb 4f 6d 14 fd 2b 13  |[.....y.@.Om..+.|
+00000120  8b c2 a5 2e 67 d8 d4 09  9e d6 22 38 b7 4a 0b 74  |....g....."8.J.t|
+00000130  73 2b c2 34 f1 d1 93 e5  96 d9 74 7b f3 58 9f 6c  |s+.4......t{.X.l|
+00000140  61 3c c0 b0 41 d4 d9 2b  2b 24 23 77 5b 1c 3b bd  |a<..A..++$#w[.;.|
+00000150  75 5d ce 20 54 cf a1 63  87 1d 1e 24 c4 f3 1d 1a  |u]. T..c...$....|
+00000160  50 8b aa b6 14 43 ed 97  a7 75 62 f4 14 c8 52 d7  |P....C...ub...R.|
+00000170  02 03 01 00 01 a3 81 93  30 81 90 30 0e 06 03 55  |........0..0...U|
+00000180  1d 0f 01 01 ff 04 04 03  02 05 a0 30 1d 06 03 55  |...........0...U|
+00000190  1d 25 04 16 30 14 06 08  2b 06 01 05 05 07 03 01  |.%..0...+.......|
+000001a0  06 08 2b 06 01 05 05 07  03 02 30 0c 06 03 55 1d  |..+.......0...U.|
+000001b0  13 01 01 ff 04 02 30 00  30 19 06 03 55 1d 0e 04  |......0.0...U...|
+000001c0  12 04 10 9f 91 16 1f 43  43 3e 49 a6 de 6d b6 80  |.......CC>I..m..|
+000001d0  d7 9f 60 30 1b 06 03 55  1d 23 04 14 30 12 80 10  |..`0...U.#..0...|
+000001e0  48 13 49 4d 13 7e 16 31  bb a3 01 d5 ac ab 6e 7b  |H.IM.~.1......n{|
+000001f0  30 19 06 03 55 1d 11 04  12 30 10 82 0e 65 78 61  |0...U....0...exa|
+00000200  6d 70 6c 65 2e 67 6f 6c  61 6e 67 30 0d 06 09 2a  |mple.golang0...*|
+00000210  86 48 86 f7 0d 01 01 0b  05 00 03 81 81 00 9d 30  |.H.............0|
+00000220  cc 40 2b 5b 50 a0 61 cb  ba e5 53 58 e1 ed 83 28  |.@+[P.a...SX...(|
+00000230  a9 58 1a a9 38 a4 95 a1  ac 31 5a 1a 84 66 3d 43  |.X..8....1Z..f=C|
+00000240  d3 2d d9 0b f2 97 df d3  20 64 38 92 24 3a 00 bc  |.-...... d8.$:..|
+00000250  cf 9c 7d b7 40 20 01 5f  aa d3 16 61 09 a2 76 fd  |..}.@ ._...a..v.|
+00000260  13 c3 cc e1 0c 5c ee b1  87 82 f1 6c 04 ed 73 bb  |.....\.....l..s.|
+00000270  b3 43 77 8d 0c 1c f1 0f  a1 d8 40 83 61 c9 4c 72  |.Cw.......@.a.Lr|
+00000280  2b 9d ae db 46 06 06 4d  f4 c1 b3 3e c0 d1 bd 42  |+...F..M...>...B|
+00000290  d4 db fe 3d 13 60 84 5c  21 d3 3b e9 fa e7 16 03  |...=.`.\!.;.....|
+000002a0  03 00 ac 0c 00 00 a8 03  00 1d 20 2f e5 7d a3 47  |.......... /.}.G|
+000002b0  cd 62 43 15 28 da ac 5f  bb 29 07 30 ff f6 84 af  |.bC.(.._.).0....|
+000002c0  c4 cf c2 ed 90 99 5f 58  cb 3b 74 08 04 00 80 27  |......_X.;t....'|
+000002d0  d6 32 9d 2d 17 61 04 13  02 29 ad c2 af f7 ac 7b  |.2.-.a...).....{|
+000002e0  65 1c 6b cd 1d 7d 05 d7  b9 55 82 1b 23 92 6b b5  |e.k..}...U..#.k.|
+000002f0  a2 d6 65 d7 42 6f a3 b6  2a f0 ac a4 6c dd f3 11  |..e.Bo..*...l...|
+00000300  a0 20 ee 45 42 33 fc 45  d1 9e d7 bb 75 0e d1 bd  |. .EB3.E....u...|
+00000310  cd 8f 64 35 85 79 88 9b  63 1e 8c 08 1b fd 19 5e  |..d5.y..c......^|
+00000320  a9 ac 06 79 1e 4a 95 fa  cd 60 86 e3 10 e4 d0 39  |...y.J...`.....9|
+00000330  0c a0 0b 6f 6f 55 a4 7d  65 d4 41 ee 60 62 42 a8  |...ooU.}e.A.`bB.|
+00000340  5e 22 55 48 3c 54 53 f0  28 e1 7f 67 4f f0 1f 16  |^"UH<TS.(..gO...|
+00000350  03 03 00 04 0e 00 00 00                           |........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 0a 1b 78 c4 bb eb  |....%...! ..x...|
-00000010  a4 01 33 3b 69 95 c2 06  5d c9 3e b3 13 51 4b 93  |..3;i...].>..QK.|
-00000020  5e 3c 3e a7 42 12 22 e8  7e 49 14 03 03 00 01 01  |^<>.B.".~I......|
-00000030  16 03 03 00 28 fc c7 a1  45 50 e0 fe 27 fd ac a4  |....(...EP..'...|
-00000040  d8 a2 c6 54 df e1 d3 6f  e7 d8 45 a6 57 16 2f 1f  |...T...o..E.W./.|
-00000050  cf 89 26 c6 0a c3 4f 63  df ac bc c9 79           |..&...Oc....y|
+00000000  16 03 03 00 25 10 00 00  21 20 35 e6 c9 e2 76 cf  |....%...! 5...v.|
+00000010  36 af dc 27 30 6b eb f4  ae 62 f1 f4 40 81 04 d2  |6..'0k...b..@...|
+00000020  f1 c7 d5 af 7d 64 ef 64  d0 58 14 03 03 00 01 01  |....}d.d.X......|
+00000030  16 03 03 00 20 5b 64 ec  49 29 26 ba 8c ed 85 fb  |.... [d.I)&.....|
+00000040  3e 09 c4 66 bb 60 4e d7  b1 69 73 5a 67 51 77 20  |>..f.`N..isZgQw |
+00000050  5b 14 1f c0 69                                    |[...i|
 >>> Flow 4 (server to client)
-00000000  14 03 03 00 01 01 16 03  03 00 28 00 00 00 00 00  |..........(.....|
-00000010  00 00 00 37 25 28 76 4e  31 dd 5e b0 5b 39 87 fc  |...7%(vN1.^.[9..|
-00000020  0f 10 3c bc 6d 12 9a dd  59 89 0b 09 bc f2 2c d8  |..<.m...Y.....,.|
-00000030  05 a7 77 17 03 03 00 25  00 00 00 00 00 00 00 01  |..w....%........|
-00000040  fe 79 9d dd d9 e3 bc 48  47 65 30 64 c7 74 82 0a  |.y.....HGe0d.t..|
-00000050  9f b7 45 a2 62 40 b5 dd  79 b9 ce 06 83 15 03 03  |..E.b@..y.......|
-00000060  00 1a 00 00 00 00 00 00  00 02 58 ed 37 40 33 e4  |..........X.7@3.|
-00000070  75 f0 a6 fa 14 f5 6b 93  9e 54 f2 a4              |u.....k..T..|
+00000000  14 03 03 00 01 01 16 03  03 00 20 74 49 81 b6 d3  |.......... tI...|
+00000010  79 68 0d 78 47 7a 97 a7  cd 3b 2c 24 a3 42 83 18  |yh.xGz...;,$.B..|
+00000020  e4 0c c3 da 4a 1c ff 7b  5d 4c 08 17 03 03 00 1d  |....J..{]L......|
+00000030  c2 8a f4 f2 de db 53 69  79 61 c9 30 7b ae 74 cc  |......Siya.0{.t.|
+00000040  eb 37 b7 e8 19 cb e6 5f  49 7f 3d a0 37 15 03 03  |.7....._I.=.7...|
+00000050  00 12 99 68 9b 76 f6 66  52 55 fc 8e 4f 17 56 a7  |...h.v.fRU..O.V.|
+00000060  33 0b db 05                                       |3...|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-AES128-SHA256 b/src/crypto/tls/testdata/Server-TLSv13-AES128-SHA256
index 3d5a826019..00b2b516c2 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-AES128-SHA256
+++ b/src/crypto/tls/testdata/Server-TLSv13-AES128-SHA256
@@ -1,97 +1,97 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 f9 c0 a4 c6 5f  |..............._|
-00000010  04 e0 32 2f 9e e4 a7 e6  9b e0 6f bd a3 60 4d 7a  |..2/......o..`Mz|
-00000020  a4 ad 5c a7 93 f3 aa e4  10 15 f6 20 b7 d5 8a f0  |..\........ ....|
-00000030  9f 0b b4 da a8 9f af 4b  b3 70 a1 60 cc 01 65 d9  |.......K.p.`..e.|
-00000040  fd d8 e6 3e ad 03 97 44  f9 86 5f aa 00 04 13 01  |...>...D.._.....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 62 22 f7 19 ae  |...........b"...|
+00000010  2d c1 c0 03 49 4c 9d 96  49 68 02 9b e9 fb cb d3  |-...IL..Ih......|
+00000020  b9 4d 05 85 8c 80 64 b7  b1 fc 74 20 1c aa 3a 04  |.M....d...t ..:.|
+00000030  39 37 f8 4e 8f 3d 08 38  50 5d 68 37 27 28 14 8f  |97.N.=.8P]h7'(..|
+00000040  19 59 71 e8 0b 22 11 48  20 f7 78 24 00 04 13 01  |.Yq..".H .x$....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 6d  |-.....3.&.$... m|
-000000b0  e0 28 0f bf 26 99 ae d5  25 52 86 99 0a 45 1e 71  |.(..&...%R...E.q|
-000000c0  60 ce 9c 41 9c fb ba 7e  f0 53 de 92 4c d8 67     |`..A...~.S..L.g|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 19  |-.....3.&.$... .|
+000000b0  e3 b2 9b c6 d0 0d 1e 8e  e5 e1 55 f0 e1 9d 17 a1  |..........U.....|
+000000c0  78 05 88 a9 09 65 0f b2  b4 37 30 f8 5b ab 16     |x....e...70.[..|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 b7 d5 8a f0  |........... ....|
-00000030  9f 0b b4 da a8 9f af 4b  b3 70 a1 60 cc 01 65 d9  |.......K.p.`..e.|
-00000040  fd d8 e6 3e ad 03 97 44  f9 86 5f aa 13 01 00 00  |...>...D.._.....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 1c aa 3a 04  |........... ..:.|
+00000030  39 37 f8 4e 8f 3d 08 38  50 5d 68 37 27 28 14 8f  |97.N.=.8P]h7'(..|
+00000040  19 59 71 e8 0b 22 11 48  20 f7 78 24 13 01 00 00  |.Yq..".H .x$....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 22 86 b1 3d ec 2d  |.........."..=.-|
-00000090  76 34 3f fc 20 aa 5c 5b  9e c8 a0 40 7a 4e ea 7c  |v4?. .\[...@zN.||
-000000a0  f6 17 03 03 02 6d 65 77  82 9e b8 b4 11 76 10 1d  |.....mew.....v..|
-000000b0  b9 4d a0 22 26 1f ee 0d  13 a7 8e c3 84 f0 e9 45  |.M."&..........E|
-000000c0  ff 68 61 61 48 a1 cf 17  26 17 ab 38 0a 3c 8a 9d  |.haaH...&..8.<..|
-000000d0  54 21 c3 b7 df 06 02 14  53 5f 24 50 00 ab 98 52  |T!......S_$P...R|
-000000e0  97 f5 7a 0e 3a 28 d3 b2  9c 6c a9 1c ca 19 7d 5c  |..z.:(...l....}\|
-000000f0  45 39 eb 65 fb 46 16 cf  84 f5 e6 6a bd 5d a0 f2  |E9.e.F.....j.]..|
-00000100  dd 2d 0e 43 4c c2 79 fd  76 68 5e 53 0e 5f 09 46  |.-.CL.y.vh^S._.F|
-00000110  46 7c b3 49 57 a9 29 19  a0 9a 28 63 90 0e 46 e4  |F|.IW.)...(c..F.|
-00000120  e6 99 7d cf 3a c7 e3 8a  f4 4f 38 06 8d 12 92 f3  |..}.:....O8.....|
-00000130  50 0b 48 dc 84 3c be bf  8a b7 ec 0a 2a 59 9f 5f  |P.H..<......*Y._|
-00000140  18 8a c9 29 f9 f2 24 61  32 ef db c0 07 cb 02 6b  |...)..$a2......k|
-00000150  66 d8 da 15 bd d9 d0 17  17 80 d3 39 c6 45 d6 de  |f..........9.E..|
-00000160  52 f0 7d 4f d8 7e bd b9  7c 04 c8 1f 11 a4 d2 11  |R.}O.~..|.......|
-00000170  a8 2d 33 4f 01 e7 07 b3  21 26 c2 56 45 a2 37 6a  |.-3O....!&.VE.7j|
-00000180  72 4d 25 a3 55 42 a6 f9  d6 71 08 5a 0b d9 be 69  |rM%.UB...q.Z...i|
-00000190  2a 96 87 32 ba 90 e5 12  fc bd d1 03 9f 83 96 fc  |*..2............|
-000001a0  b4 8a 7a 00 3f a9 f3 64  af 6a 43 e4 7a 33 8c ed  |..z.?..d.jC.z3..|
-000001b0  ed 2e c3 92 fe 60 ee 78  af 9e 5b 59 99 53 74 bb  |.....`.x..[Y.St.|
-000001c0  e0 ef 54 3e 78 0c 17 f9  c7 f5 07 8d d1 07 01 36  |..T>x..........6|
-000001d0  9d 17 dd 29 d6 01 50 f7  fa bc f3 2e 34 1f d8 33  |...)..P.....4..3|
-000001e0  bb 23 a3 e2 b6 d6 f4 9a  06 84 d4 5e 9b 81 66 be  |.#.........^..f.|
-000001f0  c5 c4 2e 4a 57 bc ab 3b  1b 49 bf b7 87 32 b1 94  |...JW..;.I...2..|
-00000200  e9 05 e6 0b cf 7b c4 15  b3 43 ec d8 3d 79 97 23  |.....{...C..=y.#|
-00000210  42 75 3f 7c 1a af cc c4  22 f4 60 ce 51 23 14 02  |Bu?|....".`.Q#..|
-00000220  9d aa c2 92 06 69 ed 03  17 59 cf cd 56 19 c9 aa  |.....i...Y..V...|
-00000230  a2 71 e4 1f 3e 9b ec 1d  52 09 ed d1 e6 79 cd e2  |.q..>...R....y..|
-00000240  b1 a7 bd 48 71 56 95 d0  96 a4 28 ab 07 c7 51 0c  |...HqV....(...Q.|
-00000250  f9 f8 69 03 d2 a4 c6 99  06 dc 12 07 cb a9 71 58  |..i...........qX|
-00000260  53 b9 98 07 30 96 10 c2  45 27 45 1d 1e 0b 90 30  |S...0...E'E....0|
-00000270  82 66 84 d0 c4 c4 2d db  63 60 e1 dc 4f 50 61 02  |.f....-.c`..OPa.|
-00000280  2f d5 e6 a1 c5 ae 32 36  7d 51 9c ff 8f 12 2e 1f  |/.....26}Q......|
-00000290  97 e0 f0 67 4c 64 39 87  15 e8 b3 83 96 14 3b d9  |...gLd9.......;.|
-000002a0  f7 2e 6f 2e c8 30 ab 4f  1d 44 4a 08 97 e8 d0 fb  |..o..0.O.DJ.....|
-000002b0  f5 3f df d7 8c f8 6a c2  77 d5 f4 e4 0d dc c8 3a  |.?....j.w......:|
-000002c0  66 68 53 3f 3b bf cc 4f  4f 2b f3 4e 25 d1 8e 60  |fhS?;..OO+.N%..`|
-000002d0  34 f9 a6 d5 1e a5 27 7e  07 15 25 09 34 8b 2b 36  |4.....'~..%.4.+6|
-000002e0  a0 bd 54 8f d1 e9 b7 1f  38 d8 4b c7 ac 52 78 71  |..T.....8.K..Rxq|
-000002f0  17 32 53 4d c5 96 3c 62  6b 78 4f 01 2e 89 90 bf  |.2SM..<bkxO.....|
-00000300  4c c4 12 77 37 95 5a 51  3e e5 31 d4 ad 71 dc e1  |L..w7.ZQ>.1..q..|
-00000310  14 48 48 17 03 03 00 99  60 97 e4 cb 6b f0 10 74  |.HH.....`...k..t|
-00000320  44 00 88 5a af 34 40 b3  d2 1f 48 ea 16 a9 5b b7  |D..Z.4@...H...[.|
-00000330  ea 27 5d 34 7f c8 2f 5d  f9 46 7f f2 ce c9 fc ae  |.']4../].F......|
-00000340  59 c4 a4 75 b3 7b 5a 38  ab b1 4c 82 9e b6 b1 fd  |Y..u.{Z8..L.....|
-00000350  5a f2 69 c1 61 fb 6d 31  08 68 26 d8 70 90 10 12  |Z.i.a.m1.h&.p...|
-00000360  7d 47 99 e1 52 fd fe cb  d6 44 b0 c9 05 25 ab bd  |}G..R....D...%..|
-00000370  23 d2 45 2c b6 05 8d 6e  3a c1 6d df ea 4e bd 55  |#.E,...n:.m..N.U|
-00000380  d0 51 fa 57 95 02 f9 15  b7 d0 9e ec be cc 45 12  |.Q.W..........E.|
-00000390  69 39 3c 5c d9 d3 ed 08  56 17 0c 08 4f 3c 60 4c  |i9<\....V...O<`L|
-000003a0  f7 89 f0 fd f7 88 ed 02  2a 22 bc bf 08 1f 00 a7  |........*"......|
-000003b0  47 17 03 03 00 35 82 e5  0a 8e e0 f5 e2 95 0a 3f  |G....5.........?|
-000003c0  6a 9d 5d 02 e0 57 19 b8  9f c1 48 c3 3e 5e eb a1  |j.]..W....H.>^..|
-000003d0  06 da 46 17 7c c7 07 1b  76 88 bc bc 47 f3 c2 39  |..F.|...v...G..9|
-000003e0  70 ba 17 7b 3a 22 ed 48  b3 23 f1 17 03 03 00 87  |p..{:".H.#......|
-000003f0  99 cb 06 4a 24 80 04 ac  3c 1e 2b 72 c9 45 d3 1f  |...J$...<.+r.E..|
-00000400  a7 30 22 2c 27 6a 01 97  f0 2d ff 82 b9 fd b9 df  |.0",'j...-......|
-00000410  f1 f7 5c 26 7b 70 f7 7b  dd 55 84 8c 3b 28 b5 e4  |..\&{p.{.U..;(..|
-00000420  ea f8 f3 c6 50 6d cd e5  ec 05 98 51 b8 e0 4b 87  |....Pm.....Q..K.|
-00000430  f6 45 9e 6e 9c 98 b8 20  7c 4b 74 38 b3 f8 53 ba  |.E.n... |Kt8..S.|
-00000440  76 95 f6 4f cb c7 3e d3  26 79 16 99 97 1a 0c fb  |v..O..>.&y......|
-00000450  fa 9d 41 aa 0f f5 68 e5  52 0d f3 56 2f 2b e4 22  |..A...h.R..V/+."|
-00000460  f0 12 51 11 21 4d df 10  92 23 53 af 6a 17 e9 8e  |..Q.!M...#S.j...|
-00000470  f6 f1 10 fe 98 da d7                              |.......|
+00000080  03 03 00 01 01 17 03 03  00 17 38 1c f2 fd 62 f6  |..........8...b.|
+00000090  fa 96 d9 b8 fb 40 43 f3  ac 54 39 e7 f0 2b fd 4c  |.....@C..T9..+.L|
+000000a0  ac 17 03 03 02 6d 73 73  62 0b f2 d6 6a 37 9f 85  |.....mssb...j7..|
+000000b0  d6 d0 88 89 36 2f c0 82  0d 3f 02 2a 57 11 22 90  |....6/...?.*W.".|
+000000c0  07 d1 8c 22 c3 7a 52 50  f2 fd 73 9f 14 97 a5 b1  |...".zRP..s.....|
+000000d0  89 04 b7 87 92 03 fa b1  ac e8 38 c9 e8 48 b5 b2  |..........8..H..|
+000000e0  4b 2b 6e 4f 08 ac b9 0c  c4 2b 65 f8 e7 32 de c6  |K+nO.....+e..2..|
+000000f0  cd 58 13 2a 28 65 58 f1  0b f8 77 b7 56 a5 84 1f  |.X.*(eX...w.V...|
+00000100  0d 8b bd 54 0f 55 58 0b  7e ca 9c 1f c1 04 ca 01  |...T.UX.~.......|
+00000110  f4 d5 d7 ae 1b 5b d8 51  21 1c a0 d1 b3 37 23 49  |.....[.Q!....7#I|
+00000120  15 5d 70 5d 58 da 42 62  c2 a1 f6 af 58 07 a3 b8  |.]p]X.Bb....X...|
+00000130  e8 a0 51 64 16 f8 f0 d4  9f 4e 85 50 2f 69 6b 94  |..Qd.....N.P/ik.|
+00000140  cf 8f 6d 65 74 39 61 be  65 82 28 b4 3e 0a d3 25  |..met9a.e.(.>..%|
+00000150  41 ce e3 bc c6 98 f4 0f  81 74 00 1a ed a3 f9 51  |A........t.....Q|
+00000160  93 ee 85 b2 6d 99 25 a3  2a 88 cb 77 8a b7 80 9c  |....m.%.*..w....|
+00000170  4e 11 3c 5c b1 62 cc 06  0e 4d 36 b5 04 3f b2 a4  |N.<\.b...M6..?..|
+00000180  2c f1 59 f7 3f 86 76 78  75 50 f8 1c 86 b7 22 09  |,.Y.?.vxuP....".|
+00000190  72 65 24 5e 91 cd 59 7d  8e 96 0c 99 e6 ba 1c ec  |re$^..Y}........|
+000001a0  3f 1b 80 96 fe 29 34 0f  99 3c de 60 b1 2e ff 07  |?....)4..<.`....|
+000001b0  3b f6 8c 96 27 23 b4 ba  87 9d 56 8e 60 6e 87 45  |;...'#....V.`n.E|
+000001c0  10 33 38 34 c4 ac 72 03  73 80 8f 39 ce de 79 dd  |.384..r.s..9..y.|
+000001d0  ee 18 d8 57 29 90 a7 be  1b be 80 37 aa 36 e9 59  |...W)......7.6.Y|
+000001e0  8a 53 98 68 c3 bc 6d 4d  91 15 70 8d a1 6f 5c 28  |.S.h..mM..p..o\(|
+000001f0  08 e3 fb a7 95 19 ff 27  c7 a0 a4 30 ea 3c eb d9  |.......'...0.<..|
+00000200  b2 05 4e 10 bc 80 e6 0b  48 52 55 e2 9f c2 ff 99  |..N.....HRU.....|
+00000210  5d ab 65 ff 44 d2 4a fd  96 17 62 ae ac 4e 48 5f  |].e.D.J...b..NH_|
+00000220  10 e8 0d 17 d7 bc eb 81  06 da 7d c7 7d be 00 5f  |..........}.}.._|
+00000230  d4 db 13 b3 bb 72 e8 fa  50 88 a2 48 38 f4 c3 b7  |.....r..P..H8...|
+00000240  87 f2 5b 39 7f 48 63 61  95 25 df 9b cc ac 7e 29  |..[9.Hca.%....~)|
+00000250  eb 8e 10 5a db a7 cf 5e  f5 a4 09 75 7d cd fe d9  |...Z...^...u}...|
+00000260  5c 51 f0 c4 89 a7 50 45  53 77 f0 1d 59 4d df 04  |\Q....PESw..YM..|
+00000270  74 ac 1b 74 5e a6 59 64  be c5 8e 3a 4e cc a7 c4  |t..t^.Yd...:N...|
+00000280  e8 c9 6f da f0 22 7b d2  14 99 64 f6 7a 16 ba f3  |..o.."{...d.z...|
+00000290  16 42 ef 43 57 ea 2c 2a  c4 ce 51 06 8a fe ab a0  |.B.CW.,*..Q.....|
+000002a0  e1 73 96 81 f4 45 0d 26  fa 6a fc 8e ef d0 0e 75  |.s...E.&.j.....u|
+000002b0  d0 f1 a8 cc 2b 4a c1 4b  b5 c0 7d c9 c5 b5 dd 54  |....+J.K..}....T|
+000002c0  85 94 46 ad e8 58 1c aa  57 34 7d d7 59 5b 94 5e  |..F..X..W4}.Y[.^|
+000002d0  a5 ab 21 73 75 59 90 7a  39 ad 0b de 53 c2 25 07  |..!suY.z9...S.%.|
+000002e0  c2 29 6a 23 47 91 e2 15  c8 33 6e a1 ce 19 b4 de  |.)j#G....3n.....|
+000002f0  20 54 23 08 b8 4d e1 03  ef 2b 30 3f e4 3a 5b 7a  | T#..M...+0?.:[z|
+00000300  72 14 7e 5b 41 ab 4a 1c  5f eb 2b 00 1e 42 8a 75  |r.~[A.J._.+..B.u|
+00000310  29 8e 6f 17 03 03 00 99  88 e4 ff 29 21 d9 c0 3d  |).o........)!..=|
+00000320  11 45 e9 da fd 7f a3 75  7b db ee b7 29 47 ce 95  |.E.....u{...)G..|
+00000330  c6 24 45 2b 56 3f f9 84  c7 43 e7 4e cc af af 69  |.$E+V?...C.N...i|
+00000340  10 79 41 74 d0 cd 96 23  c4 8f 7b a0 eb ea 18 2c  |.yAt...#..{....,|
+00000350  da a5 52 08 5b 32 ef de  72 e0 b6 5c bb ce 47 8c  |..R.[2..r..\..G.|
+00000360  6b 0e 39 91 79 8b 6d b3  c3 80 05 9e 51 50 07 fb  |k.9.y.m.....QP..|
+00000370  cc da ba c2 cb d2 e6 47  e7 27 d8 65 63 b9 33 a3  |.......G.'.ec.3.|
+00000380  21 cf 85 a0 dd 29 a5 ad  90 3f 6f 47 97 67 dc c7  |!....)...?oG.g..|
+00000390  fb 9e 0b 23 a1 8a 8a 3b  cb a0 d7 32 5f e7 3a 0c  |...#...;...2_.:.|
+000003a0  6d c4 7a 8c 73 98 05 42  2a 47 7a f2 51 fa 1e 7f  |m.z.s..B*Gz.Q...|
+000003b0  e7 17 03 03 00 35 b8 48  0d fc 12 11 a1 de 9d 61  |.....5.H.......a|
+000003c0  c7 80 44 8b 1a 19 0f d8  04 b1 d4 a2 89 8a 6d ac  |..D...........m.|
+000003d0  9f 14 f2 1e 7a 0d cb f9  64 fd f9 47 5e 1c 08 e3  |....z...d..G^...|
+000003e0  a3 09 5b 81 a5 8f 0d b8  ee bd 07 17 03 03 00 88  |..[.............|
+000003f0  f1 ac 07 2e bd a0 05 0f  5f b1 fb 15 7d c4 87 a1  |........_...}...|
+00000400  d8 a1 1d 8b c4 b9 ca ed  37 ba 3d 82 7c 62 75 33  |........7.=.|bu3|
+00000410  d1 ae 62 9f 43 fc db 30  2e 39 83 f3 e6 89 6a 52  |..b.C..0.9....jR|
+00000420  bf 66 41 13 6e 45 04 4f  9b 1f a7 67 79 ba ba 32  |.fA.nE.O...gy..2|
+00000430  d8 91 a2 e0 a2 61 21 7e  0a 79 82 da 4a 97 3f 7c  |.....a!~.y..J.?||
+00000440  8a b5 0a 27 b6 69 18 bf  fc b0 ea 3d 1d 58 c3 e7  |...'.i.....=.X..|
+00000450  bb 60 d2 52 24 9c 4b bb  3e 8a 7a 08 d3 dc e8 0f  |.`.R$.K.>.z.....|
+00000460  b8 40 42 0a 68 d7 a1 db  d8 20 4f 10 9a 5c 94 9a  |.@B.h.... O..\..|
+00000470  de d9 e6 ef 1c c9 17 61                           |.......a|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 cc d8 67 80 d4  |..........5..g..|
-00000010  36 90 38 52 46 ab fb f9  69 e3 12 6a 62 a7 81 ba  |6.8RF...i..jb...|
-00000020  38 91 03 dd 09 3e bb 3f  90 b3 f6 f6 69 c0 cb 0d  |8....>.?....i...|
-00000030  57 56 f9 fe b6 43 72 9f  02 2f 12 98 d4 f3 42 81  |WV...Cr../....B.|
+00000000  14 03 03 00 01 01 17 03  03 00 35 f0 71 3b 42 f3  |..........5.q;B.|
+00000010  d1 22 ef 3a e4 5e a4 eb  ac 2b 81 16 9a 02 53 84  |.".:.^...+....S.|
+00000020  57 aa f4 d8 f9 1a 0b 28  fe 00 b4 bf fb 84 b0 c4  |W......(........|
+00000030  42 06 3a 8b 15 73 5a 5b  bf f1 33 e1 88 82 fd 33  |B.:..sZ[..3....3|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 33 a7 7b  5d 62 77 a4 51 5e 3e 8d  |.....3.{]bw.Q^>.|
-00000010  d9 1c 0b 3b 75 81 fc dc  85 aa e3 8e 39 8a 8b 4d  |...;u.......9..M|
-00000020  12 f0 66 17 03 03 00 13  c8 2d eb 40 33 59 7c eb  |..f......-.@3Y|.|
-00000030  a7 7f 23 87 86 e1 f6 c3  6b 4a e9                 |..#.....kJ.|
+00000000  17 03 03 00 1e c8 09 b0  08 ba 0c 28 a0 5a 07 d5  |...........(.Z..|
+00000010  88 ae 7d 29 c6 41 c4 5a  09 12 0f ae af 07 b5 9a  |..}).A.Z........|
+00000020  ca c2 0c 17 03 03 00 13  3a e7 17 14 0a 0f 73 2d  |........:.....s-|
+00000030  99 e9 65 4d af 11 29 ea  1f e1 c0                 |..eM..)....|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-AES256-SHA384 b/src/crypto/tls/testdata/Server-TLSv13-AES256-SHA384
index 325cb90cdc..6a871e439b 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-AES256-SHA384
+++ b/src/crypto/tls/testdata/Server-TLSv13-AES256-SHA384
@@ -1,100 +1,100 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 d2 82 a1 1c 7a  |...............z|
-00000010  d7 ad fb 77 f1 0a 21 b2  b7 31 9c 55 d5 ab 7f 7d  |...w..!..1.U...}|
-00000020  64 ba dd 1f 31 0d c8 a1  93 e3 7f 20 7a a3 e3 78  |d...1...... z..x|
-00000030  b3 07 16 dc fc 47 50 5b  18 82 31 50 04 9a f1 e3  |.....GP[..1P....|
-00000040  2e fc 78 43 5f 49 30 08  ca de 8d 28 00 04 13 02  |..xC_I0....(....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 97 c1 ee f7 f2  |................|
+00000010  ae 15 07 a8 a8 fc 07 99  9c f2 35 b9 00 0d c9 55  |..........5....U|
+00000020  a6 cd 11 19 c0 f9 f8 a5  55 12 c0 20 16 5a fe 4d  |........U.. .Z.M|
+00000030  4f 17 ec 8c 91 41 90 54  4b 2b b1 19 f0 b0 1f 67  |O....A.TK+.....g|
+00000040  ad 5b 6b 33 df 9f d7 2c  63 8b 80 91 00 04 13 02  |.[k3...,c.......|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 f3  |-.....3.&.$... .|
-000000b0  04 be fd 97 6c 73 6d 9c  a0 74 e4 97 ff 83 8a 55  |....lsm..t.....U|
-000000c0  22 41 ad a5 9c 07 3d 3a  11 f1 33 89 bc e9 3b     |"A....=:..3...;|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 b1  |-.....3.&.$... .|
+000000b0  9f bf 4b 28 d5 6d a5 48  f7 06 32 f3 51 ca e1 c5  |..K(.m.H..2.Q...|
+000000c0  02 23 aa fa 22 f2 01 af  bf ba d1 b8 ac 11 23     |.#..".........#|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 7a a3 e3 78  |........... z..x|
-00000030  b3 07 16 dc fc 47 50 5b  18 82 31 50 04 9a f1 e3  |.....GP[..1P....|
-00000040  2e fc 78 43 5f 49 30 08  ca de 8d 28 13 02 00 00  |..xC_I0....(....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 16 5a fe 4d  |........... .Z.M|
+00000030  4f 17 ec 8c 91 41 90 54  4b 2b b1 19 f0 b0 1f 67  |O....A.TK+.....g|
+00000040  ad 5b 6b 33 df 9f d7 2c  63 8b 80 91 13 02 00 00  |.[k3...,c.......|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 4d e5 22 bd f4 3c  |..........M."..<|
-00000090  12 74 90 1e 49 3b 2f d7  bc 97 22 ef e8 a2 4c cd  |.t..I;/..."...L.|
-000000a0  ae 17 03 03 02 6d 65 3e  11 94 12 ce ba bd 89 a4  |.....me>........|
-000000b0  02 4e f2 02 33 01 54 d0  61 f4 a5 ff fc f3 04 25  |.N..3.T.a......%|
-000000c0  dc 70 aa 6f 49 9b d9 8a  73 1d 6b 88 3d c6 48 06  |.p.oI...s.k.=.H.|
-000000d0  ef cb 13 c7 a5 c5 97 14  34 08 ac e3 4f 11 db 56  |........4...O..V|
-000000e0  69 56 41 cb c2 13 79 d8  52 16 9c f0 8d c3 40 2d  |iVA...y.R.....@-|
-000000f0  9e 33 2a a7 5b 88 85 2d  ff c8 56 f9 6a 81 d6 53  |.3*.[..-..V.j..S|
-00000100  97 14 c0 d6 b8 ef 85 42  ce 99 a1 8a 02 46 00 13  |.......B.....F..|
-00000110  9a 6b 7d 29 04 e1 40 90  76 37 00 35 16 b0 04 85  |.k})..@.v7.5....|
-00000120  3c cf 6f 1a 79 9a e0 30  d0 03 11 e1 4f bb f9 27  |<.o.y..0....O..'|
-00000130  de 15 b9 32 18 9d 22 c0  af ab 44 ac 35 5d da 90  |...2.."...D.5]..|
-00000140  04 81 c9 b6 55 17 40 02  6b 99 9f 6f c9 c5 6b 56  |....U.@.k..o..kV|
-00000150  07 e7 60 51 35 d5 5a 13  77 cd fb 78 7b 64 01 f3  |..`Q5.Z.w..x{d..|
-00000160  a7 5e b8 c8 3f 62 42 c4  45 d7 d0 2c 5a 9e e1 7f  |.^..?bB.E..,Z...|
-00000170  9a 45 35 f8 e3 eb 14 79  0e b0 ef 85 79 44 78 30  |.E5....y....yDx0|
-00000180  85 83 e5 87 d1 6e 71 cc  e7 39 8d 2d 42 38 24 b1  |.....nq..9.-B8$.|
-00000190  b9 66 74 3b 34 6b a7 8a  ce 4b 33 c9 e8 85 13 6d  |.ft;4k...K3....m|
-000001a0  5e 6e 89 b0 e4 88 ff d2  ca 4d 24 f0 1a c7 e1 91  |^n.......M$.....|
-000001b0  6f 50 69 2d 4d 94 65 d5  aa 9e e3 fe cc d7 38 ac  |oPi-M.e.......8.|
-000001c0  59 b2 3a 2a 3d 72 6e db  09 af c4 b0 d5 17 21 1e  |Y.:*=rn.......!.|
-000001d0  ef 62 30 8f 8f 57 2e 34  31 e8 ef 0d 43 75 10 63  |.b0..W.41...Cu.c|
-000001e0  02 b0 ae 92 d2 59 78 0c  8b 0c 7d 2b 8d 37 61 d7  |.....Yx...}+.7a.|
-000001f0  d0 81 37 c7 2a 0a 0e 5d  34 a2 c2 e9 e2 86 dc dd  |..7.*..]4.......|
-00000200  c9 d1 ab 76 0d d6 eb 53  ca 8f 0a 62 0b 06 19 39  |...v...S...b...9|
-00000210  51 be f6 ac 1d 53 9c 80  4c e7 44 fd 0f 31 9c f2  |Q....S..L.D..1..|
-00000220  fd 37 0b 61 96 ee a0 dc  cf 61 25 7e d2 cf 72 16  |.7.a.....a%~..r.|
-00000230  21 c2 7c a7 c7 45 3b 8a  a2 6e 98 85 6e b6 c8 e9  |!.|..E;..n..n...|
-00000240  a0 10 be dc 4f 44 6a 4f  ea 4c 5a a8 16 27 a5 91  |....ODjO.LZ..'..|
-00000250  56 55 ca 0c 87 2d 53 b1  08 01 4c 29 69 e9 0f b0  |VU...-S...L)i...|
-00000260  13 3f 85 bd 77 a4 c9 bd  2e 2b 25 cd 6f ca cb 3e  |.?..w....+%.o..>|
-00000270  c7 d7 6f 30 c8 f0 59 80  c2 0b dc 82 ea 03 c1 e6  |..o0..Y.........|
-00000280  b1 66 87 e2 e0 a5 74 67  52 6e 91 5d 91 4f a4 cc  |.f....tgRn.].O..|
-00000290  23 66 5c 13 d9 82 aa 92  5c df c7 78 9d 85 b6 93  |#f\.....\..x....|
-000002a0  f8 d9 1c b9 43 42 1e b8  a1 ec 54 9f 3c b0 5d 73  |....CB....T.<.]s|
-000002b0  a7 d3 67 09 de 23 d8 dc  b9 0b 05 f5 17 26 77 47  |..g..#.......&wG|
-000002c0  a1 1c 06 5b 6a ac 17 57  03 8f ec a6 31 4e f6 a2  |...[j..W....1N..|
-000002d0  e9 5f 54 96 7c 88 8c d3  3a 81 78 43 87 dc 03 d4  |._T.|...:.xC....|
-000002e0  a2 bd ea dd 0c 8d 96 ce  cc ac 5a 61 9d 7b b7 b9  |..........Za.{..|
-000002f0  57 58 12 8c 50 45 49 0b  83 d4 da 05 79 4d 16 0d  |WX..PEI.....yM..|
-00000300  c5 8a ee ca df 61 8f 75  57 dd 9a af 88 5a c5 36  |.....a.uW....Z.6|
-00000310  e2 3d 5b 17 03 03 00 99  92 29 a9 08 fc 03 57 eb  |.=[......)....W.|
-00000320  e1 14 9e ba 07 88 38 68  4e bc bc 8c 72 c6 44 71  |......8hN...r.Dq|
-00000330  d2 ad f5 38 4b 43 bc 05  1a 8e 7c 8d 91 66 70 26  |...8KC....|..fp&|
-00000340  fe a5 d3 c8 3b fb dd 44  53 73 31 01 54 09 dc df  |....;..DSs1.T...|
-00000350  c1 8a 67 7e c0 99 d8 6c  fc 00 fb 69 f8 d3 12 0a  |..g~...l...i....|
-00000360  6d 5a 5f 4b 42 f9 0a a9  d7 2a c0 d7 d1 05 b0 79  |mZ_KB....*.....y|
-00000370  44 1c 69 b1 c4 d9 fc ff  1e 62 95 7f c1 70 f1 b5  |D.i......b...p..|
-00000380  da af ff 5a 41 47 a8 7f  ff 35 03 4d ac 1c 24 09  |...ZAG...5.M..$.|
-00000390  12 88 ff 1d 1d f3 bc 1f  b2 57 8a 26 43 92 02 7e  |.........W.&C..~|
-000003a0  1c c2 31 56 1c d4 5e 12  fa 53 91 03 4b 2c 11 52  |..1V..^..S..K,.R|
-000003b0  94 17 03 03 00 45 7c 97  c5 b9 f8 de 80 9e 51 71  |.....E|.......Qq|
-000003c0  4b 17 eb d5 a0 55 13 1f  43 dc 58 d9 72 bd 9d 36  |K....U..C.X.r..6|
-000003d0  dc 18 38 11 28 0f b7 94  06 01 ba 05 7f 7e 3f 43  |..8.(........~?C|
-000003e0  1e f2 fe 43 64 6f d1 88  78 23 38 5a 8d 21 f9 b2  |...Cdo..x#8Z.!..|
-000003f0  8c 6d 88 df f3 ba 71 e6  c6 3f 96 17 03 03 00 97  |.m....q..?......|
-00000400  74 19 44 58 88 9c da 45  44 78 db 5d 4a fd a2 00  |t.DX...EDx.]J...|
-00000410  af 10 ff 47 64 a0 f0 44  64 64 c0 e5 df 8c 1e 3c  |...Gd..Ddd.....<|
-00000420  6c ae 98 3f bf f0 05 4a  be 95 e6 35 d9 54 c8 87  |l..?...J...5.T..|
-00000430  bf 4b 1d 5b c2 f9 4d ec  01 09 b3 25 d6 ac 0f 6d  |.K.[..M....%...m|
-00000440  2c 5b c4 d0 ab 52 f7 39  b9 2f 6c e3 78 19 92 9d  |,[...R.9./l.x...|
-00000450  51 20 6d db 34 b8 c2 d1  cf a4 d8 ee 0a 9a 78 60  |Q m.4.........x`|
-00000460  20 71 6f 08 26 3b d0 75  a2 4f df 0a 36 2c bc 69  | qo.&;.u.O..6,.i|
-00000470  de 41 23 c1 6f f3 03 91  97 c4 4b 4a 4f 54 18 96  |.A#.o.....KJOT..|
-00000480  41 ad 62 d1 b1 c2 f8 cb  b7 72 23 0a 7b cd 40 a9  |A.b......r#.{.@.|
-00000490  9a 4f ea f8 af 05 7d                              |.O....}|
+00000080  03 03 00 01 01 17 03 03  00 17 21 12 ff 3f 25 b6  |..........!..?%.|
+00000090  d7 7a 73 c7 85 d3 3d ae  89 1a 55 b1 f3 45 5e f3  |.zs...=...U..E^.|
+000000a0  c8 17 03 03 02 6d 7c ae  9e 9a 27 ee 14 a0 81 9e  |.....m|...'.....|
+000000b0  fc e9 0b 0e a0 15 f6 8a  8d 07 36 b1 eb 03 f6 a4  |..........6.....|
+000000c0  d1 3b 1d bb d4 32 4f 75  36 55 b4 e5 0c a5 dd 1f  |.;...2Ou6U......|
+000000d0  dc 73 44 0b 13 66 17 cc  3e 8e ce 92 1e 8d 09 12  |.sD..f..>.......|
+000000e0  60 8e e2 1a 64 1f 63 c4  6b 9f 69 70 1b 26 3f 00  |`...d.c.k.ip.&?.|
+000000f0  5b f2 30 9b 2b 47 11 e8  16 6a c1 8c d9 69 2f ce  |[.0.+G...j...i/.|
+00000100  a3 79 ae 2f 1b 44 13 3b  aa 46 69 c9 dc 20 29 2c  |.y./.D.;.Fi.. ),|
+00000110  3c b4 8c b7 19 05 dc dc  90 fe 89 ec eb 71 c3 82  |<............q..|
+00000120  67 e3 04 9f 48 ab 8b 90  39 0a c2 2d 4f ae 31 8c  |g...H...9..-O.1.|
+00000130  d3 86 c6 26 96 25 69 c4  25 1b 54 61 7e 43 46 a0  |...&.%i.%.Ta~CF.|
+00000140  fa 95 35 0e 21 d5 5b 29  b1 ca 1c f3 4d b7 c4 68  |..5.!.[)....M..h|
+00000150  8d 36 5c 82 fa 3e 7d e7  cc 8a 27 cb e6 2c ea 12  |.6\..>}...'..,..|
+00000160  ea 4d 21 d4 09 b2 f7 07  16 ae 17 d1 48 3b b6 3e  |.M!.........H;.>|
+00000170  ac 41 2f f7 e0 23 94 c8  b6 b6 60 7e 70 c9 a6 d3  |.A/..#....`~p...|
+00000180  ac 64 1e 05 e4 be f7 a3  d8 fe 2f da 9e 25 9f 98  |.d......../..%..|
+00000190  22 b7 8a 90 2a 5c c6 35  7f 62 72 8d fc 73 d5 d7  |"...*\.5.br..s..|
+000001a0  ee bb 86 22 9b e2 b1 1a  c2 82 e1 26 b3 6d af 11  |...".......&.m..|
+000001b0  00 81 5a 81 96 04 63 f5  b3 fd a3 3f 26 84 a8 cd  |..Z...c....?&...|
+000001c0  95 c0 5d 81 3f 9e 0f 02  56 ff 65 fc a5 2e d6 c8  |..].?...V.e.....|
+000001d0  b5 b6 7d 8e 27 54 a3 e3  3d 00 1b ec 92 e9 a6 1d  |..}.'T..=.......|
+000001e0  74 dd dc bd c4 82 be 81  0e 6b 07 f2 2c 40 d8 c0  |t........k..,@..|
+000001f0  93 91 83 f8 8c 0a c8 94  a3 4e 80 d3 57 9e bf 9e  |.........N..W...|
+00000200  f0 b2 c9 cb 51 0d 98 d5  4b b9 8f 39 e5 dc 9d b5  |....Q...K..9....|
+00000210  03 8f f6 9f c2 eb 0c fb  35 24 9d a6 8c 84 cb 48  |........5$.....H|
+00000220  64 dc bf 3d 91 73 f4 f1  46 7d f7 62 0f 30 7d 09  |d..=.s..F}.b.0}.|
+00000230  c2 2e 40 17 83 0a e5 e5  93 d8 80 53 c3 13 ea 47  |..@........S...G|
+00000240  2d 47 77 77 6e 60 a2 d8  29 76 7d 0b 7f 80 18 ea  |-Gwwn`..)v}.....|
+00000250  23 8e a3 37 00 87 0b c6  5d 01 74 53 22 63 99 f0  |#..7....].tS"c..|
+00000260  86 19 8b ca 27 27 83 75  87 60 d6 e3 ff 00 c3 66  |....''.u.`.....f|
+00000270  13 d0 e3 f9 48 3c d6 bd  f7 70 d4 3d e3 88 92 2f  |....H<...p.=.../|
+00000280  ee ea 71 d2 60 f2 1b ce  91 a9 ea 54 dc ca 88 b7  |..q.`......T....|
+00000290  c8 b2 67 87 9d 65 1f 99  47 35 db e6 7b 9c 92 74  |..g..e..G5..{..t|
+000002a0  2e f2 6c e3 6c a3 5c 39  a3 de f7 38 11 5b 4a 1c  |..l.l.\9...8.[J.|
+000002b0  17 6e 9a e5 d3 69 e7 42  91 ff a7 88 75 0e 0a ba  |.n...i.B....u...|
+000002c0  87 0b ac 88 b5 2b 27 5b  a7 ba a2 26 ac 48 ab b8  |.....+'[...&.H..|
+000002d0  1e e5 76 1a 0c 3e 6c 98  87 d1 b0 cc 34 2a dc d2  |..v..>l.....4*..|
+000002e0  59 a8 c6 82 e6 d1 be 53  c3 30 7f e6 be c2 86 9c  |Y......S.0......|
+000002f0  2b b6 3d c5 2d 1e 31 1b  b1 2e fe a0 1b c7 40 80  |+.=.-.1.......@.|
+00000300  1a 0c 1b d7 82 e8 c0 ce  43 5a 4a ae 19 08 40 9f  |........CZJ...@.|
+00000310  cc 17 15 17 03 03 00 99  0a d6 13 12 9a e1 25 ba  |..............%.|
+00000320  4f fc 7e 27 80 7a 97 24  18 af eb 56 a4 70 91 16  |O.~'.z.$...V.p..|
+00000330  c6 4d 1a 54 92 b3 21 11  bc bd d9 3d 0d ee 7b 76  |.M.T..!....=..{v|
+00000340  23 28 6e 01 33 07 e1 bb  6f 0b f5 e3 a7 ee d9 eb  |#(n.3...o.......|
+00000350  72 d6 0a e2 6b 06 89 14  59 9d 24 9d 3c 19 c3 fe  |r...k...Y.$.<...|
+00000360  b5 83 0e 40 45 0d 60 11  6d 94 14 bd 01 b6 f6 1c  |...@E.`.m.......|
+00000370  ff ac e7 42 83 84 9f 21  a7 c2 ae 60 ba d4 95 0c  |...B...!...`....|
+00000380  5f 3a ca 22 2e 3a 20 7b  69 35 c9 cf 0c f9 f7 87  |_:.".: {i5......|
+00000390  92 80 e3 e5 8f f6 4f 06  eb 1f ad 62 65 67 e2 c9  |......O....beg..|
+000003a0  21 96 8b 12 78 25 d3 f5  be 9f 9f d3 12 4c 89 b5  |!...x%.......L..|
+000003b0  c0 17 03 03 00 45 a1 ff  13 69 40 48 5c 0f 50 3d  |.....E...i@H\.P=|
+000003c0  19 b7 a7 5f 93 96 a7 24  01 dc e0 a2 25 d5 49 cc  |..._...$....%.I.|
+000003d0  7c 3c 7e 98 b1 23 33 c2  c7 ff 05 55 a3 2c 89 58  ||<~..#3....U.,.X|
+000003e0  0f 81 f9 1f 3e f6 88 6c  1e 64 4e b2 c3 eb 56 22  |....>..l.dN...V"|
+000003f0  fe af 29 c4 00 fe f7 96  3b d2 54 17 03 03 00 98  |..).....;.T.....|
+00000400  2a 13 d1 8e 4c 83 10 d7  9f 2b 4c d1 81 fc 8c 4b  |*...L....+L....K|
+00000410  89 19 44 6a 35 c5 a9 9f  e3 79 47 68 4e 2d 9f ec  |..Dj5....yGhN-..|
+00000420  7f 96 9f 2b 97 5f 96 96  5e 15 68 d2 50 bb 96 55  |...+._..^.h.P..U|
+00000430  32 25 68 1e d4 34 e5 12  fb 15 82 21 53 dd 60 48  |2%h..4.....!S.`H|
+00000440  33 1b 73 9d 42 df cf cb  bc 7f cf b1 c8 b7 93 d9  |3.s.B...........|
+00000450  ba fa 0d 14 59 77 9a 89  a3 5c a2 c3 d6 a3 00 3f  |....Yw...\.....?|
+00000460  bc e2 71 3a 27 1b 50 43  85 a1 39 01 4e 69 dc 12  |..q:'.PC..9.Ni..|
+00000470  32 45 1d 94 70 a1 25 ee  56 2c 10 75 be 61 91 dd  |2E..p.%.V,.u.a..|
+00000480  0e 51 e7 51 3f b8 79 da  9d 4c ba 91 2d d1 4f 04  |.Q.Q?.y..L..-.O.|
+00000490  45 e1 d9 9d 26 ff cd 0a                           |E...&...|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 45 94 19 4b 1a 6c  |..........E..K.l|
-00000010  e0 52 9b 9e 12 b7 c4 59  32 b5 fa 8d 11 72 0e 0a  |.R.....Y2....r..|
-00000020  b8 3a 70 15 a7 c5 74 70  e0 6f 41 c1 5c 0b 43 73  |.:p...tp.oA.\.Cs|
-00000030  0e 14 7a e2 2b 65 2c 96  6e 21 61 2b 4f b8 4e f1  |..z.+e,.n!a+O.N.|
-00000040  65 c2 a2 d4 31 f5 f7 93  86 1f 53 aa 39 d1 56 cd  |e...1.....S.9.V.|
+00000000  14 03 03 00 01 01 17 03  03 00 45 53 26 d9 60 e9  |..........ES&.`.|
+00000010  10 a7 8b e6 87 88 ab 40  77 25 4c 06 9e 90 be 96  |.......@w%L.....|
+00000020  83 f2 f7 72 1e ed 66 c6  bd 2f 48 d0 56 a9 c1 d2  |...r..f../H.V...|
+00000030  9e 38 9a e3 6f 4f d3 e9  e2 16 72 d7 52 39 86 69  |.8..oO....r.R9.i|
+00000040  cc 7a 72 2b a4 c0 41 4c  64 f6 b1 a3 8d 2f dd 8f  |.zr+..ALd..../..|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 4f 8f be  14 c3 c7 c3 9a 72 26 01  |.....O.......r&.|
-00000010  d7 6a 23 51 0d 0e 63 b0  b0 95 5d 15 44 71 ce 60  |.j#Q..c...].Dq.`|
-00000020  c0 bc 54 17 03 03 00 13  6c 72 16 fc b9 f2 66 c8  |..T.....lr....f.|
-00000030  2b 61 90 ab 05 02 0c e0  12 b0 d1                 |+a.........|
+00000000  17 03 03 00 1e 65 7d 59  f1 cf fe df 97 4a c8 f9  |.....e}Y.....J..|
+00000010  4a 85 3a 5f a2 02 00 f1  09 15 70 67 91 13 be 44  |J.:_......pg...D|
+00000020  de 22 17 17 03 03 00 13  dc 70 04 9b 4c d7 9f 9a  |.".......p..L...|
+00000030  b0 5c 40 aa cc d4 a7 5a  9c 56 20                 |.\@....Z.V |
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ALPN b/src/crypto/tls/testdata/Server-TLSv13-ALPN
index 92bb51b80e..551b703cff 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ALPN
+++ b/src/crypto/tls/testdata/Server-TLSv13-ALPN
@@ -1,9 +1,9 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 e2 01 00 00  de 03 03 2e e8 1a 78 13  |..............x.|
-00000010  b1 35 2f d1 8a 01 b5 0f  27 a7 67 d8 b3 b3 b7 9c  |.5/.....'.g.....|
-00000020  e9 86 8b 8d 3e 40 2b 69  05 c5 f2 20 33 4d 75 fe  |....>@+i... 3Mu.|
-00000030  78 ff 77 7d 59 fc 2b 52  d0 f5 8d 17 99 74 d4 55  |x.w}Y.+R.....t.U|
-00000040  ab 36 4c 9b f4 c7 e3 c7  b3 af 4f 2f 00 04 13 03  |.6L.......O/....|
+00000000  16 03 01 00 e2 01 00 00  de 03 03 51 d6 14 92 24  |...........Q...$|
+00000010  c5 f3 c8 8a 17 45 15 5b  67 fa 9e a3 81 23 71 d2  |.....E.[g....#q.|
+00000020  07 8e b8 39 0b 07 89 65  4f d5 af 20 d7 10 6d 0e  |...9...eO.. ..m.|
+00000030  65 cd e6 51 cd c7 f7 29  80 e6 d9 25 d7 d2 3c 18  |e..Q...)...%..<.|
+00000040  1c 12 c2 aa 3d 54 fb 3e  6f 7c 97 ae 00 04 13 03  |....=T.>o|......|
 00000050  00 ff 01 00 00 91 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 10 00 10 00 0e  06 70 72 6f 74 6f 32 06  |.........proto2.|
@@ -11,90 +11,90 @@
 00000090  00 1e 00 1c 04 03 05 03  06 03 08 07 08 08 08 09  |................|
 000000a0  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
 000000b0  00 2b 00 03 02 03 04 00  2d 00 02 01 01 00 33 00  |.+......-.....3.|
-000000c0  26 00 24 00 1d 00 20 3b  c9 4d 90 a7 cf 43 df cd  |&.$... ;.M...C..|
-000000d0  a7 de 9f 3b 2c 07 dc 7b  9c 40 f1 45 f2 d1 d2 7a  |...;,..{.@.E...z|
-000000e0  03 3e d1 35 90 f1 35                              |.>.5..5|
+000000c0  26 00 24 00 1d 00 20 58  b3 f3 ca f0 ed df aa 37  |&.$... X.......7|
+000000d0  a7 d6 78 21 9a dc 01 05  36 f2 a0 b2 59 d4 47 56  |..x!....6...Y.GV|
+000000e0  2e bd 39 46 38 b7 74                              |..9F8.t|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 33 4d 75 fe  |........... 3Mu.|
-00000030  78 ff 77 7d 59 fc 2b 52  d0 f5 8d 17 99 74 d4 55  |x.w}Y.+R.....t.U|
-00000040  ab 36 4c 9b f4 c7 e3 c7  b3 af 4f 2f 13 03 00 00  |.6L.......O/....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 d7 10 6d 0e  |........... ..m.|
+00000030  65 cd e6 51 cd c7 f7 29  80 e6 d9 25 d7 d2 3c 18  |e..Q...)...%..<.|
+00000040  1c 12 c2 aa 3d 54 fb 3e  6f 7c 97 ae 13 03 00 00  |....=T.>o|......|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 24 4c 67 ee 74 f2 40  |.........$Lg.t.@|
-00000090  8d 45 8f fc ca 38 87 91  6b 84 27 c6 98 01 51 f3  |.E...8..k.'...Q.|
-000000a0  72 a9 4a e9 18 f1 66 55  3b 5f a0 00 fe 1c 17 03  |r.J...fU;_......|
-000000b0  03 02 6d 2c 30 58 8e 9b  e9 39 18 81 5b 0f e7 b5  |..m,0X...9..[...|
-000000c0  cc 1f cb 4c 76 17 4f 64  a3 58 d4 70 d6 5f 8b c8  |...Lv.Od.X.p._..|
-000000d0  0e a6 6b e5 ee 64 67 3d  d7 b6 34 ce f2 5d 2f 25  |..k..dg=..4..]/%|
-000000e0  5c 41 6b b9 58 cf 93 da  b7 8e 74 7e c7 91 ad db  |\Ak.X.....t~....|
-000000f0  e3 55 f8 24 f6 22 81 1e  18 6a 01 b8 29 cb 2a 53  |.U.$."...j..).*S|
-00000100  93 67 82 d4 97 34 29 ba  13 25 0a 0c ed 24 35 ec  |.g...4)..%...$5.|
-00000110  d8 d4 3e 6e cd d3 4c b4  26 75 df 32 5e 29 b0 da  |..>n..L.&u.2^)..|
-00000120  63 e7 e0 4a bd 59 50 3c  71 a6 af 5f 5d f4 b8 9d  |c..J.YP<q.._]...|
-00000130  37 66 3f b8 13 85 e1 7e  c4 b0 6a fe ad 0c 74 ce  |7f?....~..j...t.|
-00000140  36 1c 6d 03 8a 5f 5c c1  e8 4b 00 06 1f 29 90 a9  |6.m.._\..K...)..|
-00000150  af e5 9f 35 1d 7a 0f 07  b7 ae d2 84 c5 48 bc b0  |...5.z.......H..|
-00000160  98 c7 3b 20 a4 0a 0c 18  79 5e 85 65 ce 08 ad 1b  |..; ....y^.e....|
-00000170  bb ac 59 f4 ed cf e3 32  0b 16 00 12 30 56 2c 33  |..Y....2....0V,3|
-00000180  2b 67 10 4d 59 07 13 a4  5f 28 8f bb 3a 6e bb cb  |+g.MY..._(..:n..|
-00000190  92 15 c4 03 d4 e0 37 82  2a 54 07 c4 e1 95 ed 67  |......7.*T.....g|
-000001a0  3f 3a 9a 02 e1 6b 3b a5  74 68 13 92 10 e2 df 73  |?:...k;.th.....s|
-000001b0  04 2c e6 20 d7 a0 55 be  0e 98 27 10 8f b7 11 52  |.,. ..U...'....R|
-000001c0  9a 20 2b 8b d2 b8 5b fe  0d 30 8c ab 63 cc 3f ca  |. +...[..0..c.?.|
-000001d0  38 5d 27 16 fe 42 3b ad  de 37 d0 b9 fc eb 13 7d  |8]'..B;..7.....}|
-000001e0  af de 82 2b 43 60 ab 8a  12 10 d1 06 98 64 e7 bd  |...+C`.......d..|
-000001f0  ac 00 a0 7d 2b 19 77 b4  76 40 33 3e 8f 35 19 67  |...}+.w.v@3>.5.g|
-00000200  02 7a f3 b0 47 f1 3f c6  ef 81 19 02 48 3a 9f 67  |.z..G.?.....H:.g|
-00000210  c0 08 82 ce d2 db 07 14  fe d7 7c 2c b3 40 3c 88  |..........|,.@<.|
-00000220  92 9a 3a 1b 5d 5a c9 ee  f8 92 de 40 4f 96 ac ee  |..:.]Z.....@O...|
-00000230  99 71 47 5c 0c de 92 eb  24 b6 2c 6d c0 e9 37 d0  |.qG\....$.,m..7.|
-00000240  1f d8 ec 8c b8 ab d9 01  91 6f 35 57 14 fb 98 ce  |.........o5W....|
-00000250  17 60 fd a1 5a 90 f2 6f  32 32 98 94 ab ed 02 f7  |.`..Z..o22......|
-00000260  72 54 f0 e3 c0 fa 56 1b  d8 05 c7 c4 15 d0 1c b7  |rT....V.........|
-00000270  71 f1 3f 01 cf 63 97 8a  02 73 d2 97 15 2c 70 c1  |q.?..c...s...,p.|
-00000280  bf bc 5e 4f 01 58 81 f6  59 c2 45 c3 d4 95 ff 8f  |..^O.X..Y.E.....|
-00000290  ae 10 97 e2 ab ac c6 da  ed cb 6f a0 b8 5d 2c a1  |..........o..],.|
-000002a0  01 1d 96 7a 30 86 8b cf  fb b4 b6 d5 95 9c 0c b8  |...z0...........|
-000002b0  47 2c 49 bf c7 6a 76 b8  f5 28 4b d6 20 5c 0e 37  |G,I..jv..(K. \.7|
-000002c0  29 6a 45 2b 1c 4e db ed  2e 38 88 de f0 07 14 a9  |)jE+.N...8......|
-000002d0  04 33 3b 31 16 47 74 cc  02 24 b7 0b 05 a9 4e 74  |.3;1.Gt..$....Nt|
-000002e0  d8 c4 37 53 78 fc ef 4d  e2 b5 72 2a 5c e0 68 5b  |..7Sx..M..r*\.h[|
-000002f0  14 28 52 a8 92 6e 88 62  52 b7 bf 4a 5e 88 a9 f5  |.(R..n.bR..J^...|
-00000300  08 08 04 9d 0a dc 4f e6  39 80 9d ba 74 16 83 6c  |......O.9...t..l|
-00000310  3a 01 9e fa 07 c9 b5 73  15 9a 6f 4e 2a ef 76 d9  |:......s..oN*.v.|
-00000320  17 03 03 00 99 4a cc 37  f7 66 8f 64 a5 4d 79 86  |.....J.7.f.d.My.|
-00000330  70 f9 7c 9e 3a 7f 31 1a  12 cb e0 4e 39 8f c5 2e  |p.|.:.1....N9...|
-00000340  af ad 05 8f bc 78 a8 18  7d 6a 22 c7 d2 3d 94 e6  |.....x..}j"..=..|
-00000350  93 88 e4 c0 df 64 dc db  eb 9c 52 3a 74 19 4f 70  |.....d....R:t.Op|
-00000360  ce 98 7f d7 b0 c9 e3 53  e8 63 3f a8 3e d8 60 04  |.......S.c?.>.`.|
-00000370  ca fc 8f ae 20 e5 64 bb  d8 1c 31 74 39 2a 89 ac  |.... .d...1t9*..|
-00000380  87 ab fd 79 a4 e2 57 e1  8d 9b e6 d9 13 32 1c 78  |...y..W......2.x|
-00000390  0d 13 bd e6 ef fa b5 a8  3a 4a 09 ef 27 3e 1a fb  |........:J..'>..|
-000003a0  4c ea 06 57 b4 69 15 c2  1d 7d cf cb db 85 2f c6  |L..W.i...}..../.|
-000003b0  e1 6f 65 35 67 6c d5 9c  f6 37 fd 2d c9 80 17 03  |.oe5gl...7.-....|
-000003c0  03 00 35 62 93 bb d3 3f  46 a9 58 d6 ff 0e 08 0e  |..5b...?F.X.....|
-000003d0  22 09 eb fa b4 8c 98 5d  81 8e d4 3a 68 02 bc f7  |"......]...:h...|
-000003e0  0d 76 04 11 3e 39 38 24  e1 cc c7 0b f3 dd 55 22  |.v..>98$......U"|
-000003f0  c5 e3 9c 30 dc c9 51 08  17 03 03 00 87 3a 87 55  |...0..Q......:.U|
-00000400  53 28 6e ae 80 01 a8 53  02 29 50 7c 3d e1 1a a2  |S(n....S.)P|=...|
-00000410  d4 d3 45 48 de 8e b2 07  26 d5 a4 00 5f a5 db 07  |..EH....&..._...|
-00000420  9d 9b 5c a3 8e a2 df 54  d1 50 25 25 5c 0c 65 9d  |..\....T.P%%\.e.|
-00000430  6a 1b 7b 1b bd 26 c5 ec  15 57 b3 50 b1 bf 63 a9  |j.{..&...W.P..c.|
-00000440  d3 fc 99 1e f3 7f c7 2b  dd f7 0b ba b6 b6 77 e7  |.......+......w.|
-00000450  26 03 f9 e2 08 2b b3 80  f6 5b f6 eb 96 f1 0d c0  |&....+...[......|
-00000460  11 8c e2 16 13 2e 9a 79  44 f7 6c 8d 41 58 56 ea  |.......yD.l.AXV.|
-00000470  e7 56 33 06 8f ed b5 ea  f8 90 76 98 d9 04 3b f7  |.V3.......v...;.|
-00000480  e5 86 94 07                                       |....|
+00000080  03 03 00 01 01 17 03 03  00 24 fd 42 02 db 42 3c  |.........$.B..B<|
+00000090  94 97 c7 54 12 f6 4a b0  86 7f bf a6 ad 9d 70 e8  |...T..J.......p.|
+000000a0  b7 a8 e4 db 6c 6a 6c 06  f6 28 60 8b 7b 1d 17 03  |....ljl..(`.{...|
+000000b0  03 02 6d f8 77 4b db b1  68 74 50 c0 19 2f 6d 9f  |..m.wK..htP../m.|
+000000c0  4a 63 5b 7d 0e e0 21 73  b0 05 26 9c 63 ad 99 8e  |Jc[}..!s..&.c...|
+000000d0  5d bb 9b 7d c4 8b 49 63  63 aa 6d e5 1a 93 38 d6  |]..}..Icc.m...8.|
+000000e0  19 f2 b2 42 15 7c ff 75  98 61 0b 10 8e 06 63 ca  |...B.|.u.a....c.|
+000000f0  24 9c 72 2a e1 16 b9 eb  88 e1 05 dd 4b 79 5a 56  |$.r*........KyZV|
+00000100  44 60 b3 51 13 4d 2c 7c  2f 38 e7 df 73 fb 57 d6  |D`.Q.M,|/8..s.W.|
+00000110  13 0d b3 79 fe c6 99 e1  36 11 a1 39 15 14 d1 48  |...y....6..9...H|
+00000120  cd 3c 62 81 c8 c9 52 d0  fe f7 71 c1 a4 71 16 6e  |.<b...R...q..q.n|
+00000130  f5 3e 79 6d 9b 47 61 15  d7 23 cc c5 36 aa ac 57  |.>ym.Ga..#..6..W|
+00000140  c5 2c 11 50 1d ce 64 88  e6 0e 26 fd 1b 7c 0a 59  |.,.P..d...&..|.Y|
+00000150  61 0c 85 e5 82 6c c0 55  2d b1 9e db c6 a4 5e 66  |a....l.U-.....^f|
+00000160  1c d4 1c af 6a 03 e9 d2  43 a0 64 e2 60 ea b3 ec  |....j...C.d.`...|
+00000170  b7 58 67 4a 8b 91 cb 41  bf af 32 10 a2 3d 0d fa  |.XgJ...A..2..=..|
+00000180  5e ba e0 c1 ab fa 27 3d  b4 10 17 e7 6f 0c 56 94  |^.....'=....o.V.|
+00000190  97 54 3a 4a 37 25 88 ea  c9 9c 1d 2e d2 50 41 1f  |.T:J7%.......PA.|
+000001a0  bd 7e 0e 80 bd d0 fe fa  6e 19 b2 9a b6 ec 3a 5b  |.~......n.....:[|
+000001b0  0a 65 ea 0c 24 9e b1 1f  20 dd 9c 91 b1 3e 84 2a  |.e..$... ....>.*|
+000001c0  bb 87 c5 59 16 bb 43 fd  19 82 89 20 39 fe 3f 64  |...Y..C.... 9.?d|
+000001d0  1d 3f 23 5b a0 a8 1e b9  9d b3 e8 18 ad 9b 3e 93  |.?#[..........>.|
+000001e0  b6 7a 21 d7 0f 82 fb d1  53 07 48 9b e8 99 68 34  |.z!.....S.H...h4|
+000001f0  dd aa 13 0e 4e de 23 0d  a6 67 38 eb 41 59 75 d3  |....N.#..g8.AYu.|
+00000200  d9 79 3f 9b a3 2d e8 fd  25 96 c9 f5 a0 73 f3 c7  |.y?..-..%....s..|
+00000210  68 7f b7 8a ed 2c ad 21  4c f7 a4 32 c1 57 ce 55  |h....,.!L..2.W.U|
+00000220  d3 66 ed c8 a7 b6 68 2d  23 30 13 f4 34 b4 88 3a  |.f....h-#0..4..:|
+00000230  ee 30 33 2f d7 86 1c fc  fb 02 81 93 14 56 32 d0  |.03/.........V2.|
+00000240  79 b7 d8 25 8c 51 84 58  d1 a0 d7 22 1e b4 98 84  |y..%.Q.X..."....|
+00000250  dc e6 ab 20 11 06 31 dd  36 bf dd be 5d 91 59 bd  |... ..1.6...].Y.|
+00000260  bf c1 03 44 bd 06 e6 59  07 c5 61 92 46 80 5f 21  |...D...Y..a.F._!|
+00000270  f6 aa c3 cb f6 15 c3 b2  fb 63 93 25 c6 3c 98 07  |.........c.%.<..|
+00000280  3e 00 a0 4d b8 2b 6a 11  3c 1b d8 a4 80 cb 6f 4c  |>..M.+j.<.....oL|
+00000290  b9 3e 4a 20 44 12 f3 b5  b8 85 66 c0 13 48 d3 43  |.>J D.....f..H.C|
+000002a0  c2 ca 17 23 e2 3b af 1f  d7 71 9e b1 15 cc 62 5c  |...#.;...q....b\|
+000002b0  f4 c7 02 6f 61 55 17 99  32 d8 55 41 ca 11 a0 22  |...oaU..2.UA..."|
+000002c0  25 1c cd 37 2c 62 76 7f  35 81 84 bf 97 5e ca 97  |%..7,bv.5....^..|
+000002d0  1f 75 90 f8 9a 81 9b 11  bc 1e 1f a0 e0 cd 78 b9  |.u............x.|
+000002e0  fb 20 fe 63 b2 b8 a3 ff  a5 b7 90 16 f9 46 2a 6b  |. .c.........F*k|
+000002f0  db 2e d6 30 1b 2d 65 d5  8c 7b c2 1c d6 1d 64 8b  |...0.-e..{....d.|
+00000300  17 de 8c 1b bc 06 e3 4a  b8 34 e2 dd 6c 50 27 c6  |.......J.4..lP'.|
+00000310  3d 08 79 70 6c ac 7c 28  fe d9 68 89 e2 b0 73 f5  |=.ypl.|(..h...s.|
+00000320  17 03 03 00 99 1f b5 fc  e9 d8 62 69 b1 e0 6d 33  |..........bi..m3|
+00000330  3e 65 6a 9e 38 52 bd 8f  30 06 e9 06 e2 26 08 28  |>ej.8R..0....&.(|
+00000340  02 45 50 c4 3a b0 3c 2e  f7 dd 15 7b e9 60 e0 89  |.EP.:.<....{.`..|
+00000350  9d fb fa 0b e7 3a 6f ce  59 a8 c0 fa ec ef f4 58  |.....:o.Y......X|
+00000360  a2 d9 e2 45 41 5a eb 9b  6a cf 4b ec 15 74 a4 27  |...EAZ..j.K..t.'|
+00000370  3b 88 eb 62 4d 7b f6 46  27 7d 0b 7f b5 49 76 d0  |;..bM{.F'}...Iv.|
+00000380  d9 29 55 12 de 5a 22 33  d3 80 5e 59 2a 24 b3 71  |.)U..Z"3..^Y*$.q|
+00000390  ab 78 3a 4d d9 e3 94 b1  3d 5f ce aa ec 5d 0d bf  |.x:M....=_...]..|
+000003a0  14 98 7b 63 29 06 36 6a  d4 c8 c8 32 7e 77 8f 33  |..{c).6j...2~w.3|
+000003b0  d9 72 54 a4 6d 87 5a 6f  94 cd 53 28 79 26 17 03  |.rT.m.Zo..S(y&..|
+000003c0  03 00 35 cf 28 5c f3 33  26 3e 71 7b cb 5c e2 05  |..5.(\.3&>q{.\..|
+000003d0  37 6d 67 a0 ca 42 79 e2  23 76 36 86 2e 57 0a e8  |7mg..By.#v6..W..|
+000003e0  cb b1 b3 77 81 4f ac e8  2f 4e d4 e4 49 a9 a6 7c  |...w.O../N..I..||
+000003f0  51 c9 20 36 a3 57 a9 b7  17 03 03 00 88 33 dd 67  |Q. 6.W.......3.g|
+00000400  b2 69 38 87 a8 39 9b df  10 bd 6a 02 1c 6e bc 60  |.i8..9....j..n.`|
+00000410  85 9e 7f 34 fb 72 26 c5  c3 f4 79 35 d1 94 c7 a4  |...4.r&...y5....|
+00000420  92 13 c2 34 1a 8c e8 66  78 05 78 0b 23 59 ef 25  |...4...fx.x.#Y.%|
+00000430  16 19 05 78 bf b7 ba 73  8d 2a 0a ab 1e 9d f3 64  |...x...s.*.....d|
+00000440  b7 6c 53 43 89 93 1c 36  86 21 76 09 a8 24 70 e9  |.lSC...6.!v..$p.|
+00000450  a1 3f 0d 09 6c 4b 2c 16  d4 ab 49 5a f0 d7 68 b8  |.?..lK,...IZ..h.|
+00000460  59 f1 89 4a b6 02 a0 63  b6 d4 aa fe 8f f5 9a 2e  |Y..J...c........|
+00000470  64 7f 10 23 b5 41 2b c4  8e 31 0a c9 a1 45 4e c4  |d..#.A+..1...EN.|
+00000480  4f c9 fa 6b 4c                                    |O..kL|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 90 fe a0 7d 87  |..........5...}.|
-00000010  c6 c2 c2 a9 e7 1d de c5  51 68 ed 8c 61 ea b2 25  |........Qh..a..%|
-00000020  ff 4c 1b f2 67 b9 b0 c3  fd 8d cf 47 88 c5 60 71  |.L..g......G..`q|
-00000030  35 7c 67 bb e7 93 b2 a7  47 74 01 a7 8d e1 35 1f  |5|g.....Gt....5.|
+00000000  14 03 03 00 01 01 17 03  03 00 35 8a 24 85 c3 c1  |..........5.$...|
+00000010  8b c9 45 3a ab 1b dc 1a  97 ab 95 49 b2 24 2d 99  |..E:.......I.$-.|
+00000020  96 de 6d 9d ce 1d a9 15  57 30 05 6a 01 09 68 ea  |..m.....W0.j..h.|
+00000030  ca c4 b4 03 10 2f 56 2a  1d 9f 56 0b 0e f8 95 f7  |...../V*..V.....|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 33 6d d3  22 c3 bb 8f 30 3c c6 e6  |.....3m."...0<..|
-00000010  01 6f 4a 34 55 21 35 01  10 89 8f b2 ab a6 c3 13  |.oJ4U!5.........|
-00000020  a8 0c a3 17 03 03 00 13  32 87 af 0f 58 18 6c 43  |........2...X.lC|
-00000030  40 51 6b f4 c7 1c 42 f1  19 f0 76                 |@Qk...B...v|
+00000000  17 03 03 00 1e 85 6c 73  31 6f 05 67 a0 ac 7b 7c  |......ls1o.g..{||
+00000010  e6 d2 cf 1a 4b 14 29 68  67 59 44 7b 4b fc 24 48  |....K.)hgYD{K.$H|
+00000020  e1 6f 43 17 03 03 00 13  97 97 f3 ed 0c 1c 34 7f  |.oC...........4.|
+00000030  e6 1e 73 f4 e9 fd 60 01  87 05 1f                 |..s...`....|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ALPN-Fallback b/src/crypto/tls/testdata/Server-TLSv13-ALPN-Fallback
index 2479b3bd3e..e537f8d66e 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ALPN-Fallback
+++ b/src/crypto/tls/testdata/Server-TLSv13-ALPN-Fallback
@@ -1,9 +1,9 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 eb 01 00 00  e7 03 03 ff 2b 30 06 29  |............+0.)|
-00000010  23 b0 1f ae 32 ec 31 3d  e5 a8 58 51 5e 1a 94 a0  |#...2.1=..XQ^...|
-00000020  00 10 96 8d d4 3e d9 c9  3f fe fb 20 80 6d 42 18  |.....>..?.. .mB.|
-00000030  67 9d 57 53 06 26 91 f5  bc f0 64 11 2b 03 ec c6  |g.WS.&....d.+...|
-00000040  9e a7 4a 94 40 c7 8f b6  73 3c 7c 41 00 04 13 03  |..J.@...s<|A....|
+00000000  16 03 01 00 eb 01 00 00  e7 03 03 cc e4 f9 6e 66  |..............nf|
+00000010  77 e9 b4 e6 54 d2 65 47  46 1b ad 21 35 ae c2 6b  |w...T.eGF..!5..k|
+00000020  40 96 00 97 e1 fd ce 0b  11 7a be 20 51 69 17 c8  |@........z. Qi..|
+00000030  aa fa 20 4f 3b 3f 4f ac  5c 02 4c aa 7a 84 4d 46  |.. O;?O.\.L.z.MF|
+00000040  4b 60 11 f4 66 88 bd dd  76 41 dc 31 00 04 13 03  |K`..f...vA.1....|
 00000050  00 ff 01 00 00 9a 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 10 00 19 00 17  06 70 72 6f 74 6f 33 08  |.........proto3.|
@@ -12,88 +12,88 @@
 000000a0  03 06 03 08 07 08 08 08  09 08 0a 08 0b 08 04 08  |................|
 000000b0  05 08 06 04 01 05 01 06  01 00 2b 00 03 02 03 04  |..........+.....|
 000000c0  00 2d 00 02 01 01 00 33  00 26 00 24 00 1d 00 20  |.-.....3.&.$... |
-000000d0  f6 f4 17 de e2 da f3 3e  6b ac 51 b1 15 01 3a 3b  |.......>k.Q...:;|
-000000e0  26 8f e2 79 83 f5 bb 27  70 73 59 2a 15 b2 d6 6c  |&..y...'psY*...l|
+000000d0  c8 f3 33 2e 23 4d b2 e1  c8 a0 23 2c 25 f5 48 73  |..3.#M....#,%.Hs|
+000000e0  f5 1d a7 af 17 60 c8 0e  4e b7 d1 49 7d 6e e1 0a  |.....`..N..I}n..|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 80 6d 42 18  |........... .mB.|
-00000030  67 9d 57 53 06 26 91 f5  bc f0 64 11 2b 03 ec c6  |g.WS.&....d.+...|
-00000040  9e a7 4a 94 40 c7 8f b6  73 3c 7c 41 13 03 00 00  |..J.@...s<|A....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 51 69 17 c8  |........... Qi..|
+00000030  aa fa 20 4f 3b 3f 4f ac  5c 02 4c aa 7a 84 4d 46  |.. O;?O.\.L.z.MF|
+00000040  4b 60 11 f4 66 88 bd dd  76 41 dc 31 13 03 00 00  |K`..f...vA.1....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 60 18 7e 49 26 0a  |..........`.~I&.|
-00000090  6e f7 b8 03 c5 5a 60 4d  7b 10 a8 61 f2 83 52 d5  |n....Z`M{..a..R.|
-000000a0  5a 17 03 03 02 6d bb 23  f7 ba 82 cf a9 73 fa 74  |Z....m.#.....s.t|
-000000b0  da a7 91 bf 48 48 ec 8a  59 4d 1e 96 27 18 79 60  |....HH..YM..'.y`|
-000000c0  c7 03 0c 03 cc e9 96 4d  1b 07 66 9c dc e9 d7 0c  |.......M..f.....|
-000000d0  4f d0 92 07 8e 02 89 ec  77 1c df b5 b5 8d 5c 21  |O.......w.....\!|
-000000e0  c7 88 07 4f c4 87 06 c5  82 ff 2c 28 0e 4e d2 38  |...O......,(.N.8|
-000000f0  68 2b 42 6b 83 af 2a a7  f9 6d c6 aa f3 e7 82 35  |h+Bk..*..m.....5|
-00000100  5c 7f 36 73 e9 60 b7 01  6b 40 3d 20 b7 2d 8a b5  |\.6s.`..k@= .-..|
-00000110  62 5d 7c f3 cf 7f 2d 65  d8 40 01 2d aa c1 da 27  |b]|...-e.@.-...'|
-00000120  06 ff e3 cd f2 37 76 f3  82 65 49 94 37 04 d1 a0  |.....7v..eI.7...|
-00000130  c3 ae f5 5d 26 19 ea 6d  c1 bf a3 ef b6 7f d2 b2  |...]&..m........|
-00000140  69 77 d3 f1 1b 9b b5 bf  a1 2d 12 ec 8d bf ea 6b  |iw.......-.....k|
-00000150  45 7f f3 87 3c b7 70 02  1e b8 46 18 36 b9 7c cc  |E...<.p...F.6.|.|
-00000160  70 2e e2 3b 2a 8b c0 a4  7e ec 62 cb 6d 46 d9 60  |p..;*...~.b.mF.`|
-00000170  f8 90 a3 7c a7 56 06 90  9a 2b 7b 20 ce d8 1d 2b  |...|.V...+{ ...+|
-00000180  93 69 0b f4 5c c1 79 06  bf 28 0d c2 2e 60 7d aa  |.i..\.y..(...`}.|
-00000190  a6 68 78 fd bf f0 8a a2  b9 7f f0 0a 69 3c 46 ed  |.hx.........i<F.|
-000001a0  0d 49 6a 94 6d b2 fe ce  44 53 ae 45 9a 8c 19 62  |.Ij.m...DS.E...b|
-000001b0  6d cb 9a 4a b6 a3 56 f1  bf a0 ec bb 37 a9 78 6c  |m..J..V.....7.xl|
-000001c0  cb 3c b7 e3 e3 c5 a7 aa  cc 5f 1f f2 c4 5b d1 f0  |.<......._...[..|
-000001d0  77 c3 bb a6 60 2c d4 2d  ec 8f 44 64 72 49 fe 38  |w...`,.-..DdrI.8|
-000001e0  15 be 4b 5d 9e 16 a2 5a  05 b9 6d 35 e0 4a d3 1d  |..K]...Z..m5.J..|
-000001f0  25 1f ca ef c7 79 29 84  c9 37 c6 01 a8 fc 73 76  |%....y)..7....sv|
-00000200  53 73 24 ce 3c 4d 53 fc  d9 11 b6 ef 41 77 e6 28  |Ss$.<MS.....Aw.(|
-00000210  fa 17 f2 43 a6 9a f1 c4  10 67 4c 68 e7 d9 d8 97  |...C.....gLh....|
-00000220  22 b3 c6 0b b0 6a ce 05  18 2a 62 0f d6 99 15 d6  |"....j...*b.....|
-00000230  6b f9 89 61 06 a8 57 76  13 f3 d3 75 45 be e4 c0  |k..a..Wv...uE...|
-00000240  01 28 8c b6 b6 50 43 2e  54 71 61 47 fc a4 83 ca  |.(...PC.TqaG....|
-00000250  5b a3 b5 e2 bc f3 c3 94  ab 33 21 8c e0 a6 75 0e  |[........3!...u.|
-00000260  a3 5d e6 a5 6e ac 2d 63  eb b0 6a 75 7f 76 6f 05  |.]..n.-c..ju.vo.|
-00000270  79 b0 e3 d4 54 ed 45 0c  6d 75 98 28 1e a2 63 65  |y...T.E.mu.(..ce|
-00000280  54 79 c4 a5 e5 37 c2 34  58 62 59 40 b3 e3 15 4b  |Ty...7.4XbY@...K|
-00000290  44 23 c4 cd 44 a1 0d 8e  85 b2 c9 cd 12 fa 72 f6  |D#..D.........r.|
-000002a0  9a c8 ae 9e d0 d7 60 21  41 6b 19 a1 f2 d2 53 0a  |......`!Ak....S.|
-000002b0  7e 21 bf ad d3 6d 73 8a  e2 ce 45 c0 cd 12 14 cd  |~!...ms...E.....|
-000002c0  49 f8 e3 4e e7 43 39 59  41 5a eb ed 4f d6 47 16  |I..N.C9YAZ..O.G.|
-000002d0  17 15 35 26 5f c2 39 19  2c 81 59 85 d0 f9 8c 81  |..5&_.9.,.Y.....|
-000002e0  b8 f8 d8 5f 8b 51 5e f8  6b 72 34 60 e2 4b 04 10  |..._.Q^.kr4`.K..|
-000002f0  29 b7 f4 f6 36 4d 89 fc  2f 07 a2 10 47 ea 8e 22  |)...6M../...G.."|
-00000300  60 5f 50 19 bd c1 0d 52  c6 cb 43 79 c4 54 a8 85  |`_P....R..Cy.T..|
-00000310  49 0e 5b 17 03 03 00 99  67 ad a1 0b 84 de 72 8d  |I.[.....g.....r.|
-00000320  34 79 02 38 6a 72 ff 5d  95 6b 7c 57 0f 3c b2 fd  |4y.8jr.].k|W.<..|
-00000330  b8 de d0 0f 81 0d 8c 24  37 d5 ba cf 88 7c 98 38  |.......$7....|.8|
-00000340  b9 aa ab bd ca 81 2f 30  fa 1a a1 f3 ee ae fa 6e  |....../0.......n|
-00000350  b9 9f 0a 06 73 47 3a 66  e4 fd ac 72 1c 9e 12 63  |....sG:f...r...c|
-00000360  8a 58 36 7f 39 06 48 af  38 75 45 7d 83 22 e9 30  |.X6.9.H.8uE}.".0|
-00000370  7b 45 2c 17 6d b8 40 6a  90 b5 87 d0 5e 2e b3 43  |{E,.m.@j....^..C|
-00000380  ba 08 6b 2d 79 4d 83 1e  76 eb 23 09 e0 9d f9 c2  |..k-yM..v.#.....|
-00000390  d8 ac bb a1 7f 1e 09 22  b9 66 32 7a e5 4c 2c eb  |.......".f2z.L,.|
-000003a0  fa b6 51 e4 e9 4d a7 78  59 43 fd 0d af 86 9f 9b  |..Q..M.xYC......|
-000003b0  a3 17 03 03 00 35 0d 42  ed 73 34 a0 06 72 47 15  |.....5.B.s4..rG.|
-000003c0  ad 16 05 ee a3 98 88 dd  52 09 78 9d 99 c5 c2 b7  |........R.x.....|
-000003d0  39 90 0c f0 4a cb 9e da  0f 9a 31 29 af 86 7b 79  |9...J.....1)..{y|
-000003e0  c5 2f 35 21 85 51 8c 2e  29 f2 ea 17 03 03 00 87  |./5!.Q..).......|
-000003f0  e6 0a ee 9e a6 aa 7d c6  b8 3d 08 82 9e 1c 7f e2  |......}..=......|
-00000400  ed b1 58 85 75 d0 ae e6  af bf 54 98 2a 4d 64 ab  |..X.u.....T.*Md.|
-00000410  33 3b d1 32 17 94 db 29  22 5e 51 b0 3e 0f 48 fe  |3;.2...)"^Q.>.H.|
-00000420  fd 3e de b6 78 25 16 7a  a9 52 e3 b8 93 89 4b 50  |.>..x%.z.R....KP|
-00000430  d9 4a 0f af 60 34 48 2b  f4 27 2d 99 63 d8 33 a3  |.J..`4H+.'-.c.3.|
-00000440  1c 68 0b e1 e8 13 21 cd  37 58 7c 66 1f cf 35 5d  |.h....!.7X|f..5]|
-00000450  06 8a 66 2b dd 87 56 05  69 af 6f b6 59 01 a8 8c  |..f+..V.i.o.Y...|
-00000460  35 0b fd 35 98 64 97 42  33 d1 b8 0e ac 85 51 5d  |5..5.d.B3.....Q]|
-00000470  26 cb 1d 81 c7 8d 32                              |&.....2|
+00000080  03 03 00 01 01 17 03 03  00 17 9a 04 f3 14 2b 0b  |..............+.|
+00000090  55 2f e3 7a 17 52 0d 1f  40 f4 6d f3 d6 63 26 1c  |U/.z.R..@.m..c&.|
+000000a0  67 17 03 03 02 6d 34 32  24 d0 fd 2b 36 0a 15 87  |g....m42$..+6...|
+000000b0  10 c7 ed 13 b7 a2 dd 9a  35 1e 17 6a ba c6 df 1e  |........5..j....|
+000000c0  f8 93 e2 0e 31 5c 16 e6  04 00 0b 4e 56 2d d3 39  |....1\.....NV-.9|
+000000d0  36 4a 35 4f 9e fa 20 3b  83 a6 e4 fe 83 d3 7a 9b  |6J5O.. ;......z.|
+000000e0  7c a9 5a 47 4b 6b ec 6b  0f 63 11 56 49 a9 c4 1f  ||.ZGKk.k.c.VI...|
+000000f0  0b 70 ba 2e 3d 16 ff 4f  bb f2 ba 5c 6b b2 00 82  |.p..=..O...\k...|
+00000100  35 54 01 ba b5 12 e1 cc  cc 4a 4e de e8 8a fd ee  |5T.......JN.....|
+00000110  ac 89 b9 9d 82 e2 fe 6b  19 e5 05 15 54 6c 99 93  |.......k....Tl..|
+00000120  9f a8 47 41 9b 16 46 e2  0e 16 88 a0 51 8e ec 88  |..GA..F.....Q...|
+00000130  45 8d 42 53 e3 5f 6f 5d  f5 c3 e5 20 65 37 75 5a  |E.BS._o]... e7uZ|
+00000140  49 da 3e d9 a6 5c 79 13  1a e7 b2 83 89 6e 1b c3  |I.>..\y......n..|
+00000150  9d 50 dc 19 06 8a bb dc  a6 bd 05 41 1f 1f fe 95  |.P.........A....|
+00000160  8d b7 7b be 8b f1 0c 90  23 31 ed d7 9c 77 35 a8  |..{.....#1...w5.|
+00000170  b7 5f 3c be 23 86 69 92  a1 02 9c 44 bc eb 28 5a  |._<.#.i....D..(Z|
+00000180  99 55 c9 04 be 68 eb 8e  b8 2d 56 40 91 c0 87 e1  |.U...h...-V@....|
+00000190  0a ab 6a 99 22 42 f5 f9  a1 c8 fc 47 28 23 1e d7  |..j."B.....G(#..|
+000001a0  46 ad e8 63 a7 84 b8 f7  8a a6 24 e2 65 0c 40 db  |F..c......$.e.@.|
+000001b0  17 d3 f2 7f 97 09 2f af  50 77 0e ae c3 d5 c7 04  |....../.Pw......|
+000001c0  f1 fc b4 e0 13 75 c0 27  13 40 91 17 1e 76 3b 36  |.....u.'.@...v;6|
+000001d0  3c 58 a6 5c 9a b6 7d e8  9f ec 42 73 95 7b 52 9d  |<X.\..}...Bs.{R.|
+000001e0  6c 0d 79 f3 87 29 09 7c  27 e5 7b b0 5b aa a8 dc  |l.y..).|'.{.[...|
+000001f0  04 f7 32 52 bc 15 52 98  ad 2d b6 52 89 0d 76 92  |..2R..R..-.R..v.|
+00000200  16 0a 38 f3 02 0d 33 ac  e8 0d 9a 9a fe 97 26 01  |..8...3.......&.|
+00000210  f0 18 26 c9 31 e1 10 2c  7e c8 af 37 b2 fe 12 17  |..&.1..,~..7....|
+00000220  89 85 2e 75 38 a0 99 c3  2c b4 e0 5a 86 88 1d 63  |...u8...,..Z...c|
+00000230  4d 4f f6 b0 af bb 6d e8  d7 6f 97 74 0a e9 69 82  |MO....m..o.t..i.|
+00000240  c8 28 c8 1b ea 9c 19 ff  4d bc 4b 17 72 16 74 2d  |.(......M.K.r.t-|
+00000250  73 72 e8 a3 9d 76 db 23  79 06 dc a6 53 11 f4 0e  |sr...v.#y...S...|
+00000260  26 83 76 cf f5 61 cd d6  b5 9e c5 c7 c4 45 3b 3c  |&.v..a.......E;<|
+00000270  76 01 76 f5 0d 01 6e 6a  59 5d 85 c6 af 71 e2 cd  |v.v...njY]...q..|
+00000280  62 27 d7 97 a0 ae 51 3b  7e f7 b8 7f db 6f 0e 76  |b'....Q;~....o.v|
+00000290  f6 21 ae 35 fc f0 dd f4  9b 30 73 34 46 b1 f5 a6  |.!.5.....0s4F...|
+000002a0  42 95 cd f6 f5 a0 0a f7  46 8d d2 77 91 18 1a 2d  |B.......F..w...-|
+000002b0  fa 6d f4 fe bc 1e dd 2f  2f 1f 10 14 46 54 d1 ef  |.m.....//...FT..|
+000002c0  02 a4 3b 2e 63 e0 c4 ae  46 bd 66 55 06 1b b4 86  |..;.c...F.fU....|
+000002d0  92 0c fd e5 a2 2d 67 01  62 d9 a7 43 1b ec f4 b3  |.....-g.b..C....|
+000002e0  4c 15 94 25 6d 71 92 48  dd 93 1a bf 88 2e 16 32  |L..%mq.H.......2|
+000002f0  d3 e2 14 50 6a 95 c6 30  2c 4a ee 4f 48 6a c5 f1  |...Pj..0,J.OHj..|
+00000300  66 d3 07 05 f4 45 e0 f7  9d 56 a1 ff b6 f9 bd d5  |f....E...V......|
+00000310  b1 52 b2 17 03 03 00 99  10 0c 1c 36 9a 10 7b 82  |.R.........6..{.|
+00000320  cd 1f 2c 29 d8 53 8f 8a  5b 24 98 33 f6 d3 15 a4  |..,).S..[$.3....|
+00000330  6d a0 f2 39 be 24 8e f4  69 4c 34 8e 24 9a 38 ca  |m..9.$..iL4.$.8.|
+00000340  c5 77 63 94 2b ed 7e 82  16 07 e7 15 41 1e 1f 61  |.wc.+.~.....A..a|
+00000350  53 8f 30 a5 82 b8 10 4b  2e 48 39 0f 2e 90 c9 fe  |S.0....K.H9.....|
+00000360  31 e9 8c 38 41 d9 53 a2  29 05 ac ee cf 9e 2f ba  |1..8A.S.)...../.|
+00000370  aa 27 75 23 07 89 19 8b  84 4c 6b cc c6 be 26 40  |.'u#.....Lk...&@|
+00000380  ba b3 9c 08 bc db 2a 01  53 e3 c3 0f 4e db 83 cd  |......*.S...N...|
+00000390  e7 5a e1 22 2b fb 2d 6b  18 61 7c c2 67 e9 dc b7  |.Z."+.-k.a|.g...|
+000003a0  17 4a a3 82 4b 82 2e 37  f5 b9 19 f8 a2 ee 76 e7  |.J..K..7......v.|
+000003b0  f0 17 03 03 00 35 b5 34  8f c0 f3 ac 30 13 e1 fa  |.....5.4....0...|
+000003c0  4a 57 97 95 3d d1 58 41  d6 d3 b3 b9 4d 80 54 fc  |JW..=.XA....M.T.|
+000003d0  c2 41 78 9e 54 95 ba d5  2b 31 5a 81 d4 1b 45 7f  |.Ax.T...+1Z...E.|
+000003e0  bb 98 95 55 7f 26 b3 56  35 9c f9 17 03 03 00 88  |...U.&.V5.......|
+000003f0  65 7c 27 68 b0 ef 58 29  a9 dd 4b 78 b0 d4 63 94  |e|'h..X)..Kx..c.|
+00000400  6b a9 f2 5b e8 05 c3 f1  32 ba b0 02 6c 92 67 c4  |k..[....2...l.g.|
+00000410  77 14 23 11 95 d9 08 6d  f8 08 21 fa e7 3c 0f 67  |w.#....m..!..<.g|
+00000420  93 cf 88 4a d2 66 8d 95  f2 b6 c4 e0 61 26 23 08  |...J.f......a&#.|
+00000430  4a 31 4f 76 c2 30 04 4e  2c 72 96 64 25 db 53 47  |J1Ov.0.N,r.d%.SG|
+00000440  77 91 e8 29 52 2e 78 c2  f3 d1 95 3c c6 0e a4 45  |w..)R.x....<...E|
+00000450  da cc e4 eb a4 b9 e3 86  36 c9 23 23 f1 32 3e 6f  |........6.##.2>o|
+00000460  ea 56 ba b4 74 39 54 83  e7 ff 4c 95 44 a7 f1 da  |.V..t9T...L.D...|
+00000470  50 01 14 d1 1f e3 19 e0                           |P.......|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 b2 e1 64 9b 19  |..........5..d..|
-00000010  0e 81 eb 63 91 f0 ea 5a  a4 28 cd 78 62 32 2e 64  |...c...Z.(.xb2.d|
-00000020  b2 82 e8 5c d9 67 8a 14  41 83 c4 8c 4d f7 33 cc  |...\.g..A...M.3.|
-00000030  9b 0e 6d 2d cd 69 45 0f  51 11 29 23 2c c4 3c cc  |..m-.iE.Q.)#,.<.|
+00000000  14 03 03 00 01 01 17 03  03 00 35 9e ee 82 32 b6  |..........5...2.|
+00000010  33 aa 6e fd 8a ee 80 95  2e 9a d8 3b 58 7b e3 e2  |3.n........;X{..|
+00000020  c4 75 56 bc cf 9d 82 f7  e9 cf cf 54 ba 56 04 72  |.uV........T.V.r|
+00000030  ae 2f 1e fb 87 cc 0f 8c  0f 0d 0c 35 72 bd e6 15  |./.........5r...|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e de 26 6a  04 bf d7 1a 06 e6 94 35  |......&j.......5|
-00000010  dc 74 5a 0c ca 4c bb a2  e2 ba 7d 01 2e 87 c5 17  |.tZ..L....}.....|
-00000020  c2 e1 da 17 03 03 00 13  4b 04 5a ab 20 c7 22 2e  |........K.Z. .".|
-00000030  5d 89 57 b2 1d ea d2 1b  91 0d b9                 |].W........|
+00000000  17 03 03 00 1e ba 1d 68  50 30 17 ee 78 e6 d5 c7  |.......hP0..x...|
+00000010  db 67 3a ec fc c4 b2 df  7a cb 59 cd 62 97 3d f3  |.g:.....z.Y.b.=.|
+00000020  5b 8b bd 17 03 03 00 13  03 f2 6a 4d 77 af e4 21  |[.........jMw..!|
+00000030  38 b1 cc 45 b7 d3 3d 09  8d 31 fe                 |8..E..=..1.|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ALPN-NotConfigured b/src/crypto/tls/testdata/Server-TLSv13-ALPN-NotConfigured
index 55e62f69ef..b2c3338d41 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ALPN-NotConfigured
+++ b/src/crypto/tls/testdata/Server-TLSv13-ALPN-NotConfigured
@@ -1,9 +1,9 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 e2 01 00 00  de 03 03 f7 c1 b5 6c 3e  |..............l>|
-00000010  00 f7 90 29 26 19 9e 28  d7 d6 2f 4a 85 d6 c8 2a  |...)&..(../J...*|
-00000020  7b c8 2c 6b f1 34 5f c5  f7 5c 76 20 20 c2 9b c1  |{.,k.4_..\v  ...|
-00000030  b5 4b a5 ae 98 ba 6a db  21 eb 8e cf ea 9e 01 fd  |.K....j.!.......|
-00000040  48 b3 47 b1 eb 70 04 3c  0a f8 73 55 00 04 13 03  |H.G..p.<..sU....|
+00000000  16 03 01 00 e2 01 00 00  de 03 03 25 82 20 ff f8  |...........%. ..|
+00000010  c3 3a 6e f3 77 4a aa a8  ab ed a6 00 09 0a 9a 19  |.:n.wJ..........|
+00000020  48 63 7b 76 8a 70 60 03  bc 8e 9b 20 35 68 d4 0a  |Hc{v.p`.... 5h..|
+00000030  c3 70 f1 7c 6f 6b 33 ef  3a 73 7a a5 a3 83 a4 74  |.p.|ok3.:sz....t|
+00000040  4c 15 c7 88 c9 eb 14 75  de 03 c2 16 00 04 13 03  |L......u........|
 00000050  00 ff 01 00 00 91 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 10 00 10 00 0e  06 70 72 6f 74 6f 32 06  |.........proto2.|
@@ -11,89 +11,89 @@
 00000090  00 1e 00 1c 04 03 05 03  06 03 08 07 08 08 08 09  |................|
 000000a0  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
 000000b0  00 2b 00 03 02 03 04 00  2d 00 02 01 01 00 33 00  |.+......-.....3.|
-000000c0  26 00 24 00 1d 00 20 50  65 db 00 14 47 27 81 9a  |&.$... Pe...G'..|
-000000d0  e5 5a 7c eb 89 1f 29 af  39 e6 4b 23 a7 10 3a 83  |.Z|...).9.K#..:.|
-000000e0  b2 8e f3 ff a8 5a 63                              |.....Zc|
+000000c0  26 00 24 00 1d 00 20 a2  59 33 22 44 fa 24 92 3b  |&.$... .Y3"D.$.;|
+000000d0  29 9e 66 e8 e4 0e e3 df  46 47 88 0a ef 8b e2 25  |).f.....FG.....%|
+000000e0  57 59 17 7a 95 32 6c                              |WY.z.2l|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 20 c2 9b c1  |...........  ...|
-00000030  b5 4b a5 ae 98 ba 6a db  21 eb 8e cf ea 9e 01 fd  |.K....j.!.......|
-00000040  48 b3 47 b1 eb 70 04 3c  0a f8 73 55 13 03 00 00  |H.G..p.<..sU....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 35 68 d4 0a  |........... 5h..|
+00000030  c3 70 f1 7c 6f 6b 33 ef  3a 73 7a a5 a3 83 a4 74  |.p.|ok3.:sz....t|
+00000040  4c 15 c7 88 c9 eb 14 75  de 03 c2 16 13 03 00 00  |L......u........|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 d0 b0 cf 60 6a bb  |.............`j.|
-00000090  18 72 9f fa fa f7 2a 04  7e be a2 ce 21 38 42 42  |.r....*.~...!8BB|
-000000a0  2a 17 03 03 02 6d 87 5c  50 7e ed 23 18 aa 4d 59  |*....m.\P~.#..MY|
-000000b0  32 c8 d0 64 89 7f ca 53  08 bb 68 3c 7b 7e 74 5a  |2..d...S..h<{~tZ|
-000000c0  87 f9 d1 aa 7b 85 a4 2b  2d 76 39 65 e7 5e ec d5  |....{..+-v9e.^..|
-000000d0  35 1a 3d 35 33 bd 78 ff  16 e9 e1 72 a6 35 a0 2a  |5.=53.x....r.5.*|
-000000e0  11 b0 42 57 bb a2 3e 1e  c7 87 56 43 08 f0 78 19  |..BW..>...VC..x.|
-000000f0  bd 9c d8 a6 3e 65 81 b4  64 0f 55 e1 1e 64 dc a5  |....>e..d.U..d..|
-00000100  f3 da 15 e2 b3 90 a5 5c  a1 71 ba ec 57 05 ae 70  |.......\.q..W..p|
-00000110  78 2e 10 68 86 0f c4 97  16 0b 8d b1 5d 05 59 ca  |x..h........].Y.|
-00000120  5f 55 ff 2d 89 d3 27 17  06 7f 4a 31 92 cb 34 ac  |_U.-..'...J1..4.|
-00000130  49 fd b3 21 a8 27 3e 21  bd e4 82 f8 26 57 e6 64  |I..!.'>!....&W.d|
-00000140  26 87 87 16 f6 80 78 02  05 92 e1 d4 d7 12 92 ed  |&.....x.........|
-00000150  69 54 bb 35 e2 73 d0 20  9f b1 80 a6 4e 8f 78 ec  |iT.5.s. ....N.x.|
-00000160  94 d7 c4 76 1c 33 e0 7d  92 e8 ed 80 cb 27 7f 2c  |...v.3.}.....'.,|
-00000170  c0 9e 21 f2 26 cc 39 9a  e2 cd 9e 9b 3d 4d 66 2d  |..!.&.9.....=Mf-|
-00000180  ca ab 1f 70 83 4c b6 8b  d1 6f 2c 19 35 55 78 90  |...p.L...o,.5Ux.|
-00000190  7b 01 49 f4 81 d1 02 9f  8d 0b bf 2e ae c6 15 93  |{.I.............|
-000001a0  f4 cc ee d7 9f 61 74 e9  93 e8 dc 9e 38 45 61 40  |.....at.....8Ea@|
-000001b0  b5 7a e7 e2 b4 bf 8b 01  41 05 a7 b8 f1 cb 33 b3  |.z......A.....3.|
-000001c0  c8 f4 8b 99 5c 84 1e a3  e3 06 9a fc de 1a 37 54  |....\.........7T|
-000001d0  9c 4a 58 b0 c6 83 8e 40  80 ee b5 07 74 3c 50 35  |.JX....@....t<P5|
-000001e0  5b a3 61 8b 34 91 9d 2f  b2 b2 44 9f b3 5a 82 ca  |[.a.4../..D..Z..|
-000001f0  07 e6 14 15 c8 40 8c b8  c9 ac 97 52 73 6f d8 d2  |.....@.....Rso..|
-00000200  c4 45 ac 52 a3 fd f5 4f  91 10 8d d6 84 96 81 c1  |.E.R...O........|
-00000210  fc 8f da b0 69 ec ad ca  ba 1a 8d 09 d0 2a 19 14  |....i........*..|
-00000220  88 9e c2 17 24 a6 c2 48  0c bd ec da 01 f1 e1 e9  |....$..H........|
-00000230  40 6a 21 0c aa 00 5a 2e  b5 b7 a4 a3 42 cf 73 82  |@j!...Z.....B.s.|
-00000240  cf 78 fb f6 0b 95 e0 ad  9d 83 2c bb 88 f8 7e 57  |.x........,...~W|
-00000250  95 99 43 c4 3f de e9 69  c3 45 b1 0c 19 df bb 7d  |..C.?..i.E.....}|
-00000260  b4 86 12 2c 60 d5 76 3f  b2 80 8e 6e d2 fa b0 11  |...,`.v?...n....|
-00000270  de 77 7d b7 99 37 eb 74  99 84 31 7f 9e d0 1a 94  |.w}..7.t..1.....|
-00000280  aa c8 83 49 a1 80 06 16  e7 a7 c2 9a eb 1a b6 18  |...I............|
-00000290  0e ec 28 aa 71 a5 11 84  d2 2e 76 8b 38 33 1f 4e  |..(.q.....v.83.N|
-000002a0  8a 03 fb d8 37 a7 b0 09  32 cd 7f 9e 91 d1 25 05  |....7...2.....%.|
-000002b0  63 b5 da d0 68 7e 4c 03  c0 15 c3 74 d1 ba 25 0e  |c...h~L....t..%.|
-000002c0  03 ea 75 04 e9 67 a4 05  a8 db 01 97 2e 3f 36 c8  |..u..g.......?6.|
-000002d0  55 32 aa b4 0e 4a a0 d3  94 c9 a4 62 3d 35 e3 38  |U2...J.....b=5.8|
-000002e0  47 88 10 95 56 ed 93 0d  3a 7e 18 e2 31 7c e2 39  |G...V...:~..1|.9|
-000002f0  ec c3 f7 b5 a5 44 a0 5f  6f dc 6b 4a 55 8e ab b2  |.....D._o.kJU...|
-00000300  a3 25 45 9a 19 ed 7c 7c  da c6 ab 90 55 19 34 9c  |.%E...||....U.4.|
-00000310  af 22 48 17 03 03 00 99  53 3d cf 89 5b 20 fd 91  |."H.....S=..[ ..|
-00000320  16 54 2c 6d c5 ae d3 aa  d2 d3 c6 96 14 43 4f f2  |.T,m.........CO.|
-00000330  4e e5 2e aa f1 6e 58 ba  62 b6 d9 da 21 e7 02 ac  |N....nX.b...!...|
-00000340  9f 45 d4 a9 37 e5 5c 81  26 76 56 0b 53 b3 3e bd  |.E..7.\.&vV.S.>.|
-00000350  cf 2b 05 5d 23 d8 65 16  b3 88 0b db f0 54 15 73  |.+.]#.e......T.s|
-00000360  3f cc 8b fd 3b 46 23 29  7a 99 10 b2 62 02 ac 0b  |?...;F#)z...b...|
-00000370  ef 01 46 94 b9 09 4b af  c3 3e f9 5e bb 28 7e 3b  |..F...K..>.^.(~;|
-00000380  83 7f e9 fd 51 56 e2 a5  83 8d e4 1a 0e 85 7e b9  |....QV........~.|
-00000390  56 1c 0b dd 7a ce 7d d8  c7 8d f0 d0 66 d4 84 ea  |V...z.}.....f...|
-000003a0  54 1b 4b 08 bb e8 28 9f  b7 d2 f3 e4 b7 72 47 14  |T.K...(......rG.|
-000003b0  cb 17 03 03 00 35 30 f8  65 a3 16 fd 3a b5 17 7c  |.....50.e...:..||
-000003c0  c1 a2 00 5d b9 e4 13 0d  2c 91 29 c9 11 8d 5a 70  |...]....,.)...Zp|
-000003d0  3e 74 81 e0 00 68 a0 23  c0 d5 98 ce 51 b7 22 f4  |>t...h.#....Q.".|
-000003e0  8c 62 50 0a 67 d5 fb 33  10 8c ef 17 03 03 00 87  |.bP.g..3........|
-000003f0  34 00 8b e7 16 aa 15 e3  c8 0b ce 84 f1 45 f1 73  |4............E.s|
-00000400  24 46 6c ac 9a f9 0c 19  28 6f da 3b bf 68 6a 8e  |$Fl.....(o.;.hj.|
-00000410  a1 0e 40 6a c5 3c 8f 03  41 bb c0 70 c7 a3 6c 41  |..@j.<..A..p..lA|
-00000420  b8 fc 55 97 ba 19 c7 74  92 70 05 ac b7 fe a8 52  |..U....t.p.....R|
-00000430  db 4b 05 7b 83 63 12 18  36 27 6d 15 ec e2 59 54  |.K.{.c..6'm...YT|
-00000440  16 bf ee e0 4f 2c de 00  c7 e0 4c 27 1e d5 64 21  |....O,....L'..d!|
-00000450  84 31 b5 62 40 44 47 01  d7 8b 01 9c 4d 5e 73 9c  |.1.b@DG.....M^s.|
-00000460  fa 26 5b 46 63 60 a1 ad  62 ce 53 a4 eb c6 a4 8c  |.&[Fc`..b.S.....|
-00000470  0e ad 5c 1f 4a ce 95                              |..\.J..|
+00000080  03 03 00 01 01 17 03 03  00 17 da bf 18 fa 13 6c  |...............l|
+00000090  8f 4b a6 cf 15 d1 07 47  06 01 84 db 5b b2 26 8e  |.K.....G....[.&.|
+000000a0  73 17 03 03 02 6d 4f 75  d0 fe 56 7b c2 70 6b 89  |s....mOu..V{.pk.|
+000000b0  da a0 13 2d 52 d1 43 06  10 20 b1 5d 2b da 84 c3  |...-R.C.. .]+...|
+000000c0  81 38 e9 98 2f 60 95 83  a9 b1 00 ec 64 85 85 e2  |.8../`......d...|
+000000d0  8e d8 9c 6d 34 c8 db 9e  c7 75 76 be bc e6 83 ec  |...m4....uv.....|
+000000e0  26 15 24 a3 74 5b 1b 91  e5 83 74 2f 7f 63 86 1d  |&.$.t[....t/.c..|
+000000f0  7d ed a0 2f f8 26 37 c6  0f b6 50 25 de d7 33 76  |}../.&7...P%..3v|
+00000100  3b 7c 0f 5d 51 9f b7 8a  bc db 76 cc 01 4d 17 85  |;|.]Q.....v..M..|
+00000110  de 02 35 73 55 81 e7 8c  c5 0f 83 0e 06 44 aa 48  |..5sU........D.H|
+00000120  4d b7 39 d5 34 b2 b4 86  71 2e 23 ec 6c 76 28 3b  |M.9.4...q.#.lv(;|
+00000130  cd 4d 10 ba 51 d6 ee 0e  3e 82 ca c9 84 7c d2 8b  |.M..Q...>....|..|
+00000140  de 0f a3 84 e9 23 bd 6a  61 82 27 e6 55 3f c0 e5  |.....#.ja.'.U?..|
+00000150  d3 bc 41 43 52 c1 d4 62  4f 79 0a b4 8c 55 bc 1e  |..ACR..bOy...U..|
+00000160  65 05 fa de 01 f9 b8 38  c5 f7 e7 8b f6 72 58 43  |e......8.....rXC|
+00000170  af 67 c3 18 a7 3f 37 1a  02 83 81 bb d7 ed 0e 8d  |.g...?7.........|
+00000180  0d 51 50 f3 33 aa e6 f2  87 df e9 bf 11 9b 60 74  |.QP.3.........`t|
+00000190  19 34 7a 74 81 7c 5c 46  1e 58 ea bb 89 ac 8f c4  |.4zt.|\F.X......|
+000001a0  72 90 2f 0c e5 a1 32 35  f5 17 f4 28 f9 da e5 fb  |r./...25...(....|
+000001b0  02 21 db f8 ba 83 95 2c  76 e3 d7 74 d7 8f 03 92  |.!.....,v..t....|
+000001c0  ed 8a 36 68 a5 5a 04 44  31 15 6a 54 21 85 c3 4c  |..6h.Z.D1.jT!..L|
+000001d0  c4 f7 af fc 03 93 c3 18  fd 20 31 a3 ca 83 17 6a  |......... 1....j|
+000001e0  bf 9b 03 fa 99 b6 8a 6e  eb ba d8 8e 28 c7 ef 60  |.......n....(..`|
+000001f0  00 4f d6 18 73 23 f8 e9  7d 9a f1 8f 53 e9 9a c4  |.O..s#..}...S...|
+00000200  0d 7f cf f0 ae 14 a0 35  91 38 3e a4 8a 21 67 d9  |.......5.8>..!g.|
+00000210  99 17 c7 4a da 52 7d 1e  d1 32 61 98 c3 af 18 27  |...J.R}..2a....'|
+00000220  6d 65 6c 76 5d 63 10 83  69 ae 55 63 c8 09 78 ba  |melv]c..i.Uc..x.|
+00000230  d9 98 52 54 d4 69 30 98  ad 87 3f 56 ac 54 9a 50  |..RT.i0...?V.T.P|
+00000240  00 51 06 6f 48 25 f2 38  00 aa 26 46 ab 3f df 24  |.Q.oH%.8..&F.?.$|
+00000250  e4 89 23 54 8f df 2a 80  66 bf 1f 94 2e 38 c2 a2  |..#T..*.f....8..|
+00000260  f5 cf 2a 81 bf f2 46 52  5b 62 aa 8c d1 98 45 ee  |..*...FR[b....E.|
+00000270  e6 37 6b 54 8e d2 2e a0  0c bf c8 ac 6a d7 ed 47  |.7kT........j..G|
+00000280  64 49 46 f3 c7 ea 61 ea  61 c5 e1 17 2b 9e 75 81  |dIF...a.a...+.u.|
+00000290  93 88 1d 02 d9 2c 46 74  09 f6 45 b5 f0 44 87 0a  |.....,Ft..E..D..|
+000002a0  4d 4a e4 2c b1 2c 0b 81  9e f9 2f 17 f5 15 0a da  |MJ.,.,..../.....|
+000002b0  37 d3 d7 04 8e 16 c9 68  84 ac 8d 9e d1 a9 05 33  |7......h.......3|
+000002c0  92 9a 2e ad 3b 84 8a 58  53 6d af e1 64 f0 ae 8b  |....;..XSm..d...|
+000002d0  80 db 8f 8b ed 62 ec 56  d9 dd 9a 9c 5a 89 82 5e  |.....b.V....Z..^|
+000002e0  91 fa 5a c5 8b 85 12 66  91 95 10 b5 d9 c3 c5 34  |..Z....f.......4|
+000002f0  33 5e eb e0 bb 71 9b a0  29 16 02 9b b1 97 3b b8  |3^...q..).....;.|
+00000300  2a 4c 85 03 01 cf e2 bb  11 9d 81 12 fc 4f 0b 66  |*L...........O.f|
+00000310  0e 94 48 17 03 03 00 99  48 2d b4 0a 11 ee a8 39  |..H.....H-.....9|
+00000320  ec 1f 26 c3 68 57 f8 f1  f0 79 e2 3e 1e 3b 23 70  |..&.hW...y.>.;#p|
+00000330  7f ea 9d 8d 6e 94 b7 fb  66 ac 6a e9 20 b0 3c 9f  |....n...f.j. .<.|
+00000340  fd a7 01 df 24 f6 0d ed  33 11 79 bd 1c c1 d9 2c  |....$...3.y....,|
+00000350  9b 35 d2 ef 50 3a 0b e3  ce f0 0a de ab 9e a3 45  |.5..P:.........E|
+00000360  5c 1a 4b 90 0d 7d 79 47  38 e6 f9 ef d0 be f3 75  |\.K..}yG8......u|
+00000370  b7 b2 49 83 34 e7 96 06  a9 dc 99 19 eb 26 70 59  |..I.4........&pY|
+00000380  ae 37 e5 c6 b9 6e d1 e8  82 60 2a 35 54 38 7f b7  |.7...n...`*5T8..|
+00000390  fa 48 e5 1f 49 50 b6 22  65 37 22 99 c1 24 66 84  |.H..IP."e7"..$f.|
+000003a0  f7 1d 58 7a 46 fa a0 e7  1f 98 91 80 d0 c7 a1 43  |..XzF..........C|
+000003b0  54 17 03 03 00 35 18 80  7d e1 3b bb d4 bb 46 81  |T....5..}.;...F.|
+000003c0  07 a0 49 84 41 ca 31 03  94 3d b7 94 d6 54 dc 19  |..I.A.1..=...T..|
+000003d0  0d 9c 9e 26 96 3c a7 76  d6 5e aa 34 57 f8 6e ab  |...&.<.v.^.4W.n.|
+000003e0  a9 11 0e 02 d3 9d 42 08  2d 0e 81 17 03 03 00 88  |......B.-.......|
+000003f0  f6 80 4e df 79 1b 83 a7  07 fa 39 7f 91 b7 c2 a9  |..N.y.....9.....|
+00000400  7a 92 fd 59 68 57 05 d4  03 fa 5a f1 38 7b 4a 84  |z..YhW....Z.8{J.|
+00000410  97 38 91 97 e6 c9 d9 68  34 b8 af 9c a1 fd 0b 0f  |.8.....h4.......|
+00000420  c9 15 b2 5e d1 f7 c4 d1  36 00 b9 68 7d 79 9e b8  |...^....6..h}y..|
+00000430  2b 16 a2 4f 89 50 80 dd  f1 b7 4a 08 22 b9 9b 18  |+..O.P....J."...|
+00000440  c6 83 cc f9 e4 4b b5 6a  91 b6 42 bb 19 84 d5 7f  |.....K.j..B.....|
+00000450  f6 16 5a 19 2f c3 f6 05  63 3a 9f 6d d7 4c 7d ea  |..Z./...c:.m.L}.|
+00000460  dc d7 78 11 ff 60 fe 5b  ba fa f0 e6 31 36 ee b1  |..x..`.[....16..|
+00000470  2a ec 8c a6 02 96 4f 8f                           |*.....O.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 d4 53 b7 a1 18  |..........5.S...|
-00000010  c5 00 cf c8 d3 56 ca 87  9b c7 56 7b b8 e0 64 c7  |.....V....V{..d.|
-00000020  73 3b de d6 e1 8a 87 b3  ab 6e 8c f7 ec 11 c3 b9  |s;.......n......|
-00000030  6a 76 d0 f0 cf e3 b9 e2  05 e3 7b e8 9c 12 86 c6  |jv........{.....|
+00000000  14 03 03 00 01 01 17 03  03 00 35 df 64 d5 0f 22  |..........5.d.."|
+00000010  97 19 ed b0 9d 8e 38 3d  6c be b7 71 6f 33 0b 24  |......8=l..qo3.$|
+00000020  3b 72 8c c9 92 4a 99 37  7e cb 58 7a 5a e4 e4 dc  |;r...J.7~.XzZ...|
+00000030  c9 f4 08 a4 39 11 2c f3  d8 39 4c 96 09 20 c9 b7  |....9.,..9L.. ..|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 8c 41 16  ea ee 93 ac e4 81 4f 7d  |......A.......O}|
-00000010  ec 0f f6 c5 20 0b f4 20  43 fd a6 2b 96 ad c8 b1  |.... .. C..+....|
-00000020  88 31 72 17 03 03 00 13  d7 74 49 62 e8 91 a8 b1  |.1r......tIb....|
-00000030  97 47 20 8f 18 53 3e 6c  42 f5 48                 |.G ..S>lB.H|
+00000000  17 03 03 00 1e c5 ed 41  e3 7e b0 e7 70 6a b4 4b  |.......A.~..pj.K|
+00000010  db 56 2e d5 ba d8 28 2d  30 ae 54 b9 bf 74 23 4b  |.V....(-0.T..t#K|
+00000020  3d 0c ea 17 03 03 00 13  99 a3 f5 14 f0 3e 88 b4  |=............>..|
+00000030  a5 d5 c6 04 2e 68 af 9a  32 ae 3b                 |.....h..2.;|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-CHACHA20-SHA256 b/src/crypto/tls/testdata/Server-TLSv13-CHACHA20-SHA256
index 5b48ecbbb4..c9755fa9e4 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-CHACHA20-SHA256
+++ b/src/crypto/tls/testdata/Server-TLSv13-CHACHA20-SHA256
@@ -1,97 +1,97 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 b8 16 74 4b c0  |.............tK.|
-00000010  6a c7 0c aa 46 54 67 2c  85 24 bf a9 ae 0e ed 87  |j...FTg,.$......|
-00000020  04 3a 0a e1 ad 01 f6 5f  3b 0e f9 20 d9 4d 7e 08  |.:....._;.. .M~.|
-00000030  39 73 54 49 6a dc 4f 2f  b8 18 8f d5 7e d3 09 7e  |9sTIj.O/....~..~|
-00000040  4e 62 71 c8 00 06 2c 78  f0 ad 3a 67 00 04 13 03  |Nbq...,x..:g....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 73 54 07 a7 6e  |...........sT..n|
+00000010  ca 21 55 2a 76 fa 0f c2  67 e7 6d ad d8 e6 99 19  |.!U*v...g.m.....|
+00000020  7e 43 b8 b0 ee b1 4e 95  de 85 f1 20 c3 dc a3 62  |~C....N.... ...b|
+00000030  8d c5 4f 86 9d f1 1c 8b  48 a8 fc 9f 05 ad c7 80  |..O.....H.......|
+00000040  9b 50 3f 94 e0 bc e9 3b  e4 8d 7c 25 00 04 13 03  |.P?....;..|%....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 51  |-.....3.&.$... Q|
-000000b0  36 47 08 eb b9 87 4e da  f8 20 ab e7 ff 54 d4 d8  |6G....N.. ...T..|
-000000c0  be a9 9d 54 d5 09 82 12  94 be d8 59 37 e5 65     |...T.......Y7.e|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 e8  |-.....3.&.$... .|
+000000b0  67 84 61 29 1f 9e 3f b0  a1 bf 63 41 b5 f8 84 54  |g.a)..?...cA...T|
+000000c0  f0 30 31 17 8d 80 73 0b  d0 d4 a6 31 ca ce 38     |.01...s....1..8|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 d9 4d 7e 08  |........... .M~.|
-00000030  39 73 54 49 6a dc 4f 2f  b8 18 8f d5 7e d3 09 7e  |9sTIj.O/....~..~|
-00000040  4e 62 71 c8 00 06 2c 78  f0 ad 3a 67 13 03 00 00  |Nbq...,x..:g....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 c3 dc a3 62  |........... ...b|
+00000030  8d c5 4f 86 9d f1 1c 8b  48 a8 fc 9f 05 ad c7 80  |..O.....H.......|
+00000040  9b 50 3f 94 e0 bc e9 3b  e4 8d 7c 25 13 03 00 00  |.P?....;..|%....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 d1 78 60 c7 92 ce  |...........x`...|
-00000090  f7 40 3f a2 00 50 01 08  29 f0 ae 48 f6 7d 18 01  |.@?..P..)..H.}..|
-000000a0  32 17 03 03 02 6d bf b8  82 e1 3a b7 70 aa 92 ec  |2....m....:.p...|
-000000b0  9a 11 03 ed 4c e5 58 9f  28 33 ce ac c1 ae da 15  |....L.X.(3......|
-000000c0  b7 7f c9 ba 95 38 51 78  04 7f 6b d4 d7 0a 58 8f  |.....8Qx..k...X.|
-000000d0  cf 84 50 01 4b 61 bb b3  a3 98 10 09 4c 3b f9 a8  |..P.Ka......L;..|
-000000e0  44 77 19 01 96 e1 da 26  4e 27 a2 4f 07 69 f0 68  |Dw.....&N'.O.i.h|
-000000f0  ec 45 a3 7f 37 67 0b 65  0f 0b 15 21 b3 36 04 36  |.E..7g.e...!.6.6|
-00000100  eb cb 25 90 a2 64 19 fb  c8 0f de af 91 4b 87 13  |..%..d.......K..|
-00000110  3c d8 9d 38 d6 9c e3 e7  81 96 3b f4 b3 ec 88 fd  |<..8......;.....|
-00000120  30 4a 01 c5 b3 bc 30 08  2a 90 e5 92 4e d5 e2 4d  |0J....0.*...N..M|
-00000130  3f 2e 4f c8 4c d7 19 fb  43 83 7a c2 2d 37 37 8a  |?.O.L...C.z.-77.|
-00000140  e2 51 aa 44 fe 7e 2b bd  f2 96 f4 22 84 20 cc 20  |.Q.D.~+....". . |
-00000150  ab db 58 c5 ae 85 16 41  93 4e 6a 27 3f dc fc 05  |..X....A.Nj'?...|
-00000160  a3 73 d5 bb 7c 80 1f 8f  f8 67 36 e6 88 12 bc 92  |.s..|....g6.....|
-00000170  3c d4 b1 88 db ea cd 8f  4c 12 b1 76 ce 44 8a 6b  |<.......L..v.D.k|
-00000180  5f 21 9c b4 f1 0e 97 a8  9c 98 ac e5 d4 b8 76 00  |_!............v.|
-00000190  63 96 1a 38 92 3f d8 d9  63 40 e3 db ba 01 1d eb  |c..8.?..c@......|
-000001a0  8e 1c 7d e6 5b 4a b8 83  48 a3 f0 df 95 d9 aa 44  |..}.[J..H......D|
-000001b0  c1 28 cc 40 51 c1 2a 7a  09 f9 08 d6 e0 26 db 92  |.(.@Q.*z.....&..|
-000001c0  1a 82 83 be 10 32 e7 bf  31 db eb 69 99 ed 9e 92  |.....2..1..i....|
-000001d0  eb 16 60 d4 07 00 70 43  3c f7 b2 1b d9 b9 54 75  |..`...pC<.....Tu|
-000001e0  99 37 bc c0 54 d8 72 42  09 63 5f 44 06 9b de 23  |.7..T.rB.c_D...#|
-000001f0  d0 f0 db 2e 91 df 29 ee  74 f3 eb 5f e5 d1 1a 25  |......).t.._...%|
-00000200  9d 66 5f 5e 82 53 ab d3  b2 2a 8b 0a 7e d6 c9 c0  |.f_^.S...*..~...|
-00000210  0b 3d c1 9c 4f 49 34 24  6b 49 ed 63 5e 05 c8 b2  |.=..OI4$kI.c^...|
-00000220  65 16 b8 3a 99 3b c6 a7  b9 2c e9 49 67 fc 0d 8a  |e..:.;...,.Ig...|
-00000230  ac 4d d8 b3 c6 c4 9f 21  11 8e 40 64 b5 b0 d9 0e  |.M.....!..@d....|
-00000240  46 af 8e ae 4e 62 ff 7f  b8 4c 0b 1c 27 b6 27 45  |F...Nb...L..'.'E|
-00000250  dc 0e 8d 9b 6d 2a 10 b2  aa dd 01 4e d5 c5 a5 6a  |....m*.....N...j|
-00000260  b0 10 5b c0 a7 d4 8f d8  cb e1 6f 1f e4 f4 97 70  |..[.......o....p|
-00000270  13 b5 7d 34 e2 46 db f8  d0 ed 82 91 fa 53 0d e6  |..}4.F.......S..|
-00000280  21 fe 5b 8e 2f 19 9c c8  ed 6f c3 11 ee ed fc eb  |!.[./....o......|
-00000290  23 1c 2a 04 f6 65 dd 07  db e3 7b 91 fb 67 cb f2  |#.*..e....{..g..|
-000002a0  7b 67 4b e7 c0 91 cb 9c  7e b8 c8 d3 69 74 48 f0  |{gK.....~...itH.|
-000002b0  8b 3e f0 79 7f b3 fc 2e  06 ee 07 ca cf 9d 06 8d  |.>.y............|
-000002c0  62 07 33 51 3b 80 8d 47  a2 53 7c 6b 18 80 5c 30  |b.3Q;..G.S|k..\0|
-000002d0  2a 7b 32 ae de 53 c8 c8  04 95 c2 46 0c 88 c0 69  |*{2..S.....F...i|
-000002e0  0c e2 40 38 1d db a8 06  9e fb 8b 28 82 c4 46 7f  |..@8.......(..F.|
-000002f0  4d af 99 04 fc 7b 74 4f  14 7f 3b bd 66 0a 93 c6  |M....{tO..;.f...|
-00000300  e6 e0 31 ee d6 b2 06 50  23 21 cd 7f 85 10 df e1  |..1....P#!......|
-00000310  e2 dd 9e 17 03 03 00 99  8d 3f 93 fd e4 a1 07 76  |.........?.....v|
-00000320  fb fd b1 10 a1 9b d1 2c  e0 f1 44 35 42 2a 4a 4a  |.......,..D5B*JJ|
-00000330  3a 4e 14 bc 9f 8e d0 f9  7b 67 ef 2b 16 3e fd d7  |:N......{g.+.>..|
-00000340  19 98 2e 95 38 a7 21 61  1f 02 9d 12 23 04 ed b0  |....8.!a....#...|
-00000350  7c 50 d0 f3 41 7e 61 24  55 b1 53 fb 11 7e e2 86  ||P..A~a$U.S..~..|
-00000360  9d 00 6e 73 70 d0 e4 54  90 48 ef 77 8a e0 15 7b  |..nsp..T.H.w...{|
-00000370  cf 00 8e 83 29 ee 99 c5  5a 83 54 14 9e 3b 68 7b  |....)...Z.T..;h{|
-00000380  e5 0a 55 f7 d9 24 5e 70  11 26 41 82 fc 63 52 e9  |..U..$^p.&A..cR.|
-00000390  17 48 87 6c 35 42 c5 b4  92 b3 c9 b4 fe 7d 47 ac  |.H.l5B.......}G.|
-000003a0  4f 55 82 6a 14 e2 5a e1  98 cb 31 59 04 b6 cf 4e  |OU.j..Z...1Y...N|
-000003b0  62 17 03 03 00 35 63 58  16 de 31 44 14 25 7d 16  |b....5cX..1D.%}.|
-000003c0  f0 52 f8 ee 73 b4 e4 5c  a4 dd b0 f3 a8 f9 cf 39  |.R..s..\.......9|
-000003d0  87 2b 4d 60 c9 a0 f0 e4  69 37 a1 b5 52 fe 39 e4  |.+M`....i7..R.9.|
-000003e0  e9 82 d5 93 4a 2a df 05  af 33 56 17 03 03 00 87  |....J*...3V.....|
-000003f0  81 c8 b7 c7 09 16 97 f1  d1 e8 95 eb 05 d6 19 a4  |................|
-00000400  b7 ed de 7d 0c 75 eb f0  55 dc 2c 31 23 8e 11 28  |...}.u..U.,1#..(|
-00000410  98 db 37 d1 88 9f 70 17  e2 c4 ca 53 61 ee 8d b5  |..7...p....Sa...|
-00000420  48 90 00 9a 36 85 2f 2e  12 1b 9b ee 0f 47 20 dc  |H...6./......G .|
-00000430  79 34 e0 8d 04 e9 57 36  ed e4 e6 b4 b5 a2 19 4d  |y4....W6.......M|
-00000440  84 1e e2 07 4a 0f 76 5a  c6 00 f9 1d 39 9c df 43  |....J.vZ....9..C|
-00000450  42 37 40 48 e6 60 d7 d0  8a 8d c5 c1 7d 52 18 59  |B7@H.`......}R.Y|
-00000460  9c 3a d8 55 11 cc cc 07  a5 8f ef 70 e1 91 7d 2d  |.:.U.......p..}-|
-00000470  47 91 a3 07 f7 25 6a                              |G....%j|
+00000080  03 03 00 01 01 17 03 03  00 17 99 76 19 3a 3f f9  |...........v.:?.|
+00000090  17 94 e5 6a c6 e1 1a 43  d5 dc fc 15 53 51 97 b9  |...j...C....SQ..|
+000000a0  87 17 03 03 02 6d a7 84  13 6e e0 5a 45 1d 0c 31  |.....m...n.ZE..1|
+000000b0  b8 62 cc 7e 6f 89 5d 37  3f b0 79 3f 59 53 c9 ab  |.b.~o.]7?.y?YS..|
+000000c0  0b 5e 3d ed 4a e0 8e 21  cd b3 e0 10 f9 a5 1c 73  |.^=.J..!.......s|
+000000d0  a2 d7 78 43 1a 34 c4 76  8a ca f9 cb 57 fc e7 5a  |..xC.4.v....W..Z|
+000000e0  84 f4 51 18 50 73 a3 10  57 a0 1f 73 e2 9c f6 a6  |..Q.Ps..W..s....|
+000000f0  01 93 bf e2 37 69 54 1f  bf 9b 18 09 56 8b 6c dd  |....7iT.....V.l.|
+00000100  ca 7f 88 b1 83 07 34 a1  31 64 ca 09 fa 60 22 f8  |......4.1d...`".|
+00000110  30 bf 39 18 e7 82 eb 30  2e 32 d2 e8 bb e9 68 b8  |0.9....0.2....h.|
+00000120  b3 c5 db 34 8b ac cd f3  f9 de 83 e3 44 c1 a7 e7  |...4........D...|
+00000130  c8 af 88 b4 b5 b9 9a 62  2a cc 2e 84 51 82 e3 66  |.......b*...Q..f|
+00000140  c3 27 20 22 9b cf 9f 19  59 05 c1 2a 5f 38 51 10  |.' "....Y..*_8Q.|
+00000150  90 2b 95 05 d2 1b 81 ef  eb 7a 04 5d 91 17 44 fb  |.+.......z.]..D.|
+00000160  a2 e5 5e 9a 1e ca a4 c2  a3 66 1c 23 92 3e 8a 02  |..^......f.#.>..|
+00000170  8e c0 6f 4a f5 49 a0 43  b7 f3 06 3f 7e bf cb 99  |..oJ.I.C...?~...|
+00000180  1c f9 73 53 2b 95 d9 70  52 ba 88 96 1a 3a b1 f6  |..sS+..pR....:..|
+00000190  3a fa 02 a3 50 42 74 dd  fb 9b 1f 0e ad 64 24 e2  |:...PBt......d$.|
+000001a0  a6 4a b3 b2 71 3d d4 c4  ff 0e d2 81 9e 05 f4 9d  |.J..q=..........|
+000001b0  63 84 81 de 8e db 10 39  ed 94 f9 9e 68 9b 3a 7c  |c......9....h.:||
+000001c0  51 d0 23 83 ca 5d 5b 16  7e fd 8c 25 e8 6e b4 45  |Q.#..][.~..%.n.E|
+000001d0  37 92 65 65 81 d0 c6 7a  f3 f8 aa 53 00 9e 4b 61  |7.ee...z...S..Ka|
+000001e0  f8 6a 6c c9 11 1e 3b cb  bd 33 bd 53 9a d4 9a 9f  |.jl...;..3.S....|
+000001f0  06 6f 4c 3c 05 ba d5 e9  a1 f8 44 36 d6 b0 2d 13  |.oL<......D6..-.|
+00000200  f5 e0 59 39 d7 0f 93 c9  48 e1 e0 8d 78 c6 18 3e  |..Y9....H...x..>|
+00000210  ef b4 ba 81 18 f4 45 18  28 92 68 46 f2 d6 6e 4e  |......E.(.hF..nN|
+00000220  93 58 f9 77 44 89 51 47  0c b4 70 ff f0 f5 05 0b  |.X.wD.QG..p.....|
+00000230  6f f5 d7 fb 70 e1 f4 af  93 36 5f 68 5d 7a cd 56  |o...p....6_h]z.V|
+00000240  ab 4a 5b e8 a0 5f 6e 41  41 f4 d9 28 9e 5c 27 e4  |.J[.._nAA..(.\'.|
+00000250  25 2d bb ee 0d 56 2b 4c  9e 76 5c e1 1a 46 e9 e1  |%-...V+L.v\..F..|
+00000260  0d 00 b2 c6 9d be 3d 50  7c b7 13 97 fc d6 c9 33  |......=P|......3|
+00000270  73 fb 0e d9 9b bc 4c ab  54 05 55 43 35 3b c4 13  |s.....L.T.UC5;..|
+00000280  29 c5 a1 66 cc 79 77 c0  74 82 dc c7 ea 1f 11 45  |)..f.yw.t......E|
+00000290  e8 9f 19 34 01 28 98 ca  19 7a ef 43 9d 79 be 66  |...4.(...z.C.y.f|
+000002a0  02 c2 36 d7 a2 f6 11 3f  e9 38 66 48 4d 18 10 35  |..6....?.8fHM..5|
+000002b0  78 2f c7 70 85 95 db e4  db 75 c9 00 2e 04 f5 94  |x/.p.....u......|
+000002c0  6c 95 1b 51 58 b5 b6 2c  f5 e3 b4 af 45 1c 66 36  |l..QX..,....E.f6|
+000002d0  37 39 36 e0 9c 87 9d 4f  d7 b2 34 fd 6d 7d 93 36  |796....O..4.m}.6|
+000002e0  c1 16 36 bd 90 92 85 cb  4c 0d 58 d7 a0 e4 24 f8  |..6.....L.X...$.|
+000002f0  dc f2 1b 7e 28 37 e9 39  a2 8a 86 02 33 a9 ea 8f  |...~(7.9....3...|
+00000300  e3 34 41 e0 6e f0 bf c7  f1 ee 6a a9 a6 9c 53 c1  |.4A.n.....j...S.|
+00000310  39 0a 29 17 03 03 00 99  53 09 fd 77 1b 2c f9 2d  |9.).....S..w.,.-|
+00000320  2c 5d 95 de 84 d5 62 7c  ae 8f 2b 4f 6f 38 e1 fb  |,]....b|..+Oo8..|
+00000330  1c 95 e6 bf 57 aa a0 e5  4c f2 9e 1c 7b ef 1b 2c  |....W...L...{..,|
+00000340  d4 83 c8 6b 96 d5 c1 16  96 8a 62 e4 8a e8 ff 61  |...k......b....a|
+00000350  0b 3f 2e d2 14 f5 05 e6  e1 51 02 d6 40 62 f8 84  |.?.......Q..@b..|
+00000360  d4 02 2b 84 81 ee 45 64  49 cb 44 b9 e8 61 08 44  |..+...EdI.D..a.D|
+00000370  8e 93 3c 67 57 34 64 9f  0d 1e 76 27 27 4f 4f bd  |..<gW4d...v''OO.|
+00000380  ae a4 48 fc e9 cc 1f a1  28 36 c0 8f a6 b7 f1 61  |..H.....(6.....a|
+00000390  98 33 5e a7 16 79 48 ac  fb 24 99 40 eb a0 41 b4  |.3^..yH..$.@..A.|
+000003a0  93 b5 4b fd 7a 21 26 6c  f4 1b 21 ba 29 be c3 19  |..K.z!&l..!.)...|
+000003b0  74 17 03 03 00 35 37 3c  de b6 9f 90 dd 30 a4 a4  |t....57<.....0..|
+000003c0  af e1 3d 72 4a 31 50 ea  f6 36 33 23 a4 07 7d fc  |..=rJ1P..63#..}.|
+000003d0  36 20 c8 23 e7 1a b4 eb  02 11 ed 2c f6 43 17 51  |6 .#.......,.C.Q|
+000003e0  e1 d6 7a 3f d5 00 6c 67  8e 11 c3 17 03 03 00 88  |..z?..lg........|
+000003f0  9e 11 b0 bd 5f b2 e5 21  2b b1 61 6f 98 98 04 7e  |...._..!+.ao...~|
+00000400  a8 c3 8b 85 38 9b d5 79  11 6b 24 fd 02 0d 98 b2  |....8..y.k$.....|
+00000410  a9 0c e5 24 25 23 d3 f9  ba 80 84 84 b9 67 b3 ae  |...$%#.......g..|
+00000420  a1 c3 46 94 f8 19 18 e5  31 67 47 c7 12 79 65 d9  |..F.....1gG..ye.|
+00000430  96 87 dc eb ac 0f b7 09  50 86 13 76 7d fb b4 8f  |........P..v}...|
+00000440  ad 02 48 ed 89 68 16 14  74 53 23 70 0f 3c 72 1c  |..H..h..tS#p.<r.|
+00000450  20 d6 b2 df 54 f8 29 a5  0b d0 d3 e0 76 3f be e5  | ...T.).....v?..|
+00000460  bf c0 41 04 8a 5a e6 b6  d3 64 f9 63 fb a4 5c 51  |..A..Z...d.c..\Q|
+00000470  5b a5 54 0b d5 7a 86 db                           |[.T..z..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 0a ef 78 71 0b  |..........5..xq.|
-00000010  b7 cd 3e 05 16 87 99 d7  b9 61 0a 5d 14 d9 d1 12  |..>......a.]....|
-00000020  26 cf 80 34 33 54 f0 cf  99 73 1c e8 f8 6d 7a d7  |&..43T...s...mz.|
-00000030  20 bf a8 a9 7f d9 ef ee  b0 2e a4 52 d1 e5 16 c8  | ..........R....|
+00000000  14 03 03 00 01 01 17 03  03 00 35 81 a5 08 75 69  |..........5...ui|
+00000010  69 d3 98 34 19 41 0b 66  e9 bf c2 ac 74 9c 42 5d  |i..4.A.f....t.B]|
+00000020  73 50 3d 3e 3a 76 3c f1  f7 4a 23 a1 6b 0c 03 cb  |sP=>:v<..J#.k...|
+00000030  bb 4a b8 98 72 1e 7f ac  c0 79 2a 76 99 ee 85 5a  |.J..r....y*v...Z|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 2d 9a a1  59 ea 0b b5 0d 00 c2 e2  |.....-..Y.......|
-00000010  93 bd 8c 29 e0 48 e5 7f  f0 74 35 12 11 08 0d 09  |...).H...t5.....|
-00000020  6c 18 d8 17 03 03 00 13  09 3e 2b 79 2d d9 ca 26  |l........>+y-..&|
-00000030  b9 3f 85 96 bf 64 e1 9c  d0 4e f0                 |.?...d...N.|
+00000000  17 03 03 00 1e 08 53 f7  ad 7f a4 48 9c e7 a8 31  |......S....H...1|
+00000010  cc 91 55 c3 c0 89 64 ec  0d c8 dc fd 95 e9 ef 12  |..U...d.........|
+00000020  a5 52 a0 17 03 03 00 13  17 bf 2b 25 9a ff 5f 2b  |.R........+%.._+|
+00000030  32 f2 28 c3 c6 4f 20 dc  dc 09 88                 |2.(..O ....|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndECDSAGiven b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndECDSAGiven
index d424d42dfb..825e1d1e4a 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndECDSAGiven
+++ b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndECDSAGiven
@@ -1,180 +1,180 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 41 00 0b fe 6e  |...........A...n|
-00000010  db 4b f8 8c db 23 04 20  39 bd 29 85 5b ef 5e 36  |.K...#. 9.).[.^6|
-00000020  37 a2 1c 47 de 53 ee 1b  5b 4b 2f 20 89 aa 8d 4a  |7..G.S..[K/ ...J|
-00000030  3c a7 8b aa 92 ca 1f 83  fa 60 cc 90 b5 54 d4 d9  |<........`...T..|
-00000040  e2 c8 a3 1b d7 a4 15 9f  a6 f4 be b9 00 04 13 01  |................|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 6d 54 85 0d 98  |...........mT...|
+00000010  c5 8b 26 ec 63 38 87 ac  bb 8e 69 cc dc 4e b6 7e  |..&.c8....i..N.~|
+00000020  64 ae 02 e3 4b ff 38 0d  75 29 48 20 38 db 3d 9a  |d...K.8.u)H 8.=.|
+00000030  cd c9 6e cf 22 5b 09 a2  c9 9a 27 36 14 f1 8b 90  |..n."[....'6....|
+00000040  be 9e bf 88 ca af 40 6e  16 4c 86 ad 00 04 13 01  |......@n.L......|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 89  |-.....3.&.$... .|
-000000b0  d2 23 60 c4 08 7b 62 54  11 ad fe 71 3d 10 1a 92  |.#`..{bT...q=...|
-000000c0  49 52 7a ad 57 41 1e e1  46 64 09 34 79 0e 04     |IRz.WA..Fd.4y..|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 77  |-.....3.&.$... w|
+000000b0  a0 8b 51 0e 47 27 0b 1e  61 17 64 93 14 ee a2 98  |..Q.G'..a.d.....|
+000000c0  01 31 32 d5 50 ed a0 a1  a3 59 2f 28 d0 34 5d     |.12.P....Y/(.4]|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 89 aa 8d 4a  |........... ...J|
-00000030  3c a7 8b aa 92 ca 1f 83  fa 60 cc 90 b5 54 d4 d9  |<........`...T..|
-00000040  e2 c8 a3 1b d7 a4 15 9f  a6 f4 be b9 13 01 00 00  |................|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 38 db 3d 9a  |........... 8.=.|
+00000030  cd c9 6e cf 22 5b 09 a2  c9 9a 27 36 14 f1 8b 90  |..n."[....'6....|
+00000040  be 9e bf 88 ca af 40 6e  16 4c 86 ad 13 01 00 00  |......@n.L......|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 23 7d 81 4a b9 17  |..........#}.J..|
-00000090  cb 6f b4 10 3b 0d ac 24  8e e3 c9 27 9e 00 df d7  |.o..;..$...'....|
-000000a0  c0 17 03 03 00 3e 68 7a  1e 54 90 3a 52 70 2a 7c  |.....>hz.T.:Rp*||
-000000b0  c7 eb 0a 31 54 9d 91 76  9c fe 14 08 4b 11 c1 0c  |...1T..v....K...|
-000000c0  6f f7 20 8c f0 01 11 21  78 a6 83 58 c7 80 58 14  |o. ....!x..X..X.|
-000000d0  04 4a 14 26 64 d6 44 a8  f8 d8 a3 96 61 4f 50 de  |.J.&d.D.....aOP.|
-000000e0  3b fc 05 b2 17 03 03 02  6d cd f5 b9 c2 d6 56 de  |;.......m.....V.|
-000000f0  71 12 17 1a 8d c2 ee 80  ae 9e e6 d1 c4 0c d7 a3  |q...............|
-00000100  1d 1e df b5 98 d4 3c f1  08 7b 32 c5 00 c0 38 81  |......<..{2...8.|
-00000110  5c 90 86 63 25 39 22 e4  97 e6 04 ce 96 25 9f 9b  |\..c%9"......%..|
-00000120  5c ad b9 19 a5 e5 9d 3d  69 b4 46 51 74 fe ea 0d  |\......=i.FQt...|
-00000130  c9 85 ed fb b9 e7 e8 6a  6f f0 e4 0e a1 3f 73 b6  |.......jo....?s.|
-00000140  1f d4 3c 29 19 ff e3 c4  42 94 64 d7 d4 46 cf 0c  |..<)....B.d..F..|
-00000150  ed c6 57 be 33 cd c7 0b  e1 e5 50 38 bf c1 bc 45  |..W.3.....P8...E|
-00000160  33 ff f7 59 ed 7f 83 23  ee aa 5b a3 e2 7e 43 e8  |3..Y...#..[..~C.|
-00000170  ec f8 c9 49 83 00 92 7a  63 5d 8e 8d 6a 98 f0 97  |...I...zc]..j...|
-00000180  8b 9d d9 32 7f fd 57 0a  75 24 74 e2 37 5a e5 8b  |...2..W.u$t.7Z..|
-00000190  78 d2 98 a5 05 44 6e 2b  d2 d5 41 3c dd 07 60 46  |x....Dn+..A<..`F|
-000001a0  f3 78 14 83 2a 81 1d 24  de 62 57 bd d3 fd 5b 53  |.x..*..$.bW...[S|
-000001b0  0d 53 0d 86 16 33 fb 1a  d1 ad 0a d1 1d 25 bb ad  |.S...3.......%..|
-000001c0  55 d2 9e 8b 67 c7 b1 fe  4f 17 7c 86 bc 76 93 e7  |U...g...O.|..v..|
-000001d0  47 c0 29 b9 a7 2e 4e 84  4a 75 a2 6f cc 25 28 52  |G.)...N.Ju.o.%(R|
-000001e0  d2 87 e1 8e 0e 70 f1 11  2a ca ad 2e 4c a8 c3 79  |.....p..*...L..y|
-000001f0  46 80 39 ba 27 a8 f4 2a  3f d7 73 92 7a 61 05 db  |F.9.'..*?.s.za..|
-00000200  18 85 9a 02 9e aa 17 ab  ee 0a cb 4c 33 72 bc 4c  |...........L3r.L|
-00000210  57 a6 fd 23 0f 0c 72 bd  10 d3 54 9d dc ff 84 9a  |W..#..r...T.....|
-00000220  64 c5 b6 24 54 ad 45 14  d1 c4 15 c9 9c 09 e5 96  |d..$T.E.........|
-00000230  f0 48 03 8c 35 3d 6b 91  68 58 a6 37 b1 a5 e3 d8  |.H..5=k.hX.7....|
-00000240  f1 7e 6f 96 34 d1 e0 6a  a6 90 6d 4b 3b 12 e8 f2  |.~o.4..j..mK;...|
-00000250  29 18 93 5d 45 29 f2 e3  a8 08 25 2d 0c a1 87 f9  |)..]E)....%-....|
-00000260  46 29 57 57 ef 0d b9 17  4e d2 bb 5d 26 29 cc 8b  |F)WW....N..]&)..|
-00000270  55 d5 ff a4 44 1f e4 e9  bc d4 bf 68 d5 cf aa 1a  |U...D......h....|
-00000280  45 b6 56 99 d8 27 5d b9  88 2d a1 a2 55 51 0f 99  |E.V..']..-..UQ..|
-00000290  be cc 9b ad b5 bd 8a d5  ad 86 9f a3 6b 71 5d 17  |............kq].|
-000002a0  f0 98 a7 84 b2 6e 63 1e  ae 02 0a 50 88 53 b8 58  |.....nc....P.S.X|
-000002b0  a7 d8 74 4b 39 85 eb a5  1d 37 51 e5 40 b2 d7 3b  |..tK9....7Q.@..;|
-000002c0  5e 88 e2 96 c1 1a 84 53  7e 33 a7 cc 49 f1 b0 ae  |^......S~3..I...|
-000002d0  d6 37 e0 6d c8 2f c0 07  72 fa 7d 3d e7 91 cb 68  |.7.m./..r.}=...h|
-000002e0  f5 ae ca 4d da 44 70 b4  8e 7c 90 70 f4 7f 20 e3  |...M.Dp..|.p.. .|
-000002f0  1c 61 75 ef c4 ca ad dd  b9 9f e6 86 73 31 a4 c5  |.au.........s1..|
-00000300  55 f8 6a 27 d8 56 c6 c2  11 de ed 01 20 08 01 fe  |U.j'.V...... ...|
-00000310  5e e2 91 fb c8 91 d3 40  e0 b2 d7 a7 01 9b 1d f7  |^......@........|
-00000320  19 ee e6 fe 62 a4 a2 cc  33 30 00 04 14 11 bb 2e  |....b...30......|
-00000330  7f da 29 27 5d e9 6c ba  93 62 93 d4 31 97 48 2d  |..)'].l..b..1.H-|
-00000340  32 e0 3f 97 c3 ca fb 58  10 52 5d e6 4b 8b d5 37  |2.?....X.R].K..7|
-00000350  27 e3 28 74 65 20 17 03  03 00 99 22 7a 53 75 d8  |'.(te ....."zSu.|
-00000360  bf 52 be e9 c9 d0 17 f9  cc d5 50 7f 5c d0 89 64  |.R........P.\..d|
-00000370  52 6f 47 b1 a1 a4 4c 65  59 b9 c7 86 d3 fc 42 3c  |RoG...LeY.....B<|
-00000380  9e ae f2 a3 21 35 fb 72  eb df e6 78 9b 2a b8 be  |....!5.r...x.*..|
-00000390  b1 68 b0 6a fa ff 01 e0  6a 5b a7 f8 1f 8d 00 70  |.h.j....j[.....p|
-000003a0  aa 5d ab a9 1b c2 37 1e  5b 70 ed fc 10 92 47 98  |.]....7.[p....G.|
-000003b0  d9 ec 15 3c 30 65 a6 1b  0c b3 56 74 2b d0 c2 8f  |...<0e....Vt+...|
-000003c0  91 b2 07 5e 90 c4 9c f4  77 5c d4 c4 ab 70 e7 e0  |...^....w\...p..|
-000003d0  44 8a 52 c0 b7 42 84 f4  4f a4 d3 55 53 af 4a a2  |D.R..B..O..US.J.|
-000003e0  ce a7 c4 2c ed 0b a8 07  28 4e f5 b4 3f f0 cc 89  |...,....(N..?...|
-000003f0  e6 a6 e0 3d 17 03 03 00  35 28 89 45 89 0a 9b 22  |...=....5(.E..."|
-00000400  cf 6b ce 32 1d 62 fc 2a  87 3e 21 12 12 c0 36 54  |.k.2.b.*.>!...6T|
-00000410  f9 4f 70 da 3e 87 17 49  a1 43 6e ff cc 9e 34 06  |.Op.>..I.Cn...4.|
-00000420  e7 38 bd 9b e8 13 47 0e  de fe 61 56 19 fa        |.8....G...aV..|
+00000080  03 03 00 01 01 17 03 03  00 17 4b 3b 67 ba 64 c9  |..........K;g.d.|
+00000090  7a c8 a1 64 7f 7b 74 a1  bd 9b 4d 8b c5 a0 70 5d  |z..d.{t...M...p]|
+000000a0  98 17 03 03 00 3e 9e 29  80 90 d2 52 80 49 23 96  |.....>.)...R.I#.|
+000000b0  0b b0 93 d8 ac bf c6 22  1c 2e 14 ea 91 99 71 e5  |......."......q.|
+000000c0  d0 c4 ab 04 fc 22 b4 36  d0 50 02 39 23 b3 60 c1  |.....".6.P.9#.`.|
+000000d0  bd 71 53 3a c5 23 df 0a  08 b2 bf 91 c3 d2 b4 f1  |.qS:.#..........|
+000000e0  55 81 ca fa 17 03 03 02  6d 06 1f 34 8c c5 02 e6  |U.......m..4....|
+000000f0  5d b2 87 9e e0 e9 d7 64  a3 cf a4 e8 3e e6 34 46  |]......d....>.4F|
+00000100  f4 eb 51 0e 41 f9 00 61  bd b2 36 7d b3 9f 30 e8  |..Q.A..a..6}..0.|
+00000110  62 aa 06 d2 08 c3 f4 16  eb 39 0c 2e 69 ca a5 2d  |b........9..i..-|
+00000120  ce 48 e2 c9 60 04 a8 9b  f8 98 c7 f2 de 71 cb cf  |.H..`........q..|
+00000130  c6 8d de bc 80 50 ba 3e  76 5c d7 0b 39 ef fd 77  |.....P.>v\..9..w|
+00000140  68 7f fc 77 db 18 fb 7a  7a 74 2d 59 88 fa 7d db  |h..w...zzt-Y..}.|
+00000150  24 4c f3 18 c5 1f 73 9c  af e1 26 e0 8d 14 a9 b3  |$L....s...&.....|
+00000160  eb a3 0d 8a ed a2 19 e9  7d a3 a8 f7 dc 08 0f 69  |........}......i|
+00000170  06 84 45 cb 49 a0 12 ef  95 fd 0a 5f 49 80 91 0f  |..E.I......_I...|
+00000180  a9 0d 3a 52 25 1f 62 90  1a d8 fa a6 01 a0 f3 98  |..:R%.b.........|
+00000190  ce e6 68 4e 3e 60 43 58  ad 53 a5 4b d8 b4 09 c5  |..hN>`CX.S.K....|
+000001a0  0e 2b 11 0a e4 dc 8e 5d  1c 56 97 c1 63 08 0f 1c  |.+.....].V..c...|
+000001b0  e7 ec 0e 94 f4 65 bf c8  5d 52 ac 6b f3 b2 36 34  |.....e..]R.k..64|
+000001c0  bf e0 5d 35 91 93 5b 36  04 d4 10 49 1c 08 7f f5  |..]5..[6...I....|
+000001d0  fc 18 7f 81 36 be 3f fe  23 8b 8d d9 d4 8a 06 ec  |....6.?.#.......|
+000001e0  af 39 b1 85 df 2d be 23  8d 86 d9 3e e5 27 fa 62  |.9...-.#...>.'.b|
+000001f0  e4 8e 94 a1 26 55 0a ed  0f 21 38 a3 b1 6a 36 e7  |....&U...!8..j6.|
+00000200  ae 53 4c c5 65 d1 9a 63  8f 98 de fe d9 dd 3f fe  |.SL.e..c......?.|
+00000210  44 2b 26 61 bd d9 cf 88  bb a3 f4 b7 45 14 59 91  |D+&a........E.Y.|
+00000220  dc bd fd 4f 57 c7 37 5b  8b b7 e2 5c b2 1d c3 15  |...OW.7[...\....|
+00000230  67 8e 64 c5 af d7 30 00  01 47 09 bd 55 01 47 b7  |g.d...0..G..U.G.|
+00000240  7f 12 29 dd 57 f2 05 8c  57 c6 08 fb 78 13 d1 e5  |..).W...W...x...|
+00000250  c8 33 49 6c c2 b2 38 ea  22 8e f9 79 d1 8e 17 9f  |.3Il..8."..y....|
+00000260  a8 0b f8 0d 23 07 f4 ce  fb 2d 9d 2f 6d a1 42 b6  |....#....-./m.B.|
+00000270  66 7b 7d 64 fc 45 6e 92  99 ee a4 57 72 04 02 30  |f{}d.En....Wr..0|
+00000280  83 2e 48 d5 17 9f 2d 2b  84 83 ce e3 c1 17 d5 49  |..H...-+.......I|
+00000290  48 4b ea 60 fc 1f bb 3b  93 24 db 2a c7 7b 4d cf  |HK.`...;.$.*.{M.|
+000002a0  93 1f 8e aa 8a bb dd f1  79 9a 4f d1 54 b5 7d 6c  |........y.O.T.}l|
+000002b0  67 76 9e 4b eb 40 4d 73  76 fb d2 32 9a eb 3f 27  |gv.K.@Msv..2..?'|
+000002c0  c3 18 40 63 25 76 af 65  9b a1 73 74 cb d2 a8 c1  |..@c%v.e..st....|
+000002d0  35 40 0a 4f db f8 f6 4e  93 06 56 34 48 2e 1f 26  |5@.O...N..V4H..&|
+000002e0  b4 e1 13 14 6b f9 dc 81  cd 2a 74 3a 54 86 b2 a2  |....k....*t:T...|
+000002f0  d7 d5 33 6b 79 32 9b cb  1f 95 18 28 c5 99 eb 72  |..3ky2.....(...r|
+00000300  79 6f a7 4b 46 e2 86 f4  c5 29 cc 0f 05 1d c3 56  |yo.KF....).....V|
+00000310  eb 28 67 58 7b c6 13 05  da d6 7d a9 5b 2c 62 a2  |.(gX{.....}.[,b.|
+00000320  70 13 0f d6 22 06 cd bc  12 53 b2 36 7a 17 a1 40  |p..."....S.6z..@|
+00000330  ac 39 f8 1f d6 1d 92 00  0a 03 fa 95 75 4a c5 e9  |.9..........uJ..|
+00000340  a1 bb 1d 7e 8c 5a 48 15  5a db 5a 4c 98 ab 2a 51  |...~.ZH.Z.ZL..*Q|
+00000350  fc 5e d9 ce b0 9e 17 03  03 00 99 8c 17 be 13 25  |.^.............%|
+00000360  04 a3 6a 51 01 52 4c 16  3f 60 93 88 86 83 f8 83  |..jQ.RL.?`......|
+00000370  bd 6e 56 76 37 e6 b9 56  d6 97 d3 4f 74 1c 43 f3  |.nVv7..V...Ot.C.|
+00000380  38 5c e9 49 5b 1a ca 85  e9 f9 68 64 42 17 fe 6a  |8\.I[.....hdB..j|
+00000390  7b bf ea 41 06 a0 c8 15  44 5c cb 32 02 22 c6 35  |{..A....D\.2.".5|
+000003a0  ec f0 a5 43 a2 9d b5 83  a5 85 58 04 1a 22 90 b2  |...C......X.."..|
+000003b0  a1 d6 65 e0 5e ea 69 fc  e5 22 98 15 5c 93 61 f9  |..e.^.i.."..\.a.|
+000003c0  53 ea d5 7c c4 d4 fa f3  19 eb c2 21 9e e3 c3 cb  |S..|.......!....|
+000003d0  80 2d 79 b8 26 a8 dc 08  86 b7 65 96 42 a8 73 99  |.-y.&.....e.B.s.|
+000003e0  5b e0 15 ed 9c 3f 0d 1b  17 fd dd 1f c3 c5 67 b1  |[....?........g.|
+000003f0  c3 fd c9 d1 17 03 03 00  35 2b a2 f5 53 a1 46 fb  |........5+..S.F.|
+00000400  f2 30 e6 28 a2 bc 3a 24  ae 67 36 d9 73 84 5a ea  |.0.(..:$.g6.s.Z.|
+00000410  f8 e1 cd 13 b9 e5 43 3d  95 d5 63 f9 b6 19 7c 53  |......C=..c...|S|
+00000420  98 f4 07 f0 da f2 56 c2  68 d4 d0 25 f3 5e        |......V.h..%.^|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 02 1e 15 99 04 e9 2f  |.............../|
-00000010  0f 5f a2 83 6c d3 6f 14  ec 36 cd ac ad 44 40 0e  |._..l.o..6...D@.|
-00000020  8a e5 62 a1 f7 0b b7 52  04 0b a9 6f 60 be 36 c3  |..b....R...o`.6.|
-00000030  5c d1 76 47 41 32 b6 61  52 32 71 46 03 40 11 aa  |\.vGA2.aR2qF.@..|
-00000040  44 ad e7 40 26 c8 2d 4a  85 4a 24 ef 05 31 c9 91  |D..@&.-J.J$..1..|
-00000050  9c 16 7f f5 1c 5e ef d5  2c 3c 88 ed d3 e6 09 fd  |.....^..,<......|
-00000060  a4 7e 5e 4f 34 84 30 38  e1 dd cc 9b 21 d5 bc c4  |.~^O4.08....!...|
-00000070  c2 7e fa 9a 9e 0c fe f8  c3 80 02 8a 6c 00 2b ac  |.~..........l.+.|
-00000080  dd ca 45 5b c1 80 53 3d  3f 37 e6 b4 ab 09 28 f3  |..E[..S=?7....(.|
-00000090  8c 41 c4 cc 6d d6 2a d8  dc 37 51 7c 35 d9 aa 44  |.A..m.*..7Q|5..D|
-000000a0  c3 1a ba 2d 6b 1d cf 4b  20 be fb a5 1a ea 0f 83  |...-k..K .......|
-000000b0  64 88 4b a1 03 d2 b2 19  d4 df ae 2f b4 f0 79 85  |d.K......../..y.|
-000000c0  de 89 81 2d 0c 18 1b e8  3a 70 9b 26 cc 11 45 62  |...-....:p.&..Eb|
-000000d0  6f 2a a7 06 61 f9 b2 d7  9a 93 79 27 a6 ef c7 26  |o*..a.....y'...&|
-000000e0  e3 df 53 09 c5 a3 27 6b  bf aa 1b 6b 1d 4e 09 ab  |..S...'k...k.N..|
-000000f0  65 28 16 11 44 cc ea 97  aa a1 14 a2 2d f6 b9 cb  |e(..D.......-...|
-00000100  1a 4f ce b7 67 01 86 f6  d0 a6 73 94 6a bc e0 e5  |.O..g.....s.j...|
-00000110  68 20 f9 da 1d 62 9c 8b  3a a5 e9 bc e7 df 2c 07  |h ...b..:.....,.|
-00000120  f8 59 33 69 61 22 96 47  57 96 a7 eb ae 9f 65 2b  |.Y3ia".GW.....e+|
-00000130  5c 99 4e 3e f5 50 16 0b  9e 85 5e c4 28 ba fb 70  |\.N>.P....^.(..p|
-00000140  31 af ad 11 74 00 1c b5  d0 23 ce 36 e9 98 e3 09  |1...t....#.6....|
-00000150  a5 31 74 f8 5b ed a8 8e  7b 89 41 81 c4 8f 93 12  |.1t.[...{.A.....|
-00000160  61 33 95 48 6f 81 e5 9f  ef a0 05 fd c0 ae 3d f2  |a3.Ho.........=.|
-00000170  43 e2 17 7f 0a 78 b7 fd  25 1d 68 3d 3c 55 49 68  |C....x..%.h=<UIh|
-00000180  46 43 bc df 0c 2f 56 54  2a 0b db 4e 83 97 82 47  |FC.../VT*..N...G|
-00000190  f6 64 64 35 9f 29 56 43  9c 8b 54 07 b8 73 b2 e4  |.dd5.)VC..T..s..|
-000001a0  06 83 49 38 cc 3d 78 15  d2 7c 57 57 55 61 5a c5  |..I8.=x..|WWUaZ.|
-000001b0  7e 42 fe ae a5 00 0e 0b  01 4e 21 3d a8 65 98 33  |~B.......N!=.e.3|
-000001c0  40 00 de 02 9c 5e b0 33  a9 d2 24 62 20 29 d3 bc  |@....^.3..$b )..|
-000001d0  8f 3c 3c 0d 9a 12 59 fe  f1 5f da a2 c3 66 ff 28  |.<<...Y.._...f.(|
-000001e0  97 38 fd 0c c8 a8 f5 be  49 36 df 0b e1 3c 2d 05  |.8......I6...<-.|
-000001f0  04 29 c8 5d 3e 4f 51 12  92 be 90 4a f4 9f 47 4d  |.).]>OQ....J..GM|
-00000200  e7 b2 e8 f0 35 11 06 59  37 ce 11 3c 38 39 34 32  |....5..Y7..<8942|
-00000210  67 99 a7 d0 08 a6 5a 8f  d3 51 4c 72 7b 8a c1 82  |g.....Z..QLr{...|
-00000220  b9 67 37 d3 95 5c 98 47  a5 17 03 03 00 a4 18 dd  |.g7..\.G........|
-00000230  ae ad f2 7b 11 07 aa a3  e9 0d 0f ef 69 6b 29 bb  |...{........ik).|
-00000240  76 ec 64 80 d7 ae f9 70  0b 2a 04 e9 86 6c 9a 38  |v.d....p.*...l.8|
-00000250  85 a5 1f 3e 89 f9 26 2e  36 d2 0b 61 86 e7 06 01  |...>..&.6..a....|
-00000260  fd 9e a5 63 84 30 61 2a  e3 12 ca 4a a7 77 de 14  |...c.0a*...J.w..|
-00000270  7b ff d6 7c a6 ce 34 0a  3a f8 26 66 b1 19 aa fa  |{..|..4.:.&f....|
-00000280  06 73 c8 e3 12 cd 71 a4  4b 8b 71 fe 20 5f de a6  |.s....q.K.q. _..|
-00000290  01 3a 9e 8e 67 10 66 ba  e2 19 39 51 5e a4 33 71  |.:..g.f...9Q^.3q|
-000002a0  65 e1 9f b1 99 2b 3c bf  1c a2 3e e8 20 e9 87 1b  |e....+<...>. ...|
-000002b0  1f ef 17 9e 09 fd f3 52  70 d0 c6 38 bf 63 d8 bf  |.......Rp..8.c..|
-000002c0  48 4f 21 83 b1 89 b7 41  30 f2 8a 50 fe 48 ab a0  |HO!....A0..P.H..|
-000002d0  ee 26 17 03 03 00 35 1c  c5 ba 62 85 94 3f 3e 91  |.&....5...b..?>.|
-000002e0  1b 75 7c 58 17 a4 8c 18  03 dd 58 c5 fb 58 ba d3  |.u|X......X..X..|
-000002f0  36 c9 17 11 ed 80 6d 28  da 0f 74 06 97 eb 65 b9  |6.....m(..t...e.|
-00000300  00 f2 1a 31 31 30 56 0c  d8 03 fd 97 17 03 03 00  |...110V.........|
-00000310  13 22 2f 15 cb 78 1d f6  80 d0 fc ab 56 87 57 db  |."/..x......V.W.|
-00000320  7e 9a cd be                                       |~...|
+00000000  14 03 03 00 01 01 17 03  03 02 1e 35 ea 71 3a ff  |...........5.q:.|
+00000010  24 95 39 41 c0 15 b0 24  88 34 2a 31 3e 7c 62 4f  |$.9A...$.4*1>|bO|
+00000020  d2 6d 83 7e da e9 23 3b  34 2a cd 1a c0 a3 20 30  |.m.~..#;4*.... 0|
+00000030  f6 8b 04 43 a9 01 1b 5f  e7 8f 16 f4 30 8e b9 dc  |...C..._....0...|
+00000040  75 b7 40 5f 21 bb af 41  e9 af b8 bc 7d de 5d 5e  |u.@_!..A....}.]^|
+00000050  39 99 21 45 e0 e4 1c 5c  04 c9 77 34 52 6e e2 4e  |9.!E...\..w4Rn.N|
+00000060  76 77 21 10 c8 a6 f8 66  02 4d fb 6f 68 ab 16 52  |vw!....f.M.oh..R|
+00000070  49 bf 50 bd 4a 2a d5 e5  4d 8c 19 9f 4e b6 d8 7f  |I.P.J*..M...N...|
+00000080  b8 4b 8d f2 ff a6 32 52  35 15 de d3 fd 83 d1 fa  |.K....2R5.......|
+00000090  6c c2 5e f1 2a 46 de 24  9f ba 3f e5 0e 7b b8 98  |l.^.*F.$..?..{..|
+000000a0  25 38 69 ea d5 84 49 b0  02 6f b8 61 54 71 4e fe  |%8i...I..o.aTqN.|
+000000b0  a2 48 ff bd 0e 69 99 30  91 4d 0a 77 31 96 78 36  |.H...i.0.M.w1.x6|
+000000c0  65 41 00 eb e4 f3 37 77  0f 16 fd 6f a2 ae d2 8b  |eA....7w...o....|
+000000d0  1a e1 81 34 a1 e0 20 5b  b3 ac 8e 22 c4 bc fa d2  |...4.. [..."....|
+000000e0  64 41 82 37 b8 e7 a5 43  e3 d8 2f 23 0a ff 1d 39  |dA.7...C../#...9|
+000000f0  ee c8 48 3b 4a c2 b0 a9  99 e2 20 60 9b 8c 17 0b  |..H;J..... `....|
+00000100  c1 71 58 d1 cf 40 e5 85  fe 33 38 f4 87 90 b4 79  |.qX..@...38....y|
+00000110  f9 ab 6b 7a bf db c9 2d  8a 4b 3c 15 6a ce 05 5e  |..kz...-.K<.j..^|
+00000120  b9 8c e5 cb 66 28 75 d0  55 a6 e5 47 12 18 b9 e3  |....f(u.U..G....|
+00000130  73 31 b9 23 d0 54 bd 4f  26 71 8a 71 fe 4b 75 bd  |s1.#.T.O&q.q.Ku.|
+00000140  02 ee 4a b3 fe f5 83 7d  74 23 69 5d 72 40 d6 de  |..J....}t#i]r@..|
+00000150  71 77 bd 4a f2 ac 92 c6  0b d5 ce ad 89 21 11 80  |qw.J.........!..|
+00000160  20 00 bb ca 45 d8 d1 82  1b 5c 9a 63 01 46 06 d4  | ...E....\.c.F..|
+00000170  f9 74 59 8d 7f af e7 8b  9b 92 cb 41 85 6d 8e e3  |.tY........A.m..|
+00000180  a6 45 79 12 1e c5 9f 35  aa 21 9b 23 d5 50 85 df  |.Ey....5.!.#.P..|
+00000190  ff 1c 10 5c 0e d0 fe 0f  62 9c 65 99 19 06 4b f4  |...\....b.e...K.|
+000001a0  57 a3 1a 97 68 56 bb 00  c8 5c 55 68 e4 9d a4 af  |W...hV...\Uh....|
+000001b0  75 87 f7 91 52 98 bf 19  15 07 2a 40 fa 9f 51 a5  |u...R.....*@..Q.|
+000001c0  de 0e 3d 30 fe 0f 30 b2  6c ab 46 c8 08 de 30 02  |..=0..0.l.F...0.|
+000001d0  2f 6d 96 b0 ad 1b 8c 55  dc 85 1a c9 b5 34 3a 8c  |/m.....U.....4:.|
+000001e0  26 be b7 4d 42 06 62 bf  aa 1c 2b 3d cd 90 a2 89  |&..MB.b...+=....|
+000001f0  b5 c5 f5 fa 7a 28 60 6c  ce c8 88 f9 cc 7f 83 fc  |....z(`l........|
+00000200  87 b1 ca 37 9d 99 2a 3d  ad d4 56 63 e7 5f c1 85  |...7..*=..Vc._..|
+00000210  a0 2d b5 d4 14 fc 4e 97  6b b8 47 96 e7 3e 87 53  |.-....N.k.G..>.S|
+00000220  d8 ba f8 65 12 2a b4 ac  95 17 03 03 00 a4 78 09  |...e.*........x.|
+00000230  fa cc 9d 62 ac 51 44 96  9b 72 9c 3c c5 24 cd 82  |...b.QD..r.<.$..|
+00000240  08 7b af e0 c8 ef 41 cc  56 5d bb a8 47 9b d2 28  |.{....A.V]..G..(|
+00000250  53 71 2e 1f 86 11 42 3e  7e 4f d4 cd f8 c4 1e be  |Sq....B>~O......|
+00000260  06 14 c5 6d 8d 75 d1 6a  b3 8f 3a 4b 7e 1a c5 05  |...m.u.j..:K~...|
+00000270  8b 78 38 58 61 aa c7 32  35 56 9f 7a cf 13 1e d5  |.x8Xa..25V.z....|
+00000280  36 75 01 0f 39 fd f2 c3  f2 53 85 6b 47 11 9b 95  |6u..9....S.kG...|
+00000290  97 b2 ce cd 1c ef df a1  d5 ce 63 46 73 da 68 40  |..........cFs.h@|
+000002a0  ea c4 04 1d 7e d7 e5 1e  97 1d 0d 4a 0d 2d 69 e2  |....~......J.-i.|
+000002b0  b2 35 58 d2 73 97 14 77  a8 7d d5 13 3b 52 40 f4  |.5X.s..w.}..;R@.|
+000002c0  2f f3 39 97 bd 24 d5 87  81 69 02 c3 77 d7 88 53  |/.9..$...i..w..S|
+000002d0  63 46 17 03 03 00 35 cc  78 42 da 9d 5b 8f ec c7  |cF....5.xB..[...|
+000002e0  e8 38 a2 b1 26 e7 2e aa  65 24 c1 1e 7b bb 69 60  |.8..&...e$..{.i`|
+000002f0  88 f1 20 cc 95 32 61 62  d4 b0 0b 44 03 97 78 b8  |.. ..2ab...D..x.|
+00000300  18 0e b4 49 cd 03 81 aa  6a 61 56 48 17 03 03 00  |...I....jaVH....|
+00000310  13 b5 fb 3d 26 ff cd 0f  27 3d 46 dd 06 1f 57 88  |...=&...'=F...W.|
+00000320  e0 df 8f e5                                       |....|
 >>> Flow 4 (server to client)
-00000000  17 03 03 02 8c 20 58 a6  78 18 96 db a9 a6 7b 82  |..... X.x.....{.|
-00000010  12 1d 91 3c d2 f2 53 46  22 56 17 ba 71 7e ab 85  |...<..SF"V..q~..|
-00000020  9d eb d3 23 8a d2 b5 fe  d0 40 ad 25 d6 bb cf f1  |...#.....@.%....|
-00000030  94 6e ea b8 f7 dc 4b cf  7c 6e 04 c7 cf 8c 00 4f  |.n....K.|n.....O|
-00000040  99 1c 4a 0d 54 02 9c 0c  48 af 82 ac b3 1c 56 91  |..J.T...H.....V.|
-00000050  36 ab b8 3a 1e 95 68 7d  70 cb be 3b c4 77 36 7d  |6..:..h}p..;.w6}|
-00000060  37 62 88 85 30 c7 a1 12  a6 ca 95 9b d7 42 71 ec  |7b..0........Bq.|
-00000070  7e f6 b8 bf f6 27 73 c0  2b 83 a5 25 c7 3c 5c 19  |~....'s.+..%.<\.|
-00000080  c1 42 8f 10 5b d9 40 cd  f7 6a b6 0d 93 54 78 9e  |.B..[.@..j...Tx.|
-00000090  f1 35 68 2a 9d fd bf 34  9d ac 97 78 bf 12 0e 2b  |.5h*...4...x...+|
-000000a0  82 91 14 32 46 0c 6b 9c  b5 74 65 24 07 e7 c0 7e  |...2F.k..te$...~|
-000000b0  76 ff 29 f1 2d 6a dc 4d  59 ef 3b 51 f5 30 b4 df  |v.).-j.MY.;Q.0..|
-000000c0  8a 28 ff 38 2f e4 30 ae  a6 5f b8 3e f5 22 eb 2d  |.(.8/.0.._.>.".-|
-000000d0  14 6a f4 ec ad c1 e2 70  be 31 76 d7 7c 41 2b 3a  |.j.....p.1v.|A+:|
-000000e0  be 55 56 dc 86 fa 44 ee  da c4 5c 52 2c 02 60 72  |.UV...D...\R,.`r|
-000000f0  03 8e f2 ea 51 c7 4c 69  16 34 93 e2 61 d3 42 96  |....Q.Li.4..a.B.|
-00000100  04 f1 fa 47 14 29 36 38  d9 f1 80 31 6f 0a 29 fa  |...G.)68...1o.).|
-00000110  c6 a9 f7 4e 54 1d 15 e8  8c fb 66 3b 0c 9d 00 b7  |...NT.....f;....|
-00000120  c4 b7 6b 3c be 14 79 0b  bd 6e 1c a6 0b 31 ac 15  |..k<..y..n...1..|
-00000130  a6 3d 61 3e fa 52 06 17  5a dc 76 ef 49 2e 36 a2  |.=a>.R..Z.v.I.6.|
-00000140  d0 e5 96 5c bf 86 1c 43  66 ba 15 a3 40 ad e5 f7  |...\...Cf...@...|
-00000150  0c e5 74 a4 e7 09 4a ed  a5 0b 96 b6 f1 c3 9a 3b  |..t...J........;|
-00000160  f3 9c 47 5f 22 4f 16 47  14 1c 75 4a 5c 84 52 d6  |..G_"O.G..uJ\.R.|
-00000170  87 15 dd 14 1b 63 bc 38  5a 03 1f 66 eb dd f4 84  |.....c.8Z..f....|
-00000180  a3 ac 6f c1 eb f6 aa 27  2c 21 aa 27 8c b5 79 a6  |..o....',!.'..y.|
-00000190  cd 0e ca 49 a6 75 ac 44  c7 fd ec 34 a2 8b bf b1  |...I.u.D...4....|
-000001a0  d2 93 1e 48 83 cc 24 c5  7a 64 fb ac 98 9c e5 c2  |...H..$.zd......|
-000001b0  8c 93 1f 7e 59 14 1b 08  33 e7 49 3d 0a 0a fb 2a  |...~Y...3.I=...*|
-000001c0  a9 ed 88 08 08 d1 1b 03  7c 50 22 6c a8 c8 1e 0d  |........|P"l....|
-000001d0  9a ab 6d 88 2b e4 6c 64  cd f1 44 5f 96 45 2a 30  |..m.+.ld..D_.E*0|
-000001e0  76 ae 91 cc c2 41 ea 95  36 c0 f2 d0 44 fd 34 ce  |v....A..6...D.4.|
-000001f0  fd 70 50 ca 4f 14 60 8b  cd e4 0c 56 fa 73 b4 f9  |.pP.O.`....V.s..|
-00000200  9c b5 cd 3f cf f5 03 65  ea a9 cc 9e f2 b3 43 ed  |...?...e......C.|
-00000210  0c 3f 71 41 d7 e7 aa bc  2b c8 25 8c d2 45 7a d7  |.?qA....+.%..Ez.|
-00000220  7d 39 b0 bf 6b 89 96 07  5a 84 29 5b 6e 4a 63 62  |}9..k...Z.)[nJcb|
-00000230  54 b2 9d b0 0b 25 4a b5  65 04 9c 86 d1 09 d8 e5  |T....%J.e.......|
-00000240  71 c1 8a 1f 8a ae 56 b5  dd 3b 20 6f b9 43 f5 23  |q.....V..; o.C.#|
-00000250  0c 9e 69 1f c8 71 38 93  e1 d0 75 14 c8 1b c6 9c  |..i..q8...u.....|
-00000260  69 04 b2 a2 a6 7f 8e 2d  e2 20 58 f5 f7 c1 0e 2c  |i......-. X....,|
-00000270  4f 81 e1 da 38 e9 1b dd  c7 18 d6 6b e0 03 01 00  |O...8......k....|
-00000280  89 4e 06 1e e4 79 e9 21  dc 3e 95 a9 07 58 f2 ee  |.N...y.!.>...X..|
-00000290  6a 17 03 03 00 1e 82 69  04 dd 7f d3 0d fa da 75  |j......i.......u|
-000002a0  cf c4 d0 19 aa c8 5b 7e  c3 6b 85 ea 7c 73 05 31  |......[~.k..|s.1|
-000002b0  35 c0 41 56 17 03 03 00  13 98 b3 91 b2 b9 db df  |5.AV............|
-000002c0  59 17 6f 97 fb 8f c7 76  bc 98 86 7a              |Y.o....v...z|
+00000000  17 03 03 02 8d 0c e6 86  3a 8f 57 a1 71 e1 7e e3  |........:.W.q.~.|
+00000010  62 61 33 8f 0a 08 ca 6a  98 5a d0 6f 2b d2 c6 bb  |ba3....j.Z.o+...|
+00000020  ae bd 7f 73 ab 7c b5 9f  dd 43 98 4d 5f 62 71 2e  |...s.|...C.M_bq.|
+00000030  52 21 ea e2 e9 f7 7d f3  72 57 0c 64 8b f9 a0 dc  |R!....}.rW.d....|
+00000040  0a 08 8b f3 a7 90 9d 55  a0 be a0 42 70 71 fc c0  |.......U...Bpq..|
+00000050  cc ec 46 92 2a de 94 93  85 c6 e7 30 89 5e cc d6  |..F.*......0.^..|
+00000060  0f c2 0d 4b b5 79 0c fd  d1 42 47 08 71 0d ec fc  |...K.y...BG.q...|
+00000070  4a a8 b4 1d 58 42 48 15  89 56 0a 08 5d 60 7a a7  |J...XBH..V..]`z.|
+00000080  a7 6a ea 62 6a fc 46 ab  d8 25 9e 2c ff 85 78 b6  |.j.bj.F..%.,..x.|
+00000090  37 bf 84 b0 34 ed 4d 39  de c9 e6 47 9f 75 c7 6b  |7...4.M9...G.u.k|
+000000a0  fc e3 8f 4c eb 8a 68 ee  d6 76 3f 2a b1 2a 8d 2c  |...L..h..v?*.*.,|
+000000b0  40 e9 d9 cf 8f d6 db 7a  da 0b d7 02 5a e0 36 11  |@......z....Z.6.|
+000000c0  06 6c 67 70 a9 6d 8b d9  62 dc 70 e8 64 a8 f9 8f  |.lgp.m..b.p.d...|
+000000d0  ac 99 5a 40 17 18 54 5b  8b fa 20 ff 3c 7e f5 c3  |..Z@..T[.. .<~..|
+000000e0  a4 06 83 28 e4 68 97 6f  6b d7 16 91 54 dd 29 2f  |...(.h.ok...T.)/|
+000000f0  8c fc 86 a5 98 97 55 0d  2f e6 57 41 1a a9 f1 c2  |......U./.WA....|
+00000100  4b 9c 72 ef 30 40 17 4f  a9 dd 68 b3 72 cc 1a d2  |K.r.0@.O..h.r...|
+00000110  5f b6 4b df 37 8f f6 7b  2d 7d 4b b9 16 9e 8a 53  |_.K.7..{-}K....S|
+00000120  dd 64 42 c2 f0 7f b5 fd  82 25 78 7b 29 68 1b a4  |.dB......%x{)h..|
+00000130  5b 66 f0 1b e3 8e 31 36  44 2f 23 58 72 c2 f9 be  |[f....16D/#Xr...|
+00000140  3b 99 ab 0b 45 dc 88 23  38 69 3d 35 43 a5 22 89  |;...E..#8i=5C.".|
+00000150  cc 82 e0 9c 1d f3 1d cd  13 50 bb 5a 99 06 16 e6  |.........P.Z....|
+00000160  bc e7 d9 2c d8 ed fc 5b  98 06 63 d2 37 35 0a 7b  |...,...[..c.75.{|
+00000170  b5 dc 66 3d 8b 21 f8 de  1c 7d f6 91 fa 42 49 b0  |..f=.!...}...BI.|
+00000180  91 4f e9 ea 5f da 05 40  c0 2c 28 ed da 24 c5 fb  |.O.._..@.,(..$..|
+00000190  71 57 87 d5 f5 8e 7a 82  07 12 17 60 57 c4 3f bf  |qW....z....`W.?.|
+000001a0  8e aa 2e eb f2 be c1 9c  8b ed f3 08 30 68 3a 04  |............0h:.|
+000001b0  52 26 08 8c 96 81 4b 91  32 b4 2e 4e d9 66 d2 32  |R&....K.2..N.f.2|
+000001c0  66 c1 b2 97 59 68 6b 50  2c 80 51 c4 ad 15 c5 25  |f...YhkP,.Q....%|
+000001d0  87 64 74 8d c9 6c 53 d3  78 eb bd b3 9f 53 15 cb  |.dt..lS.x....S..|
+000001e0  98 18 65 1a f8 99 d8 f3  a0 2f 0f aa 17 4b 8d 3f  |..e....../...K.?|
+000001f0  2f 40 cb 70 0b ad 4e 9a  fe 5f 71 8a ab 75 8d 57  |/@.p..N.._q..u.W|
+00000200  03 66 3d 9f cd 92 da b1  30 27 bb 6d 93 7b f0 d2  |.f=.....0'.m.{..|
+00000210  3f d9 0b 26 1d c7 44 2f  ea 70 94 eb cd 8e 9e 0a  |?..&..D/.p......|
+00000220  e2 24 74 b1 66 45 93 d3  62 ca ff ae 7e d1 ad 0f  |.$t.fE..b...~...|
+00000230  d2 50 a9 d0 39 df ac 41  79 ca f1 f5 48 ad 84 20  |.P..9..Ay...H.. |
+00000240  a4 6a d3 f2 29 f8 5c 11  df d1 7a 63 7a 66 75 7f  |.j..).\...zczfu.|
+00000250  4e 14 9f cc 52 99 6f 4b  78 9c 2c b6 c1 fa 47 7c  |N...R.oKx.,...G||
+00000260  ce 79 ce 0a 45 47 45 49  19 1a ad 4b 5c 7c 6d 81  |.y..EGEI...K\|m.|
+00000270  fe ff f3 43 6a 8c 38 50  e6 a8 02 35 f9 e0 33 bc  |...Cj.8P...5..3.|
+00000280  e2 29 09 db 66 8a d9 1c  9a dd cd 96 f8 95 e8 87  |.)..f...........|
+00000290  6e 99 17 03 03 00 1e c8  fe 4f 98 52 76 d3 62 bc  |n........O.Rv.b.|
+000002a0  ed d2 20 e3 05 3c ec 58  fe 4d 87 96 57 ee 94 f8  |.. ..<.X.M..W...|
+000002b0  3a f3 fe 5f 3e 17 03 03  00 13 8e ba f5 f6 e7 ed  |:.._>...........|
+000002c0  d7 ef 6a 7a 0f e8 e3 51  ce 90 a5 ed 96           |..jz...Q.....|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndEd25519Given b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndEd25519Given
index 9878c1ecc0..39b96af39e 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndEd25519Given
+++ b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndEd25519Given
@@ -1,148 +1,148 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 40 1e b6 d9 30  |...........@...0|
-00000010  d9 57 2f 28 6c 09 8d c1  3e 27 0a 68 10 a3 9e 88  |.W/(l...>'.h....|
-00000020  2d d0 dc 8a d6 a7 d5 b4  64 fe 7d 20 09 1f bf 22  |-.......d.} ..."|
-00000030  80 8f c9 fd 67 56 3d 25  fc 8a 86 21 21 73 e2 df  |....gV=%...!!s..|
-00000040  72 fb 55 22 68 e1 b4 fb  16 82 f5 49 00 04 13 01  |r.U"h......I....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 67 86 da 6b c6  |...........g..k.|
+00000010  c1 54 42 ab 97 40 7e b1  34 f1 8a 74 5f 3a f8 04  |.TB..@~.4..t_:..|
+00000020  7a c5 13 59 be 15 98 41  d9 31 33 20 02 66 43 1b  |z..Y...A.13 .fC.|
+00000030  99 2a 51 bd 57 6c e1 d8  f0 7f 5d 3b 06 90 3d d5  |.*Q.Wl....];..=.|
+00000040  04 86 b2 f1 ed 88 a8 75  3d 9f 5b cb 00 04 13 01  |.......u=.[.....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 53  |-.....3.&.$... S|
-000000b0  8c 84 59 9b 88 47 70 88  41 36 ac db 79 7b 1b 5c  |..Y..Gp.A6..y{.\|
-000000c0  73 d3 f3 f9 0e b9 4c a8  fb 6b 22 23 9a cd 49     |s.....L..k"#..I|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 fa  |-.....3.&.$... .|
+000000b0  a0 f1 5e db 21 20 f4 0b  5f af 0c 8f 7f 1f bc 25  |..^.! .._......%|
+000000c0  c5 98 67 29 50 1d 67 18  4d 1d 91 78 68 65 3f     |..g)P.g.M..xhe?|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 09 1f bf 22  |........... ..."|
-00000030  80 8f c9 fd 67 56 3d 25  fc 8a 86 21 21 73 e2 df  |....gV=%...!!s..|
-00000040  72 fb 55 22 68 e1 b4 fb  16 82 f5 49 13 01 00 00  |r.U"h......I....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 02 66 43 1b  |........... .fC.|
+00000030  99 2a 51 bd 57 6c e1 d8  f0 7f 5d 3b 06 90 3d d5  |.*Q.Wl....];..=.|
+00000040  04 86 b2 f1 ed 88 a8 75  3d 9f 5b cb 13 01 00 00  |.......u=.[.....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 b1 ed b3 08 b6 d5  |................|
-00000090  23 a6 3e d5 62 8e 9c 5a  4c aa 53 03 dd 2b 4b 3f  |#.>.b..ZL.S..+K?|
-000000a0  5a 17 03 03 00 3e 27 1c  9d cb b2 1f 1e dd 1c e6  |Z....>'.........|
-000000b0  7a 5d 47 f0 f2 01 48 d3  2b b5 16 5c 41 94 3d ff  |z]G...H.+..\A.=.|
-000000c0  72 5b aa c3 8b ee 58 e3  ed 99 08 85 52 40 b2 47  |r[....X.....R@.G|
-000000d0  65 7b df 40 05 71 64 16  49 c5 79 c3 cc 0b 72 bc  |e{.@.qd.I.y...r.|
-000000e0  b4 f9 78 fd 17 03 03 02  6d 4a 7c 95 64 3f 45 00  |..x.....mJ|.d?E.|
-000000f0  36 94 f4 4f 07 3b 60 cf  e0 c4 8c 83 34 7b bf 93  |6..O.;`.....4{..|
-00000100  1c 22 9a 86 30 a2 d2 e9  ad d2 27 bc af 42 82 2f  |."..0.....'..B./|
-00000110  38 65 30 db ae 64 d4 22  ee 68 db 37 d6 64 7d 28  |8e0..d.".h.7.d}(|
-00000120  b4 1c 98 6d 05 73 e7 f5  9b c9 24 d9 c5 32 c0 4f  |...m.s....$..2.O|
-00000130  68 67 13 a0 d8 28 7d 21  e8 75 51 2a a7 15 31 82  |hg...(}!.uQ*..1.|
-00000140  b6 f1 40 44 6c cb 0e 14  1c e1 c5 ab 1a b5 ff 82  |..@Dl...........|
-00000150  7e dd 4b 02 5a ad c5 63  cf 76 49 93 b2 4b ad 66  |~.K.Z..c.vI..K.f|
-00000160  7c f8 43 c6 f2 c9 25 71  fe 62 5e 28 69 b7 8d 28  ||.C...%q.b^(i..(|
-00000170  df 48 d0 12 f0 0d 18 eb  ff 5b f6 1b 22 ef b7 b3  |.H.......[.."...|
-00000180  e0 6e f6 3d b9 2c d3 df  7e 47 50 e9 53 6e 69 16  |.n.=.,..~GP.Sni.|
-00000190  ea 50 e8 70 9e bc d8 ea  29 77 82 63 79 e7 c3 30  |.P.p....)w.cy..0|
-000001a0  75 6d 41 ea ac 88 aa 28  e0 2f e4 c2 ba 59 4b 20  |umA....(./...YK |
-000001b0  59 1e 7a 67 15 b9 b6 b2  a4 71 da 09 80 bd 50 ad  |Y.zg.....q....P.|
-000001c0  57 1d c9 a0 6d d6 88 c4  e7 b8 e9 27 c7 af 61 03  |W...m......'..a.|
-000001d0  b2 ca 1a 2f ae 67 f9 fe  b6 a9 a3 2e 84 60 42 fc  |.../.g.......`B.|
-000001e0  ae f5 ea 55 fa 77 66 93  32 7f fc 99 a1 5d 8c e2  |...U.wf.2....]..|
-000001f0  9b 05 5b 2e 46 39 57 d8  29 06 73 ec b2 3b aa df  |..[.F9W.).s..;..|
-00000200  ac 51 0b 14 af 16 22 73  7e a5 f0 d7 28 30 a3 a4  |.Q...."s~...(0..|
-00000210  7a b5 e0 01 e4 4b 76 7d  23 6f c6 91 0b bb 39 56  |z....Kv}#o....9V|
-00000220  f3 c6 79 bd 37 58 8b a2  94 35 44 ee d7 d3 dd 4a  |..y.7X...5D....J|
-00000230  0a ed 7b c0 77 13 c5 ba  46 c3 ba c3 3a 87 e8 3f  |..{.w...F...:..?|
-00000240  ce 55 c5 51 39 9b e1 db  fb 3c a6 7d 24 9b b5 34  |.U.Q9....<.}$..4|
-00000250  d3 54 44 7c 01 70 49 c4  1e 28 b5 12 46 17 33 96  |.TD|.pI..(..F.3.|
-00000260  7e 95 b2 02 2a 10 8d 87  5f 36 d3 c9 05 44 81 00  |~...*..._6...D..|
-00000270  f4 55 fa 12 81 cf 6e d5  3a 2f 2a 9b 28 9c 5a 8b  |.U....n.:/*.(.Z.|
-00000280  1a 10 03 53 c3 7b 67 5b  54 ae f8 01 42 24 f5 64  |...S.{g[T...B$.d|
-00000290  e9 c1 be 0f 37 0e 06 cc  b4 7e 79 14 4e 75 a7 b5  |....7....~y.Nu..|
-000002a0  c1 4d eb c8 42 3a 46 bb  b4 a4 87 a0 de 24 d7 58  |.M..B:F......$.X|
-000002b0  00 4d ae f0 f6 4e 44 aa  87 f5 54 37 00 be 1a ab  |.M...ND...T7....|
-000002c0  24 c6 b7 8e 9c 8d 86 64  d4 27 f0 74 88 88 aa df  |$......d.'.t....|
-000002d0  65 d8 62 b4 38 7c 64 7e  47 9c 62 ac d3 d9 2c 20  |e.b.8|d~G.b..., |
-000002e0  5d 3b f6 cd be 58 f9 3e  fc 79 bb 0d c5 af ca d7  |];...X.>.y......|
-000002f0  a8 ea b4 fc e2 3b 2e 91  5c 8c a1 b6 f8 7e d1 05  |.....;..\....~..|
-00000300  da ad 36 17 fc 7d 31 8f  9c b6 9e 17 cf df 50 56  |..6..}1.......PV|
-00000310  3d 5e 12 df a5 88 1a 42  5e 06 5d 98 bb d3 50 1d  |=^.....B^.]...P.|
-00000320  d3 2a fa 7d ed 75 cd 31  74 88 2c 0c 29 5a af ff  |.*.}.u.1t.,.)Z..|
-00000330  72 d2 f4 d4 d7 6d eb 61  50 4c 1a 6d 60 a1 5d d4  |r....m.aPL.m`.].|
-00000340  ee 1e 0c 10 e0 d0 e8 77  e5 f4 b2 72 65 9c f5 97  |.......w...re...|
-00000350  1d ec 01 08 a6 0a 17 03  03 00 99 a0 a0 65 1a bc  |.............e..|
-00000360  a8 c7 b5 28 b7 02 b3 c3  59 fb 87 b8 58 54 ff aa  |...(....Y...XT..|
-00000370  bf 5d 88 e1 8b 76 a1 2e  65 2b f2 3f 16 a0 38 44  |.]...v..e+.?..8D|
-00000380  72 67 5a ce 87 56 54 de  cd 3d 00 97 f9 8b 93 68  |rgZ..VT..=.....h|
-00000390  78 1e 8a 8f 25 41 49 0f  0f f6 62 de d0 a8 e1 22  |x...%AI...b...."|
-000003a0  ee 1f ce 48 0e b6 40 94  06 07 00 0c d0 89 6d 9e  |...H..@.......m.|
-000003b0  09 aa d6 87 c7 df 21 e2  74 79 3e 07 87 da 0c 03  |......!.ty>.....|
-000003c0  5a 4f 52 1a 52 27 4f 87  45 af b5 81 52 9c 0f 3b  |ZOR.R'O.E...R..;|
-000003d0  1e 04 0e 29 e8 74 7b 7d  d3 a6 3d 35 4d cd 54 50  |...).t{}..=5M.TP|
-000003e0  25 a4 43 48 d1 2b d9 f0  d4 12 60 84 ac 04 d6 aa  |%.CH.+....`.....|
-000003f0  43 0a 51 2d 17 03 03 00  35 2a 98 29 36 07 d1 45  |C.Q-....5*.)6..E|
-00000400  76 2c 1f 45 05 3b 18 ab  5d 1e e8 14 ef e7 8e 00  |v,.E.;..].......|
-00000410  94 e2 2d eb b6 64 bb 1a  98 d4 b9 d4 81 4a 48 ea  |..-..d.......JH.|
-00000420  31 a3 42 78 b2 c4 5b 72  26 73 ee 0e 98 47        |1.Bx..[r&s...G|
+00000080  03 03 00 01 01 17 03 03  00 17 9f e2 cb 10 96 be  |................|
+00000090  1b bf 9e d5 95 2d 6b fb  c9 e6 37 29 47 ce 35 a5  |.....-k...7)G.5.|
+000000a0  38 17 03 03 00 3e b8 6c  e6 69 68 16 44 dc 0e 03  |8....>.l.ih.D...|
+000000b0  08 94 bd 21 78 dc 99 b6  50 8c 22 ae d5 89 8f db  |...!x...P.".....|
+000000c0  1b 56 af d3 be e1 13 e4  a5 57 44 2d b0 2b 12 bb  |.V.......WD-.+..|
+000000d0  03 23 b8 ec dc ef 08 cf  54 62 0f 59 f5 b7 d4 5c  |.#......Tb.Y...\|
+000000e0  0a a0 1f 60 17 03 03 02  6d 9d 6c 0c 26 22 f4 c9  |...`....m.l.&"..|
+000000f0  da 32 ef 5f 8a cb 8e 41  27 5c c7 d8 84 86 9a 73  |.2._...A'\.....s|
+00000100  5a da 5e 25 62 b1 97 7d  2b 7e 38 e7 5f fb 15 c7  |Z.^%b..}+~8._...|
+00000110  61 ff 24 db 43 6c fa f8  a1 ee cb 27 85 4a 53 61  |a.$.Cl.....'.JSa|
+00000120  84 1c fe 3e 59 dd fe cf  c7 ea d0 8f 0a 44 7b e9  |...>Y........D{.|
+00000130  31 b3 01 4f ff d8 01 65  84 c4 a0 70 c1 56 f9 43  |1..O...e...p.V.C|
+00000140  ce dc 39 d0 86 54 e2 db  90 7b a9 d5 fd ae ab 83  |..9..T...{......|
+00000150  f6 94 2e 51 45 33 34 0f  0e 1d e4 8d 43 57 92 45  |...QE34.....CW.E|
+00000160  88 48 91 d7 cf 8c 50 e3  83 60 08 e2 0f 51 54 cf  |.H....P..`...QT.|
+00000170  41 c2 8d df b4 88 3b a9  83 cd 16 62 ec 1a f0 cf  |A.....;....b....|
+00000180  59 47 ab f2 de 3f d4 9f  42 00 f9 a1 66 bb 79 24  |YG...?..B...f.y$|
+00000190  60 ed ef ce 70 ca 5a 8d  2c 19 10 c2 f8 66 7d 63  |`...p.Z.,....f}c|
+000001a0  39 77 0d 1c 63 51 8a 4c  ae 4d e5 ce 4c 1b c5 5d  |9w..cQ.L.M..L..]|
+000001b0  94 fe b2 0b d1 1a 1e d3  3d 0f d3 33 ef e7 1b f8  |........=..3....|
+000001c0  a4 f2 ba 0a 3a 21 61 7b  2f 92 c0 d4 a6 75 a2 f4  |....:!a{/....u..|
+000001d0  d3 40 e3 73 e1 b1 2e 59  75 60 c2 07 88 6d 7f 59  |.@.s...Yu`...m.Y|
+000001e0  9b 57 3c e9 e2 63 da 0a  76 83 ee 4f df df 49 75  |.W<..c..v..O..Iu|
+000001f0  55 68 87 eb 9f f8 da 9f  84 04 78 06 b8 e8 f0 a4  |Uh........x.....|
+00000200  bb 54 16 82 f8 20 08 ba  36 14 64 56 76 54 9b 2b  |.T... ..6.dVvT.+|
+00000210  f4 06 07 04 de e8 8b 7a  fc 24 a1 ea 88 a7 78 da  |.......z.$....x.|
+00000220  ec 6a 7a ab 7c 60 e1 bc  6d fa 8c 88 36 cd 0c 57  |.jz.|`..m...6..W|
+00000230  2f cd 4e 1f 3b 55 b0 29  c5 e7 36 0f bd 97 3d 2b  |/.N.;U.)..6...=+|
+00000240  00 a6 26 b8 6e 0b 27 66  39 07 24 b7 b4 06 c1 69  |..&.n.'f9.$....i|
+00000250  96 bc 79 59 4a 03 6f 1e  05 6f c3 0c ce 20 c5 b8  |..yYJ.o..o... ..|
+00000260  35 90 f2 26 95 00 c0 bb  c3 14 f9 2a aa 4f c0 f3  |5..&.......*.O..|
+00000270  89 86 57 77 a3 89 80 a6  66 b1 08 47 11 c5 f5 24  |..Ww....f..G...$|
+00000280  72 f6 16 62 65 1e 7c b0  49 38 34 35 53 2d 6b 80  |r..be.|.I845S-k.|
+00000290  1d d9 e1 d3 aa 01 66 6f  84 12 5b 99 30 25 2a 8c  |......fo..[.0%*.|
+000002a0  4b 24 12 4e 56 4c b0 c8  c1 31 bf dd da 9d 78 a7  |K$.NVL...1....x.|
+000002b0  22 01 cb 5c ae 15 90 4a  6b 67 78 43 74 3f f1 99  |"..\...JkgxCt?..|
+000002c0  a5 8c 37 1b 93 00 52 73  4b 46 4b 26 68 82 33 5d  |..7...RsKFK&h.3]|
+000002d0  3d b9 83 07 0e 6d 09 40  d1 07 42 5c de e5 f8 42  |=....m.@..B\...B|
+000002e0  4a d9 40 9a 65 b4 6f 81  c8 ab eb 40 6e f8 0a 9e  |J.@.e.o....@n...|
+000002f0  84 54 3e e1 7a 95 13 98  95 26 ff d0 27 f7 1d b0  |.T>.z....&..'...|
+00000300  28 b7 db 57 1d c9 4f d5  6c 56 03 92 61 fc 05 c4  |(..W..O.lV..a...|
+00000310  d3 5e 55 4d d7 03 b5 2b  87 73 c0 fe 04 c4 38 15  |.^UM...+.s....8.|
+00000320  22 01 49 ae da fc 79 5c  d7 4d 12 11 47 4d 80 b3  |".I...y\.M..GM..|
+00000330  86 e4 68 60 d8 3b cf ab  b5 12 9f 4c f1 04 62 e0  |..h`.;.....L..b.|
+00000340  64 dd 1b 75 b1 19 aa 54  63 d6 f8 27 a8 93 0f 6c  |d..u...Tc..'...l|
+00000350  8d f6 26 3a 38 36 17 03  03 00 99 d0 c7 7b 47 07  |..&:86.......{G.|
+00000360  d9 50 aa 5e ad 9b d5 30  43 be 14 06 57 60 3d 35  |.P.^...0C...W`=5|
+00000370  e9 a9 69 c3 6d 92 f4 35  8a ab 44 9d fe 39 f6 b8  |..i.m..5..D..9..|
+00000380  22 db 72 21 0d 39 09 60  35 77 38 63 81 3d ef 5f  |".r!.9.`5w8c.=._|
+00000390  55 b1 11 27 08 89 4a d2  c4 58 bb 37 07 3c 03 3b  |U..'..J..X.7.<.;|
+000003a0  1c 5b f0 d5 d0 09 ca bb  46 e1 af 9b 06 cc a4 7d  |.[......F......}|
+000003b0  56 82 17 09 b8 a4 2e da  71 e1 45 a1 49 d0 43 be  |V.......q.E.I.C.|
+000003c0  42 75 d1 4e e2 53 80 73  09 6c dc d6 21 51 08 90  |Bu.N.S.s.l..!Q..|
+000003d0  3b d0 52 35 04 54 69 9d  84 cb 3f ce 9f 75 74 c0  |;.R5.Ti...?..ut.|
+000003e0  03 6c 52 b3 75 46 2a 62  60 34 81 85 e6 1c 3f 00  |.lR.uF*b`4....?.|
+000003f0  15 46 d4 4e 17 03 03 00  35 41 e8 e3 54 dc a3 d1  |.F.N....5A..T...|
+00000400  90 58 f9 21 08 17 f6 8d  b7 2f f2 94 b4 5a 89 99  |.X.!...../...Z..|
+00000410  04 7c 02 65 d7 11 2d ee  cf 4c ae 84 2f b0 6a b3  |.|.e..-..L../.j.|
+00000420  c5 5d 17 4d 4f 9f 38 65  29 70 43 37 69 71        |.].MO.8e)pC7iq|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 01 50 b6 3d c2 a4 ba  |..........P.=...|
-00000010  60 55 e6 40 0c 30 6b 5d  cc 4c 09 98 96 65 bd 9b  |`U.@.0k].L...e..|
-00000020  f0 e3 f2 6b 34 11 e1 79  bf cf 95 15 77 29 ef 63  |...k4..y....w).c|
-00000030  0f ce a4 7a aa 14 80 34  e3 09 0b b9 87 f7 e3 7d  |...z...4.......}|
-00000040  26 a4 83 ad e4 a1 ef 38  b7 aa 8c ea 9a 96 53 b1  |&......8......S.|
-00000050  4a 78 b7 eb 16 c0 89 10  ba af 9b d5 e7 ee f2 bd  |Jx..............|
-00000060  86 f2 80 dc 47 7e 84 c5  3c 22 40 85 0c 62 71 61  |....G~..<"@..bqa|
-00000070  e2 c7 f6 80 9a 40 7d 81  71 00 76 1d 72 39 7b ad  |.....@}.q.v.r9{.|
-00000080  4b 2a 65 5f a6 7b e2 a6  45 de 5f 60 9d f7 d7 cb  |K*e_.{..E._`....|
-00000090  7f 1f ba 2c cd fa 33 00  c7 de b3 e1 f9 5b 9b 3f  |...,..3......[.?|
-000000a0  eb 59 24 c0 f6 fb f7 fa  11 f0 ea 99 b3 cc 93 8c  |.Y$.............|
-000000b0  9a 43 6b b2 f4 6f cd 87  25 a4 c6 a8 77 4f 05 04  |.Ck..o..%...wO..|
-000000c0  78 a4 0d ef b4 dd b3 7c  6b 00 3e d2 1d b1 0a fa  |x......|k.>.....|
-000000d0  ab cf a5 8d 95 92 de eb  78 ce 3c 29 da 01 d6 4f  |........x.<)...O|
-000000e0  aa d4 a6 20 8f 87 2b 8c  11 4e 10 85 d4 0c 9e 23  |... ..+..N.....#|
-000000f0  09 f1 06 1d 31 1e d1 b5  3f b3 cf 12 2a c1 f8 30  |....1...?...*..0|
-00000100  59 97 06 3c 7c 09 17 ac  f5 6a ce fc a4 00 dc dd  |Y..<|....j......|
-00000110  ab 7c 9a b3 97 c8 c3 ed  be d2 a5 25 bb e7 cc 6b  |.|.........%...k|
-00000120  d9 29 9e 67 77 2b ec f3  b4 94 e9 bf fd 76 ff 57  |.).gw+.......v.W|
-00000130  c4 da 8f 1e d1 de 28 32  e4 22 0c 51 52 b2 9c 75  |......(2.".QR..u|
-00000140  7c 26 83 1e a2 39 b8 76  eb 0e 93 c3 35 be f0 3a  ||&...9.v....5..:|
-00000150  13 ae 99 da 73 3c ee 78  a9 b8 72 17 03 03 00 59  |....s<.x..r....Y|
-00000160  9a 16 31 a8 6a ac b6 a0  a3 b2 d4 6a 17 cd 43 e4  |..1.j......j..C.|
-00000170  4d e3 3e 33 fb 30 ca 89  8c 1d 82 ce 41 44 ec 08  |M.>3.0......AD..|
-00000180  bc ad 97 27 e8 b2 83 05  f5 0f a0 47 79 f3 f5 9c  |...'.......Gy...|
-00000190  de 4d 55 27 a3 12 91 29  8b ea a3 35 ce 7d dd 88  |.MU'...)...5.}..|
-000001a0  fa 81 59 a2 fb 43 0a f3  b4 f8 9c 95 c0 e3 58 86  |..Y..C........X.|
-000001b0  fa d6 5f 02 ee 90 ac ab  b1 17 03 03 00 35 97 c6  |.._..........5..|
-000001c0  ff 66 1b 4f 7f c4 bb a6  99 45 df f0 e9 13 48 79  |.f.O.....E....Hy|
-000001d0  57 00 cc 9f 4f e1 dc 6a  c4 b5 77 a6 09 3e 48 34  |W...O..j..w..>H4|
-000001e0  6a 8c b3 32 a1 71 60 fd  9a ee 61 0a fc f4 94 18  |j..2.q`...a.....|
-000001f0  57 c6 19                                          |W..|
+00000000  14 03 03 00 01 01 17 03  03 01 50 39 26 3f 21 c8  |..........P9&?!.|
+00000010  e3 65 97 00 ab 5c 99 50  0a d0 21 ff 0e a9 9f 89  |.e...\.P..!.....|
+00000020  50 e5 e5 ec 59 6a 19 82  99 b7 41 24 61 1f 3e dd  |P...Yj....A$a.>.|
+00000030  d6 a7 eb 12 1d 6f cd bc  ff ba ac 80 78 2d 43 42  |.....o......x-CB|
+00000040  a5 0b be 99 04 e4 c1 45  20 9b a1 96 a8 e2 72 a7  |.......E .....r.|
+00000050  7a 47 fe 0b c1 f6 4f 76  88 39 36 61 be f1 12 75  |zG....Ov.96a...u|
+00000060  20 e5 46 f5 0d 33 a4 57  82 aa 95 73 c6 d2 45 6a  | .F..3.W...s..Ej|
+00000070  77 a8 3c 93 13 33 84 41  b5 b7 79 15 77 e3 87 e9  |w.<..3.A..y.w...|
+00000080  54 30 08 a1 d2 12 1f b1  e0 2b 22 1c af 77 09 82  |T0.......+"..w..|
+00000090  46 e1 f6 e8 17 86 7f 4f  ba 9d f0 ba 7a 27 6a f4  |F......O....z'j.|
+000000a0  fa c6 44 c1 19 6b 66 40  cc a5 0c 14 8f b2 08 7a  |..D..kf@.......z|
+000000b0  2f 05 98 7a 1d 30 de 01  99 a9 b5 d9 f2 57 47 8a  |/..z.0.......WG.|
+000000c0  74 a6 b0 0b a7 62 49 7b  c6 81 1f 10 ac e0 8d 4e  |t....bI{.......N|
+000000d0  94 79 4f f5 56 eb 9d d2  76 31 18 6e 8e 72 e8 ba  |.yO.V...v1.n.r..|
+000000e0  80 5c 84 52 15 a0 09 67  5f f0 8a e8 7b 15 4c e7  |.\.R...g_...{.L.|
+000000f0  fe b7 99 de 7c 69 d6 74  bb 6d dd c9 7c e6 b0 02  |....|i.t.m..|...|
+00000100  32 0d ef bf c9 de 76 6d  9e 7c 9d c0 ce c4 db 33  |2.....vm.|.....3|
+00000110  28 e9 e2 ca ad b2 55 1e  4d 21 33 c5 05 fc bc e8  |(.....U.M!3.....|
+00000120  f6 93 54 ab c8 de 99 69  c1 4d 58 8c 3f bc 0d bb  |..T....i.MX.?...|
+00000130  f1 55 4d 00 38 1a 99 8c  13 6d 27 3a 63 9f 51 64  |.UM.8....m':c.Qd|
+00000140  20 b6 87 88 b8 e3 da 3d  a7 ff 38 7c c6 de 8a 88  | ......=..8|....|
+00000150  e4 b1 f1 51 37 d6 48 7b  13 25 81 17 03 03 00 59  |...Q7.H{.%.....Y|
+00000160  75 09 53 f0 4d 25 f4 9f  cd ed e6 05 34 09 f2 fc  |u.S.M%......4...|
+00000170  92 fd 58 86 b8 2e 2a 67  a3 b1 07 6c 9b 61 8e 59  |..X...*g...l.a.Y|
+00000180  ce 58 58 2b 9f fa 53 54  80 91 4c c4 e8 6a 1a bb  |.XX+..ST..L..j..|
+00000190  4a c5 76 56 cd 2d 2a 22  de ed e9 59 0f 62 18 2f  |J.vV.-*"...Y.b./|
+000001a0  46 85 fe fb 43 83 32 b0  c4 74 de a1 b6 31 ee 40  |F...C.2..t...1.@|
+000001b0  d8 ef 32 c1 3f 99 6d 1c  59 17 03 03 00 35 82 0b  |..2.?.m.Y....5..|
+000001c0  06 89 ce f6 cd e1 04 3c  63 06 97 fc c5 d5 6c 5c  |.......<c.....l\|
+000001d0  2e 66 fa 0b 95 63 50 a8  46 ba 54 3b 01 1a b8 79  |.f...cP.F.T;...y|
+000001e0  52 55 17 c8 76 93 66 d0  f0 64 1f a1 20 15 98 ee  |RU..v.f..d.. ...|
+000001f0  5f e0 73                                          |_.s|
 >>> Flow 4 (server to client)
-00000000  17 03 03 01 be f9 61 23  3a 18 47 1e bd 6b 35 3c  |......a#:.G..k5<|
-00000010  81 14 80 f4 7c 37 6b ed  31 57 ee e5 11 85 1d 0f  |....|7k.1W......|
-00000020  22 ee 33 f3 c6 94 22 dc  de cd a0 97 fb de 0f 32  |".3..."........2|
-00000030  be 73 3e db 6b b6 26 b3  3f e5 27 35 e2 37 57 56  |.s>.k.&.?.'5.7WV|
-00000040  81 9a 6e 7a 36 18 20 f4  8e 8f 03 cd 8f d8 db b3  |..nz6. .........|
-00000050  ea 15 da 67 74 64 94 21  77 75 7f e7 f6 49 99 05  |...gtd.!wu...I..|
-00000060  23 d9 24 5b b9 06 1b fe  76 70 7f f7 cf 35 13 e2  |#.$[....vp...5..|
-00000070  fb 61 ca 2b 52 fb e6 fc  ea ec ed b3 35 02 38 7d  |.a.+R.......5.8}|
-00000080  50 b9 e4 3e b4 21 d3 b0  20 03 ee e3 76 df 42 5b  |P..>.!.. ...v.B[|
-00000090  27 0e 5b 89 82 cb dd e2  68 a4 41 5c a8 d9 4d 0e  |'.[.....h.A\..M.|
-000000a0  87 8a 2e 77 80 ca 24 dc  67 0f 06 83 6e 55 fc ef  |...w..$.g...nU..|
-000000b0  96 0c 19 3a cd 90 cc 45  07 3e c1 cf 84 8a be 42  |...:...E.>.....B|
-000000c0  c6 47 2a 54 c6 89 bf 50  ee 1a 48 18 b5 0f d7 6b  |.G*T...P..H....k|
-000000d0  08 94 3c b7 c0 22 d4 4d  eb 54 50 ec 02 69 12 98  |..<..".M.TP..i..|
-000000e0  67 39 46 6c d3 f6 57 73  ed f7 f2 43 8a e0 b3 ed  |g9Fl..Ws...C....|
-000000f0  e3 49 41 f1 38 ce ed 21  d5 22 7c db a1 cc 23 59  |.IA.8..!."|...#Y|
-00000100  38 ef 7d ec 23 95 12 90  c4 bc 29 09 ac c4 92 89  |8.}.#.....).....|
-00000110  61 eb 08 65 ab 2f 70 1e  1b 1d 97 7f 80 79 85 69  |a..e./p......y.i|
-00000120  c5 93 e6 d5 ff 91 f1 29  a8 9a c7 62 72 ee f6 4b  |.......)...br..K|
-00000130  7c d8 7d d5 f8 30 db f4  1d a8 1d d7 68 52 11 27  ||.}..0......hR.'|
-00000140  27 cb 62 af 75 cb 73 7b  8e ee 69 b6 42 bd 2d ea  |'.b.u.s{..i.B.-.|
-00000150  f3 74 e7 2e 5b 0c dd 1a  d1 af e4 3c c9 7b 55 a3  |.t..[......<.{U.|
-00000160  dd d2 11 02 cb 98 b1 46  67 f1 76 96 1e 4d 0f ac  |.......Fg.v..M..|
-00000170  29 07 f5 3c a6 0e d3 97  1a f5 7e 3b 60 bf 8c 68  |)..<......~;`..h|
-00000180  99 a0 ae 48 56 b3 87 57  c7 d3 77 3b f8 39 55 47  |...HV..W..w;.9UG|
-00000190  e6 ac f1 b2 ff a4 a1 37  38 73 6e 9a 96 e6 17 e2  |.......78sn.....|
-000001a0  aa f3 b7 d5 cc 76 a6 74  2f 87 04 e4 f5 e2 73 4c  |.....v.t/.....sL|
-000001b0  a7 ed d0 9b 43 f9 57 b0  59 ac e9 fd 2b ff 3f ff  |....C.W.Y...+.?.|
-000001c0  0b 05 6c 17 03 03 00 1e  4a 76 aa 8c bf 6e 14 7a  |..l.....Jv...n.z|
-000001d0  cc 6b f8 ce 01 ee 5f 0a  7a f0 4d 59 ba a8 3f 7a  |.k...._.z.MY..?z|
-000001e0  66 62 b9 4c 7a 90 17 03  03 00 13 ac 76 f9 79 f1  |fb.Lz.......v.y.|
-000001f0  4b d8 92 39 f7 24 83 03  c6 0a 57 0c 95 4a        |K..9.$....W..J|
+00000000  17 03 03 01 bf 86 6d ae  0b c9 d7 bc cc 6e 1a 07  |......m......n..|
+00000010  4d 58 50 d5 1a 15 5c 8a  4b de c3 83 5c d5 82 95  |MXP...\.K...\...|
+00000020  ed 24 9c 12 f7 05 7a 6b  81 dc c0 99 58 af 3e 68  |.$....zk....X.>h|
+00000030  36 0c 9c c6 84 61 36 03  58 59 d3 d4 24 ca 63 b4  |6....a6.XY..$.c.|
+00000040  fd 82 f4 d5 fa 65 4f fd  f1 0d 52 a3 3d 12 36 a7  |.....eO...R.=.6.|
+00000050  0a f6 fa a8 74 81 9a 10  72 ef d6 7b 9d fc 71 a0  |....t...r..{..q.|
+00000060  35 7a a9 dd b9 8b 34 1e  d6 e5 53 6c 62 22 d2 89  |5z....4...Slb"..|
+00000070  f6 43 33 51 76 fe 7f 65  06 d4 4d aa 74 a9 4a e6  |.C3Qv..e..M.t.J.|
+00000080  52 3c 3a ae 03 e3 a9 52  b1 0d ba 14 e5 be d1 ff  |R<:....R........|
+00000090  60 c7 66 11 5c 72 e7 46  da 8d 3c 9e 54 84 4f 70  |`.f.\r.F..<.T.Op|
+000000a0  7b 40 36 f5 33 5d 0b b0  09 74 cf 60 db 3f 40 1d  |{@6.3]...t.`.?@.|
+000000b0  4a 9e c4 a8 24 ef e0 af  49 89 4e 06 68 1a 56 d9  |J...$...I.N.h.V.|
+000000c0  31 f7 f4 66 5b 18 00 af  b6 01 91 79 cf 14 08 cd  |1..f[......y....|
+000000d0  2d a2 b8 82 89 a9 62 9e  a7 84 c2 3d 15 fd 9a 33  |-.....b....=...3|
+000000e0  12 2d 6c e3 c9 83 7c cf  b1 fb 7a a3 48 c6 ce 62  |.-l...|...z.H..b|
+000000f0  1f 83 0b f2 b9 b9 36 55  56 5c ca 5e 96 fa d4 06  |......6UV\.^....|
+00000100  f3 ba 09 c5 44 df ce 14  ce d8 35 8c 0f fe e4 fd  |....D.....5.....|
+00000110  bf ce 9e c5 8b 12 0c 94  64 13 4e b7 62 0d ba 62  |........d.N.b..b|
+00000120  ff 2c f6 55 f3 23 48 a5  9a a2 e5 f4 b5 16 3a 10  |.,.U.#H.......:.|
+00000130  08 90 e6 1e 24 55 eb 56  64 18 3c d4 e7 5d b6 41  |....$U.Vd.<..].A|
+00000140  a3 69 e8 06 a0 a2 13 92  84 c4 79 fd a1 22 a8 a2  |.i........y.."..|
+00000150  1e d4 b1 d3 33 61 87 97  6d 82 f0 cb b4 c0 02 76  |....3a..m......v|
+00000160  49 6e 0b 1c 6f 02 57 40  da be 2d c2 67 46 60 c3  |In..o.W@..-.gF`.|
+00000170  9f bc fb d5 2f e0 09 bf  ed 7a 2b c1 74 8f ea 2c  |..../....z+.t..,|
+00000180  2b 8b d7 dd 23 e7 85 7c  4f cc f6 36 ee 13 2b 3c  |+...#..|O..6..+<|
+00000190  0a 8f 96 61 33 b2 65 3a  73 6a 46 a5 55 73 47 57  |...a3.e:sjF.UsGW|
+000001a0  05 f4 73 65 1e 2a 56 e9  e2 a1 00 f7 88 8a f0 9d  |..se.*V.........|
+000001b0  2f c9 98 c2 19 9e 7e 4a  a4 f2 43 0f 4a 61 8d e4  |/.....~J..C.Ja..|
+000001c0  87 82 42 f8 17 03 03 00  1e ea fb cd 51 7d 28 30  |..B.........Q}(0|
+000001d0  71 79 ba 81 d1 48 0b 8b  54 d7 c6 5e 82 f7 30 b2  |qy...H..T..^..0.|
+000001e0  37 a6 16 56 fb 8d 12 17  03 03 00 13 8a 90 f9 9e  |7..V............|
+000001f0  9c d5 77 53 f0 48 6f 72  ae b3 1c 58 89 1d 66     |..wS.Hor...X..f|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndGiven b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndGiven
index b01d5301d3..88562c7676 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndGiven
+++ b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndGiven
@@ -1,177 +1,176 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 4f de d7 58 dd  |...........O..X.|
-00000010  16 7a 68 25 12 f9 5b 58  6c c4 d9 1a 1d 09 b0 0e  |.zh%..[Xl.......|
-00000020  8f 20 10 5b 75 aa a6 67  4f 35 9e 20 02 03 10 7f  |. .[u..gO5. ....|
-00000030  60 84 8f 68 a4 ce cb c2  ef 77 3d 7f 86 2e e7 33  |`..h.....w=....3|
-00000040  3d 36 63 8d bc 68 88 f1  2f 68 62 f7 00 04 13 01  |=6c..h../hb.....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 12 f6 c1 74 9d  |..............t.|
+00000010  95 3e ce 1e 1b 6b f1 b6  ca ad 92 7f bf be 77 14  |.>...k........w.|
+00000020  0b 19 61 bd b3 36 53 d9  7a 26 2d 20 c2 f5 69 6b  |..a..6S.z&- ..ik|
+00000030  4a e0 99 ed 41 bf 8e 13  be e2 27 4e 47 6f 23 f3  |J...A.....'NGo#.|
+00000040  f7 8a 8e 75 91 08 6f a9  ba ed da dd 00 04 13 01  |...u..o.........|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 9e  |-.....3.&.$... .|
-000000b0  09 b9 66 03 aa 02 2e 71  e4 a3 31 5b a9 f9 a8 4e  |..f....q..1[...N|
-000000c0  3a a8 36 77 ca 74 a1 f6  41 2c a3 b7 55 00 27     |:.6w.t..A,..U.'|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 02  |-.....3.&.$... .|
+000000b0  70 47 c1 8a f4 c2 0d dd  c9 c8 21 ef b8 03 07 f4  |pG........!.....|
+000000c0  7d cf d1 d3 12 69 f3 87  0f a1 9a c7 10 16 7f     |}....i.........|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 02 03 10 7f  |........... ....|
-00000030  60 84 8f 68 a4 ce cb c2  ef 77 3d 7f 86 2e e7 33  |`..h.....w=....3|
-00000040  3d 36 63 8d bc 68 88 f1  2f 68 62 f7 13 01 00 00  |=6c..h../hb.....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 c2 f5 69 6b  |........... ..ik|
+00000030  4a e0 99 ed 41 bf 8e 13  be e2 27 4e 47 6f 23 f3  |J...A.....'NGo#.|
+00000040  f7 8a 8e 75 91 08 6f a9  ba ed da dd 13 01 00 00  |...u..o.........|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 f8 88 ec 38 ea 22  |.............8."|
-00000090  23 5f e5 c9 a5 7c 19 12  7a 57 65 3f 41 4d d5 f7  |#_...|..zWe?AM..|
-000000a0  87 17 03 03 00 3e 50 76  ed c0 b5 0d f0 f0 01 94  |.....>Pv........|
-000000b0  0e 5b f0 7c 2c be b7 2c  e1 1f 2e d9 17 62 84 e5  |.[.|,..,.....b..|
-000000c0  2f 5a 84 bc 80 41 7b 07  56 b4 53 74 e6 3a ce 8e  |/Z...A{.V.St.:..|
-000000d0  c4 0a 64 35 ba 91 24 49  a2 23 98 85 77 89 9a d2  |..d5..$I.#..w...|
-000000e0  cd 38 06 6b 17 03 03 02  6d 2e 8f 37 ba ec b7 03  |.8.k....m..7....|
-000000f0  a3 76 a2 89 b4 27 e7 22  8a 03 c7 0e 90 c0 43 6b  |.v...'."......Ck|
-00000100  42 73 c7 a7 7c 1e 9c 3b  5b 70 c2 e4 b3 f6 26 67  |Bs..|..;[p....&g|
-00000110  ba 05 5f c8 10 9c 27 98  01 d6 b2 27 a2 d8 d4 95  |.._...'....'....|
-00000120  7e 3e 80 ee 82 a0 d0 42  95 24 84 39 7c 9d fa b8  |~>.....B.$.9|...|
-00000130  bd 5f 01 f7 52 03 a5 ee  cb 8d 57 2a 94 36 c9 f8  |._..R.....W*.6..|
-00000140  b5 07 75 33 e0 1d 38 70  5d 3d 0e 15 3c fb 7d 48  |..u3..8p]=..<.}H|
-00000150  55 9b a3 30 43 11 a3 f6  53 de 38 86 1c c8 f0 91  |U..0C...S.8.....|
-00000160  db 32 46 38 d8 e5 a7 74  46 76 79 b8 cc b9 3c 5e  |.2F8...tFvy...<^|
-00000170  75 61 45 26 ea 87 49 b1  ad f8 72 e7 3f f9 f3 f0  |uaE&..I...r.?...|
-00000180  20 06 65 91 d6 b5 ef 27  88 f3 5b de f2 b4 66 94  | .e....'..[...f.|
-00000190  66 39 f6 e8 b5 3a 30 53  0e 38 a6 02 75 00 04 13  |f9...:0S.8..u...|
-000001a0  f4 99 c5 fa 6c d5 3f 3e  69 85 03 a2 8e 03 a6 ae  |....l.?>i.......|
-000001b0  15 89 fa 32 0b ee 4a e9  dd 41 51 e3 ed 9f 78 df  |...2..J..AQ...x.|
-000001c0  19 d6 2a 9e cb 18 68 51  58 f0 60 6d 06 97 e8 2c  |..*...hQX.`m...,|
-000001d0  5a 10 b0 79 e9 a9 78 2e  d5 b2 50 5a 82 49 20 79  |Z..y..x...PZ.I y|
-000001e0  5b 8e 3d cc 5e ca a0 75  7c bd 62 ba 58 d4 d9 29  |[.=.^..u|.b.X..)|
-000001f0  85 ad 69 31 2c d1 c2 84  01 d2 23 63 79 9f 3e 85  |..i1,.....#cy.>.|
-00000200  8a 0e 33 4e 12 b4 2d c8  b9 62 45 d9 41 6e ae ef  |..3N..-..bE.An..|
-00000210  7c 1d df 1e dc 3d 3f b8  4e 68 ef 23 2b 23 9a 4e  ||....=?.Nh.#+#.N|
-00000220  21 00 22 02 1d 24 45 58  b6 51 17 bd cd fb b0 7d  |!."..$EX.Q.....}|
-00000230  5d d4 de 81 7a 4f e3 d6  87 a7 0e 26 c4 df 92 96  |]...zO.....&....|
-00000240  98 14 fa aa 22 e8 15 f1  b7 d1 d2 8e 3d c4 0c 71  |....".......=..q|
-00000250  72 29 fd 00 c7 ed b7 45  a1 51 55 41 51 d2 a3 be  |r).....E.QUAQ...|
-00000260  08 a9 31 6c 51 9a ab 5a  b6 a6 33 29 72 c9 a4 ad  |..1lQ..Z..3)r...|
-00000270  f1 c2 9c 59 41 34 9a 65  17 a4 21 fd 93 fb 2e 92  |...YA4.e..!.....|
-00000280  55 d6 20 00 9f 31 dc 6e  02 b8 71 68 6b 36 53 e2  |U. ..1.n..qhk6S.|
-00000290  92 04 2f f1 4a cd 27 3f  e4 e2 ca 6d b9 95 3d b0  |../.J.'?...m..=.|
-000002a0  ff 7b f4 f1 33 f9 fb 32  86 1e 7e 9c 5f 68 83 04  |.{..3..2..~._h..|
-000002b0  96 98 31 16 0f ca 71 e6  c0 ad f4 69 a0 b2 dc 8b  |..1...q....i....|
-000002c0  6d 61 2e 70 15 80 89 29  13 80 b9 45 43 57 45 f7  |ma.p...)...ECWE.|
-000002d0  17 74 70 7f 2f b8 02 4d  1f 15 4c 31 ec 8c 26 4a  |.tp./..M..L1..&J|
-000002e0  c4 eb c1 92 6b c4 48 3c  54 e9 d8 0b 89 a4 c4 00  |....k.H<T.......|
-000002f0  ba b4 5a 92 8d 00 af bc  ef 32 9b 41 fa 80 ff 44  |..Z......2.A...D|
-00000300  26 42 94 f1 21 e4 e2 b2  6c 3d 43 37 e1 7e 19 62  |&B..!...l=C7.~.b|
-00000310  4b 2b e1 b7 62 70 42 be  64 ae 10 f2 b3 9b fa 52  |K+..bpB.d......R|
-00000320  be 23 7a 16 f2 60 d8 91  c4 aa d6 2e 8f 35 f2 65  |.#z..`.......5.e|
-00000330  29 af 09 ff 8a 57 02 fb  3e 11 9e c7 15 db de 35  |)....W..>......5|
-00000340  8b a8 81 de 50 7b 89 8a  2d d8 66 2b de a1 f0 4d  |....P{..-.f+...M|
-00000350  00 52 89 ae a0 9b 17 03  03 00 99 88 04 b0 7b c8  |.R............{.|
-00000360  03 34 60 a9 2a 0c 3b 63  ba bb 83 84 b1 55 f1 75  |.4`.*.;c.....U.u|
-00000370  ec 54 2e 6a bb 8a b9 e9  d7 d9 08 3f 56 34 5c 47  |.T.j.......?V4\G|
-00000380  fe 09 64 60 1e 4f e9 91  3f 18 68 1a f8 8a 11 80  |..d`.O..?.h.....|
-00000390  48 50 93 37 c3 b6 fc e8  da e9 e6 5d c9 0b f7 ad  |HP.7.......]....|
-000003a0  cd ed a7 7e 1d ee 03 9a  8f be 66 73 c7 b7 ab a1  |...~......fs....|
-000003b0  26 71 1f a7 d0 e7 67 02  b3 41 49 db 3b 0c 1f 41  |&q....g..AI.;..A|
-000003c0  56 59 eb 5a 5f 4f 87 6b  72 d4 35 d7 54 1f fa 5c  |VY.Z_O.kr.5.T..\|
-000003d0  a6 08 4f 16 46 5e 93 a2  95 5a 2d ce cd c0 c6 35  |..O.F^...Z-....5|
-000003e0  ac d4 cb 32 58 16 66 53  08 26 8e 68 24 14 72 98  |...2X.fS.&.h$.r.|
-000003f0  b5 0e bd da 17 03 03 00  35 52 71 08 e7 71 9d 1e  |........5Rq..q..|
-00000400  95 08 6c 92 d2 d3 8c 17  c2 69 9c c0 8d c2 ac 8b  |..l......i......|
-00000410  08 4e 53 b9 c3 32 13 ba  3c b7 b2 e4 c1 f4 d3 a8  |.NS..2..<.......|
-00000420  49 06 e4 b3 f5 85 31 60  f1 c5 40 1e 8f 85        |I.....1`..@...|
+00000080  03 03 00 01 01 17 03 03  00 17 f7 25 d5 70 bd 01  |...........%.p..|
+00000090  8b 45 ae 7b ac 0e 0b 5c  d7 1b e2 42 7c 8f 49 e3  |.E.{...\...B|.I.|
+000000a0  cf 17 03 03 00 3e 3e c0  a8 0b 56 dd 1a b7 37 4c  |.....>>...V...7L|
+000000b0  31 a0 ba d7 3d 0b b6 98  7a aa 4b d9 6f 08 1d 33  |1...=...z.K.o..3|
+000000c0  9f 48 3a f8 9c 21 b7 da  49 26 15 5d 73 32 25 33  |.H:..!..I&.]s2%3|
+000000d0  0f 42 9d 6d 51 51 12 20  00 81 d6 09 3f 64 87 75  |.B.mQQ. ....?d.u|
+000000e0  99 2c 75 4d 17 03 03 02  6d 80 c5 73 16 7f d8 89  |.,uM....m..s....|
+000000f0  61 d8 f0 6f 81 86 61 77  bc bc 7e b9 bd 06 5f 58  |a..o..aw..~..._X|
+00000100  dc ca 9e 98 43 8f 6b eb  7a 28 e1 a4 61 a1 ad 1e  |....C.k.z(..a...|
+00000110  bd cc ab 0f f5 fc cb 50  a5 58 b8 f6 ce 63 8b a7  |.......P.X...c..|
+00000120  9b 71 91 cd 1d 68 11 dd  54 ad 1b 69 6f a8 43 29  |.q...h..T..io.C)|
+00000130  88 8d 6d 37 9f de 20 af  d3 9a 3a 42 ce e5 86 f1  |..m7.. ...:B....|
+00000140  43 4d 38 fd 22 fd 5c 32  bf e7 0f f9 e2 1a c7 da  |CM8.".\2........|
+00000150  05 a3 17 29 51 96 37 93  0b 9e 8c 94 cc d3 50 39  |...)Q.7.......P9|
+00000160  2a 3a 93 a8 09 7d a7 99  06 d8 af e5 d2 a1 1e b0  |*:...}..........|
+00000170  6c 3c 19 f0 4a 9a aa fa  25 4c 72 bf f7 52 fd 8d  |l<..J...%Lr..R..|
+00000180  f9 36 c1 76 15 22 8c cc  17 42 22 48 96 b3 6f 76  |.6.v."...B"H..ov|
+00000190  ae a8 8d 65 0a ab 1d ce  bd 86 4d 02 32 13 67 ff  |...e......M.2.g.|
+000001a0  10 78 c5 97 5c 73 fb c1  a5 de fb ae 34 ff 1e fa  |.x..\s......4...|
+000001b0  e0 62 a9 df 49 c0 24 35  06 79 69 24 69 52 c8 93  |.b..I.$5.yi$iR..|
+000001c0  e7 aa 9c 7d a7 00 64 67  b2 2e 5f 6b 3e cb b0 29  |...}..dg.._k>..)|
+000001d0  cc 3f 33 da 7b e7 c8 f4  11 74 e5 4b 72 7d 64 92  |.?3.{....t.Kr}d.|
+000001e0  c6 6b 62 5f a9 de 2b d1  63 1d f5 16 dc 72 a5 24  |.kb_..+.c....r.$|
+000001f0  d2 63 32 0a 2e e2 6e 35  76 c2 58 4f 8c ef e8 72  |.c2...n5v.XO...r|
+00000200  cf ba e9 e9 81 1e 35 9c  3a 0e 0a 76 59 f4 0a 3d  |......5.:..vY..=|
+00000210  4f 06 b6 25 7f be 27 61  62 aa a7 ac 1d 6f 8f 27  |O..%..'ab....o.'|
+00000220  c8 66 35 17 85 55 ff 2e  81 00 82 75 b6 92 0a 93  |.f5..U.....u....|
+00000230  8b ad 8f e9 81 ff 3c 44  53 0b 74 0d 3e e9 8f 94  |......<DS.t.>...|
+00000240  8e e1 66 06 db f2 03 bd  04 14 80 57 45 54 08 70  |..f........WET.p|
+00000250  4f 9a 68 a0 25 7c df a6  15 3f 4c 4d 3a 7f 5b 5a  |O.h.%|...?LM:.[Z|
+00000260  9f dc 7d 07 dd 49 3f 19  54 41 1b 2f 11 9f 36 a0  |..}..I?.TA./..6.|
+00000270  d1 42 b1 08 8f 39 59 b7  f5 7e bb db b3 5a f1 5d  |.B...9Y..~...Z.]|
+00000280  20 97 26 e7 b9 98 55 06  32 11 c4 fc 97 0c 7d ee  | .&...U.2.....}.|
+00000290  f2 f7 56 bf 16 5c bf 1d  d6 3b 1e 09 7d 25 96 c5  |..V..\...;..}%..|
+000002a0  ef d8 e7 7a f2 92 a9 f1  2b db a4 55 4a 4b b8 37  |...z....+..UJK.7|
+000002b0  2b aa 8e 83 03 32 be 8a  1d fb d3 e7 e2 6c a8 df  |+....2.......l..|
+000002c0  ed 27 c5 e7 14 de 1e 89  44 48 e2 9c 0c 9b 4b f4  |.'......DH....K.|
+000002d0  05 e5 cd ad d6 97 34 22  a9 14 33 e3 34 c6 af b4  |......4"..3.4...|
+000002e0  29 96 2a b0 21 84 24 c0  55 43 61 74 7f 7b e5 dc  |).*.!.$.UCat.{..|
+000002f0  65 00 bc fe c7 72 d2 4e  5a 18 0f 05 3b 46 75 a8  |e....r.NZ...;Fu.|
+00000300  83 38 33 4a 4b ae 69 87  78 2f 8f 4a 69 ed 76 06  |.83JK.i.x/.Ji.v.|
+00000310  ef cd 0a 30 d9 b4 36 3f  c9 f9 e3 f0 d1 dd 53 bf  |...0..6?......S.|
+00000320  ba ff be 50 4b 61 bc 1d  b5 af 2d e7 dc ea 18 bc  |...PKa....-.....|
+00000330  48 2e a1 d8 6c d4 5f 2a  ed 26 c3 6f fd d8 3d e5  |H...l._*.&.o..=.|
+00000340  9d e1 85 09 4e db 99 c9  57 86 ea 0e 80 a4 4a 63  |....N...W.....Jc|
+00000350  68 20 70 17 07 96 17 03  03 00 99 25 58 aa ea 24  |h p........%X..$|
+00000360  05 9b 3e bf a0 cd a1 54  51 14 22 0f ee ca a5 d3  |..>....TQ.".....|
+00000370  f2 21 0c b7 4b a7 99 0a  7f c5 ee cc d4 40 31 af  |.!..K........@1.|
+00000380  a8 3d 50 fb 20 c6 c5 71  4f 1a 20 4f 6b 00 c4 8d  |.=P. ..qO. Ok...|
+00000390  4d dc af e9 21 f8 7b 4e  da 6f 78 96 6c 02 5f e7  |M...!.{N.ox.l._.|
+000003a0  35 6a 91 f8 fd 66 b0 ef  cf a0 6b b8 fc 7b 52 e5  |5j...f....k..{R.|
+000003b0  d3 10 ec 95 11 f7 fd 2c  4b ab 48 50 1b 8b 37 6c  |.......,K.HP..7l|
+000003c0  f2 b6 e1 ae ad 89 42 8f  a3 64 7a fe 83 64 93 7c  |......B..dz..d.||
+000003d0  41 08 42 f8 ff df 02 c4  b8 40 a3 66 4a 82 3d 89  |A.B......@.fJ.=.|
+000003e0  28 27 7f 82 39 bc b3 bd  a7 01 4b 6f ee 6c 15 3e  |('..9.....Ko.l.>|
+000003f0  c6 a4 ff 95 17 03 03 00  35 e0 a7 83 9a 4c a8 62  |........5....L.b|
+00000400  3d 41 83 a1 dc de f1 2b  89 a7 db 56 7e cd ae f5  |=A.....+...V~...|
+00000410  e8 ee 5b 87 9e 8b 2f f5  d9 53 83 56 7e 3b ab 7b  |..[.../..S.V~;.{|
+00000420  fd 34 44 a6 45 cd 13 1b  d1 84 bf d7 71 f8        |.4D.E.......q.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 02 11 0d aa ff 0a 4b  |...............K|
-00000010  ad e4 59 a9 c1 f5 f3 68  d8 75 aa 56 95 3e c2 79  |..Y....h.u.V.>.y|
-00000020  95 b4 86 21 5d 58 8c 27  09 be 59 21 6e 87 f3 fb  |...!]X.'..Y!n...|
-00000030  7a 77 fb a8 22 e4 93 bf  38 1d 4d a5 6f b5 5a dc  |zw.."...8.M.o.Z.|
-00000040  ac 1a a9 98 54 9a 87 a9  7a 31 38 eb e9 39 ec 4b  |....T...z18..9.K|
-00000050  b3 36 9f 9b 5a 44 d8 70  4d f4 53 1b 00 7e 3e 95  |.6..ZD.pM.S..~>.|
-00000060  34 1a 64 39 36 91 25 ab  c4 84 66 c9 e1 35 d1 57  |4.d96.%...f..5.W|
-00000070  0f 42 2a 7b 95 7e 6f 8f  87 7a 2e eb b5 57 3d d7  |.B*{.~o..z...W=.|
-00000080  c9 e4 0f a2 64 20 72 f2  78 fd 2b a1 29 11 da db  |....d r.x.+.)...|
-00000090  77 d9 08 f4 bf 71 e7 fb  62 87 8c fe 42 c7 1b 68  |w....q..b...B..h|
-000000a0  4c 4f a2 12 d9 1f dd 90  cc 09 83 20 21 16 01 9a  |LO......... !...|
-000000b0  da f1 74 ea a5 d9 8c 43  f0 1c 9a 44 62 54 ed bd  |..t....C...DbT..|
-000000c0  9d f2 04 73 e2 35 ce 0d  70 9c 16 d5 3d 80 b5 5d  |...s.5..p...=..]|
-000000d0  89 dd 64 82 12 65 a3 e7  70 16 25 ff ef 06 77 78  |..d..e..p.%...wx|
-000000e0  9e 37 32 1f ca 77 8c 01  f5 d6 8c 7a ef f9 5f f7  |.72..w.....z.._.|
-000000f0  eb 40 75 c5 36 c4 dd d8  3e 04 06 0e fa 18 d9 ac  |.@u.6...>.......|
-00000100  90 e6 3d 18 7e 34 c9 a4  ce 77 87 df 2d 74 ff 91  |..=.~4...w..-t..|
-00000110  67 7a 96 ac 7c b4 49 b5  52 c9 60 e5 34 75 b8 d1  |gz..|.I.R.`.4u..|
-00000120  b6 7a a1 c8 75 c4 d0 57  0a 16 01 e0 ef 44 90 3a  |.z..u..W.....D.:|
-00000130  95 06 bc 0e bc 0d 12 3b  ea eb 0e 1e f4 16 c9 da  |.......;........|
-00000140  06 f9 8b e6 b5 c2 ce 48  e4 5a b5 34 fb 9a 73 96  |.......H.Z.4..s.|
-00000150  20 67 2f 6a c6 04 53 75  e8 43 a2 99 4d 04 25 3e  | g/j..Su.C..M.%>|
-00000160  11 20 12 5e 48 dc eb f1  ea 35 3a e6 76 a4 dd df  |. .^H....5:.v...|
-00000170  66 6a 9e 94 46 a1 16 8c  d5 1a 3d 3c 3d 3c 3a aa  |fj..F.....=<=<:.|
-00000180  d6 31 4f 11 f0 5c 42 a1  ba 05 96 11 99 7e 2b 08  |.1O..\B......~+.|
-00000190  1b 20 e9 40 8a 00 b0 c0  2e e6 21 8f 98 76 59 4c  |. .@......!..vYL|
-000001a0  19 d8 b5 d3 48 2d 08 10  75 e8 98 7f 2b 0d c2 81  |....H-..u...+...|
-000001b0  0d 7a e9 6c 2d 25 cc 94  d3 90 d5 7d 49 a7 01 eb  |.z.l-%.....}I...|
-000001c0  e4 34 85 a4 42 5d 63 7d  50 8f 73 0d 31 ee 10 3d  |.4..B]c}P.s.1..=|
-000001d0  5f d7 72 c2 ea 84 35 e8  b8 e8 5d 4a 05 7a b9 66  |_.r...5...]J.z.f|
-000001e0  fa f0 07 6e aa 05 a7 69  a6 07 7c fc 46 3a d5 92  |...n...i..|.F:..|
-000001f0  44 97 59 ca ac de 01 7b  f2 67 9a 7b 01 5d 4d f7  |D.Y....{.g.{.]M.|
-00000200  58 44 60 72 a8 bd 21 2a  96 59 01 35 2a 41 6d a0  |XD`r..!*.Y.5*Am.|
-00000210  0e 1b ab 04 28 25 9f 37  19 84 e6 1c 17 03 03 00  |....(%.7........|
-00000220  99 f8 2e d9 3a 39 38 87  40 24 7a da f1 5b 8d 26  |....:98.@$z..[.&|
-00000230  30 a2 e6 d1 83 4f 68 bc  c4 6b e9 9c 91 58 e0 6b  |0....Oh..k...X.k|
-00000240  52 0d 82 fe 5b 54 22 51  a7 19 f7 c0 82 89 fe a3  |R...[T"Q........|
-00000250  da cc 79 a4 0c 48 99 71  ca ee 3c 2b d7 e6 e8 0b  |..y..H.q..<+....|
-00000260  55 f8 f6 09 3a 9e 3b 05  60 e2 3b 69 be 2b d3 50  |U...:.;.`.;i.+.P|
-00000270  63 79 91 e8 0d 7a 6f 1e  e6 85 80 0b ba dd bf 39  |cy...zo........9|
-00000280  1a 85 90 40 a9 88 4b 80  a2 16 05 69 7e b0 61 4c  |...@..K....i~.aL|
-00000290  39 53 04 46 5a 17 1a c2  5a 89 6e 69 9d 8c 57 ff  |9S.FZ...Z.ni..W.|
-000002a0  89 31 83 26 0c 8a ef a4  1a 08 87 ee 75 43 6d aa  |.1.&........uCm.|
-000002b0  80 b9 a0 f0 7f ea 35 8f  3e 71 17 03 03 00 35 67  |......5.>q....5g|
-000002c0  92 3c c8 8c 87 e7 a5 05  3d 0a 43 11 40 bb 4d 18  |.<......=.C.@.M.|
-000002d0  17 bf 0c 26 59 c8 16 15  03 0e 5f 05 d7 e0 4e ab  |...&Y....._...N.|
-000002e0  6d bf 19 9c bd 10 95 2b  c0 24 69 bc 70 d6 40 8f  |m......+.$i.p.@.|
-000002f0  ad 34 e4 1c 17 03 03 00  13 f0 f5 bb 11 53 b6 7d  |.4...........S.}|
-00000300  e7 3d 17 41 72 ff fb 3f  55 49 06 05              |.=.Ar..?UI..|
+00000000  14 03 03 00 01 01 17 03  03 02 11 a4 32 6c e7 2d  |............2l.-|
+00000010  50 62 d1 7e 36 97 a5 b3  d7 5d d8 52 fa 24 34 f4  |Pb.~6....].R.$4.|
+00000020  ea ca d4 02 26 73 40 7d  dc 9f da 31 d0 2c 70 3e  |....&s@}...1.,p>|
+00000030  be 8e df 49 3e 35 f7 cc  7b 1a 60 46 0b aa fc e2  |...I>5..{.`F....|
+00000040  e9 7b ff 3c 87 08 73 db  bc 49 8e 1f 8b 8c 4e 6f  |.{.<..s..I....No|
+00000050  4a a3 9e 22 3e ba 2d bb  52 db a6 39 ce 27 e0 e9  |J..">.-.R..9.'..|
+00000060  4c f0 5a 3c 61 b4 bc d3  bb 91 97 25 0a 62 5f e6  |L.Z<a......%.b_.|
+00000070  5e 4a ac aa 17 3f 33 f0  69 8f 67 9a d0 6c 0a 34  |^J...?3.i.g..l.4|
+00000080  ea cf cf 25 18 4a 52 60  b1 bb b9 9b bb 48 7f e0  |...%.JR`.....H..|
+00000090  2b 50 b4 f6 10 6e ac b0  31 9a 6d 39 49 21 d9 82  |+P...n..1.m9I!..|
+000000a0  28 d4 bd 0c d0 62 8b 20  c4 fa de 73 86 56 b4 97  |(....b. ...s.V..|
+000000b0  e5 f5 ad 77 1d 58 b9 60  0d 0e 79 87 89 5a 15 64  |...w.X.`..y..Z.d|
+000000c0  1c 88 44 5d 48 04 80 de  56 a4 ca 9e 1b d8 b4 ab  |..D]H...V.......|
+000000d0  cf 8a e2 5b 5f 55 e5 72  db f6 96 dd ea aa ae 6f  |...[_U.r.......o|
+000000e0  0f 98 86 1a b4 ca e1 b5  e5 6c 9c ab 85 c6 2a 7c  |.........l....*||
+000000f0  e0 7f 66 e4 f3 e3 44 01  bb 60 a6 7f 91 dd a0 a1  |..f...D..`......|
+00000100  b2 0f b5 d6 d1 d0 7e d9  37 93 3a 6b a5 28 13 db  |......~.7.:k.(..|
+00000110  64 95 63 0c c9 a2 d5 66  55 65 fc 09 c4 77 a1 b4  |d.c....fUe...w..|
+00000120  10 26 c9 39 76 51 cc 90  ac 24 9a 19 7b 4a c6 b7  |.&.9vQ...$..{J..|
+00000130  00 43 61 e7 91 a2 62 2a  55 48 cb 93 6d 3a 26 59  |.Ca...b*UH..m:&Y|
+00000140  be 0e 96 4f 13 66 0c ba  5e 9f 24 0b 6d 4e b4 f3  |...O.f..^.$.mN..|
+00000150  d0 1f 72 ea 9d 5b 08 d7  3b 6a 7e 16 96 43 5a 62  |..r..[..;j~..CZb|
+00000160  3e 30 e8 09 13 a3 0b 23  eb ac b3 0b d0 81 0d f7  |>0.....#........|
+00000170  e2 12 75 8d 1a 2b d1 15  e2 c4 05 77 11 55 7f 7e  |..u..+.....w.U.~|
+00000180  f5 54 19 22 86 0a e4 f8  a9 16 e7 30 b1 e0 c6 04  |.T.".......0....|
+00000190  08 5a 70 84 72 8e 2f a6  92 6c ed cd 32 34 5c 54  |.Zp.r./..l..24\T|
+000001a0  6e 2d e9 1a b7 c8 fb 31  00 3d b5 6c c4 1f 80 67  |n-.....1.=.l...g|
+000001b0  4b 8b 32 c1 28 8e fd 5a  56 03 71 c3 c3 49 52 81  |K.2.(..ZV.q..IR.|
+000001c0  ae 0a 06 e8 8c cd ba 55  3f 65 b8 03 ef d1 16 30  |.......U?e.....0|
+000001d0  ea d5 c2 31 65 ea b0 fb  b5 51 d3 49 0d 48 82 33  |...1e....Q.I.H.3|
+000001e0  db e9 f9 cc a7 85 d5 f1  92 a2 3a 7d 49 cd 8d 22  |..........:}I.."|
+000001f0  e0 25 28 97 ea 18 29 ed  54 d8 90 d1 e5 48 a2 7a  |.%(...).T....H.z|
+00000200  e4 b4 61 3f e3 df 1a 19  72 ed 85 4b e6 c5 6c 68  |..a?....r..K..lh|
+00000210  c6 72 6b cf 15 e0 25 d4  fc a1 d0 0b 17 03 03 00  |.rk...%.........|
+00000220  99 6d a3 1a d5 13 42 30  88 47 5d cb 3f 6e 23 63  |.m....B0.G].?n#c|
+00000230  ba d4 46 4f 5c 80 0c bb  ef 95 97 60 36 5c 15 b1  |..FO\......`6\..|
+00000240  d8 f0 2d 4c 3f 96 56 74  54 56 b8 0a 3c 88 5f f1  |..-L?.VtTV..<._.|
+00000250  f7 3e 8a 86 03 9c 22 e7  e8 40 f9 7e 4d 69 e7 09  |.>...."..@.~Mi..|
+00000260  ea b4 36 6e f6 68 3c 2a  08 c2 cd 61 ca 9b 2b 05  |..6n.h<*...a..+.|
+00000270  82 03 61 31 cf 5d 73 df  ea 8f eb 99 d7 1a 97 ec  |..a1.]s.........|
+00000280  74 e0 f1 e8 32 d9 4a d2  b6 b1 38 fa 2f 67 50 e8  |t...2.J...8./gP.|
+00000290  ed 04 6e ba eb d3 5f e3  2b 2b c0 a7 ae 2a bd f1  |..n..._.++...*..|
+000002a0  82 ea 66 5b 8f 64 63 af  94 0c aa e2 6a 55 91 06  |..f[.dc.....jU..|
+000002b0  4a cd fa cc 43 5f e8 0b  01 31 17 03 03 00 35 b6  |J...C_...1....5.|
+000002c0  9e f9 f7 8e fe af 2c 35  01 3e e6 b6 2e 63 57 0e  |......,5.>...cW.|
+000002d0  eb 98 7e 7e ad c5 43 2c  57 ec 37 a1 e5 a8 aa 4f  |..~~..C,W.7....O|
+000002e0  e5 55 44 39 82 26 42 ac  57 a5 95 9f df 75 c3 6a  |.UD9.&B.W....u.j|
+000002f0  41 2f 15 49                                       |A/.I|
 >>> Flow 4 (server to client)
-00000000  17 03 03 02 7f 1f 4c f6  5d 2e fd 21 bb 97 e0 c7  |......L.]..!....|
-00000010  88 69 42 99 49 d3 1e 6d  ce 16 95 01 ca 10 47 d2  |.iB.I..m......G.|
-00000020  7c f1 aa 53 3d cc ec 49  11 9e f1 7b 85 40 64 20  ||..S=..I...{.@d |
-00000030  44 7c 74 1f e5 a7 aa c2  95 b3 9d 98 ae 5d 73 6b  |D|t..........]sk|
-00000040  48 8c 63 b6 ab 38 f4 e7  95 28 66 1c 79 5f f0 e8  |H.c..8...(f.y_..|
-00000050  ca 6c ce e8 bf f3 7f 16  2b f0 62 aa 04 c7 96 dd  |.l......+.b.....|
-00000060  6f 1c 37 37 f4 41 b4 d3  87 fc d0 fd 67 cc 4d 15  |o.77.A......g.M.|
-00000070  80 69 88 19 c8 95 9b be  53 c8 a6 29 99 a2 8c 14  |.i......S..)....|
-00000080  cd 71 3d 11 0a 65 fa d5  fe 7c e7 5f 5a b4 96 fc  |.q=..e...|._Z...|
-00000090  ef 39 ad 13 38 a6 a0 42  9c 1e ee 61 89 79 f5 ee  |.9..8..B...a.y..|
-000000a0  df 0b 49 f8 e5 ab fc 4c  28 3f 33 ca b2 6d 8a 66  |..I....L(?3..m.f|
-000000b0  3b 88 ff 9c 30 08 c0 42  5c 26 29 0a 0c 52 6a f5  |;...0..B\&)..Rj.|
-000000c0  27 79 db 39 af 4b b6 5b  ba 00 7d 55 f5 41 86 9b  |'y.9.K.[..}U.A..|
-000000d0  bb d0 91 b7 ba 5f ff 19  06 20 85 a3 45 c7 44 45  |....._... ..E.DE|
-000000e0  5c e4 c9 41 0a d4 66 f5  5b 63 64 64 89 47 39 6f  |\..A..f.[cdd.G9o|
-000000f0  08 93 d8 e7 9c b0 fb 0b  9b 7c 90 d3 5b 32 61 61  |.........|..[2aa|
-00000100  03 cd 16 fa eb 39 1a 43  40 b9 52 e6 27 ac 33 43  |.....9.C@.R.'.3C|
-00000110  78 53 bb 6c 5f e8 4d 80  c8 1b b8 79 b6 43 63 b8  |xS.l_.M....y.Cc.|
-00000120  ea 19 71 8c 9e f4 46 b5  b4 df 2b df 84 f2 70 c2  |..q...F...+...p.|
-00000130  e5 40 16 79 f4 39 1f c0  7a 6b 54 d3 12 c7 e8 4a  |.@.y.9..zkT....J|
-00000140  2f aa fa 0d 20 ee b4 b3  bf 6f 75 c4 61 21 0d c9  |/... ....ou.a!..|
-00000150  e5 2a 3c cf 84 65 44 bf  4b a7 12 d1 4b 39 2c df  |.*<..eD.K...K9,.|
-00000160  bf 29 80 86 41 8a ee b8  7c a4 3a c5 5d 45 93 94  |.)..A...|.:.]E..|
-00000170  1d b9 4f 39 a9 ea 39 97  24 63 81 28 0d 22 7f 9b  |..O9..9.$c.(."..|
-00000180  bf a1 2f b3 c6 b6 a6 8e  67 67 80 35 4f 3a bb a8  |../.....gg.5O:..|
-00000190  ab 72 7d 33 b9 df 9c c9  97 e1 a6 51 9e a4 6e 39  |.r}3.......Q..n9|
-000001a0  80 7d 2c 76 40 f3 86 a8  ff 62 12 d4 4c 07 90 f1  |.},v@....b..L...|
-000001b0  0d 99 d7 1e c9 47 24 52  a6 61 05 ab 6a 0d 83 ba  |.....G$R.a..j...|
-000001c0  bd 1d 6f 8a 5e ce 67 9f  f3 a5 ef 07 36 d5 69 70  |..o.^.g.....6.ip|
-000001d0  01 f4 52 22 69 5f 23 f5  43 ad 54 84 d3 eb 59 77  |..R"i_#.C.T...Yw|
-000001e0  c4 b3 3e 86 35 5b 7d 62  40 fb 25 b8 1b 81 2b e3  |..>.5[}b@.%...+.|
-000001f0  d7 a3 36 5a 93 42 bf cf  a9 3b f7 9e 79 7c 9c 7c  |..6Z.B...;..y|.||
-00000200  86 ad af d2 14 7a a7 db  20 dc d3 2a 58 a9 73 6c  |.....z.. ..*X.sl|
-00000210  30 b1 1c 94 78 7f 5b 30  4e 8f 4d e2 8c 4a 23 ce  |0...x.[0N.M..J#.|
-00000220  b2 41 c8 5e 68 93 59 db  db 4b 95 c6 88 56 7d 02  |.A.^h.Y..K...V}.|
-00000230  d2 a5 57 61 2b 19 30 2d  58 ec 02 c9 44 3a fd 97  |..Wa+.0-X...D:..|
-00000240  73 c3 84 be 61 20 4b 02  88 b3 5f 44 af ba a0 9b  |s...a K..._D....|
-00000250  16 de ca e1 dd 60 6d ee  81 61 a4 9f 69 1c ef 1a  |.....`m..a..i...|
-00000260  c9 d1 65 3f 4b 25 7e 31  3d 94 61 d6 89 90 97 4d  |..e?K%~1=.a....M|
-00000270  0e 17 ed 23 2e 11 a3 7b  41 5e 8c 79 81 3f 57 18  |...#...{A^.y.?W.|
-00000280  f2 53 83 ef 17 03 03 00  1e cb 06 95 24 4d 96 ee  |.S..........$M..|
-00000290  8f 2c 0b 86 e7 d8 7d f7  78 08 46 0e 68 6d 80 3d  |.,....}.x.F.hm.=|
-000002a0  a0 d7 30 a5 c5 2b 93 17  03 03 00 13 1d 74 a3 82  |..0..+.......t..|
-000002b0  5e b1 94 71 59 c1 87 d0  3b 92 f3 cd b9 55 ac     |^..qY...;....U.|
+00000000  17 03 03 02 80 99 01 39  01 af b3 d3 bd 54 ba 92  |.......9.....T..|
+00000010  0f d8 a0 75 e7 8a 20 e3  3b e7 2e 6f f7 e7 02 1f  |...u.. .;..o....|
+00000020  a5 37 04 9d 5f 7f 19 2e  75 c2 73 af e0 96 80 82  |.7.._...u.s.....|
+00000030  ee 2a 2c f1 4a b8 2f 49  d4 eb 7f cb c5 23 a7 aa  |.*,.J./I.....#..|
+00000040  1d 84 1a 8b 88 de 55 67  93 85 e7 68 7d 7f 17 98  |......Ug...h}...|
+00000050  5f 69 9a 45 29 97 60 ae  08 ed 8c 4d 2a e5 d7 49  |_i.E).`....M*..I|
+00000060  8e 72 7e 8c 64 b3 f0 a4  fa cd 6f 77 3e bc cf f8  |.r~.d.....ow>...|
+00000070  d1 f4 4b 6b 8f b9 48 6a  a1 9c bf 26 30 30 32 9a  |..Kk..Hj...&002.|
+00000080  de 8a d2 08 4f 66 0b 3a  5b ce da c1 a7 a4 b4 0a  |....Of.:[.......|
+00000090  eb 5c c9 dc 1d d3 08 5e  a3 62 53 88 2d df 4e e5  |.\.....^.bS.-.N.|
+000000a0  08 25 e7 86 06 98 66 14  33 fe a3 25 15 15 7b 60  |.%....f.3..%..{`|
+000000b0  91 c4 4c b6 c8 92 4c 2d  82 3a ec 83 17 f9 ff c7  |..L...L-.:......|
+000000c0  b4 e1 45 1c 3a 03 f0 21  fa 83 a7 4a 4b bd 8a 55  |..E.:..!...JK..U|
+000000d0  af 52 54 16 a1 27 a7 33  d6 e7 34 39 8c a9 b3 78  |.RT..'.3..49...x|
+000000e0  a3 3d 0b 90 82 46 ca 31  62 b9 64 3b ff cb 12 2c  |.=...F.1b.d;...,|
+000000f0  43 48 4a 87 ae 63 1d a8  df 68 f3 15 ad b3 78 44  |CHJ..c...h....xD|
+00000100  9e 93 53 a5 fa e4 e7 c0  8e fb 3c ff 74 f2 1d 2f  |..S.......<.t../|
+00000110  92 b6 13 c3 10 00 8b 02  10 1e fd 1b 23 9d 7f c9  |............#...|
+00000120  d1 0b 52 ca 10 c6 e4 ce  62 9b 5f c2 83 c1 b1 83  |..R.....b._.....|
+00000130  54 f7 27 cf d7 1d 5f 80  fe 00 61 0c 82 9c b5 19  |T.'..._...a.....|
+00000140  ce 74 bf b6 38 7b d6 c5  9c 9c e8 32 c8 26 7c 36  |.t..8{.....2.&|6|
+00000150  eb 21 53 16 9c 89 08 73  bd 05 0f cb 69 df 33 f6  |.!S....s....i.3.|
+00000160  6b a3 4e 86 31 f5 75 5f  c4 99 a7 8d 85 ea 9c c4  |k.N.1.u_........|
+00000170  4d 02 10 4e ef c8 3a 96  f6 e3 1c 5d 67 b1 18 35  |M..N..:....]g..5|
+00000180  05 de a7 7c 17 13 8c f2  40 1f 02 9e 54 08 13 fc  |...|....@...T...|
+00000190  e1 db 29 8f 41 3b 03 65  7b aa 5e 3f 41 0b 2c cc  |..).A;.e{.^?A.,.|
+000001a0  34 57 cc 2e a5 48 43 4b  43 b7 38 6a b9 e1 df 39  |4W...HCKC.8j...9|
+000001b0  c0 1c 7d a6 66 ca 0d 4c  1e e3 a7 d6 53 49 99 b9  |..}.f..L....SI..|
+000001c0  26 49 5a fe 51 90 0e c6  57 74 42 10 f2 f2 b6 bb  |&IZ.Q...WtB.....|
+000001d0  bb 6b 29 4e 84 f9 cb 22  66 31 69 1f df 45 48 f2  |.k)N..."f1i..EH.|
+000001e0  dc 8b f0 a5 e6 4c 8d a0  8f 0d 8e 69 71 a4 e3 d4  |.....L.....iq...|
+000001f0  c9 5a 15 aa 20 04 38 e9  f2 3f 81 e2 7c 94 6d 28  |.Z.. .8..?..|.m(|
+00000200  56 2a 2f c1 76 96 72 62  0d 79 2c 1a 27 2e e0 85  |V*/.v.rb.y,.'...|
+00000210  47 25 4e 14 4a 90 a3 ac  ca 3a 7a 63 83 02 3e 0a  |G%N.J....:zc..>.|
+00000220  36 87 61 89 b1 d1 c4 49  0d ef 76 aa c0 1f 7c 75  |6.a....I..v...|u|
+00000230  73 8b 11 12 68 f4 6a ee  a9 5e 91 43 cb 5d dc f7  |s...h.j..^.C.]..|
+00000240  53 bd c2 4c d4 df 7f f2  74 d4 fb d2 ce ba 17 b2  |S..L....t.......|
+00000250  f5 68 88 30 7e 03 44 d3  9e 8c 44 b4 9d 15 d9 05  |.h.0~.D...D.....|
+00000260  f9 bc e8 3c b8 67 d5 16  01 29 43 d6 51 79 73 f8  |...<.g...)C.Qys.|
+00000270  51 1c b4 7c 8c e7 06 02  b7 61 06 1e 08 c3 6a be  |Q..|.....a....j.|
+00000280  ca 8d e9 5a d0 17 03 03  00 1e 09 ed 05 f5 50 61  |...Z..........Pa|
+00000290  e4 e3 36 90 aa c5 19 2d  10 bc 94 21 9b ec 20 55  |..6....-...!.. U|
+000002a0  22 5f 17 9b 2e fa a8 ca  17 03 03 00 13 dc b9 75  |"_.............u|
+000002b0  55 7d fa 96 65 da 58 24  44 6d 18 87 82 61 f6 cc  |U}..e.X$Dm...a..|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedNotGiven b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedNotGiven
index ee5ef6e2cb..c848cf1287 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedNotGiven
+++ b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedNotGiven
@@ -1,103 +1,103 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 34 04 ee af f8  |...........4....|
-00000010  8b c6 1a 77 bd cb b1 82  59 34 02 65 e1 68 c3 1f  |...w....Y4.e.h..|
-00000020  ae 37 9f 54 c0 05 90 a8  ec 75 f4 20 4f 50 95 61  |.7.T.....u. OP.a|
-00000030  59 7f 52 38 ba 5c db 01  10 c9 59 57 19 cd d8 cf  |Y.R8.\....YW....|
-00000040  34 c0 92 af 94 2e 00 05  eb d2 27 23 00 04 13 01  |4.........'#....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 47 f0 15 f7 e3  |...........G....|
+00000010  13 9a 07 53 29 3f 54 51  1e 17 92 b1 5a 11 f7 fa  |...S)?TQ....Z...|
+00000020  6e 9f c8 15 a2 c5 61 85  ee 69 aa 20 1b 3c bc 62  |n.....a..i. .<.b|
+00000030  28 c2 1a 1b 62 9a 37 c6  e4 94 45 70 9d a2 4d 9c  |(...b.7...Ep..M.|
+00000040  27 15 ee b8 c2 c9 3e e5  82 eb 47 53 00 04 13 01  |'.....>...GS....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 e7  |-.....3.&.$... .|
-000000b0  1d 50 18 f8 b5 25 14 ed  eb e2 da 8d 44 25 df 67  |.P...%......D%.g|
-000000c0  31 9e 8e 22 b3 c9 63 e0  f2 03 e2 c1 f4 23 48     |1.."..c......#H|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 f1  |-.....3.&.$... .|
+000000b0  9d 7c bc af 20 28 bb bf  80 36 07 94 5f ef 3d 63  |.|.. (...6.._.=c|
+000000c0  ed 84 29 c6 e5 15 88 58  38 a0 07 94 a2 5a 6d     |..)....X8....Zm|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 4f 50 95 61  |........... OP.a|
-00000030  59 7f 52 38 ba 5c db 01  10 c9 59 57 19 cd d8 cf  |Y.R8.\....YW....|
-00000040  34 c0 92 af 94 2e 00 05  eb d2 27 23 13 01 00 00  |4.........'#....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 1b 3c bc 62  |........... .<.b|
+00000030  28 c2 1a 1b 62 9a 37 c6  e4 94 45 70 9d a2 4d 9c  |(...b.7...Ep..M.|
+00000040  27 15 ee b8 c2 c9 3e e5  82 eb 47 53 13 01 00 00  |'.....>...GS....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 7f 73 17 e9 4a 7b  |...........s..J{|
-00000090  f4 74 f9 b5 89 8d d7 4a  cc d7 27 f5 fd be dc 5a  |.t.....J..'....Z|
-000000a0  43 17 03 03 00 3e c3 cc  a5 91 3d bc c0 4d 89 a6  |C....>....=..M..|
-000000b0  17 e3 40 cc 3c b2 d5 d2  f9 14 76 52 1b dd 9f aa  |..@.<.....vR....|
-000000c0  50 ca 72 21 cd da e8 5c  57 02 2d b6 97 e0 e9 8a  |P.r!...\W.-.....|
-000000d0  c3 79 41 44 2d 94 3f 42  d5 62 42 b1 c8 0f a6 05  |.yAD-.?B.bB.....|
-000000e0  62 cd b4 ca 17 03 03 02  6d e1 52 03 a3 17 d1 c8  |b.......m.R.....|
-000000f0  69 5c 28 3b 4b 21 13 06  f9 66 18 4b d4 35 44 df  |i\(;K!...f.K.5D.|
-00000100  3a 72 a8 01 54 bd dc 83  50 5a 7d 3f e5 61 d3 ec  |:r..T...PZ}?.a..|
-00000110  c7 79 73 b0 e4 78 89 1c  d5 cb 4c 1d fb 89 9d e9  |.ys..x....L.....|
-00000120  51 20 16 23 a8 4f e8 c1  47 d7 3e ec 89 bf c8 a6  |Q .#.O..G.>.....|
-00000130  a8 e6 59 44 1a 00 b5 e0  05 e9 8b a0 39 2a f1 c9  |..YD........9*..|
-00000140  4b c0 9e 91 08 bd 62 3c  27 bc ea 68 c8 88 5b f6  |K.....b<'..h..[.|
-00000150  89 d7 4c bb e1 15 3f 9c  50 ad c4 ed 75 b0 8d 34  |..L...?.P...u..4|
-00000160  c4 84 b3 25 22 82 ed 63  28 06 5b 1b 0a e9 d2 32  |...%"..c(.[....2|
-00000170  a4 01 81 98 0d 24 fc 85  8d 6e 04 7d 6d 8a 23 2f  |.....$...n.}m.#/|
-00000180  a1 2f c9 4e 23 2e 14 d9  58 9d 20 ac d2 0a ef c1  |./.N#...X. .....|
-00000190  34 27 25 00 88 0f cd 9a  5c 8e 54 6c 18 87 1b ae  |4'%.....\.Tl....|
-000001a0  c6 f0 20 ab 3d a5 1c ec  9a a5 d6 9b 31 e2 05 51  |.. .=.......1..Q|
-000001b0  b5 f8 54 c9 85 6a 98 29  92 26 86 e2 a0 11 96 bd  |..T..j.).&......|
-000001c0  4c 2b cc 4b f3 7d ac 25  cd a9 c7 80 bf 7c 48 d3  |L+.K.}.%.....|H.|
-000001d0  d2 aa ae d2 17 f7 49 1c  bf bf e3 21 c2 bb e3 78  |......I....!...x|
-000001e0  3a f2 7e d6 23 7a 96 3f  34 6f dc 87 0b d4 05 02  |:.~.#z.?4o......|
-000001f0  d8 88 96 90 4d d1 a6 37  9b 93 98 1c 22 a8 a8 9a  |....M..7...."...|
-00000200  30 1d 8e bb 6c 90 90 93  37 ca f7 d1 e4 d9 ee 61  |0...l...7......a|
-00000210  55 93 b6 bf aa 5a ba 53  cf 50 22 00 fc d7 06 9e  |U....Z.S.P".....|
-00000220  93 68 dc 88 09 52 18 95  e6 70 81 1c b9 21 cd dd  |.h...R...p...!..|
-00000230  25 3e ed dc 61 3f 0d 08  06 44 47 87 4a 53 10 fa  |%>..a?...DG.JS..|
-00000240  b7 85 ff e8 c3 41 72 9d  b3 57 c0 d2 8d cd d7 c1  |.....Ar..W......|
-00000250  96 d6 e8 93 88 a5 2d 5c  db 98 38 4c 99 6e 2e c5  |......-\..8L.n..|
-00000260  8e fa c4 43 32 e1 a7 ea  29 fb be fb ca d3 0a b1  |...C2...).......|
-00000270  70 cc 30 bd 46 f9 fe c6  52 c3 10 1f 1d cb 11 55  |p.0.F...R......U|
-00000280  c7 c3 89 cf 38 68 55 7d  15 db 0a 81 a5 f0 4a d3  |....8hU}......J.|
-00000290  db 17 5d 40 86 ec e4 11  9f fb 2d c7 41 80 15 af  |..]@......-.A...|
-000002a0  5c c6 9f 15 f1 ef e6 3a  59 5e fb ba 7d 75 c8 18  |\......:Y^..}u..|
-000002b0  77 8c c4 8e 7e b3 dc 25  a2 2e 0c 42 3d d5 04 bb  |w...~..%...B=...|
-000002c0  73 6f 3b 30 3e b7 9f bc  10 28 73 46 7b b6 9a 39  |so;0>....(sF{..9|
-000002d0  8a 11 ee e4 1d af ce 96  6d 1a 5a e0 25 7e bd 65  |........m.Z.%~.e|
-000002e0  9f 4f 57 5f 8f c8 84 f4  aa d5 3a a7 a4 27 db b4  |.OW_......:..'..|
-000002f0  7f 64 f4 37 26 83 b0 d8  b0 3e 69 6c 99 a9 f8 4b  |.d.7&....>il...K|
-00000300  9b 4d 75 74 27 62 58 1b  cb e1 c0 55 72 67 d9 0a  |.Mut'bX....Urg..|
-00000310  a9 66 24 d0 6d 4a 05 8e  3a 2c ce 84 3f 8b d0 b7  |.f$.mJ..:,..?...|
-00000320  43 e5 c2 38 d3 c4 fa e5  de fe 3b b2 ac 75 3c bb  |C..8......;..u<.|
-00000330  8b 6c 97 87 37 f9 12 28  c9 c2 87 09 e4 44 45 3c  |.l..7..(.....DE<|
-00000340  66 14 08 5a 0c 31 5a d6  bc 9e 0c a8 b9 b7 04 71  |f..Z.1Z........q|
-00000350  13 4f 10 21 03 69 17 03  03 00 99 ad 02 66 57 fc  |.O.!.i.......fW.|
-00000360  bc 08 db 92 a0 3d 28 d8  be dd 13 90 8f b4 71 39  |.....=(.......q9|
-00000370  9c 09 50 88 92 c7 32 44  2b 97 d2 c5 74 76 e6 5b  |..P...2D+...tv.[|
-00000380  df 14 f4 a7 07 ce 60 6b  ac ab 96 d4 54 6d 5f 42  |......`k....Tm_B|
-00000390  b1 7a f4 d2 10 ce 39 52  ae 80 50 21 5c 50 03 c1  |.z....9R..P!\P..|
-000003a0  4f 9c b4 d5 0d e2 e0 fc  82 2b fb 05 21 ce fa 40  |O........+..!..@|
-000003b0  d4 77 29 5b cf 35 18 02  ca 78 a1 c0 d8 07 b8 16  |.w)[.5...x......|
-000003c0  f1 c1 82 af c6 dc 80 67  0e 5a c0 79 ed d2 8c 11  |.......g.Z.y....|
-000003d0  24 fd 30 3a 39 64 18 70  09 46 dc 42 fc 20 a3 d6  |$.0:9d.p.F.B. ..|
-000003e0  a0 1a eb 6e 80 68 cb dc  fe a6 1f 17 8f 5c 1f ff  |...n.h.......\..|
-000003f0  7e 7a a5 92 17 03 03 00  35 73 b3 f6 7a 14 23 07  |~z......5s..z.#.|
-00000400  6d fd 16 3c 46 9e 30 63  83 7f b3 b0 fb 47 a8 92  |m..<F.0c.....G..|
-00000410  e8 a2 26 d9 55 ed 78 a3  f1 5b 19 c3 66 5a fa 64  |..&.U.x..[..fZ.d|
-00000420  3e f0 cd b9 f4 11 18 bf  5c 5e 38 e6 b5 79        |>.......\^8..y|
+00000080  03 03 00 01 01 17 03 03  00 17 50 53 1c be d5 ee  |..........PS....|
+00000090  91 44 3a e8 70 97 c6 e4  2c d5 18 df 47 c3 5d e6  |.D:.p...,...G.].|
+000000a0  04 17 03 03 00 3e f6 c2  36 23 98 44 4e 0a aa 88  |.....>..6#.DN...|
+000000b0  86 ed fe fb d0 aa c5 aa  28 4c 94 1e 3b 2c 42 93  |........(L..;,B.|
+000000c0  7f df a1 09 db 05 d3 5a  d8 4a 52 8e e7 ae c0 ad  |.......Z.JR.....|
+000000d0  b5 63 f7 75 73 52 ec fb  fa fe 58 05 65 ed d7 d2  |.c.usR....X.e...|
+000000e0  fb c3 5b f6 17 03 03 02  6d a5 7c 78 f2 4a 79 7f  |..[.....m.|x.Jy.|
+000000f0  08 d2 26 fb 2e 97 1a ee  4d 8c 24 ac 86 d7 eb c1  |..&.....M.$.....|
+00000100  5d 48 c6 81 a2 9e a6 8e  33 b5 43 c6 a1 b4 a4 19  |]H......3.C.....|
+00000110  d1 95 8c d1 27 59 a7 55  b1 11 8b 64 1c 24 70 d8  |....'Y.U...d.$p.|
+00000120  72 a8 cf b3 23 1a b3 af  9d 2b c8 30 07 f7 1f 4a  |r...#....+.0...J|
+00000130  1f 77 b6 54 92 92 39 43  e5 91 7b 55 9e 97 83 b1  |.w.T..9C..{U....|
+00000140  76 79 0f 7b 99 dc 83 6b  bb fc e2 83 f7 3e e7 b4  |vy.{...k.....>..|
+00000150  be fd b7 67 4d cb 58 2d  a9 a8 64 b3 87 32 57 fe  |...gM.X-..d..2W.|
+00000160  06 a9 2f 2a 5a 62 71 2c  e4 4e 37 a8 48 59 71 1f  |../*Zbq,.N7.HYq.|
+00000170  88 41 e5 d9 be ef cf f7  c4 03 17 00 42 5a 10 d4  |.A..........BZ..|
+00000180  e6 bb 0c 26 fa 61 bf 83  fd 60 e5 ae c8 ce 55 b9  |...&.a...`....U.|
+00000190  b3 ac 95 85 77 d0 84 1d  96 5e 7e 10 77 e7 0b 74  |....w....^~.w..t|
+000001a0  f4 c0 52 c9 18 b7 32 76  17 94 12 56 7e 34 ca ca  |..R...2v...V~4..|
+000001b0  de dd c1 8f 86 df 30 2a  6d b9 5c ae be dd 44 43  |......0*m.\...DC|
+000001c0  51 5c 0b 13 ac 1a ad 4c  20 7d 49 ce 0c 7f fc ec  |Q\.....L }I.....|
+000001d0  3d 01 95 4a df c8 b1 a3  e7 06 d0 f9 7b 2c d4 d3  |=..J........{,..|
+000001e0  96 47 4e d0 a5 57 24 65  70 e1 e3 11 71 85 4d f5  |.GN..W$ep...q.M.|
+000001f0  1a 81 cd d9 80 2a b4 f0  55 5a 03 db 1c e8 e9 32  |.....*..UZ.....2|
+00000200  dd f2 22 b8 25 f5 b4 a3  85 7c 86 90 d1 eb 02 44  |..".%....|.....D|
+00000210  82 ed d4 80 22 32 2b e1  f6 91 a0 6c 51 3d 51 c5  |...."2+....lQ=Q.|
+00000220  b3 1d 75 d6 7c 90 44 63  2e f9 1c a9 f0 b8 0f 36  |..u.|.Dc.......6|
+00000230  b7 e4 72 1b c7 53 0f 2a  05 ea d8 eb e4 be 1c dd  |..r..S.*........|
+00000240  79 a9 b1 f6 27 bb d5 88  c5 f4 c3 b4 b4 a0 6b e0  |y...'.........k.|
+00000250  aa a9 49 08 66 d4 3d b8  fe 93 1b 99 64 5b db 46  |..I.f.=.....d[.F|
+00000260  3d a6 d0 bf b1 5e bc 97  76 c4 71 31 e6 1a b3 8e  |=....^..v.q1....|
+00000270  8a 6f e7 17 34 ae d5 19  13 7a 85 a4 39 dc c1 5f  |.o..4....z..9.._|
+00000280  75 b7 da fe ec 78 8a ea  30 b0 22 e1 cd fb 2d 9e  |u....x..0."...-.|
+00000290  b1 02 5c 0c ac 96 de fe  e8 ff 50 2c be d5 ae 72  |..\.......P,...r|
+000002a0  f3 3b c1 11 d0 16 77 23  63 47 dd a4 ae 97 9e 5a  |.;....w#cG.....Z|
+000002b0  1d 5c e4 ff 04 0c d1 69  09 52 6b 27 e4 50 6e 03  |.\.....i.Rk'.Pn.|
+000002c0  a9 c7 ac b8 1e 98 52 76  39 b2 cf 01 d1 f4 ef b2  |......Rv9.......|
+000002d0  a2 2b dc 40 a3 27 3d 35  2c fc 92 9a dd 0f 6a 0d  |.+.@.'=5,.....j.|
+000002e0  b2 48 ca be 80 7f 18 15  75 80 cf e9 3b 0a 6d 37  |.H......u...;.m7|
+000002f0  6a a9 4c 1d cd 87 26 8f  f0 37 1b 15 fd 4b 26 53  |j.L...&..7...K&S|
+00000300  22 c1 0e fb b8 69 1f 36  a1 b1 52 e6 c7 4b fd 11  |"....i.6..R..K..|
+00000310  e6 42 53 cb 0b 7c 96 05  97 fa 84 37 97 69 de b1  |.BS..|.....7.i..|
+00000320  c0 11 e7 b7 f7 87 f7 46  ae 92 e4 e5 3e 4a 61 ab  |.......F....>Ja.|
+00000330  2d 4c 39 09 21 37 6b 52  d6 91 ca b3 63 d2 dc 42  |-L9.!7kR....c..B|
+00000340  0e 4a 67 08 e7 3d 25 d3  be e5 62 5b 47 2e fe 46  |.Jg..=%...b[G..F|
+00000350  45 92 d4 b3 f6 7f 17 03  03 00 99 0a e2 d6 ab 8c  |E...............|
+00000360  66 76 a5 fe e1 9e cc a2  ce 7e 0a 3a 1f a4 20 7b  |fv.......~.:.. {|
+00000370  83 ba a6 b7 11 e0 f1 c5  7a f6 51 f3 53 78 fe 36  |........z.Q.Sx.6|
+00000380  bb 3d ae 12 cd 00 7a 03  77 bc 4b 1d c9 b1 76 33  |.=....z.w.K...v3|
+00000390  74 02 f9 5e 27 f5 fb 37  0c af be ad ad 46 7b f6  |t..^'..7.....F{.|
+000003a0  50 dc 8b 77 60 b2 22 3a  5a b5 e8 4f 27 05 9a 21  |P..w`.":Z..O'..!|
+000003b0  9b 24 fc dd 8d 9e 20 3d  b1 8a ca 6c 5d 8d 09 dc  |.$.... =...l]...|
+000003c0  95 5b d1 7b 86 ac df 59  82 35 58 fb 59 d1 45 a2  |.[.{...Y.5X.Y.E.|
+000003d0  11 64 7c 58 4f eb ed 9c  18 f0 76 00 82 c6 05 c5  |.d|XO.....v.....|
+000003e0  2c 04 a6 07 b7 bd dd 66  da 8d 14 c2 6a f4 c0 d2  |,......f....j...|
+000003f0  da 50 fe 2e 17 03 03 00  35 9a e5 00 5e b3 9c 98  |.P......5...^...|
+00000400  3f 8f ba 31 12 62 40 35  7c 0f cc bb af 1b 49 c3  |?..1.b@5|.....I.|
+00000410  6c af b0 79 be 6e f3 32  9f 52 8f 63 27 71 d3 29  |l..y.n.2.R.c'q.)|
+00000420  58 71 6f 05 00 61 10 a9  b7 73 30 89 ca 42        |Xqo..a...s0..B|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 19 ca f6 38 db 7f  |.............8..|
-00000010  2d 71 b7 9a d9 15 0b db  23 a7 fa 77 eb dc 63 6a  |-q......#..w..cj|
-00000020  b7 ed 10 3a 17 03 03 00  35 70 c7 ee 8a b0 88 c0  |...:....5p......|
-00000030  98 e5 f8 14 8b 04 bb a0  38 1e d1 0a 7c b1 94 05  |........8...|...|
-00000040  a3 3b 56 8f bd fd f4 46  9a 51 a1 d4 c8 9e 17 ec  |.;V....F.Q......|
-00000050  87 5a 13 dd d0 66 25 75  d4 2c 33 de af 97        |.Z...f%u.,3...|
+00000000  14 03 03 00 01 01 17 03  03 00 19 76 3c 46 9e ad  |...........v<F..|
+00000010  ee 3d 05 c8 f2 c7 3b ed  7c d2 0c c4 03 34 b0 90  |.=....;.|....4..|
+00000020  d0 70 57 90 17 03 03 00  35 20 29 7c d6 f8 fe 09  |.pW.....5 )|....|
+00000030  e4 43 a5 c0 33 44 9e f9  8a 92 d2 45 20 40 cf 49  |.C..3D.....E @.I|
+00000040  68 42 e4 e6 f9 c8 4f 35  83 a5 bd 66 f0 32 c5 33  |hB....O5...f.2.3|
+00000050  5d f4 61 45 d3 e5 26 2f  96 55 15 d7 d5 bb        |].aE..&/.U....|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 87 ba a5 c2  91 ad 1b 42 20 b0 cd 82  |...........B ...|
-00000010  3d 99 60 8f 9f 68 f3 3a  f5 b5 d6 11 a7 4d 33 c6  |=.`..h.:.....M3.|
-00000020  6f 22 07 64 1a 2d 22 17  18 a0 1e d4 c2 88 85 3f  |o".d.-"........?|
-00000030  47 5f 92 d2 ec b3 a7 f8  d7 62 f5 2a 75 7b ca f1  |G_.......b.*u{..|
-00000040  a7 0a bd 47 2a e3 a0 7b  15 4d dc f6 0d a8 99 f0  |...G*..{.M......|
-00000050  bf 02 0d 0e ec 4e aa 3c  6b c3 cb 90 b9 26 7a fd  |.....N.<k....&z.|
-00000060  0b 5e 76 d1 ed f0 31 e8  36 df 5e 22 9a 1f 89 01  |.^v...1.6.^"....|
-00000070  ea 8e be 29 c5 8f be f2  7f 8f af 1b e5 eb 87 dc  |...)............|
-00000080  59 3a b8 2e fa 6b 96 55  5c ff 7e 06 17 03 03 00  |Y:...k.U\.~.....|
-00000090  1e b7 4b a8 bf 31 6f 16  5e a6 40 ab 89 08 74 e0  |..K..1o.^.@...t.|
-000000a0  6d b0 ea ea c6 60 04 31  dd 9c 43 e6 b2 e9 f1 17  |m....`.1..C.....|
-000000b0  03 03 00 13 15 2a c2 ee  87 44 4e b5 c7 0b 6d 6b  |.....*...DN...mk|
-000000c0  76 96 c1 54 d4 f9 3d                              |v..T..=|
+00000000  17 03 03 00 88 2f 43 9c  2c 4d 58 5f 8e c6 11 52  |...../C.,MX_...R|
+00000010  b6 b6 e7 f7 d6 e4 f6 dc  91 a8 3d 8d cc 65 21 1b  |..........=..e!.|
+00000020  ce 1f a4 27 89 64 04 c8  7f 78 09 35 d1 7b 0e 2e  |...'.d...x.5.{..|
+00000030  66 ef f1 3d e1 fa e6 94  29 4f 5c 39 d4 67 2d d6  |f..=....)O\9.g-.|
+00000040  61 8a 3d ad ed eb 62 5b  ce 2f b6 c2 01 d9 db 08  |a.=...b[./......|
+00000050  80 00 3c 69 81 d7 be 62  be 4b 1d 9a 76 78 71 c6  |..<i...b.K..vxq.|
+00000060  8c 86 38 91 8f ff 79 91  2d 83 de ef a2 05 3e b1  |..8...y.-.....>.|
+00000070  e0 36 da e5 99 49 7b c7  62 0c f2 c2 0c 4c bc 8b  |.6...I{.b....L..|
+00000080  c7 23 92 4f 9b 80 83 2b  7b 07 86 78 c7 17 03 03  |.#.O...+{..x....|
+00000090  00 1e 97 05 00 8b 39 6e  07 28 fc 9a ca 32 c1 7f  |......9n.(...2..|
+000000a0  22 13 aa 2e 90 4f f9 6e  3d 2d b1 d1 6a bd 97 95  |"....O.n=-..j...|
+000000b0  17 03 03 00 13 d7 28 95  f3 7b c6 88 8c 7c 20 e2  |......(..{...| .|
+000000c0  ae 58 35 6c 08 3a ef 6b                           |.X5l.:.k|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Server-TLSv13-ECDHE-ECDSA-AES
index 26ded5ccab..622408884f 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Server-TLSv13-ECDHE-ECDSA-AES
@@ -1,93 +1,93 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 ec 31 94 24 24  |............1.$$|
-00000010  c0 2c d1 9b d3 b1 5a f5  d6 cb 22 85 0b 81 77 e9  |.,....Z..."...w.|
-00000020  fb 6c 82 1d 49 2c 23 71  c3 a5 71 20 cc 60 08 08  |.l..I,#q..q .`..|
-00000030  2f 52 d8 95 0c 27 39 d9  7d 06 8f ee ad 1c 8e 48  |/R...'9.}......H|
-00000040  51 1e e6 ae 94 c9 89 7c  52 dd df 12 00 04 13 01  |Q......|R.......|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 64 e9 94 6e 11  |...........d..n.|
+00000010  99 79 12 f5 f1 a4 ad 5f  cb 1d ae d6 3d 2a 3e ff  |.y....._....=*>.|
+00000020  0a 22 84 74 c2 80 c1 7f  c3 5a ee 20 d6 6a 14 f7  |.".t.....Z. .j..|
+00000030  30 ad 5a 3e a5 7e da 10  a9 96 c1 3b 42 9b 02 4f  |0.Z>.~.....;B..O|
+00000040  d2 8e 8c 24 10 c0 60 da  09 f2 29 c7 00 04 13 01  |...$..`...).....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 e7  |-.....3.&.$... .|
-000000b0  71 0c af 05 74 8e 37 8f  b3 da db 34 e3 54 72 78  |q...t.7....4.Trx|
-000000c0  95 da 57 8e 6e 78 1b bc  d7 06 23 de 6c 34 5f     |..W.nx....#.l4_|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 ba  |-.....3.&.$... .|
+000000b0  20 43 fb 3f f4 a0 b9 06  47 72 39 5a 36 04 e0 2c  | C.?....Gr9Z6..,|
+000000c0  73 d7 1c e4 55 bd 9a b5  8b 93 83 91 40 9e 79     |s...U.......@.y|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 cc 60 08 08  |........... .`..|
-00000030  2f 52 d8 95 0c 27 39 d9  7d 06 8f ee ad 1c 8e 48  |/R...'9.}......H|
-00000040  51 1e e6 ae 94 c9 89 7c  52 dd df 12 13 01 00 00  |Q......|R.......|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 d6 6a 14 f7  |........... .j..|
+00000030  30 ad 5a 3e a5 7e da 10  a9 96 c1 3b 42 9b 02 4f  |0.Z>.~.....;B..O|
+00000040  d2 8e 8c 24 10 c0 60 da  09 f2 29 c7 13 01 00 00  |...$..`...).....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 92 81 ab 83 5b 87  |..............[.|
-00000090  d9 40 d1 9d d9 85 46 94  48 fc 56 a5 d6 ed 37 c0  |.@....F.H.V...7.|
-000000a0  59 17 03 03 02 22 bb c7  b6 2f a0 48 1d ff a6 51  |Y....".../.H...Q|
-000000b0  b0 3d 0b bf b2 3e d3 a8  72 74 e7 27 4d 4a 9a f6  |.=...>..rt.'MJ..|
-000000c0  19 bc 79 fe 44 b5 c9 82  5f 29 7a f8 e3 7f 57 04  |..y.D..._)z...W.|
-000000d0  be ca b2 34 a7 56 85 46  8f 43 af 01 86 09 23 7b  |...4.V.F.C....#{|
-000000e0  bf 65 0d da 94 0c f3 91  bf 7d 6a e0 2b 46 64 fc  |.e.......}j.+Fd.|
-000000f0  36 ef b0 4b 9c 1c 5a 98  08 f6 52 b1 37 74 40 2f  |6..K..Z...R.7t@/|
-00000100  f4 d0 c7 3f cc 57 69 dd  81 58 63 f2 c5 66 a5 b6  |...?.Wi..Xc..f..|
-00000110  8f b6 8c 62 7f 07 8b e3  cc 00 be 96 7e 1f dc 36  |...b........~..6|
-00000120  5d 6c 37 2b 68 9c b5 b6  36 49 0d 83 02 fc c3 43  |]l7+h...6I.....C|
-00000130  8b a9 7a db b6 6b e8 35  2e a0 04 24 ce 90 d1 97  |..z..k.5...$....|
-00000140  11 cd b1 cf 2d 8f 62 ad  86 0e 72 8b 05 68 1a 97  |....-.b...r..h..|
-00000150  8c 4d 3e b4 e6 31 53 b6  5d 4b 5f 0f 90 13 47 be  |.M>..1S.]K_...G.|
-00000160  d0 87 53 f8 de 3f 32 06  ef 3c 2d 05 05 d5 9d bf  |..S..?2..<-.....|
-00000170  11 69 5b c4 9e e2 1d 1f  b5 c6 30 45 11 25 88 ed  |.i[.......0E.%..|
-00000180  fe fa 62 c5 63 86 91 f4  9e ec dc bb 3a 9a ad 7a  |..b.c.......:..z|
-00000190  2a b2 8d f1 1a bf f5 62  d6 83 4d bc 97 57 2e d3  |*......b..M..W..|
-000001a0  70 59 2f db d7 96 0a 84  21 b1 89 53 c9 7e cb 29  |pY/.....!..S.~.)|
-000001b0  b0 19 a8 66 78 a2 55 e9  2a f6 ff eb f4 5d 41 b6  |...fx.U.*....]A.|
-000001c0  ec 92 f1 70 0c 3e 82 66  1a 43 8e bd 44 80 37 03  |...p.>.f.C..D.7.|
-000001d0  6e 53 f5 f2 81 f8 10 9f  65 fe 6f 1b 5d 4d af aa  |nS......e.o.]M..|
-000001e0  12 e0 4a 58 47 13 e1 1a  71 db 37 f1 fc 12 7e 90  |..JXG...q.7...~.|
-000001f0  1e c9 7d 54 9d fd 86 19  d9 5d c4 49 0c 21 ba e4  |..}T.....].I.!..|
-00000200  98 a5 e2 48 de 82 7e 29  30 a3 e4 ce 51 a9 53 07  |...H..~)0...Q.S.|
-00000210  e1 f1 12 5e cd 62 df a0  3e 94 6b cc 74 92 d2 dc  |...^.b..>.k.t...|
-00000220  5c f1 20 73 e7 82 94 31  77 0f 9c 4a d6 50 63 fb  |\. s...1w..J.Pc.|
-00000230  0f da a5 56 61 d2 d6 21  64 e8 13 13 4a 89 a2 f6  |...Va..!d...J...|
-00000240  2e 2f 87 4e df 68 06 bf  28 5c 82 7b e4 6d 2b 22  |./.N.h..(\.{.m+"|
-00000250  6e a0 84 4b 57 dd 2b 74  fd 02 1a c0 8c 1b 46 78  |n..KW.+t......Fx|
-00000260  19 38 0c 82 77 7a 03 fb  90 be 0f 21 8f 5c 26 2d  |.8..wz.....!.\&-|
-00000270  9f 9c 02 9e 2a 10 04 c7  0d 3e 66 96 d1 8b 9d ea  |....*....>f.....|
-00000280  2c bb 0e a8 53 bd 8d 47  59 75 d4 48 8c a7 0a bb  |,...S..GYu.H....|
-00000290  83 f7 97 10 fc a2 2a 64  9b b6 4b 75 57 d8 9a 31  |......*d..KuW..1|
-000002a0  bf 10 8b 7f 46 07 b4 ee  45 57 9f 0c 07 ba b3 f1  |....F...EW......|
-000002b0  ae 1a f3 6b 0e a4 3d 96  5c 0f ea a8 02 9b 66 8d  |...k..=.\.....f.|
-000002c0  0c dd 73 d0 05 62 05 ce  17 03 03 00 a3 eb 0b 77  |..s..b.........w|
-000002d0  97 30 ff 18 7a ce fe dd  e2 30 30 eb e3 42 f0 f5  |.0..z....00..B..|
-000002e0  ca b4 c3 10 4a 9c ca 2c  59 ad a2 fb 70 d7 5f 08  |....J..,Y...p._.|
-000002f0  46 d7 12 b0 fb 91 6c 5f  bf 80 13 57 e3 d2 e2 c8  |F.....l_...W....|
-00000300  42 c9 69 da c1 16 df 91  71 d8 44 24 39 76 a6 94  |B.i.....q.D$9v..|
-00000310  f2 82 ea f5 d2 d2 56 37  d4 bd c3 e7 a2 e2 c7 f4  |......V7........|
-00000320  b1 b6 56 6a 6e f4 60 0b  cd 6b ca 4d fe 2e 51 c8  |..Vjn.`..k.M..Q.|
-00000330  1b cd 0c 9f 68 bf df 7f  bb ed b5 db 7b 2a b3 25  |....h.......{*.%|
-00000340  0d d9 b3 f2 31 93 f4 47  e9 5d 8f d0 24 e5 1f 47  |....1..G.]..$..G|
-00000350  20 85 de 13 cb 1f aa 10  71 cd 08 d2 0c 48 48 e8  | .......q....HH.|
-00000360  a7 8c 89 03 d0 c8 68 c6  63 52 99 99 e7 15 95 f0  |......h.cR......|
-00000370  17 03 03 00 35 e8 67 3c  86 c3 c5 70 79 89 bd c0  |....5.g<...py...|
-00000380  75 24 fd e2 06 e9 4e 17  86 b4 2a 65 71 61 76 5f  |u$....N...*eqav_|
-00000390  f2 15 2d 93 e0 37 80 51  1b 7f ed 23 4c 8a fe e0  |..-..7.Q...#L...|
-000003a0  7c 5c c8 bb 2f ed 54 53  75 2d 17 03 03 00 87 21  ||\../.TSu-.....!|
-000003b0  40 c2 5e 34 bb 57 92 94  4b 86 b0 22 fd 95 de d2  |@.^4.W..K.."....|
-000003c0  55 81 ff d6 36 17 cd b5  86 a4 55 1b 25 80 20 1b  |U...6.....U.%. .|
-000003d0  d0 e6 6e f5 64 24 00 58  35 71 26 27 0a a1 00 a0  |..n.d$.X5q&'....|
-000003e0  a7 01 d1 9a f9 26 c5 d8  ba d7 cd 5e 96 d3 9d 11  |.....&.....^....|
-000003f0  0e 58 e0 6f d1 e2 3c c4  f3 94 3b d0 3d 25 f3 b5  |.X.o..<...;.=%..|
-00000400  39 9c 1a 1e 2d ff e3 76  42 71 fb 9d 60 d9 06 75  |9...-..vBq..`..u|
-00000410  f9 54 59 25 68 49 be 23  36 b3 cb 39 1f 86 a3 6d  |.TY%hI.#6..9...m|
-00000420  0b 29 a9 65 e4 38 09 d2  1b c9 24 27 b4 e4 d8 61  |.).e.8....$'...a|
-00000430  41 50 ea aa 0d a3                                 |AP....|
+00000080  03 03 00 01 01 17 03 03  00 17 97 f6 12 8c a3 14  |................|
+00000090  6f e3 e2 c3 19 38 79 4c  56 2a a5 8f cd f4 41 90  |o....8yLV*....A.|
+000000a0  b4 17 03 03 02 22 9f 20  4f 27 f6 79 fb 69 a5 50  |.....". O'.y.i.P|
+000000b0  99 55 c8 8a 29 88 3a 7d  48 08 a1 d1 f4 2b 96 91  |.U..).:}H....+..|
+000000c0  e2 a4 b2 25 b8 5b de 43  03 91 aa a0 66 29 b1 f4  |...%.[.C....f)..|
+000000d0  0c fa 77 fc a6 88 3c 15  69 a0 74 cb af 0c d5 4f  |..w...<.i.t....O|
+000000e0  bf 8c 56 2b 74 b7 dd d8  f2 f3 3a 25 34 d6 2c a5  |..V+t.....:%4.,.|
+000000f0  ec 1b e3 a8 02 80 01 f6  a0 cd 7a 43 dc 8a 4a c5  |..........zC..J.|
+00000100  44 54 23 2d 62 ad 66 22  db d9 bb 56 df 2d 7e 61  |DT#-b.f"...V.-~a|
+00000110  8b 13 cc 96 4e e8 08 a2  d1 06 38 2a d5 f1 9b 70  |....N.....8*...p|
+00000120  55 2b dc 6c e8 7f ca b6  15 9a 13 bd cb 51 5b ff  |U+.l.........Q[.|
+00000130  aa 75 b6 4a 38 e2 1d 07  ed 82 be fa b9 72 68 e0  |.u.J8........rh.|
+00000140  a9 e6 22 a3 f1 02 d8 22  04 6d 0b e1 84 81 01 94  |.."....".m......|
+00000150  f5 7e 7a b0 a0 67 bc 25  62 d7 87 18 07 32 1d 32  |.~z..g.%b....2.2|
+00000160  b0 70 df 69 24 32 f0 b4  07 8e 4b eb 44 d9 fc ba  |.p.i$2....K.D...|
+00000170  4c 9e 48 3f 4e 15 51 9b  c7 ec a2 3d 30 33 e9 6f  |L.H?N.Q....=03.o|
+00000180  f9 14 62 9b 8a 27 f0 98  f1 4c 69 1c b0 50 26 86  |..b..'...Li..P&.|
+00000190  22 41 c3 2d fb 3a 9c da  8a a2 d0 98 f2 bd 27 10  |"A.-.:........'.|
+000001a0  b1 1e a2 06 71 a6 7d 55  70 93 92 11 43 e9 c7 50  |....q.}Up...C..P|
+000001b0  98 17 b7 b8 d4 8f 24 36  f5 e2 3a 5f 28 f2 3e dd  |......$6..:_(.>.|
+000001c0  00 67 5f a9 e6 c7 8b 7f  69 41 8d 4b 30 c6 14 e6  |.g_.....iA.K0...|
+000001d0  6c 0c f8 0d b9 bf f0 83  a9 08 95 65 1a 12 c6 86  |l..........e....|
+000001e0  00 7f f3 3b ee 47 03 2b  a9 3e 9f 59 77 c6 cc ff  |...;.G.+.>.Yw...|
+000001f0  8c 6b d7 f0 99 32 11 a8  12 23 6d c1 79 14 62 9f  |.k...2...#m.y.b.|
+00000200  35 ab ad ae dd b5 eb b0  73 a7 a6 eb 83 37 3e 44  |5.......s....7>D|
+00000210  be 82 52 f7 e3 09 5c 16  0b 5a 63 d6 b4 0b 7b 8b  |..R...\..Zc...{.|
+00000220  bc 8c f8 11 de cd fb 52  c3 c3 6c 9c 4c c0 4a 5d  |.......R..l.L.J]|
+00000230  c5 a5 ff f6 e0 ad 56 61  1c 5f 67 e2 e9 f3 7f 5f  |......Va._g...._|
+00000240  14 e1 09 8d 66 40 27 d4  74 cf 5f 3f d3 c9 78 86  |....f@'.t._?..x.|
+00000250  32 5e 59 8d 9f d3 d7 9b  e6 06 23 02 56 b6 4c b7  |2^Y.......#.V.L.|
+00000260  38 c6 6e c6 54 64 78 81  6d e1 4b e7 7e 03 3b 1a  |8.n.Tdx.m.K.~.;.|
+00000270  2c 8d f9 12 4d d5 a9 9c  81 07 80 87 1e 1c db bf  |,...M...........|
+00000280  20 eb 0a c0 e7 a1 8c 2a  42 17 68 0a 67 38 af ed  | ......*B.h.g8..|
+00000290  b4 c5 5a 86 dc af bb 7f  05 76 cd 2b 69 c6 f8 6b  |..Z......v.+i..k|
+000002a0  87 16 b3 d2 a7 ef 8e 71  64 d5 78 d3 26 1e 2d 9c  |.......qd.x.&.-.|
+000002b0  8c d5 76 6a ae 0b b2 73  6a 18 5a 91 43 ac ec d2  |..vj...sj.Z.C...|
+000002c0  dd cb 36 a2 6b 3d cb ee  17 03 03 00 a4 79 13 8c  |..6.k=.......y..|
+000002d0  8f 9d b5 d0 d8 64 20 f1  8d 13 ff f4 b6 2f d9 94  |.....d ....../..|
+000002e0  e7 c4 c8 8a d6 53 45 ff  11 f0 aa 49 fa 15 f9 4a  |.....SE....I...J|
+000002f0  fd a0 98 fc 62 cc 61 d4  6b 41 d6 b5 3c eb 37 be  |....b.a.kA..<.7.|
+00000300  1e ab 48 7d 87 71 45 f6  e0 8d 40 b8 ae d2 ac 0d  |..H}.qE...@.....|
+00000310  3f c4 2d c1 f8 0f f4 ae  d7 88 97 dd df 0e d2 d1  |?.-.............|
+00000320  1c 03 ea a3 71 98 cb df  dd 72 f0 39 eb b2 a9 15  |....q....r.9....|
+00000330  3f 57 c4 1e f9 87 0b ad  2b 84 2b ff 88 9c 4e 37  |?W......+.+...N7|
+00000340  14 b5 8c 2c 30 e7 16 48  3e c9 e6 e7 c1 d9 0b d0  |...,0..H>.......|
+00000350  23 4c c7 4e a8 2f ca 7d  98 15 1f 70 c0 42 74 5a  |#L.N./.}...p.BtZ|
+00000360  86 8e e3 cd e4 1d 56 9d  80 63 3e ad 94 bf d4 6f  |......V..c>....o|
+00000370  a1 17 03 03 00 35 fe 27  df 5a d3 bd 58 0d 7b 2e  |.....5.'.Z..X.{.|
+00000380  24 a4 61 4e d4 21 d2 be  64 f5 6d 9d 5a 82 0e 0f  |$.aN.!..d.m.Z...|
+00000390  90 b6 df a3 e6 e2 66 1e  fe bd 1a 59 3a d5 9e 1a  |......f....Y:...|
+000003a0  bb f3 79 c0 d8 e8 5b 9b  60 4d e4 17 03 03 00 88  |..y...[.`M......|
+000003b0  39 91 96 dd 9d 3f 60 30  fb c6 40 57 fb f7 c9 44  |9....?`0..@W...D|
+000003c0  df 03 6a e1 e2 df 9a 0a  8f a7 75 ab 40 5e bc 83  |..j.......u.@^..|
+000003d0  94 8b 55 91 7f 3d fb a1  0e 57 f7 d0 3c 81 db 34  |..U..=...W..<..4|
+000003e0  36 7f 57 92 42 92 67 40  cb a8 f6 9a 80 6d 4f 40  |6.W.B.g@.....mO@|
+000003f0  77 a5 3c 31 5c a9 b0 82  58 d9 8f e1 2b 6d 3b 03  |w.<1\...X...+m;.|
+00000400  6d 6e 7e 71 4a 57 80 9f  2f 71 51 53 5e c3 31 7e  |mn~qJW../qQS^.1~|
+00000410  be 5d ea 1c 83 d7 64 46  7f a9 88 e9 e3 47 a6 b1  |.]....dF.....G..|
+00000420  c2 1f fa 0a af 54 ce 55  ba 67 cd a2 1a 52 d1 bd  |.....T.U.g...R..|
+00000430  91 00 e4 a6 8d 92 2e 93                           |........|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 81 cb d8 28 ac  |..........5...(.|
-00000010  36 50 5e 4f d0 18 25 58  08 12 a9 92 56 09 87 bf  |6P^O..%X....V...|
-00000020  32 6a 78 d6 02 58 bb c3  fc fd 4b 75 a3 e4 65 38  |2jx..X....Ku..e8|
-00000030  cb 57 6e 85 96 f6 86 88  40 49 cd cf c8 55 72 61  |.Wn.....@I...Ura|
+00000000  14 03 03 00 01 01 17 03  03 00 35 ce a8 2f f5 d3  |..........5../..|
+00000010  71 48 2e a0 74 72 7d 21  9f a8 25 9b 72 be 57 8b  |qH..tr}!..%.r.W.|
+00000020  ee 41 bb 04 f1 dc 4c 2e  0d eb 38 36 75 74 86 19  |.A....L...86ut..|
+00000030  49 2c 82 db dc 39 ed ef  d5 b6 8b 80 bf 7d cb e7  |I,...9.......}..|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e e3 d8 1c  54 b4 3d f5 8d 59 7a a9  |........T.=..Yz.|
-00000010  1d 35 6c fd 65 47 b9 42  63 8e 29 47 4f 15 06 f7  |.5l.eG.Bc.)GO...|
-00000020  5c 28 7f 17 03 03 00 13  47 bf 2d b9 cc ac ff 98  |\(......G.-.....|
-00000030  fe 4a 2e 84 0f 89 55 de  f0 ba ff                 |.J....U....|
+00000000  17 03 03 00 1e 3a 52 19  71 50 e3 78 6b e5 92 75  |.....:R.qP.xk..u|
+00000010  4d 27 97 32 08 4b c3 70  88 98 42 1b 86 2f 3f 28  |M'.2.K.p..B../?(|
+00000020  5a e3 20 17 03 03 00 13  e5 66 35 2a a5 13 b3 eb  |Z. ......f5*....|
+00000030  b6 1d 09 3a 40 87 ae cb  59 b5 7a                 |...:@...Y.z|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-Ed25519 b/src/crypto/tls/testdata/Server-TLSv13-Ed25519
index 51d0c5781e..a04a261989 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-Ed25519
+++ b/src/crypto/tls/testdata/Server-TLSv13-Ed25519
@@ -1,75 +1,75 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 a7 41 c9 a2 44  |............A..D|
-00000010  73 5a 14 73 33 7a 13 18  a4 65 bb d6 4b 68 21 6c  |sZ.s3z...e..Kh!l|
-00000020  44 3d 32 a7 c2 ce 52 dd  5a 2c 1b 20 08 03 9c b2  |D=2...R.Z,. ....|
-00000030  eb 7a 3b 52 2d 7f f3 6b  f1 03 e7 bf e8 85 c3 97  |.z;R-..k........|
-00000040  5f 67 6f b9 26 3a 12 16  d8 fd b0 6c 00 04 13 03  |_go.&:.....l....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 83 20 f5 18 94  |............ ...|
+00000010  f8 2b 08 2e 12 87 aa f2  7d 70 46 5e 4c 6f 97 1e  |.+......}pF^Lo..|
+00000020  06 76 8c da 47 b6 74 7f  d1 23 25 20 88 e1 e5 89  |.v..G.t..#% ....|
+00000030  f9 89 33 d1 3f 4a 91 44  92 c6 c9 3d a7 c3 5e d5  |..3.?J.D...=..^.|
+00000040  f5 6e 03 f6 60 35 14 37  0b 13 fc cd 00 04 13 03  |.n..`5.7........|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 df  |-.....3.&.$... .|
-000000b0  7a 7f 6b 20 c5 83 a8 62  9c 64 06 54 32 c0 8d 2a  |z.k ...b.d.T2..*|
-000000c0  9d ef 42 77 8e 9b 9a f4  eb ff a9 ef 95 a4 64     |..Bw..........d|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 cf  |-.....3.&.$... .|
+000000b0  4a bd a7 e4 06 16 75 b2  6d 35 73 89 32 64 14 ad  |J.....u.m5s.2d..|
+000000c0  bc ec e5 a1 e0 38 cd 5e  be 39 cc 28 83 b9 70     |.....8.^.9.(..p|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 08 03 9c b2  |........... ....|
-00000030  eb 7a 3b 52 2d 7f f3 6b  f1 03 e7 bf e8 85 c3 97  |.z;R-..k........|
-00000040  5f 67 6f b9 26 3a 12 16  d8 fd b0 6c 13 03 00 00  |_go.&:.....l....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 88 e1 e5 89  |........... ....|
+00000030  f9 89 33 d1 3f 4a 91 44  92 c6 c9 3d a7 c3 5e d5  |..3.?J.D...=..^.|
+00000040  f5 6e 03 f6 60 35 14 37  0b 13 fc cd 13 03 00 00  |.n..`5.7........|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 9b 30 b4 6c 8e dc  |...........0.l..|
-00000090  d6 22 2d 4c 51 ce ee 9e  23 e8 b8 30 61 ef e7 05  |."-LQ...#..0a...|
-000000a0  72 17 03 03 01 50 aa 29  15 51 e2 93 a7 16 d0 dc  |r....P.).Q......|
-000000b0  ff 54 72 ba 92 a5 07 a9  9d 9f ef bb 35 3e 1a eb  |.Tr.........5>..|
-000000c0  9f 41 ae df 48 76 67 31  8d f3 25 16 34 b7 03 39  |.A..Hvg1..%.4..9|
-000000d0  7a fa d0 cf 36 38 ed 3d  57 85 d2 87 3e 23 4f 86  |z...68.=W...>#O.|
-000000e0  2c 64 cf 04 84 cf 3e e3  40 43 c9 06 22 b3 b6 ec  |,d....>.@C.."...|
-000000f0  af ef f3 55 e0 dd 59 fb  31 d1 59 85 f1 26 60 7c  |...U..Y.1.Y..&`||
-00000100  ca 40 ce 1a 4c c1 51 c0  5a 91 93 2c 6d 2d 69 3b  |.@..L.Q.Z..,m-i;|
-00000110  e2 f7 55 cd ce ff 9a 86  4a 47 d0 e7 6e 1f d1 fe  |..U.....JG..n...|
-00000120  4b 6e cb ba 6c df 4a fc  22 ce 17 6a 6e 09 d1 bc  |Kn..l.J."..jn...|
-00000130  c2 01 22 30 06 02 8a bf  95 8a ba 03 56 51 a3 ec  |.."0........VQ..|
-00000140  33 51 f6 09 4c 08 4d 76  af d1 88 e6 af 37 a9 1b  |3Q..L.Mv.....7..|
-00000150  c4 41 10 69 95 6c 76 1a  02 48 c9 9e 99 f3 c3 76  |.A.i.lv..H.....v|
-00000160  d6 c3 98 8b 44 67 e1 bf  43 c7 2a a5 a2 3b 16 26  |....Dg..C.*..;.&|
-00000170  bd 15 7c e7 51 dc 48 72  59 b7 d3 b0 91 84 b2 4f  |..|.Q.HrY......O|
-00000180  13 a7 81 2a 35 e3 e9 a5  5f 02 c4 cb 46 e3 6d 94  |...*5..._...F.m.|
-00000190  78 cc fc b7 49 70 ab ee  fe c3 bf 28 b4 93 c2 9f  |x...Ip.....(....|
-000001a0  b3 2a cb 64 fa f1 9d 0c  f3 bf 9e a5 7c b4 81 c2  |.*.d........|...|
-000001b0  16 44 97 01 af 5b 79 28  3c 76 cc c8 37 0a 7e 01  |.D...[y(<v..7.~.|
-000001c0  e3 a4 0d 70 80 27 d2 b0  95 a1 3a 41 9b eb b3 69  |...p.'....:A...i|
-000001d0  a8 6d cf c7 4b 5d 56 b4  ef 12 ee 66 23 54 d6 b3  |.m..K]V....f#T..|
-000001e0  9b 7e e0 9e 85 cb ee c9  42 e6 90 94 c9 24 34 e4  |.~......B....$4.|
-000001f0  9a 15 e2 59 52 0b 17 03  03 00 59 32 b4 d6 ff 40  |...YR.....Y2...@|
-00000200  f9 29 d9 da cd 4f 45 94  15 74 65 6b d3 b0 92 40  |.)...OE..tek...@|
-00000210  f0 26 6a 2b 62 8f e6 b5  ad 0c a6 2a 63 b2 70 40  |.&j+b......*c.p@|
-00000220  c2 6d 76 3f fc 89 92 0e  06 0f 86 75 ac dd 08 69  |.mv?.......u...i|
-00000230  1a 02 18 94 21 b3 ef 29  cd cf 3e f1 82 9c 5b 3d  |....!..)..>...[=|
-00000240  9f 98 21 72 b6 94 9c 7b  a1 e1 d3 79 13 8e 29 59  |..!r...{...y..)Y|
-00000250  16 0e e9 83 17 03 03 00  35 51 37 68 5d 81 9f 9d  |........5Q7h]...|
-00000260  6d 97 72 9b 5f a3 32 b7  39 ce 92 03 dd 60 22 95  |m.r._.2.9....`".|
-00000270  62 d9 59 34 cf 20 29 f4  76 33 95 3e b4 85 f2 77  |b.Y4. ).v3.>...w|
-00000280  79 45 d4 c5 a5 05 3a ba  45 c4 b6 82 9f dd 17 03  |yE....:.E.......|
-00000290  03 00 87 8d 95 fc c3 ee  c1 8d b6 a1 3b d8 58 2b  |............;.X+|
-000002a0  48 ce 92 46 b9 d4 f7 e7  82 07 e5 71 9f b4 c8 90  |H..F.......q....|
-000002b0  e3 80 8f 0f 28 49 98 ec  8d 6d 1e 49 7b 03 84 96  |....(I...m.I{...|
-000002c0  75 6a 13 b5 50 b8 1b cc  1a 26 0c 38 30 d6 fe c9  |uj..P....&.80...|
-000002d0  22 86 85 c2 83 eb a2 31  44 76 43 35 e2 cd a6 31  |"......1DvC5...1|
-000002e0  4e b1 f1 ce a8 40 ed b7  4d a5 e7 27 69 4b a0 55  |N....@..M..'iK.U|
-000002f0  97 f7 ab 7e 44 b6 f0 82  38 41 ca 72 92 d3 8f ef  |...~D...8A.r....|
-00000300  a7 94 f6 c7 a5 b5 db 69  ce 28 be 84 76 65 c1 3f  |.......i.(..ve.?|
-00000310  46 80 3e 2d a3 25 2a af  0f 1a                    |F.>-.%*...|
+00000080  03 03 00 01 01 17 03 03  00 17 66 f6 28 5f fd f8  |..........f.(_..|
+00000090  65 81 b4 8e c9 2f da 0e  9c e3 cd 5e 84 71 bd c2  |e..../.....^.q..|
+000000a0  6d 17 03 03 01 50 46 5f  19 37 71 b5 27 ba 85 69  |m....PF_.7q.'..i|
+000000b0  a6 6a d4 ec 6c 3b f0 f9  22 3c 24 2c 11 36 5f f3  |.j..l;.."<$,.6_.|
+000000c0  20 b5 e3 7b 70 60 62 77  21 db 02 49 e4 ec 2f 82  | ..{p`bw!..I../.|
+000000d0  0f 21 f8 b8 0b ec a4 bb  39 58 10 96 40 73 bf d8  |.!......9X..@s..|
+000000e0  79 3c 68 81 6f 4b 7d 1f  6f 6f 23 4f 7f 36 cb ee  |y<h.oK}.oo#O.6..|
+000000f0  21 a0 30 f4 2f ac 7b da  43 73 3d 8a 02 db 43 6d  |!.0./.{.Cs=...Cm|
+00000100  c3 b5 19 27 41 89 19 dd  42 84 89 bd 11 ff f7 c3  |...'A...B.......|
+00000110  d9 b9 32 b3 d1 67 55 6e  d2 d5 e5 a2 38 3b 93 04  |..2..gUn....8;..|
+00000120  db a9 49 92 d4 93 71 84  ff 28 a6 ee 97 cb 30 8a  |..I...q..(....0.|
+00000130  a8 59 a2 40 b3 48 3b 6e  cc f4 03 ea 87 e2 5b 30  |.Y.@.H;n......[0|
+00000140  0a d6 4d a5 29 4a ba 82  1d e9 24 63 f1 60 99 fa  |..M.)J....$c.`..|
+00000150  a3 dc 64 38 2f 57 53 09  95 a1 35 60 86 a8 f3 d1  |..d8/WS...5`....|
+00000160  8b 02 4f 14 b6 f2 3d 62  42 9a 57 fa c7 82 41 50  |..O...=bB.W...AP|
+00000170  95 a6 58 ff 05 bc ad 56  90 f7 53 0f a8 80 48 51  |..X....V..S...HQ|
+00000180  d0 84 c5 54 9b 25 3a 69  42 66 ef 57 89 26 cd db  |...T.%:iBf.W.&..|
+00000190  99 05 d4 61 80 9c a7 f1  bb 2c a4 e6 8a 3c c7 02  |...a.....,...<..|
+000001a0  58 4a 80 29 c8 bf 57 06  10 36 a2 79 39 6e 5f 03  |XJ.)..W..6.y9n_.|
+000001b0  aa 16 03 89 7f a5 4a 9e  0f ae 04 47 a8 23 4a e4  |......J....G.#J.|
+000001c0  1d ec 69 18 44 7f 8c 8d  be 46 31 90 9c b6 ce c3  |..i.D....F1.....|
+000001d0  22 28 8a 9f cb b9 ec dd  bc be 99 76 6d b3 1a 92  |"(.........vm...|
+000001e0  93 f9 36 90 d3 d9 ea 71  64 85 b8 d0 85 d3 71 a9  |..6....qd.....q.|
+000001f0  30 ae 65 0c ed 29 17 03  03 00 59 03 56 33 f0 f3  |0.e..)....Y.V3..|
+00000200  46 f3 5a b0 d3 78 90 16  2e d5 b8 72 ad bb f6 a3  |F.Z..x.....r....|
+00000210  48 ac 07 a3 dc 00 33 de  e8 b2 c3 6e 60 bd 2e f5  |H.....3....n`...|
+00000220  20 0f 6e c2 db f5 d0 4a  16 3b 62 3e bb 3b e7 21  | .n....J.;b>.;.!|
+00000230  b0 43 33 f1 87 5b f4 33  db ff 9a e4 c3 1c 1b 75  |.C3..[.3.......u|
+00000240  93 4a 82 4b ad 16 3c 02  75 4a 0d e9 f7 5f bb 88  |.J.K..<.uJ..._..|
+00000250  f2 44 9d 0f 17 03 03 00  35 a8 c0 b4 99 63 97 b9  |.D......5....c..|
+00000260  31 af e3 fb 40 6d 06 ec  c0 7e 7d df 91 b1 1c 38  |1...@m...~}....8|
+00000270  9e e4 4f d5 6f 9d 60 6f  76 23 4a a6 27 63 12 5a  |..O.o.`ov#J.'c.Z|
+00000280  7f 1c 70 c7 ca 28 dc ec  eb bd 0e e0 5d 49 17 03  |..p..(......]I..|
+00000290  03 00 88 7f 6b 85 c6 d7  cb 69 f4 93 88 6e 9c ce  |....k....i...n..|
+000002a0  74 12 2b cb 0e 9a b1 e3  f2 20 51 e9 a4 6b 43 47  |t.+...... Q..kCG|
+000002b0  f5 a4 9e 26 07 1d 10 75  3a f5 e8 74 c3 b7 5f b4  |...&...u:..t.._.|
+000002c0  4a 8f 70 48 cb bf 0b 2f  8b d1 14 ec 5b 21 05 49  |J.pH.../....[!.I|
+000002d0  ca 35 9f 3e b1 9c 85 b6  7a 05 96 97 b5 8f a0 5d  |.5.>....z......]|
+000002e0  57 14 00 80 f1 7e de 7a  6f 08 8d cb 2b b4 7e fe  |W....~.zo...+.~.|
+000002f0  f9 a1 eb b7 92 d3 05 bb  36 dc ec 01 c9 9e f8 51  |........6......Q|
+00000300  f6 d8 43 a2 4e d7 fb 4f  c6 14 6b 7f 21 6d a1 3b  |..C.N..O..k.!m.;|
+00000310  ac 2a 40 86 43 6e 38 8a  19 de c3                 |.*@.Cn8....|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 1a 6b 1b d9 09  |..........5.k...|
-00000010  91 0c be 43 0b a6 2e 07  12 bf de 90 f7 da a1 ce  |...C............|
-00000020  55 6b ac e6 04 bc ae c0  07 ec 42 81 80 f9 6c f2  |Uk........B...l.|
-00000030  ba d2 a6 f5 88 90 32 b5  1d f6 2f 6f b7 18 e5 61  |......2.../o...a|
+00000000  14 03 03 00 01 01 17 03  03 00 35 5c 63 1e 5d 76  |..........5\c.]v|
+00000010  f9 43 ac 28 29 74 93 77  41 93 b7 49 28 4d 8e 75  |.C.()t.wA..I(M.u|
+00000020  1b 20 1f 9e 07 df 86 d1  68 40 25 8a 0f 64 a5 d6  |. ......h@%..d..|
+00000030  40 b2 fb 71 dc c0 b5 da  72 3c de ce 60 ec 03 6e  |@..q....r<..`..n|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e e5 0e 95  85 e5 2f fd 5c b8 2f cc  |........../.\./.|
-00000010  e6 c7 2b e5 b6 9e 89 41  d2 fd 1e 2e 7a 88 12 0a  |..+....A....z...|
-00000020  52 0a ea 17 03 03 00 13  20 6d fc 36 6b 19 59 11  |R....... m.6k.Y.|
-00000030  08 8b 94 e1 5a ae a0 d7  c9 5b e1                 |....Z....[.|
+00000000  17 03 03 00 1e 52 a3 e3  e2 0d 25 1d 5a ca 78 81  |.....R....%.Z.x.|
+00000010  fd 76 31 80 ad 64 68 f0  37 ee d1 79 08 fb bd 5f  |.v1..dh.7..y..._|
+00000020  17 6b 9b 17 03 03 00 13  a0 96 7b 45 15 de fd e0  |.k........{E....|
+00000030  b7 e6 71 c8 a7 6c e4 ed  fa 0e b2                 |..q..l.....|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ExportKeyingMaterial b/src/crypto/tls/testdata/Server-TLSv13-ExportKeyingMaterial
index 6edf872741..fa54af8208 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ExportKeyingMaterial
+++ b/src/crypto/tls/testdata/Server-TLSv13-ExportKeyingMaterial
@@ -1,98 +1,98 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ce 01 00 00  ca 03 03 75 06 0d 3f 75  |...........u..?u|
-00000010  6a 2d c7 a2 a3 24 6a 0d  70 a8 53 f1 a3 29 e9 66  |j-...$j.p.S..).f|
-00000020  bc 47 f7 2f 0f 07 44 41  a4 0a 49 20 76 3d e8 a2  |.G./..DA..I v=..|
-00000030  7d 5f 02 b8 8e c1 c5 a4  10 9b 91 d0 f0 5b 42 a8  |}_...........[B.|
-00000040  c7 8f c6 30 07 54 04 1e  fb 1c bc 90 00 04 13 03  |...0.T..........|
+00000000  16 03 01 00 ce 01 00 00  ca 03 03 00 68 6d 0f 70  |............hm.p|
+00000010  17 dc cd 3f 5d 61 e3 f2  f4 a5 60 60 f3 72 dc f1  |...?]a....``.r..|
+00000020  70 80 be dc 01 8f fa f2  5e 12 88 20 17 de 48 c7  |p.......^.. ..H.|
+00000030  7a 79 10 4f 06 41 9c d1  43 8f 8d 91 d3 f5 3d 34  |zy.O.A..C.....=4|
+00000040  b7 12 3b 70 c8 7a 34 54  ff b0 b6 17 00 04 13 03  |..;p.z4T........|
 00000050  00 ff 01 00 00 7d 00 0b  00 04 03 00 01 02 00 0a  |.....}..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 16 00 00 00 17  00 00 00 0d 00 1e 00 1c  |................|
 00000080  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000090  08 04 08 05 08 06 04 01  05 01 06 01 00 2b 00 03  |.............+..|
 000000a0  02 03 04 00 2d 00 02 01  01 00 33 00 26 00 24 00  |....-.....3.&.$.|
-000000b0  1d 00 20 03 6e a7 8a de  dc 69 bb 21 92 0d 17 d5  |.. .n....i.!....|
-000000c0  c3 c3 82 d5 1d e8 12 f1  13 50 e0 2d 1b b5 dd b5  |.........P.-....|
-000000d0  0c 37 5e                                          |.7^|
+000000b0  1d 00 20 23 cc ba ad 3f  d4 6d c0 24 6b 6b a3 af  |.. #...?.m.$kk..|
+000000c0  76 5c b2 a2 68 c2 cf 79  90 60 b3 39 3b 15 54 5d  |v\..h..y.`.9;.T]|
+000000d0  53 fe 1b                                          |S..|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 76 3d e8 a2  |........... v=..|
-00000030  7d 5f 02 b8 8e c1 c5 a4  10 9b 91 d0 f0 5b 42 a8  |}_...........[B.|
-00000040  c7 8f c6 30 07 54 04 1e  fb 1c bc 90 13 03 00 00  |...0.T..........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 17 de 48 c7  |........... ..H.|
+00000030  7a 79 10 4f 06 41 9c d1  43 8f 8d 91 d3 f5 3d 34  |zy.O.A..C.....=4|
+00000040  b7 12 3b 70 c8 7a 34 54  ff b0 b6 17 13 03 00 00  |..;p.z4T........|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 dc 9d 2a 20 98 79  |............* .y|
-00000090  e4 c3 d3 63 16 d2 a6 33  a2 69 28 de 8a 3f ca cc  |...c...3.i(..?..|
-000000a0  31 17 03 03 02 6d 29 19  ee 89 44 4c 91 a0 12 ec  |1....m)...DL....|
-000000b0  cc 97 3f 1d ac 8a d5 d6  df d4 32 96 c0 5f d4 f3  |..?.......2.._..|
-000000c0  11 9c 57 71 90 0c e3 09  e4 7c 9f 8d af f4 97 82  |..Wq.....|......|
-000000d0  68 4e e0 c1 84 d6 ca 92  e1 a2 95 d8 a1 7b 85 b1  |hN...........{..|
-000000e0  da 45 54 cf d4 c2 ef b8  28 7e be 5f e7 9e ac 61  |.ET.....(~._...a|
-000000f0  0b 02 af 39 ed bd 99 c5  47 ea 05 37 ab 4d 35 0f  |...9....G..7.M5.|
-00000100  b0 77 20 8d 45 93 a3 02  45 c4 b6 66 3b 35 0e ff  |.w .E...E..f;5..|
-00000110  61 a1 89 fd d7 6a 96 01  15 70 a5 36 97 58 df 2f  |a....j...p.6.X./|
-00000120  db 19 2f 4e bf 5f 48 53  a2 88 4c cd 92 30 32 5d  |../N._HS..L..02]|
-00000130  d4 8a 3a 38 18 68 c9 89  b5 a7 74 1e 44 0e 5d 89  |..:8.h....t.D.].|
-00000140  41 94 f5 30 bf d1 86 6f  50 f3 3b 3e 28 c5 f3 65  |A..0...oP.;>(..e|
-00000150  6f c5 01 10 7e e8 e2 9c  cc 93 53 0d 09 57 6b cd  |o...~.....S..Wk.|
-00000160  db 03 b2 26 c4 5c 33 5c  f3 89 e9 2f 2c e7 b3 1b  |...&.\3\.../,...|
-00000170  b5 05 f5 13 48 d2 f0 dd  9b fd aa a7 ee d9 6c 13  |....H.........l.|
-00000180  39 2d c9 d9 3b c0 e1 8a  57 d3 7c bf 3a 8b 18 a2  |9-..;...W.|.:...|
-00000190  a6 af 36 e4 4e 94 3e e7  8a 35 ef 02 4b 61 ef 68  |..6.N.>..5..Ka.h|
-000001a0  f0 2c 99 31 84 fa d5 3b  a7 e9 29 56 82 0c 68 41  |.,.1...;..)V..hA|
-000001b0  11 e9 a3 ea d3 5e 1e f6  e3 5c cb 90 38 22 5a 65  |.....^...\..8"Ze|
-000001c0  10 62 10 f5 aa fe eb 63  dc 31 df 38 37 8f 79 2e  |.b.....c.1.87.y.|
-000001d0  36 da 4c 04 c7 ed bb 7f  2f bd 4b 9f ba c5 d1 17  |6.L...../.K.....|
-000001e0  eb d9 2a 44 6d bb 56 1f  53 db 32 2f 68 a3 25 c4  |..*Dm.V.S.2/h.%.|
-000001f0  b1 9f 42 bd 12 20 67 77  55 56 c4 5c 6b 51 81 0f  |..B.. gwUV.\kQ..|
-00000200  dd fe 82 65 33 8c ab a3  bd 4f 2f f4 21 c4 a5 2d  |...e3....O/.!..-|
-00000210  98 8d c6 df 64 18 f6 2b  09 b5 92 9f a3 d6 be 78  |....d..+.......x|
-00000220  ee a7 e2 20 e0 62 9f 5d  3b 30 07 2c ad 43 64 f6  |... .b.];0.,.Cd.|
-00000230  08 23 e5 a5 de 07 4d e0  03 98 1e 36 d9 8a d4 64  |.#....M....6...d|
-00000240  c1 67 b9 7c c6 8a b6 d7  73 76 d9 43 99 97 a5 53  |.g.|....sv.C...S|
-00000250  e1 77 50 07 b6 e6 9c 73  14 a4 e5 5c 05 d4 e3 be  |.wP....s...\....|
-00000260  f0 15 60 6a fe 0b 4b ee  78 a3 63 c7 8e 0e 20 49  |..`j..K.x.c... I|
-00000270  73 8e e0 01 f5 4c 8a 6f  4f 2d c0 a7 42 a2 92 e0  |s....L.oO-..B...|
-00000280  f4 87 10 a9 06 f7 4f 71  e7 61 86 df 6c 4d 9d ac  |......Oq.a..lM..|
-00000290  fe d0 0b 7a 44 fa 54 3d  00 f4 37 f8 48 87 05 ff  |...zD.T=..7.H...|
-000002a0  29 40 f1 c7 d0 c0 bc f3  8a 7b 81 39 61 85 75 4d  |)@.......{.9a.uM|
-000002b0  d0 97 59 1a a1 a0 e1 62  b8 ca bb 61 b1 e8 4f 92  |..Y....b...a..O.|
-000002c0  a7 ad cc 03 3e fa 72 7f  32 69 91 1b 47 42 ad 97  |....>.r.2i..GB..|
-000002d0  66 d9 67 e2 92 d8 19 b4  36 88 fc 82 1e 7d 30 5c  |f.g.....6....}0\|
-000002e0  56 7d 58 1a b9 2d 16 01  a0 35 83 5f 51 b2 27 1f  |V}X..-...5._Q.'.|
-000002f0  76 b4 b2 31 af da 81 c9  c1 11 03 c3 7a b7 b0 7b  |v..1........z..{|
-00000300  5b d0 6c 48 28 ce 3c 4e  62 fc 13 79 05 84 2c 1f  |[.lH(.<Nb..y..,.|
-00000310  8e 47 04 17 03 03 00 99  88 02 bd 4b b1 56 f4 d1  |.G.........K.V..|
-00000320  0c 60 cd 1a 09 05 d7 c2  f8 8f 71 59 d7 f2 11 16  |.`........qY....|
-00000330  ae 9d 12 03 c8 eb 65 3d  c2 0f 3e 59 2b 80 62 09  |......e=..>Y+.b.|
-00000340  89 e4 cc 49 6f 5d 86 18  14 d4 7f 88 f6 c2 db 7b  |...Io].........{|
-00000350  ba 26 70 1b 4d 1f ff ba  0d 30 38 69 8e d2 4e f9  |.&p.M....08i..N.|
-00000360  5d 14 00 c0 99 da 97 27  70 eb e5 aa 97 6f 99 ae  |]......'p....o..|
-00000370  dd 13 27 c4 c3 17 8f ee  8a c8 f5 11 68 ab 93 16  |..'.........h...|
-00000380  03 c3 02 24 b5 bd 13 23  0d 23 72 be 40 0b fd 5e  |...$...#.#r.@..^|
-00000390  d5 04 b8 1e 17 11 6f ba  27 03 91 71 95 85 5d 6d  |......o.'..q..]m|
-000003a0  87 f5 ea ab 37 8d 5d d3  81 4e 87 23 4c e0 5e 0d  |....7.]..N.#L.^.|
-000003b0  e5 17 03 03 00 35 c3 3a  23 87 b3 3a b0 cf 1a 6e  |.....5.:#..:...n|
-000003c0  1e 27 05 b1 a9 99 8d c2  03 b8 a2 43 5f b1 5e df  |.'.........C_.^.|
-000003d0  28 57 71 71 bd ff 15 89  5a 7f 62 82 76 e1 6e 7f  |(Wqq....Z.b.v.n.|
-000003e0  a6 3a 92 ef ea 70 d3 fa  91 26 ff 17 03 03 00 87  |.:...p...&......|
-000003f0  07 2a ca d2 23 9e bb bb  4a 1c 47 27 94 38 ae cb  |.*..#...J.G'.8..|
-00000400  a2 b0 5e f8 0f 78 9a da  c4 79 10 c7 15 8d 83 d5  |..^..x...y......|
-00000410  d6 18 dd 76 64 08 24 6b  87 88 b7 e5 b7 f6 c2 b2  |...vd.$k........|
-00000420  a7 e5 5d 45 d3 00 c2 e0  40 b4 bb 6e c0 82 3f 68  |..]E....@..n..?h|
-00000430  92 b7 60 fb 77 9c bc 6d  c7 3d 31 39 93 1b a4 05  |..`.w..m.=19....|
-00000440  f8 f6 ce 94 51 79 f5 e6  9a a4 f7 11 bc 6d 14 b7  |....Qy.......m..|
-00000450  ef a1 d5 7f a0 ff b7 86  2a fd c2 94 29 ad 70 5b  |........*...).p[|
-00000460  87 04 89 53 40 d1 db df  c0 c6 7f ad 00 3d 76 99  |...S@........=v.|
-00000470  d3 be 9a 18 9c 4e de                              |.....N.|
+00000080  03 03 00 01 01 17 03 03  00 17 41 8a 5f 39 44 06  |..........A._9D.|
+00000090  c3 ef e8 ca 07 6b da 3f  1b 3e ee 90 96 4b 8b a5  |.....k.?.>...K..|
+000000a0  ae 17 03 03 02 6d 32 3d  de 04 8c 16 7b b2 8f 50  |.....m2=....{..P|
+000000b0  69 1e b5 d5 43 09 a3 98  c7 89 34 bf ee 14 e5 3d  |i...C.....4....=|
+000000c0  61 98 04 9a a8 33 b8 f4  a2 0f 0f e0 dc 9a 54 92  |a....3........T.|
+000000d0  5c 75 19 62 90 26 91 3a  5c 6d 0b 8f 3d 7c e8 51  |\u.b.&.:\m..=|.Q|
+000000e0  e3 23 01 9f 71 c3 23 3d  fc 9b 1b db 36 ff 6b b4  |.#..q.#=....6.k.|
+000000f0  00 cc 31 a2 ce df 73 e1  db a4 1f 97 16 d5 47 b4  |..1...s.......G.|
+00000100  a0 a2 a3 d0 46 81 ee 45  d2 9a c6 b9 52 4c 54 21  |....F..E....RLT!|
+00000110  b8 0a 82 4a 1d b7 62 6d  2e b7 e6 c3 13 34 76 22  |...J..bm.....4v"|
+00000120  55 f2 f9 59 be 55 fc 91  22 a6 bd 80 04 bf 8f 5a  |U..Y.U.."......Z|
+00000130  20 ab d1 64 bd 73 13 5a  78 3b f7 eb 5f d5 28 08  | ..d.s.Zx;.._.(.|
+00000140  91 6f 57 c4 84 d9 b2 e6  af 23 c5 72 c9 4b 78 d1  |.oW......#.r.Kx.|
+00000150  25 03 d6 00 a5 18 5f 36  01 29 a1 cb e3 1d e8 ff  |%....._6.)......|
+00000160  bc 13 97 9e 1e 94 a6 22  b8 18 b1 43 ea 31 7b 06  |......."...C.1{.|
+00000170  70 98 0f fc 2a 1c 4c c7  49 2a f2 4a 52 3d 57 54  |p...*.L.I*.JR=WT|
+00000180  89 8a a5 5e f0 a6 af e4  1b cd a7 9e 11 46 ab 42  |...^.........F.B|
+00000190  41 21 4f 22 c2 43 55 1f  ce 75 63 a0 6c f5 ec 76  |A!O".CU..uc.l..v|
+000001a0  e0 75 96 7a 75 b2 a9 46  a5 95 d4 35 dd a7 9f b6  |.u.zu..F...5....|
+000001b0  0e 05 30 0c f5 39 11 7f  69 96 6b 97 bd b8 cd 76  |..0..9..i.k....v|
+000001c0  cf d1 90 f5 22 da 4c 54  1e ea c6 0d 2e c9 7c 67  |....".LT......|g|
+000001d0  b8 bd 01 4e f6 d6 61 f7  c3 52 7e d7 16 84 53 f6  |...N..a..R~...S.|
+000001e0  11 14 79 ec 9f 3f 20 39  4d a2 7c 62 85 80 ca b0  |..y..? 9M.|b....|
+000001f0  dd 20 b4 f7 6a ec e4 f9  ea 12 3d a3 1a 2c a9 a6  |. ..j.....=..,..|
+00000200  34 e8 5a df 5e 0a 17 53  22 a2 05 a8 67 83 95 4f  |4.Z.^..S"...g..O|
+00000210  df d6 27 87 41 e0 54 a3  6e ac f9 c0 b1 b0 92 c4  |..'.A.T.n.......|
+00000220  a3 f9 e8 66 33 ad af bb  6d b6 a9 b1 2e c3 ad ea  |...f3...m.......|
+00000230  d5 db 74 8d d7 a8 ad 6a  c5 cd e3 0a ef 6a 3b c5  |..t....j.....j;.|
+00000240  9b cc ba 7a 80 6e 19 62  f3 a4 0a 50 53 b3 54 e9  |...z.n.b...PS.T.|
+00000250  27 0f 04 df dc c0 29 a0  76 48 3b 83 4a ad c3 a1  |'.....).vH;.J...|
+00000260  eb 58 ce 89 83 aa d0 bf  a7 dc 8e 5f 63 c5 a1 7a  |.X........._c..z|
+00000270  de 9a 8a f1 42 4a a1 a2  a2 53 7e 0c 5f 51 80 42  |....BJ...S~._Q.B|
+00000280  41 b0 a9 21 5c 02 72 da  0b 6f c7 85 a6 55 1a 88  |A..!\.r..o...U..|
+00000290  aa a6 f8 2c ae 55 3e f8  b3 a6 40 01 52 0f 2c 0b  |...,.U>...@.R.,.|
+000002a0  cf 8a 08 41 17 58 7d 57  90 99 eb f1 c3 b3 28 e9  |...A.X}W......(.|
+000002b0  1f ed f9 91 31 08 9e ac  55 76 7b 7a a5 23 bb 79  |....1...Uv{z.#.y|
+000002c0  ef c1 61 3c eb bf 49 2d  d9 7e cd d4 86 bb 33 ff  |..a<..I-.~....3.|
+000002d0  79 74 be f7 4b 5b 56 c1  e0 46 25 fc 8e 43 7d 36  |yt..K[V..F%..C}6|
+000002e0  60 ec fe 6e a9 2f 57 ce  dc a2 1c da b1 ca a3 4c  |`..n./W........L|
+000002f0  3f 50 7d c3 c3 20 ae 1d  97 8c fe 49 d2 b7 83 ce  |?P}.. .....I....|
+00000300  b8 46 86 3e 76 cd ad 14  63 57 bf d8 c4 c3 fd ed  |.F.>v...cW......|
+00000310  73 13 51 17 03 03 00 99  f9 00 53 e7 39 73 f3 2c  |s.Q.......S.9s.,|
+00000320  1d b7 eb c7 22 8b b5 c5  fe ff 84 7a 9a 53 32 9e  |...."......z.S2.|
+00000330  63 04 06 43 db ef 29 d3  94 28 c9 f7 22 2d ba 34  |c..C..)..(.."-.4|
+00000340  b4 01 72 26 b8 30 16 69  4b f4 57 eb 33 b9 eb f9  |..r&.0.iK.W.3...|
+00000350  ec b2 3a 3c eb f9 60 46  58 57 85 7f 1c 67 9d 7e  |..:<..`FXW...g.~|
+00000360  12 13 ea 36 70 31 fb 2f  40 fe 8f 28 64 1e fe 96  |...6p1./@..(d...|
+00000370  46 29 17 af a9 4e de 60  9a 30 3c f5 5f 17 8f 03  |F)...N.`.0<._...|
+00000380  00 7b 88 21 67 da 7f d1  c3 b7 b6 10 07 da 58 6e  |.{.!g.........Xn|
+00000390  e9 2b 4f 29 b4 2b cf 80  0d d7 d6 d9 63 59 3d c8  |.+O).+......cY=.|
+000003a0  76 35 8f a0 2a f7 ad 36  d3 3f 50 32 e9 92 5d 3a  |v5..*..6.?P2..]:|
+000003b0  a8 17 03 03 00 35 8f dd  d3 b5 28 ed 74 8c 50 ef  |.....5....(.t.P.|
+000003c0  85 85 95 3f bd 6a 5a dc  47 ef f1 0a 02 5c 21 cf  |...?.jZ.G....\!.|
+000003d0  a6 7e 06 c8 58 37 27 7c  78 5b 34 99 2f ad 5e b0  |.~..X7'|x[4./.^.|
+000003e0  3a 35 98 97 70 e7 40 11  48 f7 0a 17 03 03 00 88  |:5..p.@.H.......|
+000003f0  95 0f e5 e8 80 1b 14 b6  51 18 70 51 76 2e 37 24  |........Q.pQv.7$|
+00000400  86 e3 45 63 0c 98 3f 24  26 07 7a 34 a7 74 2f cd  |..Ec..?$&.z4.t/.|
+00000410  0c 0a 23 5e a7 98 f0 fd  ea a0 38 d6 50 92 3f ab  |..#^......8.P.?.|
+00000420  86 48 71 87 0c d2 ee 12  7c fd 29 55 5a b9 c9 aa  |.Hq.....|.)UZ...|
+00000430  71 36 ef 2f ab af 45 df  bb 06 fb 68 10 1a 51 93  |q6./..E....h..Q.|
+00000440  8d 9a 54 7c 92 f1 7a eb  44 8c 46 c5 d0 35 6e 15  |..T|..z.D.F..5n.|
+00000450  a3 17 d5 7b 49 81 be 5b  e7 f2 ac fe da 18 5a 98  |...{I..[......Z.|
+00000460  9d 61 48 45 b5 d3 cb 74  d5 59 76 9d de 89 6e c6  |.aHE...t.Yv...n.|
+00000470  21 2a 61 aa 6e 8e 88 d7                           |!*a.n...|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 14 13 c7 27 80  |..........5...'.|
-00000010  36 50 a1 44 7f 10 cc ff  a5 11 c9 a5 00 21 54 79  |6P.D.........!Ty|
-00000020  0e 9e f7 21 ed be 38 20  b4 ff 9d 3c 26 fc a0 d2  |...!..8 ...<&...|
-00000030  bb 80 34 aa 5c 50 1c e7  b3 df 06 7c a1 eb 4c d0  |..4.\P.....|..L.|
+00000000  14 03 03 00 01 01 17 03  03 00 35 5f dc b6 6f 7e  |..........5_..o~|
+00000010  49 2b 63 c2 0b 75 1e d6  a7 46 65 89 45 57 75 29  |I+c..u...Fe.EWu)|
+00000020  2a 3f ee 04 02 33 86 d1  2e 45 5e b4 75 d3 25 10  |*?...3...E^.u.%.|
+00000030  0f 36 93 e2 a0 56 25 e1  7f 87 51 47 e7 95 32 df  |.6...V%...QG..2.|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 18 a4 c9  96 e2 fe b5 3b b1 e0 51  |............;..Q|
-00000010  a4 10 a7 46 16 17 cb 27  4c a8 24 1b 89 ac 9b d8  |...F...'L.$.....|
-00000020  32 66 f6 17 03 03 00 13  e0 ea b8 39 49 8d 9f 02  |2f.........9I...|
-00000030  40 c2 44 4e 6c 57 a3 56  5b 01 a8                 |@.DNlW.V[..|
+00000000  17 03 03 00 1e 64 aa 8a  44 27 ca 16 eb 34 e1 e8  |.....d..D'...4..|
+00000010  5c 16 33 0d 2c 07 fc da  09 a4 42 7c 82 5e 2a 45  |\.3.,.....B|.^*E|
+00000020  99 cb ff 17 03 03 00 13  43 9a ef c9 81 15 1f de  |........C.......|
+00000030  23 99 63 50 fc a6 23 f5  40 2a 30                 |#.cP..#.@*0|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-HelloRetryRequest b/src/crypto/tls/testdata/Server-TLSv13-HelloRetryRequest
index 4e55f8a834..8060908f44 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-HelloRetryRequest
+++ b/src/crypto/tls/testdata/Server-TLSv13-HelloRetryRequest
@@ -1,123 +1,123 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 c4 01 00 00  c0 03 03 8b 5c 1c 09 f2  |............\...|
-00000010  ae 17 46 82 d6 83 0c 4a  6f 95 1d 23 26 18 cf eb  |..F....Jo..#&...|
-00000020  35 e6 e1 8e 83 5f a9 50  69 c3 dd 20 c6 7e ae dd  |5...._.Pi.. .~..|
-00000030  96 1f 04 2f de 44 1c 3f  e9 ad ec 77 e6 62 ae 46  |.../.D.?...w.b.F|
-00000040  7c e7 f5 78 3f 69 ed a1  04 7f 6c 44 00 04 13 03  ||..x?i....lD....|
+00000000  16 03 01 00 c4 01 00 00  c0 03 03 0e 42 e7 db 7a  |............B..z|
+00000010  d4 c1 13 7a 84 6b ea d3  46 a2 de 28 40 73 48 96  |...z.k..F..(@sH.|
+00000020  9d 86 3a 10 44 f6 d9 b2  a9 0e cf 20 1a 9a 60 0d  |..:.D...... ..`.|
+00000030  4c 30 d3 36 a1 a0 63 d6  d1 d9 2a e9 2d 5a f3 7e  |L0.6..c...*.-Z.~|
+00000040  5a 01 50 12 b6 00 4d 71  c1 5c c8 b7 00 04 13 03  |Z.P...Mq.\......|
 00000050  00 ff 01 00 00 73 00 0b  00 04 03 00 01 02 00 0a  |.....s..........|
 00000060  00 06 00 04 00 1d 00 17  00 16 00 00 00 17 00 00  |................|
 00000070  00 0d 00 1e 00 1c 04 03  05 03 06 03 08 07 08 08  |................|
 00000080  08 09 08 0a 08 0b 08 04  08 05 08 06 04 01 05 01  |................|
 00000090  06 01 00 2b 00 03 02 03  04 00 2d 00 02 01 01 00  |...+......-.....|
-000000a0  33 00 26 00 24 00 1d 00  20 04 32 9e 84 68 22 05  |3.&.$... .2..h".|
-000000b0  f1 d1 15 81 6a a6 ab 54  0d 89 1f 6f a2 6c 76 0d  |....j..T...o.lv.|
-000000c0  73 2e 54 f7 e9 84 11 b1  1e                       |s.T......|
+000000a0  33 00 26 00 24 00 1d 00  20 4e f1 62 b8 a5 c2 4a  |3.&.$... N.b...J|
+000000b0  c7 c1 ff 89 d5 3f 1b 4f  6b 56 a5 e2 be 5d 07 ee  |.....?.OkV...]..|
+000000c0  a4 12 39 44 36 87 76 c0  66                       |..9D6.v.f|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 58 02 00 00  54 03 03 cf 21 ad 74 e5  |....X...T...!.t.|
 00000010  9a 61 11 be 1d 8c 02 1e  65 b8 91 c2 a2 11 16 7a  |.a......e......z|
-00000020  bb 8c 5e 07 9e 09 e2 c8  a8 33 9c 20 c6 7e ae dd  |..^......3. .~..|
-00000030  96 1f 04 2f de 44 1c 3f  e9 ad ec 77 e6 62 ae 46  |.../.D.?...w.b.F|
-00000040  7c e7 f5 78 3f 69 ed a1  04 7f 6c 44 13 03 00 00  ||..x?i....lD....|
+00000020  bb 8c 5e 07 9e 09 e2 c8  a8 33 9c 20 1a 9a 60 0d  |..^......3. ..`.|
+00000030  4c 30 d3 36 a1 a0 63 d6  d1 d9 2a e9 2d 5a f3 7e  |L0.6..c...*.-Z.~|
+00000040  5a 01 50 12 b6 00 4d 71  c1 5c c8 b7 13 03 00 00  |Z.P...Mq.\......|
 00000050  0c 00 2b 00 02 03 04 00  33 00 02 00 17 14 03 03  |..+.....3.......|
 00000060  00 01 01                                          |...|
 >>> Flow 3 (client to server)
 00000000  14 03 03 00 01 01 16 03  03 00 e5 01 00 00 e1 03  |................|
-00000010  03 8b 5c 1c 09 f2 ae 17  46 82 d6 83 0c 4a 6f 95  |..\.....F....Jo.|
-00000020  1d 23 26 18 cf eb 35 e6  e1 8e 83 5f a9 50 69 c3  |.#&...5...._.Pi.|
-00000030  dd 20 c6 7e ae dd 96 1f  04 2f de 44 1c 3f e9 ad  |. .~...../.D.?..|
-00000040  ec 77 e6 62 ae 46 7c e7  f5 78 3f 69 ed a1 04 7f  |.w.b.F|..x?i....|
-00000050  6c 44 00 04 13 03 00 ff  01 00 00 94 00 0b 00 04  |lD..............|
+00000010  03 0e 42 e7 db 7a d4 c1  13 7a 84 6b ea d3 46 a2  |..B..z...z.k..F.|
+00000020  de 28 40 73 48 96 9d 86  3a 10 44 f6 d9 b2 a9 0e  |.(@sH...:.D.....|
+00000030  cf 20 1a 9a 60 0d 4c 30  d3 36 a1 a0 63 d6 d1 d9  |. ..`.L0.6..c...|
+00000040  2a e9 2d 5a f3 7e 5a 01  50 12 b6 00 4d 71 c1 5c  |*.-Z.~Z.P...Mq.\|
+00000050  c8 b7 00 04 13 03 00 ff  01 00 00 94 00 0b 00 04  |................|
 00000060  03 00 01 02 00 0a 00 06  00 04 00 1d 00 17 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
 000000a0  2d 00 02 01 01 00 33 00  47 00 45 00 17 00 41 04  |-.....3.G.E...A.|
-000000b0  9a 8b a5 48 2d ed 77 c9  7a ed 71 4e 73 66 2a 90  |...H-.w.z.qNsf*.|
-000000c0  c9 16 cc 94 7b 60 50 35  23 6f e9 55 2a 3e 0a 3c  |....{`P5#o.U*>.<|
-000000d0  04 de ca 1a 48 42 92 98  0b d5 a4 7a 38 41 dd 5c  |....HB.....z8A.\|
-000000e0  de 02 c8 62 18 88 12 d5  70 6e 26 c5 f0 1e 03 49  |...b....pn&....I|
+000000b0  01 85 6b fe 83 76 ad 76  88 ef 72 10 ad 98 45 e2  |..k..v.v..r...E.|
+000000c0  ef a7 92 8e ff f4 e7 fc  21 b2 31 23 7e a9 4b 21  |........!.1#~.K!|
+000000d0  ec 8d 2d e7 c6 08 8c 22  14 46 ac 19 b9 20 94 44  |..-....".F... .D|
+000000e0  e5 97 c1 44 de 3a 0f 29  1e cc d6 fe 75 dc 38 aa  |...D.:.)....u.8.|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 9b 02 00 00  97 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 c6 7e ae dd  |........... .~..|
-00000030  96 1f 04 2f de 44 1c 3f  e9 ad ec 77 e6 62 ae 46  |.../.D.?...w.b.F|
-00000040  7c e7 f5 78 3f 69 ed a1  04 7f 6c 44 13 03 00 00  ||..x?i....lD....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 1a 9a 60 0d  |........... ..`.|
+00000030  4c 30 d3 36 a1 a0 63 d6  d1 d9 2a e9 2d 5a f3 7e  |L0.6..c...*.-Z.~|
+00000040  5a 01 50 12 b6 00 4d 71  c1 5c c8 b7 13 03 00 00  |Z.P...Mq.\......|
 00000050  4f 00 2b 00 02 03 04 00  33 00 45 00 17 00 41 04  |O.+.....3.E...A.|
 00000060  1e 18 37 ef 0d 19 51 88  35 75 71 b5 e5 54 5b 12  |..7...Q.5uq..T[.|
 00000070  2e 8f 09 67 fd a7 24 20  3e b2 56 1c ce 97 28 5e  |...g..$ >.V...(^|
 00000080  f8 2b 2d 4f 9e f1 07 9f  6c 4b 5b 83 56 e2 32 42  |.+-O....lK[.V.2B|
 00000090  e9 58 b6 d7 49 a6 b5 68  1a 41 03 56 6b dc 5a 89  |.X..I..h.A.Vk.Z.|
-000000a0  17 03 03 00 17 a3 60 e4  12 08 5c 65 fc 70 2b 02  |......`...\e.p+.|
-000000b0  77 25 d6 8d 5e 0c 4c fc  ea 4b f7 72 17 03 03 02  |w%..^.L..K.r....|
-000000c0  6d a3 62 aa 8c ed d8 f0  80 ea 51 c5 13 4b 35 33  |m.b.......Q..K53|
-000000d0  d7 45 83 c8 f2 04 fc e8  e7 a4 2b d9 a2 61 9d 56  |.E........+..a.V|
-000000e0  a0 61 13 74 a6 e9 29 98  3b b6 68 7e 7f c9 25 69  |.a.t..).;.h~..%i|
-000000f0  bd 39 95 4b b4 40 ca 2b  d2 b0 d1 78 9c 32 13 41  |.9.K.@.+...x.2.A|
-00000100  6b 40 13 6f 17 3c e5 25  17 35 8c 4b d9 f7 f2 eb  |k@.o.<.%.5.K....|
-00000110  e1 af 44 46 2d cb d2 2a  06 56 03 2c a7 d7 0d c2  |..DF-..*.V.,....|
-00000120  50 ea b4 58 50 6d 32 41  9f 6b 71 c3 9b 80 e0 42  |P..XPm2A.kq....B|
-00000130  38 0d 7a 82 05 b0 f7 2e  e0 d5 5d a2 93 5c b7 e8  |8.z.......]..\..|
-00000140  c6 26 51 60 e2 f3 c1 2f  73 38 48 fd 71 be da 81  |.&Q`.../s8H.q...|
-00000150  3d 70 24 57 80 89 f0 7a  4d ab cf 39 a3 fb 65 88  |=p$W...zM..9..e.|
-00000160  1f 88 10 80 37 d9 bc 2d  3a 12 c8 99 1e d5 4c 46  |....7..-:.....LF|
-00000170  03 60 7d d4 90 4f b8 fd  db 68 26 4b 2f 9c 9c 8c  |.`}..O...h&K/...|
-00000180  19 d2 78 ed b8 28 64 4a  ca af 83 16 2c 16 9c 8c  |..x..(dJ....,...|
-00000190  20 5c 7d 6e 09 e9 c3 4f  e4 24 9f ac a8 34 79 bf  | \}n...O.$...4y.|
-000001a0  37 55 42 f1 2e 81 c1 00  59 8f 69 dd 5e c2 5f 3e  |7UB.....Y.i.^._>|
-000001b0  0c 44 6a 22 e2 a6 23 2e  bc f3 79 ff 63 9f 43 62  |.Dj"..#...y.c.Cb|
-000001c0  30 b3 6f 83 2e f2 fd dd  16 23 63 0b a5 dd 1f a7  |0.o......#c.....|
-000001d0  c6 37 85 4e 05 ec 39 7d  42 e6 be dc 65 b4 ad a9  |.7.N..9}B...e...|
-000001e0  b0 4b 76 e6 91 0e c9 0c  52 9e 8d 54 0a 16 c4 81  |.Kv.....R..T....|
-000001f0  f7 83 48 2c 30 59 ab f3  b8 50 14 a9 05 15 b2 5b  |..H,0Y...P.....[|
-00000200  0a a6 bd 5c 04 f8 43 19  08 2b 51 49 a7 c1 58 b6  |...\..C..+QI..X.|
-00000210  47 6a 46 17 ec d8 76 a1  0d 83 6b 89 69 aa 5d 33  |GjF...v...k.i.]3|
-00000220  01 d0 5e ea dd 60 e2 03  39 97 0c 51 26 c8 14 98  |..^..`..9..Q&...|
-00000230  12 49 c9 dc ca 82 9f 15  3b d1 56 47 fa dc 2e 54  |.I......;.VG...T|
-00000240  d9 c5 ab f5 9d 46 86 4e  db a8 f8 29 d1 b7 73 63  |.....F.N...)..sc|
-00000250  df f2 9a 7d 77 35 4a 6e  23 77 25 70 7e 55 c5 42  |...}w5Jn#w%p~U.B|
-00000260  ca fc bf a4 ea 18 30 91  1a 14 31 60 df f6 28 96  |......0...1`..(.|
-00000270  48 a1 8f 46 f3 94 f8 24  cc 0a 95 7b f8 ba 9b b1  |H..F...$...{....|
-00000280  99 8c f8 73 00 ba 37 cd  b0 45 0b 40 a2 97 f6 ac  |...s..7..E.@....|
-00000290  bb c4 c1 c2 9a 73 3a 68  f9 be a3 36 b4 82 da 6b  |.....s:h...6...k|
-000002a0  39 49 2d f1 43 6f 4f 4a  c0 8d 0f dc f7 e3 19 8f  |9I-.CoOJ........|
-000002b0  73 cd 57 94 34 b5 85 35  45 3c 75 98 95 4b b6 10  |s.W.4..5E<u..K..|
-000002c0  bb 72 89 ae 52 98 77 3d  e5 6f a3 08 dc 8a 48 13  |.r..R.w=.o....H.|
-000002d0  84 56 ef 99 c7 23 74 33  37 fc ad e2 28 f2 f7 cb  |.V...#t37...(...|
-000002e0  36 9d e0 be e0 27 40 40  bd 9e 70 bb dd b3 39 2c  |6....'@@..p...9,|
-000002f0  ea 25 ac 09 1c 8e 95 ca  b8 2d 1e 63 f8 4c 7c 42  |.%.......-.c.L|B|
-00000300  e6 4b d7 14 15 78 3e e0  57 0a c7 9f a5 2c 9b 32  |.K...x>.W....,.2|
-00000310  d7 09 1b 80 4c fc 0a 87  45 fc 5e ac ba ec 54 e3  |....L...E.^...T.|
-00000320  da 09 a5 eb 11 da ad c8  a9 6e b6 d0 ad 85 17 03  |.........n......|
-00000330  03 00 99 e4 24 04 be 5e  14 d6 3d 9f ae 8f fa 9a  |....$..^..=.....|
-00000340  ab ae b9 f7 04 a4 bf a1  4b 0c fb e4 30 1a cc 80  |........K...0...|
-00000350  63 45 f7 60 94 87 eb f5  53 d3 89 ba 3e 94 05 9a  |cE.`....S...>...|
-00000360  c0 0b ad 7b f5 0a bc b3  cf 7c 1d 43 8d a6 d9 d0  |...{.....|.C....|
-00000370  25 50 aa fe bd 38 04 63  dc a6 cf b7 7d 22 8d 68  |%P...8.c....}".h|
-00000380  fd 53 31 6f 18 a9 73 18  b4 ab 87 62 19 b2 7e 68  |.S1o..s....b..~h|
-00000390  c9 de b8 f9 2e cd 2f 8a  96 55 cd 0d c5 de df f8  |....../..U......|
-000003a0  3a a8 53 50 6f 50 ed 1c  4e d2 b4 8a 35 1f 81 b2  |:.SPoP..N...5...|
-000003b0  d0 50 64 bd 2c 37 2d 4b  3a 04 c1 d1 95 39 f9 f6  |.Pd.,7-K:....9..|
-000003c0  87 c6 c0 d0 44 aa f8 63  92 07 f5 2a 17 03 03 00  |....D..c...*....|
-000003d0  35 e9 89 19 15 b4 70 ab  2b 62 b5 e2 5e 02 4b 35  |5.....p.+b..^.K5|
-000003e0  27 42 61 e8 87 f8 b3 a1  22 f1 d4 a7 23 90 0c 3f  |'Ba....."...#..?|
-000003f0  d8 c9 2d dc 76 ee 7e 8e  52 ab e8 77 88 ce 6c 31  |..-.v.~.R..w..l1|
-00000400  35 95 90 ac 3a 7b 17 03  03 00 87 b7 92 53 79 c3  |5...:{.......Sy.|
-00000410  d4 30 b7 8a e1 ab 6d 97  fd fe 23 9f d1 f3 86 ee  |.0....m...#.....|
-00000420  e9 14 85 c3 33 d1 7e cf  72 62 87 a0 6e 97 62 8b  |....3.~.rb..n.b.|
-00000430  90 4d ce 74 5d cb 6b 11  ae b8 59 f5 70 a9 53 75  |.M.t].k...Y.p.Su|
-00000440  6b 31 44 4f 11 a9 cb d0  07 fc a8 af 11 67 11 ff  |k1DO.........g..|
-00000450  5b dc c1 58 15 df a1 1b  bc e4 36 e7 12 46 b8 2f  |[..X......6..F./|
-00000460  00 fb 7c 83 e8 e3 4a 08  7f 89 10 f7 f4 23 2d d9  |..|...J......#-.|
-00000470  ea 47 1d 97 d1 8d b3 13  6c 79 08 bc 47 d5 21 a0  |.G......ly..G.!.|
-00000480  95 e5 5e 2e 23 99 11 4c  2a 24 75 9d d2 d5 7e 74  |..^.#..L*$u...~t|
-00000490  22 2a                                             |"*|
+000000a0  17 03 03 00 17 a8 de 6f  11 6f 2f 27 1c 39 2f c3  |.......o.o/'.9/.|
+000000b0  a1 6e 13 22 55 dd 11 e7  cb 60 11 0c 17 03 03 02  |.n."U....`......|
+000000c0  6d 09 14 d7 cf 09 ad e5  7c 3b 58 4c 81 9c 93 69  |m.......|;XL...i|
+000000d0  bc 7c 9d 1c e6 cd 21 76  3d ac 19 0b 41 79 00 59  |.|....!v=...Ay.Y|
+000000e0  d9 4d a4 cb 59 41 9b 52  11 ba ca 52 bf f5 f4 99  |.M..YA.R...R....|
+000000f0  10 36 b0 3e 27 01 50 90  d7 3a ed 36 ba bb 54 51  |.6.>'.P..:.6..TQ|
+00000100  9e de 6f f7 5f c0 34 20  2b b7 d5 32 1a 97 98 b8  |..o._.4 +..2....|
+00000110  de 50 ab 3e 75 a7 23 31  76 b1 a1 30 49 79 89 e5  |.P.>u.#1v..0Iy..|
+00000120  37 b9 e4 ce f1 e9 c9 58  43 34 f9 45 e4 71 2b c3  |7......XC4.E.q+.|
+00000130  11 f5 2a 5d a7 ac 87 8a  e2 69 07 4f 49 d4 5f 2b  |..*].....i.OI._+|
+00000140  bf 2d 4c 8a f0 56 4c ae  a8 f1 b9 4a 15 eb 73 3f  |.-L..VL....J..s?|
+00000150  31 55 b9 45 51 af e3 8c  52 80 fa d8 f7 2d 05 28  |1U.EQ...R....-.(|
+00000160  75 19 31 c2 b7 5a b2 0e  c1 ff d3 fe f5 44 d6 d3  |u.1..Z.......D..|
+00000170  e5 e2 c3 4b 6d c9 2b 9b  1d f6 49 66 0d 6f 14 f3  |...Km.+...If.o..|
+00000180  37 8f 98 f6 13 36 3f c6  b0 6d 9f 71 8e 98 26 51  |7....6?..m.q..&Q|
+00000190  af 9b 6d 20 58 96 f5 c9  e6 6c cf 37 f0 80 5b b5  |..m X....l.7..[.|
+000001a0  7a 5f cf 92 e3 f5 bb 33  52 48 db dc c6 cf 03 8b  |z_.....3RH......|
+000001b0  03 55 35 49 16 e9 30 19  b6 3e 6a 88 69 d2 d2 8e  |.U5I..0..>j.i...|
+000001c0  59 ba 2b 89 8d fc 8e d7  b9 6d ab 15 31 a3 23 36  |Y.+......m..1.#6|
+000001d0  59 55 77 4b 69 52 3d d8  7e 62 bd c1 53 85 55 f9  |YUwKiR=.~b..S.U.|
+000001e0  a5 c3 f8 73 0f 60 87 12  8e 9d be 90 71 2d ea 8d  |...s.`......q-..|
+000001f0  d0 0a 0c 18 42 21 38 bf  58 66 c2 5f ad 73 b8 63  |....B!8.Xf._.s.c|
+00000200  c3 95 b3 52 de 98 7b 55  0a 62 e9 88 e7 20 9a 80  |...R..{U.b... ..|
+00000210  16 e1 52 a3 fc de cf 64  a1 cc 97 9a e9 2d 67 b2  |..R....d.....-g.|
+00000220  75 e4 5a 3b 7e a7 4d 06  aa 18 ce 3a b5 5b 73 f8  |u.Z;~.M....:.[s.|
+00000230  b1 97 69 e1 a6 a9 43 e8  70 67 4c 0c d8 8e 16 33  |..i...C.pgL....3|
+00000240  e0 65 36 8e d4 e2 2b ca  2e ee 03 7f 56 37 ad 92  |.e6...+.....V7..|
+00000250  b1 3e 6d 1b 70 59 0c 5b  39 df a9 4c 92 49 5e 4d  |.>m.pY.[9..L.I^M|
+00000260  cd 12 2d 77 7a e5 6b e8  3c f8 0b b3 06 14 57 b4  |..-wz.k.<.....W.|
+00000270  d9 66 fb a7 50 ee 91 6d  82 0a db 97 e5 b1 5e 3b  |.f..P..m......^;|
+00000280  13 d1 17 c6 74 80 b4 d7  eb 7f 48 8f 99 ca d2 23  |....t.....H....#|
+00000290  d0 de 2d dc d5 b8 9a 23  b7 66 2c 86 98 bf 93 b6  |..-....#.f,.....|
+000002a0  e0 78 8b ae 03 72 cb 44  af 15 21 c8 ba 8a 27 66  |.x...r.D..!...'f|
+000002b0  22 5a 1d 04 64 0e 59 ce  9b e7 96 96 1f 1f 57 05  |"Z..d.Y.......W.|
+000002c0  30 82 8f dd 7b 83 fc 92  70 55 7c a6 6d f7 78 a6  |0...{...pU|.m.x.|
+000002d0  2e 42 3d 54 05 87 e9 04  03 18 cc e5 a2 c7 70 01  |.B=T..........p.|
+000002e0  50 b3 a3 4b 35 4f d9 46  2b b4 aa 3f eb 97 80 67  |P..K5O.F+..?...g|
+000002f0  15 3a 85 d4 ad e2 26 40  41 b0 29 0b d2 1f b2 40  |.:....&@A.)....@|
+00000300  47 a4 b2 1c a6 57 3e ed  42 98 b1 2c 75 cd 05 0e  |G....W>.B..,u...|
+00000310  cc d1 aa 8d 13 0e f5 09  14 49 f9 62 69 9c 05 b9  |.........I.bi...|
+00000320  c1 5d b6 83 ff 42 62 21  e1 b9 5f 91 28 e9 17 03  |.]...Bb!.._.(...|
+00000330  03 00 99 21 30 ff 89 d2  2c 62 38 77 46 57 72 5f  |...!0...,b8wFWr_|
+00000340  4f 5e dc 6e b4 7c a5 c5  ce 17 0d 79 8e 55 04 94  |O^.n.|.....y.U..|
+00000350  23 a8 12 15 ff ec 3b dd  3c 6d f2 98 7c 65 2d 0f  |#.....;.<m..|e-.|
+00000360  4d 2c 6a 5a c2 b5 80 82  cf 81 0e 73 38 61 c9 e4  |M,jZ.......s8a..|
+00000370  00 d0 86 cf a2 b0 e6 e0  3d f5 77 9b 10 52 9c 4d  |........=.w..R.M|
+00000380  5f 1e 24 1d 98 bc eb 4b  0f f5 59 d1 06 9a 31 4c  |_.$....K..Y...1L|
+00000390  c1 95 1c 3d 12 68 ad 39  6e 03 c4 ac 20 10 c5 d0  |...=.h.9n... ...|
+000003a0  6c 62 68 28 db a7 e9 b0  7e 78 6d 01 4e 7e 13 ff  |lbh(....~xm.N~..|
+000003b0  a1 7e 19 8a 8f 28 3d 4f  71 98 e8 f6 5e 6c 5d 50  |.~...(=Oq...^l]P|
+000003c0  3c 50 eb 8a df 4f cd e7  6e 6f 4e ac 17 03 03 00  |<P...O..noN.....|
+000003d0  35 f3 82 05 48 c6 84 01  89 0d 6f 97 b0 8c 0b ee  |5...H.....o.....|
+000003e0  f4 1a 52 84 2d 02 51 38  6d ca 44 25 0e 10 1d 79  |..R.-.Q8m.D%...y|
+000003f0  e3 76 27 63 45 b5 6c 58  be 72 e6 0e 78 b7 14 1c  |.v'cE.lX.r..x...|
+00000400  72 35 f0 57 cc 3c 17 03  03 00 88 67 19 26 3d 1d  |r5.W.<.....g.&=.|
+00000410  94 84 4b 65 73 b5 5e 3e  53 c2 31 13 03 d9 7a ef  |..Kes.^>S.1...z.|
+00000420  08 d6 30 1a 5d c2 8b ab  1c eb a4 f9 c9 0c 6b 03  |..0.].........k.|
+00000430  a1 ac 53 de 55 a9 1f bd  d5 f8 1f cb f8 3b db fd  |..S.U........;..|
+00000440  37 e0 23 09 2a 11 ac b9  51 dc 25 39 8c da 59 46  |7.#.*...Q.%9..YF|
+00000450  89 b2 47 d3 34 18 af 0c  a1 ba 43 84 7c 76 8d 3f  |..G.4.....C.|v.?|
+00000460  68 85 3e 50 39 80 54 80  4e 01 2c f7 55 3e 95 c2  |h.>P9.T.N.,.U>..|
+00000470  c0 9e bd cb 6b 1b 08 95  a5 0f ac c2 24 84 9a 03  |....k.......$...|
+00000480  2c 20 f2 a0 de a2 ad c6  1c 92 fa 75 43 f0 6c ca  |, .........uC.l.|
+00000490  68 b9 8d                                          |h..|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 35 dc 57 3a  57 bd 27 01 81 7d 12 1e  |....5.W:W.'..}..|
-00000010  aa 3f 06 f5 e0 24 74 7d  ed ea d3 90 6b 25 fe b8  |.?...$t}....k%..|
-00000020  a3 f7 58 0a d4 f8 73 f1  18 60 06 bf 57 4d 4f 1e  |..X...s..`..WMO.|
-00000030  a7 15 43 bd 80 79 c6 ad  89 29                    |..C..y...)|
+00000000  17 03 03 00 35 88 fe 3c  5c 10 51 d0 51 ac 6e 68  |....5..<\.Q.Q.nh|
+00000010  0e 31 02 6b c8 14 8c 0f  23 b5 4b 7e 8d d8 b5 3c  |.1.k....#.K~...<|
+00000020  2b d2 e6 a0 40 ff 4a 39  74 b0 ae ae 32 45 fb f5  |+...@.J9t...2E..|
+00000030  ba e2 c2 d1 54 9b 3a 92  7a fc                    |....T.:.z.|
 >>> Flow 6 (server to client)
-00000000  17 03 03 00 1e 70 87 18  58 43 6b 0a d1 34 f0 bc  |.....p..XCk..4..|
-00000010  54 08 a9 0f 69 29 c6 8a  83 7f b4 a0 90 e3 d1 02  |T...i)..........|
-00000020  f3 44 b8 17 03 03 00 13  74 6b 59 ac 78 b5 94 7f  |.D......tkY.x...|
-00000030  9e d1 9a 3c e9 60 32 e4  4c 85 7a                 |...<.`2.L.z|
+00000000  17 03 03 00 1e 0e b6 65  05 a3 d1 e9 2d 24 6f 4e  |.......e....-$oN|
+00000010  6e a4 b2 c0 71 8f 0c 84  5c da 0e ef 5a b2 69 fa  |n...q...\...Z.i.|
+00000020  e3 3e f7 17 03 03 00 13  f1 ee 61 6f 44 36 67 38  |.>........aoD6g8|
+00000030  27 da 81 84 a8 bc 30 0a  66 43 c1                 |'.....0.fC.|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-IssueTicket b/src/crypto/tls/testdata/Server-TLSv13-IssueTicket
index 024f8a76b8..10eb9b681e 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-IssueTicket
+++ b/src/crypto/tls/testdata/Server-TLSv13-IssueTicket
@@ -1,98 +1,98 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ce 01 00 00  ca 03 03 1d 7a 10 b3 31  |............z..1|
-00000010  d0 07 51 2f b6 43 60 f1  3e 86 01 ad db 8c 95 36  |..Q/.C`.>......6|
-00000020  1c 7b 10 58 7e da ad 7e  38 7b 13 20 45 60 8a 3f  |.{.X~..~8{. E`.?|
-00000030  39 d9 c9 53 12 0a 2c b7  43 dd a7 d9 ba 84 d4 88  |9..S..,.C.......|
-00000040  cf c2 1d 57 91 8f 33 c3  1b ee 38 cf 00 04 13 01  |...W..3...8.....|
+00000000  16 03 01 00 ce 01 00 00  ca 03 03 07 23 3a e5 63  |............#:.c|
+00000010  60 e1 82 c4 e5 9a 0d 18  18 e2 ad 1d 8a dc 56 71  |`.............Vq|
+00000020  73 dc 71 42 73 a0 63 ff  9d 38 7f 20 fe c1 c3 cd  |s.qBs.c..8. ....|
+00000030  dc 91 6a 6f 77 21 d6 bc  c4 ee 89 50 aa 57 51 ce  |..jow!.....P.WQ.|
+00000040  cd 07 9e 89 b4 b3 da 87  4e f5 c7 fc 00 04 13 01  |........N.......|
 00000050  00 ff 01 00 00 7d 00 0b  00 04 03 00 01 02 00 0a  |.....}..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 16 00 00 00 17  00 00 00 0d 00 1e 00 1c  |................|
 00000080  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000090  08 04 08 05 08 06 04 01  05 01 06 01 00 2b 00 03  |.............+..|
 000000a0  02 03 04 00 2d 00 02 01  01 00 33 00 26 00 24 00  |....-.....3.&.$.|
-000000b0  1d 00 20 fb fa 6d 1c 02  64 98 74 c1 77 98 bd 79  |.. ..m..d.t.w..y|
-000000c0  44 94 7a 6e 21 03 9b 28  d6 d9 1c 69 e7 13 f0 1c  |D.zn!..(...i....|
-000000d0  4e 53 07                                          |NS.|
+000000b0  1d 00 20 bc f5 59 03 ee  1b 97 0e 81 f8 72 8f 58  |.. ..Y.......r.X|
+000000c0  de 53 56 44 f8 cd 45 d0  34 f6 fa e8 26 3f ed 36  |.SVD..E.4...&?.6|
+000000d0  38 46 7d                                          |8F}|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 45 60 8a 3f  |........... E`.?|
-00000030  39 d9 c9 53 12 0a 2c b7  43 dd a7 d9 ba 84 d4 88  |9..S..,.C.......|
-00000040  cf c2 1d 57 91 8f 33 c3  1b ee 38 cf 13 01 00 00  |...W..3...8.....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 fe c1 c3 cd  |........... ....|
+00000030  dc 91 6a 6f 77 21 d6 bc  c4 ee 89 50 aa 57 51 ce  |..jow!.....P.WQ.|
+00000040  cd 07 9e 89 b4 b3 da 87  4e f5 c7 fc 13 01 00 00  |........N.......|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 42 d0 aa 82 78 28  |..........B...x(|
-00000090  88 ec b7 7d bb 3d 61 59  82 83 58 ee d6 f7 23 b6  |...}.=aY..X...#.|
-000000a0  5a 17 03 03 02 6d 07 90  87 4f bd 2e ef 93 36 f4  |Z....m...O....6.|
-000000b0  66 c3 26 82 07 35 e9 c6  30 a7 12 04 96 7b 19 b8  |f.&..5..0....{..|
-000000c0  c9 5e 09 aa 6a 7d b7 66  f8 4c 3d 74 a9 f2 8e 23  |.^..j}.f.L=t...#|
-000000d0  02 4c e2 13 4c 53 e9 c8  38 37 fc c7 f3 83 a8 7c  |.L..LS..87.....||
-000000e0  44 61 06 0f d6 43 30 5a  f0 f9 ed 01 a9 24 47 4f  |Da...C0Z.....$GO|
-000000f0  4f 01 0d 49 01 61 40 84  4d 94 b3 c3 ba 20 cd 2b  |O..I.a@.M.... .+|
-00000100  03 66 f5 dd 8f 70 71 6c  1a e9 11 33 c9 4a 5d a6  |.f...pql...3.J].|
-00000110  7d a4 42 5b 42 5b ea 31  74 08 36 78 50 45 f9 03  |}.B[B[.1t.6xPE..|
-00000120  94 84 3c 4b c7 ce 8a 5d  0c 3f e6 e4 00 71 1c 6e  |..<K...].?...q.n|
-00000130  34 f1 46 d0 09 b9 ee 1e  a8 84 74 77 2b 86 fc fe  |4.F.......tw+...|
-00000140  45 a2 d9 5b c3 42 9c 29  6e fc 86 1d 2a 21 a8 fd  |E..[.B.)n...*!..|
-00000150  33 f7 59 59 83 5d 7d fc  01 be e7 d5 bd af 92 cf  |3.YY.]}.........|
-00000160  35 37 5b 1c 0f 60 f2 a2  de 7c 31 53 6a 3e f7 d2  |57[..`...|1Sj>..|
-00000170  1d 63 ce 88 1d a0 1a a5  a0 fc 67 24 bb 9c 41 2a  |.c........g$..A*|
-00000180  df b3 0c f1 57 20 f0 cc  c0 eb 84 f0 e8 9b 12 41  |....W .........A|
-00000190  6b f4 36 50 f4 27 ff b6  cb e4 7c 25 d4 e9 1d 2d  |k.6P.'....|%...-|
-000001a0  82 42 88 9c 6b 71 de fa  f0 ba e0 5f 75 fc 05 89  |.B..kq....._u...|
-000001b0  0c 5d 61 f3 2c 0d 2f 2a  db 60 0c 06 a5 6c 93 c0  |.]a.,./*.`...l..|
-000001c0  a6 c9 8a 06 04 bb 52 25  6c 13 52 49 da 86 78 40  |......R%l.RI..x@|
-000001d0  f0 98 f8 ae d7 5c be ea  f9 7e 8b 2e ab f0 71 28  |.....\...~....q(|
-000001e0  c9 03 a2 40 8b 11 2a b4  be da f3 4e cc 0c 6a d3  |...@..*....N..j.|
-000001f0  50 79 eb 90 b0 41 d6 12  22 bf 3a 72 5d d0 00 f6  |Py...A..".:r]...|
-00000200  f9 c1 ac e5 c0 7c 2a ca  e0 3a 07 2d 3d d4 56 91  |.....|*..:.-=.V.|
-00000210  8a 87 ac f6 11 61 52 cc  ef a1 5f 9b f6 09 6e 7f  |.....aR..._...n.|
-00000220  4c 33 6c ce f8 76 0b 1d  6a b3 e7 43 af f8 1c 97  |L3l..v..j..C....|
-00000230  f0 ab ff ce 15 74 87 3a  4a 7f 6f 1b 93 bf cb 75  |.....t.:J.o....u|
-00000240  32 c2 c9 53 d7 cb 8f 39  80 51 b9 38 19 8c da f7  |2..S...9.Q.8....|
-00000250  95 96 2f 20 c2 19 d5 d9  2d f1 e4 64 99 cf 61 55  |../ ....-..d..aU|
-00000260  2c 8d 66 c4 d3 5d f1 ba  17 4c 6f 4e 06 13 9f 82  |,.f..]...LoN....|
-00000270  62 e8 64 2a 68 c3 fa 7e  d0 91 e2 11 c9 17 c7 37  |b.d*h..~.......7|
-00000280  28 db c8 72 f2 cc 3a b2  17 bc 5f 91 aa 50 79 7f  |(..r..:..._..Py.|
-00000290  0b 11 99 11 64 a9 40 01  bc fd 00 da 50 e1 a7 c7  |....d.@.....P...|
-000002a0  e8 b4 2a c5 b8 2e 35 3a  37 2e de 53 a1 68 48 2d  |..*...5:7..S.hH-|
-000002b0  7d 29 5d 7b 43 8d 8a 2b  fd c8 57 50 32 07 bd 44  |})]{C..+..WP2..D|
-000002c0  b7 08 61 ca 21 f6 ed e0  97 ae d9 de 89 67 1b a5  |..a.!........g..|
-000002d0  50 4a 0e 37 73 ba 70 ed  d8 da 4b 18 dd 77 7e 8b  |PJ.7s.p...K..w~.|
-000002e0  98 8a f4 a0 87 8f 83 3f  b7 a0 20 b0 29 72 b1 44  |.......?.. .)r.D|
-000002f0  5b de f3 62 19 6f 2d f6  a6 05 b5 22 56 61 e6 8e  |[..b.o-...."Va..|
-00000300  9f c7 61 cb 10 e4 cb 93  69 e1 62 4f 7f 24 b4 a0  |..a.....i.bO.$..|
-00000310  b8 c4 25 17 03 03 00 99  af 8e c5 f6 eb 2d 8a 0d  |..%..........-..|
-00000320  a6 88 32 94 49 a7 74 33  dc 3a 99 9d de 7f 3e b4  |..2.I.t3.:....>.|
-00000330  6c 2f 16 3e ee ec ed e8  78 32 4a f2 a5 05 dc 84  |l/.>....x2J.....|
-00000340  49 7b f2 b7 5c 60 13 b8  1c b5 89 0c 7a ac e7 7b  |I{..\`......z..{|
-00000350  a5 95 18 2a 91 29 fc 3e  46 d4 ca 3d 52 2e 7d f1  |...*.).>F..=R.}.|
-00000360  0d 7a e6 56 59 dd 24 13  93 94 06 0e 4e 12 c1 59  |.z.VY.$.....N..Y|
-00000370  31 f8 34 73 d2 6c d0 73  06 2d a6 ed b9 42 0a 92  |1.4s.l.s.-...B..|
-00000380  3e 8a 3d 6a 89 d3 cb c1  e0 d7 bd 42 74 35 08 28  |>.=j.......Bt5.(|
-00000390  ce 1c 24 2a dd d0 4f 60  67 3a 96 cf 16 8e 49 f2  |..$*..O`g:....I.|
-000003a0  fc 3c 59 de c1 62 da c5  00 91 db 56 f5 d3 df 53  |.<Y..b.....V...S|
-000003b0  57 17 03 03 00 35 2e 87  d8 a4 af c2 73 92 de c6  |W....5......s...|
-000003c0  5a 40 0f 50 2a 19 ca 52  7f 67 31 91 ce e7 df 12  |Z@.P*..R.g1.....|
-000003d0  cd a0 43 0c da 2a 33 45  b3 34 a6 8d d3 fb 18 06  |..C..*3E.4......|
-000003e0  59 75 e2 d8 4f db a9 94  be b6 db 17 03 03 00 87  |Yu..O...........|
-000003f0  f7 d4 bc fa 15 5f 98 87  73 e4 17 55 ce 85 b6 46  |....._..s..U...F|
-00000400  0b 45 20 be 8d ad c6 6c  79 c8 75 a4 0d e6 34 b8  |.E ....ly.u...4.|
-00000410  16 48 07 09 26 7a 87 19  2c 99 6d e8 7d de e5 c0  |.H..&z..,.m.}...|
-00000420  fe 3b 17 19 ed 24 9b e5  4c 5c 2b dc d3 78 ae b1  |.;...$..L\+..x..|
-00000430  dc c1 bb 6e 8d 14 3e 59  9d 9e 3d 62 f8 51 10 9b  |...n..>Y..=b.Q..|
-00000440  0f 8f d9 9f 0c 89 97 9a  db 5c 99 13 0e 08 be 46  |.........\.....F|
-00000450  ff ac 31 ff dc fd bb 93  e9 fe 9d ff 70 35 21 e7  |..1.........p5!.|
-00000460  71 96 3c 6f 03 02 42 9b  06 f7 fa 6e 24 07 c3 d8  |q.<o..B....n$...|
-00000470  bd 25 25 bf 84 81 c4                              |.%%....|
+00000080  03 03 00 01 01 17 03 03  00 17 0c c0 99 e8 94 19  |................|
+00000090  4f be f0 bf b7 d3 fd ea  83 cd 98 03 a6 44 d3 ab  |O............D..|
+000000a0  5b 17 03 03 02 6d fb b8  5b 40 c5 8a c4 b4 05 01  |[....m..[@......|
+000000b0  fa 87 8d 7a 80 91 ea 19  03 ce 6c 87 09 95 89 c9  |...z......l.....|
+000000c0  5a f4 c2 d1 14 ff e0 4d  57 a4 81 d6 b9 17 66 72  |Z......MW.....fr|
+000000d0  d2 9d c3 bd 7a fa c2 67  c1 3b 0b bb 17 e3 c7 87  |....z..g.;......|
+000000e0  b8 2a a5 f1 93 bc 73 e0  c2 43 57 2e 8b ed 4a 94  |.*....s..CW...J.|
+000000f0  9f bf bc ad d5 b7 5f 9e  55 67 7c 39 85 12 4d 3a  |......_.Ug|9..M:|
+00000100  cf 43 a4 7f bb 27 3b 6f  fe a6 89 f1 4d da 4a 3e  |.C...';o....M.J>|
+00000110  0f 1e d9 11 d6 d5 73 4b  75 58 57 37 73 d2 ef 02  |......sKuXW7s...|
+00000120  06 82 9b 03 3b 87 af 4d  c5 b3 eb 72 55 c4 86 2a  |....;..M...rU..*|
+00000130  cc 80 3d 2f 74 5c 11 41  b2 c1 62 d1 1e b7 4e 38  |..=/t\.A..b...N8|
+00000140  d7 82 81 b1 f7 17 0b 65  8d 2d de 21 21 e8 ea 49  |.......e.-.!!..I|
+00000150  c9 71 69 03 e1 a8 bb 1a  d3 b7 b7 d9 e6 5f 3f 46  |.qi.........._?F|
+00000160  89 83 69 f5 b4 9a e9 4d  45 a9 da 42 d6 26 81 88  |..i....ME..B.&..|
+00000170  10 24 e7 74 b1 85 e9 88  a8 38 43 89 d9 23 2a e1  |.$.t.....8C..#*.|
+00000180  25 59 2e 6e 62 f8 c3 00  e4 21 7a 9e b4 b6 c5 de  |%Y.nb....!z.....|
+00000190  28 4c d1 47 d8 1a 15 df  bb 37 eb 68 82 7c de 28  |(L.G.....7.h.|.(|
+000001a0  44 43 81 a8 f0 cc 63 53  b3 51 81 d4 cd 6f 22 2a  |DC....cS.Q...o"*|
+000001b0  6e cd 6d 0a 52 34 49 da  4d d5 05 6c f1 80 11 c9  |n.m.R4I.M..l....|
+000001c0  43 65 db f8 9d 96 90 f0  b1 f9 08 a6 ce 27 da 62  |Ce...........'.b|
+000001d0  9f 19 e4 24 76 5d 7d c9  2b e8 1d e5 90 66 52 70  |...$v]}.+....fRp|
+000001e0  42 20 44 a4 23 8e 07 66  b9 69 44 35 ce 7d 41 ea  |B D.#..f.iD5.}A.|
+000001f0  8b 3b 68 09 4d 91 c1 2c  d4 24 e6 ec e2 24 34 52  |.;h.M..,.$...$4R|
+00000200  97 80 79 d8 d8 97 f1 b9  59 bc 07 91 6f 39 fa c9  |..y.....Y...o9..|
+00000210  de 91 cf ce a4 00 1e b9  62 91 72 71 ef 33 c1 cd  |........b.rq.3..|
+00000220  46 c0 17 e0 a2 00 ab 54  dd 77 20 16 ce fa 91 9b  |F......T.w .....|
+00000230  f6 25 03 c3 94 b4 22 f1  22 13 9e 91 7b d0 9e 47  |.%...."."...{..G|
+00000240  1c 42 38 c5 ff 56 40 f6  54 cd bb 11 b9 b4 2b 7b  |.B8..V@.T.....+{|
+00000250  9a b8 2c 65 c4 d2 c5 81  8d ad fa ae e1 67 33 cc  |..,e.........g3.|
+00000260  98 4f 60 2d 36 9e fb b6  ef fb 3e e5 a7 37 5a ac  |.O`-6.....>..7Z.|
+00000270  c0 ea 02 89 96 e1 3e 59  4f 8e 34 7f 71 26 e2 8f  |......>YO.4.q&..|
+00000280  c5 f4 96 3c 50 62 1e b0  7a 6f e7 8a cd 77 69 f1  |...<Pb..zo...wi.|
+00000290  8f 97 ee c5 1a 0c ef 0f  3d e6 39 19 8b 07 5a 5d  |........=.9...Z]|
+000002a0  eb ec 97 f4 8e 32 74 b8  82 73 2c 4c c0 dd b4 15  |.....2t..s,L....|
+000002b0  90 03 74 84 8f d0 ce cc  54 75 ce 20 45 15 43 7d  |..t.....Tu. E.C}|
+000002c0  35 59 22 d7 cb 92 1c eb  f4 27 3c 10 e8 92 57 c3  |5Y"......'<...W.|
+000002d0  3a 55 87 6b 2b f3 3e a2  d6 5a 6f ca 07 0b 38 bd  |:U.k+.>..Zo...8.|
+000002e0  2b a1 a9 f4 e2 ec c3 0d  62 a8 75 31 52 27 97 30  |+.......b.u1R'.0|
+000002f0  4a 35 50 df f8 61 65 74  95 09 47 3e 22 eb bd 68  |J5P..aet..G>"..h|
+00000300  12 d5 ab 4b f7 4e 2e b1  c3 90 5f 47 96 3d 84 c6  |...K.N...._G.=..|
+00000310  9a a9 68 17 03 03 00 99  9e 63 9e 0c 56 07 57 b6  |..h......c..V.W.|
+00000320  1d 97 51 0d e1 e9 88 df  9f b9 b2 ff cb 07 f7 b9  |..Q.............|
+00000330  3a ad a2 f3 02 f8 88 b1  f1 3a 2a 06 6d 7e 26 93  |:........:*.m~&.|
+00000340  52 2b bd c0 06 39 fc ac  ee 69 70 b3 2a 53 42 ec  |R+...9...ip.*SB.|
+00000350  f1 2e a1 d9 6b 4f a3 bb  39 a1 cd 96 24 24 44 f6  |....kO..9...$$D.|
+00000360  13 88 0b de 69 73 c4 c3  23 3f 00 f4 25 29 92 aa  |....is..#?..%)..|
+00000370  2e 3f fa 7f ec b3 2b b9  cd 67 db 1d d7 20 e6 6d  |.?....+..g... .m|
+00000380  db af 0d 37 61 62 eb b3  57 26 14 0a f7 fd 61 78  |...7ab..W&....ax|
+00000390  44 69 62 63 b8 6f 8b 0f  78 0d 91 87 0e 9e ac 0e  |Dibc.o..x.......|
+000003a0  e5 ad 7c 03 e1 c4 7e 91  10 25 79 f5 26 ab 87 3d  |..|...~..%y.&..=|
+000003b0  4e 17 03 03 00 35 63 46  7f ea 3c 99 0c 75 49 bc  |N....5cF..<..uI.|
+000003c0  8b 08 2b 33 6c 6f 08 d8  2c f4 f0 ef e9 39 bc 58  |..+3lo..,....9.X|
+000003d0  c2 2f 7f 59 65 9e 44 ec  55 31 f0 56 29 2f ae 7d  |./.Ye.D.U1.V)/.}|
+000003e0  32 47 3b 11 96 40 73 c0  7d 6a 91 17 03 03 00 88  |2G;..@s.}j......|
+000003f0  9e 69 5e 5f 46 e6 c3 33  73 a5 d3 38 d4 f4 6b 45  |.i^_F..3s..8..kE|
+00000400  c8 34 ea 8f fb e8 c2 e1  02 ca d7 2f 20 48 2c f0  |.4........./ H,.|
+00000410  e5 8a 9a 9a c6 55 a2 d9  02 5f 7f df 93 53 9b b1  |.....U..._...S..|
+00000420  f9 2a 65 2c a9 47 0b a2  2c 12 2e b6 07 3c ac 63  |.*e,.G..,....<.c|
+00000430  d2 a7 ac b5 1a 3f b7 ea  9a a7 0b 70 6c 76 65 fe  |.....?.....plve.|
+00000440  5e 42 09 f4 3a 67 07 78  11 2a 74 1d 3e a4 01 c5  |^B..:g.x.*t.>...|
+00000450  d5 57 5b 94 1e 52 1f 0f  e4 e2 c3 f1 ab 8f 09 81  |.W[..R..........|
+00000460  d4 4f d2 76 4c d3 73 d8  2a ed c0 6c 65 40 2b 19  |.O.vL.s.*..le@+.|
+00000470  bd 8d 0a 9b e9 9c da 2c                           |.......,|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 2d 42 76 94 8e  |..........5-Bv..|
-00000010  3b a3 da ff 05 97 70 a6  e7 ea ea bd 53 f2 02 fd  |;.....p.....S...|
-00000020  50 2b 6a fa 22 38 7f b7  50 2c ab d2 6e ee 23 86  |P+j."8..P,..n.#.|
-00000030  ec 3e ff 13 da 96 82 df  c7 84 80 3f 5c c6 dc 0d  |.>.........?\...|
+00000000  14 03 03 00 01 01 17 03  03 00 35 02 55 fc 25 4b  |..........5.U.%K|
+00000010  b5 7e 6e 2b 57 22 c5 34  4b 8d 52 64 df 67 8c 29  |.~n+W".4K.Rd.g.)|
+00000020  b5 84 a3 59 56 23 4f 97  6f be 11 fd df e0 d8 41  |...YV#O.o......A|
+00000030  bf 83 0b 80 cb ef 9d ce  87 b4 70 12 37 3c 36 c7  |..........p.7<6.|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 64 41 51  db 02 de 2c df a6 03 99  |.....dAQ...,....|
-00000010  9d 7d 0d b4 bc 11 81 a2  1e 22 0c c6 3f 54 2e fd  |.}......."..?T..|
-00000020  4a bd c7 17 03 03 00 13  c3 cf 03 93 a4 95 42 47  |J.............BG|
-00000030  72 c9 aa 09 24 98 b3 0b  af 41 ee                 |r...$....A.|
+00000000  17 03 03 00 1e 78 89 4a  fe 24 43 a1 e0 b0 10 3c  |.....x.J.$C....<|
+00000010  12 da 92 be a9 6a dc fc  f9 2e bc 8d 97 ac 41 70  |.....j........Ap|
+00000020  da f7 a2 17 03 03 00 13  05 42 c2 61 8a 7d b7 c7  |.........B.a.}..|
+00000030  2a df 30 97 25 7e 35 d1  82 8d 6d                 |*.0.%~5...m|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-IssueTicketPreDisable b/src/crypto/tls/testdata/Server-TLSv13-IssueTicketPreDisable
index 3c43fda044..75f9b7fda9 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-IssueTicketPreDisable
+++ b/src/crypto/tls/testdata/Server-TLSv13-IssueTicketPreDisable
@@ -1,98 +1,98 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ce 01 00 00  ca 03 03 7d f8 a3 41 a3  |...........}..A.|
-00000010  8e 32 fa 2b c0 94 57 7d  3c 9f 78 e0 57 59 fa bc  |.2.+..W}<.x.WY..|
-00000020  3a d0 9f ae 2a 6c da 5e  4e ed f0 20 31 ee 6b a2  |:...*l.^N.. 1.k.|
-00000030  cd b0 82 e8 f0 9e cb 84  0f 5e bf ff 87 f9 95 9d  |.........^......|
-00000040  fb 19 5e 78 e6 5a 31 02  6a d8 4c 25 00 04 13 01  |..^x.Z1.j.L%....|
+00000000  16 03 01 00 ce 01 00 00  ca 03 03 ce 7e 18 d7 48  |............~..H|
+00000010  d4 9c 98 95 ef 53 20 6b  af 27 2c e9 4b f5 fd d1  |.....S k.',.K...|
+00000020  b7 e7 cf 89 95 24 a2 b6  3f a6 48 20 80 a4 f8 a6  |.....$..?.H ....|
+00000030  96 d7 76 ad 98 e4 f6 6e  6d 48 c9 d4 77 c5 ce 30  |..v....nmH..w..0|
+00000040  13 d0 47 0e 59 ca 30 1b  26 01 d3 96 00 04 13 01  |..G.Y.0.&.......|
 00000050  00 ff 01 00 00 7d 00 0b  00 04 03 00 01 02 00 0a  |.....}..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 16 00 00 00 17  00 00 00 0d 00 1e 00 1c  |................|
 00000080  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000090  08 04 08 05 08 06 04 01  05 01 06 01 00 2b 00 03  |.............+..|
 000000a0  02 03 04 00 2d 00 02 01  01 00 33 00 26 00 24 00  |....-.....3.&.$.|
-000000b0  1d 00 20 d3 4d 46 49 bd  60 af b2 5a 9b 6e 46 89  |.. .MFI.`..Z.nF.|
-000000c0  53 fd 32 84 7c f7 4e a1  52 4c 07 21 07 db c5 62  |S.2.|.N.RL.!...b|
-000000d0  54 a2 17                                          |T..|
+000000b0  1d 00 20 00 3a 93 6e 68  39 4d c8 80 23 b0 b8 2d  |.. .:.nh9M..#..-|
+000000c0  30 0d 19 d8 ce 95 31 f5  0b 5f 39 54 a7 98 6f 88  |0.....1.._9T..o.|
+000000d0  c8 52 50                                          |.RP|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 31 ee 6b a2  |........... 1.k.|
-00000030  cd b0 82 e8 f0 9e cb 84  0f 5e bf ff 87 f9 95 9d  |.........^......|
-00000040  fb 19 5e 78 e6 5a 31 02  6a d8 4c 25 13 01 00 00  |..^x.Z1.j.L%....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 80 a4 f8 a6  |........... ....|
+00000030  96 d7 76 ad 98 e4 f6 6e  6d 48 c9 d4 77 c5 ce 30  |..v....nmH..w..0|
+00000040  13 d0 47 0e 59 ca 30 1b  26 01 d3 96 13 01 00 00  |..G.Y.0.&.......|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 ed 6e e0 ce 2a 1f  |...........n..*.|
-00000090  e0 18 72 a1 ad 6e 38 82  c4 73 db ae 5b 6b 5f 8d  |..r..n8..s..[k_.|
-000000a0  ce 17 03 03 02 6d d9 e6  ad 08 ea a2 08 5a 22 5b  |.....m.......Z"[|
-000000b0  32 87 0d 6b b1 c4 59 0c  c8 bd af 20 98 22 2e 2e  |2..k..Y.... ."..|
-000000c0  7e 2f 43 3c a1 54 b2 85  8a 08 98 05 8c 43 97 32  |~/C<.T.......C.2|
-000000d0  ca bd 72 2a f8 d3 24 1e  f5 8a f9 d3 35 5f c5 6b  |..r*..$.....5_.k|
-000000e0  cc e3 46 8f 99 3b c4 2d  e8 3b ca f3 81 a6 41 87  |..F..;.-.;....A.|
-000000f0  5d 11 99 12 2c c7 43 32  e0 90 dc 1a 0c ec 4c 9f  |]...,.C2......L.|
-00000100  b0 16 bb da 79 f1 e2 05  6d 07 41 db ba 73 5c d6  |....y...m.A..s\.|
-00000110  24 87 15 2a 76 4c 9e ef  1b 5c 94 bb cb d2 ef d7  |$..*vL...\......|
-00000120  b0 50 e6 e4 dd 48 7c d1  a3 46 5b 72 23 d1 42 f0  |.P...H|..F[r#.B.|
-00000130  05 33 12 34 b1 40 4f e5  b7 82 ec 94 14 19 43 2f  |.3.4.@O.......C/|
-00000140  66 b7 a9 88 42 72 a4 0d  5e 76 4c 3e a7 f5 ae 6b  |f...Br..^vL>...k|
-00000150  ef b4 1d f0 69 37 92 de  20 5a d3 62 99 b4 56 36  |....i7.. Z.b..V6|
-00000160  8c a9 91 34 06 66 a7 bf  a8 12 21 8c e2 88 9a c3  |...4.f....!.....|
-00000170  69 60 a0 09 db 87 3a ef  4e bf f8 5a 8a d6 ae 07  |i`....:.N..Z....|
-00000180  94 1d 70 0d f3 32 dd 16  af 35 25 2a a3 80 ea 0b  |..p..2...5%*....|
-00000190  d0 e6 f0 c7 fd 95 c9 ad  91 15 ba 93 d1 0b 13 9d  |................|
-000001a0  6e d7 19 eb 69 75 1b b0  f2 d3 aa b6 55 1d d2 87  |n...iu......U...|
-000001b0  d0 fb eb 5b 9f 1b 36 7e  e9 87 7f ec 76 6a 0d 4a  |...[..6~....vj.J|
-000001c0  af dd 2f 27 2b 33 b6 24  8f f1 d7 87 71 31 8a 91  |../'+3.$....q1..|
-000001d0  b0 48 d8 13 22 ae 98 1b  7d da 8b a8 e9 9f 09 02  |.H.."...}.......|
-000001e0  92 90 72 6a 96 9e 36 0f  70 d3 f4 66 ef e6 4e 45  |..rj..6.p..f..NE|
-000001f0  e6 2b c3 0b 18 4b a2 19  fb 37 f9 63 81 31 6b 0b  |.+...K...7.c.1k.|
-00000200  eb 8b 3a 3e ab fe 6b 2f  9e 01 b4 cc cc 35 95 fa  |..:>..k/.....5..|
-00000210  8e 5c 07 a4 99 c3 9f aa  9f 73 26 0b aa 31 2b 74  |.\.......s&..1+t|
-00000220  d6 06 4b 64 1a af 18 23  87 10 d0 f2 6b 19 9b f8  |..Kd...#....k...|
-00000230  01 08 0f 71 78 c3 09 91  1d fa 1a 0d 2f 61 eb 2e  |...qx......./a..|
-00000240  db 78 b8 ec 1a a9 80 e8  88 71 74 e9 1f 70 0b 06  |.x.......qt..p..|
-00000250  9c 18 16 db 6f bc 34 af  a5 c2 2a 38 91 01 a2 7c  |....o.4...*8...||
-00000260  be f4 c7 f9 f0 a0 9a 61  d8 b5 7d e0 07 52 b7 95  |.......a..}..R..|
-00000270  0c 27 cd 4c ce 2a 55 fa  95 25 10 34 64 9b eb 59  |.'.L.*U..%.4d..Y|
-00000280  f2 3d f4 0e 25 5b a7 ab  e3 0d 4b fd 4d 68 41 3b  |.=..%[....K.MhA;|
-00000290  9d fa 05 a1 db 16 82 bb  64 aa fd 53 68 43 4c d7  |........d..ShCL.|
-000002a0  11 94 12 c9 58 6f 9a a8  85 2d d4 22 6a 89 da 4f  |....Xo...-."j..O|
-000002b0  51 4e 27 40 69 78 0d 01  0e 3f ab 02 8b 33 81 06  |QN'@ix...?...3..|
-000002c0  85 b7 1d 54 94 ec 33 21  92 18 86 4f d9 84 db 72  |...T..3!...O...r|
-000002d0  e0 40 33 21 c9 76 44 c7  68 8e 4d a5 63 0d 03 19  |.@3!.vD.h.M.c...|
-000002e0  23 1f 45 52 bc b4 8c 1a  4d 6c 7a 92 d5 ec 62 36  |#.ER....Mlz...b6|
-000002f0  d6 e1 15 05 59 78 ed 56  bd 25 46 4b a5 ad 29 7b  |....Yx.V.%FK..){|
-00000300  d9 96 30 d5 7a e1 76 a6  96 46 ae 8a 58 74 a6 8b  |..0.z.v..F..Xt..|
-00000310  97 67 d2 17 03 03 00 99  4b 45 cf 2a 67 91 dd 9c  |.g......KE.*g...|
-00000320  f9 28 8d 83 4c 89 8b bf  44 c1 d9 7a 17 10 85 9c  |.(..L...D..z....|
-00000330  79 d5 4e 2c 4f ba e6 38  bb 16 7d ff 3a 0c ae 3c  |y.N,O..8..}.:..<|
-00000340  50 eb 22 a7 df 24 73 ab  ca 46 a1 e9 a8 99 78 85  |P."..$s..F....x.|
-00000350  84 a1 13 84 53 6c 9f 3c  d7 84 6a 12 2a 5c f5 f7  |....Sl.<..j.*\..|
-00000360  23 89 19 d4 4c 21 f7 b5  b5 02 2e e3 d9 da fe c9  |#...L!..........|
-00000370  f2 37 33 f4 fd f6 45 8a  9f 73 8e 2d 80 99 e2 e4  |.73...E..s.-....|
-00000380  32 52 98 57 2c 3c 42 4f  72 de ed 89 91 68 18 ea  |2R.W,<BOr....h..|
-00000390  bb 07 64 91 27 83 04 b5  58 9b e4 28 2a fb 66 3f  |..d.'...X..(*.f?|
-000003a0  33 42 5c 9b 3f 20 fa 73  50 2c 3e bd b2 49 31 2b  |3B\.? .sP,>..I1+|
-000003b0  0b 17 03 03 00 35 f4 a5  c2 54 4d 63 16 4c 0c 73  |.....5...TMc.L.s|
-000003c0  46 06 b8 2d 31 e9 01 10  fc 57 11 32 31 f7 d2 c7  |F..-1....W.21...|
-000003d0  d4 ba 71 da f3 64 89 93  22 a4 6e ca eb 28 cf d4  |..q..d..".n..(..|
-000003e0  39 00 39 ac fa cf 45 17  ab fe cf 17 03 03 00 87  |9.9...E.........|
-000003f0  f4 ea ee 83 93 02 f2 1a  50 f6 e8 70 92 5b a3 41  |........P..p.[.A|
-00000400  4e d8 aa d9 70 f2 c1 0e  ed 87 50 d6 11 84 38 ec  |N...p.....P...8.|
-00000410  f1 2d 0c ff eb 05 14 d1  b7 37 4e cd 2d ad a0 ea  |.-.......7N.-...|
-00000420  3c ae 2d f3 0e d7 84 15  6f 07 06 16 6e 2d 79 64  |<.-.....o...n-yd|
-00000430  e8 19 4b c2 9c 36 16 48  bb 9e fc d9 90 96 b4 15  |..K..6.H........|
-00000440  4d 1b b9 ee c1 d0 de 59  90 b2 f8 a7 9b c7 f5 16  |M......Y........|
-00000450  8e 19 72 39 0c 8d 70 67  f8 e9 9b d8 6c ec 51 80  |..r9..pg....l.Q.|
-00000460  4c 77 2d f7 59 ee 8b e4  f5 6b 52 4e 3c 1a e5 e8  |Lw-.Y....kRN<...|
-00000470  fb b8 15 c0 5a be 16                              |....Z..|
+00000080  03 03 00 01 01 17 03 03  00 17 67 92 de 58 e6 a7  |..........g..X..|
+00000090  a0 15 83 48 39 a0 71 40  35 04 27 b5 fb ac 3f d0  |...H9.q@5.'...?.|
+000000a0  04 17 03 03 02 6d 20 5f  87 47 d8 ea c6 97 b4 dd  |.....m _.G......|
+000000b0  4d 95 39 22 d6 2e 65 ff  ce 63 77 d6 b0 82 a5 b3  |M.9"..e..cw.....|
+000000c0  aa a5 3b 61 24 86 70 b6  d9 8a 24 3e 24 20 cb 57  |..;a$.p...$>$ .W|
+000000d0  d6 44 f7 e4 77 31 78 eb  2f 0d bc 48 bd ac 77 6e  |.D..w1x./..H..wn|
+000000e0  1a 51 67 7b eb 48 4a 78  cb de dc 80 4e a3 82 0c  |.Qg{.HJx....N...|
+000000f0  02 45 b8 e3 48 0b b5 c8  e9 51 17 61 f9 a0 f0 74  |.E..H....Q.a...t|
+00000100  8a 29 c6 05 31 c4 6b c5  a4 d3 65 2e d4 17 29 18  |.)..1.k...e...).|
+00000110  2a b0 19 95 b4 90 44 16  8e 9e 2c 4a a1 70 0c 92  |*.....D...,J.p..|
+00000120  bd 27 0e 91 5e 21 75 00  5d 55 12 16 c9 b2 6a 11  |.'..^!u.]U....j.|
+00000130  20 17 18 f1 00 e8 71 38  03 ab 85 39 c9 72 a1 81  | .....q8...9.r..|
+00000140  42 94 82 1c 8c 15 95 32  8a 27 a3 59 e6 d8 b4 36  |B......2.'.Y...6|
+00000150  b8 37 e0 53 3f cf 7e 53  01 b0 c1 da 82 d7 b6 d7  |.7.S?.~S........|
+00000160  a9 7a c0 fa ec 9c 82 37  28 cf 45 6a aa d8 38 18  |.z.....7(.Ej..8.|
+00000170  14 92 42 62 0a 3c 29 34  a8 da c6 f8 f0 b1 c7 4d  |..Bb.<)4.......M|
+00000180  b9 75 ba a7 20 f1 78 00  77 01 2f d9 58 dc 2c 20  |.u.. .x.w./.X., |
+00000190  05 b7 84 7c 7e fc 3c 92  ad f3 0b ba 78 a1 c0 be  |...|~.<.....x...|
+000001a0  19 8b 11 9b 26 ee 9f 29  bc 3f 61 a6 7a 78 a9 d3  |....&..).?a.zx..|
+000001b0  94 24 b2 4d b1 76 7a 6f  72 7b fd 5d 40 70 75 91  |.$.M.vzor{.]@pu.|
+000001c0  a8 1e 51 50 c9 88 a0 f6  87 9d db 2e 7e a6 78 9c  |..QP........~.x.|
+000001d0  8d b5 13 84 c7 56 fd 59  fe ec d4 45 be 04 06 cc  |.....V.Y...E....|
+000001e0  81 9e 51 8c e6 3f c0 0f  6e 24 40 48 ce fb 3f 17  |..Q..?..n$@H..?.|
+000001f0  d5 ec f6 7b f8 e8 64 fc  19 1b e4 ce bc 94 3f 89  |...{..d.......?.|
+00000200  11 ea 2f 48 6e 99 09 f4  65 5b c6 e3 b8 4d 61 c2  |../Hn...e[...Ma.|
+00000210  ea 70 d9 60 58 55 29 a5  e4 b2 0b 5b 84 f4 b8 87  |.p.`XU)....[....|
+00000220  e1 9c 56 27 3b d3 c3 48  c9 dc 20 71 7e 94 8f 99  |..V';..H.. q~...|
+00000230  91 a8 da 48 6d 94 32 98  86 51 ae 89 04 49 64 5a  |...Hm.2..Q...IdZ|
+00000240  de 28 eb 4c 57 68 d9 f1  a2 57 f9 1e 07 53 1e 2e  |.(.LWh...W...S..|
+00000250  5b d2 c5 a9 09 c3 8a e2  d2 25 05 5d 47 8d f7 a0  |[........%.]G...|
+00000260  a7 b9 e7 95 e3 7f 10 b0  f2 48 96 f0 fa ae 21 3a  |.........H....!:|
+00000270  8a d3 d3 03 7f 19 8e de  ea 2a fb 21 d9 a0 a6 92  |.........*.!....|
+00000280  2f f7 55 21 5d 50 46 86  03 e9 f9 30 89 2e e7 9f  |/.U!]PF....0....|
+00000290  65 f9 e6 81 c9 21 d6 3d  0e 27 45 be 73 e2 7d 7f  |e....!.=.'E.s.}.|
+000002a0  45 c7 25 8b 72 34 e3 5b  bd 2a e7 10 58 e7 2e 17  |E.%.r4.[.*..X...|
+000002b0  2b ed 8f b2 82 b0 ae 45  f4 f2 be 38 88 b7 d7 1b  |+......E...8....|
+000002c0  4a 8d dc 83 28 1c c0 8f  dd 71 6b 4d e7 4c 93 bd  |J...(....qkM.L..|
+000002d0  5b 2c 81 bb 4d 17 51 96  22 b3 bc 33 a6 d4 e6 fa  |[,..M.Q."..3....|
+000002e0  4f ac 49 e3 94 0c 49 af  09 34 ae 76 b0 98 01 e9  |O.I...I..4.v....|
+000002f0  ec 3c 6e 2e 4c 4f bf c2  67 b6 f2 3e f9 aa 21 22  |.<n.LO..g..>..!"|
+00000300  05 f7 08 0e e2 7e a5 ae  dd ae 09 4a cd 42 4b 43  |.....~.....J.BKC|
+00000310  a1 28 0a 17 03 03 00 99  4c ec 7b 01 4d 42 22 a4  |.(......L.{.MB".|
+00000320  c4 88 dc c9 37 76 c2 5b  e5 2c 23 70 63 62 8a bd  |....7v.[.,#pcb..|
+00000330  4f b3 ca 67 99 3c b8 de  cd a5 00 2d 1f cd fd bd  |O..g.<.....-....|
+00000340  09 4c 6a 23 d8 7c 2a 53  92 1f 16 9f e7 6c 3a 39  |.Lj#.|*S.....l:9|
+00000350  39 af 7f f2 d9 06 18 e8  a3 77 23 1d 25 48 b7 ef  |9........w#.%H..|
+00000360  00 f7 ed 80 97 01 50 d7  e7 30 3e 64 14 83 66 c3  |......P..0>d..f.|
+00000370  d0 fc d0 f7 2c 6b 74 98  72 64 18 2c 62 b4 27 f7  |....,kt.rd.,b.'.|
+00000380  99 bb c0 91 ea 9b ff 60  fa 16 3c 66 92 f2 de 15  |.......`..<f....|
+00000390  79 05 24 b2 5b 05 a5 5f  0b 0e 65 96 58 ab 68 03  |y.$.[.._..e.X.h.|
+000003a0  91 0e f0 bb 9a 3c 7d 24  7f ea 7b 41 18 b7 ac 00  |.....<}$..{A....|
+000003b0  0b 17 03 03 00 35 c5 91  97 a8 66 c3 4b 20 cc c0  |.....5....f.K ..|
+000003c0  d2 b6 88 53 40 ce 6f d3  63 1c 05 83 89 f5 ab 3e  |...S@.o.c......>|
+000003d0  b9 1a ec 71 b0 d3 0b b9  a0 c8 a2 da dc c5 72 8c  |...q..........r.|
+000003e0  a7 65 ff b3 4b 93 cd 92  05 4b ca 17 03 03 00 88  |.e..K....K......|
+000003f0  ff 7f 3d 21 c6 19 40 af  01 a8 4d 8f af f3 94 ac  |..=!..@...M.....|
+00000400  c2 ee 67 a9 ac 87 4d 09  12 36 8f f4 ee 5c 9c 3a  |..g...M..6...\.:|
+00000410  a7 48 ac de d9 d9 4f 9b  97 5a 76 2f 92 91 e4 1b  |.H....O..Zv/....|
+00000420  b4 74 1a da 9d 52 c8 8d  10 03 56 b8 9d 96 e4 92  |.t...R....V.....|
+00000430  b7 d9 ab 39 47 e2 ec 27  0a 00 55 7e 16 dc e8 b0  |...9G..'..U~....|
+00000440  ad 30 c3 57 54 c7 97 8d  26 71 80 31 27 b6 0e fc  |.0.WT...&q.1'...|
+00000450  ac ff 50 3a 16 e0 f1 e7  02 3b 30 f4 6f f2 72 30  |..P:.....;0.o.r0|
+00000460  40 8b 4b 1d 2c 31 ec ce  ee 46 24 cf e4 83 c6 b0  |@.K.,1...F$.....|
+00000470  b9 11 5b f9 14 dc c0 50                           |..[....P|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 c8 76 b6 78 ce  |..........5.v.x.|
-00000010  e3 7b c8 72 95 65 c0 66  aa d4 6e 61 6f 75 9a 18  |.{.r.e.f..naou..|
-00000020  a3 43 54 45 d2 69 9a 11  d5 96 67 df 7e 08 71 1a  |.CTE.i....g.~.q.|
-00000030  66 eb ec d3 8d 20 1a 3a  e2 82 d5 3c f9 c1 6f b9  |f.... .:...<..o.|
+00000000  14 03 03 00 01 01 17 03  03 00 35 8d c2 91 42 bb  |..........5...B.|
+00000010  59 56 52 f6 be d3 1e b8  73 e2 6f cd 7e b7 65 6b  |YVR.....s.o.~.ek|
+00000020  45 6c 59 00 31 96 c8 ac  9d 91 5f d9 02 31 17 ed  |ElY.1....._..1..|
+00000030  a5 91 6d 00 9e 44 0f ae  33 d1 a9 c3 6b f7 a1 fa  |..m..D..3...k...|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e af 6d 98  41 83 13 3c 4e 60 06 a8  |......m.A..<N`..|
-00000010  f8 62 53 39 1a f5 7f 5b  54 ed 87 09 20 71 15 f6  |.bS9...[T... q..|
-00000020  ec ff 31 17 03 03 00 13  05 88 31 71 25 e2 f0 97  |..1.......1q%...|
-00000030  86 83 a4 73 ec 84 42 51  de a4 cd                 |...s..BQ...|
+00000000  17 03 03 00 1e f6 8f cc  46 63 2c e9 70 d9 0e 9d  |........Fc,.p...|
+00000010  86 5e a2 f0 c1 94 41 01  54 50 48 24 22 bf 41 f3  |.^....A.TPH$".A.|
+00000020  8a eb 76 17 03 03 00 13  c9 63 39 fa 7a c6 da df  |..v......c9.z...|
+00000030  f4 49 08 0f 95 43 09 4a  c1 5d cc                 |.I...C.J.].|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-P256 b/src/crypto/tls/testdata/Server-TLSv13-P256
index 8a95b19246..39cae7e97c 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-P256
+++ b/src/crypto/tls/testdata/Server-TLSv13-P256
@@ -1,101 +1,101 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 e3 01 00 00  df 03 03 2d 03 4a 3d a9  |...........-.J=.|
-00000010  32 02 db 36 0b 4a 8c be  db 46 b0 9d 0e 63 7e 6c  |2..6.J...F...c~l|
-00000020  05 bd 11 7b ed 86 93 0a  8e 3c 05 20 a9 97 4e cc  |...{.....<. ..N.|
-00000030  6c a5 9a 89 49 e3 17 8b  f2 7c a4 eb eb 73 19 50  |l...I....|...s.P|
-00000040  e7 68 04 b8 05 28 c5 34  ef 8a 06 28 00 04 13 03  |.h...(.4...(....|
+00000000  16 03 01 00 e3 01 00 00  df 03 03 4f 01 d7 17 f7  |...........O....|
+00000010  fe e7 90 88 cb a3 23 5f  9d 21 31 3e 3a 6b 9d ee  |......#_.!1>:k..|
+00000020  6a 05 12 26 09 fd 46 83  aa e7 af 20 7f e3 24 d7  |j..&..F.... ..$.|
+00000030  4b 09 77 64 ff 4d b3 ef  f6 60 d3 df fd 57 dc 80  |K.wd.M...`...W..|
+00000040  7a 95 d3 22 49 e7 96 38  6d aa 38 b7 00 04 13 03  |z.."I..8m.8.....|
 00000050  00 ff 01 00 00 92 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 04 00 02 00 17 00 16  00 00 00 17 00 00 00 0d  |................|
 00000070  00 1e 00 1c 04 03 05 03  06 03 08 07 08 08 08 09  |................|
 00000080  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
 00000090  00 2b 00 03 02 03 04 00  2d 00 02 01 01 00 33 00  |.+......-.....3.|
-000000a0  47 00 45 00 17 00 41 04  8c 1a 93 91 38 e2 4f a3  |G.E...A.....8.O.|
-000000b0  b1 27 91 63 c5 34 15 17  3a 65 d4 55 76 c0 62 92  |.'.c.4..:e.Uv.b.|
-000000c0  36 87 80 19 2f c0 02 17  a5 30 b8 25 51 c0 84 1f  |6.../....0.%Q...|
-000000d0  69 f0 6a 62 86 ee 17 f7  e7 ec 39 5b 9c 02 ca f8  |i.jb......9[....|
-000000e0  f7 4c 3a 08 44 7a ad bb                           |.L:.Dz..|
+000000a0  47 00 45 00 17 00 41 04  2f c6 35 98 c9 7b ba 92  |G.E...A./.5..{..|
+000000b0  5c 09 f5 9d 4b 51 2e c4  76 e1 a1 52 cc 21 d9 54  |\...KQ..v..R.!.T|
+000000c0  53 48 31 ec 79 a4 ad b9  54 ae a5 39 c0 6c f1 d7  |SH1.y...T..9.l..|
+000000d0  c9 44 f8 87 b2 1f 0f be  1b de 05 eb 38 44 dc 83  |.D..........8D..|
+000000e0  da a0 77 63 59 f2 fa 28                           |..wcY..(|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 9b 02 00 00  97 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 a9 97 4e cc  |........... ..N.|
-00000030  6c a5 9a 89 49 e3 17 8b  f2 7c a4 eb eb 73 19 50  |l...I....|...s.P|
-00000040  e7 68 04 b8 05 28 c5 34  ef 8a 06 28 13 03 00 00  |.h...(.4...(....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 7f e3 24 d7  |........... ..$.|
+00000030  4b 09 77 64 ff 4d b3 ef  f6 60 d3 df fd 57 dc 80  |K.wd.M...`...W..|
+00000040  7a 95 d3 22 49 e7 96 38  6d aa 38 b7 13 03 00 00  |z.."I..8m.8.....|
 00000050  4f 00 2b 00 02 03 04 00  33 00 45 00 17 00 41 04  |O.+.....3.E...A.|
 00000060  1e 18 37 ef 0d 19 51 88  35 75 71 b5 e5 54 5b 12  |..7...Q.5uq..T[.|
 00000070  2e 8f 09 67 fd a7 24 20  3e b2 56 1c ce 97 28 5e  |...g..$ >.V...(^|
 00000080  f8 2b 2d 4f 9e f1 07 9f  6c 4b 5b 83 56 e2 32 42  |.+-O....lK[.V.2B|
 00000090  e9 58 b6 d7 49 a6 b5 68  1a 41 03 56 6b dc 5a 89  |.X..I..h.A.Vk.Z.|
-000000a0  14 03 03 00 01 01 17 03  03 00 17 ba 54 2f 11 a8  |............T/..|
-000000b0  e1 fc ea 27 71 ce 16 59  ba f2 65 46 97 3f a9 be  |...'q..Y..eF.?..|
-000000c0  2d 0a 17 03 03 02 6d ed  e2 40 f3 d0 8d ed 92 ae  |-.....m..@......|
-000000d0  8a a0 b7 f1 5a ba 9b 3f  35 0a f1 63 f1 91 d5 ff  |....Z..?5..c....|
-000000e0  26 b7 57 71 d4 bd e2 38  91 fb 9a 47 b6 8a 08 3a  |&.Wq...8...G...:|
-000000f0  c2 59 32 8c 8e a4 2a e9  54 59 a8 b9 3b c8 72 34  |.Y2...*.TY..;.r4|
-00000100  8b 38 a2 19 c7 70 fd 2c  0c 73 08 ec 05 f9 7b c4  |.8...p.,.s....{.|
-00000110  74 64 af 32 4e 2b 98 fe  f6 d9 9b 10 0f 66 ec 76  |td.2N+.......f.v|
-00000120  2b b8 d1 12 23 63 0c fb  fa 56 ae a0 0b 6b 91 db  |+...#c...V...k..|
-00000130  b0 b0 6c ce 64 c6 5c 66  dd dd 2d df a8 09 a8 59  |..l.d.\f..-....Y|
-00000140  23 98 74 76 ec d1 10 57  04 2c fd e5 83 db 3c 6d  |#.tv...W.,....<m|
-00000150  6d 1a 6a 82 03 fb ab 24  a7 4c 21 ce 12 c4 3c f4  |m.j....$.L!...<.|
-00000160  0f cb ed f9 6f 26 11 03  75 72 3b 9f 4a e1 da e9  |....o&..ur;.J...|
-00000170  1e 45 73 49 96 33 26 0e  9a 83 dc 27 48 ed 8d 20  |.EsI.3&....'H.. |
-00000180  58 f4 da b5 42 9e 23 4d  b5 95 2a e2 b2 55 c4 36  |X...B.#M..*..U.6|
-00000190  3a 77 3c ca ab 52 45 94  1d 36 29 58 15 c9 ea f6  |:w<..RE..6)X....|
-000001a0  82 6d 6a e4 f0 8e 16 6f  3a 35 b0 db 3e 06 5f ea  |.mj....o:5..>._.|
-000001b0  e7 1c 89 9b 56 8a 84 5e  8f d3 65 39 46 8b bd 60  |....V..^..e9F..`|
-000001c0  c0 b5 ad 8d 13 cc 7f d0  90 08 2d c4 b5 a1 3d f7  |..........-...=.|
-000001d0  6c 14 6c 16 af 69 88 cf  50 9a 47 8f c3 a7 7f 9d  |l.l..i..P.G.....|
-000001e0  2d 75 d4 08 3b f2 ae d8  1a a8 de 67 eb 50 8c e7  |-u..;......g.P..|
-000001f0  e1 d0 37 8a 97 24 34 0f  1d 6a 65 4e 1c cf 91 6b  |..7..$4..jeN...k|
-00000200  24 20 d3 ba a0 d4 d0 95  62 fd b9 55 9c 37 69 c3  |$ ......b..U.7i.|
-00000210  27 99 f2 f5 ca 7a 27 24  3d 75 d4 5c a2 ad df e3  |'....z'$=u.\....|
-00000220  d2 69 5d cb b6 78 29 ad  90 78 f1 48 0f 80 d4 45  |.i]..x)..x.H...E|
-00000230  17 00 f4 53 9a 42 4b 6f  a2 f6 bf 95 07 e5 cc db  |...S.BKo........|
-00000240  36 d7 21 c9 42 67 40 16  d6 77 d1 5b 05 45 97 96  |6.!.Bg@..w.[.E..|
-00000250  25 8d e4 28 dc 1a c0 d6  72 2b 06 54 fc b0 0d cd  |%..(....r+.T....|
-00000260  fc 8e 06 0b 4b 1f 8c 67  8a 24 63 15 8d 60 ed 40  |....K..g.$c..`.@|
-00000270  8c d1 54 8d d8 1e 03 22  b4 5f 75 8d 4a e8 08 e8  |..T...."._u.J...|
-00000280  c8 d7 2e 84 0d 1f 9b 59  28 a2 a5 37 b7 cf 99 23  |.......Y(..7...#|
-00000290  2d 9e ab a5 dd ff 9a 3f  53 d9 56 2f a8 d7 9b 5f  |-......?S.V/..._|
-000002a0  92 44 4f 5c 6c c2 84 99  82 8c ba ff 2b 1a 0b c0  |.DO\l.......+...|
-000002b0  7c 95 8c b2 7d e3 31 d4  cd ed a0 f4 50 6a e2 07  ||...}.1.....Pj..|
-000002c0  a2 2b f8 8d 6c 9f 78 77  09 1e 8c 19 92 39 ec e3  |.+..l.xw.....9..|
-000002d0  bf 48 3f 1f 73 8e 86 bd  3f dd e8 d3 82 9b d4 1a  |.H?.s...?.......|
-000002e0  04 22 c1 8f 90 24 93 c0  52 c6 ba 74 42 fe 47 8a  |."...$..R..tB.G.|
-000002f0  07 73 a4 e9 db 92 9a b0  1c 4f 67 d7 46 30 0a c2  |.s.......Og.F0..|
-00000300  39 8a ba 8a 24 e0 73 f3  33 cb ef c6 41 75 e9 fe  |9...$.s.3...Au..|
-00000310  67 27 97 0a 8a 81 05 1e  d4 79 69 24 3a ea 74 4b  |g'.......yi$:.tK|
-00000320  cc 2a 93 bb 55 72 b6 a0  34 a8 60 ca fc 12 67 54  |.*..Ur..4.`...gT|
-00000330  70 a6 dd d9 17 03 03 00  99 a0 ed 30 29 74 62 61  |p..........0)tba|
-00000340  6a 50 3c f0 1a fa 3e 8e  7e d6 11 4a 2f b1 f7 af  |jP<...>.~..J/...|
-00000350  90 c7 16 9c e5 79 6c 69  fa f5 00 fe 94 1a f2 56  |.....yli.......V|
-00000360  ae 50 8f eb 46 ee f2 51  50 e6 d7 34 34 76 05 c0  |.P..F..QP..44v..|
-00000370  3a 28 0b 45 14 44 9e 4a  bf 3d 53 45 de 24 ea 4a  |:(.E.D.J.=SE.$.J|
-00000380  63 5a 70 fc 39 53 c4 c1  c2 62 bd 6c 7b 2c a8 57  |cZp.9S...b.l{,.W|
-00000390  f3 34 83 99 d7 52 ce 0d  07 95 a0 ff 71 d6 3c fa  |.4...R......q.<.|
-000003a0  e9 4e 79 bb c1 ac 1a 21  3e fe fe 46 0c 33 56 a6  |.Ny....!>..F.3V.|
-000003b0  09 c5 8d 13 3f 47 68 33  c2 5f c2 7c b3 bd 77 7e  |....?Gh3._.|..w~|
-000003c0  8e 20 36 25 c4 b7 63 93  c5 dd 54 d1 00 73 d8 90  |. 6%..c...T..s..|
-000003d0  45 e7 17 03 03 00 35 77  f4 d6 dd 12 6a f8 bf 23  |E.....5w....j..#|
-000003e0  10 c1 a5 53 a5 2b e0 b6  9e 6f da cf aa 99 be 98  |...S.+...o......|
-000003f0  f0 9f 0a 62 a5 d3 ff 5f  fe 17 3b 07 26 24 5b f5  |...b..._..;.&$[.|
-00000400  22 c9 20 b4 8f 08 03 ab  63 23 7a d2 17 03 03 00  |". .....c#z.....|
-00000410  87 79 4c 2d 7a ef 30 25  c1 44 10 f1 e1 30 0c 34  |.yL-z.0%.D...0.4|
-00000420  3f a8 70 e9 b0 23 b1 5c  30 a0 00 41 6c c1 83 75  |?.p..#.\0..Al..u|
-00000430  00 75 f9 f6 b9 08 9b c7  be 5b c2 40 24 43 92 66  |.u.......[.@$C.f|
-00000440  1e 13 c5 ed 7d 45 88 33  d1 fa bf 4a 44 ee 85 8c  |....}E.3...JD...|
-00000450  e9 90 8c be 5f 45 da 78  bb c0 2b 43 61 04 dd b2  |...._E.x..+Ca...|
-00000460  e3 d7 2f c3 ef c5 55 13  d1 12 13 a8 63 7d 59 9f  |../...U.....c}Y.|
-00000470  70 13 5a c7 09 36 da ee  b8 1f c8 9b f6 5d 42 e0  |p.Z..6.......]B.|
-00000480  c4 cd 49 7f b6 e8 ae 4e  c2 25 31 43 68 76 ea 06  |..I....N.%1Chv..|
-00000490  9c 35 53 46 10 fe ec 87                           |.5SF....|
+000000a0  14 03 03 00 01 01 17 03  03 00 17 f6 22 32 b9 da  |............"2..|
+000000b0  7a 10 6a 4e c0 5e 5b 66  53 26 ad b5 e6 83 73 b1  |z.jN.^[fS&....s.|
+000000c0  0d 55 17 03 03 02 6d 21  32 be f9 b5 64 71 fe 23  |.U....m!2...dq.#|
+000000d0  f9 20 ff cc 9b fa 3e b3  0b 1b 9d 2b fb 9a 10 e1  |. ....>....+....|
+000000e0  87 f6 f3 31 f3 77 0c 60  72 f8 6f 29 06 2b fe c7  |...1.w.`r.o).+..|
+000000f0  6c ab e8 15 8e ea b9 fa  66 07 ea 15 2f 93 e0 31  |l.......f.../..1|
+00000100  8a b5 2c 09 55 8e 0d d4  a0 b1 5f 7d 35 a2 9a 99  |..,.U....._}5...|
+00000110  7f a6 8d b8 b8 21 27 4b  f1 7d f9 2b d5 7f ed 4e  |.....!'K.}.+...N|
+00000120  77 39 d8 5b 0b 8f 4c d0  04 2b a5 cc 4c 06 0c 6a  |w9.[..L..+..L..j|
+00000130  e3 3b 73 38 1a 52 1d 62  41 1d d9 71 6a 49 5c a3  |.;s8.R.bA..qjI\.|
+00000140  62 1b c7 d2 3e 3a 54 1b  df a1 e3 3d 01 c0 5b ea  |b...>:T....=..[.|
+00000150  a9 2f 10 5e ff d3 55 b3  fc f1 49 54 ea 59 47 fc  |./.^..U...IT.YG.|
+00000160  4f 5b 42 cb 31 ab ea d4  5e 80 79 28 f5 0a ab 7a  |O[B.1...^.y(...z|
+00000170  61 6a 09 17 30 8c 76 01  eb 72 b2 87 c3 88 d8 a0  |aj..0.v..r......|
+00000180  ac 12 0c 4a 93 cc 41 d3  0c e3 11 15 4a 9c 43 81  |...J..A.....J.C.|
+00000190  0f 7e d9 3f 95 7e 1e c9  f9 86 bb 63 8f 86 b5 9a  |.~.?.~.....c....|
+000001a0  9d e3 e3 26 70 55 86 a7  d4 a2 1e 9f 59 f0 70 68  |...&pU......Y.ph|
+000001b0  c8 a2 2b 26 42 75 b1 05  a2 e9 f1 c0 1f a5 a4 2a  |..+&Bu.........*|
+000001c0  e3 12 14 89 72 bf 9a 48  2b e0 40 6d 31 19 9c ca  |....r..H+.@m1...|
+000001d0  e4 74 d9 3f d8 c7 1e c1  d0 24 54 75 5b 5f 99 1f  |.t.?.....$Tu[_..|
+000001e0  0f 07 22 5b 34 e5 10 1e  db 84 0b e4 d1 25 58 78  |.."[4........%Xx|
+000001f0  49 9c 86 a6 6c 00 94 8b  68 46 31 87 09 b7 a8 89  |I...l...hF1.....|
+00000200  a4 2f f8 db d3 a2 a9 81  89 3c 1b e0 b2 1b 08 7b  |./.......<.....{|
+00000210  3d 10 ba 7d bd c9 31 7f  06 f6 46 4c 25 2e e8 00  |=..}..1...FL%...|
+00000220  56 68 2b 40 55 a4 04 97  d8 91 fb 54 50 4d 59 a2  |Vh+@U......TPMY.|
+00000230  e7 e5 90 b7 53 78 a6 9a  63 a7 0b ba 3c 8c 0e 45  |....Sx..c...<..E|
+00000240  52 6e 55 6f 30 d3 8e 29  19 c3 bc 11 49 4b 89 6a  |RnUo0..)....IK.j|
+00000250  04 ad e5 47 90 cc ce d3  6a 09 6c 94 df b2 54 18  |...G....j.l...T.|
+00000260  0d 0d b4 17 33 05 b1 74  1e 07 4c 87 5e e6 51 dd  |....3..t..L.^.Q.|
+00000270  99 ca fb be f1 45 b9 8f  df 62 df 40 60 59 2f 22  |.....E...b.@`Y/"|
+00000280  63 9c fd d6 52 06 e6 8a  88 63 f8 d3 ca 6b 5d 06  |c...R....c...k].|
+00000290  5f 17 ca 4b 79 10 d9 b9  c2 68 eb d5 9d 52 d3 8d  |_..Ky....h...R..|
+000002a0  35 1c 91 2b d9 c9 44 81  dd e6 d1 22 cf 78 66 8a  |5..+..D....".xf.|
+000002b0  ee 42 39 da 2a e9 4b a9  b3 0e 9b 03 7a be 0b 0d  |.B9.*.K.....z...|
+000002c0  b2 f8 2e 38 24 72 84 a0  68 8b 8c bd a0 77 28 89  |...8$r..h....w(.|
+000002d0  03 1e d4 1a d4 b8 06 c0  88 ff e0 fc a7 d1 a8 68  |...............h|
+000002e0  0d 19 6b 69 36 b1 85 29  d0 fc 3d 5c c4 2e 3a d1  |..ki6..)..=\..:.|
+000002f0  46 00 44 6f 17 41 f5 c3  65 28 2b 85 11 62 66 17  |F.Do.A..e(+..bf.|
+00000300  3e ab 0d 60 3c 4c de 81  a0 39 95 a0 92 58 4a 03  |>..`<L...9...XJ.|
+00000310  aa ea cd 99 28 3f ab 24  84 25 9e 0e 9f 97 9c 05  |....(?.$.%......|
+00000320  db 57 4c 07 b0 a8 c7 33  fc 49 99 c5 ea 78 82 8e  |.WL....3.I...x..|
+00000330  be 9b f5 05 17 03 03 00  99 e6 f4 13 df f4 71 75  |..............qu|
+00000340  5d 18 26 ca d6 5b 67 a7  fa 66 89 45 03 a7 8f 22  |].&..[g..f.E..."|
+00000350  96 8e 7a 26 d8 f9 3b 92  4f 6a 8d ac fa 71 79 63  |..z&..;.Oj...qyc|
+00000360  10 91 9b 66 25 d4 aa b3  64 46 96 85 d7 21 81 2c  |...f%...dF...!.,|
+00000370  d9 e4 ce 34 64 96 b0 e9  05 a8 bc d9 47 39 dc a1  |...4d.......G9..|
+00000380  c2 a2 b7 3e 4e 5d 67 fd  f9 cd ae b2 0d 88 91 ad  |...>N]g.........|
+00000390  57 bf 27 ba 0f 39 89 da  33 49 8c 98 5b 7d 79 1a  |W.'..9..3I..[}y.|
+000003a0  a5 21 e9 58 ba d3 e2 92  54 4d 56 ca 04 11 e2 37  |.!.X....TMV....7|
+000003b0  ee bd 0d 34 40 f0 b8 39  b9 18 83 84 ed 4b 34 30  |...4@..9.....K40|
+000003c0  b3 3d 32 9f 4b 3e f2 71  a6 aa f8 38 27 37 66 fb  |.=2.K>.q...8'7f.|
+000003d0  9a a7 17 03 03 00 35 5c  d9 ba 74 58 30 02 b2 4f  |......5\..tX0..O|
+000003e0  d7 4c 4f 35 ce d7 70 7c  9c 2b 8e 4c a1 37 97 e9  |.LO5..p|.+.L.7..|
+000003f0  4e 48 b2 5b db 26 58 9e  10 de c2 e0 a9 2d cd a3  |NH.[.&X......-..|
+00000400  17 6c de f8 98 61 23 cb  51 70 de 04 17 03 03 00  |.l...a#.Qp......|
+00000410  88 d4 de bb 22 d6 5a cc  93 7e 41 02 e8 d9 0f 0e  |....".Z..~A.....|
+00000420  fc 63 5c 4c da 18 de 7d  2f ed b4 dc eb a0 96 03  |.c\L...}/.......|
+00000430  b1 90 34 3c e6 c2 f5 b6  d6 94 d3 9d 2e b0 82 7f  |..4<............|
+00000440  f0 b9 0b ad cf f3 a8 3c  38 a8 7d b5 38 bd 87 3f  |.......<8.}.8..?|
+00000450  fa 81 5c 2b 39 12 df 07  fc ab 4a f3 ce d3 f0 ca  |..\+9.....J.....|
+00000460  e0 57 73 e1 21 22 6b c2  db 2e 3b 38 32 b8 fd 2b  |.Ws.!"k...;82..+|
+00000470  f3 bd 97 22 52 78 1e b9  a8 48 f9 a6 b8 5e a4 5c  |..."Rx...H...^.\|
+00000480  bd 06 6f f6 0e 69 c4 e7  52 3d 41 d2 96 1b 20 61  |..o..i..R=A... a|
+00000490  8e d5 31 19 a9 a7 aa 71  ee                       |..1....q.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 63 d5 49 1b 6d  |..........5c.I.m|
-00000010  c5 c5 5e ae 4e 8f 75 00  a5 da 16 a8 c1 d5 96 8b  |..^.N.u.........|
-00000020  04 41 e0 8e f0 b9 13 dd  70 0a 13 b7 db 52 05 dd  |.A......p....R..|
-00000030  a0 be 58 d4 f9 7f 5b a5  17 bc 4b fe 8c a3 a4 fd  |..X...[...K.....|
+00000000  14 03 03 00 01 01 17 03  03 00 35 18 2f 70 9f a1  |..........5./p..|
+00000010  65 d1 39 6f 85 74 9a 33  b4 be d8 bd c3 5a 39 fb  |e.9o.t.3.....Z9.|
+00000020  52 bb 44 3b de 50 d3 15  6f 05 88 ec 4f 88 4d 1a  |R.D;.P..o...O.M.|
+00000030  d1 34 1d 3a f9 1b 1e 5e  9c 2f 35 33 b2 84 33 75  |.4.:...^./53..3u|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 53 7a 0d  da c4 f5 55 ff 4a ee e2  |.....Sz....U.J..|
-00000010  19 16 64 07 48 5c ff 6d  37 72 91 8b 42 43 a9 5f  |..d.H\.m7r..BC._|
-00000020  92 97 60 17 03 03 00 13  d7 21 73 88 27 8f ab f2  |..`......!s.'...|
-00000030  03 f7 c4 76 df 78 61 f9  43 58 50                 |...v.xa.CXP|
+00000000  17 03 03 00 1e 07 ef d3  bf 2c 23 a2 62 4e 9d cd  |.........,#.bN..|
+00000010  c2 01 95 3d 26 12 88 0c  cb 38 93 36 f4 fc ff 3f  |...=&....8.6...?|
+00000020  1c 75 7b 17 03 03 00 13  60 7a 56 a8 46 13 b0 51  |.u{.....`zV.F..Q|
+00000030  e5 b1 a7 59 09 57 31 e7  9e 19 7a                 |...Y.W1...z|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-RSA-RSAPSS b/src/crypto/tls/testdata/Server-TLSv13-RSA-RSAPSS
index c46e064829..33d719b8d3 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-RSA-RSAPSS
+++ b/src/crypto/tls/testdata/Server-TLSv13-RSA-RSAPSS
@@ -1,96 +1,96 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 b2 01 00 00  ae 03 03 82 f2 2c cc cf  |.............,..|
-00000010  6f 09 ec 6f 7b a5 0b 1d  09 33 22 94 b8 df 52 be  |o..o{....3"...R.|
-00000020  f4 a0 41 5c be f4 db c7  b2 a2 ca 20 13 2e d2 75  |..A\....... ...u|
-00000030  48 59 42 d3 93 22 6e 3d  7d 10 44 e7 33 a5 5c da  |HYB.."n=}.D.3.\.|
-00000040  fd c4 8c 46 3a 26 79 dc  53 3a 3a 1b 00 04 13 03  |...F:&y.S::.....|
+00000000  16 03 01 00 b2 01 00 00  ae 03 03 5c b1 42 4e f5  |...........\.BN.|
+00000010  8f 48 e9 e7 5e 4c bf 3f  25 c1 ba 11 95 de 9a 6e  |.H..^L.?%......n|
+00000020  a1 c0 55 34 c3 99 bc f5  d1 ec cb 20 dc b0 2a 8e  |..U4....... ..*.|
+00000030  0a c1 a0 cb 23 ed e4 dd  c8 90 97 a9 82 7e 6a d8  |....#........~j.|
+00000040  73 65 76 9f ef 2c 3a 44  38 ac 00 ad 00 04 13 03  |sev..,:D8.......|
 00000050  00 ff 01 00 00 61 00 0b  00 04 03 00 01 02 00 0a  |.....a..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 06 00 04 08 06 08 04  |................|
 00000080  00 2b 00 03 02 03 04 00  2d 00 02 01 01 00 33 00  |.+......-.....3.|
-00000090  26 00 24 00 1d 00 20 e4  2e b8 00 ec 94 88 6c 88  |&.$... .......l.|
-000000a0  8b ed 20 d3 62 9a a3 df  72 fe 23 8b e3 08 57 1b  |.. .b...r.#...W.|
-000000b0  f7 d1 e6 49 d3 4b 79                              |...I.Ky|
+00000090  26 00 24 00 1d 00 20 85  c1 c2 cb 1a 48 84 5e 22  |&.$... .....H.^"|
+000000a0  20 47 32 02 5c f4 8d d6  45 32 bb 88 87 9c 30 3d  | G2.\...E2....0=|
+000000b0  83 cf 1f e5 8e 7c 28                              |.....|(|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 13 2e d2 75  |........... ...u|
-00000030  48 59 42 d3 93 22 6e 3d  7d 10 44 e7 33 a5 5c da  |HYB.."n=}.D.3.\.|
-00000040  fd c4 8c 46 3a 26 79 dc  53 3a 3a 1b 13 03 00 00  |...F:&y.S::.....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 dc b0 2a 8e  |........... ..*.|
+00000030  0a c1 a0 cb 23 ed e4 dd  c8 90 97 a9 82 7e 6a d8  |....#........~j.|
+00000040  73 65 76 9f ef 2c 3a 44  38 ac 00 ad 13 03 00 00  |sev..,:D8.......|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 14 86 db d9 4a 74  |..............Jt|
-00000090  f2 6c ed 9e 6b a1 ac 88  be fe b5 40 14 a4 60 36  |.l..k......@..`6|
-000000a0  9e 17 03 03 02 6d 6a 41  ba 80 59 b4 a9 12 e7 7c  |.....mjA..Y....||
-000000b0  45 73 db 1c 2c 5d 0c 08  11 59 d9 4c 9f 03 66 0e  |Es..,]...Y.L..f.|
-000000c0  22 2f 1a 9e a9 5f c0 72  f1 d9 db 02 ab af f5 30  |"/..._.r.......0|
-000000d0  4c 26 18 5a 9b 19 4b 97  83 61 87 a5 c9 ab 30 6c  |L&.Z..K..a....0l|
-000000e0  7e b1 5b 09 e0 8a a0 7e  8f 31 b7 85 77 e2 2b 4b  |~.[....~.1..w.+K|
-000000f0  20 93 96 0b 8f ae 66 86  87 36 e9 6b d7 20 8a 15  | .....f..6.k. ..|
-00000100  93 4d c8 d4 6d 59 d8 7a  db 76 87 a6 7f 1c a1 10  |.M..mY.z.v......|
-00000110  82 23 4a 48 07 3d 43 44  17 02 dd 32 89 22 f2 30  |.#JH.=CD...2.".0|
-00000120  b7 6f 4c 1e d7 47 95 13  1c a5 46 e4 0f ea 23 c7  |.oL..G....F...#.|
-00000130  cf 5c a7 cb 05 a8 b3 fd  6d 3d c7 71 55 e8 85 f8  |.\......m=.qU...|
-00000140  6b 92 35 21 6f c4 4c b6  22 28 54 de 76 84 ef 90  |k.5!o.L."(T.v...|
-00000150  3a 96 a9 8a c5 26 13 46  64 2e 3f ef d0 b7 41 9e  |:....&.Fd.?...A.|
-00000160  cf 4a 6a d5 ec fc 2c c0  72 eb c6 98 27 ba 08 bb  |.Jj...,.r...'...|
-00000170  62 ef 2f 74 52 c6 34 55  2b 1d 80 6a 80 24 b8 f7  |b./tR.4U+..j.$..|
-00000180  ba 18 0a 2c 3f 86 7f 75  11 ff 7f d0 4b e1 c2 07  |...,?..u....K...|
-00000190  a0 ce 06 1b ba a9 88 fa  1a d6 7d 16 b2 6c 67 c8  |..........}..lg.|
-000001a0  c0 cc 2e fd 24 47 24 96  c0 94 93 83 60 99 1a 91  |....$G$.....`...|
-000001b0  59 49 e6 57 92 b4 bd 5f  c2 52 aa fa f8 63 80 d0  |YI.W..._.R...c..|
-000001c0  a8 23 a1 0c a2 be db 23  8a 96 e1 43 ec 69 8b 26  |.#.....#...C.i.&|
-000001d0  67 cb 3b bb f6 2c 12 af  dc ef 86 d8 c8 06 65 5a  |g.;..,........eZ|
-000001e0  e8 0b 17 17 7c 30 16 32  b7 05 24 fe 8b 73 4a 2d  |....|0.2..$..sJ-|
-000001f0  f8 2d f0 15 71 32 d1 dd  95 ad 07 c1 26 06 97 6e  |.-..q2......&..n|
-00000200  22 c0 d0 6a be 1b 49 84  c5 3a 50 c8 61 a8 d3 6a  |"..j..I..:P.a..j|
-00000210  0a 09 4d f4 d3 ba c0 bf  66 3c 1e 0b d0 df 40 12  |..M.....f<....@.|
-00000220  60 e8 c1 f7 9e 29 28 16  4b 2b 01 60 ae 1d f4 71  |`....)(.K+.`...q|
-00000230  b5 3f a9 69 4b ca 83 0a  3f 1b aa 92 37 0a e6 ce  |.?.iK...?...7...|
-00000240  30 6f 7d 40 11 ba 48 14  82 a1 6e df e3 2f 78 b2  |0o}@..H...n../x.|
-00000250  dc 92 fa 92 d2 74 ef 94  1e cc c6 af b9 1a 58 af  |.....t........X.|
-00000260  33 21 38 55 7c df b3 6b  7e 38 c9 46 67 94 0c d7  |3!8U|..k~8.Fg...|
-00000270  e3 20 49 f2 9d 93 22 9e  f3 ae e6 12 5c 6c a0 1b  |. I...".....\l..|
-00000280  8e 5f 6a 3d 26 8d 23 f9  8a 58 d1 71 d4 8a 3e e6  |._j=&.#..X.q..>.|
-00000290  47 f5 ec 4c 43 d0 a4 7c  4c b3 e1 f3 ef dd bb 1b  |G..LC..|L.......|
-000002a0  13 a0 d4 fe bf 55 67 3a  12 67 da 13 56 3d 9f 5f  |.....Ug:.g..V=._|
-000002b0  fb 73 16 c9 d9 78 90 7f  9b f6 35 3f 2f f0 71 84  |.s...x....5?/.q.|
-000002c0  97 d7 f8 59 cb 31 42 46  2e 27 ae 3c 24 60 d0 7a  |...Y.1BF.'.<$`.z|
-000002d0  30 df ed 01 63 f7 8b 21  1e f3 b6 d6 f0 57 7a 86  |0...c..!.....Wz.|
-000002e0  96 da 2d 37 94 90 7c f7  8c c4 bf 22 c9 43 6e b4  |..-7..|....".Cn.|
-000002f0  64 33 32 c1 5d 9c c8 ae  fb 20 0d bb 31 ae 72 2c  |d32.].... ..1.r,|
-00000300  ce f4 de 09 aa 93 60 3a  44 c2 a0 01 bf 43 cc 84  |......`:D....C..|
-00000310  f4 44 9e 17 03 03 00 99  18 d7 60 3d 2a 8e f6 40  |.D........`=*..@|
-00000320  30 5d d3 6b 49 b5 35 21  9a 90 e3 26 a7 17 dc 79  |0].kI.5!...&...y|
-00000330  22 5c 89 a1 24 ab 10 71  6d 64 04 65 05 7a 0c 06  |"\..$..qmd.e.z..|
-00000340  96 a8 a7 c2 f1 70 4b be  84 fc c4 55 d3 90 5d 8e  |.....pK....U..].|
-00000350  31 fe f6 24 71 45 f2 40  e9 d6 24 1e 2d a3 11 2d  |1..$qE.@..$.-..-|
-00000360  f0 55 ba 68 df c8 fb f0  f1 9a 51 e6 9c f0 0a e6  |.U.h......Q.....|
-00000370  65 fc dd 62 d0 91 ce 72  8a 7f 27 ed 20 d9 9d 8f  |e..b...r..'. ...|
-00000380  6b 1c 05 33 a5 89 ce 75  26 71 55 a0 3b 58 8e 02  |k..3...u&qU.;X..|
-00000390  9d 37 dd 9f cd d3 c5 7e  be ba ad f1 eb 5b 75 eb  |.7.....~.....[u.|
-000003a0  45 31 d1 e4 ca bf 3f 9a  f6 66 8a f9 c0 56 db 86  |E1....?..f...V..|
-000003b0  5d 17 03 03 00 35 0e 4a  03 ab fc 70 dd c7 00 e0  |]....5.J...p....|
-000003c0  93 93 8d f3 b3 1a 8e 5d  43 51 bf b1 74 78 77 35  |.......]CQ..txw5|
-000003d0  45 a7 b4 6b 6d c0 e6 b9  a4 82 3e db 1b 35 96 ab  |E..km.....>..5..|
-000003e0  35 24 b8 1f 8d c7 35 aa  85 87 c6 17 03 03 00 87  |5$....5.........|
-000003f0  75 87 27 b5 37 70 f5 08  b2 a8 b1 fb 98 c1 42 87  |u.'.7p........B.|
-00000400  e4 d8 1b 6c ac a6 28 03  92 5a 30 5b 5b 91 9a 9d  |...l..(..Z0[[...|
-00000410  43 1b 31 03 13 a7 e5 d3  82 69 5b 4a 35 df 92 80  |C.1......i[J5...|
-00000420  d3 a7 73 ab 61 60 eb 47  cb ca 91 e5 0b 8f ff e7  |..s.a`.G........|
-00000430  da 07 c9 0c c9 4b 52 f9  5d c0 a5 ce 38 78 d2 09  |.....KR.]...8x..|
-00000440  0a 5d d7 f2 07 51 b0 68  9c d2 03 86 a0 9d b2 14  |.]...Q.h........|
-00000450  b9 34 00 dd 69 34 c8 5d  5b 9b 5a cf 93 78 8f 92  |.4..i4.][.Z..x..|
-00000460  ec be 1b fd 67 df 6d a4  bf 79 d5 db f1 b5 c8 f6  |....g.m..y......|
-00000470  f3 58 02 fc c0 82 88                              |.X.....|
+00000080  03 03 00 01 01 17 03 03  00 17 31 a8 1f 92 5a 76  |..........1...Zv|
+00000090  1b e0 15 cd 31 83 e9 1f  35 26 00 c4 07 a3 78 b3  |....1...5&....x.|
+000000a0  07 17 03 03 02 6d e9 b2  fd 16 24 36 f1 43 17 27  |.....m....$6.C.'|
+000000b0  cf e2 4f b3 36 50 af f1  79 9b a7 1f 2e 0e 3a a8  |..O.6P..y.....:.|
+000000c0  ae f2 c9 5c ed e3 87 1e  4f 1a 87 58 a7 25 ea 08  |...\....O..X.%..|
+000000d0  ad 1a fd 12 52 ad ca db  bf 46 2d b4 34 29 cc 62  |....R....F-.4).b|
+000000e0  b3 86 cc f9 64 47 e3 a9  f3 98 04 6a 95 f5 13 ae  |....dG.....j....|
+000000f0  72 ff 0e 21 eb f8 25 30  31 5e 80 20 e4 64 fe fb  |r..!..%01^. .d..|
+00000100  a4 e7 55 fb ce 01 3f 08  6e 48 e3 e2 64 f1 a6 54  |..U...?.nH..d..T|
+00000110  43 8f 43 f8 6a b7 bc a4  c5 9c 33 00 42 a2 41 db  |C.C.j.....3.B.A.|
+00000120  98 43 8b f0 05 2a 75 8d  a1 cd 18 0f 4e c5 79 b0  |.C...*u.....N.y.|
+00000130  12 5e 98 2a 5e 2d 02 30  9c f6 2f 94 02 89 42 a0  |.^.*^-.0../...B.|
+00000140  83 69 0f 8f 24 96 f6 ce  78 12 ff d2 6e d6 74 ed  |.i..$...x...n.t.|
+00000150  31 1b 09 7e 38 c8 8c cb  e1 ea eb ce 9d 77 46 47  |1..~8........wFG|
+00000160  ae c8 88 41 fe 46 b6 c0  14 e2 5e 49 f8 e6 bc 51  |...A.F....^I...Q|
+00000170  13 0a 60 66 78 9b 94 09  cc 56 06 61 62 2d cd 95  |..`fx....V.ab-..|
+00000180  93 e8 fe 5a c1 b6 b8 5e  30 94 a3 3c 5c 77 1a 41  |...Z...^0..<\w.A|
+00000190  b6 7d 6c 77 73 6a 30 87  9e 85 cf b6 e3 53 44 f1  |.}lwsj0......SD.|
+000001a0  87 19 4a d1 a7 58 cc da  43 87 dd 0d ff c4 74 cb  |..J..X..C.....t.|
+000001b0  c0 a6 ca 80 d7 29 bb 85  bb a0 ad 5b c8 52 6b 97  |.....).....[.Rk.|
+000001c0  d1 cd cb 9b e0 69 58 d8  2a bc 5c 62 5c 4a 15 28  |.....iX.*.\b\J.(|
+000001d0  db ba d9 8b b2 d5 94 c2  40 7c 96 91 cc ef 26 f1  |........@|....&.|
+000001e0  1d a7 9e 3b f7 2f be 5d  46 65 14 77 0f 40 d4 e3  |...;./.]Fe.w.@..|
+000001f0  26 42 c0 f9 db 9f cc 93  06 37 e2 84 31 61 ce 13  |&B.......7..1a..|
+00000200  40 0a e5 20 eb 7b 93 ed  77 d8 1d 04 62 c2 e3 76  |@.. .{..w...b..v|
+00000210  9f 5f 5e 44 10 4a 8e c8  7e b0 23 8a 3c 4a df af  |._^D.J..~.#.<J..|
+00000220  38 15 82 1a 47 e5 14 da  15 2e d3 8c 54 8c 15 75  |8...G.......T..u|
+00000230  87 78 82 af d4 52 4b 6e  46 b7 c4 65 0c b1 29 f7  |.x...RKnF..e..).|
+00000240  7a f2 43 9a ec e6 0b 36  e5 ae 31 71 1b 05 92 43  |z.C....6..1q...C|
+00000250  9b bd 56 ff 43 74 37 84  63 14 1b be 11 39 d4 99  |..V.Ct7.c....9..|
+00000260  f2 12 fe dc ff c8 83 9d  75 79 ba a1 db 6c aa 3a  |........uy...l.:|
+00000270  f4 a4 cf e3 a1 f8 1e 6f  a8 bc e3 9c 9a 73 e3 30  |.......o.....s.0|
+00000280  c2 63 94 ec cd 74 1a dc  ba 81 4f 67 d5 01 e3 7a  |.c...t....Og...z|
+00000290  ae 21 54 51 88 6f 1b 1d  7b 45 a8 da ef c5 47 36  |.!TQ.o..{E....G6|
+000002a0  bf 28 50 8e be 7a 44 f0  b5 39 cd a1 bb bc d4 60  |.(P..zD..9.....`|
+000002b0  59 40 a1 b8 f6 77 35 b5  42 13 25 4e ef 49 11 71  |Y@...w5.B.%N.I.q|
+000002c0  b3 a2 ab 7f 80 f2 ec 96  b5 f4 f0 ef be 65 56 20  |.............eV |
+000002d0  e4 b9 aa cf 00 b5 74 20  ca 36 77 2d 09 2e 3a 97  |......t .6w-..:.|
+000002e0  93 de 6b c3 29 f2 a8 00  e0 39 8a 41 85 67 ec fd  |..k.)....9.A.g..|
+000002f0  27 ab 54 53 e1 0f c0 5c  5e f6 2e be 6d a0 85 b7  |'.TS...\^...m...|
+00000300  a5 4c b6 0e 6e 82 b1 91  cc ad 21 ae 92 ef 28 0c  |.L..n.....!...(.|
+00000310  23 ae c7 17 03 03 00 99  12 3f 32 14 ba c1 db db  |#........?2.....|
+00000320  a9 ac 43 7b b9 b2 53 ba  da 34 32 a8 7f 58 07 e8  |..C{..S..42..X..|
+00000330  1e 1d f3 52 c6 f2 91 5d  66 94 90 19 f4 a7 44 e5  |...R...]f.....D.|
+00000340  8b c0 24 3b 86 63 f1 9d  c9 9b 94 5c 37 af 6b 98  |..$;.c.....\7.k.|
+00000350  15 bb b7 ff 8e eb d3 c5  31 62 06 ce ad ae 50 21  |........1b....P!|
+00000360  93 02 70 86 02 6f 79 4d  2b a0 28 eb 68 4e ef 25  |..p..oyM+.(.hN.%|
+00000370  01 47 ad a3 b4 09 7e e4  be e1 87 30 27 65 d0 c4  |.G....~....0'e..|
+00000380  39 c5 88 7d 6e e9 eb c6  6c 1e c1 70 84 3e 83 1e  |9..}n...l..p.>..|
+00000390  f0 fc 64 28 71 8c fd ff  fa 72 bd 3c f9 d9 13 b5  |..d(q....r.<....|
+000003a0  e3 a2 46 20 b3 67 04 58  79 df aa ca b7 9b b9 6f  |..F .g.Xy......o|
+000003b0  33 17 03 03 00 35 e6 33  b7 50 67 b4 f0 1e 6a 29  |3....5.3.Pg...j)|
+000003c0  25 22 23 f6 3c a1 72 4e  46 19 16 76 7e 80 5f c3  |%"#.<.rNF..v~._.|
+000003d0  06 46 16 02 6e 9e 5e 0f  60 7c 0a 0a 9f 84 95 28  |.F..n.^.`|.....(|
+000003e0  64 f1 9d 40 c2 56 99 49  97 f1 5e 17 03 03 00 88  |d..@.V.I..^.....|
+000003f0  bd 43 c9 3d 7c 7c 07 af  6a 03 5e d0 59 c5 9e 7c  |.C.=||..j.^.Y..||
+00000400  1f 23 08 c4 17 95 16 fa  73 37 1b 0a a3 e6 5f b1  |.#......s7...._.|
+00000410  08 4c 95 ef ae e6 d8 12  0c b6 d3 81 95 71 b7 e4  |.L...........q..|
+00000420  f9 52 fb c1 da 82 db 83  b6 0d a3 71 57 44 27 e1  |.R.........qWD'.|
+00000430  45 12 08 48 f8 21 33 51  51 42 d7 7a 1e 81 6c 28  |E..H.!3QQB.z..l(|
+00000440  50 79 18 1a 02 45 9f 63  bc c9 fb 9b aa 35 51 48  |Py...E.c.....5QH|
+00000450  d4 64 55 bf 27 dd 99 fd  d2 d1 60 05 18 0e 6f 08  |.dU.'.....`...o.|
+00000460  fe ea 8e af 1f 70 c3 e3  34 83 41 52 3e 57 d1 7d  |.....p..4.AR>W.}|
+00000470  88 2f 03 e0 1e 1a 0b c7                           |./......|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 ee 7d 75 0e 18  |..........5.}u..|
-00000010  fb 03 43 c3 79 f2 e4 de  5f 0b 66 b5 56 2f 72 d2  |..C.y..._.f.V/r.|
-00000020  a8 44 f3 30 a1 5f e2 4d  74 f4 2e 74 21 22 9c ab  |.D.0._.Mt..t!"..|
-00000030  24 21 15 17 3c ca 4f 9c  f2 ca b5 8c 41 f8 9e 33  |$!..<.O.....A..3|
+00000000  14 03 03 00 01 01 17 03  03 00 35 af f3 03 dd 6d  |..........5....m|
+00000010  fa 9f 5b fe 8a 97 0e 2e  ea a1 f1 ff 35 d5 39 a3  |..[.........5.9.|
+00000020  d7 cd 47 0d 1b ae 57 aa  d0 74 3d 63 e1 87 59 b1  |..G...W..t=c..Y.|
+00000030  57 24 c6 1c 38 2f ea d9  c1 4e b1 f3 17 37 34 a4  |W$..8/...N...74.|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 1e 43 e9  c0 d7 07 34 99 8e 60 7f  |......C....4..`.|
-00000010  98 41 9b f2 23 34 18 4a  a0 92 8a cb 8d bd 53 a4  |.A..#4.J......S.|
-00000020  f1 59 31 17 03 03 00 13  68 a7 51 ea 2a cc 64 b0  |.Y1.....h.Q.*.d.|
-00000030  75 ad 73 59 ff 75 0c c1  3d da 3f                 |u.sY.u..=.?|
+00000000  17 03 03 00 1e a0 9b 1d  d1 c2 bb b4 5b a8 43 d0  |............[.C.|
+00000010  58 8d 38 41 4a 93 53 95  35 5e 68 a1 00 7d b0 39  |X.8AJ.S.5^h..}.9|
+00000020  a5 38 e2 17 03 03 00 13  00 bc 3c d2 ec 93 64 fb  |.8........<...d.|
+00000030  2c 8c 18 ef 7f 1b 1d d6  5d 35 2c                 |,.......]5,|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-Resume b/src/crypto/tls/testdata/Server-TLSv13-Resume
index 95e18d0844..904da58e9c 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-Resume
+++ b/src/crypto/tls/testdata/Server-TLSv13-Resume
@@ -1,58 +1,58 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 62 01 00 01  5e 03 03 45 97 1a f2 a5  |....b...^..E....|
-00000010  41 22 93 8c 39 f2 ef f7  c9 02 58 d3 f1 c3 62 c7  |A"..9.....X...b.|
-00000020  e5 36 54 50 9e 2f 66 07  aa ad cb 20 34 3b 96 77  |.6TP./f.... 4;.w|
-00000030  77 cf 49 78 16 7d 7b 5c  4c 8b 5e 91 84 16 13 ee  |w.Ix.}{\L.^.....|
-00000040  9f 1f 32 df a2 9e 69 6e  95 ea 3d d7 00 04 13 01  |..2...in..=.....|
-00000050  00 ff 01 00 01 11 00 0b  00 04 03 00 01 02 00 0a  |................|
+00000000  16 03 01 01 63 01 00 01  5f 03 03 6a ca 53 dd 1b  |....c..._..j.S..|
+00000010  c2 e1 a2 94 d6 eb 63 11  1e 55 6e e0 ec 34 01 23  |......c..Un..4.#|
+00000020  9d 34 b6 fe 61 d3 6d ce  a5 c0 c6 20 81 93 20 ab  |.4..a.m.... .. .|
+00000030  a1 b5 2b 1b d6 6a 99 e7  11 2f e6 e0 90 45 84 32  |..+..j.../...E.2|
+00000040  a1 3f 7a 59 b8 aa cd 97  9a ba 40 35 00 04 13 01  |.?zY......@5....|
+00000050  00 ff 01 00 01 12 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 16 00 00 00 17  00 00 00 0d 00 1e 00 1c  |................|
 00000080  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000090  08 04 08 05 08 06 04 01  05 01 06 01 00 2b 00 03  |.............+..|
 000000a0  02 03 04 00 2d 00 02 01  01 00 33 00 26 00 24 00  |....-.....3.&.$.|
-000000b0  1d 00 20 83 a4 8c 27 2c  0c 02 4d c4 ba 81 fb f2  |.. ...',..M.....|
-000000c0  e0 6d 69 9f e6 da b2 9c  a3 e3 63 08 79 34 d2 c5  |.mi.......c.y4..|
-000000d0  5c 16 23 00 29 00 90 00  6b 00 65 00 00 00 00 00  |\.#.)...k.e.....|
+000000b0  1d 00 20 4a 67 fa f3 3a  13 1c 9f 71 6b b5 00 a5  |.. Jg..:...qk...|
+000000c0  1b d7 b6 5c 3e 2f ad 64  23 8a 7b fe 35 eb 36 19  |...\>/.d#.{.5.6.|
+000000d0  92 07 76 00 29 00 91 00  6c 00 66 00 00 00 00 00  |..v.)...l.f.....|
 000000e0  00 00 00 00 00 00 00 00  00 00 00 94 68 2d a3 82  |............h-..|
-000000f0  51 ed 14 ef 68 ca 42 c5  5c c8 cf 5f 79 2c cc b2  |Q...h.B.\.._y,..|
-00000100  ee 72 fb 49 38 e9 9b 05  4e a0 3e ca 70 03 69 28  |.r.I8...N.>.p.i(|
-00000110  72 75 95 34 2a b2 be b0  d6 99 76 3c 2b 52 f2 8f  |ru.4*.....v<+R..|
-00000120  9d bf 73 8c 79 04 d5 07  10 8a f8 c1 b7 38 bc 3a  |..s.y........8.:|
-00000130  3f 34 f1 43 6c 56 d4 96  30 86 d7 9b da b0 97 4c  |?4.ClV..0......L|
-00000140  00 00 00 00 00 21 20 16  a1 7a d4 59 cb 4d 57 73  |.....! ..z.Y.MWs|
-00000150  75 e4 3d 7d d5 56 85 5e  f2 84 3b 5c a9 94 59 5f  |u.=}.V.^..;\..Y_|
-00000160  9a 6e bc 57 60 48 a8                              |.n.W`H.|
+000000f0  51 ed 14 ef 68 ca 42 c5  5c 7c 58 c6 88 11 29 25  |Q...h.B.\|X...)%|
+00000100  b8 05 56 93 3f b5 60 5b  72 b9 05 af 5f 5a 7d 3c  |..V.?.`[r..._Z}<|
+00000110  00 39 4d c4 3a 8f ea ad  e8 99 76 3c 2b 52 f2 8f  |.9M.:.....v<+R..|
+00000120  5f 12 93 da 84 40 30 c8  c5 1e 47 a1 1b 94 33 2e  |_....@0...G...3.|
+00000130  cd cd e3 10 f4 54 01 e7  9f a1 e6 b4 c3 7d ae 17  |.....T.......}..|
+00000140  34 00 00 00 00 00 21 20  54 fe 95 11 63 19 4e 10  |4.....! T...c.N.|
+00000150  ed ab 34 ed 12 5c 5c be  78 de bf 0f 8c b6 55 c7  |..4..\\.x.....U.|
+00000160  2d 2e 69 dc ad 2e 5c b3                           |-.i...\.|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 80 02 00 00  7c 03 03 00 00 00 00 00  |........|.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 34 3b 96 77  |........... 4;.w|
-00000030  77 cf 49 78 16 7d 7b 5c  4c 8b 5e 91 84 16 13 ee  |w.Ix.}{\L.^.....|
-00000040  9f 1f 32 df a2 9e 69 6e  95 ea 3d d7 13 01 00 00  |..2...in..=.....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 81 93 20 ab  |........... .. .|
+00000030  a1 b5 2b 1b d6 6a 99 e7  11 2f e6 e0 90 45 84 32  |..+..j.../...E.2|
+00000040  a1 3f 7a 59 b8 aa cd 97  9a ba 40 35 13 01 00 00  |.?zY......@5....|
 00000050  34 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |4.+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 00  |.........._X.;t.|
 00000080  29 00 02 00 00 14 03 03  00 01 01 17 03 03 00 17  |)...............|
-00000090  49 3a 5f 64 73 d0 1a 07  4f fe f4 de 81 7b 33 1e  |I:_ds...O....{3.|
-000000a0  7f 2a da fd df 03 d0 17  03 03 00 35 90 cd 1d a8  |.*.........5....|
-000000b0  b3 5a aa 7e 0f 34 7d d2  75 d8 59 fd de 1b 14 0e  |.Z.~.4}.u.Y.....|
-000000c0  8e 86 85 df d1 0c 41 0f  f7 99 2c 00 52 38 64 5c  |......A...,.R8d\|
-000000d0  d6 74 6a 7f e4 34 2d 63  eb 90 21 6c fe 65 0c ef  |.tj..4-c..!l.e..|
-000000e0  6c 17 03 03 00 87 88 ca  a9 6c b6 cd 91 e5 5b 88  |l........l....[.|
-000000f0  c9 5d 87 79 e7 ab 15 2e  07 44 28 81 27 65 c8 76  |.].y.....D(.'e.v|
-00000100  48 4c ae 22 66 bd 56 5f  e3 52 f2 70 2f 73 4e 97  |HL."f.V_.R.p/sN.|
-00000110  e2 8e 4b 63 aa 91 05 a1  23 99 48 f3 5a 28 bb 1f  |..Kc....#.H.Z(..|
-00000120  94 d8 68 3f bb e3 c3 dc  ad 85 c8 f4 5e 61 25 a0  |..h?........^a%.|
-00000130  22 7b 61 7e f9 64 4c 8c  71 04 7a 68 7a 3d ab 91  |"{a~.dL.q.zhz=..|
-00000140  35 7a ce a6 3e b1 23 d7  32 5c a3 c0 28 8c d3 43  |5z..>.#.2\..(..C|
-00000150  25 cd 68 30 e6 d5 57 ec  fd af 83 a3 e0 83 2f 69  |%.h0..W......./i|
-00000160  a4 ce e8 84 91 62 8b 15  69 01 9d 1e c8           |.....b..i....|
+00000090  28 14 01 de c4 6a da d7  55 e5 ad e1 64 46 3b fb  |(....j..U...dF;.|
+000000a0  e1 c3 91 c3 32 27 0d 17  03 03 00 35 1c 3b 19 57  |....2'.....5.;.W|
+000000b0  ba 33 51 fe e8 ca 0f 9f  a6 dd fa cf b5 ed 64 38  |.3Q...........d8|
+000000c0  36 7d 70 cf 41 2d 25 4c  30 b1 be 99 3b 9d 1c 61  |6}p.A-%L0...;..a|
+000000d0  68 aa 41 03 a3 22 44 8b  42 bf f9 26 7e 48 53 99  |h.A.."D.B..&~HS.|
+000000e0  9f 17 03 03 00 88 94 b5  5e 15 c3 3c c8 c6 6e 10  |........^..<..n.|
+000000f0  31 d2 8f c1 d1 7c a7 4d  6c 36 c6 e0 8d 8d 85 0c  |1....|.Ml6......|
+00000100  69 6a cc 39 4d 48 79 7b  ac d9 d9 5a c9 a5 9d 02  |ij.9MHy{...Z....|
+00000110  59 1e bb 57 01 f4 64 c3  96 58 26 7e 6d c7 f7 63  |Y..W..d..X&~m..c|
+00000120  8b 9b 37 de 0a e5 b6 52  cc 3d 81 f4 99 f2 46 e4  |..7....R.=....F.|
+00000130  c9 a6 10 2e a4 b5 59 e8  87 09 33 ea 3a 61 d3 8e  |......Y...3.:a..|
+00000140  3d f1 07 bf a1 51 02 0f  2c 6c ba ae ec 0f 6e 42  |=....Q..,l....nB|
+00000150  7e df eb 5f 74 39 90 21  64 82 a8 01 3d de a2 be  |~.._t9.!d...=...|
+00000160  18 86 92 b0 41 7e de 65  cf 22 48 97 86 e5        |....A~.e."H...|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 99 1e 5b 0c 00  |..........5..[..|
-00000010  5e 86 53 f9 ea b8 88 f7  6f 48 fb bb 32 44 87 e3  |^.S.....oH..2D..|
-00000020  d8 88 23 d0 b3 cb f8 b2  15 3d 80 89 5f 57 5d d8  |..#......=.._W].|
-00000030  97 de 43 77 5b d7 69 60  8b 04 57 3e 2f 5b d2 af  |..Cw[.i`..W>/[..|
+00000000  14 03 03 00 01 01 17 03  03 00 35 ba 45 1d a0 42  |..........5.E..B|
+00000010  5a 7c 84 4a 02 74 64 2f  74 bd ac 74 6e 16 0c fe  |Z|.J.td/t..tn...|
+00000020  e7 92 9a 68 ab 03 69 b5  d4 59 40 b7 ba eb 3b 4e  |...h..i..Y@...;N|
+00000030  b4 01 2f e1 32 c2 a8 ad  5c 3f 28 e6 91 bc 44 34  |../.2...\?(...D4|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 0e e1 ae  58 8a ca 45 0d 16 59 69  |........X..E..Yi|
-00000010  fb 31 4d 54 eb 9b 39 f9  77 d2 32 be 65 1f 5c 6f  |.1MT..9.w.2.e.\o|
-00000020  e7 85 b7 17 03 03 00 13  10 6f b3 5d 83 cb fb 04  |.........o.]....|
-00000030  7f fd 1d ec 45 e9 5e 5d  69 fb 38                 |....E.^]i.8|
+00000000  17 03 03 00 1e 67 5e d3  a8 34 f5 cb 36 e3 16 e5  |.....g^..4..6...|
+00000010  f2 ef 86 36 cf 22 0e 6d  9a 6e 24 fe a5 1f e0 e7  |...6.".m.n$.....|
+00000020  28 81 f0 17 03 03 00 13  ce 6e 2d 91 26 b4 4a 5f  |(........n-.&.J_|
+00000030  0f b8 14 35 f8 67 19 f2  bd ac d1                 |...5.g.....|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-Resume-HelloRetryRequest b/src/crypto/tls/testdata/Server-TLSv13-Resume-HelloRetryRequest
index c3ce817510..fb5584a0a4 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-Resume-HelloRetryRequest
+++ b/src/crypto/tls/testdata/Server-TLSv13-Resume-HelloRetryRequest
@@ -1,94 +1,94 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 5c 01 00 01  58 03 03 3f 06 8a 40 03  |....\...X..?..@.|
-00000010  ec e1 c6 76 79 2d d2 3d  c3 f1 1c e5 f8 32 a9 ea  |...vy-.=.....2..|
-00000020  83 93 62 25 81 0f 27 f3  64 dd d1 20 18 75 f7 cf  |..b%..'.d.. .u..|
-00000030  f5 f7 36 20 d8 66 df 58  38 31 12 cc 0f 30 d4 ac  |..6 .f.X81...0..|
-00000040  f6 da f4 84 74 08 73 c9  12 14 77 e6 00 04 13 01  |....t.s...w.....|
-00000050  00 ff 01 00 01 0b 00 0b  00 04 03 00 01 02 00 0a  |................|
+00000000  16 03 01 01 5d 01 00 01  59 03 03 d3 5b 65 c1 4e  |....]...Y...[e.N|
+00000010  7f 6e ae c0 b6 3c 6c 32  a6 cc 9c de b6 1a c9 32  |.n...<l2.......2|
+00000020  7e 7b 76 44 b7 74 15 de  23 6e e0 20 67 74 47 9b  |~{vD.t..#n. gtG.|
+00000030  84 d3 e5 4b f1 7a 93 64  ec f6 80 a7 dd 91 7c dd  |...K.z.d......|.|
+00000040  db e3 dd 8b e3 1e d1 9c  5d 4f 71 6f 00 04 13 01  |........]Oqo....|
+00000050  00 ff 01 00 01 0c 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 06 00 04 00 1d 00 17  00 23 00 00 00 16 00 00  |.........#......|
 00000070  00 17 00 00 00 0d 00 1e  00 1c 04 03 05 03 06 03  |................|
 00000080  08 07 08 08 08 09 08 0a  08 0b 08 04 08 05 08 06  |................|
 00000090  04 01 05 01 06 01 00 2b  00 03 02 03 04 00 2d 00  |.......+......-.|
-000000a0  02 01 01 00 33 00 26 00  24 00 1d 00 20 e2 25 9f  |....3.&.$... .%.|
-000000b0  50 96 71 41 ab b5 ea 0a  17 71 61 91 74 19 8b f1  |P.qA.....qa.t...|
-000000c0  b8 4f f2 d9 2f 2c dc 16  c3 d6 82 15 48 00 29 00  |.O../,......H.).|
-000000d0  90 00 6b 00 65 00 00 00  00 00 00 00 00 00 00 00  |..k.e...........|
+000000a0  02 01 01 00 33 00 26 00  24 00 1d 00 20 87 a8 1f  |....3.&.$... ...|
+000000b0  45 dc 22 d6 1c 33 d2 6b  f8 d0 8e 47 8b 61 10 51  |E."..3.k...G.a.Q|
+000000c0  67 a5 38 52 17 5a 82 01  61 8a 86 0c 09 00 29 00  |g.8R.Z..a.....).|
+000000d0  91 00 6c 00 66 00 00 00  00 00 00 00 00 00 00 00  |..l.f...........|
 000000e0  00 00 00 00 00 94 68 2d  a3 82 51 ed 14 ef 68 ca  |......h-..Q...h.|
-000000f0  42 c5 5c c8 cf 5f 79 2c  cc b2 ee 72 fb 49 38 e9  |B.\.._y,...r.I8.|
-00000100  9b 05 4e a0 3e ca 70 03  69 28 72 75 95 34 2a b2  |..N.>.p.i(ru.4*.|
-00000110  be b0 d6 99 76 3c 2b 52  f2 8f 9d bf 73 8c 79 04  |....v<+R....s.y.|
-00000120  d5 07 10 8a f8 c1 b7 38  bc 3a 3f 34 f1 43 6c 56  |.......8.:?4.ClV|
-00000130  d4 96 30 86 d7 9b da b0  97 4c 00 00 00 00 00 21  |..0......L.....!|
-00000140  20 d4 3f fe bd 45 9e 9e  ad 02 1a c9 00 4d 3a e6  | .?..E.......M:.|
-00000150  c5 ec ef c5 5b 3e 05 9e  91 45 6c 1d ca 66 4e 8d  |....[>...El..fN.|
-00000160  e7                                                |.|
+000000f0  42 c5 5c 7c 58 c6 88 11  29 25 b8 05 56 93 3f b5  |B.\|X...)%..V.?.|
+00000100  60 5b 72 b9 05 af 5f 5a  7d 3c 00 39 4d c4 3a 8f  |`[r..._Z}<.9M.:.|
+00000110  ea ad e8 99 76 3c 2b 52  f2 8f 5f 12 93 da 84 40  |....v<+R.._....@|
+00000120  30 c8 c5 1e 47 a1 1b 94  33 2e cd cd e3 10 f4 54  |0...G...3......T|
+00000130  01 e7 9f a1 e6 b4 c3 7d  ae 17 34 00 00 00 00 00  |.......}..4.....|
+00000140  21 20 aa 03 cd 24 b1 35  d0 54 f9 1e 67 94 15 8a  |! ...$.5.T..g...|
+00000150  c6 21 4b 1c f0 2d c9 a5  1a ef dc d9 63 59 2e 75  |.!K..-......cY.u|
+00000160  10 0c                                             |..|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 58 02 00 00  54 03 03 cf 21 ad 74 e5  |....X...T...!.t.|
 00000010  9a 61 11 be 1d 8c 02 1e  65 b8 91 c2 a2 11 16 7a  |.a......e......z|
-00000020  bb 8c 5e 07 9e 09 e2 c8  a8 33 9c 20 18 75 f7 cf  |..^......3. .u..|
-00000030  f5 f7 36 20 d8 66 df 58  38 31 12 cc 0f 30 d4 ac  |..6 .f.X81...0..|
-00000040  f6 da f4 84 74 08 73 c9  12 14 77 e6 13 01 00 00  |....t.s...w.....|
+00000020  bb 8c 5e 07 9e 09 e2 c8  a8 33 9c 20 67 74 47 9b  |..^......3. gtG.|
+00000030  84 d3 e5 4b f1 7a 93 64  ec f6 80 a7 dd 91 7c dd  |...K.z.d......|.|
+00000040  db e3 dd 8b e3 1e d1 9c  5d 4f 71 6f 13 01 00 00  |........]Oqo....|
 00000050  0c 00 2b 00 02 03 04 00  33 00 02 00 17 14 03 03  |..+.....3.......|
 00000060  00 01 01                                          |...|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 16 03  03 01 7d 01 00 01 79 03  |..........}...y.|
-00000010  03 3f 06 8a 40 03 ec e1  c6 76 79 2d d2 3d c3 f1  |.?..@....vy-.=..|
-00000020  1c e5 f8 32 a9 ea 83 93  62 25 81 0f 27 f3 64 dd  |...2....b%..'.d.|
-00000030  d1 20 18 75 f7 cf f5 f7  36 20 d8 66 df 58 38 31  |. .u....6 .f.X81|
-00000040  12 cc 0f 30 d4 ac f6 da  f4 84 74 08 73 c9 12 14  |...0......t.s...|
-00000050  77 e6 00 04 13 01 00 ff  01 00 01 2c 00 0b 00 04  |w..........,....|
+00000000  14 03 03 00 01 01 16 03  03 01 7e 01 00 01 7a 03  |..........~...z.|
+00000010  03 d3 5b 65 c1 4e 7f 6e  ae c0 b6 3c 6c 32 a6 cc  |..[e.N.n...<l2..|
+00000020  9c de b6 1a c9 32 7e 7b  76 44 b7 74 15 de 23 6e  |.....2~{vD.t..#n|
+00000030  e0 20 67 74 47 9b 84 d3  e5 4b f1 7a 93 64 ec f6  |. gtG....K.z.d..|
+00000040  80 a7 dd 91 7c dd db e3  dd 8b e3 1e d1 9c 5d 4f  |....|.........]O|
+00000050  71 6f 00 04 13 01 00 ff  01 00 01 2d 00 0b 00 04  |qo.........-....|
 00000060  03 00 01 02 00 0a 00 06  00 04 00 1d 00 17 00 23  |...............#|
 00000070  00 00 00 16 00 00 00 17  00 00 00 0d 00 1e 00 1c  |................|
 00000080  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000090  08 04 08 05 08 06 04 01  05 01 06 01 00 2b 00 03  |.............+..|
 000000a0  02 03 04 00 2d 00 02 01  01 00 33 00 47 00 45 00  |....-.....3.G.E.|
-000000b0  17 00 41 04 9e c3 66 67  9b 02 09 0f bb fb 50 47  |..A...fg......PG|
-000000c0  f9 d1 71 bf 57 d6 ab f0  e6 3e 71 c2 98 93 e5 7c  |..q.W....>q....||
-000000d0  8a fc 15 d7 c3 3d 25 12  82 ab 25 2c 98 62 fd 43  |.....=%...%,.b.C|
-000000e0  96 da 7c 8e 69 2a a0 b6  e0 a4 d5 8b 11 75 88 1a  |..|.i*.......u..|
-000000f0  a4 6e 07 54 00 29 00 90  00 6b 00 65 00 00 00 00  |.n.T.)...k.e....|
+000000b0  17 00 41 04 d6 a2 de 11  90 fc 3c 5b d3 8e 79 20  |..A.......<[..y |
+000000c0  52 ac 2c 3a 75 e7 f5 e7  f9 81 4f d9 06 3a 88 20  |R.,:u.....O..:. |
+000000d0  f0 0a 74 35 f8 62 a6 18  5c dc e0 85 e7 3e 71 21  |..t5.b..\....>q!|
+000000e0  47 64 ca 12 18 39 f3 cf  a8 ae cb 71 f2 05 93 de  |Gd...9.....q....|
+000000f0  d6 0f 65 4c 00 29 00 91  00 6c 00 66 00 00 00 00  |..eL.)...l.f....|
 00000100  00 00 00 00 00 00 00 00  00 00 00 00 94 68 2d a3  |.............h-.|
-00000110  82 51 ed 14 ef 68 ca 42  c5 5c c8 cf 5f 79 2c cc  |.Q...h.B.\.._y,.|
-00000120  b2 ee 72 fb 49 38 e9 9b  05 4e a0 3e ca 70 03 69  |..r.I8...N.>.p.i|
-00000130  28 72 75 95 34 2a b2 be  b0 d6 99 76 3c 2b 52 f2  |(ru.4*.....v<+R.|
-00000140  8f 9d bf 73 8c 79 04 d5  07 10 8a f8 c1 b7 38 bc  |...s.y........8.|
-00000150  3a 3f 34 f1 43 6c 56 d4  96 30 86 d7 9b da b0 97  |:?4.ClV..0......|
-00000160  4c 00 00 00 00 00 21 20  05 14 40 f9 a1 cc 45 81  |L.....! ..@...E.|
-00000170  73 9e f5 ea af 27 2b 46  cd 8f 8a 83 1d ce b5 96  |s....'+F........|
-00000180  ab 78 ed 4d 03 ce 63 c9                           |.x.M..c.|
+00000110  82 51 ed 14 ef 68 ca 42  c5 5c 7c 58 c6 88 11 29  |.Q...h.B.\|X...)|
+00000120  25 b8 05 56 93 3f b5 60  5b 72 b9 05 af 5f 5a 7d  |%..V.?.`[r..._Z}|
+00000130  3c 00 39 4d c4 3a 8f ea  ad e8 99 76 3c 2b 52 f2  |<.9M.:.....v<+R.|
+00000140  8f 5f 12 93 da 84 40 30  c8 c5 1e 47 a1 1b 94 33  |._....@0...G...3|
+00000150  2e cd cd e3 10 f4 54 01  e7 9f a1 e6 b4 c3 7d ae  |......T.......}.|
+00000160  17 34 00 00 00 00 00 21  20 da 69 5c da c7 3a 91  |.4.....! .i\..:.|
+00000170  2a 37 ce dc 6a 5e e2 8a  e6 55 02 4a 91 6b a6 a5  |*7..j^...U.J.k..|
+00000180  e2 54 e6 bd 04 cd 8e 9d  94                       |.T.......|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 a1 02 00 00  9d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 18 75 f7 cf  |........... .u..|
-00000030  f5 f7 36 20 d8 66 df 58  38 31 12 cc 0f 30 d4 ac  |..6 .f.X81...0..|
-00000040  f6 da f4 84 74 08 73 c9  12 14 77 e6 13 01 00 00  |....t.s...w.....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 67 74 47 9b  |........... gtG.|
+00000030  84 d3 e5 4b f1 7a 93 64  ec f6 80 a7 dd 91 7c dd  |...K.z.d......|.|
+00000040  db e3 dd 8b e3 1e d1 9c  5d 4f 71 6f 13 01 00 00  |........]Oqo....|
 00000050  55 00 2b 00 02 03 04 00  33 00 45 00 17 00 41 04  |U.+.....3.E...A.|
 00000060  1e 18 37 ef 0d 19 51 88  35 75 71 b5 e5 54 5b 12  |..7...Q.5uq..T[.|
 00000070  2e 8f 09 67 fd a7 24 20  3e b2 56 1c ce 97 28 5e  |...g..$ >.V...(^|
 00000080  f8 2b 2d 4f 9e f1 07 9f  6c 4b 5b 83 56 e2 32 42  |.+-O....lK[.V.2B|
 00000090  e9 58 b6 d7 49 a6 b5 68  1a 41 03 56 6b dc 5a 89  |.X..I..h.A.Vk.Z.|
-000000a0  00 29 00 02 00 00 17 03  03 00 17 9e 34 cf 17 aa  |.)..........4...|
-000000b0  19 76 ec 02 40 eb c4 22  1c ed fe 65 fc 80 21 51  |.v..@.."...e..!Q|
-000000c0  e7 41 17 03 03 00 35 7d  6a 3e 39 5f 33 a3 39 fd  |.A....5}j>9_3.9.|
-000000d0  02 2f 39 c3 38 66 99 5f  0b b5 f0 25 7f 24 43 8a  |./9.8f._...%.$C.|
-000000e0  21 24 59 b9 7b fe 08 97  31 a3 9c 9d e2 b0 51 e4  |!$Y.{...1.....Q.|
-000000f0  c6 bc 9c 60 09 02 64 32  58 0e 8b 0b 17 03 03 00  |...`..d2X.......|
-00000100  87 f9 51 62 d5 c6 03 6c  d1 0d 99 7a 64 c9 d1 24  |..Qb...l...zd..$|
-00000110  7d 1f 30 97 47 a0 7f 9a  ff 3b 03 b7 ef 67 cb 0f  |}.0.G....;...g..|
-00000120  b7 f5 d7 9d 38 4a dc 94  85 f3 73 be fa c0 fc 95  |....8J....s.....|
-00000130  a6 ae ae e2 1b 96 1b 13  4e ee 13 e2 4b 8e 09 e1  |........N...K...|
-00000140  65 d4 0c 4f 79 8b 35 fb  a2 a6 e1 e0 07 2b 4f 08  |e..Oy.5......+O.|
-00000150  f5 1b 8a 48 48 aa 20 b3  dc 80 2f 48 8d 06 2b 0c  |...HH. .../H..+.|
-00000160  ca dc a5 f7 2c 85 cb 18  ef a8 e1 6d 31 60 13 c3  |....,......m1`..|
-00000170  14 56 b9 bd ba b6 23 a6  b2 02 92 d7 1d b3 c5 04  |.V....#.........|
-00000180  86 0a 16 68 4a 94 26 70                           |...hJ.&p|
+000000a0  00 29 00 02 00 00 17 03  03 00 17 5d 3a ca 45 62  |.).........]:.Eb|
+000000b0  05 6a 63 d3 98 ac f5 56  b8 8c c9 f3 c6 e2 54 b2  |.jc....V......T.|
+000000c0  9b dc 17 03 03 00 35 6f  58 51 0c 67 ed 48 f3 be  |......5oXQ.g.H..|
+000000d0  8d eb 48 5a 5a e7 92 12  4f fb 44 f2 24 bc 9a 0c  |..HZZ...O.D.$...|
+000000e0  57 29 1c 53 a6 f9 26 7c  6a db fd bd 4f 37 67 36  |W).S..&|j...O7g6|
+000000f0  c1 33 d2 6b de 39 c0 d7  46 cb 67 d9 17 03 03 00  |.3.k.9..F.g.....|
+00000100  88 6d a4 d1 1c c7 df 42  f4 c8 3c ad 93 0d 6d ff  |.m.....B..<...m.|
+00000110  04 19 eb e5 6d af 96 8b  c7 84 84 00 60 87 d8 ed  |....m.......`...|
+00000120  0d 0f ed 0d f7 96 e6 60  68 d8 22 0e 19 cd f0 77  |.......`h."....w|
+00000130  ef 1e b5 e1 e9 1a 4b d0  f8 5d 72 2e f3 71 d5 d8  |......K..]r..q..|
+00000140  26 4a 80 72 ae af 51 a0  c2 ac 03 04 14 4d 06 f3  |&J.r..Q......M..|
+00000150  ea 24 00 8e 7f 28 bd bb  ee 28 20 90 48 43 93 f5  |.$...(...( .HC..|
+00000160  5a ab fe 9b 48 e5 9e 66  7d a5 ef 59 a4 d7 f9 9b  |Z...H..f}..Y....|
+00000170  28 58 58 10 3b 15 fe 18  10 08 d1 c6 8d 87 88 b5  |(XX.;...........|
+00000180  85 b5 ea 18 0a f2 da 0d  82                       |.........|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 35 7d 78 c8  5b 00 b4 99 b4 72 9e 07  |....5}x.[....r..|
-00000010  4a 61 ed 4d 1e fd ac 80  80 f0 0b 5e 51 e8 98 b7  |Ja.M.......^Q...|
-00000020  fb 4e 09 05 b0 af d6 9f  24 3b 1d 1e 7f 67 14 21  |.N......$;...g.!|
-00000030  19 2b b6 ba d6 27 03 28  4f 2e                    |.+...'.(O.|
+00000000  17 03 03 00 35 88 0a 75  2a d7 98 6c 2e 16 d0 91  |....5..u*..l....|
+00000010  1b 71 ce 33 cb ba 61 72  83 50 f0 87 33 13 bd 61  |.q.3..ar.P..3..a|
+00000020  c3 54 c1 1a a1 55 5a 79  4f c8 42 dd 43 a6 65 f2  |.T...UZyO.B.C.e.|
+00000030  70 f4 11 4b f6 44 14 06  a2 3f                    |p..K.D...?|
 >>> Flow 6 (server to client)
-00000000  17 03 03 00 1e 9f f4 05  19 47 13 a8 a4 99 fd 6c  |.........G.....l|
-00000010  17 7f d1 66 4b 3c 52 26  1f b3 7c 3b c2 14 34 ec  |...fK<R&..|;..4.|
-00000020  b7 b3 3e 17 03 03 00 13  34 c3 4e a8 1f c2 2e cb  |..>.....4.N.....|
-00000030  dd 82 be a3 c1 0f 1d 3f  cd 63 84                 |.......?.c.|
+00000000  17 03 03 00 1e e4 a8 e8  f9 cb 64 51 b1 ea 3b 16  |..........dQ..;.|
+00000010  73 d4 6f f8 44 34 ed 05  9a 8d ee 17 75 41 24 b9  |s.o.D4......uA$.|
+00000020  72 27 cf 17 03 03 00 13  8c 37 77 c4 93 7f a5 d8  |r'.......7w.....|
+00000030  a9 42 eb 2d 9d e0 dc 24  8b 40 39                 |.B.-...$.@9|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-X25519 b/src/crypto/tls/testdata/Server-TLSv13-X25519
index 24b5a6c6e1..2b25950799 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-X25519
+++ b/src/crypto/tls/testdata/Server-TLSv13-X25519
@@ -1,97 +1,97 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 c2 01 00 00  be 03 03 ab 09 49 53 54  |.............IST|
-00000010  49 8b fb d2 08 6e 26 25  36 7a 6e 55 0f 96 ea 1d  |I....n&%6znU....|
-00000020  3c 6d 7b 14 66 ff 2c 6b  60 cc 05 20 1f 15 69 ce  |<m{.f.,k`.. ..i.|
-00000030  3b cf ef 1e 71 1b 0e 91  05 61 f7 17 b3 32 4c 52  |;...q....a...2LR|
-00000040  13 88 7a c1 27 18 0e 41  5b bf ac 96 00 04 13 03  |..z.'..A[.......|
+00000000  16 03 01 00 c2 01 00 00  be 03 03 c9 d2 1a 45 73  |..............Es|
+00000010  f0 ca 00 62 a4 05 97 67  2a 80 ef df 21 82 cb 8d  |...b...g*...!...|
+00000020  d9 d6 39 d0 a4 99 35 d8  76 20 0e 20 8b 14 39 9c  |..9...5.v . ..9.|
+00000030  c1 b0 1b d9 43 6b f7 22  01 a8 41 c8 61 89 8a 52  |....Ck."..A.a..R|
+00000040  c5 a6 5a 4a 44 f7 43 86  23 11 1d 03 00 04 13 03  |..ZJD.C.#.......|
 00000050  00 ff 01 00 00 71 00 0b  00 04 03 00 01 02 00 0a  |.....q..........|
 00000060  00 04 00 02 00 1d 00 16  00 00 00 17 00 00 00 0d  |................|
 00000070  00 1e 00 1c 04 03 05 03  06 03 08 07 08 08 08 09  |................|
 00000080  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
 00000090  00 2b 00 03 02 03 04 00  2d 00 02 01 01 00 33 00  |.+......-.....3.|
-000000a0  26 00 24 00 1d 00 20 df  69 bb 81 8d b9 dd 18 8e  |&.$... .i.......|
-000000b0  c8 af 70 28 de e2 2e e0  86 9b 6d 29 e2 4d e9 87  |..p(......m).M..|
-000000c0  5a 53 fe 50 6f 1a 11                              |ZS.Po..|
+000000a0  26 00 24 00 1d 00 20 f4  e2 fc 39 d7 81 9e f5 7b  |&.$... ...9....{|
+000000b0  9c ce d6 e4 87 9e 3c d7  92 fd fc 8c 5d 24 df 07  |......<.....]$..|
+000000c0  20 20 41 69 8d 12 08                              |  Ai...|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 1f 15 69 ce  |........... ..i.|
-00000030  3b cf ef 1e 71 1b 0e 91  05 61 f7 17 b3 32 4c 52  |;...q....a...2LR|
-00000040  13 88 7a c1 27 18 0e 41  5b bf ac 96 13 03 00 00  |..z.'..A[.......|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 8b 14 39 9c  |........... ..9.|
+00000030  c1 b0 1b d9 43 6b f7 22  01 a8 41 c8 61 89 8a 52  |....Ck."..A.a..R|
+00000040  c5 a6 5a 4a 44 f7 43 86  23 11 1d 03 13 03 00 00  |..ZJD.C.#.......|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 ff b6 4a 75 54 2b  |............JuT+|
-00000090  66 2f d9 00 b2 7a 2a e3  b5 2c 28 3b 70 1d a2 cd  |f/...z*..,(;p...|
-000000a0  8b 17 03 03 02 6d 35 8a  4e a1 3c c3 87 04 63 aa  |.....m5.N.<...c.|
-000000b0  94 71 8e 6b 19 de c1 0d  a0 31 e7 99 04 7e 5f 91  |.q.k.....1...~_.|
-000000c0  3e 57 83 9a 39 d1 a4 59  5a d8 a7 7b f4 de 41 64  |>W..9..YZ..{..Ad|
-000000d0  48 f3 20 01 91 b7 c5 af  e7 d2 94 fd d2 a3 cc 22  |H. ............"|
-000000e0  2c 93 ac 06 78 56 c9 a4  e9 bb ec f4 62 99 48 a6  |,...xV......b.H.|
-000000f0  36 81 7b 7a f8 4a d3 42  31 9a df 57 ff 6a c4 03  |6.{z.J.B1..W.j..|
-00000100  84 b8 65 3e af ee 2a 33  32 d9 e2 58 ff ec 4b 40  |..e>..*32..X..K@|
-00000110  e6 76 96 f0 3f 46 a3 75  29 31 d9 f6 66 c8 f4 6a  |.v..?F.u)1..f..j|
-00000120  45 b1 9e 97 2d 83 e6 6a  00 61 e1 af 8b a6 05 b2  |E...-..j.a......|
-00000130  13 f3 e2 74 4c a0 9c a3  68 a8 d7 76 53 3b 66 df  |...tL...h..vS;f.|
-00000140  00 17 a6 f2 08 33 ba 2b  0a 9d d9 d8 b2 50 5e 99  |.....3.+.....P^.|
-00000150  a0 1d 06 bc 4a 84 19 03  d0 54 0a 12 1e 08 49 30  |....J....T....I0|
-00000160  8e a1 80 09 20 49 c7 3d  d7 e8 a7 ed 44 71 b7 9f  |.... I.=....Dq..|
-00000170  6d 2b 52 d3 1d 36 7b 92  ad 23 59 06 aa 9f f0 a5  |m+R..6{..#Y.....|
-00000180  4e 6f 1e c7 22 7a 1f bf  6c da f4 88 c2 83 1f 5d  |No.."z..l......]|
-00000190  f8 2e 93 a1 a7 34 32 7f  56 19 3a 5b 7f 1b 3d 37  |.....42.V.:[..=7|
-000001a0  d2 71 61 bc 1a eb d4 38  4f 2a 55 cc 34 7d 07 42  |.qa....8O*U.4}.B|
-000001b0  08 e0 78 74 ef 94 4a b0  1c 74 fb 17 36 e8 38 e9  |..xt..J..t..6.8.|
-000001c0  10 98 f7 3f 16 20 9e 7e  74 f3 44 0b cd 08 b9 03  |...?. .~t.D.....|
-000001d0  dd 96 12 a4 75 e7 2b 44  18 0f 71 b4 6a 51 c9 a2  |....u.+D..q.jQ..|
-000001e0  5d 84 43 f5 cd 57 31 5c  58 13 75 54 cd 6f de 80  |].C..W1\X.uT.o..|
-000001f0  86 db 07 14 1b d7 df 12  75 ef fd 15 e8 59 eb 13  |........u....Y..|
-00000200  7b d5 e9 30 29 75 48 43  c0 bd 60 44 5e db 97 53  |{..0)uHC..`D^..S|
-00000210  4c c2 60 ab e6 30 9b f2  20 59 fc 8b aa f3 0e 40  |L.`..0.. Y.....@|
-00000220  89 c1 f4 02 dd 7f cb 66  91 32 7a 74 9f ca cb c0  |.......f.2zt....|
-00000230  c9 1d ab cf 9d 31 f4 31  f7 0b 13 7d bf 9c f9 8e  |.....1.1...}....|
-00000240  92 3d 2f a1 cf ff e9 51  ae 4b f9 45 61 bd 71 49  |.=/....Q.K.Ea.qI|
-00000250  46 f9 4e 95 3c 03 35 d7  0b 5c 66 7d a4 0d a7 10  |F.N.<.5..\f}....|
-00000260  a9 98 44 4d 97 fa ac f0  6c 1f 56 fb 8d 23 df 1f  |..DM....l.V..#..|
-00000270  49 e8 7b 77 39 95 b0 b1  13 2b c6 74 f7 b6 01 18  |I.{w9....+.t....|
-00000280  ad 7d 24 8c a9 4e 26 f5  19 9f f3 8a 96 2c 53 2d  |.}$..N&......,S-|
-00000290  79 35 83 2c 05 df 14 4d  48 53 b9 80 1d cf 99 1d  |y5.,...MHS......|
-000002a0  0d 96 60 57 e7 43 d1 59  aa 58 b4 ce a8 e4 96 cb  |..`W.C.Y.X......|
-000002b0  f7 c1 e8 35 c0 00 34 77  12 25 73 6b 21 b6 49 68  |...5..4w.%sk!.Ih|
-000002c0  af c2 0d ea 4d ff 00 05  0c 57 91 e2 1f 54 03 c4  |....M....W...T..|
-000002d0  89 3b b4 2e a4 3e 97 17  54 d6 93 b9 f4 a6 df 98  |.;...>..T.......|
-000002e0  d6 1c ea 4b 4f 14 87 65  19 d2 b7 3c 71 8f 6d 88  |...KO..e...<q.m.|
-000002f0  9d 6e 89 b5 e5 35 4c 49  ba 48 3c 56 a9 e1 04 14  |.n...5LI.H<V....|
-00000300  36 42 73 b0 e3 f9 25 03  05 eb ac 14 55 93 df cd  |6Bs...%.....U...|
-00000310  8f 34 9f 17 03 03 00 99  8f 8d d1 d7 4a 61 09 ea  |.4..........Ja..|
-00000320  6b 39 2c 2c d9 1b a9 2a  d6 74 d7 bd e0 c0 43 d7  |k9,,...*.t....C.|
-00000330  1a 10 b5 ce 10 77 20 7f  50 f8 e8 fd 43 6e e1 35  |.....w .P...Cn.5|
-00000340  9e fd ec 40 24 50 9d 5c  f3 a4 6e 59 99 0b 43 bc  |...@$P.\..nY..C.|
-00000350  0c ae c8 7f ce e8 fb 22  6a b4 a6 e2 ec 3a 6d 74  |......."j....:mt|
-00000360  b9 2d 82 82 e0 17 8f f1  8c 6a fe 11 2b 7a 46 b4  |.-.......j..+zF.|
-00000370  40 5e a6 3e 80 c4 f5 bd  23 20 eb 18 5e 4e a2 98  |@^.>....# ..^N..|
-00000380  39 48 bf d7 53 fb 3a 02  1f fc ca 5d 30 13 ea 9b  |9H..S.:....]0...|
-00000390  ca 40 53 cb 8c c7 d1 02  35 8d e8 41 dc 25 3c b9  |.@S.....5..A.%<.|
-000003a0  c8 4e ed d1 0d 80 0f c8  93 2f 0e 11 ca 93 12 b7  |.N......./......|
-000003b0  9d 17 03 03 00 35 6a 5f  f5 2a fd 88 21 80 a0 84  |.....5j_.*..!...|
-000003c0  27 18 02 15 1f 78 98 a3  d2 9c 59 aa 1c f3 d4 96  |'....x....Y.....|
-000003d0  c3 04 a8 a7 c9 71 75 64  c4 33 9f f5 19 6b b1 69  |.....qud.3...k.i|
-000003e0  1d c5 ac 47 e8 71 28 3b  76 51 4d 17 03 03 00 87  |...G.q(;vQM.....|
-000003f0  89 ee 09 e0 02 61 fa 6a  9c e2 d1 de fe c7 c2 28  |.....a.j.......(|
-00000400  c8 b8 c6 c7 b7 56 91 67  58 c8 5f 0e b3 ad 13 cd  |.....V.gX._.....|
-00000410  a7 55 41 0f a1 98 4e af  59 6a ce 00 b6 fe fc 05  |.UA...N.Yj......|
-00000420  6d 6b 7c 24 ef 90 25 b5  ac de 50 bb 30 2c 63 80  |mk|$..%...P.0,c.|
-00000430  fe 04 7d 73 50 de 34 22  8d 6f 66 dd 94 73 3c 35  |..}sP.4".of..s<5|
-00000440  12 aa fa 72 2d ad 03 6b  f5 49 c4 0f 48 29 ac 8b  |...r-..k.I..H)..|
-00000450  08 fa dc 6c 4c e9 2b e4  f7 ee 02 d1 7a 33 4a c6  |...lL.+.....z3J.|
-00000460  7c 2f 32 69 46 92 34 3e  d1 c5 51 1e 41 6e fc 16  ||/2iF.4>..Q.An..|
-00000470  6f 64 23 6c aa f3 a5                              |od#l...|
+00000080  03 03 00 01 01 17 03 03  00 17 41 15 f7 69 22 fb  |..........A..i".|
+00000090  e9 57 49 b1 bf 74 ae 74  27 37 8f b8 13 c7 66 68  |.WI..t.t'7....fh|
+000000a0  be 17 03 03 02 6d 40 a3  61 8f df 5f 7d 40 98 13  |.....m@.a.._}@..|
+000000b0  54 c2 60 b7 6f 0b 39 d0  9b b5 b9 fd ad b9 d3 85  |T.`.o.9.........|
+000000c0  e8 88 45 47 2e 3c a4 9e  ae 09 d8 a4 3b 96 c7 9a  |..EG.<......;...|
+000000d0  e7 32 e6 84 55 a6 19 e1  79 2b 74 70 f8 e4 be 4a  |.2..U...y+tp...J|
+000000e0  d6 75 16 96 d0 4e 2a 74  8f 5f 62 cf 82 a7 ac af  |.u...N*t._b.....|
+000000f0  de 58 50 e9 92 f5 8f ef  14 f5 f7 a3 d3 eb a9 35  |.XP............5|
+00000100  92 32 4b 90 b1 d0 06 bc  02 d3 92 d6 c4 b7 be b7  |.2K.............|
+00000110  d7 40 5e b1 49 c3 5f 2b  d2 a3 98 31 6c fd ea 94  |.@^.I._+...1l...|
+00000120  22 ee be df 23 ea 62 f0  b4 f8 d9 5e 55 06 5b d0  |"...#.b....^U.[.|
+00000130  d8 e3 6c db ee 2b 28 60  5b 1f b5 d9 2d 68 da 8f  |..l..+(`[...-h..|
+00000140  d5 67 fc 53 84 af ef d0  6c f6 cd 3a 7a 57 4a 00  |.g.S....l..:zWJ.|
+00000150  16 94 5e 7f 37 c3 f0 8f  e8 e7 a7 68 f6 56 8d 41  |..^.7......h.V.A|
+00000160  5b c4 bc c0 f9 fb 2d e0  ee fc 0d d6 b0 e4 ff 4d  |[.....-........M|
+00000170  67 1c 70 2b 43 cf df 92  11 7a 4a 29 d3 93 f8 ed  |g.p+C....zJ)....|
+00000180  dd 77 e5 28 5d b2 c9 4d  47 f3 1b db a0 ea 70 70  |.w.(]..MG.....pp|
+00000190  fe b3 90 de 24 df bb f7  0a 29 23 c7 b6 db fa 62  |....$....)#....b|
+000001a0  d2 1e 4c e2 47 0e 77 a2  e4 6d f3 ec c4 48 42 a4  |..L.G.w..m...HB.|
+000001b0  21 a4 33 5d e2 13 31 3f  5a 4d 93 a7 fe c2 ce 59  |!.3]..1?ZM.....Y|
+000001c0  cf c2 76 38 7e e6 7f b0  62 51 97 f5 dc d9 ff b4  |..v8~...bQ......|
+000001d0  9e a8 b3 73 38 b7 39 82  ac 86 80 24 8e 1e 78 33  |...s8.9....$..x3|
+000001e0  1c 0e 8b d3 4b 87 fe 5a  08 e9 0b a2 38 ff 42 d8  |....K..Z....8.B.|
+000001f0  7e 75 49 41 10 95 ba 6e  0c 42 d6 97 2a a2 b4 55  |~uIA...n.B..*..U|
+00000200  ed e9 83 4c 50 19 7d a4  9d 02 a7 27 6b d0 c6 93  |...LP.}....'k...|
+00000210  6c d4 69 21 de 2b d8 c8  82 fb de 04 15 c7 a1 f8  |l.i!.+..........|
+00000220  25 2a fa 24 dd f7 f7 52  23 95 6f b7 82 13 c5 16  |%*.$...R#.o.....|
+00000230  f7 20 fc a3 f9 43 4b da  4b 07 ae e9 4b ed 50 5c  |. ...CK.K...K.P\|
+00000240  b7 14 9c 2b 0f 94 e2 21  ef be 30 e1 60 a7 ca 10  |...+...!..0.`...|
+00000250  b0 da 93 c8 1d 5f 0c 58  93 4c 43 cd 4b 18 fb 4f  |....._.X.LC.K..O|
+00000260  81 ed dd 12 2e 8f 16 60  b6 db dc ff d8 d2 4b 59  |.......`......KY|
+00000270  2a 8b d3 22 bc 5d 3b 19  d6 f0 98 4e 03 9e b3 4b  |*..".];....N...K|
+00000280  cf 01 b7 cd 67 3a c8 a8  c7 92 e9 2f 44 dc 51 c2  |....g:...../D.Q.|
+00000290  44 a6 5a e4 8f f4 a7 d2  25 12 9c a1 ba d3 33 58  |D.Z.....%.....3X|
+000002a0  8d 23 c9 de ec bd f9 38  5f 34 9a a0 1b 59 a1 a6  |.#.....8_4...Y..|
+000002b0  a5 f8 05 ec 25 85 84 d2  02 ae b8 93 6f 64 79 cc  |....%.......ody.|
+000002c0  3a 7f a2 62 3a 6f fb 8f  9f c3 e5 ab d7 43 80 f9  |:..b:o.......C..|
+000002d0  a3 b7 91 0b 0f 00 de 7d  28 3e a0 84 b1 99 b0 a8  |.......}(>......|
+000002e0  15 ef 55 da a2 73 45 3f  6f 27 30 20 f4 ae 27 bc  |..U..sE?o'0 ..'.|
+000002f0  1f f7 a4 4f 41 44 19 9a  08 02 0a c7 2d f4 ab 3f  |...OAD......-..?|
+00000300  ac 20 f0 e6 b6 59 30 fc  13 9c ab c6 40 4c 86 1f  |. ...Y0.....@L..|
+00000310  75 6e 1b 17 03 03 00 99  ce ae 85 cd b6 a3 3b 40  |un............;@|
+00000320  19 ad 79 0a eb b3 28 0b  91 df cb 06 6b 49 59 2b  |..y...(.....kIY+|
+00000330  d8 b3 98 2f 2a 0c 4a 21  1f 08 b1 69 c7 71 cf ba  |.../*.J!...i.q..|
+00000340  3a 92 de 20 1d 03 a1 f8  31 3a 5d 32 1e 20 38 4e  |:.. ....1:]2. 8N|
+00000350  5a 41 a3 30 3e b3 37 60  e7 86 1d bb 53 46 70 7a  |ZA.0>.7`....SFpz|
+00000360  ca 10 b8 01 83 7e 1b 18  f7 b4 b8 d1 f1 89 fd 9d  |.....~..........|
+00000370  b8 06 b1 7c 51 b9 0e 2d  f9 30 79 cd fc cb ce 1a  |...|Q..-.0y.....|
+00000380  83 6f 19 d3 52 f7 5e 76  93 41 65 84 53 c9 52 1d  |.o..R.^v.Ae.S.R.|
+00000390  fb 25 bd 6e d4 b5 de 70  ab ce a5 31 0b 54 ed 32  |.%.n...p...1.T.2|
+000003a0  33 54 bc 96 ce 8f 48 0c  1a 8a c0 36 3b bc 85 23  |3T....H....6;..#|
+000003b0  b9 17 03 03 00 35 be 18  03 d8 e9 8c d1 bb e0 52  |.....5.........R|
+000003c0  a0 47 b4 bb 27 26 18 6f  6f 86 05 e4 6a fc ce 24  |.G..'&.oo...j..$|
+000003d0  e0 7e 2b 2f 0d 0a aa a4  e2 f4 1e 8a 13 d4 a1 78  |.~+/...........x|
+000003e0  26 fb fa 50 84 dd 44 f8  82 41 a2 17 03 03 00 88  |&..P..D..A......|
+000003f0  23 77 4e fb 83 21 4e bd  5d 80 a0 45 5f 04 44 de  |#wN..!N.]..E_.D.|
+00000400  67 ec a3 7b a3 bd 2c 50  b7 a2 2f 6a 80 f7 89 18  |g..{..,P../j....|
+00000410  62 4a 15 8d 97 06 7a 36  ae f6 3f 22 0d d6 c8 d0  |bJ....z6..?"....|
+00000420  fa dc 7a 1a 14 78 d3 52  a0 19 ee cc 8b d7 70 79  |..z..x.R......py|
+00000430  c1 f3 09 d7 bf e3 ae df  bc 62 1d 49 75 df b5 3f  |.........b.Iu..?|
+00000440  fc b1 9d 20 16 56 f1 52  45 61 a4 8c 8e 54 d6 47  |... .V.REa...T.G|
+00000450  95 da 7c 72 3d 0a a8 0d  eb d4 c7 93 02 62 68 52  |..|r=........bhR|
+00000460  b4 bc a4 8e 11 3b 37 f8  ed 70 38 55 e5 34 e7 55  |.....;7..p8U.4.U|
+00000470  f6 76 71 2a 32 93 dd d5                           |.vq*2...|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 1b 6b 60 eb 51  |..........5.k`.Q|
-00000010  e6 06 a6 d3 a5 93 67 39  60 8a 49 bc fa 78 59 9f  |......g9`.I..xY.|
-00000020  4b d8 5d 4c 8c 7e e1 e0  cf b7 b6 82 08 60 bb 87  |K.]L.~.......`..|
-00000030  0c 42 07 02 22 65 fc e7  2c ee 1b 19 32 a6 0a 61  |.B.."e..,...2..a|
+00000000  14 03 03 00 01 01 17 03  03 00 35 d2 f9 fa 20 90  |..........5... .|
+00000010  ca b6 f2 98 52 46 d8 df  19 39 0a 04 7b f5 38 2e  |....RF...9..{.8.|
+00000020  c4 56 89 a3 c0 60 b4 0e  87 c2 78 a8 d1 b8 2a 07  |.V...`....x...*.|
+00000030  00 d3 8f b8 c0 5c d2 bd  cc 37 b5 ba 4f 8e dd a6  |.....\...7..O...|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 27 9b 29  d1 33 5a 0e cf 05 0e 17  |.....'.).3Z.....|
-00000010  98 3c e3 c8 7f f3 01 f4  1a dd f6 fe c1 93 28 77  |.<............(w|
-00000020  12 71 56 17 03 03 00 13  1d a9 36 4e f8 0f 3e bd  |.qV.......6N..>.|
-00000030  e7 2d 4c a1 7b ad 30 73  36 3d e5                 |.-L.{.0s6=.|
+00000000  17 03 03 00 1e a1 95 8f  0b 7e 43 3f be 2f 19 78  |.........~C?./.x|
+00000010  e4 52 c5 e2 17 6f 49 87  90 eb d4 4e 9b a1 de 61  |.R...oI....N...a|
+00000020  b6 f5 f8 17 03 03 00 13  1c 7e a3 be 1c cb 33 78  |.........~....3x|
+00000030  23 d8 a6 06 d3 dc 3a d5  6c e7 dd                 |#.....:.l..|
diff --git a/src/crypto/tls/ticket.go b/src/crypto/tls/ticket.go
index 4aceebf2a1..71f4df8f7f 100644
--- a/src/crypto/tls/ticket.go
+++ b/src/crypto/tls/ticket.go
@@ -34,6 +34,7 @@ type SessionState struct {
 	//       uint64 created_at;
 	//       opaque secret<1..2^8-1>;
 	//       opaque extra<0..2^24-1>;
+	//       uint8 ext_master_secret = { 0, 1 };
 	//       uint8 early_data = { 0, 1 };
 	//       CertificateEntry certificate_list<0..2^24-1>;
 	//       select (SessionState.early_data) {
@@ -81,6 +82,7 @@ type SessionState struct {
 	// which the ticket was received on the client.
 	createdAt         uint64 // seconds since UNIX epoch
 	secret            []byte // master secret for TLS 1.2, or the PSK for TLS 1.3
+	extMasterSecret   bool
 	peerCertificates  []*x509.Certificate
 	activeCertHandles []*activeCert
 	ocspResponse      []byte
@@ -117,6 +119,11 @@ func (s *SessionState) Bytes() ([]byte, error) {
 	b.AddUint24LengthPrefixed(func(b *cryptobyte.Builder) {
 		b.AddBytes(s.Extra)
 	})
+	if s.extMasterSecret {
+		b.AddUint8(1)
+	} else {
+		b.AddUint8(0)
+	}
 	if s.EarlyData {
 		b.AddUint8(1)
 	} else {
@@ -173,7 +180,7 @@ func certificatesToBytesSlice(certs []*x509.Certificate) [][]byte {
 func ParseSessionState(data []byte) (*SessionState, error) {
 	ss := &SessionState{}
 	s := cryptobyte.String(data)
-	var typ, earlyData uint8
+	var typ, extMasterSecret, earlyData uint8
 	var cert Certificate
 	if !s.ReadUint16(&ss.version) ||
 		!s.ReadUint8(&typ) ||
@@ -182,11 +189,20 @@ func ParseSessionState(data []byte) (*SessionState, error) {
 		!readUint64(&s, &ss.createdAt) ||
 		!readUint8LengthPrefixed(&s, &ss.secret) ||
 		!readUint24LengthPrefixed(&s, &ss.Extra) ||
+		!s.ReadUint8(&extMasterSecret) ||
 		!s.ReadUint8(&earlyData) ||
 		len(ss.secret) == 0 ||
 		!unmarshalCertificate(&s, &cert) {
 		return nil, errors.New("tls: invalid session encoding")
 	}
+	switch extMasterSecret {
+	case 0:
+		ss.extMasterSecret = false
+	case 1:
+		ss.extMasterSecret = true
+	default:
+		return nil, errors.New("tls: invalid session encoding")
+	}
 	switch earlyData {
 	case 0:
 		ss.EarlyData = false
@@ -279,6 +295,7 @@ func (c *Conn) sessionState() (*SessionState, error) {
 		ocspResponse:      c.ocspResponse,
 		scts:              c.scts,
 		isClient:          c.isClient,
+		extMasterSecret:   c.extMasterSecret,
 		verifiedChains:    verifiedChains,
 	}, nil
 }
diff --git a/src/crypto/tls/tls_test.go b/src/crypto/tls/tls_test.go
index d7691f41bd..610cffa094 100644
--- a/src/crypto/tls/tls_test.go
+++ b/src/crypto/tls/tls_test.go
@@ -474,6 +474,9 @@ func TestTLSUniqueMatches(t *testing.T) {
 	if !bytes.Equal(conn.ConnectionState().TLSUnique, serverTLSUniquesValue) {
 		t.Error("client and server channel bindings differ")
 	}
+	if serverTLSUniquesValue == nil || bytes.Equal(serverTLSUniquesValue, make([]byte, 12)) {
+		t.Error("tls-unique is empty or zero")
+	}
 	conn.Close()
 
 	conn, err = Dial("tcp", ln.Addr().String(), clientConfig)
@@ -494,6 +497,9 @@ func TestTLSUniqueMatches(t *testing.T) {
 	if !bytes.Equal(conn.ConnectionState().TLSUnique, serverTLSUniquesValue) {
 		t.Error("client and server channel bindings differ when session resumption is used")
 	}
+	if serverTLSUniquesValue == nil || bytes.Equal(serverTLSUniquesValue, make([]byte, 12)) {
+		t.Error("resumption tls-unique is empty or zero")
+	}
 }
 
 func TestVerifyHostname(t *testing.T) {
