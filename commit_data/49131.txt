commit 2fe4b14795fe20fa3ba8efbe92b88f2d564509d2
Author: Keith Randall <khr@golang.org>
Date:   Tue Jul 20 12:55:51 2021 -0700

    [dev.typeparams] cmd/compile: ensure methods of generic types survive linker pruning
    
    Calling MarkTypeUsedInInterface before inlining is problematic (when
    using the containing function as the reference source), because we end
    up attaching a relocation to the original function, which is then
    deadcode removed because all instances of it were inlined. (All other
    current uses of MarkTypeUsedInInterface happen after inlining, so they
    don't have this problem.)
    
    Instead, attach the relocation to the dictionary in which the type
    appears.  This should always work, because if the dictionary is ever
    deadcode eliminated, then the type can never be put in an interface,
    which means we indeed don't need its methods.
    
    This CL is a bit overkill, as not *all* types in the dictionary need
    this mark, but it is sufficient for now.
    
    Change-Id: I2d39456691f1c3df8efe3bddc3b9017e0ef37a7f
    Reviewed-on: https://go-review.googlesource.com/c/go/+/336012
    Trust: Keith Randall <khr@golang.org>
    Trust: Dan Scales <danscales@google.com>
    Reviewed-by: Dan Scales <danscales@google.com>

 src/cmd/compile/internal/noder/stencil.go | 8 ++++++--
 1 file changed, 6 insertions(+), 2 deletions(-)
