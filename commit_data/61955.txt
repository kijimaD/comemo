commit e3cd55e9d293d519e622e788e902f372dc30338a
Author: Pedro TÃ´rres <t0rr3sp3dr0@gmail.com>
Date:   Fri Dec 27 07:21:53 2024 +0000

    cmd/go/internal/work: allow @ character in some -Wl, linker flags on darwin
    
    The GNU linker interprets @file as "read command-line options from file".
    Thus, we forbid values starting with @ on linker flags. However, this
    causes a problem when targeting Darwin. @executable_path, @loader_path, and
    @rpath are special values used in Mach-O to change the library search path
    and can be used in conjunction with the -install_name and -rpath linker
    flags. Since the GNU linker does not support Mach-O, targeting Darwin
    implies not using the GNU linker. Therefore, we allow @ in the linker flags
    if and only if cfg.Goos == "darwin".
    
    Fixes #40559
    
    Change-Id: I0896758f0835e444ea0d501ea3fd8423cff97a27
    GitHub-Last-Rev: 2b81dcd12e7ae0bbb77deccc9973f84a3aa6d750
    GitHub-Pull-Request: golang/go#70939
    Reviewed-on: https://go-review.googlesource.com/c/go/+/638075
    Auto-Submit: Ian Lance Taylor <iant@golang.org>
    Reviewed-by: Ian Lance Taylor <iant@google.com>
    Reviewed-by: Cherry Mui <cherryyz@google.com>
    LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>

 src/cmd/go/internal/work/security.go      | 22 +++++++++++++++-
 src/cmd/go/internal/work/security_test.go | 44 +++++++++++++++++++++++++++++++
 2 files changed, 65 insertions(+), 1 deletion(-)
