commit 7973b0e50861c49c1852a545b51b7ab977135d6d
Author: Than McIntosh <thanm@google.com>
Date:   Thu Dec 8 10:58:49 2022 -0500

    cmd/{go,cover,covdata}: fix 'package main' inconsistent handling
    
    Fix a buglet in cmd/cover in how we handle package name/path for the
    "go build -o foo.exe *.go" and "go run *.go" cases.
    
    The go command assigns a dummy import path of "command-line-arguments"
    to the main package built in these cases; rather than expose this
    dummy to the user in coverage reports, the cover tool had a special
    case hack intended to rewrite such package paths to "main". The hack
    was too general, however, and was rewriting the import path of all
    packages with (p.name == "main") to an import path of "main". The hack
    also produced unexpected results for cases such as
    
      go test -cover foo.go foo_test.go
    
    This patch removes the hack entirely, leaving the package path for
    such cases as "command-line-arguments".
    
    Fixes #57169.
    
    Change-Id: Ib6071db5e3485da3b8c26e16ef57f6fa1712402c
    Reviewed-on: https://go-review.googlesource.com/c/go/+/456237
    TryBot-Result: Gopher Robot <gobot@golang.org>
    Run-TryBot: Than McIntosh <thanm@google.com>
    Reviewed-by: Bryan Mills <bcmills@google.com>

 src/cmd/covdata/tool_test.go                       | 35 +++++++-------
 src/cmd/cover/cover.go                             |  3 --
 .../testdata/script/cover_build_cmdline_pkgs.txt   |  4 +-
 .../go/testdata/script/cover_main_import_path.txt  | 54 ++++++++++++++++++++++
 src/runtime/coverage/emitdata_test.go              |  9 ++--
 5 files changed, 81 insertions(+), 24 deletions(-)
