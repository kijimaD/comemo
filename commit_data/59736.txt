commit c686783cabd4603cdff662f8cf9180c4f76b7928
Author: Than McIntosh <thanm@google.com>
Date:   Thu Apr 11 15:16:22 2024 +0000

    cmd/compile/internal/ssa: delay rewrite cycle detection for huge funcs
    
    The SSA rewrite pass has some logic that looks to see whether a
    suspiciously large number of rewrites is happening, and if so, turns
    on logic to try to detect rewrite cycles. The cycle detection logic is
    quite expensive (hashes the entire function), meaning that for very
    large functions we might get a successful compilation in a minute or
    two with no cycle detection, but take a couple of hours once cycle
    detection kicks in.
    
    This patch moves from a fixed limit of 1000 iterations to a limit set
    partially based on the size of the function (meaning that we'll wait
    longer before turning cycle detection for a large func).
    
    Fixes #66773.
    
    Change-Id: I72f8524d706f15b3f0150baf6abeab2a5d3e15c4
    Reviewed-on: https://go-review.googlesource.com/c/go/+/578215
    LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
    Reviewed-by: Cherry Mui <cherryyz@google.com>

 src/cmd/compile/internal/ssa/rewrite.go | 10 +++++++++-
 1 file changed, 9 insertions(+), 1 deletion(-)
