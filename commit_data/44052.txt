commit 4d27c4c223ccb7de3876abbac79b58ad9579be1a
Author: Nikhil Benesch <nikhil.benesch@gmail.com>
Date:   Wed Dec 9 15:14:59 2020 -0500

    runtime: correct error handling in several FreeBSD syscall wrappers
    
    The FreeBSD syscall convention uses the carry flag to indicate whether
    an error has occured. The sys_umtx_op, thr_new, and pipe2 syscall
    wrappers were failing to account for this convention and silently
    suppressing errors as a result. This commit corrects these wrappers
    by copying the pattern used by the other fallible syscall wrappers.
    
    Note that futexsleep1 must now explicitly ignore the ETIMEDOUT error
    from sys_umtx_op. Previously ETIMEDOUT was implicitly ignored because
    sys_umtx_op never returned an error.
    
    Fixes #43106.
    
    Change-Id: I9c422b87cf4c6d308003bf42c3b419f785578b5d
    Reviewed-on: https://go-review.googlesource.com/c/go/+/276892
    Run-TryBot: Ian Lance Taylor <iant@golang.org>
    Reviewed-by: Austin Clements <austin@google.com>
    Trust: Than McIntosh <thanm@google.com>

 src/runtime/defs_freebsd_386.go   | 9 +++++----
 src/runtime/defs_freebsd_amd64.go | 9 +++++----
 src/runtime/defs_freebsd_arm.go   | 9 +++++----
 src/runtime/defs_freebsd_arm64.go | 9 +++++----
 src/runtime/os_freebsd.go         | 3 +--
 src/runtime/sys_freebsd_386.s     | 6 ++++++
 src/runtime/sys_freebsd_amd64.s   | 6 ++++++
 src/runtime/sys_freebsd_arm.s     | 3 +++
 src/runtime/sys_freebsd_arm64.s   | 6 ++++++
 9 files changed, 42 insertions(+), 18 deletions(-)
