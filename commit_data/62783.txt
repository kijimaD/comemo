commit 9aad012a6e02d45b37757faeec20cc6923610baf
Author: qmuntal <quimmuntal@gmail.com>
Date:   Wed Apr 9 11:15:38 2025 +0200

    net: reenable sendfile on Windows
    
    Windows sendfile optimization is skipped since CL 472475, which started
    passing an os.fileWithoutWriteTo instead of an os.File to sendfile,
    and that function was only implemented for os.File.
    
    This CL fixes the issue by asserting against an interface rather than
    a concrete type.
    
    Some tests have been reenabled, triggering bugs in poll.SendFile which
    have been fixed in this CL.
    
    Fixes #67042.
    
    Cq-Include-Trybots: luci.golang.try:gotip-windows-amd64-longtest
    Change-Id: Id6f7a0e1e0f34a72216fa9d00c5bf36f5a994219
    Reviewed-on: https://go-review.googlesource.com/c/go/+/664055
    Reviewed-by: Damien Neil <dneil@google.com>
    Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
    LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
    Reviewed-by: Alex Brainman <alex.brainman@gmail.com>

 src/internal/poll/sendfile_windows.go | 80 ++++++++++++++++++-----------------
 src/net/sendfile_test.go              | 25 ++++-------
 src/net/sendfile_windows.go           | 42 +++++++++++-------
 3 files changed, 77 insertions(+), 70 deletions(-)
