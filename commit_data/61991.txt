commit 850b276a6765d20bf01c44d6126386e8fb7d8a76
Author: thekuwayama <thekuwayama@gmail.com>
Date:   Mon Dec 30 19:28:35 2024 +0000

    crypto/tls: send illegal_parameter on invalid ECHClientHello.type
    
    The spec indicates that if a client sends an invalid ECHClientHello.type
    in ClientHelloOuter, the server will abort the handshake with a
    decode_error alert.
    
    Define errInvalidECHExt for invalid ECHClientHello.type. If parseECHExt
    returns an errInvalidECHExt error, Conn now sends an illegal_parameter
    alert.
    
    Fixes #71061.
    
    Change-Id: I240241fe8bbe3e77d6ad1af989794647bfa2ff87
    GitHub-Last-Rev: 3d6c233ccd401453bfb1a4fc97fa5deeb5b2fbc8
    GitHub-Pull-Request: golang/go#71062
    Reviewed-on: https://go-review.googlesource.com/c/go/+/639235
    Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
    LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
    Reviewed-by: Roland Shoemaker <roland@golang.org>

 src/crypto/tls/ech.go | 16 +++++++++++-----
 1 file changed, 11 insertions(+), 5 deletions(-)
