commit a627fcd3c4fdacdc9bbcccdb926e4804ca6d6815
Author: Michael Matloob <matloob@golang.org>
Date:   Fri May 14 11:46:26 2021 -0400

    [dev.cmdgo] cmd/go: replace Target with MainModules, allowing for multiple targets
    
    This change replaces the Target variable that represents the main module
    and the pathPrefix and inGorootSrc which provide other information about
    the main module with a single MainModules value that represents multiple
    main modules and holds their path prefixes, module roots, and whether
    they are in GOROOT/src. In cases where the code checks Target or its
    previously associated variables, the code now checks or iterates over
    MainModules. In some cases, the code still assumes a single main module
    by calling MainModules.MustGetSingleMainModule. Some of those cases are
    correct: for instance, there is always only one main module for
    mod=vendor. Other cases are accompanied with TODOs and will have to be
    fixed in future CLs to properly support multiple main modules.
    
    This CL (and other cls on top of it) are planned to be checked into a
    branch to allow for those evaluating the workspaces proposal to try it
    hands on.
    
    For #45713
    
    Change-Id: I3b699e1d5cad8c76d62dc567b8460de8c73a87ea
    Reviewed-on: https://go-review.googlesource.com/c/go/+/334932
    Trust: Michael Matloob <matloob@golang.org>
    Run-TryBot: Michael Matloob <matloob@golang.org>
    TryBot-Result: Go Bot <gobot@golang.org>
    Reviewed-by: Jay Conrod <jayconrod@google.com>

 src/cmd/go/internal/get/get.go           |   6 +-
 src/cmd/go/internal/load/pkg.go          |   7 +-
 src/cmd/go/internal/modcmd/download.go   |  14 +-
 src/cmd/go/internal/modcmd/vendor.go     |   2 +-
 src/cmd/go/internal/modget/get.go        |  50 +++---
 src/cmd/go/internal/modget/query.go      |   6 +-
 src/cmd/go/internal/modload/build.go     |  19 +-
 src/cmd/go/internal/modload/buildlist.go |  77 ++++++---
 src/cmd/go/internal/modload/edit.go      |  20 ++-
 src/cmd/go/internal/modload/import.go    |  24 +--
 src/cmd/go/internal/modload/init.go      | 286 ++++++++++++++++++++++---------
 src/cmd/go/internal/modload/list.go      |   6 +-
 src/cmd/go/internal/modload/load.go      | 148 ++++++++++------
 src/cmd/go/internal/modload/modfile.go   |  12 +-
 src/cmd/go/internal/modload/mvs.go       |   4 +-
 src/cmd/go/internal/modload/query.go     | 111 +++++++-----
 src/cmd/go/internal/modload/search.go    |  15 +-
 src/cmd/go/internal/modload/vendor.go    |   1 +
 src/cmd/go/internal/mvs/mvs.go           |  34 ++--
 src/cmd/go/internal/mvs/mvs_test.go      |   2 +-
 src/cmd/go/internal/search/search.go     |  33 ++--
 21 files changed, 563 insertions(+), 314 deletions(-)
