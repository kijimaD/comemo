commit 84cd7ab3c388fb3280cf426a35045d85cda99ff8
Author: Bryan C. Mills <bcmills@google.com>
Date:   Wed Oct 26 12:18:13 2022 -0400

    internal/testenv: add CommandContext and Command
    
    This adds a testenv.CommandContext function, with timeout behavior
    based on the existing logic in cmd/go.TestScript: namely, the command
    is terminated with SIGQUIT (if supported) with an arbitrary grace
    period remaining until the test's deadline.
    
    If the test environment does not support executing subprocesses,
    CommandContext skips the test.
    
    If the command is terminated due to the timout expiring or the test
    fails to wait for the command after starting it, CommandContext marks
    the test as failing.
    
    For tests where a shorter timeout is desired (such as for fail-fast
    behavior), one may be supplied using context.WithTimeout.
    
    The more concise Command helper is like CommandContext but without
    the need to supply an explicit Context.
    
    Updates #50436.
    
    Change-Id: Ifd81fb86c402f034063c9e9c03045b4106eab81a
    Reviewed-on: https://go-review.googlesource.com/c/go/+/445596
    Run-TryBot: Bryan Mills <bcmills@google.com>
    Reviewed-by: Austin Clements <austin@google.com>
    Auto-Submit: Bryan Mills <bcmills@google.com>
    TryBot-Result: Gopher Robot <gobot@golang.org>
    Reviewed-by: Ian Lance Taylor <iant@google.com>

 src/internal/testenv/testenv.go | 98 +++++++++++++++++++++++++++++++++++++++++
 1 file changed, 98 insertions(+)
