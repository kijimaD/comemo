commit 961f456a1dbf6c86c033f8c9205766d3bbf228a1
Author: Russ Cox <rsc@golang.org>
Date:   Fri Jul 31 13:07:41 2015 -0400

    cmd/go: document and fix 'go build -o' semantics
    
    Quoting the new docs:
    
    «
    If the arguments to build are a list of .go files, build treats
    them as a list of source files specifying a single package.
    
    When compiling a single main package, build writes
    the resulting executable to an output file named after
    the first source file ('go build ed.go rx.go' writes 'ed' or 'ed.exe')
    or the source code directory ('go build unix/sam' writes 'sam' or 'sam.exe').
    The '.exe' suffix is added when writing a Windows executable.
    
    When compiling multiple packages or a single non-main package,
    build compiles the packages but discards the resulting object,
    serving only as a check that the packages can be built.
    
    The -o flag, only allowed when compiling a single package,
    forces build to write the resulting executable or object
    to the named output file, instead of the default behavior described
    in the last two paragraphs.
    »
    
    There is a change in behavior here, namely that 'go build -o x.a x.go'
    where x.go is not a command (not package main) did not write any
    output files (back to at least Go 1.2) but now writes x.a.
    This seems more reasonable than trying to explain that -o is
    sometimes silently ignored.
    
    Otherwise the behavior is unchanged.
    
    The lines being deleted in goFilesPackage look like they are
    setting up 'go build x.o' to write 'x.a', but they were overridden
    by the p.target = "" in runBuild. Again back to at least Go 1.2,
    'go build x.go' for a non-main package has never produced
    output. It seems better to keep it that way than to change it,
    both for historical consistency and for consistency with
    'go build strings' and 'go build std'.
    
    All of this behavior is now tested.
    
    Fixes #10865.
    
    Change-Id: Iccdf21f366fbc8b5ae600a1e50dfe7fc3bff8b1c
    Reviewed-on: https://go-review.googlesource.com/13024
    Reviewed-by: Ian Lance Taylor <iant@golang.org>
    Reviewed-by: Dave Day <djd@golang.org>

 src/cmd/go/alldocs.go | 22 +++++++-------
 src/cmd/go/build.go   | 58 ++++++++++++++++++++++--------------
 src/cmd/go/go_test.go | 81 +++++++++++++++++++++++++++++++++++++++++++++++++++
 3 files changed, 129 insertions(+), 32 deletions(-)
