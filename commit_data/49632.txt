commit ea51e223c28babc530df475497de0be4579b5e86
Author: Michael Munday <mike.munday@lowrisc.org>
Date:   Wed Feb 17 15:00:34 2021 +0000

    cmd/{asm,compile}: add fused multiply-add support on riscv64
    
    Add support to the assembler for F[N]M{ADD,SUB}[SD] instructions.
    Argument order is:
    
      OP RS1, RS2, RS3, RD
    
    Also, add support for the FMA intrinsic to the compiler. Automatic
    FMA matching is left to a future CL.
    
    Change-Id: I47166c7393b2ab6bfc2e42aa8c1a8997c3a071b3
    Reviewed-on: https://go-review.googlesource.com/c/go/+/293030
    Trust: Michael Munday <mike.munday@lowrisc.org>
    Run-TryBot: Michael Munday <mike.munday@lowrisc.org>
    TryBot-Result: Go Bot <gobot@golang.org>
    Reviewed-by: Joel Sing <joel@sing.id.au>

 src/cmd/asm/internal/asm/asm.go                |   7 +
 src/cmd/asm/internal/asm/testdata/riscv64.s    |   8 ++
 src/cmd/compile/internal/riscv64/ssa.go        |  13 +-
 src/cmd/compile/internal/ssa/gen/RISCV64.rules |  15 ++
 src/cmd/compile/internal/ssa/gen/RISCV64Ops.go |   5 +
 src/cmd/compile/internal/ssa/opGen.go          |  68 +++++++++
 src/cmd/compile/internal/ssa/rewriteRISCV64.go | 191 +++++++++++++++++++++++++
 src/cmd/compile/internal/ssagen/ssa.go         |   2 +-
 src/cmd/internal/obj/riscv/obj.go              | 104 +++++++++++---
 test/codegen/math.go                           |  16 +++
 10 files changed, 406 insertions(+), 23 deletions(-)
