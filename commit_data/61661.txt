commit 7e1af3bf741862deb91f048a92e91d3b31301f90
Author: Filippo Valsorda <filippo@golang.org>
Date:   Sun Nov 17 18:38:29 2024 +0100

    crypto/internal/fips: handle the one possible PCT failure
    
    Since ECDSA private keys are irredeemably malleable, an application
    could construct one where the public key doesn't match the private key.
    They'd be very much on their own, but crashing the program feels a bit
    harsh.
    
    Add this one to the list of issues caused by exposing the ECDSA (and
    RSA) key values as big.Ints.
    
    For #69536
    
    Change-Id: Iaa65c73d7145e74f860ca097fa9641448442fbf9
    Reviewed-on: https://go-review.googlesource.com/c/go/+/628855
    Auto-Submit: Filippo Valsorda <filippo@golang.org>
    Reviewed-by: Russ Cox <rsc@golang.org>
    Reviewed-by: Dmitri Shuralyov <dmitshur@google.com>
    LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>

 src/crypto/internal/fips/cast.go            | 54 +++++++++++++++++++++--------
 src/crypto/internal/fips/ecdh/ecdh.go       |  6 ++--
 src/crypto/internal/fips/ecdsa/cast.go      | 14 ++++----
 src/crypto/internal/fips/ecdsa/ecdsa.go     | 11 ++++--
 src/crypto/internal/fips/mlkem/mlkem1024.go | 10 ++++--
 src/crypto/internal/fips/mlkem/mlkem768.go  | 10 ++++--
 src/crypto/internal/fipstest/cast_test.go   | 11 +++---
 7 files changed, 81 insertions(+), 35 deletions(-)
