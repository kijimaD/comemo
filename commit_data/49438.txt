commit 432158b69a50e292b625d08dcfacd0604acbabd3
Author: Damien Neil <dneil@google.com>
Date:   Tue Jun 7 16:53:53 2022 -0700

    net: fix testHookDialTCP race
    
    CL 410754 introduces a race accessing the global testHookDialTCP hook.
    Avoiding this race is difficult, since Dial can return while
    goroutines it starts are still running. Add a version of this
    hook to sysDialer, so it can be set on a per-test basis.
    
    (Perhaps other uses of this hook should be moved to use the
    sysDialer-local hook, but this change fixes the immediate data race.)
    
    For #52173.
    
    Change-Id: I8fb9be13957e91f92919cae7be213c38ad2af75a
    Reviewed-on: https://go-review.googlesource.com/c/go/+/410957
    Run-TryBot: Damien Neil <dneil@google.com>
    Reviewed-by: Ian Lance Taylor <iant@golang.org>
    Reviewed-by: Cherry Mui <cherryyz@google.com>
    TryBot-Result: Gopher Robot <gobot@golang.org>

 src/net/dial.go          |  1 +
 src/net/dial_test.go     | 11 +++++------
 src/net/tcpsock_plan9.go |  7 +++++--
 src/net/tcpsock_posix.go |  7 +++++--
 4 files changed, 16 insertions(+), 10 deletions(-)
