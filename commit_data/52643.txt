commit c38d122fd4df8481a5b57a696945d65b7d4fc28e
Author: Bryan C. Mills <bcmills@google.com>
Date:   Thu Apr 13 03:19:20 2023 +0000

    cmd/internal/moddeps: preserve PWD more carefully in commands
    
    On macOS, TMPDIR is typically a symlink, and the GOROOT for the
    buildlet is in TMPDIR as well. PWD must be preserved in order for
    os.Getwd (and functions based on it) to report paths that remain
    relative to GOROOT, and paths relative to GOROOT are necessary in
    order for filepath.Rel to report subdirectories as subdirectories
    (rather than paths with long "../../â€¦" prefixes).
    
    Fortunately, the (*Cmd).Environ method added for #50599 makes
    preserving PWD somewhat easier.
    
    This fixes 'go test cmd/internal/moddeps' on the new
    darwin-amd64-longtest builder.
    
    For #35678.
    
    Change-Id: Ibaa458bc9a94b44ba455519bb8da445af07fe0d2
    Reviewed-on: https://go-review.googlesource.com/c/go/+/484295
    Auto-Submit: Bryan Mills <bcmills@google.com>
    Reviewed-by: Dmitri Shuralyov <dmitshur@golang.org>
    Run-TryBot: Bryan Mills <bcmills@google.com>
    TryBot-Result: Gopher Robot <gobot@golang.org>
    Reviewed-by: Michael Pratt <mpratt@google.com>

 src/cmd/internal/moddeps/moddeps_test.go | 25 +++++++++++++++++++------
 1 file changed, 19 insertions(+), 6 deletions(-)
