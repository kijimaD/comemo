commit fe23ba4a145ce8465d16ea2a92b9a7e96e15c28e
Author: Matthew Dempsky <mdempsky@google.com>
Date:   Mon Jul 27 16:19:15 2020 -0700

    runtime: eliminate scase.kind field
    
    Currently, we include a "kind" field on scase to distinguish the three
    kinds of cases in a select statement: sends, receives, and defaults.
    
    This commit removes by kind field by instead arranging for the
    compiler to always place sends before receives, and to provide their
    counts separately. It also passes an explicit "block bool" parameter
    to avoid needing to include a default case in the array.
    
    It's safe to shuffle cases like this because the runtime will
    randomize the order they're polled in anyway.
    
    Fixes #40410.
    
    Change-Id: Iaeaed4cf7bddd576d78f2c863bd91a03a5c82df2
    Reviewed-on: https://go-review.googlesource.com/c/go/+/245125
    Reviewed-by: Keith Randall <khr@golang.org>

 src/cmd/compile/internal/gc/builtin.go         |   2 +-
 src/cmd/compile/internal/gc/builtin/runtime.go |   2 +-
 src/cmd/compile/internal/gc/select.go          | 108 +++++++++++++------------
 src/reflect/all_test.go                        |   8 ++
 src/runtime/select.go                          | 104 +++++++++++++-----------
 5 files changed, 123 insertions(+), 101 deletions(-)
