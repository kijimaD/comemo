commit 5930c7de933c4d826926396f715bae63333143a2
Author: Andrei Vagin <avagin@google.com>
Date:   Mon Jan 7 10:18:42 2019 -0800

    syscall: add all ambient capabilities into permitted and inheritable sets
    
    According to the prctl man page, each capability from the ambient set
    must already be present in both  the  permitted  and  the  inheritable
    sets  of the process.
    
    exec_linux_test suggests configuring the capabilities in the parent
    process. This doesn't look nice, because:
    * Capabilities are a per-thread attribute, so we need to use
    LockOSThread.
    * Need to restore capabilities after creating a process.
    * Doesn't work with user namespaces, because a process gets capabilities
    when a namespace is created.
    
    Fixes #23152
    
    Change-Id: Iba23e530fc7b9f5182d602fe855f82218f354219
    Reviewed-on: https://go-review.googlesource.com/c/go/+/156577
    Run-TryBot: Tobias Klauser <tobias.klauser@gmail.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Ian Lance Taylor <iant@golang.org>

 src/syscall/exec_linux.go      | 51 +++++++++++++++++++++++++++++++++++---
 src/syscall/exec_linux_test.go | 56 +++++++++++++++++++++++++++++-------------
 2 files changed, 87 insertions(+), 20 deletions(-)
