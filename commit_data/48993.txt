commit 5a103ca5e9e67414f5307b3993c1c34e531b26a8
Author: Keith Randall <khr@golang.org>
Date:   Tue May 3 10:40:34 2022 -0700

    cmd/compile: fix bit length intrinsic for 16/8 bits on GOAMD64=v3
    
    Upper bits of registers for uint8/uint16 are junk. Make sure we
    mask those off before using LZCNT (leading zeros count).
    
    Fixes #52681
    
    Change-Id: I0ca9e62f23bcb1f6ad2a787fa9895322afaa2533
    Reviewed-on: https://go-review.googlesource.com/c/go/+/403815
    TryBot-Result: Gopher Robot <gobot@golang.org>
    Reviewed-by: Cherry Mui <cherryyz@google.com>
    Reviewed-by: Keith Randall <khr@google.com>
    Run-TryBot: Keith Randall <khr@golang.org>
    Auto-Submit: Keith Randall <khr@google.com>

 src/cmd/compile/internal/ssa/gen/AMD64.rules     |  4 +-
 src/cmd/compile/internal/ssa/rewriteAMD64.go     | 12 +++--
 src/cmd/compile/internal/test/intrinsics_test.go | 62 ++++++++++++++++++++++++
 3 files changed, 73 insertions(+), 5 deletions(-)
