commit f687831e4cfa06d19533d47ae93c0451bd1ca688
Author: zhouguangyuan <zhouguangyuan.xian@gmail.com>
Date:   Thu Sep 16 02:10:17 2021 +0800

    cmd/link: disable weak reference in itab if build with "-linkshared"
    
    When build with "-linkshared", we can't tell if the interface method will be used or not. It can be used in shared library.
    
    Fixes #47873
    
    Change-Id: Iba12812f199b7679cf2fd41a304268d6d6dd03c6
    Reviewed-on: https://go-review.googlesource.com/c/go/+/350189
    Reviewed-by: Cherry Mui <cherryyz@google.com>
    Run-TryBot: Cherry Mui <cherryyz@google.com>
    TryBot-Result: Go Bot <gobot@golang.org>
    Trust: Alexander Rakoczy <alex@golang.org>

 misc/cgo/testshared/shared_test.go                   |  8 ++++++++
 misc/cgo/testshared/testdata/issue47837/a/a.go       | 19 +++++++++++++++++++
 misc/cgo/testshared/testdata/issue47837/main/main.go | 14 ++++++++++++++
 src/cmd/link/internal/ld/deadcode.go                 |  4 +++-
 4 files changed, 44 insertions(+), 1 deletion(-)
