commit 21b2ce724aa1310b3efb2f722d4a647be770e835
Author: Dmitriy Vyukov <dvyukov@google.com>
Date:   Wed Oct 10 18:09:23 2012 +0400

    cmd/gc: fix compiler crash during race instrumentation
    The compiler is crashing on the following code:
    
    type TypeID int
    func (t *TypeID) encodeType(x int) (tt TypeID, err error) {
            switch x {
            case 0:
                    return t.encodeType(x * x)
            }
            return 0, nil
    }
    The pass marks "return struct" {tt TypeID, err error} as used,
    and this causes internal check failure.
    I've added the test to:
    https://golang.org/cl/6525052/diff/7020/src/pkg/runtime/race/regression_test.go
    
    R=golang-dev, minux.ma, rsc
    CC=golang-dev
    https://golang.org/cl/6611049

 src/cmd/gc/racewalk.c | 34 +++++++++++++++++++++-------------
 1 file changed, 21 insertions(+), 13 deletions(-)
