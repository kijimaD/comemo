commit f9a95b1bdcff42730c836a792b27740b9c0df645
Author: Austin Clements <austin@google.com>
Date:   Tue Oct 17 17:27:00 2023 -0400

    cmd/go: print build errors during go test -json in JSON
    
    Currently, if a test or imported package fails to build during "go
    test -json", the build error text will be interleaved with the JSON
    output of tests. Furthermore, thereâ€™s currently no way to reliably
    associate a build error with the test package or packages it affected.
    This creates unnecessary friction and complexity in tools that consume
    the "go test -json" output.
    
    This CL makes "go test -json" enable JSON reporting of build errors.
    It also adds a "FailedBuild" field to the "fail" TestEvent, which
    gives the package ID of the package that failed to build and caused
    the test to fail.
    
    Using this, CI systems should be able to consume the entire output
    stream from "go test -json" in a structured way and easily associate
    build failures with test failures during reporting.
    
    Fixes #62067.
    Updates #35169.
    Updates #37486.
    
    Change-Id: I49091dcc7aa52db01fc9fa6042771633e97b8407
    Reviewed-on: https://go-review.googlesource.com/c/go/+/536399
    Reviewed-by: Russ Cox <rsc@golang.org>
    LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>

 doc/next/3-tools.md                            |  6 ++
 src/cmd/go/alldocs.go                          | 16 ++++-
 src/cmd/go/internal/help/helpdoc.go            | 15 ++++-
 src/cmd/go/internal/list/list.go               |  8 +--
 src/cmd/go/internal/load/test.go               | 11 ++--
 src/cmd/go/internal/test/test.go               | 42 ++++++++-----
 src/cmd/go/internal/test/testflag.go           |  3 +
 src/cmd/go/internal/vet/vet.go                 |  6 +-
 src/cmd/go/testdata/script/test_json_build.txt | 81 ++++++++++++++++++++++++++
 src/cmd/internal/test2json/test2json.go        | 27 +++++++--
 src/cmd/test2json/main.go                      | 18 ++++--
 11 files changed, 190 insertions(+), 43 deletions(-)
