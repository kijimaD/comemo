commit 4caa1276a1a184edf0ba8027619ecfe71e8c0804
Author: Filippo Valsorda <filippo@golang.org>
Date:   Thu Nov 1 01:01:09 2018 -0400

    crypto/tls: implement TLS 1.3 client handshake (base)
    
    Implement a basic TLS 1.3 client handshake, only enabled if explicitly
    requested with MaxVersion.
    
    This CL intentionally leaves for future CLs:
      - PSK modes and resumption
      - client authentication
      - post-handshake messages
      - downgrade protection
      - KeyLogWriter support
    
    Updates #9671
    
    Change-Id: Ieb6130fb6f25aea4f0d39e3a2448dfc942e1de7a
    Reviewed-on: https://go-review.googlesource.com/c/146559
    Run-TryBot: Filippo Valsorda <filippo@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Adam Langley <agl@golang.org>

 src/crypto/tls/alert.go                            |   4 +
 src/crypto/tls/auth.go                             |  28 +-
 src/crypto/tls/cipher_suites.go                    |  14 +
 src/crypto/tls/common.go                           |  32 +-
 src/crypto/tls/conn.go                             |  19 +-
 src/crypto/tls/handshake_client.go                 | 345 +++++++++-------
 src/crypto/tls/handshake_client_test.go            | 149 +++++--
 src/crypto/tls/handshake_client_tls13.go           | 443 +++++++++++++++++++++
 src/crypto/tls/handshake_messages.go               |   6 +-
 src/crypto/tls/handshake_server_test.go            |  46 ++-
 src/crypto/tls/key_agreement.go                    | 176 +++-----
 src/crypto/tls/key_schedule.go                     | 104 +++++
 src/crypto/tls/prf.go                              |   5 +-
 src/crypto/tls/testdata/Client-TLSv12-P256-ECDHE   |  93 +++++
 ...CDHE-RSA-AES-GCM => Client-TLSv12-X25519-ECDHE} |   0
 .../tls/testdata/Client-TLSv13-AES128-SHA256       |  89 +++++
 .../tls/testdata/Client-TLSv13-AES256-SHA384       |  91 +++++
 src/crypto/tls/testdata/Client-TLSv13-ALPN         |  92 +++++
 .../tls/testdata/Client-TLSv13-CHACHA20-SHA256     |  89 +++++
 src/crypto/tls/testdata/Client-TLSv13-ECDSA        |  85 ++++
 .../testdata/Client-TLSv13-ExportKeyingMaterial    |  89 +++++
 .../tls/testdata/Client-TLSv13-HelloRetryRequest   | 118 ++++++
 src/crypto/tls/testdata/Client-TLSv13-P256-ECDHE   |  93 +++++
 .../testdata/Client-TLSv13-RenegotiationRejected   | 107 +++++
 src/crypto/tls/testdata/Client-TLSv13-X25519-ECDHE |  89 +++++
 25 files changed, 2059 insertions(+), 347 deletions(-)
