commit f2311462ab6f2359006f42b7febd19ce95a9bbcf
Author: Matthew Dempsky <mdempsky@google.com>
Date:   Tue Dec 1 01:01:59 2020 -0800

    [dev.regabi] cmd/compile: cleanup type-checking of defined types
    
    The code for type-checking defined types was scattered between
    typecheckdef, typecheckdeftype, and setUnderlying. There was redundant
    work between them, and setUnderlying also needed to redo a lot of work
    because of its brute-force solution of just copying all Type fields.
    
    This CL reorders things so as many of the defined type's fields are
    set in advance (in typecheckdeftype), and then setUnderlying only
    copies over the details actually needed from the underlying type.
    
    Incidentally, this evidently improves our error handling for an
    existing test case, by allowing us to report an additional error.
    
    Passes toolstash/buildall.
    
    Change-Id: Id59a24341e7e960edd1f7366c3e2356da91b9fe7
    Reviewed-on: https://go-review.googlesource.com/c/go/+/274432
    Trust: Matthew Dempsky <mdempsky@google.com>
    Run-TryBot: Matthew Dempsky <mdempsky@google.com>
    TryBot-Result: Go Bot <gobot@golang.org>
    Reviewed-by: Russ Cox <rsc@golang.org>

 src/cmd/compile/internal/gc/typecheck.go | 78 +++++++++++++++-----------------
 test/fixedbugs/issue28079b.go            |  2 +-
 2 files changed, 38 insertions(+), 42 deletions(-)
