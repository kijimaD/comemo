commit f04f4c24e36440226baaa181abb1754f8b0f0b41
Author: Filippo Valsorda <filippo@golang.org>
Date:   Fri Sep 20 18:06:54 2024 +0200

    crypto/sha256,crypto/sha512: test fallback implementations
    
    This will be required for #69536 but is also good hygiene and required
    by go.dev/wiki/AssemblyPolicy.
    
    > The code must be tested in our CI. This means there need to be
    > builders that support the instructions, and if there are multiple (or
    > fallback) paths they must be tested separately.
    
    The new crypto/internal/impl registry lets us select alternative
    implementations from both the same package and importers (such as
    crypto/sha256 tests once we have crypto/internal/fips/sha256, or
    crypto/hmac).
    
    Updates #69592
    Updates #69593
    
    Change-Id: Ifea22a9fc9ccffcaf4924ff6bd08da7c9bd39e99
    Cq-Include-Trybots: luci.golang.try:gotip-linux-arm64-longtest,gotip-linux-amd64-longtest,gotip-linux-ppc64le_power8,gotip-linux-ppc64_power8
    Reviewed-on: https://go-review.googlesource.com/c/go/+/614656
    LUCI-TryBot-Result: Go LUCI <golang-scoped@luci-project-accounts.iam.gserviceaccount.com>
    Reviewed-by: Daniel McCarney <daniel@binaryparadox.net>
    Reviewed-by: Michael Pratt <mpratt@google.com>
    Reviewed-by: Roland Shoemaker <roland@golang.org>
    Auto-Submit: Filippo Valsorda <filippo@golang.org>

 src/crypto/internal/cryptotest/implementations.go | 56 +++++++++++++++
 src/crypto/internal/impl/impl.go                  | 88 +++++++++++++++++++++++
 src/crypto/sha256/sha256_test.go                  | 40 +++++------
 src/crypto/sha256/sha256block_amd64.go            | 17 +++--
 src/crypto/sha256/sha256block_arm64.go            | 13 +++-
 src/crypto/sha256/sha256block_ppc64x.go           |  9 ++-
 src/crypto/sha256/sha256block_s390x.go            | 15 +++-
 src/crypto/sha512/sha512_test.go                  | 46 ++++++------
 src/crypto/sha512/sha512block_amd64.go            | 13 +++-
 src/crypto/sha512/sha512block_arm64.go            | 13 +++-
 src/crypto/sha512/sha512block_ppc64x.go           |  9 ++-
 src/crypto/sha512/sha512block_s390x.go            | 15 +++-
 src/go/build/deps_test.go                         |  5 +-
 13 files changed, 276 insertions(+), 63 deletions(-)
