commit 8c46cb1bf534adb169a8789489e85bf777655066
Author: Cherry Zhang <cherryyz@google.com>
Date:   Sat Jul 4 18:14:08 2020 -0400

    [dev.link] cmd/link: write ELF relocations in mmap on all architectures
    
    In CL 240399 we changed to precompute the size for ELF relocation
    records and use mmap to write them, but we left architectures
    where elfreloc1 write non-fixed number of bytes. This CL handles
    those architectures. When a Go relocation will turn into multiple
    ELF relocations, in relocsym we account this difference and add
    it to the size calculation. So when emitting ELF relocations, we
    know the number of ELF relocations to be emitted.
    
    Change-Id: I6732ab674b442f4618405e5412a77f6e4a3315d7
    Reviewed-on: https://go-review.googlesource.com/c/go/+/241079
    Reviewed-by: Than McIntosh <thanm@google.com>
    Reviewed-by: Jeremy Faller <jeremy@golang.org>

 src/cmd/link/internal/amd64/asm.go   |  4 +--
 src/cmd/link/internal/arm/asm.go     | 10 ++++----
 src/cmd/link/internal/arm64/asm.go   | 48 ++++++++++++++++++++----------------
 src/cmd/link/internal/arm64/obj.go   |  1 +
 src/cmd/link/internal/ld/data.go     | 28 ++++++++++++++++-----
 src/cmd/link/internal/ld/elf.go      | 42 ++++++++++++++-----------------
 src/cmd/link/internal/ld/lib.go      | 11 +++++----
 src/cmd/link/internal/mips/asm.go    | 12 ++++-----
 src/cmd/link/internal/mips64/asm.go  | 12 ++++-----
 src/cmd/link/internal/ppc64/asm.go   | 34 +++++++++++++------------
 src/cmd/link/internal/ppc64/obj.go   |  1 +
 src/cmd/link/internal/riscv64/asm.go |  8 +++---
 src/cmd/link/internal/s390x/asm.go   |  4 +--
 src/cmd/link/internal/x86/asm.go     |  4 +--
 src/cmd/link/internal/x86/obj.go     |  1 +
 15 files changed, 121 insertions(+), 99 deletions(-)
