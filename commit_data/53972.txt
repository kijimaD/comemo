commit 33cdafed5213a17d23baa92568ede4bb16e7af0c
Author: Michael Matloob <matloob@golang.org>
Date:   Wed Jul 26 14:09:06 2023 -0400

    cmd/go: enter vendor mode depending on new modules.txt workspace line
    
    modules.txt gets a new ## workspace line at the start of the file if
    it's generated in workspace mode. Then, when deciding whether the go
    command runs in mod=vendor, we only do so if we're in the same mode
    (workspace or not) as the modules.txt specifies.
    
    For #60056
    
    Change-Id: If478a9891a7135614326fcb80c4c33a431e4e531
    Reviewed-on: https://go-review.googlesource.com/c/go/+/513756
    TryBot-Result: Gopher Robot <gobot@golang.org>
    Reviewed-by: Bryan Mills <bcmills@google.com>
    Run-TryBot: Bryan Mills <bcmills@google.com>

 src/cmd/go/internal/modcmd/vendor.go               |  4 ++
 src/cmd/go/internal/modload/init.go                | 64 ++++++++++++++++++----
 .../script/work_vendor_modules_txt_conditional.txt | 62 +++++++++++++++++++++
 .../script/work_vendor_modules_txt_consistent.txt  |  6 ++
 src/cmd/go/testdata/script/work_vendor_prune.txt   |  1 +
 .../go/testdata/script/work_vendor_prune_all.txt   |  1 +
 6 files changed, 128 insertions(+), 10 deletions(-)
