commit 1d10b17589ce651caeb0841b2312065ee44f800d
Author: Elias Naur <mail@eliasnaur.com>
Date:   Thu Mar 28 13:11:53 2019 +0100

    cmd/link/ld,cmd/internal/obj,runtime: make the Android TLS offset dynamic
    
    We're going to need a different TLS offset for Android Q, so the static
    offsets used for 386 and amd64 are no longer viable on Android.
    
    Introduce runtimeÂ·tls_g and use that for indexing into TLS storage. As
    an added benefit, we can then merge the TLS setup code for all android
    GOARCHs.
    
    While we're at it, remove a bunch of android special cases no longer
    needed.
    
    Updates #29674
    Updates #29249 (perhaps fixes it)
    
    Change-Id: I77c7385aec7de8f1f6a4da7c9c79999157e39572
    Reviewed-on: https://go-review.googlesource.com/c/go/+/169817
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Cherry Zhang <cherryyz@google.com>

 src/cmd/internal/obj/x86/obj6.go    | 22 ++++++++----
 src/cmd/link/internal/ld/data.go    | 10 ++----
 src/cmd/link/internal/ld/sym.go     | 17 ++-------
 src/runtime/asm_386.s               | 17 +++++++--
 src/runtime/asm_amd64.s             | 23 ++++++++++--
 src/runtime/cgo/gcc_android.c       | 35 ++++++++++++++++++
 src/runtime/cgo/gcc_android_386.c   | 67 ----------------------------------
 src/runtime/cgo/gcc_android_amd64.c | 72 -------------------------------------
 src/runtime/cgo/gcc_android_arm.c   | 42 ----------------------
 src/runtime/cgo/gcc_android_arm64.c | 42 ----------------------
 src/runtime/cgo/gcc_linux_386.c     |  8 ++---
 src/runtime/cgo/gcc_linux_amd64.c   |  8 ++---
 src/runtime/sys_linux_386.s         |  8 ++---
 src/runtime/sys_linux_amd64.s       |  6 ++--
 14 files changed, 102 insertions(+), 275 deletions(-)
