commit 30172f1811a3e08487c6191d1923f8608a338496
Author: Austin Clements <austin@google.com>
Date:   Wed Apr 27 14:30:01 2016 -0400

    runtime: make {add,subtract}{b,1} nosplit
    
    These are used at the bottom level of various GC operations that must
    not be preempted. To be on the safe side, mark them all nosplit.
    
    Change-Id: I8f7360e79c9852bd044df71413b8581ad764380c
    Reviewed-on: https://go-review.googlesource.com/22504
    Run-TryBot: Austin Clements <austin@google.com>
    Reviewed-by: Rick Hudson <rlh@golang.org>
---
 src/runtime/mbitmap.go | 3 +++
 1 file changed, 3 insertions(+)

diff --git a/src/runtime/mbitmap.go b/src/runtime/mbitmap.go
index f025ce1c68..e8eb6a7e22 100644
--- a/src/runtime/mbitmap.go
+++ b/src/runtime/mbitmap.go
@@ -86,6 +86,7 @@ const (
 
 // addb returns the byte pointer p+n.
 //go:nowritebarrier
+//go:nosplit
 func addb(p *byte, n uintptr) *byte {
 	// Note: wrote out full expression instead of calling add(p, n)
 	// to reduce the number of temporaries generated by the
@@ -95,6 +96,7 @@ func addb(p *byte, n uintptr) *byte {
 
 // subtractb returns the byte pointer p-n.
 //go:nowritebarrier
+//go:nosplit
 func subtractb(p *byte, n uintptr) *byte {
 	// Note: wrote out full expression instead of calling add(p, -n)
 	// to reduce the number of temporaries generated by the
@@ -104,6 +106,7 @@ func subtractb(p *byte, n uintptr) *byte {
 
 // add1 returns the byte pointer p+1.
 //go:nowritebarrier
+//go:nosplit
 func add1(p *byte) *byte {
 	// Note: wrote out full expression instead of calling addb(p, 1)
 	// to reduce the number of temporaries generated by the
