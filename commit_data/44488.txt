commit 526d99a49ae67bfde15134b96159680988615d2d
Author: Cherry Zhang <cherryyz@google.com>
Date:   Wed Jul 15 23:14:50 2020 -0400

    [dev.link] cmd/internal/obj: handle content-addressable symbols with relocations
    
    For content-addressable symbols with relocations, we build a
    content hash based on its content and relocations. Depending on
    the category of the referenced symbol, we choose different hash
    algorithms such that the hash is globally consistent.
    
    For now, we only support content-addressable symbols with
    relocations when the current package's import path is known, so
    that the symbol names are fully expanded. Otherwise, if the
    referenced symbol is a named symbol whose name is not fully
    expanded, the hash won't be globally consistent, and can cause
    erroneous collisions. This is fine for now, as the deduplication
    is just an optimization, not a requirement for correctness (until
    we get to type descriptors).
    
    Change-Id: I639e4e03dd749b5d71f0a55c2525926575b1ac30
    Reviewed-on: https://go-review.googlesource.com/c/go/+/243142
    Run-TryBot: Cherry Zhang <cherryyz@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Jeremy Faller <jeremy@golang.org>

 src/cmd/asm/main.go                  |  3 +-
 src/cmd/compile/internal/gc/main.go  |  1 +
 src/cmd/compile/internal/gc/obj.go   |  2 +-
 src/cmd/internal/obj/link.go         |  1 +
 src/cmd/internal/obj/objfile2.go     | 77 ++++++++++++++++++++++++++++---
 src/cmd/internal/obj/objfile_test.go | 87 ++++++++++++++++++++++++++++++++++++
 src/cmd/internal/obj/sym.go          |  6 ++-
 7 files changed, 166 insertions(+), 11 deletions(-)
