commit 24a088d20ad52c527f61b34217da72589e366833
Author: Rob Pike <r@golang.org>
Date:   Tue Nov 8 15:43:20 2016 -0800

    text/template: efficient reporting of line numbers
    
    Instead of scanning the text to count newlines, which is nÂ², keep track as we go
    and store the line number in the token.
    
    benchmark                 old ns/op      new ns/op     delta
    BenchmarkParseLarge-4     1589721293     38783310      -97.56%
    
    Fixes #17851
    
    Change-Id: I231225c61e667535e2ce55cd2facea6d279cc59d
    Reviewed-on: https://go-review.googlesource.com/33234
    Run-TryBot: Rob Pike <r@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

 src/text/template/exec_test.go        |   2 +-
 src/text/template/parse/lex.go        |  36 +++--
 src/text/template/parse/lex_test.go   | 259 +++++++++++++++++-----------------
 src/text/template/parse/parse.go      |  22 +--
 src/text/template/parse/parse_test.go |  34 +++++
 5 files changed, 204 insertions(+), 149 deletions(-)
