commit 779ef7bd132ae4971f07baf2df8eec508a45f60c
Author: Adam Langley <agl@golang.org>
Date:   Thu Jan 9 13:38:11 2014 -0500

    crypto/tls: support renegotiation extension.
    
    The renegotiation extension was introduced[1] due to an attack by Ray in
    which a client's handshake was spliced into a connection that was
    renegotiating, thus giving an attacker the ability to inject an
    arbitary prefix into the connection.
    
    Go has never supported renegotiation as a server and so this attack
    doesn't apply. As a client, it's possible that at some point in the
    future the population of servers will be sufficiently updated that
    it'll be possible to reject connections where the server hasn't
    demonstrated that it has been updated to address this problem.
    
    We're not at that point yet, but it's good for Go servers to support
    the extension so that it might be possible to do in the future.
    
    [1] https://tools.ietf.org/search/rfc5746
    
    R=golang-codereviews, mikioh.mikioh
    CC=golang-codereviews
    https://golang.org/cl/48580043

 src/pkg/crypto/tls/common.go                       |  12 +-
 src/pkg/crypto/tls/handshake_client.go             |  17 +-
 src/pkg/crypto/tls/handshake_messages.go           |  97 +++++++----
 src/pkg/crypto/tls/handshake_server.go             |   1 +
 src/pkg/crypto/tls/handshake_server_test.go        |   4 +-
 .../testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA  | 148 ++++++++--------
 .../testdata/Client-TLSv10-ClientCert-ECDSA-RSA    | 132 +++++++-------
 .../testdata/Client-TLSv10-ClientCert-RSA-ECDSA    | 162 ++++++++---------
 .../tls/testdata/Client-TLSv10-ClientCert-RSA-RSA  | 146 ++++++++--------
 .../tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES     | 143 +++++++--------
 .../tls/testdata/Client-TLSv10-ECDHE-RSA-AES       | 164 +++++++++---------
 src/pkg/crypto/tls/testdata/Client-TLSv10-RSA-RC4  | 127 +++++++-------
 .../tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES     | 143 +++++++--------
 .../tls/testdata/Client-TLSv11-ECDHE-RSA-AES       | 164 +++++++++---------
 src/pkg/crypto/tls/testdata/Client-TLSv11-RSA-RC4  | 127 +++++++-------
 .../testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA  | 155 ++++++++---------
 .../testdata/Client-TLSv12-ClientCert-ECDSA-RSA    | 136 +++++++--------
 .../testdata/Client-TLSv12-ClientCert-RSA-ECDSA    | 167 +++++++++---------
 .../tls/testdata/Client-TLSv12-ClientCert-RSA-RSA  | 150 ++++++++--------
 .../tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES     | 144 ++++++++--------
 .../tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM | 138 +++++++--------
 .../tls/testdata/Client-TLSv12-ECDHE-RSA-AES       | 164 +++++++++---------
 src/pkg/crypto/tls/testdata/Client-TLSv12-RSA-RC4  | 127 +++++++-------
 src/pkg/crypto/tls/testdata/Server-SSLv3-RSA-3DES  | 155 ++++++++---------
 src/pkg/crypto/tls/testdata/Server-SSLv3-RSA-AES   | 157 ++++++++---------
 src/pkg/crypto/tls/testdata/Server-SSLv3-RSA-RC4   | 147 ++++++++--------
 .../tls/testdata/Server-TLSv10-ECDHE-ECDSA-AES     | 175 +++++++++----------
 src/pkg/crypto/tls/testdata/Server-TLSv10-RSA-3DES | 147 ++++++++--------
 src/pkg/crypto/tls/testdata/Server-TLSv10-RSA-AES  | 153 ++++++++--------
 src/pkg/crypto/tls/testdata/Server-TLSv10-RSA-RC4  | 141 +++++++--------
 src/pkg/crypto/tls/testdata/Server-TLSv11-RSA-RC4  | 141 +++++++--------
 .../Server-TLSv12-CipherSuiteCertPreferenceECDSA   |  81 ++++-----
 .../Server-TLSv12-CipherSuiteCertPreferenceRSA     |  95 +++++-----
 .../Server-TLSv12-ClientAuthRequestedAndECDSAGiven | 168 +++++++++---------
 .../Server-TLSv12-ClientAuthRequestedAndGiven      | 167 +++++++++---------
 .../Server-TLSv12-ClientAuthRequestedNotGiven      | 149 ++++++++--------
 .../tls/testdata/Server-TLSv12-ECDHE-ECDSA-AES     | 179 +++++++++----------
 .../crypto/tls/testdata/Server-TLSv12-IssueTicket  | 158 ++++++++---------
 src/pkg/crypto/tls/testdata/Server-TLSv12-RSA-3DES | 153 ++++++++--------
 src/pkg/crypto/tls/testdata/Server-TLSv12-RSA-AES  | 157 ++++++++---------
 .../crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM  | 192 ++++++++++-----------
 src/pkg/crypto/tls/testdata/Server-TLSv12-RSA-RC4  | 147 ++++++++--------
 src/pkg/crypto/tls/testdata/Server-TLSv12-Resume   |  61 +++----
 src/pkg/crypto/tls/testdata/Server-TLSv12-SNI      | 135 ++++++++-------
 44 files changed, 2941 insertions(+), 2885 deletions(-)
