commit d8ce141dde36c7781a5c43356feb403550cc47ec
Author: Filippo Valsorda <hi@filippo.io>
Date:   Thu Nov 29 01:38:07 2018 -0500

    crypto/tls: fix client certificates support for legacy servers
    
    signatureSchemesForCertificate was written to be used with TLS 1.3, but
    ended up used for TLS 1.2 client certificates in a refactor. Since it
    only supported TLS 1.3 signature algorithms, it would lead to no RSA
    client certificates being sent to servers that didn't support RSA-PSS.
    
    TestHandshakeClientCertRSAPKCS1v15 was testing *specifically* for this,
    but alas the OpenSSL flag -verify accepts an empty certificates list as
    valid, as opposed to -Verify...
    
    Fixes #28925
    
    Change-Id: I61afc02ca501d3d64ab4ad77bbb4cf10931e6f93
    Reviewed-on: https://go-review.googlesource.com/c/151660
    Run-TryBot: Filippo Valsorda <filippo@golang.org>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Adam Langley <agl@golang.org>

 src/crypto/tls/auth.go                             |  27 ++++-
 src/crypto/tls/common.go                           |  13 +--
 src/crypto/tls/handshake_client.go                 |   2 +-
 src/crypto/tls/handshake_client_test.go            |  35 ++++---
 src/crypto/tls/handshake_client_tls13.go           |  15 +--
 src/crypto/tls/handshake_server_test.go            |   9 +-
 src/crypto/tls/handshake_server_tls13.go           |   9 +-
 .../testdata/Client-TLSv10-ClientCert-RSA-ECDSA    | 116 ++++++++++++++-------
 .../tls/testdata/Client-TLSv10-ClientCert-RSA-RSA  | 110 ++++++++++++-------
 .../Client-TLSv12-ClientCert-RSA-RSAPKCS1v15       | 104 ++++++++++++------
 10 files changed, 298 insertions(+), 142 deletions(-)
