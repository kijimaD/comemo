commit cacac8bdc5c93e7bc71df71981fdf32dded017bf
Author: Bryan C. Mills <bcmills@google.com>
Date:   Fri Jun 5 16:08:08 2020 -0400

    cmd/dist: do not unset GOROOT_FINAL prior to running tests
    
    Also do not unset it by default in the tests for cmd/go.
    
    GOROOT_FINAL affects the GOROOT value embedded in binaries,
    such as 'cmd/cgo'. If its value changes and a build command
    is performed that depends on one of those binaries, the binary
    would be spuriously rebuilt.
    
    Instead, only unset it in the specific tests that make assumptions
    about the GOROOT paths embedded in specific compiled binaries.
    That may cause those tests to do a little extra rebuilding when
    GOROOT_FINAL is set, but that little bit of extra rebuilding
    seems preferable to spuriously-stale binaries.
    
    Fixes #39385
    
    Change-Id: I7c87b1519bb5bcff64babf1505fd1033ffa4f4fb
    Reviewed-on: https://go-review.googlesource.com/c/go/+/236819
    Run-TryBot: Bryan C. Mills <bcmills@google.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Dmitri Shuralyov <dmitshur@golang.org>

 src/cmd/addr2line/addr2line_test.go              | 14 +++++++++++---
 src/cmd/dist/test.go                             |  9 ---------
 src/cmd/go/go_test.go                            | 12 +++++++++---
 src/cmd/go/script_test.go                        |  1 +
 src/cmd/go/testdata/script/README                |  1 +
 src/cmd/go/testdata/script/build_trimpath.txt    |  4 ++++
 src/cmd/go/testdata/script/goroot_executable.txt |  7 +++++++
 src/cmd/link/dwarf_test.go                       |  4 ++--
 src/cmd/objdump/objdump_test.go                  |  6 +++++-
 9 files changed, 40 insertions(+), 18 deletions(-)
