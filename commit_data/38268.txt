commit 623650b27aa42dd2ccd20fc4a79f8fe7b8559987
Merge: 36c789b1fd 1961d8d72a
Author: Filippo Valsorda <filippo@golang.org>
Date:   Mon Oct 15 17:09:34 2018 -0400

    [dev.boringcrypto] all: merge master into dev.boringcrypto
    
    Change-Id: I218ba1b89a2df6e4335c6a5846889d9a04affe5d

 api/except.txt                                     |     1 +
 doc/contrib.html                                   |    15 +-
 doc/debugging_with_gdb.html                        |    10 +-
 doc/devel/release.html                             |    11 +
 doc/go1.11.html                                    |    14 +
 doc/go_faq.html                                    |    22 +-
 doc/go_spec.html                                   |    14 +-
 misc/nacl/testzip.proto                            |     2 +
 misc/wasm/wasm_exec.html                           |     5 +
 src/builtin/builtin.go                             |     6 +
 src/bytes/buffer.go                                |    15 +-
 src/bytes/bytes.go                                 |    37 +-
 src/bytes/bytes_test.go                            |     6 +
 src/cmd/asm/internal/asm/testdata/386.s            |     2 +-
 src/cmd/asm/internal/asm/testdata/arm64.s          |     1 +
 src/cmd/asm/internal/asm/testdata/arm64enc.s       |     4 +-
 src/cmd/asm/internal/asm/testdata/arm64error.s     |    36 +-
 src/cmd/asm/internal/asm/testdata/ppc64.s          |     2 +-
 src/cmd/compile/fmt_test.go                        |     1 +
 src/cmd/compile/internal/amd64/ssa.go              |    28 +-
 src/cmd/compile/internal/arm/ssa.go                |    49 +-
 src/cmd/compile/internal/arm64/ssa.go              |    20 +-
 src/cmd/compile/internal/gc/bexport.go             |  1744 -
 src/cmd/compile/internal/gc/bimport.go             |  1323 -
 src/cmd/compile/internal/gc/const.go               |    15 +-
 src/cmd/compile/internal/gc/dump.go                |   287 +
 src/cmd/compile/internal/gc/esc.go                 |   126 +-
 src/cmd/compile/internal/gc/export.go              |    10 +-
 src/cmd/compile/internal/gc/float_test.go          |    14 +-
 src/cmd/compile/internal/gc/fmt.go                 |    45 +-
 src/cmd/compile/internal/gc/inl.go                 |     4 +-
 src/cmd/compile/internal/gc/main.go                |    24 +-
 src/cmd/compile/internal/gc/mpfloat.go             |    45 +-
 src/cmd/compile/internal/gc/mpint.go               |    11 +-
 src/cmd/compile/internal/gc/obj.go                 |     5 +-
 src/cmd/compile/internal/gc/op_string.go           |     4 +-
 src/cmd/compile/internal/gc/order.go               |    12 +-
 src/cmd/compile/internal/gc/pgen.go                |    20 +
 src/cmd/compile/internal/gc/plive.go               |   235 +-
 src/cmd/compile/internal/gc/sinit.go               |    18 +-
 src/cmd/compile/internal/gc/ssa.go                 |    94 +-
 src/cmd/compile/internal/gc/subr.go                |    33 +-
 src/cmd/compile/internal/gc/syntax.go              |     1 +
 src/cmd/compile/internal/gc/typecheck.go           |    49 +-
 src/cmd/compile/internal/gc/walk.go                |     6 +-
 src/cmd/compile/internal/ppc64/ssa.go              |    35 +-
 src/cmd/compile/internal/ssa/gen/386.rules         |    12 +-
 src/cmd/compile/internal/ssa/gen/AMD64.rules       |    84 +-
 src/cmd/compile/internal/ssa/gen/AMD64Ops.go       |    30 +-
 src/cmd/compile/internal/ssa/gen/ARM64.rules       |   202 +-
 src/cmd/compile/internal/ssa/gen/ARM64Ops.go       |    18 +
 src/cmd/compile/internal/ssa/gen/PPC64.rules       |   135 +-
 src/cmd/compile/internal/ssa/gen/PPC64Ops.go       |    30 +
 src/cmd/compile/internal/ssa/gen/Wasm.rules        |     4 +-
 src/cmd/compile/internal/ssa/gen/generic.rules     |   158 +-
 src/cmd/compile/internal/ssa/gen/genericOps.go     |     5 +-
 src/cmd/compile/internal/ssa/gen/main.go           |     9 +-
 src/cmd/compile/internal/ssa/html.go               |     2 +-
 src/cmd/compile/internal/ssa/op.go                 |    12 +-
 src/cmd/compile/internal/ssa/opGen.go              |   884 +-
 src/cmd/compile/internal/ssa/prove.go              |     4 +-
 src/cmd/compile/internal/ssa/regalloc.go           |     2 +
 src/cmd/compile/internal/ssa/rewrite.go            |    40 +-
 src/cmd/compile/internal/ssa/rewrite386.go         |   104 +-
 src/cmd/compile/internal/ssa/rewriteAMD64.go       |  2229 +-
 src/cmd/compile/internal/ssa/rewriteARM64.go       | 36183 +++++++++++--------
 src/cmd/compile/internal/ssa/rewritePPC64.go       |  5234 ++-
 src/cmd/compile/internal/ssa/rewriteWasm.go        |     8 +-
 src/cmd/compile/internal/ssa/rewritegeneric.go     |   434 +-
 src/cmd/compile/internal/ssa/softfloat.go          |     2 +-
 src/cmd/compile/internal/ssa/stmtlines_test.go     |     3 +
 .../internal/ssa/testdata/hist.gdb-opt.nexts       |    20 +-
 src/cmd/compile/internal/types/type.go             |     2 +-
 src/cmd/compile/internal/x86/ssa.go                |    26 +-
 src/cmd/dist/build.go                              |     4 +
 src/cmd/dist/buildruntime.go                       |     4 +
 src/cmd/dist/main.go                               |     3 +
 src/cmd/dist/test.go                               |     4 +-
 src/cmd/fix/main.go                                |     2 +-
 src/cmd/fix/typecheck.go                           |     4 +-
 src/cmd/go/alldocs.go                              |     8 +-
 src/cmd/go/go_test.go                              |    55 +-
 src/cmd/go/internal/clean/clean.go                 |    14 +-
 src/cmd/go/internal/envcmd/env.go                  |     2 +-
 src/cmd/go/internal/get/vcs.go                     |     2 +-
 src/cmd/go/internal/help/helpdoc.go                |     6 +
 src/cmd/go/internal/modconv/convert_test.go        |     2 +-
 src/cmd/go/internal/modfetch/codehost/codehost.go  |     2 +-
 src/cmd/go/internal/modfetch/coderepo_test.go      |    16 +-
 src/cmd/go/internal/modfetch/fetch.go              |     2 +-
 src/cmd/go/internal/modfetch/proxy.go              |     2 +-
 src/cmd/go/internal/modload/build.go               |    18 +-
 src/cmd/go/internal/modload/import.go              |     5 +-
 src/cmd/go/internal/modload/import_test.go         |     2 +-
 src/cmd/go/internal/modload/query.go               |     4 +-
 src/cmd/go/internal/modload/query_test.go          |     2 +-
 src/cmd/go/internal/search/search.go               |     4 +-
 src/cmd/go/internal/work/build.go                  |     6 +-
 src/cmd/go/internal/work/buildid.go                |     8 +-
 src/cmd/go/internal/work/exec.go                   |    10 +-
 src/cmd/go/internal/work/security.go               |     4 +
 src/cmd/go/main.go                                 |    18 +-
 src/cmd/go/proxy_test.go                           |     4 +-
 src/cmd/go/script_test.go                          |    12 +-
 src/cmd/go/testdata/addmod.go                      |     2 +-
 src/cmd/go/testdata/script/help.txt                |     5 +
 src/cmd/go/testdata/script/list_bad_import.txt     |     2 +-
 src/cmd/go/testdata/script/mod_clean_cache.txt     |    23 +
 src/cmd/go/testdata/script/mod_help.txt            |     6 +
 src/cmd/go/testdata/script/mod_list_bad_import.txt |     2 +-
 src/cmd/go/testdata/script/mod_string_alias.txt    |    14 +
 src/cmd/go/testdata/script/mod_test.txt            |     7 +
 src/cmd/go/vendor_test.go                          |     2 +-
 src/cmd/gofmt/gofmt_test.go                        |     2 +-
 src/cmd/internal/dwarf/dwarf.go                    |    13 +
 src/cmd/internal/goobj/read.go                     |     2 +-
 src/cmd/internal/obj/arm/asm5.go                   |     2 +-
 src/cmd/internal/obj/arm64/asm7.go                 |    72 +-
 src/cmd/internal/obj/link.go                       |     7 +-
 src/cmd/internal/objabi/funcdata.go                |     1 +
 src/cmd/internal/objabi/funcid.go                  |     2 +-
 src/cmd/internal/objabi/head.go                    |     5 +
 src/cmd/link/dwarf_test.go                         |     3 +
 src/cmd/link/internal/ld/dwarf.go                  |   155 +-
 src/cmd/link/internal/ld/dwarf_test.go             |   114 +
 src/cmd/link/internal/ld/lib.go                    |    73 +-
 src/cmd/link/internal/ld/pcln.go                   |    97 +-
 src/cmd/link/internal/ld/util.go                   |    10 +
 src/cmd/link/internal/objfile/objfile.go           |     2 +-
 src/cmd/link/internal/ppc64/asm.go                 |    12 +-
 src/cmd/trace/trace.go                             |    12 +-
 src/cmd/vendor/golang.org/x/sys/windows/aliases.go |    13 +
 .../golang.org/x/sys/windows/asm_windows_arm.s     |    11 +
 .../x/sys/windows/registry/zsyscall_windows.go     |     2 +-
 .../golang.org/x/sys/windows/security_windows.go   |     4 +-
 src/cmd/vendor/golang.org/x/sys/windows/service.go |    18 +
 .../golang.org/x/sys/windows/svc/mgr/config.go     |    38 +-
 .../golang.org/x/sys/windows/svc/mgr/mgr_test.go   |   113 +
 .../golang.org/x/sys/windows/svc/mgr/recovery.go   |   135 +
 .../vendor/golang.org/x/sys/windows/svc/sys_arm.s  |    38 +
 .../golang.org/x/sys/windows/syscall_windows.go    |    60 +-
 .../x/sys/windows/syscall_windows_test.go          |     6 +
 .../golang.org/x/sys/windows/types_windows.go      |   180 +-
 .../golang.org/x/sys/windows/types_windows_arm.go  |    22 +
 .../golang.org/x/sys/windows/zsyscall_windows.go   |     2 +-
 src/cmd/vendor/vendor.json                         |    32 +-
 src/cmd/vet/all/main.go                            |    12 +-
 src/cmd/vet/all/whitelist/all.txt                  |     1 +
 src/cmd/vet/all/whitelist/windows_386.txt          |     1 -
 src/cmd/vet/all/whitelist/windows_amd64.txt        |     1 -
 src/cmd/vet/main.go                                |     3 +-
 src/cmd/vet/shadow.go                              |     9 +-
 src/cmd/vet/testdata/shadow.go                     |    32 +
 src/cmd/vet/types.go                               |    24 +-
 src/cmd/vet/vet_test.go                            |     2 +-
 src/compress/bzip2/bzip2_test.go                   |     4 +-
 .../bzip2/testdata/Isaac.Newton-Opticks.txt.bz2    |   Bin 0 -> 132469 bytes
 .../bzip2/testdata/Mark.Twain-Tom.Sawyer.txt.bz2   |   Bin 118509 -> 0 bytes
 src/compress/flate/deflate_test.go                 |     8 +-
 src/compress/flate/reader_test.go                  |     4 +-
 src/compress/testdata/Mark.Twain-Tom.Sawyer.txt    |  8465 -----
 src/compress/zlib/writer.go                        |    12 +-
 src/context/context.go                             |     2 +-
 src/crypto/cipher/benchmark_test.go                |    67 +-
 src/crypto/md5/md5block_386.s                      |     2 +-
 src/crypto/md5/md5block_amd64.s                    |     4 +-
 src/crypto/md5/md5block_amd64p32.s                 |     4 +-
 src/crypto/rand/rand.go                            |     4 +
 src/crypto/rand/rand_unix.go                       |     8 +
 src/crypto/rand/rand_windows.go                    |     9 +
 src/crypto/rsa/pss_test.go                         |     2 +-
 src/crypto/sha1/sha1block_386.s                    |     8 +-
 src/crypto/sha1/sha1block_amd64.s                  |    10 +-
 src/crypto/sha1/sha1block_amd64p32.s               |    10 +-
 src/crypto/sha1/sha1block_arm.s                    |    10 +-
 src/crypto/x509/cert_pool.go                       |     2 +-
 src/crypto/x509/root_darwin_arm_gen.go             |     6 +-
 src/crypto/x509/verify.go                          |     4 +-
 src/crypto/x509/verify_test.go                     |     1 +
 src/database/sql/driver/driver.go                  |     2 +-
 src/database/sql/sql.go                            |    10 +-
 src/database/sql/sql_test.go                       |    52 +
 src/debug/elf/elf.go                               |     2 +
 src/encoding/base32/base32_test.go                 |    10 +-
 src/encoding/base64/base64_test.go                 |     8 +-
 src/encoding/json/decode.go                        |   133 +-
 src/encoding/json/decode_test.go                   |    19 +-
 src/flag/flag.go                                   |     2 +-
 src/fmt/example_test.go                            |   335 +-
 src/fmt/fmt_test.go                                |     7 +-
 src/fmt/print.go                                   |    10 +
 src/go/build/build.go                              |    10 +-
 src/go/build/deps_test.go                          |     3 +-
 src/go/build/doc.go                                |     3 +
 src/go/build/gc.go                                 |   120 -
 src/go/build/gccgo.go                              |     6 -
 src/go/build/syslist.go                            |     2 +-
 src/go/constant/value_test.go                      |     2 +-
 src/go/doc/doc_test.go                             |     6 +-
 src/go/internal/gccgoimporter/importer_test.go     |     4 +-
 src/go/internal/gccgoimporter/parser.go            |   227 +-
 src/go/internal/gccgoimporter/testdata/alias.gox   |     4 -
 src/go/internal/gccgoimporter/testdata/aliases.go  |    65 +
 src/go/internal/gccgoimporter/testdata/aliases.gox |    33 +
 .../internal/gccgoimporter/testdata/issue27856.go  |     9 +
 .../internal/gccgoimporter/testdata/issue27856.gox |     9 +
 src/go/printer/example_test.go                     |     4 +-
 src/go/token/position.go                           |    17 +-
 src/go/token/position_test.go                      |    15 +
 src/go/types/api.go                                |     4 +-
 src/go/types/decl.go                               |    14 +-
 src/go/types/example_test.go                       |    21 +-
 src/go/types/expr.go                               |     2 +-
 src/go/types/scope.go                              |    10 +-
 src/go/types/sizes.go                              |     3 +-
 src/go/types/testdata/cycles5.src                  |    21 +-
 src/go/types/testdata/decls0.src                   |    10 +-
 src/go/types/typexpr.go                            |    20 +-
 src/html/template/js.go                            |     2 +-
 src/html/template/url.go                           |     2 +-
 src/image/draw/draw.go                             |   126 +-
 src/image/format.go                                |    13 +-
 src/image/image.go                                 |   149 +-
 src/image/image_test.go                            |   214 +-
 src/image/png/reader_test.go                       |     4 -
 src/image/png/writer.go                            |    90 +-
 src/image/png/writer_test.go                       |   112 +-
 src/internal/bytealg/compare_amd64.s               |     2 +-
 src/internal/bytealg/compare_amd64p32.s            |     2 +-
 src/internal/bytealg/count_generic.go              |     2 +-
 src/internal/bytealg/count_native.go               |     2 +-
 src/internal/bytealg/count_ppc64x.s                |    97 +
 src/internal/bytealg/equal_amd64.s                 |     2 +-
 src/internal/bytealg/equal_amd64p32.s              |     2 +-
 src/internal/bytealg/equal_arm.s                   |     2 +-
 src/internal/bytealg/equal_arm64.s                 |    44 +-
 src/internal/bytealg/indexbyte_ppc64x.s            |    28 +-
 src/internal/goroot/gc.go                          |   140 +
 src/internal/goroot/gccgo.go                       |    27 +
 src/internal/poll/export_posix_test.go             |     2 +-
 src/internal/poll/fd_poll_runtime.go               |     2 +-
 src/internal/poll/fd_posix.go                      |     2 +-
 src/internal/poll/fd_posix_test.go                 |     2 +-
 src/internal/poll/fd_unix.go                       |     2 +-
 src/internal/poll/fd_windows.go                    |   155 +-
 src/internal/poll/hook_unix.go                     |     2 +-
 src/internal/poll/sockopt.go                       |     2 +-
 src/internal/poll/sockopt_unix.go                  |     2 +-
 src/internal/poll/sockoptip.go                     |     2 +-
 src/internal/poll/splice_linux.go                  |    17 +-
 src/internal/poll/sys_cloexec.go                   |     2 +-
 src/internal/syscall/unix/nonblocking.go           |     2 +-
 src/io/io.go                                       |     8 +-
 src/io/multi.go                                    |     4 +-
 src/math/all_test.go                               |    38 +
 src/math/big/arith_386.s                           |     2 +-
 src/math/big/arith_amd64.s                         |     6 +-
 src/math/big/arith_arm.s                           |     4 +-
 src/math/big/arith_s390x.s                         |    14 +-
 src/math/bits/bits.go                              |   194 +
 src/math/bits/bits_test.go                         |   266 +
 src/math/expm1_386.s                               |     4 +-
 src/math/sin_386.s                                 |     2 +-
 src/math/sqrt_386.s                                |     2 +-
 src/math/sqrt_arm.s                                |     2 +-
 src/mime/mediatype.go                              |     2 +-
 src/mime/mediatype_test.go                         |     3 +
 src/mime/multipart/formdata_test.go                |     8 +-
 src/mime/multipart/multipart_test.go               |     6 +-
 src/net/dnsclient.go                               |     7 +-
 src/net/dnsclient_unix.go                          |   115 +-
 src/net/dnsclient_unix_test.go                     |   196 +-
 src/net/dnsname_test.go                            |     1 +
 src/net/http/cgi/child.go                          |     2 +-
 src/net/http/client.go                             |     2 +-
 src/net/http/clientserver_test.go                  |    30 +-
 src/net/http/cookie.go                             |     4 +-
 src/net/http/example_handle_test.go                |    29 +
 src/net/http/example_test.go                       |    18 +
 src/net/http/export_test.go                        |     6 +-
 src/net/http/header.go                             |    40 +-
 src/net/http/http.go                               |     4 +
 src/net/http/httputil/dump_test.go                 |     2 +-
 src/net/http/proxy_test.go                         |     2 +-
 src/net/http/readrequest_test.go                   |     2 +-
 src/net/http/request.go                            |    28 +-
 src/net/http/request_test.go                       |     6 +-
 src/net/http/roundtrip_js.go                       |     4 +-
 src/net/http/serve_test.go                         |    11 +-
 src/net/http/server.go                             |    28 +-
 src/net/http/transport.go                          |    49 +-
 src/net/http/transport_internal_test.go            |    83 +
 src/net/http/transport_test.go                     |     4 +-
 src/net/lookup_unix.go                             |    16 +-
 src/net/lookup_windows_test.go                     |     2 +-
 src/net/mail/message_test.go                       |     4 +-
 src/net/net_windows_test.go                        |     2 +-
 src/net/sendfile_test.go                           |    22 +-
 src/net/splice_linux.go                            |     5 +-
 src/net/splice_test.go                             |    52 +
 src/net/testdata/Mark.Twain-Tom.Sawyer.txt         |  8465 -----
 src/net/textproto/reader_test.go                   |    44 +-
 src/net/unixsock_windows_test.go                   |     4 +
 src/net/url/example_test.go                        |     2 +-
 src/net/url/url.go                                 |    72 +-
 src/net/url/url_test.go                            |   120 +-
 src/os/example_test.go                             |    33 +-
 src/os/file.go                                     |    18 +
 src/os/os_test.go                                  |    14 +
 src/os/os_unix_test.go                             |     2 +-
 src/os/os_windows_test.go                          |    62 +-
 src/os/path_windows_test.go                        |     6 +-
 src/os/stat_test.go                                |   276 +
 src/os/types.go                                    |     2 +-
 src/os/types_windows.go                            |     8 +-
 src/os/user/lookup.go                              |     4 +
 src/os/user/lookup_stubs.go                        |    11 +-
 src/os/user/user_test.go                           |    18 +-
 src/path/filepath/path.go                          |    15 +-
 src/path/filepath/path_test.go                     |    19 +-
 src/path/filepath/path_windows.go                  |     2 +-
 src/path/filepath/path_windows_test.go             |     2 +-
 src/path/filepath/symlink.go                       |   191 +-
 src/reflect/all_test.go                            |     7 +-
 src/reflect/asm_386.s                              |    10 +-
 src/reflect/asm_amd64.s                            |    10 +-
 src/reflect/asm_amd64p32.s                         |    10 +-
 src/reflect/asm_arm.s                              |    12 +-
 src/reflect/asm_arm64.s                            |    10 +-
 src/reflect/asm_mips64x.s                          |    10 +-
 src/reflect/asm_mipsx.s                            |    10 +-
 src/reflect/asm_ppc64x.s                           |    10 +-
 src/reflect/asm_s390x.s                            |    10 +-
 src/reflect/asm_wasm.s                             |    10 +-
 src/reflect/example_test.go                        |    18 +
 src/reflect/export_test.go                         |     4 +-
 src/reflect/makefunc.go                            |    27 +-
 src/reflect/type.go                                |    16 +-
 src/reflect/value.go                               |    92 +-
 src/regexp/regexp.go                               |     2 +-
 src/runtime/asm_386.s                              |    84 +-
 src/runtime/asm_amd64.s                            |    26 +-
 src/runtime/asm_amd64p32.s                         |     4 +-
 src/runtime/asm_arm.s                              |    12 +-
 src/runtime/asm_ppc64x.s                           |    39 +-
 src/runtime/cgo/asm_amd64.s                        |     6 +-
 src/runtime/cgo/asm_arm.s                          |     2 +-
 src/runtime/cgo/signal_darwin_arm64.s              |     2 +-
 src/runtime/cgocheck.go                            |     2 +-
 src/runtime/chan.go                                |    28 +-
 src/runtime/crash_test.go                          |     2 +-
 src/runtime/crash_unix_test.go                     |     2 +-
 src/runtime/debug_test.go                          |    33 +
 src/runtime/defs2_linux.go                         |     5 +-
 src/runtime/defs_aix.go                            |   170 +
 src/runtime/defs_aix_ppc64.go                      |   203 +
 src/runtime/defs_linux.go                          |     5 +-
 src/runtime/defs_linux_386.go                      |     1 +
 src/runtime/defs_linux_amd64.go                    |     1 +
 src/runtime/defs_linux_arm.go                      |     1 +
 src/runtime/defs_linux_arm64.go                    |     1 +
 src/runtime/defs_linux_mips64x.go                  |     1 +
 src/runtime/defs_linux_mipsx.go                    |     1 +
 src/runtime/defs_linux_ppc64.go                    |     1 +
 src/runtime/defs_linux_ppc64le.go                  |     1 +
 src/runtime/defs_linux_s390x.go                    |     1 +
 src/runtime/defs_windows_386.go                    |     3 +
 src/runtime/defs_windows_amd64.go                  |     3 +
 src/runtime/defs_windows_arm.go                    |   149 +
 src/runtime/env_posix.go                           |     2 +-
 src/runtime/export_unix_test.go                    |     2 +-
 src/runtime/extern.go                              |     8 +-
 src/runtime/funcdata.h                             |     1 +
 src/runtime/gc_test.go                             |     7 +-
 src/runtime/gcinfo_test.go                         |    48 +-
 src/runtime/heapdump.go                            |    10 +-
 src/runtime/internal/sys/zgoos_aix.go              |    21 +
 src/runtime/internal/sys/zgoos_android.go          |     1 +
 src/runtime/internal/sys/zgoos_darwin.go           |     1 +
 src/runtime/internal/sys/zgoos_dragonfly.go        |     1 +
 src/runtime/internal/sys/zgoos_freebsd.go          |     1 +
 src/runtime/internal/sys/zgoos_linux.go            |     1 +
 src/runtime/internal/sys/zgoos_nacl.go             |     1 +
 src/runtime/internal/sys/zgoos_netbsd.go           |     1 +
 src/runtime/internal/sys/zgoos_openbsd.go          |     1 +
 src/runtime/internal/sys/zgoos_plan9.go            |     1 +
 src/runtime/internal/sys/zgoos_solaris.go          |     1 +
 src/runtime/internal/sys/zgoos_windows.go          |     1 +
 src/runtime/internal/sys/zgoos_zos.go              |     1 +
 src/runtime/lock_sema.go                           |     2 +-
 src/runtime/malloc.go                              |    29 +-
 src/runtime/mbarrier.go                            |    13 +
 src/runtime/mbitmap.go                             |    24 +-
 src/runtime/mcache.go                              |    57 +-
 src/runtime/mcentral.go                            |    55 +-
 src/runtime/{mem_darwin.go => mem_aix.go}          |    42 +-
 src/runtime/mem_bsd.go                             |     2 +-
 src/runtime/mem_linux.go                           |    13 +-
 src/runtime/memmove_amd64p32.s                     |     2 +-
 src/runtime/memmove_arm.s                          |     2 +-
 src/runtime/memmove_plan9_386.s                    |     2 +-
 src/runtime/memmove_plan9_amd64.s                  |     2 +-
 src/runtime/mgc.go                                 |   590 +-
 src/runtime/mgcmark.go                             |   334 +-
 src/runtime/mgcstack.go                            |   330 +
 src/runtime/mgcsweep.go                            |    34 +-
 src/runtime/mgcwork.go                             |   103 +-
 src/runtime/mheap.go                               |    73 +-
 src/runtime/mmap.go                                |     1 +
 src/runtime/mprof.go                               |     2 +-
 src/runtime/mstats.go                              |     2 +-
 src/runtime/mwbbuf.go                              |    12 +-
 src/runtime/netpoll.go                             |     6 +-
 src/runtime/netpoll_aix.go                         |   247 +
 src/runtime/os2_aix.go                             |   479 +
 src/runtime/os_aix.go                              |   262 +
 src/runtime/os_darwin.go                           |    11 +-
 src/runtime/os_nacl.go                             |    12 +-
 src/runtime/os_netbsd.go                           |    31 +-
 src/runtime/os_windows.go                          |    45 +-
 src/runtime/os_windows_arm.go                      |    18 +
 src/runtime/pprof/internal/profile/profile.go      |     2 +-
 src/runtime/pprof/pprof_test.go                    |     2 +-
 src/runtime/pprof/proto.go                         |     8 +
 src/runtime/pprof/proto_test.go                    |    95 +-
 src/runtime/proc.go                                |   168 +-
 src/runtime/race/testdata/chan_test.go             |    30 +-
 src/runtime/rt0_aix_ppc64.s                        |    40 +
 src/runtime/rt0_linux_ppc64le.s                    |     2 +-
 src/runtime/rt0_nacl_amd64p32.s                    |     2 +-
 src/runtime/rt0_windows_arm.s                      |    12 +
 src/runtime/runtime-gdb_test.go                    |    27 +-
 src/runtime/runtime1.go                            |     6 +-
 src/runtime/runtime2.go                            |    21 +-
 src/runtime/runtime_unix_test.go                   |     2 +-
 src/runtime/select.go                              |     4 +-
 src/runtime/semasleep_test.go                      |    88 +
 src/runtime/signal_aix_ppc64.go                    |    85 +
 src/runtime/signal_ppc64x.go                       |     2 +-
 src/runtime/signal_sighandler.go                   |     2 +-
 src/runtime/signal_unix.go                         |     2 +-
 src/runtime/signal_windows.go                      |    10 +-
 src/runtime/sigtab_aix.go                          |   264 +
 src/runtime/stack.go                               |    79 +-
 src/runtime/stubs2.go                              |     4 +-
 src/runtime/stubs3.go                              |     1 +
 src/runtime/symtab.go                              |     5 +-
 src/runtime/sys_aix_ppc64.s                        |   201 +
 src/runtime/sys_darwin.go                          |     2 +-
 src/runtime/sys_dragonfly_amd64.s                  |     8 +-
 src/runtime/sys_freebsd_386.s                      |     8 +-
 src/runtime/sys_freebsd_amd64.s                    |     6 +-
 src/runtime/sys_freebsd_arm.s                      |    15 +-
 src/runtime/sys_linux_386.s                        |    13 +-
 src/runtime/sys_linux_amd64.s                      |    16 +-
 src/runtime/sys_linux_arm.s                        |    14 +-
 src/runtime/sys_linux_arm64.s                      |    14 +-
 src/runtime/sys_linux_mips64x.s                    |    14 +-
 src/runtime/sys_linux_mipsx.s                      |    16 +-
 src/runtime/sys_linux_ppc64x.s                     |    13 +-
 src/runtime/sys_linux_s390x.s                      |    14 +-
 src/runtime/sys_nacl_386.s                         |     8 +-
 src/runtime/sys_nacl_amd64p32.s                    |     4 +-
 src/runtime/sys_netbsd_386.s                       |     4 +-
 src/runtime/sys_netbsd_amd64.s                     |     6 +-
 src/runtime/sys_netbsd_arm.s                       |    11 +-
 src/runtime/sys_openbsd_386.s                      |     5 +-
 src/runtime/sys_openbsd_amd64.s                    |     4 +-
 src/runtime/sys_openbsd_arm.s                      |     4 +-
 src/runtime/sys_plan9_386.s                        |     2 +-
 src/runtime/sys_plan9_amd64.s                      |     2 +-
 src/runtime/sys_solaris_amd64.s                    |     8 +-
 src/runtime/sys_windows_386.s                      |     8 +-
 src/runtime/sys_windows_amd64.s                    |     2 +-
 src/runtime/sys_windows_arm.s                      |   605 +
 src/runtime/syscall_windows.go                     |    24 +-
 src/runtime/testdata/testprogcgo/exec.go           |    16 +
 src/runtime/timestub2.go                           |     1 +
 src/runtime/tls_arm.s                              |    43 +-
 src/runtime/traceback.go                           |    34 +-
 src/runtime/vlop_arm.s                             |     2 +-
 src/runtime/wincallback.go                         |    42 +-
 src/runtime/zcallback_windows.go                   |     2 +-
 src/runtime/zcallback_windows.s                    |     4 +-
 src/runtime/zcallback_windows_arm.s                |  4012 ++
 src/strings/example_test.go                        |     2 +-
 src/strings/replace.go                             |     8 +-
 src/strings/strings.go                             |    75 +-
 src/strings/strings_test.go                        |    10 +-
 src/sync/map.go                                    |    12 +-
 src/syscall/asm_nacl_386.s                         |     2 +-
 src/syscall/asm_nacl_amd64p32.s                    |     2 +-
 src/syscall/asm_nacl_arm.s                         |     2 +-
 src/syscall/asm_plan9_386.s                        |    20 +-
 src/syscall/asm_plan9_amd64.s                      |    20 +-
 src/syscall/syscall_linux_386.go                   |    15 +-
 src/syscall/syscall_linux_amd64.go                 |    10 +-
 src/syscall/syscall_linux_arm.go                   |    15 +-
 src/syscall/syscall_linux_test.go                  |     3 +-
 src/syscall/zsyscall_linux_386.go                  |    45 -
 src/syscall/zsyscall_linux_amd64.go                |    30 -
 src/syscall/zsyscall_linux_arm.go                  |    45 -
 src/testdata/Isaac.Newton-Opticks.txt              |  9286 +++++
 src/testing/sub_test.go                            |     4 +-
 src/text/template/exec.go                          |     2 +-
 src/time/zoneinfo.go                               |    11 +-
 src/time/zoneinfo_android.go                       |     3 +-
 src/time/zoneinfo_read.go                          |     2 +-
 src/time/zoneinfo_test.go                          |    11 +
 test/bench/garbage/tree.go                         |     2 +-
 test/checkbce.go                                   |     2 +-
 test/codegen/arithmetic.go                         |    17 +-
 test/codegen/bits.go                               |    13 +-
 test/codegen/comparisons.go                        |     9 +
 test/codegen/mapaccess.go                          |    24 +
 test/codegen/math.go                               |     9 +
 test/codegen/mathbits.go                           |    21 +
 test/codegen/memops.go                             |    86 +
 test/codegen/noextend.go                           |   213 +
 test/escape2.go                                    |    32 +-
 test/escape2n.go                                   |    32 +-
 test/fixedbugs/issue20250.go                       |     8 +-
 test/fixedbugs/issue26616.go                       |    10 +-
 test/fixedbugs/issue26855.go                       |    28 +
 test/fixedbugs/issue27518a.go                      |    45 +
 test/fixedbugs/issue27518b.go                      |    72 +
 test/fixedbugs/issue27595.go                       |    19 +
 test/fixedbugs/issue27695.go                       |    62 +
 test/fixedbugs/issue27695b.go                      |    64 +
 test/fixedbugs/issue27718.go                       |    72 +
 test/fixedbugs/issue27829.go                       |    27 +
 test/fixedbugs/issue27836.dir/Äfoo.go              |    13 +
 test/fixedbugs/issue27836.dir/Ämain.go             |    13 +
 test/fixedbugs/issue27836.go                       |     7 +
 test/fixedbugs/issue27961.go                       |    35 +
 test/fixedbugs/issue7921.go                        |    57 +
 test/live.go                                       |   175 +-
 test/live2.go                                      |    15 +-
 test/live_syscall.go                               |     8 +-
 test/nosplit.go                                    |     2 +-
 test/run.go                                        |    18 +-
 test/stackobj.go                                   |    57 +
 test/stackobj2.go                                  |    83 +
 test/stackobj3.go                                  |    93 +
 test/uintptrescapes2.go                            |     8 +-
 545 files changed, 54625 insertions(+), 40475 deletions(-)

diff --cc src/crypto/rand/rand_unix.go
index 13c874a961,d49f693746..272b83d52b
--- a/src/crypto/rand/rand_unix.go
+++ b/src/crypto/rand/rand_unix.go
@@@ -51,7 -48,12 +53,13 @@@ type devReader struct 
  var altGetRandom func([]byte) (ok bool)
  
  func (r *devReader) Read(b []byte) (n int, err error) {
 +	boring.Unreachable()
+ 	if atomic.CompareAndSwapInt32(&r.used, 0, 1) {
+ 		// First use of randomness. Start timer to warn about
+ 		// being blocked on entropy not being available.
+ 		t := time.AfterFunc(60*time.Second, warnBlocked)
+ 		defer t.Stop()
+ 	}
  	if altGetRandom != nil && r.name == urandomDevice && altGetRandom(b) {
  		return len(b), nil
  	}
