commit f8b0231639859de7b8f1bfe7df1be0132aec9ad6
Author: Josh Bleecher Snyder <josharian@gmail.com>
Date:   Mon Mar 20 09:56:50 2017 -0700

    cmd/go, cmd/compile: always optimize when building runtime
    
    When optimizations are disabled, the compiler
    cannot eliminate enough write barriers to satisfy
    the runtime's nowritebarrier and nowritebarrierrec
    annotations.
    
    Enforce that requirement, and for convenience,
    have cmd/go elide -N when compiling the runtime.
    
    This came up in practice for me when running
    toolstash -cmp. When toolstash -cmp detected
    mismatches, it recompiled with -N, which caused
    runtime compilation failures.
    
    Change-Id: Ifcdef22c725baf2c59a09470f00124361508a8f3
    Reviewed-on: https://go-review.googlesource.com/38380
    Run-TryBot: Josh Bleecher Snyder <josharian@gmail.com>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Brad Fitzpatrick <bradfitz@golang.org>

 src/cmd/compile/internal/gc/main.go |  3 +++
 src/cmd/go/internal/work/build.go   | 20 ++++++++++++++++++--
 2 files changed, 21 insertions(+), 2 deletions(-)
