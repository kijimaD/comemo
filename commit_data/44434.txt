commit 9a555fc24c318bf1b07bdc07d5c02e372681e401
Author: Dan Scales <danscales@google.com>
Date:   Thu Feb 25 12:13:23 2021 -0800

    cmd/compile:  fix missing descend in Addrtaken for closures.
    
    ComputeAddrtaken needs to descend into closures, now that imported
    bodies can include closures. The bug was that we weren't properly
    setting Addrtaken for a variable inside a closure inside a function that
    we were importing.
    
    For now, still disable inlining of functions with closures for -G mode.
    I'll enable it in a later change -- there are just a few fixes related
    to the fact that we don't need to set Ntype for closure functions.
    
    Added a test derived from the cilium repro in the issue.
    
    Fixes #44370
    
    Change-Id: Ida2a403636bf8740b471b3ad68b5474951811e19
    Reviewed-on: https://go-review.googlesource.com/c/go/+/296649
    Run-TryBot: Dan Scales <danscales@google.com>
    Trust: Dan Scales <danscales@google.com>
    TryBot-Result: Go Bot <gobot@golang.org>
    Reviewed-by: Keith Randall <khr@golang.org>
    Reviewed-by: Matthew Dempsky <mdempsky@google.com>

 src/cmd/compile/internal/base/flag.go      |  1 +
 src/cmd/compile/internal/inline/inl.go     |  4 +---
 src/cmd/compile/internal/typecheck/subr.go |  9 +++++++--
 test/fixedbugs/issue44370.dir/a.go         | 20 ++++++++++++++++++++
 test/fixedbugs/issue44370.dir/b.go         | 11 +++++++++++
 test/fixedbugs/issue44370.go               |  7 +++++++
 6 files changed, 47 insertions(+), 5 deletions(-)
