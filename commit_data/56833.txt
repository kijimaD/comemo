commit d4bd855cfb5319bfa560251d60a93369c0ce0763
Author: Filippo Valsorda <filippo@golang.org>
Date:   Wed May 24 15:49:56 2023 +0200

    crypto/tls: don't reverify but check certificate expiration on resumption
    
    We used to inconsistently run certificate verification on the server on
    resumption, but not on the client. This made TLS 1.3 resumption pretty
    much useless, as it didn't save bytes, CPU, or round-trips.
    
    This requires serializing the verified chains into the session ticket,
    so it's a tradeoff making the ticket bigger to save computation (and for
    consistency).
    
    The previous behavior also had a "stickyness" issue: if a ticket
    contained invalid certificates, they would be used even if the client
    had in the meantime configured valid certificates for a full handshake.
    
    We also didn't check expiration on the client side on resumption if
    InsecureSkipVerify was set. Again for consistency, we do that now.
    
    Also, we used to run VerifyPeerCertificates on resumption even if
    NoClientCerts was set.
    
    Fixes #31641
    
    Change-Id: Icc88269ea4adb544fa81158114aae76f3c91a15f
    Reviewed-on: https://go-review.googlesource.com/c/go/+/497895
    Reviewed-by: Damien Neil <dneil@google.com>
    TryBot-Result: Gopher Robot <gobot@golang.org>
    Run-TryBot: Filippo Valsorda <filippo@golang.org>
    Reviewed-by: Roland Shoemaker <roland@golang.org>
    Auto-Submit: Filippo Valsorda <filippo@golang.org>
---
 src/crypto/tls/common.go                           |  19 +-
 src/crypto/tls/handshake_client.go                 |  13 +-
 src/crypto/tls/handshake_messages_test.go          |  10 +-
 src/crypto/tls/handshake_server.go                 |  18 +-
 src/crypto/tls/handshake_server_tls13.go           |  14 +-
 .../testdata/Server-TLSv10-ExportKeyingMaterial    |  77 ++---
 src/crypto/tls/testdata/Server-TLSv12-ALPN         |  62 ++--
 .../tls/testdata/Server-TLSv12-ALPN-Fallback       |  64 ++--
 .../tls/testdata/Server-TLSv12-ALPN-NotConfigured  |  64 ++--
 .../testdata/Server-TLSv12-ExportKeyingMaterial    |  80 ++---
 src/crypto/tls/testdata/Server-TLSv12-IssueTicket  |  74 ++---
 .../testdata/Server-TLSv12-IssueTicketPreDisable   |  74 ++---
 src/crypto/tls/testdata/Server-TLSv12-Resume       |  87 +++---
 .../tls/testdata/Server-TLSv13-AES128-SHA256       | 166 +++++------
 .../tls/testdata/Server-TLSv13-AES256-SHA384       | 172 +++++------
 src/crypto/tls/testdata/Server-TLSv13-ALPN         | 168 +++++------
 .../tls/testdata/Server-TLSv13-ALPN-Fallback       | 164 +++++-----
 .../tls/testdata/Server-TLSv13-ALPN-NotConfigured  | 166 +++++------
 .../tls/testdata/Server-TLSv13-CHACHA20-SHA256     | 166 +++++------
 .../Server-TLSv13-ClientAuthRequestedAndECDSAGiven | 332 ++++++++++-----------
 ...erver-TLSv13-ClientAuthRequestedAndEd25519Given | 269 ++++++++---------
 .../Server-TLSv13-ClientAuthRequestedAndGiven      | 325 ++++++++++----------
 .../Server-TLSv13-ClientAuthRequestedNotGiven      | 178 +++++------
 .../tls/testdata/Server-TLSv13-ECDHE-ECDSA-AES     | 158 +++++-----
 src/crypto/tls/testdata/Server-TLSv13-Ed25519      | 122 ++++----
 .../testdata/Server-TLSv13-ExportKeyingMaterial    | 166 +++++------
 .../tls/testdata/Server-TLSv13-HelloRetryRequest   | 190 ++++++------
 src/crypto/tls/testdata/Server-TLSv13-IssueTicket  | 166 +++++------
 .../testdata/Server-TLSv13-IssueTicketPreDisable   | 166 +++++------
 src/crypto/tls/testdata/Server-TLSv13-P256         | 170 +++++------
 src/crypto/tls/testdata/Server-TLSv13-RSA-RSAPSS   | 166 +++++------
 src/crypto/tls/testdata/Server-TLSv13-Resume       |  85 +++---
 .../Server-TLSv13-Resume-HelloRetryRequest         | 132 ++++----
 src/crypto/tls/testdata/Server-TLSv13-X25519       | 166 +++++------
 src/crypto/tls/ticket.go                           | 102 +++----
 src/crypto/tls/tls_test.go                         | 144 +++++++++
 36 files changed, 2428 insertions(+), 2267 deletions(-)

diff --git a/src/crypto/tls/common.go b/src/crypto/tls/common.go
index 829db2316e..e0885a0da9 100644
--- a/src/crypto/tls/common.go
+++ b/src/crypto/tls/common.go
@@ -604,10 +604,16 @@ type Config struct {
 	// non-nil error, the handshake is aborted and that error results.
 	//
 	// If normal verification fails then the handshake will abort before
-	// considering this callback. If normal verification is disabled by
-	// setting InsecureSkipVerify, or (for a server) when ClientAuth is
-	// RequestClientCert or RequireAnyClientCert, then this callback will
-	// be considered but the verifiedChains argument will always be nil.
+	// considering this callback. If normal verification is disabled (on the
+	// client when InsecureSkipVerify is set, or on a server when ClientAuth is
+	// RequestClientCert or RequireAnyClientCert), then this callback will be
+	// considered but the verifiedChains argument will always be nil. When
+	// ClientAuth is NoClientCert, this callback is not called on the server.
+	// rawCerts may be empty on the server if ClientAuth is RequestClientCert or
+	// VerifyClientCertIfGiven.
+	//
+	// This callback is not invoked on resumed connections, as certificates are
+	// not re-verified on resumption.
 	//
 	// verifiedChains and its contents should not be modified.
 	VerifyPeerCertificate func(rawCerts [][]byte, verifiedChains [][]*x509.Certificate) error
@@ -618,8 +624,9 @@ type Config struct {
 	// and that error results.
 	//
 	// If normal verification fails then the handshake will abort before
-	// considering this callback. This callback will run for all connections
-	// regardless of InsecureSkipVerify or ClientAuth settings.
+	// considering this callback. This callback will run for all connections,
+	// including resumptions, regardless of InsecureSkipVerify or ClientAuth
+	// settings.
 	VerifyConnection func(ConnectionState) error
 
 	// RootCAs defines the set of root certificate authorities
diff --git a/src/crypto/tls/handshake_client.go b/src/crypto/tls/handshake_client.go
index 80949f22e2..c2ac75fdbf 100644
--- a/src/crypto/tls/handshake_client.go
+++ b/src/crypto/tls/handshake_client.go
@@ -319,18 +319,17 @@ func (c *Conn) loadSession(hello *clientHelloMsg) (
 	// Check that the cached server certificate is not expired, and that it's
 	// valid for the ServerName. This should be ensured by the cache key, but
 	// protect the application from a faulty ClientSessionCache implementation.
+	if c.config.time().After(session.peerCertificates[0].NotAfter) {
+		// Expired certificate, delete the entry.
+		c.config.ClientSessionCache.Put(cacheKey, nil)
+		return nil, nil, nil, nil
+	}
 	if !c.config.InsecureSkipVerify {
 		if len(session.verifiedChains) == 0 {
 			// The original connection had InsecureSkipVerify, while this doesn't.
 			return nil, nil, nil, nil
 		}
-		serverCert := session.peerCertificates[0]
-		if c.config.time().After(serverCert.NotAfter) {
-			// Expired certificate, delete the entry.
-			c.config.ClientSessionCache.Put(cacheKey, nil)
-			return nil, nil, nil, nil
-		}
-		if err := serverCert.VerifyHostname(c.config.ServerName); err != nil {
+		if err := session.peerCertificates[0].VerifyHostname(c.config.ServerName); err != nil {
 			return nil, nil, nil, nil
 		}
 	}
diff --git a/src/crypto/tls/handshake_messages_test.go b/src/crypto/tls/handshake_messages_test.go
index a39cb14301..224e17296f 100644
--- a/src/crypto/tls/handshake_messages_test.go
+++ b/src/crypto/tls/handshake_messages_test.go
@@ -377,10 +377,7 @@ func (*SessionState) Generate(rand *rand.Rand, size int) reflect.Value {
 			s.scts = append(s.scts, randomBytes(rand.Intn(500)+1, rand))
 		}
 	}
-	if rand.Intn(10) > 5 && s.EarlyData {
-		s.alpnProtocol = string(randomBytes(rand.Intn(10), rand))
-	}
-	if s.isClient {
+	if len(s.peerCertificates) > 0 {
 		for i := 0; i < rand.Intn(3); i++ {
 			if rand.Intn(10) > 5 {
 				s.verifiedChains = append(s.verifiedChains, s.peerCertificates)
@@ -388,6 +385,11 @@ func (*SessionState) Generate(rand *rand.Rand, size int) reflect.Value {
 				s.verifiedChains = append(s.verifiedChains, s.peerCertificates[:1])
 			}
 		}
+	}
+	if rand.Intn(10) > 5 && s.EarlyData {
+		s.alpnProtocol = string(randomBytes(rand.Intn(10), rand))
+	}
+	if s.isClient {
 		if isTLS13 {
 			s.useBy = uint64(rand.Int63())
 			s.ageAdd = uint32(rand.Int63() & math.MaxUint32)
diff --git a/src/crypto/tls/handshake_server.go b/src/crypto/tls/handshake_server.go
index a81ecb7f44..0f2571a7f3 100644
--- a/src/crypto/tls/handshake_server.go
+++ b/src/crypto/tls/handshake_server.go
@@ -471,6 +471,13 @@ func (hs *serverHandshakeState) checkForResumption() error {
 	if sessionHasClientCerts && c.config.ClientAuth == NoClientCert {
 		return nil
 	}
+	if sessionHasClientCerts && c.config.time().After(sessionState.peerCertificates[0].NotAfter) {
+		return nil
+	}
+	if sessionHasClientCerts && c.config.ClientAuth >= VerifyClientCertIfGiven &&
+		len(sessionState.verifiedChains) == 0 {
+		return nil
+	}
 
 	// RFC 7627, Section 5.3
 	if !sessionState.extMasterSecret && hs.clientHello.extendedMasterSecret {
@@ -482,6 +489,10 @@ func (hs *serverHandshakeState) checkForResumption() error {
 		return errors.New("tls: session supported extended_master_secret but client does not")
 	}
 
+	c.peerCertificates = sessionState.peerCertificates
+	c.ocspResponse = sessionState.ocspResponse
+	c.scts = sessionState.scts
+	c.verifiedChains = sessionState.verifiedChains
 	c.extMasterSecret = sessionState.extMasterSecret
 	hs.sessionState = sessionState
 	hs.suite = suite
@@ -510,10 +521,6 @@ func (hs *serverHandshakeState) doResumeHandshake() error {
 		return err
 	}
 
-	if err := c.processCertsFromClient(hs.sessionState.certificate()); err != nil {
-		return err
-	}
-
 	if c.config.VerifyConnection != nil {
 		if err := c.config.VerifyConnection(c.connectionStateLocked()); err != nil {
 			c.sendAlert(alertBadCertificate)
@@ -847,8 +854,7 @@ func (hs *serverHandshakeState) sendFinished(out []byte) error {
 }
 
 // processCertsFromClient takes a chain of client certificates either from a
-// Certificates message or from a sessionState and verifies them. It returns
-// the public key of the leaf certificate.
+// Certificates message and verifies them.
 func (c *Conn) processCertsFromClient(certificate Certificate) error {
 	certificates := certificate.Certificate
 	certs := make([]*x509.Certificate, len(certificates))
diff --git a/src/crypto/tls/handshake_server_tls13.go b/src/crypto/tls/handshake_server_tls13.go
index 7cc93c0678..07b1a3851e 100644
--- a/src/crypto/tls/handshake_server_tls13.go
+++ b/src/crypto/tls/handshake_server_tls13.go
@@ -335,6 +335,13 @@ func (hs *serverHandshakeStateTLS13) checkForResumption() error {
 		if sessionHasClientCerts && c.config.ClientAuth == NoClientCert {
 			continue
 		}
+		if sessionHasClientCerts && c.config.time().After(sessionState.peerCertificates[0].NotAfter) {
+			continue
+		}
+		if sessionHasClientCerts && c.config.ClientAuth >= VerifyClientCertIfGiven &&
+			len(sessionState.verifiedChains) == 0 {
+			continue
+		}
 
 		hs.earlySecret = hs.suite.extract(sessionState.secret, nil)
 		binderKey := hs.suite.deriveSecret(hs.earlySecret, resumptionBinderLabel, nil)
@@ -370,9 +377,10 @@ func (hs *serverHandshakeStateTLS13) checkForResumption() error {
 		}
 
 		c.didResume = true
-		if err := c.processCertsFromClient(sessionState.certificate()); err != nil {
-			return err
-		}
+		c.peerCertificates = sessionState.peerCertificates
+		c.ocspResponse = sessionState.ocspResponse
+		c.scts = sessionState.scts
+		c.verifiedChains = sessionState.verifiedChains
 
 		hs.hello.selectedIdentityPresent = true
 		hs.hello.selectedIdentity = uint16(i)
diff --git a/src/crypto/tls/testdata/Server-TLSv10-ExportKeyingMaterial b/src/crypto/tls/testdata/Server-TLSv10-ExportKeyingMaterial
index f7ed87e11d..b3d0f7d05b 100644
--- a/src/crypto/tls/testdata/Server-TLSv10-ExportKeyingMaterial
+++ b/src/crypto/tls/testdata/Server-TLSv10-ExportKeyingMaterial
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 55 01 00 00  51 03 01 54 7a 09 27 8a  |....U...Q..Tz.'.|
-00000010  6a c8 54 3b 44 9b c7 56  8b 5c 7d 93 28 f9 06 f2  |j.T;D..V.\}.(...|
-00000020  73 7a a8 0b cd 80 1f 84  2c 3d 60 00 00 04 c0 14  |sz......,=`.....|
+00000000  16 03 01 00 55 01 00 00  51 03 01 e0 8d 7b f2 8d  |....U...Q....{..|
+00000010  45 9f c5 40 1b be 81 05  a1 83 82 c1 54 4a c7 1c  |E..@........TJ..|
+00000020  f1 f8 d5 6c 7a ff 93 81  e2 a2 ba 00 00 04 c0 14  |...lz...........|
 00000030  00 ff 01 00 00 24 00 0b  00 04 03 00 01 02 00 0a  |.....$..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000050  00 00 00 16 00 00 00 17  00 00                    |..........|
@@ -51,41 +51,42 @@
 000002a0  fa e7 16 03 01 00 aa 0c  00 00 a6 03 00 1d 20 2f  |.............. /|
 000002b0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 000002c0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 00  |.........._X.;t.|
-000002d0  80 1c 79 dd 1e c2 4d 33  43 41 71 93 aa 0b 1b 64  |..y...M3CAq....d|
-000002e0  b7 77 7a 10 f4 84 11 c6  be 76 31 9f 21 77 d7 96  |.wz......v1.!w..|
-000002f0  c4 f5 8a 9d 33 88 16 12  1c 76 0b e5 a6 d5 78 f5  |....3....v....x.|
-00000300  71 a0 2d bc 42 48 eb 2f  ae e2 04 6b 9f 99 fe fb  |q.-.BH./...k....|
-00000310  76 a7 a2 ae 0e d3 c8 44  16 6a bd 64 1e 3f 5d a5  |v......D.j.d.?].|
-00000320  14 8a 3a 48 55 d5 f7 3e  17 63 bc 03 60 81 3c 7c  |..:HU..>.c..`.<||
-00000330  a4 20 0d ad 6d 0e 5b 36  b7 56 66 16 d4 45 16 8e  |. ..m.[6.Vf..E..|
-00000340  21 e5 b2 9a 90 3c a6 00  ed 06 55 51 a6 d4 e4 19  |!....<....UQ....|
-00000350  b2 16 03 01 00 04 0e 00  00 00                    |..........|
+000002d0  80 3d ff b7 ad d5 15 4f  10 6e 8a d2 ad 8a 6b 1b  |.=.....O.n....k.|
+000002e0  9d 6c f2 92 99 c7 d7 d8  07 d5 c7 77 09 22 41 4f  |.l.........w."AO|
+000002f0  7f ca 3e 8c 22 ba 2b f2  75 5f 47 c9 7e 0c 03 5d  |..>.".+.u_G.~..]|
+00000300  1a 66 c3 c8 f3 76 f0 f6  fa 03 40 3a 9b e7 2b 35  |.f...v....@:..+5|
+00000310  bc c7 5e 62 a6 97 8a 1a  17 e3 13 4c 1f 88 39 2a  |..^b.......L..9*|
+00000320  5b cc 9c 65 df 27 1e b3  26 d7 46 3e 76 a9 ae 71  |[..e.'..&.F>v..q|
+00000330  11 4d d6 10 b4 2e 30 37  a1 b4 ff 46 91 77 c7 4c  |.M....07...F.w.L|
+00000340  f9 8e e3 96 88 d2 1e c5  9d fb a1 be c6 ef 5d f0  |..............].|
+00000350  52 16 03 01 00 04 0e 00  00 00                    |R.........|
 >>> Flow 3 (client to server)
-00000000  16 03 01 00 25 10 00 00  21 20 4e 3c 5d a0 70 52  |....%...! N<].pR|
-00000010  39 c7 cf 06 d5 18 38 ea  ce fc 7e 07 51 29 35 d8  |9.....8...~.Q)5.|
-00000020  02 86 f0 b9 5f e8 f3 e1  69 42 14 03 01 00 01 01  |...._...iB......|
-00000030  16 03 01 00 30 92 c0 29  1c 92 81 52 96 d9 aa 71  |....0..)...R...q|
-00000040  21 0a 3b 12 f3 48 8f 7b  50 2d c2 6c 3d ac 34 bc  |!.;..H.{P-.l=.4.|
-00000050  1b fb 66 72 75 90 4a bb  d1 26 b8 e8 73 c4 b1 e1  |..fru.J..&..s...|
-00000060  93 84 4f bc 2e                                    |..O..|
+00000000  16 03 01 00 25 10 00 00  21 20 01 39 8b 2b 21 99  |....%...! .9.+!.|
+00000010  fd fc b8 20 f1 51 97 c7  85 13 05 64 55 41 6b c4  |... .Q.....dUAk.|
+00000020  1a 5e d5 b2 7c 8b 31 08  0f 78 14 03 01 00 01 01  |.^..|.1..x......|
+00000030  16 03 01 00 30 d8 3b e6  9f f8 a8 b2 6b 8b fb 89  |....0.;.....k...|
+00000040  71 3b 55 cd c3 c9 78 3c  45 1b 8d 5f 70 4f bd 64  |q;U...x<E.._pO.d|
+00000050  a9 d1 c0 4d ce 34 e1 f9  d2 90 c9 49 b0 1f a3 76  |...M.4.....I...v|
+00000060  bd f4 78 d0 43                                    |..x.C|
 >>> Flow 4 (server to client)
-00000000  16 03 01 00 80 04 00 00  7c 00 00 00 00 00 76 00  |........|.....v.|
+00000000  16 03 01 00 83 04 00 00  7f 00 00 00 00 00 79 00  |..............y.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6d 2d 70 97 51 ed 14 ef  68 ca 42 c5 4c 29 fc 12  |m-p.Q...h.B.L)..|
-00000030  2f 4c f2 55 c2 71 1b 97  63 9c 43 02 8c a7 b6 ee  |/L.U.q..c.C.....|
-00000040  78 36 ad 58 6d bf 70 41  00 c3 1c ed cb 0f 5d 6a  |x6.Xm.pA......]j|
-00000050  48 3a 50 d3 a3 78 a3 7f  eb d2 31 9e 08 49 38 16  |H:P..x....1..I8.|
-00000060  7e 51 5c e5 15 5f 64 51  2e a8 c5 82 f2 ef 4b 84  |~Q\.._dQ......K.|
-00000070  3a a8 15 aa 2b dd 36 09  8d 69 8b b3 c7 93 d5 5e  |:...+.6..i.....^|
-00000080  d7 da ce 01 82 14 03 01  00 01 01 16 03 01 00 30  |...............0|
-00000090  06 b8 28 f7 0d f0 f1 42  26 da fb ab 14 e7 98 e8  |..(....B&.......|
-000000a0  57 5a 96 30 bd 2c 78 ec  e6 97 92 48 88 9c 72 37  |WZ.0.,x....H..r7|
-000000b0  07 0a 6a d4 b1 15 3d ad  00 85 a6 f5 e4 c0 af 3d  |..j...=........=|
-000000c0  17 03 01 00 20 c0 fd af  d3 7f aa ad 98 8c 5f 97  |.... ........._.|
-000000d0  2e bc 5d b3 03 9e a7 e0  be 34 b9 00 16 c3 ac cd  |..]......4......|
-000000e0  f8 96 13 e3 32 17 03 01  00 30 00 a0 d4 64 67 56  |....2....0...dgV|
-000000f0  6f 88 35 a8 d7 13 18 43  1c 59 a7 45 70 99 64 01  |o.5....C.Y.Ep.d.|
-00000100  4f c5 df af 6d ff b8 7d  31 0c df 78 e8 bd 97 50  |O...m..}1..x...P|
-00000110  bd f9 b9 37 e4 09 0a 7e  36 b5 15 03 01 00 20 42  |...7...~6..... B|
-00000120  a0 51 1b ea ea 31 3c 2c  b3 4a 47 9f 4a a0 29 8d  |.Q...1<,.JG.J.).|
-00000130  b7 2c 50 7b 5e a4 ee 12  33 9c 6f 67 aa 24 80     |.,P{^...3.og.$.|
+00000020  6d 2d 70 97 51 ed 14 ef  68 ca 42 c5 4c 71 8e 74  |m-p.Q...h.B.Lq.t|
+00000030  d4 83 d6 4a 5b 69 f8 af  61 3a 98 83 19 d5 7c 60  |...J[i..a:....|`|
+00000040  4a 1e f4 b7 26 b8 99 b5  45 6f a3 8d 97 63 5f 1b  |J...&...Eo...c_.|
+00000050  ab f4 84 59 db ce 99 ce  b8 6a 23 d5 15 49 38 16  |...Y.....j#..I8.|
+00000060  7e 51 5c e5 15 c0 58 7d  c0 ee 59 1b e4 6e 1f c8  |~Q\...X}..Y..n..|
+00000070  fc d4 2c 33 ed 0a 2b e0  78 04 64 4b 56 e4 af 61  |..,3..+.x.dKV..a|
+00000080  c6 b5 7d f5 a0 86 9f e3  14 03 01 00 01 01 16 03  |..}.............|
+00000090  01 00 30 73 2b f0 16 d3  a8 02 b3 73 98 5e 4e a0  |..0s+......s.^N.|
+000000a0  ca 5b c4 50 fb 5a 92 11  43 97 e9 e3 16 9f 08 0a  |.[.P.Z..C.......|
+000000b0  56 73 e6 44 67 70 aa 3d  bb c1 36 c8 63 1c 2b 51  |Vs.Dgp.=..6.c.+Q|
+000000c0  1f 3b 81 17 03 01 00 20  4c 93 10 5c 01 e2 63 12  |.;..... L..\..c.|
+000000d0  97 6b e1 89 fb e7 14 cf  ec 70 d1 fe 6f ea 8b 09  |.k.......p..o...|
+000000e0  63 5f 8c 8a 9e b5 ac b8  17 03 01 00 30 a1 ad dd  |c_..........0...|
+000000f0  92 ac a8 6e 77 ed c2 ed  59 b6 a8 41 ad 45 59 8c  |...nw...Y..A.EY.|
+00000100  4e 1d 16 36 57 e6 2f 47  3d 10 0f 36 04 00 b0 c1  |N..6W./G=..6....|
+00000110  a7 94 25 8e 77 1e 69 20  41 6c c0 9d 26 15 03 01  |..%.w.i Al..&...|
+00000120  00 20 c5 83 26 5d 20 cb  16 7e 27 63 d7 96 aa 96  |. ..&] ..~'c....|
+00000130  37 19 2a 7a 18 d4 85 08  25 32 85 d5 b5 e3 4e 9b  |7.*z....%2....N.|
+00000140  98 f5                                             |..|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ALPN b/src/crypto/tls/testdata/Server-TLSv12-ALPN
index 0f4d5ce2c5..ccd4a086a6 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ALPN
+++ b/src/crypto/tls/testdata/Server-TLSv12-ALPN
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 9d 01 00 00  99 03 03 a6 c5 fc 08 ce  |................|
-00000010  f9 05 f6 4b 12 1e 20 ca  fc b6 02 b7 67 bb 79 28  |...K.. .....g.y(|
-00000020  05 83 47 61 c3 6a f6 de  ad 77 fa 00 00 04 cc a8  |..Ga.j...w......|
+00000000  16 03 01 00 9d 01 00 00  99 03 03 f7 12 13 92 75  |...............u|
+00000010  34 ab f3 e8 a2 19 2d 3c  0c 8b 9e c3 e8 22 7e d8  |4.....-<....."~.|
+00000020  66 f9 08 88 70 9b cc 37  95 43 a7 00 00 04 cc a8  |f...p..7.C......|
 00000030  00 ff 01 00 00 6c 00 0b  00 04 03 00 01 02 00 0a  |.....l..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000050  00 00 00 10 00 10 00 0e  06 70 72 6f 74 6f 32 06  |.........proto2.|
@@ -57,35 +57,35 @@
 000002b0  03 03 00 ac 0c 00 00 a8  03 00 1d 20 2f e5 7d a3  |........... /.}.|
 000002c0  47 cd 62 43 15 28 da ac  5f bb 29 07 30 ff f6 84  |G.bC.(.._.).0...|
 000002d0  af c4 cf c2 ed 90 99 5f  58 cb 3b 74 08 04 00 80  |......._X.;t....|
-000002e0  c9 8f 67 ae 81 28 f7 3e  16 8b ad 1c a9 2a 88 e8  |..g..(.>.....*..|
-000002f0  1d ab 73 44 7f cf 6f 79  9c 31 d6 74 35 cf 01 3c  |..sD..oy.1.t5..<|
-00000300  c6 72 5f 2c e3 f8 83 13  f0 49 28 82 12 2d b4 f3  |.r_,.....I(..-..|
-00000310  1a 38 e2 cf 6f 78 5e 4c  22 29 ca e3 3a 72 74 80  |.8..ox^L")..:rt.|
-00000320  18 41 59 b7 99 6c 0a 2e  32 75 9a d0 a5 88 48 ff  |.AY..l..2u....H.|
-00000330  5c 85 bc c7 ea ad 0b db  81 f0 86 56 fb e9 3a fd  |\..........V..:.|
-00000340  7e 6a 7e 09 b0 b6 bf 28  14 40 e6 93 50 56 96 41  |~j~....(.@..PV.A|
-00000350  27 ae 72 f6 5e 67 a6 f3  73 f7 0a 13 f1 a3 72 07  |'.r.^g..s.....r.|
+000002e0  2a 3d 85 27 96 fe 41 e2  5a cc 39 dd 8a 8e 64 73  |*=.'..A.Z.9...ds|
+000002f0  ef 98 04 5c ac d2 8f 5e  55 b8 37 da 10 68 33 b8  |...\...^U.7..h3.|
+00000300  63 83 e1 c9 9a e6 3a e9  c9 20 cc 57 58 e2 ba bc  |c.....:.. .WX...|
+00000310  e3 ac ab aa 08 e2 1e 6f  66 90 d7 66 c5 73 60 0d  |.......of..f.s`.|
+00000320  19 4f eb 99 9d d1 b1 91  36 80 b9 20 aa f5 d9 c8  |.O......6.. ....|
+00000330  44 a7 99 c9 a6 4d 2c ff  ca 4d 84 f2 a5 bf 02 c5  |D....M,..M......|
+00000340  61 77 7e 4a e6 7c dd bf  48 fc a6 53 fb c4 d3 dd  |aw~J.|..H..S....|
+00000350  e6 20 b9 74 90 82 4a 3a  73 0a 81 74 07 a3 23 fe  |. .t..J:s..t..#.|
 00000360  16 03 03 00 04 0e 00 00  00                       |.........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 ee 14 87 73 f6 c2  |....%...! ...s..|
-00000010  57 7e ba c4 1e 06 fc 75  c6 2b 1a 45 96 58 90 95  |W~.....u.+.E.X..|
-00000020  1e f6 53 ac 10 ff 1c 0b  b2 4d 14 03 03 00 01 01  |..S......M......|
-00000030  16 03 03 00 20 87 9a d0  7f 4c 68 fc cd 3e b8 20  |.... ....Lh..>. |
-00000040  d3 b8 a0 ec 05 ad 95 62  81 b3 12 2a 8b 44 7b 87  |.......b...*.D{.|
-00000050  02 10 38 5d 69                                    |..8]i|
+00000000  16 03 03 00 25 10 00 00  21 20 d1 bb f1 17 6c 41  |....%...! ....lA|
+00000010  8f 14 84 d2 98 99 30 0c  8a 00 4c 39 37 15 f5 be  |......0...L97...|
+00000020  81 8d 08 e0 11 c1 f7 65  43 0b 14 03 03 00 01 01  |.......eC.......|
+00000030  16 03 03 00 20 ab 15 bb  47 30 42 c9 7d 45 f8 5d  |.... ...G0B.}E.]|
+00000040  21 79 3b 4d 5e a9 99 f5  7d f3 4e 7e ba b9 9b 30  |!y;M^...}.N~...0|
+00000050  b6 14 4d ba f9                                    |..M..|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 80 04 00 00  7c 00 00 00 00 00 76 00  |........|.....v.|
+00000000  16 03 03 00 83 04 00 00  7f 00 00 00 00 00 79 00  |..............y.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6f 2d 7c 2b 51 ed 14 ef  68 ca 42 c5 4c b7 9e 73  |o-|+Q...h.B.L..s|
-00000030  16 d7 10 08 ee 88 f3 cb  b4 9b 8b 3e 0e 11 25 cd  |...........>..%.|
-00000040  d4 79 4e 37 40 c0 79 b5  c3 e7 9e 6c 8e 99 82 5c  |.yN7@.y....l...\|
-00000050  37 24 63 9d 51 31 a6 81  df 1a ac c4 b8 49 38 16  |7$c.Q1.......I8.|
-00000060  7e 51 5c e5 15 b7 7c 06  f0 8a b8 23 a8 9d 31 cb  |~Q\...|....#..1.|
-00000070  8c 75 6b 29 1a 0d 32 7c  0e 83 b9 7c c2 3d d3 21  |.uk)..2|...|.=.!|
-00000080  8d c5 39 13 65 14 03 03  00 01 01 16 03 03 00 20  |..9.e.......... |
-00000090  7f 38 81 32 20 9d 0e 82  26 08 c4 88 f5 37 74 4b  |.8.2 ...&....7tK|
-000000a0  88 4a 5d d1 b6 53 c7 bd  55 52 98 fe 6e 6b 33 43  |.J]..S..UR..nk3C|
-000000b0  17 03 03 00 1d ab 3c 7c  04 f4 0c d0 fa 7e 95 ca  |......<|.....~..|
-000000c0  19 d6 e8 ed 23 e9 9d 51  fd 9f d7 46 8d a9 88 4e  |....#..Q...F...N|
-000000d0  3c 9c 15 03 03 00 12 bc  63 86 67 57 a5 a2 48 f5  |<.......c.gW..H.|
-000000e0  1c 57 b6 b2 13 45 cd de  ce                       |.W...E...|
+00000020  6f 2d 7c 2b 51 ed 14 ef  68 ca 42 c5 4c f3 5c b9  |o-|+Q...h.B.L.\.|
+00000030  84 7d 30 9e 2f 9d 4d 0e  59 b4 28 fd 17 10 cd 1e  |.}0./.M.Y.(.....|
+00000040  1c d3 2c 5e d9 dc db 26  d0 b9 00 4b 0a 13 54 90  |..,^...&...K..T.|
+00000050  f2 7b 68 75 6b 00 34 66  9e 43 29 06 16 49 38 16  |.{huk.4f.C)..I8.|
+00000060  7e 51 5c e5 15 c0 58 7d  52 0b 16 21 d8 2c e8 c8  |~Q\...X}R..!.,..|
+00000070  8e 3a f6 aa fa 21 45 4a  17 02 67 7d 93 1c 95 88  |.:...!EJ..g}....|
+00000080  36 a5 19 53 74 74 81 e1  14 03 03 00 01 01 16 03  |6..Stt..........|
+00000090  03 00 20 3d 66 04 37 0c  40 cc 20 2c 1c 16 ba 05  |.. =f.7.@. ,....|
+000000a0  d6 7b 40 04 27 40 6f cc  d7 af 68 fb 32 49 6c 4f  |.{@.'@o...h.2IlO|
+000000b0  f3 01 bf 17 03 03 00 1d  99 10 78 bc fa 7e 8a 86  |..........x..~..|
+000000c0  4c b8 e4 7c e2 79 70 eb  ad 33 44 e1 ab 7a c9 ae  |L..|.yp..3D..z..|
+000000d0  47 fe 39 50 d1 15 03 03  00 12 9e 9a be b0 55 c3  |G.9P..........U.|
+000000e0  3a 5f 5c e0 4b 8f 4f 81  52 d3 89 09              |:_\.K.O.R...|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ALPN-Fallback b/src/crypto/tls/testdata/Server-TLSv12-ALPN-Fallback
index 9244c64020..070201253d 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ALPN-Fallback
+++ b/src/crypto/tls/testdata/Server-TLSv12-ALPN-Fallback
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 a6 01 00 00  a2 03 03 40 f1 55 72 dd  |...........@.Ur.|
-00000010  4a 11 8b ff 4f cd ec 75  a9 28 03 29 66 e5 8b 6d  |J...O..u.(.)f..m|
-00000020  a0 15 6c 01 4d d3 ff aa  40 09 45 00 00 04 cc a8  |..l.M...@.E.....|
+00000000  16 03 01 00 a6 01 00 00  a2 03 03 ea e2 1b 90 0e  |................|
+00000010  91 d5 9f b2 c6 ee 72 37  19 f5 14 cd ca a9 ca 03  |......r7........|
+00000020  98 c4 2e d4 85 05 4a a5  02 e1 4b 00 00 04 cc a8  |......J...K.....|
 00000030  00 ff 01 00 00 75 00 0b  00 04 03 00 01 02 00 0a  |.....u..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000050  00 00 00 10 00 19 00 17  06 70 72 6f 74 6f 33 08  |.........proto3.|
@@ -56,35 +56,35 @@
 000002a0  fa e7 16 03 03 00 ac 0c  00 00 a8 03 00 1d 20 2f  |.............. /|
 000002b0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 000002c0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 08  |.........._X.;t.|
-000002d0  04 00 80 4b b5 2e d8 fe  df e8 2f 59 a5 b6 f8 67  |...K....../Y...g|
-000002e0  6d ee 2c 23 cf 0e 57 02  2e 60 a2 a7 db 35 ea 1b  |m.,#..W..`...5..|
-000002f0  e2 e9 33 d5 d0 4e 34 82  e1 d2 96 7b a6 df ae 06  |..3..N4....{....|
-00000300  19 d4 4f f5 f1 92 6b 7e  54 44 45 5b 67 7d 45 a9  |..O...k~TDE[g}E.|
-00000310  7d 22 03 79 5c 59 63 47  4c dc 0b b2 c8 fb dc 40  |}".y\YcGL......@|
-00000320  6c 26 01 1e 15 96 e7 af  65 59 8b f3 18 70 02 d0  |l&......eY...p..|
-00000330  22 6c c3 7c 0e 10 3d 7d  e1 40 9e 6b 40 ba 53 14  |"l.|..=}.@.k@.S.|
-00000340  e7 18 99 e2 02 80 82 fe  f3 58 47 fc 18 f7 b6 f9  |.........XG.....|
-00000350  e2 ee 8f 16 03 03 00 04  0e 00 00 00              |............|
+000002d0  04 00 80 85 e9 a6 5c 79  bc db ed 97 fb 30 ca fd  |......\y.....0..|
+000002e0  32 13 19 3f da 6f fd c1  11 74 fe e9 6f 60 ec 7e  |2..?.o...t..o`.~|
+000002f0  48 7e 17 33 9b 8d 2a c2  82 e0 18 38 f3 0f 20 27  |H~.3..*....8.. '|
+00000300  81 0f c9 47 bf 5f 2b 2f  65 1c 6b e3 b7 72 85 46  |...G._+/e.k..r.F|
+00000310  5c 15 dc fd e6 be cf 50  51 62 f5 d9 17 e2 e8 bf  |\......PQb......|
+00000320  08 7f 37 71 91 88 83 7f  e3 90 66 66 c4 d8 60 25  |..7q......ff..`%|
+00000330  53 f7 9f 44 20 89 48 ff  c2 3b 6d 21 e5 8c dc e5  |S..D .H..;m!....|
+00000340  42 ea d8 14 93 96 2f 53  24 66 e7 bb e7 2c 1f 92  |B...../S$f...,..|
+00000350  90 80 23 16 03 03 00 04  0e 00 00 00              |..#.........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 e0 2a c3 46 00 e5  |....%...! .*.F..|
-00000010  28 34 4d 1c 76 94 ed 60  59 7e 26 bc 21 79 3b 5b  |(4M.v..`Y~&.!y;[|
-00000020  5e 7f 7a a1 4d d0 2f 84  54 43 14 03 03 00 01 01  |^.z.M./.TC......|
-00000030  16 03 03 00 20 27 f7 34  df 13 09 d2 f3 a8 58 81  |.... '.4......X.|
-00000040  8e 76 a3 2c bc de 9e 63  35 23 e8 f2 4f b9 fe 87  |.v.,...c5#..O...|
-00000050  03 a9 ea a0 d2                                    |.....|
+00000000  16 03 03 00 25 10 00 00  21 20 e8 d1 46 5e 70 b5  |....%...! ..F^p.|
+00000010  34 1c 6f cd be f0 86 24  2a d6 55 ae 97 de 52 0c  |4.o....$*.U...R.|
+00000020  67 10 a0 02 ed ae f8 47  aa 52 14 03 03 00 01 01  |g......G.R......|
+00000030  16 03 03 00 20 52 cf 5d  07 bb bc e8 86 d4 f4 3e  |.... R.].......>|
+00000040  49 51 a7 1d f5 df 10 c4  5a 77 37 ba 68 3d 4e c5  |IQ......Zw7.h=N.|
+00000050  11 ac 67 b7 e2                                    |..g..|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 80 04 00 00  7c 00 00 00 00 00 76 00  |........|.....v.|
+00000000  16 03 03 00 83 04 00 00  7f 00 00 00 00 00 79 00  |..............y.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6f 2d 7c 2b 51 ed 14 ef  68 ca 42 c5 4c 7c 43 02  |o-|+Q...h.B.L|C.|
-00000030  c6 f9 9f 1a c5 53 30 68  99 91 40 78 8a f6 18 b8  |.....S0h..@x....|
-00000040  fb 1c 67 68 95 4a 5b a1  a0 33 c4 7b 36 4f 0d ce  |..gh.J[..3.{6O..|
-00000050  a7 4c 14 89 e6 95 91 c7  3e 72 bb 28 c4 49 38 16  |.L......>r.(.I8.|
-00000060  7e 51 5c e5 15 83 cc 8c  63 6a 1b 6a 9f b3 7b 0d  |~Q\.....cj.j..{.|
-00000070  e3 9e 11 c5 96 5f fa 49  c8 a1 9d 35 9c 04 e5 9c  |....._.I...5....|
-00000080  11 0f 1c 24 f3 14 03 03  00 01 01 16 03 03 00 20  |...$........... |
-00000090  20 03 ef d8 1a 87 3b ef  d1 75 7c c9 9e 21 b6 3b  | .....;..u|..!.;|
-000000a0  21 ba 1d 1b 64 b5 bd d1  9d e2 22 a0 5a ab d8 25  |!...d.....".Z..%|
-000000b0  17 03 03 00 1d 2b d3 28  04 97 7d 77 3a e6 9b 5e  |.....+.(..}w:..^|
-000000c0  e4 d2 6c 5c 7c 94 6f ef  c3 59 c7 51 60 d7 2c 9e  |..l\|.o..Y.Q`.,.|
-000000d0  e6 a7 15 03 03 00 12 31  7e 0c f2 2f 2e 1f e9 60  |.......1~../...`|
-000000e0  49 1a cd 8c 40 13 ce 16  47                       |I...@...G|
+00000020  6f 2d 7c 2b 51 ed 14 ef  68 ca 42 c5 4c 26 1d 23  |o-|+Q...h.B.L&.#|
+00000030  c4 90 54 85 8b 21 f5 0d  e8 48 f2 5f 4e 6b f1 25  |..T..!...H._Nk.%|
+00000040  e8 46 8a e5 3c 09 57 df  dd 37 a7 57 c5 a5 28 5a  |.F..<.W..7.W..(Z|
+00000050  21 83 2a 98 4b a5 44 aa  5b cc 30 e9 62 49 38 16  |!.*.K.D.[.0.bI8.|
+00000060  7e 51 5c e5 15 c0 58 7d  a4 aa c5 93 39 bb e2 b6  |~Q\...X}....9...|
+00000070  4f c4 3e 1e 03 dc 46 b1  f3 0d d2 61 6c 1e c5 e1  |O.>...F....al...|
+00000080  8f 18 2a 3c 85 83 c4 33  14 03 03 00 01 01 16 03  |..*<...3........|
+00000090  03 00 20 63 76 4f b3 77  4d 63 6c eb 73 f3 b2 ec  |.. cvO.wMcl.s...|
+000000a0  b8 49 3e c5 81 d5 53 0c  96 77 2f 3f 52 d0 e1 5b  |.I>...S..w/?R..[|
+000000b0  62 fa 0b 17 03 03 00 1d  2f 60 09 31 db e9 c5 23  |b......./`.1...#|
+000000c0  98 5c 46 23 a6 58 80 66  7d 50 84 f1 42 b8 65 65  |.\F#.X.f}P..B.ee|
+000000d0  77 2d d2 e4 be 15 03 03  00 12 b7 e8 e1 13 04 68  |w-.............h|
+000000e0  d5 21 c8 98 db 1b 1c 6e  4f b5 0b 9c              |.!.....nO...|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ALPN-NotConfigured b/src/crypto/tls/testdata/Server-TLSv12-ALPN-NotConfigured
index 6e33c8413b..79f0748af4 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ALPN-NotConfigured
+++ b/src/crypto/tls/testdata/Server-TLSv12-ALPN-NotConfigured
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 9d 01 00 00  99 03 03 bb e1 68 3f af  |.............h?.|
-00000010  af fa ac f8 b0 88 0d 9f  2f a0 8b fe fd 50 a7 b4  |......../....P..|
-00000020  63 b7 05 84 8a 57 f0 cf  9d 26 79 00 00 04 cc a8  |c....W...&y.....|
+00000000  16 03 01 00 9d 01 00 00  99 03 03 19 26 ad 3f c0  |............&.?.|
+00000010  d6 a0 cc ac 9b 2a 91 d3  1a d5 96 78 5f 7c 3f e0  |.....*.....x_|?.|
+00000020  23 08 75 a1 ca cb aa da  d7 c8 0b 00 00 04 cc a8  |#.u.............|
 00000030  00 ff 01 00 00 6c 00 0b  00 04 03 00 01 02 00 0a  |.....l..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000050  00 00 00 10 00 10 00 0e  06 70 72 6f 74 6f 32 06  |.........proto2.|
@@ -56,35 +56,35 @@
 000002a0  fa e7 16 03 03 00 ac 0c  00 00 a8 03 00 1d 20 2f  |.............. /|
 000002b0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 000002c0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 08  |.........._X.;t.|
-000002d0  04 00 80 88 15 8c 7d 2f  f5 a0 bf c4 75 b1 10 75  |......}/....u..u|
-000002e0  2c d7 0a 24 c5 49 dd bc  05 6f d7 ea d0 8f 7f af  |,..$.I...o......|
-000002f0  d3 5e f7 ba 3f 75 90 24  e0 9a 7d 4b 90 ba c6 3d  |.^..?u.$..}K...=|
-00000300  34 68 1c 0f 26 50 d9 96  a4 23 18 61 e9 80 a5 b4  |4h..&P...#.a....|
-00000310  a1 3f 48 ad 57 e3 e2 2c  d8 7d 81 b0 5b 6b 05 61  |.?H.W..,.}..[k.a|
-00000320  3f b4 82 9b b5 ca 74 f6  8c ad f9 67 05 c9 2d d2  |?.....t....g..-.|
-00000330  50 cc 5a dc c1 d6 10 30  08 20 a8 42 84 58 76 7d  |P.Z....0. .B.Xv}|
-00000340  2b b8 47 bd 48 ef a6 4b  bc 3d d5 fc e9 c3 6c b5  |+.G.H..K.=....l.|
-00000350  e0 dc 37 16 03 03 00 04  0e 00 00 00              |..7.........|
+000002d0  04 00 80 4f 9e 64 41 a6  8a 41 ab 9c c8 09 3e 94  |...O.dA..A....>.|
+000002e0  ee d2 9b ad 1b 3e a9 3c  7b 43 96 95 eb 4d b5 04  |.....>.<{C...M..|
+000002f0  1a 5f 0c b2 b3 a6 2c a4  e6 78 a8 b8 d5 6c 7f d0  |._....,..x...l..|
+00000300  16 e8 56 31 e0 4a 69 d3  6b 27 18 a3 4e f5 d1 6a  |..V1.Ji.k'..N..j|
+00000310  36 15 b5 fc 4d 15 50 90  a0 30 b9 49 3d ac 8c 84  |6...M.P..0.I=...|
+00000320  d2 15 31 70 df e5 a6 97  d0 64 f7 1d 8a a1 87 4d  |..1p.....d.....M|
+00000330  3c ee da 69 20 e4 31 67  ca f2 c0 09 ee 13 7c 78  |<..i .1g......|x|
+00000340  d6 c2 c0 39 e0 b8 00 52  a9 bf d0 99 e0 b0 66 70  |...9...R......fp|
+00000350  46 ae 62 16 03 03 00 04  0e 00 00 00              |F.b.........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 7d 65 94 48 54 1f  |....%...! }e.HT.|
-00000010  8c 45 6a 7f ce f3 07 72  72 db 07 6e 23 0d 03 d0  |.Ej....rr..n#...|
-00000020  73 e5 2c af 04 5e ca 1d  61 6e 14 03 03 00 01 01  |s.,..^..an......|
-00000030  16 03 03 00 20 18 18 32  97 0c 0c 6a fd 2f f6 68  |.... ..2...j./.h|
-00000040  20 6c 32 b1 8c ff a0 cb  32 3b c3 65 85 15 92 93  | l2.....2;.e....|
-00000050  a5 94 64 93 23                                    |..d.#|
+00000000  16 03 03 00 25 10 00 00  21 20 b0 1a 5b c3 55 5f  |....%...! ..[.U_|
+00000010  0b b8 f3 69 ba 4f 49 93  05 0f b1 f1 d7 6b 6c 0c  |...i.OI......kl.|
+00000020  98 d0 22 78 0c ad 15 6b  24 5b 14 03 03 00 01 01  |.."x...k$[......|
+00000030  16 03 03 00 20 9d aa 3f  17 b3 16 88 d5 44 3d 03  |.... ..?.....D=.|
+00000040  3c 3c 8d 92 f1 2f e4 38  cc 42 20 2f ef 6a 29 c6  |<<.../.8.B /.j).|
+00000050  5c ca 44 81 f6                                    |\.D..|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 80 04 00 00  7c 00 00 00 00 00 76 00  |........|.....v.|
+00000000  16 03 03 00 83 04 00 00  7f 00 00 00 00 00 79 00  |..............y.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6f 2d 7c 2b 51 ed 14 ef  68 ca 42 c5 4c 0e 59 08  |o-|+Q...h.B.L.Y.|
-00000030  69 66 16 50 2d 6e 49 11  fa 71 df 62 61 83 bc 7b  |if.P-nI..q.ba..{|
-00000040  03 f7 96 d1 a4 3d 92 cf  b5 34 22 4b 5d 1f 6c ba  |.....=...4"K].l.|
-00000050  8d 0f db 43 a9 03 31 ac  73 d7 82 6c d9 49 38 16  |...C..1.s..l.I8.|
-00000060  7e 51 5c e5 15 d0 0d 1b  56 38 37 be 4e a1 71 5f  |~Q\.....V87.N.q_|
-00000070  3f 0c 29 04 21 3c 1d 66  d8 cd 39 ef ac 52 f6 18  |?.).!<.f..9..R..|
-00000080  5b fe 00 f0 52 14 03 03  00 01 01 16 03 03 00 20  |[...R.......... |
-00000090  ec bb ff 46 35 98 ea ac  58 8b d3 56 b5 dc 64 c0  |...F5...X..V..d.|
-000000a0  e1 7f 7f f7 7b 4f c3 98  49 50 98 b6 7c b7 99 6f  |....{O..IP..|..o|
-000000b0  17 03 03 00 1d b0 12 26  23 64 99 2f c3 e3 91 e1  |.......&#d./....|
-000000c0  1f 76 af 23 d9 4e d3 d7  8c 0c 5d 3a 17 72 d3 90  |.v.#.N....]:.r..|
-000000d0  2a 63 15 03 03 00 12 f3  cd 6b 69 a3 a7 36 ee 66  |*c.......ki..6.f|
-000000e0  af 8a f0 fe ce 4d 87 f1  98                       |.....M...|
+00000020  6f 2d 7c 2b 51 ed 14 ef  68 ca 42 c5 4c 9a f3 2b  |o-|+Q...h.B.L..+|
+00000030  7a 66 76 26 4f 73 12 14  ef a1 f4 8c c2 08 03 42  |zfv&Os.........B|
+00000040  4d d5 f9 d7 ab 31 78 51  f3 f4 94 49 5f 9d bf 23  |M....1xQ...I_..#|
+00000050  b2 11 7b ac 42 df 71 1a  37 db 64 99 a0 49 38 16  |..{.B.q.7.d..I8.|
+00000060  7e 51 5c e5 15 c0 58 7d  2d 89 ac 0d 05 31 27 ae  |~Q\...X}-....1'.|
+00000070  85 ff 27 56 24 4c 26 b3  bc 6c f6 20 80 dd bd ba  |..'V$L&..l. ....|
+00000080  a3 34 c2 32 a8 58 1b b9  14 03 03 00 01 01 16 03  |.4.2.X..........|
+00000090  03 00 20 74 e1 8a e6 a6  02 0d f7 e1 28 3a f4 c4  |.. t........(:..|
+000000a0  a6 8c 32 81 84 85 ec 58  6a 10 8a 6d c4 cc 10 3a  |..2....Xj..m...:|
+000000b0  32 3e df 17 03 03 00 1d  fd a8 94 23 3e 5d 96 b1  |2>.........#>]..|
+000000c0  68 a6 24 55 bf 29 08 93  c7 7b 9b 05 fc 0b 97 ff  |h.$U.)...{......|
+000000d0  7c 93 b0 34 82 15 03 03  00 12 43 9f 44 e4 63 e7  ||..4......C.D.c.|
+000000e0  3c 30 a5 da 9f 58 ac 01  e4 e2 a7 30              |<0...X.....0|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-ExportKeyingMaterial b/src/crypto/tls/testdata/Server-TLSv12-ExportKeyingMaterial
index 82287bd796..ff8d63568d 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-ExportKeyingMaterial
+++ b/src/crypto/tls/testdata/Server-TLSv12-ExportKeyingMaterial
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 89 01 00 00  85 03 03 65 b1 b6 4f f9  |...........e..O.|
-00000010  88 37 84 e0 26 ed 5d 51  73 d0 ba 3e d9 bc e2 0c  |.7..&.]Qs..>....|
-00000020  58 70 75 a7 9f 1a 1d 40  84 0f 52 00 00 04 c0 14  |Xpu....@..R.....|
+00000000  16 03 01 00 89 01 00 00  85 03 03 ad 13 87 9e b3  |................|
+00000010  c7 71 bb bf be e3 b9 80  3f 17 bf 41 37 95 22 e6  |.q......?..A7.".|
+00000020  f2 98 a9 15 62 1d 65 06  69 ea 53 00 00 04 c0 14  |....b.e.i.S.....|
 00000030  00 ff 01 00 00 58 00 0b  00 04 03 00 01 02 00 0a  |.....X..........|
 00000040  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000050  00 00 00 16 00 00 00 17  00 00 00 0d 00 30 00 2e  |.............0..|
@@ -54,43 +54,43 @@
 000002a0  fa e7 16 03 03 00 ac 0c  00 00 a8 03 00 1d 20 2f  |.............. /|
 000002b0  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 000002c0  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 08  |.........._X.;t.|
-000002d0  04 00 80 51 da 2f 0f fa  db 51 8e 06 0d 04 7e 41  |...Q./...Q....~A|
-000002e0  36 82 13 f0 2b b6 66 fc  7c dd ba 70 e1 bf 9f 9e  |6...+.f.|..p....|
-000002f0  37 2e 10 a5 d1 4c 35 f2  9f 53 83 21 bb db b6 23  |7....L5..S.!...#|
-00000300  11 0d ad f2 84 93 fc b9  34 3e 87 35 ee 01 9b 4d  |........4>.5...M|
-00000310  75 bf f2 7b 84 68 0d b8  89 5e 90 dc 0f 2d 98 85  |u..{.h...^...-..|
-00000320  7f e9 d6 9e 6b 11 74 19  1d bb 1f b4 22 e8 32 b1  |....k.t.....".2.|
-00000330  38 45 c6 d1 b4 8c 8d f2  74 47 46 81 75 f5 e3 65  |8E......tGF.u..e|
-00000340  49 db 72 bd 1f 7a c6 f6  72 e2 a3 2f df b6 4b e9  |I.r..z..r../..K.|
-00000350  49 9f f2 16 03 03 00 04  0e 00 00 00              |I...........|
+000002d0  04 00 80 41 24 c2 f9 e8  40 21 47 3c ab 8e 99 5e  |...A$...@!G<...^|
+000002e0  0e 08 27 86 6c 29 ae 36  ed 21 18 23 67 cc f7 d5  |..'.l).6.!.#g...|
+000002f0  3f e2 2c 48 2f 3d 47 e5  af d5 61 86 0f 91 69 30  |?.,H/=G...a...i0|
+00000300  cf 84 56 f2 d3 c1 9a a3  a1 a2 c8 ef 4d 33 de 12  |..V.........M3..|
+00000310  d6 46 55 5b c6 6a 65 a5  36 b5 51 5b db 04 25 aa  |.FU[.je.6.Q[..%.|
+00000320  1c af a0 b0 2d ee db 00  c5 ad 1b 94 d3 90 11 86  |....-...........|
+00000330  10 83 35 41 65 9e a4 2c  a9 ee 37 ac d4 cc 05 76  |..5Ae..,..7....v|
+00000340  92 59 f9 51 68 79 6d 9e  5f eb 80 47 3a 7c e0 74  |.Y.Qhym._..G:|.t|
+00000350  ac f5 36 16 03 03 00 04  0e 00 00 00              |..6.........|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 25 10 00 00  21 20 a5 84 be 07 bc ce  |....%...! ......|
-00000010  f0 e6 4b cd fa 3a f5 af  2c 70 20 e8 52 ec d8 7a  |..K..:..,p .R..z|
-00000020  3f 18 ad d5 b5 8d cd 2d  fb 58 14 03 03 00 01 01  |?......-.X......|
-00000030  16 03 03 00 40 f6 35 fe  5d 83 df fe b1 74 04 e1  |....@.5.]....t..|
-00000040  04 2c 1b 29 9d de 73 1c  9e 8b 54 0b 71 29 ab 2f  |.,.)..s...T.q)./|
-00000050  4a 78 25 da 59 bb a4 41  c9 4e 41 15 07 f0 49 d7  |Jx%.Y..A.NA...I.|
-00000060  a5 37 34 0b 11 e9 77 bd  9a cc f1 15 dd dd 67 ff  |.74...w.......g.|
-00000070  8d 05 ad 53 3f                                    |...S?|
+00000000  16 03 03 00 25 10 00 00  21 20 d2 ed 26 ce 1f 5d  |....%...! ..&..]|
+00000010  50 b8 f4 19 fc 63 e2 b6  3d 7d 39 54 c2 c1 61 a9  |P....c..=}9T..a.|
+00000020  2a 82 d8 e3 a9 2f 22 8c  b2 18 14 03 03 00 01 01  |*..../".........|
+00000030  16 03 03 00 40 82 78 f0  1e e6 03 20 67 66 4e d6  |....@.x.... gfN.|
+00000040  93 25 69 9e 38 c6 dd 17  92 02 18 7f 5f 9c 9c f0  |.%i.8......._...|
+00000050  a3 f7 45 d3 ba 82 e3 01  38 e5 4f cf 8b 0e 77 6e  |..E.....8.O...wn|
+00000060  91 99 83 e0 f1 3d e8 a1  39 d4 ea b3 2e 1c 67 59  |.....=..9.....gY|
+00000070  c5 5d 83 30 dc                                    |.].0.|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 80 04 00 00  7c 00 00 00 00 00 76 00  |........|.....v.|
+00000000  16 03 03 00 83 04 00 00  7f 00 00 00 00 00 79 00  |..............y.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6f 2d 70 97 51 ed 14 ef  68 ca 42 c5 4c bf 2b 6e  |o-p.Q...h.B.L.+n|
-00000030  9f eb 23 76 35 91 bb 57  fb 9d 45 26 f6 ab 36 3f  |..#v5..W..E&..6?|
-00000040  5d 3a c6 69 69 7a 8b 84  66 9e d8 36 23 6b 17 d2  |]:.iiz..f..6#k..|
-00000050  8f 34 e0 17 3d cb 14 d2  d4 23 3a 59 a4 49 38 16  |.4..=....#:Y.I8.|
-00000060  7e 51 5c e5 15 6d 7e 9f  8a 99 9f 82 ea 45 8c 80  |~Q\..m~......E..|
-00000070  20 61 03 35 d5 35 92 5e  b2 40 3b 1f fb 06 b5 e0  | a.5.5.^.@;.....|
-00000080  47 fd 7a e4 ee 14 03 03  00 01 01 16 03 03 00 40  |G.z............@|
-00000090  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-000000a0  e7 b4 76 94 09 74 72 3e  a3 93 a8 86 2d a3 38 7a  |..v..tr>....-.8z|
-000000b0  a1 6a c5 f8 84 bd ff 22  35 1c 79 60 de 24 d7 7e  |.j....."5.y`.$.~|
-000000c0  2f ba ab d4 8b 39 c9 0a  c3 eb d0 d7 3e bd 33 ca  |/....9......>.3.|
-000000d0  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-000000e0  00 00 00 00 00 36 81 be  8a dd 72 2d f4 51 12 26  |.....6....r-.Q.&|
-000000f0  00 b8 75 fb 3e b5 9c 3d  07 5c be ff 10 fb 0a 63  |..u.>..=.\.....c|
-00000100  c6 c2 ce 98 99 58 a1 f4  35 8d 8a 7e 34 36 dc a2  |.....X..5..~46..|
-00000110  89 cb a8 f4 8f 15 03 03  00 30 00 00 00 00 00 00  |.........0......|
-00000120  00 00 00 00 00 00 00 00  00 00 df bf 96 32 59 e5  |.............2Y.|
-00000130  bb e1 bd c8 8a 51 7e 34  b0 44 62 32 16 bd 9b 45  |.....Q~4.Db2...E|
-00000140  4c 17 a5 35 f9 5e 00 db  da 4c                    |L..5.^...L|
+00000020  6f 2d 70 97 51 ed 14 ef  68 ca 42 c5 4c ff 6b a2  |o-p.Q...h.B.L.k.|
+00000030  3e f9 07 a9 91 ad 0d c7  23 bd 7f 04 cf 4d a0 eb  |>.......#....M..|
+00000040  58 e0 e1 37 73 d3 cc 4b  e2 7f 6d 3a 2e 47 b5 b4  |X..7s..K..m:.G..|
+00000050  60 dd e6 9a ea 30 1e 6e  7a e7 8e 84 ca 49 38 16  |`....0.nz....I8.|
+00000060  7e 51 5c e5 15 c0 58 7d  a2 ba e2 ca 90 24 11 ea  |~Q\...X}.....$..|
+00000070  53 9c 7d cb 47 13 91 cf  f6 05 f0 2f db 57 1a 40  |S.}.G....../.W.@|
+00000080  57 b0 d4 97 8e 23 7e f5  14 03 03 00 01 01 16 03  |W....#~.........|
+00000090  03 00 40 00 00 00 00 00  00 00 00 00 00 00 00 00  |..@.............|
+000000a0  00 00 00 72 43 0e f2 f3  bb e8 6d 3b f2 ff 96 53  |...rC.....m;...S|
+000000b0  12 36 07 e0 f0 17 35 e7  52 87 a3 12 7b 53 d4 83  |.6....5.R...{S..|
+000000c0  cc d2 d3 06 4b e2 3a fc  38 4f a7 75 d8 3c 6a a4  |....K.:.8O.u.<j.|
+000000d0  b7 5f e8 17 03 03 00 40  00 00 00 00 00 00 00 00  |._.....@........|
+000000e0  00 00 00 00 00 00 00 00  7d b5 ce 35 23 2a ba 64  |........}..5#*.d|
+000000f0  0d 4e cc 9d 53 37 84 1d  6d c5 b0 ae a6 64 76 82  |.N..S7..m....dv.|
+00000100  4d 80 97 1e 16 5f 0a 85  72 be 27 41 a3 e0 45 35  |M...._..r.'A..E5|
+00000110  6e d4 c0 41 e5 99 8c 19  15 03 03 00 30 00 00 00  |n..A........0...|
+00000120  00 00 00 00 00 00 00 00  00 00 00 00 00 c9 f3 4e  |...............N|
+00000130  91 b6 c2 c0 a5 cf 21 6b  ed 58 d9 cf 9c 9b ff 0a  |......!k.X......|
+00000140  6c 62 73 de f8 c3 39 22  2e d3 c6 45 9d           |lbs...9"...E.|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-IssueTicket b/src/crypto/tls/testdata/Server-TLSv12-IssueTicket
index 399461ae92..ee29358610 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-IssueTicket
+++ b/src/crypto/tls/testdata/Server-TLSv12-IssueTicket
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 71 01 00 00  6d 03 03 4a 17 2a 03 b4  |....q...m..J.*..|
-00000010  ca 6e 66 72 f3 30 8d c2  37 5e 68 40 92 bc 38 d1  |.nfr.0..7^h@..8.|
-00000020  9f f9 22 a2 4c 6c 30 e2  52 db 81 00 00 04 00 2f  |..".Ll0.R....../|
+00000000  16 03 01 00 71 01 00 00  6d 03 03 bf f8 80 5d 1b  |....q...m.....].|
+00000010  ea 95 cb 32 3b 8f ff 5e  f9 4d 58 7d dc a4 50 cc  |...2;..^.MX}..P.|
+00000020  68 4d 40 98 11 af f3 e4  d7 31 43 00 00 04 00 2f  |hM@......1C..../|
 00000030  00 ff 01 00 00 40 00 23  00 00 00 16 00 00 00 17  |.....@.#........|
 00000040  00 00 00 0d 00 30 00 2e  04 03 05 03 06 03 08 07  |.....0..........|
 00000050  08 08 08 09 08 0a 08 0b  08 04 08 05 08 06 04 01  |................|
@@ -52,39 +52,39 @@
 00000290  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
 000002a0  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 bb 38 02 3e 1d  |............8.>.|
-00000010  b3 9e d2 5f 35 33 cb 24  68 c5 13 29 a9 8a fe 24  |..._53.$h..)...$|
-00000020  85 20 6a 09 7a 19 af 7f  1f f5 ce 0c b1 e5 00 92  |. j.z...........|
-00000030  e2 d0 3d 74 b2 68 94 62  f2 44 15 c3 ba 44 c6 cb  |..=t.h.b.D...D..|
-00000040  15 06 2d 6c 53 41 7e 3d  e2 57 ef a6 3d 68 81 ce  |..-lSA~=.W..=h..|
-00000050  0a 0e 03 8c 2d 0c 64 2d  10 ae 0e af 9e fc a7 08  |....-.d-........|
-00000060  26 52 47 43 c7 66 a8 ff  ff b9 a4 11 36 c3 6a 0e  |&RGC.f......6.j.|
-00000070  2c 73 a4 31 7c b9 f9 a9  f4 6e 9f 5c db 5f e4 41  |,s.1|....n.\._.A|
-00000080  ee 8c 8c 4f 0e cc 10 32  11 24 9d 14 03 03 00 01  |...O...2.$......|
-00000090  01 16 03 03 00 40 8b 8f  79 d8 0c 4a e8 33 73 a1  |.....@..y..J.3s.|
-000000a0  b0 78 d4 7e 09 3e c1 96  6f 23 a6 5a 93 ec 2b e9  |.x.~.>..o#.Z..+.|
-000000b0  8b 5f 84 ad ae 0d 4c 6a  a8 bc c5 db a2 a5 c2 19  |._....Lj........|
-000000c0  8f b0 06 b6 10 52 90 06  cb 46 6f c8 43 95 da 1b  |.....R...Fo.C...|
-000000d0  20 fb ab 5b 26 1a                                 | ..[&.|
+00000000  16 03 03 00 86 10 00 00  82 00 80 35 d7 dd 48 68  |...........5..Hh|
+00000010  17 8c 9b 02 75 0c 6b 76  17 0a e1 f8 06 c0 d7 1d  |....u.kv........|
+00000020  bf a5 97 d2 59 0f c9 90  4a f0 6f 40 dc e7 30 c4  |....Y...J.o@..0.|
+00000030  75 ab 74 9c 32 48 a4 84  3c 40 a0 bd 03 aa 09 2b  |u.t.2H..<@.....+|
+00000040  b2 4c 80 82 17 b8 3d 27  16 9a b7 90 66 f2 10 4e  |.L....='....f..N|
+00000050  41 7e 78 24 de 27 91 f9  e9 bc bf 15 3a 35 1b ae  |A~x$.'......:5..|
+00000060  28 9e e1 09 f0 7a 4d 66  7e de d1 43 bf f5 e4 09  |(....zMf~..C....|
+00000070  a7 21 cb 0e 1d 59 6d a0  a6 41 44 58 f4 ab ac 6a  |.!...Ym..ADX...j|
+00000080  98 db 25 e3 57 ee 94 87  85 51 ea 14 03 03 00 01  |..%.W....Q......|
+00000090  01 16 03 03 00 40 c9 64  79 e7 15 1d 30 15 95 89  |.....@.dy...0...|
+000000a0  b1 9b 12 42 69 4b 22 20  54 5a aa b6 71 02 1c 3f  |...BiK" TZ..q..?|
+000000b0  7c b5 66 07 b5 1f 55 96  3f ce 47 1f 66 52 d8 6b  ||.f...U.?.G.fR.k|
+000000c0  65 71 c0 4e 0b 7e 55 e0  f5 af 42 29 af 2b 1d 0e  |eq.N.~U...B).+..|
+000000d0  e6 96 cd 7b fc d3                                 |...{..|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 80 04 00 00  7c 00 00 00 00 00 76 00  |........|.....v.|
+00000000  16 03 03 00 83 04 00 00  7f 00 00 00 00 00 79 00  |..............y.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6f 2d b0 ac 51 ed 14 ef  68 ca 42 c5 4c 1b 7a 85  |o-..Q...h.B.L.z.|
-00000030  17 60 8e 95 68 ae ba d1  10 71 7c 2c ad 1e bb 60  |.`..h....q|,...`|
-00000040  4d ef 70 e7 f0 ed 39 8b  9c 99 f6 8c cb e4 41 28  |M.p...9.......A(|
-00000050  94 bc f0 91 d9 8f 1b cb  7d e8 4c 4c 49 49 38 16  |........}.LLII8.|
-00000060  7e 51 5c e5 15 ff 0f 34  c4 f2 42 d0 c6 48 7c 0b  |~Q\....4..B..H|.|
-00000070  f1 5d 4b f3 54 87 8e 2d  d1 dd 1c 56 95 9d 57 bd  |.]K.T..-...V..W.|
-00000080  28 ed cf 80 06 14 03 03  00 01 01 16 03 03 00 40  |(..............@|
-00000090  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-000000a0  eb fe be 2e 90 0b 5e 33  ce 76 8a dd 00 8a 25 c7  |......^3.v....%.|
-000000b0  14 c4 06 b2 7d 8f 4e 38  7d 1f f9 b4 21 cb b7 8e  |....}.N8}...!...|
-000000c0  1b 4b b6 b9 17 04 bd 98  d3 aa a1 a2 49 59 4e c7  |.K..........IYN.|
-000000d0  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-000000e0  00 00 00 00 00 95 59 f7  79 bd 57 9b 07 6b b5 18  |......Y.y.W..k..|
-000000f0  0b b6 17 99 7f c1 40 e1  b9 df f5 45 6b 57 06 1c  |......@....EkW..|
-00000100  b7 a9 4c 71 99 8b 35 17  c8 0e 78 2c 49 35 48 e8  |..Lq..5...x,I5H.|
-00000110  4d 1f d4 3d 58 15 03 03  00 30 00 00 00 00 00 00  |M..=X....0......|
-00000120  00 00 00 00 00 00 00 00  00 00 47 76 9f b0 43 ee  |..........Gv..C.|
-00000130  e1 ee 99 10 93 94 cc 8f  0c 54 fc ff d0 3b 93 8c  |.........T...;..|
-00000140  21 30 70 53 c7 b8 54 14  ca 67                    |!0pS..T..g|
+00000020  6f 2d b0 ac 51 ed 14 ef  68 ca 42 c5 4c 85 f6 26  |o-..Q...h.B.L..&|
+00000030  0d a4 ad a8 f5 14 64 4f  b9 c3 fb 1e 55 c1 1f c7  |......dO....U...|
+00000040  31 57 72 68 db 03 37 a8  c9 07 f4 ca 62 6c 5c f3  |1Wrh..7.....bl\.|
+00000050  8b 5a 3d 76 dd 63 ea 68  61 6b a1 2d 95 49 38 16  |.Z=v.c.hak.-.I8.|
+00000060  7e 51 5c e5 15 c0 58 7d  c5 67 4a 6f 64 b6 79 1a  |~Q\...X}.gJod.y.|
+00000070  41 9b b1 33 15 38 74 92  5c a5 48 c3 f2 94 bb 33  |A..3.8t.\.H....3|
+00000080  ec af cf d7 e7 c9 3e 35  14 03 03 00 01 01 16 03  |......>5........|
+00000090  03 00 40 00 00 00 00 00  00 00 00 00 00 00 00 00  |..@.............|
+000000a0  00 00 00 19 51 7c 1c a3  80 34 e1 81 30 3f f9 a4  |....Q|...4..0?..|
+000000b0  a0 97 97 fd 94 fb ab e8  80 48 25 7b 83 ca 38 61  |.........H%{..8a|
+000000c0  34 95 d0 52 6f 09 ad 4f  74 35 c5 3d e8 bb aa 5d  |4..Ro..Ot5.=...]|
+000000d0  d0 fc 85 17 03 03 00 40  00 00 00 00 00 00 00 00  |.......@........|
+000000e0  00 00 00 00 00 00 00 00  e7 19 f9 fd 10 7c 17 04  |.............|..|
+000000f0  2d ce 5f a6 41 33 3d 05  b0 29 91 ff a0 a5 76 52  |-._.A3=..)....vR|
+00000100  e1 b9 ba 6a ca d3 79 60  11 ac 43 b5 30 f7 15 dc  |...j..y`..C.0...|
+00000110  6f b1 d2 b2 00 85 43 40  15 03 03 00 30 00 00 00  |o.....C@....0...|
+00000120  00 00 00 00 00 00 00 00  00 00 00 00 00 19 99 8a  |................|
+00000130  4c 18 e0 03 cc 27 7a be  2c e5 d2 16 95 f6 a4 6e  |L....'z.,......n|
+00000140  11 d3 1d f4 01 52 2b fc  98 04 b1 0b 31           |.....R+.....1|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable b/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable
index ca1b91c818..20ce3c3cc8 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable
+++ b/src/crypto/tls/testdata/Server-TLSv12-IssueTicketPreDisable
@@ -1,7 +1,7 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 71 01 00 00  6d 03 03 4b e2 b8 af c9  |....q...m..K....|
-00000010  70 49 22 d0 7c 4d c0 45  11 aa cd 80 f4 95 5c fd  |pI".|M.E......\.|
-00000020  ed 04 d6 45 09 4b b0 31  1d f5 d7 00 00 04 00 2f  |...E.K.1......./|
+00000000  16 03 01 00 71 01 00 00  6d 03 03 a1 ba 69 29 39  |....q...m....i)9|
+00000010  b5 fc c7 90 90 54 35 be  5a ad 4a e2 b2 3d b9 01  |.....T5.Z.J..=..|
+00000020  f0 48 fd 77 b5 9e bc 89  f5 d4 df 00 00 04 00 2f  |.H.w.........../|
 00000030  00 ff 01 00 00 40 00 23  00 00 00 16 00 00 00 17  |.....@.#........|
 00000040  00 00 00 0d 00 30 00 2e  04 03 05 03 06 03 08 07  |.....0..........|
 00000050  08 08 08 09 08 0a 08 0b  08 04 08 05 08 06 04 01  |................|
@@ -52,39 +52,39 @@
 00000290  fe 3d 13 60 84 5c 21 d3  3b e9 fa e7 16 03 03 00  |.=.`.\!.;.......|
 000002a0  04 0e 00 00 00                                    |.....|
 >>> Flow 3 (client to server)
-00000000  16 03 03 00 86 10 00 00  82 00 80 87 64 93 5c 78  |............d.\x|
-00000010  c4 33 ec 05 ea da 29 f4  16 4a ca 2e bc 93 f4 37  |.3....)..J.....7|
-00000020  a4 b5 76 54 97 7f 91 3a  11 79 8f b4 d3 35 af fb  |..vT...:.y...5..|
-00000030  6a 9a 9e 2e 0a 1a e0 fd  99 72 2e d1 7e a6 62 0c  |j........r..~.b.|
-00000040  ca d5 c6 03 00 8e 18 7d  2b 8e 94 74 c1 5b fb c3  |.......}+..t.[..|
-00000050  85 94 1c 92 33 0a a8 03  2b 60 02 dd 3b e8 26 d1  |....3...+`..;.&.|
-00000060  e2 e3 cf 86 7f a9 59 9d  e0 0a 62 b0 3f 98 c2 41  |......Y...b.?..A|
-00000070  e3 88 dd 0b 87 56 d0 23  b9 44 c8 0a 18 29 36 d9  |.....V.#.D...)6.|
-00000080  e3 28 bd 26 b7 90 f1 ac  13 d7 44 14 03 03 00 01  |.(.&......D.....|
-00000090  01 16 03 03 00 40 4d 02  0c 64 a6 e7 14 2d a1 ef  |.....@M..d...-..|
-000000a0  0e 46 26 d9 40 7e c6 e9  f7 87 e1 19 b6 0f 77 ed  |.F&.@~........w.|
-000000b0  90 59 db c1 59 f9 25 a9  ed c3 c3 d1 5b fd 52 0b  |.Y..Y.%.....[.R.|
-000000c0  a7 a4 64 ef d4 6b 80 14  e4 32 13 c4 7a 77 31 cc  |..d..k...2..zw1.|
-000000d0  2f cb c6 1b 73 a5                                 |/...s.|
+00000000  16 03 03 00 86 10 00 00  82 00 80 cc 4e 62 e0 bf  |............Nb..|
+00000010  21 65 dc f2 57 fb fe 6e  e4 cc de b4 1f aa af 52  |!e..W..n.......R|
+00000020  a4 e0 0e 1b fa 8b 23 4b  d9 e2 4b 62 6a 26 80 f7  |......#K..Kbj&..|
+00000030  15 82 ba 44 4a 18 b8 97  ca a1 79 4b 11 59 90 7d  |...DJ.....yK.Y.}|
+00000040  ea 89 7c f9 6b 5f 29 c7  ca 32 bf 3b 53 b2 bb bb  |..|.k_)..2.;S...|
+00000050  77 0a 5c 1f c2 d8 20 cf  59 19 4e a0 ff ef ca ca  |w.\... .Y.N.....|
+00000060  25 39 ac c7 64 b9 e8 68  09 f2 49 96 8e 49 c7 4c  |%9..d..h..I..I.L|
+00000070  cd ff 28 6f d8 0d d3 7a  ae 7a 51 9e 04 70 8a 59  |..(o...z.zQ..p.Y|
+00000080  8c 05 61 c9 2b bd e1 05  5a 12 63 14 03 03 00 01  |..a.+...Z.c.....|
+00000090  01 16 03 03 00 40 ac 30  bb 83 2f e2 a1 98 a3 c5  |.....@.0../.....|
+000000a0  9c e3 55 36 70 a0 10 fc  53 7e 2d ae f1 02 d7 04  |..U6p...S~-.....|
+000000b0  1f 4e 5d ed 33 29 99 04  54 8e 51 74 d5 2a 73 21  |.N].3)..T.Qt.*s!|
+000000c0  4f bf 8b 0c 04 b2 f2 d4  3e a7 f6 ee 8b fb 3a 0b  |O.......>.....:.|
+000000d0  86 27 7c a7 bb 32                                 |.'|..2|
 >>> Flow 4 (server to client)
-00000000  16 03 03 00 80 04 00 00  7c 00 00 00 00 00 76 00  |........|.....v.|
+00000000  16 03 03 00 83 04 00 00  7f 00 00 00 00 00 79 00  |..............y.|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 94  |................|
-00000020  6f 2d b0 ac 51 ed 14 ef  68 ca 42 c5 4c 78 cb 47  |o-..Q...h.B.Lx.G|
-00000030  2f 89 ed 83 1b c1 0a fa  14 8f ad cb 55 da 3b 0e  |/...........U.;.|
-00000040  41 cb 5e d4 16 04 a2 6f  fb 8e 18 cc de c5 e9 ff  |A.^....o........|
-00000050  eb 7a 4c 87 89 f9 61 d5  24 02 15 96 31 49 38 16  |.zL...a.$...1I8.|
-00000060  7e 51 5c e5 15 67 a1 6f  53 38 e0 bb 43 eb 92 7a  |~Q\..g.oS8..C..z|
-00000070  c4 8a 33 bc d3 57 cd 7d  b0 b5 62 17 4b ea a9 9f  |..3..W.}..b.K...|
-00000080  13 f3 c9 04 ae 14 03 03  00 01 01 16 03 03 00 40  |...............@|
-00000090  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-000000a0  c6 23 28 2c c8 33 2d a6  7b a4 32 16 0e 66 2a 58  |.#(,.3-.{.2..f*X|
-000000b0  2d f8 85 8b f3 7d 5f 82  57 fc 7b 4d 81 13 73 d0  |-....}_.W.{M..s.|
-000000c0  c6 6d 9c 87 a1 09 c2 67  ab cc d3 2d c7 4d 52 4a  |.m.....g...-.MRJ|
-000000d0  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-000000e0  00 00 00 00 00 b3 74 97  6d ae 2e 32 53 60 8d 12  |......t.m..2S`..|
-000000f0  b1 d1 0d 24 eb bf 9a 5b  5d e1 7c 75 d7 17 24 3c  |...$...[].|u..$<|
-00000100  5b 82 86 24 41 89 ac ad  f9 86 db 7c 20 8c 18 7a  |[..$A......| ..z|
-00000110  dc 3a b9 41 e0 15 03 03  00 30 00 00 00 00 00 00  |.:.A.....0......|
-00000120  00 00 00 00 00 00 00 00  00 00 ea a1 95 df 7f 3c  |...............<|
-00000130  c2 d2 df de d4 21 d8 7d  8c 67 3a c5 f9 c2 f8 fe  |.....!.}.g:.....|
-00000140  9d ea 08 d5 35 d9 ed 6f  d2 29                    |....5..o.)|
+00000020  6f 2d b0 ac 51 ed 14 ef  68 ca 42 c5 4c fa 53 68  |o-..Q...h.B.L.Sh|
+00000030  d9 20 e9 d9 c1 9c 90 3b  f2 e6 57 af 04 e5 db 6b  |. .....;..W....k|
+00000040  36 0b b5 b8 e2 a5 a4 bf  52 31 80 32 b9 da d9 32  |6.......R1.2...2|
+00000050  36 e7 31 d3 22 78 12 ae  7a 80 ac fa 6d 49 38 16  |6.1."x..z...mI8.|
+00000060  7e 51 5c e5 15 c0 58 7d  d6 77 d5 17 1b d9 a8 74  |~Q\...X}.w.....t|
+00000070  be 93 25 54 84 a7 1a 93  1f 20 a4 49 eb 26 e7 8e  |..%T..... .I.&..|
+00000080  d3 0f cf 9c 75 cc 6f 36  14 03 03 00 01 01 16 03  |....u.o6........|
+00000090  03 00 40 00 00 00 00 00  00 00 00 00 00 00 00 00  |..@.............|
+000000a0  00 00 00 eb f1 52 79 ff  b8 6c 9c 23 f3 22 bc 96  |.....Ry..l.#."..|
+000000b0  2a bc e7 73 05 32 4b 2e  e4 5e 31 97 62 86 cc 12  |*..s.2K..^1.b...|
+000000c0  ae 22 77 92 37 5d 82 41  57 48 aa f4 0a f3 94 30  |."w.7].AWH.....0|
+000000d0  5d 06 7b 17 03 03 00 40  00 00 00 00 00 00 00 00  |].{....@........|
+000000e0  00 00 00 00 00 00 00 00  8f 8d a7 06 a7 d6 52 5a  |..............RZ|
+000000f0  b9 66 5e ef e3 8d 1d 91  d0 6d 30 29 92 4e 6a 81  |.f^......m0).Nj.|
+00000100  f4 77 97 06 de a8 c8 d1  4c 6b 15 07 1f 9b 59 6d  |.w......Lk....Ym|
+00000110  cb 4f 23 20 58 aa 22 21  15 03 03 00 30 00 00 00  |.O# X."!....0...|
+00000120  00 00 00 00 00 00 00 00  00 00 00 00 00 06 55 3d  |..............U=|
+00000130  42 f5 12 b2 66 aa af 00  91 5e b8 31 ae 19 0e 35  |B...f....^.1...5|
+00000140  a2 d7 a6 e7 0c 3c 2b 95  62 69 d7 a0 81           |.....<+.bi...|
diff --git a/src/crypto/tls/testdata/Server-TLSv12-Resume b/src/crypto/tls/testdata/Server-TLSv12-Resume
index b59314a976..cd0a1240b2 100644
--- a/src/crypto/tls/testdata/Server-TLSv12-Resume
+++ b/src/crypto/tls/testdata/Server-TLSv12-Resume
@@ -1,53 +1,54 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 07 01 00 01  03 03 03 4b 54 81 19 48  |...........KT..H|
-00000010  bc e2 39 6e ff 67 de 39  f2 05 5a c4 55 80 5f 88  |..9n.g.9..Z.U._.|
-00000020  70 9f e6 ea d4 04 dd 45  bd ba de 20 38 80 17 a6  |p......E... 8...|
-00000030  12 ef 06 3b c4 51 b1 f7  30 4b f4 ae 24 18 92 cb  |...;.Q..0K..$...|
-00000040  56 41 3c bc fe 73 df 1a  88 0e 54 55 00 04 00 2f  |VA<..s....TU.../|
-00000050  00 ff 01 00 00 b6 00 23  00 76 00 00 00 00 00 00  |.......#.v......|
+00000000  16 03 01 01 0a 01 00 01  06 03 03 2d b6 ca ea 39  |...........-...9|
+00000010  59 17 86 df 90 2f 73 e0  a0 5c 6e 28 09 78 69 d6  |Y..../s..\n(.xi.|
+00000020  30 06 b7 7b 17 a9 79 30  2a d8 57 20 c5 5c ed 86  |0..{..y0*.W .\..|
+00000030  15 f4 3b c8 d2 5f 7a 80  2a 6a cd 40 c2 da 6f a8  |..;.._z.*j.@..o.|
+00000040  cd d7 e7 bf 48 bd fb a1  e9 4b 9b a9 00 04 00 2f  |....H....K...../|
+00000050  00 ff 01 00 00 b9 00 23  00 79 00 00 00 00 00 00  |.......#.y......|
 00000060  00 00 00 00 00 00 00 00  00 00 94 6f 2d b0 ac 51  |...........o-..Q|
-00000070  ed 14 ef 68 ca 42 c5 4c  1b 7a 85 17 60 8e 95 68  |...h.B.L.z..`..h|
-00000080  ae ba d1 10 71 7c 2c ad  1e bb 60 4d ef 70 e7 f0  |....q|,...`M.p..|
-00000090  ed 39 8b 9c 99 f6 8c cb  e4 41 28 94 bc f0 91 d9  |.9.......A(.....|
-000000a0  8f 1b cb 7d e8 4c 4c 49  49 38 16 7e 51 5c e5 15  |...}.LLII8.~Q\..|
-000000b0  ff 0f 34 c4 f2 42 d0 c6  48 7c 0b f1 5d 4b f3 54  |..4..B..H|..]K.T|
-000000c0  87 8e 2d d1 dd 1c 56 95  9d 57 bd 28 ed cf 80 06  |..-...V..W.(....|
-000000d0  00 16 00 00 00 17 00 00  00 0d 00 30 00 2e 04 03  |...........0....|
-000000e0  05 03 06 03 08 07 08 08  08 09 08 0a 08 0b 08 04  |................|
-000000f0  08 05 08 06 04 01 05 01  06 01 03 03 02 03 03 01  |................|
-00000100  02 01 03 02 02 02 04 02  05 02 06 02              |............|
+00000070  ed 14 ef 68 ca 42 c5 4c  85 f6 26 0d a4 ad a8 f5  |...h.B.L..&.....|
+00000080  14 64 4f b9 c3 fb 1e 55  c1 1f c7 31 57 72 68 db  |.dO....U...1Wrh.|
+00000090  03 37 a8 c9 07 f4 ca 62  6c 5c f3 8b 5a 3d 76 dd  |.7.....bl\..Z=v.|
+000000a0  63 ea 68 61 6b a1 2d 95  49 38 16 7e 51 5c e5 15  |c.hak.-.I8.~Q\..|
+000000b0  c0 58 7d c5 67 4a 6f 64  b6 79 1a 41 9b b1 33 15  |.X}.gJod.y.A..3.|
+000000c0  38 74 92 5c a5 48 c3 f2  94 bb 33 ec af cf d7 e7  |8t.\.H....3.....|
+000000d0  c9 3e 35 00 16 00 00 00  17 00 00 00 0d 00 30 00  |.>5...........0.|
+000000e0  2e 04 03 05 03 06 03 08  07 08 08 08 09 08 0a 08  |................|
+000000f0  0b 08 04 08 05 08 06 04  01 05 01 06 01 03 03 02  |................|
+00000100  03 03 01 02 01 03 02 02  02 04 02 05 02 06 02     |...............|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 59 02 00 00  55 03 03 00 00 00 00 00  |....Y...U.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 44 4f 57 4e 47  52 44 01 20 38 80 17 a6  |...DOWNGRD. 8...|
-00000030  12 ef 06 3b c4 51 b1 f7  30 4b f4 ae 24 18 92 cb  |...;.Q..0K..$...|
-00000040  56 41 3c bc fe 73 df 1a  88 0e 54 55 00 2f 00 00  |VA<..s....TU./..|
+00000020  00 00 00 44 4f 57 4e 47  52 44 01 20 c5 5c ed 86  |...DOWNGRD. .\..|
+00000030  15 f4 3b c8 d2 5f 7a 80  2a 6a cd 40 c2 da 6f a8  |..;.._z.*j.@..o.|
+00000040  cd d7 e7 bf 48 bd fb a1  e9 4b 9b a9 00 2f 00 00  |....H....K.../..|
 00000050  0d 00 23 00 00 ff 01 00  01 00 00 17 00 00 16 03  |..#.............|
-00000060  03 00 80 04 00 00 7c 00  00 00 00 00 76 00 00 00  |......|.....v...|
+00000060  03 00 83 04 00 00 7f 00  00 00 00 00 79 00 00 00  |............y...|
 00000070  00 00 00 00 00 00 00 00  00 00 00 00 00 94 6f 2d  |..............o-|
-00000080  b0 ac 51 ed 14 ef 68 ca  42 c5 4c 1b 7a 85 17 60  |..Q...h.B.L.z..`|
-00000090  8e 95 68 ae ba d1 10 71  7c 2c ad 1e bb 60 4d ef  |..h....q|,...`M.|
-000000a0  70 e7 f0 ed 39 8b 9c 99  f6 8c cb e4 41 28 94 bc  |p...9.......A(..|
-000000b0  f0 91 d9 8f 1b cb 7d e8  4c 4c 49 49 38 16 7e 51  |......}.LLII8.~Q|
-000000c0  5c e5 15 ff 0f 34 c4 f2  42 d0 c6 48 7c 0b f1 5d  |\....4..B..H|..]|
-000000d0  4b f3 54 87 8e 2d d1 dd  1c 56 95 9d 57 bd 28 ed  |K.T..-...V..W.(.|
-000000e0  cf 80 06 14 03 03 00 01  01 16 03 03 00 40 00 00  |.............@..|
-000000f0  00 00 00 00 00 00 00 00  00 00 00 00 00 00 fc 00  |................|
-00000100  41 6f 98 7c 46 97 e3 7c  29 d4 1a d7 7a b4 21 8f  |Ao.|F..|)...z.!.|
-00000110  5a db 3a fc e9 97 56 f3  f9 c6 de 34 0e 23 a7 62  |Z.:...V....4.#.b|
-00000120  bb 11 54 2d ce 3d 7a f1  6f 37 98 e7 29 0f        |..T-.=z.o7..).|
+00000080  b0 ac 51 ed 14 ef 68 ca  42 c5 4c 85 f6 26 0d a4  |..Q...h.B.L..&..|
+00000090  ad a8 f5 14 64 4f b9 c3  fb 1e 55 c1 1f c7 31 57  |....dO....U...1W|
+000000a0  72 68 db 03 37 a8 c9 07  f4 ca 62 6c 5c f3 8b 5a  |rh..7.....bl\..Z|
+000000b0  3d 76 dd 63 ea 68 61 6b  a1 2d 95 49 38 16 7e 51  |=v.c.hak.-.I8.~Q|
+000000c0  5c e5 15 c0 58 7d c5 67  4a 6f 64 b6 79 1a 41 9b  |\...X}.gJod.y.A.|
+000000d0  b1 33 15 38 74 92 5c a5  48 c3 f2 94 bb 33 ec af  |.3.8t.\.H....3..|
+000000e0  cf d7 e7 c9 3e 35 14 03  03 00 01 01 16 03 03 00  |....>5..........|
+000000f0  40 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |@...............|
+00000100  00 47 68 3a 66 5b d6 ed  b7 60 a9 fb e8 37 d6 9d  |.Gh:f[...`...7..|
+00000110  a6 b9 4d d5 f3 9f 0f c6  3c 21 6e d5 80 08 a8 34  |..M.....<!n....4|
+00000120  34 da a3 1f b0 20 28 e4  2f 2b 6b c6 3e dc ac 6b  |4.... (./+k.>..k|
+00000130  40                                                |@|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 16 03  03 00 40 eb ea a1 34 71  |..........@...4q|
-00000010  ef 62 a4 f7 2b ad 63 3a  8b 6f f7 b3 a4 fe 08 60  |.b..+.c:.o.....`|
-00000020  c4 6c 5f 01 df d8 be 9b  17 24 2a 0a d0 27 ec 96  |.l_......$*..'..|
-00000030  6c 7f bc a1 95 c9 ce 8d  03 86 3c e3 b5 bc 0d 37  |l.........<....7|
-00000040  17 22 21 c7 d4 e5 c5 20  33 f7 fd                 |."!.... 3..|
+00000000  14 03 03 00 01 01 16 03  03 00 40 46 34 b3 97 54  |..........@F4..T|
+00000010  20 5b 95 f3 22 f8 a1 89  c8 95 93 ba 7b a4 a8 8f  | [..".......{...|
+00000020  46 a8 d6 c1 b3 ac f0 e0  49 3d 8d e4 1c ac b8 a4  |F.......I=......|
+00000030  01 21 5e d8 f0 f5 10 10  f7 de 8b 33 9d 94 cf f6  |.!^........3....|
+00000040  f2 9b 39 22 5c e6 c0 5e  b4 1d cd                 |..9"\..^...|
 >>> Flow 4 (server to client)
 00000000  17 03 03 00 40 00 00 00  00 00 00 00 00 00 00 00  |....@...........|
-00000010  00 00 00 00 00 87 f6 ae  c9 fc b6 e8 fa f5 9d 72  |...............r|
-00000020  a4 f0 55 1f 12 1d 4b 50  37 44 79 5e 0e 8d 96 f8  |..U...KP7Dy^....|
-00000030  d4 e0 b0 43 dd 6e 40 d4  39 b4 a6 e1 b7 07 3c 91  |...C.n@.9.....<.|
-00000040  72 11 5a 80 9e 15 03 03  00 30 00 00 00 00 00 00  |r.Z......0......|
-00000050  00 00 00 00 00 00 00 00  00 00 4d a1 31 bd 5a a9  |..........M.1.Z.|
-00000060  0a 44 66 53 68 a4 20 ef  ac 8e d3 25 2f 73 45 d3  |.DfSh. ....%/sE.|
-00000070  4f 5a dd 0f 5b a6 7f 47  ab cd                    |OZ..[..G..|
+00000010  00 00 00 00 00 5c bc 45  06 2e d3 7b 30 99 a6 af  |.....\.E...{0...|
+00000020  64 0e 63 93 73 6f 0a e7  a4 1d ac 94 25 11 a5 63  |d.c.so......%..c|
+00000030  8d b2 44 aa 98 44 f8 b5  51 ea 2c fb 26 99 f6 a4  |..D..D..Q.,.&...|
+00000040  2c f8 15 c3 90 15 03 03  00 30 00 00 00 00 00 00  |,........0......|
+00000050  00 00 00 00 00 00 00 00  00 00 c6 58 8e 7c 97 de  |...........X.|..|
+00000060  3b b8 39 cd 7b 1d 67 77  27 da 93 39 52 a7 81 9b  |;.9.{.gw'..9R...|
+00000070  ab 5a bc e9 00 1a 64 3a  ca f5                    |.Z....d:..|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-AES128-SHA256 b/src/crypto/tls/testdata/Server-TLSv13-AES128-SHA256
index 00b2b516c2..465d5f9f7e 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-AES128-SHA256
+++ b/src/crypto/tls/testdata/Server-TLSv13-AES128-SHA256
@@ -1,97 +1,97 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 62 22 f7 19 ae  |...........b"...|
-00000010  2d c1 c0 03 49 4c 9d 96  49 68 02 9b e9 fb cb d3  |-...IL..Ih......|
-00000020  b9 4d 05 85 8c 80 64 b7  b1 fc 74 20 1c aa 3a 04  |.M....d...t ..:.|
-00000030  39 37 f8 4e 8f 3d 08 38  50 5d 68 37 27 28 14 8f  |97.N.=.8P]h7'(..|
-00000040  19 59 71 e8 0b 22 11 48  20 f7 78 24 00 04 13 01  |.Yq..".H .x$....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 8e 4c 3b 7c dc  |............L;|.|
+00000010  d6 2d c0 19 de dd 85 01  ce 5a 48 3e 63 ab 4a 21  |.-.......ZH>c.J!|
+00000020  9c 0e 23 4f 41 99 43 bd  78 5b 82 20 90 e6 4e 23  |..#OA.C.x[. ..N#|
+00000030  34 72 2a ad 9a cf 95 20  20 f0 e9 cf 7a 4a 57 65  |4r*....  ...zJWe|
+00000040  87 09 c7 76 79 25 9c 3e  16 22 4c c5 00 04 13 01  |...vy%.>."L.....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 19  |-.....3.&.$... .|
-000000b0  e3 b2 9b c6 d0 0d 1e 8e  e5 e1 55 f0 e1 9d 17 a1  |..........U.....|
-000000c0  78 05 88 a9 09 65 0f b2  b4 37 30 f8 5b ab 16     |x....e...70.[..|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 74  |-.....3.&.$... t|
+000000b0  47 39 80 c0 36 61 58 c4  16 58 d5 e1 9f 60 ca a8  |G9..6aX..X...`..|
+000000c0  f8 ef 86 40 65 2d 5b 5d  4b cc 37 1d 66 15 66     |...@e-[]K.7.f.f|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 1c aa 3a 04  |........... ..:.|
-00000030  39 37 f8 4e 8f 3d 08 38  50 5d 68 37 27 28 14 8f  |97.N.=.8P]h7'(..|
-00000040  19 59 71 e8 0b 22 11 48  20 f7 78 24 13 01 00 00  |.Yq..".H .x$....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 90 e6 4e 23  |........... ..N#|
+00000030  34 72 2a ad 9a cf 95 20  20 f0 e9 cf 7a 4a 57 65  |4r*....  ...zJWe|
+00000040  87 09 c7 76 79 25 9c 3e  16 22 4c c5 13 01 00 00  |...vy%.>."L.....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 38 1c f2 fd 62 f6  |..........8...b.|
-00000090  fa 96 d9 b8 fb 40 43 f3  ac 54 39 e7 f0 2b fd 4c  |.....@C..T9..+.L|
-000000a0  ac 17 03 03 02 6d 73 73  62 0b f2 d6 6a 37 9f 85  |.....mssb...j7..|
-000000b0  d6 d0 88 89 36 2f c0 82  0d 3f 02 2a 57 11 22 90  |....6/...?.*W.".|
-000000c0  07 d1 8c 22 c3 7a 52 50  f2 fd 73 9f 14 97 a5 b1  |...".zRP..s.....|
-000000d0  89 04 b7 87 92 03 fa b1  ac e8 38 c9 e8 48 b5 b2  |..........8..H..|
-000000e0  4b 2b 6e 4f 08 ac b9 0c  c4 2b 65 f8 e7 32 de c6  |K+nO.....+e..2..|
-000000f0  cd 58 13 2a 28 65 58 f1  0b f8 77 b7 56 a5 84 1f  |.X.*(eX...w.V...|
-00000100  0d 8b bd 54 0f 55 58 0b  7e ca 9c 1f c1 04 ca 01  |...T.UX.~.......|
-00000110  f4 d5 d7 ae 1b 5b d8 51  21 1c a0 d1 b3 37 23 49  |.....[.Q!....7#I|
-00000120  15 5d 70 5d 58 da 42 62  c2 a1 f6 af 58 07 a3 b8  |.]p]X.Bb....X...|
-00000130  e8 a0 51 64 16 f8 f0 d4  9f 4e 85 50 2f 69 6b 94  |..Qd.....N.P/ik.|
-00000140  cf 8f 6d 65 74 39 61 be  65 82 28 b4 3e 0a d3 25  |..met9a.e.(.>..%|
-00000150  41 ce e3 bc c6 98 f4 0f  81 74 00 1a ed a3 f9 51  |A........t.....Q|
-00000160  93 ee 85 b2 6d 99 25 a3  2a 88 cb 77 8a b7 80 9c  |....m.%.*..w....|
-00000170  4e 11 3c 5c b1 62 cc 06  0e 4d 36 b5 04 3f b2 a4  |N.<\.b...M6..?..|
-00000180  2c f1 59 f7 3f 86 76 78  75 50 f8 1c 86 b7 22 09  |,.Y.?.vxuP....".|
-00000190  72 65 24 5e 91 cd 59 7d  8e 96 0c 99 e6 ba 1c ec  |re$^..Y}........|
-000001a0  3f 1b 80 96 fe 29 34 0f  99 3c de 60 b1 2e ff 07  |?....)4..<.`....|
-000001b0  3b f6 8c 96 27 23 b4 ba  87 9d 56 8e 60 6e 87 45  |;...'#....V.`n.E|
-000001c0  10 33 38 34 c4 ac 72 03  73 80 8f 39 ce de 79 dd  |.384..r.s..9..y.|
-000001d0  ee 18 d8 57 29 90 a7 be  1b be 80 37 aa 36 e9 59  |...W)......7.6.Y|
-000001e0  8a 53 98 68 c3 bc 6d 4d  91 15 70 8d a1 6f 5c 28  |.S.h..mM..p..o\(|
-000001f0  08 e3 fb a7 95 19 ff 27  c7 a0 a4 30 ea 3c eb d9  |.......'...0.<..|
-00000200  b2 05 4e 10 bc 80 e6 0b  48 52 55 e2 9f c2 ff 99  |..N.....HRU.....|
-00000210  5d ab 65 ff 44 d2 4a fd  96 17 62 ae ac 4e 48 5f  |].e.D.J...b..NH_|
-00000220  10 e8 0d 17 d7 bc eb 81  06 da 7d c7 7d be 00 5f  |..........}.}.._|
-00000230  d4 db 13 b3 bb 72 e8 fa  50 88 a2 48 38 f4 c3 b7  |.....r..P..H8...|
-00000240  87 f2 5b 39 7f 48 63 61  95 25 df 9b cc ac 7e 29  |..[9.Hca.%....~)|
-00000250  eb 8e 10 5a db a7 cf 5e  f5 a4 09 75 7d cd fe d9  |...Z...^...u}...|
-00000260  5c 51 f0 c4 89 a7 50 45  53 77 f0 1d 59 4d df 04  |\Q....PESw..YM..|
-00000270  74 ac 1b 74 5e a6 59 64  be c5 8e 3a 4e cc a7 c4  |t..t^.Yd...:N...|
-00000280  e8 c9 6f da f0 22 7b d2  14 99 64 f6 7a 16 ba f3  |..o.."{...d.z...|
-00000290  16 42 ef 43 57 ea 2c 2a  c4 ce 51 06 8a fe ab a0  |.B.CW.,*..Q.....|
-000002a0  e1 73 96 81 f4 45 0d 26  fa 6a fc 8e ef d0 0e 75  |.s...E.&.j.....u|
-000002b0  d0 f1 a8 cc 2b 4a c1 4b  b5 c0 7d c9 c5 b5 dd 54  |....+J.K..}....T|
-000002c0  85 94 46 ad e8 58 1c aa  57 34 7d d7 59 5b 94 5e  |..F..X..W4}.Y[.^|
-000002d0  a5 ab 21 73 75 59 90 7a  39 ad 0b de 53 c2 25 07  |..!suY.z9...S.%.|
-000002e0  c2 29 6a 23 47 91 e2 15  c8 33 6e a1 ce 19 b4 de  |.)j#G....3n.....|
-000002f0  20 54 23 08 b8 4d e1 03  ef 2b 30 3f e4 3a 5b 7a  | T#..M...+0?.:[z|
-00000300  72 14 7e 5b 41 ab 4a 1c  5f eb 2b 00 1e 42 8a 75  |r.~[A.J._.+..B.u|
-00000310  29 8e 6f 17 03 03 00 99  88 e4 ff 29 21 d9 c0 3d  |).o........)!..=|
-00000320  11 45 e9 da fd 7f a3 75  7b db ee b7 29 47 ce 95  |.E.....u{...)G..|
-00000330  c6 24 45 2b 56 3f f9 84  c7 43 e7 4e cc af af 69  |.$E+V?...C.N...i|
-00000340  10 79 41 74 d0 cd 96 23  c4 8f 7b a0 eb ea 18 2c  |.yAt...#..{....,|
-00000350  da a5 52 08 5b 32 ef de  72 e0 b6 5c bb ce 47 8c  |..R.[2..r..\..G.|
-00000360  6b 0e 39 91 79 8b 6d b3  c3 80 05 9e 51 50 07 fb  |k.9.y.m.....QP..|
-00000370  cc da ba c2 cb d2 e6 47  e7 27 d8 65 63 b9 33 a3  |.......G.'.ec.3.|
-00000380  21 cf 85 a0 dd 29 a5 ad  90 3f 6f 47 97 67 dc c7  |!....)...?oG.g..|
-00000390  fb 9e 0b 23 a1 8a 8a 3b  cb a0 d7 32 5f e7 3a 0c  |...#...;...2_.:.|
-000003a0  6d c4 7a 8c 73 98 05 42  2a 47 7a f2 51 fa 1e 7f  |m.z.s..B*Gz.Q...|
-000003b0  e7 17 03 03 00 35 b8 48  0d fc 12 11 a1 de 9d 61  |.....5.H.......a|
-000003c0  c7 80 44 8b 1a 19 0f d8  04 b1 d4 a2 89 8a 6d ac  |..D...........m.|
-000003d0  9f 14 f2 1e 7a 0d cb f9  64 fd f9 47 5e 1c 08 e3  |....z...d..G^...|
-000003e0  a3 09 5b 81 a5 8f 0d b8  ee bd 07 17 03 03 00 88  |..[.............|
-000003f0  f1 ac 07 2e bd a0 05 0f  5f b1 fb 15 7d c4 87 a1  |........_...}...|
-00000400  d8 a1 1d 8b c4 b9 ca ed  37 ba 3d 82 7c 62 75 33  |........7.=.|bu3|
-00000410  d1 ae 62 9f 43 fc db 30  2e 39 83 f3 e6 89 6a 52  |..b.C..0.9....jR|
-00000420  bf 66 41 13 6e 45 04 4f  9b 1f a7 67 79 ba ba 32  |.fA.nE.O...gy..2|
-00000430  d8 91 a2 e0 a2 61 21 7e  0a 79 82 da 4a 97 3f 7c  |.....a!~.y..J.?||
-00000440  8a b5 0a 27 b6 69 18 bf  fc b0 ea 3d 1d 58 c3 e7  |...'.i.....=.X..|
-00000450  bb 60 d2 52 24 9c 4b bb  3e 8a 7a 08 d3 dc e8 0f  |.`.R$.K.>.z.....|
-00000460  b8 40 42 0a 68 d7 a1 db  d8 20 4f 10 9a 5c 94 9a  |.@B.h.... O..\..|
-00000470  de d9 e6 ef 1c c9 17 61                           |.......a|
+00000080  03 03 00 01 01 17 03 03  00 17 e2 d2 17 5f 12 74  |............._.t|
+00000090  c1 79 bc 63 27 63 e7 52  05 50 f5 13 16 ea 3e 9e  |.y.c'c.R.P....>.|
+000000a0  19 17 03 03 02 6d dd 67  27 89 03 8e f4 db 9b 65  |.....m.g'......e|
+000000b0  bc ff 5e 8a 9b a2 20 3c  4d ee b2 98 e3 52 94 b1  |..^... <M....R..|
+000000c0  ab b2 6c 96 31 08 29 d8  f8 f3 a6 86 42 1e 82 42  |..l.1.).....B..B|
+000000d0  79 ad 44 de da 44 ac c6  c8 ae 0f ce 8c f5 03 1a  |y.D..D..........|
+000000e0  26 78 0e 92 e4 0b 81 84  ce 89 f1 a6 ee b1 c1 62  |&x.............b|
+000000f0  92 79 69 2b b6 4b 1f 2d  81 9c 06 1e f2 c5 0a 21  |.yi+.K.-.......!|
+00000100  5c f8 1f 3a 8d 0c dd 04  2b fb 96 0c e5 ed a9 9c  |\..:....+.......|
+00000110  34 42 fb 31 89 04 09 a5  9f ed ec cd ba 88 d7 de  |4B.1............|
+00000120  ae bb 96 1a fd 49 c7 6b  1f 9e 5a 2b 12 26 91 3b  |.....I.k..Z+.&.;|
+00000130  17 5a 32 d1 7e 60 4a 55  de ed 39 0d 6b e2 ed a8  |.Z2.~`JU..9.k...|
+00000140  21 bc 3f 94 3d bf aa b9  84 5a 76 21 27 e7 9e 7a  |!.?.=....Zv!'..z|
+00000150  f0 93 8b e3 3f a5 00 af  8d 62 b6 c8 ef 69 cf 99  |....?....b...i..|
+00000160  0e 94 90 29 e4 ed 8b d5  06 c6 1e ea f0 a1 08 48  |...)...........H|
+00000170  4a 6a cf 9b 6c 8a b7 41  ad 58 ea fe 90 43 94 77  |Jj..l..A.X...C.w|
+00000180  b0 80 c9 26 79 a3 5d 89  ef 93 10 f1 37 43 07 e2  |...&y.].....7C..|
+00000190  c3 af 1f 6c 46 d8 3b c6  54 c1 d4 72 ad 15 a1 b9  |...lF.;.T..r....|
+000001a0  4f 72 74 f0 ed 62 3b 83  75 ab 12 5c 87 df 8e b8  |Ort..b;.u..\....|
+000001b0  79 af c3 f8 e0 fb f6 b7  ab ec 67 3e ec 05 a1 69  |y.........g>...i|
+000001c0  69 d5 56 45 b2 3b 5f 24  42 b9 4f 43 ec 0d 0d 6c  |i.VE.;_$B.OC...l|
+000001d0  0e 44 10 e6 45 e1 a2 11  27 e6 70 a8 d3 a4 2e a1  |.D..E...'.p.....|
+000001e0  43 d6 a5 46 79 d1 e8 37  07 c0 29 68 fa ab dc 67  |C..Fy..7..)h...g|
+000001f0  91 94 04 28 aa 12 01 3f  c7 4f d6 a8 93 99 53 5e  |...(...?.O....S^|
+00000200  0b 5f ff 83 a0 14 47 23  e6 5e 3c a0 e4 47 28 74  |._....G#.^<..G(t|
+00000210  20 a4 cc 28 03 41 62 5a  27 eb 22 33 ba ac e2 63  | ..(.AbZ'."3...c|
+00000220  c7 a6 09 c7 87 70 45 1a  8b df 96 89 bc 3f 14 0d  |.....pE......?..|
+00000230  28 5a 67 a1 d4 30 a3 c3  3a 4b 1f 0e a7 7d 40 cd  |(Zg..0..:K...}@.|
+00000240  0e 59 12 2d be 40 ea c1  cb fc b0 d3 42 72 56 4b  |.Y.-.@......BrVK|
+00000250  7a a8 e8 70 d6 07 e0 0a  69 ad e6 0b e9 da b7 27  |z..p....i......'|
+00000260  57 e6 aa d3 0d 46 86 93  c0 ce e6 1a b8 8f bb 95  |W....F..........|
+00000270  09 58 e7 51 96 53 4e 71  70 bf 34 7a b0 e9 a8 e7  |.X.Q.SNqp.4z....|
+00000280  51 0f 0c 68 f1 9f 17 28  53 d4 ac 7a 9f 06 cc ce  |Q..h...(S..z....|
+00000290  36 81 e7 bf f2 85 b5 5b  4e 23 84 70 67 d5 45 a3  |6......[N#.pg.E.|
+000002a0  3a df f2 26 7c 93 d0 47  f9 0d 87 21 a0 e3 05 a3  |:..&|..G...!....|
+000002b0  ed 7b 99 7d 56 1f 43 77  4e fb db 7d 63 70 a0 fb  |.{.}V.CwN..}cp..|
+000002c0  bf 41 d7 48 a8 ae b1 70  1e 99 ae 2b e5 1c 7b 4d  |.A.H...p...+..{M|
+000002d0  a8 a6 86 39 83 d4 63 32  56 57 44 4c 44 2e 77 22  |...9..c2VWDLD.w"|
+000002e0  7b e4 33 3a 40 df f1 7e  21 8a 8d da 72 dd 6f 29  |{.3:@..~!...r.o)|
+000002f0  5a de 90 0c a2 76 e0 73  7a 82 d3 26 88 e1 f7 c5  |Z....v.sz..&....|
+00000300  69 c2 04 9b 98 4b 49 7f  e3 ac 18 90 85 4f ec c7  |i....KI......O..|
+00000310  29 67 b7 17 03 03 00 99  1c 83 e0 03 3a 6e 3e 08  |)g..........:n>.|
+00000320  e5 33 26 ca 22 a7 01 d9  8c fa f8 75 74 4a 34 a9  |.3&."......utJ4.|
+00000330  12 f7 0a fd 49 2e ef 7d  07 97 59 d7 5a 69 b2 cb  |....I..}..Y.Zi..|
+00000340  07 a4 5e 5d 52 f5 4b 50  b3 df 46 fd 3e 86 fe 07  |..^]R.KP..F.>...|
+00000350  98 94 ad cd 2b a2 11 03  1c 1b 13 03 ba 13 68 e4  |....+.........h.|
+00000360  45 5a 70 41 92 a1 67 65  a3 23 4b 81 47 3b 18 a4  |EZpA..ge.#K.G;..|
+00000370  6e 8f 62 e1 2b ee 5f 77  35 e2 07 f7 c9 39 ec 9f  |n.b.+._w5....9..|
+00000380  e5 dc b6 e9 64 b9 83 50  02 3f e6 2f ba 3e f6 97  |....d..P.?./.>..|
+00000390  0b 75 9d e2 d6 ac 86 89  a2 ce 99 29 7b 11 de 6a  |.u.........){..j|
+000003a0  23 da 7c 84 ec d3 71 f4  fd 6b 5c 0a c0 25 3e c0  |#.|...q..k\..%>.|
+000003b0  11 17 03 03 00 35 39 bb  d8 45 80 5d 07 86 99 65  |.....59..E.]...e|
+000003c0  7c 85 6f 3a 08 e2 a4 fa  2e be 23 63 51 64 71 7c  ||.o:......#cQdq||
+000003d0  d7 5d 87 31 91 53 6e 77  7d ea d1 66 fd b7 a9 0e  |.].1.Snw}..f....|
+000003e0  c9 da dc ba b7 d9 5f 0f  33 fd 52 17 03 03 00 8b  |......_.3.R.....|
+000003f0  99 86 2a e1 93 87 40 c9  6e 9d 27 7d dd a0 03 a2  |..*...@.n.'}....|
+00000400  65 cb c2 63 33 59 2f 4a  a7 01 56 94 28 e4 ec c7  |e..c3Y/J..V.(...|
+00000410  8f 62 ed 71 c1 80 b9 f8  55 07 0b ab 2a bd f8 68  |.b.q....U...*..h|
+00000420  7d 90 a9 98 36 5b d8 f3  00 22 d9 a9 76 30 ef cd  |}...6[..."..v0..|
+00000430  3f 42 68 af 70 5b 12 c8  9d f8 00 01 3d 02 82 44  |?Bh.p[......=..D|
+00000440  2d a6 2e dc 3b b4 42 5c  c6 01 c4 fb a3 32 86 10  |-...;.B\.....2..|
+00000450  d8 25 ab 87 24 d7 38 7f  dd b8 5f f9 5e 47 a9 57  |.%..$.8..._.^G.W|
+00000460  cc 48 fb 0f 74 4a db 4f  db 92 21 be 08 7c 53 6f  |.H..tJ.O..!..|So|
+00000470  89 3f 68 77 cd 02 a7 aa  9c 9d b5                 |.?hw.......|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 f0 71 3b 42 f3  |..........5.q;B.|
-00000010  d1 22 ef 3a e4 5e a4 eb  ac 2b 81 16 9a 02 53 84  |.".:.^...+....S.|
-00000020  57 aa f4 d8 f9 1a 0b 28  fe 00 b4 bf fb 84 b0 c4  |W......(........|
-00000030  42 06 3a 8b 15 73 5a 5b  bf f1 33 e1 88 82 fd 33  |B.:..sZ[..3....3|
+00000000  14 03 03 00 01 01 17 03  03 00 35 1d f1 fe e2 c3  |..........5.....|
+00000010  4e 95 57 0b 7e d6 32 45  6b 9c ed 89 c2 69 62 70  |N.W.~.2Ek....ibp|
+00000020  79 0f a8 42 72 94 05 ad  f5 fe a5 83 4b 56 80 41  |y..Br.......KV.A|
+00000030  2c 58 e0 e2 00 70 de c1  39 c8 fa c4 bb 89 57 aa  |,X...p..9.....W.|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e c8 09 b0  08 ba 0c 28 a0 5a 07 d5  |...........(.Z..|
-00000010  88 ae 7d 29 c6 41 c4 5a  09 12 0f ae af 07 b5 9a  |..}).A.Z........|
-00000020  ca c2 0c 17 03 03 00 13  3a e7 17 14 0a 0f 73 2d  |........:.....s-|
-00000030  99 e9 65 4d af 11 29 ea  1f e1 c0                 |..eM..)....|
+00000000  17 03 03 00 1e a3 8a 39  2d 93 5d d3 ce cd 5a 31  |.......9-.]...Z1|
+00000010  19 21 b8 b5 6f 3e 58 7a  0c 09 9b a8 4b 23 3d 3d  |.!..o>Xz....K#==|
+00000020  d7 73 7a 17 03 03 00 13  d1 a5 7c 5e 2e fa 6b 86  |.sz.......|^..k.|
+00000030  f9 36 3c 8d 2b 5b 7e 58  db c8 0d                 |.6<.+[~X...|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-AES256-SHA384 b/src/crypto/tls/testdata/Server-TLSv13-AES256-SHA384
index 6a871e439b..64310a1546 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-AES256-SHA384
+++ b/src/crypto/tls/testdata/Server-TLSv13-AES256-SHA384
@@ -1,100 +1,100 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 97 c1 ee f7 f2  |................|
-00000010  ae 15 07 a8 a8 fc 07 99  9c f2 35 b9 00 0d c9 55  |..........5....U|
-00000020  a6 cd 11 19 c0 f9 f8 a5  55 12 c0 20 16 5a fe 4d  |........U.. .Z.M|
-00000030  4f 17 ec 8c 91 41 90 54  4b 2b b1 19 f0 b0 1f 67  |O....A.TK+.....g|
-00000040  ad 5b 6b 33 df 9f d7 2c  63 8b 80 91 00 04 13 02  |.[k3...,c.......|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 c4 ac 32 36 24  |.............26$|
+00000010  08 b0 6c 1d 1e 58 7e b3  3d 52 35 29 85 52 3a b3  |..l..X~.=R5).R:.|
+00000020  32 a2 71 86 4b 33 5d bb  b8 b8 ac 20 77 6d 45 2f  |2.q.K3].... wmE/|
+00000030  a3 fe 59 3f 9b cf 4e 60  55 84 f7 99 c2 f5 7e 1e  |..Y?..N`U.....~.|
+00000040  6f 0a 4d fe bf 13 e8 95  80 a7 7d c6 00 04 13 02  |o.M.......}.....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 b1  |-.....3.&.$... .|
-000000b0  9f bf 4b 28 d5 6d a5 48  f7 06 32 f3 51 ca e1 c5  |..K(.m.H..2.Q...|
-000000c0  02 23 aa fa 22 f2 01 af  bf ba d1 b8 ac 11 23     |.#..".........#|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 8f  |-.....3.&.$... .|
+000000b0  5a 28 ca 6a 1b 42 2f 1a  53 8f cc 4f 88 b3 0c ad  |Z(.j.B/.S..O....|
+000000c0  35 59 c5 10 46 ef a4 5f  1e d4 63 69 93 4f 15     |5Y..F.._..ci.O.|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 16 5a fe 4d  |........... .Z.M|
-00000030  4f 17 ec 8c 91 41 90 54  4b 2b b1 19 f0 b0 1f 67  |O....A.TK+.....g|
-00000040  ad 5b 6b 33 df 9f d7 2c  63 8b 80 91 13 02 00 00  |.[k3...,c.......|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 77 6d 45 2f  |........... wmE/|
+00000030  a3 fe 59 3f 9b cf 4e 60  55 84 f7 99 c2 f5 7e 1e  |..Y?..N`U.....~.|
+00000040  6f 0a 4d fe bf 13 e8 95  80 a7 7d c6 13 02 00 00  |o.M.......}.....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 21 12 ff 3f 25 b6  |..........!..?%.|
-00000090  d7 7a 73 c7 85 d3 3d ae  89 1a 55 b1 f3 45 5e f3  |.zs...=...U..E^.|
-000000a0  c8 17 03 03 02 6d 7c ae  9e 9a 27 ee 14 a0 81 9e  |.....m|...'.....|
-000000b0  fc e9 0b 0e a0 15 f6 8a  8d 07 36 b1 eb 03 f6 a4  |..........6.....|
-000000c0  d1 3b 1d bb d4 32 4f 75  36 55 b4 e5 0c a5 dd 1f  |.;...2Ou6U......|
-000000d0  dc 73 44 0b 13 66 17 cc  3e 8e ce 92 1e 8d 09 12  |.sD..f..>.......|
-000000e0  60 8e e2 1a 64 1f 63 c4  6b 9f 69 70 1b 26 3f 00  |`...d.c.k.ip.&?.|
-000000f0  5b f2 30 9b 2b 47 11 e8  16 6a c1 8c d9 69 2f ce  |[.0.+G...j...i/.|
-00000100  a3 79 ae 2f 1b 44 13 3b  aa 46 69 c9 dc 20 29 2c  |.y./.D.;.Fi.. ),|
-00000110  3c b4 8c b7 19 05 dc dc  90 fe 89 ec eb 71 c3 82  |<............q..|
-00000120  67 e3 04 9f 48 ab 8b 90  39 0a c2 2d 4f ae 31 8c  |g...H...9..-O.1.|
-00000130  d3 86 c6 26 96 25 69 c4  25 1b 54 61 7e 43 46 a0  |...&.%i.%.Ta~CF.|
-00000140  fa 95 35 0e 21 d5 5b 29  b1 ca 1c f3 4d b7 c4 68  |..5.!.[)....M..h|
-00000150  8d 36 5c 82 fa 3e 7d e7  cc 8a 27 cb e6 2c ea 12  |.6\..>}...'..,..|
-00000160  ea 4d 21 d4 09 b2 f7 07  16 ae 17 d1 48 3b b6 3e  |.M!.........H;.>|
-00000170  ac 41 2f f7 e0 23 94 c8  b6 b6 60 7e 70 c9 a6 d3  |.A/..#....`~p...|
-00000180  ac 64 1e 05 e4 be f7 a3  d8 fe 2f da 9e 25 9f 98  |.d......../..%..|
-00000190  22 b7 8a 90 2a 5c c6 35  7f 62 72 8d fc 73 d5 d7  |"...*\.5.br..s..|
-000001a0  ee bb 86 22 9b e2 b1 1a  c2 82 e1 26 b3 6d af 11  |...".......&.m..|
-000001b0  00 81 5a 81 96 04 63 f5  b3 fd a3 3f 26 84 a8 cd  |..Z...c....?&...|
-000001c0  95 c0 5d 81 3f 9e 0f 02  56 ff 65 fc a5 2e d6 c8  |..].?...V.e.....|
-000001d0  b5 b6 7d 8e 27 54 a3 e3  3d 00 1b ec 92 e9 a6 1d  |..}.'T..=.......|
-000001e0  74 dd dc bd c4 82 be 81  0e 6b 07 f2 2c 40 d8 c0  |t........k..,@..|
-000001f0  93 91 83 f8 8c 0a c8 94  a3 4e 80 d3 57 9e bf 9e  |.........N..W...|
-00000200  f0 b2 c9 cb 51 0d 98 d5  4b b9 8f 39 e5 dc 9d b5  |....Q...K..9....|
-00000210  03 8f f6 9f c2 eb 0c fb  35 24 9d a6 8c 84 cb 48  |........5$.....H|
-00000220  64 dc bf 3d 91 73 f4 f1  46 7d f7 62 0f 30 7d 09  |d..=.s..F}.b.0}.|
-00000230  c2 2e 40 17 83 0a e5 e5  93 d8 80 53 c3 13 ea 47  |..@........S...G|
-00000240  2d 47 77 77 6e 60 a2 d8  29 76 7d 0b 7f 80 18 ea  |-Gwwn`..)v}.....|
-00000250  23 8e a3 37 00 87 0b c6  5d 01 74 53 22 63 99 f0  |#..7....].tS"c..|
-00000260  86 19 8b ca 27 27 83 75  87 60 d6 e3 ff 00 c3 66  |....''.u.`.....f|
-00000270  13 d0 e3 f9 48 3c d6 bd  f7 70 d4 3d e3 88 92 2f  |....H<...p.=.../|
-00000280  ee ea 71 d2 60 f2 1b ce  91 a9 ea 54 dc ca 88 b7  |..q.`......T....|
-00000290  c8 b2 67 87 9d 65 1f 99  47 35 db e6 7b 9c 92 74  |..g..e..G5..{..t|
-000002a0  2e f2 6c e3 6c a3 5c 39  a3 de f7 38 11 5b 4a 1c  |..l.l.\9...8.[J.|
-000002b0  17 6e 9a e5 d3 69 e7 42  91 ff a7 88 75 0e 0a ba  |.n...i.B....u...|
-000002c0  87 0b ac 88 b5 2b 27 5b  a7 ba a2 26 ac 48 ab b8  |.....+'[...&.H..|
-000002d0  1e e5 76 1a 0c 3e 6c 98  87 d1 b0 cc 34 2a dc d2  |..v..>l.....4*..|
-000002e0  59 a8 c6 82 e6 d1 be 53  c3 30 7f e6 be c2 86 9c  |Y......S.0......|
-000002f0  2b b6 3d c5 2d 1e 31 1b  b1 2e fe a0 1b c7 40 80  |+.=.-.1.......@.|
-00000300  1a 0c 1b d7 82 e8 c0 ce  43 5a 4a ae 19 08 40 9f  |........CZJ...@.|
-00000310  cc 17 15 17 03 03 00 99  0a d6 13 12 9a e1 25 ba  |..............%.|
-00000320  4f fc 7e 27 80 7a 97 24  18 af eb 56 a4 70 91 16  |O.~'.z.$...V.p..|
-00000330  c6 4d 1a 54 92 b3 21 11  bc bd d9 3d 0d ee 7b 76  |.M.T..!....=..{v|
-00000340  23 28 6e 01 33 07 e1 bb  6f 0b f5 e3 a7 ee d9 eb  |#(n.3...o.......|
-00000350  72 d6 0a e2 6b 06 89 14  59 9d 24 9d 3c 19 c3 fe  |r...k...Y.$.<...|
-00000360  b5 83 0e 40 45 0d 60 11  6d 94 14 bd 01 b6 f6 1c  |...@E.`.m.......|
-00000370  ff ac e7 42 83 84 9f 21  a7 c2 ae 60 ba d4 95 0c  |...B...!...`....|
-00000380  5f 3a ca 22 2e 3a 20 7b  69 35 c9 cf 0c f9 f7 87  |_:.".: {i5......|
-00000390  92 80 e3 e5 8f f6 4f 06  eb 1f ad 62 65 67 e2 c9  |......O....beg..|
-000003a0  21 96 8b 12 78 25 d3 f5  be 9f 9f d3 12 4c 89 b5  |!...x%.......L..|
-000003b0  c0 17 03 03 00 45 a1 ff  13 69 40 48 5c 0f 50 3d  |.....E...i@H\.P=|
-000003c0  19 b7 a7 5f 93 96 a7 24  01 dc e0 a2 25 d5 49 cc  |..._...$....%.I.|
-000003d0  7c 3c 7e 98 b1 23 33 c2  c7 ff 05 55 a3 2c 89 58  ||<~..#3....U.,.X|
-000003e0  0f 81 f9 1f 3e f6 88 6c  1e 64 4e b2 c3 eb 56 22  |....>..l.dN...V"|
-000003f0  fe af 29 c4 00 fe f7 96  3b d2 54 17 03 03 00 98  |..).....;.T.....|
-00000400  2a 13 d1 8e 4c 83 10 d7  9f 2b 4c d1 81 fc 8c 4b  |*...L....+L....K|
-00000410  89 19 44 6a 35 c5 a9 9f  e3 79 47 68 4e 2d 9f ec  |..Dj5....yGhN-..|
-00000420  7f 96 9f 2b 97 5f 96 96  5e 15 68 d2 50 bb 96 55  |...+._..^.h.P..U|
-00000430  32 25 68 1e d4 34 e5 12  fb 15 82 21 53 dd 60 48  |2%h..4.....!S.`H|
-00000440  33 1b 73 9d 42 df cf cb  bc 7f cf b1 c8 b7 93 d9  |3.s.B...........|
-00000450  ba fa 0d 14 59 77 9a 89  a3 5c a2 c3 d6 a3 00 3f  |....Yw...\.....?|
-00000460  bc e2 71 3a 27 1b 50 43  85 a1 39 01 4e 69 dc 12  |..q:'.PC..9.Ni..|
-00000470  32 45 1d 94 70 a1 25 ee  56 2c 10 75 be 61 91 dd  |2E..p.%.V,.u.a..|
-00000480  0e 51 e7 51 3f b8 79 da  9d 4c ba 91 2d d1 4f 04  |.Q.Q?.y..L..-.O.|
-00000490  45 e1 d9 9d 26 ff cd 0a                           |E...&...|
+00000080  03 03 00 01 01 17 03 03  00 17 e4 b2 43 7d 15 fc  |............C}..|
+00000090  ae 58 44 9d 0d 82 a4 1c  21 c4 3f 86 fb 4b 6b d1  |.XD.....!.?..Kk.|
+000000a0  96 17 03 03 02 6d 03 84  7a 2c 7e d8 c8 ca 31 07  |.....m..z,~...1.|
+000000b0  fc 2c 47 5b e4 c1 e1 5f  1a c9 a0 45 4e 9a 3d 63  |.,G[..._...EN.=c|
+000000c0  11 3b 26 d7 05 e3 6c 36  c3 49 46 c3 73 4e ee 97  |.;&...l6.IF.sN..|
+000000d0  dc 4e 09 f4 22 0f 34 05  e1 84 d5 ed 76 a1 4e ba  |.N..".4.....v.N.|
+000000e0  7c d7 9c 9d 16 ae 96 0f  62 41 64 80 ed fc 4c 1e  ||.......bAd...L.|
+000000f0  75 a4 5a fe bf 7c 95 6f  81 ef bb e9 9c 69 63 df  |u.Z..|.o.....ic.|
+00000100  b0 07 d1 4f 1e 96 9e c9  a4 09 d6 79 f2 33 58 eb  |...O.......y.3X.|
+00000110  78 a5 a7 29 27 58 1b 99  79 79 e3 1d 61 6e fd 7b  |x..)'X..yy..an.{|
+00000120  c8 7f c6 07 3a f5 23 d6  4d 7a 74 af 53 f6 b1 63  |....:.#.Mzt.S..c|
+00000130  2f eb 51 65 b5 91 ac af  4b bf 9e 98 90 8a ae 02  |/.Qe....K.......|
+00000140  86 35 78 66 13 2c de 95  5b e1 d8 78 18 bf 65 8f  |.5xf.,..[..x..e.|
+00000150  a2 30 ae e7 fa aa ac bc  44 72 03 f5 86 b1 1b c2  |.0......Dr......|
+00000160  d5 61 dc 4d 74 47 73 67  f1 43 11 1a 95 6f e3 88  |.a.MtGsg.C...o..|
+00000170  51 9a 4b c7 bd dc 36 8f  5d de 56 4c 8d 30 8d ec  |Q.K...6.].VL.0..|
+00000180  08 0b 90 be c8 dc df 7d  6e e7 85 c9 ab dd be a9  |.......}n.......|
+00000190  57 c4 6a 76 36 bb a8 4b  e2 be d1 28 67 3b a9 0c  |W.jv6..K...(g;..|
+000001a0  a1 78 2e e4 af f4 51 a3  f5 8c b3 8d c8 7c 8e e7  |.x....Q......|..|
+000001b0  d2 7f 38 91 04 42 f4 e9  ae e2 3a 3d 37 10 78 f3  |..8..B....:=7.x.|
+000001c0  2d 9c 9f f7 4f 49 f0 45  bd 1e 8d 7d e3 84 b9 9a  |-...OI.E...}....|
+000001d0  75 40 fb 2b 4f 71 2d b7  bd 1a 6e 4a 7a b4 53 f8  |u@.+Oq-...nJz.S.|
+000001e0  d7 c9 6e d9 f6 7b de fa  f0 12 5d fc c0 71 1a bf  |..n..{....]..q..|
+000001f0  76 d8 c4 ad c5 f7 e2 79  55 79 40 e5 55 ee bc dc  |v......yUy@.U...|
+00000200  42 06 97 89 da 2d a7 e9  26 e4 82 e1 63 5f e2 ee  |B....-..&...c_..|
+00000210  1a 37 6d 65 bf d7 5f 2e  86 a5 a8 4d b2 e1 31 2f  |.7me.._....M..1/|
+00000220  8b c5 0b 88 03 bf 1f 37  8c 96 ec 54 4f 75 9b f9  |.......7...TOu..|
+00000230  00 98 96 e6 db c1 24 94  6a d1 dd f7 9b d2 2e 24  |......$.j......$|
+00000240  82 c7 34 5a f6 aa 36 5b  b7 63 11 b2 1d 15 a6 48  |..4Z..6[.c.....H|
+00000250  74 5c a7 70 a9 c4 fc 14  67 51 7e 16 7c 90 5b 64  |t\.p....gQ~.|.[d|
+00000260  ff 49 02 f6 4d 7a c2 f9  d7 1d 47 4b de bf ae ca  |.I..Mz....GK....|
+00000270  03 56 84 31 01 37 80 85  79 fb d8 f4 72 9f 98 a3  |.V.1.7..y...r...|
+00000280  44 d4 52 f8 af 8c 98 d8  66 69 f7 71 58 db 42 fa  |D.R.....fi.qX.B.|
+00000290  d7 c9 05 d1 9d 7a df 9f  a9 b1 12 53 d2 70 fa ca  |.....z.....S.p..|
+000002a0  7e a6 de 8d ed 08 69 b2  34 45 3a a5 ba 1d 2e d8  |~.....i.4E:.....|
+000002b0  d5 ee ee 60 16 18 cc e1  db aa e6 1b 19 5a ec e6  |...`.........Z..|
+000002c0  b8 ec 51 46 99 6d 1e 83  9b 9d 44 a7 85 5a 10 23  |..QF.m....D..Z.#|
+000002d0  74 a3 b6 09 b5 d7 2a 12  6a e2 2a da 5d 87 d9 fe  |t.....*.j.*.]...|
+000002e0  b6 c7 8f c8 03 27 b0 6e  98 57 6f e4 d5 8b 88 5d  |.....'.n.Wo....]|
+000002f0  0a b3 c4 a1 ae df 89 53  af d5 8e 59 97 2d 65 c0  |.......S...Y.-e.|
+00000300  52 e8 5f 8a 37 3f 8b ef  77 fc 93 0c b5 50 3b 94  |R._.7?..w....P;.|
+00000310  13 1b 3b 17 03 03 00 99  3e e8 05 5a 69 dc 0c 90  |..;.....>..Zi...|
+00000320  a3 17 35 ea 27 2b da 64  44 72 30 5b 9c a5 6b 1b  |..5.'+.dDr0[..k.|
+00000330  c2 a8 af 38 c3 43 52 14  fd ec a8 8b c9 ab 6b 67  |...8.CR.......kg|
+00000340  32 84 f9 b4 e1 89 08 8f  6a c2 2a 17 b9 f5 92 c8  |2.......j.*.....|
+00000350  3a 97 62 98 b8 93 94 5d  a1 6b 05 17 56 5d 6e b5  |:.b....].k..V]n.|
+00000360  d3 72 a6 06 77 b2 45 fe  2d 37 10 7e b8 16 16 f4  |.r..w.E.-7.~....|
+00000370  70 86 56 a4 be 52 54 3e  90 7d 47 66 23 35 e9 a2  |p.V..RT>.}Gf#5..|
+00000380  e9 4f 86 e2 a7 b9 20 b6  c8 9f 19 08 6b 73 93 86  |.O.... .....ks..|
+00000390  d7 8d 1a 9a 00 6b cf fb  cb 32 5d 36 91 4f 39 e2  |.....k...2]6.O9.|
+000003a0  f5 0d fa 37 3d b8 c6 86  cb 57 71 a8 c6 f8 74 cb  |...7=....Wq...t.|
+000003b0  c0 17 03 03 00 45 67 fe  1b 83 1a bf ac 3b ee 0f  |.....Eg......;..|
+000003c0  31 35 da 42 6c e3 3f 14  63 4a f3 5b 5b 02 76 c8  |15.Bl.?.cJ.[[.v.|
+000003d0  21 84 7e 11 42 e3 8c e7  b6 7c 1d ba 41 ec dd 68  |!.~.B....|..A..h|
+000003e0  73 4a 1b c5 bc 11 fa 22  33 9b 51 7d f0 27 88 4a  |sJ....."3.Q}.'.J|
+000003f0  1b bf e8 a9 3f f5 2f 9a  05 ce 07 17 03 03 00 9b  |....?./.........|
+00000400  da 09 d0 83 a3 24 92 94  b7 9f 34 10 7b 1c b9 e4  |.....$....4.{...|
+00000410  ca 56 c9 8f 71 03 99 0b  c5 ea 6d 50 6d 75 dd 7b  |.V..q.....mPmu.{|
+00000420  28 4d 5c 6e 32 83 61 36  68 0b 64 ac b7 6b ec bb  |(M\n2.a6h.d..k..|
+00000430  22 72 56 4b 6a 58 98 a2  62 9c 15 28 fa a8 38 a3  |"rVKjX..b..(..8.|
+00000440  63 b7 8b d4 3d 63 3f 64  34 45 e2 f1 ad e6 3e 66  |c...=c?d4E....>f|
+00000450  8e 45 5f 3e ca fc 5e a8  40 17 a9 ac c6 52 e4 4e  |.E_>..^.@....R.N|
+00000460  14 15 0b a1 00 db 8c a2  dd 41 35 74 1f f4 06 ac  |.........A5t....|
+00000470  72 8c 86 1f a9 de 6d 1c  24 6d 2d 37 f2 dd 1a f9  |r.....m.$m-7....|
+00000480  60 0d 48 fc 8e a3 97 5a  9b 6b 99 13 77 4c f8 bf  |`.H....Z.k..wL..|
+00000490  b3 e5 db 07 31 3d b9 a9  56 9f c2                 |....1=..V..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 45 53 26 d9 60 e9  |..........ES&.`.|
-00000010  10 a7 8b e6 87 88 ab 40  77 25 4c 06 9e 90 be 96  |.......@w%L.....|
-00000020  83 f2 f7 72 1e ed 66 c6  bd 2f 48 d0 56 a9 c1 d2  |...r..f../H.V...|
-00000030  9e 38 9a e3 6f 4f d3 e9  e2 16 72 d7 52 39 86 69  |.8..oO....r.R9.i|
-00000040  cc 7a 72 2b a4 c0 41 4c  64 f6 b1 a3 8d 2f dd 8f  |.zr+..ALd..../..|
+00000000  14 03 03 00 01 01 17 03  03 00 45 2a e9 8b e0 d6  |..........E*....|
+00000010  52 b2 a9 01 20 d1 48 61  5e 6a c3 cf 79 14 f3 c0  |R... .Ha^j..y...|
+00000020  8e 1f 76 2b 16 d5 53 c8  ae a8 a5 7b 14 aa 8c 4b  |..v+..S....{...K|
+00000030  5d 76 e6 dd 5b b9 1f 87  39 62 f6 e5 72 13 1e d0  |]v..[...9b..r...|
+00000040  48 06 f5 d9 ce b8 4d 32  42 49 f1 dd 52 96 e5 68  |H.....M2BI..R..h|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 65 7d 59  f1 cf fe df 97 4a c8 f9  |.....e}Y.....J..|
-00000010  4a 85 3a 5f a2 02 00 f1  09 15 70 67 91 13 be 44  |J.:_......pg...D|
-00000020  de 22 17 17 03 03 00 13  dc 70 04 9b 4c d7 9f 9a  |.".......p..L...|
-00000030  b0 5c 40 aa cc d4 a7 5a  9c 56 20                 |.\@....Z.V |
+00000000  17 03 03 00 1e 97 3a d5  e2 f1 22 da d5 0a 3a 2c  |......:..."...:,|
+00000010  c1 c0 53 ff 44 bd 06 02  02 eb b6 91 c5 b3 d7 c7  |..S.D...........|
+00000020  c2 6e 56 17 03 03 00 13  af c2 91 94 6e db 5e 62  |.nV.........n.^b|
+00000030  9a 1e 40 e4 50 a1 b4 9c  16 45 be                 |..@.P....E.|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ALPN b/src/crypto/tls/testdata/Server-TLSv13-ALPN
index 551b703cff..7537272ee6 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ALPN
+++ b/src/crypto/tls/testdata/Server-TLSv13-ALPN
@@ -1,9 +1,9 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 e2 01 00 00  de 03 03 51 d6 14 92 24  |...........Q...$|
-00000010  c5 f3 c8 8a 17 45 15 5b  67 fa 9e a3 81 23 71 d2  |.....E.[g....#q.|
-00000020  07 8e b8 39 0b 07 89 65  4f d5 af 20 d7 10 6d 0e  |...9...eO.. ..m.|
-00000030  65 cd e6 51 cd c7 f7 29  80 e6 d9 25 d7 d2 3c 18  |e..Q...)...%..<.|
-00000040  1c 12 c2 aa 3d 54 fb 3e  6f 7c 97 ae 00 04 13 03  |....=T.>o|......|
+00000000  16 03 01 00 e2 01 00 00  de 03 03 35 09 24 92 91  |...........5.$..|
+00000010  f9 de f8 f0 68 a2 6d f2  e6 2a df de f1 7c c4 44  |....h.m..*...|.D|
+00000020  7b 22 14 03 29 2a f2 1b  6c a2 0e 20 e4 bc 0e 83  |{"..)*..l.. ....|
+00000030  35 d7 c1 4c ea 8f ba 77  32 ae c9 44 b0 51 16 05  |5..L...w2..D.Q..|
+00000040  06 03 6b c9 23 06 42 26  80 25 6d 67 00 04 13 03  |..k.#.B&.%mg....|
 00000050  00 ff 01 00 00 91 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 10 00 10 00 0e  06 70 72 6f 74 6f 32 06  |.........proto2.|
@@ -11,90 +11,90 @@
 00000090  00 1e 00 1c 04 03 05 03  06 03 08 07 08 08 08 09  |................|
 000000a0  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
 000000b0  00 2b 00 03 02 03 04 00  2d 00 02 01 01 00 33 00  |.+......-.....3.|
-000000c0  26 00 24 00 1d 00 20 58  b3 f3 ca f0 ed df aa 37  |&.$... X.......7|
-000000d0  a7 d6 78 21 9a dc 01 05  36 f2 a0 b2 59 d4 47 56  |..x!....6...Y.GV|
-000000e0  2e bd 39 46 38 b7 74                              |..9F8.t|
+000000c0  26 00 24 00 1d 00 20 59  cf 4e a0 d2 89 c8 fd 8b  |&.$... Y.N......|
+000000d0  22 e8 ce 43 a4 b4 2b b3  9f 12 46 c0 21 2a 10 55  |"..C..+...F.!*.U|
+000000e0  fd a7 6f 65 04 51 21                              |..oe.Q!|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 d7 10 6d 0e  |........... ..m.|
-00000030  65 cd e6 51 cd c7 f7 29  80 e6 d9 25 d7 d2 3c 18  |e..Q...)...%..<.|
-00000040  1c 12 c2 aa 3d 54 fb 3e  6f 7c 97 ae 13 03 00 00  |....=T.>o|......|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 e4 bc 0e 83  |........... ....|
+00000030  35 d7 c1 4c ea 8f ba 77  32 ae c9 44 b0 51 16 05  |5..L...w2..D.Q..|
+00000040  06 03 6b c9 23 06 42 26  80 25 6d 67 13 03 00 00  |..k.#.B&.%mg....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 24 fd 42 02 db 42 3c  |.........$.B..B<|
-00000090  94 97 c7 54 12 f6 4a b0  86 7f bf a6 ad 9d 70 e8  |...T..J.......p.|
-000000a0  b7 a8 e4 db 6c 6a 6c 06  f6 28 60 8b 7b 1d 17 03  |....ljl..(`.{...|
-000000b0  03 02 6d f8 77 4b db b1  68 74 50 c0 19 2f 6d 9f  |..m.wK..htP../m.|
-000000c0  4a 63 5b 7d 0e e0 21 73  b0 05 26 9c 63 ad 99 8e  |Jc[}..!s..&.c...|
-000000d0  5d bb 9b 7d c4 8b 49 63  63 aa 6d e5 1a 93 38 d6  |]..}..Icc.m...8.|
-000000e0  19 f2 b2 42 15 7c ff 75  98 61 0b 10 8e 06 63 ca  |...B.|.u.a....c.|
-000000f0  24 9c 72 2a e1 16 b9 eb  88 e1 05 dd 4b 79 5a 56  |$.r*........KyZV|
-00000100  44 60 b3 51 13 4d 2c 7c  2f 38 e7 df 73 fb 57 d6  |D`.Q.M,|/8..s.W.|
-00000110  13 0d b3 79 fe c6 99 e1  36 11 a1 39 15 14 d1 48  |...y....6..9...H|
-00000120  cd 3c 62 81 c8 c9 52 d0  fe f7 71 c1 a4 71 16 6e  |.<b...R...q..q.n|
-00000130  f5 3e 79 6d 9b 47 61 15  d7 23 cc c5 36 aa ac 57  |.>ym.Ga..#..6..W|
-00000140  c5 2c 11 50 1d ce 64 88  e6 0e 26 fd 1b 7c 0a 59  |.,.P..d...&..|.Y|
-00000150  61 0c 85 e5 82 6c c0 55  2d b1 9e db c6 a4 5e 66  |a....l.U-.....^f|
-00000160  1c d4 1c af 6a 03 e9 d2  43 a0 64 e2 60 ea b3 ec  |....j...C.d.`...|
-00000170  b7 58 67 4a 8b 91 cb 41  bf af 32 10 a2 3d 0d fa  |.XgJ...A..2..=..|
-00000180  5e ba e0 c1 ab fa 27 3d  b4 10 17 e7 6f 0c 56 94  |^.....'=....o.V.|
-00000190  97 54 3a 4a 37 25 88 ea  c9 9c 1d 2e d2 50 41 1f  |.T:J7%.......PA.|
-000001a0  bd 7e 0e 80 bd d0 fe fa  6e 19 b2 9a b6 ec 3a 5b  |.~......n.....:[|
-000001b0  0a 65 ea 0c 24 9e b1 1f  20 dd 9c 91 b1 3e 84 2a  |.e..$... ....>.*|
-000001c0  bb 87 c5 59 16 bb 43 fd  19 82 89 20 39 fe 3f 64  |...Y..C.... 9.?d|
-000001d0  1d 3f 23 5b a0 a8 1e b9  9d b3 e8 18 ad 9b 3e 93  |.?#[..........>.|
-000001e0  b6 7a 21 d7 0f 82 fb d1  53 07 48 9b e8 99 68 34  |.z!.....S.H...h4|
-000001f0  dd aa 13 0e 4e de 23 0d  a6 67 38 eb 41 59 75 d3  |....N.#..g8.AYu.|
-00000200  d9 79 3f 9b a3 2d e8 fd  25 96 c9 f5 a0 73 f3 c7  |.y?..-..%....s..|
-00000210  68 7f b7 8a ed 2c ad 21  4c f7 a4 32 c1 57 ce 55  |h....,.!L..2.W.U|
-00000220  d3 66 ed c8 a7 b6 68 2d  23 30 13 f4 34 b4 88 3a  |.f....h-#0..4..:|
-00000230  ee 30 33 2f d7 86 1c fc  fb 02 81 93 14 56 32 d0  |.03/.........V2.|
-00000240  79 b7 d8 25 8c 51 84 58  d1 a0 d7 22 1e b4 98 84  |y..%.Q.X..."....|
-00000250  dc e6 ab 20 11 06 31 dd  36 bf dd be 5d 91 59 bd  |... ..1.6...].Y.|
-00000260  bf c1 03 44 bd 06 e6 59  07 c5 61 92 46 80 5f 21  |...D...Y..a.F._!|
-00000270  f6 aa c3 cb f6 15 c3 b2  fb 63 93 25 c6 3c 98 07  |.........c.%.<..|
-00000280  3e 00 a0 4d b8 2b 6a 11  3c 1b d8 a4 80 cb 6f 4c  |>..M.+j.<.....oL|
-00000290  b9 3e 4a 20 44 12 f3 b5  b8 85 66 c0 13 48 d3 43  |.>J D.....f..H.C|
-000002a0  c2 ca 17 23 e2 3b af 1f  d7 71 9e b1 15 cc 62 5c  |...#.;...q....b\|
-000002b0  f4 c7 02 6f 61 55 17 99  32 d8 55 41 ca 11 a0 22  |...oaU..2.UA..."|
-000002c0  25 1c cd 37 2c 62 76 7f  35 81 84 bf 97 5e ca 97  |%..7,bv.5....^..|
-000002d0  1f 75 90 f8 9a 81 9b 11  bc 1e 1f a0 e0 cd 78 b9  |.u............x.|
-000002e0  fb 20 fe 63 b2 b8 a3 ff  a5 b7 90 16 f9 46 2a 6b  |. .c.........F*k|
-000002f0  db 2e d6 30 1b 2d 65 d5  8c 7b c2 1c d6 1d 64 8b  |...0.-e..{....d.|
-00000300  17 de 8c 1b bc 06 e3 4a  b8 34 e2 dd 6c 50 27 c6  |.......J.4..lP'.|
-00000310  3d 08 79 70 6c ac 7c 28  fe d9 68 89 e2 b0 73 f5  |=.ypl.|(..h...s.|
-00000320  17 03 03 00 99 1f b5 fc  e9 d8 62 69 b1 e0 6d 33  |..........bi..m3|
-00000330  3e 65 6a 9e 38 52 bd 8f  30 06 e9 06 e2 26 08 28  |>ej.8R..0....&.(|
-00000340  02 45 50 c4 3a b0 3c 2e  f7 dd 15 7b e9 60 e0 89  |.EP.:.<....{.`..|
-00000350  9d fb fa 0b e7 3a 6f ce  59 a8 c0 fa ec ef f4 58  |.....:o.Y......X|
-00000360  a2 d9 e2 45 41 5a eb 9b  6a cf 4b ec 15 74 a4 27  |...EAZ..j.K..t.'|
-00000370  3b 88 eb 62 4d 7b f6 46  27 7d 0b 7f b5 49 76 d0  |;..bM{.F'}...Iv.|
-00000380  d9 29 55 12 de 5a 22 33  d3 80 5e 59 2a 24 b3 71  |.)U..Z"3..^Y*$.q|
-00000390  ab 78 3a 4d d9 e3 94 b1  3d 5f ce aa ec 5d 0d bf  |.x:M....=_...]..|
-000003a0  14 98 7b 63 29 06 36 6a  d4 c8 c8 32 7e 77 8f 33  |..{c).6j...2~w.3|
-000003b0  d9 72 54 a4 6d 87 5a 6f  94 cd 53 28 79 26 17 03  |.rT.m.Zo..S(y&..|
-000003c0  03 00 35 cf 28 5c f3 33  26 3e 71 7b cb 5c e2 05  |..5.(\.3&>q{.\..|
-000003d0  37 6d 67 a0 ca 42 79 e2  23 76 36 86 2e 57 0a e8  |7mg..By.#v6..W..|
-000003e0  cb b1 b3 77 81 4f ac e8  2f 4e d4 e4 49 a9 a6 7c  |...w.O../N..I..||
-000003f0  51 c9 20 36 a3 57 a9 b7  17 03 03 00 88 33 dd 67  |Q. 6.W.......3.g|
-00000400  b2 69 38 87 a8 39 9b df  10 bd 6a 02 1c 6e bc 60  |.i8..9....j..n.`|
-00000410  85 9e 7f 34 fb 72 26 c5  c3 f4 79 35 d1 94 c7 a4  |...4.r&...y5....|
-00000420  92 13 c2 34 1a 8c e8 66  78 05 78 0b 23 59 ef 25  |...4...fx.x.#Y.%|
-00000430  16 19 05 78 bf b7 ba 73  8d 2a 0a ab 1e 9d f3 64  |...x...s.*.....d|
-00000440  b7 6c 53 43 89 93 1c 36  86 21 76 09 a8 24 70 e9  |.lSC...6.!v..$p.|
-00000450  a1 3f 0d 09 6c 4b 2c 16  d4 ab 49 5a f0 d7 68 b8  |.?..lK,...IZ..h.|
-00000460  59 f1 89 4a b6 02 a0 63  b6 d4 aa fe 8f f5 9a 2e  |Y..J...c........|
-00000470  64 7f 10 23 b5 41 2b c4  8e 31 0a c9 a1 45 4e c4  |d..#.A+..1...EN.|
-00000480  4f c9 fa 6b 4c                                    |O..kL|
+00000080  03 03 00 01 01 17 03 03  00 24 7a a5 d4 28 fe 61  |.........$z..(.a|
+00000090  12 68 43 19 5a 01 88 e7  ae 24 e4 6f d3 c6 e7 13  |.hC.Z....$.o....|
+000000a0  32 aa 80 56 e2 1b 8c bb  5f ee 33 5f 86 8e 17 03  |2..V...._.3_....|
+000000b0  03 02 6d ee 98 f9 eb 4c  74 7f 2b 73 22 7e 79 e7  |..m....Lt.+s"~y.|
+000000c0  ed ed 93 f5 0b 68 0b 5a  14 79 45 83 9a b7 ea e7  |.....h.Z.yE.....|
+000000d0  9b 89 21 97 c4 dc cd 89  e7 27 44 d9 5c de a2 79  |..!......'D.\..y|
+000000e0  5c bb 9b f1 4a fc 3e 04  64 b4 70 cc 30 a3 3a bc  |\...J.>.d.p.0.:.|
+000000f0  4c d3 4d 90 b8 1c cf 3f  ad 63 12 a6 b7 df 6a a5  |L.M....?.c....j.|
+00000100  03 1f a6 96 d5 94 ea fd  fc a3 95 2b 38 cb 25 47  |...........+8.%G|
+00000110  63 d4 42 10 2c 91 d3 d9  12 79 e2 ba 3e 0b 82 09  |c.B.,....y..>...|
+00000120  c6 02 ee 55 14 17 73 3e  11 17 e9 d7 b5 9c d2 b7  |...U..s>........|
+00000130  d7 2f f0 23 51 a1 d3 71  68 9d 4c 01 98 a9 07 e0  |./.#Q..qh.L.....|
+00000140  b0 fd f8 74 0c bc eb 5e  57 1d 48 65 ac 80 d4 f4  |...t...^W.He....|
+00000150  4e 56 1d 89 ce ab 21 5e  5f a0 5c ed a3 e7 07 5d  |NV....!^_.\....]|
+00000160  c3 d9 9d 31 62 e0 91 2b  c6 e2 5c f6 69 2a 06 b8  |...1b..+..\.i*..|
+00000170  e1 24 92 39 7b 06 58 72  a1 84 87 c4 e9 53 83 12  |.$.9{.Xr.....S..|
+00000180  2a 03 24 6a 9d 84 55 30  04 15 7b 68 88 46 75 6e  |*.$j..U0..{h.Fun|
+00000190  3f 0a f7 e8 9f 64 04 32  b7 5e 8c 64 82 ec 6d 9b  |?....d.2.^.d..m.|
+000001a0  e0 41 33 69 e4 75 51 d9  e3 ba 7a 9e 7b 8f b7 3e  |.A3i.uQ...z.{..>|
+000001b0  bc 30 3a 55 10 81 ec 1f  f9 c1 77 30 3d 7e 3f b5  |.0:U......w0=~?.|
+000001c0  db 44 a5 54 d1 b3 81 64  20 5d 8d 31 48 19 5a 2f  |.D.T...d ].1H.Z/|
+000001d0  4a b9 b2 31 b8 56 f4 9c  9d ac 35 5d 54 55 0b 09  |J..1.V....5]TU..|
+000001e0  e0 10 13 47 b1 ad 3f 9b  62 39 84 4e 49 99 d0 38  |...G..?.b9.NI..8|
+000001f0  fe 7d 8b f2 a5 50 ab 62  54 85 7f 70 ae 51 13 6a  |.}...P.bT..p.Q.j|
+00000200  7a 5d eb cd c6 e2 29 47  a6 e0 a2 b1 46 da bc 7c  |z]....)G....F..||
+00000210  38 8b 45 a7 07 c1 f4 e6  fe f0 83 24 fa 87 d1 17  |8.E........$....|
+00000220  d1 6b 0d 6f 96 2a 28 35  81 5c 78 6e a8 16 f9 0a  |.k.o.*(5.\xn....|
+00000230  71 47 72 5d 21 ad b9 93  63 16 b9 58 e6 22 66 86  |qGr]!...c..X."f.|
+00000240  b5 43 c0 91 c9 cd 70 8e  f9 c0 38 c9 4d 04 fa 39  |.C....p...8.M..9|
+00000250  e1 02 46 59 85 67 38 35  ce 84 ec b9 34 50 84 03  |..FY.g85....4P..|
+00000260  82 12 75 ee 4a c5 db 61  d1 31 2e c5 62 88 cb 10  |..u.J..a.1..b...|
+00000270  c9 bc 65 7b cd df d5 0a  56 75 81 a0 a8 f0 ee 54  |..e{....Vu.....T|
+00000280  f5 b3 c8 36 13 c7 6d 95  4a 72 61 d9 98 c4 08 dc  |...6..m.Jra.....|
+00000290  7f 35 de 4c 5b aa 6f 7d  6d f2 e0 e2 46 1f 5d 72  |.5.L[.o}m...F.]r|
+000002a0  a5 c1 ee 5e af 34 44 8b  07 90 9a 2f d3 3e cf 8d  |...^.4D..../.>..|
+000002b0  69 54 19 ae 3e c2 89 55  5e 0b 98 e1 24 c5 6b 88  |iT..>..U^...$.k.|
+000002c0  2e 67 83 9e cc 97 b0 06  58 7d 5f 82 55 21 d3 79  |.g......X}_.U!.y|
+000002d0  04 d8 2e 59 08 67 78 70  ee bc 9b 26 12 50 da 5a  |...Y.gxp...&.P.Z|
+000002e0  40 66 45 b8 36 16 50 5b  93 15 a9 a8 c0 85 34 ee  |@fE.6.P[......4.|
+000002f0  d2 ee 4e 7d 66 28 f6 65  5c 88 3c b1 de e9 de 8b  |..N}f(.e\.<.....|
+00000300  e8 b2 51 d7 f0 51 69 fd  fe f1 8c 57 df 3f d5 40  |..Q..Qi....W.?.@|
+00000310  e8 54 a0 b2 59 e1 75 27  fc fd b7 41 d9 ad 49 5e  |.T..Y.u'...A..I^|
+00000320  17 03 03 00 99 2c 47 73  11 39 91 57 05 d0 f6 0f  |.....,Gs.9.W....|
+00000330  8c 6c f2 66 a0 d1 cd 3f  80 3c bb f3 27 78 83 64  |.l.f...?.<..'x.d|
+00000340  4d 33 de b8 f5 8b 27 a9  1f 8b 75 9f b2 c6 d7 08  |M3....'...u.....|
+00000350  13 8e 73 a6 81 0e 71 fd  7b 33 87 c2 23 6f bc ad  |..s...q.{3..#o..|
+00000360  9b e6 60 91 12 3f 74 de  8f 7c 49 9f 0a 74 cc e0  |..`..?t..|I..t..|
+00000370  68 e3 50 cc ca 2f a2 30  a9 32 31 ec 92 5f 4d d1  |h.P../.0.21.._M.|
+00000380  39 f1 4d f6 2d 21 3c 54  33 38 a2 46 c0 7a 55 8c  |9.M.-!<T38.F.zU.|
+00000390  7f 7e 88 00 21 9c c9 53  fe 30 01 42 7c d8 e8 5b  |.~..!..S.0.B|..[|
+000003a0  46 c3 28 73 7f ab 84 aa  83 f1 2e 51 eb 0d 90 ec  |F.(s.......Q....|
+000003b0  fa 96 3c 79 9d 8f ce 59  57 15 94 18 3f 53 17 03  |..<y...YW...?S..|
+000003c0  03 00 35 dd 46 07 33 0d  1e 78 18 5a f6 45 43 ae  |..5.F.3..x.Z.EC.|
+000003d0  61 ed 97 94 eb 67 82 cf  43 3f cb e7 23 68 fb cc  |a....g..C?..#h..|
+000003e0  a3 c1 91 74 2f cc fc 49  44 a8 7b 7b 17 44 6a d5  |...t/..ID.{{.Dj.|
+000003f0  4e 0c a7 21 ff 01 fc 2f  17 03 03 00 8b 59 58 d0  |N..!.../.....YX.|
+00000400  30 c0 e9 18 f6 de 1c fa  95 a9 1a 3a d4 f9 ed 28  |0..........:...(|
+00000410  bd 81 0c 68 82 17 a0 c5  55 5e 96 58 29 c7 50 25  |...h....U^.X).P%|
+00000420  8b 62 b3 2f 63 27 3c b4  03 83 78 e5 30 7b 03 6a  |.b./c'<...x.0{.j|
+00000430  aa 2e 0b 61 bc cf 36 84  7c 72 4e 4c 52 d7 a7 b6  |...a..6.|rNLR...|
+00000440  93 7b 52 09 a9 13 dc 96  61 2e c3 88 37 8f a7 ae  |.{R.....a...7...|
+00000450  eb 9f f3 fd 05 fb f1 71  bd 73 a3 4a 53 72 51 60  |.......q.s.JSrQ`|
+00000460  eb 06 3f 37 52 e7 d4 4b  06 f1 37 46 f9 bf 87 9c  |..?7R..K..7F....|
+00000470  d8 c7 be ad 7d 8d 12 54  93 d3 43 15 af f8 c6 8d  |....}..T..C.....|
+00000480  c5 5d b0 74 bc 4c 70 44                           |.].t.LpD|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 8a 24 85 c3 c1  |..........5.$...|
-00000010  8b c9 45 3a ab 1b dc 1a  97 ab 95 49 b2 24 2d 99  |..E:.......I.$-.|
-00000020  96 de 6d 9d ce 1d a9 15  57 30 05 6a 01 09 68 ea  |..m.....W0.j..h.|
-00000030  ca c4 b4 03 10 2f 56 2a  1d 9f 56 0b 0e f8 95 f7  |...../V*..V.....|
+00000000  14 03 03 00 01 01 17 03  03 00 35 de e1 cc 43 bc  |..........5...C.|
+00000010  ae b2 a6 66 68 d4 c4 b9  18 72 1f 26 f7 03 c9 6e  |...fh....r.&...n|
+00000020  9b 12 0e ff 65 ff f5 5f  84 6c fb 99 be e6 b3 07  |....e.._.l......|
+00000030  db ea d2 33 cc 7e 8c eb  42 db db fd e8 21 62 b0  |...3.~..B....!b.|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 85 6c 73  31 6f 05 67 a0 ac 7b 7c  |......ls1o.g..{||
-00000010  e6 d2 cf 1a 4b 14 29 68  67 59 44 7b 4b fc 24 48  |....K.)hgYD{K.$H|
-00000020  e1 6f 43 17 03 03 00 13  97 97 f3 ed 0c 1c 34 7f  |.oC...........4.|
-00000030  e6 1e 73 f4 e9 fd 60 01  87 05 1f                 |..s...`....|
+00000000  17 03 03 00 1e 1e 5c 6b  1e dd ea a2 1d bd 6e 66  |......\k......nf|
+00000010  0b 99 e0 91 0b c1 3e 9b  49 e7 40 0d a7 7a bb 31  |......>.I.@..z.1|
+00000020  4c 5c c2 17 03 03 00 13  a5 98 a7 8a 05 a7 bb 60  |L\.............`|
+00000030  11 aa b3 05 f6 cd 8b 16  3d 97 3e                 |........=.>|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ALPN-Fallback b/src/crypto/tls/testdata/Server-TLSv13-ALPN-Fallback
index e537f8d66e..d4a054d686 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ALPN-Fallback
+++ b/src/crypto/tls/testdata/Server-TLSv13-ALPN-Fallback
@@ -1,9 +1,9 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 eb 01 00 00  e7 03 03 cc e4 f9 6e 66  |..............nf|
-00000010  77 e9 b4 e6 54 d2 65 47  46 1b ad 21 35 ae c2 6b  |w...T.eGF..!5..k|
-00000020  40 96 00 97 e1 fd ce 0b  11 7a be 20 51 69 17 c8  |@........z. Qi..|
-00000030  aa fa 20 4f 3b 3f 4f ac  5c 02 4c aa 7a 84 4d 46  |.. O;?O.\.L.z.MF|
-00000040  4b 60 11 f4 66 88 bd dd  76 41 dc 31 00 04 13 03  |K`..f...vA.1....|
+00000000  16 03 01 00 eb 01 00 00  e7 03 03 ca 9d 80 22 cc  |..............".|
+00000010  77 d9 f2 87 3f a8 93 a1  13 6f a0 f5 4e d0 1b fe  |w...?....o..N...|
+00000020  cc 04 c0 7c 8d 7d 2e 5c  c2 6d 69 20 1e 1f 96 97  |...|.}.\.mi ....|
+00000030  82 97 85 5b fd c1 59 cb  a5 2a 91 c1 b5 88 06 6c  |...[..Y..*.....l|
+00000040  b0 ed 5c 41 78 cc f6 3c  28 d9 29 2b 00 04 13 03  |..\Ax..<(.)+....|
 00000050  00 ff 01 00 00 9a 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 10 00 19 00 17  06 70 72 6f 74 6f 33 08  |.........proto3.|
@@ -12,88 +12,88 @@
 000000a0  03 06 03 08 07 08 08 08  09 08 0a 08 0b 08 04 08  |................|
 000000b0  05 08 06 04 01 05 01 06  01 00 2b 00 03 02 03 04  |..........+.....|
 000000c0  00 2d 00 02 01 01 00 33  00 26 00 24 00 1d 00 20  |.-.....3.&.$... |
-000000d0  c8 f3 33 2e 23 4d b2 e1  c8 a0 23 2c 25 f5 48 73  |..3.#M....#,%.Hs|
-000000e0  f5 1d a7 af 17 60 c8 0e  4e b7 d1 49 7d 6e e1 0a  |.....`..N..I}n..|
+000000d0  c1 26 2b f3 64 5e 41 1a  11 9c 1d 4b 09 bd f4 98  |.&+.d^A....K....|
+000000e0  b4 7d 06 bb 88 97 5c ef  01 24 0b 3d 9e ed 91 0f  |.}....\..$.=....|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 51 69 17 c8  |........... Qi..|
-00000030  aa fa 20 4f 3b 3f 4f ac  5c 02 4c aa 7a 84 4d 46  |.. O;?O.\.L.z.MF|
-00000040  4b 60 11 f4 66 88 bd dd  76 41 dc 31 13 03 00 00  |K`..f...vA.1....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 1e 1f 96 97  |........... ....|
+00000030  82 97 85 5b fd c1 59 cb  a5 2a 91 c1 b5 88 06 6c  |...[..Y..*.....l|
+00000040  b0 ed 5c 41 78 cc f6 3c  28 d9 29 2b 13 03 00 00  |..\Ax..<(.)+....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 9a 04 f3 14 2b 0b  |..............+.|
-00000090  55 2f e3 7a 17 52 0d 1f  40 f4 6d f3 d6 63 26 1c  |U/.z.R..@.m..c&.|
-000000a0  67 17 03 03 02 6d 34 32  24 d0 fd 2b 36 0a 15 87  |g....m42$..+6...|
-000000b0  10 c7 ed 13 b7 a2 dd 9a  35 1e 17 6a ba c6 df 1e  |........5..j....|
-000000c0  f8 93 e2 0e 31 5c 16 e6  04 00 0b 4e 56 2d d3 39  |....1\.....NV-.9|
-000000d0  36 4a 35 4f 9e fa 20 3b  83 a6 e4 fe 83 d3 7a 9b  |6J5O.. ;......z.|
-000000e0  7c a9 5a 47 4b 6b ec 6b  0f 63 11 56 49 a9 c4 1f  ||.ZGKk.k.c.VI...|
-000000f0  0b 70 ba 2e 3d 16 ff 4f  bb f2 ba 5c 6b b2 00 82  |.p..=..O...\k...|
-00000100  35 54 01 ba b5 12 e1 cc  cc 4a 4e de e8 8a fd ee  |5T.......JN.....|
-00000110  ac 89 b9 9d 82 e2 fe 6b  19 e5 05 15 54 6c 99 93  |.......k....Tl..|
-00000120  9f a8 47 41 9b 16 46 e2  0e 16 88 a0 51 8e ec 88  |..GA..F.....Q...|
-00000130  45 8d 42 53 e3 5f 6f 5d  f5 c3 e5 20 65 37 75 5a  |E.BS._o]... e7uZ|
-00000140  49 da 3e d9 a6 5c 79 13  1a e7 b2 83 89 6e 1b c3  |I.>..\y......n..|
-00000150  9d 50 dc 19 06 8a bb dc  a6 bd 05 41 1f 1f fe 95  |.P.........A....|
-00000160  8d b7 7b be 8b f1 0c 90  23 31 ed d7 9c 77 35 a8  |..{.....#1...w5.|
-00000170  b7 5f 3c be 23 86 69 92  a1 02 9c 44 bc eb 28 5a  |._<.#.i....D..(Z|
-00000180  99 55 c9 04 be 68 eb 8e  b8 2d 56 40 91 c0 87 e1  |.U...h...-V@....|
-00000190  0a ab 6a 99 22 42 f5 f9  a1 c8 fc 47 28 23 1e d7  |..j."B.....G(#..|
-000001a0  46 ad e8 63 a7 84 b8 f7  8a a6 24 e2 65 0c 40 db  |F..c......$.e.@.|
-000001b0  17 d3 f2 7f 97 09 2f af  50 77 0e ae c3 d5 c7 04  |....../.Pw......|
-000001c0  f1 fc b4 e0 13 75 c0 27  13 40 91 17 1e 76 3b 36  |.....u.'.@...v;6|
-000001d0  3c 58 a6 5c 9a b6 7d e8  9f ec 42 73 95 7b 52 9d  |<X.\..}...Bs.{R.|
-000001e0  6c 0d 79 f3 87 29 09 7c  27 e5 7b b0 5b aa a8 dc  |l.y..).|'.{.[...|
-000001f0  04 f7 32 52 bc 15 52 98  ad 2d b6 52 89 0d 76 92  |..2R..R..-.R..v.|
-00000200  16 0a 38 f3 02 0d 33 ac  e8 0d 9a 9a fe 97 26 01  |..8...3.......&.|
-00000210  f0 18 26 c9 31 e1 10 2c  7e c8 af 37 b2 fe 12 17  |..&.1..,~..7....|
-00000220  89 85 2e 75 38 a0 99 c3  2c b4 e0 5a 86 88 1d 63  |...u8...,..Z...c|
-00000230  4d 4f f6 b0 af bb 6d e8  d7 6f 97 74 0a e9 69 82  |MO....m..o.t..i.|
-00000240  c8 28 c8 1b ea 9c 19 ff  4d bc 4b 17 72 16 74 2d  |.(......M.K.r.t-|
-00000250  73 72 e8 a3 9d 76 db 23  79 06 dc a6 53 11 f4 0e  |sr...v.#y...S...|
-00000260  26 83 76 cf f5 61 cd d6  b5 9e c5 c7 c4 45 3b 3c  |&.v..a.......E;<|
-00000270  76 01 76 f5 0d 01 6e 6a  59 5d 85 c6 af 71 e2 cd  |v.v...njY]...q..|
-00000280  62 27 d7 97 a0 ae 51 3b  7e f7 b8 7f db 6f 0e 76  |b'....Q;~....o.v|
-00000290  f6 21 ae 35 fc f0 dd f4  9b 30 73 34 46 b1 f5 a6  |.!.5.....0s4F...|
-000002a0  42 95 cd f6 f5 a0 0a f7  46 8d d2 77 91 18 1a 2d  |B.......F..w...-|
-000002b0  fa 6d f4 fe bc 1e dd 2f  2f 1f 10 14 46 54 d1 ef  |.m.....//...FT..|
-000002c0  02 a4 3b 2e 63 e0 c4 ae  46 bd 66 55 06 1b b4 86  |..;.c...F.fU....|
-000002d0  92 0c fd e5 a2 2d 67 01  62 d9 a7 43 1b ec f4 b3  |.....-g.b..C....|
-000002e0  4c 15 94 25 6d 71 92 48  dd 93 1a bf 88 2e 16 32  |L..%mq.H.......2|
-000002f0  d3 e2 14 50 6a 95 c6 30  2c 4a ee 4f 48 6a c5 f1  |...Pj..0,J.OHj..|
-00000300  66 d3 07 05 f4 45 e0 f7  9d 56 a1 ff b6 f9 bd d5  |f....E...V......|
-00000310  b1 52 b2 17 03 03 00 99  10 0c 1c 36 9a 10 7b 82  |.R.........6..{.|
-00000320  cd 1f 2c 29 d8 53 8f 8a  5b 24 98 33 f6 d3 15 a4  |..,).S..[$.3....|
-00000330  6d a0 f2 39 be 24 8e f4  69 4c 34 8e 24 9a 38 ca  |m..9.$..iL4.$.8.|
-00000340  c5 77 63 94 2b ed 7e 82  16 07 e7 15 41 1e 1f 61  |.wc.+.~.....A..a|
-00000350  53 8f 30 a5 82 b8 10 4b  2e 48 39 0f 2e 90 c9 fe  |S.0....K.H9.....|
-00000360  31 e9 8c 38 41 d9 53 a2  29 05 ac ee cf 9e 2f ba  |1..8A.S.)...../.|
-00000370  aa 27 75 23 07 89 19 8b  84 4c 6b cc c6 be 26 40  |.'u#.....Lk...&@|
-00000380  ba b3 9c 08 bc db 2a 01  53 e3 c3 0f 4e db 83 cd  |......*.S...N...|
-00000390  e7 5a e1 22 2b fb 2d 6b  18 61 7c c2 67 e9 dc b7  |.Z."+.-k.a|.g...|
-000003a0  17 4a a3 82 4b 82 2e 37  f5 b9 19 f8 a2 ee 76 e7  |.J..K..7......v.|
-000003b0  f0 17 03 03 00 35 b5 34  8f c0 f3 ac 30 13 e1 fa  |.....5.4....0...|
-000003c0  4a 57 97 95 3d d1 58 41  d6 d3 b3 b9 4d 80 54 fc  |JW..=.XA....M.T.|
-000003d0  c2 41 78 9e 54 95 ba d5  2b 31 5a 81 d4 1b 45 7f  |.Ax.T...+1Z...E.|
-000003e0  bb 98 95 55 7f 26 b3 56  35 9c f9 17 03 03 00 88  |...U.&.V5.......|
-000003f0  65 7c 27 68 b0 ef 58 29  a9 dd 4b 78 b0 d4 63 94  |e|'h..X)..Kx..c.|
-00000400  6b a9 f2 5b e8 05 c3 f1  32 ba b0 02 6c 92 67 c4  |k..[....2...l.g.|
-00000410  77 14 23 11 95 d9 08 6d  f8 08 21 fa e7 3c 0f 67  |w.#....m..!..<.g|
-00000420  93 cf 88 4a d2 66 8d 95  f2 b6 c4 e0 61 26 23 08  |...J.f......a&#.|
-00000430  4a 31 4f 76 c2 30 04 4e  2c 72 96 64 25 db 53 47  |J1Ov.0.N,r.d%.SG|
-00000440  77 91 e8 29 52 2e 78 c2  f3 d1 95 3c c6 0e a4 45  |w..)R.x....<...E|
-00000450  da cc e4 eb a4 b9 e3 86  36 c9 23 23 f1 32 3e 6f  |........6.##.2>o|
-00000460  ea 56 ba b4 74 39 54 83  e7 ff 4c 95 44 a7 f1 da  |.V..t9T...L.D...|
-00000470  50 01 14 d1 1f e3 19 e0                           |P.......|
+00000080  03 03 00 01 01 17 03 03  00 17 ca 84 74 0d 35 9d  |............t.5.|
+00000090  80 3d d8 95 cb f2 12 f1  10 6b f6 91 12 ab 37 ea  |.=.......k....7.|
+000000a0  a2 17 03 03 02 6d 1e 6b  ca 76 70 67 ce 22 70 8c  |.....m.k.vpg."p.|
+000000b0  ab 4d 33 a8 2e 93 77 2c  2f b1 7a e3 42 ca 83 e2  |.M3...w,/.z.B...|
+000000c0  e5 c9 45 dc 97 d3 85 64  e8 07 13 c8 55 7c cd bf  |..E....d....U|..|
+000000d0  20 d1 3b 43 a7 13 a1 f6  66 0e 98 e7 23 18 cf 38  | .;C....f...#..8|
+000000e0  d3 92 d7 29 30 44 fa dc  81 1d e3 04 ca b0 b3 08  |...)0D..........|
+000000f0  d4 a4 64 18 f4 4f 06 ca  ca a0 bb 90 38 6d 09 21  |..d..O......8m.!|
+00000100  42 c1 a0 c4 51 90 78 61  b1 55 eb 63 8d 65 73 47  |B...Q.xa.U.c.esG|
+00000110  7c 6d f5 7f c6 dc 55 a1  a3 a4 16 6b 2d 62 d2 8d  ||m....U....k-b..|
+00000120  1f 96 8f 84 96 a6 94 f0  a0 9e 03 04 67 a2 e9 e3  |............g...|
+00000130  38 0c cd f3 af 45 77 65  33 06 e7 aa cf a0 e6 01  |8....Ewe3.......|
+00000140  a7 5f 62 95 32 18 b9 58  03 db 9c ca c7 50 80 cf  |._b.2..X.....P..|
+00000150  15 1c b0 7e 97 30 bb e2  bf d5 67 f4 e1 87 1e 07  |...~.0....g.....|
+00000160  71 2f f5 31 7e 7e 05 8a  cb a1 98 83 de de aa 87  |q/.1~~..........|
+00000170  b9 d2 4a 5e 4c 27 04 15  6b 3a 21 02 28 2c 3a 76  |..J^L'..k:!.(,:v|
+00000180  64 1f b0 f3 45 1e 2a fc  97 3f 0e 18 c8 00 a2 0b  |d...E.*..?......|
+00000190  51 4a 8f 1d d7 a6 d7 b9  64 11 bc ed 74 c9 90 bd  |QJ......d...t...|
+000001a0  a3 27 b3 c0 95 ea 49 88  af de 76 d9 82 67 01 0f  |.'....I...v..g..|
+000001b0  60 f1 f7 84 7e 56 46 65  c7 42 cc fb 99 25 a3 77  |`...~VFe.B...%.w|
+000001c0  c5 8c 02 87 4e d4 78 17  0d 16 f1 00 de f9 d5 0b  |....N.x.........|
+000001d0  36 28 f5 27 59 4b fd ba  38 cb 3c 53 3d 02 3b 77  |6(.'YK..8.<S=.;w|
+000001e0  b6 f1 e8 0d 87 58 f9 5b  ac 87 53 ba e7 1c 0c 1b  |.....X.[..S.....|
+000001f0  be e1 43 a6 8f 0d ab a7  3e e6 ed cb 66 c1 06 49  |..C.....>...f..I|
+00000200  9a cd 52 91 5e bc 1f a5  c6 78 2c d0 a4 67 14 3f  |..R.^....x,..g.?|
+00000210  94 2a 9c 9f 47 ee fa c7  50 ca 00 c2 30 69 d9 ca  |.*..G...P...0i..|
+00000220  30 b7 ac f4 3b d9 91 d7  33 40 87 de d9 a2 7f 77  |0...;...3@.....w|
+00000230  5b b0 57 ca 10 03 ec 3b  95 e9 c2 de 50 f1 28 7a  |[.W....;....P.(z|
+00000240  49 c1 be ef 6d 99 ea 98  47 8b af 51 d0 fb 0a d0  |I...m...G..Q....|
+00000250  b5 b2 ad e3 69 ba fc 34  c7 aa 04 8b d5 fc 17 54  |....i..4.......T|
+00000260  e1 51 f0 26 32 21 71 90  0e 30 10 f6 68 6f 53 b7  |.Q.&2!q..0..hoS.|
+00000270  b6 d8 1c 13 0a c9 fb 9e  46 13 22 4c 7c 93 18 ed  |........F."L|...|
+00000280  b8 72 69 56 00 ab df ec  f5 4c 32 60 0e a4 a3 b0  |.riV.....L2`....|
+00000290  b3 12 5c 61 26 1c aa b2  c2 68 64 65 cc 01 57 c9  |..\a&....hde..W.|
+000002a0  70 18 f7 db 2c 0d 24 b3  68 3a 08 db 07 ff 3c f5  |p...,.$.h:....<.|
+000002b0  2e 9a 1e d1 9c 62 4d 6d  4b 48 37 dd 62 0b 2b ab  |.....bMmKH7.b.+.|
+000002c0  49 a1 0f 7e 1b 6f 4e 43  69 63 3d 8e ce 51 f9 32  |I..~.oNCic=..Q.2|
+000002d0  4e f4 21 97 f5 16 e4 2b  0b f3 6f 5d 15 7e 68 dd  |N.!....+..o].~h.|
+000002e0  c6 5b 5f ac 56 42 99 76  28 38 d2 8b ed 0e c6 a4  |.[_.VB.v(8......|
+000002f0  69 d3 f1 c4 a9 d6 7a d2  00 ac ad ff 9c d2 8d 1e  |i.....z.........|
+00000300  46 88 64 24 51 78 2a a8  4a ea a4 fa 28 3b 70 3a  |F.d$Qx*.J...(;p:|
+00000310  75 8b 9d 17 03 03 00 99  22 d3 e9 8f ae 4e 5e 17  |u......."....N^.|
+00000320  3e 86 54 cd fd 66 68 c6  fe 73 ac 19 98 c1 a1 66  |>.T..fh..s.....f|
+00000330  4f 7a 4f 5e 0b c5 a1 43  74 d4 c2 0a ce 45 05 2f  |OzO^...Ct....E./|
+00000340  5f f1 1b 50 eb 08 8f 36  30 f0 78 e9 1d c1 e5 b0  |_..P...60.x.....|
+00000350  cf 27 14 ed 67 ed 12 7e  f1 4c 10 e8 ff 6f 13 7d  |.'..g..~.L...o.}|
+00000360  0f a8 c3 b6 19 22 9a 68  9b ab 6d 77 09 f5 56 de  |.....".h..mw..V.|
+00000370  84 23 d6 ed 38 62 06 4b  05 9b 59 39 2f 09 65 70  |.#..8b.K..Y9/.ep|
+00000380  9e 9c f9 fe a2 e4 db 1e  c0 12 d2 ee 41 77 b3 05  |............Aw..|
+00000390  a1 c3 bb 41 70 0e dd f7  0d ca 41 58 12 9e 4f 23  |...Ap.....AX..O#|
+000003a0  2e 72 00 9b 19 70 78 54  b4 27 69 16 15 e8 6f d4  |.r...pxT.'i...o.|
+000003b0  e7 17 03 03 00 35 ad df  36 e1 d4 a4 04 8e fa 1a  |.....5..6.......|
+000003c0  77 da e7 99 62 e9 8f a0  27 af a6 ba 7f 47 49 47  |w...b...'....GIG|
+000003d0  aa a3 bd bb cd 32 f6 e6  90 77 95 34 e5 72 f0 f9  |.....2...w.4.r..|
+000003e0  75 8c cf 25 5b bc 2a b0  98 be fb 17 03 03 00 8b  |u..%[.*.........|
+000003f0  e9 20 f8 90 78 d5 78 11  c3 bb 5c 41 f0 cd 51 3e  |. ..x.x...\A..Q>|
+00000400  a1 20 bb 72 98 e3 d1 fe  9d 61 ae a4 8f 71 57 6c  |. .r.....a...qWl|
+00000410  e7 68 de 63 95 ed 46 00  f4 8f cd 59 c7 97 7f 98  |.h.c..F....Y....|
+00000420  61 f3 68 18 18 1e 94 16  f7 f2 de 73 81 3d a5 7e  |a.h........s.=.~|
+00000430  12 68 65 70 6f ca bd 2b  92 f8 7c ec 88 2c 3f c0  |.hepo..+..|..,?.|
+00000440  76 52 cc e3 38 e0 ce 0b  dc 35 ef 87 cf ea 4b 2b  |vR..8....5....K+|
+00000450  53 88 52 3f f6 e1 d7 ea  5f a2 d9 4f a7 03 ac c1  |S.R?...._..O....|
+00000460  7d ab 95 ce a5 f5 00 53  f6 6d ab 7e 07 88 51 9b  |}......S.m.~..Q.|
+00000470  2c e9 e9 ac 1b f9 17 ac  33 17 00                 |,.......3..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 9e ee 82 32 b6  |..........5...2.|
-00000010  33 aa 6e fd 8a ee 80 95  2e 9a d8 3b 58 7b e3 e2  |3.n........;X{..|
-00000020  c4 75 56 bc cf 9d 82 f7  e9 cf cf 54 ba 56 04 72  |.uV........T.V.r|
-00000030  ae 2f 1e fb 87 cc 0f 8c  0f 0d 0c 35 72 bd e6 15  |./.........5r...|
+00000000  14 03 03 00 01 01 17 03  03 00 35 52 13 5e 7a c8  |..........5R.^z.|
+00000010  3e b6 e1 8e 59 c9 cf 54  0b c8 c2 17 ab 76 0d 3d  |>...Y..T.....v.=|
+00000020  ec 5c 76 2c 21 21 f3 1e  a7 25 ba 67 97 8a 8f de  |.\v,!!...%.g....|
+00000030  03 7d 1a bc 0a 9e c7 e7  02 52 cf d4 80 3e 80 7e  |.}.......R...>.~|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e ba 1d 68  50 30 17 ee 78 e6 d5 c7  |.......hP0..x...|
-00000010  db 67 3a ec fc c4 b2 df  7a cb 59 cd 62 97 3d f3  |.g:.....z.Y.b.=.|
-00000020  5b 8b bd 17 03 03 00 13  03 f2 6a 4d 77 af e4 21  |[.........jMw..!|
-00000030  38 b1 cc 45 b7 d3 3d 09  8d 31 fe                 |8..E..=..1.|
+00000000  17 03 03 00 1e 77 f7 66  ab db 08 5c e5 9d 7f a3  |.....w.f...\....|
+00000010  f7 37 24 70 e7 7c d2 44  25 de 3d c3 71 18 aa 24  |.7$p.|.D%.=.q..$|
+00000020  9b 9d 18 17 03 03 00 13  e3 6e e2 8a d9 ae 0f c3  |.........n......|
+00000030  ad 90 03 90 40 be 42 fe  4e ad d2                 |....@.B.N..|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ALPN-NotConfigured b/src/crypto/tls/testdata/Server-TLSv13-ALPN-NotConfigured
index b2c3338d41..c4bd0356af 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ALPN-NotConfigured
+++ b/src/crypto/tls/testdata/Server-TLSv13-ALPN-NotConfigured
@@ -1,9 +1,9 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 e2 01 00 00  de 03 03 25 82 20 ff f8  |...........%. ..|
-00000010  c3 3a 6e f3 77 4a aa a8  ab ed a6 00 09 0a 9a 19  |.:n.wJ..........|
-00000020  48 63 7b 76 8a 70 60 03  bc 8e 9b 20 35 68 d4 0a  |Hc{v.p`.... 5h..|
-00000030  c3 70 f1 7c 6f 6b 33 ef  3a 73 7a a5 a3 83 a4 74  |.p.|ok3.:sz....t|
-00000040  4c 15 c7 88 c9 eb 14 75  de 03 c2 16 00 04 13 03  |L......u........|
+00000000  16 03 01 00 e2 01 00 00  de 03 03 1f f5 b0 88 a0  |................|
+00000010  fd 0e cd 4d 25 21 88 bf  07 16 95 49 6a 78 2d 70  |...M%!.....Ijx-p|
+00000020  25 f7 06 36 f2 98 4c 23  16 41 a5 20 87 60 d3 78  |%..6..L#.A. .`.x|
+00000030  c7 ab 8b f9 2b 2c 21 1e  f4 5b 25 bc 81 53 18 5c  |....+,!..[%..S.\|
+00000040  3b 7e dd 3e 7b c4 ee d1  f8 9d bf 7a 00 04 13 03  |;~.>{......z....|
 00000050  00 ff 01 00 00 91 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 10 00 10 00 0e  06 70 72 6f 74 6f 32 06  |.........proto2.|
@@ -11,89 +11,89 @@
 00000090  00 1e 00 1c 04 03 05 03  06 03 08 07 08 08 08 09  |................|
 000000a0  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
 000000b0  00 2b 00 03 02 03 04 00  2d 00 02 01 01 00 33 00  |.+......-.....3.|
-000000c0  26 00 24 00 1d 00 20 a2  59 33 22 44 fa 24 92 3b  |&.$... .Y3"D.$.;|
-000000d0  29 9e 66 e8 e4 0e e3 df  46 47 88 0a ef 8b e2 25  |).f.....FG.....%|
-000000e0  57 59 17 7a 95 32 6c                              |WY.z.2l|
+000000c0  26 00 24 00 1d 00 20 5f  8f fa 0f 94 46 78 3d a9  |&.$... _....Fx=.|
+000000d0  7d d8 2b 65 f6 c1 55 6b  fd aa 4b 65 23 7b ad 13  |}.+e..Uk..Ke#{..|
+000000e0  88 06 ce 54 f1 77 63                              |...T.wc|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 35 68 d4 0a  |........... 5h..|
-00000030  c3 70 f1 7c 6f 6b 33 ef  3a 73 7a a5 a3 83 a4 74  |.p.|ok3.:sz....t|
-00000040  4c 15 c7 88 c9 eb 14 75  de 03 c2 16 13 03 00 00  |L......u........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 87 60 d3 78  |........... .`.x|
+00000030  c7 ab 8b f9 2b 2c 21 1e  f4 5b 25 bc 81 53 18 5c  |....+,!..[%..S.\|
+00000040  3b 7e dd 3e 7b c4 ee d1  f8 9d bf 7a 13 03 00 00  |;~.>{......z....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 da bf 18 fa 13 6c  |...............l|
-00000090  8f 4b a6 cf 15 d1 07 47  06 01 84 db 5b b2 26 8e  |.K.....G....[.&.|
-000000a0  73 17 03 03 02 6d 4f 75  d0 fe 56 7b c2 70 6b 89  |s....mOu..V{.pk.|
-000000b0  da a0 13 2d 52 d1 43 06  10 20 b1 5d 2b da 84 c3  |...-R.C.. .]+...|
-000000c0  81 38 e9 98 2f 60 95 83  a9 b1 00 ec 64 85 85 e2  |.8../`......d...|
-000000d0  8e d8 9c 6d 34 c8 db 9e  c7 75 76 be bc e6 83 ec  |...m4....uv.....|
-000000e0  26 15 24 a3 74 5b 1b 91  e5 83 74 2f 7f 63 86 1d  |&.$.t[....t/.c..|
-000000f0  7d ed a0 2f f8 26 37 c6  0f b6 50 25 de d7 33 76  |}../.&7...P%..3v|
-00000100  3b 7c 0f 5d 51 9f b7 8a  bc db 76 cc 01 4d 17 85  |;|.]Q.....v..M..|
-00000110  de 02 35 73 55 81 e7 8c  c5 0f 83 0e 06 44 aa 48  |..5sU........D.H|
-00000120  4d b7 39 d5 34 b2 b4 86  71 2e 23 ec 6c 76 28 3b  |M.9.4...q.#.lv(;|
-00000130  cd 4d 10 ba 51 d6 ee 0e  3e 82 ca c9 84 7c d2 8b  |.M..Q...>....|..|
-00000140  de 0f a3 84 e9 23 bd 6a  61 82 27 e6 55 3f c0 e5  |.....#.ja.'.U?..|
-00000150  d3 bc 41 43 52 c1 d4 62  4f 79 0a b4 8c 55 bc 1e  |..ACR..bOy...U..|
-00000160  65 05 fa de 01 f9 b8 38  c5 f7 e7 8b f6 72 58 43  |e......8.....rXC|
-00000170  af 67 c3 18 a7 3f 37 1a  02 83 81 bb d7 ed 0e 8d  |.g...?7.........|
-00000180  0d 51 50 f3 33 aa e6 f2  87 df e9 bf 11 9b 60 74  |.QP.3.........`t|
-00000190  19 34 7a 74 81 7c 5c 46  1e 58 ea bb 89 ac 8f c4  |.4zt.|\F.X......|
-000001a0  72 90 2f 0c e5 a1 32 35  f5 17 f4 28 f9 da e5 fb  |r./...25...(....|
-000001b0  02 21 db f8 ba 83 95 2c  76 e3 d7 74 d7 8f 03 92  |.!.....,v..t....|
-000001c0  ed 8a 36 68 a5 5a 04 44  31 15 6a 54 21 85 c3 4c  |..6h.Z.D1.jT!..L|
-000001d0  c4 f7 af fc 03 93 c3 18  fd 20 31 a3 ca 83 17 6a  |......... 1....j|
-000001e0  bf 9b 03 fa 99 b6 8a 6e  eb ba d8 8e 28 c7 ef 60  |.......n....(..`|
-000001f0  00 4f d6 18 73 23 f8 e9  7d 9a f1 8f 53 e9 9a c4  |.O..s#..}...S...|
-00000200  0d 7f cf f0 ae 14 a0 35  91 38 3e a4 8a 21 67 d9  |.......5.8>..!g.|
-00000210  99 17 c7 4a da 52 7d 1e  d1 32 61 98 c3 af 18 27  |...J.R}..2a....'|
-00000220  6d 65 6c 76 5d 63 10 83  69 ae 55 63 c8 09 78 ba  |melv]c..i.Uc..x.|
-00000230  d9 98 52 54 d4 69 30 98  ad 87 3f 56 ac 54 9a 50  |..RT.i0...?V.T.P|
-00000240  00 51 06 6f 48 25 f2 38  00 aa 26 46 ab 3f df 24  |.Q.oH%.8..&F.?.$|
-00000250  e4 89 23 54 8f df 2a 80  66 bf 1f 94 2e 38 c2 a2  |..#T..*.f....8..|
-00000260  f5 cf 2a 81 bf f2 46 52  5b 62 aa 8c d1 98 45 ee  |..*...FR[b....E.|
-00000270  e6 37 6b 54 8e d2 2e a0  0c bf c8 ac 6a d7 ed 47  |.7kT........j..G|
-00000280  64 49 46 f3 c7 ea 61 ea  61 c5 e1 17 2b 9e 75 81  |dIF...a.a...+.u.|
-00000290  93 88 1d 02 d9 2c 46 74  09 f6 45 b5 f0 44 87 0a  |.....,Ft..E..D..|
-000002a0  4d 4a e4 2c b1 2c 0b 81  9e f9 2f 17 f5 15 0a da  |MJ.,.,..../.....|
-000002b0  37 d3 d7 04 8e 16 c9 68  84 ac 8d 9e d1 a9 05 33  |7......h.......3|
-000002c0  92 9a 2e ad 3b 84 8a 58  53 6d af e1 64 f0 ae 8b  |....;..XSm..d...|
-000002d0  80 db 8f 8b ed 62 ec 56  d9 dd 9a 9c 5a 89 82 5e  |.....b.V....Z..^|
-000002e0  91 fa 5a c5 8b 85 12 66  91 95 10 b5 d9 c3 c5 34  |..Z....f.......4|
-000002f0  33 5e eb e0 bb 71 9b a0  29 16 02 9b b1 97 3b b8  |3^...q..).....;.|
-00000300  2a 4c 85 03 01 cf e2 bb  11 9d 81 12 fc 4f 0b 66  |*L...........O.f|
-00000310  0e 94 48 17 03 03 00 99  48 2d b4 0a 11 ee a8 39  |..H.....H-.....9|
-00000320  ec 1f 26 c3 68 57 f8 f1  f0 79 e2 3e 1e 3b 23 70  |..&.hW...y.>.;#p|
-00000330  7f ea 9d 8d 6e 94 b7 fb  66 ac 6a e9 20 b0 3c 9f  |....n...f.j. .<.|
-00000340  fd a7 01 df 24 f6 0d ed  33 11 79 bd 1c c1 d9 2c  |....$...3.y....,|
-00000350  9b 35 d2 ef 50 3a 0b e3  ce f0 0a de ab 9e a3 45  |.5..P:.........E|
-00000360  5c 1a 4b 90 0d 7d 79 47  38 e6 f9 ef d0 be f3 75  |\.K..}yG8......u|
-00000370  b7 b2 49 83 34 e7 96 06  a9 dc 99 19 eb 26 70 59  |..I.4........&pY|
-00000380  ae 37 e5 c6 b9 6e d1 e8  82 60 2a 35 54 38 7f b7  |.7...n...`*5T8..|
-00000390  fa 48 e5 1f 49 50 b6 22  65 37 22 99 c1 24 66 84  |.H..IP."e7"..$f.|
-000003a0  f7 1d 58 7a 46 fa a0 e7  1f 98 91 80 d0 c7 a1 43  |..XzF..........C|
-000003b0  54 17 03 03 00 35 18 80  7d e1 3b bb d4 bb 46 81  |T....5..}.;...F.|
-000003c0  07 a0 49 84 41 ca 31 03  94 3d b7 94 d6 54 dc 19  |..I.A.1..=...T..|
-000003d0  0d 9c 9e 26 96 3c a7 76  d6 5e aa 34 57 f8 6e ab  |...&.<.v.^.4W.n.|
-000003e0  a9 11 0e 02 d3 9d 42 08  2d 0e 81 17 03 03 00 88  |......B.-.......|
-000003f0  f6 80 4e df 79 1b 83 a7  07 fa 39 7f 91 b7 c2 a9  |..N.y.....9.....|
-00000400  7a 92 fd 59 68 57 05 d4  03 fa 5a f1 38 7b 4a 84  |z..YhW....Z.8{J.|
-00000410  97 38 91 97 e6 c9 d9 68  34 b8 af 9c a1 fd 0b 0f  |.8.....h4.......|
-00000420  c9 15 b2 5e d1 f7 c4 d1  36 00 b9 68 7d 79 9e b8  |...^....6..h}y..|
-00000430  2b 16 a2 4f 89 50 80 dd  f1 b7 4a 08 22 b9 9b 18  |+..O.P....J."...|
-00000440  c6 83 cc f9 e4 4b b5 6a  91 b6 42 bb 19 84 d5 7f  |.....K.j..B.....|
-00000450  f6 16 5a 19 2f c3 f6 05  63 3a 9f 6d d7 4c 7d ea  |..Z./...c:.m.L}.|
-00000460  dc d7 78 11 ff 60 fe 5b  ba fa f0 e6 31 36 ee b1  |..x..`.[....16..|
-00000470  2a ec 8c a6 02 96 4f 8f                           |*.....O.|
+00000080  03 03 00 01 01 17 03 03  00 17 30 cc 27 0f 8c cd  |..........0.'...|
+00000090  77 85 98 61 e4 19 19 63  ac 5b 55 37 c2 73 6d f6  |w..a...c.[U7.sm.|
+000000a0  a1 17 03 03 02 6d 5f 60  9f d3 fc 5e 57 fb b6 35  |.....m_`...^W..5|
+000000b0  99 3c a7 65 6f eb b5 89  5a 3c be e1 a5 c7 af 14  |.<.eo...Z<......|
+000000c0  67 d4 0c 87 d4 dd c9 28  1c 5c 89 c6 55 68 e0 b3  |g......(.\..Uh..|
+000000d0  42 d8 e4 4f 64 df 26 4a  a2 14 eb 34 69 9f 8d 8e  |B..Od.&J...4i...|
+000000e0  fc 21 db 17 93 37 7d d4  57 bb 76 4d 1e 70 9f 58  |.!...7}.W.vM.p.X|
+000000f0  f3 ae 12 71 aa 4b 30 e3  86 92 32 c6 55 12 08 42  |...q.K0...2.U..B|
+00000100  bf 6a 6a f9 79 b9 50 37  11 15 a4 b3 c8 a8 16 da  |.jj.y.P7........|
+00000110  e9 62 ed 3d 80 da 38 22  c6 c3 fd 1c b2 d2 8c 74  |.b.=..8".......t|
+00000120  23 39 70 67 b0 34 25 24  eb 72 e2 c1 63 d6 48 09  |#9pg.4%$.r..c.H.|
+00000130  ee d7 5e 15 2b 78 64 97  c8 d0 6b 2a 1c b6 d8 12  |..^.+xd...k*....|
+00000140  9e 9a b5 dc 24 51 5a 38  a1 4c 9c df 74 3f 63 f0  |....$QZ8.L..t?c.|
+00000150  d2 45 49 58 5c 3c 42 f2  56 fd bc 0e c1 d6 8b 7d  |.EIX\<B.V......}|
+00000160  31 bf af c7 a2 91 8a c7  e2 ef 3d fe 66 5b 29 97  |1.........=.f[).|
+00000170  40 7e 84 2e 83 2b 41 48  69 72 02 75 49 74 77 18  |@~...+AHir.uItw.|
+00000180  af a9 ef 22 66 f2 2f 37  79 e7 10 6d 22 e9 81 86  |..."f./7y..m"...|
+00000190  c1 55 28 7d a1 1f 80 dc  c8 f1 00 d7 21 c9 ff 69  |.U(}........!..i|
+000001a0  8c f0 b3 48 c4 8b 97 6a  bf fc 24 ad d2 23 f5 6b  |...H...j..$..#.k|
+000001b0  4d c8 96 d6 85 91 7b c6  21 79 2f e5 59 32 7d e7  |M.....{.!y/.Y2}.|
+000001c0  7b 77 46 c7 f8 6d 6e 8c  4f c8 47 84 0c f4 9d 81  |{wF..mn.O.G.....|
+000001d0  be 2e 38 c6 79 43 d1 ca  78 81 40 1a a3 0e bc fd  |..8.yC..x.@.....|
+000001e0  42 2d de 55 33 48 50 6a  5b 47 b6 cb ea 6c e6 e9  |B-.U3HPj[G...l..|
+000001f0  ab 11 10 34 c3 4e 61 e1  dd a8 8d 8b c3 af 18 13  |...4.Na.........|
+00000200  2c 17 02 c9 7d 21 74 12  e1 9b a7 1e 95 8f 3a 6f  |,...}!t.......:o|
+00000210  60 75 f6 e9 f8 87 e5 15  de 33 ba 01 50 28 5c 2d  |`u.......3..P(\-|
+00000220  cf 74 64 c5 c8 36 48 2a  f6 32 12 96 07 2f 2d 20  |.td..6H*.2.../- |
+00000230  97 cb c1 c9 8f d1 27 f0  90 66 70 1c 45 20 c9 99  |......'..fp.E ..|
+00000240  5c 9c 44 2d a2 93 5c 4c  48 7a 6b 0c 2e a7 b9 21  |\.D-..\LHzk....!|
+00000250  1b 86 94 41 2c 53 72 0b  91 55 2b 6a b2 8f 67 f9  |...A,Sr..U+j..g.|
+00000260  2a 17 84 6f b0 f6 5e 0d  57 ad ca 1d 85 77 a7 03  |*..o..^.W....w..|
+00000270  c4 ea 62 b3 63 34 59 81  a4 90 b7 f7 39 61 8e e2  |..b.c4Y.....9a..|
+00000280  79 9c bd 71 49 7a 0c 34  2b a7 4a f4 65 f0 14 96  |y..qIz.4+.J.e...|
+00000290  4a fa 5f d6 03 eb 9e 40  04 4b 45 1c 58 a6 f7 04  |J._....@.KE.X...|
+000002a0  25 27 d3 7d 7b 28 0c 43  8b cd dd 8b 5b 19 6c 21  |%'.}{(.C....[.l!|
+000002b0  c1 03 9d 75 2e 7d 83 c8  f1 ad dc fd 96 75 6f 56  |...u.}.......uoV|
+000002c0  3d 9f e9 e3 52 ff d4 b0  55 c1 43 d9 74 b1 c7 f8  |=...R...U.C.t...|
+000002d0  99 91 e5 b7 b1 28 64 64  d8 7a de 35 64 7d 75 d6  |.....(dd.z.5d}u.|
+000002e0  7f 4b 56 63 9b fb c3 6f  f1 00 e6 f2 0a 7f 06 47  |.KVc...o.......G|
+000002f0  3c b9 dc 5f 2d b2 ef ca  2b 51 de a1 db 09 5d ec  |<.._-...+Q....].|
+00000300  80 c3 85 36 09 b4 61 6a  21 c2 68 bb 31 6b f6 14  |...6..aj!.h.1k..|
+00000310  5c 18 73 17 03 03 00 99  0b 3b ee 6c 6e c6 5f fd  |\.s......;.ln._.|
+00000320  33 e5 38 52 86 25 8f 76  93 db 62 77 2f 28 7a 19  |3.8R.%.v..bw/(z.|
+00000330  d1 78 ed 1a a4 e3 aa 13  b7 c4 24 d1 f9 f6 77 85  |.x........$...w.|
+00000340  a6 bd cf 21 3a 95 4d 70  3d 3e 40 3b 23 17 da b4  |...!:.Mp=>@;#...|
+00000350  b0 1d b7 bb 4f 90 8c 73  5a d2 f5 5b 4a 74 b0 25  |....O..sZ..[Jt.%|
+00000360  eb a8 7e a0 9d 1a e4 4e  bf 4f 55 b8 9d 93 cf 5b  |..~....N.OU....[|
+00000370  a4 22 3d 3b d5 8f 23 de  41 70 47 d8 3b 82 6b ba  |."=;..#.ApG.;.k.|
+00000380  26 f2 a2 e9 45 8e a9 72  1e 37 2e 0d a9 4b 54 b2  |&...E..r.7...KT.|
+00000390  6f 8f ec 04 97 86 b4 e4  4c cc f1 ed c9 e1 61 b1  |o.......L.....a.|
+000003a0  f8 a2 d7 fc a5 1a 8c 44  95 16 fc e3 25 b1 a9 d6  |.......D....%...|
+000003b0  21 17 03 03 00 35 fa ad  27 32 8d 61 3a 32 36 ef  |!....5..'2.a:26.|
+000003c0  ea ff 4e 95 cd a6 83 19  e2 72 85 44 33 b2 c0 45  |..N......r.D3..E|
+000003d0  f0 34 92 ca 5a a2 14 4c  6c a3 95 bd fe 3b f8 fd  |.4..Z..Ll....;..|
+000003e0  e1 11 9b f6 8f 4f c6 ae  05 31 55 17 03 03 00 8b  |.....O...1U.....|
+000003f0  8a a3 df b3 a0 68 8a e1  4f db c6 2a 8e df dc b6  |.....h..O..*....|
+00000400  07 b5 c4 c7 34 7f d8 e9  3f 88 0f 15 14 01 50 bc  |....4...?.....P.|
+00000410  64 05 8d 91 fa 24 1e 0e  cf db 11 8c 46 58 6e f1  |d....$......FXn.|
+00000420  09 68 14 9a 89 e0 6b ef  ac 90 27 69 2b 01 6c 2e  |.h....k...'i+.l.|
+00000430  6d e9 26 9f b1 ff b8 6c  8b 33 bb e8 42 54 85 c9  |m.&....l.3..BT..|
+00000440  14 d5 89 48 50 a6 8d be  dd b8 96 f1 45 4f 90 08  |...HP.......EO..|
+00000450  da cf 1f 75 33 85 d9 be  8e a5 4a c5 be a9 a3 16  |...u3.....J.....|
+00000460  f6 37 02 79 ea c3 e5 10  ed ff d5 f2 3d 46 7b ed  |.7.y........=F{.|
+00000470  bf be 36 a2 8a 00 9f 30  02 54 71                 |..6....0.Tq|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 df 64 d5 0f 22  |..........5.d.."|
-00000010  97 19 ed b0 9d 8e 38 3d  6c be b7 71 6f 33 0b 24  |......8=l..qo3.$|
-00000020  3b 72 8c c9 92 4a 99 37  7e cb 58 7a 5a e4 e4 dc  |;r...J.7~.XzZ...|
-00000030  c9 f4 08 a4 39 11 2c f3  d8 39 4c 96 09 20 c9 b7  |....9.,..9L.. ..|
+00000000  14 03 03 00 01 01 17 03  03 00 35 b6 3d e7 c7 a8  |..........5.=...|
+00000010  2d c2 a7 8b cc 13 db 7d  c2 75 18 f9 86 20 2b f0  |-......}.u... +.|
+00000020  e1 5d 11 b1 2d df 0c 12  a7 c5 3a 28 97 6e f8 f0  |.]..-.....:(.n..|
+00000030  7f c0 81 72 68 a5 41 68  59 ef da 3e 2f ef 97 45  |...rh.AhY..>/..E|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e c5 ed 41  e3 7e b0 e7 70 6a b4 4b  |.......A.~..pj.K|
-00000010  db 56 2e d5 ba d8 28 2d  30 ae 54 b9 bf 74 23 4b  |.V....(-0.T..t#K|
-00000020  3d 0c ea 17 03 03 00 13  99 a3 f5 14 f0 3e 88 b4  |=............>..|
-00000030  a5 d5 c6 04 2e 68 af 9a  32 ae 3b                 |.....h..2.;|
+00000000  17 03 03 00 1e fd 53 e4  87 a2 41 38 98 a6 d8 fa  |......S...A8....|
+00000010  7b 65 66 98 37 a6 4a 06  6b 25 11 66 ed 9c 00 22  |{ef.7.J.k%.f..."|
+00000020  83 6e f5 17 03 03 00 13  fc bb b9 93 79 3c 94 6c  |.n..........y<.l|
+00000030  1d 48 d9 5c 3e 51 86 fb  2a 0d d8                 |.H.\>Q..*..|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-CHACHA20-SHA256 b/src/crypto/tls/testdata/Server-TLSv13-CHACHA20-SHA256
index c9755fa9e4..1357ed41b2 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-CHACHA20-SHA256
+++ b/src/crypto/tls/testdata/Server-TLSv13-CHACHA20-SHA256
@@ -1,97 +1,97 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 73 54 07 a7 6e  |...........sT..n|
-00000010  ca 21 55 2a 76 fa 0f c2  67 e7 6d ad d8 e6 99 19  |.!U*v...g.m.....|
-00000020  7e 43 b8 b0 ee b1 4e 95  de 85 f1 20 c3 dc a3 62  |~C....N.... ...b|
-00000030  8d c5 4f 86 9d f1 1c 8b  48 a8 fc 9f 05 ad c7 80  |..O.....H.......|
-00000040  9b 50 3f 94 e0 bc e9 3b  e4 8d 7c 25 00 04 13 03  |.P?....;..|%....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 c4 32 0e 10 66  |............2..f|
+00000010  40 b2 cd 10 90 69 42 31  34 21 b1 a4 0e 15 f9 1e  |@....iB14!......|
+00000020  cd 2b 1d 1a 9a a5 4c 27  87 aa ba 20 6a f8 a9 57  |.+....L'... j..W|
+00000030  72 d6 5b 81 86 e7 df a0  9c a3 f4 21 30 c9 68 f3  |r.[........!0.h.|
+00000040  81 7c 2a 3a c6 fe 97 d7  40 c9 41 79 00 04 13 03  |.|*:....@.Ay....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 e8  |-.....3.&.$... .|
-000000b0  67 84 61 29 1f 9e 3f b0  a1 bf 63 41 b5 f8 84 54  |g.a)..?...cA...T|
-000000c0  f0 30 31 17 8d 80 73 0b  d0 d4 a6 31 ca ce 38     |.01...s....1..8|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 89  |-.....3.&.$... .|
+000000b0  77 64 a7 d7 9f 30 4d 07  5c 4c f5 3b 67 a3 f2 e3  |wd...0M.\L.;g...|
+000000c0  55 bb bb 9f 2e 18 26 04  b2 1a a2 64 c5 39 67     |U.....&....d.9g|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 c3 dc a3 62  |........... ...b|
-00000030  8d c5 4f 86 9d f1 1c 8b  48 a8 fc 9f 05 ad c7 80  |..O.....H.......|
-00000040  9b 50 3f 94 e0 bc e9 3b  e4 8d 7c 25 13 03 00 00  |.P?....;..|%....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 6a f8 a9 57  |........... j..W|
+00000030  72 d6 5b 81 86 e7 df a0  9c a3 f4 21 30 c9 68 f3  |r.[........!0.h.|
+00000040  81 7c 2a 3a c6 fe 97 d7  40 c9 41 79 13 03 00 00  |.|*:....@.Ay....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 99 76 19 3a 3f f9  |...........v.:?.|
-00000090  17 94 e5 6a c6 e1 1a 43  d5 dc fc 15 53 51 97 b9  |...j...C....SQ..|
-000000a0  87 17 03 03 02 6d a7 84  13 6e e0 5a 45 1d 0c 31  |.....m...n.ZE..1|
-000000b0  b8 62 cc 7e 6f 89 5d 37  3f b0 79 3f 59 53 c9 ab  |.b.~o.]7?.y?YS..|
-000000c0  0b 5e 3d ed 4a e0 8e 21  cd b3 e0 10 f9 a5 1c 73  |.^=.J..!.......s|
-000000d0  a2 d7 78 43 1a 34 c4 76  8a ca f9 cb 57 fc e7 5a  |..xC.4.v....W..Z|
-000000e0  84 f4 51 18 50 73 a3 10  57 a0 1f 73 e2 9c f6 a6  |..Q.Ps..W..s....|
-000000f0  01 93 bf e2 37 69 54 1f  bf 9b 18 09 56 8b 6c dd  |....7iT.....V.l.|
-00000100  ca 7f 88 b1 83 07 34 a1  31 64 ca 09 fa 60 22 f8  |......4.1d...`".|
-00000110  30 bf 39 18 e7 82 eb 30  2e 32 d2 e8 bb e9 68 b8  |0.9....0.2....h.|
-00000120  b3 c5 db 34 8b ac cd f3  f9 de 83 e3 44 c1 a7 e7  |...4........D...|
-00000130  c8 af 88 b4 b5 b9 9a 62  2a cc 2e 84 51 82 e3 66  |.......b*...Q..f|
-00000140  c3 27 20 22 9b cf 9f 19  59 05 c1 2a 5f 38 51 10  |.' "....Y..*_8Q.|
-00000150  90 2b 95 05 d2 1b 81 ef  eb 7a 04 5d 91 17 44 fb  |.+.......z.]..D.|
-00000160  a2 e5 5e 9a 1e ca a4 c2  a3 66 1c 23 92 3e 8a 02  |..^......f.#.>..|
-00000170  8e c0 6f 4a f5 49 a0 43  b7 f3 06 3f 7e bf cb 99  |..oJ.I.C...?~...|
-00000180  1c f9 73 53 2b 95 d9 70  52 ba 88 96 1a 3a b1 f6  |..sS+..pR....:..|
-00000190  3a fa 02 a3 50 42 74 dd  fb 9b 1f 0e ad 64 24 e2  |:...PBt......d$.|
-000001a0  a6 4a b3 b2 71 3d d4 c4  ff 0e d2 81 9e 05 f4 9d  |.J..q=..........|
-000001b0  63 84 81 de 8e db 10 39  ed 94 f9 9e 68 9b 3a 7c  |c......9....h.:||
-000001c0  51 d0 23 83 ca 5d 5b 16  7e fd 8c 25 e8 6e b4 45  |Q.#..][.~..%.n.E|
-000001d0  37 92 65 65 81 d0 c6 7a  f3 f8 aa 53 00 9e 4b 61  |7.ee...z...S..Ka|
-000001e0  f8 6a 6c c9 11 1e 3b cb  bd 33 bd 53 9a d4 9a 9f  |.jl...;..3.S....|
-000001f0  06 6f 4c 3c 05 ba d5 e9  a1 f8 44 36 d6 b0 2d 13  |.oL<......D6..-.|
-00000200  f5 e0 59 39 d7 0f 93 c9  48 e1 e0 8d 78 c6 18 3e  |..Y9....H...x..>|
-00000210  ef b4 ba 81 18 f4 45 18  28 92 68 46 f2 d6 6e 4e  |......E.(.hF..nN|
-00000220  93 58 f9 77 44 89 51 47  0c b4 70 ff f0 f5 05 0b  |.X.wD.QG..p.....|
-00000230  6f f5 d7 fb 70 e1 f4 af  93 36 5f 68 5d 7a cd 56  |o...p....6_h]z.V|
-00000240  ab 4a 5b e8 a0 5f 6e 41  41 f4 d9 28 9e 5c 27 e4  |.J[.._nAA..(.\'.|
-00000250  25 2d bb ee 0d 56 2b 4c  9e 76 5c e1 1a 46 e9 e1  |%-...V+L.v\..F..|
-00000260  0d 00 b2 c6 9d be 3d 50  7c b7 13 97 fc d6 c9 33  |......=P|......3|
-00000270  73 fb 0e d9 9b bc 4c ab  54 05 55 43 35 3b c4 13  |s.....L.T.UC5;..|
-00000280  29 c5 a1 66 cc 79 77 c0  74 82 dc c7 ea 1f 11 45  |)..f.yw.t......E|
-00000290  e8 9f 19 34 01 28 98 ca  19 7a ef 43 9d 79 be 66  |...4.(...z.C.y.f|
-000002a0  02 c2 36 d7 a2 f6 11 3f  e9 38 66 48 4d 18 10 35  |..6....?.8fHM..5|
-000002b0  78 2f c7 70 85 95 db e4  db 75 c9 00 2e 04 f5 94  |x/.p.....u......|
-000002c0  6c 95 1b 51 58 b5 b6 2c  f5 e3 b4 af 45 1c 66 36  |l..QX..,....E.f6|
-000002d0  37 39 36 e0 9c 87 9d 4f  d7 b2 34 fd 6d 7d 93 36  |796....O..4.m}.6|
-000002e0  c1 16 36 bd 90 92 85 cb  4c 0d 58 d7 a0 e4 24 f8  |..6.....L.X...$.|
-000002f0  dc f2 1b 7e 28 37 e9 39  a2 8a 86 02 33 a9 ea 8f  |...~(7.9....3...|
-00000300  e3 34 41 e0 6e f0 bf c7  f1 ee 6a a9 a6 9c 53 c1  |.4A.n.....j...S.|
-00000310  39 0a 29 17 03 03 00 99  53 09 fd 77 1b 2c f9 2d  |9.).....S..w.,.-|
-00000320  2c 5d 95 de 84 d5 62 7c  ae 8f 2b 4f 6f 38 e1 fb  |,]....b|..+Oo8..|
-00000330  1c 95 e6 bf 57 aa a0 e5  4c f2 9e 1c 7b ef 1b 2c  |....W...L...{..,|
-00000340  d4 83 c8 6b 96 d5 c1 16  96 8a 62 e4 8a e8 ff 61  |...k......b....a|
-00000350  0b 3f 2e d2 14 f5 05 e6  e1 51 02 d6 40 62 f8 84  |.?.......Q..@b..|
-00000360  d4 02 2b 84 81 ee 45 64  49 cb 44 b9 e8 61 08 44  |..+...EdI.D..a.D|
-00000370  8e 93 3c 67 57 34 64 9f  0d 1e 76 27 27 4f 4f bd  |..<gW4d...v''OO.|
-00000380  ae a4 48 fc e9 cc 1f a1  28 36 c0 8f a6 b7 f1 61  |..H.....(6.....a|
-00000390  98 33 5e a7 16 79 48 ac  fb 24 99 40 eb a0 41 b4  |.3^..yH..$.@..A.|
-000003a0  93 b5 4b fd 7a 21 26 6c  f4 1b 21 ba 29 be c3 19  |..K.z!&l..!.)...|
-000003b0  74 17 03 03 00 35 37 3c  de b6 9f 90 dd 30 a4 a4  |t....57<.....0..|
-000003c0  af e1 3d 72 4a 31 50 ea  f6 36 33 23 a4 07 7d fc  |..=rJ1P..63#..}.|
-000003d0  36 20 c8 23 e7 1a b4 eb  02 11 ed 2c f6 43 17 51  |6 .#.......,.C.Q|
-000003e0  e1 d6 7a 3f d5 00 6c 67  8e 11 c3 17 03 03 00 88  |..z?..lg........|
-000003f0  9e 11 b0 bd 5f b2 e5 21  2b b1 61 6f 98 98 04 7e  |...._..!+.ao...~|
-00000400  a8 c3 8b 85 38 9b d5 79  11 6b 24 fd 02 0d 98 b2  |....8..y.k$.....|
-00000410  a9 0c e5 24 25 23 d3 f9  ba 80 84 84 b9 67 b3 ae  |...$%#.......g..|
-00000420  a1 c3 46 94 f8 19 18 e5  31 67 47 c7 12 79 65 d9  |..F.....1gG..ye.|
-00000430  96 87 dc eb ac 0f b7 09  50 86 13 76 7d fb b4 8f  |........P..v}...|
-00000440  ad 02 48 ed 89 68 16 14  74 53 23 70 0f 3c 72 1c  |..H..h..tS#p.<r.|
-00000450  20 d6 b2 df 54 f8 29 a5  0b d0 d3 e0 76 3f be e5  | ...T.).....v?..|
-00000460  bf c0 41 04 8a 5a e6 b6  d3 64 f9 63 fb a4 5c 51  |..A..Z...d.c..\Q|
-00000470  5b a5 54 0b d5 7a 86 db                           |[.T..z..|
+00000080  03 03 00 01 01 17 03 03  00 17 db 02 44 4c 7e 06  |............DL~.|
+00000090  95 c7 f2 f7 8f f7 80 96  d0 11 b7 d7 d6 9e 40 3b  |..............@;|
+000000a0  0f 17 03 03 02 6d 63 90  e6 9e e7 fd 52 34 74 8f  |.....mc.....R4t.|
+000000b0  e5 db e8 90 49 90 89 8a  c3 7f 33 a0 c7 91 2a 3f  |....I.....3...*?|
+000000c0  c5 1f 0c 00 58 9f 5e d7  01 35 24 92 a7 66 db 0e  |....X.^..5$..f..|
+000000d0  fd d3 6c ff 58 61 56 39  b3 9b 05 d2 a1 9f ab f1  |..l.XaV9........|
+000000e0  29 ce b0 c6 37 c5 56 8d  0b 2a bd 0c 04 a3 c8 4e  |)...7.V..*.....N|
+000000f0  61 08 44 4b b7 f1 12 60  a9 f6 e7 02 14 e7 d4 1a  |a.DK...`........|
+00000100  cf e6 4d ce 11 7c e3 7b  44 95 6d fa 8e b2 3b f4  |..M..|.{D.m...;.|
+00000110  bb 8e fa ed be ec fb f4  1d d0 12 56 d3 64 c8 cd  |...........V.d..|
+00000120  58 e0 e0 df c1 f2 c7 b5  7a 6c 23 ff d1 78 b7 76  |X.......zl#..x.v|
+00000130  a5 96 66 5c 4e 49 5a 8e  fd 9d 74 dc e7 f0 99 f8  |..f\NIZ...t.....|
+00000140  d5 95 7a 5b ba b6 ab 87  90 a5 35 19 bf 99 2c 04  |..z[......5...,.|
+00000150  93 61 e3 9b 5c 06 48 38  f0 25 8a be 30 cd 43 c0  |.a..\.H8.%..0.C.|
+00000160  10 c9 1d 51 3e 93 5f 6c  02 1c 38 fe 78 44 1a ea  |...Q>._l..8.xD..|
+00000170  99 a4 ef 7d 03 ce 71 95  d7 1d e1 b3 b8 e2 20 99  |...}..q....... .|
+00000180  aa 30 0f c1 75 a7 0d 39  98 12 96 27 c6 39 b8 57  |.0..u..9...'.9.W|
+00000190  6e ab 79 c7 91 c2 56 9d  b3 e1 cb 17 6a cc 42 47  |n.y...V.....j.BG|
+000001a0  fc a4 52 10 ab cd 4b 1f  65 3e 35 61 ed 38 99 7b  |..R...K.e>5a.8.{|
+000001b0  a7 79 02 f2 16 cb 85 fb  85 f8 86 56 40 6b ee 2f  |.y.........V@k./|
+000001c0  38 c6 4f 9c 25 14 b6 e4  5f 5c cc 73 ef 69 f3 5a  |8.O.%..._\.s.i.Z|
+000001d0  c6 ef 0d 65 e8 d4 f8 c6  0c 5b 09 88 4d 09 e7 50  |...e.....[..M..P|
+000001e0  86 d0 2d 6c 8c 99 d0 d9  6a 24 77 97 47 59 9d ce  |..-l....j$w.GY..|
+000001f0  b9 a5 34 99 f6 0b 08 9a  7e 79 8d 84 8e c2 ae ac  |..4.....~y......|
+00000200  ca b3 af 5d 7d 96 d2 99  3b da ee ec 36 b3 ad 71  |...]}...;...6..q|
+00000210  89 17 de 52 71 75 99 ca  e7 02 c2 ab ae da 5b 22  |...Rqu........["|
+00000220  a7 88 0c ae c5 c0 b0 1f  3c cd da fa e7 8b 39 46  |........<.....9F|
+00000230  84 c0 1a 33 29 ed 90 0e  5b 32 86 96 9f 97 69 66  |...3)...[2....if|
+00000240  90 08 0e 0e 84 4d 43 55  c1 be 08 20 85 fc 9d 7a  |.....MCU... ...z|
+00000250  a6 df e8 31 b0 35 c3 69  b6 14 b2 ec 6c 7d ad ae  |...1.5.i....l}..|
+00000260  2b b4 c0 5a d1 07 a7 45  17 93 d6 a5 50 d0 e4 cc  |+..Z...E....P...|
+00000270  97 85 5d 06 21 62 e2 95  d7 b5 a5 a9 08 cf 34 f4  |..].!b........4.|
+00000280  ae cc 17 e4 0e 4e 5a 13  b1 73 03 45 b9 29 b5 45  |.....NZ..s.E.).E|
+00000290  77 a1 4b 2f 8f c5 72 41  dc ab f9 b7 f3 72 28 f4  |w.K/..rA.....r(.|
+000002a0  cb 08 07 0a 20 7c 8b 26  70 92 7b 7b b9 99 61 0a  |.... |.&p.{{..a.|
+000002b0  63 17 e2 96 86 0a 6a 56  a1 90 1f 5e 50 bb 7f 72  |c.....jV...^P..r|
+000002c0  73 58 f4 25 c8 18 ec a5  b1 86 cd 96 77 57 91 67  |sX.%........wW.g|
+000002d0  76 e1 7a bf 1b 40 62 a0  58 d7 e8 2c 4c 86 7b ed  |v.z..@b.X..,L.{.|
+000002e0  7f 3f 43 38 88 97 f7 a1  5f 22 0c a0 4a a4 b3 b9  |.?C8...._"..J...|
+000002f0  11 2c 31 f3 98 f0 21 42  fb 42 a7 9e 38 ce 58 5f  |.,1...!B.B..8.X_|
+00000300  bc d0 a5 43 07 d2 e1 4b  5f 5c fd 56 da 99 63 2a  |...C...K_\.V..c*|
+00000310  0d 7f 46 17 03 03 00 99  bf be 5f 82 e4 2b d8 9f  |..F......._..+..|
+00000320  cf ab 68 b0 3d a4 a0 c7  c3 41 dd e5 46 cf 7b 55  |..h.=....A..F.{U|
+00000330  c7 6d 76 e4 62 60 c5 ae  d3 a0 f0 44 8c 88 de 05  |.mv.b`.....D....|
+00000340  5e 5e 03 61 fe 66 22 31  cf f5 75 b6 97 51 36 79  |^^.a.f"1..u..Q6y|
+00000350  f0 b7 d1 7f e6 1a fa 04  73 23 ad 66 f8 6c 47 a7  |........s#.f.lG.|
+00000360  cc 0b 96 c4 a7 a8 e8 4c  91 bc c9 32 30 ec db 2e  |.......L...20...|
+00000370  73 68 00 5b c3 83 17 60  51 b1 03 8d c3 f9 e1 e8  |sh.[...`Q.......|
+00000380  f7 e7 a8 f4 94 b7 4f c1  bf aa 50 49 61 b1 11 0a  |......O...PIa...|
+00000390  78 24 cc 16 3b e5 10 72  95 df e4 a3 5d 2c ff ad  |x$..;..r....],..|
+000003a0  bd 50 04 93 3c 3c 48 28  0b e3 d9 d3 db 4d 4a 8f  |.P..<<H(.....MJ.|
+000003b0  62 17 03 03 00 35 b2 f4  32 f5 f9 b9 f3 cc 15 d5  |b....5..2.......|
+000003c0  d7 85 83 e7 37 5f ac 10  4f 2f 43 59 0b a6 4b 9c  |....7_..O/CY..K.|
+000003d0  2b e8 c3 87 fa 3f 4d b5  54 75 93 ab 2f 4c 72 03  |+....?M.Tu../Lr.|
+000003e0  6f 8f f4 ac 43 d1 4c dc  62 b7 6d 17 03 03 00 8b  |o...C.L.b.m.....|
+000003f0  89 17 54 55 04 e9 55 45  a3 82 7e e9 7c 2e 28 6b  |..TU..UE..~.|.(k|
+00000400  28 a7 82 f1 e7 db cd 3e  ac 6e d8 d0 0b 0e 52 73  |(......>.n....Rs|
+00000410  b0 01 2c 04 8e 7b 70 c3  36 85 a4 44 aa 15 63 d6  |..,..{p.6..D..c.|
+00000420  7d f4 81 86 3c 1e ad d3  b3 2c ea 33 bf 0e 71 68  |}...<....,.3..qh|
+00000430  4a 1a 3a 98 bb 21 d4 75  6c 0d d2 30 b4 b3 86 5d  |J.:..!.ul..0...]|
+00000440  90 ab 49 dc 18 4f 08 10  8b 23 8d bd 61 68 75 ee  |..I..O...#..ahu.|
+00000450  87 62 54 2d 2d 1e c0 39  5c eb 32 40 7a da 4d 2f  |.bT--..9\.2@z.M/|
+00000460  83 f9 e8 1f 71 d7 79 99  24 8a b7 13 25 64 a6 ae  |....q.y.$...%d..|
+00000470  29 e2 48 6f f7 52 cf a4  aa c2 70                 |).Ho.R....p|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 81 a5 08 75 69  |..........5...ui|
-00000010  69 d3 98 34 19 41 0b 66  e9 bf c2 ac 74 9c 42 5d  |i..4.A.f....t.B]|
-00000020  73 50 3d 3e 3a 76 3c f1  f7 4a 23 a1 6b 0c 03 cb  |sP=>:v<..J#.k...|
-00000030  bb 4a b8 98 72 1e 7f ac  c0 79 2a 76 99 ee 85 5a  |.J..r....y*v...Z|
+00000000  14 03 03 00 01 01 17 03  03 00 35 5e e5 2f e4 ed  |..........5^./..|
+00000010  87 c3 26 01 1a d0 4d c7  95 16 76 be 17 a3 f4 1f  |..&...M...v.....|
+00000020  57 27 f6 19 62 30 7e f0  47 6e 11 7f ce 85 54 9a  |W'..b0~.Gn....T.|
+00000030  1e 86 9a c6 10 5e 38 3c  0a de d1 4e 7e f1 9d 0f  |.....^8<...N~...|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 08 53 f7  ad 7f a4 48 9c e7 a8 31  |......S....H...1|
-00000010  cc 91 55 c3 c0 89 64 ec  0d c8 dc fd 95 e9 ef 12  |..U...d.........|
-00000020  a5 52 a0 17 03 03 00 13  17 bf 2b 25 9a ff 5f 2b  |.R........+%.._+|
-00000030  32 f2 28 c3 c6 4f 20 dc  dc 09 88                 |2.(..O ....|
+00000000  17 03 03 00 1e 1f a0 f2  e5 47 62 54 e2 07 3d e2  |.........GbT..=.|
+00000010  42 8a be ec e0 92 4e ae  1e 7a 75 6f 8d c0 65 73  |B.....N..zuo..es|
+00000020  b5 eb bc 17 03 03 00 13  89 03 04 f9 42 a9 6d cf  |............B.m.|
+00000030  68 67 f4 ca e0 87 f9 ef  d4 42 6a                 |hg.......Bj|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndECDSAGiven b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndECDSAGiven
index 825e1d1e4a..a957c26399 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndECDSAGiven
+++ b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndECDSAGiven
@@ -1,180 +1,180 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 6d 54 85 0d 98  |...........mT...|
-00000010  c5 8b 26 ec 63 38 87 ac  bb 8e 69 cc dc 4e b6 7e  |..&.c8....i..N.~|
-00000020  64 ae 02 e3 4b ff 38 0d  75 29 48 20 38 db 3d 9a  |d...K.8.u)H 8.=.|
-00000030  cd c9 6e cf 22 5b 09 a2  c9 9a 27 36 14 f1 8b 90  |..n."[....'6....|
-00000040  be 9e bf 88 ca af 40 6e  16 4c 86 ad 00 04 13 01  |......@n.L......|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 cd 87 c0 5e 7c  |..............^||
+00000010  7b d7 c6 77 d9 21 6f 46  00 07 88 61 18 8c b9 d4  |{..w.!oF...a....|
+00000020  ad 25 6a 9d 7e 54 cc 70  52 7c 0f 20 67 9b dd 18  |.%j.~T.pR|. g...|
+00000030  84 bb 23 7d 53 10 b9 6c  01 ef 30 6f 79 7d 64 5c  |..#}S..l..0oy}d\|
+00000040  79 3e c1 11 8f 75 cf 83  02 d3 e8 d9 00 04 13 01  |y>...u..........|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 77  |-.....3.&.$... w|
-000000b0  a0 8b 51 0e 47 27 0b 1e  61 17 64 93 14 ee a2 98  |..Q.G'..a.d.....|
-000000c0  01 31 32 d5 50 ed a0 a1  a3 59 2f 28 d0 34 5d     |.12.P....Y/(.4]|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 d7  |-.....3.&.$... .|
+000000b0  18 8a c1 a5 4d cb 7c f2  7d e4 cf 7a c6 92 28 ee  |....M.|.}..z..(.|
+000000c0  a6 b4 79 65 bf 2b fb 71  2e a5 2a 58 da 6f 5e     |..ye.+.q..*X.o^|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 38 db 3d 9a  |........... 8.=.|
-00000030  cd c9 6e cf 22 5b 09 a2  c9 9a 27 36 14 f1 8b 90  |..n."[....'6....|
-00000040  be 9e bf 88 ca af 40 6e  16 4c 86 ad 13 01 00 00  |......@n.L......|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 67 9b dd 18  |........... g...|
+00000030  84 bb 23 7d 53 10 b9 6c  01 ef 30 6f 79 7d 64 5c  |..#}S..l..0oy}d\|
+00000040  79 3e c1 11 8f 75 cf 83  02 d3 e8 d9 13 01 00 00  |y>...u..........|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 4b 3b 67 ba 64 c9  |..........K;g.d.|
-00000090  7a c8 a1 64 7f 7b 74 a1  bd 9b 4d 8b c5 a0 70 5d  |z..d.{t...M...p]|
-000000a0  98 17 03 03 00 3e 9e 29  80 90 d2 52 80 49 23 96  |.....>.)...R.I#.|
-000000b0  0b b0 93 d8 ac bf c6 22  1c 2e 14 ea 91 99 71 e5  |......."......q.|
-000000c0  d0 c4 ab 04 fc 22 b4 36  d0 50 02 39 23 b3 60 c1  |.....".6.P.9#.`.|
-000000d0  bd 71 53 3a c5 23 df 0a  08 b2 bf 91 c3 d2 b4 f1  |.qS:.#..........|
-000000e0  55 81 ca fa 17 03 03 02  6d 06 1f 34 8c c5 02 e6  |U.......m..4....|
-000000f0  5d b2 87 9e e0 e9 d7 64  a3 cf a4 e8 3e e6 34 46  |]......d....>.4F|
-00000100  f4 eb 51 0e 41 f9 00 61  bd b2 36 7d b3 9f 30 e8  |..Q.A..a..6}..0.|
-00000110  62 aa 06 d2 08 c3 f4 16  eb 39 0c 2e 69 ca a5 2d  |b........9..i..-|
-00000120  ce 48 e2 c9 60 04 a8 9b  f8 98 c7 f2 de 71 cb cf  |.H..`........q..|
-00000130  c6 8d de bc 80 50 ba 3e  76 5c d7 0b 39 ef fd 77  |.....P.>v\..9..w|
-00000140  68 7f fc 77 db 18 fb 7a  7a 74 2d 59 88 fa 7d db  |h..w...zzt-Y..}.|
-00000150  24 4c f3 18 c5 1f 73 9c  af e1 26 e0 8d 14 a9 b3  |$L....s...&.....|
-00000160  eb a3 0d 8a ed a2 19 e9  7d a3 a8 f7 dc 08 0f 69  |........}......i|
-00000170  06 84 45 cb 49 a0 12 ef  95 fd 0a 5f 49 80 91 0f  |..E.I......_I...|
-00000180  a9 0d 3a 52 25 1f 62 90  1a d8 fa a6 01 a0 f3 98  |..:R%.b.........|
-00000190  ce e6 68 4e 3e 60 43 58  ad 53 a5 4b d8 b4 09 c5  |..hN>`CX.S.K....|
-000001a0  0e 2b 11 0a e4 dc 8e 5d  1c 56 97 c1 63 08 0f 1c  |.+.....].V..c...|
-000001b0  e7 ec 0e 94 f4 65 bf c8  5d 52 ac 6b f3 b2 36 34  |.....e..]R.k..64|
-000001c0  bf e0 5d 35 91 93 5b 36  04 d4 10 49 1c 08 7f f5  |..]5..[6...I....|
-000001d0  fc 18 7f 81 36 be 3f fe  23 8b 8d d9 d4 8a 06 ec  |....6.?.#.......|
-000001e0  af 39 b1 85 df 2d be 23  8d 86 d9 3e e5 27 fa 62  |.9...-.#...>.'.b|
-000001f0  e4 8e 94 a1 26 55 0a ed  0f 21 38 a3 b1 6a 36 e7  |....&U...!8..j6.|
-00000200  ae 53 4c c5 65 d1 9a 63  8f 98 de fe d9 dd 3f fe  |.SL.e..c......?.|
-00000210  44 2b 26 61 bd d9 cf 88  bb a3 f4 b7 45 14 59 91  |D+&a........E.Y.|
-00000220  dc bd fd 4f 57 c7 37 5b  8b b7 e2 5c b2 1d c3 15  |...OW.7[...\....|
-00000230  67 8e 64 c5 af d7 30 00  01 47 09 bd 55 01 47 b7  |g.d...0..G..U.G.|
-00000240  7f 12 29 dd 57 f2 05 8c  57 c6 08 fb 78 13 d1 e5  |..).W...W...x...|
-00000250  c8 33 49 6c c2 b2 38 ea  22 8e f9 79 d1 8e 17 9f  |.3Il..8."..y....|
-00000260  a8 0b f8 0d 23 07 f4 ce  fb 2d 9d 2f 6d a1 42 b6  |....#....-./m.B.|
-00000270  66 7b 7d 64 fc 45 6e 92  99 ee a4 57 72 04 02 30  |f{}d.En....Wr..0|
-00000280  83 2e 48 d5 17 9f 2d 2b  84 83 ce e3 c1 17 d5 49  |..H...-+.......I|
-00000290  48 4b ea 60 fc 1f bb 3b  93 24 db 2a c7 7b 4d cf  |HK.`...;.$.*.{M.|
-000002a0  93 1f 8e aa 8a bb dd f1  79 9a 4f d1 54 b5 7d 6c  |........y.O.T.}l|
-000002b0  67 76 9e 4b eb 40 4d 73  76 fb d2 32 9a eb 3f 27  |gv.K.@Msv..2..?'|
-000002c0  c3 18 40 63 25 76 af 65  9b a1 73 74 cb d2 a8 c1  |..@c%v.e..st....|
-000002d0  35 40 0a 4f db f8 f6 4e  93 06 56 34 48 2e 1f 26  |5@.O...N..V4H..&|
-000002e0  b4 e1 13 14 6b f9 dc 81  cd 2a 74 3a 54 86 b2 a2  |....k....*t:T...|
-000002f0  d7 d5 33 6b 79 32 9b cb  1f 95 18 28 c5 99 eb 72  |..3ky2.....(...r|
-00000300  79 6f a7 4b 46 e2 86 f4  c5 29 cc 0f 05 1d c3 56  |yo.KF....).....V|
-00000310  eb 28 67 58 7b c6 13 05  da d6 7d a9 5b 2c 62 a2  |.(gX{.....}.[,b.|
-00000320  70 13 0f d6 22 06 cd bc  12 53 b2 36 7a 17 a1 40  |p..."....S.6z..@|
-00000330  ac 39 f8 1f d6 1d 92 00  0a 03 fa 95 75 4a c5 e9  |.9..........uJ..|
-00000340  a1 bb 1d 7e 8c 5a 48 15  5a db 5a 4c 98 ab 2a 51  |...~.ZH.Z.ZL..*Q|
-00000350  fc 5e d9 ce b0 9e 17 03  03 00 99 8c 17 be 13 25  |.^.............%|
-00000360  04 a3 6a 51 01 52 4c 16  3f 60 93 88 86 83 f8 83  |..jQ.RL.?`......|
-00000370  bd 6e 56 76 37 e6 b9 56  d6 97 d3 4f 74 1c 43 f3  |.nVv7..V...Ot.C.|
-00000380  38 5c e9 49 5b 1a ca 85  e9 f9 68 64 42 17 fe 6a  |8\.I[.....hdB..j|
-00000390  7b bf ea 41 06 a0 c8 15  44 5c cb 32 02 22 c6 35  |{..A....D\.2.".5|
-000003a0  ec f0 a5 43 a2 9d b5 83  a5 85 58 04 1a 22 90 b2  |...C......X.."..|
-000003b0  a1 d6 65 e0 5e ea 69 fc  e5 22 98 15 5c 93 61 f9  |..e.^.i.."..\.a.|
-000003c0  53 ea d5 7c c4 d4 fa f3  19 eb c2 21 9e e3 c3 cb  |S..|.......!....|
-000003d0  80 2d 79 b8 26 a8 dc 08  86 b7 65 96 42 a8 73 99  |.-y.&.....e.B.s.|
-000003e0  5b e0 15 ed 9c 3f 0d 1b  17 fd dd 1f c3 c5 67 b1  |[....?........g.|
-000003f0  c3 fd c9 d1 17 03 03 00  35 2b a2 f5 53 a1 46 fb  |........5+..S.F.|
-00000400  f2 30 e6 28 a2 bc 3a 24  ae 67 36 d9 73 84 5a ea  |.0.(..:$.g6.s.Z.|
-00000410  f8 e1 cd 13 b9 e5 43 3d  95 d5 63 f9 b6 19 7c 53  |......C=..c...|S|
-00000420  98 f4 07 f0 da f2 56 c2  68 d4 d0 25 f3 5e        |......V.h..%.^|
+00000080  03 03 00 01 01 17 03 03  00 17 4d 4b 33 12 cb ed  |..........MK3...|
+00000090  f7 a2 55 e7 a6 ab 5b b1  55 16 30 c3 ee e1 5c 14  |..U...[.U.0...\.|
+000000a0  b8 17 03 03 00 3e 30 04  2a e5 e8 b8 f3 25 9b a9  |.....>0.*....%..|
+000000b0  92 e6 eb d9 fb b6 62 64  e2 de 9d c0 48 68 b3 d7  |......bd....Hh..|
+000000c0  0f 8b ad 21 69 c7 f0 d7  96 ff 6a 24 2f 01 c9 e7  |...!i.....j$/...|
+000000d0  e9 06 4b 93 94 67 97 44  46 c4 69 2f 0e aa e0 9b  |..K..g.DF.i/....|
+000000e0  8d 19 f2 2c 17 03 03 02  6d a1 fb 2b 5f 10 e9 62  |...,....m..+_..b|
+000000f0  8b ad c1 33 58 f6 a7 89  78 a6 dd 64 ff c2 c7 57  |...3X...x..d...W|
+00000100  80 9f 59 be 2d bd f5 b9  8a 6b d9 22 1c fe 10 ea  |..Y.-....k."....|
+00000110  c4 a5 3e 45 d9 d7 12 cf  48 d5 26 18 49 50 80 69  |..>E....H.&.IP.i|
+00000120  44 28 03 3b b6 f8 0a 0e  b4 cb 5e 5b 57 0f c0 2f  |D(.;......^[W../|
+00000130  59 4f 13 e3 9c 02 18 b1  ce 94 78 05 18 64 73 c6  |YO........x..ds.|
+00000140  05 89 d1 54 37 18 ea 09  61 08 c5 6a 54 f6 48 44  |...T7...a..jT.HD|
+00000150  40 63 6a 53 b9 41 5f 4f  8e 05 e7 31 7b 08 d0 67  |@cjS.A_O...1{..g|
+00000160  8e bf 56 c4 56 0a 82 b2  74 6a 89 dd b4 f7 3c 0b  |..V.V...tj....<.|
+00000170  3c fd 21 1f 00 72 1d 4f  be b1 50 44 9a 14 67 7d  |<.!..r.O..PD..g}|
+00000180  a9 93 30 a2 4e ea 61 c9  fd 44 de 5c 88 36 59 a2  |..0.N.a..D.\.6Y.|
+00000190  e3 63 b1 9c ea dd 47 0a  ca 63 9e 50 9d ca 57 12  |.c....G..c.P..W.|
+000001a0  05 9b fc f1 26 a2 5e 18  9b 32 00 38 1f ce a6 58  |....&.^..2.8...X|
+000001b0  58 0f 61 e2 44 c2 89 34  cc f4 fd 9a dc 1a 67 a6  |X.a.D..4......g.|
+000001c0  e8 b1 fc 9f dc bd 0b 21  01 49 0d 9b e1 40 00 f6  |.......!.I...@..|
+000001d0  33 1a 57 c5 84 c1 98 3d  7f 53 d3 4d 2e 04 5e 40  |3.W....=.S.M..^@|
+000001e0  7d 38 80 66 bc c5 40 d9  14 f6 83 26 82 9b c8 14  |}8.f..@....&....|
+000001f0  61 aa 6c 1c a1 53 81 f8  b0 7f 06 92 5c af be 57  |a.l..S......\..W|
+00000200  1a 54 97 02 27 31 1f 58  52 cf 39 2f 82 26 ae 6c  |.T..'1.XR.9/.&.l|
+00000210  86 d9 46 cd 38 16 e2 67  62 82 2e 53 7a 86 15 30  |..F.8..gb..Sz..0|
+00000220  08 0c a7 e2 85 18 55 79  16 44 4d 50 9e b5 e7 e1  |......Uy.DMP....|
+00000230  2c 1e 1d eb e1 83 f3 9e  d0 7b 45 b8 1e 51 d9 79  |,........{E..Q.y|
+00000240  91 7a b8 90 bc 18 94 69  ad 94 08 e5 23 de 2b fa  |.z.....i....#.+.|
+00000250  8d ef 23 4c 40 df e1 43  0d 71 51 ef 88 a9 bb 89  |..#L@..C.qQ.....|
+00000260  59 87 9c db e1 d4 31 94  a7 f5 af 7d 51 be e9 d0  |Y.....1....}Q...|
+00000270  f2 49 12 72 47 65 a0 5b  7d 9f 91 85 f7 e8 d6 90  |.I.rGe.[}.......|
+00000280  b3 4d f3 5d 6a 51 96 a9  81 84 72 95 47 e8 0a f5  |.M.]jQ....r.G...|
+00000290  8d d6 2a 64 c2 34 1b d8  f0 f9 62 0c be 17 12 9b  |..*d.4....b.....|
+000002a0  40 a2 c3 8a eb 30 20 04  e4 69 a3 27 90 a6 1a 4f  |@....0 ..i.'...O|
+000002b0  3f 95 65 e6 9e c7 ad 03  e1 d2 34 d2 84 d5 f6 8c  |?.e.......4.....|
+000002c0  1e 8a aa e4 75 c0 7f 1d  79 4e 70 10 4e 18 9c eb  |....u...yNp.N...|
+000002d0  17 76 0c 66 6c 82 72 41  83 98 fc 41 41 4a 07 03  |.v.fl.rA...AAJ..|
+000002e0  a6 16 51 0d 60 96 43 0a  97 27 72 42 31 70 6b 02  |..Q.`.C..'rB1pk.|
+000002f0  e4 58 b0 15 4f 2e a3 5a  ed dc 82 99 82 47 d5 6c  |.X..O..Z.....G.l|
+00000300  4b b4 68 70 f5 a3 31 36  52 8d af ab d1 ac f6 28  |K.hp..16R......(|
+00000310  2e 18 bc 4f 1b 7c a8 ad  c3 1f 2f 70 a6 c4 39 c6  |...O.|..../p..9.|
+00000320  ae 0f 2e b7 58 c9 c0 2a  4b 34 c2 42 12 e3 5d ed  |....X..*K4.B..].|
+00000330  d1 ac e1 f1 14 66 d4 09  1c a0 99 82 d3 04 13 2a  |.....f.........*|
+00000340  a4 20 c4 e7 38 1e 0a 02  4e 96 02 71 9d f6 f7 86  |. ..8...N..q....|
+00000350  f7 30 1a 5d 65 4f 17 03  03 00 99 3f 3d 4a 91 ae  |.0.]eO.....?=J..|
+00000360  0f 80 52 0f 1c d1 a2 75  83 e5 08 d8 1f 9d c8 24  |..R....u.......$|
+00000370  fc 85 ba 76 1f 9e 1e 35  a3 dd 45 83 8e b9 55 a6  |...v...5..E...U.|
+00000380  3b 26 ae 82 4f 1f 2e 8f  e5 25 fb d6 22 0f 55 d6  |;&..O....%..".U.|
+00000390  ac fa 93 6d d1 d3 7c 41  af c0 15 5c 8b e1 64 c1  |...m..|A...\..d.|
+000003a0  3f a2 c8 9e 48 f5 63 61  3a df 13 6e f4 e3 60 9d  |?...H.ca:..n..`.|
+000003b0  bc 52 bd b7 94 e9 4b 7a  65 97 28 ac 39 6a 77 a7  |.R....Kze.(.9jw.|
+000003c0  86 1d b4 6b e4 15 c4 bd  2b 41 b6 06 ac ff b5 9f  |...k....+A......|
+000003d0  17 47 b4 a7 1d 69 8b 6e  82 eb f7 39 03 95 10 dd  |.G...i.n...9....|
+000003e0  18 78 50 58 c8 78 80 ae  45 dc 54 0f 33 cb 4a d2  |.xPX.x..E.T.3.J.|
+000003f0  90 00 12 d4 17 03 03 00  35 76 fa bf ab 3f c3 3d  |........5v...?.=|
+00000400  dd 78 65 cc 35 1e 24 35  4f 7d 3c e4 bb 73 d8 19  |.xe.5.$5O}<..s..|
+00000410  56 94 f4 ce ad bc 1d 6a  fb 1b 75 01 93 36 2b 44  |V......j..u..6+D|
+00000420  3a 3c a3 9b 7c 57 6f 98  24 a3 64 b1 13 47        |:<..|Wo.$.d..G|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 02 1e 35 ea 71 3a ff  |...........5.q:.|
-00000010  24 95 39 41 c0 15 b0 24  88 34 2a 31 3e 7c 62 4f  |$.9A...$.4*1>|bO|
-00000020  d2 6d 83 7e da e9 23 3b  34 2a cd 1a c0 a3 20 30  |.m.~..#;4*.... 0|
-00000030  f6 8b 04 43 a9 01 1b 5f  e7 8f 16 f4 30 8e b9 dc  |...C..._....0...|
-00000040  75 b7 40 5f 21 bb af 41  e9 af b8 bc 7d de 5d 5e  |u.@_!..A....}.]^|
-00000050  39 99 21 45 e0 e4 1c 5c  04 c9 77 34 52 6e e2 4e  |9.!E...\..w4Rn.N|
-00000060  76 77 21 10 c8 a6 f8 66  02 4d fb 6f 68 ab 16 52  |vw!....f.M.oh..R|
-00000070  49 bf 50 bd 4a 2a d5 e5  4d 8c 19 9f 4e b6 d8 7f  |I.P.J*..M...N...|
-00000080  b8 4b 8d f2 ff a6 32 52  35 15 de d3 fd 83 d1 fa  |.K....2R5.......|
-00000090  6c c2 5e f1 2a 46 de 24  9f ba 3f e5 0e 7b b8 98  |l.^.*F.$..?..{..|
-000000a0  25 38 69 ea d5 84 49 b0  02 6f b8 61 54 71 4e fe  |%8i...I..o.aTqN.|
-000000b0  a2 48 ff bd 0e 69 99 30  91 4d 0a 77 31 96 78 36  |.H...i.0.M.w1.x6|
-000000c0  65 41 00 eb e4 f3 37 77  0f 16 fd 6f a2 ae d2 8b  |eA....7w...o....|
-000000d0  1a e1 81 34 a1 e0 20 5b  b3 ac 8e 22 c4 bc fa d2  |...4.. [..."....|
-000000e0  64 41 82 37 b8 e7 a5 43  e3 d8 2f 23 0a ff 1d 39  |dA.7...C../#...9|
-000000f0  ee c8 48 3b 4a c2 b0 a9  99 e2 20 60 9b 8c 17 0b  |..H;J..... `....|
-00000100  c1 71 58 d1 cf 40 e5 85  fe 33 38 f4 87 90 b4 79  |.qX..@...38....y|
-00000110  f9 ab 6b 7a bf db c9 2d  8a 4b 3c 15 6a ce 05 5e  |..kz...-.K<.j..^|
-00000120  b9 8c e5 cb 66 28 75 d0  55 a6 e5 47 12 18 b9 e3  |....f(u.U..G....|
-00000130  73 31 b9 23 d0 54 bd 4f  26 71 8a 71 fe 4b 75 bd  |s1.#.T.O&q.q.Ku.|
-00000140  02 ee 4a b3 fe f5 83 7d  74 23 69 5d 72 40 d6 de  |..J....}t#i]r@..|
-00000150  71 77 bd 4a f2 ac 92 c6  0b d5 ce ad 89 21 11 80  |qw.J.........!..|
-00000160  20 00 bb ca 45 d8 d1 82  1b 5c 9a 63 01 46 06 d4  | ...E....\.c.F..|
-00000170  f9 74 59 8d 7f af e7 8b  9b 92 cb 41 85 6d 8e e3  |.tY........A.m..|
-00000180  a6 45 79 12 1e c5 9f 35  aa 21 9b 23 d5 50 85 df  |.Ey....5.!.#.P..|
-00000190  ff 1c 10 5c 0e d0 fe 0f  62 9c 65 99 19 06 4b f4  |...\....b.e...K.|
-000001a0  57 a3 1a 97 68 56 bb 00  c8 5c 55 68 e4 9d a4 af  |W...hV...\Uh....|
-000001b0  75 87 f7 91 52 98 bf 19  15 07 2a 40 fa 9f 51 a5  |u...R.....*@..Q.|
-000001c0  de 0e 3d 30 fe 0f 30 b2  6c ab 46 c8 08 de 30 02  |..=0..0.l.F...0.|
-000001d0  2f 6d 96 b0 ad 1b 8c 55  dc 85 1a c9 b5 34 3a 8c  |/m.....U.....4:.|
-000001e0  26 be b7 4d 42 06 62 bf  aa 1c 2b 3d cd 90 a2 89  |&..MB.b...+=....|
-000001f0  b5 c5 f5 fa 7a 28 60 6c  ce c8 88 f9 cc 7f 83 fc  |....z(`l........|
-00000200  87 b1 ca 37 9d 99 2a 3d  ad d4 56 63 e7 5f c1 85  |...7..*=..Vc._..|
-00000210  a0 2d b5 d4 14 fc 4e 97  6b b8 47 96 e7 3e 87 53  |.-....N.k.G..>.S|
-00000220  d8 ba f8 65 12 2a b4 ac  95 17 03 03 00 a4 78 09  |...e.*........x.|
-00000230  fa cc 9d 62 ac 51 44 96  9b 72 9c 3c c5 24 cd 82  |...b.QD..r.<.$..|
-00000240  08 7b af e0 c8 ef 41 cc  56 5d bb a8 47 9b d2 28  |.{....A.V]..G..(|
-00000250  53 71 2e 1f 86 11 42 3e  7e 4f d4 cd f8 c4 1e be  |Sq....B>~O......|
-00000260  06 14 c5 6d 8d 75 d1 6a  b3 8f 3a 4b 7e 1a c5 05  |...m.u.j..:K~...|
-00000270  8b 78 38 58 61 aa c7 32  35 56 9f 7a cf 13 1e d5  |.x8Xa..25V.z....|
-00000280  36 75 01 0f 39 fd f2 c3  f2 53 85 6b 47 11 9b 95  |6u..9....S.kG...|
-00000290  97 b2 ce cd 1c ef df a1  d5 ce 63 46 73 da 68 40  |..........cFs.h@|
-000002a0  ea c4 04 1d 7e d7 e5 1e  97 1d 0d 4a 0d 2d 69 e2  |....~......J.-i.|
-000002b0  b2 35 58 d2 73 97 14 77  a8 7d d5 13 3b 52 40 f4  |.5X.s..w.}..;R@.|
-000002c0  2f f3 39 97 bd 24 d5 87  81 69 02 c3 77 d7 88 53  |/.9..$...i..w..S|
-000002d0  63 46 17 03 03 00 35 cc  78 42 da 9d 5b 8f ec c7  |cF....5.xB..[...|
-000002e0  e8 38 a2 b1 26 e7 2e aa  65 24 c1 1e 7b bb 69 60  |.8..&...e$..{.i`|
-000002f0  88 f1 20 cc 95 32 61 62  d4 b0 0b 44 03 97 78 b8  |.. ..2ab...D..x.|
-00000300  18 0e b4 49 cd 03 81 aa  6a 61 56 48 17 03 03 00  |...I....jaVH....|
-00000310  13 b5 fb 3d 26 ff cd 0f  27 3d 46 dd 06 1f 57 88  |...=&...'=F...W.|
-00000320  e0 df 8f e5                                       |....|
+00000000  14 03 03 00 01 01 17 03  03 02 1e e0 29 6d d1 38  |............)m.8|
+00000010  a6 03 d7 fc 2b df a4 a4  d0 ae 87 01 b8 82 5d eb  |....+.........].|
+00000020  3c 25 3e a1 33 89 b5 05  eb bc 02 0f ad 84 f0 2b  |<%>.3..........+|
+00000030  5f 14 af 0d f8 f1 08 e3  ca c1 8e ad 4b a5 a0 09  |_...........K...|
+00000040  b8 a0 4f bf e4 0f 93 a9  4a 35 35 26 22 d7 04 03  |..O.....J55&"...|
+00000050  70 95 4f 80 df d4 47 5b  21 14 27 d6 17 ea 32 6e  |p.O...G[!.'...2n|
+00000060  ea 3a ca 31 7c f2 d1 46  a2 ef 47 b9 16 d6 18 d5  |.:.1|..F..G.....|
+00000070  17 35 71 9d 14 37 63 cd  e1 c6 ff 3d ec a5 d8 53  |.5q..7c....=...S|
+00000080  48 d5 d8 0b 75 39 c1 d2  66 ad 97 4e 5f eb c3 c7  |H...u9..f..N_...|
+00000090  e0 77 95 fd 16 84 e2 a3  6a f2 a8 88 5e 4c 86 be  |.w......j...^L..|
+000000a0  81 a5 f2 6b 12 86 63 f1  4f a6 8d 63 7c 07 0f 8d  |...k..c.O..c|...|
+000000b0  53 d5 d4 00 c7 b7 2a ef  b2 1d 07 4e 43 d6 25 35  |S.....*....NC.%5|
+000000c0  c9 b1 fa 91 d1 f7 87 c6  98 c7 e7 c2 c3 7d 42 09  |.............}B.|
+000000d0  e5 3c 50 83 1b 20 ef ec  e4 ac 2e f2 3e 03 73 52  |.<P.. ......>.sR|
+000000e0  2e 1d 20 cf e2 8d 15 c3  c7 a6 2f 68 b5 8e 5f bc  |.. ......./h.._.|
+000000f0  c5 73 61 ff 52 3c b0 7b  47 82 47 a0 73 f8 1c ab  |.sa.R<.{G.G.s...|
+00000100  4d ea 15 fa 94 e0 7f 70  c1 c8 9c 55 f0 96 38 42  |M......p...U..8B|
+00000110  76 d4 26 6d a7 73 11 59  43 19 2f 49 70 a9 18 1c  |v.&m.s.YC./Ip...|
+00000120  12 9e ee d3 eb ca 1c c0  3b e1 99 e3 c2 25 de 39  |........;....%.9|
+00000130  1a 15 e0 d7 20 9d 1b 95  74 8c ee 96 7b 5e de 13  |.... ...t...{^..|
+00000140  99 56 54 a2 31 7b e9 96  02 9e 86 7b 15 9d c6 3e  |.VT.1{.....{...>|
+00000150  24 a5 19 e5 8e de 85 97  05 68 4f 39 d1 49 05 c9  |$........hO9.I..|
+00000160  7a 54 90 29 e7 93 ec 8e  6f cc 73 73 82 7d 72 8d  |zT.)....o.ss.}r.|
+00000170  4a 85 29 7f a5 53 13 26  16 b2 fa c3 ce 1f 8b ae  |J.)..S.&........|
+00000180  e6 60 8c 2d b0 64 66 d4  29 7c b5 2d 1d 11 c5 09  |.`.-.df.)|.-....|
+00000190  bb a5 44 c6 c8 af e6 f1  d5 f8 d9 45 97 64 7f 03  |..D........E.d..|
+000001a0  02 f7 f5 9f cb 31 1e 89  e4 5d a0 e9 34 db be 28  |.....1...]..4..(|
+000001b0  51 15 68 54 01 7c e5 1d  b4 05 d2 d6 24 ca 10 69  |Q.hT.|......$..i|
+000001c0  31 bf 8b 7a ee d9 bf e1  2a d4 7c c8 e8 79 ca dd  |1..z....*.|..y..|
+000001d0  0f 73 09 c8 cf 97 28 78  04 5b 04 51 44 c4 5f d1  |.s....(x.[.QD._.|
+000001e0  dc da 4f f5 d9 5c 9c b1  ea f8 1b f7 43 90 c0 c0  |..O..\......C...|
+000001f0  fd 82 56 e3 71 15 18 5e  7e 5c 61 5e b3 80 c1 1c  |..V.q..^~\a^....|
+00000200  22 92 32 67 23 f6 3b 74  e4 20 4e 1f fb f8 89 55  |".2g#.;t. N....U|
+00000210  e7 3c 18 30 24 77 7c 33  5c 89 91 60 65 14 06 9e  |.<.0$w|3\..`e...|
+00000220  e2 6d f0 07 84 4b b4 14  e8 17 03 03 00 a3 a7 e1  |.m...K..........|
+00000230  f7 26 48 56 da 6d ef a5  f4 5f 19 52 37 9e e7 6d  |.&HV.m..._.R7..m|
+00000240  28 07 70 ee 1e de 85 2b  7a 2d bf eb 48 06 f5 d4  |(.p....+z-..H...|
+00000250  ea 4d 83 86 59 d4 14 4f  46 bc 17 89 f1 f5 37 0e  |.M..Y..OF.....7.|
+00000260  84 60 6e ba 73 d7 c1 bc  6f d7 aa cf f0 36 96 a2  |.`n.s...o....6..|
+00000270  83 60 81 6f 48 6c 9d 87  e5 b6 5e 77 ab c5 e3 cb  |.`.oHl....^w....|
+00000280  8e 55 94 dc 94 f3 8a ce  cb f7 b4 d5 33 55 df 88  |.U..........3U..|
+00000290  22 44 04 ee 4e f5 30 e7  30 94 dc 95 2d 97 2c e4  |"D..N.0.0...-.,.|
+000002a0  34 58 4d 38 9e 25 61 96  c1 37 66 34 2b be ee e6  |4XM8.%a..7f4+...|
+000002b0  ee 39 73 89 a3 aa 1b 0a  5a bf 44 23 4e 19 5c c4  |.9s.....Z.D#N.\.|
+000002c0  3f 27 47 5c 40 67 6c 50  b8 3f 7c c9 97 f0 55 02  |?'G\@glP.?|...U.|
+000002d0  16 17 03 03 00 35 82 8b  0d 4e 87 3c c6 bc 41 8b  |.....5...N.<..A.|
+000002e0  ec ab 71 9d 57 7b e6 22  e4 87 82 61 5d f8 69 31  |..q.W{."...a].i1|
+000002f0  8a 2c be 2c d8 4d 2f dc  9a 91 31 7a ab d8 a4 0e  |.,.,.M/...1z....|
+00000300  ba cb fc ef 17 a4 7c 87  ca 13 bb 17 03 03 00 13  |......|.........|
+00000310  3b d0 da 9f d4 be fa 59  7a 30 8b 7e 8e a0 99 c0  |;......Yz0.~....|
+00000320  c2 36 f3                                          |.6.|
 >>> Flow 4 (server to client)
-00000000  17 03 03 02 8d 0c e6 86  3a 8f 57 a1 71 e1 7e e3  |........:.W.q.~.|
-00000010  62 61 33 8f 0a 08 ca 6a  98 5a d0 6f 2b d2 c6 bb  |ba3....j.Z.o+...|
-00000020  ae bd 7f 73 ab 7c b5 9f  dd 43 98 4d 5f 62 71 2e  |...s.|...C.M_bq.|
-00000030  52 21 ea e2 e9 f7 7d f3  72 57 0c 64 8b f9 a0 dc  |R!....}.rW.d....|
-00000040  0a 08 8b f3 a7 90 9d 55  a0 be a0 42 70 71 fc c0  |.......U...Bpq..|
-00000050  cc ec 46 92 2a de 94 93  85 c6 e7 30 89 5e cc d6  |..F.*......0.^..|
-00000060  0f c2 0d 4b b5 79 0c fd  d1 42 47 08 71 0d ec fc  |...K.y...BG.q...|
-00000070  4a a8 b4 1d 58 42 48 15  89 56 0a 08 5d 60 7a a7  |J...XBH..V..]`z.|
-00000080  a7 6a ea 62 6a fc 46 ab  d8 25 9e 2c ff 85 78 b6  |.j.bj.F..%.,..x.|
-00000090  37 bf 84 b0 34 ed 4d 39  de c9 e6 47 9f 75 c7 6b  |7...4.M9...G.u.k|
-000000a0  fc e3 8f 4c eb 8a 68 ee  d6 76 3f 2a b1 2a 8d 2c  |...L..h..v?*.*.,|
-000000b0  40 e9 d9 cf 8f d6 db 7a  da 0b d7 02 5a e0 36 11  |@......z....Z.6.|
-000000c0  06 6c 67 70 a9 6d 8b d9  62 dc 70 e8 64 a8 f9 8f  |.lgp.m..b.p.d...|
-000000d0  ac 99 5a 40 17 18 54 5b  8b fa 20 ff 3c 7e f5 c3  |..Z@..T[.. .<~..|
-000000e0  a4 06 83 28 e4 68 97 6f  6b d7 16 91 54 dd 29 2f  |...(.h.ok...T.)/|
-000000f0  8c fc 86 a5 98 97 55 0d  2f e6 57 41 1a a9 f1 c2  |......U./.WA....|
-00000100  4b 9c 72 ef 30 40 17 4f  a9 dd 68 b3 72 cc 1a d2  |K.r.0@.O..h.r...|
-00000110  5f b6 4b df 37 8f f6 7b  2d 7d 4b b9 16 9e 8a 53  |_.K.7..{-}K....S|
-00000120  dd 64 42 c2 f0 7f b5 fd  82 25 78 7b 29 68 1b a4  |.dB......%x{)h..|
-00000130  5b 66 f0 1b e3 8e 31 36  44 2f 23 58 72 c2 f9 be  |[f....16D/#Xr...|
-00000140  3b 99 ab 0b 45 dc 88 23  38 69 3d 35 43 a5 22 89  |;...E..#8i=5C.".|
-00000150  cc 82 e0 9c 1d f3 1d cd  13 50 bb 5a 99 06 16 e6  |.........P.Z....|
-00000160  bc e7 d9 2c d8 ed fc 5b  98 06 63 d2 37 35 0a 7b  |...,...[..c.75.{|
-00000170  b5 dc 66 3d 8b 21 f8 de  1c 7d f6 91 fa 42 49 b0  |..f=.!...}...BI.|
-00000180  91 4f e9 ea 5f da 05 40  c0 2c 28 ed da 24 c5 fb  |.O.._..@.,(..$..|
-00000190  71 57 87 d5 f5 8e 7a 82  07 12 17 60 57 c4 3f bf  |qW....z....`W.?.|
-000001a0  8e aa 2e eb f2 be c1 9c  8b ed f3 08 30 68 3a 04  |............0h:.|
-000001b0  52 26 08 8c 96 81 4b 91  32 b4 2e 4e d9 66 d2 32  |R&....K.2..N.f.2|
-000001c0  66 c1 b2 97 59 68 6b 50  2c 80 51 c4 ad 15 c5 25  |f...YhkP,.Q....%|
-000001d0  87 64 74 8d c9 6c 53 d3  78 eb bd b3 9f 53 15 cb  |.dt..lS.x....S..|
-000001e0  98 18 65 1a f8 99 d8 f3  a0 2f 0f aa 17 4b 8d 3f  |..e....../...K.?|
-000001f0  2f 40 cb 70 0b ad 4e 9a  fe 5f 71 8a ab 75 8d 57  |/@.p..N.._q..u.W|
-00000200  03 66 3d 9f cd 92 da b1  30 27 bb 6d 93 7b f0 d2  |.f=.....0'.m.{..|
-00000210  3f d9 0b 26 1d c7 44 2f  ea 70 94 eb cd 8e 9e 0a  |?..&..D/.p......|
-00000220  e2 24 74 b1 66 45 93 d3  62 ca ff ae 7e d1 ad 0f  |.$t.fE..b...~...|
-00000230  d2 50 a9 d0 39 df ac 41  79 ca f1 f5 48 ad 84 20  |.P..9..Ay...H.. |
-00000240  a4 6a d3 f2 29 f8 5c 11  df d1 7a 63 7a 66 75 7f  |.j..).\...zczfu.|
-00000250  4e 14 9f cc 52 99 6f 4b  78 9c 2c b6 c1 fa 47 7c  |N...R.oKx.,...G||
-00000260  ce 79 ce 0a 45 47 45 49  19 1a ad 4b 5c 7c 6d 81  |.y..EGEI...K\|m.|
-00000270  fe ff f3 43 6a 8c 38 50  e6 a8 02 35 f9 e0 33 bc  |...Cj.8P...5..3.|
-00000280  e2 29 09 db 66 8a d9 1c  9a dd cd 96 f8 95 e8 87  |.)..f...........|
-00000290  6e 99 17 03 03 00 1e c8  fe 4f 98 52 76 d3 62 bc  |n........O.Rv.b.|
-000002a0  ed d2 20 e3 05 3c ec 58  fe 4d 87 96 57 ee 94 f8  |.. ..<.X.M..W...|
-000002b0  3a f3 fe 5f 3e 17 03 03  00 13 8e ba f5 f6 e7 ed  |:.._>...........|
-000002c0  d7 ef 6a 7a 0f e8 e3 51  ce 90 a5 ed 96           |..jz...Q.....|
+00000000  17 03 03 02 90 a2 a0 e4  83 63 ad 8d d5 45 25 dc  |.........c...E%.|
+00000010  41 02 31 28 8d b0 87 85  66 b8 9c 36 f3 1f 97 87  |A.1(....f..6....|
+00000020  8c c9 e6 b4 67 1e 42 ab  84 c4 eb 0a 41 b1 0f 50  |....g.B.....A..P|
+00000030  25 c3 7e 69 20 cf 8a d0  56 79 61 e3 e1 5b cc a4  |%.~i ...Vya..[..|
+00000040  24 5a c7 2d 3b 17 33 92  59 6c 7e 29 a9 a2 2c 73  |$Z.-;.3.Yl~)..,s|
+00000050  3e b1 65 32 3d 6a 2b 61  5d 76 c4 66 0e 4f f1 da  |>.e2=j+a]v.f.O..|
+00000060  dd d3 7e 29 3d f5 42 99  9e 04 60 a4 9a a1 c0 f7  |..~)=.B...`.....|
+00000070  54 4e d5 58 73 85 02 83  38 ba 4e 93 9a 69 68 07  |TN.Xs...8.N..ih.|
+00000080  71 c9 a7 e4 83 51 4c 11  21 26 b2 dd ad 4b 2a ef  |q....QL.!&...K*.|
+00000090  23 9b b0 f6 d6 96 9f 99  1f 69 fe 35 28 86 49 bc  |#........i.5(.I.|
+000000a0  ec 97 11 4d 4e b7 c1 c2  da 6c ae c7 40 b9 2a 1f  |...MN....l..@.*.|
+000000b0  ff 9d 9d ea 90 b9 61 6f  76 ae fe 55 70 f6 ee 54  |......aov..Up..T|
+000000c0  54 62 6d 19 9a fc 40 16  e5 c2 e2 3e d1 68 c6 09  |Tbm...@....>.h..|
+000000d0  be 54 64 25 8a a0 2b e6  b3 14 7e 74 17 91 f0 de  |.Td%..+...~t....|
+000000e0  87 e8 3c 3e 58 8d 1b b2  4e 2d 7d c1 f8 aa 16 ca  |..<>X...N-}.....|
+000000f0  2a 3e 8f aa 52 14 e4 f2  2a b9 6e 62 46 ab ed 3a  |*>..R...*.nbF..:|
+00000100  ff a1 51 53 92 7a 78 c4  ed 9d fd 1f b4 62 2e e7  |..QS.zx......b..|
+00000110  cc 9d 09 fa 06 2e 9e 55  e5 98 9e b8 be e9 12 94  |.......U........|
+00000120  33 58 6b be 71 a1 4f f8  a0 83 85 f8 7e b4 28 a7  |3Xk.q.O.....~.(.|
+00000130  ee 1b ac 3c 46 b6 ac 60  af 5d cc b0 a8 2c 3f 95  |...<F..`.]...,?.|
+00000140  75 2a 73 ac 02 7e d8 04  21 fc 68 d7 6f 1d 31 40  |u*s..~..!.h.o.1@|
+00000150  43 81 26 b7 00 5f 77 d9  21 7b b4 7c cd 9f 89 69  |C.&.._w.!{.|...i|
+00000160  ef 11 0c 60 db 22 94 98  eb 10 d9 0c 0e 29 c2 d9  |...`.".......)..|
+00000170  74 8d 71 25 b8 5a c1 13  d6 f6 01 58 6d 71 31 7c  |t.q%.Z.....Xmq1||
+00000180  66 e8 e5 36 06 b3 e4 51  0c b1 43 88 bf 2b 54 d7  |f..6...Q..C..+T.|
+00000190  52 79 3d 07 a9 c2 e5 97  cc 79 87 b1 c7 8b 30 7b  |Ry=......y....0{|
+000001a0  b1 fe 90 58 35 a1 dc 18  8a fa cc df 63 2b 72 57  |...X5.......c+rW|
+000001b0  14 e1 12 4c bc d7 ba c2  e5 f7 4c 40 d6 34 ea 11  |...L......L@.4..|
+000001c0  8f be 3d 7a 34 11 c1 1a  ad f8 2e 89 94 8a 3a ce  |..=z4.........:.|
+000001d0  e5 8f e8 bc 77 71 38 8c  3c 6e 29 a3 1a 14 9d 3d  |....wq8.<n)....=|
+000001e0  a3 28 46 32 38 f0 14 74  ff 9b 99 71 65 ab ef c8  |.(F28..t...qe...|
+000001f0  67 ab 47 91 61 d1 af cf  7d 96 89 d5 57 17 96 d3  |g.G.a...}...W...|
+00000200  30 d5 fb 74 3b b8 df 77  98 7b 04 3e a1 a8 5a f1  |0..t;..w.{.>..Z.|
+00000210  6b 5c d2 4d b2 20 35 63  9e 83 c0 7e 83 60 46 57  |k\.M. 5c...~.`FW|
+00000220  c0 80 0d d7 b9 9f 14 c0  58 2d 48 2a cc 8c 1d 32  |........X-H*...2|
+00000230  2c 34 ec 10 f2 34 b4 28  e1 0e 83 38 c4 2e 5a 09  |,4...4.(...8..Z.|
+00000240  ff e6 3f d3 9a 32 8e 33  9e 31 18 e5 1d 6b 97 12  |..?..2.3.1...k..|
+00000250  9b 93 84 86 62 8a 0a 8a  ab 8d 37 68 af a1 ec 8e  |....b.....7h....|
+00000260  38 c8 47 ef 10 f8 64 7c  e1 13 0a 33 eb c2 4b bf  |8.G...d|...3..K.|
+00000270  47 49 6d 93 3c c9 44 aa  74 67 a9 93 dd de 66 47  |GIm.<.D.tg....fG|
+00000280  1e b3 55 47 b1 16 88 68  82 24 d6 b8 81 b0 5a b6  |..UG...h.$....Z.|
+00000290  27 7a f8 0b 5c 17 03 03  00 1e a5 9b 8c d2 3e 96  |'z..\.........>.|
+000002a0  f3 49 7a ed d9 fc 33 62  15 12 43 76 11 f9 dc fc  |.Iz...3b..Cv....|
+000002b0  ea d2 d7 87 22 6f 9e 3d  17 03 03 00 13 e1 30 4e  |...."o.=......0N|
+000002c0  4c 1d 02 78 57 a5 ee 8f  1c 5f 19 f0 57 3a 8d 7e  |L..xW...._..W:.~|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndEd25519Given b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndEd25519Given
index 39b96af39e..6943bf6569 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndEd25519Given
+++ b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndEd25519Given
@@ -1,148 +1,149 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 67 86 da 6b c6  |...........g..k.|
-00000010  c1 54 42 ab 97 40 7e b1  34 f1 8a 74 5f 3a f8 04  |.TB..@~.4..t_:..|
-00000020  7a c5 13 59 be 15 98 41  d9 31 33 20 02 66 43 1b  |z..Y...A.13 .fC.|
-00000030  99 2a 51 bd 57 6c e1 d8  f0 7f 5d 3b 06 90 3d d5  |.*Q.Wl....];..=.|
-00000040  04 86 b2 f1 ed 88 a8 75  3d 9f 5b cb 00 04 13 01  |.......u=.[.....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 e4 83 a9 75 06  |..............u.|
+00000010  0f 8b c9 35 1e 62 89 7f  a8 df 7c 93 b6 f0 8f 94  |...5.b....|.....|
+00000020  ea 31 dc 66 11 66 bd 77  33 54 bf 20 38 77 15 8d  |.1.f.f.w3T. 8w..|
+00000030  b4 21 50 72 6f 95 61 6c  15 b8 35 c9 92 10 72 99  |.!Pro.al..5...r.|
+00000040  bc 41 03 53 7c 5e 7b b3  a4 2e b4 19 00 04 13 01  |.A.S|^{.........|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 fa  |-.....3.&.$... .|
-000000b0  a0 f1 5e db 21 20 f4 0b  5f af 0c 8f 7f 1f bc 25  |..^.! .._......%|
-000000c0  c5 98 67 29 50 1d 67 18  4d 1d 91 78 68 65 3f     |..g)P.g.M..xhe?|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 8e  |-.....3.&.$... .|
+000000b0  cf 32 24 aa f2 36 c7 41  50 66 dd 57 ce 97 72 8d  |.2$..6.APf.W..r.|
+000000c0  f3 b6 7d a0 a4 5e 5d fe  be bb ce 32 9f 03 75     |..}..^]....2..u|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 02 66 43 1b  |........... .fC.|
-00000030  99 2a 51 bd 57 6c e1 d8  f0 7f 5d 3b 06 90 3d d5  |.*Q.Wl....];..=.|
-00000040  04 86 b2 f1 ed 88 a8 75  3d 9f 5b cb 13 01 00 00  |.......u=.[.....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 38 77 15 8d  |........... 8w..|
+00000030  b4 21 50 72 6f 95 61 6c  15 b8 35 c9 92 10 72 99  |.!Pro.al..5...r.|
+00000040  bc 41 03 53 7c 5e 7b b3  a4 2e b4 19 13 01 00 00  |.A.S|^{.........|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 9f e2 cb 10 96 be  |................|
-00000090  1b bf 9e d5 95 2d 6b fb  c9 e6 37 29 47 ce 35 a5  |.....-k...7)G.5.|
-000000a0  38 17 03 03 00 3e b8 6c  e6 69 68 16 44 dc 0e 03  |8....>.l.ih.D...|
-000000b0  08 94 bd 21 78 dc 99 b6  50 8c 22 ae d5 89 8f db  |...!x...P.".....|
-000000c0  1b 56 af d3 be e1 13 e4  a5 57 44 2d b0 2b 12 bb  |.V.......WD-.+..|
-000000d0  03 23 b8 ec dc ef 08 cf  54 62 0f 59 f5 b7 d4 5c  |.#......Tb.Y...\|
-000000e0  0a a0 1f 60 17 03 03 02  6d 9d 6c 0c 26 22 f4 c9  |...`....m.l.&"..|
-000000f0  da 32 ef 5f 8a cb 8e 41  27 5c c7 d8 84 86 9a 73  |.2._...A'\.....s|
-00000100  5a da 5e 25 62 b1 97 7d  2b 7e 38 e7 5f fb 15 c7  |Z.^%b..}+~8._...|
-00000110  61 ff 24 db 43 6c fa f8  a1 ee cb 27 85 4a 53 61  |a.$.Cl.....'.JSa|
-00000120  84 1c fe 3e 59 dd fe cf  c7 ea d0 8f 0a 44 7b e9  |...>Y........D{.|
-00000130  31 b3 01 4f ff d8 01 65  84 c4 a0 70 c1 56 f9 43  |1..O...e...p.V.C|
-00000140  ce dc 39 d0 86 54 e2 db  90 7b a9 d5 fd ae ab 83  |..9..T...{......|
-00000150  f6 94 2e 51 45 33 34 0f  0e 1d e4 8d 43 57 92 45  |...QE34.....CW.E|
-00000160  88 48 91 d7 cf 8c 50 e3  83 60 08 e2 0f 51 54 cf  |.H....P..`...QT.|
-00000170  41 c2 8d df b4 88 3b a9  83 cd 16 62 ec 1a f0 cf  |A.....;....b....|
-00000180  59 47 ab f2 de 3f d4 9f  42 00 f9 a1 66 bb 79 24  |YG...?..B...f.y$|
-00000190  60 ed ef ce 70 ca 5a 8d  2c 19 10 c2 f8 66 7d 63  |`...p.Z.,....f}c|
-000001a0  39 77 0d 1c 63 51 8a 4c  ae 4d e5 ce 4c 1b c5 5d  |9w..cQ.L.M..L..]|
-000001b0  94 fe b2 0b d1 1a 1e d3  3d 0f d3 33 ef e7 1b f8  |........=..3....|
-000001c0  a4 f2 ba 0a 3a 21 61 7b  2f 92 c0 d4 a6 75 a2 f4  |....:!a{/....u..|
-000001d0  d3 40 e3 73 e1 b1 2e 59  75 60 c2 07 88 6d 7f 59  |.@.s...Yu`...m.Y|
-000001e0  9b 57 3c e9 e2 63 da 0a  76 83 ee 4f df df 49 75  |.W<..c..v..O..Iu|
-000001f0  55 68 87 eb 9f f8 da 9f  84 04 78 06 b8 e8 f0 a4  |Uh........x.....|
-00000200  bb 54 16 82 f8 20 08 ba  36 14 64 56 76 54 9b 2b  |.T... ..6.dVvT.+|
-00000210  f4 06 07 04 de e8 8b 7a  fc 24 a1 ea 88 a7 78 da  |.......z.$....x.|
-00000220  ec 6a 7a ab 7c 60 e1 bc  6d fa 8c 88 36 cd 0c 57  |.jz.|`..m...6..W|
-00000230  2f cd 4e 1f 3b 55 b0 29  c5 e7 36 0f bd 97 3d 2b  |/.N.;U.)..6...=+|
-00000240  00 a6 26 b8 6e 0b 27 66  39 07 24 b7 b4 06 c1 69  |..&.n.'f9.$....i|
-00000250  96 bc 79 59 4a 03 6f 1e  05 6f c3 0c ce 20 c5 b8  |..yYJ.o..o... ..|
-00000260  35 90 f2 26 95 00 c0 bb  c3 14 f9 2a aa 4f c0 f3  |5..&.......*.O..|
-00000270  89 86 57 77 a3 89 80 a6  66 b1 08 47 11 c5 f5 24  |..Ww....f..G...$|
-00000280  72 f6 16 62 65 1e 7c b0  49 38 34 35 53 2d 6b 80  |r..be.|.I845S-k.|
-00000290  1d d9 e1 d3 aa 01 66 6f  84 12 5b 99 30 25 2a 8c  |......fo..[.0%*.|
-000002a0  4b 24 12 4e 56 4c b0 c8  c1 31 bf dd da 9d 78 a7  |K$.NVL...1....x.|
-000002b0  22 01 cb 5c ae 15 90 4a  6b 67 78 43 74 3f f1 99  |"..\...JkgxCt?..|
-000002c0  a5 8c 37 1b 93 00 52 73  4b 46 4b 26 68 82 33 5d  |..7...RsKFK&h.3]|
-000002d0  3d b9 83 07 0e 6d 09 40  d1 07 42 5c de e5 f8 42  |=....m.@..B\...B|
-000002e0  4a d9 40 9a 65 b4 6f 81  c8 ab eb 40 6e f8 0a 9e  |J.@.e.o....@n...|
-000002f0  84 54 3e e1 7a 95 13 98  95 26 ff d0 27 f7 1d b0  |.T>.z....&..'...|
-00000300  28 b7 db 57 1d c9 4f d5  6c 56 03 92 61 fc 05 c4  |(..W..O.lV..a...|
-00000310  d3 5e 55 4d d7 03 b5 2b  87 73 c0 fe 04 c4 38 15  |.^UM...+.s....8.|
-00000320  22 01 49 ae da fc 79 5c  d7 4d 12 11 47 4d 80 b3  |".I...y\.M..GM..|
-00000330  86 e4 68 60 d8 3b cf ab  b5 12 9f 4c f1 04 62 e0  |..h`.;.....L..b.|
-00000340  64 dd 1b 75 b1 19 aa 54  63 d6 f8 27 a8 93 0f 6c  |d..u...Tc..'...l|
-00000350  8d f6 26 3a 38 36 17 03  03 00 99 d0 c7 7b 47 07  |..&:86.......{G.|
-00000360  d9 50 aa 5e ad 9b d5 30  43 be 14 06 57 60 3d 35  |.P.^...0C...W`=5|
-00000370  e9 a9 69 c3 6d 92 f4 35  8a ab 44 9d fe 39 f6 b8  |..i.m..5..D..9..|
-00000380  22 db 72 21 0d 39 09 60  35 77 38 63 81 3d ef 5f  |".r!.9.`5w8c.=._|
-00000390  55 b1 11 27 08 89 4a d2  c4 58 bb 37 07 3c 03 3b  |U..'..J..X.7.<.;|
-000003a0  1c 5b f0 d5 d0 09 ca bb  46 e1 af 9b 06 cc a4 7d  |.[......F......}|
-000003b0  56 82 17 09 b8 a4 2e da  71 e1 45 a1 49 d0 43 be  |V.......q.E.I.C.|
-000003c0  42 75 d1 4e e2 53 80 73  09 6c dc d6 21 51 08 90  |Bu.N.S.s.l..!Q..|
-000003d0  3b d0 52 35 04 54 69 9d  84 cb 3f ce 9f 75 74 c0  |;.R5.Ti...?..ut.|
-000003e0  03 6c 52 b3 75 46 2a 62  60 34 81 85 e6 1c 3f 00  |.lR.uF*b`4....?.|
-000003f0  15 46 d4 4e 17 03 03 00  35 41 e8 e3 54 dc a3 d1  |.F.N....5A..T...|
-00000400  90 58 f9 21 08 17 f6 8d  b7 2f f2 94 b4 5a 89 99  |.X.!...../...Z..|
-00000410  04 7c 02 65 d7 11 2d ee  cf 4c ae 84 2f b0 6a b3  |.|.e..-..L../.j.|
-00000420  c5 5d 17 4d 4f 9f 38 65  29 70 43 37 69 71        |.].MO.8e)pC7iq|
+00000080  03 03 00 01 01 17 03 03  00 17 3b ca 9a d3 b7 99  |..........;.....|
+00000090  d7 d8 c9 f9 96 b8 70 69  3b 22 42 0f c4 72 de 7c  |......pi;"B..r.||
+000000a0  05 17 03 03 00 3e 38 d7  00 60 b9 ce 17 31 26 9f  |.....>8..`...1&.|
+000000b0  db ef e2 b1 99 55 c8 f9  f3 a0 81 19 12 a7 63 85  |.....U........c.|
+000000c0  5a 26 2d d1 1c ad 5d ae  d6 4b 66 93 62 d7 fe 08  |Z&-...]..Kf.b...|
+000000d0  40 e9 fa 16 8b 89 f8 04  e8 33 67 20 2b 21 91 a0  |@........3g +!..|
+000000e0  c6 0a 87 ff 17 03 03 02  6d 79 97 6c 2f f6 01 7b  |........my.l/..{|
+000000f0  3a 49 0e 1a 00 96 10 fd  7f 77 db 76 b2 d4 e4 68  |:I.......w.v...h|
+00000100  46 4e 4f 3c 64 54 ca 27  9a 5c 78 98 f4 96 a4 fe  |FNO<dT.'.\x.....|
+00000110  29 e5 44 cb 6d 3e bd ce  89 15 c6 75 d8 28 00 da  |).D.m>.....u.(..|
+00000120  ff d8 ec 27 2c f2 4c e5  a0 6e 88 ce 67 6e 35 f4  |...',.L..n..gn5.|
+00000130  e5 d5 96 2d 40 af fa 88  12 8a 48 24 2c f9 82 f5  |...-@.....H$,...|
+00000140  cb a4 6e 95 a6 53 bc 79  f7 6a ef 66 77 bc 46 f0  |..n..S.y.j.fw.F.|
+00000150  1b 0d 6b 5c 76 82 15 c4  d0 1c dd ec cc ce 09 93  |..k\v...........|
+00000160  ce 21 55 9b d8 8a 11 1b  0c 24 fa 9e 5f 29 4a f1  |.!U......$.._)J.|
+00000170  2a 2e ad c0 6d 6d 46 06  5b c9 75 b3 3e 32 45 67  |*...mmF.[.u.>2Eg|
+00000180  05 26 cc d8 a8 4a a9 b1  67 71 a6 82 1c dc f0 15  |.&...J..gq......|
+00000190  6d 25 f5 6e be a2 5f 45  39 dc d1 2e df fa e1 e9  |m%.n.._E9.......|
+000001a0  48 ca 7a 78 fa 0e 53 d1  5c 8f c2 40 91 d5 fa 40  |H.zx..S.\..@...@|
+000001b0  7e a1 52 23 c8 56 1f 31  17 91 5c 38 bb 54 56 f3  |~.R#.V.1..\8.TV.|
+000001c0  1e 14 90 43 b7 ef fd 56  b5 ae 13 90 97 dc 60 15  |...C...V......`.|
+000001d0  67 72 fc c2 0a 32 90 be  ec de 69 16 d3 1b 22 2c  |gr...2....i...",|
+000001e0  25 9f 91 27 a7 6d 8c a4  de 02 fd 0e da bf ca 71  |%..'.m.........q|
+000001f0  77 9b 56 b8 07 e8 80 00  9b d9 36 1c 09 4f 9f 54  |w.V.......6..O.T|
+00000200  76 d5 76 f4 9a 03 94 bb  9e 93 f0 b5 3c a1 71 ec  |v.v.........<.q.|
+00000210  b3 83 3a 06 b4 46 97 bf  ef bb f0 26 94 4e b0 08  |..:..F.....&.N..|
+00000220  3b ec 81 20 66 92 11 85  a0 c2 90 fd c5 bc ae 39  |;.. f..........9|
+00000230  2c 87 ec e4 5d 59 ee b4  e9 0d f7 2a e0 3b 2a 94  |,...]Y.....*.;*.|
+00000240  1a 79 2f e8 5c 88 d3 61  2e 47 c0 f3 c4 01 84 a9  |.y/.\..a.G......|
+00000250  cf f6 36 13 cb 4b 0b f7  9a 14 f1 d5 0e 10 80 fd  |..6..K..........|
+00000260  11 79 20 20 ae 56 5e de  58 53 19 38 26 e2 ac bc  |.y  .V^.XS.8&...|
+00000270  0c 40 38 8b f9 67 62 4c  42 7d 18 4f 27 e9 53 96  |.@8..gbLB}.O'.S.|
+00000280  78 4b fa 44 fe c2 c3 d9  99 f2 2c 59 2b 2b 2c 88  |xK.D......,Y++,.|
+00000290  5b dc a8 98 3d 17 14 09  70 ce e4 02 8b 3c 5d 94  |[...=...p....<].|
+000002a0  44 ac ba 57 2d a9 bf b8  70 e9 b8 a8 c3 b8 90 da  |D..W-...p.......|
+000002b0  ec b1 b4 57 d6 e3 0f 41  82 bb 21 4a 57 dc ac 4b  |...W...A..!JW..K|
+000002c0  89 34 75 fc c4 56 6b 70  3d 83 2b fa be c8 2b cd  |.4u..Vkp=.+...+.|
+000002d0  f8 4f 9f 9e 9a 0e d2 d0  46 cd 21 a5 f7 07 a6 2a  |.O......F.!....*|
+000002e0  85 7b 30 92 78 a2 da a5  1d 1c 1c 54 63 4b 66 b2  |.{0.x......TcKf.|
+000002f0  f1 a7 c4 43 57 97 7f 28  37 e7 15 62 9b 1c f5 90  |...CW..(7..b....|
+00000300  0c 19 36 1a c1 48 48 e5  7d 56 93 3c 13 e3 cd 6a  |..6..HH.}V.<...j|
+00000310  aa aa ba d5 24 95 c7 df  9c a9 76 6c 07 bf 09 2d  |....$.....vl...-|
+00000320  4b 7b 55 94 37 ec d4 69  ce ab 0f 48 37 74 37 99  |K{U.7..i...H7t7.|
+00000330  83 0d 60 8a 73 56 fb e2  9e 0c 39 0e 23 bf 68 b2  |..`.sV....9.#.h.|
+00000340  92 51 12 bc cf 1b af 9d  7c fe 77 14 c8 66 4a 6f  |.Q......|.w..fJo|
+00000350  91 06 55 6a 11 61 17 03  03 00 99 c2 bf 26 a6 fa  |..Uj.a.......&..|
+00000360  67 16 a3 b9 1f 36 f8 4f  5d 59 b1 be 43 3a 70 01  |g....6.O]Y..C:p.|
+00000370  c0 3a 4b c5 20 b1 22 49  04 22 bb 7f 5f f4 bb f8  |.:K. ."I.".._...|
+00000380  35 03 0e dc ba ce de 2a  25 ea 96 dd 3d 64 34 90  |5......*%...=d4.|
+00000390  30 f8 34 22 bb e4 94 00  bb b3 ea 3c d2 87 90 9a  |0.4".......<....|
+000003a0  86 76 6b b7 e3 78 fc 35  10 50 ce b6 c0 71 52 ae  |.vk..x.5.P...qR.|
+000003b0  a5 f7 bf 8c 5e 5d c1 96  c7 92 6f f0 04 87 d9 a8  |....^]....o.....|
+000003c0  72 f4 9e ed 6d ab 28 42  7c c8 60 39 81 66 74 a1  |r...m.(B|.`9.ft.|
+000003d0  79 79 6a 59 02 29 b8 14  12 34 a7 96 8f e0 c1 d6  |yyjY.)...4......|
+000003e0  4e da e2 63 22 c1 60 b1  87 64 d3 80 b9 c4 df 9a  |N..c".`..d......|
+000003f0  5f 2c 22 91 17 03 03 00  35 9a 62 4d a2 ba 27 31  |_,".....5.bM..'1|
+00000400  fc 8e 23 cc 5f f0 5c 8c  9b c1 b0 ae 7b b8 fa e2  |..#._.\.....{...|
+00000410  f3 af 6c 6c ac 86 1e e1  2b 9f 14 a1 f3 5f b5 f9  |..ll....+...._..|
+00000420  76 b6 dd 73 f5 6a 08 29  f1 29 9e 79 87 aa        |v..s.j.).).y..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 01 50 39 26 3f 21 c8  |..........P9&?!.|
-00000010  e3 65 97 00 ab 5c 99 50  0a d0 21 ff 0e a9 9f 89  |.e...\.P..!.....|
-00000020  50 e5 e5 ec 59 6a 19 82  99 b7 41 24 61 1f 3e dd  |P...Yj....A$a.>.|
-00000030  d6 a7 eb 12 1d 6f cd bc  ff ba ac 80 78 2d 43 42  |.....o......x-CB|
-00000040  a5 0b be 99 04 e4 c1 45  20 9b a1 96 a8 e2 72 a7  |.......E .....r.|
-00000050  7a 47 fe 0b c1 f6 4f 76  88 39 36 61 be f1 12 75  |zG....Ov.96a...u|
-00000060  20 e5 46 f5 0d 33 a4 57  82 aa 95 73 c6 d2 45 6a  | .F..3.W...s..Ej|
-00000070  77 a8 3c 93 13 33 84 41  b5 b7 79 15 77 e3 87 e9  |w.<..3.A..y.w...|
-00000080  54 30 08 a1 d2 12 1f b1  e0 2b 22 1c af 77 09 82  |T0.......+"..w..|
-00000090  46 e1 f6 e8 17 86 7f 4f  ba 9d f0 ba 7a 27 6a f4  |F......O....z'j.|
-000000a0  fa c6 44 c1 19 6b 66 40  cc a5 0c 14 8f b2 08 7a  |..D..kf@.......z|
-000000b0  2f 05 98 7a 1d 30 de 01  99 a9 b5 d9 f2 57 47 8a  |/..z.0.......WG.|
-000000c0  74 a6 b0 0b a7 62 49 7b  c6 81 1f 10 ac e0 8d 4e  |t....bI{.......N|
-000000d0  94 79 4f f5 56 eb 9d d2  76 31 18 6e 8e 72 e8 ba  |.yO.V...v1.n.r..|
-000000e0  80 5c 84 52 15 a0 09 67  5f f0 8a e8 7b 15 4c e7  |.\.R...g_...{.L.|
-000000f0  fe b7 99 de 7c 69 d6 74  bb 6d dd c9 7c e6 b0 02  |....|i.t.m..|...|
-00000100  32 0d ef bf c9 de 76 6d  9e 7c 9d c0 ce c4 db 33  |2.....vm.|.....3|
-00000110  28 e9 e2 ca ad b2 55 1e  4d 21 33 c5 05 fc bc e8  |(.....U.M!3.....|
-00000120  f6 93 54 ab c8 de 99 69  c1 4d 58 8c 3f bc 0d bb  |..T....i.MX.?...|
-00000130  f1 55 4d 00 38 1a 99 8c  13 6d 27 3a 63 9f 51 64  |.UM.8....m':c.Qd|
-00000140  20 b6 87 88 b8 e3 da 3d  a7 ff 38 7c c6 de 8a 88  | ......=..8|....|
-00000150  e4 b1 f1 51 37 d6 48 7b  13 25 81 17 03 03 00 59  |...Q7.H{.%.....Y|
-00000160  75 09 53 f0 4d 25 f4 9f  cd ed e6 05 34 09 f2 fc  |u.S.M%......4...|
-00000170  92 fd 58 86 b8 2e 2a 67  a3 b1 07 6c 9b 61 8e 59  |..X...*g...l.a.Y|
-00000180  ce 58 58 2b 9f fa 53 54  80 91 4c c4 e8 6a 1a bb  |.XX+..ST..L..j..|
-00000190  4a c5 76 56 cd 2d 2a 22  de ed e9 59 0f 62 18 2f  |J.vV.-*"...Y.b./|
-000001a0  46 85 fe fb 43 83 32 b0  c4 74 de a1 b6 31 ee 40  |F...C.2..t...1.@|
-000001b0  d8 ef 32 c1 3f 99 6d 1c  59 17 03 03 00 35 82 0b  |..2.?.m.Y....5..|
-000001c0  06 89 ce f6 cd e1 04 3c  63 06 97 fc c5 d5 6c 5c  |.......<c.....l\|
-000001d0  2e 66 fa 0b 95 63 50 a8  46 ba 54 3b 01 1a b8 79  |.f...cP.F.T;...y|
-000001e0  52 55 17 c8 76 93 66 d0  f0 64 1f a1 20 15 98 ee  |RU..v.f..d.. ...|
-000001f0  5f e0 73                                          |_.s|
+00000000  14 03 03 00 01 01 17 03  03 01 50 ef 68 27 d6 ec  |..........P.h'..|
+00000010  76 00 e1 c6 ed 3c f6 a1  83 b4 4b 26 28 ba 0f d6  |v....<....K&(...|
+00000020  2a fd f0 4a 10 8f 9c ed  84 3f 0a 0e 5b 77 e2 7d  |*..J.....?..[w.}|
+00000030  1e 03 2a 76 5b 2b 87 78  ad bd 45 8b 03 b3 8d e7  |..*v[+.x..E.....|
+00000040  b7 66 ca 5e 36 f8 53 87  90 3c 1a 33 46 1d 32 4f  |.f.^6.S..<.3F.2O|
+00000050  f1 90 fb 36 da 96 1c 1a  db 9f 9b e6 9f 85 f8 13  |...6............|
+00000060  7d e1 ab e1 ca c6 05 df  15 ea af dd 55 58 c7 5f  |}...........UX._|
+00000070  de 62 1b 93 60 a4 fc 39  0a ef 95 bc 0c ca 8f 84  |.b..`..9........|
+00000080  98 0a 6d 5b fd c6 0c ad  02 7f 0c f8 b4 be fe 5a  |..m[...........Z|
+00000090  fb 22 00 08 09 5d c7 47  76 89 e5 06 d1 90 5b e6  |."...].Gv.....[.|
+000000a0  63 64 06 28 37 d9 1b e9  0d 27 45 f7 72 30 d7 f2  |cd.(7....'E.r0..|
+000000b0  db 8e bf 95 97 29 43 e7  16 bf a0 59 9c fa d9 59  |.....)C....Y...Y|
+000000c0  a0 a6 9b 1f b5 74 80 87  d0 61 2f d5 a5 ac dd b2  |.....t...a/.....|
+000000d0  8d 27 fc e6 68 eb 07 b3  3d 97 a9 93 5b 35 99 e9  |.'..h...=...[5..|
+000000e0  ba 99 fe 49 d6 39 1a 0a  38 98 cd 47 b9 67 9b 9a  |...I.9..8..G.g..|
+000000f0  77 65 45 f8 48 fb d3 1c  0f a2 2e af e0 29 68 bc  |weE.H........)h.|
+00000100  81 24 3b 9b 36 0a ef 51  75 ff 61 6a d4 6c 59 42  |.$;.6..Qu.aj.lYB|
+00000110  54 31 47 e9 02 9e 58 33  9e 89 65 b6 65 db b2 81  |T1G...X3..e.e...|
+00000120  bd c1 f4 0a 34 eb f3 26  f5 8d 36 6d da 78 e6 88  |....4..&..6m.x..|
+00000130  00 8f 92 24 dc 76 e3 95  dc 13 b5 92 91 ee c0 82  |...$.v..........|
+00000140  cb 63 85 b6 59 67 dc 14  2e 2d 58 8e 56 7e 7c db  |.c..Yg...-X.V~|.|
+00000150  2f 54 01 ed 17 8d 9a 97  22 39 7f 17 03 03 00 59  |/T......"9.....Y|
+00000160  a1 f2 0d 19 e7 d8 a8 6d  cd ea f6 82 ee 5d 0a 55  |.......m.....].U|
+00000170  22 61 11 21 f7 b0 1d 86  a8 4d c2 e2 9b ac bb 87  |"a.!.....M......|
+00000180  a2 82 67 ee 78 76 9b e0  c0 00 85 bf 1e 2b ab e6  |..g.xv.......+..|
+00000190  f1 43 79 69 a0 3d 04 b7  d9 7f 31 c7 7a b7 4f 5c  |.Cyi.=....1.z.O\|
+000001a0  9f 62 84 dc f4 6d a1 ce  3d ff 24 88 15 10 4a e6  |.b...m..=.$...J.|
+000001b0  5c 12 68 08 3c 55 a2 a9  d7 17 03 03 00 35 f4 d9  |\.h.<U.......5..|
+000001c0  9f 41 70 39 d4 88 2a 0b  43 c3 78 0f c2 42 48 b8  |.Ap9..*.C.x..BH.|
+000001d0  e5 26 ad e3 72 40 66 d7  a0 5e 5e 0c 6a af 1a 47  |.&..r@f..^^.j..G|
+000001e0  c6 5f 25 ce c9 13 77 60  8f 6e a7 9f bc e3 f9 58  |._%...w`.n.....X|
+000001f0  9c 12 cc                                          |...|
 >>> Flow 4 (server to client)
-00000000  17 03 03 01 bf 86 6d ae  0b c9 d7 bc cc 6e 1a 07  |......m......n..|
-00000010  4d 58 50 d5 1a 15 5c 8a  4b de c3 83 5c d5 82 95  |MXP...\.K...\...|
-00000020  ed 24 9c 12 f7 05 7a 6b  81 dc c0 99 58 af 3e 68  |.$....zk....X.>h|
-00000030  36 0c 9c c6 84 61 36 03  58 59 d3 d4 24 ca 63 b4  |6....a6.XY..$.c.|
-00000040  fd 82 f4 d5 fa 65 4f fd  f1 0d 52 a3 3d 12 36 a7  |.....eO...R.=.6.|
-00000050  0a f6 fa a8 74 81 9a 10  72 ef d6 7b 9d fc 71 a0  |....t...r..{..q.|
-00000060  35 7a a9 dd b9 8b 34 1e  d6 e5 53 6c 62 22 d2 89  |5z....4...Slb"..|
-00000070  f6 43 33 51 76 fe 7f 65  06 d4 4d aa 74 a9 4a e6  |.C3Qv..e..M.t.J.|
-00000080  52 3c 3a ae 03 e3 a9 52  b1 0d ba 14 e5 be d1 ff  |R<:....R........|
-00000090  60 c7 66 11 5c 72 e7 46  da 8d 3c 9e 54 84 4f 70  |`.f.\r.F..<.T.Op|
-000000a0  7b 40 36 f5 33 5d 0b b0  09 74 cf 60 db 3f 40 1d  |{@6.3]...t.`.?@.|
-000000b0  4a 9e c4 a8 24 ef e0 af  49 89 4e 06 68 1a 56 d9  |J...$...I.N.h.V.|
-000000c0  31 f7 f4 66 5b 18 00 af  b6 01 91 79 cf 14 08 cd  |1..f[......y....|
-000000d0  2d a2 b8 82 89 a9 62 9e  a7 84 c2 3d 15 fd 9a 33  |-.....b....=...3|
-000000e0  12 2d 6c e3 c9 83 7c cf  b1 fb 7a a3 48 c6 ce 62  |.-l...|...z.H..b|
-000000f0  1f 83 0b f2 b9 b9 36 55  56 5c ca 5e 96 fa d4 06  |......6UV\.^....|
-00000100  f3 ba 09 c5 44 df ce 14  ce d8 35 8c 0f fe e4 fd  |....D.....5.....|
-00000110  bf ce 9e c5 8b 12 0c 94  64 13 4e b7 62 0d ba 62  |........d.N.b..b|
-00000120  ff 2c f6 55 f3 23 48 a5  9a a2 e5 f4 b5 16 3a 10  |.,.U.#H.......:.|
-00000130  08 90 e6 1e 24 55 eb 56  64 18 3c d4 e7 5d b6 41  |....$U.Vd.<..].A|
-00000140  a3 69 e8 06 a0 a2 13 92  84 c4 79 fd a1 22 a8 a2  |.i........y.."..|
-00000150  1e d4 b1 d3 33 61 87 97  6d 82 f0 cb b4 c0 02 76  |....3a..m......v|
-00000160  49 6e 0b 1c 6f 02 57 40  da be 2d c2 67 46 60 c3  |In..o.W@..-.gF`.|
-00000170  9f bc fb d5 2f e0 09 bf  ed 7a 2b c1 74 8f ea 2c  |..../....z+.t..,|
-00000180  2b 8b d7 dd 23 e7 85 7c  4f cc f6 36 ee 13 2b 3c  |+...#..|O..6..+<|
-00000190  0a 8f 96 61 33 b2 65 3a  73 6a 46 a5 55 73 47 57  |...a3.e:sjF.UsGW|
-000001a0  05 f4 73 65 1e 2a 56 e9  e2 a1 00 f7 88 8a f0 9d  |..se.*V.........|
-000001b0  2f c9 98 c2 19 9e 7e 4a  a4 f2 43 0f 4a 61 8d e4  |/.....~J..C.Ja..|
-000001c0  87 82 42 f8 17 03 03 00  1e ea fb cd 51 7d 28 30  |..B.........Q}(0|
-000001d0  71 79 ba 81 d1 48 0b 8b  54 d7 c6 5e 82 f7 30 b2  |qy...H..T..^..0.|
-000001e0  37 a6 16 56 fb 8d 12 17  03 03 00 13 8a 90 f9 9e  |7..V............|
-000001f0  9c d5 77 53 f0 48 6f 72  ae b3 1c 58 89 1d 66     |..wS.Hor...X..f|
+00000000  17 03 03 01 c2 80 69 97  9a 20 30 2a 1c f4 31 f9  |......i.. 0*..1.|
+00000010  0f cf f7 79 c0 01 e1 f3  35 f5 16 a0 33 d6 eb 21  |...y....5...3..!|
+00000020  44 db bc c6 c4 91 6b a6  75 da ca d3 63 78 47 8b  |D.....k.u...cxG.|
+00000030  96 e5 6f 63 2c 77 c0 33  29 d8 3e ee bf 8e 6b d4  |..oc,w.3).>...k.|
+00000040  de f7 1b 0e e6 ae ce cd  17 0d 24 77 10 3d e4 89  |..........$w.=..|
+00000050  06 07 a3 77 68 ac 20 ec  0b ae 47 41 3b 80 4e 95  |...wh. ...GA;.N.|
+00000060  02 aa 13 36 19 03 06 1c  47 b3 f7 f0 4b 6d 5a c6  |...6....G...KmZ.|
+00000070  42 14 95 03 20 c7 46 96  42 d3 18 5a 40 bd a1 03  |B... .F.B..Z@...|
+00000080  b6 d2 8b f9 ff 2d d1 b1  3c 8a 34 af 23 64 31 7d  |.....-..<.4.#d1}|
+00000090  46 47 21 b4 82 16 df a2  a4 0f 96 03 4b 38 3d 5d  |FG!.........K8=]|
+000000a0  d0 d1 78 d1 6e 6a a2 95  c0 a7 e6 ee 07 eb 77 68  |..x.nj........wh|
+000000b0  35 78 72 3e df d9 4b e9  1b ab 34 99 2d fe 52 99  |5xr>..K...4.-.R.|
+000000c0  6e 57 63 13 39 ae 5e ce  b6 43 21 07 fd fe b7 6d  |nWc.9.^..C!....m|
+000000d0  8f 72 a4 f8 7e 0a 56 60  61 d5 5a d4 01 b3 47 8e  |.r..~.V`a.Z...G.|
+000000e0  f0 48 cd 85 61 a3 d2 d1  eb ba 04 39 6b 5e 5f fc  |.H..a......9k^_.|
+000000f0  e3 90 c1 cb 3f 40 30 00  5c 94 df bf 5b 89 6d ab  |....?@0.\...[.m.|
+00000100  15 1e 72 50 ac 56 ee 16  7d 84 4c e6 0c 89 68 fa  |..rP.V..}.L...h.|
+00000110  d5 8d 5f 09 85 25 5f 8c  70 df 0b b7 94 15 40 20  |.._..%_.p.....@ |
+00000120  b1 ff 41 50 5d 9f c6 8a  9b 7f 40 6f dc bd 4f 54  |..AP].....@o..OT|
+00000130  d8 1f e6 f1 44 00 11 97  45 ca 80 bc 15 eb 93 01  |....D...E.......|
+00000140  dd 54 c6 75 7e 08 b9 38  f5 4d 97 c5 50 56 97 3c  |.T.u~..8.M..PV.<|
+00000150  3c 72 9a 33 7c 68 b1 73  2b 38 c7 b8 a8 3c 5d af  |<r.3|h.s+8...<].|
+00000160  a6 3e 12 ef d1 c1 99 36  10 02 af 0c 5b 16 16 7a  |.>.....6....[..z|
+00000170  f5 74 8d ac a4 0f 38 34  ee cd 08 50 e0 33 b0 e1  |.t....84...P.3..|
+00000180  52 e1 5d f2 7d c6 7b 64  c7 46 f6 9e d0 a2 cf 89  |R.].}.{d.F......|
+00000190  3c c9 ab 2f fb 8a f3 ba  78 e9 4c c5 2d 62 32 6b  |<../....x.L.-b2k|
+000001a0  50 4c a0 7e d3 bb 2a 66  57 99 38 69 e8 77 ef 18  |PL.~..*fW.8i.w..|
+000001b0  24 af b3 cb e5 c0 37 a2  97 f6 00 d4 68 8a 71 af  |$.....7.....h.q.|
+000001c0  24 a4 ab 19 07 3b c0 17  03 03 00 1e 60 b4 fc 15  |$....;......`...|
+000001d0  f9 9c b1 a1 60 1a ba f5  1b b9 c1 33 f1 8b e5 c0  |....`......3....|
+000001e0  48 77 4f 11 42 21 ad 8c  d2 d6 17 03 03 00 13 5c  |HwO.B!.........\|
+000001f0  db 07 5e 65 40 58 74 a4  7f ab 5f cc f0 9a 91 0c  |..^e@Xt..._.....|
+00000200  17 3d                                             |.=|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndGiven b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndGiven
index 88562c7676..8ba88ebf3f 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndGiven
+++ b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedAndGiven
@@ -1,176 +1,177 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 12 f6 c1 74 9d  |..............t.|
-00000010  95 3e ce 1e 1b 6b f1 b6  ca ad 92 7f bf be 77 14  |.>...k........w.|
-00000020  0b 19 61 bd b3 36 53 d9  7a 26 2d 20 c2 f5 69 6b  |..a..6S.z&- ..ik|
-00000030  4a e0 99 ed 41 bf 8e 13  be e2 27 4e 47 6f 23 f3  |J...A.....'NGo#.|
-00000040  f7 8a 8e 75 91 08 6f a9  ba ed da dd 00 04 13 01  |...u..o.........|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 56 2e 3c 64 35  |...........V.<d5|
+00000010  b8 7d db 8a 3c f0 93 73  0f 64 8d 84 da b6 59 37  |.}..<..s.d....Y7|
+00000020  22 99 3f 69 16 56 16 39  a2 a9 58 20 7c d3 26 20  |".?i.V.9..X |.& |
+00000030  a0 dc e9 7a 07 71 02 2d  3b 27 85 16 fb 6e 26 e5  |...z.q.-;'...n&.|
+00000040  c3 67 e5 0b bd e5 50 8f  bd 39 6f 2c 00 04 13 01  |.g....P..9o,....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 02  |-.....3.&.$... .|
-000000b0  70 47 c1 8a f4 c2 0d dd  c9 c8 21 ef b8 03 07 f4  |pG........!.....|
-000000c0  7d cf d1 d3 12 69 f3 87  0f a1 9a c7 10 16 7f     |}....i.........|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 f6  |-.....3.&.$... .|
+000000b0  96 06 42 18 9d ae a6 49  01 d1 a5 d3 ee c7 5a ed  |..B....I......Z.|
+000000c0  26 20 c7 d5 e8 3c 58 21  1b 17 28 ea f9 e3 45     |& ...<X!..(...E|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 c2 f5 69 6b  |........... ..ik|
-00000030  4a e0 99 ed 41 bf 8e 13  be e2 27 4e 47 6f 23 f3  |J...A.....'NGo#.|
-00000040  f7 8a 8e 75 91 08 6f a9  ba ed da dd 13 01 00 00  |...u..o.........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 7c d3 26 20  |........... |.& |
+00000030  a0 dc e9 7a 07 71 02 2d  3b 27 85 16 fb 6e 26 e5  |...z.q.-;'...n&.|
+00000040  c3 67 e5 0b bd e5 50 8f  bd 39 6f 2c 13 01 00 00  |.g....P..9o,....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 f7 25 d5 70 bd 01  |...........%.p..|
-00000090  8b 45 ae 7b ac 0e 0b 5c  d7 1b e2 42 7c 8f 49 e3  |.E.{...\...B|.I.|
-000000a0  cf 17 03 03 00 3e 3e c0  a8 0b 56 dd 1a b7 37 4c  |.....>>...V...7L|
-000000b0  31 a0 ba d7 3d 0b b6 98  7a aa 4b d9 6f 08 1d 33  |1...=...z.K.o..3|
-000000c0  9f 48 3a f8 9c 21 b7 da  49 26 15 5d 73 32 25 33  |.H:..!..I&.]s2%3|
-000000d0  0f 42 9d 6d 51 51 12 20  00 81 d6 09 3f 64 87 75  |.B.mQQ. ....?d.u|
-000000e0  99 2c 75 4d 17 03 03 02  6d 80 c5 73 16 7f d8 89  |.,uM....m..s....|
-000000f0  61 d8 f0 6f 81 86 61 77  bc bc 7e b9 bd 06 5f 58  |a..o..aw..~..._X|
-00000100  dc ca 9e 98 43 8f 6b eb  7a 28 e1 a4 61 a1 ad 1e  |....C.k.z(..a...|
-00000110  bd cc ab 0f f5 fc cb 50  a5 58 b8 f6 ce 63 8b a7  |.......P.X...c..|
-00000120  9b 71 91 cd 1d 68 11 dd  54 ad 1b 69 6f a8 43 29  |.q...h..T..io.C)|
-00000130  88 8d 6d 37 9f de 20 af  d3 9a 3a 42 ce e5 86 f1  |..m7.. ...:B....|
-00000140  43 4d 38 fd 22 fd 5c 32  bf e7 0f f9 e2 1a c7 da  |CM8.".\2........|
-00000150  05 a3 17 29 51 96 37 93  0b 9e 8c 94 cc d3 50 39  |...)Q.7.......P9|
-00000160  2a 3a 93 a8 09 7d a7 99  06 d8 af e5 d2 a1 1e b0  |*:...}..........|
-00000170  6c 3c 19 f0 4a 9a aa fa  25 4c 72 bf f7 52 fd 8d  |l<..J...%Lr..R..|
-00000180  f9 36 c1 76 15 22 8c cc  17 42 22 48 96 b3 6f 76  |.6.v."...B"H..ov|
-00000190  ae a8 8d 65 0a ab 1d ce  bd 86 4d 02 32 13 67 ff  |...e......M.2.g.|
-000001a0  10 78 c5 97 5c 73 fb c1  a5 de fb ae 34 ff 1e fa  |.x..\s......4...|
-000001b0  e0 62 a9 df 49 c0 24 35  06 79 69 24 69 52 c8 93  |.b..I.$5.yi$iR..|
-000001c0  e7 aa 9c 7d a7 00 64 67  b2 2e 5f 6b 3e cb b0 29  |...}..dg.._k>..)|
-000001d0  cc 3f 33 da 7b e7 c8 f4  11 74 e5 4b 72 7d 64 92  |.?3.{....t.Kr}d.|
-000001e0  c6 6b 62 5f a9 de 2b d1  63 1d f5 16 dc 72 a5 24  |.kb_..+.c....r.$|
-000001f0  d2 63 32 0a 2e e2 6e 35  76 c2 58 4f 8c ef e8 72  |.c2...n5v.XO...r|
-00000200  cf ba e9 e9 81 1e 35 9c  3a 0e 0a 76 59 f4 0a 3d  |......5.:..vY..=|
-00000210  4f 06 b6 25 7f be 27 61  62 aa a7 ac 1d 6f 8f 27  |O..%..'ab....o.'|
-00000220  c8 66 35 17 85 55 ff 2e  81 00 82 75 b6 92 0a 93  |.f5..U.....u....|
-00000230  8b ad 8f e9 81 ff 3c 44  53 0b 74 0d 3e e9 8f 94  |......<DS.t.>...|
-00000240  8e e1 66 06 db f2 03 bd  04 14 80 57 45 54 08 70  |..f........WET.p|
-00000250  4f 9a 68 a0 25 7c df a6  15 3f 4c 4d 3a 7f 5b 5a  |O.h.%|...?LM:.[Z|
-00000260  9f dc 7d 07 dd 49 3f 19  54 41 1b 2f 11 9f 36 a0  |..}..I?.TA./..6.|
-00000270  d1 42 b1 08 8f 39 59 b7  f5 7e bb db b3 5a f1 5d  |.B...9Y..~...Z.]|
-00000280  20 97 26 e7 b9 98 55 06  32 11 c4 fc 97 0c 7d ee  | .&...U.2.....}.|
-00000290  f2 f7 56 bf 16 5c bf 1d  d6 3b 1e 09 7d 25 96 c5  |..V..\...;..}%..|
-000002a0  ef d8 e7 7a f2 92 a9 f1  2b db a4 55 4a 4b b8 37  |...z....+..UJK.7|
-000002b0  2b aa 8e 83 03 32 be 8a  1d fb d3 e7 e2 6c a8 df  |+....2.......l..|
-000002c0  ed 27 c5 e7 14 de 1e 89  44 48 e2 9c 0c 9b 4b f4  |.'......DH....K.|
-000002d0  05 e5 cd ad d6 97 34 22  a9 14 33 e3 34 c6 af b4  |......4"..3.4...|
-000002e0  29 96 2a b0 21 84 24 c0  55 43 61 74 7f 7b e5 dc  |).*.!.$.UCat.{..|
-000002f0  65 00 bc fe c7 72 d2 4e  5a 18 0f 05 3b 46 75 a8  |e....r.NZ...;Fu.|
-00000300  83 38 33 4a 4b ae 69 87  78 2f 8f 4a 69 ed 76 06  |.83JK.i.x/.Ji.v.|
-00000310  ef cd 0a 30 d9 b4 36 3f  c9 f9 e3 f0 d1 dd 53 bf  |...0..6?......S.|
-00000320  ba ff be 50 4b 61 bc 1d  b5 af 2d e7 dc ea 18 bc  |...PKa....-.....|
-00000330  48 2e a1 d8 6c d4 5f 2a  ed 26 c3 6f fd d8 3d e5  |H...l._*.&.o..=.|
-00000340  9d e1 85 09 4e db 99 c9  57 86 ea 0e 80 a4 4a 63  |....N...W.....Jc|
-00000350  68 20 70 17 07 96 17 03  03 00 99 25 58 aa ea 24  |h p........%X..$|
-00000360  05 9b 3e bf a0 cd a1 54  51 14 22 0f ee ca a5 d3  |..>....TQ.".....|
-00000370  f2 21 0c b7 4b a7 99 0a  7f c5 ee cc d4 40 31 af  |.!..K........@1.|
-00000380  a8 3d 50 fb 20 c6 c5 71  4f 1a 20 4f 6b 00 c4 8d  |.=P. ..qO. Ok...|
-00000390  4d dc af e9 21 f8 7b 4e  da 6f 78 96 6c 02 5f e7  |M...!.{N.ox.l._.|
-000003a0  35 6a 91 f8 fd 66 b0 ef  cf a0 6b b8 fc 7b 52 e5  |5j...f....k..{R.|
-000003b0  d3 10 ec 95 11 f7 fd 2c  4b ab 48 50 1b 8b 37 6c  |.......,K.HP..7l|
-000003c0  f2 b6 e1 ae ad 89 42 8f  a3 64 7a fe 83 64 93 7c  |......B..dz..d.||
-000003d0  41 08 42 f8 ff df 02 c4  b8 40 a3 66 4a 82 3d 89  |A.B......@.fJ.=.|
-000003e0  28 27 7f 82 39 bc b3 bd  a7 01 4b 6f ee 6c 15 3e  |('..9.....Ko.l.>|
-000003f0  c6 a4 ff 95 17 03 03 00  35 e0 a7 83 9a 4c a8 62  |........5....L.b|
-00000400  3d 41 83 a1 dc de f1 2b  89 a7 db 56 7e cd ae f5  |=A.....+...V~...|
-00000410  e8 ee 5b 87 9e 8b 2f f5  d9 53 83 56 7e 3b ab 7b  |..[.../..S.V~;.{|
-00000420  fd 34 44 a6 45 cd 13 1b  d1 84 bf d7 71 f8        |.4D.E.......q.|
+00000080  03 03 00 01 01 17 03 03  00 17 43 8e 41 a4 04 13  |..........C.A...|
+00000090  01 08 9f 6e 1a fd 00 68  38 5c 93 d9 9a f7 1e 36  |...n...h8\.....6|
+000000a0  ea 17 03 03 00 3e 9f ae  80 ef f4 20 66 e7 44 fc  |.....>..... f.D.|
+000000b0  4d a4 3f 0e dc bb 33 47  0f 13 96 fa 03 07 d6 6f  |M.?...3G.......o|
+000000c0  cc 9f 3c fd 01 f5 87 d9  ec c9 d0 fc dd bf c8 5c  |..<............\|
+000000d0  0b 3d aa a7 c6 1d 90 18  d9 a1 1a a0 a1 ea 49 32  |.=............I2|
+000000e0  9e 45 86 f7 17 03 03 02  6d 61 29 fe 45 7e 5c b3  |.E......ma).E~\.|
+000000f0  8a 73 f2 65 c1 90 4e 93  0d 84 b2 bd e4 46 93 c2  |.s.e..N......F..|
+00000100  52 3f 07 38 e7 23 db 25  5e 71 98 a9 7d fd e9 ef  |R?.8.#.%^q..}...|
+00000110  3f 2c d8 9c ae 41 c4 d3  c7 9e d5 6e f0 0c 33 78  |?,...A.....n..3x|
+00000120  98 cf bf 22 3d 1f d0 f3  c8 a2 34 e8 ce 5e 0d 37  |..."=.....4..^.7|
+00000130  52 e2 b8 e3 50 ea 35 3e  e5 59 a0 6d ed 9e 09 36  |R...P.5>.Y.m...6|
+00000140  59 20 33 08 a9 41 f4 72  aa 2d 0c b5 d6 96 d9 04  |Y 3..A.r.-......|
+00000150  1a f1 d8 45 ed 67 ab f9  15 fa 25 ef 6d 87 72 ad  |...E.g....%.m.r.|
+00000160  f0 06 59 a5 8e 61 80 8b  28 f9 a0 df 5b b2 a2 3a  |..Y..a..(...[..:|
+00000170  1c 91 43 18 f4 a2 f3 4e  db dc 24 1b c3 0e 77 22  |..C....N..$...w"|
+00000180  83 ae 88 9f 8e 8d 48 38  f4 60 51 42 fa f2 a4 de  |......H8.`QB....|
+00000190  33 78 35 d0 b6 01 3d 7a  f5 54 68 51 fd 0e 4c 9b  |3x5...=z.ThQ..L.|
+000001a0  92 7c a5 01 96 52 7e de  38 b9 b0 ee 60 1e aa eb  |.|...R~.8...`...|
+000001b0  8c e6 b4 f4 7c 35 d2 0b  9b 83 94 ac ac ce 7e 58  |....|5........~X|
+000001c0  51 6e c3 ae 3b cd f5 85  8a 1e 43 78 19 ee dc a1  |Qn..;.....Cx....|
+000001d0  a3 d0 93 24 0d 3b 6a 4b  cd dc 78 9c 0b 2f bc 41  |...$.;jK..x../.A|
+000001e0  46 2f 64 3c 23 95 04 8b  60 75 bf 4d 45 3b e4 1e  |F/d<#...`u.ME;..|
+000001f0  9c 5b 1a 46 bb f3 4d a9  1b 59 33 b4 40 78 bd ff  |.[.F..M..Y3.@x..|
+00000200  30 7d d4 cc 5e 83 03 de  8d a3 a6 27 b4 bc 12 6e  |0}..^......'...n|
+00000210  5e f2 88 e8 b6 60 f3 01  e8 4a 53 c7 a9 fc a1 cc  |^....`...JS.....|
+00000220  27 45 c1 06 90 38 9a fb  1b 2a 9e ed 9e f6 19 85  |'E...8...*......|
+00000230  dd f7 8a 7f 95 08 3a 25  c0 5b 63 96 44 71 c2 16  |......:%.[c.Dq..|
+00000240  9c e1 10 69 e5 6a 5c 4a  e8 2a ed 6f bd de f5 98  |...i.j\J.*.o....|
+00000250  c0 a0 c5 54 7c cc 06 11  b2 54 1a c3 b4 46 c2 b4  |...T|....T...F..|
+00000260  97 d8 9c 7d f1 f3 d4 6f  3c a0 ef 18 c5 a6 e9 13  |...}...o<.......|
+00000270  e9 f4 9d bf 9b 25 a2 da  c6 ba 7a 6d 91 fd 41 a4  |.....%....zm..A.|
+00000280  e8 88 e3 79 2c 99 df 4d  21 48 89 57 5a bf 2a 2d  |...y,..M!H.WZ.*-|
+00000290  72 4e 1e 3a e8 c9 82 7b  c0 ff 6b 7c e8 8f 41 bf  |rN.:...{..k|..A.|
+000002a0  83 19 9e 96 d1 3f 2b 60  8f 7f 0b f8 6c 70 82 dd  |.....?+`....lp..|
+000002b0  34 da 91 62 17 20 e9 99  2e e2 a9 9a 9d fd 5d f8  |4..b. ........].|
+000002c0  a5 c0 ac e8 a3 df 11 b5  df 2c bd e1 e8 0f 7e 0a  |.........,....~.|
+000002d0  f2 47 4c 92 33 7b 6b 49  e5 30 31 8b 2e 16 81 3e  |.GL.3{kI.01....>|
+000002e0  79 25 f7 d7 d2 8f 5e e6  e3 2d ed 0d e1 08 97 13  |y%....^..-......|
+000002f0  f3 ce 7d b1 36 0d 7c b0  4f 23 6b 12 ef 3a a4 8b  |..}.6.|.O#k..:..|
+00000300  b5 d0 c9 ee 48 77 70 28  61 ff ad 49 f6 48 4c 37  |....Hwp(a..I.HL7|
+00000310  7b 00 c4 01 5d 8b 54 bc  44 5c 5f 98 6f 7d 84 84  |{...].T.D\_.o}..|
+00000320  c8 d0 55 88 f9 17 f6 02  f1 84 b6 3c 1a 03 e8 7b  |..U........<...{|
+00000330  b9 4e 24 c6 d8 0a f6 8c  b9 49 c6 10 38 53 e1 10  |.N$......I..8S..|
+00000340  8f 91 cd 39 9a 3a e8 c7  10 f3 c3 91 84 3c 8c a6  |...9.:.......<..|
+00000350  55 ab f4 f5 ab e7 17 03  03 00 99 e5 40 f6 35 34  |U...........@.54|
+00000360  2d 42 3e 7f e1 51 26 56  50 4e 60 b0 2f 65 e3 cd  |-B>..Q&VPN`./e..|
+00000370  c7 08 0e 96 77 08 c7 f6  4f e6 70 90 bc 80 95 e7  |....w...O.p.....|
+00000380  b2 df 98 83 94 4d 9e 5c  8a af d3 45 da e9 d7 fa  |.....M.\...E....|
+00000390  d8 d2 60 f8 b1 06 d9 27  64 45 4d e8 d3 07 8a bb  |..`....'dEM.....|
+000003a0  72 7a c6 71 00 7e 8b b0  2b 7d d0 f7 ab 1a bf d2  |rz.q.~..+}......|
+000003b0  50 be a9 3a 0c 68 b8 48  9a 91 ee db 26 4d d3 66  |P..:.h.H....&M.f|
+000003c0  5b 00 ef c3 cc b8 f2 4e  1e 51 c7 9b 34 3c e3 01  |[......N.Q..4<..|
+000003d0  7f 75 4e 41 e4 56 34 ec  14 92 0f 1e 6d dd 51 9a  |.uNA.V4.....m.Q.|
+000003e0  e0 8b 33 54 df 77 1f ff  d3 72 67 4c 62 16 b7 f8  |..3T.w...rgLb...|
+000003f0  4f 8f f8 ee 17 03 03 00  35 b7 83 d2 27 a3 15 f2  |O.......5...'...|
+00000400  75 55 aa 06 8c 5f c4 fa  0f 43 88 c9 c5 e3 c7 36  |uU..._...C.....6|
+00000410  40 6b 35 0b 7e 60 a1 1e  48 ef 46 2c d6 e4 48 80  |@k5.~`..H.F,..H.|
+00000420  91 b0 e5 3b c0 58 5d fe  5d bd 0a 6c 19 ea        |...;.X].]..l..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 02 11 a4 32 6c e7 2d  |............2l.-|
-00000010  50 62 d1 7e 36 97 a5 b3  d7 5d d8 52 fa 24 34 f4  |Pb.~6....].R.$4.|
-00000020  ea ca d4 02 26 73 40 7d  dc 9f da 31 d0 2c 70 3e  |....&s@}...1.,p>|
-00000030  be 8e df 49 3e 35 f7 cc  7b 1a 60 46 0b aa fc e2  |...I>5..{.`F....|
-00000040  e9 7b ff 3c 87 08 73 db  bc 49 8e 1f 8b 8c 4e 6f  |.{.<..s..I....No|
-00000050  4a a3 9e 22 3e ba 2d bb  52 db a6 39 ce 27 e0 e9  |J..">.-.R..9.'..|
-00000060  4c f0 5a 3c 61 b4 bc d3  bb 91 97 25 0a 62 5f e6  |L.Z<a......%.b_.|
-00000070  5e 4a ac aa 17 3f 33 f0  69 8f 67 9a d0 6c 0a 34  |^J...?3.i.g..l.4|
-00000080  ea cf cf 25 18 4a 52 60  b1 bb b9 9b bb 48 7f e0  |...%.JR`.....H..|
-00000090  2b 50 b4 f6 10 6e ac b0  31 9a 6d 39 49 21 d9 82  |+P...n..1.m9I!..|
-000000a0  28 d4 bd 0c d0 62 8b 20  c4 fa de 73 86 56 b4 97  |(....b. ...s.V..|
-000000b0  e5 f5 ad 77 1d 58 b9 60  0d 0e 79 87 89 5a 15 64  |...w.X.`..y..Z.d|
-000000c0  1c 88 44 5d 48 04 80 de  56 a4 ca 9e 1b d8 b4 ab  |..D]H...V.......|
-000000d0  cf 8a e2 5b 5f 55 e5 72  db f6 96 dd ea aa ae 6f  |...[_U.r.......o|
-000000e0  0f 98 86 1a b4 ca e1 b5  e5 6c 9c ab 85 c6 2a 7c  |.........l....*||
-000000f0  e0 7f 66 e4 f3 e3 44 01  bb 60 a6 7f 91 dd a0 a1  |..f...D..`......|
-00000100  b2 0f b5 d6 d1 d0 7e d9  37 93 3a 6b a5 28 13 db  |......~.7.:k.(..|
-00000110  64 95 63 0c c9 a2 d5 66  55 65 fc 09 c4 77 a1 b4  |d.c....fUe...w..|
-00000120  10 26 c9 39 76 51 cc 90  ac 24 9a 19 7b 4a c6 b7  |.&.9vQ...$..{J..|
-00000130  00 43 61 e7 91 a2 62 2a  55 48 cb 93 6d 3a 26 59  |.Ca...b*UH..m:&Y|
-00000140  be 0e 96 4f 13 66 0c ba  5e 9f 24 0b 6d 4e b4 f3  |...O.f..^.$.mN..|
-00000150  d0 1f 72 ea 9d 5b 08 d7  3b 6a 7e 16 96 43 5a 62  |..r..[..;j~..CZb|
-00000160  3e 30 e8 09 13 a3 0b 23  eb ac b3 0b d0 81 0d f7  |>0.....#........|
-00000170  e2 12 75 8d 1a 2b d1 15  e2 c4 05 77 11 55 7f 7e  |..u..+.....w.U.~|
-00000180  f5 54 19 22 86 0a e4 f8  a9 16 e7 30 b1 e0 c6 04  |.T.".......0....|
-00000190  08 5a 70 84 72 8e 2f a6  92 6c ed cd 32 34 5c 54  |.Zp.r./..l..24\T|
-000001a0  6e 2d e9 1a b7 c8 fb 31  00 3d b5 6c c4 1f 80 67  |n-.....1.=.l...g|
-000001b0  4b 8b 32 c1 28 8e fd 5a  56 03 71 c3 c3 49 52 81  |K.2.(..ZV.q..IR.|
-000001c0  ae 0a 06 e8 8c cd ba 55  3f 65 b8 03 ef d1 16 30  |.......U?e.....0|
-000001d0  ea d5 c2 31 65 ea b0 fb  b5 51 d3 49 0d 48 82 33  |...1e....Q.I.H.3|
-000001e0  db e9 f9 cc a7 85 d5 f1  92 a2 3a 7d 49 cd 8d 22  |..........:}I.."|
-000001f0  e0 25 28 97 ea 18 29 ed  54 d8 90 d1 e5 48 a2 7a  |.%(...).T....H.z|
-00000200  e4 b4 61 3f e3 df 1a 19  72 ed 85 4b e6 c5 6c 68  |..a?....r..K..lh|
-00000210  c6 72 6b cf 15 e0 25 d4  fc a1 d0 0b 17 03 03 00  |.rk...%.........|
-00000220  99 6d a3 1a d5 13 42 30  88 47 5d cb 3f 6e 23 63  |.m....B0.G].?n#c|
-00000230  ba d4 46 4f 5c 80 0c bb  ef 95 97 60 36 5c 15 b1  |..FO\......`6\..|
-00000240  d8 f0 2d 4c 3f 96 56 74  54 56 b8 0a 3c 88 5f f1  |..-L?.VtTV..<._.|
-00000250  f7 3e 8a 86 03 9c 22 e7  e8 40 f9 7e 4d 69 e7 09  |.>...."..@.~Mi..|
-00000260  ea b4 36 6e f6 68 3c 2a  08 c2 cd 61 ca 9b 2b 05  |..6n.h<*...a..+.|
-00000270  82 03 61 31 cf 5d 73 df  ea 8f eb 99 d7 1a 97 ec  |..a1.]s.........|
-00000280  74 e0 f1 e8 32 d9 4a d2  b6 b1 38 fa 2f 67 50 e8  |t...2.J...8./gP.|
-00000290  ed 04 6e ba eb d3 5f e3  2b 2b c0 a7 ae 2a bd f1  |..n..._.++...*..|
-000002a0  82 ea 66 5b 8f 64 63 af  94 0c aa e2 6a 55 91 06  |..f[.dc.....jU..|
-000002b0  4a cd fa cc 43 5f e8 0b  01 31 17 03 03 00 35 b6  |J...C_...1....5.|
-000002c0  9e f9 f7 8e fe af 2c 35  01 3e e6 b6 2e 63 57 0e  |......,5.>...cW.|
-000002d0  eb 98 7e 7e ad c5 43 2c  57 ec 37 a1 e5 a8 aa 4f  |..~~..C,W.7....O|
-000002e0  e5 55 44 39 82 26 42 ac  57 a5 95 9f df 75 c3 6a  |.UD9.&B.W....u.j|
-000002f0  41 2f 15 49                                       |A/.I|
+00000000  14 03 03 00 01 01 17 03  03 02 11 9e 9e cf 44 84  |..............D.|
+00000010  df e7 23 47 2d 4e 85 fa  f2 02 2a 79 4d 3a 3d df  |..#G-N....*yM:=.|
+00000020  48 95 2e d7 0d 3c d0 05  fc bf bb 23 0a 25 59 76  |H....<.....#.%Yv|
+00000030  fd 04 f8 f0 81 88 85 9f  99 f0 55 91 9a 79 8a 39  |..........U..y.9|
+00000040  f4 6e 49 92 be ed 1d d1  20 19 77 bc 55 9b b0 da  |.nI..... .w.U...|
+00000050  d1 c4 9f b5 2f 5c 1a 60  38 e1 92 9b f9 a1 97 6b  |..../\.`8......k|
+00000060  1b d0 d0 d0 05 7a 41 26  d4 6b 12 a0 b3 c6 33 13  |.....zA&.k....3.|
+00000070  4f 74 10 d6 91 fb b0 69  46 46 ca de 7c 05 d6 62  |Ot.....iFF..|..b|
+00000080  51 23 12 58 00 ff 25 8e  c8 5f 54 85 f4 2f e9 f9  |Q#.X..%.._T../..|
+00000090  f1 1e 32 b9 f1 a6 fb 90  9b a9 65 d2 c9 ea a7 1a  |..2.......e.....|
+000000a0  e8 c9 a8 bb 7e 3d 3f 03  62 fc f4 06 a4 a2 f7 41  |....~=?.b......A|
+000000b0  60 f5 f1 df 3e d6 31 51  f4 dc b1 d3 60 4b 84 4f  |`...>.1Q....`K.O|
+000000c0  99 e2 9f b2 f0 d5 fd b2  f3 5c 24 5f 91 a6 94 cd  |.........\$_....|
+000000d0  37 61 91 4e cc ae cd c1  b5 cc 58 5f 9a 91 a1 13  |7a.N......X_....|
+000000e0  23 42 8a c5 27 4c 66 32  69 9c 75 9f 2a ed 73 1d  |#B..'Lf2i.u.*.s.|
+000000f0  29 2e 36 50 34 b4 80 d2  08 e6 9f c6 3e da df 9f  |).6P4.......>...|
+00000100  e0 2a 08 88 47 b6 d3 ff  f7 6c 6c 91 1a 8e 53 89  |.*..G....ll...S.|
+00000110  53 6c b8 d7 83 37 ab 03  59 e6 4f 41 42 af d4 f9  |Sl...7..Y.OAB...|
+00000120  ac 9d ae d1 77 f1 71 79  a0 16 c4 c7 b5 a6 a9 9f  |....w.qy........|
+00000130  59 da 55 fb c5 88 8c 13  04 c2 06 39 8f ae 7e ca  |Y.U........9..~.|
+00000140  99 ce cd aa 86 0a 00 bd  56 f1 98 d9 c8 d2 c1 c0  |........V.......|
+00000150  df 16 c2 6f 78 da 66 3f  cc 43 c7 38 33 1b 3b 5b  |...ox.f?.C.83.;[|
+00000160  f8 7e d8 b7 ef 4c 6d c7  f6 84 56 8d 76 f7 0d 83  |.~...Lm...V.v...|
+00000170  94 e6 ad c5 f3 05 5c f4  17 69 d5 83 98 c3 43 8e  |......\..i....C.|
+00000180  9f a5 5c 7b 12 ea f4 1f  39 ce 0d 83 15 b1 e6 ce  |..\{....9.......|
+00000190  c1 35 9b 8c ec c6 d2 d7  f9 02 36 90 24 f4 3a 70  |.5........6.$.:p|
+000001a0  ce bb 8d bb 4b b2 aa 64  f0 b5 c0 88 cc 06 e3 9c  |....K..d........|
+000001b0  f7 70 64 fd 5d 48 f5 c8  07 48 c2 09 c4 07 56 b9  |.pd.]H...H....V.|
+000001c0  86 e9 d6 7b dc ac a5 00  2c 1d 80 8f 47 f2 c4 c7  |...{....,...G...|
+000001d0  ab dc 7b 41 7b 3d 47 db  09 12 02 9f 1b 63 e7 cc  |..{A{=G......c..|
+000001e0  38 1d 33 56 e0 ae 63 7a  95 73 5f e6 da 13 53 49  |8.3V..cz.s_...SI|
+000001f0  5f 69 e9 ff 86 26 bd 9a  dd be 5c 75 e7 69 66 b4  |_i...&....\u.if.|
+00000200  27 3f 79 d2 2e 8e 79 9e  89 42 58 20 a2 ca 8c 2a  |'?y...y..BX ...*|
+00000210  37 b8 99 81 66 3a 31 66  1a 95 4c 47 17 03 03 00  |7...f:1f..LG....|
+00000220  99 66 08 07 06 6d 95 fe  f1 72 2a 7c de 84 06 b0  |.f...m...r*|....|
+00000230  3d d7 d1 6b 47 0e 4d fb  9e ab 55 f7 71 c5 5d 11  |=..kG.M...U.q.].|
+00000240  cb c7 fb 45 90 9d 22 eb  ec 03 d6 ce 8c 01 ff 81  |...E..".........|
+00000250  a2 90 23 1d 7a f3 cb 16  76 a5 05 57 77 f6 af f0  |..#.z...v..Ww...|
+00000260  29 6c 6c 39 9e 99 55 c0  38 c3 31 68 49 b3 bf cc  |)ll9..U.8.1hI...|
+00000270  31 e2 6d a4 4c e7 99 53  2f 31 3f 05 2c 7c 1b 10  |1.m.L..S/1?.,|..|
+00000280  60 ce 8b 60 47 16 eb e5  8b be 1b 7a 95 b9 3c 60  |`..`G......z..<`|
+00000290  1c d6 b5 13 5f ad b9 bb  13 dd d6 08 8e 70 cb 2a  |...._........p.*|
+000002a0  26 3e df ce 7c 21 e5 27  7e 27 ec 75 b6 47 a0 89  |&>..|!.'~'.u.G..|
+000002b0  2e e1 3c ab 0d 72 90 d1  d5 07 17 03 03 00 35 82  |..<..r........5.|
+000002c0  6b 48 4a 9a 63 16 07 8f  b2 d3 4a 65 7d e0 c4 e8  |kHJ.c.....Je}...|
+000002d0  27 3e ce 4a 0a c8 63 e0  f9 70 98 c0 6a 12 39 ec  |'>.J..c..p..j.9.|
+000002e0  e1 52 de 73 58 2d f0 7c  bc 8d 41 16 be 89 a0 88  |.R.sX-.|..A.....|
+000002f0  56 e5 ef f6                                       |V...|
 >>> Flow 4 (server to client)
-00000000  17 03 03 02 80 99 01 39  01 af b3 d3 bd 54 ba 92  |.......9.....T..|
-00000010  0f d8 a0 75 e7 8a 20 e3  3b e7 2e 6f f7 e7 02 1f  |...u.. .;..o....|
-00000020  a5 37 04 9d 5f 7f 19 2e  75 c2 73 af e0 96 80 82  |.7.._...u.s.....|
-00000030  ee 2a 2c f1 4a b8 2f 49  d4 eb 7f cb c5 23 a7 aa  |.*,.J./I.....#..|
-00000040  1d 84 1a 8b 88 de 55 67  93 85 e7 68 7d 7f 17 98  |......Ug...h}...|
-00000050  5f 69 9a 45 29 97 60 ae  08 ed 8c 4d 2a e5 d7 49  |_i.E).`....M*..I|
-00000060  8e 72 7e 8c 64 b3 f0 a4  fa cd 6f 77 3e bc cf f8  |.r~.d.....ow>...|
-00000070  d1 f4 4b 6b 8f b9 48 6a  a1 9c bf 26 30 30 32 9a  |..Kk..Hj...&002.|
-00000080  de 8a d2 08 4f 66 0b 3a  5b ce da c1 a7 a4 b4 0a  |....Of.:[.......|
-00000090  eb 5c c9 dc 1d d3 08 5e  a3 62 53 88 2d df 4e e5  |.\.....^.bS.-.N.|
-000000a0  08 25 e7 86 06 98 66 14  33 fe a3 25 15 15 7b 60  |.%....f.3..%..{`|
-000000b0  91 c4 4c b6 c8 92 4c 2d  82 3a ec 83 17 f9 ff c7  |..L...L-.:......|
-000000c0  b4 e1 45 1c 3a 03 f0 21  fa 83 a7 4a 4b bd 8a 55  |..E.:..!...JK..U|
-000000d0  af 52 54 16 a1 27 a7 33  d6 e7 34 39 8c a9 b3 78  |.RT..'.3..49...x|
-000000e0  a3 3d 0b 90 82 46 ca 31  62 b9 64 3b ff cb 12 2c  |.=...F.1b.d;...,|
-000000f0  43 48 4a 87 ae 63 1d a8  df 68 f3 15 ad b3 78 44  |CHJ..c...h....xD|
-00000100  9e 93 53 a5 fa e4 e7 c0  8e fb 3c ff 74 f2 1d 2f  |..S.......<.t../|
-00000110  92 b6 13 c3 10 00 8b 02  10 1e fd 1b 23 9d 7f c9  |............#...|
-00000120  d1 0b 52 ca 10 c6 e4 ce  62 9b 5f c2 83 c1 b1 83  |..R.....b._.....|
-00000130  54 f7 27 cf d7 1d 5f 80  fe 00 61 0c 82 9c b5 19  |T.'..._...a.....|
-00000140  ce 74 bf b6 38 7b d6 c5  9c 9c e8 32 c8 26 7c 36  |.t..8{.....2.&|6|
-00000150  eb 21 53 16 9c 89 08 73  bd 05 0f cb 69 df 33 f6  |.!S....s....i.3.|
-00000160  6b a3 4e 86 31 f5 75 5f  c4 99 a7 8d 85 ea 9c c4  |k.N.1.u_........|
-00000170  4d 02 10 4e ef c8 3a 96  f6 e3 1c 5d 67 b1 18 35  |M..N..:....]g..5|
-00000180  05 de a7 7c 17 13 8c f2  40 1f 02 9e 54 08 13 fc  |...|....@...T...|
-00000190  e1 db 29 8f 41 3b 03 65  7b aa 5e 3f 41 0b 2c cc  |..).A;.e{.^?A.,.|
-000001a0  34 57 cc 2e a5 48 43 4b  43 b7 38 6a b9 e1 df 39  |4W...HCKC.8j...9|
-000001b0  c0 1c 7d a6 66 ca 0d 4c  1e e3 a7 d6 53 49 99 b9  |..}.f..L....SI..|
-000001c0  26 49 5a fe 51 90 0e c6  57 74 42 10 f2 f2 b6 bb  |&IZ.Q...WtB.....|
-000001d0  bb 6b 29 4e 84 f9 cb 22  66 31 69 1f df 45 48 f2  |.k)N..."f1i..EH.|
-000001e0  dc 8b f0 a5 e6 4c 8d a0  8f 0d 8e 69 71 a4 e3 d4  |.....L.....iq...|
-000001f0  c9 5a 15 aa 20 04 38 e9  f2 3f 81 e2 7c 94 6d 28  |.Z.. .8..?..|.m(|
-00000200  56 2a 2f c1 76 96 72 62  0d 79 2c 1a 27 2e e0 85  |V*/.v.rb.y,.'...|
-00000210  47 25 4e 14 4a 90 a3 ac  ca 3a 7a 63 83 02 3e 0a  |G%N.J....:zc..>.|
-00000220  36 87 61 89 b1 d1 c4 49  0d ef 76 aa c0 1f 7c 75  |6.a....I..v...|u|
-00000230  73 8b 11 12 68 f4 6a ee  a9 5e 91 43 cb 5d dc f7  |s...h.j..^.C.]..|
-00000240  53 bd c2 4c d4 df 7f f2  74 d4 fb d2 ce ba 17 b2  |S..L....t.......|
-00000250  f5 68 88 30 7e 03 44 d3  9e 8c 44 b4 9d 15 d9 05  |.h.0~.D...D.....|
-00000260  f9 bc e8 3c b8 67 d5 16  01 29 43 d6 51 79 73 f8  |...<.g...)C.Qys.|
-00000270  51 1c b4 7c 8c e7 06 02  b7 61 06 1e 08 c3 6a be  |Q..|.....a....j.|
-00000280  ca 8d e9 5a d0 17 03 03  00 1e 09 ed 05 f5 50 61  |...Z..........Pa|
-00000290  e4 e3 36 90 aa c5 19 2d  10 bc 94 21 9b ec 20 55  |..6....-...!.. U|
-000002a0  22 5f 17 9b 2e fa a8 ca  17 03 03 00 13 dc b9 75  |"_.............u|
-000002b0  55 7d fa 96 65 da 58 24  44 6d 18 87 82 61 f6 cc  |U}..e.X$Dm...a..|
+00000000  17 03 03 02 83 ce c4 10  39 1a fe 62 a2 ff 27 6d  |........9..b..'m|
+00000010  b7 e3 1d d6 8e b8 a2 7e  f5 30 87 35 16 41 fb 04  |.......~.0.5.A..|
+00000020  3c 79 9e 02 9b 06 4c a7  ba 01 5b cf 94 bc c8 08  |<y....L...[.....|
+00000030  15 03 91 2c 24 34 17 a4  60 dc a5 72 04 5d 78 49  |...,$4..`..r.]xI|
+00000040  4c 2f e4 6a df 1c 38 fe  b2 8c 61 5e a8 ac 3e d1  |L/.j..8...a^..>.|
+00000050  58 7d fe c1 e3 78 79 31  48 d2 74 c0 8d 17 97 6f  |X}...xy1H.t....o|
+00000060  30 bb 8a 2c 8c d4 76 3d  3f f0 20 24 3d 5a 21 0c  |0..,..v=?. $=Z!.|
+00000070  37 7b 14 45 e6 69 db ed  52 50 a0 77 e9 a2 84 59  |7{.E.i..RP.w...Y|
+00000080  0c 96 c1 ad 48 ed 8d 9f  00 4d f2 15 86 71 c0 fa  |....H....M...q..|
+00000090  14 b9 77 cb 9f 04 d9 1b  be da 68 8e 31 8f 25 14  |..w.......h.1.%.|
+000000a0  f5 43 bd e5 6e c5 10 ab  f7 68 22 7f c2 ba 5c a6  |.C..n....h"...\.|
+000000b0  88 31 c0 a5 fb 63 05 95  52 b3 04 94 14 fe eb 0c  |.1...c..R.......|
+000000c0  53 a0 c2 bf ae 58 e3 f9  84 22 6b ca 95 33 12 80  |S....X..."k..3..|
+000000d0  09 e2 97 b0 2b 4b ed fa  34 e1 5a b1 de 52 b1 2c  |....+K..4.Z..R.,|
+000000e0  a0 aa 11 d6 fa 07 e1 41  ed 36 9f 9a 1a 56 18 b0  |.......A.6...V..|
+000000f0  ef e7 85 dc 5b 53 23 56  c2 ac 34 64 c8 9d 4b 49  |....[S#V..4d..KI|
+00000100  6d 29 7e 4b 73 4f 0b 8e  30 86 87 ea cf 1c dd 62  |m)~KsO..0......b|
+00000110  c0 a4 96 aa fe 41 e7 25  94 8e 08 b5 4d 42 26 d3  |.....A.%....MB&.|
+00000120  ba 84 98 bf 27 2b d5 3d  37 b9 b1 b5 24 33 e3 4d  |....'+.=7...$3.M|
+00000130  3f 05 38 54 fe 2c 15 63  20 2e 70 c0 c6 da 0e 89  |?.8T.,.c .p.....|
+00000140  b6 99 07 db e3 7c 3e 58  d0 a3 2b 50 c4 f3 21 92  |.....|>X..+P..!.|
+00000150  62 e0 e9 b5 d4 7a 6b 23  a2 05 ef 9c f5 f5 05 57  |b....zk#.......W|
+00000160  cd d4 4d 0a 2f 17 ca ac  fc 9d 7e 60 ec 3c 80 8c  |..M./.....~`.<..|
+00000170  1f 99 da b7 f6 14 7a e1  86 76 50 8d f8 6b 92 24  |......z..vP..k.$|
+00000180  f2 b7 82 fa 3c 9b 14 af  0f 37 40 ae 7f 10 f5 0a  |....<....7@.....|
+00000190  f2 0f 0f bd 01 b7 0a f7  b6 d0 7f cf bf e6 67 55  |..............gU|
+000001a0  cc 36 af a6 d8 c4 ca 80  c7 af 35 ff 6e 83 56 30  |.6........5.n.V0|
+000001b0  62 26 49 bb 1a 04 8b 39  10 7b 0f 09 19 2b 0f 95  |b&I....9.{...+..|
+000001c0  08 9d c8 85 3b 5d 8c 97  16 ae cd 92 00 d5 3e 50  |....;]........>P|
+000001d0  54 66 85 8f 42 9b 60 3d  f8 99 ca c7 07 3b 51 18  |Tf..B.`=.....;Q.|
+000001e0  d5 20 37 57 35 0a d8 c6  13 0f 48 94 8f 50 7d 0e  |. 7W5.....H..P}.|
+000001f0  5a f0 98 b2 5d 5f 46 fb  ba 85 c8 4f ba 02 19 86  |Z...]_F....O....|
+00000200  0b ef 4a 04 49 1f 06 cd  be dc d5 32 74 14 d8 60  |..J.I......2t..`|
+00000210  17 a5 b5 a2 70 8e b1 75  29 bc e0 02 e0 a2 1c 7b  |....p..u)......{|
+00000220  58 cd 96 69 84 0f 95 7b  78 3e 09 72 a6 e0 50 7e  |X..i...{x>.r..P~|
+00000230  76 b0 7b 44 11 9b b8 7e  7d 09 49 91 75 5b 9b 6f  |v.{D...~}.I.u[.o|
+00000240  42 a4 e6 54 4d c6 21 65  c4 64 7d c6 29 74 13 8d  |B..TM.!e.d}.)t..|
+00000250  69 5f 20 8c f1 88 e8 1e  2d c3 13 d5 f5 52 70 24  |i_ .....-....Rp$|
+00000260  de ec 64 c7 00 3f 57 e2  3f c4 23 fe e9 65 e6 d9  |..d..?W.?.#..e..|
+00000270  92 ae f0 2f 05 4d 01 72  be 0d 7d c0 f4 30 ac 69  |.../.M.r..}..0.i|
+00000280  3c 7c c1 72 c1 b7 c4 c9  17 03 03 00 1e 73 8f 48  |<|.r.........s.H|
+00000290  cf 34 35 31 9b 63 59 59  1b 23 e1 6b b2 3a 0f df  |.451.cYY.#.k.:..|
+000002a0  21 69 8e 73 1a 61 09 5b  82 c7 78 17 03 03 00 13  |!i.s.a.[..x.....|
+000002b0  4f a0 ab 25 3f a4 85 9e  78 58 69 d2 2c c3 b6 df  |O..%?...xXi.,...|
+000002c0  32 4a 7f                                          |2J.|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedNotGiven b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedNotGiven
index c848cf1287..b839c95879 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedNotGiven
+++ b/src/crypto/tls/testdata/Server-TLSv13-ClientAuthRequestedNotGiven
@@ -1,103 +1,103 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 47 f0 15 f7 e3  |...........G....|
-00000010  13 9a 07 53 29 3f 54 51  1e 17 92 b1 5a 11 f7 fa  |...S)?TQ....Z...|
-00000020  6e 9f c8 15 a2 c5 61 85  ee 69 aa 20 1b 3c bc 62  |n.....a..i. .<.b|
-00000030  28 c2 1a 1b 62 9a 37 c6  e4 94 45 70 9d a2 4d 9c  |(...b.7...Ep..M.|
-00000040  27 15 ee b8 c2 c9 3e e5  82 eb 47 53 00 04 13 01  |'.....>...GS....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 4a ea 7e 77 82  |...........J.~w.|
+00000010  17 37 46 db 49 14 d2 41  e4 14 b0 46 20 9d 50 45  |.7F.I..A...F .PE|
+00000020  d1 75 08 82 2b 8d bc 9a  75 e3 71 20 ce 77 9a 79  |.u..+...u.q .w.y|
+00000030  98 24 bc 15 be ac 30 fe  66 35 ab 51 be bd b4 fa  |.$....0.f5.Q....|
+00000040  6f 53 1f e9 5f 54 58 75  ce 94 f9 47 00 04 13 01  |oS.._TXu...G....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 f1  |-.....3.&.$... .|
-000000b0  9d 7c bc af 20 28 bb bf  80 36 07 94 5f ef 3d 63  |.|.. (...6.._.=c|
-000000c0  ed 84 29 c6 e5 15 88 58  38 a0 07 94 a2 5a 6d     |..)....X8....Zm|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 e0  |-.....3.&.$... .|
+000000b0  64 7e 58 b6 e7 32 fc c9  d6 3e f7 e0 f5 6a 9c 3a  |d~X..2...>...j.:|
+000000c0  e6 8f 83 d7 1c 27 62 72  71 06 71 de 49 96 05     |.....'brq.q.I..|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 1b 3c bc 62  |........... .<.b|
-00000030  28 c2 1a 1b 62 9a 37 c6  e4 94 45 70 9d a2 4d 9c  |(...b.7...Ep..M.|
-00000040  27 15 ee b8 c2 c9 3e e5  82 eb 47 53 13 01 00 00  |'.....>...GS....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 ce 77 9a 79  |........... .w.y|
+00000030  98 24 bc 15 be ac 30 fe  66 35 ab 51 be bd b4 fa  |.$....0.f5.Q....|
+00000040  6f 53 1f e9 5f 54 58 75  ce 94 f9 47 13 01 00 00  |oS.._TXu...G....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 50 53 1c be d5 ee  |..........PS....|
-00000090  91 44 3a e8 70 97 c6 e4  2c d5 18 df 47 c3 5d e6  |.D:.p...,...G.].|
-000000a0  04 17 03 03 00 3e f6 c2  36 23 98 44 4e 0a aa 88  |.....>..6#.DN...|
-000000b0  86 ed fe fb d0 aa c5 aa  28 4c 94 1e 3b 2c 42 93  |........(L..;,B.|
-000000c0  7f df a1 09 db 05 d3 5a  d8 4a 52 8e e7 ae c0 ad  |.......Z.JR.....|
-000000d0  b5 63 f7 75 73 52 ec fb  fa fe 58 05 65 ed d7 d2  |.c.usR....X.e...|
-000000e0  fb c3 5b f6 17 03 03 02  6d a5 7c 78 f2 4a 79 7f  |..[.....m.|x.Jy.|
-000000f0  08 d2 26 fb 2e 97 1a ee  4d 8c 24 ac 86 d7 eb c1  |..&.....M.$.....|
-00000100  5d 48 c6 81 a2 9e a6 8e  33 b5 43 c6 a1 b4 a4 19  |]H......3.C.....|
-00000110  d1 95 8c d1 27 59 a7 55  b1 11 8b 64 1c 24 70 d8  |....'Y.U...d.$p.|
-00000120  72 a8 cf b3 23 1a b3 af  9d 2b c8 30 07 f7 1f 4a  |r...#....+.0...J|
-00000130  1f 77 b6 54 92 92 39 43  e5 91 7b 55 9e 97 83 b1  |.w.T..9C..{U....|
-00000140  76 79 0f 7b 99 dc 83 6b  bb fc e2 83 f7 3e e7 b4  |vy.{...k.....>..|
-00000150  be fd b7 67 4d cb 58 2d  a9 a8 64 b3 87 32 57 fe  |...gM.X-..d..2W.|
-00000160  06 a9 2f 2a 5a 62 71 2c  e4 4e 37 a8 48 59 71 1f  |../*Zbq,.N7.HYq.|
-00000170  88 41 e5 d9 be ef cf f7  c4 03 17 00 42 5a 10 d4  |.A..........BZ..|
-00000180  e6 bb 0c 26 fa 61 bf 83  fd 60 e5 ae c8 ce 55 b9  |...&.a...`....U.|
-00000190  b3 ac 95 85 77 d0 84 1d  96 5e 7e 10 77 e7 0b 74  |....w....^~.w..t|
-000001a0  f4 c0 52 c9 18 b7 32 76  17 94 12 56 7e 34 ca ca  |..R...2v...V~4..|
-000001b0  de dd c1 8f 86 df 30 2a  6d b9 5c ae be dd 44 43  |......0*m.\...DC|
-000001c0  51 5c 0b 13 ac 1a ad 4c  20 7d 49 ce 0c 7f fc ec  |Q\.....L }I.....|
-000001d0  3d 01 95 4a df c8 b1 a3  e7 06 d0 f9 7b 2c d4 d3  |=..J........{,..|
-000001e0  96 47 4e d0 a5 57 24 65  70 e1 e3 11 71 85 4d f5  |.GN..W$ep...q.M.|
-000001f0  1a 81 cd d9 80 2a b4 f0  55 5a 03 db 1c e8 e9 32  |.....*..UZ.....2|
-00000200  dd f2 22 b8 25 f5 b4 a3  85 7c 86 90 d1 eb 02 44  |..".%....|.....D|
-00000210  82 ed d4 80 22 32 2b e1  f6 91 a0 6c 51 3d 51 c5  |...."2+....lQ=Q.|
-00000220  b3 1d 75 d6 7c 90 44 63  2e f9 1c a9 f0 b8 0f 36  |..u.|.Dc.......6|
-00000230  b7 e4 72 1b c7 53 0f 2a  05 ea d8 eb e4 be 1c dd  |..r..S.*........|
-00000240  79 a9 b1 f6 27 bb d5 88  c5 f4 c3 b4 b4 a0 6b e0  |y...'.........k.|
-00000250  aa a9 49 08 66 d4 3d b8  fe 93 1b 99 64 5b db 46  |..I.f.=.....d[.F|
-00000260  3d a6 d0 bf b1 5e bc 97  76 c4 71 31 e6 1a b3 8e  |=....^..v.q1....|
-00000270  8a 6f e7 17 34 ae d5 19  13 7a 85 a4 39 dc c1 5f  |.o..4....z..9.._|
-00000280  75 b7 da fe ec 78 8a ea  30 b0 22 e1 cd fb 2d 9e  |u....x..0."...-.|
-00000290  b1 02 5c 0c ac 96 de fe  e8 ff 50 2c be d5 ae 72  |..\.......P,...r|
-000002a0  f3 3b c1 11 d0 16 77 23  63 47 dd a4 ae 97 9e 5a  |.;....w#cG.....Z|
-000002b0  1d 5c e4 ff 04 0c d1 69  09 52 6b 27 e4 50 6e 03  |.\.....i.Rk'.Pn.|
-000002c0  a9 c7 ac b8 1e 98 52 76  39 b2 cf 01 d1 f4 ef b2  |......Rv9.......|
-000002d0  a2 2b dc 40 a3 27 3d 35  2c fc 92 9a dd 0f 6a 0d  |.+.@.'=5,.....j.|
-000002e0  b2 48 ca be 80 7f 18 15  75 80 cf e9 3b 0a 6d 37  |.H......u...;.m7|
-000002f0  6a a9 4c 1d cd 87 26 8f  f0 37 1b 15 fd 4b 26 53  |j.L...&..7...K&S|
-00000300  22 c1 0e fb b8 69 1f 36  a1 b1 52 e6 c7 4b fd 11  |"....i.6..R..K..|
-00000310  e6 42 53 cb 0b 7c 96 05  97 fa 84 37 97 69 de b1  |.BS..|.....7.i..|
-00000320  c0 11 e7 b7 f7 87 f7 46  ae 92 e4 e5 3e 4a 61 ab  |.......F....>Ja.|
-00000330  2d 4c 39 09 21 37 6b 52  d6 91 ca b3 63 d2 dc 42  |-L9.!7kR....c..B|
-00000340  0e 4a 67 08 e7 3d 25 d3  be e5 62 5b 47 2e fe 46  |.Jg..=%...b[G..F|
-00000350  45 92 d4 b3 f6 7f 17 03  03 00 99 0a e2 d6 ab 8c  |E...............|
-00000360  66 76 a5 fe e1 9e cc a2  ce 7e 0a 3a 1f a4 20 7b  |fv.......~.:.. {|
-00000370  83 ba a6 b7 11 e0 f1 c5  7a f6 51 f3 53 78 fe 36  |........z.Q.Sx.6|
-00000380  bb 3d ae 12 cd 00 7a 03  77 bc 4b 1d c9 b1 76 33  |.=....z.w.K...v3|
-00000390  74 02 f9 5e 27 f5 fb 37  0c af be ad ad 46 7b f6  |t..^'..7.....F{.|
-000003a0  50 dc 8b 77 60 b2 22 3a  5a b5 e8 4f 27 05 9a 21  |P..w`.":Z..O'..!|
-000003b0  9b 24 fc dd 8d 9e 20 3d  b1 8a ca 6c 5d 8d 09 dc  |.$.... =...l]...|
-000003c0  95 5b d1 7b 86 ac df 59  82 35 58 fb 59 d1 45 a2  |.[.{...Y.5X.Y.E.|
-000003d0  11 64 7c 58 4f eb ed 9c  18 f0 76 00 82 c6 05 c5  |.d|XO.....v.....|
-000003e0  2c 04 a6 07 b7 bd dd 66  da 8d 14 c2 6a f4 c0 d2  |,......f....j...|
-000003f0  da 50 fe 2e 17 03 03 00  35 9a e5 00 5e b3 9c 98  |.P......5...^...|
-00000400  3f 8f ba 31 12 62 40 35  7c 0f cc bb af 1b 49 c3  |?..1.b@5|.....I.|
-00000410  6c af b0 79 be 6e f3 32  9f 52 8f 63 27 71 d3 29  |l..y.n.2.R.c'q.)|
-00000420  58 71 6f 05 00 61 10 a9  b7 73 30 89 ca 42        |Xqo..a...s0..B|
+00000080  03 03 00 01 01 17 03 03  00 17 d0 8f 0a 7e 6c 33  |.............~l3|
+00000090  0b be 2a 24 0e fc af df  6e 7d ad 22 28 82 77 60  |..*$....n}."(.w`|
+000000a0  3d 17 03 03 00 3e 8f 87  8f f1 5a f6 6f eb eb d9  |=....>....Z.o...|
+000000b0  da aa fc 3c 6d ac 73 94  a3 13 5f fe 01 bb 75 eb  |...<m.s..._...u.|
+000000c0  ce d5 75 68 39 3c 0b 3c  5d ab 3f dc eb 6d 30 79  |..uh9<.<].?..m0y|
+000000d0  25 35 a8 2b 72 57 e4 9f  6f 4a 1e 03 74 eb 04 f9  |%5.+rW..oJ..t...|
+000000e0  c4 4f c1 46 17 03 03 02  6d 50 d5 4a 67 1e a7 43  |.O.F....mP.Jg..C|
+000000f0  50 f5 b9 55 8d 57 a3 0e  e4 b0 ae 6c 5b ca f9 d7  |P..U.W.....l[...|
+00000100  f7 22 34 92 72 76 a4 5b  c4 c7 0a 75 cc 97 0c 03  |."4.rv.[...u....|
+00000110  37 25 04 65 a6 fc da a8  fb 8c ef f1 25 d6 4b f6  |7%.e........%.K.|
+00000120  ed d5 80 2b 10 b2 0b 31  f5 33 d7 df a7 9b c7 6e  |...+...1.3.....n|
+00000130  52 f6 ed ac e0 20 1e f2  93 11 b7 bd b0 0d 5e 41  |R.... ........^A|
+00000140  be e4 b5 e4 a1 6d 21 45  27 1d 5e 65 fe 2c e9 f4  |.....m!E'.^e.,..|
+00000150  97 5c 45 5b 23 5a 8c dc  29 64 61 28 48 cf ae 3f  |.\E[#Z..)da(H..?|
+00000160  2c 21 b1 68 9e 09 74 76  77 65 f4 85 07 dc f3 0e  |,!.h..tvwe......|
+00000170  27 97 4d 60 47 35 31 13  92 15 90 f4 ca 24 84 6e  |'.M`G51......$.n|
+00000180  da 91 13 a3 37 54 4e 52  d4 9c 2f 82 6e 76 fd d7  |....7TNR../.nv..|
+00000190  81 29 fa 76 ac be 32 04  0d 7e d0 09 b0 47 ff 6d  |.).v..2..~...G.m|
+000001a0  37 32 6d 2c 8e d3 06 94  da 3f 20 87 56 f8 4a 2f  |72m,.....? .V.J/|
+000001b0  d6 75 4d 90 5c c1 e5 f6  82 c4 3c d9 da a2 95 0a  |.uM.\.....<.....|
+000001c0  4c 36 59 a9 10 50 a0 0d  61 06 4f 65 6e 64 bb 29  |L6Y..P..a.Oend.)|
+000001d0  42 9f 62 81 65 54 22 cb  4c a5 95 1b 2a 49 18 2f  |B.b.eT".L...*I./|
+000001e0  fc 54 b4 38 27 3f cf ab  b0 97 3e 17 8b ae 98 a0  |.T.8'?....>.....|
+000001f0  50 76 d6 79 39 e8 25 bc  3b d9 5a a4 a8 5e 08 6a  |Pv.y9.%.;.Z..^.j|
+00000200  1c 48 b1 11 f0 d9 b9 48  39 e1 23 db 41 8c bf bd  |.H.....H9.#.A...|
+00000210  20 27 7b 0c 89 10 1f b0  ae 70 18 9a 7f f2 b4 1d  | '{......p......|
+00000220  20 cd 6d 80 38 00 a4 33  de 22 ef f6 42 52 c7 66  | .m.8..3."..BR.f|
+00000230  83 4a 67 18 6b a6 38 27  d3 40 cf a2 a9 3e 58 06  |.Jg.k.8'.@...>X.|
+00000240  91 a7 36 08 29 10 4d 8f  1b f9 7c 5a 17 05 81 b9  |..6.).M...|Z....|
+00000250  4b 60 48 40 49 73 63 8a  ef 9f f2 9e 80 85 57 fa  |K`H@Isc.......W.|
+00000260  0a b8 72 83 f3 26 fa 07  ae d2 47 99 b5 a6 5d c5  |..r..&....G...].|
+00000270  1e b5 fc ea 0f 17 f8 ba  e2 5c 7d 59 70 53 2e 23  |.........\}YpS.#|
+00000280  f7 55 75 cb de 82 dc ca  b1 bf 3f 5f 7d 7d 92 3c  |.Uu.......?_}}.<|
+00000290  29 29 64 30 74 0a 01 0b  c0 95 db 45 fe 20 be 38  |))d0t......E. .8|
+000002a0  c5 87 b7 e4 a9 93 63 67  6b 9a 2f 24 9e 62 8f 1d  |......cgk./$.b..|
+000002b0  bd 8c 4a d4 b0 0f 95 2f  56 b2 1c e8 5a 58 81 2e  |..J..../V...ZX..|
+000002c0  b5 b5 b5 f2 1b 7f 6c 39  58 75 51 dc 83 2a 59 0b  |......l9XuQ..*Y.|
+000002d0  78 5e 22 7e af ee 59 af  b9 8f dc 65 97 af a5 b5  |x^"~..Y....e....|
+000002e0  b8 50 af 35 51 30 e7 0a  75 e2 d0 33 e2 fb f4 b1  |.P.5Q0..u..3....|
+000002f0  99 cd 5f 72 6b a9 f8 85  a1 a5 19 7e 2b 91 01 19  |.._rk......~+...|
+00000300  09 dd 88 6e a7 d6 54 57  cd ef d0 97 6a 68 d9 6e  |...n..TW....jh.n|
+00000310  52 38 ef a5 fa 84 63 70  f0 6d 64 ec 66 1a c9 b5  |R8....cp.md.f...|
+00000320  78 ba 17 74 f4 b4 2b a2  fe 9a 7f 38 b8 5e 8b 56  |x..t..+....8.^.V|
+00000330  a6 7b 2c 92 7f db 58 c8  fa f9 2d 6b 00 25 dc 0a  |.{,...X...-k.%..|
+00000340  aa 13 e8 40 f3 fd 47 23  f6 bf 1c 30 fc 91 18 95  |...@..G#...0....|
+00000350  ac a8 82 3d f5 ef 17 03  03 00 99 7e 30 4f f1 00  |...=.......~0O..|
+00000360  1e dd eb c6 54 d2 f5 f7  21 aa 6b b0 83 0c fa 8b  |....T...!.k.....|
+00000370  12 af ac 15 3e 54 b6 1c  85 9b 0c 80 02 d8 e3 5f  |....>T........._|
+00000380  36 57 64 fe 7a b8 31 d0  aa 59 f1 e6 af e0 27 c5  |6Wd.z.1..Y....'.|
+00000390  b8 d8 2f ab e0 cc c3 02  18 73 30 36 b5 2a 0d 12  |../......s06.*..|
+000003a0  a4 45 e6 c3 79 9f 54 cb  51 61 1a b8 aa 87 45 43  |.E..y.T.Qa....EC|
+000003b0  8e 93 58 66 f2 97 cb 3b  44 df ae 93 17 de 22 99  |..Xf...;D.....".|
+000003c0  3c b4 9d 21 a6 db 03 ce  7b fb 67 b9 6e fb ab 50  |<..!....{.g.n..P|
+000003d0  f8 33 9f 20 a0 fb e9 54  bb 62 16 19 d6 df 8c fe  |.3. ...T.b......|
+000003e0  3d 63 42 7c b0 72 2b 0d  87 1e f7 7d bb 59 ba f5  |=cB|.r+....}.Y..|
+000003f0  d6 e8 f3 57 17 03 03 00  35 9e 6f 39 92 2e 32 10  |...W....5.o9..2.|
+00000400  03 cd f0 28 2c 1a 32 77  19 c8 39 38 60 0c 28 b7  |...(,.2w..98`.(.|
+00000410  8c 3a d8 50 a1 44 e4 d6  c5 64 59 88 2d a4 23 c9  |.:.P.D...dY.-.#.|
+00000420  26 d1 96 0c c9 5d da 84  3e 8a 7d fe 80 77        |&....]..>.}..w|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 19 76 3c 46 9e ad  |...........v<F..|
-00000010  ee 3d 05 c8 f2 c7 3b ed  7c d2 0c c4 03 34 b0 90  |.=....;.|....4..|
-00000020  d0 70 57 90 17 03 03 00  35 20 29 7c d6 f8 fe 09  |.pW.....5 )|....|
-00000030  e4 43 a5 c0 33 44 9e f9  8a 92 d2 45 20 40 cf 49  |.C..3D.....E @.I|
-00000040  68 42 e4 e6 f9 c8 4f 35  83 a5 bd 66 f0 32 c5 33  |hB....O5...f.2.3|
-00000050  5d f4 61 45 d3 e5 26 2f  96 55 15 d7 d5 bb        |].aE..&/.U....|
+00000000  14 03 03 00 01 01 17 03  03 00 19 87 49 99 a6 d9  |............I...|
+00000010  ed cd f7 7a 75 14 e1 26  41 d2 6e 5c 79 a6 be 7c  |...zu..&A.n\y..||
+00000020  5d 9d 44 36 17 03 03 00  35 1b 51 a9 b1 ce 11 ed  |].D6....5.Q.....|
+00000030  95 47 34 b9 3d 2f 6e 27  b2 e5 31 54 7f e3 8a 11  |.G4.=/n'..1T....|
+00000040  fd 54 75 2c b6 8a 56 25  00 29 a7 5f 7a 1e 16 be  |.Tu,..V%.)._z...|
+00000050  16 e3 86 3a 72 84 0e bc  40 ef fd ad 18 33        |...:r...@....3|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 88 2f 43 9c  2c 4d 58 5f 8e c6 11 52  |...../C.,MX_...R|
-00000010  b6 b6 e7 f7 d6 e4 f6 dc  91 a8 3d 8d cc 65 21 1b  |..........=..e!.|
-00000020  ce 1f a4 27 89 64 04 c8  7f 78 09 35 d1 7b 0e 2e  |...'.d...x.5.{..|
-00000030  66 ef f1 3d e1 fa e6 94  29 4f 5c 39 d4 67 2d d6  |f..=....)O\9.g-.|
-00000040  61 8a 3d ad ed eb 62 5b  ce 2f b6 c2 01 d9 db 08  |a.=...b[./......|
-00000050  80 00 3c 69 81 d7 be 62  be 4b 1d 9a 76 78 71 c6  |..<i...b.K..vxq.|
-00000060  8c 86 38 91 8f ff 79 91  2d 83 de ef a2 05 3e b1  |..8...y.-.....>.|
-00000070  e0 36 da e5 99 49 7b c7  62 0c f2 c2 0c 4c bc 8b  |.6...I{.b....L..|
-00000080  c7 23 92 4f 9b 80 83 2b  7b 07 86 78 c7 17 03 03  |.#.O...+{..x....|
-00000090  00 1e 97 05 00 8b 39 6e  07 28 fc 9a ca 32 c1 7f  |......9n.(...2..|
-000000a0  22 13 aa 2e 90 4f f9 6e  3d 2d b1 d1 6a bd 97 95  |"....O.n=-..j...|
-000000b0  17 03 03 00 13 d7 28 95  f3 7b c6 88 8c 7c 20 e2  |......(..{...| .|
-000000c0  ae 58 35 6c 08 3a ef 6b                           |.X5l.:.k|
+00000000  17 03 03 00 8b 69 2e 81  c4 4d 43 a6 1f 96 b7 8e  |.....i...MC.....|
+00000010  87 4a 9b be 48 3c 31 18  98 f4 8c 04 24 b2 52 96  |.J..H<1.....$.R.|
+00000020  04 b5 12 7c 54 37 83 6d  51 42 c6 52 f4 a5 bc d3  |...|T7.mQB.R....|
+00000030  d1 c8 29 ab 4f e4 02 da  74 ec 8e 13 ad 03 f3 e0  |..).O...t.......|
+00000040  7f 44 58 6b c7 28 a5 6a  75 30 b8 b1 31 38 fe ba  |.DXk.(.ju0..18..|
+00000050  e7 27 ae b3 e7 cb 5e 78  24 82 03 61 ba ae dd 4c  |.'....^x$..a...L|
+00000060  c6 7b f3 45 cf 6f a8 dc  7d 5d 73 65 db ae dc 10  |.{.E.o..}]se....|
+00000070  ff 32 dc 4c b4 5e dc ce  4c 34 37 83 a0 0c d5 20  |.2.L.^..L47.... |
+00000080  f1 f6 81 42 bc 63 65 47  80 d0 d6 f3 08 aa e2 58  |...B.ceG.......X|
+00000090  17 03 03 00 1e 85 84 f3  e4 0f a8 24 c0 fe fa 2c  |...........$...,|
+000000a0  8b 60 52 32 73 2b 95 e9  37 3d 1c bd 2f ee ff e2  |.`R2s+..7=../...|
+000000b0  70 13 df 17 03 03 00 13  65 2b 11 5f 50 7c 11 eb  |p.......e+._P|..|
+000000c0  3b 06 75 23 28 13 ca 4a  b5 fb dc                 |;.u#(..J...|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ECDHE-ECDSA-AES b/src/crypto/tls/testdata/Server-TLSv13-ECDHE-ECDSA-AES
index 622408884f..d2ed2ee64e 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ECDHE-ECDSA-AES
+++ b/src/crypto/tls/testdata/Server-TLSv13-ECDHE-ECDSA-AES
@@ -1,93 +1,93 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 64 e9 94 6e 11  |...........d..n.|
-00000010  99 79 12 f5 f1 a4 ad 5f  cb 1d ae d6 3d 2a 3e ff  |.y....._....=*>.|
-00000020  0a 22 84 74 c2 80 c1 7f  c3 5a ee 20 d6 6a 14 f7  |.".t.....Z. .j..|
-00000030  30 ad 5a 3e a5 7e da 10  a9 96 c1 3b 42 9b 02 4f  |0.Z>.~.....;B..O|
-00000040  d2 8e 8c 24 10 c0 60 da  09 f2 29 c7 00 04 13 01  |...$..`...).....|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 be 5b 8c 08 2b  |............[..+|
+00000010  26 a0 41 0f e3 4e b6 5c  9f 5d 53 04 67 4a 1d a2  |&.A..N.\.]S.gJ..|
+00000020  26 3b 83 ab b4 7b c6 ec  f8 a6 41 20 a6 de ad e2  |&;...{....A ....|
+00000030  0c fd 02 99 11 51 c6 be  e8 52 df 0b e2 b3 6f fe  |.....Q...R....o.|
+00000040  33 3e 2f 90 ac d2 e8 a2  53 8b d9 05 00 04 13 01  |3>/.....S.......|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 ba  |-.....3.&.$... .|
-000000b0  20 43 fb 3f f4 a0 b9 06  47 72 39 5a 36 04 e0 2c  | C.?....Gr9Z6..,|
-000000c0  73 d7 1c e4 55 bd 9a b5  8b 93 83 91 40 9e 79     |s...U.......@.y|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 31  |-.....3.&.$... 1|
+000000b0  8e dd f4 7c cf 22 04 c1  c3 04 5c 24 49 db ae ab  |...|."....\$I...|
+000000c0  0a d0 42 e8 70 51 c7 4f  88 e2 4e 2e 0b 80 65     |..B.pQ.O..N...e|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 d6 6a 14 f7  |........... .j..|
-00000030  30 ad 5a 3e a5 7e da 10  a9 96 c1 3b 42 9b 02 4f  |0.Z>.~.....;B..O|
-00000040  d2 8e 8c 24 10 c0 60 da  09 f2 29 c7 13 01 00 00  |...$..`...).....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 a6 de ad e2  |........... ....|
+00000030  0c fd 02 99 11 51 c6 be  e8 52 df 0b e2 b3 6f fe  |.....Q...R....o.|
+00000040  33 3e 2f 90 ac d2 e8 a2  53 8b d9 05 13 01 00 00  |3>/.....S.......|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 97 f6 12 8c a3 14  |................|
-00000090  6f e3 e2 c3 19 38 79 4c  56 2a a5 8f cd f4 41 90  |o....8yLV*....A.|
-000000a0  b4 17 03 03 02 22 9f 20  4f 27 f6 79 fb 69 a5 50  |.....". O'.y.i.P|
-000000b0  99 55 c8 8a 29 88 3a 7d  48 08 a1 d1 f4 2b 96 91  |.U..).:}H....+..|
-000000c0  e2 a4 b2 25 b8 5b de 43  03 91 aa a0 66 29 b1 f4  |...%.[.C....f)..|
-000000d0  0c fa 77 fc a6 88 3c 15  69 a0 74 cb af 0c d5 4f  |..w...<.i.t....O|
-000000e0  bf 8c 56 2b 74 b7 dd d8  f2 f3 3a 25 34 d6 2c a5  |..V+t.....:%4.,.|
-000000f0  ec 1b e3 a8 02 80 01 f6  a0 cd 7a 43 dc 8a 4a c5  |..........zC..J.|
-00000100  44 54 23 2d 62 ad 66 22  db d9 bb 56 df 2d 7e 61  |DT#-b.f"...V.-~a|
-00000110  8b 13 cc 96 4e e8 08 a2  d1 06 38 2a d5 f1 9b 70  |....N.....8*...p|
-00000120  55 2b dc 6c e8 7f ca b6  15 9a 13 bd cb 51 5b ff  |U+.l.........Q[.|
-00000130  aa 75 b6 4a 38 e2 1d 07  ed 82 be fa b9 72 68 e0  |.u.J8........rh.|
-00000140  a9 e6 22 a3 f1 02 d8 22  04 6d 0b e1 84 81 01 94  |.."....".m......|
-00000150  f5 7e 7a b0 a0 67 bc 25  62 d7 87 18 07 32 1d 32  |.~z..g.%b....2.2|
-00000160  b0 70 df 69 24 32 f0 b4  07 8e 4b eb 44 d9 fc ba  |.p.i$2....K.D...|
-00000170  4c 9e 48 3f 4e 15 51 9b  c7 ec a2 3d 30 33 e9 6f  |L.H?N.Q....=03.o|
-00000180  f9 14 62 9b 8a 27 f0 98  f1 4c 69 1c b0 50 26 86  |..b..'...Li..P&.|
-00000190  22 41 c3 2d fb 3a 9c da  8a a2 d0 98 f2 bd 27 10  |"A.-.:........'.|
-000001a0  b1 1e a2 06 71 a6 7d 55  70 93 92 11 43 e9 c7 50  |....q.}Up...C..P|
-000001b0  98 17 b7 b8 d4 8f 24 36  f5 e2 3a 5f 28 f2 3e dd  |......$6..:_(.>.|
-000001c0  00 67 5f a9 e6 c7 8b 7f  69 41 8d 4b 30 c6 14 e6  |.g_.....iA.K0...|
-000001d0  6c 0c f8 0d b9 bf f0 83  a9 08 95 65 1a 12 c6 86  |l..........e....|
-000001e0  00 7f f3 3b ee 47 03 2b  a9 3e 9f 59 77 c6 cc ff  |...;.G.+.>.Yw...|
-000001f0  8c 6b d7 f0 99 32 11 a8  12 23 6d c1 79 14 62 9f  |.k...2...#m.y.b.|
-00000200  35 ab ad ae dd b5 eb b0  73 a7 a6 eb 83 37 3e 44  |5.......s....7>D|
-00000210  be 82 52 f7 e3 09 5c 16  0b 5a 63 d6 b4 0b 7b 8b  |..R...\..Zc...{.|
-00000220  bc 8c f8 11 de cd fb 52  c3 c3 6c 9c 4c c0 4a 5d  |.......R..l.L.J]|
-00000230  c5 a5 ff f6 e0 ad 56 61  1c 5f 67 e2 e9 f3 7f 5f  |......Va._g...._|
-00000240  14 e1 09 8d 66 40 27 d4  74 cf 5f 3f d3 c9 78 86  |....f@'.t._?..x.|
-00000250  32 5e 59 8d 9f d3 d7 9b  e6 06 23 02 56 b6 4c b7  |2^Y.......#.V.L.|
-00000260  38 c6 6e c6 54 64 78 81  6d e1 4b e7 7e 03 3b 1a  |8.n.Tdx.m.K.~.;.|
-00000270  2c 8d f9 12 4d d5 a9 9c  81 07 80 87 1e 1c db bf  |,...M...........|
-00000280  20 eb 0a c0 e7 a1 8c 2a  42 17 68 0a 67 38 af ed  | ......*B.h.g8..|
-00000290  b4 c5 5a 86 dc af bb 7f  05 76 cd 2b 69 c6 f8 6b  |..Z......v.+i..k|
-000002a0  87 16 b3 d2 a7 ef 8e 71  64 d5 78 d3 26 1e 2d 9c  |.......qd.x.&.-.|
-000002b0  8c d5 76 6a ae 0b b2 73  6a 18 5a 91 43 ac ec d2  |..vj...sj.Z.C...|
-000002c0  dd cb 36 a2 6b 3d cb ee  17 03 03 00 a4 79 13 8c  |..6.k=.......y..|
-000002d0  8f 9d b5 d0 d8 64 20 f1  8d 13 ff f4 b6 2f d9 94  |.....d ....../..|
-000002e0  e7 c4 c8 8a d6 53 45 ff  11 f0 aa 49 fa 15 f9 4a  |.....SE....I...J|
-000002f0  fd a0 98 fc 62 cc 61 d4  6b 41 d6 b5 3c eb 37 be  |....b.a.kA..<.7.|
-00000300  1e ab 48 7d 87 71 45 f6  e0 8d 40 b8 ae d2 ac 0d  |..H}.qE...@.....|
-00000310  3f c4 2d c1 f8 0f f4 ae  d7 88 97 dd df 0e d2 d1  |?.-.............|
-00000320  1c 03 ea a3 71 98 cb df  dd 72 f0 39 eb b2 a9 15  |....q....r.9....|
-00000330  3f 57 c4 1e f9 87 0b ad  2b 84 2b ff 88 9c 4e 37  |?W......+.+...N7|
-00000340  14 b5 8c 2c 30 e7 16 48  3e c9 e6 e7 c1 d9 0b d0  |...,0..H>.......|
-00000350  23 4c c7 4e a8 2f ca 7d  98 15 1f 70 c0 42 74 5a  |#L.N./.}...p.BtZ|
-00000360  86 8e e3 cd e4 1d 56 9d  80 63 3e ad 94 bf d4 6f  |......V..c>....o|
-00000370  a1 17 03 03 00 35 fe 27  df 5a d3 bd 58 0d 7b 2e  |.....5.'.Z..X.{.|
-00000380  24 a4 61 4e d4 21 d2 be  64 f5 6d 9d 5a 82 0e 0f  |$.aN.!..d.m.Z...|
-00000390  90 b6 df a3 e6 e2 66 1e  fe bd 1a 59 3a d5 9e 1a  |......f....Y:...|
-000003a0  bb f3 79 c0 d8 e8 5b 9b  60 4d e4 17 03 03 00 88  |..y...[.`M......|
-000003b0  39 91 96 dd 9d 3f 60 30  fb c6 40 57 fb f7 c9 44  |9....?`0..@W...D|
-000003c0  df 03 6a e1 e2 df 9a 0a  8f a7 75 ab 40 5e bc 83  |..j.......u.@^..|
-000003d0  94 8b 55 91 7f 3d fb a1  0e 57 f7 d0 3c 81 db 34  |..U..=...W..<..4|
-000003e0  36 7f 57 92 42 92 67 40  cb a8 f6 9a 80 6d 4f 40  |6.W.B.g@.....mO@|
-000003f0  77 a5 3c 31 5c a9 b0 82  58 d9 8f e1 2b 6d 3b 03  |w.<1\...X...+m;.|
-00000400  6d 6e 7e 71 4a 57 80 9f  2f 71 51 53 5e c3 31 7e  |mn~qJW../qQS^.1~|
-00000410  be 5d ea 1c 83 d7 64 46  7f a9 88 e9 e3 47 a6 b1  |.]....dF.....G..|
-00000420  c2 1f fa 0a af 54 ce 55  ba 67 cd a2 1a 52 d1 bd  |.....T.U.g...R..|
-00000430  91 00 e4 a6 8d 92 2e 93                           |........|
+00000080  03 03 00 01 01 17 03 03  00 17 cc d0 60 a1 dc d6  |............`...|
+00000090  46 57 69 3d df 0e 0f 7f  a8 34 2d 87 71 84 16 54  |FWi=.....4-.q..T|
+000000a0  9d 17 03 03 02 22 cb 9c  f9 3e a0 fd bf 07 03 7c  |....."...>.....||
+000000b0  53 0c 15 22 0b 78 e5 02  36 e6 e7 6c 5b f9 aa 8d  |S..".x..6..l[...|
+000000c0  54 8e b1 15 d4 23 05 12  5e 6e 0f 0f 65 77 bf b5  |T....#..^n..ew..|
+000000d0  32 28 0e 32 ca 9f 61 c3  37 23 87 e8 ec 19 1d ba  |2(.2..a.7#......|
+000000e0  ef f5 18 eb ba 49 2d 86  a6 d1 f7 c1 9e 67 10 9f  |.....I-......g..|
+000000f0  a1 d2 62 bd 4c 6c 5e a4  41 f6 1e fa fd e7 55 bc  |..b.Ll^.A.....U.|
+00000100  16 ad 91 91 de 03 86 d7  e1 88 87 ab 0e f4 f5 bb  |................|
+00000110  16 da 37 bb a4 ce 4e 6c  5f 88 41 f9 a2 90 9a 2d  |..7...Nl_.A....-|
+00000120  5c 14 d5 01 28 06 a9 20  a4 ae 92 17 c5 95 b1 dc  |\...(.. ........|
+00000130  02 a8 3f 3b a7 97 91 5a  4f 56 bb db b6 30 0d 80  |..?;...ZOV...0..|
+00000140  35 ac 91 6f 4f ba 1e 10  c6 fc d2 ca 96 e4 9d 1f  |5..oO...........|
+00000150  2f 29 00 3a 11 b7 77 dd  d5 ed 76 9f 67 a1 b1 0c  |/).:..w...v.g...|
+00000160  5d 34 34 eb 42 49 23 15  49 12 24 24 73 be a9 65  |]44.BI#.I.$$s..e|
+00000170  99 b6 b4 3f 18 0c d1 32  26 eb 86 93 5c 0e e8 06  |...?...2&...\...|
+00000180  fb d7 9f 0e d9 26 14 47  b8 e5 67 8c c8 cb 0c 55  |.....&.G..g....U|
+00000190  61 70 a9 ce 0d 4e bf ca  40 9c e7 0d 2b 5d 54 b7  |ap...N..@...+]T.|
+000001a0  5a 64 50 e6 a1 c9 fc 47  7d e7 0a 13 36 8d 70 eb  |ZdP....G}...6.p.|
+000001b0  68 65 e4 9b 9d 12 d1 d9  0d 32 72 59 0f 46 b2 e2  |he.......2rY.F..|
+000001c0  21 ab 13 d4 ab f3 6e b6  44 16 b8 85 bb dc f4 f7  |!.....n.D.......|
+000001d0  d6 ce 5c 9f c0 4c 28 8f  36 39 ec 29 c7 33 bd ea  |..\..L(.69.).3..|
+000001e0  2d 10 16 84 50 c5 18 5b  2c a3 99 bb 3b 0b 70 66  |-...P..[,...;.pf|
+000001f0  72 9a 83 01 06 2a bf 4a  60 c5 5d 41 a1 f0 92 bb  |r....*.J`.]A....|
+00000200  3b 2a 1a 41 3a 57 c3 22  13 2c b4 7b 3e 47 52 ea  |;*.A:W.".,.{>GR.|
+00000210  79 8a bf ef 2e 2c f7 89  c7 36 5a df 38 c2 04 b6  |y....,...6Z.8...|
+00000220  6f 96 cd 7c 01 b3 e3 cd  4a 83 56 40 06 58 8a 7c  |o..|....J.V@.X.||
+00000230  8c 75 df b6 b8 76 63 71  89 72 0a 64 de 23 7d 50  |.u...vcq.r.d.#}P|
+00000240  77 a8 f6 a0 81 9d e9 ed  81 5e 20 c8 9f 65 3c 95  |w........^ ..e<.|
+00000250  cf ed 99 80 71 06 5e 00  46 0d 0c 22 b3 88 f0 c5  |....q.^.F.."....|
+00000260  33 3e 13 6b f2 07 9c db  20 31 9c 8d ea d7 73 e8  |3>.k.... 1....s.|
+00000270  00 e1 2b f4 c8 d7 34 37  4a 98 b9 4d 28 db 15 8a  |..+...47J..M(...|
+00000280  af 53 14 3b 02 54 a3 0b  5f 10 ff 5d 20 1c 19 ae  |.S.;.T.._..] ...|
+00000290  6b 8a 99 a5 8f e0 ac dd  c1 ba 1f 85 56 a3 94 bc  |k...........V...|
+000002a0  79 03 5f d5 dd e1 8e 62  b7 82 fa 92 c3 d5 8a fc  |y._....b........|
+000002b0  6b 17 24 d9 af db 3d 9c  0f 51 82 3d a2 ec 5f 9c  |k.$...=..Q.=.._.|
+000002c0  dc 69 a5 ce db d8 8b 87  17 03 03 00 a3 69 cd 7b  |.i...........i.{|
+000002d0  9f ac ad 72 11 b2 5d ee  19 63 d0 35 12 6d 5e 3f  |...r..]..c.5.m^?|
+000002e0  81 a8 18 4a d4 09 f3 80  38 4a 31 08 3e a0 4c 78  |...J....8J1.>.Lx|
+000002f0  48 08 e9 90 ba e7 2a b4  73 2e 2b 2b 15 60 ce 09  |H.....*.s.++.`..|
+00000300  7d df 49 31 e1 9d ff 92  1d b4 af 2e 8c f8 a6 2e  |}.I1............|
+00000310  93 d7 b9 10 69 10 7f 04  0d 8d e2 37 09 a7 d0 2a  |....i......7...*|
+00000320  ac ea 51 49 50 1d 1c 54  7f b9 15 ad 8c 77 ef 1d  |..QIP..T.....w..|
+00000330  a6 59 a3 bf b2 53 f7 6c  21 92 e0 36 c5 0d 61 94  |.Y...S.l!..6..a.|
+00000340  be 61 5e 77 25 35 df e4  5f 67 c1 c6 af 51 e4 ce  |.a^w%5.._g...Q..|
+00000350  c4 28 c5 4e bc f6 c6 ba  32 dc 8e c7 45 f3 4d a1  |.(.N....2...E.M.|
+00000360  70 53 98 46 8f 39 c2 cc  b7 fc f7 24 11 97 72 b3  |pS.F.9.....$..r.|
+00000370  17 03 03 00 35 76 be b6  7a 3f e3 08 7a a2 65 25  |....5v..z?..z.e%|
+00000380  fd 0b c3 87 be ba eb ca  cb 3d c1 25 10 e0 7b 00  |.........=.%..{.|
+00000390  37 7a 52 9e d6 b2 e7 ba  8e 51 de 15 c4 e8 16 eb  |7zR......Q......|
+000003a0  c6 21 92 42 b1 62 f4 ce  27 ba 17 03 03 00 8b 54  |.!.B.b..'......T|
+000003b0  03 de d7 a7 85 2f 4b 23  2d d5 3a b4 3d 3d f6 00  |...../K#-.:.==..|
+000003c0  ac ab bd 6f dd bf 9f 24  fb 1b d4 01 39 3e c0 87  |...o...$....9>..|
+000003d0  bb 32 ca f6 61 b2 ef 5d  9c 2c 1b a5 10 66 7b fd  |.2..a..].,...f{.|
+000003e0  4b d0 03 dc 53 a9 0d 5a  d5 c4 4c 25 9c 55 e6 f8  |K...S..Z..L%.U..|
+000003f0  d1 d8 49 dc 36 a1 92 ae  f1 3e 2f 11 66 87 93 69  |..I.6....>/.f..i|
+00000400  24 2e 5d 6c f6 79 15 68  a8 99 2e 1a 9c e2 85 4e  |$.]l.y.h.......N|
+00000410  5f d6 a8 3c 70 e1 67 cb  df b2 1b ab 2b ed dc b6  |_..<p.g.....+...|
+00000420  64 f4 bc 22 35 20 7f ff  64 b3 be d9 eb a1 ab 5d  |d.."5 ..d......]|
+00000430  d9 3b ae 30 46 76 70 48  04 43                    |.;.0FvpH.C|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 ce a8 2f f5 d3  |..........5../..|
-00000010  71 48 2e a0 74 72 7d 21  9f a8 25 9b 72 be 57 8b  |qH..tr}!..%.r.W.|
-00000020  ee 41 bb 04 f1 dc 4c 2e  0d eb 38 36 75 74 86 19  |.A....L...86ut..|
-00000030  49 2c 82 db dc 39 ed ef  d5 b6 8b 80 bf 7d cb e7  |I,...9.......}..|
+00000000  14 03 03 00 01 01 17 03  03 00 35 46 8b fa 42 0d  |..........5F..B.|
+00000010  fa 3e 9e 80 76 12 ce 73  ae 85 67 ee af 1e 25 6e  |.>..v..s..g...%n|
+00000020  0b 46 4c bd 5a 46 8e 5c  27 7a 0a 8d d3 9c 3c 29  |.FL.ZF.\'z....<)|
+00000030  4c c8 08 78 ac 9f f4 7a  38 8d 49 6a 01 b6 f5 83  |L..x...z8.Ij....|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 3a 52 19  71 50 e3 78 6b e5 92 75  |.....:R.qP.xk..u|
-00000010  4d 27 97 32 08 4b c3 70  88 98 42 1b 86 2f 3f 28  |M'.2.K.p..B../?(|
-00000020  5a e3 20 17 03 03 00 13  e5 66 35 2a a5 13 b3 eb  |Z. ......f5*....|
-00000030  b6 1d 09 3a 40 87 ae cb  59 b5 7a                 |...:@...Y.z|
+00000000  17 03 03 00 1e c2 1a dc  0a cb 9a 11 f7 a1 c2 1f  |................|
+00000010  54 7d 32 6f 0e 13 b6 6b  9f e1 c6 14 63 fc 18 b9  |T}2o...k....c...|
+00000020  81 53 44 17 03 03 00 13  c9 72 ae 5e 2b c1 6f 64  |.SD......r.^+.od|
+00000030  e0 70 47 15 b1 ec c3 25  00 7f 4e                 |.pG....%..N|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-Ed25519 b/src/crypto/tls/testdata/Server-TLSv13-Ed25519
index a04a261989..dea3675272 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-Ed25519
+++ b/src/crypto/tls/testdata/Server-TLSv13-Ed25519
@@ -1,75 +1,75 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ca 01 00 00  c6 03 03 83 20 f5 18 94  |............ ...|
-00000010  f8 2b 08 2e 12 87 aa f2  7d 70 46 5e 4c 6f 97 1e  |.+......}pF^Lo..|
-00000020  06 76 8c da 47 b6 74 7f  d1 23 25 20 88 e1 e5 89  |.v..G.t..#% ....|
-00000030  f9 89 33 d1 3f 4a 91 44  92 c6 c9 3d a7 c3 5e d5  |..3.?J.D...=..^.|
-00000040  f5 6e 03 f6 60 35 14 37  0b 13 fc cd 00 04 13 03  |.n..`5.7........|
+00000000  16 03 01 00 ca 01 00 00  c6 03 03 08 d3 0c d5 aa  |................|
+00000010  d7 b1 55 99 bc fa a7 17  09 ed 93 47 96 44 70 28  |..U........G.Dp(|
+00000020  03 b7 c6 40 ee 98 fe 30  83 86 ea 20 d0 89 76 54  |...@...0... ..vT|
+00000030  87 71 b7 9c b7 fd f2 19  15 5f 3b 39 c9 ad 6b 97  |.q......._;9..k.|
+00000040  89 6e c4 69 cc 83 b1 f0  e7 94 68 85 00 04 13 03  |.n.i......h.....|
 00000050  00 ff 01 00 00 79 00 0b  00 04 03 00 01 02 00 0a  |.....y..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
-000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 cf  |-.....3.&.$... .|
-000000b0  4a bd a7 e4 06 16 75 b2  6d 35 73 89 32 64 14 ad  |J.....u.m5s.2d..|
-000000c0  bc ec e5 a1 e0 38 cd 5e  be 39 cc 28 83 b9 70     |.....8.^.9.(..p|
+000000a0  2d 00 02 01 01 00 33 00  26 00 24 00 1d 00 20 d8  |-.....3.&.$... .|
+000000b0  dc 54 00 21 d1 f5 6e 1b  fc a4 44 4e eb 97 4d 0f  |.T.!..n...DN..M.|
+000000c0  4a 5c ab 4c 27 72 23 69  72 7e 37 e8 bf 69 15     |J\.L'r#ir~7..i.|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 88 e1 e5 89  |........... ....|
-00000030  f9 89 33 d1 3f 4a 91 44  92 c6 c9 3d a7 c3 5e d5  |..3.?J.D...=..^.|
-00000040  f5 6e 03 f6 60 35 14 37  0b 13 fc cd 13 03 00 00  |.n..`5.7........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 d0 89 76 54  |........... ..vT|
+00000030  87 71 b7 9c b7 fd f2 19  15 5f 3b 39 c9 ad 6b 97  |.q......._;9..k.|
+00000040  89 6e c4 69 cc 83 b1 f0  e7 94 68 85 13 03 00 00  |.n.i......h.....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 66 f6 28 5f fd f8  |..........f.(_..|
-00000090  65 81 b4 8e c9 2f da 0e  9c e3 cd 5e 84 71 bd c2  |e..../.....^.q..|
-000000a0  6d 17 03 03 01 50 46 5f  19 37 71 b5 27 ba 85 69  |m....PF_.7q.'..i|
-000000b0  a6 6a d4 ec 6c 3b f0 f9  22 3c 24 2c 11 36 5f f3  |.j..l;.."<$,.6_.|
-000000c0  20 b5 e3 7b 70 60 62 77  21 db 02 49 e4 ec 2f 82  | ..{p`bw!..I../.|
-000000d0  0f 21 f8 b8 0b ec a4 bb  39 58 10 96 40 73 bf d8  |.!......9X..@s..|
-000000e0  79 3c 68 81 6f 4b 7d 1f  6f 6f 23 4f 7f 36 cb ee  |y<h.oK}.oo#O.6..|
-000000f0  21 a0 30 f4 2f ac 7b da  43 73 3d 8a 02 db 43 6d  |!.0./.{.Cs=...Cm|
-00000100  c3 b5 19 27 41 89 19 dd  42 84 89 bd 11 ff f7 c3  |...'A...B.......|
-00000110  d9 b9 32 b3 d1 67 55 6e  d2 d5 e5 a2 38 3b 93 04  |..2..gUn....8;..|
-00000120  db a9 49 92 d4 93 71 84  ff 28 a6 ee 97 cb 30 8a  |..I...q..(....0.|
-00000130  a8 59 a2 40 b3 48 3b 6e  cc f4 03 ea 87 e2 5b 30  |.Y.@.H;n......[0|
-00000140  0a d6 4d a5 29 4a ba 82  1d e9 24 63 f1 60 99 fa  |..M.)J....$c.`..|
-00000150  a3 dc 64 38 2f 57 53 09  95 a1 35 60 86 a8 f3 d1  |..d8/WS...5`....|
-00000160  8b 02 4f 14 b6 f2 3d 62  42 9a 57 fa c7 82 41 50  |..O...=bB.W...AP|
-00000170  95 a6 58 ff 05 bc ad 56  90 f7 53 0f a8 80 48 51  |..X....V..S...HQ|
-00000180  d0 84 c5 54 9b 25 3a 69  42 66 ef 57 89 26 cd db  |...T.%:iBf.W.&..|
-00000190  99 05 d4 61 80 9c a7 f1  bb 2c a4 e6 8a 3c c7 02  |...a.....,...<..|
-000001a0  58 4a 80 29 c8 bf 57 06  10 36 a2 79 39 6e 5f 03  |XJ.)..W..6.y9n_.|
-000001b0  aa 16 03 89 7f a5 4a 9e  0f ae 04 47 a8 23 4a e4  |......J....G.#J.|
-000001c0  1d ec 69 18 44 7f 8c 8d  be 46 31 90 9c b6 ce c3  |..i.D....F1.....|
-000001d0  22 28 8a 9f cb b9 ec dd  bc be 99 76 6d b3 1a 92  |"(.........vm...|
-000001e0  93 f9 36 90 d3 d9 ea 71  64 85 b8 d0 85 d3 71 a9  |..6....qd.....q.|
-000001f0  30 ae 65 0c ed 29 17 03  03 00 59 03 56 33 f0 f3  |0.e..)....Y.V3..|
-00000200  46 f3 5a b0 d3 78 90 16  2e d5 b8 72 ad bb f6 a3  |F.Z..x.....r....|
-00000210  48 ac 07 a3 dc 00 33 de  e8 b2 c3 6e 60 bd 2e f5  |H.....3....n`...|
-00000220  20 0f 6e c2 db f5 d0 4a  16 3b 62 3e bb 3b e7 21  | .n....J.;b>.;.!|
-00000230  b0 43 33 f1 87 5b f4 33  db ff 9a e4 c3 1c 1b 75  |.C3..[.3.......u|
-00000240  93 4a 82 4b ad 16 3c 02  75 4a 0d e9 f7 5f bb 88  |.J.K..<.uJ..._..|
-00000250  f2 44 9d 0f 17 03 03 00  35 a8 c0 b4 99 63 97 b9  |.D......5....c..|
-00000260  31 af e3 fb 40 6d 06 ec  c0 7e 7d df 91 b1 1c 38  |1...@m...~}....8|
-00000270  9e e4 4f d5 6f 9d 60 6f  76 23 4a a6 27 63 12 5a  |..O.o.`ov#J.'c.Z|
-00000280  7f 1c 70 c7 ca 28 dc ec  eb bd 0e e0 5d 49 17 03  |..p..(......]I..|
-00000290  03 00 88 7f 6b 85 c6 d7  cb 69 f4 93 88 6e 9c ce  |....k....i...n..|
-000002a0  74 12 2b cb 0e 9a b1 e3  f2 20 51 e9 a4 6b 43 47  |t.+...... Q..kCG|
-000002b0  f5 a4 9e 26 07 1d 10 75  3a f5 e8 74 c3 b7 5f b4  |...&...u:..t.._.|
-000002c0  4a 8f 70 48 cb bf 0b 2f  8b d1 14 ec 5b 21 05 49  |J.pH.../....[!.I|
-000002d0  ca 35 9f 3e b1 9c 85 b6  7a 05 96 97 b5 8f a0 5d  |.5.>....z......]|
-000002e0  57 14 00 80 f1 7e de 7a  6f 08 8d cb 2b b4 7e fe  |W....~.zo...+.~.|
-000002f0  f9 a1 eb b7 92 d3 05 bb  36 dc ec 01 c9 9e f8 51  |........6......Q|
-00000300  f6 d8 43 a2 4e d7 fb 4f  c6 14 6b 7f 21 6d a1 3b  |..C.N..O..k.!m.;|
-00000310  ac 2a 40 86 43 6e 38 8a  19 de c3                 |.*@.Cn8....|
+00000080  03 03 00 01 01 17 03 03  00 17 6a 47 be 2b 06 13  |..........jG.+..|
+00000090  cf 8b 2f c5 ee d5 b0 5b  c1 47 9a b2 5e a2 0d c5  |../....[.G..^...|
+000000a0  41 17 03 03 01 50 c0 1e  e0 f5 55 6e 92 52 99 d8  |A....P....Un.R..|
+000000b0  62 06 9a 59 c7 b0 d7 5e  c9 6d 76 a6 7a c9 55 fe  |b..Y...^.mv.z.U.|
+000000c0  83 d5 84 fc 3c f0 02 fe  0f f8 b4 2e a0 45 29 cd  |....<........E).|
+000000d0  37 ea 9d 2e 75 c4 06 1e  58 5f 21 31 4b 8c 5e 91  |7...u...X_!1K.^.|
+000000e0  83 c1 0d 2c 21 68 1b 05  85 d2 35 1c 36 ee 9c b2  |...,!h....5.6...|
+000000f0  14 52 49 d8 7f 59 80 9c  80 a3 d8 99 34 d4 5c 01  |.RI..Y......4.\.|
+00000100  03 6c 52 fe cf a0 0a 47  11 e8 45 7c 85 76 6e 6e  |.lR....G..E|.vnn|
+00000110  29 1f af b7 97 bb fd 52  bd 4d 0a 4d 53 04 db 01  |)......R.M.MS...|
+00000120  5c 63 da c6 5a 7c d4 d8  fb ab bf fb bd 6f 64 58  |\c..Z|.......odX|
+00000130  8b e4 91 48 16 20 06 ca  2a 1f 5e 1e 33 c3 e8 cb  |...H. ..*.^.3...|
+00000140  ab d6 98 25 a6 12 86 28  95 d4 0c 0d c7 1e e3 ba  |...%...(........|
+00000150  f5 78 f9 10 97 60 19 8c  43 90 f6 aa 4d df da 91  |.x...`..C...M...|
+00000160  89 63 f4 38 18 e6 70 42  66 be f2 ec d9 85 88 ad  |.c.8..pBf.......|
+00000170  59 c7 d1 57 3c 52 70 4a  d4 db c8 b4 2c 37 7b 61  |Y..W<RpJ....,7{a|
+00000180  a9 4f 6a 4f 4a 64 04 7a  61 2b 01 f3 eb f0 c9 6a  |.OjOJd.za+.....j|
+00000190  65 9f 67 e2 94 16 66 5f  4c 62 e8 17 38 18 17 0a  |e.g...f_Lb..8...|
+000001a0  e2 bc 75 cf 32 71 a2 ab  ae 2f 61 c9 a1 fa 59 1f  |..u.2q.../a...Y.|
+000001b0  3f 4e 67 4e 0e 44 22 8a  59 04 cb 8e b3 77 fa 3d  |?NgN.D".Y....w.=|
+000001c0  c9 60 90 73 91 f6 a6 91  33 88 0b eb 4f 0e 48 be  |.`.s....3...O.H.|
+000001d0  f7 6f 30 7f 17 4b d2 ec  6e 21 ec a6 24 9d f8 85  |.o0..K..n!..$...|
+000001e0  07 b2 b3 86 02 9f 27 b9  e5 26 c1 ae 54 1b d3 19  |......'..&..T...|
+000001f0  ea cc bb c0 d0 e5 17 03  03 00 59 e2 56 da fa 80  |..........Y.V...|
+00000200  90 07 f7 93 2e d9 16 e1  43 c6 bf 35 4c b2 1d 83  |........C..5L...|
+00000210  ca a3 03 b4 d5 e0 b6 bc  da b1 6f 91 a8 dc b5 a9  |..........o.....|
+00000220  1a 99 31 32 a8 61 d8 d2  2b 95 df 6f a3 64 6b 52  |..12.a..+..o.dkR|
+00000230  72 52 4f 7d f3 59 75 2f  36 4e 7f 91 59 50 69 95  |rRO}.Yu/6N..YPi.|
+00000240  70 51 d3 74 a9 a3 3f bd  9d 0c af 9a ec d3 a1 85  |pQ.t..?.........|
+00000250  38 24 8a 97 17 03 03 00  35 a9 9e 65 43 66 a2 22  |8$......5..eCf."|
+00000260  dc 0d f2 48 64 09 64 71  a8 e1 cb 2e b5 a1 f2 6a  |...Hd.dq.......j|
+00000270  d0 c9 fa 32 60 14 6a 74  3a 5e 77 67 5b 90 3d 69  |...2`.jt:^wg[.=i|
+00000280  2d 1c af e2 6d 9d 91 aa  d3 0d f9 33 a5 a5 17 03  |-...m......3....|
+00000290  03 00 8b 34 60 2b a5 83  76 9b 8d b9 3c 83 a1 8f  |...4`+..v...<...|
+000002a0  07 80 3c 47 11 3b 4a 98  ec ba 6a e9 f2 f9 44 f9  |..<G.;J...j...D.|
+000002b0  96 98 a5 23 c1 62 16 43  eb 8b 37 5d a0 87 7d 7c  |...#.b.C..7]..}||
+000002c0  13 07 67 e7 85 b3 da e3  99 58 db d6 6c 32 c4 a7  |..g......X..l2..|
+000002d0  60 f6 1c 7d a1 05 b5 97  9a cf 64 b3 28 09 00 b0  |`..}......d.(...|
+000002e0  af 3d 9f ce ac f5 c6 ac  01 d0 bb c0 30 d6 1a f6  |.=..........0...|
+000002f0  ec 70 d8 28 27 5a f0 24  c9 66 aa 56 59 64 7f f1  |.p.('Z.$.f.VYd..|
+00000300  b1 7c 66 2e 7d c4 01 08  47 da a3 99 98 8a b3 89  |.|f.}...G.......|
+00000310  4a 04 4b 84 ea 15 98 4e  fe 10 0f b9 27 0c        |J.K....N....'.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 5c 63 1e 5d 76  |..........5\c.]v|
-00000010  f9 43 ac 28 29 74 93 77  41 93 b7 49 28 4d 8e 75  |.C.()t.wA..I(M.u|
-00000020  1b 20 1f 9e 07 df 86 d1  68 40 25 8a 0f 64 a5 d6  |. ......h@%..d..|
-00000030  40 b2 fb 71 dc c0 b5 da  72 3c de ce 60 ec 03 6e  |@..q....r<..`..n|
+00000000  14 03 03 00 01 01 17 03  03 00 35 b0 21 d1 14 37  |..........5.!..7|
+00000010  3e 4f 3c 00 bf 99 4d da  f5 22 f8 ab d0 9b 0e 59  |>O<...M..".....Y|
+00000020  33 1c 21 44 53 cf c7 31  16 df 3f fb a7 e2 f6 32  |3.!DS..1..?....2|
+00000030  2c a6 c2 9f 35 d6 8a cc  0a 82 6c 46 c4 55 b1 a8  |,...5.....lF.U..|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 52 a3 e3  e2 0d 25 1d 5a ca 78 81  |.....R....%.Z.x.|
-00000010  fd 76 31 80 ad 64 68 f0  37 ee d1 79 08 fb bd 5f  |.v1..dh.7..y..._|
-00000020  17 6b 9b 17 03 03 00 13  a0 96 7b 45 15 de fd e0  |.k........{E....|
-00000030  b7 e6 71 c8 a7 6c e4 ed  fa 0e b2                 |..q..l.....|
+00000000  17 03 03 00 1e 0a 98 f1  c8 c1 dd 02 e9 bd b4 99  |................|
+00000010  80 aa dd 14 1d 2a 73 e2  20 e3 55 14 f8 5b c8 b6  |.....*s. .U..[..|
+00000020  55 98 73 17 03 03 00 13  e6 93 11 04 c5 32 15 7d  |U.s..........2.}|
+00000030  44 db bd 6c 6d 84 60 90  11 0c 52                 |D..lm.`...R|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-ExportKeyingMaterial b/src/crypto/tls/testdata/Server-TLSv13-ExportKeyingMaterial
index fa54af8208..0b4f8c0913 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-ExportKeyingMaterial
+++ b/src/crypto/tls/testdata/Server-TLSv13-ExportKeyingMaterial
@@ -1,98 +1,98 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ce 01 00 00  ca 03 03 00 68 6d 0f 70  |............hm.p|
-00000010  17 dc cd 3f 5d 61 e3 f2  f4 a5 60 60 f3 72 dc f1  |...?]a....``.r..|
-00000020  70 80 be dc 01 8f fa f2  5e 12 88 20 17 de 48 c7  |p.......^.. ..H.|
-00000030  7a 79 10 4f 06 41 9c d1  43 8f 8d 91 d3 f5 3d 34  |zy.O.A..C.....=4|
-00000040  b7 12 3b 70 c8 7a 34 54  ff b0 b6 17 00 04 13 03  |..;p.z4T........|
+00000000  16 03 01 00 ce 01 00 00  ca 03 03 4b 42 c7 99 9e  |...........KB...|
+00000010  1a 3d 10 18 84 4b 27 8e  b7 49 cd 95 34 42 54 6e  |.=...K'..I..4BTn|
+00000020  fa 08 92 9b 43 f5 ca b4  57 44 2b 20 2d 75 50 cf  |....C...WD+ -uP.|
+00000030  7c f7 1a 45 b0 6d a0 d9  29 ee ac 2c 1f c9 b3 96  ||..E.m..)..,....|
+00000040  2f ad 77 69 fc 92 65 75  af 9f ab da 00 04 13 03  |/.wi..eu........|
 00000050  00 ff 01 00 00 7d 00 0b  00 04 03 00 01 02 00 0a  |.....}..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 16 00 00 00 17  00 00 00 0d 00 1e 00 1c  |................|
 00000080  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000090  08 04 08 05 08 06 04 01  05 01 06 01 00 2b 00 03  |.............+..|
 000000a0  02 03 04 00 2d 00 02 01  01 00 33 00 26 00 24 00  |....-.....3.&.$.|
-000000b0  1d 00 20 23 cc ba ad 3f  d4 6d c0 24 6b 6b a3 af  |.. #...?.m.$kk..|
-000000c0  76 5c b2 a2 68 c2 cf 79  90 60 b3 39 3b 15 54 5d  |v\..h..y.`.9;.T]|
-000000d0  53 fe 1b                                          |S..|
+000000b0  1d 00 20 1c b6 f8 ed 5c  d6 4c 45 22 bb 99 6f e9  |.. ....\.LE"..o.|
+000000c0  f8 d8 78 d7 6f a3 28 4f  06 16 f9 18 64 6c 30 23  |..x.o.(O....dl0#|
+000000d0  8a a5 14                                          |...|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 17 de 48 c7  |........... ..H.|
-00000030  7a 79 10 4f 06 41 9c d1  43 8f 8d 91 d3 f5 3d 34  |zy.O.A..C.....=4|
-00000040  b7 12 3b 70 c8 7a 34 54  ff b0 b6 17 13 03 00 00  |..;p.z4T........|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 2d 75 50 cf  |........... -uP.|
+00000030  7c f7 1a 45 b0 6d a0 d9  29 ee ac 2c 1f c9 b3 96  ||..E.m..)..,....|
+00000040  2f ad 77 69 fc 92 65 75  af 9f ab da 13 03 00 00  |/.wi..eu........|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 41 8a 5f 39 44 06  |..........A._9D.|
-00000090  c3 ef e8 ca 07 6b da 3f  1b 3e ee 90 96 4b 8b a5  |.....k.?.>...K..|
-000000a0  ae 17 03 03 02 6d 32 3d  de 04 8c 16 7b b2 8f 50  |.....m2=....{..P|
-000000b0  69 1e b5 d5 43 09 a3 98  c7 89 34 bf ee 14 e5 3d  |i...C.....4....=|
-000000c0  61 98 04 9a a8 33 b8 f4  a2 0f 0f e0 dc 9a 54 92  |a....3........T.|
-000000d0  5c 75 19 62 90 26 91 3a  5c 6d 0b 8f 3d 7c e8 51  |\u.b.&.:\m..=|.Q|
-000000e0  e3 23 01 9f 71 c3 23 3d  fc 9b 1b db 36 ff 6b b4  |.#..q.#=....6.k.|
-000000f0  00 cc 31 a2 ce df 73 e1  db a4 1f 97 16 d5 47 b4  |..1...s.......G.|
-00000100  a0 a2 a3 d0 46 81 ee 45  d2 9a c6 b9 52 4c 54 21  |....F..E....RLT!|
-00000110  b8 0a 82 4a 1d b7 62 6d  2e b7 e6 c3 13 34 76 22  |...J..bm.....4v"|
-00000120  55 f2 f9 59 be 55 fc 91  22 a6 bd 80 04 bf 8f 5a  |U..Y.U.."......Z|
-00000130  20 ab d1 64 bd 73 13 5a  78 3b f7 eb 5f d5 28 08  | ..d.s.Zx;.._.(.|
-00000140  91 6f 57 c4 84 d9 b2 e6  af 23 c5 72 c9 4b 78 d1  |.oW......#.r.Kx.|
-00000150  25 03 d6 00 a5 18 5f 36  01 29 a1 cb e3 1d e8 ff  |%....._6.)......|
-00000160  bc 13 97 9e 1e 94 a6 22  b8 18 b1 43 ea 31 7b 06  |......."...C.1{.|
-00000170  70 98 0f fc 2a 1c 4c c7  49 2a f2 4a 52 3d 57 54  |p...*.L.I*.JR=WT|
-00000180  89 8a a5 5e f0 a6 af e4  1b cd a7 9e 11 46 ab 42  |...^.........F.B|
-00000190  41 21 4f 22 c2 43 55 1f  ce 75 63 a0 6c f5 ec 76  |A!O".CU..uc.l..v|
-000001a0  e0 75 96 7a 75 b2 a9 46  a5 95 d4 35 dd a7 9f b6  |.u.zu..F...5....|
-000001b0  0e 05 30 0c f5 39 11 7f  69 96 6b 97 bd b8 cd 76  |..0..9..i.k....v|
-000001c0  cf d1 90 f5 22 da 4c 54  1e ea c6 0d 2e c9 7c 67  |....".LT......|g|
-000001d0  b8 bd 01 4e f6 d6 61 f7  c3 52 7e d7 16 84 53 f6  |...N..a..R~...S.|
-000001e0  11 14 79 ec 9f 3f 20 39  4d a2 7c 62 85 80 ca b0  |..y..? 9M.|b....|
-000001f0  dd 20 b4 f7 6a ec e4 f9  ea 12 3d a3 1a 2c a9 a6  |. ..j.....=..,..|
-00000200  34 e8 5a df 5e 0a 17 53  22 a2 05 a8 67 83 95 4f  |4.Z.^..S"...g..O|
-00000210  df d6 27 87 41 e0 54 a3  6e ac f9 c0 b1 b0 92 c4  |..'.A.T.n.......|
-00000220  a3 f9 e8 66 33 ad af bb  6d b6 a9 b1 2e c3 ad ea  |...f3...m.......|
-00000230  d5 db 74 8d d7 a8 ad 6a  c5 cd e3 0a ef 6a 3b c5  |..t....j.....j;.|
-00000240  9b cc ba 7a 80 6e 19 62  f3 a4 0a 50 53 b3 54 e9  |...z.n.b...PS.T.|
-00000250  27 0f 04 df dc c0 29 a0  76 48 3b 83 4a ad c3 a1  |'.....).vH;.J...|
-00000260  eb 58 ce 89 83 aa d0 bf  a7 dc 8e 5f 63 c5 a1 7a  |.X........._c..z|
-00000270  de 9a 8a f1 42 4a a1 a2  a2 53 7e 0c 5f 51 80 42  |....BJ...S~._Q.B|
-00000280  41 b0 a9 21 5c 02 72 da  0b 6f c7 85 a6 55 1a 88  |A..!\.r..o...U..|
-00000290  aa a6 f8 2c ae 55 3e f8  b3 a6 40 01 52 0f 2c 0b  |...,.U>...@.R.,.|
-000002a0  cf 8a 08 41 17 58 7d 57  90 99 eb f1 c3 b3 28 e9  |...A.X}W......(.|
-000002b0  1f ed f9 91 31 08 9e ac  55 76 7b 7a a5 23 bb 79  |....1...Uv{z.#.y|
-000002c0  ef c1 61 3c eb bf 49 2d  d9 7e cd d4 86 bb 33 ff  |..a<..I-.~....3.|
-000002d0  79 74 be f7 4b 5b 56 c1  e0 46 25 fc 8e 43 7d 36  |yt..K[V..F%..C}6|
-000002e0  60 ec fe 6e a9 2f 57 ce  dc a2 1c da b1 ca a3 4c  |`..n./W........L|
-000002f0  3f 50 7d c3 c3 20 ae 1d  97 8c fe 49 d2 b7 83 ce  |?P}.. .....I....|
-00000300  b8 46 86 3e 76 cd ad 14  63 57 bf d8 c4 c3 fd ed  |.F.>v...cW......|
-00000310  73 13 51 17 03 03 00 99  f9 00 53 e7 39 73 f3 2c  |s.Q.......S.9s.,|
-00000320  1d b7 eb c7 22 8b b5 c5  fe ff 84 7a 9a 53 32 9e  |...."......z.S2.|
-00000330  63 04 06 43 db ef 29 d3  94 28 c9 f7 22 2d ba 34  |c..C..)..(.."-.4|
-00000340  b4 01 72 26 b8 30 16 69  4b f4 57 eb 33 b9 eb f9  |..r&.0.iK.W.3...|
-00000350  ec b2 3a 3c eb f9 60 46  58 57 85 7f 1c 67 9d 7e  |..:<..`FXW...g.~|
-00000360  12 13 ea 36 70 31 fb 2f  40 fe 8f 28 64 1e fe 96  |...6p1./@..(d...|
-00000370  46 29 17 af a9 4e de 60  9a 30 3c f5 5f 17 8f 03  |F)...N.`.0<._...|
-00000380  00 7b 88 21 67 da 7f d1  c3 b7 b6 10 07 da 58 6e  |.{.!g.........Xn|
-00000390  e9 2b 4f 29 b4 2b cf 80  0d d7 d6 d9 63 59 3d c8  |.+O).+......cY=.|
-000003a0  76 35 8f a0 2a f7 ad 36  d3 3f 50 32 e9 92 5d 3a  |v5..*..6.?P2..]:|
-000003b0  a8 17 03 03 00 35 8f dd  d3 b5 28 ed 74 8c 50 ef  |.....5....(.t.P.|
-000003c0  85 85 95 3f bd 6a 5a dc  47 ef f1 0a 02 5c 21 cf  |...?.jZ.G....\!.|
-000003d0  a6 7e 06 c8 58 37 27 7c  78 5b 34 99 2f ad 5e b0  |.~..X7'|x[4./.^.|
-000003e0  3a 35 98 97 70 e7 40 11  48 f7 0a 17 03 03 00 88  |:5..p.@.H.......|
-000003f0  95 0f e5 e8 80 1b 14 b6  51 18 70 51 76 2e 37 24  |........Q.pQv.7$|
-00000400  86 e3 45 63 0c 98 3f 24  26 07 7a 34 a7 74 2f cd  |..Ec..?$&.z4.t/.|
-00000410  0c 0a 23 5e a7 98 f0 fd  ea a0 38 d6 50 92 3f ab  |..#^......8.P.?.|
-00000420  86 48 71 87 0c d2 ee 12  7c fd 29 55 5a b9 c9 aa  |.Hq.....|.)UZ...|
-00000430  71 36 ef 2f ab af 45 df  bb 06 fb 68 10 1a 51 93  |q6./..E....h..Q.|
-00000440  8d 9a 54 7c 92 f1 7a eb  44 8c 46 c5 d0 35 6e 15  |..T|..z.D.F..5n.|
-00000450  a3 17 d5 7b 49 81 be 5b  e7 f2 ac fe da 18 5a 98  |...{I..[......Z.|
-00000460  9d 61 48 45 b5 d3 cb 74  d5 59 76 9d de 89 6e c6  |.aHE...t.Yv...n.|
-00000470  21 2a 61 aa 6e 8e 88 d7                           |!*a.n...|
+00000080  03 03 00 01 01 17 03 03  00 17 1b 8e de 2f c7 92  |............./..|
+00000090  de 8e 8c fa 0c 7a e5 1f  ee 4c 4c d9 42 de 76 3d  |.....z...LL.B.v=|
+000000a0  2f 17 03 03 02 6d e9 b0  9a 48 a0 96 b9 52 a1 88  |/....m...H...R..|
+000000b0  e4 03 62 85 7d 6b 08 37  dc 50 13 7d aa 99 ba 73  |..b.}k.7.P.}...s|
+000000c0  38 08 e8 64 cd 37 a4 44  9d 86 e3 5e 24 df d9 da  |8..d.7.D...^$...|
+000000d0  0a 3b 97 9c 30 37 d9 99  0f a6 17 ef 5a e7 1b e9  |.;..07......Z...|
+000000e0  f6 5e c3 2b fc cc 8c 98  b9 7e 5f de bb 3c 19 9a  |.^.+.....~_..<..|
+000000f0  59 75 e4 5e db 06 64 28  8d 26 88 41 b3 c2 2e 7f  |Yu.^..d(.&.A....|
+00000100  fd 17 78 79 a0 ab 9a 48  7e 3d ef 78 c0 f1 9c 96  |..xy...H~=.x....|
+00000110  b2 21 b1 a8 18 d2 69 25  ad 51 8c 48 0f 66 28 a5  |.!....i%.Q.H.f(.|
+00000120  cf 76 16 c3 68 17 d9 33  f2 1f 5c 5f a1 19 08 e8  |.v..h..3..\_....|
+00000130  77 da d0 e0 c0 dc 4a 77  78 65 d1 3a 36 60 d9 0b  |w.....Jwxe.:6`..|
+00000140  e9 f8 5e 4f 41 32 71 c4  a9 6c ca 29 da 25 ad 35  |..^OA2q..l.).%.5|
+00000150  da 14 79 21 6d cb 57 b8  49 03 59 d4 d8 8b 76 71  |..y!m.W.I.Y...vq|
+00000160  11 9d 5f 03 62 52 01 bb  69 77 45 19 ee 5b 11 8f  |.._.bR..iwE..[..|
+00000170  75 65 49 e4 df cd 87 7c  ab c9 7d 0c 1c ed b0 08  |ueI....|..}.....|
+00000180  c7 ba 08 2d a7 26 75 80  1d 1d 0c 7f 01 15 6f 82  |...-.&u.......o.|
+00000190  bf 5a a3 84 cd ac 91 56  cb d2 17 78 a5 b0 22 bf  |.Z.....V...x..".|
+000001a0  d2 f3 1e 9f 8f f7 66 b7  a0 ec 28 f1 c5 b6 4e 24  |......f...(...N$|
+000001b0  63 46 88 d2 7a 84 11 8e  ce 5d ab 5f e7 81 7d a5  |cF..z....]._..}.|
+000001c0  2f df f3 a6 2d 1f d9 e1  01 80 53 cf 4f 2c be bc  |/...-.....S.O,..|
+000001d0  dd 68 cf fe c1 ce 15 ed  7d 59 e2 48 57 ac c6 73  |.h......}Y.HW..s|
+000001e0  b0 70 68 d1 a3 9a b0 f2  e2 07 2c ae 8a 5f 04 e9  |.ph.......,.._..|
+000001f0  f2 f7 d8 d4 63 92 7d a1  bd 8b 57 61 1f 13 48 7e  |....c.}...Wa..H~|
+00000200  8a a2 5d 51 a8 fb 0a a7  02 73 c7 33 4b 9e 28 d5  |..]Q.....s.3K.(.|
+00000210  ea dd a5 84 21 c4 ba 0b  77 2c 08 f1 30 ff 92 9b  |....!...w,..0...|
+00000220  8b c3 17 db 08 15 b3 f7  7b 01 8b 2c a8 e1 a7 f6  |........{..,....|
+00000230  a3 73 3d 5f 03 13 b8 e8  8c 19 a1 d6 7f fd f7 9f  |.s=_............|
+00000240  37 ee ce f5 70 26 d2 18  39 54 c4 4e 4e e6 08 5d  |7...p&..9T.NN..]|
+00000250  6b 7f cc b4 68 78 50 75  e2 f1 ec 73 93 a3 12 7f  |k...hxPu...s....|
+00000260  e5 1a ec 55 f4 85 d0 10  12 29 fd b0 e1 3e d5 d1  |...U.....)...>..|
+00000270  a6 d1 25 48 01 45 82 ec  83 e0 83 29 7b 46 c7 a9  |..%H.E.....){F..|
+00000280  5c ca bf e9 28 f1 76 ef  c5 72 5f 92 41 84 0e 64  |\...(.v..r_.A..d|
+00000290  af 6f f4 94 23 0a b5 2d  8b 56 66 a8 6b bb 4f a9  |.o..#..-.Vf.k.O.|
+000002a0  90 b6 d5 0a ab 76 7e 18  5c 3f 67 d5 7b c2 01 80  |.....v~.\?g.{...|
+000002b0  ce c8 8e d4 cd 86 0b 90  84 3a 68 82 f4 46 bc 72  |.........:h..F.r|
+000002c0  91 aa 92 46 e8 40 3e 40  21 c9 6a e5 d6 5a b2 01  |...F.@>@!.j..Z..|
+000002d0  d0 ef a7 f1 4e f6 e6 32  0c e1 07 19 cc fb 6e ff  |....N..2......n.|
+000002e0  f7 53 35 81 4d 09 75 fb  42 42 41 18 8f be cf 71  |.S5.M.u.BBA....q|
+000002f0  43 20 e0 23 b6 39 1c ab  52 6e 8e bf b2 d3 59 16  |C .#.9..Rn....Y.|
+00000300  a8 15 d6 b7 cc cd ed 28  5a 8e de 64 ae 85 f5 0d  |.......(Z..d....|
+00000310  7f 58 66 17 03 03 00 99  51 80 02 3d be 7a 45 b3  |.Xf.....Q..=.zE.|
+00000320  c3 f6 68 39 59 03 7b 2e  0c b3 22 f1 b3 6e a6 b2  |..h9Y.{..."..n..|
+00000330  64 f4 c6 77 7b 38 e0 94  97 2c 69 5b 29 63 e2 6b  |d..w{8...,i[)c.k|
+00000340  d5 d4 d0 b4 c1 45 04 4c  c4 19 6d 75 fd ef 3a 77  |.....E.L..mu..:w|
+00000350  f2 81 e4 8d 51 97 11 6b  6c ce b7 7a 11 fd 71 f7  |....Q..kl..z..q.|
+00000360  ee 67 c6 83 27 31 39 1f  d4 d1 be b8 c2 06 11 e3  |.g..'19.........|
+00000370  34 36 ff f3 c7 e6 1d b5  87 6b cf 12 56 2c e8 03  |46.......k..V,..|
+00000380  83 bf 03 f8 57 fd 54 c7  32 19 b1 ba fe e4 58 05  |....W.T.2.....X.|
+00000390  77 6f 48 f4 af 2f 99 dd  47 a5 1a 30 17 2f 1d 25  |woH../..G..0./.%|
+000003a0  80 8c d7 cd 33 b7 db d0  9d 58 4c 5d ef 14 2f 7a  |....3....XL]../z|
+000003b0  f2 17 03 03 00 35 04 7f  e7 0b a2 30 a0 93 c2 f7  |.....5.....0....|
+000003c0  84 64 be 47 37 b0 46 8d  78 1b 69 b8 40 90 db 57  |.d.G7.F.x.i.@..W|
+000003d0  f9 e5 4e fa ba a4 3c 3e  af db 67 18 2c 5f 32 77  |..N...<>..g.,_2w|
+000003e0  88 1e 30 85 b4 c0 46 c9  5c 85 ef 17 03 03 00 8b  |..0...F.\.......|
+000003f0  a6 13 6e 2a 9f 36 5e 06  de 8a f8 95 68 0a 05 2b  |..n*.6^.....h..+|
+00000400  e7 e7 fa 1b 2c 69 0c 30  75 a1 81 5a e6 e6 ab c5  |....,i.0u..Z....|
+00000410  22 b0 7d e1 ba 4f d7 75  89 88 23 35 be 36 9d 64  |".}..O.u..#5.6.d|
+00000420  3e 16 8d 5f 42 0f 6f 9a  78 8f 45 df 21 3e 4b 34  |>.._B.o.x.E.!>K4|
+00000430  6c ae ea c6 4a 71 0b d8  fd 70 f3 ac ce 68 3d f8  |l...Jq...p...h=.|
+00000440  62 d4 86 1e ac 3f ab 7d  36 83 80 4f c6 be 54 b7  |b....?.}6..O..T.|
+00000450  c1 1e bd 82 ea ad 42 9a  f0 c8 79 77 24 27 dd 24  |......B...yw$'.$|
+00000460  68 b0 ca 17 a6 a2 14 2e  1f 57 54 d1 79 94 99 d3  |h........WT.y...|
+00000470  96 68 db c2 19 14 ce 89  04 c2 b8                 |.h.........|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 5f dc b6 6f 7e  |..........5_..o~|
-00000010  49 2b 63 c2 0b 75 1e d6  a7 46 65 89 45 57 75 29  |I+c..u...Fe.EWu)|
-00000020  2a 3f ee 04 02 33 86 d1  2e 45 5e b4 75 d3 25 10  |*?...3...E^.u.%.|
-00000030  0f 36 93 e2 a0 56 25 e1  7f 87 51 47 e7 95 32 df  |.6...V%...QG..2.|
+00000000  14 03 03 00 01 01 17 03  03 00 35 96 8c 0d e9 39  |..........5....9|
+00000010  98 d4 ed 41 d5 fe f8 55  00 51 f0 71 6c 12 ed bd  |...A...U.Q.ql...|
+00000020  13 40 7d 4e 85 ef 8b 88  80 88 c3 fd 55 41 cb 7f  |.@}N........UA..|
+00000030  d7 96 04 3d f0 d5 26 c7  92 0a 64 bf 59 18 2a bd  |...=..&...d.Y.*.|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 64 aa 8a  44 27 ca 16 eb 34 e1 e8  |.....d..D'...4..|
-00000010  5c 16 33 0d 2c 07 fc da  09 a4 42 7c 82 5e 2a 45  |\.3.,.....B|.^*E|
-00000020  99 cb ff 17 03 03 00 13  43 9a ef c9 81 15 1f de  |........C.......|
-00000030  23 99 63 50 fc a6 23 f5  40 2a 30                 |#.cP..#.@*0|
+00000000  17 03 03 00 1e 90 ae 0a  4e 61 d1 14 64 90 3b a0  |........Na..d.;.|
+00000010  cd 33 67 f7 87 e6 93 3d  41 18 81 66 0c b2 26 f0  |.3g....=A..f..&.|
+00000020  76 94 cd 17 03 03 00 13  ef 96 85 4e 34 8a 64 ed  |v..........N4.d.|
+00000030  5d 4a 58 e4 74 50 35 7c  47 a6 a5                 |]JX.tP5|G..|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-HelloRetryRequest b/src/crypto/tls/testdata/Server-TLSv13-HelloRetryRequest
index 8060908f44..55ecaf4056 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-HelloRetryRequest
+++ b/src/crypto/tls/testdata/Server-TLSv13-HelloRetryRequest
@@ -1,123 +1,123 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 c4 01 00 00  c0 03 03 0e 42 e7 db 7a  |............B..z|
-00000010  d4 c1 13 7a 84 6b ea d3  46 a2 de 28 40 73 48 96  |...z.k..F..(@sH.|
-00000020  9d 86 3a 10 44 f6 d9 b2  a9 0e cf 20 1a 9a 60 0d  |..:.D...... ..`.|
-00000030  4c 30 d3 36 a1 a0 63 d6  d1 d9 2a e9 2d 5a f3 7e  |L0.6..c...*.-Z.~|
-00000040  5a 01 50 12 b6 00 4d 71  c1 5c c8 b7 00 04 13 03  |Z.P...Mq.\......|
+00000000  16 03 01 00 c4 01 00 00  c0 03 03 53 14 36 0d 63  |...........S.6.c|
+00000010  da e2 6a da b6 ce ab a7  79 a4 49 94 af fc b3 cd  |..j.....y.I.....|
+00000020  18 bb c3 4e ca c2 40 07  01 2b 5c 20 90 fc 6b be  |...N..@..+\ ..k.|
+00000030  26 4f 94 c1 f7 06 e6 ae  e6 0f 67 2f c7 de b0 6b  |&O........g/...k|
+00000040  4a f8 9c a2 43 b6 64 62  08 27 0b 45 00 04 13 03  |J...C.db.'.E....|
 00000050  00 ff 01 00 00 73 00 0b  00 04 03 00 01 02 00 0a  |.....s..........|
 00000060  00 06 00 04 00 1d 00 17  00 16 00 00 00 17 00 00  |................|
 00000070  00 0d 00 1e 00 1c 04 03  05 03 06 03 08 07 08 08  |................|
 00000080  08 09 08 0a 08 0b 08 04  08 05 08 06 04 01 05 01  |................|
 00000090  06 01 00 2b 00 03 02 03  04 00 2d 00 02 01 01 00  |...+......-.....|
-000000a0  33 00 26 00 24 00 1d 00  20 4e f1 62 b8 a5 c2 4a  |3.&.$... N.b...J|
-000000b0  c7 c1 ff 89 d5 3f 1b 4f  6b 56 a5 e2 be 5d 07 ee  |.....?.OkV...]..|
-000000c0  a4 12 39 44 36 87 76 c0  66                       |..9D6.v.f|
+000000a0  33 00 26 00 24 00 1d 00  20 a5 12 8a 90 4d a6 20  |3.&.$... ....M. |
+000000b0  36 c8 47 e0 0e 02 2e c3  24 dd f0 33 b2 aa 57 54  |6.G.....$..3..WT|
+000000c0  9d e7 c4 d7 7a f1 42 12  0e                       |....z.B..|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 58 02 00 00  54 03 03 cf 21 ad 74 e5  |....X...T...!.t.|
 00000010  9a 61 11 be 1d 8c 02 1e  65 b8 91 c2 a2 11 16 7a  |.a......e......z|
-00000020  bb 8c 5e 07 9e 09 e2 c8  a8 33 9c 20 1a 9a 60 0d  |..^......3. ..`.|
-00000030  4c 30 d3 36 a1 a0 63 d6  d1 d9 2a e9 2d 5a f3 7e  |L0.6..c...*.-Z.~|
-00000040  5a 01 50 12 b6 00 4d 71  c1 5c c8 b7 13 03 00 00  |Z.P...Mq.\......|
+00000020  bb 8c 5e 07 9e 09 e2 c8  a8 33 9c 20 90 fc 6b be  |..^......3. ..k.|
+00000030  26 4f 94 c1 f7 06 e6 ae  e6 0f 67 2f c7 de b0 6b  |&O........g/...k|
+00000040  4a f8 9c a2 43 b6 64 62  08 27 0b 45 13 03 00 00  |J...C.db.'.E....|
 00000050  0c 00 2b 00 02 03 04 00  33 00 02 00 17 14 03 03  |..+.....3.......|
 00000060  00 01 01                                          |...|
 >>> Flow 3 (client to server)
 00000000  14 03 03 00 01 01 16 03  03 00 e5 01 00 00 e1 03  |................|
-00000010  03 0e 42 e7 db 7a d4 c1  13 7a 84 6b ea d3 46 a2  |..B..z...z.k..F.|
-00000020  de 28 40 73 48 96 9d 86  3a 10 44 f6 d9 b2 a9 0e  |.(@sH...:.D.....|
-00000030  cf 20 1a 9a 60 0d 4c 30  d3 36 a1 a0 63 d6 d1 d9  |. ..`.L0.6..c...|
-00000040  2a e9 2d 5a f3 7e 5a 01  50 12 b6 00 4d 71 c1 5c  |*.-Z.~Z.P...Mq.\|
-00000050  c8 b7 00 04 13 03 00 ff  01 00 00 94 00 0b 00 04  |................|
+00000010  03 53 14 36 0d 63 da e2  6a da b6 ce ab a7 79 a4  |.S.6.c..j.....y.|
+00000020  49 94 af fc b3 cd 18 bb  c3 4e ca c2 40 07 01 2b  |I........N..@..+|
+00000030  5c 20 90 fc 6b be 26 4f  94 c1 f7 06 e6 ae e6 0f  |\ ..k.&O........|
+00000040  67 2f c7 de b0 6b 4a f8  9c a2 43 b6 64 62 08 27  |g/...kJ...C.db.'|
+00000050  0b 45 00 04 13 03 00 ff  01 00 00 94 00 0b 00 04  |.E..............|
 00000060  03 00 01 02 00 0a 00 06  00 04 00 1d 00 17 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 1e 00 1c 04 03 05 03  |................|
 00000080  06 03 08 07 08 08 08 09  08 0a 08 0b 08 04 08 05  |................|
 00000090  08 06 04 01 05 01 06 01  00 2b 00 03 02 03 04 00  |.........+......|
 000000a0  2d 00 02 01 01 00 33 00  47 00 45 00 17 00 41 04  |-.....3.G.E...A.|
-000000b0  01 85 6b fe 83 76 ad 76  88 ef 72 10 ad 98 45 e2  |..k..v.v..r...E.|
-000000c0  ef a7 92 8e ff f4 e7 fc  21 b2 31 23 7e a9 4b 21  |........!.1#~.K!|
-000000d0  ec 8d 2d e7 c6 08 8c 22  14 46 ac 19 b9 20 94 44  |..-....".F... .D|
-000000e0  e5 97 c1 44 de 3a 0f 29  1e cc d6 fe 75 dc 38 aa  |...D.:.)....u.8.|
+000000b0  de 5f 45 a6 5a fb df 47  33 52 cf 63 63 b7 e2 c1  |._E.Z..G3R.cc...|
+000000c0  f0 ad 4e b7 a3 09 7a 83  cf 58 cb 26 98 51 59 ee  |..N...z..X.&.QY.|
+000000d0  9e 33 a4 39 0d 49 17 98  35 31 99 9c 5a 84 c8 e5  |.3.9.I..51..Z...|
+000000e0  8c d4 90 22 45 ef 65 3b  9d 85 0f 92 b0 ab 0e 8f  |..."E.e;........|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 9b 02 00 00  97 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 1a 9a 60 0d  |........... ..`.|
-00000030  4c 30 d3 36 a1 a0 63 d6  d1 d9 2a e9 2d 5a f3 7e  |L0.6..c...*.-Z.~|
-00000040  5a 01 50 12 b6 00 4d 71  c1 5c c8 b7 13 03 00 00  |Z.P...Mq.\......|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 90 fc 6b be  |........... ..k.|
+00000030  26 4f 94 c1 f7 06 e6 ae  e6 0f 67 2f c7 de b0 6b  |&O........g/...k|
+00000040  4a f8 9c a2 43 b6 64 62  08 27 0b 45 13 03 00 00  |J...C.db.'.E....|
 00000050  4f 00 2b 00 02 03 04 00  33 00 45 00 17 00 41 04  |O.+.....3.E...A.|
 00000060  1e 18 37 ef 0d 19 51 88  35 75 71 b5 e5 54 5b 12  |..7...Q.5uq..T[.|
 00000070  2e 8f 09 67 fd a7 24 20  3e b2 56 1c ce 97 28 5e  |...g..$ >.V...(^|
 00000080  f8 2b 2d 4f 9e f1 07 9f  6c 4b 5b 83 56 e2 32 42  |.+-O....lK[.V.2B|
 00000090  e9 58 b6 d7 49 a6 b5 68  1a 41 03 56 6b dc 5a 89  |.X..I..h.A.Vk.Z.|
-000000a0  17 03 03 00 17 a8 de 6f  11 6f 2f 27 1c 39 2f c3  |.......o.o/'.9/.|
-000000b0  a1 6e 13 22 55 dd 11 e7  cb 60 11 0c 17 03 03 02  |.n."U....`......|
-000000c0  6d 09 14 d7 cf 09 ad e5  7c 3b 58 4c 81 9c 93 69  |m.......|;XL...i|
-000000d0  bc 7c 9d 1c e6 cd 21 76  3d ac 19 0b 41 79 00 59  |.|....!v=...Ay.Y|
-000000e0  d9 4d a4 cb 59 41 9b 52  11 ba ca 52 bf f5 f4 99  |.M..YA.R...R....|
-000000f0  10 36 b0 3e 27 01 50 90  d7 3a ed 36 ba bb 54 51  |.6.>'.P..:.6..TQ|
-00000100  9e de 6f f7 5f c0 34 20  2b b7 d5 32 1a 97 98 b8  |..o._.4 +..2....|
-00000110  de 50 ab 3e 75 a7 23 31  76 b1 a1 30 49 79 89 e5  |.P.>u.#1v..0Iy..|
-00000120  37 b9 e4 ce f1 e9 c9 58  43 34 f9 45 e4 71 2b c3  |7......XC4.E.q+.|
-00000130  11 f5 2a 5d a7 ac 87 8a  e2 69 07 4f 49 d4 5f 2b  |..*].....i.OI._+|
-00000140  bf 2d 4c 8a f0 56 4c ae  a8 f1 b9 4a 15 eb 73 3f  |.-L..VL....J..s?|
-00000150  31 55 b9 45 51 af e3 8c  52 80 fa d8 f7 2d 05 28  |1U.EQ...R....-.(|
-00000160  75 19 31 c2 b7 5a b2 0e  c1 ff d3 fe f5 44 d6 d3  |u.1..Z.......D..|
-00000170  e5 e2 c3 4b 6d c9 2b 9b  1d f6 49 66 0d 6f 14 f3  |...Km.+...If.o..|
-00000180  37 8f 98 f6 13 36 3f c6  b0 6d 9f 71 8e 98 26 51  |7....6?..m.q..&Q|
-00000190  af 9b 6d 20 58 96 f5 c9  e6 6c cf 37 f0 80 5b b5  |..m X....l.7..[.|
-000001a0  7a 5f cf 92 e3 f5 bb 33  52 48 db dc c6 cf 03 8b  |z_.....3RH......|
-000001b0  03 55 35 49 16 e9 30 19  b6 3e 6a 88 69 d2 d2 8e  |.U5I..0..>j.i...|
-000001c0  59 ba 2b 89 8d fc 8e d7  b9 6d ab 15 31 a3 23 36  |Y.+......m..1.#6|
-000001d0  59 55 77 4b 69 52 3d d8  7e 62 bd c1 53 85 55 f9  |YUwKiR=.~b..S.U.|
-000001e0  a5 c3 f8 73 0f 60 87 12  8e 9d be 90 71 2d ea 8d  |...s.`......q-..|
-000001f0  d0 0a 0c 18 42 21 38 bf  58 66 c2 5f ad 73 b8 63  |....B!8.Xf._.s.c|
-00000200  c3 95 b3 52 de 98 7b 55  0a 62 e9 88 e7 20 9a 80  |...R..{U.b... ..|
-00000210  16 e1 52 a3 fc de cf 64  a1 cc 97 9a e9 2d 67 b2  |..R....d.....-g.|
-00000220  75 e4 5a 3b 7e a7 4d 06  aa 18 ce 3a b5 5b 73 f8  |u.Z;~.M....:.[s.|
-00000230  b1 97 69 e1 a6 a9 43 e8  70 67 4c 0c d8 8e 16 33  |..i...C.pgL....3|
-00000240  e0 65 36 8e d4 e2 2b ca  2e ee 03 7f 56 37 ad 92  |.e6...+.....V7..|
-00000250  b1 3e 6d 1b 70 59 0c 5b  39 df a9 4c 92 49 5e 4d  |.>m.pY.[9..L.I^M|
-00000260  cd 12 2d 77 7a e5 6b e8  3c f8 0b b3 06 14 57 b4  |..-wz.k.<.....W.|
-00000270  d9 66 fb a7 50 ee 91 6d  82 0a db 97 e5 b1 5e 3b  |.f..P..m......^;|
-00000280  13 d1 17 c6 74 80 b4 d7  eb 7f 48 8f 99 ca d2 23  |....t.....H....#|
-00000290  d0 de 2d dc d5 b8 9a 23  b7 66 2c 86 98 bf 93 b6  |..-....#.f,.....|
-000002a0  e0 78 8b ae 03 72 cb 44  af 15 21 c8 ba 8a 27 66  |.x...r.D..!...'f|
-000002b0  22 5a 1d 04 64 0e 59 ce  9b e7 96 96 1f 1f 57 05  |"Z..d.Y.......W.|
-000002c0  30 82 8f dd 7b 83 fc 92  70 55 7c a6 6d f7 78 a6  |0...{...pU|.m.x.|
-000002d0  2e 42 3d 54 05 87 e9 04  03 18 cc e5 a2 c7 70 01  |.B=T..........p.|
-000002e0  50 b3 a3 4b 35 4f d9 46  2b b4 aa 3f eb 97 80 67  |P..K5O.F+..?...g|
-000002f0  15 3a 85 d4 ad e2 26 40  41 b0 29 0b d2 1f b2 40  |.:....&@A.)....@|
-00000300  47 a4 b2 1c a6 57 3e ed  42 98 b1 2c 75 cd 05 0e  |G....W>.B..,u...|
-00000310  cc d1 aa 8d 13 0e f5 09  14 49 f9 62 69 9c 05 b9  |.........I.bi...|
-00000320  c1 5d b6 83 ff 42 62 21  e1 b9 5f 91 28 e9 17 03  |.]...Bb!.._.(...|
-00000330  03 00 99 21 30 ff 89 d2  2c 62 38 77 46 57 72 5f  |...!0...,b8wFWr_|
-00000340  4f 5e dc 6e b4 7c a5 c5  ce 17 0d 79 8e 55 04 94  |O^.n.|.....y.U..|
-00000350  23 a8 12 15 ff ec 3b dd  3c 6d f2 98 7c 65 2d 0f  |#.....;.<m..|e-.|
-00000360  4d 2c 6a 5a c2 b5 80 82  cf 81 0e 73 38 61 c9 e4  |M,jZ.......s8a..|
-00000370  00 d0 86 cf a2 b0 e6 e0  3d f5 77 9b 10 52 9c 4d  |........=.w..R.M|
-00000380  5f 1e 24 1d 98 bc eb 4b  0f f5 59 d1 06 9a 31 4c  |_.$....K..Y...1L|
-00000390  c1 95 1c 3d 12 68 ad 39  6e 03 c4 ac 20 10 c5 d0  |...=.h.9n... ...|
-000003a0  6c 62 68 28 db a7 e9 b0  7e 78 6d 01 4e 7e 13 ff  |lbh(....~xm.N~..|
-000003b0  a1 7e 19 8a 8f 28 3d 4f  71 98 e8 f6 5e 6c 5d 50  |.~...(=Oq...^l]P|
-000003c0  3c 50 eb 8a df 4f cd e7  6e 6f 4e ac 17 03 03 00  |<P...O..noN.....|
-000003d0  35 f3 82 05 48 c6 84 01  89 0d 6f 97 b0 8c 0b ee  |5...H.....o.....|
-000003e0  f4 1a 52 84 2d 02 51 38  6d ca 44 25 0e 10 1d 79  |..R.-.Q8m.D%...y|
-000003f0  e3 76 27 63 45 b5 6c 58  be 72 e6 0e 78 b7 14 1c  |.v'cE.lX.r..x...|
-00000400  72 35 f0 57 cc 3c 17 03  03 00 88 67 19 26 3d 1d  |r5.W.<.....g.&=.|
-00000410  94 84 4b 65 73 b5 5e 3e  53 c2 31 13 03 d9 7a ef  |..Kes.^>S.1...z.|
-00000420  08 d6 30 1a 5d c2 8b ab  1c eb a4 f9 c9 0c 6b 03  |..0.].........k.|
-00000430  a1 ac 53 de 55 a9 1f bd  d5 f8 1f cb f8 3b db fd  |..S.U........;..|
-00000440  37 e0 23 09 2a 11 ac b9  51 dc 25 39 8c da 59 46  |7.#.*...Q.%9..YF|
-00000450  89 b2 47 d3 34 18 af 0c  a1 ba 43 84 7c 76 8d 3f  |..G.4.....C.|v.?|
-00000460  68 85 3e 50 39 80 54 80  4e 01 2c f7 55 3e 95 c2  |h.>P9.T.N.,.U>..|
-00000470  c0 9e bd cb 6b 1b 08 95  a5 0f ac c2 24 84 9a 03  |....k.......$...|
-00000480  2c 20 f2 a0 de a2 ad c6  1c 92 fa 75 43 f0 6c ca  |, .........uC.l.|
-00000490  68 b9 8d                                          |h..|
+000000a0  17 03 03 00 17 41 5e 1d  29 7e 4d ad 56 1c e4 42  |.....A^.)~M.V..B|
+000000b0  9d 99 61 93 95 d3 7a 1c  9c b0 1b ba 17 03 03 02  |..a...z.........|
+000000c0  6d 62 fd b6 84 db 87 5f  ec 30 bc df 0c 5d b7 f9  |mb....._.0...]..|
+000000d0  58 6b 7e ce 19 54 a9 0c  3f 66 f6 23 b6 36 19 a9  |Xk~..T..?f.#.6..|
+000000e0  ba e2 44 28 70 b9 35 14  fe 33 50 64 30 dd b1 35  |..D(p.5..3Pd0..5|
+000000f0  9c e5 f6 f5 66 09 be 05  82 c8 9c 7a 28 d1 6a 3d  |....f......z(.j=|
+00000100  31 a3 9d 0b 5a 1c 9e f1  77 c8 be eb 71 a7 9d 63  |1...Z...w...q..c|
+00000110  20 18 ef 97 4b fb 60 4d  2f 31 49 b2 1c 47 30 eb  | ...K.`M/1I..G0.|
+00000120  80 c1 e6 28 e0 67 a8 1b  8f 79 9f 40 ca 97 bd d9  |...(.g...y.@....|
+00000130  b9 cc 55 56 00 32 8d 76  76 88 be 62 42 e9 2f 53  |..UV.2.vv..bB./S|
+00000140  9b ab 56 98 e6 03 15 17  1a 2b 70 50 8a d8 ba 9d  |..V......+pP....|
+00000150  ab 5a ea 68 ec 98 7a f5  c1 9b 21 f8 f3 0b 5d a3  |.Z.h..z...!...].|
+00000160  7a 70 ae ff 67 e0 e8 2d  97 e5 72 d7 c4 27 9b 8d  |zp..g..-..r..'..|
+00000170  f8 47 dd 9e 15 2a 1e 38  eb 82 24 e5 85 55 ec a4  |.G...*.8..$..U..|
+00000180  22 ee 1f 9d c2 f3 1c 47  7a 26 0b 1a 4b d8 e4 58  |"......Gz&..K..X|
+00000190  ad b2 99 72 5b f8 97 33  f6 26 58 e3 58 1e 66 12  |...r[..3.&X.X.f.|
+000001a0  51 ba dc 66 bb c7 7d af  90 4b c2 79 2c b3 d8 34  |Q..f..}..K.y,..4|
+000001b0  2a d2 6b 37 71 88 e0 4a  c3 16 50 81 21 e1 a7 6d  |*.k7q..J..P.!..m|
+000001c0  42 e7 f5 86 7e b3 4b b8  9d bb dc 49 7d ce 6c 98  |B...~.K....I}.l.|
+000001d0  fd 87 2e fc 1a 17 34 12  90 a0 bc 06 46 7b e9 0b  |......4.....F{..|
+000001e0  d3 aa f7 77 30 43 6e 5f  4e fa e3 b1 a6 c8 80 47  |...w0Cn_N......G|
+000001f0  16 71 a0 bc 9e d3 89 14  49 ca 9a 87 8b b0 3b c7  |.q......I.....;.|
+00000200  a7 f4 6d 2a cb 0a 5e 8a  e5 f1 45 65 e4 51 da b1  |..m*..^...Ee.Q..|
+00000210  5c e2 88 90 46 e7 cb 01  0b 99 64 fe 5b b4 b3 e6  |\...F.....d.[...|
+00000220  aa 6f 59 25 25 79 2b 8e  6b 59 65 15 51 a1 8f a2  |.oY%%y+.kYe.Q...|
+00000230  f5 cd db df 63 fb 86 72  a5 9d 6c 7d b9 a0 e9 d5  |....c..r..l}....|
+00000240  c7 79 ca f1 3f c3 ed 72  29 3c 58 ed bd 4e 3a 27  |.y..?..r)<X..N:'|
+00000250  2c 40 34 82 47 62 3d bb  5a 90 70 cb 33 f6 f3 31  |,@4.Gb=.Z.p.3..1|
+00000260  3d 49 5f 9c 7e 21 7e cc  9b 09 38 3c e5 33 9f 11  |=I_.~!~...8<.3..|
+00000270  2e eb a0 d6 df cd 86 ef  3c 6d b8 d4 5c 8b b4 ce  |........<m..\...|
+00000280  8a f4 ef f8 78 5e ad c2  ea 52 ed 30 a2 4c 50 d2  |....x^...R.0.LP.|
+00000290  8a 4e 9e 1b 2a e6 04 86  e2 b8 84 f3 fe 6e 34 78  |.N..*........n4x|
+000002a0  28 fb 97 d7 30 66 a7 20  57 c1 ca e4 0c 7f a0 2c  |(...0f. W......,|
+000002b0  4e e1 87 ee 3f cc fe 18  a7 49 a7 70 45 94 73 8c  |N...?....I.pE.s.|
+000002c0  66 b8 b1 54 58 1a 39 3d  16 40 da e5 e5 51 c6 07  |f..TX.9=.@...Q..|
+000002d0  bc 30 ff 6a 66 3c bf 92  bc 0c 5c b5 c8 b9 55 6b  |.0.jf<....\...Uk|
+000002e0  26 f3 cd 4c ab 40 05 f5  8e 8d f8 55 b1 90 6a 93  |&..L.@.....U..j.|
+000002f0  d3 74 72 54 26 c0 1d 56  26 15 4c cf 63 4e 51 8c  |.trT&..V&.L.cNQ.|
+00000300  6f 92 85 8c 24 78 1e 8f  c4 cd 13 6b 42 6f 58 9a  |o...$x.....kBoX.|
+00000310  77 da 6c 73 1f dc 03 ff  33 9c d9 66 af 06 1d 1a  |w.ls....3..f....|
+00000320  fe 6f 13 3a 83 b2 dc ac  01 b4 e6 ca 5c 9e 17 03  |.o.:........\...|
+00000330  03 00 99 d2 6f 24 aa 51  a7 3d 2d fa 18 57 8e 7c  |....o$.Q.=-..W.||
+00000340  43 4f da 6c 31 97 bb d7  6f 64 2a db 7c 76 41 11  |CO.l1...od*.|vA.|
+00000350  cc e9 0f ea e8 03 99 49  4e c4 2c 43 36 54 b9 61  |.......IN.,C6T.a|
+00000360  af d1 56 00 9a e4 f2 c2  6d cf e9 25 32 f5 34 b6  |..V.....m..%2.4.|
+00000370  08 45 0f 43 71 6f 88 3f  7a 07 68 0b 91 fd 15 c3  |.E.Cqo.?z.h.....|
+00000380  43 8a 9d c3 bf f9 56 3c  3d 07 62 d0 94 11 14 95  |C.....V<=.b.....|
+00000390  63 27 28 d2 94 07 ff 1f  2b 99 76 a8 03 b4 8b 8f  |c'(.....+.v.....|
+000003a0  dd 56 d9 55 5d 4a 47 bf  77 25 eb 6a 2a ee 1c ea  |.V.U]JG.w%.j*...|
+000003b0  e9 58 0b 17 a5 56 99 d7  b6 9e 2a 4e 9a e4 07 68  |.X...V....*N...h|
+000003c0  dd df ce fc 8f 16 66 c1  4f f7 4b 20 17 03 03 00  |......f.O.K ....|
+000003d0  35 f6 71 3a 27 56 09 70  a2 dd 9d 5e 24 09 54 ce  |5.q:'V.p...^$.T.|
+000003e0  f3 6d f1 74 49 48 3e 2f  72 73 88 c7 fc 29 ec 3f  |.m.tIH>/rs...).?|
+000003f0  fa 0f 96 72 46 7d 6b 2f  ed 23 63 75 b7 26 f2 ea  |...rF}k/.#cu.&..|
+00000400  77 0f 3a 68 1e ee 17 03  03 00 8b b0 54 d9 ec c4  |w.:h........T...|
+00000410  44 cb e4 f6 f2 cb 66 31  c7 d8 ef 45 bf 9c 03 c4  |D.....f1...E....|
+00000420  7c 3f 91 e1 cf e8 c6 e5  a8 12 f1 e0 72 6b a2 9a  ||?..........rk..|
+00000430  f7 73 3d 13 3d 30 91 54  27 02 f7 ab a3 7e bb 5f  |.s=.=0.T'....~._|
+00000440  21 a6 fa 09 98 39 7f 99  13 5a c5 c5 6c 7b d2 91  |!....9...Z..l{..|
+00000450  7c de 26 88 b9 17 bd b9  b2 9a 7c 01 35 ad 7b 3b  ||.&.......|.5.{;|
+00000460  3d 15 33 9e 78 ea a1 df  94 80 fa e4 59 ef 49 06  |=.3.x.......Y.I.|
+00000470  31 41 8a 83 e9 98 37 e6  5a 69 f9 0a 7d 63 8e 6a  |1A....7.Zi..}c.j|
+00000480  9c bd 5b d4 69 72 3d 82  c9 c0 11 d6 68 13 17 9d  |..[.ir=.....h...|
+00000490  0e 32 48 bf 33 ab                                 |.2H.3.|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 35 88 fe 3c  5c 10 51 d0 51 ac 6e 68  |....5..<\.Q.Q.nh|
-00000010  0e 31 02 6b c8 14 8c 0f  23 b5 4b 7e 8d d8 b5 3c  |.1.k....#.K~...<|
-00000020  2b d2 e6 a0 40 ff 4a 39  74 b0 ae ae 32 45 fb f5  |+...@.J9t...2E..|
-00000030  ba e2 c2 d1 54 9b 3a 92  7a fc                    |....T.:.z.|
+00000000  17 03 03 00 35 c6 da dd  4b 11 a3 87 cd fd f9 99  |....5...K.......|
+00000010  a6 0b 76 c0 00 89 e1 87  d1 2c 43 0b f1 74 e5 60  |..v......,C..t.`|
+00000020  49 94 5f d2 d9 b5 0b bd  6c d8 2c 84 4d 4f da 43  |I._.....l.,.MO.C|
+00000030  f0 33 dd 54 bd 0c d9 f2  71 82                    |.3.T....q.|
 >>> Flow 6 (server to client)
-00000000  17 03 03 00 1e 0e b6 65  05 a3 d1 e9 2d 24 6f 4e  |.......e....-$oN|
-00000010  6e a4 b2 c0 71 8f 0c 84  5c da 0e ef 5a b2 69 fa  |n...q...\...Z.i.|
-00000020  e3 3e f7 17 03 03 00 13  f1 ee 61 6f 44 36 67 38  |.>........aoD6g8|
-00000030  27 da 81 84 a8 bc 30 0a  66 43 c1                 |'.....0.fC.|
+00000000  17 03 03 00 1e 6d f2 53  68 26 89 6e 4a 66 6a a9  |.....m.Sh&.nJfj.|
+00000010  12 9e 89 f0 be eb ff ed  b4 f0 ca f2 b8 7a b2 5e  |.............z.^|
+00000020  98 50 cb 17 03 03 00 13  ab 2b 9c 98 f0 1b 5c a2  |.P.......+....\.|
+00000030  f3 b2 a1 16 e0 74 eb 02  c4 7d d5                 |.....t...}.|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-IssueTicket b/src/crypto/tls/testdata/Server-TLSv13-IssueTicket
index 10eb9b681e..7fe5184f1e 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-IssueTicket
+++ b/src/crypto/tls/testdata/Server-TLSv13-IssueTicket
@@ -1,98 +1,98 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ce 01 00 00  ca 03 03 07 23 3a e5 63  |............#:.c|
-00000010  60 e1 82 c4 e5 9a 0d 18  18 e2 ad 1d 8a dc 56 71  |`.............Vq|
-00000020  73 dc 71 42 73 a0 63 ff  9d 38 7f 20 fe c1 c3 cd  |s.qBs.c..8. ....|
-00000030  dc 91 6a 6f 77 21 d6 bc  c4 ee 89 50 aa 57 51 ce  |..jow!.....P.WQ.|
-00000040  cd 07 9e 89 b4 b3 da 87  4e f5 c7 fc 00 04 13 01  |........N.......|
+00000000  16 03 01 00 ce 01 00 00  ca 03 03 9b 80 62 b8 bb  |.............b..|
+00000010  fc 09 cc 19 31 91 f7 4b  8a e8 fc 69 45 33 bd 64  |....1..K...iE3.d|
+00000020  8c 88 6e 07 0d 33 e7 f2  ce 4b 46 20 81 23 01 a2  |..n..3...KF .#..|
+00000030  64 c3 6d 55 ee 3c f1 c5  16 48 cb a7 61 fe 15 57  |d.mU.<...H..a..W|
+00000040  fa 9e 36 f2 ad 5b 19 2e  73 b9 8f 57 00 04 13 01  |..6..[..s..W....|
 00000050  00 ff 01 00 00 7d 00 0b  00 04 03 00 01 02 00 0a  |.....}..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 16 00 00 00 17  00 00 00 0d 00 1e 00 1c  |................|
 00000080  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000090  08 04 08 05 08 06 04 01  05 01 06 01 00 2b 00 03  |.............+..|
 000000a0  02 03 04 00 2d 00 02 01  01 00 33 00 26 00 24 00  |....-.....3.&.$.|
-000000b0  1d 00 20 bc f5 59 03 ee  1b 97 0e 81 f8 72 8f 58  |.. ..Y.......r.X|
-000000c0  de 53 56 44 f8 cd 45 d0  34 f6 fa e8 26 3f ed 36  |.SVD..E.4...&?.6|
-000000d0  38 46 7d                                          |8F}|
+000000b0  1d 00 20 e2 26 c1 8e 1b  73 8a e1 ec 95 a0 01 1a  |.. .&...s.......|
+000000c0  15 98 9d a2 d0 ac 02 4d  14 a9 8d 42 3a 68 e6 d2  |.......M...B:h..|
+000000d0  9f 09 49                                          |..I|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 fe c1 c3 cd  |........... ....|
-00000030  dc 91 6a 6f 77 21 d6 bc  c4 ee 89 50 aa 57 51 ce  |..jow!.....P.WQ.|
-00000040  cd 07 9e 89 b4 b3 da 87  4e f5 c7 fc 13 01 00 00  |........N.......|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 81 23 01 a2  |........... .#..|
+00000030  64 c3 6d 55 ee 3c f1 c5  16 48 cb a7 61 fe 15 57  |d.mU.<...H..a..W|
+00000040  fa 9e 36 f2 ad 5b 19 2e  73 b9 8f 57 13 01 00 00  |..6..[..s..W....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 0c c0 99 e8 94 19  |................|
-00000090  4f be f0 bf b7 d3 fd ea  83 cd 98 03 a6 44 d3 ab  |O............D..|
-000000a0  5b 17 03 03 02 6d fb b8  5b 40 c5 8a c4 b4 05 01  |[....m..[@......|
-000000b0  fa 87 8d 7a 80 91 ea 19  03 ce 6c 87 09 95 89 c9  |...z......l.....|
-000000c0  5a f4 c2 d1 14 ff e0 4d  57 a4 81 d6 b9 17 66 72  |Z......MW.....fr|
-000000d0  d2 9d c3 bd 7a fa c2 67  c1 3b 0b bb 17 e3 c7 87  |....z..g.;......|
-000000e0  b8 2a a5 f1 93 bc 73 e0  c2 43 57 2e 8b ed 4a 94  |.*....s..CW...J.|
-000000f0  9f bf bc ad d5 b7 5f 9e  55 67 7c 39 85 12 4d 3a  |......_.Ug|9..M:|
-00000100  cf 43 a4 7f bb 27 3b 6f  fe a6 89 f1 4d da 4a 3e  |.C...';o....M.J>|
-00000110  0f 1e d9 11 d6 d5 73 4b  75 58 57 37 73 d2 ef 02  |......sKuXW7s...|
-00000120  06 82 9b 03 3b 87 af 4d  c5 b3 eb 72 55 c4 86 2a  |....;..M...rU..*|
-00000130  cc 80 3d 2f 74 5c 11 41  b2 c1 62 d1 1e b7 4e 38  |..=/t\.A..b...N8|
-00000140  d7 82 81 b1 f7 17 0b 65  8d 2d de 21 21 e8 ea 49  |.......e.-.!!..I|
-00000150  c9 71 69 03 e1 a8 bb 1a  d3 b7 b7 d9 e6 5f 3f 46  |.qi.........._?F|
-00000160  89 83 69 f5 b4 9a e9 4d  45 a9 da 42 d6 26 81 88  |..i....ME..B.&..|
-00000170  10 24 e7 74 b1 85 e9 88  a8 38 43 89 d9 23 2a e1  |.$.t.....8C..#*.|
-00000180  25 59 2e 6e 62 f8 c3 00  e4 21 7a 9e b4 b6 c5 de  |%Y.nb....!z.....|
-00000190  28 4c d1 47 d8 1a 15 df  bb 37 eb 68 82 7c de 28  |(L.G.....7.h.|.(|
-000001a0  44 43 81 a8 f0 cc 63 53  b3 51 81 d4 cd 6f 22 2a  |DC....cS.Q...o"*|
-000001b0  6e cd 6d 0a 52 34 49 da  4d d5 05 6c f1 80 11 c9  |n.m.R4I.M..l....|
-000001c0  43 65 db f8 9d 96 90 f0  b1 f9 08 a6 ce 27 da 62  |Ce...........'.b|
-000001d0  9f 19 e4 24 76 5d 7d c9  2b e8 1d e5 90 66 52 70  |...$v]}.+....fRp|
-000001e0  42 20 44 a4 23 8e 07 66  b9 69 44 35 ce 7d 41 ea  |B D.#..f.iD5.}A.|
-000001f0  8b 3b 68 09 4d 91 c1 2c  d4 24 e6 ec e2 24 34 52  |.;h.M..,.$...$4R|
-00000200  97 80 79 d8 d8 97 f1 b9  59 bc 07 91 6f 39 fa c9  |..y.....Y...o9..|
-00000210  de 91 cf ce a4 00 1e b9  62 91 72 71 ef 33 c1 cd  |........b.rq.3..|
-00000220  46 c0 17 e0 a2 00 ab 54  dd 77 20 16 ce fa 91 9b  |F......T.w .....|
-00000230  f6 25 03 c3 94 b4 22 f1  22 13 9e 91 7b d0 9e 47  |.%...."."...{..G|
-00000240  1c 42 38 c5 ff 56 40 f6  54 cd bb 11 b9 b4 2b 7b  |.B8..V@.T.....+{|
-00000250  9a b8 2c 65 c4 d2 c5 81  8d ad fa ae e1 67 33 cc  |..,e.........g3.|
-00000260  98 4f 60 2d 36 9e fb b6  ef fb 3e e5 a7 37 5a ac  |.O`-6.....>..7Z.|
-00000270  c0 ea 02 89 96 e1 3e 59  4f 8e 34 7f 71 26 e2 8f  |......>YO.4.q&..|
-00000280  c5 f4 96 3c 50 62 1e b0  7a 6f e7 8a cd 77 69 f1  |...<Pb..zo...wi.|
-00000290  8f 97 ee c5 1a 0c ef 0f  3d e6 39 19 8b 07 5a 5d  |........=.9...Z]|
-000002a0  eb ec 97 f4 8e 32 74 b8  82 73 2c 4c c0 dd b4 15  |.....2t..s,L....|
-000002b0  90 03 74 84 8f d0 ce cc  54 75 ce 20 45 15 43 7d  |..t.....Tu. E.C}|
-000002c0  35 59 22 d7 cb 92 1c eb  f4 27 3c 10 e8 92 57 c3  |5Y"......'<...W.|
-000002d0  3a 55 87 6b 2b f3 3e a2  d6 5a 6f ca 07 0b 38 bd  |:U.k+.>..Zo...8.|
-000002e0  2b a1 a9 f4 e2 ec c3 0d  62 a8 75 31 52 27 97 30  |+.......b.u1R'.0|
-000002f0  4a 35 50 df f8 61 65 74  95 09 47 3e 22 eb bd 68  |J5P..aet..G>"..h|
-00000300  12 d5 ab 4b f7 4e 2e b1  c3 90 5f 47 96 3d 84 c6  |...K.N...._G.=..|
-00000310  9a a9 68 17 03 03 00 99  9e 63 9e 0c 56 07 57 b6  |..h......c..V.W.|
-00000320  1d 97 51 0d e1 e9 88 df  9f b9 b2 ff cb 07 f7 b9  |..Q.............|
-00000330  3a ad a2 f3 02 f8 88 b1  f1 3a 2a 06 6d 7e 26 93  |:........:*.m~&.|
-00000340  52 2b bd c0 06 39 fc ac  ee 69 70 b3 2a 53 42 ec  |R+...9...ip.*SB.|
-00000350  f1 2e a1 d9 6b 4f a3 bb  39 a1 cd 96 24 24 44 f6  |....kO..9...$$D.|
-00000360  13 88 0b de 69 73 c4 c3  23 3f 00 f4 25 29 92 aa  |....is..#?..%)..|
-00000370  2e 3f fa 7f ec b3 2b b9  cd 67 db 1d d7 20 e6 6d  |.?....+..g... .m|
-00000380  db af 0d 37 61 62 eb b3  57 26 14 0a f7 fd 61 78  |...7ab..W&....ax|
-00000390  44 69 62 63 b8 6f 8b 0f  78 0d 91 87 0e 9e ac 0e  |Dibc.o..x.......|
-000003a0  e5 ad 7c 03 e1 c4 7e 91  10 25 79 f5 26 ab 87 3d  |..|...~..%y.&..=|
-000003b0  4e 17 03 03 00 35 63 46  7f ea 3c 99 0c 75 49 bc  |N....5cF..<..uI.|
-000003c0  8b 08 2b 33 6c 6f 08 d8  2c f4 f0 ef e9 39 bc 58  |..+3lo..,....9.X|
-000003d0  c2 2f 7f 59 65 9e 44 ec  55 31 f0 56 29 2f ae 7d  |./.Ye.D.U1.V)/.}|
-000003e0  32 47 3b 11 96 40 73 c0  7d 6a 91 17 03 03 00 88  |2G;..@s.}j......|
-000003f0  9e 69 5e 5f 46 e6 c3 33  73 a5 d3 38 d4 f4 6b 45  |.i^_F..3s..8..kE|
-00000400  c8 34 ea 8f fb e8 c2 e1  02 ca d7 2f 20 48 2c f0  |.4........./ H,.|
-00000410  e5 8a 9a 9a c6 55 a2 d9  02 5f 7f df 93 53 9b b1  |.....U..._...S..|
-00000420  f9 2a 65 2c a9 47 0b a2  2c 12 2e b6 07 3c ac 63  |.*e,.G..,....<.c|
-00000430  d2 a7 ac b5 1a 3f b7 ea  9a a7 0b 70 6c 76 65 fe  |.....?.....plve.|
-00000440  5e 42 09 f4 3a 67 07 78  11 2a 74 1d 3e a4 01 c5  |^B..:g.x.*t.>...|
-00000450  d5 57 5b 94 1e 52 1f 0f  e4 e2 c3 f1 ab 8f 09 81  |.W[..R..........|
-00000460  d4 4f d2 76 4c d3 73 d8  2a ed c0 6c 65 40 2b 19  |.O.vL.s.*..le@+.|
-00000470  bd 8d 0a 9b e9 9c da 2c                           |.......,|
+00000080  03 03 00 01 01 17 03 03  00 17 c9 df 69 cf ca 6d  |............i..m|
+00000090  b4 7b 81 46 34 f6 0c e3  5b 88 92 91 24 80 93 03  |.{.F4...[...$...|
+000000a0  f8 17 03 03 02 6d b9 46  75 89 0d 64 9d 7b 9a 2a  |.....m.Fu..d.{.*|
+000000b0  48 78 eb 93 8d c8 4d 16  fb 7e 95 77 ff 06 d2 aa  |Hx....M..~.w....|
+000000c0  30 34 cc 9e 5a f3 c1 b6  d5 17 fb b2 15 bb eb 11  |04..Z...........|
+000000d0  28 5a 2f 6b d6 87 8c c6  17 00 4d 58 d1 27 af 88  |(Z/k......MX.'..|
+000000e0  39 1f db 2e 0a 5b 36 8f  a1 26 a9 00 be ba 5a b2  |9....[6..&....Z.|
+000000f0  65 fa 14 8a 53 3c 6a 9e  b7 73 1f fa 80 fd 03 c2  |e...S<j..s......|
+00000100  0e 53 27 25 42 fb 4a 75  9e 18 80 09 d0 b5 dc 37  |.S'%B.Ju.......7|
+00000110  a7 d3 d6 9d a1 a0 4e bc  1a a6 c8 78 e4 b9 e2 02  |......N....x....|
+00000120  00 2a 4a c9 e5 8d 5a e3  83 60 ae 74 11 06 33 93  |.*J...Z..`.t..3.|
+00000130  5d ed 89 6c 17 6b a4 c4  45 06 d0 8d 64 9a 37 eb  |]..l.k..E...d.7.|
+00000140  34 22 1d 70 b0 96 74 8b  ba 17 ad bb 42 fd c7 30  |4".p..t.....B..0|
+00000150  16 6a cc dd a9 97 1d 0a  34 1e f9 52 3b e8 49 e7  |.j......4..R;.I.|
+00000160  41 ab 8a fb 29 b7 22 93  c1 ea 92 29 45 a1 e5 46  |A...)."....)E..F|
+00000170  92 98 30 5f 2e f1 90 f4  a0 cb b3 0a 64 16 be 4c  |..0_........d..L|
+00000180  18 2c 83 ef 7b 7b e8 74  6f cf 99 c3 47 37 fd c4  |.,..{{.to...G7..|
+00000190  a7 57 ba 2b d2 69 01 71  47 37 ac bd 7d a3 d7 cf  |.W.+.i.qG7..}...|
+000001a0  ce e5 bc d3 75 f8 d3 d8  e7 b4 57 81 8d 92 05 04  |....u.....W.....|
+000001b0  12 b1 76 d0 9a 5c d6 76  54 9a 99 03 19 ee 92 ff  |..v..\.vT.......|
+000001c0  8e 12 50 50 d5 cb 2c d4  df 0b 6b 43 54 59 39 17  |..PP..,...kCTY9.|
+000001d0  0e 3c 6a 87 6c 34 3a ec  fb 87 88 bc df aa fc 08  |.<j.l4:.........|
+000001e0  80 c8 c7 b8 5d 6e dc f9  e3 d3 15 36 5e db 64 cb  |....]n.....6^.d.|
+000001f0  6d f5 09 87 3e f8 b8 7c  e0 89 7c 9b ca 3d bf 68  |m...>..|..|..=.h|
+00000200  de 8f 68 89 02 c5 67 5a  ff 71 02 34 00 96 15 d4  |..h...gZ.q.4....|
+00000210  01 6d 6d 31 dc 77 62 b8  3e 72 b0 ab 4d da ea 6d  |.mm1.wb.>r..M..m|
+00000220  9a 2d 0e 5d b7 8e cc bc  5c 0a b3 13 5b 8c 86 de  |.-.]....\...[...|
+00000230  e3 1a 70 cd 9d 63 4c ea  e2 56 f9 3b 05 8e 0b 96  |..p..cL..V.;....|
+00000240  16 c9 a4 67 09 fe 88 ae  4b 8c d1 b3 19 10 0f fd  |...g....K.......|
+00000250  07 33 86 3a 6a 54 ef 69  27 02 bf 76 7c 05 ab 40  |.3.:jT.i'..v|..@|
+00000260  e6 43 9e 3c 9b ee 0c d8  14 ff c1 09 a6 73 65 66  |.C.<.........sef|
+00000270  54 1f a9 9c af fb 73 c4  cb 8c a7 3b c7 23 d6 99  |T.....s....;.#..|
+00000280  a7 c6 af a1 62 54 30 f7  18 30 23 7d c0 e6 d3 fe  |....bT0..0#}....|
+00000290  a0 58 f1 c5 5e 37 70 90  47 73 45 b0 70 a9 45 1c  |.X..^7p.GsE.p.E.|
+000002a0  87 9f 0d ed bc ee 65 c2  50 91 55 a3 f9 eb 71 e8  |......e.P.U...q.|
+000002b0  5a ee b3 3f 79 75 3a c9  98 7d 57 fc 51 78 b5 e5  |Z..?yu:..}W.Qx..|
+000002c0  33 90 f1 d0 74 86 1a 51  2b f4 89 1a 19 48 2d 68  |3...t..Q+....H-h|
+000002d0  d0 7b be c1 bb 9e c7 3e  af 4b 80 1c ab 8f a2 9d  |.{.....>.K......|
+000002e0  17 96 da 42 16 49 a6 74  35 07 9a 7d 89 80 4d d6  |...B.I.t5..}..M.|
+000002f0  04 43 11 68 6b e4 87 32  33 43 82 b3 9e b0 03 eb  |.C.hk..23C......|
+00000300  b9 15 01 86 01 db ea e3  67 5b 7f 9c 0e 54 03 21  |........g[...T.!|
+00000310  04 29 7e 17 03 03 00 99  21 c7 e4 ea 6e 27 82 c6  |.)~.....!...n'..|
+00000320  15 6a 4d cd 8d c5 41 e5  1e aa 5c 8b b9 e8 ee 2a  |.jM...A...\....*|
+00000330  04 53 ee 39 3d a1 9b 53  ab f8 4a 97 95 69 53 ef  |.S.9=..S..J..iS.|
+00000340  9b a9 3a d5 d1 0c a6 e3  fb 7d 30 b1 00 45 43 58  |..:......}0..ECX|
+00000350  51 65 1f 60 e7 f4 0a 6a  f6 8a 06 60 9b 5b 60 31  |Qe.`...j...`.[`1|
+00000360  d5 df 8b 28 1a c4 cb 39  5d a3 2b fb eb c8 07 14  |...(...9].+.....|
+00000370  07 ee 02 11 7f 85 c9 78  d8 f5 c1 6b 70 c1 b3 c1  |.......x...kp...|
+00000380  c0 a8 a0 08 ac d3 4e 39  ca 21 b0 e6 1d ea 97 58  |......N9.!.....X|
+00000390  6a e0 ac ad 10 19 75 13  7e 35 5d c6 2c ad a1 a2  |j.....u.~5].,...|
+000003a0  79 ac 33 ed 4d 77 41 29  6c e2 05 80 d7 7b 05 a4  |y.3.MwA)l....{..|
+000003b0  03 17 03 03 00 35 4b 22  e9 78 9e b1 75 a9 cd 91  |.....5K".x..u...|
+000003c0  c6 4d f1 e9 f2 a7 42 59  d5 c0 9e f3 9e 8f 7a 17  |.M....BY......z.|
+000003d0  21 ba 01 5b d3 0f 91 52  63 12 d9 4f be 84 75 2e  |!..[...Rc..O..u.|
+000003e0  a2 46 a9 45 f5 d6 a1 60  a0 17 79 17 03 03 00 8b  |.F.E...`..y.....|
+000003f0  92 fc 11 26 97 33 82 f1  e4 62 5d 2a 56 3c d8 80  |...&.3...b]*V<..|
+00000400  6b 6d ce f9 5f 43 2f 8e  24 0b 46 0b a5 5a 22 d5  |km.._C/.$.F..Z".|
+00000410  ff 33 d7 e6 04 2e 37 5b  00 45 9d 8b 62 49 81 b1  |.3....7[.E..bI..|
+00000420  97 ca d5 84 dd f9 7e 1a  7a a3 45 46 b9 db a7 d4  |......~.z.EF....|
+00000430  07 3d 54 39 b1 de 54 16  bc d7 ba e7 b8 92 02 eb  |.=T9..T.........|
+00000440  0c 3c b1 48 40 53 68 f5  fc 0f 6a 64 67 fb 79 cd  |.<.H@Sh...jdg.y.|
+00000450  75 ed 65 7c 88 01 04 43  ed 00 44 68 c3 74 c1 bc  |u.e|...C..Dh.t..|
+00000460  63 4a cf e9 e5 20 21 0e  da da 09 fd ac c6 1c 7a  |cJ... !........z|
+00000470  69 e4 90 fc e2 3b 12 df  3a 11 f4                 |i....;..:..|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 02 55 fc 25 4b  |..........5.U.%K|
-00000010  b5 7e 6e 2b 57 22 c5 34  4b 8d 52 64 df 67 8c 29  |.~n+W".4K.Rd.g.)|
-00000020  b5 84 a3 59 56 23 4f 97  6f be 11 fd df e0 d8 41  |...YV#O.o......A|
-00000030  bf 83 0b 80 cb ef 9d ce  87 b4 70 12 37 3c 36 c7  |..........p.7<6.|
+00000000  14 03 03 00 01 01 17 03  03 00 35 0f c5 0c ac c4  |..........5.....|
+00000010  a9 7e 32 56 fd 68 b8 86  66 8a 66 da 65 0a 5a ee  |.~2V.h..f.f.e.Z.|
+00000020  1a a5 11 ec 1c 42 28 2f  8e a3 98 49 80 a5 9e e3  |.....B(/...I....|
+00000030  5f cf 51 93 44 b2 f2 e0  6e 58 ea c6 50 84 14 ef  |_.Q.D...nX..P...|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 78 89 4a  fe 24 43 a1 e0 b0 10 3c  |.....x.J.$C....<|
-00000010  12 da 92 be a9 6a dc fc  f9 2e bc 8d 97 ac 41 70  |.....j........Ap|
-00000020  da f7 a2 17 03 03 00 13  05 42 c2 61 8a 7d b7 c7  |.........B.a.}..|
-00000030  2a df 30 97 25 7e 35 d1  82 8d 6d                 |*.0.%~5...m|
+00000000  17 03 03 00 1e 3c 0f a4  3b d6 72 2e 40 dd 5d 79  |.....<..;.r.@.]y|
+00000010  e4 57 25 46 95 76 98 6a  4f aa 75 b5 2f 40 67 2e  |.W%F.v.jO.u./@g.|
+00000020  ff ac 49 17 03 03 00 13  93 90 ac d8 14 54 32 66  |..I..........T2f|
+00000030  fa af 38 24 7c 58 75 62  88 60 34                 |..8$|Xub.`4|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-IssueTicketPreDisable b/src/crypto/tls/testdata/Server-TLSv13-IssueTicketPreDisable
index 75f9b7fda9..abdf41d89a 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-IssueTicketPreDisable
+++ b/src/crypto/tls/testdata/Server-TLSv13-IssueTicketPreDisable
@@ -1,98 +1,98 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 ce 01 00 00  ca 03 03 ce 7e 18 d7 48  |............~..H|
-00000010  d4 9c 98 95 ef 53 20 6b  af 27 2c e9 4b f5 fd d1  |.....S k.',.K...|
-00000020  b7 e7 cf 89 95 24 a2 b6  3f a6 48 20 80 a4 f8 a6  |.....$..?.H ....|
-00000030  96 d7 76 ad 98 e4 f6 6e  6d 48 c9 d4 77 c5 ce 30  |..v....nmH..w..0|
-00000040  13 d0 47 0e 59 ca 30 1b  26 01 d3 96 00 04 13 01  |..G.Y.0.&.......|
+00000000  16 03 01 00 ce 01 00 00  ca 03 03 1f 69 f6 99 9f  |............i...|
+00000010  ee 81 23 41 5d 81 d6 aa  1b 5a 44 9e 56 78 21 6a  |..#A]....ZD.Vx!j|
+00000020  fa a1 17 9b 6f 97 3d d5  ee 11 7a 20 01 bd 29 e6  |....o.=...z ..).|
+00000030  6b be 9e 23 35 3a ab 47  92 6f 71 b3 69 82 63 7d  |k..#5:.G.oq.i.c}|
+00000040  43 c0 ae eb 05 8e 54 9b  e9 55 ec c2 00 04 13 01  |C.....T..U......|
 00000050  00 ff 01 00 00 7d 00 0b  00 04 03 00 01 02 00 0a  |.....}..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 16 00 00 00 17  00 00 00 0d 00 1e 00 1c  |................|
 00000080  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000090  08 04 08 05 08 06 04 01  05 01 06 01 00 2b 00 03  |.............+..|
 000000a0  02 03 04 00 2d 00 02 01  01 00 33 00 26 00 24 00  |....-.....3.&.$.|
-000000b0  1d 00 20 00 3a 93 6e 68  39 4d c8 80 23 b0 b8 2d  |.. .:.nh9M..#..-|
-000000c0  30 0d 19 d8 ce 95 31 f5  0b 5f 39 54 a7 98 6f 88  |0.....1.._9T..o.|
-000000d0  c8 52 50                                          |.RP|
+000000b0  1d 00 20 9c 90 86 ec 0c  c9 4e 43 4d d7 00 3d 39  |.. ......NCM..=9|
+000000c0  50 25 c9 b9 f8 7f cc 6a  39 95 bc f0 1f 0d bc a7  |P%.....j9.......|
+000000d0  21 ff 69                                          |!.i|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 80 a4 f8 a6  |........... ....|
-00000030  96 d7 76 ad 98 e4 f6 6e  6d 48 c9 d4 77 c5 ce 30  |..v....nmH..w..0|
-00000040  13 d0 47 0e 59 ca 30 1b  26 01 d3 96 13 01 00 00  |..G.Y.0.&.......|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 01 bd 29 e6  |........... ..).|
+00000030  6b be 9e 23 35 3a ab 47  92 6f 71 b3 69 82 63 7d  |k..#5:.G.oq.i.c}|
+00000040  43 c0 ae eb 05 8e 54 9b  e9 55 ec c2 13 01 00 00  |C.....T..U......|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 67 92 de 58 e6 a7  |..........g..X..|
-00000090  a0 15 83 48 39 a0 71 40  35 04 27 b5 fb ac 3f d0  |...H9.q@5.'...?.|
-000000a0  04 17 03 03 02 6d 20 5f  87 47 d8 ea c6 97 b4 dd  |.....m _.G......|
-000000b0  4d 95 39 22 d6 2e 65 ff  ce 63 77 d6 b0 82 a5 b3  |M.9"..e..cw.....|
-000000c0  aa a5 3b 61 24 86 70 b6  d9 8a 24 3e 24 20 cb 57  |..;a$.p...$>$ .W|
-000000d0  d6 44 f7 e4 77 31 78 eb  2f 0d bc 48 bd ac 77 6e  |.D..w1x./..H..wn|
-000000e0  1a 51 67 7b eb 48 4a 78  cb de dc 80 4e a3 82 0c  |.Qg{.HJx....N...|
-000000f0  02 45 b8 e3 48 0b b5 c8  e9 51 17 61 f9 a0 f0 74  |.E..H....Q.a...t|
-00000100  8a 29 c6 05 31 c4 6b c5  a4 d3 65 2e d4 17 29 18  |.)..1.k...e...).|
-00000110  2a b0 19 95 b4 90 44 16  8e 9e 2c 4a a1 70 0c 92  |*.....D...,J.p..|
-00000120  bd 27 0e 91 5e 21 75 00  5d 55 12 16 c9 b2 6a 11  |.'..^!u.]U....j.|
-00000130  20 17 18 f1 00 e8 71 38  03 ab 85 39 c9 72 a1 81  | .....q8...9.r..|
-00000140  42 94 82 1c 8c 15 95 32  8a 27 a3 59 e6 d8 b4 36  |B......2.'.Y...6|
-00000150  b8 37 e0 53 3f cf 7e 53  01 b0 c1 da 82 d7 b6 d7  |.7.S?.~S........|
-00000160  a9 7a c0 fa ec 9c 82 37  28 cf 45 6a aa d8 38 18  |.z.....7(.Ej..8.|
-00000170  14 92 42 62 0a 3c 29 34  a8 da c6 f8 f0 b1 c7 4d  |..Bb.<)4.......M|
-00000180  b9 75 ba a7 20 f1 78 00  77 01 2f d9 58 dc 2c 20  |.u.. .x.w./.X., |
-00000190  05 b7 84 7c 7e fc 3c 92  ad f3 0b ba 78 a1 c0 be  |...|~.<.....x...|
-000001a0  19 8b 11 9b 26 ee 9f 29  bc 3f 61 a6 7a 78 a9 d3  |....&..).?a.zx..|
-000001b0  94 24 b2 4d b1 76 7a 6f  72 7b fd 5d 40 70 75 91  |.$.M.vzor{.]@pu.|
-000001c0  a8 1e 51 50 c9 88 a0 f6  87 9d db 2e 7e a6 78 9c  |..QP........~.x.|
-000001d0  8d b5 13 84 c7 56 fd 59  fe ec d4 45 be 04 06 cc  |.....V.Y...E....|
-000001e0  81 9e 51 8c e6 3f c0 0f  6e 24 40 48 ce fb 3f 17  |..Q..?..n$@H..?.|
-000001f0  d5 ec f6 7b f8 e8 64 fc  19 1b e4 ce bc 94 3f 89  |...{..d.......?.|
-00000200  11 ea 2f 48 6e 99 09 f4  65 5b c6 e3 b8 4d 61 c2  |../Hn...e[...Ma.|
-00000210  ea 70 d9 60 58 55 29 a5  e4 b2 0b 5b 84 f4 b8 87  |.p.`XU)....[....|
-00000220  e1 9c 56 27 3b d3 c3 48  c9 dc 20 71 7e 94 8f 99  |..V';..H.. q~...|
-00000230  91 a8 da 48 6d 94 32 98  86 51 ae 89 04 49 64 5a  |...Hm.2..Q...IdZ|
-00000240  de 28 eb 4c 57 68 d9 f1  a2 57 f9 1e 07 53 1e 2e  |.(.LWh...W...S..|
-00000250  5b d2 c5 a9 09 c3 8a e2  d2 25 05 5d 47 8d f7 a0  |[........%.]G...|
-00000260  a7 b9 e7 95 e3 7f 10 b0  f2 48 96 f0 fa ae 21 3a  |.........H....!:|
-00000270  8a d3 d3 03 7f 19 8e de  ea 2a fb 21 d9 a0 a6 92  |.........*.!....|
-00000280  2f f7 55 21 5d 50 46 86  03 e9 f9 30 89 2e e7 9f  |/.U!]PF....0....|
-00000290  65 f9 e6 81 c9 21 d6 3d  0e 27 45 be 73 e2 7d 7f  |e....!.=.'E.s.}.|
-000002a0  45 c7 25 8b 72 34 e3 5b  bd 2a e7 10 58 e7 2e 17  |E.%.r4.[.*..X...|
-000002b0  2b ed 8f b2 82 b0 ae 45  f4 f2 be 38 88 b7 d7 1b  |+......E...8....|
-000002c0  4a 8d dc 83 28 1c c0 8f  dd 71 6b 4d e7 4c 93 bd  |J...(....qkM.L..|
-000002d0  5b 2c 81 bb 4d 17 51 96  22 b3 bc 33 a6 d4 e6 fa  |[,..M.Q."..3....|
-000002e0  4f ac 49 e3 94 0c 49 af  09 34 ae 76 b0 98 01 e9  |O.I...I..4.v....|
-000002f0  ec 3c 6e 2e 4c 4f bf c2  67 b6 f2 3e f9 aa 21 22  |.<n.LO..g..>..!"|
-00000300  05 f7 08 0e e2 7e a5 ae  dd ae 09 4a cd 42 4b 43  |.....~.....J.BKC|
-00000310  a1 28 0a 17 03 03 00 99  4c ec 7b 01 4d 42 22 a4  |.(......L.{.MB".|
-00000320  c4 88 dc c9 37 76 c2 5b  e5 2c 23 70 63 62 8a bd  |....7v.[.,#pcb..|
-00000330  4f b3 ca 67 99 3c b8 de  cd a5 00 2d 1f cd fd bd  |O..g.<.....-....|
-00000340  09 4c 6a 23 d8 7c 2a 53  92 1f 16 9f e7 6c 3a 39  |.Lj#.|*S.....l:9|
-00000350  39 af 7f f2 d9 06 18 e8  a3 77 23 1d 25 48 b7 ef  |9........w#.%H..|
-00000360  00 f7 ed 80 97 01 50 d7  e7 30 3e 64 14 83 66 c3  |......P..0>d..f.|
-00000370  d0 fc d0 f7 2c 6b 74 98  72 64 18 2c 62 b4 27 f7  |....,kt.rd.,b.'.|
-00000380  99 bb c0 91 ea 9b ff 60  fa 16 3c 66 92 f2 de 15  |.......`..<f....|
-00000390  79 05 24 b2 5b 05 a5 5f  0b 0e 65 96 58 ab 68 03  |y.$.[.._..e.X.h.|
-000003a0  91 0e f0 bb 9a 3c 7d 24  7f ea 7b 41 18 b7 ac 00  |.....<}$..{A....|
-000003b0  0b 17 03 03 00 35 c5 91  97 a8 66 c3 4b 20 cc c0  |.....5....f.K ..|
-000003c0  d2 b6 88 53 40 ce 6f d3  63 1c 05 83 89 f5 ab 3e  |...S@.o.c......>|
-000003d0  b9 1a ec 71 b0 d3 0b b9  a0 c8 a2 da dc c5 72 8c  |...q..........r.|
-000003e0  a7 65 ff b3 4b 93 cd 92  05 4b ca 17 03 03 00 88  |.e..K....K......|
-000003f0  ff 7f 3d 21 c6 19 40 af  01 a8 4d 8f af f3 94 ac  |..=!..@...M.....|
-00000400  c2 ee 67 a9 ac 87 4d 09  12 36 8f f4 ee 5c 9c 3a  |..g...M..6...\.:|
-00000410  a7 48 ac de d9 d9 4f 9b  97 5a 76 2f 92 91 e4 1b  |.H....O..Zv/....|
-00000420  b4 74 1a da 9d 52 c8 8d  10 03 56 b8 9d 96 e4 92  |.t...R....V.....|
-00000430  b7 d9 ab 39 47 e2 ec 27  0a 00 55 7e 16 dc e8 b0  |...9G..'..U~....|
-00000440  ad 30 c3 57 54 c7 97 8d  26 71 80 31 27 b6 0e fc  |.0.WT...&q.1'...|
-00000450  ac ff 50 3a 16 e0 f1 e7  02 3b 30 f4 6f f2 72 30  |..P:.....;0.o.r0|
-00000460  40 8b 4b 1d 2c 31 ec ce  ee 46 24 cf e4 83 c6 b0  |@.K.,1...F$.....|
-00000470  b9 11 5b f9 14 dc c0 50                           |..[....P|
+00000080  03 03 00 01 01 17 03 03  00 17 05 f8 de 75 03 3e  |.............u.>|
+00000090  8f 8d df 8d c4 31 5e 59  2b a6 26 2c 81 86 e0 93  |.....1^Y+.&,....|
+000000a0  98 17 03 03 02 6d 73 67  7c 14 ba 17 23 fc f1 2e  |.....msg|...#...|
+000000b0  53 5b 47 58 e2 ed b3 6a  30 70 40 98 82 4b 43 0d  |S[GX...j0p@..KC.|
+000000c0  f6 e4 74 09 c8 08 9e a2  6d 23 3c 81 64 a9 39 e4  |..t.....m#<.d.9.|
+000000d0  be cc 6e 4c f1 df 7c b1  a5 cd 91 7c e7 e0 e9 97  |..nL..|....|....|
+000000e0  a3 06 20 92 7c 1c f6 e1  93 cd b2 65 ba 10 c0 54  |.. .|......e...T|
+000000f0  32 89 60 7e 6f ac 29 7f  df e8 ff d2 0f 0d 8a f8  |2.`~o.).........|
+00000100  2a 56 fd 4a 07 27 f1 cc  c1 81 fb bd 5e 33 92 34  |*V.J.'......^3.4|
+00000110  24 e9 a6 7f ff 76 e4 19  82 ca b8 92 aa 98 9c ac  |$....v..........|
+00000120  51 25 fc 3a 74 f6 f3 36  b4 ae 00 cd d9 e0 17 c4  |Q%.:t..6........|
+00000130  9f 56 67 d0 ab 22 a1 38  57 a9 58 66 b4 f8 60 0b  |.Vg..".8W.Xf..`.|
+00000140  20 c4 0c d0 f1 bc ce 4d  20 d2 e0 6f 1e f2 dd f0  | ......M ..o....|
+00000150  14 98 5c 33 92 08 af a9  42 ec 9e 8d 6e 92 cf 87  |..\3....B...n...|
+00000160  b7 79 90 18 1b 3b 78 77  1e 55 c7 68 9b 98 ae ae  |.y...;xw.U.h....|
+00000170  33 d8 50 b8 3d fa 6b 96  99 7a b5 ca 98 fa a9 21  |3.P.=.k..z.....!|
+00000180  46 6a a1 74 bf bc 2f 51  0e 66 e2 35 2c d3 c9 3c  |Fj.t../Q.f.5,..<|
+00000190  06 d0 79 31 00 d2 0a 1d  77 dd da 07 3a 31 7c 51  |..y1....w...:1|Q|
+000001a0  5e 53 b0 fe 55 21 1c 6c  fa d2 a3 71 18 1d 8f ec  |^S..U!.l...q....|
+000001b0  a3 ab 89 10 19 6d 45 50  9e f8 bf aa 3a 91 3b 80  |.....mEP....:.;.|
+000001c0  68 33 c0 d2 4c 10 39 b6  01 79 aa 27 a5 3e e7 59  |h3..L.9..y.'.>.Y|
+000001d0  6e fa c3 16 68 7f 7e ce  05 b0 96 e9 dd 2c 4a 7b  |n...h.~......,J{|
+000001e0  5e 63 65 e6 6f f1 05 95  40 e3 71 15 c6 bd ec 60  |^ce.o...@.q....`|
+000001f0  01 08 2b 23 d6 be c6 7f  00 aa 32 78 cb 77 d8 5c  |..+#......2x.w.\|
+00000200  e5 b6 b8 be 08 84 1a 47  57 b7 d8 72 27 e7 f6 08  |.......GW..r'...|
+00000210  7b 8a fa d8 a6 06 15 68  cc 90 a4 fe 8e 25 5c cb  |{......h.....%\.|
+00000220  03 e8 ab 19 32 05 f4 88  d9 11 03 72 48 a3 a9 b2  |....2......rH...|
+00000230  41 d3 60 80 d5 93 ae 18  1e 3d ed a7 ac 7f a6 eb  |A.`......=......|
+00000240  3c 5c 78 11 fb a6 b8 00  d6 7b 98 67 d5 fd 7c 87  |<\x......{.g..|.|
+00000250  80 b9 a4 23 71 31 93 77  98 90 fc 29 95 f4 6d 09  |...#q1.w...)..m.|
+00000260  87 2e 4b e7 a7 98 af 72  10 c2 dd 05 6e 60 b9 4c  |..K....r....n`.L|
+00000270  33 65 cf 26 fc 7d 81 cc  f0 4d 83 34 11 d2 0f 13  |3e.&.}...M.4....|
+00000280  7f 97 4a 12 17 44 fc 9a  32 08 de eb 5e 2a 87 d6  |..J..D..2...^*..|
+00000290  ed 7f ea 2a ed e3 2d 7a  ea 19 40 7c 6e a2 13 e6  |...*..-z..@|n...|
+000002a0  ff 9b f6 3c ff 5e 97 9c  de f8 c3 52 cb d8 d2 b0  |...<.^.....R....|
+000002b0  45 45 6e 63 d4 9f bf a5  7c c8 f4 65 84 ff 62 30  |EEnc....|..e..b0|
+000002c0  71 d4 65 a8 9e 43 e2 73  12 e9 d0 58 8c 1a 6e 0c  |q.e..C.s...X..n.|
+000002d0  2f 64 02 4d 1f 4f c0 69  d8 d5 44 97 7b 8a 09 d4  |/d.M.O.i..D.{...|
+000002e0  8f 68 13 68 b9 7f 7b d8  29 b8 d7 3a 8f 78 eb 73  |.h.h..{.)..:.x.s|
+000002f0  1b eb 1b 2d 7e 46 78 0b  ad 89 e5 d9 69 4b 1c 46  |...-~Fx.....iK.F|
+00000300  e7 13 c3 0d 54 f0 70 f8  99 60 45 78 fc a3 fc 72  |....T.p..`Ex...r|
+00000310  ca 84 57 17 03 03 00 99  05 02 eb 76 1b 1a f0 aa  |..W........v....|
+00000320  dd 0d 91 1e 0b c1 14 1c  6f 5e 9b b3 33 8c 70 87  |........o^..3.p.|
+00000330  f2 0e 1e 45 0e 36 1a 06  77 97 a1 95 cd d1 ec 3e  |...E.6..w......>|
+00000340  24 f9 b2 d5 47 5a c8 99  49 ca 59 bc 1d 6a 16 e7  |$...GZ..I.Y..j..|
+00000350  9a 51 c8 9a f7 ab b9 e4  fe 1e 22 1f ed c8 bf 1a  |.Q........".....|
+00000360  8e 06 6a 07 4a c7 ef 57  f9 4a 84 1c 4b 1b 60 24  |..j.J..W.J..K.`$|
+00000370  5a d7 c0 34 57 68 1c fd  3f 2a 0a 17 9a 1f 70 19  |Z..4Wh..?*....p.|
+00000380  08 ff c5 33 79 4e 85 fb  8c 8d 76 6c be 8c 9c bf  |...3yN....vl....|
+00000390  7a ac 87 8a d1 ea d0 a4  1e 25 64 ae 63 e7 29 59  |z........%d.c.)Y|
+000003a0  d8 27 88 4c e2 c7 42 9d  08 75 62 49 df fa 84 e8  |.'.L..B..ubI....|
+000003b0  11 17 03 03 00 35 39 db  59 c8 ab 08 33 da 2c 19  |.....59.Y...3.,.|
+000003c0  04 10 bb 18 b3 10 78 4b  2c a2 2b a2 e2 67 d1 6f  |......xK,.+..g.o|
+000003d0  07 9c 0b d2 e1 24 a8 ac  7b ce 77 55 7d b8 b3 9b  |.....$..{.wU}...|
+000003e0  82 7f bc 18 7a 61 a8 28  e2 a9 1e 17 03 03 00 8b  |....za.(........|
+000003f0  6e a6 11 39 b9 d7 7b a0  67 76 c2 a6 d0 e4 c4 ba  |n..9..{.gv......|
+00000400  a3 3d 37 bb 6d 82 5e 2e  80 e8 e6 4b 98 89 69 e9  |.=7.m.^....K..i.|
+00000410  27 cb c9 83 a5 2b a4 78  00 dd 46 4d 45 f7 4e a7  |'....+.x..FME.N.|
+00000420  3b c2 e1 84 5c ff af 75  25 1a 52 c4 b6 29 48 bb  |;...\..u%.R..)H.|
+00000430  31 30 e2 8c ac f0 e8 bd  78 26 f2 d1 d6 1e d5 3e  |10......x&.....>|
+00000440  6d 61 7e 80 e5 bc 81 28  e3 1f 62 40 0e 31 0b e1  |ma~....(..b@.1..|
+00000450  23 1c e1 fa 32 94 c3 4e  1d 09 81 d9 b6 89 c4 9c  |#...2..N........|
+00000460  5e 38 85 ab 38 29 03 42  ea c0 94 d7 65 40 1f 1d  |^8..8).B....e@..|
+00000470  49 39 9a e9 76 92 38 2f  17 8b ee                 |I9..v.8/...|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 8d c2 91 42 bb  |..........5...B.|
-00000010  59 56 52 f6 be d3 1e b8  73 e2 6f cd 7e b7 65 6b  |YVR.....s.o.~.ek|
-00000020  45 6c 59 00 31 96 c8 ac  9d 91 5f d9 02 31 17 ed  |ElY.1....._..1..|
-00000030  a5 91 6d 00 9e 44 0f ae  33 d1 a9 c3 6b f7 a1 fa  |..m..D..3...k...|
+00000000  14 03 03 00 01 01 17 03  03 00 35 e1 c3 64 6d 3b  |..........5..dm;|
+00000010  7d 3c d3 c6 ee 3a f9 cc  a6 29 18 3a 7b bd b1 07  |}<...:...).:{...|
+00000020  01 b4 06 8d fe a0 6e 23  40 52 5a f1 a3 4c 59 0a  |......n#@RZ..LY.|
+00000030  ea b5 e3 7f e3 b9 0e e5  70 8a 47 a1 1e 2a 00 03  |........p.G..*..|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e f6 8f cc  46 63 2c e9 70 d9 0e 9d  |........Fc,.p...|
-00000010  86 5e a2 f0 c1 94 41 01  54 50 48 24 22 bf 41 f3  |.^....A.TPH$".A.|
-00000020  8a eb 76 17 03 03 00 13  c9 63 39 fa 7a c6 da df  |..v......c9.z...|
-00000030  f4 49 08 0f 95 43 09 4a  c1 5d cc                 |.I...C.J.].|
+00000000  17 03 03 00 1e 4e a9 f3  57 a0 f8 b2 0b dd 8e 90  |.....N..W.......|
+00000010  61 96 d9 53 c8 69 87 65  fd f4 fb ae 55 95 0d 07  |a..S.i.e....U...|
+00000020  69 e3 29 17 03 03 00 13  02 ba 24 dc 82 fc 91 9f  |i.).......$.....|
+00000030  91 ff b9 6e 71 8e e3 2d  2f e8 8f                 |...nq..-/..|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-P256 b/src/crypto/tls/testdata/Server-TLSv13-P256
index 39cae7e97c..c3a2ee02f4 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-P256
+++ b/src/crypto/tls/testdata/Server-TLSv13-P256
@@ -1,101 +1,101 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 e3 01 00 00  df 03 03 4f 01 d7 17 f7  |...........O....|
-00000010  fe e7 90 88 cb a3 23 5f  9d 21 31 3e 3a 6b 9d ee  |......#_.!1>:k..|
-00000020  6a 05 12 26 09 fd 46 83  aa e7 af 20 7f e3 24 d7  |j..&..F.... ..$.|
-00000030  4b 09 77 64 ff 4d b3 ef  f6 60 d3 df fd 57 dc 80  |K.wd.M...`...W..|
-00000040  7a 95 d3 22 49 e7 96 38  6d aa 38 b7 00 04 13 03  |z.."I..8m.8.....|
+00000000  16 03 01 00 e3 01 00 00  df 03 03 18 3b 05 4d 40  |............;.M@|
+00000010  41 61 2a 64 35 7a e4 a7  c2 8b ab e5 e3 90 04 6d  |Aa*d5z.........m|
+00000020  18 75 15 88 88 c7 af ba  05 e7 9c 20 78 e2 6d 28  |.u......... x.m(|
+00000030  fb 06 f6 e8 33 cd cc ba  db 53 6d 4e 28 54 ca 62  |....3....SmN(T.b|
+00000040  c8 44 e3 cc 58 b5 07 ec  84 c9 e6 45 00 04 13 03  |.D..X......E....|
 00000050  00 ff 01 00 00 92 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 04 00 02 00 17 00 16  00 00 00 17 00 00 00 0d  |................|
 00000070  00 1e 00 1c 04 03 05 03  06 03 08 07 08 08 08 09  |................|
 00000080  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
 00000090  00 2b 00 03 02 03 04 00  2d 00 02 01 01 00 33 00  |.+......-.....3.|
-000000a0  47 00 45 00 17 00 41 04  2f c6 35 98 c9 7b ba 92  |G.E...A./.5..{..|
-000000b0  5c 09 f5 9d 4b 51 2e c4  76 e1 a1 52 cc 21 d9 54  |\...KQ..v..R.!.T|
-000000c0  53 48 31 ec 79 a4 ad b9  54 ae a5 39 c0 6c f1 d7  |SH1.y...T..9.l..|
-000000d0  c9 44 f8 87 b2 1f 0f be  1b de 05 eb 38 44 dc 83  |.D..........8D..|
-000000e0  da a0 77 63 59 f2 fa 28                           |..wcY..(|
+000000a0  47 00 45 00 17 00 41 04  a1 27 f2 a0 16 66 17 e9  |G.E...A..'...f..|
+000000b0  73 ff 49 d4 99 47 19 b6  c1 ea 67 ea ef fd ad 07  |s.I..G....g.....|
+000000c0  c8 f4 19 e8 16 da a2 d0  bc c2 cc 58 c8 e4 d0 89  |...........X....|
+000000d0  c6 75 8f ac 87 e0 d6 4a  44 fa 14 c5 d6 ac ce d8  |.u.....JD.......|
+000000e0  8f 1d 5f d0 06 96 6c bb                           |.._...l.|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 9b 02 00 00  97 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 7f e3 24 d7  |........... ..$.|
-00000030  4b 09 77 64 ff 4d b3 ef  f6 60 d3 df fd 57 dc 80  |K.wd.M...`...W..|
-00000040  7a 95 d3 22 49 e7 96 38  6d aa 38 b7 13 03 00 00  |z.."I..8m.8.....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 78 e2 6d 28  |........... x.m(|
+00000030  fb 06 f6 e8 33 cd cc ba  db 53 6d 4e 28 54 ca 62  |....3....SmN(T.b|
+00000040  c8 44 e3 cc 58 b5 07 ec  84 c9 e6 45 13 03 00 00  |.D..X......E....|
 00000050  4f 00 2b 00 02 03 04 00  33 00 45 00 17 00 41 04  |O.+.....3.E...A.|
 00000060  1e 18 37 ef 0d 19 51 88  35 75 71 b5 e5 54 5b 12  |..7...Q.5uq..T[.|
 00000070  2e 8f 09 67 fd a7 24 20  3e b2 56 1c ce 97 28 5e  |...g..$ >.V...(^|
 00000080  f8 2b 2d 4f 9e f1 07 9f  6c 4b 5b 83 56 e2 32 42  |.+-O....lK[.V.2B|
 00000090  e9 58 b6 d7 49 a6 b5 68  1a 41 03 56 6b dc 5a 89  |.X..I..h.A.Vk.Z.|
-000000a0  14 03 03 00 01 01 17 03  03 00 17 f6 22 32 b9 da  |............"2..|
-000000b0  7a 10 6a 4e c0 5e 5b 66  53 26 ad b5 e6 83 73 b1  |z.jN.^[fS&....s.|
-000000c0  0d 55 17 03 03 02 6d 21  32 be f9 b5 64 71 fe 23  |.U....m!2...dq.#|
-000000d0  f9 20 ff cc 9b fa 3e b3  0b 1b 9d 2b fb 9a 10 e1  |. ....>....+....|
-000000e0  87 f6 f3 31 f3 77 0c 60  72 f8 6f 29 06 2b fe c7  |...1.w.`r.o).+..|
-000000f0  6c ab e8 15 8e ea b9 fa  66 07 ea 15 2f 93 e0 31  |l.......f.../..1|
-00000100  8a b5 2c 09 55 8e 0d d4  a0 b1 5f 7d 35 a2 9a 99  |..,.U....._}5...|
-00000110  7f a6 8d b8 b8 21 27 4b  f1 7d f9 2b d5 7f ed 4e  |.....!'K.}.+...N|
-00000120  77 39 d8 5b 0b 8f 4c d0  04 2b a5 cc 4c 06 0c 6a  |w9.[..L..+..L..j|
-00000130  e3 3b 73 38 1a 52 1d 62  41 1d d9 71 6a 49 5c a3  |.;s8.R.bA..qjI\.|
-00000140  62 1b c7 d2 3e 3a 54 1b  df a1 e3 3d 01 c0 5b ea  |b...>:T....=..[.|
-00000150  a9 2f 10 5e ff d3 55 b3  fc f1 49 54 ea 59 47 fc  |./.^..U...IT.YG.|
-00000160  4f 5b 42 cb 31 ab ea d4  5e 80 79 28 f5 0a ab 7a  |O[B.1...^.y(...z|
-00000170  61 6a 09 17 30 8c 76 01  eb 72 b2 87 c3 88 d8 a0  |aj..0.v..r......|
-00000180  ac 12 0c 4a 93 cc 41 d3  0c e3 11 15 4a 9c 43 81  |...J..A.....J.C.|
-00000190  0f 7e d9 3f 95 7e 1e c9  f9 86 bb 63 8f 86 b5 9a  |.~.?.~.....c....|
-000001a0  9d e3 e3 26 70 55 86 a7  d4 a2 1e 9f 59 f0 70 68  |...&pU......Y.ph|
-000001b0  c8 a2 2b 26 42 75 b1 05  a2 e9 f1 c0 1f a5 a4 2a  |..+&Bu.........*|
-000001c0  e3 12 14 89 72 bf 9a 48  2b e0 40 6d 31 19 9c ca  |....r..H+.@m1...|
-000001d0  e4 74 d9 3f d8 c7 1e c1  d0 24 54 75 5b 5f 99 1f  |.t.?.....$Tu[_..|
-000001e0  0f 07 22 5b 34 e5 10 1e  db 84 0b e4 d1 25 58 78  |.."[4........%Xx|
-000001f0  49 9c 86 a6 6c 00 94 8b  68 46 31 87 09 b7 a8 89  |I...l...hF1.....|
-00000200  a4 2f f8 db d3 a2 a9 81  89 3c 1b e0 b2 1b 08 7b  |./.......<.....{|
-00000210  3d 10 ba 7d bd c9 31 7f  06 f6 46 4c 25 2e e8 00  |=..}..1...FL%...|
-00000220  56 68 2b 40 55 a4 04 97  d8 91 fb 54 50 4d 59 a2  |Vh+@U......TPMY.|
-00000230  e7 e5 90 b7 53 78 a6 9a  63 a7 0b ba 3c 8c 0e 45  |....Sx..c...<..E|
-00000240  52 6e 55 6f 30 d3 8e 29  19 c3 bc 11 49 4b 89 6a  |RnUo0..)....IK.j|
-00000250  04 ad e5 47 90 cc ce d3  6a 09 6c 94 df b2 54 18  |...G....j.l...T.|
-00000260  0d 0d b4 17 33 05 b1 74  1e 07 4c 87 5e e6 51 dd  |....3..t..L.^.Q.|
-00000270  99 ca fb be f1 45 b9 8f  df 62 df 40 60 59 2f 22  |.....E...b.@`Y/"|
-00000280  63 9c fd d6 52 06 e6 8a  88 63 f8 d3 ca 6b 5d 06  |c...R....c...k].|
-00000290  5f 17 ca 4b 79 10 d9 b9  c2 68 eb d5 9d 52 d3 8d  |_..Ky....h...R..|
-000002a0  35 1c 91 2b d9 c9 44 81  dd e6 d1 22 cf 78 66 8a  |5..+..D....".xf.|
-000002b0  ee 42 39 da 2a e9 4b a9  b3 0e 9b 03 7a be 0b 0d  |.B9.*.K.....z...|
-000002c0  b2 f8 2e 38 24 72 84 a0  68 8b 8c bd a0 77 28 89  |...8$r..h....w(.|
-000002d0  03 1e d4 1a d4 b8 06 c0  88 ff e0 fc a7 d1 a8 68  |...............h|
-000002e0  0d 19 6b 69 36 b1 85 29  d0 fc 3d 5c c4 2e 3a d1  |..ki6..)..=\..:.|
-000002f0  46 00 44 6f 17 41 f5 c3  65 28 2b 85 11 62 66 17  |F.Do.A..e(+..bf.|
-00000300  3e ab 0d 60 3c 4c de 81  a0 39 95 a0 92 58 4a 03  |>..`<L...9...XJ.|
-00000310  aa ea cd 99 28 3f ab 24  84 25 9e 0e 9f 97 9c 05  |....(?.$.%......|
-00000320  db 57 4c 07 b0 a8 c7 33  fc 49 99 c5 ea 78 82 8e  |.WL....3.I...x..|
-00000330  be 9b f5 05 17 03 03 00  99 e6 f4 13 df f4 71 75  |..............qu|
-00000340  5d 18 26 ca d6 5b 67 a7  fa 66 89 45 03 a7 8f 22  |].&..[g..f.E..."|
-00000350  96 8e 7a 26 d8 f9 3b 92  4f 6a 8d ac fa 71 79 63  |..z&..;.Oj...qyc|
-00000360  10 91 9b 66 25 d4 aa b3  64 46 96 85 d7 21 81 2c  |...f%...dF...!.,|
-00000370  d9 e4 ce 34 64 96 b0 e9  05 a8 bc d9 47 39 dc a1  |...4d.......G9..|
-00000380  c2 a2 b7 3e 4e 5d 67 fd  f9 cd ae b2 0d 88 91 ad  |...>N]g.........|
-00000390  57 bf 27 ba 0f 39 89 da  33 49 8c 98 5b 7d 79 1a  |W.'..9..3I..[}y.|
-000003a0  a5 21 e9 58 ba d3 e2 92  54 4d 56 ca 04 11 e2 37  |.!.X....TMV....7|
-000003b0  ee bd 0d 34 40 f0 b8 39  b9 18 83 84 ed 4b 34 30  |...4@..9.....K40|
-000003c0  b3 3d 32 9f 4b 3e f2 71  a6 aa f8 38 27 37 66 fb  |.=2.K>.q...8'7f.|
-000003d0  9a a7 17 03 03 00 35 5c  d9 ba 74 58 30 02 b2 4f  |......5\..tX0..O|
-000003e0  d7 4c 4f 35 ce d7 70 7c  9c 2b 8e 4c a1 37 97 e9  |.LO5..p|.+.L.7..|
-000003f0  4e 48 b2 5b db 26 58 9e  10 de c2 e0 a9 2d cd a3  |NH.[.&X......-..|
-00000400  17 6c de f8 98 61 23 cb  51 70 de 04 17 03 03 00  |.l...a#.Qp......|
-00000410  88 d4 de bb 22 d6 5a cc  93 7e 41 02 e8 d9 0f 0e  |....".Z..~A.....|
-00000420  fc 63 5c 4c da 18 de 7d  2f ed b4 dc eb a0 96 03  |.c\L...}/.......|
-00000430  b1 90 34 3c e6 c2 f5 b6  d6 94 d3 9d 2e b0 82 7f  |..4<............|
-00000440  f0 b9 0b ad cf f3 a8 3c  38 a8 7d b5 38 bd 87 3f  |.......<8.}.8..?|
-00000450  fa 81 5c 2b 39 12 df 07  fc ab 4a f3 ce d3 f0 ca  |..\+9.....J.....|
-00000460  e0 57 73 e1 21 22 6b c2  db 2e 3b 38 32 b8 fd 2b  |.Ws.!"k...;82..+|
-00000470  f3 bd 97 22 52 78 1e b9  a8 48 f9 a6 b8 5e a4 5c  |..."Rx...H...^.\|
-00000480  bd 06 6f f6 0e 69 c4 e7  52 3d 41 d2 96 1b 20 61  |..o..i..R=A... a|
-00000490  8e d5 31 19 a9 a7 aa 71  ee                       |..1....q.|
+000000a0  14 03 03 00 01 01 17 03  03 00 17 ab 5f 7d 4f ab  |............_}O.|
+000000b0  25 00 54 5f b7 5a f9 e3  f8 ce c1 79 9f db 25 bd  |%.T_.Z.....y..%.|
+000000c0  23 17 17 03 03 02 6d 2f  59 02 6a af c5 7d a1 e1  |#.....m/Y.j..}..|
+000000d0  b3 f8 4d 80 c5 9f 54 2f  27 4c a0 c0 0d dd 0e b5  |..M...T/'L......|
+000000e0  5b 2c a4 54 f3 25 65 aa  3e 43 fb 5b de 15 76 51  |[,.T.%e.>C.[..vQ|
+000000f0  f0 5f a0 8f ce 3d 2b 27  de 0e cb af 97 65 7a 81  |._...=+'.....ez.|
+00000100  a3 d2 a1 f1 44 75 04 12  41 48 b0 70 7a b7 ce ba  |....Du..AH.pz...|
+00000110  de b5 ba 49 a4 25 08 6c  90 cb 82 b9 74 02 cf 09  |...I.%.l....t...|
+00000120  f0 83 77 a3 a4 30 ea 49  fb 61 ea 89 f6 96 b8 c1  |..w..0.I.a......|
+00000130  8a 5d a6 3d f4 f8 66 9c  3f d8 66 90 b2 93 7c 5e  |.].=..f.?.f...|^|
+00000140  3e 9d d7 4c bc 4a 2e ef  d9 d1 00 db fd 83 f3 43  |>..L.J.........C|
+00000150  a4 d7 fa 84 dd 4f a4 44  2f d2 b7 4f 5e ab a2 0e  |.....O.D/..O^...|
+00000160  86 ab 65 8d 3c 63 a2 e4  55 ce b5 72 3f 77 e8 a7  |..e.<c..U..r?w..|
+00000170  40 c7 04 4d a8 4a 38 a4  5c 6d 15 a1 3b 0c cc 2a  |@..M.J8.\m..;..*|
+00000180  7e 67 02 3b 58 95 bc e8  85 6c 81 45 81 44 a9 dd  |~g.;X....l.E.D..|
+00000190  b0 26 71 73 29 a6 1a 40  2f 5c 81 af f0 cc 2d bf  |.&qs)..@/\....-.|
+000001a0  1e fc 2e b2 7a 3a 07 22  72 25 dc d3 d1 8f 38 07  |....z:."r%....8.|
+000001b0  63 2f 18 f5 da b0 91 66  a1 47 16 ad 76 82 98 07  |c/.....f.G..v...|
+000001c0  6f a7 c8 79 43 73 4c 8c  2b 5d af 5a 7c c2 19 18  |o..yCsL.+].Z|...|
+000001d0  8d ee e2 ba fc 07 9b df  7e 17 af 54 c4 1f d8 a1  |........~..T....|
+000001e0  bd 66 93 e3 80 7e 9d a3  43 46 34 eb f9 9e 0b 77  |.f...~..CF4....w|
+000001f0  24 52 a8 85 8c 29 0b 53  0d 8b bf ba eb 8b f7 39  |$R...).S.......9|
+00000200  e4 81 95 fd e0 0d e3 de  05 31 48 37 dc 41 45 4e  |.........1H7.AEN|
+00000210  77 d1 bd f6 a8 b9 1f 82  c2 51 3f 8b d0 7e 8d 4a  |w........Q?..~.J|
+00000220  7c 13 f3 f4 cd 95 b3 51  14 80 7e 6e 41 63 de 3d  ||......Q..~nAc.=|
+00000230  f0 51 22 a4 47 43 9a 73  d2 22 58 67 47 df 1c 37  |.Q".GC.s."XgG..7|
+00000240  d7 30 ff 49 de 8b 30 1b  a9 9e c9 f1 e0 3e 19 5f  |.0.I..0......>._|
+00000250  da 15 87 69 99 e1 64 2c  fc 6b 07 61 9d ca 2f 8f  |...i..d,.k.a../.|
+00000260  b2 d4 bb a4 0e ec e2 66  eb ca aa b2 fe 91 eb 2f  |.......f......./|
+00000270  b0 d9 98 bb 9e 36 e1 e0  1f 89 5d cd 87 c8 28 85  |.....6....]...(.|
+00000280  ef c9 4a 57 6e 45 ca 07  02 be 30 1b 74 0a e4 4d  |..JWnE....0.t..M|
+00000290  2c c1 77 fe 42 73 63 e6  e4 11 15 5b c4 df 40 f7  |,.w.Bsc....[..@.|
+000002a0  83 b5 43 50 f2 a1 04 fe  b1 0e 49 63 8c 73 ab b8  |..CP......Ic.s..|
+000002b0  b4 31 d7 5e d3 50 c4 2a  a8 51 2b 81 c3 80 70 22  |.1.^.P.*.Q+...p"|
+000002c0  af d3 1f 36 ba b5 b3 d9  d9 49 17 8f d8 f7 a2 05  |...6.....I......|
+000002d0  6d 5e 46 7b 40 be 86 58  0e 90 42 46 91 6e 0d d7  |m^F{@..X..BF.n..|
+000002e0  7e f0 7f e9 5b 6e 9c d8  b5 fe 3b 8e 03 57 0a 9b  |~...[n....;..W..|
+000002f0  72 ee 5c 49 50 79 0e 75  8f 84 dd e8 2e 8d d6 37  |r.\IPy.u.......7|
+00000300  ad a8 f4 47 a6 e4 c9 e4  3b a5 7c 7f 2a 36 c5 39  |...G....;.|.*6.9|
+00000310  32 77 e1 7b a9 e7 47 b9  f2 a6 6b 75 ab 90 63 66  |2w.{..G...ku..cf|
+00000320  8d 50 62 d3 76 07 65 aa  57 87 bb a6 01 fc cb 93  |.Pb.v.e.W.......|
+00000330  c8 ed b8 64 17 03 03 00  99 1b b1 7a 13 30 73 85  |...d.......z.0s.|
+00000340  5a a4 81 29 0b 66 58 57  93 d9 24 f9 2e f9 8d cd  |Z..).fXW..$.....|
+00000350  18 d7 48 16 8d d5 95 68  42 d0 c1 1d 08 6d 12 85  |..H....hB....m..|
+00000360  ed 3d 0f a7 33 86 d9 92  fe 02 58 ce 74 7d 5c 04  |.=..3.....X.t}\.|
+00000370  12 3d af 89 c5 83 1e cd  6b 25 3a c2 c1 50 23 9a  |.=......k%:..P#.|
+00000380  f7 0f 7f c4 d8 a3 a4 99  50 a0 56 81 30 09 93 db  |........P.V.0...|
+00000390  7a eb 51 2f 65 f3 96 95  eb be 92 c6 47 57 d4 d7  |z.Q/e.......GW..|
+000003a0  cf 7c 97 19 1f 87 76 8e  41 16 af 2d 3e af 1c 1d  |.|....v.A..->...|
+000003b0  ee 0d 51 99 5b 59 e4 03  3c cb ad 18 a1 3a ae 18  |..Q.[Y..<....:..|
+000003c0  10 f2 f0 38 8f ee a0 8a  65 fd 10 ac 64 ac a8 72  |...8....e...d..r|
+000003d0  cf 54 17 03 03 00 35 bc  e8 03 81 94 22 f7 a9 16  |.T....5....."...|
+000003e0  0e 65 d4 7e 8d 18 58 b0  3c 18 97 35 0e 73 bf d0  |.e.~..X.<..5.s..|
+000003f0  65 dc 63 d7 e6 51 f6 52  75 22 f0 cf f7 70 1e ae  |e.c..Q.Ru"...p..|
+00000400  cd 4c fb 1e 21 97 ea db  07 36 8a d3 17 03 03 00  |.L..!....6......|
+00000410  8b 73 a1 d3 6c f8 7d d5  c0 79 dc 30 e4 40 f8 2a  |.s..l.}..y.0.@.*|
+00000420  60 57 69 61 b9 cb 81 9f  de 74 7c c1 ee d2 bd f5  |`Wia.....t|.....|
+00000430  bf 22 99 17 e3 05 25 3c  94 22 ee e6 6b 01 6a e9  |."....%<."..k.j.|
+00000440  39 8b 9a 08 4e 2a a8 7d  96 ae 6d 43 25 e0 03 11  |9...N*.}..mC%...|
+00000450  07 84 fb 47 fa ff 13 8f  0d a2 7e e8 a5 5d 76 e5  |...G......~..]v.|
+00000460  07 10 7d 6d f4 64 d4 54  ff 45 d9 17 18 5f e2 dd  |..}m.d.T.E..._..|
+00000470  54 ef 32 4a 69 7c 4a 16  06 6d 21 dc 67 0a 84 33  |T.2Ji|J..m!.g..3|
+00000480  13 65 86 99 0d 09 33 59  96 d8 5a 6c f4 b1 c7 8c  |.e....3Y..Zl....|
+00000490  fc bf 2b 8e e2 ee 63 28  62 bd 73 fb              |..+...c(b.s.|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 18 2f 70 9f a1  |..........5./p..|
-00000010  65 d1 39 6f 85 74 9a 33  b4 be d8 bd c3 5a 39 fb  |e.9o.t.3.....Z9.|
-00000020  52 bb 44 3b de 50 d3 15  6f 05 88 ec 4f 88 4d 1a  |R.D;.P..o...O.M.|
-00000030  d1 34 1d 3a f9 1b 1e 5e  9c 2f 35 33 b2 84 33 75  |.4.:...^./53..3u|
+00000000  14 03 03 00 01 01 17 03  03 00 35 4c 7a 0a 1d 11  |..........5Lz...|
+00000010  7c 9f 98 44 c7 f6 03 8b  9f 7b b1 dc 25 18 c2 f0  ||..D.....{..%...|
+00000020  17 b4 8c 83 68 11 0e 95  7e ce 9c ad 13 cb 79 63  |....h...~.....yc|
+00000030  03 80 d8 59 7e 25 e9 75  95 d0 6c 40 ab f2 8b f9  |...Y~%.u..l@....|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 07 ef d3  bf 2c 23 a2 62 4e 9d cd  |.........,#.bN..|
-00000010  c2 01 95 3d 26 12 88 0c  cb 38 93 36 f4 fc ff 3f  |...=&....8.6...?|
-00000020  1c 75 7b 17 03 03 00 13  60 7a 56 a8 46 13 b0 51  |.u{.....`zV.F..Q|
-00000030  e5 b1 a7 59 09 57 31 e7  9e 19 7a                 |...Y.W1...z|
+00000000  17 03 03 00 1e ce 93 89  a4 0d db 14 53 be 22 ff  |............S.".|
+00000010  53 1d 78 31 d3 17 c7 90  66 8d 2e e0 fe 98 e6 4b  |S.x1....f......K|
+00000020  ee 6d 41 17 03 03 00 13  5d b7 e7 82 68 6a 7a 71  |.mA.....]...hjzq|
+00000030  32 25 34 83 c4 63 12 f5  8e ab e9                 |2%4..c.....|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-RSA-RSAPSS b/src/crypto/tls/testdata/Server-TLSv13-RSA-RSAPSS
index 33d719b8d3..1caf8316fd 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-RSA-RSAPSS
+++ b/src/crypto/tls/testdata/Server-TLSv13-RSA-RSAPSS
@@ -1,96 +1,96 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 b2 01 00 00  ae 03 03 5c b1 42 4e f5  |...........\.BN.|
-00000010  8f 48 e9 e7 5e 4c bf 3f  25 c1 ba 11 95 de 9a 6e  |.H..^L.?%......n|
-00000020  a1 c0 55 34 c3 99 bc f5  d1 ec cb 20 dc b0 2a 8e  |..U4....... ..*.|
-00000030  0a c1 a0 cb 23 ed e4 dd  c8 90 97 a9 82 7e 6a d8  |....#........~j.|
-00000040  73 65 76 9f ef 2c 3a 44  38 ac 00 ad 00 04 13 03  |sev..,:D8.......|
+00000000  16 03 01 00 b2 01 00 00  ae 03 03 4f 1c 96 1a 7c  |...........O...||
+00000010  56 ea 59 60 5f bc 59 a4  c8 c1 ab 17 86 0b f9 d6  |V.Y`_.Y.........|
+00000020  7d 15 e4 b7 01 d3 27 55  af 8d 45 20 4b 2c f9 5c  |}.....'U..E K,.\|
+00000030  05 ff 79 28 e6 63 7e 1f  d7 10 26 07 2d ec c7 ed  |..y(.c~...&.-...|
+00000040  1c c2 07 f1 ac 3b e9 2d  1a 8d 71 a0 00 04 13 03  |.....;.-..q.....|
 00000050  00 ff 01 00 00 61 00 0b  00 04 03 00 01 02 00 0a  |.....a..........|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 16  |................|
 00000070  00 00 00 17 00 00 00 0d  00 06 00 04 08 06 08 04  |................|
 00000080  00 2b 00 03 02 03 04 00  2d 00 02 01 01 00 33 00  |.+......-.....3.|
-00000090  26 00 24 00 1d 00 20 85  c1 c2 cb 1a 48 84 5e 22  |&.$... .....H.^"|
-000000a0  20 47 32 02 5c f4 8d d6  45 32 bb 88 87 9c 30 3d  | G2.\...E2....0=|
-000000b0  83 cf 1f e5 8e 7c 28                              |.....|(|
+00000090  26 00 24 00 1d 00 20 bd  6f e3 5c 82 72 3d cf 0d  |&.$... .o.\.r=..|
+000000a0  2e 49 d0 c9 7e cc 36 88  ff 05 ed b3 c6 f1 93 9b  |.I..~.6.........|
+000000b0  2a 6c 5f ca e5 eb 0f                              |*l_....|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 dc b0 2a 8e  |........... ..*.|
-00000030  0a c1 a0 cb 23 ed e4 dd  c8 90 97 a9 82 7e 6a d8  |....#........~j.|
-00000040  73 65 76 9f ef 2c 3a 44  38 ac 00 ad 13 03 00 00  |sev..,:D8.......|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 4b 2c f9 5c  |........... K,.\|
+00000030  05 ff 79 28 e6 63 7e 1f  d7 10 26 07 2d ec c7 ed  |..y(.c~...&.-...|
+00000040  1c c2 07 f1 ac 3b e9 2d  1a 8d 71 a0 13 03 00 00  |.....;.-..q.....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 31 a8 1f 92 5a 76  |..........1...Zv|
-00000090  1b e0 15 cd 31 83 e9 1f  35 26 00 c4 07 a3 78 b3  |....1...5&....x.|
-000000a0  07 17 03 03 02 6d e9 b2  fd 16 24 36 f1 43 17 27  |.....m....$6.C.'|
-000000b0  cf e2 4f b3 36 50 af f1  79 9b a7 1f 2e 0e 3a a8  |..O.6P..y.....:.|
-000000c0  ae f2 c9 5c ed e3 87 1e  4f 1a 87 58 a7 25 ea 08  |...\....O..X.%..|
-000000d0  ad 1a fd 12 52 ad ca db  bf 46 2d b4 34 29 cc 62  |....R....F-.4).b|
-000000e0  b3 86 cc f9 64 47 e3 a9  f3 98 04 6a 95 f5 13 ae  |....dG.....j....|
-000000f0  72 ff 0e 21 eb f8 25 30  31 5e 80 20 e4 64 fe fb  |r..!..%01^. .d..|
-00000100  a4 e7 55 fb ce 01 3f 08  6e 48 e3 e2 64 f1 a6 54  |..U...?.nH..d..T|
-00000110  43 8f 43 f8 6a b7 bc a4  c5 9c 33 00 42 a2 41 db  |C.C.j.....3.B.A.|
-00000120  98 43 8b f0 05 2a 75 8d  a1 cd 18 0f 4e c5 79 b0  |.C...*u.....N.y.|
-00000130  12 5e 98 2a 5e 2d 02 30  9c f6 2f 94 02 89 42 a0  |.^.*^-.0../...B.|
-00000140  83 69 0f 8f 24 96 f6 ce  78 12 ff d2 6e d6 74 ed  |.i..$...x...n.t.|
-00000150  31 1b 09 7e 38 c8 8c cb  e1 ea eb ce 9d 77 46 47  |1..~8........wFG|
-00000160  ae c8 88 41 fe 46 b6 c0  14 e2 5e 49 f8 e6 bc 51  |...A.F....^I...Q|
-00000170  13 0a 60 66 78 9b 94 09  cc 56 06 61 62 2d cd 95  |..`fx....V.ab-..|
-00000180  93 e8 fe 5a c1 b6 b8 5e  30 94 a3 3c 5c 77 1a 41  |...Z...^0..<\w.A|
-00000190  b6 7d 6c 77 73 6a 30 87  9e 85 cf b6 e3 53 44 f1  |.}lwsj0......SD.|
-000001a0  87 19 4a d1 a7 58 cc da  43 87 dd 0d ff c4 74 cb  |..J..X..C.....t.|
-000001b0  c0 a6 ca 80 d7 29 bb 85  bb a0 ad 5b c8 52 6b 97  |.....).....[.Rk.|
-000001c0  d1 cd cb 9b e0 69 58 d8  2a bc 5c 62 5c 4a 15 28  |.....iX.*.\b\J.(|
-000001d0  db ba d9 8b b2 d5 94 c2  40 7c 96 91 cc ef 26 f1  |........@|....&.|
-000001e0  1d a7 9e 3b f7 2f be 5d  46 65 14 77 0f 40 d4 e3  |...;./.]Fe.w.@..|
-000001f0  26 42 c0 f9 db 9f cc 93  06 37 e2 84 31 61 ce 13  |&B.......7..1a..|
-00000200  40 0a e5 20 eb 7b 93 ed  77 d8 1d 04 62 c2 e3 76  |@.. .{..w...b..v|
-00000210  9f 5f 5e 44 10 4a 8e c8  7e b0 23 8a 3c 4a df af  |._^D.J..~.#.<J..|
-00000220  38 15 82 1a 47 e5 14 da  15 2e d3 8c 54 8c 15 75  |8...G.......T..u|
-00000230  87 78 82 af d4 52 4b 6e  46 b7 c4 65 0c b1 29 f7  |.x...RKnF..e..).|
-00000240  7a f2 43 9a ec e6 0b 36  e5 ae 31 71 1b 05 92 43  |z.C....6..1q...C|
-00000250  9b bd 56 ff 43 74 37 84  63 14 1b be 11 39 d4 99  |..V.Ct7.c....9..|
-00000260  f2 12 fe dc ff c8 83 9d  75 79 ba a1 db 6c aa 3a  |........uy...l.:|
-00000270  f4 a4 cf e3 a1 f8 1e 6f  a8 bc e3 9c 9a 73 e3 30  |.......o.....s.0|
-00000280  c2 63 94 ec cd 74 1a dc  ba 81 4f 67 d5 01 e3 7a  |.c...t....Og...z|
-00000290  ae 21 54 51 88 6f 1b 1d  7b 45 a8 da ef c5 47 36  |.!TQ.o..{E....G6|
-000002a0  bf 28 50 8e be 7a 44 f0  b5 39 cd a1 bb bc d4 60  |.(P..zD..9.....`|
-000002b0  59 40 a1 b8 f6 77 35 b5  42 13 25 4e ef 49 11 71  |Y@...w5.B.%N.I.q|
-000002c0  b3 a2 ab 7f 80 f2 ec 96  b5 f4 f0 ef be 65 56 20  |.............eV |
-000002d0  e4 b9 aa cf 00 b5 74 20  ca 36 77 2d 09 2e 3a 97  |......t .6w-..:.|
-000002e0  93 de 6b c3 29 f2 a8 00  e0 39 8a 41 85 67 ec fd  |..k.)....9.A.g..|
-000002f0  27 ab 54 53 e1 0f c0 5c  5e f6 2e be 6d a0 85 b7  |'.TS...\^...m...|
-00000300  a5 4c b6 0e 6e 82 b1 91  cc ad 21 ae 92 ef 28 0c  |.L..n.....!...(.|
-00000310  23 ae c7 17 03 03 00 99  12 3f 32 14 ba c1 db db  |#........?2.....|
-00000320  a9 ac 43 7b b9 b2 53 ba  da 34 32 a8 7f 58 07 e8  |..C{..S..42..X..|
-00000330  1e 1d f3 52 c6 f2 91 5d  66 94 90 19 f4 a7 44 e5  |...R...]f.....D.|
-00000340  8b c0 24 3b 86 63 f1 9d  c9 9b 94 5c 37 af 6b 98  |..$;.c.....\7.k.|
-00000350  15 bb b7 ff 8e eb d3 c5  31 62 06 ce ad ae 50 21  |........1b....P!|
-00000360  93 02 70 86 02 6f 79 4d  2b a0 28 eb 68 4e ef 25  |..p..oyM+.(.hN.%|
-00000370  01 47 ad a3 b4 09 7e e4  be e1 87 30 27 65 d0 c4  |.G....~....0'e..|
-00000380  39 c5 88 7d 6e e9 eb c6  6c 1e c1 70 84 3e 83 1e  |9..}n...l..p.>..|
-00000390  f0 fc 64 28 71 8c fd ff  fa 72 bd 3c f9 d9 13 b5  |..d(q....r.<....|
-000003a0  e3 a2 46 20 b3 67 04 58  79 df aa ca b7 9b b9 6f  |..F .g.Xy......o|
-000003b0  33 17 03 03 00 35 e6 33  b7 50 67 b4 f0 1e 6a 29  |3....5.3.Pg...j)|
-000003c0  25 22 23 f6 3c a1 72 4e  46 19 16 76 7e 80 5f c3  |%"#.<.rNF..v~._.|
-000003d0  06 46 16 02 6e 9e 5e 0f  60 7c 0a 0a 9f 84 95 28  |.F..n.^.`|.....(|
-000003e0  64 f1 9d 40 c2 56 99 49  97 f1 5e 17 03 03 00 88  |d..@.V.I..^.....|
-000003f0  bd 43 c9 3d 7c 7c 07 af  6a 03 5e d0 59 c5 9e 7c  |.C.=||..j.^.Y..||
-00000400  1f 23 08 c4 17 95 16 fa  73 37 1b 0a a3 e6 5f b1  |.#......s7...._.|
-00000410  08 4c 95 ef ae e6 d8 12  0c b6 d3 81 95 71 b7 e4  |.L...........q..|
-00000420  f9 52 fb c1 da 82 db 83  b6 0d a3 71 57 44 27 e1  |.R.........qWD'.|
-00000430  45 12 08 48 f8 21 33 51  51 42 d7 7a 1e 81 6c 28  |E..H.!3QQB.z..l(|
-00000440  50 79 18 1a 02 45 9f 63  bc c9 fb 9b aa 35 51 48  |Py...E.c.....5QH|
-00000450  d4 64 55 bf 27 dd 99 fd  d2 d1 60 05 18 0e 6f 08  |.dU.'.....`...o.|
-00000460  fe ea 8e af 1f 70 c3 e3  34 83 41 52 3e 57 d1 7d  |.....p..4.AR>W.}|
-00000470  88 2f 03 e0 1e 1a 0b c7                           |./......|
+00000080  03 03 00 01 01 17 03 03  00 17 ce 73 37 c4 06 32  |...........s7..2|
+00000090  74 c4 3d 2d 55 10 b4 ce  3f 66 fa ec 9a 8c d1 4a  |t.=-U...?f.....J|
+000000a0  cd 17 03 03 02 6d 6a 73  5d 98 e7 fc 37 d2 b8 5d  |.....mjs]...7..]|
+000000b0  2a 1c 75 80 b3 a9 ce 6e  e2 d0 b5 5c 70 2b e5 c0  |*.u....n...\p+..|
+000000c0  28 4e bf 8c af 5a 78 a2  bc 29 fd 60 68 f8 fa ed  |(N...Zx..).`h...|
+000000d0  5d 92 b2 d0 e8 69 e7 f7  1b 71 0b 30 4b c5 46 53  |]....i...q.0K.FS|
+000000e0  df 73 b9 95 65 6e cd df  26 b3 2b fd 7a 41 e9 4b  |.s..en..&.+.zA.K|
+000000f0  8c 27 a3 d5 96 ed 44 01  9d 50 a8 39 28 f7 63 3d  |.'....D..P.9(.c=|
+00000100  9e b7 1c 70 bf 2c d9 c4  67 5f 4f a7 7d b1 7a 4d  |...p.,..g_O.}.zM|
+00000110  eb bd a3 4c 3b 0b ca 92  c4 db 21 dd 36 f2 4e ce  |...L;.....!.6.N.|
+00000120  17 95 25 df bc 4a 2a 82  bb 5c 12 e4 6f ab 5a 03  |..%..J*..\..o.Z.|
+00000130  b7 7b 9f 8b 8e df ce c1  14 61 39 f1 8d f6 bb 90  |.{.......a9.....|
+00000140  a6 3a c0 21 13 9b a0 28  f6 05 34 a1 5a c5 ed 13  |.:.!...(..4.Z...|
+00000150  43 3d b6 3a 06 f8 89 ac  fe 8f 71 76 58 43 32 56  |C=.:......qvXC2V|
+00000160  71 5c ad 4c 19 e6 54 ba  32 49 83 c7 b6 5a a8 9d  |q\.L..T.2I...Z..|
+00000170  00 37 05 09 50 db c9 52  98 0d 96 03 11 22 a3 39  |.7..P..R.....".9|
+00000180  75 fe a7 34 20 0e f6 9c  a9 79 0f 9e 05 fc 5a 4e  |u..4 ....y....ZN|
+00000190  76 7c 13 0e a7 6a 1e 4a  f7 ba a7 a8 18 8d 89 4a  |v|...j.J.......J|
+000001a0  ad 34 40 81 2c e9 07 18  ba 95 48 dd 11 e7 11 0b  |.4@.,.....H.....|
+000001b0  27 fe 9f 3c e6 44 72 16  89 dc 7d 8e 22 cf 4d 96  |'..<.Dr...}.".M.|
+000001c0  60 3c 78 7a ed 6e a9 ba  d1 c3 59 b7 a7 32 bc 44  |`<xz.n....Y..2.D|
+000001d0  07 ef 1d b6 c0 21 5b 8b  b6 b9 df 4b 47 90 64 f0  |.....![....KG.d.|
+000001e0  32 3c 09 4c 8d f2 17 75  81 5a 82 f3 d8 d0 05 7b  |2<.L...u.Z.....{|
+000001f0  c8 d0 59 e3 59 a5 88 60  cc 31 0c 69 b2 05 fd b1  |..Y.Y..`.1.i....|
+00000200  16 c1 a5 00 1a 42 9e 4c  88 e0 3a 1c 68 2e 31 05  |.....B.L..:.h.1.|
+00000210  e6 09 04 c3 ef 57 00 ae  9e de a2 a3 5f fd 4e c9  |.....W......_.N.|
+00000220  e9 4c a4 51 dd 9b e1 a9  03 5c b4 19 ed 54 3f a0  |.L.Q.....\...T?.|
+00000230  a8 41 a9 bf df ca 74 ec  e7 af 4b 0d 24 ad e7 e0  |.A....t...K.$...|
+00000240  27 eb 06 26 9e 32 5c 08  3c e4 93 8e d0 50 b5 f9  |'..&.2\.<....P..|
+00000250  33 4d c5 94 f6 f1 de 02  80 9f 1e 5c 09 c2 a1 8a  |3M.........\....|
+00000260  15 89 91 91 41 71 48 2c  03 89 b7 bd e9 bd 7b 0c  |....AqH,......{.|
+00000270  61 74 f5 2a 50 bd 44 da  06 37 77 55 10 6c 5a 75  |at.*P.D..7wU.lZu|
+00000280  f0 fd c3 db c7 46 fa b5  de cf 53 f6 09 de 03 77  |.....F....S....w|
+00000290  90 57 a7 4d 4a 2c 77 10  6c 99 5d b2 24 32 c7 b3  |.W.MJ,w.l.].$2..|
+000002a0  fc 09 4e d6 e9 a7 7e a3  c8 b7 22 b5 e3 4e a1 1f  |..N...~..."..N..|
+000002b0  f9 81 06 d6 cd 42 09 49  ea 2d 98 d0 da 4f ad c2  |.....B.I.-...O..|
+000002c0  78 bd 8f 7c 2f 65 9e fc  35 be 46 bb f4 4a 2a 8f  |x..|/e..5.F..J*.|
+000002d0  46 a3 94 f5 1d b2 4b 39  07 53 d1 2a 8e e1 eb 73  |F.....K9.S.*...s|
+000002e0  57 88 16 34 03 55 56 52  50 c8 42 45 28 ef 20 ef  |W..4.UVRP.BE(. .|
+000002f0  ea c3 77 c9 a5 fe 92 51  2d ee d4 39 33 43 ae fa  |..w....Q-..93C..|
+00000300  bb 85 d1 cb eb e6 37 2c  98 f6 b5 b9 5e 1b e6 22  |......7,....^.."|
+00000310  2a 63 92 17 03 03 00 99  c6 ed c3 5d 8e 74 7e f3  |*c.........].t~.|
+00000320  f6 cc 5f e8 24 4d 78 1c  cd f1 a0 38 50 84 3a cb  |.._.$Mx....8P.:.|
+00000330  ae 8c d4 73 33 a0 10 de  ff 7b 3f a7 df 85 84 3b  |...s3....{?....;|
+00000340  36 04 4e 9e 47 fa 87 9b  a6 01 be 59 85 3c a4 ef  |6.N.G......Y.<..|
+00000350  9a 58 81 9b 67 1e 16 74  34 64 b1 3e 43 0e 83 a0  |.X..g..t4d.>C...|
+00000360  41 51 24 49 1f e3 09 16  cd b6 4a db 62 ce 8f 79  |AQ$I......J.b..y|
+00000370  19 6b 4d e4 e9 61 4f ef  43 31 e1 82 e3 57 32 01  |.kM..aO.C1...W2.|
+00000380  58 d5 67 5f bd 5e d6 f5  b9 3c 91 65 96 49 81 b2  |X.g_.^...<.e.I..|
+00000390  8c 6d a8 ba 37 2f dd 8b  bc 3a 33 9a 44 8a da e7  |.m..7/...:3.D...|
+000003a0  16 e1 d7 67 09 3a 3c d6  9f be bd 2b 50 d6 5d 3f  |...g.:<....+P.]?|
+000003b0  96 17 03 03 00 35 77 34  06 35 5c 89 77 e6 a2 f8  |.....5w4.5\.w...|
+000003c0  3f b4 9e 45 ce 29 a8 f7  24 45 7c 00 36 96 f9 c4  |?..E.)..$E|.6...|
+000003d0  7b 6b 29 78 9e 13 78 95  9f 21 64 cb 5f a0 f1 ef  |{k)x..x..!d._...|
+000003e0  3b 19 47 30 85 08 67 8f  84 b8 9c 17 03 03 00 8b  |;.G0..g.........|
+000003f0  af fb c3 c3 f4 33 c3 e7  52 e0 c2 1b 3d f3 7f 40  |.....3..R...=..@|
+00000400  7d 33 38 8e 59 7d 3e 4f  8e 93 95 f8 9c 09 56 1b  |}38.Y}>O......V.|
+00000410  68 d8 0c 11 a9 e6 6a c6  ea 6c 00 1e eb 3d d1 7b  |h.....j..l...=.{|
+00000420  fc 1b 8e 52 69 f1 30 8c  3d 9d 3a 26 6e 9e 72 d9  |...Ri.0.=.:&n.r.|
+00000430  c4 00 a1 ae 87 ca 21 fc  45 ae af 58 9f 09 38 10  |......!.E..X..8.|
+00000440  94 b2 4c 58 46 da 8f fd  c5 4a 60 0c ee 79 b7 6b  |..LXF....J`..y.k|
+00000450  5a 74 f6 b4 e6 a0 1b 0c  8f 94 d9 79 07 36 05 ea  |Zt.........y.6..|
+00000460  3b a3 11 ec 4a 86 b8 22  3c 94 eb da e1 d6 d4 91  |;...J.."<.......|
+00000470  e7 99 af 6b 39 4a 6c ef  d7 8b c7                 |...k9Jl....|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 af f3 03 dd 6d  |..........5....m|
-00000010  fa 9f 5b fe 8a 97 0e 2e  ea a1 f1 ff 35 d5 39 a3  |..[.........5.9.|
-00000020  d7 cd 47 0d 1b ae 57 aa  d0 74 3d 63 e1 87 59 b1  |..G...W..t=c..Y.|
-00000030  57 24 c6 1c 38 2f ea d9  c1 4e b1 f3 17 37 34 a4  |W$..8/...N...74.|
+00000000  14 03 03 00 01 01 17 03  03 00 35 e9 ef 1b b1 01  |..........5.....|
+00000010  b9 f2 6f e6 eb a0 52 01  81 f6 18 cf 28 f7 8a 09  |..o...R.....(...|
+00000020  65 32 30 4b 67 1b df d5  9c 4c cb 83 11 4e 3d 7f  |e20Kg....L...N=.|
+00000030  d2 b8 a2 03 de 28 2d ef  d0 68 b0 92 db 70 04 e2  |.....(-..h...p..|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e a0 9b 1d  d1 c2 bb b4 5b a8 43 d0  |............[.C.|
-00000010  58 8d 38 41 4a 93 53 95  35 5e 68 a1 00 7d b0 39  |X.8AJ.S.5^h..}.9|
-00000020  a5 38 e2 17 03 03 00 13  00 bc 3c d2 ec 93 64 fb  |.8........<...d.|
-00000030  2c 8c 18 ef 7f 1b 1d d6  5d 35 2c                 |,.......]5,|
+00000000  17 03 03 00 1e d8 d0 6a  a0 02 0a cf 78 95 08 e1  |.......j....x...|
+00000010  2f dd 6b e3 db dc 8c f7  e3 5d 6e e2 48 5d d7 2c  |/.k......]n.H].,|
+00000020  2c 26 7b 17 03 03 00 13  0a cd 02 95 d2 79 5a 1c  |,&{..........yZ.|
+00000030  8a 27 a4 90 d3 7f ff 5c  f1 b9 d8                 |.'.....\...|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-Resume b/src/crypto/tls/testdata/Server-TLSv13-Resume
index 904da58e9c..29e41c630d 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-Resume
+++ b/src/crypto/tls/testdata/Server-TLSv13-Resume
@@ -1,58 +1,59 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 63 01 00 01  5f 03 03 6a ca 53 dd 1b  |....c..._..j.S..|
-00000010  c2 e1 a2 94 d6 eb 63 11  1e 55 6e e0 ec 34 01 23  |......c..Un..4.#|
-00000020  9d 34 b6 fe 61 d3 6d ce  a5 c0 c6 20 81 93 20 ab  |.4..a.m.... .. .|
-00000030  a1 b5 2b 1b d6 6a 99 e7  11 2f e6 e0 90 45 84 32  |..+..j.../...E.2|
-00000040  a1 3f 7a 59 b8 aa cd 97  9a ba 40 35 00 04 13 01  |.?zY......@5....|
-00000050  00 ff 01 00 01 12 00 0b  00 04 03 00 01 02 00 0a  |................|
+00000000  16 03 01 01 66 01 00 01  62 03 03 45 a3 e1 2e f2  |....f...b..E....|
+00000010  03 d1 82 45 cb cd fc da  ae 9d 47 ce 2b fd 5a df  |...E......G.+.Z.|
+00000020  ad dd 7b 1a 4a 14 93 bb  d1 fe f5 20 78 6c c9 94  |..{.J...... xl..|
+00000030  6a b6 3e 65 97 42 9f c3  80 3c 8a 23 f5 af 6d 4b  |j.>e.B...<.#..mK|
+00000040  cb dc e9 93 22 bd bf b5  e6 09 0d e1 00 04 13 01  |...."...........|
+00000050  00 ff 01 00 01 15 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 0c 00 0a 00 1d 00 17  00 1e 00 19 00 18 00 23  |...............#|
 00000070  00 00 00 16 00 00 00 17  00 00 00 0d 00 1e 00 1c  |................|
 00000080  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000090  08 04 08 05 08 06 04 01  05 01 06 01 00 2b 00 03  |.............+..|
 000000a0  02 03 04 00 2d 00 02 01  01 00 33 00 26 00 24 00  |....-.....3.&.$.|
-000000b0  1d 00 20 4a 67 fa f3 3a  13 1c 9f 71 6b b5 00 a5  |.. Jg..:...qk...|
-000000c0  1b d7 b6 5c 3e 2f ad 64  23 8a 7b fe 35 eb 36 19  |...\>/.d#.{.5.6.|
-000000d0  92 07 76 00 29 00 91 00  6c 00 66 00 00 00 00 00  |..v.)...l.f.....|
+000000b0  1d 00 20 49 31 09 86 3b  71 6b ff 6c bc 6f 40 4c  |.. I1..;qk.l.o@L|
+000000c0  3a 04 44 c3 83 6c 9b 1d  99 a6 10 c7 07 f9 9d 57  |:.D..l.........W|
+000000d0  2d b4 59 00 29 00 94 00  6f 00 69 00 00 00 00 00  |-.Y.)...o.i.....|
 000000e0  00 00 00 00 00 00 00 00  00 00 00 94 68 2d a3 82  |............h-..|
-000000f0  51 ed 14 ef 68 ca 42 c5  5c 7c 58 c6 88 11 29 25  |Q...h.B.\|X...)%|
-00000100  b8 05 56 93 3f b5 60 5b  72 b9 05 af 5f 5a 7d 3c  |..V.?.`[r..._Z}<|
-00000110  00 39 4d c4 3a 8f ea ad  e8 99 76 3c 2b 52 f2 8f  |.9M.:.....v<+R..|
-00000120  5f 12 93 da 84 40 30 c8  c5 1e 47 a1 1b 94 33 2e  |_....@0...G...3.|
-00000130  cd cd e3 10 f4 54 01 e7  9f a1 e6 b4 c3 7d ae 17  |.....T.......}..|
-00000140  34 00 00 00 00 00 21 20  54 fe 95 11 63 19 4e 10  |4.....! T...c.N.|
-00000150  ed ab 34 ed 12 5c 5c be  78 de bf 0f 8c b6 55 c7  |..4..\\.x.....U.|
-00000160  2d 2e 69 dc ad 2e 5c b3                           |-.i...\.|
+000000f0  51 ed 14 ef 68 ca 42 c5  5c 95 7a 77 9a 7a 61 99  |Q...h.B.\.zw.za.|
+00000100  c6 44 1e e6 5d 71 41 c8  77 d1 d4 b6 39 bb 38 57  |.D..]qA.w...9.8W|
+00000110  41 b8 41 f2 02 96 d0 b0  5b 99 76 3c 2b 52 f2 8f  |A.A.....[.v<+R..|
+00000120  5f 33 94 fa 66 74 cc f0  60 1b ee 0a 38 30 78 b2  |_3..ft..`...80x.|
+00000130  9e 54 16 d6 71 0e b2 ea  4e 0f 13 f0 6e 63 88 e7  |.T..q...N...nc..|
+00000140  9f 55 65 0b 00 00 00 00  00 21 20 21 c5 95 b2 62  |.Ue......! !...b|
+00000150  61 dc b6 32 34 60 19 58  8c 6b 4b de dc 39 c7 d6  |a..24`.X.kK..9..|
+00000160  82 55 c8 de 80 dc b7 05  0c be a6                 |.U.........|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 80 02 00 00  7c 03 03 00 00 00 00 00  |........|.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 81 93 20 ab  |........... .. .|
-00000030  a1 b5 2b 1b d6 6a 99 e7  11 2f e6 e0 90 45 84 32  |..+..j.../...E.2|
-00000040  a1 3f 7a 59 b8 aa cd 97  9a ba 40 35 13 01 00 00  |.?zY......@5....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 78 6c c9 94  |........... xl..|
+00000030  6a b6 3e 65 97 42 9f c3  80 3c 8a 23 f5 af 6d 4b  |j.>e.B...<.#..mK|
+00000040  cb dc e9 93 22 bd bf b5  e6 09 0d e1 13 01 00 00  |...."...........|
 00000050  34 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |4.+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 00  |.........._X.;t.|
 00000080  29 00 02 00 00 14 03 03  00 01 01 17 03 03 00 17  |)...............|
-00000090  28 14 01 de c4 6a da d7  55 e5 ad e1 64 46 3b fb  |(....j..U...dF;.|
-000000a0  e1 c3 91 c3 32 27 0d 17  03 03 00 35 1c 3b 19 57  |....2'.....5.;.W|
-000000b0  ba 33 51 fe e8 ca 0f 9f  a6 dd fa cf b5 ed 64 38  |.3Q...........d8|
-000000c0  36 7d 70 cf 41 2d 25 4c  30 b1 be 99 3b 9d 1c 61  |6}p.A-%L0...;..a|
-000000d0  68 aa 41 03 a3 22 44 8b  42 bf f9 26 7e 48 53 99  |h.A.."D.B..&~HS.|
-000000e0  9f 17 03 03 00 88 94 b5  5e 15 c3 3c c8 c6 6e 10  |........^..<..n.|
-000000f0  31 d2 8f c1 d1 7c a7 4d  6c 36 c6 e0 8d 8d 85 0c  |1....|.Ml6......|
-00000100  69 6a cc 39 4d 48 79 7b  ac d9 d9 5a c9 a5 9d 02  |ij.9MHy{...Z....|
-00000110  59 1e bb 57 01 f4 64 c3  96 58 26 7e 6d c7 f7 63  |Y..W..d..X&~m..c|
-00000120  8b 9b 37 de 0a e5 b6 52  cc 3d 81 f4 99 f2 46 e4  |..7....R.=....F.|
-00000130  c9 a6 10 2e a4 b5 59 e8  87 09 33 ea 3a 61 d3 8e  |......Y...3.:a..|
-00000140  3d f1 07 bf a1 51 02 0f  2c 6c ba ae ec 0f 6e 42  |=....Q..,l....nB|
-00000150  7e df eb 5f 74 39 90 21  64 82 a8 01 3d de a2 be  |~.._t9.!d...=...|
-00000160  18 86 92 b0 41 7e de 65  cf 22 48 97 86 e5        |....A~.e."H...|
+00000090  b4 11 54 4d 78 28 66 53  0f fd c8 7c d5 1c 1d b2  |..TMx(fS...|....|
+000000a0  06 31 23 27 a4 70 b2 17  03 03 00 35 86 87 b6 21  |.1#'.p.....5...!|
+000000b0  1c db f6 8c 4f ae 46 26  27 23 5d 1f 41 1d 42 94  |....O.F&'#].A.B.|
+000000c0  68 32 e5 49 19 e9 bc ba  4e 0a e2 71 7e 31 d2 a0  |h2.I....N..q~1..|
+000000d0  c2 24 b3 a9 3d 26 a5 eb  c9 44 09 03 7a 14 54 5d  |.$..=&...D..z.T]|
+000000e0  8f 17 03 03 00 8b fd cd  ed ac c5 f2 7c 99 66 85  |............|.f.|
+000000f0  e6 0c 3b 9d ca a2 fb 22  69 fc 40 61 3a 98 f2 db  |..;...."i.@a:...|
+00000100  84 7b d9 70 06 7f 00 20  53 cb ce 27 f1 93 fd 01  |.{.p... S..'....|
+00000110  fb 0d 32 61 0d 04 93 d3  53 94 a4 37 ed a6 6e 5c  |..2a....S..7..n\|
+00000120  2f 9a 9a a9 1b b2 26 1d  24 9f 78 05 53 1d aa 40  |/.....&.$.x.S..@|
+00000130  bb 3f 27 29 ac 56 97 d7  f8 a8 77 e9 d4 b3 c0 43  |.?').V....w....C|
+00000140  a8 27 12 0f 13 fd 62 27  01 54 90 b5 66 fd d8 41  |.'....b'.T..f..A|
+00000150  a0 3a 5f b5 eb 53 25 83  f0 35 65 b2 7b f7 c6 a1  |.:_..S%..5e.{...|
+00000160  47 20 c5 91 00 69 b4 28  32 3c 55 8d 34 b9 ab b7  |G ...i.(2<U.4...|
+00000170  4b                                                |K|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 ba 45 1d a0 42  |..........5.E..B|
-00000010  5a 7c 84 4a 02 74 64 2f  74 bd ac 74 6e 16 0c fe  |Z|.J.td/t..tn...|
-00000020  e7 92 9a 68 ab 03 69 b5  d4 59 40 b7 ba eb 3b 4e  |...h..i..Y@...;N|
-00000030  b4 01 2f e1 32 c2 a8 ad  5c 3f 28 e6 91 bc 44 34  |../.2...\?(...D4|
+00000000  14 03 03 00 01 01 17 03  03 00 35 fb 04 e7 9f ad  |..........5.....|
+00000010  51 52 7e 72 61 46 df d0  80 5b 1a f3 ce 78 9e ae  |QR~raF...[...x..|
+00000020  f8 cb 08 7e 2b 45 e9 f6  20 10 e0 99 4f 1a 62 51  |...~+E.. ...O.bQ|
+00000030  4f b6 d4 2a 5e b8 04 2b  09 06 4a 03 c4 01 ca bf  |O..*^..+..J.....|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e 67 5e d3  a8 34 f5 cb 36 e3 16 e5  |.....g^..4..6...|
-00000010  f2 ef 86 36 cf 22 0e 6d  9a 6e 24 fe a5 1f e0 e7  |...6.".m.n$.....|
-00000020  28 81 f0 17 03 03 00 13  ce 6e 2d 91 26 b4 4a 5f  |(........n-.&.J_|
-00000030  0f b8 14 35 f8 67 19 f2  bd ac d1                 |...5.g.....|
+00000000  17 03 03 00 1e 5c c3 b1  a5 d9 f3 a7 0b 48 b6 1f  |.....\.......H..|
+00000010  73 ca d2 f5 07 6c e5 37  e9 b0 5f 87 a4 59 0d da  |s....l.7.._..Y..|
+00000020  e2 3f ee 17 03 03 00 13  06 d0 6c 12 91 3c 0d cf  |.?........l..<..|
+00000030  d2 0f 7f 74 e6 26 79 87  cf 76 71                 |...t.&y..vq|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-Resume-HelloRetryRequest b/src/crypto/tls/testdata/Server-TLSv13-Resume-HelloRetryRequest
index fb5584a0a4..8896455f98 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-Resume-HelloRetryRequest
+++ b/src/crypto/tls/testdata/Server-TLSv13-Resume-HelloRetryRequest
@@ -1,94 +1,94 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 01 5d 01 00 01  59 03 03 d3 5b 65 c1 4e  |....]...Y...[e.N|
-00000010  7f 6e ae c0 b6 3c 6c 32  a6 cc 9c de b6 1a c9 32  |.n...<l2.......2|
-00000020  7e 7b 76 44 b7 74 15 de  23 6e e0 20 67 74 47 9b  |~{vD.t..#n. gtG.|
-00000030  84 d3 e5 4b f1 7a 93 64  ec f6 80 a7 dd 91 7c dd  |...K.z.d......|.|
-00000040  db e3 dd 8b e3 1e d1 9c  5d 4f 71 6f 00 04 13 01  |........]Oqo....|
-00000050  00 ff 01 00 01 0c 00 0b  00 04 03 00 01 02 00 0a  |................|
+00000000  16 03 01 01 60 01 00 01  5c 03 03 c6 2c d1 55 71  |....`...\...,.Uq|
+00000010  9a 6b 02 54 cb 33 30 34  5f 22 2a bc 96 df 2e d3  |.k.T.304_"*.....|
+00000020  43 9c 9a be c9 93 b9 e1  9f 42 74 20 5d a2 d5 2d  |C........Bt ]..-|
+00000030  d6 9f 76 0c 14 dd e0 d3  71 a6 44 6a bc 3c ff a5  |..v.....q.Dj.<..|
+00000040  97 49 56 e0 3f 5b 47 87  31 83 1f 80 00 04 13 01  |.IV.?[G.1.......|
+00000050  00 ff 01 00 01 0f 00 0b  00 04 03 00 01 02 00 0a  |................|
 00000060  00 06 00 04 00 1d 00 17  00 23 00 00 00 16 00 00  |.........#......|
 00000070  00 17 00 00 00 0d 00 1e  00 1c 04 03 05 03 06 03  |................|
 00000080  08 07 08 08 08 09 08 0a  08 0b 08 04 08 05 08 06  |................|
 00000090  04 01 05 01 06 01 00 2b  00 03 02 03 04 00 2d 00  |.......+......-.|
-000000a0  02 01 01 00 33 00 26 00  24 00 1d 00 20 87 a8 1f  |....3.&.$... ...|
-000000b0  45 dc 22 d6 1c 33 d2 6b  f8 d0 8e 47 8b 61 10 51  |E."..3.k...G.a.Q|
-000000c0  67 a5 38 52 17 5a 82 01  61 8a 86 0c 09 00 29 00  |g.8R.Z..a.....).|
-000000d0  91 00 6c 00 66 00 00 00  00 00 00 00 00 00 00 00  |..l.f...........|
+000000a0  02 01 01 00 33 00 26 00  24 00 1d 00 20 8e a4 3b  |....3.&.$... ..;|
+000000b0  ae a1 3e 4f be 70 12 25  be 4d 07 59 da dc 08 4c  |..>O.p.%.M.Y...L|
+000000c0  53 e3 f3 15 b0 99 6f 5a  2d 16 30 e6 37 00 29 00  |S.....oZ-.0.7.).|
+000000d0  94 00 6f 00 69 00 00 00  00 00 00 00 00 00 00 00  |..o.i...........|
 000000e0  00 00 00 00 00 94 68 2d  a3 82 51 ed 14 ef 68 ca  |......h-..Q...h.|
-000000f0  42 c5 5c 7c 58 c6 88 11  29 25 b8 05 56 93 3f b5  |B.\|X...)%..V.?.|
-00000100  60 5b 72 b9 05 af 5f 5a  7d 3c 00 39 4d c4 3a 8f  |`[r..._Z}<.9M.:.|
-00000110  ea ad e8 99 76 3c 2b 52  f2 8f 5f 12 93 da 84 40  |....v<+R.._....@|
-00000120  30 c8 c5 1e 47 a1 1b 94  33 2e cd cd e3 10 f4 54  |0...G...3......T|
-00000130  01 e7 9f a1 e6 b4 c3 7d  ae 17 34 00 00 00 00 00  |.......}..4.....|
-00000140  21 20 aa 03 cd 24 b1 35  d0 54 f9 1e 67 94 15 8a  |! ...$.5.T..g...|
-00000150  c6 21 4b 1c f0 2d c9 a5  1a ef dc d9 63 59 2e 75  |.!K..-......cY.u|
-00000160  10 0c                                             |..|
+000000f0  42 c5 5c 95 7a 77 9a 7a  61 99 c6 44 1e e6 5d 71  |B.\.zw.za..D..]q|
+00000100  41 c8 77 d1 d4 b6 39 bb  38 57 41 b8 41 f2 02 96  |A.w...9.8WA.A...|
+00000110  d0 b0 5b 99 76 3c 2b 52  f2 8f 5f 33 94 fa 66 74  |..[.v<+R.._3..ft|
+00000120  cc f0 60 1b ee 0a 38 30  78 b2 9e 54 16 d6 71 0e  |..`...80x..T..q.|
+00000130  b2 ea 4e 0f 13 f0 6e 63  88 e7 9f 55 65 0b 00 00  |..N...nc...Ue...|
+00000140  00 00 00 21 20 f1 10 27  87 e9 eb 1d b9 5f 0e f4  |...! ..'....._..|
+00000150  67 e3 19 b6 52 b4 1a 9f  b7 68 0c 4e 25 42 3a 78  |g...R....h.N%B:x|
+00000160  91 e1 9d 62 f4                                    |...b.|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 58 02 00 00  54 03 03 cf 21 ad 74 e5  |....X...T...!.t.|
 00000010  9a 61 11 be 1d 8c 02 1e  65 b8 91 c2 a2 11 16 7a  |.a......e......z|
-00000020  bb 8c 5e 07 9e 09 e2 c8  a8 33 9c 20 67 74 47 9b  |..^......3. gtG.|
-00000030  84 d3 e5 4b f1 7a 93 64  ec f6 80 a7 dd 91 7c dd  |...K.z.d......|.|
-00000040  db e3 dd 8b e3 1e d1 9c  5d 4f 71 6f 13 01 00 00  |........]Oqo....|
+00000020  bb 8c 5e 07 9e 09 e2 c8  a8 33 9c 20 5d a2 d5 2d  |..^......3. ]..-|
+00000030  d6 9f 76 0c 14 dd e0 d3  71 a6 44 6a bc 3c ff a5  |..v.....q.Dj.<..|
+00000040  97 49 56 e0 3f 5b 47 87  31 83 1f 80 13 01 00 00  |.IV.?[G.1.......|
 00000050  0c 00 2b 00 02 03 04 00  33 00 02 00 17 14 03 03  |..+.....3.......|
 00000060  00 01 01                                          |...|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 16 03  03 01 7e 01 00 01 7a 03  |..........~...z.|
-00000010  03 d3 5b 65 c1 4e 7f 6e  ae c0 b6 3c 6c 32 a6 cc  |..[e.N.n...<l2..|
-00000020  9c de b6 1a c9 32 7e 7b  76 44 b7 74 15 de 23 6e  |.....2~{vD.t..#n|
-00000030  e0 20 67 74 47 9b 84 d3  e5 4b f1 7a 93 64 ec f6  |. gtG....K.z.d..|
-00000040  80 a7 dd 91 7c dd db e3  dd 8b e3 1e d1 9c 5d 4f  |....|.........]O|
-00000050  71 6f 00 04 13 01 00 ff  01 00 01 2d 00 0b 00 04  |qo.........-....|
+00000000  14 03 03 00 01 01 16 03  03 01 81 01 00 01 7d 03  |..............}.|
+00000010  03 c6 2c d1 55 71 9a 6b  02 54 cb 33 30 34 5f 22  |..,.Uq.k.T.304_"|
+00000020  2a bc 96 df 2e d3 43 9c  9a be c9 93 b9 e1 9f 42  |*.....C........B|
+00000030  74 20 5d a2 d5 2d d6 9f  76 0c 14 dd e0 d3 71 a6  |t ]..-..v.....q.|
+00000040  44 6a bc 3c ff a5 97 49  56 e0 3f 5b 47 87 31 83  |Dj.<...IV.?[G.1.|
+00000050  1f 80 00 04 13 01 00 ff  01 00 01 30 00 0b 00 04  |...........0....|
 00000060  03 00 01 02 00 0a 00 06  00 04 00 1d 00 17 00 23  |...............#|
 00000070  00 00 00 16 00 00 00 17  00 00 00 0d 00 1e 00 1c  |................|
 00000080  04 03 05 03 06 03 08 07  08 08 08 09 08 0a 08 0b  |................|
 00000090  08 04 08 05 08 06 04 01  05 01 06 01 00 2b 00 03  |.............+..|
 000000a0  02 03 04 00 2d 00 02 01  01 00 33 00 47 00 45 00  |....-.....3.G.E.|
-000000b0  17 00 41 04 d6 a2 de 11  90 fc 3c 5b d3 8e 79 20  |..A.......<[..y |
-000000c0  52 ac 2c 3a 75 e7 f5 e7  f9 81 4f d9 06 3a 88 20  |R.,:u.....O..:. |
-000000d0  f0 0a 74 35 f8 62 a6 18  5c dc e0 85 e7 3e 71 21  |..t5.b..\....>q!|
-000000e0  47 64 ca 12 18 39 f3 cf  a8 ae cb 71 f2 05 93 de  |Gd...9.....q....|
-000000f0  d6 0f 65 4c 00 29 00 91  00 6c 00 66 00 00 00 00  |..eL.)...l.f....|
+000000b0  17 00 41 04 ef 92 7c 5c  e3 0d 1b 5c 8f 56 a2 93  |..A...|\...\.V..|
+000000c0  62 86 e4 5d ea 0b 63 1e  e1 ea db 85 a0 28 68 89  |b..]..c......(h.|
+000000d0  07 47 d6 18 b0 6e db c2  3c 7d b4 7e a3 cb 54 25  |.G...n..<}.~..T%|
+000000e0  73 9f f6 d1 83 c1 2e 67  2a db ec 4a 09 9e 20 cf  |s......g*..J.. .|
+000000f0  3f 8b 5d 9d 00 29 00 94  00 6f 00 69 00 00 00 00  |?.]..)...o.i....|
 00000100  00 00 00 00 00 00 00 00  00 00 00 00 94 68 2d a3  |.............h-.|
-00000110  82 51 ed 14 ef 68 ca 42  c5 5c 7c 58 c6 88 11 29  |.Q...h.B.\|X...)|
-00000120  25 b8 05 56 93 3f b5 60  5b 72 b9 05 af 5f 5a 7d  |%..V.?.`[r..._Z}|
-00000130  3c 00 39 4d c4 3a 8f ea  ad e8 99 76 3c 2b 52 f2  |<.9M.:.....v<+R.|
-00000140  8f 5f 12 93 da 84 40 30  c8 c5 1e 47 a1 1b 94 33  |._....@0...G...3|
-00000150  2e cd cd e3 10 f4 54 01  e7 9f a1 e6 b4 c3 7d ae  |......T.......}.|
-00000160  17 34 00 00 00 00 00 21  20 da 69 5c da c7 3a 91  |.4.....! .i\..:.|
-00000170  2a 37 ce dc 6a 5e e2 8a  e6 55 02 4a 91 6b a6 a5  |*7..j^...U.J.k..|
-00000180  e2 54 e6 bd 04 cd 8e 9d  94                       |.T.......|
+00000110  82 51 ed 14 ef 68 ca 42  c5 5c 95 7a 77 9a 7a 61  |.Q...h.B.\.zw.za|
+00000120  99 c6 44 1e e6 5d 71 41  c8 77 d1 d4 b6 39 bb 38  |..D..]qA.w...9.8|
+00000130  57 41 b8 41 f2 02 96 d0  b0 5b 99 76 3c 2b 52 f2  |WA.A.....[.v<+R.|
+00000140  8f 5f 33 94 fa 66 74 cc  f0 60 1b ee 0a 38 30 78  |._3..ft..`...80x|
+00000150  b2 9e 54 16 d6 71 0e b2  ea 4e 0f 13 f0 6e 63 88  |..T..q...N...nc.|
+00000160  e7 9f 55 65 0b 00 00 00  00 00 21 20 fa ea cb 6c  |..Ue......! ...l|
+00000170  87 dc 71 c9 d3 b8 c5 6b  d2 4d a7 dd 01 6c f0 26  |..q....k.M...l.&|
+00000180  c6 bd 6a ce e8 37 5b a9  d3 ac 87 2d              |..j..7[....-|
 >>> Flow 4 (server to client)
 00000000  16 03 03 00 a1 02 00 00  9d 03 03 00 00 00 00 00  |................|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 67 74 47 9b  |........... gtG.|
-00000030  84 d3 e5 4b f1 7a 93 64  ec f6 80 a7 dd 91 7c dd  |...K.z.d......|.|
-00000040  db e3 dd 8b e3 1e d1 9c  5d 4f 71 6f 13 01 00 00  |........]Oqo....|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 5d a2 d5 2d  |........... ]..-|
+00000030  d6 9f 76 0c 14 dd e0 d3  71 a6 44 6a bc 3c ff a5  |..v.....q.Dj.<..|
+00000040  97 49 56 e0 3f 5b 47 87  31 83 1f 80 13 01 00 00  |.IV.?[G.1.......|
 00000050  55 00 2b 00 02 03 04 00  33 00 45 00 17 00 41 04  |U.+.....3.E...A.|
 00000060  1e 18 37 ef 0d 19 51 88  35 75 71 b5 e5 54 5b 12  |..7...Q.5uq..T[.|
 00000070  2e 8f 09 67 fd a7 24 20  3e b2 56 1c ce 97 28 5e  |...g..$ >.V...(^|
 00000080  f8 2b 2d 4f 9e f1 07 9f  6c 4b 5b 83 56 e2 32 42  |.+-O....lK[.V.2B|
 00000090  e9 58 b6 d7 49 a6 b5 68  1a 41 03 56 6b dc 5a 89  |.X..I..h.A.Vk.Z.|
-000000a0  00 29 00 02 00 00 17 03  03 00 17 5d 3a ca 45 62  |.).........]:.Eb|
-000000b0  05 6a 63 d3 98 ac f5 56  b8 8c c9 f3 c6 e2 54 b2  |.jc....V......T.|
-000000c0  9b dc 17 03 03 00 35 6f  58 51 0c 67 ed 48 f3 be  |......5oXQ.g.H..|
-000000d0  8d eb 48 5a 5a e7 92 12  4f fb 44 f2 24 bc 9a 0c  |..HZZ...O.D.$...|
-000000e0  57 29 1c 53 a6 f9 26 7c  6a db fd bd 4f 37 67 36  |W).S..&|j...O7g6|
-000000f0  c1 33 d2 6b de 39 c0 d7  46 cb 67 d9 17 03 03 00  |.3.k.9..F.g.....|
-00000100  88 6d a4 d1 1c c7 df 42  f4 c8 3c ad 93 0d 6d ff  |.m.....B..<...m.|
-00000110  04 19 eb e5 6d af 96 8b  c7 84 84 00 60 87 d8 ed  |....m.......`...|
-00000120  0d 0f ed 0d f7 96 e6 60  68 d8 22 0e 19 cd f0 77  |.......`h."....w|
-00000130  ef 1e b5 e1 e9 1a 4b d0  f8 5d 72 2e f3 71 d5 d8  |......K..]r..q..|
-00000140  26 4a 80 72 ae af 51 a0  c2 ac 03 04 14 4d 06 f3  |&J.r..Q......M..|
-00000150  ea 24 00 8e 7f 28 bd bb  ee 28 20 90 48 43 93 f5  |.$...(...( .HC..|
-00000160  5a ab fe 9b 48 e5 9e 66  7d a5 ef 59 a4 d7 f9 9b  |Z...H..f}..Y....|
-00000170  28 58 58 10 3b 15 fe 18  10 08 d1 c6 8d 87 88 b5  |(XX.;...........|
-00000180  85 b5 ea 18 0a f2 da 0d  82                       |.........|
+000000a0  00 29 00 02 00 00 17 03  03 00 17 47 b9 2a 97 3d  |.).........G.*.=|
+000000b0  84 f9 65 f5 cf 27 b3 52  6d 2d 49 9d c1 c4 ea 14  |..e..'.Rm-I.....|
+000000c0  d5 dc 17 03 03 00 35 21  4d a1 eb 9f 49 63 35 99  |......5!M...Ic5.|
+000000d0  a3 85 ce 3a 40 cf 53 29  e6 d5 59 d5 26 12 78 c6  |...:@.S)..Y.&.x.|
+000000e0  be 01 c9 a2 f2 3d ba f9  ad 80 a1 f4 78 08 71 5e  |.....=......x.q^|
+000000f0  04 7c df 80 0f 2d 5d e4  be 50 74 31 17 03 03 00  |.|...-]..Pt1....|
+00000100  8b 90 1a fd 79 a1 b9 08  4d db 32 01 6d 36 be 1a  |....y...M.2.m6..|
+00000110  3f a8 b3 c7 5b 7b b1 f0  5d 55 67 ed af 87 50 16  |?...[{..]Ug...P.|
+00000120  ad d9 f1 af d2 3c 18 83  52 d5 3b e3 6d 7e ab 9a  |.....<..R.;.m~..|
+00000130  33 cd 2c e7 f4 18 84 3a  db 8b 73 d2 89 45 39 cf  |3.,....:..s..E9.|
+00000140  f0 19 78 ab 20 b6 81 3c  3b b5 55 2c c1 6d 6f d8  |..x. ..<;.U,.mo.|
+00000150  52 1f 90 b5 ed eb e3 0c  35 40 16 ff f3 15 06 4e  |R.......5@.....N|
+00000160  7e 98 3b f7 43 f9 98 80  84 36 1c 63 a0 3c 4b 57  |~.;.C....6.c.<KW|
+00000170  f1 89 57 df 64 b3 9a 77  86 d4 bc 85 eb 8a 1c e5  |..W.d..w........|
+00000180  98 d9 f6 cb 98 e0 20 84  07 8e 9b 2b              |...... ....+|
 >>> Flow 5 (client to server)
-00000000  17 03 03 00 35 88 0a 75  2a d7 98 6c 2e 16 d0 91  |....5..u*..l....|
-00000010  1b 71 ce 33 cb ba 61 72  83 50 f0 87 33 13 bd 61  |.q.3..ar.P..3..a|
-00000020  c3 54 c1 1a a1 55 5a 79  4f c8 42 dd 43 a6 65 f2  |.T...UZyO.B.C.e.|
-00000030  70 f4 11 4b f6 44 14 06  a2 3f                    |p..K.D...?|
+00000000  17 03 03 00 35 dc 6e fd  7a 4f d5 b9 d5 d8 71 b7  |....5.n.zO....q.|
+00000010  14 b1 cb 86 5b e0 01 b1  75 ff 33 a3 42 36 bf fc  |....[...u.3.B6..|
+00000020  98 cc 15 c6 27 b2 57 1b  ce f0 b7 93 15 52 29 77  |....'.W......R)w|
+00000030  9e fe d2 4e fe 05 d3 a5  f7 01                    |...N......|
 >>> Flow 6 (server to client)
-00000000  17 03 03 00 1e e4 a8 e8  f9 cb 64 51 b1 ea 3b 16  |..........dQ..;.|
-00000010  73 d4 6f f8 44 34 ed 05  9a 8d ee 17 75 41 24 b9  |s.o.D4......uA$.|
-00000020  72 27 cf 17 03 03 00 13  8c 37 77 c4 93 7f a5 d8  |r'.......7w.....|
-00000030  a9 42 eb 2d 9d e0 dc 24  8b 40 39                 |.B.-...$.@9|
+00000000  17 03 03 00 1e 70 33 b5  fd 3d b0 d6 e4 54 9b 15  |.....p3..=...T..|
+00000010  f9 d5 2e 12 4a ce d2 ba  b2 5d fe 92 ab d0 26 da  |....J....]....&.|
+00000020  7c 0b 9e 17 03 03 00 13  ba a1 6a a9 db 16 2d cf  ||.........j...-.|
+00000030  7e 54 77 8b 0a 6e 7d 31  fc dd 5e                 |~Tw..n}1..^|
diff --git a/src/crypto/tls/testdata/Server-TLSv13-X25519 b/src/crypto/tls/testdata/Server-TLSv13-X25519
index 2b25950799..62cd23bf2a 100644
--- a/src/crypto/tls/testdata/Server-TLSv13-X25519
+++ b/src/crypto/tls/testdata/Server-TLSv13-X25519
@@ -1,97 +1,97 @@
 >>> Flow 1 (client to server)
-00000000  16 03 01 00 c2 01 00 00  be 03 03 c9 d2 1a 45 73  |..............Es|
-00000010  f0 ca 00 62 a4 05 97 67  2a 80 ef df 21 82 cb 8d  |...b...g*...!...|
-00000020  d9 d6 39 d0 a4 99 35 d8  76 20 0e 20 8b 14 39 9c  |..9...5.v . ..9.|
-00000030  c1 b0 1b d9 43 6b f7 22  01 a8 41 c8 61 89 8a 52  |....Ck."..A.a..R|
-00000040  c5 a6 5a 4a 44 f7 43 86  23 11 1d 03 00 04 13 03  |..ZJD.C.#.......|
+00000000  16 03 01 00 c2 01 00 00  be 03 03 c1 f4 f0 72 fe  |..............r.|
+00000010  b9 17 c8 9e 71 08 cf 40  80 1a 11 06 68 dc de 21  |....q..@....h..!|
+00000020  14 fe e2 2f 6e 55 cf 9b  83 87 dd 20 63 a3 3f 38  |.../nU..... c.?8|
+00000030  4c 26 be 3c c0 2e e0 e0  5d 49 1b 92 45 6b 82 a9  |L&.<....]I..Ek..|
+00000040  10 ae c0 e4 65 b0 ce 48  75 5f 5b 12 00 04 13 03  |....e..Hu_[.....|
 00000050  00 ff 01 00 00 71 00 0b  00 04 03 00 01 02 00 0a  |.....q..........|
 00000060  00 04 00 02 00 1d 00 16  00 00 00 17 00 00 00 0d  |................|
 00000070  00 1e 00 1c 04 03 05 03  06 03 08 07 08 08 08 09  |................|
 00000080  08 0a 08 0b 08 04 08 05  08 06 04 01 05 01 06 01  |................|
 00000090  00 2b 00 03 02 03 04 00  2d 00 02 01 01 00 33 00  |.+......-.....3.|
-000000a0  26 00 24 00 1d 00 20 f4  e2 fc 39 d7 81 9e f5 7b  |&.$... ...9....{|
-000000b0  9c ce d6 e4 87 9e 3c d7  92 fd fc 8c 5d 24 df 07  |......<.....]$..|
-000000c0  20 20 41 69 8d 12 08                              |  Ai...|
+000000a0  26 00 24 00 1d 00 20 3e  7f 8c d5 2f 42 d2 cd 67  |&.$... >.../B..g|
+000000b0  24 07 69 fe 7e d0 3e 70  24 e4 62 aa 19 d6 c2 00  |$.i.~.>p$.b.....|
+000000c0  5c 0d 25 10 5f 36 09                              |\.%._6.|
 >>> Flow 2 (server to client)
 00000000  16 03 03 00 7a 02 00 00  76 03 03 00 00 00 00 00  |....z...v.......|
 00000010  00 00 00 00 00 00 00 00  00 00 00 00 00 00 00 00  |................|
-00000020  00 00 00 00 00 00 00 00  00 00 00 20 8b 14 39 9c  |........... ..9.|
-00000030  c1 b0 1b d9 43 6b f7 22  01 a8 41 c8 61 89 8a 52  |....Ck."..A.a..R|
-00000040  c5 a6 5a 4a 44 f7 43 86  23 11 1d 03 13 03 00 00  |..ZJD.C.#.......|
+00000020  00 00 00 00 00 00 00 00  00 00 00 20 63 a3 3f 38  |........... c.?8|
+00000030  4c 26 be 3c c0 2e e0 e0  5d 49 1b 92 45 6b 82 a9  |L&.<....]I..Ek..|
+00000040  10 ae c0 e4 65 b0 ce 48  75 5f 5b 12 13 03 00 00  |....e..Hu_[.....|
 00000050  2e 00 2b 00 02 03 04 00  33 00 24 00 1d 00 20 2f  |..+.....3.$... /|
 00000060  e5 7d a3 47 cd 62 43 15  28 da ac 5f bb 29 07 30  |.}.G.bC.(.._.).0|
 00000070  ff f6 84 af c4 cf c2 ed  90 99 5f 58 cb 3b 74 14  |.........._X.;t.|
-00000080  03 03 00 01 01 17 03 03  00 17 41 15 f7 69 22 fb  |..........A..i".|
-00000090  e9 57 49 b1 bf 74 ae 74  27 37 8f b8 13 c7 66 68  |.WI..t.t'7....fh|
-000000a0  be 17 03 03 02 6d 40 a3  61 8f df 5f 7d 40 98 13  |.....m@.a.._}@..|
-000000b0  54 c2 60 b7 6f 0b 39 d0  9b b5 b9 fd ad b9 d3 85  |T.`.o.9.........|
-000000c0  e8 88 45 47 2e 3c a4 9e  ae 09 d8 a4 3b 96 c7 9a  |..EG.<......;...|
-000000d0  e7 32 e6 84 55 a6 19 e1  79 2b 74 70 f8 e4 be 4a  |.2..U...y+tp...J|
-000000e0  d6 75 16 96 d0 4e 2a 74  8f 5f 62 cf 82 a7 ac af  |.u...N*t._b.....|
-000000f0  de 58 50 e9 92 f5 8f ef  14 f5 f7 a3 d3 eb a9 35  |.XP............5|
-00000100  92 32 4b 90 b1 d0 06 bc  02 d3 92 d6 c4 b7 be b7  |.2K.............|
-00000110  d7 40 5e b1 49 c3 5f 2b  d2 a3 98 31 6c fd ea 94  |.@^.I._+...1l...|
-00000120  22 ee be df 23 ea 62 f0  b4 f8 d9 5e 55 06 5b d0  |"...#.b....^U.[.|
-00000130  d8 e3 6c db ee 2b 28 60  5b 1f b5 d9 2d 68 da 8f  |..l..+(`[...-h..|
-00000140  d5 67 fc 53 84 af ef d0  6c f6 cd 3a 7a 57 4a 00  |.g.S....l..:zWJ.|
-00000150  16 94 5e 7f 37 c3 f0 8f  e8 e7 a7 68 f6 56 8d 41  |..^.7......h.V.A|
-00000160  5b c4 bc c0 f9 fb 2d e0  ee fc 0d d6 b0 e4 ff 4d  |[.....-........M|
-00000170  67 1c 70 2b 43 cf df 92  11 7a 4a 29 d3 93 f8 ed  |g.p+C....zJ)....|
-00000180  dd 77 e5 28 5d b2 c9 4d  47 f3 1b db a0 ea 70 70  |.w.(]..MG.....pp|
-00000190  fe b3 90 de 24 df bb f7  0a 29 23 c7 b6 db fa 62  |....$....)#....b|
-000001a0  d2 1e 4c e2 47 0e 77 a2  e4 6d f3 ec c4 48 42 a4  |..L.G.w..m...HB.|
-000001b0  21 a4 33 5d e2 13 31 3f  5a 4d 93 a7 fe c2 ce 59  |!.3]..1?ZM.....Y|
-000001c0  cf c2 76 38 7e e6 7f b0  62 51 97 f5 dc d9 ff b4  |..v8~...bQ......|
-000001d0  9e a8 b3 73 38 b7 39 82  ac 86 80 24 8e 1e 78 33  |...s8.9....$..x3|
-000001e0  1c 0e 8b d3 4b 87 fe 5a  08 e9 0b a2 38 ff 42 d8  |....K..Z....8.B.|
-000001f0  7e 75 49 41 10 95 ba 6e  0c 42 d6 97 2a a2 b4 55  |~uIA...n.B..*..U|
-00000200  ed e9 83 4c 50 19 7d a4  9d 02 a7 27 6b d0 c6 93  |...LP.}....'k...|
-00000210  6c d4 69 21 de 2b d8 c8  82 fb de 04 15 c7 a1 f8  |l.i!.+..........|
-00000220  25 2a fa 24 dd f7 f7 52  23 95 6f b7 82 13 c5 16  |%*.$...R#.o.....|
-00000230  f7 20 fc a3 f9 43 4b da  4b 07 ae e9 4b ed 50 5c  |. ...CK.K...K.P\|
-00000240  b7 14 9c 2b 0f 94 e2 21  ef be 30 e1 60 a7 ca 10  |...+...!..0.`...|
-00000250  b0 da 93 c8 1d 5f 0c 58  93 4c 43 cd 4b 18 fb 4f  |....._.X.LC.K..O|
-00000260  81 ed dd 12 2e 8f 16 60  b6 db dc ff d8 d2 4b 59  |.......`......KY|
-00000270  2a 8b d3 22 bc 5d 3b 19  d6 f0 98 4e 03 9e b3 4b  |*..".];....N...K|
-00000280  cf 01 b7 cd 67 3a c8 a8  c7 92 e9 2f 44 dc 51 c2  |....g:...../D.Q.|
-00000290  44 a6 5a e4 8f f4 a7 d2  25 12 9c a1 ba d3 33 58  |D.Z.....%.....3X|
-000002a0  8d 23 c9 de ec bd f9 38  5f 34 9a a0 1b 59 a1 a6  |.#.....8_4...Y..|
-000002b0  a5 f8 05 ec 25 85 84 d2  02 ae b8 93 6f 64 79 cc  |....%.......ody.|
-000002c0  3a 7f a2 62 3a 6f fb 8f  9f c3 e5 ab d7 43 80 f9  |:..b:o.......C..|
-000002d0  a3 b7 91 0b 0f 00 de 7d  28 3e a0 84 b1 99 b0 a8  |.......}(>......|
-000002e0  15 ef 55 da a2 73 45 3f  6f 27 30 20 f4 ae 27 bc  |..U..sE?o'0 ..'.|
-000002f0  1f f7 a4 4f 41 44 19 9a  08 02 0a c7 2d f4 ab 3f  |...OAD......-..?|
-00000300  ac 20 f0 e6 b6 59 30 fc  13 9c ab c6 40 4c 86 1f  |. ...Y0.....@L..|
-00000310  75 6e 1b 17 03 03 00 99  ce ae 85 cd b6 a3 3b 40  |un............;@|
-00000320  19 ad 79 0a eb b3 28 0b  91 df cb 06 6b 49 59 2b  |..y...(.....kIY+|
-00000330  d8 b3 98 2f 2a 0c 4a 21  1f 08 b1 69 c7 71 cf ba  |.../*.J!...i.q..|
-00000340  3a 92 de 20 1d 03 a1 f8  31 3a 5d 32 1e 20 38 4e  |:.. ....1:]2. 8N|
-00000350  5a 41 a3 30 3e b3 37 60  e7 86 1d bb 53 46 70 7a  |ZA.0>.7`....SFpz|
-00000360  ca 10 b8 01 83 7e 1b 18  f7 b4 b8 d1 f1 89 fd 9d  |.....~..........|
-00000370  b8 06 b1 7c 51 b9 0e 2d  f9 30 79 cd fc cb ce 1a  |...|Q..-.0y.....|
-00000380  83 6f 19 d3 52 f7 5e 76  93 41 65 84 53 c9 52 1d  |.o..R.^v.Ae.S.R.|
-00000390  fb 25 bd 6e d4 b5 de 70  ab ce a5 31 0b 54 ed 32  |.%.n...p...1.T.2|
-000003a0  33 54 bc 96 ce 8f 48 0c  1a 8a c0 36 3b bc 85 23  |3T....H....6;..#|
-000003b0  b9 17 03 03 00 35 be 18  03 d8 e9 8c d1 bb e0 52  |.....5.........R|
-000003c0  a0 47 b4 bb 27 26 18 6f  6f 86 05 e4 6a fc ce 24  |.G..'&.oo...j..$|
-000003d0  e0 7e 2b 2f 0d 0a aa a4  e2 f4 1e 8a 13 d4 a1 78  |.~+/...........x|
-000003e0  26 fb fa 50 84 dd 44 f8  82 41 a2 17 03 03 00 88  |&..P..D..A......|
-000003f0  23 77 4e fb 83 21 4e bd  5d 80 a0 45 5f 04 44 de  |#wN..!N.]..E_.D.|
-00000400  67 ec a3 7b a3 bd 2c 50  b7 a2 2f 6a 80 f7 89 18  |g..{..,P../j....|
-00000410  62 4a 15 8d 97 06 7a 36  ae f6 3f 22 0d d6 c8 d0  |bJ....z6..?"....|
-00000420  fa dc 7a 1a 14 78 d3 52  a0 19 ee cc 8b d7 70 79  |..z..x.R......py|
-00000430  c1 f3 09 d7 bf e3 ae df  bc 62 1d 49 75 df b5 3f  |.........b.Iu..?|
-00000440  fc b1 9d 20 16 56 f1 52  45 61 a4 8c 8e 54 d6 47  |... .V.REa...T.G|
-00000450  95 da 7c 72 3d 0a a8 0d  eb d4 c7 93 02 62 68 52  |..|r=........bhR|
-00000460  b4 bc a4 8e 11 3b 37 f8  ed 70 38 55 e5 34 e7 55  |.....;7..p8U.4.U|
-00000470  f6 76 71 2a 32 93 dd d5                           |.vq*2...|
+00000080  03 03 00 01 01 17 03 03  00 17 4f 52 70 18 74 9c  |..........ORp.t.|
+00000090  40 4e b0 5a 7a bc aa b0  b9 22 70 b1 90 9c 04 ef  |@N.Zz...."p.....|
+000000a0  e7 17 03 03 02 6d a8 7e  5a 4a 5f 3d 97 f2 74 93  |.....m.~ZJ_=..t.|
+000000b0  ce 75 f5 be 0f 2e c4 58  d6 91 4d fb 9f 80 56 3c  |.u.....X..M...V<|
+000000c0  9c d8 ea 20 2e f7 ce 34  80 af 47 0f 41 3f f9 2f  |... ...4..G.A?./|
+000000d0  23 c1 94 9e de 51 43 c5  1e 31 98 e6 15 33 63 64  |#....QC..1...3cd|
+000000e0  22 39 87 83 87 66 d0 9e  85 2a b2 62 5e fd 50 ec  |"9...f...*.b^.P.|
+000000f0  0f d0 ec dd d4 75 57 0d  3f 7e a3 a4 40 f7 67 d2  |.....uW.?~..@.g.|
+00000100  22 ba 5f a1 38 0b ea 8e  7d 95 43 70 52 0f b0 5f  |"._.8...}.CpR.._|
+00000110  ef 26 5a 52 a6 94 b4 69  89 e9 0e 4f f5 d8 60 1b  |.&ZR...i...O..`.|
+00000120  d3 6a fd 74 8d 19 ce 6a  72 f1 c1 96 f9 86 66 3b  |.j.t...jr.....f;|
+00000130  2b 38 b3 e3 76 4b fd 4a  82 3e f2 2c bc 4c 19 d7  |+8..vK.J.>.,.L..|
+00000140  7a 62 21 3e 7c 41 ff 23  87 66 81 79 f0 ad a1 3e  |zb!>|A.#.f.y...>|
+00000150  c2 e9 f3 ba 38 3a b5 ad  49 f3 ae 70 71 0a af d2  |....8:..I..pq...|
+00000160  f3 ae 70 df fd 93 8c 3d  ca bd 8c 86 39 c9 9c d4  |..p....=....9...|
+00000170  a9 a8 37 04 92 9b 0a 4e  8d 43 96 3d a4 b5 e0 5d  |..7....N.C.=...]|
+00000180  18 b1 03 32 0a b5 f2 e6  8c ca 1d ff cf 39 b7 00  |...2.........9..|
+00000190  5a 5a 1a 3d de 75 17 84  12 a4 f1 08 9d b3 ae 56  |ZZ.=.u.........V|
+000001a0  9d e9 af 30 67 64 fb 13  9a de 2e ba 03 ee 52 4c  |...0gd........RL|
+000001b0  4f 85 f3 1b fc d0 ef 75  1a 31 99 d9 89 74 41 9d  |O......u.1...tA.|
+000001c0  c8 96 48 49 f5 f3 ca 8c  6f 08 67 2a d1 b5 05 19  |..HI....o.g*....|
+000001d0  13 6b 0b 4c 87 f8 00 ab  83 70 4e bb 7e c7 f3 1e  |.k.L.....pN.~...|
+000001e0  ba 83 4b 7f 65 c2 42 8d  00 b1 3e 3d f8 4d c3 7a  |..K.e.B...>=.M.z|
+000001f0  b9 af 68 dc 0d 24 7a a6  41 15 16 db fb 57 99 68  |..h..$z.A....W.h|
+00000200  a9 35 77 40 6a 45 94 d3  e0 03 8d 41 86 d5 51 c6  |.5w@jE.....A..Q.|
+00000210  05 27 c5 56 97 30 41 44  26 18 e0 0f 93 cc f2 5e  |.'.V.0AD&......^|
+00000220  f1 35 35 0f 54 25 51 23  78 37 39 80 d9 c2 e8 54  |.55.T%Q#x79....T|
+00000230  79 16 e0 e0 36 cf f1 8b  23 fa 67 46 66 e0 25 0e  |y...6...#.gFf.%.|
+00000240  25 33 c4 52 93 ac 12 e0  8e f9 e8 c9 ec e7 f8 e6  |%3.R............|
+00000250  09 81 c1 d1 89 33 24 a3  c6 c7 27 6c 3b c8 b7 4f  |.....3$...'l;..O|
+00000260  8a 14 ed 58 a7 5f ba fc  cc 4f 6b eb ff c2 60 68  |...X._...Ok...`h|
+00000270  41 9c 4b b6 34 10 a6 8f  f8 3c 47 2f 39 75 86 03  |A.K.4....<G/9u..|
+00000280  60 35 06 84 f2 96 35 39  0a c2 3e cb 3c fa d8 fa  |`5....59..>.<...|
+00000290  66 3c 9c c9 6b 32 3f ea  bd 5d 4d 75 e5 4b 88 93  |f<..k2?..]Mu.K..|
+000002a0  1f 47 73 3b 55 8a e0 e4  7e e5 2f dc 2d d4 f6 c0  |.Gs;U...~./.-...|
+000002b0  3a b4 e4 72 b2 5a 0d d1  10 28 3f 61 73 96 94 d0  |:..r.Z...(?as...|
+000002c0  fb 26 83 95 0e 7a 47 6d  75 d4 f4 ad cc 3e 8f 4c  |.&...zGmu....>.L|
+000002d0  3b 95 83 61 40 4f 3e 82  58 d0 ca 7f 1d 9a e3 86  |;..a@O>.X.......|
+000002e0  48 53 1f 5d 35 9d 1e 46  c2 4b 70 53 60 1e 1d 04  |HS.]5..F.KpS`...|
+000002f0  9c 5b 6a f2 0b fc 4d 04  a6 38 85 b8 f1 06 cd 40  |.[j...M..8.....@|
+00000300  bb 73 fa bf 75 21 70 93  31 83 8d 8a a4 b3 4a 2f  |.s..u!p.1.....J/|
+00000310  45 f0 b2 17 03 03 00 99  eb ae 23 e6 63 22 52 ac  |E.........#.c"R.|
+00000320  2b 69 05 9d 7d b3 c6 b6  1f 5b 00 7c fb 67 1b af  |+i..}....[.|.g..|
+00000330  42 38 40 ea ca bb dc 7d  92 94 dd ed 1a 20 65 8a  |B8@....}..... e.|
+00000340  5c a3 5c 28 9f 10 8b 11  61 bb 0a 56 5a ef ec 7a  |\.\(....a..VZ..z|
+00000350  50 b5 2d 67 62 77 80 dc  ee a6 cd f3 09 ff 8f d8  |P.-gbw..........|
+00000360  ff 6d d8 47 95 58 cf 2b  e7 b0 f8 26 61 58 35 a3  |.m.G.X.+...&aX5.|
+00000370  07 4d 2f 99 5d 33 6b e8  ac 6a 14 ef 2c 57 9a e3  |.M/.]3k..j..,W..|
+00000380  b7 1b bf d6 bf b8 6a 29  4a 74 0d 15 91 90 c3 4a  |......j)Jt.....J|
+00000390  40 13 8c 52 e6 67 d6 de  6c d8 4e 35 20 d3 0b e6  |@..R.g..l.N5 ...|
+000003a0  36 58 4e 79 3a 03 f0 bc  34 1b 3e 7e e3 ad d8 e3  |6XNy:...4.>~....|
+000003b0  58 17 03 03 00 35 ba 6d  a2 40 3a cb 43 80 cb af  |X....5.m.@:.C...|
+000003c0  df 8f 2c 0d 20 53 f5 13  06 6b 0b e8 e7 36 31 4b  |..,. S...k...61K|
+000003d0  19 ad 86 5e 39 2e 52 5a  d9 86 f4 64 0e 8c 9a d5  |...^9.RZ...d....|
+000003e0  9a a2 c1 81 65 1e da 05  28 8a 36 17 03 03 00 8b  |....e...(.6.....|
+000003f0  48 2d b0 5b 7e 39 95 b2  6a de 46 53 fb ba 7b 12  |H-.[~9..j.FS..{.|
+00000400  26 a1 1a b0 24 c0 8c c3  77 e1 0e 09 1c 5f 6a 7b  |&...$...w...._j{|
+00000410  03 0b 3d 92 77 81 b1 97  22 0f 6e cd 04 97 28 79  |..=.w...".n...(y|
+00000420  eb 88 3d 7b 20 93 0b 67  df 32 2e bb 38 13 8f 28  |..={ ..g.2..8..(|
+00000430  c1 b8 2c 22 75 42 01 b8  50 2c 20 30 91 0d e5 a0  |..,"uB..P, 0....|
+00000440  5c dd 5b 53 c6 30 fd b4  a5 f7 e9 6f 49 61 70 32  |\.[S.0.....oIap2|
+00000450  7f fd bb 08 c4 93 e8 e2  0a f6 7d 0f e8 94 22 fe  |..........}...".|
+00000460  af b7 b6 4a 35 d1 63 6c  bd ce 1e 72 63 ca 05 7c  |...J5.cl...rc..||
+00000470  64 4d ae 94 28 b2 15 b5  71 16 77                 |dM..(...q.w|
 >>> Flow 3 (client to server)
-00000000  14 03 03 00 01 01 17 03  03 00 35 d2 f9 fa 20 90  |..........5... .|
-00000010  ca b6 f2 98 52 46 d8 df  19 39 0a 04 7b f5 38 2e  |....RF...9..{.8.|
-00000020  c4 56 89 a3 c0 60 b4 0e  87 c2 78 a8 d1 b8 2a 07  |.V...`....x...*.|
-00000030  00 d3 8f b8 c0 5c d2 bd  cc 37 b5 ba 4f 8e dd a6  |.....\...7..O...|
+00000000  14 03 03 00 01 01 17 03  03 00 35 97 9f be 06 f2  |..........5.....|
+00000010  96 ae fa 11 e0 23 2b 6a  b0 2e f5 e9 fc 10 b2 36  |.....#+j.......6|
+00000020  dc 62 b0 70 1e 42 e3 c5  ce c8 f7 a7 cb 1b c6 3b  |.b.p.B.........;|
+00000030  59 23 d0 10 be f5 f0 1e  38 f4 63 bd 36 28 24 eb  |Y#......8.c.6($.|
 >>> Flow 4 (server to client)
-00000000  17 03 03 00 1e a1 95 8f  0b 7e 43 3f be 2f 19 78  |.........~C?./.x|
-00000010  e4 52 c5 e2 17 6f 49 87  90 eb d4 4e 9b a1 de 61  |.R...oI....N...a|
-00000020  b6 f5 f8 17 03 03 00 13  1c 7e a3 be 1c cb 33 78  |.........~....3x|
-00000030  23 d8 a6 06 d3 dc 3a d5  6c e7 dd                 |#.....:.l..|
+00000000  17 03 03 00 1e 05 1b a2  f1 4b 74 46 76 1b 23 77  |.........KtFv.#w|
+00000010  79 df f1 67 bf e9 39 f3  b7 56 76 ba fa 4f 30 49  |y..g..9..Vv..O0I|
+00000020  18 7b 52 17 03 03 00 13  ef 66 20 67 cb 74 a9 b6  |.{R......f g.t..|
+00000030  93 6f cc a3 9e d5 f2 7d  81 10 71                 |.o.....}..q|
diff --git a/src/crypto/tls/ticket.go b/src/crypto/tls/ticket.go
index 71f4df8f7f..1a94c04eee 100644
--- a/src/crypto/tls/ticket.go
+++ b/src/crypto/tls/ticket.go
@@ -37,16 +37,16 @@ type SessionState struct {
 	//       uint8 ext_master_secret = { 0, 1 };
 	//       uint8 early_data = { 0, 1 };
 	//       CertificateEntry certificate_list<0..2^24-1>;
+	//       CertificateChain verified_chains<0..2^24-1>; /* excluding leaf */
 	//       select (SessionState.early_data) {
 	//           case 0: Empty;
 	//           case 1: opaque alpn<1..2^8-1>;
 	//       };
 	//       select (SessionState.type) {
-	//           case server: /* empty */;
+	//           case server: Empty;
 	//           case client: struct {
-	//               CertificateChain verified_chains<0..2^24-1>; /* excluding leaf */
 	//               select (SessionState.version) {
-	//                   case VersionTLS10..VersionTLS12: /* empty */;
+	//                   case VersionTLS10..VersionTLS12: Empty;
 	//                   case VersionTLS13: struct {
 	//                       uint64 use_by;
 	//                       uint32 age_add;
@@ -87,11 +87,9 @@ type SessionState struct {
 	activeCertHandles []*activeCert
 	ocspResponse      []byte
 	scts              [][]byte
+	verifiedChains    [][]*x509.Certificate
 	alpnProtocol      string // only set if EarlyData is true
 
-	// Client-side fields.
-	verifiedChains [][]*x509.Certificate
-
 	// Client-side TLS 1.3-only fields.
 	useBy  uint64 // seconds since UNIX epoch
 	ageAdd uint32
@@ -129,29 +127,33 @@ func (s *SessionState) Bytes() ([]byte, error) {
 	} else {
 		b.AddUint8(0)
 	}
-	marshalCertificate(&b, s.certificate())
+	marshalCertificate(&b, Certificate{
+		Certificate:                 certificatesToBytesSlice(s.peerCertificates),
+		OCSPStaple:                  s.ocspResponse,
+		SignedCertificateTimestamps: s.scts,
+	})
+	b.AddUint24LengthPrefixed(func(b *cryptobyte.Builder) {
+		for _, chain := range s.verifiedChains {
+			b.AddUint24LengthPrefixed(func(b *cryptobyte.Builder) {
+				// We elide the first certificate because it's always the leaf.
+				if len(chain) == 0 {
+					b.SetError(errors.New("tls: internal error: empty verified chain"))
+					return
+				}
+				for _, cert := range chain[1:] {
+					b.AddUint24LengthPrefixed(func(b *cryptobyte.Builder) {
+						b.AddBytes(cert.Raw)
+					})
+				}
+			})
+		}
+	})
 	if s.EarlyData {
 		b.AddUint8LengthPrefixed(func(b *cryptobyte.Builder) {
 			b.AddBytes([]byte(s.alpnProtocol))
 		})
 	}
 	if s.isClient {
-		b.AddUint24LengthPrefixed(func(b *cryptobyte.Builder) {
-			for _, chain := range s.verifiedChains {
-				b.AddUint24LengthPrefixed(func(b *cryptobyte.Builder) {
-					// We elide the first certificate because it's always the leaf.
-					if len(chain) == 0 {
-						b.SetError(errors.New("tls: internal error: empty verified chain"))
-						return
-					}
-					for _, cert := range chain[1:] {
-						b.AddUint24LengthPrefixed(func(b *cryptobyte.Builder) {
-							b.AddBytes(cert.Raw)
-						})
-					}
-				})
-			}
-		})
 		if s.version >= VersionTLS13 {
 			addUint64(&b, s.useBy)
 			b.AddUint32(s.ageAdd)
@@ -160,14 +162,6 @@ func (s *SessionState) Bytes() ([]byte, error) {
 	return b.Bytes()
 }
 
-func (s *SessionState) certificate() Certificate {
-	return Certificate{
-		Certificate:                 certificatesToBytesSlice(s.peerCertificates),
-		OCSPStaple:                  s.ocspResponse,
-		SignedCertificateTimestamps: s.scts,
-	}
-}
-
 func certificatesToBytesSlice(certs []*x509.Certificate) [][]byte {
 	s := make([][]byte, 0, len(certs))
 	for _, c := range certs {
@@ -221,23 +215,6 @@ func ParseSessionState(data []byte) (*SessionState, error) {
 	}
 	ss.ocspResponse = cert.OCSPStaple
 	ss.scts = cert.SignedCertificateTimestamps
-	if ss.EarlyData {
-		var alpn []byte
-		if !readUint8LengthPrefixed(&s, &alpn) {
-			return nil, errors.New("tls: invalid session encoding")
-		}
-		ss.alpnProtocol = string(alpn)
-	}
-	if isClient := typ == 2; !isClient {
-		if !s.Empty() {
-			return nil, errors.New("tls: invalid session encoding")
-		}
-		return ss, nil
-	}
-	ss.isClient = true
-	if len(ss.peerCertificates) == 0 {
-		return nil, errors.New("tls: no server certificates in client session")
-	}
 	var chainList cryptobyte.String
 	if !s.ReadUint24LengthPrefixed(&chainList) {
 		return nil, errors.New("tls: invalid session encoding")
@@ -248,6 +225,9 @@ func ParseSessionState(data []byte) (*SessionState, error) {
 			return nil, errors.New("tls: invalid session encoding")
 		}
 		var chain []*x509.Certificate
+		if len(ss.peerCertificates) == 0 {
+			return nil, errors.New("tls: invalid session encoding")
+		}
 		chain = append(chain, ss.peerCertificates[0])
 		for !certList.Empty() {
 			var cert []byte
@@ -263,6 +243,23 @@ func ParseSessionState(data []byte) (*SessionState, error) {
 		}
 		ss.verifiedChains = append(ss.verifiedChains, chain)
 	}
+	if ss.EarlyData {
+		var alpn []byte
+		if !readUint8LengthPrefixed(&s, &alpn) {
+			return nil, errors.New("tls: invalid session encoding")
+		}
+		ss.alpnProtocol = string(alpn)
+	}
+	if isClient := typ == 2; !isClient {
+		if !s.Empty() {
+			return nil, errors.New("tls: invalid session encoding")
+		}
+		return ss, nil
+	}
+	ss.isClient = true
+	if len(ss.peerCertificates) == 0 {
+		return nil, errors.New("tls: no server certificates in client session")
+	}
 	if ss.version < VersionTLS13 {
 		if !s.Empty() {
 			return nil, errors.New("tls: invalid session encoding")
@@ -278,13 +275,6 @@ func ParseSessionState(data []byte) (*SessionState, error) {
 // sessionState returns a partially filled-out [SessionState] with information
 // from the current connection.
 func (c *Conn) sessionState() (*SessionState, error) {
-	var verifiedChains [][]*x509.Certificate
-	if c.isClient {
-		verifiedChains = c.verifiedChains
-		if len(c.peerCertificates) == 0 {
-			return nil, errors.New("tls: internal error: empty peer certificates")
-		}
-	}
 	return &SessionState{
 		version:           c.vers,
 		cipherSuite:       c.cipherSuite,
@@ -296,7 +286,7 @@ func (c *Conn) sessionState() (*SessionState, error) {
 		scts:              c.scts,
 		isClient:          c.isClient,
 		extMasterSecret:   c.extMasterSecret,
-		verifiedChains:    verifiedChains,
+		verifiedChains:    c.verifiedChains,
 	}, nil
 }
 
diff --git a/src/crypto/tls/tls_test.go b/src/crypto/tls/tls_test.go
index 4e4d6a9d21..c3f16c704a 100644
--- a/src/crypto/tls/tls_test.go
+++ b/src/crypto/tls/tls_test.go
@@ -1658,3 +1658,147 @@ func TestPKCS1OnlyCert(t *testing.T) {
 		t.Error(err)
 	}
 }
+
+func TestVerifyCertificates(t *testing.T) {
+	// See https://go.dev/issue/31641.
+	t.Run("TLSv12", func(t *testing.T) { testVerifyCertificates(t, VersionTLS12) })
+	t.Run("TLSv13", func(t *testing.T) { testVerifyCertificates(t, VersionTLS13) })
+}
+
+func testVerifyCertificates(t *testing.T, version uint16) {
+	tests := []struct {
+		name string
+
+		InsecureSkipVerify bool
+		ClientAuth         ClientAuthType
+		ClientCertificates bool
+	}{
+		{
+			name: "defaults",
+		},
+		{
+			name:               "InsecureSkipVerify",
+			InsecureSkipVerify: true,
+		},
+		{
+			name:       "RequestClientCert with no certs",
+			ClientAuth: RequestClientCert,
+		},
+		{
+			name:               "RequestClientCert with certs",
+			ClientAuth:         RequestClientCert,
+			ClientCertificates: true,
+		},
+		{
+			name:               "RequireAnyClientCert",
+			ClientAuth:         RequireAnyClientCert,
+			ClientCertificates: true,
+		},
+		{
+			name:       "VerifyClientCertIfGiven with no certs",
+			ClientAuth: VerifyClientCertIfGiven,
+		},
+		{
+			name:               "VerifyClientCertIfGiven with certs",
+			ClientAuth:         VerifyClientCertIfGiven,
+			ClientCertificates: true,
+		},
+		{
+			name:               "RequireAndVerifyClientCert",
+			ClientAuth:         RequireAndVerifyClientCert,
+			ClientCertificates: true,
+		},
+	}
+
+	issuer, err := x509.ParseCertificate(testRSACertificateIssuer)
+	if err != nil {
+		t.Fatal(err)
+	}
+	rootCAs := x509.NewCertPool()
+	rootCAs.AddCert(issuer)
+
+	for _, test := range tests {
+		test := test
+		t.Run(test.name, func(t *testing.T) {
+			t.Parallel()
+
+			var serverVerifyConnection, clientVerifyConnection bool
+			var serverVerifyPeerCertificates, clientVerifyPeerCertificates bool
+
+			clientConfig := testConfig.Clone()
+			clientConfig.Time = func() time.Time { return time.Unix(1476984729, 0) }
+			clientConfig.MaxVersion = version
+			clientConfig.MinVersion = version
+			clientConfig.RootCAs = rootCAs
+			clientConfig.ServerName = "example.golang"
+			clientConfig.ClientSessionCache = NewLRUClientSessionCache(1)
+			serverConfig := clientConfig.Clone()
+			serverConfig.ClientCAs = rootCAs
+
+			clientConfig.VerifyConnection = func(cs ConnectionState) error {
+				clientVerifyConnection = true
+				return nil
+			}
+			clientConfig.VerifyPeerCertificate = func(rawCerts [][]byte, verifiedChains [][]*x509.Certificate) error {
+				clientVerifyPeerCertificates = true
+				return nil
+			}
+			serverConfig.VerifyConnection = func(cs ConnectionState) error {
+				serverVerifyConnection = true
+				return nil
+			}
+			serverConfig.VerifyPeerCertificate = func(rawCerts [][]byte, verifiedChains [][]*x509.Certificate) error {
+				serverVerifyPeerCertificates = true
+				return nil
+			}
+
+			clientConfig.InsecureSkipVerify = test.InsecureSkipVerify
+			serverConfig.ClientAuth = test.ClientAuth
+			if !test.ClientCertificates {
+				clientConfig.Certificates = nil
+			}
+
+			if _, _, err := testHandshake(t, clientConfig, serverConfig); err != nil {
+				t.Fatal(err)
+			}
+
+			want := serverConfig.ClientAuth != NoClientCert
+			if serverVerifyPeerCertificates != want {
+				t.Errorf("VerifyPeerCertificates on the server: got %v, want %v",
+					serverVerifyPeerCertificates, want)
+			}
+			if !clientVerifyPeerCertificates {
+				t.Errorf("VerifyPeerCertificates not called on the client")
+			}
+			if !serverVerifyConnection {
+				t.Error("VerifyConnection did not get called on the server")
+			}
+			if !clientVerifyConnection {
+				t.Error("VerifyConnection did not get called on the client")
+			}
+
+			serverVerifyPeerCertificates, clientVerifyPeerCertificates = false, false
+			serverVerifyConnection, clientVerifyConnection = false, false
+			cs, _, err := testHandshake(t, clientConfig, serverConfig)
+			if err != nil {
+				t.Fatal(err)
+			}
+			if !cs.DidResume {
+				t.Error("expected resumption")
+			}
+
+			if serverVerifyPeerCertificates {
+				t.Error("VerifyPeerCertificates got called on the server on resumption")
+			}
+			if clientVerifyPeerCertificates {
+				t.Error("VerifyPeerCertificates got called on the client on resumption")
+			}
+			if !serverVerifyConnection {
+				t.Error("VerifyConnection did not get called on the server on resumption")
+			}
+			if !clientVerifyConnection {
+				t.Error("VerifyConnection did not get called on the client on resumption")
+			}
+		})
+	}
+}
