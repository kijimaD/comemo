commit 96cd66b266a24d8ed1f66dfa10ddb86d88b50fca
Author: Filippo Valsorda <hi@filippo.io>
Date:   Tue Oct 31 19:43:05 2017 -0400

    crypto/tls: advertise support for SHA-512 signatures in 1.2
    
    This is the equivalent change to 1c105980 but for SHA-512.
    
    SHA-512 certificates are already supported by default since b53bb2ca,
    but some servers will refuse connections if the algorithm is not
    advertised in the overloaded signatureAndHash extension (see 09b238f1).
    
    This required adding support for SHA-512 signatures on CertificateVerify
    and ServerKeyExchange messages, because of said overloading.
    
    Some testdata/Client-TLSv1{0,1} files changed because they send a 1.2
    ClientHello even if the server picks a lower version.
    
    Closes #22422
    
    Change-Id: I16282d03a3040260d203711ec21e6b20a0e1e105
    Reviewed-on: https://go-review.googlesource.com/74950
    Run-TryBot: Filippo Valsorda <hi@filippo.io>
    TryBot-Result: Gobot Gobot <gobot@golang.org>
    Reviewed-by: Adam Langley <agl@golang.org>

 src/crypto/tls/common.go                           |   2 +
 src/crypto/tls/handshake_test.go                   |   8 +-
 src/crypto/tls/prf.go                              |   2 +
 .../testdata/Client-TLSv10-ClientCert-ECDSA-ECDSA  |  94 ++--
 .../testdata/Client-TLSv10-ClientCert-ECDSA-RSA    |  90 ++--
 .../testdata/Client-TLSv10-ClientCert-RSA-ECDSA    |  92 ++--
 .../tls/testdata/Client-TLSv10-ClientCert-RSA-RSA  |  90 ++--
 .../tls/testdata/Client-TLSv10-ECDHE-ECDSA-AES     |  76 +--
 .../tls/testdata/Client-TLSv10-ECDHE-RSA-AES       |  72 +--
 src/crypto/tls/testdata/Client-TLSv10-RSA-RC4      |  40 +-
 .../tls/testdata/Client-TLSv11-ECDHE-ECDSA-AES     |  74 +--
 .../tls/testdata/Client-TLSv11-ECDHE-RSA-AES       |  72 +--
 src/crypto/tls/testdata/Client-TLSv11-RSA-RC4      |  40 +-
 .../tls/testdata/Client-TLSv12-AES128-GCM-SHA256   |  44 +-
 .../tls/testdata/Client-TLSv12-AES128-SHA256       |  58 +--
 .../tls/testdata/Client-TLSv12-AES256-GCM-SHA384   |  44 +-
 src/crypto/tls/testdata/Client-TLSv12-ALPN         |  63 +--
 .../testdata/Client-TLSv12-ClientCert-ECDSA-ECDSA  |  96 ++--
 .../testdata/Client-TLSv12-ClientCert-ECDSA-RSA    |  88 ++--
 .../Client-TLSv12-ClientCert-RSA-AES256-GCM-SHA384 |  84 ++--
 .../testdata/Client-TLSv12-ClientCert-RSA-ECDSA    | 100 ++--
 .../tls/testdata/Client-TLSv12-ClientCert-RSA-RSA  |  84 ++--
 .../tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES     |  74 +--
 .../tls/testdata/Client-TLSv12-ECDHE-ECDSA-AES-GCM |  68 +--
 .../Client-TLSv12-ECDHE-ECDSA-AES128-SHA256        |  84 ++--
 .../Client-TLSv12-ECDHE-ECDSA-AES256-GCM-SHA384    |  68 +--
 .../Client-TLSv12-ECDHE-ECDSA-CHACHA20-POLY1305    |  64 +--
 .../tls/testdata/Client-TLSv12-ECDHE-RSA-AES       |  72 +--
 .../testdata/Client-TLSv12-ECDHE-RSA-AES128-SHA256 |  80 ++--
 .../Client-TLSv12-ECDHE-RSA-CHACHA20-POLY1305      |  60 +--
 src/crypto/tls/testdata/Client-TLSv12-RSA-RC4      |  40 +-
 .../tls/testdata/Client-TLSv12-RenegotiateOnce     | 292 +++++-------
 .../tls/testdata/Client-TLSv12-RenegotiateTwice    | 522 +++++++++------------
 .../Client-TLSv12-RenegotiateTwiceRejected         | 298 +++++-------
 .../testdata/Client-TLSv12-RenegotiationRejected   |  68 +--
 src/crypto/tls/testdata/Client-TLSv12-SCT          |  62 +--
 .../Client-TLSv12-X25519-ECDHE-RSA-AES-GCM         |  65 +--
 src/crypto/tls/testdata/Server-TLSv12-ALPN         |  64 +--
 src/crypto/tls/testdata/Server-TLSv12-ALPN-NoMatch |  64 +--
 .../Server-TLSv12-CipherSuiteCertPreferenceECDSA   |  66 +--
 .../Server-TLSv12-CipherSuiteCertPreferenceRSA     |  60 +--
 .../Server-TLSv12-ClientAuthRequestedAndECDSAGiven |  76 ++-
 .../Server-TLSv12-ClientAuthRequestedAndGiven      |  78 +--
 .../Server-TLSv12-ClientAuthRequestedNotGiven      |  60 +--
 .../tls/testdata/Server-TLSv12-ECDHE-ECDSA-AES     |  62 +--
 src/crypto/tls/testdata/Server-TLSv12-RSA-AES-GCM  |  50 +-
 .../testdata/Server-TLSv12-RSA-AES256-GCM-SHA384   |  50 +-
 .../Server-TLSv12-X25519-ECDHE-RSA-AES-GCM         |  50 +-
 48 files changed, 1902 insertions(+), 2108 deletions(-)
