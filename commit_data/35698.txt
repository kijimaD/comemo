commit fb4fb0430b8d77b5487f51fd780bba25476e816c
Author: Tobias Klauser <tklauser@distanz.ch>
Date:   Wed Jun 13 15:54:42 2018 +0200

    syscall: check Fchmodat flags parameter on Linux
    
    As mentioned in #25845, port CL 46474 from golang.org/x/sys/unix to the
    syscall package.
    
    Currently Linux' fchmodat(2) syscall implementation doesn't support the
    flags parameter (though it might in future versions [1]). Fchmodat in
    the syscall package takes the parameter and (wrongly) passes it on to the
    syscall which will ignore it.
    
    According to the POSIX.1-2008 manual page [2], AT_SYMLINK_NOFOLLOW is
    the only valid value for the flags parameter and EOPNOTSUPP should be
    returned in case changing the mode of a symbolic link is not supported
    by the underlying system. EINVAL should be returned for any other value
    of the flags parameter.
    
      [1] https://patchwork.kernel.org/patch/9596301/
      [2] http://pubs.opengroup.org/onlinepubs/9699919799/functions/chmod.html
    
    Updates #20130
    Updates #25845
    
    Change-Id: I1021dd0e6a4f4cb3557cb1c1b34dd618c378cda6
    Reviewed-on: https://go-review.googlesource.com/118658
    Reviewed-by: Ian Lance Taylor <iant@golang.org>

 src/syscall/syscall_linux.go           | 15 +++++++-
 src/syscall/syscall_linux_test.go      | 63 ++++++++++++++++++++++++++++++++++
 src/syscall/zsyscall_linux_386.go      | 30 ++++++++--------
 src/syscall/zsyscall_linux_amd64.go    | 30 ++++++++--------
 src/syscall/zsyscall_linux_arm.go      | 30 ++++++++--------
 src/syscall/zsyscall_linux_arm64.go    | 30 ++++++++--------
 src/syscall/zsyscall_linux_mips.go     | 30 ++++++++--------
 src/syscall/zsyscall_linux_mips64.go   | 30 ++++++++--------
 src/syscall/zsyscall_linux_mips64le.go | 30 ++++++++--------
 src/syscall/zsyscall_linux_mipsle.go   | 30 ++++++++--------
 src/syscall/zsyscall_linux_ppc64.go    | 30 ++++++++--------
 src/syscall/zsyscall_linux_ppc64le.go  | 30 ++++++++--------
 src/syscall/zsyscall_linux_s390x.go    | 30 ++++++++--------
 13 files changed, 242 insertions(+), 166 deletions(-)
