commit 2484e1331a6054ffa25e2e6a4146943251171c56
Author: Austin Clements <austin@google.com>
Date:   Mon May 8 14:39:57 2023 -0400

    misc/swig: restructure as a driver
    
    Currently, the misc/swig tests directly use Swig and C++ and will fail
    to build if either Swig or a C++ compiler are not present. Typically,
    we hide this fact from users because dist test itself checks for Swig
    and a C++ compiler before even attempting to run this test, though
    users will see this is they try to go test ./... from misc.
    
    However, we're about to move the misc/swig tests into the cmd module,
    where they will be much more visible and much more likely to run
    unintentionally. To prevent build errors, this CL restructures these
    tests into a single pure Go test plus two test packages hidden in
    testdata. This is relatively easy to do for this test because there
    are only four test cases total. The pure Go test can check for the
    necessary build tools before trying to build and run the tests in
    testdata. This also gives us the opportunity to move the LTO variant
    of these tests out of dist and into the test itself, simplifying dist.
    
    For #37486.
    
    Change-Id: Ibda089b4069e36866cb31867a7006c790be2d8b1
    Reviewed-on: https://go-review.googlesource.com/c/go/+/493599
    TryBot-Result: Gopher Robot <gobot@golang.org>
    Run-TryBot: Austin Clements <austin@google.com>
    Reviewed-by: Bryan Mills <bcmills@google.com>

 misc/swig/callback/callback.go                     |  11 --
 misc/swig/callback/callback_test.go                |  33 -----
 misc/swig/nocgo_test.go                            |   7 +
 misc/swig/stdio/file.go                            |  15 ---
 misc/swig/stdio/file_test.go                       |  28 ----
 misc/swig/swig_test.go                             | 149 +++++++++++++++++++++
 .../callback.cc => testdata/callback/main.cc}      |   2 +-
 misc/swig/testdata/callback/main.go                |  60 +++++++++
 .../callback.h => testdata/callback/main.h}        |   0
 .../callback/main.swigcxx}                         |   4 +-
 misc/swig/testdata/stdio/main.go                   |  45 +++++++
 .../{stdio/file.swig => testdata/stdio/main.swig}  |   0
 src/cmd/dist/test.go                               |  96 +------------
 13 files changed, 266 insertions(+), 184 deletions(-)
