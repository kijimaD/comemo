commit 106db71f3779b0ae3e6dc83b22df0cf04bc36629
Author: Filippo Valsorda <filippo@golang.org>
Date:   Mon Nov 5 19:23:25 2018 -0500

    crypto/tls: implement TLS 1.3 client authentication
    
    Note that the SignatureSchemes passed to GetClientCertificate in TLS 1.2
    are now filtered by the requested certificate type. This feels like an
    improvement anyway, and the full list can be surfaced as well when
    support for signature_algorithms_cert is added, which actually matches
    the semantics of the CertificateRequest signature_algorithms in TLS 1.2.
    
    Also, note a subtle behavior change in server side resumption: if a
    certificate is requested but not required, and the resumed session did
    not include one, it used not to invoke VerifyPeerCertificate. However,
    if the resumed session did include a certificate, it would. (If a
    certificate was required but not in the session, the session is rejected
    in checkForResumption.) This inconsistency could be unexpected, even
    dangerous, so now VerifyPeerCertificate is always invoked. Still not
    consistent with the client behavior, which does not ever invoke
    VerifyPeerCertificate on resumption, but it felt too surprising to
    entirely change either.
    
    Updates #9671
    
    Change-Id: Ib2b0dbc30e659208dca3ac07d6c687a407d7aaaf
    Reviewed-on: https://go-review.googlesource.com/c/147599
    Reviewed-by: Adam Langley <agl@golang.org>

 src/crypto/tls/common.go                           |   1 +
 src/crypto/tls/conn.go                             |   4 +-
 src/crypto/tls/handshake_client.go                 | 129 +++++------
 src/crypto/tls/handshake_client_test.go            |  52 +++--
 src/crypto/tls/handshake_client_tls13.go           |  76 ++++++-
 src/crypto/tls/handshake_messages.go               |  25 +++
 src/crypto/tls/handshake_messages_test.go          |   6 +
 src/crypto/tls/handshake_server.go                 |  92 ++++----
 src/crypto/tls/handshake_server_test.go            |   3 +
 src/crypto/tls/handshake_server_tls13.go           | 197 +++++++++++++----
 .../testdata/Client-TLSv13-ClientCert-ECDSA-RSA    | 236 +++++++++++++++++++++
 .../testdata/Client-TLSv13-ClientCert-RSA-ECDSA    | 228 ++++++++++++++++++++
 .../testdata/Client-TLSv13-ClientCert-RSA-RSAPSS   | 230 ++++++++++++++++++++
 .../Server-TLSv13-ClientAuthRequestedAndECDSAGiven | 184 ++++++++++++++++
 .../Server-TLSv13-ClientAuthRequestedAndGiven      | 180 ++++++++++++++++
 .../Server-TLSv13-ClientAuthRequestedNotGiven      | 109 ++++++++++
 16 files changed, 1581 insertions(+), 171 deletions(-)
